/* common */(function(a){if(a[a.length-1]===".")return;var b=a.split("."),c=b.length;if(c>=2)try{document.domain=b[c-2]+"."+b[c-1]}catch(d){}})(document.domain);
var swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=i.getElementsByTagName("body")[0],d=Q(b);d.setAttribute("type",e);var f=c.appendChild(d);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var j=y.ie&&y.win?"ActiveX":"PlugIn",k="MMredirectURL="+h.location.toString().replace(/&/g,"%26")+"&MMplayerType="+j+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+k:c.flashvars=k;if(y.ie&&y.win&&g.readyState!=4){var l=Q("div");d+="SWFObjectNew",l.setAttribute("id",d),g.parentNode.insertBefore(l,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=a)try{var s=new ActiveXObject(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}();
function objectify(a){var b=a[0].attributes,c,d={};for(var e=0,f=b.length;e<f;e++)c=b[e].name,c.indexOf("data-")===0&&(c=c.substring(5),d[$.camelCase(c)]=a.data(c));return d}function attributify(a,b){var c="";for(var d in a){if(!a.hasOwnProperty(d))continue;if(!(typeof a[d]!="object"||a[d]instanceof Array)){c+=arguments.callee(a[d],d);continue}if(a[d]===undefined)continue;function e(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function f(a){return a.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2")}c+=(c||b?" ":"")+"data-"+f((b?b+"-":"")+d)+'="'+(a[d]instanceof Array?a[d].join(","):e(a[d]))+'"'}return c}function seofy(a){return a.replace(/[^a-zA-Z0-9_.]/gi," ").replace(/\s+/g,"-").toLowerCase()}function htmlEncode(a){return a===null||a===undefined?"":String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlDecode(a){return a===null||a===undefined?"":String(a).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var handlerPath=/ajax\//i;jQuery.ajaxSettings.beforeSend=function(a,b){if(!handlerPath.test(b.url)&&b.type!=="POST")return;context.hashMashter&&a.setRequestHeader("Hash",context.hashMashter),context.profilerLevel&&a.setRequestHeader("X-Profiler-Level",context.profilerLevel);var c=context.lastInfluencer!=null?context.lastInfluencer:sessionStorage.influencer;c&&a.setRequestHeader("X-Influencer",c),context.lastInfluencer=null;if(window.spaceway&&spaceway.referrer){var d=$("<a/>").attr("href",spaceway.referrer);a.setRequestHeader("PreviousReferrer",d[0].href)}a.setRequestHeader("Client",$.param({persistentId:context.beaconDataV3&&context.beaconDataV3.persistentId,screenWidth:screen.width,screenHeight:screen.height,timeZoneOffsetHours:(new Date).getTimezoneOffset()/60,visitId:context.beaconDataV3&&context.beaconDataV3.visitId,windowWidth:$(window).width(),windowHeight:$(window).height()}))},Date.prototype.addDays=function(a){return this.setDate(this.getDate()+a),this},jQuery.extend(String.prototype,{trimEnd:function(){return this.replace(/\s+$/,"")},trimStart:function(){return this.replace(/^\s+/,"")},endsWith:function(a){return this.substr(this.length-a.length)===a},startsWith:function(a){return this.substr(0,a.length)===a},parseNameValuePair:function(a,b){a||(a="=");if(this[0]===a)return null;var c,d=this.search(a);return d>0?c={name:this.substring(0,d),value:this.substring(d+1)}:c={name:this,value:""},b&&(c=b(c)),c},parseNameValuePairs:function(a,b,c){var d={},e=null,f=this.split(a||"&");for(var g=0;g<f.length;g++){e=f[g].parseNameValuePair(b,c);if(!e)continue;d[e.name]=e.value}return d},format:function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return a[c]})}}),String.prototype.trim||(String.prototype.trim=function(){return jQuery.trim(this)}),Object.fromQueryString=function(a){return a.replace(/\+/g," ").parseNameValuePairs("&","=",function(a){return a.value=decodeURIComponent(a.value),a})},typeof Object.assign!="function"&&(Object.assign=function(a,b){"use strict";if(a==null)throw new TypeError("Cannot convert undefined or null to object");var c=Object(a);for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e!=null)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c}),String.prototype.parse=function(){var a=String(this);switch(a){case"true":return!0;case"false":return!1;case"null":return null;case"undefined":return undefined;case"":return"";default:return isNaN(a)?a:Number(a)}},String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},Array.find=function(b,c,d){for(var e=0,f=b.length;e<f;e++)if(c.call(d,b[e]))return b[e]},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1}),Array.forEach||(Array.forEach=function(a,b,c){for(var d=0,e=a.length;d<e;d++){var f=a[d];typeof f!="undefined"&&b.call(c,f,d,a)}}),Array.prototype.find||(Array.prototype.find=function(a){"use strict";if(this==null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof a!="function")throw new TypeError("predicate must be a function");var b=Object(this),c=b.length>>>0,d=arguments[1],e;for(var f=0;f<c;f++){e=b[f];if(a.call(d,e,f,b))return e}return undefined}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=[],e=arguments.length>=2?arguments[1]:void 0;for(var f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(a){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof a!="function")throw new TypeError(a+" is not a function");var b=Object(this),c=b.length>>>0,d=0,e;if(arguments.length==2)e=arguments[1];else{while(d<c&&!(d in b))d++;if(d>=c)throw new TypeError("Reduce of empty array with no initial value");e=b[d++]}while(d<c)d in b&&(e=a(e,b[d],d,b)),d++;return e}}),Array.prototype.equals||Object.defineProperty(Array.prototype,"equals",{value:function(a){if(!a)return!1;if(this.length!==a.length)return!1;for(var b=0,c=this.length;b<c;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b]))return!1}else if(this[b]!==a[b])return!1;return!0},enumerable:!1}),Element.prototype.isInViewport||(Element.prototype.isInViewport=function(a){var b=this.getBoundingClientRect();return b.top<window.innerHeight&&b.bottom>=0&&b.left<window.innerWidth&&b.right>=0&&(!a||b.height>0||b.width>0)}),head=document.getElementsByTagName("head")[0],queryString=window.location.search.substring(1).parseNameValuePairs(),embedSWF=function(a,b,c,d,e,f,g){var h={width:"1",height:"1",border:"0"},i={quality:"high",bgcolor:"#000000",allowscriptaccess:"always",allowfullscreen:"true",wmode:"opaque"},j={},k=document.createElement("div"),l,m="",n="",o="",p="";a.indexOf("?")>-1&&(qi=a.indexOf("?"),p=a.substr(qi+1),a=a.substring(0,qi)),c==undefined&&(c=document.body),c.appendChild(k);if(e)for(l in e)h[l]=e[l];if(f)for(l in f)i[l]=f[l];if(d)for(l in d)j[l]=d[l];for(l in i)m+='<param name="'+l+'" value="'+i[l]+'"/>';var q=[];for(l in j)q.push(l+"="+j[l]);p!=""&&q.push(p),n=q.join("&"),n!=""&&(m+='<param name="flashvars" value="'+n+'"/>'),q=[];for(l in h)q.push(l+'="'+h[l]+'"');return o=q.join(" "),k.outerHTML="<object"+(b?' id="'+b+'"':"")+" "+o+" "+(context.isIE?' classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000><param name="movie" value="'+a+'">':' type="application/x-shockwave-flash" data="'+a+'"'+(g?'class="'+g+'"':"")+">")+m+"</object>",document.getElementById(b)},$.cors=function(a,b){function g(c,e){clearTimeout(f),d[c](b.context||b,[a,e])}b=b||{};var c=b.xhr=new $.cors.xhr,d=$.Deferred(),e=b.timeout||3e4,f;return c.open(b.data?"post":"get",a,!0),c.onprogress=b.onprogess||function(){},window.XDomainRequest?c.timeout=e:f=setTimeout(function(){c.abort(),g("rejectWith","timeout")},e),c.onload=function(a){a=a||event;var b=a.target&&a.target.status;b&&b!==304&&(b<200||b>300)?g("rejectWith","error"):g("resolveWith",c.responseText)},c.onerror=c.ontimeout=function(a){g("rejectWith",a.type)},b.data?(b.contentType&&c.setRequestHeader&&c.setRequestHeader("Content-Type",b.contentType),c.send(b.data)):c.send(),d.promise()},$.cors.xhr=window.XDomainRequest?XDomainRequest:"withCredentials"in new XMLHttpRequest?XMLHttpRequest:function(){throw"NA"},formatter={attributify:attributify},$.save=function(a){return typeof a!="object"&&(a={url:a}),a.type=a.type||"post",a.error=a.error||function(b,c,d){b.status==401?comm.send("login.prompt",a.loginPromptSettings):setTimeout(function(){Myspace.Error(a.errorSettings||{yes:{onClick:function(){return $.save(a)}}})},550),$.isFunction(a.errorCallback)&&a.errorCallback()},$.ajax(a)},$.fn.isOnScreen=function(){var a=this.get(0);if(!a)return!1;var b=a.getBoundingClientRect();return b.top<window.innerHeight&&b.bottom>0};var partial=function(a,b){return require("ejs").render(templates[a],b)};(function(a,b){$(window).bind("mousemove keyup load",function(){b=0,clearInterval(a),a=setInterval(function(){comm.send("page.idle",++b)},6e4)})})(),"undefined"==typeof Element.prototype.insertAdjacentElement&&Object.defineProperty(Element.prototype,"insertAdjacentElement",{enumerable:!1,writable:!0,configurable:!0,value:function(a,b){switch(a.toString().toUpperCase()){case"BEFOREBEGIN":return this.parentNode.insertBefore(b,this);case"AFTERBEGIN":return this.insertBefore(b,this.firstChild);case"BEFOREEND":return this.appendChild(b);case"AFTEREND":return this.parentNode.insertBefore(b,this.nextSibling);default:throw new Error('Invalid element position "'+a+'"')}}});
(function(){function a(a){return a.value?(a.value=unescape(a.value),a):null}function b(a,b,c){var e=a.toString(),f=[a.name+"="+e];b&&b.indexOf("localhost")<0&&(b.charAt(0)!=="."&&(b="."+b),f.push("domain="+b)),c&&f.push("expires="+c.toGMTString()),f.push("path=/"),document.cookie=f.join("; "),d()}function c(a,b){b&&b.charAt(0)!="."&&(b="."+b),b=b?"; domain="+b:"",document.cookie=a+"="+b+"; expires=Sat, 01 Jan 2000 08:00:00 GMT; path=/",d()}function d(){Cookies={};var a=e();for(var f in a)Cookies[f]=new Cookie(f,a[f]);Cookies.save=b,Cookies.remove=c,Cookies.refresh=d}function e(){return document.cookie.parseNameValuePairs(/\s?;\s?/)}window.Cookie=function(b,c){var d=this;d.name=b,d.raw=c,d.value=unescape(c),d.value.indexOf("=")>-1&&(d.values=d.value.parseNameValuePairs("&",null,a));if(d.values){d.parsedValues={};for(var f in d.values)d.parsedValues[f]=d.values[f].parse()}this.refresh=function(){var a=e();Cookies[d.name]=new Cookie(d.name,a[d.name])}},Cookie.prototype={toString:function(){var a=this.values;if(!a)return this.value;var b=[];for(var c in a)b[b.length]=c+"="+escape(a[c]);return b.join("&")}},d()})();var CookieHelper=function(a){return function(b){if(!Cookies[a])return undefined;Cookies[a].refresh();if(typeof b=="string"){var c=Cookies[a].values[b];return typeof c=="string"?c.parse():c}typeof b=="object"&&($.extend(Cookies[a].values,b),Cookies.save(Cookies[a],"."+document.domain,(new Date).addDays(30)))}};
comm=function(a){function j(a,b,d){if(!g(b))return;var h=a.split(",");for(var i=0;i<h.length;i++)a=h[i],c("listener added for: "+a),(e[a]||(e[a]=[])).push(b),d&&(f[a]||(f[a]=[])).push(b)}function k(a,b,c){if(!b)return;for(var d=0;d<b.length;d++)try{b[d](c,a)===!0&&i.stopListening(a,b[d--])}catch(e){i.onerror("comm handler error",e)}}var b=function(){},c=a&&a.log?function(b){i.debug&&(g(i.debug)?i.debug(b):a.log(b))}:b,d={},e={},f={},g=function(a){return Object.prototype.toString.call(a)==="[object Function]"},h=function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},i={onerror:b,own:function(a,b,f){if(d[a])throw new Error(a+" already registered");if(!b)throw new Error("invalid switchboard");d[a]={switchboard:b,before:f};var g=function(a,b){k(a,e[a],b)};return{broadcast:function(b,d){if(!g)throw new Error("This controller has been abandoned");b=a+"."+b,c("broadcasting: "+b),g(b,d)},abandon:function(){if(!g)throw new Error("This controller has already been abandoned");c("abandoned control of: "+a),delete d[a],g=null}}},listen:function(a,b,c){if(typeof a=="object")for(var d in a){var e=a[d];if(typeof e!="object")continue;for(var f in e){var c=f.charAt(0)=="+",g=e[f];j(d+"."+(c?f.substr(1):f),g,c)}}else j(a,b,c)},stopListening:function(a,b){var d=e[a];if(!d)return;var g=h(b,d);if(g==-1)return;d.splice(g,1),d=f[a],d&&(g=h(b,d),g>-1&&d.splice(g,1)),c("listener removed for: "+a)},send:function(a,b){c("sending: "+a);var f=a.match(/([^.]+)(?:\.(.+))?/).slice(1);if(f.length!=2)throw new Error("invalid command");var g=d[f[0]];if(g){a=f[1];if(g.switchboard[a]){if(g.before&&g.before(a,b))return;g.switchboard[a](b)}else g.switchboard["*"]&&g.switchboard["*"](a,b)}else k(a,e[a],b)},_clearListeners:function(){e={};for(var a in f)e[a]=f[a].slice(0)}};return i}(window.console);
window.scomm||function(a){function m(a){return a&&Object.prototype.toString.call(a)=="[object Function]"}function n(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function o(a){if(a.length!=18&&!b.test(a))return;j=1,scomm={hash:h,debug:scomm.debug,add:scomm.add,remove:scomm.remove,send:function(a,b,d,e,g){if(d==h)throw new Error("You cannot talk to yourself");d=d||"scomm*";var j={cmd:a,data:b,sender:h,ts:+(new Date),to:d};d!="scomm*"&&(j.token=setTimeout(function(){i("failed to send",j),e&&e(a,b,d)},2e3),g&&(f[j.token]=g)),j=d+JSON.stringify(j),i("postMessage to iframe",j),k.contentWindow.postMessage(j,c)},ready:function(a){a()}},i("iframe ready");var d;while(d=g.shift())d();g=undefined}function p(a){if(typeof a!="string")return;var d;a=a.replace(b,function(a){return d=a,""});if(!d||d!=h&&d!="scomm*"&&d!="scomm_")return;var g=JSON.parse(a);if(d=="scomm_"){g.cmd=="clear"?q(g.cmd,null,null):e[g.callback].apply(this,g.args);return}if(g.sender==h){i("ignoring ourself");return}i("processing message",a);if(g.token){if(!g.cmd){clearTimeout(g.token|0),i("message confirmed");var l=f[g.token];l&&delete f[g.token]&&l();return}var j=g.sender+JSON.stringify({sender:h,ts:+(new Date),to:g.sender,token:g.token});i("posting acknowledgement to iframe",j),k.contentWindow.postMessage(j,c)}q(g.cmd,g.data,g.sender)}function q(a,b,c){i("triggering handlers");for(var e=0,f=d.length;e<f;e++)d[e](a,b,c)===!0&&scomm.remove(d[e])}var b=/^scomm\d{13}|scomm\*|scomm_/,c=config.urls.cdn?"https://x.myspacecdn.com":a.protocol+"//"+a.host,d=[],e={},f={},g=[],h,i=window.console&&console.log?function(a,b){scomm.debug&&(m(scomm.debug)?scomm.debug(a,b):console.log(a,b))}:function(){},j,k=document.createElement("iframe");try{h=sessionStorage.scomm="scomm"+ +(new Date)}catch(l){}k.id="scomm",k.src=config.urls.scomm+"#"+h,k.width=0,k.height=0,k.style.border=0,scomm={hash:h,debug:window.location.search.indexOf("scomm=")>-1,add:function(a){if(!m(a))return;d.push(a),i("listener added")},remove:function(a){if(!m(a))return;for(var b=0,c=d.length;b<c;b++)d[b]===a&&d.splice(b,1);i("listener removed")},ready:function(a){if(!m(a))return;g.push(a)},send:function(a,b,c,d,e){scomm.ready(function(){scomm.send(a,b,c,d,e)})}},i("adding iframe"),n(window,"message",function(a){i("message received from iframe",a.data);if(!j){o(a.data);return}if(a.origin!=c)return;p(a.data)}),h&&document.body.appendChild(k)}(window.location);
function require(a){if("fs"==a)return{};var b=require.resolve(a),c=require.modules[b];if(!c)throw new Error('failed to require "'+a+'"');return c.exports||(c.exports={},c.call(c.exports,c,c.exports,require.relative(b))),c.exports}require.modules={},require.resolve=function(a){var b=a,c=a+".js",d=a+"/index.js";return require.modules[c]&&c||require.modules[d]&&d||b},require.register=function(a,b){require.modules[a]=b},require.relative=function(a){return function(b){if("."!=b.substr(0,1))return require(b);var c=a.split("/"),d=b.split("/");c.pop();for(var e=0;e<d.length;e++){var f=d[e];".."==f?c.pop():"."!=f&&c.push(f)}return require(c.join("/"))}},require.register("ejs.js",function(a,b,c){function h(a){return a.substr(1).split("|").reduce(function(a,b){var c=b.split(":"),d=c.shift(),e=c.shift()||"";return e&&(e=", "+e),"filters."+d+"("+a+e+")"})}function i(a,b,c,d){var e=b.split("\n"),f=Math.max(d-3,0),g=Math.min(e.length,d+3),h=e.slice(f,g).map(function(a,b){var c=b+f+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=c,a.message=(c||"ejs")+":"+d+"\n"+h+"\n\n"+a.message,a}var d=c("./utils"),e=c("fs");b.version="0.6.1";var f=b.filters=c("./filters"),g={};b.clearCache=function(){g={}};var j=b.parse=function(a,c){var c=c||{},d=c.open||b.open||"<%",e=c.close||b.close||"%>",f=["var buf = [];","\nwith (locals) {","\n  buf.push('"],g=1;for(var i=0,j=a.length;i<j;++i)if(a.slice(i,d.length+i)==d){i+=d.length;var k,l,m="__stack.lineno="+g;switch(a.substr(i,1)){case"=":k="', escape(("+m+", ",l=")), '",++i;break;case"-":k="', ("+m+", ",l="), '",++i;break;default:k="');"+m+";",l="; buf.push('"}var n=a.indexOf(e,i),o=a.substring(i,n),p=i,q=0;while(~(q=o.indexOf("\n",q)))q++,g++;o.substr(0,1)==":"&&(o=h(o)),f.push(k,o,l),i+=n-p+e.length-1}else a.substr(i,1)=="\\"?f.push("\\\\"):a.substr(i,1)=="'"?f.push("\\'"):a.substr(i,1)=="\r"?f.push(" "):a.substr(i,1)=="\n"?(f.push("\\n"),g++):f.push(a.substr(i,1));return f.push("');\n}\nreturn buf.join('');"),f.join("")},k=b.compile=function(a,c){c=c||{};var e=JSON.stringify(a),g=c.filename?JSON.stringify(c.filename):"undefined";a=["var __stack = { lineno: 1, input: "+e+", filename: "+g+" };",i.toString(),"try {",b.parse(a,c),"} catch (err) {","  rethrow(err, __stack.input, __stack.filename, __stack.lineno);","}"].join("\n"),c.debug&&console.log(a);var h=new Function("locals, filters, escape",a);return function(a){return h.call(this,a,f,d.escape)}};b.render=function(a,b){var c,b=b||{};if(b.cache){if(!b.filename)throw new Error('"cache" option requires "filename".');c=g[b.filename]||(g[b.filename]=k(a,b))}else c=k(a,b);return b.__proto__=b.locals,c.call(b.scope,b)},b.renderFile=function(a,c,d){var f=a+":string";"function"==typeof c&&(d=c,c={}),c.filename=a;try{var g=c.cache?b.cache[f]||(b.cache[f]=e.readFileSync(a,"utf8")):e.readFileSync(a,"utf8");d(null,b.render(g,c))}catch(h){d(h)}},b.__express=b.renderFile,c.extensions?c.extensions[".ejs"]=function(a,b){source=c("fs").readFileSync(b,"utf-8"),a._compile(k(source,{}),b)}:c.registerExtension&&c.registerExtension(".ejs",function(a){return k(a,{})})}),require.register("filters.js",function(a,b,c){b.first=function(a){return a[0]},b.last=function(a){return a[a.length-1]},b.capitalize=function(a){return a=String(a),a[0].toUpperCase()+a.substr(1,a.length)},b.downcase=function(a){return String(a).toLowerCase()},b.upcase=function(a){return String(a).toUpperCase()},b.sort=function(a){return Object.create(a).sort()},b.sort_by=function(a,b){return Object.create(a).sort(function(a,c){return a=a[b],c=c[b],a>c?1:a<c?-1:0})},b.size=b.length=function(a){return a.length},b.plus=function(a,b){return Number(a)+Number(b)},b.minus=function(a,b){return Number(a)-Number(b)},b.times=function(a,b){return Number(a)*Number(b)},b.divided_by=function(a,b){return Number(a)/Number(b)},b.join=function(a,b){return a.join(b||", ")},b.truncate=function(a,b){return a=String(a),a.substr(0,b)},b.truncate_words=function(a,b){var a=String(a),c=a.split(/ +/);return c.slice(0,b).join(" ")},b.replace=function(a,b,c){return String(a).replace(b,c||"")},b.prepend=function(a,b){return Array.isArray(a)?[b].concat(a):b+a},b.append=function(a,b){return Array.isArray(a)?a.concat(b):a+b},b.map=function(a,b){return a.map(function(a){return a[b]})},b.reverse=function(a){return Array.isArray(a)?a.reverse():String(a).split("").reverse().join("")},b.get=function(a,b){return a[b]},b.json=function(a){return JSON.stringify(a)};var d=/\[([^\s|]+)\|(lnk.ms\/\w+)\]/g;b.linkify=function(a){return a?a.replace(d,function(a,b,c){return'<a href="http://'+c+'" target="_blank">'+b+"</a>"}):a}}),require.register("utils.js",function(a,b,c){b.escape=function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}});
(function(){function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})}function c(){return window.context&&b.indexOf(context.ipDerivedIsoCountryCode)>-1}Myspace=Myspace||{},Myspace.Utils=Myspace.Utils||{};var b=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SK","SI","SE","UK"];Myspace.Utils.guid=a,Myspace.Utils.isEU=c})();
var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){a=String(a),b=b||2;while(a.length<b)a="0"+a;return a};return function(e,f,g){var h=dateFormat;arguments.length==1&&Object.prototype.toString.call(e)=="[object String]"&&!/\d/.test(e)&&(f=e,e=undefined),e=e?new Date(e):new Date;if(isNaN(e))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]),f.slice(0,4)=="UTC:"&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",j=e[i+"Date"](),k=e[i+"Day"](),l=e[i+"Month"](),m=e[i+"FullYear"](),n=e[i+"Hours"](),o=e[i+"Minutes"](),p=e[i+"Seconds"](),q=e[i+"Milliseconds"](),r=g?0:e.getTimezoneOffset(),s={d:j,dd:d(j),ddd:h.i18n.dayNames[k],dddd:h.i18n.dayNames[k+7],m:l+1,mm:d(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(m).slice(2),yyyy:m,h:n%12||12,hh:d(n%12||12),H:n,HH:d(n),M:o,MM:d(o),s:p,ss:d(p),l:d(q,3),L:d(q>99?Math.round(q/10):q),t:n<12?"a":"p",tt:n<12?"am":"pm",T:n<12?"A":"P",TT:n<12?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(r>0?"-":"+")+d(Math.floor(Math.abs(r)/60)*100+Math.abs(r)%60,4),S:["th","st","nd","rd"][j%10>3?0:(j%100-j%10!=10)*j%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(a,b){return dateFormat(this,a,b)};
(function(){Myspace=Myspace||{};var a={};Object.defineProperty(a,"isLoggedIn",{get:function(){return context.profileId>0}}),Object.defineProperty(a,"authContext",{get:function(){return Cookies.auth_context&&Cookies.auth_context.values||{}},set:function(a){Cookies.auth_context||(Cookies.auth_context=new Cookie("auth_context")),Cookies.auth_context.values=a,Cookies.save(Cookies.auth_context,document.domain)}}),a.clearAuthContext=function(){a.authContext={},Cookies.remove("auth_context",document.domain)},Myspace.User=a})();
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}}),a("body").delegate("div.horizontalContent:not(.nowheeljack) > div, div.horizontal:not(.nowheeljack) > ul, #drawer div.horizontal","mousewheel",function(a,b,c,d){Math.abs(d)>=Math.abs(c)&&(this.scrollLeft-=d*30,a.preventDefault())})})(jQuery);
var Myspace=Myspace||{};Myspace.DragDropManager=function(a){function i(e){var f;j(e),k(),window.context.features.isPlayerQueueSortable?f='[draggable="true"]:not(#mixes [draggable="true"]):not(#friendsGrid [draggable="true"]):not(.manage [draggable="true"]):not(.queue [draggable="true"]):not(#profilePortfolio.editing [draggable=true])':f='[draggable="true"]:not(#mixes [draggable="true"]):not(#friendsGrid [draggable="true"]):not(.manage [draggable="true"]):not(#profilePortfolio.editing [draggable=true])',a("body").delegate(f,"dragstart",function(e){var f;c=a(e.target).closest('[draggable="true"]'),d.dragStart(e,c);if(!b||b.length==0)b=a('<div id="ghost"></div>'),a("#container").append(b);b.html(d.dragContent()),a(this).bind("dragend",function(a){m(a)}),f=e.originalEvent.dataTransfer,f.setData("Text",d.dragText()),f.effectAllowed="copy",f.dropEffect="copy",f.setDragImage&&f.setDragImage(b[0],20,20),g=!0})}function j(a){d={droppables:a.droppables||[],ignoreSelectors:a.ignoreSelectors,dragText:a.dragText||h,dragContent:a.dragContent||h,dragStart:a.dragStart||h,dragEnd:a.dragEnd||h,dragEnter:a.dragEnter||h,dragLeave:a.dragLeave||h,drop:a.drop||h,dragOverLogic:a.dragOverLogic}}function k(){for(var b=0,c=d.droppables.length;b<c;b++)d.droppables[b].not('[data-droptarget="true"]').each(function(){l(a(this))})}function l(a){a.bind("dragenter",function(a){c&&(e=!0,n(a))}),a.bind("dragover",function(a){c&&(e=!0,o(a))}),a.bind("dragleave",function(a){c&&(e=!1,p(a))}),a.bind("drop",function(a){c&&(e=!1,q(a))}),a.attr("data-droptarget","true")}function m(b){return b.preventDefault(),c=null,u.reset(b,function(a,b){d.dragEnd(a,b)}),a(b.target).unbind("dragend"),g=!1,!1}function n(a){return a.preventDefault(),u.enter(a,function(a,b,c){f=d.dragOverLogic(a,b),d.dragEnter(a,b,c)}),!1}function o(a){a.preventDefault();var b=a.originalEvent.dataTransfer;return b.dropEffect=f?"copy":"none",!1}function p(a){return a.preventDefault(),u.leave(a,function(a,b){d.dragLeave(a,b)}),!1}function q(a){return a.preventDefault(),u.reset(a,function(a,b){d.drop(a,b)}),!1}function r(a){d.droppables.push(a),k()}function s(){return e}function t(){return g}var b,c,d,e=!1,f=!0,g=!1,h=function(){return""},u={count:0,$droppable:null,enter:function(b,d){var e=a(b.delegateTarget),f="up";if(c[0]==e[0])return d(b,e);this.count++;if(!this.$droppable||this.$droppable[0]!=e[0])c.index()<e.index()&&(f="down"),this.$droppable=e,d(b,e,f)},leave:function(b,d){var e=a(b.delegateTarget);if(c[0]==e[0])return d(b,e);this.count--;if(this.$droppable&&this.$droppable[0]!=e[0]||this.count===0)d(b,e),this.count===0&&(this.$droppable=null)},reset:function(a,b){this.$droppable?b(a,this.$droppable):b(a),this.$droppable=null,this.count=0}};return{init:i,addDroppables:r,isOverDroppable:s,isBeingDragged:t}}(jQuery);
var Myspace=Myspace||{};Myspace.DragDrop=function(a){function t(){return b.title+" by "+b.author}function u(){return"<strong>"+b.title+"</strong><span>"+b.author+"</span>"}function v(){p&&clearInterval(p)}function w(b,c){a("#mixData").length&&(c=a("#mixData")),m?(v(),p=setInterval(function(){var a=d-e,b=c[0].scrollTop;if(a>=0&&a<100&&b!==0)c[0].scrollTop=b-10;else{var g=e+f-d;g<100&&(c[0].scrollTop=b+10)}},50)):v()}function x(a){return a.height()<a.prop("scrollHeight")}function y(k,l){c=l,b=objectify(l.find(".playBtn")),H(),r=h.attr("data-panel"),j=!1,N()?(g.removeClass("queueOpen"),j=!0,a("#mixData").length?q=a("#mixData"):q=c.parent().parent(),m=x(q),m&&(e=q.position().top,f=q.height(),q.bind("dragover",function(a){d=a.originalEvent.pageY}))):(n=setTimeout(function(){g.addClass("dropZone"),comm.send("drawer.open","mixes")},200),b.type==="mix"?i.find("li.mix,li.connectedMix,li.newMix,li.radio").addClass("hide"):b.radioStationEntityKey||i.find("li.radio").addClass("hide")),setTimeout(function(){comm.send("hcard.hide")},100)}function A(a,b){clearTimeout(n),clearTimeout(o),comm.send("drawer.panel",r),h.hasClass("pinned")||comm.send("drawer."+(z?"closeOnLeave":"close")),j&&b&&b.removeClass("up down"),i.find("li").removeClass("hide"),l||(g.removeClass("dropZone"),b&&b.removeClass("hovered")),l=!1,q&&(q.unbind("dragover"),v())}function B(a,b,c){k=O(b),j?M(b)?(b.addClass(c),g.removeClass("queueOpen dropZone")):(g.addClass("dropZone"),comm.send("drawer.open","mixes"),b.addClass("hovered")):O(b)&&b.addClass("hovered")}function C(a,b){j&&(M(b)&&(clearTimeout(o),o=setTimeout(function(){Myspace.DragDropManager.isOverDroppable()||(g.addClass("dropZone"),comm.send("drawer.open","mixes"))},500)),b.removeClass("up down")),b.removeClass("hovered")}function D(a,d){var e=d.parent(),f=c.parent();return e.hasClass("table")&&e.hasClass("own")&&f[0]!=e[0]?!1:b.type==="mix"&&d.attr("id")==="createMix"?!1:(e.hasClass("table")&&e.hasClass("own")&&w(a,e.parent()),!0)}function E(a,d){var e={},f=c.parent();if(j&&!k)l=!0,d.hasClass("up")?(d.removeClass("up"),d.before(c)):d.hasClass("down")&&(d.removeClass("down"),d.after(c)),f.scroll(),e.mediaType=b.mediaType,e.sequenceId=b.sequenceId,e.beforeSequenceId=c.next().find(".playBtn").data("sequence-id")||null,e.objectVersion=f.data("objectversion"),e.playlistId=f.data("playlistid"),comm.send("mix.moveItem",e),g.removeClass("dropZone"),clearTimeout(o);else if(k){l=!0;switch(d.data("dest")){case"playNext":J("insert");break;case"playLast":J("append");break;case"radio":K();break;case"createMix":Myspace.User.isLoggedIn?I(d,"create"):comm.send("login.prompt");break;case"message":Myspace.User.isLoggedIn?F():comm.send("login.prompt");break;case"sendinstantmessage":G(d.data("entityKey"));break;default:I(d,"addItem")}d.removeClass("hovered").addClass("active"),setTimeout(function(){d.removeClass("active"),g.removeClass("dropZone")},500)}}function F(){r="messaging",comm.send("messaging.popout",b)}function G(a){var c=b.entityKey;Myspace.MessagingManager.getMediaHtml(c).done(function(b){var d={toEntity:a,mediaEntityKey:c,mediaHtml:b};Myspace.Messages.messagesProvider.sendMessage(d)})}function H(){var a,c,d,e=b.type?b.type:b.mediaType;e==="mixtape"?e="mix":b.type==="song"&&(e="audio"),b.mediaId?d=b.mediaId:d=e==="audio"?b.songId:b.videoId;switch(e){case"video":a=b.title,c=b.artistName;break;case"mix":a=b.title,c=b.owner;break;case"radio":a=b.name,c="";break;case"album":case"audio":a=b.title,c=b.artistName;break;default:a="",c=""}b.title=a,b.author=c,b.mediaId=d,b.type=e}function I(c,d){var e={},f;e.onSuccess=function(d){var e,f=c.find(".playBtn");f.length?e=f.data("title"):typeof d=="string"&&(e=d),typeof d=="object"&&a(".table.own").length&&comm.send("table.newItem",d),comm.send("toasts.new",{html:"<li>"+htmlEncode(b.title)+"<br />was added to<br />"+htmlEncode(e)+"</li>",timeout:3e3})},b.type==="audio"?(e.mediaId=b.songId,e.mediaType="audio",b.mediaReleaseId&&(e.releaseId=b.mediaReleaseId)):b.type==="album"?(e.mediaId=b.albumId,e.mediaType="album"):b.type==="video"&&(e.mediaId=b.mediaId,e.mediaType="video",b.mediaReleaseId&&(e.releaseId=b.mediaReleaseId)),d=="addItem"?(f=c.find(".playBtn"),e.playlistId=f.data("playlist-id"),e.objectVersion=f.data("object-version"),comm.send("mix."+d,e)):(e.title=b.title,comm.send("mix."+d,e))}function J(a){var c=b.type;c==="mix"?comm.send("queue."+a+".mixtape",b):c==="album"?comm.send("queue."+a+".album",b):c==="audio"?comm.send("queue."+a+".song",b):c==="video"&&comm.send("queue."+a+".video",b),r="queue"}function K(){comm.send("radio.start",{radioStationEntityKey:b.radioStationEntityKey,name:b.title,imageUrl:b.imageUrl})}function L(){comm.send("connect",{entityKey:b.entityKey,onSuccess:function(a){b.type==="mix"&&(comm.send("connect.status",{entityKey:b.entityKey}),comm.send("mix.addConnected",{playlistId:b.playlistId,profileId:b.profileId}))}})}function M(a){return a.parent().hasClass("table")}function N(){return(b.type==="audio"||b.type==="video")&&c.parent().hasClass("own")}function O(a){return a.parent().parent().parent().attr("id")==="mixes"||a.hasClass("chat")}function P(){Myspace.DragDropManager.init(s)}function Q(a){Myspace.DragDropManager.addDroppables(a)}var b,c,d=0,e=0,f=0,g=a("body"),h=a("#drawer"),i=a("#mixes"),j=!1,k=!1,l=!1,m=!1,n,o,p,q,r=h.attr("data-panel"),s={droppables:[a("#mixes").find("li.mix,li.util")],dragText:t,dragContent:u,dragStart:y,dragEnd:A,dragEnter:B,dragLeave:C,drop:E,dragOverLogic:D},z;return g.on("dragenter",function(c){z=!!a(c.target).closest("#footer").length}),P(),{addDroppables:Q}}(jQuery);
var Myspace=Myspace||{};(function(a){function f(a){var c=b,d=a.$root[0],e=0,f=c.length,g;b=[];for(;e<f;e++)g=c[e],g.$root[0]!=d&&b.push(g)}function g(){var a,c=b.length,f;if(c){a=b[c-1],f=a.$root;if(f.hasClass("lightbox")&&d.hasClass("donotescape"))return;a.hide(),a.options.closeAll&&h()}e=!1}function h(a){var c=a&&a.jquery?a[0]:a,d=0,e=b.length,f;for(;d<e;d++)f=b[d],f.$root[0]!=c&&(f.hide(),e--,d--)}var b=[],c=a("#dialogCover"),d=a("#lightboxCover"),e;comm.listen("page.esc",function(){e?e=!1:g()},!0),comm.listen("upload.browseOpen",function(){e=!0},!0),comm.listen("upload.browseClose",function(){e=!1},!0),d.children(".close, .info").click(g),comm.listen("spaceway.page.loading",h,!0),Myspace.Dialog=function(e,g){function o(a){if(m)return;g.closeAll&&h(j),i("showing",j),k||l.click(p),g.noClose&&l.addClass("donotescape"),g.onShow(),g.noCover||l.removeClass("hide"),g.centerDialog&&r(),j.addClass("open").removeClass("close"),a||j.find("input[type=text], input[type=email], input[type=password], textarea").first().focus(),m=!0,b.push(t)}function p(){if(m==0)return;g.onHide(),k?(!g.closeAll&&b.length>1||l.addClass("hide"),l.removeClass("donotescape")):l.addClass("hide"),j.addClass("close"),g.className&&j.removeClass(g.className),setTimeout(function(){m||j.removeClass("open").removeClass("close")},500),m=!1,k||l.off("click",p),f(t),i("hiding",j),g.onAfterHide()}function q(){m?p():o()}function r(){var b=j.outerWidth()/2,c=j.outerHeight()/2,d;d||(d=a("#global-nav").outerHeight()||60),c+=d/2,j.css({"margin-left":"-"+b+"px","margin-top":"-"+c+"px"})}function s(){return!m}var j=a(e),k=j.hasClass("lightbox"),l=k?d:c,m=j.hasClass("open"),n={centerDialog:!0,closeAll:!0,onLoad:a.noop,onShow:a.noop,onHide:a.noop,onAfterHide:a.noop,noClose:!1,noCover:!1};g=a.extend({},n,g),j.find(".close").click(p);var t={show:o,hide:p,toggle:q,center:r,isClosed:s,$root:j,options:g};return m&&b.push(t),t};var i=comm.own("dialog",{closeAll:h,isOpen:function(a){typeof a=="function"&&a(b.length)}}).broadcast,j={html:"",close:!0,buttons:[{text:"OK",classes:"primary",click:function(){},setFocus:!0}]};Myspace.genericDialog=function(b){var c=b.id||"genericDialog",d=a('<article id="'+c+'" class="dialog"></article>').appendTo("body"),e;b=a.extend({},j,b),d.addClass(b.classes),b.close&&a('<i class="close x_14">Close</i>').appendTo(d),b.html&&a(b.html).appendTo(d);if(b.buttons&&b.buttons.length){var f=a("<footer>").appendTo(d),g=0,h=b.buttons.length,i;for(;g<h;g++){i=b.buttons[g];var k=a("<button>").appendTo(f).addClass(i.classes).text(i.text);k.click(function(b){return function(c){if(a.isFunction(b.click)&&b.click(c)===!1)return;return l.hide(),!1}}(i)),i.setFocus&&(e=k)}}var l=Myspace.Dialog(d,b);return comm.listen("dialog.hiding",function(a){a.attr("id")==c&&setTimeout(function(){l.$root.remove()},500)}),l.show(),e&&e.focus(),delete l.show,l},Myspace.noticeBoard=function(a){a.id="noticeBoard";var b=Myspace.genericDialog(a);return b},Myspace.successDialog=function(a,b){b&&(b="<h4>"+b+"</h4>");var c=Myspace.genericDialog({html:"<section>"+(b||"")+"<span>&nbsp;</span><span>"+a+"</span></section>",close:!1,buttons:null,id:"successDialog"});setTimeout(function(){c.hide()},4e3)},Myspace.errorDialog=function(a){var b=Myspace.genericDialog({html:"<section><span>"+a+"</span></section>",close:!1,closeAll:!1,buttons:null,id:"errorDialog"});setTimeout(function(){b.hide()},4e3)}})(jQuery),function(a){function i(h){b=a('<article id="confirmDialog" class="dialog"></dialog><p></p><div class="actions"><button class="no"></button><button class="yes primary"></button></div></article>'),c=b.children("p"),d=b.children(".actions"),e=d.children(".no"),f=d.children(".yes"),a("body").append(b),g=new Myspace.Dialog(b,h)}var b,c,d,e,f,g=null,h={text:"Are you sure?",no:{text:"No thanks.",onClick:function(){}},yes:{text:"Yes please.",onClick:function(){}}};Myspace.Error=function(b){var c={text:"Oops, something went wrong and we were unable to complete your request.  Do you want to try again?",no:{text:"No"},yes:{text:"Retry"},closeAll:!1},d=a.extend(!0,{},c,b);Myspace.Confirm(d)},Myspace.Confirm=function(b){function d(){k(),b.onLoad&&b.onLoad(),g.show(),f.focus()}function j(){g.hide()}function k(){c.html(b.text),e.toggleClass("hide",b.no===!1).text(b.no.text||"").unbind("click").click(function(){return b.no.onClick(),j(),!1}),f.toggleClass("hide",b.yes===!1).text(b.yes.text||"").unbind("click").click(function(){return b.yes.onClick(),j(),!1})}g||i(b),b=a.extend(!0,{},h,b),b.beforeShow&&b.beforeShow(g),d()}}(jQuery);
(function(){function d(){if(context.pfc){var a=e(context.pfc);f(a)}}function e(a){for(var b in c)if(~c[b].indexOf(a.toLowerCase()))return b}function f(c){var d=a.find("."+c);b.removeClass("selected"),d.length&&(b=d.addClass("selected"))}var a=$("#unifiedSidebar"),b=$(".selected",a),c={search:["search","searchsongs","searchartists","searchalbums","searchpeople","searchmixes","searchvideos"],featured:["splash","discoverfeatured"],music:["discovermusicsongs","discovermusicalbums","discovermusicartists","discovermixes"],videos:["discovervideoshighrotation","discovervideosrecommended","discovervideosnewreleases"],people:["discoverpeople"],radio:["discoverradio"],stream:["home"],mixes:["librarymixes"],connections:["homeconnectionsrecent","homeconnectionsboth","homeconnectionsout","homeconnectionsin","library","libraryalbums","libraryphotos","libraryvideos","libraryarticles"],uploads:["managephotos","managemusic","managevideos"],insights:["insightshighlights","insightsmusic","insightsprofile","insightsphotos","insightsmixes","insightsaudience","insightsvideos"]};a.on("click","li",function(){var a=$(this);b.removeClass("selected"),a.addClass("selected"),b=a}).on("click","[data-action]",function(){var a=$(this),b=a.data("action")}),$("#searchQuery").on("click",function(a){var b=$(this),c=b.data("action");return comm.send("search.overlay"),!1}),$("#sign-up").click(function(a){comm.send("signup.show",{reset:!0,context:{action:"signUpFooter"}}),context.isEU&&comm.send("signupform.show",{type:"email"})}),$("#sign-in").click(function(a){comm.send("login.show",{context:{action:"signInFooter"}})}),comm.listen("spaceway.page.complete",function(){d()},!0),d()})();
(function(){var a=$("#global-nav nav");a.find(".signUp").click(function(a){a.preventDefault(),comm.send("signup.show",{reset:!0,context:{action:"signUpFooter"}})}),a.find(".signIn").click(function(a){a.preventDefault(),comm.send("login.show",{context:{action:"signInFooter"}})}),comm.listen("username.changed",function(b){a.find("li[data-name=profile] > a").attr("href","/"+b)},!0),comm.listen("fullName.changed",function(b){a.find("li[data-name=profile] > a > span").text(b)},!0)})();
Myspace.Slider=function(a,b){function l(){var b=e[h](!0),c=a[h](),d=a.offset()[i]+b/2,f=d+c-b;return{min:d,max:f,distance:f-d,outer:c}}function m(f){if(a.attr("disabled"))return;k=!0,a.addClass("dragging");var h=l(),m=e.position()[i],n=f[g];return n=(n<h.min?h.min:n>h.max?h.max:n)-h.min,j[i]=b.units=="px"?n+"px":n/h.distance*100+"%",b.start.call(e[0],n,h.distance),d.mousemove(function(a){n=a[g],n=(n<h.min?h.min:n>h.max?h.max:n)-h.min,n!=m&&(j[i]=b.units=="px"?(m=n)+"px":(m=n)/h.outer*100+"%",b.drag.call(e[0],n,h.distance))}),c.one("mouseup",function(){k=!1,a.removeClass("dragging"),d.unbind("mousemove"),b.stop.call(e[0],n,h.distance)}),!1}b={axis:b.axis||"y",units:b.units||"px",start:b.start||$.noop,drag:b.drag||$.noop,stop:b.stop||$.noop,jump:b.jump||$.noop};var c=$(window),d=$("body"),e=a.find(".handle").length>0?a.find(".handle"):$('<div class="handle">').appendTo(a),f=b.axis=="x",g=f?"pageX":"pageY",h=f?"outerWidth":"outerHeight",i=f?"left":"top",j=e[0]&&e[0].style,k;a.click(function(c){if(a.attr("disabled"))return;var d=c[g],f=l();d=(d<f.min?f.min:d>f.max?f.max:d)-f.min,j[i]=b.units=="px"?d+"px":d/f.distance*100+"%",b.jump.call(e[0],d,f.distance)}),a.mousedown(m),e.mousedown(m).click(function(a){return!1}),this.percent=function(a){if(k)return this;a=a>1?1:a<0?0:a;var b=l(),c=a*b.distance;return j[i]=c/b.distance*100+"%",this}};
(function(){function a(a,b){function d(){c&&clearTimeout(c),c=null}function e(){return d(),c=setTimeout(a,b),this}function f(){return d(),this}var c=null;return{reset:e,stop:f,start:e}}window.Myspace=window.Myspace||{},Myspace.ResetTimer=a})();
(function(){function b(a){var b=new Date(a),e=new Date,f={updatedTimeStamp:"",ignore:!0},g=e-b;if(g<0)f.ignore=!1,f.updatedTimeStamp="just now";else{var h=new Date(g),i=h.getUTCFullYear()-1970,j=h.getUTCMonth();if(i>0||j>0)f.updatedTimeStamp=c(b);else{var k=h.getUTCDate();if(k>1)k--,k==1?(f.ignore=!1,f.updatedTimeStamp="Yesterday at "+d(b)):f.updatedTimeStamp=c(b);else{f.ignore=!1;var l=h.getUTCHours();if(l>0)f.updatedTimeStamp=l==1?"1 hour ago":l+" hours ago";else{var m=h.getUTCMinutes();m==0?f.updatedTimeStamp="just now":m==1?f.updatedTimeStamp="1 min ago":f.updatedTimeStamp=m+" mins ago"}}}}return f}function c(b){var c=b.getDate(),e=b.getMonth(),f=b.getFullYear();return c=c<10?"0"+c:c,a[e]+" "+c+", "+f+" at "+d(b)}function d(a){var b=a.getHours(),c=a.getMinutes(),d=b>=12?"PM":"AM";return b%=12,b=b?b<10?"0"+b:b:12,c=c<10?"0"+c:c,b+":"+c+" "+d}function e(b){var c=new Date(b),d=c.getDate();return{year:c.getFullYear(),day:d<10?"0"+d:d,month:a[c.getMonth()],ignore:!0}}function f(){$("time[datetime][updated!='true'][pubdate!='true']").each(function(){var a=$(this),c;a.data("convertTo")==="local"?(c=e(a.attr("datetime")),a.find(".month").text(c.month),a.find(".date").text(c.day)):(c=b(a.attr("datetime")),a.html("<b>"+c.updatedTimeStamp+"</b>")),c.ignore&&$(this).attr("updated","true")})}var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];setInterval(function(){f()},6e4),comm.listen("spaceway.page.complete,page.changed",function(){f()},!0),f()})();
(function(){function e(e){d||(a=document.title,document.title=b=e,d=!0,c=setInterval(function(){var c=document.title===b;c||(a=document.title),document.title=c?a:b},2e3))}function f(){d=!1,clearInterval(c),document.title===b&&(document.title=a)}var a="",b="",c,d=!1;comm.listen("title.startflashing",e,!0),comm.listen("title.stopflashing",f,!0),scomm.add(function(a){if(a!=="title.stopflashing")return;f()})})();
(function(a){function b(b,c){c=c||!1,b.on("click",".delete",function(b){var c=a(b.currentTarget).closest(".notification"),f=c.data("isRequest"),g=c.data("renderTime"),h=c.data("notificationId");return f?d("ignore",c.data("entityKey"),h):e(h,g),j(i(c),"Invoke","DeleteNotification"),!1}),b.on("click","button",function(b){var c=a(b.currentTarget),e=c.closest(".notification"),f=c.data("action"),g=e.data("notificationId");return d(f,e.data("entityKey"),g),!1}),b.on("click",".notification",function(b){var c=a(b.currentTarget);h(c,b)}),comm.listen("notifications.remove",function(a){f(b,a)},c)}function c(b){var c=[],d=[],e=0;b.each(function(){var b=a(this);if(!b.data("alreadyViewed")){var f=b.data("notificationId"),g=b.data("renderTime");g?(d.push(f),e=Math.max(e,g)):c.push(f),b.data("alreadyViewed",!0)}}),(d.length||c.length)&&a.ajax({url:"/ajax/notifications/markviewed",type:"POST",data:{aggregateNotificationIds:d,singleNotificationIds:c,renderTime:e}}).done(function(){var a={unseen:0};comm.send("notifications.count",a),scomm.send("notifications.count",a)})}function d(b,c,d){return a.ajax({url:"/ajax/connections/"+b,data:{entityKey:c},type:"POST"}).done(function(){comm.send("notifications.remove",d),scomm.send("notifications.remove",d)})}function e(b,c){return a.ajax({url:"/ajax/notifications/delete",data:{notificationId:b,renderTime:c},type:"POST"}).done(function(){comm.send("notifications.remove",b),scomm.send("notifications.remove",b)})}function f(b,c){b.find('.notification[data-notification-id="'+c+'"]').fadeOut(function(){a(this).remove(),comm.send("notifications.removed",c)})}function g(a){var b=a.find("a.primaryLink");return b.length||(b=a.find(".notificationInfo .body > a").last()),b.length||(b=a.find(".notificationInfo .subject a").first()),b.length?b:null}function h(b,c){j(i(b),"Invoke","ClickNotification");var d;c.target.nodeName==="A"?d=a(c.target):d=g(b);if(d){var e=n(d);e&&e(d),c.preventDefault(),c.stopPropagation()}}function i(a){return a.closest("#notificationsPopout").length?"notificationspopup":a.closest("#toasts").length?"notificationstoasts":context.pfc}function j(a,b,c){}function l(a){var b=a.attr("href");b&&b!=="#"&&comm.send("location.href",b)}function m(a){var b=Myspace.PhotoCarouselLightbox,c=a.data("playlistId"),d=a.data("photoId"),e=a.data("ownerUsername");b.startCarousel({playlistId:c,mediaId:d,fetchMoreItemsUrl:"/ajax/"+e+"/photos/carousel/fetch"})}function n(a){var b=a.data("object-type");return k[b]||l}scomm.add(function(a,b){a==="notifications.remove"&&comm.send(a,b)}),scomm.add(function(a,b){a==="notifications.count"&&comm.send(a,b)});var k={image:m};Myspace.Notifications=Myspace.Notifications||{},Myspace.Notifications.wireList=b,Myspace.Notifications.markAsViewed=c,Myspace.Notifications.onClick=h})(jQuery);
(function(){function d(a){var b=a.find(".commentBody"),c=b.find(".textWrapper"),d=Number(b.css("max-height").slice(0,-2)),e=c.height();a.toggleClass("expandable",e>d)}function e(a,b,c){function y(a,b,c){return $.ajax({url:"/ajax/comments/get/"+m,type:"POST",data:{start:a,max:b,direction:c}})}function z(){var a=150;return h.innerHeight()+h.scrollTop()+a>=h.prop("scrollHeight")}function A(a){var b=50,c="TopDown";y(r,b).done(function(b){var c=b.nextStart,e=$(b.html).filter(function(){var a=$(this);return a.hasClass("comment")&&x.indexOf(a.data("entityKey"))===-1}),f=z();if(e.length){i.append(e),e.each(function(){var a=$(this);d(a)});var g=f?h.prop("scrollHeight"):h.scrollTop();H(g,e),q=b.total,o+=e.length,t=o<q&&c!==0,t||v.hide(),b.firstStart!==0&&(r=b.firstStart),comm.send("page.changed",i),a&&a({numShown:o,total:q})}})}function B(a,b){y(p,a).done(function(a){var c=a.nextStart,e=$(a.html).filter(".comment"),f;i.data("latest")=="top"?(e=$(e.toArray().reverse()),f="append"):f="prepend",i[f](e),e.each(function(){d($(this))}),H(0,e),o+=e.length,t=o<q&&c!==0,p=c,t||v.hide(),comm.send("page.changed",i),b&&b({numShown:o,hasMore:t})})}function C(){var a=$.trim(l?k.val():k.text());if(j){var b=n&&n.mentionProfileList();Object.keys(b).forEach(function(c){var d=b[c];a=a.replace(d.text,"[["+d.text+"]]")})}return a}function D(){var a=C().trim(),b=n&&n.mentionProfileList();return b&&Object.keys(b).forEach(function(c){var d=b[c];a=a.replace("[["+d.text+"]]","[@"+d.userName+"|"+d.key+"]")}),a}function E(){l?k.val(""):k.text(""),n&&n.reset()}function F(){s=!0,a.data("liveComments")||(Q(),k.addClass("loading white"))}function G(){s=!1,O(),k.removeClass("loading white").get(0).focus()}function H(a,b){h.animate({scrollTop:a},{duration:500,done:function(){b.addClass("newComment"),setTimeout(function(){b.removeClass("newComment")},4e3)}})}function I(){var a=D();a.length>0&&!s&&(F(),$.ajax({url:g.attr("action"),type:"POST",data:{text:a}}).done(function(a){var b=$(a),c=b.attr("data-entity-key");x.indexOf(c)==-1&&(x.push(c),S(b)),E()}).always(G).fail(function(a){var b=JSON.parse(a.responseText).errorMessage||"There was a problem posting your comment, please try again later.";g.tip({trigger:"manual",classes:"error",title:b}).tip("show"),setTimeout(function(){g.tip("destroy")},4e3)}))}function J(){k.focus()}function K(){h.scrollTop(h.prop("scrollHeight"))}function L(a){return $.ajax({url:"/ajax/comments/delete/"+m+"/"+a,type:"POST"})}function M(a){return $.ajax({url:"/ajax/comments/spam/"+a,type:"POST"})}function N(){O(),k.attr("placeholder",k.data("enabledPlaceholder"))}function O(){l?k.prop("disabled",!1):k.prop("contentEditable",!0)}function P(){Q(),k.attr("placeholder",k.data("disabledPlaceholder"))}function Q(){l?k.prop("disabled",!0):k.prop("contentEditable",!1)}function R(){g.find(".signIn").click(function(){if(typeof spaceway=="object")return comm.send("login.prompt",{action:"comment",object:m}),!1}),j&&k.length&&(n=Myspace.mention(k,k[0])),i.children(".comment").each(function(){d($(this))}),a.find("header, footer").on("click","a",function(a){var b=$(this);b.hasClass("showMore")&&($(window).resize(),e.getMoreComments(50))}),h.on("click",".comment .expand",function(a){var b=$(a.currentTarget);return b.siblings(".commentBody").addClass("expanded"),b.remove(),!1}),h.on("click",".comment .deleteComment",function(a){function e(){return window.setTimeout(function(){comm.send("reportAbuse",{type:"comment",entityKey:c,userEntityKey:$(a.currentTarget).data("authorEntityKey")})},700),!1}function f(){L(c).done(function(){comm.send("comment.removed",{entityKey:m})}).always(function(){b.remove()})}var b=$(a.currentTarget).closest(".comment"),c=b.data("entity-key"),d=$(a.currentTarget),g=d.data("canDelete"),h=d.data("canReport");g&&h?Myspace.Confirm({text:"What would you like to do with this comment?",yes:{text:"Delete",onClick:f},no:{text:"Report",onClick:e}}):g?Myspace.Confirm({text:"Delete this comment?",yes:{onClick:f}}):h&&e()}),h.on("click",".comment .markAsSpam",function(a){function d(){M(c).always(function(){b.remove()})}var b=$(a.currentTarget).closest(".comment"),c=b.data("entity-key");return Myspace.Confirm({text:"Mark this comment as spam?",yes:{onClick:d}}),!1}),k.keydown(function(a){switch(a.which){case 13:if(!a.shiftKey){a.preventDefault();if(!n||!n.isProfileSelectByEnterKey())I(),k.get(0).focus()}break;case 27:E()}}),g.data("canComment")?N():P(),comm.listen("connect.complete",function(a){a.entityKey===m&&(a.action==="add"?N():a.action==="remove"&&P())}),a.data("commentsControl",e)}function S(a){var b=i.data("latest")=="top"?"prepend":"append";i[b](a),d(a),o++,q++,H(h.prop("scrollHeight"),a),u({numShown:o,total:q}),comm.send("comment.added",{entityKey:a.attr("data-entity-key")}),comm.send("page.changed",a)}if(a.data("commentsControl"))return a.data("commentsControl");c=c||{};var e=this,g=a.children("form.addComment"),h=a.find(".comments"),i=h.children("ol"),j=context.features.isMentionProfileEnabled,k=j?g.find("div[contenteditable]"):g.find("textarea"),l=k[0]&&k[0].tagName==="TEXTAREA",m=h.data("direct-object"),n,o=i.children().length,p=i.data("nextStart"),q=i.data("total"),r=i.data("firstStart"),s=!1,t=o<q,u=c.onCommentPosted||$.noop,v=a.find(".showMore"),w=a.find("header > .addAComment"),x=[];comm.listen("comments.addcomment",function(a){var b,c;if(a&&a.comments&&Object.keys(a.comments)[0]==m){b=f(a)[m].comments[0],c=$(require("ejs").render(templates["areas/comments/views/_clientComment"],{comment:b}));if(b.author.profileId==context.profileId){if(x.indexOf(b.entityKey)>-1)return;x.push(b.entityKey)}S(c)}}),R(),this.getMoreComments=B,this.getLatestComments=A,this.focus=J,this.scrollToBottom=K,this.submitComment=I}function f(a){var b={};return Object.keys(a.comments).forEach(function(c){var d=a.comments[c],e=[];d.comments.forEach(function(b){var c=g(b,a.profiles);e.push(c)}),b[c]={comments:e,directObject:d.directObject,canComment:d.canComment,total:d.totalCount,nextStart:d.firstCommentId,firstStart:d.lastCommentId}}),b}function g(a,b){var c=a.body||"",d={commentId:a.commentId,entityKey:a.entityKey,publishedDate:new Date(a.postDate),comment:c,commentWithLinks:c,author:b[a.subject]},e;return c&&(e=h(c,!1,b,!0),d.comment=e.content,d.commentWithLinks=e.contentWithLinks),d.canDelete=a.canDelete&&d.author.profileId==context.profileId,d.canReport=d.author.profileId!==context.profileId,d.author.name=d.author.fullName||d.author.username,d}function h(d,e,f,g){var h,j,k=d,l,m;return d&&(d=htmlEncode(d),k=d.replace(a,function(a,b,c){return h=!0,b}),l=h&&d.replace(a,function(a,b,c,d,e){return e?'<a data-id="'+e.slice(1)+'" class="systemLink">'+b+"</a>":(d&&d=="mysp.ac"?c="https://"+c:c="http://"+c,'<a href="'+c+'" target="_blank">'+b+"</a>")}),l=l||k,k=k.replace(b,function(a,b,c){return j=!0,i(a,b,c,f,!1)}),m=j&&l.replace(b,function(a,b,c){return i(a,b,c,f,g)}),l=m||l,e&&(c.lastIndex=0,l=l.replace(c,"<br/>"))),{content:k,contentWithLinks:l}}function i(a,b,c,d,e){var f=c&&d&&d[c];if(f)return e?'<a href="/'+f.username+'" class="tooltips" data-id="'+f.entityKey+'" data-entity-key="'+f.entityKey+'" data-profileid="'+f.profileId+'" data-area="profiles" data-type="profile">'+(f.fullName||f.username)+"</a>":f.fullName||f.username;if(b)return e?(b=b.slice(1),'<a href="/'+b+'">'+b+"</a>"):b}var a=/\[([^\[]*?(?!\s)[^\[]*?)\|((lnk.ms|mysp.ac|myspac.ee)\/\w+)(\|*[a-zA-Z]*)\]/g,b=/\[(@[\w\d\.\-]+)[\|]((profile_)[0-9]{1,})\]/gim,c=/\n+/g;Myspace.CommentsControl=e})();
(function(a){Myspace.DropDown=function(b,c){function e(b){function e(){b.addClass("open");var d=Math.max(a(window).height()+a(window).scrollTop()-b.offset().top-120,50);c.maxHeight&&(d=Math.min(d,c.maxHeight)),b.children("ul").css("max-height",d),setTimeout(function(){a(document).on("click",f)},0)}function f(){b.children("ul").scrollTop(0),b.removeClass("open"),a(document).off("click",f)}function g(){h()?f():e()}function h(){return b.hasClass("open")}var d=b.data("event");b.children("strong").click(function(){g()}),b.on("click","li",function(){var e=a(this),g=b.find("strong .title"),h=b.find("strong > span > i"),i=e.text().trim(),j=e.data("value"),k=e.find("i").attr("class");if(c.eventTracking)var l=c.eventTracking.action?typeof c.eventTracking.action=="function"?c.eventTracking.action(e):c.eventTracking.action:"Select: "+i,m=c.eventTracking.label?typeof c.eventTracking.label=="function"?c.eventTracking.label(e):c.eventTracking.label:undefined,n=new Tracking(c.eventTracking.category||context.pfc,l,m);b.find("li.selected").removeClass("selected"),g.text(i),h.attr("class",k),e.addClass("selected"),comm.send(d,{value:j,dropDownElement:b}),f()}),b.children("ul").on("mousewheel",function(a){a.stopPropagation()}),comm.listen("spaceway.page.complete,dropdown.close",f)}function f(){d.each(function(){var b=a(this),c=b.find("li:first-child"),d=b.find("strong .title"),e=b.find("strong > span > i"),f=c.text().trim(),g=c.data("value"),h=c.find("i").attr("class");b.find("li.selected").removeClass("selected"),d.text(f),e.attr("class",h),c.addClass("selected")})}function g(b,c){d.each(function(){var d=a("<li></li>").text(b).data("value",c);a(this).children("ul").append(d)})}function h(b){d.each(function(){a(this).children("ul").children().each(function(){var c=a(this);c.data("value")==b&&c.remove()})})}function i(b,c){d.each(function(){a(this).children("ul").children().each(function(){var d=a(this);d.data("value")==b&&d.data("value",c.value).text(c.name)})})}function j(b){d.each(function(){var c=a(this),d=c.find("strong .title"),e=c.find("strong > span > i");c.children("ul").children().each(function(){var f=a(this);if(f.data("value")==b){var g=f.find("i").attr("class"),h=c.data("event");return c.find("li.selected").removeClass("selected"),f.addClass("selected"),d.text(f.text()),e.attr("class",g),!1}})})}function k(){var b=[];return d.each(function(){var c=a(this);c.children("ul").children().each(function(){b.push(a(this).data("value"))})}),b}c=c||{};var d=a(b);return d.each(function(){e(a(this))}),{addItem:g,removeItem:h,modifyItem:i,selectItem:j,getValues:k,reset:f}}})(jQuery);
(function(a){Myspace.Influencer=new function(){function c(a){var b="",c=a.closest("[data-influencer]");return c.length&&(b=c.data("influencer")),b==context.profileId&&(b=""),b}try{sessionStorage.influencer=""}catch(b){}return a("body").delegate("a","click",function(b){var c=a(this);if(c.attr("href")){var d=c.closest("[data-influencer]");try{d.length&&d.data("influencer")!=context.profileId?sessionStorage.influencer=d.data("influencer"):sessionStorage.influencer=""}catch(b){}}}),a(window).bind("popstate",function(a){try{sessionStorage.influencer=""}catch(a){}}),comm.listen("influencer.click",function(b){var d;typeof b=="number"?d=b:d=c(a(b)),context.lastInfluencer=d,setTimeout(function(){context.lastInfluencer=null},100)},!0),{getClickInfluencer:c}}})(jQuery);
(function(a){function b(b,d,e){comm.send("beacon.v3",{actionText:"Click",objectName:d,xPixelPosition:b.clientX,yPixelPosition:b.clientY});var f,g,h,i=["GlobalNav","DiscoverContextualNav","DiscoverMusic","DiscoverSongs","DiscoverArtists","DiscoverAlbums","DiscoverRadio","DiscoverVideo","ProfileContextualNav","HomeContextualNav","SearchResultsContextualNav","Mobile Menu","Mobile Homepage","Mobile Header","Discover People","Video Page","Videos Mobile","Songs","Albums","Artists","Mixes"],j=i.length;for(var k=0;k<j;k++){h=d.indexOf(i[k]);if(h>-1){g=d.split(i[k])[1],g=a.trim(g),f=i[k]==="GlobalNav"?"Global Nav":i[k],c(f,g,e);break}}}function c(b,c,d){_gaq.push(["_set","hitCallback",function(){a.isFunction(d)&&d()}]),_gaq.push(["_trackEvent",b,"click",c]),Array.isArray(_gaq)&&a.isFunction(d)&&d()}a("body").delegate("[data-click-object-type]","click",function(c){typeof spaceway!="object"&&c.preventDefault();var d=this,e=a(d).data("clickObjectType");b(c,e,function(){typeof d.href=="string"&&typeof spaceway!="object"&&(window.location=d.href)})}),comm.listen("click.tracker",function(a){b(a.e,a.objectName)},!0)})(jQuery);
(function(a,b){function c(c,d){var e=d&&d.get(0),f=[],g,h=0,i,j=500,k=j/2;return c.find(".playBtn.song, .playBtn.video").each(function(c,d){var i=a(d),j=objectify(i);j.influencerId=b.Influencer.getClickInfluencer(i),e&&e==d&&(g=j,h=c),f.push(j)}),h<k?i=f.slice(0,j):h>=f.length-k?i=f.slice(f.length-j):i=f.slice(h-Math.floor(k),h+Math.ceil(k)),{media:i,selected:g}}function j(b,c){a(".playBtn").removeClass("playing paused");if(b&&b.mediaItem){var d=a("#queue .list."+b.mode+" .selected .playBtn");if(d.length){var e=a('.playBtn[data-media-id="'+b.mediaItem.mediaId+'"]:not(#drawer .playBtn)'),f=a("#videoPlayer .playBtn"),g=b.paused?"paused":"playing";e.add(d).add(f).addClass(g)}}}function k(a,b){}function l(){g||(g=new b.Dialog(a("#videoNotSupported"))),g.show()}function m(c,d){h||(h=new b.Dialog(f));var e=[],g=a('<button class="radio">Start Radio</button>'),j=a("<h1></h1>").text(c.title),l=c.artistName?a("<h2></h2>").text(c.artistName):"";f.find(".media").html('<a><img src="'+c.imageUrl+'"/></a><div>'+j+l+"</div>"),g.click(function(){i.radio(c),k("play","radio"),h.hide()}),e.push(g),f.find(".media").find("div").append(e),h.show()}var d=a("#wrap"),e=a("html").hasClass("mobile"),f=e?a("#radioForMedia"):null,g,h,i={song:function(a,b){comm.send("queue.list",function(e){var f="queue",g=b.closest("ol.table"),h=g.attr("data-objectversion")||g.attr("data-uid")||d.attr("data-uid");if(e.listId==h||!e.$lis.length)if(g.length){var i=c(g,b);return i.listId=h,comm.send(f+".set",i)}return comm.send(f+".play.song",a)})},album:function(a){comm.send("queue.set.album",a)},mixtape:function(a){context.lastInfluencer=a.influencerId,a.influencerId=a.profileId,comm.send("queue.set.mixtape",a)},radio:function(a){comm.send("radio.start",a)},video:function(a){comm.send("influencer.click",a.influencerId),comm.send("videoLightbox.instance",function(b){b&&b.show(a)})},all:function(b,e){var f=e.data("list-selector"),g=f?a(f):d,h=c(g);h&&h.media&&h.media.length&&comm.send("queue.set",{media:h.media,selected:h.selected,listId:d.attr("data-uid")})}};a("body").delegate(".playBtn, #playAll, .play-all, .play-radio","click",function(c){var d=this,f=a(this),g=objectify(f);c.preventDefault(),c.stopPropagation();if(f.hasClass("playing"))return comm.send("player.pause"),k("pause",g.type),!1;if(f.hasClass("paused"))return comm.send("player.resume"),k("resume",g.type),!1;g.influencerId=b.Influencer.getClickInfluencer(f);if(e){if(g.type==="video")return l();if(g.type==="song"&&g.isPremium===!0||g.type==="album"||g.type==="mixtape")return m(g,f)}i[g.type](g,f),k("play",g.type)}),comm.listen({player:{"+preloading":j,"+loading":j,"+loaded":j,"+started":j,"+paused":j,"+resumed":j,"+state":j,"+ended":function(){j()},"+stopped":function(){j()}}})})(jQuery,window.Myspace=window.Myspace||{});var play=function(a,b,c){b.type||(b.type=a),c=c||"play_25";var d='<button class="playBtn '+c+" "+a+'" '+attributify(b)+"></button>";return d};
var Myspace=Myspace||{};Myspace.ExQ=function(a){function d(a,c){a.command=c;var d=a.playlistId;!b[d]||!b[d].data||!b[d].data.length?(b[d]||(b[d]={},b[d].objectVersion=a.objectVersion),b[d].data=[],b[d].data.push(a),e(b[d].objectVersion,b[d].data[0])):b[d].data.push(a)}function e(a,b){var d,e;b.command=="mix.changeImage"?b.changeImage(a):(d=c[b.command],b.objectVersion=a,typeof b.onSuccess=="function"&&(e=b.onSuccess,delete b.onSuccess),typeof b.source!="undefined"&&delete b.source,typeof b.item!="undefined"&&delete b.item,h(d,"POST",b,function(a){e&&e(a),f(a)}))}function f(a){if(a.playlist){var c=a.playlist.playlistId;b[c]&&(b[c].data.length&&b[c].data.shift(),a.playlist.objectVersion&&(b[c].objectVersion=a.playlist.objectVersion),b[c].data.length&&e(b[c].objectVersion,b[c].data[0]))}}function g(a){b[a.playlistId]||(b[a.playlistId]={}),b[a.playlistId].objectVersion=a.objectVersion}function h(b,c,d,e){var f={url:b,data:d,type:c,success:function(a){e&&e(a)},error:function(b,c,d){var e;if(b.status==429){var g=JSON.parse(b.responseText);e={text:g.message,yes:{text:"Ok"},no:!1}}else e={yes:{onClick:function(){a.save(f)}},no:{text:"Reload",onClick:function(){comm.send("location.href",window.location.href)}}};Myspace.Error(e)}};return a.save(f)}var b={},c={"mix.addItem":"/ajax/mixes/additem","mix.removeItem":"/ajax/mixes/removeitem","mix.moveItem":"/ajax/mixes/moveitem","mix.edit":"/ajax/mixes/edit","mix.delete":"/ajax/mixes/delete","mix.removeCover":"/ajax/mixes/removecover"};return{process:d,executeAsync:e,executeSerial:f,updateObjectVersion:g,sendAjax:h}}(jQuery);
(function(a){function h(b,c){function f(){b.onCancel&&!e&&b.onCancel(),comm.stopListening("dialog.hiding",f)}var e;Myspace.Confirm({text:"Are you sure you want to delete '"+a("<div />").text(b.title).html()+"'?<br />Any photos added to this mix will be deleted.",yes:{onClick:function(){b.onCancel&&delete b.onCancel,e=!0,c="mix.delete",b.playlistId=b.playlistId||b.id.split(",")[1],b.objectVersion=1,b.onSuccess=b.onSuccess||function(a){a.entityKey=b.entityKey,comm.send("mix.deleted",a)},d(b,c)}}}),comm.listen("dialog.hiding",f)}function i(a){g("/ajax/mixes/move","POST",a,function(a){})}function j(b){comm.send("toasts.new",{html:'<li><a href="/'+b.playlist.profile.username+"/mixes/"+seofy(b.playlist.title)+"-"+b.playlist.playlistId+'">Your mix '+a("<div />").text(b.playlist.title).html()+" has been created.</a></li>",timeout:1e4})}function k(b,c,d){var e,f;b=b||{},b.emptyPlaylistImage=config.urls.emptyPlaylistImage,b.mediaType||(b.type==="song"?b.mediaType="Audio":b.type==="video"?b.mediaType="Video":b.mediaType=b.type),a("#mixForm").remove(),f=a(require("ejs").render(templates["areas/mixes/views/dialogs/mixForms"],{mixtape:b,command:c})),f.appendTo("#container"),e=new Myspace.Dialog(f),e.show(),c==="mix.selectAndAddItem"?(d&&d(),m(b,e)):l(b,e)}function l(b,c){var f,g,h,i,j,k,l,o=context.features.isMixTagginEnable,p=a("#mixForm"),q=a("#createForm"),r,s,t;q.show();if(!q.data("wired")){g=a("#mixtapeImageContainer"),h=g.find(".mixtapeImage"),i=a("#mixCoverFile"),j=a("#mixTitle"),k=a("#mixDescription"),t=k[0]&&k[0].tagName==="TEXTAREA",o&&!r&&(r=Myspace.tagging(k)),l=k.siblings(".charCount");var u={autoUpload:!1,filesInput:i,uploadError:function(a,b){Myspace.Error({text:a,yes:{text:"OK"},no:!1}),b&&comm.send("mix.imageFailed",{playlistId:b})},uploadBegin:function(){g.tip("hide")},uploadComplete:function(){},showPreview:function(a){f=h.attr("src"),h.attr("src",a),i.data("hasImage",!0)},fileAttached:function(){g.tip({title:"The image was attached.",trigger:"manual",placement:"inside right"}).tip("addOKCustomClass").tip("show")},fileProcessFailed:function(a){this.handleUploadError(a)},showLoading:function(){g.addClass("loading white")},hideLoading:function(){g.removeClass("loading white")},handleUploadError:function(a){this.hideLoading(),g.tip({title:a,trigger:"manual",placement:"inside right"}).tip("addErrorCustomClass").tip("show"),i.data("hasImage",!1)},executeSerial:e};Myspace.MixCoverUploader.init(u),k.keyup(function(a){var b=600,c=w().length;if(c>b)return k.val(w().substring(0,b)),c=b,!1;l.html(c+"/"+b).attr("data-len",c)}),p.find(".create").click(function(e){e.preventDefault(),s=!0,b.onCancel&&delete b.onCancel;var f,g=a(e.target),h=i.data("hasImage")==1;g.attr("disabled","disabled");if(a.trim(j.val())==="")return j.siblings(".tipHolder").tip({title:"The mix title is required",trigger:"manual",placement:"inside top"}).tip("addErrorCustomClass").tip("show"),j.keyup(function(){g.removeAttr("disabled"),j.siblings(".tipHolder").unbind("keyup").tip("hide")}),!1;b.onSuccess&&(f=b.onSuccess,delete b.onSuccess),b.onSuccess=function(a){a.hasImage=h,comm.send("mix.created",a),f&&f(j.val(),a),h&&(a.playlist.changeImage=function(b){Myspace.MixCoverUploader.startUpload(a.playlist.playlistId,b)},d(a.playlist,"mix.changeImage"))},o?r.getTaggingInfo(function(a){n(p,b,a)}):n(p,b),c.hide()}),p.find(".cancel").click(function(a){c.hide()}),p.find(".myMixes").click(function(a){a.preventDefault(),q.hide(),m(b,c)});function v(){b.onCancel&&!s&&b.onCancel(),comm.stopListening("dialog.hiding",v)}comm.listen("dialog.hiding",v);function w(){return t?k.val():k.text()}}else q.data("wired",!0)}function m(b,c){var e=a("#addToSection"),f=a("#myMixtapes"),g=f.find("option:selected"),h=a("#selectedMixImage").children("img");e.show(),e.data("wired")?e.data("wired",!0):(f.change(function(a){g=f.find("option:selected"),h.attr("src",g.data("image"))}),e.find(".cancel").click(function(){return c.hide(),!1}),e.find(".save").click(function(e){e.preventDefault(),g=f.find("option:selected");var h=g.text();h=h.length>30?h.substr(0,30)+"...":h,b.playlistId=g.val(),b.objectVersion=g.data("objectversion"),b.onSuccess=function(c){typeof c=="object"&&(comm.send("table.newItem",c),comm.send("toasts.new",{html:"<li>"+a("<div />").text(b.title).html()+"<br />was added to<br />"+a("<div />").text(h).html()+"</li>",timeout:3e3}))},d(b,"mix.addItem"),c.hide()}),e.find(".createMixAndAdd").click(function(){return e.hide(),l(b,c),!1}))}function n(a,b,c){var d=a.serialize();c&&(d+="&description="+c.text,d+="&descriptionTags="+JSON.stringify(c.tags)),g("/ajax/mixes/create","POST",d,function(a){typeof b.onSuccess=="function"&&typeof a.playlist=="object"&&b.onSuccess(a)})}function o(a,b){g("/ajax/"+a.profileId+"/mixes/getmarkup","POST",{playlistId:a.playlistId,profileId:a.profileId},function(a){var b={};b.markup=a,comm.send("mix.created",b)})}function p(b){function e(){d.data("confirmed")||comm.stopListening("dialog.hiding",e)}var d=a("#addItemsToMix");d.length||(d=a(require("ejs").render(templates["areas/mixes/views/dialogs/addItemsToMix"])),d.submit(function(a){d.data("confirmed",!0),comm.stopListening("dialog.hiding",e),a.preventDefault(),r(d,b)}),d.on("click","ul",function(c){c.preventDefault(),a(c.target).closest("li").length&&d.data("confirmed",!0),q(c,b,e)}),d.appendTo("body"),c=new Myspace.Dialog(d)),d.data("confirmed",!1),g("/ajax/mixes/get","POST",null,function(b){var e="";if(b.length==0){d.addClass("noMixes");return}for(var f=0;f<b.length;f++){var g=b[f].songCount==1?" song":" songs";e+='<li data-playlist-id="'+b[f].playlistId+'" data-object-version="'+b[f].objectVersion+'"><img src="'+b[f].image+'" /><div><span class="title">'+a("<div />").text(b[f].title).html()+"</span><span>"+b[f].songCount+g+"</span></div></li>"}a(".addToExisting > ul",d).html(e).css("overflow-y",b.length>12?"scroll":"auto"),d.removeClass("noMixes"),c.center()}),c.show(),d.find("input").val("").focus(),comm.listen("dialog.hiding",e)}function q(b,e){var f,g=a(b.target).closest("li");if(g.length){var h=objectify(g);f={playlistId:h.playlistId,objectVersion:h.objectVersion,mediaItems:e},f.onSuccess=function(a){if(typeof a=="object"){var b=0,c;a.playlist&&a.playlist.itemsAffected&&(b=a.playlist.itemsAffected.length),b==1?c=" item was added to ":c=" items were added to ",comm.send("table.newItem",a),comm.send("toasts.new",{html:"<li>"+b+c+"  <br />"+g.find(".title").text()+"</li>",timeout:3e3})}},d(f,"mix.addItem"),c.hide()}return!1}function r(a,b){var d=a.find("input").val();return d.length&&(g("/ajax/mixes/create","POST",{title:d,mediaItems:b},function(a){a.playlist&&comm.send("mix.created",a)}),c.hide()),!1}function s(a,b){var c="/ajax/connections/"+a,d={entityKey:b.entityKey,type:b.type,id:b.id,optionalData:b.optionalData};g(c,"POST",d,b.onSuccess,b.onError).done(function(){var b={action:a,entityKey:d.entityKey};comm.send("connect.complete",b),scomm.send("connect.complete",b)})}function u(a,b){var c=Myspace.PhotoCropper,d=Myspace.Upload.MEDIA_TYPES.PROFILE,e=a.item;c.setOptions({photoUrl:a.fullImageUrl,photoType:d,photoDimensions:{width:a.fullImageWidth,height:a.fullImageHeight},successCallback:function(a){e.hide(),b(a)},failedCallback:function(a){var b=Myspace.Upload.MapServerError(a.errorCode);w(b,d)}},function(){c.show()})}function v(a,b){var c=a.item,d={utoken:context.hashMashter,url:a.fullImageUrl,photoType:Myspace.Upload.MEDIA_TYPES.COVER};Myspace.Upload.PosterUpload(d,d.photoType,function(a){c.slideUp(),b(a)})}function w(b,c){t=!1,a("#sidebar .mediaSquare").removeClass("photoObject loading"),Myspace.Confirm({closeAll:!1,text:Myspace.Upload.GetErrorMessage(null,b,c),yes:{text:"OK"},no:!1})}function x(a,b,c){var d={imageType:b,imageId:a.id,albumId:a.albumId};g("/ajax/editprofile/updateimage","POST",d,function(a){c(a)})}function z(a,b,c){var d="/ajax/likes/"+a;g(d,"POST",c,b.onSuccess,b.onError).done(function(){var b={action:a,entityKey:c.entityKey};comm.send("like.complete",b),scomm.send("like.complete",b)})}var b=Myspace.ExQ,c,d=b.process,e=b.executeSerial,f=b.updateObjectVersion,g=b.sendAjax;comm.listen("mix.imageChanged",f,!0),comm.listen("mix.coverUploadInit",function(a){a.executeSerial=e,Myspace.MixCoverUploader.init(a)},!0),comm.listen("mix.edit,mix.changeImage,mix.addItem,mix.removeItem,mix.moveItem,mix.removeCover",d,!0),comm.listen("mixtape.delete,mix.delete",h,!0),comm.listen("mix.move",i,!0),comm.listen("mix.created",j,!0),comm.listen("mix.create",k,!0),comm.listen("mix.addConnected",function(a,b){setTimeout(function(){o(a,b)},1e3)},!0),comm.listen("mix.addItems",p,!0),comm.listen("mix.selectAndAddItem",function(b,c){var d,e=a("#mixes").find(".mix").length===0;b.mediaId||(b.mediaId=b.id),b.releaseId||(b.releaseId=b.mediaReleaseId),e||(d=function(){g("/ajax/mixes/get","POST",null,function(b){var c="",d,e=b.length,f=a("#myMixtapes");e>0&&b[0].image&&a("#selectedMixImage").children("img").attr("src",b[0].image).removeClass("hide");for(d=0;d<e;d++)c+='<option value="'+b[d].playlistId+'" data-objectversion="'+b[d].objectVersion+'" data-image="'+b[d].image+'">'+a("<div />").text(b[d].title).html()+"</option>";e&&f.html(c)})}),comm.send("hide.hcard"),c=="mix.selectAndAddItem"&&(e&&(c="mix.create"),k(b,c,d))},!0),comm.listen("connect",function(b){if(b.type=="song"){var c=a(b.item),d=c.data("uid"),e;d?e=a('.playBtn[data-uid="'+d+'"]'):e=c.parents(".mediaSquare").find(".playBtn");if(e.length){var f=objectify(e);f.songReleaseEntityKey?b.optionalData={songReleaseEntityKey:f.songReleaseEntityKey}:b.optionalData={songReleaseId:f.mediaReleaseId}}}else if(b.type=="photo"){var c=a(b.item),g=c.data("mixEntityKey");g&&(b.optionalData={mixEntityKey:g})}else b.connectActionOrigin&&(b.type=="profile"||b.type=="artist"||b.type=="mixtape")&&(b.optionalData={connectActionOrigin:b.connectActionOrigin});s("add",b)},!0),comm.listen("connect.add",function(a){s("add",a)},!0),comm.listen("disconnect",function(a){a.connectActionOrigin&&(a.type=="profile"||a.type=="artist"||a.type=="mixtape")&&(a.optionalData={connectActionOrigin:a.connectActionOrigin}),s("remove",a)},!0),comm.listen("approveRequest",function(b){s("approve",b),b.item.closest(".mediaSquare").parent().fadeOut(500,function(){a(this).remove()})},!0),comm.listen("ignoreRequest",function(b){s("ignore",b),b.item.closest(".mediaSquare").parent().fadeOut(500,function(){a(this).remove()})},!0),comm.listen("block",function(a){s("block",a)},!0),comm.listen("unblock",function(a){s("unblock",a)},!0),scomm.add(function(a,b){a=="connect.complete"&&comm.send(a,b)}),comm.listen("connect>queue",function(b){var c={},d;b.uid&&(d=a('.playBtn[data-uid="'+b.uid+'"]:eq(0)'));if(!d||!d.length)d=b.source.parents(".media, .mediaSquare, .streamItem").find(".playBtn:eq(0)");if(d&&d.length){c=objectify(d);var e=Myspace.Influencer.getClickInfluencer(b.source);c.type=="mixtape"?(context.lastInfluencer=e,c.influencerId=c.profileId):c.influencerId=e,comm.send("queue.append."+b.type,c)}},!0),comm.listen("playRadio",function(b){var c=a('.playBtn[data-uid="'+b.uid+'"]'),d;if(c.length){var e=objectify(c);d={radioStationEntityKey:e.radioStationEntityKey,name:e.name||e.title,imageUrl:e.imageUrl}}else b.radioStationEntityKey&&(d={radioStationEntityKey:b.radioStationEntityKey,name:b.title,imageUrl:b.imageUrl});comm.send("radio.start",d)},!0),comm.listen("updateProfileSong",function(b){var c=objectify(a('.playBtn[data-uid="'+b.uid+'"]')),d=a("#profileWidget"),e=context.displayProfileId==context.profileId&&d.length,f={songId:c.mediaId,songReleaseId:c.mediaReleaseId,includeTemplate:e};g("/ajax/editprofile/updatesong","POST",f,function(b){if(b.success){comm.send("profile.objectversion",b.objectVersion);if(e&&b.songTemplate){var d=require("ejs").compile(b.songTemplate),f=a(d({song:c})),g=a("#profileSong");g.length?g.html(f.children()):a("#profileDetails").append(f)}}})},!0),comm.listen("photo.delete",function(a){function d(){g("/ajax/photos/photo/delete","POST",b,function(b){b.success&&(a.source.closest("li").remove(),comm.send("photo.deleted",{item:a,albumObjectVersion:b.albumObjectVersion}))})}var b={entityKey:a.entityKey},c="";return a.id==context.profileImageId&&a.id==context.coverImageId?c="Delete this photo?  The photo you are trying to delete is also your profile and cover photo.  If you proceed, your profile and cover photos will also be deleted.":a.id==context.profileImageId?c="Delete this photo?  The photo you are trying to delete is also your profile photo.  If you proceed, your profile photo will also be deleted.":a.id==context.coverImageId?c="Delete this photo?  The photo you are trying to delete is also your cover photo.  If you proceed, your cover photo will also be deleted.":c="Delete this photo?",Myspace.Confirm({text:c,yes:{onClick:d},closeAll:!1}),!1},!0);var t;comm.listen("connect>makeProfilePicture",function(b){if(t)return;t=!0;var c=function(b){comm.send("profile.objectversion",b.objectVersion),t=!1,context.profileImageId=b.imageId,new Myspace.genericDialog({buttons:!1,close:!1,classes:"success",html:'<section><p><i class="check_12_green"></i> Image successfully updated</p></section>'}),a("#sidebar .mediaSquare").removeClass("photoObject loading"),b.urls&&b.urls.length&&(context.displayProfileId?context.displayProfileId==context.profileId&&a("#sidebar > header > .item > .mediaSquare > a > img").attr("src",b.urls[2].url):a("#sidebar > header > h1 > a > img").attr("src",b.urls[4].url))};a("#sidebar .mediaSquare").addClass("photoObject loading"),b.fromProfileMix?x(b,"profile",c):b.profileEligible&&b.fullImageUrl?u(b,c):w(Myspace.Upload.ERROR_CODES.MINIMUM_IMAGE_SIZE,Myspace.Upload.MEDIA_TYPES.PROFILE)},!0),comm.listen("connect>makeProfileCover",function(b){if(t)return;t=!0;var c=function(b){comm.send("profile.objectversion",b.objectVersion),t=!1,context.coverImageId=b.imageId,new Myspace.genericDialog({buttons:!1,close:!1,classes:"success",html:'<section><p><i class="check_12_green"></i> Image successfully updated</p></section>'}),b.urls&&b.urls.length&&context.pfc=="Profile"&&context.displayProfileId==context.profileId&&a("#background").css("background-image","url('"+b.urls[0].url+"')")};b.fromCoverMix?x(b,"cover",c):b.coverEligible&&b.fullImageUrl?v(b,c):w(Myspace.Upload.ERROR_CODES.MINIMUM_IMAGE_SIZE,Myspace.Upload.MEDIA_TYPES.COVER)},!0),comm.listen("photoCropper.canceled",function(){t=!1,a("#sidebar .mediaSquare").removeClass("photoObject loading")}),comm.listen("username.changed",function(b){a("#sidebar > header > h1 > a").attr("href","/"+b)},!0);var y=!1;comm.listen("videos.listeners.toasts.activate",function(){y||(comm.listen("videoUpload.transcoding.progress",function(b){var c=a("#toasts").find('li[data-video-release-id="'+b.videoReleaseId+'"]');c.length&&(b.progress<100?(c.find("progress").val(b.progress),c.find(".progress").text(b.progress+"% complete.")):(c.find("progress").replaceWith('<i class="endless"></i>'),c.find(".progress").text("Finalizing...")))},!0),comm.listen("videoUpload.transcoding.complete",function(b){var c=a("#toasts").find('li[data-video-release-id="'+b.videoReleaseId+'"]');c.length&&setTimeout(function(){comm.send("toasts.remove",c)},1e3)},!0),y=!0)},!0),comm.listen("like",function(a){var b={entitiesKey:a.entityKey,secLikeEntityKey:a.secLikeEntityKey};z("like",a,b)},!0),comm.listen("unlike",function(a){var b={entitiesKey:a.entityKey};z("unlike",a,b)},!0),comm.listen("showSiteAlert",function(b){b.class&&a("#siteAlert").addClass(b.class),a("#container").addClass("alert"),a("#siteAlertContent").html(b.text),a("#siteAlert .close").click(function(){a("#container").removeClass("alert")})},!0)})(jQuery);
(function(){function g(d){return c=0,b=!1,a.removeClass("dragging files"),comm.send("files.dropped",d),!1}function h(){if(f)return;f=!0;var a=e.shift();i(a)}function i(a){}var a=$(document.body),b,c=0,d,e=[],f;$.event.add(document.body,"drop",g),$.event.add(document.body,"dragenter dragleave",function(d){return d.type=="dragenter"?c++:d.type=="dragleave"&&c--,!b&&c>0?(b=!0,a.addClass("dragging files"),comm.send("files.enterDocument",d.originalEvent.dataTransfer.items)):c==0&&(b=!1,a.removeClass("dragging files"),comm.send("files.leaveDocument",d.originalEvent.dataTransfer.items)),!1}),comm.listen("files.select,files.selectone",function(a,b){d||(d=$("<input id=fileInput type=file style='left:-1000px;position:absolute;'>").hide().appendTo(document.body).bind("change",function(b){d.hide(),a&&a(b.target.files),d.val("")}));var c=b=="file.selectone";d.attr("multiple",c?null:"multiple").show().click()},!0),comm.listen("files.queue",function(a){e.concat(a),$("#test1").html(JSON.stringify(e,"	")),h()},!0)})();
var Myspace=Myspace||{};(function(a){Myspace.SortManager=function(b){function i(){h.$elem.bind("dragstart",function(a){k(a)}),h.$elem.bind("dragend",function(a){l(a)})}function j(){if(window.context.features.isPlayerQueueSortable){var b='li:not("'+h.ignoreSelectors+'")';h.$elem.children(b).each(function(){var b=a(this);b.data("sortable")||(h.drag&&b.bind("drag",function(a){c&&h.drag(a,c)}),b.bind("dragenter",function(a){c&&m(a)}),b.bind("dragover",function(a){c&&n(a)}),b.bind("dragleave",function(a){c&&o(a)}),b.bind("drop",function(a){c&&p(a)}),b.data("sortable",!0))})}else h.$elem.children('li:not([data-sortable="true"]):not("'+h.ignoreSelectors+'")').each(function(){var b=a(this);h.drag&&b.bind("drag",function(a){c&&h.drag(a,c)}),b.bind("dragenter",function(a){c&&m(a)}),b.bind("dragover",function(a){c&&n(a)}),b.bind("dragleave",function(a){c&&o(a)}),b.bind("drop",function(a){c&&p(a)}),b.attr("data-sortable","true")})}function k(b){if(Myspace.DragDropManager&&Myspace.DragDropManager.isBeingDragged())return!1;var i;f=!1,c=a(b.target).closest("li");if(c.is(h.ignoreSelectors))return!1;j(),c.removeClass("transp").addClass(h.draggingClass),d=e=c.index(),i=b.originalEvent.dataTransfer,h.dragText!==g&&i.setData("Text",h.dragText(b,c)),i.effectAllowed="copy",i.dropEffect="copy";var k=h.ghostDragee?h.ghostDragee(c):c;return i.setDragImage&&i.setDragImage(k[0],20,20),h.dragStart(b,c),!1}function l(a){return a.preventDefault(),!f&&d!==e&&r(e),h.dragEnd(a,c),c.removeClass(h.activeClass).removeClass(h.draggingClass),c=null,s.reset(),!1}function m(b){b.preventDefault();var d=a(b.target).closest("li");if(d[0]==c[0])return!1;s.enter(function(){q(d)})}function n(a){a.preventDefault();var b=a.originalEvent.dataTransfer;return b.dropEffect="copy",!1}function o(b){b.preventDefault();var d=a(b.target).closest("li");if(d[0]==c[0])return!1;s.leave(function(){})}function p(a){return a.preventDefault(),d===e?!1:(f=!0,h.drop&&h.drop(a,c),!1)}function q(a){var b=a.index();b===0?a.before(c):b<d?a.before(c):b>d&&a.after(c),a.addClass(h.hoverSupressorClass),c.addClass(h.activeClass),d=b}function r(a){q(h.$elem.children("li:eq("+a+")"))}function t(){h.$elem.unbind("dragend").unbind("dragstart")}var c,d,e,f=!1,g=function(){},h={$elem:b.$elem,ignoreSelectors:b.ignoreSelectors,activeClass:b.activeClass||"",draggingClass:b.draggingClass||"",hoverSupressorClass:b.hoverSupressorClass||"",helperClass:b.helperClass||"",dragText:b.dragText||g,dragStart:b.dragStart||g,dragEnd:b.dragEnd||g,dragEnter:b.dragEnter||g,dragLeave:b.dragLeave||g,drag:b.drag,drop:b.drop,ghostDragee:b.ghostDragee},s={count:0,enter:function(a){!this.count&&a&&a(),this.count++},leave:function(a){this.count--,!this.count&&a&&a()},reset:function(){this.count=0}};return i(),{rebind:i,unbind:t}}})(jQuery);
!function(a){"use strict",a(function(){a.support.transition=function(){var a=function(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in b)if(a.style[c]!==undefined)return b[c]}();return a&&{end:a}}()})}(window.jQuery),!function(a){"use strict";var b=function(a,b){this.init("tip",a,b)},c=/in/;b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,this.hideTimeout=undefined,this.options.trigger!="manual"&&(e=this.options.trigger=="hover"?"mouseenter":"focus",f=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&typeof b.delay=="number"&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show)return c.show();clearTimeout(this.timeout),c.hoverState="in",this.timeout=setTimeout(function(){c.hoverState=="in"&&c.show()},c.options.delay.show)},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.hide)return c.hide();clearTimeout(this.timeout),c.hoverState="out",this.timeout=setTimeout(function(){c.hoverState=="out"&&c.hide()},c.options.delay.hide)},show:function(){var b,d,e,f,g,h,i,j;if(this.hasContent()&&this.enabled){clearTimeout(this.hideTimeout),b=this.tip(),this.setContent(),b.attr("data-name",this.getTipName()),j=this.$element.attr("data-tip-class"),j=j||this.options.classes,this.options.animation&&b.addClass("fade"),h=typeof this.options.placement=="function"?this.options.placement.call(this,b[0],this.$element[0]):this.options.placement;if(h===!1)return;d=c.test(h),b.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body),e=this.getPosition(d),f=b[0].offsetWidth,g=b[0].offsetHeight;switch(d?h.split(" ")[1]:h){case"bottom":i={top:e.top+e.height,left:e.left+e.width/2-f/2};break;case"top":i={top:e.top-g,left:e.left+e.width/2-f/2};break;case"left":i={top:e.top+e.height/2-g/2,left:e.left-f};break;case"right":i={top:e.top+e.height/2-g/2,left:e.left+e.width}}!d&&(i.left+f>a(window).width()||i.top<10)&&(i={top:e.top+e.height/2-g/2,left:e.left-f},h="left"),b.css(i).addClass(h).addClass("in").addClass(j)}},isHTML:function(a){return typeof a!="string"||a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(a)},setContent:function(){var a=this.tip(),b=this.options.allowHtml?this.getTitle():htmlEncode(this.getTitle());a.find(".tip-inner")[this.options.allowHtml?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function d(){b.hideTimeout=setTimeout(function(){c.off(a.support.transition.end).remove()},500),c.one(a.support.transition.end,function(){clearTimeout(b.hideTimeout),c.remove()})}var b=this,c=this.tip();return c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d():c.remove(),this},fixTitle:function(){var a=this.$element;(a.attr("title")||typeof a.attr("data-original-title")!="string")&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||(typeof c.title=="function"?c.title.call(b[0]):c.title),a},getTipName:function(){return this.$element.attr("data-tip-name")||this.options.name},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)},addOKCustomClass:function(){this.tip().removeClass("warning error info").addClass("ok")},addWarningInfoClass:function(){this.tip().removeClass("ok error info").addClass("warning")},addErrorCustomClass:function(){this.tip().removeClass("ok warning info").addClass("error")},addInfoCustomClass:function(){this.tip().removeClass("ok warning error").addClass("info")}},a.fn.tip=function(c){return this.each(function(){var d=a(this),e=d.data("tip"),f=typeof c=="object"&&c;e||d.data("tip",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.tip.Constructor=b,a.fn.tip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tip"><div class="tip-arrow"></div><div class="tip-inner"></div></div>',trigger:"hover",title:"",delay:0,classes:""}}(window.jQuery);
(function(a){Myspace.Parallax=function(b,c){function i(){d=!1,c.css("transform","translate3d("+ -(f/2)+"px,0,0)"),e&&(c.show(),e=!1)}function j(){d||h(i),d=!0}function k(){g=b.width()*2}var d=!1,e=!1,f=0,g,h=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();b.length&&c.length&&b.on("scroll",function(){f=b[0].scrollLeft,f<g?j():e||(c.hide(),e=!0)}),a(window).resize(k),k()}})(jQuery);
var Myspace=Myspace||{};(function(a){function b(a,b,c){var d="center";return c&&c==1&&window.innerHeight-(b.bottom+b.top)/2>=a/2&&(b.bottom+b.top)/2>=a/2?d="center":window.innerHeight-60-b.bottom>=a?d="bottom":b.top>=a&&(d="top"),c&&c==2&&(b.top>=a?d="top":window.innerHeight-60-b.bottom>=a&&(b.bottom>a/2?d="center":d="bottom")),d}function c(a,b,c){if(c){if(window.innerWidth-b.right>=a)return"right";if(b.left>=a)return"left"}if(window.innerWidth-b.left>=a)return"right";if(b.right>=a)return"left"}function d(a,b,c,d){var e=a==="bottom"?c.bottom+6:c.top-b-6;return d&&(e=a=="center"?(c.bottom+c.top-b)/2-6:a=="bottom"?c.top:c.bottom-b),e}function e(a,b,c,d){return d?a==="right"?c.right+6:c.left-b-6:a==="right"?c.left:c.right-b}function f(a,b){return b.clientX>=a.left&&b.clientX<=a.right&&b.clientY>=a.top&&b.clientY<=a.bottom}Myspace.Popover=function(b,c){this.$popover=b,this.options=a.extend({autoHide:!0,preRender:function(a,b,c){c()},toggleClass:"popoverActive"},c)},Myspace.Popover.prototype.hide=function(){this.$popover.removeClass("open"),clearTimeout(this.mouseTimer),a(window).unbind("mousemove.popover resize.popover"),this.options.onHide&&this.options.onHide(this.$popover,this.$activeTarget),this.$activeTarget&&this.$activeTarget.removeClass(this.options.toggleClass),delete this.$activeTarget},Myspace.Popover.prototype.show=function(g,h,i){var j;if(this.$activeTarget){if(this.$activeTarget[0]===g[0]){if(this.options.toggleView){this.options.toggleView(this.$popover,this.$activeTarget,h);return}return}this.hide()}this.$activeTarget=g.addClass(this.options.toggleClass);var k=this;h&&(this.options=a.extend(this.options,h)),j=!i&&k.options.autoHide,this.options.preRender(this.$popover,g,function(){var h=g[0],l=k.options.side,m=h.getBoundingClientRect(),n=k.options.y||b(k.$popover.height(),m,l);n=="center"&&(l=1);var o=k.options.x||c(k.$popover.width(),m,l),p=d(n,k.$popover.height(),m,l),q=e(o,k.$popover.width(),m,l),r;p<0&&n=="center"&&(n="bottom",p=d(n,k.$popover.height(),m,l)),r={position:"fixed",top:p,left:q},l&&l==2&&(r=a.extend({},r,{display:"none"})),k.$popover.css(r).removeClass("top right bottom left side center").addClass("open "+n+" "+o+(l?" side":"")),l&&l==2&&k.$popover.fadeIn(1e3),j?(a(h).bind("mousewheel",function(){a(this).unbind("mousewheel"),k.hide()}),a(window).bind("mousemove.popover",function(a){k.mouseTimer&&clearTimeout(k.mouseTimer),k.mouseTimer=setTimeout(function(){!f(k.$popover[0].getBoundingClientRect(),a)&&!f(m,a)&&k.hide()},100)}).unbind("blur.popover").bind("blur.popover",function(){k.hide()})):i||a(window).bind("resize.popover",function(){k.hide()})})};var g={},h='<aside class="popover generic"><header></header><section></section></aside>';a.fn.popover=function(b){b=a.extend({intentDelay:400},b);var c,d,e;return b.id?(g[b.id]||(g[b.id]=a(h).attr("id",b.id).appendTo("body")),d=g[b.id]):d=a(h).appendTo("body"),e=new Myspace.Popover(d,b),this.each(function(){var f=a(this);if(f.data("popover-initialized"))return;f.data("popover-initialized",!0),f.bind("mouseenter.popover",function(){if(e.activeTarget===this)return;c=setTimeout(function(){b.title&&d.find("header").html(b.title),b.content&&d.find("section").html(b.content),e.show(f)},b.intentDelay)}).bind("mouseleave.popover",function(){c&&clearTimeout(c)})})}})(jQuery);
var Myspace=Myspace||{};(function(a){function h(a){Myspace.Confirm({closeAll:!1,text:a,yes:{text:"OK"},no:!1})}function i(a){var b=a.title?a.title:"this user";Myspace.Confirm({closeAll:!1,text:"Are you sure you want to block "+b+"? They will not be able to connect with you, your content, or send you messages.",yes:{text:"Confirm",onClick:function(){comm.send("block",a)}},no:{text:"Cancel"}})}function j(a){Myspace.Confirm({closeAll:!1,text:"You are connecting to a user that you have blocked. If you would like for them to be able to connect to you or see your content, you need to unblock them.  Unblock?",yes:{text:"Yes",onClick:function(){comm.send("unblock",a)}},no:{text:"No"}})}function k(b){var c=a('.playBtn[data-uid="'+b.uid+'"]'),d=objectify(c);new Myspace.LinkEmbedDialog(d)}function l(a,b,c){var d="connect.status",e={entityKey:a,isConnected:b,isPending:c};comm.send(d,e),scomm.send(d,e)}function m(a,b){var c=b.entityKey,d=a==="connect";b.source&&b.source.data("isConnected",d),b.isPending||l(c,d),b.onSuccess=function(e){var f=e.outboundState==="Pending";if(!e.success)a=="connect"&&f?h("This connection requires approval. A connection request has been sent."):a==="connect"&&e.outboundState==="Blocked"?h("Unfortunately, you cannot connect with this at this time."):e.statusCode==429?h("You have exceeded the permitted connect frequency.  Please try again later."):setTimeout(function(){Myspace.Error({yes:{onClick:function(){l(c,d),comm.send(a,b)}}})},550),l(c,!d,f);else{if(b.type==="mixtape")if(a==="disconnect")comm.send("mix.deleted",{entityKey:c});else{var g=b.id.split(",");comm.send("mix.addConnected",{playlistId:g[1],profileId:g[0]})}b.isPending&&!f&&l(c,d)}}}function n(a,b){var c=a.data("action"),e=a.data("requireLogin"),f=a.data("loginAction"),g=objectify(b);if(c==="connect"&&b.data("isBlocked")){j(g),comm.send("connect",g);return}if(e&&!Myspace.User.isLoggedIn){comm.send("login.prompt",{action:f,object:g.entityKey});return}g.item=a,g.source=b;var h;a.is("li")?h=new Tracking("HCard Menu",a.text(),g.type):h=new Tracking("Connect Button",c,g.type),comm.send("influencer.click",g.source),g.type==="profile"&&(g.id=g.profileId||g.artistId),c==="connect"||c==="disconnect"?m(c,g):(c==="like"||c==="unlike")&&A(c,g);if(c==="block"){i(g);return}if(c=="link/embed"){k(g),d.hide();return}if(["mix.selectAndAddItem","song.delete","video.delete"].indexOf(c)>-1){var l,n;l=b.closest(".right").siblings(".left").find(".playBtn"),l.length||(l=b.closest(".mediaSquare,.media").find(".playBtn")),l.length&&(n=objectify(l),g.mediaId=g.id,g.title=n.title,delete g.item,n.mediaReleaseId&&(g.releaseId=n.mediaReleaseId));if(c==="song.delete"||c==="video.delete")g.profileId=context.playlistOwnerProfileId,g.playlistId=context.playlistId,g.objectVersion=context.objectVersion,g.sequenceId=n.sequenceId,g.mediaType=n.mediaType}else if(c=="inline.comment"){var o=g.source.closest("li.streamItem");if(!o.length||!o.attr("data-activity-type"))c="connect>photoComment"}else if(c=="download"){var p=document.createElement("a");p.href=b.data("downloadUrl"),g.type=="video"&&(p.download="download"),document.body.appendChild(p),p.click()}c!=="connect"&&c!=="disconnect"&&c!=="connect>makeProfilePicture"&&c!=="connect>makeProfileCover"&&d.hide(),g.type==="video"&&g.mediaReleaseId&&(g.releaseEntityKey="videorelease_"+g.mediaReleaseId),comm.send(c,g)}function o(b,c){function j(a){return["Queue","Link/Embed"].indexOf(a)>-1}function k(b){return!!a('.playBtn[data-uid="'+b+'"]').length}var d="",e=b.find("ul"),h=c.data("type")||c.data("area").replace(/s+$/,""),i=f[h];if(!i)return;i.menu.forEach(function(b){if(c.attr("data-comment")==="false"&&b==="Comment")return;var e=g[b](c);if(e){if(j(e.title)&&!k(c.attr("data-uid")))return;var f=a("<li></li>").text(e.title).attr("data-action",e.action);e.requireLogin&&f.attr("data-require-login",!0).attr("data-login-action",e.loginAction),d+=f[0].outerHTML}}),e.html(d).unbind("click.hCard").bind("click.hCard",function(b){var d=a(b.target);if(d.is("li"))return n(d,c),!1})}function p(a){return a.data("entityKey")||a.data("area")+"_"+a.data("id")}function q(c,d,e){var f={id:c.data("id")},g=c.data("area"),h=p(c);if(b[h])return e(b[h]);f.entityKey=c.data("entityKey"),f.influencer=c.closest("[data-influencer]").data("influencer"),d||(f.getConnection=!0),g==="profiles"?f.profileid="profile_"+(c.data("profileId")!=="undefined")?c.data("profileId"):c.data("artistId"):g==="music"?f.type=c.data("type"):g==="mixes"?(f.profileid=c.data("profileId"),f.id=c.data("id").split(",")[1]):g==="stream"&&(f.actiontype=c.data("actiontype"),f.type=c.data("type"),f.itemaction=c.data("item-action")),a.ajax({type:"post",url:"/ajax/"+g+"/tooltip",data:f,success:function(a){return d&&(a.isConnected=c.data("isConnected"),a.isReverseConnected=c.data("isReverseConnected"),a.isPending=c.data("isPending")),g==="profiles"&&(a.title=a.title,a.imageUrl=a.imageUrl,c.attr("data-title",a.title),c.attr("data-image-url",a.imageUrl)),b[h]=a,e(b[h])}})}function r(b,c,d){comm.send("socialhcard.hide");var e=!c.hasClass("moreActivity"),g=typeof c.data("isConnected")=="undefined"?!1:!0,h=c.data("type")||c.data("area").replace(/s+$/,"");if(h==="none")return;if(e){if(h==="profile"&&c.data("profileid")===context.profileId)return;b.html('<div id="hCard"><ul></ul><section class="loading white"></section></div>').height(f[h].height),g&&o(b,c),c.data("area")?q(c,g,function(d){c.data("isReverseConnected",d.isReverseConnected),c.data("isConnected",d.isConnected),c.data("isPending",d.isPending),c.data("isBlocked",d.isBlocked),c.data("isPrivate",d.isPrivate),c.data("isOnline",d.isOnline),o(b,c),b.find("section").removeClass("loading").html(d.content).find('a[rel="tooltip"]').tip(),b.find("a").click(function(){}),b.find(".summaryDetails").length&&b.find(".affinitySummary.hasDetails > div").on("mouseenter mouseleave",function(){a(this).find(".summaryDetails").show(),b.css("height","auto")})}):b.find("#hCard").addClass("noContent"),s(c),d()}else q(c,!0,function(a){b.html(a),s(c),d()})}function s(b){b.bind("mousewheel",function(){a(this).unbind("mousewheel"),d.hide()})}function t(a,c){c&&c.hasClass("moreActivity")&&(b[p(c)]=a.html()),a.height("auto").html()}function u(b){b.find(".tooltips[data-popover-initialized!='true']").each(function(){var b=a(this);if(b.attr("data-popover-initialized"))return;b.attr("data-popover-initialized",!0),b.bind("mouseenter.popover",function(){if(d.$activeTarget&&d.$activeTarget[0]===this)return;c=setTimeout(function(){e.hasClass("dragging")||d.show(b)},400)}).bind("mouseleave.popover",function(){c&&clearTimeout(c)}),b.hasClass("connectButton")&&b.bind("touchstart.popover",function(){}