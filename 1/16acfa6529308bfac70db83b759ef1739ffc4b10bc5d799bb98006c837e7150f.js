"object"==typeof navigator&&function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Plyr",t):(e=e||self).Plyr=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],i=!0,a=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){a=!0,s=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var l={addCSS:!0,thumbWidth:15,watch:!0};var c=function(e){return null!=e?e.constructor:null},u=function(e,t){return Boolean(e&&t&&e instanceof t)},d=function(e){return null==e},h=function(e){return c(e)===Object},m=function(e){return c(e)===String},p=function(e){return Array.isArray(e)},f=function(e){return u(e,NodeList)},g={nullOrUndefined:d,object:h,number:function(e){return c(e)===Number&&!Number.isNaN(e)},string:m,boolean:function(e){return c(e)===Boolean},function:function(e){return c(e)===Function},array:p,nodeList:f,element:function(e){return u(e,Element)},event:function(e){return u(e,Event)},empty:function(e){return d(e)||(m(e)||p(e)||f(e))&&!e.length||h(e)&&!Object.keys(e).length}};function y(e,t){if(t<1){var n=(i="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(i[1]?i[1].length:0)-(i[2]?+i[2]:0)):0;return parseFloat(e.toFixed(n))}var i;return Math.round(e/t)*t}var v,b,k,w=function(){function t(n,i){e(this,t),g.element(n)?this.element=n:g.string(n)&&(this.element=document.querySelector(n)),g.element(this.element)&&g.empty(this.element.rangeTouch)&&(this.config=Object.assign({},l,i),this.init())}return n(t,[{key:"init",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){t.enabled&&(this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,n=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(e){t.element[n](e,function(e){return t.set(e)},!1)})}},{key:"get",value:function(e){if(!t.enabled||!g.event(e))return null;var n,i=e.target,a=e.changedTouches[0],s=parseFloat(i.getAttribute("min"))||0,r=parseFloat(i.getAttribute("max"))||100,o=parseFloat(i.getAttribute("step"))||1,l=r-s,c=i.getBoundingClientRect(),u=100/c.width*(this.config.thumbWidth/2)/100;return(n=100/c.width*(a.clientX-c.left))<0?n=0:n>100&&(n=100),n<50?n-=(100-2*n)*u:n>50&&(n+=2*(n-50)*u),s+y(l*(n/100),o)}},{key:"set",value:function(e){t.enabled&&g.event(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),function(e,t){if(e&&t){var n=new Event(t);e.dispatchEvent(n)}}(e.target,"touchend"===e.type?"change":"input"))}}],[{key:"setup",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null;if(g.empty(e)||g.string(e)?i=Array.from(document.querySelectorAll(g.string(e)?e:'input[type="range"]')):g.element(e)?i=[e]:g.nodeList(e)?i=Array.from(e):g.array(e)&&(i=e.filter(g.element)),g.empty(i))return null;var a=Object.assign({},l,n);g.string(e)&&a.watch&&new MutationObserver(function(n){Array.from(n).forEach(function(n){Array.from(n.addedNodes).forEach(function(n){if(g.element(n)&&function(){return Array.from(document.querySelectorAll(i)).includes(this)}.call(n,i=e)){var i;new t(n,a)}})})}).observe(document.body,{childList:!0,subtree:!0});return i.map(function(e){return new t(e,n)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),t}(),T=function(e){return null!=e?e.constructor:null},C=function(e,t){return Boolean(e&&t&&e instanceof t)},A=function(e){return null==e},E=function(e){return T(e)===Object},S=function(e){return T(e)===String},P=function(e){return Array.isArray(e)},N=function(e){return C(e,NodeList)},M=function(e){return A(e)||(S(e)||P(e)||N(e))&&!e.length||E(e)&&!Object.keys(e).length},x={nullOrUndefined:A,object:E,number:function(e){return T(e)===Number&&!Number.isNaN(e)},string:S,boolean:function(e){return T(e)===Boolean},function:function(e){return T(e)===Function},array:P,weakMap:function(e){return C(e,WeakMap)},nodeList:N,element:function(e){return C(e,Element)},textNode:function(e){return T(e)===Text},event:function(e){return C(e,Event)},keyboardEvent:function(e){return C(e,KeyboardEvent)},cue:function(e){return C(e,window.TextTrackCue)||C(e,window.VTTCue)},track:function(e){return C(e,TextTrack)||!A(e)&&S(e.kind)},promise:function(e){return C(e,Promise)},url:function(e){if(C(e,window.URL))return!0;if(!S(e))return!1;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!M(new URL(t).hostname)}catch(e){return!1}},empty:M},L=(v=document.createElement("span"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},k=Object.keys(b).find(function(e){return void 0!==v.style[e]}),!!x.string(k)&&b[k]);function I(e,t){setTimeout(function(){try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}},t)}var _={isIE:!!document.documentMode,isEdge:window.navigator.userAgent.includes("Edge"),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:/(iPad|iPhone|iPod)/gi.test(navigator.platform)};function O(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}function j(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(!n.length)return e;var s=n.shift();return x.object(s)?(Object.keys(s).forEach(function(t){x.object(s[t])?(Object.keys(e).includes(t)||Object.assign(e,i({},t,{})),j(e[t],s[t])):Object.assign(e,i({},t,s[t]))}),j.apply(void 0,[e].concat(n))):e}function q(e,t){var n=e.length?e:[e];Array.from(n).reverse().forEach(function(e,n){var i=n>0?t.cloneNode(!0):t,a=e.parentNode,s=e.nextSibling;i.appendChild(e),s?a.insertBefore(i,s):a.appendChild(i)})}function H(e,t){x.element(e)&&!x.empty(t)&&Object.entries(t).filter(function(e){var t=r(e,2)[1];return!x.nullOrUndefined(t)}).forEach(function(t){var n=r(t,2),i=n[0],a=n[1];return e.setAttribute(i,a)})}function D(e,t,n){var i=document.createElement(e);return x.object(t)&&H(i,t),x.string(n)&&(i.innerText=n),i}function F(e,t,n,i){x.element(t)&&t.appendChild(D(e,n,i))}function R(e){x.nodeList(e)||x.array(e)?Array.from(e).forEach(R):x.element(e)&&x.element(e.parentNode)&&e.parentNode.removeChild(e)}function V(e){if(x.element(e))for(var t=e.childNodes.length;t>0;)e.removeChild(e.lastChild),t-=1}function B(e,t){return x.element(t)&&x.element(t.parentNode)&&x.element(e)?(t.parentNode.replaceChild(e,t),e):null}function U(e,t){if(!x.string(e)||x.empty(e))return{};var n={},i=j({},t);return e.split(",").forEach(function(e){var t=e.trim(),a=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),o=r(s,1)[0],l=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":x.string(i.class)?n.class="".concat(i.class," ").concat(a):n.class=a;break;case"#":n.id=t.replace("#","");break;case"[":n[o]=l}}),j(i,n)}function W(e,t){if(x.element(e)){var n=t;x.boolean(n)||(n=!e.hidden),e.hidden=n}}function z(e,t,n){if(x.nodeList(e))return Array.from(e).map(function(e){return z(e,t,n)});if(x.element(e)){var i="toggle";return void 0!==n&&(i=n?"add":"remove"),e.classList[i](t),e.classList.contains(t)}return!1}function K(e,t){return x.element(e)&&e.classList.contains(t)}function Y(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}function Q(e){return this.elements.container.querySelectorAll(e)}function X(e){return this.elements.container.querySelector(e)}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];x.element(e)&&(e.focus({preventScroll:!0}),t&&z(e,this.config.classNames.tabFocus))}var $,G={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},Z={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check:function(e,t,n){var i=_.isIPhone&&n&&Z.playsinline,a=Z[e]||"html5"!==t;return{api:a,ui:a&&Z.rangeInput&&("video"!==e||!_.isIPhone||i)}},pip:!(_.isIPhone||!x.function(D("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||D("video").disablePictureInPicture)),airplay:x.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime:function(e){if(x.empty(e))return!1;var t=r(e.split("/"),1)[0],n=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(G).includes(n)&&(n+='; codecs="'.concat(G[e],'"'));try{return Boolean(n&&this.media.canPlayType(n).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:($=document.createElement("input"),$.type="range","range"===$.type),touch:"ontouchstart"in document.documentElement,transitions:!1!==L,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},ee=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e=!0,null}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function te(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e&&"addEventListener"in e&&!x.empty(t)&&x.function(n)){var o=t.split(" "),l=r;ee&&(l={passive:s,capture:r}),o.forEach(function(t){i&&i.eventListeners&&a&&i.eventListeners.push({element:e,type:t,callback:n,options:l}),e[a?"addEventListener":"removeEventListener"](t,n,l)})}}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];te.call(this,e,t,n,!0,i,a)}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];te.call(this,e,t,n,!1,i,a)}function ae(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];te.call(this,e,n,function r(){ie(e,n,r,a,s);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];i.apply(t,l)},!0,a,s)}function se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(x.element(e)&&!x.empty(t)){var a=new CustomEvent(t,{bubbles:n,detail:s({},i,{plyr:this})});e.dispatchEvent(a)}}function re(e){return!!(x.array(e)||x.string(e)&&e.includes(":"))&&(x.array(e)?e:e.split(":")).map(Number).every(x.number)}function oe(e){if(!x.array(e)||!e.every(x.number))return null;var t=r(e,2),n=t[0],i=t[1],a=function e(t,n){return 0===n?t:e(n,t%n)}(n,i);return[n/a,i/a]}function le(e){var t=function(e){return re(e)?e.split(":").map(Number):null},n=t(e);if(null===n&&(n=t(this.config.ratio)),null===n&&!x.empty(this.embed)&&x.array(this.embed.ratio)&&(n=this.embed.ratio),null===n&&this.isHTML5){var i=this.media;n=oe([i.videoWidth,i.videoHeight])}return n}function ce(e){if(!this.isVideo)return{};var t=this.elements.wrapper,n=le.call(this,e),i=r(x.array(n)?n:[0,0],2),a=100/i[0]*i[1];if(t.style.paddingBottom="".concat(a,"%"),this.isVimeo&&this.supported.ui){var s=(240-a)/4.8;this.media.style.transform="translateY(-".concat(s,"%)")}else this.isHTML5&&t.classList.toggle(this.config.classNames.videoFixedRatio,null!==n);return{padding:a,ratio:n}}var ue={getSources:function(){var e=this;return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(function(t){var n=t.getAttribute("type");return!!x.empty(n)||Z.mime.call(e,n)}):[]},getQualityOptions:function(){return this.config.quality.forced?this.config.quality.options:ue.getSources.call(this).map(function(e){return Number(e.getAttribute("size"))}).filter(Boolean)},setup:function(){if(this.isHTML5){var e=this;e.options.speed=e.config.speed.options,x.empty(this.config.ratio)||ce.call(e),Object.defineProperty(e.media,"quality",{get:function(){var t=ue.getSources.call(e).find(function(t){return t.getAttribute("src")===e.source});return t&&Number(t.getAttribute("size"))},set:function(t){if(e.quality!==t){if(e.config.quality.forced&&x.function(e.config.quality.onChange))e.config.quality.onChange(t);else{var n=ue.getSources.call(e).find(function(e){return Number(e.getAttribute("size"))===t});if(!n)return;var i=e.media,a=i.currentTime,s=i.paused,r=i.preload,o=i.readyState,l=i.playbackRate;e.media.src=n.getAttribute("src"),("none"!==r||o)&&(e.once("loadedmetadata",function(){e.speed=l,e.currentTime=a,s||e.play()}),e.media.load())}se.call(e,e.media,"qualitychange",!1,{quality:t})}}})}},cancelRequests:function(){this.isHTML5&&(R(ue.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function de(e){return x.array(e)?e.filter(function(t,n){return e.indexOf(t)===n}):e}function he(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return x.empty(e)?e:e.toString().replace(/{(\d+)}/g,function(e,t){return n[t].toString()})}function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),n.toString())}function pe(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function fe(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return(e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=me(e,"-"," "),e=me(e,"_"," "),me(e=pe(e)," ","")}(e)).charAt(0).toLowerCase()+e.slice(1)}function ge(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}var ye={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(x.empty(e)||x.empty(t))return"";var n=O(t.i18n,e);if(x.empty(n))return Object.keys(ye).includes(e)?ye[e]:"";var i={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(i).forEach(function(e){var t=r(e,2),i=t[0],a=t[1];n=me(n,i,a)}),n},be=function(){function t(n){e(this,t),this.enabled=n.config.storage.enabled,this.key=n.config.storage.key}return n(t,[{key:"get",value:function(e){if(!t.supported||!this.enabled)return null;var n=window.localStorage.getItem(this.key);if(x.empty(n))return null;var i=JSON.parse(n);return x.string(e)&&e.length?i[e]:i}},{key:"set",value:function(e){if(t.supported&&this.enabled&&x.object(e)){var n=this.get();x.empty(n)&&(n={}),j(n,e),window.localStorage.setItem(this.key,JSON.stringify(n))}}}],[{key:"supported",get:function(){try{if(!("localStorage"in window))return!1;return window.localStorage.setItem("___test","___test"),window.localStorage.removeItem("___test"),!0}catch(e){return!1}}}]),t}();function ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise(function(n,i){try{var a=new XMLHttpRequest;if(!("withCredentials"in a))return;a.addEventListener("load",function(){if("text"===t)try{n(JSON.parse(a.responseText))}catch(e){n(a.responseText)}else n(a.response)}),a.addEventListener("error",function(){throw new Error(a.status)}),a.open("GET",e,!0),a.responseType=t,a.send()}catch(e){i(e)}})}function we(e,t){if(x.string(e)){var n=x.string(t),i=function(){return null!==document.getElementById(t)},a=function(e,t){e.innerHTML=t,n&&i()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!i()){var s=be.supported,r=document.createElement("div");if(r.setAttribute("hidden",""),n&&r.setAttribute("id",t),s){var o=window.localStorage.getItem("".concat("cache","-").concat(t));if(null!==o){var l=JSON.parse(o);a(r,l.content)}}ke(e).then(function(e){x.empty(e)||(s&&window.localStorage.setItem("".concat("cache","-").concat(t),JSON.stringify({content:e})),a(r,e))}).catch(function(){})}}}var Te=function(e){return Math.trunc(e/60/60%60,10)},Ce=function(e){return Math.trunc(e/60%60,10)},Ae=function(e){return Math.trunc(e%60,10)};function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!x.number(e))return Ee(void 0,t,n);var i=function(e){return"0".concat(e).slice(-2)},a=Te(e),s=Ce(e),r=Ae(e);return a=t||a>0?"".concat(a,":"):"","".concat(n&&e>0?"-":"").concat(a).concat(i(s),":").concat(i(r))}var Se={getIconUrl:function(){var e=new URL(this.config.iconUrl,window.location).host!==window.location.host||_.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:e}},findElements:function(){try{return this.elements.controls=X.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:Q.call(this,this.config.selectors.buttons.play),pause:X.call(this,this.config.selectors.buttons.pause),restart:X.call(this,this.config.selectors.buttons.restart),rewind:X.call(this,this.config.selectors.buttons.rewind),fastForward:X.call(this,this.config.selectors.buttons.fastForward),mute:X.call(this,this.config.selectors.buttons.mute),pip:X.call(this,this.config.selectors.buttons.pip),airplay:X.call(this,this.config.selectors.buttons.airplay),settings:X.call(this,this.config.selectors.buttons.settings),captions:X.call(this,this.config.selectors.buttons.captions),fullscreen:X.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=X.call(this,this.config.selectors.progress),this.elements.inputs={seek:X.call(this,this.config.selectors.inputs.seek),volume:X.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:X.call(this,this.config.selectors.display.buffer),currentTime:X.call(this,this.config.selectors.display.currentTime),duration:X.call(this,this.config.selectors.display.duration)},x.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(".".concat(this.config.classNames.tooltip))),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon:function(e,t){var n=Se.getIconUrl.call(this),i="".concat(n.cors?"":n.url,"#").concat(this.config.iconPrefix),a=document.createElementNS("http://www.w3.org/2000/svg","svg");H(a,j(t,{role:"presentation",focusable:"false"}));var s=document.createElementNS("http://www.w3.org/2000/svg","use"),r="".concat(i,"-").concat(e);return"href"in s&&s.setAttributeNS("http://www.w3.org/1999/xlink","href",r),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r),a.appendChild(s),a},createLabel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ve(e,this.config);return D("span",s({},t,{class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")}),n)},createBadge:function(e){if(x.empty(e))return null;var t=D("span",{class:this.config.classNames.menu.value});return t.appendChild(D("span",{class:this.config.classNames.menu.badge},e)),t},createButton:function(e,t){var n=this,i=j({},t),a=fe(e),s={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(function(e){Object.keys(i).includes(e)&&(s[e]=i[e],delete i[e])}),"button"!==s.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some(function(e){return e===n.config.classNames.control})||j(i,{class:"".concat(i.class," ").concat(this.config.classNames.control)}):i.class=this.config.classNames.control,e){case"play":s.toggle=!0,s.label="play",s.labelPressed="pause",s.icon="play",s.iconPressed="pause";break;case"mute":s.toggle=!0,s.label="mute",s.labelPressed="unmute",s.icon="volume",s.iconPressed="muted";break;case"captions":s.toggle=!0,s.label="enableCaptions",s.labelPressed="disableCaptions",s.icon="captions-off",s.iconPressed="captions-on";break;case"fullscreen":s.toggle=!0,s.label="enterFullscreen",s.labelPressed="exitFullscreen",s.icon="enter-fullscreen",s.iconPressed="exit-fullscreen";break;case"play-large":i.class+=" ".concat(this.config.classNames.control,"--overlaid"),a="play",s.label="play",s.icon="play";break;default:x.empty(s.label)&&(s.label=a),x.empty(s.icon)&&(s.icon=e)}var r=D(s.element);return s.toggle?(r.appendChild(Se.createIcon.call(this,s.iconPressed,{class:"icon--pressed"})),r.appendChild(Se.createIcon.call(this,s.icon,{class:"icon--not-pressed"})),r.appendChild(Se.createLabel.call(this,s.labelPressed,{class:"label--pressed"})),r.appendChild(Se.createLabel.call(this,s.label,{class:"label--not-pressed"}))):(r.appendChild(Se.createIcon.call(this,s.icon)),r.appendChild(Se.createLabel.call(this,s.label))),j(i,U(this.config.selectors.buttons[a],i)),H(r,i),"play"===a?(x.array(this.elements.buttons[a])||(this.elements.buttons[a]=[]),this.elements.buttons[a].push(r)):this.elements.buttons[a]=r,r},createRange:function(e,t){var n=D("input",j(U(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":ve(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=n,Se.updateRangeFill.call(this,n),w.setup(n),n},createProgress:function(e,t){var n=D("progress",j(U(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){n.appendChild(D("span",null,"0"));var i={played:"played",buffer:"buffered"}[e],a=i?ve(i,this.config):"";n.innerText="% ".concat(a.toLowerCase())}return this.elements.display[e]=n,n},createTime:function(e,t){var n=U(this.config.selectors.display[e],t),i=D("div",j(n,{class:"".concat(n.class?n.class:""," ").concat(this.config.classNames.display.time," ").trim(),"aria-label":ve(e,this.config)}),"00:00");return this.elements.display[e]=i,i},bindMenuItemShortcuts:function(e,t){var n=this;ne.call(this,e,"keydown keyup",function(i){if([32,38,39,40].includes(i.which)&&(i.preventDefault(),i.stopPropagation(),"keydown"!==i.type)){var a,s=Y(e,'[role="menuitemradio"]');if(!s&&[32,39].includes(i.which))Se.showMenuPanel.call(n,t,!0);else 32!==i.which&&(40===i.which||s&&39===i.which?(a=e.nextElementSibling,x.element(a)||(a=e.parentNode.firstElementChild)):(a=e.previousElementSibling,x.element(a)||(a=e.parentNode.lastElementChild)),J.call(n,a,!0))}},!1),ne.call(this,e,"keyup",function(e){13===e.which&&Se.focusFirstMenuItem.call(n,null,!0)})},createMenuItem:function(e){var t=this,n=e.value,i=e.list,a=e.type,s=e.title,r=e.badge,o=void 0===r?null:r,l=e.checked,c=void 0!==l&&l,u=U(this.config.selectors.inputs[a]),d=D("button",j(u,{type:"button",role:"menuitemradio",class:"".concat(this.config.classNames.control," ").concat(u.class?u.class:"").trim(),"aria-checked":c,value:n})),h=D("span");h.innerHTML=s,x.element(o)&&h.appendChild(o),d.appendChild(h),Object.defineProperty(d,"checked",{enumerable:!0,get:function(){return"true"===d.getAttribute("aria-checked")},set:function(e){e&&Array.from(d.parentNode.children).filter(function(e){return Y(e,'[role="menuitemradio"]')}).forEach(function(e){return e.setAttribute("aria-checked","false")}),d.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(d,"click keyup",function(e){if(!x.keyboardEvent(e)||32===e.which){switch(e.preventDefault(),e.stopPropagation(),d.checked=!0,a){case"language":t.currentTrack=Number(n);break;case"quality":t.quality=n;break;case"speed":t.speed=parseFloat(n)}Se.showMenuPanel.call(t,"home",x.keyboardEvent(e))}},a,!1),Se.bindMenuItemShortcuts.call(this,d,a),i.appendChild(d)},formatTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return x.number(e)?Ee(e,Te(this.duration)>0,t):e},updateTimeDisplay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];x.element(e)&&x.number(t)&&(e.innerText=Se.formatTime(t,n))},updateVolume:function(){this.supported.ui&&(x.element(this.elements.inputs.volume)&&Se.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),x.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;x.element(e)&&(e.value=t,Se.updateRangeFill.call(this,e))},updateProgress:function(e){var t=this;if(this.supported.ui&&x.event(e)){var n,i,a=0;if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":n=this.currentTime,i=this.duration,a=0===n||0===i||Number.isNaN(n)||Number.isNaN(i)?0:(n/i*100).toFixed(2),"timeupdate"===e.type&&Se.setRange.call(this,this.elements.inputs.seek,a);break;case"playing":case"progress":!function(e,n){var i=x.number(n)?n:0,a=x.element(e)?e:t.elements.display.buffer;if(x.element(a)){a.value=i;var s=a.getElementsByTagName("span")[0];x.element(s)&&(s.childNodes[0].nodeValue=i)}}(this.elements.display.buffer,100*this.buffered)}}},updateRangeFill:function(e){var t=x.event(e)?e.target:e;if(x.element(t)&&"range"===t.getAttribute("type")){if(Y(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);var n=Se.formatTime(this.currentTime),i=Se.formatTime(this.duration),a=ve("seekLabel",this.config);t.setAttribute("aria-valuetext",a.replace("{currentTime}",n).replace("{duration}",i))}else if(Y(t,this.config.selectors.inputs.volume)){var s=100*t.value;t.setAttribute("aria-valuenow",s),t.setAttribute("aria-valuetext","".concat(s.toFixed(1),"%"))}else t.setAttribute("aria-valuenow",t.value);_.isWebkit&&t.style.setProperty("--value","".concat(t.value/t.max*100,"%"))}},updateSeekTooltip:function(e){var t=this;if(this.config.tooltips.seek&&x.element(this.elements.inputs.seek)&&x.element(this.elements.display.seekTooltip)&&0!==this.duration){var n="".concat(this.config.classNames.tooltip,"--visible"),i=function(e){return z(t.elements.display.seekTooltip,n,e)};if(this.touch)i(!1);else{var a=0,s=this.elements.progress.getBoundingClientRect();if(x.event(e))a=100/s.width*(e.pageX-s.left);else{if(!K(this.elements.display.seekTooltip,n))return;a=parseFloat(this.elements.display.seekTooltip.style.left,10)}a<0?a=0:a>100&&(a=100),Se.updateTimeDisplay.call(this,this.elements.display.seekTooltip,this.duration/100*a),this.elements.display.seekTooltip.style.left="".concat(a,"%"),x.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&i("mouseenter"===e.type)}}},timeUpdate:function(e){var t=!x.element(this.elements.display.duration)&&this.config.invertTime;Se.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Se.updateProgress.call(this,e)},durationUpdate:function(){if(this.supported.ui&&(this.config.invertTime||!this.currentTime)){if(this.duration>=Math.pow(2,32))return W(this.elements.display.currentTime,!0),void W(this.elements.progress,!0);x.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);var e=x.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Se.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Se.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),Se.updateSeekTooltip.call(this)}},toggleMenuButton:function(e,t){W(this.elements.settings.buttons[e],!t)},updateSetting:function(e,t,n){var i=this.elements.settings.panels[e],a=null,s=t;if("captions"===e)a=this.currentTrack;else{if(a=x.empty(n)?this[e]:n,x.empty(a)&&(a=this.config[e].default),!x.empty(this.options[e])&&!this.options[e].includes(a))return void this.debug.warn("Unsupported value of '".concat(a,"' for ").concat(e));if(!this.config[e].options.includes(a))return void this.debug.warn("Disabled value of '".concat(a,"' for ").concat(e))}if(x.element(s)||(s=i&&i.querySelector('[role="menu"]')),x.element(s)){this.elements.settings.buttons[e].querySelector(".".concat(this.config.classNames.menu.value)).innerHTML=Se.getLabel.call(this,e,a);var r=s&&s.querySelector('[value="'.concat(a,'"]'));x.element(r)&&(r.checked=!0)}},getLabel:function(e,t){switch(e){case"speed":return 1===t?ve("normal",this.config):"".concat(t,"&times;");case"quality":if(x.number(t)){var n=ve("qualityLabel.".concat(t),this.config);return n.length?n:"".concat(t,"p")}return pe(t);case"captions":return Me.getLabel.call(this);default:return null}},setQualityMenu:function(e){var t=this;if(x.element(this.elements.settings.panels.quality)){var n=this.elements.settings.panels.quality.querySelector('[role="menu"]');x.array(e)&&(this.options.quality=de(e).filter(function(e){return t.config.quality.options.includes(e)}));var i=!x.empty(this.options.quality)&&this.options.quality.length>1;if(Se.toggleMenuButton.call(this,"quality",i),V(n),Se.checkMenu.call(this),i){var a=function(e){var n=ve("qualityBadge.".concat(e),t.config);return n.length?Se.createBadge.call(t,n):null};this.options.quality.sort(function(e,n){var i=t.config.quality.options;return i.indexOf(e)>i.indexOf(n)?1:-1}).forEach(function(e){Se.createMenuItem.call(t,{value:e,list:n,type:"quality",title:Se.getLabel.call(t,"quality",e),badge:a(e)})}),Se.updateSetting.call(this,"quality",n)}}},setCaptionsMenu:function(){var e=this;if(x.element(this.elements.settings.panels.captions)){var t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),n=Me.getTracks.call(this),i=Boolean(n.length);if(Se.toggleMenuButton.call(this,"captions",i),V(t),Se.checkMenu.call(this),i){var a=n.map(function(n,i){return{value:i,checked:e.captions.toggled&&e.currentTrack===i,title:Me.getLabel.call(e,n),badge:n.language&&Se.createBadge.call(e,n.language.toUpperCase()),list:t,type:"language"}});a.unshift({value:-1,checked:!this.captions.toggled,title:ve("disabled",this.config),list:t,type:"language"}),a.forEach(Se.createMenuItem.bind(this)),Se.updateSetting.call(this,"captions",t)}}},setSpeedMenu:function(){var e=this;if(x.element(this.elements.settings.panels.speed)){var t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(function(t){return t>=e.minimumSpeed&&t<=e.maximumSpeed});var n=!x.empty(this.options.speed)&&this.options.speed.length>1;Se.toggleMenuButton.call(this,"speed",n),V(t),Se.checkMenu.call(this),n&&(this.options.speed.forEach(function(n){Se.createMenuItem.call(e,{value:n,list:t,type:"speed",title:Se.getLabel.call(e,"speed",n)})}),Se.updateSetting.call(this,"speed",t))}},checkMenu:function(){var e=this.elements.settings.buttons,t=!x.empty(e)&&Object.values(e).some(function(e){return!e.hidden});W(this.elements.settings.menu,!t)},focusFirstMenuItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.elements.settings.popup.hidden){var n=e;x.element(n)||(n=Object.values(this.elements.settings.panels).find(function(e){return!e.hidden}));var i=n.querySelector('[role^="menuitem"]');J.call(this,i,t)}},toggleMenu:function(e){var t=this.elements.settings.popup,n=this.elements.buttons.settings;if(x.element(t)&&x.element(n)){var i=t.hidden,a=i;if(x.boolean(e))a=e;else if(x.keyboardEvent(e)&&27===e.which)a=!1;else if(x.event(e)){var s=x.function(e.composedPath)?e.composedPath()[0]:e.target,r=t.contains(s);if(r||!r&&e.target!==n&&a)return}n.setAttribute("aria-expanded",a),W(t,!a),z(this.elements.container,this.config.classNames.menu.open,a),a&&x.keyboardEvent(e)?Se.focusFirstMenuItem.call(this,null,!0):a||i||J.call(this,n,x.keyboardEvent(e))}},getMenuSize:function(e){var t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);var n=t.scrollWidth,i=t.scrollHeight;return R(t),{width:n,height:i}},showMenuPanel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.elements.container.querySelector("#plyr-settings-".concat(this.id,"-").concat(t));if(x.element(i)){var a=i.parentNode,s=Array.from(a.children).find(function(e){return!e.hidden});if(Z.transitions&&!Z.reducedMotion){a.style.width="".concat(s.scrollWidth,"px"),a.style.height="".concat(s.scrollHeight,"px");var r=Se.getMenuSize.call(this,i);ne.call(this,a,L,function t(n){n.target===a&&["width","height"].includes(n.propertyName)&&(a.style.width="",a.style.height="",ie.call(e,a,L,t))}),a.style.width="".concat(r.width,"px"),a.style.height="".concat(r.height,"px")}W(s,!0),W(i,!1),Se.focusFirstMenuItem.call(this,i,n)}},setDownloadUrl:function(){var e=this.elements.buttons.download;x.element(e)&&e.setAttribute("href",this.download)},create:function(e){var t=this,n=Se.bindMenuItemShortcuts,i=Se.createButton,a=Se.createProgress,s=Se.createRange,r=Se.createTime,o=Se.setQualityMenu,l=Se.setSpeedMenu,c=Se.showMenuPanel;this.elements.controls=null,this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));var u=D("div",U(this.config.selectors.controls.wrapper));this.elements.controls=u;var d={class:"plyr__controls__item"};return de(this.config.controls).forEach(function(o){if("restart"===o&&u.appendChild(i.call(t,"restart",d)),"rewind"===o&&u.appendChild(i.call(t,"rewind",d)),"play"===o&&u.appendChild(i.call(t,"play",d)),"fast-forward"===o&&u.appendChild(i.call(t,"fast-forward",d)),"progress"===o){var l=D("div",{class:"".concat(d.class," plyr__progress__container")}),h=D("div",U(t.config.selectors.progress));if(h.appendChild(s.call(t,"seek",{id:"plyr-seek-".concat(e.id)})),h.appendChild(a.call(t,"buffer")),t.config.tooltips.seek){var m=D("span",{class:t.config.classNames.tooltip},"00:00");h.appendChild(m),t.elements.display.seekTooltip=m}t.elements.progress=h,l.appendChild(t.elements.progress),u.appendChild(l)}if("current-time"===o&&u.appendChild(r.call(t,"currentTime",d)),"duration"===o&&u.appendChild(r.call(t,"duration",d)),"mute"===o||"volume"===o){var p=t.elements.volume;if(x.element(p)&&u.contains(p)||(p=D("div",j({},d,{class:"".concat(d.class," plyr__volume").trim()})),t.elements.volume=p,u.appendChild(p)),"mute"===o&&p.appendChild(i.call(t,"mute")),"volume"===o&&!_.isIos){var f={max:1,step:.05,value:t.config.volume};p.appendChild(s.call(t,"volume",j(f,{id:"plyr-volume-".concat(e.id)})))}}if("captions"===o&&u.appendChild(i.call(t,"captions",d)),"settings"===o&&!x.empty(t.config.settings)){var g=D("div",j({},d,{class:"".concat(d.class," plyr__menu").trim(),hidden:""}));g.appendChild(i.call(t,"settings",{"aria-haspopup":!0,"aria-controls":"plyr-settings-".concat(e.id),"aria-expanded":!1}));var y=D("div",{class:"plyr__menu__container",id:"plyr-settings-".concat(e.id),hidden:""}),v=D("div"),b=D("div",{id:"plyr-settings-".concat(e.id,"-home")}),k=D("div",{role:"menu"});b.appendChild(k),v.appendChild(b),t.elements.settings.panels.home=b,t.config.settings.forEach(function(i){var a=D("button",j(U(t.config.selectors.buttons.settings),{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--forward"),role:"menuitem","aria-haspopup":!0,hidden:""}));n.call(t,a,i),ne.call(t,a,"click",function(){c.call(t,i,!1)});var s=D("span",null,ve(i,t.config)),r=D("span",{class:t.config.classNames.menu.value});r.innerHTML=e[i],s.appendChild(r),a.appendChild(s),k.appendChild(a);var o=D("div",{id:"plyr-settings-".concat(e.id,"-").concat(i),hidden:""}),l=D("button",{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--back")});l.appendChild(D("span",{"aria-hidden":!0},ve(i,t.config))),l.appendChild(D("span",{class:t.config.classNames.hidden},ve("menuBack",t.config))),ne.call(t,o,"keydown",function(e){37===e.which&&(e.preventDefault(),e.stopPropagation(),c.call(t,"home",!0))},!1),ne.call(t,l,"click",function(){}