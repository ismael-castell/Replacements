angular.module("csgp.api",[]).service("api",["$q","$http","log","config",function($q,$http,log,cfg){function logEnabled(){return log.getLevel().number<log.levels.INFO}function startLogMessage(title,data){logEnabled()&&data}function sendRequest(req,useStandardLanguageHeader){var time=+new Date,tag="Api "+req.method+": "+req.url+" ("+time+")";return startLogMessage(tag,req.data||req.params||"empty body or param"),useStandardLanguageHeader?(config.headers["Accept-Language"]=langHeader,delete config.headers["X-Page-Language"]):config.headers["X-Page-Language"]=langHeader,$http(angular.extend({},config,req))["catch"](function(reason){var r=JSON.stringify(reason);return reason&&reason.status==0||!(reason.config.method==="HEAD"&&reason.status===404),$q.reject(reason)})["finally"](function(){logEnabled()})}var accessToken=cfg.get("access_token"),langHeader=cfg.get("culture")+";q=0.8",config={headers:{"X-Page-Language":langHeader},wrapped:!0};return accessToken&&(config.headers.Authorization="Bearer "+accessToken),{get:function(url,params,useStandardLanguageHeader){return sendRequest({method:"GET",url:url,params:params},useStandardLanguageHeader)},post:function(url,data,canceller){var req={method:"POST",url:url,data:data};return canceller&&(req.timeout=canceller.promise),sendRequest(req)},send:function(req){return sendRequest(req)},head:function(){}