webpackJsonp([5],{254:function(e,t,i){e.exports=i.p+"images/components/src/images/packart-placeholder.jpg"},525:function(e,t,i){"use strict";function n(e,t,i,n,r,o){"ngInject";e.games=[],e.offset=0,e.limit=e.limit||Ay;var a=function(t){return e.total=_.get(t,[Dy,"numFound"],0),e.offset+=_.parseInt(_.get(t,[Dy,"numVisible"],0)),e.showMoreCta=e.offset<e.total,t},s=function(i){var r=_.get(i,[Dy,"game"],[]);_.isEmpty(r)?t.slideUp():n.staggerLoadGameTiles(e,e.games,r)},c=function(e){var t=e.message;i.error("[origin-access-gamelist SearchFactory.searchStore] failed",t)};e.search=function(){var t=n.buildSearchConfig(e,Ly,xy);e.isLoading=!0,o.searchStore(_.get(e,"query",""),t).then(a).then(s).catch(c)},r.populateScope(e,Fy).then(e.search)}function r(e,t,i,n,r,o,a){"ngInject";e.items=[],e.activeItemIndex=0,e.attached=!1;var s=void 0,c=angular.element(By),l=function(){s=c.offset()?c.offset().top:0};l(),a.events.on(My,l),e.$on("$destroy",function(){return a.events.off(My,l)}),i.isState("app.access")&&r.addScrollEventHandler(e,function(){var t=angular.element(window).scrollTop(),i=angular.element(Gy);_.forEach(i,function(i,n){$(i).offset().top-Uy-s<=t&&(e.activeItemIndex=n)})},100),e.navClick=function(r){if("#"===r.href.charAt(0)){var o=r.href.substring(1),a=jy+s;t.hash(o),n.scrollTo(o,a)}else!function(t){for(var i=0;i<e.items.length;i++)t.href!==e.items[i].href&&t.href!==e.items[i].hash||(e.activeItemIndex=i)}(r),i.goToState("app.access.tab",{cqPath:r.href})},this.registerMenuItem=function(t){e.items.push(t),_.get(o,"cqPath",null)===_.get(t,"href")&&(e.activeItemIndex=e.items.indexOf(t))},r.addScrollEventHandler(e,function(){var t=angular.element($y).height();window.pageYOffset>t-Ny?e.attached=!0:e.attached=!1,e.$digest()},50)}function o(e){"ngInject";return{restrict:"E",require:"^originAccessMenu",scope:{linkText:"@",linkUrl:"@",hash:"@"},link:function(t,i,n,r){e.populateScope(t,zy).then(function(){if(!_.isUndefined(r)&&_.isFunction(r.registerMenuItem)){var e={title:t.linkText,anchorName:t.linkText};t.hash?e.href="#"+t.hash:t.linkUrl&&(e.href=t.linkUrl),r.registerMenuItem(e)}})}}}function a(e,t){"ngInject";t.populateScope(e,Wy)}function s(e,t,i,n,r,o,a,s,c){"ngInject";function l(t){e.baseGameData=t.baseGame,e.score={grantedAchievements:t.grantedAchievements(),totalAchievements:t.totalAchievements(),grantedXp:t.grantedXp(),totalXp:t.totalXp()},Object.keys(t.expansions).length&&(e.expansionsData=t.expansions),e.isLoading=!1,e.$digest()}function d(t){if(!t.hidden){var i=t.achievementSets;for(var r in i)if(i.hasOwnProperty(r)&&_.includes(i[r].compatibleIds,e.achievementSetId))return void n.getAchievementSet(e.personaId,e.achievementSetId).then(l).catch(function(e){o.error("[Origin-Achievement-Details-Directive getAchievementset Method] error",e)})}Number(e.personaId)===Number(Origin.user.personaId())?c.goToState("app.profile.topic",{topic:"achievements"}):c.goUserProfile(e.nucleusId,"achievements")}function g(){n.getAchievementPortfolio(e.personaId).then(d).catch(function(e){o.error("[Origin-Achievements-Details-Directive getAchievementPortfolio] error",e)})}function u(t){e.personaId=t}var p=s.getLocalizedStrGenerator(Ky);e.isLoading=!0,e.achievementsCompletedLoc=p(e.achievementsCompletedStr,"achievementscompleted"),e.pointsCompletedLoc=p(e.pointsCompletedStr,"pointscompleted"),t.waitForAuthReady().then(function(){Number(e.nucleusId)!==Number(Origin.user.userPid())?i.getPersonaId(e.nucleusId).then(u).then(g).catch(function(e){o.error("[Origin-Achievements-Details-Directive getPersonaId] error",e)}):(e.personaId=Origin.user.personaId(),g())}),n.events.on("achievements:achievementGranted",g),e.$on("$destroy",function(){n.events.off("achievements:achievementGranted",g)})}function c(e,t,i,n){"ngInject";function r(t){e.gameAchievements=n.toArray(t.achievements)}function o(t){t.achievementSet.baseGame.id===e.achievementSet().id&&(r(t.achievementSet.baseGame),e.$digest())}e.limit=12,e.achievementLoc=t.getLocalizedStr(e.achievementStr,Jy,"achievement"),e.pointsLoc=t.getLocalizedStr(e.pointsStr,Jy,"points"),e.viewAllLoc=t.getLocalizedStr(e.viewAllStr,Jy,"viewall"),e.showAllTiles=function(){e.limit=e.gameAchievements.length},e.achievementSet().achievements&&r(e.achievementSet()),e.personaid===Origin.user.personaId().toString()&&(i.events.on("achievements:achievementGranted",o),e.$on("$destroy",function(){i.events.off("achievements:achievementGranted",o)}))}function l(e,t,i){"ngInject";if(-1===Number(e.date))e.notCompletedLoc=t.getLocalizedStr(e.notCompletedStr,eS,"notcompleted"),e.completedOnText=e.notCompletedLoc;else{var n=new Date(0);n.setUTCSeconds(e.date),e.completedOnLoc=t.getLocalizedStr(e.completedOnStr,eS,"completedon",{"%date%":i(n).format("LL")}),e.completedOnText=e.completedOnLoc}e.getPoints=function(){return"--"===e.points?"??":e.points}}function d(e,t,i,n,r,o,a,s,c){"ngInject";function l(i,n){e.isPrivate=i.hidden,i.hidden?e.achievementsPrivateLoc=t.getLocalizedStr(e.achievementsPrivateStr,iS,"achievementsprivate",{"%OriginId%":n[0].EAID}):(e.noGamesOtherTextLoc=t.getLocalizedStr(e.noGamesOtherTextStr,iS,"nogamesothertext",{"%OriginId%":n[0].EAID}),e.achievementSets=_.toArray(i.achievementSets),e.score={grantedAchievements:i.grantedAchievements(),totalAchievements:i.totalAchievements(),grantedXp:i.grantedXp(),totalXp:i.totalXp()})}function d(t){_.size(t)>0&&_.forEachRight(t,function(t,i){t&&e.achievementSets.splice(i,1)}),e.isLoading=!1,e.$digest()}function g(){var t=_.map(e.achievementSets,function(e){return a.getBaseGameEntitlementByAchievementSetId(e.achievementSetId).then(function(e){return s.isInternalTool(e)})});Promise.all(t).then(d)}function u(t){e.isLoading=!1,e.retry=!0,c.error("[Origin-Achievements-Otheruser-Directive displayRetryMessage Method] error",t)}function p(){Promise.all([r.getAchievementPortfolio(e.personaId),Origin.atom.atomUserInfoByUserIds([e.nucleusId])]).then(_.spread(l)).then(g).catch(u)}function m(t){e.personaId=t}function f(){n.getPersonaId(e.nucleusId).then(m).then(p).catch(function(e){c.error("[Origin-Achievements-Otheruser-Directive getPersonaId] error",e)})}function h(){e.achievementSets={},e.score=null,e.personaId=""}var v=t.getLocalizedStrGenerator(iS);e.isLoading=!0,e.retry=!1,e.overallProgressLoc=v(e.overallProgressStr,"overallprogress"),e.achievementsCompletedLoc=v(e.achievementsCompletedStr,"achievementscompleted"),e.pointsCompletedLoc=v(e.pointsCompletedStr,"pointscompleted"),e.noPeekingLoc=v(e.noPeekingStr,"nopeeking"),e.noGamesOtherTitleLoc=v(e.noGamesOtherTitleStr,"nogamesothertitle"),e.retryErrorTitleLoc=v(e.retryErrorTitleStr,"retryerrortitle"),e.retryErrorDescLoc=v(e.retryErrorDescStr,"retryerrordesc"),e.retryErrorCTALoc=v(e.retryErrorCTAStr,"retryerrorcta"),e.reloadCurrentRoute=function(){i.events.fire("origin-route:reloadcurrentRoute")},o.events.on("myauth:change",h),o.events.on("myauth:ready",f),e.$on("$destroy",function(){o.events.off("myauth:change",h),o.events.off("myauth:ready",f)}),e.loading=!0,o.waitForAuthReady().then(f).catch(function(e){c.error("[Origin-Achievements-Otheruser-Directive AuthReady] error",e)})}function g(e){"ngInject";e.degrees=0===e.totalPossible?0:Math.round(360*e.score/e.totalPossible),e.degrees>360?e.degrees=360:(e.degrees<0||!e.degrees)&&(e.degrees=0),e.rotationDegreesCSS={transform:"rotate("+e.degrees+"deg)","-webkit-transform":"rotate("+e.degrees+"deg)","-ms-transform":"rotate("+e.degrees+"deg)"}}function u(e,t,i,n,r,o){"ngInject";function a(t){e.nucleusId=Origin.user.userPid(),e.personaId=Origin.user.personaId(),e.achievementSets=t.achievementSets,e.score={grantedAchievements:t.grantedAchievements(),totalAchievements:t.totalAchievements(),grantedXp:t.grantedXp(),totalXp:t.totalXp()},e.isLoading=!1,e.$digest()}function s(){n.getAchievementPortfolio().then(a).catch(function(e){o.error("[Origin-Achievement-Self-Directive getAchievementportfolio Method] error",e)})}function c(){e.achievementSets={},e.score=null,e.nucleusId="",e.personaId=""}var l=t.getLocalizedStrGenerator(oS);e.isLoading=!0,e.overallProgressLoc=l(e.overallProgressStr,"overallprogress"),e.achievementsCompletedLoc=l(e.achievementsCompletedStr,"achievementscompleted"),e.pointsCompletedLoc=l(e.pointsCompletedStr,"pointscompleted"),e.noGamesSelfTitleLoc=l(e.noGamesSelfTitleStr,"nogamesselftitle"),e.noGamesSelfTextLoc=l(e.noGamesSelfTextStr,"nogamesselftext"),i.events.on("myauth:change",c),i.events.on("myauth:ready",s),n.events.on("achievements:achievementGranted",s),e.$on("$destroy",function(){i.events.off("myauth:change",c),i.events.off("myauth:ready",s),n.events.off("achievements:achievementGranted",s)}),i.waitForAuthReady().then(s).catch(function(e){o.error("[Origin-Achievements-Otheruser-Directive AuthReady] error",e)})}function p(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(){o.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd",{offerid:S})}function p(){if(w){var e={ocdPath:w};s.goToPdp(e)}}function m(t){void 0!==t&&_.has(t,"discover-tile-image")&&(e.image=_.get(t,"discover-tile-image")),e.$digest()}function f(e){n.error("[Origin-Achievement-Tile-Directive] error",e)}function h(e){var t,i=e.offerId,n=e.offerPath;k=!0,S=i,(t=n)&&(w=t,g.getOcdByPath(w).then(c.findDirectives("origin-game-defaults")).then(c.flattenDirectives("origin-game-defaults")).then(_.head).then(m).catch(_.partial(f,"getAchievementOcdData")))}function v(t){e.titleStr=t.baseGame.name,e.score={grantedAchievements:t.grantedAchievements(),totalAchievements:t.totalAchievements(),grantedXp:t.grantedXp(),totalXp:t.totalXp()}}function b(){e.loading=!1,e.$digest()}function y(){Promise.all([a.getBaseGameEntitlementByAchievementSetId(e.achievementSetId).then(h).catch(f),i.getAchievementSet(e.personaId,e.achievementSetId).then(v).catch(f)]).then(b).catch(b)}var S=void 0,k=!1,I=r.getLocalizedStrGenerator(sS),w=void 0;e.image=l.getImagePath("achievements-default-banner.png"),e.loading=!0,e.isTouchDisable=!r.isTouchEnabled(),e.viewDetailsLoc=I(e.viewDetailsStr,"viewdetails"),e.achievementsLoc=I(e.achievementsStr,"achievements"),e.pointsLoc=I(e.pointsStr,"points"),e.onCtaClicked=function(){e.isDetailsPage?k?u():p():Number(e.personaId)===Number(Origin.user.personaId())?d.goToState("app.profile.topic.details",{topic:"achievements",detailsId:e.achievementSetId}):d.goUserAchievementDetails("app.profile.user.topic.details",{id:e.nucleusId,topic:"achievements",detailsId:e.achievementSetId})},e.onTitleClicked=function(){k?u():p()},y(),t.events.on("myauth:ready",y),i.events.on("achievements:achievementGranted",y),e.$on("$destroy",function(){t.events.off("myauth:ready",y),i.events.off("achievements:achievementGranted",y)})}function m(e,t,i){"ngInject";t.getAutomationConfig()&&(this.buildGameStateStringFromObject=function(){var t=i.getGame(e.offerId,e.externalType);return t?JSON.stringify(t):""})}function f(e,t){"ngInject";return{restrict:"A",controller:m,link:function(i,n,r,o){function a(){n.attr("data-gamestate",o.buildGameStateStringFromObject())}function s(){this.buildGameStateStringFromObject=null,t.events.off("games:update:"+i.offerId,a)}e.getAutomationConfig()&&(a(),t.events.on("games:update:"+i.offerId,a),i.$on("$destroy",s))}}}function h(e,t,i,n){"ngInject";function r(t){t.show===n.ONLINE?e.presence=gS.online:t.isJoinable&&t.isCompatiblePlatform?e.presence=gS.joinable:t.show===n.INGAME?e.presence=gS.ingame:t.isBroadcasting?e.presence=gS.broadcasting:t.show===n.AWAY?e.presence=gS.away:t.show===n.UNAVAILABLE&&(e.presence=gS.offline)}var o=e.size===dS.xsmall?Origin.defines.avatarSizes.SMALL:Origin.defines.avatarSizes[e.size.toUpperCase()],a=[t.getAvatar(e.nucleusId,o),t.getUserInfo(e.nucleusId)];e.showPresence&&a.push(i.getFriendPresenceObserver(e.nucleusId)),Promise.all(a).then(_.spread(function(t,i,n){e.imgAlt=i.EAID,e.imgSrc=t,n&&n.onUpdate(e,r),e.show=!0,e.$digest()}))}function v(e,t){"ngInject";return{restrict:"E",transclude:!0,template:pS,link:function(e,i){function n(){var e,t,i,n=(e=d.getBoundingClientRect(),t=a.getBoundingClientRect(),i=window.innerWidth,t.left<0?-1*(t.left-yS):e.right>i?yS-(e.right-i):null);null!==n&&(d.style.left=n+"px",s.style.marginLeft=-1*n+yS+"px"),l.addClass(fS)}function r(){l.addClass(hS),n()}function o(){l.removeClass(fS),t.onTransitionEnd(l,function(){l.hasClass(fS)||l.removeClass(hS)})}var a,s,c,l=i.find("."+mS),d=l[0],g=angular.element(d.parentNode.parentNode);e.$on("$destroy",function(){clearTimeout(c),g.off("mouseenter",r),g.off("mouseleave",o)}),c=setTimeout(function(){a=i.find("."+vS)[0],s=i.find("."+bS)[0]},0),g.on("mouseenter",r),g.on("mouseleave",o)}}}function b(e,t){"ngInject";e.type=e.type||wS.primary,e.btnText=t.getLocalizedStr(e.btnText,IS,"description"),e.onBtnClick=function(){Origin.client.games.addNonOriginGame()}}function y(e,t,i,n,r,o){"ngInject";e.strings={wishlistAdd:r.getLocalizedStr(!1,TS,"add-wishlist-game-str"),wishlistRemove:r.getLocalizedStr(!1,TS,"remove-wishlist-game-str")},e.disableContextMenu=e.disableContextMenu||PS.false,e.onBtnClick=function(i){i.stopPropagation();var n=e.model.officialSite;t.openLink(e.buttonHref||n)};var a=function(){return i.getWishlist(Origin.user.userPid())},s=function(e,t){var i=t?{label:"wishlistRemove",callback:function(e){return function(){return a().removeOffer(e)}}(e),telemetryCssClass:"origin-telemetry-menu-item-wishlist-remove"}:{label:"wishlistAdd",callback:function(e){return function(){n.promiseLogin().then(function(){return a().addOffer(e)})}}(e),telemetryCssClass:"origin-telemetry-menu-item-wishlist-add"};return _.merge({enabled:!0,divider:!1},i)},c=function(t){var n,r=e.model.offerId,o=_.some(t.offerList,{id:r});if(e.contextMenuItems=[],i.isWishlistEnabled()){var a=s(r,o);e.contextMenuItems.push(((n=a).label=e.strings[n.label],n))}};e.$watchOnce("model.offerId",function(){e.disableContextMenu||o.getObserver(Origin.user.userPid(),e,r.unwrapPromiseAndCall(c))})}function S(e,t,i,n,r,o,a,s,c){"ngInject";function l(){e.type="",e.isVault===OS.true?t.entitleVaultGame(e.offerId):t.entitleFreeGame(e.offerId)}e.iconClass=nk,e.type=e.originalType=e.type||GS.primary,e.btnText=i.getLocalizedStr(e.description,ik,"description"),e.$watchOnce("offerId",function(t){n.getByOfferId(t).attachToScope(e,"model")}),e.$watchOnce("model",function(t){e.btnHref=r.getGdpUrl(t,!0)});var d=function(){e.type=e.originalType,e.$digest()};e.onBtnClick=function(t){e.$emit("cta:clicked"),e.$emit(Ey.J),t.stopPropagation(),t.preventDefault(),e.offerId&&e.model&&(s.events.once(Ey.H.ENTITLEMENT_FAILED_EVENT,d),c.openMobileDialogIfNecessary(l,e.model.offerId,e.btnText))},e.$on("$destroy",function(){s.events.off(Ey.H.ENTITLEMENT_FAILED_EVENT,d)}),e.onInfobubbleClick=function(e){e.stopPropagation()},a.lookUpOfferIdIfNeeded(e.ocdPath,e.offerId).then(function(t){e.offerId=t}).catch(function(e){o.error("[origin-cta-directacquisition]",e)})}function k(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(t){var i=c.getGame(e.offerid,e.externalType);t&&(e.btnText=t.phaseDisplay?t.phaseDisplay:t.label,h=t.clickAction,i&&i.progressInfo&&d.isEntitlementDownloadCompleted(i.progressInfo)&&(e.btnText=e.finalizingLoc,h=null),e.disabled=!h||t.disabled,e.telemetryCssClass=t.telemetryCssClass||"",e.$digest())}function p(){var i={externalType:e.externalType,overrideExternalType:e.overrideExternalType};t.getButtonState(e.offerid,e.ismoredetailsdisabled,i).then(u)}function m(t){if(e.offerid=t,void 0===e.externalType&&void 0===e.overrideExternalType){var n=i.getEntitlement(t,{includeAllExternalTypes:!0});n.length&&(e.externalType=n[0].externalType)}}var f,h=null;e.finalizingLoc=l.getLocalizedStr(e.finalizingstr,ak,"finalizingstr"),e.type=e.type||sk.primary,e.iconClass=ok,e.disabled=!1,e.onBtnClick=function(t){e.$emit("cta:clicked"),h&&(e.isgift===ck.true&&(g.enableBodyScrolling(),s.goToState("app.game_gamelibrary_wrapper.library")),h()),t.stopPropagation(),t.preventDefault()},e.onQuickDownloadClick=function(t){e.onBtnClick(t)},f=[i.events.on("games:releaseStateUpdate:"+e.offerid,p),i.events.on("games:update:"+e.offerid,p),i.events.on("games:downloadqueueupdate:"+e.offerid,p),i.events.on("games:progressupdate:"+e.offerid,p),i.events.once("games:initialClientStateReceived",p),a.events.on("myauth:clientonlinestatechanged",function(){p()})],e.$on("$destroy",function(){r.detachAll(f)}),n.lookUpOfferIdIfNeeded(e.ocdPath,e.offerid).then(function(t){if(void 0===e.offerid&&e.ocdPath){var r=n.getExistingCatalogInfo(t);if(r){var o=_.get(r,"masterTitleId","");if(o)return i.getBaseGameEntitlementByMasterTitleId(o).then(function(e){e&&m(e.offerId)})}}m(t)}).then(p).catch(function(e){o.error("[origin-cta-downloadinstallplay]",e)})}function I(e,t,i,n){"ngInject";var r=Origin.client.isEmbeddedBrowser()?gk:uk;e.isUnderAge=Origin.user.underAge(),e.btnText=i.getLocalizedStr(e.btnText,dk,"description"),e.onBtnClick=function(){e.href&&(e.href.indexOf("?")>=0?n.externalUrl(e.href+"&"+r,!0):n.externalUrl(e.href+"?"+r,!0))}}function w(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{buyAsGiftStr:"@",nucleusId:"@",isWarningRequired:"@",model:"=",type:"@"},link:function(e){function o(){e.nucleusId?i.loginAndStartCustomizeMessageFlow(e.model,{nucleusId:e.nucleusId,isWarningRequired:"true"===e.isWarningRequired}):i.loginAndStartGiftingFlow(e.model)}e.strings={};var a=void 0;e.buyAsGift=function(){a.then(function(){return r.openMobileDialogIfNecessary(o,_.get(e,["model","offerId"]),e.strings.buyAsGift)})},a=new Promise(function(i){e.$watchCollection("model",function(r){var o,a;r&&!_.isEmpty(r)&&(a=_.get(e,["model","formattedPrice"]),e.strings.buyAsGift=a?t.getLocalizedStr(e.buyAsGiftStr,fk,"buy-as-gift-str",{"%price%":a}):t.getLocalizedStr(e.buyAsGiftStr,fk,"buy-as-gift-str",{"%price%":""}),o=r,e.isGiftable=n.isGameGiftable(o),i())})})},template:mk}}function C(e,t,i){"ngInject";return{scope:{href:"@",btnText:"@description",type:"@",icon:"@"},link:function(e){e.iconClass=vk,e.type=e.type||bk.primary,e.isExternalLink=e.href&&!i.isInternalUrl(e.href),e.href&&(e.btnHref=t.getAbsoluteUrl(e.href)),e.onBtnClick=function(n){if(n.preventDefault(),n.stopPropagation(),e.$emit("cta:clicked"),i.isInternalUrl(e.href)){var r=i.getRelativeUrlInAngularContext(e.href);t.internalUrl(r)}else t.externalUrl(e.href,!0)}},template:kS}}function T(e,t,i,n,r){"ngInject";e.type=e.type||kk.primary,e.btnText=r.getLocalizedStr(e.btnText,Sk,"description"),e.onBtnClick=function(){n.events.fire("auth:login")}}function P(e,t,i,n,r){"ngInject";function o(e){i.error("[origin-cta-pdp]",e)}function a(i){s=_.head(_.values(i)),e.btnHref=t.getPdpUrl(s,!0)}var s=null;e.model={},e.iconClass=wk,e.type=e.type||Ck.primary,e.onBtnClick=function(){e.$emit("cta:clicked")};var c=e.$watchGroup(["ocdPath","offerId"],function(e){(e[0]||e[1])&&(c(),r.lookUpOfferIdIfNeeded(e[0],e[1]).then(n.toArray).then(r.getCatalogInfo).then(a).catch(o))})}function O(e,t,i){"ngInject";e.iconClass=Pk,e.type=e.type||Ok.primary,e.onBtnClick=function(n){e.$emit("cta:clicked","rich_media"),n.stopPropagation(),t.openDirective({id:_k,name:"origin-dialog-content-twitch",size:"large",data:{"dialog-id":_k,channel:e.channel,video:e.video,clip:e.clip,"mature-content":e.matureContent,"ocd-path":e.ocdPath,"content-text":e.contentText,"content-link":e.contentLink,"content-link-btn-text":e.contentLinkBtnText,"hide-packart":e.hidePackart}}),i.log("CTA: Playing Video")};var n=e.handler();n&&(e.onBtnClick=n)}function E(e,t,i){"ngInject";e.iconClass=Fk,e.type=e.type||Lk.primary,e.onBtnClick=function(n){e.$emit("cta:clicked","rich_media"),n.stopPropagation(),t.openDirective({id:xk,name:"origin-dialog-content-youtube",size:"fullScreen",closeOnStateChange:!0,data:{"dialog-id":xk,"video-id":e.videoId,"mature-content":e.matureContent,"ocd-path":e.ocdPath,"content-text":e.contentText,"content-link":e.contentLink,"content-link-btn-text":e.contentLinkBtnText,"hide-packart":e.hidePackart}}),i.log("CTA: Playing Video")};var n=e.handler();n&&(e.onBtnClick=n)}function F(e){"ngInject";e.getAutomationConfig()&&(this.automationCtaId="primary-cta")}function x(e,t,i,n){"ngInject";return{restrict:"E",template:kS,link:function(e){function i(){t.buy(e.model.offerId,{promoCode:e.promoCode})}e.type=Rk,e.onBtnClick=function(){e.$emit("cta:clicked"),n.openMobileDialogIfNecessary(i,e.model.offerId,e.btnText,e.promoLegalId)}}}}function L(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(t){return t.label=e.strings[t.label],t}function p(){return s.getWishlist(Origin.user.userPid())}function m(e){return function(){return c.promiseLogin().then(function(){return p().addOffer(e)})}}function f(t){t.offerId===e.model.offerId&&m(t.offerId)(),_.isFunction(S)&&setTimeout(S,0)}function h(e,t){var i={enabled:!0,divider:!1};return t?_.merge(i,{label:"wishlistRemove",callback:function(e){return function(){return p().removeOffer(e)}}(e),telemetryCssClass:"origin-telemetry-menu-item-wishlist-remove"}):_.merge(i,{label:"wishlistAdd",callback:m(e),telemetryCssClass:"origin-telemetry-menu-item-wishlist-add"}),i}function v(t){if(!e.disableContextMenu){var i=[],n=a.getGiftContextMenu(e.model);if(n&&!r.isOwnedOutright(e.model)&&o.isGameGiftable(e.model)&&(i.push(function(t){t=u(t);var i=_.get(t,"callback");return _.isFunction(i)&&(t.callback=function(n){var r=_.get(e,["model","offerId"]);g.openMobileDialogIfNecessary(function(){return i(n)},r,t.label)}),t}(n)),e.contextMenuItems=i),s.isWishlistEnabled()){var c=h(_.get(e,["model","offerId"]),t);i.push(u(c))}i.length>0&&i.push(u({label:"buy",callback:e.onBtnClick,enabled:!0,divider:!1,telemetryCssClass:"origin-telemetry-menu-item-buy-now"})),e.contextMenuItems=i,e.$digest()}}function b(t){v(_.some(t.offerList,{id:_.get(e,["model","offerId"])}))}var y=n.getLocalizedStrGenerator(Gk),S=void 0,k=new Promise(function(t){var i=e.$watchCollection("model",function(r){_.isUndefined(_.get(r,"giftable"))||_.isUndefined(_.get(r,"isOwned"))||(e.disableContextMenu||d.getObserver(Origin.user.userPid(),e,n.unwrapPromiseAndCall(b)),i(),t(r))})});e.iconClass=Nk,e.type="primary",e.disableContextMenu=e.disableContextMenu===OS.true,e.contextMenuItems=[],e.strings={gift:n.getLocalizedStr(!1,Uk,"gift-game-str"),wishlistAdd:n.getLocalizedStr(!1,Uk,"add-wishlist-game-str"),wishlistRemove:n.getLocalizedStr(!1,Uk,"remove-wishlist-game-str"),buy:n.getLocalizedStr(!1,Gk,"buy-contextmenu"),pricingErrorMessage:n.getLocalizedStr(e.pricingErrorMessage,Gk,"pricing-error-message")},e.onBtnClick=function(){c.promiseLogin().then(function(){return k}).then(function(t){e.$emit("cta:clicked"),e.$emit(Ey.J);var n=i.getPrimaryAction(t),r=_.get(e,["model","offerId"]);g.openMobileDialogIfNecessary(function(){return i.startActionFlow(t,n)},r,e.btnText)})},e.$watch("model.formattedPrice",function(){if(!_.isEmpty(e.model)){var t=e.model.formattedPrice,r={_BW:y(e.biowarepoints,"biowarepoints",{"%value%":e.model.price}),_FF:y(e.fifapoints,"fifapoints",{"%value%":e.model.price}),_FW:y(e.fifaworldpoints,"fifaworldpoints",{"%value%":e.model.price}),_PF:y(e.play4freefunds,"play4freefunds",{"%value%":e.model.price}),_SC:y(e.simscurrency,"simscurrency",{"%value%":e.model.price})};_.isNumber(e.model.price)&&r.hasOwnProperty(e.model.currency)&&(t=r[e.model.currency]),e.btnText=n.getLocalizedStr(!1,Gk,i.getPrimaryAction(e.model),{"%price%":t}),e.showPurchaseCTA=!!t}}),e.$watchOnce("model.offerId",function(){S=l.followQueue("addOfferToWishlistODC",f)}),e.$destroy=function(){_.isFunction(S)&&S()},e.ocdPath&&!e.model&&t.populateScopeWithOcdAndCatalog(e,Gk,e.ocdPath,function(t){e.model=t})}function A(e,t,i,n){"ngInject";e.type=e.type||"primary",e.btnText=t.getLocalizedStr(e.btnText,Mk,"description"),e.onBtnClick=function(){n.promiseLogin().then(i.redeemCode)}}function D(e,t,i,n,r){"ngInject";e.type=e.type||zk.primary,e.btnText=r.getLocalizedStr(e.btnText,Hk,"description"),e.onBtnClick=function(){n.events.fire("auth:register")}}function R(e,t,i,n,r){"ngInject";var o=this;o.isReady=!1,i.isUserInSingleMarketCountry().then(function(t){o.isUserInSingleMarketCountry=t,o.isReady=!0,e.$digest()}),o.onBtnClick=function(){o.isUserInSingleMarketCountry?i.openGeoPreferencesDialog().then(function(e){var t=e.accepted,i=e.result,o=i.languageLocale,a=i.storefront,s=i.country;t&&(r.setLocale(o,{reloadApp:!1}),n.setAndGoTo({storefront:a,languageLocale:o,country:s}))}):t.open({id:"origin-dialog-content-selectlanguage",xmlDirective:'<origin-dialog-content-selectlanguage class="origin-dialog-content"></origin-dialog-content-selectlanguage>'})}}function N(e,t,i){return{scope:{btnText:"@description",type:"@",articleId:"@"},link:function(e){e.iconClass=Qk,e.type=e.type||Jk.primary,e.onBtnClick=function(n){n.preventDefault(),n.stopPropagation(),e.$emit("cta:clicked"),i.log("about to fire contentreader:setArticleId event: "+e.articleId),t.events.fire(Kk,e.articleId)}},template:kS}}function G(e,t,i,n,r){"ngInject";var o=null,a={modal:!0,size:"medium",blocking:!1};e.isHidden=!0,e.config=a,e.id="",this.show=function(i){e.config=_.clone(a),e.id=i.id,e.isHidden=!1,Origin.utils.mix(e.config,i),function(e){_.forEach(e.directives,function(e){_.get(e,["data","class"])?e.data.class+="origin-dialog-content":e.data.class="origin-dialog-content"})}(i);var n=i.xmlDirective||r.buildHtml(i.directives);o=e.$new(),e.modalContent=t(n)(o),e.showContent(),e.isFullscreen="fullScreen"===e.config.size,e.$$phase||e.$digest()},this.hide=function(){n.events.fire("dialog:hidden"),e.isHidden=!0,i.digestIfDigestNotInProgress(e)},this.destroyScope=function(){o&&(o.$destroy(),o=null)}}function U(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",template:Zk,controller:G,link:function(c,l,d,g){function u(){v=setTimeout(function(){I=!0},300)}function p(){I=!1,clearTimeout(v)}function m(e){e.keyCode!==eI||c.config.blocking||(I?c.onClose(c.id):i.error("Ignore ESC. Window not in focus."))}function f(){y.css("height",0).css("height",b[0].scrollHeight+"px"),k.css("height",0).css("height",b[0].clientHeight<700?b[0].clientHeight-60:b[0].clientHeight+"px")}function h(){_.get(c,"config.closeOnStateChange")&&c.onClose(c.id)}var v,b=angular.element(l[0].querySelectorAll(".otkmodal")),y=angular.element(l[0].querySelectorAll(".otkmodal-backdrop")),S=angular.element(l[0].querySelectorAll(".otkmodal-content")),k=angular.element(l[0].querySelectorAll(".otkmodal-dialog")),I=!0;c.show=function(n){var s;n.id?c.isHidden||c.id?(b.css("display","block"),y.css("display","block"),b[0].offsetWidth,y[0].offsetWidth,f(),g.show(n),e.onTransitionEnd(b,(s={id:c.id},function(){c.id===s.id&&(f(),t.events.fire("cppDialog:showingDialog",{id:s.id}))})),a.disableBodyScrolling(),angular.element(r).on("keyup",m),angular.element(o).on("resize",f),angular.element(o).on("focus",u),angular.element(o).on("blur",p)):i.log("Dialog "+n.id+" already showing. Try again later"):i.error("dialog::show() arg.data didn't pass id - MUST PASS UNIQUE ID")},c.showContent=function(){S.html(""),S.append(c.modalContent)},c.hide=function(n){if(n&&n.id&&(i.log("Trying to close dialog with id: "+n.id+" | scope id: "+c.id),n.id!==c.id))i.error("not closing dialog. Ids don't match");else{a.enableBodyScrolling(),angular.element(r).off("keyup",m),angular.element(o).off("resize",f),angular.element(o).off("focus",u),angular.element(o).off("blur",p),g.hide();var s,l=(s={id:c.id,accepted:!!n&&n.accepted,content:n?n.content:{},shouldClose:!!n&&n.shouldClose},function(){s.shouldClose&&t.events.fire("cppDialog:finished",{id:s.id,accepted:!!s&&s.accepted,content:s?s.content:{}}),c.isHidden&&(b.css("display","none"),y.css("display","none"),g.destroyScope(),c.id="")});n&&0===n.stackSize?e.onTransitionEnd(b,l,tI):l()}},c.onClose=function(e){n.close(e)},c.onBackdropClick=function(){I&&!c.config.blocking&&n.close(c.id)},t.events.on("dialog:show",c.show),t.events.on("dialog:hide",c.hide),t.events.on("uiRouter:stateChangeSuccess",h),s.listenForScopeAndWindowDestroy(c,function(){t.events.off("dialog:show",c.show),t.events.off("dialog:hide",c.hide),t.events.off("uiRouter:stateChangeSuccess",h)}),t.events.fire("cppDialog:dialogSystemReady"),n.openPendingDialog()}}}function B(e,t,i){"ngInject";e.articleId=null;var n=t.events.on(Kk,function(t){e.articleId!==t&&(e.articleId=t,i.digestIfDigestNotInProgress(e))});e.$on("$destroy",function(){n.detach(),e.articleId=null})}function M(e,t,i,n,r,o,a,s,c,l){"ngInject";return{restrict:"E",scope:{articleId:"@"},link:function(d,g){function u(e,t){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_CONTENT_READER_TILE_SHARING_CLICK,{url:e,source:t})}function p(e){e.currentTarget.href&&(e.preventDefault(),Origin.windows.externalUrl(e.currentTarget.href))}function m(e){e.currentTarget.href&&(e.preventDefault(),d.onClose(),l.internalUrl(e.currentTarget.href))}function f(e){s.error("[Origin-Dialog-Contentreader-Directive handleContentReaderModalError] error",e)}function h(e){g.find(oI).append(i(e)(d)),d.isContentLoaded=!0,o.disableBodyScrolling(),a.addEventListener("keydown",d.processKeydown),Origin.client.isEmbeddedBrowser()&&angular.element(oI).on("click","a.external-link",p),angular.element(oI).on("click","a.internal-link",m),t.events.on(Ey.O,d.onClose),Origin.events.on(Origin.events.CLIENT_ONLINESTATECHANGED,v),c.digestIfDigestNotInProgress(d)}function v(e){e||d.onClose()}d.platform=Origin.utils.os(),d.shareonstr=e.getLocalizedStr(d.sharenowstr,rI,"shareonstr"),d.isContentLoaded=!1,d.onClose=function(){t.events.fire(Kk,null),g.find(oI).empty(),a.removeEventListener("keydown",d.processKeydown),o.enableBodyScrolling(),t.events.off(Ey.O,d.onClose),angular.element(oI).off("click","a.external-link",p),angular.element(oI).off("click","a.internal-link",m),Origin.events.off(Origin.events.CLIENT_ONLINESTATECHANGED,v),d.isContentLoaded=!1},d.onFacebookClick=function(){d.articleId&&n.getArticleUrl(d.articleId).then(function(e){r.openFacebookShareWindow({u:e}),u(e,cI)}).catch(f)},d.onTwitterClick=function(){d.articleId&&n.getArticleUrl(d.articleId).then(function(e){r.openTwitterShareWindow({url:e}),u(e,lI)}).catch(f)},d.processKeydown=function(e){(e.keyCode===aI||e.ctrlKey&&e.keyCode===sI)&&(e.stopPropagation(),e.preventDefault())},d.$watch("articleId",function(e){e&&function(e){n.getArticle(e).then(h).catch(f)}(e)}),d.$on("$destroy",function(){d.onClose()})},controller:B,template:nI}}function j(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function H(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function z(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function q(e,t,i,n,r,o,a,s,c,l,d){"ngInject";var g=void 0;Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_CANCEL_DIALOG),i.populateScope(e,vI,!1).then(function(){if(e.cancelAction===yI.v.SUSPENDED)g=moment(r.getExpiration()).format("LL"),e.titleStr="",e.datedDescription=e.cancelBasicAfterPremierTrialDescription.replace("%date%",g);else{var i=r.getStackedRecurringSubscription();g=i?moment(_.get(i,yI.D)).format("LL"):r.isRecurringSubscriber()?moment(r.getNextBillingDate()).format("LL"):moment(r.getExpiration()).format("LL"),e.datedDescription=t.getLocalizedStr(e.description,vI,"description",{"%date%":g})}e.$digest()});var u=new ew(c,o,s,l,r,d,a,e.cancelAction);e.continueBtnClick=function(){o.close(n.id),u.startSurvey(e.surveyTemplateName)},e.cancelBtnClick=function(){o.close(n.id)}}function Y(e,t,i,n){"ngInject";e.closeModal=function(){n.close(e.dialogId)},t.getByOfferId(e.offerId).attachToScope(e,function(t){e.model=t,e.gotoGdp=function(t){t.preventDefault(),n.setReturnValues(!1),e.closeModal(),i.goToGdp(e.model.gdpPath)},e.onActionButtonClick=function(){n.setReturnValues(!0),e.closeModal()},e.getGdpUrl=function(){return i.getGdpUrl(e.model)}})}function K(e,t,i,n,r){"ngInject";e.releaseStr=n.getLocalizedStr(e.releasestr,ow,"releasestr"),e.onLinkClick=function(e){r.externalUrl(e,!0)},aw||(aw=e.eulastr.replace(/href=/g,'class="otka" href ng-click=\'onLinkClick(').replace(/">/g,"\")'>"));var o=i(function(){angular.element("#origin-dialog-aboutclient-desc").html(t(aw)(e)),angular.element("origin-dialog-content-aboutclient").attr("eulastr","")},350);e.$on("$destroy",function(){i.cancel(o)})}function Q(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function J(e,t,i,n,r,o,a){"ngInject";var s,c;Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_BASE_GAME_UPSELL,e.telemetryDlcgameOcdpath),e.isOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.offerType=n.XSELL,e.strings={continueCtaStr:t.getLocalizedStr(e.continueCtaStr,yw,"continue-cta-str"),continueWithoutBasegameCtaStr:t.getLocalizedStr(e.continueWithoutBasegameCtaStr,yw,"continue-without-basegame-cta-str",Q({},hw,e.basegameName))};var l=t.getLocalizedStr(e.trialOnlyTitle,yw,"trial-only-title",Q({},hw,e.basegameName)),d=t.getLocalizedStr(e.trialOnlyWarning,yw,"trial-only-warning",(Q(s={},hw,"<strong>"+e.basegameName+"</strong>"),Q(s,vw,"<strong>"+e.dlcgameName+"</strong>"),s)),g=t.getLocalizedStr(e.titleStr,yw,"title-str",Q({},hw,e.basegameName)),u=t.getLocalizedStr(e.warningStr,yw,"warning-str",(Q(c={},hw,e.basegameName),Q(c,vw,e.dlcgameName),c));e.ownsTrialOnly===OS.true?(e.strings.titleStr=l||g,e.strings.warningStr=d||u):(e.strings.titleStr=g,e.strings.warningStr=u),this.handleOfferActions=function(t){var i=t.isSelected;e.isOfferAddedToCart=i,e.strings.continueStr=i?e.strings.continueCtaStr:e.strings.continueWithoutBasegameCtaStr},e.continueToCheckout=function(){i.close(e.dialogid),r.getCatalogInfo([e.dlcgameOfferid]).then(a.transformOffer).then(_.values).then(_.head).then(function(t){var i=o.getPrimaryAction(t);o.startActionFromPurchasePreventionModal(i,e.dlcgameOfferid,e.isOfferAddedToCart?e.basegameOfferid:void 0)})},this.handleOfferActions({isSelected:e.isOfferAddedToCart})}function X(e,t,i,n,r,o,a,s){"ngInject";function c(i){var n=_.keys(i);o.getCatalogInfo(n).then(_.values).then(function(r){_.forEach(n,function(e){var t=i[e]||[],n=_.find(r,function(t){return t.offerId===e});t.forEach(function(e){return d.push({baseGame:n,dlc:e})})}),d.length?(e.strings={},e.strings.btnContinue=a.getLocalizedStr(!1,Iw,"btncontinue"),e.strings.btnCancel=a.getLocalizedStr(!1,Iw,"btncancel"),e.strings.title=a.getLocalizedStr(!1,Iw,"title"),e.strings.description=a.getLocalizedStr(!1,Iw,"description"),e.strings.dlcDetails=[],d.forEach(l),e.$digest(),e.bindClick()):t.close(e.dialogid)})}function l(t){var i,n=t.baseGame,r=t.dlc,o=_.get(r,[DI.I,DI.k]);if(n){var c=s.getGdpUrl(n),l=_.get(n,[DI.I,DI.k]);e.strings.dlcDetails.push(a.getLocalizedStr(!1,Iw,"dlcdetail",{"%basegameLink%":(i=l,'<a class="otka baseGame" href="'+c+'">'+i+"</a>"),"%basegame%":l,"%dlcgame%":o}))}else e.strings.dlcDetails.push(a.getLocalizedStr(!1,Iw,"dlcdetail-generic-str",{"%dlcgame%":o}))}e.closeResponse=function(i){var n=i.continueToCheckout;t.setReturnValues(n,{}),t.close(e.dialogid)};var d=[];n.getGameDataWithEntitlements(e.bundle).then(r.toArray).then(i.getProductsWithBaseGameNotInCart).then(i.buildRequiredBaseGames).then(c)}function Z(e,t){"ngInject";return{restrict:"E",scope:{dialogid:"@",bundle:"="},link:function(i,n){i.bindClick=function(){setTimeout(function(){n.find(".baseGame").click(function(){e.close(i.dialogid),t.internalUrl(decodeURIComponent(this.href))})})}},controller:X,template:kw}}function ee(e,t,i,n){"ngInject";e.setLanguageString=t.getLocalizedStr(e.setLanguageStr,Cw,"setlanguage"),e.languages=[{key:"en_US",name:t.getLocalizedStr(e.englishStr,Cw,"english"),image:n.getImagePath("canada.png")},{key:"pl_PL",name:t.getLocalizedStr(e.polishStr,Cw,"polish"),image:n.getImagePath("poland.png")}],e.setLocale=function(e){i.events.fire("locale:change",e)}}function te(e,t,i,n,r,o,a){"ngInject";if(e.isVault=!1,e.strings={title:t.getLocalizedStr(e.titleStr,Pw,"title-str")},_.isArray(e.offers)){var s=!1,c=!1;_.find(e.offers,function(e){var t=i.getExistingCatalogInfo(e);return n.isOnTheHouse(t)&&(s=!0),(o.isVaultGame(t)||a.isPremierVaultGame(t))&&(c=!0),s});var l=e.offers.join(",");s?Origin.telemetry.sendMarketingEvent("Checkout","OTH",l):c?(e.isVault=!0,Origin.telemetry.sendMarketingEvent("Checkout","Vault",l)):Origin.telemetry.sendMarketingEvent("Checkout","Free",l)}}function ie(e,t,i,n,r){"ngInject";var o;e.strings={titleStr:t.getLocalizedStr(e.titleStr,Ew,"title-str"),description:t.getLocalizedStr(e.description,Ew,"description"),dismiss:t.getLocalizedStr(e.dismissText,Ew,"dismiss-text"),continue:t.getLocalizedStr(e.continueText,Ew,"continue-text")},e.btnClose=e.continueToPaymentProvider===Ow.true?e.strings.continue:e.strings.dismiss,e.acknowledgeWarning=(o=e.continueToPaymentProvider,function(){i.close(Ew),o&&(n.paymentProviderRedirectPrepare(),n.paymentProviderRedirectReady(e.type,{uri:e.redirectUri}))}),e.isOigContext=angular.isDefined(r.getOIGContextConfig())}function ne(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(e,t){return'<a href="'+t+'" class="otka external-link">'+e+"</a>"}function m(t,i){e.currentBalance=i,e.newBalance=i-t,e.$digest(),u.events.fire(Lw)}function f(t){t&&(e.state=Rw.PURCHASED,e.orderNumber=t,e.$digest())}function h(t){u.events.fire(Aw),c.close(e.dialogId),s.handleError(t)}var v=i.getLocalizedStrGenerator(Dw),b=v(e.termsofsalestr,"termsofsalestr"),y=v(e.termsofsalelink,"termsofsalelink"),S=v(e.eulasstr,"eulasstr"),k=v(e.eulaslink,"eulaslink"),I=v(e.aboutoriginstr,"aboutoriginstr"),w=v(e.aboutoriginlink,"aboutoriginlink"),C=v(e.eahelpstr,"eahelpstr"),T=v(e.eahelplink,"eahelplink");e.reviewOrderLoc=v(e.revieworderstr,"revieworderstr"),e.newBalanceLoc=v(e.newbalancestr,"newbalancestr"),e.placeOrderLoc=v(e.placeorderstr,"placeorderstr"),e.thankYouLoc=v(e.thankyoustr,"thankyoustr"),e.orderHistoryLoc=v(e.orderhistorystr,"orderhistorystr"),e.orderNumberLoc=v(e.ordernumberstr,"ordernumberstr"),e.totalLoc=v(e.totalstr,"totalstr"),e.downloadWithOriginLoc=v(e.downloadwithoriginstr,"downloadwithoriginstr"),e.backToGameLoc=v(e.backtogamestr,"backtogamestr"),e.checkoutDisclaimerLoc=v(e.checkoutdisclaimerstr,"checkoutdisclaimerstr",{"%termsofsale%":p(b,y),"%eulas%":p(S,k),"%aboutorigin%":p(I,w),"%eahelp%":p(C,T)}),e.isOIGContext=!!d.getOIGContextConfig(),e.states=Rw,e.state=Rw.LOADING,e.onPlaceOrder=function(){a.postVcCheckout(e.offerId).then(f).then(s.onPaymentSuccess).catch(h)},e.onBackToGame=function(){s.backToGame()},e.onDownloadWithOrigin=function(){c.close(e.dialogId),s.downloadGame(e.offerId)},e.onViewOrderHistory=function(){var e=d.getUrl("eaAccountsOrderHistory");Origin.client.isEmbeddedBrowser()||(e=(e=e.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),g.asyncOpenUrlWithEADPSSO(e)},o.getCatalogInfo([e.offerId]).then(l.transformOffer).then(r.toArray).then(r.takeHead).then(function(t){if(t&&!_.isEmpty(t)){var i=v(e.currencytypedefaultstr,"currencytypedefaultstr"),r={_BW:v(e.currencytypebwstr,"currencytypebwstr"),_FF:v(e.currencytypeffstr,"currencytypeffstr"),_FW:v(e.currencytypefwstr,"currencytypefwstr"),_PF:v(e.currencytypepfstr,"currencytypepfstr"),_SC:v(e.currencytypescstr,"currencytypescstr")},s=t.price,c={_BW:v(e.pricetypebwstr,"pricetypebwstr",{"%value%":t.price}),_FF:v(e.pricetypeffstr,"pricetypeffstr",{"%value%":t.price}),_FW:v(e.pricetypefwstr,"pricetypefwstr",{"%value%":t.price}),_PF:v(e.pricetypepfstr,"pricetypepfstr",{"%value%":t.price}),_SC:v(e.pricetypescstr,"pricetypescstr",{"%value%":t.price})},l=t.price,d={_BW:v(e.totaltypebwstr,"totaltypebwstr",{"%value%":t.price}),_FF:v(e.totaltypeffstr,"totaltypeffstr",{"%value%":t.price}),_FW:v(e.totaltypefwstr,"totaltypefwstr",{"%value%":t.price}),_PF:v(e.totaltypepfstr,"totaltypepfstr",{"%value%":t.price}),_SC:v(e.totaltypescstr,"totaltypescstr",{"%value%":t.price})};r.hasOwnProperty(t.currency)&&(i=r[t.currency]),c.hasOwnProperty(t.currency)&&(s=c[t.currency]),d.hasOwnProperty(t.currency)&&(l=d[t.currency]),t.hasPackArt=t.packArt!==o.defaultBoxArtUrl(),e.model=t,e.priceLoc=s,e.state=n.isOwnedOutright(t)?Rw.PURCHASED:Rw.REVIEW,e.totalPriceLoc=l,e.currentBalanceLoc=v(e.currentbalancestr,"currentbalancestr",{"%currencytype%":i}),a.getWalletBalance(t.fictionalCurrencyCode).then(_.partial(m,t.price))}}).catch(function(i){c.close(e.dialogId),t.error("["+Dw+"]",i)})}function re(e,t){"ngInject";e.closeResponse=function(i){t.setReturnValues(i,{id:e.dialogid}),t.close(e.dialogid)}}function oe(e,t,i){"ngInject";return{restrict:"E",scope:{dialogid:"@",isFree:"@",dlcgame:"@",basegame:"@",basehref:"@",isCurrency:"@",thirdParty:"@",ownsTrialOnly:"@"},link:function(n,r){n.buildStrings=function(){var t=e.escapeAndDecodeURIComponent(n.dlcgame),i=e.escapeAndDecodeURIComponent(n.basegame),r=e.escapeAndDecodeURIComponent(n.basehref),o={"%dlcgame%":t,"%basegame%":i,"%basegameLink%":'<a class="otka baseGame" href="'+r+'">'+i+"</a>"};n.strings=n.strings||{},n.strings.btnContinue="",n.strings.btnCancel=e.getLocalizedStr(!1,Uw,jw),n.isCurrency===Jw.true?(n.strings.title=e.getLocalizedStr(!1,Uw,Ww,o),n.strings.description=e.getLocalizedStr(!1,Uw,qw,o)):(n.strings.title=e.getLocalizedStr(!1,Uw,Hw,o),n.strings.description=e.getLocalizedStr(!1,Uw,zw,o),n.strings.btnContinue=e.getLocalizedStr(!1,Uw,Bw)),n.isFree===Jw.true&&(n.strings.description=e.getLocalizedStr(!1,Uw,Vw,o),n.strings.btnContinue=e.getLocalizedStr(!1,Uw,Mw)),n.basegame||(n.strings.title=e.getLocalizedStr(null,Uw,Yw),n.strings.description=e.getLocalizedStr(null,Uw,Kw)),n.ownsTrialOnly===Jw.true&&(n.strings.description=e.getLocalizedStr(!1,Uw,Qw),n.strings.btnContinue=e.getLocalizedStr(!1,Uw,Bw))},n.buildStrings(),setTimeout(function(){r.find(".baseGame").click(function(){t.close(n.dialogid),i.internalUrl(decodeURIComponent(n.basehref))})},0)},controller:re,template:Gw}}function ae(e){"ngInject";return{transclude:!0,scope:{dialogid:"@",titleStr:"@",descriptionStr:"@",targetOfferDisplayName:"@",targetOfferid:"@",telemetryTargetOfferOcdpath:"@",continueWithoutDlcCtaStr:"@",continueCtaStr:"@"},controller:se,link:function(t){var i={titleStr:e.getLocalizedStr(t.titleStr,eC,"title-str",{"%basegameName%":t.targetOfferDisplayName}),descriptionStr:e.getLocalizedStr(t.descriptionStr,eC,"description-str",{"%basegameName%":t.targetOfferDisplayName})};t.strings=t.strings?Object.assign(t.strings,i):i},template:Zw}}function se(e,t,i,n,r,o){"ngInject";function a(){e.isAnyOfferAddedToCart=!s.has(e.targetOfferid)||s.size>1||e.vaultOfferAdded,e.strings.continueStr=e.isAnyOfferAddedToCart?e.strings.continueCtaStr:e.strings.continueWithoutDlcCtaStr}Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_DLC_UPSELL_XSELL,e.telemetryTargetOfferOcdpath),e.isAnyOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.vaultOfferAdded=!1,e.strings={continueCtaStr:t.getLocalizedStr(e.continueCtaStr,eC,"continue-cta-str"),continueWithoutDlcCtaStr:t.getLocalizedStr(e.continueWithoutDlcCtaStr,eC,"continue-without-dlc-cta-str",{"%basegameName%":e.targetOfferDisplayName})};var s=new Set([e.targetOfferid]);this.handleOfferActions=function(t){var i=t.offerId,c=t.isSelected,l=t.offerType,d=l===n.UPSELL,g=l===n.VAULT,u=l===n.FREE,p=void 0;c?(e.isContinueToCheckoutDisabled=g||u,g?p=r.entitleVaultGame(i,!1,{showCheckoutConfirmation:!1}):u?p=r.entitleFreeGame(i,!1,!1):(s.add(i),d&&s.delete(e.targetOfferid))):i&&(s.delete(i),d&&s.add(e.targetOfferid)),p?p.then(function(){e.vaultOfferAdded=!0,a()}).catch(function(e){o.error("["+eC+"] error entitling "+l+" offer",e)}).finally(function(){e.isContinueToCheckoutDisabled=!1,e.$digest()}):a()},e.continueToCheckout=function(){var t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(s.keys()));i.setReturnValues(!0,{id:e.dialogid,offerIds:t}),i.close(e.dialogid)},this.handleOfferActions({isSelected:e.isAnyOfferAddedToCart})}function ce(e,t,i,n,r){"ngInject";function o(t){t.accepted&&e.accepted&&e.offerid&&i.activateGift(e.offerid),a()}function a(){n.events.off("dialog:hide",o)}e.accepted=!1,e.onAcceptedChanged=function(){r.update({acceptEnabled:e.accepted,offerid:e.offerid})},e.openCookiePrivacyUrl=function(i){i.preventDefault(),t.externalUrl(e.cookieprivacyurl)},e.$on("$destroy",a),n.events.on("dialog:hide",o)}function le(e,t,i,n,r,o){"ngInject";function a(t){"origin-dialog-content-downloadinfo"===t.contentType&&(e.insufficientspacetext=t.content.insufficientspacetext,e.changeinstallationlocationtext=t.content.changeinstallationlocationtext,e.downloadSizeLabel=t.content.downloadSizeLabel,e.installedSizeLabel=t.content.installedSizeLabel,e.downloadSizeLoc=i.formatBytesWithNotation(e.downloadSize),e.installedSizeLoc=i.formatBytesWithNotation(e.installedSize),e.$digest())}function s(){Origin.client.desktopServices.getVolumeDiskSpace(e.path).then(function(t){e.insufficientspace=!(t>=e.downloadSize&&t>=e.installedSize);var r=Math.max(e.downloadSize,e.installedSize),o=i.formatBytesWithNotation(r-t);e.updateErrorString(e.insufficientspacetext.replace("%1",o)),n.update({acceptEnabled:!e.insufficientspace}),e.$digest()})}var c;e.extraContentText=i.getLocalizedStr(e.extraContentText,iC,"extracontentstr"),e.installlocationstr=i.getLocalizedStr(e.installlocationstr,iC,"installlocationstr")||"Install Location",e.changelocationstr=i.getLocalizedStr(e.changelocationstr,iC,"changelocationstr")||"Change Folder",e.downloadSizeLoc=i.formatBytesWithNotation(e.downloadSize),e.installedSizeLoc=i.formatBytesWithNotation(e.installedSize),e.isNewClient=!0,Origin.client.desktopServices.getVolumeDiskSpace(e.path).then(function(){s(),c=r(function(){s()},4e3)}).catch(function(){e.isNewClient=!1,e.$digest()}),e.setElem=function(t){var n,r=i.getLocalizedStrGenerator(iC);"true"!==e.insufficientspace&&!0!==e.insufficientspace||(e.insufficientspacetext=r(e.insufficientspacetext,"insufficientspacetext",{"%changeinstallationlocationtext%":(n=e.changeinstallationlocationtext,'<a class="otka" ng-click="'+"changeInstallationLocation()"+'">'+n+"</a>")})),e.changeInstallationLocation=function(){Origin.client.installDirectory.chooseDownloadInPlaceLocation()},"true"!==e.insufficientspace&&!0!==e.insufficientspace||t.find(".origin-cldialog-downloadinfo-warning-text2").append(o("<span>"+e.insufficientspacetext+"</span>")(e))},e.browseForInstallationLocation=function(){Origin.client.installDirectory.browseForDownloadInPlaceLocation().then(function(t){e.path=t+e.folder,s()})},t.events.on("dialog:update",a),e.$on("$destroy",function(){t.events.off("dialog:update",a),e.isNewClient&&r.cancel(c)})}function de(e){"ngInject";e.locales=[]}function ge(e,t,i,n){"ngInject";function r(e,t){return e.replace("{errorCode}",t)}e.replace=JSON.parse(decodeURI(e.replace||"{}")),e.strings=function(){function t(t,i,o){var a=n.getLocalizedStr(e[t],sC,t,o);return _.isString(a)&&0===a.length&&(t=r(i,cC),a=n.getLocalizedStr(e[t],sC,t,o)),a}var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cC,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o["{errorCode}"]=i,{title:t(r(lC,i),lC,o),body:t(r(dC,i),dC,o)}}(e.errorCode,e.replace),t.setReturnValues(!1,{errorCode:e.errorCode,closedByUser:!0}),i.error("Error Modal: ["+e.strings.title+"] "+e.strings.body)}function ue(e,t){"ngInject";return{restrict:"E",scope:{dialogId:"@",errorCode:"@",replace:"@",titleDefault:"@",bodyDefault:"@",titleTimeout:"@",bodyTimeout:"@",titleOaxAlreadyOwnSubscription:"@",bodyOaxAlreadyOwnSubscription:"@",bodyOaxCheckoutErrorDefault:"@",bodyBadInput:"@",bodyErrorNotKnown:"@",titleYouownthis:"@",bodyYouownthis:"@"},controller:ge,link:function(i,n){n.on("click","a.otka",function(n){var r=n.currentTarget.getAttribute("href");t.isInternalUrl(r)&&(e.setReturnValues(!1,{errorCode:i.errorCode,closedByUser:!1}),e.close(i.dialogId))})},template:aC}}function pe(e,t,i){"ngInject";e.strings={titleStr:i.getLocalizedStr(e.titleStr,uC,"title-str"),content:i.getLocalizedStr(e.content,uC,"content"),imageUrl:i.getLocalizedStr(e.imageUrl,uC,"image-url"),btnText:i.getLocalizedStr(e.btnText,uC,"btn-text")},e.onBtnClick=function(){t.close(e.dialogId)}}function me(e){"ngInject";e.friendsListStr=e.friendsListStr||"",e.friends=e.friendsListStr.split(",")}function fe(e,t,i,n){"ngInject";var r=this;e.generalLoc=t.getLocalizedStr(e.generalstr,fC,"generalstr"),e.cloudSavesLoc=t.getLocalizedStr(e.cloudsavesstr,fC,"cloudsavesstr"),e.advancedLoc=t.getLocalizedStr(e.advancedstr,fC,"advancedstr"),e.saveLoc=t.getLocalizedStr(e.savestr,fC,"savestr"),e.cancelLoc=t.getLocalizedStr(e.cancelstr,fC,"cancelstr");var o=t.getLocalizedStr(e.titlestr,fC,"titlestr");e.save=function(){e.$broadcast("origin-dialog-content-gameproperties:save"),i.closeDialog()},e.cancel=function(){i.closeDialog()},e.$watch("gameProperties.gameTitle",function(){!e.dlgTitle&&e.gameProperties.gameTitle&&(e.dlgTitle=o.replace("%game%",e.gameProperties.gameTitle))}),n.create(i.getGamePropertiesObservable()).attachToScope(e,"gameProperties"),this.isSet=function(e){return this.tab===e},this.setTab=function(e){this.tab=e;var t=$(".origin-gameproperties-nav li")[this.tab];t&&$(".origin-gameproperties-nav .otknav-pills-bar").css({width:$(t).width()+"px",transform:"translate3d("+$(t).position().left+"px, 0px, 0px)"})},this.tab=0,setTimeout(function(){r.setTab(0)})}function he(e,t,i,n){"ngInject";e.whenLaunchingLoc=t.getLocalizedStr(e.whenlaunchingstr,vC,"whenlaunchingstr"),e.commandLineLoc=t.getLocalizedStr(e.commandlinestr,vC,"commandlinestr"),e.availableLocalesLoc=t.getLocalizedStr(e.availablelocalesstr,vC,"availablelocalesstr"),e.goOnlineLoc=t.getLocalizedStr(e.goonlinestr,vC,"goonlinestr"),e.offlineWarningLoc=t.getLocalizedStr(e.offlinewarningstr,vC,"offlinewarningstr"),e.multiLaunchOptions=[],e.$on("origin-dialog-content-gameproperties:save",function(){e.advanced.isNOG||n.saveGamePropertiesAdvanced({commandLineText:e.advanced.commandLineText,selectedLaunchOption:e.advanced.selectedLaunchOption,selectedLocale:e.advanced.selectedLocale})}),i.create(n.getGamePropertiesObservable()).attachToScope(e,"advanced"),i.create(n.getClientPropertiesObservable()).attachToScope(e,"client")}function ve(e,t,i,n,r,o,a){"ngInject";var s=[];e.cloudSavesTitleLoc=n.getLocalizedStr(e.cloudsavestitlestr,yC,"cloudsavestitlestr"),e.cloudSavesDescLoc=n.getLocalizedStr(e.cloudsavesdescstr,yC,"cloudsavesdescstr"),e.enableCloudSavesLoc=n.getLocalizedStr(e.enablecloudsavesstr,yC,"enablecloudsavesstr"),e.restoreLastSaveTitleLoc=n.getLocalizedStr(e.restorelastsavetitlestr,yC,"restorelastsavetitlestr"),e.restoreLastSaveDescLoc=n.getLocalizedStr(e.restorelastsavedescstr,yC,"restorelastsavedescstr"),e.restoreLastSaveLoc=n.getLocalizedStr(e.restorelastsavestr,yC,"restorelastsavestr"),e.goOnlineLoc=n.getLocalizedStr(e.goonlinestr,yC,"goonlinestr"),e.offlineWarningLoc=n.getLocalizedStr(e.offlinewarningstr,yC,"offlinewarningstr"),e.restoreDateLoc=n.getLocalizedStr(e.restoredatestr,yC,"restoredatestr"),e.$on("origin-dialog-content-gameproperties:save",function(){e.cloud.isNOG||o.saveGamePropertiesCloudSaves({cloudSavesEnabled:e.cloud.cloudSavesEnabled})}),e.restoreSave=function(){Origin.client.games.restoreLastCloudBackup(e.offerId)},a.create(o.getGamePropertiesObservable()).attachToScope(e,"cloud"),a.create(o.getClientPropertiesObservable()).attachToScope(e,"client"),s[s.length]=i.events.on("GamesClientFactory:updateCloudUsage:"+e.offerId,o.updateCloudData()),e.$on("$destroy",function(){r.detachAll(s)})}function be(e,t,i,n,r,o,a,s){"ngInject";e.gameManualLoc=i.getLocalizedStr(e.gamemanualstr,kC,"gamemanualstr"),e.epilepsyWarningLoc=i.getLocalizedStr(e.epilepsywarningstr,kC,"epilepsywarningstr"),e.cdKeyLoc=i.getLocalizedStr(e.cdkeystr,kC,"cdkeystr"),e.dateAddedLoc=i.getLocalizedStr(e.dateaddedstr,kC,"dateaddedstr"),e.commandLineLoc=i.getLocalizedStr(e.commandlinestr,kC,"commandlinestr"),e.gameNameLoc=i.getLocalizedStr(e.gamenamestr,kC,"gamenamestr"),e.gameLocationLoc=i.getLocalizedStr(e.gamelocationstr,kC,"gamelocationstr");var c=i.getLocalizedStr(e.enableoigstr,kC,"enableoigstr");e.$on("origin-dialog-content-gameproperties:save",function(){a.saveGamePropertiesGeneral({enableOig:e.general.enableOig,gameTitle:e.general.gameTitle,commandLineText:e.general.commandLineText})}),e.openEpilepsyWarning=function(e){e.preventDefault(),n.externalUrl(t.getEpilepsyWarningUrl(Origin.locale.locale()))},e.getEpilepsyWarningAbsoluteUrl=function(){return n.getAbsoluteUrl(t.getEpilepsyWarningUrl(Origin.locale.locale()))},e.openGameManual=function(t){t.preventDefault(),n.externalUrl(e.general.gameManualUrl)},e.getGameManualAbsoluteUrl=function(){if(e.general&&e.general.gameManualUrl)return n.getAbsoluteUrl(e.general.gameManualUrl)},e.formatDate=function(e){return s(e).format("LL")},e.$watch("general.gameTitle",function(){!e.enableOIGGameLoc&&e.general.gameTitle&&(e.enableOIGGameLoc=c.replace("%game%",e.general.gameTitle))}),o.create(a.getClientPropertiesObservable()).attachToScope(e,"client"),o.create(a.getGamePropertiesObservable()).attachToScope(e,"general")}function ye(e,t,i,n,r,o){"ngInject";e.filterPlaceholderLoc=t.getLocalizedStr(e.filterPlaceholderStr,wC,"filterplaceholderstr"),e.titleLoc=t.getLocalizedStr(e.titleStr,wC,"titlestr").replace("%gamename%",e.gametitlestr),e.friendsOfflineLoc=t.getLocalizedStr(e.friendsOfflineStr,wC,"friendsofflinestr"),e.noFriendsLoc=t.getLocalizedStr(e.noFriendsStr,wC,"nofriendsstr"),e.userList=[],e.filterByNameAndPlatform=function(e){var t=!!e.originId&&e.originId.length>0,i=angular.isDefined(e.isVoiceSupported)&&e.isVoiceSupported===Origin.voice.supported();return t&&i},i.getRoster("ONLINE").then(function(t){e.roster=t,e.$digest()}),this.addUser=function(t){e.userList.push(t),n.update({acceptEnabled:e.userList.length})},this.removeUser=function(t){var i=e.userList.indexOf(t);i>-1&&(e.userList.splice(i,1),n.update({acceptEnabled:e.userList.length}))},this.isSelected=function(t){return e.userList.indexOf(t)>-1},this.onFindFriends=function(){n.close("origin-dialog-content-invite-users-id"),o.findFriends()},e.clearFilter=function(){e.filterText=""},r.create(i.getOnlineCountWatch()).attachToScope(e,"onlineCount"),r.create(i.getRosterStatusWatch()).attachToScope(e,"rosterLoadStatus")}function Se(e){"ngInject";return{restrict:"A",link:function(t,i){i.bind("click",function(t){var i="",n="";return"A"===t.target.nodeName&&(i=t.target.href.replace("https://local.app.origin.com/",""),n=$(t.target).attr("class"),e.events.fire("cppDialog:linkReact",{href:i,classInfo:n})),!1})}}}function ke(e,t,i,n,r,o,a){"ngInject";function s(){n.close(r.ID)}e.strings={header:a.getLocalizedStr(e.header,_C,"header"),description:a.getLocalizedStr(e.description,_C,"description"),loginButtonText:a.getLocalizedStr(e.loginButtonText,_C,"login-button-text"),registerButtonText:a.getLocalizedStr(e.registerButtonText,_C,"register-button-text")},e.onClickLogin=function(){s(),t.promiseLogin().then(i.redeemCode).catch(o.showDialog)},e.onClickRegister=function(){s(),t.promiseRegister().then(i.redeemCode).catch(o.showDialog)}}function Ie(e,t){"ngInject";function i(i){e.$broadcast(t.MEDIA_ITEM_CHANGED,{currentIndex:i,nextIndex:e.active})}function n(){e.isTypeVideo="video"===_.get(e,["items",e.active,"type"])}function r(t){var i=t.keyCode||t.which;o[i]&&(o[i](),t.stopPropagation(),e.$digest())}var o={};e.active=parseInt(_.get(e,"active",0),10),e.previousMediaItem=function(){var t=parseInt(e.active,10);e.active=0===t?_.size(e.items)-1:t-1,n(),i(t)},e.nextMediaItem=function(){var t=parseInt(e.active,10);t===_.size(e.items)-1?e.active=0:e.active=t+1,n(),i(t)},o[EC]=e.previousMediaItem,o[FC]=e.nextMediaItem,document.addEventListener("keyup",r),e.$on("$destroy",function(){document.removeEventListener("keyup",r)}),n()}function we(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ce(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function Te(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){switch(e.cancelAction){case yI.v.ACTIVE:break;case yI.v.ALL:e.description=e.cancelAllDescription;break;case yI.v.SUSPENDED:e.description=e.cancelBasicDescription;break;case yI.v.STACKED_RECURRING:e.description=e.cancelStackedRecurringDescription}if(e.linkText&&e.description){var n='<a href="" class="otka" ng-click="renewSubscription($event)">'+e.linkText+"</a>",r='<p class="otkc">'+(e.description.indexOf("%link%")>-1?e.description.replace("%link%",n):e.description)+"</p>";i.find(".otkmodal-body").append(t(r)(e))}e.$digest()}function u(){c.openDirective({id:a.id,name:a.name,size:"large",data:{}})}var p,m=this,f=(p=Ce(regeneratorRuntime.mark(function t(){var i,r,o,a,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=moment(s.getExpiration()).format("LL"),e.cancelAction!==yI.v.STACKED_RECURRING){t.next=7;break}r=s.getStackedNonRecurringSubscription(!1),o=r?moment(_.get(r,yI.C)).format("LL"):i,e.datedTitleStr=n.getLocalizedStr(e.cancelStackedRecurringTitleStr,LC,"cancel-stacked-recurring-title-str",{"%codeenddate%":o}),t.next=15;break;case 7:if(e.cancelAction!==yI.v.ALL&&e.cancelAction!==yI.v.SUSPENDED&&e.cancelAction!==yI.v.ACTIVE){t.next=14;break}return t.next=10,s.getCancellationWithDetail();case 10:(a=t.sent)&&(c=_.get(a,"expiryDate").format("LL"),e.cancelAction===yI.v.ALL?e.datedTitleStr=n.getLocalizedStr(e.cancelAllTitleStr,LC,"cancel-all-title-str",we({"%premierenddate%":i},AC,c)):e.cancelAction===yI.v.SUSPENDED?e.datedTitleStr=n.getLocalizedStr(e.cancelBasicTitleStr,LC,"cancel-basic-title-str",we({},AC,c)):e.cancelAction===yI.v.ACTIVE&&(e.datedTitleStr=n.getLocalizedStr(e.titleStr,LC,"title-str",{"%date%":c}))),t.next=15;break;case 14:e.datedTitleStr=n.getLocalizedStr(e.titleStr,LC,"title-str",{"%date%":i});case 15:case"end":return t.stop()}},t,this)})),function(){return p.apply(this,arguments)});Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_CANCELED_DIALOG);var h=[];r.populateScope(e,LC).then(Ce(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:g();case 3:case"end":return e.stop()}},e,m)}))),e.btnClick=function(){c.close(o.id)};var v,b=(v=Ce(regeneratorRuntime.mark(function t(){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:h.push({id:o.id,name:o.name,data:we({},"cancel-action",e.cancelAction)}),i=e.subscriptionLevel||s.getActiveSubscriptionLevel(),n=i===yI.y.STANDARD?yI.p.SIGN_UP_BASIC:yI.p.SIGN_UP_PREMIER,c.openDirective({id:uI,name:gI,size:_I,data:{mode:n,stack:JSON.stringify(h)}});case 4:case"end":return t.stop()}},t,m)})),function(){return v.apply(this,arguments)});e.renewSubscription=function(e){e.preventDefault(),c.close(o.id),s.isCodeRedeemSubscription()?b():(l.blockUI(),s.renewSubscription().then(l.unblockUIPromise).then(u).catch(l.unblockUIPromiseOnError).catch(d.showDialog))}}function Pe(e,t,i,n,r,o,a,s,c){"ngInject";function l(t,i){return r.getLocalizedStr(e[t],$C,t,i)}function d(e){switch(e.content.selectedOption){case"renew-membership":c.renewSubscription();break;case"purchase":o.buyNow(g)}}var g=e.offerid,u=s.getExistingCatalogInfo(g).i18n.displayName||l("unknown-game");i.events.on("dialog:hide",d),e.$on("$destroy",function(){i.events.off("dialog:hide",d)}),e.title=l("titlestr"),e.description=l("descriptionstr",{"%gamename%":u}),e.cancelStr=l("cancelstr"),e.commandButtons=[{icon:"otkicon-refresh",title:l("renewmembership-titlestr"),text:l("renewmembership-textstr"),option:"renew-membership"},{icon:"otkicon-store",title:l("purchase-titlestr"),text:l("purchase-textstr"),option:"purchase"}],e.onClose=d}function _e(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(t,i,n){return o.getLocalizedStr(e[t],GC,t,i,n)}function g(e){switch(e.content.selectedOption){case"remove-game":a.vaultRemove(u),i.go("app.game_gamelibrary_wrapper.library");break;case"remove-all-games":a.baseEntitlementOfferIdList().forEach(function(e){l.isSubscriptionEntitlement(e)&&!a.isInstalled(e)&&a.vaultRemove(e)}),i.go("app.game_gamelibrary_wrapper.library")}}var u=e.offerid,p=c.getExistingCatalogInfo(u),m=s.getVaultGameFromMasterTitleId(p.masterTitleId),f=_.get(m,"offerId")||"",h=c.getExistingCatalogInfo(f),v=_.get(m,["basegames","basegame","length"])||1,b=Origin.user.originId(),y=_.get(p,["i18n","displayName"])||d("unknown-game"),S=_.get(h,["i18n","displayName"])||d("unknown-game");n.events.on("dialog:hide",g),e.$on("$destroy",function(){n.events.off("dialog:hide",g)}),e.title=d("titlestr"),e.description=d("descriptionstr",{"%username%":b}),e.cancelStr=d("cancelstr"),e.commandButtons=[{icon:"otkicon-remove",title:d("remove-game-titlestr",{"%gamename%":y,"%vaultgamename%":S},v),text:d("remove-game-textstr",{"%gamename%":y,"%vaultgamename%":S},v),option:"remove-game"}],s.isActive()||e.commandButtons.push({icon:"otkicon-timer",title:d("remove-all-games-titlestr"),text:d("remove-all-games-textstr"),option:"remove-all-games"}),e.onClose=g}function Oe(e,t,i,n,r){"ngInject";Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_RENEW_DIALOG),t.populateScope(e,BC).then(_.partial(r.digestIfDigestNotInProgress,e)),e.btnClick=function(){n.close(i.id)}}function Ee(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(t,i,n){return o.getLocalizedStr(e[t],jC,t,i,n)}function p(t){C||Origin.client.games.uninstall(f,{silent:t,externalType:e.externalType})}function m(e){switch(e.content.selectedOption){case"uninstall-and-remove":c.openPrompt({id:"oauninstall-prompt-uninstallandremove",title:u("uninstallandremove-confirmation-titlestr",{"%gamename%":I}),description:u("uninstallandremove-confirmation-textstr"),acceptText:u("uninstallstr"),rejectText:u("cancelstr"),defaultBtn:"no",acceptEnabled:!0,callback:T.handleUninstallAndRemovePrompt});break;case"uninstall":p(!1),i.go("app.game_gamelibrary_wrapper.library");break;case"downgrade":a.vaultRemove(f),i.go("app.game_gamelibrary_wrapper.library")}}var f=e.offerid,h=s.getExistingCatalogInfo(f),v=l.getVaultGameFromMasterTitleId(h.masterTitleId),b=_.get(v,"offerId")||"",y=s.getExistingCatalogInfo(b),S=_.get(v,["basegames","basegame","length"])||1,k=Origin.user.originId(),I=_.get(h,["i18n","displayName"])||u("unknown-game"),w=_.get(y,["i18n","displayName"])||u("unknown-game"),C=angular.isDefined(d.getOIGContextConfig()),T=this;this.handleUninstallAndRemovePrompt=function(e){n.events.off("dialog:hide",T.handleUninstallAndRemovePrompt),e.accepted&&(a.vaultRemove(f),p(!0),i.go("app.game_gamelibrary_wrapper.library"))},n.events.on("dialog:hide",m),e.$on("$destroy",function(){n.events.off("dialog:hide",m)}),e.title=u("titlestr"),e.description=u("descriptionstr",{"%username%":k}),e.cancelStr=u("cancelstr"),e.commandButtons=[{icon:"otkicon-uninstall-and-remove",title:u("uninstallandremove-titlestr",{"%gamename%":I,"%vaultgamename%":w},S),text:u("uninstallandremove-textstr",{"%gamename%":I,"%vaultgamename%":w},S),option:"uninstall-and-remove"},{icon:"otkicon-uninstall",title:u("uninstallonly-titlestr",{"%gamename%":I,"%vaultgamename%":w},S),text:u("uninstallonly-textstr",{"%gamename%":I,"%vaultgamename%":w},S),option:"uninstall"}],function(e){var t=a.baseEntitlementOfferIdList();t=t.filter(function(t){return t!==e&&!g.isSubscriptionEntitlement(t)});var i=s.getOfferIdsFromMasterId(h.masterTitleId).map(function(e){return e.offerId});return t.filter(function(e){return-1!==i.indexOf(e)}).length>0}(f)&&e.commandButtons.push({icon:"otkicon-downgrade",title:u("downgrade-titlestr",{"%gamename%":I,"%vaultgamename%":w},S),text:u("downgrade-textstr",{"%gamename%":I,"%vaultgamename%":w},S),option:"downgrade"}),e.onClose=m}function Fe(e){"ngInject";e.selectedOption="0",e.dontShow=!1}function xe(e,t,i){"ngInject";return{restrict:"E",scope:{titleStr:"@",description:"@",downloadOriginStr:"@",launchOriginStr:"@",offerId:"@",dialogId:"@",externalType:"@"},link:function(n){n.strings={titleStr:i.getLocalizedStr(n.titleStr,WC,"title-str"),description:i.getLocalizedStr(n.description,WC,"description"),downloadOriginStr:i.getLocalizedStr(n.downloadOriginStr,WC,"download-origin-str"),launchOriginStr:i.getLocalizedStr(n.launchOriginStr,WC,"launch-origin-str")},n.downloadLink=t.getClientDownloadLink(),n.platform=Origin.utils.os(),n.closeWindow=function(){e.close(n.dialogId)},n.onLaunchOriginClick=function(){Origin.client.games.play(n.offerId,{externalType:n.externalType}),n.closeWindow()}},template:VC}}function Le(e){"ngInject";e.chkChecked="true"===e.checkeddefault}function Ae(e,t,i){"ngInject";e.updateOriginSetting="true"===e.updateorigin,e.updateGamesSetting="true"===e.updategames,e.toggleSetting=function(t){e[t]=!e[t]},e.onEmailSubscribeClick=function(){var e=i.getUrl("eaAccountsEmailPreferences");Origin.client.isEmbeddedBrowser()||(e=(e=e.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),t.asyncOpenUrlWithEADPSSO(e)}}function De(e){"ngInject";this.update=function(t){"origin-dialog-content-progress"===t.contentType&&(e.title=t.content.title,e.operation=t.content.operation,e.operationstatus=t.content.operationstatus,e.percent=parseInt(t.content.percent),e.ratio=t.content.ratio,e.rate=t.content.rate,e.timeremaining=t.content.timeremaining,e.phase=t.content.phase,e.completed=t.content.completed,e.$digest())}}function Re(e){"ngInject";return{restrict:"E",transclude:!0,scope:{title:"@",operation:"@",operationstatus:"@",percent:"@",ratio:"@",rate:"@",timeremaining:"@",phase:"@",completed:"@"},controller:De,template:QC,link:function(t,i,n,r){e.events.on("dialog:update",r.update),t.$on("$destroy",function(){e.events.off("dialog:update",r.update)})}}}function $e(e,t,i,n){"ngInject";function r(t){var i={};a&&(i=a()),!0===t&&!0===i.preventContinue||(n.setReturnValues(t,i),n.close(e.id))}var o,a=null;e.yesenabled="true"===e.yesenabled,e.onYesBtnClick=function(){r(!0)},e.onNoBtnClick=function(){r(!1)},this.setContentDataFunc=function(e){a=e},this.handleButtonPress=function(t){13===(t.keyCode||t.which)&&(t.stopImmediatePropagation(),t.preventDefault(),r("yes"===e.defaultbtn?!0:!1))},this.finish=r,o=i.events.on("dialog:update",function(i){e.yesenabled=i.acceptEnabled,t(function(){e.$digest()})}),e.$on("$destroy",function(){o&&o.detach()})}function Ne(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function Ge(e,t,i,n,r,o){"ngInject";e.closeResponse=function(i,r,o){r&&r.preventDefault(),t.setReturnValues(i,{id:e.id}),t.close(e.modalId),o&&n.goToState(gT,{offerid:o})},e.navigateToOgdGame=function(e,t){e&&e.preventDefault(),t&&n.goToState(gT,{offerid:t})},e.isOigContext=o.isOIGContext(),e.bundle=e.bundle||[],e.ownedOffers=e.ownedOffers||[],i.getCatalogInfo(_.uniq([].concat(Ne(e.bundle),Ne(e.ownedOffers)))).then(function(t){e.ownedCount=e.ownedOffers.length,_.forEach(t,function(e,t){e.ogdLink=n.getHrefFromState(gT,{offerid:t})}),e.purchaseCount=r.length(e.bundle),e.buildStrings(e.bundle,e.ownedOffers,e.isOfferBundle,t),e.$digest()})}function Ue(e,t,i,n){"ngInject";return{restrict:"E",scope:{bundle:"=",ownedOffers:"=",modalId:"@",isOfferBundle:"@"},link:function(t){var r=angular.element(".origin-dialog-content-pp-text-single"),o=angular.element("<div>");t.buildStrings=function(a,s,c,l){var d,g,u,p,m=a.length,f=s.length,h=tT,v=iT,b={"%count%":f};if(1===f){1===m?(h=aT,v=c?cT:sT):v=c?cT:lT;var y=_.get(l,s[0]);d=t.isOigContext?_.get(y,[DI.I,DI.k],""):(p=y)?'<a class="otka"\n                ng-click="closeResponse(false, $event, \''+p.offerId+"')\"\n                ng-href=\"::'"+p.ogdLink+"'\"\n                ng-bind=\"::'"+_.get(p,[DI.I,DI.k])+"'\">\n            </a>":""}m===f&&f>1&&(h=rT,v=oT),t.strings=t.strings||{},c||(t.strings.remove=e.getLocalizedStr(!1,eT,nT,b,f)),t.strings.btnRemoveAndContinue=e.getLocalizedStr(t.btnRemoveAndContinue,eT,"btn-remove-and-continue"),t.strings.btnNo=e.getLocalizedStr(t.btnNo,eT,"btn-no"),t.strings.btnOkay=e.getLocalizedStr(t.btnOkay,eT,"btn-okay"),t.strings.continueButtonText=e.getLocalizedStr(!1,eT,"continue-purchase-text"),t.strings.title=e.getLocalizedStr(!1,eT,h,b,f),g=(g=n(e.getLocalizedStr(!1,eT,v,b,m))).replace(dT,d),u=i(o.html(g))(t),r.append(u)}},controller:Ge,template:ZC}}function Be(e,t,i){"ngInject";var n=[];e.onRamExecuteResult=function(t){setTimeout(function(){i.setReturnValues(!0,{executed:t}),i.close(e.dialogId)},0)},e.$on("$destroy",function(){t.detachAll(n)}),n.push(Origin.events.on(Origin.events.CLIENT_SETTINGS_RETURN_FROM_RAM_EXECUTION,e.onRamExecuteResult))}function Me(e,t,i,n,r){"ngInject";function o(e){e&&!e.isOnline&&n.close("origin-dialog-content-reportuser-id")}function a(){e.whySelection.length&&e.whereSelection.length?n.update({acceptEnabled:!0}):n.update({acceptEnabled:!1})}var s="origin-dialog-content-reportuser";e.selectOneLoc=i.getLocalizedStr(e.selectOneStr,s,"selectonestr"),e.whyLoc=i.getLocalizedStr(e.whyStr,s,"whystr").replace("%username%",e.username),e.whereLoc=i.getLocalizedStr(e.whereStr,s,"wherestr"),e.commentsLoc=i.getLocalizedStr(e.commentsStr,s,"commentsstr"),e.enterNotesLoc=i.getLocalizedStr(e.enterNotesStr,s,"enternotesstr"),e.cheatingLoc=i.getLocalizedStr(e.cheatingStr,s,"cheatingstr"),e.solicitationLoc=i.getLocalizedStr(e.solicitationStr,s,"solicitationstr"),e.harassmentLoc=i.getLocalizedStr(e.harassmentStr,s,"harassmentstr"),e.offensiveLoc=i.getLocalizedStr(e.offensiveStr,s,"offensivestr"),e.spamLoc=i.getLocalizedStr(e.spamStr,s,"spamstr"),e.suicideLoc=i.getLocalizedStr(e.suicideStr,s,"suicidestr"),e.terroristLoc=i.getLocalizedStr(e.terroristStr,s,"terroriststr"),e.hackLoc=i.getLocalizedStr(e.hackStr,s,"hackstr"),e.realNameLoc=i.getLocalizedStr(e.realNameStr,s,"realnamestr"),e.avatarLoc=i.getLocalizedStr(e.avatarStr,s,"avatarstr"),e.customGameLoc=i.getLocalizedStr(e.customGameStr,s,"customgamestr"),e.inGameLoc=i.getLocalizedStr(e.inGameStr,s,"ingamestr"),e.whySelection="",e.whereSelection="",e.reportSent=!1,r.events.on("myauth:clientonlinestatechangeinitiated",o),e.$on("$destroy",function(){r.events.off("myauth:clientonlinestatechangeinitiated",o),Origin.events.off(Origin.events.CLIENT_ONLINESTATECHANGED,o)}),this.setWhyValue=function(t,i){e.whySelection=t,e.$whyLabel.text(i),a()},this.setWhereValue=function(t,i){e.whereSelection=t,e.$whereLabel.text(i),a()}}function je(e,t,i,n){"ngInject";function r(e){e&&!e.isOnline&&i.close("origin-dialog-content-searchforfriends-id")}e.onInputChanged=function(){var t=e.searchText.length;i.update({acceptEnabled:t}),e.searchText.length?e.$clearIcon.show():e.$clearIcon.hide()},n.events.on("myauth:clientonlinestatechangeinitiated",r),e.$on("$destroy",function(){n.events.off("myauth:clientonlinestatechangeinitiated",r),Origin.events.off(Origin.events.CLIENT_ONLINESTATECHANGED,r)})}function He(e){"ngInject";return{restrict:"E",require:["^originDialogContentPrompt","originDialogContentSearchforfriends"],scope:{placeholderstr:"@placeholderstr"},controller:je,template:fT,link:function(t,i,n,r){n=n,t.$textInput=$(i).find(".otkinput > input"),t.$clearIcon=$(i).find(".otkinput > .otkinput-clear");var o=r[0];t.$textInput.keydown(function(e){!_.isUndefined(t.searchText)&&t.searchText.length&&o.handleButtonPress(e)}),t.$clearIcon.click(function(){t.$textInput.val(""),t.$clearIcon.hide(),t.$textInput.focus(),e.update({acceptEnabled:!1})}),t.$textInput.focus(),o.setContentDataFunc(function(){return{searchText:t.searchText}})}}}function ze(e,t,i,n){"ngInject";var r=t.getLocalizedStrGenerator(bT);e.strings={title:r(e.languagePreferencesStr,"language-preferences-str"),save:r(e.saveStr,"save-str"),cancel:r(e.cancelStr,"cancel-str")},e.currentLocale=n.getDashedLocale(),e.languageMap={},e.cancel=function(){i.close("origin-dialog-content-selectlanguage")},n.getAllLanguages().then(function(t){e.languageMap=t,e.$digest()})}function Ve(e,t,i){"ngInject";return{restrict:"E",scope:{languagePreferencesStr:"@",saveStr:"@",cancelStr:"@"},link:function(n,r){function o(e,t){return t.checked}n.save=function(){var n=r.find(".origin-dialog-language input").filter(o).val();i.setLanguageLocale(n),e.setLocale(n),t.close("origin-dialog-content-selectlanguage")}},controller:ze,template:vT}}function We(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{wishlistid:"@"},link:function(o){function a(){o.isCopied=!1,o.isCopiedOldBrowser=!1,n.digestIfDigestNotInProgress(o)}o.shareDialogHeadingLoc=t.getLocalizedStr(!1,kT,"sharedialogheading"),o.shareFacebookHeadingLoc=t.getLocalizedStr(!1,kT,"sharefacebookheading"),o.shareFacebookDescriptionLoc=t.getLocalizedStr(!1,kT,"sharefacebookdescription"),o.shareLinkHeadingLoc=t.getLocalizedStr(!1,kT,"sharelinkheading"),o.shareFacebookMessageDescriptionLoc=t.getLocalizedStr(!1,kT,"sharefacebookmessagedescription",{"%originId%":Origin.user.originId()}),o.shareFacebookMessageTitleLoc=t.getLocalizedStr(!1,kT,"sharefacebookmessagetitle",{"%originId%":Origin.user.originId()}),o.shareFacebookMessageImage=t.getLocalizedStr(!1,kT,"sharefacebookmessagepicture"),o.copyLinkToClipboardCtaLoc=t.getLocalizedStr(!1,kT,"copylinktoclipboardcta"),o.linkCopiedLoc=t.getLocalizedStr(!1,kT,"linkcopied"),o.linkCopiedOldBrowserLoc=t.getLocalizedStr(!1,kT,"linkcopiedoldbrowser"),o.cancelCtaLoc=t.getLocalizedStr(!1,kT,"cancelcta"),o.wishlistLink=e.getHrefFromState("app.wishlistredirector",{wishlistId:o.wishlistid},{absolute:!0}),o.openShareWindow=function(e){e.stopPropagation(),e.preventDefault(),o.$emit("cta:clicked","self_share_wishlist_facebook");var t={title:o.shareFacebookMessageTitleLoc,description:o.shareFacebookMessageDescriptionLoc,u:o.wishlistLink};o.shareFacebookMessageImage&&(t.picture=o.shareFacebookMessageImage),r.openFacebookShareWindow(t)},o.copyLink=function(e){o.$emit("cta:clicked","self_copy_wishlist_link"),o.isCopied=!0,e.clearSelection(),n.digestIfDigestNotInProgress(o),setTimeout(a,IT)},o.copyLinkOldBrowser=function(){o.$emit("cta:clicked","self_copy_wishlist_link_old_browser"),o.isCopiedOldBrowser=!0,setTimeout(a,wT),n.digestIfDigestNotInProgress(o)},o.closeDialog=function(){i.close(kT)}},template:ST}}function qe(e,t,i){"ngInject";return{restrict:"E",scope:{items:"<",active:"<"},link:function(t){t.goToProfile=function(t,n){t.preventDefault(),t.stopPropagation(),i.promiseLogin().then(function(){e.goUserProfile(n,void 0,!1)})}},controller:"OriginDialogContentMediaCarouselCtrl",template:TT}}function Ye(e){"ngInject";e.chkChecked="true"===e.checkeddefault}function Ke(e){"ngInject";return{restrict:"E",scope:{ownedDlcs:"="},link:function(t){t.strings={btnCancel:e.getLocalizedStr(!1,ET,"btncancel"),title:e.getLocalizedStr(!1,ET,"title-str"),description:e.getLocalizedStr(!1,ET,"description-str")},t.decodedOwnedDlcNames=_.map(t.ownedDlcs,function(e){return decodeURIComponent(e)})},template:OT}}function Qe(e){"ngInject";return{transclude:!0,scope:{dialogid:"@",titleStr:"@",targetOfferDisplayName:"@",targetOfferid:"@",telemetryTargetOfferOcdpath:"@",continueWithoutDlcCtaStr:"@",continueCtaStr:"@",basegameRequiredStr:"@",dlcRequiredStr:"@",requiredBasegameName:"@",requiredDlcName:"@",legalTextStr:"@"},controller:se,link:function(t){var i={titleStr:e.getLocalizedStr(t.titleStr,xT,"title-str"),basegameRequiredStr:e.getLocalizedStr(t.basegameRequiredStr,xT,"basegame-required-str",{"%targetOfferName%":t.targetOfferDisplayName,"%basegameName%":t.requiredBasegameName}),dlcRequiredStr:e.getLocalizedStr(t.dlcRequiredStr,xT,"dlc-required-str",{"%dlcName%":t.requiredDlcName}),legalText:e.getLocalizedStr(t.legalTextStr,xT,"legal-text-str")};t.strings=t.strings?Object.assign(t.strings,i):i,t.isMissingBasegame=!_.isUndefined(t.requiredBasegameName),t.isMissingDlc=!_.isUndefined(t.requiredDlcName)},template:Zw}}function Je(e,t,i,n,r,o,a){"ngInject";var s={checkoutType:o.SUBS,subsConfirmation:!0};a.isState(bI.t)&&(s.invoiceSource=t.getSetting("invoiceSources").accessWwce),e.strings={title:r.getLocalizedStr(e.titleOverride,AT,"title-override"),body:r.getLocalizedStr(e.bodyOverride,AT,"body-override"),btnOk:r.getLocalizedStr(e.btnOkOverride,AT,"btn-ok-override"),btnCancel:r.getLocalizedStr(e.btnCancelOverride,AT,"btn-cancel")},e.clickCancel=function(){i.close(e.dialogId)},e.clickSubscribe=function(){i.close(e.dialogId),s.friendReferralToken=e.friendReferralToken,e.subscriptionOfferId?e.subscriptionOfferId!==e.offerId?n.chainCheckout(e.subscriptionOfferId,e.offerId,s):e.mode===yI.p.UPGRADE_PREMIER&&n.upgradeSubscriptionCheckout(e.subscriptionOfferId,!0):n.buy(e.offerId,s)}}function Xe(e,t,i,n,r){"ngInject";function o(){r.close(e.modal)}var a=e.params||{};t.getTemplate(e.template,a).then(function(t){t?(i.append(t),n(i)(e)):o()}).catch(o)}function Ze(e,t,i,n,r,o,a){"ngInject";function s(e){return angular.isDefined(e)&&_.isString(e)&&e.length>0}function c(){$("#vidplayer").attr("src","")}e.trustedSrc="",e.restrictedMessage=o.getLocalizedStr(e.restrictedMessage,GT,"restrictedmessagestr"),e.showPackart=e.hidePackart!==NT.false,e.strings={contentLink:o.getLocalizedStr(e.contentLink,GT,"content-link"),contentLinkBtnText:o.getLocalizedStr(e.contentLinkBtnText,GT,"content-link-btn-text"),contentText:o.getLocalizedStr(e.contentText,GT,"content-text")},s(e.channel)?e.trustedSrc=r.buildTwitchChannelEmbedUrl(e.channel,!1):s(e.video)?e.trustedSrc=r.buildTwitchVideoEmbedUrl(e.video,!1):s(e.clip)&&(e.trustedSrc=r.buildTwitchClipEmbedUrl(e.clip,!1)),e.trustedSrc=t.trustAsResourceUrl(e.trustedSrc),i.events.on("dialog:hidden",c),e.$on("$destroy",function(){i.events.off("dialog:hidden",c)}),this.processContentLink=function(){e.contentLink&&(e.contentLinkAbsoluteUrl=n.getAbsoluteUrl(e.contentLink),e.isContentLinkExternal=o.isAbsoluteUrl(e.contentLink))},this.onScopeResolved=function(){this.processContentLink(),a.digestIfDigestNotInProgress(e)}}function et(e,t,i){"ngInject";return{restrict:"E",scope:{channel:"@",video:"@",clip:"@",matureContent:"@",ocdPath:"@",contentLink:"@",contentLinkBtnText:"@",contentText:"@",hidePackart:"@"},controller:Ze,link:function(n,r,o,a){n.closeDialog=function(){e.close(n.dialogId)},n.$on("cta:clicked",n.closeDialog),n.openLink=function(e,t){t.preventDefault(),n.closeDialog(),i.openLink(e)},n.ocdPath?t.populateScopeWithOcdAndCatalog(n,GT,n.ocdPath).then(a.onScopeResolved):a.processContentLink()},template:$T}}function tt(e,t,i,n,r,o){"ngInject";function a(t){var i=Origin.utils.getProperty(_.head(_.values(t)),[DI._15,DI._13,DI._23]);e.showUpgradeWarning=null===i||i,e.$digest()}i.getCatalogInfo([e.offerId]).then(function(t){e.model=_.head(_.values(t)),o.populateScope(e,BT,e.model.ocdPath).then(function(){var t;t={"%game-edition%":'<span ng-bind="gameEdition"></span>',"%faq-link-start%":'<a class="otka external-link" href="'+r.getLocalizedStr(e.faqHref,BT,"faq-href")+'">',"%faq-link-end%":"</a>"},e.strings={title:r.getLocalizedStr(e.titleOverride,BT,"title-override"),warning:r.getLocalizedStr(e.warningOverride,BT,"warning-override",t),btnOk:r.getLocalizedStr(e.btnOkOverride,BT,"btn-ok-override"),btnCancel:r.getLocalizedStr(e.btnCancel,BT,"btn-cancel"),upgrade:r.getLocalizedStr(e.upgradeOverride,BT,"upgrade-override",{"%game%":(void 0).i18n.displayName})},e.$digest()}),e.$digest(),i.getCatalogByPath([e.model.vaultOcdPath]).then(a)}),e.clickCancel=function(){t.close(e.dialogId)},e.clickUpgrade=function(){t.close(e.dialogId),n.entitleVaultGame(e.offerId,!0)}}function it(e,t,i,n,r,o){"ngInject";function a(){e.isContinueToCheckoutDisabled=!1,e.$digest()}function s(t){e.strings.continueStr=t?e.strings.continueCtaStr:e.strings.continueWithoutBasegameCtaStr}e.isOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.offerType=n.VAULT,e.decodedDlcgameNames=_.map(e.dlcgameNames,function(e){return decodeURIComponent(e)}),e.strings={titleStr:i.getLocalizedStr(e.titleStr,jT,"title-str",{"%basegameName%":e.basegameName}),continueCtaStr:i.getLocalizedStr(e.continueCtaStr,jT,"continue-cta-str"),continueWithoutBasegameCtaStr:i.getLocalizedStr(e.continueWithoutBasegameCtaStr,jT,"continue-without-basegame-cta-str",{"%basegameName%":e.basegameName})},_.size(e.decodedDlcgameNames)>1?e.strings.warningStr=i.getLocalizedStr(e.warningStrPlural,jT,"warning-str-plural",{"%basegameName%":e.basegameName,"%dlcgameNames%":e.decodedDlcgameNames.join(",")}):1===_.size(e.decodedDlcgameNames)&&(e.strings.warningStr=i.getLocalizedStr(e.warningStr,jT,"warning-str",{"%basegameName%":e.basegameName,"%dlcgameName%":_.head(e.decodedDlcgameNames)})),this.handleOfferActions=function(t){var i=t.isSelected;i?(e.isContinueToCheckoutDisabled=!0,r.entitleVaultGame(decodeURIComponent(e.basegameOfferid),!1,{showCheckoutConfirmation:!1}).then(function(){e.isOfferAddedToCart=i,s(i),a()}).catch(function(){a()})):(e.isOfferAddedToCart=i,s(i))},e.continueToCheckout=function(){var i=_.map(e.dlcOfferIds,decodeURIComponent);e.bundleType&&e.promoRuleId?(t.close(e.dialogid),o.buy(i,e.bundleType,e.promoRuleId,void 0,!0)):(t.setReturnValues(!0,{id:e.dialogid,offerIds:i}),t.close(e.dialogid))},this.handleOfferActions({isSelected:e.isOfferAddedToCart})}function nt(e,t,i,n,r,o,a,s){"ngInject";function c(){o.goToState(VT)}function l(){i.close(a.dialogId)}e.upgrade=function(){l(),n.entitleVaultGame(e.offerId,!0).then(c)},e.launchGame=function(){l(),Origin.client.games.play(e.offerId)},t.getCatalogByPath(e.vaultOcdPath).then(function(t){var i=_.head(_.values(t));e.strings={header:r.getLocalizedStr(e.header,zT,"header"),description:r.getLocalizedStr(e.description,zT,"description",{"%edition%":_.get(i,[DI.I,DI.k],""),"%subscriptiontiername%":r.getLocalizedStr(void 0,zT,"oa-"+s.getActiveSubscriptionLevel()+"-tier-name")}),warning:r.getLocalizedStr(e.warning,zT,"warning",{"%edition%":_.get(i,[DI.I,DI.k],"")}),upgradeCta:r.getLocalizedStr(e.upgradeCta,zT,"upgrade-cta"),skipCta:r.getLocalizedStr(e.skipCta,zT,"skip-cta")},e.hasUpgradeWarning=_.get(i,["platforms",Origin.utils.OS_WINDOWS,"showSubsSaveGameWarning"],!1),e.$digest()}).catch(e.clickSkip)}function rt(e,t,i,n){"ngInject";this.setStrings=function(){var t={"%game-edition%":'<span ng-bind="gameEdition"></span>',"%faq-link-start%":'<a class="otka external-link" href="'+n.getLocalizedStr(e.faqHref,YT,"faq-href")+'">',"%faq-link-end%":"</a>"};e.strings={faqHref:n.getLocalizedStr(e.faqHref,YT,"faq-href"),title:n.getLocalizedStr(e.title,YT,"title"),body:n.getLocalizedStr(e.body,YT,"body",t),btnOk:n.getLocalizedStr(e.btnOk,YT,"btn-ok"),btnCancel:n.getLocalizedStr(e.btnCancel,YT,"btn-cancel")}},e.clickCancel=function(){t.setReturnValues(!1,{dialogId:e.dialogId}),t.close(e.dialogId)},e.clickUpgrade=function(){t.setReturnValues(!0,{dialogId:e.dialogId}),i.entitleVaultGame(e.offerId,!0).then(function(){t.close(e.dialogId)})}}function ot(e,t,i){"ngInject";return{restrict:"E",scope:{dialogId:"@",offerId:"@",title:"@",body:"@",btnOk:"@",btnCancel:"@",faqHref:"@"},link:function(n,r,o,a){t.getCatalogInfo([n.offerId]).then(function(t){var o=_.get(t,[n.offerId]);n.gameEdition=_.get(o,[DI.I,DI.k],""),i.populateScope(n,YT,t.ocdPath).then(function(){var t;a.setStrings(),t=e("<span>"+n.strings.body+"</span>")(n),r.find(".vaultupgradewarning-body").append(t),n.$digest()})})},controller:rt,template:qT}}function at(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{heading:"@",description:"@",closecta:"@"},link:function(o,a){var s,c,l;o.headingLoc=i.getLocalizedStr(o.heading,JT,"heading"),o.cancelLoc=i.getLocalizedStr(o.cancelcta,JT,"cancelcta"),o.closeDialog=function(){n.close(JT)},o.goToAccount=function(i){i.stopPropagation(),i.preventDefault();var n=e.getUrl("accountPrivacySettings").replace("{locale}",Origin.locale.locale());t.externalUrl(n,!0),window.requestAnimationFrame(o.closeDialog)},s=i.getLocalizedStr(o.description,JT,"description"),c=a.find(".wishlistprivateprofiletext"),l=r(["<span>",s,"</span>"].join(""))(o),c.append(l)},template:QT}}function st(e){"ngInject";function t(){return angular.isDefined(window.YT)&&angular.isDefined(window.YT.Player)}function i(e){cP.push(e)}function n(){var e=function(){var e=document.createElement("script");return e.src=iP,e.id=nP,e}(),t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function r(){return new Promise(function(e){null!==document.getElementById(nP)||t()?t()?e():i(e):c?i(e):(c=!0,n(),i(e),window.onYouTubeIframeAPIReady=function(){_.forEach(cP,function(e){e()}),cP=[]})})}function o(t){t.hasClass(rP)||t.addClass(rP);var i=t.attr("id");return i||(i=tP+e.guid(),t.attr("id",i)),i}function a(e,t,i,n,r,o){return new Promise(function(a){var s,c,l;new window.YT.Player(e,{videoId:t,playerVars:function(e,t){return 1===e.loop&&(e.playlist=t),e}((l=i,_.extend({},aP,l)),t),width:n,height:r,events:(s={onReady:function(e){a(e.target)}},c=o,_.extend({},c,s))})})}function s(e){return{en:"message",type:"in-game",service:"youtube",format:"video",msg_id:e.videoId,status:e.status,content:e.source}}var c=!1;return{PLAYER_STATES:sP,getThumbnailImage:function(e,t){return t=t||0,e?eP.replace("%videoId%",e).replace("%offset%",t):null},getStillImage:function(e){return e?eP.replace("%videoId%",e).replace("%offset%","maxresdefault"):null},loadYoutubePlayer:function(e,t,i,n,s,c){var l=o(e);return i=i||{playlist:t},r().then(function(){return a(l,t,i,n,s,c)})},sendStartVideoTelemetryEvent:function(e){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_TILE_VIDEO_STARTED,{videoId:e.videoId,additionalPinEvents:s(e)})},sendStopVideoTelemetryEvent:function(e){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_TILE_VIDEO_ENDED,{videoId:e.videoId,playedTime:e.playedTime,additionalPinEvents:s(e)})}}}function ct(e,t,i){"ngInject";var n=this,r=i.PLAYER_STATES;e.trustedSrc=t.buildYouTubeEmbedUrl(e.videoId),this.sendStartVideoTelemetryEvent=function(){i.sendStartVideoTelemetryEvent({videoId:e.videoId,status:pP,source:e.trustedSrc})},this.sendStopVideoTelemetryEvent=function(t){e.youtubePlayer&&i.sendStopVideoTelemetryEvent({videoId:e.videoId,playedTime:Math.floor(e.youtubePlayer.getCurrentTime()/e.youtubePlayer.getDuration()*100).toFixed(0),status:t,source:e.trustedSrc})},this.handleVideoStateChange=function(e){e.data===r.PLAYING?n.sendStartVideoTelemetryEvent():e.data===r.ENDED&&n.sendStopVideoTelemetryEvent(mP)}}function lt(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{dialogId:"@",videoId:"@",matureContent:"@",ocdPath:"@",contentLink:"@",contentLinkBtnText:"@",contentText:"@",hidePackart:"@"},controller:ct,link:function(a,s,c,l){var d=s.find(hP);a.showPackart=a.hidePackart!==OS.true,a.restrictedMessage=r.getLocalizedStr(a.restrictedMessage,fP,"restrictedmessagestr"),a.strings={contentLink:r.getLocalizedStr(a.contentLink,fP,"content-link"),contentLinkBtnText:r.getLocalizedStr(a.contentLinkBtnText,fP,"content-link-btn-text"),contentText:r.getLocalizedStr(a.contentText,fP,"content-text")};var g=function(){a.contentLink&&(a.contentLinkAbsoluteUrl=n.getAbsoluteUrl(a.contentLink),a.isContentLinkExternal=r.isAbsoluteUrl(a.contentLink))};t.loadYoutubePlayer(d,a.videoId,dP,uP,gP,{onStateChange:l.handleVideoStateChange}).then(function(e){a.youtubePlayer=e}),a.closeDialog=function(){e.close(a.dialogId)},a.openLink=function(e,t){t.preventDefault(),a.closeDialog(),n.openLink(e)},a.closeFooter=function(){a.showFooter=!1},a.ocdPath?i.populateScopeWithOcdAndCatalog(a,fP,a.ocdPath).then(function(){g(),o.digestIfDigestNotInProgress(a)}):g(),a.contentText&&(a.showFooter=!0),a.$on("cta:clicked",a.closeDialog),a.$on("$destroy",function(){var e,t;t=void 0!==(e=!0)&&e,a.youtubePlayer&&(a.youtubePlayer.stopVideo(),t&&l.sendStopVideoTelemetryEvent(oP))})},template:ZT}}function dt(e,t,i,n){"ngInject";return{restrict:"E",replace:!0,scope:{videoId:"@",matureContent:"@",active:"<",itemIndex:"<"},controller:ct,link:function(r,o,a,s){function c(e){r.youtubePlayer=e}function l(t,i){var n=i.currentIndex,o=i.nextIndex,a=r.youtubePlayer.getPlayerState();n===r.itemIndex&&r.youtubePlayer?a!==e.PLAYER_STATES.PLAYING&&a!==e.PLAYER_STATES.UNSTARTED||r.youtubePlayer.pauseVideo():o===r.itemIndex&&r.youtubePlayer&&a===e.PLAYER_STATES.PAUSED&&r.youtubePlayer.playVideo()}function d(){var e,t,n;e={sendTelemetry:r.active},t=e.sendTelemetry,n=void 0!==t&&t,r.youtubePlayer&&(r.youtubePlayer.stopVideo(),n&&s.sendStopVideoTelemetryEvent(oP)),m&&i.cancel(m)}function g(e){r.isUnderAge=e.isUnderAge}function u(){n.getUserAgeStateObservable().attachToScope(r,g),r.$on(t.MEDIA_ITEM_CHANGED,l),r.$on("$destroy",d)}function p(){return e.loadYoutubePlayer(f,r.videoId,h,SP,yP,{onStateChange:s.handleVideoStateChange}).then(c).then(u)}var m=void 0,f=o.find(IP),h={autoplay:0,autohide:1,loop:1,controls:1,modestbranding:0,playsinline:1,rel:0,showinfo:0,playlist:r.videoId};r.active?p():m=i(p,kP,!1)},template:bP}}function gt(e,t,i,n,r,o,a,s){"ngInject";function c(t){e.strings.continueStr=t?e.strings.continueCtaStr:e.strings.continueWithoutBasegameCtaStr}e.isOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.offerType=US.vaultInLibrary,Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_VAULT_PURCHASE_WARNING_DIALOG,a.buildPathFromUrl().gdpPath),e.strings={titleStr:r.getLocalizedStr(e.titleStr,_P,"title-str",{"%basegameName%":e.basegameName}),warningStr:r.getLocalizedStr(e.warningStr,_P,"warning-str",{"%basegameName%":e.basegameName}),continueCtaStr:r.getLocalizedStr(e.continueCtaStr,_P,"continue-cta-str"),continueWithoutBasegameCtaStr:r.getLocalizedStr(e.continueWithoutBasegameCtaStr,_P,"continue-without-basegame-cta-str",{"%basegameName%":e.basegameName})},this.handleOfferActions=function(i){var n=i.isSelected;n?(e.isContinueToCheckoutDisabled=!0,e.$broadcast(CP),o.entitleVaultGame(e.basegameOfferid,!1,{showCheckoutConfirmation:!1,waitForEntitlementsRefresh:!0}).then(function(){!function(t){c(t),e.isOfferAddedToCart=t,e.$broadcast(TP)}(n)}).catch(function(i){i===UI.t?s.events.once(Ey.x,function(i){i.accepted&&t.close(e.dialogid)}):(e.isOfferAddedToCart=!1,e.$broadcast(PP))}).finally(function(){e.isContinueToCheckoutDisabled=!1,e.$digest()})):(t.close(e.dialogid),a.loadModelAndGotoOgdOrGameLibrary(e.basegameOcdpath).catch(function(){}))},e.isOfferAddedToCart=!1,c(!1),e.continueToCheckout=function(){t.close(e.dialogid),o.buy(e.purchaseOfferId||e.basegameOfferid,e.buyParams||{},{skipPurchasePreventionCheck:!0})}}function ut(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function pt(e,t){"ngInject";return{restrict:"E",transclude:!0,scope:{dialogid:"@",offerWithSoftDependencyName:"@",telemetryOfferWithSoftDependencyOcdpath:"@",softDependencyName:"@",softDependencyOcdPath:"@",basegameName:"@",basegameOcdPath:"@",basegameIsFree:"<",dlcGameNames:"=",titleStr:"@",legalTextStr:"@",continueWithoutDlcCtaStr:"@",continueCtaStr:"@",basegameRequiredStr:"@",basegameRequiredPluralStr:"@"},controller:mt,link:function(i){var n,r=_.map(i.dlcGameNames,function(e){return decodeURIComponent(e)}),o={titleStr:e.getLocalizedStr(i.titleStr,FP,"title-str"),legalText:e.getLocalizedStr(i.legalTextStr,FP,"legal-text-str")};i.strings=i.strings||{},Object.assign(i.strings,o);var a=_.size(r)>1?"basegame-required-plural-str":"basegame-required-str",s=_.size(r)>1?i.basegameRequiredPluralStr:i.basegameRequiredStr;i.strings.basegameRequiredStr=e.getLocalizedStr(s,FP,a,(ut(n={},hw,i.basegameName),ut(n,vw,r.join(", ")),n)),i.isMissingBasegame=!_.isUndefined(i.basegameName),i.isMissingDlc=!_.isUndefined(i.softDependencyName),i.basegameOfferType=i.basegameIsFree?t.FREE:t.VAULT},template:EP}}function mt(e,t,i,n,r,o,a,s){"ngInject";function c(){e.isContinueToCheckoutDisabled=!1,e.$digest()}function l(){e.strings.continueStr=e.offerSwapped?e.strings.continueCtaStr:e.strings.continueWithoutDlcCtaStr}function d(t){_.isUndefined(p)||o.addToBundle(t,p).then(function(){return e.$digest()})}Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SOFT_BUNDLING_SWAP,e.telemetryOfferWithSoftDependencyOcdpath);var g=[],u=void 0,p=void 0,m=a.getCatalogInfo(o.getBundleOffers()).then(function(e){g=_.values(e)});e.isContinueToCheckoutDisabled=!0,e.offerSwapped=!1,e.strings={continueCtaStr:t.getLocalizedStr(e.continueCtaStr,FP,"continue-cta-str"),continueWithoutDlcCtaStr:t.getLocalizedStr(e.continueWithoutDlcCtaStr,FP,"continue-without-dlc-cta-str")},e.strings.dlcRequiredStr=t.getLocalizedStr(e.dlcRequiredStr,FP,"dlc-required-str",{"%dlcMissingSoftDependencyName%":e.offerWithSoftDependencyName,"%softDependencyName%":e.softDependencyName}),this.handleOfferActions=function(t){var i=t.offerId,o=t.isSelected,a=t.offerType,f=t.model;m.then(function(){o?a===n.SWAP?(t=f,u||g.forEach(function(e,i){t.extraContentDisplayGroup&&t.extraContentDisplayGroup===g[i].extraContentDisplayGroup&&(u=g[i],p=i)}),u&&t&&(g[p]=t,e.offerSwapped=!0,d(t)),l()):(e.isContinueToCheckoutDisabled=!0,(a===n.FREE?r.entitleFreeGame(i,!1,!1):r.entitleVaultGame(i,!1,{showCheckoutConfirmation:!1})).then(function(){l()}).catch(function(e){s.error("["+FP+"] error entitling "+a+" offer",e)}).finally(function(){c()})):(u&&(g[p]=u,e.offerSwapped=!1,d(u)),l());var t})},e.continueToCheckout=function(){m.then(function(){i.setReturnValues(!0,{id:e.dialogid,bundleOffers:g}),i.close(e.dialogid)})},m.then(function(){c()}),this.handleOfferActions({isSelected:e.offerSwapped}),l()}function ft(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ht(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(t){e.strings.continueStr=t?e.strings.continueCtaStr:e.strings.continueWithoutBasegameCtaStr}var g,u=void 0,p=void 0,m=_.map(e.dlcgameNames,function(e){return decodeURIComponent(e)});e.isContinueToCheckoutDisabled=!1,e.offerType=n.FREE,e.strings={continueCtaStr:t.getLocalizedStr(e.continueCtaStr,xP,"continue-cta-str"),continueWithoutBasegameCtaStr:t.getLocalizedStr(e.continueWithoutBasegameCtaStr,xP,"continue-without-basegame-cta-str",ft({},hw,e.basegameName)),titleStr:t.getLocalizedStr(e.titleStr,xP,"title-str",ft({},hw,e.basegameName))},_.size(m)>1?(u=1,p=bw):(u=0,p=vw),e.strings.warningStr=t.getLocalizedStr(e.warningStr,xP,"warning-str",(ft(g={},hw,e.basegameName),ft(g,p,m.join(", ")),g),u),this.handleOfferActions=function(t){var i=t.isSelected;e.isContinueToCheckoutDisabled=!0,s.entitleFreeGame(e.basegameOfferid,!1,!1).then(function(){d(i)}).catch(function(e){l.error("["+xP+"] error entitling free basegame offer",e)}).finally(function(){e.isContinueToCheckoutDisabled=!1,e.$digest()})},e.continueToCheckout=function(){var t=_.map(e.dlcgameOfferids,decodeURIComponent);i.close(e.dialogid),e.bundleType&&e.promoRuleId?c.buy(t,e.bundleType,e.promoRuleId,void 0,!0):(i.close(e.dialogid),r.getCatalogInfo(t).then(a.transformOffer).then(_.values).then(_.head).then(function(i){var n=o.getPrimaryAction(i);o.startActionFromPurchasePreventionModal(n,_.head(t),e.isOfferAddedToCart?e.basegameOfferid:void 0)}).catch(function(e){l.error("["+xP+"] error checking out after free basegame suggestion",e)}))},d(e.isOfferAddedToCart)}function vt(e,t,i,n,r,o,a){"ngInject";Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_BASE_GAME_UPSELL,e.telemetryDlcgameOcdpath),e.isOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.offerType=n.XSELL,e.strings={titleStr:t.getLocalizedStr(e.titleStr,AP,"title-str",{"%basegameName%":e.basegameName}),warningStr:t.getLocalizedStr(e.warningStr,AP,"warning-str",{"%basegameName%":e.basegameName,"%dlcgameName%":e.dlcgameName}),continueStr:t.getLocalizedStr(e.continueCtaStr,AP,"continue-cta-str")},this.handleOfferActions=function(t){var i=t.isSelected;e.isOfferAddedToCart=i,e.isContinueToCheckoutDisabled=!i},e.continueToCheckout=function(){i.close(e.dialogid),r.getCatalogInfo([e.dlcgameOfferid]).then(a.transformOffer).then(_.values).then(_.head).then(function(t){var i=o.getPrimaryAction(t);o.startActionFromPurchasePreventionModal(i,e.dlcgameOfferid,e.isOfferAddedToCart?e.basegameOfferid:void 0)})},this.handleOfferActions({isSelected:e.isOfferAddedToCart})}function bt(e,t,i,n,r,o,a,s){"ngInject";Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_BASE_GAME_UPSELL,e.telemetryDlcgameOcdpath),e.isOfferAddedToCart=!1,e.isContinueToCheckoutDisabled=!1,e.offerType=n.UPSELL,e.strings={titleStr:t.getLocalizedStr(e.titleStr,RP,"title-str",{"%basegameName%":e.basegameName}),warningStr:t.getLocalizedStr(e.warningStr,RP,"warning-str",{"%basegameName%":e.basegameName,"%dlcgameName%":e.dlcgameName}),continueStr:t.getLocalizedStr(e.continueCtaStr,RP,"continue-cta-str")},this.handleOfferActions=function(t){var i=t.isSelected;e.isOfferAddedToCart=i,e.isContinueToCheckoutDisabled=!i},e.continueToCheckout=function(){i.close(e.dialogid),r.getCatalogInfo([e.basegameOfferid]).then(a.transformOffer).then(_.values).then(_.head).then(function(t){var i=o.getPrimaryAction(t);o.startActionFromPurchasePreventionModal(i,e.basegameOfferid)}).catch(s.logError)},this.handleOfferActions({isSelected:e.isOfferAddedToCart})}function yt(e){return["ComponentsConfigFactory","UtilFactory","DialogFactory","NavigationFactory",function(t,i,n,r){"ngInject";return{restrict:"E",scope:{dialogId:"@",gameDisplayName:"@",needHelpUrl:"@",ubisoftUsername:"@",ubisoftProfileImageUrl:"@"},link:function(t){switch(t.strings={titleStr:i.getLocalizedStr(!1,e,"title-str"),descriptionStr:i.getLocalizedStr(!1,e,"description-str",{"%game%":"<strong>"+t.gameDisplayName+"</strong>","%account%":t.ubisoftProfileImageUrl&&t.ubisoftUsername?'<img class="origin-dialog-content-connecttoubisoft-profileimage" src="'+t.ubisoftProfileImageUrl+'" /><strong>'+t.ubisoftUsername+"</strong>":t.ubisoftUsername?t.ubisoftUsername:null}),needHelpStr:i.getLocalizedStr(!1,e,"need-help-str"),needHelpUrl:i.getLocalizedStr(!1,e,"need-help-url",{"%url-language%":Origin.locale.languageCode()}),proceedToLinkAccountStr:i.getLocalizedStr(!1,e,"proceed-to-link-account-str"),useAnotherUbisoftAccountStr:i.getLocalizedStr(!1,e,"use-another-ubisoft-account-str"),connectToUbisoftStr:i.getLocalizedStr(!1,e,"connect-to-ubisoft-str"),createUbisoftAccountStr:i.getLocalizedStr(!1,e,"create-ubisoft-account-str"),closeStr:i.getLocalizedStr(!1,e,"close-str")},t.primaryActionClicked=function(){n.setValuesAndClose(t.dialogId,{accepted:!0,content:{takeAction:!0}})},t.secondaryActionClicked=function(){n.setValuesAndClose(t.dialogId,{accepted:!1,content:{takeAction:!0}})},t.openExternalHelpWindow=function(e){e&&(e.stopPropagation(),e.preventDefault()),r.externalUrl(t.strings.needHelpUrl,!0)},e){case BP.CONNECT:t.primaryActionText=t.strings.connectToUbisoftStr,t.secondaryActionText=t.strings.createUbisoftAccountStr;break;case BP.CONFIRM:t.primaryActionText=t.strings.proceedToLinkAccountStr,t.secondaryActionText=t.strings.useAnotherUbisoftAccountStr;break;default:t.primaryActionText=t.strings.closeStr,t.secondaryActionText=null}},template:NP}}]}function St(e,t,i,n,r){"ngInject";e.strings={titleStr:t.getLocalizedStr(e.titleStr,WP,"title-str"),dismissButtonLabel:t.getLocalizedStr(e.dismissButtonLabel,WP,"dismiss-button-label"),descriptionText:t.getLocalizedStr(e.descriptionText,WP,"description-text",qP)},e.onClickContinue=function(){r.asyncOpenUrlWithEADPSSO(e.redirectUri)},e.onClickGoBack=function(){i.close(WP),n.reopenCheckout()},e.onClickClose=function(){i.close(WP)}}function kt(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",descriptionText:"@",dismissButtonLabel:"@",redirectUri:"@"},controller:St,template:VP,link:function(t,i){i.find(".origin-dialog-content-client2webredirect-description-text").html(e("<div>"+t.strings.descriptionText+"</div>")(t))}}}function It(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";function m(t,i){e.title=_.get(i,["i18n","displayName"]),e.packart=_.get(i,["i18n","packArtLarge"]),e.backgroundImage=_.get(t,"download-background-image"),e.$digest()}function f(e,t){var i=s.formatBytes(e);return s.getLocalizedStr(!1,N_,t,{"%size%":i},e)}function h(t){var i=t||"";e.states={pause:"pause"+i,resume:"resume"+i,cancel:"cancel"+i}}function v(i){var n,r,o,a,c,l=i.clientInfo;if(e.queueInfo=i.queueInfo,l&&l.progressInfo&&(n=l.progressInfo,e.progress=l,e.percent=Math.floor(n.progress*V_),e.phase=n.phase,e.type=n.type,e.totalFileSize=n.totalFileSize,e.dynamicDownload=n.dynamicDownload,"mini"===e.format&&0===i.queueInfo.queueIndex&&(e.percentMini=Math.floor(n.progress*V_)),c=l,e.currentStatus="",c.installing?h(G_):c.updating?(e.currentStatus=e.updatingLoc,h(U_)):c.isLocate?(e.currentStatus=e.locatingLoc,h(M_)):c.isMove?(e.currentStatus=e.movingLoc,h(j_)):c.repairing?(e.currentStatus=e.repairingLoc,h(B_)):h(),"active"===e.status)){e.size=f(e.totalFileSize,"sizestr"),e.downloaded=f(n.bytesDownloaded,"sizestr");var d=n.CurrentFilePatchSize>0,g=s.getDownloadState(n);e.progressBarClass=function(e,t){return"paused"===e?"otkprogress-block-ispaused":"complete"===e?"otkprogress-block-iscomplete":"active"!==e&&"preparing"!==e||t?t?"otkprogress-block-ispreparing":"":"otkprogress-block-isactive"}(g,d),e.dynamicDownload&&"INSTALL"===e.type&&"INSTALLING"===e.phase?e.timeRemaining=e.preparingToPlayLoc:e.timeRemaining=(r=n.secondsRemaining,o="timestr",a=t.duration(r,"seconds")._data,s.getLocalizedStr(!1,N_,o,{"%hours%":a.hours,"%minutes%":a.minutes,"%seconds%":a.seconds})+" "+e.remainingLoc),e.speed=f(n.bytesPerSecond,"speedstr"),e.phaseDisplay=n.phaseDisplay,e.resume="PAUSED"===e.phase||"ENQUEUED"===e.phase,e.dynamicDownload&&(n.playableAt?(k.offerId=e.offerId,k.playableAt=n.playableAt):e.offerId===k.offerId&&(n.playableAt=k.playableAt)),u.isEntitlementRepairingAndPlayableAt(n)?(function(t){e.shouldLightFlag=t.shouldLightFlag,e.arrowPosition=(100*t.playableAt).toFixed(0);var i=Origin.locale.locale().toLowerCase();i===H_?(W_=Q_,e.flagPosition=e.arrowPosition-W_,e.flagPositionMini=e.arrowPosition-J_):i===z_?(W_=X_,e.flagPosition=e.arrowPosition-W_,e.flagPositionMini=e.arrowPosition-Z_):(e.flagPosition=e.arrowPosition-W_,e.flagPositionMini=e.flagPosition),e.flagPosition=_.max([e.flagPosition,q_]),e.flagPosition=_.min([e.flagPosition,Y_]),e.flagPositionMini=_.max([e.flagPositionMini,q_]),e.flagPositionMini=_.min([e.flagPositionMini,K_]),e.playable=e.shouldLightFlag?e.playableLoc:e.playableAtLoc.replace("%percent%",e.arrowPosition+"%")}(n),e.$emit("navigation:heightchange")):(e.shouldLightFlag=!1,e.arrowPosition=0,e.flagPosition=0,e.flagPositionMini=0),e.pausable=l.pausable,e.resumable=l.resumable,e.cancellable=l.cancellable,u.isEntitlementDownloadCompleted(n)&&(e.pausable=!1,e.cancellable=!1,e.phaseDisplay=e.finalizingLoc,e.type=$_,e.phase=R_),"READYTOSTART"===e.phase&&p.events.fire("originDownloadManagerGame:installerStatusChanged")}}function b(){e.isOnline=l.isClientOnline()}var y,S,k={offerId:0,playableAt:0},I={pause:Origin.client.games.pauseDownload,resume:Origin.client.games.resumeDownload,cancel:Origin.client.games.cancelDownload,pauseInstall:Origin.client.games.pauseInstall,resumeInstall:Origin.client.games.resumeInstall,cancelInstall:Origin.client.games.cancelInstall,pauseUpdate:Origin.client.games.pauseUpdate,resumeUpdate:Origin.client.games.resumeUpdate,cancelUpdate:Origin.client.games.cancelUpdate,pauseRepair:Origin.client.games.pauseRepair,resumeRepair:Origin.client.games.resumeRepair,pauseMove:Origin.client.games.pauseMove,resumeMove:Origin.client.games.resumeMove,cancelRepair:Origin.client.games.cancelRepair,cancelMove:Origin.client.games.cancelRepair,cancelLocate:Origin.client.games.cancelRepair,play:Origin.client.games.play,install:Origin.client.games.install,pushToTop:Origin.client.games.moveToTopOfQueue,remove:function(e,t){Origin.client.contentOperationQueue.remove(e,t.externalType)}};e.calculatingLoc=s.getLocalizedStr(e.calculatingStr,N_,"calculatingstr"),e.playableLoc=s.getLocalizedStr(e.playablestr,N_,"playablestr"),e.playableAtLoc=s.getLocalizedStr(e.playableAtStr,N_,"playableatstr"),e.waitingLoc=s.getLocalizedStr(e.waitingStr,N_,"waitingstr"),e.updatingLoc=s.getLocalizedStr(e.updatingstr,N_,"updatingstr"),e.repairingLoc=s.getLocalizedStr(e.repairingstr,N_,"repairingstr"),e.locatingLoc=s.getLocalizedStr(e.locatingstr,N_,"locatingstr"),e.movingLoc=s.getLocalizedStr(e.movingstr,N_,"movingstr"),e.goOnlineLoc=s.getLocalizedStr(e.goonlinestr,N_,"goonlinestr"),e.editDownloadRateLoc=s.getLocalizedStr(e.editdownloadratestr,N_,"editdownloadratestr")||"Edit download rate",e.remainingLoc=s.getLocalizedStr(e.remainingstr,N_,"remainingstr")||"remaining",e.preparingToPlayLoc=s.getLocalizedStr(e.preparingtoplaystr,N_,"preparingtoplaystr")||"Preparing to play",e.pauseLoc=s.getLocalizedStr(e.pausestr,N_,"pausestr"),e.cancelLoc=s.getLocalizedStr(e.cancelstr,N_,"cancelstr"),e.finalizingLoc=s.getLocalizedStr(e.finalizingstr,N_,"finalizingstr"),e.onIconClick=function(t,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.stopPropagation(),n&&i&&_.get(I,i).call(this,e.offerId,{externalType:e.externalType})},e.onEditDownloadRate=function(){Origin.client.oig.IGOIsActive()?g.openIGOSPA("SETTINGS","application"):g.goSettingsPage("application")},e.$watch("offerId",function(t){t&&(e.offerId=t,Promise.all([i.getOcdByOfferId(e.offerId).then(r.findDirectives("origin-game-defaults")).then(r.flattenDirectives("origin-game-defaults")).then(_.head),n.getCatalogInfo([e.offerId]).then(o.getProperty(e.offerId))]).then(_.spread(m)).catch(function(e){c.error("[download-manager-game GamesCatalogFactory.getCatalogInfo] error",e)}),y&&y.detach(),y=a.getObserver(t,_.get(e,"externalType"),e,v))}),b(),S=[l.events.on("myauth:clientonlinestatechanged",function(t){t&&b(),e.$digest()})],e.$on("$destroy",function(){d.detachAll(S)})}function wt(e,t,i,n,r,o,a){"ngInject";function s(e){n.error("Could not retrieve head offerid from client proxy:",e)}function c(){e.$emit("navigation:heightchange")}function l(){Origin.client.contentOperationQueue.entitlementsCompletedOfferIdList().then(function(t){e.completeCount=t.length,setTimeout(c,0),e.$digest()})}function d(t){e.offerId&&t||setTimeout(c,500),e.externalType=_.get(a.getEntitlement(t),"externalType",""),e.offerId=t,e.$digest()}var g=[];e.inClient=Origin.client.isEmbeddedBrowser(),e.isOIGContext=!!o.getOIGContextConfig(),e.downloadManagerLoc=t.getLocalizedStr(e.downloadmanagerstr,iO,"downloadmanagerstr"),g=[Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_HEADCHANGED,d),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_ADDEDTOCOMPLETE,l),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_REMOVED,l),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_COMPLETELISTCLEARED,l)],e.inClient&&(i.waitForGamesDataReady().then(function(){Origin.client.contentOperationQueue.headOfferId().then(d).catch(s)}),l()),e.$on("$destroy",function(){r.detachAll(g)})}function Ct(e,t){"ngInject";return{restrict:"E",controller:wt,template:tO,link:function(i,n){e(function(){function e(e){e.stopPropagation(),n===e.target||n[0].contains(e.target)||r.removeClass(rO)}var r=angular.element(document.querySelectorAll("."+nO)[0]);i.showFlyout=function(e){e.stopPropagation(),e.preventDefault(),r.addClass(rO),t.handleMenuClick()},angular.element(document).on("mousedown",e),i.$on("$destroy",function(){angular.element(document).off("mousedown",e)})})}}}function Tt(e,t,i,n,r,o){"ngInject";function a(e){n.error("Could not retrieve entitlement list from client proxy:",e)}function s(t){var i=aO(t,2),n=i[0],r=i[1];e.downloadQueue=n,e.completedQueue=r,e.hideDownloadFlyoutIfEmpty(),e.$digest()}function c(){return Promise.all([Origin.client.contentOperationQueue.entitlementsQueued(),Origin.client.contentOperationQueue.entitlementsCompletedOfferIdList()]).then(s).catch(a)}var l=[];e.isOIGContext=!!o.getOIGContextConfig(),e.queueLoc=i.getLocalizedStr(e.queuestr,sO,"queuestr"),e.completeLoc=i.getLocalizedStr(e.completestr,sO,"completestr"),e.downloadManagerLoc=i.getLocalizedStr(e.downloadmanagerstr,sO,"downloadmanagerstr"),e.minimizeLoc=i.getLocalizedStr(e.minimizestr,sO,"minimizestr"),e.emptyQueueLoc=i.getLocalizedStr(e.emptyqueuestr,sO,"emptyqueuestr"),e.clearLoc=i.getLocalizedStr(e.clearstr,sO,"clearstr"),e.clearCompleteQueue=function(t){t.stopPropagation(),Origin.client.contentOperationQueue.clearCompleteList(),e.$emit("navigation:heightchange"),c()},l=[Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_HEADCHANGED,c),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_ENQUEUED,c),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_ADDEDTOCOMPLETE,c),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_REMOVED,c),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_COMPLETELISTCLEARED,c),Origin.events.on(Origin.events.CLIENT_NAV_OPEN_DOWNLOADQUEUE,function(){e.openFlyout&&e.openFlyout()})],t.waitForGamesDataReady().then(c()),e.$on("$destroy",function(){r.detachAll(l)})}function Pt(e){var t=angular.element(document.querySelectorAll("."+cO)[0]);e.openFlyout=function(){t.hasClass(lO)||t.addClass(lO)},e.closeFlyout=function(e){e.stopPropagation(),t.hasClass(lO)&&t.removeClass(lO)},e.hideDownloadFlyoutIfEmpty=function(){0===e.downloadQueue.length&&0===e.completedQueue.length&&t.removeClass(lO)}}function _t(e,t,i,n,r){"ngInject";function o(){g=!0,l(),i.removeVisibilityChangeEventHandler(e,a,s),r.set(pO,!0)}function a(){c(!0)}function s(){c(!1)}function c(t){e.isInFocus=t,e.$digest()}function l(){e.isVisible=d&&u&&!g,e.isVisible&&i.addVisibilityChangeEventHandler(e,a,s)}var d,g=r.get(pO,!1),u=n.isGiftingEnabled();e.isInFocus=!0,e.startAction=function(){t.open({id:uO,size:"large",directives:[{name:"origin-dialog-content-featureintro-gifting",data:{"dialog-id":uO,"title-str":e.titleStr,content:e.content,"image-url":e.imageUrl,"btn-text":e.btnText}}],callback:o})},this.updateLoggedInState=function(e){d=e.isLoggedIn,l()},this.dialogClosed=function(e){var t=_.get(e,"id");t&&t===uO&&o()}}function Ot(e,t){"ngInject";return{restrict:"E",controller:_t,link:function(i,n,r,o){i.$on("$destroy",function(){t.events.off("myauth:change",o.updateLoggedInState),e.events.off("dialog:hide",o.dialogClosed)}),t.events.on("myauth:change",o.updateLoggedInState),t.waitForAuthReady().then(o.updateLoggedInState),e.events.on("dialog:hide",o.dialogClosed)},scope:{titleStr:"@",content:"@",imageUrl:"@",btnText:"@"},template:gO}}function Et(e){"ngInject";e.action=function(){e.isEnabled()&&e.actionCallback()}}function Ft(e,t){"ngInject";return{restrict:"E",scope:{getLabel:"&",isActive:"&",onDismiss:"&",filterIds:"="},link:function(i){function n(e){return{id:e,filterIds:[e],label:i.getLabel()(e)}}function r(e,t){return{id:e.join(""),filterIds:e,label:s.replace("%activeCount%",t-1)}}function o(){var e=[],t=0,o=i.isActive()("displayName");o&&t++,_.forEach(i.filterIds,function(n){i.isActive()(n)&&(e.push(n),t++)}),function(e,t,o){var a=[],s=t.length;e?e&&(1===s&&a.push(n(t[0])),s>1&&a.push(r(t,o))):s>2?(a.push(n(t[0])),a.push(r(t.slice(1),o))):_.forEach(t,function(e){a.push(n(e))}),i.filters=a}(o,e,t)}var a=null,s=t.getLocalizedStr(null,vO,"morethanonefilterlabel",{});i.dismissFilters=function(e){_.forEach(e.filterIds,i.onDismiss())},o(),a=e.events.on(bO,o),i.$on("$destroy",function(){a&&a.detach()})},template:hO}}function xt(e){"ngInject";e.toggle=function(){e.enabled()&&(e.isActive=!e.isActive)},e.$watch("isActive",function(t,i){t!==i&&e.onToggle()}),e.visible=function(){return!angular.isDefined(e.isVisible())||e.isVisible()},e.enabled=function(){return!angular.isDefined(e.isEnabled())||e.isEnabled()}}function Lt(e,t){"ngInject";e.closeFilterPanel=function(){t.setFilterOverlay(!1)}}function At(e,t){"ngInject";return{restrict:"E",transclude:!0,link:function(i,n){function r(){d.offsetTop+g.offsetHeight>window.innerHeight?l.height(window.innerHeight-d.getBoundingClientRect().top):l.height("auto")}function o(){var e=s+window.scrollY,t=Math.max(e,0)+"px";l.css("top",t)}function a(){var e=d.offsetTop+d.offsetHeight-window.scrollY,t=c?c.offsetTop-window.scrollY:0;c&&e>=t?d.offsetTop-window.scrollY-s>=0&&o():o()}var s,c=document.querySelector(".origin-globalfooter"),l=n.find(".origin-filterpanel"),d=l.get(0),g=l.find(".origin-filter-list").get(0);e.addScrollEventHandler(i,a,100),e.addResizeEventHandler(i,r,300),s=d.offsetTop,t(r,0,!1),a()},controller:Lt,scope:{isVisible:"&"},template:kO}}function Dt(e){"ngInject";e.dismiss=function(){e.modelObject[e.modelFieldName]=""},e.isActive=function(){var t=e.modelObject[e.modelFieldName];return"string"==typeof t&&t.length>0},e.$watch("modelObject[modelFieldName]",function(t,i){t!==i&&e.onChange()})}function Rt(e){"ngInject";e.toggle=function(){e.open=!e.open},e.open=!0}function $t(e,t){"ngInject";function i(){n.friends=e.friendslist||[],n.displayFriends()}var n=this;e.showFriendTiles=!1,this.initFriendsList=i,e.showFriendsModal=function(){t.openDirective({id:"web-show-friends-modal",name:"origin-dialog-content-friendspopout",data:{friendspopouttitle:e.popoutTitleStr,friendsliststr:n.friends.join(",")}})},this.displayFriends=function(){var t=n.maxFriends,i=n.friends.length;i>t?(t>0&&t--,e.hiddenFriends=i-t):e.hiddenFriends=0,e.friends=n.friends.slice(0,t),e.showFriendTiles=e.friends.length>0,e.$emit("friendsTileDisplayVisible",e.showFriendTiles)},e.$watchCollection("friendslist",i),this.friends=[],this.maxFriends=1,e.hiddenFriends=0}function Nt(e,t){"ngInject";return{restrict:"E",scope:{friendslist:"=",popoutTitleStr:"@popouttitlestr"},controller:$t,template:PO,link:function(i,n,r,o){function a(){var e=n.find(".origin-avatarlist"),t=e.length>0?e[0].offsetWidth:0;o.maxFriends=Math.floor(t/_O)-1}function s(){a(),o.displayFriends()}function c(){l&&(window.clearTimeout(l),l=null),l=window.setTimeout(s,30)}var l,d;a(),o.initFriendsList(),angular.element(e).on("resize",c),i.$on("$destroy",function(){angular.element(e).off("resize",c),d&&d.detach()}),d=t.events.on(t.events.HOME_TILE_VISIBLE,s)}}}function Gt(e,t,i,n,r,o){"ngInject";function a(e){return n.create(e)}var s=null,c=null;e.friendsPlaying=[],e.friendsPlayed=[],e.friendsOwned=[],e.$on("$destroy",function(){s&&(s.detach(),s=null),c&&(c.detach(),c=null)}),e.offerId&&(o.getCatalogInfo([e.offerId]).then(function(t){var n=t[e.offerId];n&&n.i18n&&(e.friendsOwnedTitleStr=i.getLocalizedStr(e.popoutFriendsOwnedGameStr,AO,"popoutfriendsownedgame",{"%game%":n.i18n.displayName}),e.friendsPlayingTitleStr=i.getLocalizedStr(e.popoutFriendsPlayingGameStr,AO,"popoutfriendsplayinggame",{"%game%":n.i18n.displayName}),e.friendsPlayedTitleStr=i.getLocalizedStr(e.popoutFriendsPlayedGameStr,AO,"popoutfriendsplayedgame",{"%game%":n.i18n.displayName}))}),"friendsOwned"===e.requestedFriendType?r.getUsersWhoOwn(e.offerId).then(function(t){e.friendsOwned=t}):(t.getFriendsPlayingObservable(e.offerId).then(function(t){(s=a(t)).getProperty("list").attachToScope(e,"friendsPlaying")}),t.getFriendsPlayedObservable(e.offerId).then(function(t){(c=a(t)).getProperty("list").attachToScope(e,"friendsPlayed")})))}function Ut(e,t,i,n,r){"ngInject";function o(){e.friendsTitleStr="friendsOwned"!==e.requestedFriendType&&e.friendsPlaying.length?e.friendsPlayingTitleStr:"friendsOwned"!==e.requestedFriendType&&e.friendsPlayed.length?e.friendsPlayedTitleStr:e.friendsOwned.length?e.friendsOwnedTitleStr:"",e.$emit("friendsPlayingTextVisible",e.friendsTitleStr.length>0)}function a(){e.friendsPlayingTitleStr=i.getLocalizedStr(e.friendsPlayingDescriptionStr,$O,"friendsplayingdescription",{"%friends%":e.friendsPlaying.length},e.friendsPlaying.length),o()}function s(){e.friendsPlayedTitleStr=i.getLocalizedStr(e.friendsPlayedDescriptionStr,$O,"friendsplayeddescription",{"%friends%":e.friendsPlayed.length},e.friendsPlayed.length),o()}var c=null,l=null;e.friendsPlaying=[],e.friendsPlayed=[],e.friendsOwned=[],e.friendsTitleStr="",e.$on("$destroy",function(){c&&(c.detach(),c=null),l&&(l.detach(),l=null)}),e.offerId&&("friendsOwned"===e.requestedFriendType?n.getUsersWhoOwn(e.offerId).then(function(t){e.friendsOwned=t,e.friendsOwnedTitleStr=i.getLocalizedStr(e.friendsOwnedDescriptionStr,$O,"friendsowneddescription",{"%friends%":t.length},t.length),o()}):(t.getFriendsPlayingObservable(e.offerId).then(function(t){(c=r.create(t)).getProperty("list").attachToScope(e,"friendsPlaying"),c.attachToScope(e,a)}),t.getFriendsPlayedObservable(e.offerId).then(function(t){(l=r.create(t)).getProperty("list").attachToScope(e,"friendsPlayed"),l.attachToScope(e,s)}))),e.$emit("friendsTextVisible",e.text.length>0),e.$emit("friendsSubtitleVisible",!!e.subtitle&&e.subtitle.length>0)}function Bt(e,t,i,n,r,o){"ngInject";function a(){n.getCatalogInfo([e.offerId]).then(c).catch(function(e){r.error("origin-game-badge - getCatalogInfo",e)})}function s(t,i,n){i=void 0!==i&&i,n=void 0===n||n,e.isNew=i,e.badgeText=t,e.isVisible=n}function c(t){var n=i.getEntitlement(e.offerId),r=t[e.offerId],a=o.isPrivate(n),c=n.isNew;s("",!1,!1),a?s(e.badgeTextVals.test):r.trial||r.earlyAccess?s(e.badgeTextVals.trial):c?s(e.badgeTextVals.new,!0):r.alpha?s(e.badgeTextVals.alpha):r.beta?s(e.badgeTextVals.beta):r.demo&&s(e.badgeTextVals.demo),e.$$phase||e.$digest()}e.badgeTextVals={test:t.getLocalizedStr(e.testStr,GO,"test"),new:t.getLocalizedStr(e.newStr,GO,"new"),trial:t.getLocalizedStr(e.trialStr,GO,"trial"),alpha:t.getLocalizedStr(e.alphaStr,GO,"alpha"),beta:t.getLocalizedStr(e.betaStr,GO,"beta"),demo:t.getLocalizedStr(e.demoStr,GO,"demo")},i.events.on("games:isNewUpdate:"+e.offerId,a),e.$on("$destroy",function(){i.events.off("games:isNewUpdate:"+e.offerId,a)}),a()}function Mt(e,t,i){"ngInject";function n(){return i.isFavorite(e.offerId,{externalType:e.externalType})}function r(){e.isFavorite=o.isFavorited(),e.$digest()}var o=this;e.tooltipLabelStr=t.getLocalizedStr(e.tooltiplabel,BO,"tooltiplabel"),o.isFavorited=function(){return i.waitForFiltersReady().then(n)},o.addFavoriteGame=function(){i.addFavoriteGame(e.offerId,{externalType:e.externalType})},o.removeFavoriteGame=function(){i.removeFavoriteGame(e.offerId,{externalType:e.externalType})},i.events.on("filterChanged",r),e.$on("$destroy",function(){i.events.off("filterChanged",r)})}function jt(e,t,i,n){function r(){n.isFavorited().then(function(e){e?t.addClass(MO).removeClass(jO):t.removeClass(MO).addClass(jO)})}e.toggleFavorite=function(){t.hasClass(MO)?(t.removeClass(MO).addClass(jO),n.removeFavoriteGame()):(t.addClass(MO).removeClass(jO),n.addFavoriteGame())},r(),e.$watch("isFavorite",r)}function Ht(e,t,i,n){"ngInject";e.offerId&&(t.getFriendsPlayingObservable(e.offerId).then(function(t){i.create(t).getProperty("list").attachToScope(e,"friendsPlaying")}),e.game=n.getGame(e.offerId,e.externalType))}function zt(e,t,i,n,r){"ngInject";function o(e){r.error("[OGDGAMESTATS] getGameUsageInfo:",e)}function a(t){var n,r=0;0!==t.lastPlayedTime?(e.userLastPlayed=new Date(t.lastPlayedTime),e.userHasNotPlayed=void 0):(e.userHasNotPlayed=i.getLocalizedStr(e.userhasnotplayed,VO,"userhasnotplayed"),e.userLastPlayed=void 0),t.totalTimePlayedSeconds>0?(n=t.totalTimePlayedSeconds,r=Math.floor(n/60/60),e.userNeverPlayed=void 0):(e.userNeverPlayed=i.getLocalizedStr(e.userneverplayed,VO,"userneverplayed"),e.userHoursPlayed=void 0),e.lastPlayedStr=i.getLocalizedStr(e.lastplayed,VO,"lastplayed"),e.hoursPlayedStr=i.getLocalizedStr(e.hoursplayed,VO,"hoursplayed"),_.isUndefined(e.userNeverPlayed)&&(e.userHoursPlayed=i.getLocalizedStr(e.hoursplayedtemplate,VO,"hoursplayedtemplate",{"%hours%":r},r)),e.$digest()}function s(t){t.indexOf(e.offerId)>=0&&c()}function c(){d=t(l,WO,!1)}function l(){n.getGameUsageInfo(e.offerId).then(a).catch(o)}var d;Origin.events.on(Origin.events.CLIENT_GAMES_PLAYTIMECHANGED,s),e.$on("$destroy",function(){Origin.events.off(Origin.events.CLIENT_GAMES_PLAYTIMECHANGED,s),t.cancel(d)}),c()}function Vt(e,t,i,n,r){"ngInject";function o(){var t,i,o,s,c,l,d=a();if(d&&d.progressInfo&&d.progressInfo.active)switch(i=(t=d.progressInfo).playableAt,e.isApplyingPatch=t.CurrentFilePatchSize>0,e.stateStr=t.phaseDisplay,e.downloadState=n.getDownloadState(t),e.percent=e.isApplyingPatch?0:Math.floor(t.progress*m),e.shouldLightFlag=t.shouldLightFlag,o=t.progress,e.downloadState===v||e.downloadState===b||e.downloadState===KO?(s=e.rotationDegreesCSS,(l={transform:"rotate("+(c=Math.round(o*f)+"deg")+")","-webkit-transform":"rotate("+c+")"})!==s&&(e.rotationDegreesCSS=l)):e.rotationDegreesCSS="",r.isEntitlementDownloadCompleted(t)&&(e.stateStr=w),r.isEntitlementRepairingAndPlayableAt(t)&&(e.shouldLightFlag?e.playableAtStr=S:e.playableAtStr=k.replace("%1",(100*i).toFixed(0)+"%")),d.progressInfo.phase){case"ENQUEUED":e.isDownloading=t.progress>0,e.isComplete=!1;break;case"READYTOSTART":e.isDownloading=!1,e.errorCountStr="";break;default:e.isComplete=!1,e.isDownloading=!0,e.errorCountStr=""}else e.isDownloading=!1}function a(){return i.getGame(e.offerId,e.externalType)}function s(){var t=a(),n=i.getQueueInfo(e.offerId,e.externalType);t&&t.progressInfo&&n&&(n.completedIndex>-1||"COMPLETED"===t.progressInfo.phase||0===n.queueIndex&&"READYTOSTART"===t.progressInfo.phase)&&(e.downloadState=h,e.isComplete=!0,e.stateStr=y)}function c(){o(),e.$$phase||e.$digest()}function l(t){t===e.offerId&&s()}function d(){var t=a();(t&&t.progressInfo?t.progressInfo.errorRetryCount:0)?(e.errorCountStr=I,e.$$phase||e.$digest()):e.errorCountStr=""}function g(){e.isDownloading=!1,e.isComplete=!1,e.downloadState="",e.rotationDegreesCSS="",e.playableAtStr="",e.shouldLightFlag=!1,e.errorCountStr=""}function u(){e.downloadState===h&&g()}function p(t){e.offerId===t&&g()}var m=100,f=360,h="complete",v="active",b="paused",y=n.getLocalizedStr(e.completestr,QO,"completestr"),S=n.getLocalizedStr(e.playablenowstr,QO,"playablenowstr"),k=n.getLocalizedStr(e.playableatstr,QO,"playableatstr"),I=n.getLocalizedStr(e.errorretrystr,QO,"errorretrystr"),w=n.getLocalizedStr(e.finalizingstr,QO,"finalizingstr");e.isDownloading=!1,e.isComplete=!1,e.downloadState="",e.rotationDegreesCSS="",e.playableAtStr="",e.errorCountStr="",e.shouldLightFlag=!1,t.events.on("games:update:"+e.offerId,c),t.events.on("games:progressupdate:"+e.offerId,c),t.events.on("games:operationfailedupdate:"+e.offerId,d),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_ADDEDTOCOMPLETE,l),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_REMOVED,p),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_COMPLETELISTCLEARED,u),e.$on("$destroy",function(){g(),t.events.off("games:update:"+e.offerId,c),t.events.off("games:progressupdate:"+e.offerId,c),t.events.off("games:operationfailedupdate:"+e.offerId,d),Origin.events.off(Origin.events.CLIENT_OPERATIONQUEUE_ADDEDTOCOMPLETE,l),Origin.events.off(Origin.events.CLIENT_OPERATIONQUEUE_REMOVED,p),Origin.events.off(Origin.events.CLIENT_OPERATIONQUEUE_COMPLETELISTCLEARED,u)}),s(),o(),d()}function Wt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function qt(e,t,i){"ngInject";function n(e){var i=_.filter(e,function(e){return rE.indexOf(e.label)<0});return _.forEach(i,function(e){e.label=t.getLocalizedStr(null,eE,e.label)}),i}e.tooltipLabelStr=t.getLocalizedStr(e.tooltiplabel,eE,"tooltiplabel"),e.contextMenuClickEvent=iE,e.getAvailableActions=function(){return i.contextMenu(e.offerId,e.externalType).then(n)}}function Yt(e,t){"ngInject";var i;return{restrict:"E",scope:(i={offerId:"@offerid",tooltiplabel:"@tooltiplabel",downloadcta:"@",viewgamedetailscta:"@",playcta:"@",checkforupdatescta:"@",pauseupdatecta:"@",resumeupdatecta:"@",cancelupdatecta:"@",checkforrepairgamecta:"@",gamerepaircta:"@",pauserepaircta:"@",resumerepaircta:"@",cancelrepaircta:"@",installcta:"@",uninstallcta:"@",updatecta:"@",pausegamecta:"@",cancelgamecta:"@",resumegamecta:"@",addtodownloadscta:"@",downloadnowcta:"@",updatenowcta:"@",repairnowcta:"@",download:"@",preload:"@",resubscribecta:"@",locategamefoldercta:"@",movegamefoldercta:"@"},Wt(i,ZO,"@"),Wt(i,"externalType","@"),i),template:XO,controller:qt,link:function(i,n){function r(e){e.preventDefault(),e.stopPropagation()}var o=angular.element(tE);t.addElementScrollEventHandler(i,o,e.close,nE),i.$on("$destroy",function(){n.off(iE,r)}),n.on(iE,r)}}}function Kt(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h){"ngInject";function v(){var t=_.get(H,L,!1),i=_.get($(e.offerId,e.externalType),A,-1);return t||i>-1}function b(){return H&&H.isSelectedInODT}function y(){e.packArt=U.i18n.packArtLarge,e.defaultPackArt=o.defaultBoxArtUrl(),e.displayName=U.i18n.displayName,e.isDisabled=!a.isNonOriginGame(e.offerId)&&d.isDisabled(U,B,H,M,j,l.isActive()),e.isQueued=v(),e.isHighlighted=b(),n.isTouchEnabled()&&(e.showDetailsButton=!1),e.$digest()}function S(e){o.getCatalogInfo([e.offerId]).then(function(e){_.merge(U,e),y()})}function k(){e.$emit("gamelibrary:updatefilter"),e.isQueued=v(),e.$digest()}function I(){e.isHighlighted=b(),k()}function w(e){return angular.forEach(e,function(e){e.label=n.getLocalizedStr(z[e.label],sE,e.label)}),e}function C(){e.isQueued=!1,e.$digest()}function T(t){e.offerId===t&&(e.isQueued=!1,e.$digest())}function P(){if(e.cancelClick)return e.cancelClick=!1,void(e.clicked=!1);R(e.offerId,e.externalType),e.cancelClick=!1,e.clicked=!1}function O(t,i){t?Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_DOUBLE_CLICK_LAUNCH_GAME,e.offerId):i&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_DOUBLE_CLICK_DOWNLOAD_GAME,e.offerId)}var E,F,x,L=["progressInfo","active"],A=["completedIndex"],D=new Origin.utils.Communicator,R=f.removeFromCompletedQueue,$=f.getQueueInfo,N=!1,G=void 0,U=void 0,B=void 0,M=void 0,j=void 0,H=void 0,z=(E={startdownloadcta:e.startDownloadCtaStr,pausedownloadcta:e.pauseDownloadCtaStr,resumedownloadcta:e.resumeDownloadCtaStr,canceldownloadcta:e.cancelDownloadCtaStr,viewgamedetailscta:e.viewGameDetailsCtaStr,playcta:e.playCtaStr,starttrialcta:e.startTrialCtaStr,checkforupdatescta:e.checkForUpdatesCtaStr,pauseupdatecta:e.pauseUpdateCtaStr,resumeupdatecta:e.resumeUpdateCtaStr,cancelupdatecta:e.cancelUpdateCtaStr,checkforrepairgamecta:e.checkForRepairGameCtaStr,pauserepaircta:e.pauseRepairCtaStr,resumerepaircta:e.resumeRepairCtaStr,cancelrepaircta:e.cancelRepairCtaStr,installcta:e.installCtaStr,uninstallcta:e.uninstallCtaStr,openinodtcta:e.openInOdtCtaStr,updatecta:e.updateCtaStr,pausegamecta:e.pauseGameCtaStr,cancelgamecta:e.cancelGameCtaStr,resumegamecta:e.resumeGameCtaStr,addtodownloadscta:e.addToDownloadsCtaStr,downloadnowcta:e.downloadNowCtaStr,updatenowcta:e.updateNowCtaStr,repairnowcta:e.repairNowCtaStr,download:e.downloadStr,preload:e.preloadStr,cancelcloudsynccta:e.cancelCloudSyncCtaStr,repaircta:e.repairCtaStr,restorecta:e.restoreCtaStr,pauseinstallcta:e.pauseInstallCtaStr,resumeinstallcta:e.resumeInstallCtaStr,cancelinstallcta:e.cancelInstallCtaStr,showgamedetailscta:e.showGameDetailsCtaStr,addasfavoritecta:e.addAsFavoriteCtaStr,removeasfavoritecta:e.removeAsFavoriteCtaStr,updategamecta:e.updateGameCtaStr,customizeboxartcta:e.customizeBoxArtCtaStr,gamepropertiescta:e.gamePropertiesCtaStr,removefromlibrarycta:e.removeFromLibraryCtaStr,hidecta:e.hideCtaStr,viewachievements:e.viewAchievementsStr,unhidecta:e.unhideCtaStr,resubscribecta:e.resubscribeCtaStr,locategamefoldercta:e.locategamefolderCtaStr,movegamefoldercta:e.movegamefolderCtaStr},F=ZO,x=e.upgradegamectaStr,F in E?Object.defineProperty(E,F,{value:x,enumerable:!0,configurable:!0,writable:!0}):E[F]=x,E),V=void 0;e.delayLoaded=!1,e.getAvailableActions=function(){return angular.isUndefined(e.showContextMenu)||e.showContextMenu?s.contextMenu(e.offerId,e.externalType).then(w):Promise.resolve(null)},e.cancelClick=!1,e.clicked=!1,e.onTileClick=function(){e.clicked?e.cancelClick=!0:(e.clicked=!0,h.goToOgd({offerId:e.offerId,externalType:e.externalType}),R(e.offerId,e.externalType),t(P,250,!1))},e.onTileDblClick=function(){e.isDisabled||(m.goToState("app.game_gamelibrary_wrapper.library"),p.getItWithOrigin(e.offerId,{externalType:e.externalType}),Promise.all([g.isInstalled(),g.isInstallable()]).then(_.spread(O)))},e.strings={detailsButtonLabel:n.getLocalizedStr(e.detailsctaStr,sE,"detailscta")},e.goToGameDetailsPage=function(t){t.preventDefault(),_.isEmpty(i.searchString)?m.goToState(cE,{offerid:e.offerId}):m.goToState(cE,{offerid:e.offerId,searchString:decodeURI(i.searchString)})},e.getGameDetailsPageUrl=function(){return _.isEmpty(i.searchString)?m.getAbsoluteUrl(cE,{offerid:e.offerId}):m.getAbsoluteUrl(cE,{offerid:e.offerId,searchString:decodeURI(i.searchString)})},e.isDisabled=!1,e.isQueued=v(),Promise.all([o.getCatalogInfo([e.offerId]),a.getEntitlement(e.offerId,{externalType:e.externalType}),f.getGamePromise(e.offerId,e.externalType),f.getQueueInfo(e.offerId,e.externalType),g.isInstallable(),r.isTrialExpired(e.offerId)]).then(function(t){U=t[0][e.offerId],N=!0,D.fire("tile:catalogInfoReady"),B=t[1],H=t[2],M=t[4],j=t[5]}).then(y).then(function(){G=[a.events.on("games:update:"+e.offerId,I),a.events.on("games:downloadqueueupdate:"+e.offerId,k),a.events.on("games:catalogUpdated:"+e.offerId,S),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_COMPLETELISTCLEARED,C),Origin.events.on(Origin.events.CLIENT_OPERATIONQUEUE_REMOVED,T)],e.$on("$destroy",function(){c.detachAll(G)})}).catch(function(e){u.error("[origin-game-tile] error",e)}),e.$on("$destroy",function(){V&&(t.cancel(V),V=null)}),V=t(function(){function t(){V=null,e.delayLoaded=!0,e.$digest()}function i(){var e=_.map(a.getExtraContentEntitlementsByMasterTitleId(U.masterTitleId),"offerId");e.length?o.getCatalogInfo(e).then(t).catch(t):t()}N?i():D.once("tile:catalogInfoReady",i)},300,!1)}function Qt(e){"ngInject";function t(e,t,i){n(e,t),i.preventDefault(),i.stopPropagation()}var i="contextmenu",n=e.removeFromCompletedQueue;return{restrict:"E",scope:{offerId:"@offerid",hoursPlayed:"@hoursplayed",showDetailsButton:"@showdetailsbutton",detailsctaStr:"@detailscta",showContextMenu:"@showcontextmenu",startDownloadCtaStr:"@startdownloadcta",pauseDownloadCtaStr:"@pausedownloadcta",resumeDownloadCtaStr:"@resumedownloadcta",cancelDownloadCtaStr:"@canceldownloadcta",viewGameDetailsCtaStr:"@viewgamedetailscta",playCtaStr:"@playcta",startTrialCtaStr:"@starttrialcta",checkForUpdatesCtaStr:"@checkforupdatescta",pauseUpdateCtaStr:"@pauseupdatecta",resumeUpdateCtaStr:"@resumeupdatecta",cancelUpdateCtaStr:"@cancelupdatecta",checkForRepairGameCtaStr:"@checkforrepairgamecta",pauseRepairCtaStr:"@pauserepaircta",resumeRepairCtaStr:"@resumerepaircta",cancelRepairCtaStr:"@cancelrepaircta",installCtaStr:"@installcta",uninstallCtaStr:"@uninstallcta",openInOdtCtaStr:"@openinodtcta",updateCtaStr:"@updatecta",pauseGameCtaStr:"@pausegamecta",cancelGameCtaStr:"@cancelgamecta",resumeGameCtaStr:"@resumegamecta",addToDownloadsCtaStr:"@addtodownloadscta",downloadNowCtaStr:"@downloadnowcta",updateNowCtaStr:"@updatenowcta",repairNowCtaStr:"@repairnowcta",downloadStr:"@download",preloadStr:"@preload",cancelCloudSyncCtaStr:"@cancelcloudsynccta",repairCtaStr:"@repaircta",restoreCtaStr:"@restorecta",pauseInstallCtaStr:"@pauseinstallcta",resumeInstallCtaStr:"@resumeinstallcta",cancelInstallCtaStr:"@cancelinstallcta",showGameDetailsCtaStr:"@showgamedetailscta",addAsFavoriteCtaStr:"@addasfavoritecta",removeAsFavoriteCtaStr:"@removeasfavoritecta",updateGameCtaStr:"@updategamecta",customizeBoxArtCtaStr:"@customizeboxartcta",gamePropertiesCtaStr:"@gamepropertiescta",removeFromLibraryCtaStr:"@removefromlibrarycta",hideCtaStr:"@hidecta",viewAchievementsStr:"@viewachievements",unhideCtaStr:"@unhidecta",resubscribeCtaStr:"@resubscribecta",locategamefolderCtaStr:"@locategamefoldercta",movegamefolderCtaStr:"@movegamefoldercta",upgradegamectaStr:"@upgradegamecta",externalType:"@"},controller:Kt,link:function(e,n){var r=_.partial(t,e.offerId,e.externalType);e.$on("$destroy",function(){n.off(i,r)}),n.on(i,r)},template:aE}}function Jt(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{offerId:"@offerid",externalType:"@"},template:dE,link:function(o,a){function s(e){var n=a.find(uE);if(!e)return o.violate=!1,n.empty(),void i.digestIfDigestNotInProgress(o);o.violate=!0,o.telemetryCssClass=_.head(_.compact(e.telemetryCssClasses))||"",n.empty().append(t(e.inlineMessages)(o)),i.digestIfDigestNotInProgress(o)}Promise.all([r.isSteamPurchasedEntitlement(o.offerId),r.isSteamVaultEntitlement(o.offerId)]).then(function(t){var i=gE(t,2),r=i[0],a=i[1],c=pE;(r||a)&&(c=mE),e.getObserver(o.offerId,fE,c,void 0,o,n.unwrapPromiseAndCall(s),{externalType:o.externalType})})}}}function Xt(e,t,i,n,r){"ngInject";function o(){return new Date(e.enddate)}var a,s={trial:{getText:function(){var t=i.getCountdownData(o()),r=["days","hours","minutes"],a={},s=0;if(!t)return"";for(var c=0,l=r.length;c<l;c++)if((s=t[r[c]])>0){a["%"+r[c]+"%"]=s+1;var d=[r[c],"trial"].join("");return n.getLocalizedStr(e[d],vE,d,a,s+1)}},refreshInterval:6e4},precise:{getText:function(){var t,r=i.getCountdownData(o());return r?r.days>0?(t={"%days%":r.days},n.getLocalizedStr(e.daysleft,vE,"daysleft",t,r.days)):r.hours>0?(t={"%hours%":r.hours},n.getLocalizedStr(e.hoursleft,vE,"hoursleft",t,r.hours)):r.minutes>0?(t={"%minutes%":r.minutes},n.getLocalizedStr(e.minutesleft,vE,"minutesleft",t,r.minutes)):(t={"%seconds%":r.seconds},n.getLocalizedStr(e.secondsleft,vE,"secondsleft",t,r.seconds)):""},refreshInterval:1e3}},c=e.format&&s[e.format]?s[e.format]:s.precise;e.getText=c.getText,a=t(function(){i.isInThePast(o())&&t.cancel(a),r.digestIfDigestNotInProgress(e)},c.refreshInterval,0,!1),e.$on("$destroy",function(){t.cancel(a)})}function Zt(e,t,i){"ngInject";e.titleStr=t.trustAsHtml(i.getLocalizedStr(e.titleStr,"origin-gamelibrary-anonymous-message","title-str")),e.descriptionStr=t.trustAsHtml(i.getLocalizedStr(e.description,"origin-gamelibrary-anonymous-message","description"))}function ei(e){"ngInject";var t="";this.setOfferId=function(e){t=e},this.favoriteGame=function(){e.addFavoriteGame(t)},this.unfavoriteGame=function(){e.removeFavoriteGame(t)}}function ti(e){"ngInject";return{restrict:"A",controller:ei,link:function(t,i,n,r){function o(t){return e.getParentByClassName(t,IE)}function a(){return g||(g={target:angular.element(document.querySelector('[data-gameslist-id="'+n.draggableTarget+'"]')),current:angular.element(document.querySelector('[data-gameslist-id="'+n.id+'"]'))}),g}function s(){angular.element(document.querySelectorAll("."+kE)).removeClass(kE)}function c(e){var t,i,n,r,a=o(angular.element(e.target));u||(t=d.find("."+TE),(i=document.createElement("img")).src=t[0].getAttribute("src"),i.alt="",(u=angular.element(i)).addClass(CE),p.append(u)),n=e.pageX,r=e.pageY,u.css({left:n+OE+"px",top:r+OE+"px"}),s(),a&&a.addClass(kE),e.preventDefault()}function l(e){var t=function(e){if(!e||!e.length)return"";var t=a();return angular.equals(e[0],t.target[0])?n.draggableTarget===PE?"favorite":n.draggableTarget===_E?"unfavorite":"":""}(o(angular.element(e.target)));s(),u&&(u.remove(),u=null),"favorite"===t?r.favoriteGame():"unfavorite"===t&&r.unfavoriteGame(),p.off("mousemove",c),p.off("mouseup",l),e.preventDefault()}var d,g,u,p=angular.element(document.querySelector("body"));i.on("mousedown",function(t){var i,n=angular.element(t.target),o=(i=n,e.getParentByClassName(i,wE));o&&(t.preventDefault(),d=o,r.setOfferId(function(e){return e.find("origin-game-tile")[0].getAttribute("offerid")}(o)),p.on("mousemove",c),p.on("mouseup",l))})}}}function ii(e,t){"ngInject";return{restrict:"E",controller:"OriginGamelibraryFilterCtrl",scope:!0,link:function(i,n,r){i.filterId=r.filterId,i.model=e.getFilter(i.filterId),i.isVisible=function(){var e=Origin.client.isEmbeddedBrowser(),i=!1;switch(r.isVisible){case LE.always:i=!0;break;case LE.embedded:e&&(i=!0);break;case LE.online:i=t.isClientOnline()}return i},i.isEnabled=function(){return i.model.count>0},t.events.on("myauth:clientonlinestatechanged",i.$digest),i.$on("$destroy",function(){t.events.off("myauth:clientonlinestatechanged",i.$digest)})},template:xE}}function ni(e,t,i,n,r){"ngInject";function o(i,n){return t.getLocalizedStr(e[i],DE,i.toLowerCase(),n)}var a=i.getFilter,s=[],c={isPlayedLastWeek:o("playedThisWeekLabel"),isFavorite:o("favouritesLabel"),isDownloading:o("downloadingLabel"),isHidden:o("hiddenLabel"),isInstalled:o("installedLabel"),isNonOrigin:o("nonOriginLabel"),isSubscription:o("subscriptionLabel"),isPurchasedGame:o("purchasedGamesLabel"),isPcGame:o("pcPlatformLabel"),isMacGame:o("macPlatformLabel"),isSteamGame:o("steamPlatformLabel"),isEpicGame:o("epicPlatformLabel")};e.getLabel=function(e){return angular.isUndefined(e)?"":c.hasOwnProperty(e)?c[e]:function(e){return o("filterByLabel",{"%filterValue%":a(e).value})}(e)},e.hasActiveFilters=function(){return i.countActiveFilters()>0},e.dismiss=function(e){i.dismissFilter(e)},e.onFilterChange=function(){angular.element("html, body").animate({scrollTop:0},"fast"),e.onChange()},e.searchPlaceholder=o("filterLibraryLabel"),e.clearAllLabel=o("clearAllFiltersLabel"),e.platformLabel=o("platformLabel"),e.filterIds=Object.keys(c),e.clearAll=i.dismissAll,e.getFilter=i.getFilter,e.isActive=i.isFilterActive,e.$on("$destroy",function(){n.detachAll(s)}),s[s.length]=r.events.on("myauth:clientonlinestatechangeinitiated",function(t){t&&!t.isOnline&&e.dismiss("isHidden")})}function ri(e,t,i){"ngInject";e.viewProfile=function(){t.goUserProfile(e.friend.nucleusId)},i.create(e.friend._presence).attachToScope(e,"presence")}function oi(e,t,i,n,r,o){"ngInject";var a=[],s=o.getTileSizeObserver();s.getProperty("tileSize").attachToScope(e,"gridSize"),e.$on("$destroy",function(){s.detach()}),e.open=!0,e.getFilteredGames=function(){return t("filter")(e.games,e.filterBy())},e.isEmpty=function(){var t=e.getFilteredGames();if(t)return 0===t.length},e.isAlone=function(){var t=e.getFilteredGames();if(t)return t.length===e.games.length},e.isGamePlayableOrInstallable=function(e){return i.isPlayable(e.offerId,e.externalType)||i.isInstallable(e.offerId,e.externalType)},e.triggerValue=function(){return e.open?"-":"+"},a=[n.events.on(UE,function(){e.filteredGames=e.getFilteredGames(),e.$digest()})],e.$on("$destroy",function(){e.isGamePlayableOrInstallable=null,e.isOffline=null,r.detachAll(a)})}function ai(e){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",games:"=",id:"@",filterBy:"&"},link:function(t,i){var n=i.find(NE),r=n.find(".l-origin-gameslist-list");t.toggle=function(){n.css("height",n.css("height")),n[0].offsetHeight,t.open?(n.css("height","0px"),i.find(NE).addClass(GE)):(n.css("height",r[0].offsetHeight+"px"),e.onTransitionEnd(n,function(){n.css("height","auto"),i.find(NE).removeClass(GE)})),t.open=!t.open},t.$watchCollection("games",function(e){e&&(t.filteredGames=t.getFilteredGames())})},controller:oi,template:$E}}function si(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k){"ngInject";function I(){e.allGames=t("orderBy")(e.allGames,["displayName","offerId"],!1)}function w(t){return e.allGames=t,t}function C(){e.activeFiltersCount=g.countActiveFilters(),e.displayedGames=g.applyFilters(e.allGames),e.setPageDimensions(),p.events.fire("OriginGamelibraryLoggedin:filterApplied"),e.$digest()}function T(){return _.forEach(e.allGames,g.updateGameModelExtraProperties)}function P(){var e=r.baseGameEntitlements({includeAllExternalTypes:!0});return Promise.all([e,o.getCatalogInfo(e.map(function(e){return e.offerId})),v.getAllLastPlayedTimes()])}function O(e,t,i){var n=Object.values(t).map(g.createGameModel);_.isArray(i)&&_.forEach(n,function(e){e.lastPlayedTime=0;for(var t=0,n=i.length;t<n;t++)if(i[t]&&i[t].masterTitleId===e.masterTitleId){e.lastPlayedTime=new Date(i[t].timestamp).getTime();break}});var r=S.hasClientDualEntitlementFix();return Object.values(e.reduce(function(e,t){var i=Object.assign({},t,n.find(function(e){return t.offerId===e.offerId}));return i.tileId=r?i.offerId+"-"+i.externalType:i.offerId,e[i.tileId]&&!k.isOriginEntitlementSourceFromExternalType(i.externalType)||(e[i.tileId]=i),e},{}))}function E(e){return Promise.resolve(e).then(T).then(g.hideLesserEditions).then(g.calculateCounts).then(C).then(m.unblockUIPromise).catch(function(e){m.unblockUI(),c.error("[origin-gamelibrary-loggedin GamesDataFactory.onUpdate] error",e)})}function F(){return R().then(E)}function x(){D=n(R(h.refresh(!0)).then(E),HE,!1)}function L(){e.isOnline=u.isClientOnline(),e.isBanned=Origin.user.userStatus()===Origin.defines.userStatus.BANNED}var A=[],D=null,R=h.decorate(function(){return m.blockUI(),r.waitForGamesDataReady().then(P).then(_.spread(O)).then(w).then(r.waitForFiltersReady()).then(I)});e.allGames={},e.hasGames=function(){return void 0===e.allGames||e.allGames.length>0},e.applyFilters=F,f.getObserver().attachToScope(e,"states"),f.setEmbeddedFilterpanel(!1),f.registerFilterPanelToggleBtn(),e.toggleFilterpanel=function(){f.toggleEmbeddedFilterpanel()},e.localizedStrings={addGameLabel:s.getLocalizedStr(e.addgamelabel,jE,"addgamelabel"),fromOriginAccess:s.getLocalizedStr(e.fromoriginaccess,jE,"fromoriginaccess"),redeemProductCode:s.getLocalizedStr(e.redeemproductcode,jE,"redeemproductcode"),nonOriginShortcut:s.getLocalizedStr(e.nonoriginshortcut,jE,"nonoriginshortcut"),filterLabel:s.getLocalizedStr(e.filterlabel,jE,"filterlabel"),favouritesLabel:s.getLocalizedStr(e.favouriteslabel,jE,"favouriteslabel"),allOthersLabel:s.getLocalizedStr(e.allotherslabel,jE,"allotherslabel"),nogamesTitleLabel:s.getLocalizedStr(e.nogamestitle,jE,"nogamestitle"),nogamesDescriptionLabel:s.getLocalizedStr(e.nogamesdescriptionlabel,jE,"nogamesdescription")},i.searchString&&i.searchString.length>0?(g.getFilter("isHidden").value?(g.dismissAll(),g.setFilterValue("isHidden",!0)):g.dismissAll(),g.getFilter("displayName").value=decodeURI(i.searchString)):g.getFilter("displayName").value="",i.startThirdPartyAssociation&&i.offerid&&y.startFlow(i.offerid).catch(y.handleError),e.activeFiltersCount=g.countActiveFilters(),A=[u.events.on("myauth:clientonlinestatechanged",function(){L(),e.$digest()}),r.events.on("filterChanged",F,this),r.events.on("games:baseGameEntitlementsUpdate",x,this),a.events.on("GamesNonOriginFactory:nogsRefreshed",x,this),p.events.on("originDownloadManagerGame:installerStatusChanged",x)],c.log("GameLibrary: checking initialRefreshCompleted"),r.initialRefreshCompleted()&&x(),L(),e.$on("$destroy",function(){n.cancel(D),l.detachAll(A),f.setEmbeddedFilterpanel(!1),f.setFilterOverlay(!1),f.unregisterFilterPanelToggleBtn(),b.destroy()}),e.$on("gamelibrary:updatefilter",F)}function ci(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",scope:{addgamelabel:"@",fromoriginaccess:"@",redeemproductcode:"@",nonoriginshortcut:"@",filterlabel:"@",favouriteslabel:"@",allotherslabel:"@",nogamestitle:"@",nogamesdescription:"@"},link:function(e,t){function r(){e.isAddGamesMenuVisible=!1,angular.element(document).off("keyup",r).off("mouseup",r),e.$digest()}e.setPageDimensions=function(){var i,n;i=angular.element(t).find(".l-origin-gamelibrary"),n=i.find(".origin-filter-list").eq(0).offset(),i.toggleClass("l-origin-gamelibrary-loggedin-nogames",!(n&&n.top&&e.hasGames()))},e.onAddGames=function(){e.isAddGamesMenuVisible=!e.isAddGamesMenuVisible,e.isAddGamesMenuVisible?angular.element(document).on("keyup",r).on("mouseup",r):r()},e.onRedeemProductCode=function(){Origin.telemetry.sendMarketingEvent("Game Library","Add Game","Redeem Product Code"),a.redeemCode().catch(s.showDialog),e.isAddGamesMenuVisible=!1},e.onAddNonOriginShortcut=function(){Origin.telemetry.sendMarketingEvent("Game Library","Add Game","Non-Origin Shortcut"),Origin.client.games.addNonOriginGame(),e.isAddGamesMenuVisible=!1},e.isAddGamesMenuVisible=!1,e.isSubscriptionActive=n.isActive(),e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),i.addResizeEventHandler(e,e.setPageDimensions,300)},controller:si,template:ME}}function li(e,t,i,n,r,o,a,s,c){"ngInject";function l(){var t=_.map(e.navItems,"friendlyname").indexOf(e.topic);e.tabIndex=t+1>0?t:0}var d,g,u=angular.element("body"),p=Origin.client.isEmbeddedBrowser();e.offlineLoc=r.getLocalizedStr(e.offlineStr,QE,"offlinestr"),e.isNog=o.isNonOriginGame(e.offerId),e.topic=a.params.topic,e.isOtkModalOpen=!1,e.onTabChange=function(t){var i=_.find(e.navItems,{anchorName:t.anchorName});i&&n.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd.topic",{offerid:e.offerId,topic:i.friendlyname})};var m=[n.events.on("uiRouter:stateChangeStart",function(t,i,n){n.topic&&(e.topic=n.topic,l())}),n.events.on("dialog:show",function(){p&&(e.isOtkModalOpen=!0,u.addClass(JE),c.digestIfDigestNotInProgress(e))}),n.events.on("dialog:hide",function(){p&&(e.isOtkModalOpen=!1,u.removeClass(JE),c.digestIfDigestNotInProgress(e))})],f=e.$on("ogd:tabsready",function(t,i){t.stopPropagation(),e.navItems=i,l(),f(),e.$digest()});e.$on("$destroy",function(){s.detachAll(m),u.css("marginRight",""),u.css("overflow","auto"),u=null,t.cancel(d),t.cancel(g)}),d=t(function(){var e;e=u.innerWidth(),u.css("overflow","hidden"),u.css("marginRight",(u.css("marginRight")?"+=":"")+(u.innerWidth()-e)),i.find(".origin-ogd-content").addClass("origin-ogd-content-to-front origin-ogd-content-expanded")},XE,!1),g=t(function(){i.find(".origin-ogd-overlay").addClass("origin-ogd-overlay-to-front origin-ogd-overlay-activated")},ZE,!1)}function di(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function gi(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(e){return e["origin-gamelibrary-ogd-content-panel"].friendlyname}function u(e,i){var r;!function(e){e&&e.achievements&&!f&&t.nav.splice(1,0,{"origin-gamelibrary-ogd-content-panel":{anchorName:t.strings.achievements,title:t.strings.achievements,friendlyname:oF,items:[{"origin-achievement-details":{achievementsetid:b,nucleusid:Origin.user.userPid(),isogd:!0}}]}})}(e),i.length&&_.forEach(i,function(e){var i,n=e.displayName,r=e.groupName,o=(i=n)===iF?t.strings.expansions:i,a=_.kebabCase(r);t.nav.push({"origin-gamelibrary-ogd-content-panel":{anchorName:o,title:o,friendlyname:a,items:[{"origin-gamelibrary-ogd-expansions":{offerid:t.offerId,groupname:r,"external-type":t.externalType}}]}})}),t.validateRoute(t.topic,t.offerId),t.$emit(uF,(r=t.nav,_.map(r,function(e){return e["origin-gamelibrary-ogd-content-panel"]}))),v=n(t.updateDom,dF,!1),t.$digest()}var p=s.getLocalizedStrGenerator(mF),m=Origin.user.personaId(),f=Origin.user.underAge(),h=null,v=void 0,b=void 0;t.strings={friendsWhoPlay:p(t.friendsWhoPlayStr,"friends-who-play-str"),expansions:p(t.expansionsStr,"expansions-str"),achievements:p(t.achievementsStr,"achievements-str")},t.nav=[],f||t.nav.push({"origin-gamelibrary-ogd-content-panel":{anchorName:t.strings.friendsWhoPlay,title:t.strings.friendsWhoPlay,friendlyname:aF,items:[{"origin-gamelibrary-ogd-friendswhoplay":{offerid:t.offerId}}]}}),t.validateRoute=function(e,i){var n=t.nav.map(g);n.length>0&&-1===n.indexOf(e)&&r.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd.topic",{offerid:i,topic:n[0]})},h=r.events.on("uiRouter:stateChangeStart",function(e,i,n){n.topic&&(t.topic=n.topic)}),t.$on("$destroy",function(){h&&h.detach(),n.cancel(v)}),Promise.all([i.getCatalogInfo([t.offerId]),o.getEntitlement(t.offerId),d.getAllExtraContentGroups(t.offerId)]).then(function(e){return function(e,t,i){b=_.head(l.determineOwnedAchievementSets(e));var n=Promise.resolve([]);return b&&!c.isPreorder(t)&&(n=l.getAchievementSet(m,b)),Promise.all([n,i])}.apply(void 0,di(e))}).then(function(e){return u.apply(void 0,di(e))}).catch(function(e){a.error("[Origin-Gamelibrary-Ogd-Content-Directive Ctrl] error",e)})}function ui(e,t){"ngInject";return{restrict:"E",scope:{offerId:"@offerid",topic:"@topic",tabhorizontalrulecolor:"@tabhorizontalrulecolor",tabactiveselectioncolor:"@tabactiveselectioncolor",tabactivetextcolor:"@tabactivetextcolor",tabtextcolor:"@tabtextcolor",friendsWhoPlayStr:"@",achievementsStr:"@",expansionsStr:"@",externalType:"@"},template:pF,link:function(i,n){i.updateDom=function(){!function(r){var o=n.find(".origin-ogd-expansions .content");if(r&&r.length>0)for(var a=0;a<r.length;a++){var s=r[a]["origin-gamelibrary-ogd-content-panel"],c=r[a];s["ng-if"]=["topic === '",s.friendlyname,"'"].join("");var l=t.slingDataToDom(c);l.removeAttribute("title"),o.append(e(l)(i))}o=null}(i.nav),i.$digest()}},controller:gi}}function pi(e,t,i,n,r){"ngInject";e.saveLoc=t.getLocalizedStr(e.savestr,vF,"savestr"),e.originAccessDiscountAppliedLoc=t.getLocalizedStr(e.originAccessDiscountAppliedStr,vF,"originaccessdiscountappliedstr"),e.isSubscriber=i.userHasSubscription(),e.isFree=function(e){return r.isFree(e)},n.getByOfferId(e.offerId).attachToScope(e,"model")}function mi(e,t,i,n,r){"ngInject";function o(t,i){t=_.filter(t,function(e){return null===e.loyaltyPromotion||e.gameEditionType.toLowerCase().indexOf("loyalty")<0||e.gameEditionTypeFacetKey.toLowerCase().indexOf("loyalty")<0||e.offerPath.toLowerCase().indexOf("loyalty")<0});var n=r.groupExtraContentInsideTab(e.offerId,function(t){return _.filter(t,function(t){return(_.isEmpty(e.whitelist)||_.includes(e.whitelist,t.offerId))&&(_.isEmpty(e.blacklist)||!_.includes(e.blacklist,t.offerId))})}(t),d);e.expansionGroups=_.map(n,function(e){return e.displayName=function(e){switch(e){case nF:return s;case tF:return c;case rF:return l;default:return e}}(e.displayName),e}),e.showDebugInfo=!!i}function a(e){if(e.offerId){var t=i.getEntitlement(e.offerId,{includeAllExternalTypes:!1});t&&(e.externalType=t.externalType)}return e}e.noExpansionsTitleLoc=t.getLocalizedStr(e.noExpansionsTitleStr,yF,"noexpansionstitlestr"),e.noExpansionsDescLoc=t.getLocalizedStr(e.noExpansionsDescStr,yF,"noexpansionsdescstr");var s=t.getLocalizedStr(e.expansionStr,yF,"expansionstr"),c=t.getLocalizedStr(e.addonStr,yF,"addonstr"),l=t.getLocalizedStr(e.currencyStr,yF,"currencystr");e.loading=!0,e.expansionGroups=[];var d="addonstore"===e.context;Promise.all([d?n.retrieveExtraContentCatalogInfo(e.offerId).then(_.values).then(function(e){return e.map(a)}).catch(function(){return[]}):r.findExtraContentGroup(e.offerId,e.groupName).then(function(e){return e?e.items.map(a):[]}).catch(function(){return[]}),Origin.client.info.hasEACoreIni()]).then(function(e){return o.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(e))}).then(function(){e.loading=!1,e.$digest()})}function fi(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k){"ngInject";function I(){return!s.isFree(e.model)&&(d.isSubscriberAndVaultGame(e.model)||e.model.isGameUpgradeable)}function w(t){e.primaryAction=t}function C(t){if(!_.isUndefined(t)&&!_.isUndefined(t[e.offerId])){var i=n.getEntitlement(e.offerId);!function(){var t=n.getEntitlement(e.offerId);e.isPrivateOffer=h.isPrivate(t)}();var r=S.getGame(e.offerId,e.externalType);return y.isUpgradeableVaultExpansion(e.offerId).then(function(n){e.model=t[e.offerId],e.model.isGameUpgradeable=n,e.model.isDownloadable=!!r&&!r.isWrongArchitecture&&e.model.downloadable,e.isPreOrderFailed=b.isFailedPreorder(Origin.utils.os())(e.model,i),e.showDirectAcquistionCTA=!e.model.isOwned&&(s.isFree(e.model)||n),e.showPurchaseCTA=!(e.model.isOwned||e.model.vaultEntitlement||s.isFree(e.model)||n||d.isSubscriberAndVaultGame(e.model)),e.isStoreExclusive=k.isFictionalCurrencyExclusiveByOffer(e.model),e.isDetailsButtonVisible=(e.model.isOwned||d.isSubscriberAndVaultGame(e.model)&&!n)&&!e.showOriginCtaDownloadinstallplay(),e.isEntitledThroughSteam=b.isPurchasedThroughThirdPartyProvider(i,kF.e.steam);var o=e.model.isInstalled?"steamownedinstalled":"steamownednotinstalled";e.steamViolatorStr=a.getLocalizedStr(e[o],IF,o)})}}function T(e){return!!e&&e.length>0&&e!==i.defaultBoxArtUrl()}function P(){e.expansionPackArt=_.filter([e.model.i18n.packArtLarge,e.model.i18n.packArtMedium,e.model.i18n.packArtSmall],T)[0],e.usingSmallPackArt=e.expansionPackArt===e.model.i18n.packArtSmall}function O(){var t=_.get(n.getEntitlement(e.offerId),"originPermissions")||"0",i=wF[t]||"";e.debugInfo=i+e.offerId}function E(){return r.getPdpUrlIfOneExists(e.model).then(function(t){e.pdpUrl=t,e.hasPDP=null!==t})}function F(){Promise.all([c.primaryAction(e.offerId,!1).then(w),i.getCatalogInfo([e.offerId]).then(o.transformOffer).then(C).then(E).then(P).then(O)]).then(function(){e.showDescription=e.showLongDescription(),e.modelLoaded=!0,e.$digest(),e.checkReadMoreLinkVisibility()})}e.isNoCommerceContext=v.isNoCommerceContext(),e.releaseDateLoc=a.getLocalizedStr(e.releasedatestr,IF,"releasedatestr"),e.freeLoc=a.getLocalizedStr(e.freestr,IF,"freestr"),e.unlockedLoc=a.getLocalizedStr(e.unlockedstr,IF,"unlockedstr"),e.installedLoc=a.getLocalizedStr(e.installedstr,IF,"installedstr"),e.upgradeLoc=a.getLocalizedStr(e.upgradestr,IF,"upgradestr"),e.readMoreLoc=a.getLocalizedStr(e.readmorestr,IF,"readmorestr"),e.onWishlistLoc=a.getLocalizedStr(e.onWishlistStr,IF,"on-wishlist"),e.viewWishlistLoc=a.getLocalizedStr(e.viewWishlistStr,IF,"view-wishlist"),e.details=a.getLocalizedStr(e.detailsstr,IF,"detailsstr"),e.pricingErrorMessage=a.getLocalizedStr(void 0,IF,"pricing-error-message"),e.preOrderFailedStr=a.getLocalizedStr(void 0,IF,"preorderfailed"),e.showReadMoreLink=!0,e.isInTheFuture=l.isInTheFuture,e.usingSmallPackArt=!1,e.modelLoaded=!1,e.model={},e.isPrivateOffer=!1;var x;e.isDownloadable=function(t){return t.isDownloadable&&s.isDownloadable(t)||e.isPrivateOffer},e.isPurchaseAction=function(){return(!e.model.isOwned||e.model.vaultEntitlement)&&!s.isFree(e.model)},e.isReleased=function(e){return l.isInThePast(e.releaseDate)},e.isGiftable=function(e){return p.isGameGiftable(e)},e.isOwnedSubscriptionOffer=function(){return!s.isFree(e.model)&&d.isSubscriberAndVaultGame(e.model)&&!e.model.isGameUpgradeable},e.isVaultEntitlement=function(){return I()},e.freeCtaLoc=function(){return I()?e.upgradeLoc:e.freeLoc},e.showLongDescriptionDialog=function(){t.openAlert({id:"origin-ogd-expansion-tile-show-long-description",title:e.model.displayName,description:e.model.longDescription,rejectText:a.getLocalizedStr(e.closestr,IF,"closestr")})},e.showLongDescription=function(){return!(!e.model.longDescription||e.model.mediumDescription)&&e.model.longDescription.length&&e.model.longDescription!==e.model.shortDescription},e.showOriginCtaDownloadinstallplay=function(){var t=e.isDownloadable(e.model);return e.model.isOwned&&!e.isEntitledThroughSteam&&(!e.model.isInstalled&&t||e.primaryAction.launchable)&&(e.primaryAction.label!==m.PLAY_CTA||e.primaryAction.launchable)&&(e.primaryAction.label!==m.PRIMARY_DOWNLOAD_CTA||t)&&(e.primaryAction.label!==m.PLAY_ON_ORIGIN_CTA&&e.primaryAction.label!==m.GET_IT_WITH_ORIGIN_CTA||e.isReleased(e.model))},e.formatDate=function(e){return g(e).format("LL")},F(),x=[n.events.on("games:update:"+e.offerId,F)],f.addResizeEventHandler(e,e.checkReadMoreLinkVisibility,150),e.$on("$destroy",function(){u.detachAll(x)})}function hi(e,t,i,n,r,o,a,s){"ngInject";function c(t){e.loading=!1,e.friendsWhoPlay=t,e.$digest()}function l(e){c([]),s.error("[OriginGamelibraryOgdFriendswhoplayCtrl:handleError]",e)}var d="origin-gamelibrary-ogd-friendswhoplay",g=r.mapWith,u=t.getRosterUser,p=r.fetchPromises,m=a.create(n.getUsersWhoOwnObservable(e.offerId,e));e.friendsWhoPlayTitleLoc=i.getLocalizedStr(e.friendswhoplaystr,d,"friendswhoplaystr"),e.friendsPlayingTitleLoc=i.getLocalizedStr(e.friendsplayingstr,d,"friendsplayingstr"),e.showMoreLoc=i.getLocalizedStr(e.showmorestr,d,"showmorestr"),e.showLessLoc=i.getLocalizedStr(e.showlessstr,d,"showlessstr"),e.noFriendsCtaTitleLoc=i.getLocalizedStr(e.nofriendsctatitlestr,d,"nofriendsctatitlestr"),e.noFriendsCtaDescLoc=i.getLocalizedStr(e.nofriendsctadescstr,d,"nofriendsctadescstr"),e.noFriendsCtaButtonLoc=i.getLocalizedStr(e.nofriendsctabuttonstr,d,"nofriendsctabuttonstr"),e.friendsWhoPlay=[],e.friendsPlayingLimit=e.friendsWhoPlayLimit=e.SHOW_FRIENDS_LIMIT=9,e.loading=!0,e.findFriends=function(){o.findFriends()},m.onUpdate(e,function(e){p(g(u)(e.users)).then(c).catch(l)}),t.getFriendsPlayingObservable(e.offerId).then(function(t){a.create(t).getProperty("friends").attachToScope(e,"friendsPlaying")})}function vi(e,t,i,n,r,o,a,s,c){"ngInject";return{restrict:"E",replace:!0,scope:{offerId:"@offerid",viewmoremessagescta:"@",closemessagescta:"@",gamemessages:"@",nonorigingame:"@",warningforexpiringgame:"@",externalType:"@"},template:PF,link:function(l,d){function g(e){if(e){var t=d.find(OF);t.empty(),_.forEach(e.inlineMessages,function(e){t.append(r(e)(l))}),e.readmore&&(l.readmore=e.readmore,t.append(r(e.readmoreText)(l))),a.digestIfDigestNotInProgress(l)}}var u,p={gamemessages:_.partial(o.getLocalizedStr,l.gamemessages,_F,"gamemessages",_),viewmoremessagesctaCallback:_.partial(o.getLocalizedStr,l.viewmoremessagescta,_F,"viewmoremessagescta",_,_),closemessagescta:o.getLocalizedStr(l.closemessagescta,_F,"closemessagescta")};l.nonorigingameLoc=o.getLocalizedStr(l.nonorigingame,_F,"nonorigingame"),l.closeOgd=function(){i.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library")};var m=_.debounce(function(e){e&&(d.find(EF).append(r(o.buildTag("origin-background-video",{"video-id":e}))(l)),a.digestIfDigestNotInProgress(l))},DF),f=_.debounce(function(){t.getObserver(l.offerId,xF,FF,p,l,o.unwrapPromiseAndCall(g),{externalType:l.externalType})},AF);l.$on("$destroy",function(){m.cancel(),f.cancel(),u&&u.detach()}),l.$watchOnce([LF,"backgroundVideoId"].join("."),m),l.$watchOnce([LF,"entitlementSubscriptionId"].join("."),function(e){e&&s.getSubscriptionById(e).then(function(e){l.subscriptionOfferTier=_.get(e,[yI.z,yI.B],"").toLowerCase()}).then(function(){return a.digestIfDigestNotInProgress(l)}).catch(function(e){return c.error("[origin-gamelibrary-ogd-header] Failed to get subscription state for OA badge",e)})}),l.$watchOnce([LF,"isExpiringGame"].join("."),function(e){e&&(l.warningforexpiringgame=o.getLocalizedStr(l.warningforexpiringgame,_F,"warningforexpiringgame",{"%displayName%":l[LF].displayName,"%expiringDate%":moment(l[LF].useEndDate).format("LL"),"%expiringDays%":l[LF].expiringDays}))}),e.getObserver(l.offerId,_F,l,LF),f(),l.isOffline=function(){return!n.isClientOnline()},u=n.events.on("myauth:clientonlinestatechanged",function(){l.$digest()})}}}function bi(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(){a.close(jF)}function m(){return!(Origin.client.isEmbeddedBrowser()&&!o.isClientOnline()&&(p(),a.openAlert({id:"origin-violator-offline-action-not-allowed",title:i.getLocalizedStr(e.offlinemodaltitle,MF,"offlinemodaltitle"),description:i.getLocalizedStr(e.offlinemodaldescription,MF,"offlinemodaldescription"),rejectText:i.getLocalizedStr(e.offlinemodaldismissbutton,MF,"offlinemodaldismissbutton")}),1))}function f(){t.is(bI.v)&&t.go(bI.w)}function h(e){return function(t){return p(),window.requestAnimationFrame(e),function(e){return e.stopPropagation(),!1}(t)}}e.removeVaultGame=h(function(){m()&&r.vaultRemove(e.offerid).then(f).catch(f)}),e.hideGame=h(function(){m()&&r.hideGame(e.offerid)}),e.renewSubscription=h(function(){m()&&n.renewSubscription()}),e.goToPdp=h(function(){m()&&r.buyNow(e.offerid)}),e.goOnline=h(function(){Origin.client.onlineStatus.goOnline()}),e.upgradeVaultGame=h(function(){m()&&n.entitleVaultGameFromLesserBaseGame(e.offerid).then(f).catch(f)}),e.dismiss=h(function(){s.dismiss(e.offerid,e.priority,e.title,e.enddate,e.startdate,e.label)}),e.linkThirdPartyAccount=h(function(){c.startFlow(e.offerid).catch(c.handleError)}),e.preloadNow=h(function(){m()&&Origin.client.games.startDownload(e.offerid)}),e.openSteamGameDetailsPage=h(function(){r.getSteamAppId(e.offerid).then(function(e){u.openSteamGameDetailsPage(e)})}),e.openSteamSubscriptionPage=h(u.openSteamSubscriptionPage),e.openEARefundPage=h(function(){u.asyncOpenUrlWithEADPSSO("https://help.ea.com/"+Origin.locale.languageCode()+"/refund/")}),e.showPreloadLink=!1,l.isUpgradeableVaultGameEarlyAccess(e.offerid).then(function(t){var i=g.getGame(e.offerid,e.externalType),n=t&&d.isGameClientDownloadable(i);e.showPreloadLink!==n&&(e.showPreloadLink=n,e.$digest())}).catch(_.noop),e.getIconClass=function(){return e.icon&&GF[e.icon]&&e.iconcolor&&UF[e.iconcolor]?"otkicon-"+e.icon+" "+e.iconcolor:e.icon&&GF[e.icon]?"otkicon-"+e.icon:""},e.hasIcon=function(){return!(!e.icon||!GF[e.icon])},e.isDismissed=function(){return s.isDismissed(e.offerid,e.priority,e.title,e.enddate,e.startdate,e.label)},e.isDismissible=function(){return String(e.dismissible).toLowerCase()===BF.true},e.isWithinViewableDateRange=function(){return s.isWithinViewableDateRange(e)}}function yi(e,t,i,n){"ngInject";return{restrict:"E",scope:{title:"@titleStr",icon:"@",iconcolor:"@",dismissible:"@",startdate:"@",enddate:"@",livecountdown:"@",offerid:"@",label:"@",priority:"@",timeremaining:"@",timerformat:"@",offlinemodaltitle:"@",offlinemodaldescription:"@",offlinemodaldismissbutton:"@",telemetryCssClass:"@",externalType:"@"},template:$F,controller:bi,link:function(r,o){var a=void 0,s=void 0;r.title&&t.appendTitle(r,o,MF,".origin-ogd-message-title-content"),r.enddate&&(s=new Date(r.enddate),a=e(function(){i.isInThePast(s)&&(e.cancel(a),n.enddateReached(r.offerid))},HF,0,!1)),r.$on("$destroy",function(){e.cancel(a)})}}}function Si(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{title:"@titleStr",icon:"@",iconcolor:"@",dismissible:"@",startdate:"@",enddate:"@",livecountdown:"@",offerid:"@",label:"@",priority:"@",timeremaining:"@",timerformat:"@",offlinemodaltitle:"@",offlinemodaldescription:"@",offlinemodaldismissbutton:"@",useSubscriptionTemplate:"=",useThirdPartyTemplate:"=",thirdPartyTemplateType:"@",thirdPartyViolator:"=",externalType:"@"},template:NF,controller:bi,link:function(a,s){function c(){t.appendTitle(a,s,MF,".origin-game-violator-text")}function l(){i.isInThePast(g)&&(e.cancel(d),n.enddateReached(a.offerid))}var d=void 0,g=void 0;a.useSubscriptionTemplate?(a.logoVariant=qS.Condensed,a.subscriptionLevel=r.getCurrentSubscriptionLevel()):a.useThirdPartyTemplate&&(a.thirdPartyImageUrl=o.getImagePath("thirdparty/"+a.thirdPartyTemplateType+".png")),a.title&&setTimeout(c,0),a.enddate&&(g=new Date(a.enddate),d=e(l,HF,0,!1)),a.$on("$destroy",function(){e.cancel(d)})}}}function ki(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ii(e,t,i,n,r){"ngInject";function o(i){var n=Math.ceil(e.timeremaining/60/60);return t.getLocalizedStr(e[i],h,i,{"%hours%":n})}function a(n,r){return t.getLocalizedStr(e[r],h,r,{"%date%":i.formatDateWithTimezone(n)})}function s(n,r){var o=i.getCountdownData(n);return o?t.getLocalizedStr(e[r],h,r,{"%days%":o.days},o.days):""}function c(i){return _.has(b[i],"passTitle")&&"true"===b[i].passTitle?e.enddate:b[i].titleCallback?b[i].titleCallback.call(this,new Date(e.enddate),i):b[i].timeRemainingCallback?b[i].timeRemainingCallback.call(this,i):function(i){var r=t.getLocalizedStr(void 0,h,"oa"+n.getActiveSubscriptionLevel());return t.getLocalizedStr(e[i],h,i,{"%subscriptiontier%":r,"%url-language%":Origin.locale.languageCode()})}(i)}var l,d,g,u,p,m,f,h="origin-gamelibrary-ogd-violator",v="steam",b=void 0;b={preorderfailed:{dismissible:"false",icon:"warning",iconcolor:"red"},preorderfailedogd:{dismissible:"false",icon:"warning",iconcolor:"red"},preloadon:{dismissible:"false",icon:"download",titleCallback:a},preloadonwin:{dismissible:"false",icon:"download",titleCallback:a},preloadonmac:{dismissible:"false",icon:"download",titleCallback:a},preloadavailable:{dismissible:"false",icon:"download"},justreleased:{dismissible:"true",icon:"newrelease"},platformwin:{dismissible:"false",icon:"windows"},platformmac:{dismissible:"false",icon:"apple"},platformwinmac:{dismissible:"false",icon:"info"},wrongarchitecture64:{dismissible:"false",icon:"64bit"},wrongarchitecture32:{dismissible:"false",icon:"warning"},releasesonwin:{dismissible:"false",icon:"info",titleCallback:a},releasesonmac:{dismissible:"false",icon:"info",titleCallback:a},releaseson:{dismissible:"false",icon:"info",titleCallback:a},releasesonpremier:{dismissible:"false",icon:"info",titleCallback:a},needsrepair:{dismissible:"false",icon:"warning",iconcolor:"yellow"},updateavailable:{dismissible:"false",icon:"download"},gameexpires:{dismissible:"false",icon:"timer",titleCallback:a},legacytrialnotactivatedquicklaunch:{dismissible:"false",icon:"info",timeRemainingCallback:o,livecountdown:"limited"},legacytrialnotexpiredquicklaunch:{dismissible:"false",icon:"timer",titleCallback:a,livecountdown:"fixed-date"},legacytrialexpiredquicklaunch:{dismissible:"false",icon:"timer"},legacytrialnotactivated:{dismissible:"false",icon:"info",timeRemainingCallback:o,livecountdown:"limited"},legacytrialnotexpired:{dismissible:"false",icon:"timer",titleCallback:a,livecountdown:"fixed-date"},legacytrialexpired:{dismissible:"false",icon:"timer"},steamtrialnotactivated:(l={dismissible:"false",icon:"info",timeRemainingCallback:o},ki(l,"logotype",v),ki(l,"usethirdpartytemplate",!0),ki(l,"thirdpartyviolator",!0),l),steamtrialnotexpiredgametile:(d={dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},ki(d,"usethirdpartytemplate",!0),ki(d,"thirdpartyviolator",!0),d),steamtrialexpiredgametile:(g={dismissible:"false",icon:"warning",iconcolor:"red"},ki(g,"usethirdpartytemplate",!0),ki(g,"thirdpartyviolator",!0),g),steamtrialnotexpired:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},steamtrialnotexpiredreleased:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},steamtrialexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},steamtrialexpiredhidden:{dismissible:"false",icon:"warning",iconcolor:"red"},steamtrialexpiredreleased:{dismissible:"false",icon:"warning",iconcolor:"red"},steamtrialexpiredhiddenreleased:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialnotactivatedquicklaunch:{dismissible:"false",icon:"info",timeRemainingCallback:o},oatrialnotactivated:{dismissible:"false",icon:"info",timeRemainingCallback:o},oatrialnotexpiredquicklaunch:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},oatrialnotexpiredgametile:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},oatrialnotexpired:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},oatrialnotexpiredreleased:{dismissible:"false",icon:"timer",livecountdown:"days-hours-minutes"},oatrialexpiredquicklaunch:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialexpiredhidden:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialexpiredreleased:{dismissible:"false",icon:"warning",iconcolor:"red"},oatrialexpiredhiddenreleased:{dismissible:"false",icon:"warning",iconcolor:"red"},oaexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},oaexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},downloadoverride:{dismissible:"false",icon:"info",iconcolor:"red"},newdlcavailable:{dismissible:"true",icon:"dlc"},newexpansionavailable:{dismissible:"true",icon:"dlc"},newdlcreadyforinstall:{dismissible:"true",icon:"download"},newdlcexpansionreadyforinstall:{dismissible:"true",icon:"download"},newdlcinstalled:{dismissible:"true",icon:"newrelease"},expired:{dismissible:"false",icon:"warning",iconcolor:"red"},expireson:{dismissible:"false",icon:"timer",titleCallback:a},offlineplayexpiringgametile:{dismissible:"false",icon:"warning",iconcolor:"yellow",titleCallback:s,livecountdown:"fixed-date"},offlineplayexpiring:{dismissible:"false",icon:"warning",iconcolor:"yellow",titleCallback:s,livecountdown:"fixed-date"},epicgamepurchase:(u={dismissible:"false"},ki(u,"logotype","epic"),ki(u,"usethirdpartytemplate",!0),u),steamgamepurchase:(p={dismissible:"false"},ki(p,"logotype",v),ki(p,"usethirdpartytemplate",!0),p),steamgamevault:(m={dismissible:"false"},ki(m,"logotype",v),ki(m,"usethirdpartytemplate",!0),m),steamsubscriptionlapsedgametile:(f={dismissible:"false"},ki(f,"logotype",v),ki(f,"usethirdpartytemplate",!0),ki(f,"thirdpartyviolator",!0),ki(f,"icon","warning"),ki(f,"iconcolor","red"),f),steamsubscriptionlapsed:{dismissible:"false",icon:"warning",iconcolor:"red"},offlineplayexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},offlineplayexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},offlinemodegametile:{dismissible:"false",icon:"warning",iconcolor:"yellow"},offlinemode:{dismissible:"false",icon:"warning",iconcolor:"yellow"},preannouncementdisplaydate:{dismissible:"false",icon:"info",passTitle:"true"},preloaded:{dismissible:"false",icon:"info"},oagameexpiringgametile:ki({dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},"usesubscriptiontemplate",!0),oagameexpiring:{dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},oapremiergameexpiringgametile:ki({dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},"usesubscriptiontemplate",!0),oapremiergameexpiring:{dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},oabasicgameexpiringgametile:ki({dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},"usesubscriptiontemplate",!0),oabasicgameexpiring:{dismissible:"false",icon:"warning",iconcolor:"yellow",livecountdown:"days-hours-minutes"},oagameexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},oagameexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},oapremiergameexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},oapremiergameexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},oabasicgameexpiredgametile:{dismissible:"false",icon:"warning",iconcolor:"red"},oabasicgameexpired:{dismissible:"false",icon:"warning",iconcolor:"red"},oaplatformwin:{dismissible:"false",icon:"windows"},oagameupgradenoticegametile:ki({dismissible:"false",icon:"download",iconcolor:"white"},"usesubscriptiontemplate",!0),oagameupgradenotice:{dismissible:"false",icon:"download",iconcolor:"white"},thirdpartyassociationrequired:{dismissible:"false",icon:"warning",iconcolor:"red"},oaearlyaccessnoticegametile:ki({dismissible:"false"},"usesubscriptiontemplate",!0),oaearlyaccessupgrade:{dismissible:"false",icon:"warning",iconcolor:"white"},oarefundpreordervaultgame:{dismissible:"false",icon:"warning",iconcolor:"white"},refundgamelink:{dismissible:"false",icon:"info",iconcolor:"white"}};var y=String(e.violatortype),S=b[y];e.useSubscriptionTemplate=_.get(S,"usesubscriptiontemplate",!1)&&r.isPremierFeatureEnabled(),e.useThirdPartyTemplate=_.get(S,"usethirdpartytemplate",!1),e.thirdPartyTemplateType=_.get(S,"logotype",""),e.thirdPartyViolator=_.get(S,"thirdpartyviolator",!1),e.getTitle=function(){if(S)return c(y)},e.getIcon=function(){return _.get(S,"icon")},e.getDismissibility=function(){return _.get(S,"dismissible","false")},e.getIconColor=function(){return _.get(S,"iconcolor")},e.getLiveCountdown=function(){return _.get(S,"livecountdown","")}}function wi(e,t,i,n,r){"ngInject";function o(){e.gamesCount=i.baseGameEntitlements().length,e.isLoading=!n.isAppLoggedIn()}function a(){o(),e.$digest()}var s=null,c=null;e.hasGames=function(){return void 0!==e.gamesCount&&e.gamesCount>0},e.gamesCount=void 0,e.isLoading=!0,e.isUnderAge=Origin.user.underAge(),s=i.events.on("games:baseGameEntitlementsUpdate",a,this),c=r.events.on("GamesNonOriginFactory:nogsRefreshed",a,this),e.$on("$destroy",function(){s&&s.detach(),c&&c.detach()}),i.initialRefreshCompleted()&&o(),t("OriginAuthstatelistenerCtrl",{$scope:e})}function Ci(e,t,i,n){"ngInject";var r=n.getTileSizeObserver();r.getProperty("tileSize").attachToScope(e,"gridSize"),e.$on("$destroy",function(){r.detach()}),e.updateGridTileSize=function(e){n.setTileSize(e)},e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),e.localizedStrings={smallTiles:i.getLocalizedStr(e.smalltilesstr,VF,"smalltilesstr"),mediumTiles:i.getLocalizedStr(e.mediumtilesstr,VF,"mediumtilesstr"),largeTiles:i.getLocalizedStr(e.largetilesstr,VF,"largetilesstr")}}function Ti(e,t,i,n,r,o){"ngInject";return{restrict:"E",transclude:!0,scope:{copyrightText:"@",legalContent:"@",languageString:"@"},template:qF,link:function(a,s,c,l,d){function g(e){a.languageMap=e}var u=s.find("footer");d(a,function(e){u.prepend(e)}),o.matchRegion("US","CA",!0).then(function(e){e||u.find(".origin-globalfooter-link[href*='WEBPRIVACYCA']").remove()}),a.versionText=YF+e,a.onClickGeoPreferences=function(){n.openGeoPreferencesDialog().then(function(e){var i=e.accepted,n=e.result,o=n.languageLocale,a=n.storefront,s=n.country;i&&(t.setLocale(o,{reloadApp:!1}),r.setAndGoTo({storefront:a,languageLocale:o,country:s}))})},a.strings={},a.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),a.strings.copyrightText=i.getLocalizedStr(a.copyrightText,KF,"copyright-text").replace(QF,(new Date).getFullYear()),n.isUserInSingleMarketCountry().then(function(e){a.showGeographicPreferences=e,e?a.strings.geographicPreferencesBtnLabel=i.getLocalizedStr(a.geographicPreferencesBtnLabel,KF,"geographic-preferences-btn-label"):a.isEmbeddedBrowser||(t.getAllLanguages().then(g),a.currentLocale=t.getDashedLocale(),a.setLocale=function(e){r.setLanguageLocale(e),t.setLocale(e)},a.strings.language=i.getLocalizedStr(a.languageString,KF,"language-string")),a.$digest()})}}}function Pi(e,t){"ngInject";return{restrict:"E",replace:!0,scope:{linkText:"@",linkUrl:"@"},template:ZF,link:function(i){i.strings={linkUrl:t.getLocalizedStr(i.linkUrl,ex,"link-url")},i.strings.linkUrlAbsolute=e.getAbsoluteUrl(i.strings.linkUrl),i.onLinkClick=function(t){t.preventDefault(),t.stopPropagation(),e.openLink(i.strings.linkUrl)}}}}function _i(e){"ngInject";return{restrict:"E",replace:!0,scope:{linkText:"@"},template:ix,link:function(t){t.visible=!Origin.client.isEmbeddedBrowser()&&window.hasOwnProperty("truste")&&window.truste.hasOwnProperty("eu")&&window.truste.eu.hasOwnProperty("clickListener"),t.linkText=e.getLocalizedStr(t.linkText,nx,"link-url"),t.onLinkClick=function(){window.truste.eu.clickListener()}}}}function Oi(e,t,i,n){"ngInject";return{restrict:"A",link:function(r,o,a){function s(t){angular.isDefined(i.getOIGContextConfig())||(c(),d=e.addStripeMargin(t))}function c(){d&&d()}var l=ox(o,1)[0],d=void 0;r.setDefaultSpacing=function(e){var i=!a.originAddSitestripeMargin,n="mobile"===a.originAddSitestripeMargin&&t.isSmall();"body"===l.localName&&a.originAddSitestripeMarginOffsetHeight===OS.true?l.style.paddingTop=e>0?e+"px":"":l.style.marginTop=i||n?e+"px":""},a.hasOwnProperty("setMargin")?r.hasOwnProperty(a.setMargin)?s(n(a.setMargin)(r)):r.$watch(a.setMargin,function(){s(n(a.setMargin)(r))}):s(r.setDefaultSpacing),r.$on("$destroy",c)}}}function Ei(e,t,i,n,r){"ngInject";function o(e){return!0===e||_.isString(e)&&e.toLowerCase()===sx.true}function a(e,t){return _.isNumber(e)?e:_.isString(e)?Number(e):t}function s(e){return!_.isUndefined(e)&&_.isString(e)?e.split(","):[]}function c(){function t(e){return _.isUndefined(e)?"":e}return cx.concat(t(e.message)).concat(t(e.reason)).concat(t(e.cta)).concat(t(e.cta2)).concat(t(e.lastModified))}function l(e,t){t?i.internalUrl(e):i.externalUrl(e,!0)}e.ctaIsInternal=o(e.ctaIsInternal),e.cta2IsInternal=o(e.cta2IsInternal),e.permanent=o(e.permanent),e.priority=a(e.priority,0),e.winFilter=o(e.winFilter),e.macFilter=o(e.macFilter),e.webFilter=o(e.webFilter),e.greaterVersionFilter=a(e.greaterVersionFilter,Number.MAX_VALUE),e.lesserVersionFilter=a(e.lesserVersionFilter,Number.MIN_VALUE),e.betaFilter=o(e.betaFilter),e.showOnStates=s(e.showOnStates),e.hideOnStates=s(e.hideOnStates),this.closeCallback=function(){n.set(c(),!1),t.hideStripe(e.$id)},this.ctaCallback=function(){l(e.strings.ctaHref,e.ctaIsInternal)},this.getCtaUrl=function(){return i.getAbsoluteUrl(e.strings.ctaHref)},this.cta2Callback=function(){l(e.strings.cta2Href,e.cta2IsInternal)},this.getCta2Url=function(){return i.getAbsoluteUrl(e.strings.cta2Href)},e.strings={ctaHref:r.getLocalizedStr(e.ctaHref,lx,"cta-href"),cta2Href:r.getLocalizedStr(e.cta2Href,lx,"cta2-href")},!1!==n.get(c())&&t.showStripe(e.$id,e.ctid,e.priority,this.closeCallback,e.message,e.reason,e.cta,this.ctaCallback,e.icon,e.cta2,this.cta2Callback,e.permanent,e.winFilter,e.macFilter,e.webFilter,e.greaterVersionFilter,e.lesserVersionFilter,e.betaFilter,e.osVersionGreaterFilter,e.osVersionLesserFilter,e.showOnStates,e.hideOnStates,this.getCtaUrl,this.getCta2Url,e.backgroundImageUrl)}function Fi(e,t,i,n,r,o,a,s){"ngInject";function c(t){var i=_.isUndefined(t[px])?mx.notStarted:parseInt(t[px]);i<mx.completed&&(i<mx.settingsDisabled&&(r.setGeneralSetting(px,mx.settingsDisabled),Origin.client.settings.writeSetting("AutoUpdate",!1),Origin.client.settings.writeSetting("AutoPatch",!1)),n.showStripe(e.$id,e.ctid,e.priority,e.hideStripe,e.message,e.reason,e.cta,e.btnAction))}function l(e){o.error("[origin-global-sitestripe-privacy]:retrieveSettings FAILED:",e)}function d(){if(Origin.user&&Origin.auth.isLoggedIn()){var e=_.split(Origin.user.registrationDate(),"T",2)[0],t=new Date(e),i=new Date(2015,6,1);"CA"===Origin.user.country()&&t<i&&r.getGeneralSettings().then(c).catch(l)}}function g(t){t.accepted&&(Origin.client.settings.writeSetting("AutoUpdate",t.content.updateorigin),Origin.client.settings.writeSetting("AutoPatch",t.content.updategames),e.hideStripe())}function u(t){t.isLoggedIn?d():n.hideStripe(e.$id)}e.priority=_.isUndefined(e.priority)?gx:Number(e.priority),e.message=i.getLocalizedStr(e.message,ux,"message"),e.reason=i.getLocalizedStr(e.reason,ux,"reason"),e.cta=i.getLocalizedStr(e.cta,ux,"cta"),e.dialogtitlestr=i.getLocalizedStr(e.dialogtitlestr,ux,"dialogtitlestr"),e.dialogacceptstr=i.getLocalizedStr(e.dialogacceptstr,ux,"dialogacceptstr"),e.dialogcancelstr=i.getLocalizedStr(e.dialogcancelstr,ux,"dialogcancelstr"),e.dialogupdategamesstr=i.getLocalizedStr(e.dialogupdategamesstr,ux,"dialogupdategamesstr"),e.dialogupdategameshintstr=i.getLocalizedStr(e.dialogupdategameshintstr,ux,"dialogupdategameshintstr"),e.dialogupdateoriginstr=i.getLocalizedStr(e.dialogupdateoriginstr,ux,"dialogupdateoriginstr"),e.dialogupdateoriginhintstr=i.getLocalizedStr(e.dialogupdateoriginhintstr,ux,"dialogupdateoriginhintstr"),e.dialogemailsubscribelinkstr=i.getLocalizedStr(e.dialogemailsubscribelinkstr,ux,"dialogemailsubscribelinkstr"),e.dialogsettingstopicstr=i.getLocalizedStr(e.dialogsettingstopicstr,ux,"dialogsettingstopicstr"),e.dialogsettingscontentstr=i.getLocalizedStr(e.dialogsettingscontentstr,ux,"dialogsettingscontentstr"),e.dialogemailtopicstr=i.getLocalizedStr(e.dialogemailtopicstr,ux,"dialogemailtopicstr"),e.dialogemailcontentstr=i.getLocalizedStr(e.dialogemailcontentstr,ux,"dialogemailcontentstr"),e.hideStripe=function(){r.setGeneralSetting(px,mx.completed),n.hideStripe(e.$id)},e.btnAction=function(){!function(){function t(e,t){i[e]=t}var i={};Promise.all([Origin.client.settings.readSetting("AutoUpdate").then(_.partial(t,"AutoUpdate")),Origin.client.settings.readSetting("AutoPatch").then(_.partial(t,"AutoPatch"))]).then(function(){var t=a.createDirective("origin-dialog-content-privacyconsent",{updategamesstr:e.dialogupdategamesstr,updategameshintstr:e.dialogupdategameshintstr,updateoriginstr:e.dialogupdateoriginstr,updateoriginhintstr:e.dialogupdateoriginhintstr,emailsubscribelinkstr:e.dialogemailsubscribelinkstr,settingstopicstr:e.dialogsettingstopicstr,settingscontentstr:e.dialogsettingscontentstr,emailtopicstr:e.dialogemailtopicstr,emailcontentstr:e.dialogemailcontentstr,updateorigin:i.AutoUpdate,updategames:i.AutoPatch});a.openPrompt({id:"origin-dialog-content-privacyconsent-id",title:e.dialogtitlestr,acceptText:e.dialogacceptstr,acceptEnabled:!0,rejectText:e.dialogcancelstr,defaultBtn:"yes",contentDirective:t,callback:g})})}()},Origin.client.isEmbeddedBrowser()&&(e.$on("$destroy",function(){s.events.off("myauth:change",u)}),s.events.on("myauth:change",u),d())}function xi(e,t,i,n,r,o,a){"ngInject";var s,c=this;e.stripe=void 0,e.visible=!1,e.reasonHtml="",e.isOigContext=angular.isDefined(i.getOIGContextConfig()),e.isPassive=function(){return!e.isWarning()&&!e.isError()},e.isWarning=function(){return e.stripe&&"warning"===e.stripe.icon},e.isError=function(){return e.stripe&&"error"===e.stripe.icon},e.isDoubleCta=function(){return!!(e.stripe&&e.stripe.cta2&&e.stripe.cta2.length)},e.hideMessage=function(){e.stripe.closeCallback&&e.stripe.closeCallback()},e.btnAction=function(t){t.preventDefault(),e.stripe.ctaCallback&&e.stripe.ctaCallback()},e.getBtnUrl=function(){if(e.stripe&&e.stripe.getCtaUrl)return e.stripe.getCtaUrl()},e.btnAction2=function(t){t.preventDefault(),e.stripe.cta2Callback&&e.stripe.cta2Callback()},e.getBtn2Url=function(){if(e.stripe&&e.stripe.getCta2Url)return e.stripe.getCta2Url()},e.useHomeStoreFront=(s=regeneratorRuntime.mark(function t(){var i,n,s,l,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.stripe.closeCallback(),i=a.get().languageLocale||o.getDashedLocale(),t.next=4,Promise.all([r.getHomeStorefrontInfo(),r.getGeoIpCountryInfo()]);case 4:n=t.sent,s=vx(n,2),l=s[0].storefrontCode,d=s[1].countryCode,a.setAndGoTo({storefront:l,country:d,languageLocale:i});case 9:case"end":return t.stop()}},t,c)}),function(){var e=s.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})}),e.generateReasonHtml=function(){return""},this.setData=function(t){_.isUndefined(t)?(e.stripe=null,e.visible=!1):(e.stripe=t,e.visible=!0,e.generateReasonHtml()),n.digestIfDigestNotInProgress(e)},this.getHeight=function(t){e.getHeight?e.getHeight(t):t(0)},t.addStripeArea(this.setData,this.getHeight)}function Li(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:!0,controller:xi,template:hx,link:function(a,s){function c(){r.retrieveTemplate().then(function(t){!function(t){d.html(e(t)(a))}(t),r.updateFilters()})}var l,d=s.find(".l-origin-sitestripe-reason");a.getHeight=function(e){if(!_.isFunction(e))return 0;l=t(function(){e(function(){if(a.visible){var e=s.find(".origin-sitestripe");if(0!==e.length)return e[0].getBoundingClientRect().height}return 0}())})},a.generateReasonHtml=function(){var t={"%cta%":'<a style="cursor: pointer;" ng-click="btnAction($event)" ng-href="{{::getBtnUrl()}}" class="otka" ng-bind="stripe.cta"></a>',"%cta2%":'<a style="cursor: pointer;" ng-click="btnAction2($event)" ng-href="{{::getBtn2Url()}}" class="otka" ng-bind="stripe.cta2"></a>',"%usehomestorefront%":'<button class="otkc-small origin-btnlink" ng-bind="stripe.cta" ng-click="useHomeStoreFront()"></button>'},n="<span>"+(a.stripe.reason?i.substitute(a.stripe.reason,t):"")+"</span>";d.empty().append(e(n)(a))},o.events.on(Ey.l,c),n.events.on(Ey.a,c),a.$on("$destroy",function(){t.cancel(l),o.events.off(Ey.l,c),n.events.off(Ey.a,c)})}}}function Ai(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){var t={days:0,hours:0,minutes:0},s=r.getTimeRemaining();s>0&&(t.days=Math.floor(s/1e3/60/60/24),t.hours=Math.floor(s/1e3/60/60%24),t.minutes=Math.floor(s/1e3/60%60)),function(t){t.days>0?(e.message=i.getLocalizedStr(e.messageExpireInDays,Sx,"message-expire-in-days",{"%time%":t.days},t.days),u=36e5):t.hours>0?(e.message=i.getLocalizedStr(e.messageExpireInHours,Sx,"message-expire-in-hours",{"%time%":t.hours},t.hours),u=36e5):t.minutes>1?(e.message=i.getLocalizedStr(e.messageExpireInMinutes,Sx,"message-expire-in-minutes",{"%time%":t.minutes},t.minutes),u=6e4):t.minutes>0?(e.message=i.getLocalizedStr(e.messageExpireInOneMinute,Sx,"message-expire-in-one-minute"),u=6e4):(e.message=i.getLocalizedStr(e.messageExpiredHeader,Sx,"message-expired-header"),u=0),function(){if(e.user.subscriptions.detailInfo.Subscription.status===kx&&new Date(r.getExpiration()).valueOf()-(new Date).valueOf()<Cx)e.reason=i.getLocalizedStr(e.reasonCouldNotProcess,Sx,"reason-could-not-process"),e.cta=i.getLocalizedStr(e.ctaCouldNotProcess,Sx,"cta-could-not-process"),e.btnAction=function(){var e=o.getUrl("eaAccountsPayment");e=(e=e.replace("{locale}",Origin.locale.locale())).replace("{access_token}",""),a.asyncOpenUrlWithEADPSSO(e)};else{if(!(e.user.subscriptions.detailInfo.Subscription.status===Ix&&(new Date).valueOf()-new Date(r.getExpiration()).valueOf()<Cx))return void e.hideMessage();e.reason=i.getLocalizedStr(e.reasonRenewMembership,Sx,"reason-renew-membership"),e.cta=i.getLocalizedStr(e.ctaRenewMembership,Sx,"cta-renew-membership"),e.btnAction=function(){c.events.fire("uiRouter:go","app.store.wrapper.origin-access")}}l.showStripe(e.$id,e.ctid,e.priority,e.hideMessage,e.message,e.reason,e.cta,e.btnAction),u>0&&(p=n(d,u,!1))}()}(t)}function g(){l.hideStripe(e.$id),n.cancel(p)}var u=0,p={};e.priority=_.isUndefined(e.priority)?yx:Number(e.priority),t.getObserver(e,"user"),e.hideMessage=function(){s.set(wx+e.user.subscriptions.basicInfo.subscriptionId,!1),g()},e.$watch("user.subscriptions.detailInfo.Subscription.status",function(){var t=r.getStatus();-1!==[kx,Ix].indexOf(t)?!1!==s.get(wx+e.user.subscriptions.basicInfo.subscriptionId)&&d():g()}),e.$on("$destroy",g)}function Di(e,t,i,n,r){"ngInject";e.priority=_.isUndefined(e.priority)?Px:Number(e.priority),e.message=i.getLocalizedStr(e.message,_x,"message"),e.reason=i.getLocalizedStr(e.reason,_x,"reason"),e.cta=i.getLocalizedStr(e.cta,_x,"cta"),e.hideMessage=function(){n.hideStripe(e.$id)},e.btnAction=function(){r.openCookiePreferences()},Origin.client.isEmbeddedBrowser()||!window.truste||t.get("notice_preferences")||n.showStripe(e.$id,e.ctid,e.priority,e.hideMessage,e.message,e.reason,e.cta,e.btnAction)}function Ri(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(t){function i(e){return _.isUndefined(e)?"":e}e.localStoragekey=Dx.concat(i(e.message)).concat(i(t)).concat(i(e.ctaRestart)).concat(i(e.ctaReleaseNotes)).concat(i(v))}function g(t){!1!==s.get(e.localStoragekey)&&i.showStripe(e.$id,e.ctid,e.priority,e.hideMessage,e.message,e.reason,e.cta,t||e.restart,e.icon,e.cta2,e.releaseNotes)}function u(){e.updatePromise&&(t.cancel(e.updatePromise),e.updatePromise=void 0)}function p(i,n){u(),e.updatePromise=t(i,n)}function m(e){e.hasOwnProperty("releaseNotesUrl")&&(v=e.releaseNotesUrl)}function f(){window.location.reload()}function h(){var t=r.getLocalizedStr(e.restrictedAccessModeLearnMore,Ax,"restricted-access-mode-learn-more");a.asyncOpenUrlWithEADPSSO(t)}var v,b=r.getLocalizedStrGenerator(Ax),y=!1;e.priority=_.isUndefined(e.priority)?Ex:Number(e.priority),e.hideMessage=function(){s.set(e.localStoragekey,!1),i.hideStripe(e.$id),y=!1},e.restart=function(){Origin.client.user.requestRestart()},e.releaseNotes=function(){v&&a.asyncOpenUrlWithEADPSSO(v)};var S=[Origin.events.on(Origin.events.CLIENT_NAV_SHOW_PENDING_UPDATE_STRIPE,function(t){e.icon="passive",e.message=r.getLocalizedStr(e.pendingUpdateMessage,Ax,"pending-message"),l.checkHasRestrictedAccess().then(function(i){u(),m(t),i?(e.reason=r.getLocalizedStr(e.restartAdministratorMessage,Ax,"restart-administrator-message"),e.cta=r.getLocalizedStr(e.learnMoreCta,Ax,"learn-more-cta"),e.cta2=r.getLocalizedStr(e.mandatoryReleaseNotesCta,Ax,"mandatory-release-notes-cta").toLowerCase(),d(e.reason),g(h)):(e.reason=r.getLocalizedStr(e.pendingUpdateReason,Ax,"pending-reason"),e.cta=r.getLocalizedStr(e.pendingRestartCta,Ax,"pending-restart-cta"),e.cta2=r.getLocalizedStr(e.pendingReleaseNotesCta,Ax,"pending-release-notes-cta"),d(e.reason),g()),y=!0})}),Origin.events.on(Origin.events.CLIENT_NAV_SHOW_PENDING_UPDATE_COUNTDOWN_STRIPE,function(t){function i(){var t=o.getCountdownData(e.targetDate,new Date);!function(t){e.icon="warning",e.message=r.getLocalizedStr(e.mandatoryMessage,Ax,"mandatory-message"),t.hours>0||t.minutes>0?e.reason=b(e.mandatoryReason,"mandatory-reason",{"%hours%":t.hours,"%minutes%":t.minutes}):e.reason=b(e.mandatoryReasonSeconds,"mandatory-reason-seconds",{"%seconds%":t.seconds}),e.cta=r.getLocalizedStr(e.mandatoryRestartCta,Ax,"mandatory-restart-cta"),e.cta2=r.getLocalizedStr(e.mandatoryReleaseNotesCta,Ax,"mandatory-release-notes-cta"),d(e.mandatoryReason),g(),y=!0}(t),t.totalSeconds>0?t.totalSeconds<Fx&&p(i,Lx):u()}if(t.hasOwnProperty("countdown")){m(t);var n=t.countdown.split(":");e.targetDate=new Date,e.targetDate.setHours(e.targetDate.getHours()+parseInt(n[0])),e.targetDate.setMinutes(e.targetDate.getMinutes()+parseInt(n[1])),e.targetDate.setSeconds(e.targetDate.getSeconds()+parseInt(n[2])),p(i,xx),i()}}),Origin.events.on(Origin.events.CLIENT_NAV_SHOW_PENDING_UPDATE_KICKED_OFFLINE_STRIPE,function(t){u(),m(t),e.icon="warning",e.message=r.getLocalizedStr(e.mandatoryOfflineMessage,Ax,"offline-message"),e.reason=r.getLocalizedStr(e.mandatoryOfflineReason,Ax,"offline-reason"),e.cta=r.getLocalizedStr(e.offlineRestartCta,Ax,"offline-restart-cta"),e.cta2=r.getLocalizedStr(e.offlineReleaseNotesCta,Ax,"offline-release-notes-cta"),d(e.reason),g(),y=!0}),c.events.on("showNewSPAAvailable",function(){y||(u(),e.icon="warning",e.message=r.getLocalizedStr(e.mandatoryOfflineMessage,Ax,"spa-restart-message"),e.reason=r.getLocalizedStr(e.mandatoryOfflineReason,Ax,"spa-restart-reason"),e.cta=r.getLocalizedStr(e.offlineRestartCta,Ax,"spa-restart-cta"),e.cta2="",d(e.reason),g(f))})];e.$on("$destroy",function(){n.detachAll(S)})}function $i(e,t,i,n,r){"ngInject";var o=(Nx+"::"+e.message).replace(Gx,"-");e.priority=_.isUndefined(e.priority)?$x:Number(e.priority),e.message=t.getLocalizedStr(e.message,Nx,"message"),e.hideMessage=function(){i.hideStripe(e.$id),r.set(o,!1)},n.isNoCommerceContext()&&!1!==r.get(o)&&i.showStripe(e.$id,e.ctid,e.priority,e.hideMessage,e.message)}function Ni(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Gi(e,t,i){"ngInject";e.isLoadingMore=!1,e.visible=!1,e.bucketConfig=[],e.titleStr=t.getLocalizedStr(e.titleStr,Hx,"title-str"),e.subtitleStr=t.getLocalizedStr(e.subtitleStr,Hx,"subtitle-str"),e.viewmoreStr=t.getLocalizedStr(e.viewmoreStr,Hx,"viewmore-str"),e.$on("bucketFilter",function(t,i){e.filterFunction=i.filterFunction}),e.$on(Ey.u,function(){return i.digestIfDigestNotInProgress(e)}),e.range=function(e){return new Array(e)}}function Ui(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",scope:{titleStr:"@",subtitleStr:"@",viewmoreStr:"@",tileLimit:"@",layout:"@",bucketHash:"@"},transclude:!0,template:jx,controller:Gi,link:function(i,c){function l(){var e,t,n=c.find(zx).find(Vx);for(e=s.getItemVisiblity(S.length,w,i.carouselState.current),t=0;t<n.length;++t)e[t]?(n[t].style.display="flex",s.events.fire(s.events.HOME_TILE_VISIBLE,n[t])):n[t].style.display="none";setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0)}function d(){i.carouselState.numberOfSlides=Math.ceil(S.length/w)}function g(e,t){var i=c.find(zx).find(Vx).length,n=(e+1)*t;n-1>S.length&&(n=S.length+1),n>i&&k(i,n-i,S).then(p).then(m)}function u(e){if(_.isElement(e)){var t=o.buildTag(Wx,Qx);return t.classList.add(_.get(Xx,_.get(i,qx),Jx)),t.appendChild(e),Origin.telemetry.events.fire("origin-tealium-discovery-tile-loaded",e.outerHTML),t}}function p(n){if(n.length){i.visible=!0,i.$digest(),(o=window.location.hash.substring(1))===i.bucketHash&&(window.location.hash="",window.location.hash=o);var r=c.find(zx);_.isEmpty(r)||t(function(t,n){var r=_.compact(_.map(t,u));r.length&&(n.append(e(r)(i)),l()),i.$emit("myhome:dirty"),i.isLoading=!1}(n,r),0,!1)}var o}function m(){i.$digest()}function f(e){var t=_.get(i,"tileLimit",-1);return _.isArray([e])||(e=[]),S=t>=0?e.slice(0,t):e}var h,v=Zx[Yx],b=Zx[Kx],y=(Ni(h={},v,s.getCurrentNumberOfColumnsHalfWidth),Ni(h,b,s.getCurrentNumberOfColumnsQuarterWidth),h),S=null,k=r.generateXML,I=_.get(y,_.get(i,qx),s.getCurrentNumberOfColumns),w=I(),C=void 0;i.carouselState={},i.carouselState.current=0,i.showNextPage=function(){i.carouselState.current<i.carouselState.numberOfSlides-1&&(i.carouselState.current++,g(i.carouselState.current,w),l())},i.showPrevPage=function(){i.carouselState.current>0&&(i.carouselState.current--,g(i.carouselState.current,w),l())},i.showNextPageIfTouch=function(){o.isTouchEnabled()&&i.showNextPage()},i.showPrevPageIfTouch=function(){o.isTouchEnabled()&&i.showPrevPage()},i.goTo=function(e){i.carouselState.current=e,g(e,w),l()},i.getNextHiddenStory=function(e){var t=s.findNextHiddenStory(e.index()%w,i.carouselState.current,S,w),n=1===e.parent().children('li[style*="flex"]').length;return!t&&n&&i.carouselState.current>0&&i.carouselState.current===i.carouselState.numberOfSlides-1&&i.goTo(i.carouselState.current-1),i.visible=S.length>0,d(),m(),t},a.addResizeEventHandler(i,function(){if(S){var e=s.computeCarouselState(i.carouselState,w,S.length,I);e.carouselChanged&&(i.carouselState=e.carouselState,w=e.itemsPerPage,g(i.carouselState.current,w),l())}},10),C=i.$watchCollection("bucketConfig",function(e,t){t.length>0&&c.find(zx).empty(),e.length>0&&(c.find(".origin-home-discovery-configs").remove(),r.generateStories(i.bucketConfig,i.filterFunction).then(f).then(_.partial(k,0,w)).then(p).then(d).then(m).catch(function(e){n.error("[origin-home-discovery-bucket DiscoveryStoryFactory.generateStories] error",e)}))}),i.$on("$destroy",function(){_.isFunction(C)&&C()})}}}function Bi(e,t,i,n,r){"ngInject";var o=t.actionid,a=e.$parent.childDirectives,s={};if(nL.indexOf(o)>-1){var c=_.get(t,"ocdPath","");c&&(i.ownsEntitlementByPath(c)?o="download-install-play":function e(t){if(Array.isArray(t)&&_.some(t,function(t){return e(t)}))return!0;var o=n.getFullCachedCatalog()[t];return!!o&&(!!(_.size(o.bundleOffers)>0&&r.isShellBundle(o)&&_.every(o.bundleOffers,function(e){return i.ownsEntitlement(e)}))||i.ownsEntitlement(o))}(n.getOfferIdByPathSynchronous(c))&&(o="download-install-play"))}var l={"url-internal":"origin-cta-loadurl","url-external":"origin-cta-loadurl","play-video":"origin-cta-playvideo","twitch-channel":"origin-cta-play-twitch","twitch-video":"origin-cta-play-twitch","twitch-clip":"origin-cta-play-twitch",purchase:"origin-cta-purchase","direct-acquistion":"origin-cta-directacquisition","direct-acquistion-vault":"origin-cta-directacquisition",pdp:"origin-cta-pdp","download-install-play":"origin-cta-downloadinstallplay","content-reader":"origin-cta-content-reader"}[o];if(s[l]={href:_.get(t,"href",""),description:_.get(t,"description",""),type:_.get(t,"type",""),"ocd-path":_.get(t,"ocdPath",""),"secondary-href":_.get(t,"secondaryHref",""),"secondary-href-label":_.get(t,"secondaryHrefLabel",""),"secondary-description":_.get(t,"secondaryDescription",""),"hide-packart":_.get(t,"hidePackart",""),"mature-content":_.get(t,"matureContent","")},"direct-acquistion-vault"===o&&(s[l]["is-vault"]=!0),iL[o]){var d=_.get(t,"videoid",_.get(s,[l,"href"]));_.set(s,[l,iL[o]],d),_.set(s,[l,"content-link"],_.get(s,[l,"secondary-href"])),_.set(s,[l,"content-link-btn-text"],_.get(s,[l,"secondary-href-label"])),_.set(s,[l,"content-text"],_.get(s,[l,"secondary-description"]))}a.push(s)}function Mi(e,t){"ngInject";function i(t){return _.get(e,["$parent",t])||_.get(e,["$parent","$parent",t])||_.get(e,["$parent","$parent","$parent",t])||_.get(e,["$parent","$parent","$parent","$parent",t])}var n=i(oL);i(aL)&&(t.usePinRec=!0,_.isUndefined(t.feedData)||e.$emit("OriginHomeDiscoveryTileConfigCtrl:controlTileAdded",t.feedData[0])),n&&n.push(t)}function ji(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-newdlc",feedFunctionName:"getUnownedDLC",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit)},$scope:e})}function Hi(e,t,i){"ngInject";e.pinRecommendation=!0,e.$emit("bucketFilter",{filterFunction:_.partialRight(i.filterRecommendedNews,parseInt(t.numrecs))})}function zi(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ogfriendsplaying",feedFunctionName:"getFriendsPlayingOwned",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit)},$scope:e})}function Vi(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ogneverplayed",feedFunctionName:"getNeverPlayed",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit),neverplayedsince:parseInt(t.neverplayedsince)},$scope:e})}function Wi(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ognotplayedrecently",feedFunctionName:"getNotRecentlyPlayed",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit),notplayedlow:parseInt(t.notplayedlow),notplayedhigh:parseInt(t.notplayedhigh)},$scope:e})}function qi(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ogrecentlyplayed",feedFunctionName:"getRecentlyPlayedNoFriends",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit),dayssinceplayed:parseInt(t.dayssinceplayed)},$scope:e})}function Yi(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ogrecentlyreleased",feedFunctionName:"getRecentlyReleased",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit),dayssincerelease:parseInt(t.dayssincerelease)},$scope:e})}function Ki(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable",feedData:[{image:t.image,subtitle:t.subtitle,description:t.description,authorname:t.authorname,creationdate:t.creationdate,authordescription:t.authordescription,authorhref:t.authorhref,timetoread:t.timetoread,friendslisttype:t.friendslisttype,friendstext:t.friendstext,friendspopouttitle:t.friendspopouttitle,offerid:t.offerid,showprice:t.showprice,ctid:t.ctid,"ocd-path":t.ocdPath}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function Qi(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-action",feedData:[{image:t.image,descriptiontitle:t.descriptiontitle,description:t.description,ctid:t.ctid}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function Ji(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-game",feedData:[{gamename:t.gamename,"discover-tile-image":t.image,description:t.description,friendslisttype:t.friendslisttype,friendstext:t.friendstext,friendspopouttitle:t.friendspopouttitle,showprice:t.showprice,ctid:t.ctid,"ocd-path":t.ocdPath,"show-access-badge":t.showAccessBadge}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function Xi(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-merch",feedData:[{image:t.image,descriptiontitle:t.descriptiontitle,description:t.description,showprice:t.showprice,ctid:t.ctid,"callout-text":t.calloutText,"callout-type":t.calloutType,"ocd-path":t.ocdPath,"focused-copy-enabled":t.focusedCopyEnabled,"focused-copy-text-color":t.focusedCopyTextColor,"show-access-badge":t.showAccessBadge}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function Zi(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-merch",feedData:[{image:t.image,descriptiontitle:t.descriptiontitle,description:t.description,showprice:t.showprice,"callout-text":t.calloutText,"callout-type":t.calloutType,"ocd-path":t.ocdPath,"promo-code":t.promoCode,"promo-legal-id":t.promoLegalId,"promo-btn-text":t.promoBtnText,"btn-text":t.btnText,"exclusive-promo":!0,"focused-copy-enabled":t.focusedCopyEnabled,"focused-copy-text-color":t.focusedCopyTextColor}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function en(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-news",feedData:[{image:t.image,descriptiontitle:t.descriptiontitle,description:t.description,authorname:t.authorname,creationdate:t.creationdate,authordescription:t.authordescription,authorhref:t.authorhref,timetoread:t.timetoread,ctid:t.ctid}],limit:1,diminish:0};angular.isDefined(t.placementtype)&&angular.isDefined(t.placementvalue)?n[t.placementtype]=parseInt(t.placementvalue):n.position=1,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{$scope:e,tileConfig:n})}function tn(e,t,i,n){"ngInject";var r={directiveName:"origin-home-discovery-tile-programmable-game",feedFunctionName:"getRecommendedGamesToBuy",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit),numrecs:parseInt(t.numrecs),recoType:Origin.pin.constants.GAMES,pinRecommendationType:Origin.pin.getGamesRecommendation,controlGames:[]};e.pinRecommendation=!0,e.$emit("bucketFilter",{filterFunction:n.filterControlGames}),e.$on("OriginHomeDiscoveryTileConfigCtrl:controlTileAdded",function(e,t){r.controlGames.push(t)}),i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:r,$scope:e})}function nn(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-recfriends",feedFunctionName:"getRecommendedFriends",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit)},$scope:e})}function rn(e,t,i){"ngInject";i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:{directiveName:"origin-home-discovery-tile-ugfriendsplaying",feedFunctionName:"getFriendsPlayingUnowned",priority:parseInt(t.priority),diminish:parseInt(t.diminish),limit:parseInt(t.limit)},$scope:e})}function on(e,t,i){"ngInject";var n={directiveName:"origin-home-discovery-tile-programmable-game",feedFunctionName:"getRecommendedHomeVaultGames",priority:CL,diminish:TL,limit:parseInt(t.limit),numrecs:parseInt(t.numrecs),recoType:Origin.pin.constants.GAMES,pinRecommendationType:Origin.pin.getHomeVaultGamesRecommendation,controlGames:[]};e.pinRecommendation=!0,e.childDirectives=[],n.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:n,$scope:e})}function an(e,t,i,n){"ngInject";var r=n.getLocalizedStr(_.get(t,"readTime",""),_L,"readTime"),o={directiveName:"origin-home-discovery-tile-programmable-news",feedFunctionName:"getContentServiceArticleHeaders",diminish:1,priority:5e3,maxArticlesToShow:parseInt(_.get(t,"maxArticlesToShow",16)),minArticlesToShow:parseInt(_.get(t,"minArticlesToShow",4)),maxArticlesPerGame:parseInt(_.get(t,"maxArticlesPerGame",4)),readTimeString:r};e.childDirectives=[],o.childDirectives=e.childDirectives,i("OriginHomeDiscoveryTileConfigCtrl",{tileConfig:o,$scope:e})}function sn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:null,customDescriptionFunction:null})}function cn(e,t,i,n){"ngInject";e.shouldShowIntroTiles=function(){var r=i.getAllEntitlements(),o=function(){var e=[];return _.forEach(xL,function(i){t[i]&&(e=e.concat(t[i].split(",")))}),_.uniq(_.compact(e))}();return e.showfordays=_.parseInt(_.get(e,"showfordays",LL))||LL,!(!_.isObject(r)||!o.length)&&_.some(r,function(t){var i=_.first(t);return _.some(o,function(t){return((r=i.offerPath)===(o=t)||_.startsWith(r,o+"/"))&&n.isInTheFuture(n.addDays(i.grantDate,e.showfordays));var r,o})})}}function ln(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e){o.error("[OriginHomeDiscoveryTileGameCtrl] GamesCatalogFactory.getCatalogInfo",e)}function p(){h=e.description&&e.description.length>0,e.supportTextVisible=h||v||b||y,S()}var m,f=null,h=!1,v=!1,b=!1,y=!1,S=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);e.offerId&&l.getByOfferId(e.offerId).attachToScope(e,"model"),e.navigateToGame=function(){e.offerId&&(r.getEntitlement(e.offerId)?g.goToOgd(e.model):d.goToPdp(e.model))},e.isTouchDisable=!i.isTouchEnabled(),e.touched=function(){c.openAlert({id:"web-going-to-?",title:"Going to ???",description:"When the rest of OriginX is fully functional, you will be taken to the ???",rejectText:"OK"})},e.telemetryTrackerClass="telemetry-"+a,setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0),e.supportTextVisible=!1,e.$on("friendsTextVisible",function(e,t){h=t,p()}),e.$on("friendsPlayingTextVisible",function(e,t){v=t,p()}),e.$on("friendsTileDisplayVisible",function(e,t){b=t,p()}),e.$on("priceVisible",function(e,t){y=t,p()}),e.contextClass=a,e.$on("cta:clicked",function(t,i){var n=Origin.client.isEmbeddedBrowser()?"client":"web";i=i||"live_tile",t.stopPropagation(),Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"message",n,"success",{type:"in-game",service:"originx",format:i,client_state:"foreground",msg_id:e.ctid?e.ctid:e.image,status:"click",content:_.get(e,["$parent","description"])||"",destination_name:_.get(e,["$parent","$parent","titleStr"])||""})}),(e.offerId?n.getCatalogInfo([e.offerId]).then((m=e.offerId,function(e){return e[m]})).catch(u):Promise.resolve({})).then(function(t){var n;e.image=e.discoverTileImage||t.i18n.packArtLarge,e.isUsingPackart=!e.discoverTileImage,e.imageStyle={},e.discoverTileImage&&(e.imageStyle["background-image"]="url("+e.image+")"),e.discoverTileColor&&(e.imageStyle["background-color"]="#"+e.discoverTileColor),e.gamename=e.gamename||t.i18n.displayName,s?s(t):(n={"%game%":e.gamename},e.description=i.getLocalizedStr(e.descriptionRaw,a,"description",n)),p(),e.$digest()}).then(function(){var t=null;if(e.offerId){var i=r.getEntitlement(e.offerId,{includeAllExternalTypes:!0}),n=i&&i.length?i[0].externalType:"";f=function(t,i){return function(){e.isDownloading=r.isOperationActive(t,i),e.$digest()}}(e.offerId,n),e.isDownloading=r.isOperationActive(e.offerId,n),t=r.events.on("games:update:"+e.offerId,f,this),e.$on("$destroy",function(){t&&t.detach()})}})}function dn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:$L,customDescriptionFunction:null})}function gn(){}function un(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:GL,customDescriptionFunction:gn})}function pn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:BL,customDescriptionFunction:null})}function mn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:jL,customDescriptionFunction:null})}function fn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:zL,customDescriptionFunction:null})}function hn(e,t,i,n){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:WL,customDescriptionFunction:function(t){var i=Origin.utils.getProperty(t,["platforms",Origin.utils.os(),"releaseDate"]),r={"%game%":e.gamename,"%releasedate%":i.toDateString()};i&&Date.now()>=i?e.description=n.getLocalizedStr(e.descriptionReleased,WL,"descriptionreleased",r):e.description=n.getLocalizedStr(e.descriptionPreload,WL,"descriptionpreload",r)}})}function vn(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){e.supportTextVisible=u||p||m||f||e.isPriceVisible(),h()}var u=!1,p=!1,m=!1,f=!1,h=n.throttle(function(){i(function(){e.$digest()},0,!1)},1e3);e.description=t.trustAsHtml(e.descriptionRaw),e.eaplayImagePath=d.getImagePath("access/EAP-condensed.svg"),e.goToPdp=function(){e.model&&o.goToPdp(e.model)},e.navigateToGame=function(){e.offerId&&(s.getEntitlement(e.offerId)?a.goToOgd(e.model):o.goToPdp(e.model))},e.onAuthorClicked=function(){Origin.windows.externalUrl(e.authorhref)},e.isPriceVisible=function(){return String(e.showPrice).toLowerCase()===YL.true},e.$on("cta:clicked",function(t,i){var n=Origin.client.isEmbeddedBrowser()?"client":"web";i=i||"live_tile",t.stopPropagation(),Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"message",n,"success",{type:"in-game",service:"originx",format:i,client_state:"foreground",msg_id:e.ctid?e.ctid:e.image,status:"click",content:e.descriptionRaw,destination_name:_.get(e,["$parent","titleStr"])||""})}),e.supportTextVisible=!1,e.$on("friendsTextVisible",function(e,t){u=t,g()}),e.$on("friendsPlayingTextVisible",function(e,t){p=t,g()}),e.$on("friendsTileDisplayVisible",function(e,t){m=t,g()}),e.$on("friendsSubtitleVisible",function(e,t){f=t,g()}),g(),e.authorVisible=e.authorhref&&e.authorname||e.authordescription||e.timetoread,e.telemetryTrackerClass="telemetry-"+KL,setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0),c.lookUpOfferIdIfNeeded(e.ocdPath,e.offerId).then(function(t){r.getByOfferId(t).attachToScope(e,function(t){e.model=t,e.gamename=e.gamename||_.get(e.model,"displayName"),e.image?e.imageStyle={"background-image":"url("+e.image+")"}:(e.usingPackArt=!0,e.image=_.get(e.model,"packArt"),e.imageStyle={}),e.offerId=t.offerId})}).catch(function(e){l.error("[origin-home-discovery-tile-programmable]",e)})}function bn(e,t){"ngInject";e.eaplayImagePath=t.getImagePath("access/EAP-condensed.svg"),e.eaplayProImagePath=t.getImagePath("access/EAPP-condensed.svg"),e.supportTextVisible=_.get(e,["descriptiontitle","length"],0)||_.get(e,["description","length"],0),e.$on("cta:clicked",function(t,i){var n=Origin.client.isEmbeddedBrowser()?"client":"web";i=i||"live_tile",t.stopPropagation(),Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"message",n,"success",{type:"in-game",service:"originx",format:i,client_state:"foreground",msg_id:e.ctid?e.ctid:e.image,status:"click",content:e.description,destination_name:_.get(e,["$parent","titleStr"])||""})})}function yn(e,t,i,n,r,o,a){"ngInject";var s="origin-home-merchandise-tile",c="origin-home-exclusive-promo-hover";return{restrict:"E",transclude:!0,replace:!0,scope:{image:"@",descriptiontitle:"@",description:"@",showprice:"@",calloutText:"@",calloutType:"@",ocdPath:"@",promoCode:"@",promoLegalId:"@",promoBtnText:"@",exclusivePromo:"@",focusedCopyEnabled:"@",focusedCopyTextColor:"@",ctid:"@",showAccessBadge:"@"},template:tA,controller:"OriginHomeDiscoveryTileProgrammableActionNewsCtrl",link:function(l,d,g,u,p){function m(t,i){var n,r=l.calloutType===QS.custom,o="%~"+i+"~%",a={"%callout-text%":(n=r?l.calloutText:o,n?'<span class="callout-text">'+n+"</span>":"")};l.calloutType===QS.dynamicPrice||l.calloutType===QS.custom?e.insertPriceIntoLocalizedStr(l,l.strings,l[t],s,t,a):l.calloutType===QS.dynamicDiscountPrice?e.insertDiscountedPriceIntoLocalizedStr(l,l.strings,l[t],s,t,a):l.calloutType===QS.dynamicDiscountRate?e.insertDiscountedPercentageIntoLocalizedStr(l,l.strings,l[t],s,t,a):l.strings[t]=l[t]}p(function(e){l.showHover=e.length||l.exclusivePromo}),l.priceVisible=l.showprice===OS.true,l.showAccessLogo=l.showAccessBadge===OS.true,l.strings={},t.lookUpOfferIdIfNeeded(l.ocdPath).then(function(e){l.offerId=e,m("description",e),m("descriptiontitle",e),r.digestIfDigestNotInProgress(l)}).then(function(){l.showAccessBadge&&(l.offerId?t.getCatalogInfo([l.offerId]).then(function(e){var t=e[l.offerId];if(t){var i=a.isPremierVaultGame(t);l.eaplayBadge=i?l.eaplayProImagePath:l.eaplayImagePath,r.digestIfDigestNotInProgress(l)}}):l.eaplayBadge=l.eaplayImagePath)}).catch(function(e){i.error("[origin-home-merchandise-tile]",e)}),l.exclusivePromo&&function(e,t){e.btnText=e.promoBtnText,e.$watchOnce("model",function(){e.infobubbleContent="<origin-store-game-rating></origin-store-game-rating><origin-store-game-legal></origin-store-game-legal>"}),e.$watch("model.isOwned",function(e,i){e&&e!==i&&(t.remove(),o.events.fire("origin-route:reloadcurrentRoute"))}),n.getByOcdPath(e.ocdPath).attachToScope(e,"model"),e.$on("infobubble-show",function(){t.addClass(c)}),e.$on("infobubble-hide",function(){t.removeClass(c)})}(l,d),l.focusedCopyEnabled&&function(e){e.focusedCopyTextColor=ES[e.focusedCopyTextColor]||ES.dark,e.textColorClass="origin-home-merchandise-text-color-"+e.focusedCopyTextColor}(l)}}}function Sn(e,t,i,n,r,o,a,s,c){"ngInject";function l(){e.commonFriends=e.friendsInCommonStr?e.friendsInCommonStr.split(","):[],e.numMutualFriends=e.commonFriends.length}function d(e){return _.get(e,[_.head(Object.keys(e)),"masterTitle"])}function g(t){e.commonPlayTitleStr=i.getLocalizedStr(e.commonPlayTitleStr,aA,"friendsrecommendedcommonplay",{"%game-title%":t}),e.$digest()}function u(e){return e?o.translate(e,cA).then(g):Promise.resolve()}function p(){!e.friendsInCommonStr&&e.lastPlayedMasterTitleId&&r.getPurchasablePathByMasterTitleId(e.lastPlayedMasterTitleId,!0).then(r.getCatalogByPath).then(d).then(u)}function m(){l(),e.descriptionString=i.getLocalizedStr(e.descriptionStr,aA,"description",{"%friends%":e.numMutualFriends},e.numMutualFriends)}function f(){e.supportTextVisible=v||!e.noFriend&&_.get(e,["originId","length"],0)||e.canShowFullName&&_.get(e,["fullName","length"],0)||e.friendsInCommonStr&&_.get(e,"descriptionString.length",0)}function h(){e.$digest()}var v=!1;e.addFriendString=i.getLocalizedStr(e.addFriendButtonStr,aA,"addfriendcta"),e.dismissString=i.getLocalizedStr(e.dismissButtonStr,aA,"dismisscta"),e.requestSentString=i.getLocalizedStr(e.requestSentStr,aA,"requestsent"),e.hideButtonString=i.getLocalizedStr(e.hideButtonStr,aA,"hidecta"),e.viewListButtonString=i.getLocalizedStr(e.viewListButtonStr,aA,"viewlistcta"),e.noRecDescriptionString=i.getLocalizedStr(e.noRecDescriptionStr,aA,"norecdescription"),e.viewProfileString=i.getLocalizedStr(e.viewProfileStr,aA,"viewprofilecta"),e.popoutTitleStr=i.getLocalizedStr(e.friendsrecommendedstr,aA,"popoutfriendsrecommendedtitle"),e.friendString=i.getLocalizedStr(e.friendStr,aA,"friendstr"),e.ctid="friend_rec_"+Origin.user.userPid()+"_"+e.friendNucleusId,e.friendRequestSent=!1,e.noFriend=!1,e.canShowFullName=!1,e.defaultAvatarImgSrc=c.getImagePath("profile/avatar-placeholder.png"),l(),e.canShowAddDismissFriendButtons=function(){return!e.friendRequestSent&&!e.noFriend&&!e.showProfileButton},e.canShowRequestButtons=function(){return e.friendRequestSent&&!e.noFriend&&!e.showProfileButton},e.canShowViewFriendsList=function(){return e.noFriend&&!e.showProfileButton},e.canShowProfileButton=function(){return!!e.showProfileButton},a.getRosterUser(e.friendNucleusId).then(function(t){t&&s.create(t.subscription).defaultTo({state:"NONE",requestSent:!1,relationship:"NON_FRIEND"}).attachToScope(e,"subscription")}),e.isTouchDisable=!i.isTouchEnabled(),e.telemetryTrackerClass=sA+aA,setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0),this.getUserData=function(){return Promise.all([Origin.atom.atomUserInfoByUserIds([e.friendNucleusId]).then(function(t){e.originId=t[0].EAID,(t[0].firstName||t[0].lastName)&&(e.fullName=t[0].firstName?t[0].firstName:"",e.fullName+=t[0].lastName?" "+t[0].lastName:"",e.fullName=e.fullName.trim()),e.showFullName&&e.fullName&&(e.canShowFullName=!0)}).catch(function(e){n.error("OriginHomeDiscoveryTileRecfriendsCtrl: Origin.atom.atomUserInfoByUserIds failed",e)}),t.getAvatar(e.friendNucleusId,Origin.defines.avatarSizes.MEDIUM).then(function(t){e.image=t||e.defaultAvatarImgSrc}).catch(function(e){n.error("OriginHomeDiscoveryTileRecfriendsCtrl: UserDataFactory.getAvatar failed",e)})]).then(m).then(p).then(f).then(h)},e.supportTextVisible=!1,e.$on("friendsTileDisplayVisible",function(e,t){v=t,f()})}function kn(e,t,i,n){"ngInject";return{restrict:"E",scope:{friendNucleusId:"@userid",dismissButtonStr:"@dismisscta",addFriendButtonStr:"@addfriendcta",requestSentStr:"@requestsent",hideButtonStr:"@hidecta",viewListButtonStr:"@viewlistcta",viewProfileStr:"@viewprofilecta",descriptionStr:"@description",noRecDescriptionStr:"@norecdescription",friendsInCommonStr:"@friendsincommonstr",friendsrecommendedstr:"@popoutfriendsrecommendedtitle",showProfileButton:"@showprofilebutton",showFullName:"@showfullname",friendStr:"@friendstr",lastPlayedMasterTitleId:"@lastplayedmastertitleid"},controller:Sn,template:rA,link:function(r,o,a,s){function c(){g.addClass(lA),n.onTransitionEnd(g,function(){g.removeClass(lA),g.addClass(dA)},oA),n.onTransitionEnd(g,function(){g.removeClass(dA)},oA)}function l(){!function(e){if(e){var t=_.get(e,"index"),i=_.get(e,["feedTypeConfig","feedData",t]),n=_.get(e,"nextHiddenStoryIndex");r.friendNucleusId=i.userid,r.friendsInCommonStr=i.friendsInCommonStr.join(","),r.lastPlayedMasterTitleId=i.lastPlayedMasterTitleId,g.parent().children("li:eq("+n+")").remove(),s.getUserData().then(c)}else r.noMoreFriends=!0,g.siblings().length||(r.$parent.visible=!1),g.remove()}(r.$parent.getNextHiddenStory(g)),r.friendRequestSent=!1}function d(e){var t={type:"in-game",service:"originx",format:"live_tile",client_state:"foreground",msg_id:r.ctid,status:"click",content:"friend_recommendation",destination_name:"my_home",meta:{friend_id:r.friendNucleusId,friend_type:"nucleus"},option:e};return r.numMutualFriends&&_.set(t,["reqs","mutual_frd_cnt"],r.numMutualFriends),r.lastPlayedMasterTitleId&&_.set(t,["reqs","shared_game_id"],r.lastPlayedMasterTitleId),t}var g=o.parent(),u=null;r.addFriend=function(t){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIEND_RECOMMENDATION_ADD,d("yes")),e.sendFriendRequest(r.friendNucleusId,"recommendation"),u=setTimeout(l,2e3),r.friendRequestSent=!0,t.stopPropagation()},r.goToProfile=function(){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIEND_RECOMMENDATION_MORE_INFO,d("more_info")),i.goUserProfile(r.friendNucleusId,void 0,!0)},r.dismiss=function(e){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIEND_RECOMMENDATION_DISMISS,d("cancel")),Origin.friends.friendRecommendationsIgnore(r.friendNucleusId).then(l).catch(function(e){t.error("[origin-home-discovery-tile-recfriends] friend recommendaton ignore failed:",e)}),e.stopPropagation()},s.getUserData(),r.$on("$destroy",function(){clearTimeout(u)})}}}function In(){}function wn(e,t){"ngInject";t("OriginHomeDiscoveryTileGameCtrl",{$scope:e,contextNamespace:uA,customDescriptionFunction:In})}function Cn(e){"ngInject";return{restrict:"E",transclude:!0,template:mA,link:function(t,i){e(function(){t.hasVideo=i.parent().find(".origin-tile-overlay-content .otkicon-play").length,t.$digest()},0,!1)}}}function Tn(e,t,i,n,r,o){"ngInject";return{restrict:"E",replace:!0,scope:{image:"@",headline:"@",text:"@",promoCode:"@",promoLegalId:"@",ocdPath:"@",btnText:"@",calloutText:"@",useDynamicPriceCallout:"@",useDynamicDiscountPriceCallout:"@",useDynamicDiscountRateCallout:"@"},template:hA,link:function(a,s){function c(){n.buy(a.model.offerId,{promoCode:a.promoCode})}function l(e){var t,i={"%callout-text%":(t=a.calloutText,t?'<span class="callout-text">'+t+"</span>":"")};a.useDynamicPriceCallout?r.insertPriceIntoLocalizedStr(a,a.strings,a[e],yA,e,i):a.useDynamicDiscountPriceCallout?r.insertDiscountedPriceIntoLocalizedStr(a,a.strings,a[e],yA,e,i):a.useDynamicDiscountRateCallout?r.insertDiscountedPercentageIntoLocalizedStr(a,a.strings,a[e],yA,e,i):r.insertPriceIntoLocalizedStr(a,a.strings,a[e],yA,e,i)}a.strings={},a.$watchOnce("model",function(){a.infobubbleContent="<origin-store-game-rating></origin-store-game-rating><origin-store-game-legal></origin-store-game-legal>"}),a.$watch("model.isOwned",function(e,t){e&&e!==t&&(s.remove(),o.events.fire("origin-route:reloadcurrentRoute"))}),a.openMobileInfobubble=function(){i.openMobileDialogIfNecessary(c,a.model.offerId,a.btnText,a.promoLegalId)},a.viewDetailsText=t.getLocalizedStr(a.viewDetailsText,vA,"view-details-text"),l("text"),l("headline"),e.getByOcdPath(a.ocdPath).attachToScope(a,"model"),a.$on("infobubble-show",function(){s.addClass(bA)}),a.$on("infobubble-hide",function(){s.removeClass(bA)})}}}function Pn(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){var i,n,r,o=t.find(IA);for(r=h>0?Math.ceil(o.length/h):0,e.carouselState.current>r-1&&(e.carouselState.current=r-1),i=c.getItemVisiblity(o.length,h,e.carouselState.current),n=0;n<o.length;++n)i[n]?o[n].style.display="flex":o[n].style.display="none";setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0)}function g(t){var i;!0===r.checkSetting(t.name)&&(i=t.name,_.isUndefined(_.find(e.bucket,{name:i})))&&(e.bucket.push(t),y()),p()}function u(){h=c.getCurrentNumberOfColumns(),e.carouselState.numberOfSlides=Math.ceil(e.bucket.length/h),n(d)}function p(){e.isVisible=e.bucket.length>0,o.digestIfDigestNotInProgress(e),u()}var m,f,h=c.getCurrentNumberOfColumns();e.bucket=[],e.carouselState={},e.carouselState.current=0,e.range=function(e){return new Array(e)},e.goTo=function(t){e.carouselState.current=t,d()},e.showNextPage=function(){e.carouselState.current<e.carouselState.numberOfSlides-1&&(e.carouselState.current++,d())},e.showPrevPage=function(){e.carouselState.current>0&&(e.carouselState.current--,d())},e.showNextPageIfTouch=function(){a.isTouchEnabled()&&e.showNextPage()},e.showPrevPageIfTouch=function(){a.isTouchEnabled()&&e.showPrevPage()};var v=a.getLocalizedStrGenerator(kA);e.titleLoc=v(e.titleStr,"title-str"),e.subtitleLoc=v(e.subtitleStr,"subtitle-str"),e.reminderDaysLoc=v(e.reminderDays,"reminder-days"),e.viewmoreLoc=v(e.viewMoreStr,"viewmorestr"),e.customizeavatartitleLoc=v(e.customizeavatartitleStr,"customizeavatartitlestr"),e.customizeavatarmessageLoc=v(e.customizeavatarmessageStr,"customizeavatarmessagestr"),e.customizeavatarbuttontextLoc=v(e.customizeavatarbuttontextStr,"customizeavatarbuttontextstr"),e.customizeavatarlinktextLoc=v(e.customizeavatarlinktextStr,"customizeavatarlinktextstr"),e.achievementvisibilityTitleLoc=v(e.achievementvisibilitytitleStr,"achievementvisibilitytitlestr"),e.achievementvisibilitymessageLoc=v(e.achievementvisibilitymessageStr,"achievementvisibilitymessagestr"),e.achievementvisibilitybuttontextLoc=v(e.achievementvisibilitybuttontextStr,"achievementvisibilitybuttontextstr"),e.achievementvisibilitylinktextLoc=v(e.achievementvisibilitylinktextStr,"achievementvisibilitylinktextstr"),e.profilevisibilitytitleLoc=v(e.profilevisibilitytitleStr,"profilevisibilitytitlestr"),e.profilevisibilitymessageLoc=v(e.profilevisibilitymessageStr,"profilevisibilitymessagestr"),e.profilevisibilitybuttontextLoc=v(e.profilevisibilitybuttontextStr,"profilevisibilitybuttontextstr"),e.profilevisibilitylinktextLoc=v(e.profilevisibilitylinktextStr,"profilevisibilitylinktextstr"),e.originemailstitleLoc=v(e.originemailstitleStr,"originemailstitlestr"),e.originemailsmessageprivacylinktextstrLoc=v(e.originemalsmessageprivacylinktextStr,"originemailsmessageprivacylinktextstr"),e.originemailsmessageprivacylinkhrefLoc=v(e.originemailsmessageprivacylinkHref,"originemailsmessageprivacylinkhref"),e.originemailsmessagecontactlinkLoc=v(e.originEmailsMessageContactLinkStr,"originemailsmessagecontactlinktextstr"),e.originemailsmessageLoc=v(e.originemailsmessageStr,"originemailsmessagestr",{"%privacycookiepolicy%":'<a class="origin-tile-support-text-link otka getstarted-a" ng-click="onPrivacyClicked()" href="javascript:void(0)">'+e.originemailsmessageprivacylinktextstrLoc+"</a>","%contactea%":function(e){return'<a class="origin-tile-support-text-link otka getstarted-a" ng-click="onContactClicked()" href="javascript:void(0)">'+e+"</a>"}(e.originemailsmessagecontactlinkLoc)}),e.originemailsconfirmationLoc=v(e.originemailsconfirmationStr,"originemailsconfirmationstr",{"%email%":Origin.user.email()}),e.originemailsbuttontextLoc=v(e.originemailsbuttontextStr,"originemailsbuttontextstr"),e.originemailslinktextLoc=v(e.originemailslinktextStr,"originemailslinktextstr"),e.contacteadialogtitleLoc=v(e.contacteadialogtitleStr,"contacteadialogtitlestr"),e.contacteadialogmessageLoc=v(e.contacteadialogmessageStr,"contacteadialogmessagestr"),e.contacteadialogbuttontextLoc=v(e.contacteadialogbuttontextStr,"contacteadialogbuttontextstr"),e.realnametitleLoc=v(e.realnametitleStr,"realnametitlestr"),e.realnamemessageLoc=v(e.realnamemessageStr,"realnamemessagestr"),e.realnamebuttontextLoc=v(e.realnamebuttontextStr,"realnamebuttontextstr"),e.realnamelinktextLoc=v(e.realnamelinktextStr,"realnamelinktextstr"),e.verifyemailtitleLoc=v(e.verifyemailtitleStr,"verifyemailtitlestr"),e.verifyemailmessageLoc=v(e.verifyemailmessageStr,"verifyemailmessagestr"),e.verifyemailconfirmationLoc=v(e.verifyemailconfirmationStr,"verifyemailconfirmationstr",{"%email%":Origin.user.email()}),e.verifyemailbuttontextLoc=v(e.verifyemailbuttontextStr,"verifyemailbuttontextstr"),e.verifyemaillinktextLoc=v(e.verifyemaillinktextStr,"verifyemaillinktextstr"),e.twofactorauthtitleLoc=v(e.twofactorauthtitleStr,"twofactorauthtitlestr"),e.twofactorauthmessageLoc=v(e.twofactorauthmessageStr,"twofactorauthmessagestr"),e.twofactorauthbuttontextLoc=v(e.twofactorauthbuttontextStr,"twofactorauthbuttontextstr"),e.twofactorauthlinktextLoc=v(e.twofactorauthlinktextStr,"twofactorauthlinktextstr");var b={getStartedCustomAvatar:{image:l.getImagePath("getstarted\\completeProfile_customizeAvatar.png"),title:e.customizeavatartitleLoc,msg:e.customizeavatarmessageLoc,buttonText:e.customizeavatarbuttontextLoc,linkText:e.customizeavatarlinktextLoc,externalLink:"true",href:"eaAccounts",name:"getStartedCustomAvatar"},getStartedAchievementVisibility:{image:l.getImagePath("getstarted\\completeProfile_achievementVisibility.png"),title:e.achievementvisibilityTitleLoc,msg:e.achievementvisibilitymessageLoc,buttonText:e.achievementvisibilitybuttontextLoc,linkText:e.achievementvisibilitylinktextLoc,externalLink:"true",href:"accountPrivacySettings",name:"getStartedAchievementVisibility"},getStartedProfileVisibility:{image:l.getImagePath("getstarted\\completeProfile_profileVisibility.png"),title:e.profilevisibilitytitleLoc,msg:e.profilevisibilitymessageLoc,buttonText:e.profilevisibilitybuttontextLoc,linkText:e.profilevisibilitylinktextLoc,externalLink:"true",href:"accountPrivacySettings",name:"getStartedProfileVisibility"},getStartedOriginEmail:{image:l.getImagePath("getstarted\\completeProfile_optin.png"),title:e.originemailstitleLoc,msg:e.originemailsmessageLoc,msgHref:e.originemailsmessageprivacylinkhrefLoc,buttonText:e.originemailsbuttontextLoc,linkText:e.originemailslinktextLoc,confirmationStr:e.originemailsconfirmationLoc,externalLink:"false",tileAction:function(){return r.sendOptinEmailSetting()},name:"getStartedOriginEmail"},getStartedRealName:{image:l.getImagePath("getstarted\\completeProfile_realName.png"),title:e.realnametitleLoc,msg:e.realnamemessageLoc,buttonText:e.realnamebuttontextLoc,linkText:e.realnamelinktextLoc,externalLink:"true",href:"eaAccounts",name:"getStartedRealName"},getStartedVerifyEmail:{image:l.getImagePath("getstarted\\completeProfile_emailVerification.png"),title:e.verifyemailtitleLoc,msg:e.verifyemailmessageLoc,buttonText:e.verifyemailbuttontextLoc,linkText:e.verifyemaillinktextLoc,confirmationStr:e.verifyemailconfirmationLoc,externalLink:"false",tileAction:function(){return r.sendEmailVerification()},name:"getStartedVerifyEmail"},getStartedTwofactorAuth:{image:l.getImagePath("getstarted\\completeProfile_twoFactorAuthentication.png"),title:e.twofactorauthtitleLoc,msg:e.twofactorauthmessageLoc,buttonText:e.twofactorauthbuttontextLoc,linkText:e.twofactorauthlinktextLoc,externalLink:"true",href:"accountSecuritySettings",name:"getStartedTwofactorAuth"}},y=_.throttle(function(){e.bucket=r.shuffleAndSortBucket(e.bucket),e.$digest()},200,{leading:!1});e.$on("$destroy",function(){m&&m.detach(),f&&f.detach()}),m=r.events.on("getstarted:settingChanged",function(t){_.remove(e.bucket,function(e){return e.name===t}),p()}),f=r.events.on("getstarted:tileAdded",function(e){var t=_.get(b,wA[e.name]);t&&(t.priority=parseInt(_.get(e,"priority",0))||0,g(t))}),r.setRemindMeLater(e.reminderDaysLoc),r.getData().then(function(t){t&&(e.isVisible=!0,e.$digest(),u())}),s.addResizeEventHandler(e,function(){var t=c.computeCarouselState(e.carouselState,h,e.bucket.length);t.carouselChanged&&(e.carouselState=t.carouselState,h=t.itemsPerPage,d())},10)}function _n(e,t,i,n,r,o){"ngInject";var a=null;e.shouldShow=t.checkSetting(e.tile.name),e.titleLoc=o.getLocalizedStr(e.titleStr,PA,"titlestr"),e.msgLoc=o.getLocalizedStr(e.msgStr,PA,"msgstr"),e.btnLoc=o.getLocalizedStr(e.btnStr,PA,"btnstr"),e.remindLater=function(){t.dismiss(e.tile.name,(new Date).getTime())},e.onPrivacyClicked=function(){e.tile.msgHref&&Origin.windows.externalUrl(e.tile.msgHref)},e.onContactClicked=function(){r.openPrompt({id:"get-started-tile-contact-ea-id",name:"get-started-tile-contactEA",title:e.titleLoc,description:e.msgLoc,acceptText:"",acceptEnabled:!1,rejectText:e.btnLoc,defaultBtn:"yes"})},e.openUrlSSO=function(){if(e.tile.href){var t=i.getUrl(e.tile.href);Origin.client.isEmbeddedBrowser()||(t=(t=t.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),n.asyncOpenUrlWithEADPSSO(t)}},this.handleDismiss=function(){var i=Origin.client.isEmbeddedBrowser()?"client":"web",n=_.get(e,["$parent","$parent","$parent","$parent","titleLoc"])||"";return Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"message",i,"success",{type:"in-game",service:"originx",format:"live_tile",client_state:"foreground",msg_id:e.tile.ctid?e.tile.ctid:e.tile.image,status:"click",content:e.msgLoc,destination_name:n}),"true"!==e.tile.externalLink?(e.tile.tileAction&&e.tile.tileAction(),!0):(e.openUrlSSO(),t.dismiss(e.tile.name),!1)},this.factoryDismiss=function(){t.dismiss(e.tile.name)},e.supportTextVisible=e.tile.title.length>0||e.tile.msg.length>0,a=t.events.on("getstarted:settingChanged",function(t){t===e.tile.name&&(e.shouldShow=!1)}),e.$on("$destroy",function(){a&&a.detach()})}function On(e,t,i){"ngInject";return{restrict:"E",replace:!0,scope:{tile:"=",btnStr:"@btnstr",titleStr:"@titlestr",msgStr:"@msgstr"},controller:_n,link:function(n,r,o,a){var s=_.get(n,"tile.msg");if(s){var c=i.addOtkClasses(s);r.find(".origin-tile-support-text-paragraph").append(e("<span>"+c+"</span>")(n))}n.dismiss=function(){a.handleDismiss()&&(r[0].classList.add("confirmed"),t(function(){a.factoryDismiss()},4e3,!1))}},template:TA}}function En(e,t){"ngInject";var i={name:OA[e.tileName],priority:e.priority};t.events.fire("getstarted:tileAdded",i)}function Fn(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{layouttype:"@",titleStr:"@",subtitleStr:"@"},transclude:!0,template:LA,link:function(o,a){function s(){var e,t,i=l.find(RA);for(e=n.getItemVisiblity(i.length,g,o.carouselState.current),t=0;t<i.length;++t)e[t]?i[t].style.display="block":i[t].style.display="none";setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0)}var c,l=a.find(".origin-home-merchtiles"),d=l.children(),g=n.getCurrentNumberOfColumns();o.carouselState={},o.carouselState.current=0,o.titleStr=i.getLocalizedStr(o.titleStr,DA,"title-str"),o.subtitleStr=i.getLocalizedStr(o.subtitleStr,DA,"subtitle-str"),o.showNextPage=function(){o.carouselState.current<o.carouselState.numberOfSlides-1&&(o.carouselState.current++,s())},o.showPrevPage=function(){o.carouselState.current>0&&(o.carouselState.current--,s())},o.showNextPageIfTouch=function(){i.isTouchEnabled()&&o.showNextPage()},o.showPrevPageIfTouch=function(){i.isTouchEnabled()&&o.showPrevPage()},o.goTo=function(e){o.carouselState.current=e,s()},o.range=function(e){return new Array(e)},"ITO"!==e.source?d.length&&(c=o.layouttype===AA.one||1===d.length?1:2,d.slice(c).remove(),o.visible=!0,r.addResizeEventHandler(o,function(){var e=n.computeCarouselState(o.carouselState,g,c);e.carouselChanged&&(o.carouselState=e.carouselState,g=e.itemsPerPage,s())},10),o.carouselState.numberOfSlides=Math.ceil(c/g),t(s)):o.visible=!1}}}function xn(e){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{ctid:"@",imagepath:"@",headline:"@",subheadline:"@",text:"@",promoCode:"@",legalDisclaimerText:"@",legalDisclaimerLinkText:"@",legalDisclaimerDialogHeaderText:"@",legalDisclaimerDialogBodyTitleText:"@",legalDisclaimerDialogBodyText:"@"},template:NA,controller:"OriginHomeMerchandiseTileCtrl",link:function(t){var i,n;t.textColor=GA[t.textColor]||GA.dark,t.textColorClass="origin-home-merchandise-text-color-"+t.textColor,t.textFormatted=e.getLocalizedStr(t.text,UA,"text",{"%promo-code%":(i=t.promoCode,n="",i&&(n='<span class="origin-home-merchtile-promocode-promocode">'+i+"</span>"),n)})}}}function Ln(e,t,i,n){"ngInject";function r(t){var i,r={"%callout-text%":(i=e.calloutText,i?'<span class="callout-text">'+i+"</span>":"")};e.useDynamicPriceCallout?n.insertPriceIntoLocalizedStr(e,e.strings,e[t],jA,t,r):e.useDynamicDiscountPriceCallout?n.insertDiscountedPriceIntoLocalizedStr(e,e.strings,e[t],jA,t,r):e.useDynamicDiscountRateCallout?n.insertDiscountedPercentageIntoLocalizedStr(e,e.strings,e[t],jA,t,r):n.insertPriceIntoLocalizedStr(e,e.strings,e[t],jA,t,r)}e.showpricing=t.showpricing&&t.showpricing===MA.true,e.isTouchDisable=!i.isTouchEnabled(),e.strings={},r("text"),r("headline"),e.$on("cta:clicked",function(t,i){var n=Origin.client.isEmbeddedBrowser()?"client":"web",r=_.get(e,["$parent","$parent","titleStr"])||_.get(e,["$parent","$parent","$parent","titleStr"])||"";i=i||"live_tile",t.stopPropagation(),Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"message",n,"success",{type:"in-game",service:"originx",format:i,client_state:"foreground",msg_id:e.ctid?e.ctid:e.image,status:"click",content:e.text,destination_name:r})})}function An(e,t,i,n){"ngInject";e.dismiss=function(){e.class="origin-message-collapsible-iscollapsed",t.setGeneralSetting("new_user_home_seen",!0)},e.titleStr=i.getLocalizedStr(e.titleStr,zA,"title-str"),e.subtitle=i.getLocalizedStr(e.subtitleStr,zA,"subtitle"),e.linkcta=i.getLocalizedStr(e.linkctaStr,zA,"linkcta"),e.show=!1,t.getGeneralSettings().then(function(t){e.show=!t.new_user_home_seen}).catch(function(t){n.error("[origin-home-newuser-tile]:retrieveSettings FAILED:",t),e.show=!0})}function Dn(e,t,i){"ngInject";e.openLink=function(e){t.openLink(e)},e.gaLabel=(i.isActive()?"Subscriber":"Non-Subscriber")+" - "+WA[e.tileType]}function Rn(e,t){"ngInject";var i=Origin.user.originId();e.localizedTitle=t.getLocalizedStr(e.titleStr,YA,"title-str").replace("%username%",i),e.localizedSubtitle=t.getLocalizedStr(e.subtitleStr,YA,"subtitle-str")}function $n(e,t){"ngInject";e.notAvailableLoc=t.getLocalizedStr(e.notAvailableStr,JA,"notavailablestr")}function Nn(e,t){"ngInject";e.titleStr=t.getLocalizedStr(e.titleStr,ZA,"title-str"),e.description=t.getLocalizedStr(e.descriptionStr,ZA,"description")}function Gn(e,t,i,n,r,o){"ngInject";function a(t){e.avatarNucleusIds=_.get(t,"list"),e.$digest()}r.getFriendsPlayingObservable(e.offerId).then(function(t){t&&n.create(t).onUpdate(e,a)});var s=o.events.on("tileAchievements_broadcast:show:"+e.offerId,function(t){e.adjustForAchievements=t.show,e.$digest()});e.$on("$destroy",function(){return s.detach()})}function Un(e,t,i){"ngInject";function n(){e.showNotification=!0,e.$digest()}var r;r=i.events.on("suggestRefresh",n),e.description=t.getLocalizedStr(e.descriptionStr,iD,"description"),e.showNotification=!1,e.refresh=i.refresh,e.$on("$destroy",r.detach),i.refreshSuggested()&&e.refresh(!0)}function Bn(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b){"ngInject";function y(e){return function(i,n,r,o){_.isFunction(r.clickAction)&&_.isBoolean(r.disabled)&&!r.disabled&&(!i||n&&"PCWIN"===Origin.utils.os())?r.clickAction():t.getBaseGameEntitlementByMasterTitleId(o.masterTitleId).then(function(e,t,i,n){return function(r){r||i&&!n?f.goToState("app.game_gamelibrary_wrapper.library.ogd",{offerid:t}):l.goToPdp(e)}}(o,e,i,n))}}e.titleStr=r.getLocalizedStr(e.titleStr,rD,"title-str"),m.getQuickLaunchList().then(function(t){e.lastPlayedGames=t,v.digestIfDigestNotInProgress(e)}),u.registerXSmallHandlersIndexedOfferId(e),s.registerXSmallHandlersIndexedNucleusId(e),o.registerHandlersIndexedOfferId(e),o.registerClickHandler(e,function(e,t,i){f.goUserProfile(Origin.user.userPid(),"achievements"),i.stopPropagation()}),a.registerHandlersIndexedOfferId(e),c.registerSmallHandlersIndexedOfferId(e),c.registerClickHandler(e,function(e,r){var o=r.attrs.index,a=t.getEntitlement(o,{includeAllExternalTypes:!0}),s=a&&a.length?a[0].externalType:"";Promise.all([b.isSubscriptionEntitlement(o),g.isActive(),i.getButtonState(o,!0,{externalType:s}),n.getCatalogInfo([o]).then(d.getProperty(o))]).then(_.spread(y(o)))}),p.registerHandlersIndexedOfferId(e)}function Mn(e,t,i){"ngInject";var n=this,r=i.isSmall(),o={"%day%":moment().format("dddd"),"%user%":Origin.user.originId()};if(r)n.welcomeMessage=e.substitute(t.getLocalizedStr(n.welcomeMessageMobile,aD,"welcome-message"),o);else{var a=_.sample(_.compact(_.times(sD,function(e){return e++,t.getLocalizedStr(n["welcomeMessage"+e],aD,"welcome-message"+e)})))||"";n.welcomeMessage=e.substitute(a,o)}}function jn(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{sourceUrl:"@",iframeHeight:"@",iframeWidth:"@",scrollbars:"@",type:"@",modalSize:"@",modalTitleVerify:"@"},template:lD,link:function(o,a){function s(){o.iframeHeight=o.iframeHeight||dD,o.iframeWidth=o.iframeWidth||dD,t.unblockUI(),l.width(o.iframeWidth),l.height(o.iframeHeight),o.isReady=!0,o.$digest(),i.disableBodyScrolling()}var c=r.isOIGContext(),l=a.find("iframe");o.close=function(){i.enableBodyScrolling(),a.remove(),o.$destroy()},t.blockUI(),l.one("load",s),o.url=e.trustAsResourceUrl(o.sourceUrl),o.modalSize=_.isString(o.modalSize)&&pD[o.modalSize.toUpperCase()]||pD.DEFAULT,o.titleStr=mD[o.type]?n.getLocalizedStr(!1,gD,mD[o.type]):"",c&&a.addClass(uD)}}}function Hn(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";var u=vD;return{restrict:"E",scope:{sourceUrl:"@",originUrl:"@",type:"@",loadingTitle:"@",loadingMessage:"@",telemetryData:"<"},template:hD,link:function(i,p){function m(t){if(!(i.type===c.DEFAULT_OIG||i.type===c.TOPUP_OIG||e.isOIGContext()&&i.type===c.CHAINED)){var n=p.parents(bD).height();k=t=t||k,t=a.adjustHeightForScreenSizes(t,n,l.isSmall()),I.height(t)}}function f(e){r.unblockUI(),Origin.performance.endTime("COMPONENTSPERF:checkoutHandshake"),Origin.telemetry.sendCheckoutErrorEvent(e),s.events.fire("origin-iframe:error",e),o.handleError(e)}function h(){r.unblockUI(),s.events.fire("origin-iframe:ready"),m(angular.element("body").outerHeight()-160),setTimeout(function(){S.send({method:"display"})},500),Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:checkoutHandshake")}function v(){S.send({method:"telemetryInfo",payload:{utag:Object.assign({gdprConsented:g.hasConsentedToAds()},window.utag_data)}})}function b(){Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:loadLockBox"),Origin.performance.beginTime("COMPONENTSPERF:checkoutHandshake"),function(e){var t={};t[u.PAYMENT_START]=o.onPaymentStart,t[u.REDIRECT_PAYMENT_PROVIDER_PREPARE]=o.paymentProviderRedirectPrepare,t[u.REDIRECT_PAYMENT_PROVIDER_READY]=_.partial(o.paymentProviderRedirectReady,i.type),t[u.REDIRECT_PAYMENT_PROVIDER_CANCEL]=o.paymentProviderRedirectCancel,t[u.SEND_MARKETING_EVENT]=o.sendMarketingEvent,t[u.SEND_TRANSACTION_EVENT]=o.sendTransactionEvent,t[u.SEND_TRANSACTION_EVENT]=_.partial(o.updateWishlist,i.type),t[u.TEALIUM_READY_EVENT]=v,t[u.CONTINUE_SHOPPING]=o.close,t[u.SET_CUSTOM_DIMENSION]=o.setCustomDimension,t[u.SIZE_CHANGE]=m,t[u.CONTINUE_IN_BROWSER]=o.startClient2WebFlow,t[u.PAYMENT_SUCCESS]=o.onPaymentSuccess,t[u.OPEN_LINK]=o.openLink,t[u.DOWNLOAD_ORIGIN]=o.downloadOrigin,t[u.DOWNLOAD_GAME]=o.downloadGame,t[u.BACK_TO_GAME]=o.backToGame,t[u.ERROR]=f,t[u.TRACKING]=_.partialRight(o.sendTrackingEvent,i.type,i.telemetryData),t[u.PAYMENT_COMPLETE]=function(){return o.events.fire(Ey.t)},t[u.PAYMENT_INCOMPLETE]=function(){return o.events.fire(Ey.r)},t[u.PENDING_SUBSCRIPTION]=d.handlePendingSubscription.bind(d),t[u.UPGRADE_REFUND_FAILURE]=d.showUpgradeRefundErrorPrompt.bind(d),t[u.PAYMENT_PROCESS_START]=o.onPaymentProcessStart,e.subscribeToEvents(t)}(S=t.createInstance(i.originUrl,I)),S.handshake().then(h).catch(f)}function y(){setTimeout(function(){angular.isDefined(S)&&S.destroy()},1e3)}var S,k,I=p.find("iframe");r.blockUI(),I.one("load",b),I.one("$destroy",y),I.attr("src",i.sourceUrl),n.addResizeEventHandler(i,m,100)}}}function zn(e,t,i,n){"ngInject";return{restrict:"E",scope:{sourceUrl:"@",originUrl:"@",type:"@",telemetryData:"<"},template:yD,link:function(e,r){function o(){s(),g()}function a(){c(!1)}function s(){c(!0)}function c(t){e.closeEnabled=t,e.$digest()}function l(){e.isReady=!0,e.$digest(),i.disableBodyScrolling()}function d(){t.events.off(Ey.p,g),t.events.off(SD,l),n.events.off(Ey.s,a),n.events.off(Ey.t,s),n.events.off(Ey.r,s),n.events.off(Ey.q,a),t.events.off(kD,o)}function g(){i.enableBodyScrolling(),r.remove(),e.$destroy()}e.closeEnabled=!0,e.close=function(){t.events.fire(Ey.p)},t.events.on(Ey.p,g),t.events.on(SD,l),n.events.on(Ey.s,a),n.events.on(Ey.t,s),n.events.on(Ey.r,s),n.events.on(Ey.q,a),t.events.on(kD,o),e.$on("$destroy",d)}}}function Vn(e,t,i,n,r,o,a,s,c,l){"ngInject";return{restrict:"E",scope:{sourceUrl:"@",originUrl:"@",type:"@",gameTitle:"@",artUrl:"@",offerId:"@",loadingTitle:"@",loadingMessage:"@"},template:hD,link:function(t,o){function d(e){var t=o.parents(ID).height();v=e=e||v,e=r.adjustHeightForScreenSizes(e,t,l.isXSmall()),f.height(e)}function g(e){n.unblockUI(),a.events.fire(c.ERROR,e)}function u(){n.unblockUI(),a.events.fire(c.READY),d(angular.element("body").outerHeight()-160),h.send({method:"display"})}function p(){(function(e){var t={};t[s.SIZE_CHANGE]=d,t[s.ERROR]=g,t[s.DOWNLOAD_GAME]=a.downloadRedemption,t[s.DOWNLOAD_ORIGIN]=a.downloadOrigin,t[s.OPEN_LINK]=a.openLink,t[s.REDEEM_CANCEL]=a.events.fire.bind(a.events,c.EXIT),t[s.REDEEM_SUCCESS]=a.events.fire.bind(a.events,c.SUCCESS),t[s.CONTINUE_LAUNCH]=a.events.fire.bind(a.events,c.SUCCESSEXIT),t[s.CONTINUE_INSTALL]=a.events.fire.bind(a.events,c.SUCCESSEXIT),t[s.CONTINUE_SHOPPING]=a.continueShopping,t[s.REDEEM_SUCCESS_SUBS_NUX]=a.subscriptionSignup,t[s.REDEEM_SUCCESS_SUBS_ADDTIME]=a.subscriptionAddTime,e.subscribeToEvents(t)})(h=e.createInstance(t.originUrl,f)),h.handshake(t.type,t.gameTitle,t.artUrl,t.offerId).then(u).catch(g)}function m(){setTimeout(function(){angular.isDefined(h)&&h.destroy()},1e3)}var f=o.find("iframe"),h=void 0,v=void 0;n.blockUI(),f.attr("id","redeem-iframe"),f.one("load",p),f.one("$destroy",m),f.attr("src",t.sourceUrl),i.addResizeEventHandler(t,d,100)}}}function Wn(e,t,i,n){"ngInject";return{restrict:"E",scope:{sourceUrl:"@",originUrl:"@",type:"@",gameTitle:"@",artUrl:"@",offerId:"@"},template:CD,link:function(r,o){function a(){e.enableBodyScrolling(),o.remove(),r.$destroy()}function s(){g=!0}function c(){s(),a()}function l(){r.isReady=!0,r.$digest(),setTimeout(function(){o.find("."+TD).hide().removeClass(TD).show()},0),e.disableBodyScrolling()}function d(){window.removeEventListener("unload",d),Origin.client.isEmbeddedBrowser()&&(Origin.client.games.redeemProductCodeClosed(g),n.isOIGContext()&&(Origin.client.oig.closeIGOSPA(),Origin.client.oig.closeIGO(),window.close())),t.events.off(i.EXIT,a),t.events.off(i.ERROR,a),t.events.off(i.READY,l),t.events.off(i.SUCCESS,s),t.events.off(i.SUCCESSEXIT,c)}var g=!1;r.isReady=!1,r.onClickClose=function(){t.events.fire(i.EXIT)},window.addEventListener("unload",d),t.events.on(i.EXIT,a),t.events.on(i.ERROR,a),t.events.on(i.READY,l),t.events.on(i.SUCCESS,s),t.events.on(i.SUCCESSEXIT,c),r.$on("$destroy",d)}}}function qn(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Yn(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b){"ngInject";function y(e,t){var i=t.giftId||"",n=p.md5(i+t.offerId+e);return _.merge(t,{notificationType:e},{id:n})}function S(e){o.error("[origin-inbox-data-retrieval] error",e)}function k(e){var t=_.get(n.getEntitlement(e.offerId),"grantDate"),i=_.get(e,[DI._15,Origin.utils.os(),DI._21]);return s.isRecentlyReleasedInDays(Origin.utils.os(),UD)(e)&&!s.isExpired(Origin.utils.os())(e)&&e.downloadable&&t<i}function I(e){return e.filter(k)}function w(t){var i,n,r,o=e.getPremierNewEntitledInboxItemsFromStorage(),a=_.some(o,function(e){return e===t.offerId});return i=t.offerId,n=e.getPremierInboxItemsTimeStampFromStorage(),r=new Date(n[i]),(_.isUndefined(n[i])||!c.isValidDate(r)||r.setHours(r.getHours()+BD)>=Date.now())&&!a}function C(e){return Object.values(e).filter(w)}function T(e){return _.compact(e)}function P(e){var t,i,n=Origin.utils.os();return t=_.filter(e,function(e){var t=_.get(e,["platforms",n,"downloadStartDate"]);return M(t)&&!s.isReleased(n)(e)&&e.downloadable}),i=_.map(t,function(e){return function(e){return r.getGamePromise(e.offerId).then(a.getProperty("installed")).then(function(t){if(!t)return e})}(e).catch(S)}),Promise.all(i).then(T)}function O(){return l.concat.apply(this,arguments)}function E(e,t){var i=function(e){if(W(e)){var t=(new Date).getTime()-e.getTime();return q(t)}}(function(e){var t=void 0;return t=e.notificationType===LD?e.originSubscriptionUnlockDate?Q[e.notificationType].unlockDateId:Q[e.notificationType].releaseDateId:Q[e.notificationType].dateId,new Date(e[t])}(e)),n=void 0;return i&&e.notificationType!==OD?i.days>0?(n={"%days%":i.days},g.getLocalizedStr(!1,t,"daysago",n,i.days)):i.hours>0?(n={"%hours%":i.hours},g.getLocalizedStr(!1,t,"hoursago",n,i.hours)):i.minutes>0?(n={"%minutes%":i.minutes},g.getLocalizedStr(!1,t,"minutesago",n,i.minutes)):(n={"%seconds%":i.seconds},g.getLocalizedStr(!1,t,"secondsago",n,i.seconds)):i&&e.notificationType===OD?(n={"%days%":i.days},g.getLocalizedStr(!1,t,"daysago",n,i.days)):""}function F(e,t,i,n){var r={id:e.id,notificationType:e.notificationType,offerId:e.offerId,image:t,timeSent:i,gdpPath:e.gdpPath};return _.merge(r,n)}function x(e){return Promise.all([function(e){return e.notificationType===OD?d.getAvatar(e.senderPersonaId,Origin.defines.avatarSizes.LARGE).catch(function(e){return o.error("OriginInboxItemCtrl: UserDataFactory.getAvatar failed",e),Y}):Promise.resolve(_.get(e,"image"))}(e),E(e,VD),function(e,t){var i=Q[e.notificationType];return Promise.resolve({title:g.getLocalizedStr(!1,t,i.titleStrId),description:g.getLocalizedStr(!1,t,i.descStrId,{"%name%":e[i.nameId]})})}(e,VD)]).then(_.spread(_.partial(F,e))).catch(S)}function L(e){var t=_.map(e,x);return Promise.all(t).then(T)}function A(e){return e.isUnread="true",e}function D(t){var i=e.getInboxItemsFromStorage();if(i){var n=_.map(_.differenceBy(t,i,"id"),A);return _.union(t,n)}return t}function R(t){_.forEach(t,function(t){if(f.isInPremierGameNotificationList(t)){var i=e.getPremierNewEntitledInboxItemsFromStorage();-1===i.indexOf(t)&&(i.push(t),e.setPremierNewEntitledInboxItemsInStorage(i))}})}var $,N,G,U,B,M=c.isInThePast,j=a.transformWith,H=a.mapWith,z=a.toArray,V=a.forEachWith,W=c.isValidDate,q=c.getCountdownDataFromTimeRemaining,Y=u.getImagePath("social//avatar_placeholder.png"),K={title:[DI.I,DI.k],image:[DI.I,DI._10],releaseDate:[DI._15,Origin.utils.os(),DI._21],originSubscriptionUnlockDate:[DI._15,Origin.utils.os(),DI._28],downloadStartDate:[DI._15,Origin.utils.os(),DI.m],offerId:DI.Y,gdpPath:DI.E},Q=(qn(B={},OD,(qn($={},AD,"gifttitlestr"),qn($,DD,"giftdescstr"),qn($,RD,"senderName"),qn($,$D,"sendDate"),$)),qn(B,FD,(qn(N={},AD,"preloadtitlestr"),qn(N,DD,"preloaddescstr"),qn(N,RD,"title"),qn(N,$D,"downloadStartDate"),N)),qn(B,xD,(qn(G={},AD,"availabletitlestr"),qn(G,DD,"releaseddescstr"),qn(G,RD,"title"),qn(G,$D,"releaseDate"),G)),qn(B,LD,(qn(U={},AD,"availabletitlestr"),qn(U,DD,"releaseddescstr"),qn(U,RD,"title"),qn(U,ND,"releaseDate"),qn(U,GD,"originSubscriptionUnlockDate"),U)),B);return m.isPremiumSubscriber()||e.cleanInboxPremierNotificationItems(),v.events.on(Ey.A,R),h.events.on(Ey.A,R),{retrieveInboxData:function(){return Promise.all([(e=t.getUnopenedGifts(),e=_.map(e,_.partial(y,OD)),Promise.resolve(e)),b.isNoCommerceContext()?Promise.resolve([]):i.getBaseGameCatalog().then(P).then(H(j(K))).then(V(_.partial(y,FD))).then(z).catch(S),m.isPremiumSubscriber()||b.isNoCommerceContext()?Promise.resolve([]):i.getBaseGameCatalog().then(I).then(H(j(K))).then(V(_.partial(y,xD))).then(z).catch(S),m.isPremiumSubscriber()&&!b.isNoCommerceContext()?Promise.resolve(f.getPremierGameNotificationList()).then(C).then(H(j(K))).then(V(_.partial(y,LD))).then(z).catch(S):Promise.resolve()]).then(_.spread(O)).then(L).then(D).catch(S);var e}}}function Kn(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";function m(e){n.goToOgd({offerId:e})}function f(e){u.getGameDataWithEntitlements([e]).then(Object.values).then(function(e){var t,i,n=jD(e,1)[0];p.isOwned(n)?(t=n.offerId,(i=g.getPremierInboxItemsTimeStampFromStorage())[t]=Date.now(),g.setPremierInboxItemsTimeStampInStorage(i),m(n.ogdOfferId)):r.goToGdp(n.gdpPath)}).catch(function(e){d.error("[OriginInboxCtrl]: unable to retrieve game entitlement status",e)})}var h=o.getLocalizedStrGenerator(VD);e.strings={notificationsEmptyLoc:h(e.notificationsEmptyStr,"notifications-empty-str"),NOTIFICATION_GIFT:OD},e.onItemClick=function(e,t){var n,r,o;e.preventDefault(),e.stopPropagation(),t.notificationType===OD?(o=t.offerId,i.events.fire(Ey.M,bI.y,{offerId:o})):t.notificationType===ED?(r=t.token,i.events.fire(Ey.M,bI._2,{token:r})):t.notificationType===xD||t.notificationType===FD?Origin.client.isEmbeddedBrowser()?(n=t,c.getGamePromise(n.offerId).then(l.getProperty(zD)).then(function(e){e?Origin.client.games.play(n.offerId):Origin.client.games.startDownload(n.offerId)}).catch(function(e){d.error("[OriginInboxCtrl]: unable to retrieve game installed state",e)})):m(t.offerId):t.notificationType===LD&&f(t.offerId),s.handleMenuClick()},t.getObserver(e,o.unwrapPromiseAndCall(function(t){e.items=t.items,a.digestIfDigestNotInProgress(e)}))}function Qn(e){"ngInject";return{restrict:"E",scope:{notificationsEmptyStr:"@"},controller:Kn,template:_D,link:function(t){function i(e){e.stopPropagation();var t=_.get(e,["originalEvent","deltaY"])||_.get(e,["originalEvent","detail"]),i=n[0];return!_.isUndefined(t)&&t<0?i.scrollTop>0:i.scrollTop+i.offsetHeight<i.scrollHeight}var n=angular.element(HD);t.$on("$destroy",function(){n.unbind("wheel",i)}),n.bind("wheel",i),setTimeout(function(){e.events.fire(e.events.INBOX_FLY_OUT_READY)},0)}}}function Jn(e,t,i,n,r,o,a){"ngInject";function s(){e.isOffline=!n.isClientOnline()}var c=i.getLocalizedStrGenerator(YD),l=[];e.unreadItemsCount=0,e.isShown=!1,e.strings={notificationsLoc:c(e.notificationsStr,"notifications-str"),notificationsTitleLoc:c(e.notificationsTitleStr,"notifications-title-str")},this.storeItemsInStorage=function(){_.size(e.items)>0&&a.setInboxItemsInStorage(e.items)},s(),l=[n.events.on("myauth:clientonlinestatechanged",function(t){t&&(s(),e.$digest())})],e.$on("$destroy",function(){r.detachAll(l)}),e.showMessage=function(){return e.isOffline||0===e.unreadItemsCount},o.getObserver(e,i.unwrapPromiseAndCall(function(i){e.unreadItemsCount=i.unreadItemsCount,e.items=i.items,t.digestIfDigestNotInProgress(e)}))}function Xn(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{notificationsStr:"@",notificationsTitleStr:"@"},controller:Jn,template:qD,link:function(a,s,c,l){function d(){var e=s.find("."+ZD);e.hasClass(ZD)&&(e.addClass(eR),l.storeItemsInStorage(),a.unreadItemsCount=0,a.$digest()),o.events.fire(o.events.INBOX_FLY_OUT_VISIBLE)}function g(){f=e(d,1e3)}function u(){var t;a.isShown=!1,y.removeClass(tR),(t=s.find("."+ZD)).hasClass(eR)&&t.removeClass(eR).removeClass(ZD),f&&e.cancel(f)}function p(){h>0&&i.isSmall()?angular.element(XD).css("margin-top",h):angular.element(XD).css("margin-top","0px")}var m,f,h=0,v=angular.element(QD),b=angular.element(JD),y=angular.element(KD);a.handleMobileClick=function(e,n){e.stopPropagation(),i.isSmall()&&(n?(a.isShown=!0,y.addClass(tR),g()):(u(),t.handleMenuClick()))},a.showFlyout=function(t){if(t.preventDefault(),!i.isSmall()){var n=angular.element(".origin-navigation-isoverflowing").length,r=b.position();v.css({top:r.top-rR,left:r.left+Math.round(b.outerWidth()*(n?nR:iR))}),e.cancel(m),a.isShown=!0,g()}},a.delayHideFlyout=function(t){t.preventDefault(),i.isSmall()||(e.cancel(m),m=e(u,250))},a.setFlyoutMarginForStripe=function(e){(h=e)>0?t.setInboxFlyout(!0):t.setInboxFlyout(!1),setTimeout(p,0)},a.$on("$destroy",function(){e.cancel(f),r.events.off("uiRouter:stateChangeSuccess",u),o.events.fire(o.events.INBOX_FLY_OUT_DESTROY)}),r.events.on("uiRouter:stateChangeSuccess",u),n.addResizeEventHandler(a,function(){!i.isSmall()&&a.isShown&&(a.isShown=!1,a.$digest())},100)}}}function Zn(e,t){"ngInject";var i=t.getLocalizedStrGenerator(sR);e.strings={notificationsOfflineLoc:i(e.notificationsOfflineStr,"notifications-offline-str")}}function er(e,t,i){"ngInject";return{restrict:"A",scope:{itemsGenerator:"&originContextMenu",clickEvent:"@?"},link:function(n,r){function o(e){var i=e.pageX+lR+"px",r=e.pageY+lR+"px",o=window.innerWidth,s=window.innerHeight,c=document.body.scrollTop,l=o-(e.pageX+lR),d=s-(e.pageY+lR),g=function(e){var t={};return e&&(t.setWidth=e.length?e.width():dR,t.setItemHeight=e.find(pR).first().height()||gR),t}(a.find(uR)),u=g.setWidth+lR;n.itemsGenerator().then(function(n){var o;n&&t.open(n,(o=n.length*g.setItemHeight,l<u&&(i=e.pageX-u+"px"),d+c<o&&(r=e.pageY-o+"px"),{top:r,left:i}))})}var a=angular.element(e[0].body),s=n.clickEvent||fR;r.on(s,o),n.$on("$destroy",function(){r.off(s,o)}),i.addResizeEventHandler(n,function(){t.close()},mR)}}}function tr(e,t,i){"ngInject";e.trustAsHtml=function(e){return t.trustAsHtml(e)};var n,r;e.titleLoc=i.getLocalizedStr(e.titleStr,"origin-offline-cta","titlestr"),e.descriptionOverrideStr&&e.descriptionOverrideStr.length?e.descriptionLoc=e.descriptionOverrideStr:e.descriptionLoc=i.getLocalizedStr(null,"origin-offline-cta","descriptionoverridestr").replace("%notavailable%",e.notAvailableStr).replace("%gamelibrary%",(n="game-library",r=i.getLocalizedStr(null,"origin-offline-cta","gamelibrarystr"),'<a class="otka" href="'+n+'">'+r+"</a>"))}function ir(e,t,i,n){"ngInject";function r(e){a=e,e?document.querySelector(".origin-offline-flyout").classList.add("otktooltip-isvisible"):document.querySelector(".origin-offline-flyout").classList.remove("otktooltip-isvisible")}var o=[],a=!1;e.descriptionLoc=t.getLocalizedStr(e.descriptionStr,"origin-offline-flyout","descriptionstr"),e.moveTooltipArrow=Origin.utils.os()===Origin.utils.OS_MAC,e.$on("$destroy",function(){i.detachAll(o)}),o[o.length]=n.events.on("myauth:clientonlinestatechangeinitiated",function(e){e&&e.isOnline&&r(!1)}),o[o.length]=Origin.events.on(Origin.events.CLIENT_CLICKEDOFFLINEMODEBUTTON,function(){r(!a)}),this.setVisibility=r,n.isClientOnline()||r(!0)}function nr(e,t,i,n,r,o){"ngInject";var a=[],s=void 0;e.goOnlineLoc=i.getLocalizedStr(e.goOnlineStr,wR,"goonlinestr"),e.reconnectingLoc=i.getLocalizedStr(e.reconnectingStr,wR,"reconnectingstr"),e.states={GO_ONLINE:"GO_ONLINE",RECONNECTING:"RECONNECTING"},e.state=e.states.GO_ONLINE,e.goOnline=function(){e.state=e.states.RECONNECTING,Origin.client.onlineStatus.goOnline(),s=t(function(){e.state=e.states.GO_ONLINE,o.reload()},2e3)},a[a.length]=n.events.on("myauth:clientonlinestatechanged",function(i){i&&i.isOnline&&(e.state=e.states.GO_ONLINE,t.cancel(s),o.reload())}),e.$on("$destroy",function(){return r.detachAll(a)})}function rr(e,t,i,n,r){"ngInject";function o(){e.isOffline=!i.isClientOnline()}var a=r.getLocalizedStrGenerator(TR),s=[];e.inClient=Origin.client.isEmbeddedBrowser(),e.strings={offlineTitleLoc:a(e.offlineTitleStr,"offlinetitlestr"),offlineReasonLoc:t.trustAsHtml(a(e.offlineReasonStr,"offlinereasonstr")),goOnlineLoc:a(e.goOnlineStr,"goonlinestr")},e.goOnline=function(){Origin.client.onlineStatus.goOnline()},o(),s=[i.events.on("myauth:clientonlinestatechanged",function(t){t&&o(),e.$digest()})],e.$on("$destroy",function(){n.detachAll(s)})}function or(e,t,i,n,r,o,a,s,c){"ngInject";function l(){e.checkoutActive=!0,e.$digest()}function d(){e.checkoutActive=!1,e.$digest()}function g(t){e.isOnline=t&&t.isOnline,e.$digest()}e.isStripeVisible=function(){return e.stripetitlestr&&e.stripebodystr},s.events.on(OR,l),s.events.on(ER,d),s.events.on(Lw,l),s.events.on(Aw,d),c.events.on(FR,g),e.$on("$destroy",function(){s.events.off(OR,l),s.events.off(ER,d),s.events.off(Lw,l),s.events.off(Aw,d),c.events.off(FR,g)}),e.whitelist=i.filterOfferIds?i.filterOfferIds.split(","):[],e.isOnline=c.isClientOnline(),a.getOdcProfileById(i.profile).then(function(i){e.titlestr=e.titlestr||i.checkoutMessage.titlestr,e.stripetitlestr=e.stripetitlestr||i.checkoutMessage.stripetitlestr,e.stripebodystr=e.stripebodystr||i.checkoutMessage.stripebodystr,e.stripeTitleLoc=t.trustAsHtml(n.getLocalizedStr(e.stripetitlestr,_R,"stripetitlestr")),e.stripeBodyLoc=t.trustAsHtml(n.getLocalizedStr(e.stripebodystr,_R,"stripebodystr")),e.blacklist=i.oigOfferBlacklist}).then(function(){var e=i.masterTitleId,t=r.getAllBaseGameEntitlementsByMasterTitleId(e),n=_.head(t);return n?Promise.resolve(n.offerId):o.getPurchasableOfferIdByMasterTitleId(e,!0)}).then(function(t){return e.baseGameOfferId=t,o.getCatalogInfo([t])}).then(function(i){var r=i[e.baseGameOfferId],o=r?r.i18n.displayName:"Unknown Game";e.titleLoc=t.trustAsHtml(n.getLocalizedStr(e.titlestr,_R,"titlestr",{"%game%":o})),e.$digest()})}function ar(e,t,i,n,r,o,a,s,c){"ngInject";function l(e){var t=_.get(e,[u[0]]);if(!t)return Promise.reject("Not a valid offer");1===u.length?o.isSubscription(t)?i.buy(t.offerId,{checkoutType:c.SUBS}):i.buy(t.offerId):i.buyAddons(u)}function d(e){a.error("[OIG Checkout] error: ",e)}function g(e){t.isOnline=e&&e.isOnline,t.$digest()}var u=e.offerId?e.offerId.split(","):[];t.isOnline=s.isClientOnline(),s.events.on(LR,g),t.$on("$destroy",function(){s.events.off(LR,g)}),s.waitForAuthReady().then(function(){u.length>0?n.checkForCheckoutMessage(e.profile,e.masterTitleId).then(_.partial(r.getCatalogInfo,u)).then(l).catch(d):a.error("[OIG Checkout] No offer ID passed")})}function sr(e,t,i){"ngInject";e.offers=t.offerIds.split(","),e.strings={title:i.getLocalizedStr(e.titleStr,DR,"title")}}function cr(e){"ngInject";e.redeemCode()}function lr(e,t){"ngInject";e.titleStr=t.getLocalizedStr(e.titleStr,GR,"title-str"),e.description=t.getLocalizedStr(e.descriptionstr,GR,"description")}function dr(e,t,i){"ngInject";return{restrict:"E",replace:!0,scope:{titleStr:"@",errorcodestr:"@errorcode",descriptionstr:"@description"},link:function(e){i.addTag("head","meta",{name:"prerender-status-code",content:"404"}),e.errorcode=t.getLocalizedStr(e.errorcodestr,MR,"errorcode"),e.titleStr=t.getLocalizedStr(e.titlestr,MR,"title-str"),e.description=t.getLocalizedStr(e.descriptionstr,MR,"description"),e.isUnderage=Origin.user.underAge()},template:BR}}function gr(e,t,i,n,r){"ngInject";n.getRosterUser(e.nucleusId).then(function(t){t&&r.create(t._presence).defaultTo({jid:e.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")}),e.viewProfile=function(){i.goUserProfile(e.nucleusId)}}function ur(e,t,i,n,r,o){"ngInject";function a(t){e.roster=t,Origin.atom.atomFriendCountForUser(e.nucleusId).then(l).catch(d)}function s(t){var i=t;if(i.length>0){e.usersFriendCount>=f&&(e.loadingState=!1),i.map(function(t){var i,n=!1;if(void 0!==e.roster[t.userId]){for(i=0;i<e.usersFriendsInCommon.length;i++)if(e.usersFriendsInCommon[i].userId===t.userId){n=!0;break}n||e.usersFriendsInCommon.push(t)}else{for(i=0;i<e.usersFriendsOther.length;i++)if(e.usersFriendsOther[i].userId===t.userId){n=!0;break}n||e.usersFriendsOther.push(t)}});var r=e.usersFriendsInCommon.length,o=e.usersFriendsOther.length;r<e.friendsInCommonLimit&&(e.friendsInCommonLimit=r),r>e.friendsInCommonLimit&&e.friendsInCommonLimit<e.limit&&(e.friendsInCommonLimit=r,e.friendsInCommonLimit>e.limit&&(e.friendsInCommonLimit=e.limit)),o<e.friendsOtherLimit&&(e.friendsOtherLimit=o),o>e.friendsOtherLimit&&e.friendsOtherLimit<e.limit&&(e.friendsOtherLimit=o,e.friendsOtherLimit>e.limit&&(e.friendsOtherLimit=e.limit)),e.friendsInCommonLoc=n.getLocalizedStr(e.friendsInCommonStr,m,"friendsincommonstr").replace("%number%",e.friendsInCommonLimit).replace("%total%",r),e.otherFriendsLoc=n.getLocalizedStr(e.otherFriendsStr,m,"otherfriendsstr").replace("%number%",e.friendsOtherLimit).replace("%total%",o),e.$digest(),++h,Origin.atom.atomFriendsForUser(e.nucleusId,h).then(s).catch(c)}else v=!1,e.loadingState=!1,e.$digest()}function c(n){n.message.indexOf("403")>=0?i.setProfilePrivacy(e.nucleusId,!0):e.errorState=!0,v=!1,e.loadingState=!1,e.$digest(),t.error("origin-profile-page-friends-otheruser atomFriendsForUser:",n)}function l(t){i.setProfilePrivacy(e.nucleusId,!1),e.usersFriendCount=t,e.usersFriendsInCommon=[],e.usersFriendsOther=[],e.usersFriendCount>0?Origin.atom.atomFriendsForUser(e.nucleusId,h).then(s).catch(c):(v=!1,e.loadingState=!1,e.$digest())}function d(n){n.message.indexOf("403")>=0?i.setProfilePrivacy(e.nucleusId,!0):e.errorState=!0,v=!1,e.loadingState=!1,e.$digest(),t.error("origin-profile-page-friends-otheruser atomFriendCountForUser:",n)}function g(){r.isAppLoggedIn()&&(v||(v=!0,h=0,e.loadingState=!0,e.errorState=!1,Origin.client.isEmbeddedBrowser()?i.getRoster("FRIENDS").then(a):Origin.friends.userFriends(e.nucleusId).then(p).then(a)))}function u(){g(),e.$digest()}function p(e){return e.entries.reduce(function(e,t){return e[t.userId]={nucleusId:t.userId,originId:t.nickName},e},{})}var m="origin-profile-page-friends-otheruser",f=200,h=0,v=!1;e.privateLoc=n.getLocalizedStr(e.privateStr,m,"privatestr"),e.showMoreLoc=n.getLocalizedStr(e.showMoreStr,m,"showmorestr"),e.noFriendsSubtitleLoc=n.getLocalizedStr(e.noFriendsSubtitleStr,m,"nofriendssubtitlestr"),e.errorTitleLoc=n.getLocalizedStr(e.errorTitleStr,m,"errortitlestr"),e.errorDescriptionLoc=n.getLocalizedStr(e.errorDescriptionStr,m,"errordescriptionstr"),e.errorButtonLoc=n.getLocalizedStr(e.errorButtonStr,m,"errorbuttonstr"),e.usersFriendsInCommon=[],e.usersFriendsOther=[],e.limit=9,e.friendsInCommonLimit=e.limit,e.friendsOtherLimit=e.limit,e.privacy={isPrivate:!1},e.loadingState=!0,e.errorState=!1,i.getRosterUser(e.nucleusId).then(function(t){if(t){var i=o.create(t.privacy).defaultTo({isPrivate:!1});e.noFriendsTitleLoc=n.getLocalizedStr(e.noFriendsTitleStr,m,"nofriendstitlestr",{"%username%":t.originId}),i.attachToScope(e,"privacy"),i.attachToScope(e,g)}}),r.isAppLoggedIn()&&g(),o.create(i.getBlockListWatch()).attachToScope(e,g),r.events.on("myauth:change",u),r.events.on("myauth:ready",u),e.$on("$destroy",function(){r.events.off("myauth:change",u),r.events.off("myauth:ready",u)}),e.showMoreCommon=function(){e.friendsInCommonLimit+=50;var t=e.usersFriendsInCommon.length;e.friendsInCommonLimit>=t&&(e.friendsInCommonLimit=t),e.friendsInCommonLoc=n.getLocalizedStr(e.friendsInCommonStr,m,"friendsincommonstr").replace("%number%",e.friendsInCommonLimit).replace("%total%",t),e.$digest()},e.showMoreUncommon=function(){e.friendsOtherLimit+=50;var t=e.usersFriendsOther.length;e.friendsOtherLimit>=t&&(e.friendsOtherLimit=t),e.otherFriendsLoc=n.getLocalizedStr(e.otherFriendsStr,m,"otherfriendsstr").replace("%number%",e.friendsOtherLimit).replace("%total%",t),e.$digest()},e.onTryAgain=function(){v||(v=!0,e.errorState=!1,e.loadingState=!0,i.getRoster("FRIENDS").then(a))}}function pr(e,t,i,n,r){"ngInject";function o(){a(0,l)}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;Origin.friends.userFriends(t,i).then(function(t){e.allFriends=e.allFriends.concat(t.entries.map(function(e){return{nucleusId:e.userId,originId:e.displayName}})),e.friendsTotal=t.pagingInfo.totalSize,e.friendsTotal<e.friendsLimit&&(e.friendsLimit=e.friendsTotal),e.myFriendsLoc=n.getLocalizedStr(e.myFriendsStr,c,"myfriendsstr").replace("%number%",e.friendsLimit).replace("%total%",e.friendsTotal),e.$digest()}),d+=l}function s(){o()}var c="origin-profile-page-friends-self",l=100,d=0;e.noFriendsTitleLoc=n.getLocalizedStr(e.noFriendsTitleStr,c,"nofriendstitlestr"),e.noFriendsSubtitleLoc=n.getLocalizedStr(e.noFriendsSubtitleStr,c,"nofriendssubtitlestr"),e.findFriendsLoc=n.getLocalizedStr(e.findFriendsStr,c,"findfriendsstr"),e.showMoreLoc=n.getLocalizedStr(e.showMoreStr,c,"showmorestr"),e.limit=9,e.friendsLimit=e.limit,e.allFriends=[],Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIENDS_LIST_VIEW_LOCATION,{label:"User Profile"}),i.isAppLoggedIn()&&o(),i.events.on("myauth:change",s),i.events.on("myauth:ready",s),e.$on("$destroy",function(){i.events.off("myauth:change",s),i.events.off("myauth:ready",s)}),e.findFriends=function(){r.findFriends()},e.showMore=function(){e.friendsLimit+=50,e.friendsLimit>=e.friendsTotal?e.friendsLimit=e.friendsTotal:e.friendsLimit>=d&&a(d,l),e.myFriendsLoc=n.getLocalizedStr(e.myFriendsStr,c,"myfriendsstr").replace("%number%",e.friendsLimit).replace("%total%",e.friendsTotal),e.$digest()}}function mr(e,t,i,n,r){"ngInject";e.isNoCommerceContext=r.isNoCommerceContext(),e.learnMoreLoc=t.getLocalizedStr(e.learnMoreStr,qR,"learn-more-str"),e.detailsLoc=t.getLocalizedStr(e.detailsStr,qR,"details-str"),e.defaultImage=n.getImagePath("profile\\game-placeholder.jpg"),e.navigateToGame=function(){e.offerId&&!e.isNoCommerceContext&&i.goProductDetails(e.offerId)}}function fr(e,t,i,n,r,o,a,s,c){"ngInject";function l(t,i,n){t.indexOf(n.productId)>=0||i.indexOf(n.masterTitleId)>=0?e.commonGames.push(n):e.uncommonGames.push(n)}function d(t){t.message.indexOf("403")>=0&&o.setProfilePrivacy(e.userId,!0),i.error("origin-profile-page-games-otheruser atomGamesOwnedForUser:",t),e.loading=!1,e.$digest()}function g(){e.otherGamesLocString=e.otherGamesLoc.replace("%username%",e.originId).replace("%number%",e.uncommonGamesLimit<e.uncommonGames.length?e.uncommonGamesLimit:e.uncommonGames.length).replace("%total%",e.uncommonGames.length)}function u(i){o.setProfilePrivacy(e.userId,!1);var n=t.baseGameEntitlements(),r=n.map(m("offerId")),a=n.map(m("masterTitleId"));e.commonGames=[],e.uncommonGames=[],_.forEach(i,_.partial(l,r,a)),g(),e.loading=!1,e.$digest()}function p(){s.isAppLoggedIn()&&Origin.atom.atomGamesOwnedForUser(e.userId).then(c.filterAlphaBetaTool).then(u).catch(d)}var m=n.getProperty,f=null;e.showMoreGamesLoc=r.getLocalizedStr(e.showMoreGamesStr,KR,"showmoregamesstr"),e.showLessGamesLoc=r.getLocalizedStr(e.showLessGamesStr,KR,"showlessgamesstr"),e.privateLoc=r.getLocalizedStr(e.privateStr,KR,"privatestr"),e.noGamesLoc=r.getLocalizedStr(e.noGamesStr,KR,"nogamesstr"),e.gamesYouBothOwnLoc=r.getLocalizedStr(e.gamesYouBothOwnStr,KR,"gamesyoubothownstr"),e.gamesYouDontOwnLoc=r.getLocalizedStr(e.gamesYouDontOwnStr,KR,"gamesyoudontownstr"),e.otherGamesLoc=r.getLocalizedStr(e.otherGamesStr,KR,"othergamesstr"),e.otherGamesLocString="",e.privacy={isPrivate:!1},e.loading=!0,e.commonGames=[],e.uncommonGames=[],e.commonGamesInitialLimit=5,e.uncommonGamesInitialLimit=10,e.commonGamesLimit=5,e.uncommonGamesLimit=10,e.originId="",e.showMoreOtherGames=function(){e.uncommonGamesLimit=e.uncommonGames.length,g()},e.showLessOtherGames=function(){e.uncommonGames.length<e.uncommonGamesLimit?e.uncommonGamesLimit=e.uncommonGames.length:e.uncommonGamesLimit=e.uncommonGamesInitialLimit,g()},o.getRosterUser(e.userId).then(function(t){t&&(e.originId=t.originId,a.create(t.privacy).defaultTo({isPrivate:!1}).attachToScope(e,"privacy"))}),a.create(o.getBlockListWatch()).attachToScope(e,p),e.$on("$destroy",function(){f&&f.detach()}),f=t.events.on("games:baseGameEntitlementsUpdate",p,this),t.initialRefreshCompleted()&&p()}function hr(e,t,i,n,r,o,a,s){"ngInject";function c(t){e.myGames=t;var i=e.myGames.length;i<e.gamesLimit&&(e.gamesLimit=i),e.myGamesLoc=o.getLocalizedStr(e.myGamesStr,JR,"mygamesstr").replace("%number%",e.gamesLimit).replace("%total%",i),e.$digest()}function l(e){r.error("[origin-profile-page-games-self GamesDataFactory.onUpdate] error",e)}function d(e){return _.filter(e,function(e){return!a.isAlphaBeta(e)})}function g(){var e=i.baseGameEntitlements().map(u("offerId"));t.getCatalogInfo(e).then(d).then(m(p(h))).then(f).then(c).catch(l)}var u=n.getProperty,p=n.transformWith,m=n.mapWith,f=n.toArray,h={title:["i18n","displayName"],image:["i18n","packArtLarge"],offerId:"offerId"},v=null;e.showMoreGamesLoc=o.getLocalizedStr(e.showMoreGamesStr,JR,"showmoregamesstr"),e.showLessGamesLoc=o.getLocalizedStr(e.showLessGamesStr,JR,"showlessgamesstr"),e.noGamesLoc=o.getLocalizedStr(e.noGamesStr,JR,"nogamesstr"),e.gamesInitialLimit=10,e.gamesLimit=e.gamesInitialLimit,e.$on("$destroy",function(){v&&v.detach()}),v=i.events.on("games:baseGameEntitlementsUpdate",g,this),i.initialRefreshCompleted()&&g(),e.showMoreGames=function(){var t=e.myGames.length;e.gamesLimit=t,e.myGamesLoc=o.getLocalizedStr(e.myGamesStr,JR,"mygamesstr").replace("%number%",e.gamesLimit).replace("%total%",t),s.digestIfDigestNotInProgress(e)},e.showLessGames=function(){var t=e.myGames.length;e.gamesLimit=e.gamesInitialLimit,t<e.gamesLimit&&(e.gamesLimit=t),e.myGamesLoc=o.getLocalizedStr(e.myGamesStr,JR,"mygamesstr").replace("%number%",e.gamesLimit).replace("%total%",t),s.digestIfDigestNotInProgress(e)}}function vr(e){"ngInject";e.isSelf=""===e.nucleusId||Number(e.nucleusId)===Number(Origin.user.userPid())}function br(e){"ngInject";e.isSelf=""===e.nucleusId||Number(e.nucleusId)===Number(Origin.user.userPid())}function yr(e){"ngInject";e.isSelf=""===e.nucleusId||Number(e.nucleusId)===Number(Origin.user.userPid())}function Sr(e,t,i){"ngInject";function n(){a.lazyLoadOfferList=[],t.cancel(s)}function r(){n()}function o(){_.isArray(a.offerList)&&(a.lazyLoadOfferList.length<a.offerList.length?a.lazyLoadOfferList=_.slice(a.offerList,0,a.lazyLoadOfferList.length+c):t.cancel(s))}var a,s,c=20,l=i.orderByField;e.isSelf=""===e.nucleusId||Number(e.nucleusId)===Number(Origin.user.userPid()),this.lazyLoadDisabled=function(){return!_.isArray(a.offerList)||a.lazyLoadOfferList.length===a.offerList.length},this.initializeChildScope=function(e){a=e,n(),a.$on("$destroy",r)},this.setWishlist=function(e){a.wishlist=e,a.offerList=l("ts")(e.offerList),a.lazyLoadOfferList=_.slice(a.offerList,0,c),a.$digest()},this.loadMoreItems=o,setTimeout(function(){s=t(o,2e3)},1e3),this.loadMore=function(){return new Promise(function(e){o();var t=a.$on("postrepeat:last",function(){t(),e()});setTimeout(function(){a.$digest()},2e3)})}}function kr(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b){"ngInject";function y(t){_.isUndefined(t)||_.isUndefined(t[e.wish.id])||(e.model=t[e.wish.id],N(e.model.releaseDate)&&(e.releaseDateLoc=s.getLocalizedStr(e.releaseDateStr,n$,"releasedatestr").replace("%date%",l(e.model.releaseDate).format("LL"))))}function S(t){return e.isGameGiftable||(e.eligibilityStr=t?R[t]||_.get(R,["unknown"]):_.get(R,["not_eligible"])),t}function k(t){return e.isGameGiftable=u.isFriendEligibleToReceive(t),e.isWarningRequired=u.isWarningRequired(t),t}function I(t){e.eligibilityStr=t&&"gift-as-banned-user"===t?void 0:_.get(R,["unknown"])}function w(){if(!_.isUndefined(e.model)&&!e.isSelf)return e.isGameGiftable=p.isGameGiftable(e.model),e.isGameGiftable?p.validateUserStatus().then(_.partial(T,e.model)).then(C).then(k).then(S).catch(I):Promise.resolve(S())}function C(e){return _.get(_.head(e),"status","unknown").toLowerCase()}function T(t){return u.getFriendsGiftingEligibility(t.offerId,[e.userId])}function P(e){return!!e&&e.length>0&&e!==o.defaultBoxArtUrl()}function O(){var t;e.packArtUrl=(t=o.defaultBoxArtUrl(),_.isUndefined(e.model)||(t=_.filter([e.model.i18n.packArtLarge,e.model.i18n.packArtMedium,e.model.i18n.packArtSmall],P)[0]),t),e.usingSmallPackArt=!1,_.isUndefined(e.model)||(e.usingSmallPackArt=e.packArtUrl===e.model.i18n.packArtSmall)}function E(i){e.showPurchaseCTA=e.isSelf&&!e.model.isOwned&&!e.model.vaultEntitlement&&!t.isFree(e.model)&&e.model.isPurchasable&&!i,e.showDirectAcquisitionCTA=e.isSelf&&!e.model.isOwned&&!e.model.vaultEntitlement&&(t.isFree(e.model)||e.isOwnedSubscriptionOffer()),e.showOrginAccessUpsellCTA=!e.isSubscriber&&e.model&&(v.isVaultGameOrUpgradeable(e.model)||b.isPremierVaultGameOrUpgradable(e.model))&&e.isSelf,e.showSplitCTADivider=(e.showOrginAccessUpsellCTA||e.showDirectAcquisitionCTA)&&(e.showPurchaseCTA||e.isGameGiftable)}function F(){e.model.isAnnouncement&&(e.eligibilityStr=_.get(R,["announcement"])),e.directEntitleOfferStrLoc=h.isFreeToEntitle(e.model)?D:A}function x(){return e.isSelf&&!_.isUndefined(e.model)&&h.isBaseGameOfferType(e.model)?f.getHighestOwnedEditionCatalogAsync(e.model).then(G).then(function(e){return!!e}):Promise.resolve(!1)}function L(){e.eligibilityStr=void 0,o.getCatalogInfo([e.wish.id]).then(r.transformOffer).then(y).then(O).then(w).then(F).then(x).then(E).then(function(){return e.$digest()}).catch(function(e){})}var A=s.getLocalizedStr(e.addToMyGames,n$,"add-to-my-games"),D=s.getLocalizedStr(e.addFreeOfferStr,n$,"add-free-offer-str");e.removeFromWishlistLoc=s.getLocalizedStr(e.removeStr,n$,"removestr"),e.undoRemoveFromWishlistLoc=s.getLocalizedStr(e.undoStr,n$,"undostr"),e.orLoc=s.getLocalizedStr(e.orStr,n$,"orstr"),e.savingsLoc=s.getLocalizedStr(e.saveStr,n$,"savestr"),e.originAccessDiscountAppliedLoc=s.getLocalizedStr(e.originAccessDiscountAppliedStr,n$,"originaccessdiscountappliedstr"),e.addedDateLoc=s.getLocalizedStr(e.addedStr,n$,"addedstr",{"%date%":l(e.wish.ts).format("LL")}),e.playFreeLoc=['<span class="origin-profile-wishlist-access-text-wrapper origin-telemetry-profile-wishlist-access-text-wrapper">',s.getLocalizedStr(e.playFreeStr,n$,"playfreestr",{"%access%":"EA Play"}),"</span>"].join(""),e.accessLandingUrl=m.getAbsoluteUrl(r$),e.notAvailableLoc=s.getLocalizedStr(e.notAvailableStr,n$,"not-available-str");var R={not_eligible:s.getLocalizedStr(!1,n$,"not-eligible-str"),ineligible_to_receive:s.getLocalizedStr(!1,n$,"ineligible-to-receive-str"),already_owned:s.getLocalizedStr(!1,n$,"owns-game-str"),announcement:s.getLocalizedStr(!1,n$,"announcement-str"),unknown:s.getLocalizedStr(!1,n$,"unknown-str")},$=d.getWishlist(Number(e.userId)),N=i.isInTheFuture;e.isSelf=""===e.userId||Number(e.userId)===Number(Origin.user.userPid()),e.isGameGiftable=!1,e.isSubscriber=g.userHasSubscription(),e.subscriptionLevel=g.getSubscriptionLevel(),e.navigateToGame=function(){e.model&&c.goToPdp(e.model)},e.isFree=function(e){return t.isFree(e)},e.onRemoveClicked=function(t){t.stopPropagation(),t.preventDefault(),e.removed=!0,$.removeOffer(e.wish.id)},e.isOwnedSubscriptionOffer=function(){return e.isSubscriber&&(e.subscriptionLevel===yI.y.PREMIUM&&b.isPremierVaultGameOrUpgradable(e.model)||e.subscriptionLevel!==yI.y.NONE&&v.isVaultGameOrUpgradeable(e.model))},e.isVaultEntitlement=function(){return e.isOwnedSubscriptionOffer()&&!e.model.oth};var G=function(t){if(t){var i=_.get(t,["i18n","displayName"]);e.eligibilityStr=s.getLocalizedStr(!1,n$,"higher-edition-owned-str",{"%game%":i})}return t};L();var U=[a.events.on("games:update:"+e.wish.id,L)];e.$on("$destroy",function(){return n.detachAll(U)})}function Ir(e,t,i,n,r,o){"ngInject";function a(t){e.setWishlist(t),t.isPrivate&&o.setProfilePrivacy(e.nucleusId,!0)}var s="origin-profile-page-wishlist-otheruser";e.loading=!0,o.getRosterUser(e.nucleusId).then(function(t){t&&(r.create(t.privacy).defaultTo({isPrivate:!0}).attachToScope(e,"privacy"),e.emptyWishlistHeadingLoc=i.getLocalizedStr(e.emptywishlistheading,s,"emptywishlistheading").replace("%username%",t.originId),e.emptyWishlistDescriptionLoc=i.getLocalizedStr(e.emptywishlistdescription,s,"emptywishlistdescription").replace("%username%",t.originId),e.loading=!1)}),this.setObserver=function(){t.getObserver(e.nucleusId,e,i.unwrapPromiseAndCall(a))}}function wr(e,t,i,n){n[0].initializeChildScope(e),e.loadMore=n[0].loadMore,e.setWishlist=n[0].setWishlist,e.lazyLoadDisabled=n[0].lazyLoadDisabled,n[1].setObserver()}function Cr(e,t,i,n,r,o,a,s,c,l){"ngInject";e.emptyWishlistHeadingLoc=n.getLocalizedStr(e.emptywishlistheading,s$,"emptywishlistheading"),e.emptyWishlistDescriptionLoc=n.getLocalizedStr(e.emptywishlistdescription,s$,"emptywishlistdescription"),e.privateProfileHeadingLoc=n.getLocalizedStr(e.privateprofileheading,s$,"privateprofileheading"),e.shareCtaLoc=n.getLocalizedStr(e.sharecta,s$,"sharecta"),e.addToWishlistImageSrc=n.getLocalizedStr(e.addtowishlistimage,s$,"addtowishlistimage"),e.shareYourWishlistLoc=n.getLocalizedStr(e.shareyourwishlist,s$,"shareyourwishlist"),e.userId=Origin.user.userPid(),e.isPrivate=Origin.user.showPersona()===Origin.defines.showPersona.NO_ONE,e.goToAccount=function(e){e.stopPropagation(),e.preventDefault();var t=r.getUrl("accountPrivacySettings").replace("{locale}",Origin.locale.locale());o.externalUrl(t,!0)},this.setObserver=function(){a.getObserver(e.userId,e,n.unwrapPromiseAndCall(e.setWishlist))},setTimeout(function(){var r=n.getLocalizedStr(e.privateprofiledescription,s$,"privateprofiledescription"),o=t.find(".origin-profile-wishlist-private-body-text"),a=i(["<span>",r,"</span>"].join(""))(e);o.append(a),l.digestIfDigestNotInProgress(e)},0),c.getWishlist(e.userId).getWishlistId().then(function(t){e.showShareWishlist=!_.isUndefined(t),e.openShareWishlist=function(){s.openDirective({id:"origin-dialog-content-sharewishlist",name:"origin-dialog-content-sharewishlist",size:"large",data:{wishlistid:t}})},l.digestIfDigestNotInProgress(e)})}function Tr(e,t,i,n){n[0].initializeChildScope(e),e.loadMore=n[0].loadMore,e.setWishlist=n[0].setWishlist,e.lazyLoadDisabled=n[0].lazyLoadDisabled,n[1].setObserver()}function Pr(e,t){"ngInject";e.titleLoc=t.getLocalizedStr(e.titleStr,"origin-profile-anonymous","titlestr"),e.descriptionLoc=t.getLocalizedStr(e.descriptionStr,"origin-profile-anonymous","descriptionstr")}function _r(e,t){"ngInject";e.blockedtitleLoc=t.getLocalizedStr(e.blockedtitleStr,"origin-profile-blocked","blockedtitlestr"),e.blockedinfoLoc=t.getLocalizedStr(e.blockedinfoStr,"origin-profile-blocked","blockedinfostr"),e.blockedlinkLoc=t.getLocalizedStr(e.blockedlinkStr,"origin-profile-blocked","blockedlinkstr")}function Or(e,t){"ngInject";return{restrict:"E",controller:_r,scope:{nucleusId:"@nucleusid",blockedtitleStr:"@blockedtitlestr",blockedinfoStr:"@blockedinfostr",blockedlinkStr:"@blockedlinkstr"},template:d$,link:function(i,n){i.$element=$(n).find(".origin-profile-blocked"),i.$element.on("click",".blocked-link",function(){var i=t.getUrl("accountPrivacySettings");i=i.replace("{locale}",Origin.locale.locale()),e.externalUrl(i,!0)})}}}function Er(e,t){"ngInject";function i(){return e.browserSupports("css-filters")}function n(e){var n=$(".origin-profile-header-image-svg-stddeviation");i()?(e.blurValue,e.blurStyle=t.addVendorPrefixes("filter","blur(30px)")):n&&n.length&&angular.isDefined(n[0].setStdDeviation)&&(e.blurValue,n[0].setStdDeviation(30,30))}var r={css:{template:u$},svg:{template:p$}};return _.merge({restrict:"E",replace:!0,scope:{imageUrl:"="},link:n},i()?r.css:r.svg)}function Fr(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";function h(t){m.create(t.subscription).defaultTo({state:"NONE",requestSent:!1,relationship:"NON_FRIEND"}).attachToScope(e,"subscription"),m.create(t._presence).defaultTo({jid:e.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")}function v(t){e.avatarImgSrc=t,e.backgroundImage=t,e.$digest()}function b(){l.goToState("app.error_notfound")}function y(e){u.error("OriginProfileHeaderCtrl: UserDataFactory.getAvatar failed",e)}function S(){""===e.nucleusId&&(e.nucleusId=Origin.user.userPid()),Number(e.nucleusId)===Number(Origin.user.userPid())&&(e.hasSubscription=g.userHasSubscription()),Origin.atom.atomUserInfoByUserIds([e.nucleusId]).then(function(t){e.user=t[0],e.$digest()}).catch(function(e){u.error("OriginProfileHeaderCtrl: Origin.atom.atomUserInfoByUserIds failed",e)}),i.getAvatar(e.nucleusId,Origin.defines.avatarSizes.LARGE).then(v,b).catch(y),n.loadBlockList()}function k(t){t.isLoggedIn?(S(),e.$digest()):(e.nucleusId="",e.avatarImgSrc=c.getImagePath("profile\\avatar-placeholder.png"),e.backgroundImage=void 0)}function I(){e.optionsContextmenuVisible=!1,e.$digest()}e.onlineLoc=r.getLocalizedStr(e.onlineStr,f$,"onlinestr"),e.awayLoc=r.getLocalizedStr(e.awayStr,f$,"awaystr"),e.offlineLoc=r.getLocalizedStr(e.offlineStr,f$,"offlinestr"),e.invisibleLoc=r.getLocalizedStr(e.invisibleStr,f$,"invisiblestr"),e.playingLoc=r.getLocalizedStr(e.playingStr,f$,"playingstr"),e.broadcastingLoc=r.getLocalizedStr(e.broadcastingStr,f$,"broadcastingstr"),e.editoneadotcomLoc=r.getLocalizedStr(e.editoneadotcomStr,f$,"editoneadotcomstr"),e.sendfriendrequestLoc=r.getLocalizedStr(e.sendfriendrequestStr,f$,"sendfriendrequeststr"),e.friendrequestsentLoc=r.getLocalizedStr(e.friendrequestsentStr,f$,"friendrequestsentstr"),e.acceptFriendRequestLoc=r.getLocalizedStr(e.acceptfriendrequestStr,f$,"acceptfriendrequeststr"),e.ignoreFriendRequestLoc=r.getLocalizedStr(e.ignorefriendrequestStr,f$,"ignorefriendrequeststr"),e.unfriendLoc=r.getLocalizedStr(e.unfriendStr,f$,"unfriendstr"),e.blockandunfriendLoc=r.getLocalizedStr(e.blockandunfriendStr,f$,"blockandunfriendstr"),e.blockuserLoc=r.getLocalizedStr(e.blockuserStr,f$,"blockuserstr"),e.unblockuserLoc=r.getLocalizedStr(e.unblockuserStr,f$,"unblockuserstr"),e.reportuserLoc=r.getLocalizedStr(e.reportuserStr,f$,"reportuserstr"),e.unfriendusertitleLoc=r.getLocalizedStr(e.unfriendusertitleStr,f$,"unfriendusertitlestr"),e.unfrienduserdescriptionLoc=r.getLocalizedStr(e.unfrienduserdescriptionStr,f$,"unfrienduserdescriptionstr"),e.unfrienduseracceptLoc=r.getLocalizedStr(e.unfrienduseracceptStr,f$,"unfrienduseracceptstr"),e.unfrienduserrejectLoc=r.getLocalizedStr(e.unfrienduserrejectStr,f$,"unfrienduserrejectstr"),e.errorfriendnotaddedtitleLoc=r.getLocalizedStr(e.errorfriendnotaddedtitle,f$,"errorfriendnotaddedtitle"),e.errorfriendnotaddeddescriptionLoc=r.getLocalizedStr(e.errorfriendnotaddeddescription,f$,"errorfriendnotaddeddescription"),e.errorfriendnotaddedacceptLoc=r.getLocalizedStr(e.errorfriendnotaddedaccept,f$,"errorfriendnotaddedaccept"),e.errorfriendnotaddedcancelLoc=r.getLocalizedStr(e.errorfriendnotaddedcancel,f$,"errorfriendnotaddedcancel"),e.cancelandblockuserLoc=r.getLocalizedStr(e.cancelandblockuser,f$,"cancelandblockuser"),e.ignoreandblockuserLoc=r.getLocalizedStr(e.ignoreandblockuser,f$,"ignoreandblockuser"),e.cancelandblocktitleLoc=r.getLocalizedStr(e.cancelandblocktitle,f$,"cancelandblocktitle"),e.cancelandblockdescriptionLoc=r.getLocalizedStr(e.cancelandblockdescription,f$,"cancelandblockdescription"),e.cancelandblockdescription2Loc=r.getLocalizedStr(e.cancelandblockdescriptiontwoStr,f$,"cancelandblockdescriptiontwostr"),e.changeminddescriptionLoc=r.getLocalizedStr(e.changeminddescription,f$,"changeminddescription"),e.cancelandblockacceptLoc=r.getLocalizedStr(e.cancelandblockaccept,f$,"cancelandblockaccept"),e.cancelandblockdeclineLoc=r.getLocalizedStr(e.cancelandblockdecline,f$,"cancelandblockdecline"),e.ignoreandblocktitleLoc=r.getLocalizedStr(e.ignoreandblocktitle,f$,"ignoreandblocktitle"),e.ignoreandblockdescriptionLoc=r.getLocalizedStr(e.ignoreandblockdescription,f$,"ignoreandblockdescription"),e.ignoreandblockdescription2Loc=r.getLocalizedStr(e.ignoreandblockdescriptiontwoStr,f$,"ignoreandblockdescriptiontwostr"),e.ignoreandblockacceptLoc=r.getLocalizedStr(e.ignoreandblockaccept,f$,"ignoreandblockaccept"),e.ignoreandblockdeclineLoc=r.getLocalizedStr(e.ignoreandblockdecline,f$,"ignoreandblockdecline"),e.hasSubscription=!1,e.avatarImgSrc=c.getImagePath("profile\\avatar-placeholder.png"),e.optionsContextmenuVisible=!1,e.contextmenuCallbacks={},e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),e.fromFriendRecommendationTile=t.fromFriendRecommendationTile,n.getRosterUser(e.nucleusId).then(function(e){e&&n.isBlocked(e.nucleusId).then(function(t){return t&&(e.subscription.data.relationship="BLOCKED"),e}).then(h)});var w=_.throttle(function(){i.getAvatarFromServer(e.nucleusId,Origin.defines.avatarSizes.LARGE).then(v,b).catch(y)},h$);s.isAppLoggedIn()&&S(),e.removeFriendAndBlockDlgStrings={},e.removeFriendAndBlockDlgStrings.title=r.getLocalizedStr(e.unfriendandblocktitle,f$,"unfriendandblocktitle"),e.removeFriendAndBlockDlgStrings.description=r.getLocalizedStr(e.unfriendandblockdescription,f$,"unfriendandblockdescription"),e.removeFriendAndBlockDlgStrings.description2=r.getLocalizedStr(e.unfriendandblockdescriptiontwoStr,f$,"unfriendandblockdescriptiontwostr"),e.removeFriendAndBlockDlgStrings.description3=r.getLocalizedStr(e.unfriendandblockdescriptionthreeStr,f$,"unfriendandblockdescriptionthreestr"),e.removeFriendAndBlockDlgStrings.acceptText=r.getLocalizedStr(e.unfriendandblockaccept,f$,"unfriendandblockaccept"),e.removeFriendAndBlockDlgStrings.rejectText=r.getLocalizedStr(e.unfriendandblockreject,f$,"unfriendandblockreject"),e.blockDlgStrings={},e.blockDlgStrings.title=r.getLocalizedStr(e.blocktitle,f$,"blocktitle"),e.blockDlgStrings.description=r.getLocalizedStr(e.blockdescription,f$,"blockdescriptionstr"),e.blockDlgStrings.description2=r.getLocalizedStr(e.blockdescriptiontwoStr,f$,"blockdescriptiontwostr"),e.blockDlgStrings.description3=r.getLocalizedStr(e.blockdescriptionthreeStr,f$,"blockdescriptionthreestr"),e.blockDlgStrings.acceptText=r.getLocalizedStr(e.blockaccept,f$,"blockaccept"),e.blockDlgStrings.rejectText=r.getLocalizedStr(e.blockreject,f$,"blockreject"),this.handleBlockUser=function(t){o.events.off("dialog:hide",C.handleBlockUser),t.accepted&&n.blockUser(e.nucleusId)},this.handleCancelAndBlockUser=function(t){o.events.off("dialog:hide",C.handleCancelAndBlockUser),t.accepted&&n.cancelAndBlockUser(e.nucleusId)},this.handleIgnoreAndBlockUser=function(t){o.events.off("dialog:hide",C.handleIgnoreAndBlockUser),t.accepted&&n.ignoreAndBlockUser(e.nucleusId)},this.handleUnfriendAndBlockUser=function(t){o.events.off("dialog:hide",C.handleUnfriendAndBlockUser),t.accepted&&n.removeFriendAndBlock(e.nucleusId)},s.events.on("myauth:change",k),s.events.on("myauth:ready",k),Origin.events.on(Origin.events.DIRTYBITS_AVATAR,w),e.$on("$destroy",function(){s.events.off("myauth:change",k),s.events.off("myauth:ready",k),Origin.events.off(Origin.events.DIRTYBITS_AVATAR,w),$(window).off("resize",I)}),this.toggleOptionsContextmenu=function(){if(e.optionsContextmenuVisible=!e.optionsContextmenuVisible,e.optionsContextmenuVisible){var t,i,n,r=$(window).width()<600,o=e.$element.find(".origin-profile-header"),a=parseInt(o.css("padding-right"),10),s=parseInt(o.css("padding-top")),c=e.$element.find(".origin-profile-header-controls-options-button"),l=c.offsetParent(),d=e.$element.find("#origin-profile-header-controls-options-menu"),g=c.position();"left"===c.css("float")?(t=g.left+a+12,i=g.top+c.height()+s+40,d.css({left:t+"px",top:i+"px",right:"auto"})):(n=r?l.width()-g.left+a:l.width()-g.left+a+70,i=g.top+c.height()+s+8,d.css({right:n+"px",top:i+"px",left:"auto"}))}e.$digest()},this.closeOptionsContextmenu=function(t){e.optionsContextmenuVisible=!1,t&&e.$digest()},$(window).resize(I);var C=this;this.handleRemoveFriend=function(t){o.events.off("dialog:hide",C.handleRemoveFriend),t.accepted&&(n.removeFriend(e.nucleusId),n.updateRosterViewport())},e.contextmenuCallbacks.ignoreFriendRequest=function(){C.closeOptionsContextmenu(!1),n.friendRequestReject(e.nucleusId),n.updateRosterViewport()},e.contextmenuCallbacks.unfriendUser=function(){C.closeOptionsContextmenu(!1),a.openPrompt({id:"profile-header-removeFriend",title:e.unfriendusertitleLoc,description:e.unfrienduserdescriptionLoc.replace("%username%",e.user.EAID),acceptText:e.unfrienduseracceptLoc,acceptEnabled:!0,rejectText:e.unfrienduserrejectLoc,defaultBtn:"yes",callback:C.handleRemoveFriend})},e.contextmenuCallbacks.blockUser=function(){C.closeOptionsContextmenu(!1);var t="<strong>"+e.blockDlgStrings.description+"</strong><br><br>"+e.blockDlgStrings.description2+"<br><br>"+e.blockDlgStrings.description3;t=t.replace(/%username%/g,e.user.EAID),a.openPrompt({id:"social-profile-header-blockUser",title:e.blockDlgStrings.title,description:t,acceptText:e.blockDlgStrings.acceptText,acceptEnabled:!0,rejectText:e.blockDlgStrings.rejectText,defaultBtn:"yes",callback:C.handleBlockUser})},e.contextmenuCallbacks.cancelAndBlockUser=function(){C.closeOptionsContextmenu(!1);var t="<strong>"+e.cancelandblockdescriptionLoc+"</strong><br><br>"+e.cancelandblockdescription2Loc+"<br><br>"+e.changeminddescriptionLoc;t=t.replace(/%username%/g,e.user.EAID),a.openPrompt({id:"profile-header-cancelRequestAndBlock-id",name:"profile-header-cancelRequestAndBlock",title:e.cancelandblocktitleLoc,description:t,acceptText:e.cancelandblockacceptLoc,acceptEnabled:!0,rejectText:e.cancelandblockdeclineLoc,defaultBtn:"yes",callback:C.handleCancelAndBlockUser})},e.contextmenuCallbacks.ignoreAndBlockUser=function(){C.closeOptionsContextmenu(!1);var t="<strong>"+e.ignoreandblockdescriptionLoc+"</strong><br><br>"+e.ignoreandblockdescription2Loc+"<br><br>"+e.changeminddescriptionLoc;t=t.replace(/%username%/g,e.user.EAID),a.openPrompt({id:"profile-header-ignoreRequestAndBlock-id",name:"profile-header-ignoreRequestAndBlock",title:e.ignoreandblocktitleLoc,description:t,acceptText:e.ignoreandblockacceptLoc,acceptEnabled:!0,rejectText:e.ignoreandblockdeclineLoc,defaultBtn:"yes",callback:C.handleIgnoreAndBlockUser})},e.contextmenuCallbacks.blockAndUnfriendUser=function(){C.closeOptionsContextmenu(!1);var t="<strong>"+e.removeFriendAndBlockDlgStrings.description+"</strong><br><br>"+e.removeFriendAndBlockDlgStrings.description2+"<br><br>"+e.removeFriendAndBlockDlgStrings.description3;t=t.replace(/%username%/g,e.user.EAID),a.openPrompt({id:"social-hub-roster-removeFriendAndBlock",title:e.removeFriendAndBlockDlgStrings.title,description:t,acceptText:e.removeFriendAndBlockDlgStrings.acceptText,acceptEnabled:!0,rejectText:e.removeFriendAndBlockDlgStrings.rejectText,defaultBtn:"yes",callback:C.handleUnfriendAndBlockUser})},e.contextmenuCallbacks.unblockUser=function(){C.closeOptionsContextmenu(!1),n.unblockUser(e.nucleusId)},e.contextmenuCallbacks.reportUser=function(){C.closeOptionsContextmenu(!1);var t=n.getCurrentUserPresence();p.reportUser({userid:e.user.userId,username:e.user.EAID,mastertitle:_.get(t,["gameActivity","masterTitle"])})},this.editSelfProfile=function(){var e=f.getUrl("eaAccounts");Origin.client.isEmbeddedBrowser()||(e=(e=e.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),l.asyncOpenUrlWithEADPSSO(e)},this.sendFriendRequest=function(){e.fromFriendRecommendationTile&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIEND_RECOMMENDATION_ADD,{type:"in-game",service:"originx",format:"live_tile",client_state:"foreground",msg_id:"friend_rec_"+Origin.user.userPid()+"_"+e.nucleusId,status:"click",content:"friend_recommendation",destination_name:"profile",meta:{friend_id:e.nucleusId,friend_type:"nucleus"},option:"yes"}),n.sendFriendRequest(e.nucleusId,e.fromFriendRecommendationTile?"recommendation":"chat")},this.handleErrorDialog=function(e){o.events.off("dialog:hide",C.handleErrorDialog),e.accepted&&(d.unminimizeWindow(),d.focusWindow())},this.acceptFriendRequest=function(){n.friendRequestAccept(e.nucleusId).then(function(){n.deleteFromSectionRoster("INCOMING",e.nucleusId)},function(){a.openPrompt({id:"social-hub-roster-errorFriendNotAdded-id",name:"social-hub-roster-errorFriendNotAdded",title:e.errorfriendnotaddedtitleLoc,description:e.errorfriendnotaddeddescriptionLoc,acceptText:e.errorfriendnotaddedacceptLoc,acceptEnabled:!0,rejectText:e.errorfriendnotaddedcancelLoc,defaultBtn:"yes",callback:C.handleErrorDialog})})}}function xr(e,t,i,n,r,o){"ngInject";var a,s,c=(a=regeneratorRuntime.mark(function i(){var r,o,a,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.isSubscriber=n.userHasActiveSubscription(),r=n.getUserSubscriptionInfo(),e.showSubscriptionDuration=_.get(r,[yI.h,yI.z,yI.t])!==y$.a.STACKED&&!n.isInStackableCountry(),!e.isSubscriber||!e.showSubscriptionDuration){i.next=13;break}if(o=n.getSubscriptionInfoConvertedFrom(),!(a=o.value)){i.next=12;break}return i.next=8,n.getSubscriptionById(a,y$.a.CONVERTED_OR_EXPIRED).catch(function(e){t.error("[originProfileMeta] Error getting expired subscription info: "+e)});case 8:(s=i.sent)&&(e.subscriptionStartDate=Math.floor(n.getSubscriptionStartDate(s)),e.$digest()),i.next=13;break;case 12:e.subscriptionStartDate=Math.floor(n.getSubscriptionStartDate());case 13:case"end":return i.stop()}},i,this)}),s=function(){var e=a.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return s.apply(this,arguments)});e.strings={member:i.getLocalizedStr(e.member,S$,"member"),memberSince:i.getLocalizedStr(e.memberSince,S$,"member-since")},n.events.on(b$.b,c),r.populateWithDefaults(e,S$).then(c),e.logoVariant=qS.Light,e.subscriptionLevel=o.getCurrentSubscriptionLevel(),e.$on("$destroy",function(){n.events.off(b$.b,c)})}function Lr(e,t){"ngInject";e.notAvailableLoc=t.getLocalizedStr(e.notAvailableStr,"origin-profile-offline","notavailablestr")}function Ar(e,t){"ngInject";e.privatetitleLoc=t.getLocalizedStr(e.privatetitleStr,"origin-profile-private","privatetitlestr")}function Dr(e,t,i){"ngInject";e.isWishlistEnabled=i.isWishlistEnabled(),e.detailsId=t.detailsId,e.topic=t.topic}function Rr(e,t,i,n,r,o){"ngInject";function a(){var t=_.map(e.navItems,"friendlyname").indexOf(e.topic);e.activeItemIndex=t+1>0?t:0}function s(t,i,n){n.topic&&(e.topic=n.topic,a())}e.achievementsLoc=i.getLocalizedStr(e.achievementsStr,"origin-profile-tabs","achievementsstr"),e.friendsLoc=i.getLocalizedStr(e.friendsStr,"origin-profile-tabs","friendsstr"),e.gamesLoc=i.getLocalizedStr(e.gamesStr,"origin-profile-tabs","gamesstr"),e.wishlistLoc=i.getLocalizedStr(e.wishlistStr,"origin-profile-tabs","wishliststr"),e.isSelf=""===e.nucleusId||Number(e.nucleusId)===Number(Origin.user.userPid()),e.topic=t.topic,e.navItems=[{anchorName:e.achievementsLoc,title:e.achievementsLoc,friendlyname:"achievements"},{anchorName:e.gamesLoc,title:e.gamesLoc,friendlyname:"games"}],e.isSelf&&e.navItems.splice(1,0,{anchorName:e.friendsLoc,title:e.friendsLoc,friendlyname:"friends"}),o.isWishlistEnabled()&&e.navItems.push({anchorName:e.wishlistLoc,title:e.wishlistLoc,friendlyname:"wishlist"}),e.onTabChange=function(t){e.isSelf?r.goToState("app.profile.topic",{topic:t.friendlyname}):r.goUserProfile(e.nucleusId,t.friendlyname)},n.events.on("uiRouter:stateChangeStart",s),e.$on("$destroy",function(){n.events.off("uiRouter:stateChangeStart",s)}),a()}function $r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Nr(e,t,i,n,r,o,a){"ngInject";function s(t){var n=e.isUnderAge,o=e.isAgeUnknown;l=t&&t.isLoggedIn;var s=a.get(j$),c=a.get(M$);_.isUndefined(c)?_.isUndefined(r.getMediaLocalAgeGateAge())?(e.isUnderAge=!1,e.isAgeUnknown=!1):l?(e.isUnderAge=r.isUserUnderAgeForMediaLocale(),e.isAgeUnknown=!1):s?(e.isUnderAge=r.isUserUnderAgeForMediaLocaleByBirthDay(s),e.isAgeUnknown=!1):(e.age=0,e.isUnderAge=!0,e.isAgeUnknown=!0):(e.isUnderAge="no"===c,e.isAgeUnknown=!1),i.log("agegate: isLoggedIn:"+l),i.log("agegate: sessionStorage.dob = "+s),i.log("agegate: age = "+e.age),i.log("agegate: restrictedAge = "+e.restrictedAge),i.log("agegate: underage = "+e.isUnderAge),o===e.isAgeUnknown&&n===e.isUnderAge||function(){e.isAgeUnknown||a.set(M$,e.isUnderAge?"no":"yes"),r.setUserAgeState({isUnderAge:e.isUnderAge,isAgeUnknown:e.isAgeUnknown})}()}function c(e){a.delete(j$),s(e)}var l,d,g,u;for(e.restrictedAge=r.getMediaLocalAgeGateAge(),e.months=[],e.days=[],e.years=[],e.dob={},e.isAgeUnknown=!1,r.getUserAgeStateObservable().attachToScope(e,function(t){e.isUnderAge=t.isUnderAge,e.isAgeUnknown=t.isAgeUnknown}),e.titleStr=t.getLocalizedStr(null,B$,"title-str"),e.descriptionStr=t.getLocalizedStr(null,B$,"description-str"),e.yearLabelStr=t.getLocalizedStr(null,B$,"year-label-str"),e.monthLabelStr=t.getLocalizedStr(null,B$,"month-label-str"),e.dayLabelStr=t.getLocalizedStr(null,B$,"day-label-str"),e.confirmStr=t.getLocalizedStr(null,B$,"confirm-str"),e.$watch("restrictedMessage",function(){e.restrictedMessage=t.getLocalizedStr(e.restrictedMessage,B$,"restricted-message")}),e.getFormattedMonthString=function(){return o(e.dob.month,"MM").format("MMMM")},d=(d=t.getLocalizedStr(null,B$,"months-str")).split(","),_.forEach(d,function(t,i){var n=i+1;n=n<10?"0"+n:n,e.months.push({key:n,value:t})}),g=1;g<=31;g++)e.days.push(g<10?"0"+g:g);for(g=u=(new Date).getFullYear();g>u-100;g--)e.years.push(g);e.confirmAge=function(){a.set(j$,e.dob.year+"-"+e.dob.month+"-"+e.dob.day),s()},n.events.on("myauth:change",c),n.events.on("myauth:ready",s),e.$on("$destroy",function(){n.events.off("myauth:change",c),n.events.off("myauth:ready",s)}),n.waitForAuthReady().then(s).catch(function(e){i.error("AGEGATE - authReadyError:",e)})}function Gr(e,t,i){"ngInject";function n(){e.isLoggedIn=t.isAppLoggedIn(),e.$digest()}function r(){e.isOffline=!t.isClientOnline()}var o=[];e.loginEventConfig||(e.loginEventConfig={obj:t,eventName:"myauth:change"}),e.onlineStateEventConfig||(e.onlineStateEventConfig={obj:t,eventName:"myauth:clientonlinestatechanged"}),e.$on("$destroy",function(){i.detachAll(o)}),t.waitForAuthReady().then(n),r(),o=[e.loginEventConfig.obj.events.on(e.loginEventConfig.eventName,n),e.onlineStateEventConfig.obj.events.on(e.onlineStateEventConfig.eventName,function(){r(),e.$digest()})]}function Ur(e,t,i,n,r,o,a,s,c){"ngInject";function l(){return Origin.defines.avatarSizes.LARGE}function d(t){e.userImage=t,e.$digest()}function g(e){r.error("[origin-avatar] UserDataFactory.getAvatar",e)}var u;e.userImage=c.getImagePath("social//avatar_placeholder.png"),e.originId="",e.avatarWidthHeight=z$[e.avatarSize||"small"],i.getRosterUser(e.nucleusId).then(function(t){t&&(s.create(t._presence).defaultTo({jid:e.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence"),s.create(t.name).defaultTo({firstName:"",lastName:"",originId:""}).getProperty("originId").attachToScope(e,"originId"))}),e.goToProfile=function(){var t;t=e.nucleusId,/^\d+$/.test(t)&&o.goUserProfile(e.nucleusId)},this.getUserAvatar=function(){t.getAvatar(e.nucleusId,l()).then(d).catch(g)};var p=_.throttle(function(){t.getAvatarFromServer(e.nucleusId,l()).then(d).catch(g)},V$);u=[n.events.on("myauth:clientonlinestatechanged",function(){e.$digest()}),Origin.events.on(Origin.events.DIRTYBITS_AVATAR,p)],e.$on("$destroy",function(){a.detachAll(u)})}function Br(e,t,i){"ngInject";return{restrict:"E",scope:{videoId:"@",imageUrl:"@",useScrims:"@"},template:q$,link:function(n,r){function o(t){t.data!==e.PLAYER_STATES.PLAYING||n.isVisible||(n.isVisible=!0,m=setInterval(s,J$),n.$digest())}function a(){p.seekTo(0)}function s(){var e=p.getDuration();e-p.getCurrentTime()<=Q$&&(clearInterval(m),f=setInterval(a,e*K$),a())}function c(){if(!p&&n.videoId){var t=r.find(".origin-background-video-player");return e.loadYoutubePlayer(t,n.videoId,{loop:0},r.width(),r.height(),{onStateChange:o}).then(l).then(g)}}function l(e){return p=e,e}function d(e){e||(p.playVideo(),p.mute(),setTimeout(function(){n.isYoutubeVideoLoading=!1},K$))}function g(){return Origin.client.games.isGamePlaying().then(d)}function u(){p&&(!t.isXSmall()&&t.isOnScreen(r.children().first())?g():p.pauseVideo())}var p=void 0,m=void 0,f=void 0;n.isVisible=!1,n.isSmallScreen=t.isXSmall(),n.youtubeImageUrl=n.imageUrl||e.getStillImage(n.videoId),n.backgroundColor="#141b20",n.isYoutubeVideoLoading=!0,n.useScrims||(n.useScrims=OS.true),n.showScrims=n.useScrims===OS.true,i.addScrollEventHandler(n,u,Y$),i.addVisibilityChangeEventHandler(n,u,function(){p&&p.pauseVideo()}),i.addResizeEventHandler(n,function(){n.isSmallScreen=t.isXSmall(),n.$digest(),n.isSmallScreen?p&&p.stopVideo():p?g():c()},Y$),setTimeout(function(){n.isSmallScreen||c()},0),n.$on("$destroy",function(){p&&(p.stopVideo(),p.destroy()),clearInterval(f),clearInterval(m)})}}}function Mr(e,t,i){"ngInject";function n(){return e.browserSupports("css-filters")}function r(r,a){function l(e){r.$watch("blurValue",function(t){e(angular.isDefined(t)&&!i.isXSmall()?t:o)})}r.blurStyle={},n()?l(function(e){r.blurStyle=e?t.addVendorPrefixes("filter","blur("+e+"px)"):{}}):e.browserSupports("svg-basicfilter")&&(a.parents(s).addClass(c),l(function(e){e||(e=0);var t=angular.element(".origin-blurredimage-svg-stddeviation");t.length&&t[0].setStdDeviation(e,e)}))}var o=null,a={css:{template:Z$},svg:{template:eN}},s="[origin-store-backgroundscrims]",c="origin-store-blursvg-active";return _.merge({restrict:"E",replace:!0,scope:{imageUrl:"=",blurValue:"=",imageOptions:"=",svgOptions:"="},link:r},n()?a.css:a.svg)}function jr(e,t,i){"ngInject";function n(){return e.browserSupports("css-filters")}function r(r,a){function l(e){r.$watch("blurValue",function(t){e(angular.isDefined(t)&&!i.isXSmall()?t:o)})}r.blurStyle={},n()?l(function(e){r.blurStyle=e?t.addVendorPrefixes("filter","blur("+e+"px)"):{}}):e.browserSupports("svg-basicfilter")&&(a.parents(s).addClass(c),l(function(e){e||(e=0);var t=angular.element(".origin-blurredimage-svg-stddeviation");t.length&&t[0].setStdDeviation(e,e)}))}var o=null,a={css:{template:iN},svg:{template:eN}},s="[origin-store-backgroundscrims]",c="origin-store-blursvg-active";return _.merge({restrict:"E",replace:!0,scope:{imageUrl:"=",blurValue:"=",imageOptions:"=",svgOptions:"="},link:r},n()?a.css:a.svg)}function Hr(e,t,i,n,r,o){"ngInject";return{restrict:"A",link:function(e){n.getObserver().attachToScope(e,"states"),e.isOIGContext=o.isOIGContext(),e.isSocialEnabled=o.enableSocialFeatures(),e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),e.isSocialEnabled&&(e.isSocialAccessiblityEnabled=!0),r.addResizeEventHandler(e,n.handleWindowResize,300)}}}function zr(e,t,i){"ngInject";return{restrict:"E",scope:{name:"@",delay:"@"},link:function(n,r){function o(e){e&&r.html(i(e)(n))}window.requestIdleCallback(function(){e.getTemplate(n.name,t).then(o)},{timeout:_.toInteger(n.delay)})}}}function Vr(e,t){"ngInject";return{restrict:"A",link:function(i,n){function r(){n.toggleClass("origin-fadein-visible",e.isOnOrAboveScreen(n))}n.addClass("origin-fadein"),t.addScrollEventHandler(i,r),setTimeout(r,20)}}}function Wr(e,t,i){"ngInject";return{restrict:"E",scope:{descStr:"@",titleStr:"@",btnStr:"@"},link:function(n,r,o){var a,s=angular.lowercase(o.feature);n.isVisible=!1,n.dismiss=function(){n.isVisible=!1},a=[e.events.on("featureintro:show"+s,function(){n.isVisible=!0})],n.strings={titleStr:i.getLocalizedStr(n.titleStr,dN,"title-str"),descStr:i.getLocalizedStr(n.descStr,dN,"desc-str"),btnStr:i.getLocalizedStr(n.btnStr,dN,"btn-str")},n.$on("$destroy",function(){t.detachAll(a)})},template:lN}}function qr(e){"ngInject";var t=this,i=["conjunction","second","seconds","minute","minutes","hour","hours","day","days","month","months","year","years"],n=t.maxUnits||mN,r=t.decimalDigits||fN;if(t.strings={},t.startDate||t.endDate){var o=t.startDate||Date.now(),a=t.endDate||Date.now();_.forEach(i,function(i){t.strings[i]=function(i){return e.getLocalizedStr(_.get(t,i),pN,i)}(i)}),_.every(t.strings,_.identity)&&countdown.setLabels("| "+t.strings.second+"| "+t.strings.minute+"| "+t.strings.hour+"| "+t.strings.day+"|| "+t.strings.month+"| "+t.strings.year,"| "+t.strings.seconds+"| "+t.strings.minutes+"| "+t.strings.hours+"| "+t.strings.days+"|| "+t.strings.months+"| "+t.strings.years," "+t.strings.conjunction+" ",null,"0 "+t.strings.days),t.evaluatedTime=countdown(o,a,countdown.YEARS|countdown.MONTHS|countdown.DAYS,n,r)}else t.evaluatedTime=void 0}function Yr(e){"ngInject";return{restrict:"A",link:function(t,i){function n(){i.removeClass(SN)}function r(){i.removeClass(kN),e(n,300,!1)}i.addClass(SN+" "+kN),i.one("load",r),t.$on("$destroy",function(){i.off("load",r)})}}}function Kr(e,t,i,n,r,o){"ngInject";return{restrict:"A",link:function(a,s,c){function l(){return 0===$("#infobubble-container").length&&$("body").append('<div id="infobubble-container"></div>'),$("#infobubble-container")}function d(){if(!(i.isTouchEnabled()||s.hasClass("origin-store-originaccess")&&"true"!==s.attr("hasinfobubble"))){var t,r,o,d,g=s.outerHeight(),m=s.outerWidth(),h=s.get(0).getBoundingClientRect(),v=0;a.$emit("infobubble-show"),u(),b=l(),0===g&&0===m&&(g=h.height,m=h.width),t=h.top+g,o=(r=h.left+m/2)-k,r+k>n.innerWidth&&(v=r-(r=n.innerWidth-k))>120&&(v=120),o<0&&(v=r-(r=150)),f="infobubble-"+t+"-"+r,b.data("id")===f&&0!==b.find(" > .origin-infobubble").length||(b.data("id",f),d=e('<div class="origin-infobubble"><div class="origin-infobubble-arrow origin-infobubble-arrow-up"></div><div class="origin-infobubble-content otkc otkc-small">'+c.originInfobubble+"</div></div>")(a),b.empty().append(d),d.on("mouseenter",u),d.on("mouseleave",p)),d=b.find(" > .origin-infobubble"),b.find(".origin-infobubble-arrow").css("left","calc(50% + "+v+"px)"),b.css({top:t,left:r}),t+I>$(window).height()?(b.css({transform:"rotateX(180deg) translateY("+g+"px)"}),b.find(".origin-infobubble-content").addClass("origin-infobubble-content-flipped")):(b.css({transform:""}),b.find(".origin-infobubble-content").removeClass("origin-infobubble-content-flipped")),d.addClass("origin-infobubble-isvisible")}}function g(e){b=$("#infobubble-container"),(!1===y||e)&&(a.$emit("infobubble-hide"),(b.data("id")===f&&!w||e)&&b.css({top:0,left:0}).find(" > .origin-infobubble").removeClass("origin-infobubble-isvisible"))}function u(){y=!0,t.cancel(h),h=t(function(){y=!1},S)}function p(e){t.cancel(v),s.is(e.currentTarget)&&(w=!1),v=t(function(){g()},S)}function m(){w=!1,g(!0),(b=l()).data("id")===f&&b.data("id",null),s.off(),s.find(" > .origin-infobubble").off(),t.cancel(v),t.cancel(h),o.events.off("uiRouter:stateChangeStart",m)}var f,h,v,b,y=!1,S=100,k=180,I=180,w=!1;a.$on(Ey.J,function(){_.isUndefined(b)||(y=!1,g(),b.empty())}),a.$on("contextMenu:visibilityUpdate",function(e,t){a.isContextMenuVisible=t,e.stopPropagation()}),s.on("mouseenter",function(){t.cancel(v),w=!0,a.isContextMenuVisible||d()}),s.on("mouseleave",p),a.$on("$destroy",m),o.events.on("uiRouter:stateChangeStart",m),r.addScrollEventHandler(a,g)}}}function Qr(e){"ngInject";return{restrict:"E",scope:{message:"@",type:"@"},link:function(t){t.type=t.type||TN.standard,t.TypeEnumeration=TN,t.message=e.getLocalizedStr(t.message,PN,"message"),t.typeClass=_N[t.type]},template:CN}}function Jr(e,t,i){"ngInject";return{restrict:"E",scope:{legalDisclaimerText:"@",legalDisclaimerLinkText:"@",legalDisclaimerDialogHeaderText:"@",legalDisclaimerDialogBodyTitleText:"@",legalDisclaimerDialogBodyText:"@"},link:function(n,r){function o(){t.close(FN)}var a='<a class="otka origin-legaldisclaimer-link">'+e.getLocalizedStr(n.legalDisclaimerLinkText,FN,"legal-disclaimer-link-text")+"</a>",s='<p class="otkc origin-legaldisclaimer-title"><strong>'+n.legalDisclaimerDialogBodyTitleText+'</strong></p><p class="otktitle-5">'+n.legalDisclaimerDialogBodyText+"</p>";n.legalDisclaimerText?n.legalDisclaimerTextFormatted=e.getLocalizedStr(n.legalDisclaimerText,FN,"legal-disclaimer-text",{"%legal-disclaimer-link-text%":a}):n.legalDisclaimerTextFormatted=a,r.on("click",".origin-legaldisclaimer-link",function(){t.open({id:FN,size:"large",directives:[{id:FN,name:"origin-dialog-content-legaldisclaimer",data:{header:n.legalDisclaimerDialogHeaderText,body:s}}]})}),i.events.on(xN,o),n.$on("$destroy",function(){i.events.off(xN,o)})},template:EN}}function Xr(e,t){"ngInject";return{restrict:"A",scope:{originLineclamp:"="},link:function(i,n){var r=parseInt(n.css("line-height"),10),o=t.browserSupports("line-clamp");n.addClass("origin-lineclamp"),i.$watch("originLineclamp",function(t,i){var a;t!==i&&(t?(a=t)&&r&&(n.css("height",a*r+RN),o&&n.css(e.addVendorPrefixes("line-clamp",a+""))):(n.css("height","auto"),o&&n.css(e.addVendorPrefixes("line-clamp",""))))})}}}function Zr(e,t){"ngInject";e.spinnerImage=t.getImagePath("loader.png")}function eo(e,t){"ngInject";return{restrict:"A",link:function(i,n){var r=e.subscribeToChanges(function(){n.toggleClass("otk-loading-fixed-white origin-ui-block",e.isBlocked()),t.getOIGContextConfig()&&n.toggleClass("otk-loading-fixed-white origin-ui-block-oig",e.isBlocked())});i.$on("$destroy",r)}}}function to(e,t,i,n){"ngInject";return{restrict:"A",link:function(r,o){function a(){o.removeClass(HN).addClass(jN),setTimeout(s,BN)}function s(){o.removeClass(zN).removeClass(MN+" "+jN),e.events.fire("uiRouter:stateChangeAnimationComplete")}function c(e,t,i,n){g&&clearTimeout(g),setTimeout(OriginSkeletonScreen.hideSkeletonScreen,WN),d?d=!1:_.get(t,qN)&&_.get(n,qN)&&(o.addClass(zN),setTimeout(a,BN))}function l(){t.detachAll(u)}var d=!0,g=void 0,u=[e.events.on("uiRouter:stateChangeStart",function(e,t,r,a){!d&&_.get(t,qN)&&_.get(a,qN)?(g=setTimeout(function(){g=void 0,OriginSkeletonScreen.showSkeletonScreen()},VN),o.addClass(HN+" "+MN),t.data.scrollToTopOnLoad&&i(n,BN)):t.data.scrollToTopOnLoad&&n()}),e.events.on("uiRouter:stateChangeSuccess",c),e.events.on("uiRouter:stateChangeError",c)];t.attachAll(u),r.$on("$destroy",l)}}}function io(e,t,i){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{depth:"@"},template:KN,link:function(n,r){function o(){if(s=window.pageYOffset-r.offset().top,t.isXSmall()||0===window.pageYOffset)a.removeAttr("style");else{var i=((1-c/n.depth)*s).toFixed(2),o="translate3d(0,"+Math.max(i,0)+"px, 0)";a.css(e.addVendorPrefixes("transform",o))}}var a=r,s=0,c=1;i.addScrollEventHandler(n,o),setTimeout(function(){o()},0)}}}function no(e,t,i,n,r){"ngInject";return{restrict:"E",link:function(o,a){function s(){P.style.display="none",P.offsetWidth,P.style.display="block",O.elm.style.display="none",O.elm.offsetWidth,O.elm.style.display="block"}function c(){if("light"===o.theme){P.classList.add(ZN),_.classList.add(eG);for(var e=0,t=w.length;e<t;e++)w[e].classList.add(oG);n(s,0)}}function l(){for(var e=0,t=o.items.length;e<t;e++)o.items[e].href||(o.items[e].href="#")}function d(){w=_.querySelectorAll(rG),O.items=O.list.getElementsByTagName("li")}function g(e){if(!e)return 0;var t=o.items[e-1];return t.width+t.left+t.margins}function u(){for(var e,t,i=0,n=w.length;i<n;i++)"none"!==(e=window.getComputedStyle(w[i])).display&&((t=w[i].classList.contains(aG)?O:o.items[i]).width=Math.round(w[i].offsetWidth),t.margins=Math.round(parseFloat(e.marginLeft,10)+parseFloat(e.marginRight,10)),t.widthAndMargin=t.width+t.margins,t.left=g(i),t.right=t.left+t.widthAndMargin)}function p(){if(o.items.length&&_.offsetWidth){for(var e=P.offsetWidth,t=O.widthAndMargin+dG,i=o.items.length-1,n=0,r=o.items.length;n<r;n++)if(n===i&&(t=dG),o.items[n].right+t>e)return F=n;return F=o.items.length}}function m(){for(var e=_.querySelectorAll("."+cG),t=0,i=e.length;t<i;t++)e[t].classList.remove(cG)}function f(){for(var e=o.items.length,t=0;t<e;t++)t<F?O.items[t].classList.add(cG):w[t].classList.add(cG);F===e&&O.elm.classList.add(cG)}function h(){_.classList.remove(iG)}function v(){o.showDropdown=!1,P.classList.remove(tG),C.off("click",v),o.$digest()}function b(){var e,i,n,r=F-1;r>=0&&o.selectedIndex>r?(e=O.width,i=o.items[r].right):(e=o.items[o.selectedIndex].width,i=o.items[o.selectedIndex].left),(n=t.addVendorPrefixes("transform","translate3d("+i+"px, 0, 0)")).width=e+"px",E.css(n)}function y(){o.items.length&&(angular.isUndefined(o.selectedIndex)&&(o.selectedIndex=0),o.$watch("selectedIndex",b))}function S(){p(),m(),f(),b(),o.showDropdown&&v()}function k(){new Promise(function(e){var t=0;o.$on("postrepeat:last",function(i){i.preventDefault(),i.stopPropagation(),2==++t&&e()})}).then(l).then(d).then(c).then(u).then(p).then(m).then(f).then(h).then(y)}var I=r.isNoCommerceContext();o.strings={moreText:e.getLocalizedStr(o.moreText,lG,"more-text")};var w,C=angular.element(document.getElementsByTagName("body")[0]),T=a[0],P=T.querySelector(XN),_=T.querySelector(nG),O={elm:T.querySelector("."+aG),list:T.querySelector("."+aG+" .otkmenu-dropdown")},E=angular.element(T.querySelector(sG)),F=0;o.showDropdown=!1,o.items=[],o.toggleDropdown=function(){o.showDropdown=!o.showDropdown,o.showDropdown?(P.classList.add(tG),setTimeout(function(){C.one("click",v)},0)):P.classList.remove(tG)},o.navItemClick=function(e,t,i){e.preventDefault(),o.navClick?o.navClick()(t):o.selectedIndex=i},o.onChange=function(){var e=parseInt(o.navSelectValue,10),t=o.items[e];o.navClick?o.navClick()(t):o.selectedIndex=e},o.$on("pills:resize",function(){setTimeout(S,100)}),i.addResizeEventHandler(o,S,30),o.$watchCollection("navItems",function(e){k();var t=angular.copy(e);o.items=I?t.filter(function(e){return e.friendlyname!==gF}):t})},scope:{navItems:"=",theme:"@",navClick:"&",selectedIndex:"=",moreText:"@"},template:JN}}function ro(e,t,i){"ngInject";var n;e.selectedPolicy=null,e.policies={},e.dateFormat=uG,this.registerPolicyItem=function(r){n=n||r,r.date=t(r.date,uG),e.policies[r.id]=r,e.selectedPolicy=e.policies[i.id]||n},this.getSelectedPolicy=function(){return e.selectedPolicy}}function oo(e,t){"ngInject";return{restrict:"E",scope:{theme:"@",hideFacebook:"@",titleStr:"@",twitterShareText:"@",twitterVia:"@",hashtags:"@"},link:function(i){i.themeEnumeration=tk,e.populateScope(i,bG).then(function(){i.isFacebookHidden=i.hideFacebook===OS.true,i.href=window.location.href,i.twitterShareText=t.getLocalizedStr(i.twitterShareText,bG,"twitter-share-text"),i.twitterVia=t.getLocalizedStr(i.twitterVia,bG,"twitter-via"),i.hashtags=t.getLocalizedStr(i.hashtags,bG,"hashtags")})},template:vG}}function ao(e){"ngInject";var t=e.forEach;return{restrict:"A",link:function(e,i,n){function r(e,t){if(e instanceof Array)for(var n in e)t.hasOwnProperty(n)&&i.css(t,e[n]);else i.css(t,e)}e.$watch(n.originStyle,function(e){t(r,e)})}}}function so(){"ngInject";var e;this.hidePageContent=function(){e&&_.isFunction(e)&&e(!1)},this.showPageContent=function(){e(!0)},this.registerPageContent=function(t){e=t},setTimeout(Origin.telemetry.sendDomLoadedTelemetryEvent,0)}function co(e,t){"ngInject";return{restrict:"A",link:function(i,n,r){function o(e){i.$evalAsync(function(){a(i,{$event:e})})}var a=t(r.originTouch,null,!0);e.isTouchEnabled()&&(n.on("click",o),i.$on("$destroy",function(){n.off("click",o)}))}}}function lo(e){"ngInject";return{scope:{videoId:"@",playlist:"@"},link:function(t,i){var n=i.find(OG),r={controls:1,loop:0,showinfo:1};r=t.playlist&&1===t.playlist.split(",").length&&_.startsWith(t.playlist,"PL")?_.merge(r,{list:t.playlist,listType:"playlist"}):_.merge(r,{playlist:t.playlist}),e.loadYoutubePlayer(n,t.videoId,r)},template:_G}}function go(e,t,i){"ngInject";e.backgroundImageUrl=t.getLocalizedStr(e.backgroundImageUrl,EG,"background-image-url"),e.betaScreenImageUrl=t.getLocalizedStr(e.betaScreenImageUrl,EG,"beta-screen-image-url"),e.betaTitleLogoUrl=t.getLocalizedStr(e.betaTitleLogoUrl,EG,"background-title-logo-url"),e.title=t.getLocalizedStr(e.title,EG,"title"),e.description=t.getLocalizedStr(e.description,EG,"description"),e.btnBackToHome=t.getLocalizedStr(e.btnBackToHome,EG,"btn-back-to-home"),e.goToMyHome=function(){i.goHome()}}function uo(e,t,i,n,r){"ngInject";e.visible=!1,r.isNoCommerceContext()?n.goToState(bI.w,{}):(e.bannerBackgroundImageUrl=t.getLocalizedStr(e.bannerBackgroundImageUrl,xG,"banner-background-image-url"),e.eadcScreenImageUrl=t.getLocalizedStr(e.eadcScreenImageUrl,xG,"eadc-screen-image-url"),e.eadcGamesImageUrl=t.getLocalizedStr(e.eadcGamesImageUrl,xG,"eadc-games-image-url"),e.eadcLogoUrl=t.getLocalizedStr(e.eadcLogoUrl,xG,"eadc-logo-url"),e.eaplayLogoUrl=t.getLocalizedStr(e.eaplayLogoUrl,xG,"eaplay-logo-url"),e.mainTitle=t.getLocalizedStr(e.mainTitle,xG,"main-title"),e.mainDescription=t.getLocalizedStr(e.mainDescription,xG,"main-description"),e.subtitle1=t.getLocalizedStr(e.subtitle1,xG,"subtitle1"),e.subDescription1=t.getLocalizedStr(e.subDescription1,xG,"sub-description1"),e.subtitle2=t.getLocalizedStr(e.subtitle2,xG,"subtitle2"),e.subDescription2=t.getLocalizedStr(e.subDescription2,xG,"sub-description2"),e.subtitle3=t.getLocalizedStr(e.subtitle3,xG,"subtitle3"),e.subDescription3=t.getLocalizedStr(e.subDescription3,xG,"sub-description3"),e.eaplayTitle=t.getLocalizedStr(e.eaplayTitle,xG,"eaplay-title"),e.eaplayDescription=t.getLocalizedStr(e.eaplayDescription,xG,"eaplay-description"),e.bottomTitle=t.getLocalizedStr(e.bottomTitle,xG,"bottom-title"),e.faqTitle=t.getLocalizedStr(e.faqTitle,xG,"faq-title"),e.btnDownload=t.getLocalizedStr(e.btnDownload,xG,"btn-download"),e.arrowDownSvgPath=i.getImagePath("arrow-down.svg"),e.downloadEADC=function(){n.externalUrl("https://origin-a.akamaihd.net/EA-Desktop-Client-Download/installer-releases/EADesktopInstaller.exe")},e.scrollPage=function(){angular.element("html, body").animate({scrollTop:820},"fast")},e.visible=!0)}function po(e,t,i){"ngInject";e.title=i.getLocalizedStr(e.title,AG,"title"),e.description=t.trustAsHtml(i.getLocalizedStr(e.description,AG,"description"))}function mo(e,t,i,n,r,o,a,s){"ngInject";function c(t){return t&&t.length&&(e.gameResults=t,e.isGamesVisible=!0),e.$digest(),t}function l(t){var i=t.store,n=t.people;return i&&(e.storeResults=i,e.isStoreVisible=!0),n&&(e.peopleResults=n,e.isPeopleVisible=!0),t}function d(t){_.isEmpty(t)||(I+=GG,e.peopleResults.users.push.apply(e.peopleResults.users,t.infoList),e.peopleResults.totalFound=t.totalCount,0===t.totalCount?e.noResultsFound=!0:e.isPeopleVisible=!0)}function g(){return n.searchGames().then(c).catch(function(e){return r.error("[Origin-Search-Results-Directive SearchGames Method] error",e)})}function u(){var t={isGDP:e.showGdpSearchResult};return n.searchStoreAndPeople(t).then(l).catch(function(e){return r.error("[Origin-Search-Results-Directive searchStoreAndPeople Method] error",e)})}function p(e){var t=m();o.isClientOnline()&&n.searchPeople(t,e).then(d).catch(function(e){return r.error("[Origin-Search-Results-Directive searchMorePeople Method] error",e)}).finally(S)}function m(){return i.searchString?decodeURI(i.searchString):""}function f(t){var n=t.shouldDigest;e.showingAllPeople=!1,e.isLoading=!0,e.noResultsFound=!1,e.isOffline=!1,e.isGamesVisible=!1,e.isStoreVisible=!1,e.isPeopleVisible=!1,e.peopleResultsLimit=UG,e.storeResultsLimit=BG,e.storeGdpResultsLimit=MG,n&&e.$digest(),o.isClientOnline()?o.isAppLoggedIn()?i.category===zG?(I=0,e.peopleResultsLimit=HG,e.showingAllPeople=!0,e.peopleResults={users:[]},p(I)):Promise.all([g(),u()]).then(v).finally(S):(e.storeResultsLimit=jG,u().then(b).finally(S)):g().then(y).finally(S)}function h(e){var t=e.gameLibraryResults,i=e.storeResults,n=e.peopleResults;Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_result","user","search_result",{searchString:m(),gameLibraryResults:t.toString(),storeResults:i.toString(),peopleResults:n.toString()})}function v(t){var i=$G(t,2),n=i[0],r=i[1],o=_.get(n,["length"],0),a=_.get(r,["store","totalFound"],0),s=_.get(r,["people","totalFound"],0);h({gameLibraryResults:o,storeResults:a,peopleResults:s}),Origin.telemetry.sendMarketingEvent("Global Search","Search",m()),e.noResultsFound=!o&&!a&&!s}function b(t){var i=_.get(t,["store","totalFound"],0),n=_.get(t,["people","totalFound"],0);h({gameLibraryResults:0,storeResults:i,peopleResults:n}),e.noResultsFound=!i&&!n}function y(t){e.isOffline=!0,e.noResultsFound=!t.length}function S(){e.isLoading=!1,e.$digest()}function k(){f({shouldDigest:!0})}var I=0,w=[];e.showGdpSearchResult=!_.isUndefined(e.showGdpResult)&&e.showGdpResult===OS.true,e.searchingLoc=a.getLocalizedStr(e.searchingStr,NG,"searching"),e.showAllPeopleCallback=function(){Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_view_all","user","search_view_all",{category:"people"}),e.isGamesVisible=!1,e.isStoreVisible=!1,e.peopleResultsLimit=HG,e.showingAllPeople=!0,window.scrollTo(0,0),t.go(t.current,{searchString:m(),category:zG})},e.loadMorePeopleResults=function(){!e.isLoading&&I<e.peopleResults.totalFound&&(e.isLoading=!0,p(I),e.$digest())},o.waitForAuthReady().then(function(){f({shouldDigest:!1})}).catch(function(e){return r.error("[Origin-Search-Results-Directive AuthReady] error",e)}),w=[o.events.on("myauth:change",k),o.events.on("myauth:clientonlinestatechanged",k)],e.$on("$destroy",function(){s.detachAll(w)})}function fo(e){"ngInject";return{restrict:"E",scope:{searchingStr:"@searching",showGdpResult:"@"},transclude:!0,template:RG,controller:mo,link:function(t){e.addScrollEventHandler("scroll",function(){var e=window.scrollY||window.pageYOffset;window.innerHeight+e>=document.body.scrollHeight&&t.showingAllPeople&&t.loadMorePeopleResults()})}}}function ho(e,t,i,n,r){"ngInject";e.showViewMore=!0,e.gamesTitleLoc=r.getLocalizedStr(e.gamesTitle,WG,"gamestitle"),e.storeTitleLoc=r.getLocalizedStr(e.storeTitle,WG,"storetitle"),e.peopleTitleLoc=r.getLocalizedStr(e.peopleTitle,WG,"peopletitle"),e.gamesViewMoreLoc=r.getLocalizedStr(e.gamesViewMore,WG,"gamesviewmore"),e.storeViewMoreLoc=r.getLocalizedStr(e.storeViewMore,WG,"storeviewmore"),e.peopleViewMoreLoc=r.getLocalizedStr(e.peopleViewMore,WG,"peopleviewmore"),e.showViewMoreTextLoc=r.getLocalizedStr(e.showViewMoreText,WG,"showviewmoretext"),n.isAppLoggedIn()&&(e.showViewMore=!1),e.isShowingOnlyPeople=i.category===qG,e.goToStoreBrowse=function(){Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_view_all","user","search_view_all",{category:"store"}),t.go(bI.N,{searchString:decodeURI(i.searchString)})},e.goToGamesLibrarySearchResults=function(){Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_view_all","user","search_view_all",{category:"games_library"}),t.go(bI.w,{searchString:i.searchString})}}function vo(e,t,i){"ngInject";e.loggedOutTitleLoc=t.getLocalizedStr(e.loggedOutTitleStr,KG,"loggedouttitle"),e.logInButtonLabelLoc=t.getLocalizedStr(e.logInButtonLabelStr,KG,"loginbuttonlabel"),e.logIn=function(){return i.events.fire("auth:login")}}function bo(e,t,i,n,r,o){"ngInject";function a(t){var i=t.isLoggedIn;e.isLoggedIn=i}function s(t){a(t),e.$digest()}var c=i.getLocalizedStrGenerator(JG);e.noResultsFoundTitleLoc=c(e.noResultsFoundTitleStr,"noresultsfoundtitle"),e.noResultsFoundDescLoc=c(e.noResultsFoundDescStr,"noresultsfounddesc"),e.noResultsFoundLoggedoutLoc=c(e.noResultsFoundLoggedoutStr,"noresultsfoundloggedout"),e.gameCarouselTitleLoc=c(e.gameCarouselTitleStr,"gamecarouseltitle"),e.gameCarouselDescLoc=c(e.gameCarouselDescStr,"gamecarouseldesc"),e.searchString=decodeURI(t.searchString),e.isOnline=n.isClientOnline(),e.isNoCommerceContext=o.isNoCommerceContext(),n.events.on("myauth:change",s),e.$on("$destroy",function(){n.events.off("myauth:change",s)}),n.waitForAuthReady().then(a).catch(function(e){r.error("Search No Results Page - authReadyError:",e)})}function yo(e,t){"ngInject";e.offlineTitleLoc=t.getLocalizedStr(e.offlineTitleStr,ZG,"offlinetitle"),e.offlineMessageLoc=t.getLocalizedStr(e.offlineMessageStr,ZG,"offlinemessage"),e.goOnlineButtonLabelLoc=t.getLocalizedStr(e.goOnlineButtonLabelStr,ZG,"goonlinebuttonlabel"),e.goOnline=function(){return Origin.client.onlineStatus.goOnline()}}function So(e){var t=Origin.utils.os(),i=Origin.utils.OS_WINDOWS,n=Origin.utils.OS_MAC,r=_.get(e,[DI._15,i,DI._21]),o=_.get(e,[DI._15,n,DI._21]),a=_.get(e,[DI._15,i,DI.m]),s=_.get(e,[DI._15,i,DI._31]),c=_.get(e,[DI._15,n,DI.m]),l=_.get(e,[DI._15,n,DI._31]);return t===i?(e.releaseDate=r||o,e.downloadStartDate=a||c,e.useEndDate=s||l):(e.releaseDate=o||r,e.downloadStartDate=c||a,e.useEndDate=l||s),e}function ko(e){return e.gameRatingReason&&_.isEmpty(e.gameRatingDesc)&&(e.gameRatingDesc=_.compact(e.gameRatingReason.split(","))),e}function Io(e,t){var i=[];return e.isCurrency?i=t.currency:e.isGameName?i=t.basegames:e.isAddon?i=t.addon:e.isExpansion?i=t.expansion:e.isGameTime&&(i=t["game-time"]),i.filter(wo)}function wo(e){return _.get(e,DI.N,!1)}function Co(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b){"ngInject";var y={},S=s.buildPathFromUrl();t.gdpPath=S.gdpPath,t.isCurrencyGdp=S.isCurrency,t.isBasegameGdp=S.isGameName,t.isAddonGdp=S.isAddon,t.readMoreUrl=n.getAbsoluteUrl(n.getCurrentState())+"#"+_U+EU,t.readMoreClick=function(){n.changeHash(_U+EU),r.events.fire(PU)},t.isStoreExclusive=b.isFictionalCurrencyExclusiveByGdpPath(S),t.getCurrencyName=function(e,t){var i=_.get(y,t);return i?e+" - "+i:e},t.onCurrencyChange=function(e){e!==_.get(t,[fU,dU,DI.Y],"")&&(t.models.gdpInfoModel=_.head(_.values(_.filter(t.models.currency,{offerId:e}))),r.events.fire(Ey.F),w())};var k,I=function(e){return!o.isVaultGameOrUpgradeable(e)&&!p.isPremierVaultGameOrUpgradable(e)||m.isGameGiveAwaySubType(e)},w=function(){t.showDiscountArea=!1,d.digestIfDigestNotInProgress(t);var e=_.get(t,[fU,gU],[]),i=_.get(t,[fU,dU],{}),n=!1;if(S.isCurrency||S.isGameTime?setTimeout(function(){t.showDiscountArea=!0,d.digestIfDigestNotInProgress(t)}):(S.isAddon||S.isExpansion)&&I(i)&&!f.isAnnouncement(i)?n=!0:t.isBasegameGdp&&rU(e)&&I(i)&&(n=!0),n){var r=_.get(i,DI.Y,"");a.getEntitlementsPromise([r]).then(function(e){t.showDiscountArea=!oU(e),d.digestIfDigestNotInProgress(t)}).catch(function(e){return g.error("GDP - discount error",e)})}};Promise.all([a.getCatalogModelPromise(S),a.getEditionAgnosticModelPromise(S),(k=t.gdpPath,t.isBasegameGdp?e.isEligibleForPromotionByGdpPath(k).then(function(e){var i=e.isEligible,n=e.loyaltyOfferId;t.hasLoyaltyOffer=i,t.loyaltyOfferId=n}):Promise.resolve()),c.populateScope(t,FU,void 0,!1)]).then(_.spread(function(e,i){var n=e,r=i,o=function(){var e=h.search().loyaltypromotion;return e?e.split(","):[]}();if(v.isOIGContext()&&o.length&&t.isBasegameGdp){var a=e.basegames.filter(function(e){return o.indexOf(e.offerId)>-1}),s=e.allBasegames.filter(function(e){return o.indexOf(e.offerId)>-1});n.basegames=a.length?a:e.basegames,n.allBasegames=s.length?s:e.allBasegames,r=a.length?_.first(a):i}t.models=n,t.models.gdpInfoModel=r})).then(function(){return u.handleAutoActions(!1)}).then(function(){t.displayName=t.displayName||_.get(t,[fU,dU,DI.I,DI.k],""),t.shortDescription=t.shortDescription||_.get(t,[fU,dU,DI.I,DI._22],""),t.longDescription=i("limitHtml")({text:t.longDescription||_.get(t,[fU,dU,DI.I,DI.S],""),limit:OU,truncationString:"&hellip;",breakOnBrTag:t.breakOnBrTag===OS.true,preserveInlineStyles:!0,isDescription:!0}),t.textShade=t.isLightBackground===OS.true?"dark":"light",t.isRatingBackgroundLight=t.ratingBackground?t.ratingBackground===FS.light:t.isLightBackground,t.platforms=l.getSupportedPlatforms(t.models.gdpInfoModel)}).then(w).then(function(){if(t.isCurrencyGdp){var e=_.map(_.get(t.models,"currency",[]),DI.Y);return function(){var e=_.get(t,[fU,yU],[]);if(t.defaultCurrencyOverride){var i=_.filter(e,{offerPath:t.defaultCurrencyOverride});t.models.gdpInfoModel=_.head(_.values(i))}else{var n=_.floor(_.size(e)/2);t.models.gdpInfoModel=_.get(e,n)}}(),a.getPricePromise(e).then(function(t){_.forEach(t,function(i,n){y[e[n]]=t[n]})})}}).then(function(){t.gdpDataReady=!0,d.digestIfDigestNotInProgress(t)}).catch(function(e){return g.error("GDP - model error",e)})}function To(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Po(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";return{restrict:"E",replace:!0,scope:{logo:"@",browse:"@",description:"@"},template:tU,link:function(u,p){function m(e,t){return e.isCurrency?t.currency:e.isAddon?t.addon:e.isExpansion?t.expansion:e.isGameName?t.basegames:[]}function f(e,t,i){return _.set(i,[DI.I,DI.k],e||_.get(i,[DI.I,DI.k])),_.set(i,[DI.I,DI.S],t||_.get(i,[DI.I,DI.S])),i}function h(e,t){if(0===t.length)return[{},{}];var i,n,r,o=e===bI._4,c=e===bI._5,g=(i=t[0],To(r={},DI._15,_.clone(_.get(i,[DI._15]))),To(r,DI.I,(To(n={},DI.k,_.get(i,[DI.I,DI.k])),To(n,DI.X,_.get(i,[DI.I,DI.X])),To(n,DI.S,_.get(i,[DI.I,DI.S])),To(n,DI._5,_.get(i,[DI.I,DI._5])),n)),To(r,DI.F,_.get(i,[DI.F])),To(r,DI._19,_.get(i,[DI._19])),To(r,DI.e,To({},DI.f,_.get(i,[DI.e,DI.f]))),r);if(o)return l.getOcdByPath(g.gdpPath).then(d.findDirectives(FU)).then(d.flattenDirectives(FU)).then(function(e){var t=LU(e,1)[0];return f(_.get(t,[_.kebabCase(DI.k)]),_.get(t,[_.kebabCase(DI.S)]),g)}).then(function(e){return[e,t]});if(c){var u=s.buildPathFromUrl();return a.getEditionAgnosticModelPromise(u).then(function(e){return f(_.get(e,[DI.I,DI.k]),_.get(e,[DI.I,DI.S]),g)}).then(function(e){return[e,t]})}return[g,t]}function v(e,t){var n=t[0],r=t[1];if(0===r.length)return{};var o,a=e===bI._4,s={PCWIN:"Windows",MAC:"OSX"},c={"@context":"http://schema.org","@type":a?["Product"]:["VideoGame","Product"],gamePlatform:a?void 0:_.map(_.keys(n[DI._15]),function(e){return _.get(s,e,e)}),operatingSystem:a?void 0:_.map(_.keys(n[DI._15]),function(e){return _.get(s,e,e)}),name:_.get(n,[DI.I,DI.k]),description:function(e){return e.replace(/(?:\r\n|\r|\n)/g," ")}((o=_.get(n,[DI.I,DI.X])||_.get(n,[DI.I,DI.S])||"",i("limitHtml")({text:o,limit:DU,truncationString:"&hellip;",breakOnBrTag:!1,preserveInlineStyles:!1}))),genre:a?void 0:_.get(n,[DI.F],"").split(","),applicationCategory:a?void 0:"Game",publisher:a?void 0:_.get(n,[DI._19]),url:window.location.href,sameAs:_.get(n,[DI.I,DI._5]),offers:[]},l=_.map(r,function(e){return _.get(e,[DI.Y])});return g.getRawPricePromise(l,_.get(n,[DI.e,DI.f])).then(function(e){var t=_.zipObject(l,e);return _.forEach(r,function(e){_.get(t,[_.get(e,[DI.Y])])&&c.offers.push({"@type":"Offer",price:t[_.get(e,[DI.Y])],sku:_.get(e,[DI.Y]),priceCurrency:_.get(e,[DI.e,DI.f]),availability:"http://schema.org/InStock"})}),c})}function b(e){var t=_.head(_.values(e)),i={"@context":"http://schema.org/","@type":"Product",name:t.displayName,image:t.packArt,description:t.shortDescription,brand:{"@type":"Thing",name:"Origin"},offers:{"@type":"Offer",availability:"http://schema.org/InStock",price:t.price,priceCurrency:Origin.locale.currencyCode(),priceValidUntil:moment().add(1,"day").format()}};c.injectStructuredDataScript(p,i),y()}function y(){var e={"@context":"http://schema.org","@type":"Organization",url:o.generateBaseUrl()+"/store/",logo:o.getLocalizedStr(u.logo,AU,"logo"),sameAs:["https://www.facebook.com/OriginInsider","https://twitter.com/originInsider","https://www.youtube.com/user/OriginInsider","https://plus.google.com/+OriginInsider"]};c.injectStructuredDataScript(p,e)}function S(e,t,i){var n,l,d,g;angular.element(p).html(""),t.name===bI.X||t.name===bI._8?function(e){var t=(e.franchise?"/"+e.franchise:"")+(e.game?"/"+e.game:"")+(e.type?"/"+e.type:"")+(e.edition?"/"+e.edition:"");r.getByOcdPathPromise(t).then(b)}(i):t.name===bI._5||t.name===bI.W||t.name===bI._4?(d=t.name,(g=s.buildPathFromUrl()).gdpPath&&a.getCatalogModelPromise(g,{skipErrorHandling:!0}).then(_.partial(m,g)).then(_.partial(h,d)).then(_.partial(v,d)).then(_.partial(c.injectStructuredDataScript,p)),y()):t.name===bI.N?(l='<div itemscope itemtype="http://schema.org/CollectionPage"><span itemprop="url">'+o.generateBaseUrl()+'/store/browse</span><span itemprop="name">'+o.getLocalizedStr(u.browse,AU,"browse")+'</span><span itemprop="description">'+o.getLocalizedStr(u.description,AU,"description")+"</span></div>",angular.element(p).append(l),y()):t.name===bI._6?(n={"@context":"http://schema.org","@type":"webSite",url:o.generateBaseUrl()+"/store",potentialAction:{"@type":"SearchAction",target:o.generateBaseUrl()+"/search?searchString={search_term_string}","query-input":"required name=search_term_string"}},c.injectStructuredDataScript(p,n),y()):y()}S(0,e.current,t),n.events.on("uiRouter:stateChangeStart",S),u.$on("$destroy",function(){n.events.off("uiRouter:stateChangeStart",S)})}}}function _o(e,t){"ngInject";return{restrict:"E",scope:{},link:function(){var i=t.isState(bI._2),n=e.getCanonicalLinkIfApplicable(i);if(n){var r=document.createElement("link");r.rel="canonical",r.href=n,angular.element("head").prepend(r)}}}}function Oo(e,t,i,n,r,o,a,s){"ngInject";function c(){var i,n,r,a=(s.isState(bI.N)?t.getBrowsePageContentTitle():"")||e.titleStr;return a?o.getLocalizedStr(!1,QU,ZU,(r=a,(n="%"+NU+"%")in(i={})?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i)):qU}function l(t,a,l,d){var g=s.isState(bI._2),u={url:i.getCanonicalUrl(g),locale:Origin.locale.locale()};if(!n.isPdpRoute()&&!r.isGdpRoute()){var p=void 0;u.image=d,u[NU]=a?o.getLocalizedStr(a,QU,t+"-title"):c(),l?p=o.getLocalizedStr(l,QU,t+"-description"):e.description&&(p=o.getLocalizedStr(e.description,QU,$U)),_.size(p)>0&&(u[$U]=o.truncateString(p,zU))}return u}this.init=function(){var t,s;t=a.getDefaults(QU),e.facebookImage=e.facebookImage||t["facebook-image"],e.twitterImage=e.twitterImage||t["twitter-image"],_.forEach(YU,function(t,a){if(e[a])if("titleStr"===a)n.isPdpRoute()||r.isGdpRoute()||i.setSeoData(NU,[],c());else if(a===$U){var s=o.getLocalizedStr(e[$U],QU,$U);i.setSeoMetaValue($U,o.truncateString(s,HU))}else i.setSeoMetaValue(a,e[a])}),(s=l(JU,e.facebookTitle,e.facebookDescription,e.facebookImage)).type=GU,s.site_name=qU,s[NU]&&(s[NU]=_.head(s[NU].split("|")).trim()),i.setSocialMediaTags(s,MU),function(){var t=l(XU,e.twitterTitle,e.twitterDescription,e.twitterImage);n.isPdpRoute()||r.isGdpRoute()||(t.card=WU),t.site=o.getLocalizedStr(e.twitterSite,QU,"twitter-site"),i.setSocialMediaTags(t,jU)}()}}function Eo(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Fo(e,t,i,n,r,o,a,s,c,l){"ngInject";return{restrict:"E",scope:eB,controller:"OriginSeoCommonCtrl",link:function(i,r,o,d){function g(e,t){if(e&&e[DI._21])return t.toLowerCase()}function u(t){var n,r,o,a={},s=_.get(t,[DI.I,DI.k]);return a[nB]=s||"",a[rB]=(n=t,r=[],o="",_.isObject(n[DI._15])&&(r=_.compact(_.map(n[DI._15],g)).sort().reverse(),o=_.toArray(_.pick(iB,r)).join("/")),o),e.getLocalizedStr(i.titleStr,tB,"title-str",a)}var p,m,f=(p=regeneratorRuntime.mark(function e(t){var i,n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getOcdByPath(_.get(t,DI._0));case 2:return i=e.sent,e.next=5,c.findDirectives(FU)(i);case 5:return n=e.sent,r=_.get(_.head(n),[FU,"background"]),o=r||_.get(t,[DI.I,DI._10]),a=r?WU:VU,e.abrupt("return",{socialMediaImage:o,twitterCardType:a});case 10:case"end":return e.stop()}},e,this)}),m=function(){var e=p.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e){return m.apply(this,arguments)}),h=void 0,v=!1,b=n.buildPathFromUrl();a.getEditionAgnosticModelPromise(b,{skipErrorHandling:!0}).then(function(n){var r;_.set(i,"model",n),d.init(),r=i.model,i[$U]||(h=i.shortDescription?e.getLocalizedStr(i.shortDescription,tB,"short-description"):_.get(r,[DI.I,DI.S])),function(i){_.isEmpty(i)||v||(h&&t.setSeoMetaValue($U,e.truncateString(h,HU)),t.setSeoData(NU,[],u(i)),v=!0)}(i.model),f(i.model).then(function(n){var r=n.socialMediaImage,o=n.twitterCardType;!function(i,n,r){var o=Eo({image:n},"image:alt",_.get(i,[DI.I,DI.k])),a=u(i);h&&(o[$U]=e.truncateString(h,zU));var s=Object.assign({card:r,title:a},o),c=Object.assign(Eo({},NU,_.head(a.split("|")).trim()),o);t.setSocialMediaTags(s,jU),t.setSocialMediaTags(c,MU)}(i.model,r,o)})}).catch(function(e){v=!1,l.error("[origin-gdp-seo GdpModelFactory.getEditionAgnosticModelPromise failed]",e)})}}}function xo(e,t,i,n,r){"ngInject";var o;e.eaAcctTitleStr=t.getLocalizedStr(e.eaAcctTitleStr,aB,"eaaccttitlestr"),e.editOnEATitleStr=t.getLocalizedStr(e.editOnEATitleStr,aB,"editoneatitlestr"),e.originIdStr=t.getLocalizedStr(e.originIdStr,aB,"originidstr"),e.passwordStr=t.getLocalizedStr(e.passwordStr,aB,"passwordstr"),e.secAndPrivTitleStr=t.getLocalizedStr(e.secAndPrivTitleStr,aB,"secandprivtitlestr"),e.secAndPrivTextStr=t.getLocalizedStr(e.secAndPrivTextStr,aB,"secandprivtextstr"),e.blocklistTitleStr=t.getLocalizedStr(e.blocklistTitleStr,aB,"blocklisttitlestr"),e.blocklistTextStr=t.getLocalizedStr(e.blocklistTextStr,aB,"blocklisttextstr"),e.unblockUserStr=t.getLocalizedStr(e.unblockUserStr,aB,"unblockuserstr"),e.loadingMoreStr=t.getLocalizedStr(e.loadingMoreStr,aB,"loadingmorestr"),e.securityImgSrc=i.getImagePath("security-temp-img.png"),e.loggedIn=Origin&&Origin.auth&&Origin.auth.isLoggedIn()||!1,e.myNucleusId=e.loggedIn&&Origin.user.userPid(),e.myOriginId=e.loggedIn&&Origin.user.originId(),e.getOriginIdStr=function(){return e.originIdStr+": "+e.myOriginId},e.getPasswordStr=function(){return e.passwordStr+": "},e.openURL=function(e){Origin.client.desktopServices.asyncOpenUrlWithEADPSSO(e)},o=e.myNucleusId,n.getAvatar(o,Origin.defines.avatarSizes.LARGE).then(function(t){e.avatarImgSrc=t,e.$digest()},function(){}).catch(function(e){r.error("originSettingsAccountCtrl: UserDataFactory.getAvatar failed",e)})}function Lo(e,t,i,n,r,o,a,s,c){"ngInject";function l(t){return function(i){e[t]=i,p()}}function d(){e.isOffline=Origin.client.isEmbeddedBrowser()&&!o.isClientOnline()}function g(t){for(var i in e.localesSortedArray=[],t)if(t.hasOwnProperty(i)){var n={value:i,label:t[i]};e.localesSortedArray.push(n)}e.localesSortedArray=_.sortBy(e.localesSortedArray,"label"),e.currentLocale=s.getDashedLocale(),e.fallbackLocale=e.currentLocale}var u=[],p=n.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);e.isUnderAge=Origin.user.underAge(),e.title=n.getLocalizedStr(e.titleStr,dB,"title-str"),e.defaultSectionStr=n.getLocalizedStr(e.defaultSectionStr,dB,"defaultsectionstr"),e.defaultSectionHintStr=n.getLocalizedStr(e.defaultSectionHintStr,dB,"defaultsectionhintstr"),e.defaultOriginStr=n.getLocalizedStr(e.defaultOriginStr,dB,"defaultletorigindecidestr"),e.defaultHomeStr=n.getLocalizedStr(e.defaultHomeStr,dB,"defaulthomestr"),e.defaultGameLibraryStr=n.getLocalizedStr(e.defaultGameLibraryStr,dB,"defaultgamelibrarystr"),e.defaultStoreStr=n.getLocalizedStr(e.defaultStoreStr,dB,"defaultstorestr"),e.languageSectionStr=n.getLocalizedStr(e.languageSectionStr,dB,"languagesectionstr"),e.languageSectionHintStr=n.getLocalizedStr(e.languageSectionHintStr,dB,"languagesectionhintstr"),e.showOriginStr=n.getLocalizedStr(e.showOriginStr,dB,"showoriginstr"),e.showOriginHintStr=n.getLocalizedStr(e.showOriginHintStr,dB,"showoriginhintstr"),e.clientupdatestr=n.getLocalizedStr(e.clientupdatestr,dB,"clientupdatestr"),e.updategamesstr=n.getLocalizedStr(e.updategamesstr,dB,"updategamesstr"),e.updategameshintstr=n.getLocalizedStr(e.updategameshintstr,dB,"updategameshintstr"),e.updateoriginstr=n.getLocalizedStr(e.updateoriginstr,dB,"updateoriginstr"),e.updateoriginhintstr=n.getLocalizedStr(e.updateoriginhintstr,dB,"updateoriginhintstr"),e.originbetastr=n.getLocalizedStr(e.originbetastr,dB,"originbetastr"),e.originbetahintstr=n.getLocalizedStr(e.originbetahintstr,dB,"originbetahintstr"),e.startupstr=n.getLocalizedStr(e.startupstr,dB,"startupstr"),e.autostartstr=n.getLocalizedStr(e.autostartstr,dB,"autostartstr"),e.autostarthintstr=n.getLocalizedStr(e.autostarthintstr,dB,"autostarthintstr"),e.helperstr=n.getLocalizedStr(e.helperstr,dB,"helperstr"),e.helperhintstr=n.getLocalizedStr(e.helperhintstr,dB,"helperhintstr"),e.lhresponderstr=n.getLocalizedStr(e.lhresponderstr,dB,"lhresponderstr"),e.shortcutstr=n.getLocalizedStr(e.shortcutstr,dB,"shortcutstr"),e.shortcuthintstr=n.getLocalizedStr(e.shortcuthintstr,dB,"shortcuthintstr"),e.shortcutcreatestr=n.getLocalizedStr(e.shortcutcreatestr,dB,"shortcutcreatestr"),e.menushortcutstr=n.getLocalizedStr(e.menushortcutstr,dB,"menushortcutstr"),e.menushortcuthintstr=n.getLocalizedStr(e.menushortcuthintstr,dB,"menushortcuthintstr"),e.menushortcutcreatestr=n.getLocalizedStr(e.menushortcutcreatestr,dB,"menushortcutcreatestr"),e.goOnlineStr=n.getLocalizedStr(e.goOnlineStr,dB,"go-online-str"),e.accessibilitystr=n.getLocalizedStr(e.accessibilitystr,dB,"accessibilitystr"),e.chattexttospeechstr=n.getLocalizedStr(e.chattexttospeechstr,dB,"chattexttospeechstr"),e.chattexttospeechhintstr=n.getLocalizedStr(e.chattexttospeechhintstr,dB,"chattexttospeechhintstr"),e.advancedStr=n.getLocalizedStr(e.advancedStr,dB,"advanced-str"),e.restrictedAccessStr=n.getLocalizedStr(e.restrictedAccessStr,dB,"restricted-access-str"),e.restrictedAccessHintStr=n.getLocalizedStr(e.restrictedAccessHintStr,dB,"restricted-access-hint-str"),e.restrictedAccessEnableTitleLoc=n.getLocalizedStr(e.restrictedAccessEnableTitleLoc,dB,"restricted-access-enable-text-title-loc"),e.restrictedAccessEnableTextLoc1=n.getLocalizedStr(e.restrictedAccessEnableTextLoc1,dB,"restricted-access-enable-text-loc1"),e.restrictedAccessEnableTextLoc2=n.getLocalizedStr(e.restrictedAccessEnableTextLoc2,dB,"restricted-access-enable-text-loc2"),e.restrictedAccessEnableTextLocUrl=n.getLocalizedStr(e.restrictedAccessEnableTextLocUrl,dB,"restricted-access-enable-text-loc-url"),e.restrictedAccessEnableTextLocUrlDesc=n.getLocalizedStr(e.restrictedAccessEnableTextLocUrlDesc,dB,"restricted-access-enable-text-loc-url-desc"),e.restrictedAccessEnableTextLoc=n.getLocalizedStr(e.restrictedAccessEnableTextLoc,dB,"restricted-access-enable-text-loc",{"%restricted-access-enable-text-loc1%":e.restrictedAccessEnableTextLoc1,"%restricted-access-enable-text-loc2%":e.restrictedAccessEnableTextLoc2,"%restricted-access-enable-text-loc3%":e.restrictedAccessEnableTextLocUrl,"%restricted-access-enable-text-loc4%":e.restrictedAccessEnableTextLocUrlDesc}),e.restrictedAccessEnableOkLoc=n.getLocalizedStr(e.restrictedAccessEnableOkLoc,dB,"restricted-access-enable-ok-loc"),e.restrictedAccessEnableCancelLoc=n.getLocalizedStr(e.restrictedAccessEnableCancelLoc,dB,"restricted-access-enable-cancel-loc"),e.restrictedAccessDisableTitleLoc=n.getLocalizedStr(e.restrictedAccessDisableTitleLoc,dB,"restricted-access-disable-title-loc"),e.restrictedAccessDisableTextLoc1=n.getLocalizedStr(e.restrictedAccessDisableTextLoc1,dB,"restricted-access-disable-text-loc1"),e.restrictedAccessDisableTextLoc2=n.getLocalizedStr(e.restrictedAccessDisableTextLoc2,dB,"restricted-access-disable-text-loc2"),e.restrictedAccessDisableTextLoc=n.getLocalizedStr(e.restrictedAccessDisableTextLoc,dB,"restricted-access-disable-text-loc",{"%restricted-access-disable-text-loc1%":e.restrictedAccessDisableTextLoc1,"%restricted-access-disable-text-loc2%":e.restrictedAccessDisableTextLoc2}),e.restrictedAccessDisableOkLoc=n.getLocalizedStr(e.restrictedAccessDisableOkLoc,dB,"restricted-access-disable-ok-loc"),e.restrictedAccessDisableCancelLoc=n.getLocalizedStr(e.restrictedAccessDisableCancelLoc,dB,"restricted-access-disable-cancel-loc"),e.restrictedAccessEnablingTitleLoc=n.getLocalizedStr(e.restrictedAccessEnablingTitleLoc,dB,"restricted-access-enabling-title-loc"),e.restrictedAccessEnablingTextLoc=n.getLocalizedStr(e.restrictedAccessEnablingTextLoc,dB,"restricted-access-enabling-text-loc"),e.restrictedAccessDisablingTitleLoc=n.getLocalizedStr(e.restrictedAccessDisablingTitleLoc,dB,"restricted-access-disabling-title-loc"),e.restrictedAccessDisablingTextLoc=n.getLocalizedStr(e.restrictedAccessDisablingTextLoc,dB,"restricted-access-disabling-text-loc"),e.restrictedAccessEnableFailureTitleLoc=n.getLocalizedStr(e.restrictedAccessEnableFailureTitleLoc,dB,"restricted-access-enable-failure-title-loc"),e.restrictedAccessEnableFailureTextLoc=n.getLocalizedStr(e.restrictedAccessEnableFailureTextLoc,dB,"restricted-access-enable-failure-text-loc"),e.restrictedAccessEnableFailureCloseLoc=n.getLocalizedStr(e.restrictedAccessEnableFailureCloseLoc,dB,"restricted-access-enable-failure-close-loc"),e.restrictedAccessEnableFailureTextLoc2=n.getLocalizedStr(e.restrictedAccessEnableFailureTextLoc2,dB,"restricted-access-enable-failure-text-loc2"),e.restrictedAccessDisableFailureTitleLoc=n.getLocalizedStr(e.restrictedAccessDisableFailureTitleLoc,dB,"restricted-access-disable-failure-title-loc"),e.restrictedAccessDisableFailureTextLoc=n.getLocalizedStr(e.restrictedAccessDisableFailureTextLoc,dB,"restricted-access-disable-failure-text-loc"),e.restrictedAccessDisableFailureCloseLoc=n.getLocalizedStr(e.restrictedAccessDisableFailureCloseLoc,dB,"restricted-access-disable-failure-close-loc"),e.lockHintStr=n.getLocalizedStr(e.lockHintStr,dB,"lock-hint-str"),e.languageOfflineWarningStr=n.getLocalizedStr(e.languageOfflineWarningStr,dB,"language-offline-warning-str",{"%go-online-link%":'<a href="javascript:void(0)" ng-click="goOnline()" class="otka">{{goOnlineStr}}</a>'}),e.restartChangeLanguageTitleLoc=n.getLocalizedStr(e.restartChangeLanguageTitleStr,dB,"restart-change-language-title-str")||"Restart to apply changes",e.restartChangeLanguageTextLoc=n.getLocalizedStr(e.restartChangeLanguageTextStr,dB,"restart-change-language-text-str")||"Changes made to your language settings will be applied when you restart Origin.",e.restartNowLoc=n.getLocalizedStr(e.restartNowStr,dB,"restart-now-str")||"Restart Now",e.restartCancelLoc=n.getLocalizedStr(e.restartCancelStr,dB,"restart-cancel-str")||"Cancel",e.unableToRestartTitleLoc=n.getLocalizedStr(e.unableToRestartTitleStr,dB,"unable-to-restart-title-str")||"SETTINGS",e.unableToRestartTextLoc=n.getLocalizedStr(e.unableToRestartTextStr,dB,"unable-to-restart-text-str")||"Sorry, you cannot change your language at this time.",e.unableToRestartOkayLoc=n.getLocalizedStr(e.unableToRestartOkayStr,dB,"unable-to-restart-okay-str")||"OK",e.throttleTitleLoc=n.getLocalizedStr(e.throttleTitleStr,dB,"throttletitlestr")||"Download restrictions",e.throttleOutOfGameLoc=n.getLocalizedStr(e.throttleOutOfGameStr,dB,"throttleoutofgamestr")||"Maximum download rate when out of game",e.throttleInGameLoc=n.getLocalizedStr(e.throttleInGameStr,dB,"throttleingamestr")||"Maximum download rate during gameplay",e.throttleNoLimitLoc=n.getLocalizedStr(e.throttleNoLimitStr,dB,"throttlenolimitstr")||"No limit",e.throttleNoDownloadDuringGamePlayLoc=n.getLocalizedStr(e.throttleNoDownloadDuringGamePlayStr,dB,"throttlenodownloadduringgameplaystr")||"Don&apos;t download",e.throttleGameplayTooltipLoc=n.getLocalizedStr(e.throttleGameplayTooltipStr,dB,"throttlegameplaytooltipstr")||"This setting allows you to control your download speed but won&apos;t affect progressive install games (games that allow you to download while playing)",e.appDefault="decide",e.localesSortedArray=[],e.autoUpdate=!1,e.autoPatch=!1,e.betaOptIn=!1,e.runOnSysStart=!1,e.originHelper=!0,e.originResponder=!1,e.ShowOriginAfterGameplay=!0,e.throttlingSupported=!1,e.chatTextToSpeech=!1,e.restrictedAccess=!1,e.onUpdateSettings=function(){setTimeout(function(){Origin.client.settings.readSetting("LocalHostResponderEnabled").then(l("originResponder")),Origin.client.settings.readSetting("LocalHostEnabled").then(l("originHelper"))},0)},e.$on("hasRestrictedAccess",function(t,i){e.hasRestrictedAccess=i}),e.$on("toggleRamSetting",function(t,i){l("restrictedAccess")(i),e.showToasty()}),e.goOnline=function(){Origin.client.onlineStatus.goOnline()},i.getGeneralSettings().then(function(t){if(t&&(t.appDefault&&(e.appDefault=t.appDefault),_.forEach(gB,function(i){var n=function(e,t){if(e.hasOwnProperty(t))return t;for(var i in e)if(_.isString(i)&&_.isString(t)&&i.toLowerCase()===t.toLowerCase())return i;return null}(t,i.key);n&&(e[i.key]=i.handler.get(t[n]))})),Origin.client.isEmbeddedBrowser()){for(var i in Origin.client.settings.readSetting("DefaultTab").then(l("appDefault")),uB)uB.hasOwnProperty(i)&&Origin.client.settings.readSetting(uB[i]).then(l(i));u.push(Origin.events.on(Origin.events.CLIENT_SETTINGS_RETURN_FROM_DIALOG,e.onUpdateSettings)),c.supportsRestrictedAccessMode().then(function(t){e.supportsRestrictedAccessMode=t}),c.checkHasRestrictedAccess().then(function(t){e.hasRestrictedAccess=t})}}).then(function(){s.getAllLanguages().then(g)}).catch(function(e){r.error("[origin-settings-application]:retrieveSettings FAILED:",e)}),Origin.client.isEmbeddedBrowser()&&Origin.client.settings.isSettingSupported("MaxDownloadRateBpsOutOfGame").then(function(t){e.throttlingSupported=t}),d(),u.push(o.events.on("myauth:clientonlinestatechanged",function(){d(),e.$digest()})),e.$on("$destroy",function(){a.detachAll(u),c.detachEvents()}),c.attachEvents()}function Ao(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",scope:{titleStr:"@",defaultSectionStr:"@defaultsectionstr",defaultSectionHintStr:"@defaultsectionhintstr",defaultOriginStr:"@defaultletorigindecidestr",defaultHomeStr:"@defaulthomestr",defaultGameLibraryStr:"@defaultgamelibrarystr",defaultStoreStr:"@defaultstorestr",languageSectionStr:"@languagesectionstr",languageSectionHintStr:"@languagesectionhintstr",showOriginStr:"@showoriginstr",showOriginHintStr:"@showoriginhintstr",clientupdatestr:"@",updategamesstr:"@",updategameshintstr:"@",updateoriginstr:"@",updateoriginhintstr:"@",originbetastr:"@",originbetahintstr:"@",startupstr:"@",autostartstr:"@",autostarthintstr:"@",helperstr:"@",helperhintstr:"@",lhresponderstr:"@",shortcutstr:"@",shortcuthintstr:"@",shortcutcreatestr:"@",menushortcutstr:"@",menushortcuthintstr:"@",menushortcutcreatestr:"@",goOnlineStr:"@",accessibilitystr:"@",chattexttospeechstr:"@",chattexttospeechhintstr:"@",advancedStr:"@",restrictedAccessStr:"@",restrictedAccessHintStr:"@",restrictedAccessEnableTitleLoc:"@",restrictedAccessEnableTextLoc:"@",restrictedAccessEnableTextLoc1:"@",restrictedAccessEnableTextLoc2:"@",restrictedAccessEnableTextLocUrl:"@",restrictedAccessEnableTextLocUrlDesc:"@",restrictedAccessEnableOkLoc:"@",restrictedAccessEnableCancelLoc:"@",restrictedAccessDisableTitleLoc:"@",restrictedAccessDisableTextLoc:"@",restrictedAccessDisableOkLoc:"@",restrictedAccessDisableCancelLoc:"@",restrictedAccessEnablingTitleLoc:"@",lockHintStr:"@",languageOfflineWarningStr:"@",restartChangeLanguageTitleStr:"@",restartChangeLanguageTextStr:"@",restartNowStr:"@",restartCancelStr:"@",unableToRestartTitleStr:"@",unableToRestartTextStr:"@",unableToRestartOkayStr:"@",throttleTitleStr:"@throttletitlestr",throttleOutOfGameStr:"@throttleoutofgamestr",throttleInGameStr:"@throttleingamestr",throttleNoLimitStr:"@throttlenolimitstr",throttleNoDownloadDuringGamePlayStr:"@throttlenodownloadduringgameplaystr",throttleGameplayTooltipStr:"@throttlegameplaytooltipstr"},require:["^originSettings"],controller:Lo,template:lB,controllerAs:"appSettings",link:function(s,c,l,d){var g=d[0];s.throttleSpeedOutOfGame="0",s.throttleSpeedInGame="0",Origin.client.settings.readSetting("MaxDownloadRateBpsOutOfGame").then(function(e){s.throttleSpeedOutOfGame=e.toString(),s.$digest()}),Origin.client.settings.readSetting("MaxDownloadRateBpsInGame").then(function(e){s.throttleSpeedInGame=e.toString(),s.$digest()}),s.changeDefault=function(){g.triggerSavedToasty(),Origin.client.settings.writeSetting("DefaultTab",s.appDefault)};var u=function(e){e.accepted?(g.triggerSavedToasty(),o.setLanguageLocale(s.currentLocale),r.setLocale(s.currentLocale)):(s.currentLocale=s.fallbackLocale,i.digestIfDigestNotInProgress(s))};s.changelanguage=function(){s.currentLocale&&s.currentLocale!==s.fallbackLocale&&Origin.client.user.canLogout().then(function(e){e?n.openPrompt({id:"origin-language-change-restart-request-id",name:"origin-language-change-restart-request",title:s.restartChangeLanguageTitleLoc,description:s.restartChangeLanguageTextLoc,acceptText:s.restartNowLoc,acceptEnabled:!0,rejectText:s.restartCancelLoc,defaultBtn:"yes",callback:u}):(s.currentLocale=s.fallbackLocale,n.openAlert({id:"origin-language-change-not-allowed-id",name:"origin-language-change-not-allowed",title:s.unableToRestartTitleLoc,description:s.unableToRestartTextLoc,rejectText:s.unableToRestartOkayLoc}))}).catch(function(){u({accepted:!0})})},s.changeThrottlingOutOfGame=function(){Origin.client.settings.writeSetting("MaxDownloadRateBpsOutOfGame",Number(s.throttleSpeedOutOfGame)),g.triggerSavedToasty()},s.changeThrottlingInGame=function(){Origin.client.settings.writeSetting("MaxDownloadRateBpsInGame",Number(s.throttleSpeedInGame)),g.triggerSavedToasty()},s.toggleSetting=function(t){s[t]=!s[t],uB[t]&&(g.triggerSavedToasty(),Origin.client.settings.writeSetting(uB[t],s[t]));var i=_.find(gB,function(e){return e.key===t});i&&e.setGeneralSetting(i.key,i.handler.set(s[t]))},s.toggleLocalhostService=function(){!0===s.originHelper?!1===s.originResponder?Origin.client.settings.startLocalHostResponder().then(_.partial(s.toggleSetting,"originResponder")):(Origin.client.settings.stopLocalHostResponder(),s.toggleSetting("originResponder")):(Origin.client.settings.startLocalHostResponderFromOptOut(),s.originResponder=!0)},s.toggleRestrictedAccessService=function(){!1===s.restrictedAccess?Origin.client.settings.isAllowedToEnableRestrictedAccessMode().then(function(e){!0===e?n.openPrompt({id:"origin-restricted-access-enable-request-id",title:s.restrictedAccessEnableTitleLoc,description:s.restrictedAccessEnableTextLoc,acceptText:s.restrictedAccessEnableOkLoc,rejectText:s.restrictedAccessEnableCancelLoc,acceptEnabled:!0,defaultBtn:"yes",callback:s.enableRestrictedAccess,blocking:!0}):n.openPrompt({id:"origin-restricted-access-enable-failure2-id",title:s.restrictedAccessEnableFailureTitleLoc,description:s.restrictedAccessEnableFailureTextLoc2,rejectText:s.restrictedAccessEnableFailureCloseLoc,callback:s.untoggleRam,blocking:!0})}):n.openPrompt({id:"origin-restricted-access-disable-request-id",title:s.restrictedAccessDisableTitleLoc,description:s.restrictedAccessDisableTextLoc,acceptText:s.restrictedAccessDisableOkLoc,rejectText:s.restrictedAccessDisableCancelLoc,acceptEnabled:!0,defaultBtn:"yes",callback:s.disableRestrictedAccess,blocking:!0})},s.enableRestrictedAccess=function(e){e.accepted?(a.executeRam({id:"origin-ram-enable-execute-id",title:s.restrictedAccessEnablingTitleLoc,description:s.restrictedAccessEnablingTextLoc,blocking:!0,callback:s.enableRAMResult}),Origin.client.settings.startRestrictedAccessService()):s.untoggleRam()},s.disableRestrictedAccess=function(e){e.accepted?(a.executeRam({id:"origin-ram-disable-execute-id",title:s.restrictedAccessDisablingTitleLoc,description:s.restrictedAccessDisablingTextLoc,blocking:!0,callback:s.disableRAMResult}),Origin.client.settings.stopRestrictedAccessService()):s.untoggleRam()},s.showToasty=function(){g.triggerSavedToasty()},s.untoggleRam=function(){s.$broadcast("switchToggle","origin-telemetry-settings-restrictedaccess")},s.enableRAMResult=function(e){!1===e.content.executed&&n.openAlert({id:"origin-restricted-access-enable-failure-id",title:s.restrictedAccessEnableFailureTitleLoc,description:s.restrictedAccessEnableFailureTextLoc,rejectText:s.restrictedAccessEnableFailureCloseLoc,callback:s.untoggleRam,blocking:!0})},s.disableRAMResult=function(e){!1===e.content.executed&&n.openAlert({id:"origin-restricted-access-disable-failure-id",title:s.restrictedAccessDisableFailureTitleLoc,description:s.restrictedAccessDisableFailureTextLoc,rejectText:s.restrictedAccessDisableFailureCloseLoc,callback:s.untoggleRam,blocking:!0})},s.$watch("isOffline",function(){var e=c[0].querySelector("#origin-settings-offline-warning");e&&angular.element(e).append(t("<span>"+s.languageOfflineWarningStr+"</span>")(s))})}}}function Do(e,t,i,n){"ngInject";function r(t){return function(i){e[t]=i,o()}}var o=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);if(e.title=i.getLocalizedStr(e.titlestr,fB,"titlestr"),e.hardwareinfostr=i.getLocalizedStr(e.hardwareinfostr,fB,"hardwareinfostr"),e.hardwareinfohintstr=i.getLocalizedStr(e.hardwareinfohintstr,fB,"hardwareinfohintstr"),e.helporiginhintstr=i.getLocalizedStr(e.helporiginhintstr,fB,"helporiginhintstr"),e.sysinteractstr=i.getLocalizedStr(e.sysinteractstr,fB,"sysinteractstr"),e.sysinteracthintstr=i.getLocalizedStr(e.sysinteracthintstr,fB,"sysinteracthintstr"),e.crashreportstr=i.getLocalizedStr(e.crashreportstr,fB,"crashreportstr"),e.crashreporthintstr=i.getLocalizedStr(e.crashreporthintstr,fB,"crashreporthintstr"),e.crashmenuaskstr=i.getLocalizedStr(e.crashmenuaskstr,fB,"crashmenuaskstr"),e.crashmenuautostr=i.getLocalizedStr(e.crashmenuautostr,fB,"crashmenuautostr"),e.crashmenuneverstr=i.getLocalizedStr(e.crashmenuneverstr,fB,"crashmenuneverstr"),e.troubleshootingstr=i.getLocalizedStr(e.troubleshootingstr,fB,"troubleshootingstr"),e.oigloggingstr=i.getLocalizedStr(e.oigloggingstr,fB,"oigloggingstr"),e.oiglogginghintstr=i.getLocalizedStr(e.oiglogginghintstr,fB,"oiglogginghintstr"),e.safemodestr=i.getLocalizedStr(e.safemodestr,fB,"safemodestr"),e.safemodehintstr=i.getLocalizedStr(e.safemodehintstr,fB,"safemodehintstr"),e.safemodeacceptstr=i.getLocalizedStr(e.safemodeacceptstr,fB,"safemodeacceptstr"),e.safemodecancelstr=i.getLocalizedStr(e.safemodecancelstr,fB,"safemodecancelstr"),e.safemodepopuptxt=i.getLocalizedStr(e.safemodepopuptxt,fB,"safemodepopuptxt"),e.spa_to_client_map={hardwareinfo:"TelemetryHWSurveyOptOut",oiglogging:"EnableInGameLogging",safemode:"EnableDownloaderSafeMode",telemetryEnabled:"telemetryEnabled",restrictedAccess:"RestrictedAccessMode"},e.crashmenu_setting="0",e.hardwareinfo=!0,e.telemetryEnabled=!0,e.oiglogging=!0,e.safemode=!0,e.allowUnsafe=!1,e.$on("hasRestrictedAccess",function(t,i){e.hasRestrictedAccess=i}),Origin.client.isEmbeddedBrowser()){for(var a in Origin.client.settings.readSetting("TelemetryCrashDataOptOut").then(function(e){return e.toString()}).then(r("crashmenu_setting")),e.spa_to_client_map)e.spa_to_client_map.hasOwnProperty(a)&&Origin.client.settings.readSetting(e.spa_to_client_map[a]).then(r(a));Origin.client.settings.readSetting("AllowNonSecureDownloads").then(function(t){return e.allowUnsafe=t}),n.checkHasRestrictedAccess().then(function(t){e.hasRestrictedAccess=t})}}function Ro(e){"ngInject";return{restrict:"E",scope:{titlestr:"@",crashmenuaskstr:"@",crashmenuautostr:"@",crashmenuneverstr:"@",crashreporthintstr:"@",crashreportstr:"@",hardwareinfohintstr:"@",hardwareinfostr:"@",helporiginhintstr:"@",oiglogginghintstr:"@",oigloggingstr:"@",safemodehintstr:"@",safemodestr:"@",sysinteracthintstr:"@",sysinteractstr:"@",troubleshootingstr:"@",safemodeacceptstr:"@",safemodecancelstr:"@",safemodepopuptxt:"@"},require:["^originSettings"],controller:Do,template:mB,link:function(t,i,n,r){var o=r[0],a=function(e){o.triggerSavedToasty(),Origin.client.settings.writeSetting(t.spa_to_client_map[e],t[e])};t.toggleSetting=function(i){var n=!t[i];t[i]=n,"safemode"!==i||n?t.spa_to_client_map[i]&&a(i):e.openPrompt({id:"origin-settings-diagnostics-confirmsafemode-id",name:"origin-settings-diagnostics-confirmsafemode-id",blocking:!0,title:t.safemodestr,description:t.safemodepopuptxt||t.safemodehintstr,acceptText:t.safemodeacceptstr,acceptEnabled:!0,rejectText:t.safemodecancelstr,defaultBtn:"no",callback:function(e){e.accepted?(t.safemode=!1,a(i)):t.safemode=!0}})},t.changeCrashMenu=function(){o.triggerSavedToasty(),Origin.client.settings.writeSetting("TelemetryCrashDataOptOut",t.crashmenu_setting)}}}}function $o(e,t,i,n){"ngInject";function r(e){return e.replace(/(\/|\\)$/,"")}function o(t){return function(i){_.isString(i)&&(i=r(i)),s=r(s),c=r(c),_.isUndefined(e[t])||i===e[t]||("gameLibFolderStr"===t?i===s?Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_GAME_INSTALL_LOCATION_DEFAULT):Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_GAME_INSTALL_LOCATION_CUSTOM):"cacheFolderStr"===t&&(i===c?Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_GAME_INSTALLER_SAVE_LOCATION_DEFAULT):Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_GAME_INSTALLER_SAVE_LOCATION_CUSTOM))),e[t]=i,l()}}var a,s,c,l=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);e.inTheCloudStr=i.getLocalizedStr(e.inthecloudstr,vB,"inthecloudstr"),e.savesStr=i.getLocalizedStr(e.savesstr,vB,"savesstr"),e.savesHintStr=i.getLocalizedStr(e.saveshintstr,vB,"saveshintstr"),e.onYourCompStr=i.getLocalizedStr(e.onyourcompstr,vB,"onyourcompstr"),e.gameLibLocStr=i.getLocalizedStr(e.gameliblocstr,vB,"gameliblocstr"),e.directoryStr=i.getLocalizedStr(e.directorystr,vB,"directorystr"),e.changeFolderStr=i.getLocalizedStr(e.changefolderstr,vB,"changefolderstr"),e.restoreDefaultStr=i.getLocalizedStr(e.restoredefaultstr,vB,"restoredefaultstr"),e.legacyGameInstStr=i.getLocalizedStr(e.legacygameinststr,vB,"legacygameinststr"),e.legacyGameInstHintStr=i.getLocalizedStr(e.legacygameinsthintstr,vB,"legacygameinsthintstr"),e.browseInstallersStr=i.getLocalizedStr(e.browseinstallersstr,vB,"browseinstallersstr"),e.deleteAllInstStr=i.getLocalizedStr(e.deleteallinststr,vB,"deleteallinststr"),e.gameInstLocStr=i.getLocalizedStr(e.gameinstlocstr,vB,"gameinstlocstr"),e.gameInstLocHintStr=i.getLocalizedStr(e.gameinstlochintstr,vB,"gameinstlochintstr"),e.notAvailableStr=i.getLocalizedStr(e.notavailablestr,vB,"notavailablestr"),e.lockHintStr=i.getLocalizedStr(e.lockHintStr,vB,"lock-hint-str"),e.cloudSetting=!0,e.keepInstallersSetting=!1,e.onUpdateSettings=function(){setTimeout(function(){Origin.client.settings.readSetting("DownloadInPlaceDir").then(o("gameLibFolderStr")),Origin.client.settings.readSetting("CacheDir").then(o("cacheFolderStr"))},0)},e.$on("hasRestrictedAccess",function(t,i){e.hasRestrictedAccess=i}),e.changeFolder=function(){Origin.client.installDirectory.chooseDownloadInPlaceLocation()},e.resetDownloadFolder=function(){Origin.client.installDirectory.resetDownloadInPlaceLocation()},e.changeCacheFolder=function(){Origin.client.installDirectory.chooseInstallerCacheLocation()},e.resetCacheFolder=function(){Origin.client.installDirectory.resetInstallerCacheLocation()},e.browseInstallers=function(){Origin.client.installDirectory.browseInstallerCache()},e.deleteInstallers=function(){Origin.client.installDirectory.deleteInstallers()},Origin.client.isEmbeddedBrowser()&&(Origin.client.settings.readSetting("cloud_saves_enabled").then(o("cloudSetting")),Origin.client.settings.readSetting("DownloadInPlaceDir").then(o("gameLibFolderStr")),Origin.client.settings.readSetting("CacheDir").then(o("cacheFolderStr")),Origin.client.settings.readSetting("KeepInstallers").then(o("keepInstallersSetting")),n.checkHasRestrictedAccess().then(function(t){e.hasRestrictedAccess=t}),a=Origin.events.on(Origin.events.CLIENT_SETTINGS_UPDATESETTINGS,e.onUpdateSettings),s=Origin.client.installDirectory.defaultDownloadInPlaceLocation(),c=Origin.client.installDirectory.defaultInstallerCacheLocation()),e.$on("$destroy",function(){a&&a.detach()})}function No(e,t){"ngInject";e.onLinkClick=function(){t.asyncOpenUrlWithEADPSSO(e.linkUrl,!0)}}function Go(e,t,i){"ngInject";var n=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);if(e.chatstr=i.getLocalizedStr(e.chatstr,SB,"chatstr"),e.notificationstr=i.getLocalizedStr(e.notificationstr,SB,"notificationstr"),e.soundstr=i.getLocalizedStr(e.soundstr,SB,"soundstr"),e.incomingstr=i.getLocalizedStr(e.incomingstr,SB,"incomingstr"),e.incomingvoipstr=i.getLocalizedStr(e.incomingvoipstr,SB,"incomingvoipstr"),e.gameinvitestr=i.getLocalizedStr(e.gameinvitestr,SB,"gameinvitestr"),e.groupinvitestr=i.getLocalizedStr(e.groupinvitestr,SB,"groupinvitestr"),e.friendsactivitystr=i.getLocalizedStr(e.friendsactivitystr,SB,"friendsactivitystr"),e.friendinstr=i.getLocalizedStr(e.friendinstr,SB,"friendinstr"),e.friendoutstr=i.getLocalizedStr(e.friendoutstr,SB,"friendoutstr"),e.friendstartstr=i.getLocalizedStr(e.friendstartstr,SB,"friendstartstr"),e.friendquitstr=i.getLocalizedStr(e.friendquitstr,SB,"friendquitstr"),e.friendbroadstr=i.getLocalizedStr(e.friendbroadstr,SB,"friendbroadstr"),e.friendstopbroadstr=i.getLocalizedStr(e.friendstopbroadstr,SB,"friendstopbroadstr"),e.gamesstr=i.getLocalizedStr(e.gamesstr,SB,"gamesstr"),e.achievementstr=i.getLocalizedStr(e.achievementstr,SB,"achievementstr"),e.downloadstr=i.getLocalizedStr(e.downloadstr,SB,"downloadstr"),e.failurestr=i.getLocalizedStr(e.failurestr,SB,"failurestr"),e.installstr=i.getLocalizedStr(e.installstr,SB,"installstr"),e.underaged=Origin.user.underAge(),e.settings={incomingchat:3,incomingvoip:3,gameinvite:3,groupinvite:3,friendin:3,friendout:3,friendstart:3,friendquit:3,friendbroad:3,friendstopbroad:3,achievement:3,download:3,failure:3,install:3},e.spa_to_client_map={incomingchat:"IncomingTextChatNotification",incomingvoip:"IncomingVoIPCallNotification",gameinvite:"GameInviteNotification",groupinvite:"GroupChatInviteNotification",friendin:"FriendSigningInNotification",friendout:"FriendSigningOutNotification",friendstart:"FriendStartsGameNotification",friendquit:"FriendQuitsGameNotification",friendbroad:"FriendStartBroadcastNotification",friendstopbroad:"FriendStopBroadcastNotification",achievement:"AchievementNotification",download:"FinishedDownloadNotification",failure:"DownloadErrorNotification",install:"FinishedInstallNotification"},e.isSet=function(t,i){var n=e.settings[t];return i?1===n||3===n:n>=2},Origin.client.isEmbeddedBrowser())for(var r in e.spa_to_client_map)e.spa_to_client_map.hasOwnProperty(r)&&Origin.client.settings.readSetting(e.spa_to_client_map[r]).then(function(t){return function(i){e.settings[t]=i,n()}}(r))}function Uo(e,t,i,n,r,o){"ngInject";function a(t){return function(i){"hotkeyString"===t?""!==e.hotkeyString&&i!==e.hotkeyString&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_OIG_KEYBOARD_SHORTCUT,{label:i}):"hotkeyPinString"===t&&""!==e.hotkeyPinString&&i!==e.hotkeyPinString&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_WINDOW_PINNING_KEYBOARD_SHORTCUT,{label:i}),e[t]=i,m()}}function s(e,t){return i.getLocalizedStr(e,CB,t)}function c(t){e.isGamePlaying=t,e.$digest()}function l(e,t){document.querySelector(e).classList.add(t)}function d(e,t){document.querySelector(e).classList.remove(t)}function g(){e.hotKeyNoError=!0,e.pinKeyNoError=!0,d(TB,_B),d(PB,_B),e.$digest()}function u(t,i){e[t]=i}function p(e){o.log("[OriginSettingsIngame Controller]:",e.message)}var m=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3),f=[];e.titleLoc=s(e.titlestr,"titlestr"),e.title2Loc=s(e.title2str,"title2str"),e.enableOIGLoc=s(e.enableoigstr,"enableoigstr"),e.enableOIGHintLoc=s(e.enableoighintstr,"enableoighintstr"),e.unverifiedLoc=s(e.unverifiedstr,"unverifiedstr"),e.unverifiedHintLoc=s(e.unverifiedhintstr,"unverifiedhintstr"),e.keyboardShortcutLoc=s(e.keyboardshortcutstr,"keyboardshortcutstr"),e.keyboardHintLoc=s(e.keyboardhintstr,"keyboardhintstr"),e.windowPinShortcutLoc=s(e.windowpinshortcutstr,"windowpinshortcutstr"),e.windowPinHintLoc=s(e.windowpinhintstr,"windowpinhintstr"),e.defaultShortcutLoc=s(e.defaultshortcutstr,"defaultshortcutstr"),e.shortcutInUseLoc=s(e.shortcutinusestr,"shortcutinusestr"),e.fpsDisplayStr=s(e.fpsdisplaystr,"fpsdisplaystr"),e.fpsDisplayHintStr=s(e.fpsdisplayhintstr,"fpsdisplayhintstr"),e.fpsSizeStr=s(e.fpssizestr,"fpssizestr"),e.fpsSizeHintStr=s(e.fpssizehintstr,"fpssizehintstr"),e.fpsOpacityStr=s(e.fpsopacitystr,"fpsopacitystr"),e.fpsOpacityHintStr=s(e.fpsopacityhintstr,"fpsopacityhintstr"),"MAC"===Origin.utils.os()?(e.defaultHotkeyLoc=s(e.defaultmachotkeystr,"defaultmachotkeystr"),e.defaultHotkeyPinLoc=s(e.defaultmachotkeypinstr,"defaultmachotkeypinstr")):(e.defaultHotkeyLoc=s(e.defaulthotkeystr,"defaulthotkeystr"),e.defaultHotkeyPinLoc=s(e.defaulthotkeypinstr,"defaulthotkeypinstr"));var h="",v={};if(e.isGamePlaying=!1,v.HotKeyString=e.keyboardshortcutstr,v.PinHotKeyString=e.windowPinShortcutStr,v.PushToTalkKeyString=s("","origin-settings-voice"),e.enableOIG=!0,e.inGameAllGames=!0,e.hotkeyString="",e.hotkeyPinString="",e.hotKeyNoError=!0,e.pinKeyNoError=!0,e.onUpdateSettings=function(){setTimeout(function(){Origin.client.settings.readSetting("HotKeyString").then(a("hotkeyString")),Origin.client.settings.readSetting("PinHotKeyString").then(a("hotkeyPinString"))},0)},e.updateIsGamePlaying=function(){Origin.client.games.isGamePlaying().then(c)},e.onSettingsError=function(i,n){t(g,5e3,!1),"HotKey"===h?(e.hotKeyNoError=!1,e.settingErrorMessage=e.shortcutInUseLoc.replace("%0",n.split("|")[1]).replace("%1",n.split("|")[0]),l(TB,_B)):"PinHotKey"===h&&(e.pinKeyNoError=!1,e.settingErrorMessage=e.shortcutInUseLoc.replace("%0",n.split("|")[1]).replace("%1",n.split("|")[0]),l(PB,_B)),e.$digest()},Origin.client.isEmbeddedBrowser()){Origin.client.settings.readSetting("EnableIgo").then(a("enableOIG")),Origin.client.settings.readSetting("in_game_all_games").then(a("inGameAllGames")),Origin.client.settings.readSetting("HotKeyString").then(a("hotkeyString")),Origin.client.settings.readSetting("PinHotKeyString").then(a("hotkeyPinString"));var b=[{settingClientName:"FpsDisplay",settingScopeProperty:"fpsDisplay",settingOptionsFunction:Origin.client.settings.getFpsDisplaySettings,scopeOptionsProperty:"fpsDisplayOptions"},{settingClientName:"FpsSize",settingScopeProperty:"fpsSize",settingOptionsFunction:Origin.client.settings.getFpsSizeSettings,scopeOptionsProperty:"fpsSizeOptions"},{settingClientName:"FpsOpacity",settingScopeProperty:"fpsOpacity",settingOptionsFunction:Origin.client.settings.getFpsOpacitySettings,scopeOptionsProperty:"fpsOpacityOptions"}];_.forEach(b,function(e){Origin.client.settings.readSetting(e.settingClientName).then(a(e.settingScopeProperty)).then(e.settingOptionsFunction).then(_.partial(u,e.scopeOptionsProperty)).catch(p)}),e.updateIsGamePlaying(),f=[Origin.events.on(Origin.events.CLIENT_SETTINGS_UPDATESETTINGS,e.onUpdateSettings),Origin.events.on(Origin.events.CLIENT_SETTINGS_ERROR,e.onSettingsError),Origin.events.on(Origin.events.CLIENT_GAMES_CHANGED,e.updateIsGamePlaying)]}e.setHotKeyInputFocus=function(t){t?(Origin.client.settings.pinHotkeyInputHasFocus(!1),Origin.client.settings.hotkeyInputHasFocus(!0),h="HotKey",e.pinKeyNoError=!0,e.hotKeyNoError=!0):(window.getSelection&&window.getSelection().empty(),Origin.client.settings.hotkeyInputHasFocus(!1),h=""),e.$digest()},e.setPinHotKeyInputFocus=function(t){t?(Origin.client.settings.hotkeyInputHasFocus(!1),Origin.client.settings.pinHotkeyInputHasFocus(!0),h="PinHotKey",e.pinKeyNoError=!0,e.hotKeyNoError=!0):(window.getSelection&&window.getSelection().empty(),Origin.client.settings.pinHotkeyInputHasFocus(!1),h=""),e.$digest()},r.listenForScopeAndWindowDestroy(e,function(){n.detachAll(f)})}function Bo(e){"ngInject";return{restrict:"E",scope:{titlestr:"@",title2str:"@",enableoigstr:"@",enableoighintstr:"@",unverifiedstr:"@",unverifiedhintstr:"@",keyboardshortcutstr:"@",keyboardhintstr:"@",windowpinshortcutstr:"@",windowpinhintstr:"@",defaultshortcutstr:"@",shortcutinusestr:"@",defaultmachotkeystr:"@",defaultmachotkeypinstr:"@",defaulthotkeystr:"@",defaulthotkeypinstr:"@",fpsdisplaystr:"@",fpsdisplayhintstr:"@",fpssizestr:"@",fpssizehintstr:"@",fpsopacitystr:"@",fpsopacityhintstr:"@"},require:["^originSettings"],controller:Uo,template:wB,link:function(t,i,n,r){function o(){t.setHotKeyInputFocus(!0)}function a(){t.setPinHotKeyInputFocus(!0)}function s(){t.setHotKeyInputFocus(!1)}function c(){t.setPinHotKeyInputFocus(!1)}var l=r[0];t.changeClientSetting=function(i,n){var r=n+"Previous";_.isUndefined(t[n])||t[n]===t[r]||(t[r]=t[n],Origin.client.settings.writeSetting(i,t[n]),e.digestIfDigestNotInProgress(t),l.triggerSavedToasty())},$(i).on("focusin",".oig-leHotKeys",o),$(i).on("focusin",".oig-lePinKeys",a),$(i).on("focusout",".oig-leHotKeys",s),$(i).on("focusout",".oig-lePinKeys",c),t.toggleEnableOIGSetting=function(){t.enableOIG=!t.enableOIG,l.triggerSavedToasty(),Origin.client.settings.writeSetting("EnableIgo",t.enableOIG)},t.toggleInGameAllGamesSetting=function(){t.inGameAllGames=!t.inGameAllGames,l.triggerSavedToasty(),Origin.client.settings.writeSetting("in_game_all_games",t.inGameAllGames)},t.$on("$destroy",function(){$(i).off("focusin",".oig-leHotKeys",o),$(i).off("focusin",".oig-lePinKeys",a),$(i).off("focusout",".oig-leHotKeys",s),$(i).off("focusout",".oig-lePinKeys",c)})}}}function Mo(e,t){"ngInject";e.title=t.getLocalizedStr(e.titleStr,EB,"titlestr"),e.description=t.getLocalizedStr(e.descriptionStr,EB,"descriptionstr")}function jo(e,t,i,n,r,o,a){"ngInject";function s(t){e.page=t}e.inClient=Origin.client.isEmbeddedBrowser(),e.changeSavedStr=o.getLocalizedStr(e.changeSavedStr,LB,"change-saved"),e.footerStr=t.trustAsHtml(o.getLocalizedStr(e.footer,LB,"footer")),e.footerUrlStr=a.getHelpUrl(Origin.locale.locale(),Origin.locale.languageCode()),e.tabNames=[],e.tabNames[0]=o.getLocalizedStr(e.applicationstr,LB,"tab-application"),e.tabNames[1]=o.getLocalizedStr(e.diagnosticsstr,LB,"tab-diagnostics"),e.tabNames[2]=o.getLocalizedStr(e.installsstr,LB,"tab-installs"),e.tabNames[3]=o.getLocalizedStr(e.notificationsstr,LB,"tab-notifications"),e.tabNames[4]=o.getLocalizedStr(e.oigstr,LB,"tab-oig");var c=0,l=["application","diagnostics","installs","notifications","oig","voice"];e.pages={application:l[0],diagnostics:l[1],installs:l[2],notifications:l[3],oig:l[4],payment:"payment",subscriptions:"subscriptions"},e.items=[],e.activeItemIndex=0,e.isUnderAge=Origin.user.underAge(),a.getOIGContextConfig()&&(c=3);for(var d=c;d<5;d++)if(!e.isUnderAge||"diagnostics"!==l[d]){var g={anchorName:"",href:"",title:"",pageName:""};g.title=e.tabNames[d],g.anchorName=e.tabNames[d],g.pageName=l[d],e.items.push(g)}this.setPage=s,this.navClick=function(e){n.go("app.settings.page",{page:e.pageName})};var u=r.$on("$stateChangeStart",function(t,i,n){"app.settings.page"===i.name&&(s(n.page),e.activeItemIndex=_.findIndex(e.items,function(e){return e.pageName===n.page}))});for(e.$on("$destroy",u),this.triggerSavedToasty=function(){document.querySelector(".origin-toast-dialog").classList.add("origin-toast-dialog-display"),setTimeout(function(){document.querySelector(".origin-toast-dialog").classList.remove("origin-toast-dialog-display")},1200)},i.page?e.page=i.page:window.oigParams?e.page=e.pages.oig:e.page=e.pages.application,d=0;d<5;d++)l[d]===e.page&&(e.activeItemIndex=d-c);this.isSet=function(t){return e.page===t},this.isClientRunning=function(){return Origin.client.isEmbeddedBrowser()}}function Ho(e,t){"ngInject";var i;e.slideToggleOnLoc=t.getLocalizedStr(e.slideToggleOnStr,DB,"slide-toggle-on-str"),e.slideToggleOffLoc=t.getLocalizedStr(e.slideToggleOffStr,DB,"slide-toggle-off-str"),e.lockHintStr=t.getLocalizedStr(e.lockHintStr,DB,"lock-hint-str"),e.toggleactionlocalBase=function(){e.togglecondition=e.togglecondition===OS.true?OS.false:OS.true,e.toggleaction()},_.isUndefined(e.throttle)?e.toggleactionlocal=e.toggleactionlocalBase:(i=parseInt(e.throttle,10)||500,e.toggleactionlocal=_.throttle(e.toggleactionlocalBase,i,{trailing:!1})),e.$on("switchToggle",function(t,i){e.addclass&&e.addclass.includes(i)&&(e.togglecondition=e.togglecondition===OS.true?OS.false:OS.true)}),e.$watchOnce("toggledisabled",function(t,i){t!==i&&(e.toggledisabled=t)})}function zo(e,t){"ngInject";e.title=t.getLocalizedStr(e.titleStr,$B,"titlestr"),e.description=t.getLocalizedStr(e.descriptionStr,$B,"descriptionstr")}function Vo(e,t,i,n){"ngInject";function r(e,t){return i.getLocalizedStr(e,GB,t)}function o(t){return function(i){if("no_warning_voice_conflict"===t&&(i=!1===i),"enable_push_to_talk"===t&&(i=i?"true":"false"),"pushToTalkString"===t){if(-1!==i.indexOf("mouse")){var n=i.match(/\d+/);i=e.mouseButtonLoc.replace("%number%",n)}""!==e.pushToTalkString&&i!==e.pushToTalkString&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SETTINGS_VOICE_CHAT_PUSH_TO_TALK,{value:i})}e[t]=i,q()}}function a(){Origin.voice.supported()&&(Origin.voice.audioInputDevices().then(function(t){t.length>0?e.inputDevices=t:e.inputDevices=[e.noneFoundLoc]}).then(Origin.voice.selectedAudioInputDevice).then(function(t){e.selectedInputDevice=t,e.$digest()}),Origin.voice.audioOutputDevices().then(function(t){t.length>0?e.outputDevices=t:e.outputDevices=[e.noneFoundLoc]}).then(Origin.voice.selectedAudioOutputDevice).then(function(t){e.selectedOutputDevice=t,e.$digest()}))}function s(){m(0),f()}function c(){a(),e.$digest()}function l(){a(),e.$digest()}function d(t){V.updateTestMicrophone(!0,t),e.$digest()}function g(t){V.updateTestMicrophone(!1,t),e.$digest()}function u(){s()}function p(){s()}function m(t){var i=!1,r=n.activeVoiceConversationId();0!==r&&(i="LOCAL_MUTED"===n.voiceCallInfoForConversation(r).state),!i&&e.testingMicrophone||(t=0),w=I.find(".origin-settings-voice-audio-test"),C=w.find(".b0"),T=w.find(".b1"),P=w.find(".b2"),_=w.find(".b3"),O=w.find(".b4"),E=w.find(".b5"),F=w.find(".b6"),x=w.find(".b7"),L=w.find(".b8"),A=w.find(".b9"),D=w.find(".b10"),R=w.find(".b11"),$=w.find(".b12"),N=w.find(".b13"),G=w.find(".b14"),U=w.find(".b15"),B=w.find(".b16"),M=w.find(".b17"),j=w.find(".b18"),H=w.find(".b19"),z=w.find(".b20"),C.toggleClass("lit",t>100/21*.25),T.toggleClass("lit",t>100/21),P.toggleClass("lit",t>100/21*2),_.toggleClass("lit",t>100/21*3),O.toggleClass("lit",t>100/21*4),E.toggleClass("lit",t>100/21*5),F.toggleClass("lit",t>100/21*6),x.toggleClass("lit",t>100/21*7),L.toggleClass("lit",t>100/21*8),A.toggleClass("lit",t>100/21*9),D.toggleClass("lit",t>100/21*10),R.toggleClass("lit",t>100/21*11),$.toggleClass("lit",t>100/21*12),N.toggleClass("lit",t>100/21*13),G.toggleClass("lit",t>100/21*14),U.toggleClass("lit",t>100/21*15),B.toggleClass("lit",t>100/21*16),M.toggleClass("lit",t>100/21*17),j.toggleClass("lit",t>100/21*18),H.toggleClass("lit",t>100/21*19),z.toggleClass("lit",t>100/21*20)}function f(){I.find(".origin-settings-sensitivity-microphone").removeClass("overThreshold")}function h(){e.testingMicrophone&&I.find(".origin-settings-sensitivity-microphone").addClass("overThreshold")}function v(){setTimeout(function(){Origin.client.settings.readSetting("PushToTalkKeyString").then(o("pushToTalkString"))},0)}function b(e,t){I.find(e).addClass(t)}function y(e,t){I.find(e).removeClass(t)}function S(){e.pTTKeyNoError=!0,y(UB,BB),b(UB,MB),e.$digest()}function k(i,n){t(S,5e3,!1),"PTTHotKey"===W&&(e.pTTKeyNoError=!1,e.settingErrorMessage=e.shortcutInUseLoc.replace("%0",n.split("|")[1]).replace("%1",n.split("|")[0]),b(UB,BB),y(UB,MB)),e.$digest()}var I,w,C,T,P,_,O,E,F,x,L,A,D,R,$,N,G,U,B,M,j,H,z,V=this,W="";e.testingMicrophone=!1,e.pTTKeyNoError=!0;var q=i.throttle(function(){t(function(){e.$digest()},0,!1)},1e3);if(e.mouseButtonLoc=r(e.mousebuttonstr,"mousebuttonstr"),this.updateTestMicrophone=function(t,i){t?e.$testMicrophoneLink.removeClass("otka-disabled"):e.$testMicrophoneLink.addClass("otka-disabled"),i&&(e.testMicLinkStr=e.testMicLoc,e.testingMicrophone=!1)},this.setElement=function(e){I=e},e.noneFoundLoc=r(e.nonefoundstr,"nonefoundstr"),this.setPTTHotKeyInputFocus=function(t){t?(Origin.client.settings.pushToTalkHotkeyInputHasFocus(!0),W="PTTHotKey",e.pTTKeyNoError=!0):(window.getSelection&&window.getSelection().empty(),Origin.client.settings.pushToTalkHotkeyInputHasFocus(!1),W=""),e.$digest()},e.deviceSettingsLoc=r(e.devicesettingsstr,"devicesettingsstr"),e.selectMicLoc=r(e.selectmicstr,"selectmicstr"),e.selectMicHintLoc=r(e.selectmichintstr,"selectmichintstr"),e.micVolumeLoc=r(e.micvolumestr,"micvolumestr"),e.testMicLoc=r(e.testmicstr,"testmicstr"),e.stopTestLoc=r(e.stopteststr,"stopteststr"),e.selectSpkrLoc=r(e.selectspkrstr,"selectspkrstr"),e.selectSpkrHintLoc=r(e.selectspkrhintstr,"selectspkrhintstr"),e.sprkVolumeLoc=r(e.sprkvolumestr,"sprkvolumestr"),e.captureSettingsLoc=r(e.capturesettingsstr,"capturesettingsstr"),e.captureModeLoc=r(e.capturemodestr,"capturemodestr"),e.captureModeHintLoc=r(e.capturemodehintstr,"capturemodehintstr"),e.voiceActivateLoc=r(e.voiceactivatestr,"voiceactivatestr"),e.pushToTalkLoc=r(e.pushtotalkstr,"pushtotalkstr"),e.pushToTalkShortcutLoc=r(e.pushtotalkshortcutstr,"pushtotalkshortcutstr"),e.pushToTalkShortcutHintLoc=r(e.pushtotalkshortcuthintstr,"pushtotalkshortcuthintstr"),e.shortcutInUseLoc=r(e.shortcutinusestr,"shortcutinusestr"),e.micSensitivityLoc=r(e.micsensitivitystr,"micsensitivitystr"),e.micSensitivityHintLoc=r(e.micsensitivityhintstr,"micsensitivityhintstr"),e.voiceChatWarnLoc=r(e.voicechatwarnstr,"voicechatwarnstr"),e.voiceChatWarnHintLoc=r(e.voicechatwarnhintstr,"voicechatwarnhintstr"),e.defaultShortcutLoc=r(e.defaultshortcutstr,"defaultshortcutstr"),e.defaultPTTHotkeyLoc=r(e.defaultptthotkeystr,"defaultptthotkeystr"),e.testMicLinkStr=e.testMicLoc,e.pushToTalkShortcutLoc,e.spa_to_client_map={no_warning_voice_conflict:"NoWarnAboutVoiceChatConflict",enable_push_to_talk:"EnablePushToTalk",selectedInputDevice:"VoiceInputDevice",selectedOutputDevice:"VoiceOutputDevice",microphoneVolume:"MicrophoneGain",speakerVolume:"SpeakerGain",voiceActivationThreshold:"VoiceActivationThreshold",pushToTalkString:"PushToTalkKeyString"},e.selectedInputDevice="",e.inputDevices=[""],e.selectedOutputDevice="",e.outputDevices=[""],e.no_warning_voice_conflict=!1,e.enable_push_to_talk="true",e.microphoneVolume=60,e.speakerVolume=50,e.voiceActivationThreshold=5,e.pushToTalkString="",Origin.client.isEmbeddedBrowser()){for(var Y in a(),e.spa_to_client_map)e.spa_to_client_map.hasOwnProperty(Y)&&Origin.client.settings.readSetting(e.spa_to_client_map[Y]).then(o(Y));Origin.events.on(Origin.events.VOICE_DEVICE_ADDED,c),Origin.events.on(Origin.events.VOICE_DEVICE_REMOVED,l),Origin.events.on(Origin.events.VOICE_ENABLE_TEST_MICROPHONE,d),Origin.events.on(Origin.events.VOICE_DISABLE_TEST_MICROPHONE,g),Origin.events.on(Origin.events.VOICE_CONNECTED,u),Origin.events.on(Origin.events.VOICE_DISCONNECTED,p),Origin.events.on(Origin.events.VOICE_LEVEL,m),Origin.events.on(Origin.events.VOICE_UNDER_THRESHOLD,f),Origin.events.on(Origin.events.VOICE_OVER_THRESHOLD,h),Origin.events.on(Origin.events.CLIENT_SETTINGS_UPDATESETTINGS,v),Origin.events.on(Origin.events.CLIENT_SETTINGS_ERROR,k)}e.$on("$destroy",function(){Origin.events.off(Origin.events.VOICE_DEVICE_ADDED,c),Origin.events.off(Origin.events.VOICE_DEVICE_REMOVED,l),Origin.events.off(Origin.events.VOICE_ENABLE_TEST_MICROPHONE,d),Origin.events.off(Origin.events.VOICE_DISABLE_TEST_MICROPHONE,g),Origin.events.off(Origin.events.VOICE_CONNECTED,u),Origin.events.off(Origin.events.VOICE_DISCONNECTED,p),Origin.events.off(Origin.events.VOICE_LEVEL,m),Origin.events.off(Origin.events.VOICE_UNDER_THRESHOLD,f),Origin.events.off(Origin.events.VOICE_OVER_THRESHOLD,h),Origin.events.off(Origin.events.CLIENT_SETTINGS_UPDATESETTINGS,v),Origin.events.off(Origin.events.CLIENT_SETTINGS_ERROR,k),Origin.voice.setInVoiceSettings(!1)})}function Wo(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(e){return!!e&&(e===WB.hide||e===WB.externalurlSSO||e===WB.help)}function g(e){angular.element(KB).css({visibility:e})}var u=o.isNoCommerceContext(),p=[YB.gamelibrary,YB.profile,YB.error,YB.settings];e.isNoCommerceContext=u;var m=[];e.unhidePopoutContainer=function(){return g("")},e.hidePopoutContainer=function(){return g("hidden")},e.notifyClicked=function(t){t&&t.preventDefault(),i.events.fire("menuitem:clicked"),e.href&&r.openLink(e.href)},e.logout=function(t){t&&t.preventDefault(),e.notifyClicked(),n.events.fire("auth:logout")},e.openLanguageDialog=function(t){t&&t.preventDefault(),e.notifyClicked(),a.open({id:"origin-dialog-content-selectlanguage",xmlDirective:'<origin-dialog-content-selectlanguage class="origin-dialog-content"></origin-dialog-content-selectlanguage>'})},e.openUrlSSO=function(t){t&&t.preventDefault();var i=o.getUrl(e.href);Origin.client.isEmbeddedBrowser()||(i=(i=i.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),r.asyncOpenUrlWithEADPSSO(i)},e.showOriginHelp=function(e){e&&e.preventDefault(),r.showOriginHelp()},e.determineIfSelected=function(){e.isActive=t.current.data.section===e.section},e.init=function(){e.hide=function(t){var i=!1;if(d(e.disposition))switch(e.for){case qB.client:i=Origin.client.isEmbeddedBrowser();break;case qB.web:i=!Origin.client.isEmbeddedBrowser();break;case qB.underAge:i=Origin.user.underAge();break;case qB.underAgeOrClient:i=Origin.client.isEmbeddedBrowser()||Origin.user.underAge()}return e.disposition&&(e.disposition===WB.selectlanguage&&(i=Origin.client.isEmbeddedBrowser()),e.disposition===WB.addSubscriptionTime&&(i=c.userHasSubscription()&&c.isRecurringSubscriber()),e.disposition===WB.changeSubscription&&(i=c.userHasSubscription()&&c.isBuddy()),e.disposition===WB.migration&&(i="PCWIN"!==Origin.utils.os())),u&&t&&!p.includes(t)&&(i=!0),i}(e.section),e.setClickEvent(),e.hide||(m=[i.events.on("menuitem:clicked",e.hidePopoutContainer),i.events.on("uiRouter:stateChangeSuccess",e.determineIfSelected)],e.determineIfSelected()),e.$digest()},e.$on("$destroy",function(){l.detachAll(m)}),d(e.disposition)&&(e.hide=!0),n.waitForAuthReady().then(e.init),e.addSubscriptionTime=function(){a.openDirective({id:s.id,name:"origin-dialog-content-templateloader",size:"large",data:{template:s.template,modal:s.id}})},e.launchSubscriptionChangeModal=function(){a.openDirective({id:pI,name:mI,size:_I,data:{id:pI}})}}function qo(e){return{restrict:"E",replace:!0,controller:Wo,transclude:!0,scope:{titleStr:"@",href:"@",disposition:"@",section:"@",for:"@"},link:function(t,i){var n=i.hasClass("origin-shell-submenu-item")||i.hasClass("origin-shell-menu-item");n||(t.hasSubMenu=i.find(".origin-shell-popout").children().length>0);var r=_.debounce(function(){t.unhidePopoutContainer(),t.hasSubMenu||(t.hasSubMenu=!0,t.$digest());var e=angular.element(this),i=angular.element("> .origin-shell-popout-container",e),n=angular.element(".origin-navigation-isoverflowing").length,r=e.position();i.css({top:r.top,left:r.left+Math.round(e.outerWidth()*(n?.98:.99))})},500,{leading:!0,trailing:!1});(t.hasSubMenu||n)&&(t.showArrow=!0,angular.element("#shell .origin-shell-submenu-item").on("mouseover",r)),t.setClickEvent=function(){t.onClick=t.notifyClicked,t.disposition===WB.logout?(t.href="",t.hrefAbsoluteUrl=e.getAbsoluteUrl(t.href),t.onClick=t.logout):t.disposition===WB.externalurlSSO?t.onClick=t.openUrlSSO:t.disposition===WB.selectlanguage?(t.href="",t.hrefAbsoluteUrl=e.getAbsoluteUrl(t.href),t.onClick=t.openLanguageDialog):t.disposition===WB.help?t.onClick=t.showOriginHelp:t.disposition===WB.addSubscriptionTime?(t.href="",t.hrefAbsoluteUrl=e.getAbsoluteUrl(t.href),t.onClick=t.addSubscriptionTime):t.disposition===WB.changeSubscription&&(t.href="",t.hrefAbsoluteUrl=e.getAbsoluteUrl(t.href),t.onClick=t.launchSubscriptionChangeModal)},t.$on("$destroy",function(){angular.element(".origin-shell-submenu-item").off("mouseover"),r.cancel()}),t.hrefAbsoluteUrl=e.getAbsoluteUrl(t.href)}}}function Yo(e){"ngInject";var t={template:HB};return _.merge(qo(e),t)}function Ko(e){"ngInject";var t={template:VB};return _.merge(qo(e),t)}function Qo(e){"ngInject";var t={template:zB};return _.merge(qo(e),t)}function Jo(e,t){"ngInject";function i(e){r=!0,n=e.isLoggedIn}var n=!1,r=!1;e.shouldShow=function(){return!n&&r},t.events.on("myauth:change",function(t){i(t),e.$digest()}),t.waitForAuthReady().then(i)}function Xo(e,t,i,n){"ngInject";function r(){return c>0}function o(){return s>0}function a(){l?l=!1:c++,e.backDisabled=!r(),e.forwardDisabled=!o()}e.betaLoc=i.getLocalizedStr(e.beta,XB,"beta"),n.getVersion()===ZB?e.version=e.betaLoc:n.getVersion()===eM&&(e.version=eM);var s=0,c=-1,l=!1;e.goBack=function(){r()&&(t.history.back(),s++,c--,l=!0)},e.goForwards=function(){o()&&(t.history.forward(),s--,c++,l=!0)},this.init=function(){a(),e.$on("$locationChangeSuccess",a)}}function Zo(e,t,i){"ngInject";var n;e.ready=!1,e.underAge=Origin.user.underAge(),e.isUserLoggedIn=function(){return t.isAppLoggedIn()},t.waitForAuthReady().then(function(){e.ready=!0}),n=[t.events.on("myauth:ready",e.$digest),t.events.on("myauth:change",e.$digest)],e.$on("$destroy",function(){i.detachAll(n)})}function ea(e){"ngInject";return{restrict:"E",replace:!0,transclude:!0,link:function(t,i){function n(){t.$emit("navigation:heightchange")}t.menuOpen=!1,t.$on("miniprofile:toggle",function(){t.menuOpen=!t.menuOpen;var r=i.find(".otkicon-downarrow");t.menuOpen?r.addClass("down-arrow-flip"):(t.$emit("navigation:footermenuclosestart"),r.removeClass("down-arrow-flip")),e.onTransitionEnd(i,n)})},template:nM,controller:Zo}}function ta(e,t){"ngInject";function i(e){r=e.isLoggedIn,o=r&&Origin.user.underAge()}function n(t){i(t),e.$digest()}var r=!1,o=!1;e.shouldShow=function(){return r&&!o},t.events.on("myauth:change",n),e.$on("$destroy",function(){t.events.off("myauth:change",n)}),t.waitForAuthReady().then(i)}function ia(e,t){"ngInject";function i(e){r=e.isLoggedIn,o=r&&Origin.user.underAge()}function n(t){i(t),e.$digest()}var r=!1,o=!1;e.shouldShow=function(){return r&&o},t.events.on("myauth:change",n),e.$on("$destroy",function(){t.events.off("myauth:change",n)}),t.waitForAuthReady().then(i)}function na(e){"ngInject";e.mainMenuVisible=!1}function ra(e,t,i,n,r,o,a,s){"ngInject";var c,l=s.isSmall(),d=!1,g=null;return{restrict:"E",replace:!0,transclude:!0,template:aM,controller:na,link:function(u,p){function m(e){x.style.paddingBottom=e+"px"}function f(){var e=_||x;x.offsetHeight<T+P?(d=!0,e.classList.add(gM)):(d=!1,e.classList.remove(gM))}function h(){!function(){if(k){var e=window.getComputedStyle(k);T=k.offsetHeight+I.offsetHeight+C.offsetHeight+parseInt(e.marginTop,10)}}(),function(){if(!w)for(var e=document.querySelectorAll("."+dM),t=0,i=e.length;t<i;t++)if(!e[t].classList.contains("ng-hide")){w=e[t],E=w.offsetHeight;break}P=w&&w.offsetHeight?w.offsetHeight:0}(),m(P),f()}function v(e){if(e.stopPropagation(),g){var t=e.originalEvent.deltaY<0,i=g.offsetHeight+g.scrollTop>=g.scrollHeight,n=0===g.scrollTop;if((i&&!t||n&&t)&&d)return e.preventDefault()}}function b(){w=null,setTimeout(h,0)}function y(e){var t=_||x;l=e?e.matches:s.isSmall(),g&&angular.element(g).unbind("wheel",v),g=l?x:_,setTimeout(h,0),g&&angular.element(g).bind("wheel",v),l?t.classList.add(mM):t.classList.remove(mM),k&&(k.style.marginTop=l?p[0].style.marginTop:0)}function S(e){e.preventDefault(),e.stopPropagation()}var k,I,w,C,T,P,_,O,E,F=angular.element(window),x=p[0].querySelector("."+sM),L=[];r.getObserver().attachToScope(u,"states"),u.toggleMainMenu=function(e){e&&e.preventDefault(),r.handleMenuClick()},O=e.reverseThrottle(f,30),n(function(){a.hideStaticShell=!0,k=x.querySelector("."+cM),I=x.querySelector("."+lM),C=x.querySelector("."+uM),_=x.querySelector("."+pM),y(),L=[i.events.on("menuitem:clicked",u.toggleMainMenu),i.events.on("globalsitestripe:update",h),i.events.on("globalsitestripe:add",h),i.events.on("globalsitestripe:remove",h),t.events.on("myauth:change",b)],u.$digest()},1e3,!1),F.on("resize",O),u.$on("navigation:heightchange",h),u.$on("$destroy",function(){o.detachAll(L),F.off("resize",O),angular.element(x).off(fM,S),g&&angular.element(g).unbind("wheel",v),c&&c()}),u.$on("navigation:footermenuclosestart",function(){m(E)}),s.addSmallMediaQueryListener(y),angular.element(x).on(fM,S)}}}function oa(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e){angular.element(bM).css({visibility:e})}function p(t){e.pointsLoc=i.getLocalizedStr(e.pointsStr,vM,"pointscta",{"%points%":t.grantedXp()}),e.$digest()}function m(){if(g.isExpired()||g.isSuspended()){var t=moment().subtract(y,"days");e.isSubscriptionRecentlyLapsed=moment(g.getExpiration()).isAfter(t)}e.isSubscriber=g.userHasSubscription(),e.showAccessBadge=(e.isSubscriptionRecentlyLapsed||e.isSubscriber)&&Origin.user.userStatus()!==Origin.defines.userStatus.BANNED,e.subscriptionLevel=g.getSubscriptionLevel(),e.$digest()}function f(){v=null,r.getAchievementPortfolio().then(p).catch(function(e){o.error("[Origin-Shell-Miniprofile getOriginPoints Method] error",e)})}function h(){v=t(f,3e3,!1),e.myNucleusId=Origin.user.userPid(),e.myOriginId=Origin.user.originId(),e.isUnderAge=Origin.user.underAge(),d.populateWithDefaults(e,vM).then(m),e.$digest()}var v=null,b=[n.events.on("myauth:change",h),l.events.on("menuitem:clicked",function(){u("hidden")}),r.events.on("achievements:achievementGranted",f),g.events.on(b$.b,m)],y=i.getLocalizedStr(e.badgeDaysAfterExpiry,vM,"badge-days-after-expiry")||yM;e.unhidePopoutMenu=function(){return u("")},e.onClick=function(){e.isUnderAge||c.isSmall()||a.goToState("app.profile.topic",{topic:"achievements"})},e.logoVariant=qS.Condensed,e.$on("$destroy",function(){s.detachAll(b),v&&(t.cancel(v),v=null)}),n.waitForAuthReady().then(g.waitForSubscriptionReady).then(h).catch(function(e){o.error("MiniProfile - authReadyError:",e)})}function aa(e,t,i,n,r,o,a,s){"ngInject";function c(){e.focused=!1,e.$digest()}function l(){void 0!==i.searchString&&t.$current.name===TM&&(e.searchString=decodeURI(i.searchString))}var d;e.isCompactView=a.isSmall(),e.isUnderAge=function(){return Origin.user.underAge()},e.isNoCommerceContext=s.isNoCommerceContext(),e.focused=!1,e.searchString="",e.searchPlaceholderLoc=n.getLocalizedStr(e.searchPlaceholderStr,CM,"searchplaceholder");var g={name:t.$current.name===TM?PM:t.$current.name,params:""};e.search=function(){var i=IM?{location:"replace"}:{};IM=!0,e.searchString.length?(e.searchString!==wM&&(wM=e.searchString,Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_initiated","user","search_initiated",{searchString:decodeURI(e.searchString),currentPage:t.$current.name})),r.events.fire("uiRouter:go",TM,{searchString:encodeURI(e.searchString),category:null},i),o.setEmbeddedFilterpanel(!1)):t.$current.name===TM&&r.events.fire("uiRouter:go",g.name,g.params)},e.escapeClearSearch=function(i){27===i&&(e.searchString="",wM=e.searchString,t.$current.name===TM&&r.events.fire("uiRouter:go",g.name,g.params))},e.clear=function(){e.searchString="",wM=e.searchString,t.$current.name===TM&&r.events.fire("uiRouter:go",g.name,g.params),e.isCompactView&&(e.$emit("globalsearch:toggle",!1),e.focused=!1,e.$digest())},e.onfocus=function(){e.focused=!0,e.$emit("globalsearch:toggle",!0),d&&(clearTimeout(d),d=null)},e.onblur=function(){e.searchString.length||(e.$emit("globalsearch:toggle",!1),d&&clearTimeout(d),d=setTimeout(c,100))},e.$on("$stateChangeSuccess",function(t,i,n,r,o){l(),r.name&&r.name!==TM&&(g.name=r.name,g.params=o),r.name===TM&&i.name!==TM&&(IM=!1,wM=e.searchString,e.searchString="",e.onblur()),r.name!==TM&&i.name!==TM&&(e.searchString="",e.onblur())}),l()}function sa(e,t,i,n,r){"ngInject";e.inClient=Origin.client.isEmbeddedBrowser(),e.betaLoc=n.getLocalizedStr(e.beta,EM,"beta"),r.getVersion()===FM?e.version=e.betaLoc:r.getVersion()===xM&&(e.version=xM);var o=r.isNoCommerceContext();e.$on("globalsearch:toggle",function(t,i){e.globalSearchOpen=i,t.stopPropagation()}),e.toHome=function(e){e.preventDefault(),o?i.goToState(bI.w,t.search()):i.goHome()},e.homeUrl=i.getAbsoluteUrl(o?bI.w:"/")}function ca(e,t,i,n,r,o,a,s){"ngInject";e.trustAsHtml=function(e){return e=function(e){var t=e.match(/[^\x00-\x7F]/gm);return t&&t.length&&t.forEach(function(t){if(e.indexOf("href")>-1){var i=document.createElement("div");i.innerHTML=e;var n=i.firstChild;n.innerHTML=n.innerHTML.replace(t,"?"),e=n.outerHTML}}),e}(e=e.replace(/&/g,"&amp;")),i.trustAsHtml(e)},this.clickUser=function(){Origin.client.oig.IGOIsActive()?o.openIGOSPA("PROFILE",e.monologue.from):o.goUserProfile(e.monologue.from)},this.clickURL=function(e){o.asyncOpenUrl(e)};var c=e.monologue?e.monologue.from:e.conversation.participants.find(function(e){return Number(e)!==Number(Origin.user.userPid())});c&&n.getFriendInfo(c).then(function(t){void 0!==t&&(e.user=t)}).then(function(){return r.getAvatar(c,Origin.defines.avatarSizes.SMALL)}).then(function(t){e.avatarImgSrc=t,e.$digest()}).catch(function(e){a.error("OriginSocialChatwindowConversationHistoryitemMonologueCtrl: UserDataFactory.getAvatar failed",e)}),e.isSelf=function(){return void 0!==e.monologue&&Number(e.monologue.from)===Number(Origin.user.userPid())},e.showUsername=function(){return"MULTI_USER"===e.conversation.state&&!e.isSelf()},e.isPoppedOut=function(){return s.isWindowPoppedOut()}}function la(e,t,i,n){$(t).on("click",".origin-social-chatwindow-conversation-historyitem-monologue-avatar .otkavatar",function(){n.clickUser()}),$(t).on("click",".origin-social-chatwindow-conversation-historyitem-monologue-username",function(){n.clickUser()}),$(t).on("click",".otka.user-provided",function(e){var t=$(this).attr("href");e.stopImmediatePropagation(),e.preventDefault(),n.clickURL(t)})}function da(e,t,i,n,r,o,a){"ngInject";function s(){m=[],$.each(e.systemEvent.from,function(e,t){Number(t)===Origin.user.userPid()?-1===m.indexOf(Origin.user.originId())&&(m.push(Origin.user.originId()),c()):n.getGroupMemberInfo(t).then(function(e){-1===m.indexOf(e)&&(m.push(e),c())})})}function c(){f=m.join(", "),e.message=function(t){var i="";if(m.length>0)switch(t){case"participant_enter":i=o.getLocalizedStr(e.userJoinedChatStr,g,"userjoinedchatstr",{"%username%":f});break;case"participant_exit":i=m.length>1?o.getLocalizedStr(e.usersLeftChatStr,g,"usersleftchatstr",{"%username%":f}):o.getLocalizedStr(e.userLeftChatStr,g,"userleftchatstr",{"%username%":f})}return i}(u),e.$digest()}function l(e,t){return'<a class="otka" href="'+e+'">'+t+"</a>"}function d(t,i){var n="";switch(t){case"online":n=o.getLocalizedStr(e.userOnlineStr,g,"useronlinestr",{"%username%":i});break;case"unavailable":case"offline":n=o.getLocalizedStr(e.userOfflineStr,g,"userofflinestr",{"%username%":i});break;case"away":n=o.getLocalizedStr(e.userAwayStr,g,"userawaystr",{"%username%":i})}return n}var g="origin-social-chatwindow-conversation-historyitem-system",u=e.systemEvent.subtype,p="",m=[],f="";if("presence"===u)r.getFriendInfo(e.systemEvent.from).then(function(t){f=t.originId,e.message=d(e.systemEvent.presence,f),e.$digest()});else if("call_started"===u)Origin.client.settings.readSetting("EnablePushToTalk").then(function(t){t?Origin.client.settings.readSetting("PushToTalkKeyString").then(function(t){if(-1!==t.indexOf("mouse")){var i=t.match(/\d+/);t=o.getLocalizedStr(e.mouseButtonStr,g,"mousebuttonstr").replace("%number%",i)}e.message=o.getLocalizedStr(e.joinedVoiceChatStr,g,"joinedvoicechatstr").replace("%pttString%",t),e.$digest()}):(e.message=o.getLocalizedStr(e.callStartedStr,g,"callstartedstr"),e.$digest())});else if("call_ended"===u)p=o.getLocalizedStr(e.callEndedStr,g,"callendedstr").replace("%link%",l("",o.getLocalizedStr(e.callEndedLinkTextStr,g,"callendedlinktextstr")));else if("call_noanswer"===u)p=o.getLocalizedStr(e.callNoAnswerStr,g,"callnoanswerstr",{"%username%":e.systemEvent.from});else if("call_missed"===u)p=o.getLocalizedStr(e.callMissedStr,g,"callmissedstr",{"%username%":e.systemEvent.from});else if("call_ended_unexpectedly"===u)p=o.getLocalizedStr(e.callEndedUnexpectedlyStr,g,"callendedunexpectedlystr");else if("call_ended_incoming"===u)p=o.getLocalizedStr(e.callEndedIncomingStr,g,"callendedincomingstr");else if("call_connect_error"===u)p=o.getLocalizedStr(e.callConnectErrorStr,g,"callconnecterrorstr",{"%errorCode%":e.systemEvent.errorCode,"%link%":l(o.getLocalizedStr(e.callConnectErrorLinkUrlStr,g,"callconnecterrorlinkurlstr"),o.getLocalizedStr(e.callConnectErrorLinkTextStr,g,"callconnecterrorlinktextstr"))});else if("local_muted"===u)p=o.getLocalizedStr(e.localMutedStr,g,"localmutedstr");else if("local_unmuted"===u)p=o.getLocalizedStr(e.localUnmutedStr,g,"localunmutedstr");else if("device_changed"===u)void 0===e.systemEvent.device&&(e.systemEvent.device=o.getLocalizedStr(e.unpluggedStr,g,"unpluggedstr")),p=o.getLocalizedStr(e.deviceChangedStr,g,"devicechangedstr",{"%devicename%":e.systemEvent.device});else if("inactivity"===u)p=o.getLocalizedStr(e.inactivityStr,g,"inactivitystr");else if("empty_room"===u)p=o.getLocalizedStr(e.emptyRoomStr,g,"emptyroomstr");else if("participant_enter"===u||"participant_exit"===u)s();else if("phishing"===u)p=o.getLocalizedStr(e.phishingStr,g,"phishingstr");else if("offline_mode"===u)p=o.getLocalizedStr(e.youAreOfflineStr,g,"youareofflinestr");else if("revoked_invite"===u){var h=e.systemEvent.gameName||o.getLocalizedStr(e.unknownGameStr,g,"unknowngamestr");p=o.getLocalizedStr(e.inviteRevokedStr,g,"inviterevokedstr",{"%username%":e.systemEvent.from,"%gametitle%":h})}e.message=p,e.trustAsHtml=function(e){return i.trustAsHtml(e)},e.$watch("systemEvent.presence",function(){"presence"===u&&(e.message=d(e.systemEvent.presence,f))}),"participant_enter"!==u&&"participant_exit"!==u||e.$watch(function(e){return e.systemEvent.from.length},function(){s()}),e.$watch("systemEvent.time",function(){e.time=o.getFormattedTimeStr(e.systemEvent.time)}),this.clickLink=function(t){"call_ended"===u?Origin.voice.showSurvey(e.systemEvent.channelId):a.asyncOpenUrl(t)}}function ga(e,t,i){"ngInject";i.locale(Origin.locale.locale().replace("_","-")),e.time=i(e.timestampEvent.time).format("LLL"),e.$watch("timestampEvent.time",function(){e.time=i(e.timestampEvent.time).format("LLL")})}function ua(e,t,i,n,r,o){"ngInject";function a(){e.noChatToolbar=Origin.utils.os()===Origin.utils.OS_MAC,l=s.find(".origin-social-conversation-input-section"),d=s.find(".origin-social-conversation-banner-section"),g=s.find(".origin-social-chatwindow-conversation-history");var t=l.outerHeight(),i=d.outerHeight();t>0&&(d.css("bottom",t+"px"),g.css("bottom",t+i+"px"))}var s,c,l,d,g;e.sendAMessageLoc=i.getLocalizedStr(e.sendAMessageStr,"origin-social-chatwindow-conversation-area","sendamessagestr"),this.setElement=function(e){c=(s=e).find(".origin-social-conversation-area"),l=s.find(".origin-social-conversation-input-section"),d=s.find(".origin-social-conversation-banner-section"),g=s.find(".origin-social-chatwindow-conversation-history")},this.inputResized=function(){a()},e.getLayoutHeight=function(){return c.innerHeight()},e.$watch(e.getLayoutHeight,function(){i.throttle(function(){a()},100).apply()},!0),e.getBannerHeight=function(){return d.outerHeight()},e.$watch(e.getBannerHeight,function(){a()},!0),o.create(n.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection")}function pa(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){var t=n.activeVoiceConversationId();return n.voiceCallObservable().data.isInVoice&&t===e.conversation.id}function u(){e.inVoip=g(),e.calling=n.voiceCallObservable().data.isCalling,e.isLocalMuted=n.voiceCallObservable().data.isLocalMuted,e.callInProgress=g()}function p(){e.callInProgressOverride=!1,e.state.voiceCall=!1,e.voiceCallState="NONE"}function m(t,r,o){var a=n.voiceCallInfoForConversation(t).state;switch(e.anyCallInProgress=n.activeVoiceConversationId(),o){case"STARTED":e.state.voiceCall=!1,e.callInProgressOverride=!1,e.voiceCallState="NONE",n.voiceCallInfoForConversation(t).state=o;break;case"ENDED":case"NOANSWER":case"MISSED":case"INACTIVITY":case"ENDED_INCOMING":p();break;case"LOCAL_MUTED":case"LOCAL_UNMUTED":case"PTT_ACTIVE":case"PTT_INACTIVE":break;case"ENDED_UNEXPECTEDLY":case"CONNECT_ERROR":p();break;case"OUTGOING":case"INCOMING":"INCOMING"===o?"OUTGOING"===a?(e.voiceCallState="OUTGOING",e.callingLoc=i.getLocalizedStr(e.callingStr,L,"callingstr",{"%username%":n.voiceCallInfoForConversation(t).originId}),e.callInProgress||(e.inProgressCallFriendStartedTitleLoc=i.getLocalizedStr(e.inProgressCallFriendStartedTitleStr,L,"inprogresscallfriendstartedtitlestr",{"%username%":r}))):(n.setVoiceCallInfoForConversation(t,o,r),e.iscallingLoc=i.getLocalizedStr(e.iscallingStr,L,"iscallingstr",{"%username%":r}),e.voiceCallState=o,e.callInProgress||(e.inProgressCallFriendStartedTitleLoc=i.getLocalizedStr(e.inProgressCallFriendStartedTitleStr,L,"inprogresscallfriendstartedtitlestr",{"%username%":r}))):(n.setVoiceCallInfoForConversation(t,o,r),e.callingLoc=i.getLocalizedStr(e.callingStr,L,"callingstr",{"%username%":r}),e.voiceCallState=o),e.state.voiceCall=!0}}function f(t){var i=e.conversation.participants[0];i===Number(t.nucleusId)?(m(i,x,t.event),e.$digest()):"STARTED"!==t.event&&"OUTGOING"!==t.event||(e.state.voiceCall=!1,e.callInProgressOverride=!1,e.voiceCallState="NONE")}function h(t){return e.conversation.gameInvite.productId?t[e.conversation.gameInvite.productId]:t[e.presence.gameActivity.productId]}function v(t){return t[e.presence.gameActivity.productId]}function b(t){e.invitePackartSmall=t.i18n.packArtSmall,e.inviteGameName=t.i18n.displayName,e.$digest()}function y(e){a.error("[origin-social-chatwindow-conversation-banner] GamesCatalogFactory.getCatalogInfo",e)}function S(){_.isUndefined(e.presence)||_.isUndefined(e.presence.gameActivity.joinable)||(e.state.invited=!1,void 0!==e.conversation&&(e.state.invited=e.conversation.invited,e.conversation.invited?e.inviteTimerActive||(e.inviteTimerActive=!0,e.inviteTimer=setTimeout(function(){e.state.invited=!1,e.inviteTimerActive=!1,e.$digest()},jM),o.getCatalogInfo([e.conversation.gameInvite.productId]).then(h).then(b).catch(y)):(e.inviteTimerActive&&(e.inviteTimerActive=!1,clearTimeout(e.inviteTimer)),setTimeout(function(){o.getCatalogInfo([e.presence.gameActivity.productId]).then(v).then(b).catch(y)},0))),e.$digest())}function k(){e.callInProgressOverride=!0,e.state.voiceCall=!0,e.voiceCallState="OUTGOING",e.inProgressCallUserStartedTitleLoc=i.getLocalizedStr(e.inProgressCallUserStartedTitleStr,L,"inprogresscalluserstartedntitlestr",{"%username%":x}),e.$digest()}function I(t){var i=t.NUCLEUS_ID,n=e.conversation.participants[0];i.toString()===n.toString()&&(e.joinGameState=UM,r.acceptInvitation(n),e.$digest())}function w(){var t=_.get(e,["presence","groupActivity","groupId"],"");return t?Origin.xmpp.getUserPartyGuid().then(function(e){return e&&-1!==t.indexOf(e)}).catch(function(){return!1}):Promise.resolve(!1)}function C(t){var i=t.NUCLEUS_ID,n=e.conversation.participants[0];i.toString()===n.toString()&&(e.joinGameState=BM,r.ignoreInvitation(n),e.$digest(),setTimeout(function(){w().then(function(t){e.joinGameState=t?MM:GM,e.$digest()})},3e3))}function T(t){var i=t.NUCLEUS_ID,n=e.conversation.participants[0];i.toString()===n.toString()&&(e.joinGameState=GM,r.ignoreInvitation(n),e.$digest())}function P(){e.joinGameState=GM,e.$digest()}function O(t){e.isOnline=!(!t||!t.isOnline),e.$digest()}function E(){var t=e.conversation.participants[0];r.events.off("gameInviteReceived:"+t,S),r.events.off("gameInviteRevoked:"+t,S),r.events.off("presenceChanged:"+t,S),r.events.off("showOutgoingCallBanner:"+t,k),r.events.off("hideInProgressCallBanner:"+t,e.hideOutgoingInProgressCallBanner),n.events.off("voiceCallEvent",f),n.voiceCallObservable().removeObserver(u),Origin.events.off(Origin.events.XMPP_GAMEINVITEFLOWSTARTED,I),Origin.events.off(Origin.events.XMPP_GAMEINVITEFLOWSUCCESS,C),Origin.events.off(Origin.events.XMPP_GAMEINVITEFLOWFAILED,T),Origin.events.off(Origin.events.XMPP_LEAVINGPARTY,P),l.events.off("myauth:clientonlinestatechangeinitiated",O)}function F(){Origin.client.isEmbeddedBrowser()&&w().then(function(t){t?(e.joinGameState=MM,e.$digest()):e.joinGameState===MM&&(e.joinGameState=GM,e.$digest())})}var x,L="origin-social-chatwindow-conversation-banner";if(e.defaultPackArt=d.getImagePath(AI),e.playingLoc=i.getLocalizedStr(e.playingStr,L,"playingstr"),e.playingInGroupLoc=i.getLocalizedStr(e.playingInGroupLoc,L,"playingingroupstr"),e.playingInGroupWithNameLoc=i.getLocalizedStr(e.playingInGroupWithNameLoc,L,"playingingroupwithnamestr"),e.broadcastingLoc=i.getLocalizedStr(e.broadcastingStr,L,"broadcastingstr"),e.joinGameLoc=i.getLocalizedStr(e.joinGameLoc,L,"joingamecta"),e.joinGroupLoc=i.getLocalizedStr(e.joinGroupLoc,L,"joingroupcta"),e.joinGameAndGroupLoc=i.getLocalizedStr(e.joinGameAndGroupLoc,L,"joingameandgroupcta"),e.orLoc=i.getLocalizedStr(e.orStr,L,"orstr"),e.watchLoc=i.getLocalizedStr(e.watchStr,L,"watchstr"),e.ignoreLoc=i.getLocalizedStr(e.ignoreStr,L,"ignorestr"),e.cancelLoc=i.getLocalizedStr(e.cancelStr,L,"cancelstr"),e.incomingcallLoc=i.getLocalizedStr(e.incomingcallStr,L,"incomingcallstr"),e.inProgressCallUserStartedDescriptionLoc=i.getLocalizedStr(e.inProgressCallUserStartedDescriptionStr,L,"inprogresscalluserstartedndescriptionstr"),e.inProgressCallFriendStartedDescriptionLoc=i.getLocalizedStr(e.inProgressCallFriendStartedDescriptionStr,L,"inprogresscallfriendstarteddescriptionstr"),e.answerCallLoc=i.getLocalizedStr(e.answerCallStr,L,"answercallstr"),e.ignoreCallLoc=i.getLocalizedStr(e.ignoreCallStr,L,"ignorecallstr"),e.currentUserPresence=t.getCurrentUserPresence(),e.callInProgress=g(),e.anyCallInProgress=n.activeVoiceConversationId(),e.callInProgressOverride=!1,e.isOnline=!0,e.inviteTimer=null,e.inviteTimerActive=!1,e.joinGameStrings={unableToJoinText:i.getLocalizedStr(e.joinGameUnableText,L,"join-game-unable-text"),notOwnedText:i.getLocalizedStr(e.joinGameNotOwnedText,L,"join-game-not-owned-text"),viewInStoreText:i.getLocalizedStr(e.joinGameViewInStoreButtonText,L,"join-game-view-in-store-button-text"),closeText:i.getLocalizedStr(e.joinGameCloseButtonText,L,"join-game-close-button-text"),notInstalledText:i.getLocalizedStr(e.joinGameNotInstalledText,L,"join-game-not-installed-text"),downloadText:i.getLocalizedStr(e.joinGameDownloadButtonText,L,"join-game-download-button-text")},e.joinGameState=GM,t.getRosterUser(Origin.user.userPid()).then(function(t){if(t&&(s.create(t._presence).defaultTo({jid:Origin.user.userPid(),presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"selfPresence"),Origin.client.isEmbeddedBrowser())){var i=e.selfPresence.groupActivity&&e.selfPresence.groupActivity.groupId?e.selfPresence.groupActivity.groupId:"";i.length&&Origin.xmpp.getUserPartyGuid().then(function(t){_.get(t,"length",!1)&&-1!==i.indexOf(t)&&(e.joinGameState=MM,e.$digest())})}}),n.voiceCallObservable().addObserver(u),e.gameInvite={},e.state={voice:!1,invited:!1,playingGame:!1},e.voiceCallState="NONE",e.showGameData=function(e){var i=!0;return e&&e.gameActivity&&(e.gameActivity.productId&&e.gameActivity.productId.indexOf("NOG_")>-1?i=!1:t.isEmbargoedPresence(e)&&(i=!1)),i},e.hideOutgoingInProgressCallBanner=function(){e.callInProgressOverride=!1,e.state.voiceCall=!1,m(A,x),r.inProgressCallBannerHidden(A),e.$digest()},"ONE_ON_ONE"===e.conversation.state){!function(){var t=e.conversation.participants[0];r.events.on("gameInviteReceived:"+t,S),r.events.on("gameInviteRevoked:"+t,S),r.events.on("presenceChanged:"+t,S),r.events.on("showOutgoingCallBanner:"+t,k),r.events.on("hideInProgressCallBanner:"+t,e.hideOutgoingInProgressCallBanner),n.events.on("voiceCallEvent",f),Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSTARTED,I),Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSUCCESS,C),Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWFAILED,T),Origin.events.on(Origin.events.XMPP_LEAVINGPARTY,P),l.events.on("myauth:clientonlinestatechangeinitiated",O),c.listenForScopeAndWindowDestroy(e,E)}();var A=e.conversation.participants[0];t.getRosterUser(A).then(function(t){t&&(s.create(t._presence).defaultTo({jid:A,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence").attachToScope(e,F),x=t.originId,e.invitedToPlayLoc=i.getLocalizedStr(e.invitedToPlayStr,L,"invitedtoplaystr",{"%username%":x}),m(A,t.originId,n.voiceCallInfoForConversation(A).state),S())})}}function ma(e,t,i,n,r,o){"ngInject";return{restrict:"E",controller:pa,scope:{conversation:"=",playingStr:"@playingstr",broadcastingStr:"@broadcastingstr",joinGameLoc:"@joingamecta",joinGroupLoc:"@joingroupcta",joinGameAndGroupLoc:"@joingameandgroupcta",orStr:"@orstr",watchStr:"@watchstr",ignoreStr:"@ignorestr",callingStr:"@callingstr",cancelStr:"@cancelstr",incomingcallStr:"@incomingcallstr",iscallingStr:"@iscallingstr",invitedToPlayStr:"@invitedtoplaystr",playingInGroupLoc:"@playingingroupstr",playingInGroupWithNameLoc:"@playingingroupwithnamestr",inProgressCallUserStartedTitleStr:"@inprogresscalluserstartedntitlestr",inProgressCallUserStartedDescriptionStr:"@inprogresscalluserstartedndescriptionstr",inProgressCallFriendStartedTitleStr:"@inprogresscallfriendstartedtitlestr",inProgressCallFriendStartedDescriptionStr:"@inprogresscallfriendstarteddescriptionstr",answerCallStr:"@answercallstr",ignoreCallStr:"@ignorecallstr",joinGameCloseButtonText:"@",joinGameDownloadButtonText:"@",joinGameNotInstalledText:"@",joinGameNotOwnedText:"@",joinGameUnableText:"@",joinGameViewInStoreButtonText:"@"},link:function(a,s){function c(e){var t=$(e.target).attr("data-product-id"),i=$(e.target).attr("data-multiplayer-id");t&&i?r.goProductDetailsWithMultiplayerId(t,i):t&&r.goProductDetails(t)}function l(){var e=a.conversation.participants[0],i=a.presence.gameActivity.productId,n=a.presence.gameActivity.multiplayerId,r=a.presence.gameActivity.gameTitle;t.joinFriendsGame(e,i,n,r,a.joinGameStrings)}function d(t){var i=$(t.target).attr("data-broadcast-url");i&&e.asyncOpenUrl(i)}function g(){var e=a.conversation.participants[0],n=a.conversation.gameInvite.productId,r=a.conversation.gameInvite.multiplayerId,o=a.inviteGameName;Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_GAME_INVITE_ACCEPT,{label:"Chat"}),t.joinFriendsGame(e,n,r,o,a.joinGameStrings),function(e){i.acceptInvitation(e)}(e)}function u(){var e=a.conversation.participants[0];Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_GAME_INVITE_DECLINE,{label:"Chat"}),t.ignoreGameInvite(e),function(e){i.ignoreInvitation(e)}(e)}function p(){r.goProductDetailsWithMultiplayerId(a.gameInvite.productId,a.gameInvite.multiplayerId)}function m(){var e=a.gameInvite.productId||a.presence.gameActivity.productId,t=a.gameInvite.multiplayerId||a.presence.gameActivity.multiplayerId;e&&t?r.goProductDetailsWithMultiplayerId(e,t):e&&r.goProductDetails(e)}function f(){Origin.voice.leaveVoice(a.conversation.id)}function h(){Origin.voice.answerCall(a.conversation.id)}function v(){Origin.voice.ignoreCall(a.conversation.id)}function b(){var e=a.conversation.participants[0],t=n.incomingVoiceConversationId(),i=parseInt(a.conversation.id,10),r=n.activeVoiceConversationId();r&&r!==i&&Origin.voice.leaveVoice(r),t&&t!==i&&Origin.voice.leaveVoice(t),e&&(Origin.voice.joinVoice(e,a.conversation.participants),a.hideOutgoingInProgressCallBanner())}function y(){a.hideOutgoingInProgressCallBanner()}angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-productlink",c),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-join",l),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-watch",d),o.listenForScopeAndWindowDestroy(a,function(){angular.element(s).off("click"),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-join",l),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-watch",d),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-inprogressvoicecall-action-link-cancel",y),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-inprogressvoicecall-action-link-accept",b),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-voicecall-action-link-ignore",v),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-voicecall-action-link-answer",h),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-voicecall-cancel",f),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-packart",m),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-gameinvite-gamename",p),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-gameinvite-ignore",u),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-gameinvite-join",g),angular.element(s).off("click",".origin-social-chatwindow-conversation-banner-productlink",c)}),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-gameinvite-join",g),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-gameinvite-ignore",u),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-gameinvite-gamename",p),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-packart",m),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-voicecall-cancel",f),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-voicecall-action-link-answer",h),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-voicecall-action-link-ignore",v),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-inprogressvoicecall-action-link-accept",b),angular.element(s).on("click",".origin-social-chatwindow-conversation-banner-inprogressvoicecall-action-link-cancel",y)},template:NM}}function fa(e,t,i,n,r,o,a){"ngInject";function s(){c.scrollTop(c[0].scrollHeight)}var c,l=!1,d=[];e.typingState="ACTIVE",e.typingImageSrc=t.getImagePath("social\\composing.gif"),e.idleImageSrc=t.getImagePath("social\\idle.gif"),e.eventTrackingFunction=function(e,t){var i=e;return void 0!==t&&(i+=t),i},this.setElement=function(e){c=e},this.onScroll=function(){var e=c[0],t=e.scrollHeight-e.scrollTop<=e.clientHeight+VM;l=!t},d[d.length]=i.events.on("historyUpdated",function(t,i){t.toString()===e.conversation.id.toString()&&(e.$digest(),l&&!i||s())}),d[d.length]=i.events.on("typingStateUpdated:"+e.conversation.id,function(t){r.getFriendInfo(e.conversation.participants[0]).then(function(i){e.typingState="UNAVAILABLE"===i.presence.show?"ACTIVE":t,e.$digest(),l||s()})}),a.listenForScopeAndWindowDestroy(e,function(){o.detachAll(d)}),e.getHistoryWidth=function(){return c.innerWidth()},e.getHistoryHeight=function(){return c.innerHeight()},e.$watch(e.getHistoryWidth,function(){n.throttle(function(){l||s()},100).apply()},!0),e.$watch(e.getHistoryHeight,function(){n.throttle(function(){l||s()},100).apply()},!0)}function ha(e,t){"ngInject";return{restrict:"E",controller:fa,scope:{conversation:"="},link:function(e,i,n,r){var o=$(i).find(".origin-social-chatwindow-conversation-history");r.setElement(o),o.on("scroll",function(){r.onScroll()}),o.bind("mousewheel",function(e){return $(this).scrollTop($(this).scrollTop()-e.originalEvent.wheelDeltaY),!1}),t.listenForScopeAndWindowDestroy(e,function(){o.unbind("mousewheel"),o.off("scroll")})},template:zM}}function va(e,t,i,n,r){"ngInject";this.sendMessage=function(i){"ONE_ON_ONE"===e.conversation.state?t.sendXmppMessage(e.conversation.participants[0],i):t.sendMultiXmppMessage(e.conversation.id,i)},r.create(i.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection")}function ba(e){"ngInject";return{restrict:"E",controller:va,scope:{conversation:"=",placeholder:"@placeholder"},link:function(t,i,n,r){var o=$(i).find(".origin-social-chatwindow-conversation-input"),a=$(i).find(".origin-social-chatwindow-conversation-input-hidden-size-div"),s=!1,c=0,l=0,d=parseInt(o.css("max-height"),10);o.keydown(function(e){var n=o.val();27===(e.keyCode||e.which)&&(e.stopImmediatePropagation(),e.preventDefault()),13===(e.keyCode||e.which)&&(e.stopImmediatePropagation(),e.preventDefault(),n.length&&(r.sendMessage(n),o.val(""),t.conversation.pendingText="",$(i).trigger("resized"),s=!1,0!==c&&(clearTimeout(c),c=0)))}),o.keyup(function(){var n=o.val();a.text(n);var r=a.outerHeight();r!==l&&(l=r,o.css({height:r+"px"}),$(i).trigger("resized"),r>=d?o.css({"overflow-y":"scroll",padding:"10px 10px 0 10px"}):o.css({"overflow-y":"hidden",padding:"10px"})),t.conversation.pendingText=n,s||0===n.length||(s=!0,e.sendXmppTypingState("composing",t.conversation.participants[0])),0!==c&&(clearTimeout(c),c=0),c=setTimeout(function(){n.length?e.sendXmppTypingState("paused",t.conversation.participants[0]):e.sendXmppTypingState("active",t.conversation.participants[0]),s=!1},1e4),0===n.length&&(s&&(s=!1,e.sendXmppTypingState("active",t.conversation.participants[0])),0!==c&&(clearTimeout(c),c=0))}),o.focus()},template:qM}}function ya(e,t,i,n,r,o,a){"ngInject";function s(){e.userIsAFriend=!1,i.getRoster("ALL").then(function(t){void 0!==t[e.participant]&&"BOTH"===t[e.participant].subState&&(e.userIsAFriend=!0,Number(e.participant)===Number(Origin.user.userPid())?(e.user.originId=Origin.user.originId(),e.user.presence=i.getCurrentUserPresence(),l(e.user.presence),e.status=""):e.userIsAFriend?i.getFriendInfo(e.participant).then(function(t){e.user=t,l(t.presence),e.$digest()}):n.getGroupMemberInfo(e.participant).then(function(t){e.user.originId=t,e.user.presence={show:"UNAVAILABLE"},e.status=e.notAFriendLoc,e.$digest()}))})}function c(t){(e.participant===Origin.user.userPid()||e.userIsAFriend)&&(e.user.presence=t,l(e.user.presence),e.$digest())}function l(t){if(e.user.joinable=!1,e.user.ingame=!1,e.user.broadcasting=!1,"INGAME"===t.show&&(e.user.ingame=!0),"ONLINE"===t.show&&(e.user.broadcasting=t.isBroadcasting,e.user.joinable=t.isJoinable),!e.user.ingame)switch(t.show){case"ONLINE":e.status=e.onlineLoc;break;case"AWAY":e.status=e.awayLoc;break;case"UNAVAILABLE":e.status=e.offlineLoc}}var d="origin-social-chatwindow-conversation-participant",g=[];e.onlineLoc=r.getLocalizedStr(e.onlineStr,d,"onlinestr"),e.offlineLoc=r.getLocalizedStr(e.offlineStr,d,"offlinestr"),e.awayLoc=r.getLocalizedStr(e.awayStr,d,"awaystr"),e.notAFriendLoc=r.getLocalizedStr(e.notAFriendStr,d,"notafriendstr"),e.user={},e.isSelf=e.participant===Origin.user.userPid(),e.status="",e.userIsAFriend=!1,e.$watch("participant",function(t,n){i.events.off("socialPresenceChanged:"+n,c),g[g.length]=i.events.on("socialPresenceChanged:"+e.participant,c),s()}),g[g.length]=i.events.on("socialRosterUpdated",s),a.listenForScopeAndWindowDestroy(e,function(){o.detachAll(g)})}function Sa(e,t,i,n){"ngInject";function r(){e.participants=e.conversation.participants,e.inChatLoc=i.getLocalizedStr(e.inChatStr,a,"inchatstr",{"%number%":e.participants.length});var t=e.participants.indexOf(Origin.user.userPid());t>-1&&e.participants.splice(t,1)}function o(){r(),e.$digest()}var a="origin-social-chatwindow-conversation-participantlist";e.participants=[],e.self=Origin.user.userPid(),r(),t.events.on("updateParticipantList",o),n.listenForScopeAndWindowDestroy(e,function(){t.events.off("updateParticipantList",o)})}function ka(e,t,i){"ngInject";var n=e.conversation.participants[0];t.getRosterUser(n).then(function(t){t&&i.create(t._presence).defaultTo({jid:n,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")}),i.create(t.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection")}function Ia(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(){P()}function m(t){var i=angular.element(".origin-social-chatwindow-area");t?(e.poppedOut||E.show(),i.show(),window.addEventListener("focus",p),w(),n.isWindowMinimized()&&n.unminimizeWindow(),O()):(window.removeEventListener("focus",p),angular.element(".origin-social-chatwindow-area").hide())}function f(e){return angular.element('.origin-social-chatwindow-tab[data-conversation-id="'+e+'"]')}function h(){return angular.element(".origin-social-chatwindow-tab.otktab.otktab-active")}function v(e){return e.attr("data-conversation-id")}function b(e){e.removeClass("otkbadge-isnotifying"),t(function(){e.addClass("otkbadge-isnotifying")},0)}function y(){var t=e.overflowUnreadCount,i=E.find(".origin-social-chatwindow-tab-overflow-tab-unread-badge");e.overflowUnreadCount=0,$.each(n.overflowTabIds(),function(t,i){e.overflowUnreadCount+=r.getConversationById(i)?r.getConversationById(i).unreadCount:0}),e.overflowUnreadCount!==t&&b(i),Origin.client.isEmbeddedBrowser()&&!e.igoContext&&function(){var t=e.unreadCount;e.unreadCount=0,$.each(n.overflowTabIds(),function(t,i){var n=r.getConversationById(i).unreadCount;e.unreadCount+=n}),$.each(n.visibleTabIds(),function(t,i){var n=r.getConversationById(i).unreadCount;e.unreadCount+=n}),"MAC"===Origin.utils.os()?e.unreadCount!==t&&Origin.client.desktopServices.flashIcon(e.unreadCount):e.unreadCount>t&&Origin.client.desktopServices.flashIcon(e.unreadCount),e.$digest()}()}function S(){var t,n,o;(t=h()).length?(o=t.attr("data-conversation-id"),(n=r.getConversationById(o))?(e.windowTitleStr=e.shouldShowTabs()?"":i.trustAsHtml(n.title),e.showTitlebarPresence="ONE_ON_ONE"===n.state&&!e.shouldShowTabs()):(e.windowTitleStr="",e.showTitlebarPresence=!1)):(e.windowTitleStr="",e.showTitlebarPresence=!1)}function k(i){var n,a,s=i.attr("data-conversation-id"),c=h().attr("data-conversation-id");c!==s&&(angular.element(".origin-social-chatwindow-tab.otktab-active").removeClass("otktab-active"),i.addClass("otktab-active"),angular.element(".origin-social-chatwindow-conversation-section").hide(),void 0!==c&&(r.markConversationReadById(s),y()),r.setActiveConversationId(s),function(e){return angular.element('.origin-social-chatwindow-conversation-section[data-conversation-id="'+e+'"]')}(s).show(),t(function(){E.find(".origin-social-chatwindow-conversation-input").focus()},0),"ONE_ON_ONE"===(n=r.getConversationById(s)).state&&(a=n.participants[0],x&&x.detach(e),o.getRosterUser(a).then(function(t){t&&(x=l.create(t._presence).defaultTo({jid:a,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"activePresence"))})))}function I(){return Object.keys(e.conversations).length}function w(){var e,t,i,r,o,a=n.visibleTabIds(),s=n.overflowTabIds();if(I()>1&&(e=XM.innerWidth()-tj)>0)if(t=Math.floor(e/ej),a.length>t)for(i=a.length-t,r=a.length-1,o=0;o<i;r--,o++)T(a[r]);else if(a.length<t&&s.length)for((i=t-a.length)>s.length&&(i=s.length),r=0;r<i;r++)C(s[0],!1);y()}function C(e,t){var i=n.visibleTabIds(),r=n.overflowTabIds(),o=r.indexOf(e);o>-1&&r.splice(o,1),-1===i.indexOf(e)&&(t?i.unshift(e):i.push(e))}function T(e){var t=n.visibleTabIds(),i=n.overflowTabIds(),r=t.indexOf(e);r>-1&&t.splice(r,1),-1===i.indexOf(e)&&i.unshift(e)}function P(){var e=v(h());r.markConversationReadById(e)}function O(){!1===e.igoContext&&window&&n.poppedOutChatWindow&&n.isWindowPoppedOut()&&(window.hasOwnProperty("_moveWindowToFront")&&"function"==typeof window._moveWindowToFront?window._moveWindowToFront(n.poppedOutChatWindow):window.opener.hasOwnProperty("_moveWindowToFront")&&"function"==typeof window.opener._moveWindowToFront&&window.opener._moveWindowToFront(n.poppedOutChatWindow))}var E,F,x,L,A=[],D=!1,R=this;e.windowTitleStr="",e.overflowUnreadCount=0,e.poppedOut=n.isWindowPoppedOut(),e.unpopped=!1,e.igoContext=d.isOIGContext(),n.playingGames=[],this.setElement=function(e){XM=(E=e).find(".origin-social-chatwindow-area-tabs")},this.getTotalNotificationCount=function(){return e.totalNotificationCount},this.onRaiseConversation=function(i){t(function(){var r;-1===n.visibleTabIds().indexOf(i)&&n.visibleTabIds().unshift(i),C(i,!0),w(),t(function(){(r=f(i)).length&&k(r),n.isWindowPoppedOut()&&!e.poppedOut||(S(),m(!0))})})},this.getActiveConversationId=function(){return v(h())},this.onTabClick=function(e){var t=angular.element(e);k(t.attr("data-conversation-id")?t:t.parents(".otktab"))},this.onTabOverflowMenuItemClick=function(e){var t=angular.element(e).parents("[data-conversation-id]").attr("data-conversation-id");this.onRaiseConversation(t)},this.onCloseTabClick=function(e){var t=angular.element(e).attr("data-conversation-id")||angular.element(e).parents(".otktab").attr("data-conversation-id");r.closeConversationById(t)},this.onCloseOverflowMenuItemClick=function(e){var t=angular.element(e).parents("[data-conversation-id]").attr("data-conversation-id");r.closeConversationById(t)},e.conversations=r.getConversations(),e.shouldShowTabs=function(){return I()>1},e.getConversationById=function(e){return r.getConversationById(e)},e.getNotificationCountById=function(t){return e.notificationCounts[t]},e.getVisibleTabIds=function(){return n.visibleTabIds()},e.getOverflowTabIds=function(){return n.overflowTabIds()},e.showProfileForTitlebarClick=function(){var e=r.getActiveConversationId(),t=r.getConversationById(e);if("ONE_ON_ONE"===t.state){var i=t.participants[0];Origin.client.oig.IGOIsActive()?u.openIGOSPA("PROFILE",i):u.goUserProfile(i)}},e.showProfileForTabClick=function(e){var t=v(h()),i=angular.element(e).attr("data-conversation-id")||angular.element(e).parents(".otktab").attr("data-conversation-id");if(i===t){var n=r.getConversationById(i);if("ONE_ON_ONE"===n.state){var o=n.participants[0];Origin.client.oig.IGOIsActive()?u.openIGOSPA("PROFILE",o):u.goUserProfile(o)}}},L=l.create(o.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection"),A[A.length]=s.events.on("jssdkLogin",function(t){e.userLoggedIn=t}),g.listenForScopeAndWindowDestroy(e,function(){n.closeWindow(e.unpopped),c.detachAll(A),F&&F(),x&&x.detach(),L&&L.detach()}),A[A.length]=r.events.on("conversationClosed",function(e){t(function(){var t,i=f(e),r=v(i),o=v(h());!function(e){var t=n.visibleTabIds(),i=n.overflowTabIds(),r=t.indexOf(e);r>-1&&t.splice(r,1),(r=i.indexOf(e))>-1&&i.splice(r,1)}(e),w(),o===r&&I()>0&&i.length&&k((t=i.next(".origin-social-chatwindow-tab")).length?t:(t=i.prev(".origin-social-chatwindow-tab")).length?t:$(".origin-social-chatwindow-tab.otktab:first")),S()})}),A[A.length]=r.events.on("addMessage",function(e){t(function(){var t=h(),i=v(t),o=f(e).find(".otkbadge"),a=function(e){return angular.element('.origin-social-chatwindow-tab-overflow-menu-item[data-conversation-id="'+e+'"]')}(e).find(".otkbadge"),s=null!==n.poppedOutChatWindow&&n.poppedOutChatWindow.hasFocus(),c=null===n.poppedOutChatWindow&&document.hasFocus(),l=e===i,d=0===t.length;!s&&!c||n.isWindowMinimized()||!l&&!d||r.markConversationReadById(e),b(o),b(a),y()})}),A[A.length]=r.events.on("incomingVoiceCall",function(t,i,o){if((!n.isWindowPoppedOut()||e.poppedOut)&&!(e.igoContext&&!Origin.client.oig.IGOIsActive()||!e.igoContext&&Origin.client.oig.IGOIsActive())){var a=document.hasFocus()&&!n.isWindowMinimized()&&t===r.getActiveConversationId();!o&&a||(Origin.client.desktopServices.flashIcon(e.unreadCount),Origin.voice.showToast("INCOMING",i.originId,t))}}),A[A.length]=r.events.on("conversationRead",function(){y()}),A[A.length]=n.events.on("openConversation",function(e){1===I()?this.onRaiseConversation(e):t(function(){n.overflowTabIds().length?-1===n.overflowTabIds().indexOf(e)&&n.overflowTabIds().push(e):-1===n.visibleTabIds().indexOf(e)&&n.visibleTabIds().push(e),w(),S()})}),A[A.length]=n.events.on("raiseConversation",this.onRaiseConversation),A[A.length]=n.events.on("closeChatWindow",function(t){if(t)m(!0);else if(m(!1),r.closeAllConversations(),Origin.client.isEmbeddedBrowser()&&Origin.client.oig.closeIGOConversation(),e.igoContext&&window.close(),e.poppedOut){var i=window.url;i?Origin.client.isEmbeddedBrowser()&&Origin.client.popout.popInWindow(i):window.close(),e.poppedOut=!1}}),A[A.length]=n.events.on("selectTab",function(e){t(function(){var t=f(e);t.length&&k(t),S()},0)}),A[A.length]=n.events.on("unminimizeChatWindow",function(){t(function(){E.show();var e=h();e.length?(r.markConversationReadById(v(e)),E.find(".origin-social-chatwindow-conversation-input").focus(),y()):R.onRaiseConversation(r.getActiveConversationId())})}),A[A.length]=n.events.on("unpopOutChatWindow",function(){if(n.isWindowMinimized()||n.isWindowPoppedOut()||e.poppedOut){e.unpopped=!0;var t=window.url;t?Origin.client.isEmbeddedBrowser()?Origin.client.popout.popInWindow(t):window.close():E.show(),n.poppedOutChatWindow=null,D=!1}else E.show()}),A[A.length]=n.events.on("minimizeChatWindow",function(){d.isOIGContext()||E.hide()}),A[A.length]=n.events.on("popOutChatWindow",function(){var e=angular.isDefined(d.getOIGContextConfig()),t=a.guid();if(Origin.client.isEmbeddedBrowser()&&Origin.client.desktopServices.setNextWindowUUID(t),!e){var i={top:window.screenY+E.offset().top-10,left:window.screenX+E.offset().left-10,width:XM.width,height:XM.height};_.isFunction(window._openPopOutWindow)&&window._openPopOutWindow("socialwindow","","",i).then(function(e){n.poppedOutChatWindow=e,n.poppedOutChatWindow.OriginWindowUUID=t,Origin.client.isEmbeddedBrowser()&&Origin.events.on(Origin.events.CLIENT_POP_OUT_CLOSED,function(e){n.poppedOutChatWindow&&n.poppedOutChatWindow.url===e&&(n.poppedOutChatWindow.close(),n.poppedOutChatWindow=null,D=!1)}),window.onunload=function(){"about:blank"!==window.location.href&&(n.poppedOutChatWindow.close(),n.poppedOutChatWindow=null,D=!1)},E.hide(),n.poppedOutChatWindow.onunload=function(){"about:blank"!==n.poppedOutChatWindow.location.href&&(n.poppedOutChatWindow.close(),n.poppedOutChatWindow=null,D=!1)},n.poppedOutChatWindow.onfocus=function(){P(),D=!0},n.poppedOutChatWindow.onblur=function(){D=!1},n.poppedOutChatWindow.onload=function(){n.poppedOutChatWindow.focus()},n.poppedOutChatWindow.hasFocus=function(){return null!==n.poppedOutChatWindow&&D},D=!0})}}),A[A.length]=Origin.events.on(Origin.events.CLIENT_SOCIAL_MESSAGERECEIVED,function(t){if((!n.isWindowPoppedOut()||e.poppedOut)&&!(e.igoContext&&!Origin.client.oig.IGOIsActive()||!e.igoContext&&Origin.client.oig.IGOIsActive())){var i=t.from.split("@")[0];if((!document.hasFocus()||n.isWindowMinimized()||i!==r.getActiveConversationId())&&Number(i)!==Origin.user.userPid()){var o=t.msgBody.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#39;/g,"'").replace(/<[^>]*>/g,"");Origin.client.social.showChatToast(t.from,o)}}}),F=e.$on("postrepeat:last",function(e){s.updateLoginStatus();var t=r.getActiveConversationId();return void 0!==t&&n.selectTab(t),e.stopPropagation(),!1}),A[A.length]=Origin.events.on(Origin.events.CLIENT_DESKTOP_DOCKICONCLICKED,O),A[A.length]=Origin.events.on(Origin.events.CLIENT_SOCIAL_SHOWCHATWINDOWFORFRIEND,function(t){if(!1===e.igoContext&&window){var i=t.jid.split("@")[0];r.openConversation(i),n.poppedOutChatWindow&&n.isWindowPoppedOut()?(window._moveWindowToFront(n.poppedOutChatWindow),Origin.client.desktopServices.showWindow(n.poppedOutChatWindow.OriginWindowUUID)):(n.isWindowMinimized()&&n.unminimizeWindow(),window._moveWindowToFront(window),Origin.client.desktopServices.showWindow(window.OriginWindowUUID))}}),A[A.length]=Origin.events.on(Origin.events.CLIENT_GAMES_CHANGED,function(e){var t=e.updatedGames;if(!angular.isDefined(d.getOIGContextConfig())&&n.isWindowPoppedOut()){var i=n.playingGames.findIndex(function(e){return e.productId===t[0].productId});if(t[0].playing&&-1===i)t[0].isIGOEnabled&&Origin.client.desktopServices.miniaturize(n.poppedOutChatWindow.OriginWindowUUID),n.playingGames.push(t[0]);else if(!t[0].playing&&-1!==i){n.playingGames.splice(i,1);for(var r=!1,o=0;o<n.playingGames.length;++o)r=r||n.playingGames[o].isIGOEnabled;r||Origin.client.desktopServices.deminiaturize(n.poppedOutChatWindow.OriginWindowUUID)}}}),angular.element(window).resize(a.throttle(function(){w()},300))}function wa(e,t,i,n){"ngInject";return{restrict:"E",scope:{},controller:Ia,template:ZM,link:function(i,r,o,a){function s(){e.isWindowMinimized()&&e.unminimizeWindow(),t(function(){r.find(".origin-social-chatwindow-conversation-input").focus()},0)}function c(e){a.onTabClick(e.target)}function l(e){a.onTabOverflowMenuItemClick(e.target)}function d(e){e.stopImmediatePropagation(),e.preventDefault(),a.onCloseTabClick(e.target)}function g(e){e.stopImmediatePropagation(),e.preventDefault(),a.onCloseOverflowMenuItemClick(e.target)}function u(){e.closeWindow()}function p(e){var t=r.find(".otkdropdown .otkdropdown-wrap");t.hasClass("otkdropdown-isvisible")?t.hide():t.show(),t.toggleClass("otkdropdown-isvisible"),e.stopImmediatePropagation(),e.preventDefault()}function m(){var e=r.find(".otkdropdown .otkdropdown-wrap");e.removeClass("otkdropdown-isvisible"),e.hide()}a.setElement(r),r.on("click",".origin-social-chatwindow-tab",c),r.on("click",".origin-social-chatwindow-tab-overflow-menu-item",l),r.on("click",".origin-social-chatwindow-tab-close",d),r.on("click",".origin-social-chatwindow-tab-overflow-menu-item-close",g),r.on("click",".origin-titlebar-subwindow-title",function(){i.showProfileForTitlebarClick()}),r.on("click",".origin-social-chatwindow-area-tabs .otktab-title",function(e){i.showProfileForTabClick(e.target)}),r.on("click",".origin-titlebar-subwindow-close",u),r.on("click",".origin-titlebar-subwindow-minimize",e.minimizeWindow),r.on("click",".origin-titlebar-subwindow-popout",e.popOutWindow),r.on("click",".origin-titlebar-subwindow-popin",e.unpopOutWindow),r.on("click",".origin-social-chatwindow-tab-overflow-tab",p),angular.element(document).on("click",m),(e.isWindowMinimized()||e.isWindowPoppedOut())&&(window.opener?(r.show(),window.focus()):r.hide()),n.listenForScopeAndWindowDestroy(i,function(){Origin.events.off(Origin.events.CLIENT_SOCIAL_FOCUSONACTIVECHATWINDOW,s),r.off("click",".origin-social-chatwindow-tab",c),r.off("click",".origin-social-chatwindow-tab-overflow-menu-item",l),r.off("click",".origin-social-chatwindow-tab-close",d),r.off("click",".origin-social-chatwindow-tab-overflow-menu-item-close",g),r.off("click",".origin-titlebar-subwindow-close",u),r.off("click",".origin-titlebar-subwindow-minimize",e.minimizeWindow),r.off("click",".origin-titlebar-subwindow-popout",e.popOutWindow),r.off("click",".origin-titlebar-subwindow-popin",e.unpopOutWindow),r.off("click",".origin-social-chatwindow-tab-overflow-tab",p),angular.element(document).off("click",m)}),Origin.events.on(Origin.events.CLIENT_SOCIAL_FOCUSONACTIVECHATWINDOW,s)}}}function Ca(e,t,i,n,r,o,a,s,c){"ngInject";function l(){var t=0,i=n.getConversations();for(var r in e.activeConversation&&e.activeConversation.id||(e.activeConversation=n.getConversationById(n.getActiveConversationId())),i)parseInt(r)!==parseInt(e.activeConversation.id)&&(t+=n.getConversationById(r)?n.getConversationById(r).unreadCount:0);e.overflowTabsUnreadCount=t,e.unreadCount=e.activeConversation.unreadCount,e.$digest()}function d(){l(),p.hide()}function g(e){e.removeClass("otkbadge-isnotifying"),t(function(){e.addClass("otkbadge-isnotifying")},0)}function u(){t(function(){var t;e.activeConversation=n.getConversationById(n.getActiveConversationId()),"ONE_ON_ONE"===e.activeConversation.state&&(t=e.activeConversation.participants[0],m&&m.detach(e),r.getRosterUser(t).then(function(i){i&&(m=s.create(i._presence).defaultTo({jid:t,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"activePresence"))})),l()})}var p,m,f=[];e.activeConversation={},e.unreadCount=0,e.overflowTabsUnreadCount=0,this.setElement=function(e){p=e},this.onTabOverflowMenuItemClick=function(e){var t=$(e).parents("[data-conversation-id]").attr("data-conversation-id");i.raiseConversation(t)},this.onCloseOverflowMenuItemClick=function(e){var t=$(e).parents("[data-conversation-id]").attr("data-conversation-id");n.closeConversationById(t)},e.additionalTabCount=function(){return e.getAdditionalTabIds().length},e.getAdditionalTabIds=function(){var e=[],t=(e=(e=e.concat(i.visibleTabIds())).concat(i.overflowTabIds())).indexOf(n.getActiveConversationId());return t>-1&&e.splice(t,1),e},e.getConversationById=function(e){return n.getConversationById(e)},c.listenForScopeAndWindowDestroy(e,function(){a.detachAll(f)}),f[f.length]=o.events.on("jssdkLogin",function(t){e.userLoggedIn=t}),f[f.length]=i.events.on("unminimizeChatWindow",d),f[f.length]=i.events.on("minimizeChatWindow",function(){l(),p.show()}),f[f.length]=i.events.on("popOutChatWindow",d),f[f.length]=i.events.on("unpopOutChatWindow",function(){i.isWindowMinimized()&&!i.isWindowPoppedOut()?p.show():p.hide()}),f[f.length]=n.events.on("addMessage",function(e){var t=$(".origin-social-chatwindow-area-minimized-button").find(".otkbadge"),i=$(".origin-social-chatwindow-area-minimized-tabselector").find(".otkbadge");l(),g(e===n.getActiveConversationId()?t:i)}),f[f.length]=n.events.on("activeConversationIdChanged",u),f[f.length]=r.events.on("xmppConnected",u),s.create(r.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection")}function Ta(e){"ngInject";return{restrict:"E",controller:Ca,scope:{},template:nj,link:function(t,i,n,r){t=t,n=n,r.setElement($(i)),$(i).find(".origin-social-chatwindow-area-minimized-button").on("click",function(){e.unminimizeWindow()}),$(i).on("click",".origin-social-chatwindow-tab-overflow-menu-item",function(e){r.onTabOverflowMenuItemClick(e.target)}),$(i).on("click",".origin-social-chatwindow-tab-overflow-menu-item-close",function(e){e.stopImmediatePropagation(),e.preventDefault(),r.onCloseOverflowMenuItemClick(e.target)}),$(i).on("click",".otkdropdown-trigger",function(e){$(i).find(".origin-social-chatwindow-area-minimized-tabselector .otkdropdown-wrap").toggleClass("otkdropdown-isvisible"),e.stopImmediatePropagation(),e.preventDefault()}),$(document).on("click",function(){$(i).find(".origin-social-chatwindow-area-minimized-tabselector .otkdropdown-wrap").removeClass("otkdropdown-isvisible")}),e.isWindowMinimized()&&!e.isWindowPoppedOut()?$(i).show():$(i).hide()}}}function Pa(e,t,i){"ngInject";function n(){e.listState="LOADED",e.$digest()}e.searchChatRoomsLoc=i.getLocalizedStr(e.searchChatroomsStr,"origin-social-hub-chatrooms-area","searchchatroomsstr"),e.chatRoomInvitationsLoc=i.getLocalizedStr(e.chatRoomInvitationsStr,"origin-social-hub-chatrooms-area","chatroominvitationsstr"),e.chatRoomsLoc=i.getLocalizedStr(e.chatRoomsStr,"origin-social-hub-chatrooms-area","chatroomsstr"),e.listState="LOADING",e.nameFilter="",this.setNameFilter=function(t){e.nameFilter=t,e.$digest()},t.getGroups().then(function(t){Object.keys(t).length?e.listState="LOADED":e.listState="NOROOMS",e.$digest()},function(){e.listState="ERROR",e.$digest()}),t.events.on("socialGroupListResults",n),e.$on("$destroy",function(){t.events.off("socialGroupListResults",n)})}function _a(e,t,i,n){"ngInject";var r="origin-social-hub-chatrooms-room";e.joinConversationsLoc=n.getLocalizedStr(e.joinConversationsStr,r,"joinconversationstr"),e.inviteFriendsToChatroomLoc=n.getLocalizedStr(e.inviteFriendsToChatroomStr,r,"invitefriendstochatroomstr"),e.editChatroomLoc=n.getLocalizedStr(e.editChatroomStr,r,"editchatroomstr"),e.viewChatroomMembersLoc=n.getLocalizedStr(e.viewChatroomMembersStr,r,"viewchatroommembersstr"),e.deleteChatroomLoc=n.getLocalizedStr(e.deleteChatroomStr,r,"deletechatroomstr"),this.joinRoom=function(e){e.length>0&&t.joinConversation(e)},this.acceptInvite=function(e){e.length>0&&i.acceptGroupInvite(e)},this.declineInvite=function(e){e.length>0&&i.declineGroupInvite(e)}}function Oa(e,t,i,n){"ngInject";function r(e){o(e)}function o(t){e.chatrooms=[],$.each(t,function(t,i){"INVITATIONS"===e.sectionName&&i.inviteGroup?e.chatrooms.push(i):"CHATROOMS"!==e.sectionName||i.inviteGroup||e.chatrooms.push(i)}),e.sectionLength=e.chatrooms.length,e.$digest()}e.chatrooms=[],e.filteredChatroomsArray=[];var a=this;i.getGroups().then(function(e){o(e)},function(){}),i.events.on("socialGroupListUpdated",r),e.$on("$destroy",function(){i.events.off("socialGroupListUpdated",r)}),e.$watch("nameFilter",function(){e.nameFilter.length?e.filteredChatroomsArray=t("filter")(e.chatrooms,{name:e.nameFilter}):e.filteredChatroomsArray=e.chatrooms,e.sectionLength=e.filteredChatroomsArray.length}),this.openSection=function(){e.$sectionElement.find(".origin-social-hub-section-downarrow").removeClass("origin-social-hub-section-downarrow-rotate"),e.$headerElement.addClass("header-visible"),e.$viewportElement.show()},this.closeSection=function(){e.$sectionElement.find(".origin-social-hub-section-downarrow").addClass("origin-social-hub-section-downarrow-rotate"),e.$headerElement.removeClass("header-visible"),e.$viewportElement.hide()},this.toggleSectionVisible=function(){e.$viewportElement.is(":hidden")?(a.openSection(),n.delete("origin-social-hub-section-CHATROOMSLIST-"+e.sectionName+"-closed-"+Origin.user.originId(),!0)):(a.closeSection(),n.set("origin-social-hub-section-CHATROOMSLIST-"+e.sectionName+"-closed-"+Origin.user.originId(),"true",!0)),e.$digest()}}function Ea(e){"ngInject";return{restrict:"E",controller:Oa,scope:{titleStr:"@titlestr",sectionName:"@section",nameFilter:"@filter"},template:sj,link:function(t,i,n,r){t=t,n=n,$(i).on("click",".origin-social-hub-section-header",function(){r.toggleSectionVisible()}),t.$sectionElement=$(i).find(".origin-social-hub-section"),t.$headerElement=$(i).find(".origin-social-hub-section-header"),t.$viewportElement=$(i).find(".origin-social-hub-section-viewport"),e.get("origin-social-hub-section-CHATROOMSLIST-"+t.filter+"-closed-"+Origin.user.originId(),!0)&&r.closeSection()}}}function Fa(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){var e=i.getRosterViewportHeight();!e&&dj&&(e=dj.height(),i.setRosterViewportHeight(e));var t=i.getFriendPanelHeight();t>0&&e>0&&i.setSectionViewportFriendCount(Math.floor(e/t))}function u(){g()}function p(){}function m(){Origin.xmpp.isConnected()&&i.getNumFriends().then(function(t){var i=e.rosterState;e.rosterState=t>0?"LOADED":"NOFRIENDS",i!==e.rosterState&&v(),g()})}var f,h=[],v=n.throttle(function(){t(function(){e.$digest()},0,!1)},2e3),b="origin-social-hub-roster-area";e.maxFilterLen=16,e.rosterCountDirty=!0,e.totalRosterLength=0,e.childSectionsRosterTotals=[],e.filterText="",e.searchFriendsLoc=n.getLocalizedStr(e.searchFriendsStr,b,"searchfriendsstr"),e.errorLoadingFriendsListCtaTitleLoc=n.getLocalizedStr(e.errorLoadingFriendsListCtaTitleStr,b,"errorloadingfriendslistctatitlestr"),e.errorLoadingFriendsListCtaDescLoc=n.getLocalizedStr(e.errorLoadingFriendsListCtaDescStr,b,"errorloadingfriendslistctadescstr"),e.timeoutLoc=n.getLocalizedStr(e.timeoutStr,b,"timeoutstr"),e.noFriendsCtaTitleLoc=n.getLocalizedStr(e.noFriendsCtaTitleStr,b,"nofriendsctatitlestr"),e.noFriendsCtaDescLoc=n.getLocalizedStr(e.noFriendsCtaDescStr,b,"nofriendsctadescstr"),e.noFriendsCtaButtonLoc=n.getLocalizedStr(e.noFriendsCtaButtonStr,b,"nofriendsctabuttonstr"),e.friendRequestsReceivedLoc=n.getLocalizedStr(e.friendRequestsReceivedStr,b,"friendrequestsreceivedstr"),e.pendingApprovalLoc=n.getLocalizedStr(e.pendingApprovalStr,b,"pendingapprovalstr"),e.favoritesLoc=n.getLocalizedStr(e.favoritesStr,b,"favoritesstr"),e.friendsLoc=n.getLocalizedStr(e.friendsStr,b,"friendsstr"),e.noFilteredFriendTitleLoc=n.getLocalizedStr(e.noFilteredFriendTitleStr,b,"nofilteredfriendtitlestr",{"%filtertext%":e.filterText}),e.noFilteredFriendBodyLoc=n.getLocalizedStr(e.noFilteredFriendBodyStr,b,"nofilteredfriendbodystr",{"%filtertext%":e.filterText}),e.noFilteredFriendsCtaButtonLoc=n.getLocalizedStr(e.noFriendsCtaButtonStr,b,"nofilteredfriendsctabuttonstr"),e.onlineLoc=n.getLocalizedStr(e.onlineStr,b,"onlinestr")||"Online",e.noFriendsYetTitleLoc=n.getLocalizedStr(e.noFriendsYetTitleStr,b,"nofriendsyettitlestr")||"You don't have any friends yet.",e.noFriendsYetDescLoc=n.getLocalizedStr(e.noFriendsYetDescStr,b,"nofriendsyetdescstr")||"You can search for friends on Origin using their Public ID, real name, or email address.",e.lookingForSomeoneElseLoc=n.getLocalizedStr(e.lookingForSomeoneElseStr,b,"lookingforsomeoneelsestr")||"Looking for someone else?",Origin.client.oig.supportsSearch()?(e.searchOnOriginLoc=n.getLocalizedStr(e.searchOnOriginStr,b,"searchonoriginstr")||"Search on Origin",e.noFriendsYetButtonLoc=n.getLocalizedStr(e.noFriendsYetButtonStr,b,"nofriendsyetbuttonstr")||"Search for Friends",e.searchAllOfOriginLoc=n.getLocalizedStr(e.searchAllOfOriginStr,b,"searchalloforiginstr")||"Search All of Origin"):(e.searchOnOriginLoc="",e.noFriendsYetButtonLoc="",e.searchAllOfOriginLoc=""),f=a.create(i.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection"),this.setViewportElement=function(e){dj=e,i.setRosterViewportHeight(dj.height())},h[h.length]=i.events.on("updateRosterViewportHeight",g),h[h.length]=i.events.on("updateFriendPanelHeight",g),h[h.length]=i.events.on("jssdkLogin",g),this.handleScroll=n.reverseThrottle(function(){i.updateRosterViewport()},100),this.handleWindowResize=n.reverseThrottle(function(){dj&&(i.setRosterViewportHeight(dj.height()),g())},100),this.setFriendsListFilter=function(e){i.setFriendsListFilter(e)},e.calculateTotalFilteredFriendCount=function(t,i){e.totalRosterLength-=e.childSectionsRosterTotals[t],e.totalRosterLength+=i,e.childSectionsRosterTotals[t]=i,e.rosterCountDirty=!1,0===e.totalRosterLength&&e.filterText.length>0&&(e.noFilteredFriendTitleLoc=n.getLocalizedStr(e.noFilteredFriendTitleStr,b,"nofilteredfriendtitlestr",{"%filtertext%":e.filterText}),e.noFilteredFriendBodyLoc=n.getLocalizedStr(e.noFilteredFriendBodyStr,b,"nofilteredfriendbodystr",{"%filtertext%":e.filterText})),e.$digest()},e.getNewSectionID=function(t){return e.childSectionsRosterTotals.push(t),e.totalRosterLength+=t,e.rosterCountDirty=!1,0===e.totalRosterLength&&e.filterText.length>0&&(e.noFilteredFriendTitleLoc=n.getLocalizedStr(e.noFilteredFriendTitleStr,b,"nofilteredfriendtitlestr",{"%filtertext%":e.filterText}),e.noFilteredFriendBodyLoc=n.getLocalizedStr(e.noFilteredFriendBodyStr,b,"nofilteredfriendbodystr",{"%filtertext%":e.filterText})),e.$digest(),e.childSectionsRosterTotals.length-1},e.showSectionTitle=function(t){return e.filterText.length&&e.childSectionsRosterTotals[t]>0&&!e.rosterCountDirty},h[h.length]=r.events.on("myauth:clientonlinestatechangeinitiated",function(t){e.$digest(),t&&t.isOnline&&i.getRoster("ALL").then(u,p)}),i.getRoster("ALL").then(u,p);var y=a.create(i.getRosterStatusWatch());y.attachToScope(e,"rosterLoadStatus"),h[h.length]=i.events.on("socialRosterUpdateALL",m),h[h.length]=i.events.on("socialRosterDeleteALL",m),this.getRoster=function(){i.getRoster("ALL").then(u,p)},this.searchForFriends=function(){s.findFriends()},this.doOriginSearchForFriends=function(){if(Origin.client.oig.IGOIsActive()){var t=decodeURI(e.filterText);d.openIGOSPA("SEARCH","searchString="+t+"&category=people")}else d.goToState("app.search",{searchString:decodeURI(e.filterText),category:"people"})},i.isRosterLoaded()&&u(),h[h.length]=i.events.on("updateFriendsListFilter",function(t){e.filterText=t,e.$digest()}),l.listenForScopeAndWindowDestroy(e,function(){c.detachAll(h),y&&y.detach(),f&&f.detach()})}function xa(e,t){"ngInject";return{restrict:"E",scope:{searchFriendsStr:"@searchfriendsstr",errorLoadingFriendsListCtaTitleStr:"@errorloadingfriendslistctatitlestr",errorLoadingFriendsListCtaDescStr:"@errorloadingfriendslistctadescstr",timeoutStr:"@timeoutstr",noFriendsCtaTitleStr:"@nofriendsctatitlestr",noFriendsCtaDescStr:"@nofriendsctadescstr",noFriendsCtaButtonStr:"@nofriendsctabuttonstr",friendRequestsReceivedStr:"@friendrequestsreceivedstr",pendingApprovalStr:"@pendingapprovalstr",favoritesStr:"@favoritesstr",friendsStr:"@friendsstr",noFilteredFriendTitleStr:"@nofilteredfriendtitlestr",noFilteredFriendBodyStr:"@nofilteredfriendbodystr",noFilteredFriendsCtaButtonStr:"@nofilteredfriendsctabuttonstr",searchOnOriginStr:"@searchonoriginstr",onlineStr:"@onlinestr",noFriendsYetTitleStr:"@nofriendsyettitlestr",noFriendsYetDescStr:"@nofriendsyetdescstr",noFriendsYetButtonStr:"@nofriendsyetbuttonstr",lookingForSomeoneElseStr:"@lookingforsomeoneelsestr",searchAllOfOriginStr:"@searchonoriginstr"},controller:Fa,template:lj,link:function(i,n,r,o){function a(){n.find(".origin-social-hub-roster-area-friends-filter-group-field > input").focus()}function s(){var e=angular.element(n).find(".origin-social-hub-roster-area-friends-filter-group-field > input").val();o.setFriendsListFilter(e)}function c(){o.setFriendsListFilter(""),angular.element(n).find(".origin-social-hub-roster-area-friends-filter-group-field > input").val("")}function l(){o.searchForFriends()}function d(e){return angular.element(this).scrollTop(angular.element(this).scrollTop()-e.originalEvent.wheelDeltaY),!1}angular.element(n).on("keyup",".origin-social-hub-roster-area-friends-filter-group-field > input",s),angular.element(n).on("click",".origin-social-hub-roster-area-friends-clear-filter",c),angular.element(".origin-social-hub-roster-area-viewport").scroll(o.handleScroll),e.addResizeEventHandler(i,o.handleWindowResize,800),o.setViewportElement(angular.element(".origin-social-hub-roster-area-viewport")),angular.element(n).on("click",".origin-social-hub-roster-area-friends-add-friends",l),angular.element(".origin-social-hub-roster-area-viewport").bind("mousewheel",d),angular.element(n).on("buttonClicked",".origin-social-hub-roster-area-list-nofriends origin-social-hub-cta",o.searchForFriends),angular.element(n).on("buttonClicked",".origin-social-hub-roster-area-list-filteredfriends-cta origin-social-hub-cta",o.doOriginSearchForFriends),angular.element(n).on("buttonClicked",".origin-social-hub-roster-area-list-friend-notfound origin-social-hub-cta",o.doOriginSearchForFriends),o.getRoster(),t.listenForScopeAndWindowDestroy(i,function(){Origin.events.off(Origin.events.CLIENT_SOCIAL_FOCUSONFRIENDSLIST,a),angular.element(".origin-social-hub-roster-area-viewport").unbind("mousewheel",d),angular.element(n).off("buttonClicked",".origin-social-hub-roster-area-list-nofriends origin-social-hub-cta",o.searchForFriends),angular.element(n).off("buttonClicked",".origin-social-hub-roster-area-list-filteredfriends-cta origin-social-hub-cta",o.doOriginSearchForFriends),angular.element(n).off("buttonClicked",".origin-social-hub-roster-area-list-friend-notfound origin-social-hub-cta",o.doOriginSearchForFriends),angular.element(n).off("click",".origin-social-hub-roster-area-friends-add-friends",l),angular.element(n).off("keyup",".origin-social-hub-roster-area-friends-filter-group-field > input",s),angular.element(n).off("click",".origin-social-hub-roster-area-friends-clear-filter",c)}),Origin.events.on(Origin.events.CLIENT_SOCIAL_FOCUSONFRIENDSLIST,a)}}}function La(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v){"ngInject";function b(){var t=_.get(e,["presence","groupActivity","groupId"],"");return t?Origin.xmpp.getUserPartyGuid().then(function(e){return e&&-1!==t.indexOf(e)}).catch(function(){return!1}):Promise.resolve(!1)}function y(){Origin.client.isEmbeddedBrowser()&&b().then(function(t){t?(e.joinGameState=vj,e.$digest()):e.joinGameState===vj&&(e.joinGameState=mj,e.$digest())})}function S(){var t=h.activeVoiceConversationId();return h.voiceCallObservable().data.isInVoice&&t===e.friend.nucleusId}function k(){e.inVoip=S(),e.calling=h.voiceCallObservable().data.isCalling,e.isInVoice=h.voiceCallObservable().data.isInVoice,e.isLocalMuted=h.voiceCallObservable().data.isLocalMuted}function I(){e.sectionController.isFriendVisible(e.index,pj)&&(void 0!==e.friend.avatarImgSrc&&e.friend.avatarImgSrc!==s.getImagePath("social//avatar_placeholder.png")||o.getAvatar(e.friend.nucleusId,Origin.defines.avatarSizes.LARGE).then(function(t){e.friend.avatarImgSrc=t,O()},function(){}).catch(function(e){p.error("OriginSocialHubRosterFriendCtrl: UserDataFactory.getAvatar failed",e)}),void 0!==e.friend.lastName&&null!==e.friend.lastName&&0===e.friend.lastName.length&&void 0!==e.friend.firstName&&null!==e.friend.firstName&&0===e.friend.firstName.length&&o.getUserRealName(e.friend.nucleusId))}e.contextmenuCallbacks={},e.isVoiceSupported=Origin.voice.supported(),e.isContextmenuVisible=!1,e.playingJoinableGame=!1;var w=this,C=null,T="origin-social-hub-roster-friend",P={unableToJoinText:l.getLocalizedStr(e.joinGameUnableText,T,"join-game-unable-text"),notOwnedText:l.getLocalizedStr(e.joinGameNotOwnedText,T,"join-game-not-owned-text"),viewInStoreText:l.getLocalizedStr(e.joinGameViewInStoreButtonText,T,"join-game-view-in-store-button-text"),closeText:l.getLocalizedStr(e.joinGameCloseButtonText,T,"join-game-close-button-text"),notInstalledText:l.getLocalizedStr(e.joinGameNotInstalledText,T,"join-game-not-installed-text"),downloadText:l.getLocalizedStr(e.joinGameDownloadButtonText,T,"join-game-download-button-text")};e.onlineLoc=l.getLocalizedStr(e.onlineStr,T,"onlinestr"),e.awayLoc=l.getLocalizedStr(e.awayStr,T,"awaystr"),e.offlineLoc=l.getLocalizedStr(e.offlineStr,T,"offlinestr"),e.broadcastingLoc=l.getLocalizedStr(e.broadcasting,T,"broadcastingstr"),e.joinGameLoc=l.getLocalizedStr(e.joinGameLoc,T,"joingamecta"),e.joinGroupLoc=l.getLocalizedStr(e.joinGroupLoc,T,"joingroupcta"),e.joinGameAndGroupLoc=l.getLocalizedStr(e.joinGameAndGroupLoc,T,"joingameandgroupcta"),e.playingInGroupLoc=l.getLocalizedStr(e.playingInGroupLoc,T,"playingingroup"),e.playingInGroupWithNameLoc=l.getLocalizedStr(e.playingInGroupWithNameLoc,T,"playingingroupwithname"),e.sendMessageLoc=l.getLocalizedStr(e.sendMessageLoc,T,"sendmessagestr"),e.startVoiceChatLoc=l.getLocalizedStr(e.startVoiceChatLoc,T,"startvoicechatstr"),e.viewProfileLoc=l.getLocalizedStr(e.viewProfileLoc,T,"viewprofilestr"),e.watchBroadcastLoc=l.getLocalizedStr(e.watchBroadcastLoc,T,"watchbroadcaststr"),e.inviteToGameLoc=l.getLocalizedStr(e.inviteToGameLoc,T,"invitetogamestr"),e.unfriendAndBlockLoc=l.getLocalizedStr(e.unfriendAndBlockLoc,T,"unfriendandblockstr"),e.unfriendLoc=l.getLocalizedStr(e.unfriendLoc,T,"unfriendstr"),e.playingVerbLoc=l.getLocalizedStr(e.playingVerbStr,T,"playingverbstr")||"Playing",e.broadcastingVerbLoc=l.getLocalizedStr(e.broadcastingVerbStr,T,"broadcastingverbstr")||"Broadcasting";var O=l.throttle(function(){i(function(){e.$digest()},0,!1)},2e3),E=[];e.joinGameState=mj,r.getRosterUser(e.friend.nucleusId).then(function(t){t&&f.create(t._presence).defaultTo({jid:e.friend.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence").attachToScope(e,y)}),r.getRosterUser(Origin.user.userPid()).then(function(t){if(t&&(f.create(t._presence).defaultTo({jid:Origin.user.userPid(),presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"selfPresence"),Origin.client.isEmbeddedBrowser())){var i=e.selfPresence.groupActivity&&e.selfPresence.groupActivity.groupId?e.selfPresence.groupActivity.groupId:"";i.length&&Origin.xmpp.getUserPartyGuid().then(function(t){var n=t;-1!==i.indexOf(n)&&(e.joinGameState=vj,e.$digest())})}}),e.inVoip=S(),h.voiceCallObservable().addObserver(k),this.setElement=function(e){C=e},E[E.length]=r.events.on("updateFriendsDirective"+e.friend.nucleusId,I),E[E.length]=o.events.on("socialFriendsFullNameUpdated:"+e.friend.nucleusId,function(t){e.friend.firstName=t.firstName?t.firstName:e.friend.firstName,e.friend.lastName=t.lastName?t.lastName:e.friend.lastName,e.$digest()}),E[E.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSTARTED,function(t){var i=t.NUCLEUS_ID,n=e.friend.nucleusId;i.toString()===n.toString()&&(e.joinGameState=fj,e.$digest())}),E[E.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSUCCESS,function(t){var i=t.NUCLEUS_ID,n=e.friend.nucleusId;i.toString()===n.toString()&&(e.joinGameState=hj,e.$digest(),setTimeout(function(){b().then(function(t){e.joinGameState=t?vj:mj,e.$digest()})},3e3))}),E[E.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWFAILED,function(t){var i=t.NUCLEUS_ID,n=e.friend.nucleusId;i.toString()===n.toString()&&(e.joinGameState=mj,e.$digest())}),E[E.length]=Origin.events.on(Origin.events.XMPP_LEAVINGPARTY,function(){e.joinGameState=mj,e.$digest()}),this.openConversation=function(){a.openConversation(e.friend.nucleusId)},this.setPanelHeight=function(){pj=C.outerHeight(),r.setFriendPanelHeight(pj)},this.initialUpdate=function(){I()},e.sectionController&&I(),e.trustAsHtml=function(e){return n.trustAsHtml(e)},e.contextmenuCallbacks.sendMessage=function(){a.openConversation(e.friend.nucleusId),e.isContextmenuVisible=!1},e.contextmenuCallbacks.inviteToChatroom=function(i){t.alert('This is the "invite to chatroom" button. I invite you to '+i.title+" chatoomroom. Make haste!"),e.isContextmenuVisible=!1},e.contextmenuCallbacks.startVoiceChat=function(){e.inVoip=S(),e.friend.nucleusId&&(e.inVoip||0!==h.activeVoiceConversationId()?h.activeVoiceConversationId()!==parseInt(e.friend.nucleusId,10)&&a.showInProgressCallBanner(e.friend.nucleusId):(a.openConversation(e.friend.nucleusId),Origin.voice.joinVoice(e.friend.nucleusId,[e.friend.nucleusId]))),e.isContextmenuVisible=!1},e.contextmenuCallbacks.viewProfile=function(){Origin.client.oig.IGOIsActive()?d.openIGOSPA("PROFILE",e.friend.nucleusId):d.goUserProfile(e.friend.nucleusId),e.isContextmenuVisible=!1},e.contextmenuCallbacks.joinGame=function(){var t=e.friend.nucleusId,i=e.friend.presence.gameActivity.productId,n=e.friend.presence.gameActivity.multiplayerId,r=e.friend.presence.gameActivity.title;m.joinFriendsGame(t,i,n,r,P),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIENDS_LIST_JOIN_GAME),e.isContextmenuVisible=!1},e.contextmenuCallbacks.watchBroadcast=function(){var t=e.friend.presence.gameActivity.twitchPresence;t&&d.asyncOpenUrl(t),e.isContextmenuVisible=!1},e.contextmenuCallbacks.inviteToGame=function(){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_GAME_INVITE_SENT,{label:Origin.client.oig.IGOIsActive()?"OIG Friends List":"Origin Friends List"}),Origin.xmpp.inviteToGame(e.friend.nucleusId),e.isContextmenuVisible=!1},e.removeFriendAndBlockDlgStrings={},e.removeFriendAndBlockDlgStrings.title=l.getLocalizedStr(e.unfriendandblocktitle,T,"unfriendandblocktitle"),e.removeFriendAndBlockDlgStrings.description=l.getLocalizedStr(e.unfriendandblockdescription,T,"unfriendandblockdescription"),e.removeFriendAndBlockDlgStrings.description2=l.getLocalizedStr(e.unfriendandblockdescription2,T,"unfriendandblockdescription_2"),e.removeFriendAndBlockDlgStrings.description3=l.getLocalizedStr(e.unfriendandblockdescription3,T,"unfriendandblockdescription_3"),e.removeFriendAndBlockDlgStrings.acceptText=l.getLocalizedStr(e.unfriendandblockaccept,T,"unfriendandblockaccept"),e.removeFriendAndBlockDlgStrings.rejectText=l.getLocalizedStr(e.unfriendandblockreject,T,"unfriendandblockreject"),this.handleRemoveFriendAndBlock=function(t){t.accepted&&r.removeFriendAndBlock(e.friend.nucleusId)},e.contextmenuCallbacks.removeFriendAndBlock=function(){e.rosterContextmenuVisible=!1;var t="<b>"+e.removeFriendAndBlockDlgStrings.description+"</b><br><br>"+e.removeFriendAndBlockDlgStrings.description2+"<br><br>"+e.removeFriendAndBlockDlgStrings.description3;t=t.replace(/%username%/g,e.friend.originId),c.openPrompt({id:"social-hub-roster-removeFriendAndBlock-id"+e.friend.nucleusId,name:"social-hub-roster-removeFriendAndBlock",title:e.removeFriendAndBlockDlgStrings.title,description:t,acceptText:e.removeFriendAndBlockDlgStrings.acceptText,acceptEnabled:!0,rejectText:e.removeFriendAndBlockDlgStrings.rejectText,defaultBtn:"yes",callback:w.handleRemoveFriendAndBlock}),e.isContextmenuVisible=!1},this.handleRemoveFriend=function(t){t.accepted&&r.removeFriend(e.friend.nucleusId)},e.removeFriendDlgStrings={},e.removeFriendDlgStrings.title=l.getLocalizedStr(e.unfriendusertitle,T,"unfriendusertitle"),e.removeFriendDlgStrings.description=l.getLocalizedStr(e.unfrienduserdescription,T,"unfrienduserdescription"),e.removeFriendDlgStrings.acceptText=l.getLocalizedStr(e.unfrienduseraccept,T,"unfrienduseraccept"),e.removeFriendDlgStrings.rejectText=l.getLocalizedStr(e.unfrienduserreject,T,"unfrienduserreject"),e.contextmenuCallbacks.removeFriend=function(){c.openPrompt({id:"social-hub-roster-removeFriend-id-"+e.friend.nucleusId,name:"social-hub-roster-removeFriend",title:e.removeFriendDlgStrings.title,description:e.removeFriendDlgStrings.description.replace("%username%",e.friend.originId),acceptText:e.removeFriendDlgStrings.acceptText,acceptEnabled:!0,rejectText:e.removeFriendDlgStrings.rejectText,defaultBtn:"yes",callback:w.handleRemoveFriend})},e.onMouseEnter=function(){e.rosterItem.addClass("hover")},e.onMouseLeave=function(){e.rosterItem.removeClass("hover")},E[E.length]=u.events.on("myauth:clientonlinestatechangeinitiated",function(e){e&&!e.isOnline&&(c.close("social-hub-roster-removeFriend-id"),c.close("social-hub-roster-removeFriendAndBlock-id"))}),v.listenForScopeAndWindowDestroy(e,function(){g.detachAll(E),h.voiceCallObservable().removeObserver(k)})}function Aa(e,t,i,n){"ngInject";return{restrict:"E",controller:La,require:["^originSocialHubRosterSection","originSocialHubRosterFriend"],scope:{friend:"=",index:"=",unfriendusertitle:"@",unfrienduserdescription:"@",unfrienduseraccept:"@",unfrienduserreject:"@",unfriendandblocktitle:"@",unfriendandblockdescription:"@",unfriendandblockdescription_2:"@",unfriendandblockdescription_3:"@",unfriendandblockaccept:"@",unfriendandblockreject:"@",onlineStr:"@onlinestr",offlineStr:"@offlinestr",awayStr:"@awaystr",broadcasting:"@broadcastingstr",joinGameLoc:"@joingamecta",joinGroupLoc:"@joingroupcta",joinGameAndGroupLoc:"@joingameandgroupcta",playingInGroupLoc:"@playingingroup",playingInGroupWithNameLoc:"@playingingroupwithname",sendMessageLoc:"@sendmessagestr",startVoiceChatLoc:"@startvoicechatstr",viewProfileLoc:"@viewprofilestr",watchBroadcastLoc:"@watchbroadcaststr",inviteToGameLoc:"@invitetogamestr",unfriendAndBlockLoc:"@unfriendandblockstr",unfriendLoc:"@unfriendstr",joinGameUnableText:"@",joinGameNotOwnedText:"@",joinGameViewInStoreButtonText:"@",joinGameCloseButtonText:"@",joinGameNotInstalledText:"@",joinGameDownloadButtonText:"@",playingVerbStr:"@playingverbstr",broadcastingVerbStr:"@broadcastingverbstr"},template:uj,link:function(r,o,a,s){function c(){k.openConversation()}function l(e){angular.element(e.target).hasClass("origin-social-hub-roster-contextmenu-otkicon-more")&&!r.isContextmenuVisible?m():(f(),angular.element(o).focus())}function d(e){e.preventDefault(),m(),angular.element(o).focus()}function g(e){e.stopPropagation(),m()}function u(e){e.stopPropagation(),f(),angular.element(o).focus()}function p(){if(angular.element(document.activeElement).find("[keytarget]"))return c(),!1}function m(){var e=t.getRosterViewportHeight(),i=r.sectionController.friendYPosition(r.index,t.getFriendPanelHeight());r.displayContextmenuUp=i>e/2,r.isContextmenuVisible=!0,r.$digest()}function f(){r.isContextmenuVisible&&(r.isContextmenuVisible=!1,r.$digest())}function h(){r.contextmenuCallbacks.startVoiceChat()}function v(e){var t=e.shiftKey,n=e.ctrlKey;return t&&n?i.mapEvents(e,{enter:h}):i.mapEvents(e,{right:g,left:u,enter:p})}function b(){r.contextmenuCallbacks.watchBroadcast()}function y(){r.contextmenuCallbacks.joinGame()}function S(){setTimeout(function(){angular.element(o).has(document.activeElement).length||f()},0)}r.sectionController=s[0];var k=s[1];0===pj&&(k.setElement(angular.element(o).find(".origin-social-hub-roster-friend")),k.setPanelHeight()),r.rosterItem=angular.element(o).find(".origin-social-hub-roster-item"),angular.element(o).on("dblclick",c),angular.element(o).on("click",l),angular.element(o).bind("contextmenu",d),angular.element(o).on("keyup",v),angular.element(o).on("click",".origin-social-hub-roster-friend-watchbroadcast-icon",b),angular.element(o).on("click",".origin-social-hub-roster-friend-joingame-icon",y),angular.element(o).on("focusout",S),n.listenForScopeAndWindowDestroy(r,function(){angular.element(o).off("dblclick",c),angular.element(o).off("click",l),angular.element(o).unbind("contextmenu",d),angular.element(o).off("keyup",v),angular.element(o).off("click",".origin-social-hub-roster-friend-watchbroadcast-icon",b),angular.element(o).off("click",".origin-social-hub-roster-friend-joingame-icon",y),angular.element(o).off("focusout",S)}),void 0===r.friend.avatarImgSrc&&(r.friend.avatarImgSrc=e.getImagePath("social//avatar_placeholder.png")),k.initialUpdate()}}}function Da(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";function h(t){if("BLOCKED"===t.relationship){var i={accepted:!0};t.requestSent?(I.onCancelRequestClick(i),r.deleteFromSectionRoster("OUTGOING",e.friend.nucleusId)):(I.onDeclineButtonClick(i),r.deleteFromSectionRoster("INCOMING",e.friend.nucleusId))}}var v="origin-social-hub-roster-pendingitem";e.acceptLoc=a.getLocalizedStr(e.acceptStr,v,"acceptstr"),e.declineLoc=a.getLocalizedStr(e.declineStr,v,"declinestr"),e.cancelLoc=a.getLocalizedStr(e.cancelStr,v,"cancelstr"),e.ignoreLoc=a.getLocalizedStr(e.ignoreStr,v,"ignorestr")||"Ignore",e.isContextmenuVisible=!1,e.contextmenuCallbacks={},e.cancelandblocktitleLoc=a.getLocalizedStr(e.cancelandblocktitle,v,"cancelandblocktitle"),e.cancelandblockdescriptionLoc=a.getLocalizedStr(e.cancelandblockdescription,v,"cancelandblockdescription"),e.cancelandblockdescription2Loc=a.getLocalizedStr(e.cancelandblockdescription2,v,"cancelandblockdescription2"),e.changeminddescriptionLoc=a.getLocalizedStr(e.changeminddescription,v,"changeminddescription"),e.cancelandblockacceptLoc=a.getLocalizedStr(e.cancelandblockaccept,v,"cancelandblockaccept"),e.cancelandblockdeclineLoc=a.getLocalizedStr(e.cancelandblockdecline,v,"cancelandblockdecline"),e.ignoreandblocktitleLoc=a.getLocalizedStr(e.ignoreandblocktitle,v,"ignoreandblocktitle"),e.ignoreandblockdescriptionLoc=a.getLocalizedStr(e.ignoreandblockdescription,v,"ignoreandblockdescription"),e.ignoreandblockdescription2Loc=a.getLocalizedStr(e.ignoreandblockdescription2,v,"ignoreandblockdescription2"),e.ignoreandblockacceptLoc=a.getLocalizedStr(e.ignoreandblockaccept,v,"ignoreandblockaccept"),e.ignoreandblockdeclineLoc=a.getLocalizedStr(e.ignoreandblockdecline,v,"ignoreandblockdecline"),e.errorfriendnotaddedtitleLoc=a.getLocalizedStr(e.errorfriendnotaddedtitle,v,"errorfriendnotaddedtitle"),e.errorfriendnotaddeddescriptionLoc=a.getLocalizedStr(e.errorfriendnotaddeddescription,v,"errorfriendnotaddeddescription"),e.errorfriendnotaddedacceptLoc=a.getLocalizedStr(e.errorfriendnotaddedaccept,v,"errorfriendnotaddedaccept"),e.acceptfriendrequest=a.getLocalizedStr(e.acceptfriendrequest,v,"acceptfriendrequest"),e.ignorefriendrequest=a.getLocalizedStr(e.ignorefriendrequest,v,"ignorefriendrequest"),e.cancelfriendrequest=a.getLocalizedStr(e.cancelfriendrequest,v,"cancelfriendrequest"),e.viewprofile=a.getLocalizedStr(e.viewprofile,v,"viewprofile"),e.cancelfriendrequestandblock=a.getLocalizedStr(e.cancelfriendrequestandblock,v,"cancelfriendrequestandblock"),e.ignorefriendrequestandblock=a.getLocalizedStr(e.ignorefriendrequestandblock,v,"ignorefriendrequestandblock");var b,y,S,k=[],I=this;this.setElements=function(e,t){b=e,y=t},r.isBlocked(e.friend.nucleusId).then(function(t){var i;t&&(e.friend.subscription.data.relationship="BLOCKED"),i=e.friend,m.create(i.subscription).defaultTo({state:"NONE",requestSent:!1,relationship:"NON_FRIEND"}).attachToScope(e,h)}),this.onCancelRequestClick=function(t){i(function(){y.slideUp(300,function(){r.cancelPendingFriendRequest(e.friend.nucleusId),angular.element(t).remove()})},0),r.updateRosterViewport()},this.onDeclineButtonClick=function(t){y.slideUp(300,function(){r.friendRequestReject(e.friend.nucleusId),angular.element(t).remove()}),r.updateRosterViewport()},this.setPanelHeight=function(){(Sj=b.outerHeight())>0&&r.setFriendPanelHeight(Sj)},e.contextmenuCallbacks.acceptRequest=function(t){e.isContextmenuVisible=!1,b.find(".origin-social-hub-roster-pendingitem-accept-icon").trigger("click"),n.cancelEvent(t)},e.contextmenuCallbacks.ignoreRequest=function(t){e.isContextmenuVisible=!1,b.find(".origin-social-hub-roster-pendingitem-decline-icon").trigger("click"),n.cancelEvent(t)},e.contextmenuCallbacks.cancelRequest=function(t){e.isContextmenuVisible=!1,b.find(".origin-social-hub-roster-pendingitem-cancel-icon").trigger("click"),n.cancelEvent(t)},e.contextmenuCallbacks.viewProfile=function(t){Origin.client.oig.IGOIsActive()?d.openIGOSPA("PROFILE",e.friend.nucleusId):d.goUserProfile(e.friend.nucleusId),e.isContextmenuVisible=!1,n.cancelEvent(t)},this.handleErrorDialog=function(e){c.events.off("dialog:hide",I.handleErrorDialog),e.accepted&&(u.unminimizeWindow(),u.focusWindow())},this.handleIgnoreAndBlock=function(t){c.events.off("dialog:hide",I.handleIgnoreAndBlock),t.accepted&&r.ignoreAndBlockUser(e.friend.nucleusId)},this.handleCancelAndBlock=function(t){c.events.off("dialog:hide",I.handleCancelAndBlock),t.accepted&&r.cancelAndBlockUser(e.friend.nucleusId)},e.contextmenuCallbacks.cancelAndBlockRequest=function(t){e.isContextmenuVisible=!1;var i="<b>"+e.cancelandblockdescriptionLoc+"</b><br><br>"+e.cancelandblockdescription2Loc+"<br><br>"+e.changeminddescriptionLoc;i=i.replace(/%username%/g,e.friend.originId),n.cancelEvent(t),s.openPrompt({id:"social-hub-roster-cancelRequestAndBlock-id",name:"social-hub-roster-cancelRequestAndBlock",title:e.cancelandblocktitleLoc,description:i,acceptText:e.cancelandblockacceptLoc,acceptEnabled:!0,rejectText:e.cancelandblockdeclineLoc,defaultBtn:"yes",callback:I.handleCancelAndBlock})},e.contextmenuCallbacks.blockPendingRequestor=function(t){e.isContextmenuVisible=!1;var i="<b>"+e.ignoreandblockdescriptionLoc+"</b><br><br>"+e.ignoreandblockdescription2Loc+"<br><br>"+e.changeminddescriptionLoc;i=i.replace(/%username%/g,e.friend.originId),n.cancelEvent(t),s.openPrompt({id:"social-hub-roster-ignoreRequestAndBlock-id",name:"social-hub-roster-ignoreRequestAndBlock",title:e.ignoreandblocktitleLoc,description:i,acceptText:e.ignoreandblockacceptLoc,acceptEnabled:!0,rejectText:e.ignoreandblockdeclineLoc,defaultBtn:"yes",callback:I.handleIgnoreAndBlock})},e.openContextmenu=function(){e.isContextmenuVisible=!0,e.$digest()},e.closeContextmenu=function(){e.isContextmenuVisible=!1,e.$digest()},k[k.length]=l.events.on("myauth:clientonlinestatechangeinitiated",function(e){e&&!e.isOnline&&(s.close("social-hub-roster-cancelRequestAndBlock-id"),s.close("social-hub-roster-ignoreRequestAndBlock-id"))}),k[k.length]=o.events.on("socialFriendsFullNameUpdated:"+e.friend.nucleusId,function(t){e.friend.originId=t.EAID,e.friend.firstName=t.firstName,e.friend.lastName=t.lastName,e.$digest()}),o.getUserRealName(e.friend.nucleusId),S=e.friend.nucleusId,o.getAvatar(S,Origin.defines.avatarSizes.SMALL).then(function(t){e.friend.avatarImgSrc=t,e.$digest()},function(){}).catch(function(e){p.error("OriginSocialHubRosterFriendCtrl: UserDataFactory.getAvatar failed",e)}),f.listenForScopeAndWindowDestroy(e,function(){g.detachAll(k)})}function Ra(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",controller:Da,require:["originSocialHubRosterPendingitem","^originSocialHubRosterSection"],scope:{friend:"=",acceptStr:"@acceptstr",declineStr:"@declinestr",cancelStr:"@cancelstr",ignoreStr:"@ignorestr",cancelandblocktitle:"@",cancelandblockdescription:"@",cancelandblockdescription2:"@",changeminddescription:"@",cancelandblockaccept:"@",cancelandblockdecline:"@",ignoreandblocktitle:"@",ignoreandblockdescription:"@",ignoreandblockdescription2:"@",ignoreandblockaccept:"@",ignoreandblockdecline:"@",errorfriendnotaddeddescription:"@",errorfriendnotaddedaccept:"@",errorfriendnotaddedtitle:"@",acceptfriendrequest:"@",ignorefriendrequest:"@",cancelfriendrequest:"@",viewprofile:"@",cancelfriendrequestandblock:"@",ignorefriendrequestandblock:"@"},template:yj,link:function(s,c,l,d){function g(){var e=angular.element(this);t.friendRequestAccept(s.friend.nucleusId).then(function(){var t=e.closest(".origin-social-hub-roster-pendingitem-icon"),i=e.closest(".origin-social-hub-roster-pendingitem"),r=e.closest(".origin-social-hub-roster-pendingitem-wrap");i.addClass("origin-social-hub-roster-pendingitem-accepted"),t.addClass("origin-social-hub-roster-pendingitem-accept-icon-accepted"),i.children().not(".origin-social-hub-roster-pendingitem-accept-icon-wrap").fadeOut(),n(function(){r.slideUp(300,function(){w.deleteFromRoster(s.friend.nucleusId)})},500);var a=o.getNext(C);angular.element(a).focus()},function(){i.openPrompt({id:"social-hub-roster-errorFriendNotAdded-id",name:"social-hub-roster-errorFriendNotAdded",title:s.errorfriendnotaddedtitleLoc,description:s.errorfriendnotaddeddescriptionLoc,acceptText:s.errorfriendnotaddedacceptLoc,acceptEnabled:!0,rejectText:s.cancelLoc,defaultBtn:"yes",callback:I.handleErrorDialog})})}function u(){var e=o.getNext(C);I.onDeclineButtonClick(c),angular.element(e).focus()}function p(){var e=o.getNext(C);I.onCancelRequestClick(c),angular.element(e).focus()}function m(e){e.stopPropagation(),s.openContextmenu()}function f(e){e.stopPropagation(),s.closeContextmenu(),C.focus()}function h(e){e.stopPropagation(),g()}function v(e){s.friend.subReqSent?p():u(),e.stopPropagation()}function b(e){e.preventDefault(),s.openContextmenu(),C.focus()}function y(){setTimeout(function(){C.has(document.activeElement).length||s.closeContextmenu()},0)}function S(e){return r.mapEvents(e,{right:m,left:f,enter:h,escape:v})}function k(e){angular.element(e.target).hasClass("origin-social-hub-roster-contextmenu-otkicon-more")&&!s.isContextmenuVisible?s.openContextmenu():(s.closeContextmenu(),C.focus())}var I=d[0],w=d[1],C=angular.element(c).find(".origin-social-hub-roster-pendingitem"),T=C.closest(".origin-social-hub-roster-pendingitem-wrap");I.setElements(C,T),0===Sj&&I.setPanelHeight(),void 0===s.friend.avatarImgSrc&&(s.friend.avatarImgSrc=e.getImagePath("social//avatar_placeholder.png")),C.on("click",k),C.on("focusout",y),C.on("keyup",S),C.bind("contextmenu",b),C.on("click",".origin-social-hub-roster-pendingitem-accept-icon",g),C.on("click",".origin-social-hub-roster-pendingitem-decline-icon",u),C.on("click",".origin-social-hub-roster-pendingitem-cancel-icon",p),a.listenForScopeAndWindowDestroy(s,function(){C.off("click",k),C.off("focusout",y),C.unbind("contextmenu",b),C.off("keyup",S),C.off("click",".origin-social-hub-roster-pendingitem-accept-icon",g),C.off("click",".origin-social-hub-roster-pendingitem-decline-icon",u),C.off("click",".origin-social-hub-roster-pendingitem-cancel-icon",p)})}}}function $a(e,t,i,n,r,o,a,s){"ngInject";function c(){void 0!==e.headerHeight&&0!==e.headerHeight||!e.$headerElement.height()||(e.headerHeight=e.$headerElement.outerHeight())}function l(e){return!!e.presence&&"UNAVAILABLE"!==e.presence.presenceType&&"ONLINE"===e.presence.show}function d(e){return!!e.presence&&"UNAVAILABLE"!==e.presence.presenceType&&"AWAY"===e.presence.show}function g(e){return!!e.presence&&"ONLINE"===e.presence.show&&!!e.presence.gameActivity&&void 0!==e.presence.gameActivity.title&&e.presence.gameActivity.title.length}function u(e){return g(e)&&!!e.presence&&!!e.presence.gameActivity&&!!e.presence.gameActivity.joinable}function p(e){return g(e)&&!!e.presence&&!!e.presence.gameActivity&&!!e.presence.gameActivity.twitchPresence&&e.presence.gameActivity.twitchPresence.length}function m(e,t){var i=r.compareOriginId(e,t);return p(e)&&p(t)?u(e)&&u(t)||(u(e)?i=-1:u(t)&&(i=1)):p(e)?i=-1:p(t)?i=1:g(e)&&g(t)?u(e)&&u(t)||(u(e)?i=-1:u(t)&&(i=1)):g(e)?i=-1:g(t)?i=1:l(e)&&l(t)||(l(e)?i=-1:l(t)?i=1:d(e)&&d(t)||(d(e)?i=-1:d(t)&&(i=1))),i}function f(){-1===e.sectionID?e.sectionID=e.$parent.getNewSectionID(e.rosterLength):e.$parent.calculateTotalFilteredFriendCount(e.sectionID,e.rosterLength)}function h(){e.filterText.length?e.filteredRosterArray=t("filter")(e.rosterArray,{originId:e.filterText}):e.filteredRosterArray=e.rosterArray,e.rosterLength=e.filteredRosterArray.length}function v(t){e.filterText=t,h(),e.filterText.length?(e.dataIsFiltered=!0,I.openSection()):(e.dataIsFiltered=!1,a.get("origin-social-hub-section-FRIENDSLIST-"+e.filter+"-closed-"+Origin.user.originId(),null,!0)&&I.closeSection()),n.updateRosterViewport(),f()}function b(){var t=e.$sectionElement.find(".origin-social-hub-section-viewport");if(t.length>0&&t.is(":hidden"))return e.topPadding=0,void(e.bottomPadding=0);e.limit=3*n.getSectionViewportFriendCount();var i=n.getFriendPanelHeight();e.topPadding=0,e.rosterLength>0&&(e.topPadding=e.overflowStart*i,e.topPadding+=e.overflowStart?e.headerHeight:0),e.bottomPadding=Math.max(e.rosterLength-e.limit-e.overflowStart,0)*i}function y(t){if(void 0!==t.originId&&t.originId.length>0){var i=function(e,t,i,n,r){var o,a;for(void 0===n&&(n=0),void 0===r&&(r=e.length-1);n<=r;)if((a=+i(e[o=n+(r-n>>1)],t))<0)n=o+1;else{if(!(a>0))return{found:!0,index:o};r=o-1}return{found:!1,index:n}}(e.rosterArray,t,m),n=i.found?1:0;e.rosterArray.splice(i.index,n,t),e.roster[t.nucleusId]=t,h(),i.index<=e.limit&&w(),c(),b(),f()}}function S(t){$.each(e.rosterArray,function(i,n){if(n.nucleusId===t)return e.rosterArray.splice(i,1),!1}),h(),delete e.roster[t],f(),c(),b(),w()}function k(){e.roster={},e.rosterArray=[],e.filteredRosterArray=[],e.rosterLength=e.rosterArray.length,e.topPadding=0,e.bottomPadding=0,w()}e.roster={},e.rosterArray=[],e.filteredRosterArray=[],e.rosterLength=0,e.sectionID=-1,e.start=0,e.overflowStart=0,e.filterText="",e.limit=3*n.getSectionViewportFriendCount(),e.bottomPadding=0,e.topPadding=0,e.onlineCount=0,e.dataIsFiltered=!1;var I=this;e.showTitle=function(){var t=_.get(e,["$parent","showSectionTitle"]);return!!t&&t(e.sectionID)},n.events.on("updateFriendsListFilter",v);var w=r.throttle(function(){i(function(){e.$digest()},0,!1)},1e3);this.deleteFromRoster=function(e){S(e)},n.events.on("socialRosterUpdate"+e.filter,y),n.events.on("socialRosterDelete"+e.filter,S),n.events.on("socialRosterClear"+e.filter,function(){e.rosterArray=[],e.filteredRosterArray=[],e.rosterLength=0,e.roster={},c(),b(),w()}),this.friendYPosition=function(t,i){var n=0,r=e.$sectionElement.get(0),o=r?r.offsetParent:null;if(o){var a=r.getBoundingClientRect(),s=o.getBoundingClientRect();n=a.top-s.top+t*i}return n},this.isFriendVisible=function(e,t){var i=n.getRosterViewportHeight(),r=this.friendYPosition(e,t);return r>0-t&&r<=i};var C=r.dropThrottle(function(){e.start=0,e.overflowStart=0;var t=e.$sectionElement.get(0),r=t?t.offsetParent:null;if(r){var o=n.getSectionViewportFriendCount();e.limit=3*o;var a=t.getBoundingClientRect(),s=r.getBoundingClientRect(),l=a.top-s.top,d=n.getFriendPanelHeight();if(c(),e.rosterLength>0&&l+e.headerHeight<0){var g=Math.abs(l+e.headerHeight);g>d&&(e.start=Math.min(Math.floor(g/d),e.rosterLength),e.start>o?e.overflowStart=Math.max(e.start-o,0):e.overflowStart=0)}for(var u=0;u<e.limit&&e.filteredRosterArray.length>e.start+u;)n.updateFriendDirective(e.filteredRosterArray[e.start+u].nucleusId),u++;b()}i(function(){e.$digest()},0,!1)},100);n.events.on("updateRosterViewport",C),n.events.on("rosterCleared",k),this.openSection=function(){e.$sectionElement.find(".origin-social-hub-section-downarrow").removeClass("origin-social-hub-section-downarrow-rotate"),e.$headerElement.addClass("header-visible"),e.$viewportElement.show(),b()},this.closeSection=function(){e.$sectionElement.find(".origin-social-hub-section-downarrow").addClass("origin-social-hub-section-downarrow-rotate"),e.$headerElement.removeClass("header-visible"),e.$viewportElement.hide(),b()},this.toggleSectionVisible=function(){e.$viewportElement.is(":hidden")?(I.openSection(),a.delete("origin-social-hub-section-FRIENDSLIST-"+e.filter+"-closed-"+Origin.user.originId(),!0)):(I.closeSection(),a.set("origin-social-hub-section-FRIENDSLIST-"+e.filter+"-closed-"+Origin.user.originId(),"true",!0)),e.$digest()},this.getRoster=function(e){n.getRoster(e).then(function(e){for(var t in e)y(e[t])})},this.updateSectionToggleState=function(){a.get("origin-social-hub-section-FRIENDSLIST-"+e.filter+"-closed-"+Origin.user.originId(),null,!0)?I.closeSection():I.openSection()},o.events.on("unpopOutHub",I.updateSectionToggleState),s.listenForScopeAndWindowDestroy(e,function(){n.events.off("updateFriendsListFilter",v),n.events.off("socialRosterUpdate"+e.filter,y),n.events.off("socialRosterDelete"+e.filter,S),n.events.off("updateRosterViewport",C),n.events.off("rosterCleared",k),o.events.off("unpopOutHub",I.updateSectionToggleState)})}function Na(e,t){"ngInject";return function(i){i.$last&&e(function(){t.isRosterLoaded()&&t.getRosterLoadStartTime()},5e3)}}function Ga(e,t,i,n){"ngInject";return{restrict:"E",controller:$a,scope:{titleStr:"@titlestr",showOnlineCount:"@showonlinecount",onlineCountDescription:"@desconlinecount",filter:"@"},template:Ij,link:function(r,o,a,s){function c(e){e.stopPropagation(),s.openSection(),r.$digest(),angular.element(o).focus()}function l(e){e.stopPropagation(),s.closeSection(),r.$digest(),angular.element(o).focus()}function d(){s.toggleSectionVisible()}function g(e){i.mapEvents(e,{right:c,left:l})}r.$sectionElement=angular.element(o).find(".origin-social-hub-section"),r.$headerElement=angular.element(o).find(".origin-social-hub-section-header"),r.$viewportElement=angular.element(o).find(".origin-social-hub-section-viewport"),angular.element(o).on("click",".origin-social-hub-section-header",d),angular.element(o).on("keyup",g),n.listenForScopeAndWindowDestroy(r,function(){angular.element(o).off("click",d),angular.element(o).off("keyup",g)}),s.getRoster(r.filter),r.showOnlineCount&&t.create(e.getOnlineCountWatch()).attachToScope(r,"onlineCount"),s.updateSectionToggleState()}}}function Ua(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";function m(){if(h){var e=h.children(".origin-social-hub-area");e.length&&e.offset()&&(wj=e.offset().top,Cj=e.offset().left,Tj=e.width(),Pj=e.height())}}function f(){e.isMinimized=!1,b.setContentClass(!0),i(function(){e.$digest()},0,!1),i(function(){d.updateRosterViewport()},1e3,!1)}var h,v,b=this,y=[],S=null,k="origin-social-hub-area",I="resize";e.igoContext=!!window.oigParams,e.notAvailableLoc=a.getLocalizedStr(e.notAvailableStr,k,"notavailablestr"),e.playingLoc=a.getLocalizedStr(e.playingStr,k,"playingstr"),e.broadcastingLoc=a.getLocalizedStr(e.broadcastingStr,k,"broadcastingstr"),e.minimizeLoc=a.getLocalizedStr(e.minimizeStr,k,"minimize-str"),e.openInWindowLoc=a.getLocalizedStr(e.openInWindowStr,k,"open-in-window-str"),e.chatSettingsLoc=a.getLocalizedStr(e.chatSettingsStr,k,"chat-settings-str"),e.closeAllChatLoc=a.getLocalizedStr(e.closeAllChatStr,k,"close-all-chat-str"),e.margin=0,e.optionsContextmenuVisible=!1,e.hubContextmenuCallbacks={},e.isMinimized=!1,this.setContentClass=function(t){var i=document.querySelector(".origin-content");i&&(!t||n.isWindowPoppedOut()||e.isMinimized?(i.classList.remove("origin-content-isdocked"),c.setEmbeddedChat(!1)):(i.classList.add("origin-content-isdocked"),c.setEmbeddedChat(!0)))},u.create(d.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection").attachToScope(e,function(){Origin.xmpp.isConnected()&&d.getRosterUser(Origin.user.userPid()).then(function(t){t&&u.create(t._presence).defaultTo({jid:Origin.user.userPid(),presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")})}),e.isPlayingGame=function(){return!!e.presence&&!!e.presence.gameActivity&&!!e.presence.gameActivity.gameTitle&&e.presence.gameActivity.gameTitle.length},e.isPoppedOut=function(){return n.isWindowPoppedOut()},this.setElement=function(e){h=e,m()},this.userLoggedIn=function(){return r.userLoggedIn()},y[y.length]=s.events.on("myauth:clientonlinestatechangeinitiated",function(t){e.clientOffline=t&&!t.isOnline,e.$digest()}),e.minimizeHub=function(){e.isMinimized=!0,n.minimizeWindow()},e.popOutWindow=function(){n.popOutWindow()},e.unpopOutWindow=function(){n.unpopOutWindow()},y[y.length]=n.events.on("minimizeHub",function(){b.setContentClass(!1),e.isMinimized=!0,i(function(){e.$digest()},0,!1)}),y[y.length]=n.events.on("unminimizeHub",f),y[y.length]=n.events.on("popOutHub",function(){var t=a.guid();Origin.client.isEmbeddedBrowser()&&Origin.client.desktopServices.setNextWindowUUID(t);var i={top:window.screenY+wj-10,left:window.screenX+Cj-20,width:Tj,height:.9*Pj};window._openPopOutWindow("socialhub","","",i).then(function(i){(S=i).OriginWindowUUID=t,S.onunload=function(){"about:blank"!==S.location.href&&(n.unpopOutWindow(),f())},window.onunload=function(){S.close(),S=null},Origin.client.isEmbeddedBrowser()&&Origin.events.on(Origin.events.CLIENT_POP_OUT_CLOSED,function(t){S&&S.url===t&&e.isPoppedOut()&&(S.close(),S=null,n.unpopOutWindow(),n.minimizeWindow())})}),b.setContentClass(!1),e.updateMargin&&e.updateMargin(),a.dispatchWindowEvent(I)}),y[y.length]=n.events.on("unpopOutHub",function(){b.setContentClass(!0),e.updateMargin&&e.updateMargin(),S&&S.close(),a.dispatchWindowEvent(I)}),y[y.length]=n.events.on("focusHub",function(){S&&window._moveWindowToFront(S)}),y[y.length]=r.events.on("jssdkLogin",function(t){e.userLoggedIn=t,t&&e.isOnline&&(e.clientOffline=!1,i(function(){m()},0)),b.setContentClass(t)}),y[y.length]=Origin.events.on(Origin.events.CLIENT_SOCIAL_FOCUSONFRIENDSLIST,function(){e.isMinimized&&n.unminimizeWindow()}),p.listenForScopeAndWindowDestroy(e,function(){l.detachAll(y),v()}),v=e.$on("originSocialPresenceMenuVisible",function(){e.optionsContextmenuVisible=!1,e.$digest()})}function Ba(e,t,i,n,r){"ngInject";return{restrict:"E",controller:Ua,scope:{notAvailableStr:"@notavailablestr",playingStr:"@playingstr",broadcastingStr:"@broadcastingstr",standalone:"@",minimizeStr:"@",openInWindowStr:"@",chatSettingsStr:"@",closeAllChatStr:"@"},template:_j,link:function(o,a,s,c){function l(){return angular.element(Oj).length&&angular.element(Oj).css("content").indexOf("docked")>-1}function d(){o.isDocked=l()}function g(){if(!o.isDocked&&!e.isWindowPoppedOut())return e.minimizeWindow(),!0}function u(){if(n.isActiveElementMenuOrMenuItem()){var e=angular.element(document.activeElement).closest("[keytarget=contextmenu]");if(e.hasClass("origin-social-hub-area-options"))return c.closeOptionsContextmenu(),e.focus(),!1}}function p(e){if(function(e){if(Origin.utils.os()===Origin.utils.OS_MAC?e.metaKey&&e.ctrlKey:e.ctrlKey&&e.altKey)return i.mapEvents(e,{M:g})}(e))return!1}function m(e){return i.mapEvents(e,{left:u,numpadSubtract:u,escape:u,backspace:u})}o.userLoggedIn=c.userLoggedIn(),c.setContentClass(o.userLoggedIn),o.clientOffline=!t.isClientOnline(),setTimeout(function(){l()||o.isPoppedOut()||o.igoContext||e.minimizeWindow()},0),angular.element(a).on("mouseenter",Oj,d),angular.element(a).on("click",Oj,".origin-social-hub-area-richpresence, .origin-social-hub-area-presence-area",function(){e.isWindowPoppedOut()||o.igoContext||e.minimizeWindow()}),r.listenForScopeAndWindowDestroy(o,function(){angular.element(a).off("mouseenter",Oj,d),angular.element(a).off("keydown",p),angular.element(a).off("keyup",m)}),angular.element(a).on("keydown",p),angular.element(a).on("keyup",m),o.setSitestripeMargin=function(e){o.margin=e,o.updateMargin()},o.updateMargin=function(){e.isWindowPoppedOut()||o.igoContext?angular.element(".origin-social-hub-area").css("margin-top",0):angular.element(".origin-social-hub-area").css("margin-top",o.margin)}}}}function Ma(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";var u="resize";e.chatLoc=d.getLocalizedStr(e.chatStr,"origin-social-hub-areaminimized","chatstr"),e.friendsListLoc=d.getLocalizedStr(e.friendsListStr,"origin-social-hub-areaminimized","friendsliststr")||"Friends List (%online%/%total% Online)",e.offlineLoc=d.getLocalizedStr(e.offlineStr,"origin-social-hub-areaminimized","offlinestr");var p,m=[];g.create(r.getOnlineCountWatch()).attachToScope(e,"onlineCount").attachToScope(e,function(){r.getRosterUser(Origin.user.userPid()).then(function(t){t&&g.create(t._presence).defaultTo({jid:Origin.user.userPid(),presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")})}),g.create(r.getRosterStatusWatch()).attachToScope(e,"rosterLoadStatus"),g.create(r.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection"),e.isPoppedOut=function(){return o.isWindowPoppedOut()},this.setElement=function(e){p=e},m[m.length]=o.events.on("unminimizeHub",function(){p.find(".origin-social-hub-area-minimized").css("max-height","0"),d.dispatchWindowEvent(u)}),m[m.length]=o.events.on("minimizeHub",function(){t(function(){p.find(".origin-social-hub-area-minimized").css("max-height","100%"),d.dispatchWindowEvent(u)},400)}),window.addEventListener("unload",function(){l.detachAll(m)})}function ja(e){"ngInject";return{restrict:"E",controller:Ma,scope:{chatStr:"@chatstr",friendsListStr:"@friendsliststr",offlineStr:"@offlinestr"},template:Fj,link:function(t,i,n,r){t=t,n=n,r.setElement($(i)),$(i).find(".origin-social-hub-area-minimized").on("click",function(){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_FRIENDS_LIST_VIEW_LOCATION,{label:"SPA unminimize"}),e.unminimizeWindow()})}}}function Ha(){"ngInject";var e;this.setElement=function(t){e=t},this.ctaClick=function(){e.trigger("buttonClicked")}}function za(e,t,i,n,r,o,a){"ngInject";return{restrict:"A",link:function(s){function c(){var e=i.voiceCallObservable().data,t=Number(n.getActiveConversationId()),r=i.voiceCallInfoForConversation(t).state;return e.hasIncomingCall&&"INCOMING"===r?(Origin.voice.ignoreCall(t),!1):e.isCalling&&"OUTGOING"===r?(Origin.voice.leaveVoice(t),!1):e.isInVoice&&"STARTED"===r?(Origin.voice.leaveVoice(t),!1):void 0}function l(){var e=Number(n.getActiveConversationId()),t=i.voiceCallInfoForConversation(e).state;if(i.voiceCallObservable().data.hasIncomingCall&&"INCOMING"===t)return Origin.voice.answerCall(e),!1;if(!i.voiceCallObservable().data.hasIncomingCall&&e){var o=r.getRosterFriend(e),a=n.getConversations();if("UNAVAILABLE"!==o.presence.show&&!_.isEmpty(a)&&e!==Number(i.activeVoiceConversationId()))return Origin.voice.joinVoice(e,a[e].participants),!1}}function d(){var e=t.getNext(document.activeElement,!!document.activeElement.attributes.keytarget&&"contextmenuitem"===document.activeElement.attributes.keytarget.value);return angular.element(e).focus(),!1}function g(){var e=t.getPrev(document.activeElement,!!document.activeElement.attributes.keytarget&&"contextmenuitem"===document.activeElement.attributes.keytarget.value);return angular.element(e).focus(),!1}function u(){if("contextmenu"===_.get(document,"activeElement.attributes.keytarget.value"))return m(),!1}function p(){if(t.isActiveElementMenuOrMenuItem()){var e=angular.element(document.activeElement).closest("[keytarget=contextmenu]");return e.find(".otkdropdown-wrap").removeClass("otkdropdown-isvisible"),e.find(".otkcontextmenu-wrap").removeClass("otkcontextmenu-isvisible"),e.focus(),!1}}function m(){var e=angular.element(document.activeElement).find("[keytargetenter],[keytarget]");return e.length&&null!==e[0].getAttribute("keytargetenter")?e[0].click():document.activeElement.click(),!1}function f(e){var t=e.keyCode-Aj;return o.raiseConversationByKeyIndex(t),!1}function h(t){if(e.isNotCharacterCode(t))return!1}function v(t){var i=t.shiftKey,n=t.ctrlKey,r=t.altKey;return n&&r?e.mapEvents(t,y):i&&n?e.mapEvents(t,{enter:l,backspace:c}):e.mapEvents(t,{down:d,up:g,numpadPlus:u,right:u,left:p,numpadSubtract:p,tab:function(){i?g():d()},enter:m,escape:p,backspace:p})}function b(){Origin.client.isEmbeddedBrowser()&&(angular.element(document).off("keydown",h),angular.element(document).off("keyup",v))}for(var y={M:function(){if(!o.isWindowPoppedOut()&&!a.isOIGContext())return o.minimizeWindow(),!1},W:function(){var e=n.getConversations();return _.isEmpty(e)||1!==Object.keys(e).length?n.closeConversationById(n.getActiveConversationId()):o.isWindowPoppedOut()||a.isOIGContext()?window.close():o.closeWindow(),!1}},S=1;S<=Dj+1;S++)y[_.toString(S)]=f;Origin.client.isEmbeddedBrowser()&&(angular.element(document).on("keydown",h),angular.element(document).on("keyup",v)),window.addEventListener("unload",b),s.$on("$destroy",b)}}}function Va(e,t,i){"ngInject";e.friendsLoc=i.getLocalizedStr(e.friendsStr,"origin-social-hub-listselector","friendsstr"),e.chatroomsLoc=i.getLocalizedStr(e.chatroomsStr,"origin-social-hub-listselector","chatroomsstr"),this.activateTab=function(e){var i=$(".origin-social-hub-listselector-tab.otktab-active"),n=i.attr("data-target");i.removeClass("otktab-active");var r=$(e).parents(".otktab");r.addClass("otktab-active"),$("."+n).fadeOut(250);var o=r.attr("data-target");$("."+o).fadeIn(250),"origin-social-hub-roster-tab"===o&&t.updateRosterViewport()}}function Wa(e,t,i,n,r,o,a,s,c){"ngInject";var l="origin-social-hub-localpresence";e.onlineLoc=s.getLocalizedStr(e.onlineStr,l,"onlinestr"),e.awayLoc=s.getLocalizedStr(e.awayStr,l,"awaystr"),e.invisibleLoc=s.getLocalizedStr(e.invisibleStr,l,"invisiblestr"),e.offlineLoc=s.getLocalizedStr(e.offlineStr,l,"offlinestr"),e.inGameLoc=s.getLocalizedStr(e.inGameStr,l,"ingamestr"),e.broadcastingLoc=s.getLocalizedStr(e.broadcastingStr,l,"broadcastingstr"),c.create(n.getXmppConnectionWatch()).defaultTo({isConnected:Origin.xmpp.isConnected()}).attachToScope(e,"xmppConnection").attachToScope(e,function(){Origin.xmpp.isConnected()&&n.getRosterUser(Origin.user.userPid()).then(function(t){t&&c.create(t._presence).defaultTo({jid:Origin.user.userPid(),presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence")})}),this.onClickedPresenceMenuItem=function(e){n.requestPresence(e)},e.isPlayingGame=function(){return!!e.presence&&!!e.presence.gameActivity&&!!e.presence.gameActivity.gameTitle&&e.presence.gameActivity.gameTitle.length},e.trustAsHtml=function(e){return i.trustAsHtml(e)}}function qa(e){"ngInject";return{restrict:"E",controller:Wa,scope:{onlineStr:"@onlinestr",awayStr:"@awaystr",invisibleStr:"@invisiblestr",offlineStr:"@offlinestr",inGameStr:"@ingamestr",broadcastingStr:"@broadcastingstr"},template:Nj,link:function(t,i,n,r){function o(){angular.element(i).find("#origin-social-hub-area-presence-menu").removeClass("otkcontextmenu-isvisible")}function a(e){return r.onClickedPresenceMenuItem(angular.element(e.target).attr("data-value")),o(),!1}function s(e){t.xmppConnection.isConnected&&(angular.element(i).find("#origin-social-hub-area-presence-menu").toggleClass("otkcontextmenu-isvisible"),t.$emit("originSocialPresenceMenuVisible",{})),e.stopImmediatePropagation(),e.preventDefault()}t=t,n=n,angular.element(i).on("click",".otkdropdown .otkmenu a",a),angular.element(i).on("click",".origin-social-hub-area-presence",s),angular.element(document).on("click",o),e.listenForScopeAndWindowDestroy(t,function(){angular.element(document).off("click",o),angular.element(i).off("click",".origin-social-hub-area-presence",s),angular.element(i).off("click",".otkdropdown .otkmenu a",a)})}}}function Ya(e,t,i,n,r,o,a){"ngInject";function s(){"UNAVAILABLE"===e.presence.show&&e.parentController.removeUser(e.user.nucleusId)}e.selected=!1,e.avatarImgSrc=a.getImagePath("social//avatar_placeholder.png"),i.getAvatar(e.user.nucleusId,Origin.defines.avatarSizes.SMALL).then(function(t){e.avatarImgSrc=t,e.$digest()},function(){}).catch(function(e){o.error("OriginSocialInviteusersUserCtrl: UserDataFactory.getAvatar failed",e)}),n.getRosterUser(e.user.nucleusId).then(function(t){t&&r.create(t._presence).defaultTo({jid:e.user.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{}}).attachToScope(e,"presence").attachToScope(e,s)}),e.onClicked=function(){e.selected?(e.$iconSelected.removeClass("zoomIn"),e.$iconSelected.removeClass("zoomOut"),t(function(){e.$iconSelected.addClass("zoomOut")},0),t(function(){e.$iconSelect.removeClass("zoomIn"),e.$iconSelect.removeClass("zoomOut"),t(function(){e.$iconSelect.addClass("zoomIn"),e.selected=!1,e.parentController.removeUser(e.user.nucleusId)},0)},125)):(e.$iconSelect.removeClass("zoomIn"),e.$iconSelect.removeClass("zoomOut"),t(function(){e.$iconSelect.addClass("zoomOut")},0),t(function(){e.$iconSelected.removeClass("zoomIn"),e.$iconSelected.removeClass("zoomOut"),t(function(){e.$iconSelected.addClass("zoomIn"),e.selected=!0,e.parentController.addUser(e.user.nucleusId)},0)},125))},this.onLink=function(){e.selected=e.parentController.isSelected(e.user.nucleusId)}}function Ka(e,t){"ngInject";e.platformEnumeration=ek,e.platformType=ek.facebook,e.openShareWindow=function(){var i={u:e.href};t.openFacebookShareWindow(i)}}function Qa(e,t,i){"ngInject";e.platformEnumeration=ek,e.platformType=ek.twitter;var n=i.getLocalizedStr(e.message,jj,Hj,{"%gamename%":e.displayName});e.openShareWindow=function(){var i={text:n,via:e.via,hashtags:e.hashtags,url:e.url};t.openTwitterShareWindow(i)},e.$watchOnce("displayName",function(){n=i.getLocalizedStr(e.message,jj,Hj,{"%gamename%":e.displayName})}),e.$watchOnce("message",function(){n=i.getLocalizedStr(e.message,jj,Hj,{"%gamename%":e.displayName})})}function Ja(e,t){"ngInject";e.platformEnumeration=ek,e.platformType=ek.email,e.openShareWindow=function(){var i={subject:e.subject,body:e.body};t.openEmailCompose(i)}}function Xa(e,t,i,n,r,o){"ngInject";function a(){var i=t.hash();i===e.anchorName&&r.scrollTo(i,r.isSmall()?angular.element(".l-origin-navigation").height():0,1e3)}var s=this;s.registerAnchor=function(t){o.enqueue(t,{anchorName:e.anchorName,anchorIcon:e.anchorIcon,title:e.titleStr})},s.listenToHashChangeEvents=function(){n.events.on("aboutNav:hashChange",a),i(s.onHashChange,500),e.$on("$destroy",function(){n.events.off("aboutAnchor:hashChange",a)})}}function Za(e){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{alignment:"@",compatibleTitleStr:"@",compatibleSubtitle:"@",incompatibleTitleStr:"@",incompatibleSubtitle:"@",textColor:"@"},link:function(t){e.populateScope(t,Wj)},template:Vj}}function es(e,t){"ngInject";return{restrict:"E",scope:{downloadOriginText:"@"},template:Kj,link:function(i){i.downloadOrigin=t.getLocalizedStr(i.downloadOriginText,Jj,"download-origin-text"),i.downloadOriginLink=null;var n=e.followQueue(Qj,function(e){i.downloadOriginLink=e});i.$on("$destroy",n)},controller:"originStoreAboutNavCtrl",replace:!0}}function ts(e,t,i){"ngInject";return{restrict:"E",scope:{category:"@",title:"@",description:"@",downloadButtonTextWindows:"@",downloadUrlWindows:"@",downloadButtonTextMac:"@",downloadUrlMac:"@",learnMoreButtonText:"@",learnMoreUrl:"@",downloadTextEaApp:"@",downloadUrlEaApp:"@"},replace:!0,link:function(n){n.iconPath=i.getImagePath(n.category===tH.Origin?"origin.svg":"eaapp.svg"),n.titleStr=e.getLocalizedStr(n.title,eH,"title"),n.descriptionStr=e.getLocalizedStr(n.description,eH,"description"),n.downloadButtonTextWindows=e.getLocalizedStr(n.downloadButtonTextWindows,eH,"downloadButtonTextWindows"),n.downloadButtonTextMac=e.getLocalizedStr(n.downloadButtonTextMac,eH,"downloadButtonTextMac"),n.downloadTextEaApp=e.getLocalizedStr(n.downloadTextEaApp,eH,"downloadTextEaApp"),n.learnMoreButtonText=e.getLocalizedStr(n.learnMoreButtonText,eH,"learnMoreButtonText"),t.isInstallable().then(function(e){n.showOriginWindowsDownloadButtons=n.category===tH.Origin&&e&&Origin.utils.os()===Origin.utils.OS_WINDOWS,n.showOriginMacDownloadButtons=n.category===tH.Origin&&e&&Origin.utils.os()===Origin.utils.OS_MAC,n.showEAAppDownloadButtons=n.category===tH.EAApp&&Origin.utils.os()===Origin.utils.OS_WINDOWS,n.showEAAppLearnMoreOnly=n.category===tH.EAApp&&Origin.utils.os()===Origin.utils.OS_MAC;var t=n.showOriginMacDownloadButtons?"otkicon-mac":"otkicon-windows",i=n.showOriginMacDownloadButtons?n.downloadButtonTextMac:n.downloadButtonTextWindows;n.downloadOriginPrimaryButton='<i class="otkicon '+t+' origin-download-btn-icon"></i><span class="origin-download-btn-text">'+i+"</span>",n.$digest()})},template:Zj}}function is(e){"ngInject";function t(e,t){return moment(t).valueOf()-moment(e).valueOf()}e.dates=[],e.dateFormat=rH,this.registerPolicyItem=function(i){e.dates.push(i),e.selectedDate=function(t){return!e.selectedDate||moment(t).valueOf()>moment(e.selectedDate).valueOf()?t:e.selectedDate}(i),_.size(e.dates)>1&&e.dates.sort(t)},this.getSelectedDate=function(){return e.selectedDate}}function ns(e,t,i){"ngInject";e.navClick=function(e){t.hash(e),i.events.fire("aboutNav:hashChange",e)}}function rs(e){"ngInject";return{restrict:"E",scope:{},template:dH,link:function(t){t.navItems=[];var i=e.followQueue(gH,function(e){t.navItems.push(e)});t.$on("$destroy",i)},controller:ns,replace:!0}}function os(e,t){"ngInject";e.title=t.getLocalizedStr(null,fH,hH[e.socialMediaType])}function as(e,t,i,n,r,o,a,s){"ngInject";var c=r.buildPathFromUrl();e.strings={pricingErrorMessage:i.getLocalizedStr(!1,IH,"pricing-error-message")},t.getAutomationConfig()&&(e.automationJoinCtaId="access-footer-join-now-cta"),o.populateScopeWithOcdAndCatalog(e,IH,c).then(s.getVaultGamesCount).then(function(t){var r={};r[dw]=_.get(t,[yI.y.STANDARD,yI.d]),r[gw]=_.get(t,[yI.y.PREMIUM,yI.d]),n.waitForAllPriceInsertingPromises([n.insertPriceIntoLocalizedStrAsync(e.strings,e.legal,IH,"legal",r),n.insertPriceIntoLocalizedStrAsync(e.strings,e.subtitle,IH,"subtitle",r)],e).then(function(){return a.digestIfDigestNotInProgress(e)}),r["%game%"]=_.get(e,["model","displayName"],""),e.strings.header=i.getLocalizedStr(e.header,IH,"header",r)})}function ss(e,t,i,n,r,o,a){"ngInject";function s(){e.active===_.size(e.images)-1?e.active=0:e.active++}var c=void 0;e.active=0,e.images=[],e.carouselRunning=!1,e.speed=e.speed||TH,e.strings={buttonText:r.getLocalizedStr(e.buttonText,CH,"button-text"),pricingErrorMessage:r.getLocalizedStr(void 0,CH,"pricing-error-message")},i.getAutomationConfig()&&(e.automationHeroId="access-landing-hero",e.automationJoinCtaId="access-header-join-now-cta"),this.registerBackground=function(i){e.images.push(i),_.size(e.images)>1&&!e.carouselRunning&&(e.carouselRunning=!0,c=t(s,e.speed))},e.$on("$destroy",function(){t.cancel(c)}),a.getVaultGamesCount().then(function(t){var i={};i[dw]=_.get(t,[yI.y.STANDARD,yI.d]),i[gw]=_.get(t,[yI.y.PREMIUM,yI.d]),e.strings.description=r.getLocalizedStr(e.description,CH,"description",i),n.waitForAllPriceInsertingPromises([n.insertPriceIntoLocalizedStrAsync(e.strings,e.header,CH,"header",i),n.insertPriceIntoLocalizedStrAsync(e.strings,e.legal,CH,"legal"),n.insertPriceIntoLocalizedStrAsync(e.strings,e.subtitle,CH,"subtitle",i)],e).then(function(){return o.digestIfDigestNotInProgress(e)})})}function cs(e,t){"ngInject";return{restrict:"E",scope:{noBackground:"@"},link:function(i){Promise.all([t.getOriginAccessTermsOfService().then(function(e){return i.tos=e}),e.populateWithDefaults(i,OH)]).then(function(){i.$digest()})},template:_H}}function ls(e,t,i,n,r){"ngInject";e.strings={buttonText:t.getLocalizedStr(e.buttonText,FH,"button-text"),pricingErrorMessage:t.getLocalizedStr(void 0,FH,"pricing-error-message")},r.getVaultGamesCount().then(function(r){var o={};o[dw]=_.get(r,[yI.y.STANDARD,yI.d]),o[gw]=_.get(r,[yI.y.PREMIUM,yI.d]),e.strings.description=t.getLocalizedStr(e.description,FH,"description",o),i.waitForAllPriceInsertingPromises([i.insertPriceIntoLocalizedStrAsync(e.strings,e.header,FH,"header",o),i.insertPriceIntoLocalizedStrAsync(e.strings,e.legal,FH,"legal"),i.insertPriceIntoLocalizedStrAsync(e.strings,e.subtitle,FH,"subtitle",o)],e).then(function(){return n.digestIfDigestNotInProgress(e)})})}function ds(e,t){"ngInject";return{restrict:"E",scope:{video:"@",logo:"@",header:"@",description:"@",legal:"@",buttonText:"@",offerId:"@",subtitle:"@",image:"@"},controller:ls,link:function(e,i){var n=i.find(xH);t.loadYoutubePlayer(n,e.video,{controls:1},"100%","100%")},template:EH}}function gs(e,t){"ngInject";e.strings={header:t.getLocalizedStr(e.header,DH,"header"),caption:t.getLocalizedStr(e.caption,DH,"caption")}}function us(e,t,i,n){"ngInject";return{restrict:"E",transclude:!0,scope:{header:"@",background:"@",foreground:"@",logo:"@",caption:"@"},controller:gs,template:AH,link:function(r,o){function a(){if(s.length&&!n.isSmall()){var e=s.offset().top-0,t="translate3d(0,"+((window.pageYOffset-e)/8).toFixed(2)+"px, 0)";s.css(i.addVendorPrefixes("transform",t))}}var s=o.find(RH);t.addScrollEventHandler(r,a),t.addResizeEventHandler(r,function(){n.isSmall()&&s.length&&s.removeAttr("style")},100),e(a,0,!1)}}}function ps(e,t,i){"ngInject";e.strings={header:t.getLocalizedStr(e.header,ZH,"header"),subheader:t.getLocalizedStr(e.subheader,ZH,"subheader")};var n=i.buildPathFromUrl();n.isValid&&(e.gdpPath=n.gdpPath)}function ms(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",transclude:!0,require:"?^originStorePdpSectionWrapper",scope:{header:"@",more:"@",query:"@",facet:"@",sort:"@",dir:"@",rows:"@",logo:"@"},link:function(r,s,c,l){function d(e){r.models.push(_.get(e,["i18n","packArtMedium"]))}function g(e){_.forEach(_.compact(e),d),r.showMoreCta=k<I,r.$digest(),C=!1}function u(e,t){return e.push(i.getVaultModelPromise(new KH(t))),e}function p(e){if(e){var i=t.toArray(t.map(w("path"),e)),n=_.reduce(i,u,[]);Promise.all(n).then(g),l&&_.isFunction(l.setVisibility)&&(l.setHeaderClass(sz),l.setVisibility(!0))}else 0===_.size(r.models)&&angular.element(s).slideUp()}function m(e){n.error("[origin-store-access-landing-vaultlist SearchFactory.searchStore] failed",e.message)}function f(e){return I=_.get(e,[az,"numFound"],0),k+=_.get(e,[az,"numVisible"],0),e}var h=_.get(r,"facet","subscriptionGroup:vault-games"),v=_.get(r,"query",""),b=_.get(r,"sort",oz.Rank),y=_.get(r,"dir",rz.Descending),S=_.get(r,"rows",nz),k=0,I=100,w=t.getProperty,C=!0;r.models=[],r.showMoreCta=!1,r.search=function(){if(!C&&I>0&&k<I){C=!0,r.showMoreCta=!1,a.digestIfDigestNotInProgress(r);var t={filterQuery:h,facetField:"",sort:b+" "+y,start:k,rows:S,isGDP:!0};e.searchStore(v,t).then(f).then(w([az,"game"])).then(p).catch(m)}},o.populateScope(r,iz).then(function(){return C=!1}).then(r.search)},template:tz}}function fs(e,t,i,n,r,o){"ngInject";e.vaultPageUrl=t.getAbsoluteUrl(bI.s,{});var a=n.userHasSubscription()?n.getNextBillingDate()||n.getExpiration():"",s=r.isValidDate(a)?moment(a).format("LL"):"";i.populateScopeWithOcdAndCatalog(e,lz,e.ocdPath).then(function(){e.billingDate=e.billing?e.billing.replace("%date%",s):"",e.subtitleWithGameName=e.subtitle?e.subtitle.replace("%game%",_.get(e,["model",DI.k],"")):"",o.digestIfDigestNotInProgress(e)}),e.onClick=function(){return t.internalUrl(e.ctaUrl)}}function hs(e,t,i,n){"ngInject";e.vaultPageUrl=i.getAbsoluteUrl(bI.s,{}),t.populateScopeWithOcdAndCatalog(e,gz,e.ocdPath).then(function(){e.gameHeader=e.header.replace("%game%",_.get(e,["model","displayName"],"")),n.digestIfDigestNotInProgress(e)}),e.ctaClick=function(){_.get(e,["model","isOwned"],!1)||i.goToState(bI.s,{})}}function vs(e){"ngInject";return{restrict:"E",transclude:!0,scope:{},link:function(t,i){e.populateScopeAndSlingDataToDom(t,pz,i,function(e){return{"origin-background-mediacarousel":{items:_.get(e,[pz,"items"],[])}}},void 0,{wrapInSectionWrapper:!1})}}}function bs(e,t){"ngInject";e.isOnTop=!1,e.goToGdp=function(){t.goToGdp(e.model.gdpPath)},e.$on("$destroy",function(){e.timerHandle&&clearTimeout(e.timerHandle)})}function ys(e){"ngInject";return{restrict:"E",replace:!0,scope:(t={ocdPath:"@"},i=hz,n="@",i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t),require:"^originBackgroundMediacarousel",link:function(t,i,n,r){t.timeoutInterval=r.getTimeoutInterval(),t.notify=function(e){return t.isOnTop=t.assignedIndex===e,t.$digest(),new Promise(function(e){t.isOnTop?t.timerHandle=setTimeout(e,t.timeoutInterval):e()})},e.populateScopeWithOcdAndCatalog(t,fz,t.ocdPath).then(function(){t.assignedIndex=r.registerCarouselItem(t.notify)})},controller:"originBackgroundMediacarouselItemCtrl",template:mz};var t,i,n}function Ss(e,t,i,n,r,o){"ngInject";t.populateScope(e,kz).then(function(){var t=n.buildSearchConfig(e,Sz,yz);i.searchStore(_.get(e,"query",""),t,e.blackList,e.whiteList).then(function(t){e.games=_.get(t,["games","game"],[]),r.digestIfDigestNotInProgress(e)})}),e.onClick=function(){return o.internalUrl(e.ctaUrl)}}function ks(e,t,i,n,r,o,a,s,c){"ngInject";s.disableBodyScrolling(),e.isLoading=!0,e.isMobileView=s.isSmall();var l=c.getNuxModel(),d=l.ocdPaths,g=l.nucleusId,u=l.username;e.telemetryCssClasses={pagewrapper:_.isUndefined(g)?Cz:Cz+"-referral",gametile:Cz+"-gametile"},e.ocdPaths=d,e.nucleusId=g,e.vaultPageUrl=i.getAbsoluteUrl(bI.s,{});var p=r.userHasSubscription()?r.getNextBillingDate()||r.getExpiration():"",m=o.isValidDate(p)?moment(p).format("LL"):"";n.populateWithDefaults(e,wz).then(function(){e.billingDate=e.billing?e.billing.replace("%date%",m):"",e.pageTitleStr=e.pageTitle&&u?e.pageTitle.replace("%username%",u):"",a.digestIfDigestNotInProgress(e)}),e.onClick=function(){return i.internalUrl(e.ctaUrl)},setTimeout(function(){e.isLoading=!1,s.enableBodyScrolling(),a.digestIfDigestNotInProgress(e)},4500)}function Is(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",btn:"@",description:"@",image:"@"},template:Oz,link:e.nuxLinkFunction("discount")}}function ws(e,t,i,n){"ngInject";var r=i.getNextBillingDate()||i.getExpiration(),o=n.isValidDate(r)?moment(r).format("LL"):"";e.formattedDescription=t.getLocalizedStr(e.description,xz,"description",{"%date%":o})}function Cs(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",logo:"@",btn:"@",description:"@"},controller:ws,template:Fz,link:e.nuxLinkFunction("intro")}}function Ts(e,t,i,n){"ngInject";e.trial?i.getByOcdPath([e.trial]).attachToScope(e,function(i){e.model=_.head(_.values(i)),e.formattedDescription=t.getLocalizedStr(e.description,Dz,"description",{"%game%":_.get(e,["model","displayName"],"")}),e.title=_.get(e,["model","displayName"])}):(e.formattedDescription=t.getLocalizedStr(e.description,Dz,"description"),e.title=t.getLocalizedStr(e.titleOverride,Dz,"title-override"),e.message=t.getLocalizedStr(e.message,Dz,"message")),e.onClick=function(){e.url&&n.openLink(e.url)}}function Ps(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",btn:"@",description:"@",image:"@",trial:"@",titleOverride:"@",message:"@",url:"@"},controller:Ts,template:Az,link:e.nuxLinkFunction("trials")}}function _s(e){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",btn:"@",description:"@"},template:$z,link:e.nuxLinkFunction("vault")}}function Os(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k){"ngInject";function I(){F.hasTrial=!_.isEmpty(F.earlyAccessTrialModel),F.isPurchaseAction=v.isPurchaseAction(F.model),F.isEntitleAction=v.isEntitleAction(F.model),F.isPlayAction=v.isPlayAction(F.model),F.chainCheckoutButtonText=h.isPreorderable(F.model)?_.get(F,"chainCheckoutButtonTextPreorder"):F.hasTrial||S.isVaultGameOrUpgradeable(F.model)?_.get(F,"chainCheckoutButtonTextTrialorvault"):_.get(F,"chainCheckoutButtonTextPurchase"),e.$digest()}function w(e){var t=_.get(e,[0,"error"]);if(t){var i=_.get(t,["rootCause"]),n=_.compact([_.get(i,["field"]),_.get(i,["value"]),_.get(i,["cause"])]).join(" ");return Promise.reject({message:"Pricing call returned an error",response:{error:{failure:{cause:n}}}})}return _.get(e,[0,"rating",0,"finalTotalAmount"],0)}function C(t){F.discountedPrice=t,e.$digest()}function T(t){F.backgroundImageFallback=_.get(t,"backgroundimage"),F.gameLogoFallback=_.get(t,"gamelogo"),e.$digest()}function P(){b.userHasSubscription()&&!F.model.isOwned&&(Origin.events.fire(Origin.events.DIRTYBITS_SUBSCRIPTION),l.goToState(Mz,t.params))}function O(){!b.userHasSubscription()&&k.ownsEntitlement(F.model.offerId)&&l.goToState(Mz,t.params)}function E(){i.events.off(jz,P),g.events.off(Hz,O)}var F=this;F.strings={percentDiscount:y.getLocalizedStr(F.percentDiscount,Uz,"percent-discount")};var x=m.buildPathFromUrl();p.setModel(F,x).then(_.partial(o.populateScope,F,Uz,x)).then(function(){var t=_.get(F,["model","displayName"]);F.headingFormatted=y.getLocalizedStr(F.heading,Uz,"heading",{"%game%":t}),F.comparisonSingleGamenameFormatted=y.getLocalizedStr(F.comparisonSingleGamename,Uz,"comparison-single-gamename",{"%game%":t}),F.comparisonPairGamenameFormatted=y.getLocalizedStr(F.comparisonPairGamename,Uz,"comparison-pair-gamename",{"%game%":t}),f.insertPriceIntoLocalizedStr(e,F.strings,F.monthlyPrice,Uz,"monthly-price"),u.setEditions(F).then(I),c.getPrice([F.model.offerId],"SUBSCRIPTIONS",!0).then(w).then(r.formatCurrency).then(C).catch(function(e){n.error("[origin-store-access-productlanding-header] failed to get discounted subscription price",e)}),F.gameLogo&&F.backgroundImage||s.getOcdByPath(x).then(d.findDirectives(Bz)).then(d.flattenDirectives(Bz)).then(_.head).then(T).catch(function(e){n.error("[origin-store-access-productlanding-header] failed to get ocd",e)}),F.darkColors=F.color===Gz.dark,F.ocdLoaded=!0,i.events.on(jz,P),g.events.on(Hz,O),e.$on("$destroy",E)})}function Es(e,t,i,n){"ngInject";e.strings={button:t.getLocalizedStr(e.button,Wz,"button"),header:t.getLocalizedStr(e.header,Wz,"header"),platform:t.getLocalizedStr(e.platform,Wz,"platform"),link:t.getLocalizedStr(e.link,Wz,"link"),pricingErrorMessage:t.getLocalizedStr(void 0,Wz,"pricing-error-message")};var r=i.insertPriceIntoLocalizedStrAsync(e.strings,e.description,Wz,"description");i.waitForAllPriceInsertingPromises([r],e).then(_.partial(n.digestIfDigestNotInProgress,e))}function Fs(e){"ngInject";return{restrict:"E",transclude:!0,scope:{logo:"@",header:"@",description:"@",platform:"@",link:"@",button:"@",offerId:"@",video:"@"},controller:Es,template:Vz,link:function(t,i){var n=i.find(qz);e.loadYoutubePlayer(n,t.video,{controls:1},"100%","100%")}}}function xs(e,t){"ngInject";e.strings={header:t.getLocalizedStr(e.header,Kz,"header")}}function Ls(e,t,i,n){"ngInject";e.strings={button:t.getLocalizedStr(e.button,Xz,"button"),header:t.getLocalizedStr(e.header,Xz,"header"),platform:t.getLocalizedStr(e.platform,Xz,"platform"),pricingErrorMessage:t.getLocalizedStr(void 0,Xz,"pricing-error-message")};var r=i.insertPriceIntoLocalizedStrAsync(e.strings,e.legal,Xz,"legal");i.waitForAllPriceInsertingPromises([r],e).then(_.partial(n.digestIfDigestNotInProgress,e))}function As(e){"ngInject";return{restrict:"E",transclude:!0,scope:{background:"@",foreground:"@",logo:"@",header:"@",button:"@",offerId:"@",legal:"@",platform:"@",shade:"@",video:"@"},controller:Ls,template:Jz,link:function(t,i){var n=i.find(Zz);e.loadYoutubePlayer(n,t.video,{controls:1},"100%","100%")}}}function Ds(e,t,i,n,r){"ngInject";function o(){t.find(iV).remove()}function a(e){var t={},i=_.get(e,"src"),n=_.get(e,"video-id");i?(_.set(t,"src",i),_.set(t,"type","image")):n&&(_.set(t,"videoId",n),_.set(t,"matureContent",_.get(e,"mature-content",!1)),_.set(t,"type","video")),_.isEmpty(t)||c.push(t)}function s(e){_.forEach(e,a)}var c=[];i.populateScope(e,tV).then(_.partial(n.getOcdByPath,e.ocdPath,void 0)).then(r.findDirectives("origin-store-pdp-media-carousel-wrapper")).then(function(t){var i=_.get(_.head(_.values(_.head(t))),"items",[]);_.forEach(i,s),_.isEmpty(c)?o():(_.set(e,"media",c),e.$digest())}).catch(o)}function Rs(e,t){"ngInject";e.version="MODAL",t.populateScope(e,rV).then(function(){e.controlButtonColor||(e.controlButtonColor=oV.dark)})}function $s(e,t,i,n,r){"ngInject";e.version="MODAL",e.games=[],n.populateScope(e,dV).then(function(){var n=r.buildSearchConfig(e,cV,sV);e.controlButtonColor=e.controlButtonColor||lV.dark,i.searchStore(_.get(e,"query",""),n).then(function(i){var n=_.get(i,["games","game"],[]);_.isEmpty(n)?t.slideUp():e.games=n})})}function Ns(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";e.getTileHref=g.buildGdpUrlFromPath;var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_.set(e,"violatorText",t),_.set(e,"violatorType",i),_.set(e,"showViolator",n)},p=function(e,t){e.preventDefault(),n.goToGdp(t)},m=void 0,f=void 0;e.ocdPath?(m=_.partial(d.getOcdByPath,e.ocdPath),f=_.partial(i.getCatalogByPath,e.ocdPath)):(m=_.partial(c.getOcdByOfferId,e.offerId),f=_.partial(i.getCatalogInfo,[e.offerId])),Promise.all([m().then(s.findDirectives(vV)).then(s.flattenDirectives(vV)).then(_.head),f().then(_.values).then(_.head).then(l.loadEntitlementsInfo)]).then(_.spread(function(i,n){var s={};_.set(s,"tileLayout","small"),_.set(s,"tileImage",function(e,t){return _.get(e,"discover-tile-image")||_.get(t,[DI.I,DI._10])}(i,n)),_.set(s,"tileHeader",_.get(n,[DI.I,DI.k])),_.set(s,"index",_.get(n,DI.Y)),_.set(s,"gdpPath",_.get(n,DI.E)),function(e,t){var i=_.get(t,[DI._34,DI._36],null),n=!_.isNull(i)&&!o.isInTheFuture(i)&&o.isInTheFuture(o.addDays(i,30)),r=!_.isNull(i)&&o.isInTheFuture(i),s=_.get(t,DI.n,!1);n?u(e,a.getLocalizedStr(null,pV,mV),mV,!0):s?u(e,a.getLocalizedStr(null,pV,fV),fV,!0):r?u(e,a.getLocalizedStr(null,pV,hV),hV,!0):u(e)}(s,n),e.gameTileConfig=s,e.goToOffer=p,t.getAutomationConfig()&&(e.automationTileId="game-tile"),r.digestIfDigestNotInProgress(e)}))}function Gs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Us(e){return["$scope","UserSelectionWizardFactory","GiftFriendListFactory","UtilFactory",function(t,i,n,r){"ngInject";function o(){t.$digest()}function a(e){(u=e).getCurrentPage().then(d)}function s(){n.selectUser({}),t.displayedUsers=[],t.errorOccured=!0,t.searchInProgress=!1}function c(){t.searchInProgress=!0,t.errorOccured=!1,n.getFriendListFromFriendsApi().then(a).catch(s)}function l(e,t){e===f&&(p=t).getNextPage().then(d)}function d(e){t.displayedUsers=e,t.searchInProgress=!1,o(),e.length||_.isFunction(t.emitTelemetryNoResultEvent)&&t.emitTelemetryNoResultEvent()}function g(){setTimeout(function(){angular.element("#filter-by-text").get(0).focus()},xV)}var u,p,m,f;t.flowType=i.getWizardFlowType(e),t.flowTypes=n_,t.strings={noResultsFoundHint:r.getLocalizedStr(!1,e,"no-results-found-hint"),searchInputHint:r.getLocalizedStr(!1,e,"search-input-hint"),noResultsError:r.getLocalizedStr(!1,e,"no-results-error-str"),nextStr:r.getLocalizedStr(!1,e,"next-str"),titleStr:r.getLocalizedStr(!1,e,"title-str"),disclaimer:r.getLocalizedStr(!1,e,"disclaimer"),subtitleStr:r.getLocalizedStr(!1,e,"subtitle-str"),basicSubscriptionTrialStr:r.getLocalizedStr(!1,e,"basic-subscription-trial-str"),premierSubscriptionTrialStr:r.getLocalizedStr(!1,e,"premier-subscription-trial-str")},t.searchKeyword=null,t.displayedUsers=[],t.isUserSelected=!1,t.lazyLoadDisabled=function(){return!!t.searchInProgress||(t.searchKeyword?!p.hasMore():!u.hasMore())},t.loadMore=function(){return t.searchInProgress=!0,t.searchKeyword?p.getNextPage().then(d):u.getNextPage().then(d)},t.searchForKeyword=function(){t.searchKeyword?(f=r.guid(),t.strings.noResultsFound=r.getLocalizedStr(!1,e,"no-results-found",{"%searchkeyword%":t.searchKeyword}),t.errorOccured=!1,t.searchInProgress=!0,n.getSearchResults(t.searchKeyword).then(_.partial(l,f)).catch(s).then(o)):t.resetSearchResults()},t.resetSearchResults=function(){t.searchKeyword=null,t.errorOccured=!1,u?u.getCurrentPage().then(function(e){t.displayedUsers=e,t.$digest()}):c(),g()},t.onNext=function(){t.isUserSelected&&(t.isWarningRequired?i.startWarningMessageDialog({offerId:t.offerId,userData:m}):i.startCustomizeMessageDialog({offerId:t.offerId,referralProgramId:t.referralProgramId,subscriptionType:t.subscriptionType,referralLimit:t.referralLimit,userData:m,hideBackButton:!1},i.getCustomMessageDialogName(e)))},n.getSelectedUserObservable().attachToScope(t,function(e){m=_.get(e,d_);var i=_.get(e,["eligibilityCallInProgress"],!1);t.isUserSelected=_.get(m,a_)&&!i,t.isWarningRequired=_.get(e,"isWarningRequired",!1)}),g(),_.get(m,g_,null)?(t.searchKeyword=m.username,t.searchForKeyword()):c()}]}function Bs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ms(e){return["$scope","UtilFactory","GiftFriendListFactory","NavigationFactory","NucleusIdObfuscateFactory","DialogFactory","ComponentsLogFactory","ComponentsConfigHelper",function(t,i,n,r,o,a,s,c){"ngInject";function l(n){n&&(t.userInfo=n,t.userInfo.fullname=i.getLocalizedStr(!1,e,"first-lastname-str",{"%firstname%":t.userInfo.firstname||"","%lastname%":t.userInfo.lastname||""}))}function d(e){var i=e.id;i&&(t.userProfilePath=r.getHrefFromState(bI.R,{id:i,topic:gF}))}function g(e){n.selectUser(e?{userInfo:t.userInfo,eligibilityCallInProgress:t.loading,isWarningRequired:t.isWarningRequired}:null)}function u(){t.selected&&g(t.eligible)}function p(e){t.eligibility=_.get(_.head(e),"status",p_).toLowerCase(),t.eligibilityStr=t.strings[t.eligibility],t.eligible=n.isFriendEligibleToReceive(t.eligibility),t.isWarningRequired=n.isWarningRequired(t.eligibility),u()}function m(){n.selectUser(null),t.eligibility=p_,t.eligibilityStr=t.strings[t.eligibility]}function f(e){a.openAlert({id:"friend-tile-loading-error",title:i.getLocalizedStr(null,qV,"friendtileloadingerrortitle"),description:i.getLocalizedStr(null,qV,"friendtileloadingerrordesc"),rejectText:i.getLocalizedStr(null,qV,"closeprompt")}),s.error(YV,e)}function h(){t.loading=!1,u(),t.$digest()}function v(e){var i=_.get(e,[d_,a_]);t.selected=t.nucleusId===i,t.anotherFriendTileSelected=!t.selected&&i}var b;t.strings=(Bs(b={},BV,i.getLocalizedStr(!1,e,"eligible-str")),Bs(b,zV,i.getLocalizedStr(!1,e,"eligible-with-require-base-game-warning-str")),Bs(b,NV,i.getLocalizedStr(!1,e,"not-eligible-str")),Bs(b,GV,i.getLocalizedStr(!1,e,"ineligible-to-receive-str")),Bs(b,$V,i.getLocalizedStr(!1,e,"owns-game-str")),Bs(b,UV,i.getLocalizedStr(!1,e,"on-wishlist-str")),Bs(b,VV,i.getLocalizedStr(!1,e,"on-wishlist-str")),Bs(b,MV,i.getLocalizedStr(!1,e,"already-access-member-str")),Bs(b,jV,i.getLocalizedStr(!1,e,"not-supported-country-str")),Bs(b,HV,i.getLocalizedStr(!1,e,"pending-invitation-str")),Bs(b,WV,i.getLocalizedStr(!1,e,"unknown-str")),b),t.isOigContext=c.isOIGContext(),t.onClick=function(){t.selected=!t.selected,g(t.selected)},t.onAvatarClick=function(e){e&&e.preventDefault()},t.onProfileLinkClick=function(e){e&&(e.preventDefault(),t.isOigContext||e.stopPropagation()),t.userProfilePath&&!t.isOigContext&&r.openWindowToPathWithEADPSSO(t.userProfilePath,!0)};var y=function(){return Promise.reject()};t.setUserEligibilityPromise=function(e){_.isFunction(e)&&(y=e)},t.init=function(){t.loading=!0,Promise.all([n.getUserInfo({nucleusId:t.nucleusId}).then(l),o.encode(t.nucleusId).then(d)]).then(y).then(p).catch(m).then(h).catch(f),n.getSelectedUserObservable().attachToScope(t,v),u()}}]}function js(e){"ngInject";return{restrict:"E",scope:{nucleusId:"@",offerId:"@",isSelected:"@",onFriendSelect:"&"},controller:KV,link:function(t){t.setUserEligibilityPromise(function(){return e.getFriendsGiftingEligibility(t.offerId,[t.nucleusId])}),t.init()},template:RV}}function Hs(e){"ngInject";return{restrict:"E",scope:{nucleusId:"@",referralProgramId:"@",isSelected:"@",onFriendSelect:"&"},controller:QV,link:function(t){t.setUserEligibilityPromise(function(){return e.getFriendReferralEligibility(t.referralProgramId,[t.userInfo.personaId])}),t.init()},template:RV}}function zs(e){return["$scope","ComponentsConfigFactory","UtilFactory","GamesCatalogFactory","GiftFriendListFactory","ObjectHelperFactory","UserSelectionWizardFactory",function(t,i,n,r,o,a,s){"ngInject";function c(i){t.charsRemaining=n.getLocalizedStr(!1,e,"chars-remaining-str",{"%count%":i})}function l(e){t.username=_.get(e,"username")}function d(e){(e.firstname||e.lastname)&&(t.senderName=n.getLocalizedStr(!1,ZV,"first-lastname-str",{"%firstname%":e.firstname||"","%lastname%":e.lastname||""}))}function g(e){t.packArtLarge=_.get(e,[DI.I,DI._10],p),t.displayName=_.get(e,[DI.I,DI.k])}var u,p=i.getImagePath("packart-placeholder.jpg");t.strings={backStr:n.getLocalizedStr(!1,e,"back-str"),nextStr:n.getLocalizedStr(!1,e,"next-str"),yournameHint:n.getLocalizedStr(!1,e,"yourname-hintstr"),fromStr:n.getLocalizedStr(!1,e,"from-str"),titleStr:n.getLocalizedStr(!1,e,"title-str"),yourMessageHint:n.getLocalizedStr(!1,e,"your-message-hint-str"),nameRequiredError:n.getLocalizedStr(!1,e,"fullname-required-error-str"),basicSubscriptionTrialStr:n.getLocalizedStr(!1,e,"basic-subscription-trial-str"),premierSubscriptionTrialStr:n.getLocalizedStr(!1,e,"premier-subscription-trial-str")},t.maxMessageLength=eW,t.message="",t.senderName=Origin.user.originId(),t.onInputBlur=function(){t.isValid=!!t.senderName&&t.senderName.trim().length>0},t.onTextAreaChange=function(){c(eW-t.message.length)},t.onBack=function(){s.startUserSelectionDialog({offerId:t.offerId,referralProgramId:t.referralProgramId,subscriptionType:t.subscriptionType,referralLimit:t.referralLimit},s.getFriendsListDialogName(e))},t.onInputBlur(),c(eW),Promise.all([t.offerId?r.getCatalogInfo([t.offerId]).then(a.getProperty(t.offerId)).then(g):Promise.resolve(),(u=_.get(o.getSelectedUser(),["userData"]),t.nucleusId===_.get(u,a_)&&u.username?Promise.resolve(u).then(l):o.getUserInfo({nucleusId:t.nucleusId}).then(l)),o.getUserInfo({nucleusId:Origin.user.userPid()}).then(d)]).then(function(){t.strings.sendingHint=n.getLocalizedStr(!1,e,"sending-hint-str",{"%displayName%":t.displayName||t.referralAccessTrialName||"","%username%":t.username}),t.onInputBlur(),t.$digest()})}]}function Vs(e,t){"ngInject";return{restrict:"E",scope:{offerId:"@",nucleusId:"@",hidebackbtn:"@"},controller:tW,link:function(i){i.customMessageAllowed=!0,i.onNext=function(){e.closeFlow(),t.gift({offerId:i.offerId,recipientId:i.nucleusId,senderName:i.senderName,message:i.message})}},template:XV}}function Ws(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function qs(e,t,i,n){"ngInject";return{restrict:"E",scope:{referralProgramId:"@",subscriptionType:"@",referralLimit:"@",nucleusId:"@",hidebackbtn:"@",personaId:"@"},controller:iW,link:function(r,o){o.addClass(oW),r.subscriptionType===BS.premier?r.referralAccessTrialName=r.strings.premierSubscriptionTrialStr:r.subscriptionType===BS.basic&&(r.referralAccessTrialName=r.strings.basicSubscriptionTrialStr),r.onNext=function(){e.closeFlow(),t.sendInvitation({referralProgramId:r.referralProgramId,referralPersonaIds:[r.personaId]}).then(function(){var e;i.openDirective({id:t_,name:t_,size:OI,data:(e={},Ws(e,s_,r.referralProgramId),Ws(e,c_,r.subscriptionType),Ws(e,l_,r.referralLimit),Ws(e,g_,r.username),e)})}).catch(function(){i.openAlert({id:i_,title:n.getLocalizedStr(null,rW,"friendreferral-invitation-error-title"),description:n.getLocalizedStr(null,rW,"friendreferral-invitation-error-desc"),rejectText:n.getLocalizedStr(null,rW,"closeprompt")})})}},template:XV}}function Ys(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function Ks(e,t,i,n,r,o){"ngInject";if(e.facet){var a={filterQuery:e.facet,facetField:"",sort:cW,start:0,rows:uW};i.searchStore("",a).then(function(i){var n=_.get(i,[lW,dW],[]);if(n.length){var a=_.map(n,function(e){var i=_.get(e,DI._12,"");return t.getCatalogByPath(i)});if(e.paths){var s=e.paths.split(",");a=[].concat(Ys(_.map(s,t.getCatalogByPath)),Ys(a))}!function(t){Promise.all(t).then(r.unwrapEditions).then(function(t){e[hW]=_.chunk(_.uniqBy(t,function(e){return e.i18n.packArtMedium}),4),e[vW]=e[hW][0]}).catch(function(){e[hW]=[],e[vW]=[]}).finally(function(){return o.digestIfDigestNotInProgress(e)})}(a)}}).catch(function(e){return n.error("[StoreSearchFactory: SearchFactory.searchStore] failed",e)})}}function Qs(e,t,i,n,r,o,a,s){"ngInject";e.searchString=e.searchString||"",e.facetData=e.facetData||"",e.orderBy=e.orderBy||SW.Rank,e.direction=e.direction||yW.descending,e.limit=e.limit||10,e.offset=e.offset||0,e.models=[],e.controlButtonColor||(e.controlButtonColor=kW.dark);var c={filterQuery:e.facetData,sort:e.orderBy+" "+e.direction,start:e.offset,rows:e.limit};e.paths?(e.paths=e.paths.split(","),s.getByOcdPath(e.paths).attachToScope(e,function(i){t.trigger(IW),e.models=i})):r.searchStore(e.searchString,c).then(n.getProperty(["games","game"])).then(function(i){if(i){e.offers=i,t.trigger(IW);var r=_.values(n.map(n.getProperty("gameId"),i));a.getCatalogInfo(r).then(function(t){e.models=t})}else e.offers=[],t.trigger(wW),angular.element(t).slideUp()}).catch(function(e){o.error("[origin-store-access-carousel SearchFactory.searchStore] failed",e)})}function Js(e,t){"ngInject";e.strings={subtitle:t.getLocalizedStr(e.subtitle,TW,"subtitle"),header:t.getLocalizedStr(e.header,TW,"header"),platform:t.getLocalizedStr(e.platform,TW,"platform")}}function Xs(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m){"ngInject";function f(t){var i,n,r;s.openDirective({id:uI,name:gI,size:_I,data:(i={template:_W,mode:t,id:uI},n="friend-referral-token",r=e.friendReferralToken,n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i)})}e.type=e.type||FW,e.btnClick=function(){if(_.get(e,LW))i.promiseLogin().then(function(){return p.validateCurrentStorefront()}).then(function(){(AW.indexOf(e.mode)>-1?t.getOriginAccessCtaMode(e.mode):t.getMembershipChangeMode()).then(f).catch(function(e){m.showDialog(e)})}).catch(p.handleWrongStorefrontError);else if(e.offerId)if(-1===e.offerId.indexOf(",")){var n=i.isAppLoggedIn();i.promiseLogin().then(function(){return function(t){e.chainOfferId?a.getOfferIdByPath(l.buildPathFromUrl()).then(_.partial(c.chainCheckout,e.highlightedOfferId)):c.subscriptionCheckout(e.offerId,t)}(n)})}else!function(){if(d.isOIGContext())g.goToState(xW);else{var t=e.chainOfferId?u.subscribeSaveTemplate:u.template,i=u.id;s.openDirective({id:i,name:OW,size:_I,data:{template:t,modal:i}})}}()},e.chainOfferId&&a.getOfferIdByPath(l.buildPathFromUrl()).then(function(t){return o.getPrice([t,e.chainOfferId],"SUBSCRIPTIONS",!0)}).then(function(e){var t=0;return _.forEach(e,function(e){t+=_.get(e,["rating",0,"finalTotalAmount"],0)}),r.formatCurrency(t)}).then(function(t){e.button=n.getLocalizedStr(e.button,EW,"button",{"%price%":t}),e.$digest()}).catch(function(){e.button=n.getLocalizedStr(e.button,EW,"button",{"%price%":""}),e.$digest()})}function Zs(e,t,i){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",legal:"@",buttonText:"@",offerId:"@",small:"@"},template:RW,link:function(n,r){function o(){i.isXSmall()?a.hasClass($W)&&a.removeClass($W):i.isOnOrAboveScreen(a)&&a.hasClass($W)?a.removeClass($W):i.isOnOrAboveScreen(a)||a.hasClass($W)||a.addClass($W)}var a=r.find("."+$W);n.slice=e.getImagePath("store/right-corner.png"),t.addScrollEventHandler(n,o),o()}}}function ec(e,t,i,n){"ngInject";e.leftSlice=t.getImagePath("store/left-corner.png"),e.rightSlice=t.getImagePath("store/right-corner.png"),e.strings={subtitle:i.getLocalizedStr(e.subtitle,GW,"subtitle"),buttonText:i.getLocalizedStr(e.buttonText,GW,"button-text"),subscription:i.getLocalizedStr(e.subscription,GW,"subscription"),platform:i.getLocalizedStr(e.platform,GW,"platform")},n.insertPriceIntoLocalizedStr(e,e.strings,e.titleStr,GW,"titlestr")}function tc(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(e,t,i){return!e||!m&&t?!m&&t?t.replace("%date%",p).replace("%game%",i):void 0:e.replace("%game%",i).replace("%date%",h)}function u(i){e.strings={header:g(e.header,e.trialHeader),description:g(e.description,e.trialDescription,i),buttonText:g(e.buttonText,e.trialButtonText),stepOne:g(e.stepOne,""),stepTwo:g(e.stepTwo,""),stepHeader:g(e.stepHeader,""),stepSubtitle:g(e.stepSubtitle,""),stepGameName:g(e.stepGameName,"",i),stepDiscount:g(e.stepDiscount,"")},t.digestIfDigestNotInProgress(e)}var p,m=l.hasUsedFreeTrial(),f=e.stepOne?n.buildPathFromUrl():void 0,h=l.userHasSubscription()?moment(l.getExpiration()).format("LL"):"";r.populateScope(e,BW),e.eaplayImagePath=d.getImagePath("access/EAP-condensed.svg"),e.onClick=function(){if(e.highlightedOfferId){o.close(a.id);var t=s.isAppLoggedIn();s.promiseLogin().then(function(){return function(t){_.isUndefined(f)?c.subscriptionCheckout(e.highlightedOfferId,t):i.getOfferIdByPath(f).then(_.partial(c.chainCheckout,e.highlightedOfferId))}(t)})}},this.setHighlightedOfferId=function(i,n){p=moment().add(n,"d").format("LL"),e.highlightedOfferId=i,e.$broadcast("originStoreAccessInterstitial:highlightOffer",{offerId:i}),t.digestIfDigestNotInProgress(e)},f?i.getCatalogByPath(f).then(function(e){return _.get(_.head(_.values(e)),["i18n","displayName"],"")}).then(u).catch(_.partial(u,"")):u("")}function ic(e,t,i,n,r){"ngInject";e.strings={save:n.getLocalizedStr(e.save,HW,"save"),value:n.getLocalizedStr(e.value,HW,"value"),duration:n.getLocalizedStr(e.duration,HW,"duration")},t.insertPriceIntoLocalizedStr(e,e.strings,e.price,HW,"price"),e.$on("originStoreAccessInterstitial:highlightOffer",function(t,i){_.get(i,"offerId")===_.get(e,"offerId")||_.get(i,"offerId")===_.get(e,"trialOfferId")?e.highlight=zW.true:e.highlight=zW.false}),e.hasUserUsedFreeTrial=i.hasUsedFreeTrial(),e.eaplayImagePath=r.getImagePath("access/EAP-condensed.svg")}function nc(e){"ngInject";return{restrict:"E",require:"^originStoreAccessInterstitial",replace:!0,scope:{offerId:"@",trialOfferId:"@",value:"@",save:"@",highlight:"@",duration:"@",price:"@"},controller:ic,template:jW,link:function(t,i,n,r){var o=t.trialOfferId?[t.trialOfferId]:[t.offerId];e.getCatalogInfo(o).then(function(e){_.set(t,"model",_.head(_.values(e))),t.highlight===zW.true&&t.highlightOffer()}),t.highlightOffer=function(){!t.hasUserUsedFreeTrial&&t.trialOfferId?r.setHighlightedOfferId(_.get(t,"trialOfferId"),_.get(t,["model","duration"])):r.setHighlightedOfferId(_.get(t,"offerId"))}}}}function rc(e,t,i){"ngInject";e.strings={},i.getVaultGamesCount().then(function(i){var n={};n[dw]=_.get(i,[yI.y.STANDARD,yI.d]),n[gw]=_.get(i,[yI.y.PREMIUM,yI.d]),t.insertPriceIntoLocalizedStr(e,e.strings,e.text,WW,"text",n)}),e.disableItem=e.disabled===OS.true}function oc(e){"ngInject";var t=this;t.$onInit=function(){t.strings={legalText:e.getLocalizedStr(t.legalText,qW,"legal-text")}}}function ac(e,t,i,n){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",background:"@",image:"@",alignment:"@",legal:"@"},template:QW,link:function(r,o){function a(){if(s.length&&!n.isSmall()){var e=o.offset().top-0,i="translate3d(0,"+((window.pageYOffset-e)/ZW).toFixed(2)+"px, 0)";s.css(t.addVendorPrefixes("transform",i))}n.isXSmall()?c.hasClass(JW)&&c.removeClass(JW):n.isOnOrAboveScreen(c)&&c.hasClass(JW)?c.removeClass(JW):n.isOnOrAboveScreen(c)||c.hasClass(JW)||c.addClass(JW)}var s=o.find(XW),c=o.find("."+JW);r.leftSlice=e.getImagePath("store/left-corner.png"),r.rightSlice=e.getImagePath("store/right-corner.png"),i.addScrollEventHandler(r,a),i.addResizeEventHandler(r,function(){n.isSmall()&&s.length&&s.removeAttr("style")},100),a()}}}function sc(e,t,i,n,r,o,a,s){"ngInject";e.games=[],e.isLoading=!0;var c=o.getUserSubscriptionInfo(),l=_.size(_.get(c,["userVault","game"],[])),d=!1,g=0,u=void 0,p=function(){e.isLoading=!0;var t,i,n=u[g],r=_.map(n,"masterTitleId"),s=_.compact(_.map(r,o.getVaultGameFromMasterTitleId));!function(e,t){_.forEach(e,function(e){var i=_.find(t,function(t){return e.masterTitleIds.masterTitleId.indexOf(t.masterTitleId)>-1});_.set(e,"projectId",_.get(i,"projectId",""))})}(s,n),(t=s,i=void 0,_.forEach(t,function(e,t){_.get(e,["masterTitleIds","masterTitleId"]).indexOf(iq)>-1&&(i=t)}),i?a.getPurchasableOfferIdByMasterTitleId(iq).then(function(e){return _.set(t,[i,"offerId"],e),t}):Promise.resolve(t)).then(m)},m=function(t){d=++g<_.size(u),s.staggerLoadGameTiles(e,e.games,t)},f=function(){e.isLoading=!1,d=!1,e.$digest(),t.after(i("<origin-store-access-vault></origin-store-access-vault>")(e)),t.remove()};n.retrieveRecommendedGames(Origin.pin.getVaultGameRecommendation,l).then(function(t){return e.recoType=_.get(t,[nq,0,rq,oq,aq],""),e.recoTag=_.get(t,[nq,0,rq,sq],""),t}).then(r.extractRecoGamesFromResponse).then(function(e){_.isEmpty(e)?f():(u=_.chunk(e,tq),p())}).catch(f),e.loadMore=function(){return Promise.resolve().then(p)},e.lazyLoadDisabled=function(){return e.isLoading||!d}}function cc(e,t){"ngInject";e.strings={},e.btnColor="dark"===e.color?"dark":"transparent",t.insertPriceIntoLocalizedStr(e,e.strings,e.header,lq,"header")}function lc(e,t,i,n){"ngInject";e.games=[],e.isLoading=!0;var r=!1,o=0,a=function(t){if(o=_.get(e,["games","length"],0)+_.get(t,["games","numVisible"],0),r=o<_.get(t,["games","numFound"],0),t.games){var i=_.get(t,["games","game"],[]);n.staggerLoadGameTiles(e,e.games,i)}e.$digest()};e.loadMore=function(){return Promise.resolve().then(e.search)},e.lazyLoadDisabled=function(){return e.isLoading||!r},e.search=function(){e.isLoading=!0;var n={filterQuery:"subscriptionGroup:vault-games",facetField:"",sort:"rank desc",start:o,rows:uq,showOfferId:!0};t.searchStore("",n).then(a).catch(function(e){i.error("[StoreSearchFactory: SearchFactory.searchStore] failed",e)})}}function dc(e){"ngInject";return{restrict:"E",scope:{redirectToGdp:"@"},controller:lc,template:gq,link:function(t){e(t.search,0,!1)}}}function gc(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function uc(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",transclude:!0,scope:{filterQuery:"@",customRank:"@",whiteList:"@",blackList:"@",addToOrderText:"@"},link:function(s){function c(e){return _.isArray(e)&&e[1]?e[1]:""}function l(e){return a.getBundleModelsList().some(function(t){return(n.getRawBundle()||[]).includes(t.offerId)&&t.bundleOffers.includes(e)})}function d(e){return a.getBundleModelsList().some(function(t){return(n.getRawBundle()||[]).some(function(e){return t.bundleOffers.includes(e)})&&t.offerId===e})}function g(){s.openTileIndex=null,v&&(v.gameDrawerElement.remove(),v.tileElement.css(Lq,""),_.isFunction(v.closeTile)&&v.closeTile()),v=null}function u(e){o.validateCurrentStorefront().then(function(){return function(e){var t=a.getBundleModelsList().find(function(t){return t.offerId===e})||{},i=_.intersection(n.getRawBundle(),t.bundleOffers);i.length&&n.removeAll(i.map(function(e){return{offerId:e}})),n.add(e)}(e)}).catch(o.handleWrongStorefrontError)}function p(e){v.tileElement.css(Lq,e+xq)}function m(){if(v){v.scope.isSingleTitleInAddedBundleTitle=l(v.selectedOffer.offerId),v.scope.isBundleTitleOfAddedSingleTitle=d(v.selectedOffer.offerId);var e=v.scope.disabled,t=v&&h(v.selectedOffer.offerId,v.siblings);e!==t&&(v.scope.disabled=t)}}function f(){g()}function h(e,t){return n.has(e)||_.isArray(t)&&t.some(function(e){return n.has(e.offerId)})}var v=void 0;a.cleanBundleModelsList(),s.whiteListArray=s.whiteList?s.whiteList.split(","):[],s.blackListArray=s.blackList?s.blackList.split(","):[],s.isGdp=!0,s.openTileIndex=null,s.isGameDrawerCtaDisabled=!1,setTimeout(function(){var i=_.uniq(_.map(t.extractFacetValuesFromQuery(s.filterQuery),c).concat(Fq));s.search(),e.events.fire(bq,i),s.$digest()}),s.$on(Sq,function(e,t,n,o,a,c){g();var m=t.parent();s.openTileIndex=m.index();var f={ocdPath:n.gdpPath,onCtaClicked:u,onHeightChange:p,gameName:a,disabled:h(n.offerId,o),isSingleTitleInAddedBundleTitle:l(n.offerId),isBundleTitleOfAddedSingleTitle:d(n.offerId)},b=i.appendBundleGameDrawer(m,s,f);setTimeout(function(){var e,t,n,o,a;i.scrollToOpenDrawer((a=document.querySelector(".origin-bundlemain-cart"),e=a?a.offsetHeight:0,t=r.getTotalHeight(),o=document.querySelector(".origin-navigation-ismobile .origin-navigation-top"),n=o?o.offsetHeight:0,e+t+n))},0),v=function(e,t,i,n,r){return{scope:e,tileElement:t,gameDrawerElement:t.find(Oq),selectedOffer:i,siblings:n,closeTile:r}}(b,m,n,o,c)}),n.events.on(Ey.m,m),e.events.on(Ey.L,f),e.events.on(Ey.C,s.resetSavedSortString),s.$on(kq,g),s.$on(Ey.E,g),s.$on("$destroy",function(){n.events.off(Ey.m,m),e.events.off(Ey.L,f),e.events.off(Ey.C,s.resetSavedSortString)})},controller:"OriginStoreBrowseCtrl",template:vq}}function pc(e,t,i,n){"ngInject";e.removeFromBundle=function(){i.remove(e.offerId),_.debounce(function(){n.events.fire(Ey.n)},250)};var r=e.$watch("offerId",function(i){i&&(t.getByOfferId(i).attachToScope(e,"model"),r())})}function mc(e,t,i,n,r,o,a,s,c){"ngInject";function l(t,i){return o.getLocalizedStr(e.strings[_.camelCase(t)],Gq,t,i)}function d(t){var i=t.totalPriceWithoutTax,r=t.totalDiscountAmount,o=i+r;return Promise.all([n.formatCurrency(o),n.formatCurrency(i),n.formatCurrency(r)]).then(function(t){var n,a=Nq(t,3),c=a[0],d=a[1],g=a[2];c=c||Uq,d=d||Uq,g=l("discount-price",{"%discountPrice%":n=g||Uq})||n;var u=function(e){var t=e||Uq;return l("buy-text",{"%price%":t})||t}(d);e.bundlePrice={subTotal:o,total:i,discount:r,subTotalPrice:c,totalPrice:d,discountPrice:g,buyPrice:u},e.hasPricingError=!1,e.hideBundlePricingInfo=!1,e.$digest(),s.events.fire(Ey.n)})}function g(){e.hasPricingError=!0,e.hideBundlePricingInfo=!0,e.$digest()}r.getAll(e.bundleId).attachToScope(e,"bundle"),e.isFilterPanelOpen=!1,e.buyNow=function(){var i={checkoutType:c.NO_XSELLUPSELL};e.bundle.length&&e.bundlePrice&&(e.bundlePrice.total>0?t.buy(e.bundle,i):0===e.bundlePrice.total&&t.freeEntitle(e.bundle))},e.$watchCollection("bundle",function(t){t.length>0?i.getCartRating(t).then(d).catch(g):(e.bundlePrice={subTotal:0,total:0,discount:0},e.hasPricingError=!1,e.hideBundlePricingInfo=!0)}),e.onClickFilterBtn=function(){a.toggleEmbeddedFilterpanel(),e.isFilterPanelOpen=!e.isFilterPanelOpen},e.$on("$destroy",function(){a.unregisterFilterPanelToggleBtn()}),a.registerFilterPanelToggleBtn(),a.getObserver().attachToScope(e,"states")}function fc(e){"ngInject";return{replace:!0,restrict:"E",require:["?^originStoreBundleMain"],transclude:!0,link:function(t,i,n,r){var o=Nq(r,1)[0];t.bundlePrice={subTotal:0,total:0,discount:0},t.strings=_.isFunction(_.get(o,"getTranslations"))?o.getTranslations():{},t.bundleId=_.isFunction(_.get(o,"getBundleId"))?o.getBundleId():null,t.strings.discountText=e.getLocalizedStr(t.discountText,Gq,"discount-text")},template:$q,controller:mc}}function hc(e,t,i,n,r){"ngInject";function o(){var t,i=d.get(0),n=window.pageYOffset||document.documentElement.scrollTop,r=l.length&&"none"!==l.css("display")?l.height():0,o=n>i.offsetHeight+r;e.isPinned!==o&&(e.isPinned=o,c(),t=o,_.isFunction(e.onPinStateChanged)&&e.onPinStateChanged({newState:t}))}function a(){o(),e.$digest()}function s(t){_.isFunction(e.onMarginUpdate)&&e.onMarginUpdate({margin:t})}function c(){var t=d.get(0),i=p.length?0:Mq;t&&e.isPinned?(s(e.globalStripeMargin),g.css(jq,u.offsetHeight+i+"px")):(s(0),g.css(jq,""))}e.isPinned=!1,e.globalStripeMargin=0,e.isTextDark=e.isDarkText===OS.true,e.isScrimShown=e.hideScrim!==OS.true,e.showHeaderSection=!!(e.titleStr||e.description||e.learnMoreLink&&e.learnMoreStr);var l=angular.element(".origin-store-sitestripe-wrapper"),d=t.find(".origin-storebundlehero"),g=angular.element(".origin-bundlemain-offerlist"),u=document.querySelector(".origin-bundlemain-cart"),p=angular.element(".origin-store-softbundle-section-title");i.addScrollEventHandler(e,a,Bq),i.addResizeEventHandler(e,a,Bq),e.updateHeroMargin=function(t){e.globalStripeMargin=t,d.css("margin-top",e.isPinned&&d.length?t:""),c()},e.openExternalLearnMoreWindow=function(t){t&&(t.stopPropagation(),t.preventDefault()),r.externalUrl(e.learnMoreLink,!0)},o()}function vc(e,t,i,n,r){"ngInject";e.isDarkText=e.textColor===ES.dark,e.notifyCarousel=function(){i.events.fire(Ey.n)},t.setCurrentBundleId(e.bundleId),this.getTranslations=function(){return{yourBundleText:n.getLocalizedStr(e.yourBundleText,Wq,"your-bundle-text"),buyNowText:n.getLocalizedStr(e.buyNowText,Wq,"buy-now-text"),subtotalText:n.getLocalizedStr(e.subtotalText,Wq,"subtotal-text"),totalText:n.getLocalizedStr(e.totalText,Wq,"total-text"),emptyBundleText:n.getLocalizedStr(e.emptyBundleText,Wq,"empty-bundle-text"),emptyPopoverCartText:n.getLocalizedStr(e.emptyPopoverCartText,Wq,"empty-popover-cart-text"),sortFilterText:n.getLocalizedStr(e.sortFilterText,Wq,"sort-filter-text"),pricingErrorMessage:n.getLocalizedStr(void 0,Wq,"pricing-error-message")}},this.getBundleId=function(){return e.bundleId},r.getObserver().attachToScope(e,"states")}function bc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yc(){function e(e,t){return!!Qq[e]&&Qq[e].indexOf(t)>=0}function t(e){if(e)return _.get(e,DI.y)}function i(i){return e(t(i),"oth")}function n(i){return e(t(i),"demo")}function r(i){return e(t(i),"alpha")}function o(i){return e(t(i),"beta")}function a(i){return e(t(i),"early access")}function s(e){return _.get(e,DI.N,!1)}function c(e){return _.get(e,[DI.e,DI.M],!1)}function l(e){return"Full Game"===_.get(e,DI._8)}function d(e){return"Full Game Plus Expansion"===_.get(e,DI._8)}function g(e){return"Addon"===_.get(e,DI._8)}function u(e){return"dlc"===(_.get(e,DI.D)||"").toLowerCase()}function p(e){return"Expansion"===_.get(e,DI._8)}function m(e){var t=_.get(e,"platformFacetKey");return t?"Mac/PC Download"===t||"Mac/PC Disc"===t:"PCWIN"===_.get(e,[DI._15,"PCWIN","platform"])&&"MAC"===_.get(e,[DI._15,"MAC","platform"])}function f(e){return("bundles"===_.get(e,"type")||_.get(e,DI.R)===DI.d||_.get(e,DI.R)===DI.v&&_.get(e,DI.x,"")===eY||_.get(e,DI._3)===DI.d)&&!_.isUndefined(_.get(e,DI.c))&&!_.isEmpty(_.get(e,DI.c))}return{getSubTypePriority:function(e){return Jq[e]||0},getSteamAppId:function(e){if(e){var t=_.get(e,"firstParties",[]).filter(function(e){return"Steam"===e.partner&&"Content ID"===e.partnerIdType});return _.get(t,[0,"partnerId"])}},isDigitalIto:function(e){return _.get(e,[DI.h,DI.j],!1)},isTrial:function(i){return!a(i)&&(e(t(i),"trial")||"trial"===_.get(i,"type")||"trial"===_.get(i,"gameTypeFacetKey"))},isLimitedTrial:function(i){return e(t(i),"limited trial")},isOnTheHouse:i,isNormalGame:function(i){return e(t(i),"normal")},is3PddOnlyGame:function(i){return e(t(i),"3PDD Only")},isDemo:n,isAlpha:r,isBeta:o,isAlphaBetaDemo:function(e){return r(e)||o(e)||n(e)},isAlphaBeta:function(e){return r(e)||o(e)},isEarlyAccessTrial:a,isAlphaTrialDemoOrBeta:function(e){return e.trial||e.beta||e.demo||e.earlyAccess||e.limitedTrial||e.alpha},isPurchasable:s,isFullGame:l,isFullGamePlusExpansion:d,isDownloadable:function(e){return!!_.get(e,"downloadable")},isAddon:g,isExpansion:p,isExtraContent:function(e){return d(e)||g(e)||p(e)},isBaseGameOriginDisplayType:function(e){return l(e)||d(e)},isHybridGame:m,isPcGame:function(e){return m(e)||e.platforms.indexOf("PCWIN")>=0},isMacGame:function(e){return m(e)||e.platforms.indexOf("MAC")>=0},isCurrency:function(e){return"currency"===_.get(e,"gameTypeFacetKey")||"currency"===_.get(e,"type")},isBundle:f,hasBundleOffers:function(e){return!_.isUndefined(_.get(e,DI.c))&&!_.isEmpty(_.get(e,DI.c))},isSubscription:function(e){return"Subscription"===_.get(e,DI._3)},isBaseGameOfferType:function(e){var t=_.get(e,"type")||"";return("Base Game"===_.get(e,DI._3)||f(e))&&!u(e)&&"dlc"!==t.toLowerCase()&&_.get(e,DI.R)!==DI.v},isBrowserGame:function(e,t){var i=_.get(e,[DI._15,"PCWIN","executePathOverride"]);return!!i&&"["!==i.charAt(0)&&-1!==i.indexOf("http")&&(0===_.get(e,"price")||t)},isOwnedOutright:function(e){return _.get(e,DI.K,!1)&&!_.get(e,DI._33,!1)&&!_.get(e,"firstPartyVaultEntitlement",!1)},isShellBundle:function(e){return _.get(e,"isShellBundle",!1)},isOwnedThroughVault:function(e){return _.get(e,DI.K,!1)&&_.get(e,DI._33,!1)},isOwned:function(e){return _.get(e,"isOwned",!1)},isOnlineSubscription:function(e){return _.get(e,"gameTypeFacetKey","")===Xq||_.get(e,"type","")===Xq},SUBTYPES:Qq,isFreeGame:function(e){return _.get(e,"type","")===Zq||_.get(e,"gameTypeFacetKey","")===Zq},isFreeToEntitle:function(e,t){return i(e)||0===_.get(e,"price")||0===_.get(_.head(t),["rating","0","finalTotalAmount"])},hasSiblings:function(e){return _.size(_.get(e,"siblings",[]))>0},isDLC:function(e){return"Expansion Pack"===e.mdmItemType||"Microcontent"===e.mdmItemType||"Extra Content"===e.itemType},isDlcFacetKey:u,isExpansionFacetKey:function(e){return"expansion"===_.get(e,"gameTypeFacetKey")},isGameGiveAwaySubType:function(e){return"Game Giveaway"===_.get(e,DI.y,"")},hasSoftDependency:function(e){return _.size(_.get(e,"softDependency",[]))>0},isNotPurchasableAndNotVaultGame:function(e){return!s(e)&&!_.get(e,"vault",!1)&&!_.get(e,[DI._16,DI.L],!1)},isRepurchasable:function(e){return _.get(e,DI.O,!1)},isGameClientDownloadable:function(e){return!!e&&Origin.client.onlineStatus.isOnline()&&Origin.client.isEmbeddedBrowser()&&!e.isWrongArchitecture&&!e.playable&&!(e.progressInfo&&e.progressInfo.active)&&!e.installed&&e.downloadable},isPublished:c,isNoneType:function(e){return"None"===_.get(e,DI._8)},isDigitalRefundAllowed:function(e){return _.get(e,DI.a,!1)},isPurchasableWithVirtualCurrency:function(e){var t=_.get(e,[DI.e,DI.f]);return DI._37.includes(t)},isGameOnlyExpansion:function(e){return"Game Only"===_.get(e,DI._8)},hasFirstPartyPass:function(e){if(e)return(e=_.isArray(e)?e:[e]).some(function(e){return _.get(e,"firstParties",[]).some(function(e){return"Online Pass"===e.partnerIdFlag})})},isFirstPartyOffer:function(e){var t=_.get(e,"firstParties",[]);return!c(e)&&t.length>0},isZeroPricedOffer:function(e){return _.get(e,DI.Q,!1)}}}function Sc(e,t){if(e.isGameName){if(0===t.basegames.length)return Promise.reject({reason:iY,model:t});if(_.every(t.basegames,oY.isNotPurchasableAndNotVaultGame)&&!_.some(t.basegames,{isAnnouncement:!0}))return Promise.reject({reason:nY,model:t})}else if(e.isCurrency){if(0===t.currency.length)return Promise.reject({reason:iY,model:t})}else if(e.isExpansion||e.isAddon){if(0===t.addon.length&&0===t.expansion.length)return Promise.reject({reason:iY,model:t})}else if(e.isGameTime){if(0===t[DI.C].length)return Promise.reject({reason:iY,model:t});if("Subscription"===t[DI.C][0][DI._3])return Promise.reject({reason:iY,model:t})}return Promise.resolve(t)}function kc(){}function Ic(e,t,i,n,r,o){"ngInject";e.carouselState={},e.carouselState.current=0,e.carouselState.slides=void 0,e.carouselState.animationRunning=!1,e.carouselState.focus=!1,e.carouselState.autoRotate=!0,e.carouselState.stationaryPeriod=5e3,e.stopAutoRotate=function(){t.cancel(e._autoRotate)},e.autoRotateOn=function(){e.stopAutoRotate(),e.carouselState.slides.length>1&&e.carouselState.autoRotate&&(e._autoRotate=t(function(){e.goTo(e.carouselState.current+1)},e.carouselState.stationaryPeriod))},e.postSlide=function(){e.carouselState.animationRunning=!1,e.carouselState.slides.each(function(e,t){var i=[r.next,r.previous,r.left,r.right,r.current].join(" ");$(t).removeClass(i)}),e.carouselState.slides.eq(e.carouselState.current).addClass(r.current),n.events.fire(o.transitioned),e.autoRotateOn(),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_CAROUSEL_ROTATE_EVENT)},e.goTo=function(n){if(void 0!==n&&n!==e.carouselState.current&&1!==e.carouselState.slides.length&&!e.carouselState.animationRunning){var o=function(e,t,i){var n=e<t?"l":"r";return t>i&&(n="r"),n}(e.carouselState.current,n,e.carouselState.slides.length);n<0&&(n=e.carouselState.slides.length-1),n>=e.carouselState.slides.length&&(n=0),e.carouselState.animationRunning=!0,e._autoRotate&&t.cancel(e._autoRotate);var a=void 0;"l"===o?(a=r.next,o=r.left):(a=r.previous,o=r.right),function(e,t,n,r){e.carouselState.slides.eq(t).addClass(n),i.onTransitionEnd(e.carouselState.slides.eq(e.carouselState.current),e.postSlide),setTimeout(function(){e.carouselState.slides.eq(t).addClass(r),e.carouselState.slides.eq(e.carouselState.current).addClass(r),e.carouselState.current=t,e.$digest()},25)}(e,n,a,o)}},this.goToNext=function(){e.goTo(e.carouselState.current+1)},this.goToPrev=function(){e.goTo(e.carouselState.current-1)},e.$on("$destroy",e.stopAutoRotate)}function wc(e,t,i,n,r,o){"ngInject";return{restrict:"A",scope:{alignment:"@",stationaryPeriod:"@",autoRotate:"@",socialMediaTitle:"@",socialMediaDescription:"@",hideFacebook:"@",socialMediaImage:"@",showSocialMedia:"@showsocialmedia"},controller:Ic,link:function(a,s,c,l){function d(){a.carouselState.focus=!0,a.stopAutoRotate(),a.$digest()}function g(){a.carouselState.focus=!1,a.autoRotateOn(),a.$digest()}function u(){a.carouselState.slides=a.carouselState.hiddenSlides,a.carouselState.hiddenSlides.each(function(e,t){$(t).attr("goal-date")&&(a.carouselState.current=e)}),a.carouselState.timers=[],p()}function p(){a.carouselState.timers.length<=0?a.carouselState.slides=a.carouselState.hiddenSlides:a.carouselState.slides=a.carouselState.timers,a.carouselState.slides.eq(a.carouselState.current).addClass(i.current),t.events.fire(n.initialized),a.$on("goTo",function(e,t){e.stopPropagation(),a.goTo(t.slideNumber)}),a.autoRotateOn(),e.isTouchEnabled()?(a.carouselState.focus=!0,s.on("swipeleft",l.goToNext),s.on("swiperight",l.goToPrev)):s.hover(d,g)}setTimeout(function(){var e,t,i=s.find(".origin-store-carousel-container"),n=i.children().addClass("origin-store-carousel-content origin-telemetry-store-carousel-content");a.carouselState.timers=n.filter("[goal-date]"),a.carouselState.hiddenSlides=n,a.carouselState.timers.each(function(e,t){var i=$(t).attr("goal-date");a.carouselState.timerEnd=new Date(i).getTime()-(new Date).getTime(),o(u,a.carouselState.timerEnd)}),a.carouselState.autoRotate=void 0===uY[a.autoRotate]||uY[a.autoRotate],delete a.autoRotate,a.carouselState.stationaryPeriod=void 0!==a.stationaryPeriod?a.stationaryPeriod:a.carouselState.stationaryPeriod,delete a.stationaryPeriod,e=r('<origin-store-carousel-hero-indicators carousel-state="carouselState"></origin-store-carousel-hero-indicators>')(a),t=r('<origin-store-carousel-hero-controls carousel-state="carouselState"></origin-store-carousel-hero-controls>')(a),s.append(e),s.append(t),a.showSocialMedia===OS.true&&function(){a.isFacebookHidden=a.hideFacebook===OS.true;var e='<origin-socialmedia theme="'+tk.lightWithBackground+'" title-str="{{::socialMediaTitle}}" hide-facebook="{{::isFacebookHidden}}"></origin-socialmedia>',t=r(e)(a);s.append(t)}(),p(),i.removeClass("origin-store-carousel-container-initiating"),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_CAROUSEL_ROTATE_EVENT)},0)}}}function Cc(e){"ngInject";e.goTo=function(t){e.$emit("goTo",{slideNumber:t})},e.$on("hideControls",function(){e.show=!1}),e.$on("showControls",function(){e.show=!0}),e.show=!0}function Tc(e,t,i,n,r){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{type:"@",limit:"@",offset:"@",sort:"@",dir:"@",facet:"@",query:"@",shade:"@"},template:hY,link:function(o,a){function s(e){var t=document.createElement("div");return angular.element(t).addClass(wY),e&&angular.element(t).css("width",e),t}function c(e){o.totalWidth+=angular.element(e).outerWidth(),o.totalWidth+=parseInt(angular.element(e).css("margin-left"),10),o.totalWidth+=parseInt(angular.element(e).css("margin-right"),10),1!==_.size(a.children().find(PY))&&(y=angular.element(e).outerWidth()+parseInt(angular.element(e).css("margin-left"),10)+parseInt(angular.element(e).css("margin-right"),10),0===v&&(v++,a.find(IY).html(s())),(b+=y)<=a.outerWidth()||f?(f=!1,angular.element(a.find("."+wY)[v-1]).css("width",b+"px")):(a.find(IY).append(s()),b=y,v++,angular.element(a.find("."+wY)[v-1]).css("width",b+"px")))}function l(){var e=-Math.abs((o.totalWidth-a.outerWidth())/2);o.activePill=Math.floor(o.pills/2),p(e)}function d(){return o.pills%2!=0}function g(){return _.size(a.children().find(PY))>0}function u(){var e=(m=a.find("."+kY)).children(),t=a.outerWidth();if(v=0,b=0,y=0,f=!0,o.totalWidth=0,_.forEach(e,c),1===_.size(a.children().find(PY))&&function(){var e,t=a.outerWidth(),i=o.totalWidth-t,n=a.find(IY);if(n.html(s(t)),i>0&&t)for(var r=Math.ceil(Math.ceil(i/t)/2),c=0;c<r;c++)e=i/2>t?t:i/2,n.append(s(e)).prepend(s(e)),i-=2*t;v=_.size(n.children())}(),h=o.totalWidth>t?t-o.totalWidth:0,m.css("width",o.totalWidth+"px"),a.find(IY).css("width",o.totalWidth+"px"),o.pills=v,S&&o.activePill!==Math.floor(o.pills/2)||!d()||!g()){var i=o.activePill>=v?v-1:o.activePill;o.jumpSlide(i,!1)}else l()}function p(e){e>0?e=0:e<h&&(e=h),m.css(n.addVendorPrefixes("transform","translateX("+e+"px)"))}var m,f,h=0,v=0,b=0,y=0,S=!1;if(o.totalWidth=0,o.pills=0,o.activePill=0,o.slideCarousel=function(e){if(e===vY.left)if(0===o.activePill)o.activePill=o.pills-1;else{if(o.activePill===Math.floor(o.pills/2)+1&&d()&&g())return void l();o.activePill--}else if(e===vY.right)if(o.activePill===o.pills-1)o.activePill=0;else{if(o.activePill===Math.floor(o.pills/2)-1&&d()&&g())return void l();o.activePill++}o.jumpSlide(o.activePill,!0)},o.getPills=function(e){return new Array(e)},o.jumpSlide=function(e,t){var i=$(a.find("."+wY)[e]);_.size(i)>0&&(p(-Math.abs(i.position().left)),o.activePill=e),t&&(S=!0)},e.addResizeEventHandler(o,u,_Y),o.type===SY.merchandised)a.find(CY).remove(),setTimeout(u,0);else{a.find(TY).removeClass(kY).empty(),o.$watchOnce("ocdPaths",function(e,t){e===t||_.isEmpty(e)||u()}),o.query=o.query||"",o.facet=o.facet||"",o.sort=yY[o.sort]||yY.rank,o.dir=o.dir||bY.ascending,o.limit=o.limit||30,o.offset=o.offset||0;var k={filterQuery:o.facet,sort:o.sort+" "+o.dir,start:o.offset,rows:o.limit};t.searchStore(o.query,k).then(i.getProperty(["games","game"])).then(function(e){o.ocdPaths=e||[]}).catch(function(){o.ocdPaths=[]})}r.events.on("uiRouter:stateChangeAnimationComplete",u),o.$on("$destroy",function(){r.events.off("uiRouter:stateChangeAnimationComplete",u)}),o.$on("originStoreCarousel:gameTileRemoved",_.debounce(u,50))}}}function Pc(e,t,i,n,r){"ngInject";i.populateScope(e,xY).then(function(){e.shade=FY[e.shade]||FY.light,e.ctaShade=e.ctaShade||EY.orange,e.strings={},e.isExternalUrl=e.ctaHref&&!r.isInternalUrl(e.ctaHref),n.insertPriceIntoLocalizedStr(e,e.strings,e.header,xY,"header"),n.insertPriceIntoLocalizedStr(e,e.strings,e.subtitle,xY,"subtitle"),e.gotoUrl=function(){t.openLink(e.ctaHref)}})}function _c(e){"ngInject";return{restrict:"E",replace:!0,scope:{videoId:"@",position:"=",onClick:"&"},template:AY,link:function(t){t.src="";var i=t.$watch("videoId",function(n){n&&(i(),t.src=e.getThumbnailImage(n))})}}}function Oc(e){"ngInject";return{restrict:"E",replace:!0,scope:{ocdPath:"@",type:"@",overrideVault:"@"},require:["?^originStoreCarouselProduct","?^originStorePdpSectionWrapper"],link:function(t,i,n,r){function o(){t.type=NY[t.type]||NY.fixed}if(2===_.compact(r).length){var a=r[0];t.ocdPath&&a&&_.isFunction(a.registerItem)&&a.registerItem(),o()}else e.populateScope(t,GY).then(o)},template:$Y}}function Ec(e){return parseInt(e,10)}function Fc(e,t,i){"ngInject";e.carouselState={},e.carouselState.current=0,e.carouselState.animationRunning=!1,e.isLoading=!0,e.retries=0,e.animate=function(t){var n,r=t*e.carouselState.maxTilesInView,o=e.carouselState.totalTiles-r,a=e.carouselState.carouselWidth,s=Math.max(0,a-o*e.carouselState.tileWidth);n=0===t?0:r*e.carouselState.tileWidth-s,e.enableImpressionTrackingForTiles(r,r+e.carouselState.maxTilesInView),i.onTransitionEnd(e.carouselState.tileContainer,e.postSlide,500),e.carouselState.animationRunning=!0,e.carouselState.tileContainer.css("transform","translate3d(-"+n+"px, 0, 0)"),e.carouselState.current=t},e.postSlide=function(){e.carouselState.animationRunning=!1,Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_CAROUSEL_ROTATE_EVENT,{element:angular.element(t),page:e.carouselState.current})},e.goTo=function(t){void 0===t||e.carouselState.animationRunning||1===e.carouselState.numberOfSlides.length||(t<0&&(t=e.carouselState.numberOfSlides.length-1),t>=e.carouselState.numberOfSlides.length&&(t=0),e.animate(t))},this.goToNext=function(){e.goTo(e.carouselState.current+1)},this.goToPrev=function(){e.goTo(e.carouselState.current-1)}}function xc(e,t,i,n,r,o){"ngInject";return{restrict:"A",scope:!1,controller:Fc,link:function(a,s,c,l){function d(e){e.stopPropagation(),f()}function g(e){e.stopPropagation(),v()}function u(e,t,i){e.stopPropagation(),_.isArray(t)&&_.isArray(i)&&function(e,t){if(t.length>=YY){var i=e.length;t.forEach(function(){e.push({placeholder:!0})}),f(),I=r.startAnimation(function(){e[i]=t.shift(),i++,o.digestIfDigestNotInProgress(a)},function(){I=void 0},function(){return i>=e.length},6)}else t.forEach(function(t){e.push(t)}),f()}(t,i)}function p(){return s.find(HY).find("li").filter(":visible")}function m(){f({force:!0}),a.animate(a.carouselState.current)}function f(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).force?w():requestAnimationFrame(w.bind(this))}function h(e,t){s.find(HY).find("li:visible").slice(e,t).find("."+WY).removeClass(WY)}function v(){y=n(function(){a.isLoading=!1,a.$digest()},jY,!1)}var b=void 0,y=void 0,S=void 0,k=void 0,I=void 0,w=function(){var e=s.find(zY),t=s.find(HY),i=t.find("li").filter(":visible"),r=i.last(),o=Ec(r.css("margin-right"))+Ec(r.css("margin-left")),c=r.outerWidth()+o;(i.length>0||angular.isDefined(a.carouselState.totalTiles)&&0===a.carouselState.totalTiles)&&v(),a.enableImpressionTrackingForTiles=h;var l=e.width();a.carouselState.tileWidth=c,a.carouselState.tileContainer=t,a.carouselState.totalTiles=i.length,a.carouselState.maxTilesInView=Math.floor((l+o)/c)||1,a.carouselState.overHang=l-(a.carouselState.maxTilesInView*a.carouselState.tileWidth-o),a.carouselState.maxPages=Math.max(0,Math.ceil(i.length/a.carouselState.maxTilesInView)-1),a.carouselState.carouselWidth=l,a.carouselState.totalTiles>0&&a.carouselState.maxTilesInView>0?a.carouselState.numberOfSlides=new Array(Math.ceil(a.carouselState.totalTiles/a.carouselState.maxTilesInView)):(a.retries++,a.retries<MY&&(S=n(f,jY)),a.carouselState.numberOfSlides=0),a.carouselState.current>a.carouselState.maxPages?a.animate(a.carouselState.maxPages):h(0,i.length)};a.$on("goTo",function(e,t){e.stopPropagation(),a.goTo(t.slideNumber)}),s.on("carousel:setup",d),s.on("carousel:finished",g),s.on("carousel:staggerload",u),e.events.on(Ey.n,m),t.isTouchEnabled()&&(s.on("swipeleft",l.goToNext),s.on("swiperight",l.goToPrev)),a.$on("originStoreCarousel:gameTileRemoved",_.debounce(f,VY)),a.$on("$destroy",function(){t.isTouchEnabled()&&(s.off("swipeleft",l.goToNext),s.off("swiperight",l.goToPrev)),s.off("carousel:setup",d),s.off("carousel:finished",g),s.off("carousel:staggerload",u),e.events.off(Ey.n,m),n.cancel(b),n.cancel(y),n.cancel(S),n.cancel(k),I&&(r.stopAnimation(I.id),I=void 0)}),b=n(function(){if("MODAL"!==a.version){var e=i('<origin-store-carousel-product-indicators carousel-state="carouselState"></origin-store-carousel-product-indicators>')(a);s.append(e)}var t=i('<origin-store-carousel-product-controls carousel-state="carouselState"></origin-store-carousel-product-controls>')(a);s.find(zY).append(t),p().addClass(qY),f(),function(){function e(){k=n(t,jY,!1)}function t(){var t,a;if(r)if((t=i.find(".origin-storegametile-violator")).length&&t.get(0)){if(a=t.get(0).offsetHeight){var s=r.height()+a;r.css("min-height",s+"px"),n.cancel(k)}}else o<MY&&e()}var i=s.find(HY).find("li:visible"),r=s.find(".origin-store-carousel-product-carousel-container"),o=0;e()}(),function(){var e=p();if(e.length>=YY){var t=0;I=r.startAnimation(function(){e[t].classList.remove(qY),t++},function(){I=void 0},function(){return t>=e.length},6)}else e.removeClass(qY)}()},0),r.addResizeEventHandler(a,function(){n.cancel(a.resizeTimeout),a.resizeTimeout=n(function(){for(f();a.carouselState.current>=a.carouselState.numberOfSlides.length;)a.carouselState.current--;a.animate(a.carouselState.current)},250)},VY)}}}function Lc(e,t){"ngInject";return{restrict:"E",replace:!0,transclude:!0,scope:{titleStr:"@",text:"@",description:"@",href:"@",imageSrc:"@",backgroundColor:"@",textColor:"@",controlButtonColor:"@"},template:QY,link:function(i,n){i.backgroundColor=e.setBackgroundColorOfElement(i.backgroundColor,n,JY),i.strings={},t.insertPriceIntoLocalizedStr(i,i.strings,i.titleStr,JY,"title-str"),t.insertPriceIntoLocalizedStr(i,i.strings,i.text,JY,"text"),i.textColor=XY[i.textColor]||XY.light,i.textColorClass=tK+i.textColor,i.ctaType=i.textColor===XY.light?ZY.transparent:ZY.light,i.controlButtonColor||(i.controlButtonColor=eK.dark)}}}function Ac(e,t,i,n,r,o){"ngInject";i.direction=e.direction||rK.ascending,i.facetData=e.facetData||"",i.limit=e.limit||30,i.offset=e.offset||0,i.orderBy=e.orderBy||oK.Rank,i.searchString=e.searchString||"",i.textColor=aK[i.textColor]||aK.light,i.textColorClass=lK+i.textColor,i.ctaType=i.textColor===aK.light?sK.transparent:sK.light;var a={filterQuery:i.facetData,rows:i.limit,sort:i.orderBy+" "+i.direction,start:i.offset};o.searchStore(i.searchString,a,i.blackList,i.whiteList).then(r.getProperty(["games","game"])).then(function(e){var n=t.find(".origin-store-carousel-featured-carousel-slider");i.offers=[],e?n.trigger(uK,[i.offers,e]):(i.offers=[],n.trigger(dK))}).catch(function(e){n.error("[origin-store-carousel-featuredsearch SearchFactory.searchStore] failed",e)})}function Dc(e,t){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@",endColor:"@",href:"@",imageSrc:"@",backgroundColor:"@",text:"@",titleStr:"@",overrideVault:"@",textColor:"@",whiteList:"@",blackList:"@",controlButtonColor:"@"},template:nK,controller:Ac,link:function(i,n){i.backgroundColor=e.setBackgroundColorOfElement(i.backgroundColor,n,gK),i.strings={},t.insertPriceIntoLocalizedStr(i,i.strings,i.titleStr,gK,"title-str"),t.insertPriceIntoLocalizedStr(i,i.strings,i.text,gK,"text"),i.controlButtonColor||(i.controlButtonColor=cK.dark)}}}function Rc(e,t,i){"ngInject";e.order=[];var n={name:hK,data:{"title-str":e.titleStr,version:vK.MODAL},id:"web-carousel-modal",size:"fullScreen",contentDirective:[]};e.$on("imageCarousel:registar",function(t,i){n.contentDirective.push(i.json),e.order.push(i.id)}),e.$on("imageCarousel:openModal",function(t,r){n.data.position=e.order.indexOf(r.id),i.openPaginated(n)}),e.$on("$destroy",function(){})}function $c(e){"ngInject";return{restrict:"E",link:function(t,i){function n(){if(t.version===vK.MODAL){var e=$(".otkmodal-content").width(),n=e-60,r=e/bK;i.find(".origin-carouselimageitem-modal").each(function(e,t){$(t).width(n).height(r)}),i.find(".origin-carouselvideoitem-modal").each(function(e,t){$(t).width(n).height(r)}),i.find("iframe").each(function(e,t){$(t).width(n).height(r)})}}t.version===vK.MODAL&&(n(),e.addResizeEventHandler(t,n))},transclude:!0,controller:Rc,scope:{titleStr:"@",version:"@"},template:fK}}function Nc(e,t){"ngInject";e.isLoading=!0,e.controlButtonColor||(e.controlButtonColor=SK.dark);var i=e.$watch("media",function(t){angular.isDefined(t)&&(e.isLoading=!1,i())});e.openModal=function(i){t.openDirective({id:"web-media-overlay",name:"origin-dialog-content-media-carousel",size:"fullScreen",data:{items:e.media,active:i}})}}function Gc(e,t){"ngInject";function i(t){t&&(n&&n(),e.setWrapperVisibility())}e.linkFunctionReady=!1;var n=void 0;e.itemCount=0,this.registerItem=function(){e.itemCount++,e.linkFunctionReady?e.setWrapperVisibility():n=e.$watch("linkFunctionReady",i)},e.onClick=function(i){i.preventDefault(),t.openLink(e.viewAllHref)},e.viewAllHrefAbsoluteUrl=t.getAbsoluteUrl(e.viewAllHref)}function Uc(e){"ngInject";return{restrict:"E",replace:!0,transclude:!0,require:"?^originStorePdpSectionWrapper",scope:{titleStr:"@",viewAllStr:"@",viewAllHref:"@",controlButtonColor:"@"},template:IK,link:function(t,i,n,r){t.setWrapperVisibility=function(){r&&_.isFunction(r.setVisibility)&&r.setVisibility(!0)},t.$watch("itemCount",_.debounce(function(){e.events.fire(Ey.n)},300)),t.linkFunctionReady=!0,t.controlButtonColor||(t.controlButtonColor=RS.dark)},controller:Gc}}function Bc(e,t,i,n,r){"ngInject";return{restrict:"E",replace:!0,scope:{titleStr:"@",searchString:"@",facetData:"@",orderBy:"@",direction:"@",limit:"@",offset:"@",overrideVault:"@",whiteList:"@",blackList:"@",controlButtonColor:"@"},require:"?^originStorePdpSectionWrapper",template:CK,link:function(n,o,a,s){n.searchString=n.searchString||"",n.facetData=n.facetData||"",n.orderBy=LS[n.orderBy]||LS.title,n.direction=n.direction||xS.ascending,n.limit=n.limit||30,n.offset=n.offset||0,n.controlButtonColor||(n.controlButtonColor=RS.dark);var c={filterQuery:n.facetData,sort:n.orderBy+" "+n.direction,start:n.offset,rows:n.limit};i.searchStore(n.searchString,c,n.blackList,n.whiteList).then(t.getProperty(["games","game"])).then(function(e){var t=r.buildPathFromUrl();return t.isGameName||t.isAddon||t.isExpansion?_.reject(e,function(e){return function(e,t){var i=_.get(e,"path",""),n=new KH(i);return!!(t.isGameName&&n.isGameName||t.isAddon&&n.isAddon||t.isExpansion&&n.isExpansion)&&i.includes(t._gdpPath)}(e,t)}):e}).then(function(e){n.offers=[],e?(s&&_.isFunction(s.setVisibility)&&s.setVisibility(!0),o.trigger(TK,[n.offers,e])):o.trigger(PK)}).catch(function(t){e.error("[origin-store-carousel-productsearch SearchFactory.searchStore] failed",t)})}}}function Mc(e,t,i){"ngInject";return{restrict:"E",scope:{controlTitleStr:"@",variationTitleStr:"@",recommendationType:"@",numRecommendations:"@",controlOcdPaths:"@",variationOcdPaths:"@"},template:OK,link:function(n,r){function o(){n.isLoading=!1,n.$digest()}var a={};n.isLoading=!0,n.strings={controlTitleStr:t.getLocalizedStr(n.controlTitleStr,LK,"control-title-str"),variationTitleStr:t.getLocalizedStr(n.variationTitleStr,LK,"variation-title-str")},a[EK]=Origin.pin.getStoreHomeBaseGameGameRecommendation,a[FK]=Origin.pin.getStoreHomeExtraContentGameRecommendation,a[xK]=Origin.pin.getVaultGameRecommendation,n.controlOcdPaths&&(n.controlOcdPaths=n.controlOcdPaths.split(",")),n.variationOcdPaths&&(n.variationOcdPaths=n.variationOcdPaths.split(","));var s=e.getNumRecoRecommendationsToRequest(n.controlOcdPaths,n.variationOcdPaths,parseInt(n.numRecommendations));n.$on("postrepeat:last",function(){window.requestAnimationFrame(function(){n.$broadcast("originStoreCarousel:gameTileRemoved")})});var c=function(){r.remove(),n.$destroy()},l=function(e){var t=_.get(e,["games","game"],[]);_.isEmpty(t)?c():(n.games=t,n.carouselTitle=n.strings.controlTitleStr,o())};e.retrieveRecommendedGames(_.get(a,n.recommendationType,a[EK]),s).then(_.partialRight(e.createRecommendedGamesJsonArray,n.controlOcdPaths,n.variationOcdPaths,s)).then(function(e){0!==_.size(e.games)?(n.recoTag=e.recoTag,n.recoType=Origin.pin.constants.GAMES,n.isControl=e.control,n.games=e.games,n.carouselTitle=e.control?n.strings.controlTitleStr:n.strings.variationTitleStr,o()):c()}).catch(function(){var e={filterQuery:function(){switch(n.recommendationType){case FK:return AK;case xK:return DK;default:return RK}}(),sort:NK,start:0,rows:n.numRecommendations||$K};i.searchStore("",e).then(l).catch(c)})}}}function jc(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(e){return!!e.releaseDate}function u(t){if(!_.isEmpty(t)){e.model=So(_.head(_.values(t)));var i=_.get(e,[jK,DI.m]),r=_.isDate(i)?moment(i).format("LL"):"",a=Origin.utils.os();e.isShellBundle=l.isShellBundle(e.model),e.platforms=(d=e.model).platforms?n.map(g,d.platforms):null,e.isDownloadable=_.get(e,[jK,DI.l],!1)&&s.isInThePast(i),e.strings.message=function(t){return e.isDownloadable||e.isShellBundle?o.getLocalizedStr(e.visitFromComputerStr,MK,"visit-from-computer-str"):o.getLocalizedStr(e.preloadStr,MK,"preload-str",{"%date%":t})}(r),e.isValidPlatform=(!e.isVault||a===UK)&&e.platforms[a],c.digestIfDigestNotInProgress(e)}var d}var p;e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),e.strings={download:(p=o.getLocalizedStr(e.downloadStr,MK,"download-str"),e.isEmbeddedBrowser&&p?p:o.getLocalizedStr(t.downloadWithOriginStr,MK,"download-with-origin-str")),havingTrouble:o.getLocalizedStr(t.havingTroubleStr,MK,"having-trouble-str"),havingTroubleUrl:o.getLocalizedStr(t.havingTroubleUrlStr,MK,"having-trouble-url-str"),viewInLibrary:o.getLocalizedStr(e.viewInLibraryStr,MK,"view-in-library-str")},e.platformLoc=o.getLocalizedStr(e.platformStr,MK,"platform-str"),e.downloadWithOrigin=function(){i.close(e.modalId),a.downloadGame(e.offerId)},e.viewInLibrary=function(){i.close(e.modalId),d.goToState(bI.u,{offerid:e.offerId},{})},e.$watchOnce("offerId",function(e){r.getCatalogInfo([e]).then(u)})}function Hc(e,t){"ngInject";return{restrict:"E",scope:{offerId:"@",modalId:"@",isVault:"<",platformStr:"@",downloadStr:"@",preloadStr:"@",viewInLibraryStr:"@"},controller:jc,template:BK,link:function(i){var n='<a href="'+e.getHelpUrl(Origin.locale.locale(),Origin.locale.languageCode())+'" class="otkc otkc-small external-link-sso">'+i.strings.havingTroubleUrl+"</a>";i.strings.havingTrouble=t.substitute(i.strings.havingTrouble,{"%helpurl%":n})}}}function zc(e){"ngInject";return{restrict:"E",scope:{image:"@",header:"@",titleStr:"@",text:"@",learnMoreUrl:"@",learnMoreText:"@"},template:zK,link:function(t){t.learnMoreText=e.getLocalizedStr(t.learnMoreText,VK,"learn-more-text")}}}function Vc(e,t){"ngInject";e.description=t.getLocalizedStr(e.description,YK,"description")}function Wc(e){"ngInject";return{restrict:"E",scope:{alignment:"@",titleStr:"@",subtitle:"@",href:"@",description:"@",image:"@",offersubtitle:"@",offerdescriptiontitle:"@",offerdescription:"@",backgroundColor:"@"},controller:Vc,template:qK,link:function(t,i){t.backgroundColor=e.setBackgroundColorOfElement(t.backgroundColor,i.find(KK),YK)}}}function qc(e,t,i){"ngInject";e.isEarlyAccess=function(){return"true"===e.earlyAccess},i.getObserver(e,"user"),e.goToPdp=function(t){e.onClick({$event:t})},e.showInfoBubbleOthLink=!t.isState("app.store.wrapper.onthehouse")}function Yc(e,t,i,n,r){"ngInject";e.openModal=function(i){t.openDirective({id:"web-youtube-video",name:"origin-dialog-content-media-carousel",size:"fullScreen",closeOnStateChange:!0,data:{items:e.screenshots,active:i}})},e.goToPdp=function(t){t.preventDefault(),i.goToPdp(e.model)},n.populateScopeWithOcdAndCatalog(e,eQ,e.ocdPath).then(function(){var t=_.compact([e.screenshot1,e.screenshot2,e.screenshot3,e.screenshot4]);t.length>0&&(e.screenshots=_.map(t,function(e){return{src:e,type:"image"}})),e.pdpUrl=i.getPdpUrl(e.model,!0),e.fallbackImage=e.model.packArt,r.digestIfDigestNotInProgress(e)})}function Kc(e,t,i,n,r){"ngInject";i.populateScopeWithOcdAndCatalog(e,iQ,e.ocdPath).then(function(){e.onElementClick=function(){n.goToPdp(e.model)},e.isFree=r.isFree(e.model),_.get(e,["model","error"])===UI.p&&(t.remove(),e.$emit("originStoreCarousel:gameTileRemoved"))})}function Qc(e,t,i,n,r,o,a,s,c,l){"ngInject";t.populateScopeWithOcdAndCatalog(e,aQ,e.ocdPath).then(function(){e.truncatedDescription=i("limitHtml")({text:_.get(e,[oQ,DI.S],""),limit:sQ,truncationString:"&hellip;",breakOnBrTag:!1,preserveInlineStyles:!0});var t=_.get(e,[oQ,DI.Y],"");e.libraryUrl=l.getHrefFromState(bI.u,{offerid:t},{}),n.digestIfDigestNotInProgress(e)}),e.remove=function(t){t.preventDefault(),e.hideUndoButton=!0,setTimeout(function(){e.hideUndoButton=!1},cQ),c.blockUI(),r.vaultRemove(_.get(e,["model","offerId"])).then(c.unblockUIPromise).catch(c.unblockUIPromiseOnError).catch(a.showDialog)},s.listenForCollectionUpdate(e,function(){o.getByOcdPathPromise(_.get(e,"ocdPath")).then(function(t){e.model=_.head(_.values(t)),e.$digest()})},!0)}function Jc(e,t,i,n,r,o,a,s,c){"ngInject";var l=0;e.strings=e.strings||{},e.strings.eulaText=t.getLocalizedStr(null,gQ,"eula-text"),e.strings.othText=t.getLocalizedStr(null,gQ,"oth-text"),e.strings.promoText=t.getLocalizedStr(null,gQ,"promo-text");var d=c.eulaURL,g=originLocaleApi.getLanguageCode(),u=function(){var i,n=e.model.useEndDate;i=n?t.getLocalizedStr(e.othDateAvailabilityStr,gQ,"oth-date-availability-str",{"%endDate%":moment(n).format("LL")}):t.getLocalizedStr(e.othLimitedAvailabilityStr,gQ,"oth-limited-availability-str"),e.othAvailabilityText=i};e.setSiteStripeMargin=function(e){l=e},e.goToEula=function(t){t.preventDefault(),r.externalUrl(e.eulaUrl,!0)},e.goToTerms=function(t){var o=!!document.querySelector(IU),c=!!document.querySelector("#"+(uQ+wU));t.preventDefault(),a.closeCurrentShowingDialog(),n.hash(_U+uQ),c?o?i.events.fire(PU):s.scrollTo(uQ,l):(r.openLink(e.linkTerms),i.events.fire(PU))},e.goToOthPage=function(e){e.preventDefault(),r.openLink(bI.F)},e.goToPolicyPage=function(t){t.preventDefault(),r.openLink(bI.P,{id:e.promoLegalId})},e.othUrl=r.getAbsoluteUrl(bI.F),e.policyUrl=r.getAbsoluteUrl(bI.P,{id:e.promoLegalId}),e.showOthLink=OS[e.showInfoBubbleOthLink]!==OS.false,e.$watchOnce("model",function(){e.linkTerms=(e.hideOth=!0,r.isState(bI.C)||r.isState(bI.d)?n.absUrl()+"#"+(_U+uQ):o.getGdpUrl(e.model)+"#"+(_U+uQ)),e.termsUrl=r.getAbsoluteUrl(e.linkTerms),e.eulaUrl=r.getAbsoluteUrl(d.replace("{locale}",g)),e.strings.termsText=t.getLocalizedStr(null,gQ,"terms-text",{"%pdpUrl%":e.linkTerms}),e.strings.trialTimeMessage=t.getLocalizedStr(null,gQ,"trialtime",{"%hours%":e.model.trialLaunchDuration},e.model.trialLaunchDuration),u()})}function Xc(e,t,i){"ngInject";return{link:function(n){var r=i.buildPathFromUrl();r.isValid&&t.getEditionAgnosticModelPromise(r,{throwError:!0}).then(function(e){n.model=e,n.$digest()}).catch(function(t){return e.error("[origin-store-game-legal] error populating model:",t)})},restrict:"E",replace:!0,scope:{},controller:Jc,template:dQ}}function Zc(e,t,i){"ngInject";e.$watchOnce("model",function(){var n;e.model=ko(i.updateGameWithLocalizedRatings(e.model)),e.isRatingWithIcons=t.isRatingWithIcons(e.model.gameRatingType),e.isRatingWithIcons&&(n=t.getRatingReasonIcons(e.model.gameRatingDesc,e.model.gameRatingType),e.ratingReasonIcons=t.sortRatingDescriptorsIfNecessary(e.model.gameRatingType,n),e.pegiCustomizedRatingReasons="PEGI"===e.model.gameRatingType?t.getCustomizedPegiRatingDescriptors(e.model.gameRatingDesc):[]),e.ratingSystemName=t.getLocalizedRatingName(e.model.gameRatingType),e.esrbDesriptorGroups="ESRB"===e.model.gameRatingType?t.extractEsrbDescriptorGroups(e.model.gameRatingInteractiveElements,e.model.gameRatingDesc):[],e.showInGamePurchaseWarning=t.isEligibleToShowInGamePurchaseWarning(e.model.gameRatingType,e.ratingReasonIcons),e.inGamePurchaseWarningMessage=t.extractInGamePurchaseWarningMessage()})}function el(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",scope:{ocdPath:"@",offerId:"@",type:"@",violatorText:"@",othText:"@",overrideVault:"@"},link:function(s,c){function l(e){return s.model.displayName.length>e?a("limitHtml")({text:s.model.displayName,limit:e,truncationString:"...",breakOnBrTag:!1,preserveInlineStyles:!1,isDescription:!1,endOnPunctuation:!1}):s.model.displayName}var d,g=this;s.type=yQ[s.type]||yQ.fixed,s.strings={othText:t.getLocalizedStr(s.othText,vQ,"oth-text")},s.$on("infobubble-show",function(){return c.addClass(bQ)}),s.$on("infobubble-hide",function(){return c.removeClass(bQ)}),s.$watchOnce("model",(d=regeneratorRuntime.mark(function i(){var a,d,u,p,m;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=s.model,d=a.error,u=a.isPurchasable,p=a.isAnnouncement,d!==UI.p&&(u||p)){i.next=7;break}(m=c.parent()).hasClass("origin-gametile-item")||m.hasClass("origin-tilelist-item")?m.remove():c.remove(),s.$emit("originStoreCarousel:gameTileRemoved"),i.next=17;break;case 7:return s.pdpUrl=n.getPdpUrl(s.model,!0),i.next=10,o.isEligibleForPromotionByOfferId(s.model.offerId);case 10:i.sent.isEligible&&(s.violatorText=t.getLocalizedStr("",vQ,"violator-text")),s.violatorText=s.model.oth?s.strings.othText:s.violatorText,s.isFree=r.isFree(s.model),s.displayName=l(SQ),e.getAutomationConfig()&&(s.automationTileId="game-tile",s.automationGameNameId="game-tile-name",s.automationTileCtaId="game-tile-cta");case 17:case"end":return i.stop()}},i,g)}),function(){var e=d.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})}),!1,function(){return!_.isEmpty(s.model)}),s.model={};var u=s.$watch("ocdPath",function(e){e&&(u(),p(),i.getByOcdPath(s.ocdPath).attachToScope(s,"model"))}),p=s.$watch("offerId",function(e){e&&(p(),u(),i.getByOfferId(e).attachToScope(s,"model"))});s.priceLoadCompleted=function(e){var t=e.model,i=e.showIncludedWIthText,n=e.showOwnedText,r=e.showAccessLogo,o=t.strikePrice!==t.price||i||n||r?SQ:kQ;s.displayName=l(o)}},template:hQ}}function tl(e,t,i,n,r,o){"ngInject";function a(){var t=Origin.user.userPid();g=r.getWishlist(t),i.getObserver(t,e,n.unwrapPromiseAndCall(d))}function s(e){e.isLoggedIn?a():g=null}function c(){e.onWishlist?g.removeOffer(e.offerId):g.addOffer(e.offerId)}function l(){e.isLoaded=!0}function d(t){var i=_.some(t.offerList,{id:e.offerId});i!==e.onWishlist&&(e.onWishlist=i,e.$digest())}var g;e.isWishlistEnabled=r.isWishlistEnabled(),e.isLoaded=!1,e.updateWishlist=function(i){i&&(i.preventDefault(),i.stopPropagation()),e.isLoaded=!1,t.promiseLogin().then(c).catch(l)},e.$watch("onWishlist",l),a(),t.events.on(CQ,s),o.populateScope(e,wQ),e.$on("$destroy",function(){t.events.off(CQ,s)})}function il(e,t){"ngInject";e.ocdPath?t.getByOcdPath(e.ocdPath).attachToScope(e,"model"):e.model={}}function nl(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",scope:{ocdPath:"@",primaryUrl:"@",secondaryUrl:"@",primaryText:"@",secondaryText:"@",image:"@",logo:"@",titleStr:"@",keyMessage:"@",videoId:"@",matureContent:"@",videoDescription:"@",textColor:"@",backgroundColor:"@",takeoverId:"@",ctid:"@",verticalAlignment:"@",disableVerticalGradients:"@",enableGameRatingLogo:"@"},require:"^?originTakeoverPage",template:OQ,controller:il,link:function(c,l,d,g){function u(e){c.isDismissedOrHidden=e,g&&(e?(g.showPageContent(),m.show()):(g.hidePageContent(),m.hide()))}function p(e){u(e.isOnline?!1:!0)}var m=angular.element(".origin-store-sitestripe-wrapper"),f=Origin.client.onlineStatus.isOnline();c.$on("$destroy",function(){m.show(),a.events.off("myauth:clientonlinestatechanged",p)}),r.populateScope(c,EQ,c.ocdPath).then(function(){c.isDismissedOrHidden=n.isTakeoverDismissed(c.takeoverId),c.textColor=c.textColor||xQ.light,c.backgroundColor=c.backgroundColor||LQ.light,c.verticalAlignment=c.verticalAlignment||DQ.bottom,c.disableVerticalGradients=c.disableVerticalGradients||AQ.false,c.enableGameRatingLogo=c.enableGameRatingLogo||AQ.false,c.strings={primaryText:e.getLocalizedStr(c.primaryText,EQ,"primary-text"),secondaryText:e.getLocalizedStr(c.secondaryText,EQ,"secondary-text")},i.insertPriceIntoLocalizedStr(c,c.strings,c.keyMessage,EQ,"keyMessage"),c.hasLogo="string"==typeof c.logo&&c.logo.length>0,c.isDarkTextColor=c.textColor===xQ.dark,c.backgroundColor||(c.backgroundColor=LQ[c.textColor]),c.backgroundColor=t.setBackgroundColorOfElement(c.backgroundColor,l.find(FQ),EQ),c.dismissTakeoverAndOpenLink=function(e,t){e.preventDefault(),e.stopPropagation(),n.dismissTakeover(c.takeoverId),u(!0),t&&s.openLink(t)},c.gotoPrimaryLinkAndDismissTakeover=function(e,t){e.preventDefault(),e.stopPropagation(),n.dismissTakeover(c.takeoverId),t?s.openLink(t):o.goToPdp(c.model)},!c.isDismissedOrHidden&&f?(u(!1),Origin.telemetry.events.fire("originTakeoverVisible")):u(!0),a.events.on("myauth:clientonlinestatechanged",p),c.primaryUrl?(c.primaryAbsoluteUrl=s.getAbsoluteUrl(c.primaryUrl),c.isPrimaryLinkExternal=e.isAbsoluteUrl(c.primaryUrl)):c.$watchOnce("model",function(){c.primaryAbsoluteUrl=o.getPdpUrl(c.model,!0)})}),c.secondaryAbsoluteUrl=s.getAbsoluteUrl(c.secondaryUrl)}}}function rl(e){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{titleStr:"@",href:"@"},template:'<li class="origin-storenav-dropdown"><a class="otktitle-5 otkdropdown-trigger otkdropdown-trigger-caret" ng-href="{{::absoluteUrl}}" ng-click="openLink(href, $event)" ng-bind="titleStr"></a><div class="otkdropdown otkdropdown-wrap"><ul class="otkmenu otkmenu-dropdown otkmenu-dropdown-filter" role="menu" ng-transclude></ul></div></li>',link:function(t,i){i.find(".otkmenu-dropdown:first > li").addClass("origin-storenav-dropdown-item"),t.openLink=function(t,i){i.preventDefault(),e.openLink(t)},t.absoluteUrl=e.getAbsoluteUrl(t.href)}}}function ol(e){"ngInject";return{restrict:"E",replace:!0,scope:{width:"@",paragraph:"@",titleStr:"@"},template:UQ,link:function(t){t.strings={},e.insertPriceIntoLocalizedStr(t,t.strings,t.paragraph,"","paragraph")}}}function al(e,t,i){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@",freeText:"@",ocdPath:"@",offerDescriptionTitle:"@",offerDescription:"@",size:"@"},link:function(n,r){e.populateScopeWithOcdAndCatalog(n,HQ,n.ocdPath).then(function(){_.get(n,["model","oth"],!1)?(n.size=n.size||jQ.full,n.sizeClass=zQ+jQ[n.size],n.pdpUrl=t.getPdpUrl(n.model,!0)):r.remove(),i.digestIfDigestNotInProgress(n)}),n.goToPdp=function(e){e.preventDefault(),t.goToPdp(n.model)}},controller:"OriginStoreFreegamesProgramCtrl",template:MQ}}function sl(e,t,i){"ngInject";e.viewAllStr=t.getLocalizedStr(e.viewAllStr,qQ,"viewallstr"),e.openLink=function(e,t){t.preventDefault(),i.openLink(e)},e.viewAllHrefAbsoluteUrl=i.getAbsoluteUrl(e.viewAllHref)}function cl(e,t){"ngInject";e.strings={description:t.getLocalizedStr(e.description,KQ,"description")}}function ll(e,t){"ngInject";e.strings={content:t.getLocalizedStr(e.content,JQ,"content")}}function dl(e,t){"ngInject";e.strings={description:t.getLocalizedStr(e.description,ZQ,"description")}}function gl(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@"},template:'<h5 class="otktitle-5" ng-bind-html="::strings.description"></h5>',link:function(t){t.strings={description:e.getLocalizedStr(t.description,tJ,"description")}}}}function ul(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@"},template:'<h4 class="otktitle-4" ng-bind-html="::strings.description"></h4>',link:function(t){t.strings={description:e.getLocalizedStr(t.description,nJ,"description")}}}}function pl(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@"},template:'<h6 class="otktitle-6" ng-bind-html="::strings.description"></h6>',link:function(t){t.strings={description:e.getLocalizedStr(t.description,oJ,"description")}}}}function ml(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@"},template:'<h3 class="otktitle-3" ng-bind-html="::strings.description"></h3>',link:function(t){t.strings={description:e.getLocalizedStr(t.description,sJ,"description")}}}}function fl(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@",border:"@"},template:'<h2 class="otktitle-2{{ ::borderClass }}" ng-bind-html="::strings.description"></h2>',link:function(t){t.borderClass=t.border===lJ.True?" origin-store-paragraph-headertwo-border":"",t.strings={description:e.getLocalizedStr(t.description,dJ,"description")},t.$digest()}}}function hl(e){"ngInject";return{restrict:"E",replace:!0,scope:{description:"@",showSocialMedia:"@showsocialmedia",facebookShareTitle:"@",isCentered:"@"},link:function(t){e.populateScope(t,pJ).then(function(){t.showSocialMedia=t.showSocialMedia===uJ.true})},template:gJ}}function vl(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(){return!(!_.get(e,"manualTrialOverride")&&!_.get(e,"manualDiscountOverride"))}function p(){if(!_.isUndefined(e.model)){var t=moment(_.get(e,["model","releaseDate"])).format("LL");e.isReleased=r.isReleased(e.model),e.nonvaultUpsellStrings.nonvaultTrialUpsellMiddle=i.getLocalizedStr(e.nonvaultTrialUpsellMiddle,fJ,"nonvault-trial-upsell-middle",{"%date%":t})}if(_.isUndefined(e.vaultEdition)||(e.nonvaultUpsellStrings.nonsubscriberAlternateEditionInVaultHeader=i.getLocalizedStr(e.nonsubscriberAlternateEditionInVaultHeader,fJ,"nonsubscriber-alternate-edition-in-vault-header",{"%game%":e.vaultEdition.displayName})),!_.isUndefined(e.earlyAccessTrialModel)){var n=moment(_.get(e,["earlyAccessTrialModel","releaseDate"])).format("LL"),o=_.get(e,["earlyAccessTrialModel","trialTimeRemaining","leftTrialSec"],0),c=Math.ceil(o/3600),l=_.get(e,["earlyAccessTrialModel","displayName"]);e.nonvaultUpsellStrings.nonvaultTrialUpsellBefore=i.getLocalizedStr(e.nonvaultTrialUpsellBefore,fJ,"nonvault-trial-upsell-before",{"%date%":n}),e.nonvaultUpsellStrings.nonvaultGameEarlyTrialNotReleased=i.getLocalizedStr(e.nonvaultGameEarlyTrialNotReleased,fJ,"nonvault-game-early-trial-not-released",{"%date%":n}),e.nonvaultUpsellStrings.nonvaultGameEarlyTrialReleased=i.getLocalizedStr(e.nonvaultGameEarlyTrialReleased,fJ,"nonvault-game-early-trial-released",{"%date%":n}),e.nonvaultUpsellStrings.notExpiredEarlyAccessTrial=i.getLocalizedStr(e.notExpiredEarlyAccessTrial,fJ,"not-expired-early-access-trial",{"%hours%":c,"%game%":l}),e.isEarlyAccessTrialReleased=a.isEarlyAccessTrialReleased(e.earlyAccessTrialModel),e.isTrialStarted=a.isTrialStarted(e.earlyAccessTrialModel),e.isTrialExpired=a.isTrialExpired(e.earlyAccessTrialModel)}e.isNonVaultUpsellAreaVisible=a.isNonVaultUpsellAreaVisible(e.model,e.editions,e.earlyAccessTrialModel,!_.isEmpty(_.get(e,"manualSubscriberTrialOverride"))),e.showSubscriberUpgradeArea=a.showSubscriberUpgradeArea(e.model,e.editions,e.vaultEdition),e.showSubscriberUpsell=a.showSubscriberUpsell(e.model,e.editions,e.earlyAccessTrialModel,!_.isEmpty(_.get(e,"manualSubscriberTrialOverride"))),e.showOthSubscriptionsUpsell=a.showOthSubscriptionsUpsell(e.model),e.showAlternateVaultEditionUpsell=a.showAlternateVaultEditionUpsell(e.model,e.vaultEdition),e.showNonSubscriberUpsell=a.showNonSubscriberUpsell(e.model,e.vaultEdition,e.earlyAccessTrialModel,u()),s.digestIfDigestNotInProgress(e)}e.accessTrialUrl=o.getAbsoluteUrl("app.store.wrapper.origin-access-trials"),e.accessLandingUrl=o.getAbsoluteUrl("app.store.wrapper.origin-access"),e.nonvaultUpsellStrings={},t.populateScope(e,fJ).then(function t(){d.setModelAndListenForChanges(e,c.buildPathFromUrl(),p).then(g.setEditions).then(l.setVaultEdition).then(p).then(function(){return d.listenForCollectionUpdate(e,t,!1)})}).then(function(){n.insertPriceIntoLocalizedStr(e,e.nonvaultUpsellStrings,e.nonvaultUpsellHeader,fJ,"nonvault-upsell-header"),n.insertPriceIntoLocalizedStr(e,e.nonvaultUpsellStrings,e.nonsubscriberAlternateEditionInVaultText,fJ,"nonsubscriber-alternate-edition-in-vault-text"),n.insertPriceIntoLocalizedStr(e,e.nonvaultUpsellStrings,e.vaultGameOthText,fJ,"vault-game-oth-text"),e.hasManualOverrides=u(),s.digestIfDigestNotInProgress(e)})}function bl(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m){"ngInject";function f(){e.ownsLesserEdition=l.ownsLesserEdition(e.editions,e.model),e.showPlayAction=d.isPlayAction(e.model),e.showSubscriptionUpsellArea=d.showSubscriptionUpsellArea(e.model),e.showSubscriberAquisitionArea=c.isSubscriberAquisitionAreaVisible(e.model,e.editions,e.vaultEdition),e.showAddToLibraryCta=d.isAddToLibraryCta(e.model,e.ownsLesserEdition),e.showUpgradeToVaultEdition=d.showUpgradeToVaultEdition(e.model,e.ownsLesserEdition),e.vaultPdpUrl=e.vaultEdition?u.getPdpUrl(e.vaultEdition,!0):"",e.vaultupsellStrings.subscriberVaultGameUpgradeCta=n.getLocalizedStr(e.subscriberVaultGameUpgradeCta,vJ,"subscriber-vault-game-upgrade-cta",{"%edition%":_.get(e,["vaultEdition","editionName"])}),e.vaultupsellStrings.subscriberVaultGameHeader=n.getLocalizedStr(e.subscriberVaultGameHeader,vJ,"subscriber-vault-game-header",{"%game%":_.get(e,["vaultEdition","displayName"])}),a.digestIfDigestNotInProgress(e)}o.getObserver(e,"user"),e.accessLandingUrl=s.getAbsoluteUrl(bJ),e.vaultupsellStrings={},i.populateScope(e,vJ).then(function t(){p.setModelAndListenForChanges(e,u.buildPathFromUrl(),f).then(m.setEditions).then(g.setVaultEdition).then(f).then(function(){return p.listenForCollectionUpdate(e,t,!1)})}).then(function(){return t.formatCurrency(0)}).then(function(t){r.insertPriceIntoLocalizedStr(e,e.vaultupsellStrings,e.vaultupsellHeader,vJ,"vaultupsell-header"),r.insertPriceIntoLocalizedStr(e,e.vaultupsellStrings,e.playForZeroWith,vJ,"play-for-zero-with",{"%logo%":'<span class="origin-store-pdp-cta-icon"><i class="otkicon otkicon-access"></i></span>',"%zero%":t}),a.digestIfDigestNotInProgress(e)})}function yl(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",longDescription:"@",ctid:"@"},link:e.populateScopeLinkFn(kJ),template:SJ}}function Sl(e){"ngInject";return{restrict:"E",require:"?^originStorePdpSectionWrapper",scope:{longDescription:"@"},link:function(t,i,n,r){t.model={},t.longDescription&&(t.model.longDescription=e.trustAsHtml(t.longDescription),r&&_.isFunction(r.setVisibility)&&r.setVisibility(!0))},template:wJ}}function kl(e,t,i,n){"ngInject";return{restrict:"E",scope:{titleStr:"@",packArt:"@",videoId:"@",matureContent:"@",shortDescription:"@",longDescription:"@",backgroundImage:"@",backgroundColor:"@",readMoreText:"@",actionButtonText:"@",actionButtonHref:"@",restrictedMessage:"@",hideFacebook:"@",retireMessage:"@",learnMoreText:"@",gameRatingUrl:"@",platforms:"@",platformText:"@",gameRatingSystemIcon:"@",gameRatingSystemIconAlt:"@",gameRatingDescriptionShort:"@",gameRatingDescriptionLong:"@"},link:function(r,o){r.isFacebookHidden=r.hideFacebook===PJ.true,e.populateScopeWithOcdAndCatalog(r,_J,n.buildPathFromUrl()).then(function(){r.ocdDataReady=!0,r.backgroundColor=t.setBackgroundColorOfElement(r.backgroundColor,o.find(OJ),_J),r.videoId&&(r.backgroundImage||(r.backgroundImage=i.getStillImage(r.videoId)),r.videoReady=!1,r.showVideo=!1)})},controller:"originStorePdpHeroCtrl",template:TJ}}function Il(e,t){"ngInject";return{restrict:"E",link:function(i,n){var r,o=n.find(".origin-pdp-hero-title");i.descriptionStrings={readMoreText:e.getLocalizedStr(i.readMoreText,xJ,"read-more-text")},i.goToInfo=function(){var e=angular.element("#description");if(e.length&&angular.isDefined(e.offset())){var t=e.offset().top-(angular.element(".store-pdp-nav").height()||0);angular.element("html, body").animate({scrollTop:t},"fast")}},t.addResizeEventHandler(i,function(){i.titleLines&&(i.titleLines=null,i.$digest()),r=o[0].offsetHeight;var e=parseInt(o.css("line-height"),10);i.titleLines=Math.round(r/e),i.$digest()},200)},template:FJ}}function wl(e){"ngInject";return{restrict:"E",link:function(t){t.isVisible=function(){return!!t.retireMessage},t.truncatedLongDescription=e("limitHtml")({text:t.longDescription,limit:DJ,truncationString:"&hellip;",breakOnBrTag:!1,preserveInlineStyles:!0})},template:AJ}}function Cl(e){"ngInject";return{restrict:"E",scope:{legalNotes:"@",termsAndConditions:"@"},link:function(t){t.model={},e.populateScope(t,UJ).then(function(){t.termsAndConditions&&(t.model.onlineDisclaimer=t.termsAndConditions)})},template:GJ}}function Tl(e,t,i,n){"ngInject";return{restrict:"E",replace:!0,scope:{check1:"@",check1value:"@",check2:"@",check2value:"@",check3:"@",check3value:"@",check4:"@",check4value:"@",check5:"@",check5value:"@",description:"@",image:"@",more:"@",showLess:"@",showMore:"@",titleStr:"@",vaultFlag:"@",premierVaultFlag:"@",disallowedFromVault:"@",suppressForInterstitial:"@"},require:["?^originStorePdpComparisonTable","?^originStoreOspComparisonTable"],link:function(r,o,a,s){function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.models=e,r.offerLength=_.size(r.models),r.offers=Object.keys(r.models),r.indicesForOcdPathsToSuppress=n.indicesForOcdPathsToSuppress||[];var o=function(e,t){var i=[];return t.forEach(function(t,n){e.includes(t)||i.push(n)}),i}(e.map(function(e){return e.ocdPath}),l.getOriginalListOcdPaths());r.checklist=function(e){return[{check:r.check1?r.check1:NS[HJ],value:r.check1value?r.check1value:null},{check:r.check2?r.check2:NS[HJ],value:r.check2value?r.check2value:null},{check:r.check3?r.check3:NS[HJ],value:r.check3value?r.check3value:null},{check:r.check4?r.check4:NS[HJ],value:r.check4value?r.check4value:null},{check:r.check5?r.check5:NS[HJ],value:r.check5value?r.check5value:null}].filter(function(t,i){return!r.indicesForOcdPathsToSuppress.includes(i)&&!e.includes(i)})}(o),r.vaultStatus=[],_.forEach(e,function(e){i.isPremierVaultGame(e)?r.vaultStatus.push(BS.premier):t.isVaultGame(e)?r.vaultStatus.push(BS.basic):r.vaultStatus.push("")})}r.show=!1,r.subscriptionType=BS;var l=_.get(_.compact(s),"0");r.toggleContent=function(){r.show=!r.show},(r.description||r.titleStr)&&(r.strings={showMore:e.getLocalizedStr(r.showMore,jJ,"showMore"),showLess:e.getLocalizedStr(r.showLess,jJ,"showLess"),vaultFlag:e.getLocalizedStr(r.vaultFlag,jJ,"vault-flag"),premierVaultFlag:e.getLocalizedStr(r.premierVaultFlag,jJ,"premier-vault-flag")},r.colspan=r.image?1:2,r.anyDataFound=!0,r.hideRow=r.suppressForInterstitial===OS.true&&n.isState(bI.d),l&&_.isFunction(l.registerComparisonItem)&&l.registerComparisonItem(c))},template:MJ}}function Pl(e){"ngInject";function t(t){t&&(i&&i(),e.setWrapperVisibility())}var i;e.linkFunctionReady=!1,this.registerItem=function(){e.linkFunctionReady?e.setWrapperVisibility():i=e.$watch("linkFunctionReady",t)}}function _l(e,t,i,n){"ngInject";return{require:"^?originStorePdpSectionWrapper",restrict:"E",replace:!0,scope:{titleStr:"@",text:"@",textColor:"@",backgroundColor:"@",accentColor:"@"},transclude:!0,link:function(r,o,a,s){function c(){m||_.forEach(u,function(t,n){var r,o=angular.element(t);i.isOnOrAboveScreen(o)?g(e((r=o,function(){r.addClass(JJ)}),n*ZJ,!1)):o.removeClass(JJ)})}function l(){p||(u.removeClass(XJ).addClass(QJ),g(e(c,ZJ,!1)),f||(n.addScrollEventHandler(r,c),f=!0)),p=!0}function d(){(m=i.isXSmall())?(u.removeClass(QJ).addClass(XJ),p=!1):l()}function g(e){h.push(e),e.then(function(e){_.remove(h,e)}(e))}var u,p,m,f=!1,h=[];r.linkFunctionReady=!0,r.setWrapperVisibility=function(){s&&_.isFunction(s.setVisibility)&&s.setVisibility(!0)},setTimeout(function(){u=o.find(KJ),r.moduleBackgroundColor=t.createBackgroundColor(r.backgroundColor),r.moduleAccentColor=t.createBackgroundColor(r.accentColor),r.isDarkColor=r.textColor===YJ.dark,d(),n.addResizeEventHandler(r,d,eX)},0),r.$on("$destroy",function(){h.length&&_.forEach(h,function(t){e.cancel(t)})})},controller:Pl,template:qJ}}function Ol(e,t){"ngInject";function i(t){t&&(r&&r(),e.setWrapperVisibility())}var n=[];e.linkFunctionReady=!1;var r=void 0;this.openModal=function(e){t.openDirective({id:"web-media-overlay",name:"origin-dialog-content-media-carousel",size:"fullScreen",closeOnStateChange:!0,data:{id:"web-media-overlay",items:n,active:e,matureContent:n[e].matureContent}})},this.register=function(t){return e.linkFunctionReady?e.setWrapperVisibility():r=e.$watch("linkFunctionReady",i),n.push(t),n.length-1}}function El(e,t,i){"ngInject";return{require:["^?originStorePdpSectionWrapper","?^originStorePremierLandingSectionWrapper"],restrict:"E",scope:{image:"@",header:"@",text:"@",textAlign:"@",textColor:"@",textSlide:"@"},link:function(e,n,r,o){function a(){e.isTextInView=t.isOnOrAboveScreen(n),e.$digest()}e.isRight=e.textAlign===HS.Right,e.isLeft=e.textAlign===HS.Left,e.isCenter=!e.isRight&&!e.isLeft,e.isDarkColor=e.textColor===zS.dark,t.isXSmall()?e.animationDisabled=!0:(e.isTextInView=t.isOnOrAboveScreen(n),e.tSlide=e.textSlide===OS.true,i.addScrollEventHandler(e,a)),o&&_.forEach(o,function(e){e&&_.isFunction(e.setVisibility)&&e.setVisibility(!0)})},template:aX}}function Fl(e,t,i,n,r,o,a,s){function c(){return!e.isXSmall&&e.textAlign===HS.Right}function l(){return!e.isXSmall&&e.textAlign===HS.Left}function d(){return!e.isXSmall&&!e.isRight&&!e.isLeft}function g(){var e=void 0;p.length||(p=t.find(mX)),m.length||(m=t.find(pX)),p.length&&m.length&&(e=p.width()*fX,m.height(e))}function u(t){var i=t&&t.isLoggedIn;e.ageGateActive=e.matureContent===OS.true&&(i&&a.isUserUnderAgeForMediaLocale()||!i)}e.isXSmall=r.isXSmall();var p=t.find(mX),m=t.find(pX);e.disableOverlay=_.isUndefined(e.text)&&_.isUndefined(e.header),e.videoId&&(n&&_.isFunction(n.setVisibility)&&n.setVisibility(!0),e.ctaType=e.ctaType||uX.none,e.isRight=c(),e.isLeft=l(),e.isCenter=d(),e.isDarkColor=e.textColor===zS.dark,e.isXSmall||(e.isTextInView=r.isOnOrAboveScreen(t),e.textSlide=OS[e.textSlide]===OS.true,e.tSlide=OS[e.textSlide]===OS.true,o.addScrollEventHandler(e,function(){e.isTextInView=r.isOnOrAboveScreen(t),e.$digest()})),o.addScrollEventHandler(e,function(){e.isXSmall=r.isXSmall(),e.isRight=c(),e.isLeft=l(),e.isCenter=d(),e.$digest()},hX)),e.$on("$destroy",function(){s.events.off("myauth:change",u)}),s.events.on("myauth:change",u),s.waitForAuthReady().then(u).catch(angular.noop),requestAnimationFrame(g),o.addResizeEventHandler(e,g,hX)}function xl(e,t,i,n){"ngInject";return{restrict:"E",require:"^?originStorePdpSectionWrapper",scope:{videoId:"@",smallScreenImageurl:"@",matureContent:"@",videoImage:"@",header:"@",text:"@",textAlign:"@",textColor:"@",textSlide:"@",ctaType:"@",ctaDescription:"@",ctaHref:"@"},template:lX,link:function(r,o,a,s){Fl(r,o,0,s,e,t,i,n)}}}function Ll(e,t,i,n){"ngInject";return{restrict:"E",require:"^?originStorePdpSectionWrapper",scope:{quote1Str:"@",quote1SourceStr:"@",quote2Str:"@",quote2SourceStr:"@",quote3Str:"@",quote3SourceStr:"@",videoId:"@",smallScreenImageurl:"@",matureContent:"@",videoImage:"@"},link:function(r,o,a,s){r.textAlignment=HS.Center,r.textSlide=OS.false,Fl(r,o,0,s,e,i,n,t)},template:gX}}function Al(e,t,i,n){"ngInject";return{restrict:"E",require:"^?originStorePdpSectionWrapper",scope:{quoteStr:"@",badgeImage:"@",videoId:"@",smallScreenImageurl:"@",matureContent:"@",videoImage:"@"},link:function(r,o,a,s){r.textAlignment=HS.Center,r.textSlide=OS.false,Fl(r,o,0,s,e,i,n,t)},template:dX}}function Dl(e,t,i,n){"ngInject";return{restrict:"E",scope:{},link:function(r){function o(){r.offerId=_.get(r,["model","offerId"]),r.onWishlistLoc=e.getLocalizedStr(r.gameOnWishlistStr,yX,"gameonwishliststr").replace("%gamename%",_.get(r,["model","displayName"])),n.digestIfDigestNotInProgress(r)}t.setModelAndListenForChanges(r,i.buildPathFromUrl(),o).then(o)},template:bX}}function Rl(e,t,i,n,r,o){"ngInject";e.gotoProductLandingPage=function(){t.goToState(bI.o,i)},n.populateScope(e,kX),r.setModel(e,o.buildPathFromUrl())}function $l(e,t){"ngInject";return{restrict:"E",template:wX,link:function(i,n){i.blurValue=0,i.bottomScrim="true",t.addScrollEventHandler(i,function(){var t=n.find(".origin-pdp-hero-background");e.isOnScreen(t)&&function(e){var t=angular.element(window).scrollTop(),n=e.offset().top,r=n+e.outerHeight(),o=Math.min(1,(r-t)/(r-n));i.blurVal=Math.floor(30*(1-o)),i.$digest()}(t)})}}}function Nl(e,t,i,n,r,o){"ngInject";function a(){e.collapsable=t.isCollapsable(e.model),e.collapsed=t.isCollapsed(e.model),e.showCollapseBtn=t.isCollapseButtonVisible(e.model),e.hideCollapseArea=t.isCollapseAreaHidden(e.model),r.digestIfDigestNotInProgress(e)}function s(){i.setModelAndListenForChanges(e,n.buildPathFromUrl(),a).then(a)}e.collapseState=!0,o.populateScope(e,TX),s(),i.listenForCollectionUpdate(e,s,!0)}function Gl(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{titleStr:"@",readMoreText:"@"},link:function(n,a){function s(){n.titleLines&&(n.titleLines=null,n.$digest()),c=l[0].offsetHeight;var e=parseInt(l.css("line-height"),10);n.titleLines=Math.round(c/e),n.$digest()}var c,l=a.find(".origin-pdp-hero-title");e.populateScope(n,OX),n.goToInfo=function(){var e=angular.element("#description");if(e.length&&angular.isDefined(e.offset())){var t=e.offset().top-(angular.element(".store-pdp-nav").height()||0);angular.element("html, body").animate({scrollTop:t},"fast")}},r.addResizeEventHandler(n,s,200),t.setModelAndListenForChanges(n,i.buildPathFromUrl()).then(s).then(function(){if(n.descriptionBody=_.get(n,"selectedModel.mediumDescription",!1),!n.descriptionBody){var e=_.get(n,"selectedModel.longDescription",_.get(n,"longDescription",""));n.descriptionBody=o("limitHtml")({text:e,limit:EX,truncationString:"&hellip;",breakOnBrTag:!0,preserveInlineStyles:!0})}})},template:_X}}function Ul(e,t,i,n,r,o,a,s,c){"ngInject";function l(){e.translatedEditionNames=[],_.forEach(e.purchasableEditions,function(t,i){var n=e[c.htmlToScopeAttribute(t.editionKey)]||_.get(t,"editionName",t.editionKey);e.translatedEditionNames.push({offerId:t.offerId,value:n}),t.offerId===e.selectedModel.offerId&&(e.selectedEdition=e.translatedEditionNames[i])})}function d(){t.setModelAndListenForChanges(e,i.buildPathFromUrl()).then(n.setEditions).then(_.partial(s.populateScope,e,xX,_.get(e,["selectedModel","ocdPath"]),!1)).then(l).then(_.partial(r.digestIfDigestNotInProgress,e))}d(),t.listenForCollectionUpdate(e,d,!1),e.updateModel=function(e){t.events.fire(o.eventName,e)},e.handleChange=function(t){var i=_.find(e.purchasableEditions,{offerId:t.offerId});a.handleDropdownEditionChange(i,_.get(e,"selectedModel"))},e.getTranslatedEditionName=function(t){return _.find(e.translatedEditionNames,{offerId:t}).value},e.goToPdp=i.goToPdp}function Bl(e,t,i,n,r,o){"ngInject";function a(){e.ocdDataReady=!0,o.digestIfDigestNotInProgress(e)}n.setModelAndListenForChanges(e,r.buildPathFromUrl()).then(_.partial(i.handleAutoActions,!1)).then(function(){window.requestAnimationFrame(a)}).catch(function(){t.goToState(DX)})}function Ml(e,t,i,n){"ngInject";t.setModelAndListenForChanges(e,i.buildPathFromUrl()).then(_.partial(n.digestIfDigestNotInProgress,e))}function jl(e,t,i,n){"ngInject";t.setModelAndListenForChanges(e,i.buildPathFromUrl()).then(_.partial(n.digestIfDigestNotInProgress,e))}function Hl(e,t,i,n,r,o,a){"ngInject";function s(){e.ownsGreaterOrEqualEditionNotVault=t.ownsGreaterOrEqualEditionNotVault(e.editions,e.model),e.isGiftable=a.isGameGiftable(e.model),e.ownsGreaterEditionNotVault=t.ownsGreaterEditionNotVault(e.editions,e.model),o.digestIfDigestNotInProgress(e)}function c(){i.setModelAndListenForChanges(e,n.buildPathFromUrl(),s).then(r.setEditions).then(s)}c(),i.listenForCollectionUpdate(e,c,!1)}function zl(e,t){"ngInject";e.packArtDefault=t.getImagePath("packart-placeholder.jpg")}function Vl(e,t,i,n,r){"ngInject";function o(){var t=_.get(e,["model","platforms"],{});e.platformArray=_.map(t,function(e,t){if(!_.isUndefined(e.releaseDate))return t}),n.digestIfDigestNotInProgress(e)}t.setModelAndListenForChanges(e,i.buildPathFromUrl(),o).then(o),r.populateScope(e,BX)}function Wl(e,t){var i=void 0;return(e=_.isString(e)?e:_.isNumber(e)?e.toString():function(){var e=location.hash;return 0===e.indexOf("#")?decodeURIComponent(e.slice(1)):e}())?(i=document.getElementById(e))?ql(i,t):(i=Array.from(document.getElementsByName(e))[0])?ql(i,t):"top"===e?ql():void 0:ql(null,t)}function ql(e,t){if(e){if(e.scrollIntoView(),t){var i=e.getBoundingClientRect().top;window.scrollBy(0,i-t)}}else window.scrollTo(0,0)}function Yl(e){"ngInject";function t(e){return window.matchMedia("(max-width: "+e+"px)").matches}function i(e){return window.matchMedia("(min-width: "+e+"px)").matches}function n(e){if(0===angular.element(e).length)return!1;var t=angular.element(window),i=angular.element(e),n=t.scrollTop(),r=t.scrollLeft(),o=r+t.width(),a=n+t.height(),s=i.offset().left,c=i.offset().top,l=s+i.outerWidth(),d=c+i.outerHeight();return!(o<s||r>l||a<c||n>d)}function r(e){if(0===angular.element(e).length)return!1;var t,i,n,r=(t=angular.element(window),i=t.scrollTop(),n=t.scrollLeft(),{top:i,right:n+t.width(),bottom:i+t.height(),left:n}),o=function(e){var t=angular.element(e),i=t.offset(),n=i.top,r=i.left;return{top:n,right:r+t.outerWidth(),bottom:n+t.outerHeight(),left:r}}(e);return r.top<o.top&&r.bottom>o.bottom&&r.left<o.left&&r.right>o.right}function o(e){var t=angular.element(window).scrollTop();return angular.element(e).offset().top+angular.element(e).outerHeight()<t}function a(e){d?++l>VX&&e():l=0,d=!0}var s=new Origin.utils.Communicator,c=0,l=0,d=!0;return{isXSmall:function(){return t(e.GLOBAL.xsmall)},isSmall:function(){return t(e.GLOBAL.small)||window.innerWidth===e.GLOBAL.small},isLarge:function(){return i(e.GLOBAL.large)||window.innerWidth>=e.GLOBAL.large},isOnScreen:n,isElementOnScreen:r,isElementOffScreen:function(e){return!r(e)},isAboveScreen:o,isOnOrAboveScreen:function(e){return n(e)||o(e)},scrollTo:function(e,t,i){var n=angular.element("#"+e);if(n.length&&angular.isDefined(n.offset)){var r=n.offset().top-(t||0);angular.element("html, body").animate({scrollTop:r},i||qX)}},isPdpLarge:function(){return!t(e.STORE.large)},disableBodyScrolling:function(){c=window.pageYOffset,angular.element("body").css("top","-"+c+"px").addClass(HX)},enableBodyScrolling:function(){angular.element("body").css("top","").removeClass(HX),window.scrollTo(0,c)},addSmallMediaQueryListener:function(t){var i=window.matchMedia("(max-width: "+e.GLOBAL.small+"px)");return i.addListener(t),function(){i.removeListener(t)}},isHomeXSmall:function(){return t(e.HOME.xsmall)},isHomeLarge:function(){return t(e.HOME.large)},hasMinWidth:i,setScrollPositionWhileContentLoads:function(e){var t=_.throttle(function(){Wl(null,e())},zX),i=s.on(jX,t).detach,n=function(){i(),document.removeEventListener(WX,r),l=0,d=!0},r=_.partial(a,n);return document.addEventListener(WX,r),n},events:s}}function Kl(e,t){"ngInject";return t.get("ScreenFactory",Yl,this,arguments)}function Ql(e,t,i,n,r,o,a,s){"ngInject";function c(){e.ocdDataReady=!0,a.digestIfDigestNotInProgress(e),s.events.fire(jX)}t.setModelAndListenForChanges(e,i.buildPathFromUrl(),c).then(n.setEditions).then(r.setVaultEdition).then(o.setBasegame).then(c)}function Jl(e,t,i,n,r,o){"ngInject";function a(){e.ownsGreaterEditionNotVault=t.ownsGreaterEditionNotVault(e.editions,e.model),o.digestIfDigestNotInProgress(e)}function s(){i.setModelAndListenForChanges(e,n.buildPathFromUrl(),a).then(r.setEditions).then(a)}s(),i.listenForCollectionUpdate(e,s,!1)}function Xl(e,t,i,n){"ngInject";return{restrict:"E",template:JX,link:function(r,o){function a(e){u=e}function s(){var e=o.find(eZ),t=e.width()*ZX;e.height(t),r.showVideo&&(p.height(t),r.updateMarginTop(t))}function c(e){var t;u&&r.videoId&&(t=u.getPlayerState(),e&&t===m.PAUSED?r.playVideo():e||t!==m.PLAYING||u.pauseVideo())}function l(){c(!1)}function d(){c(!0)}function g(){var t=o.find(eZ);e.loadYoutubePlayer(t,r.videoId,{controls:1},p.width(),p.width()*ZX).then(a)}var u,p=o.find(".origin-pdp-hero-video"),m=e.PLAYER_STATES;Origin.events.on(Origin.events.CLIENT_VISIBILITY_CHANGED,c),Origin.events.on(Origin.events.CLIENT_NAV_REDRAW_VIDEO_PLAYER,s),i.events.on("games:finishedPlaying",d),i.events.on("games:startedPlaying",l),n.getUserAgeStateObservable().attachToScope(r,function(e){r.isUnderAge=e.isUnderAge,r.isAgeUnknown=e.isAgeUnknown,r.isUnderAge||(o.find(".origin-agegate").hide(),r.showVideo&&!u&&g())}),r.hide=function(){u.stopVideo(),r.stopVideo()},r.playVideo=function(){r.showVideo=!0,s(),r.matureContent&&r.matureContent!==XX.false&&(r.isAgeUnknown||r.isUnderAge)?p.find(".origin-agegate:hidden").show():u.playVideo()},r.$on("$destroy",function(){Origin.events.off(Origin.events.CLIENT_VISIBILITY_CHANGED,c),Origin.events.off(Origin.events.CLIENT_NAV_REDRAW_VIDEO_PLAYER,s),i.events.off("games:finishedPlaying",d),i.events.off("games:startedPlaying",l)}),r.$watchOnce("videoId",function(e,i){e!==i&&(t.addResizeEventHandler(r,s),g())})}}}function Zl(e){"ngInject";var t=function(e){return n=e,(i=nZ)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},rZ,oZ),link:function(i,n){e.populateScopeAndSlingDataToDom(i,iZ,n,t,void 0,void 0,_.keys(rZ))}}}function ed(e,t,i,n,r){"ngInject";function o(e){e&&(s.createASimsProducts=e[r.CREATE_A_SIM],s.buildASimsProducts=e[r.BUILD_A_SIM],(s.createASimsProducts.items.length||s.buildASimsProducts.items.length)&&s.originStorePdpSectionWrapper&&_.isFunction(s.originStorePdpSectionWrapper.setVisibility)&&s.originStorePdpSectionWrapper.setVisibility(!0)),s.isLoading=!1}function a(){s.isLoading=!1}var s=this;s.$onInit=function(){s.isLoading=!0,s.limit=s.limit>0?s.limit:sZ,s.strings={showMoreText:t.getLocalizedStr(s.showMoreText,cZ,"show-more-text"),contentTitle:t.getLocalizedStr(s.contentTitle,cZ,"content-title"),contentDescription:t.getLocalizedStr(s.contentDescription,cZ,"content-description"),createASimSectionHeader:t.getLocalizedStr(s.createASimSectionHeader,cZ,"create-a-sim-section-header"),buildASimSectionHeader:t.getLocalizedStr(s.buildASimSectionHeader,cZ,"build-a-sim-section-header")},n.getCreativeCommunityImages(i.buildPathFromUrl()).then(o).catch(a).then(function(){e.$digest()})}}function td(e){"ngInject";return{restrict:"E",scope:Object.assign({},gZ,uZ),link:function(t,i){e.populateScopeAndSlingDataToDom(t,dZ,i,function(e){return{"origin-store-pdp-sims-mediacarousel":e}},void 0,void 0,_.keys(gZ))}}}function id(e,t,i,n,r,o,a){"ngInject";return{require:"?^originStorePdpSectionWrapper",restrict:"E",link:function(s,c,l,d){function g(t){return _.map(t,function(t){return{src:t.imageUrl,trustedSrc:e.trustAsResourceUrl(t.imageUrl),type:"image",matureContent:!1,creatorId:t.creatorId,creatorNameText:(i=t.creatorName,o.getLocalizedStr(s.simsCreatorCaption,fZ,"sims-creator-caption",{"%creatorname%":i})||i),creationName:t.creationName};var i})}s.goToProfile=function(e,t){e.preventDefault(),e.stopPropagation(),a.promiseLogin().then(function(){r.goUserProfile(t,void 0,!1)})},s.openModal=function(e){i.openDirective({id:"web-media-overlay",name:"origin-dialog-content-sims-media-carousel",dialogClass:"origin-store-pdp-sims-carouselimage-dialog",size:"large",closeOnStateChange:!0,data:{id:"web-media-overlay",items:s.media,active:e,matureContent:s.media[e].matureContent}})},s.$on("postrepeat:last",function(){window.requestAnimationFrame(function(){s.$broadcast("originStoreCarousel:gameTileRemoved")})});var u=s.minNumberImages>0?parseInt(s.minNumberImages,10):vZ;if(n.getCreativeCommunityMediaCarouselImages(t.buildPathFromUrl()).then(function(e){e.length>=u&&(s.media=g(e),s.controlButtonColor=s.controlButtonColor||RS.dark,d&&_.isFunction(d.setVisibility)&&_.isFunction(d.setHeaderClass)&&(d.setVisibility(!0),d.setHeaderClass(hZ)))}),d&&_.isFunction(d.getHeaderHref)){var p=d.getHeaderHref();d.setHeaderHref(n.localizeSimsMediaCarouselUrl(p))}},scope:{controlButtonColor:"@",minNumberImages:"@"},template:mZ}}function nd(e,t,i,n,r,o){"ngInject";return{scope:{ocdPath:"@",offerType:"@",offerDescriptionTitle:"@",offerDescription:"@",showDescription:"@",bulletPointOneStr:"@",bulletPointTwoStr:"@",bulletPointThreeStr:"@",bulletPointFourStr:"@",includedWithSubscriptionStr:"@",includedWithBothSubscriptionStr:"@",includedWithBasicSubscriptionStr:"@",includedWithPremierSubscriptionNonSubscriberStr:"@",includedWithPremierSubscriptionStr:"@"},transclude:!0,require:["?^originBasegamePurchasesuggestion","?^originDialogContentDlcupsellxsellsuggestion","?^originDialogContentSoftDependencySuggestion","?^originDialogContentVaultPurchasesuggestion","?^originDialogContentVaultPurchasewarning","?^originBasegamePurchaseReplacementSuggestion","?^originDialogContentSoftBundlingSwap","?^originMandatoryBasegamePurchasesuggestion","?^originFreeBasegameEntitleSuggestion"],link:function(a,s,c,l){function d(){return{isBasicVaultOffer:n.isVaultGameOrUpgradeable(a.model),isPremierVaultOffer:r.isPremierVaultGameOrUpgradable(a.model)}}function g(){var e,i,n;o.isStandardSubscriber()?(e=d(),i=e.isBasicVaultOffer,n=e.isPremierVaultOffer,i&&(a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithSubscriptionStr,SZ,IZ)),n&&!i&&(a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithPremierSubscriptionStr,SZ,"included-with-premier-subscription-str"))):o.isPremiumSubscriber()?function(){var e=d(),i=e.isBasicVaultOffer,n=e.isPremierVaultOffer;(i||n)&&(a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithSubscriptionStr,SZ,IZ))}():function(){var e=d(),i=e.isBasicVaultOffer,n=e.isPremierVaultOffer;n&&i?a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithBothSubscriptionStr,SZ,"included-with-both-subscription-str"):n&&!i?a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithPremierSubscriptionNonSubscriberStr,SZ,"included-with-premier-subscription-non-subscriber-str"):i&&(a.strings.subscriptionInfoBlockText=t.getLocalizedStr(a.includedWithBasicSubscriptionStr,SZ,"included-with-basic-subscription-str"))}()}var u=_.head(_.compact(l));a.strings={bulletPoint1Str:t.getLocalizedStr(a.bulletPointOneStr,SZ,"bullet-point-one-str"),bulletPoint2Str:t.getLocalizedStr(a.bulletPointTwoStr,SZ,"bullet-point-two-str"),bulletPoint3Str:t.getLocalizedStr(a.bulletPointThreeStr,SZ,"bullet-point-three-str"),bulletPoint4Str:t.getLocalizedStr(a.bulletPointFourStr,SZ,"bullet-point-four-str")},u&&_.isFunction(u.handleOfferActions)&&(a.onClick=function(e){return u.handleOfferActions(e)}),e.populateScopeWithOcdAndCatalog(a,SZ,a.ocdPath,function(e){a.showDescription!==OS.true||a.offerDescription||(a.offerDescriptionTitle=e.shortDescription,a.offerDescription=t.truncateString(e.longDescription,kZ,"&hellip;")),a.model=e}).then(function(){_.isUndefined(a.showDescription)&&(a.showDescription=0===_.compact(_.values(a.strings)).length),a.offerType=a.offerType||US.xsell,a.showPrice=a.offerType!==US.vault&&a.offerType!==US.vaultInLibrary&&a.offerType!==US.swap&&a.offerType!==US.free,a.showPrice=![US.vault,US.vaultInLibrary,US.swap,US.free].includes(a.offerType),g(),i.digestIfDigestNotInProgress(a)})},template:yZ}}function rd(e,t,i,n,r,o,a){"ngInject";function s(){Promise.all([function(e){var t=[];return _.isArray(e)&&(t=_.map(e,n.ownsEntitlementByMasterTitleId)),Promise.all(t).then(c)}(_.get(e,"baseGameModel.alternateMasterTitleIds",[])),n.ownsEntitlementByMasterTitleId(_.get(e,"baseGameModel.masterTitleId",[]))]).then(c).then(l)}function c(e){return e.some(function(e){return!0===e})}function l(t){e.ownsBaseGame!==t&&(e.ownsBaseGame=t,r.digestIfDigestNotInProgress())}e.ownsBaseGame=!1,e.goToBaseGamePdp=function(){e.baseGameModel&&i.goToPdp(e.baseGameModel)},t.populateScope(e,_Z),n.events.on("games:baseGameEntitlementsUpdate",s),e.$on("$destroy",function(){n.events.off("games:baseGameEntitlementsUpdate",s)}),o.setModel(e,i.buildPathFromUrl(),{throwError:!1}).then(a.setBasegame).then(s)}function od(e){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",comparisonTableTitle:"@",comparisonTableSubtitle:"@",comparisonTableFlag:"@",ocdPath1SuppressForInterstitial:"@",comparisonTableOcdPath2:"@",ocdPath2SuppressForInterstitial:"@",comparisonTableOcdPath3:"@",ocdPath3SuppressForInterstitial:"@",comparisonTableOcdPath4:"@",ocdPath4SuppressForInterstitial:"@",comparisonTableOcdPath5:"@",ocdPath5SuppressForInterstitial:"@",ctid:"@"},link:function(t,i){e.populateScopeAndSlingDataToDom(t,EZ,i,function(e){return{"origin-store-pdp-comparison-table":e}})}}}function ad(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function sd(e,t,i,n,r,o){"ngInject";function a(e){return t.getLocalizedStr(!1,xZ,e)}var s=[],c=[];this.getOriginalListOcdPaths=function(){return c},e.setOriginalListOcdPaths=function(e){c=e},e.models={},e.buyNow=a("buynow"),e.youOwnThis=a("you-own-this"),e.vaultFlag=a("vault-flag"),e.premierVaultFlag=a("premier-vault-flag"),e.download=a("download"),e.buy=a("buy"),e.upgrade=a("upgrade"),e.pricingErrorMessage=a("pricing-error-message"),e.SUBSCRIPTION_LEVEL=yI.y,e.isModelSet=function(){return!_.isEmpty(e.models)},this.registerComparisonItem=function(t){s.push(t),e.isModelSet()&&t(e.models,{indicesForOcdPathsToSuppress:e.indicesForOcdPathsToSuppress})},e.setVaultAndOwnershipFlags=function(){e.inVault=!1,e.vaultStatus=[],_.forEach(e.models,function(t){var i;n.isOwnedOutright(t)&&(e.oneEditionIsOwned=!0),e.vaultStatus.push((ad(i={},yI.y.STANDARD,o.isVaultGame(t)),ad(i,yI.y.PREMIUM,r.isPremierVaultGame(t)),i))})},e.isSubscriberAndDoesNotOwnBetterEdition=i.isSubscriberAndDoesNotOwnBetterEdition,e.notifyAllComparisonItems=function(t){e.isModelSet()&&_.forEach(s,function(i){return i(t,{indicesForOcdPathsToSuppress:e.indicesForOcdPathsToSuppress})})},e.isModelOwnedOutright=n.isOwnedOutright,e.applyModelData=function(t){return!!t&&(e.models=t,e.ocdPathLength=_.size(e.models),e.ocdPaths=Object.keys(e.models),e.notifyAllComparisonItems(e.models),e.setVaultAndOwnershipFlags(),!0)}}function cd(e,t,i,n,r,o){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",comparisonTableTitle:"@",comparisonTableSubtitle:"@",comparisonTableFlag:"@",comparisonTableOcdPath1:"@",comparisonTableOcdPath2:"@",comparisonTableOcdPath3:"@",comparisonTableOcdPath4:"@",comparisonTableOcdPath5:"@",comparisonTableShowCta:"@"},controller:sd,require:"^originStorePdpSectionWrapper",link:function(e,i,a,s){function c(e){e&&s.setVisibility(!0)}function l(){e.comparisonTableShowCta=e.comparisonTableShowCta||OS.true}e.isBuyCta=function(t){return e.isModelSet()&&o.isBuyCta(e.models[t],e.models,e.user.isSubscriber)},e.isGetCta=function(t){return e.isModelSet()&&o.isGetCta(e.models[t],e.models,e.user.isSubscriber)},e.isUpgradeCta=function(t){return e.isModelSet()&&o.isUpgradeCta(e.models[t],e.models,e.user.isSubscriber)},e.isPlayCta=function(t){return e.isModelSet()&&o.isPlayCta(e.models[t])},function(){r.getObserver(e,"user");var i=_.compact([e.comparisonTableOcdPath1,e.comparisonTableOcdPath2,e.comparisonTableOcdPath3,e.comparisonTableOcdPath4,e.comparisonTableOcdPath5]);if(i.length>0){var o=_.map(i,t.getByOcdPathPromise);Promise.all(o).then(n.unwrapEditions).then(e.applyModelData).then(c).then(l)}}()},template:FZ}}function ld(e){"ngInject";return{restrict:"E",transclude:!0,scope:{ocdIndex:"@",titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",ctid:"@"},link:function(t,i){e.populateScopeAndSlingDataToDom(t,LZ,i)},controller:"originHeroWrapperCtrl"}}function dd(e,t,i,n,r,o,a,s,c){"ngInject";function l(){e.ownsLesserEdition=o.ownsLesserEdition(e.editions,e.model),e.isPurchaseAction=i.isPurchaseAction(e.model),e.isEntitleAction=i.isEntitleAction(e.model),e.isPlayAction=i.isPlayAction(e.model),e.isExternalAction=i.isExternalAction(e.model),e.buttonType=c.isPlayAction(e.model)||c.isAddToLibraryCta(e.model,e.ownsLesserEdition)||c.showSubscriptionUpsellArea(e.model)||c.showUpgradeToVaultEdition(e.model)?"transparent":"primary",s.digestIfDigestNotInProgress(e)}function d(){n.setModelAndListenForChanges(e,r.buildPathFromUrl(),l).then(a.setEditions).then(l)}e.installable=!1,e.isBrowserGame=!1,e.isContextMenuVisible=!1,e.isGiftable=!1,t.populateScope(e,DZ),d(),n.listenForCollectionUpdate(e,d,!1)}function gd(e,t,i,n){"ngInject";return{require:"^originStorePdpSectionWrapper",restrict:"E",scope:{},link:function(e,r,o,a){n.getByOcdPathPromise(i.buildPathFromUrl()).then(function(t){_.set(e,"model",_.head(_.values(t))),e.model.longDescription&&(e.longDescription=e.model.longDescription,a.setVisibility(!0))}).catch(function(e){return t.error("originStorePdpDescription loading model error",e)})},template:wJ}}function ud(e,t){"ngInject";return{restrict:"E",replace:!0,require:"^originStorePdpDetails",scope:{icon:"@",key:"@",overrideText:"@",url:"@"},link:function(i,n,r,o){i.key&&(i.translatedText=e.getLocalizedStr(i.overrideText,NZ,i.key),o.registerItemWithData()),i.url&&(i.openLink=function(e,i){i.preventDefault(),t.openLink(e)},i.absoluteUrl=t.getAbsoluteUrl(i.url))},template:$Z}}function pd(e){"ngInject";return{restrict:"E",scope:{ocdIndex:"@",titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",ctid:"@"},link:function(t,i){e.populateScopeAndSlingDataToDom(t,UZ,i,function(e){return n=e,(i=BZ)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n})}}}function md(e){"ngInject";this.registerItemWithData=function(){e.detailsItemAdded()}}function fd(e,t){"ngInject";t.populateScope(e,HZ,void 0,!1).then(function(){e.translatedEditionName=_.get(e,_.camelCase(e.editionName),e.editionName),e.$digest()})}function hd(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){e.hideEntitlementOptions=i.isEntitlementAreaHidden(e.model,e.editions),e.isProductReleased=s.isReleased(e.model),c.digestIfDigestNotInProgress(e)}function g(){r.setModelAndListenForChanges(e,o.buildPathFromUrl(),d).then(a.setEditions).then(d)}e.isActiveTrial=i.isActiveTrial,e.isUnknownTrial=i.isUnknownTrial,e.isExpiredTrial=i.isExpiredTrial,e.goToLibrary=function(e,t){t.preventDefault(),n.goToState(WZ,{offerid:e})},e.inactiveTrialMessage=function(i){return t.getLocalizedStr(e.startNewTrial,VZ,"start-new-trial",{"%duration%":i.trialLaunchDuration})},e.activeTrialMessage=function(i){var n=_.get(i,"displayName"),r=i.trialTimeRemaining?Math.ceil(_.get(i,["trialTimeRemaining","leftTrialSec"],0)/3600):0;return t.getLocalizedStr(e.activeTrial,VZ,"active-trial",{"%game%":n,"%hours%":r})},e.expiredTrialMessage=function(i){var n=i.displayName;return t.getLocalizedStr(e.expiredTrial,VZ,"expired-trial",{"%game%":n})},e.unknownTrialMessage=function(i){var n=i.displayName;return t.getLocalizedStr(e.unknownTrialTime,VZ,"unknown-trial-time",{"%game%":n})},e.getLibraryUrl=function(e){return n.getAbsoluteUrl(WZ,{offerid:e})},l.populateScope(e,VZ).then(g).then(function(){e.entString={startNewTrial:t.getLocalizedStr(e.startNewTrial,VZ,"start-new-trial"),viewInLibrary:t.getLocalizedStr(e.viewInLibrary,VZ,"view-in-library"),getTrial:t.getLocalizedStr(e.getTrial,VZ,"get-trial"),getBeta:t.getLocalizedStr(e.getBeta,VZ,"get-beta"),tryDemo:t.getLocalizedStr(e.tryDemo,VZ,"try-demo")}}),r.listenForCollectionUpdate(e,g,!1)}function vd(e){"ngInject";var t=function(e){return e["feature-hero-image"]&&(e["background-image"]=e["feature-hero-image"]),n=e,(i=KZ)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},QZ,JZ),link:function(i,n){e.populateScopeAndSlingDataToDom(i,YZ,n,t,void 0,void 0,_.keys(QZ))},controller:"originHeroWrapperCtrl"}}function bd(e){"ngInject";var t=function(e){return n=e,(i=e0)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},t0,i0),link:function(i,n){e.populateScopeAndSlingDataToDom(i,ZZ,n,t,void 0,void 0,_.keys(t0))},controller:"originHeroWrapperCtrl"}}function yd(e){"ngInject";var t=function(e){var t,i,n,r={};return _.forEach({"feature-hero-image":"background-image","quote-str":"quote-str","badge-image":"badge-image"},function(t,i){e[i]&&(r[t]=e[i])}),n=r,(i=o0)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t};return{restrict:"E",scope:Object.assign({},a0,s0),link:function(i,n){e.populateScopeAndSlingDataToDom(i,r0,n,t,void 0,void 0,_.keys(a0))},controller:"originHeroWrapperCtrl"}}function Sd(e){"ngInject";var t=function(e){return n=e,(i=d0)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},g0,u0),link:function(i,n){e.populateScopeAndSlingDataToDom(i,l0,n,t,void 0,void 0,_.keys(g0))},controller:"originHeroWrapperCtrl"}}function kd(e){"ngInject";this.setHasContent=function(t){t&&e.addClass("l-origin-store-herorow origin-ng-element")}}function Id(e){"ngInject";var t=function(e){var t,i,n,r={};return _.forEach({"feature-hero-image":"image"},function(t,i){e[i]&&(r[t]=e[i])}),n=r,(i=f0)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t};return{restrict:"E",scope:Object.assign({},h0,v0),link:function(i,n){e.populateScopeAndSlingDataToDom(i,m0,n,t,void 0,void 0,_.keys(h0))},controller:kd}}function wd(e){"ngInject";var t=function(e){var t,i,n,r={};return _.forEach({"video-text-slide":"text-slide","video-text-color":"text-color","video-text-align":"text-align","video-text":"text","video-header":"header","video-small-screen-imageurl":"small-screen-imageurl","video-id":"video-id","video-cta-type":"cta-type","video-cta-href":"cta-href","video-cta-description":"cta-description","video-image":"video-image","mature-content":"mature-content"},function(t,i){e[i]&&(r[t]=e[i])}),n=r,(i=y0)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t};return{restrict:"E",scope:Object.assign({},S0,k0),link:function(i,n){e.populateScopeAndSlingDataToDom(i,b0,n,t,void 0,void 0,_.keys(S0))},controller:"originHeroWrapperCtrl"}}function Cd(e,t,i){"ngInject";return{restrict:"E",transclude:!0,scope:{matureContent:"@",restrictedMessage:"@",videoId:"@",backgroundColor:"@",backgroundImage:"@"},controller:Td,link:function(n,r,o,a,s){s(n,function(e){r.find(C0).append(e)}),e.populateScope(n,P0).then(function(){i.setBackgroundColorOfElement(n.backgroundColor,r.find(C0),P0),n.videoId&&(n.backgroundImage||(n.backgroundImage=t.getStillImage(n.videoId)),n.videoReady=!1,n.showVideo=!1)})},template:w0}}function Td(e,t){"ngInject";e.videoButtonHandler=function(){e.playVideo()},e.updateMarginTop=function(e){t.find(T0).css("margin-top",e)},e.stopVideo=function(){e.showVideo=!1,t.find(T0).removeAttr("style")}}function Pd(e,t){"ngInject";t.populateScope(e,E0)}function _d(e,t){"ngInject";return{restrict:"E",scope:{legalNotes:"@",salesTax:"@",salesTaxUrl:"@"},link:function(i){function n(){var e='<a href="'+i.salesTaxUrl+'" class="otkc otkc-small external-link">'+i.salesTax+"</a>";i.legalNotesText=t.substitute(i.legalNotesText,{"%salestaxurl%":e})}i.legalNotesText=e.getLocalizedStr(i.legalNotes,L0,"legal-notes"),i.salesTax=e.getLocalizedStr(i.salesTax,L0,"sales-tax"),n();var r=i.$watch("legalNotes",function(e){e&&(i.legalNotesText=e,n(),r())})},template:x0}}function Od(e){"ngInject";var t=function(e){return t={},i=R0,n={items:e.items},i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},$0,N0,{ocdPath:"@"}),link:function(i,n){e.populateScopeAndSlingDataToDom(i,D0,n,t,i.ocdPath,void 0,_.keys($0))}}}function Ed(e){"ngInject";return{restrict:"A",link:function(t,i,n){i.removeAttr(W0),i.attr(CU,"true");var r=n.elementIndex||0,o={context:t,elementIndex:r,elementName:i[0].localName+"-"+r,element:i,showOnNav:V0()(n.showOnNav)||""===n.showOnNav||n.showOnNav===OS.true};setTimeout(function(){return function(t){e.enqueue(TU,t)}(o)},0)}}}function Fd(e,t,i){"ngInject";e.strings={titleText:t.getLocalizedStr(e.titleText,Q0,"title-text")},e.getAvailabilityText=function(){if(e.availabilityText)return e.availabilityText;var i=e.availabilityDate;return i?t.getLocalizedStr("",Q0,"dateavailabilitystr",{"%endDate%":moment(i).format("LL")}):t.getLocalizedStr(e.availabilityText,Q0,"availability-text")},e.goToOthPage=function(){i.events.fire("uiRouter:go","app.store.wrapper.onthehouse")}}function xd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ld(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";return{restrict:"E",require:"?^originStorePdpSectionWrapper",scope:{genre:"@",releasedate:"@",rating:"@",developer:"@",publisher:"@",supportedLanguages:"@",gameLinks:"@",officialSite:"@",forumSite:"@",sunsetTitle:"@"},link:function(e,i,r,g){function p(e,t){return i1.replace("{url}",e).replace("{label}",t)}function m(e,t,i){var n=_.get(e,t+s1,_.get(e,t,!1)),r=[];return n&&(r=(i?n.split(","):[n]).map(function(e){var i,n,r=u.sanitize(e),o=u.getLocalizedStr(!1,mW,r+n1),a=(i=t,n=r,d.getBrowsePageUrl(i+":"+n));return{label:o,url:a,absUrl:c.getAbsoluteUrl(a)}})),r}function f(t){var i=m(e.model,t,c1[t]);e[t+"Link"]=i.length>0&&i[0]}e.schemaItemType=t1,e.openLink=function(e,t){t.preventDefault(),c.openLink(e)};var h=d.isPdpRoute()?l.getByOcdPathPromise(d.buildPathFromUrl()).then(_.values).then(_.head):o.getEditionAgnosticModelPromise(a.buildPathFromUrl()).then(So);Promise.all([h,n.populateScope(e,e1)]).then(_.spread(function(t){t&&(e.model=t,function(t){var i=_.get(e,["model","i18n","preAnnouncementDisplayDate"]);i?e.formattedReleaseDate=i:t.releaseDate&&(e.formattedReleaseDate=moment(t.releaseDate).format("LL"))}(e.model),function(t){_.isArray(t.softwareLocales)&&(e.softwareLocales=s.getLanguages(t.softwareLocales).join(", "))}(e.model),e.genreLinks=m(e.model,a1,c1[a1]),f(r1),f(o1),function(t){var i=[],n=_.get(t,["i18n","officialSiteURL"],_.get(t,"officialSiteURL")),r=_.get(t,["i18n","gameForumURL"],_.get(t,"gameForumURL"));e.officialSite&&n&&i.push(p(n,e.officialSite)),e.forumSite&&r&&i.push(p(r,e.forumSite)),e.gameLinksHtml=i.join("<br/>")}(e.model),g&&_.isFunction(g.setVisibility)&&g.setVisibility(!0))})).catch(function(e){return t.error("PDP Overview error",e)})},template:Z0}}function Ad(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";function m(){if(e.ownedEdition){if(s.isBaseGameOfferType(e.ownedEdition)){var t=(i=e.ownedEdition,n=o.htmlToScopeAttribute(i.editionKey),b[n]||_.get(i,"editionName",i.editionKey));return c.isInTheFuture(_.get(e,["ownedEdition","releaseDate"]))?e.youPreorderedText.replace("%edition%",t):e.youOwnText.replace("%edition%",t)}return e.youownthis}return"";var i,n}function f(t){e.getLibraryUrl=i.getAbsoluteUrl(u1,{offerid:t})}function h(){var t,i;s.isBaseGameOfferType(e.model)&&!_.isEmpty(e.editions)?e.ownedEdition=r.getTopOwnedEdition(e.editions):_.get(e,["model","isOwned"])&&(e.ownedEdition=e.model),t=_.get(e.ownedEdition,"displayName"),i=moment(_.get(e.ownedEdition,"downloadStartDate")).format("LL"),e.isBundle=!!e.ownedEdition&&s.isBundle(e.ownedEdition),e.isPreloadable=!!e.ownedEdition&&a.isPreloadable(e.ownedEdition),e.isPreloaded=!!e.ownedEdition&&a.isInstalled(e.ownedEdition),e.isDownloadable=!!e.ownedEdition&&a.isDownloadable(e.ownedEdition),e.ownedMessage=m(),e.isReleased=c.isInThePast(_.get(e,["model","releaseDate"])),e.preorderReleaseDate=_.get(e,["model","i18n","preAnnouncementDisplayDate"])||c.formatDateWithTimezone(_.get(e,["model","releaseDate"])),e.ownershipStrings={preorderMessage:o.getLocalizedStr(e.preorderMessage,d1,"preorder-message",{"%date%":""}),vaultEditionOwnedBySubscriber:o.getLocalizedStr(e.vaultEditionOwnedBySubscriber,d1,"vault-edition-owned-by-subscriber",{"%game%":t}),preloadMessage:o.getLocalizedStr(e.preLoadText,d1,"pre-load-text",{"%date%":i,"%preloaddate%":i})},e.ownedEdition&&u.getHighestOwnedBaseGameOfferId(e.ownedEdition.offerId,e).then(f),e.preloadDateTooFarAway=!c.isValidDate(_.get(e,["ownedEdition","downloadStartDate"])),p.digestIfDigestNotInProgress(e)}function v(){l.setModelAndListenForChanges(e,d.buildPathFromUrl(),h).then(g.setEditions).then(_.partial(t.populateScope,b,g1,_.get(e,["model","ocdPath"]),!1)).then(h)}n.getObserver(e,"user");var b={};t.populateScope(e,d1).then(v),l.listenForCollectionUpdate(e,v,!1)}function Dd(e){"ngInject";var t=function(e){return e["paragraph-text"]&&(e.text=e["paragraph-text"]),n=e,(i=f1)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},h1,v1),link:function(i,n){e.populateScopeAndSlingDataToDom(i,m1,n,t,void 0,void 0,_.keys(h1))}}}function Rd(e){"ngInject";var t=this;t.$onInit=function(){t.description=e.trustAsHtml(t.text),t.originStorePdpSectionWrapper.setVisibility(!0)}}function $d(e){"ngInject";return{restrict:"E",transclude:!0,scope:{ocdIndex:"@",titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",ctid:"@"},link:function(t,i){e.populateScopeAndSlingDataToDom(t,S1,i)},controller:"originHeroWrapperCtrl"}}function Nd(e){"ngInject";var t=function(e){return e["carousel-title"]&&(e["title-str"]=e["carousel-title"]),n=e,(i=w1)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},C1,T1),link:function(i,n){e.populateScopeAndSlingDataToDom(i,I1,n,t,void 0,void 0,_.keys(C1))}}}function Gd(e){"ngInject";var t=function(e){var t,i,n;return _.some(E1,function(t){return!e[t]})?{}:(e["carousel-title"]&&(e["title-str"]=e["carousel-title"]),n=e,(i=O1)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t)};return{restrict:"E",scope:Object.assign({},F1,x1),link:function(i,n){e.populateScopeAndSlingDataToDom(i,_1,n,t,void 0,void 0,_.keys(F1))}}}function Ud(e,t,i,n,r,o){"ngInject";e.isSubscriber=r.userHasSubscription();var a=function(){e.formattedSaveText=e.saveText.replace("%savings%",_.get(e,["model","savings"],"")),n.digestIfDigestNotInProgress(e)},s=function(){return e.ocdPath||i.buildPathFromUrl()},c=function(){t.setModelAndListenForChanges(e,s(),a,{throwError:!1}).then(a)};o.populateScope(e,A1,s(),!1).then(c),t.listenForCollectionUpdate(e,c,!0)}function Bd(e,t,i,n,r){"ngInject";e.isVisible=!1,e.isSetVisiblityCalled=!1,this.setVisibility=function(i){e.isVisible!==i&&(e.isVisible=i,e.isSetVisiblityCalled=!0,t.digestIfDigestNotInProgress(e),i&&r.events.fire(jX))},this.getHeaderHref=function(){return e.headerHref},this.setHeaderHref=function(t){return e.headerHref=t},e.isExternal=!n.isInternalUrl(e.headerHref),e.openUrl=function(t){t.preventDefault(),i.openLink(e.headerHref)},this.setHeaderClass=function(t){e.headerCSSClass=t}}function Md(e){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",headerHrefTitle:"@",headerHref:"@",headerAlignment:"@",headerFontSize:"@",ctid:"@"},require:["^?originStorePdpFeatureHeroWrapper","^?originStorePdpFeatureVideoWrapper","^?originStorePdpFeatureContainerWrapper","^?originStorePdpFeaturePremierWrapper"],controller:Bd,link:function(t,i,n,r){var o=_.head(_.compact(r)),a=o&&_.isFunction(o.setHasContent),s=e.buildPathFromUrl();t.gdpPath=s.gdpPath,t.titleAlignment=_.get(t,"headerAlignment",AS.left),t.fontSize=_.get(t,"headerFontSize",DS.normal),t.notifyHeroParent=function(e){a&&o.setHasContent(e)},t.$watchOnce("isSetVisibilityCalled",function(e){e&&t.notifyHeroParent(t.isVisible)})},template:R1}}function jd(e,t){return["DirectiveScope",function(i){return{restrict:"E",scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",ctid:"@"},link:i.populateScopeLinkFn(e),template:t}}]}function Hd(e,t,i,n,r){"ngInject";return{restrict:"E",require:"?^originStorePdpSectionWrapper",link:function(o,a,s,c){(r.isPdpRoute()?t.getCatalogByPath(r.buildPathFromUrl()).then(_.values).then(_.head):i.getEditionAgnosticModelPromise(n.buildPathFromUrl())).then(function(e){var t=_.get(e,[DI.I,DI._29]);t&&(o.systemRequirements=t,c&&_.isFunction(c.setVisibility)&&c.setVisibility(!0))}).catch(function(t){return e.error("PDP System Requirements error",t)})},scope:{},template:U1}}function zd(e,t){"ngInject";return{restrict:"E",scope:{legalNotes:"@"},link:function(i){t.populateScopeWithOcdAndCatalog(i,M1,e.buildPathFromUrl(),"model")},template:GJ}}function Vd(e,t){"ngInject";function i(){n.backgroundImage&&(n.backgroundImageStyle={background:'url("'+n.backgroundImage+'") no-repeat 0 0'})}var n=this;n.showMore=function(){n.limitNum+n.showMoreIncrementNum<n.images.length?n.limitNum=n.limitNum+n.showMoreIncrementNum:(n.limitNum=n.images.length,n.displayShowMoreButton=!1)},n.$onInit=function(){n.strings={showMoreText:t.getLocalizedStr(n.showMoreText,j1,"show-more-text"),contentTitle:t.getLocalizedStr(n.contentTitle,j1,"content-title")},n.limitNum=parseInt(_.get(n,"limit",0),10),n.showMoreIncrementNum=parseInt(_.get(n,"showMoreIncrement",0),10),n.limitNum>=n.images.length?(n.limitNum=n.images.length,n.showMoreIncrement=n.limit,n.displayShowMoreButton=!1):(n.displayShowMoreButton=!0,n.showMoreIncrementNum=n.showMoreIncrementNum>0&&n.showMoreIncrementNum<n.images.length?n.showMoreIncrementNum:n.images.length-n.limit),e.populateWithDefaults(n,j1).then(i)}}function Wd(e,t,i,n,r,o){"ngInject";function a(){e.isUplayAccountLinkingRequired=null!==_.get(e,["selectedModel","forcePartnerEntitlementPending"],null)}e.isUplayAccountLinkingRequired=!1,e.strings={uplayHelpStr:i.getLocalizedStr("",Y1,"uplay-help-str"),uplayLinkRequiredStr:i.getLocalizedStr("",Y1,"uplay-link-required-str"),uplayHelpUrl:e.uplayHelpUrl.replace("%url-language%",Origin.locale.languageCode())},e.openExternalHelpWindow=function(t){t&&(t.stopPropagation(),t.preventDefault()),r.externalUrl(e.strings.uplayHelpUrl,!0)},n.setModelAndListenForChanges(e,t.buildPathFromUrl(),a).then(a).catch(function(e){return o.error("[pdpUplayLinkRequired]",e)})}function qd(e,t,i,n){"ngInject";return{restrict:"E",scope:{layout:"@",href:"@",textColor:"@",textAlignment:"@",backgroundColor:"@",backgroundImage:"@",lightGameLogo:"@",darkGameLogo:"@",quote1Str:"@",quote1SourceStr:"@",quote2Str:"@",quote2SourceStr:"@",quote3Str:"@",quote3SourceStr:"@"},link:function(r,o){r.layout=r.layout||Z1.hero,o.addClass(e2[r.layout]).addClass(n.layoutClass).addClass(n.telemetryClass),i.setBackgroundColorOfElement(r.backgroundColor,o,t2),e(function(){r.layout!==Z1.hero?r.textAlignment=X1.center:r.textAlignment=r.textAlignment||X1.center},0,!1),r.numberOfQuotes=_.compact([r.quote1Str,r.quote2Str,r.quote3Str]).length,r.strings={quote1Str:t.getLocalizedStr(r.quote1Str,t2,"quote1-str"),quote2Str:t.getLocalizedStr(r.quote2Str,t2,"quote2-str"),quote3Str:t.getLocalizedStr(r.quote3Str,t2,"quote3-str"),quote1SourceStr:t.getLocalizedStr(r.quote1SourceStr,t2,"quote1-source-str"),quote2SourceStr:t.getLocalizedStr(r.quote2SourceStr,t2,"quote2-source-str"),quote3SourceStr:t.getLocalizedStr(r.quote3SourceStr,t2,"quote3-source-str")}},template:J1}}function Yd(e,t,i){"ngInject";return{restrict:"E",scope:{layout:"@",href:"@",textColor:"@",backgroundColor:"@",backgroundImage:"@",badgeImage:"@",quoteStr:"@"},link:function(n,r){n.layout=n.layout||r2["full-width"],r.addClass(o2[n.layout]).addClass(i.layoutClass),t.setBackgroundColorOfElement(n.backgroundColor,r,a2),n.strings={quoteStr:e.getLocalizedStr(n.quoteStr,a2,"quote-str")}},template:n2}}function Kd(e,t,i,n,r,o){"ngInject";e.layout=e.layout||d2.hero,t.addClass(g2[e.layout]).addClass(n.layoutClass),t.addClass(n.telemetryClass),e.useH1=e.useH1Tag===l2.true,e.useH2=!e.useH1Tag;var a=e.headerSize||c2.medium;e.headerSizeClass=_.get(u2,a),this.init=function(n){var a,s,c;e.backgroundColor=r.setBackgroundColorOfElement(e.backgroundColor,t,n),e.calloutBackgroundColor=r.hexToRgba(e.calloutTextBackgroundColor),e.calloutBorderColor=r.hexToRgba(e.calloutTextBorderColor),e.textColor=p2[e.textColor]||p2.light,e.textColorClass=m2+e.textColor,e.strings={textFormatted:o.trustAsHtml(i.getLocalizedStr(e.text,n,"text",{"%callout-text%":(a=e.calloutText,s=">"+a+"</span>",c="",(e.calloutBackgroundColor||e.calloutBorderColor)&&(c='style="background-color:'+e.calloutBackgroundColor+"; border-color: "+e.calloutBorderColor+';" '),'<span class="callout-text otktitle-4-condensed" '+c+s)})),legalDisclaimerText:i.getLocalizedStr(e.legalDisclaimerText,n,"legal-disclaimer-text"),legalDisclaimerLinkText:i.getLocalizedStr(e.legalDisclaimerLinkText,n,"legal-disclaimer-link-text"),legalDisclaimerDialogHeaderText:i.getLocalizedStr(e.legalDisclaimerDialogHeaderText,n,"legal-disclaimer-dialog-header-text"),legalDisclaimerDialogBodyTitleText:i.getLocalizedStr(e.legalDisclaimerDialogBodyTitleText,n,"legal-disclaimer-dialog-body-title-text"),legalDisclaimerDialogBodyText:i.getLocalizedStr(e.legalDisclaimerDialogBodyText,n,"legal-disclaimer-dialog-body-text")}}}function Qd(e,t){"ngInject";return{restrict:"E",scope:{layout:"@",image:"@",titleStr:"@",headerSize:"@",href:"@",subtitleStr:"@",backgroundColor:"@",useH1Tag:"@",ctaText:"@",ctaType:"@",textColor:"@",showAccessBadge:"@",overrideAccessLogo:"@"},template:h2,controller:"OriginStorePromoCalloutCtrl",link:function(i,n,r,o){o.init(k2),i.textColor=y2[i.textColor]||y2.light,i.textColorClass=I2+i.textColor,i.hrefAbsoluteUrl=e.getAbsoluteUrl(i.href),i.openLink=function(t,i){t.preventDefault(),t.stopPropagation(),e.openLink(i)};var a=i.layout===b2.hero;i.shellHref=i.ctaText&&i.heroLayout?"":i.href,i.shouldShowCta=a&&i.ctaText,i.isExternaLink=t.isAbsoluteUrl(i.href);var s=i.headerSize||v2.medium;i.headerSizeClass=_.get(S2,s),i.ctaType=i.ctaType||w2.link}}}function Jd(e,t,i){"ngInject";function n(){e.largeScreen=i.isPdpLarge(),e.buttonType=e.largeScreen?P2.primary:P2.link}t.addResizeEventHandler(e,function(){n(),e.$digest()},100),n()}function Xd(e){"ngInject";return{restrict:"E",scope:{ctaText:"@",href:"@",isEntitlement:"@",offerId:"@"},link:function(t){t.$watchOnce("offerId",function(){e.getByOfferId(t.offerId).attachToScope(t,"model")}),t.infobubbleContent="<origin-store-game-rating></origin-store-game-rating><origin-store-game-legal></origin-store-game-legal>"},controller:Jd,template:T2}}function Zd(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",scope:{layout:"@",backgroundImage:"@",featureImage:"@",titleStr:"@",href:"@",subtitleStr:"@",backgroundColor:"@",useH1Tag:"@",ctaText:"@",ctaType:"@",titleImage:"@",textColor:"@"},template:O2,link:function(s,c){function l(){s.isSmallScreen=r.isSmall()}s.layout=s.layout||F2.hero,c.addClass(x2[s.layout]).addClass(t.layoutClass).addClass(t.telemetryClass),s.useH1=s.useH1Tag===E2.true,s.useH2=!s.useH1,s.textColor=A2[s.textColor]||A2.light,s.textColorClass="text-color-"+s.textColor,s.openLink=function(e,t){e.preventDefault(),n.openLink(t)},s.strings={},a.insertPriceIntoLocalizedStr(s,s.strings,s.titleStr,D2,"title-str"),a.insertPriceIntoLocalizedStr(s,s.strings,s.subtitleStr,D2,"subtitle-str"),s.backgroundColor=e.getLocalizedStr(s.backgroundColor,D2,"background-color"),s.ctaType=s.ctaType||L2.link,s.backgroundColor&&i.setBackgroundColorOfElement(s.backgroundColor,c,D2),o.addResizeEventHandler(s,function(){l(),s.$digest()},300),l(),s.isHrefExternal=e.isAbsoluteUrl(s.href)}}}function eg(e,t,i){"ngInject";return{restrict:"E",scope:{ctaText:"@"},link:function(n){function r(e){var t=e.isLoggedIn,r=void 0!==t&&t;n.showLogin=!r,i.digestIfDigestNotInProgress(n)}n.btnText=e.getLocalizedStr(n.ctaText,N2,"cta-text"),n.onBtnClick=function(){t.events.fire("auth:login")},n.$on("$destroy",function(){t.events.off("myauth:change",r)}),t.events.on("myauth:change",r),r({isLoggedIn:t.isAppLoggedIn()})},controller:"originStorePromoCtaCtrl",template:$2}}function tg(e,t,i,n,r,o,a,s){"ngInject";this.onScopeResolved=function(c){e.layout&&(t.addClass(H2[e.layout]).addClass(o.layoutClass),e.layout!==B2.hero&&(e.badgeImage=null)),t.addClass(o.telemetryClass),e.defaultedBackgroundColor=i.setBackgroundColorOfElement(e.backgroundColor||e.translatedBackgroundColor,t,c),e.strings={},e.strings.othText=a.getLocalizedStr(e.othText,c,"oth-text"),e.href=e.href?e.href:e.ocdPath?n.getGdpUrl(new KH(e.ocdPath)):null,e.useH1=e.useH1Tag===j2.true,e.useH2=!e.useH1,e.isPackartShown=e.titleImage?j2.false:e.showPackart,e.$watchOnce("model",function(){e.isOth=e.model.oth}),e.ctaType=e.ctaType||M2.link,s.getVaultGamesCount().then(function(t){return i=t,n=c,(o={})[dw]=_.get(i,[yI.y.STANDARD,yI.d]),o[gw]=_.get(i,[yI.y.PREMIUM,yI.d]),void r.waitForAllPriceInsertingPromises([r.insertPriceIntoLocalizedStr(e,e.strings,e.titleStr,n,"title-str",o),r.insertPriceIntoLocalizedStr(e,e.strings,e.bulletOne,n,"bullet-one",o),r.insertPriceIntoLocalizedStr(e,e.strings,e.bulletTwo,n,"bullet-two",o)],e);var i,n,o})}}function ig(e,t,i){var n=_.merge({layout:"@",image:"@",titleStr:"@",ctaText:"@",ctaType:"@",href:"@",matureContent:"@",ocdPath:"@",showPackart:"@",bulletOne:"@",bulletTwo:"@",backgroundColor:"@",translatedBackgroundColor:"@",badgeImage:"@",ratingFontColor:"@",useH1Tag:"@",titleImage:"@",othText:"@",showAccessBadge:"@",overrideAccessLogo:"@"},t);return["ComponentsConfigFactory","DirectiveScope",function(t,r){return{restrict:"E",scope:n,transclude:!0,controller:tg,link:function(t,n,o,a){_.isFunction(i)&&i(t),r.populateScopeWithOcdAndCatalog(t,e,t.ocdPath).then(function(){a.onScopeResolved(e)})},template:U2}}]}function ng(e){e.isEntitlement=!0}function rg(e){"ngInject";e.showRatingsArea="TW"===Origin.locale.countryCode()&&-1!==_.get(e,["model","gameRatingSystemIcon"],"").indexOf("TWAR_18")}function og(e,t){"ngInject";return{restrict:"E",scope:{startDate:"@",endData:"@",availableText:"@"},template:Q2,link:function(i){if(i.startDate||i.endDate){var n=t(i.startDate).format(X2),r=t(i.endDate).format(X2);i.aText=e.getLocalizedStr(i.availableText,J2,"available-text",{"%startDate%":n,"%endDate%":r})}}}}function ag(e){"ngInject";return{restrict:"E",transclude:!0,scope:{backgroundColor:"@",badgeImage:"@",image:"@",videoid:"@",webmVideoUrl:"@",mp4VideoUrl:"@",matureContent:"@",href:"@",layout:"@"},template:e3,link:function(t,i){t.images=[],t.image&&t.images.push(t.image),t.onBtnClick=function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.href;n&&e.openLink(n)};var n=i.parents(".origin-store-carousel-hero");n.length>0&&n.addClass("origin-store-promo-carousel"),t.showCmsVideo=t.webmVideoUrl&&t.mp4VideoUrl}}}function sg(e,t,i,n,r,o,a){"ngInject";this.onScopeResolved=function(s){var c,l,d,g,u,p=void 0;if(e.layout&&(t.addClass(a3[e.layout]).addClass(o.layoutClass),e.layout!==n3.hero&&(e.badgeImage=null)),t.addClass(o.telemetryClass),e.availableTextFormatted=(c=e.availableText,l=e.startDate,d=e.endDate,g=l?i(l).format(s3):"",u=d?i(d).format(s3):"",c?c.replace("%startDate%",g).replace("%endDate%",u):""),e.backgroundColor=n.setBackgroundColorOfElement(e.backgroundColor,t,s),e.strings={},e.href=e.href?e.href:e.ocdPath?"store"+e.ocdPath:null,e.showOcdPricing=e.showPricing===o3.true,e.showPriceCallout=e.showPriceCallout===o3.true,e.showDiscountPriceCallout=e.showDiscountPriceCallout===o3.true,e.showDIscountPercentageCallout=e.showDIscountPercentageCallout===o3.true,e.strings.othText=a.getLocalizedStr(e.othText,s,"oth-text"),e.href&&t.addClass(o.clickableClass),e.titleStr){p=e.calloutText?'<span class="callout-text origin-telemetry-callout-text">'+e.calloutText+"</span>":"";var m=a.getLocalizedStr(e.titleStr,s,"title-str",{"%callout-text%":p});e.useDynamicPriceCallout?r.insertPriceIntoLocalizedStr(e,e.strings,m,s,"title-str"):e.useDynamicDiscountPriceCallout?r.insertDiscountedPriceIntoLocalizedStr(e,e.strings,m,s,"title-str"):e.useDynamicDiscountRateCallout?r.insertDiscountedPercentageIntoLocalizedStr(e,e.strings,m,s,"title-str"):r.insertPriceIntoLocalizedStr(e,e.strings,m,s,"title-str")}e.text&&r.insertPriceIntoLocalizedStr(e,e.strings,e.text,s,"text"),!e.titleStr||e.text||e.ctaText||(e.titlePositionClass="origin-store-promo-banner-title-position-center"),e.useH1=e.useH1Tag===o3.true,e.isPackartShown=e.titleImage?o3.false:e.showPackart,e.$watchOnce("model",function(){e.isOth=e.model.oth}),e.ctaType=e.ctaType||r3.link}}function cg(e,t,i){var n=_.merge({layout:"@",image:"@",smallImage:"@",titleStr:"@",text:"@",ctaText:"@",ctaType:"@",matureContent:"@",startDate:"@",endDate:"@",availableText:"@",ocdPath:"@",showPricing:"@",showTestCheckbox:"@",showPackart:"@",backgroundColor:"@",badgeImage:"@",ratingFontColor:"@",useH1Tag:"@",href:"@",calloutText:"@",useDynamicPriceCallout:"@",useDynamicDiscountPriceCallout:"@",useDynamicDiscountRateCallout:"@",othText:"@",titleImage:"@",showAccessBadge:"@",overrideAccessLogo:"@"},t);return["DirectiveScope",function(t){return{restrict:"E",scope:n,transclude:!0,controller:sg,link:function(n,r,o,a){_.isFunction(i)&&i(n),t.populateScopeWithOcdAndCatalog(n,e,n.ocdPath).then(function(){a.onScopeResolved(e)})},template:i3}}]}function lg(e){e.isEntitlement=!0,e.showOcdPricing="true"===e.showPricing}function dg(e,t,i,n,r){"ngInject";function o(){e.timeReached&&(e.titleStr=e.postTitle||e.titleStr)}e.timer=!0,e.timerVisible=!0,e.type="timer",e.strings={},e.$on("timerReached",function(){e.hideTimer===h3.true&&(e.timerVisible=!1),e.timeReached=!0,o()}),this.onScopeResolved=function(a){e.layout&&(t.addClass(f3[e.layout]).addClass(n.layoutClass).addClass(n.telemetryClass),e.layout!==p3.hero&&(e.badgeImage=null)),o(),e.backgroundColor=i.setBackgroundColorOfElement(e.backgroundColor,t,a),e.strings.othText=r.getLocalizedStr(e.othText,a,"oth-text"),e.href=e.href?e.href:e.ocdPath?"store"+e.ocdPath:null,e.useH1=e.useH1Tag===h3.true,e.useH2=!e.useH1,e.isPackartShown=e.titleImage?h3.false:e.showPackart,e.$watchOnce("model",function(){e.isOth=e.model.oth}),e.ctaType=e.ctaType||m3.link}}function gg(e,t,i){var n=_.merge({layout:"@",image:"@",titleStr:"@",ctaText:"@",ctaType:"@",href:"@",matureContent:"@",ocdPath:"@",showPackart:"@",goaldate:"@",postTitle:"@",hideTimer:"@",backgroundColor:"@",badgeImage:"@",ratingFontColor:"@",useH1Tag:"@",showAccessBadge:"@",overrideAccessLogo:"@",titleImage:"@"},t);return["DirectiveScope",function(t){return{restrict:"E",scope:n,transclude:!0,controller:dg,link:function(n,r,o,a){_.isFunction(i)&&i(n),t.populateScopeWithOcdAndCatalog(n,e,n.ocdPath).then(function(){a.onScopeResolved(e)})},template:u3}}]}function ug(e){e.isEntitlement=!0}function pg(e,t,i,n,r,o){"ngInject";var a,s,c=(a=regeneratorRuntime.mark(function t(i){var a,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.model=i,t.next=3,n.isEligibleForPromotionByOfferId(e.offerId);case 3:a=t.sent,a.isEligible?n.getDiscountRateByOfferId(e.offerId).then(function(t){_.isUndefined(t)?(e.loyaltyOfferError=!0,e.model.pricingError=!0):(e.showLoyaltyOfferPrice=!0,e.strings.saveText=r.getLocalizedStr(e.saveText,w3,"save-text",{"%savings%":t}))}).catch(function(){e.loyaltyOfferError=!0,e.model.pricingError=!0}):e.strings.saveText=r.getLocalizedStr(e.saveText,w3,"save-text",{"%savings%":i.savings}),s=e.suppressDiscountPrice!==C3.true,c=e.model.vaultEntitlement,e.isFree=o.isFree(i),e.showFreeText=e.isFree&&(!e.model.isOwned||c),e.showPrice=(!e.model.isUpgradeable&&!e.model.vault||e.suppressAccessText)&&!e.model.isOwned&&!e.isFree&&e.model.price,e.showFormattedPrice=e.model.price&&!e.showFreeText&&!e.loyaltyOfferError,e.showSaveText=s&&e.strings.saveText&&e.model.strikePrice!==e.model.price&&!e.loyaltyOfferError,e.showFormattedStrikePrice=s&&e.model.strikePrice&&e.model.strikePrice!==e.model.price&&!e.loyaltyOfferError,e.showIncludedWithText=!e.isSubscriber&&!e.model.isOwned&&!e.isFree&&(e.model.vault||e.model.isUpgradeable)&&!e.suppressAccessText,e.showOwnedText=e.isOwnedTextVisible&&(e.model.isOwned&&!c||c&&!e.isFree),e.showAccessLogo=!e.model.isOwned&&e.isSubscriber&&!e.isFree&&(e.model.vault||e.model.isUpgradeable)&&!e.showOwnedText&&!e.suppressAccessText,e.isPricingLayoutHorizontal=T3.horizontal===e.pricingLayout,e.showSaveText&&e.showFormattedStrikePrice&&!e.isPricingLayoutHorizontal&&(l=e.strings.saveText.length+e.model.formattedStrikePrice.length,e.useSmallFontForPrice=l>16&&l<24,e.useExtraSmallFontForPrice=l>=24),e.priceLoadCompleted&&e.model.price&&e.priceLoadCompleted({model:e.model,showIncludedWIthText:e.showIncludedWithText,showOwnedText:e.showOwnedText,showAccessLogo:e.showAccessLogo}),e.$emit("priceVisible",e.showFreeText||e.showPrice&&(e.showFormattedPrice||e.showSaveText||e.showFormattedStrikePrice)||e.showIncludedWithText||e.showAccessLogo||e.showOwnedText);case 21:case"end":return t.stop()}},t,this)}),s=function(){var e=a.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e){return s.apply(this,arguments)});e.isSubscriber=i.userHasSubscription(),e.isFree=!1,e.isOwnedTextVisible=String(e.hideOwnedState).toLowerCase()!==C3.true,e.model={},e.showFreeText=!1,e.showPrice=!1,e.showFormattedPrice=!1,e.showSaveText=!1,e.showFormattedStrikePrice=!1,e.showIncludedWithText=!1,e.showAccessLogo=!1,e.showOwnedText=!1,e.suppressAccessText=e.suppressAccessText===C3.true||!1,e.loyaltyOfferError=!1,e.strings={ownedText:r.getLocalizedStr(e.ownedText,w3,"owned-text"),orText:r.getLocalizedStr(e.orText,w3,"or-text"),freeText:r.getLocalizedStr(e.freeText,w3,"free-text"),withText:r.getLocalizedStr(e.withText,w3,"with-text"),included:r.getLocalizedStr(e.included,w3,"included"),pricingErrorMessage:r.getLocalizedStr(void 0,w3,"pricing-error-message")},e.$watch("offerId",function(i){i&&t.getByOfferId(i).attachToScope(e,c)})}function mg(e,t,i,n){"ngInject";function r(i){n.isState(bI.s)&&F3.includes(e.categoryId)?e.hasSelectableFilters=!1:e.hasSelectableFilters=t.hasSelectableFilters(e.categoryId),i||(e.categoryExpanded=x3.indexOf(e.categoryId)>=0||t.hasActiveFilters(e.categoryId))}e.hasSelectableFilters=!0,e.categoryExpanded=!1,e.toggle=function(){e.categoryExpanded=!e.categoryExpanded},e.isVisible=function(){return!0},i.events.on(pW,r),e.$on("$destroy",function(){i.events.off(pW,r)})}function fg(e,t){"ngInject";return{restrict:"E",transclude:!0,replace:!0,scope:{label:"@",categoryId:"@",alphaSort:"@"},controller:mg,template:E3,link:function(e,i){function n(i){return e.categoryId===WS.Language?t.getLanguage(_.get(i,["attributes","facet-id","nodeValue"],"")):_.get(i,["attributes","label","nodeValue"],"")}if(e.alphaSort===OS.true){var r=i.find(L3),o=r.children();o.sort(function(e,t){return n(e).localeCompare(n(t),Origin.locale.languageCode())}),_.size(o)>0&&r.html(o)}}}}function hg(e,t){"ngInject";return{restrict:"E",replace:!0,transclude:!0,scope:{titleStr:"@",clearAllLabel:"@"},link:function(i){i.titleString=e.getLocalizedStr(i.titleStr,R3,"title-str"),i.clearAllLabelString=e.getLocalizedStr(i.clearAllLabel,R3,"clear-all-label"),i.isAnyFilterActive=t.isAnyFilterActive,i.onClick=function(){i.isAnyFilterActive()&&(t.dismissAllFacets(),t.reloadCurrentPage().then(t.triggerSearch))}},template:D3}}function vg(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",replace:!0,scope:{label:"@",facetId:"@",categoryId:"@"},link:function(e){function c(){r.detachAll(g)}function l(){N3.some(function(t){return t===e.categoryId})&&(e.filterUrl=s.getAbsoluteUrl(a.getSingleFacetUrl(e.categoryId,e.facetId)))}e.count=0,e.countVisible=!0;var d=!0;i.registerFacetOption(e.categoryId,e.facetId),e.enabled=function(){return d&&(e.isActive||e.count>0)},e.toggle=function(i){i.preventDefault(),e.enabled()&&(e.isActive=!e.isActive,e.categoryId&&t.applyFilter(e.categoryId,e.facetId))};var g=[n.events.on(yq,function(){e.isActive=t.isFilterActive(e.categoryId,e.facetId);var i=t.getFilter(e.categoryId,e.facetId);i&&(e.count=parseInt(i.count,10)),l()}),n.events.on(bq,function(t){var n;d=t.indexOf(e.facetId)<0,e.categoryId&&(n=i.getFacets()[e.categoryId])&&n.setFilterVisibility(e.facetId,d)})];r.attachAll(g),e.label||"language"!==e.categoryId||(e.label=o.getLanguage(e.facetId)),l(),e.$on("$destroy",c)},templateUrl:e.getTemplatePath("store/search/views/storefacetoption.html")}}function bg(e,t,i,n){"ngInject";return{restrict:"E",replace:!0,transclude:!0,scope:{sortFilterStr:"@"},link:function(r){function o(){t.setEmbeddedFilterpanel(!i.isSmall())}r.sortFilterString=e.getLocalizedStr(r.sortFilterStr,U3,"sort-filter-str"),t.getObserver().attachToScope(r,"states"),t.registerFilterPanelToggleBtn(),1===_.get(r,["states","numFilterPanelToggleBtns"])&&(o(),n.addResizeEventHandler(r,o,300)),r.toggleFilterPanel=function(){t.toggleEmbeddedFilterpanel()},r.$on("$destroy",function(){t.unregisterFilterPanelToggleBtn()})},template:G3}}function yg(e){"ngInject";e.categoryId="sort",e.open=!0,e.toggle=function(){e.open=!e.open}}function Sg(e,t,i,n,r){"ngInject";return{restrict:"E",replace:!0,scope:{label:"@",sortId:"@"},link:function(o){function a(){o.isActive=e.isFilterActive(s,o.sortId),o.isActive?o.filterUrl="":o.filterUrl=r.getAbsoluteUrl(n.getUrlWithNewSort(encodeURIComponent(o.sortId)))}o.countVisible=!1;var s="sort";t.registerSortOption(o.sortId),o.enabled=function(){return!0},o.toggle=function(){o.isActive||(o.isActive=!o.isActive,i.events.fire(Ey.C),e.applySortFilter(s,o.sortId))},i.events.on("storesearch:completed",a),o.$on("$destroy",function(){i.events.off("storesearch:completed",a)})},template:j3}}function kg(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",fontcolor:"@",ctid:"@",showOnPage:"@",hideOnPage:"@"},template:z3,link:e.siteStripeLinkFn(V3)}}function Ig(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",fontcolor:"@",ctid:"@",showOnPage:"@",hideOnPage:"@"},template:z3,link:e.siteStripeLinkFn(q3)}}function wg(e,t,i){"ngInject";e.goTo=function(e,i){e.preventDefault(),t.openLink(i)},e.hoverClass=e.fontcolor===YS.dark?J3:X3,e.isOigContext=i.isOIGContext()}function Cg(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",subtitle:"@",image:"@",logo:"@",href:"@",edgecolor:"@",fontcolor:"@",ctid:"@",imagePosition:"@",showOnPage:"@",hideOnPage:"@"},template:z3,controller:wg,link:e.siteStripeLinkFn(t4)}}function Tg(e,t,i){"ngInject";e.goTo=function(e,i){e.preventDefault(),t.openLink(i)},e.fontColorClass=e.fontcolor===YS.dark?Z3:e4,e.promoBorderColor=i.hexToRgba(e.borderColor),e.promoBackgroundColor=i.hexToRgba(e.accentcolor)}function Pg(e){"ngInject";return{restrict:"E",scope:{uniqueSitestripeId:"@",image:"@",backgroundColor:"@",fontcolor:"@",promoBackgroundColor:"@",promoBorderColor:"@",savingsText:"@",prePromoCodeText:"@",promoCodeText:"@",postPromoCodeText:"@",href:"@",ctid:"@",legalDisclaimerText:"@",legalDisclaimerLinkText:"@",legalDisclaimerDialogHeaderText:"@",legalDisclaimerDialogBodyTitleText:"@",legalDisclaimerDialogBodyText:"@",imagePosition:"@",showOnPage:"@",hideOnPage:"@"},controller:Tg,template:n4,link:e.siteStripeLinkFn(r4)}}function _g(e,t,i,n){"ngInject";function r(){o||(o=!0,e.newtitle&&(e.titleStr=e.newtitle),e.newsubtitle&&(e.subtitle=e.newsubtitle),"true"===e.hidetimer&&(e.timerVisible=!1))}var o=!1;e.timerVisible=!0,e.isReady=!1,e.$on("timerReached",r),t.populateScopeWithOcdAndCatalog(e,a4,e.ocdPath).then(function(){!e.goaldate&&e.ocdPath&&e.model.releaseDate&&(e.goaldate=e.model.releaseDate.toString()),e.href=e.href?e.href:e.ocdPath?"store"+e.ocdPath:null,e.goTo=function(e,t){e.preventDefault(),i.openLink(t)},e.hoverClass=e.fontcolor===YS.dark?J3:X3,e.goaldate&&!n.isInThePast(new Date(e.goaldate))||r(),e.isReady=!0})}function Og(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",subtitle:"@",image:"@",logo:"@",href:"@",edgecolor:"@",hidetimer:"@",goaldate:"@",largetimer:"@",newtitle:"@",newsubtitle:"@",timerposition:"@",fontcolor:"@",ocdPath:"@",ctid:"@",imagePosition:"@",showOnPage:"@",hideOnPage:"@"},controller:_g,template:z3,link:e.siteStripeLinkFn(a4)}}function Eg(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Fg(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){e.enableSiteStripe(),l.clearSitestripeDeactivatedStorefront()}function g(){e.siteStripeVisible&&e.subtitleStrLoc&&t.find(g4).append(i("<span>"+e.subtitleStrLoc+"</span>")(e))}function u(t){e.uniqueSitestripeId===t&&l.saveCurrentStorefrontIfSingleMarketCountry()}var p,m,f,h,v,b,y,S,k=(p=regeneratorRuntime.mark(function t(){var i,o,a,s,u,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=_.get(r.get(),"storefront","").length>0,o=_.get(n.getCurrentStorefrontInfo(),"storefrontCode"),t.next=4,Promise.all([l.getPreferredStorefront(),n.isUserInSingleMarketCountry()]);case 4:a=t.sent,s=l4(a,2),u=s[0],s[1]&&i&&u!==o&&(c.isSitestripeClosed(e.uniqueSitestripeId)?(p=l.getSitestripeDeactivatedStorefront())&&p!==o&&(d(),e.siteStripeVisible=!0):e.siteStripeVisible=!0),g();case 10:case"end":return t.stop()}},t,this)}),m=function(){var e=p.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return m.apply(this,arguments)}),I=[];e.siteStripeVisible=!1,e.onClick=function(){r.goTo()},h='<a \n            class="origin-store-sitestripe-storefrontwarning-link otka"\n            ng-click="onClick()"\n            data-sitestripe-id="'+e.uniqueSitestripeId+'"\n            >',v=o.getLocalizedStr(null,LI,n.getCurrentStorefrontCountry()),b=o.getLocalizedStr(e.learnmoreAnchorLabel,d4,"learnmore-anchor-label"),y='<a href="'+e.learnmoreUrl+'" class="otka external-link">'+b+'<i class="otkicon otkicon-learnmore"></i></a>',S=b&&e.learnmoreUrl?y:"",e.titleStrLoc=o.getLocalizedStr(e.titleStr,d4,"title-str",{"%storefrontCountry%":v,"%learnmore%":S}),e.subtitleStrLoc=o.getLocalizedStr(e.subtitle,d4,"subtitle",(Eg(f={},uw,h),Eg(f,pw,"</a>"),f)),I=[a.events.on(Ey.K,u),a.events.on(Ey.I,d)],e.$on("$destroy",function(){s.detachAll(I)}),k()}function xg(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",subtitle:"@",learnmoreAnchorLabel:"@",learnmoreUrl:"@",ctid:"@",showOnPage:"@",hideOnPage:"@"},template:c4,controller:Fg,link:e.siteStripeLinkFn(d4)}}function Lg(e,t,i,n,r,o,a){"ngInject";var s,c,l=(s=regeneratorRuntime.mark(function s(){var c,l,d,g;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(c=a.getCurrentState(),!(Origin.auth.isLoggedIn()&&c&&c.name&&c.name.indexOf("store")<0)){s.next=11;break}return s.next=4,n.getAllEntitlements();case 4:return l=s.sent,s.next=7,r.getCatalogInfo(Object.keys(l));case 7:d=s.sent,g=null,Object.values(d).find(function(e){var t=o.isExpiryImminentInDays(Origin.utils.OS_WINDOWS,DI.r)(e),i=!1;return t?g=o.getUseEndDate(e,Origin.utils.OS_WINDOWS):(i=o.isExpiryImminentInDays(Origin.utils.OS_MAC,DI.r)(e))&&(g=o.getUseEndDate(e,Origin.utils.OS_MAC)),t||i})&&g&&(e.titleStr=t.getLocalizedStr(e.titleStr,m4,"title-str",{"%expiresdate%":moment(g).format("LL")}),e.learnmoreAnchorLabel=t.getLocalizedStr(e.learnmoreAnchorLabel,m4,"learnmore-anchor-label"),e.learnmoreUrl=e.learnmoreUrl,e.siteStripeVisible=!i.isSitestripeClosed(e.uniqueSitestripeId),e.siteStripeVisible&&setTimeout(function(){return angular.element(".l-origin-gamelibrary-topbanner").addClass("position-static")}),e.$digest());case 11:case"end":return s.stop()}},s,this)}),c=function(){var e=s.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return c.apply(this,arguments)});e.siteStripeVisible=!1,l()}function Ag(e){"ngInject";return{restrict:"E",replace:!0,scope:{uniqueSitestripeId:"@",titleStr:"@",learnmoreAnchorLabel:"@",learnmoreUrl:"@",ctid:"@",showOnPage:"@",hideOnPage:"@"},template:p4,controller:Lg,link:e.siteStripeLinkFn(m4)}}function Dg(e,t,i){"ngInject";var n,r='last-modified="',o=r.length,a=!1;return{restrict:"E",transclude:!0,replace:!0,scope:{lastModified:"@"},link:function(s,c){function l(){a=!1,clearTimeout(n),n=setTimeout(p,6e5)}function d(){s.$broadcast("siteStripeWrapper:cleanUp"),i.events.off("myauth:change",g),clearTimeout(n)}function g(){a=!0,p()}function u(e){return a||function(e){if(e){var t=e.indexOf(r);if(t>=0){var i=e.substring(t+o,e.indexOf('"',t+o));if(i&&s.lastModified!==i)return!0}}return!1}(e)?e:null}function p(){t.retrieveTemplate().then(u).then(m).then(l)}function m(i){i&&(d(),c.html(e(i)(s)),t.showAllSiteStripes())}l(),i.events.on("myauth:change",g),s.$on("$destroy",d)},template:h4}}function Rg(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(t,i){var n;_.forEach(C,function(e,t){C[t].offerId=void 0,C[t].ocdPath=void 0,C[t].displayName=void 0,C[t].packArt=void 0}),_.forEach(i,function(e,i){C[i].offerId=e,C[i].ocdPath=_.get(t[e],"offerPath"),C[i].displayName=_.get(t[e],[DI.I,DI.k]),C[i].packArt=_.get(t[e],[DI.I,DI._10])}),e.buyCtaDisabled=Object.keys(t).length!==C.length,e.sections=C,e.buyCtaDisabled&&(n=_.find(C,function(e){return _.isUndefined(e.packArt)}),e.onTabClick(n)),d.digestIfDigestNotInProgress(e)}function p(e){f(),o.getCatalogInfo(_.values(e)).then(function(t){return u(t,e)})}function m(){r.getBundleDataObserver().onUpdate(e,p)}function f(e){r.getTotalDiscountAndPrice(e,{forceRoundTrip:!0}).then(v)}function h(){r.getActivePromoRuleOfferObserver().onUpdate(e,f)}function v(t){var i=t.totalDiscount,n=t.formattedTotalPrice,r=t.formattedTotalDiscountPrice;e.strings.titleStr=s.getLocalizedStr(e.titleStr,H4,"title-str",{"%price%":r}),e.strings.buyCtaStr=s.getLocalizedStr(e.buyCtaStr,H4,"buy-cta-str",{"%price%":r}),e.strings.nowPriceStr=s.getLocalizedStr(e.nowPriceStr,H4,"now-price-str",{"%price%":'<span class="otktitle-3"><strong>'+r+"</strong></span>"});var o=s.getLocalizedStr(e.wasPriceStr,H4,"was-price-str",{"%price%":'<span class="origin-store-softbundle-price-crossedout">'+n+"</span>","%discount%":""+i});o&&(e.strings.wasPriceStr=o.replace(G4,'<span class="origin-store-softbundle-price-discountpercentage">').replace(U4,"</span>")),d.digestIfDigestNotInProgress(e)}function b(){e.ineligibleUserRedirectUrl&&i.openLink(e.ineligibleUserRedirectUrl)}function y(){e.isLoading=!1,t.unblockUI()}function S(){y(),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SOFT_BUNDLE_TRACKING_SECTIONS,{sections:C})}function k(e){if(e.reason===b4){var t=void 0;if(t=C&&e.groupIndex&&C[e.groupIndex]?{"%category%":C[e.groupIndex]}:{"%category%":""},c.openPrompt({id:"owns-games-in-category",title:s.getLocalizedStr(null,H4,"owns-games-in-category-title"),description:s.getLocalizedStr(null,H4,"owns-games-in-category-body",t),rejectText:s.getLocalizedStr(null,H4,"owns-games-in-category-cta")}),l.events.once("dialog:hide",b),g.isOIGContext()){var i=document.querySelector("#origin-content");i&&i.classList.add("oig-softbundle-content")}return Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SOFT_BUNDLE_OWNS_GAME_IN_CATEGORY,{section:e.displayGroup}),Promise.reject(e)}}function I(){e.onTabClick(P.getActiveSectionId()),e.sections=C}e.isOigContext=g.isOIGContext(),e.isDarkText=e.textColor===ES.dark,e.buyCtaDisabled=!0,e.isSubscriber=a.userHasSubscription();var w,C=[],T=(w=e.promoRuleId.split(","),r.getActivePromotion(w,{forceRoundTrip:!0}));e.strings={legalText:s.getLocalizedStr(e.legalText,H4,"legal-text"),description:s.getLocalizedStr(e.description,H4,"description"),oaDiscountApplied:s.getLocalizedStr(e.oaDiscountApplied,H4,"oa-discount-applied")},e.learnMoreLink&&e.learnMoreStr&&(e.strings.learnMoreStr=s.getLocalizedStr(e.learnMoreStr,H4,"learn-more-str"),e.strings.learnMoreLink=s.getLocalizedStr(e.learnMoreLink,H4,"learn-more-str",{"%url-language%":Origin.locale.languageCode()})),this.register=function(e){return e.active=0===C.length,e.groupIndex=C.length,C.push(e),{sectionData:(t=C.length-1,T.then(function(e){var i=_.get(e,t);return i?(C[t].extraContentDisplayGroup=i.extraContentDisplayGroup,i):[]}).catch(function(){return[]})),groupIndex:C.length-1};var t},this.getActiveSectionId=function(){return _.find(C,{active:!0})};var P=this;e.$on("$destroy",function(){r.cleanUp()}),e.isLoading=!0,Promise.all([t.blockUI(),n.populateWithDefaults(e,H4),T.then(function(e){return r.getTotalDiscountAndPrice(e,{forceRoundTrip:!0})}).then(v).then(m).then(h).then(I).catch(k)]).then(S).catch(y)}function $g(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",transclude:!0,scope:{backgroundImage:"@",buyCtaStr:"@",legalText:"@",titleStr:"@",description:"@",nowPriceStr:"@",wasPriceStr:"@",promoRuleId:"@",hideScrim:"@",textColor:"@",ineligibleUserRedirectUrl:"@",oaDiscountApplied:"@",learnMoreStr:"@",learnMoreLink:"@"},controller:Rg,link:function(s,c,l,d){function g(t){s.activeSection=t;var i=0;e.hasMinWidth(R4)&&(i=10*t.groupIndex);var n=100*t.groupIndex,r=n+"%";n>0&&(r="calc("+n+"% + "+i+"px)"),s.linkIndicatorStyle={color:t.color,transform:"translate3d("+r+", 0, 0)"}}function u(){f&&(f.gameDrawerElement.remove(),f.tileElement.css(j4,""),_.isFunction(f.closeTile)&&f.closeTile()),f=null}function p(e){f.tileElement.css(j4,e+M4)}var m=!0;s.getTheDeal=function(){s.buyCtaDisabled||i.promiseLogin().then(function(){var e,t=(e=s.promoRuleId.split(","),e.length>1?n.getActivePromoRuleId():_.head(e)).split("/"),i=O4(t,2),o=i[0],a=i[1];r.buy(n.getBundleOffers(),o,a)})},s.removeOffer=function(e,t){n.removeFromBundle(e,t)},s.onTabClick=function(e){var t=d.getActiveSectionId(),i=_.get(t,B4);_.forEach(s.sections,function(t){t.active=t.sectionId===_.get(e,B4)});var n=d.getActiveSectionId(),r=_.get(n,B4);(m||i!==r)&&(m=!1,g(n),function(e,t){var i=_.get(t,B4);if(e){var n=c.find("."+e.sectionId);n.removeClass([x4,L4].join(" ")),e.groupIndex<t.groupIndex?n.removeClass(F4).addClass(L4):n.removeClass(F4).addClass(x4)}window.setTimeout(function(){c.find(A4).removeClass([E4,F4,x4,L4].join(" "));var n=c.find("."+i);e&&e.groupIndex<t.groupIndex?n.addClass(x4):n.addClass(L4),n.addClass(E4),window.requestAnimationFrame(function(){n.addClass(F4),M0.a.element("html, body").animate({scrollTop:0},"fast")})},$4)}(t,n))},s.onHeaderPinned=function(){c.find(D4).toggleClass("pinned")},s.onMarginUpdate=function(e){c.find(D4).css("margin-top",e)},t.addResizeEventHandler(s,function(){g(d.getActiveSectionId())},N4),s.isGameDrawerCtaDisabled=!1;var f=void 0;s.$on(Sq,function(e,t){var i=t.offerTileElement,n=t.offer,r=t.isOwned,c=t.groupIndex,l=t.isNotInBundleAndNotOwned,d=t.onCtaClickFunc,g=(t.closeTileFunc,t.removeText);u();var m=i.parent(),h={offer:n,isOwned:r,onCtaClicked:d,onHeightChange:p,addToOrderEnabled:l,removeText:g};o.appendSoftBundleGameDrawer(m,s,h),setTimeout(function(){var e,t,i,n,r;o.scrollToOpenDrawer((r=document.querySelector(".origin-bundlemain-cart"),e=r?r.offsetHeight:0,t=a.getTotalHeight(),n=document.querySelector(".origin-navigation-ismobile .origin-navigation-top"),i=n?n.offsetHeight:0,e+t+i))},0),f=function(e,t,i,n){return{tileElement:e,gameDrawerElement:e.find(P4),selectedOffer:t,groupIndex:i,closeTile:n}}(m,n,r,c)}),s.$on(kq,u),s.$on(Ey.E,u)},template:w4}}function Ng(e,t,i,n){"ngInject";function r(t){e.model=t,e.showOwnedText=n.isOfferOwned(t)||e.model.vaultEntitlement,e.showPrice=e.hidePrice!==OS.true&&!e.showOwnedText,e.isPricingLayoutHorizontal=K4.horizontal===e.pricingLayout}e.model={},e.showOwnedText=!1,e.showPrice=!1,e.strings={ownedText:i.getLocalizedStr(e.ownedText,Y4,"owned-text"),pricingErrorMessage:i.getLocalizedStr(void 0,Y4,"pricing-error-message")},e.$watchOnce("offerId",function(i){i&&t.getByOfferId(i).attachToScope(e,r)})}function Gg(e){"ngInject";return{restrict:"E",require:"^originStoreSoftbundleMain",scope:{sectionId:"@",sectionTitleStr:"@",sectionTitleColor:"@",sectionDescriptionStr:"@",titleStr:"@",hideRegularPrices:"@"},link:function(t,i,n,r){var o=t.sectionTitleColor||X4.orange;if(t.hideRegularPrices=t.hideRegularPrices||OS.false,r&&_.isFunction(r.register)){var a=r.register({sectionId:t.sectionId,titleStr:t.titleStr,color:o});t.loading=!0,t.groupIndex=a.groupIndex,a.sectionData.then(function(){var i;t.loading=!1,i=a.groupIndex,e.getActivePromoRuleOfferObserver().onUpdate(t,function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.offers,n=void 0===i?[]:i,r=e.extraContentDisplayGroup;t.games=n,t.extraContentDisplayGroup=r}(e[i])}),t.$digest()})}},template:J4}}function Ug(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bg(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Mg(e,t,i,n,r,o,a,s,c,l,d){"ngInject";return{restrict:"E",replace:!0,require:"?^originStorePdpSectionWrapper",scope:{ocdPath:"@",titleStr:"@",carouselType:"@",blackList:"@",whiteList:"@",controlButtonColor:"@"},link:function(l,g,u,p){function m(e){return _.isString(e)?e.split(","):void 0}function f(e){var t=[];return e.currency&&e.currency.splice(1),_.forEach(P.pickPath,function(i){return t.push(_.get(e,i))}),_.flatten(t)}function h(t){return O||E?c.getByOcdPathPromise(E).then(function(e){var i=_.concat(t,_.compact(_.values(e)));return _.filter(i,function(e){return!_.some(O,function(t){return t===e.offerPath})})}).catch(function(t){return e.error("[originStoreGdpOffercarousel:addWhitelistedAndRemoveBlacklisted error]",t)}):t}function v(e){return e.map(function(e){var t=e.gameTypeFacetKey,i=e.gdpPath,n=e.i18n;return{gameTypeFacetKey:t,gdpPath:i,i18n:{displayName:n.displayName,packArtLarge:n.packArtLarge},offerId:e.offerId,offerPath:e.offerPath}})}function b(e){return P.needsCatalog?n.getCatalogInfo(e).then(_.values):e}function y(e){return _.filter(e,i.isPurchasable)}function S(e){var t=e.map(function(e){return r.getOcdByPath(e.offerPath).then(s.findDirectives(h5)).then(s.flattenDirectives(h5)).then(function(t){var i=m5(t,1)[0];return function(e,t){return _.set(e,"tileImage",_.get(t,["discover-tile-image"])),e}(e,i)})});return Promise.all(t)}function k(e){var t=e.map(function(e){return i.isCurrency(e)?r.getOcdByPath(e.gdpPath).then(s.findDirectives(FU)).then(s.flattenDirectives(FU)).then(function(t){var i=m5(t,1)[0];return function(e,t){var i=_.get(t,[_.kebabCase(DI.k)]);return i&&_.set(e,[DI.I,DI.k],i),e}(e,i)}):e});return Promise.all(t)}function I(e){l.offerList=e.sort(g5),l.loadedGames=!0}function w(){l.offerList&&l.offerList.length&&(p&&_.isFunction(p.setVisibility)&&p.setVisibility(!0),l.isLoading=!1,l.$digest(),g.trigger(Ey.o))}var C,T=(Bg(C={},$S.extracontent,{needsCatalog:!1,pickPath:["addon","currency","expansion"],getProductFn:a.getAllExtraContentsCatalogModelPromise,productPath:o.buildPathFromUrl()}),Bg(C,$S.bundleitems,{needsCatalog:!0,pickPath:["bundleOffers"],getProductFn:a.getEditionAgnosticModelPromise,productPath:l.ocdPath?new KH(l.ocdPath):o.buildPathFromUrl()}),C);l.isLoading=!0,l.carouselType=l.carouselType||$S.extracontent;var P=T[l.carouselType],O=m(l.blackList),E=m(l.whiteList);l.goToOffer=function(e){o.goToGdp(e.gdpPath)},t.populateScope(l,f5).then(function(){l.controlButtonColor||(l.controlButtonColor=RS.dark),l.strings={titleStr:d.getLocalizedStr(l.titleStr,f5,"title-str")},P.getProductFn(P.productPath).then(f).then(b).then(h).then(y).then(v).then(S).then(k).then(I).catch(function(t){return e.error("[originStoreGdpOffercarousel:getProductFn error]",t)}).finally(w)})},template:d5}}function jg(e){"ngInject";var t=function(e){return n=e,(i=b5)in(t={})?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t;var t,i,n};return{restrict:"E",scope:Object.assign({},y5,S5),link:function(i,n){e.populateScopeAndSlingDataToDom(i,v5,n,t,void 0,void 0,_.keys(y5))}}}function Hg(e,t,i,n,r,o){"ngInject";function a(t){var i=k5(t,1)[0],n=_.get(s,[DI.S],_.get(i,[DI.I,DI.S]));n&&(e.longDescription=n,s.originStorePdpSectionWrapperCtrl&&_.isFunction(s.originStorePdpSectionWrapperCtrl.setVisibility)&&s.originStorePdpSectionWrapperCtrl.setVisibility(!0),o.digestIfDigestNotInProgress(e))}var s=this,c=r.buildPathFromUrl();s.$onInit=function(){Promise.all([n.getEditionAgnosticModelPromise(c),i.populateScope(s,FU)]).then(a).catch(function(e){return t.error("originStoreGdpDescription loading model error",e)})}}function zg(e){"ngInject";return{restrict:"E",scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",ctid:"@"},link:e.populateScopeLinkFn("origin-store-gdp-description-wrapper"),template:w5}}function Vg(e,t,i){"ngInject";i.getDiscountRateByOfferId(e.loyaltyOfferId).then(function(i){_.isUndefined(i)||(e.loyaltyOfferPrimaryText=t.getLocalizedStr("",P5,C5,{"%discountRate%":i}))}).catch(function(){e.loyaltyOfferPrimaryText=null}).finally(function(){e.loyaltyOfferSecondaryText=t.getLocalizedStr("",P5,T5),e.$digest()})}function Wg(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{titleStr:"@",subtitleStr:"@",logo:"@"},link:function(a){var s=i.buildPathFromUrl();a.gdpPath=s.gdpPath;var c={};Promise.all([n.getEditionAgnosticModelPromise(s),t.populateScope(c,x5),t.populateScope(a,F5)]).then(function(t){var i=E5(t,1)[0],n={"%gameName%":_.get(i,["i18n","displayName"],"")};a.strings={titleStr:e.getLocalizedStr(a.titleStr,F5,"title-str",n),subtitleStr:e.getLocalizedStr(a.subtitleStr,F5,"subtitle-str",n)},a.logo=_.get(a,L5,_.get(c,L5)),o.setNuxModel(),a.$digest()}),r.handleOwnershipErrorDialog(a)},template:O5}}function qg(e,t,i,n,r,o){"ngInject";return{restrict:"E",scope:{titleStr:"@",subtitleStr:"@",noOfferSubtitleStr:"@",monthlyOfferId:"@",yearlyOfferId:"@",ctaText:"@",ctid:"@"},link:function(a){var s=r.buildPathFromUrl();a.gdpPath=s.gdpPath,a.showJoinOriginAccessSection=!1,n.userHasSubscription()||Promise.all([o.getVaultModelPromise(s),e.populateScope(a,R5)]).then(function(e){function i(){a.strings.subtitleStr=t.getLocalizedStr(a.noOfferSubtitleStr,R5,"no-offer-subtitle-str")}var n=D5(e,1)[0];if(n){a.vaultGameName=_.get(n,["i18n","displayName"]),a.strings={titleStr:t.getLocalizedStr(a.titleStr,R5,"title-str"),ctaText:t.getLocalizedStr(a.ctaText,R5,"cta-text")};var r=_.compact([a.monthlyOfferId,a.yearlyOfferId]);o.getPricePromise(r).then(function(e){var n=D5(e,2),r=n[0],o=n[1];r&&o?a.strings.subtitleStr=t.getLocalizedStr(a.subtitleStr,R5,"subtitle-str",{"%vaultGameName%":a.vaultGameName,"%monthlyPrice%":r,"%yearlyPrice%":o}):i(),a.showJoinOriginAccessSection=!0}).catch(i).finally(function(){return a.$digest()})}}).catch(function(){a.showJoinOriginAccessSection=!1}),a.goToJoinOriginAccess=function(){i.goToState(bI.d,{franchise:s.franchise,game:s.game})}},template:A5}}function Yg(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Kg(e){return["DirectiveScope",function(t){"ngInject";var i;return{restrict:"E",transclude:!0,scope:(i={},Yg(i,N5,"@"),Yg(i,G5,"@"),Yg(i,U5,"@"),Yg(i,B5,"@"),Yg(i,M5,"@"),Yg(i,j5,"@"),Yg(i,H5,"@"),Yg(i,z5,"@"),Yg(i,V5,"@"),Yg(i,W5,"@"),Yg(i,q5,"@"),Yg(i,Y5,"@"),Yg(i,K5,"@"),i),link:function(i,n){t.getOcdNode(EZ).then(function(r){t.populateScopeAndSlingDataToDom(i,e,n,function(e){var t=_.pick(i,Q5),n=_.transform(t,function(e,t,i){e[_.kebabCase(i)]=t,delete e[i]},{});return _.merge(e,r[EZ],n),Yg({},$5,e)})}).catch(function(){return i.$emit(Ey.G)})}}}]}function Qg(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function Jg(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",anchorName:"@",showOnNav:"@",headerTitle:"@",comparisonTableTitle:"@",comparisonTableSubtitle:"@",comparisonTableFlag:"@",comparisonTableOcdPath1:"@",ocdPath1SuppressForInterstitial:"@",comparisonTableOcdPath2:"@",ocdPath2SuppressForInterstitial:"@",comparisonTableOcdPath3:"@",ocdPath3SuppressForInterstitial:"@",comparisonTableOcdPath4:"@",ocdPath4SuppressForInterstitial:"@",comparisonTableOcdPath5:"@",ocdPath5SuppressForInterstitial:"@",comparisonTableShowCta:"@",comparisonTableShowTitle:"@",comparisonTableShowSubtitle:"@"},controller:sd,require:"^originStorePdpSectionWrapper",link:function(v,b,y,S){function k(e){e&&S.setVisibility(!0)}function I(e){var t=_.assign(z(e),{savingsText:""});return h.getDiscountRateByOfferId(e.offerId).then(function(i){return _.isUndefined(i)?t:z(e,i)}).catch(function(){return t})}function w(){var t=_.map(v.models,function(t){return o.getOspCtaAction(e.action,t,v.models,G.isSubscriber)});return H(t)}function C(){if(v.showCta){var e=[w(),(t=_.map(v.models,function(e){return M.isOfferInWishlist(e.offerId)}),j(t)),V()];return Promise.all(e).then(function(){return v.$digest()})}var t;return V(),v.$digest(),Promise.resolve()}function T(){c.detachAll(N)}function P(e){G=e,Promise.all([w(),V()]).then(function(){return v.$digest()})}function O(){$().then(C).then(function(){return v.$digest()})}function E(){d.getObserver(v,P)}function F(){v.showCta&&(N=[s.events.on(Ey.B,O),s.events.on(Ey.l,O),t.events.on(Ey.R+Origin.user.userPid(),C),t.events.on(Ey.S+Origin.user.userPid(),C)],v.$on("$destroy",T))}function x(){v.showCta=v.comparisonTableShowCta?v.comparisonTableShowCta===OS.true:U,v.showTitle=v.comparisonTableShowTitle===OS.true,v.showSubtitle=v.comparisonTableShowSubtitle===OS.true,v.showOriginAccessLogo=m.isPremierFeatureEnabled()}function L(e){var t=void 0;if(e&&U)return t=e.filter(g.isPurchasable),"gift"===B&&(t=_.filter(t,function(e){return e.giftable})),v.applyModelData(t);var i=[];return r.isState(bI.d)&&[v.ocdPath1SuppressForInterstitial,v.ocdPath2SuppressForInterstitial,v.ocdPath3SuppressForInterstitial,v.ocdPath4SuppressForInterstitial,v.ocdPath5SuppressForInterstitial].forEach(function(e,t){e===OS.true&&i.push(t)}),v.indicesForOcdPathsToSuppress=i,t=e.filter(function(e,t){return!v.indicesForOcdPathsToSuppress.includes(t)&&(g.isPurchasable(e)||u.isVaultGame(e)||p.isPremierVaultGame(e))}),Promise.all(t.map(function(e){return h.isEligibleForPromotionByOfferId(e.offerId)})).then(function(e){return _.forEach(e,function(e,i){_.assign(t[i],e)}),v.hasLoyaltyOffer=_.some(t,"isEligible"),v.applyModelData(t)})}function A(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];v.ocdPaths=[],v.$digest(),t&&f.error("OspComparisonTable",_.get(e,"stack")),v.$emit(Ey.G)}var D,R=this,$=(D=Qg(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=_.compact([v.comparisonTableOcdPath1,v.comparisonTableOcdPath2,v.comparisonTableOcdPath3,v.comparisonTableOcdPath4,v.comparisonTableOcdPath5])).length>0)){e.next=8;break}return v.setOriginalListOcdPaths(t),e.next=5,h.filterGdpPathsForPromotion(t);case 5:return r=e.sent,o=_.map(r,i.getByOcdPathPromise),e.abrupt("return",Promise.all(o).then(n.unwrapEditions).then(L));case 8:return e.abrupt("return",Promise.reject("no-data"));case 9:case"end":return e.stop()}},e,this)})),function(){return D.apply(this,arguments)}),N=[],G={isSubscriber:!1},U=void 0,B=void 0;v.strings=v.strings||{},v.strings.addedToWishlist=a.getLocalizedStr(!1,e6,"added-to-wishlist"),v.strings.viewWishlist=a.getLocalizedStr(!1,e6,"view-wishlist"),v.strings.oaDiscountAppliedText=a.getLocalizedStr(!1,e6,"oa-discount-applied-text"),v.strings.premierExclusive=a.getLocalizedStr(!1,e6,"premier-exclusive"),v.strings.includedInSubsciptionTier=a.getLocalizedStr(!1,e6,"included-in-subscription-tier"),v.strings.premierExclusivePrice=a.getLocalizedStr(!1,e6,"comparison-table-premier-exclusive-price-str"),v.logoVariant=qS.Condensed,v.profileWishlistUrl=r.getHrefFromState(bI.Q,{topic:t6});var M=t.getWishlist(Origin.user.userPid());v.invokeAction=function(e){o.invokeAction(e)};var j=function(e){return Promise.all(e).then(function(e){v.wishlistGames=e,v.showWishlistSection=v.showCta&&_.some(e)})},H=function(e){return Promise.all(e).then(function(t){e=_.map(v.models,function(e,i){return _.map(t[i],function(t){return function(e,t){var i='<span class="origin-white-space-nowrap">'+t.formattedPrice+"</span>";return e.ctaText=a.getLocalizedStr(!1,Z5,_.kebabCase(e.ctaText),{"%price%":i}),e}(t,e)})}),v.ctaActions=e})},z=function(e,t){var i=a.getLocalizedStr(!1,e6,"savings-text",{"%savings%":e.savings});return _.isUndefined(t)||(i=a.getLocalizedStr("","origin-store-osp-loyaltyofferinfo",i6,{"%discountRate%":t})),{savingsText:i,showDiscountPrice:!v.showCta,hasSavings:v.showCta&&!!e.savings,showOriginAccessDiscountText:v.showCta&&l.userHasSubscription()&&e.price>0}},V=function(){return Promise.all(_.map(v.models,(e=Qg(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.isEligibleForPromotionByOfferId(t.offerId);case 2:if(!e.sent.isEligible){e.next=9;break}return t.isEligible=!0,e.abrupt("return",I(t));case 9:return e.abrupt("return",Promise.resolve(z(t)));case 10:case"end":return e.stop()}},e,R)})),function(t){return e.apply(this,arguments)}))).then(function(e){v.originAccessPricing=e});var e};!function(){U=r.isState(bI.C);var e=r.getStateParams();U&&e&&(B=e.action),r.isState(bI.a)?A(void 0,!1):$().then(k).then(x).then(E).then(C).then(F).catch(A)}()},template:X5}}function Xg(e,t,i,n,r,o,a,s,c){"ngInject";function l(t){var i=r6(t,1)[0],n=_.get(i,[a6,"items","0",fz,_.kebabCase(hz)]);e.backgroundImage=n||e.backgroundImage,e.theme=e.theme||FS.dark,g.resolve(e.theme),e.videoId||(e.backgroundImageStyle={"background-image":"url("+e.backgroundImage+")"}),e.$digest()}var d=this,g=t.defer(),u=o.buildPathFromUrl();this.getTheme=function(){return g.promise},this.modelHasRatingData=function(e){return!c.hasNoRating(_.head(e))},this.getRatingModelPromise=function(){return r.getCatalogModelPromise(u).then(function(e){if(e){var t=void 0,i=!0;if(u.isAddon)t=d.modelHasRatingData(e.addon);else if(u.isExpansion)t=d.modelHasRatingData(e.expansion);else{var n=nU(e.basegames);i=1===_.size(n),t=d.modelHasRatingData(n)}return{showRating:i,hasRating:t,gdpPath:u.gdpPath}}}).catch(function(){})},this.setRatings=function(){d.getRatingModelPromise().then(function(t){var i=t.showRating,n=t.hasRating,r=t.gdpPath;e.showRatings=i,e.hasRating=n,e.gdpPath=r})};var p=e.interstitialAbTestGames?e.interstitialAbTestGames.split(","):void 0;s.isInExperimentAndViewingApplicableGame(p,e.interstitialAbTestVariantName,u.gdpPath).then(function(t){t?Promise.all([i.getOcdNode(a6).catch(function(e){return a.error("OSP Interstitial Hero: Error in getOcdNode",e)}),i.populateScope(e,o6)]).then(l):e.isEmpty=!0})}function Zg(e){"ngInject";return{restrict:"E",transclude:!0,scope:{theme:"@",backgroundImage:"@",videoId:"@",smallScreenImageurl:"@",interstitialAbTestVariantName:"@",interstitialAbTestGames:"@"},controller:Xg,link:function(t){e.handleOwnershipErrorDialog(t)},template:n6}}function eu(e,t,i,n,r,o){"ngInject";return{restrict:"E",transclude:!0,scope:{},link:function(t){var a=r.buildPathFromUrl();t.gdpPath=a.gdpPath,t.showRatings=!1,t.slideDownToSection=function(){var t=document.querySelectorAll(".l-store-pdp-nav-item"),i=_.find(t,function(e){return!_.isUndefined(e.id)});e.hash(i.id),n.events.fire(PU)},t.fontColor=ES.light,Promise.all([o.getCatalogModelPromise(a),i.populateScope(t,g6)]).then(function(e){var i=d6(e,1)[0];if(i){var n=l6(a,i),r=_.size(n);t.showRatings=1===r}t.$digest()})},template:c6}}function tu(e,t){"ngInject";t.handleOwnershipErrorDialog(e)}function iu(e,t,i,n,r,o,a){"ngInject";return{restrict:"E",transclude:!0,scope:{titleStr:"@",noOfferTitleStr:"@",subtitleStr:"@",monthlyOfferId:"@",yearlyOfferId:"@",originAccessLogo:"@",joinOriginAccessCtaText:"@"},link:function(e){e.strings={},e.showOriginAccessButton=function(){return e.subscriptionOfferIds&&e.strings.joinOriginAccessCtaText};var s=o.buildPathFromUrl(),c=s.isExpansion||s.isAddon?r.getEditionAgnosticModelPromise(s):r.getVaultModelPromise(s);Promise.all([c,i.populateScope(e,m6)]).then(function(t){return function(t){var i=_.compact([e.monthlyOfferId,e.yearlyOfferId]);return e.subscriptionOfferIds=i.join(","),r.getPricePromise(i).then(function(e){var i=p6(e,2),n=i[0],r=i[1];if(n&&r)return{"%vaultGameName%":_.get(t,[DI.I,DI.k],""),"%monthlyPrice%":n,"%yearlyPrice%":r};throw new Error("price-error")})}(p6(t,1)[0])}).then(function(i){return function(i){e.strings={subtitleStr:t.getLocalizedStr(e.subtitleStr,m6,"subtitle-str"),titleStr:t.getLocalizedStr(e.titleStr,m6,"title-str",i),joinOriginAccessCtaText:t.getLocalizedStr(e.joinOriginAccessCtaText,m6,"join-origin-access-cta-text")}}(i)}).catch(function(i){e.strings={titleStr:t.getLocalizedStr(e.noOfferTitleStr,m6,"no-offer-title-str")},e.priceError=!0,a.error("origin-store-osp-interstitial-herocontent: Error setting price",i)}).finally(function(){return n.digestIfDigestNotInProgress(e)})},controller:tu,template:u6}}function nu(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ru(e,t,i,n,r,o){"ngInject";function a(i,n){var r,o,a,c,l,d,g,u,p=_.get(n,[DI.I,DI.k]),m={titleStr:t.getLocalizedStr(e.editionTitleStr,i,"edition-title-str",nu({},lw,p)),onlineDisclaimerStr:_.get(n,[DI.I,DI._7])},f=_.find(s,function(e){return e.whiteListArray.includes(n.offerPath)});if(m.onlineDisclaimerStr&&f){var h=(o=p,a=(r=f).legalText,c=r.localizedLegalUrl,l=r.aboutUrl,d=r.saleUrl,g=r.formattedExpirationDate,u=Object.assign({},o?nu({},lw,o):{},g?nu({},mw,g):{},c?{"%legalUrl%":c}:{},l?{"%aboutUrl%":l}:{},d?{"%saleUrl%":d}:{}),t.getLocalizedStr(a,b6,"legal-text",u));h&&(m.onlineDisclaimerStr=h+"<br><br>"+m.onlineDisclaimerStr)}return m}var s=[],c=Origin.locale.locale().toLowerCase().replace("_","-"),l=new RegExp(fw,"g");this.populateTermsAndConditions=function(t){var o=t.gdpPath||r.buildPathFromUrl();Promise.all([n.getCatalogModelPromise(o),i.populateScope(e,t.contextNamespace)]).then(function(i){var n=v6(i,1)[0],r=[],s=_.partial(a,t.contextNamespace),c=l6(o,n);o.isGameName?(!1===t.showOnlyIfSingleBasegame||!0===t.showOnlyIfSingleBasegame&&1===_.size(c))&&(r=_.map(n.basegames,s)):o.isAddon?r=_.map(n.addon,s):o.isCurrency?r=_.map(n.currency,s):o.isExpansion?r=_.map(n.expansion,s):o.isGameTime&&(r=_.map(n[DI.C],s)),e.disclaimers=r,e.$digest()})},this.registerPromoDisclaimer=function(e){var t=e.legalText,i=e.legalUrl,n=void 0===i?"":i,r=e.aboutUrl,a=e.saleUrl,d=e.expirationDate,g=e.whiteList,u=n.replace(l,c),p=o.formatDateWithTimezone(new Date(d)),m=g?g.split(","):[];s.push({legalText:t,localizedLegalUrl:u,aboutUrl:r,saleUrl:a,formattedExpirationDate:p,whiteListArray:m})}}function ou(e,t){return["UtilFactory","GdpUrlFactory","OspPremierFactory","SubscriptionFactory","DirectiveScope",function(i,n,r,o,a){"ngInject";return{restrict:"E",scope:{anonymousTitleStr:"@",basicSubscriberTitleStr:"@"},require:"^originStoreOspInterstitialPremierHero",link:function(e,t,s,c){var l=n.buildPathFromUrl();e.gdpPath=l.gdpPath,e.strings={anonymousTitleStr:i.getLocalizedStr(e.anonymousTitleStr,w6,"anonymous-title-str"),basicSubscriberTitleStr:i.getLocalizedStr(e.basicSubscriberTitleStr,w6,"basic-subscriber-title-str")},e.strings.titleStr=o.userHasActiveSubscription()?e.strings.basicSubscriberTitleStr:e.strings.anonymousTitleStr,e.hasActiveSubscription=o.userHasActiveSubscription(),Promise.all([r.getVaultModelForAllTiers(l),c.getTheme(),a.populateWithDefaults(e,w6)]).then(function(t){var i=I6(t,2),n=i[0],r=i[1];e.inBothTiers=n.inBothTiers,e.theme=r,e.$digest()})},controller:t,template:e}}]}function au(e,t){"ngInject";function i(){e.isLoading=!1,e.$digest()}var n={};e.isLoading=!0,t.populateScope(n,T6).then(function(){return e.logo=_.get(n,"logo")}).then(i).catch(i)}function su(e,t,i,n,r,o,a,s,c){"ngInject";function l(){return n.getActiveSubscriptionLevel()===yI.y.STANDARD}function d(){return n.getActiveSubscriptionLevel()===yI.y.PREMIUM}function g(t,i){return e.getVaultModelPromise(t,i).catch(function(){})}function u(e){return g(e,yI.y.STANDARD)}function p(e){return g(e,yI.y.PREMIUM)}function m(t){var i,n=t.context;return n.isReleased||n.isPreloadable?(i=n.offerId,i?e.getEntitlementsPromise([i]).then(_.values).then(_.head).catch(function(){}):Promise.resolve()).then(function(e){return r.isOwnedOutright(e)?t.name=F6.VIEW_IN_LIBRARY:t.name=F6.ADD_TO_LIBRARY,t}):Promise.resolve(t)}function f(t){var i=e.getPlayFirstTrialModelPromise(t);return Promise.all([u(t),i]).then(function(e){var i=E6(e,2),n=i[0],r=i[1],o=!_.isUndefined(r),c=o?r:n,g=s.isPreloadable(c);return function(e,t,i,n,r){if(e.context.isPlayFirstTrial=n,e.context.isPreloadable=r,n)e.context.isReleased=s.isReleased(i);else{var o=_.get(t,[DI._34,DI._36],null);e.context.isReleased=a.isInThePast(o)}if(e.context.trialLaunchDuration=_.get(i,[DI._30],""),l()){if(n)return m(e)}else d()||(e.name=F6.BECOME_MEMBER);return Promise.resolve(e)}({name:F6.NONE,isPrimaryAction:!1,context:{gdpPath:t.gdpPath,gameEdition:_.get(c,[DI.I,DI.k],""),offerId:_.get(c,DI.Y)}},n,r,o,g)})}function h(i){var n=e.getPlayFirstTrialModelPromise(i);return Promise.all([p(i),u(i),n]).then(function(e){var n=E6(e,3),r=n[0],o=n[1],a=n[2],c={name:F6.NONE,isPrimaryAction:!1,context:{gdpPath:i.gdpPath,basicVaultHasPlayFirstTrial:!_.isUndefined(a)&&_.isUndefined(o),basicAndPremierHaveDifferentVaultEditions:!_.isUndefined(o)&&!_.isUndefined(r)&&_.get(o,DI._35)!==_.get(r,[DI._16,DI._12]),gameEdition:_.get(r,[DI.I,DI.k],""),offerId:_.get(r,DI.Y)}};return function(e,i){e.context.isReleased=s.isReleased(i),e.context.isEarlyAccess=t.isPastPremierReleaseDate(i)&&!s.isReleased(i),e.context.isPlayable=t.isVaultReleased(i)&&t.isPastPremierReleaseDate(i)}(c,r),function(e){return l()?(e.name=F6.UPGRADE_MEMBERSHIP,e.isPrimaryAction=!0):d()||(e.name=F6.BECOME_MEMBER,e.isPrimaryAction=!0),Promise.resolve(e)}(c)})}return{getVaultModelForAllTiers:function(t){return Promise.all([e.getEditionAgnosticModelPromise(t),p(t),u(t),e.getPlayFirstTrialModelPromise(t)]).then(function(e){var t=E6(e,4),i=t[0],n=t[1],r=t[2],o=t[3];return{editionAgnosticModel:i,premierVaultModel:n,basicVaultModel:r,playFirstTrialModel:o,isPremierExclusive:!_.isUndefined(n)&&_.isUndefined(r)&&_.isUndefined(o),inBothTiers:!(_.isUndefined(n)||_.isUndefined(r)&&_.isUndefined(o))}}).catch(function(){})},getActionForSubscriptionLevel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yI.y.NONE;return t===yI.y.STANDARD?f(e):t===yI.y.PREMIUM?h(e):void 0},invokeAction:function(e){var t=e.context;switch(e.name){case F6.ADD_TO_LIBRARY:return t.isPlayFirstTrial?o.entitleFreeGame(t.offerId):o.entitleVaultGame(t.offerId);case F6.VIEW_IN_LIBRARY:c.goToState(bI.u,{offerid:t.offerId})}}}}function cu(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function lu(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function du(e,t,i,n,r,o,a,s,c){"ngInject";var l,d=this,g=t.buildPathFromUrl();this.getTokens=function(e){var t;return lu(t={},V6,e.gameEdition),lu(t,W6,e.trialLaunchDuration),t},this.resetFooterStr=function(){e.strings.footerStr=""},this.init=(l=cu(regeneratorRuntime.mark(function t(s,l,u){var p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,a.isPromotionEnabled(s);case 3:return p=t.sent,t.abrupt("return",Promise.all([o.getLogosByThemePromise(l),i.getActionForSubscriptionLevel(g,s),a.isBasicTrialEnabled(),a.isPremierTrialEnabled(),n.insertPriceIntoLocalizedStrAsync(e.strings,p?e.strings.footerPromotionStr:e.strings.footerStr,u,q6).catch(function(){return d.resetFooterStr()}),r.populateScope(e,u)]).then(function(){var t=cu(regeneratorRuntime.mark(function t(i){var n=H6(i,4),r=n[0],o=n[1],a=n[2],s=n[3];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.action=o,e.originAccessLogos=r,!o){t.next=5;break}return t.next=5,e.setActionStrings(o,a,s);case 5:e.isLoading=!1,c.digestIfDigestNotInProgress(e);case 7:case"end":return t.stop()}},t,d)}));return function(e){return t.apply(this,arguments)}}()).catch(function(){}));case 5:case"end":return t.stop()}},t,d)})),function(e,t,i){return l.apply(this,arguments)}),e.invokeAction=function(){e.action&&i.invokeAction(e.action)}}function gu(e,t,i,n,r){"ngInject";return{restrict:"E",scope:{headerStr:"@",footerStr:"@",footerPromotionStr:"@",tileType:"@",addToLibraryCtaText:"@",viewInLibraryCtaText:"@",basicOfferIds:"@",becomeBasicMemberCtaText:"@",becomeBasicTrialMemberCtaText:"@",playfirsttrialBasicsubscriberStr:"@",releasedVaultBasicsubscriberStr:"@",unreleasedPlayfirsttrialPreloadStr:"@",unreleasedPlayfirsttrialStr:"@",releasedPlayfirsttrialStr:"@",releasedBasicvaultStr:"@",unreleasedBasicvaultStr:"@"},require:["?^originStoreOspInterstitialPremierHero","?originStoreOspInterstitialPremierBasictile","?originStoreOspInterstitialPremierBasictileBalanced"],controller:du,link:function(t,o,a,s){function c(i){var n=v.getTokens(i);i.isPlayFirstTrial?i.isReleased?t.strings.subtitleStr=e.getLocalizedStr(t.releasedPlayfirsttrialStr,z6,"released-playfirsttrial-str",n):i.isPreloadable?t.strings.subtitleStr=e.getLocalizedStr(t.unreleasedPlayfirsttrialPreloadStr,z6,"unreleased-playfirsttrial-preload-str",n):t.strings.subtitleStr=e.getLocalizedStr(t.unreleasedPlayfirsttrialStr,z6,"unreleased-playfirsttrial-str",n):i.isReleased?t.strings.subtitleStr=e.getLocalizedStr(t.releasedBasicvaultStr,z6,"released-basicvault-str",n):t.strings.subtitleStr=e.getLocalizedStr(t.unreleasedBasicvaultStr,z6,"unreleased-basicvault-str",n)}function l(i){var n=v.getTokens(i);i.isPlayFirstTrial?i.isReleased&&i.isPreloadable?t.strings.subtitleStr=e.getLocalizedStr(t.playfirsttrialBasicsubscriberStr,z6,"playfirsttrial-basicsubscriber-str",n):t.strings.subtitleStr=e.getLocalizedStr(t.unreleasedPlayfirsttrialStr,z6,"unreleased-playfirsttrial-str",n):i.isReleased?t.strings.subtitleStr=e.getLocalizedStr(t.releasedVaultBasicsubscriberStr,z6,"released-vault-basicsubscriber-str",n):t.strings.subtitleStr=e.getLocalizedStr(t.releasedBasicvaultStr,z6,"unreleased-basicvault-str",n)}function d(){return i.getActiveSubscriptionLevel()===yI.y.STANDARD}function g(){t.subscriptionTypeEnum=BS,t.subscriptionType=BS.basic,t.strings={addToLibraryCtaText:e.getLocalizedStr(t.addToLibraryCtaText,z6,"add-to-library-cta-text"),viewInLibraryCtaText:e.getLocalizedStr(t.viewInLibraryCtaText,z6,"view-in-library-cta-text"),becomeBasicMemberCtaText:e.getLocalizedStr(t.becomeBasicMemberCtaText,z6,"become-basic-member-cta-text"),becomeBasicTrialMemberCtaText:e.getLocalizedStr(t.becomeBasicTrialMemberCtaText,z6,"become-basic-trial-member-cta-text"),footerStr:e.getLocalizedStr(t.footerStr,z6,q6),footerPromotionStr:e.getLocalizedStr(t.footerPromotionStr,z6,"footer-promotion-str")},d()&&(t.strings.headerStr=e.getLocalizedStr(t.headerStr,z6,"header-str")),h.getTheme().then(function(e){t.theme=e,v.init(yI.y.STANDARD,e,z6)})}var u,p=this,m=_.compact(s),f=H6(m,2),h=f[0],v=f[1];t.isBecomeAMemberFlow=!1,t.setActionStrings=(u=cu(regeneratorRuntime.mark(function e(n,o){var a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.ctaType=n.isPrimaryAction?GS.primary:t.theme===FS.dark?GS.transparent:GS.light,a=n.context,e.next=4,r.isPromotionEnabled(yI.y.STANDARD);case 4:s=e.sent,e.t0=n.name,e.next=e.t0===F6.BECOME_MEMBER?8:e.t0===F6.VIEW_IN_LIBRARY?15:e.t0===F6.ADD_TO_LIBRARY?19:23;break;case 8:return t.strings.ctaText=o?t.strings.becomeBasicTrialMemberCtaText:t.strings.becomeBasicMemberCtaText,t.subscriptionOfferIds=t.basicOfferIds,c(a),t.ctaMode=VS[o?yI.p.SIGN_UP_BASIC_TRIAL:s?yI.p.SIGN_UP_BASIC_PROMOTION:yI.p.SIGN_UP_BASIC],t.isBecomeAMemberFlow=!0,t.telemetryClass=A6,e.abrupt("break",26);case 15:return t.strings.ctaText=t.strings.viewInLibraryCtaText,l(a),t.telemetryClass=$6,e.abrupt("break",26);case 19:return t.strings.ctaText=t.strings.addToLibraryCtaText,l(a),t.telemetryClass=R6,e.abrupt("break",26);case 23:return t.strings.ctaText="",d()?l(a):c(a),e.abrupt("break",26);case 26:n.name!==F6.BECOME_MEMBER&&i.isRecurringSubscriber()&&v.resetFooterStr();case 27:case"end":return e.stop()}},e,p)})),function(e,t){return u.apply(this,arguments)}),g(),n.events.on(Ey.B,g),n.events.on(Ey.l,g)},template:O6}}function uu(e,t,i,n){"ngInject";return{restrict:"E",scope:{headerStr:"@",footerStr:"@",footerPromotionStr:"@",tileType:"@",upgradeMembershipCtaText:"@",premierOfferIds:"@",releasedPremierGamePlayfirsttrialStr:"@",releasedPremierGameNoPlayfirsttrialStr:"@",releasedPremierGameNoPlayfirsttrialBasicsubscriberStr:"@",releasedPremierGameNoPftDifferentBasicEditionStr:"@",unreleasedPremierGameStr:"@",earlyaccessPremierGameStr:"@",becomePremierMemberCtaText:"@"},require:["?^originStoreOspInterstitialPremierHero","?originStoreOspInterstitialPremierPremiertile","?originStoreOspInterstitialPremierPremiertileBalanced"],controller:du,link:function(t,r,o,a){function s(n){var r=m.getTokens(n);n.isReleased?n.basicVaultHasPlayFirstTrial?t.strings.subtitleStr=e.getLocalizedStr(t.releasedPremierGamePlayfirsttrialStr,Q6,"released-premier-game-playfirsttrial-str",r):n.basicAndPremierHaveDifferentVaultEditions?t.strings.subtitleStr=e.getLocalizedStr(t.releasedPremierGameNoPftDifferentBasicEditionStr,Q6,"released-premier-game-no-pft-different-basic-edition-str",r):i.isStandardSubscriber()?t.strings.subtitleStr=e.getLocalizedStr(t.releasedPremierGameNoPlayfirsttrialBasicsubscriberStr,Q6,"released-premier-game-no-playfirsttrial-basicsubscriber-str",r):t.strings.subtitleStr=e.getLocalizedStr(t.releasedPremierGameNoPlayfirsttrialStr,Q6,"released-premier-game-no-playfirsttrial-str",r):n.isEarlyAccess?t.strings.subtitleStr=e.getLocalizedStr(t.earlyaccessPremierGameStr,Q6,"earlyaccess-premier-game-str",r):t.strings.subtitleStr=e.getLocalizedStr(t.unreleasedPremierGameStr,Q6,"unreleased-premier-game-str",r)}var c,l,d=this,g=_.compact(a),u=K6(g,2),p=u[0],m=u[1];t.isBecomeAMemberFlow=!1,t.setActionStrings=(c=regeneratorRuntime.mark(function e(r,o,a){var c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.ctaType=r.isPrimaryAction?GS.primary:GS.transparent,c=r.context,e.next=4,n.isPromotionEnabled(yI.y.PREMIUM);case 4:l=e.sent,e.t0=r.name,e.next=e.t0===F6.BECOME_MEMBER?8:e.t0===F6.UPGRADE_MEMBERSHIP?15:21;break;case 8:return t.strings.ctaText=a?t.strings.becomePremierTrialMemberCtaText:t.strings.becomePremierMemberCtaText,t.subscriptionOfferIds=t.premierOfferIds,s(c),t.isBecomeAMemberFlow=!0,t.telemetryClass=L6,t.ctaMode=n.getBecomePremierMemberCTAMode(a,l),e.abrupt("break",24);case 15:return t.subscriptionOfferIds=t.premierOfferIds,t.strings.ctaText=a?t.strings.upgradeTrialMembershipCtaText:t.strings.upgradeMembershipCtaText,t.telemetryClass=D6,s(c),t.isBecomeAMemberFlow=!0,e.abrupt("break",24);case 21:return t.strings.ctaText="",i.isRecurringSubscriber()&&m.resetFooterStr(),e.abrupt("break",24);case 24:case"end":return e.stop()}},e,d)}),l=function(){var e=c.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e,t,i){return l.apply(this,arguments)}),t.subscriptionTypeEnum=BS,t.subscriptionType=BS.premier,t.strings={becomePremierMemberCtaText:e.getLocalizedStr(t.becomePremierMemberCtaText,Q6,"become-premier-member-cta-text"),becomePremierTrialMemberCtaText:e.getLocalizedStr(t.becomePremierMemberCtaText,Q6,"become-premier-trial-member-cta-text"),upgradeMembershipCtaText:e.getLocalizedStr(t.upgradeMembershipCtaText,Q6,"upgrade-membership-cta-text"),upgradeTrialMembershipCtaText:e.getLocalizedStr(t.upgradeTrialMembershipCtaText,Q6,"upgrade-trial-membership-cta-text"),footerStr:e.getLocalizedStr(t.footerStr,Q6,"footer-str"),footerPromotionStr:e.getLocalizedStr(t.footerPromotionStr,Q6,"footer-promotion-str")},i.getActiveSubscriptionLevel()===yI.y.PREMIUM&&(t.strings.headerStr=e.getLocalizedStr(t.headerStr,Q6,"header-str")),p.getTheme().then(function(e){t.theme=e,m.init(yI.y.PREMIUM,e,Q6)})},template:O6}}function pu(e,t,i,n,r,o,a,s,c,l){"ngInject";return{restrict:"E",transclude:!0,scope:{anonymousTitleStr:"@",basicSubscriberTitleStr:"@",anonymousSubtitleStr:"@",basicSubscriberSubtitleStr:"@",heroContentType:"@",premierSubscriptionOfferIds:"@",becomeMemberCtaText:"@",upgradeMembershipCtaText:"@"},require:["?^originStoreOspInterstitialPremierHero"],link:function(e,t,r,a){function d(t,n){e.theme=t;var r,a,s=n.isPremierExclusive,d=n.inBothTiers,p=document.querySelector(t8).classList;r=_.get(n,[DI.o,DI.I,DI.k]),a=c.userHasActiveSubscription(),e.strings={anonymousTitleStr:i.getLocalizedStr(e.anonymousTitleStr,e8,"anonymous-title-str",{"%gameName%":r}),basicSubscriberTitleStr:i.getLocalizedStr(e.basicSubscriberTitleStr,e8,"basic-subscriber-title-str",{"%gameName%":r}),anonymousSubtitleStr:i.getLocalizedStr(e.anonymousSubtitleStr,e8,"anonymous-subtitle-str",{"%gameName%":r}),basicSubscriberSubtitleStr:i.getLocalizedStr(e.basicSubscriberSubtitleStr,e8,"basic-subscriber-subtitle-str",{"%gameName%":r}),becomeMemberCtaText:i.getLocalizedStr(e.becomeMemberCtaText,e8,"become-member-cta-text"),upgradeMembershipCtaText:i.getLocalizedStr(e.upgradeMembershipCtaText,e8,"upgrade-membership-cta-text")},e.strings.titleStr=a?e.strings.basicSubscriberTitleStr:e.strings.anonymousTitleStr,e.strings.subtitleStr=a?e.strings.basicSubscriberSubtitleStr:e.strings.anonymousSubtitleStr,e.hasActiveSubscription=a,s&&e.heroContentType===i8.premierExclusive?(p.add("premier-exclusive"),Promise.all([l.getLogosByThemePromise(t),g.getRatingModelPromise(),o.getActionForSubscriptionLevel(u,yI.y.PREMIUM)]).then(function(t){var i=Z6(t,3),n=i[0],r=i[1],o=r.showRating,a=r.hasRating,s=r.gdpPath,c=i[2];e.originAccessLogos=n,e.showRatings=o,e.hasRating=a,e.gdpPath=s,e.shouldShowContent=!0,function(t){switch(t.name){case F6.BECOME_MEMBER:e.strings.originAccessCtaText=e.strings.becomeMemberCtaText,e.telemetryClass=L6,e.ctaMode=VS[yI.p.SIGN_UP_PREMIER];break;case F6.UPGRADE_MEMBERSHIP:e.strings.originAccessCtaText=e.strings.upgradeMembershipCtaText,e.telemetryClass=D6;break;default:e.strings.originAccessCtaText=""}}(c),e.$digest()})):d&&e.heroContentType===i8.bothTiers&&(p.add("both-tiers"),e.shouldShowContent=!0,g.setRatings(),e.$digest())}var g=Z6(a,1)[0],u=n.buildPathFromUrl();e.shouldShowContent=!1,e.heroContentTypeEnum=i8,e.showOriginAccessButton=function(){return e.premierSubscriptionOfferIds&&e.strings.originAccessCtaText},Promise.all([g.getTheme(),o.getVaultModelForAllTiers(u),s.populateScope(e,e8)]).then(function(e){var t=Z6(e,2);return d(t[0],t[1])})},controller:tu,template:X6}}function mu(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";return{restrict:"E",transclude:!0,scope:{theme:"@",releasedTitleStr:"@",releasedSubtitleStr:"@",releasedSubscriberSubtitleStr:"@",beforeEarlyAccessTitleStr:"@",beforeEarlyAccessSubtitleStr:"@",beforeEarlyAccessSubscriberTitleStr:"@",beforeEarlyAccessSubscriberSubtitleStr:"@",duringEarlyAccessTitleStr:"@",duringEarlyAccessSubtitleStr:"@",duringEarlyAccessSubscriberTitleStr:"@",duringEarlyAccessSubscriberSubtitleStr:"@",footerStr:"@",footerSubscriberStr:"@",becomeMemberCtaText:"@",upgradeMembershipCtaText:"@",focusTileImage:"@",interstitialAbTestVariantName:"@",interstitialAbTestGames:"@"},link:function(e){function i(t,i){t.isReleased?(e.strings.titleStr=f.getLocalizedStr(e.releasedTitleStr,m8,"released-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.releasedSubtitleStr,m8,"released-subtitle-str",i)):t.isEarlyAccess?(e.strings.titleStr=f.getLocalizedStr(e.duringEarlyAccessTitleStr,m8,"during-early-access-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.duringEarlyAccessSubtitleStr,m8,"during-early-access-subtitle-str",i)):(e.strings.titleStr=f.getLocalizedStr(e.beforeEarlyAccessTitleStr,m8,"before-early-access-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.beforeEarlyAccessSubtitleStr,m8,"before-early-access-subtitle-str",i)),e.strings.footerStr=f.getLocalizedStr(e.footerStr,m8,"footer-str",i)}function n(t,n){var r,o,a,s=(r={},o=f8,a=d8()(n,[DI.I,DI.k]),o in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,r);switch(t.name){case F6.BECOME_MEMBER:e.strings.originAccessCtaText=f.getLocalizedStr(e.becomeMemberCtaText,m8,"become-member-cta-text"),e.ctaMode=VS[yI.p.SIGN_UP_PREMIER],e.telemetryClass=L6,i(t.context,s);break;case F6.UPGRADE_MEMBERSHIP:e.strings.originAccessCtaText=f.getLocalizedStr(e.upgradeMembershipCtaText,m8,"upgrade-membership-cta-text"),e.telemetryClass=D6,function(t,i){t.isReleased?(e.strings.titleStr=f.getLocalizedStr(e.releasedTitleStr,m8,"released-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.releasedSubscriberSubtitleStr,m8,"released-subscriber-subtitle-str",i)):t.isEarlyAccess?(e.strings.titleStr=f.getLocalizedStr(e.duringEarlyAccessSubscriberTitleStr,m8,"during-early-access-subscriber-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.duringEarlyAccessSubscriberSubtitleStr,m8,"during-early-access-susbcriber-subtitle-str",i)):(e.strings.titleStr=f.getLocalizedStr(e.beforeEarlyAccessSubscriberTitleStr,m8,"before-early-access-subscriber-title-str",i),e.strings.subtitleStr=f.getLocalizedStr(e.beforeEarlyAccessSubscriberSubtitleStr,m8,"before-early-access-subscriber-subtitle-str",i)),e.strings.footerStr=f.getLocalizedStr(e.footerSubscriberStr,m8,"footer-subscriber-str",i)}(t.context,s);break;default:e.strings.originAccessCtaText="",i(t.context,s)}return u.waitForAllPriceInsertingPromises([u.insertPriceIntoLocalizedStrAsync(e.strings,e.strings.titleStr,m8,"title-str",s),u.insertPriceIntoLocalizedStrAsync(e.strings,e.strings.subtitleStr,m8,"subtitle-str",s),u.insertPriceIntoLocalizedStrAsync(e.strings,e.strings.footerStr,m8,"footer-str",s)],e)}var r=o.buildPathFromUrl();e.shouldShowContent=!1,e.strings={},e.theme=e.theme||FS.dark,e.getBackgroundStyle=function(t){return b8+", url('"+e.tileImages[t]+"')"};var a={filterQuery:"subscriptionGroup:vault-games",facetField:"",sort:MS.Rank+" "+jS.Descending,start:0,rows:16,isGDP:!0},s=e.interstitialAbTestGames?e.interstitialAbTestGames.split(","):void 0;g.isInExperimentAndViewingApplicableGame(s,e.interstitialAbTestVariantName,r.gdpPath).then(function(i){i?(Promise.all([d.getVaultModelForAllTiers(r),c.getLogosByThemePromise(e.theme),t.populateScope(e,m8)]).then(function(t){var i=p8(t,2);return function(t,i){var o=d8()(t,["editionAgnosticModel"]);return e.originAccessLogos=i,d.getActionForSubscriptionLevel(r,yI.y.PREMIUM).then(function(e){return n(e,o)})}(i[0],i[1])}).then(function(){e.gdpPath=r.gdpPath,e.shouldShowContent=!0,e.$digest()}),p.searchStore("",a,[r.gdpPath]).then(function(e){return d8()(e,[h8,v8])}).then(function(e){return e.map(function(e){return d8()(e,"image")})}).then(function(t){return e.tileImages=u8()(t)}).catch(function(){})):e.isEmpty=!0})},controller:tu,template:c8}}function fu(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function hu(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b){"ngInject";return{restrict:"E",transclude:!0,scope:{releasedTitleStr:"@",releasedSubtitleStr:"@",releasedSubscriberSubtitleStr:"@",beforeEarlyAccessTitleStr:"@",beforeEarlyAccessSubtitleStr:"@",beforeEarlyAccessSubscriberTitleStr:"@",beforeEarlyAccessSubscriberSubtitleStr:"@",duringEarlyAccessTitleStr:"@",duringEarlyAccessSubtitleStr:"@",duringEarlyAccessSubscriberTitleStr:"@",duringEarlyAccessSubscriberSubtitleStr:"@",footerStr:"@",footerSubscriberStr:"@",premierPromotionFooterStr:"@",basicPromotionFooterStr:"@",becomeMemberCtaText:"@",becomePremierTrialMemberCtaText:"@",upgradeMembershipCtaText:"@",upgradePremierTrialMembershipCtaText:"@",searchFacet:"@",interstitialAbTestVariantName:"@",interstitialAbTestGames:"@"},link:function(e){function i(t,i){t.isReleased?(y.titleStr=h.getLocalizedStr(e.releasedTitleStr,I8,"released-title-str",i),y.subtitleStr=h.getLocalizedStr(e.releasedSubtitleStr,I8,"released-subtitle-str",i)):t.isEarlyAccess?(y.titleStr=h.getLocalizedStr(e.duringEarlyAccessTitleStr,I8,"during-early-access-title-str",i),y.subtitleStr=h.getLocalizedStr(e.duringEarlyAccessSubtitleStr,I8,"during-early-access-subtitle-str",i)):(y.titleStr=h.getLocalizedStr(e.beforeEarlyAccessTitleStr,I8,"before-early-access-title-str",i),y.subtitleStr=h.getLocalizedStr(e.beforeEarlyAccessSubtitleStr,I8,"before-early-access-subtitle-str",i)),n(i)}function n(t){t.isPremierPromotionEnabled?y.footerStr=h.getLocalizedStr(e.premierPromotionFooterStr,I8,"premier-promotion-footer-str",t):y.footerStr=h.getLocalizedStr(e.footerStr,I8,"footer-str",t)}function r(t,i){t.isReleased?(y.titleStr=h.getLocalizedStr(e.releasedTitleStr,I8,"released-title-str",i),y.subtitleStr=h.getLocalizedStr(e.releasedSubscriberSubtitleStr,I8,"released-subscriber-subtitle-str",i)):t.isEarlyAccess?(y.titleStr=h.getLocalizedStr(e.duringEarlyAccessSubscriberTitleStr,I8,"during-early-access-subscriber-title-str",i),y.subtitleStr=h.getLocalizedStr(e.duringEarlyAccessSubscriberSubtitleStr,I8,"during-early-access-susbcriber-subtitle-str",i)):(y.titleStr=h.getLocalizedStr(e.beforeEarlyAccessSubscriberTitleStr,I8,"before-early-access-subscriber-title-str",i),y.subtitleStr=h.getLocalizedStr(e.beforeEarlyAccessSubscriberSubtitleStr,I8,"before-early-access-subscriber-subtitle-str",i)),n(i)}function a(t,i){return t===F6.BECOME_MEMBER?i?h.getLocalizedStr(e.becomePremierTrialMemberCtaText,I8,"become-premier-trial-member-cta-text"):h.getLocalizedStr(e.becomeMemberCtaText,I8,"become-member-cta-text"):t===F6.UPGRADE_MEMBERSHIP?i?h.getLocalizedStr(e.upgradePremierTrialMembershipCtaText,I8,"upgrade-premier-trial-membership-cta-text"):h.getLocalizedStr(e.upgradeMembershipCtaText,I8,"upgrade-membership-cta-text"):""}var s,l,p=(s=regeneratorRuntime.mark(function t(n,o,s){var c,l,d,g,p,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([b.isPromotionEnabled(yI.y.PREMIUM),b.isPremierTrialEnabled()]);case 2:l=t.sent,d=k8(l,2),g=d[0],p=d[1],fu(c={},w8,d8()(s,[DI.I,DI.k])),fu(c,dw,_.get(o,[yI.y.STANDARD,yI.d])),fu(c,gw,_.get(o,[yI.y.PREMIUM,yI.d])),fu(c,"isPremierPromotionEnabled",g),f=c,e.strings.originAccessCtaText=a(n.name,p),t.t0=n.name,t.next=t.t0===F6.BECOME_MEMBER?11:t.t0===F6.UPGRADE_MEMBERSHIP?15:19;break;case 11:return e.ctaMode=b.getBecomePremierMemberCTAMode(p,g),e.telemetryClass=L6,i(n.context,f),t.abrupt("break",21);case 15:return e.ctaMode=p?yI.p.UPGRADE_PREMIER_TRIAL:yI.p.UPGRADE_PREMIER,e.telemetryClass=D6,r(n.context,f),t.abrupt("break",21);case 19:return i(n.context,f),t.abrupt("break",21);case 21:return t.abrupt("return",u.waitForAllPriceInsertingPromises([u.insertPriceIntoLocalizedStrAsync(e.strings,y.titleStr,I8,"title-str",f),u.insertPriceIntoLocalizedStrAsync(e.strings,y.subtitleStr,I8,"subtitle-str",f),u.insertPriceIntoLocalizedStrAsync(e.strings,y.footerStr,I8,"footer-str",f)],e).then(function(){return m.digestIfDigestNotInProgress(e)}));case 22:case"end":return t.stop()}},t,this)}),l=function(){var e=s.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e,t,i){return l.apply(this,arguments)}),f=o.buildPathFromUrl();e.gdpPath=f.gdpPath,e.shouldShowContent=!1,e.strings={};var y={},S=e.interstitialAbTestGames?e.interstitialAbTestGames.split(","):void 0;g.isInExperimentAndViewingApplicableGame(S,e.interstitialAbTestVariantName,f.gdpPath).then(function(i){i?Promise.all([d.getVaultModelForAllTiers(f),c.getLogosPromise(qS.White),t.populateScope(e,I8)]).then(function(t){var i=k8(t,2);return function(t,i){var n=d8()(t,[DI.o]);return e.packArt=d8()(t,[DI._17,DI.I,DI._10],d8()(n,[DI.I,DI._10])),e.accessLogo=i.premier,e.shouldShowContent=!0,Promise.all([d.getActionForSubscriptionLevel(f,yI.y.PREMIUM),v.getVaultGamesCount()]).then(function(e){var t=k8(e,2),i=t[0],r=t[1];return p(i,r,n)})}(i[0],i[1])}):e.isEmpty=!0})},controller:tu,template:S8}}function vu(e,t,i){"ngInject";t.getDiscountRateByOfferId(e.loyaltyOfferId).then(function(t){_.isUndefined(t)||(e.loyaltyOfferPrimaryText=i.getLocalizedStr("",P8,T8,{"%discountRate%":t}))}).catch(function(){e.loyaltyOfferPrimaryText=null})}function bu(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",scope:{header:"@",headerBasicTrial:"@",headerBasicPromo:"@",description:"@",descriptionBasicTrial:"@",descriptionBasicPromo:"@",legal:"@",featuredGames:"@",featuredGamesBasicTrial:"@",searchFacet:"@",becomeMemberCtaText:"@",basicTrialSignupCtaText:"@",basicPromoSignupCtaText:"@",upgradeMembershipCtaText:"@",premierTrialSignupCtaText:"@",upgradePremierTrialMembershipCtaText:"@"},link:function(c){function l(e,t){return t.isPremierPromotionEnabled?e===yI.y.STANDARD?c.upgradeMembershipCtaText:c.becomeMemberCtaText:t.isPremierTrialEnabled?e===yI.y.STANDARD?c.upgradePremierTrialMembershipCtaText:c.premierTrialSignupCtaText:e===yI.y.NONE&&t.isBasicPromotionEnabled&&c.basicPromoSignupCtaText?c.basicPromoSignupCtaText:e===yI.y.NONE&&t.isBasicTrialEnabled&&c.basicTrialSignupCtaText?c.basicTrialSignupCtaText:e===yI.y.STANDARD?c.upgradeMembershipCtaText:c.becomeMemberCtaText}var d,g,u=(d=regeneratorRuntime.mark(function e(){var t,n,r,s,d,g,u,p,m,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=yI.y.PREMIUM,n=o.getCurrentSubscriptionLevel(),r=!1,s=!1,e.next=5,Promise.all([o.isPremierTrialEnabled(),o.isPromotionEnabled(yI.y.PREMIUM)]);case 5:d=e.sent,g=W8(d,2),u=g[0],p=g[1],m={isBasicTrialEnabled:r,isBasicPromotionEnabled:s,isPremierTrialEnabled:u,isPremierPromotionEnabled:p},e.t0=n,e.next=e.t0===yI.y.NONE?13:e.t0===yI.y.STANDARD?29:35;break;case 13:if(u||p){e.next=22;break}return e.next=16,Promise.all([o.isBasicTrialEnabled(),o.isPromotionEnabled(yI.y.STANDARD)]);case 16:f=e.sent,h=W8(f,2),m.isBasicTrialEnabled=h[0],m.isBasicPromotionEnabled=h[1],c.showBasicTrial=m.isBasicTrialEnabled,c.showBasicPromotion=m.isBasicPromotionEnabled&&c.headerBasicPromo&&c.descriptionBasicPromo;case 22:return(c.showBasicTrial||c.showBasicPromotion)&&(t=yI.y.STANDARD),e.next=25,o.getCtaModeForIntendedSubscriptionLevel(t,void 0,m);case 25:return c.mode=e.sent,c.strings.btnText=l(yI.y.NONE,m),c.showCta=!0,e.abrupt("break",35);case 29:return e.next=31,o.getCtaModeForIntendedSubscriptionLevel(t,yI.y.STANDARD,m);case 31:return c.mode=e.sent,c.strings.btnText=l(yI.y.STANDARD,m),c.showCta=!0,e.abrupt("break",35);case 35:i.getLogosPromise(qS.Dark).then(function(e){c.accessLogo=c.showBasicTrial||c.showBasicPromotion?e[F$]:e[D$]}),a.setNuxModel(),c.featuredGamesList=c.showBasicTrial||c.showBasicPromotion?c.featuredGamesBasicTrial:c.featuredGames;case 38:case"end":return e.stop()}},e,this)}),g=function(){var e=d.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return g.apply(this,arguments)});c.showCta=!1,c.strings={},e.getAutomationConfig()&&(c.automationHeroId=Y8,c.automationCtaId=K8),t.populateScope(c,q8).then(u).then(s.getVaultGamesCount).then(function(e){var t={};t[dw]=_.get(e,[yI.y.STANDARD,yI.d]),t[gw]=_.get(e,[yI.y.PREMIUM,yI.d]);var i=c.showBasicPromotion?c.headerBasicPromo:c.showBasicTrial?c.headerBasicTrial:c.header,o=c.showBasicPromotion?c.descriptionBasicPromo:c.showBasicTrial?c.descriptionBasicTrial:c.description;n.waitForAllPriceInsertingPromises([n.insertPriceIntoLocalizedStrAsync(c.strings,i,q8,"header",t),n.insertPriceIntoLocalizedStrAsync(c.strings,o,q8,"description",t),n.insertPriceIntoLocalizedStrAsync(c.strings,c.legal,q8,"legal",t)],c).then(function(){return r.digestIfDigestNotInProgress(c)})})},template:V8}}function yu(e,t,i,n,r,o,a,s){"ngInject";function c(e,t,i){return g.defaultTo(i)(g.getProperty(t)(e))}function l(e){var t=n.getFacets();return _.forEach(e.facets,function(e){e.constraint&&t[e.facetName].setAllFilterCounts(e.constraint)}),e}function d(){var e,t=_.map(v.trim().split(","),function(e){return-1!==e.indexOf(sW)?"("+e+")":e}).join(aW);return!(t.length>0)||t.startsWith("(")&&t.endsWith(")")||(t="("+t+")"),(e=t,_.isEmpty(k)&&_.isEmpty(I)?Promise.resolve(e):i.getWhiteBlackListQueries(k,I).then(function(t){var i=t.whiteListQuery,n=t.blackListQuery,r=i?"("+(e?e+sW:"")+i+")":e;return n?r?r+aW+n:n:r})).then(function(e){var t,i,n,r=h.trim();return""!==r&&(t=r,i=_.map(u.splitCommaDelimitedFacetQueryParam(t),function(e){return e.split(":")}),n=g.mergeToObject(i),r=_.map(Object.keys(n),function(e){var t=n[e].length;return t>1?e+":("+n[e].join(aW)+")":1===t?e+":"+n[e][0]:""})),Promise.resolve(_.compact([e,r]).join(","))})}var g=e,u=r,p=t,m="",f=t9,h="",v="",b=0,y=0,S=!1,k=[],I=[],w={rank:["releaseDate desc","title desc"],releaseDate:["rank desc","title desc"],dynamicPrice:["rank desc","releaseDate desc","title desc"],title:["rank desc","releaseDate desc"]};return{reset:function(){return m="",f=t9,h="",v="",p.dismissAllFacets(),p.dismissAllSortOrders(),k=[],I=[],S=!1,this},setFacets:function(e){return h=e,u.updateFacetValuesFromQuery(h),this},setFacetOverride:function(e){return v=e||"",this},setSearchString:function(e){return m=e,this},setCustomSort:function(e){return e&&r9.test(f)&&(f=(e=i9+e+n9)+","+f),this},setSortBy:function(e){return e=e||t9,u.updateSortValuesFromQuery(e),f=function(e){for(var t=[e],i=Object.keys(w),n=0;n<i.length;n++){var r=i[n];if(e.indexOf(r)>=0){t=t.concat(w[r]);break}}return t.join(",")}(e),this},setLimit:function(e){return y=e,this},setOffset:function(e){return b=e,this},setBlackList:function(e){return I=e,this},setWhiteList:function(e){return k=e,this},setIsGdp:function(e){return S=e,this},search:function(e){return function(e){return d().then(function(t){var n=Object.assign({filterQuery:t,facetField:u.getFacetCategories(),sort:f,start:b,rows:y,isGDP:S},e||{});return i.searchStore(m,n)})}(e).then(function(e){return{totalResults:c(e,["games","numFound"],0),games:c(e,["games","game"],[]),facets:c(e,["facetList","facets"],[])}}).then(l).then(function(e){return s.events.fire(pW,b>0),e}).catch(a.unblockUIPromiseOnError).catch(function(e){return o.error("[StoreSearchFactory: SearchFactory.searchStore] failed",e),Promise.reject(e)})}}}function Su(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";e.getTileHref=f.buildGdpUrlFromPath;var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.violatorText=t,e.violatorType=i,e.showViolator=n},v=function(t){var i={tileLayout:v9,tileImage:function(t,i){return e.imageUrl||_.get(void 0,[DI.I,DI._10])}(),tileHeader:function(t){return e.gameName||_.get(t,[DI.I,DI.k])}(t),index:function(e){return _.get(e,DI.Y)}(t),gdpPath:function(t){return e.gdpPath||_.get(t,[DI.E])}(t,DI.E)};return function(e,t){var i=p.getVaultStartDate(t),n=m.getVaultStartDate(t)||i,r=!_.isNull(n)&&!o.isInTheFuture(n)&&o.isInTheFuture(o.addDays(n,y9)),s=!_.isNull(n)&&o.isInTheFuture(n),c=_.get(t,DI.n,!1);r?h(e,a.getLocalizedStr(null,p9,m9),m9,!0):c?h(e,a.getLocalizedStr(null,p9,f9),f9,!0):s?h(e,moment(n).format("MMM Do"),h9,!0):h(e)}(i,t),i};e.goToOffer=function(t){t.preventDefault(),n.goToGdp(e.gameTileConfig.gdpPath)};var b=new KH(e.gdpPath);g.getVaultModelPromise(b,u.getCurrentSubscriptionLevel()).then(function(t){e.gameTileConfig=v(t)}).finally(function(){t.getAutomationConfig()&&(e.automationTileId=b9),r.digestIfDigestNotInProgress(e)})}function ku(e){"ngInject";var t=this,i=[];e.expanded=e.expandByDefault===OS.true,e.allRevealed=!1,e.itemLimit=parseInt(e.initialItemLimit||0,10),this.toggleAll=function(){i.forEach(function(t){t.toggleContent(e.expanded)})},this.registerItem=function(t){var n=i.push(t);t.toggleContent(e.expanded),t.isHidden=e.itemLimit&&n>e.itemLimit},e.toggle=function(){e.expanded=!e.expanded,t.toggleAll()},e.revealAllToggle=function(){e.allRevealed=!e.allRevealed,i.forEach(function(t,i){t.isHidden=!e.allRevealed&&i>=e.itemLimit})},e.revealToggleBtnText=function(){return e.allRevealed?e.revealLessText:e.revealMoreText},this.toggleExpandLink=function(){var t=!0,n=!0;i.forEach(function(e){t=t&&e.expanded,n=n&&!e.expanded}),t?e.expanded=!0:n&&(e.expanded=!1)}}function Iu(e,t){"ngInject";return{restrict:"E",controller:ku,require:"?^originStorePdpSectionWrapper",scope:{showBorder:"@",expand:"@",collapse:"@",expandByDefault:"@",more:"@",initialItemLimit:"@",revealMoreText:"@",revealLessText:"@"},transclude:!0,link:function(i,n,r,o){e.populateScope(i,L9).then(function(){i.strings={more:t.getLocalizedStr(i.more,L9,"more",{"%url-language%":Origin.locale.languageCode()})},o&&_.isFunction(o.setVisibility)&&o.setVisibility(!0),i.$digest()})},template:x9}}function wu(e,t,i,n,r,o,a,s){"ngInject";return{restrict:"E",require:"?^originStoreAccordionlist",scope:{topic:"@",content:"@",eaccount:"@",customerexperience:"@",editOriginAccess:"@"},link:function(e,c,l,d){var g=c.find(".origin-store-accordionlist-item-content");e.itemNumber=c.index()+1,e.toggleContent=function(t){e.expanded=void 0===t?!e.expanded:t,e.expanded?g.slideDown(R9):g.hide(),d&&_.isFunction(d.toggleExpandLink)&&d.toggleExpandLink(e)},e.onClickEditOriginAccess=function(e){e.preventDefault(),s.promiseLogin().then(function(){a.openDirective({id:pI,name:mI,size:_I,data:{}})})},e.strings={},e.eaccount=n.getLocalizedStr(e.eaccount,D9,"eaccount"),e.customerexperience=n.getLocalizedStr(e.customerexperience,D9,"customerexperience"),e.editOriginAccess=n.getLocalizedStr(e.editOriginAccess,D9,"edit-origin-access");var u,p='<a href="'+(u=i.getUrl("eaAccounts"),Origin.client.isEmbeddedBrowser()||(u=(u=u.replace("{locale}",Origin.locale.locale())).replace("{access_token}","")),u)+'" class="otka external-link-sso">'+e.eaccount+"</a>",m='<a href="'+i.getHelpUrl(Origin.locale.locale(),Origin.locale.languageCode())+'" class="otka external-link-sso">'+e.customerexperience+"</a>";t.insertPriceIntoLocalizedStr(e,e.strings,e.topic,D9,"topic"),t.insertPriceIntoLocalizedStr(e,e.strings,e.content,D9,"content",{"%eaaccount%":p,"%customerexperience%":m}).then(function(){var t='<a href="javascript:void(0)" class="otka" ng-click="onClickEditOriginAccess($event)">'+e.editOriginAccess+"</a>";e.strings.content=e.strings.content.replace("%editoriginaccess%",t),g.append(o("<span>"+e.strings.content+"</span>")(e))}),r.populateScope(e,D9).then(function(){d&&_.isFunction(d.registerItem)&&d.registerItem(e)})},template:A9}}function Cu(e){"ngInject";function t(){if(!a){var e=[];_.forEach(n,function(t){e.push(t(r,i))}),e.length>0?Promise.all(e).then(i):o<N9&&(o++,setTimeout(t,200))}}function i(){var e;(e=r+1)>=n.length&&(e=0),r=e,t()}var n=[],r=0,o=0,a=!1;this.registerCarouselItem=function(e){return n.push(e),n.length-1},this.getTimeoutInterval=function(){return 1e3*parseInt(e.rotationInterval,10)||$9},setTimeout(t,10),e.$on("$destroy",function(){a=!1})}function Tu(e,t,i,n){"ngInject";return{restrict:"E",replace:!0,scope:{ocdPath:"@",videoId:"@",imageUrl:"@"},require:"^originBackgroundMediacarousel",link:function(r,o,a,s){function c(){var e=o.find(".origin-video-player");return t.loadYoutubePlayer(e,r.videoId,{autoplay:1},U9,B9).then(l)}function l(e){return f=e}function d(){return f.playVideo(),f.mute(),Promise.resolve()}function g(){m&&d()}function u(){return new Promise(function(e){m=!0,r.timerHandle=setTimeout(function(){m=!1,e()},r.timeoutInterval)})}function p(){r.isSmallScreen=n.isXSmall(),r.$digest(),!r.isSmallScreen&&m?f?g():c().then(g):f&&f.stopVideo()}r.timeoutInterval=s.getTimeoutInterval(),r.isSmallScreen=n.isXSmall();var m=!1,f=void 0;r.notify=function(e){return r.isOnTop&&r.assignedIndex===e?u():(r.isOnTop=r.assignedIndex===e,r.$digest(),!r.isOnTop&&f&&f.stopVideo(),new Promise(function(e){r.isOnTop?r.isSmallScreen?u().then(e):f?d().then(u).then(e):c().then(d).then(u).then(e):e()}))},e.populateScopeWithOcdAndCatalog(r,M9,r.ocdPath).then(function(){r.imageUrl=r.imageUrl||t.getStillImage(r.videoId),r.assignedIndex=s.registerCarouselItem(r.notify),i.addResizeEventHandler(r,p,G9)})},controller:"originBackgroundMediacarouselItemCtrl",template:mz}}function Pu(e){"ngInject";var t=function(){e.imagesCollection=[].concat(e.images),e.currentIndex=0};t(),e.$watch("images",t),this.registerBackgroundImage=function(t){e.imagesCollection.push(t)}}function _u(e,t){"ngInject";return{restrict:"A",link:function(i,n){function r(e){var n=t.hexToRgba(e,1),r=t.hexToRgba(e,0);i.gradientLeft=t.createLinearGradient(n,0,r,100),i.gradientRight=t.createLinearGradient(r,0,n,100),c&&(i.gradientBottom=t.createLinearGradient(r,0,n,100,"top to bottom"))}var o=angular.element('<div class="origin-backgroundimage-scrim origin-telemetry-backgroundimage-scrim origin-backgroundimage-scrim-left" origin-style="gradientLeft"></div>'),a=angular.element('<div class="origin-backgroundimage-scrim origin-telemetry-backgroundimage-scrim origin-backgroundimage-scrim-right" origin-style="gradientRight"></div>'),s=angular.element('<div class="origin-backgroundimage-scrim origin-telemetry-backgroundimage-scrim origin-backgroundimage-scrim-bottom" origin-style="gradientBottom"></div>'),c=i.bottomScrim&&"true"===i.bottomScrim;n.append(e(o)(i)),n.append(e(a)(i)),c&&n.append(e(s)(i)),r(i.backgroundColor);var l=i.$watch("backgroundColor",function(e){e&&(l(),r(e))})}}}function Ou(e,t){"ngInject";return{restrict:"E",scope:{},link:function(i){i.noResultFoundStr=e.getLocalizedStr(!1,q9,"no-results-found"),i.noResultFoundLinkStr=e.getLocalizedStr(!1,q9,"no-result-found-link-label"),i.onButtonClick=function(){t.dismissAllFacets(),t.dismissSearchString(),t.reloadCurrentPage().then(t.triggerSearch)}},template:W9}}function Eu(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){s.cancelStaggerLoading(e),e.games=[],b=0,v=!1,a.blockUIPromise().then(e.search).then(a.unblockUIPromise)}function g(t){b=e.games.length,v=b<t.totalResults,$(window).scrollTop()+$(window).height()>$(document).height()-e7&&v&&e.loadMore()}function u(t,n){t.games&&(t.games.length?s.staggerLoadGameTiles(e,e.games,t.games).then(function(){g(t)}).catch(function(){e.games.length?e.games=e.games.concat(t.games):e.games=t.games,e.isLoading=!1,e.$digest(),g(t)}):(e.games=[],e.isLoading=!1,g(t))),e.pageTitle=h?i.getLocalizedStr(e.resultsFound,Q9,"results-found",{"%totalResults%":t.totalResults,"%queryString%":h}):e.facebookPageTitle,e.$digest(),n&&angular.element(window).scrollTop(0)}function p(){var i,r,o=(e.isLoading=!0,e.searchRequestFailed=!1,e.$digest(),h=t.getSearchStringQueryParam(),n.reset().setSearchString(h).setFacetOverride(e.filterQuery).setFacets(t.getFacetsQueryParam()).setSortBy((i=f(Q9),r=t.getSortQueryParam()||l.get(i,""),r&&l.set(i,r),r)).setCustomSort(e.customRank).setLimit(J9).setOffset(b).setBlackList(e.blackListArray).setWhiteList(e.whiteListArray).setIsGdp(e.isGdp));return c.unsetRobotsRule(),s.getActiveFacetsCount()>=Z9&&c.setRobotsRule(X9),o.search()}function m(){e.isLoading=!1,e.searchRequestFailed=!0,e.resetSavedSortString(),e.$digest()}function f(e){return _.compact([e,Origin.user.userPid()]).join("_")}e.games=[],e.isLoading=!0;var h=null,v=!1,b=0;e.facebookPageTitle=i.getLocalizedStr(e.titleStr,Q9,"title-str"),e.loadMore=function(){return e.isLoading=!0,p().then(_.partialRight(u)).catch(m)},e.lazyLoadDisabled=function(){return e.isLoading||!v},e.search=function(){return b=0,p().then(_.partialRight(u,!0)).catch(m)},e.resetSavedSortString=function(){var e=f(Q9);l.get(e)&&l.delete(e)},r.events.on("storeSearchHelper:triggerSearch",d),e.$on("$destroy",function(){r.events.off("storeSearchHelper:triggerSearch",d),c.unsetRobotsRule(),o.setEmbeddedFilterpanel(!1)})}function Fu(e,t){"ngInject";return{restrict:"E",replace:!0,transclude:!0,scope:{titleStr:"@",hideFacebook:"@",resultsFound:"@",noResultFound:"@"},controller:Eu,link:function(i){e(i.search,0),t.populateScope(i,Q9).then(function(){i.isFacebookHidden=i.hideFacebook===t7.true})},template:K9}}function xu(e,t,i,n){"ngInject";return{scope:{offerId:"@",onClick:"&",model:"<",offerType:"@",buttonType:"@",upgradeOfferStr:"@",downgradeOfferStr:"@",addVaultOfferStr:"@",addedVaultOfferStr:"@",addToLibraryStr:"@",viewInLibraryStr:"@",updatePackStr:"@",updatedPackStr:"@",addOfferStr:"@",removeOfferStr:"@",addFreeOfferStr:"@",addedFreeOfferStr:"@"},link:function(r,o){function a(e){var t="";r.isXsellOffer?t="origin-telemetry-store-cartoffer-xsell-undocta":r.isUpsellOffer?t="origin-telemetry-store-cartoffer-upsell-undocta":r.isSwapOffer&&(t="origin-telemetry-store-cartoffer-swap-undocta");var i='<span class="otka origin-store-cartoffer-undocta origin-telemetry-store-cartoffer-undocta '+t+' ">';return e.replace("%",i).replace("%","</span>")}o.find(".origin-store-cartoffer-cta").addClass(r7[r.buttonType]||r7.light),r.isOfferAddedToCart=e.ownsEntitlement(r.offerId);var s={"%offerPrice%":_.get(r,"model.formattedPrice","")};switch(r.offerType){case US.xsell:r.isXsellOffer=!0,r.strings={addOfferCtaStr:t.getLocalizedStr(r.addOfferCtaStr,o7,"add-offer-str",s),removeOfferCtaStr:a(t.getLocalizedStr(r.removeOfferCtaStr,o7,"remove-offer-str"))};break;case US.upsell:r.isUpsellOffer=!0,r.strings={addOfferCtaStr:t.getLocalizedStr(r.upgradeOfferStr,o7,"upgrade-offer-str",s),removeOfferCtaStr:a(t.getLocalizedStr(r.downgradeOfferStr,o7,"downgrade-offer-str"))};break;case US.vault:r.isVaultOffer=!0,r.strings={addOfferCtaStr:t.getLocalizedStr(r.addVaultOfferStr,o7,"add-vault-offer-str"),removeOfferCtaStr:t.getLocalizedStr(r.addedVaultOfferStr,o7,"added-vault-offer-str")};break;case US.vaultInLibrary:r.strings={addOfferCtaStr:t.getLocalizedStr(r.addToLibraryStr,o7,"add-to-library-str"),removeOfferCtaStr:a(t.getLocalizedStr(r.viewInLibraryStr,o7,"view-in-library-str"))};break;case US.swap:r.isSwapOffer=!0,r.strings={addOfferCtaStr:t.getLocalizedStr(r.updatePackStr,o7,"update-pack-str"),removeOfferCtaStr:a(t.getLocalizedStr(r.updatedPackStr,o7,"updated-pack-str"))};break;case US.free:r.strings={addOfferCtaStr:t.getLocalizedStr(r.addFreeOfferStr,o7,"add-free-offer-str"),removeOfferCtaStr:a(t.getLocalizedStr(r.addedFreeOfferStr,o7,"added-free-offer-str"))}}o.on("click",".origin-store-cartoffer-undocta",function(){r.addOrRemoveOffer(),r.$digest()}),r.addOrRemoveOffer=function(){r.isOfferAddedToCart||(r.isOfferAddedToCart=!0),_.isFunction(r.onClick)&&_.isFunction(r.onClick())&&r.onClick()({offerId:r.offerId,isSelected:r.isOfferAddedToCart,offerType:r.offerType,model:r.model})},r.onCtaLinkClicked=function(t){t.stopPropagation(),r.offerType===US.vaultInLibrary?(n.closeCurrentShowingDialog(),i.goToState(bI.u,{offerid:r.offerId})):(r.isOfferAddedToCart=e.ownsEntitlement(r.offerId),_.isFunction(r.onClick)&&_.isFunction(r.onClick())&&r.onClick()({offerId:r.offerId,isSelected:r.isOfferAddedToCart,offerType:r.offerType,model:r.model}))},r.$on(CP,function(){r.isWaiting=!0}),r.$on(TP,function(){r.isWaiting=!1}),r.$on(PP,function(){r.isWaiting=!1})},template:n7}}function Lu(e,t,i,n,r,o,a,s,c,l){"ngInject";return{restrict:"E",transclude:!0,scope:{mp4VideoUrl:"@",webmVideoUrl:"@",image:"@",cmsVideoId:"@"},template:s7,link:function(d,g){function u(){g.parents(".origin-store-carousel-content.origin-telemetry-store-carousel-content").hasClass(c.current)?p():v.pause(d.cmsVideoId).catch()}function p(){a.isXSmall()?f.isPlaying=!0:new Promise(function(e){y?e(d.cmsVideoId):(b&&(clearTimeout(b),b=void 0),b=setTimeout(function(){m.classList.add("origin-store-cmsvideo-initialized"),y=!0,b=void 0,e(d.cmsVideoId)},d7))}).then(v.play).catch()}var m=g.find("video").get(0),f={nativePlayer:m},h=g.parents(".origin-store-carousel-hero"),v=window.Origin.client.isEmbeddedBrowser()&&window.Origin.utils.os()===window.Origin.utils.OS_WINDOWS?n:t,b=void 0,y=!1,S=h.length>0;d.backgroundColor=d.backgroundColor||g7,d.cmsVideoId||(d.cmsVideoId=c7+r.guid()),d.mp4VideoUrl&&d.webmVideoUrl&&(d.trustedMp4Video=e.trustAsResourceUrl(d.mp4VideoUrl),d.trustedWebmVideo=e.trustAsResourceUrl(d.webmVideoUrl),f.mp4Video=d.trustedMp4Video,f.webmVideo=d.trustedWebmVideo,f.mediaSourceCodec=i.MP4Codec),S&&(s.events.on(l.initialized,u),s.events.on(l.transitioned,u)),o.addResizeEventHandler(d,function(){a.isXSmall()?(m.style.display="none",m.pause()):(m.style.display="block",f.isPlaying&&p())},l7),d.$on("$destroy",function(){S&&(s.events.off(l.initialized,u),s.events.off(l.transitioned,u)),b&&(clearTimeout(b),b=void 0)}),v.register(d.cmsVideoId,f,d).then(function(){S||p()}).catch()}}}function Au(e){"ngInject";return{restrict:"E",scope:{items:"=",type:"@"},link:function(t,i){t.isContextMenuVisible=!1,t.toggleContextMenu=function(){var n,r,o,a,s;t.isContextMenuVisible=!t.isContextMenuVisible,t.isContextMenuVisible&&t.$emit(Ey.J),t.$emit("contextMenu:visibilityUpdate",t.isContextMenuVisible),n=angular.element(window).height(),r=i.height(),o=i.offset().top-angular.element(document).scrollTop()+r,a=i.find(".otkcontextmenu-wrap").height(),s=r+m7,e.isSmall()||o+a>n?(t.top="auto",t.bottom=s):(t.top=s,delete t.bottom)},t.hideContextMenu=function(){t.isContextMenuVisible=!1,t.$emit("contextMenu:visibilityUpdate",t.isContextMenuVisible)};var n=function(e){var i=angular.element(f7);t.isContextMenuVisible&&!i.has(e.target).length&&(t.hideContextMenu(),t.$digest())};angular.element(h7).on("click",n),t.$on("$destroy",function(){angular.element(h7).off("click",n)})},template:p7}}function Du(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";var p=!1,m=!1;e.isLoading=!0,e.buttonType=e.type||GS.primary,e.gdpDescriptionStr=t.getLocalizedStr(e.description,b7,"learnmore"),e.directacquisitionDescriptionStr=t.getLocalizedStr(e.description,"origin-cta-directacquisition","description"),e.originAccessUrl=u.isStandardSubscriber()?a.getHrefFromState(bI._1):a.getHrefFromState(bI._0),e.learnMoreStr=t.getLocalizedStr("",b7,"learnmore"),e.playNow=t.getLocalizedStr("",y7,"play-now");var f=function(t,i){var r=_.get(e.model,DI.K,!1),a=n.isFree(e.model),s=l.isEarlyAccessTrial(e.model),c=l.isBrowserGame(e.model),g=u.userHasActiveSubscription();e.ctaOfferId=t&&t.offerId||e.model.offerId,e.gdpUrl=o.getGdpUrl(e.model,!0),e.couldBeEntitledThroughVault=!r&&!a&&(p||m),e.isGdpCta=r||i||!a&&!s&&!p&&!m,e.isEntitlementCta=!r&&!c&&!i&&(p||m||a&&!s||g&&s),e.isLearnMore=!e.isGdpCta&&!e.isEntitlementCta&&!e.isBrowserGame,e.isLoading=!1,d.digestIfDigestNotInProgress(e)},h=function(t){if(p||m){var i=u.isPremiumSubscriber(),n=g.isPremierVaultGameOrUpgradable(e.model),r=i&&n?_.get(e.model,[DI._16,DI._12],""):_.get(e.model,[DI._34,DI._12],"");s.getCatalogByPath(r,!c.isShellBundle(e.model)).then(function(e){return f(_.head(_.values(e)),t)})}else f({},t)},v=_.debounce(function(){return i.getEditions(e.model).then(function(t){return h(i.ownsGreaterEdition(t,e.model))})},S7,{leading:!0,trailing:!1}),b=function(t){t.offerId&&(e.model=t,p=u.isSubscriberAndVaultGame(t),m=u.isUserSubscriberAndUpgradable(t),l.isBaseGameOfferType(t)&&(p||m)?v():h(!1))};e.$watchOnce("offerId",function(t){return r.getByOfferId(t).attachToScope(e,b)})}function Ru(e,t){"ngInject";return{restrict:"E",scope:{headerText:"@",headerTextSize:"@",content:"@",quote:"@",href:"@",ctaText:"@",contentWidth:"@",textAlignment:"@",useH1Tag:"@"},link:function(i){i.openLink=function(e,i){i.preventDefault(),t.openLink(e)},e.populateScope(i,C7).then(function(){i.hrefAbsoluteUrl=t.getAbsoluteUrl(i.href),i.useH1=i.useH1Tag===w7.true,i.useH2=!i.useH1,i.$digest()})},template:I7}}function $u(e,t,i,n){"ngInject";return{restrict:"A",link:function(r,o,a){function s(){angular.element(o.find("origin-loaderindicator")).remove()}function c(){f&&(m.off("scroll",h),f=!1)}var l=n("<origin-loaderindicator></origin-loaderindicator>")(r),d=r.$eval(a.originLazyload),g=e(a.originLazyloadDisabled),u=a.originLazyloadThrottle||P7,p=a.originLazyloadOffset||0,m=angular.element(a.originLazyloadContainer||t),f=!1,h=i.throttle(function(){var e;!g(r)&&(e=o.offset().top+o.outerHeight()-p,m.scrollTop()+m.innerHeight()>=e)&&(o.append(l),d().then(s).catch(s))},u),v=r.$watch(g(r),function(e){e?c():f||(m.on("scroll",h),f=!0)});r.$on("$destroy",function(){c(),v()})}}}function Nu(e,t){"ngInject";e.notAvailableLoc=t.getLocalizedStr(e.notAvailableStr,E7,"notavailablestr")}function Gu(e,t,i,n,r,o){"ngInject";function a(e){e.stopPropagation()}e.strings={header:t.getLocalizedStr(e.header,L7,"header"),href:t.getLocalizedStr(e.href,L7,"href"),learnmore:t.getLocalizedStr(e.learnmore,L7,"learnmore")},i.insertPriceIntoLocalizedStr(e,e.strings,e.content,L7,"content"),e.$watch("strings.content",function(t,i){t!==i&&(e.infobubbleContent="<strong>"+e.strings.header+"</strong><br>"+e.strings.content+'<br><a href="'+e.strings.href+'" class="otka">'+e.strings.learnmore+"</a>")}),e.onClick=function(t){t&&(t.preventDefault(),t.stopPropagation()),n.userHasSubscription()||r.openLink(e.strings.href)},e.eaplayImagePath=o.getImagePath("access/EAP-condensed.svg"),e.$on("infobubble-show",a),e.$on("infobubble-hide",a)}function Uu(e){"ngInject";this.pricingErrorMessage=e.getLocalizedStr(this.errorMessage,D7,"pricing-error-message")}function Bu(e){"ngInject";return{restrict:"E",scope:{equalContentHeight:"@",titleStr:"@",gradient:"@"},link:function(e){e.equalContentHeight=e.equalContentHeight===OS.true,e.gradient=e.gradient===OS.true,e.$on(Ey.G,function(t){e.isEmpty=!0,t.stopPropagation()})},templateUrl:e.getTemplatePath("store/views/row.html"),transclude:!0,replace:!0}}function Mu(e,t){"ngInject";function i(t){e.isOffline=Origin.client.isEmbeddedBrowser()&&!t.isOnline}function n(t){i(t),e.$digest()}e.$on("$destroy",function(){t.events.off("myauth:clientonlinestatechanged",n)}),t.events.on("myauth:clientonlinestatechanged",n),i({isOnline:t.isClientOnline()})}function ju(e,t,i,n,r){"ngInject";function o(){n.isInThePast(new Date(e.goalDate))&&(clearInterval(e.updateIntervalId),e.$emit("timerReached")),function(){if(e.goalDate){var t=n.getCountdownData(new Date(e.goalDate));t.seconds=a(_.get(t,"seconds",0),2),t.minutes=a(_.get(t,"minutes",0),2),t.hours=a(_.get(t,"hours",0),2),t.days=a(_.get(t,"days",0),2),e.time=t}}()}var a=i("padZeroes"),s=a(0,2);e.time={seconds:s,minutes:s,hours:s,days:s},e.strings={days:r.getLocalizedStr(e.daysStr,H7,"days-str"),hours:r.getLocalizedStr(e.hoursStr,H7,"hours-str"),minutes:r.getLocalizedStr(e.minutesStr,H7,"minutes-str"),seconds:r.getLocalizedStr(e.secondsStr,H7,"seconds-str")},e.isLargeTimer=e.largetimer===OS.true,o(),e.updateIntervalId=setInterval(function(){o(),e.$digest()},1e3),e.$on("$destroy",function(){clearInterval(e.updateIntervalId)})}function Hu(e){"ngInject";return{restrict:"E",scope:!1,template:V7,link:function(t){t.viewAllHref="search?searchString="+t.searchString,t.viewAllHrefAbsoluteUrl=e.getAbsoluteUrl(t.viewAllHref),t.onClick=function(i){i.preventDefault(),e.openLink(t.viewAllHref)}}}}function zu(e,t,i){"ngInject";return{restrict:"E",scope:{gdpPath:"@"},link:function(n,r){n.$watchOnce("gdpPath",function(o){o&&e.getEditionAgnosticModelPromise(new KH(o)).then(function(e){return e?ko(e):Promise.reject(new Error("model-not-found"))}).then(t.updateGameWithLocalizedRatings).then(function(e){if(n.isRatingWithIcons=i.isRatingWithIcons(e.gameRatingType),n.isRatingWithIcons){var t=i.getRatingReasonIcons(e.gameRatingDesc,e.gameRatingType);n.ratingReasonIcons=i.sortRatingDescriptorsIfNecessary(e.gameRatingType,t),n.pegiCustomizedRatingReasons="PEGI"===e.gameRatingType?i.getCustomizedPegiRatingDescriptors(e.gameRatingDesc):[]}i.hasNoRating(e)&&(r[0].parentElement.classList.add("origin-store-no-ratings"),r.remove()),n.esrbDesriptorGroups="ESRB"===e.gameRatingType?i.extractEsrbDescriptorArray(e.gameRatingInteractiveElements,e.gameRatingDesc):[],n.model=e,n.ratingSystemName=i.getLocalizedRatingName(e.gameRatingType),n.showInGamePurchaseWarning=i.isEligibleToShowInGamePurchaseWarning(e.gameRatingType,n.ratingReasonIcons),n.inGamePurchaseWarningMessage=i.extractInGamePurchaseWarningMessage(),n.$digest()}).catch(function(){return n.model=null})})},template:X7}}function Vu(e){"ngInject";e.uniqueKey=_.camelCase(e.text)}function Wu(e){"ngInject";e.uniqueKey=_.camelCase(e.text)}function qu(e,t,i){"ngInject";return{restrict:"E",transclude:!0,scope:{header:"@",titleStr:"@",subtitle:"@",btnText:"@",surveyId:"@"},template:tee,link:function(n,r,o,a,s){function c(e){var i=r.find(nee),o=r.find(ree),a=function(e){var t=[];return _.forEach(e,function(e){t.push(angular.element(e).closest(oee).find(aee).text())}),t}(o);t.sendTelemetry(e,i,o,n.titleStr,a,n.surveyId)}s(n,function(e){var t=void 0,i=function(e){for(var t=e.length,i=void 0,n=void 0;t;)n=Math.floor(Math.random()*t--),i=e[t],e[t]=e[n],e[n]=i;return e}(e.toArray().filter(function(e){return e.tagName!==see||(t=e,!1)}));i.push(t),r.find("ng-transclude").html(angular.element(i))}),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SURVEY_DIALOG,n.surveyId),n.continue=function(){c(i.submitted)},e.populateScope(n,iee).then(_.partial(c,i.received))}}}function Yu(e,t){"ngInject";return{transclude:"element",priority:600,restrict:"A",$$tlb:!0,link:function(i,n,r,o,a){function s(t){t&&e.targetingItemMatches(c)&&a(function(e){e[e.length++]=document.createComment(" end cq-targeting: "+r.originCqTargetingItem+" "),n.after(e)})}var c=e.buildCQTargetingAttributes(r);_.some(c,function(e,i){return t.isAsyncTargetingType(i)})?t.targetingItemMatches(c).then(s).then(function(){i.$emit(Ey.u)}).catch(_.partial(s,!0)):s(!0)}}}function Ku(e,t){"ngInject";var i=["cq-targeting-subscribers","cq-targeting-underage","cq-targeting-loggedin","cq-targeting-emptyshelf"];return{compile:function(e,n){var r=t.buildCQTargetingAttributes(n);_.some(r,function(e,t){return i.indexOf(t)>-1})&&i.forEach(function(t){e.find("["+t+"][origin-cq-targeting-item]").removeAttr(t)}),_.forEach(r,function(t,i){e.find("["+i+"][origin-cq-targeting-item]").attr(i,t)})},priority:800,restrict:"E"}}function Qu(e,t){"ngInject";e.trustAsHtml=function(e){return t.trustAsHtml(e)}}function Ju(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S){"ngInject";function k(e){var t={};return r.populateScope(t,fee,e).then(function(){return _.get(t,"backgroundImage")})}function I(){f.enableBodyScrolling(),vee.name||(vee=e.isLoggedIn?{name:bI.w,params:{}}:{name:bI._6,params:{}}),p.goToState(vee.name,vee.params,{location:"replace"}),vee={}}function w(){I()}function C(e){e&&e.message===b.ALREADY_UNVEILED?I():x()}function T(t){e.giftData=t,e.giftSenderName=_.get(e,["giftData","senderName"],""),e.senderMessage=_.get(e,["giftData","message"],""),e.locStrings.sentByStr=i.getLocalizedStr(!1,hee,"sent-by-str",{"%sender%":e.giftSenderName,"%gametitle%":e.gameTitle}),e.locStrings.newGiftFlashlandingMessageStr=i.getLocalizedStr(!1,hee,"new-gift-flashlanding-message-str"),e.locStrings.senderQuoteStr=i.getLocalizedStr(!1,hee,"sender-quote-str",{"%message%":e.giftData.message}),e.locStrings.gameAddedToLibrary=i.getLocalizedStr(!1,hee,"game-added-to-library-str"),e.locStrings.openNextGift=i.getLocalizedStr(!1,hee,"game-open-next-gift-str"),e.locStrings.giftAccessibleInBaseGame=i.getLocalizedStr(!1,hee,"gift-accessible-in-base-game-str",{"%basegame%":e.baseGameDisplayName}),e.locStrings.dlcRequireBasegameWarning=i.getLocalizedStr(!1,hee,"dlc-require-basegame-warning-str"),e.locStrings.dlcAccessibleDisclaimer=i.getLocalizedStr(!1,hee,"dlc-accessible-disclaimer"),e.locStrings.dlcAccessibleSubscriptionDisclaimer=i.getLocalizedStr(!1,hee,"dlc-accessible-subscription-disclaimer"),e.locStrings.baseGameNotInLibrary=i.getLocalizedStr(!1,hee,"base-game-not-in-library-str"),e.giftGameAddedMessage=e.showBaseGameUnownedWarning?e.locStrings.baseGameNotInLibrary:e.isRepurchasable?e.locStrings.giftAccessibleInBaseGame:e.locStrings.gameAddedToLibrary,e.nextUnopenedGift=g.getNextUnopenedGift(),e.isLoading=!1,e.$digest()}function P(){e.isCtaReady=!0,e.$digest()}function O(e,t,i){var n=_.map(t,"id");_.forEach(i,function(t){n.indexOf(t)>-1&&e.removeOffer(t)})}function E(){var t=h.getWishlist(Origin.user.userPid()),i=t.getOfferList(),n=v.getLowerEditionBaseGameOfferIdsByOffer(e.offerId);return Promise.all([i,n]).then(_.spread(_.partial(O,t)))}function F(){f.disableBodyScrolling(),g.unveilGift(e.offerId).then(T).then(s.refreshGiftEntitlements).then(E).catch(C)}function x(){m.openAlert({id:"origin-unveiling-gift-procurement-error",title:i.getLocalizedStr(e.cantopentitle,hee,"cant-open-title-str"),description:i.getLocalizedStr(e.cantopendescription,hee,"cant-open-description-str"),rejectText:i.getLocalizedStr(e.closestr,hee,"close-str"),callback:w})}function L(e){l.error("Unveiling error getting catalog data: ",e),x()}var A,D,R=(A=regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.giftToOpen=i,t.next=3,u.isBaseGameGift(i);case 3:return e.isBaseGameGift=t.sent,t.next=6,u.getBaseGameFromBundleGift(i);case 6:if(e.baseGameFromBundle=t.sent,e.isBaseGameGift){t.next=14;break}return t.next=10,u.findOwnedBaseGameForNonBaseGameGift(e.giftToOpen);case 10:if(e.ownedBaseGameForNonBaseGameGift=t.sent,!e.ownedBaseGameForNonBaseGameGift){t.next=14;break}return t.next=14,S.loadEntitlementsInfo(e.ownedBaseGameForNonBaseGameGift);case 14:return e.isRepurchasable=_.get(i,DI.O,!1),t.next=17,k(i.offerPath);case 17:e.backgroundImage=t.sent,e.gameTitle=_.get(i,[DI.I,DI.k],""),e.packArt=_.get(i,[DI.I,DI._10],$),e.isActiveSubscriber=y.userHasActiveSubscription(),e.baseGame=e.isBaseGameGift?i:e.baseGameFromBundle?e.baseGameFromBundle:e.ownedBaseGameForNonBaseGameGift,e.showBaseGameUnownedWarning=_.isUndefined(e.baseGame),e.shouldShowDlcStatusCta=!e.isBaseGameGift&&!e.isRepurchasable&&e.ownedBaseGameForNonBaseGameGift,e.ogdOffer=e.baseGameFromBundle?e.baseGameFromBundle:e.shouldShowDlcStatusCta||e.isBaseGameGift?i:e.ownedBaseGameForNonBaseGameGift,e.baseGameDisplayName=_.get(e.ogdOffer,[DI.I,DI.k],""),e.ogdOfferId=_.get(e.ogdOffer,DI._6,_.get(e.ogdOffer,DI.Y));case 27:case"end":return t.stop()}},t,this)}),D=function(){var e=A.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e){return D.apply(this,arguments)}),$=n.getImagePath("packart-placeholder.jpg");e.offerId=decodeURIComponent(p.getStateParams().offerId),e.locStrings={},e.isLoading=!0,e.isMobileView=f.isSmall(),e.isCtaReady=!1,e.numberOfUnopenedGifts=_.size(g.getUnopenedGifts()),e.isEmbeddedBrowser=Origin.client.isEmbeddedBrowser(),e.supportsBlur=o.browserSupports("css-filters")&&!o.browserSupports("ms-accelerator"),e.onAvatarClick=function(e){e&&e.preventDefault()},e.onClickCloseIcon=function(){I()},e.onClickOpenNextGift=function(){var t=g.getNextUnopenedGift();if(t){var i=e.isRepurchasable&&t.offerId===e.offerId;p.goToState(bI.y,{offerId:t.offerId},{location:"replace",reload:i})}},e.getPlayInstallButtonVisibility=function(){return e.isEmbeddedBrowser&&e.ogdOfferId&&e.isCtaReady&&(e.isBaseGameGift||e.ownedBaseGameForNonBaseGameGift&&(!e.isRepurchasable||e.ogdOffer.isInstalled))},e.$on("$destroy",function(){s.events.off("games:baseGameEntitlementsUpdate",P),s.events.off("games:extraContentEntitlementsUpdate",P)}),!1===p.isState(e.fromState.name)&&(vee=Object.assign({},e.fromState)),t.getObserver().attachToScope(e,"states"),d.waitForAuthReady().then(function(t){var n;e.isLoggedIn=t.isLoggedIn,e.isLoggedIn?(s.events.once("games:baseGameEntitlementsUpdate",P),s.events.once("games:extraContentEntitlementsUpdate",P),n=e.offerId,a.getCatalogInfo([n]).then(c.getProperty(n)).then(R).then(F).then(function(e){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ENTITLEMENT_SUCCESS,e)}(n)).catch(L)):(e.locStrings.newGiftFlashlandingLoginStr=i.getLocalizedStr(!1,hee,"new-gift-flashlanding-login-str"),e.isLoading=!1,e.$digest())}).catch(function(t){l.error("Unveiling error getting auth data: ",t),e.isLoggedIn=!1})}function Xu(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e){return'<strong class="otktitle-4-strong">'+e+"</strong>"}var p={unableToJoinText:r.getLocalizedStr(e.joinGameUnableTextStr,See,"joingameunabletext"),notOwnedText:r.getLocalizedStr(e.joinGameNotOwnedTextStr,See,"joingamenotownedtext"),viewInStoreText:r.getLocalizedStr(e.joinGameViewInStoreButtonTextStr,See,"joingameviewinstorebuttontext"),closeText:r.getLocalizedStr(e.joinGameCloseButtonTextStr,See,"joingameclosebuttontext"),notInstalledText:r.getLocalizedStr(e.joinGameNotInstalledTextStr,See,"joingamenotinstalledtext"),downloadText:r.getLocalizedStr(e.joinGameDownloadButtonTextStr,See,"joingamedownloadbuttontext")},m=[];e.joinGameState=Iee,e.presence={},e.messageString=r.getLocalizedStr(e.messageStr,See,"messagecta"),e.watchGameString=r.getLocalizedStr(e.watchGameStr,See,"watchgamecta"),e.joinGameString=r.getLocalizedStr(e.joinGameStr,See,"joingamecta"),e.joinGroupString=r.getLocalizedStr(e.joinGameStr,See,"joingroupcta"),e.joinGameAndGroupString=r.getLocalizedStr(e.joinGameStr,See,"joingameandgroupcta"),e.watchOrJoinGameString=r.getLocalizedStr(e.watchOrJoinGameStr,See,"watchorjoingame",{"%joingame%":"<a href='javascript:void(0)' ng-click='joinGame()' ng-if='presence.isJoinable && !presence.isGroupJoinable' class='otka'>{{::joinGameString}}</a><a href='javascript:void(0)' ng-click='joinGame()' ng-if='!presence.isJoinable && presence.isGroupJoinable' class='otka'>{{joinGroupString}}</a><a href='javascript:void(0)' ng-click='joinGame()' ng-if='presence.isJoinable && presence.isGroupJoinable' class='otka'>{{joinGameAndGroupString}}</a>","%watch%":"<a ng-href='{{presence.broadcastingUrl}}' ng-click='openLink($event, presence.broadcastingUrl)' class='otka'>{{::watchGameString}}</a>"}),e.isPrivate=!kee.test(e.nucleusId),e.privateProfileString=r.getLocalizedStr(e.privateProfileString,See,"privateprofilestring"),e.enableSocialFeatures=n.enableSocialFeatures()&&!e.isPrivate,e.openLink=function(e,t){e.preventDefault(),d.openLink(t)},i.getRosterUser(e.nucleusId).then(function(t){t&&(c.create(t._presence).defaultTo({jid:e.nucleusId,presenceType:"",show:"UNAVAILABLE",gameActivity:{},groupActivity:{},isBroadcasting:!1,isJoinable:!1,isGroupJoinable:!1}).attachToScope(e,"presence"),c.create(t.name).defaultTo({firstName:"",lastName:"",originId:""}).getProperty("originId").attachToScope(e,"originId"))}),e.trustAsHtml=function(e){return t.trustAsHtml(e)},e.getCurrentlyPlayingString=function(t){var i="";return"INGAME"===t.show&&(i=r.getLocalizedStr(e.currentlyPlayingStr,See,"currentlyplaying",{"%game%":u(t.gameActivity.title)})),t.isBroadcasting&&(i=r.getLocalizedStr(e.currentlyBroadcastingStr,See,"currentlybroadcasting",{"%game%":u(t.gameActivity.title)})),i},e.loadProfile=function(){d.goUserProfile(e.nucleusId)},l.getUserProfilePageUrl(e.nucleusId).then(function(t){e.userProfileUrl=t}),e.createMessage=function(){o.openConversation(e.nucleusId)},e.joinGame=function(){s.joinFriendsGame(e.nucleusId,e.presence.gameActivity.productId,e.presence.gameActivity.multiplayerId,e.presence.gameActivity.title,p)},m[m.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSTARTED,function(t){var i=t.NUCLEUS_ID,n=e.nucleusId;i.toString()===n.toString()&&(e.joinGameState=wee,e.$digest())}),m[m.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWSUCCESS,function(t){var i=t.NUCLEUS_ID,n=e.nucleusId;i.toString()===n.toString()&&(e.joinGameState=Cee,e.$digest(),setTimeout(function(){e.joinGameState=Tee,e.$digest()},3e3))}),m[m.length]=Origin.events.on(Origin.events.XMPP_GAMEINVITEFLOWFAILED,function(t){var i=t.NUCLEUS_ID,n=e.nucleusId;i.toString()===n.toString()&&(e.joinGameState=Iee,e.$digest())}),m[m.length]=Origin.events.on(Origin.events.XMPP_LEAVINGPARTY,function(){e.joinGameState=Iee,e.$digest()}),e.$on("$destroy",function(){g.detachAll(m)})}function Zu(e,t){"ngInject";return{restrict:"E",scope:{nucleusId:"@nucleusid",offerId:"@offerid",messageStr:"@messagecta",watchGameStr:"@watchgamecta",joinGameStr:"@joingamecta",joinGroupStr:"@joingroupcta",joinGameAndGroupStr:"@joingameandgroupcta",watchOrJoinGameStr:"@watchorjoingame",currentlyPlayingStr:"@currentlyplaying",currentlyBroadcastingStr:"@currentlybroadcasting",joinGameCloseButtonTextStr:"@joingameclosebuttontext",joinGameDownloadButtonTextStr:"@joingamedownloadbuttontext",joinGameNotInstalledTextStr:"@joingamenotinstalledtext",joinGameUnableTextStr:"@joingameunabletext",joinGameNotOwnedTextStr:"@joingamenotownedtext",joinGameViewInStoreButtonTextStr:"@joingameviewinstorebuttontext",privateProfileString:"@privateProfileString"},controller:Xu,template:yee,link:function(i,n){function r(){i.presence.isBroadcasting&&i.presence.isJoinable&&i.enableSocialFeatures&&t(function(){var t=e(i.watchOrJoinGameString)(i),r=n[0].querySelector(".origin-usercard-ctas");r&&!r.innerHTML&&angular.element(r).append(t),i.$digest()},0,!1)}i.$watch("presence.isBroadcasting",r),i.$watch("presence.isJoinable",r)}}}function ep(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e){r.error("[origin-user-info][getUserInfo]",e)}function p(t){e.originId=t.originId,e.gameActivity=t.presence.gameActivity,Object.keys(t.presence.gameActivity).length&&!!t.presence.gameActivity.title&&(e.isJoinable=t.presence.gameActivity.joinable,e.currentlyPlayingLoc=n.getLocalizedStr(e.currentlyPlayingStr,_ee,"currentlyplaying",{"%game%":"<strong>"+t.presence.gameActivity.title+"</strong>"})),e.$digest()}e.originId="",e.messageLoc=n.getLocalizedStr(e.messageStr,_ee,"messagecta"),e.joinGameLoc=n.getLocalizedStr(e.joinGameStr,_ee,"joingamecta"),e.isJoinable=!1,e.isSocialEnabled=o.enableSocialFeatures(),e.hasValidNucleusId=n.isValidNucleusId(e.nucleusId),e.joinGameStrings={unableToJoinText:n.getLocalizedStr(null,_ee,"join-game-unable-text"),notOwnedText:n.getLocalizedStr(null,_ee,"join-game-not-owned-text"),viewInStoreText:n.getLocalizedStr(null,_ee,"join-game-view-in-store-button-text"),closeText:n.getLocalizedStr(null,_ee,"join-game-close-button-text"),notInstalledText:n.getLocalizedStr(null,_ee,"join-game-not-installed-text"),downloadText:n.getLocalizedStr(null,_ee,"join-game-download-button-text")},e.loadProfile=function(t){t.preventDefault(),d.goUserProfile(e.nucleusId),c.close("web-show-friends-modal")},g.getUserProfilePageUrl(e.nucleusId).then(function(t){e.userProfileUrl=t}),e.closeDialog=function(){c.close("web-show-friends-modal")},e.createMessage=function(){s.openConversation(e.nucleusId),c.close("web-show-friends-modal")},e.joinGame=function(){e.gameActivity&&l.joinFriendsGame(e.nucleusId,e.gameActivity.productId,e.gameActivity.multiplayerId,e.gameActivity.title,e.joinGameStrings),c.close("web-show-friends-modal")},this.getUserInfo=function(){i.getFriendInfo(e.nucleusId).then(p).catch(u)}}function tp(e,t,i,n){"ngInject";function r(t){var i=_.some(t.offerList,{id:e.offerId});i!==e.onWishlist&&(e.onWishlist=i,e.$digest())}e.onWishlistLoc=t.getLocalizedStr(e.onWishlistStr,Eee,"onwishliststr"),e.viewWishlistLoc=t.getLocalizedStr(e.viewWishlistStr,Eee,"viewwishliststr"),e.goWishlist=function(){n.goUserWishlist(Origin.user.userPid())},e.$watch("offerId",function(n){n&&i.getObserver(Origin.user.userPid(),e,t.unwrapPromiseAndCall(r))}),e.$watch("gameName",function(i){e.onWishlistLoc=_.isUndefined(i)?t.getLocalizedStr(e.onWishlistStr,Eee,"onwishliststr"):t.getLocalizedStr(e.gameOnWishlistStr,Eee,"gameonwishliststr").replace("%gamename%",i)})}function ip(e,t,i,n){function r(e,t,i){this.name=e,this.achievements=t,this.id=i||""}function o(e,t){this.personaId=e,this.achievementSetId=t,this.compatibleIds=a(t),this.platform="",this.achievements={},this.baseGame=null,this.expansions={}}function a(e){var t=[],i=e.split("_");do{t.push(i.join("_")),i.pop()}while(i.length>2||i.length>1&&"META"!==i[0]);return t}function s(e){this.personaId=e,this.achievementSets={},this.pendingAchievementSets={},this.hidden=!1}function c(){return n.getCatalogInfo(i.baseEntitlementOfferIdList())}function l(e){var i,n,r,o,s=Origin.utils.os(),c="",l=[],d={};for(var g in e)if(c=(d=t.transform({achievementSet:["platforms",s,"achievementSet"],achievementSetPCWIN:["platforms","PCWIN","achievementSet"]},e[g])).achievementSet,d.achievementSet&&0!==d.achievementSet.length||(c=d.achievementSetPCWIN),c&&c.length>0){for(var u in i=!1,l)if(n=l[u],r=c,o=void 0,o=a(n),-1!==a(r).indexOf(n)||-1!==o.indexOf(r)){i=!0;break}i||l.push(c)}return l}function d(t){if(f.hasOwnProperty(t))return f[t];var i=new s(t),n=i.refresh().then(function(){return delete f[t],m[t]=i,i}).catch(function(i){delete f[t],e.error("[Origin-Achievements-Create-Portfolio] error",i)});return f[t]=n,n}function g(e,t){if(e||(e=Origin.user.personaId()),m.hasOwnProperty(e)){var i=m[e].findAchievementSet(t);if(i&&i.compatibleIds.indexOf(t)>=0)return Promise.resolve(i)}return u(e,t)}function u(e,t){return e||(e=Origin.user.personaId()),m.hasOwnProperty(e)?m[e].refreshAchievementSet(t):d(e).then(function(e){return e.refreshAchievementSet(t)})}var p=new Origin.utils.Communicator,m={},f={};return r.prototype.totalAchievements=function(){return Object.keys(this.achievements).length},r.prototype.grantedAchievements=function(){var e=0;for(var t in this.achievements)this.achievements[t].cnt>0&&e++;return e},r.prototype.totalXp=function(){var e=0;for(var t in this.achievements)e+=this.achievements[t].xp;return e},r.prototype.grantedXp=function(){var e=0;for(var t in this.achievements)this.achievements[t].cnt>0&&(e+=this.achievements[t].xp);return e},r.prototype.totalRp=function(){var e=0;for(var t in this.achievements)e+=this.achievements[t].rp;return e},o.prototype.refresh=function(){return Origin.achievements.userAchievements(this.personaId,this.achievementSetId,Origin.locale.locale()).then(this.onRefreshSucceeded.bind(this)).catch(this.onRefreshFailed.bind(this))},o.prototype.update=function(e){this.platform=e.platform,this.achievements=this.parseAchievements(e);var t=this.sortAchievementsByGame(this.achievements);this.baseGame=new r(e.name,t[""],this.achievementSetId);for(var i=0;i<e.expansions.length;i++){var n=e.expansions[i],o=t.hasOwnProperty(n.id)?t[n.id]:{};this.expansions[n.id]=new r(n.name,o,n.id)}p.fire("achievements:achievementSetUpdated",{personaId:this.personaId,achievementSetId:this.achievementSetId})},o.prototype.onRefreshSucceeded=function(e){return this.update(e),this},o.prototype.onRefreshFailed=function(t){return e.error("AchievementFactory: set refresh failed for "+this.personaId+" : "+this.achievementSetId,t),null},o.prototype.parseAchievements=function(e){var i={};for(var n in e.achievements){var r=e.achievements[n],o={};0===(o=t.pick(["achievedPercentage","cnt","desc","e","icons","howto","img","name","p","rp","rp_t","t","u","xp","xp_t","xpack"])(r)).cnt&&(o.u=-1),o.id=n,o.rindex=n+"_"+o.cnt,i[n]=o}return i},o.prototype.sortAchievementsByGame=function(e){var t={};for(var i in e){var n=e[i],r=n.hasOwnProperty("xpack")?n.xpack.id:"";t.hasOwnProperty(r)||(t[r]={}),t[r][n.id]=n}return t},o.prototype.totalAchievements=function(){return Object.keys(this.achievements).length},o.prototype.grantedAchievements=function(){var e=0;for(var t in this.achievements)this.achievements[t].cnt>0&&e++;return e},o.prototype.totalXp=function(){var e=0;for(var t in this.achievements)e+=this.achievements[t].xp;return e},o.prototype.grantedXp=function(){var e=0;for(var t in this.achievements)this.achievements[t].cnt>0&&(e+=this.achievements[t].xp);return e},o.prototype.totalRp=function(){var e=0;for(var t in this.achievements)e+=this.achievements[t].rp;return e},s.prototype.refresh=function(){return this.personaId===Origin.user.personaId()?i.waitForInitialRefreshCompleted().then(c).then(l).then(this.refreshAchievementSets.bind(this)).catch(this.onRefreshFailed.bind(this)):Origin.achievements.userAchievementSets(this.personaId,Origin.locale.locale()).then(this.onRefreshSucceeded.bind(this)).catch(this.onRefreshFailed.bind(this))},s.prototype.findAchievementSet=function(e){var t=null;for(var i in this.achievementSets)if((t=this.achievementSets[i]).compatibleIds.indexOf(e)>=0)return t;return null},s.prototype.refreshAchievementSet=function(e){var t=this.findAchievementSet(e);if(!t){if(this.pendingAchievementSets.hasOwnProperty(e))return this.pendingAchievementSets[e];var i=(t=new o(this.personaId,e)).refresh().then(this.onAchievementSetCreated.bind(this));return this.pendingAchievementSets[this.personaId]=i,i}return t.refresh()},s.prototype.refreshAchievementSets=function(e){for(var t=[],i=0;i<e.length;i++)t.push(this.refreshAchievementSet(e[i]));return Promise.all(t)},s.prototype.onAchievementSetCreated=function(e){return e&&(delete this.pendingAchievementSets[e.achievementSetId],this.achievementSets[e.achievementSetId]=e),e},s.prototype.onRefreshSucceeded=function(e){var t=[];for(var i in e)0!==i.indexOf("CHALLENGES_")&&0!==i.indexOf("META_")&&t.push(this.refreshAchievementSet(i));return Promise.all(t)},s.prototype.onRefreshFailed=function(t){if(e.log("AchievementFactory: portfolio refresh failed for "+this.personaId+"("+t.status+")"),this.personaId===Origin.user.personaId()||t.status!==Origin.defines.http.ERROR_403_FORBIDDEN)return Promise.reject(t);this.hidden=!0},s.prototype.totalAchievements=function(){var e=0;for(var t in this.achievementSets)e+=this.achievementSets[t].totalAchievements();return e},s.prototype.grantedAchievements=function(){var e=0;for(var t in this.achievementSets)e+=this.achievementSets[t].grantedAchievements();return e},s.prototype.totalXp=function(){var e=0;for(var t in this.achievementSets)e+=this.achievementSets[t].totalXp();return e},s.prototype.grantedXp=function(){var e=0;for(var t in this.achievementSets)e+=this.achievementSets[t].grantedXp();return e},s.prototype.totalRp=function(){var e=0;for(var t in this.achievementSets)e+=this.achievementSets[t].totalRp();return e},Origin.events.on(Origin.events.DIRTYBITS_ACHIEVEMENTS,function(e){m.hasOwnProperty(e.pid)&&m[e.pid].refreshAchievementSet(e.prodid).then(function(e){return function(t){p.fire("achievements:achievementGranted",{personaId:e.pid,achievementSet:t,achievementIndex:e.achid})}}(e))}),{events:p,progress:function(e){return e||(e=Origin.user.personaId()),Origin.achievements.userAchievementPoints(e)},getAchievementPortfolio:function(e,t){e||(e=Origin.user.personaId());var i=[],n=null;if(m.hasOwnProperty(e)||(n=d(e),i.push(n)),t&&t.length>0)for(var r=0;r<t.length;r++)n=g(e,t[r]),i.push(n);return Promise.all(i).then(function(){return m[e]})},getAchievementSet:g,refreshAchievementSet:u,publishedAchievementOffers:function(){return Origin.achievements.achievementSetReleaseInfo(Origin.locale.locale())},determineOwnedAchievementSets:l}}function np(e,t,i,n,r){"ngInject";return r.get("AchievementFactory",ip,this,arguments)}function rp(){return{events:new Origin.utils.Communicator}}function op(e){"ngInject";return e.get("AppCommFactory",rp,this,arguments)}function ap(e){"ngInject";return e.get("CommunicationFactory",rp,this,arguments)}function sp(e,t){function i(t){return Origin.client.isEmbeddedBrowser()?Promise.resolve(!0):g(e.refresh(t)).then(c)}function n(t){return Origin.client.isEmbeddedBrowser()?Promise.resolve(!0):u(e.refresh(t))}function r(e,t){return!!e||Promise.all([i(t),n(t)]).then(s)}function o(e){return Origin.client.isEmbeddedBrowser()?Promise.resolve(!0):Origin.beacon.installable().then(_.partial(r,_,e))}function a(e){return e.indexOf(!0)>-1?d[e.indexOf(!0)]:l.INCOMPATIBLE}var s=t.hasTruth,c=t.toBoolean,l={RUNNING:"running",INSTALLED:"installed",INSTALLABLE:"installable",INCOMPATIBLE:"incompatible"},d=[l.RUNNING,l.INSTALLED,l.INSTALLABLE,l.INCOMPATIBLE],g=e.decorate(function(){return Origin.beacon.installed()},60),u=e.decorate(function(){return Origin.beacon.running()},60);return{isInstalled:i,isRunning:n,isInstallable:o,isInstallableOnPlatform:function(e){return Origin.beacon.installableOnPlatform(e)},getClientVersion:function(t){return Origin.client.isEmbeddedBrowser()&&Origin.client.info&&_.isFunction(Origin.client.info.version)?Promise.resolve(Origin.client.info.version()):g(e.refresh(t))},getState:function(e){return Origin.client.isEmbeddedBrowser()?Promise.resolve(l.RUNNING):Promise.all([n(e),i(e),o(e)]).then(a)},states:l}}function cp(e,t,i){"ngInject";return i.get("BeaconFactory",sp,this,arguments)}function lp(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dp(e,t,i,n,r,o,a,s){"ngInject";function c(){p.handle&&p.handle.close&&(p.type===b.IFRAME?function(){var e=window.document.querySelector("."+zee);e&&e.parentNode.removeChild(e),h&&Origin.client.oig.setIGOSPACloseEnabled(!0)}():p.type===b.WINDOW&&p.handle.close())}function l(){p.handle=void 0,p.type=void 0,clearInterval(m),window.paymentProviderCompleteCallback=void 0}function d(){return new Promise(function(e,t){var i=void 0,n=function n(r){r===Vee&&(t(Vee),window.removeEventListener(Wee,n,!1)),r&&r.origin===v&&r.data===Qee&&(e(),clearTimeout(i),window.removeEventListener(Wee,n,!1))};window.addEventListener(Wee,n,!1),i=setTimeout(function(){return n(Vee)},Kee)})}function g(){var e={loadingTitle:o.getLocalizedStr(!1,Mee,"loading-title"),loadingMessage:o.getLocalizedStr(!1,Mee,"loading-message")};p.handle.postMessage(JSON.stringify(e),v)}var u,p={},m=void 0,f=Promise.resolve(),h=s.isOIGContext(),v=r.getWindowOrigin(),b={WINDOW:"window",IFRAME:"iframe"},y=(lp(u={},n.DEFAULT,{type:n.DEFAULT,windowType:b.WINDOW,modalSize:"lg"}),lp(u,n.THREE_DS,{type:n.THREE_DS,windowType:b.IFRAME,cssClass:"otkmodal-dialog-3ds",scrollbars:"auto",modalSize:"md",iframeSize:{x:"100%",y:"500px"}}),u);return{openPrepare:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",o=y[r]||y[n.DEFAULT],s=o.windowType,c=function(i,n){if(n.windowType===b.WINDOW)p.type=n.windowType,p.handle=window.open(i);else if(n.windowType===b.IFRAME)return p.type=n.windowType,function(i,n){var r=void 0,o=void 0;return a.unblockUI(),h&&Origin.client.oig.setIGOSPACloseEnabled(!1),r=angular.element(t(function(e,t){var i=t.iframeSize,n=t.modalSize,r=t.cssClass,o=t.type,a=t.scrollbars;return"<"+Hee+' \n            iframe-height="'+i.y+'"\n            iframe-width="'+i.x+'"\n            source-url="'+e+'"\n            class="'+zee+" "+r+'"\n            modal-size="'+n+'"\n            scrollbars="'+a+'"\n            type="'+o+'">\n        </'+Hee+">"}(i,n))(e)),angular.element(jee).append(r),new Promise(function(e){window.setTimeout(function(){(o=window.document.querySelector("."+zee+" .origin-iframemodal-content > iframe"))&&e(_.get(o,"contentWindow"))},0)})}(i,n).then(function(e){p.handle=e});return Promise.resolve()}(v+i.checkout.loading,o).then(d).then(g).then(function(){return p.handle});return f=s===b.IFRAME?c:f},close:c,redirect:function(e,t){return window.paymentProviderCompleteCallback=function(e){c(),l(),t(e)},f.then(function(){if(!p.handle)throw qee;p.handle.location.href=e,clearInterval(m),m=setInterval(function(){p.handle&&p.handle.closed&&_.isFunction(window.paymentProviderCompleteCallback)&&(clearInterval(m),window.paymentProviderCompleteCallback())},Yee)})},destroy:l}}function gp(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k,I,w){"ngInject";function C(e,t){Origin.client.isEmbeddedBrowser()&&R&&Origin.client.oig.purchaseComplete(),e===Xee.a.SUBS?v.events.fire(Ey.p,t):R||!i.isState(bI.C)&&!i.isState(bI.d)||i.goToState(bI._5,i.getStateParams()),h.events.fire("games:baseGameEntitlementsUpdate",m.baseGameEntitlements()),h.events.fire("games:extraContentEntitlementsUpdate",m.extraContentEntitlements())}function T(){return u.concat.apply(this,arguments)}function P(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c=void 0;return c={gameId:o.getSetting("gameId")[e],cartName:n.cartName||o.getCartName(),locale:Origin.locale.locale(),currency:a.getCurrency(Origin.locale.countryCode()),virtualCurrency:n.virtualCurrency,countryCode:s||Origin.locale.countryCode(),txnToken:n.txnToken,category:n.category,invoiceSource:n.invoiceSource||function(e){return e===Xee.a.GIFT?o.getSetting(Xee.e).gifting:o.getSetting(Xee.e).default.replace("{platform}",Origin.client.isEmbeddedBrowser()?Xee.b:Xee.c).replace("{countryCode}",Origin.locale.countryCode()).toUpperCase()}(e)},t={"{partnerId}":o.getSetting("partnerId")},i=r.buildConfigUrl("checkout",e,t),e===Xee.a.CHAINED&&(c.offerId=n.offerId),G=c.invoiceSource,r.buildParameterizedUrl(i,c)}function O(){D(),n.unblockUI(),R||($.closeRedirectMessage(),$.close(),U.reject("origin-offline"))}function E(){t.events.off(Ey.b,O)}function F(){B=null}function x(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Promise.all([b.getUserLocationCountryCodeFromEadp(Origin.user.userPid()),I.getInvoiceSourceFromIntCmp()]).then(function(c){var l,d,g=Zee(c,2),u=g[0],p=g[1];return Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:checkoutCart"),Origin.performance.beginTime("COMPONENTSPERF:loadLockBox"),y.destroy(),t.events.on(Ey.b,O),n.invoiceSource=p||n.invoiceSource,i=function(e){return _.isString(e)?e:Xee.a.DEFAULT}(i),n=function(e){return(e=e||{}).txnToken=_.isString(e.txnToken)?e.txnToken:void 0,e.virtualCurrency=_.isString(e.virtualCurrency)?e.virtualCurrency:void 0,e.category=_.isString(e.category)?e.category:void 0,e.invoiceSource=_.isString(e.invoiceSource)?e.invoiceSource:void 0,e.offerId=_.isString(e.offerId)?e.offerId:void 0,e.cartName=_.isString(e.cartName)?e.cartName:void 0,e}(n),a=function(e){return e.checkoutUrlOverride=_.isString(e.checkoutUrlOverride)&&0===e.checkoutUrlOverride.indexOf(o.getUrl("checkout").origin)?e.checkoutUrlOverride:void 0,e}(a),function(e,t){B={type:e,params:Object.assign({},t)}}(i,n),l=a.checkoutUrlOverride||P(i,n,s.checkout.geoipCountryOverrides[u]),d=r.buildConfigUrl("checkout"),U=e.defer(),$.checkout(i,l,d,{params:n,options:a}),U.promise.then(_.partial(m.retrieveEntitlements,!0)).then(f.getCatalogInfo).then(m.doPostRefreshTasks).then(_.partial(C,i,n)).then(E).then(F).catch(function(e){return F(),E(),Promise.reject(e)})})}function L(){return B?x(B.type,B.params):Promise.resolve(!1)}function A(e){return _.get(e,Xee.d.THREE_DS)?Xee.d.THREE_DS:Xee.d.DEFAULT}function D(){y.close(),y.destroy()}var R=o.isOIGContext(),$=R?d:l,N=new Origin.utils.Communicator,G=void 0,U=void 0,B=void 0,M=[];return{close:$.close,openLink:function(e){i.externalUrl(decodeURIComponent(e))},paymentProviderRedirectPrepare:function(){var e=A(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});y.openPrepare(e)},paymentProviderRedirectReady:function(e,t){var i=_.get(t,"uri"),n=r.getWindowOrigin()+s.checkout.paymentProviderRedirect,o=r.buildParameterizedUrl(decodeURIComponent(i),{redirectUri:n}),a=A(t);y.redirect(o,function(t){$.closeRedirectMessage(),t?(B.params.friendReferralToken&&M.push(t),x(e,{invoiceSource:G,txnToken:t}).catch(c.showDialog)):L()},a).then(function(){a===Xee.d.DEFAULT&&$.showRedirectMessage(a)}).catch(function(t){if("nowindow"!==t)throw t;$.showRedirectMessageWithUri(e,i,a)}),R||$.close()},paymentProviderRedirectCancel:D,downloadOrigin:function(){$.close(),i.goToState(bI.O)},downloadGame:function(e){Origin.client.isEmbeddedBrowser()&&(i.goToState(bI.w),$.close()),S.startFlow(e).then(w.getItWithOrigin).catch(S.handleError)},backToGame:function(){$.close()},checkout:x,updateWishlist:function(e,t){if(e!==Xee.a.GIFT){var i=t.receipt.products||[],n=g.getWishlist(Origin.user.userPid()),r=n.getOfferList(),o=function(e){var t=_.map(e,function(e){return p.getLowerEditionBaseGameOfferIdsByOffer(e.offerId)});return Promise.all(t).then(_.spread(T))}(i);Promise.all([r,o]).then(_.spread(function(e,t){var i=_.map(e,"id");_.forEach(t,function(e){i.indexOf(e)>-1&&n.removeOffer(e)})}))}},checkoutUsingBalance:function(t){return Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:checkoutCart"),$.checkoutUsingBalance(t),(U=e.defer()).promise},openCheckoutConfirmation:function(e){$.openCheckoutConfirmation(e)},onPaymentStart:function(){N.fire(Ey.s)},onPaymentSuccess:function(){N.fire(Ey.t),U.resolve()},handleError:function(e){U.reject(e)},sendTrackingEvent:function(e,t,i){i.isFriendReferralEvent=_.get(i,"params.friendReferralToken")&&!_.get(i,"friendReferral.sender")||M.includes(_.get(B,"params.txnToken")),Origin.telemetry.sendLockBoxTrackingEvent(e,t,i)},sendMarketingEvent:function(e){var t=_.assign({isCheckout:!0},e.parameters);Origin.telemetry.sendMarketingEvent(e.category,e.action,e.label,e.value,t,e.pinParameters)},sendTransactionEvent:function(e){var t=e.receipt,i=[],n=t.orderNumber,r=parseFloat(Origin.utils.getProperty(t,["totalPrice"]))||0,o=Origin.utils.getProperty(t,["taxInfo","tax"])||0,a=Origin.utils.getProperty(t,["currency"])||"USD";_.forEach(t.products,function(e){var t=Origin.utils.getProperty(e,["type"])||"Unknown",n=Origin.utils.getProperty(e,["totalPriceWithoutTax"])||0;i.push(new Origin.telemetry.TransactionItem(e.offerId,t,t,e.name,n,t))}),Origin.telemetry.sendTransactionEvent(n,null,a,r,o,i)},setCustomDimension:function(e){Origin.telemetry.setCustomDimension(e.dimension,e.data,{isCheckout:!0})},events:N,reopenCheckout:L,startClient2WebFlow:function(e){Origin.client.isEmbeddedBrowser()&&_.isString(e)&&e.length&&(Object.assign(B,{options:{checkoutUrlOverride:decodeURIComponent(e)}}),k.start(B,$))},onPaymentProcessStart:function(){N.fire(Ey.q)}}}function up(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";function m(){I.fire(a.EXIT),o.goToState(ite)}function f(r,o,s,c){var l=this;return new Promise(function(d,p){var m={locale:Origin.locale.locale(),gameId:i.getSetting("gameId")[r],countryCode:Origin.locale.countryCode()},f=n.buildParameterizedUrl(k,m),h=angular.element(e(function(e,t,i,n,r){return'<origin-redeem-modal source-url="'+e+'" type="'+t+'" origin-url="'+k+'" game-title="'+i+'" art-url="'+n+'" offer-id="'+r+'"></origin-redeem-modal>'}(f,r,o,s,c))(t));angular.element(tte).append(h);var v=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];I.off(a.EXIT,b),I.off(a.ERROR,y),I.off(a.SUCCESS,S),e.apply(l,i)},b=_.partial(v,d),y=function(e){var t={type:r,gameTitle:o,artUrl:s,offerId:c};return Object.assign(t,_.isPlainObject(e)?{error:e}:{error:{message:e}}),Origin.ratt.sendTelemetry(Origin.defines.rattModules.SPA_REDEEM,r.toUpperCase(),Origin.defines.rattProperties.FAILURE,u.userHasSubscription(),t).catch(function(){}),v(p,e)},S=function(){g.setNuxModel(),Origin.ratt.sendTelemetry(Origin.defines.rattModules.SPA_REDEEM,r.toUpperCase(),Origin.defines.rattProperties.SUCCESS,u.userHasSubscription(),{type:r,gameTitle:o,artUrl:s,offerId:c}).catch(function(){})};I.on(a.EXIT,b),I.on(a.ERROR,y),I.on(a.SUCCESS,S)})}function h(){return p.validateCurrentStorefront().then(function(){return f(r.DEFAULT)}).catch(p.handleWrongStorefrontError)}function v(e,t,i){return s.getCatalogInfo([i]).then(function(n){var r=window.location.protocol+"//"+(window.location.host+d.getImagePath("packart-placeholder.jpg")),o=_.get(n,i+".i18n.packArtMedium",r),a=n.hasOwnProperty(i)?i:"";return f(e,t,o,a)})}function b(e,t){return p.validateCurrentStorefront().then(function(){return v(r.RTP,e,t)}).catch(p.handleWrongStorefrontError)}function y(e,t){return p.validateCurrentStorefront().then(function(){return v(r.ITO,e,t)}).catch(p.handleWrongStorefrontError)}function S(){c.detachAll(w)}var k=n.buildConfigUrl("checkout","codeRedemption"),I=new Origin.utils.Communicator,w=[];return{init:function(){w[w.length]=Origin.events.on(Origin.events.CLIENT_GAMES_REDEEMPRODUCTCODEORIGIN,h),w[w.length]=Origin.events.on(Origin.events.CLIENT_GAMES_REDEEMPRODUCTCODERTP,b),w[w.length]=Origin.events.on(Origin.events.CLIENT_GAMES_REDEEMPRODUCTCODEITO,y),l.listenForScopeAndWindowDestroy({},S)},redeemCode:h,openLink:function(e){o.externalUrl(decodeURIComponent(e))},downloadOrigin:function(){I.fire(a.EXIT),o.goToState(nte)},downloadRedemption:function(e){Origin.client.games.startDownload(e),Origin.client.isEmbeddedBrowser()&&m()},continueShopping:m,subscriptionSignup:function(){I.fire(a.EXIT),g.showFullpageNux()},subscriptionAddTime:function(){u.retrieveSubscriptionInfo(!1).finally(function(){I.fire(a.EXIT)})},events:I}}function pp(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function mp(e,t,i){"ngInject";function n(e,t,i,n){var r=!!i;return _.some(_.compact(n),function(i){return t(moment(_.get(i,Ste[e])).toDate())})?r:!r}function r(t,i,r,o,a){switch(t){case yte.offer:return e.getCatalogInfo(i).then(_.partialRight(_.map,So)).then(_.partial(n,r,o,a));case yte.promo:var s=_.map(i,function(e){return Origin.commerce.getPromotionRuleData(e).catch(function(){})});return Promise.all(s).then(_.partial(n,r,o,a));default:return Promise.reject()}}function o(e){var t=!0;return _.forEach(e,function(e){!1===e&&t&&(t=!1)}),t}function a(){return Promise.resolve(!0)}function s(e,t){return _.get(e,t)}var c,l=(pp(c={},gte,function(e){return r(_.get(e,gte),_.compact(_.get(e,ute,"").split(",")),_.get(e,pte),t.isInThePast,!1)}),pp(c,cte,function(e){return r(_.get(e,cte),_.compact(_.get(e,lte,"").split(",")),_.get(e,dte),t.isInThePast,!0)}),pp(c,mte,function(e){var t=parseInt(s(e,mte),bte),n=s(e,vte);return i.isGameSessionsGreaterThan(n,t)}),pp(c,fte,function(e){var t=parseInt(s(e,fte),bte),n=s(e,vte);return i.isBetweenGameSessions(n,t)}),pp(c,hte,function(e){var t=s(e,vte);return i.isGameSessionsEqualsZero(t)}),c);return{isAsyncTargetingType:function(e){return!_.isUndefined(e)&&!_.isUndefined(l[e])},targetingItemMatches:function(e){var t=[];return _.forEach(e,function(i,n){_.isUndefined(l[n])||t.push(l[n](e))}),Promise.all(t).then(o).catch(a)}}}function fp(e,t,i,n,r,o,a,s,c){"ngInject";function l(e,t){return"true"===e.toString().toLowerCase()===t}function d(){return r.hasUsedFreeTrial()}function g(e){return i.ownsOTHEntitlementByPath(e)}function u(e){return n.ownsEntitlementByPath(function(e){var t=e.split("/"),i=t[t.length-1],n=i;return 0===i.indexOf(Tte)?n=i.replace(Tte,Ote):0===i.indexOf(Pte)&&(n=i.replace(Pte,_te)),t[t.length-1]=n,t.join("/")}(e))}function p(e,t){return!(!e&&!t)}function m(e,t){return e&&t}function f(e){return function(t){return!e(t)}}function h(e,t){return e.grantDate-t.grantDate}function v(e,t,i){return function(n){for(var r=t===m,o=n.split(","),a=0;a<o.length;a++)r=t(r,e(o[a]));return i?!r:r}}function b(e,t){return t.indexOf(e)>-1||function(e){return _.startsWith(e,"cq-targeting-ocdpath")}(e)&&!o.isAppLoggedIn()}var y=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(","),t=s.getCurrentState().name,i=s.getHrefFromState(t,c);return i=unescape(unescape(i)),_.some(e,function(e){return"/"===i.charAt(0)&&i.includes(e)||_.get(Cte,e,"")===t})},S=["cq-targeting-attributes-or"],k=["cq-targeting-ocdpath","cq-targeting-ocdpath-and","cq-targeting-ocdpath-or","cq-targeting-ocdpath-onthehouse-and","cq-targeting-ocdpath-onthehouse-or"],I={"cq-targeting-attributes-or":function(e,t){var i=!1;return e?e.split(",").forEach(function(e){var n=_.get(t,e,""),r=_.get(I,e,null);n&&r&&(i=i||r(n))}):i=!0,i},"cq-targeting-showfordayssincegrant":function(t,i){var r=function(e){var t=[];return _.forEach(e,function(e,i){k.indexOf(i)>-1&&_.isString(e)&&(t=t.concat(e.split(",")))}),_.uniq(t)}(i),o=_.compact(_.map(r,n.getEntitlementByPath).sort(h));return!o.length||e.isInTheFuture(e.addDays(o[0].grantDate,Number(t)))},"cq-targeting-subscribers":function(e){switch(e){case wte.true:case wte.false:return function(e){return l(e,r.userHasSubscription())}(e);case wte.loggedInNonSubscriber:return o.isAppLoggedIn()&&!r.userHasSubscription();case wte.usedsubstrial:return d()&&!r.userHasSubscription();case wte.notusedsubstrial:return!d()&&!r.userHasSubscription();case wte.lapsedonce:return r.isExpired()&&!r.isMultipleSubscriber();case wte.lapsedmultiple:return r.isExpired()&&r.isMultipleSubscriber();case wte.activeonce:return r.userHasSubscription()&&!r.isMultipleSubscriber();case wte.activemultiple:return r.userHasSubscription()&&r.isMultipleSubscriber();case wte.recurring:return r.userHasSubscription()&&r.isRecurringSubscriber();case wte.nonrecurring:return r.userHasSubscription()&&!r.isRecurringSubscriber();case wte.subscriberStandard:return r.userHasSubscription()&&r.isStandardSubscriber();case wte.subscriberPremium:return r.userHasSubscription()&&r.isPremiumSubscriber();default:return!0}},"cq-targeting-underage":function(e){return l(e,Origin.user.underAge())},"cq-targeting-loggedin":function(e){return"default"===e.toLowerCase()||l(e,o.isAppLoggedIn())},"cq-targeting-emptyshelf":function(e){return l(e,!Object.keys(n.getAllEntitlements()).length)},"cq-targeting-ocdpath":u,"cq-targeting-ocdpath-and":v(u,m),"cq-targeting-ocdpath-or":v(u,p),"cq-targeting-ocdpath-nand":v(u,m,!0),"cq-targeting-ocdpath-nor":v(u,p,!0),"cq-targeting-ocdpath-not":f(u),"cq-targeting-ocdpath-onthehouse-and":v(g,m),"cq-targeting-ocdpath-onthehouse-or":v(g,p),"cq-targeting-ocdpath-onthehouse-nand":v(g,m,!0),"cq-targeting-ocdpath-onthehouse-nor":v(g,p,!0),"cq-targeting-subscribers-active-less":function(e){return r.userHasSubscription()&&t.isSubscriptionActiveForLessThanNumDays(r.getfirstSignUpDate(),e)},"cq-targeting-subscribers-active-more":function(e){return r.userHasSubscription()&&t.isSubscriptionActiveForAtLeastNumDays(r.getfirstSignUpDate(),e)},"cq-targeting-subscribers-pendingcancel-min-days":function(e){return r.isPendingExpired()&&t.isSubscriptionExpiringInMoreThanDays(r.getExpiration(),e)},"cq-targeting-subscribers-pendingcancel-max-days":function(e){return r.isPendingExpired()&&t.isSubscriptionExpiringInLessThanDays(r.getExpiration(),e)},"cq-targeting-subscribers-canceled-min-days":function(e){return r.isExpired()&&t.isSubscriptionExpiredMoreThanDays(r.getExpiration(),e)},"cq-targeting-subscribers-canceled-max-days":function(e){return r.isExpired()&&t.isSubscriptionExpiredLessThanDays(r.getExpiration(),e)},"cq-targeting-subscribers-date-start":function(e){return r.userHasSubscription()&&t.isSubscriptionActiveSinceStartDate(r.getSubscriptionStartDate(),e)},"cq-targeting-subscribers-date-end":function(e){return r.userHasSubscription()&&t.isSubscriptionActiveSinceEndDate(r.getSubscriptionStartDate(),e)},"cq-targeting-trial":function(e){return l(e,a.isPremierFeatureEnabled())},"cq-targeting-blacklisted-components":f(y),"cq-targeting-whitelisted-components":y};return{targetingItemMatches:function(e){var t=!0,i=[];return e&&(i=function(e){var t=[];return S.forEach(function(i){var n=_.get(e,i,null);_.isString(n)&&(t+=n.split(","))}),t}(e),_.forEach(e,function(n,r){_.isUndefined(n)||null===n||b(r,i)||(t=t&&!!function(e,t,i){var n=I[e];return!n||n(t,i)}(r,n,e))})),t},buildCQTargetingAttributes:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&0===i.indexOf(Ite)&&(t[e.$attr[i]]=e[i]);return t}}}function hp(e){"ngInject";return{numberFormat:function(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,a=void 0===n?",":n,s=void 0===i?".":i,c="";return(c=(o?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(r,o):""+Math.round(r)).split("."))[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a)),(c[1]||"").length<o&&(c[1]=c[1]||"",c[1]+=new Array(o-c[1].length+1).join("0")),c.join(s)},getData:e.decorate(function(){return Origin.games.getPricingFormatter()})}}function vp(){function e(e,t,i,n){if(e&&t){var r=angular.element(e),o=angular.element(document.createElement(t));angular.isObject(i)&&!_.isEmpty(i)&&(_.forEach(i,function(e,t){i[t]=_.escape(i[t])}),o.attr(i)),n&&o.text(n),r.append(o)}}function t(e,t,i){var n=[e,t].join(" ");return _.isEmpty(i)||_.forEach(i,function(e,t){t=_.escape(t),e=_.escape(e),n+='[%name%="%value%"]'.replace("%name%",t).replace("%value%",e)}),n}return{addTag:e,updateTag:function(i,n,r,o){var a=t(i,n,r);angular.element(a).remove(),e(i,n,r,o)},removeTag:function(e,i,n){angular.element(t(e,i,n)).remove()}}}function bp(e){"ngInject";return e.get("OriginDomHelper",vp,this,arguments)}function yp(e,t,i){"ngInject";function n(){t.showStripe(Ate,void 0,Dte,_.partial(t.hideStripe,Ate),r,o,void 0,void 0,"error")}var r=i.getLocalizedStr(void 0,Lte,"generic-error-message"),o=i.getLocalizedStr(void 0,Lte,"generic-error-reason");return e.events.on("errorNotifier:error",n),e.events.on("uiRouter:stateChangeSuccess",function(){t.hideStripe(Ate)}),{showGeneralError:n}}function Sp(e){"ngInject";function t(t){var i,n=null;return Origin.client.isEmbeddedBrowser()&&(t===$te?n=Origin.client.info.isGiftingEnabled():t===Nte&&(n=Origin.client.info.isWishlistEnabled()),null!==n)?n:(i=Origin.locale.threeLetterCountryCode().toUpperCase(),angular.isUndefined(_.get(e,[t,"disabledCountries",i])))}return{isGiftingEnabled:function(){return t($te)},isWishlistEnabled:function(){return t(Nte)},isOriginAccessEnabled:function(){return t(Gte)},isFriendReferralEnabled:function(){return t(Bte)},isPremierFeatureEnabled:function(){return t(Ute)},isMovingGameEnabled:function(){return _.get(e,"movingGame.enabled",!1)},isLocatingGameEnabled:function(){return _.get(e,"locatingGame.enabled",!1)},isSingleMarketEnabled:function(){var t=_.get(e,"digitalSingleMarket.enabledEnv",[]),i=_.get(e,"overrides.env","dev");return i=""===i?"prod":i,-1!==t.indexOf("*")||-1!==t.indexOf(i)}}}function kp(){var e=new Origin.utils.Communicator;return{events:e,updateHiddenGameSessionInfo:function(){sessionStorage.hiddenGameViewed||(sessionStorage.setItem("hiddenGameViewed",!0),e.fire("featureintro:showhidegame"))}}}function Ip(e){"ngInject";return e.get("FeatureIntroFactory",kp,this,arguments)}function wp(e,t,i,n,r,o,a){"ngInject";function s(e){var t=e.data;return d=Promise.resolve(t),t}function c(e){return r.error("[LanguageFactory:getAllLanguages] Could not retrieve all languages",e),{}}function l(){return Origin.locale.locale().toLowerCase().replace("_","-")}var d=void 0;return{getAllLanguages:function(){var i=e.urls.languages;return d||t.get(i).then(s,c)},getDashedLocale:l,setLocale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{reloadApp:!0},r=l();e&&e!==r&&(i.put("locale",e,{path:"/",domain:".origin.com",expires:moment().add(1,"years").toDate()}),!Origin.client.isEmbeddedBrowser()&&t.reloadApp&&window.location.replace(n.buildLocaleUrl(e)))},getPrimaryLocalesByStorefront:function(){var e=Origin.locale.threeLetterCountryCode().toLowerCase();return o[e]||o.default},getCrawlableLocalesByStorefront:function(){var e=Origin.locale.threeLetterCountryCode().toLowerCase();return a[e]||a.default}}}function Cp(){function e(e,t){if(!zte.hasOwnProperty(e))throw new Error("[LocaleFactory] Unknown country code: "+e);return zte[e][t]}function t(e){if(_.isString(e)){var t=e.split("_");if(2===t.length){var i=t[0].toLowerCase()+"_"+t[1].toUpperCase();return Vte[i]||i}}return e}return{getCurrency:function(t){return e(t,"currency")},getRatingSystem:function(t){return e(t,"ratingSystem")},getLanguage:t,getLanguages:function(e){if(_.isArray(e))return _.compact(_.map(e,t))}}}function Tp(e){"ngInject";return e.get("LocaleFactory",Cp,this,arguments)}function Pp(e,t,i,n,r,o){"ngInject";var a={method:"register",gameId:i.getSetting("gameId"),currentHost:r.getWindowOrigin(),eventList:Object.values(vD),platform:Origin.client.isEmbeddedBrowser()?"client":"web"},s={};return s[vD.OPEN_LINK]="uri",s[vD.SIZE_CHANGE]="height",s[vD.ERROR]="code",s[vD.DOWNLOAD_GAME]="offerId",s[vD.CONTINUE_IN_BROWSER]="uri",{createInstance:function(i,r,c){function l(e,t){u.subscribe(e,function(i){i=function(e,t){var i=s[t];return i?e[i]:e}(i,e),t.call(this,i)})}function d(e,t){l(e,t)}var g,u;return g=e.createSender(r),{handshake:function(e,t,i,r){return new Promise(function(s,l){function d(){window.clearTimeout(f),window.clearInterval(h),s()}function p(e){a.clientIsInstalled=e}function m(){f=setTimeout(function(){window.clearInterval(h),l("timeout")},c||qte),h=setInterval(function(){g.sendMessage(a),e!==o.RTP&&e!==o.ITO||g.sendMessage({method:"offerInfo",gameTitle:t,artUrl:i,offerId:r})},Yte),u.subscribe(vD.SUCCESS,d)}var f,h;Origin.client.isEmbeddedBrowser()?(p(!0),m()):n.isInstalled().then(p).then(m)})},destroy:(u=t.createReceiver(i,"method","payload")).destroy,subscribeToEvent:d,subscribeToEvents:function(e){for(var t in e)d(t,e[t])},send:g.sendMessage}}}}function _p(e,t,i,n,r,o,a,s,c){"ngInject";function l(t){t=o.appendOriginQueryParams(t),r.isAbsoluteUrl(t)&&(t=o.getRelativeInternalUrl(t)),e.url(t)}function d(e,t){Origin.client.isEmbeddedBrowser()||t?Origin.windows.externalUrl(e):window.open(e)}function g(e,i){e&&(t.href(e)?t.go(e,i):r.isInternalUrl(e)?l(r.getRelativeUrlInAngularContext(e)):d(e))}function u(e,t,i){n.events.fire("uiRouter:go",e,t,i)}function p(e){return[o.getWindowOrigin(),_.map(e,function(e){return _.trim(e,"/")}).join("/")].join("/")}function m(e,t,i){a.encode(e).then(function(e){angular.isUndefined(t)?u("app.profile.user",{id:e.id,fromFriendRecommendationTile:i}):u("app.profile.user.topic",{id:e.id,topic:t})}).catch(function(){u("app.error_notfound")})}return{goSettingsPage:function(e){u("app.settings.page",{page:e})},internalUrl:l,openLink:g,goToState:u,getAbsoluteUrl:function(e,i){var n="";if(e)if(t.href(e))n=p([t.href(e,i)]);else if(r.isAbsoluteUrl(e))n=e;else{var o=r.getBaseHref(),a=e;"/"!==o&&(a=e.replace(o,"")),n=p(_.compact([_.trim(o,"/"),_.trim(a,"/")]))}return n},getHrefFromState:function(e,i,n){return t.href(e,i,n)},goOgdAchievements:function(e){u("app.game_gamelibrary_wrapper.library.ogd.topic",{offerid:e,topic:"achievements"})},goUserProfile:m,openSteamGameDetailsPage:function(e){var t=c.getUrl("steam");g(_.get(t,"gameDetailsPageUrl","").replace("{AppId}",e))},openSteamSubscriptionPage:function(){var e=c.getUrl("steam");g(e&&e.subscriptionLandingPageUrl)},goUserWishlist:function(e){String(e)===String(Origin.user.userPid())?u("app.profile.topic",{topic:"wishlist"}):m(e,"wishlist")},goUserAchievementDetails:function(e,t){angular.isUndefined(t.id)||a.encode(t.id).then(function(i){t.id=i.id,u(e,t)})},openIGOSPA:function(e,t){"PROFILE"===e?a.encode(t).then(function(t){Origin.client.oig.openIGOSPA(e,t.id)}).catch(function(){u("app.error_notfound")}):Origin.client.oig.openIGOSPA(e,t)},goHome:function(){g("/")},asyncOpenUrl:function(e){Origin.client.isEmbeddedBrowser()?Origin.client.desktopServices.asyncOpenUrl(e):window.open(e)},externalUrl:d,externalUrlInPopupWindow:function(e,t,i){var n="width="+(t||Kte)+", height="+(i||Kte);c.isOIGContext()&&(e=function(e){var t=-1===e.indexOf("?")?"?":"&",i=e.split("#"),n=2===i.length?"#"+i[1]:"";return""+i[0]+t+"oigwinpos=centered"+n}(e)),window.open(e,"",n)},asyncOpenUrlWithEADPSSO:function(e){Origin.client.isEmbeddedBrowser()?Origin.client.desktopServices.asyncOpenUrlWithEADPSSO(e):window.open(e)},isState:function(e){return t.is(e)},getCurrentState:function(){return t.current},getStateParams:function(){return i},reload:function(){return t.reload()},changeHash:function(t){return e.hash(t)},openWindowToPathWithEADPSSO:function(e,t){if(Origin.client.isEmbeddedBrowser()){var i=window.location.protocol+"//"+window.location.hostname+e,n=s.urls.redirectWithEADPSSO.replace("{redirectUri}",i);Origin.client.desktopServices.asyncOpenUrlWithEADPSSO(n)}else{var r=window.open(e);t&&(r.opener=null)}},showOriginHelp:function(){Origin.client.isEmbeddedBrowser()?Origin.client.navigation.showOriginHelp():d(c.getHelpUrl(Origin.locale.locale(),Origin.locale.languageCode()))}}}function Op(e){return{encode:e.decorate(Origin.obfuscate.encode,Qte),decode:e.decorate(Origin.obfuscate.decode,Qte)}}function Ep(e,t){"ngInject";return t.get("NucleusIdObfuscateFactory",Op,this,arguments)}function Fp(e,t,i,n,r){"ngInject";function o(e,t){return t&&i.targetingItemMatches(e)}function a(t){var i=e.getProperty("origin-cq-targeting-item")(t);return _.isUndefined(i)?Promise.resolve(!0):function(e){return _.some(e,function(e,t){return n.isAsyncTargetingType(t)})}(t)?n.targetingItemMatches(t).then(function(e){return o(t,e)}):Promise.resolve(o(t,!0))}function s(e,i){return function(n){var r,o=["gamehub","components","items"];_.isArray(i)&&(o=i),r=c(o)(n);var s=_.map(r,function(i){return _.isObject(i)&&i.hasOwnProperty(e)?a(i[e]).then(function(e){return e?function(e){var i=_.first(_.values(e)),n=_.get(i,Zte);if(n&&n===iie){var r=_.get(i,eie),o=_.get(i,tie);return t.inExperiment(r,o).then(function(t){return t?e:null})}return Promise.resolve(e)}(i):null}).catch(function(){return null}):Promise.resolve(null)});return Promise.all(s).then(_.compact)}}var c=e.getProperty,l=r.buildTag;return{buildTag:l,slingDataToDom:function e(t,i){var n;return i||(i=document.createDocumentFragment()),_.forEach(t,function(t,r){i=i.appendChild(l(r,_.omit(t,"items"))),n=_.get(t,"items"),_.isArray(n)&&_.forEach(n,function(t){e(t,i)})}),i},findDirectives:s,coalesceChildDirectives:function(e,t,i){return function(n){function r(e){o=o.concat(e)}var o=[];return s(e,i)(n).then(function(i){for(var n=[],a=0;a<i.length;a++)n.push(s(t,[a,e,"items"])(i).then(r));return Promise.all(n).then(function(){return o})})}},flattenDirectives:function(e){function t(t){if(t&&t.hasOwnProperty(e))return t[e]}function i(e){return!!_.isObject(e)}return function(e){return _.isArray(e)?e.map(t).filter(i):[]}},wrapDocumentForCompile:function(e,t){var i,n=document.createDocumentFragment();try{return(i=n.appendChild(l("div",{class:t||Xte}))).appendChild(e),i}catch(e){return n}},findComponentAttr:function(e,t,i){var n=_.get(e,"gamehub.components.items");if(_.isArray(n)){var r=n.find(function(e){return _.isObject(e)&&e.hasOwnProperty(t)});return _.get(r,[t,i],_.get(r,[t],null))}return null}}}function xp(e,t,i,n,r,o,a,s,c,l,d){function g(){$=_.cloneDeep(e.getAllEntitlements())}function u(e){return _.values(e)[0]}function p(e){return!F.data.hasOwnProperty(e)}function m(e,i){return i?e&&!_.isEmpty(e)?t.transformOffer(e).then(u).then(_.curry(f)(i)):f(i,h()):h()}function f(e,t){var i=e.gamehub;return i&&(t.siblings=i.siblings,t.children=i.children),t}function h(){return{error:UI.p}}function v(e,t){var i=[];_.forEach(e,function(e){var n=_.get(t,e);F.data[e]=n,i.push(_.get(n,"offerId"))}),F.commit(),N(i)}function b(e,t){F.data[e]=t,F.commit(),N([_.get(t,"offerId")])}function y(e,t){var i=a.create(F),n=x(e);return t||(n=function(e){return _.filter(e,function(e){return!F.data.hasOwnProperty(e)})}(n)),n.length>0&&C(e,t),i.getProperty(e).defaultTo({})}function S(e,n){var r;n||(e=x(_.filter(e,p))),e.length>0&&(r=e,_.forEach(r,function(e){F.data[e]||(F.data[e]={})}),i.getCatalogInfo(e).then(t.transformOffer).then(_.curry(v)(e)))}function k(e){return _.pick(F.data,x(e))}function I(e,t){return _.forEach(e,function(e){L[e]&&delete L[e]}),t}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(o){!t&&L.hasOwnProperty(o)?e.push(L[o]):!t&&F.data.hasOwnProperty(o)||(L[o]=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.all([i.getCatalogByPath(e,!t),r.getOcdByPath(e)]).then(_.spread(m)).catch(h)}(o,n).then(_.partial(b,o)),e.push(L[o]))}}function C(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=x(e),r=[];return _.forEach(n,w(r,t,i)),Promise.all(r).then(_.partial(k,e)).then(_.partial(I,n))}function T(e){var t=[],i=[];return _.forEach(e,function(e,n){e.offerId===n?i.push(n):t.push(n)}),{offerIds:i,ocdPaths:t}}function P(){var e=T(F.data);E(e.offerIds,e.ocdPaths),g()}function O(t){var i,n,r=(i=e.getAllEntitlements(),n=s.getObjectDifferences(i,$),Object.values(n).map(function(e){return _.first(e).masterTitleId}));_.forEach(F.data,function(e){var t=_.get(e,"alternateMasterTitleIds",[]);r.indexOf(e.masterTitleId)>-1&&!_.isEmpty(t)&&r.concat(t)}),r=_.uniq(r);var o=_.map(F.data,function(e){if(r.indexOf(e.masterTitleId)>-1||_.size(_.intersection(e.alternateMasterTitleIds,r))>0)return _.get(e,t)});return _.uniq(_.compact(o))}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_.isEmpty(e)||S(e,!0),_.isEmpty(t)||y(t,!0)}var F=o.observe({}),x=s.toArray,L={},A=new Origin.utils.Communicator,D=[],R=void 0,$=void 0,N=function(e){D=_.compact(_.uniq(_.concat(D,e))),clearTimeout(R),_.isEmpty(D)||(R=setTimeout(function(){A.fire("OCD:updateCollection",D),D=[]},100))};g();var G=_.debounce(function(){E(O("offerId"),O("ocdPath")),g()},rie),U=_.debounce(function(){var e=T(_.pickBy(F.data,function(e){return e.pricingError}));E(e.offerIds,e.ocdPaths)},rie);return c.events.on("myauth:change",P),l.events.on(b$.b,P),n.events.on("games:extraContentEntitlementsUpdate",G),n.events.on("games:baseGameEntitlementsUpdate",G),d.events.on("GamesPricingFactory:pricingServiceIsOnline",U),{getByOcdPath:y,getByOfferId:function(e){var t=a.create(F);return S(x(e)),_.isString(e)?t.getProperty(e).defaultTo({}):t.pick(e)},getByOcdPathPromise:C,events:A}}function Lp(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";return g.get("OcdPathFactory",xp,this,arguments)}function Ap(e,t,i){"ngInject";return{close:function(){Origin.client.isEmbeddedBrowser()&&(Origin.client.oig.closeIGOSPA(),Origin.client.oig.closeIGO())},openCheckoutConfirmation:function(e){i.go(cie,{offerIds:e})},checkout:function(i,n,r,o){var a=t.$new(!0);a.telemetryData=o;var s='<origin-iframe id="lockbox-iframe"  telemetry-data="telemetryData" type="'+i+'" source-url="'+n+'" origin-url="'+r+'"></origin-iframe>',c=angular.element(e(s)(a)),l=angular.element(aie);l.length||(l=angular.element(sie)),l.children().css("display","none"),l.append(c),t.$digest()},checkoutUsingBalance:function(i){var n='<origin-dialog-content-checkoutusingbalance offerid="'+i+'"></origin-dialog-content-checkoutusingbalance>',r=angular.element(e(n)(t)),o=angular.element(aie);o.empty(),o.append(r)},showRedirectMessage:function(i){var n=angular.element(e("<"+lie+' redirect-message-type="'+i+'"></'+lie+">")(t)),r=angular.element(aie);r.empty(),r.append(n)},showRedirectMessageWithUri:function(i,n,r){var o="<"+lie+' continue-to-payment-provider="true" type="'+i+'" redirect-uri="'+n+'" redirect-message-type="'+r+'"></'+lie+">",a=angular.element(e(o)(t)),s=angular.element(aie);s.empty(),s.append(a)},closeRedirectMessage:function(){angular.element(aie).empty()}}}function Dp(e,t){"ngInject";return{createReceiver:function(i,n,r){function o(t){return function(i){if(function(e){return(e.origin||e.originalEvent.origin)===l}(i)){var o=i.data;if(!angular.isObject(o))try{o=JSON.parse(i.data)}catch(t){return void e.error("Iframe postmessage data is un-parseable. Not able to fire event. Data: "+o.toString(),t)}t.fire(o[n],o[r])}}}var a,s=new Origin.utils.Communicator,c=!1,l=t.extractHostnameUrl(i);return{subscribe:function(e,t){c||(function(e){a=o(e),window.addEventListener("message",a,!1)}(s),c=!0),s.on(e,t)},unsubscribe:function(e,t){s.off(e,t)},destroy:function(){angular.isDefined(a)&&window.removeEventListener("message",a)}}}}}function Rp(e,t,i,n,r,o,a){"ngInject";function s(e){e.id?i.goToState(h[e.id],_.omit(e,["id"])):o.error("ERROR:[NavigationFactory] route change from client must have an id property")}function c(i){i.productId&&t.waitForGamesDataReady().then(e.getCatalogInfo([i.productId]).then(function(e){r.goToPdp(e[i.productId])}))}function l(e,o){n.isNonOriginGame(e)?i.goToState("app.game_gamelibrary_wrapper.library.ogd",{offerid:e}):t.getBaseGameEntitlementByMasterTitleId(o[e].masterTitleId).then(function(t){t?i.goToState("app.game_gamelibrary_wrapper.library.ogd",{offerid:t.offerId}):r.goToPdp(o[e])})}function d(t){e.getCatalogInfo([t]).then(_.partial(l,t)).catch(function(){o.error("Failed to get Catalog Info")})}function g(t){e.getCatalogInfo([t]).then(function(e){r.goToPdp(e[t])}).catch(function(){o.error("Failed to get Catalog Info")})}function u(e,t){t?i.goToState("app.game_gamelibrary_wrapper.library.ogd",{offerid:t.offerId}):g(e)}function p(n){t.waitForGamesDataReady().then(e.getGdpPathByMasterTitleId(n.masterTitleId).then(function(e){if(e){var t=e.split("/"),n={franchise:t[1],game:t[2]};i.goToState(bI._5,n)}else i.goToState(bI.B)}))}function m(e){o.error("ERROR:[ProductNavigationFactory]",e.message)}function f(){a.detachAll(v),window.removeEventListener("unload",f)}var h={"route:home":"app.home","route:store":"app.store.wrapper.home","route:vault":"app.store.wrapper.origin-access-vault","route:settings":"app.settings","route:settings.page":"app.settings.page","route:mygames":"app.game_gamelibrary_wrapper.library","route:profile":"app.profile","route:achievements":"app.profile","route:wishlist":"app.profile.topic","route:build-a-bundle":"app.store.wrapper.buildabundle"},v=[];return{goToStoreByProductId:c,goToStoreByMasterTitleId:p,goProductDetails:d,goProductDetailsWithMultiplayerId:function(e,i){t.getBaseGameEntitlementByMultiplayerId(i).then(_.partial(u,e)).catch(_.partial(g,e))},init:function(){Origin.client.isEmbeddedBrowser()&&(v=[Origin.events.on(Origin.events.CLIENT_NAV_ROUTECHANGE,s),Origin.events.on(Origin.events.CLIENT_NAV_STOREBYPRODUCTID,c),Origin.events.on(Origin.events.CLIENT_NAV_STOREBYMASTERTITLEID,p),Origin.events.on(Origin.events.CLIENT_NAV_OPEN_GAME_DETAILS,d)],window.addEventListener("unload",f),Origin.client.info.sendProductNavigationInitialized().catch(m))}}}function $p(){function e(e){a[e]||(a[e]=[],s[e]=[])}function t(e){return a[e]&&a[e].length>0}function i(e){return s[e].length>0}function n(e){return a[e]}function r(e){if(t(e)){var i=[].concat(n(e));return a[e]=[],i}}function o(e,t){return function(){!function(e,t){_.remove(s[e],function(e){return t.id===e.id})}(e,t)}}var a={},s={},c=0;return{enqueue:function(r,o){e(r),n(r).push(o),function(e){if(i(e)){var r=function(e){if(t(e))return n(e).shift()}(e);_.forEach(s[e],function(e){e.callback(r)})}}(r)},followQueue:function(t,i){e(t);var n={id:c++,callback:i};return s[t].push(n),function(e,t){var i=r(e),n=t.callback;_.forEach(i,function(e){n(e)})}(t,n),o(t,n)},add:function(t,i){e(t),n(t).push(i)},flushQueue:function(e){!function(e,t){i(e)&&_.forEach(s[e],function(e){e.callback(t)})}(e,r(e))},onFlushQueue:function(t,i){e(t);var n={id:c++,callback:i};return s[t].push(n),o(t,n)},length:function(e){return n(e).length}}}function Np(e){"ngInject";return e.get("QueueFactory",$p,this,arguments)}function Gp(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Up(e,t,i,n,r){function o(e,t,n){var r=e===NU?n||qU:"";i.updateTag(BU,e,t,r),p.push({element:e,attrs:t,text:n})}function a(){var e=n.getCrawlableLocalesByStorefront(),t=n.getDashedLocale();return e.indexOf(t)>-1}function s(e){i.updateTag(BU,UU,{name:fie,content:e})}function c(){var t=!1;return e.noIndexNoFollow.forEach(function(e){-1!==window.location.href.indexOf(e)&&(t=!0)}),t}function l(){a()&&!c()&&i.removeTag(BU,UU,{name:fie})}function d(e){var t=_.trimEnd(location.protocol+"//"+location.hostname+location.pathname,"/"),i=_.trimStart(location.search,"?");if(e||(t=t.toLowerCase()),r.isState(bI.N)&&i.length>1){var n=i.split("&").filter(function(e){return-1!==e.indexOf("fq=")});1===n.length&&-1===n[0].indexOf(",")&&(t=t+"?"+n[0])}else r.isState(bI.A)?t+="/store":(-1!==t.indexOf(hie)||r.isState(bI._1))&&(t=t.replace(/(.*?origin.com\/[a-z]{3}\/[a-z]{2}-[a-z]{2}).*$/gm,"$1/store/ea-play"));return t}function g(e,t){var i,n=_.startsWith(e,"og:")?"property":"name";o(UU,(Gp(i={},n,e),Gp(i,"content",t),i))}var u,p=[],m=(Gp(u={},NU,i.updateTag),Gp(u,UU,i.removeTag),u);return t.$on("$locationChangeSuccess",function(){_.forEach(p,function(e){var t=e.element===NU?qU:"",i=m[e.element];i&&i(BU,e.element,e.attrs,t)}),p.length=0,l()}),t.$on("$stateChangeSuccess",function(){a()&&!c()||s(mie)}),{setSeoData:o,setRobotsRule:s,unsetRobotsRule:l,getCanonicalUrl:d,getCanonicalLinkIfApplicable:function(e){if(!(angular.element(UU+"[name=robots][content*='noindex'][content*='nofollow']").length>0))return d(e)},setSeoMetaValue:g,setSocialMediaTags:function(e,t){_.forEach(e,function(e,i){e&&g(t+":"+i,e)})}}}function Bp(e,t,i,n,r,o){"ngInject";return o.get("OriginSeoFactory",Up,this,arguments)}function Mp(e,t,i,n){"ngInject";function r(e){window.removeEventListener("focus",o),setTimeout(function(){a&&i.openDirective({id:Sie,name:Sie,size:kie,data:{"redirect-message-type":e}})},Iie+1)}var o,a=!0;return{close:function(){n.events.fire("checkout:close")},openCheckoutConfirmation:function(e){i.openDirective({contentDirective:"origin-dialog-content-checkoutconfirmation",id:"checkout-confirmation",name:"origin-dialog-content-checkoutconfirmation",size:_I,data:{id:"checkout-confirmation",offers:e}})},checkout:function(i,n,r,o){var a=t.$new(!0);a.telemetryData=o;var s=angular.element(e('<origin-iframe-modal telemetry-data="telemetryData" type="'+i+'" source-url="'+n+'" origin-url="'+r+'"></origin-iframe-modal>')(a));angular.element(yie).append(s)},checkoutUsingBalance:function(e){i.openDirective({id:wie,name:"origin-dialog-content-checkoutusingbalance",size:_I,data:{offerId:e,dialogId:wie}})},showRedirectMessage:function(e){o=_.partial(r,e),window.addEventListener("focus",o)},showRedirectMessageWithUri:function(e,t,n){i.openDirective({id:Sie,name:Sie,size:kie,data:{"continue-to-payment-provider":!0,type:e,"redirect-uri":t,"redirect-message-type":n}})},closeRedirectMessage:function(){window.removeEventListener("focus",o),a=!1,i.close(Sie)}}}function jp(e,t,i){var n;return{initialize:function(t){(function(e){return!!e&&!!e.template&&!!e.cqPath})(t)&&(n=t,e.openDirective({id:_ie,name:"origin-dialog-content-templateloader",size:"medium",data:{template:n.template,modal:_ie,params:{cqPath:_.get(n,"cqPath")}}}))},sendTelemetry:function(r,o,a,s,c,l){var d,g,u,p=(d={type:_.get(n,"type"),status:r},u=[],(g=Eie)in d?Object.defineProperty(d,g,{value:u,enumerable:!0,configurable:!0,writable:!0}):d[g]=u,d);o&&!_.isEmpty(o)&&p[Eie].push(t.buildSurveyResponseObject("checkbox",s,o)),a&&!_.isEmpty(a)&&_.forEach(a,t.buildOpenTelemetryObjects(p,c)),p[Oie]=_.snakeCase(l),p[Tie]=t.getSurveyStatus(p),_.isEmpty(p[Eie])||Origin.telemetry.sendStandardPinEvent(Origin.telemetry.trackerTypes.TRACKER_MARKETING,"survey",Origin.client.isEmbeddedBrowser()?"client":"web","success",p),function(t){t===i.submitted&&(e.close(_ie),_.isFunction(n.callback)&&n.callback(),n=void 0)}(r)}}}function Hp(e,t,i,n){"ngInject";return n.get("SurveyFactory",jp,this,arguments)}function zp(e){function t(e){return[xie,_.kebabCase(e)].join("_")}return{dismissTakeover:function(i){var n=t(i);e.set(n,!0)},isTakeoverDismissed:function(i){var n=t(i);return e.get(n,!1)}}}function Vp(e,t){"ngInject";return t.get("OriginTakeoverHelper",zp,this,arguments)}function Wp(e,t,i,n,r){function o(e){return!!e&&e.trim()!==t}function a(e){return r.error("handleAppVersionError",e),!1}function s(){var e,t;d||!i.isClientOnline()||g||(e="https://"+window.location.host+"/version.txt",t={atype:"GET",headers:[],parameters:[],appendparams:[],reqauth:!1,requser:!1},t.timeout=c,t.noconvert=!0,Origin.dataManager.enQueue(e,t).then(o).catch(a)).then(function(e){(d=e)&&l.fire("showNewSPAAvailable")})}var c=3e4,l=new Origin.utils.Communicator,d=!1,g=!1;return n.events.on("games:finishedPlaying",function(){g=!1,s()}),n.events.on("games:startedPlaying",function(){g=!0}),setInterval(s,36e5),{events:l}}function qp(e,t,i,n,r,o){"ngInject";return o.get("UpdateAppFactory",Wp,this,arguments)}function Yp(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Kp(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(){i.isAppLoggedIn()?r.redeemCode().catch(o.showDialog):a.openDirective({id:l.ID,name:l.ID,data:{},size:_I})}function p(){a.openDirective({id:g.id,name:"origin-dialog-content-templateloader",size:_I,data:{template:g.template,modal:g.id}})}function m(){var t=e.search();_.intersection(Object.keys(t),Object.keys(y)).forEach(function(i){!function(t,i){y[t](i),e.search(t,null)}(i,t[i])})}var f,h,v,b=(h=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getSuspendedBasicSubscription();case 2:(t=e.sent)&&!t.cancellation?a.openDirective({id:fI,name:hI,size:_I,data:{"last-offer-id":t.offerId}}):a.openDirective({id:d.id,name:"origin-dialog-content-access-cancel",size:_I,data:{}});case 4:case"end":return e.stop()}},e,this)}),v=function(){var e=h.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return v.apply(this,arguments)}),y=(Yp(f={},Dee,function(){i.waitForAuthReady().then(u)}),Yp(f,Lee,function(){c.isGiftingEnabled()&&a.open({id:Die,size:_I,directives:[{name:"origin-dialog-content-featureintro-gifting",data:{"dialog-id":Die}}]})}),Yp(f,Aee,b),Yp(f,Ree,p),Yp(f,$ee,function(){s.waitForSubscriptionReady().then(function(){s.userHasActiveSubscription()&&!s.isBuddy()&&a.openDirective({id:pI,name:mI,size:_I,data:{}})})}),Yp(f,Ree,p),Yp(f,Nee,function(e){setTimeout(function(){var t=void 0;try{t=JSON.parse(e)}catch(e){return}i.waitForAuthReady().then(function(){n.checkout(t)})},500)}),f);return{watchForRouteChanges:function(){t.events.on(Ey.P,m)}}}function Qp(e,t){function i(t,i,n,r){var o=n.$new(!0);Object.assign(o,r);var a=e(t)(o);return i.append(a),o}return{appendBundleGameDrawer:function(e,t,n){return i(Gie,e,t,n)},appendSoftBundleGameDrawer:function(e,t,n){return i(Nie,e,t,n)},scrollToOpenDrawer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.isElementOffScreen(document.getElementById(Rie))&&t.scrollTo(Rie,e,$ie)}}}function Jp(e,t,i,n,r,o,a,s,c,l){function d(e){Origin&&Origin.user&&(y.userid=String(Origin.user.userPid()||""),y.user_status=e&&e.isLoggedIn?Bie:Mie)}function g(e){e.isLoggedIn?(y.user_status=Bie,y.userid=""):(y.user_status=Mie,d())}function u(e,t,i){var n,o,a,s;n=_.isFunction(t)?t(e):String(r.getProperty(t)(e)),w.indexOf(i)>-1?(s=n,(o=y)[a=i]=r.wrapInArray(o[a]),o[a].push(s)):function(e,t,i){i=i||"",-1===P?e[t]=i:0===P?(e[t]=[e[t]],e[t].push(i)):angular.isArray(e[t])&&e[t].push(i)}(y,i,n)}function p(e){_.forEach(C,function(t,i){u(e,t,i)})}function m(e){_.forEach(C,function(t,i){!function(e,t){var i=y[e];angular.isArray(i)&&t<i.length&&(i.splice(t,1),P--,1===i.length&&(y[e]=i.pop()||""))}(i,e)})}function f(){_.forEach(C,function(e,t){_.isString(I[t])?y[t]=I[t]:y[t]=_.clone(I[t])}),P=-1,T={}}function h(e){if(!(T[e]&&T[e]>=0)){var t=function(e){return i.getCatalogInfo([e])}(e),r=function(e){return n.getPrice(e)}(e);return Promise.all([t,r]).then(_.spread(function(t,i){var n,r,o=t[e];i&&angular.isArray(i)&&i.length>0&&i[0]&&(n=i[0].rating),angular.isArray(n)&&n.length>0&&n[0]&&(r=n[0]||{}),p(t=_.extend(o,r)),T[e]=++P}))}}function v(e){return e=r.wrapInArray(e),_.map(e,h)}function b(){if(l.hasConsentedToAds()){var e=document.createEvent("Events");e.initEvent("uTagDataLayerReady",!0,!0),document.dispatchEvent(e)}}var y,S=Origin.locale.countryCode(),k=e.getCurrency(S),I={region:"",locale:Origin.locale.locale(),country:Origin.locale.countryCode().toLowerCase(),language:Origin.locale.locale().split("_",1)[0]||"",userid:"",user_status:"",referring_site:"",mvt_experiment:"",mvt_variation:"",intcmp:"",transaction_id:"",order_date:"",payment_type:"",product_id:[],product_sku:[],product_name:[],product_price:[],total_price:"",total_tax:"",total_shipping:"",currency:k,product_quantity:"",promo_code:"",product_discount:"",promotion_applied:"",product_category:"",product_facets:"",ecommerce_platform:"Origin",platform:"",studio:"",game_name:"",franchise_unit:"",mdm_franchise:"",mdm_master_title:"",mdm_master_title_id:"",unlocalized_title:"",unlocalized_franchise:""},w=["product_id","product_sku","product_name","product_price"],C={product_id:"offerId",product_sku:"offerId",product_name:["i18n","displayName"],game_name:["i18n","displayName"],product_price:"originalUnitPrice",product_category:"offerType",franchise_unit:"franchiseFacetKey",mdm_franchise:"franchiseFacetKey",mdm_master_title:"masterTitle",mdm_master_title_id:"masterTitleId",platform:"platformFacetKey",studio:"developerFacetKey",product_facets:function(e){return _.compact([e.platformFacetKey,e.franchiseFacetKey,e.gameEditionTypeFacetKey,e.numberOfPlayersFacetKey,e.genreFacetKey,e.publisherFacetKey,e.developerFacetKey])}},T={},P=-1;return{init:function(){window.hasOwnProperty("utag_data")?y=window.utag_data:window.utag_data=y={},_.extend(y,I),o.events.on(Ey.P,function(e,t){if(-1===zie.indexOf(t.name)&&f(),Hie.indexOf(t.name)>-1){var n=a.buildPathFromUrl();n&&i.getOfferIdByPath(n).then(function(e){var t=v(e);Promise.all(t).then(b)})}else if(jie.includes(t.name)){var r=s.buildPathFromUrl();c.getCatalogModelPromise(r,{skipErrorHandling:!0}).then(function(e){return c.processEditionAgnosticModel(r,e)}).then(function(e){p(e),T[e.offerId]=++P,b()})}else b()}),t.events.on("myauth:ready",d),t.events.on("myauth:change",g)},addNewCatalogData:v,removeCatalogData:function(e){var t=T[e];t&&t>0?m(t):f()},unsetCatalogInfo:f}}function Xp(e,t,i,n,r,o,a,s,c,l,d){"ngInject";return d.get("UTagDataModelFactory",Jp,this,arguments)}function Zp(e,t,i,n,r){"ngInject";function o(e){p&&(clearTimeout(p),p=setTimeout(function(){return e()},Kie))}function a(){p&&(clearTimeout(p),p=void 0)}function s(i){var n={"{appId}":l,"{genomeId}":d,"{locale}":Yie[Origin.locale.locale()]||Origin.locale.locale(),"{nextPageUrl}":e.getWindowOrigin()+t.urls.ubisoft.returnToOriginPageUrl};return r.replaceAll(i,n)}function c(e,t,n){a();var r=String(n.status).toUpperCase();r===qie.OK?e(n.payload):r===qie.ERROR&&t(i.AUTH_FAILED),t(r)}var l=t.urls.ubisoft.appId,d=t.urls.ubisoft.genomeId,g=!1,u=null,p=void 0;return{initUplay:function(){return new Promise(function(e,r){var s;(s=[{url:t.urls.ubisoft.uplayScript,id:Wie,libraryObject:"Connect"}],n.loadScripts(s)).then(function(){g?e():(o(r),window.Connect.init({env:"PROD",appId:l,genomeId:d}),window.Connect.sdk.subscribe(function(t){u=t,g=!0,e()}))}).catch(function(){a(),r(i.API_NOT_INITIALIZED)})})},getTicket:function(){return new Promise(function(e,t){g?(o(t),u.getTicket().subscribe(_.partial(c,e,t))):t(i.API_NOT_INITIALIZED)})},getProfile:function(e){return new Promise(function(t,n){g?e?(o(n),u.getProfiles(e.ticket,e.sessionId,e.userId).subscribe(_.partial(c,t,n))):n(i.NO_TICKET):n(i.API_NOT_INITIALIZED)})},getLoginUrl:function(){return s(t.urls.ubisoft.linkAccountUrl)},logout:function(e){return new Promise(function(t){g?(o(t),u.logout(e.ticket,e.sessionId).subscribe(_.partial(c,t,t))):t()})},getProfileImageUrl:function(e){var i={"{appId}":l,"{userId}":e};return r.replaceAll(t.urls.ubisoft.ubisoftAvatar,i)},getCreateAccountUrl:function(){return s(t.urls.ubisoft.createAccountUrl)}}}function em(e,t,i,n,r,o){"ngInject";function a(e){r.openDirective({id:Qie,name:Qie,size:_I,data:{"redirect-uri":e}})}function s(){clearTimeout(c),o.events.off(Jie,s)}var c=null;return{start:function(t,r){var l=function(e){var t,r,o,a=window.location.href,s=n.buildParameterizedUrl(a,(t={},r=Nee,o=JSON.stringify(e),r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t));return i.getUrl("redirectWithEADPSSO").replace("{redirectUri}",encodeURIComponent(s))}(t);e.asyncOpenUrlWithEADPSSO(l),clearTimeout(c),o.events.on(Jie,s),c=setTimeout(function(){o.events.off(Jie,s),r.close(),a(l)},Xie)},openClient2WebDialog:a,closeClient2WebDialog:function(){r.close(Qie)}}}function tm(e,t,i){"ngInject";return{checkout:function(n){var r=n.type,o=void 0===r?i.DEFAULT:r,a=n.params,s=void 0===a?{}:a,c=n.options;c.checkoutUrlOverride&&(s.cartName=s.cartName||t.getSetting("cartNameClient"),e.checkout(o,s,c))}}}function im(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function nm(e,t,i,n,r,o,a){"ngInject";function s(){var e=l();return e.length?i.getUserLocationCountryCode().then(function(t){return-1!==e.indexOf(t.toLowerCase())}):Promise.resolve(!1)}function c(){return i.getUserLocationCountryCode().then(function(e){return e.toLowerCase()})}function l(){if(!o.isSingleMarketEnabled())return[];var t=e.digitalSingleMarket;return t&&_.isArray(t.countries)?t.countries:[]}function d(e){return new Promise(function(i){t.open({id:T_,size:OI,blocking:e===k_,directives:[{name:C_,data:{"context-namespace":e}}],callback:function(e){var t=e.accepted,n=e.content;return i({accepted:t,result:n})}})})}function g(){return d(k_)}function u(){return new Promise(function(e){t.open({id:y_,size:OI,directives:[{name:b_,data:{}}],callback:function(t){var i=t.accepted,n=t.content;return e({accepted:i,result:n})}})})}function p(e){var i=e.homeCountryCode,r=e.country,o=n.getLocalizedStr(null,LI,i)||i.toUpperCase(),a=n.getLocalizedStr(null,LI,r)||r.toUpperCase();return new Promise(function(e){t.open({id:A_,size:OI,blocking:!0,directives:[{name:L_,data:{"home-country":o,country:a}}],callback:function(t){var i=t.accepted,n=t.content;return e({accepted:i,result:n})}})})}function m(e){var i=n.getLocalizedStr(null,LI,e)||e.toUpperCase();return new Promise(function(e){t.open({id:E_,size:OI,blocking:!0,directives:[{name:O_,data:{country:i}}],callback:function(t){var i=t.accepted,n=t.content;return e({accepted:i,result:n})}})})}function f(){return i.getHomeStorefrontCountryCode().then(function(t){var i=_.findKey(e.twoLetterCountryToStorefrontMap,function(e){return e===t});return a.getCountryInfo(i)})}function h(){return a.getCountryInfo(y())}function v(){return b().then(function(e){return!e})}function b(){var e=Origin.locale.threeLetterCountryCode().toLowerCase();return i.getHomeStorefrontCountryCode().then(function(t){return e===t})}function y(){var e=r.get(),t=e.storefront,i=e.country;return i&&t&&t===Origin.locale.threeLetterCountryCode().toLowerCase()?i:Origin.locale.countryCode().toLowerCase()}var S,k;return{openGeoPreferencesDialog:function(){return d(C_)},openGeoIntroductionDialog:g,openGeoBlockDialog:u,isUserInSingleMarketCountry:s,getCountryCodeList:l,getCountryTranslations:function(){return l().map(function(e){return{countryCode:e,countryName:n.getLocalizedStr(null,LI,e)||e.toUpperCase()}}).sort(function(e,t){var i=e.countryName,r=t.countryName;return n.sortAlphabetic(i,r)})},getGeoIpCountryCode:c,getGeoIpCountryInfo:function(){return c().then(function(e){return a.getCountryInfo(e)})},getStorefrontFromCountryCode:function(e){return a.getStorefrontFromCountryCode(e)},getCurrentStorefrontCountry:y,getPreferredStorefrontCountry:(S=im(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=r.get().country)){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,c();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)})),function(){return S.apply(this,arguments)}),getHomeStorefrontInfo:f,getCurrentStorefrontInfo:h,isUserOutsideHomeStorefront:v,isUserInsideHomeStorefront:b,validateCurrentStorefront:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return o.isSingleMarketEnabled()?Promise.all([v(),s()]).then(function(t){var i=tne(t,2),n=i[0],r=i[1];if(n&&r)throw UI.a;return e}):Promise.resolve(e)},handleWrongStorefrontError:function(e){if(e!==UI.a)throw e;u()},startIntroductionIfNeeded:(k=im(regeneratorRuntime.mark(function e(){var t,i,n,a,l,d,u,v,b,y,S;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isSingleMarketEnabled()){e.next=38;break}return e.next=3,s();case 3:if(!e.sent){e.next=38;break}if(t=r.get(),t.storefront){e.next=38;break}return e.next=9,g();case 9:if(i=e.sent,n=i.result,a=n.storefront,l=n.languageLocale,d=n.country,!(a&&l&&d)){e.next=38;break}return e.next=17,c();case 17:if(u=e.sent,d===u){e.next=28;break}return e.next=21,p({homeCountryCode:u,country:d});case 21:if(v=e.sent,!v.accepted){e.next=28;break}return e.next=26,m(d);case 26:return r.setAndGoTo({storefront:a,languageLocale:l,country:d}),e.abrupt("return",!0);case 28:return e.next=30,m(u);case 30:return e.next=32,f();case 32:return b=e.sent,y=b.storefrontCode,S=h(),r.set({storefront:y,languageLocale:l,country:u}),S.storefrontCode!==y&&r.goTo(),e.abrupt("return",!0);case 38:return e.abrupt("return",!1);case 39:case"end":return e.stop()}},e,this)})),function(){return k.apply(this,arguments)})}}function rm(e,t){"ngInject";function i(e){e=e.toLowerCase();var i=t.getLocalizedStr(null,ine,e)||"",o=n(e);return{countryCode:e,storefrontCode:o,localizedCountryName:i,localizedStorefrontName:t.getLocalizedStr(null,ine,r(o))||""}}function n(t){return e.twoLetterCountryToStorefrontMap[t]||nne}function r(e){return _.findKey(one,function(t){return t===e})||rne}return{getStorefrontFromCountryCode:n,getTwoLetterCodeFromThreeCode:r,getCountryInfo:i,getCountriesInfo:function(e){return e.map(i).sort(function(e,i){var n=e.localizedCountryName,r=i.localizedCountryName;return t.sortAlphabetic(n,r)})}}}function om(e,t,i,n,r){function o(e){return Array.isArray(e)?e:[e]}function a(e){for(var t=Object.keys(e),i=Object.keys(h),n=_.difference(t,i),r=[];n.length;)r.push(n.splice(0,5).join(","));return{cached:i,request:r}}function s(e){i.error("[CommonGamesFactory:handleRetrieveFromServerError]",e)}function c(e){var t=[],i=e.request,n=e.cached;return i.forEach(function(e){t.push(Origin.atom.atomCommonGames(e).catch(s))}),n.forEach(function(e){var i;t.push((i=e,new Promise(function(e){e(h[i])})))}),Promise.all(t)}function l(e){var t={};return e.forEach(function(e){var i,n,r;e.games&&(e.games.game=o(e.games.game),_.merge(t,(i=e.games.game,n=e.userId,r={},i.forEach(function(e){var t=e.masterTitleId,i=e.multiPlayerId||m;r[t]=r[t]||{},r[t][i]=r[t][i]||{},r[t][i][n]=!0}),r)))}),t}function d(e){return e.forEach(function(e){h[e.userId]={users:{user:[e]}}}),e}function g(e){var t=[];return e.forEach(function(e){e&&e.users&&(e.users.user=o(e.users.user),t=t.concat(e.users.user))}),t}function u(e){return function(t){(t.length!==e.data.users.length||_.difference(t,e.data.users).length>0)&&(e.data={users:t},e.commit())}}function p(i){return e.getRoster("FRIENDS").then(a).then(c).then(g).then(d).then(l).then(function(e){return function(i){return t.getCatalogInfo([e]).then(function(t){var n=_.get(t,[e,"platforms",Origin.utils.os(),"multiPlayerId"])||m,r=t[e].masterTitleId;return r&&i[r]&&i[r][n]?Object.keys(i[r][n]):[]})}}(i)).catch(s)}var m="SinglePlayerId",f=r.create(e.getRosterStatusWatch()),h={},v={};return{getUsersWhoOwn:p,getUsersWhoOwnObservable:function(e,t){return _.isUndefined(v[e])&&(v[e]=n.observe({users:[]})),f.onUpdate(t,function(e){return function(){h={},p(e).then(u(v[e])).catch(s)}}(e)),p(e).then(u(v[e])).catch(s),v[e]}}}function am(e,t,i,n,r,o){"ngInject";return o.get("CommonGamesFactory",om,this,arguments)}function sm(e,t,i,n,r,o,a,s,c,l,d,g){function u(e){o.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd",{offerid:e})}function p(){n.openPrompt({id:"store-you-need-origin-incompatible",title:i.getLocalizedStr(null,sne,"incompatibleplatformtitle"),description:i.getLocalizedStr(null,sne,"incompatibleplatformdesc"),rejectText:i.getLocalizedStr(null,sne,"continuebrowsing")})}function m(e,t,n){return{label:i.getLocalizedStr(null,sne,e),clickAction:t,telemetryCssClass:n,phaseDisplay:null}}function f(e){var t;return e.label?e.label===l.GET_IT_WITH_ORIGIN_CTA_INCOMPATIBLE?t=m(l.GET_IT_WITH_ORIGIN_CTA,p):((t=m(e.label,e.callback,e.telemetryCssClass)).disabled=!e.enabled,e.label===l.PRIMARY_PHASE_DISPLAY_CTA&&(t.phaseDisplay=e.phaseDisplay)):t=m(l.DETAILS_CTA,_.partial(u,e.offerId)),t}function h(e){return r.error("[GAMESENTITLEMENTFACTORY:baseGameEntitlements]",e),null}function v(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null;return i=i||!1,!d.initialStateReceived()&&g.ownsEntitlement(e)?(r=m("retrievinggamestate",null),Promise.resolve(r)):t.primaryAction(e,i,n).then(f).catch(h)}var b={},y={};return{getButtonState:v,getButtonStateObservable:function(t,i,n){function r(){v(t,i).then(function(e){angular.merge(o.data,e),o.commit()})}var o=c.observe({});return _.isUndefined(b[t])?(o=c.observe({}),b[t]=o,y[t]=[e.events.on("games:releaseStateUpdate:"+t,r),e.events.on("games:update:"+t,r),e.events.on("games:downloadqueueupdate:"+t,r),e.events.on("games:progressupdate:"+t,r),e.events.once("games:initialClientStateReceived",r),a.events.on("myauth:clientonlinestatechanged",r)],n.$on("$destroy",function(){s.detachAll(y[t]),delete b[t]}),r()):o=b[t],o}}}function cm(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";return u.get("GameCTAFactory",sm,this,arguments)}function lm(e,t,i,n,r,o,a){function s(e){return 0===e.indexOf(M)}function c(e,t,i){if(!_.isUndefined(t)){var n=t.split(L),r=_.findIndex(n,s);r>=0&&n.splice(r,1),i&&n.push(i),Origin.client.settings.writeSetting(e,n.join(L))}}function l(e){var t;if(!_.isUndefined(e)){var i=e.split(L),n=_.findIndex(i,s);n>=0&&(t=i[n].slice(M.length+1))}return t}function d(e){var t;l(G)!==e.commandLineText&&(e.commandLineText.length&&(t=M+A+e.commandLineText),c(E,G,t))}function g(e){var t=i.getGame(M,e),n=t&&t.cloudSaves;return n&&angular.merge(T.data,{usagePercent:t.cloudSaves.currentUsage/t.cloudSaves.maximumUsage*100+"%",usageDisplay:t.cloudSaves.usageDisplay,lastBackupValid:t.cloudSaves.lastBackupValid,lastBackupDate:t.cloudSaves.lastBackupDate}),n}function u(e){if(Object.keys(e).length){var t=e[M];T.data.gameTitle=t.i18n.displayName,T.data.gameManualUrl=t.i18n.gameManualURL}return e}function p(e){T.data.cloudSavesSupported=angular.isDefined(e.cloudSaves),T.data.installed=e.installed}function m(e){if(!Object.keys(e).length){var t=r.getCatalogInfo([M]);Object.keys(t).length&&(T.data.isNOG=!0,T.data.gameTitle=t[M].i18n.displayName)}return e}function f(e){$=e,T.data.enableOig=l(e)!==D}function h(e){G=e,T.data.commandLineText=l(e)}function v(e){N=e}function b(e){e&&e.multilaunch&&e.multilaunch.length>1&&(_.set(T,["data","multiLaunchOptions"],e.multilaunch),e.selection?_.set(T,["data","selectedLaunchOption"],e.selection):_.set(T,["data","selectedLaunchOption"],l(N)),T.data.selectedLaunchOption||_.set(T,["data","selectedLaunchOption"],e.default?e.default:e.multilaunch[0]))}function y(e){T.data.locales=e.locales,T.data.selectedLocale=e.locales[e.currentindex],e.locales.length&&(U=T.data.selectedLocale.id)}function S(e){B=e,T.data.cloudSavesEnabled=e}function k(e){T.data.nogExecutablePath=e.executePath}function I(e){if(Object.keys(e).length){var t=e[M],i=o.getEntitlement(M);if(T.data.grantDate=i.grantDate,T.data.cdKey=i.cdKey,!i.cdKey&&t.forcePartnerEntitlementPending&&t.forcePartnerEntitlementPending.indexOf(R)>-1)return function(e){return Origin.games.getCDKey(e.entitlementId).then(function(e){return e&&e.value})}(i).then(function(e){i.cdKey=e,T.data.cdKey=e})}return Promise.resolve()}function w(e){P.data.isOnline=!!e&&e.isOnline,P.commit()}var C="origin-dialog-content-gameproperties-id",T=e.observe({gameTitle:"",cloudSavesEnabled:!1,cloudSavesSupported:!1,cdKey:"",grantDate:null,gameManualUrl:"",enableOig:!0,commandLineText:"",selectedLaunchOption:"",multiLaunchOptions:[],locales:[],selectedLocale:{id:-1},usagePercent:0,usageDisplay:"",lastBackupValid:!0,installed:!1,isNOG:!1,nogExecutablePath:""}),P=e.observe({isOnline:!1}),O="OigDisabledGames",E="GameCommandLineArguments",F="MultiLaunchProductIdsAndTitles",x="cloud_saves_enabled",L="#//",A="_",D="t",R="UBISOFT",$="",N="",G="",U=-1,B=!1,M="",j="";return a.events.on("myauth:clientonlinestatechangeinitiated",w),w({isOnline:a.isClientOnline()}),{openGameProperties:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};M=e,j=r.externalType,T.data={gameTitle:"",cloudSavesEnabled:!1,cloudSavesSupported:!1,cdKey:"",grantDate:null,gameManualUrl:"",enableOig:!0,commandLineText:"",selectedLaunchOption:"",multiLaunchOptions:[],locales:[],selectedLocale:{id:-1},usagePercent:0,usageDisplay:"",lastBackupValid:!0,installed:!1,isNOG:!1,nogExecutablePath:""},Promise.all([i.getGamePromise(e,r.externalType).then(p),n.getCatalogInfo([e]).then(u).then(m).then(I),Origin.client.settings.readSetting(O).then(f),Origin.client.settings.readSetting(x).then(S),Origin.client.settings.readSetting(F).then(v).then(Origin.client.games.getMultiLaunchOptions(e,{externalType:r.externalType}).then(b)),Origin.client.games.getAvailableLocales(e,{externalType:r.externalType}).then(y),Origin.client.games.getNOGExecutablePath(e,{externalType:r.externalType}).then(k),Origin.client.settings.readSetting(E).then(h),Origin.client.games.pollCurrentCloudUsage(e,{externalType:r.externalType}),g(r.externalType)]).then(function(){T.commit(),t.openDirective({id:C,name:"origin-dialog-content-gameproperties",size:"large",data:{offerId:e}})})},saveGamePropertiesGeneral:function(e){var t,i;t=e,l($)!==D!==t.enableOig&&(t.enableOig||(i=M+A+D),c(O,$,i)),T.data.isNOG&&(function(e){""!==e.gameTitle&&e.gameTitle.length&&Origin.client.games.updateNOGGameTitle(M,e.gameTitle)}(e),d(e))},saveGamePropertiesCloudSaves:function(e){B!==e.cloudSavesEnabled&&Origin.client.settings.writeSetting(x,e.cloudSavesEnabled)},saveGamePropertiesAdvanced:function(e){var t,i,n;t=e,n=l(N),T.data.multiLaunchOptions.length&&n!==t.selectedLaunchOption&&(t.selectedLaunchOption.length&&(i=M+A+t.selectedLaunchOption),Origin.client.games.updateMultiLaunchOptions(M,t.selectedLaunchOption,j).then(function(e){"done"!==e.success&&c(F,N,i)})),d(e),function(e){e.selectedLocale&&U!==e.selectedLocale.id&&Origin.client.games.updateInstalledLocale(M,e.selectedLocale.id,j)}(e)},updateCloudData:g,closeDialog:function(){t.close(C)},getGamePropertiesObservable:function(){return T},getClientPropertiesObservable:function(){return P}}}function dm(e,t,i,n,r,o,a,s){"ngInject";return s.get("GamePropertiesFactory",lm,this,arguments)}function gm(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h){function v(e){return Promise.all([n.isInstalled(),n.isInstallable()]).then(_.spread(function(e){return function(t,i){return D=t,R=i,e}}(e)))}function b(e){return o.isTrialAwaitingActivation(e.offerId).then(function(e){return function(t){return e.isAwaitingTrialActivation=t,e}}(e))}function y(e){return o.isTrialExpired(e.offerId).then(function(e){return function(t){return e.isTrialExpired=t,e}}(e))}function S(e){return m.isUpgradeableVaultGameEarlyAccess(e.offerId).then(function(t){return function(e,t){return e.isVaultGameInEarlyAccessUpgradable=t,e}(e,t)})}function k(e){return!!e&&e.cloudSaves&&e.cloudSaves.syncOperation}function I(e,t,i){var n=_.find(e,{label:t})||{};_.isEmpty(n)||(n.visible=!0,n.enabled=i)}function w(e,t,i,n,r){var o=!0,a="pause"+n+"cta",s="resume"+n+"cta",c="cancel"+n+"cta",l=n+"nowcta",d=i.queueIndex,g="",u=h.isEntitlementDownloadCompleted(t.progressInfo);t.progressInfo&&(g=t.progressInfo.phase,0===d&&("PAUSED"===g||"PAUSING"===g?I(e,s,t.resumable):I(e,a,t.pausable&&!u)),o=t.cancellable&&!u),r&&d>0&&I(e,l,i.queueSkippingEnabled),I(e,c,o)}function C(e,t,i,n){t.updating?(w(e,t,i,"update","updatecta"),I(e,"uninstall",!1)):t.downloading?"PRELOAD"===t.releaseStatus?w(e,t,i,"preload","preloadcta"):w(e,t,i,"download","downloadcta"):t.installing?(w(e,t,i,"install"),t.repairSupported&&I(e,"repaircta",!1)):t.repairing?(w(e,t,i,"repair","repairnowcta"),I(e,"uninstallcta",!1)):t.downloadable&&n.isOwned?"PRELOAD"===t.releaseStatus?I(e,"preloadcta",t.downloadable&&Origin.client.onlineStatus.isOnline()):I(e,"startdownloadcta",t.downloadable&&Origin.client.onlineStatus.isOnline()):t.installed?function(e,t){if(t.updateSupported){var i=!t.playing&&!k(t);null!==t.availableUpdateVersion?I(e,"updategamecta",i):I(e,"checkforupdatecta",i)}t.repairSupported&&I(e,"repaircta",!t.playing&&!k(t))}(e,t):t.installable&&(I(e,"installcta"),t.repairSupported&&I(e,"repaircta",Origin.client.onlineStatus.isOnline())),function(e,t,i){"true"===f.isLocatingGameEnabled()&&!t.playable&&T(t,i)&&I(e,dne,t.downloadable&&Origin.client.onlineStatus.isOnline())}(e,t,i),function(e,t,i){"true"===f.isMovingGameEnabled()&&t.playable&&T(t,i)&&I(e,gne,t.playable&&Origin.client.onlineStatus.isOnline())}(e,t,i)}function T(e,t){return e.isDip&&!e.isManagedExternally&&-1===t.queueIndex&&Origin.utils.os()===DI._13}function P(t,i,n){var o=t.clientActions,c=t.queueInfo,l=t.catalogInfo,d=t.ownsGame,g=t.isAwaitingTrialActivation;o&&!o.isWrongArchitecture&&(function(e,t,i,n){t.inTrash?I(e,"restorecta",!0):t.playable&&!k(t)?I(e,E(n),!t.playing):a.isBaseGameOriginDisplayType(i)&&t.installed&&!k(t)&&I(e,E(n),!1)}(i,o,l,g),k(o)&&I(i,"cancelcloudsynccta",o.clientActions.cloudSaves.syncOperation.cancellable),!function(e){return"ExternalURL"===Origin.utils.getProperty(e,[DI._15,Origin.utils.os(),DI._9])}(l)&&Origin.client.isEmbeddedBrowser()&&I(i,"gamepropertiescta",!o.playing),C(i,o,c,l)),function(t,i,n){var r=!1;(e.isNonOriginGame(i.offerId)||n&&a.isBaseGameOriginDisplayType(i))&&(r=!0),r&&I(t,"showgamedetailscta",!0)}(i,l,d),a.isBaseGameOriginDisplayType(l)&&function(t,i,n,r){e.isFavorite(i,{externalType:r})?I(t,"removeasfavoritecta",Origin.client.onlineStatus.isOnline()):I(t,"addasfavoritecta",Origin.client.onlineStatus.isOnline()),e.isNonOriginGame(i)&&!n.playing?I(t,"removefromlibrarycta",!0):u.isSubscriptionEntitlement(i)&&(Origin.client.onlineStatus.isOnline()&&!n.installed&&I(t,"removefromlibrarycta",!0),p.userHasSubscription()||I(t,"resubscribecta",!0)),e.isHidden(i,{externalType:r})?I(t,"unhidecta",Origin.client.onlineStatus.isOnline()):I(t,"hidecta",Origin.client.onlineStatus.isOnline()),Origin.client.settings.developerToolAvailable()&&I(t,"openinodtcta",!0)}(i,t.offerId,o,n),o.uninstallable&&I(i,"uninstallcta",!o.playing);var f,h,v=m.isUpgradeableVaultGame(l.offerId).then(function(e){e&&I(i,ZO,Origin.client.onlineStatus.isOnline())}),b=_.head(s.determineOwnedAchievementSets(((h={})[(f=l).offerId]=f,h))),y=b?s.getAchievementSet(N,b).then(function(e){_.get(e,"achievements")&&I(i,"viewachievementscta",!0)}).catch(function(e){r.log("GAMESCONTEXTFACTORY: unable to retrieve achievement set",e)}):Promise.resolve();return Promise.all([v,y])}function O(e){$=[];for(var t=0;t<e.length;t++){var i=e[t];if(i.visible){if(i.divider&&$[$.length-1]&&$[$.length-1].divider)continue;$.push(i)}}return $}function E(e){return e?l.START_TRIAL_CTA:l.PLAY_CTA}function F(e,t){if(e&&e.progressInfo&&!0===e.progressInfo.active)switch(e.progressInfo.phase){case"INITIALIZING":case"PREPARING":case"FINALIZING":case"INSTALLING":return!0;case"ENQUEUED":case"PAUSED":return t.parentInQueue;default:return!1}return!1}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var r,o={},s=n.clientActions,c=n.queueInfo,u=n.catalogInfo,p=n.catalogInfo.isOwned,m=n.isAwaitingTrialActivation,f=n.isVaultGameInEarlyAccessUpgradable,h="",v={},b=!0,y=!1,S=Origin.utils.getProperty(u,["countries","isPurchasable"]),k=Origin.utils.getProperty(u,["platforms",Origin.utils.os(),"useEndDate"]),I=new Date(Origin.datetime.getTrustedClock()),w=i.primaryActionsList(n.offerId,{externalType:t.overrideExternalType||t.externalType}),C=Origin.utils.getProperty(u,["platforms","MAC","releaseDate"]),T=Origin.utils.getProperty(u,["platforms","PCWIN","releaseDate"]);return r="MAC"===Origin.utils.os()&&C?C:T,s&&(!p&&S?h=r&&I>r?l.PRIMARY_BUY_NOW_CTA:l.PRIMARY_PRE_ORDER_CTA:f?h=l.PRIMARY_UPGRADE_VAULT_EARLY_ACCESS_CTA:u.freeBaseGame&&n.isTrialExpired?h=G:s.inTrash?h=l.PRIMARY_RESTORE_CTA:function(e,t){var i=e.playable;return i&&(F(e,t)?i=!1:(e.updating&&e.updateIsMandatory||e.repairing||e.installing)&&(i=!1)),i}(s,c)?s.updateAvailable&&!s.uninstalling&&!s.downloading&&s.updateIsMandatory?h=l.PRIMARY_UPDATE_CTA:(h=E(m),b=!s.uninstalling,y=s.launchable):s.progressInfo&&s.progressInfo.active?(h=(v=function(e,t){var i="",n="",r={},o=!0;return e.progressInfo&&(F(e,t)?i=l.PRIMARY_PHASE_DISPLAY_CTA:(n=function(e){var t="";return e.updating?t="update":e.downloading?t="PRELOAD"===e.releaseStatus?"preload":"download":e.installing?t="install":e.repairing&&(t="repair"),t}(e),0===t.queueIndex?i=e.pausable?"primarypause"+n+"cta":e.resumable?"primaryresume"+n+"cta":l.PRIMARY_PHASE_DISPLAY_CTA:t.queueIndex>0&&(i="primary"+n+"nowcta",o=t.queueSkippingEnabled))),r.label=i,r.enabled=o,r}(s,c)).label,b=v.enabled):s.installed?k&&I>k?h=e?l.PRIMARY_UNINSTALL_CTA:l.MORE_DETAILS_CTA:(h=E(m),b=!1):k&&I>k?h=l.MORE_DETAILS_CTA:s.downloadable||Origin.client.isEmbeddedBrowser()&&a.isExtraContent(u)&&a.isDownloadable(u)?(h=function(e,t){var i=t.queueIndex,n="PRELOAD"===e.releaseStatus,r="";if(0===g.getQueueSize())r=n?l.PRIMARY_PRELOAD_CTA:l.PRIMARY_DOWNLOAD_CTA;else switch(i){case-1:r=l.PRIMARY_ADDTO_DOWNLOADS_CTA;break;default:r=n?l.PRIMARY_PRELOAD_NOW_CTA:l.PRIMARY_DOWNLOAD_NOW_CTA}return r}(s,c),b=Origin.client.onlineStatus.isOnline()&&!s.isWrongArchitecture):s.installable?h=l.PRIMARY_INSTALL_CTA:p&&!Origin.client.isEmbeddedBrowser()&&(h=D?l.PLAY_ON_ORIGIN_CTA:R?l.GET_IT_WITH_ORIGIN_CTA:l.GET_IT_WITH_ORIGIN_CTA_INCOMPATIBLE),h.length>0&&((o=_.find(w,{label:h})||{}).label===l.PRIMARY_PHASE_DISPLAY_CTA&&(o.phaseDisplay=function(e){var t="NO PHASE";return e.progressInfo&&(t=e.progressInfo.phaseDisplay),t}(s)),o.enabled=b&&d.isAvailableOnPlatform(Origin.utils.os())(u),o.launchable=y)),o.offerId=n.offerId,o}}function L(e,t){return function(i){return{offerId:e,catalogInfo:i[e],clientActions:g.getGame(e,t),queueInfo:g.getQueueInfo(e,t),ownsGame:u.ownsEntitlement(e,t)}}}function A(e,t){return c.getGameDataWithEntitlements([e],t)}var D,R,$=[],N=Origin.user.personaId(),G=l.VIEW_INSTORE_CTA;return{contextMenu:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return A(e,i).then(L(e,i)).then(b).then(function(e){return function(e,i){var n=t.baseActionsList(e,{externalType:i});return P(e,n,i).then(function(){return n})}(e,i)}).then(O).catch(function(t){return r.error("GAMESCONTEXTFACTORY: unable to retrieve cataloginfo for: "+e,t),[]})},primaryAction:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return A(e,i.externalType).then(v).then(L(e,i.externalType)).then(b).then(y).then(S).then(x(t,i)).catch(function(t){return r.error("GAMESCONTEXTFACTORY: unable to retrieve cataloginfo for: "+e,t),{}})}}}function um(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v){"ngInject";return v.get("GamesContextFactory",gm,this,arguments)}function pm(e,t,i,n){function r(e){i.error("[GAMES DIRTYBITS UPDATE]:",e)}function o(){p.fire("GamesDirtybitsFactory:entitlementUpdateEvent")}function a(e){return e&&"xOfferChange"===e.msgType&&e.xBaseGameOfferIds&&e.xBaseGameOfferIds.length||e&&"offerPublishingChange"===e.msgType&&e.baseGameOfferIds&&e.baseGameOfferIds.length}function s(e){return e&&"xOfferChange"===e.msgType&&e.xMasterTitles&&Object.keys(e.xMasterTitles).length||e&&"offerPublishingChange"===e.msgType&&e.masterTitles&&Object.keys(e.masterTitles).length}function c(t,i,n){var r={};_.isEmpty(t)||(e.removeCatalogEntries(t),_.forEach(t,function(e){Origin.games.updateOfferCacheInfo(e,n[e]),r[e]={offerId:e,parentOfferId:i}}),p.fire("GamesDirtybitsFactory:catalogUpdated",{signal:"catalogUpdated",eventObj:r}))}function l(){f=null,t.retrieveEntitlements(!0).then(e.getCatalogInfo).then(t.doPostRefreshTasks).then(o).catch(r)}function d(e,t){m=_.without(m,t.timeOutHandle),t.timeOutHandle=null,(Origin.user.isAccessTokenExpired()?Origin.auth.reloginAccessTokenExpired():Promise.resolve()).then(_.partial(e,t)).catch(function(e){i.error("[GamesDirtyBits] error",e)})}function g(e,t){m=_.without(m,t.timeOutHandle),t.timeOutHandle=null,e(t)}function u(e,t){return function(i){if(t||a(i)||s(i))if(Origin.user.isAccessTokenExpired()){var n,r=t?0:_.random(0,6e5,!1);n=t?setTimeout(_.partial(d,e,i),r):setTimeout(_.partial(g,e,i),r),i.timeOutHandle=n,m.push(n)}else e(i)}}var p=new Origin.utils.Communicator,m=[],f=null;return Origin.events.on(Origin.events.DIRTYBITS_ENTITLEMENT,u(function(){f&&clearTimeout(f),f=setTimeout(l,pne)},!0)),Origin.events.on(Origin.events.DIRTYBITS_CATALOG,u(function(i){var n={};if(a(i)&&(n=_.get(i,"xOfferUpdateTimes",_.get(i,"offerUpdateTimes"),{}),c(_.get(i,"xBaseGameOfferIds",_.get(i,"baseGameOfferIds"),[]),null,n)),s(i)){var o=_.get(i,"xMasterTitles",_.get(i,"masterTitles"),[]);return n=_.get(i,"xOfferUpdateTimes",_.get(i,"offerUpdateTimes"),{}),Promise.all(_.map(o,function(i,o){return function(i){var n=_.keys(t.getBaseGameEntitlements());return e.getCatalogInfo(n).then(_.partial(t.getBaseGameEntitlementByMasterTitleId,i))}(o).then(function(e){c(i,e?e.offerId:null,n)}).catch(r)}))}})),n.events.on("myauth:change",function(e){e&&!e.isLoggedIn&&(m.forEach(function(e){clearTimeout(e)}),f&&clearTimeout(f))}),{events:p}}function mm(e,t,i,n,r){"ngInject";return r.get("GamesDirtybitsFactory",pm,this,arguments)}function fm(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function hm(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e,t){return function(e){e.isPurchasedGame&&delete e.isSuppressed}(t),i.set(fne,w.getAllFilterValues()),b(t)>0&&(e.forEach(f),e=v(e,t)),e}function p(e,t){var i={};return i[e]=!0,_.isString(I[e].value)&&(i[e]=I[e].value),"isPurchasedGame"!==e&&(i.isSuppressed=!1),v(t,i).length}function m(e,t){var i=!r.isActive(),n=e[DI.A]||Sne,a=t[DI.A]||Sne;return n===a&&(n=o.getSubTypePriority(e[DI.y]),a=o.getSubTypePriority(t[DI.y])),i&&(n-=e.isSubscription?yne:Sne,a-=t.isSubscription?yne:Sne),a-n}function f(e){e.displayName=e.displayName?e.displayName.replace(kne,""):""}var h,v=e("filter"),b=t.length,y=t.transformWith,S=c.subtractDays,k=i.get(fne,{}),I={displayName:{filterType:vne,value:""},isPlayedLastWeek:{filterType:vne,value:!1},isFavorite:{filterType:vne,value:!1},isDownloading:{filterType:vne,value:!1},isHidden:{filterType:bne,value:!1},isInstalled:{filterType:vne,value:!1},isNonOrigin:{filterType:vne,value:!1},isSubscription:{filterType:vne,value:!1},isPurchasedGame:{filterType:vne,value:!1},isSuppressed:{filterType:bne,value:!1},isPcGame:{filterType:vne,value:!1},isMacGame:{filterType:vne,value:!1},isSteamGame:{filterType:vne,value:!1},isEpicGame:{filterType:vne,value:!1}},w=n.getInstance(I);k.isSuppressed=!1,w.setAllFilterValues(k);var C=y((fm(h={offerId:"offerId",ocdPath:"offerPath",displayName:["i18n","displayName"],gameNameFacetKey:"gameNameFacetKey",gameEditionType:"gameEditionType",platformFacetKey:"platformFacetKey",platforms:"platforms"},DI.A,DI.A),fm(h,DI.y,DI.y),fm(h,"vault","vault"),fm(h,"masterTitleId","masterTitleId"),fm(h,DI.D,DI.D),h));return angular.extend({applyFilters:function(e){return u(e,w.getApplicableFilterValues())},applyDefaultFilters:function(e){return u(e,w.getDefaultFilterValues())},hideLesserEditions:function(e){var t=g.hasClientDualEntitlementFix(),i=e.reduce(function(e,i){if(!i.isAlphaBetaDemo){var n=t?l.getEntitlementSourceFromExternalType(i.externalType):"",r=[i.masterTitleId,i.gameNameFacetKey,n].join("_");e[r]=e[r]?[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(e[r]),[i]).sort(m):[i]}return e},{});return _.forEach(i,function(e){var t=_.findIndex(e,function(e){return s.isReleasedOnAnyPlatform()(e)&&e.status===kF.b.ACTIVE}),i=t>-1?t:e.length;!function(e,t){var i=r.isActive(),n=!1;Origin.utils.os()===Origin.utils.OS_WINDOWS&&(_.forEach(e,function(e){if(e.isSubscription&&i)return n=!0,!1}),n&&_.forEach(e,function(e,i){i>t&&(e.isSuppressed=!0)}))}(e,i),function(e,t){var i=!1;_.forEach(e,function(e){if(e.isTrial||e.isEarlyAccess)return i=!0,!1}),i&&_.forEach(e,function(e,i){i>t&&(e.isTrial||e.isEarlyAccess)&&(e.isSuppressed=!0)})}(e,i),function(e){var t=!1,i=!1;_.forEach(e,function(e){e.isPreorder?t=!0:i=!0}),t&&i&&_.forEach(e,function(e){e.isPreorder&&(e.isSuppressed=!0)})}(e),function(e){_.some(e,function(e){return e.isPurchasedThroughThirdParty})&&_.forEach(e,function(e){e.isSuppressed=!1})}(e)}),e},getCountForFilter:p,calculateCounts:function(e){return _.forEach(w.getFilters(),function(t,i){t.count=p(i,e),w.isActive(t)&&0===t.count&&w.deactivate(t)}),e},createGameModel:C,updateGameModelExtraProperties:function(e){var t=a.getEntitlement(e.offerId);return e.isPurchasedThroughThirdParty=l.isPurchasedThroughThirdParty(t),e.isPcGame=s.isAvailableOnPlatform(DI._13)(e),e.isMacGame=s.isAvailableOnPlatform(DI.U)(e)&&!l.isInSubscription(t),e.isFavorite=a.isFavorite(e.offerId,{externalType:e.externalType}),e.isHidden=a.isHidden(e.offerId,{externalType:e.externalType}),e.isPlayedLastWeek=e.lastPlayedTime&&e.lastPlayedTime>=S(new Date,7).getTime(),e.isSuppressed=!1,e.isNonOrigin=a.isNonOriginGame(e.offerId),e.isSubscription=d.isSubscriptionEntitlement(e.offerId),e.isTrial=o.isTrial(e)&&_.get(e,DI.D)!==hne,e.isEarlyAccess=o.isEarlyAccessTrial(e),e.isPurchasedGame=!e.isSubscription&&!(e.isTrial||e.isEarlyAccess),e.isDownloading=a.isDownloading(e.offerId,e.externalType),e.isInstalled=a.isInstalled(e.offerId,e.externalType),e.isAlphaBetaDemo=o.isAlphaBetaDemo(e),e.isPreorder=l.isPreorder(t),e.isSteamGame=l.getEntitlementSourceFromExternalType(e.externalType)===kF.a.STEAM,e.isEpicGame=l.getEntitlementSourceFromExternalType(e.externalType)===kF.a.EPIC,e.status=_.get(t,kF.d),e},sanitize:f},w)}function vm(e,t){return{goToOgd:function(i){var n=i.offerId,r=i.externalType,o=i.topic,a=r;if(void 0===a){var s=t.getEntitlement(n,{includeAllExternalTypes:!0});s.length&&(a=s[0].externalType)}o?e.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd.topic",{offerid:n,type:a,topic:o}):e.events.fire("uiRouter:go","app.game_gamelibrary_wrapper.library.ogd",{offerid:n,type:a})}}}function bm(e,t,i){"ngInject";return i.get("OgdUrlFactory",vm,this,arguments)}function ym(e,t,i,n,r){"ngInject";function o(e,o,a){var s=function(e){var t=n.getActiveSubscriptionLevel();return t===yI.y.STANDARD&&_.get(e,DI.P,!1)?_.get(e,[DI._34,DI._12]):t===yI.y.PREMIUM&&_.get(e,[DI._16,DI.P],!1)?_.get(e,[DI._16,DI._12]):""}(_.head(_.values(a)));s?(function(e){var i=t.get(Cne,[]);i.push(e),t.set(Cne,i)}(e),i.openDirective({id:r.dialogId,name:"origin-dialog-content-vaultupgradeonplayaction",size:"large",data:{offerId:e,vaultOcdPath:s}})):Origin.client.games.play(e,o)}return{checkForUpgrade:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.userHasSubscription()&&!function(e){return-1!==t.get(Cne,[]).indexOf(e)}(i)?e.getCatalogInfo([i]).then(_.partial(o,i,r)):Origin.client.games.play(i,r)}}}function Sm(e,t){"ngInject";function i(e){a.data.tileSize=e,a.commit()}var n=["large","medium","small"],r=n[0],o="GameLibraryTileSize",a=e.observe({tileSize:r});return Origin.client.isEmbeddedBrowser()?Origin.client.settings.readSetting(o).then(function(e){i(n.indexOf(e)>=0?e:r)}).catch(function(){i(r)}):i(r),{getTileSizeObserver:function(){return t.create(a)},setTileSize:function(e){n.indexOf(e)>=0&&(Origin.client.settings.writeSetting(o,e),i(e))}}}function km(e,t,i){"ngInject";var n=i.buildTag,r=e.isValidViolatorData;return{getInlineMessages:function(i,o,a,s){if(r(i))return i.map(function(i){return function(i,r,o){return i.violatorType===e.violatorType.automatic?n(_ne,{violatortype:i.label,priority:i.priority,offerid:r,enddate:i.endDate||"",timeremaining:i.timeRemaining,timerformat:i.timerformat,"external-type":o||""}):(i.offerid=r,t.wrapDocumentForCompile(n(One,i)))}(i,o,s)}).slice(0,a)},getTelemetryCssClass:function(e,t){if(r(e))return e.map(function(e){return e.telemetryCssClass}).slice(0,t)}}}function Im(e,t,i){"ngInject";function n(t,i){return t.violatorType&&t.violatorType===e.violatorType.automatic?{name:Fne,data:{violatortype:t.label,priority:t.priority,offerid:i,enddate:t.endDate?t.endDate.toString():"",timeremaining:t.timeRemaining||"",timerformat:t.timerformat||"","telemetry-css-class":t.telemetryCssClass||""}}:(t.offerid=i,{name:xne,data:t})}function r(e,t,i){this.gamemessages=e,this.closemessagescta=t,this.dialogMessages=i}var o=t.buildTag,a=e.isValidViolatorData;return r.prototype.show=function(){var e="ogd-violator-read-more-dialog";i.open({modal:!0,size:"medium",id:e,directives:[{name:"origin-dialog-content-prompt",data:{header:this.gamemessages,nobtntext:this.closemessagescta,defaultbtn:"no",id:e},directives:this.dialogMessages}]})},{getInlineMessages:function(i,n,r,s){if(a(i))return i.map(function(i){return function(i,n,r){return i.violatorType&&i.violatorType===e.violatorType.automatic?o(Fne,{violatortype:i.label,priority:i.priority,offerid:n,enddate:i.endDate||"",timeremaining:i.timeRemaining||"",timerformat:i.timerformat||"","telemetry-css-class":i.telemetryCssClass||"","external-type":r||""}):(i.offerid=n,t.wrapDocumentForCompile(o(xne,i)))}(i,n,s)}).slice(0,r)},getDialogMessages:function(e,t,i,o){if(a(e))return new r(i,o,e.map(_.partial(n,_,t)))},getReadMoreLinkHtml:function(e,t,i){var n=e-t;return['<div class="origin-ogd-message origin-ogd-messages-readmore">','<a class="origin-ogd-messages-readmore-link" ng-click="readmore.show()">',i({"%messages%":n},n),"</a>","</div>"].join("")}}}function wm(e,t,i,n,r){"ngInject";function o(e){return t.isExtraContent(e)&&t.isExpansion(e)||t.isNoneType(e)&&t.isPurchasable(e)&&!t.isAlphaTrialDemoOrBeta(e)}function a(e){return t.isExtraContent(e)&&t.isAddon(e)}function s(e){return t.isCurrency(e)}function c(e,t,i){return{groupName:e,displayName:t,sortOrder:i}}function l(e,i){var n=i.isInsideTab,r=i.isOigContext;return!n||e.extraContentDisplayGroup?function(e){return{groupName:e.extraContentDisplayGroup||iF,displayName:_.get(e,["i18n","extraContentDisplayGroupDisplayName"])||iF,sortOrder:e.extraContentDisplayGroupSortAsc&&!isNaN(e.extraContentDisplayGroupSortAsc)?parseInt(e.extraContentDisplayGroupSortAsc,10):1}}(e):function(e,i){return a(e)?c(tF,tF,cF):o(e)||t.isGameOnlyExpansion(e)&&i?c(nF,nF,sF):s(e)&&i?c(rF,rF,lF):{}}(e,r)}function d(e,n,c){var d=[],g=function(e,n,c){var l=Origin.user.underAge(),d=r.isNoCommerceContext();return _.filter(n,function(e){return(d?i.ownsEntitlement(e.offerId):_.get(e,["countries","isPurchasable"],!1)&&!l||i.ownsEntitlement(e.offerId))&&(e.extraContentDisplayGroup||a(e)||o(e)||c.isOigContext&&(s(e)||t.isGameOnlyExpansion(e)))})}(0,n,c);return g&&g.length&&g.forEach(function(e){return function(e,t,i){var n=l(e,i),r=n.groupName,o=n.displayName,a=n.sortOrder;if(!_.isUndefined(r)){var s=_.findIndex(t,function(e){return e.groupName===r});if(s>=0)t[s].items.push(e);else{var c={groupName:r,displayName:o,sortOrder:a,items:[e]},d=_.findIndex(t,function(e){return a<e.sortOrder});d>=0?t.splice(d,0,c):t.push(c)}}}(e,d,c)}),d}function g(e,t){return d(0,t,{isInsideTab:!1,isOigContext:!1})}function u(t){return function(t){return Promise.all([e.retrieveExtraContentCatalogInfo(t).then(_.values),n.retrieveDisplayTypeNoneExtraContentInfo(t).then(_.values)]).then(_.flatten)}(t).then(_.partial(g,t)).catch(function(){return[]})}return{groupExtraContentInsideTab:function(e,t,i){return d(0,t,{isInsideTab:!0,isOigContext:i})},getAllExtraContentGroups:u,findExtraContentGroup:function(e,t){return u(e).then(function(e){return _.find(e,function(e){return e.groupName===t})}).catch(function(){return null})}}}function Cm(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Tm(e,t,i,n){"ngInject";function r(e){return e&&e.hasOwnProperty(Bne)?e[Bne].replace(Une,""):""}function o(e,t){var i=r(t);return w[i]?e+w[i](t):e}function a(e,t){return e.hasOwnProperty(t)?e[t].trim():""}function s(e){return n.stripStorefrontAndLocaleFromPath(_.last(gre.exec(e)))}function c(e){return e=function(e){if(sre.test(e)){var t=_.last(sre.exec(e));if(t)return"<a href='"+g("/"+t)+"'"}return e}(e),gre.test(e)?function(e){var t=s(e);return t?"<a href='"+t+"' target='_self' class='internal-link'":e}(e):e+" target='_blank' class='external-link'"}function l(e){var t="";return e&&(t=function(e){var t="";return e&&(t=e.replace(are,c)),t}(t=function(e){var t="";return e&&(t=e.replace(dre,function(){return"'"})),t}(e))),t}function d(e){var t=_.get(e,["image","renditions"]),i=_.get(e,"cta")||_.get(e,"ctas"),n=p(t,Dne.widescreen,Gne),r=a(e,"title"),s=a(e,"copy"),c=a(e,"eyebrow"),l=a(e,"secondaryEyebrow"),d=a(e,"byline"),g="",u=i&&i.reduce(o,"");return(n||u||c||l||r||d||s)&&(g='<otkex-content-editorial image="'+(n=n||"")+'" eyebrow="'+c+'" secondary-eyebrow="'+l+'" title="'+r+'" byline="'+d+'" copy="'+s+'">'+(u=u||"")+"</otkex-content-editorial>"),g}function g(e){return cre.test(e)?e:k+e}function u(e){var t=a(e,"text"),i=a(e,"url"),n=!gre.test(i);return t&&i?(i=g(i),n||(i=s(i)),'<otkex-content-cta text="'+t+'" url="'+i+'" is-external-link="'+n+'"></otkex-content-cta>'):""}function p(e,t,i){var n=t||Dne.widescreen,r=i||Rne;if(e){var o=_.find(e,function(e){return e.aspectRatio===n});return a(_.find(o.renditionDetails,function(e){return e.width>=r}),"url").replace(/ /g,"%20")}return""}function m(e){var t=e["@id"],i=e.datePublished,n=e.headline,r=e.shortDescription,o=e.canonicalUrl,a=e.readTime,s=function(e){var t=_.get(e,["image","0","renditions"]);return{square:p(t,Dne.square,$ne),widescreen:p(t,Dne.widescreen,Nne)}}(e);return S[t]={},S[t].markup="",S[t].url=o,{articleId:t,datePublished:i,headline:n,shortDescription:r,thumbnails:s,readTime:a,canonicalUrl:o}}function f(e){var t=e.resultData,i=e.currentPage,n=e.resultsPerPage,r=e.totalCount;return{results:_.map(t,m),currentPage:i,resultsPerPage:n,totalResults:r}}function h(e){i.error("Error getting article list: "+e)}var v,b=Origin.locale.locale().toLowerCase().replace("_","-"),y=mre[b],S={},k="",I=b,w=(Cm(v={},Mne,function(e){var t=e.content;return t&&t.reduce(o,"")}),Cm(v,jne,function(e){var t=a(e,"eyebrow"),i=a(e,"title"),n=a(e,"subtitle"),o=_.get(e,"customImageObject"),s="",c="";return r(o)===Hne&&(s=w[Hne](o)),(i||n||t||s)&&(c='<otkex-content-header title="'+i+'" subtitle="'+n+'" eyebrow="'+t+'" image="'+s+'"></otkex-content-header>'),c}),Cm(v,Hne,function(e){return _.get(e,["renditions","xlarge","url"],"").replace(/ /g,"%20")}),Cm(v,zne,function(e){var t,i,n=a(e,"mp4Src"),s=a(e,"webmSrc"),c=e.images,l=e.columns,d="",g="";return(t=_.head(c))&&r(t)===Hne&&(d=w[Hne](t)),i=l&&l.reduce(o,""),(n||s||d||i)&&(g='<otkex-content-section mp4-src="'+n+'" webm-src="'+s+'" background-image="'+d+'">'+i+"</otkex-content-section>"),g}),Cm(v,Vne,function(e){var t=e.content,i=t&&t.reduce(o,""),n="";return i&&(n="<otkex-content-column>"+i+"</otkex-content-column>"),n}),Cm(v,Wne,function(e){var t=e.text,i=e.textLongSection,n=l(_.get(i,"textLong")),r=l(t),o="";return(r||n)&&(o='<otkex-content-text text="'+(r+n)+'"></otkex-content-text>'),o}),Cm(v,qne,function(e){var t=e.columns,i=e.dataRows;if(i&&t){var n=0==i.length%t.length?i.length/t.length:0,r=JSON.stringify(_.map(t,"header")).replace(lre,ure),o=[],a=[];_.forEach(t,function(e){var t=_.filter(i,{key:e.key},function(e){return e.value});o.push(t)});for(var s=0;s<n;s++){for(var c=[],l=0;l<t.length;l++)c.push(o[l][s].value);a.push(c)}return"<otkex-content-table headers='"+r+"' rows='"+(a=JSON.stringify(a).replace(lre,ure))+"'></otkex-content-table>"}return""}),Cm(v,Yne,function(e){var t=e.tiles,i=t&&t.reduce(o,"");return i?"<otkex-content-grid>"+i+"</otkex-content-grid>":""}),Cm(v,Kne,d),Cm(v,Qne,function(e){var t=p(e.renditions,Dne.widescreen,Gne),i=a(e,"caption"),n="";return(t||i)&&(n='<otkex-content-image image="'+t+'" caption="'+i+'"></otkex-content-image>'),n}),Cm(v,Jne,function(e){var t=a(e,"eyebrow"),i=a(e,"title"),n=a(e,"subtitle"),r="";return(t||i||n)&&(r='<otkex-content-subheading eyebrow="'+t+'" title="'+i+'" subtitle="'+n+'"></otkex-content-subheading>'),r}),Cm(v,Xne,d),Cm(v,Zne,function(e){if(Origin.client.isEmbeddedBrowser())return"";var t=a(e,"mp4Src"),i=a(e,"webmSrc"),n=p(_.get(e,["coverImage","renditions"]),Dne.widescreen,Gne),r="";return(t||i||n)&&(r='<otkex-content-video mp4-src="'+t+'" webm-src="'+i+'" image="'+n+'"></otkex-content-video>'),r}),Cm(v,ere,function(e){var t=a(e,"youtubeId");return t?'<origin-youtube video-id="'+t+'"></origin-youtube>':""}),Cm(v,tre,function(e){var t=e.youtubeVideoObjects,i=_.map(t,"youtubeId").toString();return i?'<origin-youtube playlist="'+i+'"></origin-youtube>':""}),Cm(v,ire,u),Cm(v,nre,u),Cm(v,rre,u),Cm(v,ore,u),v);return{getArticleHeadersByOfferId:function(n,r,o){if(r>0&&n){var a=t.toArray(n);return e.getCatalogInfo(a).then(function(e){return function(e,t,n,r){var o=[e[t].gameNameFacetKey];return Origin.contentservice.retrieveArticleListByGameName(o,b,n,r,0).then(function(e){return e.totalCount<=0&&y?(I=y,Origin.contentservice.retrieveArticleListByGameName(o,y,n,r,0)):e}).then(f,h).catch(function(e){return i.error("[CONTENTSERVICEFACTORY] Error retrieving articles: "+e),{}})}(e,n,o,r)}).catch(function(e){return i.error("[CONTENTSERVICEFACTORY] Error retrieving article headers: "+e),{}})}return Promise.resolve({})},getArticleHeadersByMostRecent:function(e){return e>0?Origin.contentservice.retrieveArticleListByMostRecent(b,e,0).then(f,h).catch(function(e){return i.error("[CONTENTSERVICEFACTORY] Error retrieving articles: "+e),{}}):Promise.resolve({})},getArticle:function(e){S[e]=S[e]||{};var t=S[e].markup;return t?Promise.resolve(t):Origin.contentservice.retrieveArticleById(e,I).then(function(t){var o=t.canonicalUrl;return S[e].url=o,S[e].markup=function(e){k=n.extractHostnameUrl(_.get(e,"canonicalUrl",pre));var t="",o=_.get(e,"body"),a=r(o);return a===Mne?t=w[Mne](o):i.error("Expected NDSStandardArticle, but got "+a),t}(t),S[e].markup}).catch(function(e){return i.error("[CONTENTSERVICEFACTORY] Error retrieving article headers: "+e),""})},getArticleUrl:function(e){var t=S[e].url;return Promise.resolve(t)}}}function Pm(e,t,i,n){"ngInject";function r(e,t){var n=0;for(n=0;n<e.length;n++){var r=_.get(e[n],"offerId");if(i.isReleased(Origin.utils.os())(_.get(t,[r])))return r}return _.get(e,[0,"offerId"])}function o(e,t){return _.isArray(e)||(e=[]),e.forEach(function(e,i){e.offerId=t[i],e.baseGameEntitlements=[]}),e}function a(e,t){return function(e,t){return t-e}(e.lastPlayedDate,t.lastPlayedDate)}function s(t){var i,n=[];return t.forEach(function(t){(i=e.getAllBaseGameEntitlementsByMasterTitleId(t.masterTitleId))&&n.push({baseGameEntitlements:i,lastPlayedDate:new Date(t.timestamp),articleId:t.articleId})}),n.sort(a),n}function c(e){var i=[];return _.isArray(e)||(e=[]),e.forEach(function(e){var n;1===e.baseGameEntitlements.length?i.push(Promise.resolve(e.baseGameEntitlements[0].offerId)):i.push((n=e.baseGameEntitlements,t.getCatalogInfo(_.map(n,"offerId")).then(_.partial(r,n))))}),Promise.all(i).then(_.partial(o,e))}function l(e){return n.error("[LASTPLAYEDFACTORY] lastplayed game retrieval error",e),[]}return{retrieveLastPlayedGames:function(){return(OriginKernel.promises.atomGameLastPlayed||Origin.atom.atomGameLastPlayed()).then(s).then(c).then(function(e){return OriginKernel.promises.atomGameLastPlayed&&(OriginKernel.promises.atomGameLastPlayed=null),e}).catch(l)}}}function _m(e,t){"ngInject";function i(e,t){return function(e,t){return t-e}(e.latestAvailableDate,t.latestAvailableDate)}function n(t){return new Promise(function(n){var r,o=null,a=[];for(r=0;r<t.length;r++){o=e.getGame(t[r].offerId);var s=_.get(o,"initialInstalledTimestamp");if(s&&_.get(o,"installed")){var c=new Date(t[r].grantDate),l=new Date(s);o.latestAvailableDate=c.getTime()>l.getTime()?c:l,a.push(o)}}a.sort(i),n(a)})}return{retrieveLatestInstalled:function(){return Promise.all([new Promise(function(e){t.initialRefreshCompleted()?e(t.baseGameEntitlements()):(t.events.once("games:baseGameEntitlementsUpdate",e),t.events.once("games:baseGameEntitlementsError",e))}),new Promise(function(i){e.initialStateReceived()&&i(),t.events.once("games:initialClientStateReceived",i)})]).then(_.spread(n))}}}function Om(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Em(e,t,i,n,r){"ngInject";function o(e){return r.error("[DiscoveryStoryFactory] retrieve feed data error",e),[]}function a(e,t){for(var i=0;i<e.length;i++)e[i].feedData=t[i];return e}function s(e){var t=[];return e.forEach(function(e){_.isArray(e.feedData)&&(e.feedData=e.feedData.filter(function(e){return function(t){var i=!0,n=t.offerid;return n&&(i=e.indexOf(n)<0)&&e.push(n),i}}(t))),e.limit=function(e){var t=e.feedData.length,i=e.limit||t;return(-1===i||t<i)&&(i=t),i}(e)}),e}function c(t,i){return t.forEach(function(t){t.postGenerationFeedModificationsFunctionName&&e[t.postGenerationFeedModificationsFunctionName](t)}),i}function l(i){return function(t){return Promise.all(_.map(t,function(t){return _.isFunction(e[t.feedFunctionName])?e[t.feedFunctionName](t).catch(o):Promise.resolve(t.feedData||[])}))}(i).then(_.partial(a,i)).then(s).then(t.generateList).then(_.partial(c,i))}function d(e){var t,o,a,s=_.get(e,["feedTypeConfig","directiveName"]),c=_.get(e,["feedTypeConfig","childDirectives"]),l=_.get(e,["feedTypeConfig","feedData"],[]),d=_.get(e,"index"),g=void 0;return t=_.get(l,d,{}),g=_.omitBy(t,_.isUndefined),c&&_.isUndefined(g.items)&&(g.items=c),o=_.get(t,"offerid"),a=Om({},s,g),o?Promise.all([n.getOcdByOfferId(o).then(i.findDirectives("origin-game-defaults")).then(i.flattenDirectives("origin-game-defaults")).then(_.head).then(function(e){return Om({},s,e)}).catch(function(e){r.error("[DiscoveryStoryFactory] buildDirective get ocd 1 error",e)}),n.getOcdByOfferId(o).then(i.findDirectives(s)).then(_.head).catch(function(e){r.error("[DiscoveryStoryFactory] buildDirective get ocd 2 error",e)})]).then(_.spread(_.merge)).then(function(e){return _.merge(a,e)}).then(function(e){return i.slingDataToDom(e)}).catch(function(e){r.error("[DiscoveryStoryFactory] buildDirective sling error",e)}):i.slingDataToDom(a)}return{generateStories:function(e,t){return _.isFunction(t)?t(e).then(l):l(e)},generateXML:function(e,t,i){var n,r=[];(n=e+(t=t||i.length))>i.length&&(n=e+(t=i.length-e));for(var o=e;o<n;o++)r.push(d(i[o]));return Promise.all(r)}}}function Fm(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m){function f(e){return(Date.now()-e)/L}function h(e){var t=Origin.utils.getProperty(e,["platforms",Origin.utils.os(),"releaseDate"]);return t||(t=new Date(t)),t}function v(e,t){return t.grantDate-e.grantDate}function b(e){var t=e.map(function(e){return{offerid:e.offerId}});return Promise.resolve(t)}function y(t){return t?e.getCatalogInfo([t]).then(function(e){var i=_.get(e[t],["platforms",Origin.utils.os(),"downloadStartDate"],null);return i&&l.isInThePast(i)?t:null}).catch(function(){return null}):Promise.resolve(null)}function S(n){if(n){var r=!1,o=t.getEntitlement(n);return o&&(r=s.isExpired(o)),Promise.all([function(t){return e.getCatalogInfo([t]).then(function(e){return d.isExpired(Origin.utils.os())(e[t])})}(n),i.isTrialExpired(n)]).then(_.spread(function(e,t){return e||t||r?null:n}))}return null}function k(e,t,i){return e&&(t&&i||!i)?e:null}function I(t){return t?Promise.all([t,e.getCatalogInfo([t]).then(u.getProperty(t)).then(d.isReleased(Origin.utils.os())),p.getGamePromise(t).then(u.getProperty("installed"))]).then(_.spread(k)):Promise.resolve(null)}function w(e){return t.isInstalled(e.offerId)}function C(e){function t(t){var n=null;return i.length>t&&0!==i[t].lastPlayedDate&&(n=i[t].offerId),e?n:S(n)}var i=[];return o.getLastPlayedDate().then(function(e){i=e}).then(_.partial(t,0)).then(function(e){return e||t(1)})}function T(e,t){return e.nonLegacyTrial?i.isTrialInProgress(e.nonLegacyTrial).then(function(i){var n=t?!i:i;return e.nonLegacyTrial=n?e.nonLegacyTrial:null,e}).catch(function(){return e.nonLegacyTrial=null,e}):e}function P(e){return e.nonLegacyTrial?e.nonLegacyTrial:0===e.legacyTrials.length?null:o.getLastPlayedDate().then(function(t){for(var i=0;i<t.length;i++)if(e.legacyTrials.indexOf(t[i].offerId)>=0)return t[i].offerId;return e.legacyTrials[0]}).catch(function(){return e.legacyTrials[0]})}function O(e,t){return{nonLegacyTrial:t,legacyTrials:e}}function E(e,n,r){for(var o,s,l=null,d=null,g=[],u=0,p=e.length;u<p;u++)l=e[u],(a.isEarlyAccessTrial(l)||a.isTrial(l))&&(c.isLegacyTrial(l)?(o=c.isTrialInProgress(l,t.getEntitlement(l.offerId)),(r?!o:o)&&g.push(l.offerId)):l.offerId===n&&(d=l.offerId));return(s=d,s?i.isTrialAwaitingActivation(s).then(function(e){return e?null:s}):Promise.resolve(null)).then(_.partial(O,g))}function F(e){return t.isInstalled(e.offerId)}function x(e){return m.isSubscriptionEntitlement(e.offerId)}var L=864e5;return{getRecommendedGamesToBuy:function(e){return o.getRecommendedGamesToBuy(e)},getRecommendedHomeVaultGames:o.getRecommendedHomeVaultGames,getFriendsPlayingOwned:function(){return o.getFriendsPlaying().then(b)},getRecentlyReleased:function(e){return o.getBaseGameCatalog().then(function(t){var i=Number(e.dayssincerelease);return t.filter(function(e){return function(t){return f(h(t))<e&&t.downloadable}}(i))}).then(b)},getNotRecentlyPlayed:function(e){return o.getLastPlayedDate().then(function(t){var i,r=Number(e.notplayedlow),o=Number(e.notplayedhigh);return i=t.filter(function(e,t){return function(i){var n=f(i.lastPlayedDate||0);return n>e&&n<t}}(r,o)),n.shuffle(i,Math.random),i}).then(b)},getNeverPlayed:function(e){return Promise.all([o.getBaseGameEntitlements(),o.getLastPlayedDate()]).then(function(t){var i,r=t[0],o=t[1],a=Number(e.neverplayedsince);return i=r.filter(function(e,t){return function(i){var n=i.offerId,r=f(i.grantDate||0);return-1===t.indexOf(n)&&r>e}}(a,o)),n.shuffle(i,Math.random),i}).then(b)},getFriendsPlayingUnowned:function(){return o.getFriendsPlayingUnowned().then(b)},getRecentlyPlayedNoFriends:function(e){return o.getLastPlayedDate().then(function(t){var i=Number(e.dayssinceplayed);return t.filter(function(e){return function(t){return f(t.lastPlayedDate||0)<e}}(i))}).then(b)},getNextUnopenedGift:function(){var e=g.getNextUnopenedGift(),t=_.get(e,"offerId",null);return Promise.resolve(t)},getJustAcquired:function(){return Promise.all([o.getBaseGameEntitlements(),o.getLastPlayedDate()]).then(function(e){var t=e[0],i=e[1],n=null,r=(t=_.dropWhile(t,w)).length&&i.length&&t[0].grantDate>i[0].lastPlayedDate,o=t.length&&!i.length;return(r||o)&&(n=t[0].offerId),y(n).then(S)})},getNewestTrial:function(e){return Promise.all([o.getBaseGameCatalog(),C(e)]).then(_.spread(_.partial(E,_,_,e))).then(_.partial(T,_,e)).then(P).catch(function(){return null})},getLastPlayedGame:C,getNewestRelease:function(){return Promise.all([o.getLastPlayedDate(),o.getBaseGameCatalog()]).then(_.spread(function(e,t){var i,n=null,r=0;return t.length&&(r=f(i=h(t[0])))<25&&r>0&&(!e.length||e[0].lastPlayedDate<i)&&(n=t[0].offerId),y(n).then(S).then(I)}))},getNewestPreload:function(){return o.getBaseGameCatalog().then(function(e){for(var t=Date.now(),i=null,n=0,r=e.length;n<r;n++)if(h(e[n])>t&&e[n].downloadable){i=e[n].offerId;break}return y(i).then(S).then(I)})},getDownloadedGameNewerLastPlayed:function(){return Promise.all([o.getLatestDownloadedFromClient(),o.getLastPlayedDate()]).then(function(e){var t=null,i=e[0],n=e[1];return n.length&&i.initialInstalledTimestamp&&Date.parse(i.initialInstalledTimestamp)>n[0].lastPlayedDate&&(t=i.productId),t}).then(I)},getPlayedAGameRecently:function(e){return o.getLastPlayedDate().then(function(t){var i=!1;return t.length&&f(t[0].lastPlayedDate||0)<e&&(i=!0),i})},getUnownedDLC:function(){return o.getUnownedDLC().then(b)},getRecommendedFriends:function(){return o.getFriendRecommendations()},getMostRecentSubsEntitlementNotInstalled:function(){return o.getBaseGameEntitlements().then(function(e){return e.filter(F)}).then(function(e){var t=null;return Origin.client.isEmbeddedBrowser()&&r.userHasSubscription()&&r.isActive()&&0===e.length&&(t=o.getBaseGameEntitlements().then(function(e){var t=null,i=e.filter(x);return i.length>0&&(i.sort(v),t=i[0].offerId),t})),t})},getBaseGameEntitlements:o.getBaseGameEntitlements,applyFriendsRandomization:function(e){var t=[],i=2*e.storiesAdded,r=(new Date).setHours(0,0,0,0)/1e5;t=e.feedData.splice(0,i),n.shuffle(t,function(){return(r=(9301*r+49297)%233280)/233280}),e.feedData=t.concat(e.feedData)},getContentServiceArticleHeaders:o.getContentServiceArticleHeaders}}function xm(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";return f.get("FeedFactory",Fm,this,arguments)}function Lm(e,t,i,n){function r(e){var t=new Date(parseInt(e));if(n.isValidDate(t)){var i=n.addDays(t,parseInt(p));if(n.isInThePast(i))return!0}return!1}function o(e){return f.getStartedCustomAvatar=(!e.getStartedCustomAvatar||r(e.getStartedCustomAvatar))&&!y,f.getStartedAchievementVisibility=!e.getStartedAchievementVisibility||r(e.getStartedAchievementVisibility),f.getStartedProfileVisibility=!e.getStartedProfileVisibility||r(e.getStartedProfileVisibility),f.getStartedOriginEmail=(!e.getStartedOriginEmail||r(e.getStartedOriginEmail))&&!Origin.user.globalEmailSignup(),f.getStartedRealName=(!e.getStartedRealName||r(e.getStartedRealName))&&!b,f.getStartedVerifyEmail=(!e.getStartedVerifyEmail||r(e.getStartedVerifyEmail))&&"VERIFIED"!==Origin.user.emailStatus(),f.getStartedTwofactorAuth=(!e.getStartedTwofactorAuth||r(e.getStartedTwofactorAuth))&&!Origin.user.tfaSignup(),v=!0}function a(e){i.error("[origin-home-newuser-tile]:retrieveSettings FAILED:",e)}function s(e){i.error("OriginProfileHeaderCtrl: Origin.atom.atomUserInfoByUserIds failed",e)}function c(e){return!!f[e]}function l(){return Origin.atom.atomUserInfoByUserIds([Origin.user.userPid()])}function d(e){(m=e[0])&&(m.firstName||m.lastName)&&(b=!0)}function g(e){var t=e[0];t&&(y="default"!==t.avatar.galleryName)}function u(){return Origin.avatar.avatarInfoByUserIds(Origin.user.userPid(),Origin.defines.avatarSizes.LARGE).then(g).then(l).catch(s).then(d).then(t.getGeneralSettings).then(o).catch(a)}var p,m,f={getStartedCustomAvatar:!0,getStartedAchievementVisibility:!0,getStartedProfileVisibility:!0,getStartedOriginEmail:!0,getStartedRealName:!0,getStartedVerifyEmail:!0,getStartedTwofactorAuth:!0},h=new Origin.utils.Communicator,v=!1,b=!1,y=!1;return{dismiss:function(e,i){f[e]=!1,i&&t.setGeneralSetting(e,i),h.fire("getstarted:settingChanged",e)},checkSetting:function(e){return v?c(e):u().then(_.partial(c,e))},events:h,initialized:function(){return v},sendEmailVerification:function(){Origin.settings.email.sendEmailVerification()},sendOptinEmailSetting:function(){Origin.settings.email.sendOptinEmailSetting()},clearAllSettings:function(){for(var e in f)t.setGeneralSetting(e.name,"")},setRemindMeLater:function(e){p=e},getData:u,shuffleAndSortBucket:function(e){return _.chain(e).shuffle().orderBy("priority","desc").value()}}}function Am(e,t,i,n,r){"ngInject";return r.get("GetStartedFactory",Lm,this,arguments)}function Dm(e){"ngInject";function t(){return e.isHomeXSmall()?n:e.isHomeLarge()?r:o}var i=new Origin.utils.Communicator,n=1,r=2,o=4;return _.extend(i,{HOME_TILE_VISIBLE:"myhome:tile-visible"}),{getItemVisiblity:function(e,t,i){var n,r,o,a,s=[];if(e>0)for(o=(r=i*t)+t,a=0;a<e;++a)n=a>=r&&a<o,s.push(n);return s},getCurrentNumberOfColumns:t,getCurrentNumberOfColumnsQuarterWidth:function(){return e.isHomeXSmall()?n:o},getCurrentNumberOfColumnsHalfWidth:function(){return e.isHomeXSmall()?n:r},computeCarouselState:function(e,i,n,r){var o={},a=i,s=(_.isFunction(r)?r():t())||1,c=!1;return _.merge(o,e),i!==s&&(o.current=s>0?Math.floor(e.current*(i/s)):0,a=s,o.numberOfSlides=a>0?Math.ceil(n/a):0,o.current>=o.numberOfSlides&&(o.current=o.numberOfSlides),c=!0),{carouselChanged:c,carouselState:o,itemsPerPage:a}},findNextHiddenStory:function(e,t,i,n){var r=e+t*n,o=-1;return t<Math.ceil(i.length/n)-1&&(o=(t+1)*n),-1!==o?(i[r]=i[o],i[r].nextHiddenStoryIndex=o,i.splice(o,1)):i.splice(r,1),-1===o?null:i[r]},events:i}}function Rm(e,t,i){var n=!1,r=new Origin.utils.Communicator;return i.events.on("FeedModelsFactory:modelDirty",function(){r.fire("suggestRefresh"),n=!0}),{events:r,refreshSuggested:function(){return n},refresh:function(e){n=!1,i.reset(),t.go(t.current,{source:!!e&&t.params.source},{reload:t.current.name})}}}function $m(e,t,i,n,r){"ngInject";return r.get("HomeRefreshFactory",Rm,this,arguments)}function Nm(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";return{registerSmallHandlersIndexedOfferId:function(p){a.registerComponentHandlersIndexed(p,function(p,m){if(m.name===Sre&&!_.isUndefined(m.attrs.index))return function(p,m){return{name:Sre,promises:[o.getOcdByOfferId(m).then(s.findDirectives("origin-game-defaults")).then(s.flattenDirectives("origin-game-defaults")).then(_.head),r.getCatalogInfo([m]).then(c.getProperty(m)),e.getButtonStateObservable(m,!0,p),t.isTrialExpired(m),u.isSubscriptionEntitlement(m),g.isActive()],spread:function(e,t,i,r,s,c,g){var u=_.get(e,"discover-tile-image")||_.get(t,["i18n","packArtLarge"]),f=!1,h=Origin.utils.os(),v=_.get(t,["i18n","displayName"]),b=(!s||c&&"PCWIN"===h)&&!d.isSmall()&&t.platforms.hasOwnProperty(h)&&(_.isDate(_.get(t,["platforms",h,"releaseDate"]))||o.isNonOriginGame(m));u||(u=n.getImagePath("quicklaunch/origin-watermark.png"),f=!0),_.each({showFriendsPlaying:!0,showViolator:!0,isDisabled:!b,isWatermark:f,tileLayout:"small",tileImage:u,tileHeader:v,tileHeaderTooltip:v},g),a.onObserverUpdate(l.create(i),p,g,{tileEyebrow:function(e){var t=e.label;return _.isString(e.phaseDisplay)&&(t=e.phaseDisplay),_.isBoolean(e.disabled)&&e.disabled||!b||r?"":t},isDisabled:function(){return!b}})},events:{eventName:"tileAchievements:show:"+m,outputs:{showAchievements:{property:"show"}},scope:p},loadTier:i.firstTier}}(p,m.attrs.index)})},registerClickHandler:function(e,t){a.registerClickHandler(e,Sre,t)}}}function Gm(){function e(e,t){return{index:e,feedTypeConfig:t}}function t(t){for(var i=0,n=[],r=t.priority,o=t.limit,a=t.diminish;r;)if(r<0||o>=0&&i>=o)r=0;else{var s=e(i,t);s.tilePriority=r,n.push(s),r-=a,i++}return t.storiesAdded=i,n}return{generateList:function(i){for(var n=[],r=[],o=0;o<i.length;o++)i[o].position?r.push(i[o]):n.push.apply(n,t(i[o]));return n.sort(function(e,t){return t.tilePriority-e.tilePriority}),function(t,i){var n=0;if(t.sort(function(e,t){return e.position-t.position}),i.length>0)for(n=0;n<t.length;n++)i.splice(t[n].position-1,0,e(0,t[n]));else i=_.each(t,function(t){return i.push(e(0,t))})}(r,n),n}}}function Um(e){"ngInject";return e.get("PriorityEngineFactory",Gm,this,arguments)}function Bm(e,t,i,n,r,o,a,s){"ngInject";function c(e,t){return t.date-e.date}function l(e,t){return!_.isUndefined(e)&&_.get(t.catalog,"masterTitleId")===_.get(e,"masterTitleId")}function d(e,t){var i=t.quicklaunchDate,n=t.catalog,r=t.offerId,o=t.articleId,a=_.find(e,_.partial(l,n));_.isUndefined(a)?e.push({date:i,offerId:r,catalog:n,articleId:o}):i>a.date&&(a.date=i)}function g(e){return t.getCatalogInfo([e]).then(function(t){return t[e]}).catch(v(g.name))}function u(e){return Promise.all(_.map(e,function(e){return g(e.offerId)})).then(function(e){var t=_.find(e,function(e){return!i.isTrial(e)&&(r.isActive()||!n.isSubscriptionEntitlement(e.offerId))});return _.isUndefined(t)&&(t=_.find(e,function(e){return!i.isTrial(e)})),_.isUndefined(t)?_.head(e):t}).catch(v(u.name))}function p(e){return _.map(e,function(e){var t=e.productId||e.offerId,i=e.nogDate,r=_.isUndefined(e.latestAvailableDate)?e.lastPlayedDate:e.latestAvailableDate;return o.isNonOriginGame(t)?Promise.resolve({offerId:t,offerPath:t,quicklaunchDate:new Date(i).getTime()}):_.isUndefined(t)?void 0:function(e){return g(e).then(function(e){return u(n.getAllBaseGameEntitlementsByMasterTitleId(e.masterTitleId))})}(t).then(function(t){return{catalog:t,offerId:t.offerId,offerPath:t.offerPath,quicklaunchDate:new Date(r).getTime(),articleId:e.articleId}}).catch(v(p.name))})}function m(t){return new Promise(function(i){var n=[];_.forEach(t,_.partial(d,n)),n.sort(c),e.log("[QUICKLAUNCHFACTORY] RAW QuickLaunchList = ",n),i(_.slice(n,0,wre))})}function f(e){return Promise.all(_.flatten(_.map(e,function(e){return p(e)}))).catch(v(f.name))}function h(e){return _.map(e,function(e){return _.cloneDeep(_.slice(e,0,wre))})}var v=function(t){return function(i){return e.error("[QUICKLAUNCHFACTORY] "+t,i),[]}};return{getQuickLaunchList:function e(){return Promise.all([s.retrieveLatestInstalled(),o.retrieveNogs(),a.retrieveLastPlayedGames()]).then(h).then(f).then(m).catch(v(e.name))}}}function Mm(e,t,i,n,r,o,a){function s(){return i.userHasSubscription()&&i.userIsOnSupportedPlatform()}function c(){return i.userHasSubscription()&&!i.userIsOnSupportedPlatform()}function l(e,t){return{useThis:e,offerId:t}}function d(e){return l(!!e,e)}function g(e,t){v.push({directiveName:e,checkState:t})}function u(){return{}}function p(e,t){return function(i){return i[e]=_.merge(t,i[e]),n.slingDataToDom(i)}}function m(e,t){return function(){return n.buildTag(e,t)}}function f(e){return e.directiveName?e.offerId?function(e){return Promise.all([t.getOcdByOfferId(e.offerId).then(n.findDirectives("origin-game-defaults")).then(n.flattenDirectives("origin-game-defaults")).then(_.head).then((i=e.directiveName,function(e){var t={};return t[i]=e,t})),t.getOcdByOfferId(e.offerId).then(n.findDirectives(e.directiveName)).then(_.head)]).then(_.spread(_.merge)).then(r.maybe(p,[e.directiveName,{offerid:e.offerId,"origin-first-meaningful-paint":Tre}],m,[e.directiveName,{offerid:e.offerId,"origin-first-meaningful-paint":Tre}]));var i}(e):Promise.resolve(n.buildTag(e.directiveName,{"origin-first-meaningful-paint":Tre})):Promise.resolve()}var h,v=[];return g("origin-home-recommended-action-gift",function(){return e.getNextUnopenedGift().then(d)}),g("origin-home-recommended-action-justacquired",function(){return e.getJustAcquired().then(d)}),g("origin-home-recommended-action-submostrecentnotinstalled",function(){return e.getMostRecentSubsEntitlementNotInstalled().then(d)}),g("origin-home-recommended-action-trial",function(){return e.getNewestTrial(!1).then(d)}),g("origin-home-recommended-action-trial",function(){return e.getNewestTrial(!0).then(d)}),g("origin-home-recommended-action-newreleased",function(){return e.getNewestRelease().then(d)}),g("origin-home-recommended-action-preload",function(){return e.getNewestPreload().then(d)}),g(null,function(){return e.getBaseGameEntitlements().then(function(e){return l(Origin.user.underAge()&&!e.length)})}),g("origin-home-recommended-action-downloadedrecently",function(){return e.getDownloadedGameNewerLastPlayed().then(d)}),g("origin-home-recommended-action-subnotplayable",function(){return e.getBaseGameEntitlements().then(function(e){return l(s()&&!e.length)})}),g("origin-home-recommended-action-nonsubnotplayable",function(){return e.getBaseGameEntitlements().then(function(e){return l(!e.length&&(!s()||c()))})}),g("origin-home-recommended-action-nonsubnotrecentlyplayed",function(){return e.getPlayedAGameRecently(30).then(function(e){return l(!e&&(!s()||c()))})}),g("origin-home-recommended-action-subnotrecentlyplayed",function(){return e.getPlayedAGameRecently(30).then(function(e){return l(s()&&!e)})}),g("origin-home-recommended-action-lastgameplayed",function(){return e.getLastPlayedGame().then(d)}),g("origin-home-recommended-action-subrecentlycanceled",(h="origin-home-recommended-action-subrecentlycanceled",function(){var e=Number(o.getLocalizedStr(null,h,"daysSinceCancel"))||15,t=i.isExpired()&&a.isSubscriptionExpiredForAtLeastNumDays(i.getExpiration(),e);return Promise.resolve(l(t))})),g(null,function(){return Promise.resolve(l(!0))}),{getStoryDirective:function(){return function(){var e,t=v[v.length-1],i=null,n=[];for(e=0;e<v.length;e++)n.push(v[e].checkState().catch(u));return Promise.all(n).then(function(e){for(var n=0;n<e.length;n++)if((i=e[n]).useThis){(t=v[n]).offerId=i.offerId||null;break}return t})}().then(f)}}}function jm(e,t,i,n,r,o,a,s){"ngInject";return s.get("RecommendedStoryFactory",Mm,this,arguments)}function Hm(e,t,i,n,r){"ngInject";function o(e){return e.achievementSetPCWIN?i.getAchievementSet(Number(Origin.user.personaId()),e.achievementSetPCWIN):null}var a="otkex-hometile-achievements",s=new Origin.utils.Communicator;return{events:s,registerHandlersIndexedOfferId:function(i){t.registerComponentHandlersIndexed(i,function(t,i){if(i.name===a&&!_.isUndefined(i.attrs.index))return function(t,i){return{name:a,promises:[n.getCatalogInfo([i]).then(function(e){return r.transform({achievementSetPCWIN:["platforms","PCWIN","achievementSet"]},e[i])}).then(o)],spread:function(e,n){var r=_.isNull(e);r?_.each({show:!1},n):_.each({show:!0,completedAchievements:e.grantedXp(),totalAchievements:e.totalXp()},n),t.$emit("tileAchievements:show:"+i,{show:!r}),s.fire("tileAchievements_broadcast:show:"+i,{show:!r})},loadTier:e.secondTier}}(t,i.attrs.index)})},registerClickHandler:function(e,i){t.registerClickHandler(e,a,i)}}}function zm(e,t,i,n,r,o,a){"ngInject";function s(t,i){return e(i.inlineMessages)(t)}function c(e,n){return{name:l,promises:[r.getCatalogInfo([n]),i.isTrialExpired(e.offerId)],spread:function(t,i,r){var c=t[n];c.trial&&function(e,t){a.events.once(Ey.Q+":"+t,function(i){e.$emit(u+":"+t,{text:i})}),o.getModel(t,d,g).then(_.partial(s,e))}(e,n),_.each({show:c.trial,text:"",expired:c.trial&&i},r)},events:{eventName:u+":"+n,outputs:{text:{property:p}},scope:e},loadTier:t.secondTier}}var l="otkex-tile-trialtime",d="quicklaunchtrial",g=1,u="trialtime:text",p="text";return{registerHandlersIndexedOfferId:function(e){n.registerComponentHandlersIndexed(e,function(e,t){if(t.name===l&&!_.isUndefined(t.attrs.index))return c(e,t.attrs.index)})}}}function Vm(e,t,i,n,r,o,a,s){"ngInject";var c="otkex-hometile-violator",l={test:s.getLocalizedStr(null,"origin-game-badge","test"),new:s.getLocalizedStr(null,"origin-game-badge","new"),trial:s.getLocalizedStr(null,"origin-game-badge","trial"),alpha:s.getLocalizedStr(null,"origin-game-badge","alpha"),beta:s.getLocalizedStr(null,"origin-game-badge","beta"),demo:s.getLocalizedStr(null,"origin-game-badge","demo")};return{registerHandlersIndexedOfferId:function(o){t.registerComponentHandlersIndexed(o,function(t,o){if(o.name===c&&!_.isUndefined(o.attrs.index))return a=o.attrs.index,{name:c,promises:[n.getCatalogInfo([a]),i.getEntitlement(a)],spread:function(e,t,i){var n,o,s,c,d,g,u,p=e[a],m=r.isPrivate(t),f=_.get(t,"isNew",!1),h={};n=m,o=p.alpha,s=p.beta,c=p.trial||p.earlyAccess,d=p.demo,g=f,u={type:"",text:""},n?(u.type="test",u.text=l.test):c?(u.type="trial",u.text=l.trial):g?(u.type="new",u.text=l.new):o?(u.type="alpha",u.text=l.alpha):s?(u.type="beta",u.text=l.beta):d&&(u.type="demo",u.text=l.demo),h=u,_.each({show:m||p.alpha||p.beta||p.trial||p.earlyAccess||p.demo||f,violator:h.type,text:h.text},i)},loadTier:e.secondTier};var a})}}}function Wm(e,t,i,n){"ngInject";function r(e){return _.intersection(_.first(e),_.last(e))}function o(e){return _.reduce(e,function(e,t){var i=_.get(t,[Dre,Rre]),n=_.get(t,[Fre,xre,Lre,Are]);return e[i]=n,e},{})}function a(e){return e&&e.length?Promise.all(function(e){for(var t=[],i=0;i<e.length;i+=10){var n=_.slice(e,i,i+10);t.push(Origin.ups.getUserProfile("game-platform",n))}return t}(e)).then(_.flatten).then(o):Promise.resolve({})}function s(e){return d().then(function(t){return _.get(t,e,0)}).catch(function(e){return l(e),0})}function c(t){return e.error("[Origin-Home-UpsFactory Factory logError] error",t),[]}function l(t){return e.error("[Origin-Home-UpsFactory Factory logError] error",t),!1}var d=n.decorate(function(){var e=t.getBaseGameEntitlements(),n=_.map(e,DI.Y);return n&&n.length?Promise.all([Origin.ups.getGames().then(_.keys).catch(c),i.getMasterTitleByOfferIds(n)]).then(r).then(a).catch(c):Promise.resolve({})},$re);return{isBetweenGameSessions:function(e,t){return s(e).then(function(e){return 1<=e&&e<=t}).catch(l)},isGameSessionsGreaterThan:function(e,t){return s(e).then(function(e){return e>t}).catch(l)},isGameSessionsEqualsZero:function(e){return s(e).then(function(e){return 0===e}).catch(l)}}}function qm(e,t,i,n,r,o){"ngInject";function a(e){if("true"===e.isUnread)return e}function s(e){return{items:e,unreadItemsCount:_.filter(e,a).length}}function c(){return i.retrieveInboxData().then(s)}return{getObserver:function(i,a){function s(){d.commit.apply(d)}var l,d=e.observe({items:[],unreadItemsCount:0});return l=[n.events.on("games:baseGameEntitlementsUpdate",s),r.events.on("GamesCatalogFactory:catalogUpdated",s),r.events.on("GamesCatalogFactory:offerStateChange",s)],i.$on("$destroy",function(){o.detachAll(l)}),t.create(d).addFilter(_.spread(c)).onUpdate(i,a,t.noDigest)}}}function Ym(e){"ngInject";function t(e){return _.omit(e,["isUnread"])}function i(t){e.set(Ure,t)}function n(t){e.set(Bre,t)}return{getInboxItemsFromStorage:function(){return e.get(Gre,[])},getPremierInboxItemsTimeStampFromStorage:function(){var t=e.get(Ure,{});return t=_.isObject(t)?t:{}},getPremierNewEntitledInboxItemsFromStorage:function(){return e.get(Bre,[])},setInboxItemsInStorage:function(i){var n=_.map(i,t);e.set(Gre,n)},setPremierInboxItemsTimeStampInStorage:i,setPremierNewEntitledInboxItemsInStorage:n,cleanInboxPremierNotificationItems:function(){n([]),i({})}}}function Km(e){"ngInject";var t=Origin.utils.os(),i={};return{isPremierNotification:function(i){var n=_.get(i,[DI._15,t,DI._28]);return!e.isInTheFuture(n)&&e.isInTheFuture(e.addDays(n,jre))},addOfferToPremierGameNotificationList:function(e){var t=_.get(e,DI.Y,"");i[t]=e},getPremierGameNotificationList:function(){return i},isInPremierGameNotificationList:function(e){return!_.isUndefined(i[e])}}}function Qm(e,t,i,n,r,o,a){function s(){return T.forEach(a.updateGameModelExtraProperties),a.hideLesserEditions(T)}function c(e){T=n.baseGameEntitlements({includeAllExternalTypes:!0}).map(function(t){var i=a.createGameModel(e[t.offerId]);return i.externalType=t.externalType,i})}function l(){var e=n.baseGameEntitlements().map(w("offerId"));return i.getCatalogInfo(e).then(c).catch(function(e){o.error("[SEARCHFACTORY] GamesCatalogFactory.getCatalogInfo",e)})}function d(){return new Promise(function(e){n.initialRefreshCompleted()?e():n.events.once("games:baseGameEntitlementsUpdate",e)})}function g(t){for(var i=[],n=decodeURI(e.searchString).toLowerCase().split(/\s+/),r=0;r<t.length;r++)null!==t[r].displayName&&u(t[r].displayName.toLowerCase(),n)&&i.push(t[r]);return i}function u(e,t){for(var i=0,n=0;n<t.length;++n){if(-1===(i=e.indexOf(t[n],i)))return!1;i+=t[n].length}return!0}function p(e){o.error("[SEARCH FACTORY - GAMES] Entitlement retrievel error",e),Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_error","user","search_error",{error:e.message})}function m(e){return o.error("SEARCHFACTORY - waitForAuthReady error:",e),Promise.resolve({})}function f(e){var t={};return t.store=function(e){var t=_.get(e,["games","game"],[]),i=_.get(e,["games","numFound"],0);if(i>0)return{games:t,totalFound:i}}(e[0]),t.people=function(e){var t=_.get(e,"infoList",[]),i=_.get(e,"totalCount",0);if(i>0)return{users:t,totalFound:i}}(e[1]),t}function h(e,t){if(t.oth===Vre[e])return t.offerPath}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _.isArray(e)||(e=e.split(",")),Promise.all(_.map(e,function(e){var t=e.split("|"),n=zre(t,2),r=n[0],o=n[1];return _.isUndefined(o)?Promise.resolve(r):i.getCatalogByPath(r).then(_.values).then(_.first).then(_.partial(h,o)).catch(angular.noop)})).then(_.compact)}function b(e,t){var i="",n="";return Promise.all([v(e),v(t)]).then(function(e){var t=zre(e,2),r=t[0],o=t[1];return r.length&&(i=_.map(r,function(e){return"path:"+e}).join(sW)),o.length&&(n=_.map(o,function(e){return"-path:"+e}).join(aW)),{whiteListQuery:i,blackListQuery:n}})}function y(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";n&&(n=_.map(function(e){return _.isArray(e)?e:e.split(",")}(n),function(e){return e.trim()}).join(aW));var r=encodeURIComponent(n),o=t&&r?""+t+sW+"("+r+")":r,a=o?"("+o+")":"";return e+"=("+_.filter([a,i]).join(aW)+")"}function S(e,t,i){var n=_.keys(e),r=void 0;return n.length>0&&(r=_.compact(_.map(n,function(n){var r=e[n];return"filterQuery"===n?t||i?y(n,t,i,r):(r=function(e){return _.isArray(e)?_.map(e,function(e){return e.trim()}).join(","):e.trim()}(r),n+"="+encodeURIComponent(r)):n+"="+encodeURIComponent(r)})).join("&")),n.indexOf("filterQuery")<0&&(t||i)&&(t=t?"("+t+")":"",r=r+"&filterQuery=("+_.filter([t,i]).join(aW)+")"),r}function k(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(e,t,i){return b(t,i).then(function(t){var i=t.whiteListQuery,n=t.blackListQuery;return S(e,i,n)})}(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i).then(_.partial(Origin.search.searchStore,e)).catch(function(e){return o.error("SEARCHFACTORY - store service error:",e),Origin.telemetry.sendTelemetryEvent("TRACKER_DEV","search_error","user","search_error",{error:e.message}),Promise.reject(e)})}function I(i,n){var r=i||decodeURI(e.searchString);return t.waitForAuthReady().then(function(e,t){return function(i){return i.isLoggedIn?Origin.search.searchPeople(e,t):Promise.resolve({})}}(r,n)).catch(m)}var w=r.getProperty,C=[],T=[],P={sort:Wre,start:0,rows:20};return{searchStore:k,searchGames:function(){return t.waitForAuthReady().then(d).then(l).then(n.waitForFiltersReady).then(s).then(g).catch(p)},searchStoreAndPeople:function(t){var i=decodeURI(e.searchString),n=Object.assign({},P,t);return C=[k(i,n),I(i,0)],Promise.all(C).then(f)},searchPeople:I,getWhiteBlackListQueries:b}}function Jm(e,t,i,n,r,o,a,s){"ngInject";return s.get("SearchFactory",Qm,this,arguments)}function Xm(e,t,i,n){"ngInject";function r(e,t,i,n){_.each({imgAlt:t.EAID,imgSrc:i,showPresence:n},e)}function o(t,i){return function(n,o){return function(t,i,n,o){var a=n===Origin.defines.avatarSizes.XSMALL?Origin.defines.avatarSizes.SMALL:n,s={name:g[n],promises:[f(i,a),m(i)],spread:function(e,t,i){r(i,t,e,o)},loadTier:e.firstTier};return o&&(s.promises.push(p(i)),s.spread=function(e,i,n,a){u(n,t,a,{isOnline:function(e){return"ONLINE"===e.show},isBroadcasting:function(e){return e.isBroadcasting},isJoinable:function(e){return e.isJoinable&&e.isCompatiblePlatform},isAway:function(e){return"AWAY"===e.show},isOffline:function(e){return"UNAVAILABLE"===e.show},isInGame:function(e){return"INGAME"===e.show}}),r(a,i,e,o)}),s}(n,o,t,i)}}function a(e,t){return function(i){i.stopPropagation(),e(t)}}function s(e){return function(t,i){n.registerComponentHandlersIndexed(t,e,i)}}var c="otkex-avatar",l="otkex-avatar-x-small",d="otkex-avatar-small",g={},u=n.onObserverUpdate,p=t.getFriendPresenceObserver,m=i.getUserInfo,f=i.getAvatar;return g[Origin.defines.avatarSizes.XSMALL]=l,g[Origin.defines.avatarSizes.SMALL]=d,g[Origin.defines.avatarSizes.MEDIUM]="otkex-avatar-medium",g[Origin.defines.avatarSizes.LARGE]="otkex-avatar-large",{getLargeAvatarHandler:o(Origin.defines.avatarSizes.LARGE,!1),getLargeAvatarPresenceHandler:o(Origin.defines.avatarSizes.LARGE,!0),getMediumAvatarHandler:o(Origin.defines.avatarSizes.MEDIUM,!1),getMediumAvatarPresenceHandler:o(Origin.defines.avatarSizes.MEDIUM,!0),getSmallAvatarHandler:o(Origin.defines.avatarSizes.SMALL,!1),getSmallAvatarPresenceHandler:o(Origin.defines.avatarSizes.SMALL,!0),onAvatarClick:function(e,t,i){n.registerClickHandler(e,c,a(t,i))},onIndexedAvatarClick:function(e,t,i){n.registerClickHandler(e,c,function(e,n){var r=t[n.attrs.index];_.isUndefined(r)||(i(r),e.stopPropagation())})},onAvatarMouseEnter:function(e,t,i){n.registerMouseEnterHandler(e,c,a(t,i))},onAvatarMouseLeave:function(e,t,i){n.registerMouseLeaveHandler(e,c,a(t,i))},registerSmallHandlersIndexedNucleusId:function(e){n.registerComponentHandlersIndexed(e,function(e,t){if(t.name===d&&!_.isUndefined(t.attrs.index))return o(Origin.defines.avatarSizes.SMALL,!1)(e,t.attrs.index)})},registerSmallHandlersIndexed:s(o(Origin.defines.avatarSizes.SMALL,!1)),registerSmallPresenceHandlersIndexed:s(o(Origin.defines.avatarSizes.SMALL,!0)),registerXSmallHandlersIndexedNucleusId:function(e){n.registerComponentHandlersIndexed(e,function(e,t){if(t.name===l&&!_.isUndefined(t.attrs.index))return o(Origin.defines.avatarSizes.XSMALL,!1)(e,t.attrs.index)})}}}function Zm(e,t,i,n){"ngInject";function r(r,o,a){return{name:o,promises:[i.getFriendsPlayingObservable(a)],spread:function(e,i){t.onObserverUpdate(n.create(e),r,i,{avatarIndexArray:function(e){return e.list}})},loadTier:e.firstTier}}function o(e){return function(i){t.registerComponentHandlersIndexed(i,function(t,i){if(i.name===e&&!_.isUndefined(i.attrs.index))return r(t,e,i.attrs.index)})}}return{getAvatarListHandler:r,registerXSmallHandlersIndexedOfferId:o("otkex-avatarlist-x-small"),registerSmallHandlersIndexedOfferId:o("otkex-avatarlist-small")}}function ef(){function e(e){t.fire("raiseConversation",e)}var t=new Origin.utils.Communicator,i=!1,n=!1,r=[],o=[];return{events:t,openConversation:function(e){t.fire("openConversation",e)},raiseConversation:e,closeWindow:function(e){void 0===e&&(e=!1),t.fire("closeChatWindow",e)},minimizeWindow:function(){i=!0,t.fire("minimizeChatWindow")},unminimizeWindow:function(){i=!1,t.fire("unminimizeChatWindow")},popOutWindow:function(){t.fire("popOutChatWindow")},unpopOutWindow:function(){t.fire("unpopOutChatWindow")},isWindowMinimized:function(){return i},isWindowPoppedOut:function(){return!angular.isUndefined(this.poppedOutChatWindow)&&null!==this.poppedOutChatWindow},visibleTabIds:function(){return r},overflowTabIds:function(){return o},selectTab:function(e){t.fire("selectTab",e)},setOIGContext:function(e){n=e},isOIGWindow:function(){return n},raiseConversationByKeyIndex:function(t){var i=-1;if(0!==r.length){if(t>=Qre)i=o.length?_.last(o):_.last(r);else{var n=r.concat(o);t<n.length&&(i=n[t])}_.isUndefined(i)||-1===i||e(i)}},poppedOutChatWindow:null,playingGames:[]}}function tf(e){"ngInject";return e.get("ChatWindowFactory",ef,this,arguments)}function nf(e,t,i,n,r){function o(e){if(e.accepted){var t=e.content.searchText;n.goToState("app.search",{searchString:decodeURI(t),category:"people"})}}function a(){var e=r.getLocalizedStrGenerator(Xre),i=t.createDirective("origin-dialog-content-searchforfriends",{placeholderstr:e(null,"searchfriendsinputplaceholdertext")});t.openPrompt({id:"origin-dialog-content-searchforfriends-id",title:e(null,"searchfriendstitle"),description:e(null,"searchfriendsdescription"),acceptText:e(null,"searchfriendssearchbuttontext"),acceptEnabled:!1,rejectText:e(null,"searchfriendscancelbuttontext"),defaultBtn:"yes",contentDirective:i,callback:o})}return Origin.events.on(Origin.events.CLIENT_NAV_OPENMODAL_FINDFRIENDS,a),i.events.on("myauth:clientonlinestatechangeinitiated",function(e){e&&!e.isOnline&&t.close("origin-dialog-content-searchforfriends-id")}),{findFriends:a}}function rf(e,t,i,n,r,o){"ngInject";return o.get("FindFriendsFactory",nf,this,arguments)}function of(){var e=new Origin.utils.Communicator,t=!1,i=!1;return{events:e,minimizeWindow:function(){i=!0,e.fire("minimizeHub")},unminimizeWindow:function(){i=!1,e.fire("unminimizeHub")},focusWindow:function(){t&&e.fire("focusHub")},popOutWindow:function(){t=!0,e.fire("popOutHub")},unpopOutWindow:function(){t=!1,e.fire("unpopOutHub")},isWindowMinimized:function(){return i},isWindowPoppedOut:function(){return t}}}function af(e){"ngInject";return e.get("SocialHubFactory",of,this,arguments)}function sf(e,t,i){function n(e){if(e.accepted){var t=e.content.userList;angular.forEach(t,function(e){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_GAME_INVITE_SENT,{label:"In Game"}),Origin.xmpp.inviteToGame(e)})}}return i.events.on("myauth:clientonlinestatechangeinitiated",function(t){t&&!t.isOnline&&e.close("origin-dialog-content-invite-users-id")}),{inviteUsersToGame:function(i){var r=e.createDirective("origin-dialog-content-inviteusers",{gametitlestr:i});e.openPrompt({id:"origin-dialog-content-invite-users-id",title:t.getLocalizedStr(null,toe,"invite-user-dialog-title-text"),acceptText:t.getLocalizedStr(null,toe,"invite-user-dialog-invite-text"),acceptEnabled:!1,rejectText:t.getLocalizedStr(null,toe,"invite-user-dialog-cancel-text"),defaultBtn:"yes",contentDirective:r,callback:n})}}}function cf(e,t,i,n){"ngInject";return n.get("InviteUsersFactory",sf,this,arguments)}function lf(e,t,i,n){function r(i,n,r){setTimeout(function(){e.openPrompt({id:"social-join-game-not-owned",title:r.unableToJoinText,description:r.notOwnedText.replace("%game%",n),acceptText:r.viewInStoreText,acceptEnabled:!0,rejectText:r.closeText,defaultBtn:"yes",callback:function(e){return function(i){i.accepted&&t.buyNow(e)}}(i)})},0)}return i.events.on("myauth:clientonlinestatechangeinitiated",function(t){t&&!t.isOnline&&(e.close("social-join-game-not-owned"),e.close("social-join-game-not-installed"))}),{joinFriendsGame:function(e,i,o,a,s){Origin.client.isEmbeddedBrowser()&&(n.ownsEntitlement(i)?Origin.xmpp.joinGame(e):t.getBaseGameEntitlementByMultiplayerId(o).then(function(t){t?Origin.xmpp.joinGame(e):r(i,a,s)}))},ignoreGameInvite:function(e){Origin.xmpp.ignoreGameInvite(e)}}}function df(e,t,i,n,r){"ngInject";return r.get("JoinGameFactory",lf,this,arguments)}function gf(e,t,i,n,r){function o(t){e.openAlert({id:"origin-dialog-content-reportuser-thankyou-id",title:t.title,description:t.thankYouText,rejectText:t.closeText})}function a(e,t){o(t)}function s(e){n.error("origin-dialog-content-reportuser atomReportUser:",e),o()}function c(t,i){var n=e.createDirective("origin-dialog-content-reportuser",{userid:t.userid,username:t.username,mastertitle:t.mastertitle}),o=_.get(t,"dialogStrings",{});o.title=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-title-text"),o.submitText=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-submit-text"),o.cancelText=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-cancel-text"),o.closeText=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-close-text"),o.thankYouText=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-thank-you-text"),o.confidentialText=r.getLocalizedStr(null,"origin-profile-header","report-user-dialog-confidential-text"),e.openPrompt({id:"origin-dialog-content-reportuser-id",size:"large",title:o.title,description:o.confidentialText,acceptText:o.submitText,acceptEnabled:!1,rejectText:o.closeText,defaultBtn:"yes",contentDirective:n,callback:_.partialRight(l,o),spalocation:i,sublocation:t.userid})}function l(e,i){t.events.off("cppDialog:finished",l),e.accepted&&Origin.atom.atomReportUser(e.content.userId,e.content.whereSelection,e.content.whySelection,e.content.comment,e.content.masterTitle).then(_.partialRight(a,i)).catch(s)}return i.events.on("myauth:clientonlinestatechangeinitiated",function(t){t&&!t.isOnline&&(e.close("origin-dialog-content-reportuser-id"),e.close("origin-dialog-content-reportuser-thankyou-id"))}),{reportUser:c,handleReportUser:function(e,t){Origin.atom.atomUserInfoByUserIds([e]).then(function(i){var n=i[0].EAID;c({userid:e,username:n,mastertitle:t},"PROFILE")}).catch(function(e){n.error("OriginProfileHeaderCtrl: Origin.atom.atomUserInfoByUserIds failed",e)})}}}function uf(e,t,i,n,r,o){"ngInject";return o.get("ReportUserFactory",gf,this,arguments)}function pf(e,t){"ngInject";function i(i,n){return new Promise(function(r){_.isUndefined(i)?function(i){return new Promise(function(n,r){e.getRosterUser(i).then(function(e){_.isUndefined(e)?r("RosterDataFactory.getRosterUser "+i+" is undefined."):n(t.create(e._presence).defaultTo({jid:i,show:"UNAVAILABLE",gameActivity:{}}))})})}(n).then(function(e){r(i=e)}):r(i)})}var n=[];return{getFriendPresenceObserver:function(e){return i(n[e],e)},getSelfPresenceObserver:function(){return i(void 0,Origin.user.userPid())}}}function mf(e,t,i){function n(e,t,i){return{nucleusId:e,state:t,originId:i}}function r(t){var i=t.event,r=Number(t.nucleusId),o=d.findIndex(function(e){return e.nucleusId===r});if(-1===o&&(o=d.push(n(r,"",""))-1),"OUTGOING"!==d[o].state||"INCOMING"!==i){switch(i){case"INCOMING":Origin.voice.playIncomingRing(),g.data.hasIncomingCall=!0;break;case"OUTGOING":g.data.isCalling=!0,Origin.voice.playOutgoingRing();break;case"STARTED":Origin.voice.stopIncomingRing(),Origin.voice.stopOutgoingRing(),p=r,g.data.isInVoice=!0,g.data.isCalling=!1,g.data.hasIncomingCall=!1,g.commit(),angular.isDefined(c)||(u.data.seconds=0,c=e(function(){++u.data.seconds,u.commit()},1e3));break;case"ENDED":case"NOANSWER":Origin.voice.stopOutgoingRing(),g.data.isCalling=!1,s(),g.data.isInVoice=!1,g.commit(),p=0;break;case"MISSED":case"ENDED_INCOMING":Origin.voice.stopIncomingRing(),p?g.data.hasIncomingCall=!1:a();break;case"INACTIVITY":case"ENDED_UNEXPECTEDLY":case"CONNECT_ERROR":a()}d[o].state=t.event,l.fire("voiceCallEvent",t)}}function o(e){l.fire("voiceLevel",e)}function a(){s(),g.data.isInVoice=!1,g.data.isCalling=!1,g.data.hasIncomingCall=!1,g.commit(),p=0}function s(){angular.isDefined(c)&&(e.cancel(c),c=void 0),u.data.seconds&&(u.data.seconds=0,u.commit())}var c,l=new Origin.utils.Communicator,d=[],g=i.observe({isInVoice:!1,isCalling:!1,isLocalMuted:!1,hasIncomingCall:!1}),u=i.observe({seconds:0}),p=0,m=!1,f="";return{init:function(){Origin.events.on(Origin.events.VOICE_CALL,r),Origin.events.on(Origin.events.VOICE_LEVEL,o),Origin.voice.supported()&&Origin.voice.audioInputDevices().then(function(e){Origin.voice.selectedAudioInputDevice().then(function(i){f=i,0===e.length&&(m=!0),Origin.events.on(Origin.events.VOICE_DEVICE_ADDED,t.reverseThrottle(function(e){Origin.voice.supported()&&Origin.voice.selectedAudioInputDevice().then(function(e){m?(m=!1,l.fire("voiceInputDeviceChanged",e)):e!==f&&(f=e,l.fire("voiceInputDeviceChanged",e))})},1e3)),Origin.events.on(Origin.events.VOICE_DEVICE_REMOVED,t.reverseThrottle(function(){Origin.voice.supported()&&Origin.voice.audioInputDevices().then(function(e){0===e.length?(m=!0,l.fire("voiceInputDeviceChanged")):Origin.voice.selectedAudioInputDevice().then(function(e){e!==f&&(f=e,l.fire("voiceInputDeviceChanged",e))})})},1e3))})})},events:l,activeVoiceConversationId:function(){return p},setActiveVoiceConversationId:function(e){p=e},incomingVoiceConversationId:function(){var e=d.find(function(e){return"INCOMING"===e.state});return _.get(e,["nucleusId"],0)},voiceCallInfoForConversation:function(e){var t=d.find(function(t){return t.nucleusId===e});return angular.isUndefined(t)?{nucleusId:e,state:"",originId:""}:t},setVoiceCallInfoForConversation:function(e,t,i){var r=d.findIndex(function(t){return t.nucleusId===e});-1!==r?(d[r].state=t,d[r].originId=i):d.push(n(e,t,i))},toggleMute:function(){return g.data.isLocalMuted=!g.data.isLocalMuted,g.data.isLocalMuted?Origin.voice.muteSelf():Origin.voice.unmuteSelf(),g.data.isLocalMuted},voiceCallObservable:function(){return g},voiceCallDurationObservable:function(){return u}}}function ff(e,t,i,n){"ngInject";return n.get("VoiceFactory",mf,this,arguments)}function hf(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(e){t.search(e,null)}function g(t){var i={checkoutType:r.DEFAULT,invoiceSource:_.get(e,"invoiceSource")};return d(soe),d(doe),o.buy(_.get(t,"offerId"),i)}function u(e){return d(coe),d(doe),a.loginAndStartGiftingFlow(e)}function p(e,t){return l.isCollapseButtonVisible(e)&&(t.collapseState=!1),d(loe),d(doe),s.enqueue("addOfferToWishlistODC",{offerId:_.get(e,"offerId")})}function m(){return e.giftInvoiceSource?u:e.wishlistInvoiceSource?p:g}function f(t){if(e.offerId)return n.getCatalogInfo([e.offerId]).then(function(i){return m()(_.get(i,e.offerId),t)});m()(_.get(t,"model"),t)}function h(t){var i;return d(i=e.giftInvoiceSource?coe:e.wishlistInvoiceSource?loe:soe),d(doe),c.showDialog(i),Promise.resolve(t)}return{handleAutoActions:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t){return!t&&(_.isString(e.invoiceSource)||_.isString(e.giftInvoiceSource)||_.isString(e.wishlistInvoiceSource))}(t)?(t=!0,i.promiseLogin().then(_.partial(f,n)).catch(_.partial(h,n))):Promise.resolve(n)}}}function vf(e,t,i){"ngInject";function n(e,t){return _.set(e,"baseGameModel",_.head(_.values(t))),Promise.resolve(e)}function r(e){return Promise.resolve(e)}return{setBasegame:function(o){return i.isBaseGameModelRequired(o.model)?function(i){return e.getLowestRankedPurchasableBasegameOfferId(_.get(i,"selectedModel")).then(_.castArray).then(e.getCatalogInfo).then(t.transformOffer).then(_.partial(n,i))}(o).catch(_.partial(r,o)):Promise.resolve(o)}}}function bf(e,t,i){"ngInject";function n(e,t){return t.push(e),t}function r(e,i){return t.isBaseGameOfferType(e.model)&&(_.set(e,"earlyAccessTrialModel",_.head(_.filter(i,{earlyAccess:!0}))),_.set(e,"trialModels",_.filter(i,{trial:!0})),_.set(e,"demoModels",_.filter(i,{demo:!0})),_.set(e,"betaModels",_.filter(i,{beta:!0}))),i}function o(e,i){return t.isPurchasable(i)&&!t.isAlphaTrialDemoOrBeta(i)&&(t.isBaseGameOfferType(i)||_.get(i,"type")===e)}function a(e,i){var n=_.get(e,"weight",0),r=_.get(i,"weight",0),o=_.get(e,"releaseDate"),a=_.get(i,"releaseDate");return n!==r?r-n:t.isCurrency(e)?_.get(e,"price",0)-_.get(i,"price",0):_.isDate(o)&&_.isDate(a)&&o.valueOf()!==a.valueOf()?a.valueOf()-o.valueOf():0}function s(e,i){return!t.isAlphaTrialDemoOrBeta(i)&&(t.isBaseGameOfferType(i)||_.get(i,"type")===e)}function c(e,t){var i=_.get(e,["model","type"]),n=_.filter(t,_.partial(o,i));return _.set(e,"editions",_.filter(t,_.partial(s,i))),_.size(n)>1&&_.set(e,"purchasableEditions",n.sort(a)),Promise.resolve(e)}function l(t){return function(i){(function(e){var t=e.split("/").pop();return-1===poe.indexOf(t)})(i)&&t.push(e.getByOcdPathPromise(i,!1,!0))}}function d(e){return Promise.resolve(e)}return{setEditions:function(e){var o=_.get(e,"model"),a=_.get(o,"siblings",{});if(!t.isBaseGameOfferType(o)&&!t.isCurrency(o)||_.isEmpty(a))return Promise.resolve(e);var s=[];return _.forEach(a,l(s)),Promise.all(s).then(i.unwrapEditions).then(_.partial(n,_.get(e,"model"))).then(_.partial(r,e)).then(_.partial(c,e)).catch(_.partial(d,e))}}}function yf(e,t,i,n,r,o,a,s,c){"ngInject";function l(e){var i=_.head(_.values(e));return _.isEmpty(i)||_.get(i,"error")===UI.p?Promise.reject({reason:foe,model:i}):t.isPurchasable(i)||t.hasSiblings(i)||c.isAnnouncement(i)?t.isPurchasable(i)||!t.hasSiblings(i)||c.isAnnouncement(i)?_.isString(i.freeBaseGame)&&!t.isExpansion(i)?Promise.reject({reason:yoe,model:i}):Promise.resolve(i):Promise.reject({reason:voe,model:i}):Promise.reject({reason:hoe,model:i})}function d(t,i){return _.set(t,"model",i),_.set(t,"selectedModel",i),_.set(t,"truncatedLongDescription",e("limitHtml")({text:_.get(i,"longDescription"),limit:Soe,truncationString:"&hellip;",breakOnBrTag:!1,preserveInlineStyles:!0})),Promise.resolve(t)}function g(e,t){var a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{throwError:!0}).throwError;return n.getByOcdPathPromise(t).then(l).catch(function(e){!function(e,t){t&&(e.reason===hoe?i.goToState("app.store.wrapper.browse",{},{location:!1}):e.reason===voe?r.getFirstAvailableSibling(e.model).then(function(e){o.goToPdp(e)},function(){i.goToState(boe)}):e.reason===yoe&&e.model?o.goToPdp(e.model):o.buildPathFromUrl()&&i.goToState(boe))}(e,a)}).then(_.partial(d,e))}var u=new Origin.utils.Communicator;return{events:u,setModel:g,setModelAndListenForChanges:function(e,t,i){function n(t){_.set(e,"model",t),function(e,t){_.isFunction(t)?t():s.digestIfDigestNotInProgress(e)}(e,i)}var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{throwError:!0}).throwError;return u.on(a.eventName,n),e.$on("$destroy",n),g(e,t,{throwError:r})},listenForCollectionUpdate:function(e,t,i){function r(t){var n=i?[_.get(e,["model","offerId"])]:_.map(e.editions,"offerId");_.isEmpty(n)&&(n=[_.get(e,["model","offerId"])]),_.size(_.intersection(t,n))>0&&o()}var o=_.debounce(t,100);n.events.on("OCD:updateCollection",r),e.$on("$destroy",function(){n.events.off("OCD:updateCollection",r)})}}}function Sf(e,t,i,n,r,o){"ngInject";function a(e){return _.get(e,"isOwned",!1)&&!_.get(e,["trialTimeRemaining","success"],!0)}var s=e.userHasSubscription,c=t.isOnTheHouse,l=i.isLesserEditionInVault,d=i.isGreaterEditionInVault,g=r.isReleased,u=o.ownsLesserEdition,p=o.ownsGreaterEdition,m=n.isUpgradeable,f=n.isVaultGameOrUpgradeable,h=o.ownsGreaterEditionNotVault;return{isActiveTrial:function(e){return _.get(e,"isOwned",!1)&&_.get(e,["trialTimeRemaining","hasTimeLeft"],!0)&&!a(e)},isUnknownTrial:a,isExpiredTrial:function(e){return _.get(e,"isOwned",!1)&&!_.get(e,["trialTimeRemaining","hasTimeLeft"],!0)&&!a(e)},showNonSubscriberUpsell:function(e,t,i,n){return!s()&&!l(e,t)&&!d(e,t)&&!c(e)&&(!_.isUndefined(i)||_.get(e,"hasSubsDiscount",!1)||n)},showAlternateVaultEditionUpsell:function(e,t){return!s()&&!c(e)&&!_.get(e,"vault",!1)&&(l(e,t)||d(e,t))},showOthSubscriptionsUpsell:function(e){return c(e)&&f(e)&&!_.get(e,"vaultEntitlement",!1)&&!s()},showSubscriberUpsell:function(e,t,i,n){return s()&&(!_.get(e,"isOwned",!1)||!g(e))&&(!_.isUndefined(i)||n)&&(!u(t,e)&&!p(t,e)||!g(e))},showSubscriberUpgradeArea:function(e,t,i){return s()&&!_.isUndefined(i)&&!c(e)&&(u(t,e)||_.get(e,"isOwned",!1))&&!_.get(i,"isOwned",!1)&&m(e)},isEarlyAccessTrialReleased:function(e){return g(e)},isTrialStarted:function(e){return!_.isUndefined(e)&&_.get(e,"isOwned",!1)&&_.get(e,["trialTimeRemaining","hasTimeLeft"],!1)},isTrialExpired:function(e){return!_.isUndefined(e)&&!1===_.get(e,["trialTimeRemaining","hasTimeLeft"])},isEntitlementAreaHidden:function(e,t){return s()&&f(e)||c(e)||_.get(e,"isOwned",!1)||u(t,e)||p(t,e)},isNonVaultUpsellAreaVisible:function(e,t,i,n){return(!h(t,e)||!g(e)&&s()&&(!_.isUndefined(i)||n))&&(!_.get(e,"vault",!1)||c(e)||u(t,e)&&s())},isSubscriberAquisitionAreaVisible:function(e,t,i){return s()&&!_.get(e,"isOwned",!1)&&!c(e)&&!u(t,e)&&!_.isUndefined(i)&&!_.get(i,"isOwned",!1)&&(l(e,i)||d(e,i)||m(e))}}}function kf(e,t,i,n,r,o,a,s,c){"ngInject";function l(e,n){return t.transformOffer(_.filter(i.unwrapEditions(n),{vault:!0,isPurchasable:!0})).then(_.partial(d,e))}function d(e,t){if(1===_.size(t)){var i=_.head(_.values(t));if(n.isPurchasable(i))e.vaultEdition=i;else if(n.hasSiblings(i)){var o=[];return _.forEach(i.siblings,function(e){o.push(r.getCatalogByPath(e))}),Promise.all(o).then(_.partial(l,e))}}else 2===_.size(t)&&(e.vaultEdition=_.head(_.filter(_.values(t),{isPurchasable:!1})));return Promise.resolve(e)}function g(e){return Promise.resolve(e)}function u(e){return _.head(_.values(e))}function p(e){var t=o.getActiveSubscriptionLevel();return t===yI.y.STANDARD?a.isVaultGame(e):t===yI.y.PREMIUM&&s.isPremierVaultGame(e)}return{setVaultEdition:function(t){var i=_.filter(t.editions,{vault:!0});return _.isEmpty(i)?_.get(t,["model","vaultOcdPath"],!1)?e.getByOcdPathPromise(_.get(t,["model","vaultOcdPath"])).then(_.partial(d,t)).catch(_.partial(g,t)):Promise.resolve(t):d(t,i).catch(_.partial(g,t))},getSharedVaultBasegameIfSubscriber:function(e){if(_.size(e)&&o.userHasSubscription()){var t=_.map(e,function(e){return i.getHighestRankedVaultEdition(e)});return Promise.all(t).then(_.compact).then(function(t){return t.length?t.length>=e.length&&1===(t=_.uniq(_.filter(t,"offerId"))).length?_.head(t):Promise.reject(UI.o):null}).catch(function(e){return c.error("[PdpVaultModelFactory] getSharedVaultBasegameIfSubscriber error",e),null})}return Promise.resolve(null)},getHigherOrEqualEditionInVault:function(e){var t,i,n;if(o.getActiveSubscriptionLevel()===yI.y.NONE)return Promise.resolve();if(p(e))return Promise.resolve(e);if(function(e){return o.isStandardSubscriber()?a.isUpgradeable(e):!!o.isPremiumSubscriber()&&s.isPremierUpgradeable(e)}(e))return t=e,i=o.getActiveSubscriptionLevel(),n=void 0,i===yI.y.STANDARD?n=_.get(t,[DI._34,DI._12]):i===yI.y.PREMIUM&&(n=_.get(t,[DI._16,DI._12])),n&&n!==_.get(t,DI._0)?r.getCatalogByPath(n).then(u):t;var c=_.get(e,DI.W),l=_.get(e,DI.A),d=o.getVaultGameFromMasterTitleId(c);return p(d)&&l<=_.get(d,DI.A)?Promise.resolve(d):Promise.resolve()}}}function If(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(t){var i=_.get(w,[t,"ocdPromise"]);return i||(i=e.getOcdByPath(t),_.set(w,[t,"ocdPromise"],i)),i}function g(e){var t=[];return e.isValid&&t.push(d(e.gameName)),(e.isCurrency||e.isAddon||e.isExpansion||e.isGameTime)&&t.push(d(e.gdpPath)),t.length>0?Promise.all(t):Promise.reject(Poe)}function u(e,t){var i=_.head(_.values(t));So(i),e.basegames.push(i)}function p(e){var i=[],n=void 0,r=void 0,o=!1,a=!1,l=!1,d=!1;if(_.find(e.basegames,function(e){return c.isUpgradeable(e)&&(o=!0,n=_.get(e,[DI._34,DI._12])),c.isVaultGame(e)&&(l=!0),s.isPremierUpgradeable(e)&&(a=!0,r=_.get(e,[DI._16,DI._12])),s.isPremierVaultGame(e)&&(d=!0),o&&l&&a&&d}),o&&!l&&n&&i.push(n),a&&!d&&r&&i.push(r),i=_.compact(_.uniq(i)),_.isEmpty(i))return Promise.resolve(e);var g=_.map(i,t.getCatalogByPath);return Promise.all(g).then(function(e){return function(t){var i=Coe(t,2),n=i[0],r=i[1];return n&&u(e,n),r&&u(e,r),e}}(e)).catch(function(){return e})}function m(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipErrorHandling:!1,throwError:!1},n=i.skipErrorHandling,r=i.throwError,a=_.get(w,[e.gdpPath,"model"]);return a?Promise.resolve(a):g(e).then(function(i){return function(e,i){if(_.every(i,_.isEmpty))return Promise.reject(Poe);var n=_.head(i),r=[];if(n&&_.forEach(_.values(n.gamehub.children),function(e){_oe.test(e)||r.push(t.getAllOffersByPath(e,!1))}),e.isCurrency){var o=_.last(i);_.forEach(_.values(o.gamehub.children),function(e){r.push(t.getCatalogByPath(e,!1))})}else(e.isAddon||e.isExpansion||e.isGameTime)&&r.push(t.getCatalogByPath(e.gdpPath,!1));return Promise.all(r).then(function(e){return e.filter(function(e){return e})})}(e,i)}).then(h).then(p).then(_.partial(Sc,e)).then(function(t){return _.set(w,[e.gdpPath,"model"],t),t}).catch(function(t){if(r)throw t&&"invalidOcdPath"===t.reason&&(t.ocdPath=e.gdpPath),t;if(!n)return o.handleModelError(t)})}function f(e,t){if(e.isValid&&t){if(e.isGameName)return _.first(t.basegames.sort(g5));if(e.isCurrency)return _.first(t.currency.sort(g5));if(e.isAddon)return _.first(t.addon);if(e.isExpansion)return _.first(t.expansion);if(e.isGameTime)return _.first(t[DI.C])}}function h(e){var t=new Ooe;return e.forEach(function(e){Object.values(e).forEach(function(e){e&&!i.isPurchasableWithVirtualCurrency(e)&&(So(e),i.isAlphaTrialDemoOrBeta(e)&&!i.isExpansionFacetKey(e)?t.addFreeGame(e):i.isCurrency(e)?t.addCurrency(e):i.isDlcFacetKey(e)?t.addAddon(e):i.isExpansionFacetKey(e)?t.addExpansion(e):i.isOnlineSubscription(e)?t.addGameTime(e):(i.isPublished(e)&&t.addBaseGame(e),t.addToAllBasegames(e)))})}),t}function v(e){return _.map(e,function(e){return r.loadEntitlementsInfo(e)})}function b(e){return Promise.all(e).then(function(e){return _.map(e,function(e){return{offerId:e.offerId,isOwned:e.isOwned,isFirstPartyPassOwned:e.firstPartyVaultEntitlement,ownedThroughOtherVersion:e.ownedThroughOtherVersion,gameNameFacetKey:e.gameNameFacetKey,franchiseFacetKey:e.franchiseFacetKey,vaultEntitlement:e.vaultEntitlement,gameEditionTypeFacetKeyRankDesc:e.gameEditionTypeFacetKeyRankDesc,entitlementSource:e.entitlementSource}})})}function y(e){var t=[];return e&&_.forEach(_.values(e[0].gamehub.children),function(e){_oe.test(e)&&t.push(d(e))}),Promise.all(t)}function S(e){var i=[];return e.forEach(function(e){_.values(e.gamehub.children).forEach(function(e){i.push(t.getCatalogByPath(e,!1))})}),Promise.all(i)}function k(e,t){return e?C([t.offerId]).then(_.values).then(_.head):Promise.resolve(t)}function I(e,i){return c.isVaultGame(e)?Promise.resolve(e):c.isUpgradeable(e)?t.getCatalogByPath(e.vaultOcdPath).then(_.values).then(_.head).then(_.partial(k,i)):void 0}var w={},C=function(e){return t.getCatalogInfo(e).then(function(e){return _.cloneDeep(e)}).then(v).then(b).catch(kc)};return{getCatalogModelPromise:m,getHighestOwnedBasegameId:function(e){var t=Array.isArray(e)?e:_.get(e,uU,[]),n=_.filter(t,i.isBaseGameOriginDisplayType).sort(g5),r=a.getBaseGameEntitlements(),o=n.filter(function(e){return!!r[e[DI.Y]]}).sort(p5).map(function(e){return e[DI.Y]});return _.last(o)},getPricePromise:n.getPricePromise.bind(n),getEditionAgnosticModelPromise:function(e,t){return m(e,t).then(_.partial(f,e))},getVaultModelPromise:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yI.y.STANDARD;return m(e,{skipErrorHandling:!0}).then(function(e){return function(e){var t=e.model,i=e.subscriptionLevel,n=_.get(t,gU,[]),r=_.find(n,c.isVaultGame);if(i===yI.y.PREMIUM){var o=_.find(n,s.isPremierVaultGame);if(o)return o}return r}({model:e,subscriptionLevel:t})})},getPlayFirstTrialModelPromise:function(e){return m(e,{skipErrorHandling:!0}).then(function(e){var t=_.get(e,hU,[]);if(_.size(t))return _.find(t,function(e){return i.isEarlyAccessTrial(e)&&_.get(e,DI.N,!1)})})},getVaultModelBySubscriptionPromise:function(e){var i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).withEntitlement,n=void 0!==i&&i;return l.isPremiumSubscriber()?s.isPremierVaultGame(e)?Promise.resolve(e):s.isPremierUpgradeable(e)?t.getCatalogByPath(_.get(e,[DI._16,DI._12])).then(_.values).then(_.head).then(_.partial(k,n)):I(e,n):l.isStandardSubscriber()?I(e,n):Promise.resolve()},getEntitlementsPromise:C,getAllExtraContentsCatalogModelPromise:function(e){return g(e).then(y).then(S).then(h)},processEditionAgnosticModel:f}}function wf(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(e){var t=e.gdpPath,i=void 0,n=void 0,r=new KH(t);return r.isValid&&(i=bI._5,n={franchise:r.franchise,game:r.game},r.isAddon||r.isExpansion||r.isGameTime?(i=bI.W,Object.assign(n,{type:r.type,edition:r.edition})):r.isCurrency&&(i=bI._4,Object.assign(n,{type:r.type}))),{routeName:i,parameters:n}}function g(){return n.goToState(bI.w,{})}var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isExpansion:!1,isAddon:!1},n=t.isExpansion,r=t.isAddon,s=_.get(e,"gdpInfoModel")||{};try{var c=i.getHighestOwnedBasegameId(e);c?n||r?a.isBaseGameOriginDisplayType(s)?l.goToOgd({offerId:c}):l.goToOgd({offerId:c,topic:$oe.EXTRA_CONTENT}):l.goToOgd({offerId:c}):g()}catch(e){o.error("[GdpUrlFactory][goToOgdOrGameLibrary] error",e),g()}};return{buildPathFromUrl:function(){var t=void 0,i=e.franchise,r=e.game,o=e.type,a=e.edition;return i&&r&&(t="/"+i,t+="/"+r,o&&(t+="/"+o),a&&(t+="/"+a),n.getCurrentState().name===bI._4&&(t+="/currency")),new KH(t)},getGdpUrl:function(e,t){var i=d(e),r=i.routeName,o=i.parameters,a=void 0;return r&&(a=n.getHrefFromState(r,o),t&&(a=n.getAbsoluteUrl(a))),a},goToGdp:function(e){var t=d({gdpPath:e}),i=t.routeName,r=t.parameters;i&&r&&n.goToState(i,r)},goToOgdOrGameLibrary:u,getInterstitialUrlIfAvailable:function(e){return r.isPremiumSubscriber()?Promise.reject(Goe):(a=e,i.getCatalogModelPromise(a,{throwError:!0}).then(function(e){return Promise.all([t.showBuyCtaAui(e,a.isGameName,a.isCurrency)(),t.showUpgradeAuiCta(e,a.isGameName,a.isCurrency)()])}).then(function(e){var t=Noe(e,2),i=t[0],n=t[1];return i||n}).catch(function(e){throw o.error("[GdpUrlFactory][hasInterstitialPagePromise] error",e),e})).then(function(t){if(!t)throw Goe;var i={game:e.game,franchise:e.franchise};return e.isAddon||e.isExpansion?(i.type=e.type,i.edition=e.edition,n.getHrefFromState(bI.a,i)):n.getHrefFromState(bI.d,i)});var a},loadModelAndGotoOgdOrGameLibraryPromise:function(e){return i.getCatalogModelPromise(new KH(e)).then(function(e){return Promise.resolve(u(e))})},isGdpRoute:function(){return n.isState(bI._5)||n.isState(bI._4)||n.isState(bI.W)},getOspUrl:function(e){var t={game:e.game,franchise:e.franchise};return n.getHrefFromState(bI.C,t)}}}function Cf(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){return{name:r8.NONE,context:Hoe}}function u(e){var t=[];return e.map(function(e){var i={finalPrice:_.get(e,["rating",0,"finalTotalAmount"]),originalPrice:_.get(e,["rating",0,"originalTotalPrice"])};_.isUndefined(i.finalPrice)||null===i.finalPrice||t.push(i)}),t.length>0?t:Promise.reject(zoe)}function p(e){return _.sortBy(e,function(e){return e.finalPrice})}function m(e){var t=e.map(function(e){return Promise.all([s.formatCurrency(e.finalPrice),s.formatCurrency(e.originalPrice),Promise.resolve(e.finalPrice)]).then(function(e){var t=joe(e,3);return{finalPrice:t[0],originalPrice:t[1],nonFormattedFinalPrice:t[2]}})});return Promise.all(t)}function f(e,t,n,r){return function(o){var a=e[0],s=i.isReleased(a),c=1===n,d=o[0],g=d.finalPrice,u=d.originalPrice,p=d.nonFormattedFinalPrice,m=o[o.length-1].finalPrice,f=_.some(e,l.isOnTheHouse)||0===p;return c?function(e,t,i,n,r){return{name:r?r8.FREE_SINGLE_EDITION:n?r8.BUY_SINGLE_EDITION:r8.PREORDER_SINGLE_EDITION,context:{offerId:e,price:t,highPrice:t,originalPrice:i}}}(t[0],g,u,s,f):function(e,t,i,n,r){return{name:r?r8.FREE_MULTIPLE_EDITIONS:n?r8.BUY_MULTIPLE_EDITIONS:r8.PREORDER_MULTIPLE_EDITIONS,context:{price:t,highPrice:i,gdpPath:e}}}(r,g,m,s,f)}}var h,v,b=(h=regeneratorRuntime.mark(function e(t,i){var n,r,o,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l6(t,i),e.next=3,d.filterGdpPathsForPromotion(_.map(n,"offerPath"));case 3:if((r=e.sent).length>0&&(n=_.filter(n,function(e){return _.includes(r,e.offerPath)})),!((o=_.size(n))>0)){e.next=11;break}return s=n.sort(g5),c=_.map(s,DI.Y),e.abrupt("return",a.getPrice(c).then(u).then(p).then(m).then(f(s,c,o,t)));case 11:return e.abrupt("return",Promise.resolve(g()));case 12:case"end":return e.stop()}},e,this)}),v=function(){var e=h.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var a=e[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e,t){return v.apply(this,arguments)});return{getInterstitialSecondaryAction:function(e){return t.getCatalogModelPromise(e).then(function(t){return b(e,t)}).catch(g)},invokeAction:function(t){if(t&&t.name&&t.context){var i=t.name,o=t.context;switch(i){case r8.BUY_MULTIPLE_EDITIONS:case r8.PREORDER_MULTIPLE_EDITIONS:case r8.FREE_MULTIPLE_EDITIONS:n.goToState(bI.C,{franchise:_.get(o,["gdpPath","franchise"]),game:_.get(o,["gdpPath","game"])});break;case r8.BUY_SINGLE_EDITION:case r8.PREORDER_SINGLE_EDITION:case r8.FREE_SINGLE_EDITION:e.promiseLogin().then(function(){return c.validateCurrentStorefront()}).then(function(){return r.buy(o.offerId)}).catch(c.handleWrongStorefrontError)}}},handleOwnershipErrorDialog:function(e){function t(e){var t=e.id,r=e.content;if(function(e,t,i){return i&&e===Moe.a&&(t===UI.w||t===UI.v||t===UI.u)}(t,r.errorCode,r.closedByUser)){i();var o=n.getStateParams(),a=o.franchise,s=o.game,c=o.type,l=o.edition;c&&l?n.goToState(bI.X,{franchise:a,game:s,type:c,edition:l}):n.goToState(bI._5,{franchise:a,game:s})}}function i(){o.events.off(Ey.x,t)}o.events.on(Ey.x,t),e&&e.$on("$destroy",i)}}}function Tf(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(e){return!_.isEmpty(e)&&_.get(e,"error")!==UI.p&&_.get(e,"isPurchasable",!1)}function m(e,t){return _.size(e)>0&&n.isBaseGameOfferType(t)}function f(e){return e.isOwned&&e.gameEditionTypeFacetKeyRankDesc&&e.gameNameFacetKey&&e.franchiseFacetKey}function h(e,t){var n=!1;return m(e,t)&&i.forEach(function(e){f(e)&&!1===e.vaultEntitlement&&!0===e.isOwned&&!e.firstPartyVaultEntitlement&&e.gameEditionTypeFacetKeyRankDesc>t.gameEditionTypeFacetKeyRankDesc&&e.gameNameFacetKey===t.gameNameFacetKey&&e.franchiseFacetKey===t.franchiseFacetKey&&(n=!0)},e),n}function v(e){return _.compact(_.map(e,function(e){return _.head(_.values(e))}))}function b(e,t){return e.push(_.head(_.values(t))),e}function y(e,t){if(t.push(e),n.isBaseGameOfferType(e)){var i=l.getBaseGameEntitlementOfferIdByMasterTitleId(e.masterTitleId);if(i){var r=_.filter(t,{offerId:i});return _.isEmpty(r)?c.getCatalogInfo([i]).then(d.transformOffer).then(_.partial(b,t)):Promise.resolve(t)}return Promise.resolve(t)}return Promise.resolve(t)}function S(){return Promise.resolve({})}function k(e){return C(e).then(function(t){var i=_.map(t,function(e){return c.getCatalogByPath(e).then(d.transformOffer)});return Promise.all(i).then(v).then(_.partial(y,e)).catch(S)})}function I(e,i){var r=i[e];return n.isBaseGameOriginDisplayType(r)?C(e).then(function(e){return t.getByOcdPathPromise(e).then(function(e){var t=_.filter(e,function(e){return n.isBaseGameOriginDisplayType(e)&&e.gameEditionTypeFacetKeyRankDesc<r.gameEditionTypeFacetKeyRankDesc});return _.map(t,DI.Y)})}):Promise.resolve([])}function w(e,t,i){var r=_.head(_.values(i));return n.isBaseGameOriginDisplayType(r)?e:function(e){var t=_.get(e,"alternateMasterTitleIds"),i=_.map(t,function(e){return s.getBaseGameEntitlementByMasterTitleId(e)});return i.push(s.getBaseGameEntitlementByMasterTitleId(_.get(e,"masterTitleId"))),Promise.all(i).then(_.compact).then(_.head)}(r).then(function(e){return _.get(e,DI.Y)||_.get(t,["baseGameModel",DI.Y])})}function C(e){var t=e.offerId;return s.getOcdByOfferId(t).then(function(e){return _.values(_.get(e,[DI.B,DI._24],[]))})}function T(e){var t=_.compact([_.get(e,[DI._34,DI._12]),_.get(e,[DI._16,DI._12])]);return Promise.all(_.map(t,c.getCatalogByPath)).then(v)}function P(e){return T(e).then(function(e){return _.maxBy(e,function(e){return a.isSubscriberAndVaultGame(e)?e.gameEditionTypeFacetKeyRankDesc:void 0})}).catch(function(e){g.error("PdpFactory.getHighestRankedVaultBasegame: Unable to get highest vault edition.",e)})}function O(e){return T(e).then(function(e){return Promise.all(_.map(e,u.loadEntitlementsInfo))}).then(function(e){return _.find(e,function(e){return a.isSubscriberAndVaultGame(e)&&n.isOwnedThroughVault(e)})}).catch(function(e){g.error("PdpFactory.getHighestRankedOwnedVaultBasegame: Unable to get highest vault edition.",e)})}function E(e){return n.isBaseGameOriginDisplayType(e)||!n.isDLC(e)&&!n.isCurrency(e)?Promise.resolve(e):c.getLowestRankedPurchasableBasegame(e).then(function(e){return e?(t={},i=e.offerId,n=e,i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t):Promise.reject(UI.p);var t,i,n}).then(d.transformOffer).then(_.values).then(_.head)}return{getEditions:k,getHighestRankedVaultEdition:function(e){return E(e).then(P)},getHighestRankedOwnedVaultEdition:function(e){return E(e).then(O)},getHighestOwnedEdition:function(e){return k(e).then(function(t){return _.maxBy(t,function(t){return n.isOwnedOutright(t)&&t.gameEditionTypeFacetKeyRankDesc>e.gameEditionTypeFacetKeyRankDesc?t.gameEditionTypeFacetKeyRankDesc:void 0})}).catch(function(e){g.error("PdpFactory.getHighestOwnedEdition: Unable to get highest owned edition.",e)})},ownsLesserEdition:function(e,t){var n=!1;return m(e,t)&&i.forEach(function(e){f(e)&&e.isOwned&&e.gameEditionTypeFacetKeyRankDesc<t.gameEditionTypeFacetKeyRankDesc&&e.gameNameFacetKey===t.gameNameFacetKey&&e.franchiseFacetKey===t.franchiseFacetKey&&(n=!0)},e),n},ownsGreaterEdition:function(e,t){var n=!1;return m(e,t)&&i.forEach(function(e){f(e)&&e.isOwned&&e.gameEditionTypeFacetKeyRankDesc>t.gameEditionTypeFacetKeyRankDesc&&e.gameNameFacetKey===t.gameNameFacetKey&&e.franchiseFacetKey===t.franchiseFacetKey&&(n=!0)},e),n},ownsGreaterOrEqualEditionNotVault:function(e,t){return h(e,t)||!0===_.get(t,"isOwned",!1)&&!1===_.get(t,"vaultEntitlement",!1)},ownsGreaterEditionNotVault:h,getFirstAvailableSibling:function(e){return new Promise(function(i,n){var r=_.values(e.siblings);r.length>0?t.getByOcdPathPromise(r).then(function(e){var t=_.head(_.filter(e,p));t?i(t):n(Woe)},n):n(Woe)})},unwrapEditions:v,getLowerEditionBaseGameOfferIdsByOffer:function(e){return c.getCatalogInfo([e]).then(_.partial(I,e))},getHighestOwnedBaseGameOfferId:function(e,t){return c.getCatalogInfo([e]).then(_.partial(w,e,t))},handleDropdownEditionChange:function(t,i){var n=_.get(t,DI.Y),r=_.get(i,DI.Y);_.isUndefined(n)||_.isUndefined(r)||n===r||e.goToPdp(t)}}}function Pf(e,t,i,n,r){"ngInject";function o(e){return n.isOwnedOutright(e)?t:i}return{getPrimaryAction:function(e){return o(e).getPrimaryAction(e)},startActionFlow:function(t,i){e.promiseLogin().then(function(){!function(e,t){o(e).startAction(t,e)}(t,i)})},isPurchaseAction:function(e){return!(!e||n.isOwnedOutright(e)||r.isFree(e)||n.isBrowserGame(e))},isEntitleAction:function(e){return!(!e||n.isOwnedOutright(e)||!r.isFree(e)||n.isBrowserGame(e))},isPlayAction:function(e){return!(!e||!e.isOwned||n.isBundle(e)||e.vaultEntitlement&&!e.oth||n.isBrowserGame(e)||!r.isReleased(e))},isExternalAction:function(e){return!(!e||!n.isBrowserGame(e))},isSavingsAction:function(e){return i.isSavingsAction(e)},isDisabledAction:function(e){return t.isDisabledAction(e)}}}function _f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Of(e,t,i,n){function r(){return Joe.indexOf(Origin.locale.countryCode())>-1}function o(e){if(!r())return!1;var t=Origin.user.age(),i=function(e){var t=function(e){var t=(e.gameRatingSystemIcon||e.ratingSystemIcon||"").split("/").pop().split(".",1);return t.length>0?t[0]:""}(e).toUpperCase(),i=Xoe[d][t];return _.isNumber(i)&&!_.get(e,"gameRatingPendingMature",!1)||(i=Xoe[d].MATURE),i}(e);return!t||t<i}function a(e){var i=function(e){var i;return e&&(i=t().diff(e,"years")),i}(e),n=s();return!_.isNumber(i)||i<n}function s(){return Zoe[Origin.locale.countryCode()]}var c,l,d=e.getRatingSystem(Origin.locale.countryCode()),g=n.observe({isUnderAge:!0,isAgeUnknown:!0});return _f(c={isUserUnderGameAgeRequirement:o,isUserUnderAgeForMediaLocale:function(){var e=Origin.user.age(),t=s();return!_.isNumber(e)||e<t},isUserUnderAgeForMediaLocaleByBirthDay:a},"isUserUnderAgeForMediaLocaleByBirthDay",a),_f(c,"getMediaLocalAgeGateAge",s),_f(c,"isAgeGateRequired",r),_f(c,"validateUserAgePromise",function(e){return e&&o(e)?Promise.reject("user-under-age"):Promise.resolve(e)}),_f(c,"getUserAgeStateObservable",function(){return l||(l=i.create(g)),l}),_f(c,"setUserAgeState",function(e){g.data=e,g.commit()}),c}function Ef(e,t,i,n,r){"ngInject";return r.get("StoreAgeGateFactory",Of,this,arguments)}function Ff(e){return _.map(e,function(e){return e.offerId})}function xf(e,t,i,n){"ngInject";return{validateOffers:function(i,r){return e.getUserLocationCountryCodeFromEadp(Origin.user.userPid()).then(_.partialRight(t.validateOffers,i,r,n.BUNDLE)).then(function(e){return _.identity(r,e)})},doesUserOwnAny:function(e){return i.getOutrightOwnedProducts(e).length>0}}}function Lf(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h){"ngInject";function v(e,t){return o.beginPerformanceTimerCheckoutCart(),g.addOfferList(Ff(e),{}).then(_.partial(i.checkout,t.checkoutType,{invoiceSource:t.invoiceSource})).then(function(e){return w.fire(Ey.A,e)}).then(n.clear).catch(o.endPerformanceTimerOnError).catch(u.showDialog)}function b(e,i,r){e.accepted&&function(e,i){var r=t.getOutrightOwnedProducts(e);n.removeAll(r),v(t.getOutrightUnownedProducts(e),i)}(i,r)}function y(e,i,n){t.getGameDataWithEntitlements(e).then(_.partial(p.validateOffers,e)).then(d.toArray).then(_.partialRight(I,i,n)).catch(S)}function S(e){var t=_.get(e,"errorCode",e),i=_.get(e,"replaceMap",{});u.showDialog(t,i)}function k(e,t,i,n){if(!e.length||!1!==n)return v(t,i);l.open({id:r.BUNDLE_DLC_DIALOG_ID,xmlDirective:s.getBundledDLCPurchasePreventionModal(Ff(t)),size:"large"}),c.events.once("dialog:hide",function(e){e.accepted&&v(t,i)})}function I(e,i,n){var o=function(e){return Ff(t.getOutrightOwnedProducts(e))}(e);if(!o.length)return a.getProductsWithUnownedBaseGames(e).then(function(t){return t.length?a.getProductsWithBaseGameNotInCart(e).then(_.partialRight(k,e,i,n)):v(e,i)});l.open({id:r.BUNDLE_DIALOG_ID,xmlDirective:s.getBundlePurchasePreventionDirectiveXML(Ff(e),o,{isBundleOffer:!1}),size:"large"}),c.events.once("dialog:hide",_.partialRight(b,e,i))}var w=new Origin.utils.Communicator;return{buy:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.promiseLogin().then(function(){return m.validateCurrentStorefront()}).then(_.partial(y,t,i,n)).catch(m.handleWrongStorefrontError)},freeEntitle:function(t){var i=Promise.resolve(),r=t.reduce(function(e,t){return e.then(function(){return f.directEntitle(t)})},i);e.promiseLogin().then(function(){return m.validateCurrentStorefront()}).then(function(){return r}).then(function(e){return w.fire(Ey.A,e)}).then(n.clear).then(function(){return h.goToState(bI.w,{})}).catch(o.endPerformanceTimerOnError).catch(u.showDialog).catch(m.handleWrongStorefrontError)},events:w}}function Af(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(e,t){var i=!1;return _.forEach(t,function(t){!_.isUndefined(t.isOwned)&&t.gameEditionTypeFacetKeyRankDesc&&t.gameNameFacetKey&&t.franchiseFacetKey&&t.isOwned&&t.gameEditionTypeFacetKeyRankDesc<e.gameEditionTypeFacetKeyRankDesc&&t.gameNameFacetKey===e.gameNameFacetKey&&t.franchiseFacetKey===e.franchiseFacetKey&&(i=!0)}),i}function m(e,i){return t.ownsGreaterEditionNotVault(i,e)}function f(e,t){return!i.isFreeGame(e)&&!i.isOwnedOutright(e)&&!m(e,t)}function h(e,t){return function(e){return _.some(e,i.isOnTheHouse)}(t)&&f(e,t)}function v(e){return 0===e.price}function b(e,t){return!e.isOwned&&t&&e.vault}function y(e,t,n){var r=s.isReleased(e),o={context:{hasPricingError:!_.isUndefined(e.pricingError),offerId:e.offerId}};return function(e,t){return s.isPurchasable(e)&&f(e,t)}(e,t)?(o.name=r?aae.BUY:aae.PREORDER,Promise.resolve(o)):h(e,t)||function(e,t){return v(e)&&f(e,t)}(e,t)?(o.name=aae.FREE,o.context.gdpPath=e.gdpPath,Promise.resolve(o)):i.isFreeGame(e)&&i.isBrowserGame(e,!0)?(o.name=aae.PLAY,o.context.isExternal=!0,o.context[DI.p]=_.get(e,[DI._15,DI._13,DI.p]),Promise.resolve(o)):Promise.resolve()}function S(e){return _.map(e,function(e){switch(e.name){case aae.PLAY:e.ctaText=SU.PLAY,e.telemetryClass=N6;break;case aae.BUY:e.ctaText=e.context.hasPricingError?SU.BUY:SU.BUY_WITH_PRICE,e.telemetryClass=G6;break;case aae.FREE:e.ctaText=SU.FREE,e.telemetryClass=G6;break;case aae.PREORDER:e.ctaText=e.context.hasPricingError?SU.PREORDER:SU.PREORDER_WITH_PRICE,e.telemetryClass=U6;break;case aae.GIFT:e.ctaText=e.context.hasPricingError?SU.GIFT:SU.GIFT_WITH_PRICE,e.telemetryClass=B6;break;case aae.ADD_TO_WISHLIST:e.ctaText=SU.ADD_TO_WISHLIST,e.telemetryClass=M6;break;case aae.REMOVE_FROM_WISHLIST:e.ctaText=SU.REMOVE_FROM_WISHLIST,e.telemetryClass=j6}return e})}function k(){return r.getWishlist(Origin.user.userPid())}function I(){}return{isBuyCta:function(e,t,i){return!(e.isOwned||i&&e.vault||m(e,t))},isGetCta:function(e,t,i){return b(e,i)&&!p(e,t)&&!m(e,t)},isSubscriberAndDoesNotOwnBetterEdition:function(e,t,i){return e.vault&&i&&!m(e,t)},isUpgradeCta:function(e,t,i){return b(e,i)&&p(e,t)&&!m(e,t)},isPlayCta:function(e){return e.isOwned&&e.vaultEntitlement},getOspCtaAction:function(e,t,o,a){var s=void 0,c=function(e){return!n.isGameGiftable(e)||v(e)?Promise.resolve():Promise.resolve({name:aae.GIFT,context:{hasPricingError:!_.isUndefined(e.pricingError),offerId:e.offerId}})}(t),l=y(t,o),d=function(e,t){if(!r.isWishlistEnabled()||i.isFreeGame(e)&&i.isBrowserGame(e,!0)||i.isOwnedOutright(e)||m(e,t))return Promise.resolve();var n={name:aae.ADD_TO_WISHLIST,context:{offerId:e.offerId,editionOfferIds:_.map(t,function(e){return e.offerId})}};return k().isOfferInWishlist(e.offerId).then(function(e){return n.name=e?aae.REMOVE_FROM_WISHLIST:aae.ADD_TO_WISHLIST,n})}(t,o);return s=e===vU?[c,l,d]:e===bU?[d,l,c]:[l,c,d],Promise.all(s).then(_.compact).then(S)},invokeAction:function(t){var n,r=_.get(t,["context"]);switch(t.name){case aae.BUY:case aae.PREORDER:n=r.offerId,a.promiseLogin().then(function(){return g.validateCurrentStorefront()}).then(function(){return o.buy(n)}).catch(g.handleWrongStorefrontError);break;case aae.ADD_TO_WISHLIST:!function(t){a.promiseLogin().then(function(){Promise.all([e.getEntitlementsPromise([t.offerId]),e.getEntitlementsPromise(t.editionOfferIds)]).then(function(e){var n=sae(e,2),r=sae(n[0],1)[0],o=n[1];return i.isOwnedOutright(r)||m(r,o)?Promise.resolve():k().addOffer(t.offerId).catch(I)})})}(r);break;case aae.REMOVE_FROM_WISHLIST:!function(e){var t=e.offerId;a.promiseLogin().then(function(){return k().removeOffer(t).catch(I)})}(r);break;case aae.GIFT:!function(e){var t=e.offerId;l.getCatalogInfo([t]).then(_.values).then(_.head).then(c.loginAndStartGiftingFlow).catch(I)}(r);break;case aae.PLAY:!function(e){var t=e[DI.p];t&&d.externalUrl(t)}(r);break;case aae.FREE:!function(e){var t=e.offerId,i=e.gdpPath;o.entitleFreeGame(t).then(function(){return u.goToGdp(i)}).catch(I)}(r)}},transformOcdDataForMiniComparisonTable:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i="comparison-table-ocd-path";return[i+"1",i+"2",i+"3"].reduce(function(i,n,r){var o=r+1,a=e[n];return!a||t.length&&!t.includes(a)||(i[a]=e.items.reduce(function(e,t){var i=t[jJ],n=i["check"+o];return!i||"checked"!==n&&n!==cae||e.push({image:i.image,title:i["title-str"],description:i.description,customValue:n===cae?i["check"+o+"value"]:null}),e},[])),i},{})}}}function Df(e){"ngInject";return{showDialog:function(t,i){var n=function(e,t){if((!e||e!==UI.n)&&window){var i=encodeURI(JSON.stringify(t||{}));return{id:Moe.a,xmlDirective:'<origin-dialog-errormodal \n                                class="origin-dialog-content" \n                                dialog-id="'+Moe.a+'" \n                                error-code="'+e+'" \n                                replace="'+i+'">\n                                </origin-dialog-errormodal>',size:_I,errorCode:e}}}(t,i);n&&e.open(n)}}}function Rf(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $f(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(){p={},m=pae.NONE}function g(t,i,n,r){r.name!==bI.l&&r.name!==bI.E||(d(),e.events.off(Ey.P,g))}var u,p={},m=pae.NONE,f=(Rf(u={},pae.FRIEND_REFERRAL,function(){return p}),Rf(u,pae.INTERSTITIAL,function(){return Rf({},uae,[i.isPremiumSubscriber()?_.get(p,dae):_.get(p,gae)])}),Rf(u,pae.NONE,function(){return p}),u),h=function(e){var t,i=void 0,n=void 0;_.find(_.get(e,gU,[]),function(e){var t=_.get(e,DI._0);return a.isVaultGame(e)&&(i=t),s.isPremierVaultGame(e)&&(n=t),!_.isUndefined(i)&&!_.isUndefined(n)}),Rf(t={},gae,i),Rf(t,dae,n),p=t,m=pae.INTERSTITIAL},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(d(),n.isState(bI.d))r.getCatalogModelPromise(o.buildPathFromUrl()).then(h).catch(d);else if(n.isState(bI._2)){var t=e.nucleusId,i=e.username;t&&c.getSuggestedTopGamesForNux(t).then(function(e){var n;e.length&&(m=pae.FRIEND_REFERRAL,Rf(n={},uae,e),Rf(n,"nucleusId",t),Rf(n,"username",i),p=n)}).catch(function(e){l.error("[FullpageNuxFactory]: getSuggestedTopGamesForNux server error",e),d()})}};return{showFullpageNux:function(){m===pae.NONE&&v(),n.goToState(bI.m,{awaitStateRefresh:!0}),e.events.on(Ey.P,g)},setNuxModel:v,getNuxModel:function(){return f[m]()}}}function Nf(e,t){"ngInject";function i(e){if(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelector("p");return n=i?i.innerHTML:t.innerHTML}return Promise.reject("no-tos-found")}var n=void 0;return{getOriginAccessTermsOfService:function(){if(n)return Promise.resolve(n);var r=function(){var e=Origin.locale.threeLetterCountryCode().toLowerCase(),i=Origin.locale.locale().replace("_","-").toLowerCase(),n=t.tos[e],r=void 0;return n&&(r=n[i]?n[i]:_.first(_.values(n))),r||(r=fae),{tosLanguage:r}}().tosLanguage;return Origin.tos.getOriginAccessTermsOfService(r).then(i).catch(function(){e.error("LegalFactory.getOriginAccessTermsOfService: unable to retrieve oa legal terms from TOS")})}}}function Gf(e,t){"ngInject";var i={};return i[t.DEFAULT]=e.OFFER_BANNED_IN_COUNTRY,i[t.VAULT]=e.OFFER_BANNED_IN_COUNTRY_VAULT,i[t.FREEGAME]=e.OFFER_BANNED_IN_COUNTRY_FREEGAMES,i[t.GIFT]=e.OFFER_BANNED_IN_COUNTRY_GIFT,i[t.BUNDLE]=e.OFFER_BANNED_IN_COUNTRY_BUNDLE,{validateOffers:function(e,n,r,o){o=function(e){return-1!==_.values(t).indexOf(e)}(o)?o:t.DEFAULT;var a=function(e,t,i){var n=_.find(t,function(t){return-1!==_.get(e,[t,"countries","bannedCountries"],[]).indexOf(i)});return _.get(e,n)}(r,n=_.isArray(n)?n:[n],e);if(a)throw function(e,n){return{errorCode:function(e){return i[e]||i[t.DEFAULT]}(n),replaceMap:{"%offername%":_.get(e,"i18n.displayName","")}}}(a,o)}}}function Uf(e,t){"ngInject";function i(e){return _.get(kae,e)}function n(e){var t=i(e);return new Promise(function(i,n){t?(t.nativePlayer.pause(),t.isPlaying=!1,i(e)):n(bae)})}function r(e,t){var n=i(e);return new Promise(function(i,r){n?(n.nativePlayer.mute=t,i(e)):r(bae)})}function o(e){var t=i(e);return new Promise(function(i){t?n(e).then(function(){kae[e]=void 0,i(e)}):i(e)})}return{register:function(i,n,r){return new Promise(function(a,s){e.browserSupports("media-source")?!kae[i]&&n&&n.nativePlayer?(n.src=n.mediaSourceCodec===t.MP4Codec?r.trustedMp4Video:r.trustedWebmVideo,n.isPlaying=!1,n.isDownloaded=!1,kae[i]=n,r&&r.$on("$destroy",function(){o(i)}),a(i)):s(yae):s(Sae)})},play:function(e){var t=i(e);return new Promise(function(i,n){if(t){var r=t.nativePlayer;if(t.isDownloaded)r.play(),t.isPlaying=!0,i(e);else{var o=new window.MediaSource;r.src=window.URL.createObjectURL(o),o.addEventListener("sourceopen",function(){var n,o,a,s=this,c=s.addSourceBuffer(t.mediaSourceCodec);n=t.src,o=function(n){c.addEventListener("updateend",function(){c.updating||"open"!==s.readyState||(s.endOfStream(),r.play(),t.isPlaying=!0,t.isDownloaded=!0,i(e))}),c.appendBuffer(n)},(a=new window.XMLHttpRequest).open("get",n),a.responseType="arraybuffer",a.onload=function(){o(a.response)},a.send()})}}else n(bae)})},pause:n,mute:function(e){return r(e,!0)},unMute:function(e){return r(e,!1)},destroy:o}}function Bf(e,t){function i(e){return wae.hasOwnProperty(e)?wae[e]:wae.default}var n=e.map,r=e.getProperty,o=e.merge,a=e.copy,s=e.toArray;return wae=n(function(e){return o(a(wae.default),e)},wae),{getMock:i,getEditionOfferIds:function(e){var i=t("filter")(s(wae),e);return n(r("offerId"),i)},insertMockData:function(t){var n;return e.forEach(function(e,r){n=i(e.offerId),t[r]=_.merge(t[r],n)},t),Promise.resolve(t)}}}function Mf(e,t,i){"ngInject";return i.get("StoreMockDataFactory",Bf,this,arguments)}function jf(e,t,i,n,r){"ngInject";function o(e,t){t.name!==Tae&&(r.events.off("uiRouter:stateChangeStart",o),s())}function a(e,t){d[t]=e,function(e){e===g&&(r.events.on("uiRouter:stateChangeStart",o),d[g].isVisible=!0,Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_NUX_PAGE_VIEW,{index:e,stepName:_.get(d,[g,"stepName"])}))}(t)}function s(){i.close(e.id),t.isOIGContext()&&n.close(),d=[],g=0}function c(e){g++,_.size(d)>g?(d[g-1].isVisible=!1,d[g].isVisible=!0,Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_NUX_PAGE_VIEW,{index:g,stepName:_.get(d,[g,"stepName"])})):(s(),e&&Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ORIGIN_ACCESS_NUX_CLOSE))}function l(){r.events.off("uiRouter:stateChangeStart",o)}var d=[],g=0;return{nuxLinkFunction:function(e){return function(t,i){t.stepName=e,a(t,i.index()),t.nextStage=c,t.$on("$destroy",l)}},next:c}}function Hf(e,t,i,n,r,o,a,s,c,l,d){function g(e){return e.isOwned}function u(e){return e.isSubscription}function p(e){return f(g)(e)}function m(e){return f(u)(e)}function f(e){return B([H(e),M("weight"),j])}function h(e){return m(e)}function v(e,t){var i=p(e);return i&&i.weight>t.weight}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l.ownsEntitlement(e.offerId,t)?(e.isOwned=!0,e.vaultEntitlement=l.isSubscriptionEntitlement(e.offerId),e.firstPartyVaultEntitlement=l.isOwnedThroughFirstPartySubscription(e.offerId),e.ogdOfferId=e.offerId,e.entitlementSource=l.getEntitlementSource(e.offerId),o.getTrialTimeByOfferId(e.offerId).then(function(t){return e.trialTimeRemaining=t,e})):Promise.reject(e)}function y(e){var t=function(e){return _.get(e,"ocdPath",_.get(e,"offerPath",""))}(e),i=n.getOtherOwnedVersion(t,!1);return i?(e.isOwned=!0,e.vaultEntitlement=void 0!==n.getOtherOwnedVersion(t,!0),e.firstPartyVaultEntitlement=l.isOwnedThroughFirstPartySubscription(i),e.entitlementSource=l.getEntitlementSource(i),e.ogdOfferId=i,o.getTrialTimeByOfferId(e.offerId).then(function(t){return e.trialTimeRemaining=t,e})):Promise.reject(e)}function S(e,t){var i=_.map(t,function(e){return b(e).catch(function(){return y(e)}).catch(function(){return e})});return Promise.all(i).then(function(t){var i=_.every(t,function(e){return e.isOwned||k(e)}),n=t.find(function(e){return!k(e)});return i?(e.isOwned=!0,e.vaultEntitlement=_.some(t,{vaultEntitlement:!0}),e.firstPartyVaultEntitlement=_.some(t,{firstPartyVaultEntitlement:!0}),e.entitlementSource=n?n.entitlementSource:void 0,e.ogdOfferId=_.get(_.find(t,function(e){return e.ogdOfferId}),"ogdOfferId"),e):Promise.reject(e)})}function k(e){return _.size(e.bundleOffers)>0&&a.isShellBundle(e)}function I(e){return k(e)?d.extractBundledOffers(e).then(_.partial(S,e)).catch(function(){return Promise.reject(e)}):Promise.reject(e)}function w(e,t){return l.ownsEntitlement(t.offerId)?(e.isOwned=l.ownsEntitlement(t.offerId),e.vaultEntitlement=l.isSubscriptionEntitlement(t.offerId),e.firstPartyVaultEntitlement=l.isOwnedThroughFirstPartySubscription(t.offerId),e.entitlementSource=l.getEntitlementSource(t.offerId),e.ogdOfferId=t.offerId,Promise.resolve(e)):Promise.reject(e)}function C(e){return s.isShellBundle(e)&&Origin.utils.os()===Origin.utils.OS_WINDOWS?i.getCatalogByPath(_.get(e,"vaultOcdPath"),!s.isShellBundle(e)).then(_.partial(w,e)):Promise.reject(e)}function T(e,t){var i=_.get(_.head(_.values(t)),"bundleOffers",[]);if(!_.isEmpty(i)){var n=!0,r=!0,o=!0;if(_.forEach(i,function(e){l.ownsEntitlement(e)||(n=!1),l.isSubscriptionEntitlement(e)||(r=!1),l.isOwnedThroughFirstPartySubscription(e)||(o=!1)}),n)return e.isOwned=n,e.vaultEntitlement=r,e.firstPartyVaultEntitlement=o,e.entitlementSource=l.getEntitlementSource(e.offerId),Promise.resolve(e)}return Promise.reject(e)}function P(e){return s.isShellBundle(e)&&Origin.utils.os()===Origin.utils.OS_WINDOWS?i.getCatalogByPath(_.get(e,"vaultOcdPath"),!s.isShellBundle(e)).then(_.partial(T,e)):Promise.reject(e)}function O(e){return e.isOwned=!1,e.vaultEntitlement=!1,e.firstPartyVaultEntitlement=!1,Promise.resolve(e)}function E(e){return e.isInstalled=!1,e.isSubscription=!1,Promise.resolve(e)}function F(e,t){var n=[];angular.isString(t)?n=[t]:angular.isArray(t)&&(n=_.filter(t));var r=_.filter(n,function(e){return l.ownsEntitlement(e)});return i.getCatalogInfo(r).then(_.values).then(function(t){return _.filter(t,function(t){return _.get(t,"loyaltyPromotion")&&_.get(t,"gameEditionTypeFacetKeyRankDesc")>=_.get(e,"gameEditionTypeFacetKeyRankDesc")})})}function x(e){return a.isEarlyAccessTrial(e)?Promise.reject(e):n.getOcdByOfferId(e.offerId).then(G).then(_.partial(F,e)).then(function(t){return t.length?(e.isOwned=!0,e.vaultEntitlement=l.isSubscriptionEntitlement(e.offerId),e.firstPartyVaultEntitlement=l.isOwnedThroughFirstPartySubscription(e.offerId),e.entitlementSource=l.getEntitlementSource(e.offerId),e):Promise.reject(e)})}function L(e,t){return function(e){return a.isRepurchasable(e)||!c.isAppLoggedIn()?(e.isOwned=!1,e.vaultEntitlement=!1,e.firstPartyVaultEntitlement=!1,e.entitlementSource=null,Promise.resolve(e)):Promise.reject(e)}(e).catch(function(){return b(e,t)}).catch(function(){return function(e,t){return l.getDLCEntitlementsWithoutBasegame(e).then(function(){return b(e,t)})}(e,t)}).catch(_.partial(y,e)).catch(_.partial(I,e)).catch(_.partial(C,e)).catch(_.partial(P,e)).catch(_.partial(x,e)).catch(_.partial(O,e)).then(function(){return function(e,t){return e.isInstalled=n.isInstalled(e.offerId,t),e.isSubscription=e.vault&&r.userHasSubscription(),Promise.resolve(e)}(e,t)}).catch(_.partial(E,e))}function A(e,t){if(angular.isString(e))e=[e];else{if(!angular.isArray(e))return Promise.reject();e=_.filter(e)}return i.getCatalogInfo(e).then(D).then(function(e){return function(e,t){return Promise.all(Object.values(e).map(function(e){return L(e,t)})).then(function(){return e})}(e,t)})}function D(e){return new Promise(function(t,i){var r,o={rejectEntitlement:function(){r&&clearTimeout(r),o.removeEventListeners(),i("An error occured and you are not able to purchase games at this time. Please try again later. (Entitlements service timed out)")},resetTimeout:function(){r&&clearTimeout(r)},resolveSuccess:function(){r&&o.resetTimeout(),o.removeEventListeners(),t(e)},removeEventListeners:function(){n.events.off("games:extraContentEntitlementsUpdate",D),n.events.off("games:baseGameEntitlementsError",o.rejectEntitlement)}};n.initialRefreshCompleted()?o.resolveSuccess():(n.events.once("games:extraContentEntitlementsUpdate",o.resolveSuccess),n.events.once("games:baseGameEntitlementsError",o.rejectEntitlement),r=setTimeout(o.rejectEntitlement,_ae))})}function R(e){return _.filter(e,function(e){return e.isOwned})}function $(e,t){return _.filter(t,function(t){return a.isOwnedOutright(t)&&_.get(t,"gameEditionTypeFacetKeyRankDesc")>_.get(e,"gameEditionTypeFacetKeyRankDesc")})}function N(e){return _.maxBy(e,"gameEditionTypeFacetKeyRankDesc")}function G(e){var t=_.get(e,["gamehub","siblings"]),n=_.map(t,i.getOfferIdByPath);return Promise.all(n)}function U(e){return n.getOcdByOfferId(e.offerId).then(G).then(A).then(_.partial($,e))}var B=t.pipe,M=e.orderByField,j=e.takeHead,H=e.filterBy;return{getPrimaryEdition:function(e,t){return v(e,t)?p(e):t.isOwned?t:h(e)?m(e):t},getTopOwnedEdition:p,getTopSubscriptionEdition:m,hasSubscriptionEdition:h,userOwnsBetterEdition:v,getGameDataWithEntitlements:A,loadEntitlementsInfo:L,getOwnedProducts:R,getUnownedProducts:function(e){return A(e).then(function(e){return _.filter(e,function(e){return!e.isOwned})})},getTopOwnedEditions:function(e){return B([H(g),M("weight")])(e)},getProductsOwned:function(e){return A(e).then(R)},getOutrightOwnedProducts:function(e){return _.filter(e,a.isOwnedOutright)},getOutrightUnownedProducts:function(e){return _.filter(e,function(e){return!a.isOwnedOutright(e)})},getHighestOwnedEditionOfferIdAsync:function(e){return U(e).then(N).then(function(e){return _.get(e,"offerId","")})},getHighestOwnedEditionCatalogAsync:function(e){return U(e).then(N)}}}function zf(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";return g.get("OwnershipFactory",Hf,this,arguments)}function Vf(e,t,i,n,r,o,a){"ngInject";function s(){var i=null;if(t.franchise&&t.game)i="/"+t.franchise,i+="/"+t.game,t.type&&(i+="/"+t.type),t.edition&&(i+="/"+t.edition),e.is(bI._4)&&(i+="/currency");else if(t.offerid){var r=n.getExistingCatalogInfo(t.offerid);i="/"+r.franchiseFacetKey,i+="/"+r.gameNameFacetKey,"basegame"!==r.gameTypeFacetKey&&(i+="/"+r.gameTypeFacetKey),i+="/"+r.gameEditionType}return i}function c(e){var t=void 0,i=void 0,n=e.freeBaseGame||e.ocdPath||e.offerPath;if(n){var r=_.compact(n.split("/"));4===r.length?(t="app.store.wrapper.addon",i={franchise:r[0],game:r[1],type:r[2],edition:r[3]}):3===r.length&&(t="app.store.wrapper.pdp",i={franchise:r[0],game:r[1],edition:r[2]})}else e.offerId&&(t="app.store.wrapper.skupdp",i={offerid:e.offerId});return{routeName:t,parameters:i}}function l(t,i){var n=c(t),o=void 0;return n.routeName?(o=e.href(n.routeName,n.parameters),i&&(o=r.getAbsoluteUrl(o)),o):o}return{getCurrentEditionSelector:function(){if(t.offerid)return{offerId:t.offerid};var e={franchiseKey:t.franchise||null,gameKey:t.game||null,editionKey:t.edition||null,demo:!1,trial:!1,beta:!1,earlyAccess:!1,isPurchasable:!0};return e.ocdPath=s(),e},goToPdp:function(e){var t=c(e);t.routeName&&i.events.fire("uiRouter:go",t.routeName,t.parameters)},getPdpUrl:l,getBrowsePageUrl:function(t){return e.href("app.store.wrapper.browse",{fq:t})},buildPathFromUrl:s,isPdpRoute:function(){return e.is("app.store.wrapper.pdp")||e.is("app.store.wrapper.addon")||e.is("app.store.wrapper.sku")},getPdpUrlIfOneExists:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Origin.user.underAge()||!a.isPurchasable(e)?Promise.resolve(null):o.getOcdByPath(e.ocdPath).then(function(i){return _.isEmpty(i)?null:l(e,t)}).catch(function(){return null})}}}function Wf(e,t,i,n,r,o,a){"ngInject";return{checkForProductLandingPageRedirect:function(){return new Promise(function(s,c){function l(t){return r.goToState(t,e.params),c()}return r.isState(Eae)||r.isState(xae)?o.userHasSubscription()?l(Eae):t.getCatalogByPath(i.buildPathFromUrl()).then(n.transformOffer).then(function(e){var t=_.head(_.values(e));return _.get(t,"isOwned",!1)?l(Fae):a.isReleased(t)?l(Eae):s()}).catch(_.partial(l,Eae)):(r.internalUrl(window.location.href.replace("/ea-play","")),c())})}}}function qf(e,t){return{findOfferIds:t.decorate(function(t){return Promise.resolve(t).then(e.getEditionOfferIds)})}}function Yf(e,t,i){"ngInject";return i.get("ProductSearchFactory",qf,this,arguments)}function Kf(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function Qf(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k,I,w,C,T,P,O,E,F,x,L,A,D,R,$,N,G,U){"ngInject";function B(e,t){var i=g.isOIGContext()?e.i18n.displayName:function(e){return'<a href="'+b.getHrefFromState(Bae,{offerid:e.offerId})+'" class="otka">'+e.i18n.displayName+"</a>"}(e);p.showDialog(t,{"%edition%":i})}function M(e){if((e===I.SUBS||e===I.CHAINED)&&F.userHasSubscription()&&!F.isInStackableCountry()&&!F.isCodeRedeemSubscription())return a.events.fire(Ey.M,$ae),Promise.reject(UI.b)}function j(t,i,r,o){return Origin.utils.os()===Origin.utils.OS_WINDOWS||t!==I.SUBS||i?r?function(t,i){return F.userHasSubscription()?(n.goToPdp(i),Promise.reject(UI.b)):function(t,i){return m.isOwnedOutright(i)?(b.goToState(bI._0),e(),Promise.reject({product:i,reason:UI.w})):function(e,t){$.beginPerformanceTimerCheckoutCart();var i={virtualCurrency:"",category:_.get(t,"categoryId",""),invoiceSource:_.get(t,"invoiceSource",""),offerId:e},n=_.get(t,"offerId");return De(n).then(_.partial(d.checkout,I.CHAINED,i)).then(_.partial(V,I.CHAINED,n,void 0)).then($e).catch($.endPerformanceTimerOnError).catch(_.partial(H,I.CHAINED,n,{}))}(t,i).catch(_.partial(H,I.CHAINED,_.get(i,"offerId"),{}))}(t,i).catch(function(e){return B(e.product,e.reason)})}(r,o):void 0:Promise.reject(Rae)}function H(e,t,i,n){var r=i.subscriptionOfferId,o=i.friendReferralToken;if($.endPerformanceTimerCheckoutCart(),Origin.telemetry.sendCheckoutErrorEvent(n),n===Rae)P.openMacSubscriptionWarningDialog({subscriptionOfferId:r,friendReferralToken:o},t,void 0);else{var a={checkoutType:e,offerId:t,subscriptionOfferId:r};Object.assign(a,_.isPlainObject(n)?{error:n}:{error:{message:n}}),Origin.ratt.sendTelemetry(Origin.defines.rattModules.SPA_CHECKOUT,e.toUpperCase(),Origin.defines.rattProperties.FAILURE,F.userHasSubscription(),a).catch(function(){}),p.showDialog(n)}}function z(e,i,n){f.getCatalogInfo([i]).then(function(r){var o=_.get(r,[i,DI._0]),a=F.getActiveSubscriptionLevel(),s={checkoutType:e,offerId:i,gamePath:o,subscriptionOfferId:n,subscriptionLevel:a};return Origin.ratt.sendTelemetry(Origin.defines.rattModules.SPA_CHECKOUT,e.toUpperCase(),Origin.defines.rattProperties.SUCCESS,F.userHasSubscription(),s).catch(function(e){return t.error("PurchaseFactory: handleCheckoutSuccess Origin.ratt.sendTelemetry failure.",e)})}).catch(function(e){return t.error("PurchaseFactory: handleCheckoutSuccess getCatalogInfo failure.",e)})}function V(e,t,i){Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ENTITLEMENT_SUCCESS,t),e===yI.p.UPGRADE_PREMIER?F.retrieveSubscriptionInfo().then(F.updateExperimentUserSubscription).then(F.fireSubscriptionUpdateEvent).then(function(){z(e,t,i)}):z(e,t,i)}function W(e,t,i){e.accepted&&K(t,i)}function q(e,t){e.accepted?ge(t):g.isOIGContext()&&(Origin.client.oig.closeIGOSPA(),Origin.client.oig.closeIGO())}function Y(e){return e?c.addCoupon(e):Promise.resolve()}function K(e,t){$.beginPerformanceTimerCheckoutCart(),e.fictionalCurrencyCode?ge([e],t):De(e.offerId).then(function(){return Origin.user.userStatus()===Origin.defines.userStatus.BANNED?Promise.reject(Gae):Promise.resolve()}).then(_.partial(Y,t.promoCode)).then(_.partial(M,t.checkoutType)).then(_.partial(j,t.checkoutType,t.subsConfirmation,void 0)).then(function(){var e=_.get(t,"friendReferralToken");e&&c.setCartProperty("friend_referral_token",e)}).then(_.partial(d.checkout,t.checkoutType,{invoiceSource:t.invoiceSource,friendReferralToken:t.friendReferralToken,offerId:e.offerId,subscriptionLevel:F.getActiveSubscriptionLevel(),isCodeRedeemSubscription:F.isCodeRedeemSubscription()})).then(_.partial(V,t.checkoutType,e.offerId,void 0)).catch(_.partial(H,t.checkoutType,e.offerId,{subscriptionOfferId:void 0,friendReferralToken:t.friendReferralToken}))}function Q(e,t,i,n,r){$.beginPerformanceTimerCheckoutCart();var o={invoiceSource:r.invoiceSource};c.addGiftOffer(e.offerId,t,i,n).then(_.partial(Y,r.promoCode)).then(_.partial(d.checkout,r.checkoutType,o)).then(_.partial(V,r.checkoutType,e.offerId,void 0)).catch(_.partial(H,r.checkoutType,e.offerId,{})).catch(p.showDialog)}function J(e,t,i){e.accepted&&f.getCatalogInfo([t]).then(k.transformOffer).then(_.partialRight(ge,i))}function X(e){u.open({id:O.DLC_DIALOG_ID,xmlDirective:P.getDLCPurchasePreventionDirectiveWithoutBasegame(e,null,!1,!1),size:_I}),a.events.once(Ey.x,_.partialRight(J,e.offerId))}function Z(e,t,i){i===UI.p?te(e,t):P.handleBasegameRequiredError()}function ee(e){return!!e.forcePartnerEntitlementPending}function te(e,t){f.getLowestRankedPurchasableBasegame(e).then(function(i){if(i){var n=[f.doesBasegameContainDLC(i.offerId,e.offerId),U.getPrice([i.offerId])];Promise.all(n).then(function(n){var r=Dae(n,2),o=r[0],s=r[1],c=void 0;if(o)c=P.getDLCPurchasePreventionDirectiveWithBasegameReplacement(e,i,!1,m.isCurrency(e));else{var l=m.isFreeToEntitle(i,s);c=ee(i)?P.getMandatoryBasegameDLCPurchasePreventionDirective(e,i,!1,m.isCurrency(e)):l?P.getDLCFreeEntitlePurchasePreventionDirective(O.DLC_DIALOG_ID,[e],i):P.getDLCPurchasePreventionDirective(e,i,!1,m.isCurrency(e))}u.open({id:O.DLC_DIALOG_ID,xmlDirective:c,size:_I,closeOnStateChange:!0}),a.events.once(Ey.x,_.partialRight(J,e.offerId,t))})}else X(e)}).catch(P.handleBasegameRequiredError)}function ie(e,t){return function(i){i.success?(Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:checkBuy"),r.suggestGamesToUpsellXsell(e,t,K)):(Origin.performance.endTime("COMPONENTSPERF:checkBuy"),i.reason===O.OWNED_OFFER?B(e,UI.w):i.reason===O.OWNED_HIGHER_EDITION_OFFER?B(e,UI.v):i.reason===O.GAME_IN_VAULT?P.rejectPurchaseForVaultOffer(i.product,e.offerId,t):i.reason===O.OWNED_OFFER_WITHOUT_BASEGAME?P.rejectPurchaseForOfferWithoutBasegame(i.product):i.reason===O.BASE_GAME_REQUIRED?function(e,t){!F.userHasActiveSubscription()||Origin.utils.os()!==Origin.utils.OS_WINDOWS&&m.isMacGame(e)?te(e,t):l.getHighestRankedOwnedVaultEdition(e).then(function(i){i?K(e,t):l.getHighestRankedVaultEdition(e).then(function(i){i?(u.open({id:O.DLC_DIALOG_ID,xmlDirective:P.getVaultBasegameDLCPurchasePreventionModal([e],i,O.DLC_DIALOG_ID),size:_I}),a.events.once(Ey.x,_.partialRight(W,e,t))):te(e,t)}).catch(_.partial(Z,e,t))}).catch(_.partial(Z,e,t))}(e,t):i.reason===O.INCORRECT_INPUT?p.showDialog("bad-input"):i.reason===O.OWNED_SOME_GAME_IN_OFFER?(P.openBundlePurchaseWarningDialog(i.product,i.ownedOffers),a.events.once(Ey.x,_.partialRight(W,e,t))):i.reason===O.SOFT_DEPENDENCY_REQUIRED?o.suggestDependenciesToPurchase(e,t,K):p.showDialog(Nae))}}function ne(e){var i=[O.BASE_GAME_REQUIRED,O.OWNED_OFFER,O.OWNED_OFFER_WITHOUT_BASEGAME,O.OWNED_SOME_GAME_IN_OFFER],n=e.filter(function(e){return!e.success&&i.indexOf(e.reason)>-1}),r=e.map(function(e){return e.product});n.forEach(function(e){var i;e.reason===O.BASE_GAME_REQUIRED?(i=e.product,f.getLowestRankedPurchasableBasegame(i).then(function(e){if(e){var t=[f.doesBasegameContainDLC(e[DI.Y],i[DI.Y]),U.getPrice(_.compact([e[DI.Y]]))];Promise.all(t).then(function(t){var n=Dae(t,2),r=n[0],o=n[1],s=void 0,c=m.isFreeToEntitle(e,o);s=r?P.getDLCPurchasePreventionDirectiveWithBasegameReplacement(i,e,!1,m.isCurrency(i)):ee(e)?P.getMandatoryBasegameDLCPurchasePreventionDirective(i,e,!1,m.isCurrency(i)):c?P.getDLCFreeEntitlePurchasePreventionDirective(O.DLC_DIALOG_ID,[i],e):F.isSubscriberAndVaultGame(e)?P.getVaultBasegameDLCPurchasePreventionModal([i],e,O.DLC_DIALOG_ID):P.getDLCPurchasePreventionDirective(i,e,!1,m.isCurrency(i)),u.open({id:O.DLC_DIALOG_ID,xmlDirective:s,size:_I,closeOnStateChange:!0}),a.events.once(Ey.x,_.partialRight(J,i[DI.Y],void 0))})}else X(i)}).catch(function(e){t.error("[PurchaseFactory] openBaseGameRequiredDialog error",e),P.handleBasegameRequiredError()})):e.reason===O.OWNED_OFFER?B(e.product,UI.w):e.reason===O.OWNED_OFFER_WITHOUT_BASEGAME?P.rejectPurchaseForOfferWithoutBasegame(e.product):e.reason===O.OWNED_SOME_GAME_IN_OFFER&&(P.openBundlePurchaseWarningDialog(e.product,e.ownedOffers),a.events.once(Ey.x,_.partialRight(q,r)))}),0===n.length&&r.length>0?(Origin.performance.endTimeMeasureAndSendTelemetry("COMPONENTSPERF:checkBuyAddOns"),ge(r).catch(p.showDialog)):Origin.performance.endTime("COMPONENTSPERF:checkBuyAddOns")}function re(e){Origin.performance.endTime("COMPONENTSPERF:checkBuy"),e&&e.reason===O.UNOPENED_GIFT&&a.events.fire(Ey.M,Mae,{offerId:e.offerId,fromSPA:!0})}function oe(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipPurchasePreventionCheck:!1};C.unblockUI(),T.checkUnopenedGift(e).then(_.partial(T.checkProduct,e,i.skipPurchasePreventionCheck)).then(ie(e,t)).catch(re)}function ae(e){return Origin.performance.endTime("COMPONENTSPERF:checkBuy"),Promise.reject(e)}function se(e,t,i){(t=t||{}).checkoutType=t.checkoutType||I.DEFAULT,Origin.performance.beginTime("COMPONENTSPERF:checkBuy"),C.blockUI(),G.validateCurrentStorefront().then(function(){return w.getGameDataWithEntitlements(e)}).then(k.transformOffer).then(_.partial(Pe,e,void 0)).then(C.unblockUIPromise).then(_.partialRight(oe,t,i)).catch(ae).catch(ce)}function ce(e){var t=_.get(e,"errorCode",e),i=_.get(e,"replaceMap",{});switch(C.unblockUI(),t){case UI.a:G.handleWrongStorefrontError(UI.a);break;default:p.showDialog(t,i)}}function le(e){var t=_.get(e,"errorCode",e),i=_.get(e,"replaceMap",{});return C.unblockUIPromiseOnError(t).catch($.endPerformanceTimerBuy).catch(_.partialRight(p.showDialog,i))}function de(e,t){var i=!0;return _.forEach(e,function(e){if(!t.hasOwnProperty(e))return i=!1,!1}),i?Promise.resolve(t):Promise.reject("invalid-products")}function ge(e,t){var i=[],n=[],r="",o=!0,a="",s="",l="",d="";return e=_.values(e),_.forEach(e,function(e){e.cartName&&(r=e.cartName),_.has(e,"needClearCart")&&(o=e.needClearCart),e.fictionalCurrencyCode&&(a=e.fictionalCurrencyCode),e.categoryId&&(s=e.categoryId),e.invoiceSource&&(l=e.invoiceSource),m.isSubscription(e)?n.push(e.offerId):i.push(e.offerId)}),Origin.user.userStatus()===Origin.defines.userStatus.BANNED?Promise.reject(Gae):e.length>1&&a?Promise.reject(Uae):n.length>1||0===i.length?Promise.reject(Uae):(d=n.length>0?I.CHAINED:g.isOIGContext()?a?I.TOPUP_OIG:I.DEFAULT_OIG:a?I.TOPUP:I.DEFAULT,$.beginPerformanceTimerCheckoutCart(),function(e,t,i,n,r,o){var a={cartName:i,needClearCart:n,currency:r},s=o?o.promoCode:"";return c.addOfferList(t,a).then(_.partial(Y,s))}(0,i,r,o,a,t).then(_.partial(M,d)).then(_.partial(ue,e,a)).then(_.partialRight(me,d,r,a,s,l,_.head(n))).catch($.endPerformanceTimerOnError).catch(p.showDialog))}function ue(e,t){return _.forEach(e,function(e){e.hasSufficientBalance=!1}),1===e.length&&t?h.getWalletBalance(t).then(_.partial(pe,e[0])).then(function(){return e}):e}function pe(e,t){_.isObject(e)&&(e.hasSufficientBalance=t>=e.price)}function me(e,t,i,n,r,o,a){return 1===e.length&&e[0].hasSufficientBalance?d.checkoutUsingBalance(e[0].offerId):d.checkout(t,{cartName:i,virtualCurrency:n,category:r,invoiceSource:o,offerId:a})}function fe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&t&&d.openCheckoutConfirmation([e]),je.fire(Ey.A,[e]),Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_ENTITLEMENT_SUCCESS,e)}function he(e,t){var i=_.get(t,"errorCode",t);return t&&t.reason===O.UNOPENED_GIFT?(re(t),Promise.resolve()):(i===UI.t?u.open({id:"vault-upgrade-savegame-warning",xmlDirective:'<origin-dialog-vaultupgradewarning\n                                class="origin-dialog-content"\n                                dialog-id="vault-upgrade-savegame-warning"\n                                offer-id="'+e+'">\n                                </origin-dialog-vaultupgradewarning>',size:_I}):i===UI.c?u.open({id:"vault-dlc-upgrade-warning",xmlDirective:'<origin-dialog-vaultdlcupgradewarning class="origin-dialog-content" dialog-id="vault-dlc-upgrade-warning" offer-id="'+e+'"></origin-dialog-vaultdlcupgradewarning>',size:OI}):"user-under-age"===i?p.showDialog("user-under-age-vault-entitlement"):i===A.OFFER_BANNED_IN_COUNTRY_VAULT?p.showDialog(i,t.replaceMap):i===UI.a?G.openGeoBlockDialog():p.showDialog("vault-entitlement-failed"),a.events.fire(Ey.H.ENTITLEMENT_FAILED_EVENT,e),Promise.reject(t))}function ve(e){var t=y.getProperty(["gamehub","keys","sling"])(e)||void 0,i=_.values(y.getProperty(["gamehub","siblings"])(e)||{});return t&&i.push(t),i}function be(e,t){var i=0,n=void 0,r={},o=!0;if(!_.isEmpty(t)){if(_.forEach(t,function(t){t.hasOwnProperty("offerId")&&t.offerId===e&&(i=t.weight||0,n=_.get(t,["platforms","PCWIN","showSubsSaveGameWarning"],!1)),_.get(t,"offerId")!==e&&_.get(t,"isOwned",!1)&&(r[t.offerId]=t.weight||0),t.hasOwnProperty("offerId")&&t.offerId===e&&o&&(o=!1)}),o)return Promise.reject(UI.c);if(n){var a=!1;if(_.forEach(r,function(e){e<i&&!a&&(a=!0)}),a)return Promise.reject(UI.t)}}}function ye(e,t){if(!t)return v.getOcdByOfferId(e).then(ve).then(function(e){return S.getByOcdPathPromise(e,!1,!0)}).then(_.partial(be,e))}function Se(e){var t=_.head(_.values(e)),i=F.isStandardSubscriber()&&t.vaultOcdPath&&t.offerPath&&t.vaultOcdPath!==t.offerPath,n=F.isPremiumSubscriber()&&t.premierVault&&t.premierVault.path&&t.premierVault.path!==t.offerPath;return i?f.getOfferIdByPath(t.vaultOcdPath,!x.isShellBundle(t)):n?f.getOfferIdByPath(t.premierVault.path,!x.isShellBundle(t)):Promise.resolve(t.offerId)}function ke(e){return f.getCatalogInfo([e]).then(Se)}function Ie(e,t,n){return function(){i.detachAll(ze[e]),clearTimeout(He[e]),t(n)}}function we(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.promiseLogin().then(function(){return G.validateCurrentStorefront()}).then(_.partial(Oe,e)).then(_.partial(Pe,e,D.VAULT)).then(T.checkUnopenedGift).then(C.blockUIPromise).then(_.partial(ye,e,t)).then(_.partial(ke,e)).then(function(e){return v.vaultEntitle(e,n.lesserOfferId)}).then(function(t){return function(e,t,n){return n?(He[t]&&clearTimeout(He[t]),ze[t]&&ze[t].length&&i.detachAll(ze[t]),ze[t]=[],new Promise(function(i,n){ze[t].push(v.events.once(Ey.l,Ie(t,i,e))),ze[t].push(v.events.once(Ey.B,Ie(t,i,e))),He[t]=setTimeout(function(){clearTimeout(He[t]),n(UI.q)},Hae)})):e}(t,e,n.waitForEntitlementsRefresh)}).then(C.unblockUIPromise).then(_.partial(fe,e,n.showCheckoutConfirmation)).catch(C.unblockUIPromiseOnError).catch(_.partial(he,e))}function Ce(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&t.success)return fe(e,i),a.events.fire(Ey.H.ENTITLEMENT_SUCCESS_EVENT,{offerId:e}),Promise.resolve(t);if(t&&!t.success){var n=y.defaultTo("")(y.getProperty(["extra","cause"])(t));return a.events.fire(Ey.H.ENTITLEMENT_FAILED_EVENT,{offerId:e,errorMessage:n}),p.showDialog(n),Promise.reject(t)}}function Te(e,t){var i=_.find(t,function(t,i){return i.toLowerCase()===e.toLowerCase()});return i?i.offerId:e}function Pe(e,t,i){return _e(e=_.isArray(e)?_.map(e,function(e){return Te(e,i)}):Te(e,i),i).then(_.partial(L.getUserLocationCountryCodeFromEadp,Origin.user.userPid())).then(_.partialRight(R.validateOffers,e,i,t)).then(function(){return _.isArray(e)?_.pick(i,e):i[e]})}function _e(e,t){if(_.isArray(e)){var i=[];return _.forEach(e,function(e){i.push(E.validateUserAgePromise(t[e]))}),Promise.all(i)}return E.validateUserAgePromise(t[e])}function Oe(e){return f.getCatalogInfo([e])}function Ee(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return v.directEntitle(e).then(_.partial(_.partialRight(Ce,t),e)).then(C.unblockUIPromise)}function Fe(e,t){e.accepted&&(C.blockUI(),Ee(t).catch(C.unblockUIPromiseOnError).catch(xe))}function xe(e,i){_.isString(e)&&(e={reason:e});var n,r=e,o=r.reason,s=r.errorCode;o===O.BASE_GAME_REQUIRED?(n=e.product,F.userHasActiveSubscription()?l.getHighestRankedVaultEdition(n).then(function(e){return e||f.getLowestRankedPurchasableBasegame(n)}):f.getLowestRankedPurchasableBasegame(n)).then(function(t){return Me(e.product,t)}).catch(function(e){t.error("[PurchaseFactory] handleFreeGameEntitlementError error",e),P.handleBasegameRequiredError()}):o===O.OWNED_OFFER_WITHOUT_BASEGAME&&e.product?P.rejectPurchaseForOfferWithoutBasegame(e.product):s===A.OFFER_BANNED_IN_COUNTRY_FREEGAMES?p.showDialog(s,e.replaceMap):o===UI.a?G.openGeoBlockDialog():p.showDialog(o),a.events.fire(Ey.H.ENTITLEMENT_FAILED_EVENT,i)}function Le(){var e=F.getSubscriptionLevel()===yI.y.PREMIUM?yI.p.SIGN_UP_PREMIER:yI.p.SIGN_UP_BASIC;u.openDirective({id:uI,name:gI,size:_I,data:{mode:e,id:uI}})}function Ae(){var e=F.getUserLastSubscriptionOfferId(),t={checkoutType:I.SUBS};e?f.getCatalogInfo([e]).then(function(i){var n=_.head(_.values(i));n&&n.isPurchasable?se(e,t):Le()}):Le()}function De(e){var t={currency:Origin.locale.currencyCode()};return c.addOffer(e,t).catch(Re)}function Re(e){var t=_.get(e,["response","error","code"]);throw t?_.kebabCase(t):e}function $e(){b.goToState(bI.s)}function Ne(e,t,i,n){n===Rae?P.openMacSubscriptionWarningDialog({subscriptionOfferId:i},t,yI.p.UPGRADE_PREMIER):H(e,i,{subscriptionOfferId:t},n)}var Ge,Ue,Be=(Ge=Kf(regeneratorRuntime.mark(function e(t,i){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=_.some(t,x.isSubscriptionFreeTrial))){e.next=10;break}return e.next=4,N.isFreeTrialEnabled(i);case 4:if(r=e.sent,!n||r||!_.isEmpty(o)){e.next=9;break}return e.abrupt("return",Promise.reject(jae));case 9:return e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}},e,this)})),function(e,t){return Ge.apply(this,arguments)}),Me=(Ue=Kf(regeneratorRuntime.mark(function e(t,i){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.next=3,U.getPrice(_.compact([_.get(i,DI.Y)]));case 3:r=e.sent,o=m.isFreeToEntitle(i,r),n=F.isSubscriberAndVaultGame(i)?P.getVaultBasegameDLCPurchasePreventionModal([t],i,O.DLC_DIALOG_ID):o?P.getDLCFreeEntitlePurchasePreventionDirective(O.DLC_DIALOG_ID,[t],i):P.getDLCPurchasePreventionDirective(t,i,!0),u.open({id:O.DLC_DIALOG_ID,xmlDirective:n,size:_I}),a.events.once(Ey.x,_.partialRight(Fe,_.get(t,DI.Y)));case 8:case"end":return e.stop()}},e,this)})),function(e,t){return Ue.apply(this,arguments)}),je=new Origin.utils.Communicator,He={},ze={};return Origin.events.on(Origin.events.CLIENT_NAV_RENEW_SUBSCRIPTION,Ae),{buy:se,gift:function(e,t){t=t||{};var i=_.get(e,"offerId"),n=_.get(e,"recipientId"),r=_.get(e,"message"),o=_.get(e,"senderName");t.checkoutType=t.checkoutType||I.GIFT,$.beginPerformanceTimerBuy(),C.blockUI(),f.getCatalogInfo([i]).then(_.partial(Pe,i,D.GIFT)).then(_.partialRight(Q,n,o,r,t)).then(C.unblockUIPromise).catch(le)},buyAddons:function(e){return $.beginPerformanceTimerBuyAddOn(),e=y.wrapInArray(e),C.blockUI(),G.validateCurrentStorefront().then(function(){return f.getCatalogInfo(e)}).then(_.partial(de,e)).then(k.transformOffer).then(_.partial(Pe,e,void 0)).then(C.unblockUIPromise).then(T.checkProducts).then(ne).catch($.endPerformanceTimerBuyAddOn).catch(ce)},entitleVaultGame:we,entitleFreeGame:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return s.promiseLogin().then(function(){return G.validateCurrentStorefront()}).then(C.blockUIPromise).then(function(){return Oe(e)}).then(k.loadPrices).then(function(t){return Pe(e,D.FREEGAME,t)}).then(function(e){return T.checkProduct(e,t)}).then(function(t){return function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.success||t.reason===O.OWNED_SOME_GAME_IN_OFFER?Ee(e,i):Promise.reject(t)}(e,t,i)}).catch(C.unblockUIPromiseOnError).catch(function(t){return xe(t,e)})},renewSubscription:Ae,entitleVaultGameFromLesserBaseGame:function(e){return f.getCatalogInfo([e]).then(Se).then(function(t){return we(t,!1,{lesserOfferId:e,waitForEntitlementsRefresh:!0})})},subscriptionCheckout:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(e){var n={checkoutType:I.SUBS,subsConfirmation:!1,friendReferralToken:i};if(b.isState(bI.t)&&(n.invoiceSource=g.getSetting("invoiceSources").accessWwce),F.userHasSubscription()&&!F.isRecurringSubscriber()&&!F.isCodeRedeemSubscription()&&!t)return function(e){u.openDirective({id:QP.id,name:QP.name,size:"large",data:{"offer-id":e}})}(e);if(F.userHasSubscription()&&!F.isCodeRedeemSubscription()&&!F.isInStackableCountry())return H(n.checkoutType,e,{},UI.b);(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return f.getCatalogInfo([e]).then(_.partialRight(Be,e,t))})(e,i).then(_.partial(se,e,n)).catch(p.showDialog)}},chainCheckout:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return w.getGameDataWithEntitlements(t).then(_.partial(_e,t)).then(_.partial(j,I.SUBS,_.get(i,"subsConfirmation"),e)).catch(_.partial(H,I.CHAINED,t,{subscriptionOfferId:e,friendReferralToken:i.friendReferralToken}))},upgradeSubscriptionCheckout:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var i={checkoutType:I.SUBS,subsConfirmation:t};De(e).then(_.partial(j,i.checkoutType,i.subsConfirmation,void 0)).then(_.partial(d.checkout,i.checkoutType,{invoiceSource:i.invoiceSource})).then(_.partial(V,yI.p.UPGRADE_PREMIER,e,e)).catch(_.partial(Ne,yI.p.UPGRADE_PREMIER,e,e))}},events:je}}function Jf(e,t,i,n,r,o,a){"ngInject";return{filterSuggestedOffers:function(s){if(!s||0===s.length)return Promise.resolve(s);var c=function(e){return e.reduce(function(e,t){return e.ocdNodes=e.ocdNodes||[],Object.keys(t).some(function(e){return e.includes("byob")})?e.byobNode=t:e.ocdNodes.push(t),e},{})}(s),l=c.ocdNodes,d=c.byobNode,g=function(t){return t.map(function(t){var i=_.get(t,[Vae,Wae]);if(i)return n.getCatalogByPath(i).then(function(e){return _.head(_.values(e))}).then(function(t){return e.isNotPurchasableAndNotVaultGame(t)?{offerPath:i,isNotPurchasableAndNotVaultGame:!0}:t})})}(l);return Promise.all(g).then(function(r){var s={};_.forEach(r,function(e){s[e.offerPath]=e});var c=l.map(function(r){var o=_.get(r,[Vae,Wae]);return function(r){return r.isNotPurchasableAndNotVaultGame?{offerPath:r.offerPath,remove:!0}:t.isAddOnProductOrBundleOwned(r).then(function(t){return t?{offerPath:r.offerPath,remove:!0}:(o=r.masterTitleId,i.getUnopenedGiftBaseGameEntitlementByMasterTitleId(o).then(function(e){return e||i.getLowestRankingGiftedBasegameEntitlementByMasterTitleId(o)})).then(function(t){if(e.isBaseGameOfferType(r)&&!e.isBundle(r)&&!_.isUndefined(t))return{offerPath:r.offerPath,remove:!0};if(e.isBundle(r)&&!_.isUndefined(t)){var i=_.get(r,"bundleOffers",[]);return _.some(i,function(e){return e===t[Yae]})?{offerPath:r.offerPath,remove:!0}:function(t,i){return n.getCatalogInfo(t).then(function(t){return _.some(t,function(t){return e.isBaseGameOfferType(t)})?{offerPath:i,remove:!0}:{offerPath:i,remove:!1}})}(i,r.offerPath)}return{offerPath:r.offerPath,remove:!1}});var o})}(s[o])});return Promise.all(c).then(function(t){return function(t,i){return _.isEmpty(t)?Promise.resolve(t):Promise.all(_.map(t,function(t){var n=_.get(t,[Vae,Wae]),r=_.get(i,n);return o.getPrice(_.compact([_.get(r,Yae)])).then(function(i){var n=_.cloneDeep(t);return e.isFreeToEntitle(r,i)&&_.get(t,[Vae,qae])===a.XSELL&&_.set(n,[Vae,qae],a.FREE),n})}))}(function(t,i){return _.filter(t,function(n){var r=!1,o=i[_.get(n,[Vae,Wae])];return e.isBundle(o)||(r=_.some(t,function(t){var n=_.get(t,[Vae,Wae]),r=i[n];return e.isBundle(r)&&_.get(r,["bundleOffers"],[]).includes(o[Yae])})),!r})}(_.filter(l,function(e){var i=_.get(e,[Vae,Wae]);return _.some(t,function(e){return i===e.offerPath&&!e.remove})}),s),s).then(function(e){return d?[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(e),[d]):e})})}).catch(function(e){return r.error(Vae,e),[]})}}}function Xf(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f){"ngInject";function h(e){var t=_.map(e,function(e){return y(e).then(function(t){if(t)return e})});return Promise.all(t).then(_.compact)}function v(t){return Promise.all([e.getBaseGameEntitlementByMasterTitleId(t),u.getUnopenedGiftBaseGameEntitlementByMasterTitleId(t)]).then(_.spread(function(e,i){var n=!!e&&"DISABLED"!==_.get(e,"status"),r=!!i&&"DISABLED"!==_.get(i,"status");return!(!n&&!r)||u.getLowestRankingGiftedBasegameEntitlementByMasterTitleId(t)})).catch(function(e){return d.error("Could not retrieve BaseGame Entitlement By Master TitleId "+t,e),!1})}function b(e){return!t.isBaseGameOriginDisplayType(e)&&(t.isDLC(e)||t.isCurrency(e))}function y(e){return b(e)?v(e.masterTitleId).then(function(i){if(i||t.isOnlineSubscription(e))return!1;var n=_.map(e.alternateMasterTitleIds,function(e){return v(e)});return Promise.all(n).then(function(e){return!_.some(e,function(e){return e})})}):Promise.resolve(!1)}function S(e,t){return _.map(t,function(t){var i=_.keys(t)[0],n=_.values(t)[0];return-1!==e.indexOf(i)?i:n}).filter(function(e){return e})}function k(e){return c.getHighestOwnedEdition(e).then(function(t){return i={},n=e.offerId,r=_.get(t,[DI.Y]),n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i;var i,n,r})}function I(e){var t=_.get(e,"bundleOffers",[]);return _.isEmpty(t)?Promise.resolve(!1):Promise.all([function(e){return o.getGameDataWithEntitlements(e).then(o.getOutrightOwnedProducts).then(function(e){return _.map(e,function(e){return _.get(e,"offerId","")})})}(t),function(e){return i.getCatalogInfo(e).then(function(e){return Promise.all(_.map(e,k))})}(t)]).then(_.spread(S))}function w(e){return function(e){return new Promise(function(i){r.isUnopenedGift(e.offerId)?i(e):t.isBaseGameOfferType(e)?s.getByOcdPathPromise(e.offerPath).then(function(t){var n=t[e.offerPath];c.getEditions(n).then(function(e){i(_.find(e,function(e){return r.isUnopenedGift(e.offerId)}))})}):i(null)})}(e).then(function(e){if(e)return Promise.reject({reason:a.UNOPENED_GIFT,offerId:e.offerId})})}function C(e,t){return _.isEmpty(t)?P(e):{success:!1,reason:a.OWNED_SOME_GAME_IN_OFFER,ownedOffers:_.uniq(t),product:e}}function T(e){return{success:!0,reason:a.AVAILABLE_FOR_PURCHASE,product:e}}function P(e){return function(e){return b(e)?Promise.resolve(!1):c.getHighestOwnedEdition(e)}(e).then(function(i){return i?{success:!1,reason:a.OWNED_HIGHER_EDITION_OFFER,product:i}:t.isOnTheHouse(e)||t.isZeroPricedOffer(e)||!p.isSubscriberAndVaultGame(e)&&!p.isUserSubscriberAndUpgradable(e)?T(e):f.loadPrices([e]).then(function(){return 0!==e.price?c.getHighestRankedVaultEdition(e).then(function(i){return i&&!t.isOwnedThroughVault(i)?function(e){return{success:!1,reason:a.GAME_IN_VAULT,product:e}}(i):T(e)}):T(e)})}).catch(function(t){return d.error("PurchasePreventionFactory: Unable to check higher editions.",t),T(e)})}function O(e){return y(e).then(function(i){return i?{success:!1,reason:a.BASE_GAME_REQUIRED,product:e}:t.isAlphaTrialDemoOrBeta(e)||t.isEarlyAccessTrial(e)?{success:!0,product:e}:t.isBundle(e)?function(e){return l.blockUIPromise(e).then(I).then(l.unblockUIPromise).then(_.partial(C,e)).catch(function(){return l.unblockUI(),T(e)})}(e):P(e)})}function E(e){return o.loadEntitlementsInfo(e).then(function(t){return!(!t.isOwned||t.vaultEntitlement||t.firstPartyVaultEntitlement)||g.getDLCEntitlementsWithoutBasegame(e).then(function(t){return F(e,t,0)})}).catch(function(e){return e.reason!==Qae&&d.error("PurchasePreventionFactory: Unable to check if user owns the product.",e),!1})}function F(e,n,r){var o=_.find(n,function(t){return t.productId===e.offerId});if(o){var a=m.isInSubscription(o);return Promise.resolve(!a)}return t.isShellBundle(e)&&t.hasBundleOffers(e)?function(e,t,n){var r=_.map(t,"productId");if(n>=Xae)return Promise.reject({reason:Jae,offerId:e.offerId});var o=_.difference(e.bundleOffers,r);return 0===o.length?Promise.resolve(!0):i.getCatalogInfo(o).then(function(i){if(o.length!==i.length)return Promise.reject({reason:Qae,offerId:e.offerId});var r=_.map(i,function(e){return F(e,t,n+1)});return Promise.all(r).then(function(e){return _.every(e)})})}(e,n,r):Promise.reject({reason:Qae,offerId:e.offerId})}function x(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _.isObject(e)?!0===i?Promise.resolve({success:!0,product:e}):t.isOwnedOutright(e)&&!t.isRepurchasable(e)?Promise.resolve({success:!1,reason:a.OWNED_OFFER,product:e}):t.hasSoftDependency(e)?function(e){return g.getDLCEntitlementsWithoutBasegameForSameMasterTitleId({product:e}).then(function(t){var i=!1,n=!1,r=[{offerId:e.offerId,isOwned:!1},{offerId:e.softDependency[0],isOwned:!1}];return _.forEach(r,function(r){r.offerId===e.offerId?i=_.some(t,function(e){return e.productId===r.offerId}):r.offerId===e.softDependency[0]&&(n=_.some(t,function(e){return e.productId===r.offerId}))}),i?{success:!1,reason:a.OWNED_OFFER_WITHOUT_BASEGAME,product:e}:function(e,t){return y(e).then(function(i){return i?p.userHasSubscription()?{success:!1,reason:a.SOFT_DEPENDENCY_REQUIRED,product:e}:t?{success:!1,reason:a.BASE_GAME_REQUIRED,product:e}:{success:!1,reason:a.SOFT_DEPENDENCY_REQUIRED,product:e}:{success:!1,reason:a.SOFT_DEPENDENCY_REQUIRED,product:e}})}(e,n)}).catch(function(){return{success:!1,reason:a.UNKNOWN_ERROR,product:e}})}(e):function(e){return E(e).then(function(t){return t?{success:!1,reason:a.OWNED_OFFER_WITHOUT_BASEGAME,product:e}:O(e)})}(e):Promise.resolve({success:!1,reason:a.INCORRECT_INPUT})}return{getProductsWithUnownedBaseGames:h,getOwnedDLCWithoutBasegame:function(e){return g.getDLCEntitlementsWithoutBasegameForSameMasterTitleId(e).then(function(t){return _.find(e,function(e){return _.some(t,function(t){return t.productId===e.offerId})})})},buildRequiredBaseGames:function(e){return Promise.all(_.map(e,function(e){return i.getLowestRankedPurchasableBasegameOfferId(e).then(function(t){return{offerId:t,product:e}})})).then(function(e){var t={};return _.forEach(e,function(e){t[e.offerId]=t[e.offerId]||[],t[e.offerId].push(e.product)}),t})},getProductsWithBaseGameNotInCart:function(e){return h(e).then(function(i){return _.forEach(e,function(e){t.isBaseGameOfferType(e)&&(i=_.reject(i,function(t){return-1!==_.get(t,"alternateMasterTitleIds",[]).indexOf(_.get(e,"masterTitleId",""))||_.get(t,"masterTitleId","")===_.get(e,"masterTitleId","")}))}),i})},isAddOnProductOrBundleOwned:E,checkProduct:x,checkProducts:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.all(_.map(e,function(e){return x(e,t)}))},checkUnopenedGift:w,checkUnopenedGifts:function(e){var t=_.map(e,w);return Promise.all(t)}}}function Zf(e){function t(t,i){var r=function(e,t){return e&&t?_.kebabCase([t,e].join("-")):""}(t,i);return r?e.getLocalizedStr(void 0,n,r):""}function i(e){if(!_.isEmpty(e)){var i=e.gameRatingDescriptionLong,n=e.gameRatingTypeValue,r=_.get(e,"gameRatingType");if("ESRB"===r){if(i){var o=t(i,r);o&&(e.gameRatingDescriptionLong=o)}if(n){var a=t(n,r);a&&(e.gameRatingTypeValue=a)}_.isEmpty(e.gameRatingDesc)||_.forEach(e.gameRatingDesc,function(i,n){var o=t(i,r);o&&(e.gameRatingDesc[n]=o)})}return e}}var n="origin-store-game-rating";return{getTranslatedGameRating:t,updateGameWithLocalizedRatings:i,updateGamesWithLocalizedRatings:function(e){return _.forEach(e,i),e}}}function eh(e,t){"ngInject";return t.get("RatingSystemFactory",Zf,this,arguments)}function th(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ih(e,t,i,n,r){"ngInject";function o(e){var t=_.compact(e.split("/"));return _.last(t)}function a(e){var t=o(e);return"mac-pc-download-addon-"+(t===ase+"-pack"?ase:t)}function s(e){var t=_.get(e,["variants","0"]);return t&&(t[rse]=_.get(e,rse),t.image=Origin.sims.getCommunityImagesCDN()+_.get(t,"image")),t}function c(e,t){var i;return th(i={},n.CREATE_A_SIM,{items:e}),th(i,n.BUILD_A_SIM,{items:t}),i}function l(e){e=_.get(e,"items",[]);var t=_.compact(_.map(e,s));return c(_.filter(t,[rse,nse]),_.filter(t,[rse,ise]))}function d(e){return function(e){return new Promise(function(t,i){var n=_.find(_.get(e,"sections",[]),{type:"galleryStream"});if(n){var r=_.get(n,["content","stream","data"]);if(r)try{var o=JSON.parse(r),a=_.get(o,sse,[]);t(_.map(a,function(e){var t=_.get(e,["EA.Sims4.Network.ExchangeEnvelope.metadata"]);return{trayMeta:{type:_.get(t,[ose+".type"]),creatorName:_.get(t,[ose+".creator_name"]),creatorId:_.get(t,[ose+".creator_id"]),creationName:_.get(t,[ose+".name"])},uuid:_.get(e,"EA.Sims4.Network.ExchangeEnvelope.uuid")}}))}catch(e){i()}}i()})}(e).then(function(e){return _.map(e,function(e){var t,n=i.uuid2Guid(e.uuid),r=e.trayMeta,o=(t=r.type,cse[t]||cse.default);return{imageUrl:Origin.sims.getMediaCarouselContentCDN(i.getFilePath(n),n,o.traytype,o.traysuffix),creationName:r.creationName,creatorName:r.creatorName,creatorId:r.creatorId}})})}function g(){return c([],[])}function u(){return Promise.resolve([])}function p(t){return t.franchiseFacetKey===tse&&(e.isAddon(t)||e.isExpansion(t)||e.isNoneType(t))&&e.isHybridGame(t)}function m(e){return p(e)?Origin.sims.getCommunityImages(a(e.offerPath)).then(l).catch(g):Promise.reject()}function f(e){return p(e)?Origin.sims.getMediaCarouselImages(a(e.offerPath)).then(d).catch(u):Promise.reject()}function h(e){return t.getCatalogByPath(e).then(_.values).then(_.head)}return{getCreativeCommunityImages:function(e){return h(e).then(m).catch(g)},getCreativeCommunityMediaCarouselImages:function(e){return h(e).then(f).catch(u)},localizeSimsMediaCarouselUrl:function(e){if(e){var t=Origin.locale.locale().replace("_","-").toLowerCase();return e.replace("%locale%",_.get(r,["sims","originToSimsLocaleMap",t],t))}},getEditionNameFromOcdPath:o,buildSimsProductName:a}}function nh(e,t,i,n,r,o){"ngInject";function a(){var t=e.get(dse);return t&&_.isArray(t)?t:[]}function s(e){return a().indexOf(e)>-1}function c(e){return _.compact(e.split(","))}function l(e){var t,i=(t=n.getHrefFromState(n.getCurrentState()),o.stripStorefrontAndLocaleFromPath(o.stripQueryParams(t)));return _.some(e,function(e){return e.trim()===i})}function d(e){var t=n.getCurrentState();e.siteStripeVisible=t&&t.name&&t.name.indexOf("store")>0&&!s(e.uniqueSitestripeId)&&function(e){var t=c(_.get(e,"showOnPage",""));return!_.size(t)||l(t)}(e)&&function(e){return!l(c(_.get(e,"hideOnPage","")))}(e),e.siteStripeVisible&&Origin.telemetry.events.fire("originStoreSitestripeVisible")}return{siteStripeLinkFn:function(t){return function(o){"origin-store-sitestripe-timermessageoftheday"!==t&&(o.isReady=!0);var s=void 0,c=i.getLocalizedStr(o.href,t,"href");o.cssClass=gse[t]||"",pse.indexOf(t)<0&&d(o),o.dismissSiteStripe=function(){!function(t){if(t){var i=a();i?i.indexOf(t)<0&&(i.push(t),e.set(dse,i)):e.set(dse,[t])}}(o.uniqueSitestripeId),o.siteStripeVisible=!1,r.events.fire(Ey.K,o.uniqueSitestripeId)},o.enableSiteStripe=function(){!function(t){if(t){var i=a();if(i){var n=i.indexOf(t);i.indexOf(t)>-1&&(i.splice(n,1),e.set(dse,i))}}}(o.uniqueSitestripeId)},o.strings={href:c,hrefAbsoluteUrl:n.getAbsoluteUrl(c)},o.fontcolor=o.fontcolor||YS.light,_.isUndefined(o.showOnPage)&&_.isUndefined(o.hideOnPage)||!(pse.indexOf(t)<0)||(s=_.partial(d,o),r.events.on("uiRouter:stateChangeSuccess",s),o.$on("siteStripeWrapper:cleanUp",function(){r.events.off("uiRouter:stateChangeSuccess",s)})),o.imagePositionClass=o.imagePosition===KS.center?K3:Q3,o.edgecolor=o.edgecolor||use[t];var l=o.backgroundColor||o.edgecolor;o.image&&l&&(o.imageBackgroundColorStyle="linear-gradient(to right, transparent 0%, "+l+" 100%)")}},retrieveTemplate:function(e){return t.getTemplate("sitestripe",{},e)},showAllSiteStripes:function(){e.set(dse,[])},isSitestripeClosed:s}}function rh(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oh(e,t,i,n,r,o,a,s,c,l,d,g){"ngInject";function u(e){return n.delete(vse,!0),e&&e.reason===b4?Promise.reject(e):[]}function p(e,t){return{promoRuleId:e,promoRuleOffer:_.get(t,"offerPool",[])}}function m(e){return t.isOwnedOutright(e)||i.isUnopenedGift(e.offerId)}function f(e,i){return _.map(e,function(e,n){var r=_.get(e,["offers"]);return l.getCatalogInfo(r).then(function(e){return d.transformOffer(e,i)}).then(_.values).then(function(i){var r,o=_.some(i,t.isBaseGameOfferType),a=(r=_.head(i))?r.extraContentDisplayGroup?bse[r.extraContentDisplayGroup]:bse[yse.FULL_GAME]:"";return e.extraContentDisplayGroup=a,{groupIndex:n,games:i,includesBaseGame:o,extraContentDisplayGroup:a,doesntOwnEveryGameInThisCategory:_.some(i,_.negate(m))}}).catch(function(){return{groupIndex:n,games:[],includesBaseGame:!1,doesntOwnEveryGameInThisCategory:!0}})})}function h(e,t){var i=_.flatten(_.map(e,function(e){return e.games})),n=i[0].masterTitleId;return o.getBaseGameEntitlementOfferIdByMasterTitleId(n)?Promise.resolve(t):o.getDLCEntitlementsWithoutBasegameForSameMasterTitleId(i).then(function(t){A=t;var i=_.find(e,function(e){return function(e,t){return!_.some(e,function(e){return!_.some(t,function(t){return t.productId===e[DI.Y]})})}(e.games,t)});return i&&(i.doesntOwnEveryGameInThisCategory=!1),i}).then(function(e){return e?Promise.reject({reason:b4,groupIndex:e.groupIndex,displayGroup:e.extraContentDisplayGroup}):t})}function v(e,t){var i=f(e,t);return Promise.all(i).then(function(t){var i=_.find(t,{doesntOwnEveryGameInThisCategory:!1}),n=_.filter(t,{includesBaseGame:!1});return i?Promise.reject({reason:b4,groupIndex:i.groupIndex,displayGroup:i.extraContentDisplayGroup}):h(n,e)})}function b(e){x.data[e.groupIndex]=e[DI.Y]}function y(e,i){var n=_.map(i,function(e){return e[DI.Y]});return l.getCatalogInfo(n).then(d.transformOffer).then(_.values).then(function(n){return function(e,i){_.reject(e,t.isOwnedOutright).length&&(_.forEach(i,function(i){var n=_.find(e,rh({},DI.Y,i[DI.Y]));n&&(t.isBaseGameOfferType(n)?b(i):P(n)||b(i))}),x.commit())}(n,i),e}).catch(function(){return e})}function S(e){var t=n.get(hse,{},!0);if(!t)return Promise.resolve(e);var i=function(e,t){var i=[];return _.forEach(e,function(e,n){var r;_.get(e,["offers"]).indexOf(t[n])>=0&&i.push((rh(r={},DI.Y,t[n]),rh(r,"groupIndex",n),r))}),i}(e,t=_.values(t));return i.length?y(e,i):function(e){return F(),Promise.resolve(e)}(e)}function k(e,t){var i=_.map(e,function(e){return Origin.commerce.getPromotionRuleData(e).then(_.partial(p,e))});return Promise.all(i).then(I).then(w).then(function(e){return v(e,t)}).catch(u)}function I(e){return _.remove(e,function(e){return _.size(_.get(e,"promoRuleOffer",[]))>0})}function w(e){return _.size(e)>0?(i=e[0].promoRuleOffer,n=i.map(function(e){return _.get(e,["offers","0"])}),l.getCatalogInfo(n).then(_.values).then(function(e){var n=_.find(e,t.isBaseGameOfferType);return _.findIndex(i,function(e){return _.get(e,"offers",[]).includes(_.get(n,[DI.Y]))})})).then(function(t){if(t>=0){!function(e,t){var i=_.map(e,function(e){var i=_.get(e,["promoRuleOffer",t,"offers","0"]);if(i)return D[i]=e.promoRuleOffer,R[i]=e.promoRuleId,i;throw S4});_.forEach(i,function(e){_.set(D[e],[t,"offers"],i)})}(e,t);var i=O();return _.get(D,i)||(n=_.keys(D),l.getCatalogInfo(n).then(_.values).then(function(e){var t=e.sort(g5),i=_.get(_.head(t),DI.Y);return E(i),_.get(D,i)}))}return e[0].promoRuleOffer;var n}):Promise.reject(y4);var i,n}function C(e){L.data=e,L.commit()}function T(e,t){x.data[t]===e&&(delete x.data[t],x.commit(),n.set(hse,x.data,!0))}function P(e){if(e){var i=t.isOwnedOutright(e);return t.isBaseGameOfferType(e)?i:i||_.some(A,function(t){return t.productId===e[DI.Y]})}}function O(){return n.get(vse,void 0,!0)}function E(e){n.set(vse,e,!0)}function F(){n.delete(hse,!0)}var x=r.observe({}),L=r.observe([]),A=[],D={},R={};return{clearBundle:function(){x.data={},x.commit(),F()},removeAll:function(e){var t=!1;_.forEach(x.data,function(i,n){e.indexOf(i)>=0&&(delete x.data[n],t=!0)}),t&&(n.set(hse,x.data,!0),x.commit())},getActivePromotion:function(e,t){return k(e,t).then(S).then(function(e){return C(e),e}).catch(u)},getActivePromoRuleId:function(){return R[O()]},addToBundle:function(e,i){return g.validateCurrentStorefront().then(function(){t.isBaseGameOfferType(e)&&!_.isEmpty(D)&&e[DI.Y]!==O()&&v(D[e[DI.Y]]).then(function(){E(e[DI.Y]),C(D[e[DI.Y]]),_.forOwn(x.data,function(e,t){_.get(L.data,[t,"offers"],[]).includes(e)||T(e,t)})}),x.data[i]=e[DI.Y],x.commit(),n.set(hse,x.data,!0)}).catch(g.handleWrongStorefrontError)},isInBundle:function(e,t){return x.data[t]===e},isOfferOwned:P,getBundleOffers:function(){return _.values(x.data)},removeFromBundle:T,getTotalDiscountAndPrice:function(e,t){var i=function(e,t){var i=[];e||(e=L.data);var n=_.map(e,function(e,n){var r,o=x.data[n]||_.get(e,["offers",0]);e.extraContentDisplayGroup===bse[yse.FULL_GAME]&&(o=O());var a=_.get(e,["discounts",0]);return i.push((rh(r={},DI.Y,o),rh(r,"discount",a),r)),s.getPrice(o,void 0,void 0,t).then(function(e){var t,i=_.get(e,"0",{});return rh(t={},DI.Y,i[DI.Y]),rh(t,"rating",_.get(i,["rating",0],0)),t})});return{offers:i,offerPromises:n}}(e,t),n=i.offers,r=i.offerPromises;return Promise.all(r).then(function(e){var t=0,i=0,r=0;return _.forEach(n,function(n){var r,o,a,s,c,l=_.get(_.find(e,rh({},DI.Y,n[DI.Y])),"rating");l&&(i+=l.originalTotalPrice,t+=(r=l.originalTotalPrice,c=n.discount,o=c?{discountType:c.discountType,discountValue:c.discountValue}:{},a=o.discountType,(s=o.discountValue)&&(a===k4?r*=1-s:a===I4&&(r-=s)),Math.floor(100*r)/100))}),i>0&&t>0&&(r=Math.floor(100*(1-t/i))),Promise.all([c.formatCurrency(t),c.formatCurrency(i)]).then(function(e){var t=fse(e,2),i=t[0],n=t[1];return{totalDiscount:r,formattedTotalPrice:n,formattedTotalDiscountPrice:i}})})},getBundleDataObserver:function(){return a.create(x)},getActivePromoRuleOfferObserver:function(){return a.create(L)},cleanUp:function(){x.data={},D={},R={}},getValidPromos:k}}function ah(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function sh(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v,b,y,S,k,I,w,C){"ngInject";function T(e){var t=_.get(e,"errorCode",e),i=_.get(e,"replaceMap",{});u.showDialog(t,i)}function P(i,n,o,s){a.beginPerformanceTimerCheckoutCart();var c=t.isOIGContext()?Xee.g:Xee.f,l=k.NO_XSELLUPSELL,d={bundleType:n=S[n]||S.BYOB,bundlePromotionRuleId:o};return e.addOfferList(Ff(i),d).then(function(){return e.setCartProperty("Subs_BYOB_Promo",y.userHasSubscription())}).then(function(e){return r.checkout(l,{invoiceSource:s.invoiceSource||c},e)}).then(f.reload).catch(a.endPerformanceTimerOnError).catch(u.showDialog)}function O(e,t,i,r,o,a){n.getCatalogInfo([e.offerId]).then(_.values).then(_.first).then(function(e){d.open({id:b.BUNDLE_DLC_DIALOG_ID,xmlDirective:h.getVaultBasegameDLCPurchasePreventionModal(t,e,b.BUNDLE_DLC_DIALOG_ID,r,o),size:_I}),s.events.once(Ey.x,_.partialRight(x,i,r,o,a))}).catch(h.handleBasegameRequiredError)}function E(e){if(!e||e.reason!==b.OWNED_OFFER_WITHOUT_BASEGAME)return Promise.resolve();var t=e.offer;d.open({id:b.BUNDLE_DIALOG_ID,xmlDirective:h.getSoftBundlePurchasePreventionDirective([t]),size:_I}),s.events.once(Ey.x,_.partialRight(F,[t]))}function F(e,t){e.accepted&&function(e){var t=m.getOutrightOwnedProducts(e);i.removeAll(Ff(t))}(t)}function x(e,t,i,n,r){if(e.accepted)return P(t,i,n,r)}function L(e){e&&e.reason===b.UNOPENED_GIFT&&(Origin.telemetry.events.fire(Origin.telemetry.events.TELEMETRY_SOFT_BUNDLE_OPEN_GIFT),s.events.fire("uiRouter:go",Ise,{offerId:e.offerId}))}function A(e,t,i,r,a){c.doesUserOwnAny(e)?(d.open({id:b.BUNDLE_DIALOG_ID,xmlDirective:h.getSoftBundlePurchasePreventionDirective(m.getOutrightOwnedProducts(e)),size:_I}),s.events.once(Ey.x,_.partialRight(F,e))):v.checkUnopenedGifts(e).then(function(){return function(e,t,i,r,a){var s=v.getProductsWithUnownedBaseGames(e),c=function(e){var t=_.find(e,function(e){return o.hasSoftDependency(e)});if(!t)return Promise.resolve();var i=t.softDependency[0];return _.some(e,function(e){return e.offerId===i})?Promise.resolve():n.getCatalogInfo(t.softDependency).then(_.values).then(_.head).then(function(e){return v.getOwnedDLCWithoutBasegame([e]).then(function(t){if(!t)return e})})}(e);return Promise.all([s,c]).then(function(n){var o=kse(n,2),s=o[0],c=o[1];return!a&&(s.length>0||c)?v.getOwnedDLCWithoutBasegame(s).then(function(e){if(e)return Promise.reject({reason:b.OWNED_OFFER_WITHOUT_BASEGAME,offer:e})}).then(function(){return v.getProductsWithBaseGameNotInCart(e)}).then(function(n){return c?M(c,n,e,t,i,r):U(n,e,t,i,r)}).catch(E):P(e,t,i,r)})}(e,t,i,r,a)}).catch(L)}function D(e,t,i,n,r){m.getGameDataWithEntitlements(e).then(_.partial(c.validateOffers,e)).then(p.toArray).then(_.partialRight(A,t,i,n,r)).catch(T)}var R,$,N,G,U=(R=ah(regeneratorRuntime.mark(function e(t,i,n,r,o){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.length){e.next=7;break}return e.next=3,l.getSharedVaultBasegameIfSubscriber(t);case 3:(a=e.sent)?O(a,t,i,n,r,o):B(i,n,r,o),e.next=8;break;case 7:return e.abrupt("return",P(i,n,r,o));case 8:case"end":return e.stop()}},e,this)})),function(e,t,i,n,r){return R.apply(this,arguments)}),B=($=ah(regeneratorRuntime.mark(function e(t,i,r,a){var c,l,g,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getLowestRankedPurchasableBasegame(_.head(t));case 3:if(c=e.sent){e.next=6;break}throw new Error(UI.p);case 6:return e.next=8,w.getPrice([_.get(c,"offerId")]);case 8:l=e.sent,g=o.isFreeToEntitle(c,l),u=g?h.getDLCFreeEntitlePurchasePreventionDirective(b.BUNDLE_DLC_DIALOG_ID,t,c,i,r):h.getBundledDLCPurchasePreventionModal(Ff(t)),d.open({id:b.BUNDLE_DLC_DIALOG_ID,xmlDirective:u,size:_I}),s.events.once(Ey.x,_.partialRight(x,t,i,r,a)),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),C.error("[Origin-Softbundlepurchase missing basegame purchase prevention] error",e.t0),h.handleBasegameRequiredError();case 19:case"end":return e.stop()}},e,this,[[0,15]])})),function(e,t,i,n){return $.apply(this,arguments)}),M=(N=ah(regeneratorRuntime.mark(function e(t,i,n,r,a,c){var l,g,u,p,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=void 0,g=void 0,u=!1,e.prev=2,!(_.size(i)>0)){e.next=9;break}return e.next=6,j(i);case 6:p=e.sent,l=p.basegameOffer,u=p.basegameIsFree;case 9:m=_.find(n,function(e){return o.hasSoftDependency(e)}),g=0===_.size(i)||l&&(u||y.userHasSubscription())?h.getSoftBundlingSwapDirective(b.BUNDLE_DIALOG_ID,m,t,l,i,r,a,u):h.getBundledDLCPurchasePreventionModal(Ff(n)),d.open({id:b.BUNDLE_DIALOG_ID,xmlDirective:g,size:_I}),s.events.once(Ey.x,function(e){var t=e.accepted,i=e.content;if(t&&i.bundleOffers.length>0)return P(i.bundleOffers,r,a,c)}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),C.error("[Origin-Softbundlepurchase missing soft dependency purchase prevention] error",e.t0),h.handleBasegameRequiredError();case 19:case"end":return e.stop()}},e,this,[[2,15]])})),function(e,t,i,n,r,o){return N.apply(this,arguments)}),j=(G=ah(regeneratorRuntime.mark(function e(t){var i,r,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,r=!1,e.next=4,l.getSharedVaultBasegameIfSubscriber(t);case 4:if(a=e.sent){e.next=15;break}return e.next=8,n.getLowestRankedPurchasableBasegame(_.head(t));case 8:return i=e.sent,e.next=11,w.getPrice(_.compact([_.get(i,"offerId")]));case 11:s=e.sent,r=o.isFreeToEntitle(i,s),e.next=19;break;case 15:return e.next=17,n.getCatalogInfo([_.get(a,"offerId")]);case 17:i=e.sent,i=_.head(_.values(i));case 19:if(i){e.next=21;break}throw new Error(UI.p);case 21:return e.abrupt("return",{basegameOffer:i,basegameIsFree:r});case 22:case"end":return e.stop()}},e,this)})),function(e){return G.apply(this,arguments)});return{buy:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];g.promiseLogin().then(function(){return I.validateCurrentStorefront()}).then(_.partial(D,e,t,i,n,r)).catch(I.handleWrongStorefrontError)}}}function ch(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function lh(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(i,a,d,u,p){return 0===p.length?n.continueWithRegularCheckout(i,a,d):(a.checkoutType=l.NO_XSELLUPSELL,(m=p,f=Pse,h=m.map(function(e){return r.getCatalogByPath(_.get(e,[f,"ocd-path"]))}),Promise.all(h)).then(g).then(function(n){var r,l,d=(r=_.values(n),l={},_.find(r,function(e){return t.isBaseGameOfferType(e)?l[_se]=_.get(e,["i18n","displayName"]):t.isDLC(e)&&t.isExpansion(e)&&(l[Ose]=_.get(e,["i18n","displayName"])),l[_se]&&l[Ose]}),l),g=_.get(u,[Tse,"legal-text-str"]),m=_.get(u,[Tse,"title-str"]),f=_.get(u,[Tse,"basegame-required-str"]),h=_.get(u,[Tse,"dlc-required-str"]),v=ch({},Tse,{dialogid:Tse,"target-offer-display-name":_.get(i,["i18n","displayName"]),"target-offerid":_.get(i,"offerId"),"telemetry-target-offer-ocdpath":_.get(i,"offerPath"),items:p});Object.assign(v[Tse],g?{"legal-text-str":g}:{},m?{"title-str":m}:{},f?{"basegame-required-str":f}:{},h?{"dlc-required-str":h}:{},d[_se]?{"required-basegame-name":d[_se]}:{},d[Ose]?{"required-dlc-name":d[Ose]}:{});var b=o.slingDataToDom(v);e.events.once("dialog:hide",function(e){return function(t){var i=t.accepted,n=t.content.offerIds;i&&n.length>0&&c.buy(n,e,!0)}}(a)),s.open({id:Tse,xmlDirective:b.outerHTML,size:"large"})}));var m,f,h}function g(e){var i=_.map(e,function(e){var i=_.head(_.values(e));return t.isBundle(i)?r.getCatalogInfo(_.get(i,"bundleOffers")):e});return Promise.all(i).then(function(e){return _.flatten(_.map(e,function(e){return _.values(e)}))})}function u(e){return Promise.all([o.findDirectives(Pse)(e),o.findDirectives(Tse)(e)]).then(function(e){var t,i=Cse(e,2),n=i[0],r=i[1];return ch(t={},Pse,n),ch(t,Tse,r),t})}return{suggestDependenciesToPurchase:function(e,r,o){return t.isDLC(e)?i.getOcdByPath(e.offerPath).then(u).then(function(t){return a.filterSuggestedOffers(t[Pse]).then(_.partial(d,e,r,o,_.get(t,[Tse,"0"])))}).catch(_.partial(n.continueWithRegularCheckout,e,r,o)):n.continueWithRegularCheckout(e,r,o)}}}function dh(e,t,i,n,r){"ngInject";function o(e){var t={};return t[e.offerId]=e,t}function a(e){return _.values(e)[0]}function s(t){return e.getRecommendedOffer(t).then(o).then(i.transformOffer).then(a).then(c).catch(function(){return null})}function c(e){return n.ownsGame(e)?null:{offerId:e.offerId,projectNumber:e.projectNumber}}function l(e){return"/"!==_.trim(e).charAt(0)&&(e="/"+e),t.getCatalogByPath(e).then(i.transformOffer).then(a).then(c).catch(function(){return null})}function d(e,t,i){return{control:e,recoTag:t.trackingTag,games:i}}return{retrieveRecommendedGames:function(t,i){return e.getProjectNumbersFromEntitlementsIfLoggedIn().then(_.partialRight(t,r.userHasSubscription(),i))},getNumRecoRecommendationsToRequest:function(e,t,i){var n=Math.min(_.size(e),_.size(t));return n>=i?0:i-n},createRecommendedGamesJsonArray:function(t,i,n,r){var o,a=e.getFlattenRecoResponse(t);return o=a.control?function(e,t){var i=_.size(e)>t?_.slice(e,0,t):e;return _.map(i,l)}(i,r):function(e,t,i){var n=_.size(e),r=_.size(t);if(n>i)return _.map(_.slice(e,0,i),l);var o=n>0?_.map(e,l):[],a=r>0?_.slice(t,0,i-n):[];return[].concat(o,_.map(a,s))}(n,a.recoResults,r),Promise.all(o).then(_.compact).then(_.partialRight(_.uniqBy,"offerId")).then(_.partial(d,a.control,a.recoTrack))}}}function gh(e){"ngInject";var t=null,i={};return{getFacets:function(){return i},getSortOrders:function(){return t},registerFacetOption:function(t,n){i[t]||(i[t]=e.getInstance()),i[t].addFilter(xse,n)},registerSortOption:function(i){t||(t=e.getInstance()),t.addFilter(xse,i)}}}function uh(e,t,i,n,r,o){"ngInject";function a(){var e=t.getSortOrders();e&&e.dismissAll()}function s(e){return!!e&&t.getFacets()[e].countActiveFilters()>0}function c(e){return"sort"!==e?t.getFacets()[e]:t.getSortOrders()}function l(){var t=i.getSortAsString();return e.go(e.current.name,{searchString:i.getSearchStringQueryParam(),fq:i.getActiveFacetsAsString(),sort:t[0]===t9?[]:t},{notify:!1})}function d(){n.events.fire("storeSearchHelper:triggerSearch")}function g(e,t){e&&t&&(function(e,t){var i=c(e),n=i.isFilterActive(t);i.setFilterValue(t,!n)}(e,t),l().then(d))}function u(e){e.isLoading=!1,e.animation&&p(e.animation.id)}function p(e){e&&o.stopAnimation(e.id)}return{dismissAllFacets:function(){_.forEach(t.getFacets(),function(e){e.dismissAll()})},dismissAllSortOrders:a,hasActiveFilters:s,hasSelectableFilters:function(e){return!!e&&t.getFacets()[e].isFilterSelectableAndVisible()},getFilter:function(e,i){var n=t.getFacets();return n[e]&&n[e].getFilter(i)},applyFilter:g,applySortFilter:function(e,t){a(),g(e,t)},reloadCurrentPage:l,isFilterActive:function(e,t){return c(e).isFilterActive(t)},isAnyFilterActive:function(){var e=Object.keys(t.getFacets()),i=_.find(e,function(e){return s(e)});return angular.isDefined(i)},triggerSearch:d,getActiveFacetsCount:function(){var e=t.getFacets(),i=Object.keys(e);return _.reduce(i,function(t,i){return t+e[i].countActiveFilters()},0)},staggerLoadGameTiles:function(e,t,i){return e.$on("$destroy",function(){return u(e)}),new Promise(function(n){e.animation=o.startAnimation(function(){t.push(i.shift()),r.digestIfDigestNotInProgress(e)},function(){e.isLoading=!1,n()},function(){return _.isEmpty(i)},6)})},buildSearchConfig:function(e,t,i){return{filterQuery:_.get(e,"facet",""),sort:_.get(e,"sort",t.rank)+" "+_.get(e,"dir",i.descending),start:_.get(e,"offset",0),rows:_.get(e,"limit",30)}},cancelStaggerLoading:u,stopStaggerAnimation:p,startStaggerAnimation:function(e,t,i,n,r){return new Promise(function(a){Object.assign(e,o.startAnimation(t,function(){i&&_.isFunction(i)&&i(),a()},n,r))})},dismissSearchString:function(){i.clearSearchStringQueryParam()}}}function ph(e,t,i,n){"ngInject";function r(e){return!!e}function o(t){return e[t]?decodeURI(e[t]):""}function a(e,t){var i=Object.keys(e.getApplicableFilterValues()).sort();return i.length>0?_.map(i,function(e){return(t?t+":":"")+e}):""}function s(e){return e=e||"",_.reduce(e.split(","),function(e,t){var i=t.split(":");return e.length&&1===i.length?e[e.length-1]+=","+t:t&&e.push(t),e},[])}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipCheckForValidCategory:!1},i=g(),n=s(e);return _.reduce(n,function(e,n){var r;return r=(n=_.slice(n.split(/:(.+)/),0,2))[0],(t.skipCheckForValidCategory||i[r])&&e.push(n),e},[])}function l(e){var t;return _.forEach(e,function(e,i){e=encodeURIComponent(e),t?t+="&"+[i,e].join("="):t="?"+[i,e].join("=")}),t}function d(e){var t={};_.forEach(e,function(e){var i=e.split(":");2===i.length&&(t[i[0]]||(t[i[0]]=[]),t[i[0]].push(i[1]))});var i=Object.keys(t).sort(),n=[];return _.forEach(i,function(e){var i=t[e].sort();_.forEach(i,function(t){n.push([e,t].join(":"))})}),n}var g=i.getFacets,u=i.getSortOrders,p="searchString";return{getFacetCategories:function(){return Object.keys(g())},getFacetsQueryParam:function(){return o("fq")},getSearchStringQueryParam:function(){return o(p)},getSortQueryParam:function(){return o("sort")},getSortAsString:function(){return a(u(),!1)},getActiveFacetsAsString:function(){var e=g();return Object.keys(e).map(function(t){return a(e[t],t)}).filter(r).sort().join(",")},updateFacetValuesFromQuery:function(e){var t=c(e),i=g();_.forEach(t,function(e){i[e[0]].setFilterValue(e[1],!0)})},updateSortValuesFromQuery:function(e){e&&u().setFilterValue(e,!0)},extractFacetValuesFromQuery:c,splitCommaDelimitedFacetQueryParam:s,getUrlWithNewFacet:function(e,i){var r,o,a=_.trim(window.location.search,"?"),c=n.convertQueryStrToObj(a),g=t.path();if(e&&i)return r=s(c.fq),o=[e,i].join(":"),r.length?(r.push(o),r=d(r=_.uniq(r)),c.fq=r.join(","),g+l(c)):g+l({fq:o})},getUrlWithoutFacet:function(e,i){var r,o=_.trim(window.location.search),a=n.convertQueryStrToObj(o),c=t.path();if(e&&i)return(r=s(a.fq)).length&&(_.remove(r,function(t){var n=t.split(":");if(n.length>=2){var r=n[0],o=n[1];return r===e&&o===i}return!1}),r=d(r),a.fq=r.join(",")),c+l(a)},getUrlWithNewSort:function(e){var i=_.trim(window.location.search,"?"),r=n.convertQueryStrToObj(i),o=t.path();if(e&&decodeURIComponent(e)!==t9)return r.sort=e,o+l(r)},clearSearchStringQueryParam:function(){e[p]=void 0},getSingleFacetUrl:function(e,i){if(e&&i)return t.path()+l({fq:[e,i].join(":")})}}}function mh(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function fh(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function hh(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vh(e,t,i,n,r,o,a,s,c,l){"ngInject";function d(t,i,s,c){if(0===c.length)return m(t,i,s);i.checkoutType=o.NO_XSELLUPSELL;var l=hh({},Nse,{dialogid:Nse,"target-offer-display-name":_.get(t,["i18n","displayName"]),"target-offerid":_.get(t,"offerId"),"telemetry-target-offer-ocdpath":_.get(t,"offerPath"),items:c}),d=n.slingDataToDom(l);e.events.once("dialog:hide",function(e){var t=e.accepted,n=e.content.offerIds;t&&n.length>0&&a.buy(n,i,!0)}),r.open({id:Nse,xmlDirective:d.outerHTML,size:"large"})}function g(e,t){return _.filter(e,function(e){return _.get(e,[Rse,"offer-type"])===t})}function u(e,t,i){var n=Object.assign({},e);return n["ocd-path"]=i,hh({},t,n)}function p(e){if(e.length<=2)return e;var t=g(e,s.XSELL),i=g(e,s.UPSELL),n=e.filter(function(e){return Object.keys(e).some(function(e){return e===$se})}),r=t.length,o=i.length;if(n.length&&(r||o))return[r?t[0]:i[0],n[0]];if(r&&o)return[t[0],i[0]];var a=Use(r?t:i,2);return[a[0],a[1]]}function m(e,t,i){return Promise.resolve().then(_.partial(i,e,t))}var f,h,v,b=(f=fh(regeneratorRuntime.mark(function e(t,i,r){var o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.reduce(function(){var e=fh(regeneratorRuntime.mark(function e(a,s,c){var l,d,g,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a;case 2:return l=e.sent,e.next=5,n.findDirectives(s)(i);case 5:if((d=e.sent).length){e.next=9;break}return g=!l.length&&c===t.length-1,e.abrupt("return",g?Promise.reject({reason:"no-directives-found"}):l);case 9:if(s!==$se){e.next=14;break}return e.next=12,y(d,s,r);case 12:return u=e.sent,e.abrupt("return",Object.keys(u).length?[].concat(mh(l),[u]):l);case 14:return e.abrupt("return",[].concat(mh(l),mh(d)));case 15:case"end":return e.stop()}},e,o)}));return function(t,i,n){return e.apply(this,arguments)}}(),Promise.resolve([])));case 1:case"end":return e.stop()}},e,this)})),function(e,t,i){return f.apply(this,arguments)}),y=(h=fh(regeneratorRuntime.mark(function e(t,i,n){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[0][i],e.next=3,S(r);case 3:return o=e.sent,e.abrupt("return",o?u(r,i,n):{});case 5:case"end":return e.stop()}},e,this)})),function(e,t,i){return h.apply(this,arguments)}),S=(v=fh(regeneratorRuntime.mark(function e(t){var i,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t["promo-rule-id"],e.next=3,l.getValidPromos(i.split(",")).catch(function(){return!1});case 3:return n=e.sent,e.abrupt("return",!!n||n);case 5:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)});return{suggestGamesToUpsellXsell:function(e,t,n){return i.getOcdByPath(e.offerPath).then(function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];return e=fh(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b(i,r,n));case 1:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}}(Gse,e.offerPath)).then(c.filterSuggestedOffers).then(p).then(_.partial(d,e,t,n)).catch(_.partial(m,e,t,n))},continueWithRegularCheckout:m}}function bh(e,t,i,n,r,o,a,s,c,l,d){"ngInject";function g(){return(new Date).getTime()}function u(e){var t=_.isArray(e)?e:[e];return{componentPath:t,depth:t.length}}function p(e,t,i){var n=u(t),r=a.getDefaults(n.componentPath[n.depth-1]),o=!1;if(r){var s=Object.keys(r);_.forEach(s,function(t){var i=l.htmlToScopeAttribute(t);e[i]||(e[i]=r[t],o=!0)})}return Promise.resolve(i||o)}function m(e,t,i,n){var r=t.componentPath[t.depth-1],o=t.componentPath[t.depth-2],a=void 0,c=void 0;return t.depth>2&&(c=[0,a=t.componentPath[0],"items"]),Promise.resolve(i).then(function(e,t){return function(){return e?s.findDirectives(e)(t):Promise.resolve(t)}}(a,i)).then(s.coalesceChildDirectives(o,r,c)).then(s.flattenDirectives(r)).then(_.curry(C)(e,n)).then(_.curry(p)(e,r)).catch(T)}function f(t,i){return e(i)(t)}function h(e,t){if(!e.length)return Promise.reject(new Error("no-dom-to-attach-to"));e.html(t)}function v(e){return _.forEach(e,function(e,t){var i=_.get(e,"items");_.isArray(i)&&_.forEach(i,function(e){v(e)}),function(e,t){var i=a.getDefaults(t);if(i){var n=Object.keys(i);_.forEach(n,function(t){e[t]||(e[t]=i[t])})}}(e,t)}),e}function b(e,t){return function(i,n){Mse.indexOf(n)>=0?e[n]=e[n]||i:t[n]=t[n]||i}}function y(e,t){if(!t)return Promise.reject(new Error("no-ocd-node-found"));var i=t[e];return 0===_.size(i)?Promise.reject(new Error("empty-ocd-node")):t}function S(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=n[t],s=function(e,t){return _.reduce(t,function(t,i){return e[i]&&(t[_.kebabCase(i)]=e[i]),t},{})}(e,r),c={},d={};!function(e,t){_.forEach(Mse,function(i){var n=l.htmlToScopeAttribute(i);e[n]&&(t[i]=e[n])})}(e,c),_.forEach(o,b(c,s));var g=u(t),p=a.getDefaults(g.componentPath[g.depth-1]);if(_.forEach(p,b(c,s)),d[Hse]=c,_.isFunction(i)){var m=i(s);_.isEmpty(m)||(d[Hse].items=[m])}else s.items&&(d[Hse].items=s.items);return d}function k(e,t){if(t)return e?t[e]:t[0]}function I(e,t,i){var n=u(e);return P(i).then(s.findDirectives(n.componentPath[0])).then(_.partial(k,t||0)).then(_.partial(y,e))}function w(e,t,i,n){var r=u(t);return r.depth>1?m(e,r,n,i):Promise.resolve(n).then(s.findDirectives(r.componentPath[0])).then(s.flattenDirectives(r.componentPath[0])).then(_.curry(C)(e,i)).then(_.curry(p)(e,t)).catch(T)}function C(e,t,i){var n=!1,r=function(e){if(e&&_.isArray(e))return _.find(e,function(e){return _.isUndefined(e.isConsumed)||e.isConsumed!==F})}(i);if(r){var o=Object.keys(r);_.forEach(o,function(t){var i=l.htmlToScopeAttribute(t);e[i]||(e[i]=r[t])}),n=o.length>0,function(e,t){e&&!1!==t&&(e.isConsumed=F)}(r,t)}return n}function T(){i.error("Cannot resolve url to ocdPath")}function P(e){return e?e.split("/").length>0?o.getOcdByPath(e):r.getOcdByOfferId(e):(t=c.getCurrentEditionSelector()).offerId?r.getOcdByOfferId(t.offerId):t.ocdPath?o.getOcdByPath(t.ocdPath):Promise.reject("Cannot resolve path");var t}function O(e,t,i,n){return P(i).then(_.curry(w)(e,t,n)).catch(_.curry(p)(e,t))}function E(e,t,i){var n=_.head(_.values(i));_.isFunction(t)?t(n):_.set(e,t,n)}var F=void 0;return F=g(),t.events.on("uiRouter:stateChangeSuccess",function(){F=g()}),{getOcdNode:I,populateScope:O,populateWithDefaults:p,populateScopeWithOcdAndCatalog:function(e,t,i,r){r=r||"model";var o=[O(e,t,i,!1)];return i&&o.push(n.getByOcdPathPromise(i).then(_.partial(E,e,r))),Promise.all(o).then(_.partial(d.digestIfDigestNotInProgress,e))},populateScopeAndSlingDataToDom:function(e,t,i,n,r,o,a){return I(t,e.ocdIndex,r).then(function(i){return _.get(o,jse,!0)?S(e,t,n,i,a):_.isFunction(n)?n(i):Promise.reject(new Error("unexpected-call"))}).then(v).then(_.partialRight(s.slingDataToDom)).then(_.partial(f,e)).then(_.partial(h,i)).catch(function(){return Promise.resolve()})},populateScopeLinkFn:function(e){return function(t){O(t,e).then(function(){d.digestIfDigestNotInProgress(t)})}}}}function yh(e,t,i,n,r,o,a,s){"ngInject";function c(){S.off(Wse),w&&clearInterval(w),I&&I.close(),I=void 0,w=void 0,window.ubisoftLoginCompletedCallback=void 0}function l(){try{I&&!I.closed||S.fire(Wse)}catch(e){S.fire(Wse)}}function d(e){return new Promise(function(i,n){(I=t.popupCenter(e,"",GP.width,GP.height))&&(I.focus(),w=setInterval(l,UP),window.ubisoftLoginCompletedCallback=function(){c(),i()},S.once(Wse,function(){c(),n(a.USER_ABORTED)}))})}function g(){return d(e.getLoginUrl())}function u(t){return t.alreadyHasAccount?g():d(e.getCreateAccountUrl())}function p(e){return _.map(e,function(e){return _.get(e,["i18n","displayName"])}).join("<br>")}function m(t,i,n){var r=n.accepted,o=n.content;_.get(o,"takeAction",!1)?u({alreadyHasAccount:r}).then(e.getTicket).then(v).then(t).catch(i):i(a.USER_ABORTED)}function f(t,i,n,r,o){var s=o.accepted,c=o.content;_.get(c,"takeAction",!1)?s?t(k):Promise.all([e.logout(r).then(b),g().then(e.getTicket).then(v).then(_.partial(h,n))]).then(function(){return t(k)}).catch(i):i(a.USER_ABORTED)}function h(t,i){return i?e.getProfile(i).then(function(s){var c=_.find(s.profiles,{platformType:"uplay"});return c?function(t,i,a){return o.unblockUI(),new Promise(function(o,s){n.openDirective({id:BP.CONFIRM,name:BP.CONFIRM,size:"medium",data:{"dialog-id":BP.CONFIRM,"game-display-name":p(t),"ubisoft-profile-image-url":e.getProfileImageUrl(_.get(a,["userId"])),"ubisoft-username":_.get(a,["nameOnPlatform"])}}),r.events.once("dialog:hide",_.partial(f,o,s,t,i))})}(t,i,c):Promise.reject(a.AUTH_FAILED)}):Promise.reject(a.NO_TICKET)}function v(e){return k={ticket:_.get(e,"ticket"),sessionId:_.get(e,"sessionId"),userId:_.get(e,"userId")},e}function b(){k=void 0}function y(){return k?(e.logout(k),k=void 0):Promise.resolve()}var S=new Origin.utils.Communicator,k=void 0,I=void 0,w=void 0;return Origin.client.games.invalidateUbisoftTicket=y,i.events.on(Ey.g,y),{startFlow:function(t){return s.validateCurrentStorefront().then(o.blockUI()).then(function(){return e.initUplay()}).then(e.getTicket).then(v).catch(function(e){return e===a.AUTH_FAILED?function(e){return I&&w&&S.fire(Wse),o.unblockUI(),n.openDirective({id:BP.CONNECT,name:BP.CONNECT,size:"medium",data:{"dialog-id":BP.CONNECT,"game-display-name":p(e)}}),new Promise(function(e,t){r.events.once("dialog:hide",_.partial(m,e,t))})}(t):Promise.reject(e)}).then(_.partial(h,t))}}}function Sh(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(e,t){var i=_.head(_.values(e));if(m(i)){var n=_.get(i,"masterTitleId"),r=_.filter(t,function(e){return e.masterTitleId===n});return _.map(r,function(e){return e.offerId})}return[]}function m(e){var t=Origin.utils.os();return g.isReleased(t)(e)}function f(e){return Promise.all([t.getCatalogInfo([e]),i.getPendingThirdPartyEntitlements()]).then(_.spread(p)).then(function(e){return t.getCatalogInfo(e)}).then(l.toArray).then(function(e){return _.filter(e,m)}).catch(function(e){return Promise.reject(e)})}function h(t){return t&&t.length?e.startFlow(t).then(function(e){return Promise.resolve({entitlements:t,ticket:e})}).catch(function(e){return Promise.reject(e)}):Promise.resolve({entitlements:t})}function v(e){var t=e.entitlements,n=e.ticket;return t&&t.length&&function(e){return!_.isUndefined(e)&&!_.isUndefined(e.ticket)&&!_.isUndefined(e.userId)}(n)?(r.blockUI(),function(e,t){return _.map(e,function(e){return function(){return function(e,t){return i.enablePendingThirdPartyEntitlement(e.offerId,t).catch(function(){return Promise.reject(d.LINK_GAME_FAILED)})}(e,t)}}).reduce(function(e,t){return e.then(t)},Promise.resolve())}(t,n).then(r.unblockUIPromise).then(function(){return Promise.resolve(t)}).catch(function(e){return Promise.reject(e)})):Promise.resolve([])}function b(e,t){return new Promise(function(r){_.some(t,function(e){return!n.isBaseGameOfferType(e)})?(o.openDirective({id:Yse,name:Yse,size:"medium",data:{"dialog-id":Yse}}),s.events.once("dialog:hide",function(){!function(e){i.events.fire("game:pendingEntitlementsAssociated:"+e)}(e),r(e)})):r(e)})}return{startFlow:function(e){return f(e).then(h).then(v).then(_.partial(b,e)).catch(function(e){return Promise.reject(e)})},filterPendingEntitlementsByOfferId:f,filterPendingDLCEntitlementsByOfferId:function(e){return f(e).then(function(e){return _.filter(e,function(e){return!n.isBaseGameOfferType(e)})}).catch(function(e){return Promise.reject(e)})},handleError:function(e){r.unblockUI(),e===UI.a?u.openGeoBlockDialog():e!==d.USER_ABORTED&&(c.error("ERROR:",e),function(e){return _.values(d).indexOf(e)>-1}(e)&&o.openDirective({id:Kse,name:Kse,size:"medium",data:{"dialog-id":Kse}}))}}}function kh(e,t){function i(e){return!!Jse[e]}function n(e,t){var i=[],n=e.filter(function(e){return e!==tce}).map(r),o=t.map(r);return o&&i.push(o),n&&i.push(n),i.filter(function(e){return e.length>0})}function r(t){if(!_.isString(t))return t;var i="esrb-"+_.kebabCase(t.toLowerCase());return e.getLocalizedStr(null,mQ,i)||t}function o(e){var t=Object.entries(Zse).find(function(t){return ece(t,2)[1].includes(e)});return t?t[0]:null}function a(e){var i=t.localizedRatingSystem,n=Origin.locale.threeLetterCountryCode().toLowerCase(),r=_.get(i,"ratingTypes",[]),o=_.get(i,"countries",[]);return r.includes(e)&&o.includes(n)}return{extractEsrbDescriptorArray:n,extractEsrbDescriptorGroups:function(e,t){var i=n(e,t).map(function(e){return e.join(", ")});return e.includes(tce)&&i.push(r(tce)),i},isRatingWithIcons:i,hasNoRating:function(e){return!i(e.gameRatingType)&&!e.ratingSystemIcon},sortRatingDescriptorsIfNecessary:function(e,t){return a(e)?t.sort(function(e){return e.className===Xse?-1:0}):t},isEligibleToShowInGamePurchaseWarning:function(e,t){return a(e)&&t&&!!t.find(function(e){return e.className===Xse})},getLocalizedRatingName:function(e){return a(e)?(e+"-"+Origin.locale.threeLetterCountryCode()).toLowerCase():e.toLowerCase()},extractInGamePurchaseWarningMessage:function(){return e.getLocalizedStr(null,mQ,"pegi-in-game-purchases-warning-message")},getRatingReasonIcons:function(e,t){return"PEGI"===t?e.reduce(function(e,t){var i=o(_.kebabCase(t));return i&&!e.some(function(e){return e.className===i})&&e.push({description:t,className:i}),e},[]):e.map(function(e){return{description:e,className:_.kebabCase(e)}})},getCustomizedPegiRatingDescriptors:function(e){return e.filter(function(){})}}}function Ih(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var a=t[r](o),s=a.value}catch(e){return void i(e)}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function wh(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function Ch(e,t,i,n,r,o,a,s,c,l,d,g,u){"ngInject";function p(e){return e.length>cce?e.slice(0,cce):e}function m(e){if(_.size(e)){var t=_.reduce(e,function(e){if(i.isPremierVaultGameOrUpgradable(e))return l.getPlayFirstTrialModelPromise(new KH(e.offerPath))},[]);return _.size(t)?Promise.all(t).then(function(t){return[].concat(wh(e),wh(_.compact(t)))}):e}return[]}function f(e){if(_.isString(e))return Promise.reject(e);var t=_.get(e,["response",sce]);return a.info("[FriendReferralFactory]: invitation server error",e),t===oce?Promise.reject(UI.j):t===ace?Promise.reject(UI.d):Promise.reject(UI.k)}function h(e){return e?Promise.resolve(e):Promise.reject(UI.j)}function v(){return n.isFriendReferralEnabled()}function b(){return v()?Promise.resolve():Promise.reject(UI.e)}function y(){return Origin.user.userStatus()===Origin.defines.userStatus.BANNED?Promise.reject(UI.l):Promise.resolve()}function S(){var e=d.getActiveSubscriptionLevel(),t=d.isFreeTrial();return e===yI.y.NONE||t?Promise.reject(UI.i):Promise.resolve()}function k(e){return e?Promise.resolve(e):Promise.reject(UI.g)}function I(e){var t={};return e&&((t=e).invitationCompletedCount=t.completedCount||0,t.invitationCompletionLimit=t.completionLimit||0,t.isAllInvitationsUsed=t.invitationCompletionLimit===t.invitationCompletedCount),t}function w(e){var t=e.statuses;return(void 0===t?[]:t).map(function(e){return e.pid})}function C(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e+="",t+="",Origin.telemetry.sendFriendReferralSentEvent({sender:e,recipients:t,isSuccess:i,errorCode:n})}var T,P,O,E,F,x,L,A,D,R,$,N=(T=Ih(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Origin.atom.atomGamesOwnedForUser(t);case 2:if(!(i=e.sent)||!_.size(i)){e.next=5;break}return e.abrupt("return",o.getCatalogInfo(_.map(i,function(e){return e.productId})).then(c.transformOfferWithEntitlements).then(_.values).then(r.filterNuxGames).then(m).then(function(e){return e.sort(u5)}).then(function(e){return e.map(function(e){return e.offerPath})}).then(p).catch(function(e){return a.error("[FriendReferralFactory]: failed to get catalog info during nux",e),[]}));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}},e,this)})),function(e){return T.apply(this,arguments)}),G=(P=Ih(regeneratorRuntime.mark(function i(){var n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e.isAppLoggedIn()){i.next=8;break}if(!(n=(u.getLocalizedStr(!1,rce,"banned-countries")||"").toLowerCase().split(",")).length){i.next=8;break}return i.next=5,t.getUserLocationCountryCode(Origin.user.userPid()).catch(function(e){return a.error("[FriendReferralFactory]: getUserLocationCountryCode server error",e),""});case 5:if(r=i.sent,!(n.indexOf(r.toLowerCase())>=0)){i.next=8;break}return i.abrupt("return",Promise.reject(UI.e));case 8:return i.abrupt("return",Promise.resolve());case 9:case"end":return i.stop()}},i,this)})),function(){return P.apply(this,arguments)}),U=(O=Ih(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([h(t),y(),G(),b()]);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}},e,this)})),function(e){return O.apply(this,arguments)}),B=(E=Ih(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([k(t),S(),G(),y(),b()]);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}},e,this)})),function(e){return E.apply(this,arguments)}),M=(F=Ih(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",Origin.friendReferral.openInvitation(Origin.user.userPid(),Origin.user.personaId(),i).then(function(e){return e.pid}).catch(f));case 3:case"end":return t.stop()}},t,this)})),function(e){return F.apply(this,arguments)}),j=(x=Ih(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",B(i).then(function(){return Y(Origin.user.personaId(),i).then(function(e){return _.get(e,["tokenInfo","isReferrerEligible"],!1)?Promise.resolve(e):Promise.reject(UI.h)}).catch(f)}));case 3:case"end":return t.stop()}},t,this)})),function(e){return x.apply(this,arguments)}),H=(L=Ih(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",U(i).then(function(){return Origin.friendReferral.getInvitationTokenInfo(i).then(I).catch(f)}));case 3:case"end":return t.stop()}},t,this)})),function(e){return L.apply(this,arguments)}),z=(A=Ih(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",U(i).then(function(){return Origin.friendReferral.getInvitationHistory(i).then(w).catch(f)}));case 3:case"end":return t.stop()}},t,this)})),function(e){return A.apply(this,arguments)}),V=(D=Ih(regeneratorRuntime.mark(function t(i,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",B(i).then(function(){return Origin.friendReferral.getFriendReferralEligibility(i,Origin.user.personaId(),n).catch(f)}));case 3:case"end":return t.stop()}},t,this)})),function(e,t){return D.apply(this,arguments)}),W=(R=Ih(regeneratorRuntime.mark(function t(i){var n=i.referralProgramId,r=i.referralPersonaIds;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promiseLogin();case 2:return t.abrupt("return",B(n).then(function(){var e=Origin.user.personaId();return Origin.friendReferral.sendInvitation(n,e,r).then(C(e,r)).catch(f).catch(function(t){throw C(e,r,!1,t),t})}));case 3:case"end":return t.stop()}},t,this)})),function(e){return R.apply(this,arguments)}),q=($=Ih(regeneratorRuntime.mark(function i(){var n,r,o,s,c,l=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=[],!v()||!e.isAppLoggedIn()||d.isPremiumSubscriber()){i.next=13;break}return r=u.getLocalizedStr(!1,kV,"program-ids"),i.next=5,Origin.friendReferral.getInvitesForUser(Origin.user.userPid(),Origin.user.personaId(),r).catch(function(e){a.error("[FriendReferralFactory]: searchForInvites server error",e)});case 5:if(o=i.sent,!(n=_.get(o,"invitations",[])).length){i.next=13;break}return i.next=10,g.getLogosPromise(qS.Stacked);case 10:return s=i.sent,c=_.map(n,function(){var e=Ih(regeneratorRuntime.mark(function e(i){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getUserInfo(i.pid);case 2:return n=e.sent,r=n.firstName,o=n.lastName,a=n.EAID,e.abrupt("return",Object.assign(i,{senderName:r||o?r+" "+o:a,image:s[F$]}));case 7:case"end":return e.stop()}},e,l)}));return function(t){return e.apply(this,arguments)}}()),i.abrupt("return",Promise.all(c));case 13:return i.abrupt("return",n);case 14:case"end":return i.stop()}},i,this)})),function(){return $.apply(this,arguments)}),Y=s.decorate(Origin.friendReferral.getInvitationToken);return{getSuggestedTopGamesForNux:function(t){return e.isAppLoggedIn()?N(t):Promise.resolve([])},validateInvitation:function(e){return U(e).then(function(){return Origin.friendReferral.validateInvitation(e).catch(f)})},openInvitation:function(e){return U(e).then(M)},getInvitationTokenInfo:H,isFriendReferralEnabled:v,getRedeemedInvitationUserIdList:z,fetchToken:j,searchForInvitesPromise:q,getFriendReferralEligibility:V,sendInvitation:W}}function Th(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ph(e,t,i,n){"ngInject";return{getBrowsePageContentTitle:function(){var r=t.extractFacetValuesFromQuery(i.extractSearchParamByName(gW),{skipCheckForValidCategory:!0});if(r&&r.length===mce){var o=r[0][0],a=void 0,s="";if(a=o===fW?e.getLanguage(r[0][1]):n.getLocalizedStr("",mW,r[0][1]+pce),dce.some(function(e){return e===Origin.locale.languageCode()})){var c=[gce,_.kebabCase(o)].join("-");s=n.getLocalizedStr("",q7,c,Th({},fce,a))}return n.getLocalizedStr(s,q7,uce,Th({},fce,a))}}}}function _h(e,t){function i(){var e=t.fictionalCurrencyExclusiveStores,i=Origin.locale.threeLetterCountryCode().toLowerCase();return!Origin.client.isEmbeddedBrowser()&&e.indexOf(i)>-1}return{isFictionalCurrencyExclusiveByGdpPath:function(e){return e&&e.isCurrency&&i()},isFictionalCurrencyExclusiveByOffer:function(t){return t&&e.isCurrency(t)&&i()}}}function Oh(e,t,i){function n(){o||((a=t.$new()).isVisible=!0,a.items=[],o=i('<origin-dropdown-menu items="items" top="top" left="left" is-visible="isVisible"></origin-dropdown-menu>')(a),s.append(o))}function r(){n(),a.isVisible=!1,a.$digest(),s.off("click",r)}var o=void 0,a=void 0,s=angular.element(e[0].body);return{open:function(e,t){n(),a.items=e,a.left=t.left,a.top=t.top,a.isVisible=!0,a.$digest(),s.on("click",r)},close:r,destroy:function(){o&&(o.remove(),o=null),a&&(a.$destroy(),a=null)}}}function Eh(e,t,i,n){"ngInject";return n.get("ContextMenuFactory",Oh,this,arguments)}function Fh(e,t,i,n,r,o){function a(i){h=i,(p=e.find("origin-dialog"))&&t.events.fire(Ey.y,i)}function s(e,i){p&&(m.id=e.id,m.shouldClose=i,m.stackSize=f.length(),t.events.fire(Ey.x,m),i&&e.callback&&e.callback(m),h=null,d(!1,{}),m.id="")}function c(e){if(function(e){var t=_.get(e,"directives"),i=_.isArray(t)&&t[0],n=_.get(e,"xmlDirective");return!(!_.isString(_.get(i,"name",null))&&!_.isString(n))}(e)){if(function(e){f.contains(function(t){return t.hasOwnProperty("id")&&t.id===e.id})||f.push(e)}(e),h){if(h.hasOwnProperty("id")&&h.id===e.id){try{Origin.client.oig.IGOIsAvailable()&&o.openIGOSPA(e.spalocation,e.sublocation)}catch(e){n.log(e)}return}s(h,!1)}try{if(Origin.client.oig.IGOIsAvailable())return void o.openIGOSPA(e.spalocation,e.sublocation)}catch(e){n.log(e)}a(e)}else n.log("DialogFactory:Invalid Conf Object")}function l(e){e||n.error("This dialog was closed without passing an id"),function(e){f.remove(function(t){return t.hasOwnProperty("id")&&t.id===e})}(e),h&&h.hasOwnProperty("id")&&h.id===e&&(s(h,!0),f.length()&&a(f.peek()))}function d(e,t){m.accepted=e,m.content=t}function g(e){return _.isArray(e)||_.isObject(e)?JSON.stringify(e):e}function u(e,t){var i=[e];return _.forEach(t,function(e,t){var n;_.isUndefined(e)||_.isNull(e)||i.push([t,(n=e,"'"+r.replaceAll(n,v)+"'")].join("="))}),["<",i.join(" "),">"].join("")}var p=void 0,m={id:"",accepted:!1,content:{}},f=i.make(),h=null,v={"'":"&#39;","`":"&#96;"};return{open:c,close:l,update:function(e){p&&t.events.fire(Ey.z,e)},createDirective:function(e,t,i){return{name:e,data:t,directives:[i]}},openDirective:function(e){c({id:e.id,size:e.size?e.size:OI,dialogClass:e.dialogClass,directives:[{name:e.name,data:e.data,directives:[e.contentDirective],id:e.id}],callback:e.callback,spalocation:e.spalocation,closeOnStateChange:e.closeOnStateChange})},openPrompt:function(e){c({id:e.id,size:e.size?e.size:OI,blocking:e.blocking,directives:[{name:"origin-dialog-content-prompt",data:{header:e.title,description:e.description,yesbtntext:e.acceptText,yesenabled:e.acceptEnabled,nobtntext:e.rejectText,defaultbtn:e.defaultBtn,blocking:e.blocking,id:e.id},directives:[e.contentDirective]}],callback:e.callback,spalocation:e.spalocation,sublocation:e.sublocation})},openAlert:function(e){c({id:e.id,size:e.size?e.size:OI,blocking:e.blocking,directives:[{name:"origin-dialog-content-prompt",data:{header:e.title,description:e.description,yesbtntext:"",yesenabled:!0,nobtntext:e.rejectText,defaultbtn:"no",blocking:e.blocking,id:e.id},directives:[e.contentDirective]}],callback:e.callback,spalocation:e.spalocation})},setReturnValues:d,openPaginated:function(e){c({id:e.id,size:e.size?e.size:OI,directives:[{name:e.name,data:e.data,directives:e.contentDirective}],callback:e.callback,spalocation:e.spalocation})},openPendingDialog:function(){h?a(h):f.length()&&a(f.peek())},buildHtml:function e(t,i){return i||(i=[]),_.forEach(t,function(t){_.get(t,"name")&&(i.push(u(_.get(t,"name"),_.mapValues(_.get(t,"data"),g))),_.isArray(_.get(t,"directives"))&&_.forEach(_.get(t,"directives"),function(t){e([t],i)}),i.push(["</",_.get(t,"name"),">"].join("")))}),i.join("")},setValuesAndClose:function(e,t){d(t.accepted,t.content),l(e)},closeCurrentShowingDialog:function(){h&&l(h.id)}}}function xh(e,t,i,n,r,o,a){"ngInject";return a.get("DialogFactory",Fh,this,arguments)}function Lh(e,t,i,n){"ngInject";return{openMobileDialogIfNecessary:function(r,o,a,s){if(i.isTouchEnabled()&&!n.isState(bI._5)){var c={offerId:o,actionText:a,promoLegalId:s,viewDetailsText:i.getLocalizedStr(void 0,Sce,"view-details-text")};t.events.once(Ey.x,function(e){e.accepted&&_.isFunction(r)&&r()}),e.open({id:Sce,xmlDirective:function(e){return'<origin-dialog-content-mobile-infobubble\n            dialog-id="'+Sce+'"\n            offer-id="'+(e.offerId||"")+'"\n            action-text="'+(e.actionText||"")+'"\n            view-details-text="'+(e.viewDetailsText||"")+'"\n            promo-legal-id="'+(e.promoLegalId||"")+'">\n            </origin-dialog-content-mobile-infobubble>'}(c),size:OI})}else _.isFunction(r)&&r()}}}function Ah(e,t,i){"ngInject";function n(e){o.data.hasEmbeddedFilter=!!e,o.commit()}function r(){i.isSmall()&&(o.data.mainMenuVisible=!o.data.mainMenuVisible),o.commit()}var o=t.observe({hasFilterOverlay:!1,mainMenuOpen:!1,numFilterPanelToggleBtns:0}),a=window.innerWidth;return{getObserver:function(){return e.create(o)},registerFilterPanelToggleBtn:function(){o.data.numFilterPanelToggleBtns++,o.commit()},unregisterFilterPanelToggleBtn:function(){o.data.numFilterPanelToggleBtns>0&&o.data.numFilterPanelToggleBtns--,o.commit()},setEmbeddedFilterpanel:n,setEmbeddedChat:function(e){o.data.hasEmbeddedChat=!!e,o.commit()},toggleEmbeddedFilterpanel:function(){i.isSmall()?(o.data.hasEmbeddedFilter=!1,o.data.hasFilterOverlay=!o.data.hasFilterOverlay):(o.data.hasFilterOverlay=!1,o.data.hasEmbeddedFilter=!o.data.hasEmbeddedFilter),o.commit()},toggleMainMenu:r,setFilterOverlay:function(e){o.data.hasFilterOverlay=!!e,o.commit()},handleMenuClick:function(){n(!1),r()},handleWindowResize:function(){a!==window.innerWidth&&(i.isSmall()?(o.data.hasEmbeddedFilter=!1,o.data.hasFilterOverlay=!1):o.data.hasFilterOverlay&&(o.data.hasEmbeddedFilter=!0,o.data.hasFilterOverlay=!1),a=window.innerWidth),o.commit()},setInboxFlyout:function(e){o.data.siteStripeWithInbox=e,o.commit()}}}function Dh(e,t,i,n,r,o,a,s,c){function l(t){a(function(){e.events.fire(t)},Pce,!1)}function d(){a(function(){Origin.telemetry.events.fire("originGlobalSitestripeVisible")},Pce,!1)}function g(e){if(e.filtered=!1,c.isState(_ce))e.filtered=!0;else{var t=o.href(o.current.name,o.params);if(e.showOnStates.length&&-1===_.findIndex(e.showOnStates,function(e){return _.includes(t,e)}))e.filtered=!0;else if(e.hideOnStates.length&&-1!==_.findIndex(e.hideOnStates,function(e){return _.includes(t,e)}))e.filtered=!0;else if(Origin.client.isEmbeddedBrowser()){if(e.winFilter&&Origin.utils.os()===Origin.utils.OS_WINDOWS)return void(e.filtered=!0);if(e.macFilter&&Origin.utils.os()===Origin.utils.OS_MAC)return void(e.filtered=!0);var i=Origin.client.info.versionNumber();if(!1!==e.greaterVersionFilter&&i>=e.greaterVersionFilter||!1!==e.lesserVersionFilter&&i<=e.lesserVersionFilter)return void(e.filtered=!0);if(e.betaFilter&&Origin.client.info.isBeta())return void(e.filtered=!0);if(e.osVersionGreaterFilter||e.osVersionLesserFilter){var n=Origin.client.info.osVersion();if(null===n||0===n.length)return void(e.filtered=!0);if(e.osVersionGreaterFilter&&1===s.semanticVersionCompare(n,e.osVersionGreaterFilter)||e.osVersionLesserFilter&&-1===s.semanticVersionCompare(n,e.osVersionLesserFilter))return void(e.filtered=!0)}}else if(e.webFilter)return void(e.filtered=!0)}}function u(){var e=_.findLastIndex(b,function(e){return!e.filtered});return-1!==e?b[e]:void 0}function p(e){e.setDataCallback(u())}function m(){_.forEach(y,p)}function f(e){y.length?y[0].getHeightCallback(e.setMarginCallback):e.setMarginCallback(0)}function h(){_.forEach(S,f)}function v(){_.forEach(b,g),m(),h()}var b=[],y=[],S=[];return n.addResizeEventHandler({},h,300),e.events.on("uiRouter:stateChangeSuccess",v),r.listenForScopeAndWindowDestroy({},function(){e.events.off("uiRouter:stateChangeSuccess",v)}),{showStripe:function(e,i,n,r,o,a,s,c,p,f,v,y,S,k,I,w,C,T,P,O,E,F,x,L,A){var D=b.some(function(e){return e.message===o});if(!t.getHideSiteStripeConfig()&&!D){var R=function(e){return _.find(b,function(t){return t.id===e})}(e);R?function(e,t,i,n){e&&(t&&(e.message=t),i&&(e.reason=i),n&&n!==e.ctaCallback&&(e.ctaCallback=n),e===u()&&(m(),h(),l("globalsitestripe:update"),d()))}(R,o,a,c):(R={id:e,ctid:i,priority:n,message:o,reason:a,cta:s,cta2:f,closeCallback:r,ctaCallback:c,getCtaUrl:x,cta2Callback:v,getCta2Url:L,icon:p,permanent:y,winFilter:S,macFilter:k,webFilter:I,greaterVersionFilter:w,lesserVersionFilter:C,betaFilter:T,osVersionGreaterFilter:P,osVersionLesserFilter:O,showOnStates:E,hideOnStates:F,backgroundImageUrl:A,filtered:!0}).message&&(function(e){_.isUndefined(e.priority)&&(e.priority=0),_.isUndefined(e.winFilter)&&(e.winFilter=!1),_.isUndefined(e.macFilter)&&(e.macFilter=!1),_.isUndefined(e.webFilter)&&(e.webFilter=!1),_.isUndefined(e.greaterVersionFilter)&&(e.greaterVersionFilter=!1),_.isUndefined(e.lesserVersionFilter)&&(e.lesserVersionFilter=!1),_.isUndefined(e.betaFilter)&&(e.betaFilter=!1),_.isUndefined(e.showOnStates)&&(e.showOnStates=""),_.isUndefined(e.hideOnStates)&&(e.hideOnStates=""),g(e)}(R),function(e){b.push(e),b=_.sortBy(b,function(e){return e.priority}),m(),h(),l("globalsitestripe:add"),d()}(R))}},hideStripe:function(e){t.getHideSiteStripeConfig()||function(e){_.remove(b,function(t){return t.id===e}),m(),h(),l("globalsitestripe:remove")}(e)},addStripeArea:function(e,t){var i={setDataCallback:e,getHeightCallback:t};y.push(i),p(i),1===y.length&&h()},addStripeMargin:function(e){var t={setMarginCallback:e};return S.push(t),f(t),function(){_.remove(S,function(e){return e===t})}},retrieveTemplate:function(){return i.getTemplate("global-sitestripe",{},!0)},updateFilters:v,getTotalHeight:function(){var e=parseFloat(document.body.style.paddingTop);return isNaN(e)?0:e}}}function Rh(e,t,i,n,r,o,a,s,c,l){"ngInject";return l.get("GlobalSitestripeFactory",Dh,this,arguments)}function $h(e,t,i,n,r){var o=n.getUrl("social"),a=o.facebookShareUrl,s=o.twitterShareUrl;return{openFacebookShareWindow:function(e){var n=i.buildParameterizedUrl(a,e);t.externalUrlInPopupWindow(n,Ece,Fce)},openTwitterShareWindow:function(e){var n=Origin.locale.locale(),r=_.extend({locale:n},e),o=i.buildParameterizedUrl(s,r);t.externalUrlInPopupWindow(o,Ece,Fce)},openEmailCompose:function(e){var i="mailto:?subject="+(e.subject?encodeURIComponent(e.subject):"")+"&body="+(e.body?encodeURIComponent(e.body):"");if(Origin.client.isEmbeddedBrowser())t.externalUrl(i,!1);else if(r.isFirefox()){var n=window.open(i);setTimeout(function(){n.close()},0)}else window.location.href=i}}}function Nh(e,t,i,n,r,o){"ngInject";return o.get("SocialSharingFactory",$h,this,arguments)}function Gh(e,t,i,n,r){return{updateAvailable:function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.getClient(i,n.externalType).then(t.isUpdateAvailable)},gameExpires:function(i){return e.getCatalogAndEntitlementData(i).then(_.spread(t.isBaseGameExpiryImminentInDays(90)))},downloadOverride:function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.getClient(i,n.externalType).then(t.isDownloadOverride)},isThirdPartyAssociationRequired:function(e){return!Origin.client.isEmbeddedBrowser()&&n.isXSmall()?Promise.resolve(!1):i.filterPendingDLCEntitlementsByOfferId(e).then(function(e){return!_.isEmpty(e)}).catch(function(){return!1})},isEligibleToShowRefundLink:function(t){return e.getCatalogAndEntitlementData(t).then(function(i){var n=Lce(i,2),o=n[0],a=n[1];return!!(o&&a&&e.isEligibleToShowRefundLink(o,a))&&r.getGameUsageInfo(t).then(function(e){return e&&e.totalTimePlayedSeconds<=0}).catch(function(){return!1})})}}}function Uh(e,t,i,n,r,o){"ngInject";return o.get("ViolatorBaseGameFactory",Gh,this,arguments)}function Bh(e,t,i,n,r,o,a,s){function c(e,t){return!(!e||!v(t))}function l(e,t){return!!e&&(n=f(function(e){return i.getClientAndEntitlementData(e).then(_.spread(r.isAddonOrExpansionAwatingDownloadInDays(28)))},t),Promise.all(m(n)).then(v));var n}function d(e,t,o){return!(!t.installed||!o)&&Promise.all([i.getExtraContent(e,"OWNEDONLY").then(p(n.isDownloadable)).then(p(g([n.isAddon,n.isExpansion]))),i.getLastPlayedTimeByOfferId(e)]).then(_.spread(function(e,t){if(!b(t))return!1;var n=f(function(e){return i.getClientAndBaseGameLastPlayedData(e,t).then(_.spread(function(e,t){return r.isAddonOrExpansionRecentlyInstalledInDays(7)(e,t)})).catch(function(){return!1})},e);return Promise.all(m(n)).then(v)}))}var g=t.or,u=t.and,p=e.filterBy,m=e.toArray,f=e.map,h=e.mapWith,v=e.hasTruth,b=a.isValidDate,y=s.decorate(function(){return i.getExtraContent.apply(void 0,arguments)},Dce);return{newDlcAvailable:function(e){return Promise.all([i.getCatalog(e).then(n.isBaseGameOriginDisplayType),y(e,"UNOWNEDONLY").then(h(u([n.isDownloadable,n.isPurchasable,n.isAddon,o.isRecentlyReleasedInDays(Origin.utils.os(),7)]))).then(m)]).then(_.spread(c))},newDlcExpansionAvailable:function(e){return Promise.all([i.getCatalog(e).then(n.isBaseGameOriginDisplayType),y(e,"UNOWNEDONLY").then(h(u([n.isDownloadable,n.isPurchasable,n.isExpansion,o.isRecentlyReleasedInDays(Origin.utils.os(),7)]))).then(m)]).then(_.spread(c))},newDlcReadyForInstall:function(e){return Promise.all([i.getCatalog(e).then(u([n.isBaseGameOriginDisplayType,n.isDownloadable])),i.getExtraContent(e,"OWNEDONLY").then(p(u([n.isDownloadable,n.isAddon])))]).then(_.spread(l))},newDlcExpansionReadyForInstall:function(e){return Promise.all([i.getCatalog(e).then(u([n.isBaseGameOriginDisplayType,n.isDownloadable])),i.getExtraContent(e,"OWNEDONLY").then(p(u([n.isDownloadable,n.isExpansion])))]).then(_.spread(l))},newDlcInstalled:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([e,i.getClient(e,t.externalType),i.getCatalog(e).then(u([n.isBaseGameOriginDisplayType,n.isDownloadable]))]).then(_.spread(d)).catch(function(){return!1})}}}function Mh(e,t,i,n,r,o,a,s,c){"ngInject";return c.get("ViolatorDlcFactory",Bh,this,arguments)}function jh(e,t){return{trialNotActivated:function(i){return e.getCatalogAndEntitlementData(i).then(_.spread(t.isTrialAwaitingActivation))},trialNotExpired:function(i){return e.getCatalogAndEntitlementData(i).then(_.spread(t.isTrialInProgress))},trialExpired:function(i){return e.getCatalogAndEntitlementData(i).then(_.spread(t.isTrialExpired))}}}function Hh(e,t,i){"ngInject";return i.get("ViolatorLegacyTrialFactory",jh,this,arguments)}function zh(e,t,i,n,r,o,a,s){function c(e,t){return!t&&o.isHybridGame(e)}function l(e,n){return Promise.all([r.isPremierVaultGameExpiryImminentInDays(DI.s)(e),i.getPremierSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}function d(e,n){return Promise.all([r.isBasicVaultGameExpiryImminentInDays(DI.s)(e),i.getBasicSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}function g(e,t,i){return function(n,o,s){return r.isAvailableOnPlatform(e)(o)&&a.isWrongArchitecture(n)&&function(e,t,i){return e.availableArchitectures===t&&Origin.client.info.osSupportedArchitectures()===i}(s,t,i)}}function u(e,n){return Promise.all([r.isPremierVaultGameExpired()(e),i.getPremierSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}function p(e,n){return Promise.all([r.isBasicVaultGameExpired()(e),i.getBasicSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}var m=e.and;return{releasesOn:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return i.getCatalog(n).then(function(n){var o=function(e,t){var n=_.get(e,[DI._15,t]);return!!i.getOriginSubscriptionUnlockDate(n)}(n,e);return!!(t&&o||!t&&!o)&&r.isReleaseDateImminentInDays(e,365)(n)})}},preloadOn:function(e){return function(t){return i.getCatalog(t).then(function(t){return!s.isEarlyAccessVaultGame(t)&&r.isPreloadImminentInDays(e,365)(t)})}},preloadAvailable:function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([i.getCatalog(t),i.getClient(t,n.externalType),i.getEntitlement(t).then(a.isPreorder)]).then(function(t){var i=Nce(t,3),n=i[0],o=i[1],a=i[2];return!s.isEarlyAccessVaultGame(n)&&r.isPreloadable(e)(n,o,a)})}},justReleased:function(e){return function(t){return i.getCatalog(t).then(r.isRecentlyReleasedInDays(e,5))}},compatibleSinglePlatform:function(e){return function(t){return Promise.all([i.getCatalog(t),n.isInstallableOnPlatform(e)]).then(_.spread(function(e){return function(t,i){return!o.isHybridGame(t)&&!i&&r.isAvailableOnPlatform(e)(t)}}(e)))}},incompatibleHybridPlatform:function(e){return Promise.all([i.getCatalog(e),n.isInstallable()]).then(_.spread(c))},expiresOn:function(e){return function(t){return i.getCatalog(t).then(r.isExpiryImminentInDays(e,DI.r))}},expired:function(e){return function(t){return i.getCatalog(t).then(r.isExpired(e))}},preorderFailed:function(e){return function(t){return i.getCatalogAndEntitlementData(t).then(_.spread(a.isFailedPreorder(e)))}},preAnnouncementDisplayDate:function(e){return function(t){return i.getCatalog(t).then(function(e){return function(t){var i=r.isReleased(e)(t),n=r.isReleaseDateImminentInDays(e,365)(t),o=!_.isEmpty(_.get(t,["i18n","preAnnouncementDisplayDate"]));return!i&&!n&&o}}(e))}},preloaded:function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([i.getCatalog(t),i.getClient(t,n.externalType)]).then(_.spread(r.isPreloaded(e)))}},vaultGameExpiresOn:function(e){return function(n){return i.getCatalogAndEntitlementData(n).then(function(n){var o=Nce(n,2);return function(e,n,o){return Promise.all([!r.isPremierVaultGameExpiryImminentInDays(DI.s)(e),!r.isBasicVaultGameExpiryImminentInDays(DI.s)(e),r.isVaultGameExpiryImminentInDays(o,DI.s)(e),i.getSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}(o[0],o[1],e)})}},premierVaultGameExpiresOn:function(){return function(e){return i.getCatalogAndEntitlementData(e).then(_.spread(l))}},basicVaultGameExpiresOn:function(){return function(e){return i.getCatalogAndEntitlementData(e).then(_.spread(d))}},vaultGameExpired:function(e){return function(n){return i.getCatalogAndEntitlementData(n).then(function(n){var o=Nce(n,2);return function(e,n,o){return Promise.all([!r.isPremierVaultGameExpired()(e),!r.isBasicVaultGameExpired()(e),r.isVaultGameExpired(o)(e),i.getSubscriptionActive(),i.getClientOnline(),a.isInSubscription(n)]).then(t.assertAllValuesTruthy)}(o[0],o[1],e)})}},premierVaultGameExpired:function(){return function(e){return i.getCatalogAndEntitlementData(e).then(_.spread(u))}},basicVaultGameExpired:function(){return function(e){return i.getCatalogAndEntitlementData(e).then(_.spread(p))}},wrongArchitecture:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"64-bit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"32-bit";return function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([i.getClient(r,o.externalType),i.getCatalog(r),Origin.client.games.getAvailableArchitectures(r,{externalType:o.externalType})]).then(_.spread(g(e,t,n))).catch(function(){return!1})}},hasVaultMacAlternative:function(e){return function(t){return Promise.all([i.getCatalog(t),i.getEntitlement(t).then(m([a.isInSubscription,a.isActive])),i.getSubscriptionActive()]).then(_.spread(r.hasVaultMacAlternative(e)))}}}}function Vh(e,t,i,n,r,o,a,s,c){"ngInject";return c.get("ViolatorPlatformFactory",zh,this,arguments)}function Wh(e,t,i,n,r,o){function a(i){return Promise.all([e.getSubscriptionActive(),e.isVaultEditionOwned(i),e.isMissingBasegameVaultEditionOrDLC(i),e.isUpgradeableVaultGame(i)]).then(_.spread(t.isGameEligibleForUpgrade))}function s(t){return n.getActiveSubscriptionLevel()===yI.y.NONE?Promise.reject():e.getCatalogAndEntitlementData(t).then(function(e){var t=Uce(e,2),i=t[0],n=t[1];return i&&n?[i,n]:Promise.reject()})}function c(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{externalType:null};return r.externalType?Promise.resolve(r.externalType===n):e.getEntitlement(t).then(function(e){return i.isPurchasedThroughThirdPartyProvider(e,n)}).catch(function(e){return o.error("ViolatorVaultFactory: Failed to retrieve entitlement for offer "+t,e),!1})}return{offlinePlayExpiring:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.getClient(i,r.externalType).then(t.isOfflinePlayExpiryImminent(5,n.userHasSubscription()))},offlinePlayExpired:function(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.getClient(i,r.externalType).then(_.partial(t.isOfflinePlayExpired,n.userHasSubscription()))},trialNotActivated:function(i){return e.getTrialTime(i).then(t.isTrialAwaitingActivation)},trialNotExpired:function(i){return e.getTrialTime(i).then(t.isTrialInProgress)},trialNotExpiredNotReleased:function(i){return Promise.all([e.getTrialTime(i),e.isReleased(i)]).then(_.spread(t.isTrialInProgressNotReleased))},trialNotExpiredReleased:function(i){return Promise.all([e.getTrialTime(i),e.isReleased(i)]).then(_.spread(t.isTrialInProgressReleased))},trialExpired:function(i){return e.getTrialTime(i).then(t.isTrialExpired)},trialExpiredAndVisibleNotReleased:function(i){return Promise.all([e.getTrialTime(i),e.isHidden(i),e.isReleased(i)]).then(_.spread(t.isTrialExpiredAndVisibleNotReleased))},trialExpiredAndHiddenNotReleased:function(i){return Promise.all([e.getTrialTime(i),e.isHidden(i),e.isReleased(i)]).then(_.spread(t.isTrialExpiredAndHiddenNotReleased))},trialExpiredAndVisibleReleased:function(i){return Promise.all([e.getTrialTime(i),e.isHidden(i),e.isReleased(i)]).then(_.spread(t.isTrialExpiredAndVisibleReleased))},trialExpiredAndHiddenReleased:function(i){return Promise.all([e.getTrialTime(i),e.isHidden(i),e.isReleased(i)]).then(_.spread(t.isTrialExpiredAndHiddenReleased))},subscriptionExpired:function(t){return Promise.all([e.getEntitlement(t),e.getSubscriptionActive()]).then(_.spread(i.isVaultGameExpired))},offlineTrial:function(i){return Promise.all([e.getCatalog(i),e.getClientOnline()]).then(_.spread(t.isOfflineTrial))},isUpgradeableVaultGame:function(t){return s(t).then(function(t){var i=Uce(t,1)[0];return e.isVaultEditionInEarlyAccess(i)}).then(function(e){return!e&&a(t)}).catch(function(){return!1})},isUpgradeableVaultExpansion:function(t){return Promise.all([e.getSubscriptionActive(),e.isVaultEditionOwned(t),e.isUpgradeableVaultGame(t)]).then(function(i){var n=Uce(i,3),r=n[0],o=n[1],a=n[2];return!(!r||o||!a)&&e.getCatalog(t).then(function(t){return!t.bundleOffers||!t.bundleOffers.length||Promise.all(t.bundleOffers.map(function(t){return e.getCatalogAndEntitlementData(t).then(function(e){var t=Uce(e,2),i=t[0],n=t[1];return!(!i||!n)})})).then(function(e){return e.some(function(e){return!e})})})})},showEarlyAccessNotice:function(t){return s(t).then(function(t){var i=Uce(t,1)[0];return e.isVaultEditionInEarlyAccess(i)}).catch(function(){return!1})},isUpgradeableVaultGameEarlyAccess:function(t){return s(t).then(function(t){var i=Uce(t,1)[0];return e.isVaultEditionInEarlyAccess(i)}).then(function(e){return!!e&&a(t)}).catch(function(){return!1})},isRefundablePreorderVaultGame:function(t){return s(t).then(function(t){var n=Uce(t,2),o=n[0],a=n[1];return i.isInSubscription(a)?e.isLesserOrEqualEditionPreOrderedAndRefundable(o):function(t,i){return!(!e.isPurchasedBeforeRelease(t,i)||!e.isEligibleToRefundPreOrder(t,i))&&r.getHigherOrEqualEditionInVault(t).then(function(e){return!_.isUndefined(e)})}(o,a)}).catch(function(){return!1})},isEpicPurchasedEntitlement:function(e,t){return c(e,kF.e.epic,t)},isSteamPurchasedEntitlement:function(e,t){return c(e,kF.e.steam,t)},isSteamVaultEntitlement:function(e){return c(e,kF.e.steamVault)},isNotSteamPurchasedEntitlement:function(e){return c(e,kF.e.steam).then(function(e){return!e})},isSteamVaultGameExpired:function(t){return e.getEntitlement(t).then(function(e){return i.isPurchasedThroughThirdPartyProvider(e,kF.e.steamVault)&&!i.isActive(e)}).catch(function(e){return o.error("ViolatorVaultFactory: Failed to retrieve entitlement for offer "+t,e),!1})}}}function qh(e,t,i,n,r,o){"ngInject";return o.get("ViolatorVaultFactory",Wh,this,arguments)}function Yh(e,t){return{getContent:function(i,n,r){return e.getOcd(i).then(t.coalesceChildDirectives(n,r)).then(t.flattenDirectives(r))}}}function Kh(e,t,i){"ngInject";return i.get("ViolatorProgrammedFactory",Yh,this,arguments)}function Qh(e,t,i,n,r,o,a,s,c,l,d,g,u){function p(e){return e.filter}function m(e,t){return T({priority:t})(e)}function f(e){var t,i;return _.has(e,"startdate")&&(t=new Date(_.get(e,"startdate"))),_.has(e,"enddate")&&(i=new Date(_.get(e,"enddate"))),!(t&&x(t)||i&&L(i))}function h(e,t,i,n,r,o){var a="";return!o&&_.isString(i)&&(a=i.trim()),D(jce,[e||"",t||"",a,n||"",r||"",o||""])}function v(e,t,i,n,r,o){var a=h(e,t,i,n,r,o),s=new Date(u.get(a,null,!0));return!(!F(s)||!x(A(s,Hce)))}function b(e,t){var i=[];return _.forEach(M,function(n){i=(i=i.concat(m(t,n))).concat(m(e,n))}),i}function y(e){var t=e.pop(),i=e.pop(),n=e.pop(),r=e.pop(),o=e.pop(),a=[];if(!e.length||e.length!==V.length)return a;for(var s=0;s<V.length;s++)e[s].every(function(e){return!0===e})&&V[s].context.indexOf(t)>-1&&a.push(_.cloneDeep(V[s]));return a.push(o),a.push(r),a.push(n),a.push(i),a}function S(e){var t=e.pop(),i=e.pop(),n=e.pop(),r=e.pop(),o={catalog:n,entitlement:i,client:t};return e&&e.length?(_.forEach(e,function(e){var t=e.enddateDataSource,i=e.enddateProperty;if(t&&i&&o[t]&&_.has(o[t],i)&&(e.endDate=_.get(o[t],i)),r&&r.leftTrialSec)e.timeRemaining=r.leftTrialSec;else if(n.trialLaunchDuration)e.timeRemaining=60*n.trialLaunchDuration*60;else if(e.endDate&&F(e.endDate)){var a=d.getCountdownData(e.endDate);e.timeRemaining=a.totalSeconds}}),e):e}function k(e){return l.log("Automatic violator error: ",e),Promise.resolve(!1)}function I(e,t,i){var n=V.map(p),r=C(w(function(e,t){return function(i){var n=_.castArray(i),r=C(w(O(e,t),n));return Promise.all(r)}}(e,i),n));return _.forEach(function(e){_.isObject(e)&&_.isFunction(e.then)&&e.catch(k)}),r.push(a.getTrialTime(e)),r.push(a.getCatalog(e)),r.push(a.getEntitlement(e)),r.push(a.getClient(e,i.externalType)),r.push(t),Promise.all(r).then(y).then(S)}var w=s.map,C=s.toArray,T=s.where,P=s.filterCollectionBy,O=c.executeWith,E=Origin.utils.os(),F=d.isValidDate,x=d.isInTheFuture,L=d.isInThePast,A=d.addDays,D=g.createStorageKey,R=new window.Origin.utils.Communicator,$="PCWIN",N="MAC",G="critical",U="high",B="normal",M=[G,U,B,"low"],j={gametile:"gametile",importantinfo:"importantinfo",myhometrial:"myhometrial",quicklaunchtrial:"quicklaunchtrial"},H={programmed:"programmed",automatic:"automatic"},z={gametile:{parentDirectiveName:"origin-game-tile",directiveName:"origin-game-violator-programmed",violatorType:H.programmed,getter:o.getContent},importantinfo:{parentDirectiveName:"origin-gamelibrary-ogd-header",directiveName:"origin-gamelibrary-ogd-important-info",violatorType:H.programmed,getter:o.getContent},myhometrial:{parentDirectiveName:"origin-gamelibrary-ogd-header",directiveName:"origin-gamelibrary-ogd-important-info",violatorType:H.programmed,getter:o.getContent},quicklaunchtrial:{parentDirectiveName:"otkex-hometile",directiveName:"origin-game-violator-programmed",violatorType:H.programmed,getter:o.getContent}},V=[{label:"offlinemodegametile",filter:r.offlineTrial,priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"offlinemode",filter:r.offlineTrial,priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"downloadoverride",filter:e.downloadOverride,priority:G,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"preorderfailed",filter:i.preorderFailed(E),priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"preorderfailedogd",filter:i.preorderFailed(E),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oaexpired",filter:r.subscriptionExpired,priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"gameexpires",filter:e.gameExpires,enddateDataSource:"entitlement",enddateProperty:"terminationDate",priority:G,violatorType:H.automatic,timerformat:"trial",context:[j.gametile,j.importantinfo]},{label:"oagameexpiringgametile",filter:i.vaultGameExpiresOn(E),enddateDataSource:"catalog",enddateProperty:["platforms",E,"originSubscriptionUseEndDate"],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oagameexpiring",filter:i.vaultGameExpiresOn(E),enddateDataSource:"catalog",enddateProperty:["platforms",E,"originSubscriptionUseEndDate"],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oapremiergameexpiringgametile",filter:i.premierVaultGameExpiresOn(),enddateDataSource:"catalog",enddateProperty:[DI._16,DI._32],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oapremiergameexpiring",filter:i.premierVaultGameExpiresOn(),enddateDataSource:"catalog",enddateProperty:[DI._16,DI._32],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oabasicgameexpiringgametile",filter:i.basicVaultGameExpiresOn(),enddateDataSource:"catalog",enddateProperty:[DI._34,DI._32],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oabasicgameexpiring",filter:i.basicVaultGameExpiresOn(),enddateDataSource:"catalog",enddateProperty:[DI._34,DI._32],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"expireson",filter:i.expiresOn(E),enddateDataSource:"catalog",enddateProperty:["platforms",E,"useEndDate"],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oagameexpiredgametile",filter:i.vaultGameExpired(E),priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oagameexpired",filter:i.vaultGameExpired(E),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oapremiergameexpiredgametile",filter:i.premierVaultGameExpired(),priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oapremiergameexpired",filter:i.premierVaultGameExpired(),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oabasicgameexpiredgametile",filter:i.basicVaultGameExpired(),priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oabasicgameexpired",filter:i.basicVaultGameExpired(),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"expired",filter:i.expired(E),priority:G,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"preloaded",filter:i.preloaded(E),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oatrialexpiredgametile",filter:[r.trialExpired,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"oatrialexpiredquicklaunch",filter:[r.trialExpired,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.quicklaunchtrial]},{label:"oatrialexpired",filter:[r.trialExpiredAndVisibleNotReleased,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oatrialexpiredreleased",filter:[r.trialExpiredAndVisibleReleased,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oatrialexpiredhidden",filter:[r.trialExpiredAndHiddenNotReleased,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oatrialexpiredhiddenreleased",filter:[r.trialExpiredAndHiddenReleased,r.isNotSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oaexpiredgametile",filter:r.subscriptionExpired,priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"legacytrialexpired",filter:n.trialExpired,priority:G,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"legacytrialexpiredquicklaunch",filter:n.trialExpired,priority:G,violatorType:H.automatic,context:[j.quicklaunchtrial]},{label:"offlineplayexpiredgametile",filter:r.offlinePlayExpired,priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"offlineplayexpired",filter:r.offlinePlayExpired,priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oagameupgradenoticegametile",filter:r.isUpgradeableVaultGame,priority:U,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-premier-upgrade-gametile-violator",context:[j.gametile]},{label:"oagameupgradenotice",filter:r.isUpgradeableVaultGame,priority:U,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-upgrade-vaultgame-importantinfo-violator",context:[j.importantinfo]},{label:"preloadon",filter:i.preloadOn(E),enddateDataSource:"catalog",enddateProperty:["platforms",E,"downloadStartDate"],priority:U,violatorType:H.automatic,context:[j.gametile]},{label:"preloadavailable",filter:i.preloadAvailable(E),priority:U,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"justreleased",filter:i.justReleased(E),priority:U,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"releaseson",filter:i.releasesOn(E),enddateDataSource:"catalog",enddateProperty:[DI._15,E,DI._21],priority:U,violatorType:H.automatic,context:[j.gametile]},{label:"updateavailable",filter:e.updateAvailable,priority:U,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"steamgamepurchase",filter:r.isSteamPurchasedEntitlement,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-steamgamepurchase-violator",context:[j.gametile]},{label:"steamgamevault",filter:r.isSteamVaultEntitlement,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-steamgamevault-violator",context:[j.gametile]},{label:"steamtrialnotactivated",filter:[r.trialNotActivated,r.isSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"steamtrialnotexpiredgametile",filter:[r.trialNotExpired,r.isSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.gametile]},{label:"steamtrialexpiredgametile",filter:[r.trialExpired,r.isSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.gametile]},{label:"steamtrialnotexpired",filter:[r.trialNotExpiredNotReleased,r.isSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.importantinfo,j.myhometrial]},{label:"steamtrialnotexpiredreleased",filter:[r.trialNotExpiredReleased,r.isSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.importantinfo,j.myhometrial]},{label:"steamtrialexpired",filter:[r.trialExpiredAndVisibleNotReleased,r.isSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"steamtrialexpiredhidden",filter:[r.trialExpiredAndHiddenNotReleased,r.isSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"steamtrialexpiredreleased",filter:[r.trialExpiredAndVisibleReleased,r.isSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"steamtrialexpiredhiddenreleased",filter:[r.trialExpiredAndHiddenReleased,r.isSteamPurchasedEntitlement],priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oatrialnotactivated",filter:[r.trialNotActivated,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"oatrialnotactivatedquicklaunch",filter:[r.trialNotActivated,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,context:[j.quicklaunchtrial]},{label:"oatrialnotexpiredgametile",filter:[r.trialNotExpired,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.gametile]},{label:"oatrialnotexpiredquicklaunch",filter:[r.trialNotExpired,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.quicklaunchtrial]},{label:"oatrialnotexpired",filter:[r.trialNotExpiredNotReleased,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.importantinfo,j.myhometrial]},{label:"oatrialnotexpiredreleased",filter:[r.trialNotExpiredReleased,r.isNotSteamPurchasedEntitlement],priority:B,violatorType:H.automatic,timerformat:"trial",context:[j.importantinfo,j.myhometrial]},{label:"legacytrialnotactivated",filter:n.trialNotActivated,priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"legacytrialnotactivatedquicklaunch",filter:n.trialNotActivated,priority:B,violatorType:H.automatic,context:[j.quicklaunchtrial]},{label:"legacytrialnotexpired",filter:n.trialNotExpired,priority:B,enddateDataSource:"entitlement",enddateProperty:"terminationDate",violatorType:H.automatic,timerformat:"trial",context:[j.gametile,j.importantinfo,j.myhometrial]},{label:"legacytrialnotexpiredquicklaunch",filter:n.trialNotExpired,priority:B,enddateDataSource:"entitlement",enddateProperty:"terminationDate",violatorType:H.automatic,timerformat:"trial",context:[j.quicklaunchtrial]},{label:"offlineplayexpiringgametile",filter:r.offlinePlayExpiring,enddateDataSource:"client",enddateProperty:"offlinePlayExpirationDate",priority:B,violatorType:H.automatic,context:[j.gametile]},{label:"offlineplayexpiring",filter:r.offlinePlayExpiring,enddateDataSource:"client",enddateProperty:"offlinePlayExpirationDate",priority:B,violatorType:H.automatic,context:[j.importantinfo]},{label:"newdlcavailable",filter:t.newDlcAvailable,priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"newdlcreadyforinstall",filter:t.newDlcReadyForInstall,priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"newdlcexpansionreadyforinstall",filter:t.newDlcExpansionReadyForInstall,priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"newdlcinstalled",filter:t.newDlcInstalled,priority:B,violatorType:H.automatic,context:[j.gametile,j.importantinfo]},{label:"oaplatformwin",filter:i.hasVaultMacAlternative(E),priority:B,violatorType:H.automatic,context:[j.importantinfo]},{label:"platformwin",filter:i.compatibleSinglePlatform($),priority:B,violatorType:H.automatic,context:[j.importantinfo]},{label:"platformmac",filter:i.compatibleSinglePlatform(N),priority:B,violatorType:H.automatic,context:[j.importantinfo]},{label:"platformwinmac",filter:i.incompatibleHybridPlatform,priority:B,violatorType:H.automatic,context:[j.importantinfo]},{label:"wrongarchitecture64",filter:i.wrongArchitecture(E),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"wrongarchitecture32",filter:E===N&&i.wrongArchitecture(E,"32-bit","64-bit"),priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"preloadonwin",filter:i.preloadOn($),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:["platforms",$,"downloadStartDate"],context:[j.importantinfo]},{label:"preloadonmac",filter:i.preloadOn(N),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:["platforms",N,"downloadStartDate"],context:[j.importantinfo]},{label:"releasesonpremier",filter:i.releasesOn($,!0),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:[DI._15,$,DI._28],context:[j.importantinfo]},{label:"releasesonwin",filter:i.releasesOn($),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:[DI._15,$,DI._21],context:[j.importantinfo]},{label:"releasesonmac",filter:i.releasesOn(N),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:[DI._15,N,DI._21],context:[j.importantinfo]},{label:"preannouncementdisplaydate",filter:i.preAnnouncementDisplayDate(E),priority:B,violatorType:H.automatic,enddateDataSource:"catalog",enddateProperty:["i18n","preAnnouncementDisplayDate"],context:[j.gametile,j.importantinfo]},{label:"thirdpartyassociationrequired",filter:e.isThirdPartyAssociationRequired,priority:G,violatorType:H.automatic,context:[j.importantinfo]},{label:"oaearlyaccessnoticegametile",filter:r.showEarlyAccessNotice,priority:U,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-premier-playnow-gametile-violator",context:[j.gametile]},{label:"oaearlyaccessupgrade",filter:r.isUpgradeableVaultGameEarlyAccess,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-upgrade-vaultgame-importantinfo-violator",context:[j.importantinfo]},{label:"oarefundpreordervaultgame",filter:r.isRefundablePreorderVaultGame,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-premier-refund-importantinfo-violator",context:[j.importantinfo]},{label:"refundgamelink",filter:e.isEligibleToShowRefundLink,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-refund-game-link-importantinfo-violator",context:[j.importantinfo]},{label:"steamsubscriptionlapsedgametile",filter:r.isSteamVaultGameExpired,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-steamsubscriptionlapsed-violator",context:[j.gametile]},{label:"steamsubscriptionlapsed",filter:r.isSteamVaultGameExpired,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-steamsubscriptionlapsed-violator",context:[j.importantinfo]},{label:"epicgamepurchase",filter:r.isEpicPurchasedEntitlement,priority:G,violatorType:H.automatic,telemetryCssClass:"origin-telemetry-epicgamepurchase-violator",context:[j.gametile]}];return{getViolators:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Promise.all([I(e,t,i),function(e,t){return z[t]?z[t].getter.call(this,e,z[t].parentDirectiveName,z[t].directiveName):Promise.reject("illegal view type: "+t)}(e,t)]).then(_.spread(b)).then(P(f)).then(P(function(e){return function(t){return!v(e,t.priority,t["title-str"],t.enddate,t.startdate,t.label)}}(e)))},dismiss:function(e,t,i,n,r,o){var a=h(e,t,i,n,r,o),s=new Date;u.set(a,s.toISOString(),!0),R.fire(["violator","dismiss",e].join(":"))},isDismissed:v,isWithinViewableDateRange:f,enddateReached:function(e){R.fire(["violator","enddateReached",e].join(":"))},events:R,violatorType:H,viewType:j,isValidViolatorData:function(e){return _.isArray(e)}}}function Jh(e,t,i,n,r,o,a,s,c,l,d,g,u,p){"ngInject";return p.get("GameViolatorFactory",Qh,this,arguments)}function Xh(e,t,i,n,r,o,a,s,c,l,d,g,u,p,m,f,h,v){function b(e){return t.getCatalogInfo([e]).then(F(e))}function y(e){return Promise.resolve(i.getEntitlement(e))}function S(){return Promise.resolve(!1)}function k(e){return _.head(_.values(e))}function I(e){var i=r.getActiveSubscriptionLevel(),n=void 0;return i===yI.y.STANDARD?n=_.get(e,[DI._34,DI._12]):i===yI.y.PREMIUM&&(n=_.get(e,[DI._16,DI._12])),n&&n!==_.get(e,DI._0)?t.getCatalogByPath(n).then(k):Promise.resolve(e)}function w(e){return!0===_.get(e,"isOwned")}function C(){return Promise.resolve(!1)}function T(e){var t=Origin.utils.os();return u.isAvailableOnPlatform(t)(e)?u.isReleased(t)(e):u.isReleasedOnAnyPlatform()(e)}function P(){return Promise.resolve(!1)}function O(e,t){var i=u.getReleaseDate(e,Origin.utils.os());return!!i&&m.isEntitlementGrantedBefore(t,moment(i).toDate())}function E(t,i){var n=_.get(e,"digitalRefundExpiredDays");if(n&&h.isDigitalRefundAllowed(t)&&!m.isPurchasedThroughThirdParty(i)){var r=u.getReleaseDate(t,Origin.utils.os());return!!r&&moment(r).add(n,"days").isAfter(new Date)}return!1}var F=n.getProperty,x=s.getGamePromise,L=i.retrieveExtraContentCatalogInfo,A=i.getOcdByOfferId,D=function(e){return Origin.utils.os()!==Origin.utils.OS_MAC&&(r.isStandardSubscriber()?d.isUpgradeable(e):!!r.isPremiumSubscriber()&&g.isPremierUpgradeable(e))};return{getCatalog:b,getExtraContent:L,getLastPlayedTimeByOfferId:c.getLastPlayedTimeByOfferId,getClient:x,getEntitlement:y,getOcd:A,getCatalogAndEntitlementData:function(){}