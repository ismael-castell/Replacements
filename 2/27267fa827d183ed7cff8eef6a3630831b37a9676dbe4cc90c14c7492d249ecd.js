var CS_CONF={"projectId":4090,"status":1,"hostnames":["routledge.com","corplan.net","taylorfrancis.com"],"crossDomainTracking":0,"crossDomainSingleIframeTracking":0,"consentRequired":1,"allowSubdomains":1,"visitorCookieTimeout":34164000000,"sampleRate":100,"replayRecordingRate":25,"validationRate":10,"lastTrackingDraw":null,"trackerDomain":"c.contentsquare.net","recordingDomain":"r.contentsquare.net","useMalkaPipeline":1,"ed":"l.contentsquare.net/log/web","eMerchandisingEnabled":0,"mouseMoveHeatmapEnabled":0,"autoInsightsEnabled":1,"jsErrorsEnabled":1,"apiErrorsEnabled":0,"secureCookiesEnabled":0,"triggerSessionReplayEnabled":0,"triggerSessionReplayRegex":null,"dynamicIdRegex":null,"whitelistedAttributes":[],"replayRecordingUnmaskedUrlRegex":".+textbooks\\/evaluation.+","replayRecordingMaskedUrlRegex":null,"tagDeploymentMode":"CONTENTSQUARE","experimental":null,"iframesTracking":0,"malkaQuotaServiceDomain":"q-aeu1.contentsquare.net","malkaRecordingDomain":"k-aeu1.contentsquare.net"};!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.ContentSquare="CONTENTSQUARE",t.LoadedByClicktale="LOADED_BY_CLICKTALE",t.LoadClicktalePtc="LOAD_CLICKTALE_PTC",t.DualCollectionReview="DUAL_COLLECTION_REVIEW",t.DualCollection="DUAL_COLLECTION"}(e.TagDeploymentMode||(e.TagDeploymentMode={}))},function(){},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"get",(function(){return X})),r.d(n,"getRequestParameters",(function(){return J}));var i={};r.r(i),r.d(i,"getRequestParameters",(function(){return bn}));var o={nodeFunctions:["childNodes","hasChildNodes","parentNode"],constructors:{Date:"csDate",JSON:"csJSON",Array:"csArray",String:"csString",URL:"csURL"}};function(){}function a(t){Object.keys(o.constructors).forEach((function(e){window[o.constructors[e]]=t[e]})),o.nodeFunctions.forEach((function(e){window["csNode"+e]=s(t.Node.prototype,e)}))}try{!function(){a(window);var t=function(){var t=document.createElement("iframe");t.id="cs-native-frame",t.name="cs-native-frame",t.style.display="none",t.setAttribute("title","Intentionally blank");var e=document.createElement("cs-native-frame-holder");return e.style.display="none",document.body.appendChild(e),e.innerHTML=t.outerHTML,window.frames["cs-native-frame"]}();t&&(window.CSPureWindow=t,a(window.CSPureWindow))}()}catch(t){window.CSProtectnativeFunctionsErrors=JSON.stringify(t)}function(){}function u(t){return t.nodeType===Node.ELEMENT_NODE}function p(t){return t.nodeType===Node.TEXT_NODE}function(){}function h(t){return u(t)&&"img"===t.localName}function f(t){return u(t)&&"style"===t.localName}function d(t){return u(t)&&"input"===t.localName}function y(t){return u(t)&&"script"===t.localName}function(){}function(){}function g(t){return b.isValidElement(t)}function S(t){return csArray.prototype.slice.call(t)}var E=[/\d{4}/,/^ember\d+$/];function w(t,e,r,n){var i=function(t){return c(csString.prototype.toLowerCase.call(t.localName))}(t);if(function(){}(t,r))return{hasUniqueIdentifier:!0,elementSelector:i+'[data-cs-override-id="'+C(t)+'"]'};var o=function(){}(t);return function(){}(t,o,r,n)?{hasUniqueIdentifier:!0,elementSelector:i+"#"+o}:{hasUniqueIdentifier:!1,elementSelector:i+":eq("+function(t,e){if("detached"===t||9===t.nodeType)return 0;var r=csArray.prototype.filter.call(S(csNodechildNodes.apply(t)),(function(t){return 1===t.nodeType&&csString.prototype.toLowerCase.call(t.localName)===csString.prototype.toLowerCase.call(e.localName)}));return csArray.prototype.indexOf.call(r,e)}(e,t)+")"}}function C(t){return t.getAttribute("data-cs-override-id")}function(){}var b;function T(t,e,r,n){var i=csArray.prototype.shift.call(t);if(0===t.length)return A(i,r,n);var o=w(i,t[0],e,n),s=o.elementSelector,a=o.hasUniqueIdentifier;if(!r&&a)return""+A(t[t.length-1],r,n)+s;var c=T(t,e,r,n);return(c?c+">":"")+s}function A(t,e,r){if("detached"===t)return"|detached|";if(t.host){var n=m(t.host);return T(n.ancestors,n.selectionRoot,e,r)+"|shadow-root|"}return 11===t.nodeType?"|fragment|":""}function k(){return Math.floor(L.now()/1e3)}function P(){}function(){}function(){}!function(t){function(){}function(){}t.INVALID_ELEMENT="INVALID_ELEMENT",t.isValidElement=e,t.getElementPath=function(n,i){var o=void 0===i?{}:i,s=o.fullPath,a=void 0!==s&&s,c=o.dynamicIdRegex,u=void 0===c?null:c,p=r(n);if(p===document)return"";if(!e(p))return t.INVALID_ELEMENT;var l=m(p);return T(l.ancestors,l.selectionRoot,a,u)},t.getElementPathAndFirstAnchorParent=function(n,i){var o=void 0===i?{}:i,s=o.fullPath,a=void 0!==s&&s,c=o.dynamicIdRegex,p=void 0===c?null:c,l=r(n);if(l===document)return{path:"",firstAnchorParent:null};if(!e(l))return{path:t.INVALID_ELEMENT,firstAnchorParent:null};var h=function(t){for(var e,r=t,n=[r],i=null;null!==csNodeparentNode.apply(r);)null===i&&(u(e=r)&&"a"===e.localName)&&(i=r),csArray.prototype.push.call(n,csNodeparentNode.apply(r)),r=csNodeparentNode.apply(r);return g(r)&&csArray.prototype.push.call(n,"detached"),{firstAnchorParent:i,ancestors:n,selectionRoot:r}}(l),f=h.firstAnchorParent;return{path:T(h.ancestors,h.selectionRoot,a,p),firstAnchorParent:f}}}(b||(b={})),window.CSPathComputation=window.CSPathComputation||b;function I(t){return N()<t}function N(){return Math.floor(1e4*Math.random())/100}var M,D,L={now:function(){}},x=function(){function t(t){this.trackerDomain=t.trackerDomain,this.loggerDomain=t.ed,this.minLogLevel=t.logLevel,this.projectId=t.projectId,this.status=t.status,this.hostnames=t.hostnames,this.iframesTracking=!!t.iframesTracking,this.crossDomainTracking=!!t.crossDomainTracking,this.crossDomainSingleIframeTracking=!!t.crossDomainSingleIframeTracking,this.consentRequired=!!t.consentRequired,this.allowSubdomains=!!t.allowSubdomains,this.visitorCookieTimeout=t.visitorCookieTimeout||34164e6,this.sampleRate=t.sampleRate,this.replayRecordingRate=t.replayRecordingRate,this.validationRate=t.validationRate,this.lastTrackingDraw=t.lastTrackingDraw||1,this.useHttps=!0,this.recordingDomain=t.recordingDomain,this.eMerchandisingEnabled=t.eMerchandisingEnabled,this.mouseMoveHeatmapEnabled=t.mouseMoveHeatmapEnabled,this.autoInsightsEnabled=t.autoInsightsEnabled,this.jsErrorsEnabled=t.jsErrorsEnabled,this.apiErrorsEnabled=t.apiErrorsEnabled,this.triggerSessionReplayEnabled=t.triggerSessionReplayEnabled,this.triggerSessionReplayRegex=this.buildRegexFromConfiguration(t.triggerSessionReplayRegex),this.metricRate=void 0===t.metricRate?0:t.metricRate,this.dynamicIdRegex=t.dynamicIdRegex?new RegExp(t.dynamicIdRegex):null,this.whitelistedAttributes=t.whitelistedAttributes||[],this.replayRecordingUnmaskedUrlRegex=this.buildRegexFromConfiguration(t.replayRecordingUnmaskedUrlRegex),this.replayRecordingMaskedUrlRegex=this.buildRegexFromConfiguration(t.replayRecordingMaskedUrlRegex),this.tagDeploymentMode=t.tagDeploymentMode,this.dualCollectionTagDomain=t.dualCollectionTagDomain||null,this.ptcDomain=t.ptcDomain||null,this.ptcGuid=t.ptcGuid||null,this.secureCookiesEnabled=!!t.secureCookiesEnabled,this.ptcSha512=t.ptcSha512||null,this.ptcSnapshotPath=t.ptcSnapshotPath||null,this.emitDebugEvents=!1,this.useMalkaPipeline=t.useMalkaPipeline,this.malkaQuotaServiceDomain=t.malkaQuotaServiceDomain||null,this.malkaRecordingDomain=t.malkaRecordingDomain||null}return t.prototype.getTrackerUri=function(){return this.protocol()+"://"+this.trackerDomain},t.prototype.getRecordingUri=function(){},t.prototype.getQuotaServiceUri=function(){return this.protocol()+"://"+this.malkaQuotaServiceDomain},t.prototype.getLoggerUri=function(){return this.protocol()+"://"+this.loggerDomain},t.prototype.protocol=function(){return this.useHttps?"https":"http"},t.prototype.isProjectActive=function(){return 1===this.status},t.prototype.processOptionOverrides=function(){},t.prototype.setOverridableField=function(t,e){"trackerDomain"===t&&(this.trackerDomain=e),"recordingDomain"===t&&(this.recordingDomain=e),"loggerDomain"===t&&(this.loggerDomain=e),"minLogLevel"===t&&(this.minLogLevel=e),"useHttps"===t&&(this.useHttps=!!e)},t.prototype.buildRegexFromConfiguration=function(t){return t?new RegExp("^"+t+"$"):null},t.prototype.getRequestParameters=function(){return{pid:""+this.projectId}},t.prototype.updateDynamicFields=function(){},t}(),q=function(){}();!function(t){t.debug="debug",t.warn="warn",t.error="error",t.critical="critical"}(M||(M={})),function(){}(D||(D={}));var U,V=function(){return(V=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},j=function(){}(),z=(U=function(t,e){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}U(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),B=function(){}(j),H=function(){}(),F=/[a-zA-Z0-9._%+-]+(?:@|%40)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,G=/[a-zA-Z0-9+_-](?:@|%40)/,W=function(){}();function X(){return"10.8.8"}function J(){return{v:"10.8.8"}}var Y,K=function(){return(K=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Q=function(){}();!function(t){t[t.debug=0]="debug",t[t.warn=1]="warn",t[t.error=2]="error",t[t.critical=3]="critical"}(Y||(Y={}));var Z=function(){function t(t,e,r){var n;this.parentLogContext=e,this.pii=new W,this.minLogLevel=Y[M.warn],this.isLoggingActive=!1,this.minLogLevel=Y[t.minLogLevel||M.warn];var i=t.validationRate>=0?t.validationRate:10;this.isLoggingActive=I(i),this.request=r||new H(t,new Q(t,this.pii)),this.logTrack=((n={})[M.debug]=[],n[M.warn]=[],n[M.error]=[],n[M.critical]=[],n),this.snippetLogCounter={},this.request.init()}return t.prototype.send=function(){},t.prototype.getMessage=function(){},t.prototype.getStacktrace=function(){},t.prototype.getContext=function(){},t.prototype.isLoggingAllowed=function(t,e){if(!this.isLoggingActive||Y[t]<this.minLogLevel)return!1;if(0===(null==e?void 0:e.indexOf("snippet-",0)))return this.isLoggingAllowedForSnippets(e);var r=this.logTrack[t];return!(r.length>=5)&&(!e||!csArray.prototype.some.call(r,(function(t){return t===e})))},t.prototype.isLoggingAllowedForSnippets=function(t){return t in this.snippetLogCounter?!(this.snippetLogCounter[t]>=5)&&(this.snippetLogCounter[t]+=1,!0):(this.snippetLogCounter[t]=1,!0)},t}(),$=document.createElement("a");function tt(t){return $.href=t,$.href}function(){}function(){}var nt,it,ot,st;!function(t){t.Parent="parent",t.Child="child"}(nt||(nt={})),function(t){t.Discovery="discovery",t.Stop="stop",t.ChildLogMessage="childLogMessage",t.AnalysisEvent="analysisEvent",t.JavascriptError="javascriptError",t.ApiError="apiError",t.EmerchandisingMessage="emerchandisingMessage",t.Commands="commands"}(it||(it={})),(st=ot||(ot={})).buildBaseMessage=function(){},st.isMessageValid=function(){},st.sendMessage=function(t,e,r){t.postMessage(r,e)};var at,ct,ut,pt,lt,ht=function(){}(),ft=function(){}(),dt=function(){function t(){}return t.setStrategy=function(e){t.strategy=e},t.getStrategy=function(){return t.strategy},t.debug=function(t,e){void 0===e&&(e=""),this.strategy.send(t,e,M.debug)},t.warn=function(t,e){void 0===e&&(e=""),this.strategy.send(t,e,M.warn)},t.error=function(t,e){void 0===e&&(e=""),this.strategy.send(t,e,M.error)},t.critical=function(){},t.tryToExecute=function(t,e){var r=this;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return e.apply(void 0,n)}catch(e){try{r.error(e,t)}catch(t){}}}},t}(),yt=function(){};function(){}function(){}function(){}function St(t){return"object"==typeof t}function Et(t){return void 0!==t}function wt(t){return Et(t)&&null!==t}function Ct(t){return"function"==typeof t}function Rt(t){return t instanceof Element}!function(t){function(){}function(){}function(){}function i(t,n){e(t)&&r(t,"",n,-1),e(t)&&r(t,"",n,-1,ut.None,pt.Yes)}t.CURRENT_DOMAIN="CURRENT_DOMAIN",t.get=e,t.set=r,t.toExpireDate=n,t.remove=i,t.isCookiePresent=function(){return document.cookie.length>0},t.getRootDomain=function(){}}(at||(at={})),function(){}(ct||(ct={})),function(t){t.None="None",t.Lax="Lax",t.NotSet="X"}(ut||(ut={})),function(t){t[t.Yes=1]="Yes",t[t.No=0]="No"}(pt||(pt={})),function(t){t[t.NOT_FOUND=0]="NOT_FOUND",t[t.EXPIRED=1]="EXPIRED",t[t.FOUND=2]="FOUND"}(lt||(lt={}));var bt=function(){function t(t,e,r){this.configuration=t,this.urlService=e,this.cookieChecker=r,this.supportsSameSite=!1,this.sameSiteFlag=ut.NotSet,this.secureFlag=pt.No,this.caches={}}return t.prototype.getSameSiteFlag=function(){return this.sameSiteFlag},t.prototype.getSecureFlag=function(){return this.secureFlag},t.prototype.getDomain=function(){return this.domain},t.prototype.getRootDomain=function(){return this.rootDomain},t.prototype.init=function(){var t=this.computeSameSiteFlag(),e=this.computeSecureFlag();this.supportsSameSite=this.checkSameSiteFromContext(t,e),this.supportsSameSite?(this.sameSiteFlag=t,this.secureFlag=e):this.configuration.secureCookiesEnabled&&"https:"===this.urlService.getUrlProtocol()&&(this.secureFlag=pt.Yes),this.rootDomain=this.computeRootDomain(),this.domain=this.computeDomain(this.rootDomain)},t.prototype.checkSameSiteFromContext=function(){},t.prototype.computeSameSiteFlag=function(){},t.prototype.computeSecureFlag=function(){},t.prototype.isSameSiteSupported=function(){return this.supportsSameSite},t.prototype.set=function(){},t.prototype.setWithCache=function(t,e,r,n){this.set(t,e,r),this.caches[t]={value:e,expires:n}},t.prototype.getWithCache=function(t){var e=this.caches[t];return e?e&&L.now()<=e.expires?{value:e.value,status:lt.FOUND}:{value:e.value,status:lt.EXPIRED}:{value:this.get(t),status:lt.NOT_FOUND}},t.prototype.refreshCacheExpiry=function(t,e){var r=this.caches[t];r&&(r.expires=e)},t.prototype.get=function(){},t.prototype.delete=function(t,e){var r=e||this.domain;at.remove(t,r),delete this.caches[t]},t.prototype.computeRootDomain=function(){},t.prototype.computeDomain=function(t){return this.configuration.allowSubdomains?t:at.CURRENT_DOMAIN},t.CURRENT_DOMAIN="CURRENT_DOMAIN",t.COOKIE_TEST_FOR_SAME_SITE="_cs_same_site",t}(),Tt=function(){function t(t){this.iframeContext=t,this.cookieEnabled=!1,this.useSameSiteNoneSecureCookie=!1}return t.prototype.init=function(){if(this.iframeContext.isTopWindowTracker()&&"cookie"in document){if(!this.iframeContext.isInIframeContext()&&at.isCookiePresent())return this.cookieEnabled=!0,void(this.useSameSiteNoneSecureCookie=!1);if(at.set("_cs_t","1",at.CURRENT_DOMAIN),null!==at.get("_cs_t"))return this.cookieEnabled=!0,this.useSameSiteNoneSecureCookie=!1,void at.remove("_cs_t",at.CURRENT_DOMAIN);at.set("_cs_t","1",at.CURRENT_DOMAIN,void 0,ut.None,pt.Yes),null!==at.get("_cs_t")&&(this.cookieEnabled=!0,this.useSameSiteNoneSecureCookie=!0,at.remove("_cs_t",at.CURRENT_DOMAIN))}},t.prototype.areCookiesEnabled=function(){return this.cookieEnabled},t.prototype.isSameSiteNoneSecureNeeded=function(){return this.useSameSiteNoneSecureCookie},t}();var At,kt=function(){}(),Pt=function(){function t(t,e){this.configuration=t,this.cookieChecker=e}return t.prototype.canTrack=function(){return this.isBrowsingContextSupported()&&this.canTrackProject()&&this.cookieChecker.areCookiesEnabled()&&function(){var t="CSLocalStorageTest";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}()},t.prototype.canTrackInIframe=function(){return this.isBrowsingContextSupported()&&this.canTrackProject()},t.prototype.canTrackProject=function(){},t.prototype.isBrowsingContextSupported=function(){},t.prototype.isDocPrerendered=function(){return"visibilityState"in document&&"prerender"===document.visibilityState},t.prototype.isBrowserSupported=function(){},t}();!function(t){function e(t){return t.get("_cs_cvars")}t.get=function(t){var r=e(t);return null!==r?window.JSON.parse(r):null},t.getRaw=e,t.setRaw=function(t,e,r){e.set("_cs_cvars",t),r.setCookie("_cs_cvars",t)},t.remove=function(t,e){t.delete("_cs_cvars"),e.removeCookie("_cs_cvars")},t.isValidCustomVarString=function(t){return"string"==typeof t}}(At||(At={}));var Ot,_t=function(){function t(t,e,r,n,i,o){this.visitorService=t,this.sessionService=e,this.exclusionService=r,this.configuration=n,this.cookieService=i,this.crossDomainSingleIframeService=o}return t.prototype.get=function(){return{exclusion:this.exclusionService.getAppliedTrackingDraw(),visitor:this.visitorService.getVisitor(),session:this.sessionService.getSession(),cvars:At.getRaw(this.cookieService)}},t.prototype.apply=function(){},t.prototype.exclude=function(){this.exclusionService.exclude(this.configuration),this.visitorService.removeCurrentVisitor(),this.sessionService.removeCurrentSession(),At.remove(this.cookieService,this.crossDomainSingleIframeService)},t.prototype.include=function(t){this.exclusionService.removeExclusion(),this.visitorService.setVisitor(t.visitor),t.session?this.sessionService.setSession(t.session):this.sessionService.removeCurrentSession(),t.cvars?At.setRaw(t.cvars,this.cookieService,this.crossDomainSingleIframeService):At.remove(this.cookieService,this.crossDomainSingleIframeService)},t}(),It=/^(([a-z0-9\-])+(\.[0-9]+){6})(\.(None|Lax|X)\.(0|1))?$/;!function(t){function e(t){return csArray.prototype.join.call([t.id,t.creationTimestamp,t.visitsCount,t.hitTimestamp,t.lastVisitTimestamp,t.appliedTrackingDraw,t.expires,t.sameSite,t.secured],".")}function r(t){var e=csString.prototype.split.call(t,"."),r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],c=e[6],u=e[7],p=e[8];return{id:r,creationTimestamp:Number(n),visitsCount:Number(i),hitTimestamp:Number(o),lastVisitTimestamp:Number(s),appliedTrackingDraw:Number(a),expires:Number(c),sameSite:u||void 0,secured:p?Number(p):void 0}}t.get=function(t){var e=t.get("_cs_id");return e?r(e):null},t.set=function(t,r,n){var i=new csDate(t.expires),o=e(t);r.set("_cs_id",o,i),n.setCookie("_cs_id",o,i)},t.remove=function(t,e,r){e.delete("_cs_id",t),r.removeCookie("_cs_id")},t.toString=e,t.fromString=r,t.isValidVisitorString=function(t){return It.test(t)}}(Ot||(Ot={}));var Nt,Mt=/^\d+\.[0135T](\.\d+)?$/,Dt=function(){function t(t,e){this.cookieService=t,this.crossDomainSingleIframeService=e}return t.prototype.get=function(){},t.prototype.getRawSession=function(t){if(t){var e=this.cookieService.get("_cs_s");return this.removeCookieTimestamp(e)}var r=this.cookieService.getWithCache("_cs_s"),n=r.value,i=r.status,o=this.removeCookieTimestamp(n);if(i!==lt.EXPIRED)return o;var s=this.cookieService.get("_cs_s");if(!s)return null;var a=csString.prototype.split.call(s,".");if(3!==a.length)return s;var c=parseInt(a[2],10);return isNaN(c)||this.cookieService.refreshCacheExpiry("_cs_s",c),o},t.prototype.removeCookieTimestamp=function(t){if(!t)return null;var e=csString.prototype.split.call(t,".");return 3===e.length?e[0]+"."+e[1]:t},t.prototype.set=function(t,e){void 0===e&&(e=18e5);var r=L.now()+e,n=this.toString(t);n+="."+r,this.cookieService.setWithCache("_cs_s",n,e,r),this.crossDomainSingleIframeService.setCookie("_cs_s",n,e)},t.prototype.remove=function(t){this.cookieService.delete("_cs_s",t),this.crossDomainSingleIframeService.removeCookie("_cs_s")},t.prototype.isValid=function(e){return null!==e&&t.isValidSessionString(e)},t.prototype.toString=function(t){return csArray.prototype.join.call([t.pageNumber,t.recordingState],".")},t.fromString=function(t){var e=csString.prototype.split.call(t,"."),r=e[0];return{recordingState:e[1],pageNumber:parseInt(r,10)}},t.isValidSessionString=function(t){return Mt.test(t)},t}();(Nt||(Nt={})).fromRaw=function(t){return{exclusion:Number(t._cs_ex)||0,visitor:t._cs_id?Ot.fromString(t._cs_id):null,session:t._cs_s?Dt.fromString(t._cs_s):null,cvars:t._cs_cvars||null}};var Lt,xt=/^[0-9]+$/,qt=function(){function t(t,e,r){this.location=t,this.cookieService=e,this.crossDomainSingleIframeService=r}return t.prototype.exclude=function(t){this.cookieService.set("_cs_ex",csString(t.lastTrackingDraw),2592e6),this.crossDomainSingleIframeService.setCookie("_cs_ex",""+t.lastTrackingDraw,2592e6)},t.prototype.removeExclusion=function(){this.cookieService.delete("_cs_ex"),this.crossDomainSingleIframeService.removeCookie("_cs_ex")},t.prototype.isExcluded=function(){return this.hasExclusionCookie()||this.hasExclusionInURL()},t.prototype.hasExclusionCookie=function(){return 0!==this.getAppliedTrackingDraw()},t.prototype.getAppliedTrackingDraw=function(){return Number(this.cookieService.get("_cs_ex"))},t.prototype.hasExclusionInURL=function(){return csString.prototype.indexOf.call(this.location.href,"_cs_ex")>0},t.isValidExclusionString=function(t){return xt.test(t)},t}();!function(){}(Lt||(Lt={}));var Ut,Vt=function(){}(),jt=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},zt=function(){function(){}return t.prototype.onMessage=function(t){this.onMessageCallback=t},t.prototype.onTimeout=function(t){this.onTimeoutCallback=t},t.prototype.start=function(){},t.prototype.open=function(t){var e=document.createElement("iframe");return e.src=t,e.style.display="none",e.setAttribute("title","Intentionally blank"),document.body.appendChild(e),e},t.prototype.stop=function(){},t.prototype.handleMessage=function(t){this.onMessageCallback(t)},jt([yt("XdframeMessage")],t.prototype,"handleMessage",null),t}(),Bt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ht=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Ft=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.afterRequestDataRetrievedCallbacks=[],n.requestHeaders=[],n.timeout=0,n}return Bt(e,t),e.prototype.setCompressionOptions=function(t,e){this.compressor=t,this.compressionOutputType=e},e.prototype.setRequestPayloadProvider=function(t){this.requestPayloadProvider=t},e.prototype.setRequestHeader=function(t){csArray.prototype.push.call(this.requestHeaders,t)},e.prototype.afterProvidersCalled=function(t){csArray.prototype.push.call(this.afterRequestDataRetrievedCallbacks,t)},e.prototype.onLoad=function(t){this.onLoadCallback=t},e.prototype.onError=function(t){this.onErrorCallback=t},e.prototype.onTimeout=function(t,e){this.timeout=t,this.onTimeoutCallback=e},e.prototype.send=function(){var t=this;csArray.prototype.forEach.call(this.beforeRequestCallbacks,(function(t){return t()}));var e=this.retrieveParameters(),r=D.toQuery(e),n=this.retrievePayload();csArray.prototype.forEach.call(this.afterRequestDataRetrievedCallbacks,(function(t){return t()})),this.compressor&&this.compressionOutputType?this.compressor.compress(this.compressionOutputType,n,(function(e){t.doSend(r,e)})):this.doSend(r,n)},e.prototype.retrievePayload=function(){return this.requestPayloadProvider?this.requestPayloadProvider.getRequestPayload():""},e.prototype.doSend=function(t,e){this.sendXMLHttpRequest(t,e),csArray.prototype.forEach.call(this.afterRequestCallbacks,(function(t){return t()}))},e.prototype.sendXMLHttpRequest=function(t,e){var r=this;if(null!==window.XMLHttpRequest){var n=new XMLHttpRequest;n.open("POST",this.domainUri+"/"+this.path+"?"+t,!0);for(var i=0,o=this.requestHeaders;i<o.length;i++){var s=o[i];n.setRequestHeader(s.name,s.value)}this.onLoadCallback&&(n.onload=function(){r.onLoadCallback(n)}),this.onErrorCallback&&(n.onerror=function(){r.onErrorCallback()}),this.timeout&&this.onTimeoutCallback&&(n.timeout=this.timeout,n.ontimeout=function(){r.onTimeoutCallback()}),n.send(e)}},Ht([yt("POST request")],e.prototype,"doSend",null),e}(j);!function(t){t[t.MUTATION_INSERT=1]="MUTATION_INSERT",t[t.MUTATION_REMOVE=2]="MUTATION_REMOVE",t[t.MUTATION_ATTRIBUTE=3]="MUTATION_ATTRIBUTE",t[t.MUTATION_CHARACTER_DATA=4]="MUTATION_CHARACTER_DATA",t[t.INITIAL_DOM=5]="INITIAL_DOM",t[t.SCROLL=6]="SCROLL",t[t.MOUSE_MOVE=7]="MOUSE_MOVE",t[t.CLICK=8]="CLICK",t[t.RESIZE=9]="RESIZE",t[t.INPUT_CHECKABLE=10]="INPUT_CHECKABLE",t[t.INPUT_SELECT=11]="INPUT_SELECT",t[t.INPUT_TEXT=12]="INPUT_TEXT",t[t.HASH_CHANGE=13]="HASH_CHANGE",t[t.CONSENT_GRANTED=14]="CONSENT_GRANTED",t[t.CONSENT_WITHDRAWN=15]="CONSENT_WITHDRAWN",t[t.MOUSE_OVER=16]="MOUSE_OVER",t[t.VISIBILITY_CHANGE=17]="VISIBILITY_CHANGE",t[t.STYLESHEET_RULE_INSERT=18]="STYLESHEET_RULE_INSERT",t[t.STATIC_RESOURCE_URL=19]="STATIC_RESOURCE_URL",t[t.PERFORMANCE_TIMINGS=20]="PERFORMANCE_TIMINGS",t[t.ATTACH_SHADOW=22]="ATTACH_SHADOW",t[t.STYLESHEET_CSS_TEXT_UPDATE=23]="STYLESHEET_CSS_TEXT_UPDATE",t[t.MOUSE_DOWN=24]="MOUSE_DOWN",t[t.MOUSE_UP=25]="MOUSE_UP",t[t.JAVASCRIPT_ERROR=26]="JAVASCRIPT_ERROR",t[t.PAGE_EVENT=27]="PAGE_EVENT",t[t.API_ERROR=28]="API_ERROR"}(Ut||(Ut={}));function(){}function Wt(t,e){void 0===e&&(e=!0),t.boundElement.removeEventListener(t.type,t.listener,e)}var Xt,Jt,Yt=function(){return(Yt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Kt=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Qt=function(){function t(e,r,n){var i=this;this.selector=e,this.nodeIdentifier=r,this.sensitiveContent=n,this.documents=[],this.onEventCallbacks=[],this.eventHandlers=[{type:"change",listener:this.selector.on(t.whiteListedCheckableInputsSelector,(function(t){return i.inputCheckableListener(t.target)}))},{type:"change",listener:this.selector.on("select",(function(t){return i.inputSelectListener(t.target)}))},{type:"keyup",listener:this.selector.on(t.whiteListedTextInputSelector,(function(t){return i.inputTextListener(t.target)}))},{type:"scroll",listener:function(t){return i.scrollListener(t.target)}},{type:"mouseover",listener:function(t){return i.mouseOverListener(t)}},{type:"click",listener:function(t){return i.clickListener(t)}},{type:"mousedown",listener:function(t){return i.mouseDownListener(t)}},{type:"mouseup",listener:function(t){return i.mouseUpListener(t)}}],this.initSubscribers()}return t.prototype.initSubscribers=function(){},t.prototype.onEvent=function(){},t.prototype.triggerCallbacks=function(){},t.prototype.start=function(){this.triggerInitialEvents()},t.prototype.stop=function(){this.unbindAllHandlers()},t.prototype.bindHandlers=function(){},t.prototype.unbindHandlers=function(){},t.prototype.unbindAllHandlers=function(){},t.prototype.triggerInitialEvents=function(){this.initialTextInputListener(),this.initialScrollListener(),this.initialSelectListener(),this.initialCheckableListener()},t.prototype.initialTextInputListener=function(){},t.prototype.initialScrollListener=function(){},t.prototype.initialSelectListener=function(){for(var t=document.getElementsByTagName("select"),e=0;e<t.length;e+=1)this.inputSelectListener(t[e])},t.prototype.initialCheckableListener=function(){},t.prototype.getScrollPosition=function(){},t.prototype.scrollListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t,(function(r){if(!e.sensitiveContent.isSensitiveElementNode(t)){var n=e.getScrollPosition(t);e.triggerCallbacks({type:Ut.SCROLL,args:[r,n.left,n.top]})}}))},t.prototype.mouseOverListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t.target,(function(t){e.triggerCallbacks({type:Ut.MOUSE_OVER,args:[t]})}))},t.prototype.clickListener=function(){},t.prototype.mouseDownListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t.target,(function(r){e.triggerCallbacks({type:Ut.MOUSE_DOWN,args:[r,t.button]})}))},t.prototype.mouseUpListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t.target,(function(){}))},t.prototype.inputCheckableListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t,(function(r){e.sensitiveContent.isSensitiveElementNode(t)||e.triggerCallbacks({type:Ut.INPUT_CHECKABLE,args:[r,t.checked]})}))},t.prototype.inputSelectListener=function(){},t.prototype.inputTextListener=function(t){var e=this;this.nodeIdentifier.ifIdentified(t,(function(r){e.sensitiveContent.isSensitiveElementNode(t)||e.triggerCallbacks({type:Ut.INPUT_TEXT,args:[r,csString.prototype.replace.call(t.value,/\S/g,"•")]})}))},t.whiteListedTextInputSelector=csArray.prototype.join.call(["textarea","input:not([type])",'input[type="text"]','input[type="email"]','input[type="search"]','input[type="tel"]','input[type="url"]'],","),t.whiteListedCheckableInputsSelector=csArray.prototype.join.call(['input[type="checkbox"]','input[type="radio"]'],","),Kt([yt("scroll")],t.prototype,"scrollListener",null),Kt([yt("mouseOver")],t.prototype,"mouseOverListener",null),Kt([yt("click")],t.prototype,"clickListener",null),Kt([yt("mousedown")],t.prototype,"mouseDownListener",null),Kt([yt("mouseup")],t.prototype,"mouseUpListener",null),Kt([yt("checkable")],t.prototype,"inputCheckableListener",null),Kt([yt("select")],t.prototype,"inputSelectListener",null),Kt([yt("text")],t.prototype,"inputTextListener",null),t}(),Zt=function(){function t(t,e,r){var n=this;this.mutationSerializer=t,this.mutationObserver=e,this.staticResourceUrlTracker=r,this.mutationObserver.onCharacterDataMutation((function(t){return n.characterDataMutation(t)})),this.mutationObserver.onAttributesMutation((function(t){return n.attributesMutation(t)})),this.mutationObserver.onChildListMutation((function(t){return n.childListMutation(t)})),this.mutationObserver.onAttachShadowMutation((function(t){return n.attachShadowEvent(t)}))}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.mutationObserver.start(),this.recordInitialDom()},t.prototype.stop=function(){this.mutationObserver.stop()},t.prototype.recordInitialDom=function(){var t=this.mutationSerializer.serializeDocument(document);this.onEventCallback({args:t,date:L.now(),type:Ut.INITIAL_DOM})},t.prototype.attachShadowEvent=function(){},t.prototype.attributesMutation=function(){},t.prototype.characterDataMutation=function(){},t.prototype.childListMutation=function(t){var e=this,r=this.mutationSerializer.serializeMutationChildList(t);if(r){var n=r.removedNodes,i=r.addedNodes;n.forEach((function(r){e.onEventCallback({args:r,date:t.date,type:Ut.MUTATION_REMOVE})})),i.forEach((function(r){e.onEventCallback({args:r,date:t.date,type:Ut.MUTATION_INSERT})}))}},t}(),$t=function(){}(),te=function(){function(){}return t.prototype.addEvent=function(){},t.prototype.eventsCount=function(){return this.events.length},t.prototype.clearEvents=function(){this.sizeCounter.reset(),this.events=[]},t.prototype.isFull=function(){return this.sizeCounter.isThresholdReached()||this.eventsCount()>=100},t.prototype.setRequestParametersFromProvider=function(t){var e=t.getRequestParameters();for(var r in e)e.hasOwnProperty(r)&&(this.requestParameters[r]=e[r])},t.prototype.getEvents=function(){return this.events},t.prototype.getRequestPayload=function(){return csJSON.stringify(this.events)},t.prototype.getRequestParameters=function(){return this.requestParameters},t}(),ee=function(){function t(){this.index=1}return t.prototype.increment=function(){this.index+=1},t.prototype.reset=function(){this.index=1},t.prototype.getRequestParameters=function(){},t}(),re=function(){}(),ne=function(){}(),ie=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),oe=function(){return(oe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},se=function(t){function e(e,r,n,i,o,s,a,c,u,p,l,h,f,d,y,v){var m=t.call(this)||this;return m.configuration=e,m.recordingRequest=r,m.recordingBatch=n,m.requestParameters=i,m.requestIndex=o,m.styleSheetRuleTracker=s,m.recordingMutationsTracker=a,m.recordingPageEventsTracker=c,m.recordingBrowserEventsTracker=u,m.sessionRenewer=p,m.staticResourceUrlTracker=l,m.recordingPerformanceTimingsTracker=h,m.javaScriptErrorsTracker=f,m.javaScriptErrorsAnonymizer=d,m.apiErrorsTracker=y,m.apiErrorsAnonymizer=v,m.javaScriptErrorsCount=0,m.apiErrorsCount=0,m.eventEmitter=new re,m.canSendEvents=!0,m}return ie(e,t),e.prototype.init=function(){this.bindRecordingRequest(),this.bindTrackers()},e.prototype.bindRecordingRequest=function(){var t=this;this.recordingRequest.setRequestPayloadProvider(this.recordingBatch),this.recordingRequest.setRequestParametersProviders(this.recordingBatch),this.recordingRequest.afterProvidersCalled((function(){t.recordingBatch.clearEvents(),t.requestIndex.increment(),t.recordingBatch.setRequestParametersFromProvider(t.requestParameters)}))},e.prototype.bindTrackers=function(){var t=this,r=function(e){return t.processEvent(e)};this.styleSheetRuleTracker.onEvent(r),this.recordingMutationsTracker.onEvent(r),this.recordingBrowserEventsTracker.onEvent(r),this.recordingPageEventsTracker.onEvent(r),this.staticResourceUrlTracker.onEvent(r),this.recordingPerformanceTimingsTracker.onEvent(r),this.javaScriptErrorsTracker.onEvent((function(n){t.javaScriptErrorsCount<e.MAX_JAVASCRIPT_ERROR_COUNT&&(r({type:Ut.JAVASCRIPT_ERROR,date:L.now(),args:[t.javaScriptErrorsAnonymizer.anonymize(n)]}),t.javaScriptErrorsCount=t.javaScriptErrorsCount+1)})),this.apiErrorsTracker.onEvent((function(n){t.apiErrorsCount<e.MAX_API_ERROR_COUNT&&(r({type:Ut.API_ERROR,date:L.now(),args:[t.apiErrorsAnonymizer.anonymize(n)]}),t.apiErrorsCount=t.apiErrorsCount+1)}))},e.prototype.blockSendingEvents=function(){this.canSendEvents=!1},e.prototype.allowSendingEvents=function(){this.canSendEvents=!0},e.prototype.processEvent=function(){},e.prototype.onStart=function(){this.recordingBatch.setRequestParametersFromProvider(this.requestParameters),this.recordingPerformanceTimingsTracker.start(),this.styleSheetRuleTracker.start(),this.recordingMutationsTracker.start(),this.recordingBrowserEventsTracker.start(),this.recordingPageEventsTracker.start(),this.configuration.jsErrorsEnabled&&this.javaScriptErrorsTracker.start(),this.configuration.apiErrorsEnabled&&this.apiErrorsTracker.start(),this.configuration.emitDebugEvents&&this.eventEmitter.emit("replayRecordingStarted")},e.prototype.onStop=function(){this.styleSheetRuleTracker.stop(),this.recordingMutationsTracker.stop(),this.recordingBrowserEventsTracker.stop(),this.recordingPageEventsTracker.stop(),this.javaScriptErrorsTracker.stop(),this.apiErrorsTracker.stop()},e.prototype.clearStates=function(){this.pushEvents(),this.requestIndex.reset(),this.recordingBatch.setRequestParametersFromProvider(this.requestParameters),this.javaScriptErrorsCount=0,this.apiErrorsCount=0},e.prototype.pushEvents=function(){this.recordingBatch.eventsCount()>0&&this.canSendEvents&&(this.isStarted?this.recordingRequest.send():this.recordingBatch.clearEvents())},e.prototype.clearEvents=function(){this.recordingBatch.clearEvents()},e.prototype.triggerPageEvent=function(t){this.recordingBatch.addEvent({type:Ut.PAGE_EVENT,date:L.now(),args:[{eventName:csString.prototype.slice.call(t,0,e.MAX_PAGE_EVENT_LENGTH)}]})},e.prototype.triggerConsentGranted=function(){this.recordingBatch.addEvent({date:L.now(),type:Ut.CONSENT_GRANTED})},e.prototype.triggerConsentWithdrawn=function(){this.recordingBatch.addEvent({date:L.now(),type:Ut.CONSENT_WITHDRAWN})},e.MAX_PAGE_EVENT_LENGTH=255,e.MAX_JAVASCRIPT_ERROR_COUNT=20,e.MAX_API_ERROR_COUNT=20,e}(ne);!function(t){t.REPLAY_RECORDING_DISABLED="1",t.REPLAY_RECORDING_ENABLED="3",t.TRIGGER_REPLAY_RECORDING_ENABLED="5"}(Xt||(Xt={})),function(t){t.NOT_RECORDED="0",t.TEMPORARILY_RECORDED="T",t.RANDOM_SAMPLING="5",t.RATIO_URL_PV="6",t.RATIO_URL_SESSION="7",t.ETR="8"}(Jt||(Jt={}));var ae=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ce=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recordingRecoveryRequest=e,o.recordingBatch=r,o.recoveryStorage=n,o.configuration=i,o.pageChangeHandler=function(){try{var t=o.recordingBatch.getRequestParameters();if(!o.hasValidRecordingType(t.rt)||0===o.recordingBatch.eventsCount())return;o.recoveryStorage.save({metadata:t,events:o.recordingBatch.getEvents()})}catch(t){}},o}return ae(e,t),e.prototype.onStart=function(){this.addPageChangeListener()},e.prototype.onStop=function(){this.removePageChangeListener()},e.prototype.recover=function(){this.sendPersistedRecordings()},e.prototype.sendPersistedRecordings=function(){},e.prototype.addPageChangeListener=function(){window.addEventListener("pagehide",this.pageChangeHandler)},e.prototype.removePageChangeListener=function(){window.removeEventListener("pagehide",this.pageChangeHandler)},e.prototype.hasValidRecordingType=function(t){return!this.configuration.useMalkaPipeline||!!t&&t!==Jt.TEMPORARILY_RECORDED},e}(ne),ue=function(){function t(t,e,r,n,i,o,s){this.consentService=t,this.domSerializer=e,this.nodeIdentifier=r,this.sensitiveContent=n,this.anonymization=i,this.configuration=o,this.urlService=s}return t.prototype.init=function(){this.resetAnonymization()},t.prototype.serializeDocument=function(t){performance.mark("cs-start-serializeDocument");var e=this.domSerializer.serialize(t,{forceChildrenSerialization:!0,withAnonymization:this.useAnonymization});return performance.mark("cs-end-serializeDocument"),performance.measure("cs-measure-serializeDocument","cs-start-serializeDocument","cs-end-serializeDocument"),[e]},t.prototype.serializeMutationCharacterData=function(t){var e=this;return this.nodeIdentifier.ifIdentified(t.target,(function(r){var n=t.target.data;if(n!==t.oldValue)return[r,n=e.anonymizeTextIfNeeded(n)]}))},t.prototype.anonymizeTextIfNeeded=function(t){return this.useAnonymization?this.anonymization.anonymizeText(t):t},t.prototype.serializeAttachShadowEvent=function(){},t.prototype.serializeMutationAttribute=function(t){var e=this,r=t.target,n=t.attributeName,i=t.attributeNamespace;return this.nodeIdentifier.ifIdentified(t.target,(function(o){if(!e.sensitiveContent.isSensitiveAttributeName(r,n)){var s=t.target.getAttributeNS(i,n);if(s!==t.oldValue)return s=e.anonymization.anonymizeAttributeIfNeeded(e.useAnonymization,n,s),[o,i,n,s]}}))},t.prototype.serializeMutationChildList=function(t){var e=this;return this.nodeIdentifier.ifIdentified(t.target,(function(r){if(!e.sensitiveContent.isSensitiveElementNode(t.target))return{removedNodes:e.serializeRemovedNodes(t),addedNodes:e.serializeAddedNodes(t,r)}}))},t.prototype.serializeRemovedNodes=function(){},t.prototype.serializeAddedNodes=function(t,e){for(var r=[],n=t.nextSibling?this.nodeIdentifier.ifIdentified(t.nextSibling,(function(t){return t})):null,i=0;i<t.addedNodes.length;i+=1){var o=t.addedNodes[i];if(!this.nodeIdentifier.hasIdentifier(o)){var s=this.domSerializer.serialize(o,{withAnonymization:this.useAnonymization});csArray.prototype.push.call(r,[e,n,s])}}return r},t.prototype.resetAnonymization=function(){},t}(),pe=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},le=function(){function t(t,e,r){var n=this;this.monkeyPatcher=t,this.nodeIdentifier=e,this.staticResourceUrlTracker=r,this.canTrackRuleInsertions()&&(this.insertRuleInterceptor=this.monkeyPatcher.createSyncFunctionInterceptor({target:window.CSSStyleSheet.prototype,methodName:"insertRule",hook:function(t){var e=t.context,r=t.args;return n.sendInsertion(e,r)}})),this.canTrackStyleDeclarationChanges()&&(this.cssTextInterceptor=this.monkeyPatcher.createDescriptorInterceptor(window.CSSStyleDeclaration.prototype,"cssText",(function(t,e){return n.setStyleDeclarationCssText(t,e)})))}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.insertRuleInterceptor&&this.insertRuleInterceptor.activate(),this.cssTextInterceptor&&this.cssTextInterceptor.activate()},t.prototype.stop=function(){this.insertRuleInterceptor&&this.insertRuleInterceptor.deactivate(),this.cssTextInterceptor&&this.cssTextInterceptor.deactivate()},t.prototype.setStyleDeclarationCssText=function(){},t.prototype.getSyleSheet=function(t){var e=t.parentRule;return e&&e.parentStyleSheet},t.prototype.indexOfRule=function(t,e){return csArray.prototype.indexOf.call(csArray.from(t),e)},t.prototype.canTrackRuleInsertions=function(){return window.CSSStyleSheet&&window.CSSStyleSheet.prototype&&"function"==typeof window.CSSStyleSheet.prototype.insertRule},t.prototype.canTrackStyleDeclarationChanges=function(){},t.prototype.sendInsertion=function(t,e){var r=this,n=e[0],i=e[1];this.nodeIdentifier.ifIdentified(t.ownerNode,(function(){}))},pe([yt("styleSheetRuleTracker.setStyleDeclarationCssText")],t.prototype,"setStyleDeclarationCssText",null),pe([yt("styleSheetRuleTracker.sendInsertion")],t.prototype,"sendInsertion",null),t}(),he=function(){function t(){}return t.prototype.beforeSerialize=function(t,e){return t},t.prototype.beforeSerializeChildren=function(t,e,r){return e},t.prototype.beforeSerializeAttributes=function(t,e,r){return e},t.prototype.serializeNode=function(t,e,r){return e},t.prototype.serializeElementNode=function(t,e,r){return e},t.prototype.serializeAttribute=function(t,e,r,n){return r},t.prototype.serializeTextNode=function(t,e,r){return e},t.prototype.serializeCommentNode=function(t,e,r){return e},t.prototype.serializeDoctypeNode=function(t,e,r){return e},t.prototype.serializeDocumentNode=function(t,e,r){return e},t.prototype.serializeShadowRootNode=function(t,e,r){return e},t}(),fe=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),de=function(t){function e(){var e=t.call(this)||this;return e.identifierAddedHandlers=[],e.identifierRemovedHandlers=[],e.currentCsId=1,e}return fe(e,t),e.prototype.beforeSerialize=function(){},e.prototype.beforeSerializeChildren=function(){},e.prototype.serializeNode=function(){},e.prototype.ifIdentified=function(){},e.prototype.getId=function(t){return t.__contentsquare_identifier},e.prototype.onIdentifierAdded=function(t){csArray.prototype.push.call(this.identifierAddedHandlers,t)},e.prototype.onIdentifierRemoved=function(t){csArray.prototype.push.call(this.identifierRemovedHandlers,t)},e.prototype.popId=function(t){var e=this.getId(t);delete t.__contentsquare_identifier,this.notifySubscribers(this.identifierRemovedHandlers,t);for(var r=t.firstChild;null!==r;r=r.nextSibling)this.popId(r);var n=t.shadowRoot;return n&&this.popId(n),e},e.prototype.hasIdentifier=function(t){return"__contentsquare_identifier"in t},e.prototype.notifySubscribers=function(){},e}(he),ye=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ve=["value","checked","src","data","alt"],me=function(t){function e(e){var r=t.call(this)||this;return r.piiMaskingService=e,r}return ye(e,t),e.prototype.beforeSerializeChildren=function(t,e){return this.isSensitiveElementNode(t)?[]:e},e.prototype.beforeSerializeAttributes=function(t,e){var r=this;return this.isSensitiveElementNode(t)&&(csArray.prototype.push.call(e,this.createSensitiveElementDimensionsAttribute(t)),this.isDataCSMaskNeeded(t)&&csArray.prototype.push.call(e,document.createAttribute("data-cs-mask"))),csArray.prototype.filter.call(e,(function(e){return!r.isSensitiveAttributeName(t,e.name)}))},e.prototype.isSensitiveElementNode=function(t){return u(t)&&(this.piiMaskingService.checkNodeMatch(t)||y(t)||this.isSensitiveImageElement(t))},e.prototype.isSensitiveAttributeName=function(t,e){return this.piiMaskingService.checkAttributeMatch(t,e)||this.isSensitiveElementNode(t)&&-1!==csArray.prototype.indexOf.call(ve,e)||this.isSensitiveInputValue(t,e)},e.prototype.isSensitiveImageElement=function(t){return!!h(t)&&O(t.src,"data:")},e.prototype.isSensitiveInputValue=function(t,e){return d(t)&&"value"===e&&"button"!==t.getAttribute("type")},e.prototype.isDataCSMaskNeeded=function(t){return!y(t)&&!t.hasAttribute("data-cs-mask")},e.prototype.createSensitiveElementDimensionsAttribute=function(){},e}(he);function ge(){return Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector}var Se,Ee=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),we=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},Ce=["id","class","style","src","srcset","sizes","href","rel","type","width","height","media","align","dir","bgcolor","color","border","colspan","rowspan","cols","rows","size","start","data-cs-override-id"],Re=/[^\s]/g,be=function(t){function e(e,r){var n=t.call(this)||this;return n.pii=e,n.configuration=r,n.allWhitelistedAttributes=[],n}return Ee(e,t),e.prototype.init=function(){this.allWhitelistedAttributes=we(Ce,this.configuration.whitelistedAttributes)},e.prototype.beforeSerializeChildren=function(){},e.prototype.serializeNode=function(t,e,r){return e.anonymized=r.withAnonymization,e},e.prototype.serializeAttribute=function(t,e,r,n){r.anonymized=n.withAnonymization;var i=this.anonymizeAttributeIfNeeded(n.withAnonymization,e.name,e.value);return r.value=this.piiAnonymizeAttributeIfNeeded(e.name,i),r},e.prototype.serializeTextNode=function(t,e,r){var n=t.data,i=r.withAnonymization?this.anonymizeText(n):n;return e.data=this.pii.anonymize(i),e},e.prototype.anonymizeAttributeIfNeeded=function(t,e,r){return t&&null!==r?this.isWhitelistedAttribute(e)?r:"":r},e.prototype.piiAnonymizeAttributeIfNeeded=function(t,e){return this.isWhitelistedAttribute(t)?e:this.pii.anonymize(e)},e.prototype.anonymizeText=function(t){return csString.prototype.replace.call(t,Re,"a")},e.prototype.setWhitelistedElementsSelector=function(t){this.whitelistedElementsSelector=t},e.prototype.isWhitelistedAttribute=function(t){return-1!==csArray.prototype.indexOf.call(this.allWhitelistedAttributes,t)},e.prototype.isWhitelistedElement=function(){},e.prototype.elementMatchesWhitelistedSelectors=function(t){return!!this.whitelistedElementsSelector&&ge().call(t,this.whitelistedElementsSelector)},e}(he),Te=function(){function(){}return t.prototype.save=function(t){localStorage.setItem(this.storageName,csJSON.stringify(t))},t.prototype.recover=function(){},t.prototype.getStorageKeys=function(){},t.prototype.removeItem=function(t){localStorage.removeItem(t)},t.prototype.parseStoredItem=function(){},t}(),Ae=function(){return(Ae=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},ke=function(){}(),Pe=function(){function t(t){this.asyncTaskFactory=t,this.userActive=!1,this.pendingInactivity=null}return t.prototype.start=function(){this.userActive=!0,this.createPendingInactivity()},t.prototype.stop=function(){this.userActive=!1,this.clearPendingInactivity()},t.prototype.trackActivity=function(){this.userActive||(this.onActivityResumedCallback(),this.userActive=!0),this.clearPendingInactivity(),this.createPendingInactivity()},t.prototype.createPendingInactivity=function(){},t.prototype.clearPendingInactivity=function(){null!==this.pendingInactivity&&(this.pendingInactivity.cancel(),this.pendingInactivity=null)},t.prototype.isUserActive=function(){return this.userActive},t.prototype.onActivityStopped=function(t){this.onActivityStoppedCallback=t},t.prototype.onActivityResumed=function(t){this.onActivityResumedCallback=t},t}(),Oe=function(){}(),_e=function(){function t(){}return t.prototype.create=function(t,e,r){return new Oe(t,e,r)},t}();!function(t){function(){}function r(){return document.documentElement.scrollWidth}function n(){return window.innerHeight}function i(){return window.innerWidth}function o(){return screen.width}function s(){return screen.height}t.documentHeight=e,t.documentWidth=r,t.windowHeight=n,t.windowWidth=i,t.screenWidth=o,t.screenHeight=s,t.windowOffsetX=function(){return window.pageXOffset},t.windowOffsetY=function(){return window.pageYOffset},t.getRequestParameters=function(){}}(Se||(Se={}));var Ie=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Ne=function(){}(),Me=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),De=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recordingPageEventsTracker=e,o.recordingMutationsTracker=r,o.recordingActivityTracker=n,o.recordingRequest=i,o.recordingRequestDuringInactivityCount=0,o.isMutationTrackerStopped=!1,o}return Me(e,t),e.prototype.init=function(){},e.prototype.onStart=function(){this.recordingActivityTracker.start()},e.prototype.onStop=function(){this.recordingActivityTracker.stop()},e.prototype.stopMutationTrackerIfNeeded=function(){!this.isMutationTrackerStopped&&!this.recordingActivityTracker.isUserActive()&&this.recordingRequestDuringInactivityCount>=2&&(this.recordingMutationsTracker.stop(),this.isMutationTrackerStopped=!0)},e}(ne),Le=r(1),xe=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};function(){}function(){}var Ve,je=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ze=function(){}(he);!function(t){t.REQUEST_START="requestStart",t.DOM_INTERACTIVE="domInteractive"}(Ve||(Ve={}));var Be,He=function(){}(),Fe=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ge=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},We=function(t){function e(e,r){var n=t.call(this)||this;return n.monkeyPatcher=e,n.nodeIdentifier=r,n}return Fe(e,t),e.prototype.init=function(){this.initInterceptors(),this.initSubscribers(),this.initMutationObserver()},e.prototype.initMutationObserver=function(){},e.prototype.initInterceptors=function(){},e.prototype.initSubscribers=function(){var t=this;this.nodeIdentifier.onIdentifierAdded((function(e){v(e)&&t.observe(e)}))},e.prototype.onChildListMutation=function(t){this.childListMutationCallback=t},e.prototype.onCharacterDataMutation=function(t){this.characterDataMutationCallback=t},e.prototype.onAttributesMutation=function(t){this.attributesMutationCallback=t},e.prototype.onAttachShadowMutation=function(t){this.attachShadowMutationCallback=t},e.prototype.observe=function(t){if(!this.isStarted)throw new Error("MutationObserverService not started");this.observer.observe(t,{subtree:!0,attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0})},e.prototype.onStart=function(){this.attachShadowInterceptor&&this.attachShadowInterceptor.activate(),this.createShadowRootInterceptor&&this.createShadowRootInterceptor.activate()},e.prototype.onStop=function(){this.attachShadowInterceptor&&this.attachShadowInterceptor.deactivate(),this.createShadowRootInterceptor&&this.createShadowRootInterceptor.deactivate(),this.observer.disconnect()},e.prototype.supportAttachShadow=function(){return window.Element&&window.Element.prototype&&"function"==typeof window.Element.prototype.attachShadow},e.prototype.supportCreateShadowRoot=function(){return window.Element&&window.Element.prototype&&"function"==typeof window.Element.prototype.createShadowRoot},e.prototype.handleMutations=function(){},e.prototype.handleAttachShadow=function(){},Ge([yt("mutations")],e.prototype,"handleMutations",null),e}(ne),Xe=function(){return(Xe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Je=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};!function(t){t[t.WebElement=0]="WebElement",t[t.MobileView=1]="MobileView",t[t.WebViewContainer=2]="WebViewContainer"}(Be||(Be={}));var Ye=function(){function t(t){this.processors=t}return t.prototype.serialize=function(t,e){void 0===e&&(e={});var r=Xe({},e),n=t.nodeType,i=csArray.prototype.reduce.call(this.processors,(function(t,e){return e.beforeSerialize(t,r)}),t);switch(n){case Node.ELEMENT_NODE:return this.serializeElementNode(i,r);case Node.TEXT_NODE:return this.serializeTextNode(i,r);case Node.COMMENT_NODE:return this.serializeCommentNode(i,r);case Node.DOCUMENT_TYPE_NODE:return this.serializeDoctypeNode(i,r);case Node.DOCUMENT_NODE:return this.serializeDocumentNode(i,r);case Node.DOCUMENT_FRAGMENT_NODE:return this.serializeDocumentFragmentNode(i,r);default:throw new Error("serialization is not supported (nodeType: "+n+")")}},t.prototype.serializeElementNode=function(t,e){var r,n=csArray.prototype.reduce.call(this.processors,(function(r,n){var i=n.serializeNode(t,r,e);return n.serializeElementNode(t,i,e)}),{attributes:[]});(r=csArray.prototype.push).call.apply(r,Je([n.attributes],this.serializeAttributes(t,e)));var i=t.shadowRoot;return i&&(n.shadowRoot=this.serializeShadowRootNode(i,e)),n.children=this.serializeChildren(t,e),n},t.prototype.serializeAttributes=function(){},t.prototype.serializeAttribute=function(){},t.prototype.serializeChildren=function(t,e){var r=this,n=S(csNodechildNodes.apply(t));return csArray.prototype.map.call(csArray.prototype.reduce.call(this.processors,(function(r,n){return n.beforeSerializeChildren(t,r,e)}),n),(function(t){return r.serialize(t,e)}))},t.prototype.serializeTextNode=function(t,e){return csArray.prototype.reduce.call(this.processors,(function(r,n){var i=n.serializeNode(t,r,e);return n.serializeTextNode(t,i,e)}),{})},t.prototype.serializeCommentNode=function(t,e){return csArray.prototype.reduce.call(this.processors,(function(r,n){var i=n.serializeNode(t,r,e);return n.serializeCommentNode(t,i,e)}),{})},t.prototype.serializeDoctypeNode=function(){},t.prototype.serializeDocumentNode=function(t,e){var r=csArray.prototype.reduce.call(this.processors,(function(r,n){var i=n.serializeNode(t,r,e);return n.serializeDocumentNode(t,i,e)}),{});return r.children=this.serializeChildren(t,e),r},t.prototype.serializeShadowRootNode=function(){},t.prototype.serializeDocumentFragmentNode=function(){},t}(),Ke=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ke(e,t),e.prototype.beforeSerializeChildren=function(t,e){if(f(t)){var r=this.cssRules(t);this.isEmptyStyleElementWithRules(t,r)&&csArray.prototype.push.call(e,this.createTextNodeFromRules(r))}return e},e.prototype.cssRules=function(t){try{var e=t.sheet;if(!e)return;return e.cssRules||e.rules}catch(t){if("SecurityError"!==t.name&&"InvalidAccessError"!==t.name)throw t;return}},e.prototype.isEmptyStyleElementWithRules=function(t,e){var r=t.textContent||"";return/^\s*$/.test(r)&&void 0!==e&&0!==e.length},e.prototype.createTextNodeFromRules=function(t){var e=csArray.prototype.join.call(csArray.prototype.map.call(S(t),(function(t){return t.cssText})),"");return document.createTextNode(e)},e.prototype.serializeNode=function(t,e){return e.nodeType=t.nodeType,e.format=Be.WebElement,e},e.prototype.serializeElementNode=function(t,e){return e.localName=t.localName,e.namespaceURI=t.namespaceURI,e},e.prototype.serializeAttribute=function(){},e.prototype.serializeTextNode=function(t,e){return e.data=t.data,e},e.prototype.serializeCommentNode=function(t,e){return e.data=t.data,e},e.prototype.serializeDoctypeNode=function(t,e){return e.name=t.name,e.publicId=t.publicId,e.systemId=t.systemId,e},e.prototype.serializeDocumentNode=function(t,r){return r.baseURI=e.getBaseURI(t),r},e.prototype.serializeShadowRootNode=function(t,e){return e.mode=t.mode,e},e.getBaseURI=function(){},e}(he),Ze=(function(){function t(t){this.processors=t}t.prototype.unserialize=function(t){if(void 0!==t.format&&t.format!==Be.WebElement)throw new Error("unserialization is not supported (format: "+t.format+")");var e=t.nodeType;switch(e){case Node.ELEMENT_NODE:return this.unserializeElementNode(t);case Node.TEXT_NODE:return this.unserializeTextNode(t);case Node.COMMENT_NODE:return this.unserializeCommentNode(t);case Node.DOCUMENT_TYPE_NODE:return this.unserializeDoctypeNode(t);case Node.DOCUMENT_NODE:return this.unserializeDocumentNode(t);default:throw new Error("unserialization is not supported (nodeType: "+e+")")}},t.prototype.unserializeShadowRoot=function(t,e){var r=csArray.prototype.reduce.call(this.processors,(function(r,n){var i=n.unserializeShadowRoot(t,e,r);return n.unserializeNode(e,i)}),null);return this.unserializeChildren(r,e.children),r},t.prototype.unserializeElementNode=function(t){var e=csArray.prototype.reduce.call(this.processors,(function(e,r){var n=r.unserializeElementNode(t,e);return r.unserializeNode(t,n)}),null);return this.unserializeAttributes(e,t.attributes),this.unserializeChildren(e,t.children),t.shadowRoot&&this.unserializeShadowRoot(e,t.shadowRoot),e},t.prototype.unserializeChildren=function(t,e){var r=this;csArray.prototype.forEach.call(S(e),(function(e){return t.appendChild(r.unserialize(e))}))},t.prototype.unserializeAttributes=function(t,e){var r=this;csArray.prototype.forEach.call(S(e),(function(e){try{r.unserializeAttribute(t,e)}catch(t){}}))},t.prototype.unserializeAttribute=function(t,e){csArray.prototype.reduce.call(this.processors,(function(t,r){return r.unserializeAttribute(e,t)}),t)},t.prototype.unserializeTextNode=function(t){return csArray.prototype.reduce.call(this.processors,(function(e,r){var n=r.unserializeTextNode(t,e);return r.unserializeNode(t,n)}),null)},t.prototype.unserializeCommentNode=function(t){return csArray.prototype.reduce.call(this.processors,(function(e,r){var n=r.unserializeCommentNode(t,e);return r.unserializeNode(t,n)}),null)},t.prototype.unserializeDoctypeNode=function(t){return csArray.prototype.reduce.call(this.processors,(function(e,r){var n=r.unserializeDoctypeNode(t,e);return r.unserializeNode(t,n)}),null)},t.prototype.unserializeDocumentNode=function(t){var e=this,r=csArray.prototype.reduce.call(this.processors,(function(e,r){var n=r.unserializeDocumentNode(t,e);return r.unserializeNode(t,n)}),null);return csArray.prototype.forEach.call(S(t.children),(function(t){return r.appendChild(e.unserialize(t))})),r}}(),function(){function t(){}return t.prototype.unserializeShadowRoot=function(t,e,r){return r},t.prototype.unserializeNode=function(t,e){return e},t.prototype.unserializeElementNode=function(t,e){return e},t.prototype.unserializeAttribute=function(t,e){return e},t.prototype.unserializeTextNode=function(t,e){return e},t.prototype.unserializeCommentNode=function(t,e){return e},t.prototype.unserializeDoctypeNode=function(t,e){return e},t.prototype.unserializeDocumentNode=function(t,e){return e},t}()),$e=function(){function t(){this.domParser=new DOMParser}return t.prototype.createElement=function(t){var e=this.htmlSanitizer(t);return this.parseHtmlElement("<"+e+" />")},t.prototype.createAttribute=function(t,e){var r=this.htmlSanitizer(t),n=this.parseHtmlElement("<div "+r+'=""></div>'),i=n.getAttributeNode(r);return n.removeAttributeNode(i),i.value=e,i},t.prototype.parseHtmlElement=function(t){return this.domParser.parseFromString(t,"text/html").body.children[0]},t.prototype.htmlSanitizer=function(t){return csString.prototype.replace.call(t,/[\s<>\/\0]/g,"")},t}(),tr=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),er=(function(t){function e(e){var r=t.call(this)||this;return r.document=e,r.dirtyElementBuilder=new $e,r}tr(e,t),e.prototype.unserializeShadowRoot=function(t,e){return e.mode,t.attachShadow({mode:"open"})},e.prototype.unserializeElementNode=function(t){var e=this.getTagName(t),r=t.namespaceURI;try{return this.isXhtmlNamespace(r)&&e.indexOf(":")>-1?this.document.createElement(e):this.document.createElementNS(r,e)}catch(t){switch(t.name){case"InvalidCharacterError":return this.dirtyElementBuilder.createElement(e);default:throw t}}},e.prototype.unserializeAttribute=function(t,e){try{e.setAttributeNS(t.namespaceURI,t.name,t.value)}catch(r){switch(r.name){case"NamespaceError":e.setAttribute(t.name,t.value);break;case"InvalidCharacterError":e.setAttributeNode(this.dirtyElementBuilder.createAttribute(t.name,t.value));break;default:throw r}}return e},e.prototype.unserializeTextNode=function(t){return this.document.createTextNode(t.data)},e.prototype.unserializeCommentNode=function(t){return this.document.createComment(t.data)},e.prototype.unserializeDoctypeNode=function(t){return this.document.implementation.createDocumentType(t.name,t.publicId,t.systemId)},e.prototype.unserializeDocumentNode=function(){return this.document.implementation.createDocument(null,null,null)},e.prototype.isXhtmlNamespace=function(t){return"http://www.w3.org/1999/xhtml"===t},e.prototype.isSvgNamespace=function(t){return"http://www.w3.org/2000/svg"===t},e.prototype.getTagName=function(t){var e=t,r=e.localName,n=e.tagName;return r||(this.isSvgNamespace(t.namespaceURI)?n:n.toLowerCase())}}(Ze),function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),rr=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},nr=function(t){function e(e){return t.call(this,rr([new Qe],e))||this}return er(e,t),e}(Ye);function(){}function(){}var sr=function(){return(sr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},ar=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},cr=function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ur=function(){}(),pr=function(){function t(t,e,r,n,i,o,s,a,c,u,p,l,h,f,d,y){this.sessionService=t,this.configuration=e,this.compressor=r,this.selector=n,this.consentService=i,this.basicParameters=o,this.commandsService=s,this.pii=a,this.sessionRenewer=c,this.urlService=u,this.piiMaskingService=p,this.javaScriptErrorsTracker=l,this.javaScriptErrorsAnonymizer=h,this.apiErrorsTracker=f,this.apiErrorsAnonymizer=d,this.debugService=y}return t.prototype.init=function(){var t=this,e=new ur,r=new de,n=new me(this.piiMaskingService);this.anonymizationService=new be(this.pii,this.configuration),this.anonymizationService.init();var i=new ze,o=new We(e,r),s=new nr([r,n,this.anonymizationService,i]);this.recordingBatch=new te;var a=new ee,c=new ke(a,this.basicParameters);this.configuration.useMalkaPipeline&&c.addProvider({getRequestParameters:function(){return{rt:t.sessionService.getRecordingState()}}});var u=this.createRecordingPostRequest(this.compressor);this.mutationSerializer=new ue(this.consentService,s,r,n,this.anonymizationService,this.configuration,this.urlService),this.mutationSerializer.init();var p=new Qt(this.selector,r,n),l=new Zt(this.mutationSerializer,o,i);this.recordingService=new se(this.configuration,u,this.recordingBatch,c,a,new le(e,r,i),l,p,new Ne(window.location,this.pii),this.sessionRenewer,i,new He(window),this.javaScriptErrorsTracker,this.javaScriptErrorsAnonymizer,this.apiErrorsTracker,this.apiErrorsAnonymizer),this.recordingInactivityService=new De(p,l,new Pe(new _e),u);var h=new Te("csPersisted"),f=this.createRecordingPostRequest(this.compressor);this.recordingRecoveryService=new ce(f,this.recordingBatch,h,this.configuration),o.init(),this.recordingInactivityService.init(),this.recordingService.init(),this.commandsService.register(["isRecording"],(function(){return t.sessionService.isReplayRecorded()})),this.commandsService.register(["setCapturedElementsSelector"],(function(e){t.anonymizationService.setWhitelistedElementsSelector(e)})),this.commandsService.register(["setPIISelectors"],(function(e){t.piiMaskingService.setPIISelectors(e)}))},t.prototype.onStartTracking=function(){this.recordingRecoveryService.recover(),this.sessionService.isReplayRecorded()&&(this.configuration.useMalkaPipeline&&this.sessionService.getRecordingState()===Jt.TEMPORARILY_RECORDED&&this.recordingService.blockSendingEvents(),this.recordingInactivityService.start(),this.recordingService.start(),this.recordingRecoveryService.start())},t.prototype.onAfterArtificialPageView=function(){this.recordingService.clearStates(),this.mutationSerializer.resetAnonymization(),this.sessionService.isReplayRecorded()?(this.recordingInactivityService.restart(),this.recordingService.restart(),this.recordingRecoveryService.restart()):(this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop())},t.prototype.onBeforeSessionRenewal=function(){this.recordingService.clearStates(),this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop()},t.prototype.onOptout=function(){this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop()},t.prototype.onPageEvent=function(t){this.recordingService.triggerPageEvent(t)},t.prototype.onEventTriggerRecording=function(t){this.recordingService.triggerPageEvent(t)},t.prototype.onConsentGranted=function(){this.mutationSerializer.resetAnonymization(),this.recordingService.triggerConsentGranted()},t.prototype.onConsentWithdrawn=function(){this.mutationSerializer.resetAnonymization(),this.recordingService.triggerConsentWithdrawn()},t.prototype.onRecordingStateChange=function(t){var e=this;if(this.configuration.useMalkaPipeline)switch(t){case Jt.NOT_RECORDED:this.recordingService.clearEvents(),this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop();break;case Jt.RANDOM_SAMPLING:this.recordingBatch.setRequestParametersFromProvider({getRequestParameters:function(){return{rt:e.sessionService.getRecordingState()}}}),this.recordingService.allowSendingEvents(),this.recordingService.pushEvents()}},t.prototype.createRecordingPostRequest=function(){},t.isSupported=function(){return"MutationObserver"in window&&"visibilityState"in document},t}(),lr=function(){function t(t,e){this.visitorService=t,this.sessionService=e,this.naturalPageViewSent=!1}return t.prototype.isNaturalPageViewSent=function(){return this.naturalPageViewSent},t.prototype.setNaturalPageViewSent=function(t){this.naturalPageViewSent=t},t.prototype.getTrackingContext=function(){var t=this.getSessionKey(),e=this.getPageNumber();return t&&e?{sessionKey:t,pageNumber:e}:null},t.prototype.getSessionKey=function(){},t.prototype.getPageNumber=function(){return this.sessionService.doesSessionExist()?this.sessionService.getSession().pageNumber:null},t}(),hr=function(){}(),fr=function(){}(),dr=function(){function t(t,e,r){this.visitorService=t,this.sessionService=e,this.commandsService=r}return t.prototype.init=function(){var t=this;this.trackingContextService=new lr(this.visitorService,this.sessionService),this.afterPageViewService=new hr(this.trackingContextService),this.getSessionKeyService=new fr(this.trackingContextService),this.commandsService.register(["getSessionKey"],(function(e){return t.getSessionKeyService.handleCommand(e)})),this.commandsService.register(["afterPageView"],(function(e){t.afterPageViewService.handleCommand(e)}))},t.prototype.onAfterNaturalPageView=function(){this.trackingContextService.setNaturalPageViewSent(!0),this.getSessionKeyService.flushPendingCallbacks(),this.afterPageViewService.executeRegisteredCallbacks()},t.prototype.onAfterArtificialPageView=function(){this.afterPageViewService.executeRegisteredCallbacks()},t}(),yr=function(){}(),vr=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mr=function(){}(ne),gr=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};var Sr,Er,wr,Cr=function(){},Rr=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},br=function(){}(),Tr=["trackDynamicVariable"],Ar=function(){}(),kr=function(){}(),Pr=function(){}(),Or=function(){}(),_r=function(){}(),Ir=function(){}(),Nr=["ecommerce:addToCart","ec:cart:add"],Mr=["ecommerce:addTransaction","ec:transaction:create"],Dr=["ecommerce:addItem","ec:transaction:items:add"],Lr=["ecommerce:send","ec:transaction:send"],xr=function(){}(),qr=function(){}();!function(t){t[t.TAP=0]="TAP",t[t.LONG_PRESS=1]="LONG_PRESS",t[t.DRAG=2]="DRAG",t[t.FLICK=3]="FLICK"}(Sr||(Sr={})),function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(Er||(Er={})),function(t){t[t.RESIZE=0]="RESIZE",t[t.SCROLL=1]="SCROLL",t[t.MOUSEMOVE=2]="MOUSEMOVE",t[t.MOUSEDOWN=3]="MOUSEDOWN",t[t.MOUSEUP=4]="MOUSEUP",t[t.CLICK=5]="CLICK",t[t.MOUSEOVER=6]="MOUSEOVER",t[t.MOUSEOUT=7]="MOUSEOUT",t[t.CHANGE=10]="CHANGE",t[t.FOCUSIN=11]="FOCUSIN",t[t.FOCUSOUT=12]="FOCUSOUT",t[t.TAP=14]="TAP"}(wr||(wr={}));var Ur=function(){},Vr=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jr=function(t){function(){}return Vr(e,t),e.prototype.isEventTypeSupported=function(t){return-1!==csArray.prototype.indexOf.call(this.supportedEventTypes,t)},e.prototype.enhanceAnalysisEvent=function(t,e){if(this.projectConfiguration.eMerchandisingEnabled){var r=this.pathComputation.getTargetPathAndTargetLink(t),n=r.path,i=r.targetLink;e.target=n,e.targetLink=i}else e.target=this.pathComputation.getTargetPath(t),e.targetLink="";return e},e}(Ur),zr=function(t){return null!==t.target&&t.target.shadowRoot&&t.composedPath?t.__csOriginalTarget||t.composedPath()[0]:t.target},Br=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hr=function(t){function e(e){var r=t.call(this)||this;return r.projectConfiguration=e,r.supportedEventTypes=[wr.CLICK,wr.MOUSEDOWN,wr.MOUSEUP,wr.TAP],r}return Br(e,t),e.prototype.isEventTypeSupported=function(t){return-1!==csArray.prototype.indexOf.call(this.supportedEventTypes,t)},e.prototype.enhanceAnalysisEvent=function(t,e){if(this.projectConfiguration.autoInsightsEnabled){e.className="",e.typeAttribute="";var r=zr(t);r&&u(r)&&(e.className=r.className,(u(n=r)&&"button"===n.localName||d(r))&&(e.typeAttribute=r.type))}var n;return e},e}(Ur),Fr=function(){function(){}return t.prototype.onTap=function(t,e){if(t.type===Sr.TAP){var r=this.buildAnalysisEvent(e,{type:wr.TAP});r.target!==b.INVALID_ELEMENT&&this.onEventCallback(r)}},t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.gestureTracker.start()},t.prototype.stop=function(){this.gestureTracker.stop()},t.prototype.buildAnalysisEvent=function(t,e){return csArray.prototype.reduce.call(csArray.prototype.filter.call(this.analysisEventsEnhancers,(function(t){return t.isEventTypeSupported(e.type)})),(function(e,r){return r.enhanceAnalysisEvent(t,e)}),e)},t}(),Gr=function(){}(),Wr=function(){function t(){this.metricsComputer=new Gr,this.reset()}return t.prototype.onGesture=function(t){this.onGestureCallback=t},t.prototype.isValidTouchEvent=function(t){return"touches"in t&&"changedTouches"in t},t.prototype.processActionDown=function(t){this.isGestureStart(t)&&this.reset(),csArray.prototype.push.call(this.pendingInputs,{x:t.touches[0].pageX,y:t.touches[0].pageY,time:csDate.now()}),this.target=zr(t)},t.prototype.processActionMove=function(){this.hasMove=!0},t.prototype.processActionUp=function(t){csArray.prototype.push.call(this.pendingInputs,{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY,time:csDate.now()}),this.isValidSingleTouchGesture()&&this.runDetection(t)},t.prototype.reset=function(){this.pendingInputs=[],this.target=null,this.hasMove=!1},t.prototype.runDetection=function(){},t.prototype.computeSwipeGesture=function(){},t.prototype.computePressGesture=function(){},t.prototype.isGestureStart=function(t){return 1===t.touches.length},t.prototype.isValidSingleTouchGesture=function(){return 2===this.pendingInputs.length},t}(),Xr=function(){}(),Jr=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};function Yr(t,e){var r,n,i,o,s=function(){};return function(){}}var Kr,Qr;(Qr=Kr||(Kr={})).isEventOnScrollContainer=function(t){return!!(wt(t)&&function(t){try{if(wt(t.target))return!0}catch(t){}return!1}(t)&&Rt(t.target)&&null!==t.target.getAttribute("data-cs-scroll-container"))},Qr.getScrollContainer=function(){return document.querySelector("[data-cs-scroll-container]")};var Zr;(Zr||(Zr={})).getRelativePosition=function(){};var $r=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tn=function(t){function(){}return $r(e,t),e.prototype.isEventTypeSupported=function(){},e.prototype.enhanceAnalysisEvent=function(t,e){if(!this.projectConfiguration.mouseMoveHeatmapEnabled)return e;var r=Zr.getRelativePosition(t),n=r.valid,i=r.xRel,o=r.yRel;if(n){var s=this.pathComputation.getTargetPath(t);s!==b.INVALID_ELEMENT&&(e.target=0,e.xRel=i,e.yRel=o,s!==this.currentMouseMovePath||this.projectConfiguration.iframesTracking?(this.currentMouseMovePath=s,e.targetHeatmap=s):e.targetHeatmap="")}else this.currentMouseMovePath="";return e},e}(Ur),en=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.validInputTypes=["text","email","number","search","tel","url","password"],e}return en(e,t),e.prototype.isEventTypeSupported=function(t){return wr.CHANGE===t},e.prototype.enhanceAnalysisEvent=function(t,e){var r=zr(t);return d(r)&&csArray.prototype.indexOf.call(this.validInputTypes,r.type)>=0&&(e.isBlank=""===r.value),e},e}(Ur),nn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},on=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},sn=function(){function t(t,e,r){var n,i,o,s,a,c,u,p=this;this.projectConfiguration=t,this.pathComputation=e,this.selector=r,this.FOCUSABLE_ELEMENTS_SELECTOR="select, select *, input, textarea",this.CHANGEABLE_ELEMENTS_SELECTOR="select, select *, input, textarea",this.HOVERABLE_ELEMENTS_SELECTOR="a, a *, button, button *, select, select *, input, textarea",this.DEBOUNCE_DURATION=150,this.THROTTLE_DURATION=400,this.scrollContainerDimensionSent=!1,this.debouncedScrollEventCallback=Yr((function(t,e){return p.scrollListener(t,e)}),this.DEBOUNCE_DURATION),this.debouncedResizeEventCallback=Yr((function(t){return p.resizeListener(t)}),this.DEBOUNCE_DURATION),this.throttledMouseMoveCallback=(n=function(t){return p.mouseMoveListener(t)},i=this.THROTTLE_DURATION,s=[],a=null,c=0,u=function(){},function(){}),this.globalHandlers=[{boundElement:window,type:"resize",listener:function(){return p.debouncedResizeEventCallback()}},{boundElement:document,type:"scroll",listener:function(t){return p.debouncedScrollEventCallback(t)}},{boundElement:window,type:"mousemove",listener:function(t){p.throttledMouseMoveCallback(p.preserveEventForAsyncUse(t))}},{boundElement:document,type:"mousedown",listener:function(t){return p.mouseDownListener(t)}},{boundElement:document,type:"mouseup",listener:function(t){return p.mouseUpListener(t)}},{boundElement:document,type:"click",listener:function(t){return p.clickListener(t)}}],this.onSelectorHandlers=[{boundElement:document,type:"mouseover",listener:this.selector.on(this.HOVERABLE_ELEMENTS_SELECTOR,(function(t){return p.mouseOverListener(t)}))},{boundElement:document,type:"mouseout",listener:this.selector.on(this.HOVERABLE_ELEMENTS_SELECTOR,(function(t){return p.mouseOutListener(t)}))},{boundElement:document,type:"focusin",listener:this.selector.on(this.FOCUSABLE_ELEMENTS_SELECTOR,(function(t){return p.focusInListener(t)}))},{boundElement:document,type:"focusout",listener:this.selector.on(this.FOCUSABLE_ELEMENTS_SELECTOR,(function(t){return p.focusOutListener(t)}))},{boundElement:document,type:"change",listener:this.selector.on(this.CHANGEABLE_ELEMENTS_SELECTOR,(function(t){return p.changeListener(t)}))}],this.analysisEventsEnhancers=[new jr(this.projectConfiguration,this.pathComputation),new tn(this.projectConfiguration,this.pathComputation),new Hr(this.projectConfiguration),new rn]}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){},t.prototype.stop=function(){},t.prototype.getSupportedHandlers=function(){},t.prototype.resizeListener=function(t){var e=Kr.getScrollContainer(),r=Rt(e);r&&(this.scrollContainerDimensionSent=!0);var n={type:wr.RESIZE,x:r?e.clientWidth:Se.windowWidth(),y:r?e.clientHeight:Se.windowHeight()};t&&(n.target=t),this.onEventCallback(n)},t.prototype.scrollListener=function(t,e){var r=Kr.isEventOnScrollContainer(e);!this.scrollContainerDimensionSent&&r&&this.resizeListener();var n=this.buildAnalysisEvent(e,{type:wr.SCROLL,x:r?e.target.scrollLeft:Se.windowOffsetX(),y:r?e.target.scrollTop:Se.windowOffsetY(),target:t});this.onEventCallback(n)},t.prototype.mouseMoveListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.MOUSEMOVE,x:t.pageX,y:t.pageY});this.onEventCallback(e)},t.prototype.mouseDownListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.MOUSEDOWN,x:t.pageX,y:t.pageY});this.onEventCallbackIfValidTarget(e)},t.prototype.mouseUpListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.MOUSEUP,x:t.pageX,y:t.pageY});this.onEventCallbackIfValidTarget(e)},t.prototype.clickListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.CLICK,x:t.pageX,y:t.pageY});this.onEventCallbackIfValidTarget(e)},t.prototype.mouseOverListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.MOUSEOVER,x:t.pageX,y:t.pageY});this.onEventCallbackIfValidTarget(e)},t.prototype.mouseOutListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.MOUSEOUT,x:t.pageX,y:t.pageY,target:this.pathComputation.getTargetPath(t)});this.onEventCallbackIfValidTarget(e)},t.prototype.focusInListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.FOCUSIN,target:this.pathComputation.getTargetPath(t)});this.onEventCallbackIfValidTarget(e)},t.prototype.focusOutListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.FOCUSOUT,target:this.pathComputation.getTargetPath(t)});this.onEventCallbackIfValidTarget(e)},t.prototype.changeListener=function(t){var e=this.buildAnalysisEvent(t,{type:wr.CHANGE,target:this.pathComputation.getTargetPath(t)});this.onEventCallbackIfValidTarget(e)},t.prototype.onEventCallbackIfValidTarget=function(t){t.target!==b.INVALID_ELEMENT&&this.onEventCallback(t)},t.prototype.buildAnalysisEvent=function(t,e){return csArray.prototype.reduce.call(csArray.prototype.filter.call(this.analysisEventsEnhancers,(function(t){return t.isEventTypeSupported(e.type)})),(function(e,r){return r.enhanceAnalysisEvent(t,e)}),e)},t.prototype.preserveEventForAsyncUse=function(){},nn([yt("Event handler type: resize")],t.prototype,"resizeListener",null),nn([yt("Event handler type: scroll")],t.prototype,"scrollListener",null),nn([yt("Event handler type: mouseMove")],t.prototype,"mouseMoveListener",null),nn([yt("Event handler type: mouseDown")],t.prototype,"mouseDownListener",null),nn([yt("Event handler type: mouseUp")],t.prototype,"mouseUpListener",null),nn([yt("Event handler type: click")],t.prototype,"clickListener",null),nn([yt("Event handler type: mouseOver")],t.prototype,"mouseOverListener",null),nn([yt("Event handler type: mouseOut")],t.prototype,"mouseOutListener",null),nn([yt("Event handler type: focusIn")],t.prototype,"focusInListener",null),nn([yt("Event handler type: focusOut")],t.prototype,"focusOutListener",null),nn([yt("Event handler type: change")],t.prototype,"changeListener",null),t}(),an=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},cn=function(){function(){}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){Gt(this.maxScrollRateHandler),this.reset()},t.prototype.stop=function(){Wt(this.maxScrollRateHandler)},t.prototype.reset=function(){var t=Kr.getScrollContainer();if(null===t)this.maxScrollRate=this.currentScrollRate(Se.documentHeight());else{var e=this.computePaddingTop(t);this.maxScrollRate=this.currentScrollRateWithScrollContainer(t,e)}this.onEventCallback()},t.prototype.maxScrollRateListener=function(t){var e,r;if(Kr.isEventOnScrollContainer(t)){var n=t.target,i=this.computePaddingTop(n);e=this.documentHeightWithScrollContainer(n,i),r=this.currentScrollRateWithScrollContainer(n,i)}else e=Se.documentHeight(),r=this.currentScrollRate(e);(r>this.maxScrollRate||e>this.maxDocumentHeight)&&(this.maxScrollRate=r,e>this.maxDocumentHeight&&(this.maxDocumentHeight=e),this.onEventCallback())},t.prototype.currentScrollRate=function(){},t.prototype.lastPixelLine=function(){},t.prototype.currentScrollRateWithScrollContainer=function(){},t.prototype.computePaddingTop=function(){},t.prototype.documentHeightWithScrollContainer=function(){},t.prototype.getRequestParameters=function(){},an([yt("MaxScrollRate handler")],t.prototype,"maxScrollRateListener",null),t}(),un=function(){return(un=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},pn=function(){function t(t,e,r,n,i,o,s,a,c,u,p){var l=this;this.configuration=t,this.analysisEventsTracker=e,this.gestureTracker=r,this.maxScrollRateTracker=n,this.performanceTimingMetrics=i,this.analysisEventsBatch=o,this.analysisEventsRequest=s,this.analysisLastEventsRequest=a,this.analysisEventRequestParameters=c,this.sessionRenewer=u,this.recoveryStorage=p,this.eventEmitter=new re,this.visibilityChangeListener=function(){"hidden"===document.visibilityState&&l.sendLastEvents()},this.sendLastEvents=function(){l.analysisEventsBatch.isEmpty()||l.analysisLastEventsRequest.send()}}return t.prototype.init=function(){var t=this;this.analysisEventsTracker.onEvent((function(e){return t.processEvent(e)})),this.gestureTracker.onEvent((function(e){return t.processEvent(e)})),this.maxScrollRateTracker.onEvent((function(){t.analysisEventsBatch.setRequestParametersFromProvider(t.maxScrollRateTracker)})),this.bindRequests()},t.prototype.bindRequests=function(){var t=this;this.analysisEventsRequest.setRequestParametersProviders(this.analysisEventsBatch),this.analysisEventsRequest.before((function(){t.analysisEventsBatch.setRequestParametersFromProvider(t.performanceTimingMetrics),t.analysisEventsBatch.enableCompression()})),this.analysisEventsRequest.after((function(){t.analysisEventsBatch.clearEvents(),t.analysisEventsBatch.setRequestParametersFromProvider(t.analysisEventRequestParameters)})),this.analysisLastEventsRequest.setRequestParametersProviders(this.analysisEventsBatch),this.analysisLastEventsRequest.before((function(){t.analysisEventsBatch.setRequestParametersFromProvider(t.performanceTimingMetrics),t.analysisEventsBatch.disableCompression()})),this.analysisLastEventsRequest.onBeaconSuccess((function(){t.analysisEventsBatch.clearEvents(),t.analysisEventsBatch.setRequestParametersFromProvider(t.analysisEventRequestParameters)})),this.analysisLastEventsRequest.onBeaconFailure((function(){t.saveLastEvents()}))},t.prototype.initStates=function(){this.analysisEventsBatch.setRequestParametersFromProvider(this.analysisEventRequestParameters),this.resetStartTime()},t.prototype.start=function(){this.addLastEventsListeners(),this.analysisEventsTracker.start(),this.maxScrollRateTracker.start(),this.gestureTracker.start()},t.prototype.onIframeAnalysisEvent=function(t){this.processEvent(t)},t.prototype.processEvent=function(){},t.prototype.serializeAnalysisEvent=function(t){var e=[t.type,this.getRelativeTime()];return"x"in t&&csArray.prototype.push.call(e,t.x),"y"in t&&csArray.prototype.push.call(e,t.y),"target"in t&&csArray.prototype.push.call(e,t.target),"isBlank"in t&&csArray.prototype.push.call(e,t.isBlank),this.configuration.mouseMoveHeatmapEnabled&&("targetHeatmap"in t&&csArray.prototype.push.call(e,t.targetHeatmap),"xRel"in t&&csArray.prototype.push.call(e,t.xRel),"yRel"in t&&csArray.prototype.push.call(e,t.yRel)),"targetLink"in t&&csArray.prototype.push.call(e,t.targetLink),"className"in t&&csArray.prototype.push.call(e,t.className),"typeAttribute"in t&&csArray.prototype.push.call(e,t.typeAttribute),e},t.prototype.sendEvents=function(){this.analysisEventsBatch.isEmpty()||this.analysisEventsRequest.send()},t.prototype.stop=function(){this.removeLastEventsListeners(),this.analysisEventsTracker.stop(),this.maxScrollRateTracker.stop(),this.gestureTracker.stop(),this.analysisEventsBatch.empty()},t.prototype.clearStates=function(){this.sendEvents(),this.maxScrollRateTracker.reset()},t.prototype.resetStartTime=function(){this.startTime=L.now()},t.prototype.getRelativeTime=function(){return L.now()-this.startTime},t.prototype.addLastEventsListeners=function(){this.addVisibilityChangeListener(),this.addPageHideListener(),this.addBlurListener()},t.prototype.removeLastEventsListeners=function(){this.removeVisibilityChangeListener(),this.removePageHideListener(),this.removeBlurListener()},t.prototype.addVisibilityChangeListener=function(){document.addEventListener("visibilitychange",this.visibilityChangeListener)},t.prototype.removeVisibilityChangeListener=function(){document.removeEventListener("visibilitychange",this.visibilityChangeListener)},t.prototype.addPageHideListener=function(){window.addEventListener("pagehide",this.sendLastEvents)},t.prototype.removePageHideListener=function(){window.removeEventListener("pagehide",this.sendLastEvents)},t.prototype.addBlurListener=function(){window.addEventListener("blur",this.sendLastEvents)},t.prototype.removeBlurListener=function(){window.removeEventListener("blur",this.sendLastEvents)},t.prototype.saveLastEvents=function(){},t}(),ln=fn.toString(),hn=fn();function(){}var dn=function(){return(dn=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},yn=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.events=t,this.requestParameters=e,this.compressed=!0,this.sizeCounter=new $t(15360)}return t.prototype.addEvent=function(t){this.sizeCounter.add(encodeURIComponent(csJSON.stringify(t))),csArray.prototype.push.call(this.events,t)},t.prototype.setRequestParametersFromProvider=function(){},t.prototype.eventsCount=function(){return this.events.length},t.prototype.clearEvents=function(){this.sizeCounter.reset(),this.events=[]},t.prototype.empty=function(){this.clearEvents()},t.prototype.isFull=function(){},t.prototype.isEmpty=function(){return 0===this.events.length},t.prototype.getEvents=function(){return this.events},t.prototype.getMetadata=function(){return this.requestParameters},t.prototype.getRequestParameters=function(){var t=window.JSON.stringify(this.events);return this.compressed?dn(dn({},this.requestParameters),{e:hn.compressToBase64(t)}):dn(dn({},this.requestParameters),{eu:t})},t.prototype.enableCompression=function(){this.compressed=!0},t.prototype.disableCompression=function(){this.compressed=!1},t}(),vn=function(){function t(t,e){var r=this;this.analysisEventsRecoveryRequest=t,this.recoveryStorage=e,this.visibilityChangeHandler=function(){"visible"===document.visibilityState&&r.sendPersistedRecordings()}}return t.prototype.start=function(){this.sendPersistedRecordings(),this.addVisibilityChangeListener()},t.prototype.stop=function(){this.removeVisibilityChangeListener()},t.prototype.getRecoveryStorage=function(){return this.recoveryStorage},t.prototype.sendPersistedRecordings=function(){var t=this.recoveryStorage.recover();if(null!==t){var e=t,r=e.metadata,n=e.events,i=new yn(n,r);this.analysisEventsRecoveryRequest.setRequestParametersProviders(i),this.analysisEventsRecoveryRequest.before((function(){i.enableCompression()})),this.analysisEventsRecoveryRequest.send()}},t.prototype.addVisibilityChangeListener=function(){document.addEventListener("visibilitychange",this.visibilityChangeHandler)},t.prototype.removeVisibilityChangeListener=function(){document.removeEventListener("visibilitychange",this.visibilityChangeHandler)},t}();var mn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gn=function(){}(j),Sn=function(){}(),En=function(){function t(t,e,r,n,i,o,s,a){this.configuration=t,this.visitorService=e,this.sessionService=r,this.eventPathComputation=n,this.selector=i,this.commandsService=o,this.sessionRenewer=s,this.iframeEventsEmitter=a}return t.prototype.init=function(){!function(){}();var t=new yn;this.analysisEventsRecovery=this.createRecovery(),this.analysisEventsService=this.createService(t,this.analysisEventsRecovery.getRecoveryStorage()),this.analysisEventsService.init(),this.iframeEventsEmitter.addListeners(this.analysisEventsService)},t.prototype.onStartTracking=function(){this.analysisEventsRecovery.start(),this.analysisEventsService.start()},t.prototype.onAfterNaturalPageView=function(){this.analysisEventsService.initStates()},t.prototype.onAfterArtificialPageView=function(){this.analysisEventsService.initStates()},t.prototype.onBeforeArtificialPageView=function(){this.analysisEventsService.clearStates()},t.prototype.onBeforeSessionRenewal=function(){this.analysisEventsService.clearStates(),this.analysisEventsService.stop(),this.analysisEventsRecovery.stop()},t.prototype.onOptout=function(){this.analysisEventsService.stop(),this.analysisEventsRecovery.stop()},t.prototype.createService=function(t,e){var r=new qr(window),i=new cn,o=new sn(this.configuration,this.eventPathComputation,this.selector),s=new Fr(this.configuration,this.eventPathComputation,new Xr(dt)),a=new B(this.configuration.getTrackerUri(),"events"),c=new gn(this.configuration.getTrackerUri(),"events"),u=new ke(this.configuration,this.visitorService,this.sessionService,i,r,n);return new pn(this.configuration,o,s,i,r,t,a,c,u,this.sessionRenewer,e)},t.prototype.createRecovery=function(){var t=new B(this.configuration.getTrackerUri(),"events");return new vn(t,new Sn("csAnalysisEventsPersisted"))},t}(),wn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cn=function(t){function e(e,r,n){var i=t.call(this)||this;return i.lifeCycleEventsEmitter=e,i.pageViewRequest=r,i.urlService=n,i}return wn(e,t),e.prototype.onStart=function(){this.sendNaturalPageView()},e.prototype.onStop=function(){},e.prototype.triggerArtificialPageView=function(t){this.urlService.overridePath(t),this.isStarted&&this.sendArtificialPageView()},e.prototype.sendNaturalPageView=function(){this.lifeCycleEventsEmitter.emitBeforeNaturalPageView(),this.pageViewRequest.send(),this.lifeCycleEventsEmitter.emitAfterNaturalPageView()},e.prototype.sendArtificialPageView=function(){this.lifeCycleEventsEmitter.emitBeforeArtificialPageView(),this.pageViewRequest.send(),this.lifeCycleEventsEmitter.emitAfterArtificialPageView()},e}(ne),Rn=window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.systemLanguage||"unknown";function bn(){return{la:Rn}}var Tn,An=function(){}(),kn=["trackPageview"],Pn=["setPath"],On=["setQuery"],_n=function(){function t(t,e,r,n,i,o,s,a,c){this.configuration=t,this.commandsService=e,this.lifeCycleEventsEmitter=r,this.visitorService=n,this.sessionService=i,this.consentService=o,this.customVariablesService=s,this.pii=a,this.urlService=c}return t.prototype.init=function(){var t=this,e=new B(this.configuration.getTrackerUri(),"pageview");this.pageViewService=new Cn(this.lifeCycleEventsEmitter,e,this.urlService),e.setRequestParametersProviders(this.configuration,this.visitorService,this.sessionService,Se,new An(this.pii),this.urlService,this.consentService,i,this.customVariablesService,n),this.commandsService.register(kn,(function(e){return t.pageViewService.triggerArtificialPageView(e)})),this.commandsService.register(Pn,(function(e){return t.urlService.overridePath(e)})),this.commandsService.register(On,(function(e){return t.urlService.overrideQuery(e)}))},t.prototype.start=function(){this.pageViewService.start()},t.prototype.onBeforeSessionRenewal=function(){this.pageViewService.stop()},t}(),In=function(){function t(t,e){this.pathComputation=t,this.configuration=e}return t.prototype.getTargetPath=function(t){var e=zr(t);return this.pathComputation.getElementPath(e,{dynamicIdRegex:this.configuration.dynamicIdRegex})},t.prototype.getTargetPathAndTargetLink=function(t){var e=zr(t),r=this.pathComputation.getElementPathAndFirstAnchorParent(e,{dynamicIdRegex:this.configuration.dynamicIdRegex}),n=r.path,i=r.firstAnchorParent;return{path:n,targetLink:this.hasValidTargetLink(i)?i.href:""}},t.prototype.hasValidTarget=function(t){var e=zr(t);return this.pathComputation.isValidElement(e)},t.prototype.hasValidTargetLink=function(){},t}(),Nn=function(){function t(t){this.pathComputation=t}return t.prototype.on=function(){},t.prototype.targetMatchesSelector=function(t,e){var r=zr(t);return ge().call(r,e)},t.prototype.isMatchesSelectorSupported=function(){return!!ge()},t}(),Mn=["visit",2],Dn=["page",3],Ln=function(){function t(t,e,r){this.pii=t,this.cookieService=e,this.crossDomainSingleIframeService=r,this.customVariablesPage={}}return t.prototype.set=function(t,e,r,n){var i,o;if(t>0&&wt(e)&&wt(r)){var s=this.pii.anonymize(""+(gt(e)?e:csString(e))),a=this.pii.anonymize(""+(gt(r)?r:csString(r)));if(i=[s.slice(0,20),a.slice(0,255)],o=""!==r,!Et(n)||csArray.prototype.indexOf.call(Mn,n)>=0){var c=this.getCustomVariablesSession();o?c[t]=i:delete c[t],At.setRaw(window.JSON.stringify(c),this.cookieService,this.crossDomainSingleIframeService)}(!Et(n)||csArray.prototype.indexOf.call(Dn,n)>=0)&&(o?this.customVariablesPage[t]=i:delete this.customVariablesPage[t])}},t.prototype.getRequestParameters=function(){},t.prototype.getCustomVariablesSession=function(){var t=At.get(this.cookieService);return null!==t&&St(t)?t:{}},t.prototype.getValidCustomVars=function(){},t}(),xn=["setCustomVariable"],qn=function(){function t(t,e,r,n){this.commandsService=t,this.customVariablesService=e,this.crossDomainSingleIframeService=r,this.cookieService=n}return t.prototype.init=function(){},t.prototype.onOptout=function(){At.remove(this.cookieService,this.crossDomainSingleIframeService)},t}(),Un=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Vn=function(){}(),jn=["clearSession"],zn=["extendSession"],Bn=function(){function t(t,e,r,n){this.cookieDomain=t,this.visitorService=e,this.sessionService=r,this.commandsService=n}return t.prototype.init=function(){var t=this;this.commandsService.register(jn,(function(){return t.sessionService.removeSession(t.cookieDomain)})),this.commandsService.register(zn,(function(){return t.sessionService.extendSessionPeriodically()}))},t.prototype.onBeforeNaturalPageView=function(){this.visitorService.createOrUpdateVisitor(),this.sessionService.createOrUpdateSession()},t.prototype.onBeforeArtificialPageView=function(){this.visitorService.createOrUpdateVisitor(),this.sessionService.createOrUpdateSession()},t.prototype.onOptout=function(){this.visitorService.removeCurrentVisitor(),this.sessionService.removeCurrentSession()},t.prototype.onRecordingStateChange=function(t){this.sessionService.updateRecordingState(t)},t}(),Hn=function(){}(),Fn=function(){function t(t,e,r){this.eMerchandisingRequest=t,this.urlService=e,this.eMerchandisingTracker=r,this.requestPayload={targetUrl:"",windowWidth:0,windowHeight:0,products:[]}}return t.prototype.init=function(){},t.prototype.collect=function(){this.requestPayload={targetUrl:this.urlService.getUrl(),windowWidth:Se.windowWidth(),windowHeight:Se.windowHeight(),products:this.eMerchandisingTracker.collectProducts()},this.sendEMerchandisingData()},t.prototype.onIframeEmerchandisingMessage=function(t){this.requestPayload=t,this.sendEMerchandisingData()},t.prototype.sendEMerchandisingData=function(){this.eMerchandisingRequest.send()},t}(),Gn=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};(Tn||(Tn={})).findNestedShadowHosts=function t(e){for(var r,n=[],i=0,o=function(t){var e=S(t.querySelectorAll("*"));return csArray.prototype.filter.call(e,(function(t){return t.shadowRoot}))}(e);i<o.length;i++){var s=o[i];(r=csArray.prototype.push).call.apply(r,Gn([n,s],t(s.shadowRoot)))}return n};var Wn,Xn=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};(Wn||(Wn={})).findAllElements=function(){};var Jn=function(){function t(t){this.configuration=t}return t.prototype.collectProducts=function(){for(var t=[],e=0,r=this.getAllValidAnchors(this.configuration.hostnames);e<r.length;e++){var n=r[e],i=b.getElementPath(n,{dynamicIdRegex:this.configuration.dynamicIdRegex});csArray.prototype.push.call(t,{targetPath:i,href:n.href})}return t},t.prototype.getAllValidAnchors=function(t){var e=this;return csArray.prototype.filter.call(Wn.findAllElements("a"),(function(r){return e.isAnchorValid(r,t)}))},t.prototype.isAnchorValid=function(){},t}(),Yn=function(){function t(t,e,r,n,i,o){this.configuration=t,this.compressor=e,this.basicRequestParameters=r,this.customVariablesService=n,this.urlService=i,this.iframeEventsEmitter=o}return t.prototype.init=function(){var t=this.createEMerchandisingPostRequest(this.compressor),e=new Jn(this.configuration);this.eMerchandisingService=new Fn(t,this.urlService,e),this.eMerchandisingService.init(),this.iframeEventsEmitter.addListeners(this.eMerchandisingService)},t.prototype.onStartTracking=function(){this.eMerchandisingService.collect()},t.prototype.onAfterArtificialPageView=function(){this.eMerchandisingService.collect()},t.prototype.createEMerchandisingPostRequest=function(t){var e=new Ft(this.configuration.getTrackerUri(),"display");return e.setCompressionOptions(t,"base64"),e.setRequestParametersProviders(this.basicRequestParameters,this.customVariablesService),e.setRequestHeader({name:"Access-Control-Expose-Headers",value:"Content-compression"}),e.setRequestHeader({name:"Content-type",value:"text/plain; charset=UTF-8"}),e.setRequestHeader({name:"Content-compression",value:"LZString"}),e},t}(),Kn=r(0);function Qn(t){return t.tagDeploymentMode===Kn.TagDeploymentMode.DualCollectionReview||t.tagDeploymentMode===Kn.TagDeploymentMode.DualCollection}var Zn,$n=function(){function t(t,e,r,n){this.configuration=t,this.visitorService=e,this.sessionService=r,this.piiMaskingService=n}return t.prototype.init=function(){this.isClicktalePtcLoaded=!1,this.isContentSquareDataCollectionStarted=!1},t.prototype.loadClicktalePtc=function(){},t.prototype.getSessionData=function(){},t.prototype.startDataCollection=function(t){this.isContentSquareDataCollectionStarted||Qn(this.configuration)&&(this.piiMaskingService.initCTPII(),t(),this.isContentSquareDataCollectionStarted=!0)},t.prototype.doLoadClicktalePtc=function(){},t.prototype.buildScriptElement=function(){},t}();!function(){}(Zn||(Zn={}));var ti,ei=function(){function t(t,e,r,n,i,o,s){this.configuration=t,this.visitorService=e,this.sessionService=r,this.urlService=n,this.commandsService=i,this.startDataCollectionCallback=o,this.piiMaskingService=s}return t.prototype.init=function(){},t.prototype.loadPtcForDualCollection=function(){Qn(this.configuration)&&this.clicktaleIntegrationService.loadClicktalePtc()},t.prototype.onAfterNaturalPageView=function(){this.configuration.tagDeploymentMode!==Kn.TagDeploymentMode.LoadClicktalePtc||this.sessionService.isReplayRecorded()||this.clicktaleIntegrationService.loadClicktalePtc()},t.prototype.onAfterArtificialPageView=function(){!this.sessionService.isReplayRecorded()&&Zn.isRecording()&&this.configuration.tagDeploymentMode===Kn.TagDeploymentMode.LoadClicktalePtc&&Zn.triggerLogicalPageView(this.urlService.getUrl())},t.prototype.onAfterSessionRenewal=function(){},t.prototype.onOptout=function(){Zn.isRecording()&&Zn.stopRecording()},t}(),ri=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ni=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.configuration=e,o.pageEventRequest=r,o.compressor=n,o.customEventsEmitter=i,o.pageEventsQueue=[],o.etrQueue=[],o}return ri(e,t),e.prototype.onStart=function(){},e.prototype.onStop=function(){},e.prototype.trackPageEvent=function(t){this.isStarted?e.isValidEventName(t)&&(this.customEventsEmitter.emitPageEvent(t),this.pageEventRequestParameter={eventName:t,isETR:!1},this.sendPageEvent(),this.configuration.tagDeploymentMode===Kn.TagDeploymentMode.LoadClicktalePtc&&Zn.sendPageEvent(t)):csArray.prototype.push.call(this.pageEventsQueue,t)},e.prototype.trackEventTriggerRecording=function(t){var r;this.isStarted?e.isValidEventName(t)&&(Qn(r=this.configuration)||r.tagDeploymentMode===Kn.TagDeploymentMode.LoadClicktalePtc)&&(this.customEventsEmitter.emitEventTriggerRecording(t),this.pageEventRequestParameter={eventName:t,isETR:!0},this.sendPageEvent(),this.configuration.tagDeploymentMode===Kn.TagDeploymentMode.LoadClicktalePtc&&Zn.sendEventTriggerRecording(t)):csArray.prototype.push.call(this.etrQueue,t)},e.prototype.getRequestParameters=function(){return{value:this.compressor.compressSync(this.pageEventRequestParameter.eventName),isETR:""+!!this.pageEventRequestParameter.isETR}},e.prototype.sendPageEvent=function(){this.pageEventRequest.send()},e.isValidEventName=function(){},e}(ne),ii=["trackPageEvent"],oi=["trackEventTriggerRecording"],si=function(){function t(t,e,r,n,i){this.configuration=t,this.commandsService=e,this.compressor=r,this.basicParameters=n,this.customEventsEmitter=i}return t.prototype.init=function(){var t=this,e=new B(this.configuration.getTrackerUri(),"pageEvent");this.pageEventService=new ni(this.configuration,e,this.compressor,this.customEventsEmitter),e.setRequestParametersProviders(this.pageEventService,this.basicParameters),this.commandsService.register(ii,(function(e){t.pageEventService.trackPageEvent(e)})),this.commandsService.register(oi,(function(e){t.pageEventService.trackEventTriggerRecording(e)}))},t.prototype.onStartTracking=function(){this.pageEventService.start()},t}(),ai=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},ci=ge(),ui=[".ctHidden, textarea"],pi=function(){function t(t){this.configuration=t,this.piiMaskSelectors={PIISelectors:[],Attributes:[]},Qn(this.configuration)||csArray.prototype.push.call(this.piiMaskSelectors.PIISelectors,"[data-cs-mask]")}return t.prototype.setPIISelectors=function(t){var e;!Qn(this.configuration)&&t&&((null===(e=t.PIISelectors)||void 0===e?void 0:e.length)&&(this.piiMaskSelectors.PIISelectors=ai(this.piiMaskSelectors.PIISelectors,t.PIISelectors)),this.piiMaskSelectors.Attributes=t.Attributes instanceof Array?ai(t.Attributes):[])},t.prototype.initCTPII=function(){var t,e,r=this;(null===(e=null===(t=null===window||void 0===window?void 0:window.ClickTaleSettings)||void 0===t?void 0:t.DOM)||void 0===e?void 0:e.PII)&&(this.piiMaskSelectors.PIISelectors=ai(ui,window.ClickTaleSettings.DOM.PII.Text),csArray.prototype.map.call(window.ClickTaleSettings.DOM.PII.Attributes,(function(t){csArray.prototype.push.call(r.piiMaskSelectors.Attributes,{selector:t.rule,attrName:t.attr})})))},t.prototype.isElementMatchingSelectors=function(t,e){return csArray.prototype.some.call(e,(function(e){return ci.call(t,e)}))},t.prototype.isElementMatchingAttributes=function(){},t.prototype.checkAttributeMatch=function(t,e){return 0!==this.piiMaskSelectors.Attributes.length&&this.isElementMatchingAttributes(t,e,this.piiMaskSelectors.Attributes)},t.prototype.checkNodeMatch=function(t){return this.isElementMatchingSelectors(t,this.piiMaskSelectors.PIISelectors)},t}(),li=function(){function t(t){this.commandsService=t}return t.prototype.init=function(){this.commandsService.register(["logSnippetError"],(function(t,e){gt(t)&&gt(e)&&dt.error(e,"snippet-"+t)}))},t}(),hi=function(){}(),fi=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),di=function(t){function(){}return fi(e,t),e.prototype.onChildMessage=function(t){this.onChildMessageCallback=t},e.prototype.onStart=function(){Gt(this.messageHandler,!1),this.discoverValidIframes()},e.prototype.onStop=function(){},e.prototype.discoverValidIframes=function(){this.iframes=this.getAllValidIframes(),this.sendDiscoveryMessages()},e.prototype.getAllValidIframes=function(){},e.prototype.isIframeValid=function(){},e.prototype.sendDiscoveryMessages=function(){},e.prototype.sendStopMessages=function(){var t=this;csArray.prototype.forEach.call(this.iframes,(function(e){e.contentWindow&&ot.sendMessage(e.contentWindow,"*",t.buildStopMessage())}))},e.prototype.buildDiscoveryMessage=function(){},e.prototype.buildStopMessage=function(){},e.prototype.messagesListener=function(){},e}(ne),yi=function(){function(){}return t.prototype.start=function(){var t=this;if(this.optoutModule.init(),this.optoutService.init(),!this.optoutService.isActive()){var e=new Hn(this.sessionService),r=new In(b,this.configuration),n=new Nn(r),i=new En(this.configuration,this.visitorService,this.sessionService,r,n,this.commandsService,e,this.iframeEventsEmitter),o=new Ar(this.commandsService,this.sessionService,this.configuration,this.basicRequestParameters,this.compressor,this.pii),s=new dr(this.visitorService,this.sessionService,this.commandsService),a=new xr(this.configuration,this.visitorService,this.sessionService,this.commandsService,this.pii,e,this.urlService),c=new Ln(this.pii,this.cookieService,this.crossDomainSingleIframeService),u=new qn(this.commandsService,c,this.crossDomainSingleIframeService,this.cookieService);this.pageViewModule=new _n(this.configuration,this.commandsService,this.lifeCycleEventsEmitter,this.visitorService,this.sessionService,this.consentService,c,this.pii,this.urlService);var p=new Bn(this.cookieService.getDomain(),this.visitorService,this.sessionService,this.commandsService),l=new pi(this.configuration),h=new ei(this.configuration,this.visitorService,this.sessionService,this.urlService,this.commandsService,this.startDataCollection,l),f=new si(this.configuration,this.commandsService,this.compressor,this.basicRequestParameters,this.customEventsEmitter),d=new li(this.commandsService),y=new di(this.configuration),v=new hi(this.configuration,y,this.iframeEventsEmitter);if(v.init(),this.loadTracker=new Vn,this.consentModule.init(),s.init(),o.init(),a.init(),u.init(),this.pageViewModule.init(),p.init(),h.init(),f.init(),this.projectConfigurationModule.init(),d.init(),this.lifeCycleEventsEmitter.addListeners(p,this.commandsModule,i,this.consentModule,s,u,this.pageViewModule,h,f,o,v),pr.isSupported()&&this.compressor.isSupported()){var m=new pr(this.sessionService,this.configuration,this.compressor,n,this.consentService,this.basicRequestParameters,this.commandsService,this.pii,e,this.urlService,l,this.javaScriptErrorsTracker,this.javaScriptErrorsAnonymizer,this.apiErrorsTracker,this.apiErrorsAnonymizer,this.debugService);m.init(),this.lifeCycleEventsEmitter.addListeners(m),this.customEventsEmitter.addListeners(m)}if(this.configuration.eMerchandisingEnabled){var g=new Yn(this.configuration,this.compressor,this.basicRequestParameters,c,this.urlService,this.iframeEventsEmitter);g.init(),this.lifeCycleEventsEmitter.addListeners(g)}i.init(),e.onSessionExpired((function(){t.lifeCycleEventsEmitter.emitBeforeSessionRenewal(),t.doStart(!0),t.lifeCycleEventsEmitter.emitAfterSessionRenewal()})),this.doStart()}},t.prototype.doStart=function(t){var e=this;void 0===t&&(t=!1),this.commandsService.start(),this.loadTracker.onLoad((function(){e.lifeCycleEventsEmitter.emitStartTracking()})),Qn(this.configuration)&&!t||this.startDataCollection()},t}(),vi=function(){function t(t,e,r,n,i,o,s,a){this.configuration=t,this.visitorService=e,this.exclusionService=r,this.outdatedState=n,this.allowSubdomainsChange=i,this.crossDomainService=o,this.crossDomainSingleIframeService=s,this.forceInclusionService=a}return t.prototype.compute=function(t){var e=this;this.configuration.crossDomainTracking?this.configuration.crossDomainSingleIframeTracking?this.crossDomainSingleIframeService.start((function(){return e.computeState(t)})):this.crossDomainService.applyUpToDate((function(){return e.computeState(t)})):this.computeState(t)},t.prototype.computeState=function(){},t.prototype.isIncluded=function(){var t=I(this.configuration.sampleRate);return this.forceInclusionService.isForceIncluded()||!this.exclusionService.isExcluded()&&this.visitorService.doesVisitorExist()||!this.exclusionService.isExcluded()&&t},t}();!function(){}(ti||(ti={}));var mi,gi=function(){function t(t,e,r,n){this.configuration=t,this.sessionService=e,this.cookieService=r,this.crossDomainSingleIframeService=n}return t.prototype.createOrUpdateVisitor=function(){var t=this.getVisitor();null===t?(t=this.createVisitor(),this.sessionService.removeCurrentSession()):t=this.manageSameSiteForVisitor(t),this.updateVisitor(t),this.setVisitor(t)},t.prototype.createVisitor=function(){return{id:ti.generate(),visitsCount:0,appliedTrackingDraw:this.configuration.lastTrackingDraw,creationTimestamp:k(),lastVisitTimestamp:0,hitTimestamp:0,expires:L.now()+this.configuration.visitorCookieTimeout,sameSite:this.cookieService.getSameSiteFlag(),secured:this.cookieService.getSecureFlag()}},t.prototype.updateVisitor=function(){},t.prototype.getRequestParameters=function(){},t.prototype.getVisitor=function(){return Ot.get(this.cookieService)},t.prototype.setVisitor=function(t){this.setCookieFlagsFromCookieService(t),Ot.set(t,this.cookieService,this.crossDomainSingleIframeService)},t.prototype.doesVisitorExist=function(){return null!==Ot.get(this.cookieService)},t.prototype.removeCurrentVisitor=function(){this.removeVisitor(this.cookieService.getDomain())},t.prototype.removeVisitor=function(t){var e=t||this.cookieService.getDomain();Ot.remove(e,this.cookieService,this.crossDomainSingleIframeService)},t.prototype.visitorHasSameSiteDefined=function(t){return Et(t.sameSite)&&Et(t.secured)},t.prototype.setCookieFlagsFromCookieService=function(t){return t.sameSite=this.cookieService.getSameSiteFlag(),t.secured=this.cookieService.getSecureFlag(),t},t.prototype.manageSameSiteForVisitor=function(t){if(this.configuration.crossDomainTracking&&!this.visitorHasSameSiteDefined(t)){var e=this.createVisitor();return this.sessionService.removeCurrentSession(),e}return t},t}(),Si=function(){}(),Ei=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wi=function(t){function e(e,r,n,i){var o=t.call(this,e,r)||this;return o.configuration=e,o.compressor=r,o.forceInclusionService=n,o.urlService=i,o}return Ei(e,t),e.prototype.sanitizeSessionRecordingState=function(t){return t},e.prototype.computeRecordingState=function(){return this.isCompressionSupported()&&(this.forceInclusionService.isForceLegacyReplayRecorded()||N()<this.configuration.replayRecordingRate&&pr.isSupported())?Xt.REPLAY_RECORDING_ENABLED:Xt.REPLAY_RECORDING_DISABLED},e.prototype.isReplayRecorded=function(){},e.prototype.computeTriggerSessionReplayStatus=function(){},e.prototype.getDisabledRecordingState=function(){return Xt.REPLAY_RECORDING_DISABLED},e.prototype.setVisitorService=function(t){},e}(Si),Ci=function(){function t(t,e,r){this.sessionStorage=t,this.cookieService=e,this.recordingStateStrategy=r,this.triggerSessionReplayOngoing=!1,this.extendedSessionTimeoutId=null,this.sessionExtensionCount=0}return t.prototype.setDynamicVariablesService=function(t){this.dynamicVariablesService=t},t.prototype.createOrUpdateSession=function(){this.stopSessionExtension(),this.beginSession=L.now(),this.sessionExtensionCount=0;var t=this.getSessionWithoutCache();null===t?(t=this.buildSessionObject(),this.incrementSessionPageNumber(t),t.recordingState=this.recordingStateStrategy.computeRecordingState(t)):(t=this.recordingStateStrategy.sanitizeSessionRecordingState(t),this.incrementSessionPageNumber(t)),this.setSession(t),this.setTriggerSessionReplayStatus(t)},t.prototype.buildSessionObject=function(){return{pageNumber:0,recordingState:this.recordingStateStrategy.getDisabledRecordingState()}},t.prototype.setTriggerSessionReplayStatus=function(){},t.prototype.createExtendedSession=function(){},t.prototype.incrementSessionPageNumber=function(t){t.pageNumber+=1},t.prototype.isReplayRecorded=function(){},t.prototype.removeCurrentSession=function(){this.removeSession(this.cookieService.getDomain())},t.prototype.getRequestParameters=function(){},t.prototype.getSession=function(){return this.sessionStorage.get()},t.prototype.getSessionWithoutCache=function(){return this.sessionStorage.get(!0)},t.prototype.doesSessionExist=function(){return null!==this.sessionStorage.get()},t.prototype.setSession=function(t,e){void 0===e&&(e=18e5),this.sessionStorage.set(t,e)},t.prototype.removeSession=function(t){this.sessionStorage.remove(t)},t.prototype.getRecordingState=function(){var t=this.getSession();return null!==t?t.recordingState:null},t.prototype.updateRecordingState=function(t){var e=this.getSession();null!==e&&(e.recordingState=t,this.setSession(e))},t.prototype.hasValidSession=function(){var t=this.sessionStorage.getRawSession();return this.sessionStorage.isValid(t)},t.prototype.extendSessionPeriodically=function(){this.extendedSessionTimeoutId||this.extendSession()},t.prototype.extendSession=function(){if(this.hasReachedMaxDuration())this.stopSessionExtension();else{var t=this.getSession();null===t&&(t=this.createExtendedSession()),this.setSession(t,174e4),this.sendDynamicVar(),this.scheduleNextSessionUpdate()}},t.prototype.scheduleNextSessionUpdate=function(){var t=this;this.extendedSessionTimeoutId=window.setTimeout((function(){t.extendSession()}),174e4)},t.prototype.hasReachedMaxDuration=function(){},t.prototype.stopSessionExtension=function(){this.extendedSessionTimeoutId&&(window.clearTimeout(this.extendedSessionTimeoutId),this.extendedSessionTimeoutId=null)},t.prototype.sendDynamicVar=function(){},t}(),Ri=function(){}(),bi=function(){function t(t,e,r,n){this.configuration=t,this.cookieService=e,this.visitorService=r,this.sessionService=n}return t.prototype.handle=function(){this.handleVisitor(),this.handleSession()},t.prototype.handleVisitor=function(){var t=this.visitorService.getVisitor();t&&(this.configuration.allowSubdomains?this.visitorService.removeVisitor(bt.CURRENT_DOMAIN):this.visitorService.removeVisitor(this.cookieService.getRootDomain()),this.visitorService.setVisitor(t))},t.prototype.handleSession=function(){var t=this.sessionService.getSessionWithoutCache();t&&(this.configuration.allowSubdomains?this.sessionService.removeSession(bt.CURRENT_DOMAIN):this.sessionService.removeSession(this.cookieService.getRootDomain()),this.sessionService.setSession(t))},t}(),Ti=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},Ai=function(){}(),ki=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ki(e,t),e.prototype.emitBeforeNaturalPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onBeforeNaturalPageView&&r.onBeforeNaturalPageView()}},e.prototype.emitAfterNaturalPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onAfterNaturalPageView&&r.onAfterNaturalPageView()}},e.prototype.emitInitTracking=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onInitTracking&&r.onInitTracking()}},e.prototype.emitStartTracking=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onStartTracking&&r.onStartTracking()}},e.prototype.emitBeforeArtificialPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onBeforeArtificialPageView&&r.onBeforeArtificialPageView()}},e.prototype.emitAfterArtificialPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onAfterArtificialPageView&&r.onAfterArtificialPageView()}},e.prototype.emitBeforeSessionRenewal=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onBeforeSessionRenewal&&r.onBeforeSessionRenewal()}},e.prototype.emitAfterSessionRenewal=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onAfterSessionRenewal&&r.onAfterSessionRenewal()}},e.prototype.emitOptout=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onOptout&&r.onOptout()}},e.prototype.emitConsentGranted=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onConsentGranted&&r.onConsentGranted()}},e.prototype.emitConsentWithdrawn=function(){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r.onConsentWithdrawn&&r.onConsentWithdrawn()}},e.prototype.emitRecordingStateChange=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onRecordingStateChange&&n.onRecordingStateChange(t)}},e}(Ai);!function(t){t[t.NOT_REQUIRED=0]="NOT_REQUIRED",t[t.NOT_EXPRESSED=1]="NOT_EXPRESSED",t[t.GRANTED=2]="GRANTED",t[t.WITHDRAWN=3]="WITHDRAWN"}(mi||(mi={}));var Oi,_i=function(){function t(t){this.cookieService=t}return t.prototype.get=function(){var t=this.cookieService.get("_cs_c");return null===t?t:Number(t)},t.prototype.set=function(t){this.cookieService.set("_cs_c",csString(t),34164e6)},t.prototype.remove=function(t){this.cookieService.delete("_cs_c",t)},t}(),Ii=["trackConsentGranted"],Ni=["trackConsentWithdrawn"],Mi=function(){}(),Di=function(){function t(t,e,r,n){this.configuration=t,this.storage=e,this.lifeCycleEventsEmitter=r,this.cookieService=n}return t.prototype.setInitialConsent=function(){},t.prototype.hasConsentRequiredChanged=function(){},t.prototype.handleSubdomainChange=function(){this.configuration.allowSubdomains?this.storage.remove(bt.CURRENT_DOMAIN):this.storage.remove(this.cookieService.getRootDomain())},t.prototype.setDefault=function(){},t.prototype.grantConsent=function(){this.configuration.consentRequired&&(this.storage.set(mi.GRANTED),this.lifeCycleEventsEmitter.emitConsentGranted())},t.prototype.withdrawConsent=function(){},t.prototype.removeCurrentConsent=function(){var t=this.cookieService.getDomain();this.storage.remove(t)},t.prototype.isAllowedByConsent=function(){},t.prototype.getRequestParameters=function(){},t}(),Li=function(){}(),xi=function(){function t(t){this.service=t}return t.prototype.onOptout=function(){this.service.removeExclusion()},t}(),qi=function(){}(),Ui=function(){return(Ui=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Vi=function(){}(),ji=function(){}(),zi=function(){function t(t,e){this.configuration=t,this.request=e,this.isLoggingActive=!1}return t.prototype.init=function(){this.isLoggingActive=I(this.configuration.metricRate)},t.prototype.getRequestParameters=function(){},t.prototype.logMetric=function(){},t.prototype.sendLog=function(){this.isLoggingActive&&this.request.send()},t}();!function(t){t.TIME_BEFORE_EXECUTION="TimeBeforeExecution",t.PAGE_LOAD="PageLoad"}(Oi||(Oi={}));var Bi,Hi=function(){}(),Fi=function(){function t(t,e,r){this.lifeCycleEventsEmitter=t,this.location=e,this.cookieService=r}return t.prototype.init=function(){},t.prototype.isActive=function(){return"1"===this.cookieService.get("_cs_optout")},t.prototype.activate=function(){this.lifeCycleEventsEmitter.emitOptout(),this.cookieService.set("_cs_optout","1",34164e6)},t.prototype.hasOptoutInURL=function(){},t}(),Gi=["optout"],Wi=function(){}();function(){}!function(){}(Bi||(Bi={}));var Ji=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},Yi=function(){}(),Ki=function(){}();var Qi,Zi=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$i=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},to=function(){}(ne),eo=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},ro=function(){function(){}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){Gt(this.eventHandler)},t.prototype.stop=function(){Wt(this.eventHandler)},t.prototype.securityErrorIsRelevant=function(e){return e&&e.sourceFile&&0!==e.sourceFile.length&&csArray.prototype.some.call(t.whilelistDomains,(function(){}))},t.prototype.securityPolicyViolationListener=function(){},t.whilelistDomains=["contentsquare","localhost","website.com/build/e2e"],eo([yt("Event handler type: securitypolicyviolation")],t.prototype,"securityPolicyViolationListener",null),t}(),no=function(){}(),io=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),oo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.javaScriptErrorsTracker=e,o.javaScriptErrorsRequest=r,o.basicRequestParameters=n,o.javaScriptErrorsAnonymizer=i,o.javaScriptErrorsBatch=[],o.javaScriptErrorsCount=0,o}return io(e,t),e.prototype.init=function(){var t=this;this.javaScriptErrorsTracker.onEvent((function(e){return t.processEvent(e)})),this.bindRequest()},e.prototype.initStates=function(){},e.prototype.onStart=function(){this.javaScriptErrorsTracker.start()},e.prototype.onStop=function(){this.javaScriptErrorsTracker.stop()},e.prototype.getRequestPayload=function(){return csJSON.stringify({errors:this.javaScriptErrorsBatch})},e.prototype.onIframeJavascriptError=function(t){this.processEvent(t)},e.prototype.processEvent=function(){},e.prototype.bindRequest=function(){},e.prototype.getRelativeTime=function(){return L.now()-this.startTime},e.prototype.sendErrors=function(){this.javaScriptErrorsRequest.send()},e}(ne),so=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ao=function(t){function(){}return so(e,t),e.prototype.init=function(){var t=this;this.apiErrorsTracker.init(),this.apiErrorsTracker.onEvent((function(e){return t.processEvent(e)})),this.bindRequest()},e.prototype.initStates=function(){this.apiErrorsBatch=[],this.apiErrorsCount=0},e.prototype.onStart=function(){this.apiErrorsTracker.start()},e.prototype.onStop=function(){this.apiErrorsTracker.stop()},e.prototype.getRequestPayload=function(){return csJSON.stringify({errors:this.apiErrorsBatch})},e.prototype.onIframeApiError=function(t){this.processEvent(t)},e.prototype.processEvent=function(t){this.isStarted&&this.apiErrorsCount<e.MAX_ERRORS&&(csArray.prototype.push.call(this.apiErrorsBatch,this.apiErrorsAnonymizer.anonymize(t)),this.sendErrors())},e.prototype.bindRequest=function(){var t=this;this.apiErrorsRequest.setRequestParametersProviders(this.basicRequestParameters),this.apiErrorsRequest.setRequestPayloadProvider(this),this.apiErrorsRequest.after((function(){t.apiErrorsBatch=[],t.apiErrorsCount+=1}))},e.prototype.sendErrors=function(){this.apiErrorsRequest.send()},e.MAX_ERRORS=20,e}(ne);!function(t){t.CONTENTSQUARE="contentsquare.net",t.CLICKTALE="clicktale.net",t.FAKE_TRACKER="fake-tracker.content-square.fr"}(Qi||(Qi={}));var co,uo=["api-errors:maskUrl"],po=function(){function t(t,e,r,n,i,o,s,a){this.javaScriptErrorsTracker=t,this.javaScriptErrorsAnonymizer=e,this.apiErrorsTracker=r,this.apiErrorsAnonymizer=n,this.configuration=i,this.basicRequestParameters=o,this.iframeEventsEmitter=s,this.commandsService=a}return t.prototype.init=function(){this.contentSecurityPolicyErrorsService=new no(new ro),this.contentSecurityPolicyErrorsService.init();var t=new Ft(this.configuration.getTrackerUri(),"errors");this.javaScriptErrorsService=new oo(this.javaScriptErrorsTracker,t,this.basicRequestParameters,this.javaScriptErrorsAnonymizer),this.javaScriptErrorsService.init(),this.iframeEventsEmitter.addListeners(this.javaScriptErrorsService);var e=new Ft(this.configuration.getTrackerUri(),"api-errors");this.apiErrorsTracker.excludeDomains([Qi.CONTENTSQUARE,Qi.CLICKTALE,Qi.FAKE_TRACKER]),this.apiErrorsService=new ao(this.apiErrorsTracker,e,this.basicRequestParameters,this.apiErrorsAnonymizer),this.apiErrorsService.init(),this.iframeEventsEmitter.addListeners(this.apiErrorsService),this.registerCommands()},t.prototype.registerCommands=function(){var t=this;this.commandsService.register(uo,(function(e){return t.apiErrorsAnonymizer.addUrlMaskingPattern(e)}))},t.prototype.onInitTracking=function(){this.contentSecurityPolicyErrorsService.start()},t.prototype.onStartTracking=function(){this.configuration.jsErrorsEnabled&&this.javaScriptErrorsService.start(),this.configuration.apiErrorsEnabled&&this.apiErrorsService.start()},t.prototype.onAfterNaturalPageView=function(){this.javaScriptErrorsService.initStates(),this.apiErrorsService.initStates()},t.prototype.onAfterArtificialPageView=function(){this.javaScriptErrorsService.initStates(),this.apiErrorsService.initStates()},t.prototype.onBeforeSessionRenewal=function(){this.javaScriptErrorsService.stop(),this.apiErrorsService.stop()},t.prototype.onOptout=function(){this.contentSecurityPolicyErrorsService.stop(),this.javaScriptErrorsService.stop(),this.apiErrorsService.stop()},t}(),lo=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};!function(t){t.Set="set",t.Remove="remove"}(co||(co={}));var ho=function(){}(),fo=["_cs_id","_cs_s","_cs_cvars","_cs_ex"],yo=function(){function t(t,e){this.configuration=t,this.xdframeOpener=e}return t.prototype.init=function(){},t.prototype.openIframe=function(){},t.prototype.handleXdframeMessage=function(t){if(this.isXdframeMessage(t)){var e=t.data,r=!0;if(this.isXdframeErrorMessage(t))return void dt.warn("Error xdframe single domain: "+csJSON.stringify(t.data)+" from "+t.origin);if(!Lt.isRawDomainState(e))return void dt.warn("Unknown message format from xdframe single domain: "+csJSON.stringify(t.data)+" from "+t.origin);Lt.isValid(e)||(dt.warn("Invalid xdframe single domain state: "+csJSON.stringify(t.data)+" from "+t.origin),r=!1),this.xdframeOpener.stop(),this.callback(Nt.fromRaw(e),r)}},t.prototype.handleTimeout=function(){dt.warn("xdframe single domain: all messages not received")},t.prototype.isXdframeMessage=function(){},t.prototype.isXdframeErrorMessage=function(t){return!!t.data.error},t.prototype.getXdframeUrl=function(t){var e=csArray.prototype.join.call(fo,",");return t+"/uxa/xdframe-single-domain-1.1.0.html?pid="+this.configuration.projectId+"&cookieNames="+e},t}(),vo=function(){return(vo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},mo=function(){}(),go=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},So=function(){function t(){var t=this;this.isStarted=!1,this.onEventCallbacks=[],this.useCapture=!1,this.eventHandler={boundElement:window,type:"error",listener:function(e){return t.errorListener(e)}}}return t.prototype.onEvent=function(t){csArray.prototype.push.call(this.onEventCallbacks,t)},t.prototype.start=function(){this.isStarted||(Gt(this.eventHandler,this.useCapture),this.isStarted=!0)},t.prototype.stop=function(){this.isStarted&&(Wt(this.eventHandler,this.useCapture),this.isStarted=!1)},t.prototype.errorListener=function(t){var e=this.buildJavaScriptError(t);csArray.prototype.forEach.call(this.onEventCallbacks,(function(t){return t(e)}))},t.prototype.decorateErrorMessage=function(){},t.prototype.buildJavaScriptError=function(){},t.truncatedErrorMessageMarker="…",t.MAX_ERROR_MESSAGE_LENGTH=1024,go([yt("Event handler type: error")],t.prototype,"errorListener",null),t}(),Eo=function(){}();function(){}var Co,Ro,bo,To,Ao=function(){}(),ko=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Po=function(){}(Ai),Oo=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_o=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Io=function(t){function e(e,r,n,i,o){var s=t.call(this,e,r)||this;return s.configuration=e,s.compressor=r,s.quotaServiceRequest=n,s.lifeCycleEventsEmitter=i,s.forceInclusionService=o,s}return Oo(e,t),e.prototype.init=function(){this.bindQuotaServiceRequest()},e.prototype.sanitizeSessionRecordingState=function(){},e.prototype.computeRecordingState=function(t){var e,r=this;if(!this.isCompressionSupported())return Jt.NOT_RECORDED;if(N()<this.configuration.replayRecordingRate&&pr.isSupported()||this.forceInclusionService.isForceMalkaReplayRecorded()){var n=null===(e=this.visitorService)||void 0===e?void 0:e.getVisitor();return this.quotaServiceRequest.setRequestPayloadProvider({getRequestPayload:function(){return csJSON.stringify({projectId:r.configuration.projectId,recordingTypes:[parseInt(Jt.RANDOM_SAMPLING,10)],uu:(null==n?void 0:n.id)||"",sn:(null==n?void 0:n.visitsCount)||"",pn:(null==t?void 0:t.pageNumber)||""})}}),this.quotaServiceRequest.send(),Jt.RANDOM_SAMPLING}return Jt.NOT_RECORDED},e.prototype.isReplayRecorded=function(t){return t.recordingState===Jt.TEMPORARILY_RECORDED||t.recordingState===Jt.RANDOM_SAMPLING},e.prototype.bindQuotaServiceRequest=function(){},e.prototype.quotaServiceErrorHandler=function(t){dt.warn("Quota Service: request error - "+t)},e.prototype.quotaServiceTimeoutHandler=function(){dt.warn("Quota Service: request timeout")},e.prototype.quotaServiceLoadHandler=function(t){if(200===t.status)try{csJSON.parse(t.responseText)}catch(e){return void this.quotaServiceErrorHandler("Unable to parse the quota service response: "+t.responseText)}else this.quotaServiceErrorHandler("Status code: "+t.status)},e.prototype.setVisitorService=function(t){this.visitorService=t},e.prototype.getDisabledRecordingState=function(){return Jt.NOT_RECORDED},_o([yt("Quota Service: onerror")],e.prototype,"quotaServiceErrorHandler",null),_o([yt("Quota Service: ontimeout")],e.prototype,"quotaServiceTimeoutHandler",null),_o([yt("Quota Service: onload")],e.prototype,"quotaServiceLoadHandler",null),e}(Si),No=function(){this.isStarted=!1},Mo=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Do=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},Lo=function(t){function e(e,r){var n=t.call(this)||this;return n.xhrRequestTracker=e,n.fetchRequestTracker=r,n.onEventCallbacks=[],n.excludedDomains=[],n}return Mo(e,t),e.prototype.init=function(){var t=this;this.xhrRequestTracker.onEvent((function(e){return t.apiErrorListener(e)})),this.fetchRequestTracker.onEvent((function(e){return t.apiErrorListener(e)}))},e.prototype.onEvent=function(t){csArray.prototype.push.call(this.onEventCallbacks,t)},e.prototype.start=function(){this.isStarted||(this.xhrRequestTracker.start(),this.fetchRequestTracker.start(),this.isStarted=!0)},e.prototype.stop=function(){this.isStarted&&(this.xhrRequestTracker.stop(),this.fetchRequestTracker.stop(),this.isStarted=!1)},e.prototype.apiErrorListener=function(t){if(t.url&&t.statusCode){if(t.url=tt(t.url),csArray.prototype.some.call(this.excludedDomains,(function(e){return-1!==csString.prototype.indexOf.call(t.url,e)})))return;if(t.statusCode>=400){var e=this.buildApiError(t);csArray.prototype.forEach.call(this.onEventCallbacks,(function(t){return t(e)}))}}},e.prototype.buildApiError=function(t){return{errorType:"apiError",url:t.url,method:t.method,requestTime:t.requestTime,responseTime:t.responseTime,statusCode:t.statusCode,library:t.library}},e.prototype.excludeDomains=function(){},e.truncatedErrorMessageMarker="…",e}(No),xo=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qo=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},Uo=function(t){function e(e){var r=t.call(this)||this;return r.monkeyPatcher=e,r.callbacks=[],r.openHook=function(t){var e=t.context,n=t.args,i=t.callerName;return r.interceptOpen(e,n,i)},r}return xo(e,t),e.prototype.onEvent=function(t){csArray.prototype.push.call(this.callbacks,t)},e.prototype.start=function(){this.isStarted||(this.createInterceptors(),this.openInterceptor&&this.openInterceptor.activate(),this.isStarted=!0)},e.prototype.createInterceptors=function(){this.openInterceptor||(this.openInterceptor=this.monkeyPatcher.createSyncFunctionInterceptor({target:XMLHttpRequest.prototype,methodName:"open",hook:this.openHook,options:{withCallerName:!0}}))},e.prototype.stop=function(){this.isStarted&&(this.openInterceptor&&this.openInterceptor.deactivate(),this.isStarted=!1)},e.prototype.interceptOpen=function(t,e,r){var n=this;t.apiCall={url:e[1],method:e[0],requestTime:L.now(),responseTime:0,statusCode:0},t.apiCall.library=r,t.addEventListener("readystatechange",(function(t){return n.readyStateChangeListener(t.target)}))},e.prototype.readyStateChangeListener=function(t){t.readyState===XMLHttpRequest.DONE&&(t.apiCall.responseTime=L.now(),t.apiCall.statusCode=t.status,csArray.prototype.forEach.call(this.callbacks,(function(e){return e(t.apiCall)})))},qo([yt("XhrRequestTracker.interceptOpen")],e.prototype,"interceptOpen",null),qo([yt("XhrRequestTracker.readyStateChangeListener")],e.prototype,"readyStateChangeListener",null),e}(No),Vo=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jo=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},zo=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},Bo=function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ho=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},Fo=function(t){function e(e){var r=t.call(this)||this;return r.monkeyPatcher=e,r.callbacks=[],r.hook=function(t){var e=t.result,n=t.args,i=t.callerName;r.interceptFetch(e,n,i)},r}return Vo(e,t),e.prototype.onEvent=function(t){csArray.prototype.push.call(this.callbacks,t)},e.prototype.start=function(){this.canTrackFetch()&&!this.isStarted&&(this.createFetchInterceptor(),this.fetchInterceptor&&this.fetchInterceptor.activate(),this.isStarted=!0)},e.prototype.canTrackFetch=function(){return!!window.fetch&&"function"==typeof window.fetch},e.prototype.prepareArgs=function(){},e.prototype.createFetchInterceptor=function(){},e.prototype.stop=function(){this.isStarted&&(this.fetchInterceptor&&this.fetchInterceptor.deactivate(),this.isStarted=!1)},e.prototype.interceptFetch=function(t,e,r){return zo(this,void 0,void 0,(function(){var n,i,o,s,a,c;return Bo(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),n=e[0],i=e[1],o=new Request(n,i),(s={url:o.url,method:o.method,requestTime:L.now(),responseTime:0,statusCode:0}).library=r,[4,t];case 1:return a=u.sent(),s.responseTime=L.now(),a.type.indexOf("opaque")>-1?s.statusCode=-1:s.statusCode=a.status,csArray.prototype.forEach.call(this.callbacks,(function(t){return t(s)})),[3,3];case 2:return c=u.sent(),dt.error("Error in FetchRequestTracker.interceptFetch:"+c+")"),[3,3];case 3:return[2]}}))}))},jo([yt("FetchRequestTracker.interceptFetch")],e.prototype,"interceptFetch",null),e}(No);Ro=Co||(Co={}),bo=[wr.MOUSEMOVE,wr.MOUSEDOWN,wr.MOUSEUP,wr.CLICK,wr.MOUSEOVER,wr.MOUSEOUT,wr.TAP],Ro.transformEvent=function(t,e,r){return function(t,e){return e.target&&(e.target=""+t+Yo+e.target),e.targetHeatmap&&(e.targetHeatmap=""+t+Yo+e.targetHeatmap),e.targetLink&&(e.targetLink=""+t+Yo+e.targetLink),e}(e,function(t,e){if(n=e.type,-1!==csArray.prototype.indexOf.call(bo,n)){var r=t.getBoundingClientRect();e.x&&(e.x=Math.round(r.left+e.x+Se.windowOffsetX())),e.y&&(e.y=Math.round(r.top+e.y+Se.windowOffsetY()))}var n;return e}(t,r))},(To||(To={})).transformCommandsBatch=function(){};var Go,Wo=function(){return(Wo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};(Go||(Go={})).transformEmerchandisingMessage=function(){};var Xo,Jo=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yo="|iframe|",Ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jo(e,t),e.prototype.emitIframeEvent=function(t,e,r,n){switch(r){case it.ChildLogMessage:this.logMessage(n);break;case it.AnalysisEvent:var i=Co.transformEvent(t,e,n);this.emitIframeAnalysisEvent(i);break;case it.JavascriptError:this.emitIframeJavascriptError(n);break;case it.ApiError:this.emitIframeApiError(n);break;case it.EmerchandisingMessage:var o=Go.transformEmerchandisingMessage(e,n);this.emitIframeEmerchandisingMessage(o);break;case it.Commands:var s=To.transformCommandsBatch(e,n);this.emitIframeCommands(s);break;default:dt.error("Parent received unknown data type from iframe : "+csJSON.stringify(n))}},e.prototype.logMessage=function(){},e.prototype.emitIframeAnalysisEvent=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onIframeAnalysisEvent&&n.onIframeAnalysisEvent(t)}},e.prototype.emitIframeJavascriptError=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onIframeJavascriptError&&n.onIframeJavascriptError(t)}},e.prototype.emitIframeApiError=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onIframeApiError&&n.onIframeApiError(t)}},e.prototype.emitIframeEmerchandisingMessage=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onIframeEmerchandisingMessage&&n.onIframeEmerchandisingMessage(t)}},e.prototype.emitIframeCommands=function(t){for(var e=0,r=this.listeners;e<r.length;e++){var n=r[e];n.onIframeCommands&&n.onIframeCommands(t)}},e}(Ai);!function(t){t.COMPRESSION_DISABLED="compressionDisabled"}(Xo||(Xo={}));var Qo,Zo,$o=function(){function t(t){this.cookieService=t,this.cookieFlags=[]}return t.prototype.init=function(){var t=this.cookieService.get("_cs_debug");t&&(this.cookieFlags=csString.prototype.split.call(t,"."))},t.prototype.isCompressionDisabled=function(){},t}(),ts=function(){function t(t){this.onError=t,this.worker=this.tryCreateCompressionWorker(),this.callbacks={},this.callbackId=0}return t.prototype.isSupported=function(){return null!==this.worker},t.prototype.compress=function(t,e,r){if(this.isSupported()){var n=this.getNewCallbackId();this.callbacks[n]=r,this.worker.postMessage([t,e,n])}},t.prototype.compressSync=function(t){return hn.compressToBase64(t)},t.prototype.terminateWorker=function(){null!==this.worker&&this.worker.terminate()},t.prototype.tryCreateCompressionWorker=function(){try{var t=csString.prototype.replace.call(this.compressionScript.toString(),"GET_LZ_STRING_SOURCE",ln);return this.createWorker("("+t+")();")}catch(t){return null}},t.prototype.createWorker=function(){},t.prototype.handleWorkerError=function(){},t.prototype.handleWorkerMessage=function(t){var e=t.data,r=e[0],n=e[1];this.callbacks[r](n),delete this.callbacks[r]},t.prototype.compressionScript=function(){var t=GET_LZ_STRING_SOURCE();self.addEventListener("message",(function(e){var r,n=e.data,i=n[0],o=n[1],s=n[2];switch(i){case"base64":r=t.compressToBase64(o);break;case"byteArray":r=t.compressToUint8Array(o).buffer}self.postMessage([s,r])}))},t.prototype.getNewCallbackId=function(){return this.callbackId+=1},t}(),es=function(){return(es=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},rs=function(){}(),ns=function(){}(),is=function(){function t(t,e,r){this.configuration=t,this.cookieChecker=e,this.parentLogContext=r}return t.prototype.init=function(){var t=this;performance.mark("cs-start-boot");var e=new Pi,r=new W,n=new Vi,i=new Hi(this.configuration,n,r),o=new Ao(window.location,r),s=new bt(this.configuration,o,this.cookieChecker);s.init();var a=new qi(window.location,s),c=new $o(s);c.init();var u=new ho(this.configuration,s);u.init();var p,l=new ts((function(t){dt.warn(t)}));if(this.configuration.useMalkaPipeline){var h=new Ft(this.configuration.getQuotaServiceUri(),"quota");(p=new Io(this.configuration,l,h,e,a)).init()}else p=new wi(this.configuration,l,a,o);var f=new Dt(s,u),d=new Ci(f,s,p),y=new gi(this.configuration,d,s,u);this.parentLogContext.setContext(y,d),p.setVisitorService(y);var v=new bi(this.configuration,s,y,d),m=new qt(window.location,s,u),g=new xi(m),S=new Ri(this.configuration,y,m),E=new _t(y,d,m,this.configuration,s,u),w=new zt,C=new Vt(w,window.location),R=new Yi(this.configuration,E,C),b=new yo(this.configuration,w);u.setStates(E,b);var T=new vi(this.configuration,y,m,S,v,R,u,a);return i.init(),T.compute((function(n){var i=new Ko,a=new to,p=new Ki(a,i);p.init();var h=new Po,f=new _i(s),v=new Di(t.configuration,f,e,s),m=new Mi(a,v),S=new Fi(e,window.location,s),E=new Wi(a,S),w=new Eo(a,t.configuration),C=new mo(t.configuration,y,d),R=new So,b=new ur,T=new Uo(b),A=new Fo(b),k=new Lo(T,A),P=new rs(r),O=new ns(r,o),_=new po(R,O,k,P,t.configuration,C,i,a);(_.init(),performance.mark("cs-step2-boot"),e.addListeners(_),n)?(e.emitInitTracking(),new yi(C,l,y,d,e,a,p,t.configuration,E,S,m,v,r,s,u,o,w,h,R,O,k,P,i,c).start()):new Li(e,a,p,E,S,g,m).start()})),performance.mark("cs-end-boot"),performance.measure("cs-measure-boot","cs-start-boot","cs-end-boot"),{LZString:hn}},t}();!function(){}(Qo||(Qo={})),function(){}(Zo||(Zo={}));var os=window.CSFrameCommunication||Zo,ss=function(){function t(t){this.iframeCommandsSenderService=t}return t.prototype.init=function(){this.iframeCommandsSenderService.register(Tr),this.iframeCommandsSenderService.register(xn),this.iframeCommandsSenderService.register(Pn),this.iframeCommandsSenderService.register(On),this.iframeCommandsSenderService.register(kn),this.iframeCommandsSenderService.register(Nr),this.iframeCommandsSenderService.register(Mr),this.iframeCommandsSenderService.register(Dr),this.iframeCommandsSenderService.register(Lr),this.iframeCommandsSenderService.register(jn),this.iframeCommandsSenderService.register(zn),this.iframeCommandsSenderService.register(Gi),this.iframeCommandsSenderService.register(ii),this.iframeCommandsSenderService.register(oi),this.iframeCommandsSenderService.register(Ii),this.iframeCommandsSenderService.register(Ni),this.iframeCommandsSenderService.register(uo)},t.prototype.onStartTracking=function(){this.iframeCommandsSenderService.start()},t.prototype.onOptout=function(){this.iframeCommandsSenderService.stop()},t}(),as=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),cs=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},us=function(){}(ne),ps=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ls=function(t){function e(e,r){var n=t.call(this)||this;return n.configuration=e,n.lifeCycleEventsEmitter=r,n.id=-1,n.parentOrigin="",n.maxMessagesBuffer=25,n.messageBuffer=[],n.messageHandler={boundElement:window,type:"message",listener:function(t){return n.messagesListener(t)}},n}return ps(e,t),e.prototype.onStart=function(){Gt(this.messageHandler,!1),this.sendDiscovery()},e.prototype.onStop=function(){Wt(this.messageHandler,!1)},e.prototype.sendToParent=function(t,e){var r=this.buildChildBaseMessage(t,e);this.sendMessage(r)},e.prototype.sendDiscovery=function(){},e.prototype.buildChildBaseMessage=function(){},e.prototype.sendMessage=function(){},e.prototype.messagesListener=function(t){if(ot.isMessageValid(t,nt.Parent,this.configuration.projectId,this.configuration.hostnames))switch(t.data.type){case it.Discovery:if(!mt(t.data.id)||t.data.id<0)return void dt.warn("Iframe child ("+this.id+") received discovery without valid id from parent ("+t.origin+") : "+csJSON.stringify(t.data));this.id=t.data.id,this.parentOrigin=t.origin,this.sendAllBufferedMessages();break;case it.Stop:this.lifeCycleEventsEmitter.emitOptout();break;default:dt.warn("Iframe child ("+this.id+") received unknown data type from parent ("+t.origin+") : "+csJSON.stringify(t.data))}},e.prototype.addMessageToBuffer=function(){},e.prototype.sendAllBufferedMessages=function(){},e}(ne),hs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fs=function(t){function e(e,r){var n=t.call(this)||this;return n.apiErrorsTracker=e,n.iframeChildToParentCommunicationService=r,n}return hs(e,t),e.prototype.init=function(){var t=this;this.apiErrorsTracker.init(),this.apiErrorsTracker.onEvent((function(e){return t.processEvent(e)}))},e.prototype.onStart=function(){this.apiErrorsTracker.start()},e.prototype.onStop=function(){this.apiErrorsTracker.stop()},e.prototype.processEvent=function(){},e}(ne),ds=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ys=function(t){function e(e,r){var n=t.call(this)||this;return n.javaScriptErrorsTracker=e,n.iframeChildToParentCommunicationService=r,n}return ds(e,t),e.prototype.init=function(){var t=this;this.javaScriptErrorsTracker.onEvent((function(e){return t.processEvent(e)}))},e.prototype.onStart=function(){this.javaScriptErrorsTracker.start()},e.prototype.onStop=function(){this.javaScriptErrorsTracker.stop()},e.prototype.processEvent=function(t){this.isStarted&&this.iframeChildToParentCommunicationService.sendToParent(it.JavascriptError,t)},e}(ne),vs=function(){function t(t,e,r,n){this.javaScriptErrorsTracker=t,this.apiErrorsTracker=e,this.configuration=r,this.iframeChildToParentCommunicationService=n}return t.prototype.init=function(){this.iframeJavaScriptErrorsService=new ys(this.javaScriptErrorsTracker,this.iframeChildToParentCommunicationService),this.iframeJavaScriptErrorsService.init(),this.apiErrorsTracker.excludeDomains([Qi.CONTENTSQUARE,Qi.CLICKTALE,Qi.FAKE_TRACKER]),this.iframeApiErrorsService=new fs(this.apiErrorsTracker,this.iframeChildToParentCommunicationService),this.iframeApiErrorsService.init()},t.prototype.onStartTracking=function(){this.configuration.jsErrorsEnabled&&this.iframeJavaScriptErrorsService.start(),this.configuration.apiErrorsEnabled&&this.iframeApiErrorsService.start()},t.prototype.onOptout=function(){this.iframeJavaScriptErrorsService.stop(),this.iframeApiErrorsService.stop()},t}(),ms=function(){}(),gs=function(){function t(t,e,r){this.iframeParentToChildrenCommunicationService=t,this.iframeEventsEmitter=e,this.iframeChildToParentCommunicationService=r}return t.prototype.init=function(){},t.prototype.onIframeAnalysisEvent=function(t){this.iframeChildToParentCommunicationService.sendToParent(it.AnalysisEvent,t)},t.prototype.onIframeJavascriptError=function(t){this.iframeChildToParentCommunicationService.sendToParent(it.JavascriptError,t)},t.prototype.onIframeApiError=function(t){this.iframeChildToParentCommunicationService.sendToParent(it.ApiError,t)},t.prototype.onIframeEmerchandisingMessage=function(t){this.iframeChildToParentCommunicationService.sendToParent(it.EmerchandisingMessage,t)},t.prototype.onIframeCommands=function(t){this.iframeChildToParentCommunicationService.sendToParent(it.Commands,t)},t.prototype.onStartTracking=function(){this.iframeParentToChildrenCommunicationService.start()},t.prototype.onOptout=function(){this.iframeParentToChildrenCommunicationService.stop()},t}(),Ss=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Es=function(){}(ne),ws=function(){}(),Cs=function(){}(),Rs=function(){}