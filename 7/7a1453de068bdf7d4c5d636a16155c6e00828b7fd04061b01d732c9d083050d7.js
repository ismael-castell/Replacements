var PRODO=(function(){var _args={removeOuterElementIfEmpty:false,removeOuterDisclaimerIfEmpty:false};var domain="prodo-api.ariva-services.de";var dailyValueMap={};var weeklyValueMap={};var monthlyValueMap={};return{adSlotId:function(adslotId){_args.adSlotId=adslotId;},elementId:function(elementId){_args.elementId=elementId;},disclaimerElementId:function(disclaimerElementId){_args.disclaimerElementId=disclaimerElementId;},userInterestDerivativeTypeIds:function(userInterestDerivativeTypeIds){_args.userInterestDerivativeTypeIds=userInterestDerivativeTypeIds;},userInterestIndexIsins:function(userInterestIndexIsins){_args.userInterestIndexIsins=userInterestIndexIsins;},userInterestInstrumentIsins:function(userInterestInstrument){_args.userInterestInstrumentIsins=userInterestInstrument;},impactingAics:function(impactingAics){_args.impactingAics=impactingAics;},impactingIsins:function(impactingIsins){_args.impactingIsins=impactingIsins;},relatedTag:function(relatedTag){_args.relatedTag=relatedTag;},frequencies(){return[dailyValueMap,weeklyValueMap,monthlyValueMap]},removeOuterElementIfEmpty:function(removeOuterElementIfEmpty){_args.removeOuterElementIfEmpty=removeOuterElementIfEmpty;},removeOuterDisclaimerIfEmpty:function(removeOuterDisclaimerIfEmpty){_args.removeOuterDisclaimerIfEmpty=removeOuterDisclaimerIfEmpty;},response:{},loadAdvertisement(success,error){var adSlotId=_args.adSlotId;var elementId=_args.elementId;var disclaimerElementId=_args.disclaimerElementId;var runningDomain=window.location.origin;var pageUrl=document.documentURI;var impactingIsins=_args.impactingIsins;var impactingAics=_args.impactingAics;const freqs=buildFrequencyRequest(this.frequencies());params={runningDomain:runningDomain,pageUrl:pageUrl,impactIsins:impactingIsins,impactAics:impactingAics,relatedTag:_args.relatedTag,userInterestInstrumentIsins:_args.userInterestInstrumentIsins,userInterestIndexIsins:_args.userInterestIndexIsins,userInterestDerivativeTypeIds:_args.userInterestDerivativeTypeIds,frequencies:freqs,userAgent:navigator.userAgent,clientJSVersion:"1.0.16"};paramString=JSON.stringify(params);if((!impactingIsins||impactingIsins.length==0)&&(!impactingAics||impactingAics.length==0)){params.pageTitle=document.title;}
var deviceType=getDeviceType();if(deviceType!==undefined&&deviceType!==null){params.device=deviceType.toUpperCase();}
postData('https://'+domain+'/api/v1/deliver/media/'+adSlotId,params).then(function(response){return response.json();}).catch(_=>{console.error("PRODO: An error occured retrieving adslot "+adSlotId);if(_args.removeOuterElementIfEmpty){element=document.getElementById(elementId);element.hidden=true;}
if(typeof error=="function"){error();}}).then((data)=>{this.response=data;element=document.getElementById(elementId);disclaimerEndOfPageElement=document.getElementById(disclaimerElementId);if(data!==undefined&&data.html!==undefined&&data.html!==null&&data.requestId!==null){dimensionUnit="";if(data.unit=="PIXEL"){dimensionUnit="px";}else{dimensionUnit="%";}
element.classList.add("prodo-shadow");setInnerHTML(element,"<div style='width:100%; max-width: "+data.width+dimensionUnit+";height: "+data.height+dimensionUnit+";overflow: hidden'>"
+"<div>"+data.html+"</div>"
+"<div>"+(data.disclaimerAtAd?data.disclaimerAtAd:"")+"</div>"
+"</div>"
+("<img style='width:0;height:0' src='https://"
+domain
+"/data/api/v1/view/"
+data.requestId
+((data.externalViewTrackingURL!==undefined&&data.externalViewTrackingURL!==null)?"?externalViewTrackingURL="+data.externalViewTrackingURL:"")
+"'>"));if(disclaimerEndOfPageElement!==null){disclaimerEndOfPageElement.innerHTML=data.disclaimerAtPageEnd;}
if(_args.removeOuterDisclaimerIfEmpty&&data.disclaimerAtPageEnd===''){element=document.getElementById(disclaimerElementId);if(element!==null){element.hidden=true;}}
updateFrequency([dailyValueMap,weeklyValueMap,monthlyValueMap],this.response.bouquetId);if(typeof success=="function"){success();}}else{console.error("No data or renderable content found");if(data){console.error(data);}
if(data.html===null&&data.json!==null){console.error("This is an AdSlot with JSON DATA and should not be used in HTML context.");}
if(_args.removeOuterElementIfEmpty){element=document.getElementById(elementId);element.hidden=true;}
if(typeof error=="function"){error();}}});async function postData(url='',data={}){const response=await fetch(url,{method:'POST',mode:'cors',cache:'no-cache',credentials:'same-origin',headers:{'Content-Type':'application/json'},redirect:'follow',referrerPolicy:'no-referrer',body:JSON.stringify(data)});return response;}}};}());function prodoClient(that,vars,event){if(event.button===2){openProdoContextmenu(that,vars,event);return false;}
handleProdoClick(that,vars);}
function handleProdoClick(that,vars){var zertArtId=vars.zertArtId;var underlyings=vars.underlying;var isTargetBlank=vars.isTargetBlank;var targetUrl=vars.targetUrl;if(PRODO.response&&PRODO.response.permissionSaveCookie&&getProdoCookie("prodo_zertArtId")){console.debug("found cookie for prodo_zertartId "+getProdoCookie("prodo_zertArtId"));}
if(PRODO.response&&PRODO.response.permissionSaveCookie&&getProdoCookie("prodo_underlyings")){console.debug("found cookie for prodo_underlyings "+getProdoCookie("prodo_underlyings"));}
if(PRODO.response&&PRODO.response.permissionSaveCookie){console.debug("setting cookie prodo_zertartId "+zertArtId);setProdoCookie("prodo_zertArtId",zertArtId,10);if(underlyings&&Array.isArray(underlyings)){console.debug("setting cookie prodo_underlyings "+underlyings.join());setProdoCookie("prodo_underlyings",underlyings.join(),10);}}else{console.debug("setting cookie is prohibited")}
var gotoUrl;if(targetUrl&&targetUrl!=""){gotoUrl=targetUrl;}else if(that.href&&that.href!=""){gotoUrl=that.href;}else{gotoUrl="";}
var escapedUserAgent=escape(navigator.userAgent);if(escapedUserAgent==""){escapedUserAgent=navigator.userAgent;}
if(escapedUserAgent==""){escapedUserAgent="navigator.userAgent not available";}
if(gotoUrl.indexOf('?')!=-1){gotoUrl=gotoUrl.concat("&userAgent="+escapedUserAgent);}else{gotoUrl=gotoUrl.concat("?userAgent="+escapedUserAgent);}
console.debug("PRODO: new URL "+gotoUrl);if(isTargetBlank){window.open(gotoUrl,'_blank');}else{location.href=gotoUrl;}
return false;}
function prodoClientExternalLink(that,vars){console.debug(PRODO.response);var gotoUrl=vars.target;var escapedUserAgent=escape(navigator.userAgent);if(escapedUserAgent==""){escapedUserAgent=navigator.userAgent;}
if(escapedUserAgent==""){escapedUserAgent="navigator.userAgent not available";}
if(gotoUrl.indexOf('?')!=-1){gotoUrl=gotoUrl.concat("&userAgent="+escapedUserAgent);}else{gotoUrl=gotoUrl.concat("?userAgent="+escapedUserAgent);}
window.open(gotoUrl,'_blank');return false;}
function prodoClientSearchLink(that,vars){var gotoUrl=vars.target;var escapedUserAgent=escape(navigator.userAgent);if(escapedUserAgent==""){escapedUserAgent=navigator.userAgent;}
if(escapedUserAgent==""){escapedUserAgent="navigator.userAgent not available";}
if(gotoUrl.indexOf('?')!=-1){gotoUrl=gotoUrl.concat("&userAgent="+escapedUserAgent);}else{gotoUrl=gotoUrl.concat("?userAgent="+escapedUserAgent);}
window.open(gotoUrl,'_blank');return false;}
function setProdoCookie(cname,cvalue,exdays){var cookie=getProdoCookie(cname);cookieExpiry=cookie.split('_')[0];var d=new Date();var expDate=new Date();if(cookieExpiry){expDate=new Date(cookieExpiry);}else{expDate.setTime(expDate.getTime()+(exdays*24*60*60*1000));}
var expires=expDate.toISOString();var cString=cname+"="+expires+"_"+cvalue+";expires="+expDate.toUTCString()+";path=/";document.cookie=cString;}
function getProdoCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return "";}
function updateFrequency(frequencies,bouquetId){if(PRODO.response&&PRODO.response.permissionSaveCookie){var dailyValueMap=frequencies[0];var weeklyValueMap=frequencies[1];var monthlyValueMap=frequencies[2];var dailyCookieString=updateCountAndBuildCookieString(dailyValueMap,bouquetId);var weeklyCookieString=updateCountAndBuildCookieString(weeklyValueMap,bouquetId);var monthlyCookieString=updateCountAndBuildCookieString(monthlyValueMap,bouquetId);setProdoCookie("prodo_daily",dailyCookieString,1);setProdoCookie("prodo_weekly",weeklyCookieString,7);setProdoCookie("prodo_monthly",monthlyCookieString,30);}else{console.debug("setting PRODO cookie is disabled");}}
function updateValueMap(mapName,cookieName){if(getProdoCookie(cookieName)){var frequency=getProdoCookie(cookieName);var frequencyValues=frequency.split('_');for(var i=1;i<frequencyValues.length;i++){var frequencyValue=frequencyValues[i];var fBouquetId=frequencyValue.split('|')[0];var fCount=frequencyValue.split('|')[1];mapName[fBouquetId]=fCount;}}}
function updateCountAndBuildCookieString(mapName,bouquetId){mapName[bouquetId]=mapName[bouquetId]?Number(mapName[bouquetId])+1:1;var cookieString="";for(var i=0;i<Object.keys(mapName).length;i++){var curBouquetId=Object.keys(mapName)[i];var bouquetString=""+curBouquetId+"|"+mapName[curBouquetId];if(i!=(Object.keys(mapName).length-1)){bouquetString+="_";}
cookieString+=bouquetString;}
return cookieString;}
function buildFrequencyRequest(frequencies){var reqArray=[];var dailyValueMap=frequencies[0];var weeklyValueMap=frequencies[1];var monthlyValueMap=frequencies[2];updateValueMap(dailyValueMap,"prodo_daily");updateValueMap(weeklyValueMap,"prodo_weekly");updateValueMap(monthlyValueMap,"prodo_monthly");for(j=0;j<frequencies.length;j++){const mapName=frequencies[j];for(var i=0;i<Object.keys(mapName).length;i++){var curBouquetId=Object.keys(mapName)[i];var count=mapName[curBouquetId];const existingBouquet=reqArray.find(a=>a.bouquetId==curBouquetId);var countName='count'+(j==0?'Daily':j==1?'Weekly':'Monthly');if(existingBouquet){existingBouquet[countName]=count;}else{var entry={'bouquetId':curBouquetId};entry[countName]=count;reqArray.push(entry);}}}
return reqArray;}
const getDeviceType=()=>{const ua=navigator.userAgent;if(/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)){return "tablet";}
if(/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)){return "mobile";}
return "desktop";};var setInnerHTML=function(elm,html){var shadow=elm.attachShadow({mode:'open'});var node=document.createElement('div');node.innerHTML=html;shadow.appendChild(node);Array.from(shadow.querySelectorAll("script")).forEach(oldScript=>{const newScript=document.createElement("script");Array.from(oldScript.attributes).forEach(attr=>newScript.setAttribute(attr.name,attr.value));newScript.appendChild(document.createTextNode(oldScript.innerHTML));oldScript.parentNode.replaceChild(newScript,oldScript);});}
var openProdoContextMenus=[];function openProdoContextmenu(that,vars,event){event.preventDefault();closeProdoContextMenu();var m=document.createElement("span");this.openProdoContextMenus.push(m);vars.isTargetBlank=true;m.innerHTML="In neuem Fenster &ouml;ffnen";positionParent=event.target.position;m.classList.add("prodoMenuSpan");m.addEventListener("click",function(){closeProdoContextMenu();handleProdoClick(that,vars);event.stopPropagation();});const click=document.addEventListener("click",function(){}