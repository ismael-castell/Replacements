(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dd=t():e.dd=t()})(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=597)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=n(166),o=n(2);t.ENV_ENUM=o.ENV_ENUM;var d=n(3);n(172),t.ddSdk=new d.Sdk(i.getENV(),r.log)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addWatchParamsDeal=function(e){var t=Object.assign({},e);return t.watch=!0,t},t.addDefaultCorpIdParamsDeal=function(e){var t=Object.assign({},e);return t.corpId="corpId",t},t.genDefaultParamsDealFn=function(e){var t=Object.assign({},e);return function(e){return Object.assign(t,e)}},t.forceChangeParamsDealFn=function(e){var t=Object.assign({},e);return function(e){return Object.assign(e,t)}},t.genBoolResultDealFn=function(e){return function(t){var n=Object.assign({},t);return e.forEach(function(e){void 0!==n[e]&&(n[e]=!!n[e])}),n}},t.genBizStoreParamsDealFn=function(e){var t=Object.assign({},e);return"string"!=typeof t.params?(t.params=JSON.stringify(t),t):t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(3);t.ENV_ENUM=r.ENV_ENUM,t.APP_TYPE=r.APP_TYPE;var o=n(169);t.getUA=function(){var e="";try{"undefined"!=typeof navigator&&(e=navigator&&(navigator.userAgent||navigator.swuserAgent)||"")}catch(t){e=""}return e},t.getENV=function(){var e=t.getUA(),n=/DingTalk/i.test(e)||o.default.isDingTalk,r=/iPhone|iPad|iPod|iOS/i.test(e)&&n||o.default.isWeexiOS,d=/Android/i.test(e)&&n||o.default.isWeexAndroid,s=/Nebula/i.test(e)&&n||"object"==typeof dd&&"function"==typeof dd.dtBridge,a=/dd-web/i.test(e),u=i.APP_TYPE.WEB;a?u=i.APP_TYPE.WEBVIEW_IN_MINIAPP:s?u=i.APP_TYPE.MINI_APP:(o.default.isWeexiOS||o.default.isWeexAndroid)&&(u=i.APP_TYPE.WEEX);var c,l="*",v=e.match(/AliApp\(\w+\/([a-zA-Z0-9.-]+)\)/);null===v&&(v=e.match(/DingTalk\/([a-zA-Z0-9.-]+)/));var f;v&&v[1]&&(f=v[1]);var _="";if("undefined"!=typeof name&&(_=name),_)try{var E=JSON.parse(_);E.hostVersion&&(f=E.hostVersion),l=E.language||navigator.language||"*",c=E.containerId}catch(e){}var p,N=!!c;return p=r?i.ENV_ENUM.ios:d?i.ENV_ENUM.android:N?i.ENV_ENUM.pc:i.ENV_ENUM.notInDingTalk,{platform:p,version:f,appType:u,language:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(175);t.APP_TYPE=i.APP_TYPE,t.LogLevel=i.LogLevel,t.isFunction=i.isFunction,t.compareVersion=i.compareVersion,t.ENV_ENUM=i.ENV_ENUM;var r=function(){function e(e,t){var n=this;this.configJsApiList=[],this.hadConfig=!1,this.p={},this.config$=new Promise(function(e,t){n.p.reject=t,n.p.resolve=e}),this.logQueue=[],this.devConfig={debug:!1},this.platformConfigMap={},this.invokeAPIConfigMapByMethod={},this.isBridgeDrity=!0,this.getExportSdk=function(){return n.exportSdk},this.setAPI=function(e,t){n.invokeAPIConfigMapByMethod[e]=t},this.setPlatform=function(e){n.isBridgeDrity=!0,n.platformConfigMap[e.platform]=e,e.platform===n.env.platform&&e.bridgeInit().catch(function(e){n.customLog(i.LogLevel.WARNING,["auto bridgeInit error",e||""])})},this.getPlatformConfigMap=function(){return n.platformConfigMap},this.deleteApiConfig=function(e,t){var i=n.invokeAPIConfigMapByMethod[e];i&&delete i[t]},this.invokeAPI=function(e,t,r){void 0===t&&(t={}),void 0===r&&(r=!0),n.customLog(i.LogLevel.INFO,['==> "'+e+'" params: ',t]);var o=+new Date,d=o+"_"+Math.floor(1e3*Math.random());return n.devConfig.onBeforeInvokeAPI&&n.devConfig.onBeforeInvokeAPI({invokeId:d,method:e,params:t,startTime:o}),!1===n.devConfig.isAuthApi&&(r=!1),n.bridgeInitFn().then(function(s){var a=n.invokeAPIConfigMapByMethod[e],u=!0===n.devConfig.isDisableDeal||n.devConfig.disbaleDealApiWhiteList&&-1!==n.devConfig.disbaleDealApiWhiteList.indexOf(e);if(a||!r){var c;if(a&&(c=a[n.env.platform]),c||!r){var l={};l=!u&&c&&c.paramsDeal&&i.isFunction(c.paramsDeal)?c.paramsDeal(t):Object.assign({},t);var v=function(e){return!u&&c&&c.resultDeal&&i.isFunction(c.resultDeal)?c.resultDeal(e):e};if(i.isFunction(l.onSuccess)){var f=l.onSuccess;l.onSuccess=function(e){f(v(e))}}return s(e,l).then(v,function(t){var o=n.hadConfig&&void 0===n.isReady&&-1!==n.configJsApiList.indexOf(e),d="object"==typeof t&&"string"==typeof t.errorCode&&t.errorCode===i.ERROR_CODE.no_permission,a="object"==typeof t&&"string"==typeof t.errorCode&&t.errorCode===i.ERROR_CODE.cancel,u=c&&c.vs&&n.env.version&&i.compareVersion(n.env.version,c.vs),f=(n.env.platform===i.ENV_ENUM.ios||n.env.platform===i.ENV_ENUM.android)&&o&&d,_=n.env.platform===i.ENV_ENUM.pc&&o&&(u&&!a&&r||d);return f||_?n.config$.then(function(){return s(e,l).then(v)}):Promise.reject(t)}).then(function(r){return n.devConfig.onAfterInvokeAPI&&n.devConfig.onAfterInvokeAPI({invokeId:d,method:e,params:t,payload:r,isSuccess:!0,startTime:o,duration:+new Date-o}),n.customLog(i.LogLevel.INFO,['<== "'+e+'" success result: ',r]),r},function(r){return n.devConfig.onAfterInvokeAPI&&n.devConfig.onAfterInvokeAPI({invokeId:d,method:e,params:t,payload:r,startTime:o,duration:+new Date-o,isSuccess:!1}),n.customLog(i.LogLevel.WARNING,['<== "'+e+'" fail result: ',r]),Promise.reject(r)})}var _='"'+e+'" do not support the current platform ('+n.env.platform+")";return n.customLog(i.LogLevel.ERROR,[_]),Promise.reject({errorCode:i.ERROR_CODE.jsapi_internal_error,errorMessage:_})}var _="This API method is not configured for the platform ("+n.env.platform+")";return n.customLog(i.LogLevel.ERROR,[_]),Promise.reject({errorCode:i.ERROR_CODE.jsapi_internal_error,errorMessage:_})})},this.customLog=function(e,t){var i={level:e,text:t,time:new Date};!0===n.devConfig.debug?n.customLogInstance(i):n.logQueue.push(i)},this.clearLogQueue=function(){n.logQueue.forEach(function(e){n.customLogInstance(e)}),n.logQueue=[]},this.customLogInstance=t,this.env=e,this.bridgeInitFn=function(){if(n.bridgeInitFnPromise&&!n.isBridgeDrity)return n.bridgeInitFnPromise;n.isBridgeDrity=!1;var t=n.platformConfigMap[e.platform];if(t)n.bridgeInitFnPromise=t.bridgeInit().catch(function(e){return n.customLog(i.LogLevel.ERROR,["\b\b\b\b\bJsBridge initialization fails, jsapi will not work"]),Promise.reject(e)});else{var r="Do not support the current environmentï¼š"+e.platform;n.customLog(i.LogLevel.WARNING,[r]),n.bridgeInitFnPromise=Promise.reject(new Error(r))}return n.bridgeInitFnPromise};var r=function(e){void 0===e&&(e={}),n.devConfig=Object.assign(n.devConfig,e),!0===e.debug&&n.clearLogQueue(),e.extraPlatform&&n.setPlatform(e.extraPlatform)};this.exportSdk={config:function(t){void 0===t&&(t={});var o=!0;Object.keys(t).forEach(function(e){-1===["debug","usePromise"].indexOf(e)&&(o=!1)}),o?(n.customLog(i.LogLevel.WARNING,["This is a deprecated feature, recommend use dd.devConfig"]),r(t)):n.hadConfig?n.customLog(i.LogLevel.WARNING,["Config has been executed"]):(t.jsApiList&&(n.configJsApiList=t.jsApiList),n.hadConfig=!0,n.bridgeInitFn().then(function(i){var r=n.platformConfigMap[e.platform],o=t;r.authParamsDeal&&(o=r.authParamsDeal(o)),i(r.authMethod,o).then(function(e){n.isReady=!0,n.p.resolve(e)}).catch(function(e){n.isReady=!1,n.p.reject(e)})},function(){n.customLog(i.LogLevel.ERROR,['\b\b\b\b\bJsBridge initialization failed and "dd.config" failed to call'])}))},devConfig:r,ready:function(e){!1===n.hadConfig?(n.customLog(i.LogLevel.WARNING,["You don 't use a dd.config, so you don't need to wrap dd.ready, recommend remove dd.ready"]),n.bridgeInitFn().then(function(){e()})):n.config$.then(function(t){e()})},error:function(e){n.config$.catch(function(t){e(t)})},on:function(t,i){n.bridgeInitFn().then(function(){n.platformConfigMap[e.platform].event.on(t,i)})},off:function(t,i){n.bridgeInitFn().then(function(){n.platformConfigMap[e.platform].event.off(t,i)})},env:e,checkJsApi:function(t){void 0===t&&(t={});var r={};return t.jsApiList&&t.jsApiList.forEach(function(t){var o=n.invokeAPIConfigMapByMethod[t];if(o){var d=o[e.platform];d&&d.vs&&e.version&&i.compareVersion(e.version,d.vs)&&(r[t]=!0)}r[t]||(r[t]=!1)}),Promise.resolve(r)},_invoke:function(e,t){return void 0===t&&(t={}),n.invokeAPI(e,t,!1)}}}return e}();t.Sdk=r},function(e,t,n){(function(t,n){e.exports=n()})(0,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=579)}({179:function(e,t,n){"use strict";var i=n(181);e.exports=i},181:function(e,t,n){"use strict";var i=n(183),r=n(184),o=n(182),d=n(185),s=new o,a=!1,u="",c=null,l={},v=/{.*}/;try{var f=window.name.match(v);if(f&&f[0])var l=JSON.parse(f[0])}catch(e){l={}}l.hostOrigin&&".dingtalk.com"===l.hostOrigin.split(":")[1].slice(0-".dingtalk.com".length)&&l.containerId&&(a=!0,u=l.hostOrigin,c=l.containerId);var _={},E=new Promise(function(e,t){_._resolve=e,_._reject=t}),p={},N=null;window.top!==window&&(N=window.top,_._resolve()),p[d.SYS_INIT]=function(e){N=e.frameWindow,_._resolve(),e.respond({})},window.addEventListener("message",function(e){var t=e.data,n=e.origin;if(n===u)if("response"===t.type&&t.msgId){var i=t.msgId,o=s.getMsyById(i);o&&o.receiveResponse(t.body,!t.success)}else if("event"===t.type&&t.msgId){var i=t.msgId,o=s.getMsyById(i);o&&o.receiveEvent(t.eventName,t.body)}else if("request"===t.type&&t.msgId){var o=new r(e.source,n,t);p[o.methodName]&&p[o.methodName](o)}}),t.invokeAPI=function(e,t){var n=new i(c,e,t);return a&&E.then(function(){N&&N.postMessage(n.getPayload(),u),s.addPending(n)}),n};var P=null;t.addEventListener=function(e,n){P||(P=t.invokeAPI(d.SYS_EVENT,{})),P.addEventListener(e,n)},t.removeEventListener=function(e,t){P&&P.removeEventListener(e,t)}},182:function(e,t,n){"use strict";var i=function(){this.pendingMsgs={}};i.prototype.addPending=function(e){this.pendingMsgs[e.id]=e;var t=function(){delete this.pendingMsgs[e.id],e.removeEventListener("_finish",t)}.bind(this);e.addEventListener("_finish",t)},i.prototype.getMsyById=function(e){return this.pendingMsgs[e]},e.exports=i},183:function(e,t,n){"use strict";var i=n(574),r=n(573),o=0,d=Math.floor(1e3*Math.random()),s=function(){return 1e3*(1e3*d+Math.floor(1e3*Math.random()))+ ++o%1e3},a={code:408,reason:"timeout"},u={TIMEOUT:"_timeout",FINISH:"_finish"},c={timeout:-1},l=function(e,t,n,i){this.id=s(),this.methodName=t,this.containerId=e,this.option=r({},c,i);var n=n||{};this._p={},this.result=new Promise(function(e,t){this._p._resolve=e,this._p._reject=t}.bind(this)),this.callbacks={},this.plainMsg=this._handleMsg(n),this._eventsHandle={},this._timeoutTimer=null,this._initTimeout(),this.isFinish=!1};l.prototype._initTimeout=function(){this._clearTimeout(),this.option.timeout>0&&(this._timeoutTimer=setTimeout(function(){this.receiveEvent(u.TIMEOUT),this.receiveResponse(a,!0)}.bind(this),this.option.timeout))},l.prototype._clearTimeout=function(){clearTimeout(this._timeoutTimer)},l.prototype._handleMsg=function(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n];"function"==typeof r&&"on"===n.slice(0,2)?this.callbacks[n]=r:t[n]=i(r)}.bind(this)),t},l.prototype.getPayload=function(){return{msgId:this.id,containerId:this.containerId,methodName:this.methodName,body:this.plainMsg,type:"request"}},l.prototype.receiveEvent=function(e,t){if(this.isFinish&&e!==u.FINISH)return!1;e!==u.FINISH&&e!==u.TIMEOUT&&this._initTimeout(),Array.isArray(this._eventsHandle[e])&&this._eventsHandle[e].forEach(function(e){try{e(t)}catch(e){console.error(t)}});var n="on"+e.charAt(0).toUpperCase()+e.slice(1);return this.callbacks[n]&&this.callbacks[n](t),!0},l.prototype.addEventListener=function(e,t){if(!e||"function"!=typeof t)throw"eventName is null or handle is not a function, addEventListener fail";Array.isArray(this._eventsHandle[e])||(this._eventsHandle[e]=[]),this._eventsHandle[e].push(t)},l.prototype.removeEventListener=function(e,t){if(!e||!t)throw"eventName is null or handle is null, invoke removeEventListener fail";if(Array.isArray(this._eventsHandle[e])){var n=this._eventsHandle[e].indexOf(t);-1!==n&&this._eventsHandle[e].splice(n,1)}},l.prototype.receiveResponse=function(e,t){if(!0===this.isFinish)return!1;this._clearTimeout();var t=!!t;return t?this._p._reject(e):this._p._resolve(e),setTimeout(function(){this.receiveEvent(u.FINISH)}.bind(this),0),this.isFinish=!0,!0},e.exports=l},184:function(e,t,n){"use strict";var i=function(e,t,n){if(this._msgId=n.msgId,this.frameWindow=e,this.methodName=n.methodName,this.clientOrigin=t,this.containerId=n.containerId,this.params=n.body,!this._msgId)throw"msgId not exist";if(!this.frameWindow)throw"frameWindow not exist";if(!this.methodName)throw"methodName not exits";if(!this.clientOrigin)throw"clientOrigin not exist";this.hasResponded=!1};i.prototype.respond=function(e,t){var t=!!t;if(!0!==this.hasResponded){var n={type:"response",success:!t,body:e,msgId:this._msgId};this.frameWindow.postMessage(n,this.clientOrigin),this.hasResponded=!0}},i.prototype.emit=function(e,t){var n={type:"event",eventName:e,body:t,msgId:this._msgId};this.frameWindow.postMessage(n,this.clientOrigin)},e.exports=i},185:function(e,t,n){"use strict";e.exports={SYS_EVENT:"SYS_openAPIContainerInitEvent",SYS_INIT:"SYS_openAPIContainerInit"}},4:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},572:function(e,t,n){(function(e,n){function i(e,t){return e.set(t[0],t[1]),e}function r(e,t){return e.add(t),e}function o(e,t){for(var n=-1,i=e.length;++n<i&&!1!==t(e[n],n,e););return e}function d(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function s(e,t,n,i){var r=-1,o=e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function a(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function u(e){return e&&e.Object===Object?e:null}function c(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function l(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function v(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function f(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function _(){this.__data__=jt?jt(null):{}}function E(e){return this.has(e)&&delete this.__data__[e]}function p(e){var t=this.__data__;if(jt){var n=t[e];return n===ge?void 0:n}return pt.call(t,e)?t[e]:void 0}function N(e){var t=this.__data__;return jt?void 0!==t[e]:pt.call(t,e)}function P(e,t){return this.__data__[e]=jt&&void 0===t?ge:t,this}function k(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function M(){this.__data__=[]}function I(e){var t=this.__data__,n=z(t,e);return!(n<0||(n==t.length-1?t.pop():bt.call(t,n,1),0))}function S(e){var t=this.__data__,n=z(t,e);return n<0?void 0:t[n][1]}function A(e){return z(this.__data__,e)>-1}function y(e,t){var n=this.__data__,i=z(n,e);return i<0?n.push([e,t]):n[i][1]=t,this}function b(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function U(){this.__data__={hash:new f,map:new($t||k),string:new f}}function V(e){return ie(this,e).delete(e)}function g(e){return ie(this,e).get(e)}function $(e){return ie(this,e).has(e)}function h(e,t){return ie(this,e).set(e,t),this}function m(e){this.__data__=new k(e)}function O(){this.__data__=new k}function j(e){return this.__data__.delete(e)}function w(e){return this.__data__.get(e)}function C(e){return this.__data__.has(e)}function D(e,t){var n=this.__data__;return n instanceof k&&n.__data__.length==Ve&&(n=this.__data__=new b(n.__data__)),n.set(e,t),this}function T(e,t,n){var i=e[t];pt.call(e,t)&&pe(i,n)&&(void 0!==n||t in e)||(e[t]=n)}function z(e,t){for(var n=e.length;n--;)if(pe(e[n][0],t))return n;return-1}function L(e,t){return e&&ee(t,Ue(t),e)}function R(e,t,n,i,r,d,s){var a;if(i&&(a=d?i(e,r,d,s):i(e)),void 0!==a)return a;if(!Se(e))return e;var u=Ft(e);if(u){if(a=ae(e),!t)return Z(e,a)}else{var l=se(e),v=l==je||l==we;if(Wt(e))return q(e,t);if(l==Te||l==he||v&&!d){if(c(e))return d?e:{};if(a=ue(v?{}:e),!t)return te(e,L(a,e))}else{if(!it[l])return d?e:{};a=ce(e,l,R,t)}}s||(s=new m);var f=s.get(e);if(f)return f;if(s.set(e,a),!u)var _=n?ne(e):Ue(e);return o(_||e,function(r,o){_&&(o=r,r=e[o]),T(a,o,R(r,t,n,i,o,e,s))}),a}function B(e){return Se(e)?At(e):{}}function F(e,t,n){var i=t(e);return Ft(e)?i:d(i,n(e))}function W(e,t){return pt.call(e,t)||"object"==typeof e&&t in e&&null===oe(e)}function x(e){return Vt(Object(e))}function q(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function G(e){var t=new e.constructor(e.byteLength);return new It(t).set(new It(e)),t}function J(e,t){var n=t?G(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function H(e,t,n){return s(t?n(l(e),!0):l(e),i,new e.constructor)}function Y(e){var t=new e.constructor(e.source,et.exec(e));return t.lastIndex=e.lastIndex,t}function K(e,t,n){return s(t?n(v(e),!0):v(e),r,new e.constructor)}function Q(e){return Rt?Object(Rt.call(e)):{}}function X(e,t){var n=t?G(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Z(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}function(){}