(self.webpackChunkmoovit_wtp_next=self.webpackChunkmoovit_wtp_next||[]).push([["main"],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},41380:function(e,t,n){var i={"./AMB_-_Nou_Barris.css":[66786,"client_assets_customers_AMB_-_Nou_Barris_css"],"./ATAF.css":[98420,"client_assets_customers_ATAF_css"],"./Aucorsa.css":[72912,"client_assets_customers_Aucorsa_css"],"./Barcelona.css":[66449,"client_assets_customers_Barcelona_css"],"./CRTM.css":[52235,"client_assets_customers_CRTM_css"],"./CTB.css":[61430,"client_assets_customers_CTB_css"],"./Mannai.css":[41747,"client_assets_customers_Mannai_css"],"./PassGo_Valencia.css":[75222,"client_assets_customers_PassGo_Valencia_css"],"./TRAM.css":[88274,"client_assets_customers_TRAM_css"],"./_base/boston_university_vars.css":[3316,"client_assets_customers__base_boston_university_vars_css"],"./academy_bus.css":[1472,"client_assets_customers_academy_bus_css"],"./arriva_glimble.css":[59126,"client_assets_customers_arriva_glimble_css"],"./autocares_rias_baixas.css":[77235,"client_assets_customers_autocares_rias_baixas_css"],"./boston_university.css":[6510,"client_assets_customers_boston_university_css"],"./concello_de_vigo.css":[96293,"client_assets_customers_concello_de_vigo_css"],"./consorcio_asturias.css":[95662,"client_assets_customers_consorcio_asturias_css"],"./dolomitibus.css":[23396,"client_assets_customers_dolomitibus_css"],"./el_corte_ingles.css":[31081,"client_assets_customers_el_corte_ingles_css"],"./elal.css":[22964,"client_assets_customers_elal_css"],"./forever_green.css":[28046,"client_assets_customers_forever_green_css"],"./imob.css":[97615,"client_assets_customers_imob_css"],"./la_vuelta.css":[76713,"client_assets_customers_la_vuelta_css"],"./metro_de_lisboa.css":[79818,"client_assets_customers_metro_de_lisboa_css"],"./mobilita_rome.css":[26695,"client_assets_customers_mobilita_rome_css"],"./neuquen.css":[71275,"client_assets_customers_neuquen_css"],"./pango.css":[24642,"client_assets_customers_pango_css"],"./red_transporte.css":[78891,"client_assets_customers_red_transporte_css"],"./san_juan.css":[41644,"client_assets_customers_san_juan_css"],"./sandusky_transit.css":[39219,"client_assets_customers_sandusky_transit_css"],"./santa_clarita.css":[83246,"client_assets_customers_santa_clarita_css"],"./standard.css":[88511,"client_assets_customers_standard_css"],"./tampa_bay.css":[17884,"client_assets_customers_tampa_bay_css"],"./trans_hierro.css":[45130,"client_assets_customers_trans_hierro_css"],"./valencia.css":[69060,"client_assets_customers_valencia_css"],"./valley_ragional_transit.css":[86656,"client_assets_customers_valley_ragional_transit_css"]};function r(e){if(!n.o(i,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=i[e],r=t[0];return n.e(t[1]).then(function(){return n.t(r,17)})}r.keys=function(){return Object.keys(i)},r.id=41380,e.exports=r},85573:function(e,t,n){"use strict";n.d(t,{y:function(){return s},B:function(){return l}});var i=n(3786),r=n(65492),o=n(2316),a=n(99902);const s="mv_account_footprint";let l=(()=>{class e{constructor(e){this.httpService=e}checkAccount(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.CheckAccount,{body:{callingCode:e,phoneNumber:t}}).toPromise()})}getAccount(){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.get(r.ZP.GetAccount).toPromise()})}getPaymentAccount(){return(0,i.mG)(this,void 0,void 0,function*(){const e=yield this.httpService.post(r.ZP.GetPaymentAccount).toPromise();return null==e?void 0:e.account})}createAndVerify(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.CreateAndVerify,{body:{callingCode:e,phoneNumber:t,metroId:n}}).toPromise()})}requestCode(e){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.RequestCode,{body:{userId:e}}).toPromise()})}verifyCode(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.VerifyCode,{body:{userId:e,code:t}}).toPromise()})}setInfo(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.SetInfo,{body:{userKey:e,userInfo:t}}).toPromise()})}logout(){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.Logout).toPromise()})}addPaymentMethod(e,t,n,o,a){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.AddPaymentMethod,{body:{provider:e,paymentMethodToken:t,paymentMethod:n,makeDefaultPaymentMethod:o,paymentContext:a}}).toPromise()})}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.O))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},81157:function(e,t,n){"use strict";n.d(t,{T:function(){return Ve}});var i=n(5),r=n(2316),o=n(5971),a=n(54364),s=n(16438),l=n(95505),c=n(61787),d=n(87479),u=n(93975),p=n(3786),h=n(41187),m=n(58318),g=n(79223),f=n(2339);let v=(()=>{class e{constructor(e,t,n){this.store=e,this.userActions=t,this.todService=n}ngOnInit(){const e=this.missingPaymentRegistrationSteps.terms.links.map(e=>`<a href="${e.action}">${e.text}</a>`);let t=this.missingPaymentRegistrationSteps.terms.text;for(let n=1;n<e.length+1;n++)t=t.replace(`%${n}$s`,e[n-1]);this.termsText=t}get state(){return this.store.getState()}get metroName(){var e;return null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.metroAreaName}get missingSteps(){return this.state.user.missingSteps}get missingPaymentRegistrationSteps(){return this.missingSteps.termsOfUseInstructions}approve(){return(0,p.mG)(this,void 0,void 0,function*(){yield this.todService.confirmTos(this.todService.userKey,this.missingSteps.paymentContext,this.missingPaymentRegistrationSteps.terms.version),this.store.dispatch(this.userActions.popMissingRegistrationStep(i.SD.TERMS_OF_USE))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.d),r.Y36(h.E),r.Y36(m.F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-terms-of-use"]],decls:10,vars:8,consts:[["src","images/registration/hero-tod-welcome-light.svg","mvAccessibleSVG","",1,"hero-tod-image"],[1,"sign-up-text"],[1,"terms-text",3,"innerHTML"],[1,"step-button",3,"click"]],template:function(e,t){1&e&&(r._UZ(0,"svg-icon",0),r.TgZ(1,"h1"),r._uU(2),r.qZA(),r.TgZ(3,"p",1),r._uU(4),r.qZA(),r._UZ(5,"p",2),r.ALo(6,"safeHtml"),r.TgZ(7,"button",3),r.NdJ("click",function(){return t.approve()}),r._uU(8),r.ALo(9,"translate"),r.qZA()),2&e&&(r.xp6(2),r.Oqu(t.missingPaymentRegistrationSteps.temsTitle),r.xp6(2),r.Oqu(t.missingPaymentRegistrationSteps.termsSubtitle),r.xp6(1),r.Q6J("innerHTML",r.lcZ(6,4,t.termsText),r.oJD),r.xp6(3),r.Oqu(r.lcZ(9,6,"action_confirm")))},directives:[d.bk,u.m],pipes:[g.z,f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-terms-of-use{text-align:center;display:flex;flex-direction:column;flex-grow:1;padding:0 22px}mv-terms-of-use .hero-tod-image{width:320px;height:170px}mv-terms-of-use h1{margin-top:20px;font-size:1.2941176471rem;letter-spacing:-.0188235294rem;line-height:1.27;color:#292a30;font-weight:bold}mv-terms-of-use p{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-terms-of-use p.sign-up-text{flex-grow:1;color:#525357}mv-terms-of-use p.terms-text{color:#7a7c7f}mv-terms-of-use p.terms-text a{color:#0a73eb;text-decoration:underline}mv-terms-of-use .step-button{margin:14px 0 24px;font-weight:500}\n"],encapsulation:2}),e})();var y=n(53448),b=n(1437),_=n(21090),T=n(85573),S=n(90248);function x(e,t){1&e&&(r.TgZ(0,"p",17),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"payment_registration_enter_email_invalid_message")," "))}function w(e,t){if(1&e&&(r.TgZ(0,"div",5),r.YNc(1,x,3,3,"p",6),r._UZ(2,"input",15),r.ALo(3,"translate"),r.TgZ(4,"label",16),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.hasError("email")),r.xp6(1),r.uIk("aria-label",r.lcZ(3,3,"payment_registration_enter_email_title")),r.xp6(3),r.Oqu(r.lcZ(6,5,"payment_registration_enter_email_title"))}}function k(e,t){1&e&&(r.TgZ(0,"p",17),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"web_login_first_name_error")," "))}function M(e,t){1&e&&(r.TgZ(0,"p",17),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"web_login_last_name_error")," "))}function L(e,t){1&e&&(r.TgZ(0,"div",18),r._UZ(1,"svg-icon",19),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,1,"payment_general_error_message")))}function A(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"registration_continue")))}function I(e,t){1&e&&r._UZ(0,"mv-spinner")}let E=(()=>{class e{constructor(e,t,n,i,r,o){this.fb=e,this.dialogService=t,this.accountService=n,this.analytics=i,this.userActions=r,this.store=o}get state(){return this.store.getState()}ngOnInit(){const e={firstName:["",[y.kI.required,y.kI.minLength(2)]],lastName:["",[y.kI.required,y.kI.minLength(2)]]};this.showEmailField&&(e.email=["",[y.kI.required,y.kI.email]]),this.detailsForm=this.fb.group(e),this.detailsForm.valueChanges.subscribe(()=>this.clientError=!1),this.analytics.trackAccount(b.a.PersonalDetailsScreen,"impression")}hasError(e){return this.clientError&&this.detailsForm.controls[e].invalid}onFinishClick(){return(0,p.mG)(this,void 0,void 0,function*(){if(this.detailsForm.invalid)this.clientError=!0;else try{this.isLoading=!0,this.serverError=!1,yield this.accountService.setInfo(this.state.user.account.userKey,Object.assign({},this.detailsForm.value)),this.state.user.accountStep.step===i.N5.PersonalDetails?yield this.store.dispatch(this.userActions.postPersonalDetailsStep(Object.assign(Object.assign({},this.detailsForm.value),{userKey:this.state.user.accountStep.data.userKey,phoneNumber:this.state.user.accountStep.data.callingCode+this.state.user.accountStep.data.phoneNumber}))):(this.detailsForm.value.email&&this.store.dispatch(this.userActions.popMissingRegistrationStep(i.SD.EMAIL)),(this.detailsForm.value.firstName||this.detailsForm.value.lastName)&&this.store.dispatch(this.userActions.popMissingRegistrationStep(i.SD.NAME))),this.analytics.trackAccount(b.a.PersonalDetailsScreen,"personal details submitted","1")}catch(e){this.serverError=!0,this.analytics.trackAccount(b.a.PersonalDetailsScreen,"personal details submitted","0")}finally{this.isLoading=!1}})}get showEmailField(){var e;return this.state.user.accountStep.step===i.N5.PersonalDetails||(null===(e=this.state.user.missingSteps)||void 0===e?void 0:e.missingSteps.includes(i.SD.EMAIL))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.qu),r.Y36(_.x),r.Y36(T.B),r.Y36(b.y),r.Y36(h.E),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-user-details"]],decls:30,vars:26,consts:[[1,"step-text"],[1,"titles-wrapper"],["src","images/registration/spot-web-registration-details.svg"],[1,"personal-details-fields",3,"formGroup"],["class","field-row",4,"ngIf"],[1,"field-row"],["class","error-text",4,"ngIf"],["formControlName","firstName","id","first-name","type","text",1,"account-input"],["for","first-name"],["formControlName","lastName","id","last-name","type","text",1,"account-input"],["for","last-name"],[1,"step-bottom"],["class","server-error",4,"ngIf"],[1,"step-button",3,"disabled","click"],[4,"ngIf"],["formControlName","email","id","email","type","email",1,"account-input"],["for","email"],[1,"error-text"],[1,"server-error"],["src","images/icons/alert-empty.svg"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"h3"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"p"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r._UZ(8,"svg-icon",2),r.qZA(),r.TgZ(9,"form",3),r.YNc(10,w,7,7,"div",4),r.TgZ(11,"div",5),r.YNc(12,k,3,3,"p",6),r._UZ(13,"input",7),r.ALo(14,"translate"),r.TgZ(15,"label",8),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.qZA(),r.TgZ(18,"div",5),r.YNc(19,M,3,3,"p",6),r._UZ(20,"input",9),r.ALo(21,"translate"),r.TgZ(22,"label",10),r._uU(23),r.ALo(24,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(25,"div",11),r.YNc(26,L,5,3,"div",12),r.TgZ(27,"button",13),r.NdJ("click",function(){return t.onFinishClick()}),r.YNc(28,A,3,3,"span",14),r.YNc(29,I,1,0,"mv-spinner",14),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,14,"web_login_new_account_title")),r.xp6(3),r.Oqu(r.lcZ(7,16,"web_login_new_account_subtitle")),r.xp6(3),r.Q6J("formGroup",t.detailsForm),r.xp6(1),r.Q6J("ngIf",t.showEmailField),r.xp6(2),r.Q6J("ngIf",t.hasError("firstName")),r.xp6(1),r.uIk("aria-label",r.lcZ(14,18,"payment_registration_enter_name_first_name_hint")),r.xp6(3),r.Oqu(r.lcZ(17,20,"payment_registration_enter_name_first_name_hint")),r.xp6(3),r.Q6J("ngIf",t.hasError("lastName")),r.xp6(1),r.uIk("aria-label",r.lcZ(21,22,"payment_registration_enter_name_last_name_hint")),r.xp6(3),r.Oqu(r.lcZ(24,24,"payment_registration_enter_name_last_name_hint")),r.xp6(3),r.Q6J("ngIf",t.serverError),r.xp6(1),r.Q6J("disabled",t.isLoading||!t.detailsForm.dirty),r.xp6(1),r.Q6J("ngIf",!t.isLoading),r.xp6(1),r.Q6J("ngIf",t.isLoading))},directives:[d.bk,y._Y,y.JL,y.sg,a.O5,y.Fj,y.JJ,y.u,S.O],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-user-details{display:flex;flex-direction:column;padding:0 22px;height:100%}html body.mobile mv-user-details{margin-top:0}html.privacy-notice body.mobile mv-user-details{margin-top:calc(0px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-user-details{margin-top:calc(0px + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-user-details,body[data-top-banner^=V].mobile[class*=c_4908] mv-user-details,body[data-top-banner^=V].mobile[class*=c_4480] mv-user-details{margin-top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-user-details,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-user-details,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-user-details{margin-top:calc(0px + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-user-details,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-user-details,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-user-details{margin-top:calc(0px + 60px + 4.7058823529rem)}}mv-user-details *{box-sizing:border-box}mv-user-details .text-wrapper p{min-height:86px}mv-user-details button.step-button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#0a73eb;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-user-details button.step-button{max-width:360px}}mv-user-details button.step-button:disabled,mv-user-details button.step-button.disabled{background-color:#bdc3c7}mv-user-details button.step-button:disabled:active,mv-user-details button.step-button.disabled:active{background-color:#bdc3c7}mv-user-details button.step-button mv-spinner{position:absolute;margin:auto;left:0;right:0;top:9px}mv-user-details button.step-button mv-spinner svg circle:first-of-type{stroke:transparent}mv-user-details button.step-button mv-spinner svg circle:last-of-type{stroke:#fff}mv-user-details .personal-details-fields{color:#7a7c7f;padding-bottom:2.8235294118rem}mv-user-details .personal-details-fields .error-text{position:absolute;top:100%}\n"],encapsulation:2}),e})();var C=(()=>{return(e=C||(C={}))[e.SPREEDLY=1]="SPREEDLY",e[e.STRIPE=2]="STRIPE",e[e.CUBIC=3]="CUBIC",e[e.ICEPAY=4]="ICEPAY",e[e.WUNDER=5]="WUNDER",e[e.BUCKAROO=6]="BUCKAROO",e[e.OPENMOVE=7]="OPENMOVE",C;var e})(),D=(()=>{return(e=D||(D={}))[e.UNKNOWN=1]="UNKNOWN",e[e.VISA=2]="VISA",e[e.MASTERCARD=3]="MASTERCARD",e[e.AMERICAN_EXPRESS=4]="AMERICAN_EXPRESS",e[e.DINERS_CLUB=5]="DINERS_CLUB",e[e.DISCOVER=6]="DISCOVER",e[e.JCB=7]="JCB",e[e.MAESTRO=8]="MAESTRO",e[e.UNIONPAY=9]="UNIONPAY",e[e.VPAY=10]="VPAY",e[e.VISA_ELECTRON=11]="VISA_ELECTRON",e[e.CARTE_BLEUE=12]="CARTE_BLEUE",e[e.CARTE_BANCAIRE=13]="CARTE_BANCAIRE",e[e.DANKORT=14]="DANKORT",e[e.NEXI=15]="NEXI",D;var e})(),P=(()=>{return(e=P||(P={})).AccountInactive="errors.account_inactive",e.EnvironmentKeyParameterRequired="errors.environment_key_parameter_required",e.InvalidEnvironmentKeyParameter="errors.invalid_environment_key_parameter",e.Blank="errors.blank",e.Invalid="errors.invalid",e.BlankCardType="errors.blank_card_type",e.Expired="errors.expired",e.UnknownReferrer="errors.unknown_referrer",e.InvalidReferrer="errors.invalid_referrer",e.Configuration="errors.configuration",P;var e})();const O={[C.SPREEDLY]:class{constructor(e){this.provider=e,this.cardTypeMap={american_express:D.AMERICAN_EXPRESS,diners_club:D.DINERS_CLUB,discover:D.DISCOVER,jcb:D.JCB,maestro:D.MAESTRO,master:D.MASTERCARD,visa:D.VISA}}get endpoint(){return`https://core.spreedly.com/v1/payment_methods.json?environment_key=${this.provider.serverKey}`}mapFields(e){return{payment_method:Object.assign({credit_card:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({full_name:e.fullName,number:e.cardNumber,month:e.expiryMonth,year:e.expiryYear,verification_value:e.cvv},e.addressLine1&&{address1:e.addressLine1}),e.addressLine2&&{address2:e.addressLine2}),e.city&&{city:e.city}),e.country&&{country:e.country}),e.zip&&{zip:e.zip})},e.id&&{metadata:{card_holder_id:e.id}})}}mapCardType(e){return this.cardTypeMap[e]||D.UNKNOWN}mapResponse(e){const t=e.transaction.payment_method;return{provider:this.provider.type,paymentMethodToken:t.token,paymentMethod:{cardPreview:{cardType:this.mapCardType(t.card_type),lastDigits:t.last_four_digits,cardMonthExpiration:t.month.toString(),cardYearExpiration:t.year.toString()}}}}mapErrors(e,t){return e.map(e=>{switch(e.key){case P.Invalid:case P.Blank:return{erroredAttribute:t[e.attribute]};case P.BlankCardType:return{erroredAttribute:t.number};case P.Expired:return{erroredAttribute:t.month};default:return{erroredAttribute:null}}})}submit(e,t){return(0,p.mG)(this,void 0,void 0,function*(){const n=yield(yield fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(this.mapFields(e))})).json();if(n.errors)throw this.mapErrors(n.errors,t);return this.mapResponse(n)})}}};class N{constructor(e){this.creditCardInstructions=e,this.adapter=new(0,O[e.clearanceProvider.type])(e.clearanceProvider)}submit(e,t){return this.adapter.submit(e,t)}}const R={cardType:D.UNKNOWN,numOfDigits:16,imagePath:"images/registration/credit-cards/payment_method_default.svg"};function $(e,t){for(const n of t.ranges)if(n.end){const t=n.start.toString().length;if(e.length<t)return!1;const i=Number(e.substr(0,t));if(i>=n.start&&i<=n.end)return!0}else if(e.startsWith(n.start.toString()))return!0;return!1}const Y=[{cardType:D.VISA,numOfDigits:19,imagePath:"images/registration/credit-cards/visa.svg",ranges:[{start:4}]},{cardType:D.VPAY,numOfDigits:19,imagePath:"images/registration/credit-cards/visa.svg",ranges:[{start:4}]},{cardType:D.AMERICAN_EXPRESS,numOfDigits:15,imagePath:"images/registration/credit-cards/american_express.svg",ranges:[{start:34},{start:37}]},{cardType:D.MASTERCARD,numOfDigits:16,imagePath:"images/registration/credit-cards/mastercard.svg",ranges:[{start:51,end:55},{start:222100,end:272099}]},{cardType:D.DINERS_CLUB,numOfDigits:14,imagePath:"images/registration/credit-cards/diners_club.svg",ranges:[{start:36},{start:38,end:39},{start:309},{start:300,end:305}]},{cardType:D.DISCOVER,numOfDigits:16,imagePath:"images/registration/credit-cards/discover.svg",ranges:[{start:65},{start:644,end:649},{start:6011},{start:622126,end:622925}]},{cardType:D.JCB,numOfDigits:16,imagePath:"images/registration/credit-cards/jcb.svg",ranges:[{start:3528,end:3589}]},{cardType:D.UNIONPAY,numOfDigits:19,imagePath:"images/registration/credit-cards/unionpay.svg",ranges:[{start:62}]},{cardType:D.MAESTRO,numOfDigits:19,imagePath:"images/registration/credit-cards/maestro.svg",ranges:[{start:5e5,end:509999},{start:56e4,end:589999},{start:6e5,end:699999}]}];var F=n(86781);function B(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"credit_card_details_error")))}function U(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"payment_registration_enter_credit_card_invalid_expiration")))}function Z(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"cvv_error")))}function j(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"credit_card_holder_name_error")))}function V(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"credit_card_holder_id_error")))}function H(e,t){if(1&e&&(r.TgZ(0,"div",7),r._UZ(1,"input",26),r.TgZ(2,"label",27),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.YNc(5,V,3,3,"p",12),r.qZA()),2&e){const e=r.oxw();r.ekj("error",e.hasError("cardHolderId")),r.xp6(3),r.Oqu(r.lcZ(4,4,"credit_card_holder_id_label")),r.xp6(2),r.Q6J("ngIf",e.hasError("cardHolderId"))}}function G(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"payment_street_line_1_error")))}function z(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"payment_city_error")))}function q(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"p",28),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",7),r._UZ(5,"input",29),r.TgZ(6,"label",30),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.YNc(9,G,3,3,"p",12),r.qZA(),r.TgZ(10,"div",7),r._UZ(11,"input",31),r.TgZ(12,"label",32),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.TgZ(15,"div",7),r._UZ(16,"input",33),r.TgZ(17,"label",34),r._uU(18),r.ALo(19,"translate"),r.qZA(),r.YNc(20,z,3,3,"p",12),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,12,"payment_billing_address")),r.xp6(2),r.ekj("error",e.hasError("addressLine1")),r.xp6(3),r.Oqu(r.lcZ(8,14,"payment_street_line_1")),r.xp6(2),r.Q6J("ngIf",e.hasError("addressLine1")),r.xp6(1),r.ekj("error",e.hasError("addressLine2")),r.xp6(3),r.Oqu(r.lcZ(14,16,"payment_street_line_2")),r.xp6(2),r.ekj("error",e.hasError("city")),r.xp6(3),r.Oqu(r.lcZ(19,18,"payment_city")),r.xp6(2),r.Q6J("ngIf",e.hasError("city"))}}function J(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"credit_card_country_code_error")))}function W(e,t){if(1&e&&(r.TgZ(0,"div",7),r._UZ(1,"input",35),r.TgZ(2,"label",36),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.YNc(5,J,3,3,"p",12),r.qZA()),2&e){const e=r.oxw();r.ekj("error",e.hasError("countryCode")),r.xp6(3),r.Oqu(r.lcZ(4,4,"credit_card_country_code_label")),r.xp6(2),r.Q6J("ngIf",e.hasError("countryCode"))}}function Q(e,t){1&e&&(r.TgZ(0,"p",25),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"payment_registration_enter_zip_code_error")))}function K(e,t){if(1&e&&(r.TgZ(0,"div",7),r._UZ(1,"input",37),r.TgZ(2,"label",38),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.YNc(5,Q,3,3,"p",12),r.qZA()),2&e){const e=r.oxw();r.ekj("error",e.hasError("postalCode")),r.xp6(3),r.Oqu(r.lcZ(4,4,"credit_card_postal_code_label")),r.xp6(2),r.Q6J("ngIf",e.hasError("postalCode"))}}function X(e,t){1&e&&(r.TgZ(0,"div",39),r._UZ(1,"svg-icon",40),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,1,"payment_general_error_message")))}function ee(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"done")))}function te(e,t){1&e&&r._UZ(0,"mv-spinner")}const ne=(0,F.hu)("CreditCardComponent");let ie=(()=>{class e{constructor(e,t,n,i){this.fb=e,this.accountService=t,this.userActions=n,this.store=i,this.MAX_EXPIRATION_INPUT_LENGTH=5,this.creditCardConfig=R,this.fieldsWithServerError={};const r={cardNumber:["",[y.kI.required,y.kI.minLength(14)]],expiration:["",[y.kI.required,this.invalidExpiration]],cvv:["",[y.kI.required,y.kI.minLength(3)]],holderName:["",[y.kI.required,y.kI.minLength(2)]]};this.extraRequiredFields.cardHolderId&&(r.cardHolderId=["",[y.kI.required,y.kI.minLength(2)]]),this.extraRequiredFields.billingAddress&&(r.addressLine1=["",[y.kI.required,y.kI.minLength(2)]],r.addressLine2=[""],r.city=["",[y.kI.required,y.kI.minLength(2)]]),this.extraRequiredFields.countryCode&&(r.countryCode=["",[y.kI.required,y.kI.minLength(2)]]),this.extraRequiredFields.postalCode&&(r.postalCode=["",[y.kI.required,y.kI.minLength(2)]]),this.creditCardForm=this.fb.group(r)}ngOnInit(){this.creditCardForm.valueChanges.subscribe(()=>{this.clientError=!1,this.generalServerError=!1,this.fieldsWithServerError={}})}get state(){return this.store.getState()}get extraRequiredFields(){return this.state.user.missingSteps.creditCardInstructions.extraRequiredFields}invalidExpiration(e){const t=e.value,n=t.match(/^(0[1-9]|1[0-2])\/?([0-9]{2})$/);if(n){const e=n[1],i=+`20${n[2]}`,r=new Date,o=new Date;return o.setFullYear(i,e,1),o>r?null:{expiration:t}}return{expiration:t}}hasError(e){return this.clientError&&this.creditCardForm.controls[e].invalid||this.fieldsWithServerError[e]}onFinishClick(){return(0,p.mG)(this,void 0,void 0,function*(){if(this.creditCardForm.invalid)this.clientError=!0;else try{this.isLoading=!0,this.generalServerError=!1;const e=new N(this.state.user.missingSteps.creditCardInstructions),t={fullName:this.creditCardForm.value.holderName,cardNumber:this.creditCardForm.value.cardNumber.replaceAll(" ",""),expiryMonth:Number(this.creditCardForm.value.expiration.substr(0,2)),expiryYear:Number("20"+this.creditCardForm.value.expiration.substr(3,5)),cvv:this.creditCardForm.value.cvv,id:this.creditCardForm.value.cardHolderId,addressLine1:this.creditCardForm.value.addressLine1,addressLine2:this.creditCardForm.value.addressLine2,city:this.creditCardForm.value.city,country:this.creditCardForm.value.countryCode,zip:this.creditCardForm.value.postalCode},n={number:"cardNumber",month:"expiration",year:"expiration",verification_value:"cvv",full_name:"holderName",card_holder_id:"cardHolderId",address1:"addressLine1",address2:"addressLine2",city:"city",country:"countryCode",zip:"postalCode"},r=yield e.submit(t,n);yield this.accountService.addPaymentMethod(r.provider,r.paymentMethodToken,r.paymentMethod,!0,this.state.user.missingSteps.paymentContext),this.store.dispatch(this.userActions.popMissingRegistrationStep(i.SD.CREDIT_CARD))}catch(e){try{for(const t of e)t.erroredAttribute&&(this.fieldsWithServerError[t.erroredAttribute]=!0);0===Object.keys(this.fieldsWithServerError).length&&(this.generalServerError=!0)}catch(t){this.generalServerError=!0}ne.error("onFinishClick: Error occurred")}finally{this.isLoading=!1}})}formatExpirationDate(e){if(this.creditCardForm.get("expiration")){const t=this.creditCardForm.get("expiration").value.replace(/[^\d]/g,"");"Backspace"!==e.key&&2===t.length&&this.creditCardForm.controls.expiration.setValue(t+"/")}}setCreditCardType(e){if(e.toString().length>6)return;let t=!1;for(const n of Y)if($(e.toString(),n)){this.creditCardConfig=n,t=!0;break}t||(this.creditCardConfig=R)}getMaxCreditCardLength(){return this.creditCardConfig.numOfDigits+Math.ceil(this.creditCardConfig.numOfDigits/4)-1}formatCreditCardNumber(e){const t=this.creditCardForm.get("cardNumber").value.replace(/[^\d]/g,"");if("Backspace"!==e.key){const e=t.replace(/(.{4})/g,"$1 ");t.length===this.creditCardConfig.numOfDigits&&e.trim(),this.creditCardForm.controls.cardNumber.setValue(e)}this.setCreditCardType(t)}clearCardTrailingSpaces(){this.creditCardForm.controls.cardNumber.setValue(this.creditCardForm.get("cardNumber").value.trim())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.qu),r.Y36(T.B),r.Y36(h.E),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-credit-card"]],decls:55,vars:51,consts:[[1,"padded-wrapper"],[1,"step-text"],[1,"titles-wrapper"],["src","images/registration/spot-web-registration-card.svg"],[1,"card-secure-text"],["src","images/registration/lock-16-dp-good.svg",1,"lock-icon"],["autocomplete","off",1,"personal-details-fields",3,"formGroup"],[1,"field-row"],[1,"credit-card-input-wrapper","account-input"],[1,"credit-card-logo",3,"src"],["formControlName","cardNumber","id","card-number",3,"maxlength","placeholder","keyup","blur"],["for","card-number"],["class","error-text",4,"ngIf"],[1,"fields-wrapper"],["formControlName","expiration","id","expiration",1,"account-input",3,"maxlength","placeholder","keyup"],["for","expiration"],["formControlName","cvv","id","cvv","minlength","3","maxlength","4","placeholder","000",1,"account-input"],["for","cvv"],["formControlName","holderName","id","holder-name","type","text",1,"account-input"],["for","holder-name"],["class","field-row",3,"error",4,"ngIf"],[4,"ngIf"],[1,"step-bottom"],["class","server-error",4,"ngIf"],[1,"step-button",3,"disabled","click"],[1,"error-text"],["formControlName","cardHolderId","id","card-holder-id","type","text",1,"account-input"],["for","card-holder-id"],["for","billing-address"],["formControlName","addressLine1","id","address-line-1","type","text",1,"account-input"],["for","address-line-1"],["formControlName","addressLine2","id","address-Line-2","type","text",1,"account-input"],["for","address-Line-2"],["formControlName","city","id","city","type","text",1,"account-input"],["for","city"],["formControlName","countryCode","id","country-code","type","text",1,"account-input"],["for","country-code"],["formControlName","postalCode","id","postal-code","type","text",1,"account-input"],["for","postal-code"],[1,"server-error"],["src","images/icons/alert-empty.svg"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h3"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"p"),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.qZA(),r._UZ(9,"svg-icon",3),r.qZA(),r.TgZ(10,"div",4),r._UZ(11,"svg-icon",5),r.TgZ(12,"span"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.TgZ(15,"form",6),r.TgZ(16,"div",7),r.TgZ(17,"div",8),r._UZ(18,"svg-icon",9),r.TgZ(19,"input",10),r.NdJ("keyup",function(e){return t.formatCreditCardNumber(e)})("blur",function(){return t.clearCardTrailingSpaces()}),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.TgZ(21,"label",11),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.YNc(24,B,3,3,"p",12),r.qZA(),r.TgZ(25,"div",13),r.TgZ(26,"div",7),r.TgZ(27,"input",14),r.NdJ("keyup",function(e){return t.formatExpirationDate(e)}),r.ALo(28,"translate"),r.qZA(),r.TgZ(29,"label",15),r._uU(30),r.ALo(31,"translate"),r.qZA(),r.YNc(32,U,3,3,"p",12),r.qZA(),r.TgZ(33,"div",7),r._UZ(34,"input",16),r.TgZ(35,"label",17),r._uU(36),r.ALo(37,"translate"),r.qZA(),r.YNc(38,Z,3,3,"p",12),r.qZA(),r.qZA(),r.TgZ(39,"div",7),r._UZ(40,"input",18),r.TgZ(41,"label",19),r._uU(42),r.ALo(43,"translate"),r.qZA(),r.YNc(44,j,3,3,"p",12),r.qZA(),r.YNc(45,H,6,6,"div",20),r.YNc(46,q,21,20,"div",21),r.TgZ(47,"div"),r.YNc(48,W,6,6,"div",20),r.YNc(49,K,6,6,"div",20),r.qZA(),r.qZA(),r.qZA(),r.TgZ(50,"div",22),r.YNc(51,X,5,3,"div",23),r.TgZ(52,"button",24),r.NdJ("click",function(){return t.onFinishClick()}),r.YNc(53,ee,3,3,"span",21),r.YNc(54,te,1,0,"mv-spinner",21),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Oqu(r.lcZ(5,33,"payment_my_account_add_title")),r.xp6(3),r.Oqu(r.lcZ(8,35,"payment_my_account_add_subtitle")),r.xp6(6),r.Oqu(r.lcZ(14,37,"payment_details_secure")),r.xp6(2),r.Q6J("formGroup",t.creditCardForm),r.xp6(1),r.ekj("error",t.hasError("cardNumber")),r.xp6(2),r.Q6J("src",t.creditCardConfig.imagePath),r.xp6(1),r.s9C("placeholder",r.lcZ(20,39,"credit_card_number_placeholder")),r.Q6J("maxlength",t.getMaxCreditCardLength()),r.xp6(3),r.Oqu(r.lcZ(23,41,"credit_card_details_label")),r.xp6(2),r.Q6J("ngIf",t.hasError("cardNumber")),r.xp6(2),r.ekj("error",t.hasError("expiration")),r.xp6(1),r.s9C("placeholder",r.lcZ(28,43,"credit_card_exp_placeholder")),r.Q6J("maxlength",t.MAX_EXPIRATION_INPUT_LENGTH),r.xp6(3),r.Oqu(r.lcZ(31,45,"payment_registtation_enter_credit_card_expiration ")),r.xp6(2),r.Q6J("ngIf",t.hasError("expiration")),r.xp6(1),r.ekj("error",t.hasError("cvv")),r.xp6(3),r.Oqu(r.lcZ(37,47,"payment_registrations_enter_credit_card_cvv")),r.xp6(2),r.Q6J("ngIf",t.hasError("cvv")),r.xp6(1),r.ekj("error",t.hasError("holderName")),r.xp6(3),r.Oqu(r.lcZ(43,49,"credit_card_holder_name_label")),r.xp6(2),r.Q6J("ngIf",t.hasError("holderName")),r.xp6(1),r.Q6J("ngIf",t.extraRequiredFields.cardHolderId),r.xp6(1),r.Q6J("ngIf",t.extraRequiredFields.billingAddress),r.xp6(2),r.Q6J("ngIf",t.extraRequiredFields.countryCode),r.xp6(1),r.Q6J("ngIf",t.extraRequiredFields.postalCode),r.xp6(2),r.Q6J("ngIf",t.generalServerError),r.xp6(1),r.Q6J("disabled",t.isLoading||!t.creditCardForm.dirty),r.xp6(1),r.Q6J("ngIf",!t.isLoading),r.xp6(1),r.Q6J("ngIf",t.isLoading))},directives:[d.bk,y._Y,y.JL,y.sg,y.Fj,y.JJ,y.u,y.nD,a.O5,y.wO,S.O],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-credit-card .padded-wrapper{padding:0 22px}mv-credit-card .step-text .titles-wrapper p{padding-bottom:24px}mv-credit-card .credit-card-input-wrapper{display:flex;padding:0}html[dir=ltr] mv-credit-card .credit-card-input-wrapper .credit-card-logo{padding-left:12px}html[dir=rtl] mv-credit-card .credit-card-input-wrapper .credit-card-logo{padding-right:12px}mv-credit-card .credit-card-input-wrapper input{width:100%;flex-grow:1;border:none;font-size:.9411764706rem;outline:none;padding:0 12px}mv-credit-card .card-secure-text{display:inline-flex;align-items:center;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#038844;font-weight:600}mv-credit-card .card-secure-text .lock-icon{width:.9411764706rem;height:.9411764706rem}html[dir=ltr] mv-credit-card .card-secure-text .lock-icon{margin-right:7px}html[dir=rtl] mv-credit-card .card-secure-text .lock-icon{margin-left:7px}mv-credit-card .personal-details-fields{padding:48px 0 69px;margin-top:12px;border-top:1px solid #ECF0F1}mv-credit-card .personal-details-fields>.field-row:last-of-type{margin-bottom:48px}mv-credit-card .personal-details-fields .fields-wrapper{margin-bottom:12px}mv-credit-card .personal-details-fields .fields-wrapper .field-row{width:calc(50% - 8px)}mv-credit-card .personal-details-fields .fields-wrapper .field-row input{width:auto}html[dir=ltr] mv-credit-card .personal-details-fields .fields-wrapper .field-row:first-of-type{margin-right:8px}html[dir=rtl] mv-credit-card .personal-details-fields .fields-wrapper .field-row:first-of-type{margin-left:8px}html[dir=ltr] mv-credit-card .personal-details-fields .fields-wrapper .field-row:last-of-type{margin-left:8px}html[dir=rtl] mv-credit-card .personal-details-fields .fields-wrapper .field-row:last-of-type{margin-right:8px}mv-credit-card .personal-details-fields .field-row label,mv-credit-card .personal-details-fields .field-row input{display:block}mv-credit-card .personal-details-fields .field-row .error-text{position:absolute;top:100%}mv-credit-card .personal-details-fields .field-row.error .credit-card-input-wrapper,mv-credit-card .personal-details-fields .field-row.error>.account-input{box-shadow:inset 0 0 0 2px #e10c32;border-color:transparent;transition:.2s ease-in}mv-credit-card .personal-details-fields input#card-number{direction:ltr}html[dir=rtl] mv-credit-card .personal-details-fields input#card-number{text-align:right}mv-credit-card .step-bottom .step-button:disabled{color:#fff;background-color:#bdc3c7}\n"],encapsulation:2}),e})();function re(e,t){1&e&&r._UZ(0,"mv-terms-of-use")}function oe(e,t){1&e&&r._UZ(0,"mv-user-details")}function ae(e,t){1&e&&r._UZ(0,"mv-credit-card")}let se=(()=>{class e{constructor(e,t,n){this.store=e,this.routingService=t,this.canonicalService=n,this.MVPaymentRegistrationStep=i.SD}ngOnInit(){}get state(){return this.store.getState()}get missingSteps(){return this.state.user.missingSteps}get currentMissingStep(){var e;const t=null===(e=this.missingSteps)||void 0===e?void 0:e.missingSteps;return t.includes(i.SD.TERMS_OF_USE)?i.SD.TERMS_OF_USE:t.includes(i.SD.NAME)?i.SD.NAME:t.includes(i.SD.EMAIL)?i.SD.EMAIL:t.includes(i.SD.CREDIT_CARD)?i.SD.CREDIT_CARD:void 0}onBack(){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],s.zA.TOD_RIDE_ORDER))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.d),r.Y36(l.Z),r.Y36(c.z))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-missing-steps-handler"]],decls:7,vars:6,consts:[[1,"step-back"],[1,"back-button",3,"click"],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",1,"back-icon",3,"titleText"],[4,"ngIf"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.onBack()}),r._UZ(2,"svg-icon",2),r.ALo(3,"translate"),r.qZA(),r.qZA(),r.YNc(4,re,1,0,"mv-terms-of-use",3),r.YNc(5,oe,1,0,"mv-user-details",3),r.YNc(6,ae,1,0,"mv-credit-card",3)),2&e&&(r.xp6(2),r.s9C("titleText",r.lcZ(3,4,"action_previous")),r.xp6(2),r.Q6J("ngIf",t.currentMissingStep===t.MVPaymentRegistrationStep.TERMS_OF_USE),r.xp6(1),r.Q6J("ngIf",t.currentMissingStep===t.MVPaymentRegistrationStep.NAME||t.currentMissingStep===t.MVPaymentRegistrationStep.EMAIL),r.xp6(1),r.Q6J("ngIf",t.currentMissingStep===t.MVPaymentRegistrationStep.CREDIT_CARD))},directives:[d.bk,u.m,a.O5,v,E,ie],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-missing-steps-handler{display:flex;flex-direction:column;height:100%}mv-missing-steps-handler .step-back{padding:0 22px}mv-missing-steps-handler .step-back .back-icon{width:9px;padding:16px 0 12px}mv-missing-steps-handler .step-back .back-icon svg{transform:scaleX(-1)}html[dir=ltr] mv-missing-steps-handler .step-back .back-icon svg{transform:scaleX(-1)}html[dir=rtl] mv-missing-steps-handler .step-back .back-icon svg{transform:scaleX(1)}mv-missing-steps-handler .step-back .back-icon svg polygon{fill:#525357}\n"],encapsulation:2}),e})();var le=n(40882),ce=n(52959);function de(e,t){return e.countryName!==t.countryName?e.countryName>t.countryName?1:-1:0}const ue=/^[a-z]{2}$/i;function pe(e){if(ue.test(e))return String.fromCodePoint(...[...e.toUpperCase()].map(e=>e.charCodeAt()+127397))}const he={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};var me=n(71570),ge=n(1238);function fe(e,t){if(1&e&&(r.TgZ(0,"option",17),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("ngValue",e),r.xp6(1),r.AsE(" ",e.countryName," (+",e.dialingCode,") ")}}function ve(e,t){1&e&&(r.TgZ(0,"p",18),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"payment_registration_enter_phone_number_invalid_message")," "))}function ye(e,t){1&e&&(r.TgZ(0,"div",19),r._UZ(1,"svg-icon",20),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,1,"payment_general_error_message")))}function be(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"action_next")))}function _e(e,t){1&e&&r._UZ(0,"mv-spinner")}const Te=le.PhoneNumberUtil.getInstance();let Se=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.document=e,this.sanitizer=t,this.translate=n,this.routingService=i,this.analytics=r,this.globalActions=o,this.userActions=a,this.store=s,this.countries=[],this.phoneNumber=new y.NI("",[y.kI.required,this.phoneNumberValidator.bind(this)]),this.countries=function(){const e=[];return Object.entries(le.metadata.countryCodeToRegionCodeMap).forEach(t=>{t[1].forEach(n=>{const i=he[n];i&&e.push({countryName:i,countryCode:n,dialingCode:t[0],flag:pe(n)})})}),e||[]}().sort(de)}get state(){return this.store.getState()}get phoneNumberError(){return this.clientError&&this.phoneNumber.value&&!!this.phoneNumber.errors}ngOnInit(){return(0,p.mG)(this,void 0,void 0,function*(){yield(0,ce.p5)(this.store),this.tosHtml=this.generateTosHtml();const e=this.state.metro.currentMetro.countryCode,t=this.countries.find(t=>t.countryCode===e);t&&(this.selectedCountry=t),this.phoneNumber.valueChanges.subscribe(()=>this.clientError=!1),this.analytics.trackAccount(b.a.PhoneScreen,"impression")})}ngAfterViewInit(){var e;null===(e=this.document.getElementById("phone-number"))||void 0===e||e.focus()}generateTosHtml(){const e=this.translate.instant("terms_and_service_text_link"),t=this.translate.instant("terms_of_use_url");return this.sanitizer.bypassSecurityTrustHtml(this.translate.instant("web_login_terms_privacy",{LINK:`<a href="${t}" target="_blank">${e}</a>`}))}phoneNumberValidator(e){try{const t=String(e.value);if(t.length<4)return{invalidNumber:!0};const n=Te.parse(t,this.selectedCountry.countryCode);return Te.isValidNumber(n)?null:{invalidNumber:!0}}catch(t){}return null}onCountryChange(){this.analytics.trackAccount(b.a.PhoneScreen,"geo code selected",`+${this.selectedCountry.dialingCode}`)}onTosClick(){this.analytics.trackAccount(b.a.PhoneScreen,"terms and conditions clicked")}onNextClick(){return(0,p.mG)(this,void 0,void 0,function*(){if(this.phoneNumber.invalid)this.clientError=!0;else try{this.isLoading=!0,this.clientError=!1,this.serverError=!1,yield this.store.dispatch(this.userActions.authByPhoneNumber(this.selectedCountry,String(this.phoneNumber.value))),this.analytics.trackAccount(b.a.PhoneScreen,"phone number submitted","1")}catch(e){this.serverError=!0,this.analytics.trackAccount(b.a.PhoneScreen,"phone number submitted","0")}finally{this.isLoading=!1}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(me.H7),r.Y36(f.sK),r.Y36(l.Z),r.Y36(b.y),r.Y36(ge.l),r.Y36(h.E),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-phone-number"]],decls:28,vars:22,consts:[[1,"step-text"],["src","images/registration/spot-web-registration-welcome.svg"],["role","form",1,"fields-wrapper"],[1,"dial-code-box"],[1,"register-input",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"dial-code-field","register-input"],[1,"field-flag"],[1,"field-dial-code"],[1,"phone-number-field"],["id","phone-number","aria-label","Phone number","placeholder","Phone number","type","number",1,"register-input",3,"formControl"],["class","error-text",4,"ngIf"],[1,"step-bottom"],["class","server-error",4,"ngIf"],[3,"innerHTML","click"],[1,"step-button",3,"disabled","click"],[4,"ngIf"],[3,"ngValue"],[1,"error-text"],[1,"server-error"],["src","images/icons/alert-empty.svg"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div"),r.TgZ(2,"h3"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"p"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r._UZ(8,"svg-icon",1),r.qZA(),r.TgZ(9,"div",2),r.TgZ(10,"div",3),r.TgZ(11,"select",4),r.NdJ("ngModelChange",function(e){return t.selectedCountry=e})("change",function(){return t.onCountryChange()}),r.ALo(12,"translate"),r.YNc(13,fe,2,3,"option",5),r.qZA(),r.TgZ(14,"div",6),r.TgZ(15,"span",7),r._uU(16),r.qZA(),r.TgZ(17,"span",8),r._uU(18),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"div",9),r._UZ(20,"input",10),r.YNc(21,ve,3,3,"p",11),r.qZA(),r.qZA(),r.TgZ(22,"div",12),r.YNc(23,ye,5,3,"div",13),r.TgZ(24,"p",14),r.NdJ("click",function(){return t.onTosClick()}),r.qZA(),r.TgZ(25,"button",15),r.NdJ("click",function(){return t.onNextClick()}),r.YNc(26,be,3,3,"span",16),r.YNc(27,_e,1,0,"mv-spinner",16),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,16,"web_login_welcome")),r.xp6(3),r.Oqu(r.lcZ(7,18,"web_login_mobile_add")),r.xp6(5),r.Q6J("ngModel",t.selectedCountry),r.uIk("aria-label",r.lcZ(12,20,"web_choose_country_title")),r.xp6(2),r.Q6J("ngForOf",t.countries),r.xp6(3),r.Oqu(null==t.selectedCountry?null:t.selectedCountry.flag),r.xp6(2),r.hij("+",null==t.selectedCountry?null:t.selectedCountry.dialingCode,""),r.xp6(2),r.ekj("error",t.phoneNumberError),r.Q6J("formControl",t.phoneNumber),r.xp6(1),r.Q6J("ngIf",t.phoneNumberError),r.xp6(2),r.Q6J("ngIf",t.serverError),r.xp6(1),r.Q6J("innerHTML",t.tosHtml,r.oJD),r.xp6(1),r.Q6J("disabled",t.isLoading||!t.phoneNumber.dirty),r.xp6(1),r.Q6J("ngIf",!t.isLoading),r.xp6(1),r.Q6J("ngIf",t.isLoading))},directives:[d.bk,y.EJ,y.JJ,y.On,a.sg,y.wV,y.Fj,y.oH,a.O5,y.YN,y.Kr,S.O],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-phone-number .step-text svg-icon svg{width:60px;height:49px}mv-phone-number .fields-wrapper{direction:ltr}mv-phone-number .fields-wrapper .register-input{padding:0 12px}html[dir=rtl] mv-phone-number .fields-wrapper .register-input{padding-left:15px}mv-phone-number .fields-wrapper .dial-code-box{position:relative;margin-right:8px;width:6.8235294118rem}mv-phone-number .fields-wrapper .dial-code-box .dial-code-field{display:flex;align-items:center}mv-phone-number .fields-wrapper .dial-code-box .dial-code-field:after{content:url(/images/icons/tab-arrow.svg);width:20px;transform:rotate(270deg);position:absolute}html[dir=ltr] mv-phone-number .fields-wrapper .dial-code-box .dial-code-field:after{right:3px}html[dir=rtl] mv-phone-number .fields-wrapper .dial-code-box .dial-code-field:after{left:3px}html[dir=ltr] mv-phone-number .fields-wrapper .dial-code-box .dial-code-field .field-flag{margin-right:5px}html[dir=rtl] mv-phone-number .fields-wrapper .dial-code-box .dial-code-field .field-flag{margin-left:5px}mv-phone-number .fields-wrapper .dial-code-box select{opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:2}mv-phone-number .fields-wrapper .dial-code-box select:focus+.dial-code-field{border-color:#2196f3;box-shadow:0 0 0 1px #2196f3}mv-phone-number .fields-wrapper .phone-number-field{flex-grow:1}mv-phone-number .fields-wrapper .phone-number-field .register-input{width:100%}mv-phone-number .fields-wrapper .phone-number-field::-moz-placeholder{color:#bdc3c7}mv-phone-number .fields-wrapper .phone-number-field::placeholder{color:#bdc3c7}\n"],encapsulation:2}),e})();var xe=n(98922),we=n(84608),ke=n(53399),Me=n(2281);function Le(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"label"),r.TgZ(2,"input",11),r.NdJ("focusin",function(t){return r.CHM(e),r.oxw().onFocus(t)})("keyup",function(t){const n=r.CHM(e).index;return r.oxw().onCodeChange(t.key,n)})("paste",function(t){return r.CHM(e),r.oxw().onPaste(t)}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.index,n=r.oxw();r.xp6(2),r.ekj("error",n.codeError),r.Q6J("id","code-"+e)("formControlName",e)}}function Ae(e,t){1&e&&(r.TgZ(0,"p",12),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"payment_registration_validate_phone_number_invalid_message")," "))}function Ie(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",15),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).resendCode()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"registration_phone_verification_resent_button_text")," "))}const Ee=function(e){return{param1:e}};function Ce(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",r.xi3(2,1,"payment_registration_validate_phone_number_resend_counter",r.VKq(4,Ee,e.countdownValue))," ")}}function De(e,t){if(1&e&&(r.TgZ(0,"div",13),r.YNc(1,Ie,3,3,"button",14),r.YNc(2,Ce,3,6,"span",10),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.activeCountdown),r.xp6(1),r.Q6J("ngIf",e.activeCountdown>0)}}function Pe(e,t){1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",17),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,1,"payment_general_error_message")))}function Oe(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"action_next")))}function Ne(e,t){1&e&&r._UZ(0,"mv-spinner")}const Re=le.PhoneNumberUtil.getInstance(),$e=(0,F.hu)("PhoneVerificationComponent");let Ye=(()=>{class e{constructor(e,t,n,i,r,o){this.document=e,this.fb=t,this.accountService=n,this.analytics=i,this.userActions=r,this.store=o,this.activeCountdown=-1,this.validationForm=this.fb.group({codes:this.fb.array([this.fb.control("")])}),this.countdown$=(0,xe.F)(1e3).pipe((0,we.q)(60),(0,ke.U)(e=>59-e))}get state(){return this.store.getState()}get codes(){return this.validationForm.get("codes")}ngOnInit(){this.startCountdown(),this.phoneNumber=this.formatPhoneNumber();for(let e=0;e<3;e++)this.codes.push(this.fb.control(""));this.codes.controls.forEach((e,t)=>e.valueChanges.subscribe(e=>{var n;this.codeError=!1,t>0&&null===e&&(null===(n=this.getCodeElement(t-1))||void 0===n||n.focus())})),this.analytics.trackAccount(b.a.SMSSecurityCode,"impression")}ngAfterViewInit(){var e;null===(e=this.getCodeElement(0))||void 0===e||e.focus()}ngOnDestroy(){var e;null===(e=this.countdown$sub)||void 0===e||e.unsubscribe()}onFocus(e){e.target.select()}get isInvalidCode(){const e=this.codes.getRawValue().join("");return!this.isValidCode(e)}isValidCode(e){return 4===e.length&&/^\d+$/.test(e)}get countdownValue(){return Me(this.activeCountdown,"mm").format("HH:mm")}startCountdown(){this.countdown$sub=this.countdown$.subscribe(e=>this.activeCountdown=e)}formatPhoneNumber(){var e;try{const e=Re.parseAndKeepRawInput(this.state.user.accountStep.data.phoneNumber,this.state.user.accountStep.data.countryCode);return Re.format(e,le.PhoneNumberFormat.NATIONAL)}catch(t){return null===(e=this.state.user.accountStep.data)||void 0===e?void 0:e.phoneNumber}}onCodeChange(e,t){if(isNaN(e))return;if(t<3){const e=this.getCodeElement(t+1);return void(null==e||e.focus())}const n=this.getCodeElement(t);null==n||n.blur(),this.validateCode()}onPaste(e){e.stopPropagation(),e.preventDefault();const t=e.clipboardData.getData("Text").replace(/ +?/g,"");this.isValidCode(t)&&(this.codes.controls.forEach((e,n)=>e.setValue(t[n])),this.validateCode())}getCodeElement(e){return this.document.getElementById(`code-${e}`)}validateCode(){return(0,p.mG)(this,void 0,void 0,function*(){try{this.isLoading=!0,this.codeError=!1,this.serverError=!1;const e=this.codes.getRawValue().join("");$e.log("validateCode",e);const{user:t,migratedUser:n}=yield this.accountService.verifyCode({userKey:this.state.user.accountStep.data.userKey,callingCode:this.state.user.accountStep.data.callingCode,phoneNumber:this.state.user.accountStep.data.phoneNumber},e);this.state.user.accountStep.data.newUser?yield this.store.dispatch(this.userActions.postRegisterFlow()):yield this.store.dispatch(this.userActions.postLoginFlow(t)),this.analytics.trackAccount(b.a.SMSSecurityCode,"sms code submitted","1_"+(n?1:0))}catch(e){if(this.analytics.trackAccount(b.a.SMSSecurityCode,"sms code submitted","0_0"),424===e.status)return this.codeError=!0,void this.getCodeElement(3).focus();this.serverError=!0}finally{this.isLoading=!1}})}resendCode(){return(0,p.mG)(this,void 0,void 0,function*(){if(!(this.activeCountdown>0)){this.startCountdown();try{this.serverError=!1,yield this.accountService.requestCode({userKey:this.state.user.accountStep.data.userKey,callingCode:this.state.user.accountStep.data.callingCode,phoneNumber:this.state.user.accountStep.data.phoneNumber})}catch(e){this.serverError=!0}this.analytics.trackAccount(b.a.SMSSecurityCode,"resend code clicked")}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.qu),r.Y36(T.B),r.Y36(b.y),r.Y36(h.E),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-phone-verification"]],decls:19,vars:17,consts:[[1,"step-text"],["src","images/registration/spot-web-registration-phone-confirmation.svg"],[3,"formGroup"],["formArrayName","codes",1,"fields-wrapper"],[4,"ngFor","ngForOf"],["class","error-text",4,"ngIf"],["class","resend-message",4,"ngIf"],[1,"step-bottom"],["class","server-error",4,"ngIf"],[1,"step-button",3,"disabled","click"],[4,"ngIf"],["type","number","min","0","max","9","autocomplete","off",1,"register-input",3,"id","formControlName","focusin","keyup","paste"],[1,"error-text"],[1,"resend-message"],["class","resend-sms-link",3,"click",4,"ngIf"],[1,"resend-sms-link",3,"click"],[1,"server-error"],["src","images/icons/alert-empty.svg"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div"),r.TgZ(2,"h3"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"p"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r._UZ(8,"svg-icon",1),r.qZA(),r.TgZ(9,"form",2),r.TgZ(10,"div",3),r.YNc(11,Le,3,4,"div",4),r.qZA(),r.YNc(12,Ae,3,3,"p",5),r.qZA(),r.YNc(13,De,3,2,"div",6),r.TgZ(14,"div",7),r.YNc(15,Pe,5,3,"div",8),r.TgZ(16,"button",9),r.NdJ("click",function(){return t.validateCode()}),r.YNc(17,Oe,3,3,"span",10),r.YNc(18,Ne,1,0,"mv-spinner",10),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,10,"payment_registration_validate_phone_number_title")),r.xp6(3),r.Oqu(r.xi3(7,12,"payment_registration_validate_phone_number_subtitle",r.VKq(15,Ee,t.phoneNumber))),r.xp6(3),r.Q6J("formGroup",t.validationForm),r.xp6(2),r.Q6J("ngForOf",t.codes.controls),r.xp6(1),r.Q6J("ngIf",t.codeError),r.xp6(1),r.Q6J("ngIf",-1!==t.activeCountdown),r.xp6(2),r.Q6J("ngIf",t.serverError),r.xp6(1),r.Q6J("disabled",t.isLoading||t.isInvalidCode||t.codeError),r.xp6(1),r.Q6J("ngIf",!t.isLoading),r.xp6(1),r.Q6J("ngIf",t.isLoading))},directives:[d.bk,y._Y,y.JL,y.sg,y.CE,a.sg,a.O5,y.qQ,y.Fd,y.wV,y.Fj,y.JJ,y.u,S.O],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-phone-verification .fields-wrapper .register-input{text-align:center;color:#292a30;padding:0;width:48px}html[dir=ltr] mv-phone-verification .fields-wrapper .register-input{margin-right:8px}html[dir=rtl] mv-phone-verification .fields-wrapper .register-input{margin-left:8px}html[dir=rtl] mv-phone-verification .fields-wrapper{display:inline-flex;flex-direction:row-reverse}mv-phone-verification .step-text svg-icon svg{width:58px;height:50px}mv-phone-verification .resend-message{margin-top:30px;color:#7a7c7f;letter-spacing:-.0088235294rem;font-size:.8235294118rem}mv-phone-verification .resend-sms-link{color:#2196f3;letter-spacing:-.0088235294rem;font-weight:600;font-size:.8235294118rem}\n"],encapsulation:2}),e})();function Fe(e,t){1&e&&r._UZ(0,"mv-phone-number")}function Be(e,t){1&e&&r._UZ(0,"mv-phone-verification")}let Ue=(()=>{class e{constructor(e,t,n,r){this.routingService=e,this.analytics=t,this.userActions=n,this.store=r,this.AccountStep=i.N5}get state(){return this.store.getState()}get accountStep(){return this.state.user.accountStep.step}ngOnInit(){this.accountStep||this.store.dispatch(this.userActions.setAccountStep(i.N5.PhoneNumber))}onBack(){let e;this.accountStep===i.N5.PhoneNumber?(this.store.dispatch(this.userActions.setAccountStep(null)),e=b.a.PhoneScreen,this.routingService.redirectTo("/")):this.accountStep===i.N5.PhoneVerification?(this.store.dispatch(this.userActions.setAccountStep(i.N5.PhoneNumber)),e=b.a.SMSSecurityCode):this.accountStep===i.N5.PersonalDetails&&(this.store.dispatch(this.userActions.setAccountStep(i.N5.PhoneNumber)),e=b.a.PersonalDetailsScreen),e&&this.analytics.trackAccount(e,"dismiss clicked")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(l.Z),r.Y36(b.y),r.Y36(h.E),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-auth-step-handler"]],decls:6,vars:5,consts:[[1,"step-back"],[1,"back-button",3,"click"],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",1,"back-icon",3,"titleText"],[4,"ngIf"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.onBack()}),r._UZ(2,"svg-icon",2),r.ALo(3,"translate"),r.qZA(),r.qZA(),r.YNc(4,Fe,1,0,"mv-phone-number",3),r.YNc(5,Be,1,0,"mv-phone-verification",3)),2&e&&(r.xp6(2),r.s9C("titleText",r.lcZ(3,3,"action_previous")),r.xp6(2),r.Q6J("ngIf",t.accountStep===t.AccountStep.PhoneNumber),r.xp6(1),r.Q6J("ngIf",t.accountStep===t.AccountStep.PhoneVerification))},directives:[d.bk,u.m,a.O5,Se,Ye],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container{height:100%}mv-auth-step-handler{display:flex;flex-direction:column;padding:0 22px;height:100%}html body.mobile mv-auth-step-handler{margin-top:0}html.privacy-notice body.mobile mv-auth-step-handler{margin-top:calc(0px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-auth-step-handler{margin-top:calc(0px + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-auth-step-handler,body[data-top-banner^=V].mobile[class*=c_4908] mv-auth-step-handler,body[data-top-banner^=V].mobile[class*=c_4480] mv-auth-step-handler{margin-top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-auth-step-handler,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-auth-step-handler,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-auth-step-handler{margin-top:calc(0px + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-auth-step-handler,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-auth-step-handler,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-auth-step-handler{margin-top:calc(0px + 60px + 4.7058823529rem)}}mv-auth-step-handler *{box-sizing:border-box}mv-auth-step-handler input[type=email],mv-auth-step-handler input[type=number]{direction:ltr}mv-auth-step-handler h3,mv-auth-step-handler p{margin:0}mv-auth-step-handler svg-icon{height:auto;width:auto;margin:0}mv-auth-step-handler .step-back .back-icon{width:9px;padding:16px 0 12px}mv-auth-step-handler .step-back .back-icon svg{transform:scaleX(-1)}html[dir=ltr] mv-auth-step-handler .step-back .back-icon svg{transform:scaleX(-1)}html[dir=rtl] mv-auth-step-handler .step-back .back-icon svg{transform:scaleX(1)}mv-auth-step-handler .step-back .back-icon svg polygon{fill:#525357}mv-auth-step-handler .step-text{display:flex;justify-content:space-between;margin:5px 0 0}mv-auth-step-handler .step-text h3{font-size:1.2941176471rem;line-height:1.6470588235rem;letter-spacing:.0188235294rem;margin-bottom:3px}mv-auth-step-handler .step-text p{font-size:.8235294118rem;line-height:1.0588235294rem;letter-spacing:-.0088235294rem;min-height:86px;padding-bottom:2rem}html[dir=ltr] mv-auth-step-handler .step-text svg-icon{margin-left:10px}html[dir=rtl] mv-auth-step-handler .step-text svg-icon{margin-right:10px}mv-auth-step-handler .fields-wrapper{display:flex}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-auth-step-handler .fields-wrapper{margin-bottom:1.1764705882rem}}mv-auth-step-handler .error-text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:.9411764706rem;color:#e10c32;margin-top:4px}html[dir=ltr] mv-auth-step-handler .error-text{text-align:left}html[dir=rtl] mv-auth-step-handler .error-text{text-align:right}mv-auth-step-handler .register-input{border:1px solid #BDC3C7;border-radius:4px;height:40px;font-size:.9411764706rem;background-color:#fff;transition:.2s ease-in;caret-color:#2196f3;outline:none}mv-auth-step-handler .register-input:focus{border-color:#2196f3;box-shadow:0 0 0 1px #2196f3}mv-auth-step-handler .register-input.error{border-color:#e10c32;box-shadow:0 0 0 1px #e10c32}mv-auth-step-handler .register-input::-moz-placeholder{color:#bdc3c7}mv-auth-step-handler .register-input::placeholder{color:#bdc3c7}mv-auth-step-handler .step-bottom{position:fixed;width:100%;bottom:0;left:0;text-align:center;border-top:1px solid #ECF0F1;padding:16px 22px;background-color:#fff}mv-auth-step-handler .step-bottom p{font-size:.7058823529rem;padding-bottom:16px;color:#7a7c7f}mv-auth-step-handler .step-bottom a{color:#2196f3}mv-auth-step-handler button.step-button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#2196f3;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-auth-step-handler button.step-button{max-width:360px}}mv-auth-step-handler button.step-button:disabled{background-color:#bdc3c7}mv-auth-step-handler button.step-button:disabled:active{background-color:#bdc3c7}mv-auth-step-handler button.step-button:active{background-color:#1b7fcd}mv-auth-step-handler button.step-button mv-spinner{position:absolute;margin:auto;left:0;right:0;top:9px}mv-auth-step-handler button.step-button mv-spinner svg circle:first-of-type{stroke:transparent}mv-auth-step-handler button.step-button mv-spinner svg circle:last-of-type{stroke:#fff}mv-auth-step-handler .server-error{position:absolute;bottom:100%;left:0;background-color:#292a30;color:#fff;padding:8px 22px;display:flex;align-items:center;width:100%;min-height:44px;font-size:.8235294118rem}html[dir=ltr] mv-auth-step-handler .server-error{text-align:left}html[dir=rtl] mv-auth-step-handler .server-error{text-align:right}mv-auth-step-handler .server-error svg-icon{height:23px}html[dir=ltr] mv-auth-step-handler .server-error svg-icon{margin-right:10px}html[dir=rtl] mv-auth-step-handler .server-error svg-icon{margin-left:10px}\n"],encapsulation:2}),e})();function Ze(e,t){1&e&&r._UZ(0,"mv-missing-steps-handler")}function je(e,t){1&e&&r._UZ(0,"mv-auth-step-handler")}const Ve=[{path:":lang",component:(()=>{class e{constructor(e){this.store=e}ngOnInit(){}get state(){return this.store.getState()}get user(){return this.state.user}get hasMissingSteps(){var e;return this.user.accountStatus===i.dp.Authenticated&&(null===(e=this.user.missingSteps)||void 0===e?void 0:e.missingSteps.length)>0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-account-main-view"]],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(r.YNc(0,Ze,1,0,"mv-missing-steps-handler",0),r.YNc(1,je,1,0,"mv-auth-step-handler",0)),2&e&&(r.Q6J("ngIf",t.hasMissingSteps),r.xp6(1),r.Q6J("ngIf",!t.hasMissingSteps))},directives:[a.O5,se,Ue],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container,mv-account-main-view{height:100%}mv-account-main-view{display:block}mv-account-main-view .step-text{display:flex;justify-content:space-between;margin:5px 0 0}html[dir=ltr] mv-account-main-view .step-text .titles-wrapper{padding-right:12px}html[dir=rtl] mv-account-main-view .step-text .titles-wrapper{padding-left:12px}mv-account-main-view .step-text svg-icon{height:auto;width:auto;margin:0}html[dir=ltr] mv-account-main-view .step-text svg-icon{margin-left:10px}html[dir=rtl] mv-account-main-view .step-text svg-icon{margin-right:10px}mv-account-main-view .step-text h3,mv-account-main-view .step-text p{margin:0}mv-account-main-view .step-text h3{font-size:1.2941176471rem;line-height:1.6470588235rem;letter-spacing:.0188235294rem;margin-bottom:3px}mv-account-main-view .step-text p{font-size:.8235294118rem;line-height:1.0588235294rem;letter-spacing:-.0088235294rem;padding-bottom:3.4117647059rem}mv-account-main-view .step-button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#0a73eb;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-account-main-view .step-button{max-width:360px}}mv-account-main-view .step-button:disabled,mv-account-main-view .step-button.disabled{background-color:#bdc3c7}mv-account-main-view .step-button:disabled:active,mv-account-main-view .step-button.disabled:active{background-color:#bdc3c7}mv-account-main-view input{background:none}mv-account-main-view input[type=email],mv-account-main-view inputinput[type=number]{direction:ltr}mv-account-main-view input[type=date]::-webkit-calendar-picker-indicator{display:none}mv-account-main-view .fields-wrapper{display:flex}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-account-main-view .fields-wrapper{margin-bottom:1.1764705882rem}}mv-account-main-view .account-input{border:1px solid #BDC3C7;border-radius:4px;height:40px;font-size:.9411764706rem;background-color:#fff;transition:.2s ease-in;caret-color:#2196f3;outline:none;padding:0 12px}mv-account-main-view .account-input:focus{border-color:#2196f3;box-shadow:0 0 0 1px #2196f3}mv-account-main-view .account-input.error{border-color:#e10c32;box-shadow:0 0 0 1px #e10c32}mv-account-main-view .account-input::-moz-placeholder{color:#737578}mv-account-main-view .account-input::placeholder{color:#737578}mv-account-main-view .error-text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:.9411764706rem;color:#e10c32;margin-top:4px}html[dir=ltr] mv-account-main-view .error-text{text-align:left}html[dir=rtl] mv-account-main-view .error-text{text-align:right}mv-account-main-view .field-row{display:flex;flex-direction:column-reverse;margin-bottom:56px;position:relative}mv-account-main-view .field-row.flex{display:flex;justify-content:space-between;align-items:center;flex-direction:row}mv-account-main-view .field-row.flex input{width:100%}mv-account-main-view .field-row label{font-size:.7647058824rem;line-height:.9411764706rem;letter-spacing:-.0047058824rem;margin-bottom:8px;position:absolute;top:-1.4117647059rem}mv-account-main-view .field-row .register-input{padding:10px 12px;font-size:.9411764706rem;line-height:1.1764705882rem;letter-spacing:-.0188235294rem}mv-account-main-view .field-row .register-input:focus+label{color:#2196f3}mv-account-main-view .step-bottom{position:fixed;width:100%;bottom:0;left:0;text-align:center;border-top:1px solid #ECF0F1;padding:16px 22px;background-color:#fff;box-sizing:border-box}mv-account-main-view .step-bottom p{font-size:.7058823529rem;padding-bottom:16px;color:#7a7c7f}mv-account-main-view .step-bottom a{color:#2196f3}mv-account-main-view .step-bottom mv-spinner{position:absolute;margin:auto;left:0;right:0;top:9px}mv-account-main-view .step-bottom mv-spinner svg circle:first-of-type{stroke:transparent}mv-account-main-view .step-bottom mv-spinner svg circle:last-of-type{stroke:#fff}mv-account-main-view .server-error{position:absolute;bottom:100%;left:0;background-color:#292a30;color:#fff;padding:8px 22px;display:flex;align-items:center;width:100%;min-height:44px;font-size:.8235294118rem;box-sizing:border-box}html[dir=ltr] mv-account-main-view .server-error{text-align:left}html[dir=rtl] mv-account-main-view .server-error{text-align:right}mv-account-main-view .server-error svg-icon{margin:0;height:23px}html[dir=ltr] mv-account-main-view .server-error svg-icon{margin-right:10px}html[dir=rtl] mv-account-main-view .server-error svg-icon{margin-left:10px}\n"],encapsulation:2}),e})()},{path:"**",component:n(39885).H,data:{canonicalLanding:s.zA.ALERTS_VIEW}}]},60600:function(e,t,n){"use strict";n.d(t,{c:function(){return p}});var i=n(3786),r=n(65492),o=(()=>{return(e=o||(o={}))[e.None=0]="None",e[e.Regular=1]="Regular",e[e.Info=2]="Info",e[e.Modified=3]="Modified",e[e.Critical=4]="Critical",o;var e})(),a=n(99528),s=n(2316),l=n(99902),c=n(26365),d=n(32066),u=n(2339);let p=(()=>{class e{constructor(e,t,n,i){this.httpService=e,this.metroService=t,this.imageService=n,this.translate=i,this.lineGroups=[]}getAlerts(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){const i=yield this.httpService.post(r.bl.GetAlerts,{body:{id:e,lang:t,revision:n}},!0).toPromise();this.lineGroups=i.lineGroups;const o=i.alertsForAgency.map(e=>this.aggregateAgencyAlertGroup(e,i.lineGroups));return{metroAlerts:i.metroAlerts,agencyAlerts:o}})}getAlertDetails(e){let t=r.bl.GetAlertDetails.toString();return e.forEach((e,n)=>t+=(n?"&":"?")+`ids=${e}`),this.httpService.get(t).toPromise()}getAlertDetailsByEntity(e){return this.httpService.post(r.bl.GetAlertDetailsByEntity,{body:{entities:e}}).toPromise()}getRouteAlerts(e,t){return(0,i.mG)(this,void 0,void 0,function*(){const n=e.map(e=>({entityType:a.$1.Stop,id:e})).concat(t.map(e=>({entityType:a.$1.Line,id:e}))),i=n.map(e=>e.id),o=n.map(e=>e.entityType);return this.httpService.post(r.bl.BaseAlert,{body:{id:i,type:o}},!0).toPromise()})}aggregateAgencyAlertGroup(e,t){const n=e.agencyAlerts,i=e.lineAlerts,r=this.metroService.getAgency(e.agencyId),o=i.map(e=>this.createLineAlerts(e,t[e.affectedLine.lineGroupId]));return{agencyInfo:r,agencyType:this.metroService.getAgencyRouteTypeName(r.routeType),agencyAlerts:n,lineAlerts:o}}createLineAlerts(e,t){return{statusCategory:e.serviceStatus.category,statusDescription:e.serviceStatus.desc,alertIds:e.alertIds,imageHtml:this.getLineImageHTML(e.affectedLine),lineName:this.getAffectedLineName(e.affectedLine)}}getAffectedLineName(e){const t=this.lineGroups[e.lineGroupId];return t?t.lineSummaries&&t.lineSummaries.length>0?t.lineSummaries[0].routeLongName:t.caption1:""}normaliseAlertDetails(e){const t=this.metroService.getAgency(e.agencyId),{isDescriptionHtml:n,description:i,baseUrl:r}=this.normaliseAlertDescription(e);return{date:e.publicationDate?new Date(e.publicationDate):null,title:e.title,activeFrom:e.activeFrom?new Date(e.activeFrom):null,activeTo:e.activeTo?new Date(e.activeTo):null,affectedLines:e.affectedLines?e.affectedLines.map(e=>e.name).join(", "):"",agencyName:t?t.agencyName:"",baseUrl:r,description:i,isDescriptionHtml:n,url:e.infoUrl,id:e.alertId,statusCategory:e.serviceStatus.category,statusDescription:e.serviceStatus.desc,imageHtml:"",lineName:""}}normaliseAlertDescription(e){let t=!1,n="",i="";if(e.desc)if(t=e.desc.format==a.oB.HTML,t){e.desc.baseUrl&&(i=e.desc.baseUrl);const t=document.createElement("html");e.desc.data=e.desc.data.replace(/&lt; br\/&gt;/g,""),i&&(e.desc.data=e.desc.data.replace(/<img([^>]*)\ssrc=(['"])(\/[^\2*([^\2\s<]+)\2/gi,"<img$1 src=$2"+i+"$3$2")),t.innerHTML=e.desc.data;const r=t.getElementsByTagName("a");for(let e=0;e<r.length;e++)r[e].removeAttribute("target"),r[e].getAttribute("href")&&("#"==r[e].getAttribute("href")||r[e].getAttribute("href").indexOf("javascript")>-1)&&r[e].removeAttribute("href"),r[e].removeAttribute("onclick");const o=t.getElementsByTagName("img");for(let e=0;e<o.length;e++)if("A"!=o[e].parentElement.tagName){const t=o[e].getAttribute("src");o[e].outerHTML='<a href="'+t+'" target="_blank">'+o[e].outerHTML+"</a>"}e.desc.data=t.getElementsByTagName("body")[0].innerHTML,n=e.desc.data}else n=e.desc.data,n.indexOf("\n")>=0&&(n=n.replace(/\n/g,"<br>"),t=!0);return{isDescriptionHtml:t,description:n,baseUrl:i}}resolveAlertStatusIcon(e){let t;switch(t=e.serviceStatus?e.serviceStatus.category:e.statusCategory,t){case o.Critical:return{icon:"/images/service-alerts/ic_service_bad_red.svg",altText:this.translate.instant("a11y_critical_service_alert_icon")};case o.Info:return{icon:"/images/service-alerts/ic_service_info_blue.svg",altText:this.translate.instant("a11y_info_service_alert_icon")};case o.Modified:return{icon:"/images/service-alerts/ic_service_modified_yellow.svg",altText:this.translate.instant("a11y_modified_service_alert_icon")};case o.Regular:return{icon:"/images/service-alerts/ic_service_good_green.svg",altText:this.translate.instant("a11y_regular_service_alert_icon")}}return{icon:"",altText:""}}getLineImageHTML(e){if(e.icon)return this.imageService.getImageHTML(e.icon.imageId,[null,...e.icon.parameters],void 0,e.name);{const t=this.lineGroups[e.lineGroupId];if(t){const e=this.metroService.getImageIndexForAgency(t.agencyId);return this.imageService.getLineImageHTML(t,e,void 0,void 0,t.lineNumber)}}}getUpdatesMessage(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return yield this.httpService.post(r.bl.GetUpdatesMessage,{body:{id:e,lang:t}},!0).toPromise()})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(l.O),s.LFG(c.V),s.LFG(d.KD),s.LFG(u.sK))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},50259:function(e,t,n){"use strict";n.d(t,{C:function(){return ie}});var i=n(16438),r=n(13691),o=n(2316);let a=(()=>{class e{resolve(e){return(0,r.kt)(e.queryParams.alertIds||e.queryParams.etype&&e.queryParams.eid?i.zA.ALERTS_SINGLE_VIEW:i.zA.ALERTS_VIEW)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var s=n(95505),l=n(5971),c=n(54364),d=n(3786),u=n(57157),p=n(60600),h=n(1437),m=n(61787),g=n(71570),f=n(5306);const v=(0,g.Cb)("isLoadHindered");let y=(()=>{class e{constructor(e,t){this.transferState=e,this.universal=t}get hinderState(){return this.transferState.get(v,!1)}set hinderState(e){this.transferState.set(v,e)}isLoadHindered(){if(this.universal.isServer)return this.hinderState=!0,!1;const e=this.hinderState;return e&&(this.hinderState=!1),e}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(g.ki),o.LFG(f.p))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=n(46461),_=n(2339),T=n(79223),S=n(86607);function x(e,t){1&e&&(o.TgZ(0,"div",4),o._UZ(1,"img",5),o.TgZ(2,"div",6),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA()),2&e&&(o.xp6(3),o.Oqu(o.lcZ(4,1,"service_alerts_none_subtitle")))}function w(e,t){if(1&e&&(o.TgZ(0,"div",18),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div"),o._uU(5),o.ALo(6,"date"),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(2),o.Oqu(o.lcZ(3,2,"service_alert_time_range_header")),o.xp6(3),o.Oqu(o.xi3(6,4,e.activeFrom,"MMM DD, hh:mm a"))}}function k(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",12),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).openAlert(t)})("keydown",function(t){const n=o.CHM(e).$implicit;return o.oxw(2).onKeydown(t,n)}),o.TgZ(1,"div",13),o.TgZ(2,"div",14),o._uU(3),o.qZA(),o.YNc(4,w,7,7,"div",15),o.qZA(),o.TgZ(5,"span",16),o._UZ(6,"img",17),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(2);o.xp6(3),o.Oqu(e.title),o.xp6(1),o.Q6J("ngIf",e.activeFrom),o.xp6(2),o.Q6J("src",n.alertService.resolveAlertStatusIcon(e).icon,o.LSH)("alt",n.alertService.resolveAlertStatusIcon(e).altText)}}function M(e,t){if(1&e&&(o.TgZ(0,"div",7),o.TgZ(1,"div",8),o.TgZ(2,"span",9),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA(),o.TgZ(5,"div",10),o.YNc(6,k,7,4,"div",11),o.qZA(),o.qZA()),2&e){const e=o.oxw();o.xp6(3),o.Oqu(o.lcZ(4,2,"service_alerts_title")),o.xp6(3),o.Q6J("ngForOf",e.state.metroAlerts)}}function L(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",24),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).openAlert(t)})("keydown",function(t){const n=o.CHM(e).$implicit;return o.oxw(2).onKeydown(t,n)}),o._UZ(1,"div",25),o.ALo(2,"safeHtml"),o.ALo(3,"async"),o.ALo(4,"asyncify"),o.TgZ(5,"span",14),o._uU(6),o.qZA(),o.TgZ(7,"span",16),o._UZ(8,"img",26),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(2);o.xp6(1),o.Q6J("innerHTML",o.lcZ(2,4,o.lcZ(3,6,o.lcZ(4,8,e.imageHtml))),o.oJD),o.xp6(5),o.Oqu(e.lineName),o.xp6(2),o.Q6J("src",n.alertService.resolveAlertStatusIcon(e).icon,o.LSH),o.uIk("alt",n.alertService.resolveAlertStatusIcon(e).altText)}}function A(e,t){if(1&e&&(o.TgZ(0,"div",18),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div"),o._uU(5),o.ALo(6,"date"),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(2),o.Oqu(o.lcZ(3,2,"service_alert_time_range_header")),o.xp6(3),o.Oqu(o.xi3(6,4,e.activeFrom,"MMM DD, hh:mm a"))}}function I(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",27),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).openAlert(t)})("keydown",function(t){const n=o.CHM(e).$implicit;return o.oxw(2).onKeydown(t,n)}),o.TgZ(1,"div",13),o.TgZ(2,"span",14),o._uU(3),o.qZA(),o.YNc(4,A,7,7,"div",15),o.qZA(),o.TgZ(5,"span",16),o._UZ(6,"img",17),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(2);o.xp6(3),o.Oqu(e.title),o.xp6(1),o.Q6J("ngIf",e.activeFrom),o.xp6(2),o.Q6J("src",n.alertService.resolveAlertStatusIcon(e).icon,o.LSH)("alt",n.alertService.resolveAlertStatusIcon(e).altText)}}function E(e,t){if(1&e&&(o.TgZ(0,"div",7),o.TgZ(1,"div",19),o.TgZ(2,"span",20),o._uU(3),o.qZA(),o.TgZ(4,"span",21),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA(),o.TgZ(7,"div",10),o.YNc(8,L,9,10,"div",22),o.qZA(),o.TgZ(9,"div",10),o.YNc(10,I,7,4,"div",23),o.qZA(),o.qZA()),2&e){const e=t.$implicit,n=t.index;o.xp6(1),o.uIk("aria-labelledby","agencyGroup"+n),o.xp6(1),o.uIk("id","agencyGroup"+n),o.xp6(1),o.Oqu(e.agencyInfo.agencyName),o.xp6(2),o.Oqu(o.lcZ(6,6,e.agencyType)),o.xp6(3),o.Q6J("ngForOf",e.lineAlerts),o.xp6(2),o.Q6J("ngForOf",e.agencyAlerts)}}let C=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.document=e,this.store=t,this.alertActions=n,this.routingService=i,this.alertService=r,this.analyticsService=o,this.canonicalService=a,this.universalLoadHinder=s}get state(){return this.store.getState().alert}ngOnInit(){return(0,d.mG)(this,void 0,void 0,function*(){this.universalLoadHinder.isLoadHindered()||(yield this.store.dispatch(this.alertActions.getAlerts()),this.emptyState=!this.state.metroAlerts.length&&!this.state.agencyAlerts.length,this.setupAlertElements())})}openAlert(e){this.analyticsService.trackOpenAlert(e.title||e.lineName);const t=e.hasOwnProperty("alertId")?[e.alertId]:e.alertIds;this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],i.zA.ALERTS_SINGLE_VIEW),{alertIds:t.join(",")})}setupAlertElements(){const e=[...document.getElementsByClassName("alerts-list")].reduce((e,t)=>[...e,...t.children],[]);e.forEach((e,t)=>{e.setAttribute("id",`alert_${t}`),e.setAttribute("tabindex",String(t?-1:0))}),this.renderedAlertsCount=e.length}onKeydown(e,t){const n=Number(e.target.id.replace("alert_",""));"ArrowUp"===e.key&&n-1>=0?(e.preventDefault(),this.setSelectedFocus(n-1)):"ArrowDown"===e.key&&n+1<this.renderedAlertsCount?(e.preventDefault(),this.setSelectedFocus(n+1)):"Enter"===e.key&&(e.preventDefault(),this.openAlert(t))}setSelectedFocus(e){const t=this.document.getElementById(`alert_${e}`);t&&(t.focus(),t.scrollIntoView({block:"center"}))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(c.K0),o.Y36(l.d),o.Y36(u.G),o.Y36(s.Z),o.Y36(p.c),o.Y36(h.y),o.Y36(m.z),o.Y36(y))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-alert-list"]],decls:4,vars:3,consts:[["class","empty-results","role","status",4,"ngIf"],["role","list"],["class","alert-group",4,"ngIf"],["class","alert-group",4,"ngFor","ngForOf"],["role","status",1,"empty-results"],["mvImg","","src","images/error-states/img_empty_state_line_view.svg",1,"svg-icon"],[1,"message"],[1,"alert-group"],["role","group","aria-labelledby","metroGroup",1,"group-title","flex-row"],["id","metroGroup",1,"group-name"],[1,"alerts-list"],["class","alert-container flex-row","role","listitem",3,"click","keydown",4,"ngFor","ngForOf"],["role","listitem",1,"alert-container","flex-row",3,"click","keydown"],[1,"agency-content","flex-col"],[1,"line-name"],["class","agency-alert",4,"ngIf"],[1,"alert-icon"],["mvImg","",3,"src","alt"],[1,"agency-alert"],["role","group",1,"group-title","flex-row"],[1,"group-name"],[1,"group-type"],["class","alert-container line-alerts flex-row","role","listitem",3,"click","keydown",4,"ngFor","ngForOf"],["class","alert-container agency-alerts flex-row","role","listitem",3,"click","keydown",4,"ngFor","ngForOf"],["role","listitem",1,"alert-container","line-alerts","flex-row",3,"click","keydown"],[1,"line-image",3,"innerHTML"],["mvImg","",3,"src"],["role","listitem",1,"alert-container","agency-alerts","flex-row",3,"click","keydown"]],template:function(e,t){1&e&&(o.YNc(0,x,5,3,"div",0),o.TgZ(1,"div",1),o.YNc(2,M,7,4,"div",2),o.YNc(3,E,11,8,"div",3),o.qZA()),2&e&&(o.Q6J("ngIf",t.emptyState),o.xp6(2),o.Q6J("ngIf",t.state.metroAlerts.length>0),o.xp6(1),o.Q6J("ngForOf",t.state.agencyAlerts))},directives:[c.O5,c.sg,b.X],pipes:[_.X$,c.uU,T.z,c.Ov,S.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-alert-list .flex-row{align-items:center;padding:14px 20px}mv-alert-list .alert-content .alert-status .line-image{min-width:26px}html[dir=ltr] mv-alert-list .alert-content .alert-status .line-image{padding-right:10px}html[dir=rtl] mv-alert-list .alert-content .alert-status .line-image{padding-left:10px}mv-alert-list .alert-content .alert-status .alert-title{font-size:.9411764706rem}mv-alert-list .alert-group{position:relative;width:100%}mv-alert-list .alert-group .group-title{background-color:#ecf0f1;box-sizing:border-box;color:#6c6d6d;z-index:1}mv-alert-list .alert-group .group-title .group-name{flex-grow:1}html[dir=ltr] mv-alert-list .alert-group .group-title .group-type{padding-left:20px}html[dir=rtl] mv-alert-list .alert-group .group-title .group-type{padding-right:20px}mv-alert-list .alert-group .alerts-list .alert-container.agency-alerts:after{background:#DDDDDD;content:"";display:block;height:1px;position:absolute;bottom:0;left:20px;width:calc(100% - 40px)}mv-alert-list .alert-group .alerts-list .alert-container{position:relative}mv-alert-list .alert-group .alerts-list .alert-container:after{background:#DDDDDD;content:"";display:block;height:1px;position:absolute;bottom:0;left:20px;width:calc(100% - 40px)}mv-alert-list .alert-group .alerts-list .alert-container:hover{background-color:#f5f7f7;cursor:pointer;outline:none}mv-alert-list .alert-group .alerts-list .alert-container:focus{outline:#302E2E auto 1px}mv-alert-list .alert-group .alerts-list .alert-container .line-image{display:table-cell;position:relative;vertical-align:middle}html[dir=ltr] mv-alert-list .alert-group .alerts-list .alert-container .line-image{padding-right:10px}html[dir=rtl] mv-alert-list .alert-group .alerts-list .alert-container .line-image{padding-left:10px}mv-alert-list .alert-group .alerts-list .alert-container .line-name{flex-grow:1}mv-alert-list .alert-group .alerts-list .alert-container .alert-icon{width:20px;min-width:20px}html[dir=ltr] mv-alert-list .alert-group .alerts-list .alert-container .alert-icon{padding-left:10px}html[dir=rtl] mv-alert-list .alert-group .alerts-list .alert-container .alert-icon{padding-right:10px}mv-alert-list .alert-group .alerts-list .alert-container .agency-content{display:table-cell;min-width:150px;vertical-align:middle;width:100%}mv-alert-list .alert-group .alerts-list .alert-container .agency-content .agency-alert span{color:#c6522c;display:block;margin-top:6px}mv-alert-list .alert-group .alerts-list:last-child .alert-container:last-of-type:after{display:none}\n'],encapsulation:2}),e})();var D=n(2281),P=n(52959),O=n(99642),N=n(78146),R=n(87479),$=n(93975),Y=n(19581),F=n(10617),B=n(1896);let U=(()=>{class e{constructor(e,t){this.elementRef=e,this.store=t,this.bodyDirection="ltr"}ngOnInit(){this.document=this.elementRef.nativeElement.contentDocument,this.applyStyles(),this.applyBase(),this.document.body.style.direction=this.bodyDirection,this.document.body.innerHTML=this.content,this.elementRef.nativeElement.setAttribute("height",this.document.body.scrollHeight+"px"),this.elementRef.nativeElement.style.opacity="1"}applyBase(){const e=document.createElement("base");e.setAttribute("href",this.baseUrl||"/"),e.setAttribute("target","_blank"),this.document.head.appendChild(e)}applyStyles(){return(0,d.mG)(this,void 0,void 0,function*(){const e=(yield(0,B.ZU)(this.store.getState(),B.Lm.Alert,"alert"))||F,t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e,this.document.head.appendChild(t)})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(l.d))},e.\u0275dir=o.lG2({type:e,selectors:[["","mvAlertDescription",""]],inputs:{content:"content",baseUrl:"baseUrl",bodyDirection:"bodyDirection"}}),e})();function Z(e,t){1&e&&(o.TgZ(0,"div",2),o._UZ(1,"svg-icon",3),o.ALo(2,"translate"),o.TgZ(3,"div",4),o._uU(4),o.ALo(5,"translate"),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.s9C("titleText",o.lcZ(2,2,"NoTripPlanFoundTitle")),o.xp6(3),o.Oqu(o.lcZ(5,4,"service_alerts_none_subtitle")))}function j(e,t){1&e&&o._UZ(0,"mv-share",19),2&e&&o.Q6J("showCaption",!1)}function V(e,t){if(1&e&&(o.TgZ(0,"div",20),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&e){const e=o.oxw().$implicit,t=o.oxw();o.xp6(1),o.hij(" ",o.xi3(2,1,"service_alert_details_publication_date",t.getDateTranslateParam(e))," ")}}function H(e,t){if(1&e&&(o.TgZ(0,"span"),o._uU(1," - "),o.TgZ(2,"span"),o._uU(3),o.ALo(4,"date"),o.qZA(),o.qZA()),2&e){const e=o.oxw(2).$implicit;o.xp6(3),o.Oqu(o.lcZ(4,1,e.activeTo))}}function G(e,t){if(1&e&&(o.TgZ(0,"div",21),o.TgZ(1,"div",20),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div",22),o.TgZ(5,"span"),o._uU(6),o.ALo(7,"date"),o.qZA(),o.YNc(8,H,5,3,"span",23),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(2),o.Oqu(o.lcZ(3,3,"service_alert_time_range_header")),o.xp6(4),o.Oqu(o.lcZ(7,5,e.activeFrom)),o.xp6(2),o.Q6J("ngIf",e.activeTo)}}function z(e,t){if(1&e&&(o.TgZ(0,"div",24),o.TgZ(1,"div",20),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div",22),o._uU(5),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(2),o.Oqu(o.lcZ(3,3,"service_alert_affected_lines_header")),o.xp6(3),o.AsE(" ",e.agencyName," - ",e.affectedLines," ")}}function q(e,t){if(1&e&&(o.TgZ(0,"div",25),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(2),o.Oqu(e.description)}}function J(e,t){if(1&e&&o._UZ(0,"iframe",28),2&e){const e=o.oxw(2).$implicit;o.Q6J("content",e.description)("baseUrl",e.baseUrl)("bodyDirection","ltr")}}function W(e,t){if(1&e&&o._UZ(0,"div",29),2&e){const e=o.oxw(2).$implicit;o.Q6J("innerHTML",e.description,o.oJD)}}function Q(e,t){if(1&e&&(o.TgZ(0,"div",25),o.YNc(1,J,1,3,"iframe",26),o.YNc(2,W,1,1,"div",27),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",e.universal.isBrowser),o.xp6(1),o.Q6J("ngIf",e.universal.isServer)}}function K(e,t){if(1&e&&(o.TgZ(0,"div",30),o.TgZ(1,"a",31),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(1),o.Q6J("href",e.url,o.LSH),o.xp6(1),o.Oqu(o.lcZ(3,2,"service_alert_more_info_link_text"))}}function X(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"article"),o.TgZ(1,"header",5),o.TgZ(2,"mv-back-button",6),o.NdJ("backClick",function(){return o.CHM(e),o.oxw().onBack()}),o.qZA(),o.TgZ(3,"div",7),o.TgZ(4,"span",8),o._UZ(5,"svg-icon",9),o.qZA(),o.TgZ(6,"h2",10),o._uU(7),o.qZA(),o.qZA(),o.YNc(8,j,1,1,"mv-share",11),o.qZA(),o.TgZ(9,"section"),o.TgZ(10,"div",12),o.YNc(11,V,3,4,"div",13),o.TgZ(12,"div",14),o._uU(13),o.qZA(),o.qZA(),o.YNc(14,G,9,7,"div",15),o.YNc(15,z,6,5,"div",16),o.qZA(),o.TgZ(16,"section"),o.YNc(17,q,3,1,"div",17),o.YNc(18,Q,3,2,"div",17),o.YNc(19,K,4,4,"div",18),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw();o.xp6(1),o.ekj("no-share",n.shouldHideShare),o.xp6(4),o.s9C("titleText",n.alertService.resolveAlertStatusIcon(e).altText),o.Q6J("src",n.alertService.resolveAlertStatusIcon(e).icon),o.xp6(2),o.Oqu(e.statusDescription),o.xp6(1),o.Q6J("ngIf",!n.shouldHideShare),o.xp6(3),o.Q6J("ngIf",e.date),o.xp6(2),o.Oqu(e.title),o.xp6(1),o.Q6J("ngIf",e.activeFrom),o.xp6(1),o.Q6J("ngIf",e.affectedLines),o.xp6(2),o.Q6J("ngIf",!e.isDescriptionHtml),o.xp6(1),o.Q6J("ngIf",e.isDescriptionHtml),o.xp6(1),o.Q6J("ngIf",e.url)}}let ee=(()=>{class e{constructor(e,t,n,i,r,o,a){this.routingService=e,this.canonicalService=t,this.store=n,this.alertActions=i,this.alertService=r,this.universal=o,this.a11y=a,this.completedInitialFocus=!1}get state(){return this.store.getState()}get shouldHideShare(){var e,t;return!!(null===(t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration)||void 0===t?void 0:t.hideSharing)}ngOnInit(){return(0,d.mG)(this,void 0,void 0,function*(){if(this.universal.isServer)return;yield(0,P.p5)(this.store);const e=this.routingService.getStateFromUrl();if(e.alertIds){const t=e.alertIds.split(",").map(Number);yield this.store.dispatch(this.alertActions.getAlertDetails(t))}else{if(!e.etype||!e.eid)return void this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],i.zA.ALERTS_VIEW));{const t={};for(const i of["etype","eid"])t[i]=e[i].split(",");const n=t.eid.map((e,n)=>({entityType:t.etype[n],id:t.eid[n]}));yield this.store.dispatch(this.alertActions.getAlertDetailsByEntity(n))}}this.emptyState=!this.state.alert.currentAlertDetails.length})}ngAfterViewChecked(){!this.completedInitialFocus&&this.backButtonComponent&&this.backButtonComponent.backButton&&this.a11y.byEnter&&(this.backButtonComponent.backButton.nativeElement.focus(),this.completedInitialFocus=!0)}getDateTranslateParam(e){return{param1:e.date?D(e.date).format("L LT"):""}}onBack(){this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],i.zA.ALERTS_VIEW))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.Z),o.Y36(m.z),o.Y36(l.d),o.Y36(u.G),o.Y36(p.c),o.Y36(f.p),o.Y36(N.F))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-alert-view"]],viewQuery:function(e,t){if(1&e&&o.Gf(O.W,5),2&e){let e;o.iGM(e=o.CRH())&&(t.backButtonComponent=e.first)}},decls:2,vars:2,consts:[["class","empty-results","role","alert",4,"ngIf"],[4,"ngFor","ngForOf"],["role","alert",1,"empty-results"],["src","images/error-states/img_empty_state_omni.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],[1,"message"],[1,"alert-status","flex-row"],[1,"black-fill",3,"backClick"],[1,"alert-header-mid"],[1,"alert-icon"],["mvAccessibleSVG","",3,"src","titleText"],[1,"alert-description"],[3,"showCaption",4,"ngIf"],[1,"publication-date"],["class","section-title",4,"ngIf"],[1,"title"],["class","affected-dates",4,"ngIf"],["class","affected-lines",4,"ngIf"],["class","description",4,"ngIf"],["class","link",4,"ngIf"],[3,"showCaption"],[1,"section-title"],[1,"affected-dates"],[1,"section-content"],[4,"ngIf"],[1,"affected-lines"],[1,"description"],["mvAlertDescription","",3,"content","baseUrl","bodyDirection",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mvAlertDescription","",3,"content","baseUrl","bodyDirection"],[3,"innerHTML"],[1,"link"],["target","_blank",3,"href"]],template:function(e,t){1&e&&(o.YNc(0,Z,6,6,"div",0),o.YNc(1,X,20,13,"article",1)),2&e&&(o.Q6J("ngIf",t.emptyState),o.xp6(1),o.Q6J("ngForOf",t.state.alert.currentAlertDetails))},directives:[c.O5,c.sg,R.bk,$.m,O.W,Y.N,U],pipes:[_.X$,c.uU],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-alert-view{background:#fff;padding:0 0 42px;display:block}mv-alert-view article section{padding:0 20px}mv-alert-view article .alert-status{align-items:center;position:relative}mv-alert-view article .alert-status:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:20px;width:calc(100% - 40px);z-index:0}body.mobile mv-alert-view article .alert-status{height:64px}body.desktop mv-alert-view article .alert-status{justify-content:space-between}body.desktop mv-alert-view article .alert-status:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:0px;width:calc(100% - 0px);z-index:0}mv-alert-view article .alert-status .alert-header-mid{flex-grow:1;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center}body.mobile mv-alert-view article .alert-status .alert-header-mid .empty-cell{display:none}mv-alert-view article .alert-status.no-share{padding-right:58px}body.desktop mv-alert-view article .alert-status mv-back-button{height:38px;min-height:38px}body.desktop mv-alert-view article .alert-status mv-back-button .back-button-container{height:38px}html[dir=ltr] mv-alert-view article .alert-status mv-back-button .back-button-container .back-link{padding:0 15px 0 0}html[dir=rtl] mv-alert-view article .alert-status mv-back-button .back-button-container .back-link{padding:0 0 0 15px}body.desktop mv-alert-view article .alert-status mv-back-button .back-button-container .back-link svg-icon{height:.8235294118rem}mv-alert-view article .alert-status mv-back-button .back-button-container .back-link:focus{outline:none}mv-alert-view article .alert-status mv-back-button .back-button-container .back-link:focus svg-icon{outline:auto}mv-alert-view article .alert-status mv-back-button mv-share{position:absolute}html[dir=ltr] mv-alert-view article .alert-status mv-back-button mv-share{right:0}html[dir=rtl] mv-alert-view article .alert-status mv-back-button mv-share{left:0}html[dir=ltr] mv-alert-view article .alert-status mv-back-button mv-share mv-share .share{padding-right:0}html[dir=rtl] mv-alert-view article .alert-status mv-back-button mv-share mv-share .share{padding-left:0}body.desktop mv-alert-view article .alert-status mv-back-button mv-share mv-share .share{display:inline}mv-alert-view article .alert-status mv-back-button mv-share mv-share .share svg-icon{width:20px;height:20px}mv-alert-view article .alert-status mv-back-button mv-share mv-share .share svg-icon svg{width:100%;height:100%}mv-alert-view article .alert-status mv-back-button mv-share mv-share .share span{display:none}body.desktop mv-alert-view article .alert-status mv-share{height:38px;min-height:38px}html[dir=ltr] mv-alert-view article .alert-status .alert-icon{margin-right:15px}html[dir=rtl] mv-alert-view article .alert-status .alert-icon{margin-left:15px}body.desktop mv-alert-view article .alert-status .alert-icon{display:flex}html[dir=ltr] body.desktop mv-alert-view article .alert-status .alert-icon{margin-right:4px}html[dir=rtl] body.desktop mv-alert-view article .alert-status .alert-icon{margin-left:4px}body.desktop mv-alert-view article .alert-status .alert-icon svg-icon{width:1.0588235294rem;height:1.0588235294rem}mv-alert-view article .alert-status .alert-description{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25}body.desktop mv-alert-view article .alert-status .alert-description{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-alert-view article .publication-date{margin-top:20px}mv-alert-view article .publication-date .section-title{font-size:.8235294118rem;color:#737578}mv-alert-view article .publication-date .title{font-size:.9411764706rem}mv-alert-view article .affected-lines{margin-top:12px}mv-alert-view article .affected-lines .section-title{color:#c6522c}mv-alert-view article .description{margin-top:16px}mv-alert-view article .description iframe{overflow:auto;width:100%;border:none}mv-alert-view .empty-results .svg-icon{fill:#bdc3c7;display:block;height:32px;margin:26px auto 0;width:32px}mv-alert-view .empty-results .message{font-size:.9411764706rem;color:#292a30;color:#737578;margin:14px 0;text-align:center;padding:20px}\n'],encapsulation:2}),e})();function te(e,t){1&e&&o._UZ(0,"mv-alert-list")}function ne(e,t){1&e&&o._UZ(0,"mv-alert-view")}const ie=[{path:":lang",resolve:{subTabId:a},runGuardsAndResolvers:"paramsOrQueryParamsChange",component:(()=>{class e{constructor(e,t){this.routingService=e,this.store=t,this.SubTabId=i.zA}get state(){return this.store.getState()}ngOnInit(){this.refreshRouteData(),this.routingService.onNavigationEnd(()=>this.refreshRouteData())}refreshRouteData(){this.routeData=this.routingService.getCurrentRouteData()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.Z),o.Y36(l.d))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-alerts-main-view"]],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(o.YNc(0,te,1,0,"mv-alert-list",0),o.YNc(1,ne,1,0,"mv-alert-view",0)),2&e&&(o.Q6J("ngIf",t.state.global.appIsReady&&(null==t.routeData?null:t.routeData.subTabId)===t.SubTabId.ALERTS_VIEW),o.xp6(1),o.Q6J("ngIf",(null==t.routeData?null:t.routeData.subTabId)===t.SubTabId.ALERTS_SINGLE_VIEW))},directives:[c.O5,C,ee],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-alerts-main-view{display:block;overflow-y:auto;height:100%}mv-alerts-main-view .empty-results .svg-icon{fill:#bdc3c7;display:block;height:32px;margin:26px auto 0;width:32px}mv-alerts-main-view .empty-results img.svg-icom{opacity:.25}mv-alerts-main-view .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;text-align:center;padding:20px}\n"],encapsulation:2}),e})()},{path:"**",component:n(39885).H,data:{canonicalLanding:i.zA.ALERTS_VIEW}}]},17184:function(e,t,n){"use strict";n.d(t,{bA:function(){return r},jx:function(){return o},pq:function(){return a},cF:function(){return s},kJ:function(){return l},IV:function(){return c},cd:function(){return d},Yt:function(){return u},TU:function(){return p}});var i=n(99528),r=(()=>{return(e=r||(r={}))[e.UNDEFINED=1]="UNDEFINED",e[e.WALK_AND_RIDE=2]="WALK_AND_RIDE",e[e.ROUTES_WITH_BIKE=3]="ROUTES_WITH_BIKE",e[e.WALK_ONLY=4]="WALK_ONLY",e[e.CARPOOL=5]="CARPOOL",e[e.WHEEL_CHAIR_ACCESSIBLE=6]="WHEEL_CHAIR_ACCESSIBLE",e[e.ROUTES_WITH_RENTAL_BIKE=7]="ROUTES_WITH_RENTAL_BIKE",e[e.ROUTES_WITH_SPECIFIC_AGENCIES=8]="ROUTES_WITH_SPECIFIC_AGENCIES",e[e.EVENT=9]="EVENT",e[e.MULTI_MODAL=10]="MULTI_MODAL",e[e.ROUTES_WITH_DOCKLESS=11]="ROUTES_WITH_DOCKLESS",e[e.TOD=12]="TOD",e[e.FLEX_TIME=13]="FLEX_TIME",e[e.TO_HUBS=14]="TO_HUBS",r;var e})();function o(e){return void 0!==e.params}function a(e){return void 0!==e.originPathwayLocation}var s=(()=>{return(e=s||(s={}))[e.StartFrom=0]="StartFrom",e[e.WaitFor=1]="WaitFor",e[e.WalkTo=2]="WalkTo",e[e.RideTo=3]="RideTo",e[e.WalkToPath=4]="WalkToPath",e[e.BikeRideTo=5]="BikeRideTo",e[e.RentalBikeRideTo=6]="RentalBikeRideTo",s;var e})(),l=(()=>{return(e=l||(l={}))[e.Walk=0]="Walk",e[e.Bicycle=1]="Bicycle",e[e.Car=2]="Car",e[e.Tram=3]="Tram",e[e.Subway=4]="Subway",e[e.Rail=5]="Rail",e[e.Bus=6]="Bus",e[e.Ferry=7]="Ferry",e[e.CableCar=8]="CableCar",e[e.Gondola=9]="Gondola",e[e.Funicular=10]="Funicular",e[e.Transit=11]="Transit",e[e.Trainish=12]="Trainish",e[e.Busish=13]="Busish",e[e.LegSwith=14]="LegSwith",e[e.CustomMotorVehicle=15]="CustomMotorVehicle",e[e.CarPoolRide=16]="CarPoolRide",e[e.WaitFor=17]="WaitFor",e[e.StartFrom=18]="StartFrom",e[e.WalkToPath=19]="WalkToPath",e[e.Taxi=20]="Taxi",l;var e})(),c=(()=>{return(e=c||(c={}))[e.LeaveNow=1]="LeaveNow",e[e.Depart=2]="Depart",e[e.Arrive=3]="Arrive",e[e.Last=4]="Last",c;var e})(),d=(()=>{return(e=d||(d={})).BestRoute="bestRoute",e.LeastWalking="LeastWalking",e.LeastTransfers="LeastTransfers",d;var e})();class u{constructor(e,t,n,i){this.name=e,this.translationKey=t,this.routeTypeId=n,this.imageId=i}static equals(e,t){if(e==t)return!0;if(!e||!t||e.length!=t.length)return!1;for(const n of e)if(-1==t.findIndex(e=>e.name==n.name))return!1;for(const n of t)if(-1==e.findIndex(e=>e.name==n.name))return!1;return!0}static getRouteTypeByName(e){for(let t=0;t<u.All.length;t++)if(u.All[t].name==e)return u.All[t];return null}static getById(e){for(let t=0;t<u.All.length;t++)if(u.All[t].routeTypeId==e)return u.All[t];return null}}u.Bus=new u("bus","transit_type_default_bus",i.HO.Bus),u.CableCar=new u("cableCar","transit_type_default_cable",i.HO.Cable),u.Ferry=new u("ferry","transit_type_default_ferry",i.HO.Ferry),u.Funicular=new u("funicular","transit_type_default_funicular",i.HO.Funicular),u.Gondola=new u("gondola","transit_type_default_gondola",i.HO.Gondola),u.Rail=new u("rail","transit_type_default_rail",i.HO.Rail),u.Subway=new u("subway","transit_type_default_subway",i.HO.Subway),u.Tram=new u("tram","transit_type_default_tram",i.HO.Tram),u.All=[u.Bus,u.CableCar,u.Ferry,u.Funicular,u.Gondola,u.Rail,u.Subway,u.Tram];var p=(()=>{return(e=p||(p={}))[e.Prev=0]="Prev",e[e.Next=1]="Next",p;var e})();new Set([r.UNDEFINED,r.WALK_AND_RIDE,r.WALK_ONLY,r.WHEEL_CHAIR_ACCESSIBLE,r.ROUTES_WITH_BIKE,r.ROUTES_WITH_RENTAL_BIKE,r.TOD])},36087:function(e,t,n){"use strict";n.d(t,{S:function(){return Qo}});var i=n(99528),r=n(3786),o=n(54364),a=n(52959),s=n(2316),l=n(5971),c=n(85431),d=n(1437),u=n(99957),p=n(7935),h=n(99650),m=n(80270),g=n(78146),f=n(95505),v=n(5306),y=n(15208),b=n(4008),_=n(2339),T=n(53448);const S=["input"],x=["clearButton"];function w(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",7),s.NdJ("click",function(){return s.CHM(e),s.oxw().switchLocations.emit()}),s.qZA()}}let k=(()=>{class e{constructor(e,t,n,i){this.translate=e,this.store=t,this.storeHelper=n,this.platformService=i,this.delay=500,this.hasSwitchButton=!1,this.runSearch=new s.vpe,this.changeValue=new s.vpe,this.switchLocations=new s.vpe,this.focus=new s.vpe,this.blur=new s.vpe,this.searchText="",this.lastSearch=""}ngOnInit(){this.updateText(),this.storeHelper.subscribe(`directions.search.${this.fromToString}.name`,()=>{this.updateText()})}ngAfterViewInit(){this.platformService.isDesktop&&this.searchState.currentActiveSearchField===this.fromTo&&this.input.nativeElement.focus()}ngOnChanges(e){this.updateText();const{previousValue:t,currentValue:n}=e.searchTextFromUrl;!t&&n&&(this.onFocus(),this.onChange(n),this.updateText())}get searchState(){return this.store.getState().directions.search}get fromToString(){return this.fromTo==i.$h.From?"from":"to"}get displayText(){const e=this.searchState[this.fromToString].fullName||this.searchState[this.fromToString].name||this.searchState[`${this.fromToString}Text`];return e===b.Ok?this.translate.instant("current_location"):e}get locationId(){return this.searchState[this.fromToString].id}onBlur(e){this.blur.emit()}onFocus(){this.lastSearch="",this.focus.emit()}onChange(e){this.changeValue.emit(e),e=e.trim(),clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.lastSearch!=e&&(this.lastSearch=e,this.runSearch.emit(e))},this.delay)}clear(){this.searchText="",this.changeValue.emit(""),this.input.nativeElement.focus()}updateText(){this.searchText=this.displayText}setFocusIfEmpty(){void 0===this.locationId&&this.input.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(_.sK),s.Y36(l.d),s.Y36(c.N),s.Y36(y.mi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-input"]],viewQuery:function(e,t){if(1&e&&(s.Gf(S,5),s.Gf(x,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.input=e.first),s.iGM(e=s.CRH())&&(t.clearButton=e.first)}},inputs:{fromTo:"fromTo",label:"label",placeholder:"placeholder",delay:"delay",hasSwitchButton:"hasSwitchButton",disabled:"disabled",searchTextFromUrl:"searchTextFromUrl"},outputs:{runSearch:"runSearch",changeValue:"changeValue",switchLocations:"switchLocations",focus:"focus",blur:"blur"},features:[s.TTD],decls:11,vars:17,consts:[[1,"input-container"],[1,"input-label"],["type","text","autocomplete","off",3,"ngModel","disabled","ngModelChange","blur","focus"],["input",""],["type","button","title","Clear",1,"clear-button",3,"click"],["clearButton",""],["class","search-change-direction","type","button","title","Switch directions",3,"click",4,"ngIf"],["type","button","title","Switch directions",1,"search-change-direction",3,"click"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"label",1),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"input",2,3),s.NdJ("ngModelChange",function(e){return t.searchText=e})("blur",function(e){return t.onBlur(e)})("focus",function(){return t.onFocus()})("ngModelChange",function(e){return t.onChange(e)}),s.ALo(6,"translate"),s.ALo(7,"translate"),s.qZA(),s.TgZ(8,"button",4,5),s.NdJ("click",function(){return t.clear()}),s.qZA(),s.YNc(10,w,1,0,"button",6),s.qZA()),2&e&&(s.xp6(1),s.uIk("for",t.label),s.xp6(1),s.Oqu(s.lcZ(3,11,t.label)),s.xp6(2),s.Q6J("ngModel",t.searchText)("disabled",t.disabled),s.uIk("id",t.label)("placeholder",s.lcZ(6,13,t.placeholder))("title",s.lcZ(7,15,t.placeholder)),s.xp6(4),s.ekj("visible",t.searchText),s.uIk("id","clear_"+t.label),s.xp6(2),s.Q6J("ngIf",t.hasSwitchButton))},directives:[T.Fj,T.JJ,T.On,o.O5],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.mobile mv-root div.app-container mv-search-control mv-back-button{position:absolute;opacity:0;transform:translate(20px)}html[dir=ltr] body.mobile mv-root div.app-container mv-search-control mv-back-button{left:-3px}html[dir=rtl] body.mobile mv-root div.app-container mv-search-control mv-back-button{right:-3px}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container{transition:margin-top .3s ease-in-out}html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container{margin-top:45px}html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) mv-cookie-banner{transition-delay:.1s;transform:translateY(-4.7058823529rem)}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) mv-header{transform:translateY(-4.7058823529rem)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) mv-header{transform:translateY(-4.7058823529rem)}}html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) mv-header{transform:translateY(calc(-80px - 4.7058823529rem))}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) mv-header{transform:translateY(calc(-4.7058823529rem - 2.9411764706rem))}}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary).trip-plan.with-options .content-container{margin-top:45px}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary).trip-plan.with-options .content-container mv-search-departure-options{transform:translateY(-14.7058823529rem);transition-duration:.3s}html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary).trip-plan.with-options .content-container mv-search-departure-options{transform:translateY(calc(-14.7058823529rem - 4.7058823529rem))}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary).trip-plan.with-options .content-container mv-search-departure-options{transform:translateY(calc(-12.9411764706rem - 2.9411764706rem))}}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container{margin-top:46px}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container{transform:translateY(-4.7058823529rem);height:45px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container{transform:translateY(-2.4705882353rem)}}html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container{transform:translateY(-9.4117647059rem)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container{transform:translateY(calc(-2.4705882353rem - 2.9411764706rem))}}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container mv-back-button{opacity:1;transform:translate(0);transition:all .3s ease-in-out .3s}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container .from-to-dots{height:0;transition:height ease-in-out .3s}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container .search-change-direction{display:none}body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container .search-inputs .search-input-wrapper:after,body.mobile mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary) .content-container .search-container .search-inputs .search-input-wrapper:before{transition:all .1s ease-in-out;transform:translateY(-50%) scale(0);opacity:0}body.mobile mv-root div.app-container.direction-from-input-focused .content-container mv-directions-main-view mv-search-control .search-container .search-input-from .input-container{margin:5px 0}body.mobile mv-root div.app-container.direction-from-input-focused .content-container mv-directions-main-view mv-search-control .search-container .search-input-to .input-container{display:none}body.mobile mv-root div.app-container.direction-to-input-focused .content-container mv-directions-main-view mv-search-control .search-container .search-input-to .input-container{margin:5px 0}body.mobile mv-root div.app-container.direction-to-input-focused .content-container mv-directions-main-view mv-search-control .search-container .search-input-from .input-container{opacity:0;transform:scaleY(0);display:none}.search-input-from .input-container{margin-top:25px}.search-input-to .input-container{margin-bottom:25px}.input-container{position:relative;background:#ffffff;height:33px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:baseline;transition:all .3s;width:100%;border-radius:4px;display:flex;margin:15px 0;border:1px solid #fff}body.mobile .input-container :focus{outline:0}.input-container .input-label{padding:0 8px;border:none;background:0 0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:.8235294118rem;color:#737578;font-weight:700;vertical-align:baseline;max-width:2.3529411765rem;min-width:2.3529411765rem;align-self:center}html[dir=ltr] .input-container .input-label{text-align:left}html[dir=rtl] .input-container .input-label{text-align:right}.input-container button{width:25px;height:33px;border:0;background:0 0;position:relative}.input-container button.clear-button{background:url(/images/icons/close.svg) no-repeat center;background-size:.4705882353rem .4705882353rem;opacity:.7;visibility:hidden}.input-container button.clear-button.visible{visibility:visible}.input-container button.search-change-direction{background:url(/images/icons/changeDirectionNew.svg) no-repeat center;background-size:12px}.input-container input{background:0 0;border:none;height:33px;overflow:hidden;position:relative;text-overflow:ellipsis;vertical-align:baseline;font-size:.9411764706rem;width:100%;box-sizing:border-box;outline:0}\n"],encapsulation:2}),e})();var M=n(99642),A=n(17184),I=n(87100),E=n(2281),C=n.n(E),D=n(16438),P=n(80221),O=n(81663),N=n(72249),R=n(61787);function $(e,t){if(1&e&&(s.TgZ(0,"option",15),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=t.$implicit,n=s.oxw(2);s.Q6J("ngValue",e),s.xp6(1),s.hij(" ",s.lcZ(2,2,n.departureOptions[e])," ")}}function Y(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"select",13),s.NdJ("ngModelChange",function(t){return s.CHM(e),s.oxw().setDepartureOption(t)}),s.ALo(2,"translate"),s.YNc(3,$,3,4,"option",14),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngModel",e.selectedDepartureOption),s.uIk("aria-label",s.lcZ(2,3,"a11y_set_departure_time")),s.xp6(2),s.Q6J("ngForOf",e.JSObject.keys(e.departureOptions))}}function F(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw(2).setDepartureOption(t)}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw(2);s.xp6(1),s.hij(" ",s.lcZ(2,1,n.departureOptions[e])," ")}}function B(e,t){if(1&e&&(s._UZ(0,"button",16),s.TgZ(1,"mat-menu",17,18),s.ALo(3,"translate"),s.YNc(4,F,3,3,"button",19),s.qZA()),2&e){const e=s.MAs(2),t=s.oxw();s.Q6J("matMenuTriggerFor",e),s.xp6(1),s.uIk("aria-label",s.lcZ(3,3,"a11y_set_departure_time")),s.xp6(3),s.Q6J("ngForOf",t.JSObject.keys(t.departureOptions))}}function U(e,t){if(1&e&&(s.TgZ(0,"option",15),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.Q6J("ngValue",e),s.xp6(1),s.Oqu(e.text)}}function Z(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"select",21),s.NdJ("ngModelChange",function(t){return s.CHM(e),s.oxw().onTimeChanged(t)}),s.YNc(2,U,2,2,"option",14),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngModel",e.selectedTime)("tabIndex",e.tabIndex),s.xp6(1),s.Q6J("ngForOf",e.timeOptions)}}function j(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw(2).onTimeChanged(t)}),s._uU(1),s.qZA()}if(2&e){const e=t.$implicit;s.xp6(1),s.hij(" ",e.text," ")}}function V(e,t){if(1&e&&(s._UZ(0,"button",22),s.TgZ(1,"mat-menu",17,23),s.YNc(3,j,2,1,"button",19),s.qZA()),2&e){const e=s.MAs(2),t=s.oxw();s.Q6J("matMenuTriggerFor",e),s.xp6(3),s.Q6J("ngForOf",t.timeOptions)}}function H(e,t){if(1&e&&(s.TgZ(0,"option",15),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.Q6J("ngValue",e),s.xp6(1),s.Oqu(e.text)}}function G(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"select",21),s.NdJ("ngModelChange",function(t){return s.CHM(e),s.oxw().onDayChanged(t)}),s.YNc(2,H,2,2,"option",14),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngModel",e.selectedDate)("tabIndex",e.tabIndex),s.xp6(1),s.Q6J("ngForOf",e.dayOptions)}}function z(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw(2).onDayChanged(t)}),s._uU(1),s.qZA()}if(2&e){const e=t.$implicit;s.xp6(1),s.hij(" ",e.text," ")}}function q(e,t){if(1&e&&(s._UZ(0,"button",22),s.TgZ(1,"mat-menu",17,24),s.YNc(3,z,2,1,"button",19),s.qZA()),2&e){const e=s.MAs(2),t=s.oxw();s.Q6J("matMenuTriggerFor",e),s.xp6(3),s.Q6J("ngForOf",t.dayOptions)}}let J=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c){this.store=e,this.storeHelper=t,this.searchActions=n,this.suggestedRoutesActions=i,this.daysService=r,this.routingService=o,this.canonicalService=a,this.analyticsService=s,this.customerService=l,this.platformService=c,this.departureOptions={[A.IV.LeaveNow]:"time_picker_leave_now",[A.IV.Depart]:"time_picker_depart_at",[A.IV.Arrive]:"time_picker_arrive_by",[A.IV.Last]:"last_available_transit"},this.JSObject=Object,this.dayOptions=[],this.unsubscribe=()=>{}}ngOnInit(){this.loadOptions(),this.limitTo7Days=!0,this.limitTo7Days=this.daysService.limitTo7Days,this.minDate=this.daysService.minDate,this.maxDate=this.daysService.maxDate,this.unsubscribe=this.storeHelper.subscribe("global.selectedLocale.id",()=>{this.loadOptions()})}ngOnDestroy(){this.unsubscribe()}get state(){return this.store.getState().directions.search}get tabIndex(){return this.shouldShowTimeSelectors?0:-1}get optionsTranslationKey(){return this.customerService.getTranslationKey(this.store.getState().customer.currentCustomer,"trip_plan_preference_label")}get shouldShowTimeSelectors(){return this.storeHelper.shouldShowTimeSelectors}get departureOptionName(){return this.departureOptions[this.selectedDepartureOption]}get selectedDepartureOption(){return this.state.departureOption}get selectedTime(){return this.state.tripPlanTime.time}get selectedDate(){return this.state.tripPlanTime.day}loadOptions(){this.dayOptions=this.daysService.rebuildDaysList(this.store.getState().metro.maxFutureDays),this.timeOptions=(0,I.i_)()}isTimeBasedOption(e){return e==A.IV.Depart||e==A.IV.Arrive}setDepartureOption(e){const t=e!=this.selectedDepartureOption&&!this.isTimeBasedOption(e);this.store.dispatch(this.searchActions.setDepartureOption(e)),this.trackChangeDepartureOptions(),t&&this.store.dispatch(this.suggestedRoutesActions.getSuggestedRoutes())}trackChangeDepartureOptions(){this.analyticsService.trackChangeDepartureOptions(this.departureOptions[this.selectedDepartureOption],this.selectedTime.timeOfDay,this.selectedDate.date)}onTimeChanged(e){this.onValuesChanged(e,this.selectedDate),this.trackChangeDepartureOptions()}onDayChanged(e){this.onValuesChanged(this.selectedTime,e),this.trackChangeDepartureOptions()}onValuesChanged(e,t){e.timeOfDay==this.selectedTime.timeOfDay&&t.date==this.selectedDate.date||(this.store.dispatch(this.searchActions.setTripPlanDayAndTime({time:e,day:t})),e.text&&t.text&&this.store.dispatch(this.suggestedRoutesActions.getSuggestedRoutes(!0)))}openOptionsPanel(){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TRIPPLAN_OPTIONS))}getTimeText(e){return(0,I.$D)(e.timeOfDay)}getDateText(e){return E(e.date).format("ddd, MMM D")}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(c.N),s.Y36(h.P),s.Y36(O.C),s.Y36(N.O),s.Y36(f.Z),s.Y36(R.z),s.Y36(d.y),s.Y36(u.v),s.Y36(y.mi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-departure-options"]],viewQuery:function(e,t){if(1&e&&s.Gf(P.p6,5),2&e){let e;s.iGM(e=s.CRH())&&(t.trigger=e.first)}},decls:27,vars:18,consts:[[1,"departures-options-container"],[1,"time-and-options"],[1,"time-selector"],[1,"clock-icon"],[1,"selected-departure-option"],[4,"ngIf","ngIfElse"],["desktopDeparturesMenu",""],["tabindex","0",1,"gray-btn","options",3,"click","keydown.enter"],[1,"time-selectors"],[1,"select-time"],["desktopTimeSelectorMenu",""],[1,"select-date"],["desktopDateSelectMenu",""],["id","departures-options","tabindex","0",1,"departures-options-dropdown",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"departures-options-dropdown",3,"matMenuTriggerFor"],["tabindex","0"],["optionsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"overlay-selection",3,"ngModel","tabIndex","ngModelChange"],[1,"overlay-selection",3,"matMenuTriggerFor"],["timeMenu","matMenu"],["dateMenu","matMenu"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"div",2),s._UZ(3,"i",3),s.TgZ(4,"span",4),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.YNc(7,Y,4,5,"ng-container",5),s.YNc(8,B,5,5,"ng-template",null,6,s.W1O),s.qZA(),s.TgZ(10,"a",7),s.NdJ("click",function(){return t.openOptionsPanel()})("keydown.enter",function(){return t.openOptionsPanel()}),s.TgZ(11,"span"),s._uU(12),s.ALo(13,"translate"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(14,"div",8),s.TgZ(15,"div",9),s.TgZ(16,"span"),s._uU(17),s.qZA(),s.YNc(18,Z,3,3,"ng-container",5),s.YNc(19,V,4,2,"ng-template",null,10,s.W1O),s.qZA(),s.TgZ(21,"div",11),s.TgZ(22,"span"),s._uU(23),s.qZA(),s.YNc(24,G,3,3,"ng-container",5),s.YNc(25,q,4,2,"ng-template",null,12,s.W1O),s.qZA(),s.qZA(),s.qZA()),2&e){const e=s.MAs(9),n=s.MAs(20),i=s.MAs(26);s.ekj("with-time-options",t.shouldShowTimeSelectors),s.xp6(5),s.Oqu(s.lcZ(6,14,t.departureOptionName)),s.xp6(2),s.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",e),s.xp6(5),s.Oqu(s.lcZ(13,16,t.optionsTranslationKey)),s.xp6(2),s.ekj("shown",t.shouldShowTimeSelectors),s.xp6(3),s.Oqu(t.getTimeText(t.selectedTime)),s.xp6(1),s.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",n),s.xp6(5),s.Oqu(t.getDateText(t.selectedDate)),s.xp6(1),s.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",i)}},directives:[o.O5,T.EJ,T.JJ,T.On,o.sg,T.YN,T.Kr,P.p6,P.VK,P.OP],pipes:[_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-search-departure-options{width:100%;z-index:2;transition:transform ease-in-out .35s}body.mobile mv-search-departure-options{position:fixed}mv-search-departure-options .gray-btn{background:none;border:1px solid #BDC3C7;border-radius:4px;font-size:.8235294118rem;color:#737578;display:inline-block;height:25px;padding:0 9px;text-decoration:none;vertical-align:middle;transition:all,.3s}mv-search-departure-options .gray-btn:hover span{color:#fff}mv-search-departure-options .gray-btn span{transition:all .3s;vertical-align:middle}mv-search-departure-options .departures-options-container{background-color:#292a30}mv-search-departure-options .departures-options-container .time-and-options{font-size:.8235294118rem;color:#737578;transition:all,.3s;display:flex;justify-content:space-between;padding:0 20px 20px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-search-departure-options .departures-options-container .time-and-options{padding:0 20px 14px}}mv-search-departure-options .departures-options-container.with-time-options .time-and-options{padding:0 20px 10px}mv-search-departure-options .departures-options-container .time-selector{box-sizing:border-box;position:relative}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selector{left:7px}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selector{right:7px}mv-search-departure-options .departures-options-container .time-selector ul.dropdown{margin:0}mv-search-departure-options .departures-options-container .time-selector:hover i:before{transform:rotate(720deg)}mv-search-departure-options .departures-options-container .time-selector:hover i:after{transform:rotate(360deg)}mv-search-departure-options .departures-options-container .time-selector i{border:1px solid #BDC3C7;border-radius:50%;display:inline-block;height:13px;position:relative;top:5px;width:13px}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selector i{margin-right:24px}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selector i{margin-left:24px}mv-search-departure-options .departures-options-container .time-selector i:before{background:#BDC3C7;content:"";display:block;height:4px;left:calc(50% - 1px);position:absolute;top:2px;transform-origin:bottom;width:1px;transition:rotate,1s}mv-search-departure-options .departures-options-container .time-selector i:after{background:#BDC3C7;content:"";display:block;height:1px;left:calc(50% - 1px);position:absolute;top:6px;transform-origin:left;width:3px;transition:rotate,1s}mv-search-departure-options .departures-options-container .time-selector .selected-departure-option{color:#bdc3c7;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:.8235294118rem;position:relative;top:2px}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selector .selected-departure-option{right:9px}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selector .selected-departure-option{margin-left:9px}mv-search-departure-options .departures-options-container .time-selector .selected-departure-option:visited{color:#fff}mv-search-departure-options .departures-options-container .time-selector .selected-departure-option:after{content:"";position:absolute;top:.4117647059rem;display:inline-block;height:.2352941176rem;width:.5294117647rem;background:url(/images/icons/expand_light_gray.svg) no-repeat;background-size:contain}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selector .selected-departure-option:after{left:calc(100% + 7px)}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selector .selected-departure-option:after{right:calc(100% + 7px)}mv-search-departure-options .departures-options-container .options{display:table}mv-search-departure-options .departures-options-container .options span{color:#bdc3c7;display:table-cell;font-size:.8235294118rem}mv-search-departure-options .departures-options-container .departures-options-dropdown{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9;padding:4px 0}html[dir=ltr] mv-search-departure-options .departures-options-container .departures-options-dropdown{left:0}html[dir=rtl] mv-search-departure-options .departures-options-container .departures-options-dropdown{right:0}html[dir=ltr] mv-search-departure-options .departures-options-container .departures-options-dropdown{left:28px}html[dir=rtl] mv-search-departure-options .departures-options-container .departures-options-dropdown{right:28px}mv-search-departure-options .departures-options-container .departures-options-dropdown>li{opacity:0;transition-duration:.15s}mv-search-departure-options .departures-options-container .departures-options-dropdown.shown{display:block;max-height:290px;opacity:1;transition:all .15s cubic-bezier(.55,0,.55,.2);box-shadow:0 0 2px #0000004d;background-color:#fff}mv-search-departure-options .departures-options-container .departures-options-dropdown.shown>li{opacity:1;pointer-events:all}mv-search-departure-options .departures-options-container .departures-options-dropdown:focus+.selected-departure-option{outline:auto}mv-search-departure-options .departures-options-container .time-selectors{height:0;overflow:hidden;padding:0;transition:height .3s;display:flex}mv-search-departure-options .departures-options-container .time-selectors.shown{height:20px;padding-bottom:25px}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selectors.shown{margin:0 22px 0 66px}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selectors.shown{margin:0 66px 0 22px}mv-search-departure-options .departures-options-container .time-selectors>div{position:relative;width:50%}html[dir=ltr] mv-search-departure-options .departures-options-container .time-selectors>div:first-of-type{margin-right:20px}html[dir=rtl] mv-search-departure-options .departures-options-container .time-selectors>div:first-of-type{margin-left:20px}mv-search-departure-options .departures-options-container .time-selectors>div span{color:#bdc3c7;border-bottom:1px solid #BDC3C7;padding-bottom:2px;width:100%;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center}mv-search-departure-options .departures-options-container .time-selectors>div span:after{content:"";display:block;width:9px;height:4px;background:url(/images/icons/expand_light_gray.svg) no-repeat;background-size:contain;transition:all,.3s;transform:none}\n'],encapsulation:2}),e})();const W=["fromInput"],Q=["toInput"];function K(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-back-button",10),s.NdJ("backClick",function(){return s.CHM(e),s.oxw().onBack()}),s.qZA()}2&e&&s.Q6J("titleTextKey","a11y_exit_search")}function X(e,t){1&e&&s._UZ(0,"mv-search-departure-options")}let ee=(()=>{class e{constructor(e,t,n,r,o,a,s,l,c,d,u,p,h){this.store=e,this.storeHelper=t,this.analyticsService=n,this.customerService=r,this.splashDisplay=o,this.searchActions=a,this.errorActions=s,this.elementRef=l,this.document=c,this.a11y=d,this.routingService=u,this.universal=p,this.platformService=h,this.FromTo=i.$h,this.unsubscribes=[],this.unsubscribes.push(t.subscribe("directions.suggestedRoutes.loadingState",(e,t)=>{t==i.Gu.NOT_LOADED&&e==i.Gu.LOADING&&(l.nativeElement.querySelector(".search-input-from input").blur(),l.nativeElement.querySelector(".search-input-to input").blur())}))}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){if(yield(0,a.p5)(this.store),this.universal.isBrowser){const{searchTextFrom:e,searchTextTo:t}=this.routingService.getStateFromUrl();e?(this.searchTextFrom=e,this.routingService.updateUrlParams({searchTextFrom:null,searchTextTo:null})):t&&(this.searchTextTo=t,this.routingService.updateUrlParams({searchTextFrom:null,searchTextTo:null}))}})}ngOnDestroy(){this.unsubscribes.forEach(e=>{e()})}get state(){return this.store.getState()}get tabIndex(){return null===this.state.directions.search.searchInputTypeFocused?-1:0}get shouldShowDepartureOptions(){return this.storeHelper.shouldShowDepartureOptions}get searchState(){return this.store.getState().directions.search}get activeField(){return this.searchState.currentActiveSearchField}get fromPlaceHolder(){return this.customerService.getTranslationKey(this.state.customer.currentCustomer,"trip_plan_source_hint")}get toPlaceHolder(){return this.customerService.getTranslationKey(this.state.customer.currentCustomer,"trip_plan_destination_hint")}switchLocations(){this.store.dispatch(this.searchActions.switchLocations())}changeSearch(e,t){this.store.dispatch(this.searchActions.setFromOrToText(t,e)),e||this.clearSearchResults()}runSearch(e){!e||this.store.dispatch(this.searchActions.search(e))}exitSearchDisplay(){window.scrollTo(0,1),this.setSearchFieldFocused(null)}onBack(){(this.activeField===i.$h.From?this.fromInput:this.toInput).input.nativeElement.focus(),this.exitSearchDisplay()}onFocus(e){this.activeField!=e&&this.hideSearchResults(),this.state.global.splashScreen&&this.splashDisplay.invokeDismissal(),this.hideErrors(),this.setActiveSearchField(e),this.setSearchFieldFocused(e)}setSearchFieldFocused(e){let t=null;null!==e&&(t=e===i.$h.From?i.t2.DirectionFrom:i.t2.DirectionTo),this.store.dispatch(this.searchActions.setSearchInputTypeFocused(t))}setActiveSearchField(e){this.store.dispatch(this.searchActions.setActiveSearchField(e))}hideSearchResults(){this.store.dispatch(this.searchActions.hideSearchResults())}clearSearchResults(){this.store.dispatch(this.searchActions.clearSearchResults())}hideErrors(){this.store.dispatch(this.errorActions.clearErrors())}locationSelected(e){this.store.dispatch(this.searchActions.setSearchInputTypeFocused(null));const t=e==i.$h.From?this.fromInput:this.toInput;t.updateText(),this.a11y.byEnter?setTimeout(()=>{var e;null===(e=this.document.getElementById(t.clearButton.nativeElement.id))||void 0===e||e.focus()}):this.platformService.isDesktop&&this.focusOnEmptyLocationField()}focusOnEmptyLocationField(){const{from:e,to:t,currentActiveSearchField:n}=this.searchState,r=!e.latlng,o=!t.latlng;let a;void 0===n?o?a=i.$h.To:r&&(a=i.$h.From):a=n==i.$h.From&&o?i.$h.To:n==i.$h.To&&r?i.$h.From:i.$h.To,(a==i.$h.From?this.fromInput:this.toInput).setFocusIfEmpty()}onKeydown(e){"Escape"===e.key&&this.exitSearchDisplay()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(c.N),s.Y36(d.y),s.Y36(u.v),s.Y36(p.Y),s.Y36(h.P),s.Y36(m.f),s.Y36(s.SBq),s.Y36(o.K0),s.Y36(g.F),s.Y36(f.Z),s.Y36(v.p),s.Y36(y.mi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-control"]],viewQuery:function(e,t){if(1&e&&(s.Gf(W,5),s.Gf(Q,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.fromInput=e.first),s.iGM(e=s.CRH())&&(t.toInput=e.first)}},hostBindings:function(e,t){1&e&&s.NdJ("keydown",function(e){return t.onKeydown(e)},!1,s.Jf7)},decls:11,vars:11,consts:[[1,"search-container"],[1,"from-to-dots"],["class","gray-fill",3,"titleTextKey","backClick",4,"ngIf"],[1,"search-inputs"],[1,"search-input-wrapper"],[1,"search-input-from",3,"searchTextFromUrl","fromTo","placeholder","label","hasSwitchButton","changeValue","runSearch","focus","switchLocations"],["fromInput",""],[1,"search-input-to",3,"searchTextFromUrl","fromTo","placeholder","label","focus","changeValue","runSearch"],["toInput",""],[4,"ngIf"],[1,"gray-fill",3,"titleTextKey","backClick"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s._UZ(1,"div",1),s.YNc(2,K,1,1,"mv-back-button",2),s.TgZ(3,"div",3),s.TgZ(4,"div",4),s.TgZ(5,"mv-search-input",5,6),s.NdJ("changeValue",function(e){return t.changeSearch(e,t.FromTo.From)})("runSearch",function(e){return t.runSearch(e)})("focus",function(){return t.onFocus(t.FromTo.From)})("switchLocations",function(){return t.switchLocations()}),s.qZA(),s.qZA(),s.TgZ(7,"div",4),s.TgZ(8,"mv-search-input",7,8),s.NdJ("focus",function(){return t.onFocus(t.FromTo.To)})("changeValue",function(e){return t.changeSearch(e,t.FromTo.To)})("runSearch",function(e){return t.runSearch(e)}),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(10,X,1,0,"mv-search-departure-options",9)),2&e&&(s.xp6(2),s.Q6J("ngIf",t.platformService.isMobile),s.xp6(3),s.Q6J("searchTextFromUrl",t.searchTextFrom)("fromTo",t.FromTo.From)("placeholder",t.fromPlaceHolder)("label","position_start")("hasSwitchButton",!0),s.xp6(3),s.Q6J("searchTextFromUrl",t.searchTextTo)("fromTo",t.FromTo.To)("placeholder",t.toPlaceHolder)("label","position_end"),s.xp6(2),s.Q6J("ngIf",t.shouldShowDepartureOptions))},directives:[o.O5,k,M.W,J],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-search-control{position:relative;z-index:1}mv-search-control .search-container{background-color:#292a30;width:100%;box-sizing:border-box;display:flex;align-items:center;padding:0 22px;transition:all ease-in-out .3s;height:135px;overflow:hidden}body.mobile mv-search-control .search-container{position:fixed;top:4.7058823529rem;z-index:10000}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-search-control .search-container{height:115px}}mv-search-control .search-container .from-to-dots{background:url(/images/dot.svg) repeat-y;min-width:25px;height:60px;background-size:5px;position:relative;transition:height .3s ease-in-out .3s}html[dir=ltr] mv-search-control .search-container .from-to-dots{background-position:left 14px}html[dir=rtl] mv-search-control .search-container .from-to-dots{background-position:right 14px}mv-search-control .search-container .search-inputs{flex-grow:1;position:relative}mv-search-control .search-container .search-inputs .search-input-wrapper{position:relative}mv-search-control .search-container .search-inputs .search-input-wrapper:before,mv-search-control .search-container .search-inputs .search-input-wrapper:after{background:#292A30;border:2px solid #737578;border-radius:50%;content:"";display:block;height:6px;position:absolute;top:50%;width:6px;transform:translateY(-50%);transition:all .3s ease-in-out .3s}html[dir=ltr] mv-search-control .search-container .search-inputs .search-input-wrapper:before,html[dir=ltr] mv-search-control .search-container .search-inputs .search-input-wrapper:after{left:-27px}html[dir=rtl] mv-search-control .search-container .search-inputs .search-input-wrapper:before,html[dir=rtl] mv-search-control .search-container .search-inputs .search-input-wrapper:after{right:-27px}mv-search-control .search-container .search-inputs .search-input-wrapper:last-of-type:before,mv-search-control .search-container .search-inputs .search-input-wrapper:last-of-type:after{background:#f0500c;border-color:#f0500c}@-webkit-keyframes pulse{0%{opacity:0;transform:translateY(-50%) scale(1)}33%{opacity:.6}to{opacity:0;transform:translateY(-50%) scale(2)}}@keyframes pulse{0%{opacity:0;transform:translateY(-50%) scale(1)}33%{opacity:.6}to{opacity:0;transform:translateY(-50%) scale(2)}}\n'],encapsulation:2}),e})();var te=n(13691),ne=n(31251),ie=n(97192),re=n(1210),oe=n(32968),ae=n(31127),se=n(83486),le=n(31234),ce=n(58318),de=n(26365),ue=n(32066),pe=n(79223),he=n(86607);function me(e,t){if(1&e&&(s._UZ(0,"span",13),s.ALo(1,"safeHtml"),s.ALo(2,"async"),s.ALo(3,"asyncify")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,s.lcZ(3,5,e.taxiLogoBackground))),s.oJD)}}function ge(e,t){if(1&e&&(s._UZ(0,"div",14),s.ALo(1,"safeHtml"),s.ALo(2,"async"),s.ALo(3,"asyncify")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,s.lcZ(3,5,e.taxiLogoImage))),s.oJD)}}function fe(e,t){if(1&e&&(s.TgZ(0,"span",15),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Oqu(e.time)}}function ve(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"div",1),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",2),s.NdJ("click",function(){return s.CHM(e),s.oxw().goToActiveRideScreen()}),s.YNc(5,me,4,7,"span",3),s.TgZ(6,"div",4),s.TgZ(7,"div",5),s.TgZ(8,"div",6),s.YNc(9,ge,4,7,"div",7),s._UZ(10,"div",8),s.qZA(),s.TgZ(11,"div"),s.TgZ(12,"button",9),s._uU(13),s.ALo(14,"translate"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(15,"div",10),s._uU(16),s.ALo(17,"translate"),s.YNc(18,fe,2,1,"span",11),s.qZA(),s.TgZ(19,"div",12),s._uU(20),s.ALo(21,"translate"),s.qZA(),s.qZA(),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,11,e.isFutureRide?"tod_passenger_ride_label_future":"tod_real_time_section_title")," "),s.xp6(2),s.ekj("active",e.isRideActive),s.xp6(1),s.Q6J("ngIf",e.taxiLogoBackground),s.xp6(4),s.Q6J("ngIf",e.taxiLogoImage),s.xp6(1),s.Udp("background-color",e.agencyAnimationColor),s.xp6(3),s.Oqu(s.lcZ(14,13,"action_more")),s.xp6(3),s.hij(" ",s.lcZ(17,15,e.title)," "),s.xp6(2),s.Q6J("ngIf",e.time),s.xp6(2),s.Oqu(s.lcZ(21,17,e.subtitle))}}let ye=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c){this._cd=e,this.store=t,this.routingService=n,this.canonicalService=i,this.todService=r,this.metroService=o,this.imageService=a,this.translateService=s,this.universalUtilityService=l,this.analyticsService=c}ngOnInit(){var e,t,n,i;return(0,r.mG)(this,void 0,void 0,function*(){if(this.universalUtilityService.isServer)return;yield(0,a.p5)(this.store);const{metro:r,user:o}=this.store.getState();if(!(null===(e=o.account)||void 0===e?void 0:e.userKey))return;const s=yield this.todService.myRides();if(null===(t=null==s?void 0:s.rides)||void 0===t?void 0:t.length){if(this.setLastRide(s.rides),this.analyticsService.sendEvent(d.a.TODGeneral,"TOD_SECTION_IMPRESSION"),this.taxiMetaData=null===(n=r.currentMetro.taxiMetroConfigurations.find(e=>e.taxiId===this.lastTodRideInfo.taxiProviderId))||void 0===n?void 0:n.metadata,this.taxiMetaData){const{shortImage:e,suggestRoutes:t}=this.taxiMetaData,{backdropImage:n}=t;this.taxiLogoImage=this.getPromiseImage(e),this.taxiLogoBackground=this.getPromiseImage(n)}yield this.updateRealTimeInfo(),!this._cd.destroyed&&(this.isRideActive&&(this.dataRefreshTimer=setInterval(this.updateRealTimeInfo.bind(this),this.todService.realTimeInfoRefreshTimeInMS)),this.agencyAnimationColor=(null===(i=this.taxiMetaData)||void 0===i?void 0:i.ctaBackgroundColor)?(0,le.vq)(this.taxiMetaData.ctaBackgroundColor):"unset")}})}ngOnDestroy(){this.cancelTimout()}setLastRide(e){if(this.lastTodRideInfo=e.find(e=>e.status===se.Rl.ACTIVE),this.lastTodRideInfo)return;let t,n;t=e.filter(e=>e.status===se.Rl.FUTURE),t||(t=e),t.forEach(e=>{if(e.orderTime){const t=Math.abs(C()().diff(e.orderTime));(!this.lastTodRideInfo||n>t)&&(n=t,this.lastTodRideInfo=e)}}),this.lastTodRideInfo||(this.lastTodRideInfo=e[0])}updateRealTimeInfo(){return(0,r.mG)(this,void 0,void 0,function*(){const e=yield this.todService.realTimeInfo(this.lastTodRideInfo.rideId);this.realTimeInfo=null==e?void 0:e.info,this.isRideActive||this.cancelTimout();const{title:t,subtitle:n,time:i}=this.titles();this.title=t,this.subtitle=n,this.time=i})}get shouldShowComponent(){if(!this.realTimeInfo)return!1;const e=(this.realTimeInfo.pickTime||this.lastTodRideInfo.orderTime)<Date.now()-3e5;return this.isRideActive||!e}get isRideActive(){var e;return(null===(e=this.realTimeInfo)||void 0===e?void 0:e.rideStatus)===se.Rl.ACTIVE}cancelTimout(){this.dataRefreshTimer&&clearInterval(this.dataRefreshTimer)}getPromiseImage(e){return(null==e?void 0:e.imageId)?this.imageService.getImageHTML(e.imageId,e.parameters):null}unknownRealTimeStatus(){return{title:this.translateService.instant("tod_passenger_real_time_status_unknown"),subtitle:""}}get isFutureRide(){var e;return(null===(e=this.lastTodRideInfo)||void 0===e?void 0:e.status)===se.Rl.FUTURE}titles(){var e,t;const{status:n}=this.lastTodRideInfo,{pickup:i,dropoff:r}=this.lastTodRideInfo.journeyInfo;if(this.isFutureRide){if(!this.lastTodRideInfo.orderTime)return this.unknownRealTimeStatus();let n;const i=C()(this.lastTodRideInfo.orderTime);if(this.lastTodRideInfo.journeyInfo){const{destination:e,dropoff:t,origin:r,pickup:o}=this.lastTodRideInfo.journeyInfo;e&&r&&!o&&!t&&(n=this.translateService.instant("tod_passenger_order_future_pickup_details",{param1:i.format("L"),param2:i.format("LT")}))}return n||(n=`${this.translateService.instant("tod_passenger_ride_real_time_heading_pickup",{param1:i.format("L")})} \u2022 ${this.translateService.instant("tod_passenger_ride_at",{param1:i.format("LT")})}`),{title:n,subtitle:(null===(e=this.taxiMetaData)||void 0===e?void 0:e.name)?this.translateService.instant("tod_future_ride_provider_name",{param1:null===(t=this.taxiMetaData)||void 0===t?void 0:t.name}):""}}if(n===se.Rl.CANCELLED||n===se.Rl.DECLINED)return{title:"tod_passenger_ride_status_cancelled_title",subtitle:"tod_passenger_ride_status_cancelled_message"};if(n===se.Rl.NO_SHOW)return{title:"tod_passenger_ride_status_passenger_not_shown_message_new",subtitle:"tod_passenger_ride_status_passenger_not_shown_title"};if(n===se.Rl.COMPLETED)return{title:"tod_passenger_real_time_status_arrived_to_destination",subtitle:r.caption};if(n===se.Rl.ACTIVE){const{journeyStatus:e,pickTime:t,dropOffTime:n}=this.realTimeInfo;switch(e){case se.fL.HEADING_PICKUP:return t?{title:this.translateService.instant("tod_passenger_ride_real_time_heading_pickup",{param1:""}),subtitle:i.caption,time:C()(t).fromNow(!0)}:this.unknownRealTimeStatus();case se.fL.APPROACHING_PICKUP:case se.fL.ARRIVED_PICKUP:return{title:"tod_passenger_real_time_status_arrived",subtitle:i.caption};case se.fL.HEADING_DROP_OFF:case se.fL.APPROACHING_DROP_OFF:return n?{title:this.translateService.instant("tod_passenger_real_time_status_on_ride",{param1:""}),subtitle:r.caption,time:C()(n).fromNow(!0)}:this.unknownRealTimeStatus();case se.fL.ARRIVED_DROP_OFF:return{title:"tod_passenger_real_time_status_arrived_to_destination",subtitle:r.caption};default:return{title:"",subtitle:""}}}}goToActiveRideScreen(){const e=[this.lastTodRideInfo.rideId,this.analyticsService.todMode(this.lastTodRideInfo.status),this.lastTodRideInfo.taxiProviderId,se.YK[this.lastTodRideInfo.status]].join(", ");this.analyticsService.sendEvent(d.a.TODGeneral,"TOD_ACTIVE_RIDE_CLICKED",e),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TOD_ACTIVE_RIDE),{todRideId:this.lastTodRideInfo.rideId})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(s.sBO),s.Y36(l.d),s.Y36(f.Z),s.Y36(R.z),s.Y36(ce.F),s.Y36(de.V),s.Y36(ue.KD),s.Y36(_.sK),s.Y36(v.p),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-last-ride-route-section"]],decls:1,vars:1,consts:[[4,"ngIf"],["role","heading","aria-level","2",1,"title"],[1,"last-ride-info",3,"click"],["class","agency-background",3,"innerHTML",4,"ngIf"],[1,"agency-info"],[1,"agency-info-top"],[1,"agency-icon-wrapper"],["class","agency-icon",3,"innerHTML",4,"ngIf"],[1,"icon-animated-background"],[1,"more-details-button"],[1,"active-title"],["class","rt-text",4,"ngIf"],[1,"active-subtitle"],[1,"agency-background",3,"innerHTML"],[1,"agency-icon",3,"innerHTML"],[1,"rt-text"]],template:function(e,t){1&e&&s.YNc(0,ve,22,19,"ng-container",0),2&e&&s.Q6J("ngIf",t.shouldShowComponent)},directives:[o.O5],pipes:[_.X$,pe.z,o.Ov,he.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-last-ride-route-section .agency-background{position:absolute;bottom:0}html[dir=ltr] mv-tod-last-ride-route-section .agency-background{right:0}html[dir=rtl] mv-tod-last-ride-route-section .agency-background{left:0}mv-tod-last-ride-route-section .agency-background .mvf-wrapper,mv-tod-last-ride-route-section .agency-background .mvf-wrapper img{height:auto;max-height:60px;max-width:250px}mv-tod-last-ride-route-section .title{background:#ECF0F1;font-size:.9411764706rem;color:#292a30;padding:0 20px;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;min-height:40px}mv-tod-last-ride-route-section .last-ride-info{position:relative;padding:13px 20px 20px;border-bottom:1px solid #ECF0F1}mv-tod-last-ride-route-section .last-ride-info.active .agency-info .agency-icon-wrapper .icon-animated-background{display:block}mv-tod-last-ride-route-section .last-ride-info>div{position:relative}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-info-top{display:flex;justify-content:space-between}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper{position:relative}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .agency-icon{position:relative;display:flex;align-items:center;justify-content:center;width:2.7058823529rem;height:2.7058823529rem}html[dir=ltr] mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .agency-icon{left:-.6470588235rem}html[dir=rtl] mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .agency-icon{right:-.6470588235rem}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .agency-icon .mvf-wrapper{z-index:1}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .agency-icon .mvf-wrapper .boxed{border-bottom:none}@-webkit-keyframes agency-pulse{0%{transform:scale(0)}55%{transform:scale(1);opacity:0}to{opacity:0}}@keyframes agency-pulse{0%{transform:scale(0)}55%{transform:scale(1);opacity:0}to{opacity:0}}mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .icon-animated-background{display:none;position:absolute;top:0;width:100%;height:100%;border-radius:50%;transform:scale(1);-webkit-animation:agency-pulse 3s ease-out infinite;animation:agency-pulse 3s ease-out infinite}html[dir=ltr] mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .icon-animated-background{right:.6470588235rem}html[dir=rtl] mv-tod-last-ride-route-section .last-ride-info .agency-info .agency-icon-wrapper .icon-animated-background{left:.6470588235rem}mv-tod-last-ride-route-section .last-ride-info .agency-info .active-title{margin-top:4px;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-tod-last-ride-route-section .last-ride-info .agency-info .active-subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357;margin-top:4px}mv-tod-last-ride-route-section .last-ride-info .more-details-button{background-color:#0a73eb;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#fff;padding:4px 8px;border-radius:4px;margin-top:10px;min-width:48px}mv-tod-last-ride-route-section .rt-text{position:relative;color:#038844}html[dir=ltr] mv-tod-last-ride-route-section .rt-text{margin-left:.5882352941rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text{margin-right:.5882352941rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text:before,html[dir=rtl] mv-tod-last-ride-route-section .rt-text:after{transform:scaleX(-1)}mv-tod-last-ride-route-section .rt-text:before{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:.4705882353rem;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-last-ride-route-section .rt-text:before{left:-.3529411765rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text:before{right:-.3529411765rem}@media (prefers-reduced-motion: reduce){mv-tod-last-ride-route-section .rt-text:before{-webkit-animation:none;animation:none}}mv-tod-last-ride-route-section .rt-text:after{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.9411764706rem;position:absolute;top:.2941176471rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-last-ride-route-section .rt-text:after{left:-.5882352941rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text:after{right:-.5882352941rem}@media (prefers-reduced-motion: reduce){mv-tod-last-ride-route-section .rt-text:after{-webkit-animation:none;animation:none}}html[dir=ltr] mv-tod-last-ride-route-section .rt-text:before{top:.1176470588rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text:before{top:.1470588235rem}mv-tod-last-ride-route-section .rt-text:after{top:-.0411764706rem}html[dir=ltr] mv-tod-last-ride-route-section .rt-text:after{top:-.0411764706rem}html[dir=rtl] mv-tod-last-ride-route-section .rt-text:after{top:0rem}\n'],encapsulation:2}),e})();var be=n(91547),_e=n(43681),Te=n(87479),Se=n(93975);function xe(e,t){if(1&e&&(s._UZ(0,"span",0),s.ALo(1,"safeHtml")),2&e){const e=s.oxw().$implicit;s.Q6J("innerHTML",s.lcZ(1,1,e.data),s.oJD)}}function we(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.data)}}function ke(e,t){if(1&e&&(s.TgZ(0,"div",4),s.YNc(1,xe,2,3,"span",5),s.YNc(2,we,2,1,"span",6),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Q6J("ngIf",e.isImage),s.xp6(1),s.Q6J("ngIf",!e.isImage)}}let Me=(()=>{class e{constructor(){}ngOnInit(){}trackByAddress(e){return e.data}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-location-result"]],inputs:{location:"location"},decls:7,vars:9,consts:[[3,"innerHTML"],[1,"location-info"],[1,"name"],["class","address",4,"ngFor","ngForOf","ngForTrackBy"],[1,"address"],[3,"innerHTML",4,"ngIf"],[4,"ngIf"]],template:function(e,t){1&e&&(s._UZ(0,"span",0),s.ALo(1,"safeHtml"),s.TgZ(2,"div",1),s.TgZ(3,"div",2),s._uU(4),s.qZA(),s.TgZ(5,"div"),s.YNc(6,ke,3,2,"div",3),s.qZA(),s.qZA()),2&e&&(s.Gre("location-icon ","location-icon-"+t.location.type,""),s.Q6J("innerHTML",s.lcZ(1,7,t.location.imageHtml),s.oJD),s.xp6(4),s.Oqu(t.location.name),s.xp6(2),s.Q6J("ngForOf",t.location.address)("ngForTrackBy",t.trackByAddress))},directives:[o.sg,o.O5],pipes:[pe.z],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-location-result{cursor:pointer}\n"],encapsulation:2,changeDetection:0}),e})();function Le(e,t){if(1&e&&(s.TgZ(0,"div",3),s.TgZ(1,"div",4),s._UZ(2,"svg-icon",5),s.ALo(3,"translate"),s.qZA(),s._UZ(4,"span",6),s.qZA()),2&e){const e=s.oxw();s.xp6(2),s.s9C("titleText",s.lcZ(3,2,"NoTripPlanFoundTitle")),s.xp6(2),s.Q6J("innerHTML",e.emptyResultsErrorMessage,s.oJD)}}function Ae(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-location-result",7),s.NdJ("keydown",function(t){const n=s.CHM(e).index;return s.oxw().onKeydown(t,n)})("click",function(){const t=s.CHM(e),n=t.$implicit,i=t.index;return s.oxw().selectLocation(n,i)}),s.qZA()}if(2&e){const e=t.index;s.Q6J("location",t.$implicit)("id","location_"+e)("tabIndex",e?-1:0)}}let Ie=(()=>{class e{constructor(e,t,n,i,r,o,a){this.document=e,this.store=t,this.translate=n,this.searchActions=i,this.analyticsService=r,this.metroService=o,this.searchService=a}get state(){return this.store.getState()}get searchState(){return this.state.directions.search}get searchResults(){return this.searchState.currentSearchResults}get emptyResultsErrorMessage(){const e=this.metroService.getCurrentMetroName();return this.translate.instant("search_location_empty_results_web",{CITY:e}).replace("\\n","<br/>")}get isLoaded(){return this.searchState.resultsLoadingState==i.Gu.LOADED}get shouldShowEmptyResultsError(){return 0==this.searchResults.length&&this.isLoaded}trackBySearchResult(e){return e.id}selectLocation(e,t){return(0,r.mG)(this,void 0,void 0,function*(){!e.latlng&&e.uid&&(yield this.store.dispatch(this.searchActions.enrichLocationLatLon(e))),this.analyticsService.trackSelectSearchLocation(e,t),this.store.dispatch(this.searchActions.addRecentLocation(e)),this.store.dispatch(this.searchActions.setSelectedLocationToCurrent(e)),this.select()})}onKeydown(e,t){"ArrowUp"===e.key&&t-1>=0?(e.preventDefault(),this.setSelectedFocus(t-1)):"ArrowDown"===e.key&&t+1<this.searchResults.length?(e.preventDefault(),this.setSelectedFocus(t+1)):"Enter"===e.key&&(e.preventDefault(),this.selectLocation(this.searchResults[t],t))}setSelectedFocus(e){const t=this.document.getElementById(`location_${e}`);t&&(t.focus(),t.scrollIntoView({block:"center"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(_.sK),s.Y36(h.P),s.Y36(d.y),s.Y36(de.V),s.Y36(_e.o))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-results"]],inputs:{select:"select"},decls:3,vars:3,consts:[[1,"location-inner"],["class","empty-results","role","alert",4,"ngIf"],["role","option",3,"location","id","tabIndex","keydown","click",4,"ngFor","ngForOf","ngForTrackBy"],["role","alert",1,"empty-results"],[1,"empty-icon"],["src","images/error-states/img_empty_state_omni.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],[1,"error-message-text",3,"innerHTML"],["role","option",3,"location","id","tabIndex","keydown","click"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,Le,5,4,"div",1),s.YNc(2,Ae,1,3,"mv-location-result",2),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngIf",t.shouldShowEmptyResultsError),s.xp6(1),s.Q6J("ngForOf",t.searchResults)("ngForTrackBy",t.trackBySearchResult))},directives:[o.O5,o.sg,Te.bk,Se.m,Me],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-search-results{overflow-y:auto}mv-search-results .empty-results{text-align:center;padding:20px}mv-search-results .empty-results .icon{margin-bottom:20px}\n"],encapsulation:2}),e})();var Ee=n(1238);let Ce=(()=>{class e{constructor(e,t,n){this.store=e,this.globalActions=t,this.analyticsService=n}ngOnInit(){}get state(){return this.store.getState()}get locationsType(){return this.state.directions.search.currentActiveSearchField}get canSwitchMetros(){const e=this.state.customer.currentCustomer.designConfiguration;return!e||!e.hideMetroSelection&&!e.showOnlyLanguageSelection}useCurrentLocation(){return(0,r.mG)(this,void 0,void 0,function*(){this.analyticsService.trackUseCurrentLocationClick(),this.analyticsService.trackUseCurrentLocation(),this.store.dispatch(this.globalActions.useCurrentLocation(this.locationsType,()=>this.select()))})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(Ee.l),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-current-location"]],inputs:{select:"select"},decls:6,vars:6,consts:[["role","button","tabindex","0",1,"use-current-location",3,"click","keydown.enter"],["src","images/icons/current_location.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.NdJ("click",function(){return t.useCurrentLocation()})("keydown.enter",function(){return t.useCurrentLocation()}),s._UZ(1,"svg-icon",1),s.ALo(2,"translate"),s.TgZ(3,"span"),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e&&(s.xp6(1),s.s9C("titleText",s.lcZ(2,2,"user_location_description")),s.xp6(3),s.Oqu(s.lcZ(5,4,"tripplan_from_location")))},directives:[Te.bk,Se.m],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.use-current-location{font-size:.9411764706rem;color:#292a30;padding:15px 0 16px;transition:all .3s;display:flex;justify-content:flex-start;align-items:center}html[dir=ltr] .use-current-location{padding-left:24px}html[dir=rtl] .use-current-location{padding-right:24px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){.use-current-location{padding:10px 0 7px}}.use-current-location:hover{background:#f9fbfb}.use-current-location svg-icon{margin:0;width:25px}html[dir=ltr] .use-current-location svg-icon{margin-right:16px}html[dir=rtl] .use-current-location svg-icon{margin-left:16px}.use-current-location svg-icon path{fill:#0078d6;transition:all .3s}mv-updates-message:not(:empty)+.use-current-location{margin-top:0}mv-updates-message:empty+.use-current-location{margin-top:10px}\n"],encapsulation:2}),e})(),De=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-instructions"]],decls:4,vars:3,consts:[[1,"error-message-text"]],template:function(e,t){1&e&&(s.TgZ(0,"div"),s.TgZ(1,"span",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Oqu(s.lcZ(3,1,"a11y_start_to_end_route")))},pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-search-instructions{margin:14px 0;padding:0 20px;text-align:center;display:block}\n"],encapsulation:2}),e})();function Pe(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"mv-location-result",4),s.NdJ("keydown",function(t){const n=s.CHM(e).index;return s.oxw().onKeydown(t,n)})("click",function(){const t=s.CHM(e).$implicit;return s.oxw().selectLocation(t)}),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,n=t.index;s.xp6(1),s.Q6J("location",e)("id","recent-location_"+n)("tabIndex",n?-1:0)}}let Oe=(()=>{class e{constructor(e,t,n,i){this.document=e,this.store=t,this.searchActions=n,this.analyticsService=i,this.locations=[]}ngOnInit(){}get state(){return this.store.getState()}trackByLocation(e,t){return t.id>0?t.id:[t.name,t.latlng.lat,t.latlng.lng].join("_")}selectLocation(e){this.analyticsService.trackSelectRecentLocation(e),this.store.dispatch(this.searchActions.setSelectedLocationToCurrent(e)),this.select()}onKeydown(e,t){"ArrowUp"===e.key&&t-1>=0?(e.preventDefault(),this.setSelectedFocus(t-1)):"ArrowDown"===e.key&&t+1<this.locations.length?(e.preventDefault(),this.setSelectedFocus(t+1)):"Enter"===e.key&&(e.preventDefault(),this.selectLocation(this.locations[t]))}setSelectedFocus(e){const t=this.document.getElementById(`recent-location_${e}`);t&&(t.focus(),t.scrollIntoView({block:"center"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(h.P),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-recent-locations"]],inputs:{locations:"locations",select:"select"},decls:6,vars:5,consts:[[1,"recent-location"],["role","heading","aria-level","2",1,"recent-locations-title"],["role","list"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","listitem",3,"location","id","tabIndex","keydown","click"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",2),s.YNc(5,Pe,2,3,"div",3),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.hij(" ",s.lcZ(3,3,"search_recent_section_title")," "),s.xp6(3),s.Q6J("ngForOf",t.locations)("ngForTrackBy",t.trackByLocation))},directives:[o.sg,Me],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}\n"],encapsulation:2}),e})(),Ne=(()=>{class e{constructor(e,t,n){this.a11y=e,this.analyticsService=t,this.store=n}ngOnInit(){}get state(){return this.store.getState()}onBuyTicketsClick(){var e;const t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.ticketsUrl;t&&(this.analyticsService.trackBuyPassesLink(t),window.open(t,"_blank"))}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(g.F),s.Y36(d.y),s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-buy-ticket-link"]],decls:6,vars:6,consts:[[1,"buy-tickets-link",3,"click"],["src","images/icons/ticket_icon_full.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"]],template:function(e,t){1&e&&(s.TgZ(0,"a",0),s.NdJ("click",function(){return t.onBuyTicketsClick()}),s._UZ(1,"svg-icon",1),s.ALo(2,"translate"),s.TgZ(3,"span"),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e&&(s.xp6(1),s.Q6J("titleText",s.lcZ(2,2,"buy_tickets")),s.xp6(3),s.Oqu(s.lcZ(5,4,"buy_tickets")))},directives:[Te.bk,Se.m],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-buy-ticket-link{height:40px;display:flex;align-items:center;padding:0 20px}mv-buy-ticket-link a{color:#0c69da;display:flex}mv-buy-ticket-link a span{padding:0 5px;font-size:.9411764706rem;line-height:18px}mv-buy-ticket-link a svg-icon,mv-buy-ticket-link a svg-icon svg{width:18px;height:18px}mv-buy-ticket-link a svg-icon path,mv-buy-ticket-link a svg-icon rect{fill:#0c69da}\n"],encapsulation:2}),e})();var Re=n(97175),$e=n(43445),Ye=n(5),Fe=n(82909),Be=n(41187),Ue=n(19581);function Ze(e,t){if(1&e&&(s.TgZ(0,"div",2),s.TgZ(1,"span",3),s._uU(2),s.qZA(),s.TgZ(3,"i",4),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e){const e=s.oxw();s.xp6(2),s.Oqu(e.durationMinutes),s.xp6(2),s.Oqu(s.lcZ(5,2,"min"))}}const je=["*"];let Ve=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-suggested-route-container"]],inputs:{durationMinutes:"durationMinutes"},ngContentSelectors:je,decls:3,vars:1,consts:[[1,"route-inner"],["class","route-time",4,"ngIf"],[1,"route-time"],[1,"duration"],[1,"minutes"]],template:function(e,t){1&e&&(s.F$t(),s.TgZ(0,"div",0),s.YNc(1,Ze,6,4,"div",1),s.Hsn(2),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngIf",void 0!==t.durationMinutes))},directives:[o.O5],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-suggested-route-container{width:100%}mv-suggested-route-container .route-inner{font-size:.9411764706rem;color:#292a30;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;box-sizing:border-box;width:100%;cursor:pointer}mv-suggested-route-container .route-inner .route-time{align-self:center;-webkit-align-self:center}mv-suggested-route-container .route-inner .route-time-summary{display:none}mv-suggested-route-container .route-inner .duration,mv-suggested-route-container .route-inner .minutes{transition:all,.3s}mv-suggested-route-container .route-inner .duration{display:block;font-size:1.4117647059rem;font-weight:500;line-height:1;text-align:center;width:69px}mv-suggested-route-container .route-inner .minutes{display:block;font-size:.5294117647rem;font-style:normal;text-align:center;text-transform:uppercase}\n"],encapsulation:2}),e})();function He(e,t){if(1&e&&(s.TgZ(0,"button",6),s._uU(1),s.qZA()),2&e){const e=s.oxw();s.Udp("background-color",e.ctaBackgroundColor)("color",e.ctaTextColor)("border-color",e.ctaTextColor),s.xp6(1),s.hij(" ",e.todBanner.action.text," ")}}let Ge=(()=>{class e{constructor(e,t,n,i){this.store=e,this.imageService=t,this.analyticsService=n,this.todService=i}ngOnInit(){var e;this.inputEmitterSubscription=null===(e=this.inputEmitter)||void 0===e?void 0:e.subscribe(this.showSchedule.bind(this));const t=this.getTaxiMetaData(this.todBanner.taxiId);if(t){const{ctaTextColor:e,longImage:n,mainColor:i}=t;n&&(this.taxiLogoImage=this.imageService.getImageHTML(n.imageId,n.parameters)),this.ctaBackgroundColor=i&&(0,le.vq)(i),this.ctaTextColor=e&&(0,le.vq)(e)}this.analytics()}ngOnDestroy(){var e;null===(e=this.inputEmitterSubscription)||void 0===e||e.unsubscribe()}analytics(){const e=this.getTaxiMetaData(this.todBanner.taxiId);e&&this.analyticsService.sendEvent(d.a.TODBanner,"TOD_INACTIVE_BANNER_IMPRESSION",[this.analyticsService.todMode(this.todService.defaultRideStatus()),this.todBanner.providerCustomerId,e.providerAnalyticName,this.store.getState().directions.suggestedRoutes.searchToken,this.todBanner.optionNumber].join(", "))}getTaxiMetaData(e){var t,n;return null==e?null:null===(n=null===(t=this.store.getState().metro.currentMetro.taxiMetroConfigurations)||void 0===t?void 0:t.find(t=>t.taxiId===e))||void 0===n?void 0:n.metadata}showSchedule(){var e;(null===(e=this.todBanner.action)||void 0===e?void 0:e.url)&&window.open(this.todBanner.action.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(ue.KD),s.Y36(d.y),s.Y36(ce.F))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-banner"]],inputs:{todBanner:"todBanner",inputEmitter:"inputEmitter"},decls:11,vars:8,consts:[[1,"inactive-tod"],[1,"text-wrapper"],[1,"provider-logo",3,"innerHTML"],[1,"title"],[1,"subtitle"],["class","more-info-btn",3,"background-color","color","border-color",4,"ngIf"],[1,"more-info-btn"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"div",2),s.ALo(3,"safeHtml"),s.ALo(4,"async"),s.TgZ(5,"div",3),s._uU(6),s.qZA(),s.TgZ(7,"div",4),s._uU(8),s.qZA(),s.qZA(),s.TgZ(9,"div"),s.YNc(10,He,2,7,"button",5),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Q6J("innerHTML",s.lcZ(3,4,s.lcZ(4,6,t.taxiLogoImage)),s.oJD),s.xp6(4),s.Oqu(t.todBanner.title),s.xp6(2),s.Oqu(t.todBanner.subtitle),s.xp6(2),s.Q6J("ngIf",t.todBanner.action&&t.todBanner.action.url))},directives:[o.O5],pipes:[pe.z,o.Ov],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-banner .inactive-tod{padding:22px;border-bottom:1px solid #ECF0F1;display:flex;justify-content:space-between}html[dir=ltr] mv-tod-banner .inactive-tod{padding-right:20px}html[dir=rtl] mv-tod-banner .inactive-tod{padding-left:20px}html[dir=ltr] mv-tod-banner .inactive-tod .text-wrapper{margin-right:9px}html[dir=rtl] mv-tod-banner .inactive-tod .text-wrapper{margin-left:9px}mv-tod-banner .inactive-tod .text-wrapper .title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30cc;font-weight:500;margin-top:12px}mv-tod-banner .inactive-tod .text-wrapper .subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a3099;margin-top:4px}mv-tod-banner .inactive-tod .more-info-btn{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;font-weight:500;padding:4px 8px;border-radius:4px;white-space:nowrap}\n"],encapsulation:2}),e})();function ze(e){switch(e){case se.Rl.DECLINED:case se.Rl.CANCELLED:return{color:"#E10C32",icon:"images/tod/ride-status-canceled-icon.svg",text:"tod_ride_status_canceled"};case se.Rl.NO_SHOW:return{color:"#E08408",icon:"images/tod/ride-status-no-show-icon.svg",text:"tod_ride_status_passenger_not_shown"};case se.Rl.COMPLETED:return{color:"#0ABA66",icon:"images/tod/ride-status-active-icon.svg",text:"tod_ride_status_completed"};default:return{color:"",icon:"",text:""}}}function qe(e){return C()(e).format("L, LT")}function Je(e){return{isFree:!(null==e?void 0:e.balance),price:`${(null==e?void 0:e.currencySymbol)||""}${(((null==e?void 0:e.balance)||0)/100).toFixed(2)}`}}function We(e,t){if(1&e&&(s.TgZ(0,"div",6),s._uU(1),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Oqu(e.dropOffTimeText)}}function Qe(e,t){if(1&e&&(s.TgZ(0,"a",7),s._uU(1),s.qZA()),2&e){const e=s.oxw();s.Udp("background-color",e.ctaBackgroundColor)("color",e.ctaTextColor),s.xp6(1),s.Oqu(e.ctaText)}}function Ke(e,t){if(1&e&&(s.TgZ(0,"div",8),s.TgZ(1,"a",7),s._uU(2),s.qZA(),s.TgZ(3,"div",9),s._uU(4),s.qZA(),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Udp("background-color",e.ctaBackgroundColor)("color",e.ctaTextColor),s.xp6(1),s.Oqu(e.ctaText),s.xp6(2),s.Oqu(e.price)}}let Xe=(()=>{class e{constructor(e,t,n,i,r,o,a,l){this.store=e,this.imageService=t,this.analyticsService=n,this.translateService=i,this.routingService=r,this.itineraryActions=o,this.canonicalService=a,this.userActions=l,this.orderEmitter=new s.vpe,this.ctaText="Order"}ngOnInit(){var e;this.inputEmitterSubscription=null===(e=this.inputEmitter)||void 0===e?void 0:e.subscribe(this.onOrder.bind(this));const{taxiId:t,price:n}=this.todBanner,i=this.getTaxiMetaData(t);if(i){const{ctaBackgroundColor:e,ctaTextColor:t,longImage:r,suggestRoutes:o}=i,{cta:a,pickupTimeText:s,backdropImage:l}=o;this.price=this.setPriceText(n),this.taxiLogoImage=this.getPromiseImage(r),this.taxiLogoBackground=this.getPromiseImage(l),this.ctaText=a,this.ctaBackgroundColor=e&&(0,le.vq)(e),this.ctaTextColor=t&&(0,le.vq)(t),this.buildPickupTimeText(s),this.analytics("TOD_BANNER_IMPRESSION")}}ngOnDestroy(){var e;null===(e=this.inputEmitterSubscription)||void 0===e||e.unsubscribe()}get state(){return this.store.getState()}analytics(e){const{taxiId:t,providerCustomerId:n,optionNumber:i}=this.todBanner,r=this.getTaxiMetaData(t);r&&this.analyticsService.sendEvent(d.a.TODBanner,e,[this.analyticsService.todMode(se.Rl.ACTIVE),n,r.providerAnalyticName,this.store.getState().directions.suggestedRoutes.searchToken,i].join(", "))}setPriceText(e){var t;if(e)if("number"==typeof e.balance){const{isFree:t,price:n}=Je(e);if(!t)return n}else if(null===(t=e.price)||void 0===t?void 0:t.match(/[1-9]/))return e.price;return this.translateService.instant("tod_free_ride")}getPromiseImage(e){return(0,r.mG)(this,void 0,void 0,function*(){return e?this.imageService.getImageHTML(e.imageId,e.parameters):null})}getTaxiMetaData(e){var t,n;return null==e?null:null===(n=null===(t=this.store.getState().metro.currentMetro.taxiMetroConfigurations)||void 0===t?void 0:t.find(t=>t.taxiId===e))||void 0===n?void 0:n.metadata}buildPickupTimeText(e){const{endTime:t,approxPickupTime:n,approxWaitingSecFromOrdering:i}=this.todBanner.times;if(this.todBanner.bannerType===se.Zf.ONLINE){const n=Math.ceil(i/60)||0,r=this.translateService.instant("units_minutes_text",{param1:n});this.pickupTimeText=(e||"").replace("%1$s",r).replace("%2$s",this.todBanner.waitAtLocation),this.dropOffTimeText=this.translateService.instant("tod_suggested_routes_eta",{param1:C()(t).format("LT")})}else{const e=C()(n);if(this.pickupTimeText=this.translateService.instant("tod_suggested_routes_approx_pickup",{param1:(0,I.a)(e,!1,!1),param2:e.format("LT")}),t){const e=(0,I.a)(t,!0,!1);this.dropOffTimeText=this.translateService.instant("tod_passenger_ride_eta_future_approx",{param1:e})}}}onOrder(){if(this.state.user.accountStatus!==Ye.dp.Authenticated)return this.store.dispatch(this.userActions.setPostLoginPath(this.canonicalService.buildStatefulPath([],D.zA.TOD_RIDE_ORDER))),void this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"]));this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TOD_RIDE_ORDER),{todProviderId:this.todBanner.providerCustomerId}),this.analytics("TOD_BANNER_CLICKED")}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(ue.KD),s.Y36(d.y),s.Y36(_.sK),s.Y36(f.Z),s.Y36(Fe.L),s.Y36(R.z),s.Y36(Be.E))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-suggested-route-tod"]],inputs:{todBanner:"todBanner",inputEmitter:"inputEmitter"},outputs:{orderEmitter:"orderEmitter"},decls:12,vars:14,consts:[[1,"provider-logo",3,"innerHTML"],[1,"provider-logo-bg",3,"innerHTML"],[1,"pickup-time"],["class","provider-eta",4,"ngIf"],["class","order-button",3,"background-color","color",4,"ngIf"],["class","order-wrapper",4,"ngIf"],[1,"provider-eta"],[1,"order-button"],[1,"order-wrapper"],[1,"price"]],template:function(e,t){1&e&&(s.TgZ(0,"div"),s._UZ(1,"div",0),s.ALo(2,"safeHtml"),s.ALo(3,"async"),s._UZ(4,"div",1),s.ALo(5,"safeHtml"),s.ALo(6,"async"),s.TgZ(7,"div",2),s._uU(8),s.qZA(),s.YNc(9,We,2,1,"div",3),s.qZA(),s.YNc(10,Qe,2,5,"a",4),s.YNc(11,Ke,5,6,"div",5)),2&e&&(s.xp6(1),s.Q6J("innerHTML",s.lcZ(2,6,s.lcZ(3,8,t.taxiLogoImage)),s.oJD),s.xp6(3),s.Q6J("innerHTML",s.lcZ(5,10,s.lcZ(6,12,t.taxiLogoBackground)),s.oJD),s.xp6(4),s.Oqu(t.pickupTimeText),s.xp6(1),s.Q6J("ngIf",t.dropOffTimeText),s.xp6(1),s.Q6J("ngIf",!t.price),s.xp6(1),s.Q6J("ngIf",t.price))},directives:[o.O5],pipes:[pe.z,o.Ov],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.route .route-inner mv-suggested-route-tod{border:none;display:flex;justify-content:space-between;align-items:center;position:relative;overflow:hidden;padding:20px}html[dir=ltr] .route .route-inner mv-suggested-route-tod{padding-left:0}html[dir=rtl] .route .route-inner mv-suggested-route-tod{padding-right:0}html[dir=ltr] .route .route-inner mv-suggested-route-tod:only-child{padding-left:20px}html[dir=rtl] .route .route-inner mv-suggested-route-tod:only-child{padding-right:20px}html[dir=ltr] .route .route-inner mv-suggested-route-tod.inactive{padding-left:0}html[dir=rtl] .route .route-inner mv-suggested-route-tod.inactive{padding-right:0}html[dir=ltr] .route .route-inner mv-suggested-route-tod>div{padding-right:15px}html[dir=rtl] .route .route-inner mv-suggested-route-tod>div{padding-left:15px}.route .route-inner mv-suggested-route-tod .order-button{padding:5px 15px;border-radius:3px;background-color:#2196f3;text-decoration:none;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#fff;margin-bottom:2px;align-self:flex-start}.route .route-inner mv-suggested-route-tod .provider-logo-bg{position:absolute;bottom:0;max-width:160px}html[dir=ltr] .route .route-inner mv-suggested-route-tod .provider-logo-bg{right:0}html[dir=rtl] .route .route-inner mv-suggested-route-tod .provider-logo-bg{left:0}.route .route-inner mv-suggested-route-tod .pickup-time{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#262b31;margin-top:4px}.route .route-inner mv-suggested-route-tod .provider-eta{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#6d7173;margin-top:4px}.route .route-inner mv-suggested-route-tod .order-wrapper{display:flex;flex-direction:column;align-items:flex-end;align-self:flex-start}html[dir=ltr] .route .route-inner mv-suggested-route-tod .order-wrapper{padding-right:0}html[dir=rtl] .route .route-inner mv-suggested-route-tod .order-wrapper{padding-left:0}.route .route-inner mv-suggested-route-tod .order-wrapper .price{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#262b31;margin-top:6px}\n"],encapsulation:2}),e})();var et=n(51063),tt=n(20785),nt=n(47111);function it(e,t){1&e&&(s.TgZ(0,"span",17),s._uU(1," \u2022 "),s._UZ(2,"svg-icon",18),s.ALo(3,"translate"),s.qZA()),2&e&&(s.xp6(2),s.s9C("titleText",s.lcZ(3,1,"a11y_accessibility_icon")))}function rt(e,t){if(1&e&&(s.TgZ(0,"div",14),s._UZ(1,"span",15),s.ALo(2,"translate"),s.YNc(3,it,4,3,"span",16),s.qZA()),2&e){const e=s.oxw();s.ekj("real-time",e.route.isRelevantForRealTime&&e.route.extra.startFrom.param2),s.xp6(1),s.Q6J("innerHTML",s.xi3(2,4,e.route.extra.startFromTranslateKey,e.route.extra.startFrom),s.oJD),s.xp6(2),s.Q6J("ngIf",e.route.isAccessible)}}function ot(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",19),s.NdJ("click",function(t){return s.CHM(e),s.oxw().onPayWithAppClick(t)}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&e){const e=s.oxw();s.Q6J("href",e.payWithAppLink,s.LSH),s.xp6(1),s.hij(" ",s.lcZ(2,2,"web_pay_download_button")," ")}}let at=(()=>{class e{constructor(e,t,n,i){this.store=e,this.deepLinkService=t,this.analyticsService=n,this.document=i}ngOnInit(){var e;const t=null===(e=this.store.getState().directions.suggestedRoutes.sections.find(e=>e.sectionId===this.route.sectionId))||void 0===e?void 0:e.sectionType,n=t!==A.bA.WALK_AND_RIDE&&t!==A.bA.WALK_ONLY,i=(0,et.L)("data-pay-with-app",this.document);if(n&&i){this.showPayWithApp=!0;const e=this.deepLinkService.getStoreOrDeepLink("LiveDirections","LiveDirections",this.deepLinkService.getDeepLinkType());this.payWithAppLink=this.deepLinkService.getBannerTestUrl(i,e)}}ngOnChanges(e){const{previousValue:t,currentValue:n}=e.route;if(t!==n&&n){const{sectionType:e}=this.store.getState().directions.suggestedRoutes.sections.find(e=>e.sectionId===n.sectionId);this.isTodSectionType=e===A.bA.TOD}}onPayWithAppClick(e){var t;e.stopPropagation(),this.analyticsService.sendEvent(d.a.WebUserAction,"pay with Moovit CTA",null===(t=this.route.optionNumber)||void 0===t?void 0:t.toString(),null,!1)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(re.Qz),s.Y36(d.y),s.Y36(o.K0))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-suggested-route"]],inputs:{route:"route"},features:[s.TTD],decls:23,vars:15,consts:[[3,"durationMinutes"],[1,"legs-container","flex-col"],[3,"route"],["class","legs-description",3,"real-time",4,"ngIf"],[1,"legs-time"],[1,"start-time"],[1,"dash"],[1,"end-time"],["target","_blank","class","pay-with-app",3,"href","click",4,"ngIf"],[1,"route-time-summary"],[1,"route-time-container"],[1,"duration"],[1,"minutes"],[1,"destination"],[1,"legs-description"],[3,"innerHTML"],["class","accessible-route",4,"ngIf"],[1,"accessible-route"],["src","images/wheelchair.svg","mvAccessibleSVG","",3,"titleText"],["target","_blank",1,"pay-with-app",3,"href","click"]],template:function(e,t){1&e&&(s.TgZ(0,"mv-suggested-route-container",0),s.TgZ(1,"div",1),s._UZ(2,"mv-route-legs",2),s.YNc(3,rt,4,7,"div",3),s.TgZ(4,"div",4),s.TgZ(5,"span",5),s._uU(6),s.ALo(7,"time"),s.qZA(),s.TgZ(8,"span",6),s._uU(9,"-"),s.qZA(),s.TgZ(10,"span",7),s._uU(11),s.ALo(12,"time"),s.qZA(),s.qZA(),s.YNc(13,ot,3,4,"a",8),s.TgZ(14,"div",9),s.TgZ(15,"div",10),s.TgZ(16,"span",11),s._uU(17),s.qZA(),s.TgZ(18,"i",12),s._uU(19),s.ALo(20,"translate"),s.qZA(),s.qZA(),s.TgZ(21,"div",13),s._uU(22),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&e&&(s.Q6J("durationMinutes",t.route.durationMinutes),s.xp6(2),s.Q6J("route",t.route),s.xp6(1),s.Q6J("ngIf",t.route.extra),s.xp6(3),s.Oqu(s.lcZ(7,9,t.route.startTime)),s.xp6(5),s.Oqu(s.lcZ(12,11,t.route.endTime)),s.xp6(2),s.Q6J("ngIf",t.showPayWithApp),s.xp6(4),s.Oqu(t.route.durationMinutes),s.xp6(2),s.Oqu(s.lcZ(20,13,"min")),s.xp6(3),s.Oqu(t.route.to.name))},directives:[Ve,tt.U,o.O5,Te.bk,Se.m],pipes:[nt._x,_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.route .bullet{font-size:.7058823529rem;padding:5px}.route .dash{padding:4px}.route .pay-with-app{text-decoration:none;margin-top:4px;padding:4px 8px;border-radius:4px;background-color:#f2f2f2;font-size:.8235294118rem;line-height:1.43;color:#292a30}html[dir=ltr] .route .pay-with-app{margin-left:auto}html[dir=rtl] .route .pay-with-app{margin-right:auto}.route .legs-description{font-size:.8235294118rem;color:#292a30;margin-top:6px}.route .legs-description i{position:relative;color:#038844;font-style:normal}html[dir=ltr] .route .legs-description i{padding-left:10px}html[dir=rtl] .route .legs-description i{padding-right:10px}.route .legs-description i:before{content:"";display:block;width:8px;height:8px;border:2px solid transparent;border-left-color:#038844;border-radius:50%;position:absolute;left:4px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] .route .legs-description i:before{top:2px}html[dir=rtl] .route .legs-description i:before{top:4px}@media (prefers-reduced-motion: reduce){.route .legs-description i:before{-webkit-animation:none;animation:none}}html[dir=rtl] .route .legs-description i:before{left:-7px;transform:scaleX(-1)}.route .legs-description i:after{content:"";display:block;width:14px;height:14px;border:2px solid transparent;border-left-color:#038844;border-radius:50%;position:absolute;left:0;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] .route .legs-description i:after{top:-1px}html[dir=rtl] .route .legs-description i:after{top:1px}@media (prefers-reduced-motion: reduce){.route .legs-description i:after{-webkit-animation:none;animation:none}}html[dir=rtl] .route .legs-description i:after{left:-9px;transform:scaleX(-1)}.route .legs-description .eta{color:#038844;font-weight:700}.route .legs-description .accessible-route svg-icon{height:11px;width:11px;margin-top:-3px}.route .legs-time{font-size:.8235294118rem;color:#292a30;line-height:1.2;margin-top:2px}.route .legs-time .realtime-icon{background:none;border-radius:50%;display:inline-block;height:4px;vertical-align:middle;transform:translateY(-50%);width:4px}html[dir=rtl] .route .legs-time .realtime-icon{transform:translateY(-50%) scaleX(-1)}.route .legs-time .realtime-icon:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:10px;position:absolute;right:-6px;top:-5px;width:10px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){.route .legs-time .realtime-icon:before{-webkit-animation:none;animation:none}}.route .legs-time .realtime-icon:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:16px;position:absolute;right:-8px;top:-8px;width:16px;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){.route .legs-time .realtime-icon:after{-webkit-animation:none;animation:none}}\n'],encapsulation:2}),e})();const st=["suggestedRoutesSectionHookContainer"];function lt(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-share",6),s.NdJ("click",function(t){return s.CHM(e),s.oxw().showShareDialog(t)}),s.qZA()}2&e&&s.Q6J("showCaption",!0)}function ct(e,t){if(1&e&&s._UZ(0,"mv-tod-banner",10),2&e){const e=s.oxw().$implicit,t=s.oxw();s.Q6J("todBanner",e)("inputEmitter",t.bannerEvents[e.itineraryGuid])}}function dt(e,t){if(1&e&&s._UZ(0,"mv-suggested-route-tod",11),2&e){const e=s.oxw().$implicit,t=s.oxw();s.Q6J("todBanner",e)("inputEmitter",t.bannerEvents[e.itineraryGuid])}}function ut(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-suggested-route-container",7),s.NdJ("keydown.tab",function(t){return s.CHM(e),s.oxw().onTabNavigation(t)})("keydown.shift.tab",function(t){return s.CHM(e),s.oxw().onTabNavigation(t,!0)})("click",function(){const t=s.CHM(e).$implicit;return s.oxw().bannerEvents[t.itineraryGuid].emit()}),s.YNc(1,ct,1,2,"mv-tod-banner",8),s.YNc(2,dt,1,2,"mv-suggested-route-tod",9),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw();s.Q6J("durationMinutes",e.durationMinutes)("@fadeIn",void 0),s.xp6(1),s.Q6J("ngIf",e.bannerType===n.TodBannerType.InactiveCell),s.xp6(1),s.Q6J("ngIf",e.bannerType!==n.TodBannerType.InactiveCell)}}function pt(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-suggested-route",12),s.NdJ("click",function(t){const n=s.CHM(e),i=n.$implicit,r=n.index;return s.oxw().onRouteClicked(i,t,r)})("keydown.tab",function(t){return s.CHM(e),s.oxw().onTabNavigation(t)})("keydown.shift.tab",function(t){return s.CHM(e),s.oxw().onTabNavigation(t,!0)})("keydown.enter",function(t){const n=s.CHM(e),i=n.$implicit,r=n.index;return s.oxw().onRouteClicked(i,t,r)})("mouseenter",function(t){const n=s.CHM(e).$implicit;return s.oxw().onRouteMouseEnter(n,t)})("mouseleave",function(t){const n=s.CHM(e).$implicit;return s.oxw().onRouteMouseLeave(n,t)}),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw();s.ekj("active",n.isRouteSelected(e)),s.Q6J("route",e)("@fadeIn",void 0)}}let ht=(()=>{class e{constructor(e,t,n,i,r,o,a){this.store=e,this.routingService=t,this.hookService=n,this.itineraryActions=i,this.analyticsService=r,this.canonicalService=o,this.userActions=a,this.bannerEvents={},this.TodBannerType=se.Zf}ngAfterViewInit(){this.hookService.runHooks($e.e.COMPONENT_SUGGESTED_ROUTES_SECTION,this.suggestedRoutesSectionHookContainer,this)}get state(){return this.store.getState()}get isTodSection(){return this.section.sectionType===A.bA.TOD}get banners(){return this.isTodSection?this.state.directions.suggestedRoutes.banners.filter(e=>{if(e.sectionId===this.section.sectionId)return this.bannerEvents[e.itineraryGuid]||(this.bannerEvents[e.itineraryGuid]=new s.vpe),!0}):null}get routes(){return this.section.routes.map(e=>this.state.directions.suggestedRoutes.routesById[e])}isRouteSelected(e){return!1}onRouteClicked(e,t,n){this.analyticsService.trackShowRouteSteps(e,n),this.store.dispatch(this.itineraryActions.setSelectedRoute(e,!0));const i=this.isTodSection?D.zA.TOD_RIDE_ORDER:D.zA.TRIPPLAN_ITINERARY;if(this.isTodSection&&this.state.user.accountStatus!==Ye.dp.Authenticated)return this.store.dispatch(this.userActions.setPostLoginPath(this.canonicalService.buildStatefulPath([],i))),void this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"]));this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],i))}onTabNavigation(e,t){e.target.scrollIntoView({block:t?"end":"center"})}onRouteMouseEnter(e,t){}onRouteMouseLeave(e,t){}showShareDialog(e){}get shouldHideSharing(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration.hideSharing}get from(){return this.state.directions.search.from}get to(){return this.state.directions.search.to}trackByRoute(e,t){return null==t?void 0:t.itineraryGuid}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(f.Z),s.Y36($e.$),s.Y36(Fe.L),s.Y36(d.y),s.Y36(R.z),s.Y36(Be.E))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-suggested-routes-section"]],viewQuery:function(e,t){if(1&e&&s.Gf(st,5,s.s_b),2&e){let e;s.iGM(e=s.CRH())&&(t.suggestedRoutesSectionHookContainer=e.first)}},inputs:{section:"section",isFirstShareableSection:"isFirstShareableSection"},decls:9,vars:8,consts:[["role","heading","aria-level","2",1,"title"],[3,"showCaption","click",4,"ngIf"],["role","list",1,"routes"],["class","route","aria-label","suggested route","role","listitem","tabindex","0",3,"durationMinutes","keydown.tab","keydown.shift.tab","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","route","aria-label","suggested route","role","listitem","tabindex","0",3,"active","route","click","keydown.tab","keydown.shift.tab","keydown.enter","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],["suggestedRoutesSectionHookContainer",""],[3,"showCaption","click"],["aria-label","suggested route","role","listitem","tabindex","0",1,"route",3,"durationMinutes","keydown.tab","keydown.shift.tab","click"],["class","inactive",3,"todBanner","inputEmitter",4,"ngIf"],[3,"todBanner","inputEmitter",4,"ngIf"],[1,"inactive",3,"todBanner","inputEmitter"],[3,"todBanner","inputEmitter"],["aria-label","suggested route","role","listitem","tabindex","0",1,"route",3,"route","click","keydown.tab","keydown.shift.tab","keydown.enter","mouseenter","mouseleave"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s._uU(1),s.ALo(2,"translate"),s.YNc(3,lt,1,1,"mv-share",1),s.qZA(),s.TgZ(4,"div",2),s.YNc(5,ut,3,4,"mv-suggested-route-container",3),s.YNc(6,pt,1,4,"mv-suggested-route",4),s.GkF(7,null,5),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,6,t.section.name)," "),s.xp6(2),s.Q6J("ngIf",t.isFirstShareableSection&&!t.shouldHideSharing),s.xp6(2),s.Q6J("ngForOf",t.banners)("ngForTrackBy",t.trackByRoute),s.xp6(1),s.Q6J("ngForOf",t.routes)("ngForTrackBy",t.trackByRoute))},directives:[o.O5,o.sg,Ue.N,Ve,Ge,Xe,at],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-suggested-routes-section>.title{background:#ECF0F1;font-size:.9411764706rem;color:#292a30;padding:0;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;min-height:40px}html[dir=ltr] mv-suggested-routes-section>.title{padding-left:20px}html[dir=rtl] mv-suggested-routes-section>.title{padding-right:20px}.app-container.trip-plan.with-time-options .content-container mv-suggested-routes-section mv-buy-ticket-link{top:calc(215px + 4.7058823529rem)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){.app-container.trip-plan.with-time-options .content-container mv-suggested-routes-section mv-buy-ticket-link{top:calc(195px + 2.4705882353rem)}}\n"],encapsulation:2,data:{animation:[(0,Re.X$)("fadeIn",[(0,Re.SB)("void",(0,Re.oB)({opacity:0})),(0,Re.eR)("void => *",(0,Re.jt)(300))])]}}),e})();var mt=n(90248);function gt(e,t){1&e&&s._UZ(0,"mv-buy-ticket-link")}function ft(e,t){if(1&e&&(s.ynx(0),s._UZ(1,"mv-suggested-routes-section",4),s.BQk()),2&e){const e=t.$implicit,n=t.index,i=s.oxw();s.xp6(1),s.Q6J("section",e)("isFirstShareableSection",i.isFirstShareableSection(n))}}function vt(e,t){1&e&&(s.TgZ(0,"div",5),s._UZ(1,"mv-spinner"),s.qZA())}let yt=(()=>{class e{constructor(e){this.store=e}get state(){return this.store.getState()}get isPolling(){return this.state.directions.suggestedRoutes.isPolling}isFirstShareableSection(e){return this.sectionsWithRoutes.findIndex(e=>e.sectionId!==b.Ox)===e}get sectionsWithRoutes(){const{banners:e,sections:t}=this.state.directions.suggestedRoutes;return t.filter(t=>t.routes.length||t.sectionType===A.bA.TOD&&e.some(e=>e.sectionId===t.sectionId))}trackBySection(e,t){return t.sectionId}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-suggested-routes"]],decls:4,vars:4,consts:[[1,"suggested-routes-content"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","spinner",4,"ngIf"],[3,"section","isFirstShareableSection"],[1,"spinner"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,gt,1,0,"mv-buy-ticket-link",1),s.YNc(2,ft,2,2,"ng-container",2),s.YNc(3,vt,2,0,"div",3),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngIf",null==t.state.customer.currentCustomer?null:t.state.customer.currentCustomer.ticketsUrl),s.xp6(1),s.Q6J("ngForOf",t.sectionsWithRoutes)("ngForTrackBy",t.trackBySection),s.xp6(1),s.Q6J("ngIf",t.isPolling))},directives:[o.O5,o.sg,Ne,ht,mt.O],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-suggested-routes{position:relative;overflow-y:auto}body.desktop mv-suggested-routes .suggested-routes-content{padding-bottom:40px}mv-suggested-routes mv-buy-ticket-link{border-top:solid 2px #f6f6f6;border-bottom:solid 1px #f6f6f6;height:40px;position:fixed;width:100%;background:#fff;z-index:2;top:calc(180px + 4.7058823529rem)}body.desktop mv-suggested-routes mv-buy-ticket-link{position:-webkit-sticky;position:sticky;top:0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-suggested-routes mv-buy-ticket-link{top:calc(156px + 2.4705882353rem)}}mv-suggested-routes .route{display:flex;align-items:center;height:auto;min-height:64px;width:100%}mv-suggested-routes .route:first-child .legs-container{border:none}.suggested-routes mv-suggested-routes .route{padding:0}mv-suggested-routes .route .legs-container,mv-suggested-routes .route mv-suggested-route-tod{padding:20px 0;border:none;border-top:1px solid #BDC3C7;overflow:auto;width:100%;letter-spacing:.01em}html[dir=ltr] mv-suggested-routes .route .legs-container,html[dir=ltr] mv-suggested-routes .route mv-suggested-route-tod{padding-right:20px}html[dir=rtl] mv-suggested-routes .route .legs-container,html[dir=rtl] mv-suggested-routes .route mv-suggested-route-tod{padding-left:20px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-suggested-routes .route .legs-container,mv-suggested-routes .route mv-suggested-route-tod{padding:11px 0}}mv-suggested-routes .route .legs-container span,mv-suggested-routes .route mv-suggested-route-tod span{font-size:.8235294118rem;line-height:1.4}\n"],encapsulation:2}),e})();var bt=n(46461);function _t(e,t){1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"partners_header")))}function Tt(e,t){1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"web_widget_powered_by")))}function St(e,t){if(1&e&&(s.TgZ(0,"a",3),s._UZ(1,"img",4),s.qZA()),2&e){const e=s.oxw();s.Q6J("href",e.canonicalServer,s.LSH),s.xp6(1),s.Q6J("src","images/partners/"+e.partnershipLogo,s.LSH)}}function xt(e,t){if(1&e&&s._UZ(0,"img",5),2&e){const e=s.oxw();s.Q6J("src","images/partners/"+e.partnershipLogo,s.LSH)}}let wt=(()=>{class e{constructor(e){this.store=e,this.canonicalServer="https://m.moovitapp.com"}get state(){return this.store.getState()}get isMoovitPartnershipLogo(){return this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.hidePartnership&&this.state.customer.currentCustomer.logo&&"moovit_logo_full.svg"===this.state.customer.currentCustomer.logo}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-partnership-line"]],inputs:{partnershipLogo:"partnershipLogo"},decls:4,vars:4,consts:[[4,"ngIf"],[3,"href",4,"ngIf"],["mvImg","","class","partner-logo",3,"src",4,"ngIf"],[3,"href"],["mvImg","",1,"partner-logo","moovit-logo",3,"src"],["mvImg","",1,"partner-logo",3,"src"]],template:function(e,t){1&e&&(s.YNc(0,_t,3,3,"span",0),s.YNc(1,Tt,3,3,"span",0),s.YNc(2,St,2,2,"a",1),s.YNc(3,xt,1,1,"img",2)),2&e&&(s.Q6J("ngIf",!t.isMoovitPartnershipLogo),s.xp6(1),s.Q6J("ngIf",t.isMoovitPartnershipLogo),s.xp6(1),s.Q6J("ngIf",t.isMoovitPartnershipLogo),s.xp6(1),s.Q6J("ngIf",!t.isMoovitPartnershipLogo))},directives:[o.O5,bt.X],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-partnership-line{background-color:#fff;width:100%;display:flex;align-items:center;box-sizing:border-box;bottom:0;font-size:.8235294118rem;color:#737578;padding:15px 20px}body.mobile mv-partnership-line{position:fixed}body.desktop mv-partnership-line{position:absolute;padding:6px 20px}.desktop .has-partner-footer mv-partnership-line{bottom:5.2941176471rem}.mobile .has-partner-footer mv-partnership-line{bottom:4.2941176471rem}html[dir=ltr] mv-partnership-line>span{margin-right:8px}html[dir=rtl] mv-partnership-line>span{margin-left:8px}body.desktop mv-partnership-line>span{font-size:.7058823529rem}mv-partnership-line .partner-logo{max-height:26px}mv-partnership-line .partner-logo.moovit-logo{width:5.9411764706rem;height:1.2352941176rem}body.desktop mv-partnership-line .partner-logo.moovit-logo{width:5.3529411765rem;height:1.4705882353rem}.mobile-cta-min mv-partnership-line{bottom:23px!important}\n"],encapsulation:2}),e})();var kt=n(89458),Mt=n(77226),Lt=n(24813);function At(e,t){1&e&&s._UZ(0,"mv-tod-last-ride-route-section")}function It(e,t){if(1&e&&s._UZ(0,"mv-error-message",8),2&e){const e=s.oxw();s.Q6J("errorMessage",e.errorMessage)}}function Et(e,t){if(1&e&&s._UZ(0,"mv-search-results",9),2&e){const e=s.oxw();s.Q6J("select",e.getSelectedLocationFunction())}}function Ct(e,t){if(1&e&&s._UZ(0,"mv-current-location",9),2&e){const e=s.oxw();s.Q6J("select",e.getSelectedLocationFunction())}}function Dt(e,t){1&e&&s._UZ(0,"mv-search-instructions")}function Pt(e,t){if(1&e&&s._UZ(0,"mv-recent-locations",10),2&e){const e=s.oxw();s.Q6J("locations",e.recentLocations)("select",e.getSelectedLocationFunction())}}function Ot(e,t){1&e&&s._UZ(0,"mv-suggested-routes")}function Nt(e,t){if(1&e&&s._UZ(0,"mv-partnership-line",11),2&e){const e=s.oxw();s.Q6J("partnershipLogo",e.partnershipLogo)("ngStyle",e.partnershipLineStyle)}}function Rt(e,t){if(1&e&&s._UZ(0,"mv-qr-code-banner",12),2&e){const e=s.oxw();s.Q6J("qrCodeParams",e.qrParams)}}function $t(e,t){1&e&&s._UZ(0,"mv-mot-banner")}function Yt(e,t){1&e&&s._UZ(0,"mv-community-banner")}let Ft=(()=>{class e{constructor(e,t,n,i,r,o){this.mobileService=e,this.permissionService=t,this.translate=n,this.store=i,this.platformService=r,this.customerService=o,this.qrParams={campaign:ie.oS.SuggestedRoutes_QRcode,appArea:ie.Kq.QR,deepLinkSchemaType:re.nu.Directions,promoKey:"web_scan_qr",displayDirection:"top"}}ngOnInit(){const e=this.permissionService.getStoredState(ne.h);this.permissionDenied="boolean"==typeof e&&!e}get state(){return this.store.getState()}get searchState(){return this.store.getState().directions.search}get hasSearchResults(){return!!this.searchState.currentSearchResults.length}get isLoading(){return this.state.global.isLoading}get errorMessage(){return this.state.global.errorMessage||this.state.directions.suggestedRoutes.error}get shouldShowLastTodRide(){return!this.isSearchResultsLoadingOrLoaded&&!this.isLoading&&!this.shouldShowSuggestedRoutes}get shouldShowSearchResults(){return this.isSearchResultsLoadingOrLoaded&&!this.isLoading&&!this.shouldShowSuggestedRoutes&&!this.errorMessage}get displayInstructions(){return!(this.isSearchResultsLoadingOrLoaded||this.state.directions.search.searchInputTypeFocused===i.t2.DirectionFrom||this.state.directions.search.searchInputTypeFocused===i.t2.DirectionTo||this.shouldShowRecentLocations||this.isLoading||this.shouldShowSuggestedRoutes||this.errorMessage)}get isSearchResultsNotLoaded(){return this.searchState.resultsLoadingState==i.Gu.NOT_LOADED}get isSearchResultsLoadingOrLoaded(){return this.searchState.resultsLoadingState!=i.Gu.NOT_LOADED}get shouldShowCurrentLocation(){return!this.errorMessage&&this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.hideMyCurrentLocation&&!this.isLoading&&(this.isSearchResultsNotLoaded||!this.hasSearchResults)&&!this.shouldShowSuggestedRoutes&&!this.isCurrentLocationSet&&!this.permissionDenied}get isCurrentLocationSet(){const e=this.translate.instant("current_location");return this.state.directions.search.from.name===e||this.state.directions.search.to.name===e}get shouldShowSuggestedRoutes(){return!!this.state.directions.suggestedRoutes.sections.length}get partnershipLogo(){return this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.hidePartnership&&(this.state.customer.currentCustomer.designConfiguration.hideDownloadMoovitBanner||!this.isMoovitPartnershipLogo)&&this.state.customer.currentCustomer.logo}get isMoovitPartnershipLogo(){return this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.hidePartnership&&this.state.customer.currentCustomer.logo&&this.state.customer.currentCustomer.logo===b.vo}get shouldShowPartnershipLine(){return this.partnershipLogo&&!this.mobileService.isKeyboardOpen}get partnershipLineStyle(){return{bottom:(0,te.qT)(this.shouldShowMobileAppCta?"mv-mobile-app-cta":"mv-download-app-partners-banner","height",!1)}}get shouldShowMobileAppCta(){return this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.hideFooterOnMobile}get recentLocations(){return(this.state.metro.currentMetro&&this.searchState.recentLocations[this.state.metro.currentMetro.metroAreaId]||[]).filter(this.isLocationUnused.bind(this))}isLocationUnused(e){return!this.isSameLocation(this.searchState.from,e)&&!this.isSameLocation(this.searchState.to,e)}isSameLocation(e,t){return e.id>0&&t.id>0?e.id==t.id:e.latlng&&t.latlng&&e.latlng.lat==t.latlng.lat&&e.latlng.lng==t.latlng.lng&&e.name==t.name}get shouldShowRecentLocations(){return!this.errorMessage&&!!this.recentLocations.length&&!this.isLoading&&(this.isSearchResultsNotLoaded||!this.hasSearchResults)&&!this.shouldShowSuggestedRoutes}onSelectedLocation(){this.searchControl.locationSelected(this.searchState.currentActiveSearchField)}getSelectedLocationFunction(){return this.onSelectedLocation.bind(this)}get isShowQrBanner(){var e,t,n;const i=this.platformService.isDesktop,r=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.id,o=!!r&&!this.customerService.isMoovitCustomer(r),a=null===(n=null===(t=this.state.customer.currentCustomer)||void 0===t?void 0:t.designConfiguration)||void 0===n?void 0:n.isShowCustomDesktopTripPlanBanner;return i&&this.shouldShowSuggestedRoutes&&(!o||a)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(oe.W),s.Y36(ne.$),s.Y36(_.sK),s.Y36(l.d),s.Y36(y.mi),s.Y36(u.v))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-directions-main-view"]],viewQuery:function(e,t){if(1&e&&s.Gf(ee,5),2&e){let e;s.iGM(e=s.CRH())&&(t.searchControl=e.first)}},decls:14,vars:12,consts:[[1,"directions-content"],[4,"ngIf"],[3,"errorMessage",4,"ngIf"],[3,"select",4,"ngIf"],[3,"message"],[3,"locations","select",4,"ngIf"],[3,"partnershipLogo","ngStyle",4,"ngIf"],[3,"qrCodeParams",4,"ngIf"],[3,"errorMessage"],[3,"select"],[3,"locations","select"],[3,"partnershipLogo","ngStyle"],[3,"qrCodeParams"]],template:function(e,t){1&e&&(s._UZ(0,"mv-search-control"),s.TgZ(1,"div",0),s.YNc(2,At,1,0,"mv-tod-last-ride-route-section",1),s.YNc(3,It,1,1,"mv-error-message",2),s.YNc(4,Et,1,1,"mv-search-results",3),s._UZ(5,"mv-updates-message",4),s.YNc(6,Ct,1,1,"mv-current-location",3),s.YNc(7,Dt,1,0,"mv-search-instructions",1),s.YNc(8,Pt,1,2,"mv-recent-locations",5),s.YNc(9,Ot,1,0,"mv-suggested-routes",1),s.YNc(10,Nt,1,2,"mv-partnership-line",6),s.qZA(),s.YNc(11,Rt,1,1,"mv-qr-code-banner",7),s.YNc(12,$t,1,0,"mv-mot-banner",1),s.YNc(13,Yt,1,0,"mv-community-banner",1)),2&e&&(s.xp6(2),s.Q6J("ngIf",t.shouldShowLastTodRide),s.xp6(1),s.Q6J("ngIf",t.errorMessage),s.xp6(1),s.Q6J("ngIf",t.shouldShowSearchResults),s.xp6(1),s.Q6J("message",t.state.alert.updatesMessage),s.xp6(1),s.Q6J("ngIf",t.shouldShowCurrentLocation),s.xp6(1),s.Q6J("ngIf",t.displayInstructions),s.xp6(1),s.Q6J("ngIf",t.shouldShowRecentLocations),s.xp6(1),s.Q6J("ngIf",t.shouldShowSuggestedRoutes),s.xp6(1),s.Q6J("ngIf",t.shouldShowPartnershipLine),s.xp6(1),s.Q6J("ngIf",t.isShowQrBanner),s.xp6(1),s.Q6J("ngIf",t.platformService.isDesktop&&!t.shouldShowSuggestedRoutes),s.xp6(1),s.Q6J("ngIf",t.platformService.isDesktop))},directives:[ee,o.O5,ae.Q,ye,be.H,Ie,Ce,De,Oe,yt,wt,o.PC,kt.Y,Mt.M,Lt.l],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-directions-main-view{height:100%;display:flex;flex-direction:column}body.desktop mv-directions-main-view .directions-content{overflow-y:auto;height:100%}mv-directions-main-view .location-inner,mv-directions-main-view .recent-location{width:100%}mv-directions-main-view .location-inner .recent-locations-title,mv-directions-main-view .recent-location .recent-locations-title{font-size:.9411764706rem;color:#737578;padding:14px 0 10px;background:#ECF0F1}html[dir=ltr] mv-directions-main-view .location-inner .recent-locations-title,html[dir=ltr] mv-directions-main-view .recent-location .recent-locations-title{padding-left:20px}html[dir=rtl] mv-directions-main-view .location-inner .recent-locations-title,html[dir=rtl] mv-directions-main-view .recent-location .recent-locations-title{padding-right:20px}mv-directions-main-view .location-inner mv-location-result,mv-directions-main-view .recent-location mv-location-result{display:flex;align-items:center;position:relative;box-sizing:border-box;min-height:64px;width:100%}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-directions-main-view .location-inner mv-location-result,mv-directions-main-view .recent-location mv-location-result{min-height:54px}}mv-directions-main-view .location-inner mv-location-result:focus,mv-directions-main-view .recent-location mv-location-result:focus{outline:#302E2E auto 1px}mv-directions-main-view .location-inner mv-location-result .location-icon,mv-directions-main-view .recent-location mv-location-result .location-icon{width:80px;display:flex;justify-content:center}mv-directions-main-view .location-inner mv-location-result .location-icon .boxed,mv-directions-main-view .recent-location mv-location-result .location-icon .boxed{text-align:center}mv-directions-main-view .location-inner mv-location-result .location-icon .boxed span.line img,mv-directions-main-view .recent-location mv-location-result .location-icon .boxed span.line img{width:24px;height:auto}mv-directions-main-view .location-inner mv-location-result .location-info,mv-directions-main-view .recent-location mv-location-result .location-info{width:100%;padding:16px 0;vertical-align:middle;border-bottom:1px solid #DDDDDD}html[dir=ltr] mv-directions-main-view .location-inner mv-location-result .location-info,html[dir=ltr] mv-directions-main-view .recent-location mv-location-result .location-info{padding-right:20px}html[dir=rtl] mv-directions-main-view .location-inner mv-location-result .location-info,html[dir=rtl] mv-directions-main-view .recent-location mv-location-result .location-info{padding-left:20px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-directions-main-view .location-inner mv-location-result .location-info,mv-directions-main-view .recent-location mv-location-result .location-info{padding:11px 0}}mv-directions-main-view .location-inner mv-location-result .location-info .name,mv-directions-main-view .recent-location mv-location-result .location-info .name{font-size:.9411764706rem}mv-directions-main-view .location-inner mv-location-result .location-info .name+div,mv-directions-main-view .recent-location mv-location-result .location-info .name+div{display:flex;flex-wrap:wrap}mv-directions-main-view .location-inner mv-location-result .location-info .address,mv-directions-main-view .recent-location mv-location-result .location-info .address{display:flex;flex-wrap:wrap;align-items:center}mv-directions-main-view .location-inner mv-location-result .location-info .address>span,mv-directions-main-view .recent-location mv-location-result .location-info .address>span{text-wrap:none}html[dir=ltr] mv-directions-main-view .location-inner mv-location-result .location-info .address>span,html[dir=ltr] mv-directions-main-view .recent-location mv-location-result .location-info .address>span{margin-right:4px}html[dir=rtl] mv-directions-main-view .location-inner mv-location-result .location-info .address>span,html[dir=rtl] mv-directions-main-view .recent-location mv-location-result .location-info .address>span{margin-left:4px}mv-directions-main-view .location-inner mv-location-result .location-info .address>span:last-of-type,mv-directions-main-view .recent-location mv-location-result .location-info .address>span:last-of-type{margin:0}mv-directions-main-view .location-inner mv-location-result .location-info .address .mvf-wrapper,mv-directions-main-view .recent-location mv-location-result .location-info .address .mvf-wrapper{width:20px}mv-directions-main-view .location-inner mv-location-result .location-info .address .mvf-wrapper .agency img,mv-directions-main-view .recent-location mv-location-result .location-info .address .mvf-wrapper .agency img{width:20px}\n"],encapsulation:2}),e})();var Bt=n(26743),Ut=n(40216),Zt=n(8967),jt=n(57166),Vt=n(44143),Ht=n(55754),Gt=n(23137),zt=n(58876);const qt=["popupContainer"],Jt="tod-active-ride-map";let Wt=(()=>{class e extends Zt.d{constructor(e,t,n,i,r,o,a,s){super(t,o,a,Jt,"TodActiveRideMapComponent"),this.document=e,this.store=t,this.resolver=n,this.storeHelper=i,this.permissionService=r,this.customerService=o,this.uiActions=a,this.suggestedRoutesService=s,this.realTimeRouteLeg={polyline:null,busIcon:null},this.markers=[],this.popups=[],this.unsubscribes=[],this.originIconUrl="images/tod/origin-card-icon.svg",this.pickupIconUrl="images/tod/pickup-point-icon-card-icon-copy.svg",this.dropoffIconUrl="images/tod/drop-off-poin-card-icon.svg",this.busIconUrl="images/tod/map-icon-vehicle.svg",this.destinationIconUrl="images/tod/Destination.svg",this.isLeafletMapInitiated=!1,this.allPointsOnMap=[]}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){yield(0,a.p5)(this.store),yield this.initLeafletMap(),this.isLeafletMapInitiated=!0,yield this.initMapLocation(),this.document.getElementById(Jt).setAttribute("tabindex","-1"),this.drawRoute(),this.refreshSize()})}ngOnChanges(e){if(!this.isLeafletMapInitiated||!e.realTimeInfo)return;const{previousValue:t,currentValue:n}=e.realTimeInfo;n!==t&&n&&this.drawRoute(t)}ngOnDestroy(){var e;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}get isPickedup(){return this.realTimeInfo.journeyStatus>=se.fL.HEADING_DROP_OFF}get isDroppedOff(){return this.realTimeInfo.journeyStatus===se.fL.ARRIVED_DROP_OFF}get isPassangerOnDriver(){return this.isPickedup&&!this.isDroppedOff}initMapLocation(){return(0,r.mG)(this,void 0,void 0,function*(){if(!this.mapLocation&&(yield this.permissionService.requestLocation())){const e=yield this.permissionService.requestOrientation();this.mapLocation=new Ut.Y(this.map,e)}})}refreshSize(){this.map.invalidateSize()}fitBounds(){var e,t;const{origin:n,destination:i,pickup:r,dropoff:o}=this.rideInfo.journeyInfo;let a;a=this.allPointsOnMap.length?this.allPointsOnMap:[n,r,o,i].filter(e=>null==e?void 0:e.latlon).map(e=>Ht._.fromMvLatLon(e.latlon)),this.realTimeInfo.rideStatus===se.Rl.ACTIVE&&!this.isDroppedOff&&(null===(e=this.realTimeInfo.location)||void 0===e?void 0:e.latlon)&&a.push(Ht._.fromMvLatLon(this.realTimeInfo.location.latlon)),null===(t=this.map)||void 0===t||t.invalidateSize(),this.fitBoundsByPoints(a)}drawRoute(e=null){return(0,r.mG)(this,void 0,void 0,function*(){if(!this.realTimeInfo||!this.rideInfo)return;const{rideStatus:t,journeyStatus:n}=this.realTimeInfo;t!==se.Rl.CANCELLED&&t!==se.Rl.NO_SHOW&&this.rideInfo.status!==se.Rl.FUTURE&&t!==se.Rl.DECLINED?((null==e?void 0:e.journeyStatus)!==n&&(this.cleanRouteLayers(),this.drawRouteLegs()),this.isDroppedOff||this.updateBusIconLocation(),this.isPassangerOnDriver&&this.drawRide()):(!e||e.rideStatus!==t)&&(this.cleanRouteLayers(),this.drawOriginToDestinationRide())})}updateBusIconLocation(){const{location:e}=this.realTimeInfo;!e||(this.realTimeRouteLeg.busIcon?this.realTimeRouteLeg.busIcon.setLatLng(Ht._.fromMvLatLon(e.latlon)):this.realTimeRouteLeg.busIcon=this.createMarker(e.latlon,this.busIconUrl,null,"",!1))}drawRide(){return(0,r.mG)(this,void 0,void 0,function*(){!this.realTimeInfo.location||(this.realTimeRouteLeg.polyline&&this.map.removeLayer(this.realTimeRouteLeg.polyline),this.realTimeRouteLeg.polyline=this.createCurvePath(this.realTimeInfo.location.latlon,this.rideInfo.journeyInfo.dropoff.latlon))})}createCurvePath(e,t){const n=[e.latitude/1e6,e.longitude/1e6],i=[t.latitude/1e6,t.longitude/1e6],r=i[1]-n[1],o=i[0]-n[0],a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),s=Math.atan2(o,r),l=Math.PI/10,c=a/2/Math.cos(l),d=s+l,u=c*Math.cos(d)+n[1],p=[c*Math.sin(d)+n[0],u];return L.curve(["M",n,"Q",p,i],{color:"#292A30",weight:3}).addTo(this.map)}createMarker(e,t,n,i,r){const o=this.isRetina?30:33,a=this.isRetina?21:24,s=L.icon({iconUrl:t,iconSize:[a,o]}),{lat:l,lng:c}=Ht._.fromMvLatLon(e),d=L.marker([l,c],{icon:s,zIndexOffset:1e3}).addTo(this.map);if(this.markers.push(d),!i)return d;if(r){const e=L.divIcon({className:"stop-icon",html:`<div class="tod-map-address">${i}</div>`,iconAnchor:[a/2,o]}),t=L.marker([l,c],{icon:e,title:i}).addTo(this.map);this.markers.push(t)}else{const e=(this.popups[n]=this.createPopupComponent()).instance;e.model={title:i,description:[],imageHtml:"",fromTo:n,location:{lat:l,lng:c}},d.bindPopup(e.getElement(),{closeButton:!1,offset:L.point(0,-25)})}return d}createPopupComponent(){const e=this.resolver.resolveComponentFactory(jt.A);return this.popupContainer.createComponent(e)}drawLegPolyline(e,t,n,o){return(0,r.mG)(this,void 0,void 0,function*(){this.createMarker(e.latlon,n,i.$h.From,e.caption,!1),this.createMarker(t.latlon,o,i.$h.To,t.caption,!1);const{polyline:r}=yield this.suggestedRoutesService.getWalkPolyline(e.latlon,t.latlon);if(!r)return[e,t].map(e=>e?Ht._.fromMvLatLon(e.latlon):null).filter(e=>e);const a=Vt.Ry(r),s=L.polyline(a,{color:"#525357",weight:4,opacity:1,lineCap:"round",dashArray:"8,7"}).addTo(this.map);return this.routeLegs.push(s),a})}drawOriginToDestinationRide(){var e;const{origin:t,destination:n}=this.rideInfo.journeyInfo;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.mapLocation=null,this.createMarker(t.latlon,this.originIconUrl,i.$h.From,t.caption,!0),this.createMarker(n.latlon,this.destinationIconUrl,i.$h.To,n.caption,!0),this.routeLegs.push(this.createCurvePath(t.latlon,n.latlon)),this.allPointsOnMap=[Ht._.fromMvLatLon(t.latlon),Ht._.fromMvLatLon(n.latlon)],this.fitBounds()}drawRouteLegs(){return(0,r.mG)(this,void 0,void 0,function*(){const{origin:e,pickup:t,dropoff:n,destination:r}=this.rideInfo.journeyInfo;this.mapLocation||this.isPassangerOnDriver?this.mapLocation&&this.isPassangerOnDriver&&(this.mapLocation.onDestroy(),this.mapLocation=null):this.initMapLocation(),this.isPickedup?(this.allPointsOnMap=yield this.drawLegPolyline(n,r,this.dropoffIconUrl,this.destinationIconUrl),this.isDroppedOff||(this.createMarker(t.latlon,this.pickupIconUrl,i.$h.From,t.caption,!1),this.allPointsOnMap.push(Ht._.fromMvLatLon(t.latlon)))):this.allPointsOnMap=yield this.drawLegPolyline(e,t,this.originIconUrl,this.pickupIconUrl),this.fitBounds()})}cleanRouteLayers(){this.logger.log("removeRouteLegs"),this.removeLayers(this.markers),this.removeLayers(this.routeLegs),this.realTimeRouteLeg.busIcon&&(this.map.removeLayer(this.realTimeRouteLeg.busIcon),this.realTimeRouteLeg.busIcon=null),this.realTimeRouteLeg.polyline&&(this.map.removeLayer(this.realTimeRouteLeg.polyline),this.realTimeRouteLeg.polyline=null),this.markers=[],this.routeLegs=[]}get isRetina(){return!1}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(s._Vd),s.Y36(c.N),s.Y36(ne.$),s.Y36(u.v),s.Y36(Gt.V),s.Y36(zt.w))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-active-ride-map"]],viewQuery:function(e,t){if(1&e&&s.Gf(qt,7,s.s_b),2&e){let e;s.iGM(e=s.CRH())&&(t.popupContainer=e.first)}},inputs:{realTimeInfo:"realTimeInfo",rideInfo:"rideInfo"},features:[s.qOj,s.TTD],decls:3,vars:0,consts:[["id","tod-active-ride-map",1,"itinerary-map"],[1,"popup-container"],["popupContainer",""]],template:function(e,t){1&e&&(s._UZ(0,"div",0),s._UZ(1,"div",1,2))},styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-active-ride-map{position:relative;flex-grow:1;display:flex;flex-direction:column;z-index:0}mv-tod-active-ride-map .itinerary-map{direction:ltr;flex-grow:1}mv-tod-active-ride-map .itinerary-map .stop-div-icon div{background-color:#edeff3;border:2px solid #292A30;border-radius:5px;box-sizing:border-box;height:10px;width:10px}mv-tod-active-ride-map .itinerary-map .stop-icon .mvf-wrapper{height:36px}mv-tod-active-ride-map mv-map-popup{display:none}mv-tod-active-ride-map .leaflet-popup-content-wrapper mv-map-popup{display:block}mv-tod-active-ride-map .leaflet-control-attribution.leaflet-control{direction:ltr}mv-tod-active-ride-map .leaflet-popup-content{margin:0}mv-tod-active-ride-map .leaflet-popup-content-wrapper{border-radius:4px;overflow:hidden;padding:0}mv-tod-active-ride-map .leaflet-popup-content{width:auto!important}mv-tod-active-ride-map .stop-icon .tod-map-address{position:absolute;top:0;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a30;text-align:center;background-color:#fff;box-shadow:0 1px 4px #00000040;padding:8px 9px 10px 8px;border-radius:24px;max-width:150px;width:-webkit-max-content;width:-moz-max-content;width:max-content}html[dir=ltr] mv-tod-active-ride-map .stop-icon .tod-map-address{left:30px}html[dir=rtl] mv-tod-active-ride-map .stop-icon .tod-map-address{right:30px}\n"],encapsulation:2}),e})();function Qt(e,t){if(1&e&&(s.TgZ(0,"div",10),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.AsE("",e.rideInfo.vehicle.licencePlate," \u2022 ",e.rideInfo.vehicle.driverName,"")}}function Kt(e,t){if(1&e&&(s.TgZ(0,"div",5),s._UZ(1,"svg-icon",6),s.TgZ(2,"div",7),s.TgZ(3,"div",8),s._uU(4),s.qZA(),s.YNc(5,Qt,2,2,"div",9),s.qZA(),s.qZA()),2&e){const e=s.oxw();s.xp6(4),s.Oqu(e.agencyName),s.xp6(1),s.Q6J("ngIf",e.rideInfo&&e.rideInfo.vehicle)}}function Xt(e,t){if(1&e&&(s.TgZ(0,"div",10),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.AsE("",e.rideInfo.vehicle.licencePlate," \u2022 ",e.rideInfo.vehicle.driverName,"")}}function en(e,t){if(1&e&&(s.TgZ(0,"div",11),s.TgZ(1,"div",8),s._uU(2),s.qZA(),s.YNc(3,Xt,2,2,"div",9),s.qZA()),2&e){const e=s.oxw();s.xp6(2),s.Oqu(e.agencyName),s.xp6(1),s.Q6J("ngIf",e.rideInfo&&e.rideInfo.vehicle)}}function tn(e,t){if(1&e&&(s.TgZ(0,"div",14),s._UZ(1,"svg-icon",15),s.TgZ(2,"div",16),s.TgZ(3,"div",17),s._uU(4),s.qZA(),s.qZA(),s.qZA()),2&e){const e=t.$implicit;s.ekj("progress",e.isInProgress)("active",e.isActive)("disabled",e.isDisabled),s.Q6J("ngClass",e.class),s.xp6(1),s.s9C("titleText",e.iconUrl),s.Q6J("src",e.iconUrl),s.xp6(3),s.Oqu(e.text)}}function nn(e,t){if(1&e&&(s.TgZ(0,"div",12),s.YNc(1,tn,5,10,"div",13),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngForOf",e.steps)}}function rn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",21),s.TgZ(1,"span",22),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"button",23),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).rateRide()}),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.Oqu(s.lcZ(3,2,"tod_passenger_rate_title")),s.xp6(3),s.Oqu(s.lcZ(6,4,"tod_passenger_rate_button")))}function on(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",24),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).goBack.emit()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"action_close")," "))}function an(e,t){if(1&e&&(s.ynx(0,18),s.YNc(1,rn,7,6,"div",19),s.YNc(2,on,3,3,"button",20),s.BQk()),2&e){const e=s.oxw();s.Q6J("ngSwitch",e.canRate),s.xp6(1),s.Q6J("ngSwitchCase",!0),s.xp6(1),s.Q6J("ngSwitchCase",!1)}}function sn(e,t){1&e&&(s.TgZ(0,"div",31),s._UZ(1,"svg-icon",32),s.ALo(2,"translate"),s.TgZ(3,"div",22),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e&&(s.xp6(1),s.s9C("titleText",s.lcZ(2,2,"payment_distance")),s.xp6(3),s.Oqu(s.lcZ(5,4,"tod_future_ride_future_details")))}const ln=function(e){return{param1:e}};function cn(e,t){if(1&e&&(s.TgZ(0,"div",33),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",s.xi3(2,1,"tod_order_pickup_address",s.VKq(4,ln,e.rideInfo.journeyInfo.origin.caption))," ")}}function dn(e,t){if(1&e&&(s.TgZ(0,"div",34),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",s.xi3(2,1,"tod_order_dropoff_address",s.VKq(4,ln,e.rideInfo.journeyInfo.destination.caption))," ")}}function un(e,t){if(1&e&&(s.TgZ(0,"div",25),s.YNc(1,sn,6,6,"div",26),s.TgZ(2,"div",27),s._UZ(3,"svg-icon",28),s.ALo(4,"translate"),s.TgZ(5,"div"),s.YNc(6,cn,3,6,"div",29),s.YNc(7,dn,3,6,"div",30),s.qZA(),s.qZA(),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngIf",e.isFutureRide),s.xp6(2),s.s9C("titleText",s.lcZ(4,4,"dashboard_recent_trip_title")),s.xp6(3),s.Q6J("ngIf",e.rideInfo.journeyInfo.origin.caption),s.xp6(1),s.Q6J("ngIf",e.rideInfo.journeyInfo.destination.caption)}}let pn=(()=>{class e{constructor(e,t,n,i){this.store=e,this.imageService=t,this.todService=n,this.analyticsService=i,this.goBack=new s.vpe}ngOnInit(){var e,t;const{taxiProviderId:n,canRate:i}=this.rideInfo,r=null===(t=null===(e=this.store.getState().metro.currentMetro.taxiMetroConfigurations)||void 0===e?void 0:e.find(e=>e.taxiId===n))||void 0===t?void 0:t.metadata;if(null==r?void 0:r.longImage){const{longImage:e,name:t}=r;this.agencyName=t,this.taxiLogoImage=this.imageService.getImageHTML(e.imageId,e.parameters)}this.canRate=i}ngOnChanges(e){const{previousValue:t,currentValue:n}=e.realTimeInfo;(!t||t.journeyStatus!==n.journeyStatus||t.rideStatus!==n.rideStatus||this.isDriverWaitingAtPickup(t)!==this.isDriverWaitingAtPickup(n))&&(this.steps=this.setupSteps()),t&&t.journeyStatus!==se.fL.ARRIVED_DROP_OFF&&n.journeyStatus===se.fL.ARRIVED_DROP_OFF&&(this.canRate=!0)}get isActiveRide(){var e;return(null===(e=this.realTimeInfo)||void 0===e?void 0:e.rideStatus)===se.Rl.ACTIVE}get isFutureRide(){var e;return(null===(e=this.realTimeInfo)||void 0===e?void 0:e.rideStatus)===se.Rl.FUTURE}isDriverWaitingAtPickup(e){return(null==e?void 0:e.journeyStatus)===se.fL.APPROACHING_PICKUP||(null==e?void 0:e.journeyStatus)===se.fL.ARRIVED_PICKUP}get showOnlyFromToSteps(){const{rideStatus:e}=this.realTimeInfo;return this.isFutureRide&&!this.isFrgRide||e===se.Rl.CANCELLED||e===se.Rl.NO_SHOW}close(){this.goBack.emit()}rateRide(){return(0,r.mG)(this,void 0,void 0,function*(){this.canRate=!(yield this.todService.rateRide(this.realTimeInfo.rideId,this.rideInfo.taxiProviderId,this.rideInfo.status,this.realTimeInfo)),this.analyticsService.sendEvent(d.a.TODActiveRideScreen,"TOD_RATE_YOUR_RIDE_CLICKED","click_origin=ride screen")})}get isFrgRide(){var e,t,n,i;return this.isFutureRide&&!!(null===(t=null===(e=this.rideInfo)||void 0===e?void 0:e.journeyInfo)||void 0===t?void 0:t.pickup)&&!!(null===(i=null===(n=this.rideInfo)||void 0===n?void 0:n.journeyInfo)||void 0===i?void 0:i.dropoff)}setupSteps(){if(!this.rideInfo||!this.isActiveRide&&!this.isFrgRide)return null;const e=this.isDriverWaitingAtPickup(this.realTimeInfo),{journeyStatus:t}=this.realTimeInfo,{origin:n,pickup:i,dropoff:r,destination:o}=this.rideInfo.journeyInfo,a=t>=se.fL.HEADING_DROP_OFF;return[n?{text:n.caption,iconUrl:"images/tod/origin-card-icon.svg",isInProgress:!1,isDisabled:a||e,isActive:!a&&!e,class:"origin"}:null,i?{text:i.caption,iconUrl:"images/tod/pickup-point-icon-card-icon-copy.svg",isInProgress:a,isDisabled:!1,isActive:e,class:"pickup"}:null,r?{text:r.caption,iconUrl:"images/tod/drop-off-poin-card-icon.svg",isInProgress:!1,isDisabled:!1,isActive:!1,class:"dropoff"}:null,o?{text:o.caption,iconUrl:"images/tod/Destination.svg",isInProgress:!1,isDisabled:!1,isActive:!1,class:"destination"}:null].filter(e=>e)}}return e.elementHeightInUndraggableMode=82,e.minHeightToAddOpenClass=105,e.minHeightToShowTextClass=195,e.maxListHeight=386,e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(ue.KD),s.Y36(ce.F),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-active-ride-list"]],inputs:{realTimeInfo:"realTimeInfo",rideInfo:"rideInfo"},outputs:{goBack:"goBack"},features:[s.TTD],decls:5,vars:5,consts:[["class","agency-info",4,"ngIf"],["class","agency-name-below",4,"ngIf"],["class","ride-state-list",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],["class","future-ride",4,"ngIf"],[1,"agency-info"],["src","images/tod/minibus-80.svg",1,"ride-minibus"],[1,"agency-text"],[1,"agency-name"],["class","driver-info",4,"ngIf"],[1,"driver-info"],[1,"agency-name-below"],[1,"ride-state-list"],["class","step-content",3,"ngClass","progress","active","disabled",4,"ngFor","ngForOf"],[1,"step-content",3,"ngClass"],["mvAccessibleSVG","",3,"src","titleText"],[1,"location-info"],[1,"address"],[3,"ngSwitch"],["class","tell-us",4,"ngSwitchCase"],["class","close",3,"click",4,"ngSwitchCase"],[1,"tell-us"],[1,"text"],[1,"rate-button",3,"click"],[1,"close",3,"click"],[1,"future-ride"],["class","text-wrapper",4,"ngIf"],[1,"text-wrapper","future-address"],["src","images/tod/recent-trips.svg","mvAccessibleSVG","",1,"recent-trips-icon",3,"titleText"],["class","from-address text",4,"ngIf"],["class","to-address text",4,"ngIf"],[1,"text-wrapper"],["src","images/tod/distance.svg","mvAccessibleSVG","",1,"distance-icon",3,"titleText"],[1,"from-address","text"],[1,"to-address","text"]],template:function(e,t){1&e&&(s.YNc(0,Kt,6,2,"div",0),s.YNc(1,en,4,2,"div",1),s.YNc(2,nn,2,1,"div",2),s.YNc(3,an,3,3,"ng-container",3),s.YNc(4,un,8,6,"div",4)),2&e&&(s.Q6J("ngIf",t.isActiveRide||t.isFrgRide),s.xp6(1),s.Q6J("ngIf",!t.showOnlyFromToSteps),s.xp6(1),s.Q6J("ngIf",t.steps&&t.steps.length),s.xp6(1),s.Q6J("ngIf",!t.isActiveRide&&!t.isFutureRide),s.xp6(1),s.Q6J("ngIf",t.showOnlyFromToSteps))},directives:[o.O5,Te.bk,o.sg,o.mk,Se.m,o.RF,o.n9],pipes:[_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-active-ride-split-screen.opened .active-title,mv-tod-active-ride-split-screen.opened .active-subtitle{flex-grow:1}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list{display:block}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info{height:70px;padding-bottom:15px}html[dir=ltr] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info{margin-right:0}html[dir=rtl] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info{margin-left:0}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .agency-text{flex-grow:0;height:40px;width:0;opacity:0;overflow:hidden;transition:all .4s ease-in-out}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .ride-minibus{transform:scale(1.75)}html[dir=ltr] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .ride-minibus{margin-right:0}html[dir=rtl] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .ride-minibus{margin-left:0}html[dir=ltr] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .agency-icon{margin-left:20px}html[dir=rtl] mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .agency-icon{margin-right:20px}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info .agency-icon .mvf-wrapper{transition:all .8s ease-in-out;transform:scale(1.75);image-rendering:-moz-crisp-edges;image-rendering:pixelated}mv-tod-active-ride-split-screen.opened mv-tod-active-ride-list .agency-info+.agency-name-below{display:block;text-align:center;padding-bottom:15px;border-bottom:1px solid #ECF0F1}mv-tod-active-ride-split-screen.show-text .ride-state-list{opacity:1}mv-tod-active-ride-list{display:block}mv-tod-active-ride-list .agency-info{display:flex;align-items:center;justify-content:center;padding:16px 20px 21px;overflow:hidden;transition:all .8s ease-in-out .4s,padding-bottom 1s ease-in-out}mv-tod-active-ride-list .agency-info .ride-minibus{transition:all .4s ease-in-out;margin:0}html[dir=ltr] mv-tod-active-ride-list .agency-info .ride-minibus{margin-right:8px}html[dir=rtl] mv-tod-active-ride-list .agency-info .ride-minibus{margin-left:8px}mv-tod-active-ride-list .agency-info .ride-minibus,mv-tod-active-ride-list .agency-info .ride-minibus svg{width:100px;height:45px}html[dir=rtl] mv-tod-active-ride-list .agency-info .ride-minibus svg{transform:scaleX(-1)}html[dir=ltr] mv-tod-active-ride-list .agency-info .agency-icon{margin-right:20px}html[dir=rtl] mv-tod-active-ride-list .agency-info .agency-icon{margin-left:20px}mv-tod-active-ride-list .agency-info .agency-icon .mvf-wrapper{transition:all .8s cubic-bezier(.35,-.2,.2,1.32)}mv-tod-active-ride-list .agency-info .agency-text{flex-grow:1;transition:all .8s ease}mv-tod-active-ride-list .agency-info .driver-info{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;font-weight:400;margin-top:2px}mv-tod-active-ride-list .agency-name{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:500}mv-tod-active-ride-list .agency-name-below{display:none}mv-tod-active-ride-list .step-content{position:relative;outline:none;cursor:pointer;display:flex;align-items:center;margin:0 24px 22px;transition:all,.8s}mv-tod-active-ride-list .step-content svg-icon{padding:5px 0;background:white;margin:0;z-index:1}html[dir=ltr] mv-tod-active-ride-list .step-content svg-icon{margin-right:13px}html[dir=rtl] mv-tod-active-ride-list .step-content svg-icon{margin-left:13px}mv-tod-active-ride-list .step-content svg-icon,mv-tod-active-ride-list .step-content svg-icon svg{width:.8235294118rem;height:.9411764706rem}mv-tod-active-ride-list .step-content.active:before,mv-tod-active-ride-list .step-content.progress:before{content:"";width:.8235294118rem;height:.8235294118rem;border-radius:50%;background-color:#0a73eb;border:solid 2px #fff;box-shadow:0 0 4px #0003;position:absolute;z-index:2}html[dir=ltr] mv-tod-active-ride-list .step-content.active:before,html[dir=ltr] mv-tod-active-ride-list .step-content.progress:before{left:-.1rem}html[dir=rtl] mv-tod-active-ride-list .step-content.active:before,html[dir=rtl] mv-tod-active-ride-list .step-content.progress:before{right:-.1rem}mv-tod-active-ride-list .step-content.active:before{top:5px}mv-tod-active-ride-list .step-content.progress:before{top:105%;z-index:1}mv-tod-active-ride-list .step-content.origin.active{top:0}mv-tod-active-ride-list .step-content.origin.active:before{top:5px}mv-tod-active-ride-list .step-content.origin,mv-tod-active-ride-list .step-content.dropoff{margin:22px 24px}mv-tod-active-ride-list .step-content.origin:after,mv-tod-active-ride-list .step-content.dropoff:after{background:none}html[dir=ltr] mv-tod-active-ride-list .step-content.origin:after,html[dir=ltr] mv-tod-active-ride-list .step-content.dropoff:after{border-left:1px dashed #737578}html[dir=rtl] mv-tod-active-ride-list .step-content.origin:after,html[dir=rtl] mv-tod-active-ride-list .step-content.dropoff:after{border-right:1px dashed #737578}html[dir=ltr] mv-tod-active-ride-list .step-content.origin:after,html[dir=ltr] mv-tod-active-ride-list .step-content.dropoff:after{transform:translate(.6px)}html[dir=rtl] mv-tod-active-ride-list .step-content.origin:after,html[dir=rtl] mv-tod-active-ride-list .step-content.dropoff:after{transform:translate(-.2px)}mv-tod-active-ride-list .step-content.disabled .address{color:#bdc3c7}mv-tod-active-ride-list .step-content.disabled svg-icon svg path:last-of-type{fill:#bdc3c7}html[dir=ltr] mv-tod-active-ride-list .step-content.disabled:after{border-left:1px dashed #BDC3C7}html[dir=rtl] mv-tod-active-ride-list .step-content.disabled:after{border-right:1px dashed #BDC3C7}html[dir=ltr] mv-tod-active-ride-list .step-content.disabled:after{transform:translate(.6px)}html[dir=rtl] mv-tod-active-ride-list .step-content.disabled:after{transform:translate(-.2px)}mv-tod-active-ride-list .step-content.destination:after{content:none}mv-tod-active-ride-list .step-content.pickup:after,mv-tod-active-ride-list .step-content.dropoff:after{top:1.5294117647rem}mv-tod-active-ride-list .step-content.pickup.progress .location-info div,mv-tod-active-ride-list .step-content.pickup.disabled .location-info div,mv-tod-active-ride-list .step-content.dropoff.progress .location-info div,mv-tod-active-ride-list .step-content.dropoff.disabled .location-info div{color:#bdc3c7}mv-tod-active-ride-list .step-content.pickup.progress svg-icon svg g.shapes path:nth-of-type(odd),mv-tod-active-ride-list .step-content.pickup.disabled svg-icon svg g.shapes path:nth-of-type(odd),mv-tod-active-ride-list .step-content.dropoff.progress svg-icon svg g.shapes path:nth-of-type(odd),mv-tod-active-ride-list .step-content.dropoff.disabled svg-icon svg g.shapes path:nth-of-type(odd){fill:#bdc3c7}mv-tod-active-ride-list .step-content.pickup:after{height:calc(100% + .0588235294rem)}mv-tod-active-ride-list .step-content:after{content:"";background:#737578;position:absolute;top:1rem;height:calc(100% + 10px);z-index:0}html[dir=ltr] mv-tod-active-ride-list .step-content:after{left:.3529411765rem}html[dir=rtl] mv-tod-active-ride-list .step-content:after{right:.3529411765rem}html[dir=ltr] mv-tod-active-ride-list .step-content:after{border-left:1px solid #737578}html[dir=rtl] mv-tod-active-ride-list .step-content:after{border-right:1px solid #737578}html[dir=ltr] mv-tod-active-ride-list .step-content:after{transform:translate(.6px)}html[dir=rtl] mv-tod-active-ride-list .step-content:after{transform:translate(-.2px)}mv-tod-active-ride-list .step-content .label{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}mv-tod-active-ride-list .step-content .address{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a30}mv-tod-active-ride-list .step-content .step-image{margin:0}html[dir=ltr] mv-tod-active-ride-list .step-content .step-image{margin-right:16px}html[dir=rtl] mv-tod-active-ride-list .step-content .step-image{margin-left:16px}mv-tod-active-ride-list .step-content .step-image,mv-tod-active-ride-list .step-content .step-image svg{width:.8235294118rem;height:.8235294118rem}mv-tod-active-ride-list .step-content .content{min-height:36px}mv-tod-active-ride-list .ride-state-list{padding:16px 44px;opacity:0;transition:all .8s ease-in-out}mv-tod-active-ride-list .future-ride .text-wrapper{display:flex;align-items:center;padding:16px 22px}mv-tod-active-ride-list .future-ride .text-wrapper.future-address{position:relative}mv-tod-active-ride-list .future-ride .text-wrapper svg-icon{height:24px;width:24px;margin:0}html[dir=ltr] mv-tod-active-ride-list .future-ride .text-wrapper svg-icon{margin-right:10px}html[dir=rtl] mv-tod-active-ride-list .future-ride .text-wrapper svg-icon{margin-left:10px}mv-tod-active-ride-list .future-ride .text-wrapper .text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f;flex-grow:1}mv-tod-active-ride-list .future-ride .text-wrapper .text.to-address{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:500;margin-top:6px}mv-tod-active-ride-list .close{width:calc(100% - 40px);border-radius:4px;border:solid 1px #0a73eb;background-color:#fff;margin:18px 20px;height:42px;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#0a73eb;font-weight:500;letter-spacing:.0147058824rem}mv-tod-active-ride-list .tell-us{height:4.8235294118rem;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;padding:0 20px}mv-tod-active-ride-list .tell-us .text{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:500}html[dir=ltr] mv-tod-active-ride-list .tell-us .text{padding-right:12px}html[dir=rtl] mv-tod-active-ride-list .tell-us .text{padding-left:12px}mv-tod-active-ride-list .tell-us .rate-button{display:flex;align-items:center;background-color:#0a73eb;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff;font-weight:500;padding:10px 12px;border-radius:4px}mv-tod-active-ride-list .tell-us .rate-button:before{content:url(/images/tod/star.svg);width:16px;height:16px}html[dir=ltr] mv-tod-active-ride-list .tell-us .rate-button:before{padding-right:6px}html[dir=rtl] mv-tod-active-ride-list .tell-us .rate-button:before{padding-left:6px}\n'],encapsulation:2}),e})();function hn(e,t){if(1&e&&(s.TgZ(0,"span",5),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Oqu(s.lcZ(2,1,e.titles.time))}}let mn=(()=>{class e{constructor(e,t){this.store=e,this.translateService=t}get disableDrag(){var e,t;return(null===(e=this.realTimeInfo)||void 0===e?void 0:e.journeyStatus)===se.fL.ARRIVED_DROP_OFF||(null===(t=this.realTimeInfo)||void 0===t?void 0:t.rideStatus)===se.Rl.COMPLETED}get isFutureRide(){var e;return(null===(e=this.realTimeInfo)||void 0===e?void 0:e.rideStatus)===se.Rl.FUTURE}unknownRealTimeStatus(){return{title:this.translateService.instant("tod_passenger_real_time_status_unknown"),subtitle:""}}get titles(){var e,t;if(!this.realTimeInfo||!this.rideInfo)return{title:"",subtitle:""};const{rideStatus:n,pickTime:i,dropOffTime:r,journeyStatus:o}=this.realTimeInfo,{pickup:a,dropoff:s}=this.rideInfo.journeyInfo;if(this.isFutureRide){if(!this.rideInfo.orderTime)return this.unknownRealTimeStatus();if(a&&s)return{title:this.translateService.instant("tod_order_pickup_time_future",{param1:C()(this.rideInfo.orderTime).format("LT")}),subtitle:a.caption};const n=null===(t=null===(e=this.store.getState().metro.currentMetro.taxiMetroConfigurations)||void 0===e?void 0:e.find(e=>e.taxiId===this.rideInfo.taxiProviderId))||void 0===t?void 0:t.metadata;return{title:this.translateService.instant("tod_passenger_ride_eta_future_time",{param1:C()(this.rideInfo.orderTime).format("LT")}),subtitle:(null==n?void 0:n.name)?this.translateService.instant("tod_future_ride_provider_name",{param1:null==n?void 0:n.name}):""}}if(n===se.Rl.CANCELLED||n===se.Rl.DECLINED)return{title:"tod_passenger_ride_status_cancelled_title",subtitle:"tod_passenger_ride_status_cancelled_message"};if(n===se.Rl.NO_SHOW)return{title:"tod_passenger_ride_status_passenger_not_shown_message_new",subtitle:"tod_passenger_ride_status_passenger_not_shown_title"};if(n===se.Rl.COMPLETED)return{title:"tod_passenger_real_time_status_arrived_to_destination",subtitle:s.caption};if(n===se.Rl.ACTIVE)switch(o){case se.fL.HEADING_PICKUP:return i?{title:this.translateService.instant("tod_passenger_ride_real_time_heading_pickup",{param1:""}),subtitle:a.caption,time:C()(i).fromNow(!0)}:this.unknownRealTimeStatus();case se.fL.APPROACHING_PICKUP:case se.fL.ARRIVED_PICKUP:return{title:"tod_passenger_real_time_status_arrived",subtitle:a.caption};case se.fL.HEADING_DROP_OFF:case se.fL.APPROACHING_DROP_OFF:return r?{title:this.translateService.instant("tod_passenger_real_time_status_on_ride",{param1:""}),subtitle:s.caption,time:C()(r).fromNow(!0)}:this.unknownRealTimeStatus();case se.fL.ARRIVED_DROP_OFF:return{title:"tod_passenger_real_time_status_arrived_to_destination",subtitle:s.caption};default:return{title:"",subtitle:""}}}}return e.elementHeight=102,e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(_.sK))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-active-ride-drag-zone"]],inputs:{realTimeInfo:"realTimeInfo",rideInfo:"rideInfo"},decls:11,vars:11,consts:[[1,"drag-handle"],[1,"active-top-section"],[1,"active-title"],["class","rt-text",4,"ngIf"],[1,"active-subtitle"],[1,"rt-text"]],template:function(e,t){1&e&&(s._UZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"div"),s.TgZ(3,"div",2),s._uU(4),s.ALo(5,"translate"),s.YNc(6,hn,3,3,"span",3),s.qZA(),s.qZA(),s.TgZ(7,"div"),s.TgZ(8,"div",4),s._uU(9),s.ALo(10,"translate"),s.qZA(),s.qZA(),s.qZA()),2&e&&(s.ekj("hidden",t.disableDrag),s.xp6(1),s.ekj("future-ride",t.isFutureRide),s.xp6(3),s.hij(" ",s.lcZ(5,7,t.titles.title)," "),s.xp6(2),s.Q6J("ngIf",t.titles.time),s.xp6(3),s.Oqu(s.lcZ(10,9,t.titles.subtitle)))},directives:[o.O5],pipes:[_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-active-ride-drag-zone .drag-handle{padding:8px 0 4px}mv-tod-active-ride-drag-zone .drag-handle:not(.hidden):before{content:"";display:block;top:.4705882353rem;width:1.8823529412rem;height:.2352941176rem;border-radius:2px;background-color:#bdc3c7;margin:auto}mv-tod-active-ride-drag-zone .drag-handle.hidden:before{visibility:hidden}mv-tod-active-ride-drag-zone .active-top-section{position:relative;padding:16px 20px}mv-tod-active-ride-drag-zone .active-top-section>div{display:flex;flex-wrap:wrap}mv-tod-active-ride-drag-zone .active-top-section.future-ride{display:block}html[dir=ltr] mv-tod-active-ride-drag-zone .active-top-section.future-ride .active-title,html[dir=ltr] mv-tod-active-ride-drag-zone .active-top-section.future-ride .active-subtitle{text-align:left}html[dir=rtl] mv-tod-active-ride-drag-zone .active-top-section.future-ride .active-title,html[dir=rtl] mv-tod-active-ride-drag-zone .active-top-section.future-ride .active-subtitle{text-align:right}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-tod-active-ride-drag-zone .active-top-section{flex-direction:column;width:100%}}mv-tod-active-ride-drag-zone .active-top-section:after{content:"";position:absolute;bottom:0;border-bottom:1px solid #ECF0F1;width:calc(100% - 40px)}mv-tod-active-ride-drag-zone .active-top-section .active-title,mv-tod-active-ride-drag-zone .active-top-section .active-subtitle{text-align:center;flex-grow:0;transition:all .7s ease-in-out;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}mv-tod-active-ride-drag-zone .active-top-section .active-title{font-size:1.2941176471rem;letter-spacing:-.0188235294rem;line-height:1.27;color:#302929;font-weight:bold}mv-tod-active-ride-drag-zone .active-top-section .active-subtitle{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;margin-top:8px}mv-tod-active-ride-drag-zone .rt-text{position:relative;color:#038844}html[dir=ltr] mv-tod-active-ride-drag-zone .rt-text{margin-left:.5882352941rem}html[dir=rtl] mv-tod-active-ride-drag-zone .rt-text{margin-right:.5882352941rem}html[dir=rtl] mv-tod-active-ride-drag-zone .rt-text:before,html[dir=rtl] mv-tod-active-ride-drag-zone .rt-text:after{transform:scaleX(-1)}mv-tod-active-ride-drag-zone .rt-text:before{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:.4705882353rem;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-active-ride-drag-zone .rt-text:before{left:-.3529411765rem}html[dir=rtl] mv-tod-active-ride-drag-zone .rt-text:before{right:-.3529411765rem}@media (prefers-reduced-motion: reduce){mv-tod-active-ride-drag-zone .rt-text:before{-webkit-animation:none;animation:none}}mv-tod-active-ride-drag-zone .rt-text:after{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.9411764706rem;position:absolute;top:.2941176471rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-active-ride-drag-zone .rt-text:after{left:-.5882352941rem}html[dir=rtl] mv-tod-active-ride-drag-zone .rt-text:after{right:-.5882352941rem}@media (prefers-reduced-motion: reduce){mv-tod-active-ride-drag-zone .rt-text:after{-webkit-animation:none;animation:none}}mv-tod-active-ride-drag-zone .rt-text:before{top:.2941176471rem}mv-tod-active-ride-drag-zone .rt-text:after{top:.1176470588rem}\n'],encapsulation:2}),e})();class gn{constructor(e,t,n,i,r){this.elementContainer=e,this.topElement=t,this.bottomElement=n,this.dragZoneHeight=i,this.maxBottomElementHeight=r}get minTopElementHeight(){return this.elementContainer.nativeElement.offsetHeight-this.maxBottomElementHeight-this.dragZoneHeight}convertSizePxToPercent(e){return(e+this.dragZoneHeight/2)/this.elementContainer.nativeElement.clientHeight*100}minMaxListContentSizes(e){var t;const n=(null===(t=this.bottomElement.nativeElement.firstElementChild)||void 0===t?void 0:t.scrollHeight)||0;return{minListSize:this.convertSizePxToPercent(e),maxListSize:this.convertSizePxToPercent(Math.max(e,n))}}}class fn{constructor(e,t){this.splitUtil=e,this.split=t}updateSizes(e,t,n){cancelAnimationFrame(this.interval);const{maxListSize:i,minListSize:r}=this.splitUtil.minMaxListContentSizes(t),o=this.split.getSizes()[1];let a=null;if(o>i)a=i;else{if(!(o<r))return;a=r}e?this.animateCollapse(a,n):this.split.setSizes([100-a,a])}animateCollapse(e,t){let n,i;const r=this.split.getSizes()[1],o=Math.abs(e-r)/.1,a=s=>{void 0===n&&(n=s);const l=s-n;let c;if(i!==s){const t=.1*l;c=r>e?Math.max(r-t,e):Math.min(r+t,e),this.split.setSizes([100-c,c])}l<=o&&c!==e?(i=s,this.interval=requestAnimationFrame(a)):"function"==typeof t&&t()};this.interval=requestAnimationFrame(a)}}var vn=n(96542);function yn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",5),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).onCancelSelected()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"action_cancel")))}function bn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",1),s.TgZ(1,"span",2),s.NdJ("click",function(){return s.CHM(e),s.oxw().toggleOpenMenu()}),s._UZ(2,"svg-icon",3),s.ALo(3,"translate"),s.qZA(),s.YNc(4,yn,3,3,"div",4),s.qZA()}if(2&e){const e=s.oxw();s.xp6(2),s.s9C("titleText",s.lcZ(3,2,"web_trip_plan_options")),s.xp6(2),s.Q6J("ngIf",e.isMenuOpen)}}let _n=(()=>{class e{constructor(e,t,n,i,r,o){this.todService=e,this.interactionService=t,this.store=n,this.uiActions=i,this.translateService=r,this.analyticsService=o,this.isMenuOpen=!1,this.cancelRideEvent=new s.vpe}canCancelRide(e){if(!e)return!1;const{rideStatus:t,journeyStatus:n}=e;switch(t){case se.Rl.FUTURE:return!0;case se.Rl.ACTIVE:return n<=se.fL.ARRIVED_PICKUP;default:return!1}}toggleOpenMenu(){this.isMenuOpen=!this.isMenuOpen,this.isMenuOpen&&this.analyticsService.sendEvent(d.a.TODActiveRideScreen,"TOD_RIDE_OPTIONS_CLICKED")}onCancelSelected(){const e=[this.realTimeInfo.rideId,this.analyticsService.todMode(this.realTimeInfo.rideStatus),this.rideDetails.taxiProviderId,se.YK[this.rideDetails.status]].join(", ");this.analyticsService.sendEvent(d.a.TODActiveRideScreen,"TOD_RIDE_CANCEL_CLICKED",e),this.analytics("TOD_RIDE_CANCELLATION_POPUP_IMPRESSION"),this.toggleOpenMenu(),this.interactionService.displayWarning(this.cancelRide.bind(this),this.analytics.bind(this,"TOD_RIDE_CANCELLATION_POPUP_DISMISSED"),{title:this.translateService.instant("tod_cancel_ride_popup_title"),text:this.translateService.instant("tod_cancel_ride_popup_message"),doButtonText:this.translateService.instant("tod_cancel_ride_popup_yes_button"),undoButtonText:this.translateService.instant("tod_cancel_ride_popup_no_button"),imageSrc:"images/icons/web-warning-x.svg"})}cancelRide(){var e,t;return(0,r.mG)(this,void 0,void 0,function*(){this.analytics("CANCEL_RIDE_CLICKED");const n=yield this.todService.realTimeInfo(this.realTimeInfo.rideId);if((null==n?void 0:n.info)&&this.canCancelRide(n.info)&&(yield this.todService.cancelRide(this.realTimeInfo.rideId),(null===(t=null===(e=yield this.todService.realTimeInfo(this.realTimeInfo.rideId))||void 0===e?void 0:e.info)||void 0===t?void 0:t.rideStatus)===se.Rl.CANCELLED))return this.cancelRideEvent.emit(),void this.store.dispatch(this.uiActions.showSnackbar(this.translateService.instant("tod_passenger_cancel_ride_success")));this.interactionService.displayWarning(this.cancelRide.bind(this),void 0,{title:this.translateService.instant("general_error_title"),text:this.translateService.instant("general_error_description"),doButtonText:this.translateService.instant("action_try_again"),undoButtonText:this.translateService.instant("action_cancel"),imageSrc:"images/icons/spot_warning.svg"})})}analytics(e){const t=[this.realTimeInfo.rideId,this.analyticsService.todMode(this.rideDetails.status),this.rideDetails.taxiProviderId,se.YK[this.rideDetails.status]].join(", ");this.analyticsService.sendEvent(d.a.TODPopup,e,t)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(ce.F),s.Y36(vn.k),s.Y36(l.d),s.Y36(Gt.V),s.Y36(_.sK),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-active-ride-options-menu"]],inputs:{realTimeInfo:"realTimeInfo",rideDetails:"rideDetails"},outputs:{cancelRideEvent:"cancelRideEvent"},decls:1,vars:1,consts:[["class","options",4,"ngIf"],[1,"options"],[3,"click"],["src","images/nav-icons/action-menu-v.svg","mvAccessibleSVG","",3,"titleText"],["class","option",3,"click",4,"ngIf"],[1,"option",3,"click"]],template:function(e,t){1&e&&s.YNc(0,bn,5,4,"div",0),2&e&&s.Q6J("ngIf",t.canCancelRide(t.realTimeInfo))},directives:[o.O5,Te.bk,Se.m],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-active-ride-options-menu{min-width:48px;height:100%}mv-tod-active-ride-options-menu .options{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#2196f3;min-width:48px;height:100%;align-self:center;position:relative;display:flex;align-items:center;justify-content:flex-end}html[dir=ltr] mv-tod-active-ride-options-menu .options{text-align:right}html[dir=rtl] mv-tod-active-ride-options-menu .options{text-align:left}mv-tod-active-ride-options-menu .options .option{position:absolute;top:100%;right:-22px;padding:12px 22px;z-index:999;background:white;width:180px;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 3px 14px 2px #0000001f,0 8px 10px 1px #00000024;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#001926}html[dir=ltr] mv-tod-active-ride-options-menu .options .option{text-align:left}html[dir=rtl] mv-tod-active-ride-options-menu .options .option{text-align:right}\n"],encapsulation:2}),e})();const Tn=["todMap"],Sn=["todList"],xn=["splitContainer"],wn=["dragZone"];function kn(e,t){if(1&e&&(s.TgZ(0,"div",22),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Oqu(e.title)}}function Mn(e,t){if(1&e&&(s.TgZ(0,"div",23),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Oqu(e.etaEndTime)}}function Ln(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-tod-active-ride-list",24),s.NdJ("goBack",function(){return s.CHM(e),s.oxw(2).goBack()}),s.qZA()}if(2&e){const e=s.oxw(2);s.Q6J("realTimeInfo",e.realTimeInfo)("rideInfo",e.todRideDetails)}}function An(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"div",2),s.TgZ(2,"div",3),s.TgZ(3,"a",4),s.NdJ("click",function(){return s.CHM(e),s.oxw().goBack()}),s._UZ(4,"svg-icon",5),s.ALo(5,"translate"),s.qZA(),s.qZA(),s.TgZ(6,"div",6),s.TgZ(7,"div"),s.YNc(8,kn,2,1,"div",7),s.YNc(9,Mn,2,1,"div",8),s.qZA(),s.qZA(),s.TgZ(10,"mv-tod-active-ride-options-menu",9),s.NdJ("cancelRideEvent",function(){return s.CHM(e),s.oxw().goBack()}),s.qZA(),s.qZA(),s.TgZ(11,"div",10),s.TgZ(12,"div",11,12),s.TgZ(14,"div",13,14),s._UZ(16,"mv-tod-active-ride-map",15),s.qZA(),s.TgZ(17,"div",16,17),s._UZ(19,"mv-tod-active-ride-drag-zone",18),s.qZA(),s.TgZ(20,"div",19,20),s.YNc(22,Ln,1,2,"mv-tod-active-ride-list",21),s.qZA(),s.qZA(),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(4),s.Q6J("titleText",s.lcZ(5,14,"action_back")),s.xp6(4),s.Q6J("ngIf",e.todRideDetails),s.xp6(1),s.Q6J("ngIf",e.etaEndTime),s.xp6(1),s.Q6J("rideDetails",e.todRideDetails)("realTimeInfo",e.realTimeInfo),s.xp6(4),s.ekj("full-height",!e.realTimeInfo||!e.todRideDetails),s.xp6(2),s.Q6J("rideInfo",e.todRideDetails)("realTimeInfo",e.realTimeInfo),s.xp6(3),s.ekj("expanded",e.isBottomsheetExpanded),s.Q6J("realTimeInfo",e.realTimeInfo)("rideInfo",e.todRideDetails),s.xp6(3),s.Q6J("ngIf",e.realTimeInfo&&e.todRideDetails)}}function In(e,t){1&e&&(s.TgZ(0,"div",25),s._UZ(1,"mv-spinner"),s.qZA())}let En=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c){this.document=e,this.store=t,this.element=n,this.canonicalService=i,this.routingService=r,this.todService=o,this.translateService=a,this.searchActions=s,this.universal=l,this.analyticsService=c,this.openClassName="opened",this.showTextClassName="show-text",this.isLoading=!1,this.title=""}ngOnInit(){this.rideId=this.routingService.getStateFromUrl().todRideId}ngAfterViewInit(){return(0,r.mG)(this,void 0,void 0,function*(){if(this.universal.isServer)return;if(this.rideId){yield(0,a.p5)(this.store);const{rides:e}=yield this.todService.myRides();this.todRideDetails=e.find(e=>e.rideId===this.rideId),yield this.updateRealTimeInfo(),this.dataRefreshTimer=setInterval(this.updateRealTimeInfo.bind(this),this.todService.realTimeInfoRefreshTimeInMS),this.analyticsForImpression()}if(!this.rideId||!this.todRideDetails)return void this.goBack();this.title=this.getRideTitleForDisplay(),this.splitUtil=new gn(this.splitContainer,this.todMap,this.todList,mn.elementHeight,pn.maxListHeight);const e=this.initialSize();this.split=(0,Bt.Z)([this.todMap.nativeElement,this.todList.nativeElement],{direction:"vertical",sizes:[100-e,e],minSize:[this.splitUtil.minTopElementHeight,0],gutterSize:mn.elementHeight,snapOffset:6,onDrag:e=>{this.updateSplitSizes(e[1],!1)},onDragEnd:()=>{this.mapComponent.refreshSize();const e="tod-active-ride-split-over";this.todMap.nativeElement.offsetHeight<10?this.element.nativeElement.classList.add(e):(this.element.nativeElement.classList.remove(e),this.todList.nativeElement.scrollTo({top:0,behavior:"smooth"}))},gutter:()=>this.dragZone.nativeElement}),this.splitDragUtil=new fn(this.splitUtil,this.split)})}ngOnDestroy(){this.cancelInterval(),this.rideId=null}get minListSize(){if(!this.realTimeInfo)return 0;const{journeyStatus:e,rideStatus:t}=this.realTimeInfo;return t===se.Rl.FUTURE||t===se.Rl.COMPLETED||e===se.fL.ARRIVED_DROP_OFF||e===se.fL.HEADING_PICKUP||e===se.fL.APPROACHING_PICKUP||e===se.fL.ARRIVED_PICKUP?pn.elementHeightInUndraggableMode:0}initialSize(){const{rideStatus:e}=this.realTimeInfo,{journeyInfo:t}=this.todRideDetails;return e===se.Rl.CANCELLED||e===se.Rl.DECLINED||e===se.Rl.NO_SHOW||e===se.Rl.FUTURE&&!t.pickup&&!t.pickup?this.splitUtil.convertSizePxToPercent(pn.elementHeightInUndraggableMode):this.splitUtil.minMaxListContentSizes(this.minListSize).minListSize}updateSplitSizes(e,t){this.splitDragUtil.updateSizes(t,this.minListSize,this.mapComponent.refreshSize.bind(this.mapComponent));const n=this.todList.nativeElement.offsetHeight,{classList:i}=this.element.nativeElement;n>pn.minHeightToAddOpenClass?i.add(this.openClassName):i.remove(this.openClassName),n>pn.minHeightToShowTextClass?i.add(this.showTextClassName):i.remove(this.showTextClassName),this.isBottomsheetExpanded=Math.floor(e)>5}updateRealTimeInfo(){return(0,r.mG)(this,void 0,void 0,function*(){if(!this.rideId||this.realTimeInfo&&this.realTimeInfo.rideStatus!==se.Rl.ACTIVE&&this.realTimeInfo.rideStatus!==se.Rl.FUTURE)return void this.cancelInterval();this.isLoading=!0;const e=this.realTimeInfo,t=yield this.todService.realTimeInfo(this.rideId);this.realTimeInfo=null==t?void 0:t.info,this.split&&e&&(e.journeyStatus!==this.realTimeInfo.journeyStatus||e.rideStatus!==this.realTimeInfo.rideStatus)&&setTimeout(()=>this.updateSplitSizes(this.split.getSizes()[1],!0)),this.setEtaTime(),this.isLoading=!1})}goBack(){const{savedRoute:e}=this.store.getState().global;e===this.canonicalService.buildStatefulPath([],D.zA.TOD_HISTORY_RIDE_DETAILS)?this.routingService.redirectTo(e):(this.store.dispatch(this.searchActions.setFromOrToText(i.$h.From,"")),this.store.dispatch(this.searchActions.setFromOrToText(i.$h.To,"")),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.TRIPPLAN_DIRECTIONS))),this.cancelInterval()}cancelInterval(){this.dataRefreshTimer&&clearInterval(this.dataRefreshTimer)}get isFutureRide(){var e;return(null===(e=this.todRideDetails)||void 0===e?void 0:e.status)===se.Rl.FUTURE}getRideTitleForDisplay(){if(!this.todRideDetails)return"";switch(this.todRideDetails.status){case se.Rl.CANCELLED:return this.translateService.instant("tod_passenger_ride_label_canceled");case se.Rl.COMPLETED:return this.translateService.instant("tod_ride_completed_title");case se.Rl.FUTURE:return this.translateService.instant("tod_passenger_ride_eta_future_date_title",{param1:C()(this.todRideDetails.orderTime).format("L")});default:return this.translateService.instant("tod_real_time_section_title")}}setEtaTime(){var e;if((null===(e=this.realTimeInfo)||void 0===e?void 0:e.dropOffTime)&&this.todRideDetails&&!this.isFutureRide){const e=C()(this.realTimeInfo.dropOffTime).add("minute",this.todRideDetails.journeyInfo.destinationWalkingTime).format("LT");this.etaEndTime=this.translateService.instant("tod_suggested_routes_eta",{param1:e})}else this.etaEndTime=""}analyticsForImpression(){var e;if(!this.todRideDetails||!this.realTimeInfo)return;const t=[this.realTimeInfo.rideId,this.analyticsService.todMode(this.realTimeInfo.rideStatus),this.todRideDetails.taxiProviderId,null===(e=this.todRideDetails.price)||void 0===e?void 0:e.balance,se.YK[this.realTimeInfo.rideStatus]].join(", ");this.analyticsService.sendEvent(d.a.TODActiveRideScreen,"TOD_RIDE_IMPRESSION",t)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(s.SBq),s.Y36(R.z),s.Y36(f.Z),s.Y36(ce.F),s.Y36(_.sK),s.Y36(h.P),s.Y36(v.p),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-active-ride-split-screen"]],viewQuery:function(e,t){if(1&e&&(s.Gf(Wt,5),s.Gf(Tn,5),s.Gf(Sn,5),s.Gf(xn,5),s.Gf(wn,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.mapComponent=e.first),s.iGM(e=s.CRH())&&(t.todMap=e.first),s.iGM(e=s.CRH())&&(t.todList=e.first),s.iGM(e=s.CRH())&&(t.splitContainer=e.first),s.iGM(e=s.CRH())&&(t.dragZone=e.first)}},decls:2,vars:2,consts:[[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"tod-top-bar"],[1,"back"],["tabindex","0",1,"back-link",3,"click"],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",3,"titleText"],[1,"title-wrapper"],["class","title",4,"ngIf"],["class","subtitle",4,"ngIf"],[3,"rideDetails","realTimeInfo","cancelRideEvent"],[1,"split-screens-content"],[1,"active-ride"],["splitContainer",""],["id","tod-itinerary-map"],["todMap",""],[2,"width","100%","height","100%",3,"rideInfo","realTimeInfo"],["id","drag-zone",1,"drag-zone"],["dragZone",""],[3,"realTimeInfo","rideInfo"],["id","tod-active-ride-list"],["todList",""],[3,"realTimeInfo","rideInfo","goBack",4,"ngIf"],[1,"title"],[1,"subtitle"],[3,"realTimeInfo","rideInfo","goBack"],[1,"spinner"]],template:function(e,t){1&e&&(s.YNc(0,An,23,16,"ng-container",0),s.YNc(1,In,2,0,"div",1)),2&e&&(s.Q6J("ngIf",t.universal.isBrowser),s.xp6(1),s.Q6J("ngIf",t.universal.isServer))},directives:[o.O5,Te.bk,Se.m,_n,Wt,mn,pn,mt.O],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container,mv-tod-active-ride-split-screen,#tod-active-ride-map{transition:top .4s cubic-bezier(.42,0,.3,1.15)}.tod-active-ride-split-over .content-container,.tod-active-ride-split-over mv-tod-active-ride-split-screen,.tod-active-ride-split-over #tod-active-ride-map{transition:top .3s ease}mv-tod-active-ride-split-screen .active-ride{flex-grow:1;overflow:hidden}mv-tod-active-ride-split-screen .full-height{height:100%}mv-tod-active-ride-split-screen .row-padding{padding:16px 22px}mv-tod-active-ride-split-screen .row-padding-sides{padding:0 22px}mv-tod-active-ride-split-screen.tod-active-ride-split-over .drag-zone{box-shadow:0 1px 4px #00000040}mv-tod-active-ride-split-screen.tod-active-ride-split-over .ride-pickup-info .pick-up-text{border-bottom-color:transparent}mv-tod-active-ride-split-screen.tod-active-ride-split-over #tod-active-ride-list{overflow-y:auto}mv-tod-active-ride-split-screen .tod-top-bar{display:flex;align-items:center;background-color:#fff;height:2.8235294118rem;width:100%;box-sizing:border-box;border-bottom:1px solid #c5c7c8}mv-tod-active-ride-split-screen .tod-top-bar .back{min-width:48px}mv-tod-active-ride-split-screen .tod-top-bar .back .back-link{height:1rem;padding:10px 0;display:inline-block}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link{padding-left:16px}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link{padding-right:16px}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link{padding-right:23px}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link{padding-left:23px}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon{transform:scaleX(-1)}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon{transform:scaleX(1)}mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon,mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon svg{width:.5294117647rem;height:1rem}mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon polygon,mv-tod-active-ride-split-screen .tod-top-bar .back .back-link svg-icon svg polygon{fill:#292a30}mv-tod-active-ride-split-screen .tod-top-bar>.title{flex-grow:1;text-align:center}mv-tod-active-ride-split-screen .tod-top-bar .title-wrapper{flex-grow:1;text-align:center}mv-tod-active-ride-split-screen .tod-top-bar .title-wrapper .title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:600}mv-tod-active-ride-split-screen .tod-top-bar .title-wrapper .subtitle{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:400}mv-tod-active-ride-split-screen .tod-top-bar .options{display:flex;height:100%;align-items:center;min-width:48px;box-sizing:border-box}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .options{padding-right:10px}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .options{padding-left:10px}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .options{padding-left:14px}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .options{padding-right:14px}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .options{text-align:right}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .options{text-align:left}mv-tod-active-ride-split-screen .tod-top-bar .options .option{position:absolute;top:100%;right:-22px;padding:12px 22px;z-index:999;background:white;width:180px;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 3px 14px 2px #0000001f,0 8px 10px 1px #00000024;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#001926}html[dir=ltr] mv-tod-active-ride-split-screen .tod-top-bar .options .option{text-align:left}html[dir=rtl] mv-tod-active-ride-split-screen .tod-top-bar .options .option{text-align:right}mv-tod-active-ride-split-screen .split-screens-content{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden;z-index:0;background-color:#f0ebe6}mv-tod-active-ride-split-screen #tod-active-ride-map{display:flex}mv-tod-active-ride-split-screen .drag-zone,mv-tod-active-ride-split-screen #tod-active-ride-list{position:relative;background-color:#fff;overflow-y:hidden}mv-tod-active-ride-split-screen #tod-active-ride-list{z-index:2}mv-tod-active-ride-split-screen #tod-active-ride-list:not(.dragging){transition:height .5s cubic-bezier(.37,.05,.3,1)}mv-tod-active-ride-split-screen .drag-zone{width:100%;padding:0;box-sizing:border-box;z-index:2;transition:box-shadow .4s ease-in-out;border-top-right-radius:8px;border-top-left-radius:8px;box-shadow:0 1px 8px #0003}.tod-active-ride-split-over mv-tod-active-ride-split-screen .drag-zone{box-shadow:none}mv-tod-active-ride-split-screen .stops-list{position:relative;z-index:1}mv-tod-active-ride-split-screen .active-ride .drag-zone{height:6rem!important}\n"],encapsulation:2}),e})();function Cn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",6),s.NdJ("click",function(){return s.CHM(e),s.oxw().onRightIconClicked()}),s.TgZ(1,"a"),s._UZ(2,"svg-icon",7),s.ALo(3,"translate"),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.s9C("titleText",s.lcZ(3,1,"action_close")))}let Dn=(()=>{class e{constructor(){this.goBackClick=new s.vpe,this.rightIconClick=new s.vpe}onGoBackClicked(){this.goBackClick.emit()}onRightIconClicked(){this.rightIconClick.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-my-rides-header"]],inputs:{centerText:"centerText",hasRightIcon:"hasRightIcon"},outputs:{goBackClick:"goBackClick",rightIconClick:"rightIconClick"},decls:8,vars:5,consts:[[1,"header-left"],[1,"back-link",3,"click"],["src","images/nav-icons/back-i-os.svg","mvAccessibleSVG","",3,"titleText"],[1,"my-rides-title"],[1,"header-right"],[3,"click",4,"ngIf"],[3,"click"],["src","images/tod/more-info-empty.svg","mvAccessibleSVG","",1,"more-info-icon",3,"titleText"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"a",1),s.NdJ("click",function(){return t.onGoBackClicked()}),s._UZ(2,"svg-icon",2),s.ALo(3,"translate"),s.qZA(),s.qZA(),s.TgZ(4,"h2",3),s._uU(5),s.qZA(),s.TgZ(6,"div",4),s.YNc(7,Cn,4,3,"div",5),s.qZA()),2&e&&(s.xp6(2),s.s9C("titleText",s.lcZ(3,3,"action_close")),s.xp6(3),s.Oqu(t.centerText),s.xp6(2),s.Q6J("ngIf",t.hasRightIcon))},directives:[Te.bk,Se.m,o.O5],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-my-rides-header{display:flex;justify-content:space-between;align-items:center;padding:0 10px;min-height:2.3529411765rem}mv-tod-my-rides-header .header-left,mv-tod-my-rides-header .header-right{min-width:20%}html[dir=rtl] mv-tod-my-rides-header .back-link svg{transform:scaleX(-1)}mv-tod-my-rides-header .back-link svg use{fill:#292a30}mv-tod-my-rides-header .my-rides-title{margin:0;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:500;text-align:center;flex-grow:1}mv-tod-my-rides-header .header-right a{display:block;height:14px;padding:13px}html[dir=ltr] mv-tod-my-rides-header .header-right a{text-align:right}html[dir=rtl] mv-tod-my-rides-header .header-right a{text-align:left}mv-tod-my-rides-header .header-right a .more-info-icon{height:14px;width:14px}\n"],encapsulation:2}),e})();function Pn(e,t){1&e&&(s.TgZ(0,"div",2),s._UZ(1,"mv-spinner"),s.qZA())}function On(e,t){if(1&e&&(s.ynx(0),s._UZ(1,"svg-icon",4),s._UZ(2,"div",5),s.ALo(3,"safeHtml"),s.BQk()),2&e){const e=s.oxw(2);s.xp6(1),s.Q6J("titleText","empty history image"),s.xp6(1),s.Q6J("innerHTML",s.lcZ(3,2,e.emptyRideMessage),s.oJD)}}function Nn(e,t){if(1&e&&(s._UZ(0,"div",22),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw().$implicit;s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.taxiIcon)),s.oJD)}}function Rn(e,t){if(1&e&&(s.TgZ(0,"div",23),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.price)}}function $n(e,t){1&e&&(s.TgZ(0,"div",23),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"free_key")))}function Yn(e,t){if(1&e&&(s.TgZ(0,"div",24),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.subtitle)}}function Fn(e,t){if(1&e&&(s.TgZ(0,"div",25),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.subtitle)}}function Bn(e,t){if(1&e&&(s.TgZ(0,"div",31),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2).$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,e.cancellationFeeText))}}function Un(e,t){if(1&e&&(s.TgZ(0,"div",26),s.TgZ(1,"div",27),s._UZ(2,"svg-icon",28),s.TgZ(3,"span",29),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA(),s.YNc(6,Bn,3,3,"div",30),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(2),s.Q6J("src",e.completeIcon),s.xp6(1),s.Udp("color",e.completeColor),s.xp6(1),s.Oqu(s.lcZ(5,5,e.completeReason)),s.xp6(2),s.Q6J("ngIf",e.cancellationFeeText)}}function Zn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",10),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw(4).goToRideDetails(t)}),s.TgZ(1,"div",11),s.TgZ(2,"div",12),s.YNc(3,Nn,3,5,"div",13),s._UZ(4,"div",14),s.qZA(),s.TgZ(5,"div",15),s.TgZ(6,"div"),s.TgZ(7,"div",16),s._uU(8),s.qZA(),s.TgZ(9,"div",17),s.YNc(10,Rn,2,1,"div",18),s.YNc(11,$n,3,3,"div",18),s.qZA(),s.qZA(),s.TgZ(12,"div"),s.YNc(13,Yn,2,1,"div",19),s.qZA(),s.YNc(14,Fn,2,1,"div",20),s.YNc(15,Un,7,7,"div",21),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw(4);s.ekj("active",e.dataType===n.RideDetailsType.Active)("future",e.dataType===n.RideDetailsType.Future),s.xp6(3),s.Q6J("ngIf",e.taxiIcon),s.xp6(1),s.Udp("background-color",e.taxiBackgroundColor),s.xp6(4),s.Oqu(e.title),s.xp6(2),s.Q6J("ngIf",!e.isFree),s.xp6(1),s.Q6J("ngIf",e.isFree),s.xp6(2),s.Q6J("ngIf",e.dataType!==n.RideDetailsType.Future),s.xp6(1),s.Q6J("ngIf",e.dataType===n.RideDetailsType.Future),s.xp6(1),s.Q6J("ngIf",e.shouldShowCompletedDetails)}}function jn(e,t){if(1&e&&(s.TgZ(0,"div",7),s.TgZ(1,"div",8),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,Zn,16,13,"div",9),s.qZA()),2&e){const e=t.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,2,e.name)),s.xp6(2),s.Q6J("ngForOf",e.rides)}}function Vn(e,t){if(1&e&&(s.ynx(0),s.YNc(1,jn,5,4,"div",6),s.BQk()),2&e){const e=s.oxw(2);s.xp6(1),s.Q6J("ngForOf",e.allRides)}}function Hn(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"mv-tod-my-rides-header",3),s.NdJ("goBackClick",function(){return s.CHM(e),s.oxw().goBack()}),s.ALo(2,"translate"),s.qZA(),s.YNc(3,On,4,4,"ng-container",1),s.YNc(4,Vn,2,1,"ng-container",1),s.BQk()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("centerText",s.lcZ(2,3,"tod_passenger_rides_center_title")),s.xp6(2),s.Q6J("ngIf",e.isEmptyRides),s.xp6(1),s.Q6J("ngIf",!e.isEmptyRides)}}var Gn=(()=>{return(e=Gn||(Gn={}))[e.Active=1]="Active",e[e.Future=2]="Future",e[e.Past=3]="Past",Gn;var e})();let zn=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.todService=e,this.store=t,this.imageService=n,this.routingService=i,this.canonicalService=r,this.translateService=o,this.userActions=a,this.analyticsService=s,this.allRides=[],this.RideDetailsType=Gn,this.isEmptyRides=!1}ngOnInit(){var e,t,n;return(0,r.mG)(this,void 0,void 0,function*(){if(this.isLoading=!0,yield(0,a.p5)(this.store),this.state.user.accountStatus!==Ye.dp.Authenticated)return this.store.dispatch(this.userActions.setPostLoginPath(this.canonicalService.buildStatefulPath([],D.zA.TOD_HISTORY_RIDES))),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"])),void(this.isLoading=!1);const i=yield this.todService.myRides(),r=(null===(e=null==i?void 0:i.rides)||void 0===e?void 0:e.length)?`rides_count=${i.rides.length}`:"";if(this.analyticsService.sendEvent(d.a.TODMyRides,"TOD_RIDES_CENTER_IMPRESSION",r),!(null===(t=null==i?void 0:i.rides)||void 0===t?void 0:t.length))return this.isEmptyRides=!0,this.isLoading=!1,this.analyticsService.sendEvent(d.a.TODMyRides,"TOD_RIDES_CENTER_EMPTY_IMPRESSION"),void(this.emptyRideMessage=null===(n=this.translateService.instant("web_tod_passenger_rides_center_empty_message"))||void 0===n?void 0:n.replace(/\\n/g,"<br>"));const o=[],s=[],l=[];for(const e of i.rides){const t=this.createRideDetails(e);switch(e.status){case se.Rl.ACTIVE:o.push(t);break;case se.Rl.FUTURE:s.push(t);break;default:l.push(t)}}this.allRides=[{name:"tod_passenger_rides_center_active_section",rides:o},{name:"tod_passenger_rides_center_future_section",rides:s},{name:"tod_passenger_rides_center_historical_section",rides:l}].filter(e=>e.rides.length),this.isLoading=!1})}get state(){return this.store.getState()}createRideDetails(e){var t;const{status:n,taxiProviderId:i,journeyInfo:r}=e,o=null===(t=this.state.metro.currentMetro.taxiMetroConfigurations.find(e=>e.taxiId===i))||void 0===t?void 0:t.metadata,{color:a,icon:s,text:l}=ze(n),{isFree:c,price:d}=Je(e.price),u={taxiIcon:(null==o?void 0:o.shortImage)?this.imageService.getImageHTML(o.shortImage.imageId,o.shortImage.parameters):"",isFree:c,price:d,rideId:e.rideId,completeColor:a,completeIcon:s,completeReason:l,originRide:e};switch(n){case se.Rl.ACTIVE:return Object.assign(Object.assign({},u),{dataType:Gn.Active,taxiBackgroundColor:(null==o?void 0:o.ctaBackgroundColor)?(0,le.vq)(o.ctaBackgroundColor):"",title:qe(e.orderTime),shouldShowCompletedDetails:!1,subtitle:r.destination.caption});case se.Rl.FUTURE:return Object.assign(Object.assign({},u),{dataType:Gn.Future,title:(null==o?void 0:o.name)||"",shouldShowCompletedDetails:!1,subtitle:this.translateService.instant("tod_passenger_order_future_pickup_details",{param1:C()(e.orderTime).format("L"),param2:C()(e.orderTime).format("LT")})});case se.Rl.DECLINED:case se.Rl.CANCELLED:return Object.assign(Object.assign({},u),{cancellationFeeText:n!==se.Rl.CANCELLED||c?"":"tod_passenger_ride_details_status_description",dataType:Gn.Past,title:qe(e.orderTime),subtitle:r.destination.caption,shouldShowCompletedDetails:!0});case se.Rl.NO_SHOW:return Object.assign(Object.assign({},u),{cancellationFeeText:c?"":"tod_passenger_ride_details_status_description",dataType:Gn.Past,title:qe(e.orderTime),subtitle:r.destination.caption,shouldShowCompletedDetails:!0});case se.Rl.COMPLETED:return Object.assign(Object.assign({},u),{dataType:Gn.Past,title:qe(e.orderTime),subtitle:r.destination.caption,shouldShowCompletedDetails:!0})}}goToRideDetails(e){this.analyticsService.sendEvent(d.a.TODMyRides,"TOD_RIDES_CENTER_RIDE_CLICKED",[e.originRide.rideId,this.analyticsService.todMode(e.originRide.status),e.originRide.taxiProviderId,se.YK[e.originRide.status]].join(", "));const{dataType:t,rideId:n}=e;let i=D.zA.TOD_HISTORY_RIDE_DETAILS;(t===Gn.Active||t===Gn.Future)&&(i=D.zA.TOD_ACTIVE_RIDE),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],i),{todRideId:n})}goBack(){this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.TRIPPLAN_DIRECTIONS)),this.isLoading=!1}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(ce.F),s.Y36(l.d),s.Y36(ue.KD),s.Y36(f.Z),s.Y36(R.z),s.Y36(_.sK),s.Y36(Be.E),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-history-rides"]],decls:2,vars:2,consts:[["class","spinner",4,"ngIf"],[4,"ngIf"],[1,"spinner"],[3,"centerText","goBackClick"],["src","images/tod/tod-welcome-light.svg","mvAccessibleSVG","",1,"empty-history-image",3,"titleText"],[1,"empty-history-text",3,"innerHTML"],["class","rides-section",4,"ngFor","ngForOf"],[1,"rides-section"],[1,"rides-section-title"],["class","ride",3,"active","future","click",4,"ngFor","ngForOf"],[1,"ride",3,"click"],[1,"ride-wrapper"],[1,"ride-logo-wrapper"],["class","ride-logo",3,"innerHTML",4,"ngIf"],[1,"pulse"],[1,"ride-details"],[1,"ride-details-title"],[1,"ride-price"],["class","price",4,"ngIf"],["class","ride-details-text",4,"ngIf"],["class","ride-future-text",4,"ngIf"],["class","ride-status",4,"ngIf"],[1,"ride-logo",3,"innerHTML"],[1,"price"],[1,"ride-details-text"],[1,"ride-future-text"],[1,"ride-status"],[1,"status-text-wrapper"],[1,"status-icon",3,"src"],[1,"status-text"],["class","cancelation-fee",4,"ngIf"],[1,"cancelation-fee"]],template:function(e,t){1&e&&(s.YNc(0,Pn,2,0,"div",0),s.YNc(1,Hn,5,5,"ng-container",1)),2&e&&(s.Q6J("ngIf",t.isLoading),s.xp6(1),s.Q6J("ngIf",!t.isLoading))},directives:[o.O5,mt.O,Dn,Te.bk,Se.m,o.sg],pipes:[_.X$,pe.z,o.Ov],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-history-rides .spinner{position:fixed!important}mv-tod-history-rides .rides-section-title{font-size:.8823529412rem;color:#000001;background-color:#e8f0f0;min-height:2.3529411765rem;padding:12px 22px;box-sizing:border-box}mv-tod-history-rides .empty-history-image{display:block;width:320px;height:170px;margin-top:40px}mv-tod-history-rides .empty-history-text{padding:0 22px;margin:0;text-align:center;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a3099}mv-tod-history-rides .ride{padding:15px 22px;position:relative}mv-tod-history-rides .ride:after{background:#ECF0F1;content:"";display:block;height:1px;position:absolute;bottom:0;left:22px;width:calc(100% - 44px);z-index:0}mv-tod-history-rides .ride .ride-logo-wrapper{margin-top:4px;position:relative}html[dir=ltr] mv-tod-history-rides .ride .ride-logo-wrapper{margin-right:12px}html[dir=rtl] mv-tod-history-rides .ride .ride-logo-wrapper{margin-left:12px}mv-tod-history-rides .ride .ride-logo-wrapper .ride-logo{position:relative;width:24px;height:24px;z-index:1}mv-tod-history-rides .ride .ride-logo-wrapper .ride-logo .mvf-wrapper{width:23px;height:23px}mv-tod-history-rides .ride .ride-logo-wrapper .ride-logo .mvf-wrapper .boxed{border-bottom:none}mv-tod-history-rides .ride .ride-logo-wrapper .pulse{position:absolute;width:calc(100% + 4px);height:calc(100% + 4px);top:-2px;border-radius:50%;z-index:0;-webkit-animation:logo-back-pulse 2s infinite;animation:logo-back-pulse 2s infinite}html[dir=ltr] mv-tod-history-rides .ride .ride-logo-wrapper .pulse{left:-3px}html[dir=rtl] mv-tod-history-rides .ride .ride-logo-wrapper .pulse{right:-3px}mv-tod-history-rides .ride .ride-wrapper{display:flex;justify-content:space-between;align-items:flex-start}mv-tod-history-rides .ride .ride-wrapper .ride-details{display:flex;justify-content:space-between;flex-wrap:wrap;flex-grow:1}mv-tod-history-rides .ride .ride-wrapper .ride-details>div{display:flex;justify-content:space-between;width:100%}mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-details-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}html[dir=ltr] mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-details-title{padding-right:12px}html[dir=rtl] mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-details-title{padding-left:12px}mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-details-text,mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-future-text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#515357;margin-top:2px}mv-tod-history-rides .ride .ride-wrapper .ride-details .ride-details-text{max-width:calc(100vw - 80px);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}mv-tod-history-rides .ride .ride-wrapper .price{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}html[dir=ltr] mv-tod-history-rides .ride .ride-wrapper .price{text-align:right}html[dir=rtl] mv-tod-history-rides .ride .ride-wrapper .price{text-align:left}mv-tod-history-rides .ride .ride-wrapper .price.is-free{text-decoration:line-through;color:#525357;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}mv-tod-history-rides .ride .ride-status{display:flex;align-items:center;margin-top:8px;width:100%}mv-tod-history-rides .ride .ride-status .status-text-wrapper{display:flex;align-items:center}mv-tod-history-rides .ride .ride-status .status-text-wrapper .status-icon{width:14px;height:14px;margin:0}html[dir=ltr] mv-tod-history-rides .ride .ride-status .status-text-wrapper .status-icon{margin-right:5px}html[dir=rtl] mv-tod-history-rides .ride .ride-status .status-text-wrapper .status-icon{margin-left:5px}mv-tod-history-rides .ride .ride-status .status-text-wrapper .status-text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-tod-history-rides .ride .ride-status .cancelation-fee{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}\n'],encapsulation:2}),e})();function qn(e,t){1&e&&(s.TgZ(0,"div",2),s._UZ(1,"mv-spinner"),s.qZA())}function Jn(e,t){if(1&e&&(s._UZ(0,"div",28),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.taxiIcon)),s.oJD)}}function Wn(e,t){if(1&e&&(s.TgZ(0,"div",29),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.AsE(" ",e.licencePlate," \u2022 ",e.driverName," ")}}function Qn(e,t){1&e&&(s.TgZ(0,"div",30),s.TgZ(1,"div"),s._UZ(2,"svg-icon",31),s.ALo(3,"translate"),s.TgZ(4,"span",26),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Q6J("titleText",s.lcZ(3,2,"tod_passenger_ride_details_accessible")),s.xp6(3),s.Oqu(s.lcZ(6,4,"tod_passenger_ride_details_accessible")))}function Kn(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",32),s.TgZ(1,"button",33),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).rateRide()}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.Oqu(s.lcZ(3,1,"tod_passenger_rides_details_rate_button")))}function Xn(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"mv-tod-my-rides-header",3),s.NdJ("goBackClick",function(){return s.CHM(e),s.oxw().goBack()})("rightIconClick",function(){return s.CHM(e),s.oxw().goToRideDetails()}),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"div",4),s.TgZ(4,"div",5),s._uU(5),s.qZA(),s.TgZ(6,"div",6),s._UZ(7,"svg-icon",7),s.TgZ(8,"span",8),s._uU(9),s.ALo(10,"translate"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(11,"div",9),s.TgZ(12,"div",10),s.TgZ(13,"div",11),s.YNc(14,Jn,3,5,"div",12),s.qZA(),s.TgZ(15,"div",13),s.TgZ(16,"div"),s.TgZ(17,"div",14),s._uU(18),s.qZA(),s.YNc(19,Wn,2,2,"div",15),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(20,"div",16),s._UZ(21,"svg-icon",17),s.ALo(22,"translate"),s.TgZ(23,"div"),s.TgZ(24,"div",18),s._uU(25),s.qZA(),s.TgZ(26,"div",19),s._uU(27),s.qZA(),s.qZA(),s.qZA(),s.TgZ(28,"div",20),s.TgZ(29,"div"),s._UZ(30,"svg-icon",21),s.ALo(31,"translate"),s.TgZ(32,"span",22),s._uU(33),s.qZA(),s.qZA(),s.qZA(),s.YNc(34,Qn,7,6,"div",23),s.TgZ(35,"div",24),s.TgZ(36,"div"),s._UZ(37,"svg-icon",25),s.ALo(38,"translate"),s.TgZ(39,"span",26),s._uU(40),s.ALo(41,"translate"),s.qZA(),s.qZA(),s.TgZ(42,"div",26),s._uU(43),s.ALo(44,"translate"),s.qZA(),s.qZA(),s.YNc(45,Kn,4,3,"div",27),s.BQk()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("centerText",s.lcZ(2,20,"tod_passenger_rides_details_title"))("hasRightIcon",!0),s.xp6(4),s.Oqu(e.time),s.xp6(2),s.Q6J("src",e.statusIcon),s.xp6(1),s.Udp("color",e.statusColor),s.xp6(1),s.Oqu(s.lcZ(10,22,e.statusText)),s.xp6(5),s.Q6J("ngIf",e.taxiIcon),s.xp6(4),s.Oqu(e.taxiName),s.xp6(1),s.Q6J("ngIf",e.licencePlate||e.driverName),s.xp6(2),s.s9C("titleText",s.lcZ(22,24,"dashboard_recent_trip_title")),s.xp6(4),s.Oqu(e.from),s.xp6(2),s.Oqu(e.to),s.xp6(3),s.s9C("titleText",s.lcZ(31,26,"dashboard_recent_trip_title")),s.xp6(3),s.Oqu(e.numOfPassengers),s.xp6(1),s.Q6J("ngIf",e.isAccessible),s.xp6(3),s.Q6J("titleText",s.lcZ(38,28,"tod_passenger_ride_details_ride_fare")),s.xp6(3),s.Oqu(s.lcZ(41,30,"tod_passenger_ride_details_ride_fare")),s.xp6(3),s.Oqu(e.isFree?s.lcZ(44,32,"tod_passenger_free_ride"):e.price),s.xp6(2),s.Q6J("ngIf",e.canRate)}}let ei=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.todService=e,this.store=t,this.imageService=n,this.routingService=i,this.canonicalService=r,this.translateService=o,this.userActions=a,this.analyticsService=s}ngOnInit(){var e;return(0,r.mG)(this,void 0,void 0,function*(){if(this.isLoading=!0,yield(0,a.p5)(this.store),this.state.user.accountStatus!==Ye.dp.Authenticated)return this.store.dispatch(this.userActions.setPostLoginPath(this.canonicalService.buildStatefulPath([],D.zA.TOD_HISTORY_RIDES))),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"])),void(this.isLoading=!1);const t=this.routingService.getStateFromUrl().todRideId;if(!t)return void this.goBack();const n=yield this.todService.myRides();if(this.ride=null==n?void 0:n.rides.find(e=>e.rideId===t),!this.ride)return void this.goBack();const{taxiProviderId:i,vehicle:r,numOfPassengers:o,numberOfAccessiblePassengers:s,orderTime:l,status:c,journeyInfo:u}=this.ride,p=[t,this.analyticsService.todMode(this.ride.status),i,se.YK[c]].join(", ");this.analyticsService.sendEvent(d.a.TODRideDetailsScreen,"TOD_RIDE_DETAILS_IMPRESSION",p);const h=null===(e=this.state.metro.currentMetro.taxiMetroConfigurations.find(e=>e.taxiId===i))||void 0===e?void 0:e.metadata;h&&(this.taxiIcon=(null==h?void 0:h.shortImage)?this.imageService.getImageHTML(h.shortImage.imageId,h.shortImage.parameters):null,this.taxiName=h.name),this.time=qe(l),this.from=u.origin.caption,this.to=u.destination.caption,this.licencePlate=null==r?void 0:r.licencePlate,this.driverName=null==r?void 0:r.driverName,this.numOfPassengers=this.translateService.instant(1===o?"units_passenger":"units_passengers",{param1:o}),this.isAccessible=!!s;const{price:m,isFree:g}=Je(this.ride.price);this.price=m,this.isFree=g;const{text:f,icon:v,color:y}=ze(c);this.statusColor=y,this.statusIcon=v,this.statusText=f,this.canRate=this.ride.canRate,this.isLoading=!1})}get state(){return this.store.getState()}goToRideDetails(){this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.TOD_ACTIVE_RIDE),{todRideId:this.routingService.getStateFromUrl().todRideId})}goBack(){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TOD_HISTORY_RIDES),{todRideId:null}),this.isLoading=!1}rateRide(){return(0,r.mG)(this,void 0,void 0,function*(){this.analyticsService.sendEvent(d.a.TODRideDetailsScreen,"TOD_RATE_YOUR_RIDE_CLICKED","click_origin=ride details screen"),this.canRate=!(yield this.todService.rateRide(this.ride.rideId,this.ride.taxiProviderId,this.ride.status))})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(ce.F),s.Y36(l.d),s.Y36(ue.KD),s.Y36(f.Z),s.Y36(R.z),s.Y36(_.sK),s.Y36(Be.E),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-history-ride-details"]],decls:2,vars:2,consts:[["class","spinner",4,"ngIf"],[4,"ngIf"],[1,"spinner"],[3,"centerText","hasRightIcon","goBackClick","rightIconClick"],[1,"time-and-status"],[1,"time"],[1,"ride-status"],[1,"status-icon",3,"src"],[1,"status-text"],[1,"ride"],[1,"ride-wrapper"],[1,"ride-logo-wrapper"],["class","ride-logo",3,"innerHTML",4,"ngIf"],[1,"ride-details"],[1,"ride-details-title"],["class","ride-driver",4,"ngIf"],[1,"address-wrapper"],["src","images/tod/recent-trips.svg","mvAccessibleSVG","",1,"recent-trips-icon",3,"titleText"],[1,"from-address","text"],[1,"to-address","text"],[1,"ride-detail-item","passengers"],["src","images/tod/passanger-24.svg","mvAccessibleSVG","",1,"detail-item-icon",3,"titleText"],[1,"text","amount"],["class","ride-detail-item accessible",4,"ngIf"],[1,"ride-detail-item"],["src","images/icons/credit-card.svg","mvAccessibleSVG","",1,"detail-item-icon",3,"titleText"],[1,"text"],["class","bottom",4,"ngIf"],[1,"ride-logo",3,"innerHTML"],[1,"ride-driver"],[1,"ride-detail-item","accessible"],["src","images/tod/icon-accessability.svg","mvAccessibleSVG","",1,"detail-item-icon",3,"titleText"],[1,"bottom"],[1,"button",3,"click"]],template:function(e,t){1&e&&(s.YNc(0,qn,2,0,"div",0),s.YNc(1,Xn,46,34,"ng-container",1)),2&e&&(s.Q6J("ngIf",t.isLoading),s.xp6(1),s.Q6J("ngIf",!t.isLoading))},directives:[o.O5,mt.O,Dn,Te.bk,Se.m],pipes:[_.X$,pe.z,o.Ov],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-history-ride-details .time-and-status{position:relative;padding:8px 23px 16px;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center}mv-tod-history-ride-details .time-and-status:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:0px;width:calc(100% - 0px);z-index:0}mv-tod-history-ride-details .time-and-status .time{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-tod-history-ride-details .time-and-status .ride-status{display:flex;align-items:center}mv-tod-history-ride-details .time-and-status .ride-status .status-icon{width:14px;height:14px;margin:0}html[dir=ltr] mv-tod-history-ride-details .time-and-status .ride-status .status-icon{margin-right:5px}html[dir=rtl] mv-tod-history-ride-details .time-and-status .ride-status .status-icon{margin-left:5px}mv-tod-history-ride-details .time-and-status .ride-status .status-text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-tod-history-ride-details .time-and-status .ride-status .cancelation-fee{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}mv-tod-history-ride-details .ride{padding:15px 23px;position:relative}mv-tod-history-ride-details .ride:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:22px;width:calc(100% - 44px);z-index:0}mv-tod-history-ride-details .ride .ride-logo-wrapper{position:relative}html[dir=ltr] mv-tod-history-ride-details .ride .ride-logo-wrapper{margin-right:12px}html[dir=rtl] mv-tod-history-ride-details .ride .ride-logo-wrapper{margin-left:12px}mv-tod-history-ride-details .ride .ride-logo-wrapper .ride-logo{position:relative;width:24px;height:24px;z-index:1}mv-tod-history-ride-details .ride .ride-logo-wrapper .ride-logo .mvf-wrapper{width:23px;height:23px}mv-tod-history-ride-details .ride .ride-logo-wrapper .ride-logo .mvf-wrapper .boxed{border-bottom:none}mv-tod-history-ride-details .ride .ride-logo-wrapper .pulse{position:absolute;width:calc(100% + 4px);height:calc(100% + 4px);top:-2px;border-radius:50%;z-index:0;-webkit-animation:logo-back-pulse 2s infinite;animation:logo-back-pulse 2s infinite}html[dir=ltr] mv-tod-history-ride-details .ride .ride-logo-wrapper .pulse{left:-3px}html[dir=rtl] mv-tod-history-ride-details .ride .ride-logo-wrapper .pulse{right:-3px}mv-tod-history-ride-details .ride .ride-wrapper{display:flex;justify-content:space-between;align-items:center}mv-tod-history-ride-details .ride .ride-wrapper .ride-details{display:flex;justify-content:space-between;flex-wrap:wrap;flex-grow:1}mv-tod-history-ride-details .ride .ride-wrapper .ride-details .ride-details-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}html[dir=ltr] mv-tod-history-ride-details .ride .ride-wrapper .ride-details .ride-details-title{padding-right:12px}html[dir=rtl] mv-tod-history-ride-details .ride .ride-wrapper .ride-details .ride-details-title{padding-left:12px}mv-tod-history-ride-details .ride .ride-wrapper .ride-details .ride-driver{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#515357;margin-top:2px}mv-tod-history-ride-details .address-wrapper{position:relative;display:flex;align-items:center;padding:16px 22px}mv-tod-history-ride-details .address-wrapper:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:22px;width:calc(100% - 44px);z-index:0}mv-tod-history-ride-details .address-wrapper svg-icon{height:24px;width:24px;margin:0}html[dir=ltr] mv-tod-history-ride-details .address-wrapper svg-icon{margin-right:10px}html[dir=rtl] mv-tod-history-ride-details .address-wrapper svg-icon{margin-left:10px}mv-tod-history-ride-details .address-wrapper svg-icon svg path{fill:#525357}mv-tod-history-ride-details .address-wrapper .text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f;flex-grow:1}mv-tod-history-ride-details .address-wrapper .text.to-address{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600;margin-top:6px}mv-tod-history-ride-details .ride-detail-item{position:relative;padding:16px 22px;min-height:56px;box-sizing:border-box;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center}mv-tod-history-ride-details .ride-detail-item:after{bottom:0;background:#ECF0F1;content:"";display:block;height:1px;position:absolute;left:22px;width:calc(100% - 44px);z-index:0}mv-tod-history-ride-details .ride-detail-item>div{display:flex;align-items:center}html[dir=ltr] mv-tod-history-ride-details .ride-detail-item>div .detail-item-icon{margin-right:11px}html[dir=rtl] mv-tod-history-ride-details .ride-detail-item>div .detail-item-icon{margin-left:11px}mv-tod-history-ride-details .ride-detail-item .text{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-tod-history-ride-details .bottom{position:fixed;width:100%;bottom:0;left:0;text-align:center;border-top:1px solid #ECF0F1;padding:16px 22px;background-color:#fff;box-sizing:border-box}mv-tod-history-ride-details .bottom button.button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#0a73eb;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-tod-history-ride-details .bottom button.button{max-width:360px}}mv-tod-history-ride-details .bottom button.button:disabled,mv-tod-history-ride-details .bottom button.button.disabled{background-color:#bdc3c7}mv-tod-history-ride-details .bottom button.button:disabled:active,mv-tod-history-ride-details .bottom button.button.disabled:active{background-color:#bdc3c7}\n'],encapsulation:2}),e})();const ti=["popupContainer"],ni="todItineraryMapElement";let ii=(()=>{class e extends Zt.d{constructor(e,t,n,i,r,o,a,s,l){super(t,o,a,ni,"TodItineraryMap"),this.document=e,this.store=t,this.resolver=n,this.storeHelper=i,this.permissionService=r,this.customerService=o,this.uiActions=a,this.suggestedRoutesService=s,this.routingService=l,this.markers=[],this.locations=[],this.popups=[],this.unsubscribes=[],this.walkToPickup={},this.walkFromDropOff={},this.allPointsOnMap=[]}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){yield this.initLeafletMap(),this.permissionService.requestLocation().then(e=>(0,r.mG)(this,void 0,void 0,function*(){if(e){const e=yield this.permissionService.requestOrientation();this.mapLocation=new Ut.Y(this.map,e)}})),this.document.getElementById(ni).setAttribute("tabindex","-1"),this.drawRoute()})}ngOnChanges(e){const{previousValue:t,currentValue:n}=e.assignment;n!==t&&n&&!e.assignment.isFirstChange()&&this.drawRoute()}ngOnDestroy(){var e;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}isTowLocationsEqual(e,t){return(null==e?void 0:e.latitude)===(null==t?void 0:t.latitude)&&(null==e?void 0:e.longitude)===(null==t?void 0:t.longitude)}drawPolyLine(e){if(!e)return[];const t=Vt.Ry(e),n=L.polyline(t,{color:"#525357",weight:4,opacity:1,lineCap:"round",dashArray:"8,7"}).addTo(this.map);return this.routeLegs.push(n),t}drawFromToPolyline(e,t,n){return(0,r.mG)(this,void 0,void 0,function*(){if(!this.isTowLocationsEqual(e,n.from)||!this.isTowLocationsEqual(t,n.to)){n.from=e,n.to=t;try{const i=yield this.suggestedRoutesService.getWalkPolyline(e,t);(null==i?void 0:i.polyline)&&(n.polyline=i.polyline)}catch(i){}}return(null==n?void 0:n.polyline)?this.drawPolyLine(n.polyline):[]})}refreshSize(){this.map.invalidateSize()}getFromTo(){const{from:e,to:t}=this.state.directions.search;if((null==e?void 0:e.latlng)&&(null==t?void 0:t.latlng))return{from:e,to:t};const n=this.routingService.getStateFromUrl();return n.fromLatLng&&n.toLatLng?{from:{name:n.from,latlng:n.fromLatLng},to:{name:n.to,latlng:n.toLatLng}}:null}fitBounds(){var e,t,n;let i;if(this.allPointsOnMap.length)i=this.allPointsOnMap;else if(null===(e=this.assignment)||void 0===e?void 0:e.journeyInfo){const{origin:e,destination:n,pickup:r,dropoff:o}=null===(t=this.assignment)||void 0===t?void 0:t.journeyInfo;i=[e,r,o,n].filter(e=>null==e?void 0:e.latlon).map(e=>Ht._.fromMvLatLon(e.latlon))}else{const{from:e,to:t}=this.getFromTo();i=[e.latlng,t.latlng]}null===(n=this.map)||void 0===n||n.invalidateSize(),this.fitBoundsByPoints(i)}drawRoute(){this.removeFromToLine(),this.cleanRouteLayers(),this.drawFromTo(),this.drawRouteLegs()}drawFromTo(){const{to:e}=this.getFromTo();this.logger.log("drawFromTo",{to:e,showMarkers:!1}),this.ensureMarker(i.$h.To,e,!1),this.fitBounds()}createMarker(e,t){this.logger.log("createMarker",{fromTo:i.$h.To,location:e,visible:t});const n=[e.latlng.lat,e.latlng.lng],r=L.icon(Object.assign({iconUrl:"images/tod/Destination.svg"},this.markerIconSize())),o=L.marker(n,{icon:r,zIndexOffset:1e3}).addTo(this.map),a=(this.popups[i.$h.To]=this.createPopupComponent()).instance;a.model={title:e.name,description:e.address,imageHtml:e.imageHtml,fromTo:i.$h.To,location:e.latlng},o.bindPopup(a.getElement(),{closeButton:!1,offset:L.point(0,-25)}),this.markers[i.$h.To]=o,t&&o.openPopup()}ensureMarker(e,t,n){return this.logger.log("ensureMarker",{fromTo:e,location:t,visible:n}),t==this.locations[e]?(this.logger.log("Request marker was already created"),!1):(this.removeMarker(e),this.removeFromToLine(),this.locations[e]=t,t&&this.createMarker(t,n),!0)}removeMarker(e){this.logger.log("removeMarker",e);const t=this.markers[e];t&&(this.map.removeLayer(t),this.markers[e]=null);const n=this.popups[e];n&&(n.destroy(),this.popups[e]=null)}createPopupComponent(){const e=this.resolver.resolveComponentFactory(jt.A);return this.popupContainer.createComponent(e)}removeFromToLine(){this.logger.log("removeFromToLine"),this.fromToLine&&(this.map.removeLayer(this.fromToLine),this.fromToLine=null)}drawRouteLegs(){var e;if(!(null===(e=this.assignment)||void 0===e?void 0:e.journeyInfo))return;const{origin:t,pickup:n,dropoff:i,destination:r}=this.assignment.journeyInfo;Promise.all([t&&n?this.drawFromToPolyline(t.latlon,n.latlon,this.walkToPickup):null,i&&r?this.drawFromToPolyline(i.latlon,r.latlon,this.walkFromDropOff):null].filter(e=>e)).then(e=>{this.allPointsOnMap=[],e.forEach(e=>this.allPointsOnMap.push(...e)),this.fitBounds()}),this.createFirstAndLastStationMarker(n||t,!0),this.createFirstAndLastStationMarker(i||r,!1),this.createCurvePath((n||t).latlon,(i||r).latlon)}createCurvePath(e,t){const n=[e.latitude/1e6,e.longitude/1e6],i=[t.latitude/1e6,t.longitude/1e6],r=i[1]-n[1],o=i[0]-n[0],a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),s=Math.atan2(o,r),l=Math.PI/10,c=a/2/Math.cos(l),d=s+l,u=c*Math.cos(d)+n[1],p=[c*Math.sin(d)+n[0],u];this.routeLegs.push(L.curve(["M",n,"Q",p,i],{color:"#292A30",weight:3}).addTo(this.map))}cleanRouteLayers(){this.logger.log("removeRouteLegs"),this.removeLayers(this.routeLegs),this.removeLayers(this.legFirstStationMarkers),this.removeLayers(this.stopMarkers),this.routeLegs=[],this.legFirstStationMarkers=[],this.stopMarkers=[]}markerIconSize(){const e=this.isRetina?30:33,t=this.isRetina?21:24;return{iconSize:[t,e],iconAnchor:[t/2,e]}}createFirstAndLastStationMarker(e,t){const{latlon:n,caption:i}=e;this.logger.log("createFirstAndLastStationMarker",A.kJ.Taxi,n);const r=[n.latitude/1e6,n.longitude/1e6],o=L.icon(Object.assign({iconUrl:t?"images/tod/pickup-point-icon-card-icon-copy.svg":"images/tod/drop-off-poin-card-icon.svg"},this.markerIconSize()));if(this.legFirstStationMarkers.push(L.marker(r,{icon:o}).addTo(this.map)),i){const e=L.divIcon(Object.assign({className:"stop-icon",html:`<div class="tod-map-address">${i}</div>`},this.markerIconSize())),t=L.marker(r,{icon:e,title:i}).addTo(this.map);this.legFirstStationMarkers.push(t)}}get isRetina(){return!1}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(s._Vd),s.Y36(c.N),s.Y36(ne.$),s.Y36(u.v),s.Y36(Gt.V),s.Y36(zt.w),s.Y36(f.Z))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-itinerary-map"]],viewQuery:function(e,t){if(1&e&&s.Gf(ti,7,s.s_b),2&e){let e;s.iGM(e=s.CRH())&&(t.popupContainer=e.first)}},inputs:{assignment:"assignment"},features:[s.qOj,s.TTD],decls:3,vars:0,consts:[["id","todItineraryMapElement",1,"itinerary-map"],[1,"popup-container"],["popupContainer",""]],template:function(e,t){1&e&&(s._UZ(0,"div",0),s._UZ(1,"div",1,2))},styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-itinerary-map{position:relative;flex-grow:1;display:flex;flex-direction:column;z-index:0}mv-tod-itinerary-map .itinerary-map{direction:ltr;flex-grow:1}mv-tod-itinerary-map .itinerary-map .stop-div-icon div{background-color:#edeff3;border:2px solid #292A30;border-radius:5px;box-sizing:border-box;height:10px;width:10px}mv-tod-itinerary-map .itinerary-map .stop-icon .mvf-wrapper{height:36px}mv-tod-itinerary-map mv-map-popup{display:none}mv-tod-itinerary-map .leaflet-popup-content-wrapper mv-map-popup{display:block}mv-tod-itinerary-map .leaflet-control-attribution.leaflet-control{direction:ltr}mv-tod-itinerary-map .leaflet-popup-content{margin:0}mv-tod-itinerary-map .leaflet-popup-content-wrapper{border-radius:4px;overflow:hidden;padding:0}mv-tod-itinerary-map .leaflet-popup-content{width:auto!important}mv-tod-itinerary-map .stop-icon .tod-map-address{position:absolute;top:0;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a30;text-align:center;background-color:#fff;box-shadow:0 1px 4px #00000040;padding:8px 9px 10px 8px;border-radius:24px;max-width:150px;width:-webkit-max-content;width:-moz-max-content;width:max-content}html[dir=ltr] mv-tod-itinerary-map .stop-icon .tod-map-address{left:30px}html[dir=rtl] mv-tod-itinerary-map .stop-icon .tod-map-address{right:30px}\n"],encapsulation:2}),e})();var ri=n(21090);let oi=(()=>{class e{constructor(e,t){this.dialogRef=e,this.analyticsService=t}ngOnInit(){const{numberOfPassengers:e,accessible:t}=this.dialogRef.data;this.numberOfPassengers=e,this.accessible=t,this.analyticsService.sendEvent(d.a.TODOrderScreen,"RIDE_OPTIONS_IMPRESSION",[e,t].join(", "))}get disableSubtractionPassengers(){return this.numberOfPassengers<=1}get disableAddPassengers(){return this.numberOfPassengers>=10}toggleIsAccessible(){this.accessible=!this.accessible}addPassengers(e){this.numberOfPassengers+=e}save(){const{numberOfPassengers:e,accessible:t}=this;this.analyticsService.sendEvent(d.a.TODOrderScreen,"RIDE_OPTIONS_SAVE_CLICKED",[e,t].join(", ")),this.dialogRef.close({numberOfPassengers:e,accessible:t})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(ri.z),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-ride-option"]],decls:30,vars:30,consts:[[1,"title"],[1,"passengers-select"],[1,"text-wrapper"],["src","images/tod/passengers.svg","mvAccessibleSVG","",3,"titleText"],[1,"passengers-modify"],[1,"reduce",3,"click"],["src","images/tod/reduce.svg","mvAccessibleSVG","",3,"titleText"],[1,"passengers-amount"],[1,"add",3,"click"],["src","images/tod/add.svg","mvAccessibleSVG","",3,"titleText"],[1,"accessability-select"],["src","images/tod/icon-accessability.svg","mvAccessibleSVG","",1,"accessability-icon",3,"titleText"],["type","checkbox",1,"accessible-input",3,"checked","click"],[1,"tod-blue-button",3,"click"]],template:function(e,t){1&e&&(s.TgZ(0,"h2",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"div",1),s.TgZ(4,"div",2),s._UZ(5,"svg-icon",3),s.ALo(6,"translate"),s.TgZ(7,"span"),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.qZA(),s.TgZ(10,"div",4),s.TgZ(11,"button",5),s.NdJ("click",function(){return!t.disableSubtractionPassengers&&t.addPassengers(-1)}),s._UZ(12,"svg-icon",6),s.ALo(13,"translate"),s.qZA(),s.TgZ(14,"span",7),s._uU(15),s.qZA(),s.TgZ(16,"button",8),s.NdJ("click",function(){return!t.disableAddPassengers&&t.addPassengers(1)}),s._UZ(17,"svg-icon",9),s.ALo(18,"translate"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(19,"div",10),s.TgZ(20,"div",2),s._UZ(21,"svg-icon",11),s.ALo(22,"translate"),s.TgZ(23,"span"),s._uU(24),s.ALo(25,"translate"),s.qZA(),s.qZA(),s.TgZ(26,"input",12),s.NdJ("click",function(){return t.toggleIsAccessible()}),s.qZA(),s.qZA(),s.TgZ(27,"button",13),s.NdJ("click",function(){return t.save()}),s._uU(28),s.ALo(29,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,14,"tod_passenger_order_setting_title")),s.xp6(4),s.Q6J("titleText",s.lcZ(6,16,"tod_order_setting_passengers")),s.xp6(3),s.Oqu(s.lcZ(9,18,"tod_order_setting_passengers")),s.xp6(3),s.ekj("disable",t.disableSubtractionPassengers),s.xp6(1),s.Q6J("titleText",s.lcZ(13,20,"voiceover_remove_passenger")),s.xp6(3),s.Oqu(t.numberOfPassengers),s.xp6(1),s.ekj("disable",t.disableAddPassengers),s.xp6(1),s.Q6J("titleText",s.lcZ(18,22,"voiceover_add_passenger")),s.xp6(4),s.Q6J("titleText",s.lcZ(22,24,"tod_passenger_ride_details_accessible")),s.xp6(3),s.Oqu(s.lcZ(25,26,"tod_passenger_ride_details_accessible")),s.xp6(2),s.Q6J("checked",t.accessible),s.xp6(2),s.Oqu(s.lcZ(29,28,"action_save")))},directives:[Te.bk,Se.m],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-ride-option{background:#fff;width:100%;border-radius:5px;padding:22px}mv-tod-ride-option .title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:500;margin-top:18px;text-align:center}mv-tod-ride-option .passengers-select,mv-tod-ride-option .accessability-select{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357}mv-tod-ride-option .passengers-select .text-wrapper,mv-tod-ride-option .accessability-select .text-wrapper{display:flex;align-items:center}html[dir=ltr] mv-tod-ride-option .passengers-select .text-wrapper svg-icon,html[dir=ltr] mv-tod-ride-option .accessability-select .text-wrapper svg-icon{margin-right:4px}html[dir=rtl] mv-tod-ride-option .passengers-select .text-wrapper svg-icon,html[dir=rtl] mv-tod-ride-option .accessability-select .text-wrapper svg-icon{margin-left:4px}mv-tod-ride-option .passengers-select{padding:22px 0 16px;border-bottom:1px solid #ECF0F1}mv-tod-ride-option .passengers-select .passengers-modify{display:flex;align-items:center}mv-tod-ride-option .passengers-select .passengers-modify .passengers-amount{font-size:.9411764706rem;color:#292a30;text-align:center;margin:0 11px}mv-tod-ride-option .passengers-select .passengers-modify button{border:1px solid #2196F3;transition:all .3s ease-in-out;border-radius:50%;width:2.1176470588rem;height:2.1176470588rem}mv-tod-ride-option .passengers-select .passengers-modify button svg-icon{position:relative;top:1px}mv-tod-ride-option .passengers-select .passengers-modify button svg path{fill:#2196f3;transition:all .3s ease-in-out}mv-tod-ride-option .passengers-select .passengers-modify button.disable{border-color:#bdc3c7}mv-tod-ride-option .passengers-select .passengers-modify button.disable svg path{fill:#7a7c7f}mv-tod-ride-option .accessability-select{padding:16px 0}mv-tod-ride-option .accessability-select .accessible-input{-webkit-appearance:none;position:relative;width:20px;height:20px;border-radius:2px;border:2px solid #BDC3C7}mv-tod-ride-option .accessability-select .accessible-input:checked{background:#2196F3 url(/images/tod/check.svg) center/24px no-repeat;border:none}html[dir=rtl] mv-tod-ride-option .accessability-select .accessability-icon svg{transform:scaleX(-1)}mv-tod-ride-option .tod-blue-button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#0a73eb;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center;margin-top:19px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-tod-ride-option .tod-blue-button{max-width:360px}}mv-tod-ride-option .tod-blue-button:disabled,mv-tod-ride-option .tod-blue-button.disabled{background-color:#bdc3c7}mv-tod-ride-option .tod-blue-button:disabled:active,mv-tod-ride-option .tod-blue-button.disabled:active{background-color:#bdc3c7}\n"],encapsulation:2}),e})();const ai=function(e){return{param1:e}};let si=(()=>{class e{constructor(e,t,n,i,r,o,a,l,c,d){this.store=e,this.dialogService=t,this.todService=n,this.canonicalService=i,this.routingService=r,this.userActions=o,this.interactionService=a,this.analyticsService=l,this.translateService=c,this.searchActions=d,this.optionChange=new s.vpe}onChangeNumOfPassengersClick(){return(0,r.mG)(this,void 0,void 0,function*(){this.analyticsService.sendEvent(d.a.TODOrderScreen,"CHANGE_RIDE_OPTIONS_CLICKED");const e=this.dialogService.create(oi,{width:"calc(100% - 30px)",maxWidth:"320px",backdropClass:"default-backdrop",data:{numberOfPassengers:this.numberOfPassengers,accessible:this.accessible}});this.closeOptionDialog=e.close;const t=yield e.onClose.toPromise();if(this.closeOptionDialog=null,t&&(this.numberOfPassengers!==t.numberOfPassengers||this.accessible!==t.accessible)){const{numberOfPassengers:e,accessible:n}=t;this.optionChange.emit({numberOfPassengers:e,accessible:n})}})}get title(){return this.isErrorOnPlaceOrder?"action_try_again":this.assignment&&this.assignment.orderMode!==se.pJ.ONLINE?"tod_passenger_order_reserve_button":"tod_order_purchase_button"}get animationDurationStyle(){return`animation-duration: ${this.expirationTime/1e3}s;`}get disableBook(){return this.isLoading||this.isBooking}paymentMethodId(){var e,t;let n=null;const i=null===(e=this.store.getState().user.paymentAccount)||void 0===e?void 0:e.paymentMethods;return(null==i?void 0:i.length)&&(n=null===(t=i[0])||void 0===t?void 0:t.paymentMethodId),n}goToBookedRide(e){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TOD_ACTIVE_RIDE),{todRideId:e,fll:null,tll:null})}goToHomePage(){this.store.dispatch(this.searchActions.setFromOrToText(i.$h.From,"")),this.store.dispatch(this.searchActions.setFromOrToText(i.$h.To,"")),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.TRIPPLAN_DIRECTIONS))}futurePopupAnalytics(e){const t=[this.assignment.assignmentId,this.analyticsService.todMode(se.Rl.FUTURE),this.assignment.taxiProviderId,se.YK[se.Rl.FUTURE]].join(", ");this.analyticsService.sendEvent(d.a.TODPopup,e,t)}book(){var e;return(0,r.mG)(this,void 0,void 0,function*(){const t=this.todService.defaultRideStatus();if(this.analyticsService.sendEvent(d.a.TODOrderScreen,"TOD_PURCHASE_CLICKED",[this.assignment.assignmentId,this.analyticsService.todMode(t),this.assignment.taxiProviderId,null===(e=this.assignment.price)||void 0===e?void 0:e.balance].join(", ")),this.isErrorOnPlaceOrder)this.optionChange.emit({numberOfPassengers:this.numberOfPassengers,accessible:this.accessible});else if(!this.disableBook){this.isBooking=!0;try{const{missingSteps:e,error:t,ride:n}=yield this.todService.bookOrder(this.assignment.rideId,this.assignment.price,this.paymentMethodId());if(this.isBooking=!1,t)throw{error:t};e?this.store.dispatch(this.userActions.handleMissingSteps(e)):n&&(this.assignment.orderMode!==se.pJ.OFFLINE?this.goToBookedRide(n.rideId):(this.futurePopupAnalytics("TOD_RIDE_FUTURE_RESERVATION_IMPRESSION"),this.interactionService.displayWarning(()=>{this.goToBookedRide(n.rideId),this.futurePopupAnalytics("FUTURE_RESERVATION_POPUP_DISMISSED")},this.goToHomePage.bind(this),{title:this.translateService.instant("tod_passenger_order_reserved_successfully_title"),text:this.translateService.instant("tod_passenger_order_reserved_successfully_subtitle"),doButtonText:this.translateService.instant("action_continue"),undoButtonText:"",imageSrc:"images/icons/general-check.svg"},{data:{isWarningMessage:!1,shouldShowCloseIcon:!0}})))}catch(n){this.isBooking=!1;const e=Object.assign({imageSrc:"images/icons/web-warning-x.svg"},null==n?void 0:n.error);this.todService.displayError(n,this.assignment.assignmentId,this.assignment.taxiProviderId,t,this.book.bind(this),void 0,e,{data:{shouldShowCloseIcon:!0}})}}})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(ri.x),s.Y36(ce.F),s.Y36(R.z),s.Y36(f.Z),s.Y36(Be.E),s.Y36(vn.k),s.Y36(d.y),s.Y36(_.sK),s.Y36(h.P))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-itinerary-buttons"]],inputs:{numberOfPassengers:"numberOfPassengers",accessible:"accessible",expirationTime:"expirationTime",isLoading:"isLoading",isErrorOnPlaceOrder:"isErrorOnPlaceOrder",assignment:"assignment"},outputs:{optionChange:"optionChange"},decls:16,vars:23,consts:[[1,"passengers-select"],[1,"text-wrapper"],["src","images/tod/icon-accessability.svg","mvAccessibleSVG","",1,"accessability-icon",3,"titleText"],[1,"tod-blue-link",3,"click"],[1,"row-padding-sides"],[1,"tod-blue-button",3,"click"],[1,"update-bar"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"span"),s._uU(3),s.ALo(4,"translate"),s.qZA(),s._UZ(5,"svg-icon",2),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"button",3),s.NdJ("click",function(){return t.onChangeNumOfPassengersClick()}),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.qZA(),s.TgZ(10,"div",4),s.TgZ(11,"button",5),s.NdJ("click",function(){return t.book()}),s._uU(12),s.ALo(13,"translate"),s._UZ(14,"mv-spinner"),s.qZA(),s.qZA(),s._UZ(15,"div",6)),2&e&&(s.xp6(3),s.Oqu(s.xi3(4,12,"tod_passenger_order_passengers",s.VKq(21,ai,t.numberOfPassengers))),s.xp6(2),s.ekj("active",t.accessible),s.Q6J("titleText",s.lcZ(6,15,"a11y_accessibility_icon")),s.xp6(3),s.Oqu(s.lcZ(9,17,"action_change")),s.xp6(3),s.ekj("disabled",t.disableBook),s.xp6(1),s.hij(" ",s.lcZ(13,19,t.title)," "),s.xp6(3),s.Akn(t.animationDurationStyle),s.ekj("run",!t.disableBook&&!t.isErrorOnPlaceOrder))},directives:[Te.bk,Se.m,mt.O],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-itinerary-buttons{background-color:#fff;box-shadow:0 1px 8px #0003;position:relative;z-index:2;padding-bottom:8px}mv-tod-itinerary-buttons .passengers-select,mv-tod-itinerary-buttons .payment-method{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;margin:0 22px}mv-tod-itinerary-buttons .passengers-select{padding:22px 0;border-bottom:1px solid #ECF0F1}mv-tod-itinerary-buttons .passengers-select .text-wrapper{display:flex;align-items:center}mv-tod-itinerary-buttons .text-wrapper{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}html[dir=ltr] mv-tod-itinerary-buttons .text-wrapper{margin-right:4px}html[dir=rtl] mv-tod-itinerary-buttons .text-wrapper{margin-left:4px}mv-tod-itinerary-buttons .text-wrapper .accessability-icon{width:24px;height:24px;margin:0}html[dir=ltr] mv-tod-itinerary-buttons .text-wrapper .accessability-icon{margin-left:2px}html[dir=rtl] mv-tod-itinerary-buttons .text-wrapper .accessability-icon{margin-right:2px}html[dir=rtl] mv-tod-itinerary-buttons .text-wrapper .accessability-icon svg{transform:scaleX(-1)}mv-tod-itinerary-buttons .text-wrapper .accessability-icon:not(.active) svg path{fill:#bdc3c7}mv-tod-itinerary-buttons .payment-method{padding:16px 0;border-bottom:1px solid #ECF0F1}mv-tod-itinerary-buttons .payment-method .text-wrapper{display:flex;align-items:center}html[dir=ltr] mv-tod-itinerary-buttons .payment-method .payment-icon{margin-right:8px}html[dir=rtl] mv-tod-itinerary-buttons .payment-method .payment-icon{margin-left:8px}mv-tod-itinerary-buttons .tod-blue-link{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#2196f3}mv-tod-itinerary-buttons .tod-blue-button{position:relative;height:2.3529411765rem;font-size:.9411764706rem;color:#fff;font-weight:600;padding:10px 22px;background-color:#0a73eb;border-radius:4px;width:100%;letter-spacing:.0188235294rem;text-align:center;font-size:.8235294118rem;margin:22px 0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-tod-itinerary-buttons .tod-blue-button{max-width:360px}}mv-tod-itinerary-buttons .tod-blue-button:disabled,mv-tod-itinerary-buttons .tod-blue-button.disabled{background-color:#bdc3c7}mv-tod-itinerary-buttons .tod-blue-button:disabled:active,mv-tod-itinerary-buttons .tod-blue-button.disabled:active{background-color:#bdc3c7}mv-tod-itinerary-buttons .tod-blue-button mv-spinner{display:none}mv-tod-itinerary-buttons .tod-blue-button.disabled{color:#292a304d;background-color:#e9e9ea}mv-tod-itinerary-buttons .tod-blue-button.disabled mv-spinner{display:block;position:absolute;margin:auto;inset:0}mv-tod-itinerary-buttons .tod-blue-button.disabled mv-spinner,mv-tod-itinerary-buttons .tod-blue-button.disabled mv-spinner svg{width:34px;height:34px}mv-tod-itinerary-buttons .update-bar{height:5px;width:100%;background-color:#0a73eb;transform:scaleX(0)}html[dir=ltr] mv-tod-itinerary-buttons .update-bar{transform-origin:left}html[dir=rtl] mv-tod-itinerary-buttons .update-bar{transform-origin:right}mv-tod-itinerary-buttons .update-bar.run{-webkit-animation:bar-fill 10s linear infinite;animation:bar-fill 10s linear infinite}mv-tod-itinerary-buttons .button-section{text-align:center}@-webkit-keyframes bar-fill{0%{transform:scaleX(0)}to{transform:scaleX(1)}}@keyframes bar-fill{0%{transform:scaleX(0)}to{transform:scaleX(1)}}\n"],encapsulation:2}),e})();var li=n(803);const ci=function(e){return{param1:e}};function di(e,t){if(1&e&&(s.TgZ(0,"div",11),s.TgZ(1,"span",12),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"span",13),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.qZA()),2&e){const e=s.oxw(2);s.xp6(2),s.AsE("",e.durationMinutes," ",s.lcZ(3,3,"min")," \u2022 "),s.xp6(3),s.hij(" ",s.xi3(6,5,e.isOfflineFutureRide?"tod_passenger_ride_eta_future_approx":"tod_suggested_routes_eta",s.VKq(8,ci,e.rideEndTime))," ")}}function ui(e,t){if(1&e&&(s._UZ(0,"span",14),s.ALo(1,"safeHtml"),s.ALo(2,"async"),s.ALo(3,"asyncify")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,s.lcZ(3,5,e.taxiLogoImage))),s.oJD)}}function pi(e,t){1&e&&(s.TgZ(0,"div",15),s._UZ(1,"svg-icon",16),s.ALo(2,"translate"),s.TgZ(3,"div",17),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e&&(s.xp6(1),s.s9C("titleText",s.lcZ(2,2,"payment_distance")),s.xp6(3),s.Oqu(s.lcZ(5,4,"tod_future_ride_future_details")))}function hi(e,t){if(1&e&&(s.ynx(0),s._UZ(1,"div",1),s.TgZ(2,"div",2),s.TgZ(3,"div",3),s.TgZ(4,"div",4),s.YNc(5,di,7,10,"div",5),s.TgZ(6,"div",6),s._uU(7),s.qZA(),s.qZA(),s.TgZ(8,"div",7),s.YNc(9,ui,4,7,"span",8),s.qZA(),s.qZA(),s.YNc(10,pi,6,6,"div",9),s._UZ(11,"div",10),s.ALo(12,"safeHtml"),s.qZA(),s.BQk()),2&e){const e=s.oxw();s.xp6(2),s.ekj("offline-future-ride",e.isOfflineFutureRide),s.xp6(3),s.Q6J("ngIf",e.durationMinutes),s.xp6(2),s.Oqu(e.price),s.xp6(2),s.Q6J("ngIf",e.taxiLogoImage),s.xp6(1),s.Q6J("ngIf",e.isOfflineFutureRide),s.xp6(1),s.Q6J("innerHTML",s.lcZ(12,7,e.pickupTime),s.oJD)}}let mi=(()=>{class e{constructor(e,t,n,i){this.metroService=e,this.imageService=t,this.store=n,this.translateService=i}ngOnChanges(e){const{currentValue:t,previousValue:n}=e.assignment;if(t===n||!t)return;const{price:i,journeyInfo:r,pickupTime:o,dropoffTime:a,taxiProviderId:s}=t,{pickupWalkingTime:l,destinationWalkingTime:c,pickup:d}=r;if(null==i?void 0:i.balance){const{balance:e,currencySymbol:t}=i;this.price=`${t}${(e/100).toFixed(2)}`}else this.price=this.translateService.instant("tod_free_ride");if(this.pickupFrom=null==d?void 0:d.caption,"number"==typeof a&&"number"==typeof o){this.durationMinutes=Math.round((a-o)/6e4+l+c);const e=C()(a).add(c,"minute");this.rideEndTime=(0,I.a)(e,!0,!1)}const u=this.getTaxiMetaData(s);if(null==u?void 0:u.longImage){const{imageId:e,parameters:t}=u.longImage;this.taxiLogoImage=this.imageService.getImageHTML(e,t)}}get state(){return this.store.getState()}get selectedRoute(){return this.state.itinerary.selectedRoute}get isOfflineFutureRide(){return this.assignment.orderMode===se.pJ.OFFLINE}get isFrgFutureRide(){return this.assignment.orderMode===se.pJ.FRG}getTaxiMetaData(e){var t,n;return e?null===(n=null===(t=this.metroService.state.metro.currentMetro.taxiMetroConfigurations)||void 0===t?void 0:t.find(t=>t.taxiId===e))||void 0===n?void 0:n.metadata:null}get pickupTime(){var e;if(!(null===(e=this.assignment)||void 0===e?void 0:e.pickupTime))return"";const t=C()(this.assignment.pickupTime);return this.isOfflineFutureRide?this.translateService.instant("tod_passenger_order_future_pickup_details",{param1:t.format("L"),param2:t.format("LT")}):this.isFrgFutureRide?`${this.translateService.instant("tod_passenger_ride_real_time_heading_pickup",{param1:t.format("L")})} \u2022 ${this.translateService.instant("tod_passenger_ride_at",{param1:t.format("LT")})}<br/>${this.translateService.instant("tod_passenger_ride_from",{param1:this.pickupFrom})}`:this.translateService.instant("tod_order_pickup_time_address",{param1:`<span>${t.fromNow(!0)}</span>`,param2:this.pickupFrom})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(de.V),s.Y36(ue.KD),s.Y36(l.d),s.Y36(_.sK))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-itinerary-drag-zone"]],inputs:{assignment:"assignment"},features:[s.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[1,"drag-handle"],[1,"ride-pickup-info","row-padding"],[1,"tod-itinerary-drag-top"],[1,"time-and-price"],["class","time",4,"ngIf"],[1,"price"],[1,"provider-logo"],["class","line-image",3,"innerHTML",4,"ngIf"],["class","offine-future-ride-message",4,"ngIf"],[1,"pick-up-text",3,"innerHTML"],[1,"time"],[1,"ride-time"],[1,"eta-time"],[1,"line-image",3,"innerHTML"],[1,"offine-future-ride-message"],["src","images/tod/distance.svg","mvAccessibleSVG","",1,"distance-icon",3,"titleText"],[1,"text"]],template:function(e,t){1&e&&s.YNc(0,hi,13,9,"ng-container",0),2&e&&s.Q6J("ngIf",t.assignment)},directives:[o.O5,Te.bk,Se.m],pipes:[pe.z,_.X$,o.Ov,he.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-itinerary-drag-zone .drag-handle{padding:8px 0 4px}mv-tod-itinerary-drag-zone .drag-handle:before{content:"";display:block;top:.4705882353rem;width:1.8823529412rem;height:.2352941176rem;border-radius:2px;background-color:#bdc3c7;margin:auto}mv-tod-itinerary-drag-zone .drag-handle.hidden:before{visibility:hidden}mv-tod-itinerary-drag-zone .ride-pickup-info{padding-bottom:0}mv-tod-itinerary-drag-zone .ride-pickup-info .time-and-price{display:flex;justify-content:space-between;align-items:center}mv-tod-itinerary-drag-zone .ride-pickup-info .time-and-price .ride-time{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-tod-itinerary-drag-zone .ride-pickup-info .time-and-price .eta-time{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}mv-tod-itinerary-drag-zone .ride-pickup-info .time-and-price .price{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#7a7c7f}mv-tod-itinerary-drag-zone .ride-pickup-info .provider-logo{margin-top:10px}mv-tod-itinerary-drag-zone .ride-pickup-info .provider-logo .mvf-wrapper{height:1.4117647059rem;max-height:1.4117647059rem}mv-tod-itinerary-drag-zone .ride-pickup-info .provider-logo .mvf-wrapper .boxed{border:none}mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a30;border-bottom:1px solid #ECF0F1;padding-bottom:16px;margin-top:15px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:calc(100vw - 44px);transition:border-bottom-color .3s ease-in-out}mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span{position:relative;color:#038844;display:inline-block}html[dir=ltr] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span{margin-left:.5882352941rem}html[dir=rtl] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span{margin-right:.5882352941rem}html[dir=rtl] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:before,html[dir=rtl] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:after{transform:scaleX(-1)}mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:before{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:0;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:before{left:-.3529411765rem}html[dir=rtl] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:before{right:-.3529411765rem}@media (prefers-reduced-motion: reduce){mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:before{-webkit-animation:none;animation:none}}mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:after{border:.1176470588rem solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.9411764706rem;position:absolute;top:-.1764705882rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:after{left:-.5882352941rem}html[dir=rtl] mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:after{right:-.5882352941rem}@media (prefers-reduced-motion: reduce){mv-tod-itinerary-drag-zone .ride-pickup-info .pick-up-text span:after{-webkit-animation:none;animation:none}}mv-tod-itinerary-drag-zone .ride-pickup-info.offline-future-ride .tod-itinerary-drag-top{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;flex-direction:row-reverse}mv-tod-itinerary-drag-zone .ride-pickup-info.offline-future-ride .tod-itinerary-drag-top .provider-logo{margin-top:0}mv-tod-itinerary-drag-zone .offine-future-ride-message{display:flex;padding:11px 12px;border-radius:6px;background-color:#2196f326;margin:16px 0 15px;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357}html[dir=ltr] mv-tod-itinerary-drag-zone .offine-future-ride-message svg-icon{margin-right:11px}html[dir=rtl] mv-tod-itinerary-drag-zone .offine-future-ride-message svg-icon{margin-left:11px}mv-tod-itinerary-drag-zone .offine-future-ride-message svg-icon svg path{fill:#2196f3}mv-tod-itinerary-drag-zone .offine-future-ride-message+.pick-up-text{margin-top:16px}\n'],encapsulation:2}),e})();function gi(e,t){if(1&e&&s._UZ(0,"svg-icon",7),2&e){const e=s.oxw().$implicit;s.Q6J("src",e.icon)("titleText",e.icon)}}function fi(e,t){if(1&e&&(s.TgZ(0,"div",8),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.address)}}const vi=function(e){return{param1:e}};function yi(e,t){if(1&e&&(s.TgZ(0,"div",9),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.hij(" ",s.xi3(2,1,"web_walking_minutes",s.VKq(4,vi,e.walkTimeToNextStep))," ")}}function bi(e,t){if(1&e&&(s.TgZ(0,"div",1),s.YNc(1,gi,1,2,"svg-icon",2),s.TgZ(2,"div",3),s.TgZ(3,"div",4),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.YNc(6,fi,2,1,"div",5),s.YNc(7,yi,3,6,"div",6),s.qZA(),s.qZA()),2&e){const e=t.$implicit;s.ekj("walk",e.walkTimeToNextStep),s.xp6(1),s.Q6J("ngIf",e.icon),s.xp6(3),s.Oqu(s.lcZ(5,6,e.label)),s.xp6(2),s.Q6J("ngIf",e.address),s.xp6(1),s.Q6J("ngIf",e.walkTimeToNextStep)}}let _i=(()=>{class e{constructor(e,t){this.translateService=e,this.store=t}ngOnChanges(e){const{previousValue:t,currentValue:n}=e.assignment;if(n===t||!(null==n?void 0:n.journeyInfo))return;const{from:i,to:r}=this.state.directions.search,{origin:o,pickup:a,dropoff:s,destination:l,pickupWalkingTime:c,destinationWalkingTime:d}=n.journeyInfo;this.steps=[o||i?{label:"tod_passenger_order_origin_label",address:(null==o?void 0:o.caption)||(null==i?void 0:i.name),icon:"images/tod/origin-card-icon.svg",walkTimeToNextStep:c}:null,a?{label:"tod_passenger_order_pickup_label",address:a.caption,icon:"images/tod/pickup-point-icon-card-icon-copy.svg"}:null,s?{label:"tod_passenger_order_dropof_label",address:s.caption,icon:"images/tod/drop-off-poin-card-icon.svg",walkTimeToNextStep:d}:null,l||r?{label:"tod_passenger_order_destination_label",address:(null==l?void 0:l.caption)||(null==r?void 0:r.name),icon:"images/tod/Destination.svg"}:null].filter(e=>e)}get state(){return this.store.getState()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(_.sK),s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-itinerary-list"]],inputs:{assignment:"assignment"},features:[s.TTD],decls:1,vars:1,consts:[["class","step-content",3,"walk",4,"ngFor","ngForOf"],[1,"step-content"],["class","step-image","mvAccessibleSVG","",3,"src","titleText",4,"ngIf"],[1,"content"],[1,"label"],["class","address",4,"ngIf"],["class","label walk-text",4,"ngIf"],["mvAccessibleSVG","",1,"step-image",3,"src","titleText"],[1,"address"],[1,"label","walk-text"]],template:function(e,t){1&e&&s.YNc(0,bi,8,8,"div",0),2&e&&s.Q6J("ngForOf",t.steps)},directives:[o.sg,o.O5,Te.bk,Se.m],pipes:[_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-itinerary-list{display:flex;flex-direction:column}mv-tod-itinerary-list .step-content{position:relative;outline:none;cursor:pointer;display:flex;align-items:center;margin:0 24px 22px;transition:all,.8s}mv-tod-itinerary-list .step-content svg-icon{background:white;padding:5px 0;z-index:9}mv-tod-itinerary-list .step-content:first-of-type{margin:16px 24px 22px}mv-tod-itinerary-list .step-content:first-of-type:after{top:30px}mv-tod-itinerary-list .step-content:last-of-type{margin-bottom:29px}mv-tod-itinerary-list .step-content:last-of-type:after{content:none}mv-tod-itinerary-list .step-content:after{content:"";background:#737578;position:absolute;top:25px;height:calc(100% + 20px);width:1px}html[dir=ltr] mv-tod-itinerary-list .step-content:after{left:7px}html[dir=rtl] mv-tod-itinerary-list .step-content:after{right:7px}html[dir=ltr] mv-tod-itinerary-list .step-content:after{transform:translate(-.2px)}html[dir=rtl] mv-tod-itinerary-list .step-content:after{transform:translate(.2px)}mv-tod-itinerary-list .step-content .label{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#7a7c7f}mv-tod-itinerary-list .step-content .address{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#292a30}mv-tod-itinerary-list .step-content .step-image{margin:0}html[dir=ltr] mv-tod-itinerary-list .step-content .step-image{margin-right:16px}html[dir=rtl] mv-tod-itinerary-list .step-content .step-image{margin-left:16px}html[dir=ltr] mv-tod-itinerary-list .step-content .step-image{transform:translate(.4px)}html[dir=rtl] mv-tod-itinerary-list .step-content .step-image{transform:translate(-.4px)}mv-tod-itinerary-list .step-content .step-image,mv-tod-itinerary-list .step-content .step-image svg{width:14px;height:14px}mv-tod-itinerary-list .step-content .content{min-height:36px}mv-tod-itinerary-list .step-content.walk{padding-bottom:50px;margin-bottom:0}mv-tod-itinerary-list .step-content.walk .walk-text{position:absolute;bottom:20px}mv-tod-itinerary-list .step-content.walk:before{content:"";display:block;background:url(/images/routeTypes/walking.svg) no-repeat center center #fff;background-size:12px;width:20px;height:20px;position:absolute;top:calc(50% + 15px);transform:translateY(-50%);z-index:1}html[dir=ltr] mv-tod-itinerary-list .step-content.walk:before{left:-2px}html[dir=rtl] mv-tod-itinerary-list .step-content.walk:before{right:-2px}html[dir=rtl] mv-tod-itinerary-list .step-content.walk:before{transform:translateY(-50%) scaleX(-1)}mv-tod-itinerary-list .step-content.walk:after{content:"";display:block;background:url(/images/dot.svg) repeat-y;background-size:3px;position:absolute;height:100%;width:4px}html[dir=ltr] mv-tod-itinerary-list .step-content.walk:after{left:5px}html[dir=rtl] mv-tod-itinerary-list .step-content.walk:after{right:5px}html[dir=ltr] mv-tod-itinerary-list .step-content.walk:after{transform:translate(.6px)}html[dir=rtl] mv-tod-itinerary-list .step-content.walk:after{transform:translate(.1px)}mv-tod-itinerary-list .step-content.last-in-multi-leg{margin-bottom:12px}mv-tod-itinerary-list .step-content.last-in-multi-leg:after{display:none}mv-tod-itinerary-list .step-content.first-in-multi-leg.last-in-multi-leg .content,mv-tod-itinerary-list .step-content.last-in-multi-leg .content{border-bottom:none;line-height:1}\n'],encapsulation:2}),e})();const Ti=["todContainer"],Si=["todMap"],xi=["todList"],wi=["dragZone"];function ki(e,t){if(1&e&&s._UZ(0,"mv-tod-itinerary-drag-zone",12),2&e){const e=s.oxw(2);s.ekj("expanded",e.isBottomsheetExpanded),s.Q6J("assignment",e.assignment)}}function Mi(e,t){if(1&e&&s._UZ(0,"mv-tod-itinerary-list",12),2&e){const e=s.oxw(2);s.Q6J("assignment",e.assignment)}}function Li(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",7),s.TgZ(1,"div",8,9),s.TgZ(3,"div",10,11),s._UZ(5,"mv-tod-itinerary-map",12),s.qZA(),s.TgZ(6,"div",13,14),s.YNc(8,ki,1,3,"mv-tod-itinerary-drag-zone",15),s.qZA(),s.TgZ(9,"div",16,17),s.YNc(11,Mi,1,1,"mv-tod-itinerary-list",18),s.qZA(),s.qZA(),s.TgZ(12,"mv-tod-itinerary-buttons",19),s.NdJ("optionChange",function(t){return s.CHM(e),s.oxw().onOptionChange(t)}),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.xp6(3),s.ekj("full-height",!e.splitUtil),s.xp6(2),s.ekj("full-height",!e.splitUtil),s.Q6J("assignment",e.assignment),s.xp6(1),s.ekj("offline-future",e.isOfflineFuture)("online-future",e.isFrgFuture),s.xp6(2),s.Q6J("ngIf",e.assignment),s.xp6(3),s.Q6J("ngIf",e.assignment),s.xp6(1),s.Q6J("isErrorOnPlaceOrder",e.isErrorOnPlaceOrder)("isLoading",e.isLoading)("expirationTime",e.expirationTime)("numberOfPassengers",e.numberOfPassengers)("accessible",e.accessible)("assignment",e.assignment)}}let Ai=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d){this.document=e,this.store=t,this.element=n,this.canonicalService=i,this.routingService=r,this.permissionService=o,this.todService=a,this.dialogService=s,this._cd=l,this.analyticsService=c,this.dataConvertersService=d,this.userLocation=null,this.isBottomsheetExpanded=!0,this.isLoading=!0,this.numberOfPassengers=1,this.accessible=!1,this.data=null,this.isErrorOnPlaceOrder=!1}ngAfterViewInit(){return(0,r.mG)(this,void 0,void 0,function*(){if(yield(0,a.p5)(this.store),!this.todProviderId)return void this.goBack();let e;yield this.setData(),this.analyticsForImpression(),e=this.isOfflineFuture?178:this.isFrgFuture?148:133,this.splitUtil=new gn(this.todContainer,this.todMap,this.todList,e,0);const t=this.splitUtil.convertSizePxToPercent(37);this.split=(0,Bt.Z)([this.todMap.nativeElement,this.todList.nativeElement],{direction:"vertical",sizes:[100-t,t],minSize:[0,5],gutterSize:e,snapOffset:6,onDrag:e=>{this.splitDragUtil.updateSizes(!1,0,this.mapComponent.refreshSize.bind(this.mapComponent)),this.isBottomsheetExpanded=Math.floor(e[1])>5},onDragEnd:()=>{this.mapComponent.refreshSize();const e="tod-itinerary-split-over";this.todMap.nativeElement.offsetHeight<10?this.element.nativeElement.classList.add(e):(this.element.nativeElement.classList.remove(e),this.todList.nativeElement.scrollTo({top:0,behavior:"smooth"}))},gutter:()=>this.dragZone.nativeElement}),this.splitDragUtil=new fn(this.splitUtil,this.split)})}ngOnDestroy(){this.cancelTimeout()}get todProviderId(){return this.routingService.getStateFromUrl().todProviderId}get title(){return this.assignment&&this.assignment.orderMode!==se.pJ.ONLINE?"tod_passenger_order_activity_reservation_title":"tod_passenger_order_activity_title"}get state(){return this.store.getState()}get isMetroReady(){return!!this.state.metro.currentMetro}get assignment(){var e;return(null===(e=this.data)||void 0===e?void 0:e.assignments[0])||null}get isOfflineFuture(){var e;return(null===(e=this.assignment)||void 0===e?void 0:e.orderMode)===se.pJ.OFFLINE}get isFrgFuture(){var e;return(null===(e=this.assignment)||void 0===e?void 0:e.orderMode)===se.pJ.FRG}goBack(){this.cancelTimeout(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["poi",":searchTo",":searchFrom",":locale"]))}cancelTimeout(){this.dataRefreshTimer&&(clearTimeout(this.dataRefreshTimer),this.dataRefreshTimer=null)}setData(){var e;return(0,r.mG)(this,void 0,void 0,function*(){if(this.cancelTimeout(),this._cd.destroyed)return;this.isLoading=!0;try{const{timestamp:e,coords:t}=yield this.permissionService.getLocation({timeout:3e3}),{latitude:n,longitude:i,accuracy:r,altitude:o,speed:a}=t;this.userLocation={latlon:Ht._.toLatLonE6({lat:n,lng:i}),accuracy:r,timestamp:e,altitude:o,speed:a,bearing:90}}catch(o){}const t=this.getFromTo();if(!t)return this.goBack();const{departureOptionType:n,time:i}=this.getTime(),{todProviderId:r}=this.routingService.getStateFromUrl();try{this.data=yield this.todService.placeOrder(t.from.latlng,t.from.name,t.to.latlng,t.to.name,this.userLocation,this.accessible,this.numberOfPassengers,r,i,n)}catch(o){if(this._cd.destroyed)return;this.buttonsComponent.closeOptionDialog&&this.buttonsComponent.closeOptionDialog();const e=Object.assign({imageSrc:"images/icons/web-warning-x.svg"},null==o?void 0:o.error);return this.todService.displayError(o,"404",r,this.todService.defaultRideStatus(),this.setData.bind(this),void 0,e,{data:{shouldShowCloseIcon:!0}}),this.isErrorOnPlaceOrder=!0,void(this.isLoading=!1)}this.isErrorOnPlaceOrder=!1,this.isLoading=!1,this.expirationTime=(null===(e=this.data)||void 0===e?void 0:e.expirationTime)-Date.now()||45e3,this.cancelTimeout(),this.dataRefreshTimer=setTimeout(()=>this.setData(),this.expirationTime)})}getFromTo(){const{from:e,to:t}=this.state.directions.search;if((null==e?void 0:e.latlng)&&(null==t?void 0:t.latlng))return{from:e,to:t};const n=this.routingService.getStateFromUrl();return n.fromLatLng&&n.toLatLng?{from:{name:n.from,latlng:n.fromLatLng},to:{name:n.to,latlng:n.toLatLng}}:null}getTime(){var e,t,n,i;let r,o;if(null===(i=null===(n=null===(t=null===(e=this.state.directions)||void 0===e?void 0:e.search)||void 0===t?void 0:t.tripPlanTime)||void 0===n?void 0:n.day)||void 0===i?void 0:i.date){const{tripPlanTime:e,departureOption:t}=this.state.directions.search;r=C()(e.day.date).startOf("day").add(e.time.timeOfDay,"milliseconds").valueOf(),o=this.dataConvertersService.timeSelectorToTimeType({refPoint:t,when:null})}else{const{time:e,timeType:t}=this.routingService.getStateFromUrl(),n=Object.keys(h.u).find(e=>h.u[e]===t);o=this.dataConvertersService.timeSelectorToTimeType({refPoint:Number(n),when:null}),r=C()(e).add(-this.state.metro.currentMetro.timeZoneOffset,"minute").valueOf()}return{time:r,departureOptionType:o}}onOptionChange({numberOfPassengers:e,accessible:t}){this.numberOfPassengers=e,this.accessible=t,this.setData()}analyticsForImpression(){var e,t;if(!this.assignment)return;const{assignmentId:n,price:i,pickupTime:r,dropoffTime:o,journeyInfo:a}=this.assignment,s=[n,this.analyticsService.todMode(this.todService.defaultRideStatus()),this.assignment.taxiProviderId,null==i?void 0:i.balance,o-r,r,a.origin.caption,a.destination.caption,null===(e=a.pickup)||void 0===e?void 0:e.caption,null===(t=a.dropoff)||void 0===t?void 0:t.caption,a.pickupWalkingTime,a.destinationWalkingTime].join(", ");this.analyticsService.sendEvent(d.a.TODOrderScreen,"TOD_ORDER_IMPRESSION",s)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(s.SBq),s.Y36(R.z),s.Y36(f.Z),s.Y36(ne.$),s.Y36(ce.F),s.Y36(ri.x),s.Y36(s.sBO),s.Y36(d.y),s.Y36(li.J))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-tod-itinerary-split-screens"]],viewQuery:function(e,t){if(1&e&&(s.Gf(ii,5),s.Gf(si,5),s.Gf(Ti,5),s.Gf(Si,5),s.Gf(xi,5),s.Gf(wi,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.mapComponent=e.first),s.iGM(e=s.CRH())&&(t.buttonsComponent=e.first),s.iGM(e=s.CRH())&&(t.todContainer=e.first),s.iGM(e=s.CRH())&&(t.todMap=e.first),s.iGM(e=s.CRH())&&(t.todList=e.first),s.iGM(e=s.CRH())&&(t.dragZone=e.first)}},decls:10,vars:7,consts:[[1,"tod-top-bar"],[1,"back"],["tabindex","0",1,"back-link",3,"click"],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",3,"titleText"],[1,"title"],[1,"options"],["class","split-screens-content",4,"ngIf"],[1,"split-screens-content"],[1,"stops-list"],["todContainer",""],["id","tod-itinerary-map"],["todMap",""],[3,"assignment"],["id","drag-zone",1,"drag-zone"],["dragZone",""],[3,"assignment","expanded",4,"ngIf"],["id","tod-itinerary-main-view"],["todList",""],[3,"assignment",4,"ngIf"],[3,"isErrorOnPlaceOrder","isLoading","expirationTime","numberOfPassengers","accessible","assignment","optionChange"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"a",2),s.NdJ("click",function(){return t.goBack()}),s._UZ(3,"svg-icon",3),s.ALo(4,"translate"),s.qZA(),s.qZA(),s.TgZ(5,"div",4),s._uU(6),s.ALo(7,"translate"),s.qZA(),s._UZ(8,"div",5),s.qZA(),s.YNc(9,Li,13,17,"div",6)),2&e&&(s.xp6(3),s.Q6J("titleText",s.lcZ(4,3,"action_back")),s.xp6(3),s.Oqu(s.lcZ(7,5,t.title)),s.xp6(3),s.Q6J("ngIf",t.isMetroReady&&t.todProviderId))},directives:[Te.bk,Se.m,o.O5,ii,si,mi,_i],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container,mv-tod-itinerary-split-screens,#tod-itinerary-map{transition:top .4s cubic-bezier(.42,0,.3,1.15)}.nearby-split-over .content-container,.nearby-split-over mv-tod-itinerary-split-screens,.nearby-split-over #tod-itinerary-map{transition:top .3s ease}mv-tod-itinerary-split-screens .row-padding{padding:16px 22px}mv-tod-itinerary-split-screens .row-padding-sides{padding:0 22px}mv-tod-itinerary-split-screens.tod-itinerary-split-over .drag-zone{box-shadow:0 1px 4px #00000040}mv-tod-itinerary-split-screens.tod-itinerary-split-over .ride-pickup-info .pick-up-text{border-bottom-color:transparent}mv-tod-itinerary-split-screens.tod-itinerary-split-over #tod-itinerary-main-view{overflow-y:auto;z-index:1}mv-tod-itinerary-split-screens .tod-top-bar{display:flex;align-items:center;background-color:#fff;height:2.8235294118rem;width:100%;box-sizing:border-box;border-bottom:1px solid #c5c7c8}mv-tod-itinerary-split-screens .tod-top-bar .back{min-width:48px}mv-tod-itinerary-split-screens .tod-top-bar .back .back-link{height:1rem;padding:10px 0;display:inline-block}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link{padding-left:16px}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link{padding-right:16px}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link{padding-right:23px}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link{padding-left:23px}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon{transform:scaleX(-1)}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon{transform:scaleX(1)}mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon,mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon svg{width:.5294117647rem;height:1rem}mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon polygon,mv-tod-itinerary-split-screens .tod-top-bar .back .back-link svg-icon svg polygon{fill:#292a30}mv-tod-itinerary-split-screens .tod-top-bar>.title{flex-grow:1;text-align:center}mv-tod-itinerary-split-screens .tod-top-bar .title-wrapper{flex-grow:1;text-align:center}mv-tod-itinerary-split-screens .tod-top-bar .title-wrapper .title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:600}mv-tod-itinerary-split-screens .tod-top-bar .title-wrapper .subtitle{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#292a30;font-weight:400}mv-tod-itinerary-split-screens .tod-top-bar .options{display:flex;height:100%;align-items:center;min-width:48px;box-sizing:border-box}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .options{padding-right:10px}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .options{padding-left:10px}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .options{padding-left:14px}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .options{padding-right:14px}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .options{text-align:right}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .options{text-align:left}mv-tod-itinerary-split-screens .tod-top-bar .options .option{position:absolute;top:100%;right:-22px;padding:12px 22px;z-index:999;background:white;width:180px;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 3px 14px 2px #0000001f,0 8px 10px 1px #00000024;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#001926}html[dir=ltr] mv-tod-itinerary-split-screens .tod-top-bar .options .option{text-align:left}html[dir=rtl] mv-tod-itinerary-split-screens .tod-top-bar .options .option{text-align:right}mv-tod-itinerary-split-screens .split-screens-content{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden;z-index:0;background-color:#f0ebe6}mv-tod-itinerary-split-screens #tod-itinerary-map{display:flex}mv-tod-itinerary-split-screens #tod-itinerary-map.full-height,mv-tod-itinerary-split-screens #tod-itinerary-map .full-height{height:100%}mv-tod-itinerary-split-screens .drag-zone,mv-tod-itinerary-split-screens #tod-itinerary-main-view{position:relative;background-color:#fff;overflow-y:hidden}mv-tod-itinerary-split-screens #tod-itinerary-main-view{z-index:2}mv-tod-itinerary-split-screens #tod-itinerary-main-view:not(.dragging){transition:height .5s cubic-bezier(.37,.05,.3,1)}mv-tod-itinerary-split-screens .drag-zone{height:7.8235294118rem!important;width:100%;padding:0;box-sizing:border-box;z-index:2;transition:box-shadow .4s ease-in-out;border-top-right-radius:8px;border-top-left-radius:8px;box-shadow:0 1px 8px #0003}.nearby-split-over mv-tod-itinerary-split-screens .drag-zone{box-shadow:none}mv-tod-itinerary-split-screens .drag-zone.offline-future{height:10.4705882353rem!important}mv-tod-itinerary-split-screens .drag-zone.online-future{height:8.7058823529rem!important}mv-tod-itinerary-split-screens .stops-list{position:relative;z-index:1}\n"],encapsulation:2}),e})();var Ii=n(86781),Ei=n(85547);function Ci(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",12),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw().selectRoutePriority(t)})("keydown.enter",function(){const t=s.CHM(e).$implicit;return s.oxw().selectRoutePriority(t)}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw();s.ekj("selected",n.isRoutePrioritySelected(e)),s.xp6(1),s.hij(" ",s.lcZ(2,3,e.translationKey)," ")}}function Di(e,t){1&e&&s.GkF(0)}function Pi(e,t){1&e&&s.GkF(0)}function Oi(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"li",2),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw().click(t)})("keydown.enter",function(){const t=s.CHM(e).$implicit;return s.oxw().click(t)}),s.ALo(1,"translate"),s._UZ(2,"span",14),s.ALo(3,"safeHtml"),s.ALo(4,"async"),s.TgZ(5,"span",15),s._uU(6),s.ALo(7,"translate"),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw().isSelected;s.ekj("selected",n(e)),s.uIk("aria-label",s.lcZ(1,5,e.translationKey)),s.xp6(2),s.Q6J("innerHTML",s.lcZ(3,7,s.lcZ(4,9,e.imageHtml)),s.oJD),s.xp6(4),s.Oqu(s.lcZ(7,11,e.translationKey))}}function Ni(e,t){if(1&e&&s.YNc(0,Oi,8,13,"li",13),2&e){const e=t.routes,n=s.oxw();s.Q6J("ngForOf",e)("ngForTrackBy",n.trackByIndex)}}const Ri=function(e,t,n){return{routes:e,click:t,isSelected:n}},$i=(0,Ii.hu)("TripPlanOptionsComponent"),Yi=[{type:A.cd.BestRoute,translationKey:"fastest",imageUrl:"images/best_route.svg"},{type:A.cd.LeastWalking,translationKey:"least_walking",imageUrl:"images/least_walking.svg"},{type:A.cd.LeastTransfers,translationKey:"least_transfers",imageUrl:"images/least_transfers.svg"}];let Fi=(()=>{class e{constructor(e,t,n,i,r,o,a,l){this.store=e,this.imageService=t,this.routingService=n,this.searchActions=i,this.suggestedRoutesActions=r,this.analyticsService=o,this.canonicalService=a,this.translate=l,this.selectedRouteTypesChanged=new s.vpe,this.routeTypes=[],this.routeTransportOptions=[],this.routePriorities=Yi,this.trackByIndex=te.z8}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){yield(0,a.p5)(this.store),this.routeTypes=(0,Ei.n_)(this.state,this.translate,this.imageService),this.routeTransportOptions=Ei.Mx.map(e=>Object.assign(Object.assign({},e),{imageHtml:this.imageService.getImageHTML(e.imageId,void 0,void 0,this.translate.instant(e.translationKey))})),this.originalOptions=(0,te.kI)(this.state.directions.search.searchOptions)})}get state(){return this.store.getState()}get selectedRouteTypes(){return this.state.directions.search.searchOptions.routeTypes}get selectedRoutePriority(){return this.state.directions.search.searchOptions.routePriority}isRoutePrioritySelected(e){return this.selectedRoutePriority==e.type}isRouteTypeSelected(e){return this.selectedRouteTypes[e.type]}isTransportOptionSelected(e){return this.state.directions.search.searchOptions.routeTransportOptions[e.type]}toggleRouteType(e){this.store.dispatch(this.searchActions.toggleSelectedRouteType(e.type))}toggleTransportOption(e){this.store.dispatch(this.searchActions.toggleSelectedTransportOption(e.type))}clearAllRouteTypes(){this.store.dispatch(this.searchActions.clearSelectedRouteTypes())}selectRoutePriority(e){$i.log("selectRoutePriority %O",e),this.store.dispatch(this.searchActions.setRoutePriority(e.type))}goBack(){if(!(0,te.JB)(this.originalOptions,this.state.directions.search.searchOptions)){const e=(0,Ei.A)(this.state);this.analyticsService.trackChangedSearchOptions(this.state.directions.search.searchOptions.routePriority,e||(0,Ei.H$)(this.state).join(",")),this.store.dispatch(this.searchActions.updateURL()),this.store.dispatch(this.suggestedRoutesActions.getSuggestedRoutes())}setTimeout(()=>{this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["poi",":searchTo",":searchFrom",":locale"]))},0)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(ue.KD),s.Y36(f.Z),s.Y36(h.P),s.Y36(O.C),s.Y36(d.y),s.Y36(R.z),s.Y36(_.sK))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-search-options-panel"]],outputs:{selectedRouteTypesChanged:"selectedRouteTypesChanged"},decls:23,vars:26,consts:[[1,"options-btn-container"],[1,"options-title"],["tabindex","0",3,"click","keydown.enter"],[1,"tripplan-options-container"],[1,"select-route-type"],[1,"title"],[1,"priority-wrapper"],["class","priority-option","tabindex","0",3,"selected","click","keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],[1,"select-transit-type"],[1,"transit-types"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routeOption",""],["tabindex","0",1,"priority-option",3,"click","keydown.enter"],["tabindex","0",3,"selected","click","keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],[3,"innerHTML"],[1,"transit-label"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"span",1),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"a",2),s.NdJ("click",function(){return t.goBack()})("keydown.enter",function(){return t.goBack()}),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.qZA(),s.TgZ(7,"div",3),s.TgZ(8,"div",4),s.TgZ(9,"span",5),s._uU(10),s.ALo(11,"translate"),s.qZA(),s.TgZ(12,"div",6),s.YNc(13,Ci,3,5,"div",7),s.qZA(),s.qZA(),s.TgZ(14,"div",8),s.TgZ(15,"span",5),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"ul",9),s.YNc(19,Di,1,0,"ng-container",10),s.YNc(20,Pi,1,0,"ng-container",10),s.qZA(),s.qZA(),s.qZA(),s.YNc(21,Ni,1,2,"ng-template",null,11,s.W1O)),2&e){const e=s.MAs(22);s.xp6(2),s.Oqu(s.lcZ(3,10,"web_trip_plan_options")),s.xp6(3),s.hij(" ",s.lcZ(6,12,"tripplan_rate_done")," "),s.xp6(5),s.Oqu(s.lcZ(11,14,"route_type")),s.xp6(3),s.Q6J("ngForOf",t.routePriorities)("ngForTrackBy",t.trackByIndex),s.xp6(3),s.Oqu(s.lcZ(17,16,"suggest_routes_transit_type_preferred")),s.xp6(3),s.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",s.kEZ(18,Ri,t.routeTypes,t.toggleRouteType.bind(t),t.isRouteTypeSelected.bind(t))),s.xp6(1),s.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",s.kEZ(22,Ri,t.routeTransportOptions,t.toggleTransportOption.bind(t),t.isTransportOptionSelected.bind(t)))}},directives:[o.sg,o.tP],pipes:[_.X$,pe.z,o.Ov],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-search-options-panel{position:relative;background-color:#fff;box-sizing:border-box;opacity:1;overflow:hidden;padding:0;z-index:1000;width:100%}mv-search-options-panel .options-btn-container{box-sizing:border-box;padding:0 20px 10px;text-align:center;background:#292A30;height:54px;width:100%;display:flex;justify-content:space-between;align-items:flex-end}html body.mobile mv-search-options-panel .options-btn-container{top:0px}html.privacy-notice body.mobile mv-search-options-panel .options-btn-container{top:calc(0px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-search-options-panel .options-btn-container{top:calc(0px + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-search-options-panel .options-btn-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-search-options-panel .options-btn-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-search-options-panel .options-btn-container{top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-search-options-panel .options-btn-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-search-options-panel .options-btn-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-search-options-panel .options-btn-container{top:calc(0px + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-search-options-panel .options-btn-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-search-options-panel .options-btn-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-search-options-panel .options-btn-container{top:calc(0px + 60px + 4.7058823529rem)}}body.mobile mv-search-options-panel .options-btn-container{left:0;position:fixed;top:0}mv-search-options-panel .options-btn-container>span{color:#fff;display:inline-block}mv-search-options-panel .options-btn-container a{font-size:.9411764706rem;border:none;color:#0a93ff;display:inline-block;font-weight:700;text-decoration:none;transition:all,.3s;padding:0;-webkit-user-select:none;-moz-user-select:none;user-select:none}mv-search-options-panel .options-btn-container a:hover{color:#0675b3}.tripplan-options-container{box-sizing:border-box;display:block;-webkit-overflow-scrolling:touch;opacity:1;transform-origin:top;height:100%;overflow:auto;width:100%}body.mobile .tripplan-options-container{padding-top:54px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){.tripplan-options-container{display:flex}.tripplan-options-container .select-route-type,.tripplan-options-container .select-transit-type{flex:1}}.tripplan-options-container .select-route-type{margin-bottom:20px}.tripplan-options-container .select-route-type .priority-wrapper{padding:0 20px}.tripplan-options-container .select-route-type .priority-wrapper>div:not(:first-child){margin-top:23px}.tripplan-options-container .select-route-type .priority-wrapper .priority-option{font-size:.9411764706rem;cursor:pointer}.tripplan-options-container .select-route-type .priority-wrapper .priority-option:before{content:"";background:url(/images/selected.svg) no-repeat center;background-size:contain;opacity:0;width:.8235294118rem;height:.8235294118rem;margin-right:15px;display:inline-block;transition:transform ease .28s;transform:scale(0)}.tripplan-options-container .select-route-type .priority-wrapper .priority-option.selected{font-weight:700}.tripplan-options-container .select-route-type .priority-wrapper .priority-option.selected:before{opacity:1;transform:scale(1)}.tripplan-options-container .select-route-type .title{background:#ECF0F1;box-sizing:border-box;display:inline-block;font-size:.7647058824rem;margin-bottom:26px;padding:17px 20px 7px;width:100%}.tripplan-options-container .select-transit-type{margin:23px 0 0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){.tripplan-options-container .select-transit-type{margin-top:0}}.tripplan-options-container .select-transit-type .title{background:#ECF0F1;color:#292a30;display:block;font-size:.7647058824rem;padding:17px 20px 7px}.tripplan-options-container .select-transit-type .transit-types{height:auto;list-style:none;margin:8px 0;padding:0 20px}.tripplan-options-container .select-transit-type .transit-types li{color:#292a30;display:flex;align-items:center;position:relative;cursor:pointer}.tripplan-options-container .select-transit-type .transit-types li:before{border:2px solid #BDC3C7;border-radius:50%;content:"";display:inline-block;height:18px;position:absolute;top:9px;width:18px;transition:all .2s}html[dir=ltr] .tripplan-options-container .select-transit-type .transit-types li:before{right:0}html[dir=rtl] .tripplan-options-container .select-transit-type .transit-types li:before{left:0}.tripplan-options-container .select-transit-type .transit-types li:after{content:"";border:2px solid #fff;border-top-width:0;border-left-width:0;display:block;height:8px;opacity:0;position:absolute;top:14px;width:4px;transform:rotate(45deg) scale(.25);transition:all .2s}html[dir=ltr] .tripplan-options-container .select-transit-type .transit-types li:after{right:8px}html[dir=rtl] .tripplan-options-container .select-transit-type .transit-types li:after{left:8px}.tripplan-options-container .select-transit-type .transit-types li.md-focused{background:none}.tripplan-options-container .select-transit-type .transit-types li.md-focused .mvf-container{opacity:1}.tripplan-options-container .select-transit-type .transit-types li.selected:before{background:#0895E4;border-color:#0895e4;transform:scale(1)}.tripplan-options-container .select-transit-type .transit-types li.selected:after{opacity:1;transform:rotate(45deg) scale(1)}.tripplan-options-container .select-transit-type .transit-types li.selected .mvf-wrapper{opacity:1}.tripplan-options-container .select-transit-type .transit-types li>span{display:table-cell;width:30px}.tripplan-options-container .select-transit-type .transit-types li .transit-label{font-size:.9411764706rem;color:#292a30;line-height:36px;text-align:left;text-align:initial;width:100%;font-weight:500;-webkit-user-select:none;-moz-user-select:none;user-select:none;letter-spacing:.01em}html[dir=ltr] .tripplan-options-container .select-transit-type .transit-types li .transit-label{padding-left:10px;padding-right:30px}html[dir=rtl] .tripplan-options-container .select-transit-type .transit-types li .transit-label{padding-right:10px;padding-left:30px}.tripplan-options-container .select-transit-type .transit-types li .mvf-wrapper{height:24px;margin:0;opacity:.5;vertical-align:middle;width:24px;transition:opacity .3s}\n'],encapsulation:2}),e})();function Bi(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",13),s.NdJ("click",function(t){return s.CHM(e),s.oxw().pickPrevItinerary(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw().pickPrevItinerary(t)}),s.TgZ(1,"span"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.Oqu(s.lcZ(3,1,"itinerary_earlier")))}function Ui(e,t){1&e&&(s.TgZ(0,"span",17),s._uU(1," \u2022 "),s._UZ(2,"svg-icon",18),s.ALo(3,"translate"),s.qZA()),2&e&&(s.xp6(2),s.s9C("titleText",s.lcZ(3,1,"a11y_accessibility_icon")))}function Zi(e,t){if(1&e&&(s.TgZ(0,"div",14),s._UZ(1,"span",15),s.ALo(2,"translate"),s.YNc(3,Ui,4,3,"span",16),s.qZA()),2&e){const e=s.oxw();s.ekj("real-time",e.route.isRelevantForRealTime&&e.route.extra.startFrom.param2),s.xp6(1),s.Q6J("innerHTML",s.xi3(2,4,e.route.extra.startFromTranslateKey,e.route.extra.startFrom),s.oJD),s.xp6(2),s.Q6J("ngIf",e.route.isAccessible)}}function ji(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",19),s.NdJ("click",function(t){return s.CHM(e),s.oxw().pickNextItinerary(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw().pickNextItinerary(t)}),s.TgZ(1,"span"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.Oqu(s.lcZ(3,1,"itinerary_later")))}const Vi=(0,Ii.hu)("ItineraryHeaderComponent");let Hi=(()=>{class e{constructor(e,t,n){this.store=e,this.itineraryActions=t,this.analyticsService=n}ngOnInit(){}pickPrevItinerary(e){Vi.log("navigating to an earlier itinerary"),this.pickItinerary(A.TU.Prev)}pickNextItinerary(e){Vi.log("navigating to a later itinerary"),this.pickItinerary(A.TU.Next)}pickItinerary(e){return(0,r.mG)(this,void 0,void 0,function*(){yield this.store.dispatch(this.itineraryActions.selectSimilarItinerary(e)),this.analyticsService.trackSimilarRouteChanged(e,this.route)})}get minutesParam(){return{param1:this.route.durationMinutes}}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(Fe.L),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-header"]],inputs:{route:"route"},decls:21,vars:14,consts:[[1,"route-summary"],["class","earlier-time","role","button","tabindex","0",3,"click","keydown.enter",4,"ngIf"],[1,"legs-container"],["class","legs-description",3,"real-time",4,"ngIf"],["role","heading","aria-level","2",1,"legs-time"],[1,"start-time"],[1,"dash"],[1,"end-time"],["role","heading","aria-level","3",1,"route-time-summary"],[1,"route-time-container"],[1,"duration"],[1,"destination"],["class","later-time","role","button","tabindex","0",3,"click","keydown.enter",4,"ngIf"],["role","button","tabindex","0",1,"earlier-time",3,"click","keydown.enter"],[1,"legs-description"],[3,"innerHTML"],["class","accessible-route",4,"ngIf"],[1,"accessible-route"],["src","images/wheelchair.svg","mvAccessibleSVG","",3,"titleText"],["role","button","tabindex","0",1,"later-time",3,"click","keydown.enter"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,Bi,4,3,"a",1),s.TgZ(2,"div",2),s.YNc(3,Zi,4,7,"div",3),s.TgZ(4,"div",4),s.TgZ(5,"span",5),s._uU(6),s.ALo(7,"time"),s.qZA(),s.TgZ(8,"span",6),s._uU(9,"-"),s.qZA(),s.TgZ(10,"span",7),s._uU(11),s.ALo(12,"time"),s.qZA(),s.qZA(),s.TgZ(13,"div",8),s.TgZ(14,"div",9),s.TgZ(15,"span",10),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.qZA(),s.TgZ(18,"div",11),s._uU(19),s.qZA(),s.qZA(),s.qZA(),s.YNc(20,ji,4,3,"a",12),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngIf",t.route.hasPrev),s.xp6(2),s.Q6J("ngIf",t.route.extra),s.xp6(3),s.Oqu(s.lcZ(7,7,t.route.startTime)),s.xp6(5),s.Oqu(s.lcZ(12,9,t.route.endTime)),s.xp6(5),s.Oqu(s.xi3(17,11,"units_minutes_text",t.minutesParam)),s.xp6(3),s.Oqu(t.route.to.name),s.xp6(1),s.Q6J("ngIf",t.route.hasNext))},directives:[o.O5,Te.bk,Se.m],pipes:[nt._x,_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-header{background-color:#fff;width:100%;z-index:2}body.mobile mv-itinerary-header{position:fixed}body.desktop mv-itinerary-header{position:-webkit-sticky;position:sticky;top:0;display:block}html body.mobile mv-itinerary-header{top:calc(40px + 4.7058823529rem)}html.privacy-notice body.mobile mv-itinerary-header{top:calc(40px + 4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-itinerary-header{top:calc(40px + 4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 4.7058823529rem)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 4.7058823529rem + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body.mobile mv-itinerary-header{top:calc(40px + 2.4705882353rem)}html.privacy-notice body.mobile mv-itinerary-header{top:calc(40px + 4.7058823529rem + 2.4705882353rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile mv-itinerary-header{top:calc(40px + 4.7058823529rem + 2.4705882353rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body[data-top-banner^=V].mobile:not([class*=c_]) mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 2.4705882353rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 4.7058823529rem + 2.4705882353rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-header{top:calc(100px + 4.7058823529rem + 2.4705882353rem)}}mv-itinerary-header .route-summary{border-bottom:solid 1px #DDDDDD;position:relative;height:3.5294117647rem;min-height:3.5294117647rem}mv-itinerary-header .route-summary .dash{padding:4px 6px}mv-itinerary-header .route-summary .route-time,mv-itinerary-header .route-summary .legs-types,mv-itinerary-header .route-summary .legs-description{display:none}mv-itinerary-header .route-summary .legs-container{border-top:none;display:block;padding:13px 0}html[dir=ltr] mv-itinerary-header .route-summary .legs-container{padding-right:0}html[dir=rtl] mv-itinerary-header .route-summary .legs-container{padding-left:0}mv-itinerary-header .route-summary .legs-time{font-weight:700;text-align:center}mv-itinerary-header .route-summary .route-time-summary{display:flex;margin:0 auto;padding-top:2px;text-align:center;max-width:55%;align-items:center;justify-content:center}mv-itinerary-header .route-summary .route-time-summary .route-time-container{vertical-align:bottom;white-space:nowrap}html[dir=ltr] mv-itinerary-header .route-summary .route-time-summary .route-time-container{padding-right:6px}html[dir=rtl] mv-itinerary-header .route-summary .route-time-summary .route-time-container{padding-left:6px}mv-itinerary-header .route-summary .route-time-summary .route-time-container>.duration,mv-itinerary-header .route-summary .route-time-summary .route-time-container i{font-size:.8235294118rem;font-style:normal}mv-itinerary-header .route-summary .route-time-summary .duration{display:inline;font-size:.8235294118rem;color:#292a30;width:auto;font-weight:500;margin-right:4px}mv-itinerary-header .route-summary .route-time-summary .minutes{display:inline;font-size:.8235294118rem;color:#292a30;text-transform:none}mv-itinerary-header .route-summary .route-time-summary .destination{color:#292a30;display:table-cell;text-transform:none;max-width:42vw;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;vertical-align:bottom;font-size:.8235294118rem}html[dir=ltr] mv-itinerary-header .route-summary .route-time-summary .destination{padding-left:4px}html[dir=rtl] mv-itinerary-header .route-summary .route-time-summary .destination{padding-right:4px}mv-itinerary-header .route-summary .earlier-time,mv-itinerary-header .route-summary .later-time{font-size:.7058823529rem;color:#292a30;text-decoration:none;transition:all .3s}mv-itinerary-header .route-summary .earlier-time{position:absolute;top:50%;transform:translateY(calc(-50% - 1px))}html[dir=ltr] mv-itinerary-header .route-summary .earlier-time{left:0}html[dir=rtl] mv-itinerary-header .route-summary .earlier-time{right:0}html[dir=ltr] mv-itinerary-header .route-summary .earlier-time{padding-left:20px}html[dir=rtl] mv-itinerary-header .route-summary .earlier-time{padding-right:20px}mv-itinerary-header .route-summary .earlier-time:before{content:url(/images/icons/expand_black.svg);display:inline-block;position:relative;top:1px;width:9px;transform:rotate(90deg)}html[dir=rtl] mv-itinerary-header .route-summary .earlier-time:before{transform:rotate(90deg) scale(-1)}mv-itinerary-header .route-summary .later-time{position:absolute;top:50%;transform:translateY(calc(-50% - 1px))}html[dir=ltr] mv-itinerary-header .route-summary .later-time{right:0}html[dir=rtl] mv-itinerary-header .route-summary .later-time{left:0}html[dir=ltr] mv-itinerary-header .route-summary .later-time{padding-right:20px}html[dir=rtl] mv-itinerary-header .route-summary .later-time{padding-left:20px}mv-itinerary-header .route-summary .later-time:after{content:url(/images/icons/expand_black.svg);display:inline-block;position:relative;top:1px;width:9px;transform:rotate(270deg)}html[dir=rtl] mv-itinerary-header .route-summary .later-time:after{transform:rotate(90deg) scaleX(-1)}\n"],encapsulation:2}),e})();const Gi=["routeStepHookContainer"];function zi(e,t){if(1&e&&(s.TgZ(0,"div"),s._UZ(1,"svg-icon",6),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.s9C("titleText",s.lcZ(2,2,e.legTypeIconAltKey)),s.Q6J("src",e.legTypeIcon)}}function qi(e,t){if(1&e&&(s._UZ(0,"div",7),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.stopImage)),s.oJD)}}function Ji(e,t){if(1&e&&(s.TgZ(0,"div",3),s.YNc(1,zi,3,4,"div",4),s.YNc(2,qi,3,5,"div",5),s.qZA()),2&e){const e=s.oxw();s.ekj("no-background",e.isStepType(e.StepType.StartFrom)),s.xp6(1),s.Q6J("ngIf",!e.hasStopIcon),s.xp6(1),s.Q6J("ngIf",e.hasStopIcon)}}function Wi(e,t){if(1&e&&(s.TgZ(0,"div",3),s._UZ(1,"svg-icon",8),s.qZA()),2&e){const e=s.oxw();s.ekj("no-background",e.isStepType(e.StepType.StartFrom))}}function Qi(e,t){if(1&e&&(s.TgZ(0,"span",20),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Oqu(s.lcZ(2,1,e.step.typeDescription))}}function Ki(e,t){1&e&&s._UZ(0,"span",24)}function Xi(e,t){if(1&e&&(s.TgZ(0,"div"),s.YNc(1,Ki,1,0,"span",23),s._uU(2),s.qZA()),2&e){const e=s.oxw(3);s.ekj("rt-update",e.step.isRealTime),s.xp6(1),s.Q6J("ngIf",e.step.isRealTime),s.xp6(1),s.hij(" ",e.stepRealTimeDescription," ")}}function er(e,t){if(1&e&&(s.TgZ(0,"div",21),s.YNc(1,Xi,3,4,"div",22),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Q6J("ngIf",e.shouldShowRTIcon)}}function tr(e,t){1&e&&(s.TgZ(0,"div",32),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"tripplan_itinerary_alt_route_divide_label")," "))}function nr(e,t){if(1&e&&(s._UZ(0,"div",33),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw().$implicit;s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.imageHtmlPromise)),s.oJD)}}function ir(e,t){if(1&e&&(s.TgZ(0,"div",34),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.title)}}function rr(e,t){if(1&e&&(s.TgZ(0,"div",35),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.subTitle)}}function or(e,t){if(1&e&&(s.TgZ(0,"div",25),s.YNc(1,tr,3,3,"div",26),s.TgZ(2,"div",27),s.YNc(3,nr,3,5,"div",28),s.TgZ(4,"div",29),s.YNc(5,ir,2,1,"div",30),s.YNc(6,rr,2,1,"div",31),s.qZA(),s.qZA(),s.qZA()),2&e){const e=t.$implicit,n=t.first,i=s.oxw(2);s.xp6(1),s.Q6J("ngIf",!n),s.xp6(2),s.Q6J("ngIf",i.hasImageIcon),s.xp6(2),s.Q6J("ngIf",e.title),s.xp6(1),s.Q6J("ngIf",e.subTitle)}}function ar(e,t){if(1&e&&(s._UZ(0,"div",33),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw(3);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.stepImageHtml)),s.oJD)}}function sr(e,t){if(1&e&&(s._UZ(0,"span",38),s.ALo(1,"safeHtml")),2&e){const e=s.oxw(3);s.Q6J("innerHTML",s.lcZ(1,1,e.step.title),s.oJD)}}function lr(e,t){if(1&e&&(s._UZ(0,"span",42),s.ALo(1,"safeHtml")),2&e){const e=s.oxw(2).$implicit;s.Q6J("innerHTML",s.lcZ(1,1,e.data),s.oJD)}}function cr(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw(2).$implicit;s.xp6(1),s.Oqu(e.data)}}function dr(e,t){if(1&e&&(s.TgZ(0,"span"),s.YNc(1,lr,2,3,"span",41),s.YNc(2,cr,2,1,"span",4),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Q6J("ngIf",e.isImage),s.xp6(1),s.Q6J("ngIf",!e.isImage)}}function ur(e,t){if(1&e&&(s.ynx(0),s.YNc(1,dr,3,2,"span",4),s.BQk()),2&e){const e=t.$implicit;s.xp6(1),s.Q6J("ngIf",e.data)}}function pr(e,t){if(1&e&&(s.TgZ(0,"span",39),s.YNc(1,ur,2,1,"ng-container",40),s.qZA()),2&e){const e=s.oxw(3);s.xp6(1),s.Q6J("ngForOf",e.step.subTitle)("ngForTrackBy",e.trackByIndex)}}function hr(e,t){if(1&e&&(s.TgZ(0,"div"),s.YNc(1,ar,3,5,"div",28),s.YNc(2,sr,2,3,"span",36),s.YNc(3,pr,2,2,"span",37),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.Q6J("ngIf",e.hasImageIcon),s.xp6(1),s.Q6J("ngIf",e.step.title),s.xp6(1),s.Q6J("ngIf",1===e.step.subTitle.length||1==e.step.leg.altLineIds.length)}}function mr(e,t){if(1&e&&(s.TgZ(0,"span",43),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",e.platform," ")}}function gr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"span",44),s.NdJ("click",function(t){return s.CHM(e),s.oxw(2).onAlertClicked(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw(2).onAlertClicked(t)}),s._uU(1),s.qZA()}if(2&e){const e=s.oxw(2);s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.hij(" ",e.step.alerts.entities[0].title," ")}}function fr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"span",45),s.NdJ("click",function(t){return s.CHM(e),s.oxw(2).onAlertClicked(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw(2).onAlertClicked(t)}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&e){const e=s.oxw(2);s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.hij(" ",s.lcZ(2,2,"tripplan_itinerary_line_alerts_label")," ")}}function vr(e,t){if(1&e&&(s.TgZ(0,"div"),s.TgZ(1,"div",47),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()),2&e){const e=s.oxw(3);s.xp6(1),s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.hij(" ",s.xi3(3,2,"tripplan_itinerary_leave_time",e.leaveTime)," ")}}function yr(e,t){1&e&&(s.TgZ(0,"span"),s._UZ(1,"svg-icon",49),s.qZA())}function br(e,t){1&e&&(s.TgZ(0,"span"),s._UZ(1,"svg-icon",50),s.qZA())}function _r(e,t){if(1&e&&(s.TgZ(0,"li"),s.TgZ(1,"span"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()),2&e){const e=t.$implicit;s.xp6(2),s.AsE("",s.lcZ(3,2,e.instruction_key)," ",e.instruction_param,"")}}function Tr(e,t){if(1&e&&(s.TgZ(0,"div"),s.TgZ(1,"ul",51),s.YNc(2,_r,4,4,"li",40),s.qZA(),s.qZA()),2&e){const e=s.oxw(4);s.xp6(2),s.Q6J("ngForOf",e.step.extra.instructions)("ngForTrackBy",e.trackByIndex)}}function Sr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"a",48),s.NdJ("click",function(t){return s.CHM(e),s.oxw(3).toggleExtra(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw(3).toggleExtra(t)}),s.TgZ(2,"span"),s._uU(3),s.ALo(4,"translate"),s.qZA(),s.TgZ(5,"span"),s._uU(6,"\xa0\u2022\xa0"),s.qZA(),s.TgZ(7,"span"),s._uU(8),s.qZA(),s.YNc(9,yr,2,0,"span",4),s.YNc(10,br,2,0,"span",4),s.qZA(),s.YNc(11,Tr,3,2,"div",4),s.qZA()}if(2&e){const e=s.oxw(3);s.xp6(1),s.Q6J("tabIndex",e.tabIndex),s.xp6(2),s.Oqu(s.xi3(4,6,e.step.extra.distance.distance_key,e.step.extra.distance.distance_number)),s.xp6(5),s.Oqu(e.getMinutesString(e.step.extra.duration)),s.xp6(1),s.Q6J("ngIf",e.isExtraShown),s.xp6(1),s.Q6J("ngIf",!e.isExtraShown),s.xp6(1),s.Q6J("ngIf",e.isExtraShown)}}function xr(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"time"),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.Oqu(s.lcZ(2,1,e.arrivals[0].departure))}}function wr(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"time"),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.hij(", ",s.lcZ(2,1,e.arrivals[1].departure),"")}}function kr(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"time"),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.hij(", ",s.lcZ(2,1,e.arrivals[2].departure),"")}}function Mr(e,t){if(1&e&&(s.TgZ(0,"div"),s.YNc(1,xr,3,3,"span",4),s.YNc(2,wr,3,3,"span",4),s.YNc(3,kr,3,3,"span",4),s.qZA()),2&e){const e=s.oxw(4);s.xp6(1),s.Q6J("ngIf",e.arrivals[0]),s.xp6(1),s.Q6J("ngIf",e.arrivals[1]),s.xp6(1),s.Q6J("ngIf",e.arrivals[2])}}function Lr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div"),s.YNc(1,Mr,4,3,"div",4),s.TgZ(2,"div",52),s.NdJ("click",function(t){return s.CHM(e),s.oxw(3).onStopArrivalsClicked(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw(3).onStopArrivalsClicked(t)}),s.TgZ(3,"a",53),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=s.oxw(3);s.xp6(1),s.Q6J("ngIf",!e.step.isRealTime),s.xp6(2),s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.Oqu(s.lcZ(5,3,e.shouldShowMinimalData?"popup_more_details":"tripplan_itinerary_view_arrivals_label"))}}function Ar(e,t){1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"one_stop")," "))}function Ir(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(4);s.xp6(1),s.hij(" ",s.xi3(2,1,"many_stops",e.getParam(e.step.extra.selectedLine.stations.length-1))," ")}}function Er(e,t){1&e&&(s.TgZ(0,"span"),s._UZ(1,"svg-icon",49),s.qZA())}function Cr(e,t){1&e&&(s.TgZ(0,"span"),s._UZ(1,"svg-icon",50),s.qZA())}function Dr(e,t){if(1&e&&(s.TgZ(0,"div",60),s._uU(1),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.hij(" ",e.selectedLine.title," ")}}function Pr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",61),s.TgZ(1,"a",62),s.NdJ("click",function(t){return s.CHM(e),s.oxw(5).toggleOpenMenuChangeLine(t)}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.qZA()}if(2&e){const e=s.oxw(5);s.xp6(1),s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.hij(" ",s.lcZ(3,2,"change")," ")}}function Or(e,t){if(1&e&&(s.TgZ(0,"div",34),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.title)}}function Nr(e,t){if(1&e&&(s.TgZ(0,"div",35),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.subTitle)}}function Rr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"div",65),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw(6).setSelectedLine(t)}),s._UZ(2,"div",33),s.ALo(3,"safeHtml"),s.ALo(4,"async"),s.TgZ(5,"div",29),s.YNc(6,Or,2,1,"div",30),s.YNc(7,Nr,2,1,"div",31),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit;s.xp6(2),s.Q6J("innerHTML",s.lcZ(3,3,s.lcZ(4,5,e.linePresentation.imageHtmlPromise)),s.oJD),s.xp6(4),s.Q6J("ngIf",e.linePresentation.title),s.xp6(1),s.Q6J("ngIf",e.linePresentation.subTitle)}}function $r(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",63),s.NdJ("click",function(t){return s.CHM(e),s.oxw(5).ignoreClick(t)}),s.YNc(1,Rr,8,7,"div",64),s.qZA()}if(2&e){const e=s.oxw(5);s.ekj("opacity",!e.isChangeLineMenuOpen),s.xp6(1),s.Q6J("ngForOf",e.extraMultiLineData.lines)}}function Yr(e,t){if(1&e&&(s.TgZ(0,"div",34),s._uU(1),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.hij(" ",e.selectedLine.linePresentation.title," ")}}function Fr(e,t){if(1&e&&(s.TgZ(0,"div",35),s._uU(1),s.qZA()),2&e){const e=s.oxw(5);s.xp6(1),s.hij(" ",e.selectedLine.linePresentation.subTitle," ")}}function Br(e,t){if(1&e&&(s.TgZ(0,"li"),s.TgZ(1,"span"),s._uU(2),s.qZA(),s.qZA()),2&e){const e=t.$implicit;s.xp6(2),s.Oqu(e)}}function Ur(e,t){if(1&e&&(s.TgZ(0,"div"),s.TgZ(1,"div",54),s.TgZ(2,"div"),s.TgZ(3,"span"),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.YNc(6,Dr,2,1,"div",55),s.YNc(7,Pr,4,4,"div",56),s.qZA(),s.qZA(),s.YNc(8,$r,2,3,"div",57),s.TgZ(9,"div",58),s._UZ(10,"div",33),s.ALo(11,"safeHtml"),s.ALo(12,"async"),s.TgZ(13,"div",29),s.YNc(14,Yr,2,1,"div",30),s.YNc(15,Fr,2,1,"div",31),s.qZA(),s.qZA(),s.TgZ(16,"ul",59),s.YNc(17,Br,3,1,"li",40),s.qZA(),s.qZA()),2&e){const e=s.oxw(4);s.xp6(4),s.Oqu(s.xi3(5,10,"tripplan_itinerary_stops_list_label",e.getParam(" "))),s.xp6(2),s.Q6J("ngIf",e.step.extra.lines.length>1),s.xp6(1),s.Q6J("ngIf",e.showChangeOption),s.xp6(1),s.Q6J("ngIf",e.showChangeOption),s.xp6(2),s.Q6J("innerHTML",s.lcZ(11,13,s.lcZ(12,15,e.selectedLine.linePresentation.imageHtmlPromise)),s.oJD),s.xp6(4),s.Q6J("ngIf",e.selectedLine.linePresentation.title),s.xp6(1),s.Q6J("ngIf",e.selectedLine.linePresentation.subTitle),s.xp6(1),s.MGl("id","line-",e.selectedLine.lineId,""),s.xp6(1),s.Q6J("ngForOf",e.selectedLine.stations)("ngForTrackBy",e.trackByIndex)}}function Zr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"div",48),s.NdJ("click",function(t){return s.CHM(e),s.oxw(3).toggleExtra(t)})("keydown.enter",function(t){return s.CHM(e),s.oxw(3).toggleExtra(t)}),s.YNc(2,Ar,3,3,"span",4),s.YNc(3,Ir,3,4,"span",4),s.TgZ(4,"span"),s._uU(5,"\xa0\u2022\xa0"),s.qZA(),s.TgZ(6,"span"),s._uU(7),s.qZA(),s.YNc(8,Er,2,0,"span",4),s.YNc(9,Cr,2,0,"span",4),s.qZA(),s.YNc(10,Ur,18,17,"div",4),s.qZA()}if(2&e){const e=s.oxw(3);s.xp6(1),s.Q6J("tabIndex",e.tabIndex),s.xp6(1),s.Q6J("ngIf",2==e.step.extra.selectedLine.stations.length),s.xp6(1),s.Q6J("ngIf",e.step.extra.selectedLine.stations.length>2),s.xp6(4),s.Oqu(e.getMinutesString(e.selectedLine.duration)),s.xp6(1),s.Q6J("ngIf",e.isExtraShown),s.xp6(1),s.Q6J("ngIf",!e.isExtraShown),s.xp6(1),s.Q6J("ngIf",e.isExtraShown)}}function jr(e,t){if(1&e&&(s.TgZ(0,"div",46),s.YNc(1,vr,4,5,"div",4),s.YNc(2,Sr,12,9,"div",4),s.YNc(3,Lr,6,5,"div",4),s.YNc(4,Zr,11,7,"div",4),s.qZA()),2&e){const e=s.oxw(2);s.ekj("details-expanded",e.isExtraShown),s.xp6(1),s.Q6J("ngIf",e.isStepType(e.StepType.StartFrom)),s.xp6(1),s.Q6J("ngIf",e.isStepType(e.StepType.WalkTo)||e.isStepType(e.StepType.BikeRideTo)),s.xp6(1),s.Q6J("ngIf",e.isStepType(e.StepType.WaitFor)),s.xp6(1),s.Q6J("ngIf",e.isStepType(e.StepType.RideTo))}}function Vr(e,t){if(1&e&&(s.TgZ(0,"div",66),s._UZ(1,"svg-icon",67),s.ALo(2,"translate"),s.TgZ(3,"span"),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.s9C("titleText",s.lcZ(2,3,e.congestionData.translationKey)),s.Q6J("src",e.congestionData.iconPath),s.xp6(3),s.Oqu(s.lcZ(5,5,e.congestionData.translationKey))}}function Hr(e,t){if(1&e&&(s.TgZ(0,"div",9),s.TgZ(1,"div",10),s.YNc(2,Qi,3,3,"span",11),s.YNc(3,er,2,1,"div",12),s.qZA(),s.YNc(4,or,7,4,"div",13),s.YNc(5,hr,4,3,"div",4),s.YNc(6,mr,2,1,"span",14),s.YNc(7,gr,2,2,"span",15),s.YNc(8,fr,3,4,"span",16),s.YNc(9,jr,5,6,"div",17),s.YNc(10,Vr,6,7,"div",18),s.GkF(11,null,19),s.qZA()),2&e){const e=s.oxw();s.ekj("has-congestion-data",e.congestionData),s.xp6(2),s.Q6J("ngIf",e.showTypeDescription),s.xp6(1),s.Q6J("ngIf",e.showExtraInfo),s.xp6(1),s.Q6J("ngForOf",e.step.linesPresentation),s.xp6(1),s.Q6J("ngIf",!e.step.linesPresentation),s.xp6(1),s.Q6J("ngIf",1==e.step.leg.altLineIds.length&&e.platform),s.xp6(1),s.Q6J("ngIf",e.canShowAlert&&1==e.step.alerts.entities.length&&e.step.alerts.entities[0].title),s.xp6(1),s.Q6J("ngIf",e.canShowAlert&&e.step.alerts.entities.length>1),s.xp6(1),s.Q6J("ngIf",e.showDetails),s.xp6(1),s.Q6J("ngIf",e.congestionData)}}let Gr=(()=>{class e{constructor(e,t,n,i,r,o,a,l,c){this.store=e,this.translate=t,this.itineraryActions=n,this.hookService=i,this.elementRef=r,this.routingService=o,this.analyticsService=a,this.canonicalService=l,this.imageService=c,this.isLast=!1,this.showAlert=!1,this.showTypeDescription=!1,this.showDetails=!1,this.showTypeIcon=!1,this.showExtraInfo=!1,this.disableTabIndex=!1,this.heightChanged=new s.vpe,this.StepType=A.cF,this.isChangeLineMenuOpen=!1}ngOnInit(){this.isStepType(A.cF.RideTo)&&this.appendInlineStyle(),this.selectedLine=this.extraMultiLineData.selectedLine,this.step.title=this.step.title.replace("#ffffff","#292A30"),this.legTypeIconAltKey=this.getLegTypeIconAltKey()}ngAfterViewInit(){this.hookService.runHooks($e.e.COMPONENT_ROUTE_STEP,this.routeStepHookContainer,this)}ngOnChanges(e){this.stepImageHtml=this.getStepImageHtml()}get state(){return this.store.getState()}get tabIndex(){return this.disableTabIndex?-1:0}get isExtraShown(){return this.step.isExtraShown}get congestionData(){var e;if(this.isStepType(A.cF.WaitFor)){let t;if(this.step.realTimeArrivals&&(t=this.step.realTimeArrivals[0].arrival.vehicleAttributes),!t&&this.step.extra){const n=this.step.extra.arrivals[0].lineId,i=this.step.leg.altLineIds.find(e=>e.waitToLineId==n);t=null===(e=null==i?void 0:i.futureDepartureTimes.futureDepartures[0])||void 0===e?void 0:e.vehicleAttributes}if((null==t?void 0:t.source)===i.iK.PREDICTION)switch(t.level){case i.Yl.EMPTY:case i.Yl.FEW:case i.Yl.LOW:return{translationKey:"crowdedness_line_usually_available_seats",iconPath:"images/congestion/ic_crowded_low.svg"};case i.Yl.MED:case i.Yl.HIGH:return{translationKey:"crowdedness_line_usually_standing_only",iconPath:"images/congestion/ic_crowded_medium.svg"};case i.Yl.FULL:case i.Yl.PACKED:return{translationKey:"crowdedness_line_usually_crowded",iconPath:"images/congestion/ic_crowded_high.svg"}}}}get shouldShowMinimalData(){return!this.state.metro.currentMetro.features||!this.state.metro.currentMetro.features.LINES_MAP_VIEW}get hasStopIcon(){var e,t,n;return!!(null===(n=null===(t=null===(e=this.step.extra)||void 0===e?void 0:e.legImageMetaData)||void 0===t?void 0:t.stopMetaData)||void 0===n?void 0:n.stopImageOnStepHtmlPromise)||this.isStepType(A.cF.WaitFor)}get hasImageIcon(){return this.step.type==A.cF.WaitFor&&this.step.extra&&this.step.extra.legImageMetaData&&this.step.extra.legImageMetaData.lineMetaData&&this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises}get legTypeIcon(){return(0,le.nw)(this.isLast?A.kJ.StartFrom:this.step.legType)}get canShowAlert(){return this.showAlert&&!!this.step.alerts}get stopImage(){return this.step.extra.legImageMetaData.stopMetaData.stopImageOnStepHtmlPromise}get extraData(){return this.step.extra}get extraMultiLineData(){return this.extraData}get showChangeOption(){var e;return(null===(e=this.extraMultiLineData.lines)||void 0===e?void 0:e.length)>1}get extraWaitToMultiLineData(){return this.extraData}getLegTypeIconAltKey(){return(0,le.ID)(this.isLast?A.kJ.StartFrom:this.step.legType,this.state,this.translate,this.imageService)}get platform(){return this.extraWaitToMultiLineData.platforms&&this.extraWaitToMultiLineData.primaryLineId&&this.extraWaitToMultiLineData.platforms[this.extraWaitToMultiLineData.primaryLineId]}get arrivals(){return this.extraWaitToMultiLineData.arrivals}get shouldShowRTIcon(){return this.isStepType(A.cF.WaitFor)&&this.step.isRealTime&&this.stepRealTimeDescription}getStepImageHtml(){return(0,r.mG)(this,void 0,void 0,function*(){return this.step.extra.legImageMetaData&&this.step.extra.legImageMetaData.lineMetaData&&this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises?(yield Promise.all(this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises)).join(" / "):""})}isStepType(e){return this.step&&this.step.type==e}get stepRealTimeDescription(){const e=this.step.extra.duration;return Array.isArray(e)?this.translate.instant("units_minutes_text",{param1:e.join(", ")}):e>0?this.translate.instant("units_minutes_text",{param1:e}):0==e||-1==e?this.translate.instant("now"):null}toggleExtra(e){this.ignoreClick(e),(this.step.type==A.cF.WalkTo||this.step.type==A.cF.BikeRideTo||this.step.type==A.cF.RideTo)&&(this.isChangeLineMenuOpen=!1,this.store.dispatch(this.itineraryActions.toggleExtraData(this.step.index)),this.heightChanged.emit())}onStopArrivalsClicked(e){this.store.dispatch(this.itineraryActions.setSelectedRouteStep(this.step.index));const t=this.routingService.getCurrentRoute().path;this.analyticsService.trackShowRouteStopArrivals(this.step),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],D.zA.TRIPPLAN_STOPARRIVALS),{stepIndex:this.step.index,backTo:t})}getParam(e){if(e)return{param1:e}}appendInlineStyle(){const e=this.step.extra.lines.map(e=>`#line-${e.lineId} li:after,\n                    #line-${e.lineId} li:before{\n                        border-color: ${e.lineColor};\n                    }`).join(""),t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(e)),this.elementRef.nativeElement.appendChild(t)}onAlertClicked(){const e=this.step.alerts.entities.map(e=>e.entityIdentifier.entityType),t=this.step.alerts.entities.map(e=>e.entityIdentifier.id),n=this.step.alerts.entities.map(e=>e.title);this.analyticsService.trackOpenAlertFromStep(n.join(",")),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.ALERTS_SINGLE_VIEW),{etype:e.join(","),eid:t.join(",")})}ignoreClick(e){e.preventDefault(),e.stopPropagation()}setSelectedLine(e){this.isChangeLineMenuOpen=!1,this.selectedLine=e,this.store.dispatch(this.itineraryActions.setSelectedRouteStepLine(this.step.index,e))}getMinutesString(e){return this.translate.instant("units_minutes_text",{param1:e})}get leaveTime(){return{param1:(0,I.xH)(this.step.extra.leaveAt)}}trackByIndex(e,t){return e}toggleOpenMenuChangeLine(e){this.isChangeLineMenuOpen=!this.isChangeLineMenuOpen,this.ignoreClick(e)}onBlurMenu(){this.isChangeLineMenuOpen&&(this.isChangeLineMenuOpen=!1)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(_.sK),s.Y36(Fe.L),s.Y36($e.$),s.Y36(s.SBq),s.Y36(f.Z),s.Y36(d.y),s.Y36(R.z),s.Y36(ue.KD))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-route-step"]],viewQuery:function(e,t){if(1&e&&s.Gf(Gi,5,s.s_b),2&e){let e;s.iGM(e=s.CRH())&&(t.routeStepHookContainer=e.first)}},hostBindings:function(e,t){1&e&&s.NdJ("click",function(){return t.onBlurMenu()},!1,s.evT)},inputs:{step:"step",stepIndex:"stepIndex",isLast:"isLast",showAlert:"showAlert",showTypeDescription:"showTypeDescription",showDetails:"showDetails",showTypeIcon:"showTypeIcon",showExtraInfo:"showExtraInfo",disableTabIndex:"disableTabIndex"},outputs:{heightChanged:"heightChanged"},features:[s.TTD],decls:4,vars:7,consts:[[1,"content-wrapper"],["class","type-icon",3,"no-background",4,"ngIf"],["class","content",3,"has-congestion-data",4,"ngIf"],[1,"type-icon"],[4,"ngIf"],["class","line-image",3,"innerHTML",4,"ngIf"],["mvAccessibleSVG","",1,"legtype-icon",3,"src","titleText"],[1,"line-image",3,"innerHTML"],["src","images/icons/clock-icon.svg"],[1,"content"],[1,"flex-row"],["class","type",4,"ngIf"],["class","extra-info",4,"ngIf"],["class","step-option multi",4,"ngFor","ngForOf"],["class","sub-sub-title",4,"ngIf"],["class","alert",3,"tabIndex","click","keydown.enter",4,"ngIf"],["class","alert multi",3,"tabIndex","click","keydown.enter",4,"ngIf"],["class","details-wrapper",3,"details-expanded",4,"ngIf"],["class","congestion-data",4,"ngIf"],["routeStepHookContainer",""],[1,"type"],[1,"extra-info"],[3,"rt-update",4,"ngIf"],["class","realtime-icon",4,"ngIf"],[1,"realtime-icon"],[1,"step-option","multi"],["class","or",4,"ngIf"],[1,"multi-option"],["class","line-icon",3,"innerHTML",4,"ngIf"],[1,"step-titles-wrapper"],["class","step-title",4,"ngIf"],["class","step-subtitle",4,"ngIf"],[1,"or"],[1,"line-icon",3,"innerHTML"],[1,"step-title"],[1,"step-subtitle"],["class","title",3,"innerHTML",4,"ngIf"],["class","sub-title",4,"ngIf"],[1,"title",3,"innerHTML"],[1,"sub-title"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"sub-sub-title"],[1,"alert",3,"tabIndex","click","keydown.enter"],[1,"alert","multi",3,"tabIndex","click","keydown.enter"],[1,"details-wrapper"],[1,"details-title",3,"tabIndex"],[1,"details-title",3,"tabIndex","click","keydown.enter"],["src","images/icons/collapse_black.svg",1,"toggle-details"],["src","images/icons/expand_black.svg",1,"toggle-details"],[1,"walking-instruction"],[1,"details-title",3,"click","keydown.enter"],[3,"tabIndex"],[1,"details-content"],["class","lines",4,"ngIf"],["class","dropdown-select",4,"ngIf"],["class","lines-selecion",3,"opacity","click",4,"ngIf"],[1,"step-option"],[1,"stations-list",3,"id"],[1,"lines"],[1,"dropdown-select"],[1,"lines-dropdown",3,"tabIndex","click"],[1,"lines-selecion",3,"click"],[4,"ngFor","ngForOf"],[1,"step-option",3,"click"],[1,"congestion-data"],["mvAccessibleSVG","",1,"congestion-icon",3,"src","titleText"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,Ji,3,4,"div",1),s.YNc(2,Wi,2,2,"div",1),s.YNc(3,Hr,13,11,"div",2),s.qZA()),2&e&&(s.ekj("last-in-multi-leg",t.step.isLastInMultiLeg)("first-in-multi-leg",t.step.isFirstInMultiLeg),s.xp6(1),s.Q6J("ngIf",t.showTypeIcon&&!t.isStepType(t.StepType.WaitFor)),s.xp6(1),s.Q6J("ngIf",t.showTypeIcon&&t.isStepType(t.StepType.WaitFor)),s.xp6(1),s.Q6J("ngIf",t.step))},directives:[o.O5,Te.bk,Se.m,o.sg],pipes:[_.X$,pe.z,o.Ov,nt._x],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-route-step{display:block}mv-route-step svg-icon{color:#0000008a}mv-route-step .type{font-size:.8235294118rem;color:#292a30;line-height:1}mv-route-step .step-option{display:flex;align-items:center}html[dir=ltr] mv-route-step .step-option .line-icon{margin-right:8px}html[dir=rtl] mv-route-step .step-option .line-icon{margin-left:8px}mv-route-step .step-option.multi{flex-wrap:wrap}mv-route-step .step-option .or{margin:5px 0;width:100%}mv-route-step .step-option .multi-option{display:flex}mv-route-step .step-option .step-titles-wrapper{display:inline-flex;flex-wrap:wrap;width:100%;align-items:center}mv-route-step .step-option .step-titles-wrapper div:only-child{font-size:.8235294118rem}mv-route-step .step-option .step-titles-wrapper .step-title,mv-route-step .step-option .step-titles-wrapper .subtitle{width:100%}mv-route-step .step-option .step-titles-wrapper .step-title{font-size:.8235294118rem}mv-route-step .step-option .step-titles-wrapper .step-subtitle{font-size:.7647058824rem}mv-route-step .type-icon{text-align:center;width:26px;height:24px;box-sizing:border-box;transition:all,.3s}html[dir=ltr] mv-route-step .type-icon{margin-right:20px}html[dir=rtl] mv-route-step .type-icon{margin-left:20px}mv-route-step .type-icon.no-background{background:none}mv-route-step .type-icon svg-icon{width:auto;height:100%;display:block}mv-route-step .type-icon svg-icon .cls-1{fill:#292a30}mv-route-step .type-icon svg-icon svg{width:24px;height:24px}mv-route-step .type-icon .iconified-transit-line{width:24px}mv-route-step .type-icon .mfv-wrapper{margin:0 auto}mv-route-step .type-icon .line-image .mvf-wrapper.multi-image{top:-3px}html[dir=ltr] mv-route-step .type-icon .line-image .mvf-wrapper.multi-image{right:6px}html[dir=rtl] mv-route-step .type-icon .line-image .mvf-wrapper.multi-image{left:6px}mv-route-step .content-wrapper{position:relative;background:#fff;outline:none;padding:10px 0 0;cursor:pointer;display:flex;transition:all,.8s}html[dir=ltr] mv-route-step .content-wrapper{padding-left:23px}html[dir=rtl] mv-route-step .content-wrapper{padding-right:23px}mv-route-step .content-wrapper:after{content:"";background:#737578;position:absolute;top:45px;height:calc(100% - 45px);width:1px}html[dir=ltr] mv-route-step .content-wrapper:after{left:35px}html[dir=rtl] mv-route-step .content-wrapper:after{right:35px}mv-route-step .content-wrapper.last-in-multi-leg{margin-bottom:12px}mv-route-step .content-wrapper.last-in-multi-leg:after{display:none}mv-route-step .content-wrapper.first-in-multi-leg.last-in-multi-leg .content,mv-route-step .content-wrapper.last-in-multi-leg .content{border-bottom:none;line-height:1}mv-route-step .content{border-bottom:1px solid #C5C8C9;padding-top:8px;flex:1;box-sizing:border-box}html[dir=ltr] mv-route-step .content{text-align:left}html[dir=rtl] mv-route-step .content{text-align:right}mv-route-step .content.has-congestion-data .details-wrapper{padding-bottom:12px}mv-route-step .content .flex-row{justify-content:space-between;-webkit-justify-content:space-between}mv-route-step .line-icon{margin-top:7px;line-height:26px}mv-route-step .line-icon .mvf-wrapper{display:inline-table}mv-route-step .line-icon .mvf-wrapper span{margin-bottom:0}mv-route-step .legtype-icon-wrapper{display:none;margin-bottom:6px;margin-top:2px}mv-route-step .title{display:block;font-size:.9411764706rem;font-weight:bold;line-height:normal;margin-top:8px}html[dir=ltr] mv-route-step .title{padding-right:10px}html[dir=rtl] mv-route-step .title{padding-left:10px}mv-route-step .title>span{color:#737578}mv-route-step .title .seperator{font-weight:400}mv-route-step .sub-title{font-size:.9411764706rem;color:#292a30;line-height:1;padding-top:7px;display:flex;flex-wrap:wrap;align-items:center}html[dir=ltr] mv-route-step .sub-title{padding-right:10px}html[dir=rtl] mv-route-step .sub-title{padding-left:10px}mv-route-step .sub-title>span{text-wrap:none}html[dir=ltr] mv-route-step .sub-title>span{margin-right:4px}html[dir=rtl] mv-route-step .sub-title>span{margin-left:4px}mv-route-step .sub-title>span:last-of-type{margin:0}mv-route-step .sub-title .mvf-wrapper{width:20px}mv-route-step .sub-title .mvf-wrapper .agency img{width:20px}mv-route-step .sub-sub-title{display:block;font-size:.8235294118rem;color:#737578;line-height:1;padding-top:7px}html[dir=ltr] mv-route-step .sub-sub-title{padding-right:10px}html[dir=rtl] mv-route-step .sub-sub-title{padding-left:10px}mv-route-step .details-wrapper{padding:10px 0 17px;line-height:1;font-size:.8235294118rem;color:#737578}html[dir=ltr] mv-route-step .details-wrapper{padding-right:20px}html[dir=rtl] mv-route-step .details-wrapper{padding-left:20px}mv-route-step .details-wrapper .lines-selecion{position:absolute;background-color:#fff;z-index:1;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;border-radius:4px;transition:all .4s cubic-bezier(.25,.8,.25,1);transition-duration:.2s;max-width:70%}html[dir=ltr] mv-route-step .details-wrapper .lines-selecion{right:0}html[dir=rtl] mv-route-step .details-wrapper .lines-selecion{left:0}mv-route-step .details-wrapper .lines-selecion.opacity .step-option{opacity:0}mv-route-step .details-wrapper .lines-selecion .step-option{transition:all .2s ease-in-out .15s;opacity:1}mv-route-step .details-wrapper .lines-selecion>div{padding:10px 16px}mv-route-step .details-wrapper .lines-selecion>div .line-icon{margin-top:0}mv-route-step .details-wrapper [ng-show$=showExtra]{padding-bottom:6px;transition:all,.3s;transform:translateY(10px);opacity:1}mv-route-step .details-wrapper [ng-show$=showExtra].ng-hide{opacity:0;transition:all,.3s;transform:translateY(0)}mv-route-step .details-wrapper span{display:inline-block;margin-bottom:7px;font-size:.8235294118rem}mv-route-step .details-wrapper .lines{position:relative}mv-route-step .details-wrapper .alert{margin:0 0 -8px}html[dir=ltr] mv-route-step .details-wrapper .alert{padding-left:13px}html[dir=rtl] mv-route-step .details-wrapper .alert{padding-right:13px}mv-route-step .details-wrapper .alert:before,mv-route-step .details-wrapper .alert:after{display:none}mv-route-step .congestion-data{padding-bottom:17px}mv-route-step .congestion-data .congestion-icon{width:16px;height:16px;top:1px}html[dir=ltr] mv-route-step .congestion-data .congestion-icon{padding-right:4px}html[dir=rtl] mv-route-step .congestion-data .congestion-icon{padding-left:4px}mv-route-step .extra-info{position:relative;line-height:1;font-size:.8235294118rem;color:#737578}html[dir=ltr] mv-route-step .extra-info{right:20px}html[dir=rtl] mv-route-step .extra-info{left:20px}mv-route-step .extra-info svg-icon{fill:#0f0}mv-route-step .extra-info svg-icon svg{fill:inherit}mv-route-step .extra-info .rt-update{display:block;background:#038844;border-radius:4px;font-weight:700;padding:4px 4px 4px 20px;font-size:.8235294118rem;color:#fff}mv-route-step .extra-info .rt-update .realtime-icon{position:absolute;top:50%;transform:translateY(-50%);left:14px;display:inline-block;width:4px;height:4px;background:none;border-radius:50%}mv-route-step .extra-info .rt-update .realtime-icon:before{content:"";display:block;width:10px;height:10px;border:2px solid transparent;border-left-color:#fff;border-radius:50%;position:absolute;top:-5px;right:-6px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-route-step .extra-info .rt-update .realtime-icon:before{-webkit-animation:none;animation:none}}mv-route-step .extra-info .rt-update .realtime-icon:after{content:"";display:block;width:16px;height:16px;border:2px solid transparent;border-left-color:#fff;border-radius:50%;position:absolute;top:-8px;right:-8px;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-route-step .extra-info .rt-update .realtime-icon:after{-webkit-animation:none;animation:none}}mv-route-step .extra-info .rt-update svg-icon{display:inline-block;position:relative;top:-2px;width:10px;height:10px;margin:0 2px}mv-route-step .extra-info .rt-update svg-icon svg path{fill:#fff}mv-route-step .extra-info .rt-update svg-icon svg path:nth-of-type(2){-webkit-animation:fade-in-out .6s .6s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out .6s .6s infinite linear alternate-reverse;animation-fill-mode:both}mv-route-step .extra-info .rt-update svg-icon svg path:nth-of-type(1){-webkit-animation:fade-in-out .6s 0s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out .6s 0s infinite linear alternate-reverse;animation-fill-mode:both}body.desktop mv-route-step a.details-title{color:#0078d6;text-decoration:underline}body.desktop mv-route-step a.details-title:hover{color:#0675b3}mv-route-step .details-title{-webkit-user-select:none;transition:all,.3s;font-size:.8235294118rem}mv-route-step .details-title:hover{color:#292a30}mv-route-step .details-title a{color:#0078d6;text-decoration:underline}mv-route-step .details-title a:hover{color:#0675b3}mv-route-step .details-title .toggle-details{position:relative;top:-1px;width:.5294117647rem;height:.2352941176rem}html[dir=ltr] mv-route-step .details-title .toggle-details{margin-left:4px}html[dir=rtl] mv-route-step .details-title .toggle-details{margin-right:4px}mv-route-step .details-title .toggle-details .cls-1{fill:#737578;transition:all,.3s}mv-route-step .details-title:hover .toggle-details .cls-1{fill:#292a30}mv-route-step .details-content div{display:flex;justify-content:space-between}mv-route-step .details-content div>span{line-height:1.2}mv-route-step .details-content div a{color:#0895e4;text-decoration:underline;transition:color,.3s;position:relative;z-index:1}html[dir=ltr] mv-route-step .details-content div a{margin-left:5px}html[dir=rtl] mv-route-step .details-content div a{margin-right:5px}mv-route-step .details-content div a:hover{color:#0675b3}mv-route-step .details-content div .dropdown-select{position:relative}mv-route-step .details-content div .dropdown-select a{color:#0895e4;text-decoration:underline;transition:color,.3s;position:relative;z-index:1}mv-route-step .details-content div .dropdown-select a:hover{color:#0675b3}mv-route-step .details-content div .dropdown-select select{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9}html[dir=ltr] mv-route-step .details-content div .dropdown-select select{left:0}html[dir=rtl] mv-route-step .details-content div .dropdown-select select{right:0}mv-route-step .alert{position:relative;display:inline-block;background:#c6522c;border-radius:12px;font-size:.8235294118rem;color:#292a30;color:#fff;height:10px;line-height:10px;margin:10px 0 2px;padding:6px 8px;outline:none;cursor:pointer;transition:all,.3s}html[dir=ltr] mv-route-step .alert{padding-right:18px}html[dir=rtl] mv-route-step .alert{padding-left:18px}mv-route-step .alert.ng-animate{display:none}mv-route-step .alert:before{content:"";background:url(/images/icons/alert-circle.svg) no-repeat;background-size:contain;display:inline-block;width:12px;height:12px;position:relative;top:50%;vertical-align:middle;transform:translateY(-50%)}html[dir=ltr] mv-route-step .alert:before{margin-right:6px}html[dir=rtl] mv-route-step .alert:before{margin-left:6px}html[dir=ltr] mv-route-step .alert:before{left:0}html[dir=rtl] mv-route-step .alert:before{right:0}mv-route-step .alert:after{content:"";background:url(/images/icons/alert-arrow.svg) no-repeat;background-size:contain;width:5px;height:9px;position:absolute;top:50%;transform:translateY(-50%)}html[dir=ltr] mv-route-step .alert:after{right:8px}html[dir=rtl] mv-route-step .alert:after{left:8px}html[dir=rtl] mv-route-step .alert:after{transform:scaleX(-1);top:6px}mv-route-step .alert:hover{background:#f2510c}mv-route-step ul.stations-list,mv-route-step ul.walking-instruction,mv-route-step ul.next-arrivals{margin:8px 0 2px}mv-route-step ul.stations-list li,mv-route-step ul.walking-instruction li,mv-route-step ul.next-arrivals li{line-height:1.3;margin-bottom:5px}mv-route-step ul.walking-instruction,mv-route-step ul.stations-list{list-style:none;margin-bottom:0}mv-route-step ul.walking-instruction li,mv-route-step ul.stations-list li{position:relative;margin-bottom:0;padding-bottom:5px}mv-route-step ul.walking-instruction li:after,mv-route-step ul.stations-list li:after{content:"";display:block;position:absolute;box-sizing:border-box}mv-route-step ul.walking-instruction li:before,mv-route-step ul.stations-list li:before{content:"";position:absolute;border-width:0;border-style:solid;height:100%;width:1px;box-sizing:border-box}mv-route-step ul.walking-instruction li:last-child:before,mv-route-step ul.stations-list li:last-child:before{height:10px}html[dir=ltr] mv-route-step ul.walking-instruction{padding-left:12px}html[dir=rtl] mv-route-step ul.walking-instruction{padding-right:12px}mv-route-step ul.walking-instruction li:after{border-color:#737578;border-style:solid;border-width:1px 0 0 0;height:1px;width:6px;top:7px}html[dir=ltr] mv-route-step ul.walking-instruction li:after{left:-12px}html[dir=rtl] mv-route-step ul.walking-instruction li:after{right:-12px}mv-route-step ul.walking-instruction li:before{border-color:#737578;width:1px;top:-3px}html[dir=ltr] mv-route-step ul.walking-instruction li:before{left:-12px}html[dir=rtl] mv-route-step ul.walking-instruction li:before{right:-12px}html[dir=ltr] mv-route-step ul.walking-instruction li:before{border-left-width:1px}html[dir=rtl] mv-route-step ul.walking-instruction li:before{border-right-width:1px}html[dir=ltr] mv-route-step ul.stations-list{padding-left:13px}html[dir=rtl] mv-route-step ul.stations-list{padding-right:13px}mv-route-step ul.stations-list span{margin-bottom:0}mv-route-step ul.stations-list li{position:relative;padding-bottom:5px}mv-route-step ul.stations-list li:after{position:absolute;border-color:#f0500c;border-style:solid;border-width:1px;border-radius:4px;background-color:#fff;height:8px;width:8px;top:calc(50% - 3px);transform:translateY(-50%)}html[dir=ltr] mv-route-step ul.stations-list li:after{left:-13px}html[dir=rtl] mv-route-step ul.stations-list li:after{right:-13px}mv-route-step ul.stations-list li:before{border-color:#f0500c;width:2px}html[dir=ltr] mv-route-step ul.stations-list li:before{left:-10px}html[dir=rtl] mv-route-step ul.stations-list li:before{right:-10px}html[dir=ltr] mv-route-step ul.stations-list li:before{border-left-width:2px}html[dir=rtl] mv-route-step ul.stations-list li:before{border-right-width:2px}mv-route-step ul.stations-list li:first-child:before{top:8px}mv-route-step .details-subtitle{margin:0 0 7px}mv-route-step .opacity{opacity:0}\n'],encapsulation:2}),e})();function zr(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"section",3),s.NdJ("focus",function(t){return s.CHM(e),s.oxw(2).onRouteStepFocus(t)}),s.TgZ(1,"mv-route-step",4),s.NdJ("click",function(){s.CHM(e);const t=s.oxw(),n=t.index,i=t.$implicit;return s.oxw().selectStep(n,i)}),s.qZA(),s.qZA()}if(2&e){const e=s.oxw(),t=e.index,n=e.$implicit,i=s.oxw();s.ekj("selected",t===i.selectedStepIndex)("walkto",i.isNextStepWalk(t)),s.xp6(1),s.Q6J("step",n)("stepIndex",t)("isLast",t==i.route.steps.length-1)("showAlert",!0)("showTypeDescription",!0)("showDetails",!0)("showTypeIcon",!0)("showExtraInfo",!0)}}function qr(e,t){if(1&e&&(s.ynx(0),s.YNc(1,zr,2,12,"section",2),s.BQk()),2&e){const e=t.$implicit,n=s.oxw();s.xp6(1),s.Q6J("ngIf",n.shouldShowStep(e))}}let Jr=(()=>{class e{constructor(e,t,n){this.store=e,this.itineraryActions=t,this.platformService=n}get state(){return this.store.getState().itinerary}get route(){return this.state.selectedRoute}get selectedStepIndex(){return this.state.selectedStepIndex}selectStep(e,t){this.store.dispatch(this.platformService.isDesktop?this.itineraryActions.selectStepAndNav(e,t):this.itineraryActions.setSelectedRouteStep(e))}shouldShowStep(e){return e.type!==A.cF.WalkToPath}isNextStepWalk(e){var t;return(null===(t=this.route.steps[e+1])||void 0===t?void 0:t.type)==A.cF.WalkTo}trackByStep(e,t){return e}onRouteStepFocus(e){e.target.scrollIntoView({block:"center"})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(Fe.L),s.Y36(y.mi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-list"]],decls:3,vars:2,consts:[[1,"route-details"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","route-step","tabindex","0",3,"selected","walkto","focus",4,"ngIf"],["tabindex","0",1,"route-step",3,"focus"],[3,"step","stepIndex","isLast","showAlert","showTypeDescription","showDetails","showTypeIcon","showExtraInfo","click"]],template:function(e,t){1&e&&(s.TgZ(0,"div"),s.TgZ(1,"div",0),s.YNc(2,qr,2,1,"ng-container",1),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Q6J("ngForOf",t.route.steps)("ngForTrackBy",t.trackByStep))},directives:[o.sg,o.O5,Gr],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-itinerary-list{overflow-y:auto;display:block;height:100%}mv-itinerary-list .route-details{background-color:#ecf0f1;padding-bottom:75px}mv-itinerary-list .route-details .route-step{position:relative}mv-itinerary-list .route-details .route-step:before{content:"";display:block;border:6px solid transparent;position:absolute;opacity:0}html[dir=ltr] mv-itinerary-list .route-details .route-step:before{border-left-color:#292a30}html[dir=rtl] mv-itinerary-list .route-details .route-step:before{border-right-color:#292a30}html[dir=ltr] mv-itinerary-list .route-details .route-step:before{left:-6px}html[dir=rtl] mv-itinerary-list .route-details .route-step:before{right:-6px}mv-itinerary-list .route-details .route-step.selected{padding:0}mv-itinerary-list .route-details .route-step.selected:before{top:16px;z-index:1;transition:all .3s ease-out;opacity:1}html[dir=ltr] mv-itinerary-list .route-details .route-step.selected:before{left:0px}html[dir=rtl] mv-itinerary-list .route-details .route-step.selected:before{right:0px}mv-itinerary-list .route-details .route-step.walkto .content-wrapper{margin-bottom:0}mv-itinerary-list .route-details .route-step.walkto .content-wrapper:before{content:"";display:block;background:url(/images/routeTypes/walking.svg) no-repeat center center #fff;background-size:12px;left:26px;width:20px;height:20px;position:absolute;top:calc(50% + 22px);transform:translateY(-50%);z-index:1}html[dir=rtl] mv-itinerary-list .route-details .route-step.walkto .content-wrapper:before{transform:translateY(-50%) scaleX(-1);right:25px}mv-itinerary-list .route-details .route-step.walkto .content-wrapper:after{content:"";display:block;background:url(/images/dot.svg) repeat-y;background-size:3px;position:absolute;top:45px;height:calc(100% - 45px);width:4px}html[dir=ltr] mv-itinerary-list .route-details .route-step.walkto .content-wrapper:after{left:34px}html[dir=rtl] mv-itinerary-list .route-details .route-step.walkto .content-wrapper:after{right:34px}\n'],encapsulation:2}),e})();var Wr=n(36179);function Qr(e,t){if(1&e&&(s.TgZ(0,"div"),s._UZ(1,"svg-icon",9),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.s9C("titleText",s.lcZ(2,2,e.legTypeIconAltKey)),s.Q6J("src",e.legTypeIcon)}}function Kr(e,t){if(1&e&&(s._UZ(0,"div",10),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw(2);s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.stopImage)),s.oJD)}}function Xr(e,t){if(1&e&&(s.TgZ(0,"div",6),s.YNc(1,Qr,3,4,"div",7),s.YNc(2,Kr,3,5,"div",8),s.qZA()),2&e){const e=s.oxw();s.ekj("no-background",e.isStepType(e.StepType.StartFrom)),s.xp6(1),s.Q6J("ngIf",!e.stopImage),s.xp6(1),s.Q6J("ngIf",e.stopImage)}}function eo(e,t){if(1&e&&(s._UZ(0,"div",11),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw();s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,e.stepImageHtml)),s.oJD)}}let to=(()=>{class e{constructor(e,t,n,i,r,o){this.deepLinkService=e,this.analyticsService=t,this.globalActions=n,this.store=i,this.translate=r,this.imageService=o,this.isLast=!1,this.StepType=A.cF}get state(){return this.store.getState()}ngOnInit(){this.legTypeIconAltKey=this.getLegTypeIconAltKey()}ngOnChanges(e){this.stepImageHtml=this.getStepImageHtml()}getStepImageHtml(){return(0,r.mG)(this,void 0,void 0,function*(){return this.step.extra.legImageMetaData&&this.step.extra.legImageMetaData.lineMetaData&&this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises?(yield Promise.all(this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises)).join(" / "):""})}getLegTypeIconAltKey(){return(0,le.ID)(this.isLast?A.kJ.StartFrom:this.step.legType,this.state,this.translate,this.imageService)}get legTypeIcon(){return(0,le.nw)(this.isLast?A.kJ.StartFrom:this.step.legType)}get stopImageConfig(){return this.step.extra.legImageMetaData.stopMetaData.stopImageConfig}get stopImage(){var e,t,n;return null===(n=null===(t=null===(e=this.step.extra)||void 0===e?void 0:e.legImageMetaData)||void 0===t?void 0:t.stopMetaData)||void 0===n?void 0:n.stopImageOnStepHtmlPromise}isStepType(e){return this.step&&this.step.type===e}get hasImageIcon(){return this.step.type===A.cF.WaitFor&&this.step.extra&&this.step.extra.legImageMetaData&&this.step.extra.legImageMetaData.lineMetaData&&this.step.extra.legImageMetaData.lineMetaData.stepImageHtmlPromises}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(re.Qz),s.Y36(d.y),s.Y36(Ee.l),s.Y36(l.d),s.Y36(_.sK),s.Y36(ue.KD))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-banner-step"]],inputs:{step:"step",isLast:"isLast"},features:[s.TTD],decls:10,vars:8,consts:[[1,"itinerary-mvf-wrapper"],["class","type-icon",3,"no-background",4,"ngIf"],["class","line-icon",3,"innerHTML",4,"ngIf"],[1,"itinerary-transit-text"],[1,"type"],[1,"itinerary-text",3,"innerHTML"],[1,"type-icon"],[4,"ngIf"],["class","line-image",3,"innerHTML",4,"ngIf"],["mvAccessibleSVG","",1,"legtype-icon",3,"src","titleText"],[1,"line-image",3,"innerHTML"],[1,"line-icon",3,"innerHTML"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,Xr,3,4,"div",1),s.YNc(2,eo,3,5,"div",2),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5),s.ALo(6,"translate"),s.qZA(),s._uU(7,"\xa0"),s._UZ(8,"span",5),s.ALo(9,"safeHtml"),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngIf",!t.isStepType(t.StepType.WaitFor)),s.xp6(1),s.Q6J("ngIf",t.hasImageIcon),s.xp6(3),s.Oqu(s.lcZ(6,4,t.step.typeDescription)),s.xp6(3),s.Q6J("innerHTML",s.lcZ(9,6,t.step.title),s.oJD))},directives:[o.O5,Te.bk,Se.m],pipes:[_.X$,pe.z,o.Ov],encapsulation:2}),e})();function no(e,t){if(1&e&&(s.ynx(0),s._UZ(1,"mv-itinerary-banner-step",17),s.BQk()),2&e){const e=t.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("step",e)("isLast",n.index==n.bannerSteps.length-1)}}function io(e,t){1&e&&s._UZ(0,"span",18),2&e&&s.Q6J("ngClass","gray-dot step-"+(t.index+1))}function ro(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",3),s.TgZ(1,"a",4),s.NdJ("click",function(){return s.CHM(e),s.oxw().onBannerClick()}),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"a",5),s.NdJ("click",function(){return s.CHM(e),s.oxw().onBannerClick()}),s.ALo(4,"translate"),s.qZA(),s.TgZ(5,"div",6),s.TgZ(6,"div",7),s.YNc(7,no,2,2,"ng-container",8),s.qZA(),s.qZA(),s.TgZ(8,"div",9),s._uU(9),s.ALo(10,"translate"),s.qZA(),s.TgZ(11,"div",10),s._UZ(12,"svg-icon",11),s.TgZ(13,"div",12),s.YNc(14,io,1,1,"span",13),s.qZA(),s.qZA(),s.TgZ(15,"div",14),s._UZ(16,"svg-icon",15),s._UZ(17,"svg-icon",16),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.uIk("data-steps",e.bannerSteps.length),s.xp6(1),s.Q6J("href",e.bannerUrl,s.LSH)("innerHtml",s.lcZ(2,9,"web_trip_plan_download_moovit"),s.oJD),s.xp6(2),s.Q6J("href",e.bannerUrl,s.LSH)("innerHtml",s.lcZ(4,11,"web_download_button"),s.oJD),s.xp6(4),s.Q6J("ngForOf",e.bannerSteps)("ngForTrackBy",e.trackByStep),s.xp6(2),s.Oqu(s.lcZ(10,13,"direction_banner_sentence2_test")),s.xp6(5),s.Q6J("ngForOf",e.bannerSteps)}}let oo=(()=>{class e{constructor(e,t,n,i,r){this.deepLinkService=e,this.analyticsService=t,this.globalActions=n,this.universal=i,this.store=r}get state(){return this.store.getState()}ngOnInit(){this.universal.isBrowser&&(0,a.p5)(this.store).then(()=>{this.updateBannerUrl(),(0,a.wZ)().then(()=>this.updateBannerUrl())})}ngOnChanges(e){this.route&&this.route.steps&&(this.bannerSteps=this.route.steps.filter(e=>e.type!==A.cF.WalkToPath).slice(0,5))}updateBannerUrl(){this.bannerUrl=this.deepLinkService.getStoreOrDeepLink("LiveDirections","LiveDirections",this.deepLinkService.getDeepLinkType())}onBannerClick(){this.analyticsService.trackStoreClick("LiveDirections")}hide(){this.store.dispatch(this.globalActions.hideItineraryMobileAppCta()),this.analyticsService.trackUserEvent("Minimize_directions_banner2",(0,Wr.gn)()?"Apple":"Google")}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(re.Qz),s.Y36(d.y),s.Y36(Ee.l),s.Y36(v.p),s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-mobile-app-cta"]],inputs:{route:"route"},features:[s.TTD],decls:4,vars:4,consts:[[1,"minimize-wrapper"],[1,"minimize-btn",3,"click"],["class","ani-route",4,"ngIf"],[1,"ani-route"],[1,"route-cta",3,"href","innerHtml","click"],[1,"route-cta-minimized",3,"href","innerHtml","click"],[1,"itinerary-text-wrapper"],[1,"steps-text"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"last-text"],[1,"route-wrapper"],["src","images/banners/animated-route-dot.svg",1,"route-dot"],[1,"route-path"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"curved-route-wrapper"],["src","images/banners/animated-route-dot.svg",1,"driver-dot"],["src","images/banners/curved-route.svg",1,"curved-route-svg"],[3,"step","isLast"],[3,"ngClass"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"button",1),s.NdJ("click",function(){return t.hide()}),s.ALo(2,"translate"),s.qZA(),s.qZA(),s.YNc(3,ro,18,15,"div",2)),2&e&&(s.xp6(1),s.uIk("aria-label",s.lcZ(2,2,"a11y_minimize_banner")),s.xp6(2),s.Q6J("ngIf",t.route))},directives:[o.O5,o.sg,Te.bk,to,o.mk],pipes:[_.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-mobile-app-cta .route-wrapper{display:none}mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] .steps-text{-webkit-animation:curved-text-5-steps-switch 11.5s ease-in-out forwards infinite;animation:curved-text-5-steps-switch 11.5s ease-in-out forwards infinite}@-webkit-keyframes curved-text-5-steps-switch{0%{transform:translateY(0)}39.1304347826%{transform:translateY(0)}47.8260869565%{transform:translateY(-54px)}52.1739130435%{transform:translateY(-54px)}60.8695652174%{transform:translateY(-108px)}65.2173913043%{transform:translateY(-108px)}73.9130434783%{transform:translateY(-162px)}78.2608695652%{transform:translateY(-162px)}88.6956521739%{transform:translateY(-216px)}to{transform:translateY(-216px)}}@keyframes curved-text-5-steps-switch{0%{transform:translateY(0)}39.1304347826%{transform:translateY(0)}47.8260869565%{transform:translateY(-54px)}52.1739130435%{transform:translateY(-54px)}60.8695652174%{transform:translateY(-108px)}65.2173913043%{transform:translateY(-108px)}73.9130434783%{transform:translateY(-162px)}78.2608695652%{transform:translateY(-162px)}88.6956521739%{transform:translateY(-216px)}to{transform:translateY(-216px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] .curved-route-wrapper .driver-dot{-webkit-animation:curved-route-5-dot 11.5s ease-in-out forwards infinite,curved-route-5-wrapper 11.5s ease-in-out forwards infinite;animation:curved-route-5-dot 11.5s ease-in-out forwards infinite,curved-route-5-wrapper 11.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-5-dot{0%{transform:translate(32px,2px)}39.1304347826%{transform:translate(32px,2px)}47.8260869565%{transform:translate(45px,31px)}52.1739130435%{transform:translate(45px,31px)}60.8695652174%{transform:translate(114px,10px)}65.2173913043%{transform:translate(114px,10px)}73.9130434783%{transform:translate(124px,36px)}78.2608695652%{transform:translate(124px,36px)}83.4782608696%{transform:translate(175px,19px)}86.0869565217%{transform:translate(172px,7px)}88.6956521739%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}@keyframes curved-route-5-dot{0%{transform:translate(32px,2px)}39.1304347826%{transform:translate(32px,2px)}47.8260869565%{transform:translate(45px,31px)}52.1739130435%{transform:translate(45px,31px)}60.8695652174%{transform:translate(114px,10px)}65.2173913043%{transform:translate(114px,10px)}73.9130434783%{transform:translate(124px,36px)}78.2608695652%{transform:translate(124px,36px)}83.4782608696%{transform:translate(175px,19px)}86.0869565217%{transform:translate(172px,7px)}88.6956521739%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] .curved-route-wrapper svg-icon,mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] .itinerary-text-wrapper{-webkit-animation:curved-route-5-wrapper 11.5s ease-in-out forwards infinite;animation:curved-route-5-wrapper 11.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-5-wrapper{0%{opacity:0}26.0869565217%{opacity:0}30.4347826087%{opacity:1}95.652173913%{opacity:1}to{opacity:0}to{opacity:0}}@keyframes curved-route-5-wrapper{0%{opacity:0}26.0869565217%{opacity:0}30.4347826087%{opacity:1}95.652173913%{opacity:1}to{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] .last-text{-webkit-animation:curved-last-text-5-steps 11.5s ease-in-out forwards infinite;animation:curved-last-text-5-steps 11.5s ease-in-out forwards infinite}@-webkit-keyframes curved-last-text-5-steps{0%{opacity:0}4.347826087%{opacity:1}17.3913043478%{opacity:1}21.7391304348%{opacity:0}to{opacity:0}}@keyframes curved-last-text-5-steps{0%{opacity:0}4.347826087%{opacity:1}17.3913043478%{opacity:1}21.7391304348%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="5"] svg-icon.curved-route-svg svg circle.step-5{display:block}mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] .steps-text{-webkit-animation:curved-text-4-steps-switch 10.5s ease-in-out forwards infinite;animation:curved-text-4-steps-switch 10.5s ease-in-out forwards infinite}@-webkit-keyframes curved-text-4-steps-switch{0%{transform:translateY(0)}42.8571428571%{transform:translateY(0)}52.380952381%{transform:translateY(-54px)}57.1428571429%{transform:translateY(-54px)}66.6666666667%{transform:translateY(-108px)}71.4285714286%{transform:translateY(-108px)}87.619047619%{transform:translateY(-162px)}to{transform:translateY(-162px)}}@keyframes curved-text-4-steps-switch{0%{transform:translateY(0)}42.8571428571%{transform:translateY(0)}52.380952381%{transform:translateY(-54px)}57.1428571429%{transform:translateY(-54px)}66.6666666667%{transform:translateY(-108px)}71.4285714286%{transform:translateY(-108px)}87.619047619%{transform:translateY(-162px)}to{transform:translateY(-162px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] .curved-route-wrapper .driver-dot{-webkit-animation:curved-route-4-dot 10.5s ease-in-out forwards infinite,curved-route-4-wrapper 10.5s ease-in-out forwards infinite;animation:curved-route-4-dot 10.5s ease-in-out forwards infinite,curved-route-4-wrapper 10.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-4-dot{0%{transform:translate(32px,2px)}42.8571428571%{transform:translate(32px,2px)}52.380952381%{transform:translate(45px,31px)}57.1428571429%{transform:translate(45px,31px)}66.6666666667%{transform:translate(114px,10px)}71.4285714286%{transform:translate(114px,10px)}76.1904761905%{transform:translate(124px,36px)}81.9047619048%{transform:translate(175px,19px)}84.7619047619%{transform:translate(172px,7px)}87.619047619%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}@keyframes curved-route-4-dot{0%{transform:translate(32px,2px)}42.8571428571%{transform:translate(32px,2px)}52.380952381%{transform:translate(45px,31px)}57.1428571429%{transform:translate(45px,31px)}66.6666666667%{transform:translate(114px,10px)}71.4285714286%{transform:translate(114px,10px)}76.1904761905%{transform:translate(124px,36px)}81.9047619048%{transform:translate(175px,19px)}84.7619047619%{transform:translate(172px,7px)}87.619047619%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] .curved-route-wrapper svg-icon,mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] .itinerary-text-wrapper{-webkit-animation:curved-route-4-wrapper 10.5s ease-in-out forwards infinite;animation:curved-route-4-wrapper 10.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-4-wrapper{0%{opacity:0}28.5714285714%{opacity:0}33.3333333333%{opacity:1}97.619047619%{opacity:1}102.380952381%{opacity:0}to{opacity:0}}@keyframes curved-route-4-wrapper{0%{opacity:0}28.5714285714%{opacity:0}33.3333333333%{opacity:1}97.619047619%{opacity:1}102.380952381%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] .last-text{-webkit-animation:curved-last-text-4-steps 10.5s ease-in-out forwards infinite;animation:curved-last-text-4-steps 10.5s ease-in-out forwards infinite}@-webkit-keyframes curved-last-text-4-steps{0%{opacity:0}4.7619047619%{opacity:1}19.0476190476%{opacity:1}23.8095238095%{opacity:0}to{opacity:0}}@keyframes curved-last-text-4-steps{0%{opacity:0}4.7619047619%{opacity:1}19.0476190476%{opacity:1}23.8095238095%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="4"] svg-icon.curved-route-svg svg circle.step-4{display:block}mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] .steps-text{-webkit-animation:curved-text-3-steps-switch 9.5s ease-in-out forwards infinite;animation:curved-text-3-steps-switch 9.5s ease-in-out forwards infinite}@-webkit-keyframes curved-text-3-steps-switch{0%{transform:translateY(0)}47.3684210526%{transform:translateY(0)}63.1578947368%{transform:translateY(-54px)}68.4210526316%{transform:translateY(-54px)}89.4736842105%{transform:translateY(-108px)}to{transform:translateY(-108px)}}@keyframes curved-text-3-steps-switch{0%{transform:translateY(0)}47.3684210526%{transform:translateY(0)}63.1578947368%{transform:translateY(-54px)}68.4210526316%{transform:translateY(-54px)}89.4736842105%{transform:translateY(-108px)}to{transform:translateY(-108px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] .curved-route-wrapper .driver-dot{-webkit-animation:curved-route-3-dot 9.5s ease-in-out forwards infinite,curved-route-3-wrapper 9.5s ease-in-out forwards infinite;animation:curved-route-3-dot 9.5s ease-in-out forwards infinite,curved-route-3-wrapper 9.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-3-dot{0%{transform:translate(32px,2px)}47.3684210526%{transform:translate(32px,2px)}52.6315789474%{transform:translate(45px,31px)}63.1578947368%{transform:translate(114px,10px)}68.4210526316%{transform:translate(114px,10px)}73.6842105263%{transform:translate(124px,36px)}80%{transform:translate(175px,19px)}83.1578947368%{transform:translate(172px,7px)}86.3157894737%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}@keyframes curved-route-3-dot{0%{transform:translate(32px,2px)}47.3684210526%{transform:translate(32px,2px)}52.6315789474%{transform:translate(45px,31px)}63.1578947368%{transform:translate(114px,10px)}68.4210526316%{transform:translate(114px,10px)}73.6842105263%{transform:translate(124px,36px)}80%{transform:translate(175px,19px)}83.1578947368%{transform:translate(172px,7px)}86.3157894737%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] .curved-route-wrapper svg-icon,mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] .itinerary-text-wrapper{-webkit-animation:curved-route-3-wrapper 9.5s ease-in-out forwards infinite;animation:curved-route-3-wrapper 9.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-3-wrapper{0%{opacity:0}31.5789473684%{opacity:0}36.8421052632%{opacity:1}97.3684210526%{opacity:1}102.6315789474%{opacity:0}to{opacity:0}}@keyframes curved-route-3-wrapper{0%{opacity:0}31.5789473684%{opacity:0}36.8421052632%{opacity:1}97.3684210526%{opacity:1}102.6315789474%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] .last-text{-webkit-animation:curved-last-text-3-steps 9.5s ease-in-out forwards infinite;animation:curved-last-text-3-steps 9.5s ease-in-out forwards infinite}@-webkit-keyframes curved-last-text-3-steps{0%{opacity:0}5.2631578947%{opacity:1}21.0526315789%{opacity:1}26.3157894737%{opacity:0}to{opacity:0}}@keyframes curved-last-text-3-steps{0%{opacity:0}5.2631578947%{opacity:1}21.0526315789%{opacity:1}26.3157894737%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="3"] svg-icon.curved-route-svg svg circle.step-3{display:block}mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] .steps-text{-webkit-animation:curved-text-2-steps-switch 8.5s ease-in-out forwards infinite;animation:curved-text-2-steps-switch 8.5s ease-in-out forwards infinite}@-webkit-keyframes curved-text-2-steps-switch{0%{transform:translateY(0)}51.7647058824%{transform:translateY(0)}76.4705882353%{transform:translateY(-54px)}to{transform:translateY(-54px)}}@keyframes curved-text-2-steps-switch{0%{transform:translateY(0)}51.7647058824%{transform:translateY(0)}76.4705882353%{transform:translateY(-54px)}to{transform:translateY(-54px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] .curved-route-wrapper .driver-dot{-webkit-animation:curved-route-2-dot 8.5s ease-in-out forwards infinite,curved-route-2-wrapper 8.5s ease-in-out forwards infinite;animation:curved-route-2-dot 8.5s ease-in-out forwards infinite,curved-route-2-wrapper 8.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-2-dot{0%{transform:translate(32px,2px)}45.8823529412%{transform:translate(32px,2px)}51.7647058824%{transform:translate(45px,31px)}61.1764705882%{transform:translate(114px,10px)}68.2352941176%{transform:translate(124px,36px)}72.9411764706%{transform:translate(175px,19px)}77.6470588235%{transform:translate(172px,7px)}82.3529411765%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}@keyframes curved-route-2-dot{0%{transform:translate(32px,2px)}45.8823529412%{transform:translate(32px,2px)}51.7647058824%{transform:translate(45px,31px)}61.1764705882%{transform:translate(114px,10px)}68.2352941176%{transform:translate(124px,36px)}72.9411764706%{transform:translate(175px,19px)}77.6470588235%{transform:translate(172px,7px)}82.3529411765%{transform:translate(188px,1px)}to{transform:translate(188px,1px)}}mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] .curved-route-wrapper svg-icon,mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] .itinerary-text-wrapper{-webkit-animation:curved-route-2-wrapper 8.5s ease-in-out forwards infinite;animation:curved-route-2-wrapper 8.5s ease-in-out forwards infinite}@-webkit-keyframes curved-route-2-wrapper{0%{opacity:0}35.2941176471%{opacity:0}41.1764705882%{opacity:1}97.0588235294%{opacity:1}102.9411764706%{opacity:0}to{opacity:0}}@keyframes curved-route-2-wrapper{0%{opacity:0}35.2941176471%{opacity:0}41.1764705882%{opacity:1}97.0588235294%{opacity:1}102.9411764706%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] .last-text{-webkit-animation:curved-last-text-2-steps 8.5s ease-in-out forwards infinite;animation:curved-last-text-2-steps 8.5s ease-in-out forwards infinite}@-webkit-keyframes curved-last-text-2-steps{0%{opacity:0}5.8823529412%{opacity:1}23.5294117647%{opacity:1}29.4117647059%{opacity:0}to{opacity:0}}@keyframes curved-last-text-2-steps{0%{opacity:0}5.8823529412%{opacity:1}23.5294117647%{opacity:1}29.4117647059%{opacity:0}to{opacity:0}}mv-itinerary-mobile-app-cta .ani-route[data-steps="2"] svg-icon.curved-route-svg svg circle.step-2{display:block}mv-itinerary-mobile-app-cta{bottom:0;left:0;opacity:1;position:fixed;width:100%;z-index:9;transition:transform .3s ease-out;background:#fcfeff;background:linear-gradient(180deg,#daf4fc 0%,#fcfeff 100%);border-top:2px solid #d8d8d8}mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn:before{background-color:#003550;transition:.25s ease .1s}mv-itinerary-mobile-app-cta .itinerary-text-wrapper{position:relative;overflow-y:hidden;height:54px;-webkit-mask-image:-webkit-gradient(linear,left 25%,left 0,from(black),to(rgba(255,255,255,0)));top:7px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .itinerary-text-wrapper{max-width:29%;height:60px;top:0}}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step{width:50%;height:54px;font-weight:600;display:flex;align-items:center;flex-wrap:wrap;-webkit-mask-image:linear-gradient(to left,transparent 0%,black 8%);mask-image:linear-gradient(to left,transparent 0%,black 8%)}html[dir=ltr] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step{text-align:left}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step{text-align:right}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step{-webkit-mask-image:linear-gradient(to right,transparent 0%,black 8%);mask-image:linear-gradient(to right,transparent 0%,black 8%)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step{width:100%;justify-content:flex-start}}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step>.itinerary-mvf-wrapper{display:table-cell;vertical-align:middle}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step>.itinerary-transit-text{display:flex;flex-wrap:wrap}html[dir=ltr] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step:not(:first-of-type) .itinerary-mvf-wrapper{padding-right:5px}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step:not(:first-of-type) .itinerary-mvf-wrapper{padding-left:5px}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper{text-align:left}html[dir=ltr] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper{text-align:right}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .line-icon{display:inline-flex;align-items:center}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .line-icon>*{margin:0 5px}html[dir=ltr] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .line-icon>*:first-of-type{margin-left:0}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .line-icon>*:first-of-type{margin-right:0}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .type-icon svg#walking-svg{width:15px;height:24px}html[dir=rtl] mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-mvf-wrapper .type-icon svg#walking-svg{transform:scaleX(-1)}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-transit-text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-height:1.8823529412rem;line-height:.9411764706rem;max-width:calc(100% - 32px)}mv-itinerary-mobile-app-cta .itinerary-text-wrapper mv-itinerary-banner-step .itinerary-transit-text .itinerary-text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}mv-itinerary-mobile-app-cta .route-cta-minimized{display:block;font-size:.7647058824rem;color:#f0500c;text-align:center;text-decoration:none;font-weight:600;position:absolute;z-index:-9;opacity:0;transition:.5s ease-out .1s;visibility:hidden}mv-itinerary-mobile-app-cta .route-cta{background-color:#f06334;padding:10px 30px;display:inline-block;font-weight:600;color:#fff;box-shadow:0 2px 3px #0003;border-radius:4px;text-decoration:none;position:relative;z-index:9;width:auto;margin:23px auto;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .route-cta{margin:5px 0;max-width:20%}}mv-itinerary-mobile-app-cta .curved-route-wrapper{background:no-repeat url(/images/banners/side-map-curved-bg.svg) center/cover;height:100%;width:50%;right:0;position:absolute;display:flex;align-items:flex-end;justify-content:flex-end;top:-62px;background-position:-42px 40px;pointer-events:none}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .curved-route-wrapper{margin:auto;width:30%;left:0;background-position:-17px -42px;top:0}}html[dir=rtl] mv-itinerary-mobile-app-cta .curved-route-wrapper{transform:scaleX(-1);right:unset;left:0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html[dir=rtl] mv-itinerary-mobile-app-cta .curved-route-wrapper{right:0}}mv-itinerary-mobile-app-cta .curved-route-wrapper svg-icon.curved-route-svg{width:196px;height:51px;margin:6px auto 25px;position:absolute;top:64px;right:6px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .curved-route-wrapper svg-icon.curved-route-svg{top:0;right:14px}}html[dir=rtl] mv-itinerary-mobile-app-cta .curved-route-wrapper svg-icon.curved-route-svg{right:-3px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html[dir=rtl] mv-itinerary-mobile-app-cta .curved-route-wrapper svg-icon.curved-route-svg{right:15px}}mv-itinerary-mobile-app-cta .curved-route-wrapper svg-icon.curved-route-svg svg{width:205px;height:54px}mv-itinerary-mobile-app-cta .curved-route-wrapper .driver-dot{width:15px;height:15px;top:71px;right:201px;position:absolute;z-index:9}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .curved-route-wrapper .driver-dot{top:5px}html[dir=ltr] mv-itinerary-mobile-app-cta .curved-route-wrapper .driver-dot{right:212px}html[dir=rtl] mv-itinerary-mobile-app-cta .curved-route-wrapper .driver-dot{right:220px}}mv-itinerary-mobile-app-cta .curved-route-wrapper .driver-dot svg{width:15px;height:15px;position:absolute;top:0;left:0}mv-itinerary-mobile-app-cta .ani-route{position:relative;z-index:999;padding:0 20px;text-align:center;display:flex;flex-direction:column-reverse}html[dir=ltr] mv-itinerary-mobile-app-cta .ani-route{text-align:left}html[dir=rtl] mv-itinerary-mobile-app-cta .ani-route{text-align:right}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .ani-route{display:flex;align-items:center;flex-direction:row-reverse;justify-content:space-between;top:-10px}}mv-itinerary-mobile-app-cta .ani-route .cover-link{display:block;text-decoration:none;color:inherit;width:100%;height:100%;top:0;position:absolute;left:0;z-index:99;outline:none}mv-itinerary-mobile-app-cta .ani-route .cover-link:focus+.route-cta{outline:solid 2px #302E2E}mv-itinerary-mobile-app-cta .ani-route svg-icon.curved-route-svg svg circle{display:none}mv-itinerary-mobile-app-cta .last-text{z-index:9;position:absolute;line-height:1.0588235294rem;height:2.1176470588rem;display:flex;justify-content:center;align-items:center;margin:auto;left:0;right:0;font-size:.9411764706rem;padding:0 25px;font-weight:700;top:17px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta .last-text{padding:0;justify-content:flex-start;margin:0 20px;max-width:35%;text-align:left;top:11px}}mv-itinerary-mobile-app-cta.open{min-height:160px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta.open{min-height:64px}}mv-itinerary-mobile-app-cta.open .minimize-btn{position:relative;top:-1.5em}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta.open .minimize-btn{top:-1.3em}}mv-itinerary-mobile-app-cta.min{border-top-width:0}mv-itinerary-mobile-app-cta.min .minimize-wrapper{background-color:#f0500c}mv-itinerary-mobile-app-cta.min .minimize-wrapper .minimize-btn:before{background-color:#f0500c}mv-itinerary-mobile-app-cta.min .ani-route{justify-content:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-itinerary-mobile-app-cta.min .ani-route{top:0}}mv-itinerary-mobile-app-cta.min .ani-route .route-cta{display:none}mv-itinerary-mobile-app-cta.min .ani-route .route-cta-minimized{position:relative;opacity:1;visibility:visible;z-index:9;padding:4px 15px}mv-itinerary-mobile-app-cta.min .last-text,mv-itinerary-mobile-app-cta.min .route-wrapper,mv-itinerary-mobile-app-cta.min .curved-route-wrapper,mv-itinerary-mobile-app-cta.min .itinerary-text-wrapper{display:none}\n'],encapsulation:2}),e})();function ao(e,t){1&e&&s._UZ(0,"mv-buy-ticket-link")}function so(e,t){if(1&e&&s._UZ(0,"mv-itinerary-header",6),2&e){const e=s.oxw();s.Q6J("route",e.route)}}function lo(e,t){1&e&&s._UZ(0,"mv-itinerary-list")}function co(e,t){1&e&&(s.TgZ(0,"div",7),s._UZ(1,"mv-spinner"),s.qZA())}function uo(e,t){if(1&e&&s._UZ(0,"mv-itinerary-mobile-app-cta",6),2&e){const e=s.oxw();s.ekj("open",!e.state.global.mobileItineraryAppCtaMinimized)("min",e.state.global.mobileItineraryAppCtaMinimized),s.Q6J("route",e.route)}}function po(e,t){if(1&e&&s._UZ(0,"mv-qr-code-banner",8),2&e){const e=s.oxw();s.Q6J("qrCodeParams",e.qrParams)}}let ho=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.document=e,this.routingService=t,this.analyticsService=n,this.canonicalService=i,this.store=r,this.a11y=o,this.platformService=a,this.customerService=s,this.SubTabId=D.zA,this.qrParams={campaign:ie.oS.Itinerary_QRcode,appArea:ie.Kq.QR,deepLinkSchemaType:re.nu.Directions,promoKey:"web_scan_qr",displayDirection:"top"}}get state(){return this.store.getState()}get route(){return this.state.itinerary.selectedRoute}get isSimilarRouteLoading(){return this.state.itinerary.similarRouteLoadingStatus==i.Gu.LOADING}ngOnInit(){var e;this.a11y.byEnter&&(null===(e=this.document.getElementById("back-link"))||void 0===e||e.focus())}goBackToSuggestedRoutes(){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["poi",":searchTo",":searchFrom",":locale"]))}onBuyTicketsClick(){var e;const t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.ticketsUrl;t&&(this.analyticsService.trackOutboundLink(t),window.open(t,"_blank"))}get isShowQrBanner(){var e,t,n;const i=this.platformService.isDesktop,r=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.id,o=!!r&&!this.customerService.isMoovitCustomer(r),a=null===(n=null===(t=this.state.customer.currentCustomer)||void 0===t?void 0:t.designConfiguration)||void 0===n?void 0:n.isShowCustomDesktopItineraryBanner;return i&&(!o||a)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(f.Z),s.Y36(d.y),s.Y36(R.z),s.Y36(l.d),s.Y36(g.F),s.Y36(y.mi),s.Y36(u.v))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-main-view"]],decls:7,vars:6,consts:[[3,"backClick"],[4,"ngIf"],[3,"route",4,"ngIf"],["class","spinner",4,"ngIf"],[3,"route","open","min",4,"ngIf"],[3,"qrCodeParams",4,"ngIf"],[3,"route"],[1,"spinner"],[3,"qrCodeParams"]],template:function(e,t){1&e&&(s.TgZ(0,"mv-back-button",0),s.NdJ("backClick",function(){return t.goBackToSuggestedRoutes()}),s.YNc(1,ao,1,0,"mv-buy-ticket-link",1),s.qZA(),s.YNc(2,so,1,1,"mv-itinerary-header",2),s.YNc(3,lo,1,0,"mv-itinerary-list",1),s.YNc(4,co,2,0,"div",3),s.YNc(5,uo,1,5,"mv-itinerary-mobile-app-cta",4),s.YNc(6,po,1,1,"mv-qr-code-banner",5)),2&e&&(s.xp6(1),s.Q6J("ngIf",null==t.state.customer.currentCustomer?null:t.state.customer.currentCustomer.ticketsUrl),s.xp6(1),s.Q6J("ngIf",t.route),s.xp6(1),s.Q6J("ngIf",t.route&&!t.isSimilarRouteLoading),s.xp6(1),s.Q6J("ngIf",t.isSimilarRouteLoading),s.xp6(1),s.Q6J("ngIf",t.platformService.isMobile&&!(null!=t.state.customer.currentCustomer&&null!=t.state.customer.currentCustomer.designConfiguration&&t.state.customer.currentCustomer.designConfiguration.hideDirectionsBanner)),s.xp6(1),s.Q6J("ngIf",t.isShowQrBanner))},directives:[M.W,o.O5,Ne,Hi,Jr,mt.O,oo,kt.Y],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-itinerary-main-view{height:100%;position:relative;display:flex;flex-direction:column}\n"],encapsulation:2}),e})();var mo=n(43049),go=n(27091);const fo=["popupContainer"],vo="itineraryMapElement";let yo=(()=>{class e extends Zt.d{constructor(e,t,n,i,r,o,a,s,l,c,d){super(t,a,s,vo,"ItineraryMap"),this.document=e,this.store=t,this.resolver=n,this.storeHelper=i,this.permissionService=r,this.itineraryActions=o,this.customerService=a,this.uiActions=s,this.imageService=l,this.stopService=c,this.dataConvertersService=d,this.markers=[],this.locations=[],this.popups=[],this.unsubscribes=[]}ngOnInit(){var e,t;return(0,r.mG)(this,void 0,void 0,function*(){yield this.initLeafletMap(),(null===(t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration)||void 0===t?void 0:t.enableLiveDirections)&&this.permissionService.requestLocation().then(e=>(0,r.mG)(this,void 0,void 0,function*(){if(e){const e=yield this.permissionService.requestOrientation();this.mapLocation=new Ut.Y(this.map,e)}})),this.document.getElementById(vo).setAttribute("tabindex","-1"),this.selectedRoute&&this.drawRoute(),this.store.dispatch(this.itineraryActions.readMapData()),this.unsubscribes.push(this.storeHelper.subscribe("itinerary.itineraryMapHasNewData",e=>{e&&(this.logger.log("updating route from state"),this.drawRoute(),this.store.dispatch(this.itineraryActions.readMapData()))})),this.unsubscribes.push(this.storeHelper.subscribe("itinerary.navSelectedStep",(e,t)=>{this.centerMapForRoute()}))})}ngOnDestroy(){var e;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}get state(){return this.store.getState()}get selectedRoute(){return this.state.itinerary.selectedRoute}get selectedStep(){return this.state.itinerary.navSelectedStep}get stopsMetadata(){return this.state.itinerary.selectedRouteStopMetadata}centerMapForRoute(){var e;null===(e=this.map)||void 0===e||e.invalidateSize(),this.selectedStep?this.centerOnRouteStep():this.fitBounds()}centerOnRouteStep(){const e=this.selectedStep;let t=[];if(e.type==A.cF.StartFrom||e.type==A.cF.WaitFor){const n=Vt.zU(e.leg);n&&t.push(n)}else t=Vt.LW(e.leg);t.length>0&&this.fitBoundsByPoints(t)}fitBounds(){this.logger.log("fitBounds");const e=this.markers[i.$h.From],t=this.markers[i.$h.To];if(e&&t){const n=L.latLngBounds(e.getLatLng(),t.getLatLng());this.internalMapFitBounds(n)}else(e||t)&&(this.logger.log("setting view to zoom 4"),this.map.setView((e||t).getLatLng(),4))}drawRoute(){this.removeFromToLine(),this.cleanRouteLayers(),this.popups.forEach(e=>null==e?void 0:e.destroy()),this.popups=[],this.drawFromTo(!this.selectedStep,!1),this.drawRouteLegs(),setTimeout(()=>{this.centerMapForRoute()},500)}drawFromTo(e,t){const n=this.state.directions.search.from,r=this.state.directions.search.to;this.logger.log("drawFromTo",{from:n,to:r,showMarkers:t}),this.ensureMarker(i.$h.From,n,t),this.ensureMarker(i.$h.To,r,t),e&&this.fitBounds()}createBikeStationPopup(e,t,n,i){const r=this.createPopupComponent("marker-popup"),o=r.instance;o.model={isBikeStation:!0,availableBikes:n.availableBikes,freeDocks:n.freeDocks,providerName:t.providerName,address:e.name,lastUpdate:Date.now()},i.bindPopup(o.getElement(),{closeButton:!1,offset:L.point(0,-25)}),this.popups.push(r)}createMarker(e,t,n){this.logger.log("createMarker",{fromTo:e,location:t,visible:n});const i=L.marker([t.latlng.lat,t.latlng.lng],{icon:this.icons[e],zIndexOffset:1e3}).addTo(this.map),r=this.createPopupComponent("marker-popup"),o=r.instance;o.model={title:t.name,description:t.address,imageHtml:t.imageHtml,fromTo:e,location:t.latlng,isBikeStation:!1},i.bindPopup(o.getElement(),{closeButton:!1,offset:L.point(0,-25)}),this.markers[e]=i,n&&i.openPopup(),this.popups.push(r)}ensureMarker(e,t,n){return this.logger.log("ensureMarker",{fromTo:e,location:t,visible:n}),t==this.locations[e]?(this.logger.log("Request marker was already created"),!1):(this.removeMarker(e),this.removeFromToLine(),this.locations[e]=t,t&&this.createMarker(e,t,n),!0)}removeMarker(e){this.logger.log("removeMarker",e);const t=this.markers[e];t&&(this.map.removeLayer(t),this.markers[e]=null);const n=this.popups[e];n&&(n.destroy(),this.popups[e]=null)}createPopupComponent(e){const t=this.resolver.resolveComponentFactory(jt.A);return this.popupContainer.createComponent(t)}removeFromToLine(){this.logger.log("removeFromToLine"),this.fromToLine&&(this.map.removeLayer(this.fromToLine),this.fromToLine=null)}drawRouteLegs(){const e=this.selectedRoute.steps;this.logger.log("drawRouteSteps",e),this.cleanRouteLayers();let t=[];e.forEach((n,i)=>(0,r.mG)(this,void 0,void 0,function*(){const r=n.leg,o=n.legType,a=n.extra.legImageMetaData;if(o!=A.kJ.WaitFor&&o!=A.kJ.StartFrom){const s=Vt.LW(r);t=t.concat(s);const l=this.getStepColor(n),c={color:l,weight:4,opacity:.8,dashArray:o===A.kJ.Walk?[5,5]:null};if(o!=A.kJ.WalkToPath){const e=L.polyline(s,c).addTo(this.map);this.routeLegs.push(e)}if(n.type===A.cF.RentalBikeRideTo&&this.createStopMarkersForRentalBicycle(n),o===A.kJ.WalkToPath&&r.points&&(0,A.pq)(r.points)&&this.createEntranceMarker(r.points.originPathwayLocation||r.points.destinationPathwayLocation),o===A.kJ.Walk||o===A.kJ.WalkToPath||o===A.kJ.Bicycle||o===A.kJ.WaitFor)return;let d;if(n.type==A.cF.RideTo){const e=n.extra.selectedLine;d=r.altLineIds.find(t=>t.lineId==e.lineId).stopSequenceIds}else d=r.stopIds;const u=d.map(e=>{const t=this.stopsMetadata[e]?Ht._.fromMvLatLon(this.stopsMetadata[e].stopLocation):null;return t&&this.stopsMetadata[e]&&(t.stopName=this.stopsMetadata[e].stopName),t});let p=u[u.length-1];i<e.length-1&&this.getNextStep(n).legType==o&&(p=null),this.createStopMarkers(l,u,s);const h=yield a.stopMetaData.stopImageOnMapHtmlPromise;this.createFirstAndLastStationMarker(o,u[0],p,h)}})),this.fitBoundsByPoints(t)}getNextStep(e){return this.selectedRoute.steps[e.index+1]}cleanRouteLayers(){this.logger.log("removeRouteLegs"),this.removeLayers(this.routeLegs),this.removeLayers(this.legFirstStationMarkers),this.removeLayers(this.stopMarkers),this.routeLegs=[],this.legFirstStationMarkers=[],this.stopMarkers=[]}createEntranceMarker(e){this.logger.log("createFirstAndLastStationMarker",e);const t=this.isRetina?30:33,n=this.isRetina?21:24,i=L.icon({iconUrl:"images/pathwayEntrance.svg",iconSize:[n,t],iconAnchor:[n/2,t]}),r=L.marker([e.lat,e.lng],{icon:i}).addTo(this.map);this.legFirstStationMarkers.push(r)}createFirstAndLastStationMarker(e,t,n,i){this.logger.log("createFirstAndLastStationMarker",e,t,n);const r=[],o=this.isRetina?30:33,a=this.isRetina?21:24;let s;if(s=-1!=i.indexOf("<")?L.divIcon({html:i,iconSize:[a,o],iconAnchor:[a/2,o],className:"stop-icon"}):L.icon({iconUrl:le.jm(e,this.isRetina),iconSize:[a,o],iconAnchor:[a/2,o]}),e!=A.kJ.StartFrom){if(t){const e=L.marker([t.lat,t.lng],{icon:s}).addTo(this.map);this.legFirstStationMarkers.push(e),r.push(e)}if(n){const e=L.marker([n.lat,n.lng],{icon:s}).addTo(this.map);this.legFirstStationMarkers.push(e),r.push(e)}}return r}getStepColor(e){return e.type!==A.cF.WalkTo&&e.type!==A.cF.BikeRideTo&&e.type!==A.cF.RentalBikeRideTo&&e.type!==A.cF.WalkToPath&&e.extra.legImageMetaData.lineColor?e.type==A.cF.RideTo?e.extra.selectedLine.lineColor:e.extra.legImageMetaData.lineColor:"#000000"}get isRetina(){return!1}createStopMarkersForRentalBicycle(e){return(0,r.mG)(this,void 0,void 0,function*(){const{originNearbyBicycleStopIds:t,destNearbyBicycleStopIds:n}=e.extra,{metroId:i,currentMetro:o}=this.state.metro,a=[...t,...n],s=yield this.stopService.getBicycleStopById(a),l=yield this.stopService.getBicycleStopsDetailsByIds(s,i),c=yield this.stopService.getBicycleStopsRealTimeInfo(a),{primaryColor:d,secondaryColor:u}=o.bicycleProviders.find(e=>e.providerId===s[0].providerId),p=(0,le.N0)(d),h=(0,le.N0)(u);t.forEach((e,t)=>(0,r.mG)(this,void 0,void 0,function*(){var n,i;const r=s.find(t=>t.stopId===e),o=l.find(t=>t.stopId===e),a=c.find(t=>t.rentalBikeStopId===e),d=(null==a?void 0:a.availableBikes)>0?a.availableBikes:"";if(!r)return;let u;u=0!==t&&d?yield this.dataConvertersService.bicycleStopImageHtmlPromise(!0,null,!1,p,h,d,"centered",h):yield this.imageService.getImageHTML(null===(n=null==o?void 0:o.mapImage)||void 0===n?void 0:n.imageId,[...null===(i=null==o?void 0:o.mapImage)||void 0===i?void 0:i.params,d]),this.stopMarkerForRentalBicycle(r,o,a,u)})),n.forEach((e,t)=>(0,r.mG)(this,void 0,void 0,function*(){const n=s.find(t=>t.stopId===e),i=l.find(t=>t.stopId===e),r=c.find(t=>t.rentalBikeStopId===e),o=(null==r?void 0:r.freeDocks)>0?r.freeDocks:"";if(!n)return;const a=0===t&&(null==r?void 0:r.freeDocks)>0,d=yield this.dataConvertersService.bicycleStopImageHtmlPromise(!0,0===t||(null==r?void 0:r.freeDocks)<=0?mo.nM.BIKES_LAYER_DOCKING:null,a,"000000","ffffff",o,a?"":"centered",a?"000000":"ffffff");this.stopMarkerForRentalBicycle(n,i,r,d)}))})}stopMarkerForRentalBicycle(e,t,n,i){const r=Ht._.fromMvLatLon(e.location),o=this.createFirstAndLastStationMarker(A.kJ.Bicycle,r,null,i);n&&(n.freeDocks>0||n.availableBikes>0)&&this.createBikeStationPopup(e,t,n,o[0])}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(o.K0),s.Y36(l.d),s.Y36(s._Vd),s.Y36(c.N),s.Y36(ne.$),s.Y36(Fe.L),s.Y36(u.v),s.Y36(Gt.V),s.Y36(ue.KD),s.Y36(go.V),s.Y36(li.J))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-map"]],viewQuery:function(e,t){if(1&e&&s.Gf(fo,7,s.s_b),2&e){let e;s.iGM(e=s.CRH())&&(t.popupContainer=e.first)}},features:[s.qOj],decls:3,vars:0,consts:[["id","itineraryMapElement",1,"itinerary-map"],[1,"popup-container"],["popupContainer",""]],template:function(e,t){1&e&&(s._UZ(0,"div",0),s._UZ(1,"div",1,2))},styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-map{position:relative;flex-grow:1;display:flex;flex-direction:column}mv-itinerary-map .itinerary-map{direction:ltr;flex-grow:1}mv-itinerary-map .itinerary-map .stop-div-icon div{background-color:#edeff3;border:2px solid #292A30;border-radius:5px;box-sizing:border-box;height:10px;width:10px}mv-itinerary-map .itinerary-map .stop-icon .mvf-wrapper{height:36px}mv-itinerary-map .itinerary-map .stop-icon .mvf-wrapper .text.centered{font-size:11px;font-weight:400;width:100%;height:100%;display:flex;align-items:center;justify-content:center;left:0;top:-2px}mv-itinerary-map mv-map-popup{display:none}mv-itinerary-map .leaflet-popup-content-wrapper mv-map-popup{display:block}mv-itinerary-map .leaflet-control-attribution.leaflet-control{direction:ltr}mv-itinerary-map .leaflet-popup .leaflet-popup-tip{height:12px;width:12px}mv-itinerary-map .leaflet-popup .leaflet-popup-content-wrapper,mv-itinerary-map .leaflet-popup .leaflet-popup-tip{background:#ECF0F1;box-shadow:0 0 4px 1px #00000026}mv-itinerary-map .leaflet-popup-content{margin:0}mv-itinerary-map .leaflet-popup-content-wrapper{border-radius:4px;overflow:hidden;padding:0}mv-itinerary-map .leaflet-popup-content{width:auto!important}mv-itinerary-map .mapbox-wordmark{display:block;height:20px;width:65px;left:10px;bottom:10px;text-indent:-9999px;z-index:99999;overflow:hidden;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODAuNDcgMjAuMDIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDgwLjQ3IDIwLjAyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe29wYWNpdHk6MC42O2ZpbGw6I0ZGRkZGRjtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30uc3Qxe29wYWNpdHk6MC42O2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fTwvc3R5bGU+PGc+PHBhdGggY2xhc3M9InN0MCIgZD0iTTc5LjI5LDEzLjYxYzAsMC4xMS0wLjA5LDAuMi0wLjIsMC4yaC0xLjUzYy0wLjEyLDAtMC4yMy0wLjA2LTAuMjktMC4xNmwtMS4zNy0yLjI4bC0xLjM3LDIuMjhjLTAuMDYsMC4xLTAuMTcsMC4xNi0wLjI5LDAuMTZoLTEuNTNjLTAuMDQsMC0wLjA4LTAuMDEtMC4xMS0wLjAzYy0wLjA5LTAuMDYtMC4xMi0wLjE4LTAuMDYtMC4yN2MwLDAsMCwwLDAsMGwyLjMxLTMuNWwtMi4yOC0zLjQ3Yy0wLjAyLTAuMDMtMC4wMy0wLjA3LTAuMDMtMC4xMWMwLTAuMTEsMC4wOS0wLjIsMC4yLTAuMmgxLjUzYzAuMTIsMCwwLjIzLDAuMDYsMC4yOSwwLjE2bDEuMzQsMi4yNWwxLjMzLTIuMjRjMC4wNi0wLjEsMC4xNy0wLjE2LDAuMjktMC4xNmgxLjUzYzAuMDQsMCwwLjA4LDAuMDEsMC4xMSwwLjAzYzAuMDksMC4wNiwwLjEyLDAuMTgsMC4wNiwwLjI3YzAsMCwwLDAsMCwwTDc2Ljk2LDEwbDIuMzEsMy41Qzc5LjI4LDEzLjUzLDc5LjI5LDEzLjU3LDc5LjI5LDEzLjYxeiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik02My4wOSw5LjE2Yy0wLjM3LTEuNzktMS44Ny0zLjEyLTMuNjYtMy4xMmMtMC45OCwwLTEuOTMsMC40LTIuNiwxLjEyVjMuMzdjMC0wLjEyLTAuMS0wLjIyLTAuMjItMC4yMmgtMS4zM2MtMC4xMiwwLTAuMjIsMC4xLTAuMjIsMC4yMnYxMC4yMWMwLDAuMTIsMC4xLDAuMjIsMC4yMiwwLjIyaDEuMzNjMC4xMiwwLDAuMjItMC4xLDAuMjItMC4yMnYtMC43YzAuNjgsMC43MSwxLjYyLDEuMTIsMi42LDEuMTJjMS43OSwwLDMuMjktMS4zNCwzLjY2LTMuMTNDNjMuMjEsMTAuMyw2My4yMSw5LjcyLDYzLjA5LDkuMTZMNjMuMDksOS4xNnogTTU5LjEyLDEyLjQxYy0xLjI2LDAtMi4yOC0xLjA2LTIuMy0yLjM2VjkuOTljMC4wMi0xLjMxLDEuMDQtMi4zNiwyLjMtMi4zNnMyLjMsMS4wNywyLjMsMi4zOVM2MC4zOSwxMi40MSw1OS4xMiwxMi40MXoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjguMjYsNi4wNGMtMS44OS0wLjAxLTMuNTQsMS4yOS0zLjk2LDMuMTNjLTAuMTIsMC41Ni0wLjEyLDEuMTMsMCwxLjY5YzAuNDIsMS44NSwyLjA3LDMuMTYsMy45NywzLjE0YzIuMjQsMCw0LjA2LTEuNzgsNC4wNi0zLjk5UzcwLjUxLDYuMDQsNjguMjYsNi4wNHogTTY4LjI0LDEyLjQyYy0xLjI3LDAtMi4zLTEuMDctMi4zLTIuMzlzMS4wMy0yLjQsMi4zLTIuNHMyLjMsMS4wNywyLjMsMi4zOVM2OS41MSwxMi40MSw2OC4yNCwxMi40Mkw2OC4yNCwxMi40MnoiLz48cGF0aCBjbGFzcz0ic3QxIiBkPSJNNTkuMTIsNy42M2MtMS4yNiwwLTIuMjgsMS4wNi0yLjMsMi4zNnYwLjA2YzAuMDIsMS4zMSwxLjA0LDIuMzYsMi4zLDIuMzZzMi4zLTEuMDcsMi4zLTIuMzlTNjAuMzksNy42Myw1OS4xMiw3LjYzeiBNNTkuMTIsMTEuMjNjLTAuNiwwLTEuMDktMC41My0xLjExLTEuMTlWMTBjMC4wMS0wLjY2LDAuNTEtMS4xOSwxLjExLTEuMTlzMS4xMSwwLjU0LDEuMTEsMS4yMVM1OS43NCwxMS4yMyw1OS4xMiwxMS4yM3oiLz48cGF0aCBjbGFzcz0ic3QxIiBkPSJNNjguMjQsNy42M2MtMS4yNywwLTIuMywxLjA3LTIuMywyLjM5czEuMDMsMi4zOSwyLjMsMi4zOXMyLjMtMS4wNywyLjMtMi4zOVM2OS41MSw3LjYzLDY4LjI0LDcuNjN6IE02OC4yNCwxMS4yM2MtMC42MSwwLTEuMTEtMC41NC0xLjExLTEuMjFzMC41LTEuMiwxLjExLTEuMnMxLjExLDAuNTQsMS4xMSwxLjIxUzY4Ljg1LDExLjIzLDY4LjI0LDExLjIzeiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00My41Niw2LjI0aC0xLjMzYy0wLjEyLDAtMC4yMiwwLjEtMC4yMiwwLjIydjAuN2MtMC42OC0wLjcxLTEuNjItMS4xMi0yLjYtMS4xMmMtMi4wNywwLTMuNzUsMS43OC0zLjc1LDMuOTlzMS42OSwzLjk5LDMuNzUsMy45OWMwLjk5LDAsMS45My0wLjQxLDIuNi0xLjEzdjAuN2MwLDAuMTIsMC4xLDAuMjIsMC4yMiwwLjIyaDEuMzNjMC4xMiwwLDAuMjItMC4xLDAuMjItMC4yMlY2LjQ0YzAtMC4xMS0wLjA5LTAuMjEtMC4yMS0wLjIxQzQzLjU3LDYuMjQsNDMuNTcsNi4yNCw0My41Niw2LjI0eiBNNDIuMDIsMTAuMDVjLTAuMDEsMS4zMS0xLjA0LDIuMzYtMi4zLDIuMzZzLTIuMy0xLjA3LTIuMy0yLjM5czEuMDMtMi40LDIuMjktMi40YzEuMjcsMCwyLjI4LDEuMDYsMi4zLDIuMzZMNDIuMDIsMTAuMDV6Ii8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTM5LjcyLDcuNjNjLTEuMjcsMC0yLjMsMS4wNy0yLjMsMi4zOXMxLjAzLDIuMzksMi4zLDIuMzlzMi4yOC0xLjA2LDIuMy0yLjM2VjkuOTlDNDIsOC42OCw0MC45OCw3LjYzLDM5LjcyLDcuNjN6IE0zOC42MiwxMC4wMmMwLTAuNjcsMC41LTEuMjEsMS4xMS0xLjIxYzAuNjEsMCwxLjA5LDAuNTMsMS4xMSwxLjE5djAuMDRjLTAuMDEsMC42NS0wLjUsMS4xOC0xLjExLDEuMThTMzguNjIsMTAuNjgsMzguNjIsMTAuMDJ6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTQ5LjkxLDYuMDRjLTAuOTgsMC0xLjkzLDAuNC0yLjYsMS4xMlY2LjQ1YzAtMC4xMi0wLjEtMC4yMi0wLjIyLTAuMjJoLTEuMzNjLTAuMTIsMC0wLjIyLDAuMS0wLjIyLDAuMjJ2MTAuMjFjMCwwLjEyLDAuMSwwLjIyLDAuMjIsMC4yMmgxLjMzYzAuMTIsMCwwLjIyLTAuMSwwLjIyLTAuMjJ2LTMuNzhjMC42OCwwLjcxLDEuNjIsMS4xMiwyLjYxLDEuMTJjMi4wNywwLDMuNzUtMS43OCwzLjc1LTMuOTlTNTEuOTgsNi4wNCw0OS45MSw2LjA0eiBNNDkuNiwxMi40MmMtMS4yNiwwLTIuMjgtMS4wNi0yLjMtMi4zNlY5Ljk5YzAuMDItMS4zMSwxLjA0LTIuMzcsMi4yOS0yLjM3YzEuMjYsMCwyLjMsMS4wNywyLjMsMi4zOVM1MC44NiwxMi40MSw0OS42LDEyLjQyTDQ5LjYsMTIuNDJ6Ii8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTQ5LjYsNy42M2MtMS4yNiwwLTIuMjgsMS4wNi0yLjMsMi4zNnYwLjA2YzAuMDIsMS4zMSwxLjA0LDIuMzYsMi4zLDIuMzZzMi4zLTEuMDcsMi4zLTIuMzlTNTAuODYsNy42Myw0OS42LDcuNjN6IE00OS42LDExLjIzYy0wLjYsMC0xLjA5LTAuNTMtMS4xMS0xLjE5VjEwQzQ4LjUsOS4zNCw0OSw4LjgxLDQ5LjYsOC44MWMwLjYsMCwxLjExLDAuNTUsMS4xMSwxLjIxUzUwLjIxLDExLjIzLDQ5LjYsMTEuMjN6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTM0LjM2LDEzLjU5YzAsMC4xMi0wLjEsMC4yMi0wLjIyLDAuMjJoLTEuMzRjLTAuMTIsMC0wLjIyLTAuMS0wLjIyLTAuMjJWOS4yNGMwLTAuOTMtMC43LTEuNjMtMS41NC0xLjYzYy0wLjc2LDAtMS4zOSwwLjY3LTEuNTEsMS41NGwwLjAxLDQuNDRjMCwwLjEyLTAuMSwwLjIyLTAuMjIsMC4yMmgtMS4zNGMtMC4xMiwwLTAuMjItMC4xLTAuMjItMC4yMlY5LjI0YzAtMC45My0wLjctMS42My0xLjU0LTEuNjNjLTAuODEsMC0xLjQ3LDAuNzUtMS41MiwxLjcxdjQuMjdjMCwwLjEyLTAuMSwwLjIyLTAuMjIsMC4yMmgtMS4zM2MtMC4xMiwwLTAuMjItMC4xLTAuMjItMC4yMlY2LjQ0YzAuMDEtMC4xMiwwLjEtMC4yMSwwLjIyLTAuMjFoMS4zM2MwLjEyLDAsMC4yMSwwLjEsMC4yMiwwLjIxdjAuNjNjMC40OC0wLjY1LDEuMjQtMS4wNCwyLjA2LTEuMDVoMC4wM2MxLjA0LDAsMS45OSwwLjU3LDIuNDgsMS40OGMwLjQzLTAuOSwxLjMzLTEuNDgsMi4zMi0xLjQ5YzEuNTQsMCwyLjc5LDEuMTksMi43NiwyLjY1TDM0LjM2LDEzLjU5eiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik04MC4zMiwxMi45N2wtMC4wNy0wLjEyTDc4LjM4LDEwbDEuODUtMi44MWMwLjQyLTAuNjQsMC4yNS0xLjQ5LTAuMzktMS45MmMtMC4wMS0wLjAxLTAuMDItMC4wMS0wLjAzLTAuMDJjLTAuMjItMC4xNC0wLjQ4LTAuMjEtMC43NC0wLjIxaC0xLjUzYy0wLjUzLDAtMS4wMywwLjI4LTEuMywwLjc0bC0wLjMyLDAuNTNsLTAuMzItMC41M2MtMC4yOC0wLjQ2LTAuNzctMC43NC0xLjMxLTAuNzRoLTEuNTNjLTAuNTcsMC0xLjA4LDAuMzUtMS4yOSwwLjg4Yy0yLjA5LTEuNTgtNS4wMy0xLjQtNi45MSwwLjQzYy0wLjMzLDAuMzItMC42MiwwLjY5LTAuODUsMS4wOWMtMC44NS0xLjU1LTIuNDUtMi42LTQuMjgtMi42Yy0wLjQ4LDAtMC45NiwwLjA3LTEuNDEsMC4yMlYzLjM3YzAtMC43OC0wLjYzLTEuNDEtMS40LTEuNDFoLTEuMzNjLTAuNzcsMC0xLjQsMC42My0xLjQsMS40djMuNTdjLTAuOS0xLjMtMi4zOC0yLjA4LTMuOTctMi4wOWMtMC43LDAtMS4zOSwwLjE1LTIuMDIsMC40NWMtMC4yMy0wLjE2LTAuNTEtMC4yNS0wLjgtMC4yNWgtMS4zM2MtMC40MywwLTAuODMsMC4yLTEuMSwwLjUzYy0wLjAyLTAuMDMtMC4wNC0wLjA1LTAuMDctMC4wOGMtMC4yNy0wLjI5LTAuNjUtMC40NS0xLjA0LTAuNDVoLTEuMzJjLTAuMjksMC0wLjU3LDAuMDktMC44LDAuMjVDNDAuOCw1LDQwLjEyLDQuODUsMzkuNDIsNC44NWMtMS43NCwwLTMuMjcsMC45NS00LjE2LDIuMzhjLTAuMTktMC40NC0wLjQ2LTAuODUtMC43OS0xLjE5Yy0wLjc2LTAuNzctMS44LTEuMTktMi44OC0xLjE5aC0wLjAxYy0wLjg1LDAuMDEtMS42NywwLjMxLTIuMzQsMC44NGMtMC43LTAuNTQtMS41Ni0wLjg0LTIuNDUtMC44NGgtMC4wM2MtMC4yOCwwLTAuNTUsMC4wMy0wLjgyLDAuMWMtMC4yNywwLjA2LTAuNTMsMC4xNS0wLjc4LDAuMjdjLTAuMi0wLjExLTAuNDMtMC4xNy0wLjY3LTAuMTdoLTEuMzNjLTAuNzgsMC0xLjQsMC42My0xLjQsMS40djcuMTRjMCwwLjc4LDAuNjMsMS40LDEuNCwxLjRoMS4zM2MwLjc4LDAsMS40MS0wLjYzLDEuNDEtMS40MWMwLDAsMCwwLDAsMFY5LjM1YzAuMDMtMC4zNCwwLjIyLTAuNTYsMC4zNC0wLjU2YzAuMTcsMCwwLjM2LDAuMTcsMC4zNiwwLjQ1djQuMzVjMCwwLjc4LDAuNjMsMS40LDEuNCwxLjRoMS4zNGMwLjc4LDAsMS40LTAuNjMsMS40LTEuNGwtMC4wMS00LjM1YzAuMDYtMC4zLDAuMjQtMC40NSwwLjMzLTAuNDVjMC4xNywwLDAuMzYsMC4xNywwLjM2LDAuNDV2NC4zNWMwLDAuNzgsMC42MywxLjQsMS40LDEuNGgxLjM0YzAuNzgsMCwxLjQtMC42MywxLjQtMS40di0wLjM2YzAuOTEsMS4yMywyLjM0LDEuOTYsMy44NywxLjk2YzAuNywwLDEuMzktMC4xNSwyLjAyLTAuNDVjMC4yMywwLjE2LDAuNTEsMC4yNSwwLjgsMC4yNWgxLjMyYzAuMjksMCwwLjU3LTAuMDksMC44LTAuMjV2MS45MWMwLDAuNzgsMC42MywxLjQsMS40LDEuNGgxLjMzYzAuNzgsMCwxLjQtMC42MywxLjQtMS40di0xLjY5YzAuNDYsMC4xNCwwLjk0LDAuMjIsMS40MiwwLjIxYzEuNjIsMCwzLjA3LTAuODMsMy45Ny0yLjF2MC41YzAsMC43OCwwLjYzLDEuNCwxLjQsMS40aDEuMzNjMC4yOSwwLDAuNTctMC4wOSwwLjgtMC4yNWMwLjYzLDAuMywxLjMyLDAuNDUsMi4wMiwwLjQ1YzEuODMsMCwzLjQzLTEuMDUsNC4yOC0yLjZjMS40NywyLjUyLDQuNzEsMy4zNiw3LjIyLDEuODljMC4xNy0wLjEsMC4zNC0wLjIxLDAuNS0wLjM0YzAuMjEsMC41MiwwLjcyLDAuODcsMS4yOSwwLjg2aDEuNTNjMC41MywwLDEuMDMtMC4yOCwxLjMtMC43NGwwLjM1LTAuNThsMC4zNSwwLjU4YzAuMjgsMC40NiwwLjc3LDAuNzQsMS4zMSwwLjc0aDEuNTJjMC43NywwLDEuMzktMC42MywxLjM4LTEuMzlDODAuNDcsMTMuMzgsODAuNDIsMTMuMTcsODAuMzIsMTIuOTdMODAuMzIsMTIuOTd6IE0zNC4xNSwxMy44MWgtMS4zNGMtMC4xMiwwLTAuMjItMC4xLTAuMjItMC4yMlY5LjI0YzAtMC45My0wLjctMS42My0xLjU0LTEuNjNjLTAuNzYsMC0xLjM5LDAuNjctMS41MSwxLjU0bDAuMDEsNC40NGMwLDAuMTItMC4xLDAuMjItMC4yMiwwLjIyaC0xLjM0Yy0wLjEyLDAtMC4yMi0wLjEtMC4yMi0wLjIyVjkuMjRjMC0wLjkzLTAuNy0xLjYzLTEuNTQtMS42M2MtMC44MSwwLTEuNDcsMC43NS0xLjUyLDEuNzF2NC4yN2MwLDAuMTItMC4xLDAuMjItMC4yMiwwLjIyaC0xLjMzYy0wLjEyLDAtMC4yMi0wLjEtMC4yMi0wLjIyVjYuNDRjMC4wMS0wLjEyLDAuMS0wLjIxLDAuMjItMC4yMWgxLjMzYzAuMTIsMCwwLjIxLDAuMSwwLjIyLDAuMjF2MC42M2MwLjQ4LTAuNjUsMS4yNC0xLjA0LDIuMDYtMS4wNWgwLjAzYzEuMDQsMCwxLjk5LDAuNTcsMi40OCwxLjQ4YzAuNDMtMC45LDEuMzMtMS40OCwyLjMyLTEuNDljMS41NCwwLDIuNzksMS4xOSwyLjc2LDIuNjVsMC4wMSw0LjkxQzM0LjM3LDEzLjcsMzQuMjcsMTMuOCwzNC4xNSwxMy44MUMzNC4xNSwxMy44MSwzNC4xNSwxMy44MSwzNC4xNSwxMy44MXogTTQzLjc4LDEzLjU5YzAsMC4xMi0wLjEsMC4yMi0wLjIyLDAuMjJoLTEuMzNjLTAuMTIsMC0wLjIyLTAuMS0wLjIyLTAuMjJ2LTAuNzFDNDEuMzQsMTMuNiw0MC40LDE0LDM5LjQyLDE0Yy0yLjA3LDAtMy43NS0xLjc4LTMuNzUtMy45OXMxLjY5LTMuOTksMy43NS0zLjk5YzAuOTgsMCwxLjkyLDAuNDEsMi42LDEuMTJ2LTAuN2MwLTAuMTIsMC4xLTAuMjIsMC4yMi0wLjIyaDEuMzNjMC4xMS0wLjAxLDAuMjEsMC4wOCwwLjIyLDAuMmMwLDAuMDEsMCwwLjAxLDAsMC4wMlYxMy41OXogTTQ5LjkxLDE0Yy0wLjk4LDAtMS45Mi0wLjQxLTIuNi0xLjEydjMuNzhjMCwwLjEyLTAuMSwwLjIyLTAuMjIsMC4yMmgtMS4zM2MtMC4xMiwwLTAuMjItMC4xLTAuMjItMC4yMlY2LjQ1YzAtMC4xMiwwLjEtMC4yMSwwLjIyLTAuMjFoMS4zM2MwLjEyLDAsMC4yMiwwLjEsMC4yMiwwLjIydjAuN2MwLjY4LTAuNzIsMS42Mi0xLjEyLDIuNi0xLjEyYzIuMDcsMCwzLjc1LDEuNzcsMy43NSwzLjk4UzUxLjk4LDE0LDQ5LjkxLDE0eiBNNjMuMDksMTAuODdDNjIuNzIsMTIuNjUsNjEuMjIsMTQsNTkuNDMsMTRjLTAuOTgsMC0xLjkyLTAuNDEtMi42LTEuMTJ2MC43YzAsMC4xMi0wLjEsMC4yMi0wLjIyLDAuMjJoLTEuMzNjLTAuMTIsMC0wLjIyLTAuMS0wLjIyLTAuMjJWMy4zN2MwLTAuMTIsMC4xLTAuMjIsMC4yMi0wLjIyaDEuMzNjMC4xMiwwLDAuMjIsMC4xLDAuMjIsMC4yMnYzLjc4YzAuNjgtMC43MSwxLjYyLTEuMTIsMi42LTEuMTFjMS43OSwwLDMuMjksMS4zMywzLjY2LDMuMTJDNjMuMjEsOS43Myw2My4yMSwxMC4zMSw2My4wOSwxMC44N0w2My4wOSwxMC44N0w2My4wOSwxMC44N3ogTTY4LjI2LDE0LjAxYy0xLjksMC4wMS0zLjU1LTEuMjktMy45Ny0zLjE0Yy0wLjEyLTAuNTYtMC4xMi0xLjEzLDAtMS42OWMwLjQyLTEuODUsMi4wNy0zLjE1LDMuOTctMy4xNGMyLjI1LDAsNC4wNiwxLjc4LDQuMDYsMy45OVM3MC41LDE0LjAxLDY4LjI2LDE0LjAxTDY4LjI2LDE0LjAxeiBNNzkuMDksMTMuODFoLTEuNTNjLTAuMTIsMC0wLjIzLTAuMDYtMC4yOS0wLjE2bC0xLjM3LTIuMjhsLTEuMzcsMi4yOGMtMC4wNiwwLjEtMC4xNywwLjE2LTAuMjksMC4xNmgtMS41M2MtMC4wNCwwLTAuMDgtMC4wMS0wLjExLTAuMDNjLTAuMDktMC4wNi0wLjEyLTAuMTgtMC4wNi0wLjI3YzAsMCwwLDAsMCwwbDIuMzEtMy41bC0yLjI4LTMuNDdjLTAuMDItMC4wMy0wLjAzLTAuMDctMC4wMy0wLjExYzAtMC4xMSwwLjA5LTAuMiwwLjItMC4yaDEuNTNjMC4xMiwwLDAuMjMsMC4wNiwwLjI5LDAuMTZsMS4zNCwyLjI1bDEuMzQtMi4yNWMwLjA2LTAuMSwwLjE3LTAuMTYsMC4yOS0wLjE2aDEuNTNjMC4wNCwwLDAuMDgsMC4wMSwwLjExLDAuMDNjMC4wOSwwLjA2LDAuMTIsMC4xOCwwLjA2LDAuMjdjMCwwLDAsMCwwLDBMNzYuOTYsMTBsMi4zMSwzLjVjMC4wMiwwLjAzLDAuMDMsMC4wNywwLjAzLDAuMTFDNzkuMjksMTMuNzIsNzkuMiwxMy44MSw3OS4wOSwxMy44MUM3OS4wOSwxMy44MSw3OS4wOSwxMy44MSw3OS4wOSwxMy44MUw3OS4wOSwxMy44MXoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTAsMS4yMWMtNC44NywwLTguODEsMy45NS04LjgxLDguODFzMy45NSw4LjgxLDguODEsOC44MXM4LjgxLTMuOTUsOC44MS04LjgxQzE4LjgxLDUuMTUsMTQuODcsMS4yMSwxMCwxLjIxeiBNMTQuMTgsMTIuMTljLTEuODQsMS44NC00LjU1LDIuMi02LjM4LDIuMmMtMC42NywwLTEuMzQtMC4wNS0yLTAuMTVjMCwwLTAuOTctNS4zNywyLjA0LTguMzljMC43OS0wLjc5LDEuODYtMS4yMiwyLjk4LTEuMjJjMS4yMSwwLDIuMzcsMC40OSwzLjIzLDEuMzVDMTUuOCw3LjczLDE1Ljg1LDEwLjUsMTQuMTgsMTIuMTl6Ii8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTEwLDAuMDJjLTUuNTIsMC0xMCw0LjQ4LTEwLDEwczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMEMxOS45OSw0LjUsMTUuNTIsMC4wMiwxMCwwLjAyeiBNMTAsMTguODNjLTQuODcsMC04LjgxLTMuOTUtOC44MS04LjgxUzUuMTMsMS4yLDEwLDEuMnM4LjgxLDMuOTUsOC44MSw4LjgxQzE4LjgxLDE0Ljg5LDE0Ljg3LDE4LjgzLDEwLDE4LjgzeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xNC4wNCw1Ljk4Yy0xLjc1LTEuNzUtNC41My0xLjgxLTYuMi0wLjE0QzQuODMsOC44Niw1LjgsMTQuMjMsNS44LDE0LjIzczUuMzcsMC45Nyw4LjM5LTIuMDRDMTUuODUsMTAuNSwxNS44LDcuNzMsMTQuMDQsNS45OHogTTExLjg4LDkuODdsLTAuODcsMS43OGwtMC44Ni0xLjc4TDguMzgsOS4wMWwxLjc3LTAuODZsMC44Ni0xLjc4bDAuODcsMS43OGwxLjc3LDAuODZMMTEuODgsOS44N3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjEzLjY1LDkuMDEgMTEuODgsOS44NyAxMS4wMSwxMS42NSAxMC4xNSw5Ljg3IDguMzgsOS4wMSAxMC4xNSw4LjE1IDExLjAxLDYuMzcgMTEuODgsOC4xNSAiLz48L2c+PC9zdmc+);background-repeat:no-repeat;background-position:0 0;background-size:65px 20px}\n"],encapsulation:2}),e})();const bo=["stepsContainer"];function _o(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",12),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).prevStep()})("keydown.enter",function(){return s.CHM(e),s.oxw(2).prevStep()}),s.ALo(1,"translate"),s._UZ(2,"svg-icon",13),s.ALo(3,"translate"),s.qZA()}2&e&&(s.uIk("aria-label",s.lcZ(1,2,"action_previous")),s.xp6(2),s.s9C("titleText",s.lcZ(3,4,"action_previous")))}function To(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"span",14),s.NdJ("click",function(){const t=s.CHM(e),n=t.index,i=t.$implicit;return s.oxw(2).selectStep(n+1,i)}),s.qZA(),s.BQk()}if(2&e){const e=t.index,n=s.oxw(2);s.xp6(1),s.ekj("active",n.selectedStepIndex==e+1),s.uIk("aria-selected",n.selectedStepIndex==e+1)}}function So(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",15),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).nextStep()})("keydown.enter",function(){return s.CHM(e),s.oxw(2).nextStep()}),s.ALo(1,"translate"),s._UZ(2,"svg-icon",13),s.ALo(3,"translate"),s.qZA()}2&e&&(s.uIk("aria-label",s.lcZ(1,2,"action_next")),s.xp6(2),s.s9C("titleText",s.lcZ(3,4,"action_next")))}function xo(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"mv-route-step",16),s.NdJ("heightChanged",function(){return s.CHM(e),s.oxw(2).setHeight()}),s.qZA(),s.BQk()}if(2&e){const e=t.$implicit,n=s.oxw(2);s.xp6(1),s.Udp("width",n.itemWidth+"px")("opacity",1),s.Q6J("step",e)("showAlert",!0)("showTypeDescription",!0)("showDetails",!0)("showTypeIcon",!0)("showExtraInfo",!0)("disableTabIndex",!0)}}function wo(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",1),s.TgZ(1,"div",2),s.YNc(2,_o,4,6,"a",3),s.TgZ(3,"div",4),s.TgZ(4,"span",5),s.NdJ("click",function(){return s.CHM(e),s.oxw().selectStep(0)}),s.qZA(),s.YNc(5,To,2,3,"ng-container",6),s.qZA(),s.YNc(6,So,4,6,"a",7),s.qZA(),s.TgZ(7,"div",8,9),s.TgZ(9,"div",10),s._UZ(10,"mv-suggested-route",11),s.YNc(11,xo,2,11,"ng-container",6),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.xp6(2),s.Q6J("ngIf",e.selectedStepIndex>0),s.xp6(2),s.ekj("active",0==e.selectedStepIndex),s.xp6(1),s.Q6J("ngForOf",e.steps)("ngForTrackBy",e.trackByIndex),s.xp6(1),s.Q6J("ngIf",e.selectedStepIndex<e.steps.length),s.xp6(1),s.Q6J("ngStyle",e.carouselWrapperStyle),s.xp6(2),s.Q6J("ngStyle",e.carouselInnerStyle),s.xp6(1),s.Udp("width",e.itemWidth+"px")("opacity",1),s.Q6J("route",e.route),s.xp6(1),s.Q6J("ngForOf",e.steps)("ngForTrackBy",e.trackByIndex)}}let ko=(()=>{class e{constructor(e,t,n,i){this.store=e,this.itineraryActions=t,this.storeHelper=n,this.analyticsService=i,this.isInitialized=!1,this.selectedStepIndex=0,this.carouselWrapperStyle={},this.carouselInnerStyle={},this.heightChanged=new s.vpe,this.rtlUnsub=()=>{},this.routeLegLoadedUnsub=()=>{}}ngOnInit(){this.rtlUnsub=this.storeHelper.subscribe("global.selectedLocale.rtl",()=>{this.flipRTL()}),this.routeLegLoadedUnsub=this.storeHelper.subscribe("global.isRouteLegsLoaded",()=>{this.setHeight(),this.routeLegLoadedUnsub()})}ngAfterViewInit(){this.initIfNeeded()}ngAfterViewChecked(){this.initIfNeeded()}ngOnDestroy(){this.rtlUnsub(),this.routeLegLoadedUnsub()}get steps(){return this.route.steps.filter(e=>e.type!==A.cF.WalkToPath)}initIfNeeded(){this.isInitialized||!this.stepElements||!this.stepElements.first||(this.isInitialized=!0,this.setDimensions(),this.switchStep(0))}setDimensions(){this.itemWidth=this.stepsContainer.nativeElement.getBoundingClientRect().width,this.carouselWrapperStyle={width:`${this.itemWidth}px`}}prevStep(){if(this.selectedStepIndex>0){const e=this.steps[this.selectedStepIndex-2];this.analyticsService.trackRoutePreviousStep(this.selectedStepIndex),this.switchStep(this.selectedStepIndex-1,e)}}nextStep(){if(this.selectedStepIndex<this.steps.length){const e=this.steps[this.selectedStepIndex];this.analyticsService.trackRouteNextStep(this.selectedStepIndex),this.switchStep(this.selectedStepIndex+1,e)}}selectStep(e,t){this.analyticsService.trackRouteSwitchStep(e),this.switchStep(e,t)}switchStep(e,t){this.selectedStepIndex=e,this.store.dispatch(this.itineraryActions.selectNavStep(t)),this.setHeight(e);const n=this.store.getState().global.selectedLocale.rtl?"":"-";this.carouselInnerStyle.transform=`translateX(${n}${this.itemWidth*e}px)`}setHeight(e=this.selectedStepIndex){const t=[this.summaryElement,...this.stepElements.toArray()][e].nativeElement.children[0].getBoundingClientRect().height;this.carouselWrapperStyle.height=`${t}px`,this.heightChanged.emit()}flipRTL(){const e=this.store.getState().global.selectedLocale.rtl?"":"-";this.carouselInnerStyle.transform=`translateX(${e}${this.itemWidth*this.selectedStepIndex}px)`}trackByIndex(e){return e}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(Fe.L),s.Y36(c.N),s.Y36(d.y))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-steps-navigator"]],viewQuery:function(e,t){if(1&e&&(s.Gf(bo,5),s.Gf(at,5,s.SBq),s.Gf(Gr,5,s.SBq)),2&e){let e;s.iGM(e=s.CRH())&&(t.stepsContainer=e.first),s.iGM(e=s.CRH())&&(t.summaryElement=e.first),s.iGM(e=s.CRH())&&(t.stepElements=e)}},inputs:{route:"route"},outputs:{heightChanged:"heightChanged"},decls:1,vars:1,consts:[["class","steps-nav",4,"ngIf"],[1,"steps-nav"],[1,"step-nav-nextprev-container"],["role","button","class","step-nav-prev","tabindex","0",3,"click","keydown.enter",4,"ngIf"],["role","menu",1,"steps-navigator"],[1,"indicator",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","button","class","step-nav-next","tabindex","0",3,"click","keydown.enter",4,"ngIf"],[1,"steps-container",3,"ngStyle"],["stepsContainer",""],[1,"steps-container-inner",3,"ngStyle"],[1,"route",3,"route"],["role","button","tabindex","0",1,"step-nav-prev",3,"click","keydown.enter"],["src","images/icons/tab-arrow.svg","mvAccessibleSVG","",3,"titleText"],["role","menuitem",1,"indicator",3,"click"],["role","button","tabindex","0",1,"step-nav-next",3,"click","keydown.enter"],[3,"step","showAlert","showTypeDescription","showDetails","showTypeIcon","showExtraInfo","disableTabIndex","heightChanged"]],template:function(e,t){1&e&&s.YNc(0,wo,12,15,"div",0),2&e&&s.Q6J("ngIf",t.route)},directives:[o.O5,o.sg,o.PC,at,Te.bk,Se.m,Gr],pipes:[_.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-steps-navigator{max-height:55%;overflow-y:auto;-webkit-overflow-scrolling:touch}mv-itinerary-steps-navigator .steps-nav{background:#fff;border-bottom:1px solid #DDDDDD;position:relative;padding:0 20px}mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container{position:relative}mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container .steps-navigator{border-bottom:1px solid #DDDDDD;height:46px;text-align:center}mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container .steps-navigator .indicator{position:relative;display:inline-block;top:14px;padding:0;height:8px;width:8px;border:1px #BDC3C7 solid;border-radius:50%;outline:none;transition:background-color .35s cubic-bezier(.35,0,.25,1);cursor:pointer;box-sizing:border-box}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container .steps-navigator .indicator{margin-right:8px}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container .steps-navigator .indicator{margin-left:8px}mv-itinerary-steps-navigator .steps-nav .step-nav-nextprev-container .steps-navigator .indicator.active{background-color:#bdc3c7}mv-itinerary-steps-navigator .steps-nav .steps-container{position:relative;overflow:hidden;transition:all .3s}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner{display:flex;flex-direction:row;height:100%;position:absolute;top:0;transition:all .3s}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .route,mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner mv-route-step{display:inline-block}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .route-inner .route-time .duration{width:auto}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .route-inner .legs-container{padding:20px 0}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .route-inner .legs-container{margin-left:20px}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .route-inner .legs-container{margin-right:20px}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .content-wrapper{padding-left:0}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .content-wrapper{padding-right:0}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .content-wrapper:after{content:none}mv-itinerary-steps-navigator .steps-nav .steps-container .steps-container-inner .content-wrapper .content{border-bottom:none}mv-itinerary-steps-navigator .steps-nav .steps-container .step-content{overflow:hidden}mv-itinerary-steps-navigator .steps-nav .step-nav-prev{position:absolute;top:50%;transform:translateY(-50%);z-index:1;opacity:1;transition:all .3s}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .step-nav-prev{left:0}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .step-nav-prev{right:0}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .step-nav-prev svg-icon{transform:rotate(0) scaleX(-1)}mv-itinerary-steps-navigator .steps-nav .step-nav-prev svg-icon .cls-1{fill:#737578}mv-itinerary-steps-navigator .steps-nav .step-nav-next{position:absolute;top:50%;transform:translateY(-50%);opacity:1;z-index:1;transition:all .3s}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .step-nav-next{right:0}html[dir=rtl] mv-itinerary-steps-navigator .steps-nav .step-nav-next{left:0}mv-itinerary-steps-navigator .steps-nav .step-nav-next.ng-hide{opacity:0}html[dir=ltr] mv-itinerary-steps-navigator .steps-nav .step-nav-next svg-icon{transform:scaleX(-1)}mv-itinerary-steps-navigator .steps-nav .step-nav-next svg-icon .cls-1{fill:#737578}\n"],encapsulation:2}),e})();function Mo(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"mv-itinerary-steps-navigator",3),s.NdJ("heightChanged",function(){return s.CHM(e),s.oxw().onNavHeightChanged()}),s.qZA()}if(2&e){const e=s.oxw();s.Q6J("route",e.route)}}function Lo(e,t){1&e&&s._UZ(0,"mv-itinerary-map")}function Ao(e,t){if(1&e&&s._UZ(0,"mv-itinerary-mobile-app-cta",4),2&e){const e=s.oxw();s.ekj("open",!e.state.global.mobileItineraryAppCtaMinimized)("min",e.state.global.mobileItineraryAppCtaMinimized),s.Q6J("route",e.route)}}let Io=(()=>{class e{constructor(e,t){this.globalActions=e,this.store=t}get state(){return this.store.getState()}ngOnInit(){this.store.dispatch(this.globalActions.setRouteLegsLoadedState(!1))}ngAfterViewInit(){return(0,r.mG)(this,void 0,void 0,function*(){try{yield(0,te._v)(200),this.stepsNavigator.setHeight()}catch(e){}})}onNavHeightChanged(){this.map.centerMapForRoute()}get route(){return this.store.getState().itinerary.selectedRoute}get isMetroReady(){return!!this.store.getState().metro.currentMetro}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(Ee.l),s.Y36(l.d))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-map-view"]],viewQuery:function(e,t){if(1&e&&(s.Gf(ko,5),s.Gf(yo,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.stepsNavigator=e.first),s.iGM(e=s.CRH())&&(t.map=e.first)}},decls:3,vars:3,consts:[[3,"route","heightChanged",4,"ngIf"],[4,"ngIf"],[3,"route","open","min",4,"ngIf"],[3,"route","heightChanged"],[3,"route"]],template:function(e,t){1&e&&(s.YNc(0,Mo,1,1,"mv-itinerary-steps-navigator",0),s.YNc(1,Lo,1,0,"mv-itinerary-map",1),s.YNc(2,Ao,1,5,"mv-itinerary-mobile-app-cta",2)),2&e&&(s.Q6J("ngIf",t.isMetroReady),s.xp6(1),s.Q6J("ngIf",t.isMetroReady&&t.route),s.xp6(1),s.Q6J("ngIf",!(null!=t.state.customer.currentCustomer&&null!=t.state.customer.currentCustomer.designConfiguration&&t.state.customer.currentCustomer.designConfiguration.hideDirectionsBanner)))},directives:[o.O5,ko,yo,oo],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-map-view{position:relative;height:100%;width:100%;display:flex;flex-direction:column}mv-itinerary-map-view mv-itinerary-mobile-app-cta{z-index:1000}\n"],encapsulation:2}),e})();function Eo(e,t){if(1&e&&(s.TgZ(0,"span",9),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",e.step.subTitle[0].data," ")}}function Co(e,t){if(1&e&&(s.TgZ(0,"span",10),s._uU(1),s.qZA()),2&e){const e=s.oxw(2);s.xp6(1),s.hij(" ",e.step.subTitle[1].data," ")}}function Do(e,t){1&e&&s._UZ(0,"mv-share",11),2&e&&s.Q6J("showCaption",!1)}function Po(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.title)}}function Oo(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.subTitle)}}function No(e,t){if(1&e&&(s.TgZ(0,"div",26),s._uU(1),s.ALo(2,"time"),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,e.departure)," ")}}function Ro(e,t){if(1&e&&(s.TgZ(0,"div",27),s._UZ(1,"span",28),s._uU(2),s.qZA()),2&e){const e=s.oxw().$implicit,t=s.oxw(3);s.xp6(2),s.hij(" ",t.getStepRealTimeDescription(e.rtDepartures)," ")}}function $o(e,t){if(1&e&&(s.TgZ(0,"div"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit,t=s.oxw(3);s.xp6(1),s.Oqu(t.extraData.platforms[e.lineId])}}function Yo(e,t){1&e&&(s.TgZ(0,"span",29),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"one_stop")," "))}const Fo=function(e){return[e]};function Bo(e,t){if(1&e&&(s.TgZ(0,"span",29),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e){const e=s.oxw().$implicit,t=s.oxw(3);s.xp6(1),s.hij(" ",s.xi3(2,1,"many_stops",t.convertToParams(s.VKq(4,Fo,e.lineStopsAmount-1)))," ")}}function Uo(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"span",30),s.NdJ("click",function(t){s.CHM(e);const n=s.oxw().$implicit;return s.oxw(3).onAlertClicked(t,n.serviceAlert)})("keydown.enter",function(t){s.CHM(e);const n=s.oxw().$implicit;return s.oxw(3).onAlertClicked(t,n.serviceAlert)}),s._uU(1),s.qZA()}if(2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.serviceAlert.serviceStatus.desc)}}function Zo(e,t){if(1&e&&(s.TgZ(0,"div",15),s.TgZ(1,"div",16),s.TgZ(2,"div",17),s._UZ(3,"mvf-image",18),s.qZA(),s.TgZ(4,"div",19),s.YNc(5,Po,2,1,"span",0),s.YNc(6,Oo,2,1,"span",0),s.qZA(),s.YNc(7,No,3,3,"div",20),s.YNc(8,Ro,3,1,"div",21),s.qZA(),s.TgZ(9,"div",22),s.YNc(10,$o,2,1,"div",0),s.YNc(11,Yo,3,3,"span",23),s.YNc(12,Bo,3,6,"span",23),s.TgZ(13,"span",24),s._uU(14),s.qZA(),s.qZA(),s.YNc(15,Uo,2,1,"span",25),s.qZA()),2&e){const e=t.$implicit,n=s.oxw(3);s.xp6(3),s.Q6J("imageId",null==e.lineImageData?null:e.lineImageData.id)("params",null==e.lineImageData?null:e.lineImageData.params),s.xp6(2),s.Q6J("ngIf",e.linePresentation.title),s.xp6(1),s.Q6J("ngIf",e.linePresentation.subTitle),s.xp6(1),s.Q6J("ngIf",!e.rtDepartures),s.xp6(1),s.Q6J("ngIf",e.rtDepartures),s.xp6(2),s.Q6J("ngIf",n.extraData.platforms[e.lineId]),s.xp6(1),s.Q6J("ngIf",e.lineStopsAmount<=2),s.xp6(1),s.Q6J("ngIf",e.lineStopsAmount>2),s.xp6(2),s.hij(" ",n.getDurationText(e)," "),s.xp6(1),s.Q6J("ngIf",e.serviceAlert)}}function jo(e,t){if(1&e&&(s.TgZ(0,"div",12),s.TgZ(1,"div",9),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",13),s.YNc(5,Zo,16,11,"div",14),s.qZA(),s.qZA()),2&e){const e=s.oxw(2);s.xp6(2),s.hij(" ",s.lcZ(3,3,"tripplan_itinerary_schedule_header")," "),s.xp6(3),s.Q6J("ngForOf",e.step.upcomingArrivals)("ngForTrackBy",e.trackByIndex)}}function Vo(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.title)}}function Ho(e,t){if(1&e&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(1),s.Oqu(e.linePresentation.subTitle)}}function Go(e,t){if(1&e&&(s.TgZ(0,"div",15),s.TgZ(1,"div",16),s.TgZ(2,"div",17),s._UZ(3,"mvf-image",18),s.qZA(),s.TgZ(4,"div",19),s.YNc(5,Vo,2,1,"span",0),s.YNc(6,Ho,2,1,"span",0),s.qZA(),s.TgZ(7,"div",26),s._uU(8),s.ALo(9,"time"),s.qZA(),s.qZA(),s.qZA()),2&e){const e=t.$implicit;s.xp6(3),s.Q6J("imageId",null==e.lineImageData?null:e.lineImageData.id)("params",null==e.lineImageData?null:e.lineImageData.params),s.xp6(2),s.Q6J("ngIf",e.linePresentation.title),s.xp6(1),s.Q6J("ngIf",e.linePresentation.subTitle),s.xp6(2),s.hij(" ",s.lcZ(9,5,e.departure)," ")}}function zo(e,t){if(1&e&&(s.TgZ(0,"div",12),s.TgZ(1,"div",9),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",13),s.YNc(5,Go,10,7,"div",14),s.qZA(),s.qZA()),2&e){const e=s.oxw(2);s.xp6(2),s.hij(" ",s.lcZ(3,3,"tripplan_itinerary_schedule_full_header")," "),s.xp6(3),s.Q6J("ngForOf",e.step.additionalArrivals)("ngForTrackBy",e.trackByIndex)}}function qo(e,t){if(1&e){const e=s.EpF();s.ynx(0),s.TgZ(1,"div",1),s.TgZ(2,"mv-back-button",2),s.NdJ("backClick",function(){return s.CHM(e),s.oxw().goBack()}),s.qZA(),s.TgZ(3,"div",3),s.YNc(4,Eo,2,1,"span",4),s.YNc(5,Co,2,1,"span",5),s.qZA(),s.YNc(6,Do,1,1,"mv-share",6),s.qZA(),s.TgZ(7,"div",7),s.YNc(8,jo,6,5,"div",8),s.YNc(9,zo,6,5,"div",8),s.qZA(),s.BQk()}if(2&e){const e=s.oxw();s.xp6(2),s.Q6J("showShare",!1)("backText",e.backText),s.xp6(2),s.Q6J("ngIf",e.step.subTitle.length&&e.step.subTitle[0].data),s.xp6(1),s.Q6J("ngIf",e.step.subTitle.length>1&&e.step.subTitle[1].data),s.xp6(1),s.Q6J("ngIf",e.platformService.isDesktop),s.xp6(2),s.Q6J("ngIf",e.step.upcomingArrivals&&e.step.upcomingArrivals.length),s.xp6(1),s.Q6J("ngIf",!e.isShowMinimalData&&e.step.additionalArrivals&&e.step.additionalArrivals.length>0)}}let Jo=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.store=e,this.translate=t,this.itineraryActions=n,this.routingService=i,this.canonicalService=r,this.globalActions=o,this.analyticsService=a,this.platformService=s}get state(){return this.store.getState()}get route(){return this.state.itinerary.selectedRoute}get step(){return this.route&&this.route.steps[this.state.itinerary.selectedStepIndex]}get extraData(){return this.step.extra}get realTimeArrivals(){return this.step.realTimeArrivals}get isShowMinimalData(){return this.state.metro.currentMetro&&(!this.state.metro.currentMetro.features||!this.state.metro.currentMetro.features.LINES_MAP_VIEW)}getDurationText(e){return this.translate.instant("units_minutes_text",{param1:e.lineDuration})}goBack(){let e=this.routingService.getQueryParam("backTo");e=e||D.zA.TRIPPLAN_ITINERARY,this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(this.canonicalService.getPath(e)),{stepIndex:null,backTo:null})}getStepRealTimeDescription(e){const t=e.map(e=>e.departureInMinutes).filter((e,t,n)=>n.indexOf(e)===t);if(1==t.length&&t[0]<=0)return this.translate.instant("now").toLowerCase();const n=t.map(e=>e<=0?this.translate.instant("now").toLowerCase():e);return this.translate.instant("units_minutes_text",{param1:n.join(", ")})}convertToParams(e){return{param1:e[0]}}onAlertClicked(e){e.stopPropagation(),this.store.dispatch(this.itineraryActions.setSelectedRouteStep(this.step.index));const t=this.step.alerts.entities.map(e=>e.entityIdentifier.entityType),n=this.step.alerts.entities.map(e=>e.entityIdentifier.id);this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],D.zA.ALERTS_SINGLE_VIEW),{etype:t.join(","),eid:n.join(",")})}trackByIndex(e){return e}gotoLangSelectorView(){this.closeSideMenu(),this.analyticsService.trackOpenLangSelectorView(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["language",":locale"]))}closeSideMenu(){this.store.dispatch(this.globalActions.setSideMenu(!1))}get currentLocaleId(){const e=this.store.getState();return e.global.selectedLocale&&e.global.selectedLocale.id||""}get localeCode(){return this.currentLocaleId.substr(0,2).toUpperCase()}get isDesktop(){return this.platformService.isDesktop}get backText(){return this.isDesktop?this.translate.instant("action_back"):""}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.d),s.Y36(_.sK),s.Y36(Fe.L),s.Y36(f.Z),s.Y36(R.z),s.Y36(Ee.l),s.Y36(d.y),s.Y36(y.mi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-itinerary-stop-arrivals"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"itinerary-stop-arrivals-header"],[3,"showShare","backText","backClick"],[1,"line-group-header"],["class","title",4,"ngIf"],["class","subtitle",4,"ngIf"],[3,"showCaption",4,"ngIf"],[1,"schedule-wrapper"],["class","section",4,"ngIf"],[1,"title"],[1,"subtitle"],[3,"showCaption"],[1,"section"],[1,"arrivals"],["class","arrival",4,"ngFor","ngForOf","ngForTrackBy"],[1,"arrival"],[1,"line-details"],[1,"line-container"],[3,"imageId","params"],[1,"line-title"],["class","arrival-time",4,"ngIf"],["class","arrival-time realtime",4,"ngIf"],[1,"details"],["class","stops",4,"ngIf"],[1,"duration"],["class","alert","tabindex","0",3,"click","keydown.enter",4,"ngIf"],[1,"arrival-time"],[1,"arrival-time","realtime"],[1,"realtime-icon"],[1,"stops"],["tabindex","0",1,"alert",3,"click","keydown.enter"]],template:function(e,t){1&e&&s.YNc(0,qo,10,7,"ng-container",0),2&e&&s.Q6J("ngIf",t.step)},directives:[o.O5,M.W,Ue.N,o.sg,ue.YY],pipes:[_.X$,nt._x],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-itinerary-stop-arrivals{display:flex;flex-direction:column;position:relative}body.desktop mv-itinerary-stop-arrivals{position:absolute;top:0;bottom:0;left:0;right:0}body.desktop mv-itinerary-stop-arrivals .schedule-wrapper{overflow:auto}body.desktop mv-itinerary-stop-arrivals .schedule-wrapper::-webkit-scrollbar{width:6px;height:6px}body.desktop mv-itinerary-stop-arrivals .schedule-wrapper::-webkit-scrollbar-track{background-color:#f5f7f7}body.desktop mv-itinerary-stop-arrivals .schedule-wrapper::-webkit-scrollbar-thumb{background-color:#bdc3c7}mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{display:flex;align-items:center;width:100%;z-index:9;color:#fff}html body.mobile mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:0px}html.privacy-notice body.mobile mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:calc(0px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:calc(0px + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:calc(0px + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{top:calc(0px + 60px + 4.7058823529rem)}}body.mobile mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header{position:fixed;background:#292A30;height:64px}mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header{color:#292a30;display:block;position:relative;height:auto;min-height:0}html[dir=ltr] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header{padding:10px 20px 10px 0}html[dir=rtl] mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header{padding:10px 0 10px 20px}body.desktop mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header{text-align:center;flex-grow:1;padding:10px 0}mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header .title{display:block;font-size:.8235294118rem;color:#fff}body.desktop mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header .title{color:#292a30}mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header .subtitle{color:#bdc3c7;font-size:.7058823529rem}body.desktop mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header .line-group-header .subtitle{color:#7a7c7f}mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header mv-back-button .back-text{display:inline-block;line-height:60px}body.desktop mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header mv-back-button .back-link{padding:0 20px}body.desktop mv-itinerary-stop-arrivals .itinerary-stop-arrivals-header mv-share{padding:0 20px;min-width:40px}mv-itinerary-stop-arrivals .schedule-wrapper{-webkit-overflow-scrolling:touch;overflow:auto}.has-footer mv-itinerary-stop-arrivals .schedule-wrapper{padding-bottom:60px}mv-itinerary-stop-arrivals .stops-header{background:#292A30;color:#fff;padding:10px 20px;position:relative;height:auto;min-height:auto}html[dir=ltr] mv-itinerary-stop-arrivals .stops-header{padding-left:40px}html[dir=rtl] mv-itinerary-stop-arrivals .stops-header{padding-right:40px}mv-itinerary-stop-arrivals .stops-header .title{display:block;font-size:.8235294118rem}mv-itinerary-stop-arrivals .stops-header .subtitle{color:#bdc3c7;font-size:.7058823529rem}mv-itinerary-stop-arrivals .section{background:#fff}mv-itinerary-stop-arrivals .section:last-of-type{box-shadow:0 2px 2px #0000001a;margin-bottom:32px}mv-itinerary-stop-arrivals .section .title{background:#ECF0F1;display:block;padding:10px 20px}mv-itinerary-stop-arrivals .arrival{padding:16px 20px;position:relative}mv-itinerary-stop-arrivals .arrival:last-of-type:after{display:none}mv-itinerary-stop-arrivals .arrival:after{background:#DDDDDD;bottom:0;content:"";display:block;height:1px;position:absolute;width:calc(100% - 40px)}html[dir=ltr] mv-itinerary-stop-arrivals .arrival:after{left:20px}html[dir=rtl] mv-itinerary-stop-arrivals .arrival:after{right:20px}mv-itinerary-stop-arrivals .line-details{display:table;width:100%}mv-itinerary-stop-arrivals .line-container,mv-itinerary-stop-arrivals .line-title,mv-itinerary-stop-arrivals .arrival-time{display:table-cell;vertical-align:top;width:1px}mv-itinerary-stop-arrivals .line-title{color:#737578;font-size:.8235294118rem;margin-top:4px;padding:4px 8px 0;width:100%}html[dir=ltr] mv-itinerary-stop-arrivals .line-title{padding-right:15px}html[dir=rtl] mv-itinerary-stop-arrivals .line-title{padding-left:15px}mv-itinerary-stop-arrivals .arrival-time{color:#292a30;font-weight:700;padding-top:4px;white-space:nowrap}html[dir=ltr] mv-itinerary-stop-arrivals .arrival-time{text-align:right}html[dir=rtl] mv-itinerary-stop-arrivals .arrival-time{text-align:left}mv-itinerary-stop-arrivals .arrival-time.realtime{color:#038844}mv-itinerary-stop-arrivals .details{color:#737578;font-size:.7058823529rem;margin-top:4px}mv-itinerary-stop-arrivals .stops:after{background:#737578;border-radius:50%;content:"";display:inline-block;height:3px;margin:0 2px;vertical-align:middle;width:3px}mv-itinerary-stop-arrivals .realtime-icon{background:none;border-radius:50%;display:inline-block;height:4px;vertical-align:middle;transform:translateY(-50%);width:4px}html[dir=rtl] mv-itinerary-stop-arrivals .realtime-icon{transform:translateY(-50%) scaleX(-1)}mv-itinerary-stop-arrivals .realtime-icon:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:10px;position:absolute;right:-6px;top:-5px;width:10px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-itinerary-stop-arrivals .realtime-icon:before{-webkit-animation:none;animation:none}}mv-itinerary-stop-arrivals .realtime-icon:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:16px;position:absolute;right:-8px;top:-8px;width:16px;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-itinerary-stop-arrivals .realtime-icon:after{-webkit-animation:none;animation:none}}mv-itinerary-stop-arrivals .alert{font-size:.8235294118rem;color:#292a30;background:#c6522c;border-radius:20px;color:#fff;cursor:pointer;display:inline-block;margin:10px 0 2px;outline:none;padding:6px 8px;position:relative;vertical-align:middle;transition:all,.3s}html[dir=ltr] mv-itinerary-stop-arrivals .alert{padding-right:18px}html[dir=rtl] mv-itinerary-stop-arrivals .alert{padding-left:18px}html[dir=ltr] mv-itinerary-stop-arrivals .alert{padding-left:24px}html[dir=rtl] mv-itinerary-stop-arrivals .alert{padding-right:24px}mv-itinerary-stop-arrivals .alert:before{background-size:contain;content:url(/images/icons/alert-circle.svg);display:inline-block;height:12px;position:absolute;top:50%;vertical-align:middle;width:12px;transform:translateY(-50%)}html[dir=ltr] mv-itinerary-stop-arrivals .alert:before{left:8px}html[dir=rtl] mv-itinerary-stop-arrivals .alert:before{right:8px}html[dir=ltr] mv-itinerary-stop-arrivals .alert:before{margin-right:6px}html[dir=rtl] mv-itinerary-stop-arrivals .alert:before{margin-left:6px}html[dir=ltr] mv-itinerary-stop-arrivals .alert:before{left:7px}html[dir=rtl] mv-itinerary-stop-arrivals .alert:before{right:7px}mv-itinerary-stop-arrivals .alert:after{background:url(/images/icons/alert-arrow.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:9px;position:absolute;top:50%;vertical-align:middle;width:5px;transform:translateY(-50%)}html[dir=ltr] mv-itinerary-stop-arrivals .alert:after{right:8px}html[dir=rtl] mv-itinerary-stop-arrivals .alert:after{left:8px}html[dir=rtl] mv-itinerary-stop-arrivals .alert:after{transform:scaleX(-1);top:10px}mv-itinerary-stop-arrivals .alert:hover{background:#d35f39}\n'],encapsulation:2}),e})();var Wo=n(39885);const Qo=[{path:":lang",component:Ft,data:{subTabId:D.zA.TRIPPLAN_DIRECTIONS}},{path:"tod",children:[{path:"active-ride/:lang",component:En,data:{subTabId:D.zA.TOD_ACTIVE_RIDE}}]},{path:"tod/my-rides",children:[{path:"history-rides/:lang",component:zn,data:{subTabId:D.zA.TOD_HISTORY_RIDES}},{path:"ride-details/:lang",component:ei,data:{subTabId:D.zA.TOD_HISTORY_RIDE_DETAILS}}]},{path:":dirA/:dirB",children:[{path:":lang",component:Ft,data:{subTabId:D.zA.TRIPPLAN_DIRECTIONS}},{path:"tod",children:[{path:"ride-order/:lang",component:Ai,data:{subTabId:D.zA.TOD_RIDE_ORDER}}]},{path:"itinerary-options/:lang",component:Fi,data:{subTabId:D.zA.TRIPPLAN_OPTIONS,fullScreen:!0}},{path:"itinerary/:lang",component:ho,data:{subTabId:D.zA.TRIPPLAN_ITINERARY}},{path:"itinerary-map/:lang",component:Io,data:{subTabId:D.zA.TRIPPLAN_MAP}},{path:"stop-arrivals/:lang",component:Jo,data:{subTabId:D.zA.TRIPPLAN_STOPARRIVALS,fullScreenOnMobile:!0}}]},{path:"**",component:Wo.H,data:{canonicalLanding:D.zA.TRIPPLAN_DIRECTIONS}}]},57166:function(e,t,n){"use strict";n.d(t,{A:function(){return M}});var i=n(13691),r=n(78776),o=n(2316),a=n(1420),s=n(5971),l=n(54364),c=n(79223);function d(e,t){if(1&e&&(o._UZ(0,"span",9),o.ALo(1,"safeHtml")),2&e){const e=o.oxw().$implicit;o.Q6J("innerHTML",o.lcZ(1,1,e.data),o.oJD)}}function u(e,t){if(1&e&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(1),o.Oqu(e.data)}}function p(e,t){if(1&e&&(o.TgZ(0,"span"),o.YNc(1,d,2,3,"span",7),o.YNc(2,u,2,1,"span",8),o.qZA()),2&e){const e=t.$implicit;o.xp6(1),o.Q6J("ngIf",e.isImage),o.xp6(1),o.Q6J("ngIf",!e.isImage)}}function h(e,t){if(1&e&&(o.TgZ(0,"div",5),o.YNc(1,p,3,2,"span",6),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.model.description)("ngForTrackBy",e.trackByIndex)}}let m=(()=>{class e{constructor(e){this.store=e}get state(){return this.store.getState()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.d))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-map-popup-from-to"]],inputs:{model:"model"},decls:7,vars:9,consts:[[1,"content-wrapper"],[1,"location-icon",3,"innerHTML"],[1,"content"],[1,"title"],["class","description",4,"ngIf"],[1,"description"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],[3,"innerHTML"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"div",1),o.ALo(2,"safeHtml"),o.TgZ(3,"div",2),o.TgZ(4,"div",3),o._uU(5),o.qZA(),o.YNc(6,h,2,2,"div",4),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.ekj("bigger-location-icon",null==t.state.customer.currentCustomer||null==t.state.customer.currentCustomer.designConfiguration?null:t.state.customer.currentCustomer.designConfiguration.biggerMapMarkerIcon),o.Q6J("innerHTML",o.lcZ(2,7,t.model.imageHtml),o.oJD),o.xp6(3),o.ekj("bigger-location-title",null==t.state.customer.currentCustomer||null==t.state.customer.currentCustomer.designConfiguration?null:t.state.customer.currentCustomer.designConfiguration.biggerMapMarkerIcon),o.xp6(1),o.Oqu(t.model.title),o.xp6(1),o.Q6J("ngIf",t.model.description))},directives:[l.O5,l.sg],pipes:[c.z],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-map-popup-from-to .content-wrapper{background:#fff;padding:26px 12px;position:relative;text-align:left}html[dir=ltr] mv-map-popup-from-to .content-wrapper{padding-left:18px}html[dir=rtl] mv-map-popup-from-to .content-wrapper{padding-right:18px}mv-map-popup-from-to .content-wrapper .location-icon.bigger-location-icon .line img{width:35px;height:auto}html[dir=ltr] mv-map-popup-from-to .content-wrapper .location-icon.bigger-location-icon+.content{padding-left:46px}html[dir=rtl] mv-map-popup-from-to .content-wrapper .location-icon.bigger-location-icon+.content{padding-right:46px}mv-map-popup-from-to .content-wrapper .content .title.bigger-location-title{font-size:1.1176470588rem}mv-map-popup-from-to .content-wrapper .location-icon{position:absolute;top:50%;transform:translateY(-50%)}html[dir=ltr] mv-map-popup-from-to .content-wrapper .location-icon{left:18px}html[dir=rtl] mv-map-popup-from-to .content-wrapper .location-icon{right:18px}mv-map-popup-from-to .content-wrapper .location-icon img{width:24px}html[dir=ltr] mv-map-popup-from-to .content-wrapper .content{padding-left:41px}html[dir=rtl] mv-map-popup-from-to .content-wrapper .content{padding-right:41px}html[dir=ltr] mv-map-popup-from-to .content-wrapper .content{margin-right:20px}html[dir=rtl] mv-map-popup-from-to .content-wrapper .content{margin-left:20px}mv-map-popup-from-to .content-wrapper .content .title{color:#292a30;font-size:.9411764706rem;line-height:normal}mv-map-popup-from-to .content-wrapper .content .description{font-size:.8235294118rem;color:#737578;line-height:normal;margin-top:4px;display:flex;flex-wrap:wrap;align-items:center}html[dir=ltr] mv-map-popup-from-to .content-wrapper .content .description>span{margin-right:4px}html[dir=rtl] mv-map-popup-from-to .content-wrapper .content .description>span{margin-left:4px}\n"],encapsulation:2}),e})();var g=n(2281),f=n.n(g),v=n(46461),y=n(2339);const b=function(){return{Number:""}},_=function(){return{param1:""}};let T=(()=>{class e{get availableBikes(){return 0===this.model.availableBikes?"web_stations_shared_bike_not_available":1===this.model.availableBikes?"web_stations_shared_bike_available":"web_stations_shared_bikes_available"}get freeDocks(){return 1===this.model.freeDocks?"tripplan_itinerary_bike_station_empty_available_singular_label":"tripplan_itinerary_bike_station_empty_available_label"}get lastUpdate(){return{param1:f()(this.model.lastUpdate).format("HH:mm")}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-map-popup-bike-station"]],inputs:{model:"model"},decls:23,vars:18,consts:[[1,"bike-station"],["mvImg","","src","images/stations/bikes_illustration.png","alt","",1,"top-image"],[1,"station-info"],[1,"available"],[1,"amount"],[1,"text"],[1,"empty-spots"],[1,"provider-info"],[1,"name"],[1,"address"],[1,"updated"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"img",1),o.TgZ(2,"div",2),o.TgZ(3,"div",3),o.TgZ(4,"div",4),o._uU(5),o.qZA(),o.TgZ(6,"div",5),o._uU(7),o.ALo(8,"translate"),o.qZA(),o.qZA(),o.TgZ(9,"div",6),o.TgZ(10,"div",4),o._uU(11),o.qZA(),o.TgZ(12,"div",5),o._uU(13),o.ALo(14,"translate"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(15,"div",7),o.TgZ(16,"div",8),o._uU(17),o.qZA(),o.TgZ(18,"div",9),o._uU(19),o.qZA(),o.TgZ(20,"div",10),o._uU(21),o.ALo(22,"translate"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(5),o.Oqu(t.model.availableBikes),o.xp6(2),o.Oqu(o.xi3(8,7,t.availableBikes,o.DdM(16,b))),o.xp6(4),o.Oqu(t.model.freeDocks),o.xp6(2),o.Oqu(o.xi3(14,10,t.freeDocks,o.DdM(17,_))),o.xp6(4),o.Oqu(t.model.providerName),o.xp6(2),o.Oqu(t.model.address),o.xp6(2),o.Oqu(o.xi3(22,13,"last_refresh",t.lastUpdate)))},directives:[v.X],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-map-popup-bike-station .bike-station{background-color:#fff;display:flex;justify-content:center;flex-wrap:wrap;padding:15px}mv-map-popup-bike-station .bike-station .top-image{width:115px;height:84px;margin:auto}mv-map-popup-bike-station .bike-station .station-info{width:calc(100% - 20px);display:flex;justify-content:space-around;font-size:.8823529412rem;line-height:1.2;font-weight:500;text-align:center;border-bottom:1px solid #ecf0f1}mv-map-popup-bike-station .bike-station .station-info>div{padding:10px;box-sizing:border-box}mv-map-popup-bike-station .bike-station .station-info>div .amount{font-size:1.1176470588rem}mv-map-popup-bike-station .bike-station .station-info>div .text{font-size:.8235294118rem;text-transform:capitalize}mv-map-popup-bike-station .bike-station .station-info>div.available{color:#038844}mv-map-popup-bike-station .bike-station .provider-info{text-align:center;margin-top:10px;color:#525357;font-size:.6470588235rem}mv-map-popup-bike-station .bike-station .provider-info .address{font-size:.8235294118rem;margin:5px 0;font-weight:500}\n"],encapsulation:2}),e})();var S=n(87479);function x(e,t){if(1&e&&o._UZ(0,"mv-map-popup-from-to",2),2&e){const e=o.oxw();o.Q6J("model",e.model)}}function w(e,t){if(1&e&&o._UZ(0,"mv-map-popup-bike-station",2),2&e){const e=o.oxw();o.Q6J("model",e.model)}}function k(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",3),o.TgZ(1,"a",4),o.NdJ("click",function(){return o.CHM(e),o.oxw().showShareDialog()}),o.ALo(2,"translate"),o._UZ(3,"svg-icon",5),o.ALo(4,"translate"),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA()}2&e&&(o.xp6(1),o.uIk("aria-label",o.lcZ(2,4,"action_share_location")),o.xp6(2),o.Q6J("src","images/share/share_icon_new.svg"),o.uIk("alt",o.lcZ(4,6,"a11y_share_link")),o.xp6(2),o.hij(" ",o.lcZ(6,8,"action_share_location")," "))}let M=(()=>{class e{constructor(e,t,n){this.elementRef=e,this.shareService=t,this.store=n,this.model={},this.trackByIndex=i.z8}get state(){return this.store.getState()}getElement(){return this.elementRef.nativeElement}getDir(){return this.state.global.selectedLocale.rtl?"rtl":"ltr"}showShareDialog(){this.shareService.openSharePanel(r.r.Location,this.model.title)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(a.t),o.Y36(s.d))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-map-popup"]],inputs:{model:"model"},decls:4,vars:4,consts:[[3,"model",4,"ngIf"],["class","share",4,"ngIf"],[3,"model"],[1,"share"],[3,"click"],[1,"icon",3,"src"]],template:function(e,t){1&e&&(o.TgZ(0,"div"),o.YNc(1,x,1,1,"mv-map-popup-from-to",0),o.YNc(2,w,1,1,"mv-map-popup-bike-station",0),o.YNc(3,k,7,10,"div",1),o.qZA()),2&e&&(o.uIk("dir",t.getDir()),o.xp6(1),o.Q6J("ngIf",!t.model.isBikeStation),o.xp6(1),o.Q6J("ngIf",t.model.isBikeStation),o.xp6(1),o.Q6J("ngIf",!t.state.customer.currentCustomer.designConfiguration.hideSharing))},directives:[l.O5,m,T,S.bk],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-map-popup{display:block;height:auto;width:297px}mv-map-popup .share{background:#ECF0F1;border-top:1px solid #DDDDDD;font-size:.8235294118rem;font-weight:400;height:32px;line-height:32px;padding:5px;text-align:center}mv-map-popup .share:hover .icon .st0{fill:#0675b3}mv-map-popup .share:hover a{color:#0675b3}mv-map-popup .share .icon svg{height:1.1764705882rem;width:1.1764705882rem;vertical-align:middle}mv-map-popup .share .icon svg .st0{fill:#0895e4;transition:all .3s}mv-map-popup .share a{color:#0895e4;text-decoration:none;transition:all .3s}mv-map-popup .share a:focus{outline:none}\n"],encapsulation:2}),e})()},79573:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var i=n(3786),r=n(99528),o=n(65492),a=n(55754),s=n(86781),l=n(2316),c=n(20314),d=n(43681),u=n(803),p=n(2339),h=n(99902);(0,s.hu)("LocationService");let m=(()=>{class e{constructor(e,t,n,i,r){this.hydrationService=e,this.searchService=t,this.converters=n,this.translate=i,this.httpService=r,this.watchersCounter=0}watchPosition(e,t,n){this.watchersCounter++,this.watchersCounter>1||(this.watchId=navigator.geolocation.watchPosition(t=>{this.lastPosition=t,e(t)},e=>{this.lastPosition=null,t&&t(e)},{enableHighAccuracy:void 0===(null==n?void 0:n.enableHighAccuracy)||n.enableHighAccuracy,timeout:void 0===(null==n?void 0:n.timeout)?5e3:n.timeout,maximumAge:void 0===(null==n?void 0:n.maximumAge)?250:n.maximumAge}))}clearWatch(){this.watchersCounter--,!(this.watchersCounter>0)&&(this.lastPosition=void 0,this.watchId=void 0,navigator.geolocation.clearWatch(this.watchId))}getCurrentLocation(e,t=!0){return(0,i.mG)(this,void 0,void 0,function*(){const n=yield this.updateGeoLocation(e);let i;return t&&(i=(yield this.getMetroIdByGeolocation()).id),{metroId:i,location:n}})}getMetroIdByGeolocation(){return(0,i.mG)(this,void 0,void 0,function*(){const e=yield this.getGeolocationPosition();return this.getMetroIdByCoords(e.coords.latitude,e.coords.longitude)})}getMetroIdByCoords(e,t){return this.httpService.post(o.ZP.MetroSearch,{body:{latitude:e,longitude:t}},!0).toPromise()}updateGeoLocation(e){return(0,i.mG)(this,void 0,void 0,function*(){this.hydrationService.setUseLocation(!0);const e=yield this.getGeolocationPosition();return this.searchForLocation({lat:e.coords.latitude,lng:e.coords.longitude})})}searchForLocation(e){return(0,i.mG)(this,void 0,void 0,function*(){if(!e)return{};const t=yield this.searchService.findAddress(e);if(t){0==t.id&&(t.latLon=a._.toMvLatLon(e));let n=yield this.converters.convertMVSearchResponseItem2TripPlanLocation(t);return n||(n={name:this.translate.instant("map_tapped_location"),address:null,fullName:this.translate.instant("map_tapped_location"),latlng:e,type:r.pc.GEOCODE.toString(),imageHtml:null,inaccurateSearchTerm:null}),n}})}getGeolocationPosition(){return this.lastPosition?Promise.resolve(this.lastPosition):new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>{e(t)},e=>{t(e)})})}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(c.y),l.LFG(d.o),l.LFG(u.J),l.LFG(p.sK),l.LFG(h.O))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},43681:function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var i=n(65492),r=n(55754),o=n(2316),a=n(99902),s=n(26365);let l=(()=>{class e{constructor(e,t){this.httpService=e,this.metroService=t}searchForLocation(e,t,n,o){const a=r._.fromMvLatLon(t.defaultLocation);let s;s=r._.toMvLatLon(o&&o.lat&&o.lng?o:a);const l=this.metroService.isGoogleLocationSearch()?i.bl.GoogleLocationSearch:i.bl.LocationSearch;return this.httpService.post(l,{body:{query:e,latitude:s.latitude,longitude:s.longitude}},!0).toPromise()}findAddress(e){return this.httpService.post(`${i.bl.AddressSearch}`,{body:{latitude:e.lat,longitude:e.lng}},!0).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.O),o.LFG(s.V))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},58876:function(e,t,n){"use strict";n.d(t,{w:function(){return b}});var i=n(3786),r=n(99528),o=n(17184),a=n(55754),s=n(65492),l=n(86781);function c(e){if(!e)return e;const t=JSON.parse(JSON.stringify(e));return function(e){d(e.fromLocation),d(e.toLocation)}(t),t}function d(e){return e.imageHtml=null,e}var u=n(2316),p=n(99902),h=n(32066),m=n(803),g=n(38947),f=n(1437),v=n(79573);const y=(0,l.hu)("SuggestedRoutesService");let b=(()=>{class e{constructor(e,t,n,i,r,o){this.httpService=e,this.imageService=t,this.converters=n,this.errorService=i,this.analyticsService=r,this.locationService=o,this.currentPollToken=null}search(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){const{fromLocation:i,toLocation:r,routeType:l,time:d,transitTypes:u,routeTransportOptions:p}=e;if(y.remote("search BEGIN",c(e)),this.pendingSearchDetails&&this.searchDetailsEqual(this.pendingSearchDetails,e))return y.remote("Search request is the same as pending. Ignoring request"),this.pendingSearchPromise;const h={id:i.id,caption:i.name,latlon:a._.toMvLatLon(i.latlng),type:this.converters.searchTypeToLocationType(parseInt(i.type,10))},m={id:r.id,caption:r.name,latlon:a._.toMvLatLon(r.latlng),type:this.converters.searchTypeToLocationType(parseInt(r.type,10))};this.pendingSearchPromise=this.httpService.get(s.ZP.SuggestedRoutesStart,{tripPlanPref:this.converters.routeTypeToTripPlanPref(l),time:this.converters.serverTimeOf(d.refPoint==o.IV.LeaveNow||d.refPoint==o.IV.Last?new Date:d.when),timeType:this.converters.timeSelectorToTimeType(d),isCurrentTime:d.refPoint==o.IV.LeaveNow,routeTypes:u.join(","),routeTransportOptions:p,fromLocation_id:h.id,fromLocation_type:h.type,fromLocation_latitude:h.latlon.latitude,fromLocation_longitude:h.latlon.longitude,fromLocation_caption:h.caption,toLocation_id:m.id,toLocation_type:m.type,toLocation_latitude:m.latlon.latitude,toLocation_longitude:m.latlon.longitude,toLocation_caption:m.caption},!0).toPromise();try{const i=yield this.pendingSearchPromise;return this.currentPollToken=i.token,this.sendPollRequest({context:i,searchDetails:e,userMetro:t},0,0,n),i}catch(g){n({context:null,error:g})}finally{this.pendingSearchDetails=null,this.pendingSearchPromise=null,y.remote("search END",c(e))}})}sendPollRequest(e,t,n,o){return(0,i.mG)(this,void 0,void 0,function*(){const{context:i,searchDetails:a,userMetro:l}=e;if(this.currentPollToken!==i.token)return void o({context:i,error:"Another search in progress"});let c;n++,y.log("Sending poll request #"+n+"; context = "+i.token);try{c=yield this.httpService.get(s.ZP.SuggestedRoutesPoll,{token:i.token,offset:t},!0).toPromise()}catch(h){throw y.error("Can't get trip plan results. Error = "+h),h}let d=!1,u=[];c.results&&c.results.length>0&&(y.log("Got "+c.results.length+" new route(s)"),y.log(c.results),u=c.results,t+=u.length,d=!0);const p=yield this.handleError(c,a,l);if(p)return o({context:i,error:p}),void this.analyticsService.trackSearchRoutesEnd(null,p.code);if(c.completed)return y.log("Finished polling. resolving with "+u.length+" new routes"),t>0?(o({context:i,isCompleted:!0,results:u}),u):void o({context:i,error:this.errorService.getTranslatedError(r.SM.NoTripPlanFound)});if(n<46){const r=n<=20?200:1e3;if(y.log(`totalPolls = ${n}. Setting next poll to be ${r} ms`),setTimeout(()=>{this.sendPollRequest(e,t,n,o)},r),d)return o({context:i,results:u}),u}else{if(t>0)return y.log("Got "+t+" results"),o({context:i,results:u,isCompleted:!0}),u;y.error("Poll failed after 30 seconds"),o({context:i,error:"no results after 30 seconds"})}})}handleError(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){if(!e.errors||0==e.errors.length)return;const i=e.errors[0].errorCode;if(y.error("Trip plan error: "+i),this.analyticsService.trackError("trip plan search, code: "+i),i!=r.SM.GeocoderResultsOutOfMetroArea&&i!=r.SM.TripPlanOutOfMetroArea)return this.errorService.getTranslatedError(i);{const e=this.locationService.getMetroIdByCoords(t.toLocation.latlng.lat,t.toLocation.latlng.lng),a=this.locationService.getMetroIdByCoords(t.fromLocation.latlng.lat,t.fromLocation.latlng.lng);let s,l;try{[s,l]=yield Promise.all([e,a])}catch(o){return this.errorService.getTranslatedError(i)}if(!s||!l)return this.errorService.getTranslatedError(r.SM.TripPlanOutOfMetroArea);if(l.id===s.id&&l.id!==n.metroAreaId){const e=window.location.href;let t=e.replace(/(metroId=)[^\&]+/,"$1"+s.id);return e.includes("metroId=")||(t+=`&metroId=${s.id}`),this.errorService.getSwitchMetroTranslatedError(n.metroAreaName,s.name,t)}if(l.id!==s.id)return this.errorService.getTranslatedError(r.SM.TripPlanOutOfMetroArea)}})}searchDetailsEqual(e,t){return e.routeType==t.routeType&&(e.time.refPoint==o.IV.LeaveNow||e.time.refPoint==o.IV.Last)&&e.time.refPoint==t.time.refPoint&&e.transitTypes.sort().join()==t.transitTypes.sort().join()&&this.suggestedLocationEqual(e.fromLocation,t.fromLocation)&&this.suggestedLocationEqual(e.toLocation,t.toLocation)}suggestedLocationEqual(e,t){return e.id==t.id&&e.type==t.type&&e.latlng.lat==t.latlng.lat&&e.latlng.lng==t.latlng.lng&&e.name==t.name}getLinesArrivalsToStops(e){return y.log("getLinesArrivalsToStops",e),this.httpService.post(s.ZP.LinesArrival,{body:{params:{lineStopPairs:e}}},!0).toPromise()}generateSuggestedRoutesUrlParams(e){const{fromLocation:t,toLocation:n}=e,i={[r.$h.From]:"from",[r.$h.To]:"to"},o={[r.$h.From]:"fll",[r.$h.To]:"tll"},a={[i[r.$h.From]]:null,[o[r.$h.From]]:null,[i[r.$h.To]]:null,[o[r.$h.To]]:null};return t&&(a[i[r.$h.From]]=t.name,t.latlng&&(a[o[r.$h.From]]=[t.latlng.lat,t.latlng.lng].join("_"))),n&&n.latlng&&(a[i[r.$h.To]]=n.name,a[o[r.$h.To]]=[n.latlng.lat,n.latlng.lng].join("_")),a}getSimilarItinerary(e,t,n,i){return this.httpService.post(s.ZP.ItinerarySimilarRoute,{body:{guid:e,index:t,mode:n,isOriginState:i}},!0).toPromise()}getWalkPolyline(e,t,n){return this.httpService.post(s.ZP.WalkPolyline,{body:{fromLocation:e,toLocation:t,toStopId:n}}).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(p.O),u.LFG(h.KD),u.LFG(m.J),u.LFG(g.T),u.LFG(f.y),u.LFG(v.a))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},58318:function(e,t,n){"use strict";n.d(t,{F:function(){return x}});var i=n(3786),r=n(65492),o=n(2316),a=n(21090),s=n(87479),l=n(2339);let c=(()=>{class e{constructor(e){this.dialogRef=e}dismiss(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.z))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-signup-success"]],decls:11,vars:9,consts:[["src","images/registration/spot-web-registration-success.svg"],[1,"title"],[1,"subtitle"],[1,"step-button",3,"click"]],template:function(e,t){1&e&&(o._UZ(0,"svg-icon",0),o.TgZ(1,"h2",1),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"p",2),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.TgZ(7,"button",3),o.NdJ("click",function(){return t.dismiss()}),o.TgZ(8,"span"),o._uU(9),o.ALo(10,"translate"),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"web_login_success_popup")),o.xp6(3),o.Oqu(o.lcZ(6,5,"web_tod_account_created_message")),o.xp6(4),o.Oqu(o.lcZ(10,7,"got_it")))},directives:[s.bk],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-signup-success .title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;margin:16px 0 0}mv-signup-success .subtitle{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;margin:16px 0 32px;font-weight:400}\n"],encapsulation:2}),e})();var d=n(1437),u=n(83486),p=n(93975),h=n(54364);const m=["freeText"];function g(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"svg-icon",11),o.NdJ("click",function(){const t=o.CHM(e).index;return o.oxw().onStarClicked(t)}),o.qZA()}if(2&e){const e=t.index,n=o.oxw();o.ekj("selected",n.isStarSelected(e)),o.Q6J("titleText",n.isStarSelected(e)?"selected star":"unselected star")}}function f(e,t){if(1&e&&(o.ynx(0),o.TgZ(1,"div",12),o._uU(2),o.ALo(3,"translate"),o.qZA(),o._UZ(4,"textarea",13,14),o.ALo(6,"translate"),o.BQk()),2&e){const e=o.oxw();o.xp6(2),o.Oqu(o.lcZ(3,2,e.stars[e.rating].message)),o.xp6(2),o.Q6J("placeholder",o.lcZ(6,4,e.stars[e.rating].placeHolder))}}let v=(()=>{class e{constructor(e,t){this.dialogRef=e,this.analyticsService=t,this.stars=[{message:"tod_passenger_rate_bad_response",placeHolder:"tod_passenger_rate_bad_placeholder"},{message:"tod_passenger_rate_bad_response",placeHolder:"tod_passenger_rate_bad_placeholder"},{message:"tod_passenger_rate_avg_response",placeHolder:"tod_passenger_rate_avg_placeholder"},{message:"tod_passenger_rate_good_response",placeHolder:"tod_passenger_rate_good_placeholder"},{message:"tod_passenger_rate_great_response",placeHolder:"tod_passenger_rate_great_placeholder"}]}ngOnInit(){this.analytics("TOD_RIDE_RATING_POPUP_IMPRESSION")}get canSubmit(){return this.rating>=0}onStarClicked(e){this.rating=e,this.analytics("TOD_RIDE_RATING_SELECTED")}isStarSelected(e){return e<=this.rating}dismiss(){this.dialogRef.close()}rateRide(){!this.canSubmit||(this.analytics("RATING_SUBMITTED"),this.dialogRef.close({freeText:this.freeText.nativeElement.value,rating:this.rating+1}))}analytics(e){const{rideId:t,providerId:n,rideStatus:i}=this.dialogRef.data;this.analyticsService.sendEvent(d.a.TODPopup,e,[t,this.analyticsService.todMode(i),n,u.YK[i]].join(", "))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.z),o.Y36(d.y))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-tod-rate-popup"]],viewQuery:function(e,t){if(1&e&&o.Gf(m,5),2&e){let e;o.iGM(e=o.CRH())&&(t.freeText=e.first)}},decls:21,vars:22,consts:[["src","images/icons/close.svg","mvAccessibleSVG","",1,"close-icon",3,"titleText","click"],[1,"area"],["src","images/tod/rating/rate-us.svg","mvAccessibleSVG","",1,"bus-icon",3,"titleText"],[1,"popup-title"],[1,"rate-title"],[1,"rate-subtitle"],[1,"stars-container"],["class","star","src","images/tod/rating/star-unselected.svg","mvAccessibleSVG","",3,"selected","titleText","click",4,"ngFor","ngForOf"],[1,"area","rating-message-container"],[4,"ngIf"],[1,"button",3,"click"],["src","images/tod/rating/star-unselected.svg","mvAccessibleSVG","",1,"star",3,"titleText","click"],[1,"message"],[3,"placeholder"],["freeText",""]],template:function(e,t){1&e&&(o.TgZ(0,"svg-icon",0),o.NdJ("click",function(){return t.dismiss()}),o.ALo(1,"translate"),o.qZA(),o.TgZ(2,"div",1),o._UZ(3,"svg-icon",2),o.ALo(4,"translate"),o.TgZ(5,"div",3),o._uU(6),o.ALo(7,"translate"),o.qZA(),o.TgZ(8,"div",4),o._uU(9),o.ALo(10,"translate"),o.qZA(),o.TgZ(11,"div",5),o._uU(12),o.ALo(13,"translate"),o.qZA(),o.TgZ(14,"div",6),o.YNc(15,g,1,3,"svg-icon",7),o.qZA(),o.qZA(),o.TgZ(16,"div",8),o.YNc(17,f,7,6,"ng-container",9),o.qZA(),o.TgZ(18,"button",10),o.NdJ("click",function(){return t.rateRide()}),o._uU(19),o.ALo(20,"translate"),o.qZA()),2&e&&(o.Q6J("titleText",o.lcZ(1,10,"action_cancel")),o.xp6(3),o.Q6J("titleText",o.lcZ(4,12,"a11y_mot_bus_logo")),o.xp6(3),o.Oqu(o.lcZ(7,14,"tod_passenger_end_ride_popup_title")),o.xp6(3),o.Oqu(o.lcZ(10,16,"tod_passenger_rate_title")),o.xp6(3),o.Oqu(o.lcZ(13,18,"tod_passenger_rate_subtitle")),o.xp6(3),o.Q6J("ngForOf",t.stars),o.xp6(2),o.Q6J("ngIf",t.canSubmit),o.xp6(1),o.ekj("disabled",!t.canSubmit),o.xp6(1),o.Oqu(o.lcZ(20,20,"tod_passenger_rate_button")))},directives:[s.bk,p.m,h.sg,h.O5],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-tod-rate-popup{min-width:48px;height:100%;position:relative;display:flex;flex-direction:column}mv-tod-rate-popup .close-icon{position:absolute;top:-5px;padding:8px}html[dir=ltr] mv-tod-rate-popup .close-icon{left:-5px}html[dir=rtl] mv-tod-rate-popup .close-icon{right:-5px}mv-tod-rate-popup .close-icon,mv-tod-rate-popup .close-icon svg{width:12px;height:12px}mv-tod-rate-popup .close-icon path,mv-tod-rate-popup .close-icon svg path{fill:#525357}mv-tod-rate-popup .area{display:flex;flex-direction:column}mv-tod-rate-popup .bus-icon{width:280px;margin:40px auto 24px}mv-tod-rate-popup .popup-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600;text-align:center;margin-bottom:16px}mv-tod-rate-popup .rate-title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;font-weight:600;text-align:center}mv-tod-rate-popup .rate-subtitle{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#7a7c7f;text-align:center}mv-tod-rate-popup .stars-container{display:flex;flex-direction:row;margin:16px auto 0}mv-tod-rate-popup .stars-container .star{height:34px;width:34px;margin:0 5px}mv-tod-rate-popup .stars-container .star.selected path{fill:#f7a20c}mv-tod-rate-popup .rating-message-container{height:177px}mv-tod-rate-popup .rating-message-container.hidden *{display:none}mv-tod-rate-popup .rating-message-container .message{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;margin:34px 0 12px;text-align:center}mv-tod-rate-popup .rating-message-container textarea{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#7a7c7f;height:60px;padding:11px;border-radius:4px;border:solid 1px #BDC3C7}mv-tod-rate-popup .rating-message-container textarea::-moz-placeholder{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#7a7c7f}mv-tod-rate-popup .rating-message-container textarea::placeholder{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#7a7c7f}mv-tod-rate-popup button.button{height:2.5882352941rem;border-radius:4px;background-color:#0a73eb;font-size:.8235294118rem;font-weight:500;line-height:1.25;text-align:center;padding:13px 15px}mv-tod-rate-popup button.button.disabled{background-color:#bdc3c7;color:#fff}\n"],encapsulation:2}),e})(),y=(()=>{class e{}return e.DISMISS_COMPONENT_TIMEOUT=5e3,e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-tod-thanks-for-rating"]],decls:4,vars:4,consts:[["src","images/tod/rating/star-thanks-for-rating.svg","mvAccessibleSVG","",1,"star",3,"titleText"],[1,"text"]],template:function(e,t){1&e&&(o._UZ(0,"svg-icon",0),o.TgZ(1,"div",1),o._uU(2),o.ALo(3,"translate"),o.qZA()),2&e&&(o.Q6J("titleText","icon-star-thanks-for-rating"),o.xp6(2),o.Oqu(o.lcZ(3,2,"tod_passenger_rate_thanks")))},directives:[s.bk,p.m],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.mv-tod-thanks-for-rating-popup-container{padding:14px;background-color:#000}mv-tod-thanks-for-rating{display:flex;flex-direction:column;align-items:center;justify-content:space-between}mv-tod-thanks-for-rating .star{margin-top:5px}mv-tod-thanks-for-rating .text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff;font-weight:600;line-height:1.43;text-align:center}\n"],encapsulation:2}),e})();var b=n(17184),_=n(99902),T=n(5971),S=n(96542);let x=(()=>{class e{constructor(e,t,n,i,r){this.httpService=e,this.store=t,this.dialogService=n,this.interactionService=i,this.analyticsService=r,this.realTimeInfoRefreshTimeInMS=2e3}get userKey(){return this.store.getState().user.account.userKey}placeOrder(e,t,n,i,o,a,s,l,c,d){return this.httpService.post(r.ZP.TodPlaceOrder,{body:{sourceLocation:e,sourceName:t,destinationLocation:n,destinationName:i,userLocation:o,accessible:a,numberOfPassengers:s,todProviderId:l,time:c,timeType:d}}).toPromise()}bookOrder(e,t,n,o){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.TodBookOrder,{body:{rideId:e,price:t,paymentMethodId:n,payOnboard:o}}).toPromise()})}confirmTos(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.TosConfirmation,{body:{userKey:e,context:t,version:n}}).toPromise()})}missingStepsCompletionDialog(){this.dialogService.create(c,{maxWidth:"calc(100% - 44px)",minWidth:"290px",panelClass:"app-popup"})}realTimeInfo(e){return this.httpService.post(r.ZP.TodRealTimeInfo,{body:{rideId:e}}).toPromise()}cancelRide(e){return this.httpService.post(r.ZP.TodCancelRide,{body:{rideId:e}}).toPromise()}myRides(){return this.httpService.get(r.ZP.TodMyRides).toPromise()}rateRide(e,t,n,o){return(0,i.mG)(this,void 0,void 0,function*(){const i=yield this.dialogService.create(v,{maxWidth:"calc(100% - 40px)",minWidth:"290px",panelClass:"app-popup",data:{rideId:e,providerId:t,rideStatus:n,realTimeInfo:o}}).onClose.toPromise();if(!(null==i?void 0:i.rating))return!1;const{freeText:a,rating:s}=i;try{yield this.httpService.post(r.ZP.TodRateRide,{body:{freeText:a,rating:s,rideId:e}}).toPromise()}catch(c){return this.displayError(c,e,t,n,this.rateRide.bind(this,e,t,status),void 0,Object.assign({imageSrc:"images/icons/web-warning-x.svg"},c.error)),!1}const l=this.dialogService.create(y,{maxWidth:"188px",minWidth:"188px",panelClass:["app-popup","mv-tod-thanks-for-rating-popup-container"],height:"96px"});return setTimeout(()=>l.close(),y.DISMISS_COMPONENT_TIMEOUT),!0})}displayError(e,t,n,i,r,o,a,s){var l,c,p;const h=u.OY[null===(l=null==e?void 0:e.error)||void 0===l?void 0:l.code]||(null===(c=null==e?void 0:e.error)||void 0===c?void 0:c.title)||(null===(p=null==e?void 0:e.error)||void 0===p?void 0:p.text)||u.OY[1e3],m=[t,this.analyticsService.todMode(i),n,h].join(", "),g=e=>this.analyticsService.sendEvent(d.a.TODPopup,e,m);g("TOD_POPUP_IMPRESSION"),this.interactionService.displayError(()=>{r&&r(),g("TOD_POPUP_RETRY_CLICKED")},()=>{o&&o(),g("TOD_POPUP_DISMISSED")},a,s)}defaultRideStatus(){return this.store.getState().directions.search.departureOption!==b.IV.LeaveNow?u.Rl.FUTURE:u.Rl.ACTIVE}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(_.O),o.LFG(T.d),o.LFG(a.x),o.LFG(S.k),o.LFG(d.y))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},83486:function(e,t,n){"use strict";n.d(t,{Rl:function(){return i},fL:function(){return r},YK:function(){return o},OY:function(){return a},Zf:function(){return s},pJ:function(){return l}});var i=(()=>{return(e=i||(i={}))[e.ACTIVE=1]="ACTIVE",e[e.CANCELLED=2]="CANCELLED",e[e.COMPLETED=3]="COMPLETED",e[e.NO_SHOW=4]="NO_SHOW",e[e.FUTURE=5]="FUTURE",e[e.DECLINED=6]="DECLINED",i;var e})(),r=(()=>{return(e=r||(r={}))[e.UNKNOWN=1]="UNKNOWN",e[e.HEADING_PICKUP=2]="HEADING_PICKUP",e[e.APPROACHING_PICKUP=3]="APPROACHING_PICKUP",e[e.ARRIVED_PICKUP=4]="ARRIVED_PICKUP",e[e.HEADING_DROP_OFF=5]="HEADING_DROP_OFF",e[e.APPROACHING_DROP_OFF=6]="APPROACHING_DROP_OFF",e[e.ARRIVED_DROP_OFF=7]="ARRIVED_DROP_OFF",r;var e})();const o={1:"ACTIVE",2:"CANCELLED",3:"COMPLETED",4:"NO_SHOW",5:"FUTURE",6:"DECLINED"},a={1e3:"GENERAL_ERROR",1:"OUT_OF_ZONE",2:"OUT_OF_SERVICE_HOURS",3:"NO_AVAILABLE_VEHICLE",4:"DRIVER_TOKEN_EXPIRED",5:"ALREADY_IN_ACTIVE_ORDER",20:"PICKUP_AND_DROP_OFF_TOO_CLOSE",21:"ALREADY_HAS_OFFLINE_ORDER",22:"PAYMENT_CONTEXT_NOT_EXISTS",24:"NO_NEAR_ZONE",31:"OUT_OF_ZONE_PICKUP",32:"OUT_OF_ZONE_DROPOFF",33:"NO_PICKUP_TRANSIT_POINT_IN_SERVICE_AREA_POLYGON",34:"NO_DROPOFF_TRANSIT_POINT_IN_SERVICE_AREA_POLYGON",101:"ORDER_DOES_NOT_EXIST",103:"USER_NOT_AUTHORIZED",107:"ZONE_IS_NOT_SUPPORTED",108:"BLOCKED_PASSENGER",110:"RIDE_NOT_FINISHED",115:"NUMBER_OF_PASSENGERS_EXCEEDED",116:"NUMBER_OF_ACCESSIBLE_PASSENGERS_EXCEEDED",119:"SAME_PICKUP_AND_DROP_OFF",122:"PAYMENT_ERROR",128:"ALLOWED_BOOKING_PERIOD_EXCEEDED"};var s=(()=>{return(e=s||(s={}))[e.ONLINE=0]="ONLINE",e[e.OFFLINE=1]="OFFLINE",e[e.FRG=2]="FRG",e[e.SHUTTLE=3]="SHUTTLE",e[e.InactiveCell=4]="InactiveCell",s;var e})(),l=(()=>{return(e=l||(l={}))[e.ONLINE=0]="ONLINE",e[e.OFFLINE=1]="OFFLINE",e[e.FRG=2]="FRG",e[e.SHUTTLE=3]="SHUTTLE",l;var e})()},72171:function(e,t,n){"use strict";n.d(t,{L:function(){return p}});var i=n(43445),r=n(2316),o=n(1210),a=n(2339),s=n(5971),l=n(87479),c=n(93975),d=n(46461),u=n(79223);let p=(()=>{class e{constructor(e,t,n,i){this.deepLinkService=e,this.translate=t,this.hookService=n,this.store=i}get state(){return this.store.getState()}ngOnInit(){this.hookService.runHooks(i.e.COMPONENT_APP_BLOCKED,this),this.bannerUrl=this.deepLinkService.getStoreOrDeepLink("app-blocked","app-blocked",this.deepLinkService.getDeepLinkType()),this.refreshText=this.translate.instant("app_blocked_refresh",{REFRESH_LINK:`<a id="refresh-link">${this.translate.instant("app_blocked_refresh_action")}</a>`})}ngAfterViewInit(){const e=document.getElementById("refresh-link");e&&e.addEventListener("click",this.onRefreshClick.bind(this))}onRefreshClick(){window.location.reload()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.Qz),r.Y36(a.sK),r.Y36(i.$),r.Y36(s.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-app-blocked"]],decls:28,vars:25,consts:[[1,"heading"],[1,"main-text"],[1,"apps"],["src","images/apple_icon_gray.svg","mvAccessibleSVG","",1,"svg-icon","ios",3,"titleText"],["src","images/android_icon.svg","mvAccessibleSVG","",1,"svg-icon","android",3,"titleText"],[1,"text"],[1,"download-app-wrapper"],[3,"href"],[1,"secondary-text"],[3,"innerHTML"],[1,"bottom-logo-wrapper"],["mvImg","","src","images/moovit_logo_full.svg","alt","moovit logo",1,"logo"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"h2"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"h2"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"div",1),r.TgZ(8,"div",2),r._UZ(9,"svg-icon",3),r.ALo(10,"translate"),r._UZ(11,"svg-icon",4),r.ALo(12,"translate"),r.qZA(),r.TgZ(13,"div",5),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.qZA(),r.TgZ(16,"div",6),r.TgZ(17,"a",7),r._uU(18),r.ALo(19,"translate"),r.qZA(),r.qZA(),r.TgZ(20,"div",8),r.TgZ(21,"p"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r._UZ(24,"p",9),r.ALo(25,"safeHtml"),r.qZA(),r.TgZ(26,"div",10),r._UZ(27,"img",11),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,9,"app_blocked_message_1")),r.xp6(3),r.Oqu(r.lcZ(6,11,"app_blocked_message_2")),r.xp6(4),r.s9C("titleText",r.lcZ(10,13,"ios")),r.xp6(2),r.s9C("titleText",r.lcZ(12,15,"android")),r.xp6(3),r.Oqu(r.lcZ(15,17,"app_blocked_hurry_question")),r.xp6(3),r.Q6J("href",t.bannerUrl,r.LSH),r.xp6(1),r.Oqu(r.lcZ(19,19,"app_blocked_download")),r.xp6(4),r.Oqu(r.lcZ(23,21,"app_blocked_nothing_urgent_question")),r.xp6(2),r.Q6J("innerHTML",r.lcZ(25,23,t.refreshText),r.oJD))},directives:[l.bk,c.m,d.X],pipes:[a.X$,u.z],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-app-blocked{display:flex;flex-direction:column;box-sizing:border-box;margin:20px;padding-bottom:20px}mv-app-blocked .heading{padding:0 0 20px;margin:0 0 20px;border-bottom:1px solid #D3D3D3}mv-app-blocked .heading h2{font-weight:400;font-size:1.2941176471rem;margin:0}mv-app-blocked .main-text{display:flex;align-items:center;font-weight:300;margin-bottom:5px}mv-app-blocked .main-text .apps{order:1;white-space:nowrap}mv-app-blocked .main-text .apps .ios{width:20px}mv-app-blocked .main-text .apps .ios svg{width:17px;height:22px}mv-app-blocked .main-text .apps .ios svg path{fill:#a9a9a9}mv-app-blocked .main-text .apps .android svg{width:22px;height:20px}mv-app-blocked .main-text .apps .android svg path{fill:#aac148}mv-app-blocked .main-text .text{order:3;font-size:.9411764706rem}mv-app-blocked .main-text:after{order:2;content:"";height:20px;margin:0 7px;border-right:1px solid #A9A9A9}mv-app-blocked .download-app-wrapper a{background-color:#2196f3;color:#fff;text-decoration:none;padding:10px 25px;font-weight:500;border-radius:4px;text-align:center;font-size:1.0588235294rem;display:inline-block}mv-app-blocked .secondary-text{margin:15px 0}mv-app-blocked .secondary-text p{font-size:.9411764706rem;font-weight:300}mv-app-blocked .secondary-text p a{color:#2196f3;text-decoration:underline}mv-app-blocked .secondary-text p:first-of-type{margin:10px 0 0}mv-app-blocked .secondary-text p:last-of-type{margin-top:8px}mv-app-blocked .bottom-logo-wrapper .logo{width:76px}\n'],encapsulation:2}),e})()},24813:function(e,t,n){"use strict";n.d(t,{l:function(){return u}});var i=n(2316),r=n(5971),o=n(5306),a=n(10723),s=n(1437),l=n(54364),c=n(2339);function d(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"a",1),i.NdJ("click",function(){return i.CHM(e),i.oxw().onCommunityBannerClick()}),i.TgZ(1,"div",2),i._UZ(2,"img",3),i.qZA(),i.TgZ(3,"div",4),i.TgZ(4,"span",5),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"span",5),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.Q6J("href",e.getCommunityUrl(),i.LSH),i.xp6(5),i.Oqu(i.lcZ(6,3,"web_page_community_supported_banner_title")),i.xp6(3),i.Oqu(i.lcZ(9,5,"web_page_community_banner_subtitle"))}}let u=(()=>{class e{constructor(e,t,n,i){this.store=e,this.universal=t,this.localeService=n,this.analyticsService=i}get state(){return this.store.getState()}getCommunityUrl(){var e;return this.localeService.getCommunityUrl(null===(e=this.state.global.selectedLocale)||void 0===e?void 0:e.id)}onCommunityBannerClick(){this.analyticsService.trackCommunityEvent("join")}get displayCommunityBanner(){var e,t,n,i;return(null===(t=null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.features)||void 0===t?void 0:t.COMMUNITY_SUPPORTED)&&!(null===(i=null===(n=this.state.customer.currentCustomer)||void 0===n?void 0:n.designConfiguration)||void 0===i?void 0:i.hideCommunityBar)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.d),i.Y36(o.p),i.Y36(a.OL),i.Y36(s.y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-community-banner"]],decls:1,vars:1,consts:[["class","community-footer","target","_blank",3,"href","click",4,"ngIf"],["target","_blank",1,"community-footer",3,"href","click"],[1,"footer-image"],["src","/images/banners/community_globe.png","alt","community logo"],[1,"text-container"],[1,"community-text"]],template:function(e,t){1&e&&i.YNc(0,d,10,7,"a",0),2&e&&i.Q6J("ngIf",t.displayCommunityBanner)},directives:[l.O5],pipes:[c.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-community-banner{position:relative;z-index:1}mv-community-banner .community-footer{position:relative;box-shadow:0 -1px 2px #0000004d;box-sizing:border-box;display:table;height:67px;overflow:hidden;background:#e5f8fe;padding:10px 20px;text-decoration:none;width:100%}html[dir=ltr] mv-community-banner .community-footer{padding-right:60px}html[dir=rtl] mv-community-banner .community-footer{padding-left:60px}mv-community-banner .community-footer:hover{cursor:pointer}mv-community-banner .community-footer .footer-image{top:0;height:100%;width:60px;transform:none}mv-community-banner .community-footer .footer-image img{position:absolute;top:50%;transform:translateY(-50%)}html[dir=rtl] mv-community-banner .community-footer .footer-image img{transform:scaleX(-1) translateY(-50%)}mv-community-banner .community-footer .community-text:first-of-type{font-size:.9411764706rem;font-weight:500;margin-top:0}mv-community-banner .community-footer .footer-image{overflow:hidden;position:absolute;top:calc(50% + 3px);width:70px;transform:translateY(-50%)}html[dir=ltr] mv-community-banner .community-footer .footer-image{right:0}html[dir=rtl] mv-community-banner .community-footer .footer-image{left:0}mv-community-banner .community-footer .text-container{display:table-cell;vertical-align:middle;width:100%}mv-community-banner .community-footer .community-text{border-radius:3px;box-sizing:border-box;color:#292a30;display:table;font-size:.7647058824rem;margin-top:3px;width:calc(100% - 35px)}html[dir=rtl] mv-community-banner .community-footer .community-text{margin-top:2px}\n"],encapsulation:2}),e})()},7964:function(e,t,n){"use strict";n.d(t,{o:function(){return d}});var i=n(2316),r=n(5242),o=n(1238),a=n(5971),s=n(2339),l=n(87479),c=n(93975);let d=(()=>{class e{constructor(e,t,n,i){this.privacyService=e,this.globalActions=t,this.store=n,this.translate=i}get state(){return this.store.getState()}get cookiesPolicyLink(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration&&this.state.customer.currentCustomer.designConfiguration.cookiesPolicyUrl?this.state.customer.currentCustomer.designConfiguration.cookiesPolicyUrl:this.translate.instant("web_cookies_policy_text_url")}dismiss(){this.privacyService.setPrivacyConsent(),this.store.dispatch(this.globalActions.setPrivacyNotice(!1))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.h),i.Y36(o.l),i.Y36(a.d),i.Y36(s.sK))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-cookie-banner"]],decls:9,vars:10,consts:[["tabindex","0",1,"dismiss",3,"click","keydown.enter"],["src","images/icons/close.svg","mvAccessibleSVG","",3,"titleText"],["target","_blank",1,"cc-link",3,"href"]],template:function(e,t){1&e&&(i.TgZ(0,"a",0),i.NdJ("click",function(){return t.dismiss()})("keydown.enter",function(){return t.dismiss()}),i._UZ(1,"svg-icon",1),i.ALo(2,"translate"),i.qZA(),i.TgZ(3,"span"),i._uU(4),i.ALo(5,"translate"),i.TgZ(6,"a",2),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.qZA()),2&e&&(i.xp6(1),i.s9C("titleText",i.lcZ(2,4,"action_close")),i.xp6(3),i.hij(" ",i.lcZ(5,6,"web_cookies_policy_text")," "),i.xp6(2),i.Q6J("href",t.cookiesPolicyLink,i.LSH),i.xp6(1),i.hij(" ",i.lcZ(8,8,"web_cookies_policy_text_hyperlink")," "))},directives:[l.bk,c.m],pipes:[s.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-cookie-banner{position:fixed;left:0;right:0;display:flex;align-items:center;flex-wrap:wrap;color:#fff;background-color:#292a30;padding:5px 20px;height:4.7058823529rem;border-radius:0;font-size:.8823529412rem;transition:all .3s;overflow:hidden;line-height:1.2em;z-index:99999;box-sizing:border-box;font-family:Helvetica,Calibri,Arial,sans-serif}body.mobile mv-cookie-banner{top:0}body.desktop mv-cookie-banner{bottom:0}@media only screen and (max-width: 320px){mv-cookie-banner{height:4.7058823529rem20px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-cookie-banner{height:2.9411764706rem}}mv-cookie-banner .dismiss{display:block;position:absolute;top:8px}html[dir=ltr] mv-cookie-banner .dismiss{right:8px}html[dir=rtl] mv-cookie-banner .dismiss{left:8px}mv-cookie-banner .dismiss svg-icon{width:12px;height:12px}mv-cookie-banner .dismiss svg-icon svg rect{fill:#fff}mv-cookie-banner a.cc-link{color:#fffc}\n"],encapsulation:2}),e})()},93373:function(e,t,n){"use strict";n.d(t,{J:function(){return b}});var i=n(52959),r=n(36179),o=n(87897),a=n(2316),s=n(1210),l=n(1437),c=n(1238),d=n(5306),u=n(5971),p=n(2339),h=n(15208),m=n(54364),g=n(46461),f=n(97192);function v(e,t){if(1&e){const e=a.EpF();a.ynx(0),a.TgZ(1,"button",2),a.NdJ("click",function(){return a.CHM(e),a.oxw().close()}),a.ALo(2,"translate"),a.qZA(),a.TgZ(3,"a",3),a.NdJ("click",function(){return a.CHM(e),a.oxw().onBannerClick()})("keydown.enter",function(){return a.CHM(e),a.oxw().onBannerClick()}),a.ALo(4,"translate"),a.TgZ(5,"div",4),a.TgZ(6,"div",5),a._UZ(7,"img",6),a.TgZ(8,"div",7),a._uU(9),a.qZA(),a.qZA(),a.TgZ(10,"div",8),a._UZ(11,"img",9),a.qZA(),a.qZA(),a.qZA(),a.BQk()}if(2&e){const e=a.oxw();a.xp6(1),a.uIk("aria-label",a.lcZ(2,6,"close")),a.xp6(2),a.Q6J("href",e.bannerUrl,a.LSH),a.uIk("aria-label",a.lcZ(4,8,"download_button")),a.xp6(6),a.Oqu(e.titleText()),a.xp6(2),a.Q6J("src",e.bannerImage,a.LSH)("alt",e.altText)}}function y(e,t){if(1&e&&(a.TgZ(0,"div",4),a.TgZ(1,"div",5),a._UZ(2,"img",6),a.TgZ(3,"div",7),a._uU(4),a.qZA(),a.qZA(),a._UZ(5,"mv-download-app-qr",10),a.qZA()),2&e){const e=a.oxw();a.xp6(4),a.Oqu(e.titleText()),a.xp6(1),a.Q6J("options",e.qrParams)}}let b=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this._cd=e,this.deepLinkService=t,this.analyticsService=n,this.globalActions=i,this.universal=r,this.store=o,this.urlGeneratorService=a,this.translate=s,this.platformService=l,this.qrParams={promoKey:"web_scan_qr",displayDirection:"top"}}get state(){return this.store.getState()}ngOnInit(){this.universal.isBrowser&&(0,i.wZ)().then(()=>{this.runChangeDetection(),this.redux$=this.store.subscribe(()=>this.runChangeDetection())})}ngOnDestroy(){this.redux$&&this.redux$()}runChangeDetection(){this._cd.destroyed?this.redux$&&this.redux$():this._cd.detectChanges()}get bannerUrl(){return this.deepLinkService.getStoreOrDeepLink("footer","footer",this.deepLinkService.getDeepLinkType())}onBannerClick(){this.analyticsService.trackStoreClick("partners_banner_download")}close(){this.store.dispatch(this.globalActions.setDownloadAppPartnersBannerState(!1)),this.analyticsService.trackUserEvent("close_partners_banner",(0,r.gn)()?"Apple":"Google")}get bannerImage(){const e=(0,r.gn)()?o.g.AppleStore:o.g.GooglePlay;return this.urlGeneratorService.getBadge(e)}get altText(){const e=(0,r.gn)()?"ios":"android";return this.translate.instant(e)}titleText(){var e,t,n;const i=(null===(t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration)||void 0===t?void 0:t.isShowCustomDesktopTripPlanBanner)?`web_download_${null===(n=this.state.customer.currentCustomer)||void 0===n?void 0:n.name.toLowerCase()}`:"web_download_moovit";return this.translate.instant(i)}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.sBO),a.Y36(s.Qz),a.Y36(l.y),a.Y36(c.l),a.Y36(d.p),a.Y36(u.d),a.Y36(o.o),a.Y36(p.sK),a.Y36(h.mi))},e.\u0275cmp=a.Xpm({type:e,selectors:[["mv-download-app-partners-banner"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["desktopPartnersBanner",""],[1,"minimize-btn",3,"click"],["target","_top","tabindex","0",1,"cover-link",3,"href","click","keydown.enter"],[1,"cta-wrapper"],[1,"app-text-container"],["mvImg","","src","images/moovit_logo_full.svg","alt","moovit logo",1,"logo"],[1,"title"],[1,"app-button-container"],["mvImg","",1,"store-image",3,"src","alt"],[3,"options"]],template:function(e,t){if(1&e&&(a.YNc(0,v,12,10,"ng-container",0),a.YNc(1,y,6,2,"ng-template",null,1,a.W1O)),2&e){const e=a.MAs(2);a.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",e)}},directives:[m.O5,g.X,f.w4],pipes:[p.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-mobile-app-cta,mv-itinerary-mobile-app-cta{bottom:0;left:0;position:fixed;width:100%;z-index:9;box-sizing:border-box;transform:translate(0);text-align:center}mv-mobile-app-cta .minimize-wrapper,mv-itinerary-mobile-app-cta .minimize-wrapper{transition:all .5s;transition-delay:.1s}mv-mobile-app-cta .minimize-wrapper .minimize-btn,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn{border:0;width:2.3529411765rem;height:2.3529411765rem;opacity:0;padding:0;z-index:9999;position:relative;top:-1.1764705882rem}mv-mobile-app-cta .minimize-wrapper .minimize-btn:before,mv-mobile-app-cta .minimize-wrapper .minimize-btn:after,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn:before,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn:after{content:"";display:block;width:100%;height:100%;top:0}mv-mobile-app-cta .minimize-wrapper .minimize-btn:before,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn:before{border-radius:50%;transform:scale(.7)}mv-mobile-app-cta .minimize-wrapper .minimize-btn:after,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn:after{position:absolute;background:no-repeat url(/images/icons/down-arrow.svg) center/.7058823529rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta .minimize-wrapper .minimize-btn,mv-itinerary-mobile-app-cta .minimize-wrapper .minimize-btn{top:-1.0588235294rem;width:2.0588235294rem;height:2.0588235294rem}}mv-mobile-app-cta .app-text-container,mv-itinerary-mobile-app-cta .app-text-container{position:relative;z-index:10;margin-bottom:.3em}mv-mobile-app-cta .app-button-container,mv-itinerary-mobile-app-cta .app-button-container{z-index:9999}mv-mobile-app-cta .app-button-container a,mv-itinerary-mobile-app-cta .app-button-container a{background-color:transparent;margin-bottom:0;border:0;text-decoration:none;display:inline-block;font-weight:bold}@-webkit-keyframes slide-up-banner{0%{transform:translateY(120%)}to{transform:translateY(0)}}@keyframes slide-up-banner{0%{transform:translateY(120%)}to{transform:translateY(0)}}mv-mobile-app-cta.open .minimize-wrapper,mv-itinerary-mobile-app-cta.open .minimize-wrapper{height:22px;background-color:transparent}mv-mobile-app-cta.open .minimize-wrapper .minimize-btn,mv-itinerary-mobile-app-cta.open .minimize-wrapper .minimize-btn{position:relative;opacity:1;margin:0 auto 1em}mv-mobile-app-cta.open .cta-wrapper,mv-itinerary-mobile-app-cta.open .cta-wrapper{display:inline-block;max-width:70%}html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper,html[dir=ltr] mv-itinerary-mobile-app-cta.open .cta-wrapper{padding-left:115px}html[dir=rtl] mv-mobile-app-cta.open .cta-wrapper,html[dir=rtl] mv-itinerary-mobile-app-cta.open .cta-wrapper{padding-right:115px}mv-mobile-app-cta.open .cta-wrapper .app-text-container,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container{margin-bottom:13px}mv-mobile-app-cta.open .cta-wrapper .app-text-container:after,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container:after{content:"";position:absolute;z-index:-1;opacity:1;transition:all .5s}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .cta-wrapper .app-text-container:after,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container:after{transform:scale(.9)}}mv-mobile-app-cta.open .cta-wrapper .app-text-container button,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container button{padding:8px 20px 9px}mv-mobile-app-cta.open .cta-wrapper .app-text-container .title,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container .title{display:inline-block}mv-mobile-app-cta.open .cta-wrapper .app-button-container a,mv-itinerary-mobile-app-cta.open .cta-wrapper .app-button-container a{border-radius:4px;white-space:nowrap}html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper .app-text-container,html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper .app-button-container,html[dir=ltr] mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container,html[dir=ltr] mv-itinerary-mobile-app-cta.open .cta-wrapper .app-button-container{text-align:left}html[dir=rtl] mv-mobile-app-cta.open .cta-wrapper .app-text-container,html[dir=rtl] mv-mobile-app-cta.open .cta-wrapper .app-button-container,html[dir=rtl] mv-itinerary-mobile-app-cta.open .cta-wrapper .app-text-container,html[dir=rtl] mv-itinerary-mobile-app-cta.open .cta-wrapper .app-button-container{text-align:right}mv-mobile-app-cta.min,mv-itinerary-mobile-app-cta.min{min-height:20px;padding:0;transition:all .3s}mv-mobile-app-cta.min .minimize-wrapper,mv-itinerary-mobile-app-cta.min .minimize-wrapper{height:2px;transition:all .5s;transition-delay:.3s}mv-mobile-app-cta.min .minimize-wrapper .minimize-btn,mv-itinerary-mobile-app-cta.min .minimize-wrapper .minimize-btn{transition:all .5s;transition-delay:.3s;height:0;width:100%;opacity:0;border-radius:50%;background-color:transparent;background-position:bottom;outline:none}mv-mobile-app-cta.min .app-text-container,mv-itinerary-mobile-app-cta.min .app-text-container{display:none}mv-mobile-app-cta.min .app-button-container button,mv-itinerary-mobile-app-cta.min .app-button-container button{background-color:transparent;font-size:.7647058824rem;font-weight:600;margin-bottom:0;padding:4px 15px;transition:all .5s ease-out}mv-mobile-app-cta.min .app-button-container a,mv-itinerary-mobile-app-cta.min .app-button-container a{padding:4px 15px}mv-mobile-app-cta.min .app-button-container a:focus,mv-itinerary-mobile-app-cta.min .app-button-container a:focus{border:inset}mv-mobile-app-cta.min .app-button-container a:hover,mv-itinerary-mobile-app-cta.min .app-button-container a:hover{border:none}mv-download-app-partners-banner{bottom:0;left:0;opacity:1;width:100%;z-index:9;transition:transform .3s ease-out}body.mobile mv-download-app-partners-banner{position:fixed}body.desktop mv-download-app-partners-banner{position:absolute;min-height:5.2941176471rem}mv-download-app-partners-banner .cover-link{text-decoration:none}mv-download-app-partners-banner .minimize-btn{position:absolute;top:-20px;left:0;right:0;margin:auto;height:40px;width:40px;border-radius:50%;transform:scale(.7);box-shadow:0 2px 4px 1px #0006;background:#fff no-repeat url(/images/icons/close.svg) center/17px}body.desktop mv-download-app-partners-banner .minimize-btn{display:none}mv-download-app-partners-banner .cta-wrapper{background-color:#fff;box-shadow:0 -1px 4px #0000005e;color:#292a30;padding:20px;font-weight:700;display:flex;justify-content:space-between;align-items:center;width:100%;box-sizing:border-box}body.desktop mv-download-app-partners-banner .cta-wrapper{height:5.2941176471rem}mv-download-app-partners-banner .cta-wrapper img.store-image{width:100px}html[dir=ltr] mv-download-app-partners-banner .cta-wrapper .app-text-container{padding-right:15px}html[dir=rtl] mv-download-app-partners-banner .cta-wrapper .app-text-container{padding-left:15px}mv-download-app-partners-banner .cta-wrapper .app-text-container .logo{width:67px}mv-download-app-partners-banner.init{-webkit-animation:slide-up-banner .8s forwards 3s cubic-bezier(.3,1,.6,1);-webkit-animation-fill-mode:both;animation:slide-up-banner .8s forwards 3s cubic-bezier(.3,1,.6,1);animation-fill-mode:both}mv-download-app-partners-banner.min{display:none}mv-download-app-partners-banner mv-download-app-qr .qr-links{justify-content:flex-end;flex-wrap:wrap-reverse}mv-download-app-partners-banner mv-download-app-qr .qr-links .scan-qr-code{width:auto;opacity:1;transition:all .4s;margin:0 0 3px 6px}html[dir=rtl] mv-download-app-partners-banner mv-download-app-qr .qr-links .scan-qr-code{margin:0 6px 3px 0}mv-download-app-partners-banner mv-download-app-qr .qr-links .scan-qr-code .scan-qr-link{color:inherit;text-decoration:underline;font-size:.6470588235rem;white-space:nowrap}mv-download-app-partners-banner mv-download-app-qr .qr-links .scan-qr-code .scan-qr-link:focus{outline:auto}mv-download-app-partners-banner mv-download-app-qr .qr-links .qr-icon:focus{outline:1px solid #fff}mv-download-app-partners-banner mv-download-app-qr .qr-links .banner-download-options{display:flex;align-items:flex-start}mv-download-app-partners-banner mv-download-app-qr .qr-links .banner-download-options .app-store{filter:brightness(.9);width:.7058823529rem;height:1rem}mv-download-app-partners-banner mv-download-app-qr .qr-links .banner-download-options .play-store{width:1.0588235294rem}mv-download-app-partners-banner mv-download-app-qr .qr-links .banner-download-options .store-action-button{display:block}body.c_13193 mv-download-app-partners-banner .app-text-container .logo{content:url(/images/partners/arriva_glimble_logo.png);width:83px}\n'],encapsulation:2,changeDetection:0}),e})()},23052:function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var i=n(2316),r=n(21090),o=n(54364),a=n(87479),s=n(93975),l=n(2339);function c(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"svg-icon",6),i.NdJ("click",function(){return i.CHM(e),i.oxw().decline()}),i.ALo(1,"translate"),i.qZA()}2&e&&i.Q6J("titleText",i.lcZ(1,1,"action_cancel"))}function d(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"button",7),i.NdJ("click",function(){return i.CHM(e),i.oxw().decline()}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&e){const e=i.oxw();i.xp6(1),i.hij(" ",i.lcZ(2,1,e.errorContent.undoButtonText||"action_cancel"),"\n")}}let u=(()=>{class e{constructor(e){this.dialogRef=e}get errorContent(){return this.dialogRef.data.errorContent}get shouldShowCloseIcon(){return this.dialogRef.data.shouldShowCloseIcon}get isWarningMessage(){return this.dialogRef.data.isWarningMessage}get imageSrc(){return this.errorContent.imageSrc}retry(){this.dialogRef.close("retry")}decline(){this.dialogRef.close("")}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.z))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-error-message-dialog"]],decls:10,vars:8,consts:[["class","close-icon","src","images/icons/close.svg","mvAccessibleSVG","",3,"titleText","click",4,"ngIf"],[1,"error-icon",3,"src"],[1,"error-header"],[1,"error-text"],[1,"allow",3,"click"],["class","decline",3,"click",4,"ngIf"],["src","images/icons/close.svg","mvAccessibleSVG","",1,"close-icon",3,"titleText","click"],[1,"decline",3,"click"]],template:function(e,t){1&e&&(i.YNc(0,c,2,3,"svg-icon",0),i._UZ(1,"svg-icon",1),i.TgZ(2,"h2",2),i._uU(3),i.qZA(),i.TgZ(4,"p",3),i._uU(5),i.qZA(),i.TgZ(6,"button",4),i.NdJ("click",function(){return t.retry()}),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.YNc(9,d,3,3,"button",5)),2&e&&(i.Q6J("ngIf",t.shouldShowCloseIcon),i.xp6(1),i.Q6J("src",t.imageSrc),i.xp6(2),i.Oqu(t.errorContent.title),i.xp6(2),i.Oqu(t.errorContent.text),i.xp6(2),i.Oqu(i.lcZ(8,6,t.errorContent.doButtonText||"action_try_again")),i.xp6(2),i.Q6J("ngIf",t.isWarningMessage))},directives:[o.O5,a.bk,s.m],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-error-message-dialog{position:relative}mv-error-message-dialog .permission-img{padding:10%}mv-error-message-dialog .close-icon{position:absolute;top:-5px;padding:8px}html[dir=ltr] mv-error-message-dialog .close-icon{left:-5px}html[dir=rtl] mv-error-message-dialog .close-icon{right:-5px}mv-error-message-dialog .close-icon,mv-error-message-dialog .close-icon svg{width:12px;height:12px}mv-error-message-dialog .close-icon path,mv-error-message-dialog .close-icon svg path{fill:#525357}mv-error-message-dialog .error-icon{margin-top:20px}mv-error-message-dialog h2{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600;margin:24px 0 0}mv-error-message-dialog .error-text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;margin:16px 0 0;font-weight:400}mv-error-message-dialog button.allow,mv-error-message-dialog button.decline{width:100%;font-size:.8235294118rem;font-weight:500;height:auto}mv-error-message-dialog button.allow{background-color:#2196f3;color:#fff;border-radius:5px;padding:13px 16px;margin-top:20px}mv-error-message-dialog button.decline{color:#2196f3;padding:19px 0 8px;margin-top:6px;background:none}mv-error-message-dialog button.decline:active{background:none}\n"],encapsulation:2}),e})()},98751:function(e,t,n){"use strict";n.d(t,{G:function(){return K}});var i=n(16438),r=n(5),o=n(2316),a=n(21090),s=n(41187),l=n(5971),c=n(87479),d=n(2339);let u=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.userActions=t,this.store=n}logout(){this.store.dispatch(this.userActions.logout()),this.dialogRef.close()}dismiss(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.z),o.Y36(s.E),o.Y36(l.d))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-logout"]],decls:10,vars:9,consts:[["src","images/icons/web-warning.svg"],[3,"click"],[1,"invert",3,"click"]],template:function(e,t){1&e&&(o._UZ(0,"svg-icon",0),o.TgZ(1,"p"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"button",1),o.NdJ("click",function(){return t.logout()}),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.TgZ(7,"button",2),o.NdJ("click",function(){return t.dismiss()}),o._uU(8),o.ALo(9,"translate"),o.qZA()),2&e&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"web_login_disconnect_popup")),o.xp6(3),o.Oqu(o.lcZ(6,5,"yes")),o.xp6(3),o.Oqu(o.lcZ(9,7,"no")))},directives:[c.bk],pipes:[d.X$],styles:[""],encapsulation:2}),e})();var p=n(54364),h=n(93767),m=n(17184),g=n(95505),f=n(7935),v=n(1238),y=n(1437),b=n(61787),_=n(99957),T=n(22213),S=n(15208),x=n(93975),w=n(46461),k=n(97971),M=n(99642),L=n(19581);function A(e,t){if(1&e&&(o.TgZ(0,"a",5),o._UZ(1,"svg-icon",6),o.ALo(2,"translate"),o.qZA()),2&e){const e=o.oxw();o.Q6J("href",e.headerBackURL,o.LSH),o.xp6(1),o.s9C("titleText",o.lcZ(2,2,"action_close"))}}function I(e,t){if(1&e&&o._UZ(0,"svg-icon",9),2&e){const e=o.oxw(2);o.Q6J("src",null==e.customer?null:e.customer.designConfiguration.logo)}}function E(e,t){if(1&e&&o._UZ(0,"img",10),2&e){const e=o.oxw(2);o.Q6J("src",null==e.customer?null:e.customer.designConfiguration.logo,o.LSH)}}function C(e,t){if(1&e&&(o.YNc(0,I,1,1,"svg-icon",7),o.YNc(1,E,1,1,"img",8)),2&e){const e=o.oxw();o.Q6J("ngIf",null==e.customer?null:e.customer.designConfiguration.isLogoSVG),o.xp6(1),o.Q6J("ngIf",!(null!=e.customer&&e.customer.designConfiguration.isLogoSVG))}}function D(e,t){1&e&&o.GkF(0)}function P(e,t){if(1&e&&(o.TgZ(0,"a",17),o.YNc(1,D,1,0,"ng-container",18),o.qZA()),2&e){const e=o.oxw(2),t=o.MAs(3);o.Q6J("href",null==e.customer?null:e.customer.designConfiguration.logoLink,o.LSH),o.xp6(1),o.Q6J("ngTemplateOutlet",t)}}function O(e,t){1&e&&o.GkF(0)}function N(e,t){if(1&e&&(o.ynx(0),o.YNc(1,O,1,0,"ng-container",18),o.BQk()),2&e){o.oxw(3);const e=o.MAs(3);o.xp6(1),o.Q6J("ngTemplateOutlet",e)}}function R(e,t){if(1&e&&(o.TgZ(0,"a",19),o.YNc(1,N,2,1,"ng-container",4),o.qZA()),2&e){const e=o.oxw(2);o.Q6J("href",e.getLogoUrl(),o.LSH),o.xp6(1),o.Q6J("ngIf",!(null!=e.customer&&e.customer.designConfiguration.logoLink))}}function $(e,t){1&e&&(o.TgZ(0,"mv-metro-switcher"),o._UZ(1,"svg-icon",6),o.ALo(2,"translate"),o.qZA()),2&e&&(o.xp6(1),o.s9C("titleText",o.lcZ(2,1,"change_metro_title")))}function Y(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"a",23),o.NdJ("click",function(){return o.CHM(e),o.oxw(3).openRegisterLoginFlow("register")}),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"span"),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA()}2&e&&(o.xp6(2),o.hij("",o.lcZ(3,2,"register"),"\xa0/\xa0"),o.xp6(3),o.Oqu(o.lcZ(6,4,"user_account_login")))}function F(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"a",23),o.NdJ("click",function(){return o.CHM(e),o.oxw(3).openRegisterLoginFlow("login")}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&e&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"user_account_login")))}function B(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"a",24),o.NdJ("click",function(){return o.CHM(e),o.oxw(3).onLogout()}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&e&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"web_log_out")))}function U(e,t){if(1&e&&(o.TgZ(0,"div",20),o.YNc(1,Y,7,6,"a",21),o.YNc(2,F,3,3,"a",21),o.YNc(3,B,3,3,"a",22),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",e.state.user.accountStatus===e.AccountStatus.Guest),o.xp6(1),o.Q6J("ngIf",e.state.user.accountStatus===e.AccountStatus.Recognised),o.xp6(1),o.Q6J("ngIf",e.state.user.accountStatus===e.AccountStatus.Authenticated)}}function Z(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",25),o.NdJ("click",function(t){return o.CHM(e),o.oxw(2).openSideMenu(t)})("keydown.enter",function(t){return o.CHM(e),o.oxw(2).openSideMenu(t)}),o.ALo(1,"translate"),o._UZ(2,"svg-icon",26),o.ALo(3,"translate"),o.qZA()}if(2&e){const e=o.oxw(2);o.uIk("aria-label",o.lcZ(1,3,"a11y_toggle_navigation")),o.xp6(2),o.s9C("titleText",o.lcZ(3,5,"a11y_toggle_navigation")),o.Q6J("src",e.toggleNavIcon)}}function j(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"a",27),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).gotoLangSelectorView()})("keydown.enter",function(){return o.CHM(e),o.oxw(2).gotoLangSelectorView()}),o._UZ(1,"svg-icon",28),o.qZA()}}function V(e,t){if(1&e&&(o.TgZ(0,"div",11),o.YNc(1,P,2,2,"a",12),o.YNc(2,R,2,2,"a",13),o.YNc(3,$,3,3,"mv-metro-switcher",4),o.YNc(4,U,4,3,"div",14),o.YNc(5,Z,4,7,"button",15),o.YNc(6,j,2,0,"a",16),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",null==e.customer?null:e.customer.designConfiguration.logoLink),o.xp6(1),o.Q6J("ngIf",!(null!=e.customer&&e.customer.designConfiguration.logoLink)),o.xp6(1),o.Q6J("ngIf",e.shouldShowMetroSwitcher),o.xp6(1),o.Q6J("ngIf",e.shouldShowAccountButton),o.xp6(1),o.Q6J("ngIf",e.shouldShowSideMenu),o.xp6(1),o.Q6J("ngIf",!e.shouldShowSideMenu)}}function H(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mv-back-button",34),o.NdJ("backClick",function(){return o.CHM(e),o.oxw(2).onBackClick()}),o.qZA()}if(2&e){const e=o.oxw(2);o.Q6J("backText",e.backText)}}function G(e,t){if(1&e&&(o.TgZ(0,"h2",35),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.ekj("back-no-share",e.shouldShowBack&&!e.shouldShowShare),o.xp6(1),o.Oqu(e.titleText)}}function z(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"span",38),o.NdJ("click",function(t){const n=o.CHM(e).$implicit;return o.oxw(3).onTabClick(n,t)})("keydown.enter",function(t){const n=o.CHM(e).$implicit;return o.oxw(3).onTabClick(n,t)}),o._uU(1),o.ALo(2,"translate"),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(3);o.ekj("active",n.isTabActive(e)),o.uIk("aria-selected",n.isTabActive(e)),o.xp6(1),o.hij(" ",o.lcZ(2,4,n.getTabLabel(e))," ")}}function q(e,t){if(1&e&&(o.TgZ(0,"div",36),o.YNc(1,z,3,6,"span",37),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",e.displayedTabs)}}function J(e,t){1&e&&o._UZ(0,"mv-share")}function W(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",39),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).openLanguageSettings()}),o._uU(1),o.qZA()}if(2&e){const e=o.oxw(2);o.xp6(1),o.Oqu(e.localeCode)}}function Q(e,t){if(1&e&&(o.TgZ(0,"nav"),o.TgZ(1,"div",29),o.YNc(2,H,1,1,"mv-back-button",30),o.YNc(3,G,2,3,"h2",31),o.YNc(4,q,2,1,"div",32),o.YNc(5,J,1,0,"mv-share",4),o.qZA(),o.YNc(6,W,2,1,"div",33),o.qZA()),2&e){const e=o.oxw();o.xp6(2),o.Q6J("ngIf",e.shouldShowBack),o.xp6(1),o.Q6J("ngIf",e.titleText),o.xp6(1),o.Q6J("ngIf",e.shouldShowTabs),o.xp6(1),o.Q6J("ngIf",e.shouldShowShare),o.xp6(1),o.Q6J("ngIf",e.shouldShowOnlyLanguageSelection)}}let K=(()=>{class e{constructor(e,t,n,i,o,a,s,l,c,d,u,p){this.document=e,this.routingService=t,this.splashDisplay=n,this.globalActions=i,this.store=o,this.analyticsService=a,this.canonicalService=s,this.customerService=l,this.dialogService=c,this.materialDialogService=d,this.translate=u,this.platformService=p,this.AccountStatus=r.dp}get state(){return this.store.getState()}get tabs(){return i.lu[this.tabGroupId]}get isDesktop(){return this.platformService.isDesktop}get backText(){return this.isDesktop?this.translate.instant("action_back"):""}get primaryTabOrder(){var e,t;return null===(t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration)||void 0===t?void 0:t.primaryTabOrder}get displayedTabs(){return this.tabs.filter(e=>!e.shouldDisplay||e.shouldDisplay(this.state)).sort(this.sortTabs.bind(this))}sortTabs(e,t){return this.tabGroupId===i.HS.DEFAULT&&this.primaryTabOrder?this.primaryTabOrder.indexOf(e.label)-this.primaryTabOrder.indexOf(t.label):0}get routeData(){return this.routingService.getCurrentRouteData()}get tabGroupId(){const e=this.routeData.subTabId;return e&&i.ai[e]&&i.ai[e].tabGroupId?i.ai[e].tabGroupId:i.HS.DEFAULT}isTabActive(e){const t=this.routeData.subTabId;return e.tabId===this.routeData.tabId&&(!t||e.subTabId===t||e.alternateSubTabIds&&e.alternateSubTabIds.includes(t))}onLogout(){this.analyticsService.trackOpenLogoutFlow("header"),this.dialogService.create(u,{maxWidth:"calc(100% - 44px)",minWidth:"290px",panelClass:"app-popup"})}openRegisterLoginFlow(e){this.analyticsService.trackOpenAccountsFlow(e,"header"),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"]))}get currentAccountStatus(){return this.store.getState().user.accountStatus}get toggleNavIcon(){return this.currentAccountStatus===r.dp.Authenticated?"images/icons/drawer-profile.svg":"images/icons/drawer.svg"}onTabClick(e,t){if(t.currentTarget.blur(),this.state.global.isAppBlocked)return;this.state.global.splashScreen&&this.splashDisplay.invokeDismissal(),e.isPrimaryTab?this.analyticsService.trackTabView(e.tabId):this.analyticsService.trackSubTabView(e.subTabId);let n=e.link;if(this.canonicalService.isCanonicalTabId(e.tabId)){const t=this.canonicalService.getPath(e.subTabId);t&&(n=this.canonicalService.buildStatefulPath(t))}e.shouldPreserveParams?this.routingService.redirectToPreserveParams(n):this.routingService.redirectTo(n)}get shouldShowMetroSwitcher(){return!0}get shouldShowAccountButton(){var e,t,n;return!((null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.id)&&this.state.customer.currentCustomer.id!==this.customerService.MoovitSeo.id&&this.state.customer.currentCustomer.id!==this.customerService.MoovitWeb.id)&&(null===(n=null===(t=this.state.metro.currentMetro)||void 0===t?void 0:t.features)||void 0===n?void 0:n.ACCOUNTS_ENABLED)}get customer(){return this.state.customer.currentCustomer}get headerBackURL(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration.headerBackURL}get shouldHideLogo(){return!this.state.customer.currentCustomer||this.state.customer.currentCustomer.designConfiguration.hideLogo}get shouldShowOnlyLanguageSelection(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration.showOnlyLanguageSelection}get localeCode(){return this.state.global.selectedLocale&&(this.state.global.selectedLocale.momentId||this.state.global.selectedLocale.id).toUpperCase()}get shouldShowSideMenu(){var e;return!this.isDesktop&&!(null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration.hideSideNav)}get titleText(){if(this.isDesktop&&this.state.global.selectedTab===i.TF.TRIPPLAN&&this.selectedSubTab===i.zA.TRIPPLAN_ITINERARY)return this.translate.instant("nav_label_itinerary")}openSideMenu(e){e.stopPropagation(),this.store.dispatch(this.globalActions.setSideMenu(!0))}gotoLangSelectorView(){this.analyticsService.trackOpenLangSelectorView(),this.openLanguageSelector()}openLanguageSettings(){this.openLanguageSelector()}openLanguageSelector(){if(this.isDesktop)return this.materialDialogService.open(h.b,{autoFocus:!0});this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["language",":locale"]))}getLogoUrl(){var e,t;const n=null===(e=this.state.metro.currentMetroCustomDimensions)||void 0===e?void 0:e.metroSeoName.toLowerCase(),i=this.state.metro.metroId,r=null===(t=this.state.global.selectedLocale)||void 0===t?void 0:t.id,o=this.routingService.getStateFromUrl().customerId,a=this.customerService.isMoovitCustomer(o);return`/${n}-${i}/poi/${r}${o&&!a?`?customerId=${o}`:""}`}get shouldShowBack(){return this.isShowingItinerary||this.isShowingTripplanMap||this.isShowingLinesView||this.isShowingLinesMap}get shouldShowShare(){return this.isShowingItinerary&&this.doesItineraryHaveShareableLink||this.isShowingTripplanMap||this.isShowingLinesView||this.isShowingLinesMap}get selectedTab(){return this.state.global.selectedTab}get selectedSubTab(){return this.state.global.selectedSubTab}get isShowingItinerary(){return this.selectedTab===i.TF.TRIPPLAN&&this.selectedSubTab===i.zA.TRIPPLAN_ITINERARY}get isShowingTripplanMap(){return this.selectedTab===i.TF.TRIPPLAN&&this.selectedSubTab===i.zA.TRIPPLAN_MAP}get isShowingLinesView(){return this.selectedTab===i.TF.LINES&&this.selectedSubTab===i.zA.LINES_VIEW}get isShowingLinesMap(){return this.selectedTab===i.TF.LINES&&this.selectedSubTab===i.zA.LINES_MAP}get doesItineraryHaveShareableLink(){var e,t;const n=this.state.itinerary,i=null===(e=n.originalSelectedRoute)||void 0===e?void 0:e.startTime,r=null===(t=n.selectedRoute)||void 0===t?void 0:t.startTime;return Math.abs((null==i?void 0:i.getTime())-(null==r?void 0:r.getTime()))<1e4&&!this.doesItineraryHaveMicromobility}get doesItineraryHaveMicromobility(){var e;return null===(e=this.state.itinerary.selectedRoute)||void 0===e?void 0:e.steps.some(e=>e.type===m.cF.BikeRideTo||e.type===m.cF.RentalBikeRideTo)}get shouldShowNav(){const{selectedSubTab:e}=this.state.global;return e!==i.zA.TOD_HISTORY_RIDES&&e!==i.zA.TOD_RIDE_ORDER&&e!==i.zA.TOD_HISTORY_RIDE_DETAILS&&e!==i.zA.TOD_ACTIVE_RIDE&&e!==i.zA.TRIPPLAN_STOPARRIVALS}get shouldShowTabs(){return!this.isDesktop||!this.isShowingItinerary&&!this.isShowingLinesView}onBackClick(){this.state.global.selectedTab===i.TF.TRIPPLAN&&(this.selectedSubTab===i.zA.TRIPPLAN_ITINERARY||this.selectedSubTab===i.zA.TRIPPLAN_MAP)&&this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["poi",":searchTo",":searchFrom",":locale"])),this.state.global.selectedTab===i.TF.LINES&&(this.selectedSubTab===i.zA.LINES_VIEW||this.selectedSubTab===i.zA.LINES_MAP)&&this.routingService.redirectTo(this.canonicalService.buildStatefulPath([":tab",":locale"]))}getTabLabel(e){return e.subTabId===i.zA.TRIPPLAN_ITINERARY?"nav_label_itinerary":e.subTabId===i.zA.LINES_MAP?"map_view_title":e.subTabId===i.zA.LINES_VIEW?"nav_label_line":e.label}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(p.K0),o.Y36(g.Z),o.Y36(f.Y),o.Y36(v.l),o.Y36(l.d),o.Y36(y.y),o.Y36(b.z),o.Y36(_.v),o.Y36(a.x),o.Y36(T.uw),o.Y36(d.sK),o.Y36(S.mi))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-header"]],decls:6,vars:5,consts:[[1,"header"],["class","back-link",3,"href",4,"ngIf"],["logoTemplate",""],["class","heading-navbar","role","heading","aria-level","1","aria-label","logo",4,"ngIf"],[4,"ngIf"],[1,"back-link",3,"href"],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",3,"titleText"],["class","svg-icon logo","mvAccessibleSVG","","titleText","Moovit",3,"src",4,"ngIf"],["mvImg","","class","logo","alt","Moovit",3,"src",4,"ngIf"],["mvAccessibleSVG","","titleText","Moovit",1,"svg-icon","logo",3,"src"],["mvImg","","alt","Moovit",1,"logo",3,"src"],["role","heading","aria-level","1","aria-label","logo",1,"heading-navbar"],["class","logo-link","target","_blank",3,"href",4,"ngIf"],["class","logo-link",3,"href",4,"ngIf"],["class","user-wrapper",4,"ngIf"],["id","sidenav-toggler","class","sidenav-toggler",3,"click","keydown.enter",4,"ngIf"],["id","language-switcher","class","language-switcher","tabindex","0",3,"click","keydown.enter",4,"ngIf"],["target","_blank",1,"logo-link",3,"href"],[4,"ngTemplateOutlet"],[1,"logo-link",3,"href"],[1,"user-wrapper"],["class","user login",3,"click",4,"ngIf"],["class","user logout",3,"click",4,"ngIf"],[1,"user","login",3,"click"],[1,"user","logout",3,"click"],["id","sidenav-toggler",1,"sidenav-toggler",3,"click","keydown.enter"],["mvAccessibleSVG","",3,"src","titleText"],["id","language-switcher","tabindex","0",1,"language-switcher",3,"click","keydown.enter"],["src","images/nav-icons/language.svg","mvAccessibleSVG",""],["role","tablist",1,"links"],["class","black-fill",3,"backText","backClick",4,"ngIf"],["class","nav-title",3,"back-no-share",4,"ngIf"],["class","tabs-wrapper",4,"ngIf"],["class","lang-switch",3,"click",4,"ngIf"],[1,"black-fill",3,"backText","backClick"],[1,"nav-title"],[1,"tabs-wrapper"],["class","tab","role","tab","tabindex","0",3,"active","click","keydown.enter",4,"ngFor","ngForOf"],["role","tab","tabindex","0",1,"tab",3,"click","keydown.enter"],[1,"lang-switch",3,"click"]],template:function(e,t){1&e&&(o.TgZ(0,"header",0),o.YNc(1,A,3,4,"a",1),o.YNc(2,C,2,2,"ng-template",null,2,o.W1O),o.YNc(4,V,7,6,"div",3),o.YNc(5,Q,7,5,"nav",4),o.qZA()),2&e&&(o.ekj("no-side-menu",!t.shouldShowSideMenu),o.xp6(1),o.Q6J("ngIf",t.headerBackURL),o.xp6(3),o.Q6J("ngIf",!t.shouldHideLogo),o.xp6(1),o.Q6J("ngIf",t.shouldShowNav))},directives:[p.O5,c.bk,x.m,w.X,p.tP,k.M,M.W,p.sg,L.N],pipes:[d.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-header{display:block;width:100%;background:#fff;box-shadow:none}body.desktop mv-header{position:relative;z-index:1}body.mobile mv-header{z-index:9999;position:fixed;transition:transform ease-in-out .3s;min-width:320px}html body.mobile mv-header~.content-container{margin-top:4.7058823529rem}html.privacy-notice body.mobile mv-header~.content-container{margin-top:calc(4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-header~.content-container{margin-top:calc(4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-header~.content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-header~.content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-header~.content-container{margin-top:calc(4.7058823529rem + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-header~.content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-header~.content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-header~.content-container{margin-top:calc(4.7058823529rem + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-header~.content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-header~.content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-header~.content-container{margin-top:calc(4.7058823529rem + 60px + 4.7058823529rem)}}mv-header:before{content:"";position:absolute;top:0;bottom:0;left:0;right:0;width:100%;background:rgba(0,0,0,.5);z-index:2;opacity:0;visibility:hidden;cursor:pointer;transition:all,.3s}mv-header .header{position:relative;display:flex;flex-direction:column;width:100%;background-color:#292a30;background:url(/images/sideBarHeader.jpg) no-repeat center center;background-size:cover}@media only screen and (max-height: 450px){mv-header .header{height:4.7058823529rem;min-height:4.7058823529rem}}body.mobile mv-header .header{transition:all .3s}body.desktop mv-header .header{height:6.1764705882rem;min-height:6.1764705882rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header{height:2.4705882353rem;min-height:2.4705882353rem;flex-direction:row;align-items:center}mv-header .header>*{position:static;position:initial}html[dir=ltr] mv-header .header.no-side-menu .language-switcher{right:20px}html[dir=rtl] mv-header .header.no-side-menu .language-switcher{left:20px}html[dir=ltr] mv-header .header.no-side-menu nav{margin-right:70px}html[dir=rtl] mv-header .header.no-side-menu nav{margin-left:70px}mv-header .header .logo.svg-icon{position:static;position:initial;height:19px}html[dir=ltr] mv-header .header .logo.svg-icon{margin-left:20px}html[dir=rtl] mv-header .header .logo.svg-icon{margin-right:20px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html[dir=ltr] mv-header .header .logo.svg-icon{margin-left:0}html[dir=rtl] mv-header .header .logo.svg-icon{margin-right:0}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header nav{max-width:calc(100% - 80px);height:100%}html[dir=ltr] mv-header .header nav{margin-right:100px}html[dir=rtl] mv-header .header nav{margin-left:100px}mv-header .header nav div.links{top:3px}html[dir=ltr] mv-header .header nav div.links{left:0}html[dir=rtl] mv-header .header nav div.links{right:0}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header nav div.links{top:0}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header mv-metro-switcher{margin:0}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header .language-switcher{position:absolute}html[dir=ltr] mv-header .header .language-switcher{right:60px}html[dir=rtl] mv-header .header .language-switcher{left:60px}}mv-header .header .language-switcher svg-icon,mv-header .header .language-switcher svg-icon svg{width:.9411764706rem;height:.9411764706rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header .language-switcher{margin:0 10px}}mv-header .header .heading-navbar{display:flex;align-items:center;justify-content:space-between;padding:10px 20px 4px;transition:padding .2s ease-in-out}body.desktop mv-header .header .heading-navbar{padding:23px 20px 18px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header .heading-navbar{padding:13px 0 4px 20px}html[dir=rtl] mv-header .header .heading-navbar{padding:13px 20px 4px 0}}mv-header .header .heading-navbar .logo-link{height:24px;width:auto;position:relative;bottom:5px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html[dir=ltr] mv-header .header .heading-navbar .logo-link{margin-right:10px}html[dir=rtl] mv-header .header .heading-navbar .logo-link{margin-left:10px}}mv-header .header .heading-navbar .logo-link svg-icon.logo{width:85px;height:28px;transition:all,.2s}mv-header .header .heading-navbar .logo-link svg-icon.logo .cls-1{fill:#f0500c;transition:all .5s}mv-header .header .heading-navbar .logo-link img.logo{position:relative;width:auto;max-width:83px;max-height:39px;top:-1px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header .heading-navbar .logo-link img.logo{top:-8px}}mv-header .header .heading-navbar .user-wrapper .user{top:-1px;position:relative;color:#fff;letter-spacing:-.0141176471rem;font-size:.7058823529rem;display:flex;align-items:center;margin:0 22px}mv-header .header .heading-navbar .user-wrapper .user.login{text-decoration:none;flex-wrap:wrap}html[dir=ltr] mv-header .header .heading-navbar .user-wrapper .user.login{padding-left:16px}html[dir=rtl] mv-header .header .heading-navbar .user-wrapper .user.login{padding-right:16px}mv-header .header .heading-navbar .user-wrapper .user.login:before{content:"";background:url(/images/icons/profile-icon.svg) center/cover;display:inline-block;position:absolute;width:.9411764706rem;height:.9411764706rem}html[dir=ltr] mv-header .header .heading-navbar .user-wrapper .user.login:before{left:-3px}html[dir=rtl] mv-header .header .heading-navbar .user-wrapper .user.login:before{right:-3px}html[dir=ltr] mv-header .header .heading-navbar .user-wrapper .user.login:before{margin-right:4px}html[dir=rtl] mv-header .header .heading-navbar .user-wrapper .user.login:before{margin-left:4px}mv-header .header .heading-navbar .user-wrapper .user.logout{text-decoration:underline}mv-header .header nav{display:flex;flex-direction:column;flex-grow:1}mv-header .header nav div.links{position:relative;white-space:nowrap;display:flex;align-items:center;flex-grow:1;justify-content:space-between}body.desktop mv-header .header nav div.links mv-back-button .back-button-container{min-width:70px}html[dir=ltr] body.desktop mv-header .header nav div.links mv-back-button .back-button-container{padding-right:0}html[dir=rtl] body.desktop mv-header .header nav div.links mv-back-button .back-button-container{padding-left:0}body.desktop mv-header .header nav div.links mv-back-button .back-button-container mv-share{display:none}body.desktop mv-header .header nav div.links .nav-title{font-size:.8235294118rem;text-transform:uppercase;font-weight:500;flex-grow:1;text-align:center}body.desktop mv-header .header nav div.links .nav-title.back-no-share{text-indent:-80px}mv-header .header nav div.links .tabs-wrapper{display:flex;align-items:center;overflow-x:auto;height:2.2941176471rem;mask-image:linear-gradient(90deg,rgba(255,255,255,0) 2px,white 20px,white calc(100% - 20px),rgba(0,0,0,0) calc(100% - 2px)),linear-gradient(0,#000 24%,transparent 27%);-webkit-mask-image:linear-gradient(90deg,rgba(255,255,255,0) 2px,white 20px,white calc(100% - 20px),rgba(0,0,0,0) calc(100% - 2px)),linear-gradient(0,#000 24%,transparent 27%)}mv-header .header nav div.links .tabs-wrapper:not(:only-child){padding:0 20px}body.desktop mv-header .header nav div.links .tabs-wrapper::-webkit-scrollbar{height:5px}body.desktop mv-header .header nav div.links .tabs-wrapper::-webkit-scrollbar-track{background-color:#fff3}body.desktop mv-header .header nav div.links .tabs-wrapper::-webkit-scrollbar-thumb{background-color:#ffffff1a;border-radius:2px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header nav div.links .tabs-wrapper{top:0}}mv-header .header nav div.links .tabs-wrapper a{display:inline-block}html[dir=ltr] mv-header .header nav div.links .tabs-wrapper a{padding-left:1em}html[dir=rtl] mv-header .header nav div.links .tabs-wrapper a{padding-right:1em}mv-header .header nav div.links .tabs-wrapper .tab{display:flex;align-items:center;height:100%;padding:0 20px;outline:none;text-transform:uppercase;position:relative;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#bdc3c7;font-weight:500;transition:all .4s ease-in-out}mv-header .header nav div.links .tabs-wrapper .tab:after{opacity:0;color:#f0500c;background:#f0500c;width:100%;content:"";position:absolute;height:3px;left:0;transition:opacity .3s ease;top:calc(100% - .1764705882rem)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header nav div.links .tabs-wrapper .tab:after{bottom:.1764705882rem;top:unset}}mv-header .header nav div.links .tabs-wrapper .tab:focus{outline:white auto 1px}mv-header .header nav div.links .tabs-wrapper .tab:hover{outline:none}mv-header .header nav div.links .tabs-wrapper .tab.active{color:#f0500c}mv-header .header nav div.links .tabs-wrapper .tab.active:after{opacity:1}mv-header .header .sidenav-toggler{z-index:9}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-header .header .sidenav-toggler{position:absolute}html[dir=ltr] mv-header .header .sidenav-toggler{right:20px}html[dir=rtl] mv-header .header .sidenav-toggler{left:20px}}mv-header .header .sidenav-toggler svg-icon{height:1.4117647059rem;width:1.4117647059rem}mv-header .header .sidenav-toggler svg-icon svg{display:block;fill:#fff;height:1.4117647059rem;width:1.4117647059rem}html[dir=rtl] mv-header .header .sidenav-toggler svg-icon svg{transform:scaleX(-1)}body.desktop mv-header mv-back-button .back-link{padding:9px 20px}\n'],encapsulation:2}),e})()},14942:function(e,t,n){"use strict";n.d(t,{P:function(){return S}});var i=n(3786),r=n(52959),o=n(99528),a=n(16438);function s(e,t,n,i){var r;const o=e.length;let a=n?0:o-1;for(;a>=0&&a<o;){const o=e[a];for(const e of Object.keys(o))if(null===(r=o[e])||void 0===r?void 0:r.journey){const t=o[e].journey;return t.origin.caption||(t.origin.caption=i),t.dest.caption||(t.dest.caption=i),t}if(t){let e=null,n=null;if(o.lineLeg?n=o.lineLeg:o.multiLineLeg?n=o.multiLineLeg.lineLeg:o.lineWithAlternarivesLeg&&(n=o.lineWithAlternarivesLeg.alternativeLines[o.lineWithAlternarivesLeg.primaryAlternativeIndex]),n&&n.stopSequenceIds&&(e=n.stopSequenceIds),e&&e.length>0){const n=e[0],i=e[e.length-1],r=t.find(e=>e.stopId===n),o=t.find(e=>e.stopId===i);return r&&o?{origin:{caption:r.stopName,latlon:r.stopLocation},dest:{caption:o.stopName,latlon:o.stopLocation}}:void 0}}n?a++:a--}}var l=n(2316),c=n(803),d=n(95505),u=n(43999),p=n(61787),h=n(1420),m=n(38947),g=n(80270),f=n(99650),v=n(82909),y=n(81663),b=n(5971),_=n(5306),T=n(2339);let S=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d,u,p){this.converters=e,this.routingService=t,this.route=n,this.canonicalService=i,this.shareService=r,this.errorService=o,this.errorActions=a,this.searchActions=s,this.itineraryActions=l,this.suggestedRoutesActions=c,this.store=d,this.universal=u,this.translate=p}get state(){return this.store.getState()}ngOnInit(){var e,t;return(0,i.mG)(this,void 0,void 0,function*(){if(!this.universal.isServer){yield(0,r.p5)(this.store);try{const i=this.route.snapshot.params.itineraryId,r=yield this.shareService.getItineraryBySharedId(i),l=this.translate.instant("map_tapped_location"),c=s(r.itinerary.legs,null===(e=r.supplementalData)||void 0===e?void 0:e.mVStopSyncedMetaDataList,!0,l).origin,d=s(r.itinerary.legs,null===(t=r.supplementalData)||void 0===t?void 0:t.mVStopSyncedMetaDataList,!1,l).dest;this.store.dispatch(this.searchActions.setSelectedLocation(this.converters.convertMVLocationDescriptorToSuggestedLocation(c),o.$h.From,!0)),this.store.dispatch(this.searchActions.setSelectedLocation(this.converters.convertMVLocationDescriptorToSuggestedLocation(d),o.$h.To,!0));try{const e=yield this.converters.convertMVTripPlannerItineraryToSuggestedRoute(this.state.directions.search.from,this.state.directions.search.to,r.itinerary,r.supplementalData,this.state.metro.currentMetro);this.store.dispatch(this.itineraryActions.setSelectedRoute(e)),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],a.zA.TRIPPLAN_ITINERARY))}catch(n){const e=this.routingService.getStateFromUrl();this.routingService.redirectTo(this.canonicalService.buildStatefulPath([this.state.directions.search.to.name,this.state.directions.search.from.name],a.zA.TRIPPLAN_DIRECTIONS),{fll:this.state.directions.search.from.latlng.lat+"_"+this.state.directions.search.from.latlng.lng,tll:this.state.directions.search.to.latlng.lat+"_"+this.state.directions.search.to.latlng.lng,utm_source:e.utmSource||null,utm_medium:e.utmMedium||null}),this.store.dispatch(this.suggestedRoutesActions.getSuggestedRoutes())}}catch(i){this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],a.zA.TRIPPLAN_DIRECTIONS)),this.store.dispatch(this.errorActions.setError(this.errorService.createSharedTripPlanTimeoutError()))}}})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.J),l.Y36(d.Z),l.Y36(u.gz),l.Y36(p.z),l.Y36(h.t),l.Y36(m.T),l.Y36(g.f),l.Y36(f.P),l.Y36(v.L),l.Y36(y.C),l.Y36(b.d),l.Y36(_.p),l.Y36(T.sK))},e.\u0275cmp=l.Xpm({type:e,selectors:[["mv-itinerary-short-landing"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},93767:function(e,t,n){"use strict";n.d(t,{b:function(){return y}});var i=n(30037),r=n(2316),o=n(22213),a=n(10723),s=n(5971),l=n(1238),c=n(81663),d=n(95505),u=n(1437),p=n(61787),h=n(54364),m=n(2339);function g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",8),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw().selectLang(t)}),r._uU(1),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.name," ")}}function f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw().selectLang(t)}),r._uU(1),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.name," ")}}function v(e,t){if(1&e&&(r.TgZ(0,"div",5),r.YNc(1,g,2,1,"button",6),r.YNc(2,f,2,1,"button",7),r.qZA()),2&e){const e=t.$implicit,n=t.index,i=r.oxw();r.ekj("selected",e.id===i.currentLocaleId),r.MGl("id","lang-",e.id,""),r.xp6(1),r.Q6J("ngIf",0===n),r.xp6(1),r.Q6J("ngIf",n>0)}}let y=(()=>{class e extends i.S{constructor(e,t,n,i,r,o,a,s){super(t,n,i,r,o,a,s),this.dialogRef=e,this.langs=t.getSupportedLocales()}ngOnInit(){}get currentLocaleId(){return this.state.global.selectedLocale.id}selectLang(e){this.close(),this.dialogRef.afterClosed().subscribe(()=>{super.selectLang(e)})}close(){this.dialogRef.close()}trackByIndex(e){return e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.so),r.Y36(a.OL),r.Y36(s.d),r.Y36(l.l),r.Y36(c.C),r.Y36(d.Z),r.Y36(u.y),r.Y36(p.z))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-language-selector-popup"]],features:[r.qOj],decls:8,vars:6,consts:[[1,"header"],["role","heading","aria-level","1"],[1,"content"],["role","list",1,"languages-container"],["role","listitem","class","language",3,"id","selected",4,"ngFor","ngForOf","ngForTrackBy"],["role","listitem",1,"language",3,"id"],["class","language-button","id","first-language-item",3,"click",4,"ngIf"],["class","language-button",3,"click",4,"ngIf"],["id","first-language-item",1,"language-button",3,"click"],[1,"language-button",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"section"),r.TgZ(1,"div",0),r.TgZ(2,"div",1),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",2),r.TgZ(6,"div",3),r.YNc(7,v,3,5,"div",4),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.hij(" ",r.lcZ(4,4,"change_language")," "),r.xp6(3),r.uIk("aria-activedescendant","lang-"+t.currentLocaleId),r.xp6(1),r.Q6J("ngForOf",t.langs)("ngForTrackBy",t.trackByIndex))},directives:[h.sg,h.O5],pipes:[m.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-language-selector-popup{display:block;max-height:29.4117647059rem;max-width:915px;overflow-y:auto;width:100%;position:relative}mv-language-selector-popup .language-button{font-size:.8235294118rem;color:#292a30;text-decoration:none;transition:color .3s}mv-language-selector-popup .header{background:#fff;border-bottom:1px solid #DDDDDD;box-sizing:border-box;font-size:1.1764705882rem;margin:0;padding:10px 0 14px;text-transform:capitalize}html[dir=ltr] mv-language-selector-popup .header{margin-left:10px}html[dir=rtl] mv-language-selector-popup .header{margin-right:10px}mv-language-selector-popup .content{box-sizing:border-box;min-height:410px;padding:10px;position:relative}mv-language-selector-popup .content .overlay{background-color:#00000040;bottom:0;left:0;position:absolute;right:0;top:0;z-index:9}mv-language-selector-popup .content .overlay md-progress-circular{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}mv-language-selector-popup .content .languages-container{margin:0 0 10px;width:100%}mv-language-selector-popup .content .languages-container .language{box-sizing:border-box;display:inline-block;padding:9px 0;position:relative;width:25%;transition:all .3s}mv-language-selector-popup .content .languages-container .language.selected{cursor:default;font-weight:700}mv-language-selector-popup .content .languages-container .language.selected:before{opacity:1}mv-language-selector-popup .content .languages-container .language.selected:hover{color:#292a30}mv-language-selector-popup .content .languages-container .language:hover .language-button{color:#2196f3}mv-language-selector-popup .content .languages-container .language .name{line-height:16px;vertical-align:top}\n"],encapsulation:2}),e})()},30037:function(e,t,n){"use strict";n.d(t,{S:function(){return b}});var i=n(99528),r=n(89505),o=n(2316),a=n(10723),s=n(5971),l=n(1238),c=n(81663),d=n(95505),u=n(1437),p=n(61787),h=n(54364),m=n(87479),g=n(93975),f=n(2339);function v(e,t){1&e&&(o._UZ(0,"svg-icon",5),o.ALo(1,"translate")),2&e&&(o.s9C("titleText",o.lcZ(1,2,"a11y_checked_icon")),o.Q6J("src","images/selected.svg"))}function y(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"li",3),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw().selectLang(t)})("keydown.enter",function(){const t=o.CHM(e).$implicit;return o.oxw().selectLang(t)}),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.YNc(3,v,2,4,"svg-icon",4),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw();o.ekj("selected",n.isLangSelected(e.id)),o.uIk("id",n.getLangElementId(e.id)),o.xp6(2),o.hij(" ",e.name," "),o.xp6(1),o.Q6J("ngIf",n.isLangSelected(e.id))}}let b=(()=>{class e{constructor(e,t,n,i,r,o,a){this.localeService=e,this.store=t,this.globalActions=n,this.suggestedRoutesActions=i,this.routingService=r,this.analyticsService=o,this.canonicalService=a,this.langs=e.getSupportedLocales()}get state(){return this.store.getState()}isLangSelected(e){return this.state.global.selectedLocale&&this.state.global.selectedLocale.id===e}selectLang(e){const t=this.state.global.selectedLocale.id;this.store.dispatch(this.globalActions.setLocale(e.id)),this.analyticsService.trackLocaleChanged(e.momentId||e.id),this.state.directions.suggestedRoutes.loadingState==i.Gu.LOADED&&this.store.dispatch(this.suggestedRoutesActions.getSuggestedRoutes());const n=this.state.global.savedRoute?this.state.global.savedRoute.replace("/"+t,"/"+e.id):this.canonicalService.buildStatefulPath([":default"]);this.store.dispatch({type:r.YC}),this.routingService.redirectToPreserveParams(n)}getLangElementId(e){return`lang-${e}`}get ariaSelectedLang(){return this.state.global.selectedLocale?this.getLangElementId(this.state.global.selectedLocale.id):null}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.OL),o.Y36(s.d),o.Y36(l.l),o.Y36(c.C),o.Y36(d.Z),o.Y36(u.y),o.Y36(p.z))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-language-selector"]],decls:5,vars:5,consts:[["role","heading","aria-level","1",1,"header","settings"],["role","list",1,"list-view"],["role","listitem","tabindex","0",3,"selected","click","keydown.enter",4,"ngFor","ngForOf"],["role","listitem","tabindex","0",3,"click","keydown.enter"],["class","selected","role","presentation","mvAccessibleSVG","",3,"src","titleText",4,"ngIf"],["role","presentation","mvAccessibleSVG","",1,"selected",3,"src","titleText"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._uU(1),o.ALo(2,"translate"),o.qZA(),o.TgZ(3,"ul",1),o.YNc(4,y,4,5,"li",2),o.qZA()),2&e&&(o.xp6(1),o.hij(" ",o.lcZ(2,3,"change_language"),"\n"),o.xp6(2),o.uIk("aria-activedescendant",t.ariaSelectedLang),o.xp6(1),o.Q6J("ngForOf",t.langs))},directives:[h.sg,h.O5,m.bk,g.m],pipes:[f.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-language-selector{display:block;-webkit-overflow-scrolling:touch;transition:all .3s}mv-language-selector ul.list-view{list-style:none;box-shadow:0 2px 3px -1px #0000004d;margin:0;padding:0}mv-language-selector ul.list-view li{position:relative;background:#fff;height:auto;border-bottom:1px solid #DDDDDD;padding:14px 0;font-size:.8235294118rem;color:#292a30}html[dir=ltr] mv-language-selector ul.list-view li{padding-left:20px}html[dir=rtl] mv-language-selector ul.list-view li{padding-right:20px}mv-language-selector ul.list-view li:last-child{border-bottom:none}mv-language-selector ul.list-view li.selected{color:#0078d6}mv-language-selector ul.list-view li svg-icon{position:absolute;top:50%;transform:translateY(-50%);width:12px;height:12px;margin:0}html[dir=ltr] mv-language-selector ul.list-view li svg-icon{right:20px}html[dir=rtl] mv-language-selector ul.list-view li svg-icon{left:20px}mv-language-selector ul.list-view li svg-icon svg .cls-1{fill:#0078d6}\n"],encapsulation:2}),e})()},94943:function(e,t,n){"use strict";n.d(t,{h:function(){return D}});var i=n(3786),r=n(52959),o=n(2316),a=n(22213),s=n(5971),l=n(67839),c=n(1564),d=n(95505),u=n(1238),p=n(1437),h=n(61787),m=n(2339),g=n(54364),f=n(87479),v=n(93975),y=n(53448),b=n(90248),_=n(32066);const T=["searchInput"];function S(e,t){1&e&&(o.TgZ(0,"span"),o._UZ(1,"svg-icon",16),o.ALo(2,"translate"),o._uU(3),o.ALo(4,"translate"),o.qZA()),2&e&&(o.xp6(1),o.s9C("titleText",o.lcZ(2,2,"web_choose_metro_title")),o.xp6(2),o.hij(" ",o.lcZ(4,4,"web_choose_metro_title")," "))}function x(e,t){1&e&&(o.TgZ(0,"div",17),o._UZ(1,"mv-spinner"),o.qZA())}function w(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",22),o.TgZ(1,"button",23),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).onCountrySelected(t)}),o._UZ(2,"mvf-image",24),o.TgZ(3,"span",25),o._uU(4),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(2);o.ekj("selected",n.isCountrySelected(e)),o.MGl("id","country-",e.name,""),o.xp6(2),o.Q6J("imageId",e.flagImageId)("imageAlt",e.altText),o.xp6(2),o.Oqu(e.name)}}function k(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",29),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(3).onMetroSelected(t)}),o.TgZ(1,"span",25),o._uU(2),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(3);o.ekj("selected",e.metroId===n.currentMetroId||e.metroId===n.selectedMetroId),o.xp6(2),o.Oqu(e.name)}}function M(e,t){if(1&e&&(o.TgZ(0,"div",26),o.TgZ(1,"div",27),o.YNc(2,k,3,3,"button",28),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(2),o.Q6J("ngForOf",e.getFilteredMetros(e.selectedCountry))("ngForTrackBy",e.trackByMetro)}}function L(e,t){if(1&e&&(o.TgZ(0,"div",18),o.TgZ(1,"div",19),o.YNc(2,w,5,6,"div",20),o.qZA(),o.YNc(3,M,3,2,"div",21),o.qZA()),2&e){const e=o.oxw();o.ekj("metro-selection",e.selectedCountry),o.xp6(1),o.s9C("aria-activedescendant",e.ariaActiveDescendant),o.xp6(1),o.Q6J("ngForOf",e.filteredCountries)("ngForTrackBy",e.trackByCountry),o.xp6(1),o.Q6J("ngIf",e.selectedCountry)}}function A(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",29),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(3).onMetroSelected(t)}),o.TgZ(1,"span",25),o._uU(2),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(3);o.ekj("selected",e.metroId===n.currentMetroId||e.metroId===n.selectedMetroId),o.xp6(2),o.Oqu(e.name)}}function I(e,t){if(1&e&&(o.TgZ(0,"div",32),o.TgZ(1,"div",33),o.TgZ(2,"div",34),o._UZ(3,"mvf-image",24),o.TgZ(4,"span",25),o._uU(5),o.qZA(),o.qZA(),o.qZA(),o.TgZ(6,"div",35),o.YNc(7,A,3,3,"button",28),o.qZA(),o.qZA()),2&e){const e=t.$implicit,n=o.oxw(2);o.xp6(3),o.Q6J("imageId",e.flagImageId)("imageAlt",e.altText),o.xp6(2),o.Oqu(e.name),o.xp6(2),o.Q6J("ngForOf",n.getFilteredMetros(e))("ngForTrackBy",n.trackByMetro)}}function E(e,t){if(1&e&&(o.TgZ(0,"div",30),o.YNc(1,I,8,5,"div",31),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.filteredCountries)("ngForTrackBy",e.trackByCountry)}}function C(e,t){1&e&&(o.TgZ(0,"div",36),o._UZ(1,"svg-icon",37),o.TgZ(2,"span",38),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA()),2&e&&(o.xp6(3),o.Oqu(o.lcZ(4,1,"search_metro_empty_state")))}let D=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c){this.dialogRef=e,this.store=t,this.countriesService=n,this.metroActions=i,this.routingService=r,this.globalActions=o,this.analyticsService=a,this.canonicalService=s,this.translate=l,this._cd=c,this.filteredCountries=[],this.metroSearchLowercase="",this.countries=[],this.metros=[],this.metroSearch="",this.selectedCountry=null,this.selectedMetroId=null}get ariaActiveDescendant(){return this.currentCountry||this.selectedCountry?"country-"+(this.currentCountry||this.selectedCountry):void 0}ngOnInit(){this.load()}get state(){return this.store.getState()}isCountrySelected(e){return this.selectedCountry===e}isMetroSelected(e){return this.state.metro.metroId===e.metroId}close(){this.dialogRef.close()}getCountrySelection(){const e=this.state.metro.currentMetro,t={countries:this.state.global.countries,selectedCountry:null,selectedMetro:null};for(const n of t.countries)n.altText=this.translate.instant("a11y_country_icon",{COUNTRY:n.name});for(const n of t.countries)if(n.name===e.countryName){t.selectedCountry=n,t.selectedMetro=e;break}return t}getFilteredCountries(){return this.metroSearch?this.countries.filter(e=>e.name.includes(this.metroSearchLowercase)||this.getFilteredMetros(e).length>0):this.countries}getFilteredMetros(e){return e.metros.filter(e=>e.searchTerm.toLowerCase().includes(this.metroSearchLowercase.toLowerCase()))}load(){return(0,i.mG)(this,void 0,void 0,function*(){this.isLoading=!0,yield(0,r.p5)(this.store),yield this.store.dispatch(this.globalActions.loadCountries());const e=this.getCountrySelection();this.countries=e.countries,this.filteredCountries=this.countries,this.currentCountry=e.selectedCountry.name,this.currentMetroId=e.selectedMetro.metroAreaId,this.isLoading=!1,this._cd.detectChanges(),this.searchInput.nativeElement.focus()})}onSearch(e){this.metroSearch=e,this.metroSearchLowercase=this.metroSearch.toLowerCase(),this.filteredCountries=this.getFilteredCountries()}onCountrySelected(e){this.selectedMetroId=null,this.selectedCountry=e,this.filteredCountries=e?[this.selectedCountry]:this.filteredCountries}onMetroSelected(e){this.selectedMetroId=e.metroId,this.changeMetro(e)}changeMetro(e){return(0,i.mG)(this,void 0,void 0,function*(){this.isMetroSelected(e)||(yield this.store.dispatch(this.globalActions.setMetro(e.metroId)),this.analyticsService.trackMetroChanged(e.metroId)),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([":default"])),this.close()})}trackByCountry(e,t){return t.name}trackByMetro(e,t){return t.metroId}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.so),o.Y36(s.d),o.Y36(l.K),o.Y36(c.L),o.Y36(d.Z),o.Y36(u.l),o.Y36(p.y),o.Y36(h.z),o.Y36(m.sK),o.Y36(o.sBO))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-metro-selector-popup"]],viewQuery:function(e,t){if(1&e&&o.Gf(T,5),2&e){let e;o.iGM(e=o.CRH())&&(t.searchInput=e.first)}},decls:21,vars:18,consts:[[1,"header"],["role","heading","aria-level","1"],[1,"choose-metro",3,"click"],[4,"ngIf"],[1,"filter-container"],[1,"input-icon"],["src","images/icons/search.svg","mvAccessibleSVG","",1,"arrow-icon"],["type","search","aria-controls","metro-results",1,"setting-filter",3,"ngModel","placeholder","title","ngModelChange"],["searchInput",""],["tabindex","0",1,"clear-input",3,"click"],["src","images/icons/close.svg","mvAccessibleSVG","",3,"titleText"],[1,"content"],["class","overlay","role","status",4,"ngIf"],["role","region","id","metro-results","aria-live","polite",3,"metro-selection",4,"ngIf"],["class","search-results",4,"ngIf"],["class","empty-results","role","alert",4,"ngIf"],["src","images/icons/alert-open.svg","mvAccessibleSVG","",1,"svg-icon","svg-icon-arrow",3,"titleText"],["role","status",1,"overlay"],["role","region","id","metro-results","aria-live","polite"],["role","list",1,"countries-container",3,"aria-activedescendant"],["role","listitem","class","country",3,"selected","id",4,"ngFor","ngForOf","ngForTrackBy"],["class","metros-container","role","list",4,"ngIf"],["role","listitem",1,"country",3,"id"],[3,"click"],[1,"settings-country-flag",3,"imageId","imageAlt"],[1,"name"],["role","list",1,"metros-container"],["role","listitem"],["class","metro",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"metro",3,"click"],[1,"search-results"],["class","country-result",4,"ngFor","ngForOf","ngForTrackBy"],[1,"country-result"],[1,"countries-container"],[1,"country"],[1,"metros-container"],["role","alert",1,"empty-results"],["src","../../images/error-states/img_empty_state_omni.svg",1,"icon"],[1,""]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"span",1),o.TgZ(2,"button",2),o.NdJ("click",function(){return t.onCountrySelected(null)}),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.YNc(5,S,5,6,"span",3),o.qZA(),o.TgZ(6,"div",4),o.TgZ(7,"span",5),o._UZ(8,"svg-icon",6),o.qZA(),o.TgZ(9,"input",7,8),o.NdJ("ngModelChange",function(e){return t.onSearch(e)}),o.ALo(11,"translate"),o.ALo(12,"translate"),o.qZA(),o.TgZ(13,"button",9),o.NdJ("click",function(){return t.metroSearch=void 0}),o._UZ(14,"svg-icon",10),o.ALo(15,"translate"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(16,"div",11),o.YNc(17,x,2,0,"div",12),o.YNc(18,L,4,6,"div",13),o.YNc(19,E,2,2,"div",14),o.YNc(20,C,5,3,"div",15),o.qZA()),2&e&&(o.xp6(3),o.hij(" ",o.lcZ(4,10,"web_choose_country_title")," "),o.xp6(2),o.Q6J("ngIf",t.selectedCountry),o.xp6(4),o.s9C("placeholder",o.lcZ(11,12,"web_search_metro_hint")),o.s9C("title",o.lcZ(12,14,"web_search_metro_hint")),o.Q6J("ngModel",t.metroSearch),o.xp6(5),o.s9C("titleText",o.lcZ(15,16,"action_clear")),o.xp6(3),o.Q6J("ngIf",t.isLoading),o.xp6(1),o.Q6J("ngIf",!t.metroSearch),o.xp6(1),o.Q6J("ngIf",t.metroSearch),o.xp6(1),o.Q6J("ngIf",!t.isLoading&&0===t.filteredCountries.length&&!t.selectedMetroId))},directives:[g.O5,f.bk,v.m,y.Fj,y.JJ,y.On,b.O,g.sg,_.YY],pipes:[m.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-metro-selector-popup{display:block;max-width:100%;width:940px}mv-metro-selector-popup .header{display:flex}mv-metro-selector-popup .header .choose-metro{font-size:inherit;cursor:default}mv-metro-selector-popup .header .close-search{cursor:pointer}mv-metro-selector-popup .header>span{font-size:1.1764705882rem}mv-metro-selector-popup .header>span:first-of-type{flex-grow:1}mv-metro-selector-popup svg-icon{margin:auto;background-repeat:no-repeat no-repeat;display:inline-block;vertical-align:middle;fill:currentColor;height:24px;width:24px}mv-metro-selector-popup svg-icon svg{fill:currentColor;pointer-events:none;display:block;height:100%;width:100%}mv-metro-selector-popup svg-icon.svg-icon-arrow{color:#0000008a}mv-metro-selector-popup svg-icon .cls-1{fill:#bdc3c7}mv-metro-selector-popup a,mv-metro-selector-popup button{color:inherit;text-decoration:none}mv-metro-selector-popup>.content{box-sizing:border-box;max-height:50vh;overflow:auto;padding:16px 35px;position:relative;width:100%}mv-metro-selector-popup>.content .overlay{background:none transparent;z-index:9;padding:10px;display:flex;align-items:center;justify-content:center}mv-metro-selector-popup>.content .empty-results{box-sizing:border-box;color:#292a30;padding:30px 0;text-align:center}mv-metro-selector-popup>.content .metro-selection .countries-container .country.selected{background:none}html[dir=ltr] mv-metro-selector-popup>.content .metro-selection .countries-container .country.selected{padding-left:0}html[dir=rtl] mv-metro-selector-popup>.content .metro-selection .countries-container .country.selected{padding-right:0}mv-metro-selector-popup>.content .countries-container{width:100%}mv-metro-selector-popup>.content .countries-container .country{font-size:.8235294118rem;color:#292a30;box-sizing:border-box;display:inline-table;padding:11px 0 12px;vertical-align:top;transition:all .3s;width:32%}html[dir=ltr] mv-metro-selector-popup>.content .countries-container .country{margin-right:2%}html[dir=rtl] mv-metro-selector-popup>.content .countries-container .country{margin-left:2%}html[dir=ltr] mv-metro-selector-popup>.content .countries-container .country:nth-child(3n){margin-right:0}html[dir=rtl] mv-metro-selector-popup>.content .countries-container .country:nth-child(3n){margin-left:0}mv-metro-selector-popup>.content .countries-container .country.selected{background:rgba(236,240,241,.4)}html[dir=ltr] mv-metro-selector-popup>.content .countries-container .country.selected{padding-left:10px}html[dir=rtl] mv-metro-selector-popup>.content .countries-container .country.selected{padding-right:10px}mv-metro-selector-popup>.content .countries-container .country:hover{background:rgba(236,240,241,.4)}html[dir=ltr] mv-metro-selector-popup>.content .countries-container .country:hover{padding-left:10px}html[dir=rtl] mv-metro-selector-popup>.content .countries-container .country:hover{padding-right:10px}mv-metro-selector-popup>.content .countries-container .country .name{display:table-cell;line-height:26px;vertical-align:middle;width:100%}mv-metro-selector-popup>.content .countries-container .country mvf-image{display:table-cell;vertical-align:middle}html[dir=ltr] mv-metro-selector-popup>.content .countries-container .country mvf-image{padding-right:10px}html[dir=rtl] mv-metro-selector-popup>.content .countries-container .country mvf-image{padding-left:10px}mv-metro-selector-popup>.content .countries-container .country mvf-image img{height:18px;position:relative;top:1px;transition:all .3s}mv-metro-selector-popup>.content .metros-container{border-top:1px solid #DDDDDD;padding-top:10px;width:100%}mv-metro-selector-popup>.content .metros-container .metro{box-sizing:border-box;display:inline-block;padding:10px 0;position:relative;vertical-align:top;width:32%;transition:all .3s}html[dir=ltr] mv-metro-selector-popup>.content .metros-container .metro{padding-right:10px}html[dir=rtl] mv-metro-selector-popup>.content .metros-container .metro{padding-left:10px}html[dir=ltr] mv-metro-selector-popup>.content .metros-container .metro{text-align:left}html[dir=rtl] mv-metro-selector-popup>.content .metros-container .metro{text-align:right}mv-metro-selector-popup>.content .metros-container .metro.ng-animate{transition:0s none}mv-metro-selector-popup>.content .metros-container .metro.selected{cursor:default;font-weight:700}mv-metro-selector-popup>.content .metros-container .metro.selected:before{opacity:1}mv-metro-selector-popup>.content .metros-container .metro.selected:hover{color:#292a30}mv-metro-selector-popup>.content .metros-container .metro:hover{color:#2196f3}mv-metro-selector-popup>.content .metros-container .metro .name{line-height:16px;vertical-align:top}mv-metro-selector-popup .empty-results .icon,mv-metro-selector-popup .empty-results span{display:block}mv-metro-selector-popup .empty-results .icon{width:32px;height:32px;margin-bottom:15px}mv-metro-selector-popup .search-results .countries-container .country button{cursor:pointer}mv-metro-selector-popup .search-results .countries-container .country:hover{background:#fff}html[dir=ltr] mv-metro-selector-popup .search-results .countries-container .country:hover{padding-left:0}html[dir=rtl] mv-metro-selector-popup .search-results .countries-container .country:hover{padding-right:0}mv-metro-selector-popup .search-results .country-result{padding-top:12px}mv-metro-selector-popup .search-results .country-result:first-child{padding-top:0}mv-metro-selector-popup .search-results .country-result .metro{padding:0 0 20px;cursor:pointer}mv-metro-selector-popup .header{background:#fff;border-bottom:1px solid #DDDDDD;box-sizing:border-box;margin:0;padding:34px 0 14px;top:0;width:calc(100% - 70px);z-index:1}html[dir=ltr] mv-metro-selector-popup .header{margin-left:35px}html[dir=rtl] mv-metro-selector-popup .header{margin-right:35px}html[dir=ltr] mv-metro-selector-popup .header{left:0}html[dir=rtl] mv-metro-selector-popup .header{right:0}mv-metro-selector-popup .header .arrow-icon{display:inline-block;height:10px;margin:0 3px;position:relative;top:-1px;width:5px}mv-metro-selector-popup .header .arrow-icon:hover{cursor:pointer}html[dir=rtl] mv-metro-selector-popup .header .arrow-icon{transform:scalex(-1);margin:0 4px;right:3px}mv-metro-selector-popup .header button{font-size:1.1764705882rem;transition:all .3s}mv-metro-selector-popup .header button:hover{color:#2196f3}mv-metro-selector-popup .header button:last-of-type:hover{color:#292a30;cursor:default}mv-metro-selector-popup .header button.ng-enter{opacity:0;transition:all .3s}html[dir=ltr] mv-metro-selector-popup .header button.ng-enter{left:-4px}html[dir=rtl] mv-metro-selector-popup .header button.ng-enter{right:-4px}mv-metro-selector-popup .header button.ng-enter.ng-enter-active{opacity:1}html[dir=ltr] mv-metro-selector-popup .header button.ng-enter.ng-enter-active{left:0}html[dir=rtl] mv-metro-selector-popup .header button.ng-enter.ng-enter-active{right:0}mv-metro-selector-popup .header button.ng-leave{opacity:1;transition:all .3s}mv-metro-selector-popup .header button.ng-leave.ng-leave-active{opacity:0}mv-metro-selector-popup .header .filter-container{background:#ECF0F1;border-radius:4px;display:flex;align-items:center;margin-top:-16px;position:relative}html[dir=ltr] mv-metro-selector-popup .header .filter-container{padding-right:26px}html[dir=rtl] mv-metro-selector-popup .header .filter-container{padding-left:26px}html[dir=ltr] mv-metro-selector-popup .header .filter-container{padding-left:36px}html[dir=rtl] mv-metro-selector-popup .header .filter-container{padding-right:36px}mv-metro-selector-popup .header .filter-container:hover .clear-input{opacity:1}mv-metro-selector-popup .header .filter-container .input-icon{position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-metro-selector-popup .header .filter-container .input-icon{left:9px}html[dir=rtl] mv-metro-selector-popup .header .filter-container .input-icon{right:9px}mv-metro-selector-popup .header .filter-container .input-icon svg-icon{height:16px;width:16px}mv-metro-selector-popup .header .filter-container input{background:none;border:none;height:34px;line-height:34px;width:180px;transition:all .3s}mv-metro-selector-popup .header .filter-container input:focus{outline:none;width:200px}mv-metro-selector-popup .header .filter-container .clear-input{cursor:pointer;opacity:0;position:absolute;transform:translateY(-50%);transition:opacity .3s;top:50%}html[dir=ltr] mv-metro-selector-popup .header .filter-container .clear-input{right:6px}html[dir=rtl] mv-metro-selector-popup .header .filter-container .clear-input{left:6px}mv-metro-selector-popup .header .filter-container .clear-input:focus{outline:auto;opacity:1}mv-metro-selector-popup .header .filter-container .clear-input svg-icon{color:#bdc3c7;height:9.33px;width:9.33px}mv-metro-selector-popup .header .filter-container .setting-filter:focus+.clear-input{opacity:1}mv-metro-selector-popup .header .filter-container .setting-filter::-webkit-search-decoration,mv-metro-selector-popup .header .filter-container .setting-filter::-webkit-search-cancel-button,mv-metro-selector-popup .header .filter-container .setting-filter::-webkit-search-results-button{display:none}mv-metro-selector-popup .footer{background:#f3f6f8;border-top:1px solid #DDDDDD;bottom:0;box-sizing:border-box;display:table;height:63px;margin:0;padding:15px 35px;width:100%}html[dir=ltr] mv-metro-selector-popup .footer{left:0}html[dir=rtl] mv-metro-selector-popup .footer{right:0}mv-metro-selector-popup .footer .community-banner,mv-metro-selector-popup .footer .button-container{display:table-cell;vertical-align:middle;width:100%;transition:opacity .3s}mv-metro-selector-popup .footer .community-banner.ng-enter,mv-metro-selector-popup .footer .button-container.ng-enter{opacity:0}mv-metro-selector-popup .footer .community-banner.ng-enter.ng-enter-active,mv-metro-selector-popup .footer .button-container.ng-enter.ng-enter-active{opacity:1}mv-metro-selector-popup .footer .community-banner.ng-leave,mv-metro-selector-popup .footer .button-container.ng-leave{opacity:1}mv-metro-selector-popup .footer .community-banner.ng-leave.ng-leave-active,mv-metro-selector-popup .footer .button-container.ng-leave.ng-leave-active{opacity:0}mv-metro-selector-popup .footer .button-container{white-space:nowrap}html[dir=ltr] mv-metro-selector-popup .footer .button-container{text-align:right}html[dir=rtl] mv-metro-selector-popup .footer .button-container{text-align:left}mv-metro-selector-popup .footer .lang-select{margin-top:0}html[dir=ltr] mv-metro-selector-popup .footer .lang-select{float:left}html[dir=rtl] mv-metro-selector-popup .footer .lang-select{float:right}html[dir=ltr] mv-metro-selector-popup .footer .lang-select span{margin-right:8px}html[dir=rtl] mv-metro-selector-popup .footer .lang-select span{margin-left:8px}mv-metro-selector-popup .footer .metro-select{margin:18px 0 12px}mv-metro-selector-popup .footer button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#0078D6;border:none;border-radius:4px;color:#fff;height:32px;line-height:32px;padding:0 20px;text-align:center;transition:all .3s}mv-metro-selector-popup .footer button:hover,mv-metro-selector-popup .footer button:focus{background:#006abd;cursor:pointer;outline:none}mv-metro-selector-popup close-button{background:black;display:none;position:absolute;top:0}html[dir=ltr] mv-metro-selector-popup close-button{right:14px}html[dir=rtl] mv-metro-selector-popup close-button{left:14px}\n"],encapsulation:2}),e})()},25634:function(e,t,n){"use strict";n.d(t,{p:function(){return A}});var i=n(3786),r=n(52959),o=n(2316),a=n(5971),s=n(67839),l=n(1564),c=n(95505),d=n(1238),u=n(1437),p=n(61787),h=n(2339),m=n(54364),g=n(90248),f=n(87479),v=n(93975),y=n(53448),b=n(32066);const _=["searchInput"];function T(e,t){1&e&&(o.TgZ(0,"div",3),o._UZ(1,"mv-spinner"),o.qZA())}function S(e,t){1&e&&(o._UZ(0,"svg-icon",19),o.ALo(1,"translate")),2&e&&(o.s9C("titleText",o.lcZ(1,2,"a11y_checked_icon")),o.Q6J("src","images/selected.svg"))}function x(e,t){1&e&&(o._UZ(0,"svg-icon",19),o.ALo(1,"translate")),2&e&&(o.s9C("titleText",o.lcZ(1,2,"a11y_checked_icon")),o.Q6J("src","images/selected.svg"))}function w(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"li",22),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(4).selectMetro(t)})("keydown.enter",function(){const t=o.CHM(e).$implicit;return o.oxw(4).selectMetro(t)}),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.YNc(3,x,2,4,"svg-icon",17),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(4);o.ekj("selected",n.isMetroSelected(e)),o.uIk("id",n.getMetroElementId(e)),o.xp6(2),o.Oqu(e.name),o.xp6(1),o.Q6J("ngIf",n.isMetroSelected(e))}}function k(e,t){if(1&e&&(o.TgZ(0,"ul",20),o.YNc(1,w,4,5,"li",21),o.qZA()),2&e){const e=o.oxw().$implicit,t=o.oxw(2);o.uIk("aria-activedescendant",t.ariaSelectedMetro),o.xp6(1),o.Q6J("ngForOf",t.getFilteredMetros(e))}}function M(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"li",13),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).toggleCountry(t)})("keydown.enter",function(){const t=o.CHM(e).$implicit;return o.oxw(2).toggleCountry(t)}),o.TgZ(1,"div",14),o._UZ(2,"mvf-image",15),o.TgZ(3,"div",16),o.TgZ(4,"span"),o._uU(5),o.qZA(),o.qZA(),o.qZA(),o.YNc(6,S,2,4,"svg-icon",17),o.YNc(7,k,2,2,"ul",18),o.qZA()}if(2&e){const e=t.$implicit,n=o.oxw(2);o.ekj("selected",n.isCountrySelected(e)),o.uIk("id",n.getCountryElementId(e)),o.xp6(2),o.Q6J("imageId",e.flagImageId)("imageAlt",e.altText),o.xp6(3),o.Oqu(e.name),o.xp6(1),o.Q6J("ngIf",n.isCountrySelected(e)),o.xp6(1),o.Q6J("ngIf",n.isActiveCountry(e)||n.metroSearch)}}function L(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"div",4),o.TgZ(2,"span",5),o._UZ(3,"svg-icon",6),o.ALo(4,"translate"),o.qZA(),o.TgZ(5,"input",7,8),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().metroSearch=t})("ngModelChange",function(){return o.CHM(e),o.oxw().onSearch()}),o.ALo(7,"translate"),o.ALo(8,"translate"),o.qZA(),o.TgZ(9,"a",9),o.NdJ("click",function(){return o.CHM(e),o.oxw().clearSearch()})("keydown.enter",function(){return o.CHM(e),o.oxw().clearSearch()}),o._UZ(10,"svg-icon",10),o.ALo(11,"translate"),o.qZA(),o.qZA(),o.TgZ(12,"ul",11),o.YNc(13,M,8,8,"li",12),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(3),o.s9C("titleText",o.lcZ(4,7,"action_search")),o.xp6(2),o.s9C("placeholder",o.lcZ(7,9,"web_search_metro_hint")),o.Q6J("ngModel",e.metroSearch),o.uIk("title",o.lcZ(8,11,"web_search_metro_hint")),o.xp6(5),o.s9C("titleText",o.lcZ(11,13,"action_close")),o.xp6(2),o.uIk("aria-activedescendant",e.ariaSelectedCountry),o.xp6(1),o.Q6J("ngForOf",e.filteredCountries)}}let A=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this.store=e,this.countriesService=t,this.metroActions=n,this.routingService=i,this.globalActions=r,this.analyticsService=o,this.canonicalService=a,this.translate=s,this._cd=l,this.countries=[],this.metroSearch="",this.metroSearchLowercase="",this.isLoading=!1,this.filteredCountries=[]}ngOnInit(){this.load()}get state(){return this.store.getState()}getFilteredCountries(){return this.metroSearch?this.countries.filter(e=>e.name.includes(this.metroSearchLowercase)||this.getFilteredMetros(e).length>0):this.countries}getFilteredMetros(e){return e.metros.filter(e=>e.searchTerm.toLowerCase().includes(this.metroSearchLowercase.toLowerCase()))}getCountrySelection(){const e=this.state.metro.currentMetro,t={countries:this.state.global.countries,selectedCountry:null,selectedMetro:null};for(const n of t.countries)n.altText=this.translate.instant("a11y_country_icon",{COUNTRY:n.name});for(const n of t.countries)if(n.name==e.countryName){t.selectedCountry=n,t.selectedMetro=e;break}return t}load(){return(0,i.mG)(this,void 0,void 0,function*(){this.isLoading=!0,yield(0,r.p5)(this.store),yield this.store.dispatch(this.globalActions.loadCountries());const e=this.getCountrySelection();this.countries=e.countries,this.filteredCountries=this.countries,this.selectedCountry=e.selectedCountry,this.selectedMetro=e.selectedMetro,this.isLoading=!1,this._cd.detectChanges(),this.searchInput.nativeElement.focus()})}onSearch(){this.metroSearchLowercase=this.metroSearch.toLowerCase(),this.filteredCountries=this.getFilteredCountries()}toggleCountry(e){this.activeCountry=this.activeCountry==e?null:e}selectMetro(e){return(0,i.mG)(this,void 0,void 0,function*(){this.isMetroSelected(e)||(yield this.store.dispatch(this.globalActions.setMetro(e.metroId)),this.analyticsService.trackMetroChanged(e.metroId)),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([":default"]))})}isCountrySelected(e){return this.selectedCountry==e}isMetroSelected(e){return this.state.metro.metroId==e.metroId}isActiveCountry(e){return e==this.activeCountry}clearSearch(){this.metroSearch="",this.filteredCountries=this.countries}getCountryElementId(e){return`country-${null==e?void 0:e.name}`}get ariaSelectedCountry(){var e;return(null===(e=this.selectedCountry)||void 0===e?void 0:e.name)?this.getCountryElementId(this.selectedCountry):null}getMetroElementId(e){return`metro-${e.metroId}`}get ariaSelectedMetro(){var e;return this.state.metro.metroId&&(null===(e=this.activeCountry)||void 0===e?void 0:e.metros.find(e=>e.metroId===this.state.metro.metroId))?this.getMetroElementId(this.state.metro):null}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.d),o.Y36(s.K),o.Y36(l.L),o.Y36(c.Z),o.Y36(d.l),o.Y36(u.y),o.Y36(p.z),o.Y36(h.sK),o.Y36(o.sBO))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-metro-selector"]],viewQuery:function(e,t){if(1&e&&o.Gf(_,5),2&e){let e;o.iGM(e=o.CRH())&&(t.searchInput=e.first)}},decls:5,vars:5,consts:[["role","heading","aria-level","1",1,"header","settings"],["class","spinner",4,"ngIf"],[4,"ngIf"],[1,"spinner"],["role","search",1,"filter-container"],["role","presentation",1,"input-icon"],["src","images/icons/search.svg","mvAccessibleSVG","",3,"titleText"],["type","text",1,"setting-filter",3,"ngModel","placeholder","ngModelChange"],["searchInput",""],["role","button","tabindex","0",1,"clear-input",3,"click","keydown.enter"],["src","images/icons/close.svg","mvAccessibleSVG","",3,"titleText"],["role","list",1,"list-view"],["role","listitem","tabindex","0",3,"selected","click","keydown.enter",4,"ngFor","ngForOf"],["role","listitem","tabindex","0",3,"click","keydown.enter"],["role","button",1,"flex-row"],[1,"settings-country-flag",3,"imageId","imageAlt"],["layout","column","layout-align","center","flex","",1,"country-name"],["class","selected","mvAccessibleSVG","",3,"src","titleText",4,"ngIf"],["class","metros list-view","role","list",4,"ngIf"],["mvAccessibleSVG","",1,"selected",3,"src","titleText"],["role","list",1,"metros","list-view"],["tabIndex","0","role","listitem",3,"selected","click","keydown.enter",4,"ngFor","ngForOf"],["tabIndex","0","role","listitem",3,"click","keydown.enter"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._uU(1),o.ALo(2,"translate"),o.qZA(),o.YNc(3,T,2,0,"div",1),o.YNc(4,L,14,15,"div",2)),2&e&&(o.xp6(1),o.hij(" ",o.lcZ(2,3,"select_metro_title"),"\n"),o.xp6(2),o.Q6J("ngIf",t.isLoading),o.xp6(1),o.Q6J("ngIf",!t.isLoading))},directives:[m.O5,g.O,f.bk,v.m,y.Fj,y.JJ,y.On,m.sg,b.YY],pipes:[h.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-metro-selector{display:block;-webkit-overflow-scrolling:touch;position:relative}.has-footer mv-metro-selector{padding-bottom:60px}mv-metro-selector .spinner{margin-top:50px;text-align:center}mv-metro-selector .filter-container{background:#FFFFFF;border-radius:4px;position:relative;margin:15px 20px}html[dir=ltr] mv-metro-selector .filter-container{padding-right:26px}html[dir=rtl] mv-metro-selector .filter-container{padding-left:26px}html[dir=ltr] mv-metro-selector .filter-container{padding-left:36px}html[dir=rtl] mv-metro-selector .filter-container{padding-right:36px}mv-metro-selector .filter-container .input-icon{position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-metro-selector .filter-container .input-icon{left:9px}html[dir=rtl] mv-metro-selector .filter-container .input-icon{right:9px}mv-metro-selector .filter-container .input-icon svg-icon{height:16px;width:16px}mv-metro-selector .filter-container input{background:none;border:none;height:34px;line-height:2rem;width:100%;font-size:.9411764706rem}mv-metro-selector .filter-container input:focus{outline:none;transition:all .3s}mv-metro-selector .filter-container .clear-input{cursor:pointer;position:absolute;transform:translateY(-50%);transition:opacity .3s;top:50%}html[dir=ltr] mv-metro-selector .filter-container .clear-input{right:10px}html[dir=rtl] mv-metro-selector .filter-container .clear-input{left:10px}mv-metro-selector .filter-container .clear-input svg-icon,mv-metro-selector .filter-container .clear-input svg-icon svg{color:#bdc3c7;height:.5882352941rem;width:.5882352941rem}mv-metro-selector .filter-container .clear-input svg-icon .cls-1,mv-metro-selector .filter-container .clear-input svg-icon svg .cls-1{fill:#bdc3c7}mv-metro-selector ul.list-view{box-shadow:0 2px 3px -1px #0000004d;padding:0;margin:0}mv-metro-selector ul.list-view li{display:flex;flex-direction:column;box-sizing:border-box;position:relative;background:#fff;height:auto;border-bottom:1px solid #DDDDDD;padding:12px 0;font-size:.8235294118rem;color:#292a30}html[dir=ltr] mv-metro-selector ul.list-view li{padding-left:20px}html[dir=rtl] mv-metro-selector ul.list-view li{padding-right:20px}mv-metro-selector ul.list-view li .flex-row{align-items:center}mv-metro-selector ul.list-view li:after{content:url(/images/icons/expand_light_gray.svg);display:block;position:absolute;top:50%;transform:translateY(-50%);width:.5882352941rem}html[dir=ltr] mv-metro-selector ul.list-view li:after{right:20px}html[dir=rtl] mv-metro-selector ul.list-view li:after{left:20px}mv-metro-selector ul.list-view li:last-child{border-bottom:none}mv-metro-selector ul.list-view li .metros li:after{display:none}mv-metro-selector ul.list-view li.selected{color:#0078d6}mv-metro-selector ul.list-view li.selected:after{display:none}mv-metro-selector ul.list-view li svg-icon.selected{position:absolute;top:50%;transform:translateY(-50%);width:.7058823529rem;height:.7058823529rem;margin:0}html[dir=ltr] mv-metro-selector ul.list-view li svg-icon.selected{right:20px}html[dir=rtl] mv-metro-selector ul.list-view li svg-icon.selected{left:20px}mv-metro-selector ul.list-view li svg-icon.selected svg .cls-1{fill:#0078d6}html[dir=ltr] mv-metro-selector ul.list-view .country-name{margin-left:10px}html[dir=rtl] mv-metro-selector ul.list-view .country-name{margin-right:10px}mv-metro-selector ul.metros{background:#fff;box-shadow:none;padding-top:13px;z-index:1}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-metro-selector ul.metros{display:flex;flex-wrap:wrap}}mv-metro-selector ul.metros.ng-enter{transition:all .3s;padding-top:0;opacity:0}mv-metro-selector ul.metros.ng-enter.ng-enter-active{padding-top:13px;opacity:1}mv-metro-selector ul.metros.ng-leave{opacity:1;padding-top:13px;transition:all .3s}mv-metro-selector ul.metros.ng-leave.ng-leave-active{opacity:0;padding-top:0}mv-metro-selector ul.metros li{border-bottom:none;padding:8px 0}html[dir=ltr] mv-metro-selector ul.metros li{padding-left:0}html[dir=rtl] mv-metro-selector ul.metros li{padding-right:0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-metro-selector ul.metros li{flex-basis:33%}}\n"],encapsulation:2}),e})()},97971:function(e,t,n){"use strict";n.d(t,{M:function(){return y}});const i={61:"Roma e Lazio",322:"Rio de Janeiro e Regi\xe3o",242:"S\xe3o Paulo e Regi\xe3o",143:"Toronto, ON",302:"Los Angeles, CA",1:"Israel",21:"Madrid",442:"Sydney & NSW",822:"Ciudad de M\xe9xico",1082:"Greater Kuala Lumpur / Klang Valley",762:"Bogot\xe1",1563:"\u0130stanbul & Kocaeli",1678:"Singapore",1702:"Bras\xedlia e Entorno do DF",1602:"Buenos Aires y La Plata",2044:"Jabodetabek",2122:"London and South East",2741:"Hong Kong - \u9999\u6e2f",2401:"Bangkok",2960:"Bucure\u0219ti",902:"Moscow - \u041c\u043e\u0441\u043a\u0432\u0430",121:"NYC-NJ",2900:"Guadalajara",1663:"Berlin/Brandenburg",3749:"Rhein-Ruhr Region",843:"Belo Horizonte e Regi\xe3o",3801:"Delhi",642:"Santiago",1822:"Athens - \u0391\u03b8\u03ae\u03bd\u03b1",2082:"Saint Petersburg - \u0421\u0430\u043d\u043a\u0442-\u041f\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433",983:"Fortaleza e Regi\xe3o",662:"Paris",362:"Barcelona",1084:"Helsinki",223:"Milano e Lombardia"};var r=n(16438),o=n(94943),a=n(2316),s=n(5971),l=n(2339),c=n(95505),d=n(61787),u=n(7935),p=n(1437),h=n(15208),m=n(22213),g=n(54364);const f=function(e){return{METRO_NAME:e}};function v(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"a",1),a.NdJ("click",function(){return a.CHM(e),a.oxw().openMetroSelector()})("keydown.enter",function(){return a.CHM(e),a.oxw().openMetroSelector()}),a.ALo(1,"translate"),a._uU(2),a.qZA()}if(2&e){const e=a.oxw();a.uIk("aria-label",a.xi3(1,2,"a11y_change_metro",a.VKq(5,f,e.state.metro.currentMetro.metroAreaName))),a.xp6(2),a.hij(" ",e.countryCode,"\n")}}let y=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.store=e,this.translate=t,this.routingService=n,this.canonicalService=i,this.splashDisplay=r,this.analyticsService=o,this.platformService=a,this.dialogService=s}get state(){return this.store.getState()}get customer(){return this.state.customer.currentCustomer}get currentMetroAreaName(){if(!this.state.customer.currentCustomer)return"";const e=this.state.customer.currentCustomer.designConfiguration&&this.state.customer.currentCustomer.designConfiguration.metroSwitcherTextOverrides;return e?this.routingService.getCurrentRouteData().subTabId!=r.zA.TRIPPLAN_MAP&&this.routingService.getCurrentRouteData().subTabId!=r.zA.TRIPPLAN_ITINERARY||!e.itinerary?e.default:this.translate.instant(e.itinerary):this.state.metro.currentMetro?this.state.metro.currentMetro.metroAreaName:function(){const e=new URLSearchParams(location.search).get("metroId");return e&&i[e]?i[e]:""}()}get shouldShow(){return!!this.currentMetroAreaName}get hideSelection(){return!this.customer||this.customer.designConfiguration.hideMetroSelection}get metroNameAriaLabel(){var e;const t=null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.metroAreaName;return this.translate.instant("a11y_change_metro",{METRO_NAME:t})}get countryCode(){var e;return null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.countryCode}openMetroSelector(){if(this.state.global.splashScreen&&this.splashDisplay.invokeDismissal(),this.platformService.isDesktop)return this.dialogService.open(o.h,{autoFocus:!0});this.customer.designConfiguration.hideMetroSelection||(this.analyticsService.trackOpenMetroSelectorView(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["metro",":locale"])))}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(s.d),a.Y36(l.sK),a.Y36(c.Z),a.Y36(d.z),a.Y36(u.Y),a.Y36(p.y),a.Y36(h.mi),a.Y36(m.uw))},e.\u0275cmp=a.Xpm({type:e,selectors:[["mv-metro-switcher"]],decls:1,vars:1,consts:[["role","button","tabindex","0",3,"click","keydown.enter",4,"ngIf"],["role","button","tabindex","0",3,"click","keydown.enter"]],template:function(e,t){1&e&&a.YNc(0,v,3,7,"a",0),2&e&&a.Q6J("ngIf",t.shouldShow&&!t.hideSelection)},directives:[g.O5],pipes:[l.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-metro-switcher{flex-grow:1}html[dir=ltr] mv-metro-switcher{margin-left:8px}html[dir=rtl] mv-metro-switcher{margin-right:8px}mv-metro-switcher a{font-size:.7058823529rem;color:#bcc2c8;height:.9411764706rem;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:flex;align-items:center;letter-spacing:-.0141176471rem}mv-metro-switcher a:before{content:"";background:url(/images/icons/metro-area-globe.svg) center/cover;display:inline-block;position:relative;width:.9411764706rem;height:.9411764706rem}html[dir=ltr] mv-metro-switcher a:before{margin-right:4px}html[dir=rtl] mv-metro-switcher a:before{margin-left:4px}mv-metro-switcher a.hide-selection:after{display:none}.app-container.desktop mv-metro-switcher a:before{display:none}.app-container.desktop mv-metro-switcher a:after{content:"";background:url(/images/icons/arrow_gray.svg) center/cover;display:inline-block;position:relative;width:.4705882353rem;height:.4705882353rem;transform:rotate(90deg)}html[dir=ltr] .app-container.desktop mv-metro-switcher a:after{margin-left:4px}html[dir=rtl] .app-container.desktop mv-metro-switcher a:after{margin-right:4px}\n'],encapsulation:2}),e})()},58463:function(e,t,n){"use strict";n.d(t,{a:function(){return L}});var i=n(52959),r=n(99528),o=n(54364),a=n(51063),s=n(2316),l=n(1210),c=n(1437),d=n(1238),u=n(5306),p=n(5971),h=n(2339),m=n(17857),g=n(87479),f=n(56329);const v=function(e){return{LINE:e}};function y(e,t){if(1&e&&(s._UZ(0,"div",12),s.ALo(1,"correctLineName"),s.ALo(2,"translate")),2&e){const e=s.oxw(2);s.Q6J("innerHtml",s.lcZ(1,1,s.xi3(2,3,e.bannerTextKey(e.CustomCtaType.Line),s.VKq(6,v,e.state.global.customCtaText))),s.oJD)}}const b=function(e,t){return{POI:e,DESTINATION:t}};function _(e,t){if(1&e&&(s._UZ(0,"div",13),s.ALo(1,"translate")),2&e){const e=s.oxw(2);s.Q6J("innerHtml",s.xi3(1,1,e.bannerTextKey(e.CustomCtaType.POI),s.WLB(4,b,e.state.global.customCtaText,e.state.global.customCtaText)),s.oJD)}}function T(e,t){1&e&&(s.TgZ(0,"div",14),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"web_banner_text_test_a")))}function S(e,t){1&e&&(s.TgZ(0,"div",15),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"web_banner_text_test_b")))}function x(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",16),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).onBannerClick()})("keydown.enter",function(){return s.CHM(e),s.oxw(2).onBannerClick()}),s.ALo(1,"translate"),s._uU(2),s.ALo(3,"translate"),s.qZA()}if(2&e){const e=s.oxw(2);s.Q6J("href",e.bannerUrl("bottom"),s.LSH),s.uIk("aria-label",s.lcZ(1,3,"download_button")),s.xp6(2),s.Oqu(s.lcZ(3,5,"web_download_button"))}}function w(e,t){if(1&e&&s._UZ(0,"mv-store-banner",17),2&e){const e=s.oxw(2);s.Q6J("isBadgeAbTest",e.isStoreBadgeTest)}}function k(e,t){if(1&e&&(s.ynx(0),s.TgZ(1,"div",2),s.TgZ(2,"div",3),s._UZ(3,"div",4),s.YNc(4,y,3,8,"div",5),s.YNc(5,_,2,7,"div",6),s.YNc(6,T,3,3,"div",7),s.YNc(7,S,3,3,"div",8),s.qZA(),s.TgZ(8,"div",9),s.YNc(9,x,4,7,"a",10),s.qZA(),s.YNc(10,w,1,1,"mv-store-banner",11),s.qZA(),s.BQk()),2&e){const e=s.oxw();s.xp6(4),s.Q6J("ngIf",e.isLineBanner),s.xp6(1),s.Q6J("ngIf",e.isPoiBanner),s.xp6(1),s.Q6J("ngIf",e.isGenericBanner),s.xp6(1),s.Q6J("ngIf",e.isGenericBanner),s.xp6(2),s.Q6J("ngIf",!e.isStoreBadgeTest),s.xp6(1),s.Q6J("ngIf",e.isStoreBadgeTest)}}function M(e,t){if(1&e){const e=s.EpF();s._UZ(0,"svg-icon",18),s.TgZ(1,"div",19),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",20),s.TgZ(5,"a",21),s.NdJ("click",function(){return s.CHM(e),s.oxw().onBannerClick()}),s._uU(6),s.ALo(7,"translate"),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.xp6(2),s.Oqu(s.lcZ(3,3,"banner_better_in_app")),s.xp6(3),s.Q6J("href",e.bannerUrl("top"),s.LSH),s.xp6(1),s.Oqu(s.lcZ(7,5,e.topBannerCtaKey))}}let L=(()=>{class e{constructor(e,t,n,i,o,a,s,l){this._cd=e,this.deepLinkService=t,this.analyticsService=n,this.globalActions=i,this.universal=o,this.store=a,this.translate=s,this.document=l,this.CustomCtaType=r.pR}get state(){return this.store.getState()}get isLineBanner(){return this.state.global.customCtaType===r.pR.Line}get isPoiBanner(){return this.state.global.customCtaType===r.pR.POI}get isGenericBanner(){return!this.isLineBanner&&!this.isPoiBanner}ngOnInit(){this.universal.isBrowser&&(0,i.wZ)().then(()=>{this.runChangeDetection(),this.redux$=this.store.subscribe(()=>this.runChangeDetection())})}ngAfterViewInit(){this.abTest=(0,a.L)("data-banner-1-text-by-type",this.document),this.isStoreBadgeTest=!!(0,a.L)("data-banner-store-badge",this.document),this.topBannerAbtest=(0,a.L)("data-top-banner",this.document),this.topBannerAbtest&&("V1"==this.topBannerAbtest.variant?this.topBannerCtaKey="action_open":"V2"==this.topBannerAbtest.variant&&(this.topBannerCtaKey="download_button"))}ngOnDestroy(){this.redux$&&this.redux$()}runChangeDetection(){this._cd.destroyed?this.redux$&&this.redux$():this._cd.detectChanges()}bannerUrl(e){const t=this.deepLinkService.getStoreOrDeepLink("footer","footer",this.deepLinkService.getDeepLinkType());return this.topBannerAbtest?this.deepLinkService.getBannerTestUrl(this.topBannerAbtest,t,e):t}onBannerClick(){this.analyticsService.trackStoreClick("footer")}bannerTextKey(e){var t;const n=e===r.pR.POI?"poi":"line";let i=null;if("data-banner-1-text-by-type"===(null===(t=this.abTest)||void 0===t?void 0:t.name))switch(this.abTest.variant){case"V1":i=`web_banner_text_${n}1`;break;case"V2":i=`web_banner_text_${n}2`}return i||(e===r.pR.POI?"splash_text_test_poi_easier":"splash_text_test_lines_easier")}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(s.sBO),s.Y36(l.Qz),s.Y36(c.y),s.Y36(d.l),s.Y36(u.p),s.Y36(p.d),s.Y36(h.sK),s.Y36(o.K0))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-mobile-app-cta"]],inputs:{showTopBanner:"showTopBanner"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["topBanner",""],[1,"cta-wrapper"],[1,"app-text-container"],[1,"bus-icon"],["class","title lines",3,"innerHtml",4,"ngIf"],["class","title poi",3,"innerHtml",4,"ngIf"],["class","title",4,"ngIf"],["class","subtitle",4,"ngIf"],[1,"app-button-container"],["class","cta-button","tabindex","0",3,"href","click","keydown.enter",4,"ngIf"],["class","cta-badge","tabindex","0",3,"isBadgeAbTest",4,"ngIf"],[1,"title","lines",3,"innerHtml"],[1,"title","poi",3,"innerHtml"],[1,"title"],[1,"subtitle"],["tabindex","0",1,"cta-button",3,"href","click","keydown.enter"],["tabindex","0",1,"cta-badge",3,"isBadgeAbTest"],["src","images/store-buttons/brand-app-icon-i-os.svg",1,"moovit-icon"],[1,"banner-text"],[1,"top-cta-wrapper"],[1,"cta",3,"href","click"]],template:function(e,t){if(1&e&&(s.YNc(0,k,11,6,"ng-container",0),s.YNc(1,M,8,7,"ng-template",null,1,s.W1O)),2&e){const e=s.MAs(2);s.Q6J("ngIf",!t.showTopBanner)("ngIfElse",e)}},directives:[o.O5,m.n,g.bk],pipes:[f.a,h.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}html.privacy-notice body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary mv-header,html.privacy-notice body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary-map mv-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary mv-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary-map mv-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary mv-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary-map mv-header{top:4.7058823529rem!important}html.privacy-notice body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary .content-container,html.privacy-notice body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary-map .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary-map .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary-map .content-container{margin-top:calc(4.7058823529rem + 4.7058823529rem)!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container[class*=input-focused] mv-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container[class*=input-focused] mv-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container[class*=input-focused] mv-header{top:0!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container{margin-top:105px!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container[class*=input-focused]:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner{top:0!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary mv-header,html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary-map mv-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary mv-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary-map mv-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary mv-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary-map mv-header{top:0!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary .content-container{margin-top:8.2941176471rem!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary .content-container mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary .content-container mv-itinerary-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary .content-container mv-itinerary-header{top:80px!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.trip-plan-itinerary-map .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.trip-plan-itinerary-map .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.trip-plan-itinerary-map .content-container{margin-top:4.7058823529rem!important;top:0!important}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container.settings mv-mobile-app-cta.top-banner,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container.settings mv-mobile-app-cta.top-banner,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container.settings mv-mobile-app-cta.top-banner{top:-69px}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root div.app-container:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner,body[data-top-banner^=V].mobile[class*=c_4908] mv-root div.app-container:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner,body[data-top-banner^=V].mobile[class*=c_4480] mv-root div.app-container:not(.trip-plan-itinerary,.trip-plan-itinerary-map) div.content-container mv-cookie-banner{top:60px!important}mv-mobile-app-cta.top-banner.open{display:none;justify-content:space-between;align-items:center;position:fixed;top:0;left:0;width:100%;height:60px;min-height:60px;background:white!important;color:#292a30;z-index:9999;padding:11px;border-bottom:4px solid #f0500c;box-shadow:0 3px 4px #00000080}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-mobile-app-cta.top-banner.open,body[data-top-banner^=V].mobile[class*=c_4908] mv-mobile-app-cta.top-banner.open,body[data-top-banner^=V].mobile[class*=c_4480] mv-mobile-app-cta.top-banner.open{display:flex}mv-mobile-app-cta.top-banner.open .moovit-icon{width:42px;height:42px;min-width:42px;margin:0}mv-mobile-app-cta.top-banner.open .banner-text{margin:0 15px;font-size:.8823529412rem;color:#292a30;font-weight:600}html[dir=ltr] mv-mobile-app-cta.top-banner.open .banner-text{text-align:left}html[dir=rtl] mv-mobile-app-cta.top-banner.open .banner-text{text-align:right}mv-mobile-app-cta.top-banner.open .top-cta-wrapper{flex-shrink:0}mv-mobile-app-cta.top-banner.open .top-cta-wrapper .cta{background-color:#2196f3;border-radius:4px;text-decoration:none;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff;padding:9px 19px}mv-mobile-app-cta{font-size:.8823529412rem;color:#fff}html[dir=ltr] mv-mobile-app-cta{background:linear-gradient(to right,#00436a,#272727)}html[dir=rtl] mv-mobile-app-cta{background:linear-gradient(to left,#00436a,#272727)}mv-mobile-app-cta .app-text-container .title{font-weight:600;font-size:1em;margin-bottom:.3em;line-height:1.1}mv-mobile-app-cta .app-text-container .subtitle{font-size:.7647058824rem;font-weight:300;line-height:1.2}mv-mobile-app-cta .app-button-container{align-self:center}mv-mobile-app-cta .app-button-container a{padding:8px 20px;color:#f0500c;font-size:.7647058824rem;font-weight:600;display:block;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta .app-button-container a{padding:8px 40px}}mv-mobile-app-cta.init{-webkit-animation:slide-up-banner .8s forwards 3s cubic-bezier(.3,1,.6,1);-webkit-animation-fill-mode:both;animation:slide-up-banner .8s forwards 3s cubic-bezier(.3,1,.6,1);animation-fill-mode:both}mv-mobile-app-cta.open{padding:0 15px 15px;min-height:120px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open{min-height:60px}}mv-mobile-app-cta.open.init{transform:translateY(115%)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open.init{transform:translateY(130%)}}mv-mobile-app-cta.open .minimize-wrapper{background-color:transparent}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .minimize-wrapper{height:17px}}mv-mobile-app-cta.open .cta-wrapper{padding-top:15px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .cta-wrapper{display:inline-flex}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .cta-wrapper .app-text-container{flex-grow:1;margin-bottom:0;align-self:center}}mv-mobile-app-cta.open .cta-wrapper .app-text-container:after{top:-32px;width:100px;height:201px;background:url(/images/banners/phone-map-no-icon.png) no-repeat center bottom/cover}html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper .app-text-container:after{left:-115px}html[dir=rtl] mv-mobile-app-cta.open .cta-wrapper .app-text-container:after{right:-115px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .cta-wrapper .app-text-container:after{top:-42px}}mv-mobile-app-cta.open .cta-wrapper .app-text-container .bus-icon{content:"";display:block;width:18px;height:18px;background-image:url(/images/banners/bus-icon-banner-1.svg);background-size:cover;position:absolute;transform:translate(60px,64px);top:0;-webkit-animation:orange-line-ani 5s cubic-bezier(.44,.04,.59,1.01) infinite;animation:orange-line-ani 5s cubic-bezier(.44,.04,.59,1.01) infinite;-webkit-animation-direction:alternate;animation-direction:alternate;-webkit-animation-fill-mode:both;animation-fill-mode:both}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-mobile-app-cta.open .cta-wrapper .app-text-container .bus-icon{transform:scale(.9);top:-5px}}html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper .app-text-container .bus-icon{left:-148px}@-webkit-keyframes orange-line-ani{0%,3%{transform:translate(57px,64px)}40%{transform:translate(63px,28px)}60%{transform:translate(84px,30px)}97%,to{transform:translate(89px,-6px)}}@keyframes orange-line-ani{0%,3%{transform:translate(57px,64px)}40%{transform:translate(63px,28px)}60%{transform:translate(84px,30px)}97%,to{transform:translate(89px,-6px)}}mv-mobile-app-cta.open .cta-wrapper .app-text-container .title{display:inline-block}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html[dir=ltr] mv-mobile-app-cta.open .cta-wrapper .app-button-container{margin-left:20px}html[dir=rtl] mv-mobile-app-cta.open .cta-wrapper .app-button-container{margin-right:20px}}mv-mobile-app-cta.open .cta-wrapper .app-button-container .cta-button{background-color:#f06334;color:#fff}body[data-banner-store-badge=optimize] mv-mobile-app-cta.open .cta-wrapper .cta-badge{display:block}body[data-banner-store-badge=optimize] mv-mobile-app-cta.open .cta-wrapper .cta-badge .store-image:focus{outline:none}body[data-banner-store-badge=optimize] mv-mobile-app-cta.open .cta-wrapper .cta-badge img{width:135px}mv-mobile-app-cta.open~.content-container{margin-bottom:120px}mv-mobile-app-cta.min{color:#f0500c}mv-mobile-app-cta.min .minimize-wrapper{background-color:#2196f3}mv-mobile-app-cta.min .app-text-container .title{font-weight:600;font-size:1em;margin-bottom:.3em}mv-mobile-app-cta.min .app-text-container .subtitle{font-size:.75em;font-weight:300}mv-mobile-app-cta.min .app-button-container button{color:#f0500c}mv-mobile-app-cta.min+.content-container{margin-bottom:25px}\n'],encapsulation:2,changeDetection:0}),e})()},77226:function(e,t,n){"use strict";n.d(t,{M:function(){return u}});var i=n(2316),r=n(87897),o=n(1437),a=n(5971),s=n(2339),l=n(99957),c=n(54364);function d(e,t){if(1&e&&(i.TgZ(0,"a",1),i.TgZ(1,"div",2),i._UZ(2,"span",3),i.ALo(3,"translate"),i.TgZ(4,"div",4),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"button",5),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.qZA(),i._UZ(10,"div",6),i.qZA()),2&e){const e=i.oxw();i.Q6J("href",e.motBannerLink,i.LSH),i.xp6(2),i.Q6J("innerHTML",i.lcZ(3,4,"banner_mot_app_title_new"),i.oJD),i.xp6(3),i.Oqu(i.lcZ(6,6,"banner_mot_app_subtitle_new")),i.xp6(3),i.Oqu(i.lcZ(9,8,"banner_mot_cta"))}}let u=(()=>{class e{constructor(e,t,n,i,r){this.urlGeneratorService=e,this.analyticsService=t,this.store=n,this.translate=i,this.customerService=r}get state(){return this.store.getState()}onBannerClick(){this.analyticsService.trackMotBannerClick()}get showMotBanner(){return this.motBannerLink&&this.state.customer.currentCustomer&&this.customerService.isMoovitCustomer(this.state.customer.currentCustomer.id)}get motBannerLink(){return this.urlGeneratorService.getMotBannerLink()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.o),i.Y36(o.y),i.Y36(a.d),i.Y36(s.sK),i.Y36(l.v))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-mot-banner"]],decls:1,vars:1,consts:[["class","mot-banner","target","_blank",3,"href",4,"ngIf"],["target","_blank",1,"mot-banner",3,"href"],[1,"text-container"],[1,"mot-title",3,"innerHTML"],[1,"mot-subtitle"],[1,"mot-cta-button"],[1,"phone-placeholder"]],template:function(e,t){1&e&&i.YNc(0,d,11,10,"a",0),2&e&&i.Q6J("ngIf",t.showMotBanner)},directives:[c.O5],pipes:[s.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.mot-banner{position:relative;background-image:linear-gradient(to top,#FFFFFF 50%,#F0F7FC 100%);color:#292a30;border-top:2px solid #E2F0FB;display:flex;justify-content:space-between;align-items:flex-end;text-decoration:none;overflow:hidden}html[dir=ltr] .mot-banner{padding-left:15px}html[dir=rtl] .mot-banner{padding-right:15px}html[dir=ltr] .mot-banner{font-family:"Rubik","roboto","helvetica",sans-serif}html[dir=rtl] .mot-banner{font-family:"Rubik","open sans hebrew",sans-serif}.mot-banner .phone-placeholder{min-width:38%;height:94px;position:relative}.mot-banner .phone-placeholder:after{content:"";background:url(/images/banners/mot-illustration.svg) no-repeat left center/contain;transform-origin:bottom;position:absolute;width:150%;height:120%;top:10px;transform:scaleX(-1)}html[dir=ltr] .mot-banner .phone-placeholder:after{right:0}html[dir=rtl] .mot-banner .phone-placeholder:after{left:0}html[dir=rtl] .mot-banner .phone-placeholder:after{transform:scale(1)}@media screen and (max-width: 1410px){.mot-banner .phone-placeholder:after{width:170%}}html[lang=ru] .mot-banner .phone-placeholder:after{background-position:-15px center}.mot-banner .text-container{padding:10px 0}.mot-banner .text-container .mot-title{font-size:1rem;font-weight:600}.mot-banner .text-container .mot-title span{color:#f0500c}@media screen and (max-width: 1410px){.mot-banner .text-container .mot-title{font-size:.8235294118rem;display:block;max-width:74%}}@media screen and (max-width: 1410px){.mot-banner .text-container .logo{width:70px;height:16px}}.mot-banner .text-container .mot-subtitle{font-size:13px;margin-top:2px}.mot-banner .text-container .mot-cta-button{padding:5px 15px;background-color:#f0500d;border:none;color:#fff;border-radius:4px;margin-top:5px;position:relative;z-index:9;font-family:"Rubik","roboto","helvetica",sans-serif}html[lang=ru] .mot-banner .text-container .mot-cta-button{font-size:13px}\n'],encapsulation:2}),e})()},37194:function(e,t,n){"use strict";n.d(t,{f:function(){return h}});var i=n(2316),r=n(5971),o=n(95505),a=n(61787),s=n(2339),l=n(78146),c=n(1437),d=n(54364);const u=["metroSelection"];function p(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"li",3,4),i.NdJ("click",function(){return i.CHM(e),i.oxw().gotoMetroSelectorView()})("keydown.enter",function(){return i.CHM(e),i.oxw().gotoMetroSelectorView()}),i.TgZ(2,"span",5),i._uU(3),i.qZA(),i.TgZ(4,"span",6),i._uU(5),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.uIk("aria-label",e.changeMetroAriaLabel),i.xp6(3),i.Oqu(e.currentCountryName),i.xp6(2),i.Oqu(e.currentMetroAreaName)}}let h=(()=>{class e{constructor(e,t,n,i,r,o,a){this.store=e,this.routingService=t,this.canonicalService=n,this.translate=i,this._cd=r,this.a11y=o,this.analyticsService=a}ngOnInit(){this.changeMetroAriaLabel=this.translate.instant("a11y_change_metro",{METRO_NAME:this.state.metro.currentMetro&&this.state.metro.currentMetro.metroAreaName})}ngAfterViewChecked(){var e;this.a11y.byEnter&&(this._cd.detectChanges(),null===(e=this.metroSelection.nativeElement)||void 0===e||e.focus())}get state(){return this.store.getState()}get currentCountryName(){return this.state.metro.currentMetro&&this.state.metro.currentMetro.countryName}get currentMetroAreaName(){return this.state.metro.currentMetro&&this.state.metro.currentMetro.metroAreaName}get currentLanguage(){return this.state.global.selectedLocale?this.state.global.selectedLocale.name:""}get shouldShowMetroSelector(){return this.state.customer.currentCustomer&&!this.state.customer.currentCustomer.designConfiguration.showOnlyLanguageSelection}gotoMetroSelectorView(){this.analyticsService.trackOpenMetroSelectorView(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["metro",":locale"]))}gotoLangSelectorView(){this.analyticsService.trackOpenLangSelectorView(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["language",":locale"]))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.d),i.Y36(o.Z),i.Y36(a.z),i.Y36(s.sK),i.Y36(i.sBO),i.Y36(l.F),i.Y36(c.y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-settings"]],viewQuery:function(e,t){if(1&e&&i.Gf(u,5),2&e){let e;i.iGM(e=i.CRH())&&(t.metroSelection=e.first)}},decls:9,vars:8,consts:[["role","heading","aria-level","1",1,"header","settings"],["role","button","tabindex","0",3,"click","keydown.enter",4,"ngIf"],["role","button","tabindex","0","data-automation","open-language-menu",3,"click","keydown.enter"],["role","button","tabindex","0",3,"click","keydown.enter"],["metroSelection",""],[1,"country-name"],[1,"metro-name"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i._uU(1),i.ALo(2,"translate"),i.qZA(),i.TgZ(3,"ul"),i.YNc(4,p,6,3,"li",1),i.TgZ(5,"li",2),i.NdJ("click",function(){return t.gotoLangSelectorView()})("keydown.enter",function(){return t.gotoLangSelectorView()}),i.ALo(6,"translate"),i.TgZ(7,"span"),i._uU(8),i.qZA(),i.qZA(),i.qZA()),2&e&&(i.xp6(1),i.hij(" ",i.lcZ(2,4,"settings"),"\n"),i.xp6(3),i.Q6J("ngIf",t.shouldShowMetroSelector),i.xp6(1),i.uIk("aria-label",i.lcZ(6,6,"change_language")),i.xp6(3),i.Oqu(t.currentLanguage))},directives:[d.O5],pipes:[s.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-settings{display:block;background:#ECF0F1}mv-settings ul{background:#fff;list-style:none;padding:0;margin:0;box-shadow:0 2px 3px -1px #0000004d}mv-settings ul:focus{outline:none}mv-settings ul li{display:flex;flex-direction:column;justify-content:center;box-sizing:border-box;height:auto;border-bottom:1px solid #DDDDDD;padding:14px 20px;min-height:64px;font-size:.9411764706rem;color:#292a30;outline:none}mv-settings ul li:first-child{color:#737578}mv-settings ul li:last-child{border-bottom:none}mv-settings ul li.disabled{color:#d3d3d3}\n"],encapsulation:2}),e})()},52815:function(e,t,n){"use strict";n.d(t,{Q:function(){return p}});var i=n(2316),r=n(1420),o=n(78146),a=n(54364),s=n(87479),l=n(93975),c=n(2339);const d=["iconsList"];function u(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",4),i.NdJ("click",function(){const t=i.CHM(e).$implicit;return i.oxw().onOptionClick(t)})("keydown.enter",function(){const t=i.CHM(e).$implicit;return i.oxw().onOptionClick(t)}),i.TgZ(1,"div",5),i._UZ(2,"svg-icon",6),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span",7),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.qZA()}if(2&e){const e=t.$implicit;i.Tol(e.titleKey),i.xp6(2),i.s9C("titleText",i.lcZ(3,5,e.titleKey)),i.Q6J("src",e.icon),i.xp6(3),i.Oqu(i.lcZ(6,7,e.titleKey))}}let p=(()=>{class e{constructor(e,t){this.shareService=e,this.a11y=t}ngAfterViewInit(){this.a11y.byEnter&&this.iconsList.nativeElement.childNodes[0].focus()}onOptionClick(e){this.shareService.share(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.t),i.Y36(o.F))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-share-panel"]],viewQuery:function(e,t){if(1&e&&i.Gf(d,5),2&e){let e;i.iGM(e=i.CRH())&&(t.iconsList=e.first)}},decls:5,vars:2,consts:[[1,"share-label"],[1,"share-icons"],["iconsList",""],["tabindex","0",3,"class","click","keydown.enter",4,"ngFor","ngForOf"],["tabindex","0",3,"click","keydown.enter"],[1,"icon-wrapper"],["mvAccessibleSVG","",3,"src","titleText"],[1,"title"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i._uU(1),i.qZA(),i.TgZ(2,"div",1,2),i.YNc(4,u,7,9,"div",3),i.qZA()),2&e&&(i.xp6(1),i.hij(" ",t.shareService.getShareLabel(),"\n"),i.xp6(3),i.Q6J("ngForOf",t.shareService.shareOptions))},directives:[a.sg,s.bk,l.m],pipes:[c.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-share-panel{background-color:#ecf0f1;padding:15px;position:fixed;bottom:0;width:100%;box-sizing:border-box;z-index:99999;-webkit-animation:slide-up .3s ease-out forwards;animation:slide-up .3s ease-out forwards}mv-share-panel .share-label{width:100%;text-align:center;margin-bottom:21px;font-size:.9411764706rem}mv-share-panel .share-icons{text-align:center;-webkit-animation:fade-in-up .6s .1s;-webkit-animation-fill-mode:both;animation:fade-in-up .6s .1s;animation-fill-mode:both;display:flex;justify-content:space-around;max-width:420px;margin:auto}mv-share-panel .share-icons>div{text-decoration:none;min-width:60px;display:flex;flex-direction:column;align-items:center}mv-share-panel .share-icons>div .icon-wrapper{background:#fff;border-radius:10px;margin-bottom:8px;width:60px;height:60px;display:flex;justify-items:center;align-items:center}mv-share-panel .share-icons>div .icon-wrapper svg-icon{box-sizing:border-box;width:40px;height:40px}mv-share-panel .share-icons>div .icon-wrapper~.title{font-size:.7058823529rem;color:#6c6d6d;text-align:center;display:block}mv-share-panel .share-icons>div.share_copy_link svg-icon{transform:scaleX(-1)}mv-share-panel .share-icons>div.share_copy_link .st0{fill:#737578}mv-share-panel .share-icons>div.share_email .st0{fill:#737578}mv-share-panel .share-icons>div.share_messenger svg-icon{width:50px;height:50px}mv-share-panel .share-icons>div.share_messenger .st0{fill:#0084ff}mv-share-panel .share-icons>div.action_whatsapp svg-icon{width:50px;height:50px}mv-share-panel .share-icons>div.action_whatsapp .st0{fill:#25d366}@-webkit-keyframes slide-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes slide-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes fade-in-up{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes fade-in-up{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}\n"],encapsulation:2}),e})()},55380:function(e,t,n){"use strict";n.d(t,{X:function(){return T}});var i=n(3786),r=n(2316),o=n(78776),a=n(22213),s=n(15208),l=n(2339),c=n(1420),d=n(54364),u=n(87479),p=n(93975),h=n(53448),m=n(90248);const g=["copyLinkInput"];function f(e,t){1&e&&(r.TgZ(0,"div",20),r._UZ(1,"mv-spinner"),r.qZA())}function v(e,t){1&e&&(r.TgZ(0,"div",21),r.TgZ(1,"div",22),r._UZ(2,"svg-icon",23),r.TgZ(3,"div"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Oqu(r.lcZ(5,1,"generic_error_text")))}function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().onOptionClick(t)}),r._UZ(1,"svg-icon",25),r.ALo(2,"translate"),r.TgZ(3,"div",26),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw();r.Gre("social-button id_",e.id,""),r.uIk("ngclipboard",0===e.id?"true":void 0)("data-clipboard-text",0===e.id&&n.linkToShare||void 0),r.xp6(1),r.s9C("src",e.icon),r.s9C("title",r.lcZ(2,8,e.titleKey)),r.xp6(3),r.Oqu(r.lcZ(5,10,e.titleKey))}}function b(e,t){if(1&e&&(r.TgZ(0,"span",34),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.errorMessage," ")}}function _(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",27),r.TgZ(1,"label",28),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"textarea",29),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().sendToEmailMessage=t}),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"div"),r.TgZ(7,"div",30),r.TgZ(8,"button",31),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearEmailFields()}),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"button",32),r.NdJ("click",function(){return r.CHM(e),r.oxw().sendEmailClicked()})("keydown",function(t){return r.CHM(e),r.oxw().onKeydownSendEmail(t)}),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.YNc(14,b,2,1,"span",33),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,6,"share_email_message")),r.xp6(2),r.s9C("placeholder",r.lcZ(5,8,"share_email_write_message")),r.Q6J("ngModel",e.sendToEmailMessage),r.xp6(5),r.Oqu(r.lcZ(10,10,"cancel")),r.xp6(3),r.hij("",r.lcZ(13,12,"share_email_send")," "),r.xp6(2),r.Q6J("ngIf",e.errorMessage)}}let T=(()=>{class e{constructor(e,t,n,i,r){this.data=e,this.dialogRef=t,this.platformService=n,this.translate=i,this.shareService=r,this.linkToShare=" ",this.emailPattern=/^[\w-.]+@([\w-]+\.)+[\w-]{2,63}$/}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){this.copyLinkOption=this.shareService.shareOptions.find(e=>e.id===o.v.Link),this.shareOptions=this.shareService.shareOptions.filter(e=>!e.mobileOnly&&e.id!==o.v.Link),this.linkToShare=yield this.shareService.getShareableLink(this.shareCategory)})}get title(){var e;return(null===(e=this.data)||void 0===e?void 0:e.shareTitle)||this.shareService.getShareLabel()}get shareCategory(){var e;return null===(e=this.data)||void 0===e?void 0:e.shareCategory}get locationName(){var e;return null===(e=this.data)||void 0===e?void 0:e.locationName}onUrlChanged(){this.closeClicked()}onKeydownSendEmail(e){"Tab"===e.key&&document.querySelector("share-close-button")}grep(e,t){const n=[],i=e.length;let r=0;for(;r<i;r++){const i=e[r];t(i)&&n.push(i)}return n}onOptionClick(e){this.shareService.share(e,this.shareCategory)}closeClicked(){this.onCloseClick&&"function"==typeof this.onCloseClick&&this.onCloseClick()}inputFocused(){setTimeout(()=>{const e=this.copyLinkInput.nativeElement;e.setSelectionRange(0,e.value.length)})}copySuccess(e){}copyError(e){}clearEmailFields(){this.sendToEmailAddress=void 0,this.sendToEmailMessage=void 0,this.showFullEmailForm=void 0}sendEmailClicked(){this.errorMessage=null,this.sendToEmailAddress&&this.emailPattern.test(this.sendToEmailAddress)?this.sendEmail([this.sendToEmailAddress],this.sendToEmailMessage).then(()=>{this.close()},e=>{this.errorMessage=this.translate.instant("server_busy_error_message")}):this.errorMessage=this.translate.instant("invalid_email_error")}sendEmail(e,t){return this.shareService.sendEmail(e,t,this.shareCategory,this.locationName)}onEmailFieldFocus(){this.showFullEmailForm=!0}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.WI),r.Y36(a.so),r.Y36(s.mi),r.Y36(l.sK),r.Y36(c.t))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-share-popup"]],viewQuery:function(e,t){if(1&e&&r.Gf(g,7,r.SBq),2&e){let e;r.iGM(e=r.CRH())&&(t.copyLinkInput=e.first)}},decls:33,vars:29,consts:[[1,"share-container"],["class","overlay",4,"ngIf"],["class","overlay strong",4,"ngIf"],[1,"share-popup-top"],[1,"share-label"],["role","button","tabindex","0",1,"close",3,"click"],["src","images/icons/close.svg","mvAccessibleSVG","",3,"titleText"],[1,"divider"],[1,"section-title"],[1,"copy-link"],["for","copy-link-input",1,"title"],["id","copy-link-input","type","text",3,"value","focus","mouseup"],["copyLinkInput",""],[1,"share-icons"],[3,"class","click",4,"ngFor","ngForOf"],["role","form",1,"send-email"],[1,"address"],["for","send-email-input",1,"section-title"],["id","send-email-input","type","text","aria-required","true","required","",3,"pattern","ngModel","placeholder","focus","ngModelChange"],["class","message",4,"ngIf"],[1,"overlay"],[1,"overlay","strong"],["role","alert",1,"error-container"],["src","/images/error-states/img_empty_no_network.svg",1,"error-icon"],[3,"click"],[1,"icon",3,"src","title"],[1,"title"],[1,"message"],["for","message-input",1,"section-title"],["id","message-input",3,"ngModel","placeholder","ngModelChange"],[1,"send-email-buttons"],[1,"share-cancel",3,"click"],[1,"primary",3,"click","keydown"],["class","error-message","role","alert",4,"ngIf"],["role","alert",1,"error-message"]],template:function(e,t){1&e&&(r.TgZ(0,"section",0),r.YNc(1,f,2,0,"div",1),r.YNc(2,v,6,3,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"h1",4),r._uU(5),r.qZA(),r.TgZ(6,"a",5),r.NdJ("click",function(){return t.close()}),r._UZ(7,"svg-icon",6),r.ALo(8,"translate"),r.qZA(),r.qZA(),r._UZ(9,"div",7),r.TgZ(10,"div",8),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.TgZ(13,"div",9),r.TgZ(14,"label",10),r._uU(15),r.ALo(16,"translate"),r.qZA(),r.TgZ(17,"input",11,12),r.NdJ("focus",function(){return t.inputFocused()})("mouseup",function(){return t.inputFocused()}),r.ALo(19,"translate"),r.qZA(),r.qZA(),r.TgZ(20,"div",8),r._uU(21),r.ALo(22,"translate"),r.qZA(),r.TgZ(23,"div",13),r.YNc(24,y,6,12,"button",14),r.qZA(),r.TgZ(25,"div",15),r.TgZ(26,"div",16),r.TgZ(27,"label",17),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.TgZ(30,"input",18),r.NdJ("focus",function(){return t.onEmailFieldFocus()})("ngModelChange",function(e){return t.sendToEmailAddress=e}),r.ALo(31,"translate"),r.qZA(),r.qZA(),r.YNc(32,_,15,14,"div",19),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",null===t.linkToShare),r.xp6(1),r.Q6J("ngIf",""===t.linkToShare),r.xp6(3),r.Oqu(t.title),r.xp6(2),r.s9C("titleText",r.lcZ(8,15,"action_close")),r.xp6(4),r.Oqu(r.lcZ(12,17,"share_copy_link")),r.xp6(4),r.Oqu(r.lcZ(16,19,t.copyLinkOption.titleKey)),r.xp6(2),r.Q6J("value",t.linkToShare),r.uIk("title",r.lcZ(19,21,t.copyLinkOption.titleKey)),r.xp6(4),r.Oqu(r.lcZ(22,23,"share_social")),r.xp6(3),r.Q6J("ngForOf",t.shareOptions),r.xp6(4),r.Oqu(r.lcZ(29,25,"share_email_send_to")),r.xp6(2),r.s9C("placeholder",r.lcZ(31,27,"share_email_enter_address")),r.Q6J("pattern",t.emailPattern)("ngModel",t.sendToEmailAddress),r.xp6(2),r.Q6J("ngIf",t.showFullEmailForm))},directives:[d.O5,u.bk,p.m,d.sg,h.Fj,h.Q7,h.c5,h.JJ,h.On,m.O],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-share-popup{display:block;margin:0 auto;max-width:435px;width:435px}mv-share-popup .overlay{position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(255,255,255,.4);z-index:1}mv-share-popup .overlay.strong{background:rgba(255,255,255,.8)}mv-share-popup .overlay mv-spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}mv-share-popup .overlay .error-container{text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}mv-share-popup .share-container{padding:10px 5px 0}mv-share-popup .share-container .divider{border-top:1px solid #CCCCCC;margin:13px 0 25px}mv-share-popup .share-container .share-popup-top{display:flex;justify-content:space-between}mv-share-popup .share-container .close svg-icon{height:12px;width:12px}mv-share-popup .share-container .close svg-icon:hover .cls-1{fill:#737578}mv-share-popup .share-container .close svg-icon .cls-1{fill:#bdc3c7;transition:all .3s}mv-share-popup .share-container input,mv-share-popup .share-container textarea{border:#fff 1px solid;border-radius:4px;box-sizing:border-box;font-size:.8235294118rem;color:#737578;line-height:22px;margin-top:7px;outline:none;padding:10px;resize:none;width:100%}mv-share-popup .share-container .share-label{font-size:1.0588235294rem;font-weight:400;margin-top:0}mv-share-popup .share-container .section-title{font-size:.8235294118rem;font-weight:700;margin-top:16px;display:block}mv-share-popup .share-container .copy-link .title{color:#737578;display:none;font-size:.7058823529rem}mv-share-popup .share-container .share-icons .social-button{background-color:#fff;border:1px solid transparent;border-radius:4px;box-sizing:border-box;color:#737578;display:flex;align-items:center;margin:0;position:relative;text-decoration:none;width:100%}html[dir=ltr] mv-share-popup .share-container .share-icons .social-button{margin-right:20px}html[dir=rtl] mv-share-popup .share-container .share-icons .social-button{margin-left:20px}mv-share-popup .share-container .share-icons .social-button:only-child{height:42px;margin-top:7px;width:166px}html[dir=ltr] mv-share-popup .share-container .share-icons .social-button:only-child{padding-left:22px}html[dir=rtl] mv-share-popup .share-container .share-icons .social-button:only-child{padding-right:22px}mv-share-popup .share-container .share-icons .social-button:only-child .icon{height:24px;width:24px}html[dir=ltr] mv-share-popup .share-container .share-icons .social-button:only-child .icon{margin-right:4px}html[dir=rtl] mv-share-popup .share-container .share-icons .social-button:only-child .icon{margin-left:4px}mv-share-popup .share-container .share-icons .social-button:only-child .icon svg{max-height:24px;max-width:24px}mv-share-popup .share-container .share-icons .social-button:only-child .icon .st0{fill:#0084ff}mv-share-popup .share-container .share-icons .social-button:only-child .title{color:#0084ff;font-size:.8823529412rem}html[dir=ltr] mv-share-popup .share-container .share-icons .social-button:only-child .title{padding-left:6px}html[dir=rtl] mv-share-popup .share-container .share-icons .social-button:only-child .title{padding-right:6px}mv-share-popup .share-container .share-icons .social-button:only-child:hover .icon .st0{fill:#006acc}mv-share-popup .share-container .share-icons .social-button:only-child:hover .title{color:#006acc}mv-share-popup .share-container .share-icons .social-button.id_0 .icon{padding:10px;transform:scaleX(-1)}mv-share-popup .share-container .share-icons .social-button.id_0 .st0{fill:#737578}mv-share-popup .share-container .share-icons .social-button.id_1 .icon{padding:7px}mv-share-popup .share-container .share-icons .social-button.id_1 .st0{fill:#737578}mv-share-popup .share-container .share-icons .social-button.id_2 .st0{fill:#0084ff}mv-share-popup .share-container .share-icons .social-button.id_3 .st0{fill:#25d366}mv-share-popup .share-container .share-icons .social-button .title{font-size:.7058823529rem;transition:all .3s}mv-share-popup .share-container .share-icons .icon{height:42px;width:42px;margin:0}mv-share-popup .share-container .share-icons .icon .st0{transition:all .3s}mv-share-popup .share-container .send-email .address input,mv-share-popup .share-container .send-email textarea{transition:all .3s}mv-share-popup .share-container .send-email .address input:focus,mv-share-popup .share-container .send-email textarea:focus{border:#BDC3C7 1px solid}mv-share-popup .share-container .send-email .address input .ng-invalid-pattern,mv-share-popup .share-container .send-email .address input:focus.ng-invalid-pattern,mv-share-popup .share-container .send-email textarea .ng-invalid-pattern,mv-share-popup .share-container .send-email textarea:focus.ng-invalid-pattern{border:#c6522c 1px solid}mv-share-popup .share-container .send-email .message.ng-enter{margin-top:-10px;opacity:0;transition:all .3s}mv-share-popup .share-container .send-email .message.ng-enter.ng-enter-active{margin-top:0;opacity:1}mv-share-popup .share-container .send-email .message.ng-leave{margin-top:0;opacity:1;transition:all .3s}mv-share-popup .share-container .send-email .message.ng-leave.ng-leave-active{margin-top:-10px;opacity:0}mv-share-popup .share-container .send-email .send-email-buttons{margin-top:16px}html[dir=ltr] mv-share-popup .share-container .send-email .send-email-buttons{text-align:right}html[dir=rtl] mv-share-popup .share-container .send-email .send-email-buttons{text-align:left}mv-share-popup .share-container .send-email .send-email-buttons button{background:none;border:none;color:#6c6d6d;padding:5px;text-decoration:underline}html[dir=ltr] mv-share-popup .share-container .send-email .send-email-buttons button.share-cancel{margin-right:5px}html[dir=rtl] mv-share-popup .share-container .send-email .send-email-buttons button.share-cancel{margin-left:5px}mv-share-popup .share-container .send-email .send-email-buttons button.primary{background:#0078D6;border-radius:4px;color:#fff;min-width:110px;padding:5px 15px;text-decoration:none;transition:all .3s}mv-share-popup .share-container .send-email .send-email-buttons button.primary:hover{background-color:#005ba3}mv-share-popup .share-container .send-email .send-email-buttons button:focus{outline-color:#101010}mv-share-popup .share-container .send-email .error-message{font-size:.7058823529rem;color:#c34820;position:absolute;bottom:30px;width:200px}.cdk-overlay-pane.share mat-dialog-container{background:#ECF0F1}\n"],encapsulation:2}),e})()},9881:function(e,t,n){"use strict";n.d(t,{V:function(){return A}});var i=n(1437),r=n(54364),o=n(5),a=n(16438),s=n(2316),l=n(95505),c=n(2339),d=n(87897),u=n(61787),p=n(1238),h=n(5971),m=n(85431),g=n(99957),f=n(1),v=n(87479),y=n(93975),b=n(17857);const _=["closeSideMenue"];function T(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",21),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).openRegisterLoginFlow("register")}),s._UZ(1,"svg-icon",22),s._uU(2),s.ALo(3,"translate"),s.ALo(4,"translate"),s.qZA()}2&e&&(s.xp6(2),s.AsE(" ",s.lcZ(3,2,"register")," / ",s.lcZ(4,4,"user_account_login")," "))}function S(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"a",21),s.NdJ("click",function(){return s.CHM(e),s.oxw(2).openRegisterLoginFlow("login")}),s._UZ(1,"svg-icon",22),s._uU(2),s.ALo(3,"translate"),s.qZA()}2&e&&(s.xp6(2),s.hij(" ",s.lcZ(3,1,"user_account_login")," "))}function x(e,t){if(1&e&&(s.TgZ(0,"div",23),s._UZ(1,"svg-icon",24),s._uU(2),s.qZA()),2&e){const e=s.oxw(2);s.xp6(2),s.hij(" ",e.currentUserName," ")}}function w(e,t){if(1&e&&(s.TgZ(0,"div",18),s.YNc(1,T,5,6,"a",19),s.YNc(2,S,4,3,"a",19),s.YNc(3,x,3,1,"div",20),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.Q6J("ngIf",e.isUserGuest),s.xp6(1),s.Q6J("ngIf",e.isUserRecognised),s.xp6(1),s.Q6J("ngIf",e.isUserLoggedIn)}}function k(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"li",25),s.NdJ("click",function(){return s.CHM(e),s.oxw().goToMyRides()}),s.TgZ(1,"a"),s._UZ(2,"svg-icon",26),s.TgZ(3,"span",27),s._uU(4),s.ALo(5,"translate"),s.qZA(),s.qZA(),s.qZA()}2&e&&(s.xp6(2),s.Q6J("src","images/nav-icons/rides_on demand.svg"),s.xp6(2),s.Oqu(s.lcZ(5,2,"tod_rides_center_menu_label")))}function M(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"li",28),s.NdJ("click",function(t){const n=s.CHM(e).$implicit;return s.oxw().onItemClick(n,t)}),s.TgZ(1,"a",29),s.ALo(2,"translate"),s.TgZ(3,"svg-icon",30),s.ALo(4,"translate"),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"span",27),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw();s.Gre("item ",e.id,""),s.xp6(1),s.Q6J("href",n.resolveLink(e),s.LSH)("tabIndex",n.tabIndex),s.uIk("aria-label",s.lcZ(2,10,e.label)),s.xp6(2),s.s9C("titleText",s.lcZ(4,12,e.label)),s.Q6J("src",e.svgIcon),s.xp6(2),s.Oqu(s.lcZ(6,14,e.label)),s.xp6(3),s.Oqu(s.lcZ(9,16,e.label))}}function L(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"li",31),s.NdJ("click",function(t){const n=s.CHM(e).$implicit;return s.oxw().onItemClick(n,t)}),s.TgZ(1,"a",32),s.NdJ("keydown.tab",function(t){const n=s.CHM(e).$implicit;return s.oxw().handleTab(n,t)}),s.TgZ(2,"span",27),s._uU(3),s.ALo(4,"translate"),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,n=s.oxw();s.xp6(1),s.Q6J("href",n.resolveLink(e),s.LSH)("tabIndex",n.tabIndex),s.xp6(2),s.Oqu(s.lcZ(4,3,e.label))}}let A=(()=>{class e{constructor(e,t,n,i,r,a,s,l,c,d,u){this.document=e,this.analyticsService=t,this.routingService=n,this.translationService=i,this.urlGeneratorService=r,this.canonicalService=a,this.globalActions=s,this.store=l,this.storeHelper=c,this.customerService=d,this.sideNavService=u,this.AccountStatus=o.dp,this.sideMenuItems=[],this.sideMenuMinimalItems=[]}get state(){return this.store.getState()}get currentLocaleId(){const e=this.store.getState();return e.global.selectedLocale&&e.global.selectedLocale.id||""}get currentAccountStatus(){return this.store.getState().user.accountStatus}get shouldShowAccountButton(){var e,t,n;return!((null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.id)&&this.state.customer.currentCustomer.id!==this.customerService.MoovitSeo.id&&this.state.customer.currentCustomer.id!==this.customerService.MoovitWeb.id)&&(null===(n=null===(t=this.state.metro.currentMetro)||void 0===t?void 0:t.features)||void 0===n?void 0:n.ACCOUNTS_ENABLED)}get isUserLoggedIn(){return this.currentAccountStatus===o.dp.Authenticated}get isUserGuest(){return this.currentAccountStatus===o.dp.Guest}get isUserRecognised(){return this.currentAccountStatus===o.dp.Recognised}get currentUserName(){const e=this.store.getState().user.account;return e.firstName?`${e.firstName} ${e.lastName}`:this.translationService.instant("web_not_logged_in")}openRegisterLoginFlow(e){this.closeSideMenu(),this.analyticsService.trackOpenAccountsFlow(e,"side menu"),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["accounts",":locale"]))}get localeCode(){return this.currentLocaleId.substr(0,2).toUpperCase()}get canShowMyRides(){var e,t,n;return!!(null===(n=null===(t=null===(e=this.state)||void 0===e?void 0:e.user)||void 0===t?void 0:t.account)||void 0===n?void 0:n.userKey)}ngOnInit(){this.sideMenuItems=this.sideNavService.getSideMenuItems(),this.unsubscribe=this.storeHelper.subscribe("global.sideMenuState",e=>{e?(this.closeSideMenue.nativeElement.focus(),this.sideMenuMinimalItems=this.sideNavService.getSideMenuMinimalItems()):setTimeout(()=>{var e;null===(e=this.document.getElementById("sidenav-toggler"))||void 0===e||e.focus()})}),this.storeHelper.subscribe("metro.metroId",()=>{this.sideMenuMinimalItems=this.sideNavService.getSideMenuMinimalItems()})}ngOnDestroy(){this.unsubscribe()}resolveLink(e){return"function"==typeof e.link?e.link.call(this):e.link}handleTab(e,t){this.sideMenuMinimalItems.indexOf(e)===this.sideMenuMinimalItems.length-1&&(t.preventDefault(),this.closeSideMenue.nativeElement.focus())}onItemClick(e,t){e.onClick&&(e.onClick.call(this,[e,t]),t.preventDefault()),this.closeSideMenu(),"support"===e.id&&this.analyticsService.trackSupportLink(),this.analyticsService.trackSideNavigationEvent(e.id)}closeSideMenu(){this.store.dispatch(this.globalActions.setSideMenu(!1))}gotoLangSelectorView(){this.closeSideMenu(),this.analyticsService.trackOpenLangSelectorView(),this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["language",":locale"]))}goToMyRides(){this.analyticsService.sendEvent(i.a.TODGeneral,"TOD_MY_RIDES_CLICKED"),this.closeSideMenu(),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],a.zA.TOD_HISTORY_RIDES))}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(r.K0),s.Y36(i.y),s.Y36(l.Z),s.Y36(c.sK),s.Y36(d.o),s.Y36(u.z),s.Y36(p.l),s.Y36(h.d),s.Y36(m.N),s.Y36(g.v),s.Y36(f.W))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-side-menu"]],viewQuery:function(e,t){if(1&e&&s.Gf(_,5),2&e){let e;s.iGM(e=s.CRH())&&(t.closeSideMenue=e.first)}},inputs:{tabIndex:"tabIndex"},decls:24,vars:16,consts:[[1,"side-navigation-container"],[1,"nav-header"],[1,"close-nav",3,"tabIndex","click","keydown.enter"],["closeSideMenue",""],["src","images/nav-icons/forward.svg","mvAccessibleSVG","",3,"titleText"],[1,"language-change",3,"click","keydown.enter"],["src","images/nav-icons/language.svg","mvAccessibleSVG",""],["class","nav-account",4,"ngIf"],[1,"menu-items-wrapper"],["itemscope","","itemtype","http://www.schema.org/SiteNavigationElement",1,"menu-items"],[1,"store-banner","item"],["src","images/nav-icons/company_icon.svg","mvAccessibleSVG","",1,"icon"],[1,"text"],[1,"app-image-container"],[3,"tabIndex"],["class","about item",3,"click",4,"ngIf"],[3,"class","click",4,"ngFor","ngForOf"],["class","item",3,"click",4,"ngFor","ngForOf"],[1,"nav-account"],["class","not-logged",3,"click",4,"ngIf"],["class","logged-in",4,"ngIf"],[1,"not-logged",3,"click"],["src","images/icons/profile-icon.svg","mvAccessibleSVG","",1,"profile-icon"],[1,"logged-in"],["src","images/icons/brand-36.svg","mvAccessibleSVG","",1,"brand-icon"],[1,"about","item",3,"click"],[1,"icon",3,"src"],["itemprop","name",1,"text"],[3,"click"],["target","_blank","itemprop","url",3,"href","tabIndex"],["mvAccessibleSVG","",1,"icon",3,"src","titleText"],[1,"item",3,"click"],["target","_blank","itemprop","url",3,"href","tabIndex","keydown.tab"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"a",2,3),s.NdJ("click",function(){return t.closeSideMenu()})("keydown.enter",function(){return t.closeSideMenu()}),s.ALo(4,"translate"),s._UZ(5,"svg-icon",4),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"a",5),s.NdJ("click",function(){return t.gotoLangSelectorView()})("keydown.enter",function(){return t.gotoLangSelectorView()}),s._UZ(8,"svg-icon",6),s._uU(9),s.qZA(),s.qZA(),s.YNc(10,w,4,3,"div",7),s.TgZ(11,"div",8),s.TgZ(12,"ul",9),s.TgZ(13,"li",10),s._UZ(14,"svg-icon",11),s.TgZ(15,"span",12),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"span",13),s._UZ(19,"mv-store-banner",14),s.qZA(),s.qZA(),s.YNc(20,k,6,4,"li",15),s.YNc(21,M,10,18,"li",16),s.qZA(),s.TgZ(22,"ul",9),s.YNc(23,L,5,5,"li",17),s.qZA(),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Q6J("tabIndex",t.tabIndex),s.uIk("aria-label",s.lcZ(4,10,"a11y_toggle_navigation")),s.xp6(3),s.s9C("titleText",s.lcZ(6,12,"a11y_toggle_navigation")),s.xp6(4),s.hij(" ",t.localeCode," "),s.xp6(1),s.Q6J("ngIf",t.shouldShowAccountButton),s.xp6(6),s.Oqu(s.lcZ(17,14,"web_download_button")),s.xp6(3),s.Q6J("tabIndex",t.tabIndex),s.xp6(1),s.Q6J("ngIf",t.canShowMyRides),s.xp6(1),s.Q6J("ngForOf",t.sideMenuItems),s.xp6(2),s.Q6J("ngForOf",t.sideMenuMinimalItems))},directives:[v.bk,y.m,r.O5,b.n,r.sg],pipes:[c.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-side-menu{display:block;height:100%;position:fixed;top:0;transition:all .3s}html[dir=ltr] mv-side-menu{right:0}html[dir=rtl] mv-side-menu{left:0}mv-side-menu.collapsed{transform:translate(100%);z-index:-9}html[dir=rtl] mv-side-menu.collapsed{transform:translate(-100%)}mv-side-menu.expanded{opacity:1;visibility:visible;z-index:99999;transform:translate(0)}mv-side-menu.expanded .overlay{opacity:1;visibility:visible;transform:translate(-20vw)}mv-side-menu.expanded .side-navigation-container .menu-items-wrapper .menu-items .item .text{opacity:1;visibility:visible;transform:translate(0)}mv-side-menu .side-navigation-container{background:#1f1f1f;box-sizing:border-box;display:flex;flex-direction:column;height:100%;position:relative;z-index:99;width:80vw}html[dir=ltr] mv-side-menu .side-navigation-container .close-nav{left:20px}html[dir=rtl] mv-side-menu .side-navigation-container .close-nav{right:20px}html[dir=rtl] mv-side-menu .side-navigation-container .close-nav svg-icon{transform:scaleX(-1)}mv-side-menu .side-navigation-container.carpool .side-nav-scroll{height:calc(100vh - 67px)}mv-side-menu .side-navigation-container.hidden{display:none}mv-side-menu .side-navigation-container .nav-header,mv-side-menu .side-navigation-container .nav-account{background-color:#000;display:flex;align-items:center;color:#bcc2c8}mv-side-menu .side-navigation-container .nav-header{position:relative;padding:22px 24px;justify-content:space-between}mv-side-menu .side-navigation-container .nav-header .close-nav{width:1.4117647059rem;height:1.4117647059rem}mv-side-menu .side-navigation-container .nav-header .close-nav svg-icon,mv-side-menu .side-navigation-container .nav-header .close-nav svg-icon svg{height:1.4117647059rem;width:1.4117647059rem;fill:#bdc3c7}mv-side-menu .side-navigation-container .nav-header .language-change{display:flex;align-items:center;font-size:.7058823529rem;color:#bcc2c8;letter-spacing:-.0141176471rem;height:.9411764706rem;text-transform:uppercase}mv-side-menu .side-navigation-container .nav-header .language-change svg-icon,mv-side-menu .side-navigation-container .nav-header .language-change svg{height:.9411764706rem;width:.9411764706rem}html[dir=ltr] mv-side-menu .side-navigation-container .nav-header .language-change svg-icon{margin-right:4px}html[dir=rtl] mv-side-menu .side-navigation-container .nav-header .language-change svg-icon{margin-left:4px}mv-side-menu .side-navigation-container .nav-account{border-bottom:1px solid rgba(255,255,255,.2);padding:0 22px 22px}mv-side-menu .side-navigation-container .nav-account .logged-in{color:#fff;font-size:.9411764706rem;letter-spacing:-.0105882353rem;font-weight:600}mv-side-menu .side-navigation-container .nav-account .logged-in svg-icon{display:block;margin-bottom:8px}mv-side-menu .side-navigation-container .nav-account .not-logged{display:flex;align-items:center;font-size:.7647058824rem}mv-side-menu .side-navigation-container .nav-account svg-icon{margin:0;width:1.4117647059rem;height:1.4117647059rem}html[dir=ltr] mv-side-menu .side-navigation-container .nav-account svg-icon{margin-right:19px}html[dir=rtl] mv-side-menu .side-navigation-container .nav-account svg-icon{margin-left:19px}mv-side-menu .side-navigation-container .nav-account svg-icon.profile-icon svg path{fill:#bcc2c8}mv-side-menu .side-navigation-container .nav-account svg-icon svg{width:1.4117647059rem;height:1.4117647059rem}mv-side-menu .side-navigation-container .menu-items-wrapper{overflow:auto}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-side-menu .side-navigation-container .menu-items-wrapper{display:flex}}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items{flex:1 1 auto;list-style:none;margin:0;-webkit-overflow-scrolling:touch;padding:0 22px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items:first-of-type .item:last-of-type{border-bottom:solid 1px rgba(255,255,255,.2);padding-bottom:22px;margin-bottom:10px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items:last-of-type{padding-top:17px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items:last-of-type{padding-top:31px}}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items::-webkit-scrollbar{height:6px;width:6px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items::-webkit-scrollbar-track{background-color:#f5f7f7}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items::-webkit-scrollbar-thumb{background-color:#bdc3c7}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items a{display:table;text-decoration:none}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items a:focus{outline:white 1px solid}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item{margin-bottom:27px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner{display:flex;justify-content:space-between;align-items:center;color:#bdc3c7;font-size:.7647058824rem;margin:27px 0}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner .icon svg path{fill:#bdc3c7}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner .text{flex-grow:1}html[dir=ltr] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner .text{margin-right:5px}html[dir=rtl] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner .text{margin-left:5px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.store-banner .store-image{height:27px;width:92px;background:top left/contain no-repeat;display:block}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.about .icon svg{width:24px;height:24px;position:relative}html[dir=ltr] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.about .icon svg{right:3px}html[dir=rtl] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.about .icon svg{left:3px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item.about .icon svg path{fill:#bdc3c7}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .item:focus{outline:none}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .icon{display:flex;align-items:center;opacity:1;position:relative;visibility:visible;transition:fill .3s,opacity .3s .1s;fill:#bdc3c7}html[dir=ltr] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .icon{padding-right:16px}html[dir=rtl] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .icon{padding-left:16px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .icon svg{height:18px;width:18px}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .text{color:#bdc3c7;display:table-cell;opacity:0;visibility:hidden;transform:translate(10px);vertical-align:middle;transition:all .3s .2s;font-size:.7647058824rem}html[dir=rtl] mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .text{transform:translate(-10px)}mv-side-menu .side-navigation-container .menu-items-wrapper .menu-items .text:hover{color:#fff}mv-side-menu .side-navigation-container .external-buttons{border-top:1px solid #525357;box-sizing:border-box;flex:0 1 auto;padding:16px 35px;width:100%;display:none}mv-side-menu .side-navigation-container .external-buttons:focus{outline:none}mv-side-menu .side-navigation-container .external-buttons .rating{color:#bdc3c7;display:block;margin-bottom:16px;text-align:center}mv-side-menu .side-navigation-container .external-buttons .rating .text{font-size:.7647058824rem;font-weight:700}mv-side-menu .side-navigation-container .external-buttons .rating .stars{font-size:.6470588235rem;margin-top:7px}mv-side-menu .side-navigation-container .external-buttons .rating .stars img{width:80px}mv-side-menu .side-navigation-container .external-buttons .rating .stars span{position:relative;top:-2px}mv-side-menu .side-navigation-container .external-buttons .moovit{display:none}mv-side-menu .side-navigation-container .external-buttons a{background-position-x:center;background-repeat:no-repeat;background-size:contain;display:block;height:46px;margin-top:12px;vertical-align:bottom;width:100%}mv-side-menu .side-navigation-container .external-buttons .store-action-button,mv-side-menu .side-navigation-container .external-buttons .divider,mv-side-menu .side-navigation-container .external-buttons .rating{display:none}mv-side-menu.collapsed .side-navigation-container{transition:all .45s;opacity:0}html[dir=ltr] mv-side-menu.collapsed .side-navigation-container .nav-header .close-nav{left:23px}html[dir=rtl] mv-side-menu.collapsed .side-navigation-container .nav-header .close-nav{right:23px}mv-side-menu.collapsed .side-navigation-container .nav-header .title{opacity:0}mv-side-menu.collapsed .side-navigation-container .menu-items-wrapper .menu-items{padding:0 22px}mv-side-menu.collapsed .side-navigation-container .menu-items-wrapper .menu-items .item .icon{display:inline-block;position:relative;opacity:0;visibility:hidden}mv-side-menu.collapsed .side-navigation-container .menu-items-wrapper .menu-items .item .text{opacity:0;position:absolute;visibility:hidden;transition:none}mv-side-menu.collapsed .side-navigation-container .external-buttons{padding:36px 0}mv-side-menu.collapsed .side-navigation-container .external-buttons a{margin-top:10px}html[dir=ltr] mv-side-menu.collapsed .side-navigation-container .external-buttons a{margin-left:20px}html[dir=rtl] mv-side-menu.collapsed .side-navigation-container .external-buttons a{margin-right:20px}mv-side-menu.collapsed .side-navigation-container .external-buttons .rating{display:none}mv-side-menu.collapsed .side-navigation-container .external-buttons .moovit{background:url(/images/store-buttons/moovit_icon.png) center no-repeat;background-size:contain;height:20px;width:20px}mv-side-menu.collapsed .side-navigation-container .external-buttons .play-store{background:url(/images/store-buttons/android_icon.svg) center no-repeat;background-size:contain;height:20px;margin-top:16px;width:20px}mv-side-menu.collapsed .side-navigation-container .external-buttons .app-store{background:url(/images/store-buttons/apple_icon_color.svg) center no-repeat;background-size:contain;height:28px;position:relative;width:25px}html[dir=ltr] mv-side-menu.collapsed .side-navigation-container .external-buttons .app-store{left:-2px}html[dir=rtl] mv-side-menu.collapsed .side-navigation-container .external-buttons .app-store{right:-2px}mv-side-menu .carpool-footer{display:block;flex:1 0 auto;height:auto;position:relative}mv-side-menu .carpool-footer .carpool-text{font-size:.7058823529rem}\n"],encapsulation:2}),e})()},38399:function(e,t,n){"use strict";n.d(t,{e:function(){return U}});var i=n(3786),r=n(99528),o=n(86781),a=n(87897),s=n(52959),l=n(36179),c=n(97192),d=n(2316),u=n(5971),p=n(1238),h=n(1437),m=n(1),g=n(26365),f=n(10723),v=n(85431),y=n(87479),b=n(54364),_=n(93975),T=n(2339);const S=["scrollable"];function x(e,t){if(1&e&&(d.TgZ(0,"span",42),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(1),d.Oqu(d.lcZ(2,1,e.subtitle))}}function w(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"li",37),d.NdJ("click",function(t){const n=d.CHM(e).$implicit;return d.oxw().onItemClick(n,t)}),d.TgZ(1,"a",38),d.ALo(2,"translate"),d.TgZ(3,"div"),d.TgZ(4,"svg-icon",39),d.ALo(5,"translate"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.TgZ(8,"span",40),d._uU(9),d.ALo(10,"translate"),d.qZA(),d.YNc(11,x,3,3,"span",41),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw();d.Gre("item ",e.id,""),d.xp6(1),d.Q6J("href",n.resolveLink(e),d.LSH)("tabIndex",n.tabIndex),d.uIk("aria-label",d.lcZ(2,11,e.label)),d.xp6(3),d.s9C("titleText",d.lcZ(5,13,e.label)),d.Q6J("src",e.svgIcon),d.xp6(2),d.hij(" ",d.lcZ(7,15,e.label)," "),d.xp6(3),d.Oqu(d.lcZ(10,17,e.label)),d.xp6(2),d.Q6J("ngIf",e.subtitle)}}const k=function(e){return{CITY:e}};function M(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.Oqu(d.xi3(2,1,"splash_popular_app_city",d.VKq(4,k,e.metroName)))}}function L(e,t){1&e&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"store_popular_app")))}function A(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"li",47),d.NdJ("click",function(t){const n=d.CHM(e).$implicit;return d.oxw(2).onItemClick(n,t)}),d.TgZ(1,"a",48),d.NdJ("keydown.tab",function(t){const n=d.CHM(e).$implicit;return d.oxw(2).handleTab(n,t)}),d.TgZ(2,"span",40),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw(2);d.xp6(1),d.Q6J("href",n.resolveLink(e),d.LSH)("tabIndex",n.tabIndex),d.xp6(2),d.Oqu(d.lcZ(4,3,e.label))}}function I(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"li",47),d.NdJ("click",function(t){const n=d.CHM(e).$implicit;return d.oxw(2).onItemClick(n,t)}),d.TgZ(1,"a",48),d.NdJ("keydown.tab",function(t){const n=d.CHM(e).$implicit;return d.oxw(2).handleTab(n,t)}),d.TgZ(2,"span",40),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw(2);d.xp6(1),d.Q6J("href",n.resolveLink(e),d.LSH)("tabIndex",n.tabIndex),d.xp6(2),d.Oqu(d.lcZ(4,3,e.label))}}function E(e,t){if(1&e&&(d.TgZ(0,"div",43),d.TgZ(1,"div",13),d.TgZ(2,"div",14),d.TgZ(3,"div",15),d._UZ(4,"img",16),d.YNc(5,M,3,6,"span",17),d.YNc(6,L,3,3,"span",17),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"ul",44),d.YNc(8,A,5,5,"li",45),d.YNc(9,I,5,5,"li",45),d.qZA(),d.TgZ(10,"div",46),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(5),d.Q6J("ngIf",e.metroName),d.xp6(1),d.Q6J("ngIf",!e.metroName),d.xp6(2),d.Q6J("ngForOf",e.sideMenuMinimalItems),d.xp6(1),d.Q6J("ngForOf",e.sideMenuExpendableItems),d.xp6(2),d.Oqu(d.lcZ(12,5,"about_moovit_inc_rights"))}}function C(e,t){1&e&&(d.TgZ(0,"span",49),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"show_more")))}function D(e,t){1&e&&(d.TgZ(0,"span",50),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"show_less")))}function P(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Oqu(d.xi3(2,1,"splash_popular_app_city",d.VKq(4,k,e.metroName)))}}function O(e,t){1&e&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"store_popular_app")))}function N(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",51),d.TgZ(1,"div",29),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"div",52),d.TgZ(5,"a",53),d.NdJ("click",function(t){d.CHM(e);const n=d.oxw();return n.trackStoreClick(t,n.MobilePlatform.iOS)}),d.ALo(6,"translate"),d._UZ(7,"img",54),d.ALo(8,"translate"),d.qZA(),d.TgZ(9,"a",55),d.NdJ("click",function(t){d.CHM(e);const n=d.oxw();return n.trackStoreClick(t,n.MobilePlatform.Android)}),d.ALo(10,"translate"),d._UZ(11,"img",56),d.ALo(12,"translate"),d.qZA(),d._UZ(13,"mv-download-app-qr",57),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,8,"web_download_header")),d.xp6(3),d.Q6J("href",e.nativeAppsUrl.iosAppURL,d.LSH),d.uIk("aria-label",d.lcZ(6,10,"ios")),d.xp6(2),d.uIk("alt",d.lcZ(8,12,"ios")),d.xp6(2),d.Q6J("href",e.nativeAppsUrl.googleAppURL,d.LSH),d.uIk("aria-label",d.lcZ(10,14,"android")),d.xp6(2),d.uIk("alt",d.lcZ(12,16,"android")),d.xp6(2),d.Q6J("options",e.qrCodeParams)}}function R(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"a",62),d.NdJ("mouseover",function(){return d.CHM(e),d.oxw(2).hoveredStoreOption="moovit"}),d.qZA()}}function $(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",58),d.YNc(1,R,1,0,"a",59),d.TgZ(2,"button",60),d.NdJ("mouseover",function(){return d.CHM(e),d.oxw().hoveredStoreOption="play"})("click",function(t){return d.CHM(e),d.oxw().toggleNavigation(t)}),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"button",61),d.NdJ("mouseover",function(){return d.CHM(e),d.oxw().hoveredStoreOption="apple"})("click",function(t){return d.CHM(e),d.oxw().toggleNavigation(t)}),d.ALo(5,"translate"),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngIf",e.isInIframe),d.xp6(1),d.uIk("aria-label",d.lcZ(3,3,"android")),d.xp6(2),d.uIk("aria-label",d.lcZ(5,5,"ios"))}}function Y(e,t){if(1&e&&(d.TgZ(0,"div",63),d._UZ(1,"a",64),d.ALo(2,"translate"),d._UZ(3,"a",65),d.ALo(4,"translate"),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Jzz("background-image: url('",e.getBadgeImage(e.BadgeType.GooglePlay),"')"),d.Q6J("href",e.nativeAppsUrl.googleAppURL,d.LSH),d.uIk("aria-label",d.lcZ(2,10,"android")),d.xp6(2),d.Jzz("background-image: url('",e.getBadgeImage(e.BadgeType.AppleStore),"')"),d.s9C("aria-label",d.lcZ(4,12,"ios")),d.Q6J("href",e.nativeAppsUrl.iosAppURL,d.LSH)}}function F(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"li",37),d.NdJ("click",function(t){const n=d.CHM(e).$implicit;return d.oxw().onItemClick(n,t)}),d.TgZ(1,"a",66),d.TgZ(2,"span",40),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw();d.xp6(1),d.Q6J("href",n.resolveLink(e),d.LSH),d.xp6(2),d.Oqu(d.lcZ(4,2,e.label))}}const B=(0,o.hu)("SideNavigationComponent");let U=(()=>{class e{constructor(e,t,n,i,o,s,l,d){this.store=e,this.globalActions=t,this.analyticsService=n,this.sideNavService=i,this.metroService=o,this.localeService=s,this.urlGeneratorService=l,this.storeHelper=d,this.SideNavState=r.H_,this.BadgeType=a.g,this.sideMenuItems=[],this.footerLinks=[],this.sideMenuExpendableItems=[],this.hoveredStoreOption="moovit",this.qrCodeParams={campaign:c.oS.SideBar_QRcode,appArea:c.Kq.QR,imageUrl:"/images/store-buttons/QR.png",promoKey:"web_download_qr",displayDirection:"left"},this.MobilePlatform=r.$I}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){yield(0,s.p5)(this.store),this.sideMenuItems=this.sideNavService.getSideMenuItems(),this.sideMenuExpendableItems=this.sideNavService.sideMenuExpendableItems,this.footerLinks=this.sideNavService.getSideMenuMinimalItems().filter(e=>"supported_countries"!==e.id),this.metroName=this.metroService.getCurrentMetroName(),this.unsubscribe=this.storeHelper.subscribe("metro.metroId",()=>{this.footerLinks=this.sideNavService.getSideMenuMinimalItems()})})}ngOnDestroy(){this.unsubscribe()}get state(){return this.store.getState()}get sideNavState(){return this.state.global.sideNavigationState}get nativeAppsUrl(){return this.state.global.appStoreUrl}get isInIframe(){return(0,l.wV)()}toggleNavigation(e){B.info("SideNavigationComponent: toggling state"),e.currentTarget.blur(),this.sideNavState==r.H_.Collapsed?this.store.dispatch(this.globalActions.setSideNavigationState(r.H_.Expanded)):this.sideNavState==r.H_.Expanded&&this.store.dispatch(this.globalActions.setSideNavigationState(r.H_.Collapsed)),this.showStorePopup=!1,this.analyticsService.trackSideNavStateChange(r.H_[this.sideNavState]),e.stopPropagation()}onItemClick(e,t){e.onClick&&(e.onClick.call(this,[e,t]),t.preventDefault()),"support"===e.id&&this.analyticsService.trackSupportLink(!0),this.analyticsService.trackSideNavigationEvent(e.id)}resolveLink(e){return"function"==typeof e.link?e.link.call(this):e.link}toggleMoreLinks(e){this.showMoreLinks=!this.showMoreLinks,this.showMoreLinks&&setTimeout(()=>{this.scrollable.nativeElement.scrollTop=this.scrollable.nativeElement.scrollHeight},0),e.stopPropagation()}isQRCodeAvailable(){return this.localeService.isInHouseLanguage(this.state.global.selectedLocale.id)}trackStoreClick(e,t){this.analyticsService.trackStoreClick("sidebar",t),e.stopPropagation()}getBadgeImage(e){return this.urlGeneratorService.getBadge(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.d),d.Y36(p.l),d.Y36(h.y),d.Y36(m.W),d.Y36(g.V),d.Y36(f.OL),d.Y36(a.o),d.Y36(v.N))},e.\u0275cmp=d.Xpm({type:e,selectors:[["mv-side-navigation"]],viewQuery:function(e,t){if(1&e&&d.Gf(S,5),2&e){let e;d.iGM(e=d.CRH())&&(t.scrollable=e.first)}},decls:52,vars:43,consts:[[1,"side-navigation-container"],[1,"nav-header"],[1,"close-nav",3,"click"],["src","images/nav-icons/toggle_icon.svg"],["id","scrollable",1,"scroll-container"],["scrollable",""],["itemscope","","itemtype","http://www.schema.org/SiteNavigationElement",1,"menu-items"],[3,"class","click",4,"ngFor","ngForOf"],["class","show-more-menu",4,"ngIf"],[1,"show-more-toggle",3,"click"],["class","show-more",4,"ngIf"],["class","show-less",4,"ngIf"],["src","/images/icons/collapse_black.svg",1,"icon"],[1,"moovit-banner"],[1,"title"],[1,"large-title"],["src","/images/moovit_logo_full.svg","alt","Moovit",1,"banner-logo"],[4,"ngIf"],["class","qr-code-wrapper",4,"ngIf"],["itemscope","","itemtype","http://schema.org/MobileApplication",1,"external-buttons",3,"mouseenter"],["itemprop","name","content","Moovit"],["itemprop","installUrl",3,"content"],["itemprop","operatingSystem","content","Android, iOS, Mobile Web"],["itemprop","applicationCategory","content","MAPS_AND_NAVIGATION"],["itemprop","offers","itemscope","","itemtype","http://schema.org/Offer"],["itemprop","priceCurrency","content","USD"],["itemprop","price","content","0"],["itemprop","url","content","https://moovit.com"],[1,"app-store-wrapper"],[1,"text"],["class","app-icons-wrapper",4,"ngIf"],["class","stores-wrapper",4,"ngIf"],[1,"footer-links"],[3,"click",4,"ngFor","ngForOf"],[3,"hidden","mouseleave"],["target","_blank",1,"store-action-button",3,"href","click"],[3,"src"],[3,"click"],["target","_blank","itemprop","url",3,"href","tabIndex"],["mvAccessibleSVG","",1,"icon",3,"src","titleText"],["itemprop","name",1,"text"],["class","small-text","itemprop","name","class","small-text",4,"ngIf"],["itemprop","name",1,"small-text"],[1,"show-more-menu"],["itemscope","","itemtype","http://www.schema.org/SiteNavigationElement",1,"footer-links"],["class","item",3,"click",4,"ngFor","ngForOf"],[1,"copyright"],[1,"item",3,"click"],["target","_blank","itemprop","url",3,"href","tabIndex","keydown.tab"],[1,"show-more"],[1,"show-less"],[1,"qr-code-wrapper"],[1,"app-download-options"],["target","_blank",1,"store-action-button","app-store",3,"href","click"],["src","/images/apple_icon_gray.svg"],["target","_blank",1,"store-action-button","play-store",3,"href","click"],["src","/images/store-buttons/android_icon.svg"],[3,"options"],[1,"app-icons-wrapper"],["aria-label","moovit","href","","class","store-action-button moovit",3,"mouseover",4,"ngIf"],[1,"store-action-button","play-store",3,"mouseover","click"],[1,"store-action-button","app-store",3,"mouseover","click"],["aria-label","moovit","href","",1,"store-action-button","moovit",3,"mouseover"],[1,"stores-wrapper"],["target","_blank",1,"store-action-button","play-store",3,"href"],["target","_blank",1,"store-action-button","app-store",3,"aria-label","href"],["itemprop","url","target","_blank",3,"href"]],template:function(e,t){1&e&&(d.TgZ(0,"aside",0),d.TgZ(1,"div",1),d.TgZ(2,"button",2),d.NdJ("click",function(e){return t.toggleNavigation(e)}),d.ALo(3,"translate"),d._UZ(4,"svg-icon",3),d.ALo(5,"translate"),d.qZA(),d.qZA(),d.TgZ(6,"div",4,5),d.TgZ(8,"ul",6),d.YNc(9,w,12,19,"li",7),d.qZA(),d.YNc(10,E,13,7,"div",8),d.qZA(),d.TgZ(11,"button",9),d.NdJ("click",function(e){return t.toggleMoreLinks(e)}),d.ALo(12,"translate"),d.TgZ(13,"div"),d.YNc(14,C,3,3,"span",10),d.YNc(15,D,3,3,"span",11),d._UZ(16,"svg-icon",12),d.ALo(17,"translate"),d.qZA(),d.qZA(),d.TgZ(18,"div",13),d.TgZ(19,"div",14),d.TgZ(20,"div",15),d._UZ(21,"img",16),d.YNc(22,P,3,6,"span",17),d.YNc(23,O,3,3,"span",17),d.qZA(),d.qZA(),d.qZA(),d.YNc(24,N,14,18,"div",18),d.TgZ(25,"div",19),d.NdJ("mouseenter",function(){return t.showStorePopup=!0}),d._UZ(26,"meta",20),d._UZ(27,"meta",21),d._UZ(28,"meta",22),d._UZ(29,"meta",23),d.TgZ(30,"div",24),d._UZ(31,"meta",25),d._UZ(32,"meta",26),d._UZ(33,"meta",27),d.qZA(),d.TgZ(34,"div",28),d.TgZ(35,"div",29),d._uU(36),d.ALo(37,"translate"),d.qZA(),d.YNc(38,$,6,7,"div",30),d.YNc(39,Y,5,14,"div",31),d.qZA(),d.qZA(),d.TgZ(40,"ul",32),d.YNc(41,F,5,4,"li",33),d.qZA(),d.qZA(),d.TgZ(42,"div",34),d.NdJ("mouseleave",function(){return t.showStorePopup=!1}),d.TgZ(43,"div"),d._uU(44),d.ALo(45,"translate"),d.qZA(),d.TgZ(46,"a",35),d.NdJ("click",function(e){return t.trackStoreClick(e,t.MobilePlatform.Android)}),d._UZ(47,"img",36),d.ALo(48,"translate"),d.qZA(),d.TgZ(49,"a",35),d.NdJ("click",function(e){return t.trackStoreClick(e,t.MobilePlatform.iOS)}),d._UZ(50,"img",36),d.ALo(51,"translate"),d.qZA(),d.qZA()),2&e&&(d.xp6(2),d.uIk("aria-label",d.lcZ(3,27,"a11y_toggle_navigation")),d.xp6(2),d.uIk("alt",d.lcZ(5,29,"a11y_toggle_navigation")),d.xp6(5),d.Q6J("ngForOf",t.sideMenuItems),d.xp6(1),d.Q6J("ngIf",t.showMoreLinks),d.xp6(1),d.uIk("aria-label",d.lcZ(12,31,"a11y_show_more")),d.xp6(3),d.Q6J("ngIf",!t.showMoreLinks),d.xp6(1),d.Q6J("ngIf",t.showMoreLinks),d.xp6(1),d.uIk("alt",d.lcZ(17,33,"a11y_show_more")),d.xp6(6),d.Q6J("ngIf",t.metroName),d.xp6(1),d.Q6J("ngIf",!t.metroName),d.xp6(1),d.Q6J("ngIf",t.isQRCodeAvailable()),d.xp6(3),d.Q6J("content",t.nativeAppsUrl.googleAppURL),d.xp6(9),d.Oqu(d.lcZ(37,35,"web_download_label")),d.xp6(2),d.Q6J("ngIf",t.sideNavState===t.SideNavState.Collapsed),d.xp6(1),d.Q6J("ngIf",t.sideNavState!==t.SideNavState.Collapsed),d.xp6(2),d.Q6J("ngForOf",t.footerLinks),d.xp6(1),d.Gre("store-popup ",t.hoveredStoreOption,""),d.Q6J("hidden",!t.showStorePopup),d.xp6(2),d.Oqu(d.lcZ(45,37,"web_download_label")),d.xp6(2),d.Q6J("href",t.nativeAppsUrl.googleAppURL,d.LSH),d.xp6(1),d.Q6J("src",t.getBadgeImage(t.BadgeType.GooglePlay),d.LSH),d.uIk("alt",d.lcZ(48,39,"android")),d.xp6(2),d.Q6J("href",t.nativeAppsUrl.iosAppURL,d.LSH),d.xp6(1),d.Q6J("src",t.getBadgeImage(t.BadgeType.AppleStore),d.LSH),d.uIk("alt",d.lcZ(51,41,"ios")))},directives:[y.bk,b.sg,b.O5,_.m,c.w4],pipes:[T.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-side-navigation{display:flex;height:100%;position:fixed;top:0;z-index:99;transition:all .3s}html[dir=ltr] mv-side-navigation{right:0}html[dir=rtl] mv-side-navigation{left:0}mv-side-navigation a{text-decoration:none}mv-side-navigation mv-download-app-qr .qr-links .banner-download-options .store-action-button{display:none}mv-side-navigation.collapsed{transform:translate(8.7058823529rem)}html[dir=rtl] mv-side-navigation.collapsed{transform:translate(-148px)}html[dir=ltr] mv-side-navigation.collapsed .side-navigation-container .nav-header .close-nav{left:1.1176470588rem}html[dir=rtl] mv-side-navigation.collapsed .side-navigation-container .nav-header .close-nav{right:1.1176470588rem}mv-side-navigation.collapsed .side-navigation-container .nav-header .close-nav svg-icon{fill:#c34820;transform:scaleX(1)}html[dir=rtl] mv-side-navigation.collapsed .side-navigation-container .nav-header .close-nav svg-icon{transform:scaleX(-1)}mv-side-navigation.collapsed .side-navigation-container .nav-header .title{opacity:0}mv-side-navigation.collapsed .side-navigation-container .nav-header{background-color:#f8f7f7}mv-side-navigation.collapsed .side-navigation-container .scroll-container{flex-grow:1;transition:all .3s}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items{padding:0;width:3.6470588235rem;margin-top:25px}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item{display:flex;align-items:center;height:65px;flex-grow:0;box-shadow:none;min-height:0}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item.company a svg-icon svg{width:1.0588235294rem}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item.smart-city-solutions a svg-icon svg{width:1.1764705882rem}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item.community a svg-icon svg{width:1.1764705882rem}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item.press a svg-icon svg{width:1.4117647059rem}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item a{justify-content:center}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item .icon{width:2.5882352941rem;height:2.5882352941rem;min-height:44px;border-radius:50%;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;margin:0 auto;background:none}mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item .icon svg,mv-side-navigation.collapsed .side-navigation-container .scroll-container .menu-items .item .icon svg .st0{display:table-cell;height:auto;width:1.1764705882rem;fill:#bdc3c7}mv-side-navigation.collapsed .side-navigation-container .show-more-menu{display:none}mv-side-navigation.collapsed .side-navigation-container>.moovit-banner~.footer-links{display:none}mv-side-navigation.collapsed .side-navigation-container .show-more-toggle,mv-side-navigation.collapsed .side-navigation-container .moovit-banner{display:none}mv-side-navigation.collapsed .side-navigation-container div.external-buttons{padding:36px 0;width:62px;box-shadow:none}mv-side-navigation.collapsed .side-navigation-container div.external-buttons a{margin-top:10px}html[dir=ltr] mv-side-navigation.collapsed .side-navigation-container div.external-buttons a{margin-left:1.1764705882rem}html[dir=rtl] mv-side-navigation.collapsed .side-navigation-container div.external-buttons a{margin-right:1.1764705882rem}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .rating{display:none}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .moovit{background:url(/images/store-buttons/moovit_icon.png) center no-repeat;background-size:contain;height:20px;width:20px}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .stores-wrapper{display:flex}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .app-store-wrapper{border-top:1px solid #ecf0f1;padding-top:20px}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .app-store-wrapper .text{display:none}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .app-store-wrapper .app-icons-wrapper{display:flex;flex-direction:column;align-items:center}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .play-store{background:url(/images/store-buttons/android_icon_gray.svg) center no-repeat;background-size:contain;height:1.4705882353rem;margin-top:.9411764706rem;width:1.4705882353rem;margin-bottom:.5882352941rem}mv-side-navigation.collapsed .side-navigation-container div.external-buttons .app-store{background:url(/images/apple_icon_gray.svg) center no-repeat;background-size:contain;height:1.2941176471rem;position:relative;width:1.5882352941rem}mv-side-navigation.collapsed .side-navigation-container .item{flex-grow:inherit;min-height:unset}mv-side-navigation.collapsed .side-navigation-container .item .text{opacity:0;position:absolute;transition:all .3s}mv-side-navigation.collapsed .side-navigation-container .item .small-text{opacity:0;position:absolute}mv-side-navigation.collapsed .side-navigation-container .qr-code-wrapper{display:none}mv-side-navigation.expanded{transform:translate(0)}mv-side-navigation.expanded .side-navigation-container .nav-header .close-nav svg-icon{fill:#292a30}mv-side-navigation.expanded .nav-header{box-shadow:0 1px 4px #0000003b}mv-side-navigation.expanded .footer-links a:focus,mv-side-navigation.expanded .menu-items a:focus{outline:none}mv-side-navigation.expanded .scroll-container{overflow-y:auto}mv-side-navigation.expanded .scroll-container .menu-items{overflow-y:auto}mv-side-navigation.expanded .scroll-container .menu-items .item.about .icon{background-color:#f3471a}mv-side-navigation.expanded .scroll-container .menu-items .item.smart-city-solutions .icon{background-color:#2196f3}mv-side-navigation.expanded .scroll-container .menu-items .item.community .icon{background-color:#f7a20c}mv-side-navigation.expanded .scroll-container .menu-items .item.press .icon{background-color:#1db969}mv-side-navigation.expanded .scroll-container .menu-items .item.support .icon{background-color:#003e54}mv-side-navigation.expanded .scroll-container .menu-items .item:last-child:after{content:"";position:absolute;bottom:0;width:100%;height:1px;box-shadow:0 -1px 3px #0009}mv-side-navigation.expanded .scroll-container .menu-items .item a>div{padding:0 20px}mv-side-navigation.expanded .scroll-container .menu-items .item .icon svg{display:none}mv-side-navigation.expanded .qr-code-wrapper~.external-buttons{display:none}mv-side-navigation.expanded .qr-code-wrapper{position:relative;padding:15px 20px 10px;background-color:#fff}mv-side-navigation.expanded .qr-code-wrapper .pop-up-button img{padding:0 6px}html[dir=ltr] mv-side-navigation.expanded .qr-code-wrapper .pop-up-button img{margin-left:4px}html[dir=rtl] mv-side-navigation.expanded .qr-code-wrapper .pop-up-button img{margin-right:4px}html[dir=ltr] mv-side-navigation.expanded .qr-code-wrapper .pop-up-button img{border-left:1px solid #b2b2b2}html[dir=rtl] mv-side-navigation.expanded .qr-code-wrapper .pop-up-button img{border-right:1px solid #b2b2b2}mv-side-navigation.expanded .qr-code-wrapper .text{font-weight:500}mv-side-navigation.expanded .qr-code-wrapper .app-download-options{display:inline-flex;align-items:center;margin:3px 0 5px;font-size:.7058823529rem;line-height:1.2}mv-side-navigation.expanded .qr-code-wrapper .app-download-options .play-store{height:1.3529411765rem}mv-side-navigation.expanded .qr-code-wrapper .app-download-options .play-store img{width:1.3529411765rem}mv-side-navigation.expanded .qr-code-wrapper .app-download-options .app-store{filter:brightness(.9)}mv-side-navigation.expanded .qr-code-wrapper .app-download-options .app-store img{width:1.1176470588rem;width:.9411764706rem}mv-side-navigation.expanded .item .text{opacity:1;visibility:visible;transform:translate(0)}html[dir=rtl] mv-side-navigation.expanded .item .text{transform:translate(0)}mv-side-navigation.expanded .store-popup{opacity:0;visibility:hidden}mv-side-navigation.expanded .overlay{opacity:1;visibility:visible}mv-side-navigation.expanded .show-more-toggle,mv-side-navigation.expanded .moovit-banner{opacity:1}html[dir=ltr] mv-side-navigation.expanded .show-more-toggle,html[dir=ltr] mv-side-navigation.expanded .moovit-banner{transform:translate(0)}html[dir=rtl] mv-side-navigation.expanded .show-more-toggle,html[dir=rtl] mv-side-navigation.expanded .moovit-banner{transform:translate(0)}mv-side-navigation .side-navigation-container{display:flex;flex-direction:column;background:#fff;box-sizing:border-box;height:100%;position:relative;width:12.3529411765rem;z-index:99;box-shadow:0 2px 6px #00000080}html[dir=ltr] mv-side-navigation .side-navigation-container .close-nav{left:15px}html[dir=rtl] mv-side-navigation .side-navigation-container .close-nav{right:15px}mv-side-navigation .side-navigation-container .close-nav svg-icon{transform:scaleX(-1)}html[dir=rtl] mv-side-navigation .side-navigation-container .close-nav svg-icon{transform:scaleX(1)}mv-side-navigation .side-navigation-container.hidden{display:none}mv-side-navigation .side-navigation-container .scroll-container{height:52.1vh}@media screen and (max-height: 768px) and (orientation: landscape){mv-side-navigation .side-navigation-container .scroll-container{height:72.1vh}}mv-side-navigation .side-navigation-container .scroll-container .menu-items{position:relative;height:100%}mv-side-navigation .side-navigation-container .scroll-container .menu-items .item{min-height:25%;box-shadow:0 2px #ecf0f1}mv-side-navigation .side-navigation-container .scroll-container .menu-items .item>a{padding:5% 0}mv-side-navigation .side-navigation-container .scroll-container .menu-items .item>a>div .text{margin:10px 0 2px}mv-side-navigation .side-navigation-container .scroll-container .menu-items .item .icon{width:25px;height:5px;border-radius:6px;fill:#737578;margin:0;display:flex;align-items:center;transition:fill .3s,opacity .3s .1s}mv-side-navigation .side-navigation-container .scroll-container .menu-items .item .icon:hover{fill:#bdc3c7}mv-side-navigation .side-navigation-container .moovit-banner{position:relative;box-sizing:border-box;min-height:12.3529411765rem;padding:1.1764705882rem .8823529412rem;color:#292a30;overflow:hidden;transition:all .3s;display:flex;align-items:center}mv-side-navigation .side-navigation-container .moovit-banner+.qr-code-wrapper,mv-side-navigation .side-navigation-container .moovit-banner+.external-buttons{box-shadow:inset 0 3px 3px #0000004d}mv-side-navigation .side-navigation-container .moovit-banner:after{content:"";position:absolute;width:100%;height:100%;background:url(/images/side_banner_background.jpg) center bottom/cover;top:0;left:0;z-index:-1}html[dir=rtl] mv-side-navigation .side-navigation-container .moovit-banner:after{transform:scaleX(-1)}mv-side-navigation .side-navigation-container .moovit-banner .title{transition:all .7s;transform:translate(0);font-weight:700;margin-top:15px;margin-bottom:15px}html[dir=ltr] mv-side-navigation .side-navigation-container .moovit-banner .title{margin-right:58px}html[dir=rtl] mv-side-navigation .side-navigation-container .moovit-banner .title{margin-left:58px}mv-side-navigation .side-navigation-container .moovit-banner .title .banner-logo{width:79px;display:block;margin-bottom:8px}mv-side-navigation .side-navigation-container .moovit-banner .title .large-title{font-size:.9411764706rem;line-height:1.2;margin-bottom:6px;word-break:break-word;margin-top:8px}mv-side-navigation .side-navigation-container .moovit-banner .title .large-title span.moovit{color:#c34820}@media screen and (max-height: 768px) and (orientation: landscape){mv-side-navigation .side-navigation-container>.moovit-banner{display:none}}mv-side-navigation .side-navigation-container .show-more-menu{background-color:#f8f7f7;margin:0;position:relative;padding:0 0 10px;line-height:1.5}mv-side-navigation .side-navigation-container .show-more-menu>.moovit-banner{display:none}@media screen and (max-height: 769px) and (orientation: landscape){mv-side-navigation .side-navigation-container .show-more-menu>.moovit-banner{display:flex}}mv-side-navigation .side-navigation-container .show-more-menu .show-more-header{font-size:.9411764706rem;margin-bottom:5px;padding:25px 20px 0;text-align:center}mv-side-navigation .side-navigation-container .show-more-menu .show-more-header .show-more-logo{color:#c34820;font-weight:500;font-size:1.1176470588rem}mv-side-navigation .side-navigation-container .show-more-menu .footer-links{padding:10px 20px 0;margin:0}mv-side-navigation .side-navigation-container .show-more-menu ul{list-style:none;margin:0 20px;font-weight:300;padding:0 20px;display:inline-flex;flex-wrap:wrap;width:100%;box-sizing:border-box}mv-side-navigation .side-navigation-container .show-more-menu ul li{line-height:24px}mv-side-navigation .side-navigation-container .show-more-menu ul li:after{content:"|";padding:0 4px;position:absolute}mv-side-navigation .side-navigation-container .show-more-menu ul li:last-of-type:after{display:none}mv-side-navigation .side-navigation-container .show-more-menu ul.moovit-links{margin:10px 0 0}mv-side-navigation .side-navigation-container .show-more-menu ul.moovit-links li a{color:#001926;outline:none}mv-side-navigation .side-navigation-container .show-more-menu .copyright{font-size:.7647058824rem;padding:5px 20px 0;letter-spacing:-.1px}mv-side-navigation .side-navigation-container .footer-links{display:inline-flex;flex-wrap:wrap;list-style:none;font-weight:300;padding:10px 15px;margin:0;border-top:#ECF0F1 solid 3px}mv-side-navigation .side-navigation-container .footer-links li{padding:0 5px 3px}mv-side-navigation .side-navigation-container .footer-links li:last-of-type{padding-bottom:0}mv-side-navigation .side-navigation-container .footer-links li a{color:#292a30;font-size:.7058823529rem}mv-side-navigation .side-navigation-container .show-more-toggle{width:100%;padding:11px 20px 10px;outline:none;background-color:#f8f7f7;transition:background-color ease .3s;box-shadow:1px -2px 3px #cfcfcf}html[dir=ltr] mv-side-navigation .side-navigation-container .show-more-toggle{text-align:left}html[dir=rtl] mv-side-navigation .side-navigation-container .show-more-toggle{text-align:right}mv-side-navigation .side-navigation-container .show-more-toggle:focus{outline:auto}mv-side-navigation .side-navigation-container .show-more-toggle div{cursor:pointer;display:inline-block}mv-side-navigation .side-navigation-container .show-more-toggle div .icon svg{height:8px;width:13px}html[dir=ltr] mv-side-navigation .side-navigation-container .show-more-toggle div .icon svg{margin-left:5px}html[dir=rtl] mv-side-navigation .side-navigation-container .show-more-toggle div .icon svg{margin-right:5px}mv-side-navigation .side-navigation-container .show-more-toggle span{font-size:.7058823529rem;font-weight:500;-moz-user-select:none;user-select:none;-webkit-user-select:none}mv-side-navigation .side-navigation-container .show-more-toggle span~.icon svg{transform:scaleY(-1)}mv-side-navigation .side-navigation-container .show-more-toggle span.show-less~.icon svg{transform:scaleY(1)}mv-side-navigation .side-navigation-container .menu-items{list-style:none;margin:0;overflow:hidden;padding:0;min-height:150px}mv-side-navigation .side-navigation-container .menu-items a{text-decoration:none;display:inline-block}mv-side-navigation .side-navigation-container .menu-items .item{width:100%;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;transition:background-color .3s ease;cursor:pointer;position:relative}mv-side-navigation .side-navigation-container .menu-items .item>a{width:100%;display:flex}mv-side-navigation .side-navigation-container .menu-items .item:hover{background-color:#ecf0f1}mv-side-navigation .side-navigation-container .menu-items .item:focus{outline:none}mv-side-navigation .side-navigation-container .menu-items .item .text{color:#292a30;font-size:.9411764706rem;font-weight:600;display:block;transition:all .1s}mv-side-navigation .side-navigation-container .menu-items .item .small-text{font-size:.7058823529rem;color:#001926;font-weight:300}mv-side-navigation .side-navigation-container .external-buttons{box-sizing:border-box;padding:16px 0;width:100%}mv-side-navigation .side-navigation-container .external-buttons .app-store-wrapper{width:100%;padding:0 20px;box-sizing:border-box}mv-side-navigation .side-navigation-container .external-buttons .app-store-wrapper .stores-wrapper{display:flex;width:100%}mv-side-navigation .side-navigation-container .external-buttons .app-store-wrapper .stores-wrapper>a{margin:10px 2px 0}mv-side-navigation .side-navigation-container .external-buttons:focus{outline:none}mv-side-navigation .side-navigation-container .external-buttons .rating{color:#bdc3c7;display:block;margin-bottom:16px;text-align:center}mv-side-navigation .side-navigation-container .external-buttons .rating .text{font-size:.7647058824rem;font-weight:700}mv-side-navigation .side-navigation-container .external-buttons .rating .stars{font-size:.6470588235rem;margin-top:7px}mv-side-navigation .side-navigation-container .external-buttons .rating .stars img{width:80px}mv-side-navigation .side-navigation-container .external-buttons .rating .stars span{position:relative;top:-2px}mv-side-navigation .side-navigation-container .external-buttons .moovit{display:none}mv-side-navigation .side-navigation-container .external-buttons a{background-position-x:center;background-repeat:no-repeat;background-size:contain;display:block;height:1.7647058824rem;margin-top:12px;vertical-align:bottom;width:100%}mv-side-navigation .side-navigation-container .nav-header{display:flex;align-items:center;min-height:2.9411764706rem;width:100%;background-color:#f8f7f7}mv-side-navigation .side-navigation-container .nav-header .close-nav{position:absolute;top:.7647058824rem}mv-side-navigation .side-navigation-container .nav-header .close-nav svg-icon{height:1.4117647059rem;width:1.4117647059rem;fill:#c34820;margin:0}mv-side-navigation .store-popup{background:#fff;border:#BDC3C7 solid 1px;border-radius:4px;bottom:10px;opacity:1;padding:10px 20px;position:absolute;visibility:visible;z-index:1;transition:right .3s}html[dir=ltr] mv-side-navigation .store-popup{right:calc(100% + 12px)}html[dir=rtl] mv-side-navigation .store-popup{left:calc(100% + 12px)}mv-side-navigation .store-popup:before{background:#fff;border:1px solid transparent;border-right-color:#bdc3c7;border-top-color:#bdc3c7;content:"";display:block;height:8px;position:absolute;top:calc(50% + 9px);width:8px;transform:translateY(-50%) rotate(45deg)}html[dir=ltr] mv-side-navigation .store-popup:before{right:-5px}html[dir=rtl] mv-side-navigation .store-popup:before{left:-5px}html[dir=rtl] mv-side-navigation .store-popup:before{transform:translateY(-50%) rotate(-135deg)}mv-side-navigation .store-popup:focus{outline:none}mv-side-navigation .store-popup.ng-hide{opacity:0;visibility:hidden}html[dir=ltr] mv-side-navigation .store-popup.ng-hide{right:100%}html[dir=rtl] mv-side-navigation .store-popup.ng-hide{left:100%}mv-side-navigation .store-popup>div{font-size:.5882352941rem;line-height:1;text-align:center}mv-side-navigation .store-popup .store-action-button{display:block;margin-top:10px;width:110px}mv-side-navigation .store-popup .store-action-button img{width:100%}\n'],encapsulation:2}),e})()},26152:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var i=n(2316),r=n(5971),o=n(54364);let a=(()=>{class e{constructor(e){this.store=e}get state(){return this.store.getState()}get snackbar(){return this.state.global.snackbar}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.d))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-snackbar"]],decls:2,vars:4,consts:[[1,"snackbar",3,"ngClass"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i._uU(1),i.qZA()),2&e&&(i.ekj("show",t.snackbar),i.Q6J("ngClass",null==t.snackbar?null:t.snackbar.klass),i.xp6(1),i.hij(" ",null==t.snackbar?null:t.snackbar.text,"\n"))},directives:[o.mk],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.snackbar{position:fixed;min-height:40px;bottom:0;left:0;right:0;margin:auto;opacity:0;background:#292A30;color:#ecf0f1;font-size:1.25em;padding:0 15px;z-index:1000;box-sizing:border-box;display:flex;align-items:center;width:100%;transition:transform .3s ease-out,opacity .2s;transform:translateY(50px);pointer-events:none}.snackbar.show{transform:translateY(0);opacity:1}.snackbar.login{background-color:#2196f3;color:#fff;font-size:.8235294118rem;padding:8px 22px;display:flex;align-items:center;min-height:44px}html[dir=ltr] .snackbar.login{text-align:left}html[dir=rtl] .snackbar.login{text-align:right}.snackbar.login:before{content:"";background:url(/images/icons/alert-good.svg) center/cover;width:1.4117647059rem;height:1.4117647059rem}html[dir=ltr] .snackbar.login:before{margin-right:10px}html[dir=rtl] .snackbar.login:before{margin-left:10px}\n'],encapsulation:2}),e})()},15041:function(e,t,n){"use strict";n.d(t,{c:function(){return l}});var i=n(2316),r=n(51063),o=n(54364),a=n(46461),s=n(2339);let l=(()=>{class e{constructor(e){this.document=e,this.bannerClick=new i.vpe,this.bannerDismiss=new i.vpe}onBannerClick(){this.bannerClick.emit()}onBannerDismiss(){this.bannerDismiss.emit()}get ctaTextKey(){const e=(0,r.L)("data-splash-cta-text",this.document);return e?"V1"===e.variant?"splash_cta1":"V2"===e.variant?"splash_cta2":void 0:"web_download_button"}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(o.K0))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-app-links-wrapper"]],inputs:{bannerUrl:"bannerUrl",bannerMotUrl:"bannerMotUrl"},outputs:{bannerClick:"bannerClick",bannerDismiss:"bannerDismiss"},decls:21,vars:11,consts:[["role","button",1,"use-app-button","optimize",3,"href","click"],[1,"mot-links","optimize"],[1,"app-rating-wrapper","optimize"],["mvImg","","src","images/splash/app_icon.png","alt","app icon",1,"app-icon"],[1,"text"],[1,"name"],[1,"stars"],["mvImg","","src","images/splash/rating.png","alt","app rating"],["role","button",1,"use-app-button",3,"href","click"],["role","button","tabindex","0",1,"splash-btn","splash-btn-site","optimize",3,"click","keydown.enter"]],template:function(e,t){1&e&&(i.TgZ(0,"a",0),i.NdJ("click",function(){return t.onBannerClick()}),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.qZA(),i.TgZ(4,"div",1),i.TgZ(5,"div",2),i._UZ(6,"img",3),i.TgZ(7,"div",4),i.TgZ(8,"div",5),i._uU(9,"Moovit"),i.qZA(),i.TgZ(10,"div",6),i._UZ(11,"img",7),i.TgZ(12,"span"),i._uU(13,"(934,930)"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(14,"a",8),i.NdJ("click",function(){return t.onBannerClick()}),i.TgZ(15,"span"),i._uU(16),i.ALo(17,"translate"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(18,"a",9),i.NdJ("click",function(){return t.onBannerDismiss()})("keydown.enter",function(){return t.onBannerDismiss()}),i._uU(19),i.ALo(20,"translate"),i.qZA()),2&e&&(i.Q6J("href",t.bannerUrl,i.LSH),i.xp6(2),i.Oqu(i.lcZ(3,5,t.ctaTextKey)),i.xp6(12),i.Q6J("href",t.bannerMotUrl,i.LSH),i.xp6(2),i.Oqu(i.lcZ(17,7,"banner_mot_cta")),i.xp6(3),i.hij(" ",i.lcZ(20,9,"web_mobile_view_button"),"\n"))},directives:[a.X],pipes:[s.X$],encapsulation:2}),e})()},11098:function(e,t,n){"use strict";n.d(t,{j:function(){return v}});var i=n(3786),r=n(13691),o=n(52959),a=n(2316),s=n(5971),l=n(1437),c=n(95505),d=n(1238),u=n(26365),p=n(61787),h=n(5306),m=n(54364),g=n(46461);function f(e,t){if(1&e&&(a.TgZ(0,"span"),a._UZ(1,"img",3),a.qZA()),2&e){const e=t.$implicit;a.Gre("route-icon-",t.index+1,""),a.xp6(1),a.Q6J("src",e,a.LSH)}}let v=(()=>{class e{constructor(e,t,n,i,o,a,s){this.store=e,this.analyticsService=t,this.routingService=n,this.globalActions=i,this.metroService=o,this.canonicalService=a,this.universal=s,this.transitIcons=Array(3).fill("data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="),this.trackByIndex=r.z8}get state(){return this.store.getState()}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.universal.isBrowser){yield(0,o.p5)(this.store);const e=this.routingService.getStateFromUrl();this.updateTransitIcons(e.metroId)}})}onBannerClick(){this.analyticsService.trackStoreClick("splash")}updateTransitIcons(e){this.transitIcons=this.getTransitIconsList(e)}getTransitIconsList(e){const t=this.metroService.getMetroTransitTypeImages(e),n=t.metroTransitImagesPaths,i=t.genericTransitImagesPaths;let r=n;return(n?n.length:0)<6&&i&&(r=n.concat(i)),r.slice(0,3)}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(s.d),a.Y36(l.y),a.Y36(c.Z),a.Y36(d.l),a.Y36(u.V),a.Y36(p.z),a.Y36(h.p))},e.\u0275cmp=a.Xpm({type:e,selectors:[["mv-localized-splash-content"]],inputs:{bannerUrl:"bannerUrl",splashType:"splashType"},decls:3,vars:2,consts:[[1,"animated-routes"],[1,"optimize-icons-group"],[3,"class",4,"ngFor","ngForOf","ngForTrackBy"],["mvImg","","alt","",3,"src"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.YNc(2,f,2,4,"span",2),a.qZA(),a.qZA()),2&e&&(a.xp6(2),a.Q6J("ngForOf",t.transitIcons)("ngForTrackBy",t.trackByIndex))},directives:[m.sg,g.X],encapsulation:2}),e})()},43087:function(e,t,n){"use strict";n.d(t,{u:function(){return d}});var i=n(2316),r=n(46461),o=n(15041),a=n(54364),s=n(2339),l=n(79223);function c(e,t){if(1&e&&(i.TgZ(0,"div",9),i._UZ(1,"img",10),i.qZA()),2&e){const e=i.oxw();i.xp6(1),i.Q6J("src",e.animatedTransitsTestUrl,i.LSH)}}let d=(()=>{class e{constructor(){this.animatedTransitsTestUrl=null,this.bannerClick=new i.vpe,this.bannerDismiss=new i.vpe}onBannerClick(){this.bannerClick.emit()}onDismissClick(){this.bannerDismiss.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-splash-generic"]],inputs:{bannerUrl:"bannerUrl",splashType:"splashType",animatedTransitsTestUrl:"animatedTransitsTestUrl"},outputs:{bannerClick:"bannerClick",bannerDismiss:"bannerDismiss"},decls:15,vars:13,consts:[[1,"splash-title-wrapper"],["mvImg","","src","images/moovit_logo_full-white.svg","alt","moovit logo",1,"logo"],[1,"splash-title"],[1,"splash-subtitle"],[1,"optimize",3,"innerHTML"],[3,"bannerUrl","bannerClick","bannerDismiss"],["class","animated-transits",4,"ngIf"],[1,"splash-mock"],["mvImg","","id","splash-mock","src","images/splash/phone_mockup.png","alt","",1,"generic-mock"],[1,"animated-transits"],["mvImg","","alt","Transit icons",3,"src"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i._UZ(1,"img",1),i.TgZ(2,"h1",2),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"p",3),i._uU(6),i.ALo(7,"translate"),i.qZA(),i._UZ(8,"p",4),i.ALo(9,"safeHtml"),i.ALo(10,"translate"),i.TgZ(11,"mv-app-links-wrapper",5),i.NdJ("bannerClick",function(){return t.onBannerClick()})("bannerDismiss",function(){return t.onDismissClick()}),i.qZA(),i.qZA(),i.YNc(12,c,2,1,"div",6),i.TgZ(13,"div",7),i._UZ(14,"img",8),i.qZA()),2&e&&(i.xp6(3),i.Oqu(i.lcZ(4,5,"store_popular_app")),i.xp6(3),i.Oqu(i.lcZ(7,7,"local_mobility_options_test")),i.xp6(2),i.Q6J("innerHTML",i.lcZ(9,9,i.lcZ(10,11,"web_mot_splash_direct2")),i.oJD),i.xp6(3),i.Q6J("bannerUrl",t.bannerUrl),i.xp6(1),i.Q6J("ngIf",t.animatedTransitsTestUrl))},directives:[r.X,o.c,a.O5],pipes:[s.X$,l.z],encapsulation:2}),e})()},67683:function(e,t,n){"use strict";n.d(t,{z:function(){return S}});var i=n(3786),r=n(2316),o=n(54364),a=n(51063),s=n(95505),l=n(5971),c=n(12646),d=n(46461),u=n(15041),p=n(56329),h=n(2339),m=n(79223),g=n(86607);const f=function(e){return{LINE:e}},v=function(e){return{COUNTRY:e}};function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",7),r._UZ(1,"img",8),r._UZ(2,"h1",9),r.ALo(3,"correctLineName"),r.ALo(4,"translate"),r.TgZ(5,"p"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r._UZ(8,"p",10),r.ALo(9,"translate"),r.TgZ(10,"mv-app-links-wrapper",11),r.NdJ("bannerClick",function(){return r.CHM(e),r.oxw().onBannerClick()})("bannerDismiss",function(){return r.CHM(e),r.oxw().onDismissClick()}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("innerHTML",r.lcZ(3,6,r.xi3(4,8,e.lineSplashTitleKey,r.VKq(16,f,e.lineName))),r.oJD),r.xp6(4),r.Oqu(r.lcZ(7,11,"web_download_intro")),r.xp6(2),r.ekj("transparent",!e.country),r.Q6J("innerHTML",r.xi3(9,13,"store_best_app_in_country",r.VKq(18,v,e.country)),r.oJD),r.xp6(2),r.Q6J("bannerUrl",e.bannerUrl)}}function b(e,t){if(1&e&&(r.TgZ(0,"div",12),r._UZ(1,"img",13),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("src",e.animatedTransitsTestUrl,r.LSH)}}function _(e,t){if(1&e&&(r.TgZ(0,"div",14),r._UZ(1,"h2",15),r.ALo(2,"safeHtml"),r.ALo(3,"async"),r.ALo(4,"asyncify"),r.TgZ(5,"h3",16),r._uU(6),r.qZA(),r.TgZ(7,"p",17),r._uU(8),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("innerHTML",r.lcZ(2,3,r.lcZ(3,5,r.lcZ(4,7,null==e.lineGroup?null:e.lineGroup.imageHtml))),r.oJD),r.xp6(5),r.Oqu(null==e.lineGroup?null:e.lineGroup.lineNumber),r.xp6(2),r.Oqu(null==e.lineGroup?null:e.lineGroup.agencyName)}}function T(e,t){if(1&e&&(r.TgZ(0,"div",18),r._UZ(1,"span",15),r.ALo(2,"safeHtml"),r.ALo(3,"async"),r.ALo(4,"asyncify"),r.TgZ(5,"span",17),r._uU(6),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("innerHTML",r.lcZ(2,2,r.lcZ(3,4,r.lcZ(4,6,null==e.lineGroup?null:e.lineGroup.imageHtml))),r.oJD),r.xp6(5),r.Oqu(null==e.lineGroup?null:e.lineGroup.agencyName)}}let S=(()=>{class e{constructor(e,t,n,i){this.routingService=e,this.store=t,this.universalPreload=n,this.document=i,this.animatedTransitsTestUrl=null,this.bannerClick=new r.vpe,this.bannerDismiss=new r.vpe,this.lineSplashTitleKey="splash_text_test_lines_easier"}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){yield this.universalPreload.init()})}ngAfterViewInit(){this.lineSplashTitleKey=this.setSplashTitle()}get state(){return this.store.getState()}get lineGroup(){return this.universalPreload.lineGroup}get country(){var e;return null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.countryName}get isAddingBestAppTest(){return!!(0,a.L)("Splash-Adding-BestApp",this.document)}get lineName(){if(this.lineGroup&&this.lineGroup.lineNumber)return this.lineGroup.lineNumber;const e=this.routingService.getStateFromUrl();return e.lineName?e.lineName:""}get splashMockImage(){return"images/splash/"+(this.lineGroup?"splash-screen-lines.png":"phone_mockup.png")}onBannerClick(){this.bannerClick.emit()}onDismissClick(){this.bannerDismiss.emit()}setSplashTitle(){if((0,a.L)("data-different-text-structure",this.document))return"splash_text_lines_easier_wrap_line_name";{const e=(0,a.L)("data-different-text-plan",this.document);if(!e)return"splash_text_test_lines_easier";if("V1"===e.variant)return"web_banner_line_v1";if("V2"===e.variant)return"web_banner_line_v2"}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.Z),r.Y36(l.d),r.Y36(c.k),r.Y36(o.K0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-splash-lines"]],inputs:{bannerUrl:"bannerUrl",splashType:"splashType",animatedTransitsTestUrl:"animatedTransitsTestUrl"},outputs:{bannerClick:"bannerClick",bannerDismiss:"bannerDismiss"},decls:7,vars:5,consts:[["class","splash-title-wrapper",4,"ngIf"],["class","animated-transits",4,"ngIf"],[1,"splash-mock"],["mvImg","","id","splash-mock","alt","",1,"lines-mock",3,"src"],["class","lines-content",4,"ngIf"],[1,"phone-mock"],["class","phone-mock-title",4,"ngIf"],[1,"splash-title-wrapper"],["mvImg","","src","images/moovit_logo_full-white.svg","alt","moovit logo",1,"logo"],[1,"splash-title",3,"innerHTML"],[1,"bast-app-subtitle",3,"innerHTML"],[3,"bannerUrl","bannerClick","bannerDismiss"],[1,"animated-transits"],["mvImg","","alt","Transit icons",3,"src"],[1,"lines-content"],["role","presentation",1,"line-image",3,"innerHTML"],[1,"line-title"],["role","heading","aria-level","3",1,"line-subtitle"],[1,"phone-mock-title"]],template:function(e,t){1&e&&(r.YNc(0,y,11,20,"div",0),r.YNc(1,b,2,1,"div",1),r.TgZ(2,"div",2),r._UZ(3,"img",3),r.YNc(4,_,9,9,"div",4),r.qZA(),r.TgZ(5,"div",5),r.YNc(6,T,7,8,"div",6),r.qZA()),2&e&&(r.Q6J("ngIf",t.lineName),r.xp6(1),r.Q6J("ngIf",t.animatedTransitsTestUrl),r.xp6(2),r.Q6J("src",t.splashMockImage,r.LSH),r.xp6(1),r.Q6J("ngIf",t.lineGroup),r.xp6(2),r.Q6J("ngIf",t.lineGroup))},directives:[o.O5,d.X,u.c],pipes:[p.a,h.X$,m.z,o.Ov,g.N],encapsulation:2}),e})()},54509:function(e,t,n){"use strict";n.d(t,{s:function(){return g}});var i=n(2316),r=n(51063),o=n(54364),a=n(95505),s=n(5971),l=n(46461),c=n(15041),d=n(2339);const u=function(e){return{POI:e}},p=function(e){return{COUNTRY:e}};function h(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",15),i._UZ(1,"img",16),i._UZ(2,"h1",17),i.ALo(3,"translate"),i.TgZ(4,"p"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i._UZ(7,"p",18),i.ALo(8,"translate"),i.TgZ(9,"mv-app-links-wrapper",19),i.NdJ("bannerClick",function(){return i.CHM(e),i.oxw().onBannerClick()})("bannerDismiss",function(){return i.CHM(e),i.oxw().onDismissClick()}),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.xp6(2),i.Q6J("innerHTML",i.xi3(3,6,e.poiSplashTitleKey,i.VKq(14,u,e.toLocation)),i.oJD),i.xp6(3),i.Oqu(i.lcZ(6,9,"web_download_intro")),i.xp6(2),i.ekj("transparent",!e.country),i.Q6J("innerHTML",i.xi3(8,11,"store_best_app_in_country",i.VKq(16,p,e.country)),i.oJD),i.xp6(2),i.Q6J("bannerUrl",e.bannerUrl)}}function m(e,t){if(1&e&&(i.TgZ(0,"div",20),i._UZ(1,"img",21),i.qZA()),2&e){const e=i.oxw();i.xp6(1),i.Q6J("src",e.animatedTransitsTestUrl,i.LSH)}}let g=(()=>{class e{constructor(e,t,n){this.routingService=e,this.store=t,this.document=n,this.animatedTransitsTestUrl=null,this.bannerClick=new i.vpe,this.bannerDismiss=new i.vpe}ngAfterViewInit(){this.poiSplashTitleKey=this.setSplashTitle()}get state(){return this.store.getState()}get toLocation(){return this.routingService.getStateFromUrl().to}get country(){var e;return null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.countryName}get isAddingBestAppTest(){return!!(0,r.L)("Splash-Adding-BestApp",this.document)}onBannerClick(){this.bannerClick.emit()}onDismissClick(){this.bannerDismiss.emit()}setSplashTitle(){if((0,r.L)("data-different-text-structure",this.document))return"splash_text_poi_easier_wrap_poi_name";{const e=(0,r.L)("data-different-text-plan",this.document);if(!e)return"splash_text_test_poi_easier";if("V1"===e.variant)return"web_banner_poi_v1";if("V2"===e.variant)return"web_banner_poi_v2"}}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(a.Z),i.Y36(s.d),i.Y36(o.K0))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-splash-trip-plan"]],inputs:{bannerUrl:"bannerUrl",splashType:"splashType",animatedTransitsTestUrl:"animatedTransitsTestUrl"},outputs:{bannerClick:"bannerClick",bannerDismiss:"bannerDismiss"},decls:29,vars:23,consts:[["class","splash-title-wrapper",4,"ngIf"],["class","animated-transits",4,"ngIf"],[1,"splash-mock"],["mvImg","","id","splash-mock","src","images/splash/splash-screen.png","alt","",1,"trip-mock"],["role","heading","aria-level","3",1,"fields-title"],["role","heading","aria-level","4",1,"from-fields"],["id","position_start"],["id","from_field",1,"from"],["role","heading","aria-level","4",1,"to-fields"],["id","position_end"],["id","to_field",1,"to"],["role","presentation",1,"location-bubble"],[1,"location-title"],[1,"phone-mock"],[1,"phone-mock-title"],[1,"splash-title-wrapper"],["mvImg","","src","images/moovit_logo_full-white.svg","alt","moovit logo",1,"logo"],[1,"splash-title",3,"innerHTML"],[1,"bast-app-subtitle",3,"innerHTML"],[3,"bannerUrl","bannerClick","bannerDismiss"],[1,"animated-transits"],["mvImg","","alt","Transit icons",3,"src"]],template:function(e,t){1&e&&(i.YNc(0,h,10,18,"div",0),i.YNc(1,m,2,1,"div",1),i.TgZ(2,"div",2),i._UZ(3,"img",3),i.TgZ(4,"span",4),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"div",5),i.ALo(8,"translate"),i.TgZ(9,"label",6),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"span",7),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.qZA(),i.TgZ(15,"div",8),i.ALo(16,"translate"),i.TgZ(17,"label",9),i._uU(18),i.ALo(19,"translate"),i.qZA(),i.TgZ(20,"span",10),i._uU(21),i.qZA(),i.qZA(),i.TgZ(22,"div",11),i.TgZ(23,"span",12),i._uU(24),i.qZA(),i.qZA(),i.qZA(),i.TgZ(25,"div",13),i.TgZ(26,"div",14),i.TgZ(27,"span"),i._uU(28),i.qZA(),i.qZA(),i.qZA()),2&e&&(i.Q6J("ngIf",t.toLocation),i.xp6(1),i.Q6J("ngIf",t.animatedTransitsTestUrl),i.xp6(4),i.Oqu(i.lcZ(6,11,"step")),i.xp6(2),i.uIk("aria-labelledby",i.lcZ(8,13,"choose_map_from_here")),i.xp6(3),i.Oqu(i.lcZ(11,15,"position_start")),i.xp6(3),i.Oqu(i.lcZ(14,17,"current_location")),i.xp6(2),i.uIk("aria-labelledby",i.lcZ(16,19,"choose_map_to_here")),i.xp6(3),i.Oqu(i.lcZ(19,21,"position_end")),i.xp6(3),i.Oqu(t.toLocation),i.xp6(3),i.Oqu(t.toLocation),i.xp6(4),i.Oqu(t.toLocation))},directives:[o.O5,l.X,c.c],pipes:[d.X$],encapsulation:2}),e})()},87732:function(e,t,n){"use strict";n.d(t,{r:function(){return C}});var i=n(52959),r=n(25837),o=n(99528),a=n(16438),s=n(51063),l=n(54364),c=n(2316),d=n(95505),u=n(1210),p=n(1437),h=n(61787),m=n(7935),g=n(1238),f=n(5971),v=n(5306),y=n(87479),b=n(93975),_=n(46461),T=n(15041),S=n(11098),x=n(43087),w=n(54509),k=n(67683),M=n(2339),L=n(79223);function A(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"mv-splash-generic",25),c.NdJ("bannerClick",function(){return c.CHM(e),c.oxw().onBannerClick()})("bannerDismiss",function(){return c.CHM(e),c.oxw().onDismissClick()}),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("bannerUrl",e.bannerUrl)("splashType",e.splashType)("animatedTransitsTestUrl",e.transportIconsTestUrl)}}function I(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"mv-splash-trip-plan",25),c.NdJ("bannerClick",function(){return c.CHM(e),c.oxw().onBannerClick()})("bannerDismiss",function(){return c.CHM(e),c.oxw().onDismissClick()}),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("bannerUrl",e.bannerUrl)("splashType",e.splashType)("animatedTransitsTestUrl",e.transportIconsTestUrl)}}function E(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"mv-splash-lines",25),c.NdJ("bannerClick",function(){return c.CHM(e),c.oxw().onBannerClick()})("bannerDismiss",function(){return c.CHM(e),c.oxw().onDismissClick()}),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("bannerUrl",e.bannerUrl)("splashType",e.splashType)("animatedTransitsTestUrl",e.transportIconsTestUrl)}}let C=(()=>{class e{constructor(e,t,n,i,r,a,s,l,c,d){this.routingService=e,this.deepLinkService=t,this.analyticsService=n,this.canonicalService=i,this.splashDisplay=r,this.globalActions=a,this.store=s,this.universal=l,this.document=c,this._cd=d,this.SplashType=o.wm}get state(){return this.store.getState()}get splashType(){return this.state.global.splashType}get animate(){return!this.universal.isUniversal||this.universal.isServer}ngOnInit(){this.universal.isBrowser&&(0,r.Oz)().then(()=>(0,r.Ko)(r.y5.MP_SPLASH)).catch(e=>(0,r.aJ)(r.y5.MP_SPLASH,e.message)),this.routingService.onNavigationEnd(e=>{this._cd.destroyed||this.updateBannerUrl()}),this.updateBannerUrl(),this.universal.isBrowser&&(0,i.p5)(this.store).then(()=>{this.updateBannerUrl(),(0,i.wZ)().then(()=>this.updateBannerUrl())})}get transportIconsTestUrl(){const e=(0,s.L)("data-splash-transport-icons",this.document);return!(!e||"V1"!=e.variant&&"V2"!=e.variant)&&`images/splash/all-transit-icons-${e.variant}.svg`}updateBannerUrl(){this.bannerUrl=this.deepLinkService.getStoreOrDeepLink("splash","splash",this.deepLinkService.getDeepLinkType());const e="moovit%3A%2F%2Fmot_registration";this.bannerMotUrl=this.bannerUrl.replace(/af_dp=[^?&]+/,`af_dp=${e}&deep_link_value=${e}&af_click_lookback=7&af_reengagement_window=7d`)}onBannerClick(){const e=(0,s.L)("data-splash-cta-text",this.document)||(0,s.L)("data-adding-x-sign",this.document)||(0,s.L)("data-Splash-Adding-BestApp",this.document)||(0,s.L)("data-different-cta-placement",this.document)||(0,s.L)("data-different-text-structure",this.document)||(0,s.L)("data-different-phone-image",this.document)||(0,s.L)("data-different-text-plan",this.document)||(0,s.L)("data-different-phone-animation",this.document)||(0,s.L)("data-continue-after-3-sec",this.document)||(0,s.L)("data-splash-transport-icons",this.document)||(0,s.L)("data-elements-loading-gradually",this.document);e&&(this.bannerUrl=this.deepLinkService.getAbTestUrl(e)),this.analyticsService.trackStoreClick("splash")}onDismissClick(e="splash_continue"){this.splashType===o.wm.Lines&&!this.state.line.selectedLine&&this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],a.zA.LINES_MAIN)),this.splashDisplay.invokeDismissal(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(d.Z),c.Y36(u.Qz),c.Y36(p.y),c.Y36(h.z),c.Y36(m.Y),c.Y36(g.l),c.Y36(f.d),c.Y36(v.p),c.Y36(l.K0),c.Y36(c.sBO))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-splash"]],decls:35,vars:20,consts:[[1,"close-button",3,"click"],["src","images/icons/close-bold.svg","mvAccessibleSVG","",1,"close-icon",3,"titleText"],[1,"splash-container"],[1,"mot-text"],[1,"mot-title","optimize",3,"innerHTML"],[3,"bannerUrl","splashType","animatedTransitsTestUrl","bannerClick","bannerDismiss",4,"ngIf"],[1,"illustration-wrapper","optimize"],["src","images/splash/mot_illustration.svg",1,"mot-illustration"],[1,"animated-phone-container"],[1,"phone-image"],["mvImg","","src","images/moovit_logo_full.svg","alt","moovit logo",1,"phone-logo"],[1,"transit-animation-wrapper"],["src","images/splash/splash-phone-animation.svg","mvAccessibleSVG","","titleText","Animation",1,"transit-animation"],[1,"bg"],[1,"splash-footer"],[1,"app-rating-wrapper"],[1,"app-icon-wrapper"],["mvImg","","src","images/brand-app-icon-i-os.svg","alt","app icon",1,"app-icon"],[1,"text"],[1,"name"],[1,"stars"],["mvImg","","src","images/splash/rating.png","alt","app rating"],[3,"bannerUrl","bannerClick","bannerDismiss"],[1,"optimize",3,"bannerMotUrl","bannerClick","bannerDismiss"],[3,"splashType","bannerUrl"],[3,"bannerUrl","splashType","animatedTransitsTestUrl","bannerClick","bannerDismiss"]],template:function(e,t){1&e&&(c.TgZ(0,"button",0),c.NdJ("click",function(){return t.onDismissClick()}),c.ALo(1,"translate"),c._UZ(2,"svg-icon",1),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",2),c.TgZ(5,"div",3),c._UZ(6,"h2",4),c.ALo(7,"safeHtml"),c.ALo(8,"translate"),c.YNc(9,A,1,3,"mv-splash-generic",5),c.YNc(10,I,1,3,"mv-splash-trip-plan",5),c.YNc(11,E,1,3,"mv-splash-lines",5),c._UZ(12,"div"),c.TgZ(13,"div",6),c._UZ(14,"svg-icon",7),c.qZA(),c.qZA(),c.TgZ(15,"div",8),c.TgZ(16,"div",9),c._UZ(17,"img",10),c.TgZ(18,"div",11),c._UZ(19,"svg-icon",12),c._UZ(20,"div",13),c.qZA(),c.qZA(),c.qZA(),c.TgZ(21,"div",14),c.TgZ(22,"div",15),c.TgZ(23,"div",16),c._UZ(24,"img",17),c.qZA(),c.TgZ(25,"div",18),c.TgZ(26,"div",19),c._uU(27,"Moovit"),c.qZA(),c.TgZ(28,"div",20),c._UZ(29,"img",21),c.TgZ(30,"span"),c._uU(31,"(934,930)"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(32,"mv-app-links-wrapper",22),c.NdJ("bannerClick",function(){return t.onBannerClick()})("bannerDismiss",function(){return t.onDismissClick()}),c.qZA(),c.TgZ(33,"mv-app-links-wrapper",23),c.NdJ("bannerClick",function(){return t.onBannerClick()})("bannerDismiss",function(){return t.onDismissClick()}),c.qZA(),c._UZ(34,"mv-localized-splash-content",24),c.qZA(),c.qZA()),2&e&&(c.uIk("aria-label",c.lcZ(1,12,"close")),c.xp6(2),c.s9C("titleText",c.lcZ(3,14,"action_close")),c.xp6(2),c.ekj("animate",t.animate),c.xp6(2),c.Q6J("innerHTML",c.lcZ(7,16,c.lcZ(8,18,"web_mot_splash_direct1")),c.oJD),c.xp6(3),c.Q6J("ngIf",t.splashType===t.SplashType.Generic),c.xp6(1),c.Q6J("ngIf",t.splashType===t.SplashType.TripPlan),c.xp6(1),c.Q6J("ngIf",t.splashType===t.SplashType.Lines),c.xp6(21),c.Q6J("bannerUrl",t.bannerUrl),c.xp6(1),c.Q6J("bannerMotUrl",t.bannerMotUrl),c.xp6(1),c.Q6J("splashType",t.splashType)("bannerUrl",t.bannerUrl))},directives:[y.bk,b.m,l.O5,_.X,T.c,S.j,x.u,w.s,k.z],pipes:[M.X$,L.z],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.splash-container{background:#001926}.splash-container .routes-group{display:none}.splash-container .animated-routes .optimize-icons-group{position:absolute;width:191px;height:181px;right:-12px;top:-2px}.splash-container .animated-routes .optimize-icons-group>span[class^=route-icon-]{top:0;width:24px;height:24px;position:absolute;left:0}.splash-container .animated-routes .optimize-icons-group>span[class^=route-icon-] img{width:100%;height:100%}.splash-container .splash-footer{overflow:hidden;border-top:3px solid #ff6400;padding:18px 20px 20px}html[dir=ltr] .splash-container .splash-footer{padding-right:50%}html[dir=rtl] .splash-container .splash-footer{padding-left:50%}@media only screen and (max-width: 320px){html[dir=ltr] .splash-container .splash-footer{padding-right:45%}html[dir=rtl] .splash-container .splash-footer{padding-left:45%}}.splash-container .splash-footer .animated-routes{display:block;height:181px;background-position:top right;background-image:url(/images/banners/routes-v-2.svg);background-size:212px 218px;width:193px}html[dir=ltr] .splash-container .splash-footer .animated-routes{right:-12px}html[dir=rtl] .splash-container .splash-footer .animated-routes{left:-12px}html[dir=rtl] .splash-container .splash-footer .animated-routes,html[dir=rtl] .splash-container .splash-footer .animated-routes span[class^=route-icon-] img{transform:scaleX(-1)}.splash-container .splash-footer .route-icon-1{transform:translate(44px,-28px);-webkit-animation:footer-route-1 5s cubic-bezier(.14,.01,.85,.99) infinite;animation:footer-route-1 5s cubic-bezier(.14,.01,.85,.99) infinite}.splash-container .splash-footer .route-icon-2{transform:translate(-60px,220px);-webkit-animation:footer-route-2 5s cubic-bezier(.14,.01,.85,.99) 2.5s infinite;animation:footer-route-2 5s cubic-bezier(.14,.01,.85,.99) 2.5s infinite}.splash-container .splash-footer .route-icon-3{transform:translate(170px,111px);-webkit-animation:footer-route-3 5s cubic-bezier(.14,.01,.85,.99) infinite;animation:footer-route-3 5s cubic-bezier(.14,.01,.85,.99) infinite}.splash-container .splash-footer .route-icon-4,.splash-container .splash-footer .route-icon-5{display:none}.splash-container .splash-footer .splash-btn{justify-content:flex-start;min-width:60%}.splash-container .splash-footer .app-rating-wrapper{white-space:nowrap}.splash-container .splash-footer mv-localized-splash-content{display:block}.splash-container .splash-footer mv-localized-splash-content .routes-group{z-index:-1}.splash-container .splash-footer mv-localized-splash-content .routes-group:last-of-type{left:0}.splash-container .splash-footer mv-localized-splash-content .routes-group>div[class^=route-]{bottom:unset;right:0}.splash-container .splash-footer mv-localized-splash-content .routes-group>div[class^=route-] .route-icon{right:0;-webkit-animation:unset;animation:unset}.splash-container .splash-footer .animated-routes{display:block;width:100%;height:calc(100% + 12px);position:absolute;top:-12px;z-index:-1;background-repeat:no-repeat}@-webkit-keyframes footer-route-1{0%{transform:translate(44px,-28px)}20%{transform:translate(44px,64px)}50%,70%{transform:translate(131px,161px)}70%,to{transform:translate(131px,215px)}}@keyframes footer-route-1{0%{transform:translate(44px,-28px)}20%{transform:translate(44px,64px)}50%,70%{transform:translate(131px,161px)}70%,to{transform:translate(131px,215px)}}@-webkit-keyframes footer-route-2{0%,20%{transform:translate(-60px,220px)}70%{transform:translate(119px,22px)}85%,to{transform:translate(176px,22px)}}@keyframes footer-route-2{0%,20%{transform:translate(-60px,220px)}70%{transform:translate(119px,22px)}85%,to{transform:translate(176px,22px)}}@-webkit-keyframes footer-route-3{0%,30%{transform:translate(170px,111px)}70%{transform:translate(58px,112px)}to{transform:translate(58px,215px)}}@keyframes footer-route-3{0%,30%{transform:translate(170px,111px)}70%{transform:translate(58px,112px)}to{transform:translate(58px,215px)}}svg-icon.mot-illustration #tranit_type_bus>g{transform:translate(0);-webkit-animation:bus-in 3s ease-out 0s forwards;animation:bus-in 3s ease-out 0s forwards}svg-icon.mot-illustration #transit_type_train>g{transform:translate(100px);-webkit-animation:train-in 2.3s ease-out .7s forwards;animation:train-in 2.3s ease-out .7s forwards}svg-icon.mot-illustration #tranit_type_shuttle>g{transform:translate(-85px);-webkit-animation:shuttle-in 2s ease-out 1s forwards;animation:shuttle-in 2s ease-out 1s forwards}svg-icon.mot-illustration #QR #qr-code{transform:scale(0);transform-origin:64px 64px;-webkit-animation:qr-in .7s ease-in-out .2s forwards;animation:qr-in .7s ease-in-out .2s forwards}svg-icon.mot-illustration #QR #qr-frame{transform:scale(0);-webkit-animation:qr-in .7s ease-in-out 0s forwards,qr-bounce 2s ease-in-out 2s forwards infinite;animation:qr-in .7s ease-in-out 0s forwards,qr-bounce 2s ease-in-out 2s forwards infinite;transform-origin:61px 64px}svg-icon.mot-illustration #CTA g{transform:scale(0);-webkit-animation:cta-in .7s ease-in-out .5s forwards,cta-bounce 3s ease-in-out 3.2s forwards infinite;animation:cta-in .7s ease-in-out .5s forwards,cta-bounce 3s ease-in-out 3.2s forwards infinite;transform-origin:42px 12px}@-webkit-keyframes bus-in{0%{transform:translate(0)}to{transform:translate(140px)}}@keyframes bus-in{0%{transform:translate(0)}to{transform:translate(140px)}}@-webkit-keyframes train-in{0%{transform:translate(100px)}to{transform:translate(0)}}@keyframes train-in{0%{transform:translate(100px)}to{transform:translate(0)}}@-webkit-keyframes shuttle-in{0%{transform:translate(-85px)}to{transform:translate(0)}}@keyframes shuttle-in{0%{transform:translate(-85px)}to{transform:translate(0)}}@-webkit-keyframes qr-in{0%{transform:scale(.4) rotate(25deg);opacity:0}40%{opacity:.25;transform:scale(.2) rotate(25deg)}70%{transform:scale(1.1)}90%{transform:scale(.95)}to{transform:scale(1);opacity:1}}@keyframes qr-in{0%{transform:scale(.4) rotate(25deg);opacity:0}40%{opacity:.25;transform:scale(.2) rotate(25deg)}70%{transform:scale(1.1)}90%{transform:scale(.95)}to{transform:scale(1);opacity:1}}@-webkit-keyframes qr-bounce{0%,to,40%{transform:scale(1)}10%{transform:scale(1.05)}20%{transform:scale(1)}30%{transform:scale(1.05)}}@keyframes qr-bounce{0%,to,40%{transform:scale(1)}10%{transform:scale(1.05)}20%{transform:scale(1)}30%{transform:scale(1.05)}}@-webkit-keyframes cta-in{0%{transform:scale(.2) rotate(-15deg);opacity:0}40%{opacity:.25;transform:scale(0) rotate(-15deg)}70%{transform:scale(1.2)}90%{transform:scale(.9)}to{transform:scale(1);opacity:1}}@keyframes cta-in{0%{transform:scale(.2) rotate(-15deg);opacity:0}40%{opacity:.25;transform:scale(0) rotate(-15deg)}70%{transform:scale(1.2)}90%{transform:scale(.9)}to{transform:scale(1);opacity:1}}@-webkit-keyframes cta-bounce{0%,to,40%{transform:scale(1) rotate(0)}10%{transform:scale(1.1)}20%{transform:scale(1)}30%{transform:scale(1.1)}}@keyframes cta-bounce{0%,to,40%{transform:scale(1) rotate(0)}10%{transform:scale(1.1)}20%{transform:scale(1)}30%{transform:scale(1.1)}}body:not([data-splash-mot=optimize]) .optimize{display:none}body[data-splash-mot=optimize] .app-container mv-splash .splash-container{background:#fafcfd}body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-splash-generic,body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-splash-trip-plan,body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-splash-lines{margin-top:0;height:auto}body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-app-links-wrapper:not(.optimize){display:none}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-title-wrapper{min-height:0}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-title-wrapper mv-app-links-wrapper{display:none}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .cta-text{display:none}body[data-splash-mot=optimize] .app-container mv-splash .splash-container #en-cta{display:block}html[lang=he] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #he-cta{display:block}html[lang=he] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #en-cta{display:none}html[lang=ar] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #ar-cta{display:block}html[lang=ar] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #en-cta{display:none}html[lang=ru] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #ru-cta{display:block}html[lang=ru] body[data-splash-mot=optimize] .app-container mv-splash .splash-container #en-cta{display:none}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-mock,body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-localized-splash-content,body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-subtitle,body[data-splash-mot=optimize] .app-container mv-splash .splash-container .app-rating-wrapper:not(.optimize),body[data-splash-mot=optimize] .app-container mv-splash .splash-container mv-app-links-wrapper>a:first-child,body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-title-wrapper .splash-title,body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-title-wrapper .splash-subtitle,body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-title-wrapper .logo{display:none!important}body[data-splash-mot=optimize] .app-container mv-splash .splash-container h2.mot-title{font-size:1.7647058824rem;line-height:1.2;margin:0;color:#292a30;font-weight:600}html[lang=ru] body[data-splash-mot=optimize] .app-container mv-splash .splash-container h2.mot-title{font-size:1.4705882353rem}@media only screen and (max-height: 600px){body[data-splash-mot=optimize] .app-container mv-splash .splash-container h2.mot-title{font-size:1.5882352941rem}html[lang=ru] body[data-splash-mot=optimize] .app-container mv-splash .splash-container h2.mot-title{font-size:1.3529411765rem}}body[data-splash-mot=optimize] .app-container mv-splash .splash-container h2.mot-title span{content:url(/images/moovit_logo_full.svg);display:inline-block;width:6.7647058824rem}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text{display:flex;flex-direction:column;text-align:center;color:#292a30;padding:11vh 20px 8vh;height:calc(100% - 142px);box-sizing:border-box;background:url(/images/splash/mot_mobile_background.svg) no-repeat center/cover}@media only screen and (max-height: 600px){body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text{padding:3vh 20px}}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text p{color:#292a30;font-size:1.1176470588rem;margin:2vh 0}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text .illustration-wrapper{flex-grow:1;display:flex;align-items:center}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text .illustration-wrapper .mot-illustration{display:block;width:100%;height:auto}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text .illustration-wrapper .mot-illustration svg{width:100%;height:auto;transform:translate(-11.7vw)}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text .moovit-logo{width:130px;margin:10px auto 0}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-text>*{display:block}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links{display:flex;justify-content:space-between;align-items:center;padding:20px;border-radius:5px;box-shadow:0 0 7px #0000002e}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper{display:inline-flex;align-items:center;flex-shrink:1}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper .app-icon{border-radius:5px}html[dir=ltr] body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper .app-icon{margin-right:8px}html[dir=rtl] body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper .app-icon{margin-left:8px}html[dir=ltr] body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper .app-icon{margin-left:0}html[dir=rtl] body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .app-rating-wrapper .app-icon{margin-right:0}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .use-app-button{margin:0;width:auto;padding:10px 25px;background-color:#f0500c;flex-shrink:0;max-width:50%}@media only screen and (max-width: 360px){html[lang=ru] body[data-splash-mot=optimize] .app-container mv-splash .splash-container .mot-links .use-app-button{padding:8px}}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-footer{padding:20px 20px 13px;box-shadow:0 -1px 7px #0000002e}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-footer .text .name{line-height:1}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-footer .text .stars{padding-top:0;line-height:1.2}body[data-splash-mot=optimize] .app-container mv-splash .splash-container .splash-footer .splash-btn{margin-top:15px}mv-splash .close-button{display:none}body[data-adding-x-sign^=V] mv-splash .close-button{display:block;visibility:hidden;position:absolute;z-index:1}html[dir=ltr] body[data-adding-x-sign^=V] mv-splash .close-button{right:0}html[dir=rtl] body[data-adding-x-sign^=V] mv-splash .close-button{left:0}body[data-adding-x-sign^=V] mv-splash .close-button:hover{outline:none}body[data-adding-x-sign^=V] mv-splash .close-button .close-icon{width:1rem;height:1rem;padding:17px}body[data-adding-x-sign^=V] mv-splash .close-button .close-icon svg rect{fill:#fff}body[data-adding-x-sign^=V] mv-splash .splash-container div.splash-mock{bottom:146px}body[data-adding-x-sign^=V] mv-splash .splash-container div.splash-footer{padding-bottom:30px}body[data-adding-x-sign^=V] mv-splash .splash-container div.splash-footer mv-app-links-wrapper .splash-btn-site{display:none}body[data-adding-x-sign=V1] mv-splash .close-button{visibility:visible}body[data-adding-x-sign=V2] mv-splash .close-button{-webkit-animation:.35s fade-in 2s forwards ease-out;animation:.35s fade-in 2s forwards ease-out}body:not([data-Splash-Adding-BestApp^=V]) .bast-app-subtitle{display:none}body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-trip-plan,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-lines,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-generic{height:auto}body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-lines .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-generic .bast-app-subtitle{font-size:4.6vw;font-weight:bold;line-height:1.4;margin-top:4.8vh}@media only screen and (max-height: 700px){body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-lines .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-generic .bast-app-subtitle{font-size:4.2vw}}body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle.transparent,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-lines .bast-app-subtitle.transparent,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-generic .bast-app-subtitle.transparent{opacity:0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-lines .bast-app-subtitle,body[data-Splash-Adding-BestApp^=V] mv-splash .splash-container mv-splash-generic .bast-app-subtitle{font-size:1.4705882353rem}}body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-trip-plan,body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-lines,body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-generic{margin-top:24px}body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle span,body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-lines .bast-app-subtitle span,body[data-Splash-Adding-BestApp=V1] mv-splash .splash-container mv-splash-generic .bast-app-subtitle span{color:#f0500c}body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-trip-plan,body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-lines,body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-generic{margin-top:15px}body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-trip-plan .bast-app-subtitle,body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-lines .bast-app-subtitle,body[data-Splash-Adding-BestApp=V2] mv-splash .splash-container mv-splash-generic .bast-app-subtitle{background-color:#1a303c;padding:13px;border-radius:11px}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer{display:flex;padding-top:38px;padding-bottom:95px;justify-content:space-between}html[dir=ltr] body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer{padding-right:20px}html[dir=rtl] body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer{padding-left:20px}@media only screen and (max-width: 360px){body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer{padding-bottom:80px}}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer mv-app-links-wrapper{width:50%}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer mv-app-links-wrapper .splash-btn-site{position:absolute;width:auto;text-align:left;justify-content:flex-start;padding:0 20px;margin-top:35px}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer mv-app-links-wrapper .use-app-button{margin-top:0}html[dir=ltr] body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer .app-rating-wrapper{margin-right:15px}html[dir=rtl] body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer .app-rating-wrapper{margin-left:15px}@media only screen and (max-width: 360px){body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer .app-rating-wrapper{min-width:unset}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer .app-rating-wrapper .app-icon{height:50px;width:50px}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer .app-rating-wrapper .text .stars img{display:block;margin-bottom:3px}}body[data-different-cta-placement^=V] mv-splash .splash-container .splash-footer mv-localized-splash-content{position:absolute;top:0;right:0;width:100%;height:100%;z-index:-1}html[dir=ltr] body[data-different-cta-placement=V1] mv-splash .splash-container .splash-footer mv-app-links-wrapper .splash-btn-site{left:0}html[dir=rtl] body[data-different-cta-placement=V1] mv-splash .splash-container .splash-footer mv-app-links-wrapper .splash-btn-site{right:0}html[dir=ltr] body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer mv-app-links-wrapper .splash-btn-site{right:0;text-align:right;justify-content:flex-end}html[dir=rtl] body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer mv-app-links-wrapper .splash-btn-site{left:0;text-align:left;justify-content:flex-end}body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .animated-routes{background-image:url(/images/splash/routes-v-2.svg);background-size:539px 477px;background-position:-40px -145px;width:414px;height:200px}html[dir=ltr] body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .animated-routes{right:0}html[dir=rtl] body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .animated-routes{left:0}body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .route-icon-1{transform:translate(185px,76px);-webkit-animation:icon-route-horizontal-1 5s cubic-bezier(.14,.01,.85,.99) infinite;animation:icon-route-horizontal-1 5s cubic-bezier(.14,.01,.85,.99) infinite}@-webkit-keyframes icon-route-horizontal-1{0%{transform:translate(185px,76px)}60%{transform:translate(-24px,76px)}to{transform:translate(-138px,187px)}}@keyframes icon-route-horizontal-1{0%{transform:translate(185px,76px)}60%{transform:translate(-24px,76px)}to{transform:translate(-138px,187px)}}body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .route-icon-2{transform:translate(-265px,73px);-webkit-animation:icon-route-horizontal-2 3.75s cubic-bezier(.14,.01,.85,.99) infinite;animation:icon-route-horizontal-2 3.75s cubic-bezier(.14,.01,.85,.99) infinite}@-webkit-keyframes icon-route-horizontal-2{0%,25%{transform:translate(-265px,73px)}50%{transform:translate(-214px,73px)}to{transform:translate(-104px,180px)}}@keyframes icon-route-horizontal-2{0%,25%{transform:translate(-265px,73px)}50%{transform:translate(-214px,73px)}to{transform:translate(-104px,180px)}}body[data-different-cta-placement=V2] mv-splash .splash-container .splash-footer .route-icon-3{transform:translate(-265px,73px);-webkit-animation:icon-route-horizontal-3 5s cubic-bezier(.14,.01,.85,.99) 1.25s infinite;animation:icon-route-horizontal-3 5s cubic-bezier(.14,.01,.85,.99) 1.25s infinite}@-webkit-keyframes icon-route-horizontal-3{0%{transform:translate(146px,172px)}33%{transform:translate(96px,116px)}to{transform:translate(-262px,116px)}}@keyframes icon-route-horizontal-3{0%{transform:translate(146px,172px)}33%{transform:translate(96px,116px)}to{transform:translate(-262px,116px)}}body[data-different-text-structure=optimize] .app-container mv-splash .splash-container .splash-title{color:#f0500c}body[data-different-text-structure=optimize] .app-container mv-splash .splash-container .splash-title>div{color:#fff}.phone-mock{display:none}body[data-different-phone-image=optimize] mv-splash .splash-container .mot-text{height:100%}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan,body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines{margin-bottom:62px;display:flex;flex-direction:column;height:100%}@media only screen and (max-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan,body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines{margin-top:25px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .splash-title-wrapper{margin-bottom:62px}@media only screen and (max-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .splash-title-wrapper{margin-bottom:25px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .splash-mock,body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .splash-mock{display:none}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .phone-mock{background-image:url(/images/splash/splash-phone-poi@2x.png)}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .phone-mock .phone-mock-title{justify-content:center;background-color:#fff;top:196px}@media only screen and (max-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .phone-mock .phone-mock-title{top:146px}}@media only screen and (max-height: 500px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .phone-mock .phone-mock-title{top:76px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-trip-plan .phone-mock .phone-mock-title>span{-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;display:-webkit-box}@media only screen and (max-height: 500px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .splash-title-wrapper p{font-size:14px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock{background-image:url(/images/splash/splash-phone-line@2x.png)}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title{background-color:#73747d;color:#fff;top:167px;border:1px solid #BDC3C7}@media only screen and (max-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title{top:126px}}@media only screen and (max-height: 500px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title{top:46px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-subtitle{font-size:1rem;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;display:-webkit-box}html[dir=ltr] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-subtitle{text-align:left}html[dir=rtl] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-subtitle{text-align:right}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image{height:26px}@media only screen and (min-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper .boxed{transform:scale(1.3);transform-origin:left}}html[dir=ltr] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper .boxed{margin-right:10px}html[dir=rtl] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper .boxed{margin-left:10px}@media only screen and (min-height: 670px){html[dir=ltr] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper .boxed{margin-right:30px}html[dir=rtl] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper .boxed{margin-left:30px}}html[dir=ltr] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image{margin-right:15px}html[dir=rtl] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image{margin-left:15px}@media only screen and (min-height: 670px){html[dir=ltr] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image{margin-right:36px}html[dir=rtl] body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image{margin-left:36px}}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image .boxed{border-radius:4px;box-shadow:0 1px 2px #0006}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image .boxed:before{border:none}body[data-different-phone-image=optimize] mv-splash .splash-container mv-splash-lines .phone-mock .phone-mock-title .line-image .mvf-wrapper.has-transit.no-image .boxed .text{color:#2e3037!important}body[data-different-phone-image=optimize] mv-splash .splash-container .phone-mock{position:relative;flex-grow:1;background-repeat:no-repeat;background-position:top center;background-size:260px;width:300px;margin:0 auto;display:block}@media only screen and (max-height: 670px){body[data-different-phone-image=optimize] mv-splash .splash-container .phone-mock{width:270px;background-size:210px}}body[data-different-phone-image=optimize] mv-splash .splash-container .phone-mock .phone-mock-title{position:absolute;min-height:68px;display:flex;align-items:center;border-radius:10px;box-shadow:0 2px 8px #0003;font-size:.9411764706rem;padding:10px 18px;box-sizing:border-box;text-align:center;width:100%;font-weight:600;color:#292a30}.animated-phone-container{display:none}body[data-different-phone-animation=optimize] .splash-mock{display:none}body[data-different-phone-animation=optimize] mv-splash .splash-container{display:flex;flex-direction:column}body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-generic{margin-top:1em}body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-lines,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-trip-plan,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-generic{height:auto;margin:30px 0}@media only screen and (max-height: 670px){body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-lines,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-trip-plan,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-generic{margin:20px 0}}@media only screen and (max-height: 670px){body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-lines .splash-title-wrapper p,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper p,body[data-different-phone-animation=optimize] mv-splash .splash-container mv-splash-generic .splash-title-wrapper p{font-size:14px}}body[data-different-phone-animation=optimize] mv-splash .splash-container .mot-text{display:flex;flex-grow:.6}body[data-different-phone-animation=optimize] mv-splash .splash-container div.splash-footer{position:relative}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container{flex-grow:.4;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image{background:no-repeat url(/images/splash/splash-phone-plain.svg) top center/100%;height:100%;width:calc(100% - 120px);display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:13%;box-sizing:border-box}@media only screen and (max-height: 670px){body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image{width:calc(100% - 140px)}}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image .phone-logo{width:100px;text-align:center}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image .transit-animation-wrapper{display:flex;position:relative;top:-10px;width:100%;height:100%}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image .transit-animation-wrapper .transit-animation{width:25vh;max-width:80%;height:auto;position:relative;z-index:1}body[data-different-phone-animation=optimize] mv-splash .splash-container .animated-phone-container .phone-image .transit-animation-wrapper .bg{position:absolute;top:0;left:0;width:inherit;height:inherit;background:no-repeat url(/images/splash/Map.svg) center/76%;mask-image:radial-gradient(circle at 50% 50%,black 0%,rgba(0,0,0,0) 50%,white 1120px);-webkit-mask-image:radial-gradient(circle at 50% 50%,black 0%,rgba(0,0,0,0) 50%,white 1120px)}body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container .animated-transits{text-align:center}body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container .animated-transits svg-icon{width:300px;height:auto}body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-trip-plan,body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-lines,body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-generic{display:flex;flex-direction:column;height:auto}@media only screen and (max-height: 670px){body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-trip-plan,body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-lines,body[data-splash-transport-icons^=V] .app-container mv-splash .splash-container mv-splash-generic{margin-top:25px}}body[data-elements-loading-gradually=optimize] .splash-title-wrapper,body[data-elements-loading-gradually=optimize] .splash-mock,body[data-elements-loading-gradually=optimize] .splash-footer,body[data-elements-loading-gradually=optimize] .splash-footer mv-app-links-wrapper,body[data-elements-loading-gradually=optimize] .splash-footer .splash-btn-site{opacity:0}body[data-elements-loading-gradually=optimize] mv-splash-generic .splash-mock{width:233px}body[data-elements-loading-gradually=optimize] mv-splash-generic .splash-mock img{transform:translateY(240px)}@media only screen and (min-height: 800px){body[data-elements-loading-gradually=optimize] mv-splash-generic .splash-mock{width:323px}body[data-elements-loading-gradually=optimize] mv-splash-generic .splash-mock img{transform:translateY(310px)}}body[data-elements-loading-gradually=optimize] mv-splash-generic .splash-mock img{content:url(/images/splash/phone_mockup-full.png)}body[data-elements-loading-gradually=optimize] mv-splash-trip-plan .splash-mock,body[data-elements-loading-gradually=optimize] mv-splash-lines .splash-mock{width:225px;height:226px}@media only screen and (min-height: 800px){body[data-elements-loading-gradually=optimize] mv-splash-trip-plan .splash-mock,body[data-elements-loading-gradually=optimize] mv-splash-lines .splash-mock{width:330px;height:336px}}body[data-elements-loading-gradually=optimize] mv-splash-trip-plan .splash-mock>img{content:url(/images/splash/splash-screen-full.png)}body[data-elements-loading-gradually=optimize] mv-splash-lines .splash-mock>img{content:url(/images/splash/splash-screen-lines-full.png)}body[data-elements-loading-gradually=optimize] .splash-mock{-webkit-animation:fade-in .5s .5s ease-in-out forwards;animation:fade-in .5s .5s ease-in-out forwards}body[data-elements-loading-gradually=optimize] .splash-title-wrapper{-webkit-animation:fade-in .5s 1s ease-in-out forwards;animation:fade-in .5s 1s ease-in-out forwards}body[data-elements-loading-gradually=optimize] .splash-footer{-webkit-animation:fade-in .5s 1.5s ease-in-out forwards;animation:fade-in .5s 1.5s ease-in-out forwards}body[data-elements-loading-gradually=optimize] .splash-footer mv-app-links-wrapper{-webkit-animation:fade-in .5s 2s ease-in-out forwards;animation:fade-in .5s 2s ease-in-out forwards}body[data-elements-loading-gradually=optimize] .splash-footer .splash-btn-site{-webkit-animation:fade-in .5s 3.5s ease-in-out forwards;animation:fade-in .5s 3.5s ease-in-out forwards}@-webkit-keyframes slide-up{0%{transform:translate(-50%,30px)}to{transform:translate(-50%)}}@keyframes slide-up{0%{transform:translate(-50%,30px)}to{transform:translate(-50%)}}mv-splash{height:100%;display:block}mv-splash .splash-container{height:100%;position:absolute;width:100%;background-color:#001926}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container{display:flex;flex-direction:column;justify-content:center}}mv-splash .splash-container.animate .transportation_animation{-webkit-animation:fade-in 1s .6s forwards;-webkit-animation-fill-mode:both;animation:fade-in 1s .6s forwards;animation-fill-mode:both}mv-splash .splash-container.animate .transportation_animation .transportation_icons{display:none}mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{height:115px;display:flex;align-items:center;justify-content:center;margin-top:50px;color:#fff;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{height:100%;margin-top:0}html[dir=ltr] mv-splash .splash-container mv-splash-trip-plan,html[dir=ltr] mv-splash .splash-container mv-splash-lines,html[dir=ltr] mv-splash .splash-container mv-splash-generic{margin-left:38%}html[dir=rtl] mv-splash .splash-container mv-splash-trip-plan,html[dir=rtl] mv-splash .splash-container mv-splash-lines,html[dir=rtl] mv-splash .splash-container mv-splash-generic{margin-right:38%}}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,mv-splash .splash-container mv-splash-lines .splash-title-wrapper,mv-splash .splash-container mv-splash-generic .splash-title-wrapper{width:100%;min-height:52px;padding:0 30px;box-sizing:border-box}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,mv-splash .splash-container mv-splash-lines .splash-title-wrapper,mv-splash .splash-container mv-splash-generic .splash-title-wrapper{padding-bottom:73px}html[dir=ltr] mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,html[dir=ltr] mv-splash .splash-container mv-splash-lines .splash-title-wrapper,html[dir=ltr] mv-splash .splash-container mv-splash-generic .splash-title-wrapper{text-align:left}html[dir=rtl] mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper,html[dir=rtl] mv-splash .splash-container mv-splash-lines .splash-title-wrapper,html[dir=rtl] mv-splash .splash-container mv-splash-generic .splash-title-wrapper{text-align:right}}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title{box-sizing:border-box;font-size:5.8vw;font-weight:300;line-height:1.2;margin-top:2vh;width:100%;position:relative;z-index:2}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title{font-size:1.4705882353rem}}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title span,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title span,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title span{color:#f0500c}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-subtitle{font-size:3.4vw;line-height:1.2;margin-top:3.8vw;z-index:2;position:relative}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-subtitle{font-size:.8823529412rem}}@media only screen and (min-width: 393px) and (min-height: 658px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:62px}}@media only screen and (max-height: 605px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:20vh}}@media only screen and (max-height: 605px){mv-splash .splash-container mv-splash-trip-plan .splash-mock,mv-splash .splash-container mv-splash-lines .splash-mock,mv-splash .splash-container mv-splash-generic .splash-mock{bottom:138px}}@media only screen and (max-height: 560px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:35px}}@media only screen and (max-height: 560px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:20vh}}@media only screen and (max-height: 520px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:15px}}@media only screen and (max-height: 520px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:20vh}}@media only screen and (max-height: 520px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title{margin-top:9px}}@media only screen and (max-height: 520px){mv-splash .splash-container mv-splash-trip-plan .splash-mock,mv-splash .splash-container mv-splash-lines .splash-mock,mv-splash .splash-container mv-splash-generic .splash-mock{bottom:133px}}@media only screen and (max-height: 520px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan .splash-mock .line-image,mv-splash .splash-container mv-splash-trip-plan .splash-mock .line-title,mv-splash .splash-container mv-splash-lines .splash-mock .line-image,mv-splash .splash-container mv-splash-lines .splash-mock .line-title,mv-splash .splash-container mv-splash-generic .splash-mock .line-image,mv-splash .splash-container mv-splash-generic .splash-mock .line-title{line-height:1}mv-splash .splash-container mv-splash-trip-plan .splash-mock .fields-title,mv-splash .splash-container mv-splash-lines .splash-mock .fields-title,mv-splash .splash-container mv-splash-generic .splash-mock .fields-title{font-size:.7em}mv-splash .splash-container mv-splash-trip-plan .splash-mock .from-fields,mv-splash .splash-container mv-splash-trip-plan .splash-mock .to-fields,mv-splash .splash-container mv-splash-lines .splash-mock .from-fields,mv-splash .splash-container mv-splash-lines .splash-mock .to-fields,mv-splash .splash-container mv-splash-generic .splash-mock .from-fields,mv-splash .splash-container mv-splash-generic .splash-mock .to-fields{width:57%}html[dir=ltr] mv-splash .splash-container mv-splash-trip-plan .splash-mock .from-fields,html[dir=ltr] mv-splash .splash-container mv-splash-trip-plan .splash-mock .to-fields,html[dir=ltr] mv-splash .splash-container mv-splash-lines .splash-mock .from-fields,html[dir=ltr] mv-splash .splash-container mv-splash-lines .splash-mock .to-fields,html[dir=ltr] mv-splash .splash-container mv-splash-generic .splash-mock .from-fields,html[dir=ltr] mv-splash .splash-container mv-splash-generic .splash-mock .to-fields{left:23%}html[dir=rtl] mv-splash .splash-container mv-splash-trip-plan .splash-mock .from-fields,html[dir=rtl] mv-splash .splash-container mv-splash-trip-plan .splash-mock .to-fields,html[dir=rtl] mv-splash .splash-container mv-splash-lines .splash-mock .from-fields,html[dir=rtl] mv-splash .splash-container mv-splash-lines .splash-mock .to-fields,html[dir=rtl] mv-splash .splash-container mv-splash-generic .splash-mock .from-fields,html[dir=rtl] mv-splash .splash-container mv-splash-generic .splash-mock .to-fields{right:23%}mv-splash .splash-container mv-splash-trip-plan .splash-mock .from-fields label,mv-splash .splash-container mv-splash-trip-plan .splash-mock .to-fields label,mv-splash .splash-container mv-splash-lines .splash-mock .from-fields label,mv-splash .splash-container mv-splash-lines .splash-mock .to-fields label,mv-splash .splash-container mv-splash-generic .splash-mock .from-fields label,mv-splash .splash-container mv-splash-generic .splash-mock .to-fields label{font-size:.7em}mv-splash .splash-container mv-splash-trip-plan .splash-mock .from-fields span,mv-splash .splash-container mv-splash-trip-plan .splash-mock .to-fields span,mv-splash .splash-container mv-splash-lines .splash-mock .from-fields span,mv-splash .splash-container mv-splash-lines .splash-mock .to-fields span,mv-splash .splash-container mv-splash-generic .splash-mock .from-fields span,mv-splash .splash-container mv-splash-generic .splash-mock .to-fields span{font-size:.9em;line-height:1em}mv-splash .splash-container mv-splash-trip-plan .splash-mock .location-title,mv-splash .splash-container mv-splash-lines .splash-mock .location-title,mv-splash .splash-container mv-splash-generic .splash-mock .location-title{font-size:1em}mv-splash .splash-container mv-splash-trip-plan .splash-mock .location-bubble,mv-splash .splash-container mv-splash-lines .splash-mock .location-bubble,mv-splash .splash-container mv-splash-generic .splash-mock .location-bubble{padding:.8em .7em}}@media only screen and (max-height: 460px){mv-splash .splash-container mv-splash-trip-plan,mv-splash .splash-container mv-splash-lines,mv-splash .splash-container mv-splash-generic{margin-top:5px}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .logo,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .logo,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .logo{margin-top:5px}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title{margin-top:0;font-size:.9411764706rem}}@media only screen and (max-height: 460px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-title,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-title{font-size:1.2352941176rem}}@media only screen and (max-height: 460px){mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-lines .splash-title-wrapper .splash-subtitle,mv-splash .splash-container mv-splash-generic .splash-title-wrapper .splash-subtitle{margin-top:6px}}mv-splash .splash-container mv-splash-generic .splash-subtitle>p{display:none}mv-splash .splash-container mv-splash-trip-plan .splash-title-wrapper>.logo,mv-splash .splash-container mv-splash-lines .splash-title-wrapper>.logo{display:none}mv-splash .splash-container .logo{margin-top:6.5vw;width:19vw;min-width:101px;position:relative;z-index:2}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .logo{width:92px}}@media only screen and (min-height: 800px){mv-splash .splash-container .logo{width:40%}}mv-splash .splash-container .logo+.splash-title{margin:.5vw auto 0}@media only screen and (min-height: 800px){mv-splash .splash-container .logo+.splash-title{font-size:1.8235294118rem;margin-top:20px}}mv-splash .splash-container .logo~.splash-subtitle{margin-top:1vw}@media only screen and (min-height: 800px){mv-splash .splash-container .logo~.splash-subtitle{font-size:1.1764705882rem;margin-top:50px}}mv-splash .splash-container .splash-footer{background:#fff;box-sizing:border-box;padding:20px;width:100%;z-index:2;position:absolute;bottom:0}@media only screen and (max-height: 580px){mv-splash .splash-container .splash-footer{padding:15px 20px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer{min-height:73px}}mv-splash .splash-container .splash-footer .app-icon-wrapper{display:inline-block}mv-splash .splash-container .splash-footer .app-icon-wrapper .app-icon{width:38px}html[dir=ltr] mv-splash .splash-container .splash-footer .app-icon-wrapper .app-icon{margin-right:7px}html[dir=rtl] mv-splash .splash-container .splash-footer .app-icon-wrapper .app-icon{margin-left:7px}mv-splash .splash-container .splash-footer .text{display:inline-block;vertical-align:top}mv-splash .splash-container .splash-footer .text .name{font-size:.8823529412rem;font-weight:700;line-height:1.0588235294rem}mv-splash .splash-container .splash-footer .text .stars{display:inline-block;padding-top:3px;width:auto;line-height:13px}mv-splash .splash-container .splash-footer .text .stars img{vertical-align:middle;width:73px}mv-splash .splash-container .splash-footer .text .stars span{font-size:.7058823529rem;margin:0 2px}mv-splash .splash-container .splash-footer .use-app-button{background:#0078D6;border-radius:4px;color:#fff;display:block;font-size:.7647058824rem;font-weight:700;line-height:1;margin:20px 0 0;padding:12px 20px;text-align:center;text-decoration:none;text-transform:capitalize;width:100%;box-sizing:border-box;outline-color:#302e2e}@media only screen and (max-height: 580px){mv-splash .splash-container .splash-footer .use-app-button{margin-top:15px}}mv-splash .splash-container .splash-footer .use-app-button:hover{background:#0785cb}mv-splash .splash-container .splash-footer .splash-btn{color:#737578;font-size:.7647058824rem;font-weight:400;line-height:1;margin-top:24px;text-align:center;text-decoration:none;width:100%;display:inline-flex;align-items:center;justify-content:center}body[data-continue-after-3-sec=optimize] mv-splash .splash-container .splash-footer .splash-btn{opacity:0;-webkit-animation:fade-in .3s 3s forwards;animation:fade-in .3s 3s forwards}@media only screen and (max-height: 580px){mv-splash .splash-container .splash-footer .splash-btn{margin-top:15px}}mv-splash .splash-container .splash-footer .splash-btn:after{border:.0588235294rem solid #737578;border-bottom-width:0;border-left-width:0;box-sizing:border-box;content:"";display:inline-block;height:.3529411765rem;width:.3529411765rem;position:relative;top:-1px;transform:rotate(45deg)}html[dir=ltr] mv-splash .splash-container .splash-footer .splash-btn:after{margin-left:6px}html[dir=rtl] mv-splash .splash-container .splash-footer .splash-btn:after{margin-right:6px}html[dir=rtl] mv-splash .splash-container .splash-footer .splash-btn:after{transform:rotate(-135deg)}mv-splash .splash-container .splash-footer .splash-btn:hover{outline:none}@media only screen and (max-height: 520px){mv-splash .splash-container .splash-footer{padding:15px 20px 18px}mv-splash .splash-container .splash-footer .splash-btn{margin-top:18px}mv-splash .splash-container .splash-footer .use-app-button{margin-top:10px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer{display:flex;justify-content:space-between;align-items:center;padding:18px 20px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer .app-rating-wrapper{min-width:174px}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer .app-rating-wrapper .text .name,mv-splash .splash-container .splash-footer .app-rating-wrapper .text .stars{line-height:1}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 600px){mv-splash .splash-container .splash-footer{padding:10px 15px}mv-splash .splash-container .splash-footer .app-rating-wrapper .app-icon{width:32px}mv-splash .splash-container .splash-footer .app-rating-wrapper .text .starts{padding-top:0}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer mv-app-links-wrapper:not(.optimize){display:flex;flex-grow:.7}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer a.splash-btn.splash-btn-site{margin-top:0;align-self:center;max-width:32vw}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer .use-app-button,mv-splash .splash-container .splash-footer .splash-btn-site{margin-top:0!important}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-footer .use-app-button{margin:0 20px}}mv-splash .splash-container .splash-mock{max-width:600px;bottom:165px;position:absolute;z-index:2;margin-top:4.5vw;width:60%}html[dir=ltr] mv-splash .splash-container .splash-mock{left:50%}html[dir=rtl] mv-splash .splash-container .splash-mock{right:50%}html[dir=ltr] mv-splash .splash-container .splash-mock{transform:translate(-50%)}html[dir=rtl] mv-splash .splash-container .splash-mock{transform:translate(50%)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-mock{width:65vh;bottom:73px!important}html[dir=ltr] mv-splash .splash-container .splash-mock{left:22%}html[dir=rtl] mv-splash .splash-container .splash-mock{right:22%}}mv-splash .splash-container .splash-mock .generic-mock,mv-splash .splash-container .splash-mock .trip-mock,mv-splash .splash-container .splash-mock .lines-mock{vertical-align:bottom;width:100%}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .splash-mock .generic-mock,mv-splash .splash-container .splash-mock .trip-mock,mv-splash .splash-container .splash-mock .lines-mock{max-width:31vw}}@media only screen and (max-height: 515px){mv-splash .splash-container .splash-mock{bottom:140px}}@media only screen and (min-height: 800px){mv-splash .splash-container .splash-mock{bottom:174px;width:80%}}mv-splash .splash-container .from-fields,mv-splash .splash-container .to-fields{display:flex;left:19%;position:absolute;text-align:left;text-align:initial;width:69%}mv-splash .splash-container .from-fields label,mv-splash .splash-container .to-fields label{color:#737578;display:inline-block;flex:0 1 auto;font-size:2.4vw;vertical-align:bottom;white-space:nowrap}html[dir=ltr] mv-splash .splash-container .from-fields label,html[dir=ltr] mv-splash .splash-container .to-fields label{padding-right:2.4vw}html[dir=rtl] mv-splash .splash-container .from-fields label,html[dir=rtl] mv-splash .splash-container .to-fields label{padding-left:2.4vw}mv-splash .splash-container .from-fields span,mv-splash .splash-container .to-fields span{color:#292a30;display:inline-block;flex:1 1 auto;font-size:2.8vw;line-height:2.8vw;overflow:hidden;text-overflow:ellipsis;vertical-align:bottom;white-space:nowrap}mv-splash .splash-container .fields-title{color:#fff;display:block;font-size:2.5vw;position:absolute;top:22%;width:100%;padding:0 20px;margin:auto;box-sizing:border-box}mv-splash .splash-container .from-fields{top:33%}mv-splash .splash-container .to-fields{top:46%}mv-splash .splash-container .location-bubble{background:#f0500c;bottom:17%;color:#fff;left:50%;min-width:150px;padding:2vw 3vw;position:absolute;width:50%;transform:translate(-50%)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .location-bubble{min-width:100px}}mv-splash .splash-container .location-bubble:after{border:7px solid transparent;border-top-color:#f0500c;bottom:-12px;content:"";left:50%;position:absolute;transform:translate(-50%)}mv-splash .splash-container .location-title{color:#fff;display:inline-block;font-size:2.8vw}mv-splash .splash-container .splash-mock .lines-content{box-sizing:border-box;color:#292a30;left:0;padding:0 10%;position:absolute;text-align:left;text-align:initial;top:21%;width:100%}mv-splash .splash-container .splash-mock .lines-content .line-image{font-size:.8235294118rem;margin:0}@media only screen and (max-height: 560px) and (max-width: 360px){mv-splash .splash-container .splash-mock .lines-content{top:19.5%}}mv-splash .splash-container .splash-mock .lines-content line-svg{width:auto}mv-splash .splash-container .splash-mock .lines-content line-svg .iconified-transit-line,mv-splash .splash-container .splash-mock .lines-content line-svg .transit-line{display:table;height:auto;padding:1vw}mv-splash .splash-container .splash-mock .lines-content line-svg .iconified-transit-line img,mv-splash .splash-container .splash-mock .lines-content line-svg .transit-line img{height:4vw}mv-splash .splash-container .splash-mock .lines-content line-svg img{display:table-cell;height:5vw;position:static;vertical-align:bottom;width:auto}mv-splash .splash-container .splash-mock .lines-content line-svg .mvf-container{height:5vw!important}mv-splash .splash-container .splash-mock .lines-content line-svg .mvf-mask-image{height:6vw;width:6vw}mv-splash .splash-container .splash-mock .lines-content line-svg .line-number{display:table-cell;font-size:3vw;line-height:1;vertical-align:bottom}html[dir=ltr] mv-splash .splash-container .splash-mock .lines-content line-svg .line-number{padding-left:1vw}html[dir=rtl] mv-splash .splash-container .splash-mock .lines-content line-svg .line-number{padding-right:1vw}mv-splash .splash-container .line-title,mv-splash .splash-container .line-subtitle{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}mv-splash .splash-container .line-title{font-size:3.8vw;font-weight:700;margin:2vw 0 0}mv-splash .splash-container .line-subtitle{font-size:3vw;margin:0}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-splash .splash-container .lines-content{padding:0 16%}mv-splash .splash-container .lines-content .line-title{font-size:2.8vw;margin-top:0}mv-splash .splash-container .lines-content .line-subtitle{font-size:2vw}}body[data-splash-cta-text^=V] mv-splash .splash-container .splash-footer .use-app-button span{text-transform:none}\n'],encapsulation:2}),e})()},58790:function(e,t,n){"use strict";n.d(t,{x:function(){return p}});var i=n(54364),r=n(53448),o=n(42118),a=n(2339),s=n(87479),l=n(66883),c=(n(98751),n(97971),n(30037),n(25634),n(37194),n(32066)),d=(n(26152),n(52815),n(36366)),u=(n(7964),n(9881),n(87732),n(58463),n(43087),n(11098),n(13691),n(2316));n(5971),n(1437),n(95505),n(1238),n(46461),n(79223),n(54509),n(67683),n(15041),n(14942),n(72171),n(23052),n(93767),n(94943),n(55380),n(38399),n(77226),n(24813),n(93373);let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[i.ez,r.u5,a.aw.forChild(),s._J,o.m,c.iu.forChild(),d.Iq,l.xu]]}),e})()},96542:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var i=n(3786),r=n(23052),o=n(2316),a=n(21090),s=n(2339);let l=(()=>{class e{constructor(e,t){this.dialogService=e,this.translateService=t}displayWarning(e,t,n,i){const o=this.dialogService.create(r.k,Object.assign(Object.assign({maxWidth:"calc(100% - 44px)",minWidth:"290px",panelClass:"app-popup"},i),{data:Object.assign({errorContent:n,isWarningMessage:!0},null==i?void 0:i.data)}));this.onCloseDialog(o,e,t)}onCloseDialog(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){"retry"===(yield e.onClose.toPromise())&&t?t():n&&n(),e.close()})}displayError(e,t,n,i){let o=(null==n?void 0:n.title)||"",a=(null==n?void 0:n.text)||"";!o&&!a&&(o=this.translateService.instant("generic_error_title"),a=this.translateService.instant("generic_error_text"));const s=this.dialogService.create(r.k,Object.assign(Object.assign({maxWidth:"calc(100% - 44px)",minWidth:"290px",panelClass:"app-popup"},i),{data:Object.assign({errorContent:{title:o,text:a,imageSrc:n.imageSrc}},null==i?void 0:i.data)}));this.onCloseDialog(s,e,t)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.x),o.LFG(s.sK))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1420:function(e,t,n){"use strict";n.d(t,{t:function(){return k}});var i=n(3786),r=n(78776),o=n(58871),a=n(16438);const s={[r.r.TripPlanResults]:"share_tripplan_results",[r.r.Itinerary]:"share_itinerary",[r.r.Location]:"action_share_location",[r.r.Line]:"web_trip_plan_share_line_info_button",[r.r.ServiceAlert]:"web_trip_plan_share_service_alert_button"};function l(e,...t){let n;if(t instanceof Array){for(n=0;n<t.length;n++)e=e.replace(new RegExp("\\{"+n+"\\}","gm"),t[n]);return e}for(n=0;n<arguments.length-1;n++)e=e.replace(new RegExp("\\{"+n+"\\}","gm"),arguments[n+1]);return e}var c=n(86781),d=n(65492),u=n(55380),p=n(64267),h=n(2316),m=n(2339),g=n(95505),f=n(99902),v=n(1437),y=n(36366),b=n(1238),_=n(5971),T=n(99957),S=n(15208),x=n(22213);const w=(0,c.hu)("ShareService");let k=(()=>{class e{constructor(e,t,n,i,o,a,s,l,c,d){this.translate=e,this.routingService=t,this.httpService=n,this.analyticsService=i,this.clipboard=o,this.globalActions=a,this.store=s,this.customerService=l,this.platformService=c,this.dialogService=d,this.allShareOptions=[{id:r.v.Link,titleKey:"share_copy_link",icon:"images/share/copy_link_icon.svg",handler:this.shareLink},{id:r.v.Email,titleKey:"share_email",icon:"images/share/email_icon.svg",mobileOnly:!0,handler:this.shareEmail},{id:r.v.Facebook,titleKey:"share_messenger",icon:"images/share/messenger_icon.svg",handler:this.shareFacebook},{id:r.v.WhatsApp,titleKey:"action_whatsapp",icon:"images/share/whatsapp_icon.svg",mobileOnly:!0,handler:this.shareWhatsApp}],this.shareOptions=this.allShareOptions.slice()}get state(){return this.store.getState()}openSharePanel(e=this.getShareCategory(),t){this.platformService.isDesktop?this.dialogService.open(u.X,{data:{shareTitle:this.getShareLabel(e),shareCategory:e,locationName:t},panelClass:"share"}):setTimeout(()=>this.store.dispatch(this.globalActions.showShareDialog(!0))),this.analyticsService.trackShareAction("open dialog",r.r[e])}share(e,t=this.getShareCategory()){e.handler.call(this,{fullUrl:this.routingService.getFullUrl(),shareCategory:t}),this.store.dispatch(this.globalActions.showShareDialog(!1))}shareLink(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.generateShareableUrl(e,o.YK.SharedLink);this.clipboard.copyFromContent(t),this.analyticsService.trackShareAction("link",r.r[e.shareCategory])})}shareEmail(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=this.getActionMessage(e.shareCategory),n=t?encodeURIComponent(t):"",i=yield this.generateShareableUrl(e,o.YK.SharedEmail,!0);window.open(l("mailto:?subject={0}&body={1}",n,i),"_self"),this.analyticsService.trackShareAction("email client",r.r[e.shareCategory])})}shareFacebook(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.generateShareableUrl(e,o.YK.SharedMessenger,!0);this.platformService.isMobile?window.open(l("fb-messenger://share?link={0}",t),"_self"):window.open(l("https://www.facebook.com/dialog/send?app_id=284644261627721&link={0}&redirect_uri={0}",t)),this.analyticsService.trackShareAction("messenger",r.r[e.shareCategory])})}shareWhatsApp(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=this.getActionMessage(e.shareCategory),n=yield this.generateShareableUrl(e,o.YK.SharedWhatsApp,!0);window.open(l("whatsapp://send?text={0}",(t?`${t}: `:"")+n),"_self"),this.analyticsService.trackShareAction("whatsapp",r.r[e.shareCategory])})}generateShareableUrl(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){let i=e.fullUrl;if(e.shareCategory===r.r.Itinerary)try{i=yield this.generateItineraryShareableLink(this.state.itinerary.selectedRoute)}catch(o){}return i=this.appendCampaignToUrl(i,t),n&&(i=encodeURIComponent(i)),w.log(`Generated shareable URL: ${i}`),i})}getShareableLink(e=this.getShareCategory()){const t={fullUrl:this.routingService.getFullUrl(),shareCategory:e};return this.generateShareableUrl(t,o.YK.SharedLink)}generateItineraryShareableLink(e){return(0,i.mG)(this,void 0,void 0,function*(){const{itineraryGuid:t,originalItinerary:n}=e,i=yield this.httpService.post(d.bl.ShareItinerary,{body:{itineraryGuid:t,originalItinerary:n}}).toPromise();if(i.entityLink){let e=i.entityLink.url;const t=this.routingService.getStateFromUrl().customerId;return t&&!this.customerService.isMoovitCustomer(t)&&(e+=`${e.includes("?")?"&":"?"}customerId=${t}`),e}return null})}getShareParams(e,t){var n;switch(e=null!=e?e:this.getShareCategory()){case r.r.ServiceAlert:return{line:null===(n=this.state.alert.currentAlertDetails[0])||void 0===n?void 0:n.lineName};case r.r.Line:return{line:this.state.line.lineGroup.lineNumber||""};case r.r.TripPlanResults:return{from_address:this.state.directions.search.from.name,to_address:this.state.directions.search.to.name};case r.r.Itinerary:return{from_address:this.state.itinerary.selectedRoute.from.name,to_address:this.state.itinerary.selectedRoute.to.name};case r.r.Location:return{location:t}}return{}}getItineraryBySharedId(e){return this.httpService.post(d.bl.GetSharedItinerary,{body:{id:e}}).toPromise()}getShareCategory(){const e=this.state.global.selectedTab,t=this.state.global.selectedSubTab;if(e===a.TF.TRIPPLAN){if(t===a.zA.TRIPPLAN_DIRECTIONS)return r.r.TripPlanResults;if(t===a.zA.TRIPPLAN_ITINERARY||t===a.zA.TRIPPLAN_MAP)return r.r.Itinerary}return e===a.TF.LINES?r.r.Line:e===a.TF.ALERTS?r.r.ServiceAlert:null}getShareLabel(e=this.getShareCategory()){return s[e]?this.translate.instant(s[e]):""}getActionMessage(e){return e===r.r.TripPlanResults||e===r.r.Itinerary?this.translate.instant("web_trip_plan_share_trip_plan_subject",{param1:encodeURIComponent(this.state.directions.search.from.name),param2:encodeURIComponent(this.state.directions.search.to.name)}):e===r.r.Location?this.translate.instant("web_trip_plan_share_location_subject",{param1:this.getShareLabel(e)}):e===r.r.Line?this.translate.instant("web_trip_plan_share_line_subject",{param1:this.state.line.lineGroup.lineNumber||""}):e===r.r.ServiceAlert?this.translate.instant("web_trip_plan_share_service_alert_subject",{param1:this.state.alert.currentAlertDetails[0].title||""}):""}appendCampaignToUrl(e,t){const n=new URL(e);return n.searchParams.delete("utm_source"),n.searchParams.delete("utm_medium"),n.searchParams.set("t",t.toString()),n.href}sendEmail(e,t,n,r){return(0,i.mG)(this,void 0,void 0,function*(){n=null!=n?n:this.getShareCategory();const i={fullUrl:this.routingService.getFullUrl(),shareCategory:n},a=yield this.generateShareableUrl(i,o.YK.SharedEmail),s=this.getShareParams(n,r);return s.message=t,s.url=this.appendCampaignToUrl(a,o.YK.SharedEmail),this.sendEmailFromServer(e,n,s)})}sendEmailFromServer(e,t,n){return w.log("sendEmailFromServer",JSON.stringify(e),JSON.stringify(n)),this.analyticsService.trackShareAction("email server",r.r[t]),function(e,t){return new Promise((t,n)=>{let i,r=!1;e.subscribe({next:e=>{i=e,r=!0},error:n,complete:()=>{r?t(i):n(new p.K)}})})}(this.httpService.post(d.bl.ShareSendEmail,{body:{shareType:t,recipients:JSON.stringify({addresses:e}),parameters:JSON.stringify(n)}},!0))}}return e.\u0275fac=function(t){return new(t||e)(h.LFG(m.sK),h.LFG(g.Z),h.LFG(f.O),h.LFG(v.y),h.LFG(y.Yv),h.LFG(b.l),h.LFG(_.d),h.LFG(T.v),h.LFG(S.mi),h.LFG(x.uw))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},78776:function(e,t,n){"use strict";n.d(t,{v:function(){return i},r:function(){return r}});var i=(()=>{return(e=i||(i={}))[e.Link=0]="Link",e[e.Email=1]="Email",e[e.Facebook=2]="Facebook",e[e.WhatsApp=3]="WhatsApp",i;var e})(),r=(()=>{return(e=r||(r={}))[e.TripPlanResults=1]="TripPlanResults",e[e.Itinerary=2]="Itinerary",e[e.Location=3]="Location",e[e.Line=4]="Line",e[e.ServiceAlert=5]="ServiceAlert",r;var e})()},73961:function(e,t,n){"use strict";n.d(t,{le:function(){return _}});var i=n(3786),r=n(2316),o=n(87554),a=n(94354),s=n(2122),l=n(53792),c=n(54366),d=n(30977),u=n(65492),p=n(86781),h=n(99902),m=n(32066),g=n(5971),f=n(94876),v=n(1564),y=n(23137);const b=(0,p.hu)("LineListService");let _=(()=>{class e{constructor(e,t,n,i,d,u){this.httpService=e,this.imageService=t,this.store=n,this.lineActions=i,this.metroActions=d,this.uiActions=u,this.list$=new o.X([]),this.search$=new a.x,this.searchEvent=new r.vpe,this.search$.pipe((0,s.b)(400),(0,l.x)(),(0,c.w)(e=>(this.setInfDefaults(),this.infSearch=e,e?this.next(null,"observeable"):this.init()))).subscribe(e=>this.searchEvent.emit())}get state(){return this.store.getState()}getLines(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){const i=yield this.httpService.post(u.bl.GetLines,{body:{agencyId:e,offset:t,limit:n}},!0).toPromise();this.addLines(this.normaliseLines(i.lineGroupItems,e),e);const r=this.countLinesInAgency(e);this.infRemainingForAgency[e]=i.total-r,b.log(`Remaining for agency ${e}: ${this.infRemainingForAgency[e]}`)})}searchLines(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(u.bl.SearchLines,{body:{query:e,offset:t,limit:n}},!0).toPromise()})}setInfDefaults(){this.list$.next([]),this.infCurrentAgency=-1,this.infRemainingForAgency={},this.infSearchOffset=0,this.infFinished=!1,this.store.dispatch(this.lineActions.resetItems())}init(){return(0,i.mG)(this,void 0,void 0,function*(){for(this.setInfDefaults(),yield this.store.dispatch(this.metroActions.getAllAgencies());this.state.line.items.length<30&&!1===this.infFinished;)yield this.next(!0,"init while")})}next(e,t){return(0,i.mG)(this,void 0,void 0,function*(){e||this.store.dispatch(this.uiActions.setLoading(!0)),yield(()=>(0,i.mG)(this,void 0,void 0,function*(){if(this.infSearch)(yield this.searchLines(this.infSearch,this.infSearchOffset,30)).lineGroupSections.forEach(e=>{this.addAgency(this.findAgencyById(e.agencyId)),this.addLines(this.normaliseLines(e.items,e.agencyId),e.agencyId)}),this.infSearchOffset+=30;else{if(-1===this.infCurrentAgency&&(this.infCurrentAgency=this.state.metro.allAgencies[0].agencyId,b.log("Setting initial agencyId",this.infCurrentAgency)),!this.findItemBy("agencyId",this.infCurrentAgency))return this.addAgency(this.findAgencyById(this.infCurrentAgency)),void b.log("Adding new agency",this.infCurrentAgency);if(!this.infRemainingForAgency.hasOwnProperty(this.infCurrentAgency.toString())||this.infRemainingForAgency[this.infCurrentAgency]>0)return b.log("Fetching",this.infCurrentAgency,this.countLinesInAgency(this.infCurrentAgency)),this.getLines(this.infCurrentAgency,this.countLinesInAgency(this.infCurrentAgency),30);{b.log("Bumping to next",this.infCurrentAgency);let t=this.state.metro.allAgencies.findIndex(e=>e.agencyId===this.infCurrentAgency);if(t++,this.state.metro.allAgencies[t])return this.infCurrentAgency=this.state.metro.allAgencies[t].agencyId,b.log("Bumped to next agency",this.state.metro.allAgencies[t].agencyId),this.next(e,"self bump");b.log("No next agency available"),this.infFinished=!0}}}))(),e||this.store.dispatch(this.uiActions.setLoading(!1))})}normaliseLines(e,t){return e.map(e=>{const t={primary:e.title,secondary:e.subtitle.reduce((e,t)=>e+t.text,"")};return Object.assign(Object.assign({},e),{lineName:t,imageHtml:e.image?this.imageService.getImageHTML(e.image.imageId,[null,...e.image.parameters],void 0,t.primary):""})})}countLinesInAgency(e){return this.state.line.items.filter(t=>t.$type===d.G.LINE&&t.agencyId===e).length}findItemBy(e,t){return this.state.line.items.find(n=>n[e]===t)}findAgencyById(e){return this.state.metro.allAgencies.find(t=>t.agencyId===e)}addAgency(e){this.store.dispatch(this.lineActions.addItems(Object.assign({$type:d.G.AGENCY},e))),this.list$.next(this.state.line.items)}addLines(e,t){this.store.dispatch(this.lineActions.addItems(e.map(e=>Object.assign({$type:d.G.LINE,agencyId:t},e)))),this.list$.next(this.state.line.items)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(h.O),r.LFG(m.KD),r.LFG(g.d),r.LFG(f.J),r.LFG(v.L),r.LFG(y.V))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},29224:function(e,t,n){"use strict";n.d(t,{y:function(){return Ye}});var i=n(16438),r=n(2316),o=n(95505),a=n(54364),s=n(3786),l=n(43049),c=n(99528),d=n(87100),u=n(86781),p=n(44143),h=n(55754),m=n(80221),g=n(97192),f=n(1210),v=n(85501),y=n(35533),b=n(98922),_=n(51611),T=n(19073),S=n(2281),x=n(65492),w=n(99902),k=n(2339),M=n(5971);let L=(()=>{class e{constructor(e,t,n){this.httpService=e,this.translate=t,this.store=n,this.realTime$=new y.w0}get state(){return this.store.getState()}terminateRealTime(){this.realTimeResult="",this.realTime$.unsubscribe()}runRealTime(e,t){this.terminateRealTime(),this.realTime$=(0,b.F)(1e4).pipe((0,_.O)(0),(0,T.z)(()=>this.getLineArrivalsToStop(e,t))).subscribe(e=>{if(e.length>0){let t;if(this.state.line.selectedSubgroup)t=[].concat.apply([],e.map(e=>e.lineArrivals.arrivals));else{const n=e.find(e=>e.lineArrivals.lineId===this.state.line.selectedLine.lineId);t=n?n.lineArrivals.arrivals:null,(null==t?void 0:t.length)>0&&this.state.line.displayedLine.patternId&&(t=t.filter(e=>e.patternId===this.state.line.displayedLine.patternId))}if((null==t?void 0:t.length)>0){const n=t[0].relativeRealTimeSpanSeconds,i=this.state.metro.currentMetro.timeZoneOffset,r=S().utcOffset(i).diff(S().utcOffset(i).startOf("day"),"seconds"),o=(0,d.Ic)(e[0].epochDay),a=Math.floor((n-(r+o))/60);a>-1?this.realTimeResult=0==a?this.translate.instant("now"):this.translate.instant("units_minutes_text",{param1:a}):this.terminateRealTime()}}})}getLineArrivalsToStop(e,t){return this.httpService.post(x.bl.GetLineArrival,{body:{stopId:e,lineIds:JSON.stringify({ids:t})}},!0)}hasStopArrivals(e,t,n){return this.getStopArrivalTime(t,e,n)}getStopArrival(e,t,n){const i=this.getStopArrivalTime(t,e,n);return i?this.formatDepartureTime(i.arrivalTime):null}formatDepartureTime(e){return(0,d.mr)(S.unix(e))}getNextArrivals(e,t){const n=this.getStopArrival(e,1,t),i=this.getStopArrival(e,2,t);return`${n}${i?`, ${i}`:""}`}getDepartureDate(){if(!this.state.line.displayedLine)return null;let e=null;for(let t=0;t<this.state.line.displayedLine.stops.length&&(e=this.state.line.displayedLine.stopArrivals[this.state.line.displayedLine.stops[t].id],!e);t++);return e?S.unix(e[0].arrivalTime).calendar():null}getStopArrivalTime(e,t,n){const i=this.state.line.displayedLine.stopArrivals[t.id].filter(e=>e.stopIndex===n);if(i){const t=S().unix();let n=-1,r=i.find((e,i)=>e.arrivalTime>t&&(n=i,!0));if(r)return r=i[n+e],r}return null}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(w.O),r.LFG(k.sK),r.LFG(M.d))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=n(61787),I=n(94876),E=n(1437),C=n(5306),D=n(78146),P=n(21532),O=n(85431),N=n(31251),R=n(7935),$=n(15208),Y=n(99642),F=n(19581),B=n(87479),U=n(93975),Z=n(53448),j=n(31127),V=n(89458),H=n(79223);const G=["backButton"];function z(e,t){if(1&e&&(r.TgZ(0,"div",22),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.lineRealTimeService.getDepartureDate()," ")}}function q(e,t){if(1&e&&(r.TgZ(0,"div",23),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.title)}}function J(e,t){if(1&e&&(r.TgZ(0,"div",24),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.subTitle)}}function W(e,t){1&e&&r._UZ(0,"mv-share",25),2&e&&r.Q6J("showCaption",!1)}function Q(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",26),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).onAlertClick()})("keydown.enter",function(){return r.CHM(e),r.oxw(2).onAlertClick()}),r._uU(1),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.state.line.lineAlert.serviceAlertEffect," ")}}function K(e,t){if(1&e&&(r.TgZ(0,"div",27),r.TgZ(1,"div"),r.TgZ(2,"span",28),r._uU(3),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(3),r.Oqu(e.getLineTitle(e.state.line.selectedLine))}}function X(e,t){if(1&e&&(r.TgZ(0,"option",36),r._uU(1),r.qZA()),2&e){const e=t.$implicit,n=r.oxw(4);r.Q6J("ngValue",e),r.xp6(1),r.hij(" ",n.getLineTitle(e)," ")}}function ee(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"select",34),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(3).onLineChange(t)}),r.ALo(2,"translate"),r.YNc(3,X,2,2,"option",35),r.qZA(),r.BQk()}if(2&e){const e=r.oxw(3);r.xp6(1),r.Q6J("ngModel",e.selectedLineOption),r.uIk("aria-label",r.lcZ(2,3,"line_change_direction")),r.xp6(2),r.Q6J("ngForOf",e.state.line.lineDirections)}}function te(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",41),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(4).onLineChange(t)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw(4);r.xp6(1),r.hij(" ",n.getLineTitle(e)," ")}}function ne(e,t){if(1&e&&(r._UZ(0,"button",37),r.TgZ(1,"mat-menu",38,39),r.ALo(3,"translate"),r.YNc(4,te,2,1,"button",40),r.qZA()),2&e){const e=r.MAs(2),t=r.oxw(3);r.Q6J("matMenuTriggerFor",e),r.xp6(1),r.uIk("aria-label",r.lcZ(3,3,"line_change_direction")),r.xp6(3),r.Q6J("ngForOf",t.state.line.lineDirections)}}function ie(e,t){if(1&e&&(r.TgZ(0,"div",29),r.YNc(1,ee,4,5,"ng-container",30),r.YNc(2,ne,5,5,"ng-template",null,31,r.W1O),r.TgZ(4,"span",32),r._uU(5),r.ALo(6,"translate"),r._UZ(7,"svg-icon",33),r.ALo(8,"translate"),r.qZA(),r.qZA()),2&e){const e=r.MAs(3),t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",e),r.xp6(4),r.hij("",r.lcZ(6,4,"line_change_direction")," "),r.xp6(2),r.s9C("titleText",r.lcZ(8,6,"line_change_direction"))}}function re(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span",50),r.NdJ("click",function(){const t=r.CHM(e).index;return r.oxw(3).onLineOptionChange(t)}),r.qZA()}if(2&e){const e=t.index,n=r.oxw(3);r.ekj("selected",n.state.line.selectedLineOptionIndex===e)}}function oe(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",42),r.TgZ(1,"div",43),r.TgZ(2,"a",44),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.onLineOptionChange(t.state.line.selectedLineOptionIndex-1)}),r._UZ(3,"svg-icon",45),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"a",46),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.onLineOptionChange(t.state.line.selectedLineOptionIndex+1)}),r._UZ(6,"svg-icon",45),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.TgZ(8,"div",47),r.TgZ(9,"div",48),r._uU(10),r.ALo(11,"translate"),r.ALo(12,"translate"),r.qZA(),r.YNc(13,re,1,2,"span",49),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.ekj("disabled",e.state.line.selectedLineOptionIndex<1),r.xp6(1),r.s9C("titleText",r.lcZ(4,9,"action_previous")),r.xp6(2),r.ekj("disabled",e.state.line.selectedLineOptionIndex===e.state.line.selectedLineOptions.length-1),r.xp6(1),r.s9C("titleText",r.lcZ(7,11,"action_next")),r.xp6(4),r.AsE(" ",r.lcZ(11,13,"ls_option")," - ",r.xi3(12,15,"many_stops",e.getTranslateParams(null==e.state.line.displayedLine?null:e.state.line.displayedLine.stops.length))," "),r.xp6(3),r.Q6J("ngForOf",e.state.line.selectedLineOptions)}}function ae(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",5),r.YNc(1,z,2,1,"div",6),r.TgZ(2,"div",7),r.TgZ(3,"div",8),r.TgZ(4,"mv-back-button",9),r.NdJ("backClick",function(){return r.CHM(e),r.oxw().onBack()}),r.qZA(),r.TgZ(5,"div",10),r._UZ(6,"span",11),r.ALo(7,"safeHtml"),r.ALo(8,"async"),r.TgZ(9,"div",12),r.YNc(10,q,2,1,"div",13),r.YNc(11,J,2,1,"div",14),r.qZA(),r.YNc(12,W,1,1,"mv-share",15),r.qZA(),r.qZA(),r.YNc(13,Q,2,1,"div",16),r.qZA(),r.TgZ(14,"div",17),r.TgZ(15,"div",18),r.YNc(16,K,4,1,"div",19),r.YNc(17,ie,9,8,"div",20),r.qZA(),r.YNc(18,oe,14,18,"div",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.futureMode),r.xp6(1),r.ekj("long-line-name",e.isLongName),r.xp6(4),r.Q6J("innerHTML",r.lcZ(7,11,r.lcZ(8,13,e.state.line.lineGroup.imageHtml)),r.oJD),r.xp6(4),r.Q6J("ngIf",e.title),r.xp6(1),r.Q6J("ngIf",e.subTitle),r.xp6(1),r.Q6J("ngIf",!e.shouldHideSharing),r.xp6(1),r.Q6J("ngIf",e.state.line.lineAlert),r.xp6(3),r.Q6J("ngIf",e.state.line.selectedLine),r.xp6(1),r.Q6J("ngIf",e.state.line.lineDirections.length>1),r.xp6(1),r.Q6J("ngIf",e.state.line.selectedLineOptions.length>1)}}function se(e,t){if(1&e&&(r.TgZ(0,"div",59),r.TgZ(1,"span",60),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"span",61),r._uU(5),r.qZA(),r.qZA()),2&e){const e=r.oxw(),t=e.$implicit,n=e.index,i=r.oxw(2);r.xp6(2),r.hij("",r.lcZ(3,2,"tripplan_itinerary_schedule_full_header"),": "),r.xp6(3),r.Oqu(i.lineRealTimeService.getNextArrivals(t,n))}}function le(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"a",62),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(),n=t.$implicit,i=t.index;return r.oxw(2).openStopSchedule(n,i)})("keydown.enter",function(){r.CHM(e);const t=r.oxw(),n=t.$implicit,i=t.index;return r.oxw(2).openStopSchedule(n,i)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"view_full_schedule")," "))}function ce(e,t){1&e&&(r.TgZ(0,"div",67),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"tripplan_itinerary_schedule_header")," "))}function de(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw(2),t=e.$implicit,n=e.index,i=r.oxw(2);r.xp6(1),r.hij(" ",i.lineRealTimeService.getStopArrival(t,0,n)," ")}}function ue(e,t){if(1&e&&(r.TgZ(0,"span",68),r._UZ(1,"span",69),r._uU(2),r.qZA()),2&e){const e=r.oxw(4);r.xp6(2),r.hij(" ",e.realTime," ")}}function pe(e,t){if(1&e&&(r.TgZ(0,"div",63),r.YNc(1,ce,3,3,"div",64),r.TgZ(2,"div",65),r.YNc(3,de,2,1,"span",2),r.YNc(4,ue,3,1,"span",66),r.qZA(),r.qZA()),2&e){const e=r.oxw(),t=e.$implicit,n=e.index,i=r.oxw(2);r.xp6(1),r.Q6J("ngIf",i.state.metro.currentConditions.minimalData),r.xp6(2),r.Q6J("ngIf",i.lineRealTimeService.hasStopArrivals(t,0,n)&&!i.realTime),r.xp6(1),r.Q6J("ngIf",i.realTime)}}function he(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",54),r.NdJ("click",function(){const t=r.CHM(e).index;return r.oxw(2).onStopClick(t)})("keydown.enter",function(){const t=r.CHM(e).index;return r.oxw(2).onStopClick(t)}),r.TgZ(1,"div"),r.TgZ(2,"div",55),r._uU(3),r.qZA(),r.YNc(4,se,6,4,"div",56),r.YNc(5,le,3,3,"a",57),r.qZA(),r.YNc(6,pe,5,3,"div",58),r.qZA()}if(2&e){const e=t.$implicit,n=t.index,i=r.oxw(2);r.ekj("selected",i.isSelectedStop(e.id,n)),r.Q6J("id",i.getStopElementId(n)),r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("ngIf",i.state.metro.currentConditions.minimalData&&i.lineRealTimeService.hasStopArrivals(e,1,n)),r.xp6(1),r.Q6J("ngIf",!i.state.metro.currentConditions.minimalData),r.xp6(1),r.Q6J("ngIf",i.isSelectedStop(e.id,n))}}function me(e,t){if(1&e&&(r.TgZ(0,"div",51),r._UZ(1,"mv-updates-message",52),r.YNc(2,he,7,7,"div",53),r.qZA()),2&e){const e=r.oxw();r.uIk("aria-activedescendant",e.ariaSelectedStop),r.xp6(1),r.Q6J("message",e.message),r.xp6(1),r.Q6J("ngForOf",e.state.line.displayedLine.stops)}}function ge(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"div",7),r.TgZ(2,"mv-back-button",9),r.NdJ("backClick",function(){return r.CHM(e),r.oxw().onBack()}),r.qZA(),r.qZA(),r.TgZ(3,"div",70),r._UZ(4,"svg-icon",71),r.ALo(5,"translate"),r.TgZ(6,"div",72),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.BQk()}2&e&&(r.xp6(4),r.s9C("titleText",r.lcZ(5,2,"NoTripPlanFoundTitle")),r.xp6(3),r.Oqu(r.lcZ(8,4,"line_no_results")))}function fe(e,t){if(1&e&&(r.TgZ(0,"option",36),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("ngValue",e),r.xp6(1),r.hij(" ",e.text," ")}}function ve(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",73),r.TgZ(1,"div",74),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",75),r.TgZ(5,"div",76),r.TgZ(6,"select",34),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().onDayChange(t)}),r.YNc(7,fe,2,2,"option",35),r.qZA(),r.TgZ(8,"span",32),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.hij(" ",r.lcZ(3,4,"line_detail_empty_options_selected_time")," "),r.xp6(4),r.Q6J("ngModel",e.selectedDay),r.xp6(1),r.Q6J("ngForOf",e.lineService.dayOptions),r.xp6(2),r.Oqu(r.lcZ(10,6,"line_change_time"))}}function ye(e,t){if(1&e&&r._UZ(0,"mv-qr-code-banner",77),2&e){const e=r.oxw();r.Q6J("qrCodeParams",e.qrParams)}}const be=(0,u.hu)("LineViewComponent");let _e=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d,u,p,h,m,v,y){this.routingService=e,this.lineService=t,this.lineRealTimeService=n,this.canonicalService=i,this.store=r,this.lineActions=o,this.analyticsService=a,this.universal=s,this.a11y=l,this.lineTemplateService=c,this.translate=d,this.storeHelper=u,this.permissionService=p,this.elementRef=h,this.document=m,this.splashDisplayService=v,this.platformService=y,this.qrParams={campaign:g.oS.Lines_QRcode,appArea:g.Kq.QR,deepLinkSchemaType:f.nu.Lines,promoKey:"web_scan_qr",displayDirection:"top"},this.message={backgroundColor:"#e6f1fd",text:"web_stations_choose_station_message"},this.completedInitialFocus=!1}get state(){return this.store.getState()}get futureMode(){return this.state.line.selectedDayOffset!=(0,d.i7)()}get realTime(){return this.lineRealTimeService.realTimeResult||""}get shouldShowNoLine(){return this.state.global.appIsReady&&!this.state.global.isLoading&&!this.state.line.lineDirections.length}get shouldShowEmptyState(){return!this.shouldShowNoLine&&this.state.global.appIsReady&&!this.state.line.selectedLineOptions.length}get shouldHideSharing(){var e;return null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration.hideSharing}get selectedLine(){return this.state.line.selectedLine}ngOnInit(){if(this.lineService.populateDayOptions(),this.universal.isBrowser&&this.document.querySelector(".app-container").scrollIntoView(),!this.initTitles()){const e=this.storeHelper.subscribe("line.selectedLine",t=>{t&&this.initTitles()&&e()})}}get isSelectClosestStationSupported(){var e,t,n;return null===(n=null===(t=null===(e=this.state.global)||void 0===e?void 0:e.featureFlags)||void 0===t?void 0:t.lineViewExpandClosestStation)||void 0===n?void 0:n.isActive}ngAfterViewInit(){var e;if(this.universal.isBrowser)if(null===(e=this.state.line.displayedLine)||void 0===e?void 0:e.stops)setTimeout(()=>{this.selectClosestStation()});else{const e=this.storeHelper.subscribe("line.displayedLine",t=>{(null==t?void 0:t.stops)&&(e(),setTimeout(()=>{this.selectClosestStation()}))})}}ngAfterViewChecked(){var e;!this.completedInitialFocus&&this.backButton&&this.a11y.byEnter&&(null===(e=this.backButton.nativeElement)||void 0===e||e.focus(),this.completedInitialFocus=!0)}initTitles(){var e,t,n;const i=null===(n=null===(t=null===(e=this.state.line)||void 0===e?void 0:e.selectedLine)||void 0===t?void 0:t.presentationLine)||void 0===n?void 0:n[c.vU.LineDetail];return!!i&&(this.title=i.title,this.subTitle=i.subTitle,this.isLongName=i.title.length>8&&this.isMobile,!0)}get isMobile(){return this.platformService.isMobile}get isDesktop(){return this.platformService.isDesktop}getStationFromUrl(){let e=-1;const t=this.routingService.getStateFromUrl();return t.stopId&&(e="number"!=typeof t.stopIndex||Number.isNaN(t.stopIndex)?this.state.line.displayedLine.stops.findIndex(e=>e.id===t.stopId):t.stopIndex),e}closestStationIndex(){var e;return(0,s.mG)(this,void 0,void 0,function*(){let t,n=this.getStationFromUrl();if(-1!==n||(n=0,!this.isSelectClosestStationSupported||!(yield this.permissionService.requestLocation({subtitle:"permissions_location_station_message"}))))return n;try{t=null===(e=yield this.permissionService.getLocation({timeout:5e3,maximumAge:36e5}))||void 0===e?void 0:e.coords}catch(r){be.error("selectClosestStation fail",r)}if(!t)return n;const i={stopIndex:-1,distance:Number.MAX_SAFE_INTEGER};return this.state.line.displayedLine.stops.filter(e=>e.location).forEach((e,n)=>{const r=h._.fromMvLatLon(e.location),o=(0,p.YQ)(t.latitude,t.longitude,r.lat,r.lng,"K");o<i.distance&&(i.distance=o,i.stopIndex=n)}),i.distance<=5&&(n=i.stopIndex),n})}selectClosestStation(){var e;return(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.closestStationIndex();this.onStopClick(t);const n=this.getStopElementId(t),i=(null===(e=this.document.getElementById(n))||void 0===e?void 0:e.offsetTop)-this.elementRef.nativeElement.offsetTop;this.splashDisplayService.removeListenerOfScrollToTop(),this.document.body.parentElement.scrollTo({behavior:"smooth",top:i,left:0})})}onBack(){this.routingService.redirectTo(this.canonicalService.buildStatefulPath([":tab",":locale"]))}onLineChange(e){this.analyticsService.trackLinesAction("line changed",e.lineTitle),this.store.dispatch(this.lineActions.selectLine(e)),this.initTitles(),this.selectClosestStation()}onLineOptionChange(e){e>=0&&e<this.state.line.selectedLineOptions.length&&this.analyticsService.trackLinesAction("line option change",`Line option - ${this.selectedLine.lineOptions[e].stops.length} stops`.toString()),this.store.dispatch(this.lineActions.selectLineOption(e))}onAlertClick(){const e=this.state.line.lineAlert;this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],i.zA.ALERTS_SINGLE_VIEW),{etype:e.entityIdentidier.entityType,eid:e.entityIdentidier.id})}onStopClick(e){const t=this.state.line.displayedLine.stops[e];if(this.state.line.selectedStopId!==t.id||this.state.line.selectedStopIndex!==e){if(!this.futureMode){const e=this.state.line.selectedSubgroup?this.state.line.selectedSubgroup.lines.map(e=>e.lineId):[this.selectedLine.lineId];this.lineRealTimeService.runRealTime(t.id,e)}this.store.dispatch(this.lineActions.selectStop(t.id,e)),this.analyticsService.trackLinesAction("line stop selected",{id:t.id,name:t.name})}}openStopSchedule(e,t){be.log("openStopSchedule",{stop:e,stops:this.state.line.displayedLine.stops,lines:this.state.line.selectedSubgroup?this.state.line.selectedSubgroup.lines:[this.selectedLine]}),this.analyticsService.trackLinesAction("view stop schedule",{id:e.id,name:e.name}),this.routingService.updateUrlParams({sid:e.id,sidx:t})}onDayChange(e){this.analyticsService.trackLinesAction("line day change",{day:e.text}),this.store.dispatch(this.lineActions.loadLineGroup(this.state.line.lineGroup.lineGroupId,this.selectedLine.lineId,(0,d.i7)()+Number(e.value)))}getLineTitle(e){let t="";if(!e)return t;const{origin:n,destination:i,type:r,title:o,presentationLine:a}=e;if(t=r===l.SP.SUBGROUP?o:n&&i?`${n} ${this.lineTemplateService.getArrowDelimiterToken()} ${i}`:n||i,!t){const e=null==a?void 0:a[c.vU.RideMode];t=o||(null==e?void 0:e.title)||(null==e?void 0:e.subTitle)||""}return t}getTranslateParams(...e){return{param1:e[0]}}getStopElementId(e){var t;return`stop-${null===(t=this.state.line.displayedLine.stops[e])||void 0===t?void 0:t.id}-${e}`}get ariaSelectedStop(){return this.state.line.selectedStopId?this.getStopElementId(this.state.line.selectedStopIndex):null}isSelectedStop(e,t){return this.state.line.selectedStopId===e&&this.state.line.selectedStopIndex===t}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.Z),r.Y36(v.Z),r.Y36(L),r.Y36(A.z),r.Y36(M.d),r.Y36(I.J),r.Y36(E.y),r.Y36(C.p),r.Y36(D.F),r.Y36(P.$),r.Y36(k.sK),r.Y36(O.N),r.Y36(N.$),r.Y36(r.SBq),r.Y36(a.K0),r.Y36(R.Y),r.Y36($.mi))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-line-view"]],viewQuery:function(e,t){if(1&e&&(r.Gf(G,5),r.Gf(m.p6,5)),2&e){let e;r.iGM(e=r.CRH())&&(t.backButton=e.first),r.iGM(e=r.CRH())&&(t.trigger=e.first)}},decls:5,vars:5,consts:[["class","lines-header-container",4,"ngIf"],["class","stops-list","role","list",4,"ngIf"],[4,"ngIf"],["class","empty-results",4,"ngIf"],[3,"qrCodeParams",4,"ngIf"],[1,"lines-header-container"],["class","date-header",4,"ngIf"],[1,"line-group-header"],[1,"line-group-header-inner"],[1,"black-fill",3,"backClick"],[1,"line-info-wrapper"],[1,"line-image",3,"innerHTML"],[1,"line-names"],["class","line-title","role","heading","aria-level","1",4,"ngIf"],["class","line-subtitle","role","heading","aria-level","2",4,"ngIf"],[3,"showCaption",4,"ngIf"],["tabindex","0","class","alert",3,"click","keydown.enter",4,"ngIf"],[1,"line-container"],[1,"line-header"],["class","line-name","aria-hidden","false","style","",4,"ngIf"],["class","dropdown-menu",4,"ngIf"],["class","options-nav",4,"ngIf"],[1,"date-header"],["role","heading","aria-level","1",1,"line-title"],["role","heading","aria-level","2",1,"line-subtitle"],[3,"showCaption"],["tabindex","0",1,"alert",3,"click","keydown.enter"],["aria-hidden","false",1,"line-name"],["id","line-name","role","heading","aria-level","2"],[1,"dropdown-menu"],[4,"ngIf","ngIfElse"],["desktopLineDirectionsMenu",""],[1,"menu-label"],["src","images/icons/expand_white.svg","mvAccessibleSVG","",3,"titleText"],[1,"lines-dropdown",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"lines-dropdown",3,"matMenuTriggerFor"],["tabindex","0"],["optionsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"options-nav"],[1,"step-nav-nextprev-container"],[1,"step-nav-prev",3,"click"],["src","images/icons/tab-arrow.svg","mvAccessibleSVG","",3,"titleText"],[1,"step-nav-next",3,"click"],[1,"options"],[1,"line-option-title"],["class","option",3,"selected","click",4,"ngFor","ngForOf"],[1,"option",3,"click"],["role","list",1,"stops-list"],[3,"message"],["class","stop-item","role","listitem","tabindex","0",3,"selected","id","click","keydown.enter",4,"ngFor","ngForOf"],["role","listitem","tabindex","0",1,"stop-item",3,"id","click","keydown.enter"],[1,"title"],["class","additional-times",4,"ngIf"],["tabindex","0",3,"click","keydown.enter",4,"ngIf"],["class","arrivals",4,"ngIf"],[1,"additional-times"],[1,"label"],[1,"times"],["tabindex","0",3,"click","keydown.enter"],[1,"arrivals"],["class","arrival-description",4,"ngIf"],[1,"current"],["class","realtime",4,"ngIf"],[1,"arrival-description"],[1,"realtime"],[1,"realtime-icon"],["role","status",1,"empty-results"],["src","images/error-states/img_empty_state_omni.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],[1,"message"],[1,"empty-results"],["role","status",1,"message"],[1,"change-time"],[1,"dropdown-menu","time-options"],[3,"qrCodeParams"]],template:function(e,t){1&e&&(r.YNc(0,ae,19,15,"div",0),r.YNc(1,me,3,3,"div",1),r.YNc(2,ge,9,6,"ng-container",2),r.YNc(3,ve,11,8,"div",3),r.YNc(4,ye,1,1,"mv-qr-code-banner",4)),2&e&&(r.Q6J("ngIf",!t.state.global.isLoading&&t.state.line.selectedLine),r.xp6(1),r.Q6J("ngIf",null==t.state.line.displayedLine?null:t.state.line.displayedLine.stops),r.xp6(1),r.Q6J("ngIf",t.shouldShowNoLine),r.xp6(1),r.Q6J("ngIf",t.shouldShowEmptyState),r.xp6(1),r.Q6J("ngIf",t.platformService.isDesktop&&!t.state.global.isLoading&&!t.shouldShowEmptyState))},directives:[a.O5,Y.W,F.N,B.bk,U.m,Z.EJ,Z.JJ,Z.On,a.sg,Z.YN,Z.Kr,m.p6,m.VK,m.OP,j.Q,V.Y],pipes:[H.z,a.Ov,k.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-line-view{display:flex;flex-direction:column;background:#FFFFFF;height:100%;-webkit-overflow-scrolling:touch}mv-line-view .spinner{margin-top:50px;text-align:center}mv-line-view .dropdown-menu{position:relative;display:inline-block}mv-line-view .dropdown-menu .lines-dropdown{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9;padding:4px 0}html[dir=ltr] mv-line-view .dropdown-menu .lines-dropdown{left:0}html[dir=rtl] mv-line-view .dropdown-menu .lines-dropdown{right:0}mv-line-view .dropdown-menu .lines-dropdown:focus+span{outline:auto}mv-line-view .lines-header-container{width:100%;background-color:#fff;z-index:3}html body.mobile mv-line-view .lines-header-container{top:4.7058823529rem}html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-line-view .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body.mobile mv-line-view .lines-header-container{top:2.4705882353rem}html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(2.4705882353rem + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(2.4705882353rem + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body[data-top-banner^=V].mobile:not([class*=c_]) mv-line-view .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.4705882353rem + 60px)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}body.mobile mv-line-view .lines-header-container{position:fixed}mv-line-view .date-header{background-color:#ecf0f1;box-sizing:border-box;display:block;line-height:1;overflow:hidden;padding:7px 20px 5px;text-overflow:ellipsis;font-size:.9411764706rem;color:#292a30;white-space:nowrap;width:100%}mv-line-view .line-group-header{display:flex;padding:13px 20px;position:relative;font-size:.8235294118rem;min-height:27px;width:100%;box-sizing:border-box}html[dir=ltr] mv-line-view .line-group-header{padding-left:40px}html[dir=rtl] mv-line-view .line-group-header{padding-right:40px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .line-group-header{padding:11px 20px 10px;min-height:20px}}body.mobile mv-line-view .line-group-header .line-group-header-inner{flex-grow:1;align-self:center}mv-line-view .line-group-header .line-info-wrapper{display:flex;align-items:center;flex-grow:1}mv-line-view .line-group-header .line-info-wrapper div:only-child{font-size:.9411764706rem}mv-line-view .line-group-header .line-info-wrapper mv-share{display:none}mv-line-view .line-group-header .line-image{display:table-cell;vertical-align:top}html[dir=ltr] mv-line-view .line-group-header .line-image{padding-right:10px}html[dir=rtl] mv-line-view .line-group-header .line-image{padding-left:10px}mv-line-view .line-group-header .line-image svg-icon{margin:0}mv-line-view .line-group-header .line-names{flex-grow:1}mv-line-view .line-group-header .line-title{font-size:.9411764706rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .line-group-header .line-title{padding-top:0}}mv-line-view .line-group-header .line-subtitle{font-size:.8235294118rem}mv-line-view .line-group-header.long-line-name .alert{content:url(/images/icons/alert-circle-orange.svg);background:none;width:18px;border-radius:0}html[dir=ltr] mv-line-view .line-group-header.long-line-name .alert{padding-left:14px}html[dir=rtl] mv-line-view .line-group-header.long-line-name .alert{padding-right:14px}html[dir=ltr] mv-line-view .line-group-header.long-line-name .alert{padding-right:0}html[dir=rtl] mv-line-view .line-group-header.long-line-name .alert{padding-left:0}mv-line-view .line-group-header.long-line-name .alert:hover{background:none}mv-line-view .line-group-header .alert{font-size:.8235294118rem;color:#292a30;background:#c6522c;min-height:14px;width:-webkit-min-content;width:-moz-min-content;width:min-content;border-radius:20px;color:#fff;cursor:pointer;display:inline-block;margin:5px 0;outline-color:#302e2e;padding:6px 8px;position:relative;vertical-align:middle;transition:all,.3s;line-height:1}html[dir=ltr] mv-line-view .line-group-header .alert{padding-right:18px}html[dir=rtl] mv-line-view .line-group-header .alert{padding-left:18px}html[dir=ltr] mv-line-view .line-group-header .alert{padding-left:24px}html[dir=rtl] mv-line-view .line-group-header .alert{padding-right:24px}html[dir=ltr] mv-line-view .line-group-header .alert{margin-left:5px}html[dir=rtl] mv-line-view .line-group-header .alert{margin-right:5px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .line-group-header .alert{position:absolute;top:0}html[dir=ltr] mv-line-view .line-group-header .alert{right:60px}html[dir=rtl] mv-line-view .line-group-header .alert{left:60px}}mv-line-view .line-group-header .alert:before{background:url(/images/icons/alert-circle.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:12px;position:absolute;top:50%;vertical-align:middle;width:12px;transform:translateY(-50%)}html[dir=ltr] mv-line-view .line-group-header .alert:before{left:8px}html[dir=rtl] mv-line-view .line-group-header .alert:before{right:8px}html[dir=ltr] mv-line-view .line-group-header .alert:before{margin-right:6px}html[dir=rtl] mv-line-view .line-group-header .alert:before{margin-left:6px}html[dir=ltr] mv-line-view .line-group-header .alert:before{left:7px}html[dir=rtl] mv-line-view .line-group-header .alert:before{right:7px}mv-line-view .line-group-header .alert:after{background:url(/images/icons/alert-arrow.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:9px;position:absolute;top:50%;vertical-align:middle;width:5px;transform:translateY(-50%)}html[dir=ltr] mv-line-view .line-group-header .alert:after{right:8px}html[dir=rtl] mv-line-view .line-group-header .alert:after{left:8px}html[dir=rtl] mv-line-view .line-group-header .alert:after{transform:scaleX(-1);top:10px}mv-line-view .line-group-header .alert:hover{background:#d35f39}mv-line-view .line-group-header .alert:focus{outline:#302E2E auto 1px}body.mobile mv-line-view mv-back-button{display:none}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view mv-back-button{display:block}}mv-line-view .line-container .line-header{background:#292A30;padding:20px;position:relative}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .line-container .line-header{padding:10px 20px;display:flex;justify-content:space-between}}mv-line-view .line-container .line-header .line-name{color:#fff;line-height:1}mv-line-view .line-container .line-header .line-name span{display:block;font-size:.9411764706rem;width:100%}mv-line-view .line-container .line-header .lines{font-size:.7058823529rem;margin:0;padding:0}mv-line-view .line-container .line-header .lines a{display:inline-block;color:#0895e4;padding-top:4px;text-decoration:none;transition:all .3s}mv-line-view .line-container .line-header .lines a:hover{color:#28adf7}mv-line-view .line-container .line-header .lines a:hover .cls-1{fill:#28adf7}mv-line-view .line-container .line-header .lines a svg-icon{height:10px;width:10px}html[dir=ltr] mv-line-view .line-container .line-header .lines a svg-icon{margin-left:2px}html[dir=rtl] mv-line-view .line-container .line-header .lines a svg-icon{margin-right:2px}mv-line-view .line-container .line-header .lines a svg-icon .cls-1{fill:#0895e4;transition:all .3s}mv-line-view .line-container .line-header .dropdown-menu .menu-label{color:#0a93ff;font-size:.7058823529rem}mv-line-view .line-container .line-header .dropdown-menu svg-icon{width:10px;height:10px}html[dir=ltr] mv-line-view .line-container .line-header .dropdown-menu svg-icon{margin-left:2px}html[dir=rtl] mv-line-view .line-container .line-header .dropdown-menu svg-icon{margin-right:2px}mv-line-view .line-container .line-header .dropdown-menu svg-icon svg .cls-1{fill:#0895e4}mv-line-view .options-nav{border-bottom:solid 1px #BDC3C7;padding:5px 0 0;position:relative;text-align:center}mv-line-view .options-nav a.disabled{opacity:.5}mv-line-view .options-nav .step-nav-nextprev-container svg-icon svg{fill:#0000008a}mv-line-view .options-nav .step-nav-prev{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-line-view .options-nav .step-nav-prev{left:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-prev{right:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-prev svg-icon{transform:scaleX(-1)}mv-line-view .options-nav .step-nav-next{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-line-view .options-nav .step-nav-next{right:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-next{left:13px}mv-line-view .options-nav .step-nav-next svg-icon{transform:rotate(180deg)}html[dir=rtl] mv-line-view .options-nav .step-nav-next svg-icon{transform:rotate(0)}mv-line-view .options-nav .options{margin:0 40px;position:relative}mv-line-view .options-nav .options .line-option-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}mv-line-view .options-nav .options .option{background-color:#bdc3c7;border-radius:50%;cursor:pointer;display:inline-block;height:4px;outline:none;padding:0;position:relative;top:-3px;width:4px}html[dir=ltr] mv-line-view .options-nav .options .option{margin-right:5px}html[dir=rtl] mv-line-view .options-nav .options .option{margin-left:5px}html[dir=ltr] mv-line-view .options-nav .options .option:last-of-type{margin-right:0}html[dir=rtl] mv-line-view .options-nav .options .option:last-of-type{margin-left:0}mv-line-view .options-nav .options .option.selected{background-color:#f0500c}mv-line-view .stops-list{flex-grow:1;overflow:hidden}mv-line-view .stops-list mv-updates-message .updates-message-wrapper{margin-bottom:0}.has-back-home mv-line-view .stops-list{padding-bottom:0}mv-line-view .stops-list .stop-item{box-sizing:border-box;cursor:pointer;display:table;height:55px;padding:10px 20px;position:relative;width:100%;background-color:#fff}html[dir=ltr] mv-line-view .stops-list .stop-item{padding-left:52px}html[dir=rtl] mv-line-view .stops-list .stop-item{padding-right:52px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .stops-list .stop-item{height:45px}}mv-line-view .stops-list .stop-item:focus{outline:#302E2E auto 1px}mv-line-view .stops-list .stop-item:before{content:"";border-left:solid 3px black;height:100%;position:absolute;top:0}html[dir=ltr] mv-line-view .stops-list .stop-item:before{left:27px}html[dir=rtl] mv-line-view .stops-list .stop-item:before{right:27px}mv-line-view .stops-list .stop-item:after{background-color:#fff;border:solid 4px #292A30;border-radius:50%;content:"";height:5px;position:absolute;top:22px;transition:background-color .3s ease;width:5px}html[dir=ltr] mv-line-view .stops-list .stop-item:after{left:22px}html[dir=rtl] mv-line-view .stops-list .stop-item:after{right:22px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-view .stops-list .stop-item:after{top:17px}}mv-line-view .stops-list .stop-item:first-of-type:before{height:calc(100% - 28px);top:28px}mv-line-view .stops-list .stop-item:last-of-type{margin-bottom:10px}mv-line-view .stops-list .stop-item:last-of-type:before{height:28px}mv-line-view .stops-list .stop-item:hover{background-color:#f5f7f7}mv-line-view .stops-list .stop-item.selected .title{font-weight:bold}mv-line-view .stops-list .stop-item.selected a,mv-line-view .stops-list .stop-item.selected .additional-times{display:inline-block}mv-line-view .stops-list .stop-item.selected a:focus,mv-line-view .stops-list .stop-item.selected .additional-times:focus{outline:#302E2E auto 1px}mv-line-view .stops-list .stop-item.selected:after{background-color:#292a30}mv-line-view .stops-list .stop-item.passed{color:#bdc3c7}mv-line-view .stops-list .stop-item>div{display:table-cell;vertical-align:middle}mv-line-view .stops-list .stop-item .title{font-size:.9411764706rem}mv-line-view .stops-list .stop-item a{color:#0078d6;display:none;font-size:.7058823529rem;text-decoration:underline;transition:all .3s}mv-line-view .stops-list .stop-item a:hover,mv-line-view .stops-list .stop-item a:focus{color:#005ba3}mv-line-view .stops-list .stop-item .arrival-description{font-size:.7058823529rem}mv-line-view .stops-list .stop-item .additional-times{display:none;font-size:.7058823529rem}mv-line-view .stops-list .stop-item .arrivals{display:table-cell;min-width:70px}html[dir=ltr] mv-line-view .stops-list .stop-item .arrivals{text-align:right}html[dir=rtl] mv-line-view .stops-list .stop-item .arrivals{text-align:left}mv-line-view .stops-list .stop-item .arrivals .real-time{color:#038844}mv-line-view .stops-list .stop-item .arrivals .current{font-size:.8235294118rem}mv-line-view .stops-list .stop-item .arrivals .current .realtime{color:#038844}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon{background:none;border-radius:50%;display:inline-block;height:4px;transform:translateY(-50%);width:4px}html[dir=rtl] mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon{transform:translateY(-50%) scaleX(-1)}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:10px;position:absolute;right:-6px;top:-5px;width:10px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:before{-webkit-animation:none;animation:none}}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:16px;position:absolute;right:-8px;top:-8px;width:16px;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:after{-webkit-animation:none;animation:none}}mv-line-view .stops-list .stop-item .arrivals .next{color:#bdc3c7;font-size:.7058823529rem}mv-line-view .empty-results{padding:0 20px 20px;text-align:center}mv-line-view .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;padding:20px}mv-line-view .empty-results .icon{width:32px;height:32px}mv-line-view .empty-results .change-time{display:inline-block}mv-line-view .empty-results .change-time .dropdown-menu{margin-top:30px}mv-line-view .empty-results .change-time .dropdown-menu .dropdown-list{top:-6px}mv-line-view .empty-results .change-time .menu-label{border:solid 1px #0895E4;border-radius:5px;color:#0895e4;padding:5px 10px;text-decoration:none;font-size:.8235294118rem}.app-container.desktop.lines.lines-view mv-header .header{height:3.8235294118rem;min-height:3.8235294118rem}.app-container.desktop.lines.lines-view mv-line-view .stops-list{overflow:scroll}\n'],encapsulation:2}),e})();var Te=n(13691),Se=n(52959),xe=n(47111),we=n(86607);const ke=["backButton"],Me=["future-arrival"];function Le(e,t){1&e&&(r.TgZ(0,"div",17),r.TgZ(1,"div",18),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"line_detail_empty_options_selected_time")))}function Ae(e,t){if(1&e&&(r.TgZ(0,"option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("ngValue",e),r.xp6(1),r.hij(" ",e.text," ")}}function Ie(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"select",19),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().onDayChange(t)}),r.YNc(2,Ae,2,2,"option",20),r.qZA(),r.BQk()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngModel",e.selectedDay),r.xp6(1),r.Q6J("ngForOf",e.dayOptions)}}function Ee(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onDayChange(t)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",e.text," ")}}function Ce(e,t){if(1&e&&(r._UZ(0,"button",22),r.TgZ(1,"mat-menu",23,24),r.YNc(3,Ee,2,1,"button",25),r.qZA()),2&e){const e=r.MAs(2),t=r.oxw();r.Q6J("matMenuTriggerFor",e),r.xp6(3),r.Q6J("ngForOf",t.dayOptions)}}function De(e,t){if(1&e&&(r.TgZ(0,"div",27),r.TgZ(1,"div",28),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"span"),r._uU(6),r.ALo(7,"unixtime"),r.qZA(),r.qZA(),r.TgZ(8,"div",29),r.TgZ(9,"span"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"span"),r._uU(13),r.ALo(14,"unixtime"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,4,"ls_first")),r.xp6(3),r.Oqu(r.lcZ(7,6,e.firstArrivalTime)),r.xp6(4),r.Oqu(r.lcZ(11,8,"ls_last")),r.xp6(3),r.Oqu(r.lcZ(14,10,e.lastArrivalTime))}}function Pe(e,t){if(1&e&&(r.TgZ(0,"div",30),r._UZ(1,"span",31),r.ALo(2,"safeHtml"),r.ALo(3,"async"),r.ALo(4,"asyncify"),r.TgZ(5,"span",32),r._uU(6),r.qZA(),r.TgZ(7,"span",33),r._uU(8),r.ALo(9,"unixtime"),r.qZA(),r.qZA()),2&e){const e=t.$implicit,n=r.oxw();r.ekj("future",n.isFuture(e.arrivalTime)),r.xp6(1),r.Q6J("innerHTML",r.lcZ(2,5,r.lcZ(3,7,r.lcZ(4,9,n.lineImageHtml))),r.oJD),r.xp6(5),r.Oqu(e.lineDestination),r.xp6(2),r.Oqu(r.lcZ(9,11,e.arrivalTime))}}const Oe=(0,u.hu)("StopArrivalsComponent");let Ne=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d,u,p){this.store=e,this.storeHelper=t,this.routingService=n,this.lineService=i,this.lineActions=r,this.analyticsService=o,this.canonicalService=a,this.el=s,this.translate=l,this.universal=c,this.a11y=d,this._cd=u,this.platformService=p,this.selectedDay={},this.completedInitialFocus=!1,this.stopArrivals=[],this.subscribes=[],this.trackByIndex=Te.z8}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){if(yield(0,Se.p5)(this.store),this.state.metro.currentConditions.minimalData)return Oe.log("Metro with minimalData (community) detected, directing back to Line View"),void this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([],i.zA.LINES_VIEW));this.lineService.populateDayOptions(!0),this.refreshFocus(),this.subscribes.push(this.storeHelper.subscribe("global.isLoading",()=>{this.state.global.isLoading||this.refreshFocus()})),this.stopArrivals=this.setStopArrivals(),this.subscribes.push(this.storeHelper.subscribe("line",()=>{this.stopArrivals=this.setStopArrivals()}))})}ngAfterViewChecked(){!this.completedInitialFocus&&this.backButton&&this.a11y.byEnter&&(this.backButton.nativeElement.focus(),this.completedInitialFocus=!0)}ngOnDestroy(){this.subscribes.forEach(e=>e())}get state(){return this.store.getState()}get isLoading(){return this.state.global.isLoading}get emptyState(){return this.state.global.appIsReady&&!this.stopArrivals&&this.universal.isBrowser}get stop(){return this.state.line.displayedLine&&this.state.line.displayedLine.stops[this.state.line.selectedStopIndex]||{}}setStopArrivals(){var e;const{displayedLine:t,selectedStopIndex:n,selectedLine:i}=this.state.line;if(!(null===(e=this.stop)||void 0===e?void 0:e.id)||!(null==t?void 0:t.stopArrivals))return null;if(null==n||-1===n||!(null==i?void 0:i.lineOptions))return t.stopArrivals[this.stop.id];const r=t.stops.map((e,t)=>e.id===this.stop.id?t:null).filter(e=>null!==e),o=r.length,a=1===r.length?0:r.findIndex(e=>e===n);let{lineOptions:s}=i;o>1&&(s.every(e=>e.stops.filter(e=>e.id===this.stop.id).length===o)||(s=s.filter(e=>e.patternId===t.patternId)));const l=new Map;return s.forEach(e=>{let t=e.stopArrivals[this.stop.id];if(t){if(o>1){const n=e.stops.map((e,t)=>e.id===this.stop.id?t:null).filter(e=>null!==e)[a];t=t.filter(e=>e.stopIndex===n)}t.forEach(e=>{l.set(e.arrivalTime,e)})}}),Array.from(l.values()).sort((e,t)=>e.arrivalTime-t.arrivalTime)}get firstArrivalTime(){return this.stopArrivals&&this.stopArrivals.length&&this.stopArrivals[0].arrivalTime}get lastArrivalTime(){return this.stopArrivals&&this.stopArrivals.length&&this.stopArrivals[this.stopArrivals.length-1].arrivalTime}get dayOptions(){return this.lineService.dayOptions}get lineImageHtml(){return this.state.line.lineGroup.imageHtml}refreshFocus(){this.setSelectedDay(),this.scrollToRelevantArrival()}setSelectedDay(){const e=(0,d.ry)(this.state.line.selectedDayOffset);this.selectedDay=this.dayOptions.find(t=>Number(t.value)===e)||this.dayOptions[0]}isFuture(e){return e>S().unix()}goBack(){return(0,s.mG)(this,void 0,void 0,function*(){yield this.onDayChange(this.dayOptions[0]),this.routingService.updateUrlParams({sid:null,sidx:null})})}getDayDisplayText(e){return 0===Number(e.value)?this.translate.instant("today"):1===Number(e.value)?this.translate.instant("tomorrow"):e.text}onDayChange(e){return(0,s.mG)(this,void 0,void 0,function*(){this.selectedDay=e,this.analyticsService.trackLinesAction("stop day change",{day:e.text}),yield this.store.dispatch(this.lineActions.setStopArrivalsDay((0,d.w3)(Number(e.value)))),this.store.dispatch(this.lineActions.restoreStopFromUrl())})}scrollToRelevantArrival(){setTimeout(()=>{const e=this.el.nativeElement.querySelector(".future");e&&!this._cd.destroyed&&document.querySelector("html").scrollTo(0,e.offsetTop-130)},500)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(M.d),r.Y36(O.N),r.Y36(o.Z),r.Y36(v.Z),r.Y36(I.J),r.Y36(E.y),r.Y36(A.z),r.Y36(r.SBq),r.Y36(k.sK),r.Y36(C.p),r.Y36(D.F),r.Y36(r.sBO),r.Y36($.mi))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-stop-arrivals"]],viewQuery:function(e,t){if(1&e&&(r.Gf(ke,5),r.Gf(m.p6,5),r.Gf(Me,5,r.SBq)),2&e){let e;r.iGM(e=r.CRH())&&(t.backButton=e.first),r.iGM(e=r.CRH())&&(t.trigger=e.first),r.iGM(e=r.CRH())&&(t.futureArrivals=e)}},decls:26,vars:14,consts:[["class","empty-results","role","status",4,"ngIf"],[1,"stop-arrivals-header"],[1,"line-group-header"],["tabindex","0",1,"back-link",3,"click","keydown.enter"],["backButton",""],["role","heading","aria-level","1",1,"line-title"],[1,"line-stop-container"],[1,"line-stop-header"],[1,"day-title"],[1,"title"],[1,"change-time"],[4,"ngIf","ngIfElse"],["desktopChangeTimeMenu",""],["src","images/icons/expand_white.svg","mvAccessibleSVG","",3,"titleText"],["class","firstLast",4,"ngIf"],["role","list",1,"arrivals-list"],["class","arrival-item","role","listitem",3,"future",4,"ngFor","ngForOf","ngForTrackBy"],["role","status",1,"empty-results"],[1,"message"],[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"overlay-selection",3,"matMenuTriggerFor"],["tabindex","0"],["optionsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"firstLast"],[1,"firstInDay"],[1,"lastInDay"],["role","listitem",1,"arrival-item"],[1,"line-image",3,"innerHTML"],[1,"name"],[1,"time"]],template:function(e,t){if(1&e&&(r.YNc(0,Le,4,3,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"a",3,4),r.NdJ("click",function(){return t.goBack()})("keydown.enter",function(){return t.goBack()}),r.qZA(),r.TgZ(5,"div"),r.TgZ(6,"span",5),r._uU(7),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",6),r.TgZ(9,"div",7),r.TgZ(10,"div",8),r.TgZ(11,"span",9),r.TgZ(12,"span"),r._uU(13),r.qZA(),r.qZA(),r.TgZ(14,"div",10),r.YNc(15,Ie,3,2,"ng-container",11),r.YNc(16,Ce,4,2,"ng-template",null,12,r.W1O),r.TgZ(18,"a"),r._uU(19),r.ALo(20,"translate"),r._UZ(21,"svg-icon",13),r.ALo(22,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(23,De,15,12,"div",14),r.qZA(),r.qZA(),r.qZA(),r.TgZ(24,"div",15),r.YNc(25,Pe,10,13,"div",16),r.qZA()),2&e){const e=r.MAs(17);r.Q6J("ngIf",t.emptyState),r.xp6(7),r.Oqu(t.stop.name),r.xp6(6),r.Oqu(t.getDayDisplayText(t.selectedDay)),r.xp6(2),r.Q6J("ngIf",t.platformService.isMobile)("ngIfElse",e),r.xp6(4),r.hij(" ",r.lcZ(20,10,"line_change_time")," "),r.xp6(2),r.s9C("titleText",r.lcZ(22,12,"line_change_time")),r.xp6(2),r.Q6J("ngIf",!t.emptyState),r.xp6(2),r.Q6J("ngForOf",t.stopArrivals)("ngForTrackBy",t.trackByIndex)}},directives:[a.O5,B.bk,U.m,a.sg,Z.EJ,Z.JJ,Z.On,Z.YN,Z.Kr,m.p6,m.VK,m.OP],pipes:[k.X$,xe.T0,H.z,a.Ov,we.N],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-stop-arrivals{display:flex;flex-direction:column;height:100%;overflow:hidden}mv-stop-arrivals .spinner{margin-top:50px;text-align:center;height:100%}mv-stop-arrivals .date-header{padding:5px 20px;background-color:#ecf0f1}mv-stop-arrivals .stop-arrivals-header{width:100%;z-index:1}html body.mobile mv-stop-arrivals .stop-arrivals-header{top:0px}html.privacy-notice body.mobile mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,body[data-top-banner^=V].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,body[data-top-banner^=V].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px + 4.7058823529rem)}}body.mobile mv-stop-arrivals .stop-arrivals-header{position:fixed}mv-stop-arrivals .line-group-header{box-sizing:border-box;min-height:54px;padding:15px 20px 13px;position:relative;font-size:.8235294118rem;background-color:#ecf0f1}html[dir=ltr] mv-stop-arrivals .line-group-header{padding-left:40px}html[dir=rtl] mv-stop-arrivals .line-group-header{padding-right:40px}mv-stop-arrivals .line-group-header>div{display:table;height:inherit;vertical-align:top}mv-stop-arrivals .line-group-header .line-image{display:table-cell}html[dir=ltr] mv-stop-arrivals .line-group-header .line-image{padding-right:15px}html[dir=rtl] mv-stop-arrivals .line-group-header .line-image{padding-left:15px}mv-stop-arrivals .line-group-header .line-image line-svg{margin:0}mv-stop-arrivals .line-group-header .line-title{display:table-cell;padding-top:5px;vertical-align:top;width:100%}mv-stop-arrivals .back-link{color:#292a30;height:100%;position:absolute;padding:0 16px;top:0;z-index:1}html[dir=ltr] mv-stop-arrivals .back-link{left:0}html[dir=rtl] mv-stop-arrivals .back-link{right:0}mv-stop-arrivals .back-link:focus{outline:none}mv-stop-arrivals .back-link:focus:before{outline:auto}mv-stop-arrivals .back-link:hover:before{outline:none}mv-stop-arrivals .back-link:before{content:url(/images/icons/arrow_gray.svg);display:block;position:relative;top:50%;width:7px;height:15px;padding:3px;transform:scaleX(-1) translateY(-50%)}html[dir=rtl] mv-stop-arrivals .back-link:before{transform:scale(1) translateY(-50%)}mv-stop-arrivals .line-stop-container .line-stop-header{box-sizing:border-box;display:table;padding:20px;background:#292A30;position:relative;width:100%}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-stop-arrivals .line-stop-container .line-stop-header{padding:10px 20px}}mv-stop-arrivals .line-stop-container .line-stop-header .day-title{display:table-cell;vertical-align:middle}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-stop-arrivals .line-stop-container .line-stop-header .day-title{display:flex}}mv-stop-arrivals .line-stop-container .line-stop-header .day-title .title{text-transform:capitalize;color:#fff;font-size:.9411764706rem}mv-stop-arrivals .line-stop-container .line-stop-header .change-time{padding:0;margin:0;font-size:.7058823529rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-stop-arrivals .line-stop-container .line-stop-header .change-time{margin:0 10px}}mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{height:10px;width:10px}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{margin-left:2px}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{margin-right:2px}mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon .cls-1{fill:#0a93ff;transition:all .3s}mv-stop-arrivals .line-stop-container .line-stop-header .change-time select{position:absolute;opacity:0}mv-stop-arrivals .line-stop-container .line-stop-header .change-time select:focus+a{outline:auto}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a{color:#0a93ff;display:inline-block;text-decoration:none;padding-top:4px;transition:all .3s}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a:hover{color:#28adf7}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a:hover .cls-1{fill:#28adf7}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{color:#fff;display:table-cell;vertical-align:middle}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{text-align:right}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{text-align:left}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast span{display:block}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{display:inline-block;text-align:left;text-align:initial}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{margin-right:20px}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{margin-left:20px}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay span:first-of-type{font-size:.7058823529rem}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{display:inline-block}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{text-align:left}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{text-align:right}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay span:first-of-type{font-size:.7058823529rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay,mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{display:inline-flex}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{font-size:inherit}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{margin-right:5px}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{margin-left:5px}}mv-stop-arrivals .destination-filter-container{padding:18px 20px;position:relative}mv-stop-arrivals .destination-filter-container .input-icon,mv-stop-arrivals .destination-filter-container .clear-icon{cursor:pointer;outline:none;position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-stop-arrivals .destination-filter-container .input-icon,html[dir=ltr] mv-stop-arrivals .destination-filter-container .clear-icon{right:30px}html[dir=rtl] mv-stop-arrivals .destination-filter-container .input-icon,html[dir=rtl] mv-stop-arrivals .destination-filter-container .clear-icon{left:30px}mv-stop-arrivals .destination-filter-container .input-icon .icon,mv-stop-arrivals .destination-filter-container .clear-icon .icon{height:16px;width:16px}mv-stop-arrivals .destination-filter-container .input-icon .icon .cls-1,mv-stop-arrivals .destination-filter-container .clear-icon .icon .cls-1{fill:#737578}mv-stop-arrivals .destination-filter-container .button{padding:10px;background-color:#ecf0f1;color:#737578;border-radius:5px;cursor:pointer;outline:none}mv-stop-arrivals .arrivals-list{background:#fff;flex:1;overflow-y:auto}body.mobile mv-stop-arrivals .arrivals-list{margin-top:7.6470588235rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-stop-arrivals .arrivals-list{margin-top:5.8823529412rem}}mv-stop-arrivals .arrivals-list .arrival-item{box-sizing:border-box;display:table;min-height:40px;padding:14px 20px;position:relative;line-height:1.2;width:100%}mv-stop-arrivals .arrivals-list .arrival-item:last-child{margin-bottom:10px}mv-stop-arrivals .arrivals-list.passed{color:#bdc3c7}mv-stop-arrivals .line-image,mv-stop-arrivals .name,mv-stop-arrivals .time{display:table-cell;vertical-align:middle;width:1px}mv-stop-arrivals .time{font-weight:700;white-space:nowrap}mv-stop-arrivals .name{padding:0 8px;width:100%}mv-stop-arrivals .empty-results{text-align:center;padding:85px 20px 20px;position:absolute;top:50%}mv-stop-arrivals .empty-results .message{font-size:.9411764706rem;color:#737578;padding:20px}\n"],encapsulation:2}),e})();function Re(e,t){1&e&&r._UZ(0,"mv-line-view")}function $e(e,t){1&e&&r._UZ(0,"mv-stop-arrivals")}let Ye=(()=>{class e{constructor(e){this.routingService=e,this.SubTabId=i.zA}ngOnInit(){this.refreshRouteData(),this.routingService.onNavigationEnd(()=>this.refreshRouteData())}refreshRouteData(){this.routeData=this.routingService.getCurrentRouteData()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.Z))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-line-router"]],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(r.YNc(0,Re,1,0,"mv-line-view",0),r.YNc(1,$e,1,0,"mv-stop-arrivals",0)),2&e&&(r.Q6J("ngIf",(null==t.routeData?null:t.routeData.subTabId)===t.SubTabId.LINES_VIEW),r.xp6(1),r.Q6J("ngIf",(null==t.routeData?null:t.routeData.subTabId)===t.SubTabId.LINES_STOPARRIVALS))},directives:[a.O5,_e,Ne],encapsulation:2}),e})()},21532:function(e,t,n){"use strict";n.d(t,{$:function(){return l}});var i=n(99528),r=n(17184),o=n(2316),a=n(5971),s=n(26365);let l=(()=>{class e{constructor(e,t){this.store=e,this.metroService=t,this.mapTokenToValue={[i.Z2.LineNumber]:e=>e.lineGroupSummary.lineNumber,[i.Z2.AgencyName]:e=>e.agency.agencyName,[i.Z2.LineLongName]:e=>e.lineSummary.routeLongName,[i.Z2.LineOrigin]:e=>e.lineSummary.origin,[i.Z2.LineDestination]:e=>e.lineSummary.destination,[i.Z2.RouteType]:e=>this.fieldValueForRouteTypeToken(e.agency),[i.Z2.LineGroupCaption1]:e=>e.lineGroupSummary.caption1,[i.Z2.LineGroupCaption2]:e=>e.lineGroupSummary.caption2,[i.Z2.LineSubGroupCaption]:e=>this.fieldValueForSubGroupCaptionToken(e.lineGroupSummary,e.lineSummary)},this.mapDelimiterToToken={[i.wZ.Arrow]:()=>this.getArrowDelimiterToken(),[i.wZ.BiDirectionalArrow]:()=>" \u2194 ",[i.wZ.Dot]:()=>" \u2022 ",6:()=>" - "}}get state(){return this.store.getState()}getAgencyLineTemplate(e,t){if(!e||!e.presentationLineTemplates)return null;const n=e.presentationLineTemplates.find(e=>e.presentationType===t);return n?this.state.metro.currentMetro.templates.find(e=>e.lineTemplateId===n.lineTemplateId):null}getTemplate(e,t,n){const i={title:"",subTitle:""},r=this.metroService.getAgency(t.agencyId),o=this.getAgencyLineTemplate(r,e);if(!o)return i;const a={agency:r,lineGroupSummary:t,lineSummary:n};return i.title=this.stringForTitle(o.titleConditional,a),i.subTitle=this.stringForSubtitle(o,a),i}stringForTitle(e,t){let n;return n=this.convertTokenToString(e.condition.condition,t).length>=e.condition.conditionLength?e.ifGreater:e.ifLess,this.convertTokenToString(n,t)}convertTokenToString(e,t){const n=this.mapTokenToValue[e]&&this.mapTokenToValue[e](t);return null==n?"":n}fieldValueForRouteTypeToken(e){const t=r.Yt.getById(e.routeType);return t?t.name:""}fieldValueForSubGroupCaptionToken(e,t){if(0!==t.subGroupId&&e.subGroups){const n=e.subGroups.find(e=>e.subGroupId===t.subGroupId);if(n)return n.name}}stringForSubtitle(e,t){const n=this.mapDelimiterToToken[e.delimiterToken]&&this.mapDelimiterToToken[e.delimiterToken]()||" ";return e.detailsList.map(e=>this.convertTokenToString(e,t)).filter(e=>e||0==+e).join(n)}getArrowDelimiterToken(){return this.state.global.selectedLocale.rtl?" \u200e\u2190\u200f ":" \u200e\u2192 "}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.d),o.LFG(s.V))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},61056:function(e,t,n){"use strict";n.d(t,{r:function(){return s},g:function(){return l}});var i=n(16438),r=n(13691),o=n(2316),a=n(5971);let s=(()=>{class e{constructor(e){this.store=e}resolve(e){const t=this.store.getState().metro.currentConditions.minimalData;return(0,r.kt)(e.queryParams.sid&&!t?i.zA.LINES_STOPARRIVALS:i.zA.LINES_VIEW)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),l=(()=>{class e{constructor(e){this.store=e}resolve(e){const t=this.store.getState().metro.currentConditions.minimalData;return(0,r.kt)(!!e.queryParams.sid&&!t)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},85501:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(3786),r=n(65492),o=n(43049),a=n(87100),s=n(2316),l=n(99902),c=n(60600),d=n(72249),u=n(5971);let p=(()=>{class e{constructor(e,t,n,i){this.httpService=e,this.alertService=t,this.daysService=n,this.store=i,this.dayOptions=[]}get state(){return this.store.getState()}getLineDetails(e,t,n=!0){return this.httpService.post(r.bl.GetLineDetails,{body:{lineGroupId:e,dayOffset:t||(0,a.i7)(),isExtended:Number(n),revision:this.state.metro.currentMetro.revisionNumber}},!0).toPromise()}getLineAlert(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=e.type===o.SP.SUBGROUP?e.lines.map(e=>e.lineId):[e.lineId],n=yield this.alertService.getRouteAlerts([],t);return n.data&&n.data.length>0?n.data[0]:null})}populateDayOptions(e=!1){this.dayOptions=this.daysService.rebuildDaysList(this.state.metro.maxFutureDays),this.dayOptions.shift(),e&&this.dayOptions.unshift(this.daysService.getToday())}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(l.O),s.LFG(c.c),s.LFG(d.O),s.LFG(u.d))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},3084:function(e,t,n){"use strict";n.d(t,{L:function(){return j}});var i=n(73961),r=n(2316),o=n(5971),a=n(99528),s=n(1437),l=n(7935),c=n(99650),d=n(15208),u=n(54364),p=n(87479),h=n(93975),m=n(53448),g=n(99642),f=n(2339);const v=["lineInput"];function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mv-back-button",9),r.NdJ("backClick",function(){return r.CHM(e),r.oxw().exitSearchDisplay()})("keydown.enter",function(){return r.CHM(e),r.oxw().exitSearchDisplay()}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("tabIndex",e.tabIndex)}}let b=(()=>{class e{constructor(e,t,n,i,r){this.analyticsService=e,this.splashDisplay=t,this.searchActions=n,this.store=i,this.platformService=r,this.lastSearched=""}get state(){return this.store.getState()}get tabIndex(){return null===this.state.directions.search.searchInputTypeFocused?-1:0}onFocus(){this.state.global.splashScreen&&this.splashDisplay.invokeDismissal(),this.store.dispatch(this.searchActions.setSearchInputTypeFocused(a.t2.Line))}exitSearchDisplay(){var e;null===(e=this.lineInput.nativeElement)||void 0===e||e.focus(),window.scrollTo(0,1),this.store.dispatch(this.searchActions.setSearchInputTypeFocused(null))}search(){this.lastSearched!==this.searchInput&&(this.lastSearched=this.searchInput,this.lineListService.search$.next(this.searchInput),this.analyticsService.trackLinesAction("search line",this.searchInput))}clearSearch(){!this.searchInput||(this.searchInput="",this.lineListService.search$.next(""))}onKeydown(e){"Escape"===e.key&&this.exitSearchDisplay()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.y),r.Y36(l.Y),r.Y36(c.P),r.Y36(o.d),r.Y36(d.mi))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-line-search"]],viewQuery:function(e,t){if(1&e&&r.Gf(v,5),2&e){let e;r.iGM(e=r.CRH())&&(t.lineInput=e.first)}},hostBindings:function(e,t){1&e&&r.NdJ("keydown",function(e){return t.onKeydown(e)},!1,r.Jf7)},inputs:{lineListService:"lineListService"},decls:13,vars:14,consts:[["role","search",1,"search-zone"],["class","gray-fill",3,"tabIndex","backClick","keydown.enter",4,"ngIf"],[1,"filter-container"],[1,"input-icon"],["src","images/icons/search.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],["id","lines-filter","type","text","autocomplete","off",1,"lines-filter",3,"placeholder","ngModel","ngModelChange","focus","keyup"],["lineInput",""],[1,"clear-input",3,"click"],["src","images/icons/close.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],[1,"gray-fill",3,"tabIndex","backClick","keydown.enter"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,y,1,1,"mv-back-button",1),r.TgZ(2,"div",2),r.TgZ(3,"span",3),r._UZ(4,"svg-icon",4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"input",5,6),r.NdJ("ngModelChange",function(e){return t.searchInput=e})("focus",function(){return t.onFocus()})("keyup",function(){return t.search()}),r.ALo(8,"translate"),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"a",7),r.NdJ("click",function(){return t.clearSearch()}),r._UZ(11,"svg-icon",8),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.platformService.isMobile),r.xp6(3),r.s9C("titleText",r.lcZ(5,6,"action_search")),r.xp6(2),r.s9C("placeholder",r.lcZ(8,8,"line_search_hint")),r.Q6J("ngModel",t.searchInput),r.uIk("title",r.lcZ(9,10,"line_search_hint")),r.xp6(5),r.s9C("titleText",r.lcZ(12,12,"close")))},directives:[u.O5,p.bk,h.m,m.Fj,m.JJ,m.On,g.W],pipes:[f.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{position:absolute;opacity:0;transform:translate(20px);top:3px}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{left:0}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{right:0}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-header{transform:translateY(-4.7058823529rem)}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-header{transform:translateY(-9.4117647059rem)}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-cookie-banner{transition-delay:.1s;transform:translateY(-4.7058823529rem)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-line-list cdk-virtual-scroll-viewport{height:calc(100vh - 100px)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{transform:translateY(-4.7058823529rem);height:45px;transition:all ease-in-out .3s}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{padding:5px 15px 5px 22px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{padding:5px 22px 5px 15px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{transform:translateY(-2.4705882353rem)}}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{transform:translateY(-160px)}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{transform:translateY(calc(-2.4705882353rem - 2.9411764706rem))}}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{opacity:1;transform:translate(0);transition:all .3s ease-in-out .6s}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{background-color:#fff;height:33px;border-radius:4px;border-bottom:1px solid transparent;transition:all .3s ease-in-out .3s}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{padding:1px 20px 1px 40px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{padding:1px 40px 1px 20px}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{margin-left:30px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{margin-right:30px}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container input{position:relative;height:33px;outline:0;margin:0;color:#292a30;transition:all .3s ease-in-out,color .2s .3s;box-sizing:border-box;padding:5px 8px}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container .input-icon{transition:transform .3s ease-in-out;transform:translateY(-.4117647059rem)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main .content-container{margin-top:45px;transition:margin-top .3s ease-in-out}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main .content-container{margin-top:45px}mv-line-search .search-zone{width:100%;height:81px;z-index:4;background-color:#292a30;padding:34px 20px 20px;box-sizing:border-box;transition:all ease-in-out .3s}mv-line-search .search-zone input:-webkit-autofill,mv-line-search .search-zone input:-webkit-autofill:hover,mv-line-search .search-zone input:-webkit-autofill:focus,mv-line-search .search-zone textarea:-webkit-autofill,mv-line-search .search-zone textarea:-webkit-autofill:hover,mv-line-search .search-zone textarea:-webkit-autofill:focus,mv-line-search .search-zone select:-webkit-autofill,mv-line-search .search-zone select:-webkit-autofill:hover,mv-line-search .search-zone select:-webkit-autofill:focus{-webkit-box-shadow:0 0 0 30px #292A30 inset}html body.mobile mv-line-search .search-zone{top:calc(0px + 4.7058823529rem)}html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-line-search .search-zone,body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 4.7058823529rem)}}body.mobile mv-line-search .search-zone{position:fixed}body.desktop mv-line-search .search-zone{position:relative}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-line-search .search-zone{padding:15px 20px 20px;height:60px}html body.mobile mv-line-search .search-zone{top:2.4705882353rem}html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(2.4705882353rem + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(2.4705882353rem + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body[data-top-banner^=V].mobile:not([class*=c_]) mv-line-search .search-zone,body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(2.4705882353rem + 60px)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}mv-line-search .search-zone:after{bottom:0;box-shadow:0 2px 3px -1px #0000004d;content:"";display:block;height:10px;left:0;position:absolute;width:100%;z-index:9}mv-line-search .search-zone .filter-container{border-bottom:1px solid #525357;position:relative}html[dir=ltr] mv-line-search .search-zone .filter-container{padding-right:26px}html[dir=rtl] mv-line-search .search-zone .filter-container{padding-left:26px}html[dir=ltr] mv-line-search .search-zone .filter-container{padding-left:36px}html[dir=rtl] mv-line-search .search-zone .filter-container{padding-right:36px}mv-line-search .search-zone .filter-container:hover .clear-input{opacity:1}mv-line-search .search-zone .filter-container .input-icon{position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-line-search .search-zone .filter-container .input-icon{left:9px}html[dir=rtl] mv-line-search .search-zone .filter-container .input-icon{right:9px}mv-line-search .search-zone .filter-container .input-icon .icon{height:16px;width:16px}mv-line-search .search-zone .filter-container .input-icon .icon .cls-1{fill:#bdc3c7}mv-line-search .search-zone .filter-container input{background:none;border:none;color:#292a30;color:#fff;height:24px;line-height:24px;font-size:.9411764706rem}mv-line-search .search-zone .filter-container input:focus{outline:none;width:200px;transition:all .3s}mv-line-search .search-zone .filter-container input::-moz-placeholder{color:#929191}mv-line-search .search-zone .filter-container input::placeholder{color:#929191}mv-line-search .search-zone .filter-container .clear-input{cursor:pointer;opacity:0;position:absolute;transform:translateY(-50%);transition:opacity .3s;top:50%}html[dir=ltr] mv-line-search .search-zone .filter-container .clear-input{right:6px}html[dir=rtl] mv-line-search .search-zone .filter-container .clear-input{left:6px}mv-line-search .search-zone .filter-container .clear-input .icon{color:#bdc3c7;height:.4705882353rem;width:.4705882353rem}\n'],encapsulation:2}),e})();var _=n(3786),T=n(50709),S=n(30977),x=n(95505),w=n(94876),k=n(61787),M=n(5306),L=n(79223);function A(e,t){1&e&&(r.TgZ(0,"div",4),r._UZ(1,"svg-icon",5),r.ALo(2,"translate"),r.TgZ(3,"div",6),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.s9C("titleText",r.lcZ(2,2,"NoTripPlanFoundTitle")),r.xp6(3),r.Oqu(r.lcZ(5,4,"line_no_results")))}function I(e,t){if(1&e&&(r.TgZ(0,"div",9),r.TgZ(1,"span",10),r._uU(2),r.qZA(),r.TgZ(3,"span",11),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA()),2&e){const e=r.oxw().item;r.uIk("aria-labelledby","agency-title-"+e.agencyName),r.xp6(2),r.Oqu(e.agencyName),r.xp6(2),r.Oqu(r.lcZ(5,3,e.agencyType))}}function E(e,t){if(1&e&&(r._UZ(0,"div",17),r.ALo(1,"safeHtml"),r.ALo(2,"async")),2&e){const e=r.oxw(2).item;r.Q6J("innerHTML",r.lcZ(1,1,r.lcZ(2,3,e.imageHtml)),r.oJD)}}function C(e,t){if(1&e&&(r.TgZ(0,"span",18),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).item;r.xp6(1),r.Oqu(e.lineName.secondary)}}function D(e,t){if(1&e&&(r.TgZ(0,"div",12),r.YNc(1,E,3,5,"div",13),r.ALo(2,"async"),r.TgZ(3,"div",14),r.TgZ(4,"span",15),r._uU(5),r.qZA(),r.YNc(6,C,2,1,"span",16),r.qZA(),r.qZA()),2&e){const e=r.oxw().item;r.xp6(1),r.Q6J("ngIf",r.lcZ(2,5,e.imageHtml)),r.xp6(3),r.ekj("primary",e.lineName.secondary),r.xp6(1),r.Oqu(e.lineName.primary),r.xp6(1),r.Q6J("ngIf",e.lineName.secondary)}}function P(e,t){if(1&e&&(r.YNc(0,I,6,5,"div",7),r.YNc(1,D,7,7,"div",8)),2&e){const e=t.item,n=r.oxw();r.Q6J("ngIf",e.$type===n.LineListItemType.AGENCY),r.xp6(1),r.Q6J("ngIf",e.$type===n.LineListItemType.LINE)}}function O(e,t){1&e&&r.GkF(0)}const N=function(e){return{item:e}};function R(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",22),r.NdJ("keydown",function(t){const n=r.CHM(e).index;return r.oxw(2).onKeydown(t,n)})("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onItemClick(t)}),r.YNc(1,O,1,0,"ng-container",23),r.qZA()}if(2&e){const e=t.$implicit,n=t.index;r.oxw(2);const i=r.MAs(2);r.Q6J("id","line_"+n)("tabIndex",1===n?0:-1),r.xp6(1),r.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",r.VKq(4,N,e))}}function $(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"cdk-virtual-scroll-viewport",19),r.NdJ("scrolledIndexChange",function(){return r.CHM(e),r.oxw().onScroll()}),r.TgZ(1,"div",20),r.YNc(2,R,2,6,"div",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("cdkVirtualForOf",e.lineListService.list$)}}function Y(e,t){1&e&&r.GkF(0)}function F(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",25),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onItemClick(t)}),r.YNc(1,Y,1,0,"ng-container",23),r.qZA()}if(2&e){const e=t.$implicit;r.oxw(2);const n=r.MAs(2);r.xp6(1),r.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",r.VKq(2,N,e))}}function B(e,t){if(1&e&&(r.TgZ(0,"div",20),r.YNc(1,F,2,4,"div",24),r.ALo(2,"async"),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,e.lineListService.list$))}}let U=(()=>{class e{constructor(e,t,n,i,r,o,a){this.routingService=e,this.store=t,this.lineActions=n,this.analyticsService=i,this.canonicalService=r,this.universal=o,this.document=a,this.LineListItemType=S.G,this.deepestOffset=0}get state(){return this.store.getState()}get emptyState(){return this.postInitState&&!this.state.global.isLoading&&!this.state.line.items.length}ngOnInit(){return(0,_.mG)(this,void 0,void 0,function*(){this.store.dispatch(this.lineActions.clearDisplayedLine()),yield this.lineListService.init(),this.postInitState=!0,this.lineListService.searchEvent.subscribe(()=>this.deepestOffset=0)})}onItemClick(e){return(0,_.mG)(this,void 0,void 0,function*(){e.$type===S.G.LINE&&(yield this.store.dispatch(this.lineActions.loadLineGroup(e.lineGroupId)),this.analyticsService.trackLinesAction("line group selected",e.lineName))})}onScroll(){const e=this.document.getElementById("lines-filter");if(e&&e.blur(),this.lineListService.infFinished)return;const t=this.viewport.getRenderedRange().end;t===this.viewport.getDataLength()&&this.deepestOffset<t&&(this.deepestOffset=t,this.lineListService.next(null,"scroll"))}onKeydown(e,t){if("ArrowUp"===e.key&&t-1>=0)e.preventDefault(),this.updateSelection(t,-1);else if("ArrowDown"===e.key&&t+1<this.lineListService.list$.getValue().length)e.preventDefault(),this.updateSelection(t,1);else if("Enter"===e.key){e.preventDefault();const n=this.lineListService.list$.getValue()[t];this.onItemClick(n)}}updateSelection(e,t){let n=e+t;this.lineListService.list$.getValue()[n].$type!==S.G.LINE&&(n=e+t+(-1===Math.sign(t)?-1:1)),this.setSelectedFocus(n)}setSelectedFocus(e){const t=this.document.getElementById(`line_${e}`);t&&(t.focus(),t.scrollIntoView({block:"center"}))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(x.Z),r.Y36(o.d),r.Y36(w.J),r.Y36(s.y),r.Y36(k.z),r.Y36(M.p),r.Y36(u.K0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-line-list"]],viewQuery:function(e,t){if(1&e&&r.Gf(T.N7,5),2&e){let e;r.iGM(e=r.CRH())&&(t.viewport=e.first)}},inputs:{lineListService:"lineListService"},decls:5,vars:3,consts:[["class","empty-results","role","status",4,"ngIf"],["lineRow",""],["itemSize","77",3,"scrolledIndexChange",4,"ngIf"],["class","results-wrapper",4,"ngIf"],["role","status",1,"empty-results"],["src","images/error-states/img_empty_state_omni.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],[1,"message"],["class","agency-header","role","group",4,"ngIf"],["class","line-item","role","listitem",4,"ngIf"],["role","group",1,"agency-header"],[1,"name"],[1,"type"],["role","listitem",1,"line-item"],["class","line-image",3,"innerHTML",4,"ngIf"],[1,"line-title-wrapper","flex-col"],[1,"line-title"],["class","line-detail",4,"ngIf"],[1,"line-image",3,"innerHTML"],[1,"line-detail"],["itemSize","77",3,"scrolledIndexChange"],[1,"results-wrapper"],["class","line-row",3,"id","tabIndex","keydown","click",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"line-row",3,"id","tabIndex","keydown","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","line-row",3,"click",4,"ngFor","ngForOf"],[1,"line-row",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,A,6,6,"div",0),r.YNc(1,P,2,2,"ng-template",null,1,r.W1O),r.YNc(3,$,3,1,"cdk-virtual-scroll-viewport",2),r.YNc(4,B,3,3,"div",3)),2&e&&(r.Q6J("ngIf",t.emptyState),r.xp6(3),r.Q6J("ngIf",t.universal.isBrowser),r.xp6(1),r.Q6J("ngIf",t.universal.isServer))},directives:[u.O5,p.bk,h.m,T.N7,T.xd,T.x0,u.tP,u.sg],pipes:[f.X$,u.Ov,L.z],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-line-list .empty-results .icon{fill:#bdc3c7;display:block;height:32px;margin:26px auto 0;width:32px}mv-line-list .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;text-align:center;padding:20px}mv-line-list cdk-virtual-scroll-viewport{width:100%;height:100%}body.mobile mv-line-list cdk-virtual-scroll-viewport{position:fixed;height:calc(100vh - 40px);left:0}mv-line-list cdk-virtual-scroll-viewport li{height:20px}mv-line-list cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{width:100%}body.desktop mv-line-list cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{position:static}mv-line-list .results-wrapper{background-color:#fff;box-sizing:border-box;overflow:hidden;-webkit-overflow-scrolling:touch;padding:0;position:relative;z-index:0}mv-line-list .results-wrapper>.line-row{width:100%;min-height:39px}mv-line-list .results-wrapper>.line-row:focus{outline:#302E2E auto 1px}mv-line-list .results-wrapper>.line-row:hover{outline:none}mv-line-list .results-wrapper>.line-row .agency-header{background-color:#ecf0f1;box-sizing:border-box;color:#6c6d6d;display:table;line-height:1.4;margin-top:-1px;padding:14px 20px 6px;width:100%;z-index:1}mv-line-list .results-wrapper>.line-row .agency-header .name,mv-line-list .results-wrapper>.line-row .agency-header .type{display:table-cell;vertical-align:middle;width:1px;font-size:.8235294118rem}mv-line-list .results-wrapper>.line-row .agency-header .name{width:100%}mv-line-list .results-wrapper>.line-row .agency-header .type{white-space:nowrap}html[dir=ltr] mv-line-list .results-wrapper>.line-row .agency-header .type{padding-left:20px}html[dir=rtl] mv-line-list .results-wrapper>.line-row .agency-header .type{padding-right:20px}mv-line-list .results-wrapper>.line-row .line-item:after{background:#DDDDDD;content:"";display:block;height:1px;position:absolute;bottom:0;left:20px;width:calc(100% - 40px);z-index:-1}\n'],encapsulation:2}),e})();function Z(e,t){if(1&e&&r._UZ(0,"mv-line-list",0),2&e){const e=r.oxw();r.Q6J("lineListService",e.lineListService)}}let j=(()=>{class e{constructor(e,t){this.lineListService=e,this.store=t}get state(){return this.store.getState()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(i.le),r.Y36(o.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-lines-main-view"]],features:[r._Bn([i.le])],decls:2,vars:2,consts:[[3,"lineListService"],[3,"lineListService",4,"ngIf"]],template:function(e,t){1&e&&(r._UZ(0,"mv-line-search",0),r.YNc(1,Z,1,1,"mv-line-list",1)),2&e&&(r.Q6J("lineListService",t.lineListService),r.xp6(1),r.Q6J("ngIf",t.state.global.appIsReady))},directives:[b,u.O5,U],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-lines-main-view{overflow-y:auto;height:calc(100vh - 80px)}\n"],encapsulation:2}),e})()},66246:function(e,t,n){"use strict";n.d(t,{m:function(){return f}});var i=n(2316),r=n(5971),o=n(54364),a=n(3786),s=n(55754),l=n(44143),c=n(8967),d=n(85431),u=n(99957),p=n(23137),h=n(94876);let m=(()=>{class e extends c.d{constructor(e,t,n,i,r){super(t,n,i,"linesMapElement","ItineraryMap"),this.storeHelper=e,this.store=t,this.customerService=n,this.uiActions=i,this.lineActions=r,this.unsubscribes=[]}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.initLeafletMap(),this.drawLine(),this.unsubscribes.push(this.storeHelper.subscribe("line.linesMapHasNewData",e=>{e&&(this.drawLine(),this.store.dispatch(this.lineActions.readMapData()))}))})}ngOnDestroy(){this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}get state(){return this.store.getState()}get selectedRoute(){return this.state.itinerary.selectedRoute}get selectedStep(){return this.state.itinerary.navSelectedStep}drawLine(){if(!this.state.line.lineGroup||!this.state.line.displayedLine)return;const e=this.state.line.lineGroup.color,t=`#${e}`,n=this.state.line.displayedLine.shape,i=this.state.line.displayedLine.stops;if(this.logger.log("onLineDisplay",{color:e,shape:n,stops:i}),this.removeLinePolyline(),!n||!n.encodedShape)return;const r=new Date;this.logger.log("drawRoute BEFORE");const o=l.Ry(n.encodedShape);if(o&&o.length>0){this.pathShadow=L.polyline(o).addTo(this.map),this.pathHighlight=L.polyline(o).addTo(this.map),this.pathRoute=L.polyline(o).addTo(this.map),this.pathShadow.setStyle({color:"#383838",weight:10,opacity:1}),this.pathHighlight.setStyle({color:"#fafafa",weight:8,opacity:1}),this.pathRoute.setStyle({color:t,weight:3,opacity:1});const e=i.map(e=>{const t=s._.fromMvLatLon(e.location);return t.stopName=e.name,t});this.createStopMarkers(t,e,o,!1,!1),this.fitBoundsByPoints(o)}else this.removeLinePolyline();const a=new Date;this.logger.log("drawRoute AFTER:"+(a.valueOf()-r.valueOf()))}removeLinePolyline(){this.linePolyline&&(this.map.removeLayer(this.linePolyline),this.linePolyline=null)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(d.N),i.Y36(r.d),i.Y36(u.v),i.Y36(p.V),i.Y36(h.J))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-lines-map"]],features:[i.qOj],decls:1,vars:0,consts:[["id","linesMapElement",1,"lines-map"]],template:function(e,t){1&e&&i._UZ(0,"div",0)},styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-lines-map{position:absolute;width:100%;height:100%}mv-lines-map .lines-map{width:100%;height:100%}mv-lines-map .lines-map .stop-div-icon div{background-color:#edeff3;border:1px solid #292A30;border-radius:50%;box-sizing:border-box;height:100%;width:100%;box-shadow:0 0 3px 1px #000}\n"],encapsulation:2}),e})();function g(e,t){1&e&&i._UZ(0,"mv-lines-map")}let f=(()=>{class e{constructor(e){this.store=e}get isMetroReady(){return!!this.store.getState().metro.currentMetro}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.d))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-lines-map-view"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&i.YNc(0,g,1,0,"mv-lines-map",0),2&e&&i.Q6J("ngIf",t.isMetroReady)},directives:[o.O5,m],styles:["mv-lines-map-view{position:absolute;top:0;bottom:0;right:0;left:0;width:100%;height:100%;overflow:hidden;z-index:0}\n"],encapsulation:2}),e})()},30977:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var i=(()=>{return(e=i||(i={}))[e.AGENCY=1]="AGENCY",e[e.LINE=2]="LINE",i;var e})()},44143:function(e,t,n){"use strict";n.d(t,{Ry:function(){return a},LW:function(){return s},zU:function(){return l},s1:function(){return c},_p:function(){return d},Gr:function(){return u},YQ:function(){return g},mp:function(){return f},L:function(){return v}});var i=n(55754),r=n(89067),o=n.n(r);function a(e){return o().decode(e).map(e=>({lat:e[0],lng:e[1]}))}function s(e){return e.points||(e.points=a(e.encodedPolyline)),e.points}function l(e){const t=s(e);return t.length>0?t[0]:null}function c(e){const t={lat:90,lng:180},n={lat:-90,lng:-180};return e.forEach(e=>{i._.min(t,e),i._.max(n,e)}),{southWest:t,northEast:n}}function d(e,t){const n=[],i=e.length,r=t.length;let o=0,a=0,s=0;if(0==i)return n;const l=Math.cos(e[0].lat*Math.PI/180);for(;o<i;){const i=e[o];let c=129600,d=i;for(a=s;a<r-1;a++){const n=m(e[o],t[a],t[a+1],l);n.dist<c&&(d=n.point,d.stopName=i.stopName,c=n.dist,s=a)}n.push(d),o++}return n}function u(e,t,n,i){const r=e.options.icon;let o;return o=i<=n?i-Math.floor(t/10):i-4,r.options.iconSize=[o,o],e.setIcon(r),e}function p(e){return e*e}function h(e,t,n){return p((e.lng-t.lng)*n)+p(e.lat-t.lat)}function m(e,t,n,i){const r=h(t,n,i);if(0==r)return{dist:h(e,t,i),point:t};let o=((e.lng-t.lng)*i*(n.lng-t.lng)*i+(e.lat-t.lat)*(n.lat-t.lat))/r;o=Math.max(0,Math.min(1,o));const a={lat:t.lat+o*(n.lat-t.lat),lng:t.lng+o*(n.lng-t.lng)};return{dist:h(e,a,i),point:a}}function g(e,t,n,i,r){if(e==n&&t==i)return 0;{const o=Math.PI*e/180,a=Math.PI*n/180,s=Math.PI*(t-i)/180;let l=Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos(s);return l>1&&(l=1),l=Math.acos(l),l=180*l/Math.PI,l=60*l*1.1515,"K"==r&&(l*=1.609344),"N"==r&&(l*=.8684),l}}function f(e,t){const n=a(t);let i=!1;for(let r=0,o=n.length-1;r<n.length;o=r++){const t=n[r].lat,a=n[r].lng,s=n[o].lat,l=n[o].lng;a>e.lng!=l>e.lng&&e.lat<(s-t)*(e.lng-a)/(l-a)+t&&(i=!i)}return i}function v(e,t,n,i){let r;return r=i<=n?Math.floor((i-t/10)/2):Math.ceil((i-3)/2),e.map(e=>Object.assign(Object.assign({},e),{stopRadius:r}))}},74692:function(e,t,n){"use strict";n.d(t,{fi:function(){return i},EP:function(){return r},CV:function(){return o},bF:function(){return a},eK:function(){return s},AE:function(){return l},of:function(){return c},d5:function(){return d},Dl:function(){return u},QQ:function(){return p},lt:function(){return h}});var i=(()=>{return(e=i||(i={})).PublicTransit="public-transit",e.SharedTransit="shared-transit",i;var e})(),r=(()=>{return(e=r||(r={}))[e.BIKE=1]="BIKE",e[e.ELECTRIC_BIKE=2]="ELECTRIC_BIKE",e[e.ELECTRIC_SCOOTER=3]="ELECTRIC_SCOOTER",e[e.KICK_SCOOTER=4]="KICK_SCOOTER",e[e.MOPED=5]="MOPED",e[e.BIKE_STATION=6]="BIKE_STATION",e[e.DOCKLESS_CAR=7]="DOCKLESS_CAR",r;var e})(),o=(()=>{return(e=o||(o={}))[e.NO_MM_ITEMS_TO_DISPLAY=1]="NO_MM_ITEMS_TO_DISPLAY",e[e.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY=2]="NO_MM_ITEMS_IN_FILTER_TO_DISPLAY",e[e.NO_STATIONS_TO_DISPLAY=3]="NO_STATIONS_TO_DISPLAY",e[e.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS=4]="TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS",o;var e})();const a={[r.BIKE]:"web_stations_list_bike",[r.BIKE_STATION]:"web_stations_list_bike_station",[r.DOCKLESS_CAR]:"web_stations_list_car",[r.ELECTRIC_BIKE]:"web_stations_list_ebike",[r.ELECTRIC_SCOOTER]:"web_stations_list_escooter",[r.KICK_SCOOTER]:"web_stations_list_kscooter",[r.MOPED]:"web_stations_list_moped",default:"web_stations_list_bike"},s={[r.BIKE]:"images/nearby/micro-mobility-icons/transit-bikes.svg",[r.BIKE_STATION]:"images/nearby/micro-mobility-icons/transit-bikes.svg",[r.DOCKLESS_CAR]:"images/nearby/micro-mobility-icons/transit-car.svg",[r.ELECTRIC_BIKE]:"images/nearby/micro-mobility-icons/transit-bikes.svg",[r.ELECTRIC_SCOOTER]:"images/nearby/micro-mobility-icons/transit-kick-scooter.svg",[r.KICK_SCOOTER]:"images/nearby/micro-mobility-icons/transit-kick-scooter.svg",[r.MOPED]:"images/nearby/micro-mobility-icons/transit-moped.svg",default:"images/nearby/micro-mobility-icons/transit-bikes.svg"},l={[r.BIKE]:"web_stations_filter_bikes",[r.BIKE_STATION]:"web_stations_filter_bike_stations",[r.DOCKLESS_CAR]:"web_stations_filter_shared_car",[r.ELECTRIC_BIKE]:"web_stations_filter_ebikes",[r.ELECTRIC_SCOOTER]:"web_stations_filter_escooters",[r.KICK_SCOOTER]:"web_stations_filter_kscooters",[r.MOPED]:"web_stations_filter_mopeds",default:"web_stations_filter_bikes"},c={[o.NO_MM_ITEMS_TO_DISPLAY]:"web_stations_shared_empty_title",[o.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY]:"web_stations_shared_specific_empty_title",[o.NO_STATIONS_TO_DISPLAY]:"web_stations_public_empty_title"},d={[o.NO_MM_ITEMS_TO_DISPLAY]:"web_stations_shared_empty_subtitle",[o.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY]:"web_stations_shared_specific_empty_subtitle",[o.NO_STATIONS_TO_DISPLAY]:"web_stations_public_empty_subtitle_map",[o.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS]:"web_stations_public_empty_zoom"},u={[o.NO_MM_ITEMS_TO_DISPLAY]:"illustration-spot-web-no-shared-transit.svg",[o.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY]:"illustration-spot-web-move-map.svg",[o.NO_STATIONS_TO_DISPLAY]:"illustration-spot-web-no-pt.svg",[o.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS]:"illustration-spot-web-zoom-map.svg"},p=4,h=15},6333:function(e,t,n){"use strict";n.d(t,{S:function(){return wt}});var i=n(16438),r=n(2316),o=n(5306),a=n(54364),s=n(3786),l=n(8967),c=n(55754),d=n(40216),u=n(31251),p=n(31234),h=n(74692),m=n(56147),g=n.n(m),f=n(44143),v=n(43049),y=n(5971),b=n(99957),_=n(23137),T=n(85431),S=n(82596),x=n(79573),w=n(32066),k=n(67731),M=n(1437),A=n(2339),I=n(87479),E=n(93975);let C=(()=>{class e extends l.d{constructor(e,t,n,i,o,a,s,l,c,d,u){super(e,t,n,"nearbyMapElement","NearbyMap"),this.store=e,this.customerService=t,this.uiActions=n,this.storeHelper=i,this.nearbyActions=o,this.locationService=a,this.imageService=s,this.permissionService=l,this.nearbyService=c,this.analyticsService=d,this.translate=u,this.defaultZoom=16,this.displayStopsMaxZoom=15,this.itemFocusZoom=19,this.MAX_TILES_TO_FETCH=12,this.microMobilityLayers=[this.nearbyBikesMarkers,this.nearbyElectricBikesMarkers,this.nearbyElectricScootersMarkers,this.nearbyKickScootersMarkers,this.nearbyMopedsMarkers,this.nearbyBikeStationsMarkers,this.nearbyDocklessCarsMarkers],this.unsubscribes=[],this.onMoveEnd=new r.vpe}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){yield this.initLeafletMap(this.defaultZoom),this.isMapFocused=!0,yield this.permissionService.requestLocation().then(e=>(0,s.mG)(this,void 0,void 0,function*(){if(e){this.hasLocationPermission=!0,this.userLocation=yield this.nearbyService.getUserLocation(),this.map.setView(this.userLocation,this.defaultZoom);const e=yield this.permissionService.requestOrientation();this.mapLocation=new d.Y(this.map,e)}})),this.store.dispatch(this.nearbyActions.updateMapZoom(this.defaultZoom));const e=this.getAllDisplayedTiles(),t=this.getRequestedTilesForStops(e);t.length>0&&(yield this.store.dispatch(this.nearbyActions.getStopsForMap(t,e,this.defaultZoom)));const n=this.getRequestedTilesForMicroMobility(e);n.length>0&&(yield this.store.dispatch(this.nearbyActions.getMicroMobilityData(this.state.metro.metroId,n))),this.nearbyStopsMapData&&(yield this.addStopsToMap(this.defaultZoom,e,!0)),this.nearbymicroMobility&&0!==this.microMobilityTypes.length&&(yield this.drawMicroMobilityLayers(this.defaultZoom,e,!0)),yield this.store.dispatch(this.nearbyActions.readMapData()),this.map.on("moveend",()=>(0,s.mG)(this,void 0,void 0,function*(){this.onMapMoveEnd()})),this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedStop",e=>{this.selectedItemLocation&&this.map.setView(this.selectedItemLocation,this.itemFocusZoom)})),this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedMMItem",e=>{this.selectedMMItemLocation&&this.map.setView(this.selectedMMItemLocation,this.itemFocusZoom)}))})}ngOnDestroy(){var e;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}get state(){return this.store.getState()}get nearbyStopsMapData(){return this.state.nearby.stopsMapData.stopsDataMapGroups}get nearbyStopsGroupsOnMap(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.displayedGroupsOnMap}get nearbyStopsAdditionalData(){return this.state.nearby.stopsAdditionalData}get nearbyMMTilesOnMap(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMTilesOnMap}get mapMoveEndInProgress(){return this.state.nearby.mapMoveEndInProgress}get skippedMapMoveEndEvent(){return this.state.nearby.skippedMapMoveEndEvent}get nearbymicroMobility(){return this.state.nearby.microMobilityData}get microMobilityTypes(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.microMobilityTypes}get microMobilityFilteredType(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMFilterType}get mapCurrentZoom(){return this.state.nearby.currentMapZoom}get selectedStop(){return this.state.nearby.selectedStop}get selectedMicroMobilityItem(){return this.state.nearby.selectedMMItem}get allMMTiles(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.tiles}get nearbyStopsExistOnCurrentTiles(){return this.state.nearby.stopsExistOnCurrentTiles}refreshSize(){this.map.invalidateSize()}getMapCenter(){return this.map.getCenter()}get selectedItemLocation(){var e,t;return(null===(t=null===(e=this.state.nearby.selectedStop)||void 0===e?void 0:e.stopData)||void 0===t?void 0:t.stopLocation)?c._.fromMvLatLon(this.state.nearby.selectedStop.stopData.stopLocation):null}get selectedMMItemLocation(){var e;return(null===(e=this.state.nearby.selectedMMItem)||void 0===e?void 0:e.location)?c._.fromMvLatLon(this.state.nearby.selectedMMItem.location):null}onMapMoveEnd(){return(0,s.mG)(this,void 0,void 0,function*(){if(this.mapMoveEndInProgress&&!this.skippedMapMoveEndEvent)return void this.store.dispatch(this.nearbyActions.skippedMapMoveEndEvent(!0));const e=this.mapCurrentZoom;this.mapMoveEndInProgress||this.store.dispatch(this.nearbyActions.updateMoveEndInProgress(!0)),this.isMapFocused=!1;const t=yield this.map.getZoom();[this.nearbyStopsMarkers,this.nearbyDocklessVehiclesMarkers,this.nearbyBikesMarkers,this.nearbyElectricBikesMarkers,this.nearbyElectricScootersMarkers,this.nearbyKickScootersMarkers,this.nearbyMopedsMarkers,this.nearbyBikeStationsMarkers,this.nearbyDocklessCarsMarkers].forEach(e=>{if(e){const n=e.length;e.forEach(e=>{e=f.Gr(e,n,12,t)})}});let n=!1;t!==e&&(yield this.store.dispatch(this.nearbyActions.updateMapZoom(t)),n=!0);const i=this.getAllDisplayedTiles(),r=this.getRequestedTilesForStops(i);if(r.length>0&&(yield this.store.dispatch(this.nearbyActions.getStopsForMap(r,i,t))),this.microMobilityTypes.length>0){const e=this.getRequestedTilesForMicroMobility(i);e.length>0&&(yield this.store.dispatch(this.nearbyActions.getMicroMobilityData(this.state.metro.metroId,e)))}this.microMobilityFilteredType||(yield this.addStopsToMap(t,i,n)),this.microMobilityTypes.length>0&&(yield this.drawMicroMobilityLayers(t,i,n)),yield this.store.dispatch(this.nearbyActions.readMapData()),this.mapMoveEndInProgress&&this.store.dispatch(this.nearbyActions.updateMoveEndInProgress(!1)),this.onMoveEnd.emit(),this.skippedMapMoveEndEvent&&(this.store.dispatch(this.nearbyActions.skippedMapMoveEndEvent(!1)),this.onMapMoveEnd())})}focusOnUserLocation(){return(0,s.mG)(this,void 0,void 0,function*(){this.hasLocationPermission?this.map.setView(this.mapLocation.getLocation(),this.mapCurrentZoom):(localStorage.removeItem(u.h),yield this.permissionService.requestLocation().then(e=>(0,s.mG)(this,void 0,void 0,function*(){var t;if(e)this.hasLocationPermission=!0,this.userLocation=yield this.nearbyService.getUserLocation(),this.map.setView(this.userLocation,this.defaultZoom),this.mapLocation=new d.Y(this.map,!0);else{const e=c._.fromMvLatLon(null===(t=this.state.metro.currentMetro)||void 0===t?void 0:t.defaultLocation);this.map.setView(e,this.mapCurrentZoom)}}))),setTimeout(()=>this.isMapFocused=!0,500),this.analyticsService.trackNearbyClickOnFocusButton()})}getRequestedTilesForStops(e){var t;if(e.length>0){const n=null===(t=this.state.nearby.stopsMapData)||void 0===t?void 0:t.receivedTiles;let i=[];if(n)for(const t of e)n.find(e=>t.tileY===e.tileY&&t.tileX===e.tileX)||i.push(t);else i=e;const r=[];return i.forEach(e=>{r.push(e.tileX,e.tileY)}),r}return[]}getRequestedTilesForMicroMobility(e){var t;if(e.length>0){const n=[],i=null===(t=this.state.nearby.microMobilityData)||void 0===t?void 0:t.tiles;let r;i&&i.forEach(e=>{n.push(`${e.tileX}_${e.tileY}`)}),r=n&&n.length>0?e.filter(e=>!n.includes(`${e.tileX}_${e.tileY}`)):e;const o=[];return r.forEach(e=>{o.push(e.tileX,e.tileY)}),o}return[]}getAllDisplayedTiles(){const e=this.map.getBounds(),t=this.nearbyService.toLatLonTiles(e.getSouthWest()),n=this.nearbyService.toLatLonTiles(e.getNorthEast()),i=[];if((n.tileY-t.tileY+1)*(n.tileX-t.tileX+1)<=this.MAX_TILES_TO_FETCH)for(let r=t.tileY;r<=n.tileY;r++)for(let e=t.tileX;e<=n.tileX;e++)i.push({tileX:e,tileY:r});return i}onClickMapMMItem(e){const t=e.latlng,n=this.nearbyService.toLatLonTiles(t),i=this.allMMTiles.find(e=>e.tileX==n.tileX&&e.tileY==n.tileY);if(null==i?void 0:i.items){const e=i.items.find(e=>c._.fromMvLatLon(e.location).lat==t.lat&&c._.fromMvLatLon(e.location).lng==t.lng);e&&(this.selectedStop&&this.store.dispatch(this.nearbyActions.updateSelectedStop(null)),this.store.dispatch(this.nearbyActions.updateSelectedMMItem(e)),this.analyticsService.trackNearbyClickOnMapItem("micro-mobility"))}}onClickMapStop(e){return(0,s.mG)(this,void 0,void 0,function*(){this.analyticsService.trackNearbyClickOnMapItem("public-transport");const t=e.latlng,n=Object.values(this.nearbyStopsAdditionalData).sort((e,n)=>this.nearbyService.getDistanceFromLocation(e.stopLocation,t,!1)-this.nearbyService.getDistanceFromLocation(n.stopLocation,t,!1))[0];if(n){const e=yield this.getStopWalkTime(n);yield this.store.dispatch(this.nearbyActions.updateSelectedStop(n.stopId,e.walkingTime,e.walkingDistance)),this.selectedMicroMobilityItem&&this.store.dispatch(this.nearbyActions.updateSelectedMMItem(null))}})}getStopWalkTime(e){return(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.getUserLocationOrMapCenter(),n=this.nearbyService.getDistanceFromLocation(e.stopLocation,t.location,t.hasUserLocation),i=Math.round(n/h.QQ*60);return{walkingTime:i<=60?this.nearbyService.getWalkTimeText(i):null,walkingDistance:i>60?this.nearbyService.getDistanceKmText(n):null}})}getUserLocationOrMapCenter(){return(0,s.mG)(this,void 0,void 0,function*(){return this.hasLocationPermission?{location:yield this.mapLocation.getLocation(),hasUserLocation:!0}:{location:yield this.getMapCenter(),hasUserLocation:!1}})}addStopsToMap(e,t,n){return(0,s.mG)(this,void 0,void 0,function*(){this.logger.log("createNearbyStops");const i=this.nearbyStopsGroupsOnMap,r=this.state.nearby.stopsMapData.stopsDataMapGroups;let o=!1;n&&(yield this.removeLayers(this.nearbyStopsMarkers),this.nearbyStopsMarkers=[]);let a=[];for(const l of t){let t=[];if(i&&(t=i.filter(e=>e.tileLng==l.tileX&&e.tileLat==l.tileY)),!t.length||n){for(const t of r)if(l.tileY===t.tileLat&&l.tileX===t.tileLng){o=!0;let n=!1;const i=t.imageRefSet.images[0].index/100;if((e>=i||e>=i-3&&1-(i-e)/3>=.5)&&(n=!0),n){const n={displayedGroupOnMap:t.id,markers:[],tileLat:t.tileLat,tileLng:t.tileLng};n.markers=yield this.addStopsMarkersOnMap(t,e),a.push(n)}}}else o=!0,a=a.concat(t)}let s=[];if(!n){i.forEach(e=>{t.find(t=>t.tileX==e.tileLng&&t.tileY==e.tileLat)||(s=s.concat(e.markers))});for(const e of s){e.marker.removeFrom(this.map);const t=this.nearbyStopsMarkers.findIndex(t=>t==e.marker);t>-1&&this.nearbyStopsMarkers.splice(t,1)}}this.nearbyStopsExistOnCurrentTiles!==o&&this.store.dispatch(this.nearbyActions.updateStopsExistOnCurrentTiles(o)),g()(i,a)||this.store.dispatch(this.nearbyActions.updateDisplayedStopsOnMap(a))})}addStopsMarkersOnMap(e,t){var n;return(0,s.mG)(this,void 0,void 0,function*(){let i=0;const r=[];for(;i+1<e.imageRefSet.images.length&&!(t<e.imageRefSet.images[i+1].index/100);)i++;let o;if(6507!==e.imageRefSet.images[i].imageRef){if(this.state.nearby.stopsAdditionalData){const t=null===(n=this.state.nearby.stopsAdditionalData[e.mapItems[i].itemId])||void 0===n?void 0:n.image;(null==t?void 0:t.imageId)===v.nM.STOP_MULTI_AGENCY_MVF&&(o=yield this.imageService.getStopsImageMapHtml(t.parameters))}let t;o||(o=yield this.imageService.getImageHTML(e.imageRefSet.images[i].imageRef,null,null,this.translate.instant("a11y_station_image"))),t=o&&"<"===o[0]&&!o.includes("undefined")?L.divIcon({html:o,iconSize:[22,33],iconAnchor:[11,33],className:"stop-icon"}):L.icon({iconUrl:p.jm(6,!1),iconSize:[22,33],iconAnchor:[11,33]});for(const n of e.itemLocationsDecoded){const e=L.marker({lat:n.latitude,lng:n.longitude},{icon:t,keyboard:!1}).addTo(this.map).on("click",this.onClickMapStop.bind(this));this.nearbyStopsMarkers.push(e),r.push({marker:e})}}else for(const t of e.itemLocationsDecoded){const n=yield this.imageService.getImageHTML(e.imageRefSet.images[i].imageRef,[e.mapItems[0].itemParams[0]],null,this.translate.instant("a11y_station_image")),o=L.divIcon({html:n,iconSize:[22,33],iconAnchor:[11,33],className:"stop-icon"}),a=L.marker({lat:t.latitude,lng:t.longitude},{icon:o,keyboard:!1}).addTo(this.map).on("click",this.onClickMapStop.bind(this));this.nearbyStopsMarkers.push(a),r.push({marker:a})}return r})}drawMicroMobilityLayers(e,t,n){var i;return(0,s.mG)(this,void 0,void 0,function*(){this.logger.log("createNearbyMicroMobilityLayers");const r=null===(i=this.state.nearby.microMobilityData)||void 0===i?void 0:i.tiles,o=this.nearbyMMTilesOnMap;if(n)for(let e of this.microMobilityLayers)yield this.removeLayers(e),e=[];let a=[];const l=yield Promise.all(t.map(t=>(0,s.mG)(this,void 0,void 0,function*(){let i=[];if(n){const e=r.find(e=>e.tileX==t.tileX&&e.tileY==t.tileY);(null==e?void 0:e.items)&&(i=e.items)}else{const e=o.find(e=>e.tileLatLng.tileX==t.tileX&&e.tileLatLng.tileY==t.tileY);if(e)return e;{const e=r.find(e=>e.tileX==t.tileX&&e.tileY==t.tileY);(null==e?void 0:e.items)&&(i=e.items)}}const a={tileLatLng:t,markers:[]};return i.length>0&&(a.markers=yield this.addMMItemsToMap(i,e)),a})));if(!n){o.forEach(e=>{t.find(t=>t.tileX==e.tileLatLng.tileX&&t.tileY==e.tileLatLng.tileY)||(a=a.concat(e.markers))});for(const e of a){e.marker.removeFrom(this.map);const t=this.getMicroItemLayerByType(e.itemMMType),n=t.findIndex(t=>t==e.marker);n>-1&&t.splice(n,1)}}(n||!g()(o.map(e=>e.tileLatLng),l.map(e=>e.tileLatLng)))&&(yield this.store.dispatch(this.nearbyActions.updateDisplayedMMTilesOnMap(l)))})}addMMItemsToMap(e,t){var n;return(0,s.mG)(this,void 0,void 0,function*(){const i=[];for(const r of e)if((!this.microMobilityFilteredType||this.microMobilityFilteredType===r.itemMMType)&&r.minZoom-1<=t&&r.maxZoom-1>t){const e=(null===(n=r.categoryMetaData)||void 0===n?void 0:n.basicProviderMetaData)?"Bike Station":"Dockless",t=yield this.getMicroMobilityItemImage(r,e),o=L.divIcon({html:t,iconSize:9999===r.maxZoom?[28,30]:[19,19],iconAnchor:9999===r.maxZoom?[14,30]:[9.5,19],className:`${"Bike Station"===e?"bike-icon":"dockless-vehicle-icon"} ${9999===r.maxZoom?"mm-zoomed-in-icon":"mm-zoomed-out-icon"}`}),a=c._.fromMvLatLon(r.location),s=L.marker([a.lat,a.lng],{icon:o,keyboard:!1}).addTo(this.map).on("click",this.onClickMapMMItem.bind(this));this.getMicroItemLayerByType(r.itemMMType).push(s),i.push({marker:s,itemMMType:r.itemMMType})}return i})}getMicroMobilityItemImage(e,t){return(0,s.mG)(this,void 0,void 0,function*(){let n;return"Bike Station"===t?(n=[...e.mapImage.params],e.itemMetaData&&e.itemMetaData.bikeStationMetaData&&e.itemMetaData.bikeStationMetaData.showStationDetails&&e.itemMetaData.bikeStationMetaData.availableBikes&&0!==e.itemMetaData.bikeStationMetaData.availableBikes?n.push(e.itemMetaData.bikeStationMetaData.availableBikes.toString()):e.itemMetaData&&e.itemMetaData.bikeStationMetaData&&e.itemMetaData.bikeStationMetaData.showStationDetails&&e.itemMetaData.bikeStationMetaData.availableBikes&&0==e.itemMetaData.bikeStationMetaData.availableBikes&&n.push("0")):n=e.mapImage.params,yield this.imageService.getImageHTML(e.mapImage.imageId,n,null,e.categoryName?e.categoryName:this.translate.instant("a11y_shared_transit_image"))})}getMicroItemLayerByType(e){return{[h.EP.BIKE]:this.nearbyBikesMarkers,[h.EP.BIKE_STATION]:this.nearbyBikeStationsMarkers,[h.EP.DOCKLESS_CAR]:this.nearbyDocklessCarsMarkers,[h.EP.ELECTRIC_BIKE]:this.nearbyElectricBikesMarkers,[h.EP.ELECTRIC_SCOOTER]:this.nearbyElectricScootersMarkers,[h.EP.KICK_SCOOTER]:this.nearbyKickScootersMarkers,[h.EP.MOPED]:this.nearbyMopedsMarkers}[e]}removeLayersForMMFilter(e){return(0,s.mG)(this,void 0,void 0,function*(){const t=this.microMobilityTypes.filter(t=>t!==e).map(e=>this.getMicroItemLayerByType(e)),n=[this.nearbyStopsMarkers].concat(t);for(const e of n)yield this.removeLayers(e)})}addLayersForAllItemsMMFilter(){const e=this.nearbyMMTilesOnMap.map(e=>e.tileLatLng);this.drawMicroMobilityLayers(this.mapCurrentZoom,e,!0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.d),r.Y36(b.v),r.Y36(_.V),r.Y36(T.N),r.Y36(S.H),r.Y36(x.a),r.Y36(w.KD),r.Y36(u.$),r.Y36(k.M),r.Y36(M.y),r.Y36(A.sK))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-map"]],features:[r.qOj],decls:4,vars:5,consts:[["id","nearbyMapElement",1,"nearby-map"],["tabindex","0",1,"map-focus-button",3,"click","keydown.enter"],["src","images/icons/current_location.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"]],template:function(e,t){1&e&&(r._UZ(0,"div",0),r.TgZ(1,"div",1),r.NdJ("click",function(){return t.focusOnUserLocation()})("keydown.enter",function(){return t.focusOnUserLocation()}),r._UZ(2,"svg-icon",2),r.ALo(3,"translate"),r.qZA()),2&e&&(r.xp6(1),r.ekj("map-focused",!!t.isMapFocused),r.xp6(1),r.s9C("titleText",r.lcZ(3,3,"user_location_description")))},directives:[I.bk,E.m],pipes:[A.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-map{position:absolute;width:100%;height:inherit}mv-nearby-map .nearby-map{width:100%;height:100%}mv-nearby-map .nearby-map .stop-div-icon div{background-color:#edeff3;border:1px solid #292A30;border-radius:50%;box-sizing:border-box;height:100%;width:100%;box-shadow:0 0 3px 1px #000}mv-nearby-map .nearby-map .stop-icon .mvf-wrapper{height:33px}mv-nearby-map .nearby-map .dockless-vehicle-icon.mm-zoomed-out-icon .mvf-wrapper{height:19px}mv-nearby-map .nearby-map .dockless-vehicle-icon.mm-zoomed-in-icon .mvf-wrapper{height:30px}mv-nearby-map .nearby-map .bike-icon.mm-zoomed-out-icon .mvf-wrapper{height:19px}mv-nearby-map .nearby-map .bike-icon.mm-zoomed-in-icon .mvf-wrapper{height:30px}mv-nearby-map .map-focus-button{position:absolute;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;width:2.3529411765rem;height:2.3529411765rem;top:16px;z-index:999;background:white;border-radius:50%;box-shadow:0 1px 8px #0003}html[dir=ltr] mv-nearby-map .map-focus-button{left:16px}html[dir=rtl] mv-nearby-map .map-focus-button{right:16px}mv-nearby-map .map-focus-button svg-icon,mv-nearby-map .map-focus-button svg-icon svg{width:1.4117647059rem;height:1.4117647059rem}mv-nearby-map .map-focus-button:before{content:"";border-radius:50%;width:100%;height:100%;position:absolute;z-index:-1}mv-nearby-map .map-focus-button:active:before{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards}mv-nearby-map .map-focus-button svg path{fill:#525357;transition:fill .3s ease-in-out}mv-nearby-map .map-focus-button.map-focused svg path{fill:#306cea}\n'],encapsulation:2}),e})();var D=n(26743),P=n(36179),O=n(86781),N=n(78146),R=n(79223),$=n(86607);function Y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",6),r.TgZ(2,"span",7),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.onTabClick(t.BottomsheetTab.PublicTransit)})("keydown.enter",function(){r.CHM(e);const t=r.oxw();return t.onTabClick(t.BottomsheetTab.PublicTransit)}),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"span",7),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.onTabClick(t.BottomsheetTab.SharedTransit)})("keydown.enter",function(){r.CHM(e);const t=r.oxw();return t.onTabClick(t.BottomsheetTab.SharedTransit)}),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.ekj("active",e.selectedTab===e.BottomsheetTab.PublicTransit),r.xp6(1),r.hij(" ",r.lcZ(4,6,"web_stations_public_tab")," "),r.xp6(2),r.ekj("active",e.selectedTab===e.BottomsheetTab.SharedTransit),r.xp6(1),r.hij(" ",r.lcZ(7,8,"web_stations_shared_tab")," ")}}function F(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1,"\xa0\u2022\xa0"),r.qZA())}function B(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.stopData.stopWalkTime)}}function U(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.stopData.stopWalkDistance)}}function Z(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"a",8,9),r.NdJ("click",function(){return r.CHM(e),r.oxw().stopBackButtonClick()})("keydown.enter",function(){return r.CHM(e),r.oxw().stopBackButtonClick()}),r.qZA(),r._UZ(3,"div",10),r.ALo(4,"safeHtml"),r.ALo(5,"async"),r.ALo(6,"asyncify"),r.TgZ(7,"div",11),r.TgZ(8,"div",12),r._uU(9),r.qZA(),r.TgZ(10,"div",13),r.TgZ(11,"span"),r._uU(12),r.qZA(),r.YNc(13,F,2,0,"span",2),r.YNc(14,B,2,1,"span",2),r.YNc(15,U,2,1,"span",2),r.qZA(),r.qZA(),r.BQk()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("innerHTML",r.lcZ(4,6,r.lcZ(5,8,r.lcZ(6,10,e.stopData.image))),r.oJD),r.xp6(6),r.Oqu(e.stopData.stopName),r.xp6(3),r.Oqu(e.stopData.stopCode),r.xp6(1),r.Q6J("ngIf",(e.stopWalkTime||!e.stopWalkTime&&e.stopWalkDistance)&&e.stopData.stopCode),r.xp6(1),r.Q6J("ngIf",e.stopData.stopWalkTime),r.xp6(1),r.Q6J("ngIf",!e.stopData.stopWalkTime&&e.stopData.stopWalkDistance)}}function j(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",14),r.TgZ(1,"a",15,9),r.NdJ("click",function(){return r.CHM(e),r.oxw().microFilterBackButtonClick()})("keydown.enter",function(){return r.CHM(e),r.oxw().microFilterBackButtonClick()}),r.qZA(),r._UZ(3,"svg-icon",16),r.ALo(4,"translate"),r.TgZ(5,"h2",17),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.s9C("titleText",r.lcZ(4,3,e.getFilteredMMTypeAltKey())),r.Q6J("src",e.getFilteredMMTypeImageSrc()),r.xp6(3),r.Oqu(r.lcZ(7,5,e.getFilteredMMTypeKey()))}}function V(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"a",22),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).onAppButtonClick()})("keydown.enter",function(){return r.CHM(e),r.oxw(2).onAppButtonClick()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("href",e.mmItemData.appDeeplink,r.LSH),r.xp6(1),r.Oqu(r.lcZ(2,2,"action_open_app"))}}function H(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"a",18,9),r.NdJ("click",function(){return r.CHM(e),r.oxw().microSingleItemBackButtonClick()})("keydown.enter",function(){return r.CHM(e),r.oxw().microSingleItemBackButtonClick()}),r.qZA(),r._UZ(3,"div",19),r.ALo(4,"safeHtml"),r.ALo(5,"async"),r.TgZ(6,"div",20),r.TgZ(7,"h2",17),r._uU(8),r.qZA(),r.TgZ(9,"p"),r._uU(10),r.qZA(),r.qZA(),r.YNc(11,V,3,4,"a",21),r.BQk()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("innerHTML",r.lcZ(4,4,r.lcZ(5,6,e.mmItemData.image)),r.oJD),r.xp6(5),r.Oqu(e.mmItemData.providerName),r.xp6(2),r.Oqu(e.mmItemData.itemType),r.xp6(1),r.Q6J("ngIf",e.mmItemData.appDeeplink)}}(0,O.hu)("nearby drag-zone");let G=(()=>{class e{constructor(e,t,n,i,o,a,s,l,c){this.document=e,this.store=t,this.nearbyActions=n,this.imageService=i,this.translate=o,this.nearbyService=a,this.storeHelper=s,this.analyticsService=l,this.a11y=c,this.BottomsheetTab=h.fi,this.selectedTab=h.fi.PublicTransit,this.onExpand=new r.vpe,this.unsubscribes=[]}ngAfterViewInit(){this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedMMItem",()=>{this.selectedMicroMobilityItem&&this.getMMItemData()}),this.storeHelper.subscribe("nearby.selectedStop",e=>{e&&this.getStopData()}))}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get selectedStop(){return this.state.nearby.selectedStop}get microMobilityFilter(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMFilterType}get stopImage(){return this.state.nearby.selectedStop&&this.state.nearby.selectedStop.stopImage}get stopWalkTime(){return this.state.nearby.selectedStop&&this.state.nearby.selectedStop.stopWalkTime}get stopWalkDistance(){var e;return null===(e=this.state.nearby.selectedStop)||void 0===e?void 0:e.stopWalkDistance}get stopCode(){return this.state.nearby.selectedStop.stopData.stopCode?this.getStopCodeText(this.state.nearby.selectedStop.stopData.stopCode):null}get walkingTime(){return this.state.nearby.selectedStop.stopWalkTime}get selectedMicroMobilityItem(){return this.state.nearby.selectedMMItem}get microMobilityExistInMetro(){var e;return 0!==(null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.microMobilityTypes.length)}onExpandClick(){this.onExpand.emit()}onTabClick(e){this.analyticsService.trackNearbyBottomsheetTabChange(e),this.selectedTab=e}stopBackButtonClick(){setTimeout(()=>this.store.dispatch(this.nearbyActions.updateSelectedStop(null)),600)}microFilterBackButtonClick(){this.store.dispatch(this.nearbyActions.updateSelectedMMTypeFilter(null))}microSingleItemBackButtonClick(){this.store.dispatch(this.nearbyActions.updateSelectedMMItem(null)),this.focusOnBackButton()}getFilteredMMTypeImageSrc(){return h.eK[this.microMobilityFilter]}getFilteredMMTypeAltKey(){return h.bF[this.microMobilityFilter]}getFilteredMMTypeKey(){return h.AE[this.microMobilityFilter]}getStopCodeText(e){return this.translate.instant("web_stop_id",{param1:e})}getWalkTimeText(e){return this.translate.instant("web_walking_minutes",{param1:e})}getMMItemData(){this.mmItemData={};const e=this.selectedMicroMobilityItem;this.mmItemData={image:this.nearbyService.getMMItemImageByItemType(e,e.itemMMType),providerName:e.categoryName,itemType:this.getSingleItemTypeKey(e.itemMMType),appDeeplink:this.getMMItemAppDeeplink(e)}}getStopData(){const e=this.selectedStop;this.stopData={image:this.stopImage,stopName:e.stopData.stopName,stopCode:e.stopData.stopCode,stopWalkTime:e.stopWalkTime,stopWalkDistance:e.stopWalkDistance}}getSingleItemTypeKey(e){return this.translate.instant(h.bF[e]||h.bF.default)}onAppButtonClick(){const e=this.selectedMicroMobilityItem;this.analyticsService.trackNearbyClickedMMItemOpenAppLink(`${e.itemMMType}, ${e.categoryName}`.toString())}getMMItemAppDeeplink(e){var t,n,i,r,o,a,s,l,c,d,u,p,h,m,g,f,v;if((0,P.gn)())return(null===(t=e.categoryMetaData)||void 0===t?void 0:t.docklessVehicleMetaData)?null===(i=null===(n=e.categoryMetaData)||void 0===n?void 0:n.docklessVehicleMetaData)||void 0===i?void 0:i.iosAppInstallLink:(null===(r=e.categoryMetaData)||void 0===r?void 0:r.docklessCarMetaData)?null===(a=null===(o=e.categoryMetaData)||void 0===o?void 0:o.docklessCarMetaData)||void 0===a?void 0:a.iosAppInstallLink:null;if(null===(s=e.categoryMetaData)||void 0===s?void 0:s.docklessVehicleMetaData){if(null===(c=null===(l=e.categoryMetaData)||void 0===l?void 0:l.docklessVehicleMetaData)||void 0===c?void 0:c.androidDefaultDeepLink)return null===(d=e.categoryMetaData)||void 0===d?void 0:d.docklessVehicleMetaData.androidDefaultDeepLink;if(null===(p=null===(u=e.categoryMetaData)||void 0===u?void 0:u.docklessVehicleMetaData)||void 0===p?void 0:p.androidDeepLink)return`http://play.google.com/store/apps/details?id=${null===(h=e.categoryMetaData)||void 0===h?void 0:h.docklessVehicleMetaData.androidDeepLink}`}return(null===(m=e.categoryMetaData)||void 0===m?void 0:m.docklessCarMetaData)&&(null===(f=null===(g=e.categoryMetaData)||void 0===g?void 0:g.docklessCarMetaData)||void 0===f?void 0:f.androidDeepLink)?`http://play.google.com/store/apps/details?id=${null===(v=e.categoryMetaData)||void 0===v?void 0:v.docklessCarMetaData.androidDeepLink}`:null}focusOnBackButton(){var e;this.a11y.byEnter&&(null===(e=this.document.getElementById("mm-filter-back-link"))||void 0===e||e.focus())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(S.H),r.Y36(w.KD),r.Y36(A.sK),r.Y36(k.M),r.Y36(T.N),r.Y36(M.y),r.Y36(N.F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-drag-zone"]],decls:10,vars:7,consts:[[1,"drag-handle",3,"click"],[1,"tap-to-view",3,"click"],[4,"ngIf"],["id","drag-zone-station-details",1,"station-details-wrapper"],["class","micro-mobility-filter",4,"ngIf"],[1,"single-micro-mobility-bar"],[1,"nearby-card-nav"],["tabindex","0",1,"tab",3,"click","keydown.enter"],["id","single-stop-back-link","tabindex","0",1,"back-link",3,"click","keydown.enter"],["backButton",""],[1,"station-image",3,"innerHTML"],[1,"station-text-wrapper"],[1,"station-title"],[1,"station-subtitle"],[1,"micro-mobility-filter"],["id","mm-filter-back-link","tabindex","0",1,"back-link",3,"click","keydown.enter"],["mvAccessibleSVG","",1,"icon","micro-mobility-icon",3,"src","titleText"],[1,"micro-mobility-name"],["id","mm-single-item-back-link","tabindex","0",1,"back-link",3,"click","keydown.enter"],[1,"line-image",3,"innerHTML"],[1,"single-micro-bar-titles"],["class","micro-open-cta","tabindex","0",3,"href","click","keydown.enter",4,"ngIf"],["tabindex","0",1,"micro-open-cta",3,"href","click","keydown.enter"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.NdJ("click",function(){return t.onExpandClick()}),r.qZA(),r.TgZ(1,"div",1),r.NdJ("click",function(){return t.onExpandClick()}),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,Y,8,10,"div",2),r.TgZ(5,"div",3),r.YNc(6,Z,16,12,"ng-container",2),r.qZA(),r.YNc(7,j,8,7,"div",4),r.TgZ(8,"div",5),r.YNc(9,H,12,8,"ng-container",2),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,5,"web_stations_view_options"),"\n"),r.xp6(2),r.Q6J("ngIf",t.microMobilityExistInMetro),r.xp6(2),r.Q6J("ngIf",t.selectedStop),r.xp6(1),r.Q6J("ngIf",t.microMobilityFilter),r.xp6(2),r.Q6J("ngIf",t.selectedMicroMobilityItem))},directives:[a.O5,I.bk,E.m],pipes:[A.X$,R.z,a.Ov,$.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-drag-zone .drag-handle{padding:8px 0 4px}mv-nearby-drag-zone .drag-handle:before{content:"";display:block;top:.4705882353rem;width:1.8823529412rem;height:.2352941176rem;border-radius:2px;background-color:#bdc3c7;margin:auto}mv-nearby-drag-zone.expanded .nearby-card-nav{opacity:1;height:2.2941176471rem}mv-nearby-drag-zone.expanded .tap-to-view{opacity:0;height:0}mv-nearby-drag-zone .tap-to-view{margin:auto;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;height:2.3529411765rem;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;overflow:hidden;transition:opacity .4s ease,height .2s ease-in-out}mv-nearby-drag-zone .nearby-card-nav{border-bottom:1px solid #ECF0F1;height:0;opacity:0;-webkit-user-select:none;-moz-user-select:none;user-select:none;overflow:hidden;transition:opacity .4s ease,height .2s ease-in-out}mv-nearby-drag-zone .nearby-card-nav .tab{padding:10px 20px;outline:none;font-weight:600;position:relative;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357}mv-nearby-drag-zone .nearby-card-nav .tab:after{opacity:0;color:#f0500c;background:#f0500c;height:3px;width:100%;content:"";position:absolute;bottom:0;left:0;transition:opacity .3s ease}mv-nearby-drag-zone .nearby-card-nav .tab.active{color:#292a30}mv-nearby-drag-zone .nearby-card-nav .tab.active:after{opacity:1}mv-nearby-drag-zone .nearby-card-nav .tab:focus{outline:#302E2E auto 1px}mv-nearby-drag-zone .nearby-card-nav .tab:hover{outline:none}mv-nearby-drag-zone .back-link{color:#292a30;height:15px;padding:11px 12px;margin:0 8px;position:relative;border-radius:50%}mv-nearby-drag-zone .back-link:hover{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards;outline:none}mv-nearby-drag-zone .back-link:before{content:url(/images/icons/arrow_gray.svg);display:block;width:7px;height:15px;position:relative;padding:3px;top:50%;transform:scaleX(-1) translateY(-50%)}html[dir=rtl] mv-nearby-drag-zone .back-link:before{transform:scale(1) translateY(-50%)}mv-nearby-drag-zone .station-details-wrapper{width:100%;display:flex;align-items:center;box-sizing:border-box;padding:16px 0;box-shadow:inset 0 -1px #ecf0f1}mv-nearby-drag-zone .station-details-wrapper .station-text-wrapper{overflow:hidden}html[dir=ltr] mv-nearby-drag-zone .station-details-wrapper .station-image{margin-right:12px}html[dir=rtl] mv-nearby-drag-zone .station-details-wrapper .station-image{margin-left:12px}mv-nearby-drag-zone .station-details-wrapper .station-title{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}mv-nearby-drag-zone .micro-mobility-filter,mv-nearby-drag-zone .single-micro-mobility-bar{align-items:center;box-shadow:inset 0 -1px #ecf0f1;height:70px}html[dir=ltr] mv-nearby-drag-zone .micro-mobility-filter .back-link,html[dir=ltr] mv-nearby-drag-zone .single-micro-mobility-bar .back-link{margin-right:2px}html[dir=rtl] mv-nearby-drag-zone .micro-mobility-filter .back-link,html[dir=rtl] mv-nearby-drag-zone .single-micro-mobility-bar .back-link{margin-left:2px}mv-nearby-drag-zone .micro-mobility-filter .micro-mobility-icon,mv-nearby-drag-zone .single-micro-mobility-bar .micro-mobility-icon{width:26px;height:26px;margin:0}html[dir=ltr] mv-nearby-drag-zone .micro-mobility-filter .micro-mobility-icon,html[dir=ltr] mv-nearby-drag-zone .single-micro-mobility-bar .micro-mobility-icon{margin-right:11px}html[dir=rtl] mv-nearby-drag-zone .micro-mobility-filter .micro-mobility-icon,html[dir=rtl] mv-nearby-drag-zone .single-micro-mobility-bar .micro-mobility-icon{margin-left:11px}html[dir=ltr] mv-nearby-drag-zone .micro-mobility-filter .line-image,html[dir=ltr] mv-nearby-drag-zone .single-micro-mobility-bar .line-image{margin-right:11px}html[dir=rtl] mv-nearby-drag-zone .micro-mobility-filter .line-image,html[dir=rtl] mv-nearby-drag-zone .single-micro-mobility-bar .line-image{margin-left:11px}mv-nearby-drag-zone .micro-mobility-filter .line-image,mv-nearby-drag-zone .micro-mobility-filter .line-image img,mv-nearby-drag-zone .micro-mobility-filter .line-image .mvf-wrapper,mv-nearby-drag-zone .single-micro-mobility-bar .line-image,mv-nearby-drag-zone .single-micro-mobility-bar .line-image img,mv-nearby-drag-zone .single-micro-mobility-bar .line-image .mvf-wrapper{width:38px;height:38px;position:static}mv-nearby-drag-zone .micro-mobility-filter .micro-mobility-name,mv-nearby-drag-zone .single-micro-mobility-bar .micro-mobility-name{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}mv-nearby-drag-zone .micro-mobility-filter p,mv-nearby-drag-zone .single-micro-mobility-bar p{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357;margin:2px 0 0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}html[dir=ltr] mv-nearby-drag-zone .single-micro-mobility-bar{padding-right:20px}html[dir=rtl] mv-nearby-drag-zone .single-micro-mobility-bar{padding-left:20px}mv-nearby-drag-zone .single-micro-mobility-bar .single-micro-bar-titles{flex-grow:1;overflow-x:hidden}mv-nearby-drag-zone .single-micro-mobility-bar .micro-open-cta{background-color:#0a73eb;color:#fff;font-weight:600;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;border-radius:4px;padding:5px 10px;text-decoration:none;white-space:nowrap}html[dir=ltr] mv-nearby-drag-zone .single-micro-mobility-bar .micro-open-cta{margin-left:11px}html[dir=rtl] mv-nearby-drag-zone .single-micro-mobility-bar .micro-open-cta{margin-right:11px}mv-nearby-drag-zone .single-micro-mobility-bar .micro-open-cta:focus{outline:#302E2E auto 1px}mv-nearby-drag-zone .single-micro-mobility-bar .micro-open-cta:hover{outline:none}\n'],encapsulation:2}),e})();var z=n(52959),q=n(26365),J=n(94876),W=n(90248);function Q(e,t){if(1&e&&r._UZ(0,"svg-icon",5),2&e){const e=r.oxw(2);r.MGl("src","images/nearby/empty-state/",e.emptyStateStopsData.imageFileName,""),r.s9C("titleText",e.emptyStateStopsData.subtitle)}}function K(e,t){if(1&e&&(r.TgZ(0,"h3",6),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.emptyStateStopsData.title)}}function X(e,t){if(1&e&&(r.TgZ(0,"p",7),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.emptyStateStopsData.subtitle)}}function ee(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Q,1,2,"svg-icon",2),r.YNc(2,K,2,1,"h3",3),r.YNc(3,X,2,1,"p",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.emptyStateStopsData.imageFileName&&e.emptyStateStopsData.subtitle),r.xp6(1),r.Q6J("ngIf",e.emptyStateStopsData.title),r.xp6(1),r.Q6J("ngIf",e.emptyStateStopsData.subtitle)}}function te(e,t){if(1&e&&r._UZ(0,"svg-icon",5),2&e){const e=r.oxw(2);r.MGl("src","images/nearby/empty-state/",e.emptyStateMMData.imageFileName,""),r.s9C("titleText",e.emptyStateMMData.title)}}function ne(e,t){if(1&e&&(r.TgZ(0,"h3",6),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.emptyStateMMData.title)}}function ie(e,t){if(1&e&&(r.TgZ(0,"p",7),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.emptyStateMMData.subtitle)}}function re(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,te,1,2,"svg-icon",2),r.YNc(2,ne,2,1,"h3",3),r.YNc(3,ie,2,1,"p",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.emptyStateMMData.imageFileName&&e.emptyStateMMData.title),r.xp6(1),r.Q6J("ngIf",e.emptyStateMMData.title),r.xp6(1),r.Q6J("ngIf",e.emptyStateMMData.subtitle)}}let oe=(()=>{class e{constructor(e,t,n){this.store=e,this.translate=t,this.storeHelper=n,this.unsubscribes=[]}ngOnInit(){this.selectedTab===h.fi.PublicTransit&&this.getEmptyStateStopsData(),this.selectedTab===h.fi.SharedTransit&&this.getEmptyStateMMData(),this.unsubscribes.push(this.storeHelper.subscribe("nearby.nearbyStopsEmptyState",e=>{e&&this.getEmptyStateStopsData()}),this.storeHelper.subscribe("nearby.nearbyMMEmptyState",e=>{e&&this.getEmptyStateMMData()}))}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get getStopsEmptyStateType(){return this.state.nearby.nearbyStopsEmptyState}get getMMEmptyStateType(){return this.state.nearby.nearbyMMEmptyState}isPublicTransitTab(){return this.selectedTab===h.fi.PublicTransit}getEmptyStateStopsData(){const e=this.getStopsEmptyStateType;e&&(this.emptyStateStopsData={title:e===h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS?null:this.translate.instant(h.of[e]),subtitle:this.translate.instant(h.d5[e]),imageFileName:h.Dl[e]})}getEmptyStateMMData(){const e=this.getMMEmptyStateType;e&&(this.emptyStateMMData={title:this.translate.instant(h.of[e]),subtitle:this.translate.instant(h.d5[e]),imageFileName:h.Dl[e]})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.d),r.Y36(A.sK),r.Y36(T.N))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-empty-state"]],inputs:{selectedTab:"selectedTab"},decls:3,vars:2,consts:[[1,"wrapper"],[4,"ngIf"],["class","empty-state-image","mvAccessibleSVG","",3,"src","titleText",4,"ngIf"],["class","title",4,"ngIf"],["class","text",4,"ngIf"],["mvAccessibleSVG","",1,"empty-state-image",3,"src","titleText"],[1,"title"],[1,"text"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,ee,4,3,"div",1),r.YNc(2,re,4,3,"div",1),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.isPublicTransitTab()&&t.emptyStateStopsData),r.xp6(1),r.Q6J("ngIf",!t.isPublicTransitTab()&&t.emptyStateMMData))},directives:[a.O5,I.bk,E.m],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-empty-state{height:100%;box-sizing:border-box;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;overflow:hidden}mv-nearby-empty-state .wrapper{padding:20px;text-align:center;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-nearby-empty-state .wrapper .empty-state-image{margin:0;width:auto;height:auto}mv-nearby-empty-state .wrapper .title{margin:8px 0 0;color:#292a30;font-weight:600}mv-nearby-empty-state .wrapper .text{margin:4px 0 0;color:#525357;font-weight:400}\n"],encapsulation:2}),e})();function ae(e,t){1&e&&(r.TgZ(0,"div",7),r._UZ(1,"mv-spinner"),r.qZA())}function se(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.code)}}function le(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1,"\xa0\u2022\xa0"),r.qZA())}function ce(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.walkTime)}}function de(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.distanceText)}}function ue(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1,"\xa0\u2022\xa0"),r.qZA())}function pe(e,t){1&e&&r._UZ(0,"svg-icon",17)}function he(e,t){if(1&e&&(r.TgZ(0,"div",25),r._uU(1),r._UZ(2,"span",26),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.lineArrivalRealTime)}}function me(e,t){if(1&e&&(r.TgZ(0,"div",27),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.lineArrivalStaticTime)}}function ge(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"div",19),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(5).onLineSelected(t)})("keydown.enter",function(){const t=r.CHM(e).$implicit;return r.oxw(5).onLineSelected(t)}),r._UZ(2,"div",20),r.ALo(3,"safeHtml"),r.ALo(4,"async"),r.TgZ(5,"div",21),r.TgZ(6,"span",22),r._uU(7),r.qZA(),r.qZA(),r.YNc(8,he,3,1,"div",23),r.YNc(9,me,2,1,"div",24),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit;r.xp6(2),r.Q6J("innerHTML",r.lcZ(3,4,r.lcZ(4,6,e.lineIcon)),r.oJD),r.xp6(5),r.Oqu(e.destination),r.xp6(1),r.Q6J("ngIf",e.lineArrivalRealTime),r.xp6(1),r.Q6J("ngIf",!e.lineArrivalRealTime)}}function fe(e,t){if(1&e&&(r.TgZ(0,"div",18),r.YNc(1,ge,10,8,"ng-container",6),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Q6J("ngForOf",e.lines)}}function ve(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"div",8),r.TgZ(2,"div",9),r.NdJ("click",function(){const t=r.CHM(e),n=t.$implicit,i=t.index;return r.oxw(3).onItemSelected(n.id,n.walkTime,n.distanceText,i)})("keydown.enter",function(){const t=r.CHM(e),n=t.$implicit,i=t.index;return r.oxw(3).onItemSelected(n.id,n.walkTime,n.distanceText,i)}),r._UZ(3,"div",10),r.ALo(4,"safeHtml"),r.ALo(5,"async"),r.ALo(6,"asyncify"),r.TgZ(7,"div",11),r.TgZ(8,"div",12),r._uU(9),r.qZA(),r.TgZ(10,"div",13),r.YNc(11,se,2,1,"span",14),r.YNc(12,le,2,0,"span",14),r.YNc(13,ce,2,1,"span",14),r.YNc(14,de,2,1,"span",14),r.YNc(15,ue,2,0,"span",14),r.YNc(16,pe,1,0,"svg-icon",15),r.qZA(),r.qZA(),r.qZA(),r.YNc(17,fe,2,1,"div",16),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit,n=r.oxw(3);r.xp6(3),r.Q6J("innerHTML",r.lcZ(4,9,r.lcZ(5,11,r.lcZ(6,13,e.icon))),r.oJD),r.xp6(6),r.Oqu(e.name),r.xp6(2),r.Q6J("ngIf",e.code),r.xp6(1),r.Q6J("ngIf",n.getLocationPermission&&(e.walkTime||!e.walkTime&&e.distanceText)&&e.code),r.xp6(1),r.Q6J("ngIf",n.getLocationPermission&&e.walkTime),r.xp6(1),r.Q6J("ngIf",n.getLocationPermission&&!e.walkTime&&e.distanceText),r.xp6(1),r.Q6J("ngIf",e.wheelchairAccessible),r.xp6(1),r.Q6J("ngIf",e.wheelchairAccessible),r.xp6(1),r.Q6J("ngIf",e.lines)}}function ye(e,t){if(1&e&&(r.TgZ(0,"div",4),r.YNc(1,ae,2,0,"div",5),r.YNc(2,ve,18,15,"ng-container",6),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngIf",!e.stops||!e.stops.length),r.xp6(1),r.Q6J("ngForOf",e.stops)}}function be(e,t){if(1&e&&r._UZ(0,"mv-nearby-empty-state",28),2&e){const e=r.oxw(2);r.Q6J("selectedTab",e.publicTransitTab)}}function _e(e,t){if(1&e&&(r.TgZ(0,"div",1),r.YNc(1,ye,3,2,"div",2),r.YNc(2,be,1,1,"mv-nearby-empty-state",3),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.emptyStateType),r.xp6(1),r.Q6J("ngIf",e.emptyStateType)}}let Te=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d){this.document=e,this.store=t,this.imageService=n,this.permissionService=i,this.nearbyActions=r,this.translate=o,this.metroService=a,this.nearbyService=s,this.storeHelper=l,this.lineActions=c,this.analyticsService=d,this.numOfStopsLineDepartures=2,this.numOfLinesToDisplay=2,this.numOfStopsToDisplay=10,this.unsubscribes=[],this.publicTransitTab=h.fi.PublicTransit}ngOnInit(){this.nearbyStopsGroupsOnMap&&(null!==this.emptyStateType&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(null)),this.updateStopsData()),this.nearbyStopsGroupsOnMap.length||this.updateEmptyState(),this.unsubscribes.push(this.storeHelper.subscribe("nearby.stopsMapData.displayedGroupsOnMap",e=>{e.length>0?(this.stops=[],null!==this.emptyStateType&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(null)),this.updateStopsData()):this.updateEmptyState()}),this.storeHelper.subscribe("nearby.stopsExistOnCurrentTiles",e=>{!this.nearbyStopsGroupsOnMap.length&&this.nearbyCurrentZoomLevel>=h.lt&&(e?this.emptyStateType!==h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS)):this.emptyStateType!==h.CV.NO_STATIONS_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.NO_STATIONS_TO_DISPLAY)))}),this.storeHelper.subscribe("nearby.currentMapZoom",e=>{!this.nearbyStopsGroupsOnMap.length&&!this.nearbyStopsExistOnCurrentTiles&&(e>=h.lt?this.emptyStateType!==h.CV.NO_STATIONS_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.NO_STATIONS_TO_DISPLAY)):this.emptyStateType!==h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS)))}))}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get nearbyStops(){return this.state.nearby.stopsAdditionalData}get stopsArrivals(){return this.state.nearby.stopsArrivals}get nearbyStopsMapData(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.stopsDataMapGroups}get nearbyStopsGroupsOnMap(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.displayedGroupsOnMap}get nearbyStopsAdditionalDataExistingGroups(){return this.state.nearby.stopsAdditionalDataExistingGroups}get emptyStateType(){return this.state.nearby.nearbyStopsEmptyState}get nearbyStopsExistOnCurrentTiles(){return this.state.nearby.stopsExistOnCurrentTiles}get nearbyCurrentZoomLevel(){return this.state.nearby.currentMapZoom}getLocationPermission(){return this.nearbyMap.hasLocationPermission}getWalkTimeText(e){return this.translate.instant("web_walking_minutes",{param1:e})}getDistanceKmText(e){return this.translate.instant("units_kilometers_short",{param1:e.toFixed(2)})}getStopCodeText(e){return this.translate.instant("web_stop_id",{param1:e})}updateStopsData(){return(0,s.mG)(this,void 0,void 0,function*(){const e=this.nearbyStopsMapData;let t=[],n=[];const i=this.nearbyStopsGroupsOnMap,r=this.nearbyStopsAdditionalDataExistingGroups?this.nearbyStopsAdditionalDataExistingGroups:[];let o=[];if(i.length>0){i.forEach(i=>{r.includes(i)||(t=t.concat(e[i.displayedGroupOnMap].mapItems.map(e=>e.itemId))),n=n.concat(e[i.displayedGroupOnMap].mapItems.map(e=>e.itemId))}),t.length>0&&(yield this.store.dispatch(this.nearbyActions.getStopsListData(t,i)));const a=this.nearbyStops,l=[];n.forEach(e=>{l.push(a[e])});const d=yield this.nearbyMap.getMapCenter();l.sort((e,t)=>this.nearbyService.getDistanceFromLocation(e.stopLocation,d,!1)-this.nearbyService.getDistanceFromLocation(t.stopLocation,d,!1));const u=[...l].slice(0,this.numOfStopsToDisplay),p=[...u].slice(0,2).map(e=>e.stopId),m=this.stopsArrivals,g=[];let f=[];if(m?p.forEach(e=>{const t=m.find(t=>t.stopId===e);t?g.push(t):f.push(e)}):f=[...p],f.length>0){yield this.store.dispatch(this.nearbyActions.getStopsArrivals(f,!0));const e=this.stopsArrivals;f.forEach(t=>{g.push(e.find(e=>e.stopId===t))})}o=yield Promise.all(u.map(e=>(0,s.mG)(this,void 0,void 0,function*(){var t,n,i;let r;6461==e.image.imageId?r=yield this.imageService.getImageHTML(e.image.imageId,[e.image.parameters[0]],void 0,e.stopName):e.image.imageId===v.nM.STOP_MULTI_AGENCY_MVF?r=yield this.imageService.getMultiLineMVF(e.image.parameters):(r=yield this.imageService.getImageHTML(null===(i=null===(n=null===(t=e.imageRefSet)||void 0===t?void 0:t.images[0])||void 0===n?void 0:n.imageRef)||void 0===i?void 0:i.imageId,null,null,this.translate.instant("a11y_station_image")),(!r||""===r)&&(r=yield this.imageService.getImageHTML(e.image.imageId,null,void 0,e.stopName)));const o=yield this.getUserLocationOrMapCenter(),a=this.nearbyService.getDistanceFromLocation(e.stopLocation,o.location,o.hasUserLocation),s=c._.fromMvLatLon(e.stopLocation),l=Math.round(a/h.QQ*60),d=l<=60?this.nearbyService.getWalkTimeText(l):null,u=l>60?this.nearbyService.getDistanceKmText(a):null;return{name:e.stopName,id:e.stopId,code:e.stopCode?this.getStopCodeText(e.stopCode):null,icon:r,distanceFromUserLocation:a,wheelchairAccessible:e.wheelchairAccessible,walkTime:this.getLocationPermission()?d:null,distanceText:this.getLocationPermission()?u:null,stopLocation:s,stopRouteType:e.routeType}})));for(let e=0;e<this.numOfStopsLineDepartures;e++)if(g[e]){const t=o.findIndex(t=>t.id===g[e].stopId),n=[];for(let i=0;i<this.numOfLinesToDisplay;i++)if(g[e].lineArrivals[i]){const t=g[e].lineArrivals[i].lineData;n.push({destination:t.destination,lineIcon:this.nearbyService.getLineImageHtml(t.agencyId,t.color,t.lineNumber,t.caption1,t.caption2,t.imageRefSet,t.innerImageIds),lineArrivalRealTime:g[e].lineArrivals[i].relativeRealTimeSpanSeconds?this.nearbyService.getRealTimeArrivalTime(g[e].lineArrivals[i].relativeRealTimeSpanSeconds,g[0].epochDay):null,lineArrivalStaticTime:!g[e].lineArrivals[i].relativeRealTimeSpanSeconds&&g[e].lineArrivals[i].relativeStaticTimeSpanSeconds?this.nearbyService.getStaticTimeAbsolute(g[e].lineArrivals[i].relativeStaticTimeSpanSeconds):null,lineGroupId:t.groupId,lineId:g[e].lineArrivals[i].lineId})}o[t].lines=n}}this.stops=o})}getUserLocationOrMapCenter(){return(0,s.mG)(this,void 0,void 0,function*(){return this.nearbyMap.hasLocationPermission?{location:yield this.nearbyMap.mapLocation.getLocation(),hasUserLocation:!0}:{location:yield this.nearbyMap.getMapCenter(),hasUserLocation:!1}})}onItemSelected(e,t,n,i){this.document.body.classList.remove("nearby-split-over"),this.store.dispatch(this.nearbyActions.updateSelectedStop(e,t,n,i)),this.analyticsService.trackNearbyClickOnStopFromList()}onLineSelected(e){var t,n,i;return(0,s.mG)(this,void 0,void 0,function*(){(null===(i=null===(n=null===(t=this.state.customer)||void 0===t?void 0:t.currentCustomer)||void 0===n?void 0:n.designConfiguration)||void 0===i?void 0:i.hideLines)||(this.analyticsService.trackNearbyClickOnLineFromList(e.lineArrivalRealTime),yield this.store.dispatch(this.lineActions.loadLineGroup(e.lineGroupId,e.lineId)))})}updateEmptyState(){this.nearbyStopsExistOnCurrentTiles?this.emptyStateType!==h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS)):(this.nearbyCurrentZoomLevel<h.lt&&this.emptyStateType!==h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.TOO_ZOOMED_OUT_TO_DISPLAY_STATIONS)),this.nearbyCurrentZoomLevel>=h.lt&&this.emptyStateType!==h.CV.NO_STATIONS_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateStopsEmptyState(h.CV.NO_STATIONS_TO_DISPLAY)))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(w.KD),r.Y36(u.$),r.Y36(S.H),r.Y36(A.sK),r.Y36(q.V),r.Y36(k.M),r.Y36(T.N),r.Y36(J.J),r.Y36(M.y))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-stops-list"]],inputs:{nearbyMap:"nearbyMap",isExpanded:"isExpanded",selectedTab:"selectedTab"},decls:1,vars:1,consts:[["class","nearby-map-card-content",4,"ngIf"],[1,"nearby-map-card-content"],["class","station-stops-list",4,"ngIf"],[3,"selectedTab",4,"ngIf"],[1,"station-stops-list"],["class","spinner",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"spinner"],[1,"station-item"],["tabindex","0",1,"station-details-wrapper",3,"click","keydown.enter"],[1,"station-image",3,"innerHTML"],[1,"station-text-wrapper"],[1,"station-title"],[1,"station-subtitle"],[4,"ngIf"],["class","accessibility-icon","src","images/wheelchair.svg",4,"ngIf"],["class","lines-list",4,"ngIf"],["src","images/wheelchair.svg",1,"accessibility-icon"],[1,"lines-list"],["tabindex","0",1,"line-item",3,"click","keydown.enter"],[1,"line-image",3,"innerHTML"],[1,"line-title-wrapper","flex-col"],[1,"line-title"],["class","line-time rt",4,"ngIf"],["class","line-time",4,"ngIf"],[1,"line-time","rt"],[1,"realtime-icon"],[1,"line-time"],[3,"selectedTab"]],template:function(e,t){1&e&&r.YNc(0,_e,3,2,"div",0),2&e&&r.Q6J("ngIf",t.isExpanded)},directives:[a.O5,a.sg,W.O,I.bk,oe],pipes:[R.z,a.Ov,$.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-stops-list{height:inherit;width:100%;left:0;top:calc(40% - 56px);box-sizing:border-box}mv-nearby-stops-list.minimised .nearby-map-card-content .tap-to-view{opacity:0;height:0}mv-nearby-stops-list .nearby-map-card-content{height:100%;width:100%;overflow-y:auto;background-color:#fff;color:#525357;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;box-sizing:border-box}mv-nearby-stops-list .nearby-map-card-content .station-stops-list{height:inherit}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .spinner{position:static;position:initial}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item{border-bottom:1px solid #ECF0F1;padding:0}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper{padding:16px 20px 22px}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper:hover{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper:after{content:"";background:no-repeat url(/images/icons/arrow_bright_gray.svg) center/7px 12px;position:absolute;height:100%;width:7px;top:0}html[dir=ltr] mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper:after{right:20px}html[dir=rtl] mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper:after{left:20px}html[dir=rtl] mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper:after{transform:scaleX(-1)}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-details-wrapper .station-image{margin-bottom:8px}html[dir=ltr] mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper{padding-right:1.1764705882rem}html[dir=rtl] mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper{padding-left:1.1764705882rem}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper .station-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper .station-subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;margin-top:.1764705882rem}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper .station-subtitle .accessibility-icon,mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .station-text-wrapper .station-subtitle svg{height:.7058823529rem;width:.7058823529rem}mv-nearby-stops-list .nearby-map-card-content .station-stops-list .station-item .line-last-departure{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23}mv-nearby-stops-list .line-item{min-height:48px;padding-top:9px;padding-bottom:9px}mv-nearby-stops-list .line-item .line-title-wrapper{flex-grow:1}html[dir=ltr] mv-nearby-stops-list .line-item .line-title-wrapper{padding-right:1.1764705882rem}html[dir=rtl] mv-nearby-stops-list .line-item .line-title-wrapper{padding-left:1.1764705882rem}mv-nearby-stops-list .line-item .line-title-wrapper .line-title:not(:only-child){color:#292a30;font-weight:600}mv-nearby-stops-list .line-item .line-time{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;font-weight:600;color:#292a30;white-space:nowrap}mv-nearby-stops-list .line-item .line-time.rt{position:relative;color:#038844}html[dir=rtl] mv-nearby-stops-list .line-item .line-time.rt:before,html[dir=rtl] mv-nearby-stops-list .line-item .line-time.rt:after{transform:translateY(.1764705882rem) scaleX(-1)}mv-nearby-stops-list .line-item .line-time.rt:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:.1176470588rem;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-nearby-stops-list .line-item .line-time.rt:before{left:-8px}html[dir=rtl] mv-nearby-stops-list .line-item .line-time.rt:before{right:-8px}@media (prefers-reduced-motion: reduce){mv-nearby-stops-list .line-item .line-time.rt:before{-webkit-animation:none;animation:none}}mv-nearby-stops-list .line-item .line-time.rt:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:1.0588235294rem;position:absolute;top:-.1176470588rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-nearby-stops-list .line-item .line-time.rt:after{left:-12px}html[dir=rtl] mv-nearby-stops-list .line-item .line-time.rt:after{right:-12px}@media (prefers-reduced-motion: reduce){mv-nearby-stops-list .line-item .line-time.rt:after{-webkit-animation:none;animation:none}}mv-nearby-stops-list .line-last-departure{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23}\n'],encapsulation:2}),e})();var Se=n(98922),xe=n(15357),we=n(51611),ke=n(54366),Me=n(53399);function Le(e,t){if(1&e&&(r.TgZ(0,"div",10),r._uU(1),r._UZ(2,"span",11),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.lineArrivalRealTime)}}function Ae(e,t){if(1&e&&(r.TgZ(0,"div",12),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.lineArrivalStaticTime)}}function Ie(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onLineSelected(t)})("keydown.enter",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onLineSelected(t)}),r._UZ(1,"div",5),r.ALo(2,"safeHtml"),r.ALo(3,"async"),r.TgZ(4,"div",6),r.TgZ(5,"span",7),r._uU(6),r.qZA(),r.qZA(),r.YNc(7,Le,3,1,"div",8),r.YNc(8,Ae,2,1,"div",9),r.qZA()}if(2&e){const e=t.$implicit;r.xp6(1),r.Q6J("innerHTML",r.lcZ(2,4,r.lcZ(3,6,e.lineIcon)),r.oJD),r.xp6(5),r.Oqu(e.destination),r.xp6(1),r.Q6J("ngIf",e.lineArrivalRealTime),r.xp6(1),r.Q6J("ngIf",!e.lineArrivalRealTime)}}function Ee(e,t){if(1&e&&(r.TgZ(0,"div",2),r.YNc(1,Ie,9,8,"div",3),r.ALo(2,"async"),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,e.departures$))}}let Ce=(()=>{class e{constructor(e,t,n,i,r,o,a,s){this.document=e,this.store=t,this.nearbyService=n,this.translate=i,this.analyticsService=r,this.lineActions=o,this.storeHelper=a,this.a11y=s,this.unsubscribes=[]}ngAfterViewInit(){return(0,s.mG)(this,void 0,void 0,function*(){this.reportAnalyticsStopData(),this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedStop",e=>{e&&this.reportAnalyticsStopData()})),this.departures$=(0,Se.F)(6e4).pipe((0,we.O)(0),(0,ke.w)(()=>(0,xe.D)(this.nearbyService.getStopsArrivals([this.state.nearby.selectedStop.stopData.stopId],!1))),(0,Me.U)(e=>e.stopsArrivals[0].lineArrivals.map(e=>({destination:e.lineData.destination,lineIcon:this.nearbyService.getLineImageHtml(e.lineData.agencyId,e.lineData.color,e.lineData.lineNumber,e.lineData.caption1,e.lineData.caption2,e.lineData.imageRefSet,e.lineData.innerImageIds),lineArrivalRealTime:e.relativeRealTimeSpanSeconds?this.nearbyService.getRealTimeArrivalTime(e.relativeRealTimeSpanSeconds,this.state.nearby.selectedStop.stopArrivals[0].epochDay):null,lineArrivalStaticTime:!e.relativeRealTimeSpanSeconds&&e.relativeStaticTimeSpanSeconds?this.nearbyService.getStaticTimeAbsolute(e.relativeStaticTimeSpanSeconds):null,lineGroupId:e.lineData.groupId,lineId:e.lineId})))),this.focusOnBackButton()})}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get nearbySelectedStop(){return this.state.nearby.selectedStop}get linesTitles(){return this.getUniqueLineTitles().join(", ")}LinesTitlesList(e){return this.translate.instant("web_lines",{lines_list:e})}getUniqueLineTitles(){return this.state.nearby.selectedStop.stopArrivals[0].lineArrivals.map(e=>e.lineData.lineNumber).filter((e,t,n)=>n.indexOf(e)===t)}focusOnBackButton(){var e;this.a11y.byEnter&&(null===(e=this.document.getElementById("single-stop-back-link"))||void 0===e||e.focus())}reportAnalyticsStopData(){const e=this.nearbySelectedStop,t=`${e.stopData.routeType}, ${e.stopPositionInList}, ${e.stopWalkTime}, ${this.getUniqueLineTitles().length}, ${e.stopArrivals[0].lineArrivals.length}`;this.analyticsService.trackNearbyClickedStopData(t)}onLineSelected(e){var t,n,i;return(0,s.mG)(this,void 0,void 0,function*(){(null===(i=null===(n=null===(t=this.state.customer)||void 0===t?void 0:t.currentCustomer)||void 0===n?void 0:n.designConfiguration)||void 0===i?void 0:i.hideLines)||(this.analyticsService.trackNearbyClickOnLineFromSingleStop(e.lineArrivalRealTime),yield this.store.dispatch(this.lineActions.loadLineGroup(e.lineGroupId,e.lineId)))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(k.M),r.Y36(A.sK),r.Y36(M.y),r.Y36(J.J),r.Y36(T.N),r.Y36(N.F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-card-single-stop"]],decls:4,vars:2,consts:[[1,"lines-text-list"],["class","lines-list",4,"ngIf"],[1,"lines-list"],["class","line-item","tabindex","0",3,"click","keydown.enter",4,"ngFor","ngForOf"],["tabindex","0",1,"line-item",3,"click","keydown.enter"],[1,"line-image",3,"innerHTML"],[1,"line-title-wrapper","flex-col"],[1,"line-title"],["class","line-time rt",4,"ngIf"],["class","line-time",4,"ngIf"],[1,"line-time","rt"],[1,"realtime-icon"],[1,"line-time"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"span"),r._uU(2),r.qZA(),r.qZA(),r.YNc(3,Ee,3,3,"div",1)),2&e&&(r.xp6(2),r.Oqu(t.LinesTitlesList(t.linesTitles)),r.xp6(1),r.Q6J("ngIf",t.departures$))},directives:[a.O5,a.sg],pipes:[a.Ov,R.z],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-card-single-stop .lines-text-list{padding:12px 20px;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357}mv-nearby-card-single-stop .lines-text-list span{-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;display:-webkit-box}\n"],encapsulation:2}),e})();function De(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"a",9),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onFilterSelected(t)})("keydown.enter",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onFilterSelected(t)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw(3);r.ekj("active",n.isMMTypeDisplayed(e)),r.xp6(1),r.Oqu(n.getMicroMobilityTypesKey(e))}}function Pe(e,t){if(1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"div",7),r.YNc(2,De,2,3,"a",8),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngForOf",e.microMobilityTypes)}}function Oe(e,t){1&e&&(r.TgZ(0,"div",10),r._UZ(1,"mv-spinner"),r.qZA())}function Ne(e,t){if(1&e&&(r.TgZ(0,"span",19),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.ekj("green","green"===t.getBatteryLevelColor(e.itemBatteryOrFuelLevel))("orange","orange"===t.getBatteryLevelColor(e.itemBatteryOrFuelLevel))("red","red"===t.getBatteryLevelColor(e.itemBatteryOrFuelLevel)),r.xp6(1),r.hij("",e.itemBatteryOrFuelLevel,"%")}}function Re(e,t){if(1&e&&(r.TgZ(0,"span",19),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.ekj("green","green"===t.getAvailableBikesColor(e.numAvailableBikes))("red","red"===t.getAvailableBikesColor(e.numAvailableBikes)),r.xp6(1),r.Oqu(e.availableBikesText)}}const $e=function(e){return{param1:e}};function Ye(e,t){if(1&e&&(r.TgZ(0,"div",20),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(r.xi3(2,1,"units_minutes_text",r.VKq(4,$e,e.walkingTimeDistance.walkingTime)))}}function Fe(e,t){if(1&e&&(r.TgZ(0,"div",20),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(r.xi3(2,1,"units_kilometers_short",r.VKq(4,$e,e.walkingTimeDistance.walkingDistance)))}}function Be(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",11),r.NdJ("click",function(){const t=r.CHM(e),n=t.$implicit,i=t.index;return r.oxw(2).onItemSelected(n,i)})("keydown.enter",function(){const t=r.CHM(e),n=t.$implicit,i=t.index;return r.oxw(2).onItemSelected(n,i)}),r._UZ(1,"div",12),r.ALo(2,"safeHtml"),r.ALo(3,"async"),r.TgZ(4,"div",13),r.TgZ(5,"span",14),r._uU(6),r.qZA(),r.TgZ(7,"span",15),r._uU(8),r.qZA(),r.YNc(9,Ne,2,7,"span",16),r.YNc(10,Re,2,5,"span",17),r.qZA(),r.YNc(11,Ye,3,6,"div",18),r.YNc(12,Fe,3,6,"div",18),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw(2);r.xp6(1),r.Q6J("innerHTML",r.lcZ(2,7,r.lcZ(3,9,e.image)),r.oJD),r.xp6(5),r.Oqu(e.providerName),r.xp6(2),r.Oqu(e.itemTypeText),r.xp6(1),r.Q6J("ngIf",e.itemBatteryOrFuelLevel),r.xp6(1),r.Q6J("ngIf",e.availableBikesText),r.xp6(1),r.Q6J("ngIf",n.hasLocationPermission()&&e.walkingTimeDistance.walkingTime<=60),r.xp6(1),r.Q6J("ngIf",n.hasLocationPermission()&&e.walkingTimeDistance.walkingTime>60)}}function Ue(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Pe,3,1,"div",3),r.YNc(2,Oe,2,0,"div",4),r.YNc(3,Be,13,11,"div",5),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.microMobilityFilter&&e.microMobilityItemsTypes&&e.microMobilityItemsTypes.length>1),r.xp6(1),r.Q6J("ngIf",!e.microMobilityDisplayedItems),r.xp6(1),r.Q6J("ngForOf",e.microMobilityDisplayedItems)}}function Ze(e,t){if(1&e&&r._UZ(0,"mv-nearby-empty-state",21),2&e){const e=r.oxw();r.Q6J("selectedTab",e.sharedTransitTab)}}let je=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this.document=e,this.store=t,this.imageService=n,this.translate=i,this.nearbyService=r,this.storeHelper=o,this.nearbyActions=a,this.analyticsService=s,this.a11y=l,this.numOfItemsToDisplayInList=40,this.microMobilityItemsTypes=[],this.unsubscribes=[],this.sharedTransitTab=h.fi.SharedTransit}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){this.nearbyMMTilesOnMap&&(yield this.getDisplayedMicroMobilityItemsData()),this.unsubscribes.push(this.storeHelper.subscribe("nearby.microMobilityData.displayedMMTilesOnMap",()=>(0,s.mG)(this,void 0,void 0,function*(){yield this.getDisplayedMicroMobilityItemsData()})),this.storeHelper.subscribe("nearby.microMobilityData.displayedMMFilterType",e=>(0,s.mG)(this,void 0,void 0,function*(){e||(yield this.onFilterRemoved())})))})}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get microMobilityTypes(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.microMobilityTypes}get allMMTiles(){return this.state.nearby.microMobilityData.tiles}get microMobilityFilter(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMFilterType}get nearbyMMTilesOnMap(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMTilesOnMap}get nearbyMMEmptyState(){return this.state.nearby.nearbyMMEmptyState}get nearbyCurrentZoom(){return this.state.nearby.currentMapZoom}hasLocationPermission(){return this.nearbyMap.hasLocationPermission}getMicroMobilityTypesKey(e){return this.translate.instant(h.AE[e])}getDisplayedMicroMobilityItemsData(){return(0,s.mG)(this,void 0,void 0,function*(){const e=this.allMMTiles,t=this.nearbyMMTilesOnMap.map(e=>e.tileLatLng);let n=[];t.forEach(t=>{const i=e.find(e=>e.tileX==t.tileX&&e.tileY==t.tileY);i&&i.items&&(n=n.concat(i.items))});const i=yield this.nearbyMap.getMapCenter();n.sort((e,t)=>this.nearbyService.getDistanceFromLocation(e.location,i,!1)-this.nearbyService.getDistanceFromLocation(t.location,i,!1)),n=n.filter(e=>e.maxZoom>18),n.length||(this.microMobilityFilter&&this.nearbyMMEmptyState!==h.CV.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateMMEmptyState(h.CV.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY)),!this.microMobilityFilter&&this.nearbyMMEmptyState!==h.CV.NO_MM_ITEMS_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateMMEmptyState(h.CV.NO_MM_ITEMS_TO_DISPLAY))),n.length>0&&this.nearbyMMEmptyState&&this.store.dispatch(this.nearbyActions.updateMMEmptyState(null));const r=[...n].slice(0,this.numOfItemsToDisplayInList);this.microMobilityItemsTypes=[],this.allMicroMobilityListItems=yield Promise.all(r.map(e=>(0,s.mG)(this,void 0,void 0,function*(){var t,n;const i=e.itemMMType;this.microMobilityItemsTypes&&!this.microMobilityItemsTypes.includes(i)&&this.microMobilityItemsTypes.push(i);const r=this.nearbyService.getMMItemImageByItemType(e,i),o=yield this.getWalkingDistanceFromUserLocation(e.location);let a=null,s=null;return i!==h.EP.BIKE_STATION?a=this.getBatteryOrFuelLevel(e,i):s=this.getAvailableBikes(e),{image:r,providerName:e.categoryName,walkingTimeDistance:o,itemType:i,itemTypeText:this.getSingleItemTypeKey(i),itemBatteryOrFuelLevel:a,availableBikesText:s,numAvailableBikes:null===(n=null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)||void 0===n?void 0:n.availableBikes,itemLocation:e.location}}))),this.microMobilityFilter?(this.microMobilityDisplayedItems=this.allMicroMobilityListItems.filter(e=>e.itemType===this.microMobilityFilter),!this.microMobilityDisplayedItems.length&&this.nearbyMMEmptyState!==h.CV.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY&&this.store.dispatch(this.nearbyActions.updateMMEmptyState(h.CV.NO_MM_ITEMS_IN_FILTER_TO_DISPLAY))):this.microMobilityDisplayedItems=this.allMicroMobilityListItems})}isMMTypeDisplayed(e){return this.microMobilityItemsTypes&&this.microMobilityItemsTypes.includes(e)}getWalkingDistanceFromUserLocation(e){return(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.getUserLocationOrMapCenter(),n=this.nearbyService.getDistanceFromLocation(e,t.location,t.hasUserLocation);return{walkingTime:Math.round(n/h.QQ*60),walkingDistance:Math.round(10*n)/10}})}getUserLocationOrMapCenter(){return(0,s.mG)(this,void 0,void 0,function*(){return this.nearbyMap.hasLocationPermission?{location:yield this.nearbyMap.mapLocation.getLocation(),hasUserLocation:!0}:{location:yield this.nearbyMap.getMapCenter(),hasUserLocation:!1}})}getBatteryLevelColor(e){if(e){if(e>60)return"green";if(e<=60&&e>=20)return"orange";if(e<20)return"red"}return null}getAvailableBikesColor(e){return e||0===e?e>1?"green":"red":null}getSingleItemTypeKey(e){return this.translate.instant(h.bF[e]||h.bF.default)}getBatteryOrFuelLevel(e,t){var n,i,r,o,a,s;return t===h.EP.DOCKLESS_CAR?(null===(i=null===(n=e.itemMetaData)||void 0===n?void 0:n.docklessCar)||void 0===i?void 0:i.batteryLevel)?e.itemMetaData.docklessCar.batteryLevel:null===(o=null===(r=e.itemMetaData)||void 0===r?void 0:r.docklessCar)||void 0===o?void 0:o.fuelLevel:null===(s=null===(a=e.itemMetaData)||void 0===a?void 0:a.docklessVehicle)||void 0===s?void 0:s.batteryLevel}getAvailableBikes(e){var t,n;const i=null===(n=null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)||void 0===n?void 0:n.availableBikes;return i||0===i?1===i?this.translate.instant("web_stations_shared_bike_available"):0===i?this.translate.instant("web_stations_shared_bike_not_available"):this.translate.instant("web_stations_shared_bikes_available",{Number:i}):null}getImageByItemType(e,t){var n,i,r,o,a,s,l,c,d,u,p,m,g,f;return t===h.EP.DOCKLESS_CAR?this.imageService.getImageHTML(null===(r=null===(i=null===(n=e.categoryMetaData)||void 0===n?void 0:n.docklessCarMetaData)||void 0===i?void 0:i.image)||void 0===r?void 0:r.imageId,null===(s=null===(a=null===(o=e.categoryMetaData)||void 0===o?void 0:o.docklessCarMetaData)||void 0===a?void 0:a.image)||void 0===s?void 0:s.params):t===h.EP.BIKE_STATION?this.imageService.getImageHTML(null===(c=null===(l=e.categoryMetaData)||void 0===l?void 0:l.basicProviderMetaData)||void 0===c?void 0:c.serviceImageId):this.imageService.getImageHTML(null===(p=null===(u=null===(d=e.categoryMetaData)||void 0===d?void 0:d.docklessVehicleMetaData)||void 0===u?void 0:u.image)||void 0===p?void 0:p.imageId,null===(f=null===(g=null===(m=e.categoryMetaData)||void 0===m?void 0:m.docklessVehicleMetaData)||void 0===g?void 0:g.image)||void 0===f?void 0:f.parameters)}onItemSelected(e,t){const n=c._.fromMvLatLon(e.itemLocation),i=this.nearbyService.toLatLonTiles(n),r=this.allMMTiles.find(e=>e.tileX==i.tileX&&e.tileY==i.tileY);if(null==r?void 0:r.items){const n=r.items.find(t=>t.location.latitude==e.itemLocation.latitude&&t.location.longitude==e.itemLocation.longitude);if(n){this.store.dispatch(this.nearbyActions.updateSelectedMMItem(n));const i=this.microMobilityTypes.filter(e=>this.isMMTypeDisplayed(e)),r=this.microMobilityDisplayedItems.map(e=>e.providerName).filter((e,t,n)=>n.indexOf(e)===t);this.analyticsService.trackNearbyClickedMMItemData(`${n.itemMMType}, ${n.categoryName}, ${t}, ${e.walkingTimeDistance.walkingTime}, ${e.itemBatteryOrFuelLevel}, [${i}], [${r}], ${this.microMobilityFilter}`.toString())}}}onFilterSelected(e){return(0,s.mG)(this,void 0,void 0,function*(){this.isMMTypeDisplayed(e)&&(this.microMobilityDisplayedItems=this.allMicroMobilityListItems.filter(t=>t.itemType===e),this.store.dispatch(this.nearbyActions.updateSelectedMMTypeFilter(e)),yield this.nearbyMap.removeLayersForMMFilter(e),this.analyticsService.trackNearbyMMFilterSelected(e.toString()),setTimeout(()=>{this.focusOnBackButton()},500))})}onFilterRemoved(){return(0,s.mG)(this,void 0,void 0,function*(){this.allMicroMobilityListItems.length>0&&this.nearbyMMEmptyState&&(yield this.store.dispatch(this.nearbyActions.updateMMEmptyState(null))),0==this.allMicroMobilityListItems.length&&this.nearbyMMEmptyState!==h.CV.NO_MM_ITEMS_TO_DISPLAY&&(yield this.store.dispatch(this.nearbyActions.updateMMEmptyState(h.CV.NO_MM_ITEMS_TO_DISPLAY))),document.getElementById("micro-mobility-list-container").scrollTo(0,0),this.microMobilityDisplayedItems=this.allMicroMobilityListItems,yield this.nearbyMap.addLayersForAllItemsMMFilter()})}focusOnBackButton(){var e;this.a11y.byEnter&&(null===(e=this.document.getElementById("mm-filter-back-link"))||void 0===e||e.focus())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(w.KD),r.Y36(A.sK),r.Y36(k.M),r.Y36(T.N),r.Y36(S.H),r.Y36(M.y),r.Y36(N.F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-micro-list"]],inputs:{nearbyMap:"nearbyMap",isExpanded:"isExpanded"},decls:3,vars:2,consts:[["id","micro-mobility-list-container",1,"lines-list"],[4,"ngIf"],[3,"selectedTab",4,"ngIf"],["class","filter-mobility-type",4,"ngIf"],["class","spinner",4,"ngIf"],["class","line-item","tabindex","0",3,"click","keydown.enter",4,"ngFor","ngForOf"],[1,"filter-mobility-type"],[1,"filter-items"],["tabindex","0",3,"active","click","keydown.enter",4,"ngFor","ngForOf"],["tabindex","0",3,"click","keydown.enter"],[1,"spinner"],["tabindex","0",1,"line-item",3,"click","keydown.enter"],[1,"line-image",3,"innerHTML"],[1,"line-title-wrapper","flex-col"],[1,"line-title"],[1,"line-subtitle"],["class","line-value",3,"green","orange","red",4,"ngIf"],["class","line-value",3,"green","red",4,"ngIf"],["class","line-time",4,"ngIf"],[1,"line-value"],[1,"line-time"],[3,"selectedTab"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Ue,4,3,"div",1),r.YNc(2,Ze,1,1,"mv-nearby-empty-state",2),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",!t.nearbyMMEmptyState),r.xp6(1),r.Q6J("ngIf",t.nearbyMMEmptyState))},directives:[a.O5,a.sg,W.O,oe],pipes:[R.z,a.Ov,A.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-micro-list{height:calc(100% - 30px)}mv-nearby-micro-list .filter-mobility-type{margin:0;padding:16px 0;height:1.8823529412rem}mv-nearby-micro-list .filter-mobility-type .filter-items{display:flex;align-items:center;overflow:auto hidden;padding:0 20px}mv-nearby-micro-list .filter-mobility-type .filter-items::-webkit-scrollbar{width:0;background:transparent}mv-nearby-micro-list .filter-mobility-type .filter-items:after{content:"";width:20px;min-width:20px;height:20px;display:inline-block}mv-nearby-micro-list .filter-mobility-type a{white-space:nowrap;text-decoration:none;padding:7px 16px;color:#525357;border-radius:16px;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;background-color:#ecf0f1;box-sizing:border-box;display:inline-block;transition:all .3s ease-in-out}html[dir=ltr] mv-nearby-micro-list .filter-mobility-type a:not(:last-of-type){margin-right:11px}html[dir=rtl] mv-nearby-micro-list .filter-mobility-type a:not(:last-of-type){margin-left:11px}mv-nearby-micro-list .filter-mobility-type a.active{color:#525357;background-color:#0a73eb33}mv-nearby-micro-list .filter-mobility-type a:focus{outline:#302E2E auto 1px}mv-nearby-micro-list .filter-mobility-type a:hover{outline:none}mv-nearby-micro-list .lines-list{overflow-y:auto;height:100%}mv-nearby-micro-list .lines-list .line-item{padding:13px 20px}mv-nearby-micro-list .lines-list .line-item .line-image,mv-nearby-micro-list .lines-list .line-item .line-image img{width:44px;height:44px}mv-nearby-micro-list .lines-list .line-item:after{content:"";position:absolute;bottom:0;border-bottom:1px solid #ECF0F1;width:calc(100% - 40px)}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;margin-bottom:.1176470588rem}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357;margin-bottom:.1176470588rem}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-value{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-value.green{color:#038844}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-value.orange{color:#525357}mv-nearby-micro-list .lines-list .line-item .line-title-wrapper .line-value.red{color:#e10c32}mv-nearby-micro-list .lines-list .line-item .line-time{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357}mv-nearby-micro-list .lines-list .line-item .line-time:before{content:"";display:inline-block;background:no-repeat url(/images/routeTypes/walking.svg) center/contain;width:.9411764706rem;height:.9411764706rem;position:relative;top:.1764705882rem}\n'],encapsulation:2}),e})();var Ve=n(2281);function He(e,t){if(1&e&&(r.TgZ(0,"div",14),r._uU(1),r.qZA()),2&e){const e=r.oxw(3);r.xp6(1),r.Oqu(e.mmItem.bikeStationName)}}function Ge(e,t){if(1&e&&r._UZ(0,"span",15),2&e){const e=r.oxw(3);r.Jzz("width:",e.mmItem.bikeStationAvailabilityBarValue,"%")}}const ze=function(e){return{Number:e}},qe=function(e){return{param1:e}};function Je(e,t){if(1&e&&(r.TgZ(0,"div",5),r._UZ(1,"svg-icon",6),r.ALo(2,"translate"),r.TgZ(3,"div",7),r.YNc(4,He,2,1,"div",8),r.TgZ(5,"div",9),r.YNc(6,Ge,1,3,"span",10),r.qZA(),r.TgZ(7,"div",11),r.TgZ(8,"div",12),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"div",13),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.ekj("green","green"===e.getAvailableBikesBarColor(e.mmItem.bikeStationAvailableBikes))("red","red"===e.getAvailableBikesBarColor(e.mmItem.bikeStationAvailableBikes))("no-station-name",!e.mmItem.bikeStationName),r.xp6(1),r.s9C("titleText",r.lcZ(2,11,"a11y_bike_station_image")),r.xp6(3),r.Q6J("ngIf",e.mmItem.bikeStationName),r.xp6(2),r.Q6J("ngIf",e.mmItem.bikeStationAvailableBikes&&0!==e.mmItem.bikeStationAvailableBikes),r.xp6(3),r.Oqu(r.xi3(10,13,"web_stations_shared_bikes_available",r.VKq(19,ze,e.mmItem.bikeStationAvailableBikes))),r.xp6(3),r.Oqu(r.xi3(13,16,"web_stations_selected_micromobility_docks",r.VKq(21,qe,e.mmItem.bikeStationFreeDocks)))}}function We(e,t){1&e&&(r._UZ(0,"svg-icon",19),r.ALo(1,"translate")),2&e&&r.s9C("titleText",r.lcZ(1,1,"a11y_fuel_image"))}function Qe(e,t){1&e&&(r._UZ(0,"svg-icon",20),r.ALo(1,"translate")),2&e&&r.s9C("titleText",r.lcZ(1,1,"a11y_fuel_image"))}function Ke(e,t){if(1&e&&(r.TgZ(0,"div",16),r.YNc(1,We,2,3,"svg-icon",17),r.YNc(2,Qe,2,3,"svg-icon",18),r.TgZ(3,"div",7),r.TgZ(4,"div",9),r._UZ(5,"span",15),r.qZA(),r.TgZ(6,"div",11),r._uU(7),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.ekj("green","green"===e.getBatteryLevelColor(e.mmItem.docklessBatteryFuelLevel.level))("orange","orange"===e.getBatteryLevelColor(e.mmItem.docklessBatteryFuelLevel.level))("red","red"===e.getBatteryLevelColor(e.mmItem.docklessBatteryFuelLevel.level)),r.xp6(1),r.Q6J("ngIf","fuel"===e.mmItem.docklessBatteryFuelLevel.type),r.xp6(1),r.Q6J("ngIf","battery"===e.mmItem.docklessBatteryFuelLevel.type),r.xp6(3),r.Jzz("width:",e.mmItem.docklessBatteryFuelLevel.level,"%"),r.xp6(2),r.hij(" ",e.mmItem.docklessBatteryFuelLevel.level,"% ")}}function Xe(e,t){if(1&e&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(3);r.xp6(1),r.Oqu(r.xi3(2,1,"units_minutes_text",r.VKq(4,qe,e.mmItem.walkingTimeDistance.walkingTime)))}}function et(e,t){if(1&e&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(3);r.xp6(1),r.Oqu(r.xi3(2,1,"units_kilometers_short",r.VKq(4,qe,e.mmItem.walkingTimeDistance.walkingDistance)))}}function tt(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",21),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.YNc(7,Xe,3,6,"div",0),r.YNc(8,et,3,6,"div",0),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,4,"itinerary_item_walk")),r.xp6(4),r.Oqu(r.lcZ(6,6,"web_stations_selected_micromobility_walking")),r.xp6(2),r.Q6J("ngIf",e.mmItem.walkingTimeDistance.walkingTime<=60),r.xp6(1),r.Q6J("ngIf",e.mmItem.walkingTimeDistance.walkingTime>60)}}function nt(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",22),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,2,"a11y_id_number_image")),r.xp6(4),r.Oqu(e.mmItem.docklessVehicleName)}}function it(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",23),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,2,"a11y_car_image")),r.xp6(4),r.Oqu(e.mmItem.docklessCarName)}}function rt(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",24),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"div"),r._uU(8),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,3,"a11y_car_seat_image")),r.xp6(4),r.Oqu(r.lcZ(6,5,"web_stations_selected_micromobility_seats")),r.xp6(3),r.Oqu(e.mmItem.docklessCarNumOfSeats)}}function ot(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",25),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"div"),r._uU(8),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,3,"a11y_helmet_image")),r.xp6(4),r.Oqu(r.lcZ(6,5,"web_stations_selected_micromobility_helmets")),r.xp6(3),r.Oqu(e.mmItem.docklessVehicleNumOfHelmets)}}function at(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",26),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"div"),r._uU(8),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,3,"a11y_credit_card_image")),r.xp6(4),r.Oqu(r.lcZ(6,5,"web_stations_selected_micromobility_driving")),r.xp6(3),r.Oqu(e.mmItem.drivingRate)}}function st(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"svg-icon",22),r.ALo(2,"translate"),r.TgZ(3,"div",14),r.TgZ(4,"div"),r._uU(5),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("titleText",r.lcZ(2,2,"a11y_id_number_image")),r.xp6(4),r.Oqu(e.mmItem.docklessCarId)}}const lt=function(e){return{numOfMinutes:e}};function ct(e,t){if(1&e&&(r.TgZ(0,"div",27),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(r.xi3(2,1,"web_stations_selected_micromobility_updateed_ago",r.VKq(4,lt,e.mmItem.bikeStationLastUpdate.lastUpdateRelativeTime)))}}function dt(e,t){if(1&e&&(r.TgZ(0,"div",27),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(r.xi3(2,1,"web_stations_selected_micromobility_updateed_on",r.VKq(4,qe,e.mmItem.bikeStationLastUpdate.lastUpdateAbsoluteTime)))}}function ut(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Je,14,23,"div",1),r.YNc(2,Ke,8,12,"div",2),r.YNc(3,tt,9,8,"div",3),r.YNc(4,nt,6,4,"div",3),r.YNc(5,it,6,4,"div",3),r.YNc(6,rt,9,7,"div",3),r.YNc(7,ot,9,7,"div",3),r.YNc(8,at,9,7,"div",3),r.YNc(9,st,6,4,"div",3),r.YNc(10,ct,3,6,"div",4),r.YNc(11,dt,3,6,"div",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.isBikeStation(e.mmItem.itemType)&&(e.mmItem.bikeStationAvailabilityBarValue||0==e.mmItem.bikeStationAvailabilityBarValue)),r.xp6(1),r.Q6J("ngIf",!e.isBikeStation(e.mmItem.itemType)&&e.mmItem.docklessBatteryFuelLevel&&e.mmItem.docklessBatteryFuelLevel.level),r.xp6(1),r.Q6J("ngIf",e.getLocationPermission()&&e.mmItem.walkingTimeDistance&&(e.mmItem.walkingTimeDistance.walkingTime||0==e.mmItem.walkingTimeDistance.walkingTime)),r.xp6(1),r.Q6J("ngIf",e.mmItem.docklessVehicleName),r.xp6(1),r.Q6J("ngIf",e.mmItem.docklessCarName),r.xp6(1),r.Q6J("ngIf",e.mmItem.docklessCarNumOfSeats),r.xp6(1),r.Q6J("ngIf",e.mmItem.docklessVehicleNumOfHelmets),r.xp6(1),r.Q6J("ngIf",e.mmItem.drivingRate),r.xp6(1),r.Q6J("ngIf",e.mmItem.docklessCarId),r.xp6(1),r.Q6J("ngIf",(null==e.mmItem.bikeStationLastUpdate?null:e.mmItem.bikeStationLastUpdate.lastUpdateRelativeTime)&&(null==e.mmItem.bikeStationLastUpdate?null:e.mmItem.bikeStationLastUpdate.lastUpdateRelativeTime)<60),r.xp6(1),r.Q6J("ngIf",(null==e.mmItem.bikeStationLastUpdate?null:e.mmItem.bikeStationLastUpdate.lastUpdateRelativeTime)&&(null==e.mmItem.bikeStationLastUpdate?null:e.mmItem.bikeStationLastUpdate.lastUpdateRelativeTime)>60)}}let pt=(()=>{class e{constructor(e,t,n,i,r){this.document=e,this.store=t,this.nearbyService=n,this.storeHelper=i,this.a11y=r,this.unsubscribes=[]}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){const e=this.microMobilitySelectedItem;yield this.getMMItemData(e),this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedMMItem",()=>(0,s.mG)(this,void 0,void 0,function*(){const e=this.microMobilitySelectedItem;e&&(this.mmItem={},yield this.getMMItemData(e))}))),this.focusOnBackButton()})}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get microMobilitySelectedItem(){return this.state.nearby.selectedMMItem}isBikeStation(e){return e==h.EP.BIKE_STATION}getLocationPermission(){return this.nearbyMap.hasLocationPermission}focusOnBackButton(){setTimeout(()=>{var e;this.a11y.byEnter&&(null===(e=this.document.getElementById("mm-single-item-back-link"))||void 0===e||e.focus())})}getMMItemData(e){var t,n,i,r,o,a,l,c,d,u,p,h,m,g,f,v;return(0,s.mG)(this,void 0,void 0,function*(){this.mmItem={itemType:e.itemMMType,bikeStationName:null===(n=null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)||void 0===n?void 0:n.name,bikeStationAvailableBikes:null===(r=null===(i=e.itemMetaData)||void 0===i?void 0:i.bikeStationMetaData)||void 0===r?void 0:r.availableBikes,bikeStationFreeDocks:null===(a=null===(o=e.itemMetaData)||void 0===o?void 0:o.bikeStationMetaData)||void 0===a?void 0:a.freeDocks,bikeStationAvailabilityBarValue:this.getBikeStationAvailabilityBarValue(e),docklessVehicleName:null===(c=null===(l=e.itemMetaData)||void 0===l?void 0:l.docklessVehicle)||void 0===c?void 0:c.vehicleName,docklessBatteryFuelLevel:this.getBatteryOrFuelLevel(e),docklessVehicleNumOfHelmets:null===(u=null===(d=e.itemMetaData)||void 0===d?void 0:d.docklessVehicle)||void 0===u?void 0:u.numOfHelmets,docklessCarName:null===(h=null===(p=e.itemMetaData)||void 0===p?void 0:p.docklessCar)||void 0===h?void 0:h.name,docklessCarId:null===(g=null===(m=e.itemMetaData)||void 0===m?void 0:m.docklessCar)||void 0===g?void 0:g.id,docklessCarNumOfSeats:null===(v=null===(f=e.itemMetaData)||void 0===f?void 0:f.docklessCar)||void 0===v?void 0:v.numOfSeats,walkingTimeDistance:yield this.getWalkingDistanceFromUserLocation(e.location),drivingRate:this.getDrivingRate(e),bikeStationLastUpdate:this.getLastUpdateTime(e)}})}getAvailableBikesBarColor(e){return e||0===e?e>1?"green":"red":null}getBatteryLevelColor(e){if(e){if(e>60)return"green";if(e<=60&&e>=20)return"orange";if(e<20)return"red"}return null}getBatteryOrFuelLevel(e){var t,n,i,r,o,a,s,l,c,d,u,p;return(null===(t=e.itemMetaData)||void 0===t?void 0:t.docklessVehicle)?{level:null===(i=null===(n=e.itemMetaData)||void 0===n?void 0:n.docklessVehicle)||void 0===i?void 0:i.batteryLevel,type:"battery"}:(null===(r=e.itemMetaData)||void 0===r?void 0:r.docklessCar)?(null===(a=null===(o=e.itemMetaData)||void 0===o?void 0:o.docklessCar)||void 0===a?void 0:a.batteryLevel)?{level:null===(l=null===(s=e.itemMetaData)||void 0===s?void 0:s.docklessCar)||void 0===l?void 0:l.batteryLevel,type:"battery"}:(null===(d=null===(c=e.itemMetaData)||void 0===c?void 0:c.docklessCar)||void 0===d?void 0:d.fuelLevel)?{level:null===(p=null===(u=e.itemMetaData)||void 0===u?void 0:u.docklessCar)||void 0===p?void 0:p.fuelLevel,type:"fuel"}:null:null}getBikeStationAvailabilityBarValue(e){var t,n,i,r;const o=null===(n=null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)||void 0===n?void 0:n.availableBikes,a=null===(r=null===(i=e.itemMetaData)||void 0===i?void 0:i.bikeStationMetaData)||void 0===r?void 0:r.freeDocks;if(o&&a||0==o&&a||0==a&&o){const e=100/(a+o)*o;return e>100?100:e}return null}getWalkingDistanceFromUserLocation(e){return(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.getUserLocationOrMapCenter(),n=this.nearbyService.getDistanceFromLocation(e,t.location,t.hasUserLocation);return{walkingTime:Math.round(n/h.QQ*60),walkingDistance:Math.round(10*n)/10}})}getUserLocationOrMapCenter(){return(0,s.mG)(this,void 0,void 0,function*(){return this.nearbyMap.hasLocationPermission?{location:yield this.nearbyMap.mapLocation.getLocation(),hasUserLocation:!0}:{location:yield this.nearbyMap.getMapCenter(),hasUserLocation:!1}})}getDrivingRate(e){var t,n,i,r,o,a,s,l,c;return(null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)?null===(i=null===(n=e.itemMetaData)||void 0===n?void 0:n.bikeStationMetaData)||void 0===i?void 0:i.drivingRate:(null===(r=e.itemMetaData)||void 0===r?void 0:r.docklessVehicle)?null===(a=null===(o=e.itemMetaData)||void 0===o?void 0:o.docklessVehicle)||void 0===a?void 0:a.drivingRate:(null===(s=e.itemMetaData)||void 0===s?void 0:s.docklessCar)?null===(c=null===(l=e.itemMetaData)||void 0===l?void 0:l.docklessCar)||void 0===c?void 0:c.drivingRate:null}getLastUpdateTime(e){var t,n,i,r,o,a;if(null===(n=null===(t=e.itemMetaData)||void 0===t?void 0:t.bikeStationMetaData)||void 0===n?void 0:n.lastUpdate)return{lastUpdateRelativeTime:Ve(Ve()).diff(null===(r=null===(i=e.itemMetaData)||void 0===i?void 0:i.bikeStationMetaData)||void 0===r?void 0:r.lastUpdate,"minutes"),lastUpdateAbsoluteTime:Ve(null===(a=null===(o=e.itemMetaData)||void 0===o?void 0:o.bikeStationMetaData)||void 0===a?void 0:a.lastUpdate).format("LLL")}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(k.M),r.Y36(T.N),r.Y36(N.F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-micro-single-item"]],inputs:{selectedTab:"selectedTab",nearbyMap:"nearbyMap"},decls:1,vars:1,consts:[[4,"ngIf"],["class","micro-info-wrapper bikes",3,"green","red","no-station-name",4,"ngIf"],["class","micro-info-wrapper",3,"green","orange","red",4,"ngIf"],["class","micro-info-wrapper",4,"ngIf"],["class","last-updated",4,"ngIf"],[1,"micro-info-wrapper","bikes"],["mvAccessibleSVG","","src","images/nearby/micro-mobility-icons/bike-stop.svg",1,"svg-icon",3,"titleText"],[1,"location-info"],["class","info-row",4,"ngIf"],[1,"availability-bar"],["class","bar-available",3,"style",4,"ngIf"],[1,"availability"],[1,"availability-current"],[1,"availability-total"],[1,"info-row"],[1,"bar-available"],[1,"micro-info-wrapper"],["class","svg-icon","src","images/nearby/micro-mobility-icons/fuel.svg","mvAccessibleSVG","",3,"titleText",4,"ngIf"],["class","svg-icon","src","images/nearby/micro-mobility-icons/battery.svg","mvAccessibleSVG","",3,"titleText",4,"ngIf"],["src","images/nearby/micro-mobility-icons/fuel.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/battery.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/walk-24.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/id-number.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/car.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/carseat.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/nearby/micro-mobility-icons/helmet.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],["src","images/icons/credit-card.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"],[1,"last-updated"]],template:function(e,t){1&e&&r.YNc(0,ut,12,11,"div",0),2&e&&r.Q6J("ngIf",t.mmItem)},directives:[a.O5,I.bk,E.m],pipes:[A.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-nearby-micro-single-item .micro-info-wrapper{display:flex;padding:12px 20px;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-nearby-micro-single-item .micro-info-wrapper.no-station-name{padding-top:20px}mv-nearby-micro-single-item .micro-info-wrapper.green .availability-current,mv-nearby-micro-single-item .micro-info-wrapper.green .availability{color:#038844}mv-nearby-micro-single-item .micro-info-wrapper.green svg-icon:not([src*=bike-stop]) svg path{fill:#038844}mv-nearby-micro-single-item .micro-info-wrapper.green .availability-bar .bar-available{background-image:linear-gradient(to left,#038844,#04b95c)}mv-nearby-micro-single-item .micro-info-wrapper.orange .availability-current,mv-nearby-micro-single-item .micro-info-wrapper.orange .availability{color:#f7a20c}mv-nearby-micro-single-item .micro-info-wrapper.orange svg-icon:not([src*=bike-stop]) svg path{fill:#f7a20c}mv-nearby-micro-single-item .micro-info-wrapper.orange .availability-bar .bar-available{background-image:linear-gradient(to left,#f7a20c,#fac870 0%)}mv-nearby-micro-single-item .micro-info-wrapper.red .availability-current,mv-nearby-micro-single-item .micro-info-wrapper.red .availability{color:#e10c32}mv-nearby-micro-single-item .micro-info-wrapper.red svg-icon:not([src*=bike-stop]) svg path{fill:#e10c32}mv-nearby-micro-single-item .micro-info-wrapper.red .availability-bar .bar-available{background-image:linear-gradient(to left,#e10c32,#f65a76)}mv-nearby-micro-single-item .micro-info-wrapper.orange .availability{color:#525357}mv-nearby-micro-single-item .micro-info-wrapper.bikes div.availability{color:#525357}mv-nearby-micro-single-item .micro-info-wrapper.bikes .availability-bar{background-color:#979197}html[dir=ltr] mv-nearby-micro-single-item .micro-info-wrapper.bikes .availability-bar .bar-available{border-top-right-radius:0;border-bottom-right-radius:0;border-right:2px solid #fff}html[dir=rtl] mv-nearby-micro-single-item .micro-info-wrapper.bikes .availability-bar .bar-available{border-top-left-radius:0;border-bottom-left-radius:0;border-left:2px solid #fff}mv-nearby-micro-single-item .micro-info-wrapper:not(.bikes) .location-info{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center}mv-nearby-micro-single-item .micro-info-wrapper:not(.bikes) .location-info .availability-bar{flex-grow:1;background-color:#bdc3c7}mv-nearby-micro-single-item .micro-info-wrapper:not(.bikes) .location-info .availability{width:auto;padding-top:0}html[dir=ltr] mv-nearby-micro-single-item .micro-info-wrapper:not(.bikes) .location-info .availability{margin-left:20px}html[dir=rtl] mv-nearby-micro-single-item .micro-info-wrapper:not(.bikes) .location-info .availability{margin-right:20px}mv-nearby-micro-single-item .micro-info-wrapper svg-icon{margin:0}html[dir=ltr] mv-nearby-micro-single-item .micro-info-wrapper svg-icon{margin-right:11px}html[dir=rtl] mv-nearby-micro-single-item .micro-info-wrapper svg-icon{margin-left:11px}mv-nearby-micro-single-item .micro-info-wrapper svg-icon,mv-nearby-micro-single-item .micro-info-wrapper svg-icon svg{width:24px;height:24px}mv-nearby-micro-single-item .micro-info-wrapper .info-row{width:100%;display:flex;align-self:center;justify-content:space-between;color:#525357}mv-nearby-micro-single-item .micro-info-wrapper .info-row div:nth-child(2){font-weight:600}mv-nearby-micro-single-item .micro-info-wrapper .location-info{width:100%;font-weight:600}mv-nearby-micro-single-item .micro-info-wrapper .location-info .svg-icon{margin-top:12px}mv-nearby-micro-single-item .micro-info-wrapper .location-info .info-row{padding:0 0 15px}mv-nearby-micro-single-item .micro-info-wrapper .location-info .availability-bar{position:relative;border-radius:14px;height:8px}mv-nearby-micro-single-item .micro-info-wrapper .location-info .availability-bar .bar-available{content:"";position:absolute;top:0;width:20%;height:100%;border-radius:inherit}html[dir=ltr] mv-nearby-micro-single-item .micro-info-wrapper .location-info .availability-bar .bar-available{left:0}html[dir=rtl] mv-nearby-micro-single-item .micro-info-wrapper .location-info .availability-bar .bar-available{right:0}mv-nearby-micro-single-item .micro-info-wrapper .location-info .availability{padding-top:8px;display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;width:100%}mv-nearby-micro-single-item .last-updated{color:#525357;font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;text-align:center;padding:16px 20px;border-top:1px solid #ECF0F1}\n'],encapsulation:2}),e})();function ht(e,t){if(1&e&&r._UZ(0,"mv-nearby-stops-list",4),2&e){const e=r.oxw();r.Q6J("nearbyMap",e.nearbyMap)("isExpanded",e.isExpanded)("selectedTab",e.selectedTab)}}function mt(e,t){1&e&&r._UZ(0,"mv-nearby-card-single-stop")}function gt(e,t){if(1&e&&r._UZ(0,"mv-nearby-micro-list",5),2&e){const e=r.oxw();r.Q6J("nearbyMap",e.nearbyMap)("isExpanded",e.isExpanded)}}function ft(e,t){if(1&e&&r._UZ(0,"mv-nearby-micro-single-item",6),2&e){const e=r.oxw();r.Q6J("selectedTab",e.BottomsheetTab.SharedTransit)("nearbyMap",e.nearbyMap)}}let vt=(()=>{class e{constructor(e,t){this.document=e,this.store=t,this.BottomsheetTab=h.fi}get state(){return this.store.getState()}get isMetroReady(){return this.state.global.appIsReady&&!!this.state.metro.currentMetro}get nearbyStopsMapData(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.stopsDataMapGroups}get nearbyStopsGroupsOnMap(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.displayedGroupsOnMap}get nearbyMMTilesOnMap(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMTilesOnMap}get selectedStopId(){return this.state.nearby.selectedStop}get selectedMicroMobilityItem(){return this.state.nearby.selectedMMItem}get nearbyMicroMobilityOnMap(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.tiles}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-panel-main"]],inputs:{nearbyMap:"nearbyMap",isExpanded:"isExpanded",selectedTab:"selectedTab"},decls:4,vars:4,consts:[[3,"nearbyMap","isExpanded","selectedTab",4,"ngIf"],[4,"ngIf"],[3,"nearbyMap","isExpanded",4,"ngIf"],[3,"selectedTab","nearbyMap",4,"ngIf"],[3,"nearbyMap","isExpanded","selectedTab"],[3,"nearbyMap","isExpanded"],[3,"selectedTab","nearbyMap"]],template:function(e,t){1&e&&(r.YNc(0,ht,1,3,"mv-nearby-stops-list",0),r.YNc(1,mt,1,0,"mv-nearby-card-single-stop",1),r.YNc(2,gt,1,2,"mv-nearby-micro-list",2),r.YNc(3,ft,1,2,"mv-nearby-micro-single-item",3)),2&e&&(r.Q6J("ngIf",t.nearbyStopsGroupsOnMap&&!t.selectedStopId&&t.selectedTab===t.BottomsheetTab.PublicTransit),r.xp6(1),r.Q6J("ngIf",!!t.selectedStopId),r.xp6(1),r.Q6J("ngIf",t.nearbyMMTilesOnMap&&!t.selectedStopId&&t.selectedTab===t.BottomsheetTab.SharedTransit&&!t.selectedMicroMobilityItem),r.xp6(1),r.Q6J("ngIf",!!t.selectedMicroMobilityItem))},directives:[a.O5,Te,Ce,je,pt],styles:[""],encapsulation:2}),e})();function yt(e,t){1&e&&r._UZ(0,"mv-nearby-map")}function bt(e,t){if(1&e&&r._UZ(0,"mv-nearby-panel-main",4),2&e){const e=r.oxw();r.Q6J("nearbyMap",e.nearbyMap)("isExpanded",!!e.isBottomsheetExpanded)("selectedTab",e.dragZone.selectedTab)}}let _t=(()=>{class e{constructor(e,t,n){this.document=e,this.store=t,this.storeHelper=n,this.isBottomsheetExpanded=!0,this.BottomsheetTab=h.fi,this.unsubscribes=[]}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){yield(0,z.p5)(this.store),this.split=(0,D.Z)(["#nearby-map","#nearby-bottomsheet"],{direction:"vertical",sizes:[50,50],minSize:[0,5],gutterSize:56,snapOffset:6,onDrag:e=>{Math.floor(e[0])<=5?this.document.body.classList.add("nearby-split-over"):this.document.body.classList.remove("nearby-split-over"),this.isBottomsheetExpanded=Math.floor(e[1])>5},onDragEnd:()=>{this.nearbyMap.refreshSize(),this.nearbyMap.isMapFocused=!0},gutter:()=>{const e=document.createElement("div");return e.id=e.className="drag-zone",e}});const e=this.document.getElementById("drag-zone"),t=this.document.getElementsByTagName("mv-nearby-drag-zone")[0];e.appendChild(t)})}ngAfterViewInit(){this.dragZone.onExpand.subscribe(()=>{this.split.setSizes([50,50]),this.isBottomsheetExpanded=!0,this.document.body.classList.remove("nearby-split-over"),setTimeout(()=>this.nearbyMap.refreshSize(),300)}),this.unsubscribes.push(this.storeHelper.subscribe("nearby.selectedMMItem",e=>{e&&(this.dragZone.selectedTab=h.fi.SharedTransit,this.dragZone.onExpand.emit())}),this.storeHelper.subscribe("nearby.selectedStop",e=>{e&&(this.dragZone.selectedTab=h.fi.PublicTransit,this.dragZone.onExpand.emit())}))}ngOnDestroy(){for(const e of this.unsubscribes)e()}get state(){return this.store.getState()}get isMetroReady(){return this.state.global.appIsReady&&!!this.state.metro.currentMetro}get nearbyStops(){return this.state.nearby.stopsAdditionalData}get selectedStopId(){return this.state.nearby.selectedStop}get nearbyStopsMapData(){var e;return null===(e=this.state.nearby.stopsMapData)||void 0===e?void 0:e.stopsDataMapGroups}get microMobilityFilter(){var e;return null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.displayedMMFilterType}get selectedMicroMobilityItem(){return this.state.nearby.selectedMMItem}get microMobilityExistInMetro(){var e;return 0!==(null===(e=this.state.nearby.microMobilityData)||void 0===e?void 0:e.microMobilityTypes.length)}get isStopsEmptyState(){return this.state.nearby.nearbyStopsEmptyState}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.K0),r.Y36(y.d),r.Y36(T.N))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-map-view"]],viewQuery:function(e,t){if(1&e&&(r.Gf(C,5),r.Gf(G,5)),2&e){let e;r.iGM(e=r.CRH())&&(t.nearbyMap=e.first),r.iGM(e=r.CRH())&&(t.dragZone=e.first)}},decls:6,vars:14,consts:[["id","nearby-map"],[4,"ngIf"],["id","nearby-bottomsheet"],[3,"nearbyMap","isExpanded","selectedTab",4,"ngIf"],[3,"nearbyMap","isExpanded","selectedTab"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"div",0),r.YNc(2,yt,1,0,"mv-nearby-map",1),r.qZA(),r._UZ(3,"mv-nearby-drag-zone"),r.TgZ(4,"div",2),r.YNc(5,bt,1,3,"mv-nearby-panel-main",3),r.qZA(),r.qZA()),2&e&&(r.ekj("stops-list",!!t.nearbyStops&&!t.selectedStopId&&!t.selectedMicroMobilityItem&&!t.microMobilityFilter||!!t.isStopsEmptyState)("single-stop",!!t.selectedStopId)("micro-mobility-filtered",!!t.microMobilityFilter&&!t.selectedMicroMobilityItem)("single-micro-mobility",!!t.selectedMicroMobilityItem)("no-tabs",!t.microMobilityExistInMetro),r.xp6(2),r.Q6J("ngIf",t.isMetroReady),r.xp6(1),r.ekj("expanded",!!t.isBottomsheetExpanded),r.xp6(2),r.Q6J("ngIf",t.isMetroReady&&!!t.nearbyStopsMapData&&!!t.nearbyMap&&!!t.dragZone))},directives:[a.O5,G,C,vt],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container,mv-nearby-map-view,#nearby-map{transition:top .4s cubic-bezier(.42,0,.3,1.15)}.nearby-split-over .content-container,.nearby-split-over mv-nearby-map-view,.nearby-split-over #nearby-map{transition:top .3s ease}.app-container.nearby-map mv-header{z-index:0}body.nearby-split-over mv-root .app-container.nearby-map mv-header{height:80px;transition:height .4s ease-in-out,transform ease-in-out .3s}body.nearby-split-over mv-root .app-container.nearby-map mv-nearby-map-view{background-color:transparent}body.nearby-split-over mv-root .app-container.nearby-map #nearby-map{height:0!important}html body.mobile.nearby-split-over mv-root .app-container.nearby-map .content-container{top:2.6470588235rem}html.privacy-notice body.mobile mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root .app-container.nearby-map .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px + 4.7058823529rem)}}mv-nearby-map-view .no-tabs .nearby-map-card-content{min-height:calc(100% + 28px)}mv-nearby-map-view .no-tabs #nearby-bottomsheet{padding-bottom:28px}mv-nearby-map-view .no-tabs:not(.single-stop) .drag-zone{max-height:28px}mv-nearby-map-view mv-nearby-card-single-stop,mv-nearby-map-view mv-nearby-micro-single-item{overflow-y:auto;display:block;height:calc(100% - 30px)}mv-nearby-map-view>div{position:absolute;top:0;bottom:0;right:0;left:0;width:100%;height:100%;overflow:hidden;z-index:0;background-color:#f0ebe6}.nearby-split-over mv-nearby-map-view>div{background-color:transparent}mv-nearby-map-view>div .nearby-card-nav,mv-nearby-map-view>div .station-details-wrapper,mv-nearby-map-view>div .micro-mobility-filter,mv-nearby-map-view>div .single-micro-mobility-bar{display:none}mv-nearby-map-view>div.stops-list .drag-zone{height:3.2941176471rem!important}mv-nearby-map-view>div.stops-list .nearby-card-nav{display:flex}mv-nearby-map-view>div.stops-list .station-details-wrapper{display:block}mv-nearby-map-view>div.single-stop .drag-zone,mv-nearby-map-view>div.micro-mobility-filtered .drag-zone,mv-nearby-map-view>div.single-micro-mobility .drag-zone{height:5.0588235294rem!important}mv-nearby-map-view>div.no-tabs .drag-zone{border-bottom:1px solid #ECF0F1}mv-nearby-map-view>div.single-stop .station-details-wrapper{display:flex}mv-nearby-map-view>div.micro-mobility-filtered .lines-list{height:calc(100% - 30px)}mv-nearby-map-view>div.micro-mobility-filtered .micro-mobility-filter{display:flex}mv-nearby-map-view>div.single-micro-mobility .single-micro-mobility-bar{display:flex}mv-nearby-map-view .drag-zone,mv-nearby-map-view #nearby-bottomsheet{position:relative;z-index:9999;background-color:#fff}mv-nearby-map-view #nearby-map:not(.dragging),mv-nearby-map-view #nearby-bottomsheet:not(.dragging){transition:height .5s cubic-bezier(.37,.05,.3,1)}mv-nearby-map-view .drag-zone{width:100%;height:.9411764706rem;padding:0;border-top-right-radius:8px;border-top-left-radius:8px;box-shadow:0 1px 8px #0003;box-sizing:border-box}.nearby-split-over mv-nearby-map-view .drag-zone{box-shadow:none}mv-nearby-map-view .station-details-wrapper{position:relative}mv-nearby-map-view .station-details-wrapper .station-text-wrapper .station-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-nearby-map-view .station-details-wrapper .station-text-wrapper .station-subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;margin-top:.1764705882rem}mv-nearby-map-view .station-details-wrapper .station-text-wrapper .station-subtitle .accessibility-icon,mv-nearby-map-view .station-details-wrapper .station-text-wrapper .station-subtitle svg{height:.7058823529rem;width:.7058823529rem}mv-nearby-map-view .lines-list{padding-bottom:8px}mv-nearby-map-view .lines-list .line-item{min-height:48px;padding:9px 20px}mv-nearby-map-view .lines-list .line-item .line-title-wrapper{flex-grow:1}html[dir=ltr] mv-nearby-map-view .lines-list .line-item .line-title-wrapper{padding-right:1.1764705882rem}html[dir=rtl] mv-nearby-map-view .lines-list .line-item .line-title-wrapper{padding-left:1.1764705882rem}mv-nearby-map-view .lines-list .line-item .line-title-wrapper .line-title:not(:only-child){color:#292a30;font-weight:600}mv-nearby-map-view .lines-list .line-item .line-time{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;font-weight:600;color:#292a30;white-space:nowrap}mv-nearby-map-view .lines-list .line-item .line-time.rt{position:relative;color:#038844}html[dir=rtl] mv-nearby-map-view .lines-list .line-item .line-time.rt:before,html[dir=rtl] mv-nearby-map-view .lines-list .line-item .line-time.rt:after{transform:translateY(.1764705882rem) scaleX(-1)}mv-nearby-map-view .lines-list .line-item .line-time.rt:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:.0588235294rem;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-nearby-map-view .lines-list .line-item .line-time.rt:before{left:-8px}html[dir=rtl] mv-nearby-map-view .lines-list .line-item .line-time.rt:before{right:-8px}@media (prefers-reduced-motion: reduce){mv-nearby-map-view .lines-list .line-item .line-time.rt:before{-webkit-animation:none;animation:none}}mv-nearby-map-view .lines-list .line-item .line-time.rt:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:1.0588235294rem;position:absolute;top:-.1764705882rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-nearby-map-view .lines-list .line-item .line-time.rt:after{left:-12px}html[dir=rtl] mv-nearby-map-view .lines-list .line-item .line-time.rt:after{right:-12px}@media (prefers-reduced-motion: reduce){mv-nearby-map-view .lines-list .line-item .line-time.rt:after{-webkit-animation:none;animation:none}}\n'],encapsulation:2}),e})();function Tt(e,t){1&e&&r._UZ(0,"mv-nearby-map-view")}let St=(()=>{class e{constructor(e){this.universal=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.p))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-nearby-main-view"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&r.YNc(0,Tt,1,0,"mv-nearby-map-view",0),2&e&&r.Q6J("ngIf",t.universal.isBrowser)},directives:[a.O5,_t],encapsulation:2}),e})();var xt=n(39885);const wt=[{path:":lang",data:{subTabId:i.zA.NEARBY_MAP},component:St},{path:"**",component:xt.H,data:{canonicalLanding:i.zA.NEARBY_MAP}}]},67731:function(e,t,n){"use strict";n.d(t,{M:function(){return y}});var i=n(3786),r=n(65492),o=n(74692),a=n(31234),s=n(2281),l=n(87100),c=n(55754),d=n(44143),u=n(2316),p=n(99902),h=n(5971),m=n(32066),g=n(26365),f=n(2339),v=n(31251);let y=(()=>{class e{constructor(e,t,n,i,r,o){this.httpService=e,this.store=t,this.imageService=n,this.metroService=i,this.translate=r,this.permissionService=o}get state(){return this.store.getState()}getStopsAdditionalData(e,t){return this.httpService.get(r.bl.GetStopsAdditionalData,{stopsIds:e.join(","),metroId:this.state.metro.metroId,getLineDepartures:t},!0).toPromise()}getStopsArrivals(e,t){return this.httpService.get(r.bl.getStopsLinesArrivals,{stopsIds:e.join(","),getOnlyFirstLines:t,metroId:this.state.metro.metroId},!0).toPromise()}getStopsDataForMap(e){return this.httpService.get(r.bl.GetStopsMapData,{tilesLatLngs:e,revision:this.state.metro.currentMetro.revisionNumber,metroId:this.state.metro.metroId},!0).toPromise()}getMicroMobility(e,t){return this.httpService.get(r.bl.getMicroMobility,{metroId:e,tilesLatLngs:t},!0).toPromise()}getLineImageHtml(e,t,n,r,o,s,l){return(0,i.mG)(this,void 0,void 0,function*(){const i=n||r||o,c=this.metroService.getAgencyImageId(e),d=[null,(0,a.N0)(t),n];let u=null;if(s&&s.images)for(const e of s.images)4===e.index&&(u=e.imageRef);if(l&&l.images)for(const e of l.images)4===e.index&&d.push(e.image.toString());u&&c&&d.push(c.toString());const p={id:u,params:d};return yield this.imageService.getImageHTML(p.id,p.params,void 0,i)})}getRealTimeArrivalTime(e,t){const n=e,i=this.state.metro.currentMetro.timeZoneOffset,r=s().utcOffset(i).diff(s().utcOffset(i).startOf("day"),"seconds"),o=(0,l.Ic)(t),a=Math.floor((n-(r+o))/60);return a>-1?0===a?this.translate.instant("now"):this.translate.instant("units_minutes_text",{param1:a}):null}getStaticTimeAbsolute(e){return s().startOf("day").add(e,"seconds").format("HH:mm")}getUserLocation(){return(0,i.mG)(this,void 0,void 0,function*(){const e=yield this.permissionService.getLocation();return{lat:e.coords.latitude,lng:e.coords.longitude}})}getDistanceFromLocation(e,t,n){const i=c._.fromMvLatLon(e);let r;return r=n?{lat:t[0],lng:t[1]}:t,d.YQ(r.lat,r.lng,i.lat,i.lng,"K")}toLatLonTiles(e){return{tileX:Math.floor(100*e.lng),tileY:Math.floor(100*e.lat)}}getMMItemImageByItemType(e,t){var n,i,r,a,s,l,c,d,u,p,h,m,g,f;return t===o.EP.DOCKLESS_CAR?this.imageService.getImageHTML(null===(r=null===(i=null===(n=e.categoryMetaData)||void 0===n?void 0:n.docklessCarMetaData)||void 0===i?void 0:i.image)||void 0===r?void 0:r.imageId,null===(l=null===(s=null===(a=e.categoryMetaData)||void 0===a?void 0:a.docklessCarMetaData)||void 0===s?void 0:s.image)||void 0===l?void 0:l.parameters,null,e.categoryName):t===o.EP.BIKE_STATION?this.imageService.getImageHTML(null===(d=null===(c=e.categoryMetaData)||void 0===c?void 0:c.basicProviderMetaData)||void 0===d?void 0:d.serviceImageId,null,null,e.categoryName):this.imageService.getImageHTML(null===(h=null===(p=null===(u=e.categoryMetaData)||void 0===u?void 0:u.docklessVehicleMetaData)||void 0===p?void 0:p.image)||void 0===h?void 0:h.imageId,null===(f=null===(g=null===(m=e.categoryMetaData)||void 0===m?void 0:m.docklessVehicleMetaData)||void 0===g?void 0:g.image)||void 0===f?void 0:f.parameters,null,e.categoryName)}getWalkTimeText(e){return this.translate.instant("web_walking_minutes",{param1:e})}getDistanceKmText(e){return this.translate.instant("units_kilometers_short",{param1:e.toFixed(2)})}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(p.O),u.LFG(h.d),u.LFG(m.KD),u.LFG(g.V),u.LFG(f.sK),u.LFG(v.$))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},99642:function(e,t,n){"use strict";n.d(t,{W:function(){return u}});var i=n(2316),r=n(78146),o=n(87479),a=n(93975),s=n(54364),l=n(2339);const c=["backButton"];function d(e,t){if(1&e&&(i.TgZ(0,"span",4),i._uU(1),i.qZA()),2&e){const e=i.oxw();i.xp6(1),i.Oqu(e.backText)}}let u=(()=>{class e{constructor(e){this.a11y=e,this.backText="",this.backClick=new i.vpe,this.titleTextKey="action_back",this.completedInitialFocus=!1}ngOnInit(){}onBackClick(){this.backClick.emit()}ngAfterViewChecked(){!this.completedInitialFocus&&this.backButton&&this.a11y.byEnter&&(this.backButton.nativeElement.focus(),this.completedInitialFocus=!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.F))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-back-button"]],viewQuery:function(e,t){if(1&e&&i.Gf(c,5),2&e){let e;i.iGM(e=i.CRH())&&(t.backButton=e.first)}},inputs:{backText:"backText",titleTextKey:"titleTextKey"},outputs:{backClick:"backClick"},decls:6,vars:7,consts:[["id","back-link","role","button","tabindex","0",1,"back-link",3,"click","keydown.enter"],["backButton",""],["src","images/icons/arrow_gray.svg","mvAccessibleSVG","",3,"titleText"],["class","back-text",4,"ngIf"],[1,"back-text"]],template:function(e,t){1&e&&(i.TgZ(0,"a",0,1),i.NdJ("click",function(){return t.onBackClick()})("keydown.enter",function(){return t.onBackClick()}),i.ALo(2,"translate"),i._UZ(3,"svg-icon",2),i.ALo(4,"translate"),i.YNc(5,d,2,1,"span",3),i.qZA()),2&e&&(i.uIk("aria-label",i.lcZ(2,3,t.titleTextKey)),i.xp6(3),i.s9C("titleText",i.lcZ(4,5,"action_back")),i.xp6(2),i.Q6J("ngIf",t.backText))},directives:[o.bk,a.m,s.O5],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-back-button{display:block;display:flex;align-items:center;-webkit-align-items:center}mv-back-button.black-fill svg-icon svg polygon{fill:#292a30}mv-back-button.gray-fill svg-icon svg polygon{fill:#7a7c7f}mv-back-button .back-link{color:#292a30;height:100%;padding:12px 20px;z-index:1;display:inherit;box-sizing:border-box}body.desktop mv-back-button .back-link{align-items:center}body.desktop mv-back-button .back-link svg-icon{margin:0}mv-back-button .back-link .back-text{line-height:1.5;color:#292a30}html[dir=ltr] mv-back-button .back-link .back-text{margin-left:10px}html[dir=rtl] mv-back-button .back-link .back-text{margin-right:10px}body.mobile mv-back-button .back-link .back-text{margin-top:2px}mv-back-button .back-link svg-icon{width:.5882352941rem;height:.8823529412rem}html[dir=ltr] mv-back-button .back-link svg-icon{transform:scaleX(-1)}\n"],encapsulation:2}),e})()},39885:function(e,t,n){"use strict";n.d(t,{H:function(){return d}});var i=n(3786),r=n(52959),o=n(2316),a=n(95505),s=n(61787),l=n(99957),c=n(5971);let d=(()=>{class e{constructor(e,t,n,i){this.routingService=e,this.canonicalService=t,this.customerService=n,this.store=i}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){const e=this.routingService.getCurrentRouteData();e.canonicalLanding&&(yield(0,r.p5)(this.store),this.routingService.redirectTo(this.canonicalService.buildStatefulPath([],this.getBasePath(e))))})}getBasePath(e){const t=e.canonicalLanding;return"default"===t?this.customerService.getDefaultSubTabId(this.store.getState().customer.currentCustomer):t}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.Z),o.Y36(s.z),o.Y36(l.v),o.Y36(c.d))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-line-landing"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},97192:function(e,t,n){"use strict";n.d(t,{oS:function(){return f},Kq:function(){return v},w4:function(){return y}});var i=n(99528),r=n(2316),o=n(99957),a=n(5971),s=n(1210),l=n(1437),c=n(54364),d=n(60778),u=n(90248),p=n(2339);function h(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"a",8),r.NdJ("click",function(t){r.CHM(e);const n=r.oxw();return n.trackAppStoreClick(t,n.MobilePlatform.iOS)}),r.ALo(2,"translate"),r._UZ(3,"img",9),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"a",10),r.NdJ("click",function(t){r.CHM(e);const n=r.oxw();return n.trackAppStoreClick(t,n.MobilePlatform.Android)}),r.ALo(6,"translate"),r._UZ(7,"img",11),r.ALo(8,"translate"),r.qZA(),r.BQk()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("href",e.appUrls.iosAppURL,r.LSH),r.uIk("aria-label",r.lcZ(2,6,"ios")),r.xp6(2),r.uIk("alt",r.lcZ(4,8,"ios")),r.xp6(2),r.Q6J("href",e.appUrls.googleAppURL,r.LSH),r.uIk("aria-label",r.lcZ(6,10,"android")),r.xp6(2),r.uIk("alt",r.lcZ(8,12,"android"))}}function m(e,t){1&e&&(r.ynx(0),r._UZ(1,"img",12),r.ALo(2,"translate"),r._UZ(3,"img",11),r.ALo(4,"translate"),r.BQk()),2&e&&(r.xp6(1),r.uIk("alt",r.lcZ(2,2,"ios")),r.xp6(2),r.uIk("alt",r.lcZ(4,4,"android")))}function g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",13),r.NdJ("clickOutside",function(t){return r.CHM(e),r.oxw().toggleQRCode(t)}),r.TgZ(1,"div",14),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"button",15),r.NdJ("click",function(t){return r.CHM(e),r.oxw().toggleQRCode(t)}),r.qZA(),r.qZA(),r.TgZ(6,"div",16),r._UZ(7,"img",17),r.ALo(8,"translate"),r._UZ(9,"mv-spinner"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Tol(e.options.displayDirection),r.xp6(3),r.Oqu(r.lcZ(4,5,"web_download_qr_popup")),r.xp6(4),r.s9C("alt",r.lcZ(8,7,"web_scan_qr")),r.Q6J("src",e.options.imageUrl||e.qrCodeDataUri,r.LSH)}}var f=(()=>{return(e=f||(f={})).SuggestedRoutes_QRcode="SuggestedRoutes_QRcode",e.Itinerary_QRcode="Itinerary_QRcode",e.Lines_QRcode="Lines_QRcode",e.SideBar_QRcode="SideBar_QRcode",e.Partners_QRcode="Partners_QRcode",f;var e})(),v=(()=>((v||(v={})).QR="QR",v))();let y=(()=>{class e{constructor(e,t,n,r){this.customerService=e,this.store=t,this.deepLinkService=n,this.analyticsService=r,this.showQRCodePopup=!1,this.MobilePlatform=i.$I}ngOnInit(){this.appUrls=this.state.global.appStoreUrl}get state(){return this.store.getState()}get isPartnersBanner(){const{currentCustomer:e}=this.state.customer;return e&&!this.customerService.isMoovitCustomer(e.id)&&!e.designConfiguration.hideDownloadMoovitBanner}toggleQRCode(e){e.currentTarget.blur&&e.currentTarget.blur(),this.showQRCodePopup=!this.showQRCodePopup,this.showQRCodePopup||(this.qrCodeDataUri=void 0),this.showQRCodePopup&&this.analyticsService.trackDownloadApp("Desktop",this.options.campaign),this.showQRCodePopup&&!this.options.imageUrl&&this.deepLinkService.getDeepLinkQrCode(this.options.campaign,this.options.appArea,this.options.deepLinkSchemaType).then(e=>{this.showQRCodePopup&&(this.qrCodeDataUri=e)}),e.stopPropagation()}trackAppStoreClick(e,t){this.analyticsService.trackStoreClick("partnersQrCode",t),e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.v),r.Y36(a.d),r.Y36(s.Qz),r.Y36(l.y))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mv-download-app-qr"]],inputs:{options:"options"},decls:12,vars:9,consts:[[1,"qr-links"],[1,"banner-download-options"],[4,"ngIf"],[1,"qr-icon",3,"click"],["src","/images/store-buttons/barcode-icon.svg"],[1,"scan-qr-code"],[1,"scan-qr-link",3,"click"],["class","qr-popup","mvClickOutside","",3,"class","clickOutside",4,"ngIf"],["target","_blank",1,"store-action-button","app-store",3,"href","click"],["src","/images/apple_icon_gray.svg",1,"store-action-button","app-store"],["target","_blank",1,"store-action-button","play-store",3,"href","click"],["src","/images/store-buttons/android_icon.svg",1,"store-action-button","play-store"],["src","/images/store-buttons/apple_icon_gray.svg",1,"store-action-button","app-store"],["mvClickOutside","",1,"qr-popup",3,"clickOutside"],[1,"popup-header"],[1,"close",3,"click"],[1,"qrcode-img-wrapper"],[3,"src","alt"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.YNc(2,h,9,14,"ng-container",2),r.YNc(3,m,5,6,"ng-container",2),r.TgZ(4,"button",3),r.NdJ("click",function(e){return t.toggleQRCode(e)}),r._UZ(5,"img",4),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"div",5),r.TgZ(8,"button",6),r.NdJ("click",function(e){return t.toggleQRCode(e)}),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.YNc(11,g,10,9,"div",7),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("ngIf",t.isPartnersBanner),r.xp6(1),r.Q6J("ngIf",!t.isPartnersBanner),r.xp6(2),r.uIk("alt",r.lcZ(6,5,"web_scan_qr")),r.xp6(4),r.Oqu(r.lcZ(10,7,t.options.promoKey)),r.xp6(2),r.Q6J("ngIf",t.showQRCodePopup))},directives:[c.O5,d._,u.O],pipes:[p.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-download-app-qr .qr-links{display:flex;align-items:center}mv-download-app-qr .qr-links>*{z-index:9}mv-download-app-qr .qr-links .scan-qr-code{width:95px}mv-download-app-qr .qr-links .scan-qr-code span:focus{outline:auto}mv-download-app-qr .qr-links .banner-download-options .qr-icon{display:flex;align-items:center;height:1.1764705882rem}mv-download-app-qr .qr-links .banner-download-options .qr-icon>img{width:1.1764705882rem;padding:0 6px;border-color:transparent}html[dir=ltr] mv-download-app-qr .qr-links .banner-download-options .qr-icon>img{margin-left:4px}html[dir=rtl] mv-download-app-qr .qr-links .banner-download-options .qr-icon>img{margin-right:4px}html[dir=ltr] mv-download-app-qr .qr-links .banner-download-options .qr-icon>img{border-left:1px solid #b2b2b2}html[dir=rtl] mv-download-app-qr .qr-links .banner-download-options .qr-icon>img{border-right:1px solid #b2b2b2}mv-download-app-qr .qr-links .banner-download-options>a{display:none}mv-download-app-qr .qr-popup{background-color:#fff;position:absolute;box-shadow:0 1px 4px #00000073;z-index:1;width:11.7647058824rem;height:14.7058823529rem}mv-download-app-qr .qr-popup.left{top:-250px}html[dir=ltr] mv-download-app-qr .qr-popup.left{left:-110px}html[dir=rtl] mv-download-app-qr .qr-popup.left{right:-110px}html[dir=ltr] mv-download-app-qr .qr-popup.left{-webkit-animation:qr-popup-to-left .3s forwards;animation:qr-popup-to-left .3s forwards}html[dir=rtl] mv-download-app-qr .qr-popup.left{-webkit-animation:qr-popup-to-right .3s forwards;animation:qr-popup-to-right .3s forwards}@-webkit-keyframes qr-popup-to-left{0%{transform:translate(20px);opacity:0}to{transform:translate(0);opacity:1}}@keyframes qr-popup-to-left{0%{transform:translate(20px);opacity:0}to{transform:translate(0);opacity:1}}@-webkit-keyframes qr-popup-to-right{0%{transform:translate(-20px);opacity:0}to{transform:translate(0);opacity:1}}@keyframes qr-popup-to-right{0%{transform:translate(-20px);opacity:0}to{transform:translate(0);opacity:1}}mv-download-app-qr .qr-popup.top{top:-17.0588235294rem;left:calc(50% - 5.8823529412rem);-webkit-animation:qr-popup-to-top .3s forwards;animation:qr-popup-to-top .3s forwards}@-webkit-keyframes qr-popup-to-top{0%{transform:translateY(1.1764705882rem);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes qr-popup-to-top{0%{transform:translateY(1.1764705882rem);opacity:0}to{transform:translateY(0);opacity:1}}mv-download-app-qr .qr-popup .popup-header{border-bottom:1px solid #CCCCCC;display:flex;justify-content:space-between;align-items:center;padding:17px 15px;color:#292a30}mv-download-app-qr .qr-popup .popup-header .text{color:#515357;max-width:9.1176470588rem;font-weight:500}mv-download-app-qr .qr-popup .popup-header>span{font-size:.8235294118rem}mv-download-app-qr .qr-popup .popup-header .close{width:.5882352941rem;height:.5882352941rem;background:url(/images/icons/close.svg) center no-repeat;background-size:.5882352941rem;border:0;outline:none;cursor:pointer;opacity:.6;transition:opacity .2s}mv-download-app-qr .qr-popup .popup-header .close:hover{opacity:1}mv-download-app-qr .qr-popup .qrcode-img-wrapper{display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;height:11.7647058824rem}mv-download-app-qr .qr-popup .qrcode-img-wrapper mv-spinner{position:absolute;z-index:-1}mv-download-app-qr .qr-popup .qrcode-img-wrapper img{width:11.7647058824rem;height:11.7647058824rem;padding:10px;box-sizing:border-box;position:relative;z-index:1;display:none}mv-download-app-qr .qr-popup .qrcode-img-wrapper img[src^="data:image"],mv-download-app-qr .qr-popup .qrcode-img-wrapper img[src$=".png"]{display:block}\n'],encapsulation:2}),e})()},91547:function(e,t,n){"use strict";n.d(t,{H:function(){return d}});var i=n(2316),r=n(54364),o=n(87479),a=n(93975),s=n(79223);function l(e,t){if(1&e&&i._UZ(0,"svg-icon",5),2&e){const e=i.oxw();i.s9C("titleText",e.errorMessage.title),i.Q6J("src",e.imageSrc)}}function c(e,t){1&e&&(i.TgZ(0,"div"),i._UZ(1,"span",6),i.qZA())}let d=(()=>{class e{constructor(){}ngOnInit(){}get imageSrc(){return`images/error-states/${this.errorMessage.image}`}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-error-message"]],inputs:{errorMessage:"errorMessage"},decls:7,vars:6,consts:[["role","alert",1,"error-panel"],["class","error-icon","mvAccessibleSVG","",3,"src","titleText",4,"ngIf"],[4,"ngIf"],[1,"error-header"],[1,"error-text",3,"innerHTML"],["mvAccessibleSVG","",1,"error-icon",3,"src","titleText"],[1,"error-icon"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i.YNc(1,l,1,2,"svg-icon",1),i.YNc(2,c,2,0,"div",2),i.TgZ(3,"div",3),i._uU(4),i.qZA(),i._UZ(5,"div",4),i.ALo(6,"safeHtml"),i.qZA()),2&e&&(i.xp6(1),i.Q6J("ngIf",t.errorMessage.image),i.xp6(1),i.Q6J("ngIf",!t.errorMessage.image),i.xp6(2),i.hij("",t.errorMessage.title," "),i.xp6(1),i.Q6J("innerHTML",i.lcZ(6,4,t.errorMessage.text),i.oJD))},directives:[r.O5,o.bk,a.m],pipes:[s.z],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.error-panel .error-icon{width:32px;height:32px;margin:26px auto 0;display:block}.error-panel .error-header{font-size:.9411764706rem;color:#292a30;color:#737578;text-align:center;margin:14px 0}.error-panel .error-text{font-size:.8235294118rem;color:#292a30;color:#737578;text-align:center;margin:14px 0;padding:0 20px}.error-panel .error-text a{margin-top:10px;display:block;color:#737578;transition:all .3s}.error-panel .error-text a:hover{color:#292a30}\n"],encapsulation:2}),e})()},79489:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var i=n(2316),r=n(21090),o=n(46461),a=n(2339);let s=(()=>{class e{constructor(e){this.dialogRef=e}get subtitle(){var e;return"string"==typeof(null===(e=this.dialogRef.data)||void 0===e?void 0:e.subtitle)?this.dialogRef.data.subtitle:"permissions_location_text"}allow(){this.dialogRef.close("allow")}deny(){this.dialogRef.close("deny")}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.z))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-location-permission"]],decls:13,vars:12,consts:[["mvImg","","src","images/permissions/location.svg","alt","","width","95","height","95",1,"permission-img"],[1,"allow",3,"click"],[1,"decline",3,"click"]],template:function(e,t){1&e&&(i._UZ(0,"img",0),i.TgZ(1,"h2"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"p"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"button",1),i.NdJ("click",function(){return t.allow()}),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"button",2),i.NdJ("click",function(){return t.deny()}),i._uU(11),i.ALo(12,"translate"),i.qZA()),2&e&&(i.xp6(2),i.Oqu(i.lcZ(3,4,"permissions_location_title")),i.xp6(3),i.Oqu(i.lcZ(6,6,t.subtitle)),i.xp6(3),i.Oqu(i.lcZ(9,8,"action_allow")),i.xp6(3),i.Oqu(i.lcZ(12,10,"permissions_popup_dont_allow")))},directives:[o.X],pipes:[a.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-location-permission{background:white;border-radius:4px;width:100%;text-align:center;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}mv-location-permission .permission-img{padding:10%}mv-location-permission h2,mv-location-permission p{padding:0 20px}mv-location-permission h2{margin-top:0;font-size:1rem}mv-location-permission p{font-size:.8823529412rem;line-height:1.1176470588rem;margin-bottom:17px}mv-location-permission button{width:calc(100% - 40px);font-size:1rem;font-weight:600}mv-location-permission button.allow{background-color:#2196f3;color:#fff;border-radius:5px;padding:10px}mv-location-permission button.decline{color:#2196f3;margin:25px 0}\n"],encapsulation:2}),e})()},8967:function(e,t,n){"use strict";n.d(t,{d:function(){return l}});var i=n(3786),r=n(86781),o=n(99528),a=n(55754),s=n(44143);class l{constructor(e,t,n,i,o){this.store=e,this.customerService=t,this.uiActions=n,this.icons=[],this.stopMarkers=[],this.nearbyStopsMarkers=[],this.nearbyDocklessVehiclesMarkers=[],this.nearbyBikesMarkers=[],this.nearbyElectricBikesMarkers=[],this.nearbyElectricScootersMarkers=[],this.nearbyKickScootersMarkers=[],this.nearbyMopedsMarkers=[],this.nearbyBikeStationsMarkers=[],this.nearbyDocklessCarsMarkers=[],this.mapElementId=i,this.logger=(0,r.hu)(o)}get state(){return this.store.getState()}static loadLeafletPackage(){var e;return(0,i.mG)(this,void 0,void 0,function*(){(null===(e=window.L)||void 0===e?void 0:e.curve)||(yield n.e("default-node_modules_leaflet_dist_leaflet-src_js").then(n.t.bind(n,20685,23)),yield n.e("node_modules_Leaflet_GeoJSON_Encoded_dist_leaflet_geojson_encoded_min_js").then(n.t.bind(n,67470,23)),yield n.e("node_modules_leaflet-curve_leaflet_curve_js").then(n.t.bind(n,95646,23)))})}initLeafletMap(e){var t;return(0,i.mG)(this,void 0,void 0,function*(){(null===(t=window.L)||void 0===t?void 0:t.curve)||(this.store.dispatch(this.uiActions.setLoading(!0)),yield l.loadLeafletPackage(),this.store.dispatch(this.uiActions.setLoading(!1))),this.icons[o.$h.From]=L.icon({iconUrl:this.customerService.getImagePath(this.state.customer.currentCustomer,"images/pin_from.svg"),iconSize:[23.33333,28],iconAnchor:[11.666667,28]}),this.icons[o.$h.To]=L.icon({iconUrl:this.customerService.getImagePath(this.state.customer.currentCustomer,"images/pin_to.svg"),iconSize:[23.33333,28],iconAnchor:[11.666667,28]});const n=L.latLng(-89.98155760646617,-180),i=L.latLng(89.99346179538875,180),r=L.latLngBounds(n,i);this.map=L.map(this.mapElementId,{zoomControl:!1,attributionControl:!1,minZoom:4,maxBounds:r,maxBoundsViscosity:1,touchZoom:!0,bounceAtZoomLimits:!1,keyboard:!1}),this.initCentralPoint(e),this.initTileLayer(),this.map.on("zoomend",e=>{if(this.stopMarkers){const e=this.map.getZoom(),t=this.stopMarkers.length;this.stopMarkers.forEach(n=>{n=s.Gr(n,t,12,e)})}}),this.map.invalidateSize(),setTimeout(()=>this.map&&this.map.invalidateSize(),1e3)})}initTileLayer(){this.logger.log("initTileLayer");const e=this.state.user.selectedMetro.tilesUrl,t=e.includes("{z}/{x}/{y}")?e:e.replace("http:","https:")+"{z}/{x}/{y}.png";L.tileLayer(t).addTo(this.map);const n=L.control.attribution();let i='<div>\xa9 <a target="_blank" href="https://openmaptiles.org">OpenMapTiles</a></div><div>\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div>';if(t.startsWith("https://api.mapbox.com")){i='\xa9 <a href="https://www.mapbox.com/about/maps/">Mapbox</a> \xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>\n        <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>';const e='<a href="http://mapbox.com/about/maps" class=\'mapbox-wordmark\' target="_blank"></a>',t=L.control.attribution();t.setPosition("bottomleft"),t.setPrefix(e),t.addTo(this.map)}t.startsWith("https://api.maptiler.com")&&(i=`\xa9 <a target="_blank" href="https://maptiler.com/copyright/ ">MapTiler</a> ${i}`),n.setPrefix(i),n.addTo(this.map)}initCentralPoint(e){let t;this.logger.log("initCentralPoint"),t=this.state.customer.currentCustomer&&this.state.customer.currentCustomer.latLng?this.state.customer.currentCustomer.latLng:a._.fromMvLatLon(this.state.metro.currentMetro.defaultLocation);const n=e||14;this.logger.log("Initializing leaflet map with",{central:t,zoom:n}),this.map.setView(t,n)}fitBoundsByPoints(e){this.logger.log("fitBoundsByPoints");const t=s.s1(e),n=L.latLngBounds(t.southWest,t.northEast);this.internalMapFitBounds(n)}internalMapFitBounds(e){const t=[0,0],n=[10,10];this.logger.log("Fitting to bounds",e,{paddingTopLeft:n,paddingBottomRight:t}),this.map.fitBounds(e,{paddingTopLeft:n,paddingBottomRight:t})}removeLayers(e){if(e&&e.length>0)for(const t of e)this.map.removeLayer(t)}addLayers(e){if(e&&e.length>0)for(const t of e)this.map.addLayer(t)}createStopMarkers(e,t,n,i=!0,r=!0,o={}){this.logger.log("createStopMarkers");const a=r?s._p(i?t.slice(1,-1):t,n):t;for(const s of a){const t=[s.lat,s.lng],n=L.divIcon({className:"stop-div-icon",html:'<div style="border-color:'+e+'"'+(s.stopIndex?`id="stopIndex-${s.stopIndex}"`:"")+'"><div class="stop-clickable-zone stop-invisible"></div></div>',iconSize:[12,12]}),i=L.marker(t,Object.assign({icon:n,title:s.stopName},o)).addTo(this.map);this.stopMarkers.push(i)}}get isRTL(){return!1}}},39935:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});var i=n(2316),r=n(21090),o=n(46461),a=n(2339);let s=(()=>{class e{constructor(e){this.dialogRef=e}allow(){this.dialogRef.close("allow")}deny(){this.dialogRef.close("deny")}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.z))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-orientation-permission"]],decls:13,vars:12,consts:[["mvImg","","src","images/permissions/motion.svg","alt","","width","119","height","95",1,"permission-img"],[1,"allow",3,"click"],[1,"decline",3,"click"]],template:function(e,t){1&e&&(i._UZ(0,"img",0),i.TgZ(1,"h2"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"p"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"button",1),i.NdJ("click",function(){return t.allow()}),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"button",2),i.NdJ("click",function(){return t.deny()}),i._uU(11),i.ALo(12,"translate"),i.qZA()),2&e&&(i.xp6(2),i.Oqu(i.lcZ(3,4,"permissions_motion_title")),i.xp6(3),i.Oqu(i.lcZ(6,6,"permissions_motion_text")),i.xp6(3),i.Oqu(i.lcZ(9,8,"action_allow")),i.xp6(3),i.Oqu(i.lcZ(12,10,"permissions_popup_dont_allow")))},directives:[o.X],pipes:[a.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-orientation-permission{background:white;border-radius:4px;width:100%;text-align:center;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}mv-orientation-permission .permission-img{padding:10%}mv-orientation-permission h2,mv-orientation-permission p{padding:0 20px}mv-orientation-permission h2{margin-top:0;font-size:1rem}mv-orientation-permission p{font-size:.8823529412rem;line-height:1.1176470588rem;margin-bottom:17px}mv-orientation-permission button{width:calc(100% - 40px);font-size:1rem;font-weight:600}mv-orientation-permission button.allow{background-color:#2196f3;color:#fff;border-radius:5px;padding:10px}mv-orientation-permission button.decline{color:#2196f3;margin:25px 0}\n"],encapsulation:2}),e})()},89458:function(e,t,n){"use strict";n.d(t,{Y:function(){return p}});var i=n(2316),r=n(5971),o=n(1238),a=n(99957),s=n(5306),l=n(54364),c=n(97192),d=n(2339);function u(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"div",2),i.TgZ(2,"button",3),i.NdJ("click",function(t){return i.CHM(e),i.oxw().toggleBanner(t)}),i.ALo(3,"translate"),i.qZA(),i.qZA(),i.TgZ(4,"div",4),i.TgZ(5,"div",5),i._UZ(6,"img",6),i.qZA(),i.TgZ(7,"div",7),i.TgZ(8,"div",8),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"div",9),i._uU(12),i.ALo(13,"translate"),i.qZA(),i._UZ(14,"mv-download-app-qr",10),i.qZA(),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.ekj("qr-banner-minimized",e.isQrBannerMinimized),i.Q6J("hidden",!e.isBannerVisible),i.xp6(2),i.uIk("aria-label",i.lcZ(3,7,"a11y_minimize_banner")),i.xp6(7),i.Oqu(i.lcZ(10,9,"web_download_qr_route_testb_line1")),i.xp6(3),i.Oqu(i.lcZ(13,11,"web_download_qr_route_testb_line2")),i.xp6(2),i.Q6J("options",e.qrCodeParams)}}let p=(()=>{class e{constructor(e,t,n,i){this.store=e,this.globalActions=t,this.customerService=n,this.universal=i,this.isPartner=!1,this.isPartner=!(this.state.customer.currentCustomer.id===this.customerService.MoovitWeb.id||this.state.customer.currentCustomer.id===this.customerService.MoovitSeo.id)}ngOnInit(){!this.isBannerVisible&&this.universal.isBrowser&&setTimeout(()=>{this.store.dispatch(this.globalActions.setQrBannerVisibility(!0))},2e3)}get state(){return this.store.getState()}get isBannerVisible(){return this.state.global.isQrBannerVisible}get isQrBannerMinimized(){return this.state.global.isQrBannerMinimized}toggleBanner(e){e.currentTarget.blur(),this.store.dispatch(this.globalActions.setQrBannerMinimization(!this.isQrBannerMinimized))}get isPartnerCustomizedBanner(){var e,t;return null===(t=null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.designConfiguration)||void 0===t?void 0:t.isShowCustomDesktopItineraryBanner}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.d),i.Y36(o.l),i.Y36(a.v),i.Y36(s.p))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-qr-code-banner"]],inputs:{qrCodeParams:"qrCodeParams"},decls:1,vars:1,consts:[["class","qr-banner",3,"qr-banner-minimized","hidden",4,"ngIf"],[1,"qr-banner",3,"hidden"],[1,"minimize-qr"],["tabindex","0",1,"minimize-btn",3,"click"],[1,"qr-content-wrapper"],[1,"qr-phone-wrapper"],["src","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="],[1,"qr-text-wrapper"],[1,"qr-title"],[1,"qr-subtitle"],[3,"options"]],template:function(e,t){1&e&&i.YNc(0,u,15,13,"div",0),2&e&&i.Q6J("ngIf",!t.isPartner||t.isPartnerCustomizedBanner)},directives:[l.O5,c.w4],pipes:[d.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-qr-code-banner{position:relative;box-sizing:border-box;color:#fff;transition:all .3s;z-index:2}mv-qr-code-banner .qr-banner{transition:all .5s;background-color:#08212e}html[dir=ltr] mv-qr-code-banner .qr-banner{background:linear-gradient(to right,#00324e,#01122a)}html[dir=rtl] mv-qr-code-banner .qr-banner{background:linear-gradient(to left,#00324e,#01122a)}mv-qr-code-banner .qr-banner:after{content:"";display:block;height:4px;background-color:#f0500c;z-index:0}mv-qr-code-banner .qr-banner .minimize-qr{height:17px;text-align:center;transition:all .3s;position:relative;z-index:2}mv-qr-code-banner .qr-banner .minimize-qr .minimize-btn{border-radius:.8823529412rem;border:0;width:1.7647058824rem;height:1.7647058824rem;background:#2196F3 url(/images/icons/down-arrow.svg) no-repeat center;background-size:12px;padding:0;margin:-1.4117647059rem auto 0;transition:all .3s .3s ease;display:inline-block;outline:none;cursor:pointer}mv-qr-code-banner .qr-banner .minimize-qr .minimize-btn:focus{outline:auto}mv-qr-code-banner .qr-banner .qr-content-wrapper{position:relative;display:flex}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-phone-wrapper{min-width:120px;height:auto;position:relative;margin:-27px 0 0;background:url(/images/banners/useapp-phone-full.png) no-repeat center top;z-index:1;transition:all .6s cubic-bezier(.47,-.07,.51,1)}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper{flex-grow:1;padding:6px 0 10px;font-size:.6470588235rem;color:#fff}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper{padding-right:10px}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper{padding-left:10px}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-title{font-size:1.2941176471rem;font-weight:700;line-height:1.5294117647rem;margin-bottom:5px}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links{margin-top:20px;display:flex;justify-content:space-between;align-items:center;flex-direction:row-reverse;cursor:pointer}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links>*{z-index:9}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code{opacity:1;transition:all .4s;width:auto}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code{margin-right:12px}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code{margin-left:12px}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code button{text-align:left}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code button{text-align:right}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code .scan-qr-link{color:#46adff;text-decoration:underline}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .scan-qr-code .scan-qr-link:focus{outline:auto}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon:focus{outline:1px solid #fff}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon img{border-color:transparent;padding:0 6px;width:.9411764706rem}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon img{border-left:1px solid #b2b2b2}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon img{border-right:1px solid #b2b2b2}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon img{margin-left:3px}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .qr-links .qr-icon img{margin-right:3px}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options{display:flex;align-items:flex-start;transform:scale(1.2)}html[dir=rtl] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options{transform-origin:left bottom}html[dir=ltr] mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options{transform-origin:right bottom}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options .app-store{filter:brightness(.9);width:1.0588235294rem;height:1.0588235294rem}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options img{width:1.0588235294rem}mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options .store-action-button{display:block}mv-qr-code-banner .qr-banner.qr-banner-minimized{transition:all .6s ease-in-out}mv-qr-code-banner .qr-banner.qr-banner-minimized .qr-content-wrapper .qr-phone-wrapper{background-position-y:-180%}mv-qr-code-banner .qr-banner.qr-banner-minimized .qr-content-wrapper .qr-title,mv-qr-code-banner .qr-banner.qr-banner-minimized .qr-content-wrapper .qr-subtitle{display:none}mv-qr-code-banner .qr-banner.qr-banner-minimized .qr-content-wrapper .qr-phone-wrapper{width:0;min-width:0;padding:0 5px;opacity:0}mv-qr-code-banner .qr-banner.qr-banner-minimized .minimize-qr{height:0}mv-qr-code-banner .qr-banner.qr-banner-minimized .minimize-qr .minimize-btn{transform:rotate(180deg)}body.c_13193 mv-qr-code-banner .qr-banner{background:#ebf3fa}body.c_13193 mv-qr-code-banner .qr-banner:after{background-image:linear-gradient(89deg,#00becd 23%,#98c818 97%);height:8px}body.c_13193 mv-qr-code-banner .qr-banner .minimize-qr .minimize-btn{background:linear-gradient(45deg,#00becd 23%,#98c818 97%)}body.c_13193 mv-qr-code-banner .qr-banner .minimize-qr .minimize-btn:before{content:"";width:100%;height:100%;display:block;background:url(/images/icons/down-arrow.svg) center/14px no-repeat}body.c_13193 mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-phone-wrapper{background-image:url(/images/partners/phone_device_arriva.svg)}body.c_13193 mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper{color:#292a30}body.c_13193 mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-text-wrapper .banner-download-options .store-action-button.app-store{width:.7058823529rem;transform:unset;height:17px}body.c_13193 mv-qr-code-banner .qr-banner .qr-content-wrapper .qr-links .scan-qr-code button.scan-qr-link{color:#1a65e5}\n'],encapsulation:2}),e})()},38037:function(e,t,n){"use strict";n.d(t,{u:function(){return l}});var i=n(2316),r=n(86781),o=n(17988);const a=["qrCanvas"],s=(0,r.hu)("QrDisplayComponent");let l=(()=>{class e{constructor(){}ngAfterViewInit(){this.renderQrCode()}ngOnChanges(){this.renderQrCode()}renderQrCode(){if(this.qrCanvas)try{const e=this.qrCanvas.nativeElement;o.toCanvas(e,this.data,this.options),e.setAttribute("aria-label",this.altText),e.setAttribute("role",this.ariaRole)}catch(e){s.error(`Failed to render QRCode: ${e}`)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-qr-display"]],viewQuery:function(e,t){if(1&e&&i.Gf(a,5,i.SBq),2&e){let e;i.iGM(e=i.CRH())&&(t.qrCanvas=e.first)}},inputs:{data:"data",altText:"altText",ariaRole:"ariaRole",options:"options"},features:[i.TTD],decls:2,vars:0,consts:[["qrCanvas",""]],template:function(e,t){1&e&&i._UZ(0,"canvas",null,0)},encapsulation:2}),e})()},20785:function(e,t,n){"use strict";n.d(t,{U:function(){return S}});var i=n(3786),r=n(17184),o=n(31234),a=n(13691),s=n(2316),l=n(2339),c=n(1238),d=n(5971),u=n(32066),p=n(54364),h=n(46461),m=n(79223),g=n(86607);function f(e,t){if(1&e&&(s._UZ(0,"img",9),s.ALo(1,"translate")),2&e){const e=s.oxw(2).$implicit,t=s.oxw();s.Q6J("src",t.getLegTypeIcon(e.legType),s.LSH),s.uIk("alt",s.lcZ(1,2,t.getLegTypeIconAltKey(e.legType)))}}function v(e,t){if(1&e&&(s._UZ(0,"div",10),s.ALo(1,"safeHtml"),s.ALo(2,"async")),2&e){const e=s.oxw(2).$implicit,t=s.oxw();s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,t.bicycleRentalLegImage(e))),s.oJD)}}function y(e,t){if(1&e&&(s.TgZ(0,"span",11),s._uU(1),s.qZA()),2&e){const e=s.oxw(2).$implicit;s.xp6(1),s.Oqu(e.extra.legImageMetaData.walkingTime)}}function b(e,t){if(1&e&&(s._UZ(0,"div",12),s.ALo(1,"safeHtml"),s.ALo(2,"async"),s.ALo(3,"asyncify")),2&e){const e=s.oxw(2).$implicit,t=s.oxw();s.Q6J("innerHTML",s.lcZ(1,1,s.lcZ(2,3,s.lcZ(3,5,t.getStepImageHtml(e)))),s.oJD)}}function _(e,t){if(1&e&&(s.TgZ(0,"div",3),s.YNc(1,f,2,4,"img",4),s.YNc(2,v,3,5,"div",5),s.YNc(3,y,2,1,"span",6),s.YNc(4,b,4,7,"div",7),s._UZ(5,"div",8),s.qZA()),2&e){const e=s.oxw().$implicit,t=s.oxw();s.ekj("has-alert",t.doesHaveAlert(t.$index)),s.uIk("tooltip",t.getTooltip(e))("tooltip-position",t.top),s.xp6(1),s.Q6J("ngIf",!t.stepUsesMvf(e)&&!t.bicycleRentalLegImage(e)),s.xp6(1),s.Q6J("ngIf",t.bicycleRentalLegImage(e)),s.xp6(1),s.Q6J("ngIf",t.isWalkStep(e)&&!t.isWalkOnlyRoute()),s.xp6(1),s.Q6J("ngIf",t.stepUsesMvf(e))}}function T(e,t){if(1&e&&(s.ynx(0),s.YNc(1,_,6,8,"div",2),s.BQk()),2&e){const e=t.$implicit,n=t.index,i=s.oxw();s.xp6(1),s.Q6J("ngIf",n>0&&i.shouldShowLegInSummary(e))}}let S=(()=>{class e{constructor(e,t,n,i){this.translate=e,this.globalActions=t,this.store=n,this.imageService=i,this.filteredSteps=[],this.trackByIndex=a.z8}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){yield this.onLoadedImages(),this.store.dispatch(this.globalActions.setRouteLegsLoadedState(!0))})}ngOnChanges(e){this.route&&(this.filteredSteps=this.route.steps.filter(e=>this.shouldShowLegInSummary(e)))}onLoadedImages(){return Promise.all(this.route.steps.map(e=>(0,i.mG)(this,void 0,void 0,function*(){return!(e.extra.legImageMetaData&&e.extra.legImageMetaData.lineMetaData&&e.extra.legImageMetaData.lineMetaData.summaryImageHtmlPromise)||e.extra.legImageMetaData.lineMetaData.summaryImageHtmlPromise})))}get state(){return this.store.getState()}shouldShowLegInSummary(e){const t=e.extra.legImageMetaData;return!(!t||!(e.legType==r.kJ.Walk&&(1==this.route.legs.length||t.walkingTime>=5)||e.legType!=r.kJ.Walk&&e.legType!=r.kJ.WaitFor&&e.legType!=r.kJ.StartFrom&&e.legType!=r.kJ.WalkToPath))}doesHaveAlert(e){return!1}getTooltip(e){return e.extra.legDescription.value?e.extra.legDescription.value:e.extra.legDescription.translateKey?this.translate.instant(e.extra.legDescription.translateKey,e.extra.legDescription.translateParams):""}stepUsesMvf(e){const t=e.extra.legImageMetaData;return null!=t&&null!=t.lineMetaData&&null!=t.lineMetaData.summaryImageData}bicycleRentalLegImage(e){var t;return null===(t=e.extra)||void 0===t?void 0:t.stopImageOnStepHtmlPromise}getLegTypeIcon(e){return(0,o.nw)(e)}getLegTypeIconAltKey(e){return(0,o.ID)(e,this.state,this.translate,this.imageService)}isWalkStep(e){return e.legType==r.kJ.Walk||e.legType==r.kJ.Bicycle}isWalkOnlyRoute(){return 1==this.filteredSteps.length&&(this.filteredSteps[0].legType==r.kJ.Walk||this.filteredSteps[0].legType==r.kJ.WalkToPath)}getStepImageHtml(e){return e.extra.legImageMetaData.lineMetaData.summaryImageHtmlPromise}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.sK),s.Y36(c.l),s.Y36(d.d),s.Y36(u.KD))},e.\u0275cmp=s.Xpm({type:e,selectors:[["mv-route-legs"]],inputs:{route:"route"},features:[s.TTD],decls:2,vars:2,consts:[[1,"legs-types"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","single-leg",3,"has-alert",4,"ngIf"],[1,"single-leg"],["mvImg","","class","non-mvf",3,"src",4,"ngIf"],["class","line-image bicycle-rental-image",3,"innerHTML",4,"ngIf"],["class","walk-time",4,"ngIf"],["class","line-image",3,"innerHTML",4,"ngIf"],[1,"single-leg-arrow"],["mvImg","",1,"non-mvf",3,"src"],[1,"line-image","bicycle-rental-image",3,"innerHTML"],[1,"walk-time"],[1,"line-image",3,"innerHTML"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.YNc(1,T,2,1,"ng-container",1),s.qZA()),2&e&&(s.xp6(1),s.Q6J("ngForOf",t.route.steps)("ngForTrackBy",t.trackByIndex))},directives:[p.sg,p.O5,h.X],pipes:[l.X$,m.z,p.Ov,g.N],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-route-legs .legs-types img.non-mvf{width:24px;height:24px}html[dir=ltr] mv-route-legs .legs-types img.non-mvf:first-of-type[src$="walking.svg"]{margin-left:-5px}html[dir=rtl] mv-route-legs .legs-types img.non-mvf:first-of-type[src$="walking.svg"]{margin-right:-5px}html[dir=rtl] mv-route-legs .legs-types img.non-mvf[src$="walking.svg"]{transform:scaleX(-1)}mv-route-legs .legs-types img.non-mvf[src$="bicycle.svg"]{width:26px;height:26px}html[dir=ltr] mv-route-legs .legs-types img.non-mvf[src$="bicycle.svg"]{margin-right:7px}html[dir=rtl] mv-route-legs .legs-types img.non-mvf[src$="bicycle.svg"]{margin-left:7px}html[dir=rtl] mv-route-legs .legs-types img.non-mvf[src$="bicycle.svg"]{transform:scaleX(-1)}mv-route-legs .legs-types img.non-mvf[src$="bicycle.svg"]+.walk-time{margin-bottom:9px}mv-route-legs .legs-types svg-icon,mv-route-legs .legs-types img.non-mvf{display:inline-block}mv-route-legs .legs-types svg-icon .iconified-transit-line .line-number,mv-route-legs .legs-types svg-icon .transit-line .line-number{overflow:hidden;text-overflow:ellipsis}mv-route-legs .legs-types .single-leg{display:inline-block;margin-bottom:.3529411765rem;position:relative;height:1.5294117647rem;vertical-align:top}html[dir=ltr] mv-route-legs .legs-types .single-leg{padding-right:15px}html[dir=rtl] mv-route-legs .legs-types .single-leg{padding-left:15px}mv-route-legs .legs-types .single-leg .mvf-wrapper .boxed .text{font-size:.9411764706rem}mv-route-legs .legs-types .single-leg .walk-time{font-size:.7058823529rem;font-weight:bold;color:#292a30;margin-bottom:6px;display:inline-block;vertical-align:bottom}html[dir=ltr] mv-route-legs .legs-types .single-leg .walk-time{margin-left:-3px}html[dir=rtl] mv-route-legs .legs-types .single-leg .walk-time{margin-right:-3px}mv-route-legs .legs-types .single-leg .single-leg-arrow{background-image:url(/images/icons/arrow_gray.svg);background-size:contain;display:inline-block;width:5px;height:10px;position:absolute;top:50%}html[dir=ltr] mv-route-legs .legs-types .single-leg .single-leg-arrow{right:5px}html[dir=rtl] mv-route-legs .legs-types .single-leg .single-leg-arrow{left:5px}html[dir=ltr] mv-route-legs .legs-types .single-leg .single-leg-arrow{transform:scaleX(1) translateY(-50%)}html[dir=rtl] mv-route-legs .legs-types .single-leg .single-leg-arrow{transform:scaleX(-1) translateY(-50%)}mv-route-legs .legs-types .single-leg:last-child .single-leg-arrow{display:none}mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image{position:relative;display:inline-block;width:27px;top:-2px}html[dir=ltr] mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image{left:-5px}html[dir=rtl] mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image{right:-5px}mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image .mvf-wrapper{display:inline-block}mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image .mvf-wrapper .boxed.layered .has-mask span{width:31px;height:34px}html[dir=ltr] mv-route-legs .legs-types .single-leg .line-image.bicycle-rental-image .mvf-wrapper .boxed.layered .has-mask span img{transform:scaleX(-1)}mv-route-legs .legs-types .single-leg .line-image+.walk-time{margin-bottom:3px}html[dir=ltr] mv-route-legs .legs-types .single-leg .line-image+.walk-time{margin-left:-3px}html[dir=rtl] mv-route-legs .legs-types .single-leg .line-image+.walk-time{margin-right:-3px}\n'],encapsulation:2}),e})()},19581:function(e,t,n){"use strict";n.d(t,{N:function(){return d}});var i=n(2316),r=n(1420),o=n(87479),a=n(93975),s=n(54364),l=n(2339);function c(e,t){1&e&&(i.TgZ(0,"span"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&e&&(i.xp6(1),i.Oqu(i.lcZ(2,1,"action_share")))}let d=(()=>{class e{constructor(e){this.shareService=e,this.showCaption=!0}onShareClick(){this.shareService.openSharePanel()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.t))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-share"]],inputs:{showCaption:"showCaption"},decls:5,vars:7,consts:[["role","button","tabindex","0",1,"share",3,"click","keydown.enter"],["src","images/share/share_icon_new.svg","mvAccessibleSVG","",3,"titleText"],[4,"ngIf"]],template:function(e,t){1&e&&(i.TgZ(0,"a",0),i.NdJ("click",function(){return t.onShareClick()})("keydown.enter",function(){return t.onShareClick()}),i.ALo(1,"translate"),i._UZ(2,"svg-icon",1),i.ALo(3,"translate"),i.YNc(4,c,3,3,"span",2),i.qZA()),2&e&&(i.uIk("aria-label",i.lcZ(1,3,"a11y_share_link")),i.xp6(2),i.s9C("titleText",i.lcZ(3,5,"a11y_share_link")),i.xp6(2),i.Q6J("ngIf",t.showCaption))},directives:[o.bk,a.m,s.O5],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.desktop mv-share{min-width:50px}html[dir=ltr] body.desktop mv-share{text-align:right}html[dir=rtl] body.desktop mv-share{text-align:left}a.share{color:#292a30;display:block;text-decoration:none;padding:9px 20px;transition:all .3s}a.share svg-icon{position:relative;width:1.0588235294rem;top:1px;height:20px}html[dir=ltr] a.share svg-icon~span{margin-left:8px}html[dir=rtl] a.share svg-icon~span{margin-right:8px}a.share svg-icon svg{width:.9411764706rem;height:.9411764706rem}a.share svg-icon svg .share-icon-svg{fill:#292a30;transition:all .3s}a.share span{font-size:.9411764706rem}a.share:hover .icon .st0{fill:#40424c}\n"],encapsulation:2}),e})()},90248:function(e,t,n){"use strict";n.d(t,{O:function(){return r}});var i=n(2316);let r=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-spinner"]],decls:3,vars:0,consts:[["version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","width","500px","height","500px","viewBox","0 0 500 500","enable-background","new 0 0 500 500",0,"xml","space","preserve"],["fill","none","stroke","#ddd","stroke-width","40","stroke-linecap","round","stroke-miterlimit","10","cx","250","cy","250","r","208"],["fill","none","stroke","#F16435","stroke-width","40","stroke-linecap","round","stroke-miterlimit","10","stroke-dasharray","0,0","cx","250","cy","250","r","208",1,"spinner-path"]],template:function(e,t){1&e&&(i.O4$(),i.TgZ(0,"svg",0),i._UZ(1,"circle",1),i._UZ(2,"circle",2),i.qZA())},styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-spinner{display:inline-block;height:1.2941176471rem;width:1.2941176471rem}mv-spinner svg{height:100%;width:100%}mv-spinner .spinner-path{transform-origin:50% 50%;-webkit-animation:moovit-spinner 3s infinite linear;-webkit-animation-fill-mode:both;animation:moovit-spinner 3s infinite linear;animation-fill-mode:both}@-webkit-keyframes moovit-spinner{0%{stroke-dasharray:1000;stroke-dashoffset:2000;transform:rotate(0)}70%{stroke-dashoffset:0;transform:rotate(-900deg)}to{stroke-dasharray:1000;stroke-dashoffset:2000;transform:rotate(-1080deg)}}@keyframes moovit-spinner{0%{stroke-dasharray:1000;stroke-dashoffset:2000;transform:rotate(0)}70%{stroke-dashoffset:0;transform:rotate(-900deg)}to{stroke-dasharray:1000;stroke-dashoffset:2000;transform:rotate(-1080deg)}}\n"],encapsulation:2}),e})()},17857:function(e,t,n){"use strict";n.d(t,{n:function(){return h}});var i=n(2316),r=n(36179),o=n(87897),a=n(51063),s=n(54364),l=n(1437),c=n(5971),d=n(2339),u=n(1210),p=n(46461);let h=(()=>{class e{constructor(e,t,n,r,o,a){this.urlGeneratorService=e,this.analyticsService=t,this.store=n,this.translate=r,this.deepLinkService=o,this.document=a,this.overrideBannerClick=new i.vpe,this.isBadgeAbTest=!1}get bannerImage(){const e=(0,r.gn)()?o.g.AppleStore:o.g.GooglePlay;return this.urlGeneratorService.getBadge(e,this.isBadgeAbTest)}get altText(){const e=(0,r.gn)()?"ios":"android";return this.translate.instant(e)}onBannerClick(){const e=(0,a.L)("data-banner-store-badge",this.document);if(e)return this.analyticsService.trackStoreClick("Banner_Button"),this.url=this.deepLinkService.getBannerTestUrl(e,this.urlGeneratorService.appStoreUrl),void window.open(this.url,"_blank");this.url?(this.overrideBannerClick.emit(),window.open(this.url,"_self")):(this.analyticsService.trackStoreClick("Menu_Button"),window.open(this.urlGeneratorService.appStoreUrl,"_blank"))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(o.o),i.Y36(l.y),i.Y36(c.d),i.Y36(d.sK),i.Y36(u.Qz),i.Y36(s.K0))},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-store-banner"]],inputs:{url:"url",tabIndex:"tabIndex",isBadgeAbTest:"isBadgeAbTest"},outputs:{overrideBannerClick:"overrideBannerClick"},decls:2,vars:3,consts:[[1,"play-store-image","store-image",3,"tabIndex","click","keydown.enter"],["mvImg","",3,"src","alt"]],template:function(e,t){1&e&&(i.TgZ(0,"a",0),i.NdJ("click",function(){return t.onBannerClick()})("keydown.enter",function(){return t.onBannerClick()}),i._UZ(1,"img",1),i.qZA()),2&e&&(i.Q6J("tabIndex",t.tabIndex),i.xp6(1),i.Q6J("src",t.bannerImage,i.LSH)("alt",t.altText))},directives:[p.X],styles:["mv-store-banner .store-image img{width:100%}\n"],encapsulation:2}),e})()},31127:function(e,t,n){"use strict";n.d(t,{Q:function(){return y}});var i=n(2316),r=n(54364),o=n(32066),a=n(87479),s=n(93975),l=n(2339);function c(e,t){1&e&&i.GkF(0)}function d(e,t){if(1&e&&(i.TgZ(0,"a",4),i.YNc(1,c,1,0,"ng-container",5),i.qZA()),2&e){const e=i.oxw(2),t=i.MAs(2);i.Udp("background-color",e.message.backgroundColor),i.Q6J("href",e.message.url,i.LSH),i.xp6(1),i.Q6J("ngTemplateOutlet",t)}}function u(e,t){1&e&&i.GkF(0)}function p(e,t){if(1&e&&(i.TgZ(0,"div",6),i.YNc(1,u,1,0,"ng-container",5),i.qZA()),2&e){const e=i.oxw(2),t=i.MAs(2);i.Udp("background-color",e.message.backgroundColor),i.xp6(1),i.Q6J("ngTemplateOutlet",t)}}function h(e,t){if(1&e&&(i.ynx(0),i.YNc(1,d,2,4,"a",2),i.YNc(2,p,2,3,"div",3),i.BQk()),2&e){const e=i.oxw();i.xp6(1),i.Q6J("ngIf",e.message.url),i.xp6(1),i.Q6J("ngIf",!e.message.url)}}function m(e,t){if(1&e&&i._UZ(0,"mvf-image",11),2&e){const e=i.oxw(2);i.Q6J("imageId",e.message.imageId)}}function g(e,t){1&e&&i._UZ(0,"svg-icon",12)}function f(e,t){1&e&&(i._UZ(0,"svg-icon",13),i.ALo(1,"translate")),2&e&&i.s9C("titleText",i.lcZ(1,1,"action_open"))}function v(e,t){if(1&e&&(i.YNc(0,m,1,1,"mvf-image",7),i.YNc(1,g,1,0,"svg-icon",8),i.TgZ(2,"span",9),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.YNc(5,f,2,3,"svg-icon",10)),2&e){const e=i.oxw();i.Q6J("ngIf",e.message.imageId),i.xp6(1),i.Q6J("ngIf",!e.message.imageId),i.xp6(2),i.Oqu(i.lcZ(4,4,e.message.text)),i.xp6(2),i.Q6J("ngIf",e.message.url)}}let y=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["mv-updates-message"]],inputs:{message:"message"},decls:3,vars:1,consts:[[4,"ngIf"],["updateMessage",""],["target","_blank","class","updates-message-wrapper",3,"href","backgroundColor",4,"ngIf"],["class","updates-message-wrapper",3,"backgroundColor",4,"ngIf"],["target","_blank",1,"updates-message-wrapper",3,"href"],[4,"ngTemplateOutlet"],[1,"updates-message-wrapper"],["class","update-icon",3,"imageId",4,"ngIf"],["src","images/icons/alert-empty.svg","class","info-message-icon",4,"ngIf"],[1,"message-text"],["class","arrow-icon","src","images/icons/expand_light_gray.svg","mvAccessibleSVG","",3,"titleText",4,"ngIf"],[1,"update-icon",3,"imageId"],["src","images/icons/alert-empty.svg",1,"info-message-icon"],["src","images/icons/expand_light_gray.svg","mvAccessibleSVG","",1,"arrow-icon",3,"titleText"]],template:function(e,t){1&e&&(i.YNc(0,h,3,2,"ng-container",0),i.YNc(1,v,6,6,"ng-template",null,1,i.W1O)),2&e&&i.Q6J("ngIf",t.message)},directives:[r.O5,r.tP,o.YY,a.bk,s.m],pipes:[l.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-search-results+mv-updates-message{display:none}.spinner~mv-directions-main-view mv-updates-message{display:none}.updates-message-wrapper{margin:10px;display:flex;border-radius:4px;color:#515357;align-items:center;text-decoration:none}html[dir=ltr] .updates-message-wrapper{padding-left:12px}html[dir=rtl] .updates-message-wrapper{padding-right:12px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){.updates-message-wrapper{margin-bottom:0}}.updates-message-wrapper>*{border-radius:4px}.updates-message-wrapper .update-icon{margin:0;width:auto}.updates-message-wrapper .update-icon .mvf-wrapper{height:23px}html[dir=ltr] .updates-message-wrapper .update-icon>*>*{padding-right:12px}html[dir=rtl] .updates-message-wrapper .update-icon>*>*{padding-left:12px}.updates-message-wrapper .message-text{padding:12px 0;flex-grow:1}.updates-message-wrapper .arrow-icon{height:.3529411765rem;transform:rotate(-90deg);margin:0;min-width:.7058823529rem;max-width:.7058823529rem;padding:0 .4117647059rem .8823529412rem}html[dir=ltr] .updates-message-wrapper .arrow-icon{transform:rotate(-90deg)}html[dir=rtl] .updates-message-wrapper .arrow-icon{transform:rotate(90deg)}.updates-message-wrapper .arrow-icon polygon{fill:#aeb0b4}.updates-message-wrapper .info-message-icon{margin:0 7px 0 0}.updates-message-wrapper .info-message-icon svg path{fill:#2196f3}\n"],encapsulation:2}),e})()},93975:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=n(2316);let r=(()=>{class e{constructor(e){this.element=e}ngAfterViewChecked(){const e=this.element.nativeElement.children[0];e&&(e.setAttribute("role","img"),e.setAttribute("aria-label",this.titleText),e.setAttribute("alt",this.altText||""),e.setAttribute("tabindex",this.tabIndex))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq))},e.\u0275dir=i.lG2({type:e,selectors:[["","mvAccessibleSVG",""]],inputs:{titleText:"titleText",altText:"altText",tabIndex:"tabIndex"}}),e})()},60778:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var i=n(2316);let r=(()=>{class e{constructor(e){this._elementRef=e,this.clickOutside=new i.vpe}onClick(e,t){t&&(this._elementRef.nativeElement.contains(t)||this.clickOutside.emit(e))}onKeydown(e){"Escape"===e.key&&this.clickOutside.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq))},e.\u0275dir=i.lG2({type:e,selectors:[["","mvClickOutside",""]],hostBindings:function(e,t){1&e&&i.NdJ("touchend",function(e){return t.onClick(e,e.target)},!1,i.evT)("click",function(e){return t.onClick(e,e.target)},!1,i.evT)("keydown",function(e){return t.onKeydown(e)},!1,i.Jf7)},outputs:{clickOutside:"clickOutside"}}),e})()},46461:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var i=n(4008),r=n(2433),o=n(2316);let a=(()=>{class e{constructor(e){this.element=e}ngOnChanges(e){const t=this.element.nativeElement;if(!t||(t.src=this.src,this.src.startsWith("data:")))return;const n=this.src.startsWith("/")?"":"/";let o=i.S$.slice(0,-1)+n;this.src.includes("images/partners/")&&(o=o.replace("mobile/","")),r.N.production||(this.src.includes("images/partners/")&&(o=o.replace("/mobile","")),o=o.replace("appassets","appassets")),t.src=o+this.src}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq))},e.\u0275dir=o.lG2({type:e,selectors:[["","mvImg",""]],inputs:{src:"src"},features:[o.TTD]}),e})()},86607:function(e,t,n){"use strict";n.d(t,{N:function(){return r}});var i=n(2316);let r=(()=>{class e{constructor(){}transform(e){return e.hasOwnProperty("__zone_symbol__state")&&e.hasOwnProperty("__zone_symbol__value")&&e.__zone_symbol__state?Promise.resolve(e.__zone_symbol__value):Promise.resolve(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Yjl({name:"asyncify",type:e,pure:!0}),e})()},56329:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var i=n(2316),r=n(10723),o=n(5971);const a=[{language:["zh-cn","zh-tw"],matchRegex:/\u7dab|\u7dda|(\u7ebf|\u8def)/g,replaceFirstRegex:null},{language:["he"],matchRegex:/\s\u05e7\u05d5/g,replaceFirstRegex:null},{language:["es","es-419","pt","pt-br"],matchRegex:/\b(l\xednea|linha)\b/gi,replaceFirstRegex:null}];let s=(()=>{class e{constructor(e,t){this.localeService=e,this.store=t}get state(){return this.store.getState()}transform(e){const t=this.state.global.selectedLocale?this.state.global.selectedLocale.id:this.localeService.getDefaultLang(),n=this.getCorrectionRule(t);if(n){const t=e.match(n.matchRegex);if(t&&t.length>1)return n.replaceFirstRegex=n.replaceFirstRegex||new RegExp(n.matchRegex,"i"),e.replace(n.replaceFirstRegex,"")}return e}getCorrectionRule(e){return a.find(t=>t.language.includes(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.OL,16),i.Y36(o.d,16))},e.\u0275pipe=i.Yjl({name:"correctLineName",type:e,pure:!1}),e})()},79223:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var i=n(2316),r=n(71570);let o=(()=>{class e{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.H7,16))},e.\u0275pipe=i.Yjl({name:"safeHtml",type:e,pure:!0}),e})()},74874:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var i=n(2316),r=n(71570);let o=(()=>{class e{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustUrl(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.H7,16))},e.\u0275pipe=i.Yjl({name:"safeUrl",type:e,pure:!0}),e})()},47111:function(e,t,n){"use strict";n.d(t,{_x:function(){return o},T0:function(){return a}});var i=n(2281),r=n(2316);let o=(()=>{class e{transform(e,t){return function(e){return e?i(e).format("LT"):null}(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"time",type:e,pure:!0}),e})(),a=(()=>{class e{transform(e,t){return function(e){return e?i.unix(e).format("LT"):null}(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"unixtime",type:e,pure:!0}),e})()},15208:function(e,t,n){"use strict";n.d(t,{F7:function(){return _},mi:function(){return T},zh:function(){return b}});var i=n(3786),r=n(54364),o=n(66883),a=n(94354),s=n(55013),l=n(65492),c=n(56505),d=n(2316),u=n(99902),p=n(25634),h=n(95505),m=n(61787),g=n(21090);let f=(()=>{class e{constructor(e,t,n){this.routingService=e,this.canonicalService=t,this.dialogService=n}forMobile(){this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath(["metro",":locale"]))}forDesktop(){this.dialogService.create(p.p,{width:"calc(100% - 30px)",maxWidth:"320px"})}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(h.Z),d.LFG(m.z),d.LFG(g.x))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=n(5306),y=(()=>{return(e=y||(y={}))[e.MetroSelector=0]="MetroSelector",y;var e})(),b=(()=>{return(e=b||(b={})).Mobile="mobile",e.Desktop="desktop",b;var e})(),_=(()=>{return(e=_||(_={})).Portrait="portrait",e.Landscape="landscape",_;var e})();let T=(()=>{class e{constructor(e,t,n,i,r,s){if(this.httpService=t,this.breakpointObserver=n,this.metroSelectorPlatformRunner=i,this.universalService=r,this.tokenToInstance={[y.MetroSelector]:this.metroSelectorPlatformRunner},this.isDesktopSubject=new a.x,this.isLandscapeSubject=new a.x,this.platform=b.Desktop,this.orientation=_.Portrait,this.universalService.isServer){const e=new c(s.headers["user-agent"]);this.platform=function(e,t){const n=e.headers["cloudfront-is-mobile-viewer"],i=e.headers["cloudfront-is-tablet-viewer"];return n&&i?"true"===n&&"true"!==i:!!t.mobile()}(s,e)?b.Mobile:b.Desktop}else this.breakpointObserver.observe([o.u3.Handset]).subscribe(e=>{this.platform=e.matches?b.Mobile:b.Desktop,this.isDesktopSubject.next(this.platform===b.Desktop)}),this.breakpointObserver.observe(["(orientation: landscape)","(orientation: portrait)"]).subscribe(e=>{this.orientation=e.breakpoints["(orientation: landscape)"]?_.Landscape:_.Portrait,this.isLandscapeSubject.next(this.orientation===_.Landscape)})}get isDesktop(){return this.platform===b.Desktop}get isMobile(){return this.platform===b.Mobile}get isLandscape(){return this.orientation===_.Landscape}get isPortrait(){return this.orientation===_.Portrait}run(e){const t=this.tokenToInstance[e];if(!t)throw new Error("Invalid PlatformRunnerToken");this.isMobile?t.forMobile():this.isDesktop&&t.forDesktop()}getFeatureFlags(){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(l.ZP.GetFeatureFlags).toPromise()})}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(r.K0),d.LFG(u.O),d.LFG(o.Yg),d.LFG(f),d.LFG(v.p),d.LFG(s.Z,8))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},78146:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var i=n(54364),r=n(2316);let o=(()=>{class e{constructor(e){e.addEventListener("keydown",e=>this.lastKeydown=e.key),e.addEventListener("mousedown",()=>this.lastKeydown=null),e.addEventListener("touchend",()=>this.lastKeydown=null)}get byEnter(){return"Enter"===this.lastKeydown}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(i.K0))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1437:function(e,t,n){"use strict";n.d(t,{y:function(){return E},a:function(){return A}});var i=n(86781),r=n(99528),o=n(13691),a=n(16438),s=n(83486),l=n(55754),c=n(87100),d=n(25837),u=n(36179),p=n(43445),h=n(52959),m=(()=>{return(e=m||(m={}))[e.Destinations=1]="Destinations",e[e.Lines=2]="Lines",e[e.Maps=3]="Maps",e[e.Agencies=4]="Agencies",e[e.Other=5]="Other",e[e.Direct=6]="Direct",e[e.SeoError=7]="SeoError",e[e.Poi2Poi=8]="Poi2Poi",m;var e})();const g={Destinations:"SEO destinations",Lines:"SEO lines",Maps:"SEO maps",Agencies:"SEO agencies",Other:"SEO other",Direct:"Direct",SeoError:"SEO error pages",Partner:"Partner",Poi2Poi:"SEO Poi2Poi"},f=[{pattern:/^[^-]+-\d+\/poi\/[^/]+\/t\/[^/]+$/,group:"toPoi"},{pattern:/^[^-]+-\d+\/poi\/[^/]+\/f\/[^/]+$/,group:"fromPoi"},{pattern:/^[^-]+-\d+\/poi\/[^/]+\/[^/]+\/[^/]+$/,group:"poiToPoi"},{pattern:/^[^-]+-\d+\/poi\/[^/]+\/[^/]+\/itinerary\/[^/]+$/,group:"itinerary"},{pattern:/^[^-]+-\d+\/poi\/[^/]+\/[^/]+\/itinerary-map\/[^/]+$/,group:"itinerary.map"},{pattern:/^[^-]+-\d+\/poi\/[^/]+\/[^/]+\/stop-arrivals\/[^/]+$/,group:"itinerary.stopArrivals"},{pattern:/^[^-]+-\d+\/poi\/[^/]+$/,group:"tripPlan"},{pattern:/^[^-]+-\d+\/lines\/[^/]+\/\d+\/\d+\/map\/[^/]+$/,group:"lines.lineGroup.line.map"},{pattern:/^[^-]+-\d+\/lines\/[^/]+\/\d+\/\d+\/[^/]+$/,group:"lines.lineGroup.line"},{pattern:/^[^-]+-\d+\/alerts\/[^/]+$/,group:"alerts"},{pattern:/^[^-]+-\d+\/lines\/[^/]+$/,group:"lines"},{pattern:/^[^-]+-\d+\/accounts\/[^/]+$/,group:"accounts"},{pattern:/^[^-]+-\d+\/settings\/[^/]+$/,group:"settings"},{pattern:/^[^-]+-\d+\/language\/[^/]+$/,group:"language"},{pattern:/^[^-]+-\d+\/metro\/[^/]+$/,group:"metro"},{pattern:/^\/$/,group:"directions"}];var v=n(37349),y=n(4008),b=n(5),_=n(2316),T=n(5971),S=n(95505),x=n(99957),w=n(71570),k=n(72249);const M=(0,i.hu)("AnalyticsService");let L=[];const A={SuggestRoutes:"Suggest Routes",WebUserAction:"Web user action",UseCurrentLocation:"Use current location",DownloadApp:"DownloadApp",ClickToWebApp:"Click to web app",Lines:"Lines",Share:"Share",SideNavigation:"Side Navigation",PhoneScreen:"Phone Screen",SMSSecurityCode:"SMS Security Code",PersonalDetailsScreen:"Personal Details Screen",Error:"Error",Reblaze:"Reblaze",MotUserAction:"Mot web user action",TODPopup:"tod_popup_user_action",TODOrderScreen:"tod_order_user_action",TODActiveRideScreen:"tod_ride_user_action",TODGeneral:"user_action",TODMyRides:"tod_my_rides_user_action",TODRideDetailsScreen:"tod_web_user_action",TODBanner:"suggest_routes_user_action"};v.i.__mockDataLayerObject={};const I={"":"Directions Tab - Initial","itinerary-options":"Directions Tab - Options",itinerary:"Directions Tab - Itinerary View","itinerary-map":"Directions Tab - Itinerary Map View",stopArrivals:"Directions Tab - Itinerary Stop Arrivals",lines:"Lines tab","lines/view":"Single Line View","lines/lines-map":"Single Line View - Map","lines/stop-arrivals":"Single Line View - Stop Arrivals",alerts:"Alerts Tab",alertDetails:"Alerts Tab - Details","alerts/view":"Alerts Tab - Single Alert View",settings:"Settings",language:"Language Selection",metro:"Metro Selection"};let E=(()=>{class e{constructor(e,t,n,i,r,o){this.store=e,this.routingService=t,this.hookService=n,this.customerService=i,this.title=r,this.daysService=o,this.isReady=!1}get state(){return this.store.getState()}get metroId(){return this.state.metro.metroId}get customerId(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.id}get customerConfig(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration||{}}initSession(){this.sessionId=(0,o.Ox)(),this.pushData({SessionId:this.sessionId})}init(){const e=this.state.customer.currentCustomer;if(e){if(e.designConfiguration.hideAnalytics)return;this.pushData({CustomerName:e.name,Source:this.getSourceCustomDimension()})}try{if((0,h.i6)()){const e=ga.getAll()[0].get("clientId");e&&this.pushData({AnalyticsClientId:e}),this.trackScreenOrientation()}}catch(t){}this.customerConfig.waitForAnalytics||this.setReady()}setReady(){this.isReady=!0,L.forEach(e=>this.pushData(e)),L=[]}trackUserEvent(e,t,n,i){this.sendEvent(A.WebUserAction,e,t,null,!1,n,i)}trackScreenOrientation(){const e=window.outerHeight<window.outerWidth?"landscape":"portrait";this.pushData({Orientation:e})}trackUserData(){this.pushData({CountryName:this.state.metro.currentMetroCustomDimensions.countryName,MetroName:this.state.metro.currentMetroCustomDimensions.metroSeoName,MetroId:this.state.metro.currentMetro.metroAreaId,PageLanguage:this.state.global.selectedLocale.id});const e=this.state.user.account.userKey;e&&this.pushData({UserId:e})}trackInitialTabView(e){const t=this.routingService.getCurrentRouteData();if(!(e=e||a.We[t.subTabId]))return void M.error("Didn't find initial tab to track in analytics!","routeData:",t);const n=this.getTabData(e.tabId,e.subTabId);this.sendEvent(A.WebUserAction,"Initial View tab",n,null,!1,!0)}getTabData(e,t){return{tab:([a.zA.TRIPPLAN_ITINERARY,a.zA.TRIPPLAN_MAP,a.zA.TRIPPLAN_STOPARRIVALS].includes(t)?"Itinerary":a.dW[e])||"",subTab:a.cB[t]}}trackTabView(e){const t=a.dW[e];!t||this.sendEvent(A.WebUserAction,"View tab",t,null,!1,!1)}trackMotBannerClick(){this.sendEvent(A.WebUserAction,"Promotion banner","MOT")}trackSubTabView(e){const t=a.cB[e];!t||this.sendEvent(A.WebUserAction,"View inner tab",t,null,!1,!1)}getPageName(e){let t=I[e];return""==e&&this.state.directions.suggestedRoutes.loadingState==r.Gu.LOADED&&(t="Directions Tab - Results"),t}getPageGrouping(e){return f.reduce((t,n)=>t||(n.pattern.test(e)?n.group:null),null)||e}trackPageView(e,t=!1){const n=this.getPageName(e),i=this.getPagePathUrl(),r=this.title.getTitle();M.log("Tracking page view: "+(e=`/${e}`),`(${n})`);let o={event:"virtualPageView",virtualPageUrl:i,virtualPageTitle:r,Timestamp:this.getTrackingTimestamp(),FullURL:i,PageGrouping:this.getPageGrouping(e),PageType:this.getPageTypeCDValue()};t&&(o.skip=!0),o=this.hookService.runHooks(p.e.MODIFIER_TRACK_PAGEVIEW,o,this)(),o&&!o.skip&&(this.pushData(o),this.pushData({CurrentRoute:e}),this.pushData({GrabStateName:n}))}trackSideNavStateChange(e){this.sendEvent(A.SideNavigation,e)}trackSideNavigationEvent(e){this.sendEvent(A.SideNavigation,e)}trackSupportLink(e){const t=e?"Desktop":(0,u.WO)()===r.$I.Android?"Google":"Apple";this.sendEvent(A.WebUserAction,"support",t)}trackOpenMetroSelectorView(){this.trackUserEvent("Open metro selector")}trackOpenLangSelectorView(){this.trackUserEvent("Open lang selector")}trackLocaleChanged(e){this.trackUserData(),this.trackUserEvent("Change lang",e)}trackMetroChanged(e){this.trackUserData(),this.trackUserEvent("Change metro",e.toString())}trackChangeDepartureOptions(e,t,n){const i={departureOption:{time_picker_arrive_by:"Set desired arrival time",time_picker_depart_at:"Set your departure time",last_available_transit:"Last departures for today",time_picker_leave_now:"Depart Now"}[e]};("time_picker_arrive_by"==e||"time_picker_depart_at"==e)&&(i.time=(0,c.$D)(t,!1),i.date=(0,c.EW)(n)),this.trackUserEvent("Selected departure option",i)}trackChangedSearchOptions(e,t){this.trackUserEvent("Changed search options",{routePriority:e,transitTypes:t})}trackShowRouteSteps(e,t){this.trackUserEvent("Expand route",{index:t,duration:e.durationMinutes})}trackSearchRoutes(e,t){const n=e.fullName||e.name,i=t.fullName||t.name,r=l._.toString(e.latlng),o=l._.toString(t.latlng);this.trackUserEvent("Search routes",{from:{name:n,latlng:r},to:{name:i,latlng:o}})}trackSearchRoutesEnd(e,t){this.trackUserEvent("Search routes end",null,null,{SuggestedRoutesCount:null!=e?e:0,SuggestedRoutesErrorCode:t})}trackShowRouteStopArrivals(e){const t=e.leg.stopIds.join(",");this.trackUserEvent("Expand stop schedule",{id:t,name:e.extra.legDescription?e.extra.legDescription.value:""},!0)}trackSearchLocation(e,t,n){this.trackUserEvent(`Search ${e==r.$h.From?"from":"to"} location via ${n} field`,t)}trackSelectRecentLocation(e){this.trackUserEvent("Choose recent location",this.getLocationName(e))}trackSelectSearchLocation(e,t){this.trackUserEvent("Choose search location",{location:this.getLocationName(e),index:t})}trackSwitchLocations(e,t){this.trackUserEvent(`Switched locations: original from: ${this.getLocationName(e)}, original to: ${this.getLocationName(t)}`)}trackSimilarRouteChanged(e,t){const n={currentStartTime:t.startTime.getTime()};this.trackUserEvent(1===e?"Later route":"Earlier route",n)}trackRoutePreviousStep(e){this.trackUserEvent("Previous step",{currentIndex:e})}trackRouteNextStep(e){this.trackUserEvent("Next step",{currentIndex:e})}trackRouteSwitchStep(e){this.trackUserEvent("Select step",{currentIndex:e})}trackUseCurrentLocationClick(){this.sendEvent(A.WebUserAction,"use my location")}trackUseCurrentLocation(){this.sendEvent(A.UseCurrentLocation,"click")}trackPermission(e,t){this.sendEvent(A.UseCurrentLocation,e,t)}trackUseCurrentLocationPopup(e){this.sendEvent(A.UseCurrentLocation,"OS pop up",e?"Allow":"Block")}trackUseCurrentLocationFailed(e){let t="unknown error";switch(e){case 0:t="unknown error";break;case 1:t="permission denied";break;case 2:t="position unavailable";break;case 3:t="timed out"}this.sendEvent(A.UseCurrentLocation,"failure",t)}trackLinesAction(e,t){this.sendEvent(A.Lines,e,t)}trackShareAction(e,t){this.sendEvent(A.Share,e+(t?" ("+t+")":""))}trackStoreClick(e,t,n){n=n||e,t=null!=t?t:(0,u.WO)(),this.trackDownloadApp(t===r.$I.Android?"Google":"Apple",n)}trackDownloadApp(e,t){this.sendEvent(A.DownloadApp,t,e)}trackClickToWebApp(e,t){this.sendEvent(A.ClickToWebApp,e,t)}trackError(e,t=!1,n){this.sendEvent(A.Error,e,n?{statusCode:n}:null,null,t)}trackAccount(e,t,n=""){this.sendEvent(e,t,y.eP,n)}trackOpenAccountsFlow(e,t){this.trackUserEvent(`Open accounts ${e} flow from ${t}`)}trackOpenLogoutFlow(e){this.trackUserEvent(`Open accounts logout flow from ${e}`)}trackAccountStatus(){this.pushData({AccountLoggedIn:this.state.user.accountStatus===b.dp.Authenticated?1:0,UserId:this.state.user.account.userKey})}trackApplicationInitialized(){const e=(0,d.cb)(d.y5.APP_INITIALIZED);this.sendEvent("Web app initialized","app OK",{initialLoadLatency:e}),this.sendEvent("Timing",d.y5.MP_APP_INIT,this.timeToLabel(e))}timeToLabel(e){return e>2e4?"20+":(Math.round(e/500)/2).toFixed(1)}getTrackingTimestamp(){return(new Date).toISOString()}getPagePathUrl(){return decodeURI(location.pathname)}trackOpenAlert(e){this.trackUserEvent("alert selected",e,!0)}trackOpenAlertFromStep(e){this.trackUserEvent("Open alert from route",e)}todMode(e){return e===s.Rl.FUTURE?"offline":"online"}trackCarpoolBannerClick(){this.trackUserEvent("Carpool banner click")}trackCarpoolBannerDisplay(){this.trackUserEvent("Carpool banner display")}trackDismissSplash(){this.trackUserEvent("dismiss splash")}trackNearbyClickOnMapItem(e){this.trackUserEvent("Nearby click on map item",e)}trackNearbyClickOnFocusButton(){this.trackUserEvent("Nearby click on focus button")}trackNearbyClickOnStopFromList(){this.trackUserEvent("Nearby click on stop from list")}trackNearbyClickOnLineFromList(e){this.trackUserEvent("Nearby click on line from stops list",e?"With RT":"Without RT")}trackNearbyClickOnLineFromSingleStop(e){this.trackUserEvent("Nearby click on line from single stop",e?"With RT":"Without RT")}trackNearbyBottomsheetTabChange(e){this.trackUserEvent("Nearby changed bottomsheet tab",e)}trackNearbyClickedStopData(e){this.trackUserEvent("Nearby selected stop data",e)}trackNearbyMMFilterSelected(e){this.trackUserEvent("Nearby selected micro mobility filter",e)}trackNearbyClickedMMItemData(e){this.trackUserEvent("Nearby selected micro-mobility item data",e)}trackNearbyClickedMMItemOpenAppLink(e){this.trackUserEvent("Nearby clicked micro mobility item open app",e)}trackOpenedMoovitLocationPopup(){this.sendEvent(A.UseCurrentLocation,"Moovit location popup opened")}trackReblazeEvent(e){this.sendEvent(A.Reblaze,e)}trackCommunityEvent(e){this.sendEvent("Community",e)}trackOutboundLink(e){this.sendEvent("outbound","click",e)}trackBuyPassesLink(e){this.sendEvent("BuyPasses","click",e)}trackFirstJSTimes(){const e=(0,d.cb)(d.y5.FIRST_JS);this.sendEvent("Timing",d.y5.FIRST_JS,this.timeToLabel(e),null,!0)}trackMotEvent(e,t,n){this.sendEvent(A.MotUserAction,e,t,n)}sendEvent(e,t,n,i="",r=!1,o=!1,a){const s="string"==typeof n?n:JSON.stringify(n),l="string"==typeof i?i:JSON.stringify(i);M.log("Tracking event: "+e+"; "+t+(s?"; "+s:"")+(l?"; "+l:""));let c={event:"codeTriggeredEvent",eventCategory:e,eventAction:t,eventLabel:s,eventValue:l,Timestamp:this.getTrackingTimestamp(),FullURL:this.getPagePathUrl()};o&&(c.skip=!0),c=this.hookService.runHooks(p.e.MODIFIER_TRACK_EVENT,c,this)(),c&&!c.skip&&(a&&(c=Object.assign(Object.assign({},c),a)),this.pushData(c,r))}pushData(e,t=!1){"undefined"!=typeof dataLayer&&(t||this.isReady)?(dataLayer.push(e),v.i.__mockDataLayerObject=Object.assign(Object.assign({},v.i.__mockDataLayerObject),e)):L.push(e)}getSourceCustomDimension(){if("undefined"!=typeof dataLayer&&dataLayer[0]&&dataLayer[0].Source)return dataLayer[0].Source;if(this.state.customer)switch(this.state.customer.currentCustomer.id){case this.customerService.MoovitWeb.id:return g.Direct;case this.customerService.MoovitSeo.id:const e=this.routingService.getStateFromUrl().referral;if(e)return g[m[e]];M.log(`Unknown seo referral type for url: ${v.i.location.href}`);break;default:return g.Partner}return g.Direct}getSeoAbTestCustomDimension(){var e;return"undefined"!=typeof dataLayer&&(null===(e=dataLayer[0])||void 0===e?void 0:e.SeoAbTest)?dataLayer[0].SeoAbTest:this.routingService.getStateFromUrl().seoAbTest||null}getGaPayloadForNativeApp(e,t){let n=null;try{const r=ga.getAll()[0].get("clientId");let o=t;o&&(o=`_${o}`),n=`v=1&t=event&tid=UA-36954272-1&cid=${encodeURIComponent(r)}&ec=offline&ea=install${o}&el=${e}`;const a="Web App";let s=null,l=null,c=null,d=null;try{s=this.state.customer.currentCustomer&&this.state.customer.currentCustomer.name,l=this.state.metro.currentMetro.countryName,c=this.state.metro.currentMetro.metroAreaName,d=this.state.global.selectedLocale.id}catch(i){}a&&(n+=`&cd8=${encodeURIComponent(a)}`),s&&(n+=`&cd11=${encodeURIComponent(s)}`),l&&(n+=`&cd1=${encodeURIComponent(l)}`),c&&(n+=`&cd2=${encodeURIComponent(c)}`),d&&(n+=`&cd7=${encodeURIComponent(d)}`);const u=this.getSourceCustomDimension();u&&(n+=`&cd22=${encodeURIComponent(u)}`);const p=this.state.user.account.userKey;p&&(n+=`&cd51=${encodeURIComponent(p)}`),r&&(n+=`&cd30=${encodeURIComponent(r)}`)}catch(r){}return n}getLocationName(e){return e.fullName||e.name}trackGrabData(e){const t=this.routingService.getCurrentRoute().path;this.pushData({GrabUserId:e,GrabStateName:this.getPageName(t),City:this.routingService.getStateFromUrl().city,AppVersion:"1.5.0"},!0),this.setReady()}getPageTypeCDValue(){return this.state.global.selectedTab===a.TF.TRIPPLAN?"Web app directions":this.state.global.selectedTab===a.TF.LINES?"Web app lines":this.state.global.selectedTab===a.TF.ALERTS?"Web app alerts":"Web app other"}}return e.\u0275fac=function(t){return new(t||e)(_.LFG(T.d),_.LFG(S.Z),_.LFG(p.$),_.LFG(x.v),_.LFG(w.Dx),_.LFG(k.O))},e.\u0275prov=_.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},61787:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var i=n(16438),r=n(13691),o=n(2316),a=n(99957),s=n(5971);let l=(()=>{class e{constructor(e,t){this.customerService=e,this.store=t}get state(){return this.store.getState()}isCanonicalTabId(e){return!0}getReservedWords(){const e=this.state;return[{k:":default",v:this.customerService.getDefaultSubTabId(e.customer.currentCustomer)},{k:":tab",v:e.global.selectedTab},{k:":locale",v:e.global.selectedLocale.id},{k:":searchTo",v:e.directions.search.to?(0,r.Xh)(e.directions.search.to.name):""},{k:":searchFrom",v:e.directions.search.from?(0,r.Xh)(e.directions.search.from.name):""},{k:":lineShortName",v:e.line.lineGroup?(0,r.Xh)(e.line.lineGroup.lineNumber.toLowerCase()):""},{k:":lineGroupId",v:e.line.lineGroup?e.line.lineGroup.lineGroupId.toString():""},{k:":lineId",v:e.line.selectedLine?e.line.selectedLine.lineId.toString():""}]}buildStatefulPath(e,t){t&&e.unshift(...this.getPath(t));const n=this.getReservedWords();let i=e.join("/");for(const r in n)i=i.replace(n[r].k,n[r].v);return this.state.metro.currentMetroCustomDimensions.metroSeoName.toLowerCase()+"-"+this.state.metro.currentMetro.metroAreaId+"/"+i}getPath(e){return[...{[i.zA.TRIPPLAN_DIRECTIONS]:["poi"],[i.zA.TRIPPLAN_ITINERARY]:["poi",":searchTo",":searchFrom","itinerary"],[i.zA.TRIPPLAN_MAP]:["poi",":searchTo",":searchFrom","itinerary-map"],[i.zA.TRIPPLAN_STOPARRIVALS]:["poi",":searchTo",":searchFrom","stop-arrivals"],[i.zA.TRIPPLAN_OPTIONS]:["poi",":searchTo",":searchFrom","itinerary-options"],[i.zA.TOD_RIDE_ORDER]:["poi",":searchTo",":searchFrom","tod","ride-order"],[i.zA.TOD_ACTIVE_RIDE]:["poi","tod","active-ride"],[i.zA.TOD_HISTORY_RIDES]:["poi","tod","my-rides","history-rides"],[i.zA.TOD_HISTORY_RIDE_DETAILS]:["poi","tod","my-rides","ride-details"],[i.zA.LINES_MAIN]:["lines"],[i.zA.LINES_VIEW]:[":tab",":lineShortName",":lineGroupId",":lineId"],[i.zA.LINES_STOPARRIVALS]:[":tab",":lineShortName",":lineGroupId",":lineId"],[i.zA.LINES_MAP]:[":tab",":lineShortName",":lineGroupId",":lineId","map"],[i.zA.ALERTS_VIEW]:["alerts"],[i.zA.ALERTS_SINGLE_VIEW]:["alerts"],[i.zA.NEARBY_MAP]:["nearby"]}[e],":locale"]}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.v),o.LFG(s.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},67839:function(e,t,n){"use strict";n.d(t,{K:function(){return c}});var i=n(3786),r=n(86781),o=n(65492),a=n(2316),s=n(99902);const l=(0,r.hu)("SettingsService");let c=(()=>{class e{constructor(e){this.httpService=e,this.allCountries=null}getCountryByName(e){return this.getAllCountries().then(t=>{for(const n of t)if(n.name==e)return n;throw new Error("Country with name: "+e+" was not found")})}getAllCountries(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.allCountries)return this.allCountries;const e=yield this.httpService.get(o.bl.GetCountries).toPromise();return l.log(e),e.forEach(e=>{let t=e.name+" ";e.keywords.forEach(e=>{t+=e+" "}),e.searchTerm=t.trim(),e.metros.forEach(e=>{let n=t+" "+e.name+" ";e.keywords.forEach(e=>{n+=e+" "}),e.searchTerm=n.trim()})}),this.allCountries=e,this.allCountries})}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.O))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},46934:function(e,t,n){"use strict";n.d(t,{c:function(){return s}});var i=n(13691),r=n(2316),o=n(5971),a=n(61787);let s=(()=>{class e{constructor(e,t){this.store=e,this.canonicalService=t}get state(){return this.store.getState()}isPrivateHost(){return this.state.customer.currentCustomer&&this.state.customer.currentCustomer.designConfiguration&&this.state.customer.currentCustomer.designConfiguration.hideUrlParams&&this.state.customer.extraData.privateHost}getDynamicUrlParams(){const e=this.state.customer.currentCustomer,t={customerId:null,lang:this.state.global.selectedLocale.id||e.defaultLocaleId,metroId:this.state.metro.metroId||e.defaultMetroId};return this.canonicalService.isCanonicalTabId(this.state.global.selectedTab)&&(t.lang=null,t.metroId=null),(0,i.Ph)("city")&&(t.lang=null,t.metroId=null),this.isPrivateHost()&&(t.city=!0),t}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(o.d),r.LFG(a.z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},99957:function(e,t,n){"use strict";n.d(t,{v:function(){return l}});var i=n(5982),r=n(4008);class o{constructor(e,t,n,i,r,o,a,s,l,c,d,u,p,h,m,g){if(this.id=e,this.name=t,"n/a"==n)this.defaultMetroId=0;else{if("number"!=typeof n)throw console.error("Incorrect partner ",this.id,"metroId: ",n),new Error("Incorrect partner metroId parameter");this.defaultMetroId=n}this.managerName=i,this.defaultLocaleId=r,this.androidAppDeepLink="moovit://nearby",this.iOsAppDeepLink="moovit2://",this.appItineraryDeepLink="moovit://itinerary",this.logo=o,this.latLng=0!=a&&0!=s?{lat:a,lng:s}:null,this.ticketsUrl=l,c||(c={}),(c=Object.assign(Object.assign({},{logo:"/images/moovit_logo_full-white.svg",logoLink:null,isLogoSVG:!0,cssFile:"",hideMetroSelection:!1,hidePartnership:!1,hideSplashScreen:!1,hideCarpool:!1,hideSideNav:!1,hideLines:!1,hideAlerts:!1,hideCookieBar:!1,hideSharing:!1,automaticInitialGeoLocation:!1,hideCommunityBar:!1,cookiesPolicyUrl:"",hideAnalytics:!1,enableLiveDirections:!1,enableNearbyTab:!1}),c)).logo&&"/"===c.logo[0]&&(c.logo=c.logo.slice(1)),this.designConfiguration=c,this.config={id:this.id,name:this.name,defaultMetroId:this.defaultMetroId,managerName:this.managerName,defaultLocaleId:this.defaultLocaleId,androidAppDeepLink:this.androidAppDeepLink,iOsAppDeepLink:this.iOsAppDeepLink,appItineraryDeepLink:this.appItineraryDeepLink,latLng:this.latLng,logo:this.logo,ticketsUrl:this.ticketsUrl,designConfiguration:this.designConfiguration,apiKey:d,ogImage:u,mapZoomLevel:p,fakePhoneTypeHeader:h,onelinkUrl:m,deeplinkSchema:g}}}o.MoovitWeb=new o(4480,"Moovit Web",121,"MoovitWeb","en","",0,0,""),o.MoovitSeo=new o(4908,"SEO landing pages",121,"MoovitSeo","en","",0,0,"");var a=n(16438),s=n(2316);let l=(()=>{class e{constructor(e){this.injectedCustomer=e,this.MoovitWeb=new o(4480,"Moovit Web",r.rq,"MoovitWeb","en","",0,0,"",{enableLiveDirections:!0,disableMeta:!1}),this.MoovitSeo=new o(4908,"SEO landing pages",r.rq,"MoovitSeo","en","",0,0,"",{hideCookieBar:!0})}getInjectedCustomer(){return this.injectedCustomer?this.injectedCustomer:this.getLocalCustomerById(r.fn)}getLocalCustomerById(e){return e===this.MoovitSeo.id?this.MoovitSeo:this.MoovitWeb}getImagePath(e,t){return e&&e.designConfiguration&&e.designConfiguration.imagesToReplace&&e.designConfiguration.imagesToReplace[t]?e.designConfiguration.imagesToReplace[t]:t}getTranslationKey(e,t){return e&&e.designConfiguration&&e.designConfiguration.translationKeysToReplace&&e.designConfiguration.translationKeysToReplace[t]?e.designConfiguration.translationKeysToReplace[t]:t}getDefaultSubTabId(e){var t;const n=null===(t=e.designConfiguration)||void 0===t?void 0:t.primaryTabOrder;return n?a.Yb[n[0]]:a.zA.TRIPPLAN_DIRECTIONS}isMoovitCustomer(e){return(e=Number(e))===this.MoovitWeb.id||e===this.MoovitSeo.id}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(i.L7,8))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},803:function(e,t,n){"use strict";n.d(t,{J:function(){return T}});var i=n(3786),r=n(99528),o=n(55754),a=n(17184),s=n(2281),l=n(87100),c=n(13691),d=n(43049);function u(e,t){return e.origin&&e.destination?`${e.origin}${t?"\u200e\u2190\u200f":"\u200e\u2192"}${e.destination}`:e.destination}var p=n(31234),h=n(83486),m=n(2316),g=n(32066),f=n(26365),v=n(60600),y=n(2339),b=n(21532),_=n(27091);let T=(()=>{class e{constructor(e,t,n,i,r,o){this.imageService=e,this.metroService=t,this.alertService=n,this.translate=i,this.lineTemplateService=r,this.stopService=o}convertMVSearchResponseItem2TripPlanLocation(e){return(0,i.mG)(this,void 0,void 0,function*(){let t=null,n=[],a="";return e.title&&(a=e.title),e.subTitle&&e.subTitle.length>0&&(n=yield Promise.all(e.subTitle.map(e=>(0,i.mG)(this,void 0,void 0,function*(){if(e.image){const t=e.image.parameters||[];return{data:yield this.imageService.getImageHTML(e.image.imageId,[null,...t],void 0,a),isImage:!0}}return{data:e.text,isImage:!1}}))),e.type==r.pc.STREET&&(n=n.filter(e=>!1===e.isImage),a=this.addSubtitleToFullName(a,n))),e.image&&e.image.imageId&&(t=yield this.imageService.getImageHTML(e.image.imageId,e.image.parameters,void 0,e.title)),t||(t=yield this.imageService.getImageHTML(this.imageService.GENERAL_LOCATION_IMAGE_ID,void 0,void 0,e.title)),{id:e.id,uid:e.uid||null,name:e.title||a,address:n,fullName:a,latlng:e.latLon?o._.fromMvLatLon(e.latLon):null,type:e.type?e.type.toString():null,imageHtml:t,inaccurateSearchTerm:e.inaccurateLatLon?a:null}})}addSubtitleToFullName(e,t){return this.metroService.isGoogleLocationSearch()?e+=`, ${t[t.length-1].data}`:e+=(e.length>0?", ":"")+t.map(e=>e.data).join(", "),e}convertMVTripPlannerToTodBanner(e,t){const{itinerary:n,todBanner:i}=e;return n?this.convertMVTripPlannerItineraryToTodSuggestedRoute(n,t):(null==i?void 0:i.messageTitle)||(null==i?void 0:i.messageSubtitle)?this.convertTodBannerToInactiveCell(i,t):this.convertTodBannerToFutureSuggestedRoute(i,t)}convertMVTripPlannerItineraryToTodSuggestedRoute(e,t){var n,i,r;const{sectionId:o,guid:a,legs:s}=e,{approxWaitingSecFromOrdering:c,taxiId:d,waitAtLocation:u,taxiPrice:p,customParameters:m}=null===(n=s.find(e=>e.waitToTaxiLeg))||void 0===n?void 0:n.waitToTaxiLeg,g=null===(i=null==m?void 0:m.find(e=>"tod_provider_id"===e.key))||void 0===i?void 0:i.value,f=Number(null===(r=null==m?void 0:m.find(e=>"time"===e.key))||void 0===r?void 0:r.value);return{sectionId:o,times:{approxWaitingSecFromOrdering:c,endTime:this.getLegTime(s[s.length-1]).endTime-this.getLegTime(s[0]).startTime+f},taxiId:d,providerCustomerId:g,price:p,itineraryGuid:a,waitAtLocation:null==u?void 0:u.caption,optionNumber:t,bannerType:h.Zf.ONLINE,durationMinutes:(0,l.f)(this.getLegTime(s[0]).startTime,this.getLegTime(s[s.length-1]).endTime)}}convertTodBannerToFutureSuggestedRoute(e,t){const{sectionId:n,approxPickupTime:i,taxiId:r,providerCustomerId:o,price:a,bannerId:s,approxArrivalTime:c}=e;return{sectionId:n,times:{approxPickupTime:i,endTime:c},taxiId:r,providerCustomerId:o,price:a,itineraryGuid:s,waitAtLocation:"",bannerType:h.Zf.OFFLINE,optionNumber:t,durationMinutes:i&&c?(0,l.f)(i,c):void 0}}convertTodBannerToInactiveCell(e,t){const{sectionId:n,taxiId:i,providerCustomerId:r,bannerId:o,messageActionUrl:a,messageSubtitle:s,messageTitle:l,messageActionText:c}=e;return{sectionId:n,taxiId:i,providerCustomerId:r,title:l,subtitle:s,action:{text:c,url:a},itineraryGuid:o,optionNumber:t,bannerType:h.Zf.InactiveCell}}convertMVTripPlannerItineraryToSuggestedRoute(e,t,n,r,o){return(0,i.mG)(this,void 0,void 0,function*(){const i=this.fillLinesMetaData(r),a=this.fillStopsMetaData(r),s=r.lineGroupSummaryList?this.convertLinesSummaries(r.lineGroupSummaryList,1==o.metroAreaId,(0,l.i7)(),o.timeZoneOffset,void 0,void 0,void 0,void 0,void 0,i):[],c=this.getLegTime(n.legs[0]).startTime,d=this.getLegTime(n.legs[n.legs.length-1]).endTime;return{sectionId:n.sectionId,itineraryGuid:n.guid,durationMinutes:(0,l.f)(c,d),startTime:(0,l.Bo)(c),endTime:(0,l.Bo)(d),from:Object.assign({},e),to:Object.assign({},t),legs:n.legs,steps:yield this.getSectionedRouteSteps(e,t,n.legs,r,i,s,o.bicycleProviders),isRelevantForRealTime:n.relevantForRealtime,response:{itinerary:null,supplementalData:r},extra:this.getRouteExtra(n.legs,a),hasNext:n.hasNext,hasPrev:n.hasPrev,isAccessible:n.isAccessible}})}uniqArrivalTimes(e){const t=new Set,n=[];return e.forEach(e=>{const i=e.relativeRealTimeSpanSeconds||e.relativeStaticTimeSpanSeconds||0;t.has(i)||(t.add(i),n.push(e))}),n}convertMVSimilarItineraryResponseBySectionToSuggestedRoute(e,t,n){var r,o,a,s;return(0,i.mG)(this,void 0,void 0,function*(){const i=this.fillLinesMetaData(t.response.supplementalData),d=this.fillStopsMetaData(t.response.supplementalData),u=this.convertLinesSummaries(t.response.supplementalData.lineGroupSummaryList,1==n.metroAreaId,(0,l.i7)(),n.timeZoneOffset,void 0,void 0,void 0,void 0,void 0,i),p=null===(r=e.legs[0])||void 0===r?void 0:r.time.startTime,h=null===(o=e.legs[e.legs.length-1])||void 0===o?void 0:o.time.endTime,m=[];for(let n=0;n<t.legs.length;n++){const i=(0,c.kI)(t.legs[n]);this.setLegTime(i,e.legs[n].time),e.legs[n].futureDepartureTimes&&(null===(s=null===(a=i.waitToMultiLineLeg)||void 0===a?void 0:a.alternatives)||void 0===s?void 0:s.length)>0&&(e.legs[n].futureDepartureTimes.forEach(t=>i.waitToMultiLineLeg.alternatives[0].futureDepartureTimes.futureDepartures.push({relativeStaticTimeSpanSeconds:(t-e.legs[n].time.startTime)/1e3})),i.waitToMultiLineLeg.alternatives[0].futureDepartureTimes.futureDepartures=this.uniqArrivalTimes(i.waitToMultiLineLeg.alternatives[0].futureDepartureTimes.futureDepartures)),m.push(i)}const g=yield this.getSectionedRouteSteps(t.from,t.to,m,t.response.supplementalData,i,u,n.bicycleProviders);return g.forEach((e,n)=>{e.upcomingArrivals=t.steps[n].upcomingArrivals}),{sectionId:t.sectionId,itineraryGuid:t.itineraryGuid,durationMinutes:(0,l.f)(p,h),startTime:(0,l.Bo)(p),endTime:(0,l.Bo)(h),from:t.from,to:t.to,legs:m,steps:g,isRelevantForRealTime:t.isRelevantForRealTime,response:t.response,hasNext:e.hasNext,hasPrev:e.hasPrev,extra:this.getRouteExtra(m,d),isAccessible:t.isAccessible}})}getRouteExtra(e,t){let n,i;for(let r=0;r<e.length;r++){const t=e[r];if(t.lineWithAlternarivesLeg&&!n&&(n=t.lineWithAlternarivesLeg.alternativeLines[t.lineWithAlternarivesLeg.primaryAlternativeIndex]),n)break}for(let r=0;r<e.length&&(i=e[r].waitToMultiLineLeg&&!i,!i);r++);if(n||(n=this.getLeg(e[0])),n&&i){const e=t[n.stopSequenceIds[0]];if(!e)return null;const i=e?e.stopName:"";return{startFrom:{param1:i,firstStopName:i},startFromTranslateKey:"suggest_routes_metadata"}}return null}legData(e){const t=Object.keys(e).find(t=>e[t]);return e[t]}titlesForGoToStep(e,t,n,i){var r,o,a,s,l;let c={title:null,subTitle:null};if(i)if(i.pathwayWalkLeg)c=this.setTitleByPasswayIndex(t,i.pathwayWalkLeg.stopId,i.pathwayWalkLeg.originPathwayId,!!n.lineWithAlternarivesLeg);else if(i.waitToMultiLineLeg)c=this.setTitlesByStopId(t,i.waitToMultiLineLeg.waitAtStopId);else if(i.lineWithAlternarivesLeg)c=this.setTitlesByStopId(t,i.lineWithAlternarivesLeg.alternativeLines[i.lineWithAlternarivesLeg.primaryAlternativeIndex].stopSequenceIds[0]);else if(n.lineWithAlternarivesLeg){const e=n.lineWithAlternarivesLeg.alternativeLines[n.lineWithAlternarivesLeg.primaryAlternativeIndex];c=this.setTitlesByStopId(t,e.stopSequenceIds[e.stopSequenceIds.length-1])}else c.title=(null===(a=null===(o=null===(r=n.walkLeg)||void 0===r?void 0:r.journey)||void 0===o?void 0:o.dest)||void 0===a?void 0:a.caption)?n.walkLeg.journey.dest.caption:null===(l=null===(s=this.legData(n).journey)||void 0===s?void 0:s.dest)||void 0===l?void 0:l.caption;else c.title=null==e?void 0:e.name,c.subTitle=null==e?void 0:e.address;return{title:c.title||"",subTitle:c.subTitle||[{data:"",isImage:!1}]}}getSectionedRouteSteps(e,t,n,o,s,c,d){return(0,i.mG)(this,void 0,void 0,function*(){const i=[],u={};let h=!1;const m=[],g=[],f={},v={};if(o.mVStopSyncedMetaDataList)for(const e of o.mVStopSyncedMetaDataList)u[e.stopId]=e;const y=n.length;let b=this.getLegTime(n[0]).startTime,_=null;for(let o=0;o<y;o++){let T,S,x,w,k=[{data:"",isImage:!1}];const M=n[o],L=o<y-1?n[o+1]:null,A=this.convertToLeg(M,u),I=this.getLegType(M),E=this.getSectionedLegImageMetaData(s,u,M,L,d),C=this.getSectionedLegDescription(s,M);if(!h){w=e&&e.name?e.name:"",k=e&&e.address?e.address:[{data:"",isImage:!1}];const t={leaveAt:this.getLegTime(n[0]).startTime,legImageMetaData:null,legDescription:C};i.push({type:a.cF.StartFrom,typeDescription:"tripplan_itinerary_startfrom",typeIconUrl:null,legType:a.kJ.StartFrom,title:null==e?void 0:e.name,subTitle:(null==e?void 0:e.address)||[{data:"",isImage:!1}],extra:t,isFirstInMultiLeg:!0,isLastInMultiLeg:null==L||!(L.waitToMultiLineLeg||L.bicycleRentalLeg),isRealTime:this.getLegTime(M).isRealTime,leg:A}),h=!0}const D={alerts:{entities:[]},leg:A,legType:I};if(M.pathwayWalkLeg){T=a.cF.WalkToPath,S="tripplan_itinerary_walk",x="/images/routeTypes/walking.svg";const e=this.setTitleByPasswayIndex(u,M.pathwayWalkLeg.stopId,M.pathwayWalkLeg.originPathwayId,!1);w=e.title||w,k=e.subTitle||k,i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:w,subTitle:k,extra:{legImageMetaData:E},isFirstInMultiLeg:!1,isLastInMultiLeg:!0,isRealTime:this.getLegTime(M).isRealTime},D))}else if(M.bicycleRentalLeg){T=a.cF.RentalBikeRideTo,S="tripplan_itinerary_bike",x="/images/routeTypes/walking.svg";const{originNearbyBicycleStopIds:e,destNearbyBicycleStopIds:n,journey:r,cyclingInstructions:o,shape:s,time:c}=M.bicycleRentalLeg,p=this.titlesForGoToStep(t,u,M,L),h={distance:this.getDistance(s.distanceInMeters),distanceInMeters:s.distanceInMeters,duration:(0,l.f)(c.startTime,c.endTime),instructions:o.map(this.expandWalkingInstruction),legImageMetaData:E,legDescription:C,originNearbyBicycleStopIds:[r.origin.id,...e],destNearbyBicycleStopIds:[r.dest.id,...n],stopImageOnStepHtmlPromise:this.bicycleRentalLegStepImagePromise(M.bicycleRentalLeg.journey.origin.id,!0,d)};i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:p.title,subTitle:p.subTitle,extra:h,isFirstInMultiLeg:!0,isLastInMultiLeg:!1,isRealTime:this.getLegTime(M).isRealTime},D))}else if(M.bicycleLeg){T=a.cF.BikeRideTo,S="tripplan_itinerary_bike",x="/images/routeTypes/walking.svg";const e=this.titlesForGoToStep(t,u,M,L),n={distance:this.getDistance(M.bicycleLeg.shape.distanceInMeters),distanceInMeters:M.bicycleLeg.shape.distanceInMeters,duration:(0,l.f)(M.bicycleLeg.time.startTime,M.bicycleLeg.time.endTime),instructions:M.bicycleLeg.cyclingInstructions.map(this.expandWalkingInstruction),legImageMetaData:E,legDescription:C};i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:e.title,subTitle:e.subTitle,extra:n,isFirstInMultiLeg:!1,isLastInMultiLeg:!0,isRealTime:this.getLegTime(M).isRealTime},D))}else if(M.walkLeg){T=a.cF.WalkTo,S="tripplan_itinerary_walk",x="/images/routeTypes/walking.svg";const e=this.titlesForGoToStep(t,u,M,L),n={distance:this.getDistance(M.walkLeg.shape.distanceInMeters),distanceInMeters:M.walkLeg.shape.distanceInMeters,duration:(0,l.f)(M.walkLeg.time.startTime,M.walkLeg.time.endTime),instructions:M.walkLeg.walkingInstructoins.map(this.expandWalkingInstruction),legImageMetaData:E,legDescription:C};i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:e.title,subTitle:e.subTitle,extra:n,isFirstInMultiLeg:!1,isLastInMultiLeg:!0,isRealTime:this.getLegTime(M).isRealTime},D))}else if(M.waitToMultiLineLeg){T=a.cF.WaitFor,S="tripplan_itinerary_wait",x="/images/time.svg";const e=M.waitToMultiLineLeg.alternatives[M.waitToMultiLineLeg.primaryAlternativeIndex],t=i.length;M.waitToMultiLineLeg.waitAtStopId&&(m.push(M.waitToMultiLineLeg.waitAtStopId),v[M.waitToMultiLineLeg.waitAtStopId]=t),M.waitToMultiLineLeg.alternatives.forEach(e=>{g.push(e.waitToLineId),f[e.waitToLineId]=t});const n=M.waitToMultiLineLeg.alternatives.map(e=>c[e.waitToLineId].getTitles(r.vU.StopDetail));let o;w="",k[0]={data:u[M.waitToMultiLineLeg.waitAtStopId].stopName,isImage:!1},k[1]={data:u[M.waitToMultiLineLeg.departOnStopId].stopName,isImage:!1},o=e.time.isRealTime?(0,l.f)((0,l.hg)(new Date),e.time.endTime)-1:(0,l.f)(e.time.startTime,e.time.endTime);const d={};u[M.waitToMultiLineLeg.waitAtStopId].platformLines.forEach(e=>{e.lineIds.forEach(t=>{d[t]=e.name})});const p={startTime:{param1:(0,l.xH)(e.time.startTime)},endTime:{param1:(0,l.xH)(e.time.endTime)},duration:o,arrivals:this.getSectionedLegNextArrivals(s,c,b,M,L),legImageMetaData:E,legDescription:C,platforms:d,primaryLineId:e.waitToLineId};i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:w,subTitle:k,extra:p,additionalArrivals:p.arrivals,isFirstInMultiLeg:!0,isLastInMultiLeg:!1,isRealTime:this.getLegTime(M).isRealTime,linesPresentation:n},D))}else if(M.lineWithAlternarivesLeg){T=a.cF.RideTo,S="tripplan_itinerary_ride",x=(0,p.nw)(this.getLegType(M));const e=M.lineWithAlternarivesLeg.alternativeLines[M.lineWithAlternarivesLeg.primaryAlternativeIndex];E.lineMetaData.summaryImageHtml=_.extra.legImageMetaData.lineMetaData.summaryImageHtml;let n=null;const o=M.lineWithAlternarivesLeg.alternativeLines.map((e,t)=>{const i={linePresentation:c[e.lineId].getTitles(r.vU.Itinerary),lineTitle:s[e.lineId].title,lineId:s[e.lineId].id,lineColor:s[e.lineId].color,stations:e.stopSequenceIds.map(e=>u[e]?u[e].stopName:""),duration:(0,l.f)(e.time.startTime,e.time.endTime)};return t==M.lineWithAlternarivesLeg.primaryAlternativeIndex&&(n=i),i}),d=this.titlesForGoToStep(t,u,M,L),h={lines:o,selectedLine:n,legImageMetaData:E,legDescription:C},g=i.length;e.stopSequenceIds.length>1&&(m.push(e.stopSequenceIds[e.stopSequenceIds.length-1]),v[e.stopSequenceIds[e.stopSequenceIds.length-1]]=g),i.push(Object.assign({type:T,typeDescription:S,typeIconUrl:x,title:d.title,subTitle:d.subTitle,extra:h,isFirstInMultiLeg:!1,isLastInMultiLeg:!L||!!L.waitToMultiLineLeg,isRealTime:this.getLegTime(M).isRealTime},D))}b=this.getLegTime(M).endTime,_=i[i.length-1]}return yield this.mergeAlertsIntoResult(m,g,v,f,i),i.forEach((e,t)=>{e.index=t}),i})}mergeAlertsIntoResult(e,t,n,o,a){return(0,i.mG)(this,void 0,void 0,function*(){if(e.length>0||t.length>0){const i=yield this.alertService.getRouteAlerts(e,t);if(i&&i.data)for(const e of i.data){const t={title:e.serviceAlertEffect,entityIdentifier:e.entityIdentidier};e.entityIdentidier.entityType==r.$1.Stop?null!=n[e.entityIdentidier.id]&&a[n[e.entityIdentidier.id]].alerts.entities.push(t):e.entityIdentidier.entityType==r.$1.Line&&null!=o[e.entityIdentidier.id]&&a[o[e.entityIdentidier.id]].alerts.entities.push(t)}}})}setTitlesByStopId(e,t){const n={title:"",subTitle:[{data:"",isImage:!1}]};if(e[t]){n.title=e[t].stopName;const i=e[t].stopCode;i&&(n.subTitle[0].data=this.translate.instant("web_trip_plan_station_id",{param1:i}))}return n}fillLinesMetaData(e){const t={};if(!(null==e?void 0:e.lineGroupSummaryList))return t;let n,i=null,r=null,o=null;for(const a of e.lineGroupSummaryList){const e=a.lineNumber||a.caption1||a.caption2,s=this.metroService.getImageIndexForAgency(a.agencyId),l=this.metroService.getAgencyImageId(a.agencyId),c=4;if(null!==s){if(o=[null,(0,p.N0)(a.color),a.lineNumber],n=o.slice(0),a.imageRefSet&&a.imageRefSet.images)for(const e of a.imageRefSet.images)e.index==s&&(i=e.imageRef),e.index==c&&(r=e.imageRef);if(a.innerImageIds&&a.innerImageIds.images)for(const e of a.innerImageIds.images)e.index==s&&o.push(e.image.toString()),e.index==c&&n.push(e.image.toString())}r&&l&&n.push(l.toString());for(const d of a.lineSummaries){const s={id:r,params:n},l={id:i,params:o};t[d.lineId]={id:d.lineId,title:e,subTitle:d.destination,color:(0,p.vq)(a.color),summaryImageData:s,stepImageData:l,summaryImageHtmlPromise:this.imageService.getImageHTML(s.id,s.params,void 0,e),stepImageHtmlPromises:[this.imageService.getImageHTML(l.id,l.params,!0,l.params[2])]}}}return t}fillStopsMetaData(e){const t={};return(null==e?void 0:e.mVStopSyncedMetaDataList)&&e.mVStopSyncedMetaDataList.map(e=>{const n=e;if(e.image&&void 0!==e.image.imageId&&(n.stopImageConfig={id:e.image.imageId===d.nM.STOP_MULTI_AGENCY_MVF?d.nM.UI_BUS:e.image.imageId,params:null}),e.image.imageId===d.nM.STOP_MULTI_AGENCY_MVF)n.stopImageOnMapHtmlPromise=this.imageService.getStopsImageMapHtml(e.image.parameters);else if(n.imageRefSet&&n.imageRefSet.images&&n.imageRefSet.images[0]){const e=n.imageRefSet.images[0].imageRef;n.stopImageOnMapHtmlPromise=this.imageService.getImageHTML(e.imageId,e.parameters,void 0,n.stopName)}t[e.stopId]=n}),t}setTitleByPasswayIndex(e,t,n,i){const r=e[t],o=i?"pathway_guidance_exit":"pathway_guidance_entrance",a={title:null,subTitle:null};return r&&(r.mvPathways.forEach(e=>{e.pathwayId===n&&(a.subTitle=[{data:this.translate.instant(o,{param1:e.name}),isImage:!1}])}),a.title=r.stopName),a}convertToLeg(e,t,n){let i=n||0,r=[],a=0;e.lineWithAlternarivesLeg&&(r=e.lineWithAlternarivesLeg.alternativeLines,null==n?(a=e.lineWithAlternarivesLeg.primaryAlternativeIndex,i=r[a].lineId):(i=n,a=r.findIndex(e=>e.lineId===n))),e.waitToMultiLineLeg&&(r=e.waitToMultiLineLeg.alternatives,null==n?(a=e.waitToMultiLineLeg.primaryAlternativeIndex,i=r[a].waitToLineId):(i=n,a=r.findIndex(e=>e.waitToLineId===n))),-1===a&&(a=0);let s=null,l=null;e.pathwayWalkLeg&&t[e.pathwayWalkLeg.stopId]&&(s=t[e.pathwayWalkLeg.stopId].mvPathways.find(t=>t.pathwayId==e.pathwayWalkLeg.originPathwayId),l=t[e.pathwayWalkLeg.stopId].mvPathways.find(t=>t.pathwayId==e.pathwayWalkLeg.destinationPathwayId));let c=null;e.pathwayWalkLeg?c=[e.pathwayWalkLeg.stopId]:e.lineWithAlternarivesLeg?c=e.lineWithAlternarivesLeg.alternativeLines[e.lineWithAlternarivesLeg.primaryAlternativeIndex].stopSequenceIds:e.waitToMultiLineLeg&&(c=[e.waitToMultiLineLeg.waitAtStopId]);const d=this.getShape(e,a);return{originLeg:e,lineId:i,altLineIds:r,stopIds:c,price:e.taxiLeg?e.taxiLeg.taxiPrice:null,encodedPolyline:d?d.polyline:"",distanceMeters:d?d.distanceInMeters:0,rideInfo:e.carpoolRideLeg?{driver:e.carpoolRideLeg.driver,ride:e.carpoolRideLeg.ride}:null,walkingSteps:null,waitingSec:e.waitToMultiLineLeg?Math.ceil((e.waitToMultiLineLeg.time.endTime-e.waitToMultiLineLeg.time.startTime)/60):0,metaData:null,points:s||l?{originPathwayLocation:s?o._.fromMvLatLon(s.location):null,destinationPathwayLocation:l?o._.fromMvLatLon(l.location):null}:null}}getShape(e,t=0){const n=this.getLeg(e);return n.shape?n.shape:n.lineLeg&&n.lineLeg.shape?n.lineLeg.shape:n.alternativeLines&&n.alternativeLines[t]&&n.alternativeLines[t].shape?n.alternativeLines[t].shape:null}getTitlesForLineSummary(e,t,n){let i;return n&&(i=n.summaryImageHtmlPromise),n=>{const{title:r,subTitle:o}=this.lineTemplateService.getTemplate(n,e,t);return{title:r,subTitle:o,imageHtmlPromise:i}}}convertLinesSummaries(e,t,n,i,r,o,a,s,l,p){const h={},m={};e.forEach(e=>{e.lineSummaries.forEach(c=>{let g,f,v=null;if(r){const e=r.find(e=>e.lineId==c.lineId);e&&(v=this.getLineOptionDisplay(e,n,i,a,o,s,c.destination))}g={getTitles:this.getTitlesForLineSummary(e,c,p&&p[c.lineId]),lineTitle:u(c,t),lineId:c.lineId,origin:c.origin,destination:c.destination,lineOptions:v,type:d.SP.LINE};const y=l?l.find(e=>e.subGroup.subGroupId==c.subGroupId):null;if(null!=c.subGroupId&&y)if(m[c.subGroupId])m[c.subGroupId].lines.push(g);else{const{name:t,subGroupId:n}=y.subGroup;f={getTitles:this.getTitlesForLineSummary(e,c,p&&p[n]),subgroupId:n,title:t,lines:[g],lineOptions:[{lineId:n,patternId:null,stopArrivals:null,stops:y.stopIdsSequence.map(e=>{const t=o.find(t=>t.stopId==e);return{id:t.stopId,location:t.stopLocation,name:t.stopName}}),shape:null}],lineTitle:t,lineId:n,type:d.SP.SUBGROUP},m[c.subGroupId]=f,h[c.subGroupId]||(h[c.subGroupId]=f)}else h[g.lineId]||(h[g.lineId]=g)})});for(const u in h){const e=h[u];if(e.type==d.SP.SUBGROUP){let t=null,n=null,i=0;const r={};let o=[];e.lines.forEach(e=>{e.lineOptions&&e.lineOptions.length>0&&(o=o.concat(e.lineOptions))}),this.recountStopIndex(e.lineOptions[0].stops,o),o.forEach(o=>{for(const e in o.stopArrivals)r[e]||(r[e]=[]),r[e]=r[e].concat(o.stopArrivals[e]);!t&&o.shape&&o.stops.length==e.lineOptions[0].stops.length&&(t=o.shape),o.stops.length>i&&(n=o.shape,i=o.stops.length)});for(const e in r)r[e].sort((0,c.Mr)("arrivalTime"));h[u].lineOptions[0].shape=t||n,h[u].lineOptions.forEach(e=>{e.stopArrivals=[]}),h[u].lineOptions[0].stopArrivals=r}}return h}recountStopIndex(e,t){const n=(0,c.Nr)(e,"id",(e,t)=>t);t.forEach(e=>{n.forEach((t,n)=>{const i=e.stopArrivals[n];if(i){i.sort((e,t)=>e.stopIndex-t.stopIndex);const r=(0,c.Nr)(e.stopArrivals[n],"stopIndex");let o=0;r.forEach(e=>{e.forEach(e=>e.stopIndex=t[o]),t[o+1]&&o++})}})})}mapTripGroupToPattern(e){const t={};return e.tripIntervals.forEach(n=>{t[n.tripPatternId]||(t[n.tripPatternId]=[]);const i=e.tripGroups.filter(e=>e.tripIntervalsId==n.tripIntervalsId);i.forEach(e=>{e.intervals=n.intervals}),t[n.tripPatternId].push(...i)}),t}getLineStopsDisplayDataForPattern(e,t){const n=[];for(let i=0;i<e.length;i++){const r=t.find(t=>t.stopId==e[i]);r&&n.push({id:r.stopId,location:r.stopLocation,name:r.stopName})}return n}getPatternById(e,t){return e.find(e=>e.tripPatternId.toString()===t)}getLineOptionDisplay(e,t,n,i,r,o,a){const d=[],u=s("1970-01-01T00:00:00"),p=this.mapTripGroupToPattern(e);for(const s in p){const n=p[s],h={},m=this.getPatternById(i,s);n.forEach(e=>{const n=e.intervals,i=u.clone().add(e.localMidnightDaysSinceEpoch,"days");for(let r=0;r<e.departures.length;r++)m.stopIds.forEach((o,s)=>{const c=i.clone().add(e.departures[r]+(0==s?0:n[s-1]),"seconds");(0,l.XP)(c,u,t)&&(h[o]||(h[o]=[]),h[o].push({stopIndex:s,arrivalTime:c.unix(),lineDestination:a}))})});for(const e in h)h[e]&&(h[e]=(0,c.MO)(h[e],["arrivalTime","stopIndex"]),h[e]=h[e].sort((0,c.Mr)("arrivalTime")));const g=this.getLineStopsDisplayDataForPattern(m.stopIds,r);d.push({lineId:e.lineId,stopArrivals:h,stops:g,shape:n[0]?o.find(e=>e.shapeId==n[0].tripShapeId):null,patternId:m.tripPatternId})}return d}getLegTime(e){return this.findLegWithTime(e).time}setLegTime(e,t){this.findLegWithTime(e).time=t}findLegWithTime(e){for(const t in e)if(e[t]){if(e[t].time)return e[t];if(e[t].lineLeg&&e[t].lineLeg.time)return e[t].lineLeg;if(e[t].alternativeLines&&e[t].alternativeLines[e[t].primaryAlternativeIndex].time)return e[t].alternativeLines[e[t].primaryAlternativeIndex]}}searchTypeToLocationType(e){switch(e){case r.pc.CITY:return r.He.City;case r.pc.GEOCODE:return r.He.Geocoder;case r.pc.SITE:return r.He.Site;case r.pc.STOP:return r.He.Stop;case r.pc.STREET:return r.He.Street}return r.He.LatLon}routeTypeToTripPlanPref(e){switch(e){case a.cd.BestRoute:return r.Fl.Fastest;case a.cd.LeastTransfers:return r.Fl.LeastTransfers;case a.cd.LeastWalking:return r.Fl.LaestWalking}return r.Fl.Fastest}timeSelectorToTimeType(e){return e.refPoint==a.IV.Arrive?r.Tq.Arrival:e.refPoint==a.IV.Last?r.Tq.Last:r.Tq.Departure}dayAndTimeToDateTime(e,t){const n=e.time;return(t?s().startOf("day").add(n.timeOfDay,"milliseconds").add(e.day.value,"days"):s(e.day.date).add(n.timeOfDay,"milliseconds")).toDate()}serverTimeOf(e){return e.getTime()-this.getOffsetInMS(e)}getOffsetInMS(e){return 60*e.getTimezoneOffset()*1e3}getSectionedLegImageMetaData(e,t,n,i,r){var o,s,d;let u,p,h=null;(n.walkLeg||n.bicycleLeg||n.bicycleRentalLeg)&&i&&(i.waitToMultiLineLeg||i.pathwayWalkLeg)?i.waitToMultiLineLeg?u=i.waitToMultiLineLeg.waitAtStopId:i.pathwayWalkLeg&&(u=i.pathwayWalkLeg.stopId):n.waitToMultiLineLeg&&(h=[],n.waitToMultiLineLeg.alternatives.forEach((e,t)=>{t==n.waitToMultiLineLeg.primaryAlternativeIndex?p=e.waitToLineId:h.push(e.waitToLineId)}),u=n.waitToMultiLineLeg.waitAtStopId),n.lineWithAlternarivesLeg&&(h=[],n.lineWithAlternarivesLeg.alternativeLines.forEach((e,t)=>{t==n.lineWithAlternarivesLeg.primaryAlternativeIndex?p=e.lineId:h.push(e.lineId)}),u=n.lineWithAlternarivesLeg.alternativeLines[n.lineWithAlternarivesLeg.primaryAlternativeIndex].stopSequenceIds[0]);let m="",g=[],f="",v=null;p&&e[p]&&(v=e[p],e[p].title&&(m=e[p].title),e[p].color&&(f=e[p].color));let y=null;if(v&&(y=v,y.summaryImageData=(0,c.kI)(y.summaryImageData),y.stepImageData=(0,c.kI)(y.stepImageData),g=[e[p].title,...h.map(t=>e[t].title)],g=g.filter((e,t,n)=>n.indexOf(e)===t),g.sort(c.oB),h&&h.length>0&&(0,a.jx)(y.summaryImageData)&&(y.summaryImageData.params[2]=g.join("/")),null===(d=null===(s=null===(o=n.waitToMultiLineLeg)||void 0===o?void 0:o.multiLinesImage)||void 0===s?void 0:s.parameters)||void 0===d?void 0:d.length)){isNaN(n.waitToMultiLineLeg.multiLinesImage.parameters[0])||(y.summaryImageHtmlPromise=this.imageService.getMultiLineMVF(n.waitToMultiLineLeg.multiLinesImage.parameters,!1,n.waitToMultiLineLeg.multiLinesImage.parameters[1]));const t={},i=n.waitToMultiLineLeg.alternatives.map(n=>{const i=e[n.waitToLineId],r=`${i.summaryImageData.params[3]}_${i.summaryImageData.params[1]}`;if(t[r])return null;{t[r]=!0;const e=i.summaryImageData.params.slice(0,4);return{id:i.summaryImageData.id,params:e}}});y.stepImageDataArray=i.filter(e=>e),y.stepImageHtmlPromises=y.stepImageDataArray.map(e=>this.imageService.getImageHTML(e.id,e.params,void 0,e.params[2]))}return{lineNumber:m,allPossibleLineNumbers:g,lineColor:f,walkingTime:n.walkLeg||n.pathwayWalkLeg||n.bicycleLeg||n.bicycleRentalLeg?(0,l.f)(this.getLegTime(n).startTime,this.getLegTime(n).endTime):0,lineMetaData:y,stopMetaData:this.legStopMetaData(u,t,n,i,r)}}legStopMetaData(e,t,n,i,r){var o,a;let s,l,c,d,u;if(n.walkLeg&&(null==i?void 0:i.bicycleRentalLeg)){u=this.bicycleRentalLegStepImagePromise(i.bicycleRentalLeg.journey.origin.id,!0,r);const{caption:e,latlon:t}=null===(o=i.bicycleRentalLeg.journey)||void 0===o?void 0:o.origin;c=e,d=t}else if(n.bicycleRentalLeg){u=this.bicycleRentalLegStepImagePromise(n.bicycleRentalLeg.journey.dest.id,!1,r);const{caption:e,latlon:t}=null===(a=n.bicycleRentalLeg.journey)||void 0===a?void 0:a.dest;c=e,d=t}else{if(!e||!t[e])return null;s=t[e].stopImageConfig,u=this.imageService.getImageHTML(t[e].stopImageConfig.id,t[e].stopImageConfig.params),l=t[e].stopImageOnMapHtmlPromise,c=t[e].stopName,d=t[e].stopLocation}return{stopImageConfig:s,stopImageOnMapHtmlPromise:l,stopName:c,stopLocation:d,stopId:e,stopImageOnStepHtmlPromise:u}}bicycleRentalLegStepImagePromise(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){let i="000000",r="ffffff";if(t){const t=(yield this.stopService.getBicycleStopById([e]))[0];if(t){const e=n.find(e=>e.providerId===t.providerId);e&&(i=null!=e.primaryColor?(0,p.N0)(e.primaryColor):i,r=null!=e.secondaryColor?(0,p.N0)(e.secondaryColor):r)}}return this.bicycleStopImageHtmlPromise(!1,t?-115:-127,!1,i,r,"","",r)})}getSectionedLegDescription(e,t){let n=[];if(t.waitToMultiLineLeg&&(n=t.waitToMultiLineLeg.alternatives.map(e=>e.waitToLineId)),t.lineWithAlternarivesLeg&&(n=t.lineWithAlternarivesLeg.alternativeLines.map(e=>e.lineId)),n.length>0){let t=[];return n.forEach(n=>{if(n&&e[n]){const i=e[n];t.push(`${i.title?i.title:""}${i.subTitle?i.title?` - ${i.subTitle}`:i.subTitle:""}`)}}),t=t.filter((e,t,n)=>n.indexOf(e)===t),t.sort(c.oB),{value:t.join(" / "),translateKey:null,translateParams:null}}return t.walkLeg||t.pathwayWalkLeg?{value:null,translateKey:"web_tripplan_itinerary_walk_single",translateParams:{param1:(0,l.f)(this.getLegTime(t).startTime,this.getLegTime(t).endTime)}}:t.bicycleLeg||t.bicycleRentalLeg?{value:null,translateKey:"tripplan_itinerary_bike_time",translateParams:{param1:(0,l.f)(this.getLegTime(t).startTime,this.getLegTime(t).endTime)}}:null}getLeg(e){for(const t in e)if(e[t])return e[t]}getLegType(e){return e.carpoolRideLeg?a.kJ.CarPoolRide:e.lineWithAlternarivesLeg?a.kJ.Bus:e.walkLeg?a.kJ.Walk:e.pathwayWalkLeg?a.kJ.WalkToPath:e.waitToTaxiLeg||e.waitToMultiLineLeg?a.kJ.WaitFor:e.taxiLeg?a.kJ.Taxi:e.bicycleLeg||e.bicycleRentalLeg?a.kJ.Bicycle:a.kJ.Bus}getDistance(e){return this.metroService.isImperialDistance()?(e*=1.094)<880?{distance_key:"units_yards_short",distance_number:{param1:(e<=10?10:10*Math.round(e/10)).toString()}}:{distance_key:"units_miles_short",distance_number:{param1:(e/1760).toFixed(2)}}:e<1e3?{distance_key:"units_meters_short",distance_number:{param1:(e<=10?10:10*Math.round(e/10)).toString()}}:{distance_key:"units_kilometers_short",distance_number:{param1:(e/1e3).toFixed(2)}}}getSectionedLegNextArrivals(e,t,n,i,o){let a=[];const c={};return o.lineWithAlternarivesLeg.alternativeLines.forEach(e=>{c[e.lineId]=e}),i.waitToMultiLineLeg&&i.waitToMultiLineLeg.alternatives.forEach(o=>{const d=1e3*s.utc(0).startOf("day").add(o.futureDepartureTimes.epochDay,"day").unix();o.futureDepartureTimes.futureDepartures.forEach(s=>{const u=d+1e3*(s.relativeRealTimeSpanSeconds||s.relativeStaticTimeSpanSeconds||0);if(u>=n){const n=c[o.waitToLineId],s=e[o.waitToLineId];a.push({linePresentation:t[o.waitToLineId].getTitles(r.vU.StopDetail),lineId:o.waitToLineId,lineTitle:t[o.waitToLineId].lineTitle,lineImageData:{id:s.stepImageData.id,params:s.stepImageData.params},lineStopsAmount:n.stopSequenceIds.length,lineDuration:(0,l.f)(n.time.startTime,n.time.endTime),stopId:i.waitToMultiLineLeg.waitAtStopId,departure:(0,l.Bo)(u),serviceAlert:o.serviceAlert})}})}),a=a.sort((e,t)=>e.departure>t.departure?1:e.departure<t.departure?-1:0),a}expandWalkingInstruction(e,t){let n="";if(e.direction.absolute)switch(e.direction.absolute){case MVAbsoluteDirection.North:n="direction_north";break;case MVAbsoluteDirection.Northeast:n="direction_northeast";break;case MVAbsoluteDirection.east:n="direction_east";break;case MVAbsoluteDirection.Southeast:n="direction_southeast";break;case MVAbsoluteDirection.South:n="direction_south";break;case MVAbsoluteDirection.Southwest:n="direction_southwest";break;case MVAbsoluteDirection.West:n="direction_west";break;case MVAbsoluteDirection.Northwest:n="direction_northwest"}else if(e.direction.relative)switch(e.direction.relative){case r.cF.Depart:n="direction_depart";break;case r.cF.HardLeft:n="direction_hard_left";break;case r.cF.Left:n="direction_left";break;case r.cF.SlightlyLeft:n="direction_slightly_left";break;case r.cF.Continue:n="direction_continue";break;case r.cF.SlightlyRight:n="direction_slightly_right";break;case r.cF.Right:n="direction_right";break;case r.cF.HardRight:n="direction_hard_right";break;case r.cF.CircleClockwise:n="direction_circle_clockwise";break;case r.cF.CircleCounterclockwise:n="direction_circle_counter_clockwise";break;case r.cF.Elevator:n="direction_elevator";break;case r.cF.UturnLeft:n="direction_uturn_left";break;case r.cF.UturnRight:n="direction_uturn_right"}return{instruction_key:n,instruction_param:e.streetName}}updateRealTimeInRoutes(e,t,n){e.forEach(e=>{const i=s().utcOffset(n).diff(s().utcOffset(n).startOf("day"),"seconds");s(e.startTime).diff(s().startOf("day"),"seconds"),e.steps.filter(e=>e.legType==a.kJ.WaitFor&&0!==e.leg.lineId).forEach((n,r)=>{const o=0==r,a=n.extra,s=t.filter(e=>{const t=n.leg.altLineIds.find(t=>e.lineArrivals.lineId==t.waitToLineId);return e.stopId==n.leg.stopIds[0]&&(e.lineArrivals.lineId==n.leg.lineId||t)}),c=s[0]?(0,l.Ic)(s[0].epochDay):0;let d=[];if(s.forEach(e=>{e.lineArrivals.arrivals.forEach(t=>{const n=Math.floor((t.relativeRealTimeSpanSeconds-(i+c))/60);d.push({lineId:e.lineArrivals.lineId,stopId:e.stopId,arrival:t,departureInMinutes:n>=0?n:0})})}),0==d.length)return o&&(e.isRelevantForRealTime=!1,e.extra.startFrom.param1=e.extra.startFrom.firstStopName,e.extra.startFromTranslateKey="suggest_routes_metadata"),n.isRealTime=!1,a.duration=null,void this.processRealtimeDepartures(n);d=d.sort((e,t)=>e.arrival.relativeRealTimeSpanSeconds-t.arrival.relativeRealTimeSpanSeconds),d=d.slice(0,3);let u=d.map(e=>e.departureInMinutes);if(u=u.filter((e,t,n)=>n.indexOf(e)===t),n.isRealTime=!1,a.duration=null,n.realTimeArrivals=d,0==u.length)return o&&this.setNoRTDataForRoute(e),n.isRealTime=!1,void(a.duration=null);if(1==u.length)return u[0]>=0?void this.setRTDataForRoute(e,n,u[0],o):void this.setNoRTDataForRoute(e);let p=!1;for(let e=0;e<u.length;e++)u[e]>=0&&u[e]<1&&(p?u.splice(e,1):(u[e]=this.translate.instant("action_now_lowercase"),p=!0));o&&(e.extra.startFrom.param1=`<i></i><span class="eta">${this.translate.instant("units_minutes_text",{param1:u.join(", ")})}</span>`,e.extra.startFrom.param2=e.extra.startFrom.firstStopName,e.extra.startFromTranslateKey=p?"suggest_routes_real_time_metadata_leaves":"suggest_routes_real_time_metadata"),n.isRealTime=!0,a.duration=u,this.processRealtimeDepartures(n)})})}setRTDataForRoute(e,t,n,i){let r="",o="";n>=1?(r=`${this.translate.instant("units_minutes_text",{param1:n})}`,o="suggest_routes_real_time_metadata"):(n=0,r=`${this.translate.instant("action_now_lowercase")}`,o="suggest_routes_real_time_metadata_leaves"),i&&(e.isRelevantForRealTime=!0,e.extra.startFrom.param1=`<i></i><span class="eta">${r}</span>`,e.extra.startFrom.param2=e.extra.startFrom.firstStopName,e.extra.startFromTranslateKey=o),t.isRealTime=!0,t.extra.duration=n,this.processRealtimeDepartures(t)}setNoRTDataForRoute(e){e.isRelevantForRealTime=!1,e.extra.startFrom.param1=e.extra.startFrom.firstStopName,e.extra.startFromTranslateKey="suggest_routes_metadata"}processRealtimeDepartures(e){const t={},n=e.extra;e.upcomingArrivals=[],e.additionalArrivals=[],e.realTimeArrivals&&e.realTimeArrivals.forEach(i=>{if(t[i.lineId])t[i.lineId].rtDepartures.push(i);else{const r=n.arrivals.filter(e=>e.stopId==i.stopId&&e.lineId==i.lineId);if(r.length>0){const n=Object.assign({},r[0]);n.rtDepartures=[i],t[i.lineId]=n,e.upcomingArrivals.push(n)}}}),n.arrivals&&n.arrivals.forEach(n=>{t[n.lineId]?e.additionalArrivals.push(n):(t[n.lineId]=!0,e.upcomingArrivals.push(n))})}convertMVLineGroupOptionsResponseToLineGroupDisplayData(e,t,n,i,r,o,a,s,l){const c=this.convertLinesSummaries([o],e,n,i,r.linesTrips,a,s,l,r.subGroupsStops),d=[];for(const u in c)d.push(c[u]);return{lineGroupId:t,agencyId:o.agencyId,lines:d}}convertMVLocationDescriptorToSuggestedLocation(e){return{id:e.id,name:e.caption,address:null,fullName:null,latlng:o._.fromMvLatLon(e.latlon),type:null,imageHtml:null}}convertMVLineGroupDataToLineGroupData(e,t){if(!t)return;const{lineNumber:n,color:i,agencyId:r}=t,o=this.metroService.getImageIndexForAgency(r),{agencyName:a,routeType:s}=this.metroService.getAgency(r);return{lineGroupId:e,title:null,lineNumber:n,agencyName:a,agencyRouteType:s,color:(0,p.N0)(i),imageHtml:this.imageService.getLineImageHTML(t,o,void 0,void 0,n)}}bicycleStopImageHtmlPromise(e,t,n,i,r,o,a,s){const l=[];return e&&l.push({imageType:"image",imageId:-113}),l.push({imageType:"image",imageId:-114,color:i}),null!==t?l.push({imageType:"image",imageId:t,color:r}):n||l.push({imageType:"text",text:o,color:r,class:a}),n&&l.push({imageType:"image",imageId:-116,color:r,height:34,width:31},{imageType:"image",imageId:-117,color:i,height:34,width:31},{imageType:"text",text:o,color:s,textSize:9,layout:{x:.755,y:.22},halign:"center",valign:"center",class:a}),this.imageService.getMVFImageHtml({isLayered:!0,InnerImages:l})}}return e.\u0275fac=function(t){return new(t||e)(m.LFG(g.KD),m.LFG(f.V),m.LFG(v.c),m.LFG(y.sK),m.LFG(b.$),m.LFG(_.V))},e.\u0275prov=m.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},72249:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var i=n(2281),r=n(4008),o=n(87100),a=n(2316),s=n(2339);let l=(()=>{class e{constructor(e){this.translate=e,this.daysAmount=r.ku,this.limitTo7Days=!0,this.allowOther=!1}buildDays(e){const t=[],n=i().startOf("day");for(let i=0;i<this.daysAmount+1;i++){const e={value:i.toString(),text:n.format("ddd, MMM D"),date:(0,o.ky)(n.toDate())};t.push(e),n.add(1,"days")}return e&&t.push({value:"other",text:this.translate.instant("time_picker_more_options"),date:null}),this.allowOther=e,e||(this.limitTo7Days=!0),t}rebuildDaysList(e){this.daysAmount=e;const t=i.utc().startOf("day"),n=i(t).add(this.daysAmount+1,"days");return this.minDate=t.toDate(),this.maxDate=n.toDate(),this.buildDays(this.daysAmount>10)}getToday(){return{value:"0",text:this.translate.instant("today"),date:i().startOf("day").toDate()}}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.sK))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1210:function(e,t,n){"use strict";n.d(t,{Zg:function(){return f},nu:function(){return v},Qz:function(){return y}});var i=n(3786),r=n(86781),o=n(58871),a=n(16438),s=n(36179),l=n(99528),c=n(2316),d=n(95505),u=n(1437),p=n(99957),h=n(5971),m=n(99902);const g=(0,r.hu)("DeepLinkService");var f=(()=>{return(e=f||(f={}))[e.Widget=1]="Widget",e[e.Seo=2]="Seo",f;var e})(),v=(()=>{return(e=v||(v={}))[e.Directions=1]="Directions",e[e.Lines=2]="Lines",e[e.Generic=3]="Generic",v;var e})();let y=(()=>{class e{constructor(e,t,n,i,r){this.routingService=e,this.analyticsService=t,this.customerService=n,this.store=i,this.httpService=r,this.DEFAULT_PID="Web_WebApp_Direct",this.ONELINK_URL="https://moovit.onelink.me/3986059930",this.APPLE_ITUNES_PARAM="af_web_dp=http%3A%2F%2Fitunes.apple.com%2Fus%2Fapp%2Ftransit-directions-by-moovit%2Fid498477945%3Fmt%3D8",this.GOOGLE_PLAY_PARAM="af_web_dp=http%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.tranzmate",this.APPS_FLYER_DEEPLINK_PARAM="af_dp",this.APPS_FLYER_DEEPLINK_VALUE_PARAM="deep_link_value",this.APPS_FLYER_SUBSCRIBER_PARAM_3="af_sub3",this.APPS_FLYER_SUBSCRIBER_PARAM_4="af_sub4",this.APPS_FLYER_SUBSCRIBER_PARAM_5="af_sub5",this.APPS_FLYER_SUBSCRIBER_PARAM_6="af_sub6",this.APPS_FLYER_SUBSCRIBER_PARAM_7="af_sub7",this.APPLE_GA_LABEL="ios",this.GOOGLE_GA_LABEL="Android",this.defaultQRCode="/images/store-buttons/QR.png"}get state(){return this.store.getState()}getStoreOrDeepLink(e,t,n,i){return this.generateStoreLink((0,s.WO)(),null,e,t,n,i)}getDeepLinkType(){const e=this.routingService.getStateFromUrl();return e.fromLatLng||e.toLatLng||e.from||e.to?v.Directions:e.lineGroupId?v.Lines:v.Generic}generateStoreLink(e,t,n,i,r,s){var c,d,u,p,h,m;g.log(`Generating link for: currentView: ${this.state.global.selectedTab}, overridePlatform: ${e}, overridePid: ${t}`);const v=this.routingService.getStateFromUrl();let y=this.GOOGLE_PLAY_PARAM,b=this.GOOGLE_GA_LABEL;e===l.$I.iOS&&(y=this.APPLE_ITUNES_PARAM,b=this.APPLE_GA_LABEL);const _=this.state.global.selectedTab===a.TF.SPLASH,T=this.state.customer.currentCustomer.id===this.customerService.MoovitSeo.id,S=!(this.state.customer.currentCustomer.id===this.customerService.MoovitWeb.id||T),x=v.origin===f.Widget,w=v.isSSRVsNext;let k=this.DEFAULT_PID;const M=this.analyticsService.getSourceCustomDimension(),L=M?M.replace(/\s/g,"_"):null;let A=null;const I=this.analyticsService.getSeoAbTestCustomDimension(),E=null===(c=this.state.metro.currentMetro)||void 0===c?void 0:c.metroAreaName;let C=this.state.customer.currentCustomer.id+"_-";if(_&&(C="-_-"),T){const e=v.utmSource;e===o.EE?A="SEO_destinations":e===o.GJ?A="SEO_lines":e===o.kT&&(A="SEO_staticmaps")}else x&&(A="widget");let D=["is_retargeting=true","af_inactivity_window=30","af_click_lookback=7d","af_reengagement_window=7d"],P="";if((r||s)&&(y="",P=this.getSchemaParam(r,s,S)),S&&(null===(d=this.state.customer.currentCustomer)||void 0===d?void 0:d.onelinkUrl))return`${null===(u=this.state.customer.currentCustomer)||void 0===u?void 0:u.onelinkUrl}?${P}`;const O=this.state.user.selectedMetro&&this.state.user.selectedMetro.metroId;if(O&&D.push(`deep_link_sub1=${O}`),S){const e=encodeURIComponent(this.state.customer.currentCustomer.name.replace(/ /g,"-"));let t=this.state.customer.currentCustomer.managerName.replace(/[ \/.]/g,"-").split("@")[0].replace(/--+/g,"-").toLowerCase();"-"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),k=`Partner_${encodeURIComponent(t.charAt(0).toUpperCase()+t.slice(1))}_${encodeURIComponent(null===(m=null===(h=null===(p=this.state.metro)||void 0===p?void 0:p.currentMetro)||void 0===h?void 0:h.metroAreaName)||void 0===m?void 0:m.replace(/[ \/.]/g,"-").replace(/--+/g,"-"))}`,C=`${e}_mobile`}t&&(k=t),!S&&n&&(C=n);const N=this.analyticsService.getGaPayloadForNativeApp(b,i||"");y&&D.push(y),D.push(`pid=${k}`,`c=${C}`),T&&w&&D.push(`${this.APPS_FLYER_SUBSCRIBER_PARAM_3}=${w}`),L&&D.push(`${this.APPS_FLYER_SUBSCRIBER_PARAM_4}=${L}`),A&&D.push(`${this.APPS_FLYER_SUBSCRIBER_PARAM_5}=${A}`),I&&D.push(`${this.APPS_FLYER_SUBSCRIBER_PARAM_6}=${I}`),E&&D.push(`${this.APPS_FLYER_SUBSCRIBER_PARAM_7}=${encodeURIComponent(E)}`),N&&D.push(`GACP=${encodeURIComponent(N)}`),D.push(P),D=D.filter(e=>""!=e);const R=`${this.ONELINK_URL}?${D.join("&")}`;return g.log(`Store link: ${R}`),R}rfc3986EncodeURIComponent(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}getSchemaParam(e,t,n){let i="";if(t)i=t;else switch(e){case v.Directions:i=this.getDirectionsSchemaParam(n);break;case v.Lines:i=this.getLinesSchemaParam();break;case v.Generic:i=this.getGenericSchemaParam(n)}const r=i?encodeURIComponent(i):"";return r?`${this.APPS_FLYER_DEEPLINK_PARAM}=${r}&${this.APPS_FLYER_DEEPLINK_VALUE_PARAM}=${r}`:""}getGenericSchemaParam(e){var t,n;let i="moovit://";return e&&(null===(t=this.state.customer.currentCustomer)||void 0===t?void 0:t.deeplinkSchema)&&(i=null===(n=this.state.customer.currentCustomer)||void 0===n?void 0:n.deeplinkSchema),`${i}nearby`}getLinesSchemaParam(){const e=this.routingService.getStateFromUrl(),t=[];return e.lineGroupId&&t.push(`lgi=${e.lineGroupId}`),e.lineId&&t.push(`li=${e.lineId}`),t.push("auto_run=0"),`moovit://line?${t.join("&")}`}getDirectionsSchemaParam(e){var t,n;const i=this.routingService.getStateFromUrl(),r=[];if(i.fromLatLng&&(r.push(`orig_lat=${i.fromLatLng.lat}`),r.push(`orig_lon=${i.fromLatLng.lng}`)),i.from&&r.push(`orig_name=${this.rfc3986EncodeURIComponent(i.from)}`),i.toLatLng&&(r.push(`dest_lat=${i.toLatLng.lat}`),r.push(`dest_lon=${i.toLatLng.lng}`)),i.to&&r.push(`dest_name=${this.rfc3986EncodeURIComponent(i.to)}`),!r.length)return"";r.push("auto_run=1");let o="moovit://";return e&&(null===(t=this.state.customer.currentCustomer)||void 0===t?void 0:t.deeplinkSchema)&&(o=null===(n=this.state.customer.currentCustomer)||void 0===n?void 0:n.deeplinkSchema),`${o}directions?${r.join("&")}`}getAbTestUrl(e){const t=this.state.global.splashType,n=this.getStoreOrDeepLink("splash","splash",this.getDeepLinkType()),i=t==l.wm.Generic?"generic":t==l.wm.TripPlan?"poi":"line";let r;switch(e.name){case"data-splash-cta-text":r="V1"===e.variant?"Test_splash_Different_CTAtextV1":"V2"===e.variant?"Test_splash_Different_CTAtextV2":"Control_splash_Different_CTAText";break;case"data-adding-x-sign":r="V1"===e.variant?"Test_splash_addingX_V1":"V2"===e.variant?"Test_splash_addingX_V2":"Control_splash_addingX";break;case"data-Splash-Adding-BestApp":r="V1"===e.variant?"Test_Splash_Adding_BestAppV1":"V2"===e.variant?"Test_Splash_Adding_BestAppV2_Background":"Control_Splash_Adding_BestApp";break;case"data-different-cta-placement":r="V1"===e.variant?"Test_splash_CTAright_AnimationRight":"V2"===e.variant?"Test_splash_CTAright_AnimationLeft":"Control_splash_CTAright";break;case"data-different-text-structure":r="optimize"===e.variant?"Test_splash_different_text_structureV1":"Control_splash_different_text_structure";break;case"data-different-phone-image":r="optimize"===e.variant?"Test_splash_Different_Phone_Image":"Control_splash_Different_Phone_Image";break;case"data-different-phone-animation":r="optimize"===e.variant?"Test_splash_phoneanimation":"Control_splash_phoneanimation";break;case"data-different-text-plan":r="V1"===e.variant?"Test_splash_DifferentTextPlan_V1":"V2"===e.variant?"Test_splash_DifferentTextPlan_V2":"Control_splash_DifferentTextPlan";break;case"data-continue-after-3-sec":r="optimize"===e.variant?"Test_splash_continuetmobilesite_3sec":"Control_splash_continuetmobilesite_3sec";break;case"data-splash-transport-icons":r="V1"===e.variant?"Test_splash_static_transport_icons":"V2"===e.variant?"Test_splash_animated_transport_icons":"Control_splash_transport_icons";break;case"data-elements-loading-gradually":r="optimize"===e.variant?"Test_splash_graduallyloading":"Control_splash_graduallyloading"}return n+`&af_sub5=${r}_${i}`}getDeepLinkQrCode(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){const i=this.getStoreOrDeepLink(e,t,n);g.log(`generating qr code for: "${i}"`);const r=yield this.httpService.post("/api/qrcode/deeplink",{body:{deepLink:i}}).toPromise();if(null==r?void 0:r.success)return r.data;{const e=(null==r?void 0:r.data)?`error: ${r.data}`:"";return g.error("QR Code Data URI Generation failed.",e),this.analyticsService.trackError(`QR Code Data URI Generation failed. ${e}`),this.defaultQRCode}})}getBannerTestUrl(e,t,n){const i=this.state.global.selectedTab===a.TF.TRIPPLAN?"poi":this.state.global.selectedTab;let r;switch(e.name){case"data-banner-1-text-by-type":r="V1"==e.variant?"Test_webapp_Banner1_Different_textV1":"V2"==e.variant?"Test_webapp_Banner1_Different_textV2":"Control_webapp_Banner1_Different_text";break;case"data-pay-with-app":r="optimize"==e.variant?"Test_wtp_add_pay_cta":"Control_wtp_add_pay_cta";break;case"data-banner-store-badge":r="optimize"===e.variant?"Test_WebApp_Banner1_StoreBadge_CTA":"Control_WebApp_Banner1_StoreBadge_CTA";break;case"data-top-banner":"top"==n?"V1"===e.variant?r="Open_banner1_banner_top":"V2"===e.variant&&(r="Download_banner1_banner_top"):r="V1"===e.variant||"V2"===e.variant?"Test_banner1_banner_top":"Control_banner1_banner_top"}return t+`&af_sub5=${r}_${i}`}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(d.Z),c.LFG(u.y),c.LFG(p.v),c.LFG(h.d),c.LFG(m.O))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},21090:function(e,t,n){"use strict";n.d(t,{z:function(){return l},x:function(){return c}});var i=n(40912),r=n(94354),o=n(2316),a=n(82601),s=n(5971);class l{constructor(e,t){this.ref=e,this.data=t,this.onClose=new r.x}close(e){this.ref.dispose(),this.onClose.next(e),this.onClose.complete()}}let c=(()=>{class e{constructor(e,t,n){this.overlay=e,this.injector=t,this.store=n}get state(){return this.store.getState()}create(e,t={}){const n=this.overlay.create(Object.assign(Object.assign({},t),{hasBackdrop:!0,direction:this.state.global.selectedLocale.rtl?"rtl":"ltr",positionStrategy:this.overlay.position().global().centerHorizontally().centerVertically()})),r=new l(n,t.data||null),o=this.createInjector(r,this.injector),a=new i.C5(e,null,o);return n.attach(a),n.backdropClick().subscribe(()=>r.close()),{close:e=>r.close(e),onClose:r.onClose}}createInjector(e,t){const n=new WeakMap([[l,e]]);return new i.nK(t,n)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.aV),o.LFG(o.zs3),o.LFG(s.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},38947:function(e,t,n){"use strict";n.d(t,{T:function(){return a}});var i=n(99528),r=n(2316),o=n(2339);let a=(()=>{class e{constructor(e){this.translate=e}createGeolocationError(e){let t;return t={code:0,title:"",text:this.translate.instant("location_services_unavailable_message"),image:"img_empty_no_network.svg"},t}getTranslatedError(e){const t={code:e,text:void 0,title:void 0,image:void 0};switch(e){case i.SM.GeocoderResultsOutOfMetroArea:case i.SM.TripPlanOutOfMetroArea:t.text=this.translate.instant("TripPlanOutOfMetroAreaText"),t.image="img_empty_state_omni.svg";break;case i.SM.LocationNotAccessible:t.text=this.translate.instant("LocationNotAccessibleText"),t.image="img_empty_state_omni.svg";break;case i.SM.NoGeocoderResults:t.text=this.translate.instant("NoGeocoderResultsText");break;case i.SM.NoTransitTimes:t.text=this.translate.instant("NoTransitTimesText"),t.image="img_empty_state_line_view.svg";break;case i.SM.RemoveTripsWithTooMuchWaitingTime:t.text=this.translate.instant("RemoveTripsWithToMuchWaitingTimeText");break;case i.SM.FutureItineraryNotAllowed:t.text=this.translate.instant("FutureItineraryNotAllowedText");break;case i.SM.TooClose:t.text=this.translate.instant("TooCloseText"),t.image="img_empty_state_omni.svg";break;case i.SM.UnexpectedErrorInTripPlan:t.text=this.translate.instant("UnexpectedErrorInTripPlanText");break;case i.SM.NoTripPlanFound:t.text=this.translate.instant("NoTripPlanFoundText"),t.image="img_empty_state_omni.svg";break;default:return t.title=this.translate.instant("UnexpectedErrorTitle"),t.text=this.translate.instant("UnexpectedErrorText"),t}return t.title="",t}getSwitchMetroTranslatedError(e,t,n){const r={code:i.SM.TripPlanOutOfMetroArea,text:void 0,title:"",image:void 0};return r.text=t&&e&&""!==t&&""!==e?this.translate.instant("web_trip_plan_metro_area_error",{param1:t,param2:e})+'<br/><a href="'+n+'" target="_blank">'+this.translate.instant("web_trip_plan_results_button")+"</a>":this.translate.instant("TripPlanOutOfMetroAreaText"),r.image="img_empty_state_omni.svg",r}createSharedTripPlanTimeoutError(){return{text:this.translate.instant("tripplan_itinerary_share_timeout_message"),image:"img_empty_no_network.svg"}}createError(e){return{text:e,image:"img_empty_state_omni.svg"}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(o.sK))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},43445:function(e,t,n){"use strict";n.d(t,{e:function(){return r},$:function(){return o}});var i=n(2316),r=(()=>{return(e=r||(r={}))[e.ACTION_INIT_END=0]="ACTION_INIT_END",e[e.ACTION_GET_SUGGESTED_ROUTES=1]="ACTION_GET_SUGGESTED_ROUTES",e[e.ACTION_SET_SELECTED_ROUTE=2]="ACTION_SET_SELECTED_ROUTE",e[e.COMPONENT_APP=3]="COMPONENT_APP",e[e.COMPONENT_APP_CONTAINER=4]="COMPONENT_APP_CONTAINER",e[e.COMPONENT_APP_BLOCKED=5]="COMPONENT_APP_BLOCKED",e[e.COMPONENT_ROUTE_STEP=6]="COMPONENT_ROUTE_STEP",e[e.COMPONENT_SUGGESTED_ROUTES_SECTION=7]="COMPONENT_SUGGESTED_ROUTES_SECTION",e[e.COMPONENT_QR_SCANNER=8]="COMPONENT_QR_SCANNER",e[e.MODIFIER_TRACK_PAGEVIEW=9]="MODIFIER_TRACK_PAGEVIEW",e[e.MODIFIER_TRACK_EVENT=10]="MODIFIER_TRACK_EVENT",e[e.META_ON_DISABLED=11]="META_ON_DISABLED",r;var e})();let o=(()=>{class e{constructor(e){this.componentFactoryResolver=e,this.hooks={}}addHook(e,t){this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t)}runHooks(e,...t){const n=this.hooks[e];if(n){const e=[];n.forEach(n=>e.push(n(...t)));const i=()=>e[0];return Object.assign(i,e),i}return()=>t[0]}createComponent(e,t){const n=this.componentFactoryResolver.resolveComponentFactory(e);return t.createComponent(n)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(i._Vd))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},99902:function(e,t,n){"use strict";n.d(t,{O:function(){return x}});var i=n(53882),r=n(59442),o=n(4008),a=n(28314),s=JSON.parse('{"nested":{"ClientAlert":{"nested":{"AlertMetroRequest":{"fields":{"id":{"type":"int32","id":1},"lang":{"type":"int32","id":2},"revision":{"type":"int32","id":3}}},"MetroAlertResponse":{"fields":{"metroAlerts":{"rule":"repeated","type":"Protocol_ServiceAlerts.MVServiceAlertDigest","id":1},"alertsForAgency":{"rule":"repeated","type":"Protocol_ServiceAlerts.MVServiceAlertsForAgency","id":2},"lineGroups":{"keyType":"int64","type":"Protocol_Gtfs.MVLineGroupSummary","id":3}}},"AlertGetUpdatesRequest":{"fields":{"id":{"type":"int32","id":1},"lang":{"type":"string","id":2}}},"AlertRequest":{"fields":{"id":{"rule":"repeated","type":"int32","id":1},"type":{"rule":"repeated","type":"int32","id":2}}}}},"ClientLine":{"nested":{"LineGroupTripsRequest":{"fields":{"lineGroupId":{"type":"int32","id":1},"revision":{"type":"int32","id":2},"dayOffset":{"type":"int32","id":3},"isExtended":{"type":"int32","id":4}}},"LineGroupTripsResponse":{"fields":{"lineTrips":{"type":"Protocol_Gtfs.MVLineGroupTripsResponse","id":1},"syncedLineGroup":{"type":"Protocol_Gtfs.MVLineGroupSummary","id":2},"syncedStops":{"rule":"repeated","type":"Protocol_Gtfs.MVStopMetaData","id":3},"syncedPatterns":{"rule":"repeated","type":"Protocol_Gtfs.MVTripPattern","id":4},"syncedShapes":{"rule":"repeated","type":"Protocol_Gtfs.MVTripShape","id":5}}},"AgencyLinesRequest":{"fields":{"agencyId":{"type":"int32","id":1},"offset":{"type":"int32","id":2},"limit":{"type":"int32","id":3}}},"LineArrivalsResponse":{"fields":{"response":{"rule":"repeated","type":"Protocol_LineArrivals.MVLineArrivalsResponse","id":1}}},"LineArrivalsRequest":{"fields":{"params":{"type":"LineStopPairs","id":1}}},"LineStopPairs":{"fields":{"lineStopPairs":{"rule":"repeated","type":"LineStopPair","id":1}}},"LineStopPair":{"fields":{"lineId":{"type":"int64","id":1},"stopId":{"type":"int64","id":2}}},"OneLineArrivalsRequest":{"fields":{"lineIds":{"type":"string","id":1},"stopId":{"type":"int64","id":2}}},"MVAgencyResponseListWrapper":{"fields":{"agencies":{"rule":"repeated","type":"Protocol_Gtfs.MVAgency","id":1}}},"MVSearchLinesClientRequest":{"fields":{"limit":{"type":"int64","id":1},"offset":{"type":"int64","id":2},"query":{"type":"string","id":3}}},"LineStopRequest":{"fields":{"id":{"type":"int32","id":1}}}}},"ClientLocation":{"nested":{"MVClientSearchRequest":{"fields":{"latitude":{"type":"double","id":1},"longitude":{"type":"double","id":2},"query":{"type":"string","id":3}}},"LocationAddressRequest":{"fields":{"latitude":{"type":"double","id":1},"longitude":{"type":"double","id":2}}}}},"ClientMetro":{"nested":{"MetroCoordsRequest":{"fields":{"latitude":{"type":"double","id":1},"longitude":{"type":"double","id":2}}},"MetroNamesRequest":{"fields":{"id":{"type":"int32","id":1}}}}},"ClientNearbyStopsResponse":{"nested":{"MicroMobilityDataResponse":{"fields":{"tiles":{"rule":"repeated","type":"MicroMobilityTileData","id":1},"microMobilityTypes":{"rule":"repeated","type":"MicroMobilityType","id":2}}},"MicroMobilityTileData":{"fields":{"tileX":{"type":"int32","id":1},"tileY":{"type":"int32","id":2},"items":{"rule":"repeated","type":"ExtendedItem","id":3}}},"ExtendedItem":{"fields":{"location":{"type":"Protocol_Common.MVLatLon","id":1},"itemMetaData":{"type":"Protocol_MapItems.MVItemMetaData","id":2},"mapImage":{"type":"Protocol_Common.MVImageReferenceWithPartialParams","id":3},"categoryMetaData":{"type":"Protocol_MapItems.MVCategoryMetaData","id":4},"categoryId":{"type":"string","id":5},"categoryName":{"type":"string","id":6},"clusteringImage":{"type":"Protocol_Common.MVImageReferenceWithPartialParams","id":7},"minZoom":{"type":"int32","id":8},"maxZoom":{"type":"int32","id":9},"selectedMapImage":{"type":"Protocol_Common.MVImageReferenceWithPartialParams","id":10},"itemMMType":{"type":"MicroMobilityType","id":11}}},"MicroMobilityType":{"values":{"BIKE":1,"ELECTRIC_BIKE":2,"ELECTRIC_SCOOTER":3,"KICK_SCOOTER":4,"MOPED":5,"BIKE_STATION":6,"DOCKLESS_CAR":7}},"NearbyStopsResponseWrapper":{"fields":{"stopsGroups":{"rule":"repeated","type":"MVImageSetMapItemsWithDecodedLocations","id":1}}},"MVImageSetMapItemsWithDecodedLocations":{"fields":{"imageRefSet":{"type":"Protocol_Common.MVImageReferenceSet","id":1},"mapItems":{"rule":"repeated","type":"Protocol_MapItems.MVMapItem","id":2},"itemLocations":{"type":"string","id":3},"itemLocationsDecoded":{"rule":"repeated","type":"Protocol_Common.MVLatLon","id":4},"tileLat":{"type":"int32","id":5},"tileLng":{"type":"int32","id":6},"id":{"type":"int32","id":7}}},"MVStopMetaDataResponseWrapper":{"fields":{"stops":{"rule":"repeated","type":"Protocol_Gtfs.MVStopMetaData","id":1}}},"MVStopArrivalsResponseWrapper":{"fields":{"stopsArrivals":{"rule":"repeated","type":"MVStopArrivalsEnrichedResponse","id":1}}},"MVStopArrivalsEnrichedResponse":{"fields":{"stopId":{"type":"int32","id":1},"epochDay":{"type":"int32","id":2},"lineArrivals":{"rule":"repeated","type":"MVLineArrivalsEnriched","id":3},"stopRealTimeInfo":{"type":"Protocol_LineArrivals.MVStopRealTimeInformation","id":4}}},"MVLineArrivalsEnriched":{"fields":{"patternId":{"type":"int32","id":1},"tripId":{"type":"int64","id":2},"relativeStaticTimeSpanSeconds":{"type":"int32","id":3},"relativeRealTimeSpanSeconds":{"type":"int32","id":4},"status":{"type":"Protocol_LineArrivals.MVArrivalStatus2","id":5},"platformName":{"type":"string","id":6},"isLastArrival":{"type":"bool","id":7},"attributes":{"rule":"repeated","type":"Protocol_LineArrivals.MVTripArrivalAttribute","id":8},"frequencyId":{"type":"int32","id":9},"durationInSeconds":{"type":"int32","id":10},"vehicleLocation":{"type":"Protocol_LineArrivals.MVVehicleLocation","id":11},"stopIndex":{"type":"int32","id":12},"patternStopsSize":{"type":"int32","id":13},"vehicleAttributes":{"type":"Protocol_LineArrivals.MVArrivalAttributes","id":14},"lineId":{"type":"int32","id":15},"lineData":{"type":"LineData","id":16}}},"LineData":{"fields":{"groupId":{"type":"int32","id":1},"lineNumber":{"type":"string","id":2},"color":{"type":"int32","id":4},"imageRefSet":{"type":"Protocol_Common.MVImageReferenceSet","id":5},"destination":{"type":"string","id":6},"routeLongName":{"type":"string","id":7},"agencyId":{"type":"int32","id":8},"caption1":{"type":"string","id":9},"caption2":{"type":"string","id":10},"innerImageIds":{"type":"Protocol_Common.MVImageReferenceWithoutParamsSet","id":11}}}}},"ClientShare":{"nested":{"ShareEmailRequest":{"fields":{"shareType":{"type":"int32","id":1},"recipients":{"type":"string","id":2},"parameters":{"type":"string","id":3}}},"ItineraryByShareRequest":{"fields":{"id":{"type":"string","id":1}}}}},"ClientTickets":{"nested":{"setBusActivationPriceRequest":{"fields":{"userKey":{"type":"string","id":1},"context":{"type":"string","id":2},"codePrice":{"type":"Protocol_PtbActivations.MVPTBCodePrice","id":3}}},"BusActivationPricesRequest":{"fields":{"qrCode":{"type":"string","id":1},"location":{"type":"Protocol_Common.MVCoordinate","id":2}}}}},"CombinedUser":{"nested":{"CombinedUserRequest":{"fields":{"userCombination":{"type":"IMetroData","id":1},"customerId":{"type":"int64","id":2},"langId":{"type":"int64","id":3},"metroId":{"type":"int64","id":4},"countryCode":{"type":"string","id":5}}},"IMetroCustomDimensions":{"fields":{"countryName":{"type":"string","id":1},"metroName":{"type":"string","id":2},"metroShortName":{"type":"string","id":3},"metroLocalizedShortName":{"type":"string","id":4},"metroId":{"type":"int64","id":5},"metroSeoName":{"type":"string","id":6},"localeId":{"type":"string","id":7}}},"MetroFlags":{"fields":{"LINES_MAP_VIEW":{"type":"bool","id":1},"ALERTS_VIEW":{"type":"bool","id":2},"COMMUNITY_SUPPORTED":{"type":"bool","id":3}}},"ExpandedMetroAreaData":{"fields":{"metroAreaId":{"type":"int32","id":1},"timeZone":{"type":"string","id":2},"agencies":{"rule":"repeated","type":"Protocol_Gtfs.MVAgency","id":3},"routeTypes":{"rule":"repeated","type":"Protocol_Gtfs.MVMetroRouteType","id":4},"polygon":{"type":"string","id":5},"templates":{"rule":"repeated","type":"Protocol_Presentation.MVLineTemplate","id":6},"metroAreaName":{"type":"string","id":8},"linesUserReportCategoryIds":{"rule":"repeated","type":"Protocol_Common.MVUserReportLineCategoryType","id":9},"stopsUserReportCategoryIds":{"rule":"repeated","type":"Protocol_Common.MVUserReportStopCategoryType","id":10},"countryId":{"type":"int32","id":11},"countryName":{"type":"string","id":12},"defaultLocation":{"type":"Protocol_Common.MVLatLon","id":13},"revisionNumber":{"type":"int64","id":14},"localDayChangeTime":{"type":"int32","id":15},"bicycleProviders":{"rule":"repeated","type":"Protocol_Gtfs.MVBicycleProvider","id":16},"metroLanguage":{"type":"Protocol_Gtfs.MVMetroLanguage","id":17},"countryCode":{"type":"string","id":18},"metroClass":{"type":"string","id":19},"timeZoneOffset":{"type":"int64","id":20},"isEuMetro":{"type":"bool","id":21},"features":{"type":"MetroFlags","id":22},"taxiMetroConfigurations":{"rule":"repeated","type":"Protocol_Taxi.MVTaxiMetroConfiguration","id":23}}},"IMetroData":{"fields":{"metroId":{"type":"int64","id":1},"userKey":{"type":"string","id":2},"tilesUrl":{"type":"string","id":3},"isUnresolvedMetro":{"type":"bool","id":4},"gtfsLanguage":{"type":"string","id":5}}},"CombinedUserResponse":{"fields":{"userCombination":{"type":"IMetroData","id":1},"maxFutureDays":{"type":"int64","id":2},"metroAreaData":{"type":"ExpandedMetroAreaData","id":3},"metroCustomDimensions":{"type":"IMetroCustomDimensions","id":4},"isEuCountry":{"type":"bool","id":5}}}}},"SearchRoute":{"nested":{"SearchRouteQueryStart":{"fields":{"tripPlanPref":{"type":"int64","id":1},"time":{"type":"int64","id":2},"timeType":{"type":"int64","id":3},"isCurrentTime":{"type":"bool","id":4},"routeTypes":{"type":"string","id":5},"fromLocation_id":{"type":"int64","id":6},"fromLocation_type":{"type":"int64","id":7},"fromLocation_latitude":{"type":"double","id":8},"fromLocation_longitude":{"type":"double","id":9},"fromLocation_caption":{"type":"string","id":10},"toLocation_id":{"type":"double","id":11},"toLocation_type":{"type":"int64","id":12},"toLocation_latitude":{"type":"double","id":13},"toLocation_longitude":{"type":"double","id":14},"toLocation_caption":{"type":"string","id":15},"routeTransportOptions":{"type":"string","id":16}}},"SearchRouteQueryPool":{"fields":{"token":{"type":"string","id":1},"offset":{"type":"int64","id":2}}},"SimilarTripplanRequest":{"fields":{"guid":{"type":"string","id":1},"index":{"type":"int32","id":2},"mode":{"type":"int32","id":3},"isOriginState":{"type":"bool","id":4}}}}},"Protocol_CarPool":{"nested":{"MVDaysOfWeek":{"fields":{"sunday":{"type":"bool","id":1},"monday":{"type":"bool","id":2},"tuesday":{"type":"bool","id":3},"wednsday":{"type":"bool","id":4},"thursday":{"type":"bool","id":5},"friday":{"type":"bool","id":6},"saturday":{"type":"bool","id":7}}},"MVCarPoolPrice":{"fields":{"currencyCode":{"type":"string","id":1},"price":{"type":"int64","id":2}}},"MVCar":{"fields":{"number":{"type":"string","id":1},"model":{"type":"string","id":2},"color":{"type":"string","id":3},"maxNumPassengers":{"type":"int32","id":4},"imageUrl":{"type":"string","id":5}}},"MVRideConfirmationStatus":{"values":{"PER_RIDE":1,"PER_DAY":2,"AUTO_CONFIRM":3}},"MVConfirmationRate":{"fields":{"responseRate":{"type":"int32","id":1},"approvalRate":{"type":"int32","id":2},"responseTime":{"type":"int32","id":3}}},"MVDriverConfirmationSettings":{"fields":{"status":{"type":"MVRideConfirmationStatus","id":1},"rate":{"type":"MVConfirmationRate","id":2},"canSetAutoConfirm":{"type":"bool","id":3}}},"MVCarpoolDriver":{"fields":{"driverId":{"type":"string","id":1},"firstName":{"type":"string","id":2},"lastName":{"type":"string","id":3},"phoneNumber":{"type":"string","id":4},"car":{"type":"MVCar","id":5},"rating":{"type":"double","id":6},"profilePhotoUrl":{"type":"string","id":7},"fbFriendsNum":{"type":"int32","id":8},"selfDescription":{"type":"string","id":9},"registrationDate":{"type":"int64","id":10},"numRatings":{"type":"int32","id":11},"numFinishedRides":{"type":"int32","id":12},"age":{"type":"int32","id":13},"fbId":{"type":"string","id":14},"allowMultiplePickupPoints":{"type":"bool","id":15},"driversWorkData":{"type":"Protocol_Common.MVCarPoolWorkDetails","id":16},"allowDetour":{"type":"bool","id":17},"driverConfirmationSettings":{"type":"MVDriverConfirmationSettings","id":18}}},"MVStreetViewDetails":{"fields":{"zoomLevel":{"type":"double","id":1},"bearing":{"type":"double","id":2},"tilt":{"type":"double","id":3}}},"MVRideLocationDescriptor":{"fields":{"latlon":{"type":"Protocol_Common.MVLatLon","id":1},"name":{"type":"string","id":2},"address":{"type":"string","id":3},"streetViewDetails":{"type":"MVStreetViewDetails","id":4}}},"MVJourneyInfo":{"fields":{"pickup":{"type":"MVRideLocationDescriptor","id":1},"dropoff":{"type":"MVRideLocationDescriptor","id":2},"pickupComment":{"type":"string","id":3},"dropOffComment":{"type":"string","id":4}}},"MVRecurrentRideDetails":{"fields":{"rideScheduleId":{"type":"int32","id":1},"days":{"type":"MVDaysOfWeek","id":2}}},"MVDriverRouteDetails":{"fields":{"routeId":{"type":"int32","id":1},"shape":{"type":"string","id":2},"routeName":{"type":"string","id":3}}},"MVParkingStatus":{"values":{"NOT_ELIGIBLE":0,"ELIGIBLE":1,"PARKED":2}},"MVParkingMetaData":{"fields":{"id":{"type":"int32","id":1},"name":{"type":"string","id":2},"minNumberOfPassengers":{"type":"int32","id":3},"parkingCapacity":{"type":"int32","id":4},"availableFrom":{"type":"Protocol_Common.MVDayTime","id":5},"availableUntil":{"type":"Protocol_Common.MVDayTime","id":6},"boundingBox":{"type":"Protocol_Common.MVBoundingBox","id":7}}},"MVParkingState":{"fields":{"acquiredPlaces":{"type":"int32","id":1}}},"MVParking":{"fields":{"parkingMetadata":{"type":"MVParkingMetaData","id":1},"parkingState":{"type":"MVParkingState","id":2},"rideParkingStatus":{"type":"MVParkingStatus","id":3}}},"MVRide":{"fields":{"rideId":{"type":"int32","id":1},"journey":{"type":"MVJourneyInfo","id":2},"departureTime":{"type":"int64","id":3},"maxNumPassengers":{"type":"int32","id":4},"price":{"type":"MVCarPoolPrice","id":5},"fullPrice":{"type":"MVCarPoolPrice","id":6},"recurrentDetails":{"type":"MVRecurrentRideDetails","id":7},"arrivalTime":{"type":"int64","id":8},"driverRoutes":{"rule":"repeated","type":"MVDriverRouteDetails","id":9},"parking":{"type":"MVParking","id":10},"eventMetadata":{"type":"Protocol_RideSharing.MVRSEvent","id":11},"numberOfTickets":{"type":"int32","id":12}}},"MVPassengerStop":{"fields":{"stopSeq":{"type":"int32","id":1},"routeId":{"type":"int32","id":2}}},"MVPassengerStops":{"fields":{"pickUp":{"type":"MVPassengerStop","id":1},"dropOff":{"type":"MVPassengerStop","id":2},"origin":{"type":"Protocol_Common.MVLocationDescriptor","id":3},"destination":{"type":"Protocol_Common.MVLocationDescriptor","id":4}}},"MVCarPoolRideDetourDetails":{"fields":{"additionalDistanceMeters":{"type":"int32","id":1},"additionalTimeSeconds":{"type":"int32","id":2},"additionalPrice":{"type":"MVCarPoolPrice","id":3},"additionalFullPrice":{"type":"MVCarPoolPrice","id":4}}}}},"Protocol_ChunkedResponse":{"nested":{"MVChunkedResponseContext":{"fields":{"token":{"type":"string","id":1}}}}},"Protocol_ClientTexts":{"nested":{"MVClientText":{"values":{"DEFAULT_TRANSIT_TYPE_TRAM":-119,"DEFAULT_TRANSIT_TYPE_SUBWAY":-128,"DEFAULT_TRANSIT_TYPE_RAIL":-133,"DEFAULT_TRANSIT_TYPE_BUS":-4,"DEFAULT_TRANSIT_TYPE_FERRY":-5,"DEFAULT_TRANSIT_TYPE_CABLE":-6,"DEFAULT_TRANSIT_TYPE_GONDOLA":-7,"DEFAULT_TRANSIT_TYPE_FUNICULAR":-8,"TRANSIT_TYPE_SITP":-132,"TRANSIT_TYPE_AIR_LINE":-116,"TRANSIT_TYPE_AQUABUS":-117,"TRANSIT_TYPE_BART":-122,"TRANSIT_TYPE_CARMELIT":-105,"TRANSIT_TYPE_CHICAGO_L":-123,"TRANSIT_TYPE_COLECTIVO":-130,"TRANSIT_TYPE_DLR":-102,"TRANSIT_TYPE_LIGHT_TRAIN":-1,"TRANSIT_TYPE_LOTACAO":-110,"TRANSIT_TYPE_METRA":-103,"TRANSIT_TYPE_METRO":-2,"TRANSIT_TYPE_METRO_VALENCIA":-112,"TRANSIT_TYPE_NATIONAL_RAIL":-108,"TRANSIT_TYPE_OMNIBUS":-109,"TRANSIT_TYPE_RER":-104,"TRANSIT_TYPE_RIVER_BUS":-126,"TRANSIT_TYPE_S_BAHN":-120,"TRANSIT_TYPE_STREETCAR":-131,"TRANSIT_TYPE_SUBTE":-107,"TRANSIT_TYPE_TRAIN":-3,"TRANSIT_TYPE_TRAMLINK":-118,"TRANSIT_TYPE_TRAMVIA":-111,"TRANSIT_TYPE_TRANSMILENIO":-124,"TRANSIT_TYPE_TROLEBUS":-106,"TRANSIT_TYPE_TROLLEYBUS":-113,"TRANSIT_TYPE_TUBE":-129,"TRANSIT_TYPE_MICRO":-125,"TRANSIT_TYPE_METROCABLE":-101,"TRANSIT_TYPE_METRORREY":-127,"TRANSIT_TYPE_ECOVIA":-121,"TRANSIT_TYPE_BOAT":-115,"TRANSIT_TYPE_NAVEBUS":-114,"TRANSIT_TYPE_MAGLEV":-134,"TRANSIT_TYPE_STRASENBAHN":-135,"TRANSIT_TYPE_EXECUTIVO":-136,"TRANSIT_TYPE_MINIBUS":-137,"TRANSIT_TYPE_HIGHSPEED_TRAIN":-138,"TRANSIT_TYPE_BRT":-139,"TRANSIT_TYPE_EXECUTIVE_COACH":-140,"TRANSIT_TYPE_VAN":-141,"TRANSIT_TYPE_TOURIST_BUS":-142,"TRANSIT_TYPE_CATAMARA":-143,"TRANSIT_TYPE_MONORAIL":-144,"TRANSIT_TYPE_BALSA":-145,"TRANSIT_TYPE_VERTICAL_ELEVATOR":-146,"TRANSIT_TYPE_PEOPLE_MOVER":-147,"TRANSIT_TYPE_METROBUS":-148,"TRANSIT_TYPE_DOLMUS_AND_MINIBUS":-149,"TRANSIT_TYPE_SHARE_TAXI":-150,"TRANSIT_TYPE_SHUTTLE":-151,"TRANSIT_TYPE_MARSHRUTKA":-152,"TRANSIT_TYPE_MICROBUSES":-153,"TRANSIT_TYPE_ALIMENTADORES":-154,"TRANSIT_TYPE_SCHNELLBUS":-155,"TRANSIT_TYPE_SHUTTLE_BUS":-156,"TRANSIT_TYPE_AUTORICKSHAWS":-157,"TRANSIT_TYPE_RUFTAXIS":-158,"TRANSIT_TYPE_GREEN_MINIBUS":-159,"TRANSIT_TYPE_RED_MINIBUS":-160,"TRANSIT_TYPE_MONIT_SHERUT":-161,"TRANSIT_TYPE_MRT":-162,"TRANSIT_TYPE_ANGKOT":-163,"TRANSIT_TYPE_MRT_LRT":-164,"TRANSIT_TYPE_MCD":-165,"TRANSIT_TYPE_P2P":-166,"TRANSIT_TYPE_UVX":-167,"TRANSIT_TYPE_JEEPNEY":-168,"TRANSIT_TYPE_LRT":-169,"TRANSIT_TYPE_SONGTHAEW":-170,"TRANSIT_TYPE_MAGLEV_MAGLEV":-171,"TRANSIT_TYPE_ISRAEL_RAILWAYS":-172,"TRANSIT_TYPE_CARMELIT_RACHBALIT":-173,"TRANSIT_TYPE_SKYRAIL":-174}}}},"Protocol_Common":{"nested":{"MVEntityType":{"values":{"Stop":0,"Line":1,"LineGroup":2}},"MVEntityIdentifier":{"fields":{"entityType":{"type":"MVEntityType","id":1},"id":{"type":"int32","id":2}}},"MVUserReportStopCategoryType":{"values":{"Crowdedness":1,"FacilityCondition":2,"Incident":3,"Cleanliness":4,"Happening":5,"Other":6,"StationMoved":7,"StationClosed":8,"IncorrectLocation":9,"MissingLine":10,"DuplicateLine":11}},"MVUserReportLineCategoryType":{"values":{"LateDelay":12,"LineDidntStop":13,"LineUutOfService":14,"Crowdedness":15,"Incident":16,"PlatformChange":17,"DriversRank":18,"RouteChange":19,"Cleanliness":20,"Tempreture":21,"LineShapeIsBad":22,"MissingLine":23}},"MVUserReportCategoryType":{"fields":{"stopCateogry":{"type":"MVUserReportStopCategoryType","id":1},"lineCategory":{"type":"MVUserReportLineCategoryType","id":2}}},"MVDirection":{"values":{"Forward":0,"Backward":1,"Unspecified":2}},"MVVehicleType":{"values":{"BUS":1,"MINIBUS":2,"TAXI":3}},"MVClientColorScheme":{"values":{"PRIMARY":1,"SECONDARY":2,"TERTIARY":3,"GOOD":4,"PROBLEM":5,"CRITICAL":6,"INFO":7,"ON_SURFACE":8,"ON_SURFACE_EMPHASIS_HIGH":9,"ON_SURFACE_EMPHASIS_MEDIUM":10,"ON_SURFACE_EMPHASIS_LOW":11,"SURFACE_GOOD":12,"SURFACE_PROBLEM":13,"SURFACE_CRITICAL":14,"SURFACE_INFO":15}},"MVImageReferenceWithParams":{"fields":{"imageId":{"type":"int32","id":1},"parameters":{"rule":"repeated","type":"string","id":2}}},"MVImagePackReferenceWithParams":{"fields":{"ltr":{"type":"MVImageReferenceWithParams","id":1},"rtl":{"type":"MVImageReferenceWithParams","id":2}}},"MVAccessory":{"fields":{"accessabilityText":{"type":"string","id":1},"accessoryIcon":{"type":"MVImageReferenceWithParams","id":2},"accessoryText":{"type":"string","id":3},"color":{"type":"MVClientColorScheme","id":4}}},"MVImageReferenceWithPartialParams":{"fields":{"imageId":{"type":"int32","id":1},"params":{"rule":"repeated","type":"string","id":2}}},"MVImageReferenceSetEntry":{"fields":{"index":{"type":"int32","id":1},"imageRef":{"type":"int32","id":2}}},"MVImageReferenceSetWithParamsEntry":{"fields":{"index":{"type":"int32","id":1},"imageRef":{"type":"MVImageReferenceWithParams","id":2}}},"MVImageReferenceWithoutParamsSetEntry":{"fields":{"index":{"type":"int32","id":1},"image":{"type":"int32","id":2}}},"MVImageReferenceWithoutParamsSet":{"fields":{"images":{"rule":"repeated","type":"MVImageReferenceWithoutParamsSetEntry","id":1}}},"MVImageReferenceSet":{"fields":{"images":{"rule":"repeated","type":"MVImageReferenceSetEntry","id":1}}},"MVImageReferenceSetWithParams":{"fields":{"images":{"rule":"repeated","type":"MVImageReferenceSetWithParamsEntry","id":1}}},"MVLatLon":{"fields":{"latitude":{"type":"int32","id":1},"longitude":{"type":"int32","id":2}}},"MVBoundingBox":{"fields":{"south":{"type":"int32","id":1},"north":{"type":"int32","id":2},"west":{"type":"int32","id":3},"east":{"type":"int32","id":4}}},"MVRouteType":{"values":{"Tram":0,"Subway":1,"Rail":2,"Bus":3,"Ferry":4,"Cable":5,"Gondola":6,"Funicular":7}},"MVLocationType":{"values":{"LatLon":1,"City":2,"Street":3,"Site":4,"Stop":5,"Geocoder":6,"BicycleStop":7,"ParkingLot":8}},"MVSiteSource":{"values":{"UNDEFINED":0,"EVENT":1}},"MVLocationDescriptor":{"fields":{"caption":{"type":"string","id":1},"id":{"type":"int32","id":2},"latlon":{"type":"MVLatLon","id":3},"type":{"type":"MVLocationType","id":4},"uid":{"type":"string","id":5},"inaccurateLatLon":{"type":"bool","id":6},"source":{"type":"MVSiteSource","id":7},"icon":{"type":"MVImageReferenceWithParams","id":8},"mapIcon":{"type":"MVImageReferenceWithParams","id":9}}},"MVTextOrImage":{"fields":{"text":{"type":"string","id":1},"image":{"type":"MVImageReferenceWithParams","id":2}}},"MVSite":{"fields":{"id":{"type":"int32","id":1},"text":{"type":"string","id":2},"imageReference":{"type":"int32","id":3}}},"MVCurrencyAmount":{"fields":{"balance":{"type":"int64","id":1},"currencyId":{"type":"int32","id":2},"currencySymbol":{"type":"string","id":3},"currencyCode":{"type":"string","id":4}}},"MVDayTime":{"fields":{"hourOfDay":{"type":"int32","id":1},"minutes":{"type":"int32","id":2}}},"MVViewType":{"values":{"DEFAULT":1,"TRIPS":2,"PLATFORMS":3}},"MVCarPoolWorkDetails":{"fields":{"workName":{"type":"string","id":1},"workEmail":{"type":"string","id":2},"employeeId":{"type":"string","id":3},"isApprovedByCompany":{"type":"bool","id":4}}},"MVSearchLineGroupItem":{"fields":{"lineGroupId":{"type":"int32","id":1},"image":{"type":"MVImageReferenceWithParams","id":2},"title":{"type":"string","id":3},"subtitle":{"rule":"repeated","type":"MVTextOrImage","id":4},"metadata":{"rule":"repeated","type":"string","id":5},"shortName":{"type":"string","id":6},"longName":{"type":"string","id":7},"lineNumber":{"type":"string","id":8},"city1":{"type":"string","id":9},"city2":{"type":"string","id":10}}},"MVExternalAppData":{"fields":{"androidApplicationId":{"type":"string","id":1},"androidDeepLink":{"type":"string","id":2},"iosAppInstalLink":{"type":"string","id":3},"iosDeepLink":{"type":"string","id":4},"iosScheme":{"type":"string","id":5},"androidAppInstallLink":{"type":"string","id":6}}},"MVCoordinate":{"fields":{"latitude":{"type":"double","id":1},"longitude":{"type":"double","id":2}}}}},"Protocol_Configuration":{"nested":{"MVDashboardSection":{"values":{"ACTIVE_NAVIGATION":1,"RIDE_SHARING":2,"CARPOOL":3,"TAXI":4,"TOPUP":5,"COMMUNITY":6,"FAVORITE_LOCATIONS":7,"RECENT_ITINERARIES":8,"NO_GPS":9,"CALENDAR":10,"TOD":11,"PROMOTION":12,"ATAF_TICKETS":13,"TICKETS":14,"MOT":15,"WE_RIDE_TOD":16,"ON_DEMAND_TAXI":17,"WEB_PAGES":18,"BUSITALIA_TOD":19,"UMO_ADS":20,"WALLET":21,"GTT_TOD":22,"FAVORITE_STATIONS":23,"SCOTTISH_BORDERS_TOD":24,"ADS":25,"GENERAL":26,"SUGGESTIONS":27}}}},"Protocol_External":{"nested":{"MVShortPlatformMetadata":{"fields":{"tripId":{"type":"int64","id":1},"stopId":{"type":"int32","id":2},"carLabels":{"rule":"repeated","type":"string","id":3},"nubmerOfCars":{"type":"int32","id":4}}}}},"Protocol_ExternalCommon":{"nested":{"MVLocation":{"fields":{"lat":{"type":"double","id":1},"lon":{"type":"double","id":2}}}}},"Protocol_Fare":{"nested":{"MVFarePaymentMethod":{"values":{"ON_BOARD":0,"BEFORE_BOARDING":1}},"MVFareUsage":{"values":{"Pay":1,"Transfer":2,"Continue":3,"Upgrade":4,"Deleted":5}},"MVFareData":{"fields":{"fareId":{"type":"int32","id":1},"balance":{"type":"int64","id":2},"payForThisLeg":{"type":"bool","id":3},"relatedLegIndex":{"type":"int32","id":4},"paymentMethod":{"type":"MVFarePaymentMethod","id":5},"usage":{"type":"MVFareUsage","id":6}}},"MVLegFare":{"fields":{"price":{"type":"Protocol_Common.MVCurrencyAmount","id":2},"payForThisLeg":{"type":"bool","id":3},"fares":{"rule":"repeated","type":"MVFareData","id":5}}},"MVAltIdxWithFare":{"fields":{"legIdx":{"type":"int32","id":1},"altIdx":{"type":"int32","id":2},"price":{"type":"int32","id":3}}},"MVAltVariationFare":{"fields":{"altVariation":{"rule":"repeated","type":"MVAltIdxWithFare","id":1}}},"MVAltVariationFareGroup":{"fields":{"partial":{"type":"bool","id":1},"price":{"type":"int32","id":2},"altVariations":{"rule":"repeated","type":"MVAltVariationFare","id":3}}},"MVItineraryFare":{"fields":{"price":{"type":"Protocol_Common.MVCurrencyAmount","id":1},"maxPrice":{"type":"int64","id":2},"partial":{"type":"bool","id":3},"altVariationFareGroups":{"rule":"repeated","type":"MVAltVariationFareGroup","id":4}}}}},"Protocol_GeneralSettings":{"nested":{"MVMetroArea":{"fields":{"id":{"type":"int32","id":1},"name":{"type":"string","id":2},"keywords":{"rule":"repeated","type":"string","id":3},"metroClass":{"type":"string","id":4}}},"MVExternalWebPageType":{"values":{"MENU":1,"DASHBOARD":2}},"MVExternalWebPage":{"fields":{"pageId":{"type":"string","id":1},"image":{"type":"int32","id":2},"link":{"type":"string","id":3},"caption":{"type":"string","id":4},"lastUpdated":{"type":"int64","id":5},"embedded":{"type":"bool","id":6},"type":{"type":"MVExternalWebPageType","id":7},"backgroundColor":{"type":"int32","id":8}}},"MVExternalWebPagesResponse":{"fields":{"externalWebPages":{"rule":"repeated","type":"MVExternalWebPage","id":1}}}}},"Protocol_Gtfs":{"nested":{"MVPathwayType":{"values":{"BOTH":1,"ENTRANCE":2,"EXIT":3}},"MVPathway":{"fields":{"pathwayId":{"type":"int32","id":1},"name":{"type":"string","id":2},"location":{"type":"Protocol_Common.MVLatLon","id":3},"type":{"type":"MVPathwayType","id":4}}},"MVPlatformLines":{"fields":{"name":{"type":"string","id":1},"lineIds":{"rule":"repeated","type":"int32","id":2}}},"MVStopMetaData":{"fields":{"stopId":{"type":"int32","id":1},"stopName":{"type":"string","id":2},"stopLocation":{"type":"Protocol_Common.MVLatLon","id":3},"stopCode":{"type":"string","id":4},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":5},"platformLines":{"rule":"repeated","type":"MVPlatformLines","id":6},"keyLineIds":{"rule":"repeated","type":"int32","id":7},"sitesList":{"rule":"repeated","type":"Protocol_Common.MVSite","id":8},"imageRefSet":{"type":"Protocol_Common.MVImageReferenceSetWithParams","id":9},"mvPathways":{"rule":"repeated","type":"MVPathway","id":10},"routeType":{"type":"Protocol_Common.MVRouteType","id":11},"wheelchairAccessible":{"type":"bool","id":12}}},"MVTripShape":{"fields":{"shapeId":{"type":"int32","id":1},"encodedShape":{"type":"string","id":2}}},"MVTripGroup":{"fields":{"tripIntervalsId":{"type":"int32","id":1},"tripShapeId":{"type":"int32","id":2},"localMidnightDaysSinceEpoch":{"type":"int32","id":3},"departures":{"rule":"repeated","type":"int32","id":4},"serviceId":{"type":"int32","id":5},"departureTripIds":{"rule":"repeated","type":"int64","id":6},"frequencyId":{"type":"int32","id":7}}},"MVTripPattern":{"fields":{"tripPatternId":{"type":"int32","id":1},"stopIds":{"rule":"repeated","type":"int32","id":2},"stopNames":{"rule":"repeated","type":"string","id":3},"shapeId":{"type":"int32","id":4}}},"MVTripIntervals":{"fields":{"tripIntervalsId":{"type":"int32","id":1},"tripPatternId":{"type":"int32","id":2},"intervals":{"rule":"repeated","type":"int32","id":3}}},"MVLineSummary":{"fields":{"lineId":{"type":"int32","id":1},"origin":{"type":"string","id":2},"destination":{"type":"string","id":3},"routeLongName":{"type":"string","id":4},"subGroupId":{"type":"int32","id":5},"onTimeAccuracyScore":{"type":"int32","id":6}}},"MVLineGroupSummaryType":{"values":{"REGULAR":1,"DIRECTIONAL":2}},"MVSubGroup":{"fields":{"subGroupId":{"type":"int32","id":1},"name":{"type":"string","id":2}}},"MVLineGroupSummary":{"fields":{"groupId":{"type":"int32","id":1},"lineNumber":{"type":"string","id":2},"agencyId":{"type":"int32","id":3},"color":{"type":"int32","id":4},"imageRefSet":{"type":"Protocol_Common.MVImageReferenceSet","id":5},"lineSummaries":{"rule":"repeated","type":"MVLineSummary","id":6},"innerImageIds":{"type":"Protocol_Common.MVImageReferenceWithoutParamsSet","id":7},"caption1":{"type":"string","id":8},"caption2":{"type":"string","id":9},"type":{"type":"MVLineGroupSummaryType","id":10},"subGroups":{"rule":"repeated","type":"MVSubGroup","id":11},"pdfFileUrl":{"type":"string","id":12}}},"MVSupplementalData":{"fields":{"lineGroupSummaryList":{"rule":"repeated","type":"MVLineGroupSummary","id":1},"mVStopSyncedMetaDataList":{"rule":"repeated","type":"MVStopMetaData","id":2}}},"MVSubGroupMergedStops":{"fields":{"subGroup":{"type":"MVSubGroup","id":1},"stopIdsSequence":{"rule":"repeated","type":"int32","id":2}}},"MVLineTrips":{"fields":{"lineId":{"type":"int32","id":1},"tripGroups":{"rule":"repeated","type":"MVTripGroup","id":2},"tripIntervals":{"rule":"repeated","type":"MVTripIntervals","id":3}}},"MVLineGroupTripsResponse":{"fields":{"linesTrips":{"rule":"repeated","type":"MVLineTrips","id":1},"subGroupsStops":{"rule":"repeated","type":"MVSubGroupMergedStops","id":2}}},"MVAgency":{"fields":{"agencyId":{"type":"int32","id":1},"agencyName":{"type":"string","id":2},"routeType":{"type":"Protocol_Common.MVRouteType","id":3},"image":{"type":"int32","id":4},"presentationLineTemplates":{"rule":"repeated","type":"Protocol_Presentation.MVPresentationLineTemplate","id":5}}},"MVRouteSortingMethods":{"values":{"Lexicographically":1,"PrimarilyByNumbers":2,"PrimarilyByLetters":3}},"MVMetroRouteType":{"fields":{"routeType":{"type":"Protocol_Common.MVRouteType","id":1},"image":{"type":"int32","id":2},"clientOverrideTextResourceId":{"type":"Protocol_ClientTexts.MVClientText","id":3},"sortingMethod":{"type":"MVRouteSortingMethods","id":4},"viewType":{"type":"Protocol_Common.MVViewType","id":5}}},"MVBicycleProvider":{"fields":{"providerId":{"type":"int32","id":1},"name":{"type":"string","id":2},"providerImage":{"type":"int32","id":3},"primaryColor":{"type":"int32","id":4},"secondaryColor":{"type":"int32","id":5},"isRealTimeDataSupported":{"type":"bool","id":6}}},"MVMetroLanguage":{"fields":{"name":{"type":"string","id":1},"key":{"type":"string","id":2},"isDefault":{"type":"bool","id":3}}}}},"Protocol_LineArrivals":{"nested":{"MVArrivalStatus2":{"values":{"ON_TIME":1,"DELAYED":2,"CANCELLED":3,"AHEAD_OF_TIME":4}},"MVTripArrivalAttributeType":{"values":{"MAIN_TRIP_STOPS":1}},"MVTripArrivalAttribute":{"fields":{"type":{"type":"MVTripArrivalAttributeType","id":1},"data":{"type":"string","id":2}}},"MVVehicleProgress":{"fields":{"nextStopIndex":{"type":"int32","id":1},"progress":{"type":"int32","id":2}}},"MVVehicleLocation":{"fields":{"latlon":{"type":"Protocol_Common.MVLatLon","id":1},"progress":{"type":"MVVehicleProgress","id":2},"vehicleId":{"type":"string","id":3},"vehicleSampleTimeUtc":{"type":"int64","id":4}}},"MVCongestionLevel":{"values":{"EMPTY":0,"FEW":1,"LOW":2,"MED":3,"HIGH":4,"FULL":5,"PACKED":6}},"MVCongestionStatusSource":{"values":{"SENSOR":1,"USER":2,"PREDICTION":3}},"MVStopCongestionStatus":{"fields":{"type":{"type":"MVCongestionLevel","id":1},"reportTimeUtc":{"type":"int64","id":2},"platformName":{"type":"string","id":3},"source":{"type":"MVCongestionStatusSource","id":4}}},"MVStopRealTimeInformation":{"fields":{"congestionStatus":{"rule":"repeated","type":"MVStopCongestionStatus","id":1}}},"MVArrivalAttributes":{"fields":{"reportTimeUtc":{"type":"int64","id":1},"level":{"type":"MVCongestionLevel","id":2},"isAccessible":{"type":"bool","id":3},"source":{"type":"MVCongestionStatusSource","id":4},"nfcPaymentSupport":{"type":"bool","id":5}}},"MVArrival":{"fields":{"patternId":{"type":"int32","id":1},"tripId":{"type":"int64","id":2},"relativeStaticTimeSpanSeconds":{"type":"int32","id":3},"relativeRealTimeSpanSeconds":{"type":"int32","id":4},"status":{"type":"MVArrivalStatus2","id":5},"platformName":{"type":"string","id":6},"isLastArrival":{"type":"bool","id":7},"attributes":{"rule":"repeated","type":"MVTripArrivalAttribute","id":8},"frequencyId":{"type":"int32","id":9},"durationInSeconds":{"type":"int32","id":10},"vehicleLocation":{"type":"MVVehicleLocation","id":11},"stopIndex":{"type":"int32","id":12},"patternStopsSize":{"type":"int32","id":13},"vehicleAttributes":{"type":"MVArrivalAttributes","id":14}}},"MVLineArrivals":{"fields":{"lineId":{"type":"int32","id":1},"arrivals":{"rule":"repeated","type":"MVArrival","id":2}}},"MVLineArrivalsResponse":{"fields":{"stopId":{"type":"int32","id":1},"epochDay":{"type":"int32","id":2},"lineArrivals":{"type":"MVLineArrivals","id":3},"stopRealTimeInfo":{"type":"MVStopRealTimeInformation","id":4}}}}},"Protocol_MapItems":{"nested":{"MVMapItem":{"fields":{"itemId":{"type":"int32","id":1},"itemParams":{"rule":"repeated","type":"string","id":2}}},"MVBikeStationMetaData":{"fields":{"name":{"type":"string","id":1},"availableBikes":{"type":"int32","id":2},"freeDocks":{"type":"int32","id":3},"lastUpdate":{"type":"int64","id":4},"showStationDetails":{"type":"bool","id":5},"drivingRate":{"type":"string","id":6},"stationId":{"type":"string","id":7}}},"MVCarMetaData":{"fields":{"id":{"type":"string","id":1}}},"MVCommercialMetaData":{"fields":{"commercialId":{"type":"int32","id":1}}},"MVCarPoolRideMetaData":{"fields":{"rideId":{"type":"int32","id":1},"driverName":{"type":"string","id":2},"driverImgUrl":{"type":"string","id":3},"destinationName":{"type":"string","id":4},"departureTime":{"type":"int64","id":5},"stops":{"type":"Protocol_CarPool.MVPassengerStops","id":6}}},"MVDocklessVehicleType":{"values":{"BIKE":1,"ELECTRIC_BIKE":2,"ELECTRIC_SCOOTER":3,"KICK_SCOOTER":4,"MOPED":5,"CAR":-1}},"MVDocklessVehicle":{"fields":{"type":{"type":"MVDocklessVehicleType","id":1},"vehicleName":{"type":"string","id":2},"batteryLevel":{"type":"int32","id":3},"numOfHelmets":{"type":"int32","id":4},"drivingRate":{"type":"string","id":5}}},"MVDocklessCar":{"fields":{"id":{"type":"string","id":1},"name":{"type":"string","id":2},"batteryLevel":{"type":"int32","id":3},"numOfSeats":{"type":"int32","id":4},"drivingRate":{"type":"string","id":5},"fuelLevel":{"type":"int32","id":6}}},"MVMicroMobilityItem":{"fields":{"itemId":{"type":"string","id":1},"title":{"type":"string","id":2},"subtitle":{"type":"string","id":3},"accessoryInfo":{"rule":"repeated","type":"Protocol_Common.MVAccessory","id":4},"imageAdditonalParam":{"rule":"repeated","type":"string","id":5}}},"MVItemMetaData":{"fields":{"bikeStationMetaData":{"type":"MVBikeStationMetaData","id":1},"carMetaData":{"type":"MVCarMetaData","id":2},"carPoolRideMetadata":{"type":"MVCarPoolRideMetaData","id":3},"commercialMetaData":{"type":"MVCommercialMetaData","id":4},"docklessVehicle":{"type":"MVDocklessVehicle","id":5},"docklessCar":{"type":"MVDocklessCar","id":6},"microMobilityItem":{"type":"MVMicroMobilityItem","id":7}}},"MVBikeProviderMetaData":{"fields":{"serviceImageId":{"type":"int32","id":1}}},"MVDocklessVehicleProviderMetaData":{"fields":{"providerName":{"type":"string","id":1},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":2},"androidDeepLink":{"type":"string","id":3},"iosDeepLink":{"type":"string","id":4},"iosAppInstallLink":{"type":"string","id":5},"androidDefaultDeepLink":{"type":"string","id":6}}},"MVDocklessCarMetaData":{"fields":{"providerName":{"type":"string","id":1},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":2},"androidDeepLink":{"type":"string","id":3},"iosDeepLink":{"type":"string","id":4},"iosAppInstallLink":{"type":"string","id":5}}},"MVMicroMobilityMetaData":{"fields":{"providerPreviewImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":1}}},"MVCategoryMetaData":{"fields":{"basicProviderMetaData":{"type":"MVBikeProviderMetaData","id":1},"docklessVehicleMetaData":{"type":"MVDocklessVehicleProviderMetaData","id":2},"docklessCarMetaData":{"type":"MVDocklessCarMetaData","id":3},"microMobilityMetaData":{"type":"MVMicroMobilityMetaData","id":4}}}}},"Protocol_MicroMobility":{"nested":{"MVMicroMobilityIntegrationFlow":{"values":{"DEEP_LINK":1,"RESERVE":2,"UNLOCK":3}}}},"Protocol_Presentation":{"nested":{"MVPresentationType":{"values":{"StopDetail":1,"LineDetail":2,"NearMe":3,"OmniSearch":4,"RideMode":5,"LineNews":6,"Itinerary":7,"LineSchedule":8}},"MVPresentationLineTemplate":{"fields":{"presentationType":{"type":"MVPresentationType","id":1},"imageIndex":{"type":"int32","id":2},"lineTemplateId":{"type":"int32","id":3}}},"MVLineTemplateToken":{"values":{"Empty":0,"LineNumber":1,"AgencyName":2,"LineLongName":5,"LineOrigin":6,"LineDestination":7,"RouteType":9,"LineGroupCaption1":10,"LineGroupCaption2":11,"LineSubGroupCaption":12}},"MVDelimiterToken":{"values":{"Empty":1,"Arrow":2,"BiDirectionalArrow":4,"Dot":5}},"MVConditional":{"fields":{"condition":{"type":"MVLineTemplateToken","id":1},"conditionLength":{"type":"int32","id":2}}},"MVTokenConditional":{"fields":{"condition":{"type":"MVConditional","id":1},"ifGreater":{"type":"MVLineTemplateToken","id":2},"ifLess":{"type":"MVLineTemplateToken","id":3}}},"MVLineTemplate":{"fields":{"lineTemplateId":{"type":"int32","id":1},"titleConditional":{"type":"MVTokenConditional","id":2},"imageConditional":{"type":"MVConditional","id":3},"imageTextConditional":{"type":"MVTokenConditional","id":4},"agencyImageShown":{"type":"bool","id":5},"delimiterToken":{"type":"MVDelimiterToken","id":6},"detailsList":{"rule":"repeated","type":"MVLineTemplateToken","id":7}}}}},"Protocol_PtbActivations":{"nested":{"MVPTBDiscountRegion":{"fields":{"id":{"type":"int32","id":1},"title":{"type":"string","id":2},"subTitle":{"type":"string","id":3},"selectionYes":{"type":"string","id":4},"selectionNo":{"type":"string","id":5},"discountReason":{"type":"string","id":6},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":7},"polygons":{"rule":"repeated","type":"string","id":8}}},"MVPTBDiscountRegionCodePrice":{"fields":{"regionId":{"type":"int32","id":1},"price":{"type":"Protocol_Common.MVCurrencyAmount","id":2},"fullPrice":{"type":"Protocol_Common.MVCurrencyAmount","id":3}}},"MVPTBCodePrice":{"fields":{"fareCode":{"type":"int32","id":1},"radius":{"type":"int32","id":2},"price":{"type":"Protocol_Common.MVCurrencyAmount","id":3},"fullPrice":{"type":"Protocol_Common.MVCurrencyAmount","id":4},"color":{"type":"int32","id":5},"discountRegionPrices":{"rule":"repeated","type":"MVPTBDiscountRegionCodePrice","id":6},"discountResons":{"rule":"repeated","type":"string","id":7}}},"MVPTBGetActivationPriceResponse":{"fields":{"context":{"type":"string","id":1},"codePrices":{"rule":"repeated","type":"MVPTBCodePrice","id":2},"profile":{"type":"string","id":3},"agencyId":{"type":"int32","id":4},"discountRegions":{"rule":"repeated","type":"MVPTBDiscountRegion","id":5}}},"MVPTBActivationStatus":{"values":{"ACTIVE":1,"COMPLETED":2,"HISTORICAL":3}},"MVPTBTransitType":{"values":{"CityBus":1,"InterBus":2,"CityShuttleBus":3,"InterShuttleBus":4,"CityLightRail":5,"CityLightRailStation":6,"TrainStation":7,"CarmelitLightRail":8,"ExpressCableCar":9}},"MVPTBActivation":{"fields":{"activationId":{"type":"int32","id":1},"activationTime":{"type":"int64","id":2},"activationTitle":{"type":"string","id":3},"codePrice":{"type":"MVPTBCodePrice","id":4},"profileName":{"type":"string","id":5},"isAnonymous":{"type":"bool","id":6},"agencyName":{"type":"string","id":7},"agencyId":{"type":"int32","id":8},"discountReasons":{"rule":"repeated","type":"string","id":9},"ticketStatus":{"type":"MVPTBActivationStatus","id":10},"backgroundImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":11},"qrCode":{"type":"string","id":12},"fromStopId":{"type":"int32","id":13},"toStopId":{"type":"int32","id":14},"activationCompletionTime":{"type":"int64","id":15},"transitType":{"type":"MVPTBTransitType","id":16}}},"MVPTBActivationsGroup":{"fields":{"priceReference":{"type":"string","id":1},"activations":{"rule":"repeated","type":"MVPTBActivation","id":2}}}}},"Protocol_RideSharing":{"nested":{"MVRSSuperEvent":{"fields":{"superEventId":{"type":"int32","id":1},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":2},"name":{"type":"string","id":3},"details":{"type":"string","id":4},"fromTime":{"type":"int64","id":5},"toTime":{"type":"int64","id":6},"location":{"type":"Protocol_Common.MVLatLon","id":7},"locationDescription":{"type":"string","id":8}}},"MVRSEvent":{"fields":{"superEvent":{"type":"MVRSSuperEvent","id":1},"eventId":{"type":"int32","id":2},"eventTripTime":{"type":"int64","id":3},"vehicleType":{"type":"Protocol_Common.MVVehicleType","id":4},"direction":{"type":"Protocol_Common.MVDirection","id":5},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":6},"name":{"type":"string","id":7},"bucketId":{"type":"int32","id":8}}}}},"Protocol_Search":{"nested":{"MVSearchResponseItemSortingInfo":{"fields":{"score":{"type":"string","id":1},"distance":{"type":"string","id":2},"hits":{"type":"string","id":3},"priority":{"type":"string","id":4}}},"MVSearchResultType":{"values":{"STOP":1,"STREET":2,"SITE":3,"CITY":4,"GEOCODE":5}},"MVSearchResponseItem":{"fields":{"type":{"type":"MVSearchResultType","id":1},"id":{"type":"int32","id":2},"image":{"type":"Protocol_Common.MVImageReferenceWithParams","id":3},"title":{"type":"string","id":4},"subTitle":{"rule":"repeated","type":"Protocol_Common.MVTextOrImage","id":5},"latLon":{"type":"Protocol_Common.MVLatLon","id":6},"sortingInfo":{"type":"MVSearchResponseItemSortingInfo","id":7},"uid":{"type":"string","id":8},"inaccurateLatLon":{"type":"bool","id":9},"geocoderId":{"type":"int32","id":10},"airDistance":{"type":"int32","id":11},"source":{"type":"Protocol_Common.MVSiteSource","id":12},"sourceId":{"type":"int32","id":13},"sourceDesc":{"type":"string","id":14}}},"MVSearchLineGroupSection":{"fields":{"routeTypeId":{"type":"Protocol_Common.MVRouteType","id":1},"agencyId":{"type":"int32","id":2},"items":{"rule":"repeated","type":"Protocol_Common.MVSearchLineGroupItem","id":3}}},"MVSearchResponse":{"fields":{"endIndex":{"type":"int32","id":1},"results":{"rule":"repeated","type":"MVSearchResponseItem","id":2}}},"MVPlaceIdRequest":{"fields":{"placeId":{"type":"string","id":1}}}}},"Protocol_ServiceAlerts":{"nested":{"MVAffectedLine":{"fields":{"lineGroupId":{"type":"int32","id":1},"name":{"type":"string","id":2},"icon":{"type":"Protocol_Common.MVImageReferenceWithParams","id":3}}},"MVServiceStatusCategory":{"values":{"None":0,"Regular":1,"Info":2,"Modified":3,"Critical":4}},"MVServiceStatus":{"fields":{"category":{"type":"MVServiceStatusCategory","id":1},"desc":{"type":"string","id":2}}},"MVLineAlertDigest":{"fields":{"alertIds":{"rule":"repeated","type":"string","id":1},"serviceStatus":{"type":"MVServiceStatus","id":2},"affectedLine":{"type":"MVAffectedLine","id":3}}},"MVServiceAlertDigest":{"fields":{"alertId":{"type":"string","id":1},"serviceStatus":{"type":"MVServiceStatus","id":2},"title":{"type":"string","id":3},"publicationDate":{"type":"int64","id":4},"activeFrom":{"type":"int64","id":5},"activeTo":{"type":"int64","id":6}}},"MVServiceAlertsForAgency":{"fields":{"agencyId":{"type":"int32","id":1},"lineAlerts":{"rule":"repeated","type":"MVLineAlertDigest","id":2},"agencyAlerts":{"rule":"repeated","type":"MVServiceAlertDigest","id":3}}}}},"Protocol_Share":{"nested":{"MVShareEntityLink":{"fields":{"url":{"type":"string","id":1},"displayTitle":{"type":"string","id":2},"displayMessage":{"type":"string","id":3}}},"MVGetShareEntityLinkResponse":{"fields":{"entityLink":{"type":"MVShareEntityLink","id":1}}},"MVGetSharedItineraryResponse":{"fields":{"itinerary":{"type":"Protocol_TripPlannerBySections.MVTripPlanItinerary","id":1},"originalRequest":{"type":"Protocol_TripPlanner.MVTripPlanRequest","id":2},"supplementalData":{"type":"Protocol_Gtfs.MVSupplementalData","id":3}}}}},"Protocol_Taxi":{"nested":{"MVTaxiPriceType":{"values":{"Range":1,"Fix":2,"Metered":3}},"MVTaxiPriceRawData":{"fields":{"price":{"type":"int64","id":1},"upperLimitPrice":{"type":"int64","id":2},"isPriceEstimate":{"type":"bool","id":3},"iso4217AlphabeticCurrencyCode":{"type":"string","id":4}}},"MVTaxiPrice":{"fields":{"price":{"type":"string","id":1},"isRange":{"type":"bool","id":2},"isPromotion":{"type":"bool","id":3},"priceType":{"type":"MVTaxiPriceType","id":4},"isSurge":{"type":"bool","id":5},"surgeUrl":{"type":"string","id":6},"priceRawData":{"type":"MVTaxiPriceRawData","id":7}}},"MVTaxiFabPresentation":{"fields":{"title":{"type":"string","id":1},"titleColor":{"type":"int32","id":2},"icon":{"type":"Protocol_Common.MVImageReferenceWithParams","id":3}}},"MVTaxiFabConfig":{"fields":{"primary":{"type":"MVTaxiFabPresentation","id":1},"secondary":{"type":"MVTaxiFabPresentation","id":2},"promo":{"type":"MVTaxiFabPresentation","id":3},"shouldRequestEta":{"type":"bool","id":4},"alwaysShowFab":{"type":"bool","id":5}}},"MVTaxiSuggestRoutes":{"fields":{"taxiPriceLabel":{"type":"string","id":1},"pickupTimeText":{"type":"string","id":2},"cta":{"type":"string","id":3},"backdropImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":4},"futurePickupTimeText":{"type":"string","id":5},"mapMarker":{"type":"Protocol_Common.MVImageReferenceWithParams","id":6}}},"MVTaxiPopupConfig":{"fields":{"icon":{"type":"Protocol_Common.MVImageReferenceWithParams","id":1},"title":{"type":"string","id":2},"subtitle":{"type":"string","id":3},"cta":{"type":"string","id":4},"promoCode":{"type":"string","id":5}}},"MVTaxiVisibility":{"values":{"ALWAYS":1,"NOT_INSTALLED":2,"PAYMENT_ACCOUNT_CONNECTED":3}},"MVTaxiDashboardConfig":{"fields":{"title":{"type":"string","id":1},"subtitle":{"type":"string","id":2},"cta":{"type":"string","id":3},"alwaysShow":{"type":"bool","id":4},"visibility":{"type":"MVTaxiVisibility","id":5},"host":{"type":"Protocol_Configuration.MVDashboardSection","id":6},"dashboardDeeplink":{"type":"string","id":7}}},"MVTaxiAnimation":{"fields":{"fileName":{"type":"string","id":1}}},"MVTaxiAnimationsConfig":{"fields":{"baseUrl":{"type":"string","id":1},"animations":{"rule":"repeated","type":"MVTaxiAnimation","id":2}}},"MVTaxiMetroConfigurationMetadata":{"fields":{"mainColor":{"type":"int32","id":1},"ctaTextColor":{"type":"int32","id":2},"ctaBackgroundColor":{"type":"int32","id":3},"longImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":4},"shortImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":5},"androidSchema":{"type":"string","id":6},"iosSchema":{"type":"string","id":7},"deepLinkUri":{"type":"string","id":8},"myLocationDeepLinkUri":{"type":"string","id":9},"downloadLink":{"type":"string","id":10},"providerAnalyticName":{"type":"string","id":11},"fab":{"type":"MVTaxiFabConfig","id":12},"suggestRoutes":{"type":"MVTaxiSuggestRoutes","id":13},"popup":{"type":"MVTaxiPopupConfig","id":14},"dashboard":{"type":"MVTaxiDashboardConfig","id":15},"name":{"type":"string","id":16},"paymentContext":{"type":"string","id":17},"polygons":{"rule":"repeated","type":"string","id":18},"pressedColor":{"type":"int32","id":19},"backDropImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":20},"vehicleImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":21},"animations":{"type":"MVTaxiAnimationsConfig","id":22}}},"MVTaxiMetroConfiguration":{"fields":{"taxiId":{"type":"int32","id":1},"metadata":{"type":"MVTaxiMetroConfigurationMetadata","id":2}}}}},"Protocol_TripPlanner":{"nested":{"MVRelativeDirection":{"values":{"Depart":1,"HardLeft":2,"Left":3,"SlightlyLeft":4,"Continue":5,"SlightlyRight":6,"Right":7,"HardRight":8,"CircleClockwise":9,"CircleCounterclockwise":10,"Elevator":11,"UturnLeft":12,"UturnRight":13}},"MVAbsoluteDirection":{"values":{"North":1,"Northeast":2,"east":3,"Southeast":4,"South":5,"Southwest":6,"West":7,"Northwest":8}},"MVWalkingDirection":{"fields":{"relative":{"type":"MVRelativeDirection","id":1},"absolute":{"type":"MVAbsoluteDirection","id":2}}},"MVTimeType":{"values":{"Arrival":1,"Departure":2,"Last":3}},"MVLocationSourceType":{"values":{"LocationSearch":1,"Geocoder":2,"TapOnMap":3,"ExternalRequest":4,"UserLocation":5}},"MVLocationTarget":{"fields":{"location":{"type":"Protocol_Common.MVLocationDescriptor","id":1},"sourceType":{"type":"MVLocationSourceType","id":2}}},"MVTripPlanPref":{"values":{"LeastWalking":1,"Fastest":2,"LeastTransfers":3,"Earliest":4}},"MVTripPlanTransportOptionPref":{"values":{"BICYCLE":1,"SCOOTER":2,"MOPED":3,"CAR":4,"PERSONAL_CAR":5}},"MVMultiModalCarLeg":{"values":{"FIRST":1,"LAST":2}},"MVMultiModalTripData":{"fields":{"carLeg":{"type":"MVMultiModalCarLeg","id":1},"isParkingRequired":{"type":"bool","id":2},"maxRadiusMeters":{"type":"int32","id":3},"maxStops":{"type":"int32","id":4},"minRadiusMeters":{"type":"int32","id":5}}},"MVPersonalPreferences":{"fields":{"isSlowWalking":{"type":"bool","id":1},"maxWalkingMinutes":{"type":"int32","id":2},"isAccessibleRoutes":{"type":"bool","id":3}}},"MVAlgorithmType":{"values":{"FILTER":0,"PREFERRED":1}},"MVTripPlanRequest":{"fields":{"tripPlanPref":{"type":"MVTripPlanPref","id":1},"time":{"type":"int64","id":2},"timeType":{"type":"MVTimeType","id":3},"currentTimeSelected":{"type":"bool","id":4},"routeTypes":{"rule":"repeated","type":"Protocol_Common.MVRouteType","id":5},"fromLocation":{"type":"MVLocationTarget","id":6},"toLocation":{"type":"MVLocationTarget","id":7},"isTest":{"type":"bool","id":8},"isTrainTripPlan":{"type":"bool","id":9},"skipTaxiSearch":{"type":"bool","id":10},"fromLocationDesc":{"type":"string","id":11},"toLocationDesc":{"type":"string","id":12},"transportTypes":{"rule":"repeated","type":"MVTripPlanTransportOptionPref","id":13},"multiModalTripData":{"type":"MVMultiModalTripData","id":14},"addFlexTimeSearch":{"type":"bool","id":15},"personalPreferences":{"type":"MVPersonalPreferences","id":16},"algorithmType":{"type":"MVAlgorithmType","id":17}}}}},"Protocol_TripPlannerBySections":{"nested":{"MVWalkingInstruction":{"fields":{"direction":{"type":"Protocol_TripPlanner.MVWalkingDirection","id":1},"streetName":{"type":"string","id":2},"lengthInMeters":{"type":"double","id":3},"travelTimeInMs":{"type":"int32","id":4},"startLocation":{"type":"Protocol_Common.MVLatLon","id":5}}},"MVTime":{"fields":{"startTime":{"type":"int64","id":1},"endTime":{"type":"int64","id":2},"isRealTime":{"type":"bool","id":3},"staticStartTime":{"type":"int64","id":4},"staticEndTime":{"type":"int64","id":5},"isGmtTime":{"type":"bool","id":6}}},"MVTripPlanShape":{"fields":{"distanceInMeters":{"type":"double","id":1},"polyline":{"type":"string","id":2}}},"MVJourney":{"fields":{"origin":{"type":"Protocol_Common.MVLocationDescriptor","id":1},"dest":{"type":"Protocol_Common.MVLocationDescriptor","id":2}}},"MVWalkLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"walkingInstructoins":{"rule":"repeated","type":"MVWalkingInstruction","id":4}}},"MVPathwayWalkLeg":{"fields":{"time":{"type":"MVTime","id":1},"stopId":{"type":"int32","id":2},"originPathwayId":{"type":"int32","id":3},"destinationPathwayId":{"type":"int32","id":4},"metroId":{"type":"int32","id":5},"destParentStopId":{"type":"int32","id":6}}},"MVWaitToLineLegDepartureTimes":{"fields":{"epochDay":{"type":"int32","id":1},"futureDepartures":{"rule":"repeated","type":"Protocol_LineArrivals.MVArrival","id":2},"stopRealTimeInfo":{"type":"Protocol_LineArrivals.MVStopRealTimeInformation","id":3}}},"MVWaitToLineLeg":{"fields":{"time":{"type":"MVTime","id":1},"waitToLineId":{"type":"int32","id":2},"waitAtStopId":{"type":"int32","id":3},"departOnStopId":{"type":"int32","id":4},"futureDepartureTimes":{"type":"MVWaitToLineLegDepartureTimes","id":5},"serviceAlert":{"type":"Protocol_ServiceAlerts.MVLineAlertDigest","id":6},"waitOnVehicle":{"type":"bool","id":7},"metroId":{"type":"int32","id":8},"waitAtChildStopId":{"type":"int32","id":9},"departOnChildStopId":{"type":"int32","id":10}}},"MVLineLeg":{"fields":{"time":{"type":"MVTime","id":1},"lineId":{"type":"int32","id":2},"stopSequenceIds":{"rule":"repeated","type":"int32","id":3},"shape":{"type":"MVTripPlanShape","id":4},"legFare":{"type":"Protocol_Fare.MVLegFare","id":5},"tripId":{"type":"int64","id":6},"metroId":{"type":"int32","id":7},"tripShortName":{"type":"string","id":8},"shortPlatformMetadata":{"rule":"repeated","type":"Protocol_External.MVShortPlatformMetadata","id":9},"childStopSequenceIds":{"rule":"repeated","type":"int32","id":10}}},"MVMultiLineLeg":{"fields":{"lineLeg":{"type":"MVLineLeg","id":1},"alternativeLines":{"rule":"repeated","type":"int32","id":2}}},"MVTaxiLegCustomDeepLinkParameter":{"fields":{"key":{"type":"string","id":1},"value":{"type":"string","id":2}}},"MVWaitToTaxiLeg":{"fields":{"time":{"type":"MVTime","id":1},"waitAtLocation":{"type":"Protocol_Common.MVLocationDescriptor","id":2},"taxiPrice":{"type":"Protocol_Taxi.MVTaxiPrice","id":3},"approxWaitingSecFromOrdering":{"type":"int32","id":4},"taxiId":{"type":"int32","id":5},"customParameters":{"rule":"repeated","type":"MVTaxiLegCustomDeepLinkParameter","id":6}}},"MVTaxiLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"taxiPrice":{"type":"Protocol_Taxi.MVTaxiPrice","id":4},"approxWaitingSecFromOrdering":{"type":"int32","id":5},"taxiId":{"type":"int32","id":6},"customParameters":{"rule":"repeated","type":"MVTaxiLegCustomDeepLinkParameter","id":7},"deepLinks":{"type":"Protocol_Common.MVExternalAppData","id":8},"taxiProviderName":{"type":"string","id":9}}},"MVCarPoolDetourTPDetails":{"fields":{"detourRelevant":{"type":"bool","id":1},"details":{"type":"Protocol_CarPool.MVCarPoolRideDetourDetails","id":2}}},"MVCarPoolSource":{"values":{"Moovit":1,"Waze":2,"Idfm_klaxit":3,"Idfm_karos":4,"Idfm_blablalines":5,"BlaBla":6}},"MVCarpoolRideAttributes":{"values":{"INSTANT_BOOKING":1}},"MVCarpoolType":{"values":{"ANONYMOUS":1,"SINGLE_DRIVER":2,"NEARBY_DRIVERS":3}},"MVCarpoolRideLeg":{"fields":{"time":{"type":"MVTime","id":1},"driver":{"type":"Protocol_CarPool.MVCarpoolDriver","id":2},"ride":{"type":"Protocol_CarPool.MVRide","id":3},"stops":{"type":"Protocol_CarPool.MVPassengerStops","id":4},"detourDetails":{"type":"MVCarPoolDetourTPDetails","id":5},"carpoolSource":{"type":"MVCarPoolSource","id":6},"deepLink":{"type":"string","id":7},"isEstimatedTimes":{"type":"bool","id":8},"walkingToPickup":{"type":"int32","id":9},"walkingToDestination":{"type":"int32","id":10},"attributes":{"rule":"repeated","type":"MVCarpoolRideAttributes","id":11},"appInstallDeepLink":{"type":"string","id":12},"carpoolType":{"type":"MVCarpoolType","id":13}}},"MVWaitToLineAlternative":{"fields":{"time":{"type":"MVTime","id":1},"waitToLineId":{"type":"int32","id":2},"futureDepartureTimes":{"type":"MVWaitToLineLegDepartureTimes","id":3},"serviceAlert":{"type":"Protocol_ServiceAlerts.MVLineAlertDigest","id":4},"waitOnVehicle":{"type":"bool","id":5}}},"MVWaitToMultiLineLeg":{"fields":{"time":{"type":"MVTime","id":1},"waitAtStopId":{"type":"int32","id":2},"departOnStopId":{"type":"int32","id":3},"multiLinesImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":4},"alternatives":{"rule":"repeated","type":"MVWaitToLineAlternative","id":5},"primaryAlternativeIndex":{"type":"int32","id":6},"metroId":{"type":"int32","id":7},"waitAtChildStopId":{"type":"int32","id":8},"departOnChildStopId":{"type":"int32","id":9}}},"MVLineWithAlternativesLeg":{"fields":{"alternativeLines":{"rule":"repeated","type":"MVLineLeg","id":1},"primaryAlternativeIndex":{"type":"int32","id":2}}},"MVBicycleLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"cyclingInstructions":{"rule":"repeated","type":"MVWalkingInstruction","id":4}}},"MVDocklessDetails":{"fields":{"type":{"type":"Protocol_MapItems.MVDocklessVehicleType","id":1},"id":{"type":"string","id":2},"vehicleName":{"type":"string","id":3},"batteryLevel":{"type":"int32","id":4},"numOfHelmets":{"type":"int32","id":5},"drivingRate":{"type":"string","id":6},"operatorName":{"type":"string","id":7},"largeImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":8},"mapImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":9},"smallImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":10},"operatorId":{"type":"int32","id":11},"serviceId":{"type":"int32","id":12}}},"MVDocklessCarDetails":{"fields":{"id":{"type":"string","id":1},"name":{"type":"string","id":2},"batteryLevel":{"type":"int32","id":3},"numOfSeats":{"type":"int32","id":4},"drivingRate":{"type":"string","id":5},"fuelLevel":{"type":"int32","id":6},"operatorName":{"type":"string","id":7},"largeImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":8},"mapImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":9},"smallImage":{"type":"Protocol_Common.MVImageReferenceWithParams","id":10},"operatorId":{"type":"int32","id":11},"serviceId":{"type":"int32","id":12}}},"MVDocklessInfo":{"fields":{"carDetails":{"type":"MVDocklessCarDetails","id":1},"docklessDetails":{"type":"MVDocklessDetails","id":2}}},"MVMicroMobilityIntegrationItem":{"fields":{"serviceId":{"type":"string","id":1},"itemId":{"type":"string","id":2},"flows":{"rule":"repeated","type":"Protocol_MicroMobility.MVMicroMobilityIntegrationFlow","id":3},"deepLink":{"type":"Protocol_Common.MVExternalAppData","id":4}}},"MVDocklessLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"instructions":{"rule":"repeated","type":"MVWalkingInstruction","id":4},"info":{"type":"MVDocklessInfo","id":5},"deepLink":{"type":"Protocol_Common.MVExternalAppData","id":6},"serviceId":{"type":"int32","id":7},"integrationItem":{"type":"MVMicroMobilityIntegrationItem","id":8}}},"MVBicycleRentalLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"cyclingInstructions":{"rule":"repeated","type":"MVWalkingInstruction","id":4},"originNearbyBicycleStopIds":{"rule":"repeated","type":"int32","id":5},"destNearbyBicycleStopIds":{"rule":"repeated","type":"int32","id":6},"originStopLocation":{"type":"Protocol_Common.MVLocationDescriptor","id":7},"destinationStopLocation":{"type":"Protocol_Common.MVLocationDescriptor","id":8},"integrationItem":{"type":"MVMicroMobilityIntegrationItem","id":9}}},"MVEventLeg":{"fields":{"superEvent":{"type":"Protocol_RideSharing.MVRSSuperEvent","id":1}}},"MVCarLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"instructions":{"rule":"repeated","type":"MVWalkingInstruction","id":4}}},"MVParkingLotInfo":{"fields":{"parkingLotName":{"type":"string","id":1},"location":{"type":"Protocol_Common.MVLatLon","id":2},"parkingLotId":{"type":"string","id":3},"capacity":{"type":"int32","id":4},"deeplinkUrls":{"type":"Protocol_Common.MVExternalAppData","id":5},"operatorName":{"type":"string","id":6},"operatorId":{"type":"int32","id":7},"isWheelchairAccessible":{"type":"bool","id":8},"serviceId":{"type":"int32","id":9}}},"MVParkingLeg":{"fields":{"time":{"type":"MVTime","id":1},"journey":{"type":"MVJourney","id":2},"shape":{"type":"MVTripPlanShape","id":3},"instructions":{"rule":"repeated","type":"MVWalkingInstruction","id":4},"parkingLotInfo":{"type":"MVParkingLotInfo","id":5}}},"MVTripPlanLeg":{"fields":{"walkLeg":{"type":"MVWalkLeg","id":1},"waitToLineLeg":{"type":"MVWaitToLineLeg","id":2},"lineLeg":{"type":"MVLineLeg","id":3},"waitToTaxiLeg":{"type":"MVWaitToTaxiLeg","id":4},"taxiLeg":{"type":"MVTaxiLeg","id":5},"multiLineLeg":{"type":"MVMultiLineLeg","id":6},"carpoolRideLeg":{"type":"MVCarpoolRideLeg","id":7},"pathwayWalkLeg":{"type":"MVPathwayWalkLeg","id":8},"waitToMultiLineLeg":{"type":"MVWaitToMultiLineLeg","id":9},"lineWithAlternarivesLeg":{"type":"MVLineWithAlternativesLeg","id":10},"bicycleLeg":{"type":"MVBicycleLeg","id":11},"bicycleRentalLeg":{"type":"MVBicycleRentalLeg","id":12},"eventLeg":{"type":"MVEventLeg","id":13},"parkingLeg":{"type":"MVParkingLeg","id":14},"docklessLeg":{"type":"MVDocklessLeg","id":15},"carLeg":{"type":"MVCarLeg","id":16}}},"MVGroupType":{"values":{"NONE":1,"NO_GROUPING":2,"LINE_GROUPING":3,"STOP_GROUPING":4}},"MVEmissionLevel":{"fields":{"co2":{"type":"int32","id":1},"color":{"type":"Protocol_Common.MVClientColorScheme","id":2}}},"MVTripPlanItinerary":{"fields":{"guid":{"type":"string","id":1},"sectionId":{"type":"int32","id":2},"groupType":{"type":"MVGroupType","id":3},"groupKey":{"type":"string","id":4},"legs":{"rule":"repeated","type":"MVTripPlanLeg","id":5},"hasPrev":{"type":"bool","id":6},"hasNext":{"type":"bool","id":7},"relevantForRealtime":{"type":"bool","id":8},"isAccessible":{"type":"bool","id":9},"itineraryFare":{"type":"Protocol_Fare.MVItineraryFare","id":10},"weight":{"type":"double","id":11},"hasSecondaryArrivalItinerary":{"type":"bool","id":12},"emissionLevel":{"type":"MVEmissionLevel","id":13},"sectionName":{"type":"string","id":14},"sectionRequestId":{"type":"int32","id":15}}},"MVAdvertismentProvider":{"values":{"BUTTON":1,"FACEBOOOK":2}},"MVTripPlanAdvertisment":{"fields":{"sectionId":{"type":"int32","id":1},"provider":{"type":"MVAdvertismentProvider","id":2}}},"MVTripPlanTodBanner":{"fields":{"sectionId":{"type":"int32","id":1},"isRegistered":{"type":"bool","id":2},"pickupDuration":{"type":"int32","id":3},"rideDuration":{"type":"int32","id":4},"providerCustomerId":{"type":"string","id":5},"taxiId":{"type":"int32","id":6},"approxPickupTime":{"type":"int64","id":7},"price":{"type":"Protocol_Common.MVCurrencyAmount","id":8},"messageTitle":{"type":"string","id":9},"messageSubtitle":{"type":"string","id":10},"messageActionUrl":{"type":"string","id":11},"messageActionText":{"type":"string","id":12},"approxArrivalTime":{"type":"int64","id":13},"bannerId":{"type":"string","id":14}}},"MVSectionType":{"values":{"UNDEFINED":1,"WALK_AND_RIDE":2,"ROUTES_WITH_BIKE":3,"WALK_ONLY":4,"CARPOOL":5,"WHEEL_CHAIR_ACCESSIBLE":6,"ROUTES_WITH_RENTAL_BIKE":7,"ROUTES_WITH_SPECIFIC_AGENCIES":8,"EVENT":9,"MULTI_MODAL":10,"ROUTES_WITH_DOCKLESS":11,"TOD":12,"FLEX_TIME":13,"TO_HUBS":14,"NO_GROUPING":15}},"MVSectionSortType":{"values":{"NO_CLIENT_SORTING":0,"DURATION":1,"PRICE":2,"CO2":3,"LEAST_WALKING":4,"LEAST_TRANSFERS":5,"EARLIEST_DEPARTURE":6,"EARLIEST_ARRIVAL":7}},"MVTripPlanSectionBranding":{"fields":{"bgColor":{"type":"int32","id":1},"nameColor":{"type":"int32","id":2},"backdropImage":{"type":"Protocol_Common.MVImagePackReferenceWithParams","id":3},"logo":{"type":"Protocol_Common.MVImageReferenceWithParams","id":4}}},"MVTripPlanSection":{"fields":{"name":{"type":"string","id":1},"sectionId":{"type":"int32","id":2},"maxItemsToDisplay":{"type":"int32","id":3},"sectionType":{"type":"MVSectionType","id":4},"sortType":{"type":"MVSectionSortType","id":5},"branding":{"type":"MVTripPlanSectionBranding","id":6}}},"MVTripPlanSections":{"fields":{"tripPlanSections":{"rule":"repeated","type":"MVTripPlanSection","id":1},"isOtpRt":{"type":"bool","id":2}}},"MVTripPlanSectionMatchCount":{"fields":{"sectionId":{"type":"int32","id":1},"matchCount":{"type":"int32","id":2}}},"MVTripPlanFlexTimeBanner":{"fields":{"sectionId":{"type":"int32","id":1},"estimatedSaveTime":{"type":"int32","id":2},"time":{"type":"int64","id":3},"timeType":{"type":"Protocol_TripPlanner.MVTimeType","id":4}}},"MVTripPlanItineraryUpdate":{"fields":{"guid":{"type":"string","id":1},"totalTicketPrice":{"type":"Protocol_Common.MVCurrencyAmount","id":2}}},"MVTripPlanSectionedResponse":{"fields":{"itinerary":{"type":"MVTripPlanItinerary","id":1},"tripPlanSections":{"type":"MVTripPlanSections","id":2},"advertisment":{"type":"MVTripPlanAdvertisment","id":3},"sectionMatchCount":{"type":"MVTripPlanSectionMatchCount","id":4},"todBanner":{"type":"MVTripPlanTodBanner","id":5},"flexTimeBanner":{"type":"MVTripPlanFlexTimeBanner","id":6},"itineraryUpdate":{"type":"MVTripPlanItineraryUpdate","id":7}}},"MVLegDynamicData":{"fields":{"time":{"type":"MVTime","id":1},"futureDepartureTimes":{"rule":"repeated","type":"int64","id":2}}},"MVSimilarItineraryResponseBySection":{"fields":{"hasNext":{"type":"bool","id":1},"hasPrev":{"type":"bool","id":2},"legs":{"rule":"repeated","type":"MVLegDynamicData","id":3},"relevantForRealtime":{"type":"bool","id":4}}}}},"Protocol_UserReports":{"nested":{"MVUserReportValue":{"fields":{"category":{"type":"Protocol_Common.MVUserReportCategoryType","id":1},"index":{"type":"int32","id":2},"text":{"type":"string","id":3}}},"MVGetCriticalUserReportsAndAlertsEntityData":{"fields":{"entityIdentidier":{"type":"Protocol_Common.MVEntityIdentifier","id":1},"userReportVals":{"rule":"repeated","type":"MVUserReportValue","id":2},"serviceAlertEffect":{"type":"string","id":3},"lastReportAndAlertTime":{"type":"int64","id":4}}},"MVGetCriticalUserReportsAndAlertsResponse":{"fields":{"data":{"rule":"repeated","type":"MVGetCriticalUserReportsAndAlertsEntityData","id":1}}}}},"Protocol_WebTripPlanner":{"nested":{"MVWebTripPlanErrorCode":{"values":{"OTHER":0,"TRIP_PLAN_OUT_OF_METRO_AREA":2,"NO_GEOCODER_RESULTS":3,"GEOCODER_RESULTS_OUT_OF_METRO_AREA":4,"UNEXPECTED_ERROR_IN_TRIP_PLAN":5,"FUTURE_ITINERARY_NOT_ALLOWED":6,"REMOVE_TRIPS_WITH_TOO_MUCH_WAITING_TIME":7,"LOCATION_NOT_ACCESSIBLE":8,"NO_TRANSIT_TIMES":9,"TOO_CLOSE":10,"NO_TRIP_PLAN_FOUND":11,"NA_CHECKIN":12,"NO_VALID_USER":121212}},"MVWebTripPlanException":{"fields":{"errorCode":{"type":"MVWebTripPlanErrorCode","id":1},"message":{"type":"string","id":2},"trace":{"type":"string","id":3}}},"MVChunkedTripPlanSectionedResult":{"fields":{"result":{"type":"Protocol_TripPlannerBySections.MVTripPlanSectionedResponse","id":1},"supplementalData":{"type":"Protocol_Gtfs.MVSupplementalData","id":2}}},"MVChunkedTripPlanSectionedResults":{"fields":{"results":{"rule":"repeated","type":"MVChunkedTripPlanSectionedResult","id":1},"errors":{"rule":"repeated","type":"MVWebTripPlanException","id":2},"completed":{"type":"bool","id":3}}},"MVAgencyLinesResponse":{"fields":{"lineGroupItems":{"rule":"repeated","type":"Protocol_Common.MVSearchLineGroupItem","id":1},"total":{"type":"int32","id":2}}},"MVSearchLinesResponse":{"fields":{"lineGroupSections":{"rule":"repeated","type":"Protocol_Search.MVSearchLineGroupSection","id":1}}}}}}}'),l=n(72097),c=n.n(l);const d=a.Root.fromJSON(s),u="_privateKey_B2NeZPtj773X";function p(e,t){if(!a.util.isObject(e)&&!Array.isArray(e)||!t)return e;if(Array.isArray(e)&&!a.util.isObject(e[0])&&!Array.isArray(e[0]))return[...e];let n={};return Object.keys(t.fields).filter(t=>t===u||null!=e[t]).forEach(i=>{const r=t.fields[i];if("repeated"===r.rule){const o=t.lookup(r.type);if(i===u){const t=e.map(e=>p(e,o));n={[u]:t}}else n[i]=e[i].map(e=>p(e,o))}else if(r.map)i!==u?n[i]=h(e[i],r):(n={[u]:{}},Object.keys(e).forEach(t=>{const i=h(e[t],r);n[u][t]=i}));else{const o=t.lookup(r.type);n[i]=p(e[i],o)}}),n}function h(e,t){const n=t.parent.lookup(t.type);if(Array.isArray(e))return{[u]:e.map(e=>p(e,n))};{const t={};return Object.keys(e).forEach(i=>{const r=p(e[i],n);t[i]=r}),t}}function m(e){if(!a.util.isObject(e)&&!Array.isArray(e))return e;if(Array.isArray(e))return e.map(e=>m(e&&e[u]?e[u]:e));const t={};return Object.keys(e).forEach(n=>{const i=e[n];t[n]=m(i&&i[u]?i[u]:i)}),t}function g(e,t,n){const i=f(e,t);if(!i)return n;const{message:r,metadata:o}=i,a=r.decode(n);let s=r.toObject(a,{enums:Number,longs:Number,bytes:String,defaults:!1,arrays:!0,objects:!0});return o.shouldEncode&&(s=m(s)),o.decode&&(s=o.decode(s)),s}function f(e,t){const n=function(e){let t=e;return t.includes("?")&&(t=t.split("?")[0]),c()[t]?t:Object.keys(c()).find(t=>{const n=t.replace(/\/:[^?]+\?/g,"(/[^/]+)?").replace(/\/:[^/]+/g,"/[^/]+");return!!e.match(new RegExp(`^${n}$`))})}(e),i=n&&c()[n][t];return i?{message:d.lookup(`${i.namespace}.${i.obj}`),metadata:i}:null}var v=n(2316),y=n(95505),b=n(5971),_=n(5306);const T=["cloudfront-viewer-country"],S=["mv_account"];let x=(()=>{class e{constructor(e,t,n,i){this.httpClient=e,this.routingService=t,this.store=n,this.universal=i}get state(){return this.store.getState()}get(e,t,n=!1){t&&(e=this.applyQuery(e,t)),this.universal.isServer&&(n=!1);const i=this.applyOptions(n);return this.httpClient.get(e,i).pipe(this.decodeResponse(e,n))}post(e,t,n=!1){(null==t?void 0:t.query)&&(e=this.applyQuery(e,t.query)),this.universal.isServer&&(n=!1);let i=null;t&&(i=n?function(e,t,n){const i=f(e,"req");if(!i)return n;const{message:r,metadata:o}=i;let a=n;o.encode&&(a=o.encode(n)),o.shouldEncode&&(a=p(a,r));const s=r.encode(a).finish();return{query:btoa(String.fromCharCode.apply(null,s))}}(e,0,t.body):t.body);const r=this.applyOptions(n);return this.httpClient.post(e,i,r).pipe(this.decodeResponse(e,n))}decodeResponse(e,t){return n=>t?new r.y(t=>{n.subscribe(n=>{const i=g(e,"res",new Uint8Array(n));t.next(i),t.complete()})}):n}getHeaders(e=!1){var t;const n={MOOVIT_APP_TYPE:"WEB_TRIP_PLANNER",MOOVIT_CLIENT_VERSION:`5.93.0/${o.W}`,MOOVIT_PHONE_TYPE:"2"};if(e&&(n.Accept="application/x-protobuf",n["protobuf-version"]="V3"),(null===(t=this.state.user.account)||void 0===t?void 0:t.userKey)&&(n.MOOVIT_USER_KEY=this.state.user.account.userKey),this.state.user.selectedMetro&&(!n.MOOVIT_USER_KEY&&this.state.user.selectedMetro.userKey&&(n.MOOVIT_USER_KEY=this.state.user.selectedMetro.userKey),this.state.user.selectedMetro.metroId&&(n.MOOVIT_METRO_ID=this.state.user.selectedMetro.metroId.toString()),this.state.user.selectedMetro.gtfsLanguage&&(n.MOOVIT_GTFS_LANGUAGE=this.state.user.selectedMetro.gtfsLanguage)),this.state.customer.currentCustomer&&(n.MOOVIT_CUSTOMER_ID=String(this.routingService.getStateFromUrl().customerId||this.state.customer.currentCustomer.id),this.state.customer.currentCustomer.apiKey&&(n.MOOVIT_API_KEY=this.state.customer.currentCustomer.apiKey)),this.universal.isServer){if(this.universal.request.headers)for(const e of T)this.universal.request.headers[e]&&(n[e]=this.universal.request.headers[e]);if(this.universal.request.cookies)for(const e of S)this.universal.request.cookies[e]&&(n[e]=this.universal.request.cookies[e])}return window.rbzid&&(n.rbzid=window.rbzid),new i.WM(n)}applyOptions(e){const t={headers:this.getHeaders(e)};return e&&(t.responseType="arraybuffer"),t}applyQuery(e,t){return e+"?"+this.serialiseQuery(t)}serialiseQuery(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`.replace(/%2C/g,",")).join("&")}}return e.\u0275fac=function(t){return new(t||e)(v.LFG(i.eN),v.LFG(y.Z),v.LFG(b.d),v.LFG(_.p))},e.\u0275prov=v.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},20314:function(e,t,n){"use strict";n.d(t,{y:function(){return _}});var i=n(37349);class r{constructor(){this._data={}}setItem(e,t){return this._data[e]=String(t)}getItem(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}removeItem(e){return delete this._data[e]}clear(){return this._data={}}}function o(e){try{const t=i.i[e];if(t.setItem("storagePolyfillTest","ok"),"ok"!==t.getItem("storagePolyfillTest"))return!1;t.removeItem("storagePolyfillTest")}catch(t){return!1}return!0}i.i._localStorage=o("localStorage")?i.i.localStorage:new r,i.i._sessionStorage=o("sessionStorage")?i.i.sessionStorage:new r;var a=n(59265),s=n(85573),l=n(13691),c=n(2316),d=n(5306),u=n(31861);const p="mv_",h=p+"selected_metro",m=p+"metro_combinations",g=p+"recent_locations",f=p+"lang",v=p+"metro",y=p+"ticket_activation_bus_line_details",b=p+"side_navigation_state";let _=(()=>{class e{constructor(e,t){this.universal=e,this.cookie=t,this.storage=this.universal.isBrowser?window._localStorage:new r}dehydrate(e){this.setItem(h,e.selectedMetro),this.setItem(m,e.metroCombinations)}rehydrate(){return{selectedMetro:this.getItem(h),metroCombinations:this.getItem(m),recentLocations:this.getItem(g)||{},localeId:this.getLocaleId(),metroId:this.getMetroId(),sideNavigationState:(this.getItem(b)||{}).value}}storeRecentLocations(e){this.setItem(g,e)}setUseLocation(e){this.setItem("mv_use_my_location",e)}getLocaleId(){return this.cookie.get(f)}storeLocaleId(e){this.cookie.set(f,e)}getMetroId(){return Number(this.cookie.get(v))}storeMetroId(e){this.cookie.set(v,e.toString())}setSideNavigationState(e){this.setItem(b,{value:e})}getItem(e){const t=this.storage.getItem(e);if(t)try{return JSON.parse(t)}catch(n){return{}}}setItem(e,t){!e||!t||"object"!=typeof t||this.storage.setItem(e,JSON.stringify(t))}checkAccountFootprint(){return!!this.cookie.get(s.y)}setAccountFootprint(){this.cookie.set(s.y,(0,l.Ox)())}storeActiveTrainRideOriginStation(e){this.setItem(a.FA,e)}getActiveRideOriginStation(){return this.getItem(a.FA)}removeActiveRideOriginStation(){this.storage.removeItem(a.FA)}storeActiveTrainRideDestinationStation(e){this.setItem(a.cI,e)}getActiveRideDestinationStation(){return this.getItem(a.cI)}removeActiveRideDestinationStation(){this.storage.removeItem(a.cI)}hideActiveRideOverlay(){this.setItem(a.yZ,{value:!0})}isActiveRideBannerDismissed(){return this.getItem(a.yZ)}storeTicketActivationBusLineDetails(e,t){const n={line:e,activationId:t,date:Date.now()},i=new Date;i.setMonth(-3);const r=(this.getItem(y)||[]).filter(e=>new Date(e.date)>i);r.push(n),this.setItem(y,r)}getTicketActivationBusLineDetails(e){var t;const n=null===(t=this.getItem(y))||void 0===t?void 0:t.find(t=>t.activationId===e);if(null==n?void 0:n.line)return n.line}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(d.p),c.LFG(u.x))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},10723:function(e,t,n){"use strict";n.d(t,{OL:function(){return g}});var i=n(13691),r=n(4008),o=n(2281),a=n(2316),s=n(2339),l=n(95505),c=n(20314),d=n(5306);const u=[{id:"in",name:"Bahasa Indonesia",langId:75,ogLocale:"id_ID",hasBadge:!0,momentId:"id"},{id:"ms",name:"Bahasa Melayu",langId:190,ogLocale:"ms_MY",hasBadge:!0},{id:"nb",name:"Bokm\xe5l",langId:120,ogLocale:"nb_NO",hasBadge:!0},{id:"ca",name:"Catal\xe0",langId:27,ogLocale:"ca_ES",hasBadge:!0},{id:"cs",name:"\u010ce\u0161tina",langId:36,ogLocale:"cs_CZ",hasBadge:!0},{id:"da",name:"Dansk",langId:37,ogLocale:"da_DK",hasBadge:!0},{id:"de",name:"Deutsch",langId:52,hasBadge:!0,featureUrl:"https://moovit.com/de/features-de/",hasCommunityUrl:!0,ogLocale:"de_DE"},{id:"et",name:"Eesti",langId:43,ogLocale:"et_EE",hasBadge:!0},{id:"en",name:"English",langId:41,featureUrl:"https://moovit.com/features/",companyUrl:"https://moovit.com/",ogLocale:"en_US",doNotCopy:!0},{id:"en-gb",name:"English (United Kingdom)",langId:189,featureUrl:"https://moovit.com/features/",companyUrl:"https://moovit.com/",ogLocale:"en_GB",hasBadge:!0},{id:"es",name:"Espa\xf1ol",langId:149,hasBadge:!0,featureUrl:"https://moovit.com/es/features-es/",contactUsUrl:"https://moovit.com/es/contact-us-es/",appSupportUrl:"https://moovitapp.zendesk.com/hc/es/requests/new",newsRoomUrl:"https://moovit.com/es/newsroom-es/",companyUrl:"https://moovit.com/es/",hasCommunityUrl:!0,ogLocale:"es_ES"},{id:"es-419",name:"Espa\xf1ol (Latinoam\xe9rica)",langId:188,hasBadge:!0,featureUrl:"https://moovit.com/es/features-es/",contactUsUrl:"https://moovit.com/es/contact-us-es/",appSupportUrl:"https://moovitapp.zendesk.com/hc/es/requests/new",newsRoomUrl:"https://moovit.com/es/newsroom-es/",companyUrl:"https://moovit.com/es/",hasCommunityUrl:!0,ogLocale:"es_LA",momentId:"es"},{id:"eu",name:"Euskara",langId:18,ogLocale:"eu_ES",hasBadge:!0},{id:"fr",name:"Fran\xe7ais",langId:48,hasBadge:!0,featureUrl:"https://moovit.com/fr/features-fr/",contactUsUrl:"https://moovit.com/fr/contact-us-fr/",appSupportUrl:"https://moovitapp.zendesk.com/hc/fr/requests/new",newsRoomUrl:"https://moovit.com/fr/newsroom-fr/",companyUrl:"https://moovit.com/fr/",hasCommunityUrl:!0,ogLocale:"fr_FR"},{id:"hr",name:"Hrvatski",langId:66,ogLocale:"hr_HR",hasBadge:!0},{id:"it",name:"Italiano",langId:77,hasBadge:!0,featureUrl:"https://moovit.com/it/features-it/",contactUsUrl:"https://moovit.com/it/contact-us-it/",appSupportUrl:"https://moovitapp.zendesk.com/hc/it/requests/new",newsRoomUrl:"https://moovit.com/it/newsroom-it/",companyUrl:"https://moovit.com/it/",hasCommunityUrl:!0,ogLocale:"it_IT"},{id:"lt",name:"Lietuvi\u0173",langId:99,ogLocale:"lt_LT",hasBadge:!0},{id:"hu",name:"Magyar",langId:67,ogLocale:"hu_HU",hasBadge:!0},{id:"nl",name:"Nederlands",langId:39,ogLocale:"nl_NL",hasBadge:!0},{id:"pl",name:"Polski",langId:130,ogLocale:"pl_PL",hasBadge:!0},{id:"pt",name:"Portugu\xeas (Portugal)",langId:191,ogLocale:"pt_PT",featureUrl:"https://moovit.com/pt/features-pt/",contactUsUrl:"https://moovit.com/pt/contact-us-pt/",appSupportUrl:"https://moovitapp.zendesk.com/hc/pt/requests/new",newsRoomUrl:"https://moovit.com/pt/newsroom-pt/",companyUrl:"https://moovit.com/pt",hasBadge:!0},{id:"pt-br",name:"Portugu\xeas",langId:131,hasBadge:!0,featureUrl:"https://moovit.com/pt/features-pt/",contactUsUrl:"https://moovit.com/pt/contact-us-pt/",appSupportUrl:"https://moovitapp.zendesk.com/hc/pt/requests/new",newsRoomUrl:"https://moovit.com/pt/newsroom-pt/",companyUrl:"https://moovit.com/pt",hasCommunityUrl:!0,ogLocale:"pt_BR"},{id:"ru",name:"P\u0443\u0441\u0441\u043a\u0438\u0439",langId:137,hasBadge:!0,hasCommunityUrl:!0,ogLocale:"ru_RU"},{id:"ro",name:"Rom\xe2n\u0103",langId:135,hasBadge:!0,hasCommunityUrl:!0,ogLocale:"ro_RO"},{id:"sr",name:"Srpski",langId:151,ogLocale:"sr_RS",hasBadge:!0},{id:"fi",name:"Suomi",langId:47,ogLocale:"fi_FI",hasBadge:!0},{id:"sk",name:"Slovensk\xfd",langId:141,ogLocale:"sk_SK",hasBadge:!0},{id:"sv",name:"Svenska",langId:155,ogLocale:"sv_SE",hasBadge:!0},{id:"vi",name:"Ti\u1ebfng Vi\u1ec7t",langId:176,ogLocale:"vi_VN",hasBadge:!0},{id:"tr",name:"T\xfcrk\xe7e",langId:169,hasCommunityUrl:!0,ogLocale:"tr_TR",hasBadge:!0},{id:"el",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",langId:57,hasBadge:!0,hasCommunityUrl:!0,ogLocale:"el_GR"},{id:"uk",name:"\u0443\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430 \u043c\u043e\u0432\u0430",hasBadge:!0,langId:172,ogLocale:"uk_UA"},{id:"bg",name:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",langId:25,ogLocale:"bg_BG",hasBadge:!0},{id:"he",name:"\u05e2\u05d1\u05e8\u05d9\u05ea",langId:62,rtl:!0,hasBadge:!0,featureUrl:"https://moovit.com/he/features-he/",contactUsUrl:"https://moovit.com/he/contact-us-he/",appSupportUrl:"https://moovitapp.zendesk.com/hc/he/requests/new",newsRoomUrl:"https://moovit.com/he/newsroom-he/",companyUrl:"https://moovit.com/he/",hasCommunityUrl:!0,ogLocale:"he_IL"},{id:"ar",name:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",langId:8,rtl:!0,ogLocale:"ar_AR",hasBadge:!0},{id:"th",name:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22",langId:162,ogLocale:"th_TH",hasBadge:!0},{id:"ka",name:"\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8",langId:51,ogLocale:"ka_GE",hasBadge:!0},{id:"zh-cn",name:"\u4e2d\u6587 (\u7b80\u4f53)",langId:30,ogLocale:"zh_CN",hasBadge:!0},{id:"zh-tw",name:"\u4e2d\u6587 (\u7e41\u9ad4)",langId:192,ogLocale:"zh_TW",hasBadge:!0},{id:"ko",name:"\ud55c\uad6d\uc5b4",langId:91,ogLocale:"ko_KR",hasBadge:!0},{id:"ja",name:"\u65e5\u672c\u8a9e",langId:79,ogLocale:"ja_JP",hasBadge:!0},{id:"hi",name:"\u0939\u093f\u0928\u094d\u0926\u0940",langId:64,hasBadge:!0,ogLocale:"hi_IN"}],p={};for(const f of u)p[f.id]=f;u.map(e=>e.id);const h={};u.forEach(e=>h[e.id]=e);const m=new Set(["en","en-gb","zh-cn","zh-tw","es","es-419","pt","it","de","ru","el","tr","ms","he","fr"]);let g=(()=>{class e{constructor(e,t,n,i){this.translate=e,this.routingService=t,this.hydrationService=n,this.universal=i}getDefaultLang(){const e=this.routingService.getQueryParam("lang"),t=this.hydrationService.getLocaleId();return this.getLocaleById(e||t||this.getBrowserLocaleId()).id}setupDefaultLang(){this.translate.setDefaultLang(this.getDefaultLang())}getSupportedLocales(){return(0,i.kI)(u)}getBrowserLocaleId(){if(this.universal.isBrowser)return(0,i.Q3)();const e=this.universal.getLocaleFromRequest();if(e){for(const t of e){const e=this.findLocaleById(`${t.code}-${t.region}`);if(e)return e.id}return null}}findLocaleById(e){if(!e)throw new Error("Empty localeId");e=e.toLowerCase();let t=h[e];if(!t){const n=e.split("-");2===n.length&&h[n[0]]&&(t=h[n[0]])}return t}getLocaleById(e){return e||(e=r.k$),this.findLocaleById(e)||h[r.k$]}getSupportedOgLocales(){return u.map(e=>e.ogLocale)}setLocale(e){const t=this.getLocaleById(e);return window.document.querySelector("html").setAttribute("dir",t.rtl?"rtl":"ltr"),this.translate.use(t.id),function(e){return"en"===e?Promise.resolve(e):n(77961)(`./${e}.js`).then(()=>e)}(t.momentId||t.id).then(e=>o.locale(e)),t}isInHouseLanguage(e){return m.has(e)}getCommunityUrl(e){const t=this.getLocaleById(e);return this.generateCommunityUrl(t&&t.hasCommunityUrl?t.id:"en")}generateCommunityUrl(e){let t;t="https://editor.moovitapp.com/web/community";let n=e;return e.indexOf("-")>0&&(n=e.split("-")[0]),t+=`?lang=${n}&campaign=webapp2020`,t}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.sK),a.LFG(l.Z),a.LFG(c.y),a.LFG(d.p))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},26365:function(e,t,n){"use strict";n.d(t,{V:function(){return f}});var i=n(3786),r=n(65492),o=n(99528);class a{constructor(e,t,n){this.name=e,this.translationKey=t,this.routeType=n}static getTranslationKey(e){return Object.values(s).find(t=>t.routeType===e).translationKey}}const s={Bus:new a("bus","transit_type_default_bus",o.HO.Bus),CableCar:new a("cableCar","transit_type_default_cable",o.HO.Cable),Ferry:new a("ferry","transit_type_default_ferry",o.HO.Ferry),Funicular:new a("funicular","transit_type_default_funicular",o.HO.Funicular),Gondola:new a("gondola","transit_type_default_gondola",o.HO.Gondola),Rail:new a("rail","transit_type_default_rail",o.HO.Rail),Subway:new a("subway","transit_type_default_subway",o.HO.Subway),Tram:new a("tram","transit_type_default_tram",o.HO.Tram)};var l=n(4008),c=JSON.parse('{"1":["Israel_Auto_Tel_Circle.png","Israel_Bird_Circle.png","Israel_Dan_Circle.png","Israel_Egged_Circle.png","Israel_Rail_Circle.png","Israel_Tel_O_Fan_Circle.png"],"21":["01_Madrid_EMT_Circle.png","02_Madrid_Metro_de_Madrid_Circle.png","03_Madrid_Renfe_Circle.png","04_Madrid_Metro_Ligero_Circle.png","05_Madrid_Mobike_Circle.png","06_Madrid_Cabify_Circle.png"],"61":["01_Roma_e_Lazio_ATAC_Circle.png","02_Roma_e_Lazio_Cotral_Circle.png","03_Roma_e_Lazio_Zig_Zag_Circle.png","04_Roma_e_Lazio_Mimoto_Circle.png"],"121":["NYC_NJ_City_Circle.png","NYC_NJ_Jump_Circle.png","NYC_NJ_MTA_Circle.png","NYC_NJ_NJTransit_Circle.png","NYC_NJ_Uber_Circle.png"],"223":["01_Milano_e_Lombardia_Trenord_Circle.png","02_Milano_e_Lombardia_Autoguidovie_S.p.A_Circle.png","03_Milano_e_Lombardia_Mobike_Circle.png"],"242":["01_Sao_Paulo_Metro_Circle.png","02_Sao_Paulo_CPTM_Circle.png","03_Sao_Paulo_SPTrans_Circle.png","04_Sao_Paulo_UBER_Circle.png","05_Sao_Paulo_Zazcar_Circle.png","06_Sao_Paulo_BikeSampa_Circle.png"],"322":["rio_de_janeiro_BikeRio_Circle.png","rio_de_janeiro_brt_rio_Circle.png","rio_de_janeiro_CCRBarcas_Circle.png","rio_de_janeiro_metrorio_Circle.png","rio_de_janeiro_supervia_Circle.png","rio_de_janeiro_vlt_carioca_Circle.png"],"362":["01_Barcelona_TMB_Circle.png","02_Barcelona_Metro_Circle.png","03_Barcelona_Rodalies_Circle.png","04_Barcelona_Bicing_Circle.png","05_Barcelona_FGC_Funicular_Circle.png","06_Barcelona_Tram_Circle.png"],"642":["01_Santiago_Uber_Circle.png","02_Santiago_Cabify_Circle.png","03_Santiago_Scoot_Circle.png","05_Santiago_Red_Circle.png","06_Santiago_Mobike_Circle.png"],"662":["paris_Bird_Circle.png","paris_Coup_Circle.png","paris_RATP_Circle.png","paris_Uber_Circle.png","paris_Velib_Circle.png"],"762":["01_Bogota_SITP_Circle.png","02_Bogota_TransMIlenio_Circle.png","03_Bogota_Transmicable_Circle.png","04_Bogota_Uber_Circle.png"],"822":["Ciudad_de_Mexico_Bird_Circle.png","Ciudad_de_Mexico_Metrobus_Circle.png","Ciudad_de_Mexico_Mobike_Circle.png","Ciudad_de_Mexico_STC_Circle.png","Ciudad_de_Mexico_Tren_ligero_Circle.png","Ciudad_de_Mexico_Uber_Circle.png"],"843":["01_Belo_Horizonte_CBTU_Circle.png","02_Belo_Horizonte_Move_Circle.png","03_Belo_Horizonte_BikeBH_Circle.png"],"902":["01_Russia_Mosmetro_Circle.png","02_Russia_Mosgortrans_Circle.png","03_Russia_RZHD_Circle.png","04_Russia_Aeroekspress_Circle.png","05_Russia_Velobayk_Circle.png","06_Russia_Gett_Circle.png"],"964":["01_Porto_Alegre_Trensurb_Circle.png","02_Porto_Alegre_BikePOA_Circle.png"],"1082":["01_Kuala_Lumpur_KTM_Circle.png","02_Kuala_Lumpur_MRT_Circle.png","03_Kuala_Lumpur_Express_Rail_Link_Circle.png","04_Kuala_Lumpur_GoKL_CityBus_Circle.png","05_Kuala_Lumpur_RapidKL_Circle.png","06_Kuala_Lumpur_Grab_Circle.png"],"1102":["01_Lima_Uber_Circle.png","02_Lima_Cabify_Circle.png","03_Lima_Linea1_Circle.png","04_Lima_Metropolitano_Circle.png"],"1563":["01_Istanbul_IETT_Circle.png","02_Istanbul_Sehir_Hatlari.png","03_Istanbul_Marmaray_Circle.png","04_Istanbul_Metrobus_Circle.png","05_Istanbul_Metro_\u0130stanbul_Circle.png","06_Istanbul_Turyol_Circle.png"],"1564":["01_Izmir_Eshot_Circle.png","02_Izmir_IZMIR_METRO_Circle.png","03_Izmir_IZBAN_Circle.png","04_Izmir_IZDENIZ_Circle.png","05_Izmir_TRAM_IZMIR_Circle.png","06_Izmir_TCDD_Circle.png"],"1602":["01_Buenos_Aires_Metrovias_Circle.png","02_Buenos_Aires_Dota_Circle.png","03_Buenos_Aires_Subway_Circle.png","04_Buenos_Aires_Train_Circle.png","05_Buenos_Aires_Ecobici_Circle.png","06_Buenos_Aires_ferrovias_Circle.png"],"1672":["01_Montevideo_Uber_Circle.png","02_Montevideo_STM_Circle.png","03_Montevideo_Movete_Circle.png"],"1678":["01_Singapore_SMRT_Circle.png","02_Singapore_SBS_Transit_Circle.png","03_Singapore_Tower_Transit_Circle.png","04_Singapore_Go_Ahead_Circle.png","05_Singapore_Grab_Circle.png"],"1723":["01_Ankara_EGO_Circle.png","02_Ankara_Ankaray_Circle.png","03_Ankara_Metrosu_Circle.png","04_Ankara_TCDD_Circle.png"],"1822":["01_Greece_OASA_Circle.png","02_Greece_Trainose_Circle.png","03_Greece_Uber_Circle.png","04_Greece_Easybike_Circle.png","05_Greece_cyclopolis_Circle.png","06_Greece_Hive_Circle.png"],"2044":["01_Jakarta_PPD_Circle.png","02_Jakarta_Transjakarta_Circle.png","03_Jakarta_Commuter_Rail_Circle.png","04_Jakarta_Damri_Circle.png","05_Jakarta_Light_Rail_Circle.png","06_Jakarta_MRT_Circle.png"],"2122":["London_and_South_East_London_Underground_Circle.png","London_and_South_East_DLR_Circle.png","London_and_South_East_heathrow_express_Circle.png","London_and_South_East_National_Rail_Circle.png","London_and_South_East_Overground_Circle.png","London_and_South_East_River_Circle.png","London_and_South_East_Tramlink_Circle.png"],"2401":["01_Bangkok_BTS_Circle.png","02_Bangkok_MRTA_Circle.png","03_Bangkok_BMTA_Circle.png","04_Bangkok_Airport_Rail_Link_Circle.png","05_Bangkok_Chao_Phraya_Express_Boat_Circle.png"],"2460":["Lisboa_Carris_Circle.png","Lisboa_CP_Circle.png","Lisboa_eCooltra_Circle.png","Lisboa_Gira_Circle.png","Lisboa_Metropolitano_Lisboa_Circle.png","Lisboa_MTS_Circle.png"],"2741":["01_Hong_Kong_MRT_Circle.png","02_Hong_Kong_KMB_Circle.png","03_Hong_Kong_Citybus_Circle.png","04_Hong_Kong_Hong_Kong_Tramways_Circle.png","05_Hong_Kong_Star_Ferry_Circle.png","06_Hong_Kong_Uber_Circle.png"],"3749":["01_Germany_Rhein_Ruhr_U-bahn_Circle.png","02_Germany_Rhein_Ruhr_S-bahn_Circle.png","03_Germany_Rhein_Ruhr_DB_Circle.png","04_Germany_RheinRuhr_Tram_Circle.png","05_Germany_Rhein_Ruhr_Bus_Circle.png","06_Germany_Rhein_Ruhr_Metropolradruhr_Circle.png"],"3801":["01_Delhi_METRO_Circle.png","02_Delhi_BUS_Circle.png","03_Delhi_RAIL_Circle.png"],"generic":["Generic_Icon_Bike_circle.png","Generic_Icon_Bus_circle.png","Generic_Icon_Cable_circle.png","Generic_Icon_Car_circle.png","Generic_Icon_Moped_circle.png","Generic_Icon_Scooter_circle.png","Generic_Icon_Subway_circle.png","Generic_Icon_Train_circle.png","Generic_Icon_Tram_circle.png","Generic_Icon_Walk_circle.png"]}'),d=n(2316),u=n(99902),p=n(2339),h=n(5971),m=n(5306);const g=["USA","United Kingdom"];let f=(()=>{class e{constructor(e,t,n,i){this.httpService=e,this.translate=t,this.store=n,this.universal=i}get state(){return this.store.getState()}getMetroAreaData(e){return this.httpService.get((0,r.zQ)(r.bl.GetMetro,{metroId:e})).toPromise()}getMetroIdByIpAddress(e=""){return this.universal.isServer&&!e&&(e=this.universal.getIpAddress()),this.httpService.get((0,r.zQ)(r.bl.GetMetroIdByIpAddress,{ipAddress:e})).toPromise()}getCurrentMetroName(){const e=this.state.metro.currentMetroCustomDimensions;return e.localeId===this.state.global.selectedLocale.id&&e.metroLocalizedShortName?e.metroLocalizedShortName:e.metroName}getAllAgencies(){return this.httpService.get(r.bl.GetAgencyOrder,void 0,!0).toPromise().then(e=>e.map(e=>Object.assign(Object.assign({},e),{agencyType:this.getAgencyRouteTypeName(e.routeType)})))}getAgency(e){return this.state.metro.currentMetro?this.state.metro.currentMetro.agencies.find(t=>t.agencyId===e):null}getImageIndexForAgency(e){var t,n;const i=null===(n=null===(t=this.getAgency(e))||void 0===t?void 0:t.presentationLineTemplates)||void 0===n?void 0:n.find(e=>e.presentationType===o.vU.Itinerary);return i?i.imageIndex:null}getAgencyImageId(e){const t=this.getAgency(e);return t?t.image:null}getAgencyRouteTypeName(e){const t=this.state.metro.currentMetro.routeTypes.find(t=>t.routeType===e);return t&&String(t.clientOverrideTextResourceId)||a.getTranslationKey(e)}getMaxFutureDays(e){return(0,i.mG)(this,void 0,void 0,function*(){let t;try{return t=yield this.httpService.get((0,r.zQ)(r.bl.GetMaxFutureDays,{metroId:e})).toPromise(),t.daysAmount}catch(n){return l.ku}})}getStoreLinksByCountry(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.get((0,r.zQ)(r.bl.GetStoreLinksByCountry,{country:e,lang:t})).toPromise()})}getMetroAndMaxFutureDays(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.get((0,r.zQ)(r.bl.GetMetroAndMaxFutureDays,{metroId:e,langId:t})).toPromise()})}getMetroTaxiConfiguration(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.get((0,r.zQ)(r.bl.GetMetroTaxiConfiguration,{metroId:e,userKey:t,langId:n})).toPromise()})}isImperialDistance(){return g.includes(this.state.metro.currentMetro.countryName)}isGoogleLocationSearch(){const e=this.state.customer.currentCustomer.id;return[].includes(this.state.metro.metroId)||[11391,12119,11081,12617,12633,12634,12635,12636,12637,12638,13193].includes(e)}getMetroTransitTypeImages(e){return{metroTransitImagesPaths:this.getTransitImagesPath(c,e),genericTransitImagesPaths:this.getTransitImagesPath(c)}}getTransitImagesPath(e,t){const n=t&&e[t]?t:"generic";return e[n].map(e=>`images/splash/local-icons/${n}/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(u.O),d.LFG(p.sK),d.LFG(h.d),d.LFG(m.p))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},32968:function(e,t,n){"use strict";n.d(t,{W:function(){return s}});var i=n(2316),r=n(86781),o=n(1437);const a=(0,r.hu)("MobileService");let s=(()=>{class e{constructor(e){this.analyticsService=e,this.keyboardEvent=new i.vpe,this.isKeyboardOpen=!1,this.originalSize=window.outerWidth+window.outerHeight}init(){window.addEventListener("resize",this.onWindowResize.bind(this))}onWindowResize(){const e=window.outerWidth,t=window.outerHeight;this.isKeyboardOpen=e+t<this.originalSize-50,this.isKeyboardOpen||this.analyticsService.trackScreenOrientation(),this.keyboardEvent.emit(this.isKeyboardOpen),a.log("onWindowResize",this.isKeyboardOpen)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(o.y))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},31251:function(e,t,n){"use strict";n.d(t,{h:function(){return p},$:function(){return m}});var i=n(3786),r=n(79489),o=n(39935),a=n(86781),s=n(36179),l=n(2316),c=n(21090),d=n(1437);const u=(0,a.hu)("PermissionService"),p="mv_location_permission",h="mv_orientation_permission";let m=(()=>{class e{constructor(e,t){this.dialogService=e,this.analyticsService=t}requestLocation(e){return(0,i.mG)(this,void 0,void 0,function*(){if(navigator.permissions){const{state:e}=yield navigator.permissions.query({name:"geolocation"});if("granted"===e)return!0}const t=this.getStoredState(p);if("boolean"==typeof t)return t;const n=this.dialogService.create(r._,{width:"calc(100% - 30px)",maxWidth:"320px",data:{subtitle:null==e?void 0:e.subtitle}});this.analyticsService.trackOpenedMoovitLocationPopup();const i=yield n.onClose.toPromise();if(this.analyticsService.trackPermission("Location dialog",i),this.setStoredState(p,String("allow"===i)),"allow"===i)try{return yield this.getLocation(),this.analyticsService.trackPermission("Location native","allow"),!0}catch(o){return this.analyticsService.trackPermission("Location native","deny"),!1}return!1})}requestOrientation(){return(0,i.mG)(this,void 0,void 0,function*(){if("function"!=typeof DeviceMotionEvent.requestPermission)return!0;const e=this.getStoredState(h);if("boolean"==typeof e)return e;const t=yield this.dialogService.create(o.E,{width:"calc(100% - 30px)",maxWidth:"320px"}).onClose.toPromise();if(this.analyticsService.trackPermission("Orientation dialog",t),this.setStoredState(h,String("allow"===t)),"allow"===t){const e=yield DeviceMotionEvent.requestPermission();return this.analyticsService.trackPermission("Orientation native","granted"===e?"allow":"deny"),"granted"===e}return!1})}setStoredState(e,t){localStorage.setItem(e,JSON.stringify({state:t,timestamp:Date.now()}))}getStoredState(e){try{const t=localStorage.getItem(e);if(!t)return null;const n=JSON.parse(t);return Date.now()-18e5>=(null==n?void 0:n.timestamp)?(localStorage.removeItem(e),null):"true"===(null==n?void 0:n.state)}catch(t){return null}}getLocation(e){const t=(0,s.gn)()?"(iOS)":"";return u.log("Retrieving location...",t),new Promise((t,n)=>navigator.geolocation.getCurrentPosition(t,n,e)).then(e=>(u.log("Location retrieved",t),e)).catch(e=>{throw u.log("Location retrieval failed",t,e),e})}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(c.x),l.LFG(d.y))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},5242:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var i=n(2316),r=n(31861);const o="cookieconsent_status";let a=(()=>{class e{constructor(e){this.cookie=e}getPrivacyConsent(e=o){return!!this.cookie.get(e)}setPrivacyConsent(e=o){this.cookie.set(e,"dismiss",{expiryInMinutes:525600})}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(r.x))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},95505:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(43999),r=n(55754),o=n(13691),a=n(2316),s=n(54364),l=n(5306),c=n(46934);let d=(()=>{class e{constructor(e,t,n,r,o){this.router=e,this.activatedRoute=t,this.location=n,this.universal=r,this.customerRuntimeService=o,this.shouldTriggerPopstateListener=!1,this.didHaveNavigationEnd=!1,this.callbacks={NavigationStart:[],NavigationEnd:[]},this.pathParams=[],this.onBackForwardCallback=()=>{},this.onFirstNavigationEndCallback=e=>{},e.events.subscribe(e=>{e instanceof i.OD&&this.triggerNavigationStartEvents(e),e instanceof i.gk&&(this.shouldTriggerPopstateListener=!1),e instanceof i.OD&&"popstate"==e.navigationTrigger?this.shouldTriggerPopstateListener=!0:e instanceof i.OD&&(this.shouldTriggerPopstateListener=!1),e instanceof i.m2&&this.triggerNavigationEndEvents(e),e instanceof i.jw&&(this.pathParams=Object.assign(Object.assign({},this.pathParams),e.snapshot.params))})}get whitelistedParams(){const e=["id_token","ref","isSSRVsNext"],t=this.customerRuntimeService.getDynamicUrlParams(),n=Object.entries(t).map(e=>e[0]),i=Object.entries(t).filter(e=>!!e[1]).map(e=>e[0]);return e.push(...this.customerRuntimeService.isPrivateHost()?i:n),e}triggerNavigationStartEvents(e){this.callbacks.NavigationStart.forEach(t=>t(e,this.currentRouteRaw))}triggerNavigationEndEvents(e){this.callbacks.NavigationEnd.forEach(t=>t(e,this.currentRouteRaw)),this.didHaveNavigationEnd||(this.didHaveNavigationEnd=!0,this.onFirstNavigationEndCallback(e)),this.shouldTriggerPopstateListener&&this.onBackForwardCallback()}onBackForward(e){this.onBackForwardCallback=e}onNavigationStart(e){this.callbacks.NavigationStart.push(e)}onNavigationEnd(e){this.callbacks.NavigationEnd.push(e)}onFirstNavigationEnd(e){this.onFirstNavigationEndCallback=e}getCurrentRouteSnapshot(){let e=this.activatedRoute.snapshot;for(;e.firstChild;)e=e.firstChild;return e}getCurrentRoute(){return this.getCurrentRouteSnapshot().routeConfig}getCurrentRouteData(){return this.getCurrentRouteSnapshot().data}getFullUrl(){return location.href}get currentRouteRaw(){return this.router.url.split("?")[0].replace(/^\//g,"")}getStateFromUrl(){return this.parseStateFromUrl(Object.assign(Object.assign({},this.activatedRoute.snapshot.queryParams),this.mapPathToQueryParams(this.pathParams)))}mapPathToQueryParams(e){const t={lang:e.lang,lineShortName:e.lineShortName,lgid:e.lineGroupId,lid:e.lineId};if(e["metroSeoName-:metroId"]){const n=e["metroSeoName-:metroId"].split("-");t.metroSeoName=n[0],t.metroId=n[1]}return t}parseFromTo(e){const t=this.pathParams.dirA,n=this.pathParams.dirB;let i=e.from,r=e.to;return t&&n&&("f"===n?i=t:("t"===n||(i=n),r=t)),{from:i,to:r}}parseStateFromUrl(e){const{from:t,to:n}=this.parseFromTo(e);return{customerId:e.customerId,from:(0,o.tL)(t),to:(0,o.tL)(n),fromLatLng:r._.parse(e.fll),toLatLng:r._.parse(e.tll),utmSource:e.utm_source,utmMedium:e.utm_medium,t:parseInt(e.t,10),origin:parseInt(e.o,10),referral:parseInt(e.ref,10),poiType:e.poiType,metroId:parseInt(e.metroId,10),city:e.city,lang:e.lang,lineGroupId:parseInt(e.lgid,10),lineId:parseInt(e.lid,10),lineName:(0,o.tL)(e.lineShortName),stopId:parseInt(e.sid,10),stopIndex:parseInt(e.sidx,10),toStopId:parseInt(e.tsid,10),fromStopId:parseInt(e.fsid,10),dayOffset:parseInt(e.dayOffset,10),alertIds:e.alertIds,etype:e.etype,eid:e.eid,stepIndex:parseInt(e.stepIndex,10),time:parseInt(e.time,10),timeType:e.timeType,routeTypes:e.routeTypes?e.routeTypes.split(","):[],automationIsEuCountry:e.automationIsEuCountry?"true"===e.automationIsEuCountry:null,ipAddress:e.ipAddress,isSSRVsNext:e.isSSRVsNext,todRideId:e.todRideId,todProviderId:e.todProviderId,searchTextFrom:e.searchTextFrom,searchTextTo:e.searchTextTo,motMode:e.motMode,motView:e.motView,seoAbTest:e.abTest}}getQueryParams(){return Object.assign({},this.activatedRoute.snapshot.queryParams)}getFullQueryParams(e){const t=this.activatedRoute.snapshot.queryParams;return e=Object.assign({},e)||{},this.whitelistedParams.forEach(n=>e[n]=e[n]||t[n]),e}getAllQueryParams(){const e=new URLSearchParams(this.universal.getUrlSearchString());return this.parseStateFromUrl(new Proxy(e,{get:(e,t)=>e.get(t)}))}getQueryParam(e){return this.getAllQueryParams()[e]}redirectTo(e,t,n,i={}){const r={queryParams:this.getFullQueryParams(t)};let o=[];return e&&!Array.isArray(e)?o=[e]:e&&(o=[...e]),r.replaceUrl=!!n,i.relativeTo&&(r.relativeTo=i.relativeTo),this.router.navigate(o,r)}redirectToPreserveParams(e,t={}){const n={queryParamsHandling:"merge",queryParams:t};let i=[];e&&!Array.isArray(e)?i=[e]:e&&(i=[...e]),this.router.navigate(i,n)}redirectBack(){this.location.back()}updateUrlParams(e,t,n=null){return t||(e=Object.assign(Object.assign({},this.activatedRoute.snapshot.queryParams),e)),Object.keys(e).forEach(t=>{""===e[t]&&delete e[t]}),this.redirectTo(n,e,!0)}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(i.F0),a.LFG(i.gz),a.LFG(s.Ye),a.LFG(l.p),a.LFG(c.c))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1:function(e,t,n){"use strict";n.d(t,{W:function(){return s}});var i=n(2316),r=n(5971),o=n(2339),a=n(87897);let s=(()=>{class e{constructor(e,t,n){this.store=e,this.translate=t,this.urlGeneratorService=n,this.accessibilityStatementCounties=["Israel"],this.sideMenuExpendableItems=[{id:"supported_countries",label:"about_supported_countries",link:()=>this.urlGeneratorService.getCountriesUrl()},{id:"webapp",label:"web_hierarchy_footer_webapp",link:()=>this.urlGeneratorService.getWebAppUrl()}]}get state(){return this.store.getState()}get currentCountryName(){const e=this.store.getState();return e.metro&&e.metro.currentMetro&&e.metro.currentMetro.countryName}get currentLocale(){return this.state.global.selectedLocale||{}}getSideMenuItems(){return[{id:"about",label:"about_title",svgIcon:"images/icons/icon-info.svg",link:()=>this.currentLocale.companyUrl||"https://moovit.com/",subtitle:"smart_transit_suite_label"},{id:"press",label:"news_label",svgIcon:"images/nav-icons/press_icon.svg",link:()=>this.currentLocale.newsRoomUrl||"https://moovit.com/newsroom/",subtitle:"blog_case_press_label"},{id:"community",label:"community_label",svgIcon:"images/nav-icons/community_icon.svg",link:()=>this.urlGeneratorService.getCommunityUrl(),subtitle:"mapping_transportation_label"},{id:"support",label:"app_support_label",svgIcon:"images/nav-icons/envelope_icon.svg",link:()=>this.currentLocale.appSupportUrl||"https://moovitapp.zendesk.com/hc/en-us/requests/new"}]}getSideMenuMinimalItems(){var e;const t=[{id:"supported_countries",label:"about_supported_countries",link:()=>this.urlGeneratorService.getCountriesUrl()},{id:"terms",label:"terms_of_service_link",link:()=>this.translate.instant("terms_of_use_url")},{id:"privacy",label:"privacy_text",link:()=>this.translate.instant("privacy_url")},{id:"contact-us",label:"contact_us",link:()=>this.currentLocale.contactUsUrl||"https://moovit.com/contact-us/"}];return(this.accessibilityStatementCounties.includes(this.currentCountryName)||(null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.isEuMetro))&&t.push({id:"accessibility",label:"a11y_accessibility_statement",link:()=>this.translate.instant(this.state.metro.currentMetro.isEuMetro?"accessibility_statement_url_eu":"accessibility_statement_url")}),t}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(r.d),i.LFG(o.sK),i.LFG(a.o))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},7935:function(e,t,n){"use strict";n.d(t,{Y:function(){return u}});var i=n(2316),r=n(36179),o=n(4008),a=n(51063),s=n(1437),l=n(1238),c=n(5971),d=n(31861);let u=(()=>{class e{constructor(e,t,n,r){this.analyticsService=e,this.globalActions=t,this.store=n,this.cookie=r,this.onDismiss=new i.vpe,this.scrollToTop=()=>{this.state.global.splashScreen||(window.scrollTo(0,0),this.removeListenerOfScrollToTop())},this.onDismiss.subscribe(()=>{var e;this.store.dispatch(this.globalActions.setSplashScreen(!1)),(null===(e=this.state.global.featureFlags.showSplashOnEveryVisit)||void 0===e?void 0:e.isActive)||this.cookie.set(o._n,"true",{expiryInMinutes:60})})}get state(){return this.store.getState()}invokeDismissal(e="splash_scroll"){if(!this.state.global.splashScreen||this.inProgress)return;this.inProgress=!0,this.analyticsService.trackClickToWebApp(e,(0,r.gn)()?"Apple":"Google");const t=(0,a.V)("data-splash",document);t&&"frozen"===t&&document.getElementsByClassName("app-container")[0].classList.add("splash-dismissed"),window.scrollTo({top:window.innerHeight,behavior:"smooth"}),window.addEventListener("scroll",this.scrollToTop),setTimeout(()=>this.onDismiss.emit(),500)}removeListenerOfScrollToTop(){window.removeEventListener("scroll",this.scrollToTop)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(s.y),i.LFG(l.l),i.LFG(c.d),i.LFG(d.x))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},27091:function(e,t,n){"use strict";n.d(t,{V:function(){return c}});var i=n(3786),r=n(65492),o=n(86781),a=n(2316),s=n(99902);const l=(0,o.hu)("StopService");let c=(()=>{class e{constructor(e){this.httpService=e,this.stops=new Map,this.bicycleStops=new Map,this.bicycleStopsMetadata=new Map}getStopById(e){return(0,i.mG)(this,void 0,void 0,function*(){if(this.stops.has(e))return l.log(`getStopById: getting stop location for ${e} from cache`),this.stops.get(e);l.log(`getStopById: getting stop location for ${e} from server`);try{const t=yield this.httpService.post(r.ZP.GetStopDetails,{body:{id:e}},!0).toPromise();return l.log(`getStopById: Storing stop location for ${e} in cache`),this.stops.set(e,t),t}catch(t){return l.error(`getStopById: could not get stop data for ${e}: ${t}`),null}})}getBicycleStopById(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=[],n=[];if(e.forEach(e=>{const i=this.bicycleStops.get(e);i?t.push(i):n.push(e)}),!n.length)return t;try{(yield this.httpService.post(r.ZP.GetBicycleStop,{body:{ids:e}}).toPromise()).forEach(e=>{this.bicycleStops.set(e.stopId,e),t.push(e)})}catch(i){l.error(`getBicycleStopById: could not get bicycle stop data for ${e}: ${i}`)}return t})}getBicycleStopsDetailsByIds(e,t){return(0,i.mG)(this,void 0,void 0,function*(){const n=[],i=[];if(e.forEach(e=>{const t=this.bicycleStopsMetadata.get(e.stopId);t?n.push(t):i.push(e)}),!i.length)return n;try{(yield this.httpService.post(r.ZP.GetMicroMobilityBikesStopsData,{body:{bicycleStops:i,metroId:t}}).toPromise()).forEach(e=>{this.bicycleStopsMetadata.set(e.stopId,e),n.push(e)})}catch(o){l.error(`getBicycleStopById: could not get bicycle stop data for ${i.map(e=>e.stopId)}: ${o}`)}return n})}getBicycleStopsRealTimeInfo(e){return this.httpService.post(r.ZP.GetBicycleStopsRealTimeInfo,{body:{ids:e}}).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.O))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},85431:function(e,t,n){"use strict";n.d(t,{N:function(){return d}});var i=n(56147),r=n.n(i),o=n(13691),a=n(17184),s=n(2316),l=n(5971);function c(e,t){return e.split(".").reduce((e,t)=>e[t],t)}let d=(()=>{class e{constructor(e){this.store=e,this.registry={},e.subscribe(()=>{for(const e in this.registry){const t=this.registry[e],n=c(t.target,this.store.getState());!r()(n,t.previousValue)&&(t.callback(n,t.previousValue),t.previousValue=n)}})}get state(){return this.store.getState()}subscribe(e,t){const n=(0,o.Ox)();return this.registry[n]={target:e,previousValue:c(e,this.store.getState()),callback:t},()=>{delete this.registry[n]}}get shouldShowDepartureOptions(){return!!this.state.directions.suggestedRoutes.sections.length||this.state.directions.suggestedRoutes.isRerunningSearch||!!this.state.directions.suggestedRoutes.error}get shouldShowTimeSelectors(){const e=this.state.directions.search.departureOption;return e==a.IV.Depart||e==a.IV.Arrive}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(l.d))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},31861:function(e,t,n){"use strict";n.d(t,{x:function(){return u}});var i=n(2316),r=n(54364),o=n(71570),a=n(55013),s=n(19723),l=n(86781),c=n(2281);const d=(0,l.hu)("UniversalCookieService");let u=(()=>{class e{constructor(e,t,n,i){this.request=e,this.response=t,this.platformId=n,this.transferState=i}get(e){const t=(0,o.Cb)(e);if((0,r.PM)(this.platformId)&&this.request){const n=this.request.cookies[e];return d.log("get",this.platformId,{key:e,data:n}),this.transferState.set(t,n),n}if(this.transferState.hasKey(t)){const n=this.transferState.get(t,null);return d.log("get",this.platformId,"transferState",{key:e,data:n}),n}const n=s.get(e);return d.log("get",this.platformId,"clientCookie",{key:e,data:n}),n}set(e,t,n={}){const i=this.resolveCookieOptions(n);d.log("set",this.platformId,{key:e,value:t,cookieOptions:i}),(0,r.PM)(this.platformId)&&this.response?this.response.cookie(e,t,i):s.set(e,t,i)}resolveCookieOptions(e){const t={};return e.expiryInMinutes&&(t.expires=c().add(e.expiryInMinutes,"m").toDate()),t}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(a.Z,8),i.LFG(a.Y,8),i.LFG(i.Lbi),i.LFG(o.ki))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},13438:function(e,t,n){"use strict";n.d(t,{u:function(){return f}});var i=n(3786),r=n(16438),o=n(85547),a=n(4008),s=n(43445),l=n(2316),c=n(71570),d=n(2339),u=n(26365),p=n(5971),h=n(95505),m=n(10723),g=n(12646);let f=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this.title=e,this.meta=t,this.translate=n,this.metroService=i,this.store=r,this.routingService=o,this.localeService=a,this.hookService=s,this.universalPreload=l}get state(){return this.store.getState()}refreshMeta(){var e;return(0,i.mG)(this,void 0,void 0,function*(){if(null===(e=this.state.customer.currentCustomer.designConfiguration)||void 0===e?void 0:e.disableMeta)return void this.translate.get("web_payment_mot_rides_qr_header").toPromise().then(()=>{this.hookService.runHooks(s.e.META_ON_DISABLED,this)});yield this.universalPreload.init();const{titleKey:t,descriptionKey:n,params:i,metaImage:r,metaOgSiteName:o}=yield this.getMetaData(),[a,l]=yield Promise.all([this.translate.get(t,i).toPromise(),this.translate.get(n,i).toPromise()]);this.title.setTitle(a),this.meta.updateTag({name:"description",content:l}),this.meta.updateTag({property:"og:title",content:a}),this.meta.updateTag({property:"og:description",content:l}),this.meta.updateTag({property:"og:image",content:r}),this.meta.updateTag({property:"og:type",content:"website"}),this.meta.updateTag({property:"og:site_name",content:o||"Moovit"});const c=this.state.global.selectedLocale.ogLocale;this.meta.removeTag(`content='${c}'`),this.meta.updateTag({property:"og:locale",content:c});const d=this.localeService.getSupportedOgLocales().filter(e=>e!=c);for(const e of d)this.meta.updateTag({property:"og:locale:alternate",content:e},`content='${e}'`)})}getMetaData(){var e,t,n;return(0,i.mG)(this,void 0,void 0,function*(){const i=(null===(e=this.state.customer.currentCustomer)||void 0===e?void 0:e.ogImage)||"https://moovitapp.com/images/moovit-for-web.jpg",s=(null===(t=this.state.customer.currentCustomer)||void 0===t?void 0:t.ogImage)||"https://moovitapp.com/images/meta_image_moovit_lines.jpg",l=(null===(n=this.state.customer.currentCustomer)||void 0===n?void 0:n.ogImage)||"https://moovitapp.com/images/meta_image_moovit_alerts.jpg",c=this.routingService.getStateFromUrl(),d=this.state.customer.currentCustomer.designConfiguration;if(null==d?void 0:d.ogTitle){const e={titleKey:null==d?void 0:d.ogTitle,metaImage:i};return(null==d?void 0:d.ogDescription)&&(e.descriptionKey=null==d?void 0:d.ogDescription),(null==d?void 0:d.ogSitename)&&(e.metaOgSiteName=null==d?void 0:d.ogSitename),e}if(this.state.global.selectedTab===r.TF.LINES){let e;return this.universalPreload.lineGroup?e=this.universalPreload.lineGroup:c&&c.lineName&&(e={lineGroupId:null,title:null,lineNumber:c.lineName,agencyName:null,agencyRouteType:null,color:null,imageHtml:null}),e?e.agencyName&&e.agencyRouteType?{titleKey:"web_line_specific_meta_title",descriptionKey:"web_page_agency_lines_meta_description",params:{LINE_NUMBER:e.lineNumber,AGENCY:e.agencyName,TRANSIT_TYPE:yield this.translate.get(this.metroService.getAgencyRouteTypeName(e.agencyRouteType)).toPromise(),CITY:this.metroService.getCurrentMetroName()},metaImage:s}:{titleKey:"web_line_specific_meta_title_without",descriptionKey:"web_page_agency_lines_meta_description_without",params:{LINE_NUMBER:e.lineNumber,CITY:this.metroService.getCurrentMetroName()},metaImage:s}:{titleKey:"web_page_tripplanner_meta_title",descriptionKey:"web_page_tripplanner_meta_description",metaImage:s}}if(this.state.global.selectedTab===r.TF.TRIPPLAN){if(this.state.metro&&this.state.metro.currentMetro){let e="";const t=yield Promise.all(this.state.metro.currentMetro.routeTypes.map(e=>this.translate.get((0,o.GT)(e.clientOverrideTextResourceId)).toPromise()));if(e=1===t.length?t[0]:`${t.slice(0,t.length-1).join(", ")} ${yield this.translate.get("tripplan_itinerary_alt_route_divide_label").toPromise()} ${t[t.length-1]}`,c.from||c.to){let t,n;if(t=c.from===a.Ok?(yield this.translate.get("current_location").toPromise()).toLowerCase():c.from,n=c.to===a.Ok?(yield this.translate.get("current_location").toPromise()).toLowerCase():c.to,c.from&&c.to)return{titleKey:"web_directions_destination_meta_title_webapp",descriptionKey:"web_directions_destination_meta_description_webapp",params:{ORIGIN:t,DESTINATION:n,TRANSIT_TYPES:e,CITY:this.metroService.getCurrentMetroName()},metaImage:i}}return{titleKey:"splash_popular_app_city",descriptionKey:"local_mobility_options_test",params:{CITY:this.metroService.getCurrentMetroName()},metaImage:i}}return{titleKey:"web_hierarchy_meta_title",descriptionKey:"web_hierarchy_meta_description",metaImage:i}}return this.state.global.selectedTab===r.TF.ALERTS?{titleKey:"web_page_tripplanner_alerts_meta_title",descriptionKey:"web_page_tripplanner_alerts_meta_description",metaImage:l}:{titleKey:"web_hierarchy_meta_title",descriptionKey:"web_hierarchy_meta_description",metaImage:i}})}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(c.Dx),l.LFG(c.h_),l.LFG(d.sK),l.LFG(u.V),l.LFG(p.d),l.LFG(h.Z),l.LFG(m.OL),l.LFG(s.$),l.LFG(g.k))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},12646:function(e,t,n){"use strict";n.d(t,{k:function(){return m}});var i=n(3786),r=n(52959),o=n(71570),a=n(65492),s=n(2316),l=n(95505),c=n(99902),d=n(803),u=n(5306),p=n(5971);const h=(0,o.Cb)("preloadLineGroup");let m=(()=>{class e{constructor(e,t,n,i,r,o){this.routingService=e,this.httpService=t,this.converters=n,this.universal=i,this.transferState=r,this.store=o}get state(){return this.store.getState()}init(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.universal.isServer){const e=this.routingService.getStateFromUrl();e.lineGroupId&&!this.loadedLineGroup&&(yield(0,r.p5)(this.store),this.loadedLineGroup=yield this.getInitialLineData(e.lineGroupId),this.transferState.set(h,this.loadedLineGroup))}this.universal.isBrowser&&(this.loadedLineGroup=this.transferState.get(h,null))})}get lineGroup(){return this.loadedLineGroup?this.loadedLineGroup:this.state.line.selectedLine?this.state.line.lineGroup:null}getInitialLineData(e){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.httpService.get((0,a.zQ)(a.bl.GetInitialLineData,{lineGroupId:e})).toPromise();return this.converters.convertMVLineGroupDataToLineGroupData(e,t)})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(l.Z),s.LFG(c.O),s.LFG(d.J),s.LFG(u.p),s.LFG(o.ki),s.LFG(p.d))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},5306:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var i=n(2316),r=n(55013),o=n(54364),a=n(5982),s=n(2433),l=n(72406),c=n(71570);n(70457);const d=(0,c.Cb)("backend");let u=(()=>{class e{constructor(e,t,n,i,r,o){this.request=e,this.response=t,this.platformId=n,this.universalEnv=i,this.universalCache=r,this.transferState=o,this.syncBackendState()}get isUniversal(){return s.N.production}get isServer(){return(0,o.PM)(this.platformId)}get isBrowser(){return(0,o.NF)(this.platformId)}get cache(){return this.isServer?this.universalCache:null}get localAddress(){return this.universalEnv.localAddress}syncBackendState(){this.isServer?this.transferState.set(d,function(e,t=null){return process.env[e]?process.env[e]:t}("NODE_ENV","dev")):this.isBrowser&&(this.backend=this.transferState.get(d,""))}getIpAddress(){const e=this.request.headers["x-forwarded-for"];return e?e.split(",")[0]:this.request.connection.remoteAddress}getCountryCode(){return this.isServer&&this.request.headers["cloudfront-viewer-country"]||null}getLocaleFromRequest(){const e=this.request.headers["accept-language"];return e?(0,l.Q)(e):null}getUrlSearchString(){return this.isServer?parseUrl(this.request.url).search:window.location.search}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(r.Z,8),i.LFG(r.Y,8),i.LFG(i.Lbi),i.LFG(a.fs,8),i.LFG(a.CN,8),i.LFG(c.ki))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},87897:function(e,t,n){"use strict";n.d(t,{g:function(){return d},o:function(){return u}});var i=n(3786),r=n(36179),o=n(2316),a=n(2339),s=n(26365),l=n(99902),c=n(5971),d=(()=>{return(e=d||(d={}))[e.AppleStore=0]="AppleStore",e[e.GooglePlay=1]="GooglePlay",d;var e})();let u=(()=>{class e{constructor(e,t,n,i){this.translate=e,this.metroService=t,this.httpService=n,this.store=i,this.motBannerData={1:{he:encodeURI("https://moovit.com/he/\u05ea\u05e9\u05dc\u05d5\u05de\u05d9\u05dd-\u05ea\u05d7\u05d1\u05d5\u05e8\u05d4-\u05e6\u05d9\u05d1\u05d5\u05e8\u05d9\u05ea/"),en:encodeURI("https://moovit.com/payment-public-transport-en/")}}}get state(){return this.store.getState()}getLocale(){return this.state.global.selectedLocale}getAppStoreURL(){var e;return(0,i.mG)(this,void 0,void 0,function*(){const t=null===(e=this.state.metro.currentMetro)||void 0===e?void 0:e.countryName;return this.metroService.getStoreLinksByCountry(t,this.state.global.selectedLocale.id)})}get appStoreUrl(){const e=this.state.global.appStoreUrl;return(0,r.gn)()?e.iosAppURL:e.googleAppURL}generateBadgeUrl(e,t,n=!1){return n&&t==d.AppleStore?`images/store-buttons/locales/app-store-white/app_store_badge_${e}.svg`:("en"===e?"images/store-buttons/":"images/store-buttons/locales/")+(t===d.AppleStore?"app_store_badge_":"google_play_badge_")+e+(t==d.AppleStore?".svg":".png")}getBadge(e,t=!1){const n=this.state.global.selectedLocale;return this.generateBadgeUrl(n&&n.hasBadge?n.id:"en",e,t)}getInsightsUrl(){const e=this.getLocale(),t="https://moovitapp.com/insights/";return e?`${t}${e.id}/${this.translate.instant("web_page_city_meta_title")}-countries`:t}getCommunityUrl(){const e=this.getLocale();return this.generateCommunityUrl(e&&e.hasCommunityUrl?e.id:"en")}generateCommunityUrl(e){let t="https://editor.moovitapp.com/web/community",n=e;return e.indexOf("-")>0&&(n=e.split("-")[0]),t+=`?lang=${n}&campaign=webapp2020`,t}getCountriesUrl(){const e=this.getLocale(),t="https://moovitapp.com/index/";return e?`${t}${e.id}/${this.normalize(this.translate.instant("web_page_public_transit"))}-countries`:t}urlData(){return{metroId:this.state.metro.currentMetro.metroAreaId,metroName:this.state.metro.currentMetro.metroAreaName,locale:this.getLocale()}}getWebAppUrl(){const e=this.urlData();let t="https://moovitapp.com/";return e.locale&&e.metroName&&(t=`https://moovitapp.com/${e.metroName}-${e.metroId}/poi/${e.locale.id}`),t}normalize(e,t=!1){let n=encodeURI(e.trim().replace(/[-.,'?&/#:\s]/g,"_").replace(/_+$/,""));return n=t?n.replace(/_+/g,"_"):n,n}getMotBannerLink(){var e;const t=null===(e=this.state.global.selectedLocale)||void 0===e?void 0:e.id,n=this.motBannerData[this.state.metro.metroId];let i=null;return n&&(i=n[t]&&n[t]||n.en),i}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.sK),o.LFG(s.V),o.LFG(l.O),o.LFG(c.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},621:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var i=n(65492),r=n(70457),o=n(2316),a=n(99902),s=n(5306);let l=(()=>{class e{constructor(e,t){this.httpService=e,this.universal=t}generateUser(e,t,n){return this.httpService.post(i.bl.GenerateUser,{query:{customerId:e,langId:t,metroId:n}}).toPromise()}getCombinedUser(e,t,n){const o=this.universal.getCountryCode();if(this.universal.cache){const i=this.universal.cache.get(r.B.CombinedUser,[e,t,n,o]);if(i)return Promise.resolve(i)}return this.httpService.post(i.bl.CombinedUser,{body:{customerId:e,langId:t,metroId:n,countryCode:o}},!1).toPromise().then(i=>(this.universal.cache&&this.universal.cache.set({entry:r.B.CombinedUser,params:[e,t,n,o],value:i,ttlSeconds:21600}),i))}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.O),o.LFG(s.p))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},42118:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var i=n(54364),r=(n(99642),n(31127),n(19581),n(17857),n(60778),n(90248),n(91547),n(87479)),o=(n(79223),n(47111),n(2316));n(71570);var a=n(2339),s=(n(74874),n(86607),n(20785),n(56329),n(39885),n(32066)),l=(n(93975),n(46461),n(82601)),c=(n(79489),n(39935),n(38037),n(53448));n(89458),n(97192);let d=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[i.ez,l.U8,c.u5,a.aw.forChild(),r._J,s.iu.forChild()]]}),e})()},20702:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var i=(()=>{return(e=i||(i={})).QrScanner="QrScanner",e.SuggestedLines="SuggestedLines",e.SearchLines="SearchLines",e.SelectStop="SelectStop",e.TicketDetails="TicketDetails",i;var e})()},3307:function(e,t,n){"use strict";n.d(t,{C:function(){return _}});var i=n(3786),r=n(88826),o=n(2316),a=n(21090),s=n(78146),l=n(54364),c=n(87479),d=n(79223),u=n(2339);function p(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",6),o.NdJ("click",function(){return o.CHM(e),o.oxw().back()}),o._UZ(1,"svg-icon",7),o.ALo(2,"translate"),o.qZA()}2&e&&(o.xp6(1),o.uIk("alt",o.lcZ(2,1,"a11y_back_button")))}function h(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",8),o.NdJ("click",function(){return o.CHM(e),o.oxw().retry()}),o._uU(1),o.qZA()}if(2&e){const e=o.oxw();o.xp6(1),o.Oqu(e.errorContent.button)}}let m=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.elementRef=t,this.a11y=n}ngOnInit(){this.elementRef.nativeElement.setAttribute("aria-modal","true"),this.elementRef.nativeElement.setAttribute("role","dialog")}ngAfterViewChecked(){var e;null===(e=this.elementRef.nativeElement)||void 0===e||e.focus()}get errorContent(){return this.dialogRef.data.errorContent}get imageSrc(){return this.errorContent.imageSrc||"images/tickets/spot-web-warning.svg"}get showRetry(){return this.dialogRef.data.hasRetryButton}get showBack(){return this.dialogRef.data.hasBackButton}retry(){this.dialogRef.close("retry")}back(){this.dialogRef.close("back")}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.z),o.Y36(o.SBq),o.Y36(s.F))},e.\u0275cmp=o.Xpm({type:e,selectors:[["mv-tickets-error"]],decls:8,vars:10,consts:[["class","back-button","tabindex","0",3,"click",4,"ngIf"],[1,"error-body",3,"ngClass"],[1,"error-icon",3,"src"],[1,"error-header",3,"innerHTML"],[1,"error-text",3,"innerHTML"],["class","pango-button",3,"click",4,"ngIf"],["tabindex","0",1,"back-button",3,"click"],["src","images/tickets/pango-back-arrow.svg",1,"error-icon"],[1,"pango-button",3,"click"]],template:function(e,t){1&e&&(o.YNc(0,p,3,3,"button",0),o.TgZ(1,"div",1),o._UZ(2,"svg-icon",2),o._UZ(3,"h2",3),o.ALo(4,"safeHtml"),o._UZ(5,"p",4),o.ALo(6,"safeHtml"),o.qZA(),o.YNc(7,h,2,1,"button",5)),2&e&&(o.Q6J("ngIf",t.showBack),o.xp6(1),o.Q6J("ngClass",t.errorContent.klass),o.xp6(1),o.Q6J("src",t.imageSrc),o.xp6(1),o.Q6J("innerHTML",o.lcZ(4,6,t.errorContent.title||""),o.oJD),o.xp6(2),o.Q6J("innerHTML",o.lcZ(6,8,t.errorContent.text||""),o.oJD),o.xp6(2),o.Q6J("ngIf",t.showRetry))},directives:[l.O5,l.mk,c.bk],pipes:[d.z,u.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.cdk-overlay-pane{height:100%}mv-tickets-error{background-color:#fff;width:100vw;height:100%;display:flex;flex-direction:column;padding:0 36px}mv-tickets-error .back-button{padding:20px;position:absolute}html[dir=ltr] mv-tickets-error .back-button{left:0}html[dir=rtl] mv-tickets-error .back-button{right:0}html[dir=rtl] mv-tickets-error .back-button svg{transform:scaleX(-1)}mv-tickets-error .back-button:focus svg-icon{outline:auto}mv-tickets-error .back-button .error-icon,mv-tickets-error .back-button .error-icon svg{width:1.4117647059rem;height:1.4117647059rem}mv-tickets-error .error-body{width:100%;text-align:center;margin:56px auto 0;flex-grow:1;padding:0}mv-tickets-error .error-body.rides-history .error-icon{width:179px;height:135px}mv-tickets-error .error-body .error-icon{width:96px;height:96px}mv-tickets-error .error-body .error-header{font-size:1.2352941176rem;letter-spacing:normal;line-height:1.33;color:#000;font-weight:bold;margin:32px 0 0}mv-tickets-error .error-body .error-text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000;margin:12px 0 0}mv-tickets-error .pango-button{margin-bottom:36px;font-size:1.1764705882rem;line-height:1.6;font-weight:600;border-radius:24px;background-color:#306cea;color:#fff;padding:8px 24px;width:100%}mv-tickets-error .pango-button.disabled,mv-tickets-error .pango-button:disabled{background-color:#83bbff;color:#fff}mv-tickets-error .pango-button:focus{outline:2px solid #000}\n"],encapsulation:2}),e})();var g=n(4008),f=n(86781),v=n(1437),y=n(5971);const b=(0,f.hu)("TicketErrorService");let _=(()=>{class e{constructor(e,t,n,i,r){this.dialogService=e,this.translate=t,this.analyticsService=n,this._zone=i,this.store=r}displayError(e,t,n,r,o,a,s){return(0,i.mG)(this,void 0,void 0,function*(){let i="Unknown error";const l=102007===(null==r?void 0:r.code)||102014===(null==r?void 0:r.code);l||102009===(null==r?void 0:r.code)?i=`${l?"did_not_find_station":"wrong_transit_type_location"}, \n        ${l?o:""}`:r&&(i=JSON.stringify(r)),this.analyticsService.trackMotEvent("error_reason",i,""),b.error(`displayError: ${i}`);const c=yield this._zone.run(()=>this.dialogService.create(m,{data:{errorContent:Object.assign(Object.assign({},this.getErrorContent(e,r)),{imageSrc:a,klass:s}),hasRetryButton:!!t,hasBackButton:!!n}})).onClose.toPromise();"retry"===c&&t&&(this.analyticsService.trackMotEvent("error_action","try_again",""),t()),"back"===c&&n&&n()})}getErrorContent(e,t){if(t&&(t.title||t.text))return{title:t.title,text:t.text,button:this.translate.instant("action_try_again")};if(e===r.Y.Train)return{title:this.translate.instant("payment_mot_train_no_location_error_title"),text:this.translate.instant("payment_mot_train_no_location_error_subtitle"),button:this.translate.instant("action_try_again")};{const{title:e,text:t}=this.defaultErrorMessage;return{title:e,text:t,button:this.translate.instant("action_try_again")}}}get defaultErrorMessage(){var e,t;return g.MC===(null===(t=null===(e=this.store.getState().customer)||void 0===e?void 0:e.currentCustomer)||void 0===t?void 0:t.id)?{title:this.translate.instant("pango_general_error_title"),text:this.translate.instant("pango_general_error_subtitle")}:{title:this.translate.instant("generic_error_title"),text:this.translate.instant("generic_error_text")}}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(a.x),o.LFG(u.sK),o.LFG(v.y),o.LFG(o.R0b),o.LFG(y.d))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},59265:function(e,t,n){"use strict";n.d(t,{FA:function(){return c},cI:function(){return d},yZ:function(){return u},wP:function(){return p}});var i=n(3786),r=n(65492),o=n(88826),a=n(2316),s=n(99902),l=n(21090);const c="mv_active_ride_origin",d="mv_active_ride_DESTINATION",u="mv_hide_active_ride_banner";let p=(()=>{class e{constructor(e,t){this.httpService=e,this.dialogService=t}getStationInfo(e,t,n){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.GetStationInfo,{body:{latitude:e,longitude:t,transitType:n}}).toPromise()})}setActivationByLocation(e,t,n,o){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.SetActivationByLocation,{body:{latitude:e,longitude:t,numberOfTickets:n,transitType:o}}).toPromise()})}finishTrainEstimatedPrice(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.FinishTrainEstimatedPrice,{body:{latitude:e,longitude:t}}).toPromise()})}finishTrainActivation(e,t,n,o){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.FinishTrainActivation,{body:{latitude:e,longitude:t,fromStopId:n,priceReference:o}}).toPromise()})}getCurrentActivations(){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.GetCurrentActivations).toPromise()})}getHistoricalActivations(){return(0,i.mG)(this,void 0,void 0,function*(){return this.httpService.post(r.ZP.GetHistoricalActivations).toPromise()})}getNearestLines(e,t,n,i,o){return this.httpService.post(r.ZP.GetSuggestedLines,{body:{latLng:e,agencyId:t,metroId:n,revisionNumber:i,timeZoneOffset:o}}).toPromise()}getBusActivationPrices(e,t){return this.httpService.post(r.ZP.GetBusActivationPrice,{body:{qrCode:e,location:t}}).toPromise()}setBusActivationPrice(e,t,n){return this.httpService.post(r.ZP.SetBusActivationPrice,{body:{context:e,codePrice:t,discountRegionId:n}}).toPromise()}getActiveRide(){return(0,i.mG)(this,void 0,void 0,function*(){const e=yield this.getCurrentActivations();if(e&&e.activations){const t=e.activations.filter(e=>e.activations[0].ticketStatus===o.pF.ACTIVE);return t.length?t[0]:null}})}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.O),a.LFG(l.x))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},88826:function(e,t,n){"use strict";n.d(t,{o0:function(){return o},Y:function(){return a},nC:function(){return s},eb:function(){return l},pF:function(){return c},gP:function(){return d},Q9:function(){return u},RN:function(){return p},ml:function(){return h},Xl:function(){return m},bH:function(){return g}});var i=n(85978),r=n(99528),o=(()=>{return(e=o||(o={})).ShowQrCode="ticket",e.SkipActiveRideAndShowTransitTypeSelection="transitTypeSelection",e.DestinationStationLocatingStep="destinationStationLocating",o;var e})(),a=(()=>{return(e=a||(a={})).Bus="bus",e.Train="train",a;var e})();const s={[a.Bus]:null,[a.Train]:i.Y5.OriginStationLocating};var l=(()=>((l||(l={})).BoardingPass="BoardingPass",l))(),c=(()=>{return(e=c||(c={}))[e.ACTIVE=1]="ACTIVE",e[e.COMPLETED=2]="COMPLETED",e[e.HISTORICAL=3]="HISTORICAL",c;var e})(),d=(()=>{return(e=d||(d={}))[e.CityBus=1]="CityBus",e[e.InterBus=2]="InterBus",e[e.CityShuttleBus=3]="CityShuttleBus",e[e.InterShuttleBus=4]="InterShuttleBus",e[e.CityLightRail=5]="CityLightRail",e[e.CityLightRailStation=6]="CityLightRailStation",e[e.TrainStation=7]="TrainStation",e[e.CarmelitLightRail=8]="CarmelitLightRail",e[e.ExpressCableCar=9]="ExpressCableCar",d;var e})(),u=(()=>{return(e=u||(u={})).Bus="Bus",e.Train="Train",e.Carmelit="Carmelit",e.Metronit="Metronit",e.LightRail="LightRail",e.Rachbalit="Rachbalit",u;var e})();const p={[d.CityBus]:u.Bus,[d.InterShuttleBus]:u.Bus,[d.CityShuttleBus]:u.Bus,[d.InterBus]:u.Bus,[d.TrainStation]:u.Train,[d.CarmelitLightRail]:u.Carmelit,[d.ExpressCableCar]:u.Rachbalit,[d.CityLightRail]:u.LightRail,[d.CityLightRailStation]:u.LightRail},h={[i.ue.Train]:r.HO.Rail,[i.ue.Carmelit]:r.HO.Cable,[i.ue.LightRail]:r.HO.Tram,[i.ue.Rachbalit]:r.HO.Cable},m="light_train",g=8e3},16086:function(e,t,n){"use strict";n.d(t,{i:function(){return An}});var i=n(3786),r=n(2281),o=n.n(r),a=n(88826),s=n(54364),l=n(52959),c=n(2316),d=n(5306),u=n(59265),p=n(5971),h=n(26365),m=n(27091),g=n(5527),f=n(23137),v=n(71570),y=n(2339),b=n(1437),_=n(3307),T=n(90248),S=n(32066),x=n(87479),w=n(93975),k=n(85978),M=n(86781),A=n(20314),I=n(38037),E=n(79223);function C(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",24),c.TgZ(1,"div",18),c.TgZ(2,"p",13),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"p",25),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.TgZ(8,"button",26),c.NdJ("click",function(){return c.CHM(e),c.oxw().dismissActiveRideBanner()}),c._uU(9),c.ALo(10,"translate"),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.ekj("hidden",!e.showActiveRideBanner),c.xp6(3),c.Oqu(c.lcZ(4,5,"payment_mot_train_active_banner_title")),c.xp6(3),c.Oqu(c.lcZ(7,7,"payment_mot_train_active_banner_sub")),c.xp6(3),c.Oqu(c.lcZ(10,9,"got_it"))}}function D(e,t){1&e&&c.GkF(0)}function P(e,t){1&e&&c.GkF(0)}function O(e,t){1&e&&c.GkF(0)}function N(e,t){1&e&&c.GkF(0)}function R(e,t){1&e&&c.GkF(0)}const $=function(){return{isOrigin:!1}},Y=function(e){return{isOrigin:!1,stationName:e}};function F(e,t){if(1&e&&(c.TgZ(0,"div",28),c.YNc(1,N,1,0,"ng-container",16),c.TgZ(2,"div",29),c.YNc(3,R,1,0,"ng-container",16),c.qZA(),c.qZA()),2&e){const e=c.oxw(2),t=c.MAs(39),n=c.MAs(37);c.Q6J("ngClass",e.headerType),c.xp6(1),c.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",c.DdM(5,$)),c.xp6(2),c.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",c.VKq(6,Y,e.destinationStationName))}}const B=function(e){return{isOrigin:e}},U=function(e){return{isOrigin:!0,stationName:e}},Z=function(e,t){return{isOrigin:!1,stationName:e,hide:t}};function j(e,t){if(1&e&&(c.TgZ(0,"div",27),c.TgZ(1,"div",28),c.YNc(2,D,1,0,"ng-container",16),c.TgZ(3,"div",29),c.YNc(4,P,1,0,"ng-container",16),c.YNc(5,O,1,0,"ng-container",16),c.qZA(),c.qZA(),c.YNc(6,F,4,8,"div",30),c.qZA()),2&e){const e=c.oxw(),t=c.MAs(39),n=c.MAs(37);c.ekj("history",e.isHistoryScreen)("train",e.transitType===e.MOTTransitType.Train),c.xp6(1),c.Q6J("ngClass",e.headerType),c.xp6(1),c.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",c.VKq(12,B,!!e.originStationName)),c.xp6(2),c.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",c.VKq(14,U,e.originStationName)),c.xp6(1),c.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",c.WLB(16,Z,e.destinationStationName,!!e.originStationName)),c.xp6(1),c.Q6J("ngIf",e.headerType===e.HeaderType.Trip&&e.isHistoryScreen)}}function V(e,t){if(1&e&&(c.TgZ(0,"div",31),c._UZ(1,"div",32),c.ALo(2,"safeHtml"),c.TgZ(3,"div",33),c.TgZ(4,"span",34),c._uU(5),c.qZA(),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("innerHTML",c.lcZ(2,2,e.busLineDetails.imageHtml),c.oJD),c.xp6(4),c.Oqu(e.busLineDetails.title)}}function H(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",39),c.TgZ(1,"button",26),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).finishRideCallback()}),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()}2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"payment_mot_train_end_ride")))}const G=function(){return{width:168,margin:0}};function z(e,t){if(1&e&&(c.TgZ(0,"div",35),c.TgZ(1,"div",36),c._uU(2),c.ALo(3,"translate"),c.qZA(),c._UZ(4,"mv-qr-display",37),c.ALo(5,"translate"),c.YNc(6,H,4,3,"div",38),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.hij("",c.lcZ(3,5,e.qrSectionKeys.subtitle)," "),c.xp6(2),c.s9C("altText",c.lcZ(5,7,"a11y_mot_qr_image")),c.Q6J("data",e.activation.qrCode)("options",c.DdM(9,G)),c.xp6(2),c.Q6J("ngIf",e.finishRideCallback&&e.transitType===e.MOTTransitType.Train)}}function q(e,t){if(1&e&&(c.TgZ(0,"p",44),c._uU(1),c.ALo(2,"currency"),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Oqu(c.Dn7(2,1,e.pricingData.fullPrice,e.pricingData.currencyCode,"symbol"))}}function J(e,t){if(1&e&&(c.TgZ(0,"p"),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.Oqu(e)}}function W(e,t){if(1&e&&(c.TgZ(0,"div",45),c.YNc(1,J,2,1,"p",46),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",e.discountReasons)}}function Q(e,t){if(1&e&&(c.TgZ(0,"div",18),c.TgZ(1,"div",40),c.YNc(2,q,3,5,"p",41),c.TgZ(3,"p",42),c._uU(4),c.ALo(5,"currency"),c.qZA(),c.qZA(),c.YNc(6,W,2,1,"div",43),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.Q6J("ngIf",e.pricingData.fullPrice),c.xp6(2),c.Oqu(c.Dn7(5,3,e.pricingData.discountPrice,e.pricingData.currencyCode,"symbol")),c.xp6(2),c.Q6J("ngIf",e.pricingData.discountReason)}}function K(e,t){1&e&&(c.TgZ(0,"div",18),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_mot_train_permit_fare_tbd")))}function X(e,t){if(1&e&&(c.TgZ(0,"div",47),c.TgZ(1,"div",13),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",18),c._uU(5),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.Oqu(c.lcZ(3,2,"mot_profile_label")),c.xp6(3),c.Oqu(e.activation.profileName)}}function ee(e,t){1&e&&c.GkF(0)}function te(e,t){1&e&&c.GkF(0)}function ne(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"div",49),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",50),c._uU(5),c.qZA(),c.qZA()),2&e){const e=c.oxw(),t=e.isOrigin,n=e.stationName;c.ekj("origin",t)("destination",!t),c.xp6(2),c.Oqu(c.lcZ(3,6,t?"payment_mot_entrance_entry_station_tab":"payment_mot_exit_station_tab")),c.xp6(3),c.Oqu(n)}}function ie(e,t){if(1&e&&c.YNc(0,ne,6,8,"div",48),2&e){const e=t.hide;c.Q6J("ngIf",t.stationName&&!e)}}function re(e,t){1&e&&(c.TgZ(0,"div",51),c._UZ(1,"div",52),c._UZ(2,"svg-icon",53),c._UZ(3,"div",54),c.qZA())}function oe(e,t){if(1&e&&(c.TgZ(0,"div",18),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e){const e=c.oxw(3);c.xp6(1),c.hij(" ",c.xi3(2,1,"payment_mot_passenger_distance",e.radiusParam)," ")}}function ae(e,t){if(1&e&&(c.TgZ(0,"div",56),c.TgZ(1,"div",13),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.YNc(4,oe,3,4,"div",14),c.qZA()),2&e){const e=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"payment_mot_distance")),c.xp6(2),c.Q6J("ngIf",e.activation.codePrice.radius)}}function se(e,t){if(1&e&&c.YNc(0,ae,5,4,"div",55),2&e){const e=t.show,n=c.oxw();c.Q6J("ngIf",n.transitType!==n.MOTTransitType.Train&&e)}}const le=function(e){return{TRANSIT_TYPE:e}},ce=function(e){return{show:e}},de=(0,M.hu)("TicketDetailsComponent");var ue=(()=>{return(e=ue||(ue={})).Origin="Origin",e.Destination="Destination",e.Trip="Trip",ue;var e})();let pe=(()=>{class e{constructor(e,t,n,i,r,o,s,l,c){this.imageService=e,this.metroService=t,this.ticketActions=n,this.store=i,this.translate=r,this.ticketService=o,this.hydrationService=s,this.title=l,this.analyticsService=c,this.isHistoryScreen=!1,this.MOTTransitType=a.Q9,this.HeaderType=ue,this.transitTypeTranslatePrefix={[a.Q9.Carmelit]:"carmelit",[a.Q9.LightRail]:a.Xl,[a.Q9.Train]:"train",[a.Q9.Bus]:"bus",[a.Q9.Metronit]:"metronit",[a.Q9.Rachbalit]:"rachbalit"}}ngOnInit(){let e;if(this.initTransitType(),this.isHistoryScreen)e="ride_details_activity_title";else switch(this.transitType){case a.Q9.Bus:this.busLineDetails=this.hydrationService.getTicketActivationBusLineDetails(this.activation.activationId),e="payment_select_transit_bus_title";break;case a.Q9.Carmelit:e="payment_select_transit_only_carmelit_title";break;case a.Q9.Train:e="payment_select_transit_train_title";break;case a.Q9.LightRail:e="payment_select_transit_light_rail_title";break;case a.Q9.Metronit:this.busLineDetails=this.hydrationService.getTicketActivationBusLineDetails(this.activation.activationId),e="payment_select_transit_metronit_title";break;case a.Q9.Rachbalit:e="payment_select_transit_rachbalit_title";break;default:e="payment_select_transit_bus_title",de.error(`ngOnInit: Couldn't find transit type, transitType: ${this.transitType}`)}this.title.setTitle(this.translate.instant(e));let t=this.transitTypeTranslatePrefix[this.transitType];this.transitType===a.Q9.Train&&(t=this.destinationStationName?`${t}_exit`:`${t}_entry`),this.analyticsService.trackMotEvent("MOT_ticket_detail",`${t}, ${this.state.data.fromActiveRide?"active_ride":"new_ride"}, ${this.activation.activationId}`,"")}initTransitType(){this.transitType=a.RN[this.activation.transitType],void 0===this.transitType&&(this.transitType=a.Q9.Bus,de.error(`initTransitType: Couldn't find transit type, transitType: ${this.activation.transitType}`))}get state(){return this.store.getState().ticket}get activation(){if(this.activationGroup)return this.activationGroup.activations[0]}get headerType(){return this.originStationName&&this.destinationStationName?ue.Trip:this.originStationName?ue.Origin:ue.Destination}get reference(){const e=this.activationGroup.priceReference;return e.slice(e.length-20)}get formattedActivationTime(){return r(this.activation.activationTime).format("HH:mm DD/MM/YYYY")}get pricingData(){if(!this.completedRide&&this.state.data.trainType===k.ue.Train&&!this.state.data.destinationStationData)return null;const e=this.activation.codePrice;return e?{discountPrice:e.price.balance/100,discountReason:e.discountResons?e.discountResons.filter(e=>e).join(", "):null,fullPrice:e.fullPrice&&e.fullPrice.balance!==e.price.balance?e.fullPrice.balance/100:null,currencyCode:e.price.currencyCode}:null}get completedRide(){return!this.state.data.fromActiveRide||!!this.activation.activationCompletionTime}get discountReasons(){var e,t;if(!(null===(t=null===(e=this.activation.codePrice)||void 0===e?void 0:e.discountResons)||void 0===t?void 0:t.length))return null;const n=new Set;return this.activation.codePrice.discountResons.forEach(e=>n.add(e)),n}get radiusParam(){return{param1:this.translate.instant("units_kilometers_frac_short",{param1:this.activation.codePrice.radius/1e3})}}get qrSectionKeys(){return this.transitType!==a.Q9.Train?{title:"payment_registration_validate_phone_number_title",subtitle:"payment_mot_save_qr_for_inspection"}:{title:this.destinationStationName?"payment_mot_train_permit_exit_qr_title":"payment_mot_train_permit_entry_qr_title",subtitle:this.destinationStationName?"payment_mot_train_qr_exit_hint":"payment_mot_train_qr_entrance_hint"}}get agencyData(){return{name:this.activation.agencyName,id:this.activation.agencyId}}get showActiveRideBanner(){return!this.hydrationService.isActiveRideBannerDismissed()&&this.state.data.trainType===k.ue.Train}dismissActiveRideBanner(){this.hydrationService.hideActiveRideOverlay()}contactSupport(){let e,t="";this.isHistoryScreen?e="ride_history_action":this.transitType===a.Q9.Carmelit?(e="carmelit_ride_QR_action",t=`, ${this.activation.activationId}`):this.transitType===a.Q9.Rachbalit?(e="rachbalit_ride_QR_action",t=`, ${this.activation.activationId}`):this.transitType===a.Q9.LightRail?(e="light_train_ride_QR_action",t=`, ${this.activation.activationId}`):this.transitType===a.Q9.Bus||this.transitType===a.Q9.Metronit?e="bus_ride_QR_action":this.transitType===a.Q9.Train&&(this.originStationName&&!this.destinationStationName?(e="train_ride_QR_entrance_action",t=`, ${this.activation.activationId}`):!this.originStationName&&this.destinationStationName&&(e="train_ride_QR_exit_action")),this.analyticsService.trackMotEvent(e,`contact_support${t}`,"")}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(S.KD),c.Y36(h.V),c.Y36(g.Q),c.Y36(p.d),c.Y36(y.sK),c.Y36(u.wP),c.Y36(A.y),c.Y36(v.Dx),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-ticket-details"]],inputs:{originStationName:"originStationName",destinationStationName:"destinationStationName",activationGroup:"activationGroup",finishRideCallback:"finishRideCallback",isHistoryScreen:"isHistoryScreen"},decls:42,vars:37,consts:[["class","active-ride-message",3,"hidden",4,"ngIf"],[1,"header"],[1,"agency-info"],[1,"agency-icon"],[3,"imageId","imageAlt"],[1,"agency-name"],[1,"date-time"],["class","from-to-wrapper",3,"history","train",4,"ngIf"],["class","line-item",4,"ngIf"],["class","qr-section",4,"ngIf"],[1,"ticket-details"],[1,"details-row"],[1,"fare"],[1,"title"],["class","content",4,"ngIf"],["class","profile",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ref-num"],[1,"content"],[1,"contact-support",3,"href","click"],["src","images/tickets/call.svg",1,"call-icon"],["station",""],["directionIndicator",""],["range",""],[1,"active-ride-message"],[1,"text"],[3,"click"],[1,"from-to-wrapper"],[1,"from-to",3,"ngClass"],[1,"stations-info"],["class","from-to",3,"ngClass",4,"ngIf"],[1,"line-item"],[1,"line-image",3,"innerHTML"],[1,"line-title-wrapper"],[1,"line-title","primary"],[1,"qr-section"],[1,"subtitle"],["tabindex","0","ariaRole","img",3,"data","altText","options"],["class","end-ride",4,"ngIf"],[1,"end-ride"],[1,"pricing-wrapper"],["class","full-price",4,"ngIf"],[1,"discount-price"],["class","discount-reason",4,"ngIf"],[1,"full-price"],[1,"discount-reason"],[4,"ngFor","ngForOf"],[1,"profile"],[3,"origin","destination",4,"ngIf"],[1,"description"],[1,"station-name"],[1,"direction-indicator"],[1,"inactive"],["src","images/tickets/dest-arrow.svg",1,"arrow-icon"],[1,"active"],["class","range",4,"ngIf"],[1,"range"]],template:function(e,t){if(1&e&&(c.YNc(0,C,11,11,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c._UZ(4,"mvf-image",4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"div",5),c._uU(7),c.qZA(),c.qZA(),c.TgZ(8,"div",6),c._uU(9),c.qZA(),c.qZA(),c.YNc(10,j,7,19,"div",7),c.YNc(11,V,6,4,"div",8),c.YNc(12,z,7,10,"div",9),c.TgZ(13,"div",10),c.TgZ(14,"div",11),c.TgZ(15,"div",12),c.TgZ(16,"div",13),c._uU(17),c.ALo(18,"translate"),c.qZA(),c.YNc(19,Q,7,7,"div",14),c.YNc(20,K,3,3,"div",14),c.qZA(),c.YNc(21,X,6,4,"div",15),c.YNc(22,ee,1,0,"ng-container",16),c.qZA(),c.YNc(23,te,1,0,"ng-container",16),c.TgZ(24,"div",11),c.TgZ(25,"div",17),c.TgZ(26,"div",13),c._uU(27),c.ALo(28,"translate"),c.qZA(),c.TgZ(29,"div",18),c._uU(30),c.qZA(),c.qZA(),c.qZA(),c.TgZ(31,"a",19),c.NdJ("click",function(){return t.contactSupport()}),c.ALo(32,"translate"),c._UZ(33,"svg-icon",20),c._uU(34),c.ALo(35,"translate"),c.qZA(),c.qZA(),c.YNc(36,ie,1,1,"ng-template",null,21,c.W1O),c.YNc(38,re,4,0,"ng-template",null,22,c.W1O),c.YNc(40,se,1,1,"ng-template",null,23,c.W1O)),2&e){const e=c.MAs(41);c.Q6J("ngIf",!t.destinationStationName&&!t.isHistoryScreen),c.xp6(4),c.Q6J("imageId",t.metroService.getAgencyImageId(t.activation.agencyId))("imageAlt",c.xi3(5,20,"a11y_mot_transit_logo",c.VKq(31,le,t.activation.agencyName))),c.xp6(3),c.Oqu(t.activation.agencyName),c.xp6(2),c.Oqu(t.formattedActivationTime),c.xp6(1),c.Q6J("ngIf",t.transitType!==t.MOTTransitType.Bus&&t.originStationName||t.destinationStationName),c.xp6(1),c.Q6J("ngIf",t.busLineDetails),c.xp6(1),c.Q6J("ngIf",t.activation.qrCode),c.xp6(5),c.Oqu(c.lcZ(18,23,"payment_mot_price")),c.xp6(2),c.Q6J("ngIf",t.pricingData),c.xp6(1),c.Q6J("ngIf",!t.pricingData),c.xp6(1),c.Q6J("ngIf",!t.isHistoryScreen),c.xp6(1),c.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",c.VKq(33,ce,t.isHistoryScreen)),c.xp6(1),c.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",c.VKq(35,ce,!t.isHistoryScreen)),c.xp6(4),c.Oqu(c.lcZ(28,25,"payment_mot_ride_reference_number")),c.xp6(3),c.Oqu(t.reference),c.xp6(1),c.s9C("href",c.lcZ(32,27,"payment_mot_pango_number"),c.LSH),c.xp6(3),c.hij(" ",c.lcZ(35,29,"contact_support")," ")}},directives:[s.O5,S.YY,s.tP,x.bk,s.mk,I.u,s.sg],pipes:[y.X$,E.z,s.H9],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-ticket-details{display:block}mv-ticket-details .active-ride-message{position:fixed;z-index:1;background-color:#3a50cf;display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-top:rgba(255,255,255,.2)}html[dir=ltr] mv-ticket-details .active-ride-message{padding-right:0}html[dir=rtl] mv-ticket-details .active-ride-message{padding-left:0}mv-ticket-details .active-ride-message.hidden{display:none}mv-ticket-details .active-ride-message:before{content:url(/images/tickets/lightbulb.svg)}html[dir=ltr] mv-ticket-details .active-ride-message:before{margin-right:10px}html[dir=rtl] mv-ticket-details .active-ride-message:before{margin-left:10px}mv-ticket-details .active-ride-message *{box-sizing:content-box}mv-ticket-details .active-ride-message .content{flex-grow:1}mv-ticket-details .active-ride-message .content p{margin:0;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff}mv-ticket-details .active-ride-message .content p.text{font-weight:400}mv-ticket-details .active-ride-message .title,mv-ticket-details .active-ride-message button{font-weight:600}mv-ticket-details .active-ride-message button{padding:10px 20px;color:#fff;white-space:nowrap}html[dir=ltr] mv-ticket-details .active-ride-message button{padding-left:16px}html[dir=rtl] mv-ticket-details .active-ride-message button{padding-right:16px}mv-ticket-details .header{display:flex;justify-content:space-between;align-items:center;padding:0 20px;height:56px;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000}mv-ticket-details .header:before{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:8px;background:url(/images/tickets/stripes_bar_repeater.svg) repeat-x;background-size:19px 8px}mv-ticket-details .line-item+.qr-section{margin-top:8px}html[dir=rtl] mv-ticket-details .from-to .direction-indicator{transform:scaleX(-1)}mv-ticket-details .from-to.Destination .direction-indicator{direction:rtl}mv-ticket-details .from-to.Destination .direction-indicator .arrow-icon{transform:rotate(90deg)}mv-ticket-details .from-to.Origin .direction-indicator{direction:ltr}mv-ticket-details .agency-info{width:calc(100% - 7.0588235294rem);display:flex;align-items:center}html[dir=ltr] mv-ticket-details .agency-info .agency-icon{margin-right:10px}html[dir=rtl] mv-ticket-details .agency-info .agency-icon{margin-left:10px}mv-ticket-details .agency-info .agency-icon .mvf-wrapper .line{background:none}mv-ticket-details .agency-info .agency-name{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}mv-ticket-details .direction-indicator{width:100%;height:20px;display:flex;align-items:center}mv-ticket-details .direction-indicator .active,mv-ticket-details .direction-indicator .inactive{height:4px;flex-grow:1}mv-ticket-details .direction-indicator .active{background-color:#306cea}mv-ticket-details .direction-indicator .inactive{background-color:#83bbff}mv-ticket-details .direction-indicator .arrow-icon{width:20px;height:20px}mv-ticket-details .stations-info{padding:0 20px;text-align:center;margin-top:10px}mv-ticket-details .stations-info .description{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357;letter-spacing:normal}mv-ticket-details .stations-info .station-name{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#2e69e7;font-weight:600;letter-spacing:normal;margin-top:4px}mv-ticket-details .qr-section{background-color:#fff;border-radius:4px;padding:16px 20px 20px;text-align:center;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;letter-spacing:normal;box-shadow:0 0 5px #0005cf2b;margin:22px 20px 0;border:solid .5px #9b9b9b}mv-ticket-details .qr-section .subtitle{font-weight:normal;color:#000}mv-ticket-details .qr-section mv-qr-display{margin-top:4px;width:9.8823529412rem;height:9.8823529412rem;display:inline-block;padding:16px}mv-ticket-details .end-ride{margin-top:16px}mv-ticket-details .end-ride button{padding:8px 20px;background-color:#306cea;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff;font-weight:600;line-height:20px;border-radius:24px;width:100%;text-align:center}mv-ticket-details .end-ride button:focus{outline:2px solid #000}mv-ticket-details .line{background-color:#fff}mv-ticket-details .ticket-details{background-color:#fff;padding:12px 20px 0;margin-top:24px}mv-ticket-details .ticket-details .details-row{display:flex;padding:12px 0}mv-ticket-details .ticket-details .details-row>div{width:50%}html[dir=ltr] mv-ticket-details .ticket-details .details-row>div{padding-right:10px}html[dir=rtl] mv-ticket-details .ticket-details .details-row>div{padding-left:10px}mv-ticket-details .ticket-details .details-row>div:only-of-type{width:100%}mv-ticket-details .ticket-details .details-row .content{margin-top:4px}mv-ticket-details .title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#525357}mv-ticket-details .content{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000;font-weight:600}mv-ticket-details .content p{margin:0}mv-ticket-details .fare .content .pricing-wrapper{display:inline-flex}mv-ticket-details .fare .content .discount-reason{margin-top:2px}mv-ticket-details .fare .content .discount-reason,mv-ticket-details .fare .content .discount-reason p{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;color:#525357;font-weight:400}html[dir=ltr] mv-ticket-details .fare .content p:first-of-type{margin-right:.2941176471rem}html[dir=rtl] mv-ticket-details .fare .content p:first-of-type{margin-left:.2941176471rem}mv-ticket-details .fare .content p.full-price{text-decoration:line-through;color:#525357}mv-ticket-details .contact-support{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#306cea;font-weight:600;display:inline-flex;align-items:center;padding:16px 0;text-decoration:none}html[dir=ltr] mv-ticket-details .contact-support .call-icon{margin-right:11px}html[dir=rtl] mv-ticket-details .contact-support .call-icon{margin-left:11px}\n'],encapsulation:2}),e})();function he(e,t){1&e&&(c.TgZ(0,"div",2),c._UZ(1,"mv-spinner"),c.qZA())}function me(e,t){if(1&e&&(c.TgZ(0,"p",16),c._uU(1),c.ALo(2,"currency"),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.hij(" ",c.Dn7(2,1,e.fullPrice,e.currencyCode,"symbol")," ")}}function ge(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",7),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw(4).goToTicketDetailsScreen(t.activationId)})("keydown.enter",function(){const t=c.CHM(e).$implicit;return c.oxw(4).goToTicketDetailsScreen(t.activationId)})("keydown",function(t){const n=c.CHM(e).index,i=c.oxw().index;return c.oxw(3).onKeydown(t,i,n)}),c.TgZ(1,"div",8),c._UZ(2,"mvf-image",9),c.qZA(),c.TgZ(3,"div",10),c.TgZ(4,"p",11),c._uU(5),c.qZA(),c.TgZ(6,"p",12),c._uU(7),c.qZA(),c.qZA(),c.TgZ(8,"div",13),c.TgZ(9,"p",14),c._uU(10),c.ALo(11,"currency"),c.qZA(),c.YNc(12,me,3,5,"p",15),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,n=t.index,i=c.oxw().index,r=c.oxw(3);c.Q6J("id",r.rowId(i,n))("tabIndex",0===i&&0===n?0:-1),c.xp6(2),c.Q6J("imageId",e.imageId)("imageAlt",e.agencyName),c.xp6(3),c.Oqu(e.title),c.xp6(2),c.Oqu(e.date),c.xp6(3),c.Oqu(c.Dn7(11,8,e.price,e.currencyCode,"symbol")),c.xp6(2),c.Q6J("ngIf",e.fullPrice)}}function fe(e,t){if(1&e&&(c.TgZ(0,"div",4),c.TgZ(1,"h2",5),c._uU(2),c.qZA(),c.YNc(3,ge,13,12,"div",6),c.qZA()),2&e){const e=t.$implicit,n=c.oxw(3);c.xp6(2),c.Oqu(e),c.xp6(1),c.Q6J("ngForOf",n.mapActivationsToMonth.get(e))}}function ve(e,t){if(1&e&&(c.ynx(0),c.YNc(1,fe,4,2,"div",3),c.BQk()),2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",e.months)}}function ye(e,t){if(1&e){const e=c.EpF();c.ynx(0),c.TgZ(1,"div",17),c.TgZ(2,"a",18),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).onBack()})("keydown.enter",function(){return c.CHM(e),c.oxw(2).onBack()}),c._UZ(3,"svg-icon",19),c.ALo(4,"translate"),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"h2",5),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA(),c._UZ(9,"mv-ticket-details",20),c.BQk()}if(2&e){const e=c.oxw(2);c.xp6(3),c.Q6J("titleText",c.lcZ(4,7,e.backText)),c.uIk("alt",c.lcZ(5,9,"a11y_back_button")),c.xp6(4),c.Oqu(c.lcZ(8,11,e.backText)),c.xp6(2),c.Q6J("activationGroup",e.selectedActivationGroup)("originStationName",e.originStationName)("destinationStationName",e.destinationStationName)("isHistoryScreen",!0)}}function be(e,t){if(1&e&&(c.ynx(0),c.YNc(1,ve,2,1,"ng-container",1),c.YNc(2,ye,10,13,"ng-container",1),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",!e.selectedActivationGroup),c.xp6(1),c.Q6J("ngIf",e.selectedActivationGroup)}}let _e=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d,u){this.document=e,this.universal=t,this.ticketService=n,this.store=i,this.metroService=r,this.stopService=o,this.ticketActions=a,this.uiActions=s,this.title=l,this.translate=c,this.analyticsService=d,this.ticketErrorService=u,this.months=[],this.mapActivationsToMonth=new Map,this.activationGroups=[]}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.universal.isServer)return;let e;yield(0,l.p5)(this.store),this.title.setTitle(this.translate.instant("ride_details_historical_ride_title"));try{e=yield Promise.all([yield this.ticketService.getCurrentActivations(),yield this.ticketService.getHistoricalActivations()])}catch(t){return void this.ticketErrorService.displayError(null,null,null,this.ticketErrorService.defaultErrorMessage)}e.forEach(e=>{(null==e?void 0:e.activations)&&e.activations instanceof Array&&this.activationGroups.push(...e.activations)}),this.activationGroups.length?(this.activationGroups.forEach(e=>{e.activations.filter(e=>e.ticketStatus!==a.pF.ACTIVE).forEach(e=>{const t=this.activationDate(e);this.mapActivationsToMonth.has(t)||(this.mapActivationsToMonth.set(t,[]),this.months.push(t));const{activationTitle:n,activationTime:i,codePrice:r,agencyId:a,activationId:s}=e,l=this.metroService.getAgency(a),c={title:n,date:o()(i).format("DD/MM/YYYY, HH:mm"),price:this.formatPrice(r.price),fullPrice:r.fullPrice?this.formatPrice(r.fullPrice):null,imageId:null==l?void 0:l.image,agencyName:null==l?void 0:l.agencyName,currencyCode:r.price.currencyCode,activationId:s};this.mapActivationsToMonth.get(t).push(c)})}),this.analyticsService.trackMotEvent("view tab","view_rides_history","")):this.ticketErrorService.displayError(null,null,null,{title:this.translate.instant("web_rides_history_tab_empty_title"),text:this.translate.instant("web_rides_history_tab_empty_subtitle")},null,"images/tickets/rides-history.svg","rides-history")})}activationDate(e){const t=new Date(e.activationTime),n=t.getMonth();return`${o().months(n)} ${t.getFullYear()}`}formatPrice(e){return e?(e.balance/100).toFixed(2):null}goToTicketDetailsScreen(e){this.selectedActivationGroup=this.activationGroups.find(t=>t.activations.some(t=>t.activationId===e)),this.setStopsNames(),this.analyticsService.trackMotEvent("view_rides_history_action",`ride_clicked, ${e}`,""),this.analyticsService.trackMotEvent("view tab",`ride_history ${e}`,"")}onBack(){this.analyticsService.trackMotEvent("ride_history_action",`back, ${this.selectedActivationGroup.activations[0].activationId}`,""),this.selectedActivationGroup=null,this.originStationName="",this.destinationStationName=""}get backText(){switch(a.RN[this.selectedActivationGroup.activations[0].transitType]){case a.Q9.Carmelit:return"payment_select_transit_only_carmelit_title";case a.Q9.Rachbalit:return"payment_select_transit_rachbalit_title";case a.Q9.Train:return"payment_select_transit_train_title";case a.Q9.Metronit:return"payment_select_transit_metronit_title";case a.Q9.LightRail:return"payment_select_transit_light_rail_title";case a.Q9.Bus:default:return"payment_select_transit_bus_title"}}setStopsNames(){return(0,i.mG)(this,void 0,void 0,function*(){const{fromStopId:e,toStopId:t}=this.selectedActivationGroup.activations[0];if(!e&&!t)return;this.store.dispatch(this.uiActions.setLoading(!0));const n=yield[e,t].filter(e=>e).map(e=>this.stopService.getStopById(e)),[i,r]=yield Promise.all(n);this.originStationName=null==i?void 0:i.stopName,this.destinationStationName=null==r?void 0:r.stopName,this.store.dispatch(this.uiActions.setLoading(!1))})}onKeydown(e,t,n){if(e.preventDefault(),"Enter"===e.key){const{activationId:e}=this.mapActivationsToMonth.get(this.months[t])[n];return void this.goToTicketDetailsScreen(e)}let i=t,r=n;if("ArrowUp"===e.key)if(0!==n)i=t,r=n-1;else{if(i=t-1,i<0)return;r=this.mapActivationsToMonth.get(this.months[i]).length-1}else{if("ArrowDown"!==e.key)return;if(n!==this.mapActivationsToMonth.get(this.months[t]).length-1)i=t,r=n+1;else{if(i=t+1,i===this.months.length)return;r=0}}this.setSelectedFocus(i,r)}setSelectedFocus(e,t){const n=this.document.getElementById(this.rowId(e,t));n&&(n.focus(),n.scrollIntoView({block:"center"}))}rowId(e,t){return`history-item-${e}-${t}`}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.K0),c.Y36(d.p),c.Y36(u.wP),c.Y36(p.d),c.Y36(h.V),c.Y36(m.V),c.Y36(g.Q),c.Y36(f.V),c.Y36(v.Dx),c.Y36(y.sK),c.Y36(b.y),c.Y36(_.C))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-ticket-history"]],decls:2,vars:2,consts:[["class","spinner",4,"ngIf"],[4,"ngIf"],[1,"spinner"],["class","history-list","role","list",4,"ngFor","ngForOf"],["role","list",1,"history-list"],[1,"ticket-headline"],["class","history-item","role","listitem",3,"id","tabIndex","click","keydown.enter","keydown",4,"ngFor","ngForOf"],["role","listitem",1,"history-item",3,"id","tabIndex","click","keydown.enter","keydown"],[1,"agency-icon"],[3,"imageId","imageAlt"],[1,"name-and-date"],[1,"name"],[1,"date"],[1,"fares"],[1,"discount-price"],["class","full-price",4,"ngIf"],[1,"full-price"],[1,"ticket-header"],["tabindex","0",1,"back-link",3,"click","keydown.enter"],["mvAccessibleSVG","","src","images/tickets/pango-back-arrow.svg",3,"titleText"],[3,"activationGroup","originStationName","destinationStationName","isHistoryScreen"]],template:function(e,t){1&e&&(c.YNc(0,he,2,0,"div",0),c.YNc(1,be,3,2,"ng-container",1)),2&e&&(c.Q6J("ngIf",t.universal.isServer),c.xp6(1),c.Q6J("ngIf",t.universal.isBrowser))},directives:[s.O5,T.O,s.sg,S.YY,x.bk,w.m,pe],pipes:[s.H9,y.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-ticket-history{display:block}mv-ticket-history .ticket-headline{margin:0 20px;padding:14px 0}mv-ticket-history .ticket-header{display:flex;width:100%;align-items:center}mv-ticket-history .ticket-header .ticket-headline{margin:0}mv-ticket-history .ticket-header .back-link{height:24px;width:24px;align-self:center;padding:12px}html[dir=ltr] mv-ticket-history .ticket-header .back-link{padding-left:20px}html[dir=rtl] mv-ticket-history .ticket-header .back-link{padding-right:20px}html[dir=rtl] mv-ticket-history .ticket-header .back-link{transform:scaleX(-1)}mv-ticket-history .ticket-header .back-link:focus svg-icon{outline:auto}mv-ticket-history mv-ticket-details .header{margin-top:0;padding-top:8px;position:relative}mv-ticket-history .history-list{margin-bottom:16px}mv-ticket-history .history-list .history-item{display:flex;align-items:center;padding:12px 20px;position:relative}mv-ticket-history .history-list .history-item:hover{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards}mv-ticket-history .history-list .history-item:not(:last-of-type):after{background:#ECF0F1;content:"";display:block;height:1px;position:absolute;bottom:0;left:20px;width:calc(100% - 40px);z-index:0}html[dir=ltr] mv-ticket-history .history-list .history-item .agency-icon{margin-right:16px}html[dir=rtl] mv-ticket-history .history-list .history-item .agency-icon{margin-left:16px}mv-ticket-history .history-list .history-item .agency-icon,mv-ticket-history .history-list .history-item .agency-icon .boxed{width:1.4117647059rem;height:1.4117647059rem;border-bottom:none}mv-ticket-history .history-list .history-item .name-and-date{flex-grow:1}html[dir=ltr] mv-ticket-history .history-list .history-item .name-and-date{margin-right:15px}html[dir=rtl] mv-ticket-history .history-list .history-item .name-and-date{margin-left:15px}mv-ticket-history .history-list .history-item .name-and-date p{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;margin:0}mv-ticket-history .history-list .history-item .name-and-date p.name{color:#000;font-weight:600}mv-ticket-history .history-list .history-item .name-and-date p.date{margin:2px 0 0;color:#525357}html[dir=ltr] mv-ticket-history .history-list .history-item .fares{text-align:right}html[dir=rtl] mv-ticket-history .history-list .history-item .fares{text-align:left}mv-ticket-history .history-list .history-item .fares p{margin:0}mv-ticket-history .history-list .history-item .fares p.discount-price{font-weight:600;color:#000}mv-ticket-history .history-list .history-item .fares p.full-price{color:#525357;text-decoration:line-through;margin-top:2px}mv-ticket-history .from-to-wrapper{padding:16px 0}mv-ticket-history .from-to-wrapper.history{display:flex}mv-ticket-history .from-to-wrapper.history+.ticket-details{padding-top:0}mv-ticket-history .from-to-wrapper.history .from-to{width:50%}mv-ticket-history .from-to-wrapper.history .from-to:only-of-type{width:100%}mv-ticket-history .from-to-wrapper.history .from-to.Trip div.direction-indicator{transform:scaleX(1)}html[dir=rtl] mv-ticket-history .from-to-wrapper.history .from-to.Trip div.direction-indicator .arrow-icon{transform:scaleX(-1)}html[dir=ltr] mv-ticket-history .from-to-wrapper.history .from-to.Trip:last-of-type .direction-indicator{direction:rtl}html[dir=rtl] mv-ticket-history .from-to-wrapper.history .from-to.Trip:last-of-type .direction-indicator{direction:ltr}html[dir=ltr] mv-ticket-history .from-to-wrapper.history .from-to.Trip:last-of-type svg-icon.arrow-icon{transform:rotate(90deg)}html[dir=rtl] mv-ticket-history .from-to-wrapper.history .from-to.Trip:last-of-type svg-icon.arrow-icon{transform:scaleX(-1) rotate(90deg)}mv-ticket-history .from-to-wrapper.history .from-to .stations-info .station-name{margin-top:4px}\n'],encapsulation:2}),e})();var Te=n(16438),Se=n(20702),xe=n(21090);let we=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.elementRef=t,this.analyticsService=n}ngOnInit(){this.analyticsService.trackMotEvent("View tab","complete_active_ride_alert",""),this.elementRef.nativeElement.setAttribute("aria-modal","true"),this.elementRef.nativeElement.setAttribute("role","dialog")}ngAfterViewChecked(){this.elementRef.nativeElement.focus()}newRide(){this.analyticsService.trackMotEvent("complete_active_ride_alert_action","new_ride",""),this.dialogRef.close("new")}cancel(){this.analyticsService.trackMotEvent("complete_active_ride_alert_action","end_ride",""),this.dialogRef.close("end")}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(xe.z),c.Y36(c.SBq),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-abort-train-ride"]],decls:13,vars:12,consts:[["src","images/tickets/spot-web-warning.svg",1,"error-icon","popup-image"],[1,"approve","pango-button",3,"click"],[1,"decline",3,"click"]],template:function(e,t){1&e&&(c._UZ(0,"svg-icon",0),c.TgZ(1,"h2"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"p"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"button",1),c.NdJ("click",function(){return t.cancel()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"button",2),c.NdJ("click",function(){return t.newRide()}),c._uU(11),c.ALo(12,"translate"),c.qZA()),2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,4,"payment_mot_newride_train_popup_title")),c.xp6(3),c.Oqu(c.lcZ(6,6,"payment_mot_newride_train_popup_subtitle")),c.xp6(3),c.Oqu(c.lcZ(9,8,"payment_mot_newride_train_popup_end_button")),c.xp6(3),c.hij(" ",c.lcZ(12,10,"payment_mot_newride_train_popup_start_anyway_button"),"\n"))},directives:[x.bk],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-abort-train-ride{color:#000;text-align:center;padding:30px 20px 36px;background:white;width:100%;box-sizing:border-box;position:fixed;bottom:0;left:0;box-shadow:0 0 155px #0005cf5e;border:solid .5px #fff}mv-abort-train-ride svg-icon.popup-image{display:block;margin:0 auto 24px;width:96px;height:96px}html[dir=rtl] mv-abort-train-ride{direction:rtl}mv-abort-train-ride h2{margin:0;font-size:21px;text-align:center;font-size:1.2352941176rem;letter-spacing:normal;line-height:1.33}mv-abort-train-ride p{margin:16px 0 0;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-abort-train-ride button{display:block;width:100%}mv-abort-train-ride button.pango-button{font-size:1.1764705882rem;line-height:1.6;font-weight:600;border-radius:24px;background-color:#306cea;color:#fff;padding:8px 24px;width:100%}mv-abort-train-ride button.pango-button.disabled,mv-abort-train-ride button.pango-button:disabled{background-color:#83bbff;color:#fff}mv-abort-train-ride button.pango-button:focus{outline:2px solid #000}mv-abort-train-ride button.approve{margin-top:24px}mv-abort-train-ride button.approve:focus{outline:2px solid #000}mv-abort-train-ride button.decline{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#306cea;font-weight:600;display:block;margin:15px auto 0;padding:10px 40px 0}mv-abort-train-ride button.decline:focus{outline:2px solid #000}\n"],encapsulation:2}),e})();var ke=n(95505),Me=n(61787);function Le(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",8),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).startNewRide()}),c.ALo(1,"translate"),c._uU(2),c.ALo(3,"translate"),c.qZA()}if(2&e){const e=c.oxw(2);c.uIk("aria-label",c.lcZ(1,2,e.getTransitTypeResources().secondaryActionBtnKey)),c.xp6(2),c.hij(" ",c.lcZ(3,4,e.getTransitTypeResources().secondaryActionBtnKey)," ")}}const Ae=function(e){return{TRANSIT_TYPE:e}};function Ie(e,t){if(1&e){const e=c.EpF();c.ynx(0),c._UZ(1,"svg-icon",1),c.ALo(2,"translate"),c.TgZ(3,"h2",2),c._uU(4),c.ALo(5,"translate"),c.qZA(),c._UZ(6,"p",3),c.ALo(7,"safeHtml"),c.ALo(8,"translate"),c.TgZ(9,"button",4),c.NdJ("click",function(){return c.CHM(e),c.oxw().goToTicketDetails()}),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.TgZ(12,"div",5),c.TgZ(13,"button",6),c.NdJ("click",function(){return c.CHM(e),c.oxw().mainButtonAction()}),c.ALo(14,"translate"),c._uU(15),c.ALo(16,"translate"),c.qZA(),c.YNc(17,Le,4,6,"button",7),c.qZA(),c.BQk()}if(2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngClass",e.getTransitTypeResources().transitTypeImgName)("src",e.transitTypeImg)("titleText",c.xi3(2,9,"a11y_mot_transit_logo",c.VKq(24,Ae,e.getTransitTypeResources().transitTypeImgAlt))),c.xp6(3),c.Oqu(c.lcZ(5,12,e.getTransitTypeResources().titleKey)),c.xp6(2),c.Q6J("innerHTML",c.lcZ(7,14,c.lcZ(8,16,e.getTransitTypeResources().subtitleKey)),c.oJD),c.xp6(4),c.Oqu(c.lcZ(11,18,e.getTransitTypeResources().qrBtnKey)),c.xp6(3),c.uIk("aria-label",c.lcZ(14,20,e.getTransitTypeResources().mainActionBtnKey)),c.xp6(2),c.hij(" ",c.lcZ(16,22,e.getTransitTypeResources().mainActionBtnKey)," "),c.xp6(2),c.Q6J("ngIf",e.getTransitTypeResources().secondaryActionBtnKey)}}let Ee=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d){this.store=e,this.ticketActions=t,this.routingService=n,this.canonicalService=i,this.dialogService=r,this.dialogRef=o,this.title=a,this.translate=s,this.universal=l,this.analyticsService=c,this.elementRef=d}ngOnInit(){this.title.setTitle(this.translate.instant("ride_details_active_ride_title")),this.analyticsService.trackMotEvent("View active ride tab",this.transitTypeForAnalytics,""),this.elementRef.nativeElement.setAttribute("aria-modal","true"),this.elementRef.nativeElement.setAttribute("role","dialog"),this.redirectToTicketView()}redirectToTicketView(){this.routingService.getStateFromUrl().motView===a.o0.ShowQrCode&&(this.goToTicketDetails(),this.universal.isBrowser&&this.routingService.updateUrlParams({motView:null}))}get state(){return this.store.getState().ticket}get step(){return this.state.step}get trainType(){return this.state.data.trainType}get transitTypeForAnalytics(){return this.activation.transitType===a.gP.CityLightRail?a.Xl:a.RN[this.activation.transitType]}get showActiveRide(){return this.getTransitTypeResources()&&!this.step}get activationGroup(){return this.state.data.activationsGroup}get activation(){var e;return null===(e=this.activationGroup)||void 0===e?void 0:e.activations[0]}getTransitTypeResources(){if(!this.activation)return null;switch(a.RN[this.activation.transitType]){case a.Q9.Carmelit:return{transitTypeImgName:"carmelit",transitTypeImgAlt:this.translate.instant("transit_type_only_carmelit"),titleKey:"payment_mot_carmelit_active",subtitleKey:"payment_mot_active_ride_subtitle",mainActionBtnKey:"ticketing_action_new_ride",qrBtnKey:"payment_mot_active_ride_see_ticket"};case a.Q9.Rachbalit:return{transitTypeImgName:"cable_car",transitTypeImgAlt:this.translate.instant("transit_type_rachbalit"),titleKey:"payment_mot_expresscable_active",subtitleKey:"payment_mot_active_ride_subtitle",mainActionBtnKey:"ticketing_action_new_ride",qrBtnKey:"payment_mot_active_ride_see_ticket"};case a.Q9.LightRail:return{transitTypeImgName:"light-rail",transitTypeImgAlt:this.translate.instant("transit_type_light_train"),titleKey:"payment_mot_light_rail_active",subtitleKey:"payment_mot_active_ride_subtitle",mainActionBtnKey:"ticketing_action_new_ride",qrBtnKey:"payment_mot_active_ride_see_ticket"};case a.Q9.Train:return{transitTypeImgName:this.hasRecentlyCompletedRide?"israel-train-completed":"israel-train",transitTypeImgAlt:this.translate.instant("transit_type_train"),titleKey:this.hasRecentlyCompletedRide?"payment_mot_train_ended_ride_title":"payment_mot_train_active",subtitleKey:this.hasRecentlyCompletedRide?"payment_mot_train_ended_ride_subtitle":"payment_mot_train_active_ride_subtitle",qrBtnKey:this.hasRecentlyCompletedRide?"payment_mot_train_permit_exit_qr":"payment_mot_active_ride_see_ticket",mainActionBtnKey:this.hasRecentlyCompletedRide?"ticketing_action_new_ride":"payment_mot_exit_code_action",secondaryActionBtnKey:this.hasRecentlyCompletedRide?null:"payment_mot_train_start_new"};case a.Q9.Metronit:return{transitTypeImgName:"metronit",transitTypeImgAlt:this.translate.instant("transit_type_brt"),titleKey:"payment_mot_carmelit_active",subtitleKey:"payment_mot_active_ride_subtitle",mainActionBtnKey:"ticketing_action_new_ride",qrBtnKey:"payment_mot_active_ride_see_ticket"};case a.Q9.Bus:default:return{transitTypeImgName:"bus",transitTypeImgAlt:this.translate.instant("transit_type_default_bus"),titleKey:"payment_mot_bus_active",subtitleKey:"payment_mot_active_ride_subtitle",mainActionBtnKey:"ticketing_action_new_ride",qrBtnKey:"payment_mot_active_ride_see_ticket"}}}get transitTypeImg(){return`images/tickets/transit-types/${this.getTransitTypeResources().transitTypeImgName}.svg`}get hasRecentlyCompletedRide(){return this.activation.ticketStatus===a.pF.ACTIVE&&!!this.activation.activationCompletionTime}mainButtonAction(){if(this.trainType!==k.ue.Train||this.hasRecentlyCompletedRide)return this.analyticsService.trackMotEvent("active_ride_action",`new_ride, ${this.transitTypeForAnalytics}`,""),this.startNewRide(),void this.dialogRef.close();this.store.dispatch(this.ticketActions.setStep(k.Y5.DestinationStationLocating)),this.store.dispatch(this.ticketActions.setData({trainType:k.ue.Train})),this.dialogRef.close(),this.analyticsService.trackMotEvent("active_ride_action",`create_exit_qr, ${this.transitTypeForAnalytics}`,"")}goToTicketDetails(){const e=a.RN[this.activation.transitType];e===a.Q9.Train||e===a.Q9.Carmelit?this.store.dispatch(this.ticketActions.setStep(this.hasRecentlyCompletedRide?k.Y5.ExitPass:a.eb.BoardingPass)):(this.store.dispatch(this.ticketActions.setMode(a.Y.Bus,!0)),this.store.dispatch(this.ticketActions.setStep(Se.V.TicketDetails))),this.dialogRef.close(),this.analyticsService.trackMotEvent("active_ride_action",`show_qr, ${this.transitTypeForAnalytics}`,"")}startNewRide(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.trainType!==k.ue.Train||this.hasRecentlyCompletedRide)return void this.store.dispatch(this.ticketActions.goToTicketTypeSelection());const e=yield this.dialogService.create(we,{width:"calc(100% - 30px)",maxWidth:"320px",backdropClass:"tickets-backdrop"}).onClose.toPromise();"new"===e&&(this.store.dispatch(this.ticketActions.goToTicketTypeSelection()),this.store.dispatch(this.ticketActions.setData({ignoreActiveRide:!0})),this.dialogRef.close()),"end"===e&&(this.store.dispatch(this.ticketActions.setStep(k.Y5.DestinationStationLocating)),this.store.dispatch(this.ticketActions.setData({trainType:k.ue.Train})),this.dialogRef.close())})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(g.Q),c.Y36(ke.Z),c.Y36(Me.z),c.Y36(xe.x),c.Y36(xe.z),c.Y36(v.Dx),c.Y36(y.sK),c.Y36(d.p),c.Y36(b.y),c.Y36(c.SBq))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-active-ride"]],decls:1,vars:1,consts:[[4,"ngIf"],["mvAccessibleSVG","",1,"transit-type-icon",3,"ngClass","src","titleText"],[1,"active-ride-headline"],[1,"active-ride-text",3,"innerHTML"],[1,"pango-button-empty",3,"click"],[1,"buttons"],[1,"pango-button",3,"click"],["class","start-ride",3,"click",4,"ngIf"],[1,"start-ride",3,"click"]],template:function(e,t){1&e&&c.YNc(0,Ie,18,26,"ng-container",0),2&e&&c.Q6J("ngIf",t.showActiveRide&&t.universal.isBrowser)},directives:[s.O5,x.bk,w.m,s.mk],pipes:[y.X$,E.z],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-active-ride{display:flex;flex-direction:column;width:100%;padding:0 36px}mv-active-ride .transit-type-icon{display:block;margin:56px auto 0;position:relative}mv-active-ride .transit-type-icon svg{position:relative;z-index:1}mv-active-ride .transit-type-icon:after{content:"";position:absolute;top:0;left:0;border-radius:50%;z-index:0;display:block;width:96px;height:96px;background-color:transparent;-webkit-animation:logo-back-pulse 2s infinite;animation:logo-back-pulse 2s infinite;transform:scale(.8)}mv-active-ride .transit-type-icon.israel-train:after{background-color:#21236a}mv-active-ride .transit-type-icon.bus:after{background-color:#f3c69b}mv-active-ride .transit-type-icon.carmelit:after{background-color:#f08900}mv-active-ride .transit-type-icon.metronit:after{background-color:#1e5ca9}mv-active-ride .transit-type-icon,mv-active-ride .transit-type-icon svg{width:96px;height:96px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-active-ride .transit-type-icon{margin-top:15px}}mv-active-ride .active-ride-headline,mv-active-ride .active-ride-text{text-align:center;color:#000}mv-active-ride .active-ride-headline{font-size:1.2352941176rem;letter-spacing:normal;line-height:1.33;margin:24px 0 0}mv-active-ride .active-ride-text{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;margin:8px 0 0}mv-active-ride .buttons{position:fixed;width:100%;left:0;bottom:36px;padding:0 20px;box-sizing:border-box;text-align:center}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-active-ride .buttons{position:static;margin:36px auto}}mv-active-ride .buttons .start-ride{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#306cea;font-weight:600;width:100%;margin-top:25px}mv-active-ride .buttons .start-ride:focus{outline:auto}mv-active-ride .pango-button-empty{display:block;background-color:#fff;color:#306cea;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;font-weight:600;border:1px solid #306CEA;text-align:center;padding:8px 16px;border-radius:24px;margin:24px auto 0}mv-active-ride .pango-button-empty:focus{outline:auto}mv-active-ride .alert-content{display:flex;align-items:center;width:100%;box-sizing:border-box;background-color:#f7a20c26;border-radius:6px;color:#525357;padding:12px}html[dir=ltr] mv-active-ride .alert-content{text-align:left}html[dir=rtl] mv-active-ride .alert-content{text-align:right}mv-active-ride .alert-content p{margin:0}html[dir=ltr] mv-active-ride .alert-content p{text-align:left}html[dir=rtl] mv-active-ride .alert-content p{text-align:right}mv-active-ride .alert-content svg-icon{margin:0;min-width:24px}html[dir=ltr] mv-active-ride .alert-content svg-icon{margin-right:12px}html[dir=rtl] mv-active-ride .alert-content svg-icon{margin-left:12px}mv-active-ride .alert-content svg-icon svg g{fill:#f7a20c}\n'],encapsulation:2}),e})();var Ce=n(44143),De=n(31251);function Pe(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",3),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().selectMode(t.mode,t.type,t.isMetronit)})("keydown.enter",function(){const t=c.CHM(e).$implicit;return c.oxw().selectMode(t.mode,t.type,t.isMetronit)}),c._UZ(1,"svg-icon",4),c.TgZ(2,"div",5),c.TgZ(3,"h3"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"p"),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit;c.ekj("disabled",!e.isAvailable),c.Q6J("ngClass",e.cssClass),c.uIk("aria-disabled",!e.isAvailable),c.xp6(1),c.Q6J("src",e.svgSrc),c.xp6(3),c.Oqu(c.lcZ(5,7,e.title)),c.xp6(3),c.Oqu(c.lcZ(8,9,e.subtitle))}}const Oe=(0,M.hu)("TransitTypesProperties");let Ne=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this.store=e,this.ticketActions=t,this.permissionService=n,this.ticketService=i,this.title=r,this.translate=o,this.ticketErrorService=a,this.analyticsService=s,this.universal=l,this.metronitLocations=[{location:{lat:32.8064243,lng:35.0430141},radiusKm:10}],this.lightRailLocations=[{location:{lat:31.7810332,lng:35.2195275},radiusKm:5}]}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.title.setTitle(this.translate.instant("web_payment_mot_rides_qr_header")),!this.universal.isServer)try{this.isLoading=!0,yield this.populateLocationBasedTransitTypes()}catch(e){Oe.error("ngOnInit:",e),this.ticketErrorService.displayError(a.Y.Train,this.ngOnInit.bind(this),null,null),this.analyticsService.trackMotEvent("mot_error","no_gps","")}finally{this.isLoading=!1}})}get state(){return this.store.getState()}selectMode(e,t,n){let i;this.store.dispatch(this.ticketActions.setMode(e,!0)),e===a.Y.Train&&this.store.dispatch(this.ticketActions.setData({trainType:t||k.ue.Train})),i=n?"metronit":t===k.ue.LightRail?a.Xl:e===a.Y.Train?t:e,this.analyticsService.trackMotEvent("Transit_type_selected",i,"")}populateLocationBasedTransitTypes(){return(0,i.mG)(this,void 0,void 0,function*(){const e=(yield this.permissionService.getLocation({timeout:a.bH})).coords;this.isMetronitArea=this.metronitLocations.some(t=>(0,Ce.YQ)(t.location.lat,t.location.lng,e.latitude,e.longitude,"K")<=t.radiusKm),this.isLightRailArea=this.lightRailLocations.some(t=>(0,Ce.YQ)(t.location.lat,t.location.lng,e.latitude,e.longitude,"K")<=t.radiusKm),this.transitTypes=[{mode:a.Y.Bus,svgSrc:"images/tickets/transit-type-image-bus.svg",title:"payment_select_transit_bus_title",subtitle:"payment_select_transit_bus_subtitle",isAvailable:!0,cssClass:"bus"},{mode:a.Y.Train,type:k.ue.Train,svgSrc:"images/tickets/transit-type-image-train.svg",title:"payment_select_transit_train_title",subtitle:"payment_select_transit_train_subtitle",isAvailable:!0,cssClass:"train"},{mode:a.Y.Train,type:k.ue.Carmelit,svgSrc:"images/tickets/transit-type-image-rachbalit-and-carmelit.svg",title:"payment_select_transit_carmelit_title",subtitle:this.isMetronitArea?"payment_select_transit_carmelit_subtitle":"payment_transit_type_available_haifa",isAvailable:this.isMetronitArea,cssClass:"carmelit"},{mode:a.Y.Bus,svgSrc:"images/tickets/transit-type-image-metronit.svg",title:"payment_select_transit_metronit_title",subtitle:this.isMetronitArea?"payment_select_transit_metronit_subtitle":"payment_transit_type_available_haifa",isMetronit:!0,isAvailable:this.isMetronitArea,cssClass:"metronit"},{mode:a.Y.Train,type:k.ue.LightRail,svgSrc:"images/tickets/transit-type-image-light-rail.svg",title:"payment_select_transit_light_rail_title",subtitle:this.isLightRailArea?"payment_select_transit_light_rail_subtitle":"payment_transit_type_available_jerusalem",isAvailable:this.isLightRailArea,cssClass:"light-rail"}].sort((e,t)=>t.isAvailable?0:-1)})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(g.Q),c.Y36(De.$),c.Y36(u.wP),c.Y36(v.Dx),c.Y36(y.sK),c.Y36(_.C),c.Y36(b.y),c.Y36(d.p))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-transit-type-selection"]],decls:6,vars:6,consts:[["src","images/tickets/ticket.svg",1,"ride-icon"],[1,"ride-options"],["class","ride-option","tabindex","0",3,"ngClass","disabled","click","keydown.enter",4,"ngFor","ngForOf"],["tabindex","0",1,"ride-option",3,"ngClass","click","keydown.enter"],[1,"ride-icon",3,"src"],[1,"ride-text"]],template:function(e,t){1&e&&(c._UZ(0,"svg-icon",0),c.TgZ(1,"h2"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",1),c.YNc(5,Pe,9,11,"div",2),c.qZA()),2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,4,"payement_select_transit_title")),c.xp6(2),c.ekj("metronit-area",t.isMetronitArea),c.xp6(1),c.Q6J("ngForOf",t.transitTypes))},directives:[x.bk,s.sg,s.mk],pipes:[y.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-transit-type-selection{display:flex;flex-direction:column;align-items:center}mv-transit-type-selection .ride-icon{height:56px;min-width:56px;margin:36px auto 0}mv-transit-type-selection h2{text-align:center;margin:16px auto 0;padding:0 20px;color:#306cea;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25}mv-transit-type-selection .ride-options{padding:0 20px 80px;margin-top:32px;width:100%;box-sizing:border-box}mv-transit-type-selection .ride-options .ride-option{display:flex;align-items:center;border:solid .5px #C5C5C5;box-shadow:0 0 5px #0005cf2b;border-radius:8px;padding:20px 16px}mv-transit-type-selection .ride-options .ride-option.disabled{opacity:.35;pointer-events:none}mv-transit-type-selection .ride-options .ride-option:after{content:"";width:1.4117647059rem;height:1.4117647059rem;min-width:1.4117647059rem;background:no-repeat url(/images/tickets/arrow-round.svg) center/1.4117647059rem}html[dir=rtl] mv-transit-type-selection .ride-options .ride-option:after{transform:scaleX(-1)}mv-transit-type-selection .ride-options .ride-option:not(:first-of-type){margin-top:16px}mv-transit-type-selection .ride-options .ride-option .ride-icon{margin:0}html[dir=ltr] mv-transit-type-selection .ride-options .ride-option .ride-icon{margin-right:16px}html[dir=rtl] mv-transit-type-selection .ride-options .ride-option .ride-icon{margin-left:16px}mv-transit-type-selection .ride-options .ride-option .ride-text{flex-grow:1}html[dir=ltr] mv-transit-type-selection .ride-options .ride-option .ride-text{padding-right:16px}html[dir=rtl] mv-transit-type-selection .ride-options .ride-option .ride-text{padding-left:16px}mv-transit-type-selection .ride-options .ride-option .ride-text h3{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#000;font-weight:600;margin:0 0 4px}mv-transit-type-selection .ride-options .ride-option .ride-text p{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000;margin:0}\n'],encapsulation:2}),e})();var Re=n(78146),$e=n(85431),Ye=n(72928),Fe=n.n(Ye),Be=n(94354);const Ue=(0,M.hu)("QrScanner");class Ze{constructor(e){this.event=new Be.x,this.video=document.getElementById(e.videoElementId),this.canvas=document.getElementById(e.canvasElementId),this.canvas2d=this.canvas.getContext("2d"),this.canvas.hidden=!0,this.multipleScans=e.multipleScans||!1}start(){return(0,i.mG)(this,void 0,void 0,function*(){try{const e=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{min:640,ideal:1920,max:1920},height:{min:400,ideal:1080}}});this.video.srcObject=e,this.video.setAttribute("playsinline","true"),yield this.video.play(),this.intervalTicker=setInterval(()=>requestAnimationFrame(this.onTick.bind(this)),500),this.track=e.getVideoTracks()[0]}catch(e){Ue.error(e)}})}stop(){!this.isActive||(clearInterval(this.intervalTicker),this.intervalTicker=0,this.event.complete())}subscribe(e){return this.event.subscribe(e)}get isActive(){return this.intervalTicker>0}onTick(){if(this.video&&this.canvas&&this.canvas2d)try{if(!this.video.videoHeight&&!this.video.videoWidth)return;this.canvas.height=this.video.videoHeight,this.canvas.width=this.video.videoWidth,this.canvas2d.drawImage(this.video,0,0,this.canvas.width,this.canvas.height);const e=this.canvas2d.getImageData(0,0,this.canvas.width,this.canvas.height),t=Fe()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});t&&(this.event.next(t),this.multipleScans||this.stop(),Ue.log(t))}catch(e){Ue.error(e)}}get torch(){if(!this.isActive||!this.track.getCapabilities().torch)return null;const e=this.track;return{getState:()=>!!e.getSettings().torch,setState(t){e.applyConstraints({advanced:[{torch:t}]})},toggleState(){this.setState(!this.getState())}}}}var je=n(43445),Ve=n(8967);function He(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",16),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).torch()})("keydown.enter",function(){return c.CHM(e),c.oxw(2).torch()}),c._UZ(1,"svg-icon",17),c.qZA()}if(2&e){const e=c.oxw(2);c.ekj("on",e.qrScanner.torch.getState()),c.uIk("aria-label",e.torch),c.xp6(1),c.Q6J("titleText","torch")}}const Ge=function(){return{LINK:""}};function ze(e,t){if(1&e){const e=c.EpF();c.ynx(0),c.TgZ(1,"div",2),c.TgZ(2,"div",3),c.TgZ(3,"div",4),c.TgZ(4,"a",5,6),c.NdJ("click",function(){return c.CHM(e),c.oxw().onBack()})("keydown.enter",function(){return c.CHM(e),c.oxw().onBack()}),c._UZ(6,"svg-icon",7),c.ALo(7,"translate"),c.ALo(8,"translate"),c.qZA(),c.YNc(9,He,2,4,"button",8),c.TgZ(10,"p"),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.TgZ(13,"div",9),c.TgZ(14,"div",10),c.TgZ(15,"span"),c._uU(16),c.ALo(17,"translate"),c.qZA(),c.qZA(),c.TgZ(18,"div",11),c._uU(19),c.ALo(20,"translate"),c.TgZ(21,"a",12),c.ALo(22,"translate"),c._uU(23),c.ALo(24,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(25,"div",13),c._UZ(26,"canvas",14),c._UZ(27,"video",15),c.qZA(),c.BQk()}if(2&e){const e=c.oxw();c.xp6(6),c.Q6J("titleText",c.lcZ(7,8,"action_back")),c.uIk("alt",c.lcZ(8,10,"a11y_back_button")),c.xp6(3),c.Q6J("ngIf",null==e.qrScanner?null:e.qrScanner.torch),c.xp6(2),c.Oqu(c.lcZ(12,12,"web_payment_mot_qr_instructions")),c.xp6(5),c.Oqu(c.lcZ(17,14,"web_payment_mot_qr_example")),c.xp6(3),c.hij(" ",c.xi3(20,16,"web_payment_mot_qr_support",c.DdM(23,Ge))," "),c.xp6(2),c.Q6J("href",c.lcZ(22,19,"payment_mot_pango_number"),c.LSH),c.xp6(2),c.Oqu(c.lcZ(24,21,"payment_mot_qr_support"))}}function qe(e,t){1&e&&(c.TgZ(0,"div",18),c._UZ(1,"mv-spinner"),c.qZA())}const Je=(0,M.hu)("BusTicketsQrScannerViewComponent");let We=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this._zone=e,this.translate=t,this.hookService=n,this.ticketService=i,this.ticketErrorService=r,this.permissionService=o,this.store=a,this.ticketActions=s,this.analyticsService=l,this.externalScanner=this.hookService.runHooks(je.e.COMPONENT_QR_SCANNER,(...t)=>e.run(this.onQrScan,this,t))()}ngAfterViewInit(){this.startQrScanner()}get state(){return this.store.getState()}startQrScanner(){if(this.analyticsService.trackMotEvent("SCAN_BARCODE_IMPRESSION","",""),this.externalScanner)return Je.remote("[startQrScanner] External launched"),void this.externalScanner();Je.remote("[startQrScanner] Native launched"),this.qrScanner=new Ze({videoElementId:"qr-scanner",canvasElementId:"canvas"}),this.qrScanner.start(),this.qrScanner.subscribe(e=>this.onQrScan(null==e?void 0:e.data))}onQrScan(e){return(0,i.mG)(this,void 0,void 0,function*(){if(!e)return Je.remote("[onQrScan] No data"),void this.goBack();Je.remote(`[onQrScan] Returned: ${e}`),this.isLoading=!0;let t={};try{const{longitude:e,latitude:n}=(yield this.permissionService.getLocation({timeout:a.bH})).coords;t={longitude:e,latitude:n}}catch(n){const e={title:this.translate.instant("payment_mot_train_no_location_error_title"),text:this.translate.instant("payment_mot_train_no_location_error_subtitle"),technicalInformation:n};return this.ticketErrorService.displayError(a.Y.Bus,this.startQrScanner.bind(this),this.goBack.bind(this),e),void(this.isLoading=!1)}try{const n=yield this.ticketService.getBusActivationPrices(e,t),i=yield this.getDiscountRegion(n.discountRegions,t);this.store.dispatch(this.ticketActions.setData({source:{location:t,discountRegionsId:i},activationPrices:n})),this.store.dispatch(this.ticketActions.setStep(Se.V.SuggestedLines)),this.analyticsService.trackMotEvent("SCAN_BARCODE_ACTION",e,"")}catch(n){const e=(null==n?void 0:n.error)&&(n.error.title||n.error.text)?n.error:{title:this.translate.instant("authority_invalid_qrcode_error_title")};this.ticketErrorService.displayError(a.Y.Bus,this.startQrScanner.bind(this),this.goBack.bind(this),e),this.analyticsService.trackMotEvent("SCAN_BARCODE_ERROR","",""),Je.error("onQrScan:",n)}finally{this.isLoading=!1}})}torch(){var e;null===(e=this.qrScanner.torch)||void 0===e||e.toggleState()}getDiscountRegion(e,t){return(0,i.mG)(this,void 0,void 0,function*(){if(e)return yield Ve.d.loadLeafletPackage(),e.filter(e=>e.polygons.some(e=>(0,Ce.mp)({lng:t.longitude,lat:t.latitude},e))).map(e=>e.id)})}onBack(){this.goBack(),this.analyticsService.trackMotEvent("SCAN_BARCODE_ACTION","back","")}goBack(){this.store.dispatch(this.ticketActions.setMode(null))}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(c.R0b),c.Y36(y.sK),c.Y36(je.$),c.Y36(u.wP),c.Y36(_.C),c.Y36(De.$),c.Y36(p.d),c.Y36(g.Q),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-qr-scanner-view"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"qr-scanner-container"],[1,"qr-above-layer"],[1,"above-layer-top"],["tabindex","0",1,"back-link",3,"click","keydown.enter"],["backButton",""],["src","images/tickets/pango-back-arrow.svg","mvAccessibleSVG","",3,"titleText"],["class","torch",3,"on","click","keydown.enter",4,"ngIf"],[1,"above-layer-bottom"],[1,"code-demo"],[1,"scanner-footer"],[3,"href"],[1,"qr-overlay"],["id","canvas"],["id","qr-scanner"],[1,"torch",3,"click","keydown.enter"],["src","images/tickets/flashlight.svg","mvAccessibleSVG","",3,"titleText"],[1,"spinner"]],template:function(e,t){1&e&&(c.YNc(0,ze,28,24,"ng-container",0),c.YNc(1,qe,2,0,"div",1)),2&e&&(c.Q6J("ngIf",!t.externalScanner&&!t.isLoading),c.xp6(1),c.Q6J("ngIf",t.isLoading))},directives:[s.O5,x.bk,w.m,T.O],pipes:[y.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-qr-scanner-view .qr-scanner-container{position:fixed;height:100%;width:100%;display:flex;flex-direction:column;justify-content:space-between;background-color:#000}mv-bus-tickets-qr-scanner-view .qr-scanner-container #qr-scanner{height:100%}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer{height:100%;width:100%;top:0;position:fixed;display:flex;justify-content:space-between;flex-direction:column;z-index:2;color:#fff}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top,mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom{position:relative;height:calc(50% - 100px);z-index:2}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top{display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .back-link{position:absolute;top:0}html[dir=ltr] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .back-link{left:0}html[dir=rtl] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .back-link{right:0}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .back-link svg path{fill:#fff}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top p{position:absolute;bottom:0;margin-bottom:22px;padding:0 20px;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;font-weight:600;text-align:center}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch,mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch svg-icon{width:36px;height:36px}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch #tourch-on,mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch #tourch-off{display:none}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch.on #tourch-on{display:block}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-top .torch:not(.on) #tourch-off{display:block}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom{display:flex;flex-direction:column;align-items:center}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo{position:relative;display:inline-flex;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;margin-top:40px;flex-grow:1}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo span{padding-top:10px}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo span:before{content:url(/images/tickets/qr-arrow.svg);position:absolute;top:31px}html[dir=ltr] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo span:before{right:45px}html[dir=rtl] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo span:before{left:45px}html[dir=rtl] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo span:before{transform:scaleX(-1)}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo:after{content:"";background:no-repeat url(/images/tickets/code-demo.png) center/cover;width:2.3529411765rem;height:3.5294117647rem;display:block}html[dir=ltr] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo:after{margin-left:17px}html[dir=rtl] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo:after{margin-right:17px}html[dir=rtl] mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .code-demo:after{transform:scaleX(-1)}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .scanner-footer{background-color:#000;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;padding:19px 20px;width:100%;text-align:center}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-above-layer .above-layer-bottom .scanner-footer a{color:#306cea;font-weight:600}mv-bus-tickets-qr-scanner-view .qr-scanner-container:after{content:url(/images/tickets/crosshair.svg);position:absolute;top:calc(50% - 100px);left:calc(50% - 117px);z-index:1}mv-bus-tickets-qr-scanner-view .qr-scanner-container .qr-overlay{position:absolute;top:calc(50% - 480px);left:calc(50% - 250px);width:500px;height:1000px;background-color:#000;mask-box-image:url(/images/tickets/qr-mask.svg) stretch;-webkit-mask-box-image:url(/images/tickets/qr-mask.svg) stretch;z-index:1}\n'],encapsulation:2}),e})();var Qe=n(79573),Ke=n(21532),Xe=n(55754),et=n(94876);function tt(e,t){if(1&e&&(c.TgZ(0,"span",9),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.Oqu(e.subtitle)}}const nt=function(e){return{LINE_NAME:e}};function it(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",4),c.NdJ("click",function(){const t=c.CHM(e),n=t.$implicit,i=t.index;return c.oxw(2).onLineClick(n,i)})("keydown",function(t){const n=c.CHM(e).index;return c.oxw(2).onKeydown(t,n)}),c.ALo(1,"translate"),c._UZ(2,"div",5),c.ALo(3,"safeHtml"),c.ALo(4,"async"),c.TgZ(5,"div",6),c.TgZ(6,"span",7),c._uU(7),c.qZA(),c.YNc(8,tt,2,1,"span",8),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,n=t.index,i=c.oxw(2);c.Q6J("tabIndex",i.tabIndex(n))("id","line_"+n),c.uIk("aria-label",c.xi3(1,8,"a11y_mot_select_line",c.VKq(15,nt,e.label))),c.xp6(2),c.Q6J("innerHTML",c.lcZ(3,11,c.lcZ(4,13,e.imageHtml)),c.oJD),c.xp6(4),c.ekj("primary",e.title),c.xp6(1),c.Oqu(e.title),c.xp6(1),c.Q6J("ngIf",e.subtitle)}}function rt(e,t){if(1&e&&(c.TgZ(0,"div",2),c.YNc(1,it,9,17,"button",3),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngForOf",e.lines)}}function ot(e,t){1&e&&(c.TgZ(0,"div",10),c._UZ(1,"mv-spinner"),c.qZA())}let at=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l){this.document=e,this.store=t,this.ticketActions=n,this.lineActions=i,this.permissionService=r,this.uiActions=o,this.analyticsService=a,this.ticketErrorService=s,this.translateService=l,this.lines=[],this.isLoading=!1}get state(){return this.store.getState()}calcDistancesFromLocationToAllStations(e){const t=new Map;return this.state.line.lineDirections.forEach(n=>{n.lineOptions.forEach(n=>{n.stops.forEach((n,i)=>{if(!t.has(n.id)){const i=Xe._.fromMvLatLon(n.location),r=1e3*(0,Ce.YQ)(e.latitude,e.longitude,i.lat,i.lng,"K");t.set(n.id,{distance:r,location:i})}})})}),t}onLineClick(e,t){return(0,i.mG)(this,void 0,void 0,function*(){const{activationPrices:n,source:i}=this.state.ticket.data;if(this.analyticsService.trackMotEvent("select_line_action",this.isLineSuggestedByAlgorithm?`${e.groupId}_${e.lineId}`:e.groupId,""),this.store.dispatch(this.ticketActions.setData({isLineSuggestedByAlgorithm:this.isLineSuggestedByAlgorithm})),1===n.codePrices.length&&this.ticketActions.isAllStopsHasTheSameDiscount(n.codePrices[0]))return void this.skipStationSelection(e,n.codePrices[0]);if(this.isLoading=!0,yield this.store.dispatch(this.lineActions.loadLineGroup(e.groupId,e.lineId,void 0,!1,!0)),this.filterLinesWithoutStops(),!this.state.line.lineDirections.length){this.stopLoading();let n=this.translateService.instant("web_payment_mot_activation_trip_empty_message");return n.includes("\\n")&&(n=n.replace(/\\n/g,"<br/>")),void this.ticketErrorService.displayError(a.Y.Bus,this.onLineClick.bind(this,e,t),()=>{},{text:n})}this.store.dispatch(this.uiActions.setLoading(!0));const r=this.calcDistancesFromLocationToAllStations(i.location);this.store.dispatch(this.ticketActions.setData({stopDistances:r}));const o=this.ticketActions.isSingleFareLine(),s=o?1:0;if(this.isLineSuggestedByAlgorithm)this.analyticsService.trackMotEvent("mot_line_clicked",`${this.originStopId()}, ${e.lineId}, ${e.groupId}, ${t}, ${s}`,"");else{yield this.findUserLineDirection();const{lineId:e}=this.state.line.selectedLine;this.analyticsService.trackMotEvent("line_search_action",`${e}, ${t}, ${this.lastQueryString}, ${s}`,"")}o?this.skipStationSelection(e,this.ticketActions.calcRangePricesForLineGroup().minPrice):this.goToSelectStopScreen(e.groupId),this.stopLoading()})}originStopId(){const e={stopId:-1,distance:Number.MAX_SAFE_INTEGER};return this.state.ticket.data.stopDistances.forEach((t,n)=>{t.distance<e.distance&&(e.stopId=n,e.distance=t.distance)}),e.stopId}goToSelectStopScreen(e){this.store.dispatch(this.ticketActions.setData({selectedLineGroupId:e})),this.store.dispatch(this.ticketActions.setStep(Se.V.SelectStop))}filterLinesWithoutStops(){const e=this.state.line.lineDirections.filter(e=>{var t;return null===(t=e.lineOptions)||void 0===t?void 0:t.length});e.length!==this.state.line.lineDirections.length&&(this.store.dispatch(this.lineActions.getLineDataAction(this.state.line.lineGroup,e,this.state.line.selectedDayOffset)),e.length&&!this.state.line.lineDirections.some(e=>e.lineId===this.state.line.selectedLine.lineId)&&this.store.dispatch(this.lineActions.selectLine(e[0],!1)))}findUserLineDirection(){return(0,i.mG)(this,void 0,void 0,function*(){let e;try{e=(yield this.permissionService.getLocation()).coords}catch(a){return null}const{lineDirections:t}=this.state.line,{stopDistances:n}=this.state.ticket.data,i=this.calcDistancesFromLocationToAllStations(e);let r=Number.MAX_VALUE,o=null;if(t.forEach(e=>{e.lineOptions.forEach(t=>{const a=t.stops.map(e=>n.get(e.id).distance),s=Math.min(...a);if(s>=r)return;const l=a.findIndex(e=>e===s),c=t.stops[l],d=t.stops[l+1];if(!c||!d)return;const u=n.get(c.id).distance<i.get(c.id).distance,p=i.get(d.id).distance<n.get(d.id).distance;u&&p&&(r=s,o=e.lineId)})}),o){const e=t.find(e=>e.lineId===o);this.store.dispatch(this.lineActions.selectLine(e,!1))}})}skipStationSelection(e,t){const n=this.state.ticket.data.stopDistances.keys().next().value;this.store.dispatch(this.ticketActions.setBusPrice(n,{lineTitle:e.title||e.subtitle,imageHtml:e.imageHtml,codePrice:t})),this.store.dispatch(this.ticketActions.openBusTicketsApprovalPopup())}tabIndex(e){return 0!==e||this.state.ticket.data.destination?-1:0}onKeydown(e,t){"ArrowUp"===e.key&&t-1>=0?(e.preventDefault(),this.setSelectedFocus(t-1)):"ArrowDown"===e.key&&t+1<this.lines.length?(e.preventDefault(),this.setSelectedFocus(t+1)):"Enter"===e.key&&(e.preventDefault(),this.onLineClick(this.lines[t],t))}setSelectedFocus(e){const t=this.document.getElementById(`line_${e}`);t&&(t.focus(),t.scrollIntoView({block:"center"}))}stopLoading(){this.isLoading=!1,this.store.dispatch(this.uiActions.setLoading(!1))}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.K0),c.Y36(p.d),c.Y36(g.Q),c.Y36(et.J),c.Y36(De.$),c.Y36(f.V),c.Y36(b.y),c.Y36(_.C),c.Y36(y.sK))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-ticket-line-list"]],inputs:{lines:"lines",lastQueryString:"lastQueryString",isLineSuggestedByAlgorithm:"isLineSuggestedByAlgorithm"},decls:2,vars:2,consts:[["class","results-wrapper","role","list",4,"ngIf"],["class","spinner bus-line-list",4,"ngIf"],["role","list",1,"results-wrapper"],["class","line-item with-seperation","role","listitem",3,"tabIndex","id","click","keydown",4,"ngFor","ngForOf"],["role","listitem",1,"line-item","with-seperation",3,"tabIndex","id","click","keydown"],[1,"line-image",3,"innerHTML"],[1,"line-title-wrapper","flex-col"],[1,"line-title"],["class","line-detail",4,"ngIf"],[1,"line-detail"],[1,"spinner","bus-line-list"]],template:function(e,t){1&e&&(c.YNc(0,rt,2,1,"div",0),c.YNc(1,ot,2,0,"div",1)),2&e&&(c.Q6J("ngIf",t.lines.length),c.xp6(1),c.Q6J("ngIf",t.isLoading))},directives:[s.O5,s.sg,T.O],pipes:[y.X$,E.z,s.Ov],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-ticket-line-list{display:block}mv-bus-ticket-line-list .empty-results .icon{fill:#bdc3c7;display:block;height:32px;margin:26px auto 0;width:32px}mv-bus-ticket-line-list .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;text-align:center;padding:20px}mv-bus-ticket-line-list .spinner.bus-line-list{background-color:#306cea0d;z-index:5}mv-bus-ticket-line-list .spinner.bus-line-list mv-spinner{background-color:#fff;border-radius:50%;padding:8px;box-shadow:0 1px 4px #00000040}\n"],encapsulation:2}),e})();function st(e,t){1&e&&(c.TgZ(0,"div",3),c._UZ(1,"mv-spinner"),c.qZA())}function lt(e,t){if(1&e&&c._UZ(0,"mv-bus-ticket-line-list",4),2&e){const e=c.oxw();c.Q6J("lines",e.suggestedLines)("isLineSuggestedByAlgorithm",!0)}}function ct(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",5),c.NdJ("keydown.enter",function(){return c.CHM(e),c.oxw().goToSearchPage()})("click",function(){return c.CHM(e),c.oxw().goToSearchPage()}),c._UZ(1,"svg-icon",6),c.ALo(2,"translate"),c.TgZ(3,"p"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("tabIndex",e.tabIndex),c.xp6(1),c.Q6J("titleText",c.lcZ(2,3,"payment_bus_select_line_noline")),c.xp6(3),c.Oqu(c.lcZ(5,5,"payment_bus_select_line_noline"))}}let dt=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c){this.store=e,this.ticketService=t,this.locationService=n,this.permissionService=i,this.ticketActions=r,this.lineTemplateService=o,this.imageService=a,this.metroService=s,this.analyticsService=l,this._zone=c,this.suggestedLines=[],this.isLoading=!1}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){this.isLoading=!0;const{metroId:e,currentMetro:t}=this.state.metro,{source:n,activationPrices:i}=this.state.ticket.data;let r=null,o=null;try{const a=yield this.ticketService.getNearestLines(n.location,i.agencyId,e,t.revisionNumber,t.timeZoneOffset);r=a.lines,o=a.log}catch(s){return this.isLoading=!1,void this.store.dispatch(this.ticketActions.setStep(Se.V.SearchLines))}(null==r?void 0:r.length)?(this._zone.run(()=>{this.suggestedLines=this.convertGroupLinesToDisplayLine(r),this.isLoading=!1}),this.analyticsService.trackMotEvent("fare_line_trip_algorighm",["["+o.radius,o.time,o.agencyId,JSON.stringify(o.selectedLocation),o.chosenTime,o.from,o.to,o.stopsCount,o.stopId,o.distance,o.count,o.selectedItem,o.isRealTime,o.numberOfResult].toString()+"]","")):(this._zone.run(()=>this.isLoading=!1),this.store.dispatch(this.ticketActions.setStep(Se.V.SearchLines)),this.analyticsService.trackMotEvent("line_search","source = algorithm",""));let a="0";if(this.suggestedLines.length){const e=this.suggestedLines.slice(0,10).map(e=>`${e.groupId}_${e.lineId}`).join(", ");a=`${this.suggestedLines.length}; ${e}`}this.analyticsService.trackMotEvent("View tab",`pick_line_impression, ${a}`,"")})}convertGroupLinesToDisplayLine(e){const t=this.metroService.getImageIndexForAgency(this.state.ticket.data.activationPrices.agencyId),n=[];for(const i of e)for(const e of i.lineSummaries){const{destination:r,lineId:o}=e,{groupId:a,lineNumber:s}=i;n.push({title:r,groupId:a,lineId:o,imageHtml:this.imageService.getLineImageHTML(i,t,void 0,void 0,s),label:r})}return n}get state(){return this.store.getState()}goToSearchPage(){this.analyticsService.trackMotEvent("select_line_action","choose_another_line",""),this.analyticsService.trackMotEvent("line_search","source = pick_line",""),this.store.dispatch(this.ticketActions.setStep(Se.V.SearchLines))}get tabIndex(){return this.state.ticket.data.destination?-1:0}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(u.wP),c.Y36(Qe.a),c.Y36(De.$),c.Y36(g.Q),c.Y36(Ke.$),c.Y36(S.KD),c.Y36(h.V),c.Y36(b.y),c.Y36(c.R0b))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-ticket-suggest-lines"]],decls:3,vars:3,consts:[["class","spinner",4,"ngIf"],[3,"lines","isLineSuggestedByAlgorithm",4,"ngIf"],["class","choose-another","role","button",3,"tabIndex","keydown.enter","click",4,"ngIf"],[1,"spinner"],[3,"lines","isLineSuggestedByAlgorithm"],["role","button",1,"choose-another",3,"tabIndex","keydown.enter","click"],["src","images/icons/search.svg","mvAccessibleSVG","",1,"search-icon",3,"titleText"]],template:function(e,t){1&e&&(c.YNc(0,st,2,0,"div",0),c.YNc(1,lt,1,2,"mv-bus-ticket-line-list",1),c.YNc(2,ct,6,7,"div",2)),2&e&&(c.Q6J("ngIf",t.isLoading),c.xp6(1),c.Q6J("ngIf",!t.isLoading),c.xp6(1),c.Q6J("ngIf",!t.isLoading))},directives:[s.O5,T.O,at,x.bk,w.m],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-ticket-suggest-lines .choose-another{display:flex;align-items:center;position:relative;z-index:1}mv-bus-ticket-suggest-lines .choose-another p{color:#306cea;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;font-weight:600;padding:18px 0;margin:0}mv-bus-ticket-suggest-lines .choose-another .search-icon{width:20px;height:20px;padding:16px 20px;margin:0}html[dir=ltr] mv-bus-ticket-suggest-lines .choose-another .search-icon{padding-right:11px}html[dir=rtl] mv-bus-ticket-suggest-lines .choose-another .search-icon{padding-left:11px}html[dir=rtl] mv-bus-ticket-suggest-lines .choose-another .search-icon svg{transform:scaleX(-1)}mv-bus-ticket-suggest-lines .choose-another .search-icon svg path{fill:#306cea}\n"],encapsulation:2}),e})();var ut=n(2122),pt=n(53792),ht=n(54366),mt=n(99650),gt=n(73961),ft=n(53448);function vt(e,t){1&e&&(c.TgZ(0,"p"),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_bus_noline_empty")))}function yt(e,t){if(1&e&&(c.TgZ(0,"div",9),c._UZ(1,"svg-icon",10),c.ALo(2,"translate"),c.YNc(3,vt,3,3,"p",11),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("titleText",c.lcZ(2,2,"NoTripPlanFoundTitle")),c.xp6(2),c.Q6J("ngIf",e.isInSearch&&!e.isLoading)}}function bt(e,t){1&e&&(c.TgZ(0,"div",12),c._UZ(1,"mv-spinner"),c.qZA())}let _t=(()=>{class e{constructor(e,t,n,i,r,o){this.searchActions=e,this.store=t,this.lineListService=n,this.metroService=i,this.analyticsService=r,this._zone=o,this.search$=new Be.x,this.lastSearched="",this.list=[],this.searchEvent=new c.vpe}ngOnInit(){const e=this.metroService.getAgency(this.state.ticket.data.activationPrices.agencyId);this.agencyName=e?e.agencyName:"",this.search$.pipe((0,ut.b)(400),(0,pt.x)(),(0,ht.w)(e=>(this.isInSearch=!!e,this.setInfDefaults(),this.next(e)))).subscribe(e=>this.searchEvent.emit())}next(e){return(0,i.mG)(this,void 0,void 0,function*(){if(""===e)return;this.isLoading=!0;const t=yield this.lineListService.searchLines(e+" "+this.agencyName,0,100);if(e!==this.searchInput)return;let n=[];t.lineGroupSections.forEach(e=>{e.agencyId===this.state.ticket.data.activationPrices.agencyId&&(n=this.lineListService.normaliseLines(e.items,e.agencyId).map(e=>({groupId:e.lineGroupId,title:e.lineName.primary,subtitle:e.lineName.secondary,imageHtml:e.imageHtml,label:[e.lineName.primary,e.lineName.secondary].filter(e=>!!e).join(", ")})))}),this._zone.run(()=>{this.list=n,this.isLoading=!1}),this.analyticsService.trackMotEvent("line search results",this.list.length,"")})}setInfDefaults(){this.list=[]}get state(){return this.store.getState()}search(){this.lastSearched!==this.searchInput&&(this.lastSearched=this.searchInput,this.search$.next(this.searchInput))}clearSearch(){!this.searchInput||(this.searchInput="",this.search$.next(""))}get tabIndex(){return this.state.ticket.data.destination?-1:0}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(mt.P),c.Y36(p.d),c.Y36(gt.le),c.Y36(h.V),c.Y36(b.y),c.Y36(c.R0b))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-ticket-search-lines"]],decls:13,vars:19,consts:[["role","search",1,"search-zone"],[1,"filter-container"],["src","images/icons/search.svg","mvAccessibleSVG","",1,"input-icon",3,"titleText"],["id","lines-filter","type","text","autocomplete","off",1,"lines-filter",3,"placeholder","ngModel","tabIndex","ngModelChange","keyup"],["role","button",1,"clear-input",3,"keydown.enter","click"],["src","images/icons/close.svg","mvAccessibleSVG","",1,"icon",3,"titleText"],["class","no-results",4,"ngIf"],["class","spinner bus-search-line",4,"ngIf"],[3,"lines","lastQueryString","isLineSuggestedByAlgorithm"],[1,"no-results"],["src","images/tickets/bus-search.svg","mvAccessibleSVG","",1,"icon","no-results-image",3,"titleText"],[4,"ngIf"],[1,"spinner","bus-search-line"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c._UZ(2,"svg-icon",2),c.ALo(3,"translate"),c.TgZ(4,"input",3),c.NdJ("ngModelChange",function(e){return t.searchInput=e})("keyup",function(){return t.search()}),c.ALo(5,"translate"),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"a",4),c.NdJ("keydown.enter",function(){return t.clearSearch()})("click",function(){return t.clearSearch()}),c._UZ(8,"svg-icon",5),c.ALo(9,"translate"),c.qZA(),c.qZA(),c.qZA(),c.YNc(10,yt,4,4,"div",6),c.YNc(11,bt,2,0,"div",7),c._UZ(12,"mv-bus-ticket-line-list",8)),2&e&&(c.xp6(2),c.Q6J("titleText",c.lcZ(3,11,"action_search")),c.xp6(2),c.Q6J("placeholder",c.lcZ(5,13,"payment_bus_select_line_noline_hint"))("ngModel",t.searchInput)("tabIndex",t.tabIndex),c.uIk("title",c.lcZ(6,15,"payment_bus_select_line_noline_hint")),c.xp6(4),c.Q6J("titleText",c.lcZ(9,17,"close")),c.xp6(2),c.Q6J("ngIf",!t.list.length),c.xp6(1),c.Q6J("ngIf",t.isLoading),c.xp6(1),c.Q6J("lines",t.list)("lastQueryString",t.searchInput)("isLineSuggestedByAlgorithm",!1))},directives:[x.bk,w.m,ft.Fj,ft.JJ,ft.On,s.O5,at,T.O],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-ticket-search-lines{display:block}mv-bus-ticket-search-lines mv-bus-ticket-line-list{margin-top:0}mv-bus-ticket-search-lines .search-zone{border-bottom:1px solid #ECF0F1;padding:8px 20px 16px;position:-webkit-sticky;position:sticky;top:56px;z-index:2;width:100%;box-sizing:border-box;background:#fff}mv-bus-ticket-search-lines .search-zone .filter-container{display:flex;flex-direction:column}mv-bus-ticket-search-lines .search-zone .filter-container:focus{border:1px solid red}mv-bus-ticket-search-lines .search-zone .filter-container .input-icon{width:20px;height:20px;margin:0 8px;position:absolute;top:18px}html[dir=ltr] mv-bus-ticket-search-lines .search-zone .filter-container .input-icon{margin-right:12px}html[dir=rtl] mv-bus-ticket-search-lines .search-zone .filter-container .input-icon{margin-left:12px}html[dir=rtl] mv-bus-ticket-search-lines .search-zone .filter-container .input-icon svg{transform:scaleX(-1)}mv-bus-ticket-search-lines .search-zone .filter-container .input-icon svg path{fill:#306cea}mv-bus-ticket-search-lines .search-zone .filter-container .clear-input{display:none}mv-bus-ticket-search-lines .search-zone .filter-container .lines-filter{display:flex;align-items:center;flex-grow:1;font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#000;height:1.1764705882rem;box-shadow:0 1px 4px #00000040;border-radius:20px;padding:10px 15px;border:1px solid #2E69E7;-webkit-appearance:none}html[dir=ltr] mv-bus-ticket-search-lines .search-zone .filter-container .lines-filter{padding-left:40px}html[dir=rtl] mv-bus-ticket-search-lines .search-zone .filter-container .lines-filter{padding-right:40px}mv-bus-ticket-search-lines .search-zone .filter-container .lines-filter::-moz-placeholder{color:#7a7c7f}mv-bus-ticket-search-lines .search-zone .filter-container .lines-filter::placeholder{color:#7a7c7f}mv-bus-ticket-search-lines .no-results{position:absolute;margin:40px auto 0;left:0;right:0;text-align:center;padding:0 20px}mv-bus-ticket-search-lines .no-results .no-results-image{width:120px;height:120px}mv-bus-ticket-search-lines .no-results p{margin:16px 0 0;text-align:center;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000}mv-bus-ticket-search-lines .spinner.bus-search-line{position:relative;height:200px}\n"],encapsulation:2}),e})();var Tt=n(26743),St=n(99528),xt=n(99957),wt=n(82596),kt=n(67731);let Mt=(()=>{class e extends Ve.d{constructor(e,t,n,i,r,o,a,s,l,d,u,p){super(t,n,i,"busTicketMapElement","BusTicketsStopsMap"),this.document=e,this.store=t,this.customerService=n,this.uiActions=i,this.storeHelper=r,this.nearbyActions=o,this.locationService=a,this.imageService=s,this.permissionService=l,this.nearbyService=d,this.lineActions=u,this._zone=p,this.defaultZoom=16,this.unsubscribes=[],this.selectStopEvent=new c.vpe}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){yield this.initLeafletMap(this.defaultZoom),this.isMapFocused=!0;const{latitude:e,longitude:t}=this.state.ticket.data.source.location;L.marker({lat:e,lng:t},{icon:this.icons[St.$h.From],zIndexOffset:1e3,keyboard:!1}).addTo(this.map),this.drawLine(),this.store.dispatch(this.lineActions.readMapData()),this.centerMapOnUserLocation(),this.unsubscribes.push(this.storeHelper.subscribe("line.linesMapHasNewData",e=>{e&&(this.drawLine(),this.store.dispatch(this.lineActions.readMapData()))})),this.unsubscribes.push(this.storeHelper.subscribe("ticket.data.destination",()=>{this.markSelectedStop()})),this.map.on("movestart",()=>{this.isMapFocused=!1}),this.map.on("zoomend",e=>{this.markSelectedStop()}),this.map.on("click",e=>{const{target:t}=e.originalEvent,n=t.id||t.parentElement.id;if(n.startsWith("stopIndex-")){const e=Number(n.replace("stopIndex-",""));if(isNaN(e))return;this.selectStopEvent.emit(e)}})})}getSelectedStopElement(){var e;const{line:t,ticket:n}=this.state;let i;if(null===(e=n.data.destination)||void 0===e?void 0:e.stopId){const e=t.displayedLine.stops.findIndex(e=>e.id===n.data.destination.stopId);i=this.document.getElementById(`stopIndex-${e}`)}return i}focusOnMap(){this.map.setView(this.state.ticket.data.destination.location,this.defaultZoom)}markSelectedStop(){const e=this.getSelectedStopElement(),t=this.document.getElementsByClassName("selected-stop").item(0);t&&(t.classList.toggle("selected-stop",!1),t.style.backgroundColor="#EDEFF3",t.children.item(0).classList.toggle("stop-clickable-zone",!0)),e&&(e.classList.toggle("selected-stop",!0),e.style.backgroundColor="#"+this.state.line.lineGroup.color,e.children.item(0).classList.toggle("stop-clickable-zone",!1))}ngOnDestroy(){var e;null===(e=this.mapLocation)||void 0===e||e.onDestroy(),this.unsubscribes.forEach(e=>e()),this.map&&(this.map.remove(),this.map=null)}get state(){return this.store.getState()}centerMapOnUserLocation(){const{latitude:e,longitude:t}=this.state.ticket.data.source.location;this.map.setView({lat:e,lng:t},this.defaultZoom)}refreshSize(){this._zone.run(()=>this.map.invalidateSize())}focusOnUserLocation(){this.centerMapOnUserLocation(),setTimeout(()=>this.isMapFocused=!0,500)}drawLine(){const{lineGroup:e,displayedLine:t}=this.state.line;if(!e||!t)return;const n=`#${e.color}`,{stops:i,shape:r}=t;if(this.logger.log("onLineDisplay",{color:e.color,shape:r,stops:i}),this.removeLinePolyline(),!r||!r.encodedShape)return;const o=new Date;this.logger.log("drawRoute BEFORE");const a=Ce.Ry(r.encodedShape);if(null==a?void 0:a.length){const e=i.map((e,t)=>Object.assign(Object.assign({},Xe._.fromMvLatLon(e.location)),{stopName:e.name,stopIndex:t})),{futurePoints:t,passedPoints:r,nearestStopIndex:o}=this.splitPassedPoint(e,a);e.slice(0,o+1).forEach(e=>delete e.stopIndex),this.pathShadow=L.polyline(a).addTo(this.map),this.pathHighlight=L.polyline(a).addTo(this.map),this.futurePathRoute=L.polyline(t).addTo(this.map),this.passedPathRoute=L.polyline(r).addTo(this.map),this.pathShadow.setStyle({color:"#383838",weight:10,opacity:1}),this.pathHighlight.setStyle({color:"#fafafa",weight:8,opacity:1}),this.futurePathRoute.setStyle({color:n,weight:3,opacity:1}),this.passedPathRoute.setStyle({color:"#BDC3C7",weight:3,opacity:1}),this.createStopMarkers(n,e,a,!1,!1,{keyboard:!1}),this.fitBoundsByPoints(a)}else this.removeLinePolyline();const s=new Date;this.logger.log("drawRoute AFTER:"+(s.valueOf()-o.valueOf()))}splitPassedPoint(e,t){const{line:n,ticket:i}=this.state,r=n.displayedLine.stops.map(e=>i.data.stopDistances.get(e.id).distance),o=Math.min(...r),a=r.findIndex(e=>e===o),s=e[a],l=t.map(e=>(0,Ce.YQ)(s.lat,s.lng,e.lat,e.lng,"K")),c=Math.min(...l),d=l.findIndex(e=>e===c);return{passedPoints:t.slice(0,d+1),futurePoints:t.slice(d),nearestStopIndex:a}}removeLinePolyline(){var e,t,n,i;null===(e=this.passedPathRoute)||void 0===e||e.remove(),null===(t=this.pathShadow)||void 0===t||t.remove(),null===(n=this.pathHighlight)||void 0===n||n.remove(),null===(i=this.futurePathRoute)||void 0===i||i.remove(),this.stopMarkers.forEach(e=>null==e?void 0:e.remove()),this.linePolyline&&(this.map.removeLayer(this.linePolyline),this.linePolyline=null)}drawEilatPolygon(){const e=this.state.ticket.data.activationPrices.discountRegions[0].polygons.map(e=>Ce.Ry(e)),t=["yellow","green","blue","brown","red"];e.forEach((e,n)=>{L.polyline(e).addTo(this.map).setStyle({color:t[n],weight:1,opacity:1})})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.K0),c.Y36(p.d),c.Y36(xt.v),c.Y36(f.V),c.Y36($e.N),c.Y36(wt.H),c.Y36(Qe.a),c.Y36(S.KD),c.Y36(De.$),c.Y36(kt.M),c.Y36(et.J),c.Y36(c.R0b))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-stops-map"]],outputs:{selectStopEvent:"selectStopEvent"},features:[c.qOj],decls:4,vars:5,consts:[["id","busTicketMapElement",1,"nearby-map"],["tabindex","0",1,"map-focus-button",3,"click","keydown.enter"],["src","images/icons/current_location.svg","mvAccessibleSVG","",1,"svg-icon",3,"titleText"]],template:function(e,t){1&e&&(c._UZ(0,"div",0),c.TgZ(1,"div",1),c.NdJ("click",function(){return t.focusOnUserLocation()})("keydown.enter",function(){return t.focusOnUserLocation()}),c._UZ(2,"svg-icon",2),c.ALo(3,"translate"),c.qZA()),2&e&&(c.xp6(1),c.ekj("map-focused",!!t.isMapFocused),c.xp6(1),c.Q6J("titleText",c.lcZ(3,3,"user_location_description")))},directives:[x.bk,w.m],pipes:[y.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-stops-map{position:relative;width:100%;height:inherit}mv-bus-tickets-stops-map .nearby-map{width:100%;height:100%}mv-bus-tickets-stops-map .nearby-map .stop-div-icon div{display:flex;background-color:#edeff3;border:1px solid #292A30;border-radius:50%;box-sizing:border-box;height:100%;width:100%;box-shadow:0 0 6px #0009;transition:all .25s ease-in-out}mv-bus-tickets-stops-map .nearby-map .stop-div-icon div.selected-stop{transform:scale(2);transform-origin:center;box-shadow:0 0 6px #0009,inset 0 0 0 .5px #3f3f3f,inset 0 0 0 1.5px #fff;border:none}mv-bus-tickets-stops-map .nearby-map .stop-div-icon div div.stop-clickable-zone{width:400%;height:400%;margin:-150%}mv-bus-tickets-stops-map .nearby-map .stop-div-icon div div.stop-invisible{box-shadow:none;background:transparent;outline:none;border:none}mv-bus-tickets-stops-map .nearby-map .stop-icon .mvf-wrapper{height:36px}mv-bus-tickets-stops-map .nearby-map .dockless-vehicle-icon .mvf-wrapper{height:36px}mv-bus-tickets-stops-map .nearby-map .bike-icon .mvf-wrapper{height:36px}mv-bus-tickets-stops-map .map-focus-button{position:absolute;display:flex;justify-content:center;-webkit-justify-content:center;align-items:center;-webkit-align-items:center;width:2.3529411765rem;height:2.3529411765rem;top:16px;z-index:999;background:white;border-radius:50%;box-shadow:0 1px 8px #0003}html[dir=ltr] mv-bus-tickets-stops-map .map-focus-button{left:16px}html[dir=rtl] mv-bus-tickets-stops-map .map-focus-button{right:16px}mv-bus-tickets-stops-map .map-focus-button:before{content:"";border-radius:50%;width:100%;height:100%;position:absolute;z-index:-1}mv-bus-tickets-stops-map .map-focus-button:active:before{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards}mv-bus-tickets-stops-map .map-focus-button svg path{fill:#525357;transition:fill .3s ease-in-out}mv-bus-tickets-stops-map .map-focus-button.map-focused svg path{fill:#0a73eb}\n'],encapsulation:2}),e})();var Lt=n(43049),At=n(86607);function It(e,t){if(1&e&&(c.TgZ(0,"div",12),c._uU(1),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Oqu(e.title)}}function Et(e,t){if(1&e&&(c.TgZ(0,"div",13),c._uU(1),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Oqu(e.subTitle)}}function Ct(e,t){if(1&e&&(c.TgZ(0,"div",9),c.YNc(1,It,2,1,"div",10),c.YNc(2,Et,2,1,"div",11),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.title),c.xp6(1),c.Q6J("ngIf",e.subTitle)}}function Dt(e,t){if(1&e&&(c.TgZ(0,"option",20),c._uU(1),c.qZA()),2&e){const e=t.$implicit,n=c.oxw(3);c.Q6J("ngValue",e),c.xp6(1),c.hij(" ",n.getLineTitle(e)," ")}}function Pt(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"select",18),c.NdJ("ngModelChange",function(t){return c.CHM(e),c.oxw(2).onLineChange(t)}),c.ALo(1,"translate"),c.YNc(2,Dt,2,2,"option",19),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("ngModel",e.selectedLine),c.uIk("aria-label",c.lcZ(1,3,"line_change_direction")),c.xp6(2),c.Q6J("ngForOf",e.state.line.lineDirections)}}function Ot(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",14),c.YNc(1,Pt,3,5,"select",15),c.TgZ(2,"div",16),c.NdJ("keydown.enter",function(){return c.CHM(e),c.oxw().toggleLineDirection()})("click",function(){return c.CHM(e),c.oxw().toggleLineDirection()}),c._UZ(3,"svg-icon",17),c.TgZ(4,"span"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.state.line.lineDirections.length>2),c.xp6(4),c.Oqu(c.lcZ(6,2,"line_change_direction"))}}let Nt=(()=>{class e{constructor(e,t,n,i,r){this.store=e,this.lineActions=t,this.lineTemplateService=n,this.ticketActions=i,this.analyticsService=r}ngOnInit(){this.initTitles(),this.analyticsService.trackMotEvent("View tab","choose destination_station","")}get state(){return this.store.getState()}initTitles(){var e,t,n;const i=null===(n=null===(t=null===(e=this.state.line)||void 0===e?void 0:e.selectedLine)||void 0===t?void 0:t.presentationLine)||void 0===n?void 0:n[St.vU.RideMode];i&&(this.title=i.title||(i.subTitle?"":this.getLineTitle(this.state.line.selectedLine)),this.subTitle=i.subTitle,this.isLongName=i.title.length>8)}getLineTitle(e){let t="";if(!e)return t;const{origin:n,destination:i,type:r,title:o,presentationLine:a}=e;if(t=r===Lt.SP.SUBGROUP?o:n&&i?`${n} ${this.lineTemplateService.getArrowDelimiterToken()} ${i}`:n||i,!t){const e=null==a?void 0:a[St.vU.RideMode];t=o||(null==e?void 0:e.title)||(null==e?void 0:e.subTitle)||""}return t}onLineChange(e){this.store.dispatch(this.lineActions.selectLine(e,!1)),this.store.dispatch(this.ticketActions.setData({destination:void 0})),this.initTitles()}toggleLineDirection(){if(this.analyticsService.trackMotEvent("select_destination_action","switch_direction",""),2!==this.state.line.lineDirections.length)return;const{lineDirections:e,displayedLine:t}=this.state.line,n=e.find(e=>e.lineId!==t.lineId);this.onLineChange(n)}onLineOptionChange(e){this.store.dispatch(this.lineActions.selectLineOption(e))}getTranslateParams(...e){return{param1:e[0]}}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(et.J),c.Y36(Ke.$),c.Y36(g.Q),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-stops-drag-zone"]],decls:12,vars:11,consts:[[1,"drag-handle"],[1,"lines-header-container"],[1,"line-group-header"],[1,"line-info-wrapper"],[1,"line-image",3,"innerHTML"],[1,"line-container"],[1,"line-header"],["class","line-name","aria-hidden","false","style","",4,"ngIf"],["class","dropdown-menu",4,"ngIf"],["aria-hidden","false",1,"line-name"],["class","line-title","role","heading","aria-level","2",4,"ngIf"],["class","line-subtitle","role","heading","aria-level","2",4,"ngIf"],["role","heading","aria-level","2",1,"line-title"],["role","heading","aria-level","2",1,"line-subtitle"],[1,"dropdown-menu"],["class","lines-dropdown",3,"ngModel","ngModelChange",4,"ngIf"],["tabindex","0",1,"menu-label",3,"keydown.enter","click"],["src","images/tickets/direction.svg"],[1,"lines-dropdown",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"]],template:function(e,t){1&e&&(c._UZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c._UZ(4,"span",4),c.ALo(5,"safeHtml"),c.ALo(6,"async"),c.ALo(7,"asyncify"),c.qZA(),c.qZA(),c.TgZ(8,"div",5),c.TgZ(9,"div",6),c.YNc(10,Ct,3,2,"div",7),c.qZA(),c.qZA(),c.qZA(),c.YNc(11,Ot,7,4,"div",8)),2&e&&(c.xp6(2),c.ekj("long-line-name",t.isLongName),c.xp6(2),c.Q6J("innerHTML",c.lcZ(5,5,c.lcZ(6,7,c.lcZ(7,9,t.state.line.lineGroup.imageHtml))),c.oJD),c.xp6(6),c.Q6J("ngIf",t.state.line.selectedLine),c.xp6(1),c.Q6J("ngIf",t.state.line.lineDirections.length>1))},directives:[s.O5,x.bk,ft.EJ,ft.JJ,ft.On,s.sg,ft.YN,ft.Kr],pipes:[E.z,s.Ov,At.N,y.X$],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-stops-drag-zone{height:calc(100% - 17px);display:block}mv-bus-tickets-stops-drag-zone .drag-handle{padding:8px 0 4px}mv-bus-tickets-stops-drag-zone .drag-handle:before{content:"";display:block;top:.4705882353rem;width:1.8823529412rem;height:.2352941176rem;border-radius:2px;background-color:#bdc3c7;margin:auto}mv-bus-tickets-stops-drag-zone .lines-header-container{display:flex;align-items:center;padding:0 24px;height:3.4117647059rem}html[dir=ltr] mv-bus-tickets-stops-drag-zone .lines-header-container .line-group-header{margin-right:11px}html[dir=rtl] mv-bus-tickets-stops-drag-zone .lines-header-container .line-group-header{margin-left:11px}mv-bus-tickets-stops-drag-zone .lines-header-container .line-container{flex-grow:1}mv-bus-tickets-stops-drag-zone .lines-header-container .line-container .line-header{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000;font-weight:600}mv-bus-tickets-stops-drag-zone .lines-header-container .line-container .line-header .line-name .line-subtitle:not(:only-child){font-weight:400}mv-bus-tickets-stops-drag-zone .dropdown-menu{position:relative;padding:0 24px}mv-bus-tickets-stops-drag-zone .dropdown-menu .lines-dropdown{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9;padding:4px 0}html[dir=ltr] mv-bus-tickets-stops-drag-zone .dropdown-menu .lines-dropdown{left:0}html[dir=rtl] mv-bus-tickets-stops-drag-zone .dropdown-menu .lines-dropdown{right:0}mv-bus-tickets-stops-drag-zone .dropdown-menu .lines-dropdown:focus+.menu-label{outline:auto}mv-bus-tickets-stops-drag-zone .dropdown-menu .lines-dropdown:hover+.menu-label{-webkit-animation:clickedEffect .6s ease-in-out forwards;animation:clickedEffect .6s ease-in-out forwards;outline:none}mv-bus-tickets-stops-drag-zone .dropdown-menu .menu-label{display:inline-flex;align-items:center}mv-bus-tickets-stops-drag-zone .dropdown-menu .menu-label svg-icon{margin:0}html[dir=ltr] mv-bus-tickets-stops-drag-zone .dropdown-menu .menu-label svg-icon{margin-right:11px}html[dir=rtl] mv-bus-tickets-stops-drag-zone .dropdown-menu .menu-label svg-icon{margin-left:11px}mv-bus-tickets-stops-drag-zone .dropdown-menu .menu-label span{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#306cea;font-weight:600}\n'],encapsulation:2}),e})();function Rt(e,t){1&e&&(c.TgZ(0,"p"),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_bus_select_stop_sub")))}function $t(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij("(",c.lcZ(2,1,"payment_vat_free"),")"))}const Yt=function(e){return{param1:e}};function Ft(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"p",2),c._uU(2),c.ALo(3,"translate"),c.ALo(4,"currency"),c.YNc(5,$t,3,3,"span",0),c.qZA(),c.TgZ(6,"p",3),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.hij(" ",c.xi3(3,3,"payment_bus_select_stop_fare",c.VKq(13,Yt,c.Dn7(4,6,e.price,e.selectedStopCodePrice.price.currencyCode,"symbol")))," "),c.xp6(3),c.Q6J("ngIf",e.ticketData.destination.discountRegionsId.length),c.xp6(2),c.Oqu(c.xi3(8,10,"payment_mot_passenger_distance",e.radiusParam))}}let Bt=(()=>{class e{constructor(e,t,n,i){this.store=e,this.ticketActions=t,this.translate=n,this.analyticsService=i,this.BusTicketStep=Se.V}get ticketData(){return this.store.getState().ticket.data}get price(){var e;const{discountRegionsId:t,codePrice:n}=this.ticketData.destination;let i;return t.length&&(i=null===(e=n.discountRegionPrices.find(e=>e.regionId===t[0]))||void 0===e?void 0:e.price),i||(i=n.price),Number((null==i?void 0:i.balance)/100).toFixed(2)}get selectedStopCodePrice(){var e;return null===(e=this.ticketData.destination)||void 0===e?void 0:e.codePrice}get radiusParam(){return{param1:this.translate.instant("units_kilometers_frac_short",{param1:this.selectedStopCodePrice.radius/1e3})}}goToApprovalScreen(){if(!this.selectedStopCodePrice)return;this.store.dispatch(this.ticketActions.openBusTicketsApprovalPopup());const{selectedLine:e,lineGroup:t,displayedLine:n}=this.store.getState().line;this.analyticsService.trackMotEvent("select_destination_action",`[${n.stops[this.originStopIndex].id}, ${e.lineId}, ${t.lineGroupId}, ${this.selectedStopIndex}]`,"")}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(g.Q),c.Y36(y.sK),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-price"]],inputs:{selectedStopIndex:"selectedStopIndex",originStopIndex:"originStopIndex"},decls:5,vars:8,consts:[[4,"ngIf"],[1,"pango-next-button",3,"tabIndex","click","keydown.enter"],[1,"fare"],[1,"distance"]],template:function(e,t){1&e&&(c.YNc(0,Rt,3,3,"p",0),c.YNc(1,Ft,9,15,"div",0),c.TgZ(2,"button",1),c.NdJ("click",function(){return t.goToApprovalScreen()})("keydown.enter",function(){return t.goToApprovalScreen()}),c._uU(3),c.ALo(4,"translate"),c.qZA()),2&e&&(c.Q6J("ngIf",!t.selectedStopCodePrice),c.xp6(1),c.Q6J("ngIf",t.selectedStopCodePrice),c.xp6(1),c.ekj("disabled",!t.selectedStopCodePrice),c.Q6J("tabIndex",t.selectedStopCodePrice?0:-1),c.xp6(1),c.hij(" ",c.lcZ(4,6,"action_next"),"\n"))},directives:[s.O5],pipes:[y.X$,s.H9],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-price{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center;background-color:#fff;border-top:1px solid #ECF0F1;padding:17px 20px;min-height:77px;box-sizing:border-box}mv-bus-tickets-price p{margin:0;color:#525357;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-bus-tickets-price .fare{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#000;font-weight:600;margin:0}mv-bus-tickets-price .distance{margin-top:4px}mv-bus-tickets-price .pango-next-button{padding:8px 16px;border-radius:24px;background-color:#306cea;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#fff;font-weight:600}html[dir=ltr] mv-bus-tickets-price .pango-next-button{margin-left:17px}html[dir=rtl] mv-bus-tickets-price .pango-next-button{margin-right:17px}mv-bus-tickets-price .pango-next-button.disabled{background-color:#83bbff;color:#fff}mv-bus-tickets-price .pango-next-button:focus{outline:2px solid #000}mv-bus-tickets-price .pango-next-button:hover{outline:none}\n"],encapsulation:2}),e})();function Ut(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",4),c.NdJ("click",function(){const t=c.CHM(e),n=t.$implicit,i=t.index;return c.oxw(2).onStopClick(n,i)})("keydown",function(t){const n=c.CHM(e).index;return c.oxw(2).onKeydown(t,n)}),c.TgZ(1,"div",5),c._uU(2),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,n=t.index,i=c.oxw(2);c.ekj("selected",i.isStopSelected(e))("grayed",n<i.nearestStopIndex),c.Q6J("id",i.getStopElementId(e.id))("tabIndex",n===i.nearestStopIndex?0:-1)("ngStyle",i.rightLineStyle(n)),c.xp6(2),c.hij(" ",e.name," ")}}function Zt(e,t){if(1&e&&(c.TgZ(0,"div",2),c.YNc(1,Ut,3,8,"div",3),c.qZA()),2&e){const e=c.oxw();c.uIk("aria-activedescendant",e.ariaSelectedStop),c.xp6(1),c.Q6J("ngForOf",e.state.line.displayedLine.stops)}}let jt=(()=>{class e{constructor(e,t,n,i,r){this.document=e,this.store=t,this.ticketActions=n,this.storeHelper=i,this.analyticsService=r}get state(){return this.store.getState()}ngAfterViewInit(){this.initNearestStop(),this.unsubscribe=this.storeHelper.subscribe("line.displayedLine",e=>{e&&this.initNearestStop()})}ngOnChanges(e){const{previousValue:t,currentValue:n}=e.selectedStopIndex;if(t!==n){const e=this.state.line.displayedLine.stops[n];this.onStopClick(e,n),this.scrollToStop(e.id)}}ngOnDestroy(){this.unsubscribe()}onStopClick(e,t){if(t<this.nearestStopIndex)return;this.selectedStopIndex=t;const n={stationName:e.name,stopId:e.id,location:Xe._.fromMvLatLon(e.location)};this.store.dispatch(this.ticketActions.setBusPrice(e.id,n)),this.analyticsService.trackMotEvent("select_destination_action","choose_destination","")}rightLineStyle(e){return e>=this.nearestStopIndex?{borderColor:"#"+this.state.line.lineGroup.color}:{}}initNearestStop(){const{line:e,ticket:t}=this.state,n=e.displayedLine.stops.map(e=>t.data.stopDistances.get(e.id).distance),i=Math.min(...n);this.nearestStopIndex=n.findIndex(e=>e===i)+1,this.nearestStopIndex===e.displayedLine.stops.length&&this.nearestStopIndex--,setTimeout(()=>{this.scrollToStop(this.state.line.displayedLine.stops[this.nearestStopIndex].id)})}scrollToStop(e){const t=this.getStopElementId(e),n=this.document.getElementById(t);null==n||n.scrollIntoView(!0)}isStopSelected(e){const{destination:t}=this.state.ticket.data;return!!(null==t?void 0:t.location)&&t.stopId===e.id}onKeydown(e,t){"ArrowUp"===e.key&&t-1>=this.nearestStopIndex?(e.preventDefault(),this.setSelectedFocus(t-1)):"ArrowDown"===e.key&&t+1<this.state.line.displayedLine.stops.length?(e.preventDefault(),this.setSelectedFocus(t+1)):"Enter"===e.key&&(e.preventDefault(),this.onStopClick(this.state.line.displayedLine.stops[t],t))}setSelectedFocus(e){var t;const n=this.getStopElementId(null===(t=this.state.line.displayedLine.stops[e])||void 0===t?void 0:t.id),i=this.document.getElementById(n);i&&(i.focus(),i.scrollIntoView({block:"center"}))}getStopElementId(e){return`stop-${e}`}get ariaSelectedStop(){return this.state.line.selectedStopId?this.getStopElementId(this.state.line.selectedStopId):null}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.K0),c.Y36(p.d),c.Y36(g.Q),c.Y36($e.N),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-stop-list"]],inputs:{selectedStopIndex:"selectedStopIndex"},features:[c.TTD],decls:2,vars:3,consts:[["class","stops-list","role","list",4,"ngIf"],[3,"originStopIndex","selectedStopIndex"],["role","list",1,"stops-list"],["class","stop-item","role","listitem",3,"selected","grayed","id","tabIndex","ngStyle","click","keydown",4,"ngFor","ngForOf"],["role","listitem",1,"stop-item",3,"id","tabIndex","ngStyle","click","keydown"],[1,"title"]],template:function(e,t){1&e&&(c.YNc(0,Zt,2,2,"div",0),c._UZ(1,"mv-bus-tickets-price",1)),2&e&&(c.Q6J("ngIf",null==t.state.line.displayedLine?null:t.state.line.displayedLine.stops),c.xp6(1),c.Q6J("originStopIndex",t.nearestStopIndex)("selectedStopIndex",t.selectedStopIndex))},directives:[s.O5,Bt,s.sg,s.PC],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-stop-list{display:flex;flex-direction:column;background:#FFFFFF;height:100%;-webkit-overflow-scrolling:touch}mv-bus-tickets-stop-list .spinner{margin-top:50px;text-align:center}mv-bus-tickets-stop-list .dropdown-menu{position:relative;display:inline-block}mv-bus-tickets-stop-list .dropdown-menu .lines-dropdown{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9;padding:4px 0}html[dir=ltr] mv-bus-tickets-stop-list .dropdown-menu .lines-dropdown{left:0}html[dir=rtl] mv-bus-tickets-stop-list .dropdown-menu .lines-dropdown{right:0}mv-bus-tickets-stop-list .dropdown-menu .lines-dropdown:focus+span{outline:auto}mv-bus-tickets-stop-list .lines-header-container{position:static;position:initial;width:100%;background-color:#fff;z-index:3}html body.mobile mv-bus-tickets-stop-list .lines-header-container{top:4.7058823529rem}html.privacy-notice body.mobile mv-bus-tickets-stop-list .lines-header-container{top:calc(4.7058823529rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-bus-tickets-stop-list .lines-header-container{top:calc(4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(4.7058823529rem + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(4.7058823529rem + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(4.7058823529rem + 60px + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body.mobile mv-bus-tickets-stop-list .lines-header-container{top:2.4705882353rem}html.privacy-notice body.mobile mv-bus-tickets-stop-list .lines-header-container{top:calc(2.4705882353rem + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile mv-bus-tickets-stop-list .lines-header-container{top:calc(2.4705882353rem + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html body[data-top-banner^=V].mobile:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(2.4705882353rem + 60px)}}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}@media only screen and (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px) and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-bus-tickets-stop-list .lines-header-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-bus-tickets-stop-list .lines-header-container{top:calc(2.4705882353rem + 60px + 4.7058823529rem)}}mv-bus-tickets-stop-list .date-header{background-color:#ecf0f1;box-sizing:border-box;display:block;line-height:1;overflow:hidden;padding:7px 20px 5px;text-overflow:ellipsis;font-size:.9411764706rem;color:#292a30;white-space:nowrap;width:100%}mv-bus-tickets-stop-list .line-group-header{display:flex;padding:13px 20px;position:relative;font-size:.8235294118rem;min-height:27px;width:100%;box-sizing:border-box}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header{padding-left:40px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header{padding-right:40px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-bus-tickets-stop-list .line-group-header{padding:11px 20px 10px;min-height:20px}}mv-bus-tickets-stop-list .line-group-header .line-info-wrapper{display:flex;align-items:center;flex-grow:1}mv-bus-tickets-stop-list .line-group-header .line-info-wrapper div:only-child{font-size:.9411764706rem}mv-bus-tickets-stop-list .line-group-header .line-image{display:table-cell;vertical-align:top}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .line-image{padding-right:10px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .line-image{padding-left:10px}mv-bus-tickets-stop-list .line-group-header .line-image svg-icon{margin:0}mv-bus-tickets-stop-list .line-group-header .line-names{flex-grow:1}mv-bus-tickets-stop-list .line-group-header .line-title{font-size:.9411764706rem}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-bus-tickets-stop-list .line-group-header .line-title{padding-top:0}}mv-bus-tickets-stop-list .line-group-header .line-subtitle{font-size:.8235294118rem}mv-bus-tickets-stop-list .line-group-header mv-share{top:0}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header mv-share{padding-right:0}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header mv-share{padding-left:0}mv-bus-tickets-stop-list .line-group-header mv-share svg-icon{width:20px;height:20px;top:0}mv-bus-tickets-stop-list .line-group-header mv-share svg-icon svg{width:100%;height:100%}mv-bus-tickets-stop-list .line-group-header.long-line-name .alert{content:url(/images/icons/alert-circle-orange.svg);background:none;width:18px;border-radius:0}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header.long-line-name .alert{padding-left:14px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header.long-line-name .alert{padding-right:14px}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header.long-line-name .alert{padding-right:0}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header.long-line-name .alert{padding-left:0}mv-bus-tickets-stop-list .line-group-header.long-line-name .alert:hover{background:none}mv-bus-tickets-stop-list .line-group-header .alert{font-size:.8235294118rem;color:#292a30;background:#c6522c;min-height:14px;width:-webkit-min-content;width:-moz-min-content;width:min-content;border-radius:20px;color:#fff;cursor:pointer;display:inline-block;margin:5px 0;outline-color:#302e2e;padding:6px 8px;position:relative;vertical-align:middle;transition:all,.3s;line-height:1}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert{padding-right:18px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert{padding-left:18px}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert{padding-left:24px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert{padding-right:24px}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert{margin-left:5px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert{margin-right:5px}@media (orientation: landscape) and (min-width: 450px) and (max-height: 599.98px){mv-bus-tickets-stop-list .line-group-header .alert{position:absolute;top:0}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert{right:60px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert{left:60px}}mv-bus-tickets-stop-list .line-group-header .alert:before{background:url(/images/icons/alert-circle.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:12px;position:absolute;top:50%;vertical-align:middle;width:12px;transform:translateY(-50%)}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert:before{left:8px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert:before{right:8px}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert:before{margin-right:6px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert:before{margin-left:6px}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert:before{left:7px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert:before{right:7px}mv-bus-tickets-stop-list .line-group-header .alert:after{background:url(/images/icons/alert-arrow.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:9px;position:absolute;top:50%;vertical-align:middle;width:5px;transform:translateY(-50%)}html[dir=ltr] mv-bus-tickets-stop-list .line-group-header .alert:after{right:8px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert:after{left:8px}html[dir=rtl] mv-bus-tickets-stop-list .line-group-header .alert:after{transform:scaleX(-1);top:10px}mv-bus-tickets-stop-list .line-group-header .alert:hover{background:#d35f39}mv-bus-tickets-stop-list .line-group-header .alert:focus{outline:#302E2E auto 1px}mv-bus-tickets-stop-list .back-link{color:#292a30;height:100%;position:absolute;padding:0 16px;top:0;z-index:1}html[dir=ltr] mv-bus-tickets-stop-list .back-link{left:0}html[dir=rtl] mv-bus-tickets-stop-list .back-link{right:0}mv-bus-tickets-stop-list .back-link:before{content:url(/images/icons/arrow_gray.svg);display:block;width:7px;height:15px;position:relative;padding:3px;top:50%;transform:scaleX(-1) translateY(-50%)}html[dir=rtl] mv-bus-tickets-stop-list .back-link:before{transform:scale(1) translateY(-50%)}mv-bus-tickets-stop-list .line-container .line-header .lines{padding:0}mv-bus-tickets-stop-list .line-container .line-header .dropdown-menu .menu-label{color:#0a93ff;font-size:.7058823529rem}mv-bus-tickets-stop-list .line-container .line-header .dropdown-menu svg-icon{width:10px;height:10px}html[dir=ltr] mv-bus-tickets-stop-list .line-container .line-header .dropdown-menu svg-icon{margin-left:2px}html[dir=rtl] mv-bus-tickets-stop-list .line-container .line-header .dropdown-menu svg-icon{margin-right:2px}mv-bus-tickets-stop-list .line-container .line-header .dropdown-menu svg-icon svg .cls-1{fill:#0895e4}mv-bus-tickets-stop-list .options-nav{border-bottom:solid 1px #BDC3C7;padding:5px 0 0;position:relative;text-align:center}mv-bus-tickets-stop-list .options-nav a.disabled{opacity:.5}mv-bus-tickets-stop-list .options-nav .step-nav-nextprev-container svg-icon svg{fill:#0000008a}mv-bus-tickets-stop-list .options-nav .step-nav-prev{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-bus-tickets-stop-list .options-nav .step-nav-prev{left:13px}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .step-nav-prev{right:13px}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .step-nav-prev svg-icon{transform:scaleX(-1)}mv-bus-tickets-stop-list .options-nav .step-nav-next{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-bus-tickets-stop-list .options-nav .step-nav-next{right:13px}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .step-nav-next{left:13px}mv-bus-tickets-stop-list .options-nav .step-nav-next svg-icon{transform:rotate(180deg)}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .step-nav-next svg-icon{transform:rotate(0)}mv-bus-tickets-stop-list .options-nav .options{margin:0 40px;position:relative}mv-bus-tickets-stop-list .options-nav .options .line-option-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}mv-bus-tickets-stop-list .options-nav .options .option{background-color:#bdc3c7;border-radius:50%;cursor:pointer;display:inline-block;height:4px;outline:none;padding:0;position:relative;top:-3px;width:4px}html[dir=ltr] mv-bus-tickets-stop-list .options-nav .options .option{margin-right:5px}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .options .option{margin-left:5px}html[dir=ltr] mv-bus-tickets-stop-list .options-nav .options .option:last-of-type{margin-right:0}html[dir=rtl] mv-bus-tickets-stop-list .options-nav .options .option:last-of-type{margin-left:0}mv-bus-tickets-stop-list .options-nav .options .option.selected{background-color:#f0500c}mv-bus-tickets-stop-list .stops-list{flex:1 1 0;overflow:hidden;overflow-y:auto}.has-back-home mv-bus-tickets-stop-list .stops-list{padding-bottom:0}mv-bus-tickets-stop-list .stops-list .stop-item{height:2.8235294118rem}mv-bus-tickets-stop-list .stops-list .stop-item[tabindex="0"] .title:before{content:"";position:absolute;width:2px;top:0;height:50%;background-color:#bdc3c7}html[dir=ltr] mv-bus-tickets-stop-list .stops-list .stop-item[tabindex="0"] .title:before{left:27px}html[dir=rtl] mv-bus-tickets-stop-list .stops-list .stop-item[tabindex="0"] .title:before{right:27px}mv-bus-tickets-stop-list .stops-list .stop-item.grayed{outline:none;background:none}mv-bus-tickets-stop-list .stops-list .stop-item.grayed .title{color:#00000080}mv-bus-tickets-stop-list .stops-list .stop-item.grayed:before,mv-bus-tickets-stop-list .stops-list .stop-item.grayed:after{border-color:#bdc3c7}mv-bus-tickets-stop-list .stops-list .stop-item:not(.grayed):hover,mv-bus-tickets-stop-list .stops-list .stop-item:not(.grayed):focus{background-color:#0005cf0d}mv-bus-tickets-stop-list .stops-list .stop-item:before,mv-bus-tickets-stop-list .stops-list .stop-item:after{border-width:2px;border-color:inherit}mv-bus-tickets-stop-list .stops-list .stop-item:after{width:6px;height:6px}html[dir=ltr] mv-bus-tickets-stop-list .stops-list .stop-item:after{left:23px}html[dir=rtl] mv-bus-tickets-stop-list .stops-list .stop-item:after{right:23px}mv-bus-tickets-stop-list .stops-list .stop-item .title{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000}mv-bus-tickets-stop-list .stops-list .stop-item.selected{font-weight:600;background-color:#0005cf0d}mv-bus-tickets-stop-list .stops-list .stop-item.selected:after{width:0;height:0;border-width:5px}html[dir=ltr] mv-bus-tickets-stop-list .stops-list .stop-item.selected:after{left:23px}html[dir=rtl] mv-bus-tickets-stop-list .stops-list .stop-item.selected:after{right:23px}mv-bus-tickets-stop-list .empty-results{padding:0 20px 20px;text-align:center}mv-bus-tickets-stop-list .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;padding:20px}mv-bus-tickets-stop-list .empty-results .icon{width:32px;height:32px}mv-bus-tickets-stop-list .empty-results .change-time{display:inline-block}mv-bus-tickets-stop-list .empty-results .change-time .dropdown-menu{margin-top:30px}mv-bus-tickets-stop-list .empty-results .change-time .dropdown-menu .dropdown-list{top:-6px}mv-bus-tickets-stop-list .empty-results .change-time .menu-label{border:solid 1px #0895E4;border-radius:5px;color:#0895e4;padding:5px 10px;text-decoration:none;font-size:.8235294118rem}\n'],encapsulation:2}),e})(),Vt=(()=>{class e{constructor(e,t,n,i,r){this.document=e,this.store=t,this.storeHelper=n,this.title=i,this.translate=r,this.defaultElementsSizes=[35,65]}ngAfterViewInit(){this.title.setTitle(this.translate.instant("web_payment_mot_rides_qr_header")),this.split=(0,Tt.Z)(["#bus-ticket-map","#bus-ticket-bottomsheet"],{direction:"vertical",sizes:this.defaultElementsSizes,minSize:[16,77],gutterSize:this.isSingleDirectional?74:114,onDragEnd:()=>{const{isMapFocused:e}=this.stopsMapComponent;this.stopsMapComponent.refreshSize(),this.stopsMapComponent.isMapFocused=e},gutter:()=>{const e=document.createElement("div");return e.id=e.className="drag-zone",e}});const e=this.document.getElementById("drag-zone"),t=this.document.getElementsByTagName("mv-bus-tickets-stops-drag-zone")[0];e.appendChild(t),this.unsubscribe=this.storeHelper.subscribe("ticket.data.destination",e=>{this.split.setSizes(this.defaultElementsSizes),setTimeout(()=>{this.stopsMapComponent.refreshSize(),(null==e?void 0:e.stopId)?this.stopsMapComponent.focusOnMap():this.stopsMapComponent.focusOnUserLocation()},500)})}ngOnDestroy(){this.unsubscribe&&this.unsubscribe()}selectStop(e){this.selectedStopIndex=e}get isSingleDirectional(){var e,t;return 1===(null===(t=null===(e=this.store.getState().line)||void 0===e?void 0:e.lineDirections)||void 0===t?void 0:t.length)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.K0),c.Y36(p.d),c.Y36($e.N),c.Y36(v.Dx),c.Y36(y.sK))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets-select-stop-main-view"]],viewQuery:function(e,t){if(1&e&&(c.Gf(Mt,5),c.Gf(Nt,5)),2&e){let e;c.iGM(e=c.CRH())&&(t.stopsMapComponent=e.first),c.iGM(e=c.CRH())&&(t.stopsDragZoneComponent=e.first)}},decls:6,vars:3,consts:[[1,"stops-list"],["id","bus-ticket-map"],[3,"selectStopEvent"],["id","bus-ticket-bottomsheet"],[3,"selectedStopIndex"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"mv-bus-tickets-stops-map",2),c.NdJ("selectStopEvent",function(e){return t.selectStop(e)}),c.qZA(),c.qZA(),c._UZ(3,"mv-bus-tickets-stops-drag-zone"),c.TgZ(4,"div",3),c._UZ(5,"mv-bus-tickets-stop-list",4),c.qZA(),c.qZA()),2&e&&(c.ekj("one-direction",t.isSingleDirectional),c.xp6(5),c.Q6J("selectedStopIndex",t.selectedStopIndex))},directives:[Mt,Nt,jt],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets-select-stop-main-view{display:block;height:100vh}.content-container,mv-bus-tickets-select-stop-main-view,#bus-ticket-map{transition:top .4s cubic-bezier(.42,0,.3,1.15)}.nearby-split-over .content-container,.nearby-split-over mv-bus-tickets-select-stop-main-view,.nearby-split-over #bus-ticket-map{transition:top .3s ease}.app-container.nearby-map mv-header{z-index:0}body.nearby-split-over mv-root .app-container.nearby-map mv-header{height:80px;transition:height .4s ease-in-out,transform ease-in-out .3s}body.nearby-split-over mv-root .app-container.nearby-map mv-bus-tickets-select-stop-main-view{background-color:transparent}body.nearby-split-over mv-root .app-container.nearby-map #bus-ticket-map{height:0!important}html body.mobile.nearby-split-over mv-root .app-container.nearby-map .content-container{top:2.6470588235rem}html.privacy-notice body.mobile mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 4.7058823529rem)}}html body[data-top-banner^=V].mobile:not([class*=c_]) mv-root .app-container.nearby-map .content-container,body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px)}html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px + 4.7058823529rem)}@media only screen and (max-width: 320px){html.privacy-notice body.mobile[data-top-banner^=V]:not([class*=c_]) mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4908] mv-root .app-container.nearby-map .content-container,html.privacy-notice body[data-top-banner^=V].mobile[class*=c_4480] mv-root .app-container.nearby-map .content-container{top:calc(2.6470588235rem + 60px + 4.7058823529rem)}}mv-bus-tickets-select-stop-main-view>div{width:100%;height:100%;overflow:hidden;z-index:0;background-color:#f0ebe6}.nearby-split-over mv-bus-tickets-select-stop-main-view>div{background-color:transparent}mv-bus-tickets-select-stop-main-view>div .nearby-card-nav,mv-bus-tickets-select-stop-main-view>div .station-details-wrapper{display:none}mv-bus-tickets-select-stop-main-view>div.stops-list .drag-zone{height:6.7058823529rem!important;border-bottom:1px solid #ecf0f1}mv-bus-tickets-select-stop-main-view>div.stops-list .nearby-card-nav{display:flex}mv-bus-tickets-select-stop-main-view>div.stops-list .station-details-wrapper{display:block}mv-bus-tickets-select-stop-main-view>div.stops-list.one-direction .drag-zone{height:4.3529411765rem!important}mv-bus-tickets-select-stop-main-view .drag-zone,mv-bus-tickets-select-stop-main-view #bus-ticket-bottomsheet{position:relative;z-index:9999;background-color:#fff}mv-bus-tickets-select-stop-main-view #bus-ticket-map:not(.dragging),mv-bus-tickets-select-stop-main-view #bus-ticket-bottomsheet:not(.dragging){transition:height .5s cubic-bezier(.37,.05,.3,1)}mv-bus-tickets-select-stop-main-view .drag-zone{width:100%;height:.9411764706rem;padding:0;border-top-right-radius:8px;border-top-left-radius:8px;box-shadow:0 1px 8px #0003;box-sizing:border-box}.nearby-split-over mv-bus-tickets-select-stop-main-view .drag-zone{box-shadow:none}mv-bus-tickets-select-stop-main-view .station-details-wrapper{position:relative}mv-bus-tickets-select-stop-main-view .station-details-wrapper .station-text-wrapper .station-title{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;color:#292a30;font-weight:600}mv-bus-tickets-select-stop-main-view .station-details-wrapper .station-text-wrapper .station-subtitle{font-size:.7647058824rem;letter-spacing:-.0047058824rem;line-height:1.23;margin-top:.1764705882rem}mv-bus-tickets-select-stop-main-view .station-details-wrapper .station-text-wrapper .station-subtitle .accessibility-icon,mv-bus-tickets-select-stop-main-view .station-details-wrapper .station-text-wrapper .station-subtitle svg{height:.7058823529rem;width:.7058823529rem}mv-bus-tickets-select-stop-main-view .lines-list .line-item{min-height:48px;padding:9px 20px}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-title-wrapper{flex-grow:1}html[dir=ltr] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-title-wrapper{padding-right:1.1764705882rem}html[dir=rtl] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-title-wrapper{padding-left:1.1764705882rem}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-title-wrapper .line-title:not(:only-child){color:#292a30;font-weight:600}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time{font-size:.9411764706rem;letter-spacing:-.0188235294rem;line-height:1.25;font-weight:600;color:#292a30;white-space:nowrap}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt{position:relative;color:#038844}html[dir=rtl] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:before,html[dir=rtl] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:after{transform:translateY(.1764705882rem) scaleX(-1)}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:.5882352941rem;position:absolute;top:.0588235294rem;width:.5882352941rem;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:before{left:-8px}html[dir=rtl] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:before{right:-8px}@media (prefers-reduced-motion: reduce){mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:before{-webkit-animation:none;animation:none}}mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:1.0588235294rem;position:absolute;top:-.1764705882rem;width:.9411764706rem;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}html[dir=ltr] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:after{left:-12px}html[dir=rtl] mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:after{right:-12px}@media (prefers-reduced-motion: reduce){mv-bus-tickets-select-stop-main-view .lines-list .line-item .line-time.rt:after{-webkit-animation:none;animation:none}}\n'],encapsulation:2}),e})();function Ht(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",5),c.TgZ(1,"a",6,7),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).onBack()})("keydown.enter",function(){return c.CHM(e),c.oxw(2).onBack()}),c.ALo(3,"translate"),c._UZ(4,"svg-icon",8),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"h2",9),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA()}if(2&e){const e=c.oxw(2);c.xp6(1),c.uIk("aria-label",c.lcZ(3,3,"a11y_back_button")),c.xp6(3),c.uIk("alt",c.lcZ(5,5,"a11y_back_button")),c.xp6(3),c.Oqu(c.lcZ(8,7,e.goBackTitle))}}function Gt(e,t){1&e&&c._UZ(0,"mv-bus-tickets-qr-scanner-view")}function zt(e,t){1&e&&c._UZ(0,"mv-bus-ticket-suggest-lines")}function qt(e,t){1&e&&c._UZ(0,"mv-bus-ticket-search-lines")}function Jt(e,t){1&e&&c._UZ(0,"mv-bus-tickets-select-stop-main-view")}function Wt(e,t){if(1&e&&c._UZ(0,"mv-ticket-details",10),2&e){const e=c.oxw(2);c.Q6J("activationGroup",e.state.ticket.data.activationsGroup)}}function Qt(e,t){if(1&e&&(c.ynx(0),c.YNc(1,Ht,9,9,"div",1),c.ynx(2,2),c.YNc(3,Gt,1,0,"mv-bus-tickets-qr-scanner-view",3),c.YNc(4,zt,1,0,"mv-bus-ticket-suggest-lines",3),c.YNc(5,qt,1,0,"mv-bus-ticket-search-lines",3),c.YNc(6,Jt,1,0,"mv-bus-tickets-select-stop-main-view",3),c.YNc(7,Wt,1,1,"mv-ticket-details",4),c.BQk(),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.shouldShowHeader),c.xp6(1),c.Q6J("ngSwitch",e.step),c.xp6(1),c.Q6J("ngSwitchCase",e.BusTicketStep.QrScanner),c.xp6(1),c.Q6J("ngSwitchCase",e.BusTicketStep.SuggestedLines),c.xp6(1),c.Q6J("ngSwitchCase",e.BusTicketStep.SearchLines),c.xp6(1),c.Q6J("ngSwitchCase",e.BusTicketStep.SelectStop),c.xp6(1),c.Q6J("ngSwitchCase",e.BusTicketStep.TicketDetails)}}(0,M.hu)("BusTicketsComponent");let Kt=(()=>{class e{constructor(e,t,n,i,r,o){this.store=e,this.ticketActions=t,this.a11y=n,this.storeHelper=i,this.routingService=r,this.analyticsService=o,this.BusTicketStep=Se.V,this.completedInitialFocus=!1}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){this.unsubscribe=this.storeHelper.subscribe("ticket.step",e=>{this.completedInitialFocus=!1}),!this.state.ticket.data.fromActiveRide&&this.store.dispatch(this.ticketActions.setStep(Se.V.QrScanner))})}ngOnDestroy(){this.unsubscribe()}get state(){return this.store.getState()}get step(){return this.state.ticket.step}get appIsReady(){return this.store.getState().global.appIsReady}get goBackTitle(){return this.step===Se.V.SelectStop?"payment_bus_select_stop_title":"payment_bus_select_line_title"}onBack(){let e;switch(this.step){case Se.V.SuggestedLines:case Se.V.SearchLines:this.store.dispatch(this.ticketActions.setStep(Se.V.QrScanner)),e=this.step===Se.V.SuggestedLines?"select_line_action":"line_search_action";break;case Se.V.SelectStop:this.store.dispatch(this.ticketActions.setStep(Se.V.SuggestedLines)),e="select_destination_action";break;case Se.V.QrScanner:this.store.dispatch(this.ticketActions.setMode(null))}this.analyticsService.trackMotEvent(e,"back",""),this.store.dispatch(this.ticketActions.setData({destination:void 0}))}get shouldShowHeader(){const e=this.step;return!(!e||e===Se.V.QrScanner||e===Se.V.TicketDetails||e!==Se.V.SearchLines&&e!==Se.V.SuggestedLines&&this.state.global.isLoading)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(g.Q),c.Y36(Re.F),c.Y36($e.N),c.Y36(ke.Z),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-bus-tickets"]],decls:1,vars:1,consts:[[4,"ngIf"],["class","ticket-header",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"activationGroup",4,"ngSwitchCase"],[1,"ticket-header"],["tabindex","0","role","button",1,"back-link",3,"click","keydown.enter"],["backButton",""],["src","images/tickets/pango-back-arrow.svg",1,"error-icon"],[1,"ticket-headline"],[3,"activationGroup"]],template:function(e,t){1&e&&c.YNc(0,Qt,8,7,"ng-container",0),2&e&&c.Q6J("ngIf",t.appIsReady)},directives:[s.O5,s.RF,s.n9,x.bk,We,dt,_t,Vt,pe],pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-bus-tickets{position:relative;display:block}mv-bus-tickets .back-link{height:24px;width:24px;padding:16px}html[dir=ltr] mv-bus-tickets .back-link{padding-left:20px}html[dir=rtl] mv-bus-tickets .back-link{padding-right:20px}html[dir=rtl] mv-bus-tickets .back-link{transform:scaleX(-1)}mv-bus-tickets.map-view{position:fixed;height:100%;width:100%;display:flex;flex-direction:column}mv-bus-tickets.map-view .ticket-header{position:static}mv-bus-tickets.map-view mv-bus-tickets-select-stop-main-view{flex-grow:1;overflow:hidden}mv-bus-tickets .ticket-header{position:-webkit-sticky;position:sticky;top:0;z-index:3;background-color:#fff;display:flex;width:100%}mv-bus-tickets .ticket-header .ticket-headline{font-size:1.1764705882rem;letter-spacing:0rem;line-height:1.4;font-weight:700;color:#2e69e7;margin:14px 0}html[dir=ltr] mv-bus-tickets .ticket-header .ticket-headline{padding-right:20px}html[dir=rtl] mv-bus-tickets .ticket-header .ticket-headline{padding-left:20px}mv-bus-tickets .results-wrapper{background:white;z-index:1;position:relative}mv-bus-tickets .results-wrapper .line-item .mvf-wrapper .text{padding:0 0 1px}\n"],encapsulation:2}),e})(),Xt=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.elementRef=t,this.analyticsService=n}ngOnInit(){this.analyticsService.trackMotEvent("view tab","verify_your_exit_station_impression",""),this.elementRef.nativeElement.setAttribute("aria-modal","true"),this.elementRef.nativeElement.setAttribute("role","dialog"),this.elementRef.nativeElement.setAttribute("tabindex","0")}ngAfterViewChecked(){this.elementRef.nativeElement.focus()}approve(){this.dialogRef.close("allow")}deny(){this.dialogRef.close("cancel")}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(xe.z),c.Y36(c.SBq),c.Y36(b.y))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-approve-exit-station"]],decls:12,vars:12,consts:[[1,"approve","pango-button",3,"click","keydown.enter"],[1,"decline",3,"keydown.enter","click"]],template:function(e,t){1&e&&(c.TgZ(0,"h2"),c._uU(1),c.ALo(2,"translate"),c.qZA(),c.TgZ(3,"p"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"button",0),c.NdJ("click",function(){return t.approve()})("keydown.enter",function(){return t.approve()}),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.TgZ(9,"button",1),c.NdJ("keydown.enter",function(){return t.deny()})("click",function(){return t.deny()}),c._uU(10),c.ALo(11,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,4,"payment_mot_exit_popup_title")),c.xp6(3),c.Oqu(c.lcZ(5,6,"payment_mot_exit_popup_subtitle")),c.xp6(3),c.Oqu(c.lcZ(8,8,"payment_mot_exit_popup_action")),c.xp6(3),c.Oqu(c.lcZ(11,10,"action_cancel")))},pipes:[y.X$],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-approve-exit-station{color:#000;text-align:center;padding:30px 20px 36px;background:white;width:100%;box-sizing:border-box;position:fixed;bottom:0;left:0;box-shadow:0 0 155px #0005cf5e;border:solid .5px #fff}mv-approve-exit-station svg-icon.popup-image{display:block;margin:0 auto 24px;width:96px;height:96px}html[dir=rtl] mv-approve-exit-station{direction:rtl}mv-approve-exit-station h2{margin:0;font-size:21px;text-align:center;font-size:1.2352941176rem;letter-spacing:normal;line-height:1.33}mv-approve-exit-station p{margin:16px 0 0;font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29}mv-approve-exit-station button{display:block;width:100%}mv-approve-exit-station button.pango-button{font-size:1.1764705882rem;line-height:1.6;font-weight:600;border-radius:24px;background-color:#306cea;color:#fff;padding:8px 24px;width:100%}mv-approve-exit-station button.pango-button.disabled,mv-approve-exit-station button.pango-button:disabled{background-color:#83bbff;color:#fff}mv-approve-exit-station button.pango-button:focus{outline:2px solid #000}mv-approve-exit-station button.approve{margin-top:24px}mv-approve-exit-station button.approve:focus{outline:2px solid #000}mv-approve-exit-station button.decline{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#306cea;font-weight:600;display:block;margin:15px auto 0;padding:10px 40px 0}mv-approve-exit-station button.decline:focus{outline:2px solid #000}\n"],encapsulation:2}),e})();const en=function(e){return{TRANSIT_TYPE:e}};function tn(e,t){if(1&e&&(c.TgZ(0,"svg-icon",12),c.ALo(1,"translate"),c._uU(2,">"),c.qZA()),2&e){const e=c.oxw(2);c.Q6J("src",e.imageData.path)("titleText",e.imageData.title)("altText",c.xi3(1,3,"a11y_mot_transit_logo",c.VKq(6,en,e.imageData.title)))}}function nn(e,t){1&e&&(c.TgZ(0,"p",13),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_mot_entrance_find_location")))}function rn(e,t){if(1&e&&(c.TgZ(0,"div",8),c.YNc(1,tn,3,8,"svg-icon",9),c.YNc(2,nn,3,3,"p",10),c.TgZ(3,"div",11),c._UZ(4,"mv-spinner"),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.imageData),c.xp6(1),c.Q6J("ngIf",!e.locationData)}}function on(e,t){if(1&e&&(c._UZ(0,"svg-icon",12),c.ALo(1,"translate"),c.ALo(2,"translate")),2&e){const e=c.oxw(2);c.Q6J("src",e.imageData.path)("titleText",c.xi3(1,3,"a11y_mot_transit_logo",c.VKq(9,en,e.imageData.title)))("altText",c.xi3(2,6,"a11y_mot_transit_logo",c.VKq(11,en,e.imageData.title)))}}function an(e,t){1&e&&(c.TgZ(0,"p",20),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_mot_entrance_entry_station")))}function sn(e,t){1&e&&(c.TgZ(0,"p",21),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"payment_mot_exit_exit_station")))}function ln(e,t){if(1&e&&(c.TgZ(0,"div",22),c.TgZ(1,"div",23),c._UZ(2,"svg-icon",24),c.TgZ(3,"p"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e){const e=c.oxw(2);c.xp6(4),c.Oqu(c.lcZ(5,1,e.translationKeys.alertMessage))}}function cn(e,t){if(1&e&&(c.TgZ(0,"div",14),c.TgZ(1,"div",15),c.YNc(2,on,3,13,"svg-icon",9),c.YNc(3,an,3,3,"p",16),c.YNc(4,sn,3,3,"p",17),c.TgZ(5,"h2",18),c._uU(6),c.qZA(),c.qZA(),c.YNc(7,ln,6,3,"div",19),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.ekj("origin",e.step===e.TrainTicketStep.OriginStationLocating)("destination",e.step===e.TrainTicketStep.DestinationStationLocating),c.xp6(1),c.Q6J("ngIf",e.imageData),c.xp6(1),c.Q6J("ngIf",e.step===e.TrainTicketStep.OriginStationLocating),c.xp6(1),c.Q6J("ngIf",e.step===e.TrainTicketStep.DestinationStationLocating),c.xp6(2),c.Oqu(null==e.locationData.stationInfo?null:e.locationData.stationInfo.stationName),c.xp6(1),c.Q6J("ngIf",e.trainType===e.TrainType.Train&&e.step===e.TrainTicketStep.OriginStationLocating)}}function dn(e,t){if(1&e&&(c.TgZ(0,"p",33),c._uU(1),c.ALo(2,"currency"),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Oqu(c.Dn7(2,1,e.pricingData.fullPrice,e.pricingData.currencyCode,"symbol"))}}function un(e,t){if(1&e&&(c.TgZ(0,"div",25),c.TgZ(1,"div"),c._UZ(2,"svg-icon",26),c.TgZ(3,"p",27),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"div",28),c.TgZ(7,"div",29),c.TgZ(8,"p",30),c._uU(9),c.ALo(10,"currency"),c.qZA(),c.YNc(11,dn,3,5,"p",31),c.qZA(),c.qZA(),c.qZA(),c.TgZ(12,"div",32),c.TgZ(13,"div",23),c._UZ(14,"svg-icon",24),c._uU(15),c.ALo(16,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(4),c.Oqu(c.lcZ(5,4,"payment_mot_exit_fare")),c.xp6(5),c.Oqu(c.Dn7(10,6,e.pricingData.discountPrice,e.pricingData.currencyCode,"symbol")),c.xp6(2),c.Q6J("ngIf",e.pricingData.fullPrice),c.xp6(4),c.hij(" ",c.lcZ(16,10,"payment_mot_passenger_fare_explanation")," ")}}function pn(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",34),c.NdJ("click",function(){return c.CHM(e),c.oxw().generateBoardingPass()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("disabled",e.isLoading),c.xp6(1),c.hij(" ",c.lcZ(2,2,e.isBoardingOnlyTrainType()?"payment_mot_ride_validation":"payment_mot_entrance_code_action")," ")}}function hn(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",35),c.NdJ("click",function(){return c.CHM(e),c.oxw().generateExitPass()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("disabled",e.isLoading),c.xp6(1),c.hij(" ",c.lcZ(2,2,"payment_mot_exit_code_action")," ")}}const mn=(0,M.hu)("StationLocatorStepComponent");let gn=(()=>{class e{constructor(e,t,n,i,r,o,a,s,l,c,d,u){this.ticketActions=e,this.store=t,this.permissionService=n,this.imageService=i,this.dialogService=r,this.ticketService=o,this.ticketErrorService=a,this.title=s,this.translate=l,this.a11y=c,this.analyticsService=d,this._zone=u,this.TrainTicketStep=k.Y5,this.TrainType=k.ue,this.isLoading=!0}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){let e;this.isOrigin=this.step===k.Y5.OriginStationLocating,e=this.isOrigin?"web_payment_mot_rides_qr_header":this.trainType===k.ue.LightRail?"payment_select_transit_light_rail_title":"payment_mot_train_ended_ride_title",this.title.setTitle(this.translate.instant(e)),yield this.loadClosestStation();let t="";t=this.trainType===k.ue.Carmelit?k.ue.Carmelit:this.trainType===k.ue.LightRail?a.Xl:this.isOrigin?"entrance":"exit",this.analyticsService.trackMotEvent("View tab",`looking_for_train_station, ${t}`,"")})}get state(){return this.store.getState().ticket}get pricingData(){var e;return{discountPrice:this.estimatedPricingData.price.balance/100,fullPrice:(null===(e=this.estimatedPricingData.fullPrice)||void 0===e?void 0:e.balance)/100,currencyCode:this.estimatedPricingData.price.currencyCode}}get translationKeys(){return this.trainType===k.ue.Carmelit?{alertMessage:"payment_mot_train_extra_passenger_fare_explanation"}:{alertMessage:"payment_mot_train_max_fare_msg"}}get trainType(){return this.state.data.trainType}isBoardingOnlyTrainType(){return(0,k.fh)(this.trainType)}get estimatedPricingData(){var e,t;return this.isBoardingOnlyTrainType()?null===(t=null===(e=this.locationData)||void 0===e?void 0:e.stationInfo)||void 0===t?void 0:t.activationPrice:this.state.data.trainEstimatedPrice}get showEstimatedPricing(){return this.estimatedPricingData&&(this.isBoardingOnlyTrainType()||this.trainType===k.ue.Train&&this.step===k.Y5.DestinationStationLocating)}get locationData(){const e=this.state.data;return this.isOrigin?e.originStationData:e.destinationStationData}get imageData(){switch(this.trainType){case k.ue.Train:return{path:"images/tickets/transit-types/israel-train.svg",title:this.translate.instant("transit_type_train")};case k.ue.Carmelit:return{path:"images/tickets/transit-types/cable_car.svg",title:this.translate.instant("transit_type_carmelit")};case k.ue.LightRail:return{path:"images/tickets/transit-types/light-rail.svg",title:this.translate.instant("transit_type_light_train")};default:return null}}get activation(){var e;return null===(e=this.activationsGroup)||void 0===e?void 0:e.activations[0]}get activationsGroup(){return this.state.data.activationsGroup}loadClosestStation(){var e;return(0,i.mG)(this,void 0,void 0,function*(){this.isLoading=!0;try{let n;try{n=yield this.permissionService.getLocation({timeout:a.bH})}catch(t){const e={title:this.translate.instant("payment_mot_train_no_location_error_title"),text:this.translate.instant("payment_mot_train_no_location_error_subtitle"),technicalInformation:t};return this.ticketErrorService.displayError(a.Y.Train,this.loadClosestStation.bind(this),this.back.bind(this),e),void(this.isLoading=!1)}yield this.store.dispatch(this.ticketActions.findStations(n.coords.latitude,n.coords.longitude,a.ml[this.trainType],this.isOrigin)),this.state.data&&this._zone.run(()=>this.isLoading=!1),(null===(e=this.locationData)||void 0===e?void 0:e.stationInfo)?(this.isOrigin||(yield this.store.dispatch(this.ticketActions.getEstimatedPrice(this.locationData.latLng.lat,this.locationData.latLng.lng))),this.analyticsService.trackMotEvent("view tab",this.trainType===k.ue.Carmelit?`your carmelit station tab, ${this.state.data.originStationData.stationInfo.stopId}`:this.trainType===k.ue.LightRail?`your light_train station tab, ${this.state.data.originStationData.stationInfo.stopId}`:`${this.isOrigin?"your entrance station tab":"your exit station tab"}, ${this.isOrigin?this.state.data.originStationData.stationInfo.stopId:this.state.data.destinationStationData.stationInfo.stopId}`,"")):(mn.error(this.locationData?"loadClosestStation: loadClosestStation: error in loadClosestStation(), this.locationData.stationInfo is empty":"loadClosestStation: loadClosestStation: missing locationData"),this.ticketErrorService.displayError(a.Y.Train,this.loadClosestStation.bind(this),()=>this.store.dispatch(this.ticketActions.goToTicketTypeSelection()),this.state.data.error,this.getErrorEventValue()))}catch(n){mn.error("loadClosestStation: Error occurred",n)}})}getErrorEventValue(){return this.trainType===k.ue.Carmelit?"carmelit":this.trainType===k.ue.LightRail?a.Xl:this.isOrigin?"entrance":"exit"}generateBoardingPass(){this.isLoading=!0;const e=this.state.data.originStationData;return this.store.dispatch(this.ticketActions.generateBoardingPass(e.latLng.lat,e.latLng.lng,1,a.ml[this.trainType])).then(()=>{this.state.data.error?(this.ticketErrorService.displayError(a.Y.Train,this.loadClosestStation.bind(this),()=>this.store.dispatch(this.ticketActions.goToTicketTypeSelection()),this.state.data.error,this.getErrorEventValue()),mn.error(`generateBoardingPass: Error occurred: [ ${JSON.stringify({error:this.state.data.error,errorEventValue:this.getErrorEventValue()})}]`)):this.store.dispatch(this.ticketActions.setStep(a.eb.BoardingPass)),this.isLoading=!1,this.trainType===k.ue.Carmelit?this.analyticsService.trackMotEvent("carmelit_boarding_station_action",`validate_now, ${this.activation.activationId}`,""):this.trainType===k.ue.LightRail?this.analyticsService.trackMotEvent("light_train_boarding_station_action",`validate_now, ${this.activation.activationId}`,""):this.analyticsService.trackMotEvent("train_eneterance_station_action",`GENERATE_ENTRY_QR_CODE, ${this.state.data.originStationData.stationInfo.stopId}`,"")})}generateExitPass(){return(0,i.mG)(this,void 0,void 0,function*(){this.analyticsService.trackMotEvent("train_exit_station_action",`create_exit_code, ${this.state.data.destinationStationData.stationInfo.stopId}`,"");const e=yield this.dialogService.create(Xt,{width:"calc(100% - 30px)",maxWidth:"320px",backdropClass:"tickets-backdrop"}).onClose.toPromise(),t=this.state.data,n=t.destinationStationData;"allow"===e?(this.isLoading=!0,yield this.store.dispatch(this.ticketActions.completeRide(n.latLng.lat,n.latLng.lng,this.activation.fromStopId,this.activationsGroup.priceReference)),this.store.dispatch(this.ticketActions.setStep(k.Y5.ExitPass)),this.isLoading=!1,this.analyticsService.trackMotEvent("verify_your_exit_station_action",`verify_exit_station, ${n.stationInfo.stopId}, ${t.activationsGroup.activations[0].activationId}`,"")):"cancel"===e&&(this.state.data.fromActiveRide?(this.store.dispatch(this.ticketActions.setActiveRideState()),this.showActiveRideDialog()):this.store.dispatch(this.ticketActions.goToBoardingPassStep()),this.analyticsService.trackMotEvent("verify_your_exit_station_action",`cancel, ${n.stationInfo.stopId}`,""))})}showActiveRideDialog(){this.dialogService.create(Ee,{backdropClass:"active-ride"})}back(){this.trainType===k.ue.Carmelit?this.analyticsService.trackMotEvent("carmelit_boarding_station_action","back",""):this.trainType===k.ue.LightRail?this.analyticsService.trackMotEvent("light_train_boarding_station_action","back",""):this.analyticsService.trackMotEvent("view tab",(this.isOrigin?"train_eneterance_station_action":"verify_your_exit_station_action")+", back",""),this.state.data.fromActiveRide?(this.store.dispatch(this.ticketActions.setActiveRideState()),this.showActiveRideDialog()):this.store.dispatch(this.isOrigin?this.ticketActions.goToTicketTypeSelection():this.ticketActions.goToBoardingPassStep())}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(g.Q),c.Y36(p.d),c.Y36(De.$),c.Y36(S.KD),c.Y36(xe.x),c.Y36(u.wP),c.Y36(_.C),c.Y36(v.Dx),c.Y36(y.sK),c.Y36(Re.F),c.Y36(b.y),c.Y36(c.R0b))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-station-locator-step"]],inputs:{step:"step"},decls:10,vars:11,consts:[["tabindex","0",1,"back-link",3,"click","keydown.enter"],["src","images/tickets/pango-back-arrow.svg",1,"error-icon"],["class","loading-mot",4,"ngIf"],["class","station-content",4,"ngIf"],["class","train-pricing",4,"ngIf"],[1,"buttons","section"],["class","pango-button",3,"disabled","click",4,"ngIf"],["class","exit-code pango-button",3,"disabled","click",4,"ngIf"],[1,"loading-mot"],["class","transit-type-icon","mvAccessibleSVG","",3,"src","titleText","altText",4,"ngIf"],["class","locating-text",4,"ngIf"],[1,"spinner"],["mvAccessibleSVG","",1,"transit-type-icon",3,"src","titleText","altText"],[1,"locating-text"],[1,"station-content"],[1,"station-details"],["class","origin-station-label",4,"ngIf"],["class","destination-station-label",4,"ngIf"],[1,"station-name"],["class","tickets-alert max-charge-alert",4,"ngIf"],[1,"origin-station-label"],[1,"destination-station-label"],[1,"tickets-alert","max-charge-alert"],[1,"alert-content"],["src","images/icons/alert-empty.svg"],[1,"train-pricing"],["src","images/tickets/credit-card.svg",1,"credit-icon"],[1,"pricing-text"],[1,"ticket-price"],[1,"price"],[1,"discount-price"],["class","full-price",4,"ngIf"],[1,"tickets-alert","estimated-price-alert"],[1,"full-price"],[1,"pango-button",3,"disabled","click"],[1,"exit-code","pango-button",3,"disabled","click"]],template:function(e,t){1&e&&(c.TgZ(0,"button",0),c.NdJ("click",function(){return t.back()})("keydown.enter",function(){return t.back()}),c.ALo(1,"translate"),c._UZ(2,"svg-icon",1),c.ALo(3,"translate"),c.qZA(),c.YNc(4,rn,5,2,"div",2),c.YNc(5,cn,8,9,"div",3),c.YNc(6,un,17,12,"div",4),c.TgZ(7,"div",5),c.YNc(8,pn,3,4,"button",6),c.YNc(9,hn,3,4,"button",7),c.qZA()),2&e&&(c.uIk("aria-label",c.lcZ(1,7,"a11y_back_button")),c.xp6(2),c.uIk("alt",c.lcZ(3,9,"a11y_back_button")),c.xp6(2),c.Q6J("ngIf",t.isLoading),c.xp6(1),c.Q6J("ngIf",!t.isLoading&&t.locationData),c.xp6(1),c.Q6J("ngIf",t.showEstimatedPricing),c.xp6(2),c.Q6J("ngIf",t.step===t.TrainTicketStep.OriginStationLocating),c.xp6(1),c.Q6J("ngIf",t.step===t.TrainTicketStep.DestinationStationLocating))},directives:[x.bk,s.O5,T.O,w.m],pipes:[y.X$,s.H9],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.content-container{height:100%}mv-station-locator-step{padding:0 36px}mv-station-locator-step p{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;margin:0}mv-station-locator-step h2{font-size:1.2941176471rem;letter-spacing:-.0188235294rem;line-height:1.27;margin:0}mv-station-locator-step,mv-station-locator-step .station-content{display:flex;flex-direction:column;flex-grow:1}mv-station-locator-step .station-content{width:100%;margin:0 auto}mv-station-locator-step .loading-mot{text-align:center;flex-grow:1}mv-station-locator-step .loading-mot p{margin:25px 0 14px}mv-station-locator-step .loading-mot .locating-text+.spinner{position:static;height:auto}mv-station-locator-step .transit-type-icon{width:96px;height:96px;padding:14px;margin-bottom:24px;display:block;margin-top:60px}mv-station-locator-step .station-details{align-self:center;text-align:center}mv-station-locator-step .station-details.origin{flex-grow:1}mv-station-locator-step .station-details .station-name{margin-top:8px;color:#306cea}mv-station-locator-step .buttons{margin:24px 0 36px;text-align:center}mv-station-locator-step .train-pricing{position:relative;margin-top:20px}mv-station-locator-step .train-pricing:before{content:"";position:absolute;top:0;width:calc(100% + 72px);left:-36px;height:1px;background-color:#ecf0f1}mv-station-locator-step .train-pricing>div{display:flex;justify-content:space-between;-webkit-justify-content:space-between;align-items:center;-webkit-align-items:center}mv-station-locator-step .train-pricing p{margin:0}mv-station-locator-step .train-pricing .pricing-text{flex-grow:1}mv-station-locator-step .train-pricing .credit-icon{margin:0}html[dir=ltr] mv-station-locator-step .train-pricing .credit-icon{margin-right:10px}html[dir=rtl] mv-station-locator-step .train-pricing .credit-icon{margin-left:10px}mv-station-locator-step .train-pricing .ticket-price{padding:16px 0}mv-station-locator-step .train-pricing .ticket-price .price{font-size:.8235294118rem;letter-spacing:-.0088235294rem;line-height:1.29;color:#000}mv-station-locator-step .train-pricing .ticket-price .price .discount-price{font-weight:600}mv-station-locator-step .train-pricing .ticket-price .price .full-price{color:#525357;text-decoration:line-through;margin-top:2px}mv-station-locator-step .train-pricing .estimated-price-alert{margin-top:8px}\n'],encapsulation:2}),e})();function fn(e,t){if(1&e&&c._UZ(0,"mv-station-locator-step",3),2&e){const e=c.oxw();c.Q6J("step",e.step)}}function vn(e,t){if(1&e&&c._UZ(0,"mv-ticket-details",4),2&e){const e=c.oxw();c.Q6J("activationGroup",e.activationGroup)("originStationName",e.originName)("finishRideCallback",e.onFinishRide)}}function yn(e,t){if(1&e&&c._UZ(0,"mv-ticket-details",5),2&e){const e=c.oxw();c.Q6J("activationGroup",e.activationGroup)("destinationStationName",e.destinationName)}}let bn=(()=>{class e{constructor(e,t,n){this.ticketActions=e,this.store=t,this.translate=n,this.TrainTicketStep=k.Y5,this.GeneralTicketStep=a.eb,this.stepToTitleMap={[k.Y5.OriginStationLocating]:"Entering station",[a.eb.BoardingPass]:"Boarding Pass",[k.Y5.DestinationStationLocating]:this.translate.instant("payment_mot_exit_station_tab")}}get state(){return this.store.getState().ticket}get step(){return this.store.getState().ticket.step}get activationGroup(){const e=this.state.data;return e.finishTrainActivationGroup||e.activationsGroup}get activation(){if(this.activationGroup)return this.activationGroup.activations[0]}get showStationLocatorStep(){return!this.state.data.fromActiveRide&&this.step===k.Y5.OriginStationLocating||this.step===k.Y5.DestinationStationLocating}get stepTitle(){return this.stepToTitleMap[this.step]}get originName(){const e=this.state.data.originStationData;return null==e?void 0:e.stationInfo.stationName}get destinationName(){const e=this.state.data.destinationStationData;return null==e?void 0:e.stationInfo.stationName}onFinishRide(){this.store.dispatch(this.ticketActions.setStep(k.Y5.DestinationStationLocating))}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(g.Q),c.Y36(p.d),c.Y36(y.sK))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-train-tickets"]],decls:3,vars:3,consts:[[3,"step",4,"ngIf"],[3,"activationGroup","originStationName","finishRideCallback",4,"ngIf"],[3,"activationGroup","destinationStationName",4,"ngIf"],[3,"step"],[3,"activationGroup","originStationName","finishRideCallback"],[3,"activationGroup","destinationStationName"]],template:function(e,t){1&e&&(c.YNc(0,fn,1,1,"mv-station-locator-step",0),c.YNc(1,vn,1,3,"mv-ticket-details",1),c.YNc(2,yn,1,2,"mv-ticket-details",2)),2&e&&(c.Q6J("ngIf",t.showStationLocatorStep),c.xp6(1),c.Q6J("ngIf",t.step===t.GeneralTicketStep.BoardingPass&&t.activation),c.xp6(1),c.Q6J("ngIf",t.step===t.TrainTicketStep.ExitPass&&t.activation))},directives:[s.O5,gn,pe],styles:["@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-train-tickets{display:flex;flex-direction:column;height:100%}mv-train-tickets .back-link{position:absolute;top:20px}html[dir=ltr] mv-train-tickets .back-link{left:20px}html[dir=rtl] mv-train-tickets .back-link{right:20px}mv-train-tickets .back-link:focus svg-icon{outline:auto}html[dir=rtl] mv-train-tickets .back-link{transform:scaleX(-1)}\n"],encapsulation:2}),e})();function _n(e,t){1&e&&c._UZ(0,"mv-transit-type-selection")}function Tn(e,t){if(1&e&&c._UZ(0,"mv-bus-tickets"),2&e){const e=c.oxw(2);c.ekj("map-view",e.isInMapView)}}function Sn(e,t){1&e&&c._UZ(0,"mv-train-tickets")}function xn(e,t){if(1&e&&(c.ynx(0),c.YNc(1,_n,1,0,"mv-transit-type-selection",0),c.YNc(2,Tn,1,2,"mv-bus-tickets",2),c.YNc(3,Sn,1,0,"mv-train-tickets",0),c.BQk()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.showTransitTypeSelection),c.xp6(1),c.Q6J("ngIf",e.ticketMode===e.TicketMode.Bus),c.xp6(1),c.Q6J("ngIf",e.ticketMode===e.TicketMode.Train&&e.ticketData)}}function wn(e,t){1&e&&(c.TgZ(0,"div",3),c._UZ(1,"mv-spinner"),c.qZA())}const kn=(0,M.hu)("TicketsMainViewComponent");let Mn=(()=>{class e{constructor(e,t,n,i,r,o,s,l,c,d){this.store=e,this.ticketActions=t,this.universal=n,this.ticketService=i,this.title=r,this.dialogService=o,this.translate=s,this.analyticsService=l,this.ticketErrorService=c,this.routingService=d,this.TicketMode=a.Y,this.checkedForActiveRide=!1}ngOnInit(){var e,t,n;return(0,i.mG)(this,void 0,void 0,function*(){if(this.universal.isServer)return;yield(0,l.p5)(this.store);const{motMode:i,motView:r}=this.routingService.getStateFromUrl();if(r===a.o0.SkipActiveRideAndShowTransitTypeSelection&&(this.store.dispatch(this.ticketActions.setData({ignoreActiveRide:!0})),this.checkedForActiveRide=!0,this.routingService.updateUrlParams({motView:null})),!this.state.data.ignoreActiveRide&&!this.checkedForActiveRide)try{if(yield this.store.dispatch(this.ticketActions.getActiveRide()),this.title.setTitle(this.translate.instant("ride_details_active_ride_title")),this.activationGroup){this.checkedForActiveRide=!0,this.store.dispatch(this.ticketActions.setActiveRideState());const e=this.activation.ticketStatus===a.pF.ACTIVE&&!this.activation.activationCompletionTime;i===a.Y.Train&&r===a.o0.DestinationStationLocatingStep&&e?this.store.dispatch(this.ticketActions.setStep(k.Y5.DestinationStationLocating)):this.dialogService.create(Ee,{backdropClass:"active-ride"})}else this.checkedForActiveRide=!0,this.title.setTitle(this.translate.instant("web_payment_mot_rides_qr_header")),this.store.dispatch(this.ticketActions.setData({fromActiveRide:!1}));const o=this.ticketData.fromActiveRide;if(o){let i;i=(null===(e=this.activation)||void 0===e?void 0:e.transitType)===a.gP.CityLightRail?a.Xl:null===(n=a.RN[null===(t=this.activation)||void 0===t?void 0:t.transitType])||void 0===n?void 0:n.toLocaleLowerCase(),this.analyticsService.trackMotEvent("start_ride_flow",`${o?"active_ride":"new_ride"}, ${i}`,"")}}catch(o){this.ticketErrorService.displayError(null,this.ngOnInit.bind(this)),kn.error("ngOnInit:",o)}})}get state(){return this.store.getState().ticket}get ticketMode(){return this.state.mode}get isInMapView(){return this.store.getState().ticket.step===Se.V.SelectStop}get ticketData(){return this.state.data}get activationGroup(){return this.state.data.activationsGroup}get activation(){var e;return null===(e=this.activationGroup)||void 0===e?void 0:e.activations[0]}get showTransitTypeSelection(){return!this.ticketMode&&(this.state.data.ignoreActiveRide||this.checkedForActiveRide&&!this.state.data.activationsGroup)}get step(){return this.store.getState().ticket.step}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(p.d),c.Y36(g.Q),c.Y36(d.p),c.Y36(u.wP),c.Y36(v.Dx),c.Y36(xe.x),c.Y36(y.sK),c.Y36(b.y),c.Y36(_.C),c.Y36(ke.Z))},e.\u0275cmp=c.Xpm({type:e,selectors:[["mv-tickets-main-view"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","spinner",4,"ngIf"],[3,"map-view",4,"ngIf"],[1,"spinner"]],template:function(e,t){1&e&&(c.YNc(0,xn,4,3,"ng-container",0),c.YNc(1,wn,2,0,"div",1)),2&e&&(c.Q6J("ngIf",t.universal.isBrowser),c.xp6(1),c.Q6J("ngIf",t.universal.isServer))},directives:[s.O5,Ne,Kt,bn,T.O],styles:['@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}.tickets-backdrop{background-color:#306cea26}body mv-root{overflow:unset}mv-tickets-main-view{display:block;font-weight:400;height:100%}mv-tickets-main-view .back-link:focus svg-icon{outline:auto}.pango-button{font-size:1.1764705882rem;line-height:1.6;font-weight:600;border-radius:24px;background-color:#306cea;color:#fff;padding:8px 24px;width:100%}.pango-button.disabled,.pango-button:disabled{background-color:#83bbff;color:#fff}.pango-button:focus{outline:2px solid #000}.back-button:hover svg-icon{outline:auto}.tickets-alert.max-charge-alert{position:relative;padding-top:16px}.tickets-alert.max-charge-alert:before{content:"";position:absolute;top:0;width:calc(100% + 72px);left:-36px;height:1px;background-color:#ecf0f1}.tickets-alert .alert-content{display:flex;align-items:center;width:100%;box-sizing:border-box;background-color:#f7a20c26;border-radius:6px;color:#525357;padding:12px}html[dir=ltr] .tickets-alert .alert-content{text-align:left}html[dir=rtl] .tickets-alert .alert-content{text-align:right}.tickets-alert .alert-content p{margin:0}html[dir=ltr] .tickets-alert .alert-content p{text-align:left}html[dir=rtl] .tickets-alert .alert-content p{text-align:right}.tickets-alert .alert-content svg-icon{margin:0;min-width:24px}html[dir=ltr] .tickets-alert .alert-content svg-icon{margin-right:12px}html[dir=rtl] .tickets-alert .alert-content svg-icon{margin-left:12px}.tickets-alert .alert-content svg-icon svg g{fill:#f7a20c}\n'],encapsulation:2}),e})();var Ln=n(39885);const An=[{path:"history/:lang",component:_e,data:{subTabId:Te.zA.TICKET_HISTORY}},{path:":lang",component:Mn,data:{subTabId:Te.zA.TICKET_MAIN}},{path:"**",component:Ln.H,data:{canonicalLanding:"default"}}]},85978:function(e,t,n){"use strict";n.d(t,{Y5:function(){return i},ue:function(){return r},fh:function(){return o}});var i=(()=>{return(e=i||(i={})).OriginStationLocating="OriginStationLocating",e.DestinationStationLocating="DestinationStationLocating",e.ExitPass="ExitPass",i;var e})(),r=(()=>{return(e=r||(r={})).Train="Train",e.Carmelit="Carmelit",e.LightRail="LightRail",e.Rachbalit="Rachbalit",r;var e})();function o(e){return e===r.Carmelit||e===r.LightRail}},51063:function(e,t,n){"use strict";function i(e,t=window.document){return t.body.getAttribute(e)}function r(e,t){const n=i(e,t);return n?{name:e,variant:n}:null}n.d(t,{V:function(){return i},L:function(){return r}})},65492:function(e,t,n){"use strict";n.d(t,{bl:function(){return i},zQ:function(){return r}});var i=(()=>{return(e=i||(i={})).GenerateUser="/api/user",e.CombinedUser="/api/user/all",e.GetMetro="/api/metro/:metroId",e.GetMetroIdByIpAddress="/api/metro/ip/:ipAddress",e.MetroSearch="/api/metro/coords",e.GetAgencyOrder="/api/lines/agency_order",e.GetMaxFutureDays="/api/metro/maxfuturedays/:metroId",e.GetMetroAndMaxFutureDays="/api/metro/combined/:metroId/:langId",e.GetMetroTaxiConfiguration="/api/metro/taxi-configuration/:metroId/:userKey/:langId",e.GetStoreLinksByCountry="/api/metro/app-store-by-country/:country/:lang",e.LocationSearch="/api/location",e.GoogleLocationSearch="/api/location/google/autocomplete",e.GoogleLocationPlaceId="/api/location/google/placeId",e.AddressSearch="/api/location/address",e.SuggestedRoutesStart="/api/route/search",e.SuggestedRoutesPoll="/api/route/result",e.RouteETA="/api/route/car_trip",e.WalkPolyline="/api/route/walkPolyline",e.LinesArrival="/api/lines/linesarrival",e.ItinerarySimilarRoute="/api/tripplan/similar",e.ShareItinerary="/api/share/itinerary",e.GetSharedItinerary="/api/share/itinerary/get",e.GetLines="/api/lines/agency",e.SearchLines="/api/lines/search",e.GetLineDetails="/api/lines/grouptrips",e.GetInitialLineData="/api/lines/getInitialData?lineGroupId=:lineGroupId",e.GetLineArrival="/api/lines/linearrival",e.GetStopDetails="/api/lines/stop",e.GetBicycleStop="/api/lines/bicycleStops",e.GetMicroMobilityBikesStopsData="/api/lines/microMobilityBikesStopsData",e.GetBicycleStopsRealTimeInfo="/api/lines/bicycleStopsRealTimeInfo",e.GetAlerts="/api/alert/metro",e.GetAlertDetails="/api/alert/details",e.GetAlertDetailsByEntity="/api/alert/entities",e.BaseAlert="/api/alert",e.GetUpdatesMessage="/api/alert/get-updates",e.GetStopsMapData="/api/nearby/stops",e.GetStopsAdditionalData="/api/nearby/stopsAdditionalData",e.getStopsLinesArrivals="/api/nearby/getStopsLinesArrivals",e.getMicroMobility="/api/nearby/microMobility",e.GetCountries="/api/country",e.CheckAccount="/api/account/check",e.GetAccount="/api/account/get",e.CreateAndVerify="/api/account/createAndVerify",e.VerifyCode="/api/account/verifyCode",e.RequestCode="/api/account/requestCode",e.SetInfo="/api/account/setInfo",e.Logout="/api/account/logout",e.AddPaymentMethod="/api/account/addPaymentMethod",e.GetPaymentAccount="/api/account/getPaymentAccount",e.GetGrabToken="/api/grab/token",e.VerifyUserToken="/api/grab/verify",e.GetGrabFare="/api/grab/fare",e.GetStationInfo="/api/tickets/getStationInfo",e.SetActivationByLocation="/api/tickets/setActivationByLocation",e.FinishTrainEstimatedPrice="/api/tickets/finishTrainEstimatedPrice",e.FinishTrainActivation="/api/tickets/finishTrainActivation",e.GetSuggestedLines="/api/tickets/suggestedLines",e.GetBusActivationPrice="/api/tickets/getBusActivationPrice",e.SetBusActivationPrice="/api/tickets/setBusActivationPrice",e.GetCurrentActivations="/api/tickets/getCurrentActivations",e.GetHistoricalActivations="/api/tickets/getHistoricalActivations",e.TodPlaceOrder="/api/tod/getPlaceOrder",e.TodBookOrder="/api/tod/bookOrder",e.TosConfirmation="/api/tod/tosConfirmation",e.TodRealTimeInfo="/api/tod/getRealTimeInfo",e.TodCancelRide="/api/tod/cancelRide",e.TodMyRides="/api/tod/myRides",e.TodRateRide="/api/tod/rateRide",e.ShareSendEmail="api/share/email",e.GetFeatureFlags="/api/feature-flags",e.EncryptedCustomer="api/customer/encryptedCustomer/:id",i;var e})();function r(e,t){for(const n in t)e=e.replace(`:${n}`,t[n]);return e}t.ZP=i},52959:function(e,t,n){"use strict";function i(e){return new Promise(t=>{if(r(e))return t();const n=e.subscribe(()=>{r(e)&&(n(),t())})})}function r(e){return e.getState().global.appIsReady}function o(){return new Promise(e=>{if(a())return e();const t=()=>setTimeout(()=>a()?e():t(),500);t()})}function a(){return!!(window.ga&&window.ga.loaded&&window.ga.getAll&&window.ga.getAll()[0])}n.d(t,{p5:function(){return i},wZ:function(){return o},i6:function(){return a}})},36179:function(e,t,n){"use strict";n.d(t,{WO:function(){return r},gn:function(){return o},wV:function(){return a}});var i=n(99528);function r(){return o()?i.$I.iOS:i.$I.Android}function o(){return!(navigator.userAgent.match(/Windows Phone/i)||!navigator.userAgent.match(/iPhone|iPad/i))}function a(){try{return window.self!==window.top}catch(e){return!0}}},4008:function(e,t,n){"use strict";n.d(t,{rq:function(){return i},fn:function(){return r},ku:function(){return o},k$:function(){return a},DV:function(){return s},_n:function(){return l},Ok:function(){return c},W:function(){return d},vo:function(){return u},Ox:function(){return p},eP:function(){return h},MC:function(){return m},S$:function(){return g}});const i=121,r=4480,o=4,a="en",s=!1,l="IGNORE_SPLASH",c="current_location",d="V567",u="moovit_logo_full.svg",p=881,h="login",m=11942,g="https://appassets.mvtdev.com/mobile/"},1896:function(e,t,n){"use strict";n.d(t,{_I:function(){return r},Lm:function(){return o},ZU:function(){return a}});var i=n(3786);const r="c_";var o=(()=>((o||(o={})).Alert="hasCustomAlertStyles",o))();function a(e,t,r){return(0,i.mG)(this,void 0,void 0,function*(){if(e.customer.currentCustomer&&e.customer.currentCustomer.designConfiguration&&e.customer.currentCustomer.designConfiguration.cssFile&&e.customer.currentCustomer.designConfiguration[t]){const t=`${e.customer.currentCustomer.designConfiguration.cssFile}.${r}`;return(yield n(41380)(`./${t}.css`)).default}return null})}},31234:function(e,t,n){"use strict";n.d(t,{nw:function(){return s},ID:function(){return l},jm:function(){return c},vq:function(){return d},N0:function(){return u}});var i=n(17184),r=n(99528),o=n(85547);const a={};function s(e){const t=a[e];return t?"images/routeTypes/"+t+".svg":null}function l(e,t,n,r){let a;switch(e){case i.kJ.StartFrom:return"street_tag";case i.kJ.Walk:case i.kJ.WalkToPath:return"tripplan_itinerary_walk_label";case i.kJ.Bus:a=i.Yt.Bus;break;case i.kJ.Subway:a=i.Yt.Subway;break;case i.kJ.Tram:a=i.Yt.Tram;break;case i.kJ.Rail:a=i.Yt.Rail;break;case i.kJ.Funicular:a=i.Yt.Funicular;break;case i.kJ.Ferry:a=i.Yt.Ferry;break;case i.kJ.Gondola:a=i.Yt.Gondola;break;case i.kJ.CableCar:case i.kJ.Car:a=i.Yt.CableCar;break;case i.kJ.Bicycle:return"a11y_bike_station_image"}if(!a)return"";const s=(0,o.n_)(t,n,r).find(e=>e.type===a.routeTypeId);return s?s.translationKey:""}function c(e,t){const n=a[e];return n?"images/stations/"+(t?"xhdpi/":"mdpi/")+n+".png":null}function d(e){return"#"+u(e)}function u(e,t){const n=[(16711680&e)>>16,(65280&e)>>8,255&e];let i;return i=t?"rgba("+[n,((4278190080&e)>>>24)/255].join(",")+")":n.map(e=>{let t=e.toString(16);return e<16&&(t="0"+t),t}).join(""),i}a[i.kJ.StartFrom]="street",a[r.T.Walk]="walking",a[r.T.Bus]="bus",a[r.T.Subway]="subway",a[r.T.Tram]="tram",a[r.T.Rail]="rail",a[r.T.Funicular]="funicular",a[r.T.Ferry]="ferry",a[r.T.Gondola]="gondola",a[r.T.Bicycle]="bicycle"},55754:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});class i{static min(e,t){e.lat>t.lat&&(e.lat=t.lat),e.lng>t.lng&&(e.lng=t.lng)}static max(e,t){e.lat<t.lat&&(e.lat=t.lat),e.lng<t.lng&&(e.lng=t.lng)}static toLatLonE6(e){return{latitude:Math.round(1e6*e.lat),longitude:Math.round(1e6*e.lng)}}static toMvLatLon(e){return i.toLatLonE6(e)}static toGrabLatLon(e){return{latitude:e.lat,longitude:e.lng}}static fromMvLatLon(e){return{lat:e.latitude/1e6,lng:e.longitude/1e6}}static parse(e){if(!e)return null;const t=e.split("_"),n=parseFloat(t[0]);if(void 0===n)throw new Error("Failed to parse LatLng: "+e);const i=parseFloat(t[1]);if(void 0===i)throw new Error("Failed to parse LatLng: "+e);return{lat:n,lng:i}}static toString(e){return`${e.lat}, ${e.lng}`}}},86781:function(e,t,n){"use strict";n.d(t,{hu:function(){return v}});var i=n(4008),r=n(37349);const o={};let a=o,s=[];function l(){return r.i.performance?r.i.performance.now():Date.now()}let c=l();const d=/^[A-Za-z0-9+=/]+$/,u=function(){function e(e){s.push({when:new Date,message:e}),s.length>100&&n()}function t(){s=[],a=o}function n(){try{if("undefined"==typeof XMLHttpRequest)return;if(s.length||a!=o){console.log("Sending logs to the server: "+s.length);const e=new XMLHttpRequest;e.open("POST","/api/debug/dump"),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("MOOVIT_CLIENT_VERSION","5.93.0/"+i.W),e.setRequestHeader("MOOVIT_APP_TYPE","WEB_TRIP_PLANNER"),r.i.rbzid&&d.test(r.i.rbzid)&&e.setRequestHeader("rbzid",r.i.rbzid),e.addEventListener("error",function(){console.warn("Failed to send logs to the server")});const n=JSON.stringify({logs:s,times:a});e.send(n),c=l(),t()}}catch(e){console.error(e)}}return setInterval(function(){l()-c>1e3&&n()},1e3),{log:e,begin:function(t){const n={name:t,begin:new Date};a==o&&(a={}),a[t]=n,e("BEGIN "+t)},end:function(t){a==o&&(a={});const n=a[t];n&&(n.end=new Date),e("END "+t)},dump:n,clear:t}}();n(2433);var p,h=n(53882);const m=(null===(p=r.i.moovit)||void 0===p?void 0:p.skipLogs)||!1,g=[],f=["ErrorHandlerService","PermissionService","QrScanner","TicketService","TicketErrorService","TicketsMainViewComponent","BusTicketsComponent","TrainTicketsComponent","StationLocatorStepComponent","ApproveExitStationComponent","TicketDetailsComponent","TicketsErrorComponent","TrainTicketsComponent","BusTicketSuggestLinesComponent","BusTicketSearchLinesComponent","BusTicketLineListComponent","TransitTypeSelectionComponent","BusTicketsSelectStopMainViewComponent","BusTicketsStopListComponent","BusTicketsStopsDragZoneComponent","BusTicketsStopsMapComponent","BusTicketsQrScannerViewComponent","BusTicketsPriceComponent","TicketHistoryComponent","BusTicketsApprovalPopupComponent","ActiveRideComponent","AbortTrainRideComponent"];function v(e,t){if(t||m)return new y;if(function(e){return-1!=g.indexOf(e)}(e))return new y;const n={prefix:e};n.remote=u?u.log:console.log.bind(console,e+">");for(const i of["log","info","error"])n[i]=(...t)=>{if(console[i].call(console,`${e} >`,...t),u&&f.includes(e)){const n=t.map(e=>{if(e instanceof Error){const{message:t,stack:n}=e;return JSON.stringify({message:t,stack:n})}return e instanceof h.UA?JSON.stringify(e.error):e&&"object"==typeof e?JSON.stringify(e):e}).join(", ");u.log(`${e} [${i}] > ${n}`)}};return n.group=console.group.bind(console,e+">"),n.groupEnd=console.groupEnd.bind(console),n.create=function(e){return v(n.prefix+e)},n}class y{constructor(){this.prefix=""}log(e,...t){}info(e,...t){}error(e,...t){}group(e,...t){}groupEnd(){}create(){return this}remote(e,...t){}}},40216:function(e,t,n){"use strict";n.d(t,{Y:function(){return m}});var i=n(3786),r=n(14474),o=n(28929),a=n(59442),s=n(53792),l=n(88662),c=n(81010),d=n(7048),u=n(38461);const p=(0,n(86781).hu)("MapLocation"),h={user:null,accuracy:null,facing:null};class m{constructor(e,t=!1){this.map=e,this.styles=Object.assign({},h),this.markers=Object.assign({},h),this.userLocation=[null,null],this.setupStyles(),this.onInit(t)}onInit(e){return(0,i.mG)(this,void 0,void 0,function*(){if(this.location$=(t={enableHighAccuracy:!0},new a.y(e=>{const n=navigator.geolocation.watchPosition(e.next.bind(e),e.error.bind(e),t);return()=>navigator.geolocation.clearWatch(n)})).pipe((0,s.x)(),g(2e3,this.onLocationUpdate.bind(this))).subscribe(this.onLocationUpdate.bind(this)),!e)return;var t;const n="ondeviceorientationabsolute"in window;("ondeviceorientation"in window||n)&&(this.orientation$=(0,r.R)(window,n?"deviceorientationabsolute":"deviceorientation").pipe((0,s.x)(),(0,l.V)(3e4),g(0,this.onOrientationUpdate.bind(this))).subscribe(this.onOrientationUpdate.bind(this)))})}onDestroy(){for(const e of["location$","orientation$"])this[e]&&this[e].unsubscribe();this.removeAllMarkers()}onLocationUpdate(e,t){if(p.log("onLocationUpdate",e,t),t)return void this.removeAllMarkers();if(!e)return;const n=e.coords.accuracy;if(!(n>=2e3)){if(n>=1e4)return void this.removeAllMarkers();this.userLocation=[e.coords.latitude,e.coords.longitude],this.markers.user?this.markers.user.setLatLng(this.userLocation):this.markers.user=L.marker(this.userLocation,{icon:this.styles.user,keyboard:!1}).addTo(this.map),this.markers.accuracy?(this.markers.accuracy.setLatLng(this.userLocation),this.markers.accuracy.setRadius(n)):this.markers.accuracy=L.circle(this.userLocation,n,this.styles.accuracy).addTo(this.map),this.markers.facing&&this.markers.facing.setLatLng(this.userLocation)}}onOrientationUpdate(e,t){if(p.log("onOrientationUpdate",e,t),t||!this.userLocation[0]||!this.userLocation[1])return void this.removeMarker("facing");if(!e)return;let n=null;e.webkitCompassHeading?n=e.webkitCompassHeading:e.absolute&&e.alpha&&(n=360-e.alpha),!isNaN(parseFloat(n))&&isFinite(n)?(n=Math.round(n),this.markers.facing?(this.markers.facing.setLatLng(this.userLocation),this.markers.facing.setIcon(this.styles.facing(n))):this.markers.facing=L.marker(this.userLocation,{icon:this.styles.facing(n),keyboard:!1}).addTo(this.map)):this.removeMarker("facing")}getLocation(){return this.userLocation}removeMarker(e){!this.markers[e]||(this.markers[e].remove(),this.markers[e]=null)}removeAllMarkers(){for(const e in this.markers)this.removeMarker(e)}setupStyles(){this.styles={user:L.divIcon({className:"map-location-user",html:'\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" version="1.1" viewBox="-12 -12 24 24">\n                <circle r="9" style="stroke: #fff; stroke-width: 3; fill: #2A93EE; fill-opacity: 1; opacity: 1;" />\n            </svg>',iconSize:[24,24]}),accuracy:{className:"map-location-accuracy",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},facing:e=>L.divIcon({className:"map-location-facing",html:`\n            <svg width="212px" height="156px" viewBox="0 0 212 156" version="1.1" xmlns="http://www.w3.org/2000/svg" style="transform: rotateZ(${e+242}deg) scale(0.6);transform-origin: 0 0;">\n            <defs>\n                <linearGradient x1="69.6755723%" y1="50%" x2="0%" y2="22.9263083%" id="linearGradient-1">\n                    <stop stop-color="#FFFFFF" stop-opacity="0" offset="0%"></stop>\n                    <stop stop-color="#02BAF6" offset="100%"></stop>\n                </linearGradient>\n            </defs>\n            <g id="WTP-Partners" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <g id="Bearing" fill="url(#linearGradient-1)" fill-rule="nonzero">\n                    <polygon id="path-2" points="0 0 106 156 212 0"></polygon>\n                </g>\n            </g>\n        </svg>`,iconSize:[0,0]})}}}function g(e,t){return(0,o.z)((0,c.a)(n=>n.pipe((0,d.b)(e=>t(null,e)),(0,u.g)(e))))}},85547:function(e,t,n){"use strict";n.d(t,{EH:function(){return s},n_:function(){return c},Mx:function(){return d},Yo:function(){return u},GT:function(){return p},A:function(){return h},H$:function(){return g}});var i=n(99528),r=n(17184),o=n(32066);const a={};!function(){for(const e in i.go)if(i.go.hasOwnProperty(e)){let t=e.toLocaleLowerCase();t.startsWith("default")&&(t=t.replace(/(default_)(transit_type_)/,"$2$1")),a[i.go[e]]=t}}();const s={2970:22,1502:745,5438:3763,5430:4709,5986:742,4512:1904,2941:145,3705:145,3701:145,5513:145,3060:145,2980:145,5254:302,2680:2022,1962:2022};let l;function c(e,t,n){return l||(l=e.metro.currentMetro.routeTypes.map(e=>{const i=p(e.clientOverrideTextResourceId),r=t.instant(i);return{type:e.routeType,imageHtml:n.getImageHTML(e.image,void 0,void 0,r),selected:!1,translationKey:i}}),l)}const d=[{type:i.PI.BICYCLE,imageId:o.nM.ROUTE_TYPE_BICYCLE,translationKey:"tripplan_itinerary_bike_label"}];function u(){l=null}function p(e){return a[e]||e.toString()}function h(e){const t=e.directions.search.searchOptions.routeTypes,n=m(e),o=Object.keys(t).filter(e=>t[e]).map(e=>n.find(t=>t.routeTypeId.toString()==e)),a=function(e){const t=e.directions.search.searchOptions.routeTransportOptions;return Object.keys(t).filter(e=>t[e]).map(e=>{var t;return null===(t=i.PI[e])||void 0===t?void 0:t.toLowerCase()})}(e),s=!o.length&&!a.length,l=r.Yt.equals(n,o)&&a.length===d.length;return s||l?"":o.map(e=>e.name).concat(a).join()}function m(e){return function(e){return e.map(e=>r.Yt.getById(e.routeType))}(e.metro.currentMetro.routeTypes)}function(){}