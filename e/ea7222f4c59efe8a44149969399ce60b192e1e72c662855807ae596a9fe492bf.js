// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(d,a,c,g,b,f,m,k,e){function l(a){var c=document.createElement("canvas");c.width=a.width;c.height=a.height;a.render(c.getContext("2d"));return c}function u(a,c,b){var e={target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5121,wrapMode:33071};c&&b&&(e.width=c,e.height=b);return new m.Texture(a,e)}function x(a){w.has(a)&&(y.splice(y.indexOf(a),1),w.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var y=[],w=new Set;d=function(a){function m(c,e){void 0===c&&(c=null);void 0===e&&(e=function(){return null});var n=a.call(this)||this;n.stencilRef=0;n.coordScale=[1,1];n._height=void 0;n.pixelRatio=1;n.resolution=0;n.rotation=0;n._source=null;n._width=void 0;n.x=0;n.y=0;n.transforms=
{dvs:b.mat3f32.create()};n.source=c;n.requestRender=e;return n}c(m,a);Object.defineProperty(m.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(a){this._height=a},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"source",{get:function(){return this._source},
set:function(a){this._source=a;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,
"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(a){this._width=a},enumerable:!0,configurable:!0});m.prototype.attach=function(){this.updateTexture();return!0};m.prototype.detach=function(){this._texture.dispose();this._texture=null;x(this)};m.prototype.invalidateTexture=function(){this.attached?this.updateTexture():x(this)};m.prototype.setTransform=function(a){var c=g.mat3.identity(this.transforms.dvs),b=a.toScreenNoRotation([0,0],this.x,this.y),h=this.resolution/
this.pixelRatio/a.resolution,e=h*this.width,h=h*this.height,n=Math.PI*this.rotation/180;g.mat3.translate(c,c,f.vec2f32.fromValues(b[0],b[1]));g.mat3.translate(c,c,f.vec2f32.fromValues(e/2,h/2));g.mat3.rotate(c,c,-n);g.mat3.translate(c,c,f.vec2f32.fromValues(-e/2,-h/2));g.mat3.scaleByVec2(c,c,f.vec2f32.fromValues(e,h));g.mat3.multiply(this.transforms.dvs,a.displayViewMat3,c)};m.prototype.updateTexture=function(){this._texture||(this._texture=this.source?u(this.stage.context,this.sourceWidth,this.sourceHeight):
u(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof e.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(l(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};m.prototype.setSamplingProfile=function(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))};
m.prototype.bind=function(a){this._texture&&this.stage.context.bindTexture(this._texture,a)};return m}(k.DisplayObject);a.Bitmap=d})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._renderRequestedCalled=!1;c._attached=!1;c._isReady=!1;c._opacity=1;c.renderRequested=
!1;c._visible=!0;return c}c(b,a);Object.defineProperty(b.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"opacity",{get:function(){return this._opacity},
set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});b.prototype.attach=function(){this.ready();return!0};b.prototype.setTransform=function(a){};b.prototype.detach=function(){};b.prototype.processRender=function(a){this.visible&&this.attached&&(this._renderRequestedCalled=
!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};b.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};b.prototype.dispose=function(){};b.prototype.doRender=function(a){};b.prototype.ready=function(){this._isReady=!0;
this.emit("isReady")};return b}(g);a.DisplayObject=d})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(d,a){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(a,c,f){this.pixelBlock=a;this.extent=c;this.originalPixelBlock=f}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var c=this.pixelBlock;if(c){var f=this.filter({pixelBlock:c}),c=f.pixelBlock.getAsRGBA(),f=a.createImageData(f.pixelBlock.width,f.pixelBlock.height);f.data.set(c);a.putImageData(f,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};
return a}();a.default=d})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(d,a,c,g,b,f){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function k(){return null!==a&&a.apply(this,arguments)||this}c(k,a);k.prototype.prepareRenderPasses=function(c){var e=this,k=c.registerRenderPass({name:"bitmap",brushes:[b.brushes.Bitmap],target:function(){return e.children}});
return a.prototype.prepareRenderPasses.call(this,c).concat([k])};return k}(f.default);a.BitmapContainer=d})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(d,a,c,g,b,f,m,k,e){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function l(c){var b=a.call(this)||this;b.name=b.constructor.name;
b._lastTime=null;b.setClips(c);return b}c(l,a);l.prototype.setClips=function(a){var c=this;b.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);b.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return k.default.fromClipArea(c,a)}));this.requestRender()};l.prototype.doRender=function(a){this.attachChildren();this.detachChildren();var c=this.createRenderParams(a),b=c.context,l=c.painter,k=c.globalOpacity,n=c.profiler,
k=c.drawPhase===e.WGLDrawPhase.LABEL?1:k*this.opacity;n.recordContainerStart(this.name);l.beforeRenderLayer(b,this._clippingInfos?255:0,k);this.updateTransforms(a.state);this.renderChildren(c);l.compositeLayer(b,k);n.recordContainerEnd()};l.prototype.renderChildren=function(a){b.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var c=0,e=this._renderPasses;c<e.length;c++)e[c].render(a)};l.prototype.createRenderParams=function(a){var c=Date.now(),e=(b.isSome(this._lastTime)?
c-this._lastTime:0)/1E3;this._lastTime=c;return g({},a,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:e,timeline:this.stage.timeline})};l.prototype.prepareRenderPasses=function(a){var c=this;return[a.registerRenderPass({name:"clip",brushes:[f.brushes.Clip],target:function(){return c._clippingInfos},drawPhase:e.WGLDrawPhase.MAP|e.WGLDrawPhase.LABEL|e.WGLDrawPhase.LABEL_ALPHA|
e.WGLDrawPhase.DEBUG})]};l.prototype.updateTransforms=function(a){for(var c=0,b=this.children;c<b.length;c++)b[c].setTransform(a)};return l}(m.Container);a.default=d})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._childrenSet=new Set;c._childrenToAttach=[];c._childrenToDetach=
[];c.children=[];return c}c(b,a);Object.defineProperty(b.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});b.prototype.detach=function(){for(var a=0,c=this.children.concat(this._childrenToDetach);a<c.length;a++){var b=c[a];b.attached&&(this.detachChild(b),b.attached=!1,b.parent=null)}};b.prototype.doRender=function(a){var c=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=
c};b.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};b.prototype.addChildAt=function(a,c){void 0===c&&(c=this.numChildren);if(!a||this.contains(a))return a;var b=a.parent;b&&b!==this&&b.removeChild(a);c>=this.numChildren?this.children.push(a):this.children.splice(c,0,a);this._childrenSet.add(a);c=this._childrenToDetach.indexOf(a);-1<c&&this._childrenToDetach.splice(c,1);this._childrenToAttach.push(a);this.requestRender();return a};b.prototype.contains=function(a){return this._childrenSet.has(a)};
b.prototype.getChildIndex=function(a){return this.children.indexOf(a)};b.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};b.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};b.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};b.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a);else{var c=this._childrenToAttach.indexOf(a);-1<c&&this._childrenToAttach.splice(c,1)}return a};b.prototype.setChildIndex=function(a,c){var b=this.getChildIndex(a);-1<b&&(this.children.splice(b,1),this.children.splice(c,0,a))};b.prototype.sortChildren=function(a){return this.children.sort(a)};b.prototype.attachChildren=function(){var a=this._childrenToAttach;if(0!==a.length)for(var c=0,b=!1;!b;)b=a[c],b.parent=this,b.stage=this.stage,this.attachChild(b)?
(b.attached=!0,a.splice(c,1)):++c,b=a.length===c};b.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var c=a.shift();this.detachChild(c);c.attached=!1;c.parent=null;c.stage=null}};b.prototype.renderChildren=function(a){for(var c=this.children,b=c.length,l=0;l<b;l++)c[l].processRender(a)};b.prototype.attachChild=function(a){return a.attach()};b.prototype.detachChild=function(a){a.detach()};return b}(g.DisplayObject);a.Container=d})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(d,a,c,g,b,f,m,k,e){Object.defineProperty(a,"__esModule",{value:!0});var l=b.getLogger("esri.views.2d.engine.webgl.ClippingInfo");d=function(a){function b(c,b){var e=a.call(this)||this;e._cache={};e.parent=c;e._handle=b.watch("version",function(){return e._invalidate()});e._clip=b;e.attach();e.attached=!0;return e}c(b,a);b.fromClipArea=function(a,c){return new b(a,c)};b.prototype._destroyGL=function(){f.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);f.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};b.prototype.destroy=function(){this._destroyGL();this._handle.remove()};b.prototype.doRender=function(){};b.prototype.getVAO=function(a,c,b,l){var n=c.size,k=n[0],n=n[1];if("geometry"===this._clip.type||this._lastWidth!==k||this._lastHeight!==n)this._lastWidth=k,this._lastHeight=n,this._destroyGL();f.isNone(this._cache.vao)&&(c=this._createMesh(c,this._clip),k=c.getIndexBuffer(a),n=c.getVertexBuffers(a),this._cache.mesh=c,this._cache.vao=new e(a,b,
l,n,k));return this._cache.vao};b.prototype._invalidate=function(){this._destroyGL();this.requestRender()};b.prototype._createScreenRect=function(a,c){var b=a.size;a=b[0];var b=b[1],e="string"===typeof c.left?parseFloat(c.left)/100*a:c.left,l="string"===typeof c.right?parseFloat(c.right)/100*a:c.right,k="string"===typeof c.top?parseFloat(c.top)/100*b:c.top;c="string"===typeof c.bottom?parseFloat(c.bottom)/100*b:c.bottom;return{x:e,y:k,width:Math.max(a-l-e,0),height:Math.max(b-c-k,0)}};b.prototype._createMesh=
function(a,c){switch(c.type){case "rect":return k.default.fromRect(this._createScreenRect(a,c));case "path":return k.default.fromPath(c);case "geometry":return k.default.fromGeometry(a,c);default:return l.error(new g("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),k.default.fromRect({x:0,y:0,width:1,height:1})}};return b}(m.DisplayObject);a.default=d})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(d,a,c,g,b,f,m,k,e,l,u,x,y){Object.defineProperty(a,"__esModule",{value:!0});var w=b.getLogger("esri.views.2d.engine.webgl.Mesh2D"),A=function(a,c){var b=a.coords;a=a.lengths;for(var e=[],h=0,l=0;h<a.length;l+=a[h],h+=1){for(var n=l,k=[];h<a.length-1;h+=1,l+=a[h]){for(var f=l+a[h],t=0,u=1;u<a[h+1];u++)t+=(b[2*(f+u)]-b[2*(f+u-1)])*(b[2*(f+u)+1]+b[2*(f+u-1)+1]);if(!(c?0<t:0>t))break;k.push(l+a[h]-n)}t=b.slice(2*n,2*(l+a[h]));f=0;for(k=m(t,k,2);f<k.length;f++)e.push(k[f]+n)}return e};d=function(){function a(a,
c,b,h){void 0===h&&(h=!1);this._cache={};this.vertices=a;this.indices=c;this.primitiveType=b;this.isMapSpace=h}a.fromRect=function(c){var b=c.x,e=c.y;return a.fromScreenExtent({xmin:b,ymin:e,xmax:b+c.width,ymax:e+c.height})};a.fromPath=function(c){var b=l.convertFromNestedArray(new u.default,c.path,!1,!1);c=b.coords;for(var b=new Uint32Array(A(b,!0)),e=new Uint32Array(c.length/2),h=0;h<e.length;h++)e[h]=x.i1616to32(Math.floor(c[2*h]),Math.floor(c[2*h+1]));return new a({geometry:e},b,4)};a.fromGeometry=
function(c,b){var e=b.geometry.type;switch(e){case "polygon":return a.fromPolygon(c,b.geometry);case "extent":return a.fromMapExtent(c,b.geometry);default:return w.error(new g("mapview-bad-type","Unable to create a mesh from type "+e,b)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(c,b){var n=l.convertFromPolygon(new u.default,b,!1,!1);b=n.coords;for(var n=new Uint32Array(A(n,!1)),h=new Uint32Array(b.length/2),f=e.vec2f64.create(),z=e.vec2f64.create(),m=0;m<h.length;m++)k.vec2.set(f,
b[2*m],b[2*m+1]),c.toScreen(z,f),h[m]=x.i1616to32(Math.floor(z[0]),Math.floor(z[1]));return new a({geometry:h},n,4,!0)};a.fromScreenExtent=function(c){var b=c.xmin,e=c.xmax,h=c.ymin;c=c.ymax;b={geometry:new Uint32Array([x.i1616to32(b,h),x.i1616to32(e,h),x.i1616to32(b,c),x.i1616to32(b,c),x.i1616to32(e,h),x.i1616to32(e,c)])};e=new Uint32Array([0,1,2,3,4,5]);return new a(b,e,4)};a.fromMapExtent=function(c,b){var e=c.toScreen([0,0],[b.xmin,b.ymin]),h=e[0],e=e[1];b=c.toScreen([0,0],[b.xmax,b.ymax]);c=
b[0];b=b[1];h={geometry:new Uint32Array([x.i1616to32(h,e),x.i1616to32(c,e),x.i1616to32(h,b),x.i1616to32(h,b),x.i1616to32(c,e),x.i1616to32(c,b)])};e=new Uint32Array([0,1,2,3,4,5]);return new a(h,e,4)};a.prototype.destroy=function(){f.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var a in this._cache.vertexBuffers)f.isSome(this._cache.vertexBuffers[a])&&this._cache.vertexBuffers[a].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var a;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=
5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new g("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(a,c){void 0===c&&(c=35044);this._cache.indexBuffer||(this._cache.indexBuffer=y.createIndex(a,c,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(a,b){var e=this;void 0===b&&(b=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(h,
l){var z;return c({},h,(z={},z[l]=y.createVertex(a,b,e.vertices[l]),z))},{}));return this._cache.vertexBuffers};return a}();a.default=d})},"esri/core/libs/earcut/earcut":function(){define([],function(){function d(h,b,l){l=l||2;var z=b&&b.length,k=z?b[0]*l:h.length,n=a(h,0,k,l,!0),u=[];if(!n||n.next===n.prev)return u;var t,v,q,w;if(z){var d=l,z=[],y,x,D;w=0;for(y=b.length;w<y;w++)x=b[w]*d,D=w<y-1?b[w+1]*d:h.length,x=a(h,x,D,d,!1),x===x.next&&(x.steiner=!0),z.push(e(x));z.sort(f);for(w=0;w<z.length;w++){b=
z[w];d=n;if(d=m(b,d))b=A(d,b),c(b,b.next);n=c(n,n.next)}}if(h.length>80*l){t=q=h[0];v=z=h[1];for(d=l;d<k;d+=l)w=h[d],b=h[d+1],w<t&&(t=w),b<v&&(v=b),w>q&&(q=w),b>z&&(z=b);q=Math.max(q-t,z-v);q=0!==q?1/q:0}g(n,u,l,t,v,q);return u}function a(a,c,b,e,l){var h;if(l===0<v(a,c,b,e))for(l=c;l<b;l+=e)h=t(l,a[l],a[l+1],h);else for(l=b-e;l>=c;l-=e)h=t(l,a[l],a[l+1],h);h&&x(h,h.next)&&(n(h),h=h.next);return h}function c(a,c){if(!a)return a;c||(c=a);var b;do if(b=!1,a.steiner||!x(a,a.next)&&0!==u(a.prev,a,a.next))a=
a.next;else{n(a);a=c=a.prev;if(a===a.next)break;b=!0}while(b||a!==c);return c}function g(a,e,z,f,m,t,v){if(a){if(!v&&t){var h=a,q=h;do null===q.z&&(q.z=k(q.x,q.y,f,m,t)),q.prevZ=q.prev,q=q.nextZ=q.next;while(q!==h);q.prevZ.nextZ=null;q.prevZ=null;var h=q,d,D,B,F,I,E,O=1;do{q=h;B=h=null;for(F=0;q;){F++;D=q;for(d=I=0;d<O&&(I++,D=D.nextZ,D);d++);for(E=O;0<I||0<E&&D;)0!==I&&(0===E||!D||q.z<=D.z)?(d=q,q=q.nextZ,I--):(d=D,D=D.nextZ,E--),B?B.nextZ=d:h=d,d.prevZ=B,B=d;q=D}B.nextZ=null;O*=2}while(1<F)}for(h=
a;a.prev!==a.next;){q=a.prev;D=a.next;if(t)B=b(a,f,m,t);else a:if(B=a,F=B.prev,I=B,O=B.next,0<=u(F,I,O))B=!1;else{E=d=B.next.next;for(var G=0;d!==B.prev&&(0===G||d!==E);){G++;if(l(F.x,F.y,I.x,I.y,O.x,O.y,d.x,d.y)&&0<=u(d.prev,d,d.next)){B=!1;break a}d=d.next}B=!0}if(B)e.push(q.i/z),e.push(a.i/z),e.push(D.i/z),n(a),h=a=D.next;else if(a=D,a===h){if(!v)g(c(a),e,z,f,m,t,1);else if(1===v){v=e;h=z;q=a;do D=q.prev,B=q.next.next,!x(D,B)&&y(D,q,q.next,B)&&w(D,B)&&w(B,D)&&(v.push(D.i/h),v.push(q.i/h),v.push(B.i/
h),n(q),n(q.next),q=a=B),q=q.next;while(q!==a);a=q;g(a,e,z,f,m,t,2)}else if(2===v)a:{v=a;do{for(h=v.next.next;h!==v.prev;){if(q=v.i!==h.i){q=v;D=h;B=void 0;if(B=q.next.i!==D.i&&q.prev.i!==D.i){B=void 0;b:{B=q;do{if(B.i!==q.i&&B.next.i!==q.i&&B.i!==D.i&&B.next.i!==D.i&&y(B,B.next,q,D)){B=!0;break b}B=B.next}while(B!==q);B=!1}B=!B}F=void 0;if(F=B&&w(q,D)&&w(D,q)){B=q;F=!1;I=(q.x+D.x)/2;D=(q.y+D.y)/2;do B.y>D!==B.next.y>D&&B.next.y!==B.y&&I<(B.next.x-B.x)*(D-B.y)/(B.next.y-B.y)+B.x&&(F=!F),B=B.next;
while(B!==q)}q=F}if(q){a=A(v,h);v=c(v,v.next);a=c(a,a.next);g(v,e,z,f,m,t);g(a,e,z,f,m,t);break a}h=h.next}v=v.next}while(v!==a)}break}}}}function b(a,c,b,e){var h=a.prev,n=a.next;if(0<=u(h,a,n))return!1;var f=h.x>a.x?h.x>n.x?h.x:n.x:a.x>n.x?a.x:n.x,z=h.y>a.y?h.y>n.y?h.y:n.y:a.y>n.y?a.y:n.y,q=k(h.x<a.x?h.x<n.x?h.x:n.x:a.x<n.x?a.x:n.x,h.y<a.y?h.y<n.y?h.y:n.y:a.y<n.y?a.y:n.y,c,b,e);c=k(f,z,c,b,e);b=a.prevZ;for(e=a.nextZ;b&&b.z>=q&&e&&e.z<=c;){if(b!==a.prev&&b!==a.next&&l(h.x,h.y,a.x,a.y,n.x,n.y,b.x,
b.y)&&0<=u(b.prev,b,b.next))return!1;b=b.prevZ;if(e!==a.prev&&e!==a.next&&l(h.x,h.y,a.x,a.y,n.x,n.y,e.x,e.y)&&0<=u(e.prev,e,e.next))return!1;e=e.nextZ}for(;b&&b.z>=q;){if(b!==a.prev&&b!==a.next&&l(h.x,h.y,a.x,a.y,n.x,n.y,b.x,b.y)&&0<=u(b.prev,b,b.next))return!1;b=b.prevZ}for(;e&&e.z<=c;){if(e!==a.prev&&e!==a.next&&l(h.x,h.y,a.x,a.y,n.x,n.y,e.x,e.y)&&0<=u(e.prev,e,e.next))return!1;e=e.nextZ}return!0}function f(a,b){return a.x-b.x}function m(a,b){var c=b,h=a.x,e=a.y,n=-Infinity,k;do{if(e<=c.y&&e>=c.next.y&&
c.next.y!==c.y){var f=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(f<=h&&f>n){n=f;if(f===h){if(e===c.y)return c;if(e===c.next.y)return c.next}k=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!k)return null;if(h===n)return k.prev;b=k;for(var f=k.x,q=k.y,m=Infinity,u,c=k.next;c!==b;)h>=c.x&&c.x>=f&&h!==c.x&&l(e<q?h:n,e,f,q,e<q?n:h,e,c.x,c.y)&&(u=Math.abs(e-c.y)/(h-c.x),(u<m||u===m&&c.x>k.x)&&w(c,a)&&(k=c,m=u)),c=c.next;return k}function k(a,c,b,e,l){a=32767*(a-b)*l;c=32767*(c-e)*l;a=(a|a<<8)&16711935;
a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function e(a){var c=a,b=a;do{if(c.x<b.x||c.x===b.x&&c.y<b.y)b=c;c=c.next}while(c!==a);return b}function l(a,c,b,e,l,n,k,f){return 0<=(l-k)*(c-f)-(a-k)*(n-f)&&0<=(a-k)*(e-f)-(b-k)*(c-f)&&0<=(b-k)*(n-f)-(l-k)*(e-f)}function u(a,c,b){return(c.y-a.y)*(b.x-c.x)-(c.x-a.x)*(b.y-c.y)}function x(a,c){return a.x===c.x&&a.y===c.y}function y(a,c,b,e){return x(a,
c)&&x(b,e)||x(a,e)&&x(b,c)?!0:0<u(a,c,b)!==0<u(a,c,e)&&0<u(b,e,a)!==0<u(b,e,c)}function w(a,c){return 0>u(a.prev,a,a.next)?0<=u(a,c,a.next)&&0<=u(a,a.prev,c):0>u(a,c,a.prev)||0>u(a,a.next,c)}function A(a,c){var b=new q(a.i,a.x,a.y),h=new q(c.i,c.x,c.y),e=a.next,l=c.prev;a.next=c;c.prev=a;b.next=e;e.prev=b;h.next=b;b.prev=h;l.next=h;h.prev=l;return h}function t(a,c,b,e){a=new q(a,c,b);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function n(a){a.next.prev=a.prev;a.prev.next=
a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function q(a,c,b){this.i=a;this.x=c;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function v(a,c,b,e){for(var h=0,l=b-e;c<b;c+=e)h+=(a[l]-a[c])*(a[c+1]+a[l+1]),l=c;return h}d.deviation=function(a,c,b,e){var h=c&&c.length,l=Math.abs(v(a,0,h?c[0]*b:a.length,b));if(h)for(var h=0,n=c.length;h<n;h++)l-=Math.abs(v(a,c[h]*b,h<n-1?c[h+1]*b:a.length,b));for(h=c=0;h<e.length;h+=3){var n=e[h]*b,k=e[h+1]*
b,f=e[h+2]*b;c+=Math.abs((a[n]-a[f])*(a[k+1]-a[n+1])-(a[n]-a[k])*(a[f+1]-a[n+1]))}return 0===l&&0===c?0:Math.abs((c-l)/l)};d.flatten=function(a){for(var c=a[0][0].length,b={vertices:[],holes:[],dimensions:c},e=0,h=0;h<a.length;h++){for(var l=0;l<a[h].length;l++)for(var n=0;n<c;n++)b.vertices.push(a[h][l][n]);0<h&&(e+=a[h-1].length,b.holes.push(e))}return b};return d})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(d,a){function c(a,c,b){return Math.round(Math.max(Math.min(a,
b),c))}Object.defineProperty(a,"__esModule",{value:!0});var g=new Float32Array(1),b=new Uint32Array(g.buffer);a.i8=function(a){return c(a,-128,127)};a.i16=function(a){return c(a,-32768,32767)};a.i32=function(a){return c(a,-2147483648,2147483647)};a.u8=function(a){return c(a,0,255)};a.u16=function(a){return c(a,0,65535)};a.u32=function(a){return c(a,0,4294967295)};a.toUint32=function(a){g[0]=a;return b[0]};a.toFloat32=function(a){b[0]=a;return g[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>
8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,c){return 65535&a|c<<16};a.i8888to32=function(a,c,b,e){return a&255|(c&255)<<8|(b&255)<<16|e<<24};a.i8816to32=function(a,c,b){return a&255|(c&255)<<8|b<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(d,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]=
"LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=
0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(d,a,c,g,b,f){Object.defineProperty(a,
"__esModule",{value:!0});d=function(a){function k(c,l,k,f){void 0===f&&(f=null);var e=a.call(this,c,l,k,k)||this;c=e.requestRender.bind(e);e.bitmap=new b.Bitmap(f,c);e.bitmap.coordScale=k;e.bitmap.once("isReady",function(){return e.ready()});return e}c(k,a);Object.defineProperty(k.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});k.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,b,
c);this.bitmap.transforms.dvs=this.transforms.dvs};k.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};k.prototype.detach=function(){this.bitmap.detach()};return k}(f.TiledDisplayObject);a.BitmapTile=d})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(d,a,c,g,b,f,m,k){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function e(b,c,e,l){void 0===l&&(l=e);var u=a.call(this)||this;u.transforms={dvs:f.mat3f32.create(),tileMat3:f.mat3f32.create()};u.triangleCount=0;u.key=k.pool.acquire(b);u.bounds=c;u.size=e;u.coordRange=l;return u}c(e,a);e.prototype.destroy=function(){k.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(e.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,configurable:!0});e.prototype.setTransform=function(a,c){c/=a.resolution*a.pixelRatio;var e=this.transforms.tileMat3,l=a.toScreenNoRotation([0,0],this.coords);b.mat3.set(e,this.size[0]/this.coordRange[0]*c,0,0,0,this.size[1]/this.coordRange[1]*c,0,l[0],l[1],1);b.mat3.multiply(this.transforms.dvs,a.displayViewMat3,e)};
return e}(m.DisplayObject);a.TiledDisplayObject=d})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(d,a,c,g,b,f,m,k){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:
a.key.col-b.key.col};d=function(e){function l(a,b){b=e.call(this,b)||this;b._tileInfoView=a;return b}c(l,e);l.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();e.prototype.renderChildren.call(this,b)};l.prototype.createRenderParams=function(a){var b=a.state;return g({},e.prototype.createRenderParams.call(this,a),{requiredLevel:this._tileInfoView.getClosestInfoForScale(b.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(b.scale)})};l.prototype.prepareRenderPasses=
function(a){var c=this,l=a.registerRenderPass({name:"stencil",brushes:[k.default],drawPhase:b.WGLDrawPhase.DEBUG|b.WGLDrawPhase.MAP,target:function(){return c.children}}),f=a.registerRenderPass({name:"tileInfo",brushes:[m.default],drawPhase:b.WGLDrawPhase.DEBUG,target:function(){return c.children},has:"esri-tiles-debug"});return e.prototype.prepareRenderPasses.call(this,a).concat([l,f])};l.prototype.updateTransforms=function(a){for(var b=0,c=this.children;b<c.length;b++){var e=c[b],l=this._tileInfoView.getTileResolution(e.key);
e.setTransform(a,l)}};l.prototype.setStencilReference=function(){for(var a=1,b=0,c=this.children;b<c.length;b++)c[b].stencilRef=a++};return l}(f.default);a.default=d})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(d,a,c,g,b,f,m,k){Object.defineProperty(a,"__esModule",
{value:!0});d=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,0,0,1);return b}c(e,a);e.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};e.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};e.prototype.draw=function(a,b){a=a.context;if(b.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
b.coordRange[0],b.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",b.coordRange[0]/b.size[0],b.coordRange[1]/
b.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};e.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var c=b.createProgram(a,m.background),e=b.createProgram(a,k.tileInfo),l={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},f=new Int8Array([0,0,1,0,1,1,0,1]),f=b.BufferObject.createVertex(a,
35044,f),f=new b.VertexArrayObject(a,m.background.attributes,l,{geometry:f}),t=new Int8Array([0,0,1,0,0,1,1,1]),t=b.BufferObject.createVertex(a,35044,t);a=new b.VertexArrayObject(a,k.tileInfo.attributes,l,{geometry:t});this._outlineProgram=c;this._tileInfoProgram=e;this._outlineVertexArrayObject=f;this._tileInfoVertexArrayObject=a}};e.prototype._getTexture=function(a,c){if(c.texture)return c.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var e=c.triangleCount,l=c.key.id;0<c.triangleCount&&(l+=", "+e);var k=this._canvas,f=k.getContext("2d");f.font="24px sans-serif";f.textAlign="left";f.textBaseline="top";f.clearRect(0,0,300,32);1E5<e?(f.fillStyle="red",f.fillRect(0,0,300,32),f.fillStyle="black"):(f.clearRect(0,0,300,32),f.fillStyle="blue");f.fillText(l,0,0);c.texture=new b.Texture(a,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},k);return c.texture};return e}(f.default);a.default=d})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(d,a){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,b,c){};a.prototype.draw=function(a,b,c){};a.prototype.drawMany=function(a,b,c){for(var f=0;f<b.length;f++)this.draw(a,b[f],c)};return a}();
a.default=d})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(d,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:c.resolveIncludes("background/background.vert"),fragmentShader:c.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});var b=new c.ShaderCompiler(function(a){var b=g;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(d,a){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying vec2 v_dotTextureCoords;\nvarying vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision mediump float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying vec4 v_sizeTex;\nvarying vec3 v_pos;\nvarying float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying float v_overridingOutlineColor;\nvarying float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nuniform vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying vec3 v_pos;\nvarying float v_opacity;\nvarying vec4 v_color;\nvarying vec2 v_tex;\nvarying float v_antialiasingWidth;\nvarying float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision mediump float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},
stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(d,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:c.resolveIncludes("tileInfo/tileInfo.vert"),
fragmentShader:c.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),function(d,a,c,g,b,f,m){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,
0,0,1);b._initialized=!1;return b}c(e,a);e.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prototype.prepareState=function(a,b){a=a.context;a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,
516,b.stencilRef,255)};e.prototype.draw=function(a,b){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",b.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};e.prototype._initialize=function(a){if(this._initialized)return!0;
var c=b.createProgram(a,m.background);if(!c)return!1;var e=new Int8Array([0,0,1,0,0,1,1,1]),e=b.BufferObject.createVertex(a,35044,e);a=new b.VertexArrayObject(a,m.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:e});this._solidProgram=c;this._solidVertexArrayObject=a;return this._initialized=!0};return e}(f.default);a.default=d})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(d,a,c,g,b,f,m,k,e,l,u,x,y,w,A,t,n,q,v,h,D,z,B,E,I,F){Object.defineProperty(a,"__esModule",{value:!0});d=function(a){function n(c,h){var n=a.call(this)||this;n._renderParameters={drawPhase:0,state:n.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};n._clipData=new Float32Array(8);n._upperLeft=A.vec2f64.create();n._upperRight=A.vec2f64.create();n._lowerLeft=A.vec2f64.create();n._lowerRight=A.vec2f64.create();n._mat2=y.mat2df64.create();n._clipRendererInitialized=!1;n._supersampleScreenshots=
!0;n.dataUploadCounter=0;n.stage=n;n._stationary=!0;n.attached=!0;var l=h.canvas,l=void 0===l?document.createElement("canvas"):l,k=h.alpha,q=h.stencil,v=h.renderContext,g=h.supersampleScreenshots,g=void 0===g?!0:g,u=h.contextOptions,u=void 0===u?{}:u;n._canvas=l;k=t.createContextOrErrorHTML(l,{alpha:void 0===k?!0:k,antialias:!1,depth:!0,stencil:void 0===q?!0:q},void 0===v?"webgl":v);n.context=new t.RenderingContext(k,u);n.painter=new D.default(n.context);n._taskHandle=e.addFrameTask({render:function(){return n.renderFrame()}});
n._taskHandle.pause();n._supersampleScreenshots=g;n._lostWebGLContextHandle=f.on(l,"webglcontextlost",function(){n.emit("webgl-error",{error:new b("webgl-context-lost")})});m("esri-2d-profiler")&&(n._debugOutput=document.createElement("div"),n._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),c.appendChild(n._debugOutput));l.setAttribute("style","width: 100%; height:100%; display:block;");n.profiler=new z.Profiler(n.context,n._debugOutput);n.renderingOptions=
h.renderingOptions;n.timeline=h.timeline||new I.Timeline;n.driverTestResult=B.testWebGLDriver(n.context);c.appendChild(l);return n}c(n,a);n.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(n.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var b=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=l.init(this._highlightOptions,"version",function(){b.painter.setHighlightOptions(a);b.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(n.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});n.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};n.prototype.renderFrame=function(){var a=Date.now()-this._lastRenderRequestTime;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters);a>=v.MAX_ANIMATION_TIME_MS&&
this._taskHandle.pause()};n.prototype.renderChildren=function(a){var b=this.context,c=this.children,c=a.children?a.children:c;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=h.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(b);for(var e=0;e<c.length;e++){var n=c[e];n.attached&&n.processRender(a)}this.painter.renderLayers(b);a.drawPhase=h.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(b);for(e=0;e<c.length;e++)n=c[e],n.attached&&n.processRender(a);
this.painter.renderLayers(b);if(m("esri-tiles-debug")){a.drawPhase=h.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(b);for(e=0;e<c.length;e++)n=c[e],n.attached&&n.processRender(a);this.painter.renderLayers(b)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};n.prototype.beforeRenderChildren=function(a){var b=this.context,c=a.state,e=a.pixelRatio;if(this.painter){b.enforceState();var h=c.size;a=c.rotation;var n=Math.round(h[0]*e),h=Math.round(h[1]*e);this._boundFBO=b.getBoundFramebufferObject();
if(c.spatialReference&&(c.spatialReference._isWrappable?c.spatialReference._isWrappable():c.spatialReference.isWrappable)){var l=u.common.toRadian(a),k=Math.abs(Math.cos(l)),f=Math.abs(Math.sin(l)),q=Math.round(c.worldScreenWidth);if(Math.round(n*k+h*f)<=q)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===n&&this._clipFBO.height===h||(this._clipFBO=new t.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:n,height:h}));var v=(this.state.padding.left-this.state.padding.right)/
2,m=(this.state.padding.bottom-this.state.padding.top)/2,z=.5*n,g=.5*h,c=1/n,d=1/h,e=.5*q*e,A=.5*(n*f+h*k),n=this._upperLeft,k=this._upperRight,f=this._lowerLeft,q=this._lowerRight;w.vec2.set(n,-e,-A);w.vec2.set(k,e,-A);w.vec2.set(f,-e,A);w.vec2.set(q,e,A);x.mat2d.identity(this._mat2);x.mat2d.translate(this._mat2,this._mat2,[z+v,g+m]);0!==a&&x.mat2d.rotate(this._mat2,this._mat2,l);w.vec2.transformMat2d(n,n,this._mat2);w.vec2.transformMat2d(k,k,this._mat2);w.vec2.transformMat2d(f,f,this._mat2);w.vec2.transformMat2d(q,
q,this._mat2);a=this._clipData;a.set([2*f[0]*c-1,2*(h-f[1])*d-1,2*q[0]*c-1,2*(h-q[1])*d-1,2*n[0]*c-1,2*(h-n[1])*d-1,2*k[0]*c-1,2*(h-k[1])*d-1]);this._clipRendererInitialized||this._initializeClipRenderer(b);this._clipVBO.setData(a);this._boundFBO=b.getBoundFramebufferObject();b.bindFramebuffer(this._clipFBO);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);
b.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};n.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),
a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};n.prototype.doRender=function(b){var c=this.context,e=b.state,h=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();c.setViewport(0,0,h*e.size[0],h*e.size[1]);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);this.background&&this.background.color?
(e=this.background.color,c.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);a.prototype.doRender.call(this,b)};n.prototype.takeScreenshot=function(a,b){var c=F.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),e=c.framebufferWidth,h=c.framebufferHeight,n=this.context,l=a.layers,f={drawPhase:null,globalOpacity:1,
stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:c.pixelRatio};if(null!=a.rotation){var q=f.state.viewpoint;q.rotation=a.rotation;f.state.viewpoint=q}0<l.length&&(f.children=[],l.forEach(function(a){var c=b.find(function(b){return b.layer.id===a.id});c&&"container"in c&&c.container&&c.attached&&f.children.push(c.container)}));var v=new t.FramebufferObject(n,{colorTarget:0,depthStencilTarget:3,width:e,height:h}),l=n.getBoundFramebufferObject(),q=n.getViewport();n.bindFramebuffer(v);
n.setViewport(0,0,e,h);e=n.gl;!a.ignoreBackground&&this.background&&this.background.color?(h=this.background.color,n.setClearColor(h.r/255,h.g/255,h.b/255,h.a)):n.setClearColor(0,0,0,0);n.setClearDepth(1);n.setClearStencil(0);n.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);this.renderChildren(f);c=this._readbackScreenshot(c);n.bindFramebuffer(l);n.setViewport(q.x,q.y,q.width,q.height);this.requestRender();n=this._ensureScreenshotEncodeCanvas();a=F.encodeResult(c,a,n,{flipY:!0,
premultipliedAlpha:!0});return k.resolve(a)};n.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};n.prototype._readbackScreenshot=function(a){var b=a.framebufferWidth,c=a.framebufferHeight,e=a.region;a=a.resample;var h=this.context.gl;if(a){var n=F.createEmptyImageData(b,c,this._ensureScreenshotEncodeCanvas());h.readPixels(0,0,b,c,6408,5121,new Uint8Array(n.data.buffer));
b=F.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());return F.resampleHermite(n,b,!0,a.region.x,c-(a.region.y+a.region.height),a.region.width,a.region.height)}n=F.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());h.readPixels(e.x,c-(e.y+e.height),e.width,e.height,6408,5121,new Uint8Array(n.data.buffer));return n};n.prototype._resizeCanvas=function(a){var b=this._canvas,c=b.style,e=a.state.size,h=a.pixelRatio;a=e[0];var e=e[1],n=Math.round(a*h),
h=Math.round(e*h);if(b.width!==n||b.height!==h)b.width=n,b.height=h;c.width=a+"px";c.height=e+"px"};n.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new q.BitBlitRenderer;var b=E.stencil.attributes,c=t.createProgram(a,E.stencil);if(!c)return!1;var e=t.BufferObject.createVertex(a,35040,32),h=new Uint16Array([0,1,2,2,1,3]),h=t.BufferObject.createIndex(a,35044,h);a=new t.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,
stride:8,normalized:!1,divisor:0}]},{geometry:e},h);this._clipStencilProgram=c;this._clipVBO=e;this._clipVAO=a;return this._clipRendererInitialized=!0};return n}(n.Container);a.Stage=d})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),
this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,b,c,e){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(c),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",e),a.drawArrays(5,0,4),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;
var b=g.bitBlit.attributes,k=c.createProgram(a,g.bitBlit);if(!k)return!1;var e=new Int8Array(16);e[0]=-1;e[1]=-1;e[2]=0;e[3]=0;e[4]=1;e[5]=-1;e[6]=1;e[7]=0;e[8]=-1;e[9]=1;e[10]=0;e[11]=1;e[12]=1;e[13]=1;e[14]=1;e[15]=1;a=new c.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:c.BufferObject.createVertex(a,35044,e)});this._program=k;this._vertexArrayObject=
a;return this._initialized=!0};return a}();a.BitBlitRenderer=d})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(d,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:c.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:c.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],
function(d,a){Object.defineProperty(a,"__esModule",{value:!0});a.WEBGL_MAX_STOPS=8;a.WEBGL_MAX_INNER_STOPS=a.WEBGL_MAX_STOPS-2;a.NAN_MAGIC_NUMBER=1E-30;a.EXTRUDE_SCALE=64;a.PICTURE_FILL_COLOR=4294967295;a.TILE_SIZE=512;a.RASTER_TILE_SIZE=256;a.ANGLE_FACTOR_256=256/360;a.DEBUG_LABELS=!1;a.COLLISION_BUCKET_SIZE=128;a.DOT_DENSITY_MAX_FIELDS=8;a.COLLISION_MAX_ZOOM_DELTA=3;a.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;a.COLLISION_BOX_PADDING=16;a.COLLISION_TILE_BOX_SIZE=a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;a.COLLISION_PLACEMENT_PADDING=
8;a.HEURISTIC_GLYPHS_PER_LINE=50;a.HEURISTIC_GLYPHS_PER_FEATURE=10;a.GLYPH_SIZE=24;a.TEXT_LINE_HEIGHT=1.2*a.GLYPH_SIZE;a.TEXT_MAX_WIDTH=10*a.GLYPH_SIZE;a.TEXT_SPACING=0;a.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};a.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;a.TEXTURE_BINDING_SPRITE_ATLAS=0;a.TEXTURE_BINDING_GLYPH_ATLAS=0;a.TEXTURE_BINDING_BITMAP=0;a.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;a.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;a.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;a.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;a.TEXTURE_BINDING_HIGHLIGHT_0=5;a.TEXTURE_BINDING_HIGHLIGHT_1=6;a.TEXTURE_BINDING_RENDERER_0=5;a.TEXTURE_BINDING_RENDERER_1=6;a.ATTRIBUTE_DATA_FILTER_FLAGS=0;a.ATTRIBUTE_DATA_ANIMATION=1;a.ATTRIBUTE_DATA_VV=2;a.ATTRIBUTE_DATA_DD0=3;a.ATTRIBUTE_DATA_DD1=3;a.MAX_FILTERS=2;a.HIGHLIGHT_FLAG=1;a.FILTER_FLAG_0=2;a.EFFECT_FLAG_0=4;a.THIN_LINE_THRESHOLD=2.5;a.HITTEST_SEARCH_SIZE=24;a.MAX_ANIMATION_TIME_MS=2E3;a.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;a.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;a.VTL_HIGH_RES_CUTOFF=
1.15;a.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),function(d,a,c,g,b,f,m,k,e,l,u,x,y,w){Object.defineProperty(a,"__esModule",{value:!0});d=function(){return function(){}}();
a.PainterOptions=d;d=function(){function a(a){this.context=a;this._blitRenderer=new m.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:b.brushes.Marker,line:b.brushes.Line,fill:b.brushes.Fill,text:b.brushes.Text,label:b.brushes.Label,clip:b.brushes.Clip,stencil:b.brushes.Stencil,bitmap:b.brushes.Bitmap,tileInfo:b.brushes.TileInfo,vtlBackground:b.brushes.VTLBackground,vtlFill:b.brushes.VTLFill,vtlLine:b.brushes.VTLLine,vtlCircle:b.brushes.VTLCircle,vtlSymbol:b.brushes.VTLSymbol};
this.textureManager=new l;this.effects={highlight:new x.default,hittest:new y.HittestEffect,integrate:new u.AnimationEffect};this.materialManager=new e(a);this._vtlProgramCache=new f.default(a)}a.prototype.getFbos=function(a,b){if(a!==this._lastWidth||b!==this._lastHeight){this._lastWidth=a;this._lastHeight=b;if(this._fbos)for(var c in this._fbos)this._fbos[c].dispose();c={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:b};var e={colorTarget:0,depthStencilTarget:3};
a=new g.Renderbuffer(this.context,{width:a,height:b,internalFormat:34041});this._fbos={output:new g.FramebufferObject(this.context,e,c,a),alpha:new g.FramebufferObject(this.context,e,c,a),effect0:new g.FramebufferObject(this.context,e,c,a)}}return this._fbos};a.prototype.beforeRenderLayers=function(a){var b=a.getViewport(),b=this.getFbos(b.width,b.height);this._prevFBO=a.getBoundFramebufferObject();a.bindFramebuffer(b.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);
a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(a,b,c){1!==c?(a.bindFramebuffer(this._fbos.alpha),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(b);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(a,b){1!==b&&(a.bindFramebuffer(this._fbos.output),
a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.alpha.colorTexture,9728,b))};a.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.output.colorTexture,
9728,1))};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var b in this.effects)this.effects[b]&&
this.effects[b].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(a){var c;a=(c={},c[k.WGLGeometryType.FILL]=b.brushes.Fill,c[k.WGLGeometryType.LINE]=b.brushes.Line,c[k.WGLGeometryType.MARKER]=b.brushes.Marker,c[k.WGLGeometryType.TEXT]=b.brushes.Text,c)[a];c=this._brushCache.get(a);void 0===c&&(c=new a,this._brushCache.set(a,c));return this._brushCache.get(a)};a.prototype.renderObject=function(a,b,c,e){c=this.brushNameToCtor[c];if(!c)return null;var h=this._brushCache.get(c);void 0===
h&&(h=new c,this._brushCache.set(c,h));h.prepareState(a,b,e);h.draw(a,b,e)};a.prototype.renderObjects=function(a,b,c,e){c=this.brushNameToCtor[c];if(!c)return null;var h=this._brushCache.get(c);void 0===h&&(h=new c,this._brushCache.set(c,h));h.drawMany(a,b,e)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(a){var b=this,c=a.brushes.map(function(a){b._brushCache.has(a)||b._brushCache.set(a,new a);return b._brushCache.get(a)});return new w.default(c,
a)};a.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};return a}();a.default=d})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(a){this._cache=Array(8);for(var b=0;8>b;b++)this._cache[b]={};this._programRepo=new c.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),
this._programRepo=null)};a.prototype.getProgram=function(a,b,c){var e=this._cache[a];e[b]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),c),e[b]=a);return e[b]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return g.background.attributes;case 5:return g.circle.attributes;case 1:return g.fill.attributes;case 4:return g.icon.attributes;case 3:return g.line.attributes;case 2:return g.outline.attributes;case 6:return g.text.attributes;default:return null}};a.prototype._getProgramTemplate=
function(a){switch(a){case 0:return g.background;case 5:return g.circle;case 1:return g.fill;case 4:return g.icon;case 3:return g.line;case 2:return g.outline;case 6:return g.text;default:return null}};return a}();a.default=d})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,
PATTERN:a.pattern})+g.resolveIncludes("background/background.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var b=function(a){return c.glslifyDefineMap({ID:a.id,
DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:b(a)+g.resolveIncludes("fill/fill.vert"),fragmentShader:b(a)+g.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,
a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var f=function(a){return c.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:f(a)+g.resolveIncludes("line/line.vert"),
fragmentShader:f(a)+g.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require",
"exports","../../../../../webgl","./shaderRepository"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});var b=new c.ShaderCompiler(function(a){var b=g;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(d,a){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(d,
a,c,g,b,f,m){var k=function(a){return a===f.WGLDrawPhase.HITTEST||a===f.WGLDrawPhase.LABEL_ALPHA},e=function(a,b,e,m){m=m.reduce(function(b,e){var l;return c({},b,(l={},l[e]=a.driverTestResult[e],l))},{});b=c({},b.getVariation(),a.rendererInfo.getVariation(),{highlight:a.drawPhase===f.WGLDrawPhase.HIGHLIGHT,id:k(a.drawPhase)},m);if(g.isSome(e))for(m=0;m<e.length;m++)b[e[m]]=!0;return b};return function(){function a(a){this._programByKey=new Map;this._programCache=new b.ProgramCache(a)}a.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=function(a,b,e,l){void 0===e&&(e=[]);void 0===l&&(l=[]);var k=b.path+e.join(".")+l.join(".");if(this._programByKey.has(k))return this._programByKey.get(k);l=l.reduce(function(b,e){var n;return c({},b,(n={},n[e]=a.driverTestResult[e],n))},{});e=c({},e.reduce(function(a,b){var e;return c({},a,(e={},e[b]=!0,e))},{}),l);b=this._programCache.getProgram(m.createProgramTemplate(b.path,b.attributes),e);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(k,b);return b};a.prototype.getMaterialProgram=function(a,b,c,l,d,t){void 0===t&&(t=["ignoresSamplerPrecision"]);var n,q=t;n=a.rendererInfo;var v=a.drawPhase,q=b.getVariationHash()+"-"+q.join(".")+"-",v=(k(v)?1:0)|(v===f.WGLDrawPhase.HIGHLIGHT?2:0);n=q+v+"-"+n.getVariationHash()+"-"+(g.isSome(d)&&d.join("."));if(this._programByKey.has(n))return this._programByKey.get(n);a=e(a,b,d,t);c=this._programCache.getProgram(m.createProgramTemplate(c,l),a);if(!c)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(n,c);return c};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(d,a,c,g){Object.defineProperty(a,"__esModule",{value:!0});var b=function(a){var b={},k;for(k in a){for(var e=k,l=void 0,l=""+e[0].toUpperCase(),f=1;f<e.length;f++){var g=e[f];g===g.toUpperCase()?(l+="_",l+=g):l+=g.toUpperCase()}b[l]=a[k]}return c.glslifyDefineMap(b)};a.createProgramTemplate=function(a,c){var k=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:c,shaders:function(a){return{vertexShader:b(a)+g.resolveIncludes(k+".vert"),fragmentShader:b(a)+g.resolveIncludes(k+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./util/Result ./util/symbolUtils".split(" "),
function(d,a,c,g,b,f,m,k,e,l,u,x,y,w,A,t,n,q,v,h,D,z){var B=x.vec2f32.create(),E=e.getLogger("esri.views.2d.engine.webgl.TextureManager"),I=function(){function a(a,b,c){this.mosaicType=a;this.page=b;this.sdf=c}a.fromMosaic=function(b,c){return new a(b,c.page,c.sdf)};return a}();return function(){function a(){this._invalidFontsMap=new Map;this._sdfConverter=new v.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new y.default;this._spriteMosaic=new h(2048,2048,500);
this._glyphSource=new q(f.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new n(1024,1024,this._glyphSource)}Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=
this._spriteMosaic=null};a.prototype._hashMosaic=function(a,b){return 1|a<<1|(b.sdf?1:0)<<2|b.page<<3};a.prototype._setTextureBinding=function(a,b){var c=this._hashMosaic(a,b);this._hashToBindingIndex.has(c)||(a=I.fromMosaic(a,b),this._hashToBindingIndex.set(c,this._bindingInfos.length+1),this._bindingInfos.push(a));b.textureBinding=this._hashToBindingIndex.get(c)};a.prototype.rasterizeItem=function(a,b,c){var e=this;void 0===b&&(b=null);return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(E.error(new k("mapview-invalid-type",
"MapView does not support 3d symbol type: "+a.type,a)),l.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,c).then(function(a){D.ok(a)&&a&&e._setTextureBinding(A.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,b,c).then(function(a){a.forEach(function(a){return e._setTextureBinding(A.MosaicType.GLYPH,a)});return{glyphMosaicItems:a}}):(E.error(new k("mapview-null-resource",
"Unable to rasterize null resource")),l.resolve(null))};a.prototype.bindTextures=function(a,b,c,e){void 0===e&&(e=1);if(0!==c.textureBinding){var h=this._bindingInfos[c.textureBinding-1];c=h.page;switch(h.mosaicType){case A.MosaicType.SPRITE:h=this.sprites.getWidth(c)/e;e=this.sprites.getHeight(c)/e;e=u.vec2.set(B,h,e);this._bindSpritePage(a,c,w.TEXTURE_BINDING_SPRITE_ATLAS,9729);b.setUniform1i("u_texture",w.TEXTURE_BINDING_SPRITE_ATLAS);b.setUniform2fv("u_mosaicSize",e);break;case A.MosaicType.GLYPH:h=
this.glyphs.width/e;e=this.glyphs.height/e;e=u.vec2.set(B,h,e);this._bindGlyphsPage(a,c,w.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform1i("u_texture",w.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform2fv("u_mosaicSize",e);break;default:E.error("mapview-texture-manager","Cannot handle unknown type "+h.mosaicType)}}};a.prototype._bindSpritePage=function(a,b,c,e){e||(e=9729);this._spriteMosaic.bind(a,e,b,c)};a.prototype._bindGlyphsPage=function(a,b,c){this._glyphMosaic.bind(a,9729,b,c)};a.prototype._rasterizeTextSymbol=
function(a,b,c){var e=this,h=t.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(h);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":h,b,c).catch(function(){E.error(new k("mapview-invalid-resource","Couldn't find font "+h+". Falling back to Arial Unicode MS Regular"));e._invalidFontsMap.set(h,!0);return e._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b,c)})};a.prototype._rasterizeSpriteSymbol=function(a,c){return g(this,void 0,void 0,function(){var e,h,n,l,f,
q;return b(this,function(b){b="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(z.isFillSymbol(a)||z.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(b)return[2,null];e=z.keyFromSymbol(a);return this._spriteMosaic.has(e)?[2,this._spriteMosaic.getSpriteItem(e)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||!a.path?a.url||a.imageData?[2,this._handleImage(a,e,c)]:(h=this._rasterizer.rasterizeJSONResource(a))?
(n=h.size,l=h.image,f=h.sdf,q=h.simplePattern,[2,this._addItemToMosaic(e,n,l,!z.isMarkerSymbol(a),f,q)]):[2,new k("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,e,c)]})})};a.prototype._handleSVG=function(a,c,e){return g(this,void 0,void 0,function(){var h,n;return b(this,function(b){switch(b.label){case 0:return h=[126,126],[4,this._sdfConverter.draw(a.path,e)];case 1:return n=b.sent(),[2,this._addItemToMosaic(c,h,new Uint32Array(n.buffer),!1,!0,!0)]}})})};a.prototype._handleImage=
function(a,e,h){return g(this,void 0,void 0,function(){var n,f,q,v,g,d,u;return b(this,function(b){switch(b.label){case 0:n=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,m(n,c({responseType:"image"},h))];case 2:return f=b.sent().data,q=this._rasterizer.rasterizeImageResource(f,a.colorSubstitutions),v=q.size,g=q.sdf,d=q.image,[2,this._addItemToMosaic(e,v,d,!z.isMarkerSymbol(a),g,!1)];case 3:return u=b.sent(),l.isAbortError(u)?[3,4]:
[2,new k("mapview-invalid-resource","Could not fetch requested resource at "+n)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(a,b,c,e,h,n){return this._spriteMosaic.addSpriteItem(a,b,c,e,h,n)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(d,a,c,g,b){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};
a.prototype.rasterizeJSONResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=c.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=c.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var e;a="simple-marker"===a.type||"esriSMS"===a.type?c.CIMSymbolHelper.fromSimpleMarker(a):a;if((e=g.getSDFInfo(a))&&!b)return b=g.buildSDF(e),(a=b[0])?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=c.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!b);a=b[0];e=b[3];var l=b[4];return a?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:e,anchorY:l}:null};a.prototype.rasterizeImageResource=
function(a,c){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var e=this._rasterizationCanvas.getContext("2d");e.drawImage(a,0,0,a.width,a.height);e=e.getImageData(0,0,a.width,a.height);e=new Uint8Array(e.data);if(c)for(var l=0;l<c.length;l++){var k=c[l];if(k&&k.oldColor&&4===k.oldColor.length&&k.newColor&&4===k.newColor.length){var f=k.oldColor,g=f[0],d=f[1],m=f[2],f=f[3],t=k.newColor,
k=t[0],n=t[1],q=t[2],v=t[3];if(g!==k||d!==n||m!==q||f!==v)for(t=0;t<e.length;t+=4)g===e[t]&&d===e[t+1]&&m===e[t+2]&&f===e[t+3]&&(e[t]=k,e[t+1]=n,e[t+2]=q,e[t+3]=v)}}for(t=0;t<e.length;t+=4)c=e[t+3]/255,e[t]*=c,e[t+1]*=c,e[t+2]*=c;c=a.width;l=a.height;g=e;if(512<=c||512<=l)g=a.width/a.height,1<g?(c=512,l=Math.round(512/g)):(l=512,c=Math.round(512*g)),g=new Uint8Array(4*c*l),b.resampleHermite(e,a.width,a.height,new Uint8ClampedArray(g.buffer),c,l,!1);return{size:[c,l],image:new Uint32Array(g.buffer),
sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=d})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports ../../Color ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMCursor ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(d,a,c,g,b,f,m,k,e,l,u){function x(a,b){switch(b.type){case "CIMSymbolReference":var c={type:"point",x:0,y:0};a.drawSymbol(b.symbol,c);break;case "CIMPointSymbol":c=
{type:"point",x:0,y:0};a.drawSymbol(b,c);break;case "CIMVectorMarker":c=new e.Placement,a.drawMarker(b,c)}return a.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var y=Math.PI,w=y/2,A=g.getLogger("esri.symbols.cim.CIMSymbolHelper");d=function(){function a(){}a.getEnvelope=function(a){var b=new l.EnvDrawHelper;if(Array.isArray(a)){for(var c=void 0,e=0;e<a.length;e++){var n=a[e];c?c.union(x(b,n)):c=x(b,n)}return c}return x(b,a)};a.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||
0>=a.width||0>=a.height)return[0,0];var b=96/72;return[(a.x+.5*a.width)*b/(a.width*b+2),-(a.y+.5*a.height)*b/(a.height*b+2)]};a.rasterize=function(a,b,c){void 0===c&&(c=!0);var h=this.getEnvelope(b);if(!h||0>=h.width||0>=h.height)return[null,0,0,0,0];var n=96/72,k=(h.x+.5*h.width)*n,f=(h.y+.5*h.height)*n;a.width=h.width*n+2;a.height=h.height*n+2;h=a.getContext("2d");n=l.Transformation.createScale(n,-n);n.translate(.5*a.width-k,.5*a.height+f);n=new l.CanvasDrawHelper(h,n);switch(b.type){case "CIMPointSymbol":n.drawSymbol(b,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":var q=new e.Placement;n.drawMarker(b,q)}b=h.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);if(c)for(c=void 0,h=0;h<b.length;h+=4)c=b[h+3]/255,b[h]*=c,b[h+1]*=c,b[h+2]*=c;return[b,a.width,a.height,-k/a.width,-f/a.height]};a.fromSimpleMarker=function(a){var b,c,e=a.style;if("circle"===e||"esriSMSCircle"===e){b=Math.acos(.995);c=Math.ceil(y/b/4);0===c&&(c=1);b=w/c;c*=4;e=[];e.push([50,0]);for(var n=1;n<c;n++)e.push([50*Math.cos(n*b),-50*
Math.sin(n*b)]);e.push([50,0]);b={rings:[e]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===e||"esriSMSCross"===e)b=0,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===e||"esriSMSDiamond"===e)b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===e||"esriSMSSquare"===e)b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],
[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===e||"esriSMSX"===e)b=0,b={rings:[[[0,b],[50-b,50],[50,50-b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===e||"esriSMSTriangle"===e)c=2/3*100,e=c-100,b={rings:[[[-57.735026918962575,e],[0,c],[57.735026918962575,e],[-57.735026918962575,e]]]},c={xmin:-57.735026918962575,ymin:e,xmax:57.735026918962575,ymax:c};var l;b&&c&&(l=[{type:"CIMSolidFill",
enable:!0,color:a.color}],a.outline&&l.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),l={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:l}}]}]});return l};a.getFillColor=function(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var c=0;for(b=
b.symbolLayers;c<b.length;c++){var e=a.getFillColor(b[c]);if(null!=e)return e}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var e=a.getStrokeColor(b[c]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);case "CIMSolidStroke":return b.color}};a.getStrokeWidth=
function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var e=a.getStrokeWidth(b[c]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var c=0;if(b.symbolLayers){var e=0;for(b=b.symbolLayers;e<
b.length;e++){var h=a.getSize(b[e]);h>c&&(c=h)}}return c;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};a.executeEffects=function(a,b,c){void 0===c&&(c=!1);var e=96/72,l=a?a.length:0;l&&c&&--l;for(c=
0;c<l;++c){var n=a[c];if(n){var f=k.getEffectOperator(n);f&&(b=f.execute(b,n,e))}}return b};a.processEffects=function(c,e,l){var h;c.effects&&0<c.effects.length&&(h=f.deltaEncodeGeometry(l),h=new m.SimpleGeometryCursor(h),h=a.executeEffects(c.effects,h));c=c.symbolLayers[e];c.effects&&0<c.effects.length&&(e=!1,"CIMGeometricEffectDashes"===c.effects[c.effects.length-1].type&&(e=!0),h||(h=f.deltaEncodeGeometry(l),h=new m.SimpleGeometryCursor(h)),h=a.executeEffects(c.effects,h,e));if(!h)return l;l=[];
for(c=h.next();c;)l.push(c),c=h.next();h=l.length;switch(h){case 0:return null;case 1:return f.deltaEncodeGeometry(l[0]);default:c=l[0];for(e=1;e<h;++e){var n=l[e];b.isPolygon(c)&&b.isPolygon(n)&&Array.prototype.push.apply(c.rings,n.rings);b.isPolyline(c)&&b.isPolyline(n)&&Array.prototype.push.apply(c.paths,n.paths)}return f.deltaEncodeGeometry(c)}};return a}();a.CIMSymbolHelper=d;d=function(){function a(){}a.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==
b||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=8;var c=a.getContext("2d");c.strokeStyle="#FFFFFF";c.lineWidth=1;c.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b)c.moveTo(0,0),c.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)c.moveTo(0,0),c.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)c.moveTo(0,0),c.lineTo(8,
8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===b)c.moveTo(8,0),c.lineTo(0,8);c.stroke();b=c.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var e=0;e<b.length;e+=4)c=b[e+3]/255,b[e]*=c,b[e+1]*=c,b[e+2]*=c;return[b,a.width,a.height]};a.rasterizeSimpleLine=function(a,b){switch(b){case "butt":b="Butt";break;case "square":b="Square";break;default:b="Round"}var c="Butt"===b;switch(a){case "dash":case "esriSLSDash":a=c?[4,3]:
[3,4];break;case "dash-dot":case "esriSLSDashDot":a=c?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=c?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=c?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":a=c?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=c?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=c?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=c?[4,1,1,1]:[3,2,0,2];break;
case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=c?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=c?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":A.error("Unexpected: style does not require rasterization");a=[0,0];break;default:A.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),a=[0,0]}return this.rasterizeDash(a,b)};a.rasterizeDash=function(a,b){var c="Butt"===b,e="Square"===b;b=!c&&!e;for(var l=0,k=0;k<a.length;k++)var n=
a[k],l=l+n;for(var l=15*l,f=31*l,k=new Float32Array(f),g=b?225:15,n=0;n<f;++n)k[n]=g;for(var g=f=0,d=!0,m=0;m<a.length;m++){for(var n=a[m],f=g,g=g+15*n,w=f;w<g;){for(var A=0;31>A;){var n=A*l+w,t=b?(A-15)*(A-15):Math.abs(A-15);k[n]=d?c?Math.max(Math.max(f+7.5-w,t),Math.max(w-g+7.5,t)):t:b?Math.min((w-f)*(w-f)+t,(w-g)*(w-g)+t):e?Math.min(Math.max(w-f,t),Math.max(g-w,t)):Math.min(Math.max(w-f+7.5,t),Math.max(g+7.5-w,t));A++}w++}d=!d}a=k.length;c=new Uint8Array(4*a);for(n=0;n<a;++n)u.packFloatRGBA((b?
Math.sqrt(k[n]):k[n])/15,c,4*n);return[c,l,31]};return a}();a.SymbolHelper=d;d=function(){function a(){}a.findApplicableOverrides=function(b,c,e){if(c){if(b.primitiveName){for(var h=!1,l=0;l<e.length;l++){var k=e[l];if(k.primitiveName===b.primitiveName){h=!0;break}}if(!h)for(h=0;h<c.length;h++)k=c[h],k.primitiveName===b.primitiveName&&e.push(k)}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(h=0,l=b.effects;h<l.length;h++)k=l[h],a.findApplicableOverrides(k,
c,e);if(b.symbolLayers)for(k=0,b=b.symbolLayers;k<b.length;k++)a.findApplicableOverrides(b[k],c,e);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(b.effects)for(h=0,l=b.effects;h<l.length;h++)k=l[h],a.findApplicableOverrides(k,c,e);b.markerPlacement&&a.findApplicableOverrides(b.markerPlacement,c,e);if("CIMVectorMarker"===
b.type){if(b.markerGraphics)for(k=0,b=b.markerGraphics;k<b.length;k++)h=b[k],a.findApplicableOverrides(h,c,e),a.findApplicableOverrides(h.symbol,c,e)}else"CIMCharacterMarker"===b.type?a.findApplicableOverrides(b.symbol,c,e):"CIMHatchFill"===b.type&&a.findApplicableOverrides(b.lineSymbol,c,e)}}};a.applyOverrides=function(b,c,e,h){if(c){if(b.primitiveName)for(var l=0;l<c.length;l++){var k=c[l];if(k.primitiveName===b.primitiveName){var f;f=(f=k.propertyName)?f.charAt(0).toLowerCase()+f.substr(1):f;h&&
h.push({cim:b,nocapPropertyName:f,value:b[f]});k.expression&&(k.value=a.toValue(k.propertyName,k.expression));if(e){for(var n=!1,g=0,d=e;g<d.length;g++)d[g].primitiveName===b.primitiveName&&(n=!0);n||e.push(k)}b[f]=k.value}}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(k=0,f=b.effects;k<f.length;k++)l=f[k],a.applyOverrides(l,c,e,h);if(b.symbolLayers)for(l=0,b=b.symbolLayers;l<b.length;l++)a.applyOverrides(b[l],c,e,h);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(b.effects)for(k=
0,f=b.effects;k<f.length;k++)l=f[k],a.applyOverrides(l,c,e,h);if("CIMVectorMarker"===b.type&&b.markerGraphics)for(l=0,b=b.markerGraphics;l<b.length;l++)k=b[l],a.applyOverrides(k,c,e,h),a.applyOverrides(k.symbol,c,e,h)}}};a.restoreOverrides=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.cim[c.nocapPropertyName]=c.value}};a.buildOverrideKey=function(a){for(var b="",c=0;c<a.length;c++){var e=a[c];void 0!==e.value&&(b+=""+e.primitiveName+e.propertyName+JSON.stringify(e.value))}return b};a.toValue=
function(a,b){return"DashTemplate"===a?b.split(" ").map(function(a){return Number(a)}):"Color"===a?(a=(new c(b)).toRgba(),a[3]*=255,a):b};return a}();a.OverrideHelper=d})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../geometry/support/jsonUtils","./CIMPlacements"],function(d,a,c,g){function b(a){if(a)for(var b=a.length-1;0<b;--b)a[b][0]-=a[b-1][0],a[b][1]-=a[b-1][1]}function f(a){if(a)for(var c=0;c<a.length;c++)b(a[c])}function m(a){if(a)for(var b=a.length,c=1;c<b;++c)a[c][0]+=
a[c-1][0],a[c][1]+=a[c-1][1]}function k(a){if(a)for(var b=0;b<a.length;b++)m(a[b])}function e(a){a&&a.reverse()}function l(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.deltaEncodePath=b;a.deltaEncodeMultipath=f;a.deltaDecodeGeometry=function(a){c.isPolygon(a)?k(a.rings):c.isPolyline(a)?k(a.paths):c.isMultipoint(a)&&m(a.points);return a};a.deltaEncodeGeometry=function(a){c.isPolygon(a)?f(a.rings):
c.isPolyline(a)?f(a.paths):c.isMultipoint(a)&&b(a.points);return a};a.reverseMultipath=function(a){if(a)for(var b=0;b<a.length;b++)e(a[b])};a.reversePath=e;a.getCoord2D=function(a,b,c){return[a[0]+(b[0]-a[0])*c,a[1]+(b[1]-a[1])*c]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,b){a[4]=b};d=function(){function a(a,b,e,k){this.acceptPolygon=b;this.acceptPolyline=e;this.geomUnitsPerPoint=
k;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(c.isPolygon(a)?b&&(this.multiPath=a.rings,this.isClosed=!0):c.isPolyline(a)?e&&(this.multiPath=a.paths,this.isClosed=!1):c.isExtent(a)&&b&&(this.multiPath=l(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new g.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);
if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=d;d=function(){function a(a,b,c,e){this.inputGeometries=a;this.acceptPolygon=b;this.acceptPolyline=c;this.geomUnitsPerPoint=e;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(c.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):c.isPolyline(a)?this.acceptPolyline&&
(this.multiPath=a.paths,this.isClosed=!1):c.isExtent(a)&&this.acceptPolygon&&(this.multiPath=l(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=
d})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(d,a){Object.defineProperty(a,"__esModule",{value:!0});d=function(){function a(){this.setIdentity()}a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,b){this.tx=a;this.ty=b};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,b){this.rz=void 0;this.rz_c=a;this.rz_s=b};a.prototype.setRotate=
function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=d;d=function(){}