window.adition=window.adition||{},window.adition.srq=window.adition.srq||[],window.o_wo=window.o_wo||{};class e{constructor(e,t,i,n,r,s,a){this.clickTracking=e,this.viewTracking=t,this.trackingApi=i,this.watoRequest=n,this.productData=r,this.shoppingProcess=s,this.utils=a}_appendWrapperDiv(e,t){var i=document.createElement("div");return i.id=t,null!==e&&e.appendChild(i),i}_hasSearchTerm(){var e=document.getElementById("san_searchResult");return e&&e.getAttribute("data-userquery")}_getSearchTerm(){var e=document.getElementById("san_searchResult").getAttribute("data-userquery");return encodeURIComponent(this.productData.cleanupSearchTerm(e))}_addCssClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t}_setIframeHeightToBannerHeight(e){var t=e&&e.contentWindow&&e.contentWindow.document&&e.contentWindow.document.getElementsByTagName("img");t&&t.length>0&&(e.height=t[0].scrollHeight)}_makeIframeScalable(e){1===e.length&&(e[0].style.width="100%",e[0].style.maxWidth="400px",this._setIframeHeightToBannerHeight(e[0]))}_setCharacteristicProfiles(e,t){if(t){var i=JSON.parse(t);for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];e.setProfile(n,r)}}}_shouldNotRender(e){return""===e.getBannerCode()}_prepareRenderingSlot(e,t,i){var n;n="wo_av_sidebar"===e?document.querySelectorAll(".av_anchor").item(0):document.getElementById("san_av_bottom")||document.getElementById("wato_av_bottom");var r=this._appendWrapperDiv(n,e);this._addCssClass(n,"wo_avContent"),window.adition.srq.push((n=>{var s=this.shoppingProcess.isInShoppingProcess()?"true":"false",a=t.av_id;o_util.cookie.exists("cb")&&"0"!==o_util.cookie.get("cb")?n.identityService.setUserId(i):(n.disableCookies(),n.identityService.setUserId(i).optout()),n.registerAdfarm("as.otto.de"),n.setProfile("ishp",s),"ads"===t.identifier&&this.productData.setProductDataProfiles(n),this._hasSearchTerm()&&n.setProfile("sw",this._getSearchTerm()),n.setProfile("app",o_util.cookie.exists("app").toString()),n.configureRenderSlot(e).setContentunitId(a).setRenderer("iframe"),this._setCharacteristicProfiles(n,t.mostImportantCharacteristics),t.convertedDresonRule&&n.setProfile("dresonrule",t.convertedDresonRule),n.events.onPreRender(((e,t,i)=>{if(this._shouldNotRender(t))i.disable();else{this._addCssClass(r,"wo_marginTop"),this._addCssClass(r,"wo_marginBottom");var n,s=t.getOptions(),a=this._buildTitle(s);r.appendChild(a),(n=document.createElement("div")).className="wo_avInnerWrapper",i.addInnerWrapper(n)}})),n.events.onNoBanner((()=>{this.viewTracking.trackNoView(t)})),n.events.onFinishLoading(((i,n)=>{if(this.viewTracking.trackView(n.getOptions(),t),"wo_av_bottombar"===e){var r=i.getElementsByTagName("iframe");this._makeIframeScalable(r)}this._registerTrackingClickHandler(n.getOptions())})),n.load([e]).completeRendering()})),this._loadSingleRequest()}_retrieveAvContent(e,t,i){var n={sidebar:"wo_av_sidebar",bottombar:"wo_av_bottombar"};this._prepareRenderingSlot(n[t],e,i),window.adition.srq.push((e=>e.renderSlot(n[t])))}_registerTrackingClickHandler(e){this.utils.debugLog("_registerTrackingClickHandler: "+(e=>{try{return JSON.stringify(e)}catch(e){return"{}"}})(e));var t=document.querySelector(".wo_avInnerWrapper iframe");if(t){var i=t.contentDocument?t.contentDocument:t.contentWindow.document;if("loading"===i.readyState)return this.utils.debugLog("_registerTrackingClickHandler: iframe content not ready. Registering DOMContentLoaded handler..."),i.addEventListener("DOMContentLoaded",(()=>{var t=i.getElementsByTagName("a")[0];this.clickTracking.registerClickHandler(t,(()=>this.clickTracking.trackClick(e)))}));this.utils.debugLog("_registerTrackingClickHandler: iframe content ready. Registering click handler...");var n=i.getElementsByTagName("a")[0];this.clickTracking.registerClickHandler(n,(()=>this.clickTracking.trackClick(e)))}}_buildTitle(e){var t=document.createElement("p");return t.className="wo_caption",e&&"true"===e.internal?t.innerHTML="Aktuell bei OTTO":t.innerHTML="Anzeige",t}_loadSingleRequest(){if(!document.getElementById("wo_singleRequestScript")){this.trackingApi.sendMergeRequest({wato_AinfoResponse:"true"});var e=document.createElement("script");e.id="wo_singleRequestScript",e.type="text/javascript",e.src="https://is.otto.de/js/srp.js",e.charset="utf-8",e.async=!0;var t=document.getElementsByTagName("script")[0];e.onload=()=>{this.trackingApi.sendMergeRequest({wato_Request:"true"})},t.parentNode.insertBefore(e,t)}}_sidebarContentShouldBeLoaded(){return document.getElementsByClassName("av_anchor").length>0&&this.utils.isCurrentWindowWideEnough()}_bottombarContentShouldBeLoaded(){var e=o_global.breakpoint.isSmall()||o_global.breakpoint.isMedium();return(!!document.getElementById("san_av_bottom")||!!document.getElementById("wato_av_bottom"))&&e}_getAdvertData(e){return this.watoRequest.getAdvertData(e).then((t=>{var{responseJSON:i,aditionUserId:n}=t;return this._retrieveAvContent(i,e,n)})).catch((e=>{this.utils.debugLog(e)}))}_tryToRenderAdditionContent(){return!window.o_wo.sidebarRendered&&this._sidebarContentShouldBeLoaded()?(window.o_wo.sidebarRendered=!0,this._getAdvertData("sidebar")):!window.o_wo.bottombarRendered&&this._bottombarContentShouldBeLoaded()?(window.o_wo.sidebarRendered=!0,this._getAdvertData("bottombar")):Promise.reject("found no place to render.")}fillAvContent(){this._tryToRenderAdditionContent().catch((e=>this.utils.debugLog(e)))}}var t="inShoppingProcess";class i{constructor(e){this.utils=e}sendEventRequest(e){this._isTrackingBctAvailable()&&(window.o_tracking.bct.sendEventToTrackingServer(e),this.utils.debugLog("wato event tracking",e))}sendEventMergeRequest(e,t){this._isTrackingBctAvailable()&&(window.o_tracking.bct.sendEventMergeToTrackingServer(e,t),this.utils.debugLog("wato event merge tracking",e,t))}sendMergeRequest(e){this._isTrackingBctAvailable()&&(window.o_tracking.bct.sendMergeToTrackingServer(e),this.utils.debugLog("wato merge tracking",e))}trackOnNextPageImpression(e){this._isTrackingBctAvailable()&&(window.o_tracking.bct.trackOnNextPageImpression(e),this.utils.debugLog("wato tracking event on next page impression",e))}_isTrackingBctAvailable(){return window.o_tracking&&window.o_tracking.bct}}class n{debugLog(e){if(o_global&&o_global.debug&&o_global.debug.status&&!0===o_global.debug.status().activated){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];console.log("Wato: "+e,JSON.stringify(i))}}getCurrentTimeStamp(){return(new Date).getTime()}getWindowInnerWidth(e){return(e||window).innerWidth||document.documentElement.clientWidth||document.body.clientWidth}isCurrentWindowWideEnough(e){return this.getWindowInnerWidth(e)>=1232}}var r=new class{fetchAndSetAndGet(e){return o_util.cookie.exists("cb")&&"0"!==o_util.cookie.get("cb")?o_util.ajax({url:"https://static.adfarm1.adition.com/cn.sjs",method:"GET",withCredentials:!0}).then((e=>e.responseText||"")).then((e=>e.trim())).then((t=>{var i=e.split(".");return i=i.splice(i.length-2).join("."),o_util.cookie.set("aditionUserId",t,{domain:i,days:"3650",samesite:"None"}),t})):Promise.resolve("")}},s=new class{stringReplaceAll(e,t){var i=e;for(var n in t)i=i.replace(new RegExp(t[n],"g"),n);return i}cleanupSearchTerm(e){return this.stringReplaceAll(e,{Ae:"[Ä]",ae:"[ä]",oe:"[ö]",Oe:"[Ö]",Ue:"[Ü]",ue:"[ü]","-":"[ ]",_:"[\\/]",ss:"[ß]","":"^_|_$|[^a-zA-Z0-9.,_\\-]"})}cleanupBrandName(e){return this.stringReplaceAll(e.toUpperCase(),{_AND_:"&",PLUS:"[+]",_:"[. -]",A:"[ÀÁÂÃÅĂ]",AE:"[ÄÆ]",C:"[ÇČ]",E:"[ÈÉÊËĒ]",I:"[ÌÍÎÏ]",N:"Ñ",O:"[ÒÓÔÕŌŎ]",OE:"[ÖŒØ]",R:"Ř",S:"[ȘŠ]",SS:"ß",U:"[ÙÚÛŰ]",UE:"Ü",Y:"[ÝŸ]","":"[^\\w\\s_]"})}setProductDataProfiles(e){var t=document.getElementById("avJson");if(t){var i=JSON.parse(t.textContent);i.id&&e.setProfile("productId",i.id),i.businessCategory&&i.businessCategory.value&&e.setProfile("categoryValue",i.businessCategory.value),i.businessCategory&&i.businessCategory.group&&e.setProfile("categoryGroup",i.businessCategory.group),i.brand&&e.setProfile("brand",this.cleanupBrandName(i.brand)),i.retailPrice&&e.setProfile("price",i.retailPrice),i.classificationGroup&&e.setProfile("classificationGroup",i.classificationGroup)}}},a=new n,o=new i(a),d=new class{constructor(e){this.utils=e}enterShoppingProcess(){var e=o_util.cookie.get("visitorId");if(e){var i=JSON.stringify({visitorId:e,timeStamp:this.utils.getCurrentTimeStamp()});try{localStorage.setItem(t,i)}catch(e){this.utils.debugLog("enterShoppingProcess:",e)}}}leaveShoppingProcess(){try{localStorage.removeItem(t)}catch(e){this.utils.debugLog("leaveShoppingProcess:",e)}}isInShoppingProcess(){try{var e=o_util.cookie.get("visitorId"),i=localStorage.getItem(t);if(e&&i){var n=JSON.parse(i),r=new Date(n.timeStamp);if(r.setMinutes(r.getMinutes()+30),e===n.visitorId&&r.getTime()>this.utils.getCurrentTimeStamp())return!0}}catch(e){this.utils.debugLog("isInShoppingProcess:",e)}return!1}}(a),c=new class{constructor(e){this.trackingApi=e}trackView(e,t){var i="noContent",n=e.campaignid?e.campaignid:i,r=e.bannerid?e.bannerid:i;this.trackingApi.sendMergeRequest({wato_AdActivity:"view",wato_AdContent:n+"$"+r,wato_AdPosition:t.websiteid+"$"+t.av_id})}trackNoView(e){this.trackingApi.sendMergeRequest({wato_AdActivity:"false",wato_AdPosition:e.websiteid+"$"+e.av_id})}}(o),l=new class{constructor(e,t){this.trackingApi=e,this.utils=t}trackClick(e){var t="noContent",i=e.campaignid?e.campaignid:t,n=e.bannerid?e.bannerid:t;this.trackingApi.trackOnNextPageImpression({wato_AdClick:"true","wk.wato_AdContentClick":i+"$"+n,ot_AccPath:"wato"})}registerClickHandler(e,t){if(this.utils.debugLog("ClickTracking.registerClickHandler: Element:"+e+", trackClick: "+t),e){var i=n=>{n.preventDefault(),e.removeEventListener("click",i),this.utils.debugLog("ClickTracking.listener: "+n),t(),e.click(),e.addEventListener("click",i)};e.addEventListener("click",i)}}}(o,a),g=new class{constructor(e,t){this.trackingApi=e,this.aditionCookie=t}_getSelectionRule(e){return e.getAttribute("data-rule")}_isAditionEnabled(){return"true"!==o_util.cookie.get("seleniumBypassAdvertising")}_hasClass(e,t){return e&&e.classList.contains(t)}_getAditionIdentifier(){var e=document.getElementById("avContent");return this._hasClass(e,"js_av_searchResult")?{identifier:"suchergebnisseite"}:this._hasClass(e,"js_av_productList")||this._hasClass(e,"js_av_teaser")?{identifier:"kategorieseite",rule:this._getSelectionRule(e)}:this._hasClass(e,"user_logout")?{identifier:"logoutseite"}:this._hasClass(e,"storeFrontAV")?{identifier:"storefront"}:"Suchergebnisseite"===document.getElementsByTagName("html")[0].getAttribute("data-pagecluster")?{identifier:"suchergebnisseite"}:document.getElementById("avJson")?{identifier:"ads"}:null}_toRuleParameter(e){return e?"&rule=".concat(e):""}getAdvertData(e){if(!this._isAditionEnabled())return Promise.reject("Adition is disabled - not calling wato in the first place");var t=this._getAditionIdentifier();if(null===t)return Promise.reject("Could not identify the page type");this.trackingApi.sendMergeRequest({wato_AinfoRequest:"true"});var i="/wato-onsite/a_info?identifier=".concat(encodeURIComponent(t.identifier),"&areatype=").concat(encodeURIComponent(e)).concat(this._toRuleParameter(t.rule));return Promise.resolve(o_util.ajax.getJSON(i).then((e=>200===e.status&&e.responseJSON&&e.responseJSON.av_id?this.aditionCookie.fetchAndSetAndGet(window.location.hostname).then((t=>Promise.resolve({responseJSON:e.responseJSON,aditionUserId:t}))):Promise.reject({message:"Got nothing of use from wato - aborting.",response:e}))))}}(o,r),u=new class{constructor(e){this.shoppingProcess=e}enterShoppingProcess(){this.shoppingProcess.enterShoppingProcess()}leaveShoppingProcess(){this.shoppingProcess.leaveShoppingProcess()}}(d);window.o_wo=window.o_wo||{},window.o_wo.api=u;var h=new n,m=e=>e.contentDocument&&e.contentDocument.body?e.contentDocument.body:{scrollHeight:0,scrollWidth:0};class p{constructor(e){var t=document.createElement("iframe");t.src=e,t.id="wato-iframe",t.src=e,t.scrolling="no",t.frameBorder="0",t.style.visibility="hidden",t.style.width="100%",t.onload=this.createOnloadHandler(),this.onSuccess=()=>{},this.onFailure=()=>{},this.iframe=t}appendTo(e){if(h.debugLog("AppIframe.appendTo"),!this.iframe)throw new Error("AppIframe not initialized");e.appendChild(this.iframe)}getReference(){return document.getElementById(this.iframe.id)}getContentWidth(e){return m(e).scrollWidth+"px"}getContentHeight(e){return m(e).scrollHeight+"px"}tearDownIframe(){var e=this.getReference();e.parentNode.removeChild(e),this.iframe=null}isIframeLoaded(){var e=this.getReference();return!(!e.contentDocument||!e.contentDocument.getElementById("wato-content"))}createOnloadHandler(){return()=>{var e=this.getReference();e.style.height=this.getContentHeight(e),e.style.width=this.getContentWidth(e),this.isIframeLoaded()?(this.onSuccess(e),e.style.visibility="visible"):(this.tearDownIframe(),this.onFailure())}}}var _="PRODUKTLISTE",w="KATEGORIESEITE",v="LOGOUTSEITE",b="STOREFRONT",k="SUCHERGEBNISSEITE",f="PDP",C="160x600",y="600x300,600x150,600x100",A="300x150,300x75,300x50",S=e=>{return new URLSearchParams((t=e,i=Object.assign({},t),Object.keys(i).filter((e=>null===i[e]&&delete i[e])),i)).toString();var t,i},I=new n;var T,E=new class{getOdinToggle(e){var t="".concat("/wato-onsite","/useOdinNetwork?deviceType=").concat(e);return o_util.ajax.getJSON(t).then((e=>200!==e.status?{useOdinNetwork:!1}:{useOdinNetwork:e.responseJSON.useOdinNetwork})).catch((()=>({useOdinNetwork:!1})))}},P=new i(new n);T=new class{constructor(e,t){this.odinClient=e,this.trackingApi=t}isEnabled(e){return this.odinClient.getOdinToggle(e).then((e=>e.useOdinNetwork)).catch((()=>!1))}_isAdvertAlreadyDisplayed(e){return e.children.length>0}_queryPlacementId(e){return"mobile"===e?(document.getElementById("wato_av_bottom")||document.getElementById("san_av_bottom")).getAttribute("data-placement-id"):document.getElementById("wato_onsite_advert").getAttribute("data-placement-id")}_scrapePlacementId(){var e=document.getElementById("avContent");return this._hasClass(e,"js_av_productList")?_:this._hasClass(e,"js_av_teaser")?w:this._hasClass(e,"user_logout")?v:this._hasClass(e,"storeFrontAV")?b:this._hasClass(e,"js_av_searchResult")||"Suchergebnisseite"===document.getElementsByTagName("html")[0].getAttribute("data-pagecluster")?k:document.getElementById("avJson")?f:null}_getPlacementId(e){var t="mobile"===e?"MobileContentAd_":"SKYSCRAPER_";return this._queryPlacementId(e)?this._queryPlacementId(e):this._scrapePlacementId()?t+this._scrapePlacementId():null}_hasClass(e,t){return e&&e.classList.contains(t)}renderSkyscraper(){var e=document.getElementById("wato_onsite_advert");if(e&&(!e||!this._isAdvertAlreadyDisplayed(e))){var t=this._getPlacementId("desktop"),i=S({placementId:t,sizes:C,pageUrl:location.href}),n="/wato-onsite/advertisement?".concat(i),r=new p(n);r.onFailure=this.getOnFailureCallback(t),r.onSuccess=