!function r(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=o[t]={exports:{}},i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,r,i,o,a)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(n,r,e){!function(e,t){"use strict";"object"==typeof r&&r.exports?r.exports=t(n("moment")):"function"==typeof define&&define.amd?define(["moment"],t):t(e.moment)}(this,function(i){"use strict";var t,u={},o={},l={},h={},e=(i&&"string"==typeof i.version||I(),i.version.split(".")),n=+e[0],r=+e[1];function c(e){return 96<e?e-87:64<e?e-29:e-48}function m(e){var t=0,n=e.split("."),r=n[0],i=n[1]||"",o=1,a=0,n=1;for(45===e.charCodeAt(0)&&(n=-(t=1));t<r.length;t++)a=60*a+c(r.charCodeAt(t));for(t=0;t<i.length;t++)o/=60,a+=c(i.charCodeAt(t))*o;return a*n}function g(e){for(var t=0;t<e.length;t++)e[t]=m(e[t])}function v(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=e[t[r]];return n}function y(e){for(var e=e.split("|"),t=e[2].split(" "),n=e[3].split(""),r=e[4].split(" "),i=(g(t),g(n),g(r),r),o=n.length,a=0;a<o;a++)i[a]=Math.round((i[a-1]||0)+6e4*i[a]);return i[o-1]=1/0,{name:e[0],abbrs:v(e[1].split(" "),n),offsets:v(t,n),untils:r,population:0|e[5]}}function a(e){e&&this._set(y(e))}function s(e){var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);"GMT"===(n=n&&n[0]?(n=n[0].match(/[A-Z]/g))?n.join(""):void 0:(n=t.match(/[A-Z]{3,5}/g))?n[0]:void 0)&&(n=void 0),this.at=+e,this.abbr=n,this.offset=e.getTimezoneOffset()}function b(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function _(){for(var e,t,n=(new Date).getFullYear()-2,r=new s(new Date(n,0,1)),i=[r],o=1;o<48;o++)(t=new s(new Date(n,o,1))).offset!==r.offset&&(e=function(e,t){for(var n;n=6e4*((t.at-e.at)/12e4|0);)(n=new s(new Date(e.at+n))).offset===e.offset?e=n:t=n;return e}(r,t),i.push(e),i.push(new s(new Date(e.at+6e4)))),r=t;for(o=0;o<4;o++)i.push(new s(new Date(n+o,0,1))),i.push(new s(new Date(n+o,6,1)));return i}function w(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function S(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&3<e.length){var t=l[d(e)];if(t)return t;I()}}catch(e){}for(var n,r,i=_(),o=i.length,a=function(e){for(var t,n,r=e.length,i={},o=[],a=0;a<r;a++)for(t in n=h[e[a].offset]||{})n.hasOwnProperty(t)&&(i[t]=!0);for(a in i)i.hasOwnProperty(a)&&o.push(l[a]);return o}(i),s=[],c=0;c<a.length;c++){for(n=new b(f(a[c])),r=0;r<o;r++)n.scoreOffsetAt(i[r]);s.push(n)}return s.sort(w),0<s.length?s[0].zone.name:void 0}function d(e){return(e||"").toLowerCase().replace(/\//g,"_")}function E(e){var t,n,r,i;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++){i=d(n=(r=e[t].split("|"))[0]),u[i]=e[t],l[i]=n,a=o=c=s=void 0;var o,a,s=i,c=r[2].split(" ");for(g(c),o=0;o<c.length;o++)a=c[o],h[a]=h[a]||{},h[a][s]=!0}}function f(e,t){e=d(e);var n,r=u[e];return r instanceof a?r:"string"==typeof r?(r=new a(r),u[e]=r):o[e]&&t!==f&&(n=f(o[e],f))?((r=u[e]=new a)._set(n),r.name=l[e],r):null}function A(e){var t,n,r,i;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=d((n=e[t].split("|"))[0]),i=d(n[1]),o[r]=i,l[r]=n[0],o[i]=r,l[i]=n[1]}function k(e){E(e.zones),A(e.links),p.dataVersion=e.version}function T(e){return T.didShowError||(T.didShowError=!0,I()),!!f(e)}function C(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function I(){}function p(e){var t=Array.prototype.slice.call(arguments,0,-1),n=arguments[arguments.length-1],r=f(n),t=i.utc.apply(null,t);return r&&!i.isMoment(e)&&C(t)&&t.add(r.parse(t),"minutes"),t.tz(n),t}(n<2||2==n&&r<6)&&I(i.version),a.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){for(var t=+e,n=this.untils,r=0;r<n.length;r++)if(t<n[r])return r},parse:function(e){for(var t,n,r,i=+e,o=this.offsets,a=this.untils,s=a.length-1,c=0;c<s;c++)if(t=o[c],n=o[c+1],r=o[c&&c-1],t<n&&p.moveAmbiguousForward?t=n:r<t&&p.moveInvalidForward&&(t=r),i<a[c]-6e4*t)return o[c];return o[s]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return I(),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},b.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},p.version="0.5.25",p.dataVersion="",p._zones=u,p._links=o,p._names=l,p.add=E,p.link=A,p.load=k,p.zone=f,p.zoneExists=T,p.guess=function(e){return t=t&&!e?t:S()},p.names=function(){var e,t=[];for(e in l)l.hasOwnProperty(e)&&(u[e]||u[o[e]])&&l[e]&&t.push(l[e]);return t.sort()},p.Zone=a,p.unpack=y,p.unpackBase60=m,p.needsOffset=C,p.moveInvalidForward=!0,p.moveAmbiguousForward=!1;var x,e=i.fn;function P(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function M(e){return function(){return this._z=null,e.apply(this,arguments)}}i.tz=p,i.defaultZone=null,i.updateOffset=function(e,t){var n,r=i.defaultZone;void 0===e._z&&(r&&C(e)&&!e._isUTC&&(e._d=i.utc(e._a)._d,e.utc().add(r.parse(e),"minutes")),e._z=r),e._z&&(r=e._z.utcOffset(e),Math.abs(r)<16&&(r/=60),void 0!==e.utcOffset?(n=e._z,e.utcOffset(-r,t),e._z=n):e.zone(r,t))},e.tz=function(e,t){if(e){if("string"!=typeof e)throw new Error("Time zone name must be a string, got "+e+" ["+typeof e+"]");return this._z=f(e),this._z&&i.updateOffset(this,t),this}if(this._z)return this._z.name},e.zoneName=P(e.zoneName),e.zoneAbbr=P(e.zoneAbbr),e.utc=M(e.utc),e.local=M(e.local),e.utcOffset=(x=e.utcOffset,function(){return 0<arguments.length&&(this._z=null),x.apply(this,arguments)}),i.tz.setDefault=function(e){return(n<2||2==n&&r<9)&&i.version,i.defaultZone=e?f(e):null,i};e=i.momentProperties;return"[object Array]"===Object.prototype.toString.call(e)?(e.push("_z"),e.push("_a")):e&&(e._z=null),k({version:"2019a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|01010|1M2m0 gL0 e10 mn0|15e6","Africa/Casablanca|+00 +01|0 -10|01010101010101010101010101010101|1LHC0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Khartoum|EAT CAT|-30 -20|01|1Usl0|51e5","Africa/Sao_Tome|GMT WAT|0 -10|010|1UQN0 2q00","Africa/Tripoli|EET|-20|0||11e5","Africa/Windhoek|CAT WAT|-20 -10|010101010|1LKo0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1Lzo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1Lzn0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1LEP0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1LKw0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|20e6","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1Lzl0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01010101010101010101010|1LqP0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|77e4","America/Cancun|CST CDT EST|60 50 50|0102|1LKw0 1lb0 Dd0|63e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1Lzk0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1LKx0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1Lzm0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1Lzj0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Fort_Nelson|PST PDT MST|80 70 70|0102|1Lzm0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1Lzi0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|17e3","America/Grand_Turk|EST EDT AST|50 40 40|0101210101010101010|1Lzj0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1Lzh0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|PST AKST AKDT|80 90 80|012121201212121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1Lzh0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Montevideo|-02 -03|20 30|0101|1Lzg0 1o10 11z0|17e5","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1Lzj0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|01010|1LSP0 Rd0 46n0 Ap0|40","America/Santiago|-03 -04|30 40|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|62e5","America/Sao_Paulo|-02 -03|20 30|01010101010101010101010|1LqO0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1Lzhu 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+08 +11|-80 -b0|010|1RWg0 3m10|10","Asia/Bangkok|+07|-70|0||15e6","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Guadalcanal|+11|-b0|0||11e4","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Baku|+04 +05|-40 -50|01010|1LHA0 1o00 11A0 1o00|27e5","Asia/Barnaul|+07 +06|-70 -60|010|1N7v0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1LHy0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|22e5","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+10 +08 +09|-a0 -80 -90|012|1N7s0 3re0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|01010|1O8G0 1cJ0 1cP0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|26e5","Asia/Dili|+09|-90|0||19e4","Asia/Dubai|+04|-40|0||39e5","Asia/Famagusta|EET EEST +03|-20 -30 -30|0101012010101010101010|1LHB0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1LGK0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|01010|1O8H0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|+09 +08|-90 -80|01|1N7t0|60e4","Europe/Istanbul|EET EEST +03|-20 -30 -30|0101012|1LI10 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1LGM0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Yakutsk|+10 +09|-a0 -90|01|1N7s0|28e4","Asia/Krasnoyarsk|+08 +07|-80 -70|01|1N7u0|10e5","Asia/Magadan|+12 +10 +11|-c0 -a0 -b0|012|1N7q0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|35e5","Asia/Novosibirsk|+07 +06|-70 -60|010|1N7v0 4eN0|15e5","Asia/Omsk|+07 +06|-70 -60|01|1N7v0|12e5","Asia/Pyongyang|KST KST|-90 -8u|010|1P4D0 6BA0|29e5","Asia/Qyzylorda|+06 +05|-60 -50|01|1Xei0|73e4","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+11 +10|-b0 -a0|010|1N7r0 3rd0|58e4","Asia/Seoul|KST|-90|0||23e6","Asia/Srednekolymsk|+12 +11|-c0 -b0|01|1N7q0|35e2","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1LEku 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+07 +06|-70 -60|010|1N7v0 3Qp0|10e5","Asia/Vladivostok|+11 +10|-b0 -a0|01|1N7r0|60e4","Asia/Yekaterinburg|+06 +05|-60 -50|01|1N7w0|14e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1LKg0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1LKgu 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1LKf0 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|12e5","Etc/GMT-1|+01|-10|0|","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0|","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0|","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0|","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0|","Europe/Ulyanovsk|+04 +03|-40 -30|010|1N7y0 3rd0|13e5","Europe/London|GMT BST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1LHA0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|67e4","Europe/Kaliningrad|+03 EET|-30 -20|01|1N7z0|44e4","Europe/Kirov|+04 +03|-40 -30|01|1N7y0|48e4","Europe/Moscow|MSK MSK|-40 -30|01|1N7y0|16e6","Europe/Saratov|+04 +03|-40 -30|010|1N7y0 5810","Europe/Simferopol|EET MSK MSK|-20 -40 -30|012|1LHA0 1nW0|33e4","Europe/Volgograd|+04 +03|-40 -30|010|1N7y0 9Jd0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|37e3","Pacific/Bougainville|+10 +11|-a0 -b0|01|1NwE0|18e4","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Lfp0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+1130 +11|-bu -b0|01|1PoCu|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|010|1S4d0 s00|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Juba","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Araguaina","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Bahia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Eirunepe","America/Lima|America/Guayaquil","America/Lima|America/Porto_Acre","America/Lima|America/Rio_Branco","America/Lima|Brazil/Acre","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Antarctica/Davis","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Qostanay","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dili|Etc/GMT-9","Asia/Dili|Pacific/Palau","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Asia/Ust-Nera","Asia/Yakutsk|Asia/Khandyga","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Ulyanovsk|Europe/Astrakhan","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guadalcanal|Antarctica/Macquarie","Pacific/Guadalcanal|Etc/GMT-11","Pacific/Guadalcanal|Pacific/Efate","Pacific/Guadalcanal|Pacific/Kosrae","Pacific/Guadalcanal|Pacific/Noumea","Pacific/Guadalcanal|Pacific/Pohnpei","Pacific/Guadalcanal|Pacific/Ponape","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Port_Moresby|Antarctica/DumontDUrville","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"]}),i})},{moment:void 0}],2:[function(e,t,n){!function(u,l,d,o){"use strict";var r,a=l.Slick||{};r=0,(a=function(e,t){var n=this;n.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:u(e),appendDots:u(e),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return u('<button type="button" data-role="none" role="button" tabindex="0" />').text(t+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},n.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},u.extend(n,n.initials),n.activeBreakpoint=null,n.animType=null,n.animProp=null,n.breakpoints=[],n.breakpointSettings=[],n.cssTransitions=!1,n.focussed=!1,n.interrupted=!1,n.hidden="hidden",n.paused=!0,n.positionProp=null,n.respondTo=null,n.rowCount=1,n.shouldClick=!0,n.$slider=u(e),n.$slidesCache=null,n.transformType=null,n.transitionType=null,n.visibilityChange="visibilitychange",n.windowWidth=0,n.windowTimer=null,e=u(e).data("slick")||{},n.options=u.extend({},n.defaults,t,e),n.currentSlide=n.options.initialSlide,n.originalSettings=n.options,void 0!==d.mozHidden?(n.hidden="mozHidden",n.visibilityChange="mozvisibilitychange"):void 0!==d.webkitHidden&&(n.hidden="webkitHidden",n.visibilityChange="webkitvisibilitychange"),n.autoPlay=u.proxy(n.autoPlay,n),n.autoPlayClear=u.proxy(n.autoPlayClear,n),n.autoPlayIterator=u.proxy(n.autoPlayIterator,n),n.changeSlide=u.proxy(n.changeSlide,n),n.clickHandler=u.proxy(n.clickHandler,n),n.selectHandler=u.proxy(n.selectHandler,n),n.setPosition=u.proxy(n.setPosition,n),n.swipeHandler=u.proxy(n.swipeHandler,n),n.dragHandler=u.proxy(n.dragHandler,n),n.keyHandler=u.proxy(n.keyHandler,n),n.instanceUid=r++,n.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,n.registerBreakpoints(),n.init(!0)}).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},a.prototype.addSlide=a.prototype.slickAdd=function(e,t,n){var r=this;if("boolean"==typeof t)n=t,t=null;else if(t<0||t>=r.slideCount)return!1;r.unload(),"number"==typeof t?0===t&&0===r.$slides.length?u(e).appendTo(r.$slideTrack):n?u(e).insertBefore(r.$slides.eq(t)):u(e).insertAfter(r.$slides.eq(t)):!0===n?u(e).prependTo(r.$slideTrack):u(e).appendTo(r.$slideTrack),r.$slides=r.$slideTrack.children(this.options.slide),r.$slideTrack.children(this.options.slide).detach(),r.$slideTrack.append(r.$slides),r.$slides.each(function(e,t){u(t).attr("data-slick-index",e)}),r.$slidesCache=r.$slides,r.reinit()},a.prototype.animateHeight=function(){var e,t=this;1===t.options.slidesToShow&&!0===t.options.adaptiveHeight&&!1===t.options.vertical&&(e=t.$slides.eq(t.currentSlide).outerHeight(!0),t.$list.animate({height:e},t.options.speed))},a.prototype.animateSlide=function(e,t){var n={},r=this;r.animateHeight(),!0===r.options.rtl&&!1===r.options.vertical&&(e=-e),!1===r.transformsEnabled?!1===r.options.vertical?r.$slideTrack.animate({left:e},r.options.speed,r.options.easing,t):r.$slideTrack.animate({top:e},r.options.speed,r.options.easing,t):!1===r.cssTransitions?(!0===r.options.rtl&&(r.currentLeft=-r.currentLeft),u({animStart:r.currentLeft}).animate({animStart:e},{duration:r.options.speed,easing:r.options.easing,step:function(e){e=Math.ceil(e),!1===r.options.vertical?n[r.animType]="translate("+e+"px, 0px)":n[r.animType]="translate(0px,"+e+"px)",r.$slideTrack.css(n)},complete:function(){t&&t.call()}})):(r.applyTransition(),e=Math.ceil(e),!1===r.options.vertical?n[r.animType]="translate3d("+e+"px, 0px, 0px)":n[r.animType]="translate3d(0px,"+e+"px, 0px)",r.$slideTrack.css(n),t&&setTimeout(function(){r.disableTransition(),t.call()},r.options.speed))},a.prototype.getNavTarget=function(){var e=this.options.asNavFor;return e=e&&null!==e?u(e).not(this.$slider):e},a.prototype.asNavFor=function(t){var e=this.getNavTarget();null!==e&&"object"==typeof e&&e.each(function(){var e=u(this).slick("getSlick");e.unslicked||e.slideHandler(t,!0)})},a.prototype.applyTransition=function(e){var t=this,n={};!1===t.options.fade?n[t.transitionType]=t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:n[t.transitionType]="opacity "+t.options.speed+"ms "+t.options.cssEase,(!1===t.options.fade?t.$slideTrack:t.$slides.eq(e)).css(n)},a.prototype.autoPlay=function(){var e=this;e.autoPlayClear(),e.slideCount>e.options.slidesToShow&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},a.prototype.autoPlayClear=function(){this.autoPlayTimer&&clearInterval(this.autoPlayTimer)},a.prototype.autoPlayIterator=function(){var e=this,t=e.currentSlide+e.options.slidesToScroll;e.paused||e.interrupted||e.focussed||(!1===e.options.infinite&&(1===e.direction&&e.currentSlide+1===e.slideCount-1?e.direction=0:0===e.direction&&(t=e.currentSlide-e.options.slidesToScroll,e.currentSlide-1==0&&(e.direction=1))),e.slideHandler(t))},a.prototype.buildArrows=function(){var e=this;!0===e.options.arrows&&(e.$prevArrow=u(e.options.prevArrow).addClass("slick-arrow"),e.$nextArrow=u(e.options.nextArrow).addClass("slick-arrow"),e.slideCount>e.options.slidesToShow?(e.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.prependTo(e.options.appendArrows),e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.appendTo(e.options.appendArrows),!0!==e.options.infinite&&e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):e.$prevArrow.add(e.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},a.prototype.buildDots=function(){var e,t,n=this;if(!0===n.options.dots&&n.slideCount>n.options.slidesToShow){for(n.$slider.addClass("slick-dotted"),t=u("<ul />").addClass(n.options.dotsClass),e=0;e<=n.getDotCount();e+=1)t.append(u("<li />").append(n.options.customPaging.call(this,n,e)));n.$dots=t.appendTo(n.options.appendDots),n.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},a.prototype.buildOut=function(){var e=this;e.$slides=e.$slider.children(e.options.slide+":not(.slick-cloned)").addClass("slick-slide"),e.slideCount=e.$slides.length,e.$slides.each(function(e,t){u(t).attr("data-slick-index",e).data("originalStyling",u(t).attr("style")||"")}),e.$slider.addClass("slick-slider"),e.$slideTrack=0===e.slideCount?u('<div class="slick-track"/>').appendTo(e.$slider):e.$slides.wrapAll('<div class="slick-track"/>').parent(),e.$list=e.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),e.$slideTrack.css("opacity",0),!0!==e.options.centerMode&&!0!==e.options.swipeToSlide||(e.options.slidesToScroll=1),u("img[data-lazy]",e.$slider).not("[src]").addClass("slick-loading"),e.setupInfinite(),e.buildArrows(),e.buildDots(),e.updateDots(),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),!0===e.options.draggable&&e.$list.addClass("draggable")},a.prototype.buildRows=function(){var e,t,n,r=this,i=d.createDocumentFragment(),o=r.$slider.children();if(1<r.options.rows){for(n=r.options.slidesPerRow*r.options.rows,t=Math.ceil(o.length/n),e=0;e<t;e++){for(var a=d.createElement("div"),s=0;s<r.options.rows;s++){for(var c=d.createElement("div"),u=0;u<r.options.slidesPerRow;u++){var l=e*n+(s*r.options.slidesPerRow+u);o.get(l)&&c.appendChild(o.get(l))}a.appendChild(c)}i.appendChild(a)}r.$slider.empty().append(i),r.$slider.children().children().children().css({width:100/r.options.slidesPerRow+"%",display:"inline-block"})}},a.prototype.checkResponsive=function(e,t){var n,r,i,o=this,a=!1,s=o.$slider.width(),c=l.innerWidth||u(l).width();if("window"===o.respondTo?i=c:"slider"===o.respondTo?i=s:"min"===o.respondTo&&(i=Math.min(c,s)),o.options.responsive&&o.options.responsive.length&&null!==o.options.responsive){for(n in r=null,o.breakpoints)o.breakpoints.hasOwnProperty(n)&&(!1===o.originalSettings.mobileFirst?i<o.breakpoints[n]&&(r=o.breakpoints[n]):i>o.breakpoints[n]&&(r=o.breakpoints[n]));null!==r?null!==o.activeBreakpoint&&r===o.activeBreakpoint&&!t||(o.activeBreakpoint=r,"unslick"===o.breakpointSettings[r]?o.unslick(r):(o.options=u.extend({},o.originalSettings,o.breakpointSettings[r]),!0===e&&(o.currentSlide=o.options.initialSlide),o.refresh(e)),a=r):null!==o.activeBreakpoint&&(o.activeBreakpoint=null,o.options=o.originalSettings,!0===e&&(o.currentSlide=o.options.initialSlide),o.refresh(e),a=r),e||!1===a||o.$slider.trigger("breakpoint",[o,a])}},a.prototype.changeSlide=function(e,t){var n,r=this,i=u(e.currentTarget);switch(i.is("a")&&e.preventDefault(),i.is("li")||(i=i.closest("li")),n=r.slideCount%r.options.slidesToScroll!=0?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,e.data.message){case"previous":o=0==n?r.options.slidesToScroll:r.options.slidesToShow-n,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-o,!1,t);break;case"next":o=0==n?r.options.slidesToScroll:n,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+o,!1,t);break;case"index":var o=0===e.data.index?0:e.data.index||i.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(o),!1,t),i.children().trigger("focus");break;default:return}},a.prototype.checkNavigable=function(e){var t=this.getNavigableIndexes(),n=0;if(e>t[t.length-1])e=t[t.length-1];else for(var r in t){if(e<t[r]){e=n;break}n=t[r]}return e},a.prototype.cleanUpEvents=function(){var e=this;e.options.dots&&null!==e.$dots&&u("li",e.$dots).off("click.slick",e.changeSlide).off("mouseenter.slick",u.proxy(e.interrupt,e,!0)).off("mouseleave.slick",u.proxy(e.interrupt,e,!1)),e.$slider.off("focus.slick blur.slick"),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow&&e.$prevArrow.off("click.slick",e.changeSlide),e.$nextArrow&&e.$nextArrow.off("click.slick",e.changeSlide)),e.$list.off("touchstart.slick mousedown.slick",e.swipeHandler),e.$list.off("touchmove.slick mousemove.slick",e.swipeHandler),e.$list.off("touchend.slick mouseup.slick",e.swipeHandler),e.$list.off("touchcancel.slick mouseleave.slick",e.swipeHandler),e.$list.off("click.slick",e.clickHandler),u(d).off(e.visibilityChange,e.visibility),e.cleanUpSlideEvents(),!0===e.options.accessibility&&e.$list.off("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().off("click.slick",e.selectHandler),u(l).off("orientationchange.slick.slick-"+e.instanceUid,e.orientationChange),u(l).off("resize.slick.slick-"+e.instanceUid,e.resize),u("[draggable!=true]",e.$slideTrack).off("dragstart",e.preventDefault),u(l).off("load.slick.slick-"+e.instanceUid,e.setPosition),u(d).off("ready.slick.slick-"+e.instanceUid,e.setPosition)},a.prototype.cleanUpSlideEvents=function(){var e=this;e.$list.off("mouseenter.slick",u.proxy(e.interrupt,e,!0)),e.$list.off("mouseleave.slick",u.proxy(e.interrupt,e,!1))},a.prototype.cleanUpRows=function(){var e;1<this.options.rows&&((e=this.$slides.children().children()).removeAttr("style"),this.$slider.empty().append(e))},a.prototype.clickHandler=function(e){!1===this.shouldClick&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},a.prototype.destroy=function(e){var t=this;t.autoPlayClear(),t.touchObject={},t.cleanUpEvents(),u(".slick-cloned",t.$slider).detach(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.$prevArrow.length&&(t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove()),t.$nextArrow&&t.$nextArrow.length&&(t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove()),t.$slides&&(t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){u(this).attr("style",u(this).data("originalStyling"))}),t.$slideTrack.children(this.options.slide).detach(),t.$slideTrack.detach(),t.$list.detach(),t.$slider.append(t.$slides)),t.cleanUpRows(),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$slider.removeClass("slick-dotted"),t.unslicked=!0,e||t.$slider.trigger("destroy",[t])},a.prototype.disableTransition=function(e){var t={};t[this.transitionType]="",(!1===this.options.fade?this.$slideTrack:this.$slides.eq(e)).css(t)},a.prototype.fadeSlide=function(e,t){var n=this;!1===n.cssTransitions?(n.$slides.eq(e).css({zIndex:n.options.zIndex}),n.$slides.eq(e).animate({opacity:1},n.options.speed,n.options.easing,t)):(n.applyTransition(e),n.$slides.eq(e).css({opacity:1,zIndex:n.options.zIndex}),t&&setTimeout(function(){n.disableTransition(e),t.call()},n.options.speed))},a.prototype.fadeSlideOut=function(e){var t=this;!1===t.cssTransitions?t.$slides.eq(e).animate({opacity:0,zIndex:t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(e),t.$slides.eq(e).css({opacity:0,zIndex:t.options.zIndex-2}))},a.prototype.filterSlides=a.prototype.slickFilter=function(e){var t=this;null!==e&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},a.prototype.focusHandler=function(){var n=this;n.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(e){e.stopImmediatePropagation();var t=u(this);setTimeout(function(){n.options.pauseOnFocus&&(n.focussed=t.is(":focus"),n.autoPlay())},0)})},a.prototype.getCurrent=a.prototype.slickCurrentSlide=function(){return this.currentSlide},a.prototype.getDotCount=function(){var e=this,t=0,n=0,r=0;if(!0===e.options.infinite)for(;t<e.slideCount;)++r,t=n+e.options.slidesToScroll,n+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else if(!0===e.options.centerMode)r=e.slideCount;else if(e.options.asNavFor)for(;t<e.slideCount;)++r,t=n+e.options.slidesToScroll,n+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else r=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll);return r-1},a.prototype.getLeft=function(e){var t,n=this,r=0;return n.slideOffset=0,t=n.$slides.first().outerHeight(!0),!0===n.options.infinite?(n.slideCount>n.options.slidesToShow&&(n.slideOffset=n.slideWidth*n.options.slidesToShow*-1,r=t*n.options.slidesToShow*-1),n.slideCount%n.options.slidesToScroll!=0&&e+n.options.slidesToScroll>n.slideCount&&n.slideCount>n.options.slidesToShow&&(r=e>n.slideCount?(n.slideOffset=(n.options.slidesToShow-(e-n.slideCount))*n.slideWidth*-1,(n.options.slidesToShow-(e-n.slideCount))*t*-1):(n.slideOffset=n.slideCount%n.options.slidesToScroll*n.slideWidth*-1,n.slideCount%n.options.slidesToScroll*t*-1))):e+n.options.slidesToShow>n.slideCount&&(n.slideOffset=(e+n.options.slidesToShow-n.slideCount)*n.slideWidth,r=(e+n.options.slidesToShow-n.slideCount)*t),n.slideCount<=n.options.slidesToShow&&(r=n.slideOffset=0),!0===n.options.centerMode&&!0===n.options.infinite?n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)-n.slideWidth:!0===n.options.centerMode&&(n.slideOffset=0,n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)),t=!1===n.options.vertical?e*n.slideWidth*-1+n.slideOffset:e*t*-1+r,!0===n.options.variableWidth&&(r=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(e):n.$slideTrack.children(".slick-slide").eq(e+n.options.slidesToShow),t=!0===n.options.rtl?r[0]?-1*(n.$slideTrack.width()-r[0].offsetLeft-r.width()):0:r[0]?-1*r[0].offsetLeft:0,!0===n.options.centerMode&&(r=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(e):n.$slideTrack.children(".slick-slide").eq(e+n.options.slidesToShow+1),t=!0===n.options.rtl?r[0]?-1*(n.$slideTrack.width()-r[0].offsetLeft-r.width()):0:r[0]?-1*r[0].offsetLeft:0,t+=(n.$list.width()-r.outerWidth())/2)),t},a.prototype.getOption=a.prototype.slickGetOption=function(e){return this.options[e]},a.prototype.getNavigableIndexes=function(){for(var e=this,t=0,n=0,r=[],i=!1===e.options.infinite?e.slideCount:(t=-1*e.options.slidesToScroll,n=-1*e.options.slidesToScroll,2*e.slideCount);t<i;)r.push(t),t=n+e.options.slidesToScroll,n+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;return r},a.prototype.getSlick=function(){return this},a.prototype.getSlideCount=function(){var n,r=this,i=!0===r.options.centerMode?r.slideWidth*Math.floor(r.options.slidesToShow/2):0;return!0===r.options.swipeToSlide?(r.$slideTrack.find(".slick-slide").each(function(e,t){if(t.offsetLeft-i+u(t).outerWidth()/2>-1*r.swipeLeft)return n=t,!1}),Math.abs(u(n).attr("data-slick-index")-r.currentSlide)||1):r.options.slidesToScroll},a.prototype.goTo=a.prototype.slickGoTo=function(e,t){this.changeSlide({data:{message:"index",index:parseInt(e)}},t)},a.prototype.init=function(e){var t=this;u(t.$slider).hasClass("slick-initialized")||(u(t.$slider).addClass("slick-initialized"),t.buildRows(),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots(),t.checkResponsive(!0),t.focusHandler()),e&&t.$slider.trigger("init",[t]),!0===t.options.accessibility&&t.initADA(),t.options.autoplay&&(t.paused=!1,t.autoPlay())},a.prototype.initADA=function(){var t=this;t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),t.$slideTrack.attr("role","listbox"),t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(e){u(this).attr({role:"option","aria-describedby":"slick-slide"+t.instanceUid+e})}),null!==t.$dots&&t.$dots.attr("role","tablist").find("li").each(function(e){u(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+t.instanceUid+e,id:"slick-slide"+t.instanceUid+e})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),t.activateADA()},a.prototype.initArrowEvents=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},e.changeSlide),e.$nextArrow.off("click.slick").on("click.slick",{message:"next"},e.changeSlide))},a.prototype.initDotEvents=function(){var e=this;!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&u("li",e.$dots).on("click.slick",{message:"index"},e.changeSlide),!0===e.options.dots&&!0===e.options.pauseOnDotsHover&&u("li",e.$dots).on("mouseenter.slick",u.proxy(e.interrupt,e,!0)).on("mouseleave.slick",u.proxy(e.interrupt,e,!1))},a.prototype.initSlideEvents=function(){var e=this;e.options.pauseOnHover&&(e.$list.on("mouseenter.slick",u.proxy(e.interrupt,e,!0)),e.$list.on("mouseleave.slick",u.proxy(e.interrupt,e,!1)))},a.prototype.initializeEvents=function(){var e=this;e.initArrowEvents(),e.initDotEvents(),e.initSlideEvents(),e.$list.on("touchstart.slick mousedown.slick",{action:"start"},e.swipeHandler),e.$list.on("touchmove.slick mousemove.slick",{action:"move"},e.swipeHandler),e.$list.on("touchend.slick mouseup.slick",{action:"end"},e.swipeHandler),e.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},e.swipeHandler),e.$list.on("click.slick",e.clickHandler),u(d).on(e.visibilityChange,u.proxy(e.visibility,e)),!0===e.options.accessibility&&e.$list.on("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().on("click.slick",e.selectHandler),u(l).on("orientationchange.slick.slick-"+e.instanceUid,u.proxy(e.orientationChange,e)),u(l).on("resize.slick.slick-"+e.instanceUid,u.proxy(e.resize,e)),u("[draggable!=true]",e.$slideTrack).on("dragstart",e.preventDefault),u(l).on("load.slick.slick-"+e.instanceUid,e.setPosition),u(d).on("ready.slick.slick-"+e.instanceUid,e.setPosition)},a.prototype.initUI=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.show()},a.prototype.keyHandler=function(e){var t=this;e.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===e.keyCode&&!0===t.options.accessibility?t.changeSlide({data:{message:!0===t.options.rtl?"next":"previous"}}):39===e.keyCode&&!0===t.options.accessibility&&t.changeSlide({data:{message:!0===t.options.rtl?"previous":"next"}}))},a.prototype.lazyLoad=function(){var e,t,r=this;function n(e){u("img[data-lazy]",e).each(function(){var e=u(this),t=u(this).attr("data-lazy"),n=d.createElement("img");n.onload=function(){e.animate({opacity:0},100,function(){e.attr("src",t).animate({opacity:1},200,function(){e.removeAttr("data-lazy").removeClass("slick-loading")}),r.$slider.trigger("lazyLoaded",[r,e,t])})},n.onerror=function(){e.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),r.$slider.trigger("lazyLoadError",[r,e,t])},n.src=t})}!0===r.options.centerMode?t=!0===r.options.infinite?(e=r.currentSlide+(r.options.slidesToShow/2+1))+r.options.slidesToShow+2:(e=Math.max(0,r.currentSlide-(r.options.slidesToShow/2+1)),r.options.slidesToShow/2+1+2+r.currentSlide):(e=r.options.infinite?r.options.slidesToShow+r.currentSlide:r.currentSlide,t=Math.ceil(e+r.options.slidesToShow),!0===r.options.fade&&(0<e&&e--,t<=r.slideCount&&t++)),n(r.$slider.find(".slick-slide").slice(e,t)),r.slideCount<=r.options.slidesToShow?n(r.$slider.find(".slick-slide")):r.currentSlide>=r.slideCount-r.options.slidesToShow?n(r.$slider.find(".slick-cloned").slice(0,r.options.slidesToShow)):0===r.currentSlide&&n(r.$slider.find(".slick-cloned").slice(-1*r.options.slidesToShow))},a.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({opacity:1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},a.prototype.next=a.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},a.prototype.orientationChange=function(){this.checkResponsive(),this.setPosition()},a.prototype.pause=a.prototype.slickPause=function(){this.autoPlayClear(),this.paused=!0},a.prototype.play=a.prototype.slickPlay=function(){var e=this;e.autoPlay(),e.options.autoplay=!0,e.paused=!1,e.focussed=!1,e.interrupted=!1},a.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&t.initADA())},a.prototype.prev=a.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},a.prototype.preventDefault=function(e){e.preventDefault()},a.prototype.progressiveLazyLoad=function(e){e=e||1;var t,n,r=this,i=u("img[data-lazy]",r.$slider);i.length?(t=i.first(),n=t.attr("data-lazy"),(i=d.createElement("img")).onload=function(){t.attr("src",n).removeAttr("data-lazy").removeClass("slick-loading"),!0===r.options.adaptiveHeight&&r.setPosition(),r.$slider.trigger("lazyLoaded",[r,t,n]),r.progressiveLazyLoad()},i.onerror=function(){e<3?setTimeout(function(){r.progressiveLazyLoad(e+1)},500):(t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),r.$slider.trigger("lazyLoadError",[r,t,n]),r.progressiveLazyLoad())},i.src=n):r.$slider.trigger("allImagesLoaded",[r])},a.prototype.refresh=function(e){var t=this,n=t.slideCount-t.options.slidesToShow;!t.options.infinite&&t.currentSlide>n&&(t.currentSlide=n),t.slideCount<=t.options.slidesToShow&&(t.currentSlide=0),n=t.currentSlide,t.destroy(!0),u.extend(t,t.initials,{currentSlide:n}),t.init(),e||t.changeSlide({data:{message:"index",index:n}},!1)},a.prototype.registerBreakpoints=function(){var e,t,n,r=this,i=r.options.responsive||null;if("array"===u.type(i)&&i.length){for(e in r.respondTo=r.options.respondTo||"window",i)if(n=r.breakpoints.length-1,t=i[e].breakpoint,i.hasOwnProperty(e)){for(;0<=n;)r.breakpoints[n]&&r.breakpoints[n]===t&&r.breakpoints.splice(n,1),n--;r.breakpoints.push(t),r.breakpointSettings[t]=i[e].settings}r.breakpoints.sort(function(e,t){return r.options.mobileFirst?e-t:t-e})}},a.prototype.reinit=function(){var e=this;e.$slides=e.$slideTrack.children(e.options.slide).addClass("slick-slide"),e.slideCount=e.$slides.length,e.currentSlide>=e.slideCount&&0!==e.currentSlide&&(e.currentSlide=e.currentSlide-e.options.slidesToScroll),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),e.registerBreakpoints(),e.setProps(),e.setupInfinite(),e.buildArrows(),e.updateArrows(),e.initArrowEvents(),e.buildDots(),e.updateDots(),e.initDotEvents(),e.cleanUpSlideEvents(),e.initSlideEvents(),e.checkResponsive(!1,!0),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().on("click.slick",e.selectHandler),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),e.setPosition(),e.focusHandler(),e.paused=!e.options.autoplay,e.autoPlay(),e.$slider.trigger("reInit",[e])},a.prototype.resize=function(){var e=this;u(l).width()!==e.windowWidth&&(clearTimeout(e.windowDelay),e.windowDelay=l.setTimeout(function(){e.windowWidth=u(l).width(),e.checkResponsive(),e.unslicked||e.setPosition()},50))},a.prototype.removeSlide=a.prototype.slickRemove=function(e,t,n){var r=this;if(e="boolean"==typeof e?!0===(t=e)?0:r.slideCount-1:!0===t?--e:e,r.slideCount<1||e<0||e>r.slideCount-1)return!1;r.unload(),(!0===n?r.$slideTrack.children():r.$slideTrack.children(this.options.slide).eq(e)).remove(),r.$slides=r.$slideTrack.children(this.options.slide),r.$slideTrack.children(this.options.slide).detach(),r.$slideTrack.append(r.$slides),r.$slidesCache=r.$slides,r.reinit()},a.prototype.setCSS=function(e){var t,n,r=this,i={};!0===r.options.rtl&&(e=-e),t="left"==r.positionProp?Math.ceil(e)+"px":"0px",n="top"==r.positionProp?Math.ceil(e)+"px":"0px",i[r.positionProp]=e,!1===r.transformsEnabled||(!(i={})===r.cssTransitions?i[r.animType]="translate("+t+", "+n+")":i[r.animType]="translate3d("+t+", "+n+", 0px)"),r.$slideTrack.css(i)},a.prototype.setDimensions=function(){var e=this,t=(!1===e.options.vertical?!0===e.options.centerMode&&e.$list.css({padding:"0px "+e.options.centerPadding}):(e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow),!0===e.options.centerMode&&e.$list.css({padding:e.options.centerPadding+" 0px"})),e.listWidth=e.$list.width(),e.listHeight=e.$list.height(),!1===e.options.vertical&&!1===e.options.variableWidth?(e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow),e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))):!0===e.options.variableWidth?e.$slideTrack.width(5e3*e.slideCount):(e.slideWidth=Math.ceil(e.listWidth),e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length))),e.$slides.first().outerWidth(!0)-e.$slides.first().width());!1===e.options.variableWidth&&e.$slideTrack.children(".slick-slide").width(e.slideWidth-t)},a.prototype.setFade=function(){var n,r=this;r.$slides.each(function(e,t){n=r.slideWidth*e*-1,!0===r.options.rtl?u(t).css({position:"relative",right:n,top:0,zIndex:r.options.zIndex-2,opacity:0}):u(t).css({position:"relative",left:n,top:0,zIndex:r.options.zIndex-2,opacity:0})}),r.$slides.eq(r.currentSlide).css({zIndex:r.options.zIndex-1,opacity:1})},a.prototype.setHeight=function(){var e,t=this;1===t.options.slidesToShow&&!0===t.options.adaptiveHeight&&!1===t.options.vertical&&(e=t.$slides.eq(t.currentSlide).outerHeight(!0),t.$list.css("height",e))},a.prototype.setOption=a.prototype.slickSetOption=function(){var e,t,n,r,i,o=this,a=!1;if("object"===u.type(arguments[0])?(n=arguments[0],a=arguments[1],i="multiple"):"string"===u.type(arguments[0])&&(n=arguments[0],r=arguments[1],a=arguments[2],"responsive"===arguments[0]&&"array"===u.type(arguments[1])?i="responsive":void 0!==arguments[1]&&(i="single")),"single"===i)o.options[n]=r;else if("multiple"===i)u.each(n,function(e,t){o.options[e]=t});else if("responsive"===i)for(t in r)if("array"!==u.type(o.options.responsive))o.options.responsive=[r[t]];else{for(e=o.options.responsive.length-1;0<=e;)o.options.responsive[e].breakpoint===r[t].breakpoint&&o.options.responsive.splice(e,1),e--;o.options.responsive.push(r[t])}a&&(o.unload(),o.reinit())},a.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),!1===e.options.fade?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),e.$slider.trigger("setPosition",[e])},a.prototype.setProps=function(){var e=this,t=d.body.style;e.positionProp=!0===e.options.vertical?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),t.WebkitTransition===o&&t.MozTransition===o&&t.msTransition===o||!0===e.options.useCSS&&(e.cssTransitions=!0),e.options.fade&&("number"==typeof e.options.zIndex?e.options.zIndex<3&&(e.options.zIndex=3):e.options.zIndex=e.defaults.zIndex),t.OTransform!==o&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",t.perspectiveProperty===o&&t.webkitPerspective===o&&(e.animType=!1)),t.MozTransform!==o&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",t.perspectiveProperty===o&&t.MozPerspective===o&&(e.animType=!1)),t.webkitTransform!==o&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",t.perspectiveProperty===o&&t.webkitPerspective===o&&(e.animType=!1)),t.msTransform!==o&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",t.msTransform===o&&(e.animType=!1)),t.transform!==o&&!1!==e.animType&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType},a.prototype.setSlideClasses=function(e){var t,n,r=this,i=r.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true");r.$slides.eq(e).addClass("slick-current"),!0===r.options.centerMode?(n=Math.floor(r.options.slidesToShow/2),!0===r.options.infinite&&(n<=e&&e<=r.slideCount-1-n?r.$slides.slice(e-n,e+n+1).addClass("slick-active").attr("aria-hidden","false"):(t=r.options.slidesToShow+e,i.slice(t-n+1,t+n+2).addClass("slick-active").attr("aria-hidden","false")),0===e?i.eq(i.length-1-r.options.slidesToShow).addClass("slick-center"):e===r.slideCount-1&&i.eq(r.options.slidesToShow).addClass("slick-center")),r.$slides.eq(e).addClass("slick-center")):0<=e&&e<=r.slideCount-r.options.slidesToShow?r.$slides.slice(e,e+r.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):i.length<=r.options.slidesToShow?i.addClass("slick-active").attr("aria-hidden","false"):(n=r.slideCount%r.options.slidesToShow,t=!0===r.options.infinite?r.options.slidesToShow+e:e,(r.options.slidesToShow==r.options.slidesToScroll&&r.slideCount-e<r.options.slidesToShow?i.slice(t-(r.options.slidesToShow-n),t+n):i.slice(t,t+r.options.slidesToShow)).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===r.options.lazyLoad&&r.lazyLoad()},a.prototype.setupInfinite=function(){var e,t,n,r=this;if(!0===r.options.fade&&(r.options.centerMode=!1),!0===r.options.infinite&&!1===r.options.fade&&(t=null,r.slideCount>r.options.slidesToShow)){for(n=!0===r.options.centerMode?r.options.slidesToShow+1:r.options.slidesToShow,e=r.slideCount;e>r.slideCount-n;--e)u(r.$slides[t=e-1]).clone(!0).attr("id","").attr("data-slick-index",t-r.slideCount).prependTo(r.$slideTrack).addClass("slick-cloned");for(e=0;e<n;e+=1)t=e,u(r.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t+r.slideCount).appendTo(r.$slideTrack).addClass("slick-cloned");r.$slideTrack.find(".slick-cloned").find("[id]").each(function(){u(this).attr("id","")})}},a.prototype.interrupt=function(e){e||this.autoPlay(),this.interrupted=e},a.prototype.selectHandler=function(e){var t=this,e=u(e.target).is(".slick-slide")?u(e.target):u(e.target).parents(".slick-slide"),e=(e=parseInt(e.attr("data-slick-index")))||0;if(t.slideCount<=t.options.slidesToShow)return t.setSlideClasses(e),void t.asNavFor(e);t.slideHandler(e)},a.prototype.slideHandler=function(e,t,n){var r,i,o,a,s=this;if(t=t||!1,(!0!==s.animating||!0!==s.options.waitForAnimate)&&!(!0===s.options.fade&&s.currentSlide===e||s.slideCount<=s.options.slidesToShow))if(!1===t&&s.asNavFor(e),r=e,t=s.getLeft(r),o=s.getLeft(s.currentSlide),s.currentLeft=null===s.swipeLeft?o:s.swipeLeft,!1===s.options.infinite&&!1===s.options.centerMode&&(e<0||e>s.getDotCount()*s.options.slidesToScroll))!1===s.options.fade&&(r=s.currentSlide,!0!==n?s.animateSlide(o,function(){s.postSlide(r)}):s.postSlide(r));else if(!1===s.options.infinite&&!0===s.options.centerMode&&(e<0||e>s.slideCount-s.options.slidesToScroll))!1===s.options.fade&&(r=s.currentSlide,!0!==n?s.animateSlide(o,function(){s.postSlide(r)}):s.postSlide(r));else{if(s.options.autoplay&&clearInterval(s.autoPlayTimer),i=r<0?s.slideCount%s.options.slidesToScroll!=0?s.slideCount-s.slideCount%s.options.slidesToScroll:s.slideCount+r:r>=s.slideCount?s.slideCount%s.options.slidesToScroll!=0?0:r-s.slideCount:r,s.animating=!0,s.$slider.trigger("beforeChange",[s,s.currentSlide,i]),e=s.currentSlide,s.currentSlide=i,s.setSlideClasses(s.currentSlide),s.options.asNavFor&&(a=(a=s.getNavTarget()).slick("getSlick")).slideCount<=a.options.slidesToShow&&a.setSlideClasses(s.currentSlide),s.updateDots(),s.updateArrows(),!0===s.options.fade)return!0!==n?(s.fadeSlideOut(e),s.fadeSlide(i,function(){s.postSlide(i)})):s.postSlide(i),void s.animateHeight();!0!==n?s.animateSlide(t,function(){s.postSlide(i)}):s.postSlide(i)}},a.prototype.startLoad=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},a.prototype.swipeDirection=function(){var e=this,t=e.touchObject.startX-e.touchObject.curX,n=e.touchObject.startY-e.touchObject.curY,n=Math.atan2(n,t),t=Math.round(180*n/Math.PI);return(t=t<0?360-Math.abs(t):t)<=45&&0<=t||t<=360&&315<=t?!1===e.options.rtl?"left":"right":135<=t&&t<=225?!1===e.options.rtl?"right":"left":!0===e.options.verticalSwiping?35<=t&&t<=135?"down":"up":"vertical"},a.prototype.swipeEnd=function(e){var t,n,r=this;if(r.dragging=!1,r.interrupted=!1,r.shouldClick=!(10<r.touchObject.swipeLength),r.touchObject.curX===o)return!1;if(!0===r.touchObject.edgeHit&&r.$slider.trigger("edge",[r,r.swipeDirection()]),r.touchObject.swipeLength>=r.touchObject.minSwipe){switch(n=r.swipeDirection()){case"left":case"down":t=r.options.swipeToSlide?r.checkNavigable(r.currentSlide+r.getSlideCount()):r.currentSlide+r.getSlideCount(),r.currentDirection=0;break;case"right":case"up":t=r.options.swipeToSlide?r.checkNavigable(r.currentSlide-r.getSlideCount()):r.currentSlide-r.getSlideCount(),r.currentDirection=1}"vertical"!=n&&(r.slideHandler(t),r.touchObject={},r.$slider.trigger("swipe",[r,n]))}else r.touchObject.startX!==r.touchObject.curX&&(r.slideHandler(r.currentSlide),r.touchObject={})},a.prototype.swipeHandler=function(e){var t=this;if(!(!1===t.options.swipe||"ontouchend"in d&&!1===t.options.swipe||!1===t.options.draggable&&-1!==e.type.indexOf("mouse")))switch(t.touchObject.fingerCount=e.originalEvent&&e.originalEvent.touches!==o?e.originalEvent.touches.length:1,t.touchObject.minSwipe=t.listWidth/t.options.touchThreshold,!0===t.options.verticalSwiping&&(t.touchObject.minSwipe=t.listHeight/t.options.touchThreshold),e.data.action){case"start":t.swipeStart(e);break;case"move":t.swipeMove(e);break;case"end":t.swipeEnd(e)}},a.prototype.swipeMove=function(e){var t,n,r=this,i=e.originalEvent!==o?e.originalEvent.touches:null;return!(!r.dragging||i&&1!==i.length)&&(t=r.getLeft(r.currentSlide),r.touchObject.curX=i!==o?i[0].pageX:e.clientX,r.touchObject.curY=i!==o?i[0].pageY:e.clientY,r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curX-r.touchObject.startX,2))),!0===r.options.verticalSwiping&&(r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curY-r.touchObject.startY,2)))),"vertical"!==(i=r.swipeDirection())?(e.originalEvent!==o&&4<r.touchObject.swipeLength&&e.preventDefault(),e=(!1===r.options.rtl?1:-1)*(r.touchObject.curX>r.touchObject.startX?1:-1),!0===r.options.verticalSwiping&&(e=r.touchObject.curY>r.touchObject.startY?1:-1),n=r.touchObject.swipeLength,(r.touchObject.edgeHit=!1)===r.options.infinite&&(0===r.currentSlide&&"right"===i||r.currentSlide>=r.getDotCount()&&"left"===i)&&(n=r.touchObject.swipeLength*r.options.edgeFriction,r.touchObject.edgeHit=!0),!1===r.options.vertical?r.swipeLeft=t+n*e:r.swipeLeft=t+n*(r.$list.height()/r.listWidth)*e,!0===r.options.verticalSwiping&&(r.swipeLeft=t+n*e),!0!==r.options.fade&&!1!==r.options.touchMove&&(!0===r.animating?(r.swipeLeft=null,!1):void r.setCSS(r.swipeLeft))):void 0)},a.prototype.swipeStart=function(e){var t,n=this;if(n.interrupted=!0,1!==n.touchObject.fingerCount||n.slideCount<=n.options.slidesToShow)return!(n.touchObject={});e.originalEvent!==o&&e.originalEvent.touches!==o&&(t=e.originalEvent.touches[0]),n.touchObject.startX=n.touchObject.curX=t!==o?t.pageX:e.clientX,n.touchObject.startY=n.touchObject.curY=t!==o?t.pageY:e.clientY,n.dragging=!0},a.prototype.unfilterSlides=a.prototype.slickUnfilter=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},a.prototype.unload=function(){var e=this;u(".slick-cloned",e.$slider).remove(),e.$dots&&e.$dots.remove(),e.$prevArrow&&e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.remove(),e.$nextArrow&&e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.remove(),e.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},a.prototype.unslick=function(e){this.$slider.trigger("unslick",[this,e]),this.destroy()},a.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2);!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite&&(e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===e.currentSlide?(e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):(e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode||e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode)&&(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},a.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},a.prototype.visibility=function(){this.options.autoplay&&(d[this.hidden]?this.interrupted=!0:this.interrupted=!1)},u.fn.slick=function(){for(var e,t=this,n=arguments[0],r=Array.prototype.slice.call(arguments,1),i=t.length,o=0;o<i;o++)if("object"==typeof n||void 0===n?t[o].slick=new a(t[o],n):e=t[o].slick[n].apply(t[o].slick,r),void 0!==e)return e;return t}}(jQuery,window,document)},{}],3:[function(e,t,n){var r,i;r=this,i=function(){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var e=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return{EditableContentHelper:(e(o,[{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"addNodes",value:function(e,t){var n=this.currentDOM.childNodes.length,r=t.childNodes.length,i=r-n+1,o=r-i,a=e.index,e=e.index+i,s=a+n-o,c=this.currentDOM.childNodes[s],u=0;switch(!0){case r<=i:for(;r;){var l=t.childNodes[0],d=this.currentDOM.childNodes[u++];d?this.currentDOM.replaceChild(l,d):this.currentDOM.appendChild(l),r=t.childNodes.length}break;case i<r&&0===a:for(;o<r;){var f=t.childNodes[0],p=this.currentDOM.childNodes[u];p&&u++<s?this.currentDOM.replaceChild(f,p):this.currentDOM.insertBefore(f,c),r=t.childNodes.length}break;case i<r&&e===r:for(u=a;o<r;){var h=t.childNodes[a],m=this.currentDOM.childNodes[u++];m?this.currentDOM.replaceChild(h,m):this.currentDOM.appendChild(h),r=t.childNodes.length}break;case i<r&&0<a&&e<r:for(u=a;o<r;){var g=t.childNodes[a],v=this.currentDOM.childNodes[u];v&&u++<s?this.currentDOM.replaceChild(g,v):this.currentDOM.insertBefore(g,c),r=t.childNodes.length}}}},{key:"compare",value:function(e){var i=this,o=void 0,e=Array.from(e.childNodes).find(function(e,t){e={nodeName:e.nodeName,textContent:e.textContent};if(0===i.currentDOM.childNodes.length)return""!==JSON.stringify(e);var n=i.currentDOM.childNodes[t],r=n.nodeName,n=n.textContent;return o=t,JSON.stringify(e)!==JSON.stringify({nodeName:r,textContent:n})});return!!e&&{element:e,index:o}}},{key:"ensureInputLimit",value:function(e){var t=(e.match(/&nbsp;/gi)||[]).length,t=e.length-6*t+t;t>=this.inputLimit&&(e=e.slice(0,this.inputLimit-t),this.startOffset=this.inputLimit,this.process(e))}},{key:"init",value:function(e){e=(e=e||this.placeholder)||this.innerText(),this.process(e,!0)}},{key:"innerText",value:function(){var e=this.currentDOM.innerHTML;return e.replace(/(<([^>]+)>)/gi,"")}},{key:"process",value:function(e){var t=e,n=(this.filters.forEach(function(e){t=t.replace(e.getCondition(),e.getReplacement())}),(new DOMParser).parseFromString(t,"text/html").getElementsByTagName("body")[0]),r=this.compare(n);if(r){if(this.replace(r,n),-1===this.startOffset)return;this.replaceCursor()}this.inputLimit&&this.ensureInputLimit(e),this.state&&this.tags&&this.setState(e)}},{key:"replace",value:function(e,t){var n=this.currentDOM.childNodes.length,r=t.childNodes.length;switch(!0){case n<r:this.addNodes(e,t);break;case r<n:for(;r<n;){var i=this.currentDOM.childNodes[e.index+1];this.currentDOM.removeChild(i),n=this.currentDOM.childNodes.length}default:var o=e.element.cloneNode(!0),a=this.currentDOM.childNodes[e.index];this.currentDOM.replaceChild(o,a),(e=this.compare(t))&&this.replace(e,t)}}},{key:"setState",value:function(i){var o=this,a=!1;this.tags.forEach(function(e){var t=new RegExp("#"+e,"gi"),t=i.match(t),n=o.state.includes(e);if(null===t||n){if(null===t&&n)for(var r=o.state.indexOf(e);-1!==r;)a=!0,o.state.splice(r,1),r=o.state.indexOf(e)}else o.state.push(e),a=!0}),this.onStateChange&&a&&this.onStateChange(this.state)}},{key:"removeTag",value:function(e){var t=this.innerText(),n=new RegExp("#"+e,"gi"),t=t.replace(n,e);this.process(t)}},{key:"replaceCursor",value:function(){var t,e,n=this,r=void 0;window.getSelection&&(r=window.getSelection(),t=0,(e=Array.from(this.currentDOM.childNodes).find(function(e){return e.textContent.length+t>=n.startOffset||(t+=e.textContent.length,!1)}))&&(e={node:e=e.childNodes&&e.childNodes[0]?e.childNodes[0]:e,offset:this.startOffset-t},this.setCursor(r,e)))}},{key:"saveCursorPosition",value:function(){var e=window.getSelection();if(e)for(var e=e.getRangeAt(0),t=(this.startOffset=e.startOffset,e.startContainer),e=e.startContainer.parentElement,n=(t="true"!==e.contentEditable?e:t).previousSibling;n;)this.startOffset+=n.textContent.length,n=n.previousSibling;else this.startOffset=-1}},{key:"setCursor",value:function(e,t){var n=document.createRange();n.setStart(t.node,t.offset),n.collapse(!0),e.removeAllRanges(),e.addRange(n)}}]),o),echFilter:(e(n,[{key:"getCondition",value:function(){return this.condition}},{key:"getReplacement",value:function(){return this.replacement}}]),n)};function n(e,t){i(this,n),Array.isArray(e)&&(e=RegExp(e.join("|"),"gi")),this.condition=e,this.replacement=t}function o(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=(i(this,o),["tags","onStateChange","inputLimit"]);this.state=[],this.startOffset=-1,this.filters=[],e=e||document.createElement("div"),this.currentDOM=e,this.currentDOM.addEventListener("keyup",function(e){t.saveCursorPosition(),t.process(t.innerText())}),this.clone=this.currentDOM.cloneNode(!0),Object.keys(n).forEach(function(e){r.includes(e)&&(t[e]=n[e])}),this.tags&&this.setState(this.innerText())}},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):r.ECH=i()},{}],4:[function(Is,xs,e){!function(Ts,Cs){!function(){"use strict";var g=(o=Is("crypto"))&&"object"==typeof o&&"default"in o?o.default:o;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}o(d,[{key:"processOrder",value:function(){throw new Error("not implemented")}},{key:"completeOrder",value:function(){throw new Error("not implemented")}}]);var l=d;function d(){i(this,d),this.gatewayService=null,this.log=null,this.orderService=null,this.taxService=null}!function(e){var t,n,a,r,i,l,d,f,p,h;function o(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function m(e){return e="string"!=typeof e?String(e):e}function g(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function s(t){this.map={},t instanceof s?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function v(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function y(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function b(e){var t=new FileReader,n=y(t);return t.readAsArrayBuffer(e),n}function _(e){var t;return e.slice?e.slice(0):((t=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),t.buffer)}function w(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(i&&a&&d(e))this._bodyArrayBuffer=_(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(e)&&!f(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=_(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var e,t,n=v(this);if(n)return n;if(this._bodyBlob)return n=this._bodyBlob,e=new FileReader,t=y(e),e.readAsText(n),t;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var n,r=(t=t||{}).body;if(e instanceof c){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new s(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new s(t.headers)),this.method=(e=t.method||this.method||"GET",n=e.toUpperCase(),-1<p.indexOf(n)?n:e),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function S(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(t=(e=e.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),n.append(decodeURIComponent(t),decodeURIComponent(e)))}),n}function u(e,t){t=t||{},this.type="default",this.status="status"in t?t.status:200,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new s(t.headers),this.url=t.url||"",this._initBody(e)}e.fetch||(t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,(i="ArrayBuffer"in e)&&(l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=function(e){return e&&DataView.prototype.isPrototypeOf(e)},f=ArrayBuffer.isView||function(e){return e&&-1<l.indexOf(Object.prototype.toString.call(e))}),s.prototype.append=function(e,t){e=o(e),t=m(t);var n=this.map[e];this.map[e]=n?n+","+t:t},s.prototype.delete=function(e){delete this.map[o(e)]},s.prototype.get=function(e){return e=o(e),this.has(e)?this.map[e]:null},s.prototype.has=function(e){return this.map.hasOwnProperty(o(e))},s.prototype.set=function(e,t){this.map[o(e)]=m(t)},s.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},s.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),g(n)},s.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),g(t)},s.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),g(n)},n&&(s.prototype[Symbol.iterator]=s.prototype.entries),p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],c.prototype.clone=function(){return new c(this,{body:this._bodyInit})},w.call(c.prototype),w.call(u.prototype),u.prototype.clone=function(){return new u(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new s(this.headers),url:this.url})},u.error=function(){var e=new u(null,{status:0,statusText:""});return e.type="error",e},h=[301,302,303,307,308],u.redirect=function(e,t){if(-1===h.indexOf(t))throw new RangeError("Invalid status code");return new u(null,{status:t,headers:{location:e}})},e.Headers=s,e.Request=c,e.Response=u,e.fetch=function(n,o){return new Promise(function(r,e){var t=new c(n,o),i=new XMLHttpRequest;i.onload=function(){var n,e={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",n=new s,e.split(/\r?\n/).forEach(function(e){var e=e.split(":"),t=e.shift().trim();t&&(e=e.join(":").trim(),n.append(t,e))}),n)},t=(e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL"),"response"in i?i.response:i.responseText);r(new u(t,e))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.open(t.method,t.url,!0),"include"===t.credentials&&(i.withCredentials=!0),"responseType"in i&&a&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0)}("undefined"!=typeof self?self:void 0);var x="undefined"!=typeof window?window:void 0!==Ts?Ts:"undefined"!=typeof self?self:{};function v(e,t){return e(t={exports:{}},t.exports),t.exports}for(var y=v(function(C,I){!function(){var Uo,Fo="Expected a function",Ko="__lodash_hash_undefined__",Jo="__lodash_placeholder__",Qo=128,Xo=9007199254740991,Zo=NaN,ea=4294967295,ta=[["ary",Qo],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],na="[object Arguments]",ra="[object Array]",ia="[object Boolean]",oa="[object Date]",aa="[object Error]",sa="[object Function]",ca="[object GeneratorFunction]",ua="[object Map]",la="[object Number]",da="[object Object]",fa="[object Promise]",pa="[object RegExp]",ha="[object Set]",ma="[object String]",ga="[object Symbol]",va="[object WeakMap]",ya="[object ArrayBuffer]",ba="[object DataView]",_a="[object Float32Array]",wa="[object Float64Array]",Sa="[object Int8Array]",Ea="[object Int16Array]",Aa="[object Int32Array]",ka="[object Uint8Array]",Ta="[object Uint8ClampedArray]",Ca="[object Uint16Array]",Ia="[object Uint32Array]",xa=/\b__p \+= '';/g,Pa=/\b(__p \+=) '' \+/g,Ma=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oa=/&(?:amp|lt|gt|quot|#39);/g,Ra=/[&<>"']/g,ja=RegExp(Oa.source),Da=RegExp(Ra.source),Na=/<%-([\s\S]+?)%>/g,La=/<%([\s\S]+?)%>/g,$a=/<%=([\s\S]+?)%>/g,Ba=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ua=/^\w*$/,Fa=/^\./,za=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Va=/[\\^$.*+?()[\]{}|]/g,Ha=RegExp(Va.source),qa=/^\s+|\s+$/g,Wa=/^\s+/,Ya=/\s+$/,Ga=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ka=/\{\n\/\* \[wrapped with (.+)\] \*/,Ja=/,? & /,Qa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Xa=/\\(\\)?/g,Za=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,es=/\w*$/,ts=/^[-+]0x[0-9a-f]+$/i,ns=/^0b[01]+$/i,rs=/^\[object .+?Constructor\]$/,is=/^0o[0-7]+$/i,os=/^(?:0|[1-9]\d*)$/,as=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ss=/($^)/,cs=/['\n\r\u2028\u2029\\]/g,t="\\ud800-\\udfff",n="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",r="\\u2700-\\u27bf",i="a-z\\xdf-\\xf6\\xf8-\\xff",o="A-Z\\xc0-\\xd6\\xd8-\\xde",a="\\ufe0e\\ufe0f",s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",e="[']",c="["+t+"]",u="["+s+"]",l="["+n+"]",d="["+r+"]",f="["+i+"]",s="[^"+t+s+"\\d+"+r+i+o+"]",r="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",p="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",o="["+o+"]",m="\\u200d",g="(?:"+f+"|"+s+")",s="(?:"+o+"|"+s+")",v="(?:['](?:d|ll|m|re|s|t|ve))?",y="(?:['](?:D|LL|M|RE|S|T|VE))?",b="(?:"+l+"|"+r+")"+"?",_="["+a+"]?",_=_+b+("(?:"+m+"(?:"+[i,p,h].join("|")+")"+_+b+")*"),b="(?:"+[d,p,h].join("|")+")"+_,d="(?:"+[i+l+"?",l,p,h,c].join("|")+")",us=RegExp(e,"g"),ls=RegExp(l,"g"),w=RegExp(r+"(?="+r+")|"+d+_,"g"),ds=RegExp([o+"?"+f+"+"+v+"(?="+[u,o,"$"].join("|")+")",s+"+"+y+"(?="+[u,o+g,"$"].join("|")+")",o+"?"+g+"+"+v,o+"+"+y,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)","\\d+",b].join("|"),"g"),S=RegExp("["+m+t+n+a+"]"),fs=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ps=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],hs=-1,zo={},Vo=(zo[_a]=zo[wa]=zo[Sa]=zo[Ea]=zo[Aa]=zo[ka]=zo[Ta]=zo[Ca]=zo[Ia]=!0,zo[na]=zo[ra]=zo[ya]=zo[ia]=zo[ba]=zo[oa]=zo[aa]=zo[sa]=zo[ua]=zo[la]=zo[da]=zo[pa]=zo[ha]=zo[ma]=zo[va]=!1,{}),E=(Vo[na]=Vo[ra]=Vo[ya]=Vo[ba]=Vo[ia]=Vo[oa]=Vo[_a]=Vo[wa]=Vo[Sa]=Vo[Ea]=Vo[Aa]=Vo[ua]=Vo[la]=Vo[da]=Vo[pa]=Vo[ha]=Vo[ma]=Vo[ga]=Vo[ka]=Vo[Ta]=Vo[Ca]=Vo[Ia]=!0,Vo[aa]=Vo[sa]=Vo[va]=!1,{"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"}),ms=parseFloat,gs=parseInt,i="object"==typeof x&&x&&x.Object===Object&&x,p="object"==typeof self&&self&&self.Object===Object&&self,Ho=i||p||Function("return this")(),h=I&&!I.nodeType&&I,c=h&&C&&!C.nodeType&&C,vs=c&&c.exports===h,A=vs&&i.process,e=function(){try{return A&&A.binding&&A.binding("util")}catch(e){}}(),ys=e&&e.isArrayBuffer,bs=e&&e.isDate,_s=e&&e.isMap,ws=e&&e.isRegExp,Ss=e&&e.isSet,Es=e&&e.isTypedArray;function As(e,t){return e.set(t[0],t[1]),e}function ks(e,t){return e.add(t),e}function qo(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Ts(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function Wo(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Cs(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Is(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function xs(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function Ps(e,t){return!!(null==e?0:e.length)&&-1<$s(e,t,0)}function Ms(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Yo(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Os(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Rs(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function js(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Ds(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var k=zs("length");function Ns(e,r,t){var i;return t(e,function(e,t,n){if(r(e,t,n))return i=t,!1}),i}function Ls(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function $s(e,t,n){if(t!=t)return Ls(e,Us,n);for(var r=e,i=t,o=n-1,a=r.length;++o<a;)if(r[o]===i)return o;return-1}function Bs(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Us(e){return e!=e}function Fs(e,t){var n=null==e?0:e.length;return n?Hs(e,t)/n:Zo}function zs(t){return function(e){return null==e?Uo:e[t]}}function T(t){return function(e){return null==t?Uo:t[e]}}function Vs(e,r,i,o,t){return t(e,function(e,t,n){i=o?(o=!1,e):r(i,e,t,n)}),i}function Hs(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==Uo&&(n=n===Uo?o:n+o)}return n}function qs(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Go(t){return function(e){return t(e)}}function Ws(t,e){return Yo(e,function(e){return t[e]})}function Ys(e,t){return e.has(t)}function Gs(e,t){for(var n=-1,r=e.length;++n<r&&-1<$s(t,e[n],0););return n}function Ks(e,t){for(var n=e.length;n--&&-1<$s(t,e[n],0););return n}var Js=T({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Qs=T({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xs(e){return"\\"+E[e]}function Zs(e){return S.test(e)}function ec(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r}function tc(t,n){return function(e){return t(n(e))}}function nc(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==Jo||(e[n]=Jo,o[i++]=n)}return o}function rc(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function ic(e){return(Zs(e)?function(e){var t=w.lastIndex=0;for(;w.test(e);)++t;return t}:k)(e)}function oc(e){return Zs(e)?e.match(w)||[]:e.split("")}var ac=T({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var sc=function t(e){var S=(e=null==e?Ho:sc.defaults(Ho.Object(),e,sc.pick(Ho,ps))).Array,n=e.Date,r=e.Error,f=e.Function,i=e.Math,m=e.Object,p=e.RegExp,l=e.String,y=e.TypeError,o=S.prototype,c=f.prototype,u=m.prototype,b=e["__core-js_shared__"],_=c.toString,N=u.hasOwnProperty,w=0,E=(c=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",A=u.toString,k=_.call(m),T=Ho._,C=p("^"+_.call(N).replace(Va,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),c=vs?e.Buffer:Uo,I=e.Symbol,$=e.Uint8Array,x=c?c.allocUnsafe:Uo,P=tc(m.getPrototypeOf,m),M=m.create,O=u.propertyIsEnumerable,R=o.splice,j=I?I.isConcatSpreadable:Uo,D=I?I.iterator:Uo,B=I?I.toStringTag:Uo,U=function(){try{var e=Bn(m,"defineProperty");return e({},"",{}),e}catch(e){}}(),F=e.clearTimeout!==Ho.clearTimeout&&e.clearTimeout,z=n&&n.now!==Ho.Date.now&&n.now,V=e.setTimeout!==Ho.setTimeout&&e.setTimeout,H=i.ceil,q=i.floor,W=m.getOwnPropertySymbols,c=c?c.isBuffer:Uo,Y=e.isFinite,G=o.join,K=tc(m.keys,m),J=i.max,Q=i.min,X=n.now,Z=e.parseInt,ee=i.random,te=o.reverse,n=Bn(e,"DataView"),ne=Bn(e,"Map"),re=Bn(e,"Promise"),ie=Bn(e,"Set"),e=Bn(e,"WeakMap"),oe=Bn(m,"create"),ae=e&&new e,se={},ce=dr(n),ue=dr(ne),le=dr(re),de=dr(ie),fe=dr(e),I=I?I.prototype:Uo,pe=I?I.valueOf:Uo,he=I?I.toString:Uo;function h(e){if(vi(e)&&!L(e)&&!(e instanceof g)){if(e instanceof ye)return e;if(N.call(e,"__wrapped__"))return fr(e)}return new ye(e)}var me=function(e){if(!gi(e))return{};if(M)return M(e);ge.prototype=e;e=new ge;return ge.prototype=Uo,e};function ge(){}function ve(){}function ye(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Uo}function g(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ea,this.__views__=[]}function be(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function we(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Se(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new we;++t<n;)this.add(e[t])}function Ee(e){e=this.__data__=new _e(e);this.size=e.size}function Ae(e,t){var n,r=L(e),i=!r&&si(e),o=!r&&!i&&di(e),a=!r&&!i&&!o&&ki(e),s=r||i||o||a,c=s?qs(e.length,l):[],u=c.length;for(n in e)!t&&!N.call(e,n)||s&&("length"==n||o&&("offset"==n||"parent"==n)||a&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||Wn(n,u))||c.push(n);return c}function ke(e){var t=e.length;return t?e[St(0,t-1)]:Uo}function Te(e,t){return sr(tn(e),De(t,0,e.length))}function Ce(e){return sr(tn(e))}function Ie(e,t,n){(n===Uo||ii(e[t],n))&&(n!==Uo||t in e)||Re(e,t,n)}function xe(e,t,n){var r=e[t];N.call(e,t)&&ii(r,n)&&(n!==Uo||t in e)||Re(e,t,n)}function Pe(e,t){for(var n=e.length;n--;)if(ii(e[n][0],t))return n;return-1}function Me(e,r,i,o){return Ue(e,function(e,t,n){r(o,e,i(e),n)}),o}function Oe(e,t){return e&&nn(t,qi(t),e)}function Re(e,t,n){"__proto__"==t&&U?U(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function je(e,t){for(var n=-1,r=t.length,i=S(r),o=null==e;++n<r;)i[n]=o?Uo:Ui(e,t[n]);return i}function De(e,t,n){return e==e&&(n!==Uo&&(e=e<=n?e:n),t!==Uo&&(e=t<=e?e:t)),e}function Ne(n,r,i,l,e,o){var a,d=1&r,f=2&r,p=4&r;if((a=i?e?i(n,l,e,o):i(n):a)!==Uo)return a;if(!gi(n))return n;var t,l=L(n);if(l){if(a=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&N.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(n),!d)return tn(n,a)}else{var s=zn(n),c=s==sa||s==ca;if(di(n))return Kt(n,d);if(s==da||s==na||c&&!e){if(a=f||c?{}:Hn(n),!d)return f?(u=c=n,u=(t=a)&&nn(u,Wi(u),t),nn(c,Fn(c),u)):(c=Oe(a,t=n),nn(t,Un(t),c))}else{if(!Vo[s])return e?n:{};a=function(e,t,n,r){var i=e.constructor;switch(t){case ya:return Jt(e);case ia:case oa:return new i(+e);case ba:return function(e,t){t=t?Jt(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,r);case _a:case wa:case Sa:case Ea:case Aa:case ka:case Ta:case Ca:case Ia:return Qt(e,r);case ua:return function(e,t,n){return Rs(t?n(ec(e),1):ec(e),As,new e.constructor)}(e,r,n);case la:case ma:return new i(e);case pa:return function(e){var t=new e.constructor(e.source,es.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ha:return function(e,t,n){return Rs(t?n(rc(e),1):rc(e),ks,new e.constructor)}(e,r,n);case ga:return function(e){return pe?m(pe.call(e)):{}}(e)}}(n,s,Ne,d)}}var u=(o=o||new Ee).get(n);if(u)return u;o.set(n,a);var h=l?Uo:(p?f?Rn:On:f?Wi:qi)(n);return Wo(h||n,function(e,t){h&&(e=n[t=e]),xe(a,t,Ne(e,r,i,t,n,o))}),a}function Le(e,t,n){var r=n.length;if(null==e)return!r;for(e=m(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===Uo&&!(i in e)||!o(a))return!1}return!0}function $e(e,t,n){if("function"!=typeof e)throw new y(Fo);return rr(function(){e.apply(Uo,n)},t)}function Be(e,t,n,r){var i=-1,o=Ps,a=!0,l=e.length,s=[],d=t.length;if(!l)return s;n&&(t=Yo(t,Go(n))),r?(o=Ms,a=!1):200<=t.length&&(o=Ys,a=!1,t=new Se(t));e:for(;++i<l;){var c=e[i],u=null==n?c:n(c),c=r||0!==c?c:0;if(a&&u==u){for(var f=d;f--;)if(t[f]===u)continue e;s.push(c)}else o(t,u,r)||s.push(c)}return s}h.templateSettings={escape:Na,evaluate:La,interpolate:$a,variable:"",imports:{_:h}},(h.prototype=ve.prototype).constructor=h,(ye.prototype=me(ve.prototype)).constructor=ye,(g.prototype=me(ve.prototype)).constructor=g,be.prototype.clear=function(){this.__data__=oe?oe(null):{},this.size=0},be.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},be.prototype.get=function(e){var t,n=this.__data__;return oe?(t=n[e])===Ko?Uo:t:N.call(n,e)?n[e]:Uo},be.prototype.has=function(e){var t=this.__data__;return oe?t[e]!==Uo:N.call(t,e)},be.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=oe&&t===Uo?Ko:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__;return!((e=Pe(t,e))<0)&&(e==t.length-1?t.pop():R.call(t,e,1),--this.size,!0)},_e.prototype.get=function(e){var t=this.__data__;return(e=Pe(t,e))<0?Uo:t[e][1]},_e.prototype.has=function(e){return-1<Pe(this.__data__,e)},_e.prototype.set=function(e,t){var n=this.__data__,r=Pe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},we.prototype.clear=function(){this.size=0,this.__data__={hash:new be,map:new(ne||_e),string:new be}},we.prototype.delete=function(e){return e=Ln(this,e).delete(e),this.size-=e?1:0,e},we.prototype.get=function(e){return Ln(this,e).get(e)},we.prototype.has=function(e){return Ln(this,e).has(e)},we.prototype.set=function(e,t){var n=Ln(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,Ko),this},Se.prototype.has=function(e){return this.__data__.has(e)},Ee.prototype.clear=function(){this.__data__=new _e,this.size=0},Ee.prototype.delete=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e},Ee.prototype.get=function(e){return this.__data__.get(e)},Ee.prototype.has=function(e){return this.__data__.has(e)},Ee.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _e){var r=n.__data__;if(!ne||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new we(r)}return n.set(e,t),this.size=n.size,this};var Ue=an(Ge),Fe=an(Ke,!0);function ze(e,r){var i=!0;return Ue(e,function(e,t,n){return i=!!r(e,t,n)}),i}function Ve(e,t,n){for(var r=-1,i=e.length;++r<i;){var o,a,s=e[r],c=t(s);null!=c&&(o===Uo?c==c&&!Ai(c):n(c,o))&&(o=c,a=s)}return a}function He(e,r){var i=[];return Ue(e,function(e,t,n){r(e,t,n)&&i.push(e)}),i}function qe(e,t,n,r,i){var o=-1,a=e.length;for(n=n||qn,i=i||[];++o<a;){var s=e[o];0<t&&n(s)?1<t?qe(s,t-1,n,r,i):Os(i,s):r||(i[i.length]=s)}return i}var We=sn(),Ye=sn(!0);function Ge(e,t){return e&&We(e,t,qi)}function Ke(e,t){return e&&Ye(e,t,qi)}function Je(t,e){return xs(e,function(e){return pi(t[e])})}function Qe(e,t){for(var n=0,r=(t=qt(t,e)).length;null!=e&&n<r;)e=e[lr(t[n++])];return n&&n==r?e:Uo}function Xe(e,t,n){t=t(e);return L(e)?t:Os(t,n(e))}function Ze(e){{if(null==e)return e===Uo?"[object Undefined]":"[object Null]";if(B&&B in m(e)){var t=e,n=N.call(t,B),r=t[B];try{t[B]=Uo;var i=!0}catch(e){}var o=A.call(t);return i&&(n?t[B]=r:delete t[B]),o}return A.call(e)}}function et(e,t){return t<e}function tt(e,t){return null!=e&&N.call(e,t)}function nt(e,t){return null!=e&&t in m(e)}function rt(e,t,n){for(var l=n?Ms:Ps,d=e[0].length,r=e.length,i=r,f=S(r),p=1/0,o=[];i--;){var a=e[i];i&&t&&(a=Yo(a,Go(t))),p=Q(a.length,p),f[i]=!n&&(t||120<=d&&120<=a.length)?new Se(i&&a):Uo}var a=e[0],h=-1,s=f[0];e:for(;++h<d&&o.length<p;){var c=a[h],u=t?t(c):c,c=n||0!==c?c:0;if(!(s?Ys(s,u):l(o,u,n))){for(i=r;--i;){var m=f[i];if(!(m?Ys(m,u):l(e[i],u,n)))continue e}s&&s.push(u),o.push(c)}}return o}function it(e,t,n){t=null==(e=tr(e,t=qt(t,e)))?e:e[lr(vr(t))];return null==t?Uo:qo(t,e,n)}function ot(e){return vi(e)&&Ze(e)==na}function at(e,t,l,d,n){{if(e===t)return!0;if(null==e||null==t||!vi(e)&&!vi(t))return e!=e&&t!=t;var f=at,r=L(e),p=L(t),i=r?ra:zn(e),p=p?ra:zn(t),h=(i=i==na?da:i)==da,m=(p=p==na?da:p)==da,p;if((p=i==p)&&di(e)){if(!di(t))return!1;h=!(r=!0)}if(p&&!h){n=n||new Ee;if(r||ki(e))return Pn(e,t,l,d,f,n);else{var o=e;var a=t;var g=i;var v=l;var y=d;var b=f;var _=n;switch(g){case ba:if(o.byteLength!=a.byteLength||o.byteOffset!=a.byteOffset)return!1;o=o.buffer,a=a.buffer;case ya:return o.byteLength==a.byteLength&&b(new $(o),new $(a))?!0:!1;case ia:case oa:case la:return ii(+o,+a);case aa:return o.name==a.name&&o.message==a.message;case pa:case ma:return o==a+"";case ua:var w=ec;case ha:var S=1&v;if(w=w||rc,o.size!=a.size&&!S)return!1;S=_.get(o);if(S)return S==a;v|=2,_.set(o,a);S=Pn(w(o),w(a),v,y,b,_);return _.delete(o),S;case ga:if(pe)return pe.call(o)==pe.call(a)}return!1;return}}if(!(1&l)){var r=h&&N.call(e,"__wrapped__"),i=m&&N.call(t,"__wrapped__");if(r||i)return h=r?e.value():e,m=i?t.value():t,n=n||new Ee,f(h,m,l,d,n)}if(p){n=n||new Ee;var s=e,c=t,E=l,A=d,k=f,u=n,T=1&E,C=On(s),I=C.length,r=On(c).length;if(I!=r&&!T)return!1;for(var x=I;x--;){var P=C[x];if(!(T?P in c:N.call(c,P)))return!1}if((r=u.get(s))&&u.get(c))return r==c;for(var M=!0,O=(u.set(s,c),u.set(c,s),T);++x<I;){P=C[x];var R,j=s[P],D=c[P];if(!((R=A?T?A(D,j,P,c,s,u):A(j,D,P,s,c,u):R)===Uo?j===D||k(j,D,E,A,u):R)){M=!1;break}O=O||"constructor"==P}return M&&!O&&(r=s.constructor,i=c.constructor,r!=i&&"constructor"in s&&"constructor"in c&&!("function"==typeof r&&r instanceof r&&"function"==typeof i&&i instanceof i)&&(M=!1)),u.delete(s),u.delete(c),M}return!1}}function st(e,l,t,n){var r=t.length,i=r,o=!n;if(null==e)return!i;for(e=m(e);r--;){var a=t[r];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<i;){var s=(a=t[r])[0],c=e[s],d=a[1];if(o&&a[2]){if(c===Uo&&!(s in e))return!1}else{var u,f=new Ee;if(!((u=n?n(c,d,s,e,l,f):u)===Uo?at(d,c,3,n,f):u))return!1}}return!0}function ct(e){return!(!gi(e)||(t=e,E&&E in t))&&(pi(e)?C:rs).test(dr(e));var t}function ut(e){return"function"==typeof e?e:null==e?yo:"object"==typeof e?L(e)?mt(e[0],e[1]):ht(e):Co(e)}function lt(e){if(!Qn(e))return K(e);var t,n=[];for(t in m(e))N.call(e,t)&&"constructor"!=t&&n.push(t);return n}function dt(e){if(!gi(e)){var t=e,n=[];if(null!=t)for(var r in m(t))n.push(r);return n}var i,o=Qn(e),a=[];for(i in e)("constructor"!=i||!o&&N.call(e,i))&&a.push(i);return a}function ft(e,t){return e<t}function pt(e,r){var i=-1,o=ui(e)?S(e.length):[];return Ue(e,function(e,t,n){o[++i]=r(e,t,n)}),o}function ht(t){var n=$n(t);return 1==n.length&&n[0][2]?Zn(n[0][0],n[0][1]):function(e){return e===t||st(e,t,n)}}function mt(n,r){return Gn(n)&&Xn(r)?Zn(lr(n),r):function(e){var t=Ui(e,n);return t===Uo&&t===r?Fi(e,n):at(r,t,3)}}function gt(m,g,v,y,b){m!==g&&We(g,function(l,e){var t,n,r,d,f,i,o,a,p,h,s,c,u;gi(l)?(b=b||new Ee,n=g,d=v,f=gt,i=y,o=b,s=(t=m)[r=e],c=n[r],(u=o.get(c))?Ie(t,r,u):(u=i?i(s,c,r+"",t,n,o):Uo,(n=u===Uo)&&(a=L(c),p=!a&&di(c),h=!a&&!p&&ki(c),u=c,a||p||h?u=L(s)?s:li(s)?tn(s):p?Kt(c,!(n=!1)):h?Qt(c,!(n=!1)):[]:_i(c)||si(c)?si(u=s)?u=Oi(s):(!gi(s)||d&&pi(s))&&(u=Hn(c)):n=!1),n&&(o.set(c,u),f(u,c,d,i,o),o.delete(c)),Ie(t,r,u))):(a=y?y(m[e],l,e+"",m,g,b):Uo,Ie(m,e,a=a===Uo?l:a))},Wi)}function vt(e,t){var n=e.length;if(n)return Wn(t+=t<0?n:0,n)?e[t]:Uo}function yt(e,r,l){var i=-1;r=Yo(r.length?r:[yo],Go(s()));var t=pt(e,function(t,e,n){return{criteria:Yo(r,function(e){return e(t)}),index:++i,value:t}}),e=function(e,t){for(var n=l,r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=Xt(i[r],o[r]);if(c){if(s<=r)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index},n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function bt(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Qe(e,a);n(s,a)&&Tt(o,qt(a,e),s)}return o}function _t(e,t,n,r){var i=r?Bs:$s,o=-1,a=t.length,s=e;for(e===t&&(t=tn(t)),n&&(s=Yo(e,Go(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;-1<(c=i(s,l,c,r));)s!==e&&R.call(s,c,1),R.call(e,c,1);return e}function wt(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i,o=t[n];n!=r&&o===i||(Wn(i=o)?R.call(e,o,1):Lt(e,o))}return e}function St(e,t){return e+q(ee()*(t-e+1))}function Et(e,t){var n="";if(!e||t<1||Xo<t)return n;for(;t%2&&(n+=e),(t=q(t/2))&&(e+=e),t;);return n}function a(e,t){return ir(er(e,t,yo),e+"")}function At(e){return ke(eo(e))}function kt(e,t){e=eo(e);return sr(e,De(t,0,e.length))}function Tt(e,t,n,r){if(!gi(e))return e;for(var i=-1,o=(t=qt(t,e)).length,l=o-1,a=e;null!=a&&++i<o;){var s,c=lr(t[i]),u=n;i!=l&&(s=a[c],(u=r?r(s,c,a):Uo)===Uo&&(u=gi(s)?s:Wn(t[i+1])?[]:{})),xe(a,c,u),a=a[c]}return e}var Ct=ae?function(e,t){return ae.set(e,t),e}:yo,I=U?function(e,t){return U(e,"toString",{configurable:!0,enumerable:!1,value:mo(t),writable:!0})}:yo;function It(e){return sr(eo(e))}function xt(e,t,n){for(var r=-1,i=e.length,o=((n=i<n?i:n)<0&&(n+=i),i=n<(t=t<0?i<-t?0:i+t:t)?0:n-t>>>0,t>>>=0,S(i));++r<i;)o[r]=e[r+t];return o}function Pt(e,r){var i;return Ue(e,function(e,t,n){return!(i=r(e,t,n))}),!!i}function Mt(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!Ai(a)&&(n?a<=t:a<t)?r=1+o:i=o}return i}return Ot(e,t,yo,n)}function Ot(e,t,l,n){t=l(t);for(var r=0,i=null==e?0:e.length,d=t!=t,f=null===t,p=Ai(t),h=t===Uo;r<i;){var o=q((r+i)/2),a=l(e[o]),s=a!==Uo,c=null===a,u=a==a,m=Ai(a),u=d?n||u:h?u&&(n||s):f?u&&s&&(n||!c):p?u&&s&&!c&&(n||!m):!c&&!m&&(n?a<=t:a<t);u?r=o+1:i=o}return Q(i,4294967294)}function Rt(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a,s=e[n],c=t?t(s):s;n&&ii(c,a)||(a=c,o[i++]=0===s?0:s)}return o}function jt(e){return"number"==typeof e?e:Ai(e)?Zo:+e}function Dt(e){if("string"==typeof e)return e;if(L(e))return Yo(e,Dt)+"";if(Ai(e))return he?he.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Nt(e,t,n){var r=-1,i=Ps,l=e.length,o=!0,a=[],s=a;if(n)o=!1,i=Ms;else if(200<=l){var d=t?null:An(e);if(d)return rc(d);o=!1,i=Ys,s=new Se}else s=t?[]:a;e:for(;++r<l;){var c=e[r],u=t?t(c):c,c=n||0!==c?c:0;if(o&&u==u){for(var f=s.length;f--;)if(s[f]===u)continue e;t&&s.push(u),a.push(c)}else i(s,u,n)||(s!==a&&s.push(u),a.push(c))}return a}function Lt(e,t){return null==(e=tr(e,t=qt(t,e)))||delete e[lr(vr(t))]}function $t(e,t,n,r){return Tt(e,t,n(Qe(e,t)),r)}function Bt(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?xt(e,r?0:o,r?o+1:i):xt(e,r?o+1:0,r?i:o)}function Ut(e,t){var n=e;return Rs(t,function(e,t){return t.func.apply(t.thisArg,Os([e],t.args))},n=e instanceof g?e.value():n)}function Ft(e,t,n){var r=e.length;if(r<2)return r?Nt(e[0]):[];for(var i=-1,o=S(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=Be(o[i]||a,e[s],t,n));return Nt(qe(o,1),t,n)}function zt(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:Uo;n(a,e[r],s)}return a}function Vt(e){return li(e)?e:[]}function Ht(e){return"function"==typeof e?e:yo}function qt(e,t){return L(e)?e:Gn(e,t)?[e]:ur(d(e))}var Wt=a;function Yt(e,t,n){var r=e.length;return n=n===Uo?r:n,!t&&r<=n?e:xt(e,t,n)}var Gt=F||function(e){return Ho.clearTimeout(e)};function Kt(e,t){if(t)return e.slice();t=e.length,t=x?x(t):new e.constructor(t);return e.copy(t),t}function Jt(e){var t=new e.constructor(e.byteLength);return new $(t).set(new $(e)),t}function Qt(e,t){t=t?Jt(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function Xt(e,t){if(e!==t){var n=e!==Uo,r=null===e,i=e==e,o=Ai(e),a=t!==Uo,s=null===t,c=t==t,u=Ai(t);if(!s&&!u&&!o&&t<e||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function Zt(e,t,n,l){for(var r=-1,i=e.length,o=n.length,a=-1,s=t.length,c=J(i-o,0),u=S(s+c),d=!l;++a<s;)u[a]=t[a];for(;++r<o;)(d||r<i)&&(u[n[r]]=e[r]);for(;c--;)u[a++]=e[r++];return u}function en(e,t,n,l){for(var r=-1,i=e.length,o=-1,a=n.length,s=-1,c=t.length,d=J(i-a,0),u=S(d+c),f=!l;++r<d;)u[r]=e[r];for(var p=r;++s<c;)u[p+s]=t[s];for(;++o<a;)(f||r<i)&&(u[p+n[o]]=e[r++]);return u}function tn(e,t){var n=-1,r=e.length;for(t=t||S(r);++n<r;)t[n]=e[n];return t}function nn(e,t,n,r){for(var i=!n,o=(n=n||{},-1),a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):Uo;(i?Re:xe)(n,s,c=c===Uo?e[s]:c)}return n}function rn(i,o){return function(e,t){var n=L(e)?Ts:Me,r=o?o():{};return n(e,i,s(t,2),r)}}function on(s){return a(function(e,t){var n=-1,r=t.length,i=1<r?t[r-1]:Uo,o=2<r?t[2]:Uo,i=3<s.length&&"function"==typeof i?(r--,i):Uo;for(o&&Yn(t[0],t[1],o)&&(i=r<3?Uo:i,r=1),e=m(e);++n<r;){var a=t[n];a&&s(e,a,n,i)}return e})}function an(o,a){return function(e,t){if(null==e)return e;if(!ui(e))return o(e,t);for(var n=e.length,r=a?n:-1,i=m(e);(a?r--:++r<n)&&!1!==t(i[r],r,i););return e}}function sn(c){return function(e,t,n){for(var r=-1,i=m(e),o=n(e),a=o.length;a--;){var s=o[c?a:++r];if(!1===t(i[s],s,i))break}return e}}function cn(r){return function(e){var t=Zs(e=d(e))?oc(e):Uo,n=t?t[0]:e.charAt(0),t=t?Yt(t,1).join(""):e.slice(1);return n[r]()+t}}function un(t){return function(e){return Rs(fo(ro(e).replace(us,"")),t,"")}}function ln(r){return function(){var e=arguments;switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3]);case 5:return new r(e[0],e[1],e[2],e[3],e[4]);case 6:return new r(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new r(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=me(r.prototype),n=r.apply(t,e);return gi(n)?n:t}}function dn(o,a,s){var c=ln(o);return function e(){for(var t=arguments.length,n=S(t),r=t,i=Nn(e);r--;)n[r]=arguments[r];i=t<3&&n[0]!==i&&n[t-1]!==i?[]:nc(n,i);return(t-=i.length)<s?Sn(o,a,hn,e.placeholder,Uo,n,i,Uo,Uo,s-t):qo(this&&this!==Ho&&this instanceof e?c:o,this,n)}}function fn(o){return function(e,t,n){var r,i=m(e),t=(ui(e)||(r=s(t,3),e=qi(e),t=function(e){return r(i[e],e,i)}),o(e,t,n));return-1<t?i[r?e[t]:t]:Uo}}function pn(c){return Mn(function(i){var o=i.length,e=o,t=ye.prototype.thru;for(c&&i.reverse();e--;){var n=i[e];if("function"!=typeof n)throw new y(Fo);t&&!s&&"wrapper"==Dn(n)&&(s=new ye([],!0))}for(e=s?e:o;++e<o;)var r=Dn(n=i[e]),a="wrapper"==r?jn(n):Uo,s=a&&Kn(a[0])&&424==a[1]&&!a[4].length&&1==a[9]?s[Dn(a[0])].apply(s,a[3]):1==n.length&&Kn(n)?s[r]():s.thru(n);return function(){var e=arguments,t=e[0];if(s&&1==e.length&&L(t))return s.plant(t).value();for(var n=0,r=o?i[n].apply(this,e):t;++n<o;)r=i[n].call(this,r);return r}})}function hn(a,s,c,u,g,l,v,d,f,p){var y=s&Qo,b=1&s,h=2&s,m=24&s,_=512&s,w=h?Uo:ln(a);return function e(){for(var t=S(o=arguments.length),n=o;n--;)t[n]=arguments[n];if(m&&(i=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(t,r=Nn(e))),u&&(t=Zt(t,u,g,m)),l&&(t=en(t,l,v,m)),o-=i,m&&o<p)return i=nc(t,r),Sn(a,s,hn,e.placeholder,c,t,i,d,f,p-o);var r=b?c:this,i=h?r[a]:a,o=t.length;return d?t=function(e,t){for(var n=e.length,r=Q(t.length,n),i=tn(e);r--;){var o=t[r];e[r]=Wn(o,n)?i[o]:Uo}return e}(t,d):_&&1<o&&t.reverse(),y&&f<o&&(t.length=f),(i=this&&this!==Ho&&this instanceof e?w||ln(i):i).apply(r,t)}}function mn(n,a){return function(e,t){return e=e,r=n,i=a(t),o={},Ge(e,function(e,t,n){r(o,i(e),t,n)}),o;var r,i,o}}function gn(r,i){return function(e,t){var n;if(e===Uo&&t===Uo)return i;if(e!==Uo&&(n=e),t!==Uo){if(n===Uo)return t;t="string"==typeof e||"string"==typeof t?(e=Dt(e),Dt(t)):(e=jt(e),jt(t)),n=r(e,t)}return n}}function vn(r){return Mn(function(e){return e=Yo(e,Go(s())),a(function(t){var n=this;return r(e,function(e){return qo(e,n,t)})})})}function yn(e,t){var n=(t=t===Uo?" ":Dt(t)).length;if(n<2)return n?Et(t,e):t;n=Et(t,H(e/ic(t)));return Zs(t)?Yt(oc(n),0,e).join(""):n.slice(0,e)}function bn(s,e,c,u){var l=1&e,d=ln(s);return function e(){for(var t=-1,n=arguments.length,r=-1,i=u.length,o=S(i+n),a=this&&this!==Ho&&this instanceof e?d:s;++r<i;)o[r]=u[r];for(;n--;)o[r++]=arguments[++t];return qo(a,l?c:this,o)}}function _n(u){return function(e,t,n){n&&"number"!=typeof n&&Yn(e,t,n)&&(t=n=Uo),e=xi(e),t===Uo?(t=e,e=0):t=xi(t),n=n===Uo?e<t?1:-1:xi(n);for(var r=e,i=n,o=u,a=-1,s=J(H((t-r)/(i||1)),0),c=S(s);s--;)c[o?s:++a]=r,r+=i;return c}}function wn(n){return function(e,t){return"string"==typeof e&&"string"==typeof t||(e=Mi(e),t=Mi(t)),n(e,t)}}function Sn(e,t,n,r,i,o,a,s,c,l){var u=8&t,i=(4&(t=(t|(u?32:64))&~(u?64:32))||(t&=-4),[e,t,i,u?o:Uo,u?a:Uo,u?Uo:o,u?Uo:a,s,c,l]),o=n.apply(Uo,i);return Kn(e)&&nr(o,i),o.placeholder=r,or(o,e,t)}function En(e){var r=i[e];return function(e,t){var n;return e=Mi(e),(t=null==t?0:Q(v(t),292))?(n=(d(e)+"e").split("e"),+((n=(d(r(n[0]+"e"+(+n[1]+t)))+"e").split("e"))[0]+"e"+(+n[1]-t))):r(e)}}var An=ie&&1/rc(new ie([,-0]))[1]==1/0?function(e){return new ie(e)}:Eo;function kn(o){return function(e){var t,n,r,i=zn(e);return i==ua?ec(e):i==ha?(i=e,t=-1,n=Array(i.size),i.forEach(function(e){n[++t]=[e,e]}),n):Yo(o(r=e),function(e){return[e,r[e]]})}}function Tn(e,t,n,r,i,l,o,a){var s=2&t;if(!s&&"function"!=typeof e)throw new y(Fo);var c,d,f,p,h,m=r?r.length:0,g=(m||(t&=-97,r=i=Uo),o=o===Uo?o:J(v(o),0),a=a===Uo?a:v(a),m-=i?i.length:0,64&t&&(u=r,c=i,r=i=Uo),s?Uo:jn(e)),u=[e,t,n,r,i,u,c,l,o,a];return g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==Qo&&8==n||r==Qo&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return;1&r&&(e[2]=t[2],i|=1&n?0:4);o=t[3];{var s;o&&(s=e[3],e[3]=s?Zt(s,o,t[4]):o,e[4]=s?nc(e[3],Jo):t[4])}(o=t[5])&&(s=e[5],e[5]=s?en(s,o,t[6]):o,e[6]=s?nc(e[5],Jo):t[6]);(o=t[7])&&(e[7]=o);r&Qo&&(e[8]=null==e[8]?t[8]:Q(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(u,g),e=u[0],t=u[1],n=u[2],r=u[3],i=u[4],!(a=u[9]=u[9]===Uo?s?0:e.length:J(u[9]-m,0))&&24&t&&(t&=-25),c=t&&1!=t?8==t||16==t?dn(e,t,a):32!=t&&33!=t||i.length?hn.apply(Uo,u):bn(e,t,n,r):(f=n,p=1&t,h=ln(d=e),function e(){return(this&&this!==Ho&&this instanceof e?h:d).apply(p?f:this,arguments)}),or((g?Ct:nr)(c,u),e,t)}function Cn(e,t,n,r){return e===Uo||ii(e,u[n])&&!N.call(r,n)?t:e}function In(e,t,n,r,i,o){return gi(e)&&gi(t)&&(o.set(t,e),gt(e,t,Uo,In,o),o.delete(t)),e}function xn(e){return _i(e)?Uo:e}function Pn(e,t,n,r,l,i){var d=1&n,f=e.length,o=t.length;if(f!=o&&!(d&&f<o))return!1;o=i.get(e);if(o&&i.get(t))return o==t;var a=-1,s=!0,p=2&n?new Se:Uo;for(i.set(e,t),i.set(t,e);++a<f;){var h,c=e[a],u=t[a];if((h=r?d?r(u,c,a,t,e,i):r(c,u,a,e,t,i):h)!==Uo){if(h)continue;s=!1;break}if(p){if(!Ds(t,function(e,t){return!Ys(p,t)&&(c===e||l(c,e,n,r,i))&&p.push(t)})){s=!1;break}}else if(c!==u&&!l(c,u,n,r,i)){s=!1;break}}return i.delete(e),i.delete(t),s}function Mn(e){return ir(er(e,Uo,mr),e+"")}function On(e){return Xe(e,qi,Un)}function Rn(e){return Xe(e,Wi,Fn)}var jn=ae?function(e){return ae.get(e)}:Eo;function Dn(e){for(var t=e.name+"",n=se[t],r=N.call(se,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Nn(e){return(N.call(h,"placeholder")?h:e).placeholder}function s(){var e=(e=h.iteratee||bo)===bo?ut:e;return arguments.length?e(arguments[0],arguments[1]):e}function Ln(e,t){var n,r,e=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?e["string"==typeof t?"string":"hash"]:e.map}function $n(e){for(var t=qi(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Xn(i)]}return t}function Bn(e,t){t=t;e=null==(e=e)?Uo:e[t];return ct(e)?e:Uo}var Un=W?function(t){return null==t?[]:(t=m(t),xs(W(t),function(e){return O.call(t,e)}))}:Po,Fn=W?function(e){for(var t=[];e;)Os(t,Un(e)),e=P(e);return t}:Po,zn=Ze;function Vn(e,t,n){for(var r=-1,i=(t=qt(t,e)).length,o=!1;++r<i;){var a=lr(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&mi(i)&&Wn(a,i)&&(L(e)||si(e))}function Hn(e){return"function"!=typeof e.constructor||Qn(e)?{}:me(P(e))}function qn(e){return L(e)||si(e)||!!(j&&e&&e[j])}function Wn(e,t){return!!(t=null==t?Xo:t)&&("number"==typeof e||os.test(e))&&-1<e&&e%1==0&&e<t}function Yn(e,t,n){var r;if(gi(n))return r=typeof t,("number"==r?ui(n)&&Wn(t,n.length):"string"==r&&t in n)&&ii(n[t],e)}function Gn(e,t){var n;if(!L(e))return n=typeof e,"number"==n||"symbol"==n||"boolean"==n||null==e||Ai(e)||(Ua.test(e)||!Ba.test(e)||null!=t&&e in m(t))}function Kn(e){var t=Dn(e),n=h[t];if("function"==typeof n&&t in g.prototype){if(e===n)return 1;t=jn(n);return t&&e===t[0]}}(n&&zn(new n(new ArrayBuffer(1)))!=ba||ne&&zn(new ne)!=ua||re&&zn(re.resolve())!=fa||ie&&zn(new ie)!=ha||e&&zn(new e)!=va)&&(zn=function(e){var t=Ze(e),e=t==da?e.constructor:Uo,e=e?dr(e):"";if(e)switch(e){case ce:return ba;case ue:return ua;case le:return fa;case de:return ha;case fe:return va}return t});var Jn=b?pi:Mo;function Qn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||u)}function Xn(e){return e==e&&!gi(e)}function Zn(t,n){return function(e){return null!=e&&(e[t]===n&&(n!==Uo||t in m(e)))}}function er(o,a,s){return a=J(a===Uo?o.length-1:a,0),function(){for(var e=arguments,t=-1,n=J(e.length-a,0),r=S(n);++t<n;)r[t]=e[a+t];for(var t=-1,i=S(a+1);++t<a;)i[t]=e[t];return i[a]=s(r),qo(o,this,i)}}function tr(e,t){return t.length<2?e:Qe(e,xt(t,0,-1))}var nr=ar(Ct),rr=V||function(e,t){return Ho.setTimeout(e,t)},ir=ar(I);function or(e,t,n){var r,i,t=t+"";return ir(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(1<n?"& ":"")+t[r],t=t.join(2<n?", ":" "),e.replace(Ga,"{\n/* [wrapped with "+t+"] */\n")}(t,(r=(e=(e=t).match(Ka))?e[1].split(Ja):[],i=n,Wo(ta,function(e){var t="_."+e[0];i&e[1]&&!Ps(r,t)&&r.push(t)}),r.sort())))}function ar(n){var r=0,i=0;return function(){var e=X(),t=16-(e-i);if(i=e,0<t){if(800<=++r)return arguments[0]}else r=0;return n.apply(Uo,arguments)}}function sr(e,t){var n=-1,r=e.length,i=r-1;for(t=t===Uo?r:t;++n<t;){var o=St(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}cr=(F=Zr(F=function(e){var i=[];return Fa.test(e)&&i.push(""),e.replace(za,function(e,t,n,r){i.push(n?r.replace(Xa,"$1"):t||e)}),i},function(e){return 500===cr.size&&cr.clear(),e})).cache;var cr,ur=F;function lr(e){if("string"==typeof e||Ai(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function dr(e){if(null!=e){try{return _.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function fr(e){if(e instanceof g)return e.clone();var t=new ye(e.__wrapped__,e.__chain__);return t.__actions__=tn(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}n=a(function(e,t){return li(e)?Be(e,qe(t,1,li,!0)):[]}),re=a(function(e,t){var n=vr(t);return li(n)&&(n=Uo),li(e)?Be(e,qe(t,1,li,!0),s(n,2)):[]}),e=a(function(e,t){var n=vr(t);return li(n)&&(n=Uo),li(e)?Be(e,qe(t,1,li,!0),Uo,n):[]});function pr(e,t,n){var r=null==e?0:e.length;if(!r)return-1;n=null==n?0:v(n);return n<0&&(n=J(r+n,0)),Ls(e,s(t,3),n)}function hr(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==Uo&&(i=v(n),i=n<0?J(r+i,0):Q(i,r-1)),Ls(e,s(t,3),i,!0)}function mr(e){return(null==e?0:e.length)?qe(e,1):[]}function gr(e){return e&&e.length?e[0]:Uo}b=a(function(e){var t=Yo(e,Vt);return t.length&&t[0]===e[0]?rt(t):[]}),V=a(function(e){var t=vr(e),n=Yo(e,Vt);return t===vr(n)?t=Uo:n.pop(),n.length&&n[0]===e[0]?rt(n,s(t,2)):[]}),I=a(function(e){var t=vr(e),n=Yo(e,Vt);return(t="function"==typeof t?t:Uo)&&n.pop(),n.length&&n[0]===e[0]?rt(n,Uo,t):[]});function vr(e){var t=null==e?0:e.length;return t?e[t-1]:Uo}F=a(yr);function yr(e,t){return e&&e.length&&t&&t.length?_t(e,t):e}var br=Mn(function(e,t){var n=null==e?0:e.length,r=je(e,t);return wt(e,Yo(t,function(e){return Wn(e,n)?+e:e}).sort(Xt)),r});function _r(e){return null==e?e:te.call(e)}var wr=a(function(e){return Nt(qe(e,1,li,!0))}),Sr=a(function(e){var t=vr(e);return li(t)&&(t=Uo),Nt(qe(e,1,li,!0),s(t,2))}),Er=a(function(e){var t="function"==typeof(t=vr(e))?t:Uo;return Nt(qe(e,1,li,!0),Uo,t)});function Ar(t){if(!t||!t.length)return[];var n=0;return t=xs(t,function(e){return li(e)&&(n=J(e.length,n),1)}),qs(n,function(e){return Yo(t,zs(e))})}function kr(e,t){if(!e||!e.length)return[];e=Ar(e);return null==t?e:Yo(e,function(e){return qo(t,Uo,e)})}var Tr=a(function(e,t){return li(e)?Be(e,t):[]}),Cr=a(function(e){return Ft(xs(e,li))}),Ir=a(function(e){var t=vr(e);return li(t)&&(t=Uo),Ft(xs(e,li),s(t,2))}),xr=a(function(e){var t="function"==typeof(t=vr(e))?t:Uo;return Ft(xs(e,li),Uo,t)}),Pr=a(Ar);var Mr=a(function(e){var t=e.length,t="function"==typeof(t=1<t?e[t-1]:Uo)?(e.pop(),t):Uo;return kr(e,t)});function Or(e){e=h(e);return e.__chain__=!0,e}function Rr(e,t){return t(e)}var jr=Mn(function(t){function e(e){return je(e,t)}var n=t.length,r=n?t[0]:0,i=this.__wrapped__;return!(1<n||this.__actions__.length)&&i instanceof g&&Wn(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:Rr,args:[e],thisArg:Uo}),new ye(i,this.__chain__).thru(function(e){return n&&!e.length&&e.push(Uo),e})):this.thru(e)});var Dr=rn(function(e,t,n){N.call(e,n)?++e[n]:Re(e,n,1)});var Nr=fn(pr),Lr=fn(hr);function $r(e,t){return(L(e)?Wo:Ue)(e,s(t,3))}function Br(e,t){return(L(e)?Cs:Fe)(e,s(t,3))}var Ur=rn(function(e,t,n){N.call(e,n)?e[n].push(t):Re(e,n,[t])});var Fr=a(function(e,t,n){var r=-1,i="function"==typeof t,o=ui(e)?S(e.length):[];return Ue(e,function(e){o[++r]=i?qo(t,e,n):it(e,t,n)}),o}),zr=rn(function(e,t,n){Re(e,n,t)});function Vr(e,t){return(L(e)?Yo:pt)(e,s(t,3))}var Hr=rn(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var qr=a(function(e,t){if(null==e)return[];var n=t.length;return 1<n&&Yn(e,t[0],t[1])?t=[]:2<n&&Yn(t[0],t[1],t[2])&&(t=[t[0]]),yt(e,qe(t,1),[])}),Wr=z||function(){return Ho.Date.now()};function Yr(e,t,n){return t=n?Uo:t,t=e&&null==t?e.length:t,Tn(e,Qo,Uo,Uo,Uo,Uo,t)}function Gr(e,t){var n;if("function"!=typeof t)throw new y(Fo);return e=v(e),function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=Uo),n}}var Kr=a(function(e,t,n){var r,i=1;return n.length&&(r=nc(n,Nn(Kr)),i|=32),Tn(e,i,t,n,r)}),Jr=a(function(e,t,n){var r,i=3;return n.length&&(r=nc(n,Nn(Jr)),i|=32),Tn(t,i,e,n,r)});function Qr(d,n,e){var r,i,o,a,s,c,u=0,f=!1,l=!1,t=!0;if("function"!=typeof d)throw new y(Fo);function p(e){var t=r,n=i;return r=i=Uo,u=e,a=d.apply(n,t)}function h(e){var t=e-c;return c===Uo||n<=t||t<0||l&&o<=e-u}function m(){var e,t=Wr();if(h(t))return g(t);s=rr(m,(e=n-((t=t)-c),l?Q(e,o-(t-u)):e))}function g(e){return s=Uo,t&&r?p(e):(r=i=Uo,a)}function v(){var e=Wr(),t=h(e);if(r=arguments,i=this,c=e,t){if(s===Uo)return u=e=c,s=rr(m,n),f?p(e):a;if(l)return s=rr(m,n),p(c)}return s===Uo&&(s=rr(m,n)),a}return n=Mi(n)||0,gi(e)&&(f=!!e.leading,l="maxWait"in e,o=l?J(Mi(e.maxWait)||0,n):o,t="trailing"in e?!!e.trailing:t),v.cancel=function(){s!==Uo&&Gt(s),u=0,r=c=i=s=Uo},v.flush=function(){return s===Uo?a:g(Wr())},v}var z=a(function(e,t){return $e(e,1,t)}),Xr=a(function(e,t,n){return $e(e,Mi(t)||0,n)});function Zr(r,i){if("function"!=typeof r||null!=i&&"function"!=typeof i)throw new y(Fo);function o(){var e=arguments,t=i?i.apply(this,e):e[0],n=o.cache;return n.has(t)?n.get(t):(e=r.apply(this,e),o.cache=n.set(t,e)||n,e)}return o.cache=new(Zr.Cache||we),o}function ei(t){if("function"!=typeof t)throw new y(Fo);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Zr.Cache=we;var Wt=Wt(function(r,i){var o=(i=1==i.length&&L(i[0])?Yo(i[0],Go(s())):Yo(qe(i,1),Go(s()))).length;return a(function(e){for(var t=-1,n=Q(e.length,o);++t<n;)e[t]=i[t].call(this,e[t]);return qo(r,this,e)})}),ti=a(function(e,t){var n=nc(t,Nn(ti));return Tn(e,32,Uo,t,n)}),ni=a(function(e,t){var n=nc(t,Nn(ni));return Tn(e,64,Uo,t,n)}),ri=Mn(function(e,t){return Tn(e,256,Uo,Uo,Uo,t)});function ii(e,t){return e===t||e!=e&&t!=t}var oi=wn(et),ai=wn(function(e,t){return t<=e}),si=ot(function(){return arguments}())?ot:function(e){return vi(e)&&N.call(e,"callee")&&!O.call(e,"callee")},L=S.isArray,ci=ys?Go(ys):function(e){return vi(e)&&Ze(e)==ya};function ui(e){return null!=e&&mi(e.length)&&!pi(e)}function li(e){return vi(e)&&ui(e)}var di=c||Mo,c=bs?Go(bs):function(e){return vi(e)&&Ze(e)==oa};function fi(e){if(!vi(e))return!1;var t=Ze(e);return t==aa||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!_i(e)}function pi(e){if(!gi(e))return!1;e=Ze(e);return e==sa||e==ca||"[object AsyncFunction]"==e||"[object Proxy]"==e}function hi(e){return"number"==typeof e&&e==v(e)}function mi(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=Xo}function gi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function vi(e){return null!=e&&"object"==typeof e}var yi=_s?Go(_s):function(e){return vi(e)&&zn(e)==ua};function bi(e){return"number"==typeof e||vi(e)&&Ze(e)==la}function _i(e){if(!vi(e)||Ze(e)!=da)return!1;e=P(e);if(null===e)return!0;e=N.call(e,"constructor")&&e.constructor;return"function"==typeof e&&e instanceof e&&_.call(e)==k}var wi=ws?Go(ws):function(e){return vi(e)&&Ze(e)==pa};var Si=Ss?Go(Ss):function(e){return vi(e)&&zn(e)==ha};function Ei(e){return"string"==typeof e||!L(e)&&vi(e)&&Ze(e)==ma}function Ai(e){return"symbol"==typeof e||vi(e)&&Ze(e)==ga}var ki=Es?Go(Es):function(e){return vi(e)&&mi(e.length)&&!!zo[Ze(e)]};var Ti=wn(ft),Ci=wn(function(e,t){return e<=t});function Ii(e){if(!e)return[];if(ui(e))return(Ei(e)?oc:tn)(e);if(D&&e[D]){for(var t,n=e[D](),r=[];!(t=n.next()).done;)r.push(t.value);return r}var i=zn(e);return(i==ua?ec:i==ha?rc:eo)(e)}function xi(e){return e?(e=Mi(e))!==1/0&&e!==-1/0?e==e?e:0:17976931348623157e292*(e<0?-1:1):0===e?e:0}function v(e){var e=xi(e),t=e%1;return e==e?t?e-t:e:0}function Pi(e){return e?De(v(e),0,ea):0}function Mi(e){if("number"==typeof e)return e;if(Ai(e))return Zo;if("string"!=typeof(e=gi(e)?gi(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=e.replace(qa,"");var t=ns.test(e);return t||is.test(e)?gs(e.slice(2),t?2:8):ts.test(e)?Zo:+e}function Oi(e){return nn(e,Wi(e))}function d(e){return null==e?"":Dt(e)}var Ri=on(function(e,t){if(Qn(t)||ui(t))nn(t,qi(t),e);else for(var n in t)N.call(t,n)&&xe(e,n,t[n])}),ji=on(function(e,t){nn(t,Wi(t),e)}),Di=on(function(e,t,n,r){nn(t,Wi(t),e,r)}),Ni=on(function(e,t,n,r){nn(t,qi(t),e,r)}),Li=Mn(je);var $i=a(function(e){return e.push(Uo,Cn),qo(Di,Uo,e)}),Bi=a(function(e){return e.push(Uo,In),qo(Gi,Uo,e)});function Ui(e,t,n){e=null==e?Uo:Qe(e,t);return e===Uo?n:e}function Fi(e,t){return null!=e&&Vn(e,t,nt)}var zi=mn(function(e,t,n){e[t]=n},mo(yo)),Vi=mn(function(e,t,n){N.call(e,t)?e[t].push(n):e[t]=[n]},s),Hi=a(it);function qi(e){return(ui(e)?Ae:lt)(e)}function Wi(e){return ui(e)?Ae(e,!0):dt(e)}var Yi=on(function(e,t,n){gt(e,t,n)}),Gi=on(function(e,t,n,r){gt(e,t,n,r)}),Ki=Mn(function(t,e){var n={};if(null==t)return n;for(var r=!1,i=(e=Yo(e,function(e){return e=qt(e,t),r=r||1<e.length,e}),nn(t,Rn(t),n),r&&(n=Ne(n,7,xn)),e.length);i--;)Lt(n,e[i]);return n});var Ji=Mn(function(e,t){return null==e?{}:bt(n=e,t,function(e,t){return Fi(n,t)});var n});function Qi(e,n){if(null==e)return{};var t=Yo(Rn(e),function(e){return[e]});return n=s(n),bt(e,t,function(e,t){return n(e,t[0])})}var Xi=kn(qi),Zi=kn(Wi);function eo(e){return null==e?[]:Ws(e,qi(e))}var to=un(function(e,t,n){return t=t.toLowerCase(),e+(n?no(t):t)});function no(e){return lo(d(e).toLowerCase())}function ro(e){return(e=d(e))&&e.replace(as,Js).replace(ls,"")}var io=un(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),oo=un(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),ao=cn("toLowerCase");var so=un(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var co=un(function(e,t,n){return e+(n?" ":"")+lo(t)});var uo=un(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),lo=cn("toUpperCase");function fo(e,t,n){return e=d(e),(t=n?Uo:t)===Uo?(n=e,fs.test(n)?e.match(ds)||[]:e.match(Qa)||[]):e.match(t)||[]}var po=a(function(e,t){try{return qo(e,Uo,t)}catch(e){return fi(e)?e:new r(e)}}),ho=Mn(function(t,e){return Wo(e,function(e){e=lr(e),Re(t,e,Kr(t[e],t))}),t});function mo(e){return function(){return e}}var go=pn(),vo=pn(!0);function yo(e){return e}function bo(e){return ut("function"==typeof e?e:Ne(e,1))}var _o=a(function(t,n){return function(e){return it(e,t,n)}}),wo=a(function(t,n){return function(e){return it(t,e,n)}});function So(r,t,e){var n=qi(t),i=Je(t,n),o=(null!=e||gi(t)&&(i.length||!n.length)||(e=t,t=r,r=this,i=Je(t,qi(t))),!(gi(e)&&"chain"in e&&!e.chain)),a=pi(r);return Wo(i,function(e){var n=t[e];r[e]=n,a&&(r.prototype[e]=function(){var e,t=this.__chain__;return o||t?(((e=r(this.__wrapped__)).__actions__=tn(this.__actions__)).push({func:n,args:arguments,thisArg:r}),e.__chain__=t,e):n.apply(r,Os([this.value()],arguments))})}),r}function Eo(){}var Ao=vn(Yo),ko=vn(Is),To=vn(Ds);function Co(e){return Gn(e)?zs(lr(e)):(t=e,function(e){return Qe(e,t)});var t}var Io=_n(),xo=_n(!0);function Po(){return[]}function Mo(){return!1}var Oo=gn(function(e,t){return e+t},0),Ro=En("ceil"),jo=gn(function(e,t){return e/t},1),Do=En("floor");var No,Lo=gn(function(e,t){return e*t},1),$o=En("round"),Bo=gn(function(e,t){return e-t},0);return h.after=function(e,t){if("function"!=typeof t)throw new y(Fo);return e=v(e),function(){if(--e<1)return t.apply(this,arguments)}},h.ary=Yr,h.assign=Ri,h.assignIn=ji,h.assignInWith=Di,h.assignWith=Ni,h.at=Li,h.before=Gr,h.bind=Kr,h.bindAll=ho,h.bindKey=Jr,h.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return L(e)?e:[e]},h.chain=Or,h.chunk=function(e,t,n){t=(n?Yn(e,t,n):t===Uo)?1:J(v(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=S(H(r/t));i<r;)a[o++]=xt(e,i,i+=t);return a},h.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},h.concat=function(){var e=arguments.length;if(!e)return[];for(var t=S(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Os(L(n)?tn(n):[n],qe(t,1))},h.cond=function(r){var i=null==r?0:r.length,t=s();return r=i?Yo(r,function(e){if("function"!=typeof e[1])throw new y(Fo);return[t(e[0]),e[1]]}):[],a(function(e){for(var t=-1;++t<i;){var n=r[t];if(qo(n[0],this,e))return qo(n[1],this,e)}})},h.conforms=function(e){return t=Ne(e,1),n=qi(t),function(e){return Le(e,t,n)};var t,n},h.constant=mo,h.countBy=Dr,h.create=function(e,t){return e=me(e),null==t?e:Oe(e,t)},h.curry=function e(t,n,r){t=Tn(t,8,Uo,Uo,Uo,Uo,Uo,n=r?Uo:n);return t.placeholder=e.placeholder,t},h.curryRight=function e(t,n,r){t=Tn(t,16,Uo,Uo,Uo,Uo,Uo,n=r?Uo:n);return t.placeholder=e.placeholder,t},h.debounce=Qr,h.defaults=$i,h.defaultsDeep=Bi,h.defer=z,h.delay=Xr,h.difference=n,h.differenceBy=re,h.differenceWith=e,h.drop=function(e,t,n){var r=null==e?0:e.length;return r?xt(e,(t=n||t===Uo?1:v(t))<0?0:t,r):[]},h.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?xt(e,0,(t=r-(t=n||t===Uo?1:v(t)))<0?0:t):[]},h.dropRightWhile=function(e,t){return e&&e.length?Bt(e,s(t,3),!0,!0):[]},h.dropWhile=function(e,t){return e&&e.length?Bt(e,s(t,3),!0):[]},h.fill=function(e,t,n,r){if(!(c=null==e?0:e.length))return[];n&&"number"!=typeof n&&Yn(e,t,n)&&(n=0,r=c);var i=e,o=t,a=n,s=r,c=i.length;for((a=v(a))<0&&(a=c<-a?0:c+a),(s=s===Uo||c<s?c:v(s))<0&&(s+=c),s=s<a?0:Pi(s);a<s;)i[a++]=o;return i},h.filter=function(e,t){return(L(e)?xs:He)(e,s(t,3))},h.flatMap=function(e,t){return qe(Vr(e,t),1)},h.flatMapDeep=function(e,t){return qe(Vr(e,t),1/0)},h.flatMapDepth=function(e,t,n){return n=n===Uo?1:v(n),qe(Vr(e,t),n)},h.flatten=mr,h.flattenDeep=function(e){return(null==e?0:e.length)?qe(e,1/0):[]},h.flattenDepth=function(e,t){return(null==e?0:e.length)?qe(e,t=t===Uo?1:v(t)):[]},h.flip=function(e){return Tn(e,512)},h.flow=go,h.flowRight=vo,h.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},h.functions=function(e){return null==e?[]:Je(e,qi(e))},h.functionsIn=function(e){return null==e?[]:Je(e,Wi(e))},h.groupBy=Ur,h.initial=function(e){return(null==e?0:e.length)?xt(e,0,-1):[]},h.intersection=b,h.intersectionBy=V,h.intersectionWith=I,h.invert=zi,h.invertBy=Vi,h.invokeMap=Fr,h.iteratee=bo,h.keyBy=zr,h.keys=qi,h.keysIn=Wi,h.map=Vr,h.mapKeys=function(e,r){var i={};return r=s(r,3),Ge(e,function(e,t,n){Re(i,r(e,t,n),e)}),i},h.mapValues=function(e,r){var i={};return r=s(r,3),Ge(e,function(e,t,n){Re(i,t,r(e,t,n))}),i},h.matches=function(e){return ht(Ne(e,1))},h.matchesProperty=function(e,t){return mt(e,Ne(t,1))},h.memoize=Zr,h.merge=Yi,h.mergeWith=Gi,h.method=_o,h.methodOf=wo,h.mixin=So,h.negate=ei,h.nthArg=function(t){return t=v(t),a(function(e){return vt(e,t)})},h.omit=Ki,h.omitBy=function(e,t){return Qi(e,ei(s(t)))},h.once=function(e){return Gr(2,e)},h.orderBy=function(e,t,n,r){return null==e?[]:yt(e,t=L(t)?t:null==t?[]:[t],n=L(n=r?Uo:n)?n:null==n?[]:[n])},h.over=Ao,h.overArgs=Wt,h.overEvery=ko,h.overSome=To,h.partial=ti,h.partialRight=ni,h.partition=Hr,h.pick=Ji,h.pickBy=Qi,h.property=Co,h.propertyOf=function(t){return function(e){return null==t?Uo:Qe(t,e)}},h.pull=F,h.pullAll=yr,h.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?_t(e,t,s(n,2)):e},h.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?_t(e,t,Uo,n):e},h.pullAt=br,h.range=Io,h.rangeRight=xo,h.rearg=ri,h.reject=function(e,t){return(L(e)?xs:He)(e,ei(s(t,3)))},h.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=s(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return wt(e,i),n},h.rest=function(e,t){if("function"!=typeof e)throw new y(Fo);return a(e,t=t===Uo?t:v(t))},h.reverse=_r,h.sampleSize=function(e,t,n){return t=(n?Yn(e,t,n):t===Uo)?1:v(t),(L(e)?Te:kt)(e,t)},h.set=function(e,t,n){return null==e?e:Tt(e,t,n)},h.setWith=function(e,t,n,r){return r="function"==typeof r?r:Uo,null==e?e:Tt(e,t,n,r)},h.shuffle=function(e){return(L(e)?Ce:It)(e)},h.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n=n&&"number"!=typeof n&&Yn(e,t,n)?(t=0,r):(t=null==t?0:v(t),n===Uo?r:v(n)),xt(e,t,n)):[]},h.sortBy=qr,h.sortedUniq=function(e){return e&&e.length?Rt(e):[]},h.sortedUniqBy=function(e,t){return e&&e.length?Rt(e,s(t,2)):[]},h.split=function(e,t,n){return n&&"number"!=typeof n&&Yn(e,t,n)&&(t=n=Uo),(n=n===Uo?ea:n>>>0)?(e=d(e))&&("string"==typeof t||null!=t&&!wi(t))&&!(t=Dt(t))&&Zs(e)?Yt(oc(e),0,n):e.split(t,n):[]},h.spread=function(n,r){if("function"!=typeof n)throw new y(Fo);return r=null==r?0:J(v(r),0),a(function(e){var t=e[r],e=Yt(e,0,r);return t&&Os(e,t),qo(n,this,e)})},h.tail=function(e){var t=null==e?0:e.length;return t?xt(e,1,t):[]},h.take=function(e,t,n){return e&&e.length?xt(e,0,(t=n||t===Uo?1:v(t))<0?0:t):[]},h.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?xt(e,(t=r-(t=n||t===Uo?1:v(t)))<0?0:t,r):[]},h.takeRightWhile=function(e,t){return e&&e.length?Bt(e,s(t,3),!1,!0):[]},h.takeWhile=function(e,t){return e&&e.length?Bt(e,s(t,3)):[]},h.tap=function(e,t){return t(e),e},h.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new y(Fo);return gi(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Qr(e,t,{leading:r,maxWait:t,trailing:i})},h.thru=Rr,h.toArray=Ii,h.toPairs=Xi,h.toPairsIn=Zi,h.toPath=function(e){return L(e)?Yo(e,lr):Ai(e)?[e]:tn(ur(d(e)))},h.toPlainObject=Oi,h.transform=function(e,r,i){var t,n=L(e),o=n||di(e)||ki(e);return r=s(r,4),null==i&&(t=e&&e.constructor,i=o?n?new t:[]:gi(e)&&pi(t)?me(P(e)):{}),(o?Wo:Ge)(e,function(e,t,n){return r(i,e,t,n)}),i},h.unary=function(e){return Yr(e,1)},h.union=wr,h.unionBy=Sr,h.unionWith=Er,h.uniq=function(e){return e&&e.length?Nt(e):[]},h.uniqBy=function(e,t){return e&&e.length?Nt(e,s(t,2)):[]},h.uniqWith=function(e,t){return t="function"==typeof t?t:Uo,e&&e.length?Nt(e,Uo,t):[]},h.unset=function(e,t){return null==e||Lt(e,t)},h.unzip=Ar,h.unzipWith=kr,h.update=function(e,t,n){return null==e?e:$t(e,t,Ht(n))},h.updateWith=function(e,t,n,r){return r="function"==typeof r?r:Uo,null==e?e:$t(e,t,Ht(n),r)},h.values=eo,h.valuesIn=function(e){return null==e?[]:Ws(e,Wi(e))},h.without=Tr,h.words=fo,h.wrap=function(e,t){return ti(Ht(t),e)},h.xor=Cr,h.xorBy=Ir,h.xorWith=xr,h.zip=Pr,h.zipObject=function(e,t){return zt(e||[],t||[],xe)},h.zipObjectDeep=function(e,t){return zt(e||[],t||[],Tt)},h.zipWith=Mr,h.entries=Xi,h.entriesIn=Zi,h.extend=ji,h.extendWith=Di,So(h,h),h.add=Oo,h.attempt=po,h.camelCase=to,h.capitalize=no,h.ceil=Ro,h.clamp=function(e,t,n){return n===Uo&&(n=t,t=Uo),n!==Uo&&(n=(n=Mi(n))==n?n:0),t!==Uo&&(t=(t=Mi(t))==t?t:0),De(Mi(e),t,n)},h.clone=function(e){return Ne(e,4)},h.cloneDeep=function(e){return Ne(e,5)},h.cloneDeepWith=function(e,t){return Ne(e,5,t="function"==typeof t?t:Uo)},h.cloneWith=function(e,t){return Ne(e,4,t="function"==typeof t?t:Uo)},h.conformsTo=function(e,t){return null==t||Le(e,t,qi(t))},h.deburr=ro,h.defaultTo=function(e,t){return null==e||e!=e?t:e},h.divide=jo,h.endsWith=function(e,t,n){e=d(e),t=Dt(t);var r=e.length,r=n=n===Uo?r:De(v(n),0,r);return 0<=(n-=t.length)&&e.slice(n,r)==t},h.eq=ii,h.escape=function(e){return(e=d(e))&&Da.test(e)?e.replace(Ra,Qs):e},h.escapeRegExp=function(e){return(e=d(e))&&Ha.test(e)?e.replace(Va,"\\$&"):e},h.every=function(e,t,n){return(L(e)?Is:ze)(e,s(t=n&&Yn(e,t,n)?Uo:t,3))},h.find=Nr,h.findIndex=pr,h.findKey=function(e,t){return Ns(e,s(t,3),Ge)},h.findLast=Lr,h.findLastIndex=hr,h.findLastKey=function(e,t){return Ns(e,s(t,3),Ke)},h.floor=Do,h.forEach=$r,h.forEachRight=Br,h.forIn=function(e,t){return null==e?e:We(e,s(t,3),Wi)},h.forInRight=function(e,t){return null==e?e:Ye(e,s(t,3),Wi)},h.forOwn=function(e,t){return e&&Ge(e,s(t,3))},h.forOwnRight=function(e,t){return e&&Ke(e,s(t,3))},h.get=Ui,h.gt=oi,h.gte=ai,h.has=function(e,t){return null!=e&&Vn(e,t,tt)},h.hasIn=Fi,h.head=gr,h.identity=yo,h.includes=function(e,t,n,r){return e=ui(e)?e:eo(e),n=n&&!r?v(n):0,r=e.length,n<0&&(n=J(r+n,0)),Ei(e)?n<=r&&-1<e.indexOf(t,n):!!r&&-1<$s(e,t,n)},h.indexOf=function(e,t,n){var r=null==e?0:e.length;return r?(n=null==n?0:v(n),$s(e,t,n=n<0?J(r+n,0):n)):-1},h.inRange=function(e,t,n){return t=xi(t),n===Uo?(n=t,t=0):n=xi(n),(e=e=Mi(e))>=Q(t=t,n=n)&&e<J(t,n)},h.invoke=Hi,h.isArguments=si,h.isArray=L,h.isArrayBuffer=ci,h.isArrayLike=ui,h.isArrayLikeObject=li,h.isBoolean=function(e){return!0===e||!1===e||vi(e)&&Ze(e)==ia},h.isBuffer=di,h.isDate=c,h.isElement=function(e){return vi(e)&&1===e.nodeType&&!_i(e)},h.isEmpty=function(e){if(null==e)return!0;if(ui(e)&&(L(e)||"string"==typeof e||"function"==typeof e.splice||di(e)||ki(e)||si(e)))return!e.length;var t,n=zn(e);if(n==ua||n==ha)return!e.size;if(Qn(e))return!lt(e).length;for(t in e)if(N.call(e,t))return!1;return!0},h.isEqual=function(e,t){return at(e,t)},h.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:Uo)?n(e,t):Uo;return r===Uo?at(e,t,Uo,n):!!r},h.isError=fi,h.isFinite=function(e){return"number"==typeof e&&Y(e)},h.isFunction=pi,h.isInteger=hi,h.isLength=mi,h.isMap=yi,h.isMatch=function(e,t){return e===t||st(e,t,$n(t))},h.isMatchWith=function(e,t,n){return n="function"==typeof n?n:Uo,st(e,t,$n(t),n)},h.isNaN=function(e){return bi(e)&&e!=+e},h.isNative=function(e){if(Jn(e))throw new r("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ct(e)},h.isNil=function(e){return null==e},h.isNull=function(e){return null===e},h.isNumber=bi,h.isObject=gi,h.isObjectLike=vi,h.isPlainObject=_i,h.isRegExp=wi,h.isSafeInteger=function(e){return hi(e)&&-Xo<=e&&e<=Xo},h.isSet=Si,h.isString=Ei,h.isSymbol=Ai,h.isTypedArray=ki,h.isUndefined=function(e){return e===Uo},h.isWeakMap=function(e){return vi(e)&&zn(e)==va},h.isWeakSet=function(e){return vi(e)&&"[object WeakSet]"==Ze(e)},h.join=function(e,t){return null==e?"":G.call(e,t)},h.kebabCase=io,h.last=vr,h.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;if(n!==Uo&&(i=(i=v(n))<0?J(r+i,0):Q(i,r-1)),t!=t)return Ls(e,Us,i,!0);for(var o=e,a=t,s=i+1;s--;)if(o[s]===a)return s;return s},h.lowerCase=oo,h.lowerFirst=ao,h.lt=Ti,h.lte=Ci,h.max=function(e){return e&&e.length?Ve(e,yo,et):Uo},h.maxBy=function(e,t){return e&&e.length?Ve(e,s(t,2),et):Uo},h.mean=function(e){return Fs(e,yo)},h.meanBy=function(e,t){return Fs(e,s(t,2))},h.min=function(e){return e&&e.length?Ve(e,yo,ft):Uo},h.minBy=function(e,t){return e&&e.length?Ve(e,s(t,2),ft):Uo},h.stubArray=Po,h.stubFalse=Mo,h.stubObject=function(){return{}},h.stubString=function(){return""},h.stubTrue=function(){return!0},h.multiply=Lo,h.nth=function(e,t){return e&&e.length?vt(e,v(t)):Uo},h.noConflict=function(){return Ho._===this&&(Ho._=T),this},h.noop=Eo,h.now=Wr,h.pad=function(e,t,n){e=d(e);var r=(t=v(t))?ic(e):0;return!t||t<=r?e:yn(q(t=(t-r)/2),n)+e+yn(H(t),n)},h.padEnd=function(e,t,n){e=d(e);var r=(t=v(t))?ic(e):0;return t&&r<t?e+yn(t-r,n):e},h.padStart=function(e,t,n){e=d(e);var r=(t=v(t))?ic(e):0;return t&&r<t?yn(t-r,n)+e:e},h.parseInt=function(e,t,n){return t=n||null==t?0:t&&+t,Z(d(e).replace(Wa,""),t||0)},h.random=function(e,t,n){var r;return n&&"boolean"!=typeof n&&Yn(e,t,n)&&(t=n=Uo),n===Uo&&("boolean"==typeof t?(n=t,t=Uo):"boolean"==typeof e&&(n=e,e=Uo)),e===Uo&&t===Uo?(e=0,t=1):(e=xi(e),t===Uo?(t=e,e=0):t=xi(t)),t<e&&(r=e,e=t,t=r),n||e%1||t%1?(r=ee(),Q(e+r*(t-e+ms("1e-"+((r+"").length-1))),t)):St(e,t)},h.reduce=function(e,t,n){var r=L(e)?Rs:Vs,i=arguments.length<3;return r(e,s(t,4),n,i,Ue)},h.reduceRight=function(e,t,n){var r=L(e)?js:Vs,i=arguments.length<3;return r(e,s(t,4),n,i,Fe)},h.repeat=function(e,t,n){return t=(n?Yn(e,t,n):t===Uo)?1:v(t),Et(d(e),t)},h.replace=function(){var e=arguments,t=d(e[0]);return e.length<3?t:t.replace(e[1],e[2])},h.result=function(e,t,n){var r=-1,i=(t=qt(t,e)).length;for(i||(i=1,e=Uo);++r<i;){var o=null==e?Uo:e[lr(t[r])];o===Uo&&(r=i,o=n),e=pi(o)?o.call(e):o}return e},h.round=$o,h.runInContext=t,h.sample=function(e){return(L(e)?ke:At)(e)},h.size=function(e){if(null==e)return 0;if(ui(e))return Ei(e)?ic(e):e.length;var t=zn(e);return t==ua||t==ha?e.size:lt(e).length},h.snakeCase=so,h.some=function(e,t,n){return(L(e)?Ds:Pt)(e,s(t=n&&Yn(e,t,n)?Uo:t,3))},h.sortedIndex=function(e,t){return Mt(e,t)},h.sortedIndexBy=function(e,t,n){return Ot(e,t,s(n,2))},h.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Mt(e,t);if(r<n&&ii(e[r],t))return r}return-1},h.sortedLastIndex=function(e,t){return Mt(e,t,!0)},h.sortedLastIndexBy=function(e,t,n){return Ot(e,t,s(n,2),!0)},h.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Mt(e,t,!0)-1;if(ii(e[n],t))return n}return-1},h.startCase=co,h.startsWith=function(e,t,n){return e=d(e),n=null==n?0:De(v(n),0,e.length),t=Dt(t),e.slice(n,n+t.length)==t},h.subtract=Bo,h.sum=function(e){return e&&e.length?Hs(e,yo):0},h.sumBy=function(e,t){return e&&e.length?Hs(e,s(t,2)):0},h.template=function(a,e,t){var s,c,n=h.templateSettings;t&&Yn(a,e,t)&&(e=Uo),a=d(a),e=Di({},e,n,Cn);var r=qi(t=Di({},e.imports,n.imports,Cn)),i=Ws(t,r),u=0,n=e.interpolate||ss,l="__p += '",t=p((e.escape||ss).source+"|"+n.source+"|"+(n===$a?Za:ss).source+"|"+(e.evaluate||ss).source+"|$","g"),o="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++hs+"]")+"\n";if(a.replace(t,function(e,t,n,r,i,o){return n=n||r,l+=a.slice(u,o).replace(cs,Xs),t&&(s=!0,l+="' +\n__e("+t+") +\n'"),i&&(c=!0,l+="';\n"+i+";\n__p += '"),n&&(l+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=o+e.length,e}),l+="';\n",(n=e.variable)||(l="with (obj) {\n"+l+"\n}\n"),l=(c?l.replace(xa,""):l).replace(Pa,"$1").replace(Ma,"$1;"),l="function("+(n||"obj")+") {\n"+(n?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}",(t=po(function(){return f(r,o+"return "+l).apply(Uo,i)})).source=l,fi(t))throw t;return t},h.times=function(e,t){if((e=v(e))<1||Xo<e)return[];for(var n=ea,r=Q(e,ea),r=(t=s(t),e-=ea,qs(r,t));++n<e;)t(n);return r},h.toFinite=xi,h.toInteger=v,h.toLength=Pi,h.toLower=function(e){return d(e).toLowerCase()},h.toNumber=Mi,h.toSafeInteger=function(e){return e?De(v(e),-Xo,Xo):0===e?e:0},h.toString=d,h.toUpper=function(e){return d(e).toUpperCase()},h.trim=function(e,t,n){return(e=d(e))&&(n||t===Uo)?e.replace(qa,""):e&&(t=Dt(t))?(n=oc(e),e=oc(t),Yt(n,Gs(n,e),Ks(n,e)+1).join("")):e},h.trimEnd=function(e,t,n){return(e=d(e))&&(n||t===Uo)?e.replace(Ya,""):e&&(t=Dt(t))?Yt(n=oc(e),0,Ks(n,oc(t))+1).join(""):e},h.trimStart=function(e,t,n){return(e=d(e))&&(n||t===Uo)?e.replace(Wa,""):e&&(t=Dt(t))?Yt(n=oc(e),Gs(n,oc(t))).join(""):e},h.truncate=function(e,t){var n,r=30,i="...",t=(gi(t)&&(n="separator"in t?t.separator:n,r="length"in t?v(t.length):r,i="omission"in t?Dt(t.omission):i),(e=d(e)).length);if((t=Zs(e)?(o=oc(e)).length:t)<=r)return e;if((t=r-ic(i))<1)return i;var o,r=o?Yt(o,0,t).join(""):e.slice(0,t);if(n===Uo)return r+i;if(o&&(t+=r.length-t),wi(n)){if(e.slice(t).search(n)){var a,s=r;for((n=n.global?n:p(n.source,d(es.exec(n))+"g")).lastIndex=0;a=n.exec(s);)var c=a.index;r=r.slice(0,c===Uo?t:c)}}else e.indexOf(Dt(n),t)==t||-1<(o=r.lastIndexOf(n))&&(r=r.slice(0,o));return r+i},h.unescape=function(e){return(e=d(e))&&ja.test(e)?e.replace(Oa,ac):e},h.uniqueId=function(e){var t=++w;return d(e)+t},h.upperCase=uo,h.upperFirst=lo,h.each=$r,h.eachRight=Br,h.first=gr,So(h,(No={},Ge(h,function(e,t){N.call(h.prototype,t)||(No[t]=e)}),No),{chain:!1}),h.VERSION="4.17.4",Wo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){h[e].placeholder=h}),Wo(["drop","take"],function(n,r){g.prototype[n]=function(e){e=e===Uo?1:J(v(e),0);var t=this.__filtered__&&!r?new g(this):this.clone();return t.__filtered__?t.__takeCount__=Q(e,t.__takeCount__):t.__views__.push({size:Q(e,ea),type:n+(t.__dir__<0?"Right":"")}),t},g.prototype[n+"Right"]=function(e){return this.reverse()[n](e).reverse()}}),Wo(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;g.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:s(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Wo(["head","last"],function(e,t){var n="take"+(t?"Right":"");g.prototype[e]=function(){return this[n](1).value()[0]}}),Wo(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");g.prototype[e]=function(){return this.__filtered__?new g(this):this[n](1)}}),g.prototype.compact=function(){return this.filter(yo)},g.prototype.find=function(e){return this.filter(e).head()},g.prototype.findLast=function(e){return this.reverse().find(e)},g.prototype.invokeMap=a(function(t,n){return"function"==typeof t?new g(this):this.map(function(e){return it(e,t,n)})}),g.prototype.reject=function(e){return this.filter(ei(s(e)))},g.prototype.slice=function(e,t){e=v(e);var n=this;return n.__filtered__&&(0<e||t<0)?new g(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==Uo?(t=v(t))<0?n.dropRight(-t):n.take(t-e):n)},g.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},g.prototype.toArray=function(){return this.take(ea)},Ge(g.prototype,function(u,e){var l=/^(?:filter|find|map|reject)|While$/.test(e),d=/^(?:head|last)$/.test(e),f=h[d?"take"+("last"==e?"Right":""):e],p=d||/^find/.test(e);f&&(h.prototype[e]=function(){function e(e){return e=f.apply(h,Os([e],r)),d&&s?e[0]:e}var t,n=this.__wrapped__,r=d?[1]:arguments,i=n instanceof g,o=r[0],a=i||L(n),s=(a&&l&&"function"==typeof o&&1!=o.length&&(i=a=!1),this.__chain__),o=!!this.__actions__.length,c=p&&!s,i=i&&!o;return!p&&a?(n=i?n:new g(this),(t=u.apply(n,r)).__actions__.push({func:Rr,args:[e],thisArg:Uo}),new ye(t,s)):c&&i?u.apply(this,r):(t=this.thru(e),c?d?t.value()[0]:t.value():t)})}),Wo(["pop","push","shift","sort","splice","unshift"],function(e){var n=o[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);h.prototype[e]=function(){var e,t=arguments;return i&&!this.__chain__?(e=this.value(),n.apply(L(e)?e:[],t)):this[r](function(e){return n.apply(L(e)?e:[],t)})}}),Ge(g.prototype,function(e,t){var n,r=h[t];r&&(n=r.name+"",(se[n]||(se[n]=[])).push({name:t,func:r}))}),se[hn(Uo,2).name]=[{name:"wrapper",func:Uo}],g.prototype.clone=function(){var e=new g(this.__wrapped__);return e.__actions__=tn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=tn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=tn(this.__views__),e},g.prototype.reverse=function(){var e;return this.__filtered__?((e=new g(this)).__dir__=-1,e.__filtered__=!0):(e=this.clone()).__dir__*=-1,e},g.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=L(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Q(t,e+a);break;case"takeRight":e=J(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),l=o.start,a=(o=o.end)-l,d=r?o:l-1,f=this.__iteratees__,p=f.length,h=0,m=Q(a,this.__takeCount__);if(!n||!r&&i==a&&m==a)return Ut(e,this.__actions__);var g=[];e:for(;a--&&h<m;){for(var v=-1,s=e[d+=t];++v<p;){var c=f[v],u=c.iteratee,c=c.type,u=u(s);if(2==c)s=u;else if(!u){if(1==c)continue e;break e}}g[h++]=s}return g},h.prototype.at=jr,h.prototype.chain=function(){return Or(this)},h.prototype.commit=function(){return new ye(this.value(),this.__chain__)},h.prototype.next=function(){this.__values__===Uo&&(this.__values__=Ii(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?Uo:this.__values__[this.__index__++]}},h.prototype.plant=function(e){for(var t,n=this;n instanceof ve;)var r=fr(n),i=(r.__index__=0,r.__values__=Uo,t?i.__wrapped__=r:t=r,r),n=n.__wrapped__;return i.__wrapped__=e,t},h.prototype.reverse=function(){var e=this.__wrapped__;return e instanceof g?(e=e,(e=(e=this.__actions__.length?new g(this):e).reverse()).__actions__.push({func:Rr,args:[_r],thisArg:Uo}),new ye(e,this.__chain__)):this.thru(_r)},h.prototype.toJSON=h.prototype.valueOf=h.prototype.value=function(){return Ut(this.__wrapped__,this.__actions__)},h.prototype.first=h.prototype.head,D&&(h.prototype[D]=function(){return this}),h}();("function"!=typeof Uo||"object"!=typeof Uo.amd||!Uo.amd)&&c?((c.exports=sc)._=sc,h._=sc):Ho._=sc}.call(x)}),b=[],_=0;_<256;++_)b[_]=(_+256).toString(16).substr(1);var w=function(e,t){return t=t||0,b[e[t++]]+b[e[t++]]+b[e[t++]]+b[e[t++]]+"-"+b[e[t++]]+b[e[t++]]+"-"+b[e[t++]]+b[e[t++]]+"-"+b[e[t++]]+b[e[t++]]+"-"+b[e[t++]]+b[e[t++]]+b[e[t++]]+b[e[t++]]+b[e[t++]]+b[e[+t]]};var S,E=function(e,t,n){var r=t&&n||0,i=("string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),(e=e||{}).random||(e.rng||function(){return g.randomBytes(16)})());if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||w(i)};function p(){return S.apply(null,arguments)}function A(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function k(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function T(e){return void 0===e}function C(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function I(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function P(e,t){for(var n=[],r=0;r<e.length;++r)n.push(t(e[r],r));return n}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function O(e,t){for(var n in t)M(t,n)&&(e[n]=t[n]);return M(t,"toString")&&(e.toString=t.toString),M(t,"valueOf")&&(e.valueOf=t.valueOf),e}function R(e,t,n,r){return Ht(e,t,n,r,!0).utc()}function j(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function D(e){if(null==e._isValid){var t=j(e),n=L.call(t.parsedDateParts,function(e){return null!=e}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function N(e){var t=R(NaN);return null!=e?O(j(t),e):j(t).userInvalidated=!0,t}var L=Array.prototype.some||function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1},$=p.momentProperties=[];function B(e,t){var n,r,i;if(T(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),T(t._i)||(e._i=t._i),T(t._f)||(e._f=t._f),T(t._l)||(e._l=t._l),T(t._strict)||(e._strict=t._strict),T(t._tzm)||(e._tzm=t._tzm),T(t._isUTC)||(e._isUTC=t._isUTC),T(t._offset)||(e._offset=t._offset),T(t._pf)||(e._pf=j(t)),T(t._locale)||(e._locale=t._locale),0<$.length)for(n=0;n<$.length;n++)T(i=t[r=$[n]])||(e[r]=i);return e}var U=!1;function F(e){B(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===U&&(U=!0,p.updateOffset(this),U=!1)}function z(e){return e instanceof F||null!=e&&null!=e._isAMomentObject}function V(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function H(e){var e=+e,t=0;return t=0!=e&&isFinite(e)?V(e):t}function q(e,t,n){for(var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,a=0;a<r;a++)(n&&e[a]!==t[a]||!n&&H(e[a])!==H(t[a]))&&o++;return o+i}function W(i,o){var a=!0;return O(function(){if(null!=p.deprecationHandler&&p.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var r in e+="\n["+n+"] ",arguments[0])e+=r+": "+arguments[0][r]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Array.prototype.slice.call(t).join(""),(new Error).stack,a=!1}return o.apply(this,arguments)},o)}var Y={};function G(e,t){null!=p.deprecationHandler&&p.deprecationHandler(e,t),Y[e]||(Y[e]=!0)}function K(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function J(e,t){var n,r=O({},e);for(n in t)M(t,n)&&(k(e[n])&&k(t[n])?(r[n]={},O(r[n],e[n]),O(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)M(e,n)&&!M(t,n)&&k(e[n])&&(r[n]=O({},r[n]));return r}function Q(e){null!=e&&this.set(e)}p.suppressDeprecationWarnings=!1,p.deprecationHandler=null;var X=Object.keys||function(e){var t,n=[];for(t in e)M(e,t)&&n.push(t);return n};var Z={};function ee(e,t){var n=e.toLowerCase();Z[n]=Z[n+"s"]=Z[t]=e}function te(e){return"string"==typeof e?Z[e]||Z[e.toLowerCase()]:void 0}function ne(e){var t,n,r={};for(n in e)M(e,n)&&(t=te(n))&&(r[t]=e[n]);return r}var re={};function ie(e,t){re[e]=t}function oe(e,t,n){var r=""+Math.abs(e);return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,t-r.length)).toString().substr(1)+r}var ae=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,se=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ce={},ue={};function r(e,t,n,r){var i="string"==typeof r?function(){return this[r]()}:r;e&&(ue[e]=i),t&&(ue[t[0]]=function(){return oe(i.apply(this,arguments),t[1],t[2])}),n&&(ue[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function le(e,t){return e.isValid()?(t=de(t,e.localeData()),ce[t]=ce[t]||function(r){for(var e,i=r.match(ae),t=0,o=i.length;t<o;t++)ue[i[t]]?i[t]=ue[i[t]]:i[t]=(e=i[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){for(var t="",n=0;n<o;n++)t+=K(i[n])?i[n].call(e,r):i[n];return t}}(t),ce[t](e)):e.localeData().invalidDate()}function de(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(se.lastIndex=0;0<=n&&se.test(e);)e=e.replace(se,r),se.lastIndex=0,--n;return e}var e=/\d/,t=/\d\d/,fe=/\d{3}/,pe=/\d{4}/,he=/[+-]?\d{6}/,me=/\d\d?/,ge=/\d\d\d\d?/,ve=/\d\d\d\d\d\d?/,ye=/\d{1,3}/,be=/\d{1,4}/,_e=/[+-]?\d{1,6}/,we=/\d+/,Se=/[+-]?\d+/,Ee=/Z|[+-]\d\d:?\d\d/gi,Ae=/Z|[+-]\d\d(?::?\d\d)?/gi,ke=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Te={};function n(e,n,r){Te[e]=K(n)?n:function(e,t){return e&&r?r:n}}function Ce(e,t){return M(Te,e)?Te[e](t._strict,t._locale):new RegExp(Ie(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})))}function Ie(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var xe={};function Pe(e,n){var t,r=n;for("string"==typeof e&&(e=[e]),C(n)&&(r=function(e,t){t[n]=H(e)}),t=0;t<e.length;t++)xe[e[t]]=r}function Me(e,i){Pe(e,function(e,t,n,r){n._w=n._w||{},i(e,n._w,n,r)})}var Oe=0,Re=1,je=2,De=3,Ne=4,Le=5,$e=6,Be=7,Ue=8;function Fe(e){return ze(e)?366:365}function ze(e){return e%4==0&&e%100!=0||e%400==0}r("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),r(0,["YY",2],0,function(){return this.year()%100}),r(0,["YYYY",4],0,"year"),r(0,["YYYYY",5],0,"year"),r(0,["YYYYYY",6,!0],0,"year"),ee("year","y"),ie("year",1),n("Y",Se),n("YY",me,t),n("YYYY",be,pe),n("YYYYY",_e,he),n("YYYYYY",_e,he),Pe(["YYYYY","YYYYYY"],Oe),Pe("YYYY",function(e,t){t[Oe]=2===e.length?p.parseTwoDigitYear(e):H(e)}),Pe("YY",function(e,t){t[Oe]=p.parseTwoDigitYear(e)}),Pe("Y",function(e,t){t[Oe]=parseInt(e,10)}),p.parseTwoDigitYear=function(e){return H(e)+(68<H(e)?1900:2e3)};var Ve,He=qe("FullYear",!0);function qe(t,n){return function(e){return null!=e?(Ye(this,t,e),p.updateOffset(this,n),this):We(this,t)}}function We(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ye(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ze(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Ge(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Ge(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=(t%(n=12)+n)%n;return e+=(t-n)/12,1==n?ze(e)?29:28:31-n%7%2}Ve=Array.prototype.indexOf||function(e){for(var t=0;t<this.length;++t)if(this[t]===e)return t;return-1},r("M",["MM",2],"Mo",function(){return this.month()+1}),r("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),r("MMMM",0,0,function(e){return this.localeData().months(this,e)}),ee("month","M"),ie("month",8),n("M",me),n("MM",me,t),n("MMM",function(e,t){return t.monthsShortRegex(e)}),n("MMMM",function(e,t){return t.monthsRegex(e)}),Pe(["M","MM"],function(e,t){t[Re]=H(e)-1}),Pe(["MMM","MMMM"],function(e,t,n,r){r=n._locale.monthsParse(e,r,n._strict);null!=r?t[Re]=r:j(n).invalidMonth=e});var Ke=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Je="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Qe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Xe(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=H(t);else if(!C(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Ge(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Ze(e){return null!=e?(Xe(this,e),p.updateOffset(this,!0),this):We(this,"Month")}var et=ke;var tt=ke;function nt(){function e(e,t){return t.length-e.length}for(var t,n=[],r=[],i=[],o=0;o<12;o++)t=R([2e3,o]),n.push(this.monthsShort(t,"")),r.push(this.months(t,"")),i.push(this.months(t,"")),i.push(this.monthsShort(t,""));for(n.sort(e),r.sort(e),i.sort(e),o=0;o<12;o++)n[o]=Ie(n[o]),r[o]=Ie(r[o]);for(o=0;o<24;o++)i[o]=Ie(i[o]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function rt(e,t,n,r,i,o,a){t=new Date(e,t,n,r,i,o,a);return e<100&&0<=e&&isFinite(t.getFullYear())&&t.setFullYear(e),t}function it(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ot(e,t,n){n=7+t-n;return n-(7+it(e,0,n).getUTCDay()-t)%7-1}function at(e,t,n,r,i){var o,t=1+7*(t-1)+(7+n-r)%7+ot(e,r,i),n=t<=0?Fe(o=e-1)+t:t>Fe(e)?(o=e+1,t-Fe(e)):(o=e,t);return{year:o,dayOfYear:n}}function st(e,t,n){var r,i,o=ot(e.year(),t,n),o=Math.floor((e.dayOfYear()-o-1)/7)+1;return o<1?r=o+ct(i=e.year()-1,t,n):o>ct(e.year(),t,n)?(r=o-ct(e.year(),t,n),i=e.year()+1):(i=e.year(),r=o),{week:r,year:i}}function ct(e,t,n){var r=ot(e,t,n),t=ot(e+1,t,n);return(Fe(e)-r+t)/7}r("w",["ww",2],"wo","week"),r("W",["WW",2],"Wo","isoWeek"),ee("week","w"),ee("isoWeek","W"),ie("week",5),ie("isoWeek",5),n("w",me),n("ww",me,t),n("W",me),n("WW",me,t),Me(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=H(e)});r("d",0,"do","day"),r("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),r("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),r("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),r("e",0,0,"weekday"),r("E",0,0,"isoWeekday"),ee("day","d"),ee("weekday","e"),ee("isoWeekday","E"),ie("day",11),ie("weekday",11),ie("isoWeekday",11),n("d",me),n("e",me),n("E",me),n("dd",function(e,t){return t.weekdaysMinRegex(e)}),n("ddd",function(e,t){return t.weekdaysShortRegex(e)}),n("dddd",function(e,t){return t.weekdaysRegex(e)}),Me(["dd","ddd","dddd"],function(e,t,n,r){r=n._locale.weekdaysParse(e,r,n._strict);null!=r?t.d=r:j(n).invalidWeekday=e}),Me(["d","e","E"],function(e,t,n,r){t[r]=H(e)});var ut="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var lt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var dt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var ft=ke;var pt=ke;var ht=ke;function mt(){function e(e,t){return t.length-e.length}for(var t,n,r,i=[],o=[],a=[],s=[],c=0;c<7;c++)r=R([2e3,1]).day(c),t=this.weekdaysMin(r,""),n=this.weekdaysShort(r,""),r=this.weekdays(r,""),i.push(t),o.push(n),a.push(r),s.push(t),s.push(n),s.push(r);for(i.sort(e),o.sort(e),a.sort(e),s.sort(e),c=0;c<7;c++)o[c]=Ie(o[c]),a[c]=Ie(a[c]),s[c]=Ie(s[c]);this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function gt(){return this.hours()%12||12}function vt(e,t){r(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function yt(e,t){return t._meridiemParse}r("H",["HH",2],0,"hour"),r("h",["hh",2],0,gt),r("k",["kk",2],0,function(){return this.hours()||24}),r("hmm",0,0,function(){return""+gt.apply(this)+oe(this.minutes(),2)}),r("hmmss",0,0,function(){return""+gt.apply(this)+oe(this.minutes(),2)+oe(this.seconds(),2)}),r("Hmm",0,0,function(){return""+this.hours()+oe(this.minutes(),2)}),r("Hmmss",0,0,function(){return""+this.hours()+oe(this.minutes(),2)+oe(this.seconds(),2)}),vt("a",!0),vt("A",!1),ee("hour","h"),ie("hour",13),n("a",yt),n("A",yt),n("H",me),n("h",me),n("k",me),n("HH",me,t),n("hh",me,t),n("kk",me,t),n("hmm",ge),n("hmmss",ve),n("Hmm",ge),n("Hmmss",ve),Pe(["H","HH"],De),Pe(["k","kk"],function(e,t,n){e=H(e);t[De]=24===e?0:e}),Pe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),Pe(["h","hh"],function(e,t,n){t[De]=H(e),j(n).bigHour=!0}),Pe("hmm",function(e,t,n){var r=e.length-2;t[De]=H(e.substr(0,r)),t[Ne]=H(e.substr(r)),j(n).bigHour=!0}),Pe("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[De]=H(e.substr(0,r)),t[Ne]=H(e.substr(r,2)),t[Le]=H(e.substr(i)),j(n).bigHour=!0}),Pe("Hmm",function(e,t,n){var r=e.length-2;t[De]=H(e.substr(0,r)),t[Ne]=H(e.substr(r))}),Pe("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[De]=H(e.substr(0,r)),t[Ne]=H(e.substr(r,2)),t[Le]=H(e.substr(i))});var bt,ke=qe("Hours",!0),_t={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Je,monthsShort:Qe,week:{dow:0,doy:6},weekdays:ut,weekdaysMin:dt,weekdaysShort:lt,meridiemParse:/[ap]\.?m?\.?/i},wt={},St={};function Et(e){return e&&e.toLowerCase().replace("_","-")}function At(e){if(!wt[e]&&void 0!==xs&&xs&&xs.exports)try{var t=bt._abbr;Is("./locale/"+e),kt(t)}catch(e){}return wt[e]}function kt(e,t){var n;return(bt=e&&(n=T(t)?Ct(e):Tt(e,t))?n:bt)._abbr}function Tt(e,t){if(null===t)return delete wt[e],null;var n=_t;if(t.abbr=e,null!=wt[e])G("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=wt[e]._config;else if(null!=t.parentLocale){if(null==wt[t.parentLocale])return St[t.parentLocale]||(St[t.parentLocale]=[]),St[t.parentLocale].push({name:e,config:t}),null;n=wt[t.parentLocale]._config}return wt[e]=new Q(J(n,t)),St[e]&&St[e].forEach(function(e){Tt(e.name,e.config)}),kt(e),wt[e]}function Ct(e){var t;if(!(e=e&&e._locale&&e._locale._abbr?e._locale._abbr:e))return bt;if(!A(e)){if(t=At(e))return t;e=[e]}for(var n,r,i,o,a=e,s=0;s<a.length;){for(n=(o=Et(a[s]).split("-")).length,r=(r=Et(a[s+1]))?r.split("-"):null;0<n;){if(i=At(o.slice(0,n).join("-")))return i;if(r&&r.length>=n&&q(o,r,!0)>=n-1)break;n--}s++}return null}function It(e){var t=e._a;return t&&-2===j(e).overflow&&(t=t[Re]<0||11<t[Re]?Re:t[je]<1||t[je]>Ge(t[Oe],t[Re])?je:t[De]<0||24<t[De]||24===t[De]&&(0!==t[Ne]||0!==t[Le]||0!==t[$e])?De:t[Ne]<0||59<t[Ne]?Ne:t[Le]<0||59<t[Le]?Le:t[$e]<0||999<t[$e]?$e:-1,j(e)._overflowDayOfYear&&(t<Oe||je<t)&&(t=je),j(e)._overflowWeeks&&-1===t&&(t=Be),j(e)._overflowWeekday&&-1===t&&(t=Ue),j(e).overflow=t),e}function xt(e,t,n){return null!=e?e:null!=t?t:n}function Pt(e){var t,l,n,r,i,o,a,s,d,c,u,f=[];if(!e._d){for(n=e,r=new Date(p.now()),l=n._useUTC?[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()],e._w&&null==e._a[je]&&null==e._a[Re]&&(null!=(r=(n=e)._w).GG||null!=r.W||null!=r.E?(s=1,d=4,i=xt(r.GG,n._a[Oe],st(qt(),1,4).year),o=xt(r.W,1),((a=xt(r.E,1))<1||7<a)&&(c=!0)):(s=n._locale._week.dow,d=n._locale._week.doy,u=st(qt(),s,d),i=xt(r.gg,n._a[Oe],u.year),o=xt(r.w,u.week),null!=r.d?((a=r.d)<0||6<a)&&(c=!0):null!=r.e?(a=r.e+s,(r.e<0||6<r.e)&&(c=!0)):a=s),o<1||o>ct(i,s,d)?j(n)._overflowWeeks=!0:null!=c?j(n)._overflowWeekday=!0:(u=at(i,o,a,s,d),n._a[Oe]=u.year,n._dayOfYear=u.dayOfYear)),null!=e._dayOfYear&&(r=xt(e._a[Oe],l[Oe]),(e._dayOfYear>Fe(r)||0===e._dayOfYear)&&(j(e)._overflowDayOfYear=!0),c=it(r,0,e._dayOfYear),e._a[Re]=c.getUTCMonth(),e._a[je]=c.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=f[t]=l[t];for(;t<7;t++)e._a[t]=f[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[De]&&0===e._a[Ne]&&0===e._a[Le]&&0===e._a[$e]&&(e._nextDay=!0,e._a[De]=0),e._d=(e._useUTC?it:rt).apply(null,f),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[De]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(j(e).weekdayMismatch=!0)}}var Mt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ot=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Rt=/Z|[+-]\d\d(?::?\d\d)?/,jt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Dt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Nt=/^\/?Date\((\-?\d+)/i;function Lt(e){var t,n,r,i,o,a,s=e._i,c=Mt.exec(s)||Ot.exec(s);if(c){for(j(e).iso=!0,t=0,n=jt.length;t<n;t++)if(jt[t][1].exec(c[1])){i=jt[t][0],r=!1!==jt[t][2];break}if(null!=i){if(c[3]){for(t=0,n=Dt.length;t<n;t++)if(Dt[t][1].exec(c[3])){o=(c[2]||" ")+Dt[t][0];break}if(null==o)return void(e._isValid=!1)}if(r||null==o){if(c[4]){if(!Rt.exec(c[4]))return void(e._isValid=!1);a="Z"}e._f=i+(o||"")+(a||""),zt(e)}else e._isValid=!1}else e._isValid=!1}else e._isValid=!1}var $t=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Bt(e,t,n,r,i,o){e=[function(e){e=parseInt(e,10);{if(e<=49)return 2e3+e;if(e<=999)return 1900+e}return e}(e),Qe.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&e.push(parseInt(o,10)),e}var Ut={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ft(e){var t,n,r,i,o=$t.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());o?(t=Bt(o[4],o[3],o[2],o[5],o[6],o[7]),n=o[1],r=t,i=e,n&&lt.indexOf(n)!==new Date(r[0],r[1],r[2]).getDay()?(j(i).weekdayMismatch=!0,i._isValid=!1):(e._a=t,e._tzm=(n=o[8],r=o[9],i=o[10],n?Ut[n]:r?0:60*(((n=parseInt(i,10))-(r=n%100))/100)+r),e._d=it.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),j(e).rfc2822=!0)):e._isValid=!1}function zt(e){if(e._f!==p.ISO_8601)if(e._f!==p.RFC_2822){e._a=[],j(e).empty=!0;for(var t,n,r,i,o,a=""+e._i,l=a.length,s=0,c=de(e._f,e._locale).match(ae)||[],u=0;u<c.length;u++)n=c[u],(t=(a.match(Ce(n,e))||[])[0])&&(0<(r=a.substr(0,a.indexOf(t))).length&&j(e).unusedInput.push(r),a=a.slice(a.indexOf(t)+t.length),s+=t.length),ue[n]?(t?j(e).empty=!1:j(e).unusedTokens.push(n),r=n,o=e,null!=(i=t)&&M(xe,r)&&xe[r](i,o._a,o,r)):e._strict&&!t&&j(e).unusedTokens.push(n);j(e).charsLeftOver=l-s,0<a.length&&j(e).unusedInput.push(a),e._a[De]<=12&&!0===j(e).bigHour&&0<e._a[De]&&(j(e).bigHour=void 0),j(e).parsedDateParts=e._a.slice(0),j(e).meridiem=e._meridiem,e._a[De]=function(e,t,n){if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((e=e.isPM(n))&&t<12&&(t+=12),t=e||12!==t?t:0):t}(e._locale,e._a[De],e._meridiem),Pt(e),It(e)}else Ft(e);else Lt(e)}function Vt(e){var t,n,r=e._i,i=e._f;if(e._locale=e._locale||Ct(e._l),null===r||void 0===i&&""===r)return N({nullInput:!0});if("string"==typeof r&&(e._i=r=e._locale.preparse(r)),z(r))return new F(It(r));if(I(r))e._d=r;else if(A(i))!function(e){var t,n,r,i,o;if(0===e._f.length)return j(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)o=0,t=B({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],zt(t),D(t)&&(o=(o+=j(t).charsLeftOver)+10*j(t).unusedTokens.length,j(t).score=o,(null==r||o<r)&&(r=o,n=t));O(e,n||t)}(e);else if(i)zt(e);else if(T(i=(r=e)._i))r._d=new Date(p.now());else I(i)?r._d=new Date(i.valueOf()):"string"==typeof i?(t=r,null===(n=Nt.exec(t._i))?(Lt(t),!1===t._isValid&&(delete t._isValid,Ft(t),!1===t._isValid&&(delete t._isValid,p.createFromInputFallback(t)))):t._d=new Date(+n[1])):A(i)?(r._a=P(i.slice(0),function(e){return parseInt(e,10)}),Pt(r)):k(i)?(t=r)._d||(n=ne(t._i),t._a=P([n.year,n.month,n.day||n.date,n.hour,n.minute,n.second,n.millisecond],function(e){return e&&parseInt(e,10)}),Pt(t)):C(i)?r._d=new Date(i):p.createFromInputFallback(r);return D(e)||(e._d=null),e}function Ht(e,t,n,r,i){var o={};return!0!==n&&!1!==n||(r=n,n=void 0),(k(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;for(var t in e)if(e.hasOwnProperty(t))return;return 1}(e)||A(e)&&0===e.length)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=e,o._f=t,o._strict=r,(i=new F(It(Vt(i=o))))._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function qt(e,t,n,r){return Ht(e,t,n,r,!1)}p.createFromInputFallback=W("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),p.ISO_8601=function(){},p.RFC_2822=function(){};ge=W("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:N()}),ve=W("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:N()});function Wt(e,t){var n,r;if(!(t=1===t.length&&A(t[0])?t[0]:t).length)return qt();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}var Yt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Gt(e){var e=ne(e),t=e.year||0,n=e.quarter||0,r=e.month||0,i=e.week||0,o=e.day||0,a=e.hour||0,s=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Ve.call(Yt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<Yt.length;++r)if(e[Yt[r]]){if(n)return!1;parseFloat(e[Yt[r]])!==H(e[Yt[r]])&&(n=!0)}return!0}(e),this._milliseconds=+u+1e3*c+6e4*s+1e3*a*60*60,this._days=+o+7*i,this._months=+r+3*n+12*t,this._data={},this._locale=Ct(),this._bubble()}function Kt(e){return e instanceof Gt}function Jt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Qt(e,n){r(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+oe(~~(e/60),2)+n+oe(~~e%60,2)})}Qt("Z",":"),Qt("ZZ",""),n("Z",Ae),n("ZZ",Ae),Pe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Zt(Ae,e)});var Xt=/([\+\-]|\d\d)/gi;function Zt(e,t){t=(t||"").match(e);if(null===t)return null;e=((t[t.length-1]||[])+"").match(Xt)||["-",0,0],t=60*e[1]+H(e[2]);return 0===t?0:"+"===e[0]?t:-t}function en(e,t){var n;return t._isUTC?(t=t.clone(),n=(z(e)||I(e)?e:qt(e)).valueOf()-t.valueOf(),t._d.setTime(t._d.valueOf()+n),p.updateOffset(t,!1),t):qt(e).local()}function tn(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function nn(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}p.updateOffset=function(){};var rn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,on=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function an(e,t){var n,r=e,i=null;return Kt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:C(e)?(r={},t?r[t]=e:r.milliseconds=e):(i=rn.exec(e))?(n="-"===i[1]?-1:1,r={y:0,d:H(i[je])*n,h:H(i[De])*n,m:H(i[Ne])*n,s:H(i[Le])*n,ms:H(Jt(1e3*i[$e]))*n}):(i=on.exec(e))?(n="-"===i[1]?-1:(i[1],1),r={y:sn(i[2],n),M:sn(i[3],n),w:sn(i[4],n),d:sn(i[5],n),h:sn(i[6],n),m:sn(i[7],n),s:sn(i[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(t=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=en(t,e),e.isBefore(t)?n=cn(e,t):((n=cn(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(qt(r.from),qt(r.to)),(r={}).ms=t.milliseconds,r.M=t.months),i=new Gt(r),Kt(e)&&M(e,"_locale")&&(i._locale=e._locale),i}function sn(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}function cn(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function un(r,i){return function(e,t){var n;return null===t||isNaN(+t)||(G(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),ln(this,an(e="string"==typeof e?+e:e,t),r),this}}function ln(e,t,n,r){var i=t._milliseconds,o=Jt(t._days),t=Jt(t._months);e.isValid()&&(r=null==r||r,t&&Xe(e,We(e,"Month")+t*n),o&&Ye(e,"Date",We(e,"Date")+o*n),i&&e._d.setTime(e._d.valueOf()+i*n),r&&p.updateOffset(e,o||t))}an.fn=Gt.prototype,an.invalid=function(){return an(NaN)};Je=un(1,"add"),ut=un(-1,"subtract");function dn(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months"),t=t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(1+n,"months")-r);return-(n+t)||0}function fn(e){return void 0===e?this._locale._abbr:(null!=(e=Ct(e))&&(this._locale=e),this)}p.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",p.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";dt=W("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function pn(){return this._locale}function hn(e,t){r(0,[e,e.length],0,t)}function mn(e,t,n,r,i){var o;return null==e?st(this,r,i).year:(o=ct(e,r,i),function(e,t,n,r,i){e=at(e,t,n,r,i),t=it(e.year,0,e.dayOfYear);return this.year(t.getUTCFullYear()),this.month(t.getUTCMonth()),this.date(t.getUTCDate()),this}.call(this,e,t=o<t?o:t,n,r,i))}r(0,["gg",2],0,function(){return this.weekYear()%100}),r(0,["GG",2],0,function(){return this.isoWeekYear()%100}),hn("gggg","weekYear"),hn("ggggg","weekYear"),hn("GGGG","isoWeekYear"),hn("GGGGG","isoWeekYear"),ee("weekYear","gg"),ee("isoWeekYear","GG"),ie("weekYear",1),ie("isoWeekYear",1),n("G",Se),n("g",Se),n("GG",me,t),n("gg",me,t),n("GGGG",be,pe),n("gggg",be,pe),n("GGGGG",_e,he),n("ggggg",_e,he),Me(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=H(e)}),Me(["gg","GG"],function(e,t,n,r){t[r]=p.parseTwoDigitYear(e)}),r("Q",0,"Qo","quarter"),ee("quarter","Q"),ie("quarter",7),n("Q",e),Pe("Q",function(e,t){t[Re]=3*(H(e)-1)}),r("D",["DD",2],"Do","date"),ee("date","D"),ie("date",9),n("D",me),n("DD",me,t),n("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),Pe(["D","DD"],je),Pe("Do",function(e,t){t[je]=H(e.match(me)[0])});be=qe("Date",!0);r("DDD",["DDDD",3],"DDDo","dayOfYear"),ee("dayOfYear","DDD"),ie("dayOfYear",4),n("DDD",ye),n("DDDD",fe),Pe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=H(e)}),r("m",["mm",2],0,"minute"),ee("minute","m"),ie("minute",14),n("m",me),n("mm",me,t),Pe(["m","mm"],Ne);var gn,pe=qe("Minutes",!1),_e=(r("s",["ss",2],0,"second"),ee("second","s"),ie("second",15),n("s",me),n("ss",me,t),Pe(["s","ss"],Le),qe("Seconds",!1));for(r("S",0,0,function(){return~~(this.millisecond()/100)}),r(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),r(0,["SSS",3],0,"millisecond"),r(0,["SSSS",4],0,function(){return 10*this.millisecond()}),r(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),r(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),r(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),r(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),r(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),ee("millisecond","ms"),ie("millisecond",16),n("S",ye,e),n("SS",ye,t),n("SSS",ye,fe),gn="SSSS";gn.length<=9;gn+="S")n(gn,we);function vn(e,t){t[$e]=H(1e3*("0."+e))}for(gn="S";gn.length<=9;gn+="S")Pe(gn,vn);he=qe("Milliseconds",!1);r("z",0,0,"zoneAbbr"),r("zz",0,0,"zoneName");e=F.prototype;function yn(e){return e}e.add=Je,e.calendar=function(e,t){var n=en(e=e||qt(),this).startOf("day"),n=p.calendarFormat(this,n)||"sameElse",t=t&&(K(t[n])?t[n].call(this,e):t[n]);return this.format(t||this.localeData().calendar(n,this,qt(e)))},e.clone=function(){return new F(this)},e.diff=function(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=en(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=te(t)){case"year":o=dn(this,r)/12;break;case"month":o=dn(this,r);break;case"quarter":o=dn(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:V(o)},e.endOf=function(e){return void 0===(e=te(e))||"millisecond"===e?this:this.startOf(e="date"===e?"day":e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},e.format=function(e){return e=e||(this.isUtc()?p.defaultFormatUtc:p.defaultFormat),e=le(this,e),this.localeData().postformat(e)},e.from=function(e,t){return this.isValid()&&(z(e)&&e.isValid()||qt(e).isValid())?an({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},e.fromNow=function(e){return this.from(qt(),e)},e.to=function(e,t){return this.isValid()&&(z(e)&&e.isValid()||qt(e).isValid())?an({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},e.toNow=function(e){return this.to(qt(),e)},e.get=function(e){return K(this[e=te(e)])?this[e]():this},e.invalidAt=function(){return j(this).overflow},e.isAfter=function(e,t){return e=z(e)?e:qt(e),!(!this.isValid()||!e.isValid())&&("millisecond"===(t=te(T(t)?"millisecond":t))?this.valueOf()>e.valueOf():e.valueOf()<this.clone().startOf(t).valueOf())},e.isBefore=function(e,t){return e=z(e)?e:qt(e),!(!this.isValid()||!e.isValid())&&("millisecond"===(t=te(T(t)?"millisecond":t))?this.valueOf()<e.valueOf():this.clone().endOf(t).valueOf()<e.valueOf())},e.isBetween=function(e,t,n,r){return("("===(r=r||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))},e.isSame=function(e,t){var e=z(e)?e:qt(e);return!(!this.isValid()||!e.isValid())&&("millisecond"===(t=te(t||"millisecond"))?this.valueOf()===e.valueOf():(e=e.valueOf(),this.clone().startOf(t).valueOf()<=e&&e<=this.clone().endOf(t).valueOf()))},e.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},e.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},e.isValid=function(){return D(this)},e.lang=dt,e.locale=fn,e.localeData=pn,e.max=ve,e.min=ge,e.parsingFlags=function(){return O({},j(this))},e.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t,n=[];for(t in e)n.push({unit:t,priority:re[t]});return n.sort(function(e,t){return e.priority-t.priority}),n}(e=ne(e)),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit]);else if(K(this[e=te(e)]))return this[e](t);return this},e.startOf=function(e){switch(e=te(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},e.subtract=ut,e.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},e.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},e.toDate=function(){return new Date(this.valueOf())},e.toISOString=function(e){if(!this.isValid())return null;var t=(e=!0!==e)?this.clone().utc():this;return t.year()<0||9999<t.year()?le(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):K(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",le(t,"Z")):le(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},e.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",e=(this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z"),"["+e+'("]'),n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";return this.format(e+n+"-MM-DD[T]HH:mm:ss.SSS"+(t+'[")]'))},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},e.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},e.year=He,e.isLeapYear=function(){return ze(this.year())},e.weekYear=function(e){return mn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},e.isoWeekYear=function(e){return mn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},e.quarter=e.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},e.month=Ze,e.daysInMonth=function(){return Ge(this.year(),this.month())},e.week=e.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},e.isoWeek=e.isoWeeks=function(e){var t=st(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},e.weeksInYear=function(){var e=this.localeData()._week;return ct(this.year(),e.dow,e.doy)},e.isoWeeksInYear=function(){return ct(this.year(),1,4)},e.date=be,e.day=e.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,r=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-r,"d")):r},e.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},e.isoWeekday=function(e){return this.isValid()?null!=e?(t=e,n=this.localeData(),n="string"==typeof t?n.weekdaysParse(t)%7||7:isNaN(t)?null:t,this.day(this.day()%7?n:n-7)):this.day()||7:null!=e?this:NaN;var t,n},e.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},e.hour=e.hours=ke,e.minute=e.minutes=pe,e.second=e.seconds=_e,e.millisecond=e.milliseconds=he,e.utcOffset=function(e,t,n){var r,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?i:tn(this);if("string"==typeof e){if(null===(e=Zt(Ae,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=tn(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?ln(this,an(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,p.updateOffset(this,!0),this._changeInProgress=null)),this},e.utc=function(e){return this.utcOffset(0,e)},e.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(tn(this),"m")),this},e.parseZone=function(){var e;return null!=this._tzm?this.utcOffset(this._tzm,!1,!0):"string"==typeof this._i&&(null!=(e=Zt(Ee,this._i))?this.utcOffset(e):this.utcOffset(0,!0)),this},e.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?qt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},e.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},e.isLocal=function(){return!!this.isValid()&&!this._isUTC},e.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},e.isUtc=nn,e.isUTC=nn,e.zoneAbbr=function(){return this._isUTC?"UTC":""},e.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},e.dates=W("dates accessor is deprecated. Use date instead.",be),e.months=W("months accessor is deprecated. Use month instead",Ze),e.years=W("years accessor is deprecated. Use year instead",He),e.zone=W("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?(this.utcOffset(e="string"!=typeof e?-e:e,t),this):-this.utcOffset()}),e.isDSTShifted=W("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!T(this._isDSTShifted))return this._isDSTShifted;var e,t={};return B(t,this),(t=Vt(t))._a?(e=(t._isUTC?R:qt)(t._a),this._isDSTShifted=this.isValid()&&0<q(t._a,e.toArray())):this._isDSTShifted=!1,this._isDSTShifted});t=Q.prototype;function bn(e,t,n,r){var i=Ct(),r=R().set(r,t);return i[n](r,e)}function _n(e,t,n){if(C(e)&&(t=e,e=void 0),e=e||"",null!=t)return bn(e,t,n,"month");for(var r=[],i=0;i<12;i++)r[i]=bn(e,i,n,"month");return r}function wn(e,t,n,r){t=("boolean"==typeof e?C(t)&&(n=t,t=void 0):(t=e,e=!1,C(n=t)&&(n=t,t=void 0)),t||"");var i=Ct(),o=e?i._week.dow:0;if(null!=n)return bn(t,(n+o)%7,r,"day");for(var a=[],s=0;s<7;s++)a[s]=bn(t,(s+o)%7,r,"day");return a}t.calendar=function(e,t,n){return K(e=this._calendar[e]||this._calendar.sameElse)?e.call(t,n):e},t.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},t.invalidDate=function(){return this._invalidDate},t.ordinal=function(e){return this._ordinal.replace("%d",e)},t.preparse=yn,t.postformat=yn,t.relativeTime=function(e,t,n,r){var i=this._relativeTime[n];return K(i)?i(e,t,n,r):i.replace(/%d/i,e)},t.pastFuture=function(e,t){return K(e=this._relativeTime[0<e?"future":"past"])?e(t):e.replace(/%s/i,t)},t.set=function(e){var t,n;for(n in e)K(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},t.months=function(e,t){return e?(A(this._months)?this._months:this._months[(this._months.isFormat||Ke).test(t)?"format":"standalone"])[e.month()]:A(this._months)?this._months:this._months.standalone},t.monthsShort=function(e,t){return e?(A(this._monthsShort)?this._monthsShort:this._monthsShort[Ke.test(t)?"format":"standalone"])[e.month()]:A(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},t.monthsParse=function(e,t,n){var r,i;if(this._monthsParseExact)return function(e,t,n){var r,i,o,e=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=R([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,e))?i:null:-1!==(i=Ve.call(this._longMonthsParse,e))?i:null:"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,e))||-1!==(i=Ve.call(this._longMonthsParse,e))?i:null:-1!==(i=Ve.call(this._longMonthsParse,e))||-1!==(i=Ve.call(this._shortMonthsParse,e))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=R([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},t.monthsRegex=function(e){return this._monthsParseExact?(M(this,"_monthsRegex")||nt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(M(this,"_monthsRegex")||(this._monthsRegex=tt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},t.monthsShortRegex=function(e){return this._monthsParseExact?(M(this,"_monthsRegex")||nt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(M(this,"_monthsShortRegex")||(this._monthsShortRegex=et),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},t.week=function(e){return st(e,this._week.dow,this._week.doy).week},t.firstDayOfYear=function(){return this._week.doy},t.firstDayOfWeek=function(){return this._week.dow},t.weekdays=function(e,t){return e?(A(this._weekdays)?this._weekdays:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"])[e.day()]:A(this._weekdays)?this._weekdays:this._weekdays.standalone},t.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},t.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},t.weekdaysParse=function(e,t,n){var r,i;if(this._weekdaysParseExact)return function(e,t,n){var r,i,o,e=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=R([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,e))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,e))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,e))?i:null:"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,e))||-1!==(i=Ve.call(this._shortWeekdaysParse,e))||-1!==(i=Ve.call(this._minWeekdaysParse,e))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,e))||-1!==(i=Ve.call(this._weekdaysParse,e))||-1!==(i=Ve.call(this._minWeekdaysParse,e))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,e))||-1!==(i=Ve.call(this._weekdaysParse,e))||-1!==(i=Ve.call(this._shortWeekdaysParse,e))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=R([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}},t.weekdaysRegex=function(e){return this._weekdaysParseExact?(M(this,"_weekdaysRegex")||mt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(M(this,"_weekdaysRegex")||(this._weekdaysRegex=ft),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},t.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(M(this,"_weekdaysRegex")||mt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(M(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=pt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},t.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(M(this,"_weekdaysRegex")||mt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(M(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ht),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},t.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},t.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},kt("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===H(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),p.lang=W("moment.lang is deprecated. Use moment.locale instead.",kt),p.langData=W("moment.langData is deprecated. Use moment.localeData instead.",Ct);var Sn=Math.abs;function En(e,t,n,r){t=an(t,n);return e._milliseconds+=r*t._milliseconds,e._days+=r*t._days,e._months+=r*t._months,e._bubble()}function An(e){return e<0?Math.floor(e):Math.ceil(e)}function kn(e){return 4800*e/146097}function Tn(e){return 146097*e/4800}function Cn(e){return function(){return this.as(e)}}ye=Cn("ms"),fe=Cn("s"),Je=Cn("m"),ve=Cn("h"),ge=Cn("d"),ut=Cn("w"),ke=Cn("M"),pe=Cn("y");function In(e){return function(){return this.isValid()?this._data[e]:NaN}}var _e=In("milliseconds"),he=In("seconds"),be=In("minutes"),He=In("hours"),t=In("days"),xn=In("months"),Pn=In("years");var Mn=Math.round,On={ss:44,s:45,m:45,h:22,d:26,M:11};function Rn(e,t,n){var r=an(e).abs(),i=Mn(r.as("s")),o=Mn(r.as("m")),a=Mn(r.as("h")),s=Mn(r.as("d")),c=Mn(r.as("M")),r=Mn(r.as("y")),i=(i<=On.ss?["s",i]:i<On.s&&["ss",i])||o<=1&&["m"]||o<On.m&&["mm",o]||a<=1&&["h"]||a<On.h&&["hh",a]||s<=1&&["d"]||s<On.d&&["dd",s]||c<=1&&["M"]||c<On.M&&["MM",c]||r<=1&&["y"]||["yy",r];return i[2]=t,i[3]=0<+e,i[4]=n,function(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}.apply(null,i)}var jn=Math.abs;function Dn(e){return(0<e)-(e<0)||+e}function Nn(){if(!this.isValid())return this.localeData().invalidDate();var e=jn(this._milliseconds)/1e3,t=jn(this._days),n=jn(this._months),r=V(e/60),i=V(r/60),o=(e%=60,r%=60,V(n/12)),n=n%=12,e=e?e.toFixed(3).replace(/\.?0+$/,""):"",a=this.asSeconds();if(!a)return"P0D";var s=Dn(this._months)!==Dn(a)?"-":"",c=Dn(this._days)!==Dn(a)?"-":"",u=Dn(this._milliseconds)!==Dn(a)?"-":"";return(a<0?"-":"")+"P"+(o?s+o+"Y":"")+(n?s+n+"M":"")+(t?c+t+"D":"")+(i||r||e?"T":"")+(i?u+i+"H":"")+(r?u+r+"M":"")+(e?u+e+"S":"")}var Ln=Gt.prototype,ye=(Ln.isValid=function(){return this._isValid},Ln.abs=function(){var e=this._data;return this._milliseconds=Sn(this._milliseconds),this._days=Sn(this._days),this._months=Sn(this._months),e.milliseconds=Sn(e.milliseconds),e.seconds=Sn(e.seconds),e.minutes=Sn(e.minutes),e.hours=Sn(e.hours),e.months=Sn(e.months),e.years=Sn(e.years),this},Ln.add=function(e,t){return En(this,e,t,1)},Ln.subtract=function(e,t){return En(this,e,t,-1)},Ln.as=function(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=te(e))||"year"===e)return t=this._days+r/864e5,n=this._months+kn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Tn(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},Ln.asMilliseconds=ye,Ln.asSeconds=fe,Ln.asMinutes=Je,Ln.asHours=ve,Ln.asDays=ge,Ln.asWeeks=ut,Ln.asMonths=ke,Ln.asYears=pe,Ln.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*H(this._months/12):NaN},Ln._bubble=function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data;return 0<=e&&0<=t&&0<=n||e<=0&&t<=0&&n<=0||(e+=864e5*An(Tn(n)+t),n=t=0),r.milliseconds=e%1e3,e=V(e/1e3),r.seconds=e%60,e=V(e/60),r.minutes=e%60,e=V(e/60),r.hours=e%24,t+=V(e/24),n+=e=V(kn(t)),t-=An(Tn(e)),e=V(n/12),n%=12,r.days=t,r.months=n,r.years=e,this},Ln.clone=function(){return an(this)},Ln.get=function(e){return e=te(e),this.isValid()?this[e+"s"]():NaN},Ln.milliseconds=_e,Ln.seconds=he,Ln.minutes=be,Ln.hours=He,Ln.days=t,Ln.weeks=function(){return V(this.days()/7)},Ln.months=xn,Ln.years=Pn,Ln.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=Rn(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Ln.toISOString=Nn,Ln.toString=Nn,Ln.toJSON=Nn,Ln.locale=fn,Ln.localeData=pn,Ln.toIsoString=W("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Nn),Ln.lang=dt,r("X",0,0,"unix"),r("x",0,0,"valueOf"),n("x",Se),n("X",/[+-]?\d+(\.\d{1,3})?/),Pe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),Pe("x",function(e,t,n){n._d=new Date(H(e))}),p.version="2.20.1",S=qt,p.fn=e,p.min=function(){return Wt("isBefore",[].slice.call(arguments,0))},p.max=function(){return Wt("isAfter",[].slice.call(arguments,0))},p.now=function(){return Date.now?Date.now():+new Date},p.utc=R,p.unix=function(e){return qt(1e3*e)},p.months=function(e,t){return _n(e,t,"months")},p.isDate=I,p.locale=kt,p.invalid=N,p.duration=an,p.isMoment=z,p.weekdays=function(e,t,n){return wn(e,t,n,"weekdays")},p.parseZone=function(){return qt.apply(null,arguments).parseZone()},p.localeData=Ct,p.isDuration=Kt,p.monthsShort=function(e,t){return _n(e,t,"monthsShort")},p.weekdaysMin=function(e,t,n){return wn(e,t,n,"weekdaysMin")},p.defineLocale=Tt,p.updateLocale=function(e,t){var n,r;return null!=t?(n=_t,(r=new Q(t=J(n=null!=(r=At(e))?r._config:n,t))).parentLocale=wt[e],wt[e]=r,kt(e)):null!=wt[e]&&(null!=wt[e].parentLocale?wt[e]=wt[e].parentLocale:null!=wt[e]&&delete wt[e]),wt[e]},p.locales=function(){return X(wt)},p.weekdaysShort=function(e,t,n){return wn(e,t,n,"weekdaysShort")},p.normalizeUnits=te,p.relativeTimeRounding=function(e){return void 0===e?Mn:"function"==typeof e&&(Mn=e,!0)},p.relativeTimeThreshold=function(e,t){return void 0!==On[e]&&(void 0===t?On[e]:(On[e]=t,"s"===e&&(On.ss=t-1),!0))},p.calendarFormat=function(e,t){return(e=e.diff(t,"days",!0))<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse"},p.prototype=e,p.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},Object.freeze({default:p})),$n=ye&&p,fe=(o(Bn,[{key:"set",value:function(){throw new Error("not implemented")}},{key:"now",value:function(){return $n().unix()}},{key:"toObject",value:function(){return Object.assign({},this)}}]),Bn);function Bn(e){i(this,Bn),this.set(e||{})}s(Fn,fe),o(Fn,[{key:"set",value:function(e){this.id=e.id||E(),this.start=e.start||this.now()}},{key:"delta",value:function(){return Math.floor(this.now()-this.start)}}]);var Un=Fn;function Fn(e){return i(this,Fn),c(this,(Fn.__proto__||Object.getPrototypeOf(Fn)).call(this,e))}Je=function(e,n){return n=null==n?"":n,e.reduce(function(e,t){return e[t]=n+t,e},{})};function zn(e){if(!zn.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}((zn.prototype=Object.create(Error.prototype)).constructor=zn).types=Je(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),zn.findRootError=function(e){return e instanceof zn&&e.details&&e.details.originalError?zn.findRootError(e.details.originalError):e};var f=zn,Vn={AMEX_NONCE_REQUIRED:{type:f.types.MERCHANT,code:"AMEX_NONCE_REQUIRED"},AMEX_NETWORK_ERROR:{type:f.types.NETWORK,code:"AMEX_NETWORK_ERROR"}};function Hn(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var ve={assign:"function"==typeof Object.assign?Object.assign:Hn,_assign:Hn},qn=setTimeout;function Wn(){}function Yn(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,Zn._immediateFn(function(){var e,t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void Kn(r.promise,e)}Gn(r.promise,e)}else(1===n._state?Gn:Kn)(r.promise,n._value)})):n._deferreds.push(r)}function Gn(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof Zn)return t._state=3,t._value=e,void Jn(t);if("function"==typeof n)return void Xn((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,Jn(t)}catch(e){Kn(t,e)}var r,i}function Kn(e,t){e._state=2,e._value=t,Jn(e)}function Jn(e){2===e._state&&0===e._deferreds.length&&Zn._immediateFn(function(){e._handled||Zn._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)Yn(e,e._deferreds[t]);e._deferreds=null}function Qn(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function Xn(e,t){var n=!1;try{e(function(e){n||(n=!0,Gn(t,e))},function(e){n||(n=!0,Kn(t,e))})}catch(e){if(n)return;n=!0,Kn(t,e)}}function Zn(e){if(!(this instanceof Zn))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Xn(e,this)}var ge=Zn.prototype,ut=(ge.catch=function(e){return this.then(null,e)},ge.then=function(e,t){var n=new this.constructor(Wn);return Yn(this,new Qn(e,t,n)),n},Zn.all=function(t){return new Zn(function(i,o){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var a=Array.prototype.slice.call(t);if(0===a.length)return i([]);var s=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){t(n,e)},o)}a[n]=e,0==--s&&i(a)}catch(e){o(e)}}(e,a[e])})},Zn.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Zn?t:new Zn(function(e){e(t)})},Zn.reject=function(n){return new Zn(function(e,t){t(n)})},Zn.race=function(i){return new Zn(function(e,t){for(var n=0,r=i.length;n<r;n++)i[n].then(e,t)})},Zn._immediateFn="function"==typeof Cs?function(e){Cs(e)}:function(e){qn(e,0)},Zn._unhandledRejectionFn=function(e){},Object.freeze({default:Zn})),u=x.Promise||ut&&Zn,er=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})},tr={INVALID_USE_OF_INTERNAL_FUNCTION:{type:f.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},CALLBACK_REQUIRED:{type:f.types.MERCHANT,code:"CALLBACK_REQUIRED"},INSTANTIATION_OPTION_REQUIRED:{type:f.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INVALID_OPTION:{type:f.types.MERCHANT,code:"INVALID_OPTION"},INCOMPATIBLE_VERSIONS:{type:f.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},METHOD_CALLED_AFTER_TEARDOWN:{type:f.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"},BRAINTREE_API_ACCESS_RESTRICTED:{type:f.types.MERCHANT,code:"BRAINTREE_API_ACCESS_RESTRICTED",message:"Your access is restricted and cannot use this part of the Braintree API."}},nr=function(t,e){e.forEach(function(e){t[e]=function(){throw new f({type:tr.METHOD_CALLED_AFTER_TEARDOWN.type,code:tr.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})};var rr=function(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}};var ir=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}};var or=function(e,t){if(!t)return e;e.then(function(e){t(null,e)}).catch(function(e){t(e)})};function ar(n){return function(){var e,t=Array.prototype.slice.call(arguments);return"function"==typeof t[t.length-1]&&(e=t.pop(),e=ir(rr(e))),or(n.apply(this,t),e)}}ar.wrapPrototype=function(r,e){var i=(e=e||{}).ignoreMethods||[],o=!0===e.transformPrivateMethods;return Object.getOwnPropertyNames(r.prototype).filter(function(e){var t="constructor"!==e&&"function"==typeof r.prototype[e],n=-1===i.indexOf(e),e=o||"_"!==e.charAt(0);return t&&e&&n}).forEach(function(e){var t=r.prototype[e];r.prototype[e]=ar(t)}),r};var sr=ar,cr=ve.assign;function ur(e){this._client=e.client}ur.prototype.getRewardsBalance=function(e){var t=e.nonce;return t?(delete(t=cr({_meta:{source:"american-express"},paymentMethodNonce:t},e)).nonce,this._client.request({method:"get",endpoint:"payment_methods/amex_rewards_balance",data:t}).catch(function(e){return u.reject(new f({type:Vn.AMEX_NETWORK_ERROR.type,code:Vn.AMEX_NETWORK_ERROR.code,message:"A network error occurred when getting the American Express rewards balance.",details:{originalError:e}}))})):u.reject(new f({type:Vn.AMEX_NONCE_REQUIRED.type,code:Vn.AMEX_NONCE_REQUIRED.code,message:"getRewardsBalance must be called with a nonce."}))},ur.prototype.getExpressCheckoutProfile=function(e){return e.nonce?this._client.request({method:"get",endpoint:"payment_methods/amex_express_checkout_cards/"+e.nonce,data:{_meta:{source:"american-express"},paymentMethodNonce:e.nonce}}).catch(function(e){return u.reject(new f({type:Vn.AMEX_NETWORK_ERROR.type,code:Vn.AMEX_NETWORK_ERROR.code,message:"A network error occurred when getting the American Express Checkout nonce profile.",details:{originalError:e}}))}):u.reject(new f({type:Vn.AMEX_NONCE_REQUIRED.type,code:Vn.AMEX_NONCE_REQUIRED.code,message:"getExpressCheckoutProfile must be called with a nonce."}))},ur.prototype.teardown=function(){return nr(this,er(ur.prototype)),u.resolve()};var lr=sr.wrapPrototype(ur);var dr={verify:function(e){var t;return e?(t=e.name,null==(e=e.client)?u.reject(new f({type:tr.INSTANTIATION_OPTION_REQUIRED.type,code:tr.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+t+"."})):"3.29.0"!==(e=e.getVersion())?u.reject(new f({type:tr.INCOMPATIBLE_VERSIONS.type,code:tr.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+e+") and "+t+" (version 3.29.0) components must be from the same SDK version."})):u.resolve()):u.reject(new f({type:tr.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:tr.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}};var ke={create:sr(function(e){return dr.verify({name:"American Express",client:e.client}).then(function(){return new lr(e)})}),VERSION:"3.29.0"},fr={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.29.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.29.0"},pr="function"==typeof x.atob?x.atob:hr;function hr(e){var t,n,r,i,o,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(o=0;n=a.indexOf(e.charAt(o++)),t=(15&(r=a.indexOf(e.charAt(o++))))<<4|(i=a.indexOf(e.charAt(o++)))>>2&15,i=(3&i)<<6|63&a.indexOf(e.charAt(o++)),s+=String.fromCharCode((63&n)<<2|r>>4&3)+(t?String.fromCharCode(t):"")+(i?String.fromCharCode(i):""),o<e.length;);return s}var mr=function(e){return pr.call(x,e)},gr={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};function vr(e){return JSON.parse(JSON.stringify(e))}var yr=function(e){var t,n,r={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(n=(t=(t=e).split("_"))[0],t={merchantId:t.slice(2).join("_"),environment:n},r.attrs.tokenizationKey=e,r.configUrl=gr[t.environment]+"/merchants/"+t.merchantId+"/client_api/v1/configuration"):(n=JSON.parse(mr(e)),r.attrs.authorizationFingerprint=n.authorizationFingerprint,r.configUrl=n.configUrl),r};var br=function(e,t){var n,r=t?vr(t):{},t=yr(e.authorization).attrs,i=vr(e.analyticsMetadata);for(n in r.braintreeLibraryVersion=fr.BRAINTREE_LIBRARY_VERSION,r._meta)r._meta.hasOwnProperty(n)&&(i[n]=r._meta[n]);return r._meta=i,t.tokenizationKey?r.tokenizationKey=t.tokenizationKey:r.authorizationFingerprint=t.authorizationFingerprint,r};var h={sendEvent:function(e,t,n){var r=e.getConfiguration(),e=e._request,i=(i=Date.now(),Math.floor(i/1e3));e({url:r.gatewayConfiguration.analytics.url,method:"post",data:br(r,{analytics:[{kind:fr.ANALYTICS_PREFIX+t,timestamp:i}]}),timeout:fr.ANALYTICS_REQUEST_TIMEOUT_MS},n)}},_r={APPLE_PAY_NOT_ENABLED:{type:f.types.MERCHANT,code:"APPLE_PAY_NOT_ENABLED",message:"Apple Pay is not enabled for this merchant."},APPLE_PAY_VALIDATION_URL_REQUIRED:{type:f.types.MERCHANT,code:"APPLE_PAY_VALIDATION_URL_REQUIRED",message:"performValidation must be called with a validationURL."},APPLE_PAY_MERCHANT_VALIDATION_NETWORK:{type:f.types.NETWORK,code:"APPLE_PAY_MERCHANT_VALIDATION_NETWORK",message:"A network error occurred when validating the Apple Pay merchant."},APPLE_PAY_MERCHANT_VALIDATION_FAILED:{type:f.types.MERCHANT,code:"APPLE_PAY_MERCHANT_VALIDATION_FAILED",message:"Make sure you have registered your domain name in the Braintree Control Panel."},APPLE_PAY_PAYMENT_TOKEN_REQUIRED:{type:f.types.MERCHANT,code:"APPLE_PAY_PAYMENT_TOKEN_REQUIRED",message:"tokenize must be called with a payment token."},APPLE_PAY_TOKENIZATION:{type:f.types.NETWORK,code:"APPLE_PAY_TOKENIZATION",message:"A network error occurred when processing the Apple Pay payment."}};function wr(e){this._client=e.client,Object.defineProperty(this,"merchantIdentifier",{value:this._client.getConfiguration().gatewayConfiguration.applePayWeb.merchantIdentifier,configurable:!1,writable:!1})}wr.prototype.createPaymentRequest=function(e){var t=this._client.getConfiguration().gatewayConfiguration.applePayWeb,t={countryCode:t.countryCode,currencyCode:t.currencyCode,merchantCapabilities:t.merchantCapabilities||["supports3DS"],supportedNetworks:t.supportedNetworks.map(function(e){return"mastercard"===e?"masterCard":e})};return Object.assign({},t,e)},wr.prototype.performValidation=function(e){var t,n=this;return e&&e.validationURL?(t={validationUrl:e.validationURL,domainName:e.domainName||x.location.hostname,merchantIdentifier:e.merchantIdentifier||this.merchantIdentifier},null!=e.displayName&&(t.displayName=e.displayName),this._client.request({method:"post",endpoint:"apple_pay_web/sessions",data:{_meta:{source:"apple-pay"},applePayWebSession:t}}).then(function(e){return h.sendEvent(n._client,"applepay.performValidation.succeeded"),u.resolve(e)}).catch(function(e){return h.sendEvent(n._client,"applepay.performValidation.failed"),"CLIENT_REQUEST_ERROR"===e.code?u.reject(new f({type:_r.APPLE_PAY_MERCHANT_VALIDATION_FAILED.type,code:_r.APPLE_PAY_MERCHANT_VALIDATION_FAILED.code,message:_r.APPLE_PAY_MERCHANT_VALIDATION_FAILED.message,details:{originalError:e.details.originalError}})):u.reject(new f({type:_r.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.type,code:_r.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.code,message:_r.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.message,details:{originalError:e}}))})):u.reject(new f(_r.APPLE_PAY_VALIDATION_URL_REQUIRED))},wr.prototype.tokenize=function(e){var t=this;return e.token?this._client.request({method:"post",endpoint:"payment_methods/apple_payment_tokens",data:{_meta:{source:"apple-pay"},applePaymentToken:Object.assign({},e.token,{paymentData:btoa(JSON.stringify(e.token.paymentData))})}}).then(function(e){return h.sendEvent(t._client,"applepay.tokenize.succeeded"),u.resolve(e.applePayCards[0])}).catch(function(e){return h.sendEvent(t._client,"applepay.tokenize.failed"),u.reject(new f({type:_r.APPLE_PAY_TOKENIZATION.type,code:_r.APPLE_PAY_TOKENIZATION.code,message:_r.APPLE_PAY_TOKENIZATION.message,details:{originalError:e}}))}):u.reject(new f(_r.APPLE_PAY_PAYMENT_TOKEN_REQUIRED))},wr.prototype.teardown=function(){return nr(this,er(wr.prototype)),u.resolve()};var Sr=sr.wrapPrototype(wr);function Er(e){return-1!==(e=e||navigator.userAgent).indexOf("MSIE 9")}var pe={create:sr(function(e){return dr.verify({name:"Apple Pay",client:e.client}).then(function(){return e.client.getConfiguration().gatewayConfiguration.applePayWeb?(h.sendEvent(e.client,"applepay.initialized"),new Sr(e)):u.reject(new f(_r.APPLE_PAY_NOT_ENABLED))})}),VERSION:"3.29.0"},Ar={isIe:function(e){return-1!==(e=e||x.navigator.userAgent).indexOf("MSIE")||-1!==(e||navigator.userAgent).indexOf("Trident/7")},isIe9:Er},kr={tokenize_credit_cards:"payment_methods/credit_cards"},Tr=["creditCard.options.unionPayEnrollment"];function Cr(e){this._config=e.graphQL}Cr.prototype.getGraphQLEndpoint=function(){return this._config.url},Cr.prototype.isGraphQLRequest=function(e,t){var n,r=this.getClientApiPath(e);return!(!this._isGraphQLEnabled()||!r||Ar.isIe9())&&(e=this._config.features.some(function(e){return kr[e]===r}),n=t,!Tr.some(function(e){return void 0!==e.split(".").reduce(function(e,t){return e&&e[t]},n)})&&e)},Cr.prototype.getClientApiPath=function(e){var t,e=e.split("/client_api/v1/");return t=1<e.length?e[1].split("?")[0]:t},Cr.prototype._isGraphQLEnabled=function(){return Boolean(this._config)};var Ir=Cr;var xr=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}};var Pr=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})};function Mr(e,t){var n,r,i,o=[];for(r in e)e.hasOwnProperty(r)&&(n=e[r],i=t?(i=e)&&"object"==typeof i&&"number"==typeof i.length&&"[object Array]"===Object.prototype.toString.call(i)?t+"[]":t+"["+r+"]":r,"object"==typeof n?o.push(Mr(n,i)):o.push(encodeURIComponent(i)+"="+encodeURIComponent(n)));return o.join("&")}var Or,Rr={parse:function(e){return e=e||x.location.href,/\?/.test(e)?e.replace(/#.*$/,"").replace(/^.*\?/,"").split("&").reduce(function(e,t){var t=t.split("="),n=decodeURIComponent(t[0]),t=decodeURIComponent(t[1]);return e[n]=t,e},{}):{}},stringify:Mr,queryify:function(e,t){return e=e||"",e=null!=t&&"object"==typeof t&&function(e){for(var t in e)if(e.hasOwnProperty(t))return 1}(t)?(e=(e+=-1===e.indexOf("?")?"?":"")+(-1!==e.indexOf("=")?"&":""))+Mr(t):e}},jr={};function Dr(t){try{delete x[t]}catch(e){x[t]=null}}var Nr={request:function(e,l){var t,n,r,d,f,i,o,a="callback_json_"+Pr().replace(/-/g,""),s=e.url,c=e.data,u=e.method,e=e.timeout,s=Rr.queryify(s,c);s=Rr.queryify(s,{_method:u,callback:a}),c=s,t=a,n=document.createElement("script"),r=!1,n.src=c,n.async=!0,n.onerror=function(){x[t]({message:"error",status:500})},n.onload=n.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,n.onload=n.onreadystatechange=null)},d=u=n,f=l,x[i=a]=function(e){var t=e.status||500,n=null,r=null;delete e.status,400<=t||t<200?n=e:r=e,Dr(i),(e=d)&&e.parentNode&&e.parentNode.removeChild(e),clearTimeout(jr[i]),f(n,r,t)},jr[o=a]=setTimeout(function(){jr[o]=null,x[o]({error:"timeout",status:-1}),x[o]=function(){Dr(o)}},e),(Or=Or||document.getElementsByTagName("head")[0]).appendChild(u)}},Lr=function(e,t){if("string"!=typeof e)throw new Error("Method must be a string");return t="get"!==e.toLowerCase()&&null!=t?"string"==typeof t?t:JSON.stringify(t):t},$r=function(e){try{e=JSON.parse(e)}catch(e){}return e},Br=x.XMLHttpRequest&&"withCredentials"in new x.XMLHttpRequest;var Ur={isAvailable:Br,getRequestObject:function(){return new(Br?XMLHttpRequest:XDomainRequest)}},Fr=ve.assign;function zr(e){var t=e.creditCard,n=t&&t.billingAddress,r=t&&t.expirationDate,i=t&&(t.expirationMonth||r&&r.split("/")[0].trim()),r=t&&(t.expirationYear||r&&r.split("/")[1].trim()),i={input:{creditCard:{number:t&&t.number,expirationMonth:i,expirationYear:r,cvv:t&&t.cvv,cardholderName:t&&t.cardholderName},options:{}}};return n&&(i.input.creditCard.billingAddress=n),i.input=function(e,t){var n;e.creditCard&&e.creditCard.options&&"boolean"==typeof e.creditCard.options.validate?n=e.creditCard.options.validate:e.authorizationFingerprint&&e.tokenizationKey||e.authorizationFingerprint?n=!0:e.tokenizationKey&&(n=!1);"boolean"==typeof n&&(t.options=Fr({validate:n},t.options));return t}(e,i.input),i}var Vr=function(e){var t,n=e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorType,r="user_error"===n?(t=(t=e).errors[0],r=t.extensions.legacyMessage,t=function(e){var t=[];return e.forEach(function(e){!function e(t,n,r){var i;var o=n.legacyCode;var a=t[0];if(1===t.length)return void r.push({code:o,field:a,message:n.message});r.forEach(function(e){e.field===a&&(i=e)});i||(i={field:a,fieldErrors:[]},r.push(i));e(t.slice(1),n,i.fieldErrors)}(e.inputPath.slice(1),e,t)}),t}(t.extensions.errorDetails),{error:{message:r},fieldErrors:t}):n?{error:{message:e.errors[0].message},fieldErrors:[]}:{error:{message:"There was a problem serving your request"},fieldErrors:[]};return r};var Hr=ve.assign,qr={"payment_methods/credit_cards":function(e){return JSON.stringify({query:"mutation TokenizeCreditCard($input: TokenizeCreditCardInput!) {   tokenizeCreditCard(input: $input) {     token     creditCard {       brand       last4       binData {         prepaid         healthcare         debit         durbinRegulated         commercial         payroll         issuingBank         countryOfIssuance         productId       }     }   } }",variables:zr(e),operationName:"TokenizeCreditCard"})}},Wr={"payment_methods/credit_cards":function(e){return e=(e.data&&!e.errors?function(e){var e=e.data.tokenizeCreditCard,t=e.creditCard,n=t.last4?t.last4.substr(2,4):"",r=t.binData;r&&["issuingBank","countryOfIssuance","productId"].forEach(function(e){null===r[e]&&(r[e]="Unknown")});return{creditCards:[{binData:r,consumed:!1,description:n?"ending in "+n:"",nonce:e.token,details:{cardType:t.brand||"Unknown",lastFour:t.last4||"",lastTwo:n},type:"CreditCard",threeDSecureInfo:null}]}}:Vr)(e)}};function Yr(e){var t=e.graphQL.getClientApiPath(e.url);this._graphQL=e.graphQL,this._data=e.data,this._method=e.method,this._headers=e.headers,this._sendAnalyticsEvent=e.sendAnalyticsEvent||Function.prototype,this._generator=qr[t],this._adapter=Wr[t],this._sendAnalyticsEvent("graphql.init")}function Gr(e){return-1===e.indexOf("_")?e:e.toLowerCase().replace(/(\_\w)/g,function(e){return e[1].toUpperCase()})}Yr.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()},Yr.prototype.getBody=function(){var e=function n(r){var i={};Object.keys(r).forEach(function(e){var t=Gr(e);"object"==typeof r[e]?i[t]=n(r[e]):"number"==typeof r[e]?i[t]=String(r[e]):i[t]=r[e]});return i}(this._data);return this._generator(e)},Yr.prototype.getMethod=function(){return"POST"},Yr.prototype.getHeaders=function(){var e=this._data.authorizationFingerprint?(this._sendAnalyticsEvent("graphql.authorization-fingerprint"),this._data.authorizationFingerprint):(this._sendAnalyticsEvent("graphql.tokenization-key"),this._data.tokenizationKey);return Hr({},this._headers,{Authorization:"Bearer "+e,"Braintree-Version":"2017-12-15"})},Yr.prototype.adaptResponseBody=function(e){return this._adapter(e)},Yr.prototype.determineStatus=function(e,t){var n=200===e?(n=t.errors&&t.errors[0]&&t.errors[0].extensions&&t.errors[0].extensions.errorType,t.data&&!t.errors?200:"user_error"===n?422:"developer_error"===n?403:"unknown_error"===n?500:(t=t,!n&&t.errors[0].message?403:500)):e||500;return this._sendAnalyticsEvent("graphql.status."+e),this._sendAnalyticsEvent("graphql.determinedStatus."+n),n};var Kr=Yr;function Jr(e){this._url=e.url,this._data=e.data,this._method=e.method,this._headers=e.headers}Jr.prototype.getUrl=function(){return this._url},Jr.prototype.getBody=function(){return this._data},Jr.prototype.getMethod=function(){return this._method},Jr.prototype.getHeaders=function(){return this._headers},Jr.prototype.adaptResponseBody=function(e){return e},Jr.prototype.determineStatus=function(e){return e};var Qr=Jr,Xr=ve.assign,Zr=Ur.isAvailable,ei=1,ti=408;function ni(t,n,r){var i,l,o,e,d,f,a=t.url,s=t.graphQL,p=t.timeout,c=Ur.getRequestObject(),u=r,h=Boolean(s&&s.isGraphQLRequest(a,t.data));t.headers=Xr({"Content-Type":"application/json"},t.headers),a=(o=new(h?Kr:Qr)(t)).getUrl(),s=o.getBody(),e=o.getMethod(),d=o.getHeaders(),"GET"===e&&(a=Rr.queryify(a,s),s=null),Zr?c.onreadystatechange=function(){if(4===c.readyState){if(0===c.status&&h)return delete t.graphQL,void ni(t,n,r);if(f=$r(c.responseText),l=o.adaptResponseBody(f),400<=(i=o.determineStatus(c.status,f))||i<200){if(h&&"unknown_error"===(!(e=f).data&&e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorType))return delete t.graphQL,void ni(t,n,r);n<ei&&((!(e=i)||e===ti)&&Ar.isIe())?ni(t,++n,r):u(l||"error",null,i||500)}else u(null,l,i);var e}}:(t.headers&&(a=Rr.queryify(a,d)),c.onload=function(){u(null,$r(c.responseText),c.status)},c.onerror=function(){u("error",null,500)},c.onprogress=function(){},c.ontimeout=function(){u("timeout",null,-1)});try{c.open(e,a,!0)}catch(e){if(!h)throw e;return delete t.graphQL,void ni(t,n,r)}c.timeout=p,Zr&&Object.keys(d).forEach(function(e){c.setRequestHeader(e,d[e])});try{c.send(Lr(e,s))}catch(e){}}function ri(){return x.navigator.userAgent}function ii(){return"http:"===x.location.protocol}var oi,ai={request:function(e,t){ni(e,0,t)}};function si(e,t){t=xr(t||Function.prototype),e.method=(e.method||"GET").toUpperCase(),e.timeout=null==e.timeout?6e4:e.timeout,e.data=e.data||{},((oi=null==oi?!(ii()&&/MSIE\s(8|9)/.test(ri())):oi)?ai:Nr).request(e,t)}var ci,ui={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};var li=function(e){return e=e.toLowerCase(),!!/^https:/.test(e)&&((ci=ci||document.createElement("a")).href=e,e=ci.hostname.split(".").slice(-2).join("."),ui.hasOwnProperty(e))};function di(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}}var fi=function(e,t){return e instanceof f?e:new f({type:t.type,code:t.code,message:t.message,details:{originalError:e}})},pi="2017-04-03",hi={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:f.types.MERCHANT,code:"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN"},CLIENT_OPTION_REQUIRED:{type:f.types.MERCHANT,code:"CLIENT_OPTION_REQUIRED"},CLIENT_OPTION_INVALID:{type:f.types.MERCHANT,code:"CLIENT_OPTION_INVALID"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:f.types.INTERNAL,code:"CLIENT_MISSING_GATEWAY_CONFIGURATION",message:"Missing gatewayConfiguration."},CLIENT_INVALID_AUTHORIZATION:{type:f.types.MERCHANT,code:"CLIENT_INVALID_AUTHORIZATION",message:"Authorization is invalid. Make sure your client token or tokenization key is valid."},CLIENT_GATEWAY_NETWORK:{type:f.types.NETWORK,code:"CLIENT_GATEWAY_NETWORK",message:"Cannot contact the gateway at this time."},CLIENT_REQUEST_TIMEOUT:{type:f.types.NETWORK,code:"CLIENT_REQUEST_TIMEOUT",message:"Request timed out waiting for a reply."},CLIENT_REQUEST_ERROR:{type:f.types.NETWORK,code:"CLIENT_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_RATE_LIMITED:{type:f.types.MERCHANT,code:"CLIENT_RATE_LIMITED",message:"You are being rate-limited; please try again in a few minutes."},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:f.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INSUFFICIENT",message:"The authorization used has insufficient privileges."}},mi=ve.assign,gi=fr.VERSION;function vi(e){var t,n;if(e=e||{},t=JSON.stringify(e),!(n=e.gatewayConfiguration))throw new f(hi.CLIENT_MISSING_GATEWAY_CONFIGURATION);if(["assetsUrl","clientApiUrl","configUrl"].forEach(function(e){if(e in n&&!li(n[e]))throw new f({type:hi.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:hi.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:e+" property is on an invalid domain."})}),this.getConfiguration=function(){return JSON.parse(t)},this._request=si,this._configuration=this.getConfiguration(),this._clientApiBaseUrl=n.clientApiUrl+"/v1/",(e=n.braintreeApi)&&(this._braintreeApi={baseUrl:e.url+"/",accessToken:e.accessToken},!li(this._braintreeApi.baseUrl)))throw new f({type:hi.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:hi.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:"braintreeApi URL is on an invalid domain."});n.graphQL&&(this._graphQL=new Ir({graphQL:n.graphQL}))}vi.prototype.request=function(o,n){var a=this,e=new u(function(r,i){var e,t,n;if(o.method?o.endpoint||(e="options.endpoint"):e="options.method",e)throw new f({type:hi.CLIENT_OPTION_REQUIRED.type,code:hi.CLIENT_OPTION_REQUIRED.code,message:e+" is required when making a request."});if(e="api"in o?o.api:"clientApi",n={method:o.method,graphQL:a._graphQL,timeout:o.timeout},"clientApi"===e)t=a._clientApiBaseUrl,n.data=br(a._configuration,o.data);else{if("braintreeApi"!==e)throw new f({type:hi.CLIENT_OPTION_INVALID.type,code:hi.CLIENT_OPTION_INVALID.code,message:"options.api is invalid."});if(!a._braintreeApi)throw new f(tr.BRAINTREE_API_ACCESS_RESTRICTED);t=a._braintreeApi.baseUrl,n.data=o.data,n.headers={"Braintree-Version":pi,Authorization:"Bearer "+a._braintreeApi.accessToken}}n.url=t+o.endpoint,n.sendAnalyticsEvent=function(e){h.sendEvent(a,e)},a._request(n,function(e,t,n){var e=function(e,t){var n;-1===e?n=new f(hi.CLIENT_REQUEST_TIMEOUT):403===e?n=new f(hi.CLIENT_AUTHORIZATION_INSUFFICIENT):429===e?n=new f(hi.CLIENT_RATE_LIMITED):500<=e?n=new f(hi.CLIENT_GATEWAY_NETWORK):(e<200||400<=e)&&(n=fi(t,{type:hi.CLIENT_REQUEST_ERROR.type,code:hi.CLIENT_REQUEST_ERROR.code,message:hi.CLIENT_REQUEST_ERROR.message}));if(n)return n.details=n.details||{},n.details.httpStatus=e,n}(n,e);e?i(e):(e=mi({_httpStatus:n},t),r(e))})});return"function"==typeof n?(n=xr(di(n)),void e.then(function(e){n(null,e,e._httpStatus)}).catch(function(e){var t=e&&e.details&&e.details.httpStatus;n(e,null,t)})):e},vi.prototype.toJSON=function(){return this.getConfiguration()},vi.prototype.getVersion=function(){return gi},vi.prototype.teardown=sr(function(){return nr(this,er(vi.prototype)),u.resolve()});var yi=vi;var bi={getConfiguration:sr(function(c){return new u(function(r,i){var o,e,a,t=Pr(),s={merchantAppId:x.location.host,platform:fr.PLATFORM,sdkVersion:fr.VERSION,source:fr.SOURCE,integration:fr.INTEGRATION,integrationType:fr.INTEGRATION,sessionId:t};try{e=yr(c.authorization)}catch(e){return void i(new f(hi.CLIENT_INVALID_AUTHORIZATION))}a=e.attrs,t=e.configUrl,a._meta=s,a.braintreeLibraryVersion=fr.BRAINTREE_LIBRARY_VERSION,a.configVersion="3",si({url:t,method:"GET",data:a},function(e,t,n){e?i(new f({type:(n=403===n?hi.CLIENT_AUTHORIZATION_INSUFFICIENT:hi.CLIENT_GATEWAY_NETWORK).type,code:n.code,message:n.message,details:{originalError:e}})):(o={authorization:c.authorization,authorizationType:a.tokenizationKey?"TOKENIZATION_KEY":"CLIENT_TOKEN",analyticsMetadata:s,gatewayConfiguration:t},r(o))})})})}.getConfiguration,_i={};var _e={create:sr(function(t){return t.authorization?_i[t.authorization]?u.resolve(_i[t.authorization]):bi(t).then(function(e){return t.debug&&(e.isDebug=!0),e=new yi(e),_i[t.authorization]=e}):u.reject(new f({type:tr.INSTANTIATION_OPTION_REQUIRED.type,code:tr.INSTANTIATION_OPTION_REQUIRED.code,message:"options.authorization is required when instantiating a client."}))}),VERSION:"3.29.0",_clearCache:function(){_i={}}},wi=v(function(e){var t,n,r,i,o,y={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};function u(e,t,n){if(4!==t.length)throw new y.exception.invalid("invalid aes block size");var r=e.b[n],i=t[0]^r[0],o=t[n?3:1]^r[1],a=t[2]^r[2];t=t[n?1:3]^r[3];for(var l,d,f=r.length/4-2,s=4,p=[0,0,0,0],c=e.l[n],h=(e=c[0],c[1]),m=c[2],g=c[3],v=c[4],u=0;u<f;u++)c=e[i>>>24]^h[o>>16&255]^m[a>>8&255]^g[255&t]^r[s],l=e[o>>>24]^h[a>>16&255]^m[t>>8&255]^g[255&i]^r[s+1],d=e[a>>>24]^h[t>>16&255]^m[i>>8&255]^g[255&o]^r[s+2],t=e[t>>>24]^h[i>>16&255]^m[o>>8&255]^g[255&a]^r[s+3],s+=4,i=c,o=l,a=d;for(u=0;u<4;u++)p[n?3&-u:u]=v[i>>>24]<<24^v[o>>16&255]<<16^v[a>>8&255]<<8^v[255&t]^r[s++],c=i,i=o,o=a,a=t,t=c;return p}function a(l,e){for(var t,n,r=l.u,d=l.b,f=r[0],i=r[1],o=r[2],a=r[3],s=r[4],p=r[5],c=r[6],h=r[7],u=0;u<64;u++)t=(t=u<16?e[u]:(t=e[u+1&15],n=e[u+14&15],e[15&u]=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+e[15&u]+e[u+9&15]|0))+h+(s>>>6^s>>>11^s>>>25^s<<26^s<<21^s<<7)+(c^s&(p^c))+d[u],h=c,c=p,p=s,s=a+t|0,a=o,o=i,f=t+((i=f)&o^a&(i^o))+(i>>>2^i>>>13^i>>>22^i<<30^i<<19^i<<10)|0;r[0]=r[0]+f|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+p|0,r[6]=r[6]+c|0,r[7]=r[7]+h|0}function l(e,t){var n,r=y.random.B[e],i=[];for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);for(n=0;n<i.length;n++)i[n](t)}function s(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function d(e){e.b=f(e).concat(f(e)),e.C=new y.cipher.aes(e.b)}function f(e){for(var t=0;t<4&&(e.g[t]=e.g[t]+1|0,!e.g[t]);t++);return e.C.encrypt(e.g)}function c(e,t){return function(){t.apply(e,arguments)}}y.cipher.aes=function(e){this.l[0][0][0]||this.G();var t,n,r,i=this.l[0][4],o=this.l[1],a=e.length,s=1;if(4!==a&&6!==a&&8!==a)throw new y.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),r=[]],e=a;e<4*a+28;e++)t=n[e-1],(0==e%a||8===a&&4==e%a)&&(t=i[t>>>24]<<24^i[t>>16&255]<<16^i[t>>8&255]<<8^i[255&t],0==e%a&&(t=t<<8^t>>>24^s<<24,s=s<<1^283*(s>>7))),n[e]=n[e-a]^t;for(a=0;e;a++,e--)t=n[3&a?e:e-4],r[a]=e<=4||a<4?t:o[0][i[t>>>24]]^o[1][i[t>>16&255]]^o[2][i[t>>8&255]]^o[3][i[255&t]]},y.cipher.aes.prototype={encrypt:function(e){return u(this,e,0)},decrypt:function(e){return u(this,e,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){for(var e,t,n,r,i,o,a=this.l[0],s=this.l[1],l=a[4],d=s[4],c=[],f=[],u=0;u<256;u++)f[(c[u]=u<<1^283*(u>>7))^u]=u;for(e=t=0;!l[e];e^=n||1,t=f[t]||1)for(o=16843009*(r=c[u=c[n=c[d[l[e]=i=(i=t^t<<1^t<<2^t<<3^t<<4)>>8^255&i^99]=e]]])^65537*u^257*n^16843008*e,r=257*c[i]^16843008*i,u=0;u<4;u++)a[u][e]=r=r<<24^r>>>8,s[u][i]=o=o<<24^o>>>8;for(u=0;u<5;u++)a[u]=a[u].slice(0),s[u]=s[u].slice(0)}},y.bitArray={bitSlice:function(e,t,n){return e=y.bitArray.M(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:y.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=y.bitArray.getPartial(n);return 32===r?e.concat(t):y.bitArray.M(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+y.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=y.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(y.bitArray.bitLength(e)!==y.bitArray.bitLength(t))return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},M:function(e,t,n,r){var i=0;for(void 0===r&&(r=[]);32<=t;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=y.bitArray.getPartial(i),r.push(y.bitArray.partial(t+e&31,32<t+e?n:r.pop(),1)),r},Y:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){for(var t,n=0;n<e.length;++n)t=e[n],e[n]=t>>>24|t>>>8&65280|(65280&t)<<8|t<<24;return e}},y.codec.utf8String={fromBits:function(e){for(var t,n="",r=y.bitArray.bitLength(e),i=0;i<r/8;i++)0==(3&i)&&(t=e[i/4]),n+=String.fromCharCode(t>>>8>>>8>>>8),t<<=8;return decodeURIComponent(escape(n))},toBits:function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0,r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),3==(3&r)&&(t.push(n),n=0);return 3&r&&t.push(y.bitArray.partial(8*(3&r),n)),t}},y.codec.hex={fromBits:function(e){for(var t="",n=0;n<e.length;n++)t+=(0xf00000000000+(0|e[n])).toString(16).substr(4);return t.substr(0,y.bitArray.bitLength(e)/4)},toBits:function(e){var t,n=[],r=(e=e.replace(/\s|0x/g,"")).length;for(e+="00000000",t=0;t<e.length;t+=8)n.push(0^parseInt(e.substr(t,8),16));return y.bitArray.clamp(n,4*r)}},y.hash.sha256=function(e){this.b[0]||this.G(),e?(this.u=e.u.slice(0),this.o=e.o.slice(0),this.h=e.h):this.reset()},y.hash.sha256.hash=function(e){return(new y.hash.sha256).update(e).finalize()},y.hash.sha256.prototype={blockSize:512,reset:function(){return this.u=this.K.slice(0),this.o=[],this.h=0,this},update:function(e){"string"==typeof e&&(e=y.codec.utf8String.toBits(e));var t=this.o=y.bitArray.concat(this.o,e);if(i=this.h,9007199254740991<(e=this.h=i+y.bitArray.bitLength(e)))throw new y.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){for(var n=new Uint32Array(t),r=0,i=512+i-(512+i&511);i<=e;i+=512)a(this,n.subarray(16*r,16*(r+1))),r+=1;t.splice(0,16*r)}else for(i=512+i-(512+i&511);i<=e;i+=512)a(this,t.splice(0,16));return this},finalize:function(){for(var e=this.o,t=this.u,n=(e=y.bitArray.concat(e,[y.bitArray.partial(1,1)])).length+2;15&n;n++)e.push(0);for(e.push(Math.floor(this.h/4294967296)),e.push(0|this.h);e.length;)a(this,e.splice(0,16));return this.reset(),t},K:[],b:[],G:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,n,r=0,i=2;r<64;i++){for(n=!0,t=2;t*t<=i;t++)if(0==i%t){n=!1;break}n&&(r<8&&(this.K[r]=e(Math.pow(i,.5))),this.b[r]=e(Math.pow(i,1/3)),r++)}}},y.prng=function(e){this.c=[new y.hash.sha256],this.i=[0],this.H=0,this.v={},this.F=0,this.J={},this.L=this.f=this.j=this.T=0,this.b=[0,0,0,0,0,0,0,0],this.g=[0,0,0,0],this.C=void 0,this.D=e,this.s=!1,this.B={progress:{},seeded:{}},this.m=this.S=0,this.w=1,this.A=2,this.O=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.P=3e4,this.N=80},y.prng.prototype={randomWords:function(e,t){var n=[];if((i=this.isReady(t))===this.m)throw new y.exception.notReady("generator isn't seeded");if(i&this.A){var r,i=!(i&this.w),o=[],a=0;for(this.L=o[0]=(new Date).valueOf()+this.P,r=0;r<16;r++)o.push(4294967296*Math.random()|0);for(r=0;r<this.c.length&&(o=o.concat(this.c[r].finalize()),a+=this.i[r],this.i[r]=0,i||!(this.H&1<<r));r++);for(this.H>=1<<this.c.length&&(this.c.push(new y.hash.sha256),this.i.push(0)),this.f-=a,a>this.j&&(this.j=a),this.H++,this.b=y.hash.sha256.hash(this.b.concat(o)),this.C=new y.cipher.aes(this.b),i=0;i<4&&(this.g[i]=this.g[i]+1|0,!this.g[i]);i++);}for(i=0;i<e;i+=4)0==(i+1)%this.O&&d(this),o=f(this),n.push(o[0],o[1],o[2],o[3]);return d(this),n.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new y.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.D=e},addEntropy:function(e,t,n){n=n||"user";var r,i=(new Date).valueOf(),o=this.v[n],a=this.isReady(),s=0,c=this.J[n];switch(void 0===c&&(c=this.J[n]=this.T++),void 0===o&&(o=this.v[n]=0),this.v[n]=(this.v[n]+1)%this.c.length,typeof e){case"number":void 0===t&&(t=1),this.c[o].update([c,this.F++,1,t,i,1,0|e]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(e))){for(r=[],n=0;n<e.length;n++)r.push(e[n]);e=r}else for("[object Array]"!==n&&(s=1),n=0;n<e.length&&!s;n++)"number"!=typeof e[n]&&(s=1);if(!s){if(void 0===t)for(n=t=0;n<e.length;n++)for(r=e[n];0<r;)t++,r>>>=1;this.c[o].update([c,this.F++,2,t,i,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this.c[o].update([c,this.F++,3,t,i,e.length]),this.c[o].update(e);break;default:s=1}if(s)throw new y.exception.bug("random: addEntropy only supports number, array of numbers or string");this.i[o]+=t,this.f+=t,a===this.m&&(this.isReady()!==this.m&&l("seeded",Math.max(this.j,this.f)),l("progress",this.getProgress()))},isReady:function(e){return e=this.I[void 0!==e?e:this.D],this.j&&this.j>=e?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=e?this.A|this.m:this.m},getProgress:function(e){return e=this.I[e||this.D],this.j>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.s){if(this.a={loadTimeCollector:c(this,this.V),mouseCollector:c(this,this.W),keyboardCollector:c(this,this.U),accelerometerCollector:c(this,this.R),touchCollector:c(this,this.X)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new y.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(e,t){this.B[e][this.S++]=t},removeEventListener:function(e,t){var n,r,i=this.B[e],o=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&o.push(r);for(n=0;n<o.length;n++)delete i[r=o[n]]},U:function(){s(this,1)},W:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),s(this,0)},X:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),s(this,0)},V:function(){s(this,2)},R:function(e){var t;e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,!window.orientation||"number"==typeof(t=window.orientation)&&this.addEntropy(t,1,"accelerometer"),e&&this.addEntropy(e,2,"accelerometer"),s(this,0)}},y.random=new y.prng(6);e:try{if(i=e.exports){try{o=g}catch(e){o=null}i=n=o}if(i&&n.randomBytes)t=n.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),y.random.addEntropy(t,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(r);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break e;window.msCrypto.getRandomValues(r)}y.random.addEntropy(r,1024,"crypto['getRandomValues']")}}catch(e){}e.exports&&(e.exports=y)});function Si(n){return Object.keys(n).reduce(function(e,t){return e[t.replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1_$2").toLowerCase()]=n[t],e},{})}var he="https://assets.qa.braintreepayments.com/data",Ei={development:he,qa:he,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"},Ai={};function ki(e){var t=ki.getCachedDeviceData(e.merchantId);if(t)return this.deviceData=t,void(this._isCached=!0);this._currentEnvironment=this._initializeEnvironment(e),wi.random.startCollectors(),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),ki.setCachedDeviceData(e.merchantId,this.deviceData),this._iframe=this._setupIFrame()}ki.getCachedDeviceData=function(e){return Ai[e]},ki.setCachedDeviceData=function(e,t){Ai[e]=t},ki.prototype.teardown=function(){this._isCached||(wi.random.stopCollectors(),this._removeIframe())},ki.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},ki.prototype._getDeviceData=function(){return Si({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})},ki.prototype._generateDeviceSessionId=function(){var e=wi.random.randomWords(4,0);return wi.codec.hex.fromBits(e)},ki.prototype._setupIFrame=function(){var e=this,t="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId,n=document.createElement("iframe");return n.width=1,n.id="braintreeDataFrame-"+this._deviceSessionId,n.height=1,n.frameBorder=0,n.scrolling="no",document.body.appendChild(n),setTimeout(function(){n.src=e._currentEnvironment.url+"/logo.htm"+t,n.innerHTML='<img src="'+e._currentEnvironment.url+"/logo.gif"+t+'" />'},10),n},ki.prototype._initializeEnvironment=function(e){var t=Ei[e.environment];if(null==t)throw new Error(e.environment+" is not a valid environment for kount.environment");return{url:t,name:e.environment,id:e.merchantId}};var Ti={setup:function(e){return new ki(null!=e?e:{})},Kount:ki,environmentUrls:Ei};function Ci(){var e,t,n;this.sessionId=function(){var e,t="";for(e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16);return t}(),this._beaconId=(e=this.sessionId,t=(new Date).getTime()/1e3,"https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p="+e+"&t="+t+"&a=14"),this._parameterBlock=(e=this.sessionId,t=this._beaconId,(n=document.body.appendChild(document.createElement("script"))).type="application/json",n.setAttribute("fncls","fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99"),n.text=JSON.stringify({f:e,s:"BRAINTREE_SIGNIN",b:t}),n),this._thirdPartyBlock=function(){var t,n,r=document.createElement("iframe");r.src="about:blank",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width: 0; height: 0; border: 0; position: absolute; z-index: -999",document.body.appendChild(r);try{n=r.contentWindow.document}catch(e){t=document.domain,r.src='javascript:var d=document.open();d.domain="'+t+'";void(0);',n=r.contentWindow.document}function e(){n._l()}n.open()._l=function(){var e=this.createElement("script");t&&(this.domain=t),e.id="js-iframe-async",e.src="https://www.paypalobjects.com/webstatic/r/fb/fb-all-prod.pp.min.js",this.body.appendChild(e)},r.addEventListener?r.addEventListener("load",e,!1):r.attachEvent?r.attachEvent("onload",e):n.write('<body onload="document._l();">');return n.close(),r}()}Ci.prototype.teardown=function(){this._thirdPartyBlock.parentNode.removeChild(this._thirdPartyBlock)};var Ii={setup:function(){return new Ci}},xi={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:f.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_NOT_ENABLED",message:"Kount is not enabled for this merchant."},DATA_COLLECTOR_KOUNT_ERROR:{type:f.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_ERROR"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:f.types.MERCHANT,code:"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS",message:"Data Collector must be created with Kount and/or PayPal."}};be={create:sr(function(r){var n,i,o={},a=[],s=(n=o,i=a,sr(function(){return new u(function(e){for(var t=0;t<i.length;t++)i[t].teardown();nr(n,er(n)),e()})}));return dr.verify({name:"Data Collector",client:r.client}).then(function(){var e,t,n=r.client.getConfiguration();if(!0===r.kount){if(!n.gatewayConfiguration.kount)return u.reject(new f(xi.DATA_COLLECTOR_KOUNT_NOT_ENABLED));try{t=Ti.setup({environment:n.gatewayConfiguration.environment,merchantId:n.gatewayConfiguration.kount.kountMerchantId})}catch(e){return u.reject(new f({type:xi.DATA_COLLECTOR_KOUNT_ERROR.type,code:xi.DATA_COLLECTOR_KOUNT_ERROR.code,message:e.message}))}e=t.deviceData,a.push(t)}else e={};return!0===r.paypal&&(n=Ii.setup(),e.correlation_id=n.sessionId,a.push(n)),0===a.length?u.reject(new f(xi.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS)):(o.deviceData=JSON.stringify(e),o.rawDeviceData=e,o.teardown=s,o)})}),VERSION:"3.29.0"};function Pi(){this._teardownRegistry=[],this._isTearingDown=!1}Pi.prototype.registerFunctionForTeardown=function(e){"function"==typeof e&&this._teardownRegistry.push(e)},Pi.prototype.teardown=function(t){if(this._isTearingDown)t(new Error("Destructor is already tearing down"));else{this._isTearingDown=!0;var e,n,r,i=this._teardownRegistry,o=function(e){this._teardownRegistry=[],this._isTearingDown=!1,"function"==typeof t&&t(e)}.bind(this),a=i.length,s=a,c=xr(o);if(0!==a)for(e=0;e<a;e++)n=i[e],r=u,0===n.length?(n(),r(null)):n(r);else c(null);function u(e){e?c(e):0===--s&&c(null)}}};var Mi=Pi;function Oi(e){return e.className.trim().split(/\s+/)}function Ri(e){var t=Array.prototype.slice.call(arguments,1),n=Oi(e).filter(function(e){return-1===t.indexOf(e)}).concat(t).join(" ");e.className=n}function ji(e){var t=Array.prototype.slice.call(arguments,1),n=Oi(e).filter(function(e){return-1===t.indexOf(e)}).join(" ");e.className=n}function Di(e){var t=document.createElement("iframe");return(e=Bi({},$i,e)).style&&"string"!=typeof e.style&&(Bi(t.style,e.style),delete e.style),Li(t,e),t.getAttribute("id")||(t.id=t.name),t}var Ni={add:Ri,remove:ji,toggle:function(e,t,n){(n?Ri:ji)(e,t)}},Li=function(e,t){var n,r;for(r in t)t.hasOwnProperty(r)&&(null==(n=t[r])?e.removeAttribute(r):e.setAttribute(r,n))},$i={src:"about:blank",frameBorder:0,allowtransparency:!0,scrolling:"no"},Bi=function(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){"object"==typeof t&&Object.keys(t).forEach(function(e){n[e]=t[e]})}),n},Ui=v(function(i,a){function e(e){var t=p(this);return!s(e)&&(!s(t)&&(!1!==(e=h(e,Array.prototype.slice.call(arguments,1),t))&&(c(r.top||r.self,e,t),!0)))}function t(e,t){var n=p(this);return!v(e,t,n)&&(o[n]=o[n]||{},o[n][e]=o[n][e]||[],o[n][e].push(t),!0)}function f(e,t){var n,r,i=p(this);if(v(e,t,i))return!1;if(!(r=o[i]&&o[i][e]))return!1;for(n=0;n<r.length;n++)if(r[n]===t)return r.splice(n,1),!0;return!1}function p(e){return e&&e._origin||"*"}function s(e){return"string"!=typeof e}function h(e,t,n){var r,i,o,a=!1,e={event:e,origin:n},s=t[t.length-1];"function"==typeof s&&(e.reply=(r=s,i=n,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),u.target(i).subscribe(o,function e(t,n){r(t,n),u.target(i).unsubscribe(o,e)}),o),t=t.slice(0,-1)),e.args=t;try{a=d+JSON.stringify(e)}catch(e){throw new Error("Could not stringify event: "+e.message)}return a}function m(e){var t;if(!s(e.data)&&(t=function(e){var t,n,r,i;if(e.data.slice(0,d.length)!==d)return!1;try{t=JSON.parse(e.data.slice(d.length))}catch(e){return!1}return null!=t.reply&&(n=e.origin,r=e.source,i=t.reply,t.reply=function(e){e=h(i,[e],n);if(!1===e)return!1;r.postMessage(e,n)},t.args.push(t.reply)),t}(e))){g("*",t.event,t.args,e),g(e.origin,t.event,t.args,e);var n,r,i=e.data,o=t.origin,a=e.source;for(n=l.length-1;0<=n;n--)!0===(r=l[n]).closed?l=l.slice(n,1):a!==r&&c(r.top,i,o)}}function g(e,t,n,r){var i;if(o[e]&&o[e][t])for(i=0;i<o[e][t].length;i++)o[e][t][i].apply(r,n)}function c(e,t,n){var r,i;try{for(e.postMessage(t,n),(i=e).top===i&&(null!=i.opener&&(i.opener!==i&&!0!==i.opener.closed))&&c(e.opener.top,t,n),r=0;r<e.frames.length;r++)c(e.frames[r],t,n)}catch(e){}}function v(e,t,n){return s(e)||("function"!=typeof t||!!s(n))}var n,r,u,l,o,d;n=x,i.exports=(n=void 0===x?n:x,l=[],o={},d="/*framebus*/",r||((r=n).addEventListener?r.addEventListener("message",m,!1):r.attachEvent?r.attachEvent("onmessage",m):null===r.onmessage?r.onmessage=m:r=null),u={target:function(e){var t,n={};for(t in u)u.hasOwnProperty(t)&&(n[t]=u[t]);return n._origin=e||"*",n},include:function(e){return null!=e&&(null!=e.Window&&(e.constructor===e.Window&&(l.push(e),!0)))},publish:e,pub:e,trigger:e,emit:e,subscribe:t,sub:t,on:t,unsubscribe:f,unsub:f,off:f})}),He=Je(["CONFIGURATION_REQUEST"],"bus:");var Fi=function(e,t){var n=document.createElement("a");return n.href=t,t="https:"===n.protocol?n.host.replace(/:443$/,""):"http:"===n.protocol?n.host.replace(/:80$/,""):n.host,n.protocol+"//"+t===e||(n.href=e,li(e))};function zi(e){if(this.channel=(e=e||{}).channel,!this.channel)throw new f({type:f.types.INTERNAL,code:"MISSING_CHANNEL_ID",message:"Channel ID must be specified."});this.merchantUrl=e.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log("new bus on channel "+this.channel,[location.href])}zi.prototype.on=function(e,t){var n,r,i=t,o=this;this._isDestroyed||(this.merchantUrl&&(i=function(){Fi(this.origin,o.merchantUrl)&&t.apply(this,arguments)}),n=this._namespaceEvent(e),(r=Array.prototype.slice.call(arguments))[0]=n,r[1]=i,this._log("on",r),Ui.on.apply(Ui,r),this._listeners.push({eventName:e,handler:i,originalHandler:t}))},zi.prototype.emit=function(e){var t;this._isDestroyed||((t=Array.prototype.slice.call(arguments))[0]=this._namespaceEvent(e),this._log("emit",t),Ui.emit.apply(Ui,t))},zi.prototype._offDirect=function(e){var t=Array.prototype.slice.call(arguments);this._isDestroyed||(t[0]=this._namespaceEvent(e),this._log("off",t),Ui.off.apply(Ui,t))},zi.prototype.off=function(e,t){var n,r,i=t;if(!this._isDestroyed){if(this.merchantUrl)for(n=0;n<this._listeners.length;n++)(r=this._listeners[n]).originalHandler===t&&(i=r.handler);this._offDirect(e,i)}},zi.prototype._namespaceEvent=function(e){return["braintree",this.channel,e].join(":")},zi.prototype.teardown=function(){for(var e,t=0;t<this._listeners.length;t++)e=this._listeners[t],this._offDirect(e.eventName,e.handler);this._listeners.length=0,this._isDestroyed=!0},zi.prototype._log=function(e,t){this._isVerbose},zi.events=He;var Vi=zi,m={HOSTED_FIELDS_TIMEOUT:{type:f.types.UNKNOWN,code:"HOSTED_FIELDS_TIMEOUT",message:"Hosted Fields timed out when attempting to set up."},HOSTED_FIELDS_INVALID_FIELD_KEY:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_KEY"},HOSTED_FIELDS_INVALID_FIELD_SELECTOR:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_SELECTOR",message:"Selector does not reference a valid DOM node."},HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME",message:"Element already contains a Braintree iframe."},HOSTED_FIELDS_FIELD_INVALID:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_INVALID"},HOSTED_FIELDS_FIELD_NOT_PRESENT:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_NOT_PRESENT"},HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR:{type:f.types.NETWORK,code:"HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE:{type:f.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE",message:"This credit card already exists in the merchant's vault."},HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED:{type:f.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED",message:"CVV verification failed during tokenization."},HOSTED_FIELDS_FAILED_TOKENIZATION:{type:f.types.CUSTOMER,code:"HOSTED_FIELDS_FAILED_TOKENIZATION",message:"The supplied card data failed tokenization."},HOSTED_FIELDS_FIELDS_EMPTY:{type:f.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_EMPTY",message:"All fields are empty. Cannot tokenize empty card fields."},HOSTED_FIELDS_FIELDS_INVALID:{type:f.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_INVALID",message:"Some payment input fields are invalid. Cannot tokenize invalid card fields."},HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED"},HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED"},HOSTED_FIELDS_FIELD_PROPERTY_INVALID:{type:f.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_PROPERTY_INVALID"}},t={VERSION:"3.29.0",maxExpirationYearAge:19,externalEvents:{FOCUS:"focus",BLUR:"blur",EMPTY:"empty",NOT_EMPTY:"notEmpty",VALIDITY_CHANGE:"validityChange",CARD_TYPE_CHANGE:"cardTypeChange"},defaultMaxLengths:{number:19,postalCode:8,expirationDate:7,expirationMonth:2,expirationYear:4,cvv:3},externalClasses:{FOCUSED:"braintree-hosted-fields-focused",INVALID:"braintree-hosted-fields-invalid",VALID:"braintree-hosted-fields-valid"},defaultIFrameStyle:{border:"none",width:"100%",height:"100%",float:"left"},tokenizationErrorCodes:{81724:m.HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE,81736:m.HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED},whitelistedStyles:["-moz-appearance","-moz-osx-font-smoothing","-moz-tap-highlight-color","-moz-transition","-webkit-appearance","-webkit-font-smoothing","-webkit-tap-highlight-color","-webkit-transition","appearance","color","direction","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","letter-spacing","line-height","opacity","outline","text-shadow","transition"],whitelistedFields:{number:{name:"credit-card-number",label:"Credit Card Number"},cvv:{name:"cvv",label:"CVV"},expirationDate:{name:"expiration",label:"Expiration Date"},expirationMonth:{name:"expiration-month",label:"Expiration Month"},expirationYear:{name:"expiration-year",label:"Expiration Year"},postalCode:{name:"postal-code",label:"Postal Code"}},whitelistedAttributes:{"aria-invalid":"boolean","aria-required":"boolean",disabled:"boolean",placeholder:"string"}},Hi=(t.events=Je(["FRAME_READY","VALIDATE_STRICT","CONFIGURATION","TOKENIZATION_REQUEST","INPUT_EVENT","TRIGGER_INPUT_FOCUS","ADD_CLASS","REMOVE_CLASS","SET_ATTRIBUTE","REMOVE_ATTRIBUTE","CLEAR_FIELD","AUTOFILL_EXPIRATION_DATE","SET_MESSAGE"],"hosted-fields:"),t);var qi=function(e){return e?"":".min"};function Wi(e){return e=e||x.navigator.userAgent,/iPhone|iPod|iPad/i.test(e)}var Yi=function(e,t){for(var n=e.parentNode,r=[];null!=n;)null!=n.tagName&&n.tagName.toLowerCase()===t&&r.push(n),n=n.parentNode;return r};function Gi(e){return e=e||x.navigator.userAgent,!!Wi(e)&&(!!/\bGSA\b/.test(e)||/.+AppleWebKit(?!.*Safari)/.test(e))}var Ki={isIe9:Er,isIos:Wi,isIosWebview:Gi};function Ji(){this._events={}}Ji.prototype.on=function(e,t){this._events[e]?this._events[e].push(t):this._events[e]=[t]},Ji.prototype._emit=function(e){var t,n,r=this._events[e];if(r)for(n=Array.prototype.slice.call(arguments,1),t=0;t<r.length;t++)r[t].apply(null,n)};var Qi=Ji,Xi={},xn="visa",Pn="master-card",Ln="american-express",dt="diners-club",Se="discover",e="jcb",ye="unionpay",fe="maestro",Zi=[xn,Pn,Ln,dt,Se,e,ye,fe];function eo(e){return e?(delete(e=JSON.parse(JSON.stringify(e))).prefixPattern,delete e.exactPattern,e):null}function to(e){var t,n,r=[],i=[];if(!("string"==typeof e||e instanceof String))return[];for(n=0;n<Zi.length;n++)t=Xi[Zi[n]],0!==e.length?t.exactPattern.test(e)?i.push(eo(t)):t.prefixPattern.test(e)&&r.push(eo(t)):r.push(eo(t));return i.length?i:r}Xi[xn]={niceType:"Visa",type:xn,prefixPattern:/^4$/,exactPattern:/^4\d*$/,gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},Xi[Pn]={niceType:"Mastercard",type:Pn,prefixPattern:/^(5|5[1-5]|2|22|222|222[1-9]|2[3-6]|27|27[0-2]|2720)$/,exactPattern:/^(5[1-5]|222[1-9]|22[3-9]|2[3-6]|27[0-1]|2720)\d*$/,gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},Xi[Ln]={niceType:"American Express",type:Ln,prefixPattern:/^(3|34|37)$/,exactPattern:/^3[47]\d*$/,isAmex:!0,gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},Xi[dt]={niceType:"Diners Club",type:dt,prefixPattern:/^(3|3[0689]|30[0-5])$/,exactPattern:/^3(0[0-5]|[689])\d*$/,gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},Xi[Se]={niceType:"Discover",type:Se,prefixPattern:/^(6|60|601|6011|65|64|64[4-9])$/,exactPattern:/^(6011|65|64[4-9])\d*$/,gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},Xi.jcb={niceType:"JCB",type:e,prefixPattern:/^(2|21|213|2131|1|18|180|1800|3|35)$/,exactPattern:/^(2131|1800|35)\d*$/,gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},Xi[ye]={niceType:"UnionPay",type:ye,prefixPattern:/^((6|62|62\d|(621(?!83|88|98|99))|622(?!06)|627[02,06,07]|628(?!0|1)|629[1,2])|622018)$/,exactPattern:/^(((620|(621(?!83|88|98|99))|622(?!06|018)|62[3-6]|627[02,06,07]|628(?!0|1)|629[1,2]))\d*|622018\d{12})$/,gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVN",size:3}},Xi[fe]={niceType:"Maestro",type:fe,prefixPattern:/^(5|5[06-9]|6\d*)$/,exactPattern:/^(5[06-9]|6[37])\d*$/,gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},to.getTypeInfo=function(e){return eo(Xi[e])},to.types={VISA:xn,MASTERCARD:Pn,AMERICAN_EXPRESS:Ln,DINERS_CLUB:dt,DISCOVER:Se,JCB:e,UNIONPAY:ye,MAESTRO:fe};var no=to,ro=Hi.whitelistedAttributes;var io=function(e,t){var n;return ro.hasOwnProperty(e)?null==t||function(e,t){{if("string"===ro[e])return"string"==typeof t||"number"==typeof t;if("boolean"===ro[e])return"true"===String(t)||"false"===String(t)}return!1}(e,t)||(n=new f({type:m.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.type,code:m.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.code,message:'Value "'+t+'" is not allowed for "'+e+'" attribute.'})):n=new f({type:m.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.type,code:m.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.code,message:'The "'+e+'" attribute is not supported in Hosted Fields.'}),n},oo=fr.INTEGRATION_TIMEOUT_MS,ao=Hi.events,so=Hi.whitelistedFields;function co(a){return function(e){var t,n,r=e.merchantPayload,i=r.emittedBy,o=a[i].containerElement;Object.keys(r.fields).forEach(function(e){r.fields[e].container=a[e].containerElement}),i=r.fields[i],"blur"===e.type&&(t=o,Ki.isIos()&&document.activeElement===document.body&&((n=t.querySelector("input"))||((n=document.createElement("input")).type="button",n.style.height="0px",n.style.width="0px",n.style.opacity="0",n.style.padding="0",n.style.position="absolute",n.style.left="-200%",n.style.top="0px",t.insertBefore(n,t.firstChild)),n.focus(),n.blur())),Ni.toggle(o,Hi.externalClasses.FOCUSED,i.isFocused),Ni.toggle(o,Hi.externalClasses.VALID,i.isValid),Ni.toggle(o,Hi.externalClasses.INVALID,!i.isPotentiallyValid),this._state={cards:r.cards,fields:r.fields},this._emit(e.type,r)}}function uo(s){var t,r=this,c={},u=0,l=Pr(),d=s.client.getConfiguration();if(!s.fields)throw new f({type:tr.INSTANTIATION_OPTION_REQUIRED.type,code:tr.INSTANTIATION_OPTION_REQUIRED.code,message:"options.fields is required when instantiating Hosted Fields."});Qi.call(this),this._injectedNodes=[],this._destructor=new Mi,this._fields=c,this._state={fields:{},cards:no("")},this._bus=new Vi({channel:l,merchantUrl:location.href}),this._destructor.registerFunctionForTeardown(function(){r._bus.teardown()}),this._client=s.client,h.sendEvent(this._client,"custom.hosted-fields.initialized"),Object.keys(s.fields).forEach(function(e){var t,r,n,i,o,a;if(!Hi.whitelistedFields.hasOwnProperty(e))throw new f({type:m.HOSTED_FIELDS_INVALID_FIELD_KEY.type,code:m.HOSTED_FIELDS_INVALID_FIELD_KEY.code,message:'"'+e+'" is not a valid field.'});if(n=s.fields[e],!(t=document.querySelector(n.selector)))throw new f({type:m.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.type,code:m.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.code,message:m.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.message,details:{fieldSelector:n.selector,fieldKey:e}});if(t.querySelector('iframe[name^="braintree-"]'))throw new f({type:m.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.type,code:m.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.code,message:m.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.message,details:{fieldSelector:n.selector,fieldKey:e}});if(n.maxlength&&"number"!=typeof n.maxlength)throw new f({type:m.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:m.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for maxlength must be a number.",details:{fieldKey:e}});if(n.minlength&&"number"!=typeof n.minlength)throw new f({type:m.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:m.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for minlength must be a number.",details:{fieldKey:e}});r=Di({type:e,name:"braintree-hosted-field-"+e,style:Hi.defaultIFrameStyle}),this._injectedNodes=this._injectedNodes.concat((n=r,i=t,o=document.createElement("div"),a=document.createDocumentFragment(),o.style.clear="both",a.appendChild(n),a.appendChild(o),i.appendChild(a),[n,o])),this._setupLabelFocus(e,t),c[e]={frameElement:r,containerElement:t},u++,this._state.fields[e]={isEmpty:!0,isValid:!1,isPotentiallyValid:!0,isFocused:!1,container:t},setTimeout(function(){x.navigator&&x.navigator.vendor&&-1===x.navigator.vendor.indexOf("Apple")&&(r.src="about:blank"),setTimeout(function(){var e,t,n;r.src=(e=d.gatewayConfiguration.assetsUrl,t=l,n=d.isDebug,e+"/web/"+Hi.VERSION+"/html/hosted-fields-frame"+qi(n)+".html#"+t)},0)},0)}.bind(this)),t=setTimeout(function(){h.sendEvent(r._client,"custom.hosted-fields.load.timed-out"),r._emit("timeout")},oo),this._bus.on(ao.FRAME_READY,function(e){0===--u&&(clearTimeout(t),e(s),r._emit("ready"))}),this._bus.on(ao.INPUT_EVENT,co(c).bind(this)),this._destructor.registerFunctionForTeardown(function(){for(var e,t,n=0;n<r._injectedNodes.length;n++)(t=(e=r._injectedNodes[n]).parentNode).removeChild(e),Ni.remove(t,Hi.externalClasses.FOCUSED,Hi.externalClasses.INVALID,Hi.externalClasses.VALID)}),this._destructor.registerFunctionForTeardown(function(){var e=er(uo.prototype).concat(er(Qi.prototype));nr(r,e)})}(uo.prototype=Object.create(Qi.prototype,{constructor:uo}))._setupLabelFocus=function(e,t){var n,r,i=Ki.isIos(),o=this._bus;if(!i&&null!=t.id){for(n=(n=Array.prototype.slice.call(document.querySelectorAll('label[for="'+t.id+'"]'))).concat(Yi(t,"label")),r=0;r<n.length;r++)n[r].addEventListener("click",a,!1);this._destructor.registerFunctionForTeardown(function(){for(r=0;r<n.length;r++)n[r].removeEventListener("click",a,!1)})}function a(){o.emit(ao.TRIGGER_INPUT_FOCUS,e)}},uo.prototype.teardown=function(){var r=this;return new u(function(t,n){r._destructor.teardown(function(e){h.sendEvent(r._client,"custom.hosted-fields.teardown-completed"),e?n(e):t()})})},uo.prototype.tokenize=function(e){var t=this;return e=e||{},new u(function(n,r){t._bus.emit(ao.TOKENIZATION_REQUEST,e,function(e){var t=e[0],e=e[1];t?r(t):n(e)})})},uo.prototype.addClass=function(e,t){var n;return so.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(ao.ADD_CLASS,e,t):n=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot add class to "'+e+'" field because it is not part of the current Hosted Fields options.'}):n=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when adding a class.'}),n?u.reject(n):u.resolve()},uo.prototype.removeClass=function(e,t){var n;return so.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(ao.REMOVE_CLASS,e,t):n=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove class from "'+e+'" field because it is not part of the current Hosted Fields options.'}):n=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when removing a class.'}),n?u.reject(n):u.resolve()},uo.prototype.setAttribute=function(e){var t,n;return so.hasOwnProperty(e.field)?this._fields.hasOwnProperty(e.field)?(t=io(e.attribute,e.value))?n=t:this._bus.emit(ao.SET_ATTRIBUTE,e.field,e.attribute,e.value):n=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot set attribute for "'+e.field+'" field because it is not part of the current Hosted Fields options.'}):n=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e.field+'" is not a valid field. You must use a valid field option when setting an attribute.'}),n?u.reject(n):u.resolve()},uo.prototype.setMessage=function(e){this._bus.emit(ao.SET_MESSAGE,e.field,e.message)},uo.prototype.removeAttribute=function(e){var t,n;return so.hasOwnProperty(e.field)?this._fields.hasOwnProperty(e.field)?(t=io(e.attribute))?n=t:this._bus.emit(ao.REMOVE_ATTRIBUTE,e.field,e.attribute):n=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove attribute for "'+e.field+'" field because it is not part of the current Hosted Fields options.'}):n=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e.field+'" is not a valid field. You must use a valid field option when removing an attribute.'}),n?u.reject(n):u.resolve()},uo.prototype.setPlaceholder=function(e,t){return this.setAttribute({field:e,attribute:"placeholder",value:t})},uo.prototype.clear=function(e){var t;return so.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(ao.CLEAR_FIELD,e):t=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot clear "'+e+'" field because it is not part of the current Hosted Fields options.'}):t=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when clearing a field.'}),t?u.reject(t):u.resolve()},uo.prototype.focus=function(e){var t;return so.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(ao.TRIGGER_INPUT_FOCUS,e):t=new f({type:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:m.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot focus "'+e+'" field because it is not part of the current Hosted Fields options.'}):t=new f({type:m.HOSTED_FIELDS_FIELD_INVALID.type,code:m.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when focusing a field.'}),t?u.reject(t):u.resolve()},uo.prototype.getState=function(){return this._state};var lo=sr.wrapPrototype(uo),fo=function(e){return e=e||x.navigator.userAgent,/Android/.test(e)},po=function(e){return-1!==(e=e||navigator.userAgent).indexOf("Edge/")},ho=function(e){return e=e||x.navigator.userAgent,/SamsungBrowser/i.test(e)},mo=function(e){return!(-1===(e=e||navigator.userAgent).indexOf("Chrome")&&-1===e.indexOf("CriOS")||po(e)||ho(e))},go=x.navigator&&x.navigator.userAgent,vo=/Version\/\d\.\d* Chrome\/\d*\.0\.0\.0/;var yo={isIE9:Er,isAndroidChrome:function(e){return fo(e=e||go)&&mo(e)},isIos:Wi,isKitKatWebview:function(e){return fo(e=e||go)&&vo.test(e)},isSamsungBrowser:function(e){return e=e||go,/SamsungBrowser/.test(e)||!mo(e=e)&&-1<e.indexOf("Samsung")}};function bo(e){return e=e||x.navigator.userAgent,/FxiOS/i.test(e)}var ge={supportsInputFormatting:function(){return!yo.isSamsungBrowser()},create:sr(function(e){return dr.verify({name:"Hosted Fields",client:e.client}).then(function(){var n=new lo(e);return new u(function(e,t){n.on("ready",function(){e(n)}),n.on("timeout",function(){t(new f(m.HOSTED_FIELDS_TIMEOUT))})})})}),VERSION:"3.29.0"},_o=48;function wo(e){return-1<(e=e||x.navigator.userAgent).indexOf("Opera Mini")}function So(e){return e=e||x.navigator.userAgent,!(Gi(e)||bo(e)||(t=(t=e)||x.navigator.userAgent,fo(t)&&(/Version\/[\d\.]+/.test(t)&&!wo(t)))||wo(e)||(t=(t=(t=e)||x.navigator.userAgent).match(/CriOS\/(\d+)\./))&&parseInt(t[1],10)<_o||!mo(e=e)&&!ho(e)&&/samsung/i.test(e));var t}var Eo=So,Ao={DISPATCH_FRAME_NAME:"dispatch",DISPATCH_FRAME_CLASS:"braintree-dispatch-frame",POPUP_BASE_OPTIONS:"resizable,scrollbars",DEFAULT_POPUP_WIDTH:450,DEFAULT_POPUP_HEIGHT:535,POPUP_POLL_INTERVAL:100,POPUP_CLOSE_TIMEOUT:100};function ko(e,t,n){return(e-t)/2+n}var To={top:function(e){return((x.outerHeight||document.documentElement.clientHeight)-e)/2+(null==x.screenY?x.screenTop:x.screenY)},left:function(e){return((x.outerWidth||document.documentElement.clientWidth)-e)/2+(null==x.screenX?x.screenLeft:x.screenX)},center:ko};function Co(e,t,n){return void 0!==t?t:To[e](n)}function Io(e){this._frame=null,this._options=e||{},this.open()}Io.prototype.initialize=function(){},Io.prototype.open=function(){var e,t,n,r;this._frame=x.open(this._options.openFrameUrl,this._options.name,(e=this._options,t=e.height||Ao.DEFAULT_POPUP_HEIGHT,n=e.width||Ao.DEFAULT_POPUP_WIDTH,r=Co("top",e.top,t),e=Co("left",e.left,n),[Ao.POPUP_BASE_OPTIONS,"height="+t,"width="+n,"top="+r,"left="+e].join(",")))},Io.prototype.focus=function(){this._frame.focus()},Io.prototype.close=function(){this._frame.close()},Io.prototype.isClosed=function(){return this._frame&&Boolean(this._frame.closed)},Io.prototype.redirect=function(e){this._frame.location.href=e};var xo=Io,Po={FRAME_SERVICE_FRAME_CLOSED:{type:f.types.INTERNAL,code:"FRAME_SERVICE_FRAME_CLOSED",message:"Frame closed before tokenization could occur."},FRAME_SERVICE_FRAME_OPEN_FAILED:{type:f.types.INTERNAL,code:"FRAME_SERVICE_FRAME_OPEN_FAILED",message:"Frame failed to open."}};function Mo(){}function Oo(e){this._closed=null,this._options=e}Oo.prototype.initialize=function(r){var i=this;x.popupBridge.onComplete=function(e,t){var n=!t&&!e;i._closed=!0,e||n?r(new f(Po.FRAME_SERVICE_FRAME_CLOSED)):r(null,t)}},Oo.prototype.open=function(e){e=(e=e||{}).openFrameUrl||this._options.openFrameUrl;this._closed=!1,x.popupBridge.open(e)},Oo.prototype.focus=Mo,Oo.prototype.close=Mo,Oo.prototype.isClosed=function(){return Boolean(this._closed)},Oo.prototype.redirect=function(e){this.open({openFrameUrl:e})};var Ro=Oo,jo=Wi,Do=function(e,t){return t=void 0!==t?t:x.statusbar.visible,Gi(e)&&t},No=So,Lo=ve.assign,$o={position:"fixed",top:0,left:0,bottom:0,padding:0,margin:0,border:0,outline:"none",zIndex:20001,background:"#FFFFFF"};function Bo(){}function Uo(e){this._closed=null,this._frame=null,this._options=e||{},this._container=this._options.container||document.body}Uo.prototype.initialize=Bo,Uo.prototype.open=function(){var e={src:this._options.openFrameUrl,name:this._options.name,scrolling:"yes",height:"100%",width:"100%",style:Lo({},$o)};jo()?(Do()&&(this._lockScrolling(),e.style={}),this._el=document.createElement("div"),Lo(this._el.style,$o,{height:"100%",width:"100%",overflow:"auto","-webkit-overflow-scrolling":"touch"}),this._frame=Di(e),this._el.appendChild(this._frame)):this._el=this._frame=Di(e),this._closed=!1,this._container.appendChild(this._el)},Uo.prototype.focus=Bo,Uo.prototype.close=function(){this._container.removeChild(this._el),this._frame=null,this._closed=!0,Do()&&this._unlockScrolling()},Uo.prototype.isClosed=function(){return Boolean(this._closed)},Uo.prototype.redirect=function(e){this._frame.src=e},Uo.prototype._unlockScrolling=function(){document.body.style.overflow=this._savedBodyProperties.overflowStyle,document.body.style.position=this._savedBodyProperties.positionStyle,x.scrollTo(this._savedBodyProperties.left,this._savedBodyProperties.top),delete this._savedBodyProperties},Uo.prototype._lockScrolling=function(){var e=document.documentElement;this._savedBodyProperties={left:(x.pageXOffset||e.scrollLeft)-(e.clientLeft||0),top:(x.pageYOffset||e.scrollTop)-(e.clientTop||0),overflowStyle:document.body.style.overflow,positionStyle:document.body.style.position},document.body.style.overflow="hidden",document.body.style.position="fixed",x.scrollTo(0,0)};var Fo=Uo,zo=Je(["DISPATCH_FRAME_READY","DISPATCH_FRAME_REPORT"],"frameService:"),Vo=ve.assign,Ho=["name","dispatchFrameUrl","openFrameUrl"];function qo(){}function Wo(e){var t=e;if(!t)throw new Error("Valid configuration is required");if(Ho.forEach(function(e){if(!t.hasOwnProperty(e))throw new Error("A valid frame "+e+" must be provided")}),!/^[\w_]+$/.test(t.name))throw new Error("A valid frame name must be provided");this._serviceId=Pr().replace(/-/g,""),this._options={name:e.name+"_"+this._serviceId,dispatchFrameUrl:e.dispatchFrameUrl,openFrameUrl:e.openFrameUrl,height:e.height,width:e.width,top:e.top,left:e.left},this.state=e.state||{},this._bus=new Vi({channel:this._serviceId}),this._setBusEvents()}Wo.prototype.initialize=function(e){var t=function(){e(),this._bus.off(zo.DISPATCH_FRAME_READY,t)}.bind(this);this._bus.on(zo.DISPATCH_FRAME_READY,t),this._writeDispatchFrame()},Wo.prototype._writeDispatchFrame=function(){var e=Ao.DISPATCH_FRAME_NAME+"_"+this._serviceId,t=this._options.dispatchFrameUrl;this._dispatchFrame=Di({name:e,src:t,class:Ao.DISPATCH_FRAME_CLASS,height:0,width:0,style:{position:"absolute",left:"-9999px"}}),document.body.appendChild(this._dispatchFrame)},Wo.prototype._setBusEvents=function(){this._bus.on(zo.DISPATCH_FRAME_REPORT,function(e,t){this._onCompleteCallback&&this._onCompleteCallback.call(null,e.err,e.payload),this._frame.close(),this._onCompleteCallback=null,t&&t()}.bind(this)),this._bus.on(Vi.events.CONFIGURATION_REQUEST,function(e){e(this.state)}.bind(this))},Wo.prototype.open=function(e,t){if(this._frame=this._getFrameForEnvironment(e=e||{}),this._frame.initialize(t),!(this._frame instanceof Ro)){if(Vo(this.state,e.state),this._onCompleteCallback=t,this._frame.open(),this.isFrameClosed())return this._cleanupFrame(),void(t&&t(new f(Po.FRAME_SERVICE_FRAME_OPEN_FAILED)));this._pollForPopupClose()}},Wo.prototype.redirect=function(e){this._frame&&!this.isFrameClosed()&&this._frame.redirect(e)},Wo.prototype.close=function(){this.isFrameClosed()||this._frame.close()},Wo.prototype.focus=function(){this.isFrameClosed()||this._frame.focus()},Wo.prototype.createHandler=function(e){return e=e||{},{close:function(){e.beforeClose&&e.beforeClose(),this.close()}.bind(this),focus:function(){e.beforeFocus&&e.beforeFocus(),this.focus()}.bind(this)}},Wo.prototype.createNoopHandler=function(){return{close:qo,focus:qo}},Wo.prototype.teardown=function(){this.close(),this._dispatchFrame.parentNode.removeChild(this._dispatchFrame),this._dispatchFrame=null,this._cleanupFrame()},Wo.prototype.isFrameClosed=function(){return null==this._frame||this._frame.isClosed()},Wo.prototype._cleanupFrame=function(){this._frame=null,clearInterval(this._popupInterval),this._popupInterval=null},Wo.prototype._pollForPopupClose=function(){return this._popupInterval=setInterval(function(){this.isFrameClosed()&&(this._cleanupFrame(),this._onCompleteCallback&&this._onCompleteCallback(new f(Po.FRAME_SERVICE_FRAME_CLOSED)))}.bind(this),Ao.POPUP_POLL_INTERVAL),this._popupInterval},Wo.prototype._getFrameForEnvironment=function(e){var t=No(),n=Boolean(x.popupBridge),e=Vo({},this._options,e);return new(n?Ro:t?xo:Fo)(e)};var Yo=Wo,Go=function(e,t){var n=new Yo(e);n.initialize(function(){t(n)})},Ko={IDEAL_BROWSER_NOT_SUPPORTED:{type:f.types.CUSTOMER,code:"IDEAL_BROWSER_NOT_SUPPORTED",message:"Browser is not supported."},IDEAL_NOT_ENABLED:{type:f.types.MERCHANT,code:"IDEAL_NOT_ENABLED",message:"iDEAL is not enabled for this merchant."},IDEAL_PAYMENT_ALREADY_IN_PROGRESS:{type:f.types.MERCHANT,code:"IDEAL_PAYMENT_ALREADY_IN_PROGRESS",message:"iDEAL payment is already in progress."},IDEAL_PAYMENT_NOT_COMPLETE_OR_PENDING:{code:"IDEAL_PAYMENT_NOT_COMPLETE_OR_PENDING",type:f.types.CUSTOMER},IDEAL_WINDOW_CLOSED:{type:f.types.CUSTOMER,code:"IDEAL_WINDOW_CLOSED",message:"Customer closed iDEAL window before authorizing."},IDEAL_WINDOW_OPEN_FAILED:{type:f.types.MERCHANT,code:"IDEAL_WINDOW_OPEN_FAILED",message:"iDEAL window failed to open; make sure startPayment was called in response to a user action."},IDEAL_START_PAYMENT_FAILED:{type:f.types.NETWORK,code:"IDEAL_START_PAYMENT_FAILED",message:"iDEAL startPayment failed."},IDEAL_START_PAYMENT_UNEXPECTED_STATUS:{type:f.types.INTERNAL,code:"IDEAL_START_PAYMENT_UNEXPECTED_STATUS",message:"iDEAL startPayment returned an unexpected status without an error."},IDEAL_START_PAYMENT_MISSING_REQUIRED_OPTION:{type:f.types.MERCHANT,code:"IDEAL_START_PAYMENT_MISSING_REQUIRED_OPTION",message:"Missing required option for startPayment."}},Jo={MAX_TRANSACTION_STATUS_POLLING_RETRIES:5,POLL_RETRY_TIME:1e4,REQUIRED_OPTIONS_FOR_START_PAYMENT:["orderId","amount","currency"]},Qo=Je(["BANK_CHOSEN","REDIRECT_PAGE_REACHED"],"ideal:"),Xo=fr.INTEGRATION_TIMEOUT_MS;function Zo(e){var t=e.client.getConfiguration();this._client=e.client,this._assetsUrl=t.gatewayConfiguration.ideal.assetsUrl+"/web/3.29.0",this._isDebug=t.isDebug,this._idealPaymentStatus={authInProgress:!1,id:"",status:""}}Zo.prototype._initialize=function(){var n=this,r=setTimeout(function(){h.sendEvent(n._client,"ideal.load.timed-out")},Xo);return this._client.request({api:"braintreeApi",method:"get",endpoint:"issuers/ideal"}).then(function(e){return new u(function(t){Go({name:"braintreeideallanding",height:550,width:960,dispatchFrameUrl:n._assetsUrl+"/html/dispatch-frame"+qi(n._isDebug)+".html",openFrameUrl:n._assetsUrl+"/html/ideal-issuers-frame"+qi(n._isDebug)+".html",state:{bankData:e.data}},function(e){n._frameService=e,clearTimeout(r),h.sendEvent(n._client,"ideal.load.succeeded"),n._frameService._bus.on(Qo.BANK_CHOSEN,n._createBankChosenHandler()),n._frameService._bus.on(Qo.REDIRECT_PAGE_REACHED,n._createRedirectPageReachedHandler()),t(n)})})})},Zo.prototype.startPayment=sr(function(n){var r=this;return new u(function(e,t){if(n&&!function(e){var t,n;for(t=0;t<Jo.REQUIRED_OPTIONS_FOR_START_PAYMENT.length;t++)if(n=Jo.REQUIRED_OPTIONS_FOR_START_PAYMENT[t],!e.hasOwnProperty(n))return!0;return!1}(n)){if(r._idealPaymentStatus.authInProgress)return h.sendEvent(r._client,"ideal.start-payment.error.already-opened"),void t(new f(Ko.IDEAL_PAYMENT_ALREADY_IN_PROGRESS));r._idealPaymentStatus.authInProgress=!0,h.sendEvent(r._client,"ideal.start-payment.opened"),r._startPaymentCallback=r._createStartPaymentCallback(e,t),r._startPaymentOptions=n,r._frameService.open({state:{locale:n.locale}},r._startPaymentCallback)}else t(new f(Ko.IDEAL_START_PAYMENT_MISSING_REQUIRED_OPTION))})}),Zo.prototype.closeWindow=function(){this._idealPaymentStatus.authInProgress&&h.sendEvent(this._client,"ideal.start-payment.closed.by-merchant"),this._frameService.close()},Zo.prototype.focusWindow=function(){this._frameService.focus()},Zo.prototype._createRedirectPageReachedHandler=function(){var e=this;return function(){e._pollForCompleteTransactionStatus(0)}},Zo.prototype._createStartPaymentCallback=function(r,i){var o=this;return function(e){var t=o._idealPaymentStatus.id,n=o._idealPaymentStatus.status;if(o._idealPaymentStatus.authInProgress=!1,delete o._idealPaymentStatus.id,delete o._idealPaymentStatus.status,o._frameService.close(),function(e,t){if(e&&"FRAME_SERVICE_FRAME_CLOSED"!==e.code)return!1;return"COMPLETE"===t||"PENDING"===t}(e,n))return h.sendEvent(o._client,"ideal.start-payment.success-"+n.toLowerCase()),void r({nonce:t,type:"IdealPayment",details:{id:t,status:n}});if(e){if("FRAME_SERVICE_FRAME_CLOSED"===e.code)return h.sendEvent(o._client,"ideal.start-payment.closed.by-user"),void i(new f(Ko.IDEAL_WINDOW_CLOSED));"FRAME_SERVICE_FRAME_OPEN_FAILED"!==e.code?(h.sendEvent(o._client,"ideal.start-payment.failed"),i(fi(e,Ko.IDEAL_START_PAYMENT_FAILED))):i(new f(Ko.IDEAL_WINDOW_OPEN_FAILED))}else i(new f(Ko.IDEAL_START_PAYMENT_UNEXPECTED_STATUS))}},Zo.prototype._createBankChosenHandler=function(){var r=this;return function(e){var t=r._startPaymentOptions,n="function"==typeof t.onPaymentStart?xr(di(t.onPaymentStart)):function(){};r._client.request({api:"braintreeApi",method:"post",data:{route_id:r._client.getConfiguration().gatewayConfiguration.ideal.routeId,issuer:e.issuingBankId,order_id:t.orderId,amount:t.amount,currency:t.currency,descriptor:t.descriptor,redirect_url:r._assetsUrl+"/html/ideal-redirect-frame.html"},endpoint:"ideal-payments"}).then(function(e){n({id:e.data.id,status:e.data.status}),r._idealPaymentStatus.id=e.data.id,r._idealPaymentStatus.status=e.data.status,r._frameService.redirect(e.data.approval_url)}).catch(function(e){r._idealPaymentStatus.authInProgress=!1,r._startPaymentCallback(e)})}},Zo.prototype._pollForCompleteTransactionStatus=function(t){var n=this;this._idealPaymentStatus.id?this._client.request({api:"braintreeApi",method:"get",endpoint:"ideal-payments/"+this._idealPaymentStatus.id+"/status"}).then(function(e){n._idealPaymentStatus.status=e.data.status,"PENDING"===e.data.status&&t<Jo.MAX_TRANSACTION_STATUS_POLLING_RETRIES?setTimeout(function(){n._pollForCompleteTransactionStatus(t+1)},Jo.POLL_RETRY_TIME):"COMPLETE"===e.data.status||"PENDING"===e.data.status?n._startPaymentCallback():n._startPaymentCallback(new f({code:Ko.IDEAL_PAYMENT_NOT_COMPLETE_OR_PENDING.code,type:Ko.IDEAL_PAYMENT_NOT_COMPLETE_OR_PENDING.type,message:"Transaction is not complete. It has a status of: "+e.data.status}))}).catch(n._startPaymentCallback):this._startPaymentCallback(Ko.IDEAL_PAYMENT_ALREADY_IN_PROGRESS)},Zo.prototype.teardown=sr(function(){return this._frameService.teardown(),nr(this,er(Zo.prototype)),h.sendEvent(this._client,"ideal.teardown-completed"),u.resolve()});var ea=Zo;var ut={create:sr(function(t){return dr.verify({name:"iDEAL",client:t.client}).then(function(){var e;return Eo()?(e=t.client.getConfiguration().gatewayConfiguration).braintreeApi?e.ideal?(h.sendEvent(t.client,"ideal.initialization"),new ea(t)._initialize()):u.reject(new f(Ko.IDEAL_NOT_ENABLED)):u.reject(new f(tr.BRAINTREE_API_ACCESS_RESTRICTED)):u.reject(new f(Ko.IDEAL_BROWSER_NOT_SUPPORTED))})}),VERSION:"3.29.0"},ta={supportsPopups:So},na={MASTERPASS_BROWSER_NOT_SUPPORTED:{type:f.types.CUSTOMER,code:"MASTERPASS_BROWSER_NOT_SUPPORTED",message:"Browser is not supported."},MASTERPASS_NOT_ENABLED:{type:f.types.MERCHANT,code:"MASTERPASS_NOT_ENABLED",message:"Masterpass is not enabled for this merchant."},MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION:{type:f.types.MERCHANT,code:"MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION",message:"Missing required option for tokenize."},MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS:{type:f.types.MERCHANT,code:"MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS",message:"Masterpass tokenization is already in progress."},MASTERPASS_ACCOUNT_TOKENIZATION_FAILED:{type:f.types.NETWORK,code:"MASTERPASS_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's Masterpass account."},MASTERPASS_POPUP_OPEN_FAILED:{type:f.types.MERCHANT,code:"MASTERPASS_POPUP_OPEN_FAILED",message:"Masterpass popup failed to open. Make sure to tokenize in response to a user action, such as a click."},MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS:{type:f.types.MERCHANT,code:"MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS",message:"Masterpass popup failed to return all required parameters needed to continue tokenization."},MASTERPASS_POPUP_CLOSED:{type:f.types.CUSTOMER,code:"MASTERPASS_POPUP_CLOSED",message:"Customer closed Masterpass popup before authorizing."},MASTERPASS_INVALID_PAYMENT_OPTION:{type:f.types.MERCHANT,code:"MASTERPASS_INVALID_PAYMENT_OPTION",message:"Masterpass payment options are invalid."},MASTERPASS_FLOW_FAILED:{type:f.types.NETWORK,code:"MASTERPASS_FLOW_FAILED",message:"Could not initialize Masterpass flow."}},ra={LANDING_FRAME_NAME:"braintreemasterpasslanding",POPUP_WIDTH:450,POPUP_HEIGHT:660,MASTERPASS_VERSION:"v6",REQUIRED_OPTIONS_FOR_TOKENIZE:["subtotal","currencyCode"]},ia=fr.INTEGRATION_TIMEOUT_MS;function oa(e){var t=e.client.getConfiguration();this._client=e.client,this._assetsUrl=t.gatewayConfiguration.assetsUrl+"/web/3.29.0",this._isDebug=t.isDebug,this._authInProgress=!1,x.popupBridge&&"function"==typeof x.popupBridge.getReturnUrlPrefix?this._callbackUrl=x.popupBridge.getReturnUrlPrefix()+"return":this._callbackUrl=this._assetsUrl+"/html/masterpass-redirect-frame"+(this._isDebug?"":".min")+".html"}oa.prototype._initialize=function(){var r=this;return new u(function(t){var n=setTimeout(function(){h.sendEvent(r._client,"masterpass.load.timed-out")},ia);Go({name:ra.LANDING_FRAME_NAME,height:ra.POPUP_HEIGHT,width:ra.POPUP_WIDTH,dispatchFrameUrl:r._assetsUrl+"/html/dispatch-frame"+(r._isDebug?"":".min")+".html",openFrameUrl:r._assetsUrl+"/html/masterpass-landing-frame"+(r._isDebug?"":".min")+".html"},function(e){r._frameService=e,clearTimeout(n),h.sendEvent(r._client,"masterpass.load.succeeded"),t(r)})})},oa.prototype.tokenize=function(n){var r=this;return!n||function(e){var t,n;for(t=0;t<ra.REQUIRED_OPTIONS_FOR_TOKENIZE.length;t++)if(n=ra.REQUIRED_OPTIONS_FOR_TOKENIZE[t],!e.hasOwnProperty(n))return!0;return!1}(n)?u.reject(new f(na.MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION)):r._authInProgress?u.reject(new f(na.MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS)):new u(function(e,t){r._navigateFrameToLoadingPage(n).catch(t),r._frameService.open(n.frameOptions,r._createFrameOpenHandler(e,t))})},oa.prototype._navigateFrameToLoadingPage=function(o){var a=this;return this._authInProgress=!0,this._client.request({method:"post",endpoint:"masterpass/request_token",data:{requestToken:{originUrl:x.location.protocol+"//"+x.location.hostname,subtotal:o.subtotal,currencyCode:o.currencyCode,callbackUrl:this._callbackUrl}}}).then(function(e){var t=a._assetsUrl+"/html/masterpass-loading-frame"+(a._isDebug?"":".min")+".html?",n=a._client.getConfiguration().gatewayConfiguration,r=o.config||{},i={environment:n.environment,requestToken:e.requestToken,callbackUrl:a._callbackUrl,merchantCheckoutId:n.masterpass.merchantCheckoutId,allowedCardTypes:n.masterpass.supportedNetworks,version:ra.MASTERPASS_VERSION};Object.keys(r).forEach(function(e){"function"!=typeof r[e]&&(i[e]=r[e])}),t+=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&"),a._frameService.redirect(t)}).catch(function(e){var t=e.details&&e.details.httpStatus;return a._closeWindow(),422===t?u.reject(fi(e,na.MASTERPASS_INVALID_PAYMENT_OPTION)):u.reject(fi(e,na.MASTERPASS_FLOW_FAILED))})},oa.prototype._createFrameOpenHandler=function(n,r){var i=this;return x.popupBridge?function(e,t){return i._authInProgress=!1,e?(h.sendEvent(i._client,"masterpass.tokenization.closed-popupbridge.by-user"),void r(fi(e,na.MASTERPASS_POPUP_CLOSED))):t.queryItems?void i._tokenizeMasterpass(t.queryItems).then(n).catch(r):(h.sendEvent(i._client,"masterpass.tokenization.failed-popupbridge"),void r(new f(na.MASTERPASS_FLOW_FAILED)))}:function(e,t){if(e)return i._authInProgress=!1,"FRAME_SERVICE_FRAME_CLOSED"===e.code?(h.sendEvent(i._client,"masterpass.tokenization.closed.by-user"),void r(new f(na.MASTERPASS_POPUP_CLOSED))):"FRAME_SERVICE_FRAME_OPEN_FAILED"===e.code?(h.sendEvent(i._client,"masterpass.tokenization.failed.to-open"),void r(new f(na.MASTERPASS_POPUP_OPEN_FAILED))):(h.sendEvent(i._client,"masterpass.tokenization.failed"),i._closeWindow(),void r(fi(e,na.MASTERPASS_FLOW_FAILED)));i._tokenizeMasterpass(t).then(n).catch(r)}},oa.prototype._tokenizeMasterpass=function(e){var t=this;return"success"!==e.mpstatus?(h.sendEvent(t._client,"masterpass.tokenization.closed.by-user"),t._closeWindow(),u.reject(new f(na.MASTERPASS_POPUP_CLOSED))):[e.oauth_verifier,e.oauth_token,e.checkout_resource_url].some(function(e){return null==e||"null"===e})?(h.sendEvent(t._client,"masterpass.tokenization.closed.missing-payload"),t._closeWindow(),u.reject(new f(na.MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS))):t._client.request({endpoint:"payment_methods/masterpass_cards",method:"post",data:{masterpassCard:{checkoutResourceUrl:e.checkout_resource_url,requestToken:e.oauth_token,verifierToken:e.oauth_verifier}}}).then(function(e){return t._closeWindow(),x.popupBridge?h.sendEvent(t._client,"masterpass.tokenization.success-popupbridge"):h.sendEvent(t._client,"masterpass.tokenization.success"),e.masterpassCards[0]}).catch(function(e){return t._closeWindow(),x.popupBridge?h.sendEvent(t._client,"masterpass.tokenization.failed-popupbridge"):h.sendEvent(t._client,"masterpass.tokenization.failed"),u.reject(fi(e,na.MASTERPASS_ACCOUNT_TOKENIZATION_FAILED))})},oa.prototype._closeWindow=function(){this._authInProgress=!1,this._frameService.close()},oa.prototype.teardown=function(){var t=this;return new u(function(e){t._frameService.teardown(),nr(t,er(oa.prototype)),h.sendEvent(t._client,"masterpass.teardown-completed"),e()})};var aa=sr.wrapPrototype(oa);function sa(){return Boolean(x.popupBridge||ta.supportsPopups())}function ca(e){var t="production"===e.gatewayConfiguration.environment,n=e.gatewayConfiguration.androidPay,r=e.analyticsMetadata,t={environment:t?"PRODUCTION":"TEST",allowedPaymentMethods:["CARD","TOKENIZED_CARD"],paymentMethodTokenizationParameters:{tokenizationType:"PAYMENT_GATEWAY",parameters:{gateway:"braintree","braintree:merchantId":e.gatewayConfiguration.merchantId,"braintree:authorizationFingerprint":n.googleAuthorizationFingerprint,"braintree:apiVersion":"v1","braintree:sdkVersion":"3.29.0","braintree:metadata":JSON.stringify({source:r.source,integration:r.integration,sessionId:r.sessionId,version:"3.29.0",platform:r.platform})}},cardRequirements:{allowedCardNetworks:n.supportedNetworks.map(function(e){return e.toUpperCase()})}};return"TOKENIZATION_KEY"===e.authorizationType&&(t.paymentMethodTokenizationParameters.parameters["braintree:clientKey"]=e.authorization),t}var he={create:sr(function(e){return dr.verify({name:"Masterpass",client:e.client}).then(function(){return sa()?e.client.getConfiguration().gatewayConfiguration.masterpass?new aa(e)._initialize():u.reject(new f(na.MASTERPASS_NOT_ENABLED)):u.reject(new f(na.MASTERPASS_BROWSER_NOT_SUPPORTED))})}),isSupported:sa,VERSION:"3.29.0"},He={},t=(He.events=Je(["FRAME_READY","FRAME_CAN_MAKE_REQUESTS","PAYMENT_REQUEST_INITIALIZED","SHIPPING_ADDRESS_CHANGE","UPDATE_SHIPPING_ADDRESS","SHIPPING_OPTION_CHANGE","UPDATE_SHIPPING_OPTION","PAYMENT_REQUEST_FAILED","PAYMENT_REQUEST_SUCCESSFUL"],"payment-request:"),He.errors={PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS",message:"There are no supported payment methods associated with this account."},PAYMENT_REQUEST_INVALID_UPDATE_WITH_EVENT:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_INVALID_UPDATE_WITH_EVENT"},PAYMENT_REQUEST_CANCELED:{type:f.types.CUSTOMER,code:"PAYMENT_REQUEST_CANCELED",message:"Payment request was canceled."},PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED",message:"Something went wrong when configuring the payment request."},PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE",message:"Something went wrong when tokenizing the Google Pay card."},PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR:{type:f.types.UNKNOWN,code:"PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR",message:"Something went wrong when tokenizing the Google Pay card."},PAYMENT_REQUEST_NOT_COMPLETED:{code:"PAYMENT_REQUEST_NOT_COMPLETED",message:"Payment request could not be completed."},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE",message:"createSupportedPaymentMethodsConfiguration must include a type parameter."},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED:{type:f.types.MERCHANT,code:"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED",message:"createSupportedPaymentMethodsConfiguration type parameter must be valid or enabled."}},He),ua=ve.assign,la=t.events,da=t.errors,fa={Visa:"visa",Mastercard:"mastercard","American Express":"amex","Diners Club":"diners",Discover:"discover",JCB:"jcb",UnionPay:"unionpay",Maestro:"maestro"};function pa(e){var t=e.enabledPaymentMethods||{};Qi.call(this),this._componentId=Pr(),this._client=e.client,this._enabledPaymentMethods={basicCard:!1!==t.basicCard,googlePay:!1!==t.googlePay},this._supportedPaymentMethods=this._constructDefaultSupportedPaymentMethods(),this._defaultSupportedPaymentMethods=Object.keys(this._supportedPaymentMethods).map(function(e){return this._supportedPaymentMethods[e]}.bind(this)),this._bus=new Vi({channel:this._componentId})}(pa.prototype=Object.create(Qi.prototype,{constructor:pa}))._constructDefaultSupportedPaymentMethods=function(){var e=this._client.getConfiguration(),t=e.gatewayConfiguration.androidPay,n=e.gatewayConfiguration.creditCards,r={};return this._enabledPaymentMethods.basicCard&&n&&0<n.supportedCardTypes.length&&(r.basicCard={supportedMethods:["basic-card"],data:{supportedNetworks:n.supportedCardTypes.map(function(e){return fa[e]})}}),this._enabledPaymentMethods.googlePay&&t&&t.enabled&&(r.googlePay={supportedMethods:["https://google.com/pay"],data:ua({apiVersion:1,merchantId:"18278000977346790994"},ca(e))}),r},pa.prototype.initialize=function(){var i=this._client.getConfiguration(),o=this;return this._frame=Di({allowPaymentRequest:!0,name:"braintree-payment-request-frame",class:"braintree-payment-request-frame",height:0,width:0,style:{position:"absolute",left:"-9999px"}}),0===this._defaultSupportedPaymentMethods.length?u.reject(new f(da.PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS)):new u(function(e){var t,n,r;o._bus.on(la.FRAME_READY,function(e){e(o._client)}),o._bus.on(la.FRAME_CAN_MAKE_REQUESTS,function(){h.sendEvent(o._client,"payment-request.initialized"),o._bus.on(la.SHIPPING_ADDRESS_CHANGE,function(e){e={target:{shippingAddress:e},updateWith:function(e){o._bus.emit(la.UPDATE_SHIPPING_ADDRESS,e)}};o._emit("shippingAddressChange",e),o._emit("shippingaddresschange",e)}),o._bus.on(la.SHIPPING_OPTION_CHANGE,function(e){e={target:{shippingOption:e},updateWith:function(e){o._bus.emit(la.UPDATE_SHIPPING_OPTION,e)}};o._emit("shippingOptionChange",e),o._emit("shippingoptionchange",e)}),e(o)}),o._frame.src=(t=i.gatewayConfiguration.assetsUrl,n=o._componentId,r=i.isDebug,t+"/web/3.29.0/html/payment-request-frame"+qi(r)+".html#"+n),document.body.appendChild(o._frame)})},pa.prototype.createSupportedPaymentMethodsConfiguration=function(e,t){if(!e)throw new f(da.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE);if(!this._enabledPaymentMethods[e])throw new f(da.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED);return(e=ua({},this._supportedPaymentMethods[e])).data=ua({},e.data,t),e},pa.prototype.tokenize=function(e){return new u(function(t,n){this._bus.emit(la.PAYMENT_REQUEST_INITIALIZED,{supportedPaymentMethods:e.supportedPaymentMethods||this._defaultSupportedPaymentMethods,details:e.details,options:e.options}),this._bus.on(la.PAYMENT_REQUEST_SUCCESSFUL,function(e){h.sendEvent(this._client,"payment-request.tokenize.succeeded"),t({nonce:e.nonce,type:e.type,description:e.description,details:{rawPaymentResponse:e.details.rawPaymentResponse,cardType:e.details.cardType,lastFour:e.details.lastFour,lastTwo:e.details.lastTwo},binData:e.binData})}.bind(this)),this._bus.on(la.PAYMENT_REQUEST_FAILED,function(e){var t;"AbortError"===e.name?(t=new f({type:da.PAYMENT_REQUEST_CANCELED.type,code:da.PAYMENT_REQUEST_CANCELED.code,message:da.PAYMENT_REQUEST_CANCELED.message,details:{originalError:e}}),h.sendEvent(this._client,"payment-request.tokenize.canceled")):"PAYMENT_REQUEST_INITIALIZATION_FAILED"===e.name?t=new f({type:da.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.type,code:da.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.code,message:da.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.message,details:{originalError:e}}):"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_TOKENIZATION_ERROR"===e.name?t=new f({type:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.type,code:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.code,message:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.message,details:{originalError:e}}):"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_PARSING_ERROR"===e.name?t=new f({type:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.type,code:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.code,message:da.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.message,details:{originalError:e}}):(t=new f({code:da.PAYMENT_REQUEST_NOT_COMPLETED.code,type:e.type||f.types.CUSTOMER,message:da.PAYMENT_REQUEST_NOT_COMPLETED.message,details:{originalError:e}}),h.sendEvent(this._client,"payment-request.tokenize.failed")),n(t)}.bind(this))}.bind(this))},pa.prototype.teardown=function(){return this._bus.teardown(),this._frame.parentNode.removeChild(this._frame),nr(this,er(pa.prototype)),h.sendEvent(this._client,"payment-request.teardown-completed"),u.resolve()};var ha=sr.wrapPrototype(pa);var xn={create:sr(function(e){return dr.verify({name:"Payment Request",client:e.client}).then(function(){return new ha(e).initialize()})}),VERSION:"3.29.0"},ma={PAYPAL_NOT_ENABLED:{type:f.types.MERCHANT,code:"PAYPAL_NOT_ENABLED",message:"PayPal is not enabled for this merchant."},PAYPAL_TOKENIZATION_REQUEST_ACTIVE:{type:f.types.MERCHANT,code:"PAYPAL_TOKENIZATION_REQUEST_ACTIVE",message:"Another tokenization request is active."},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:f.types.NETWORK,code:"PAYPAL_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's PayPal account."},PAYPAL_FLOW_FAILED:{type:f.types.NETWORK,code:"PAYPAL_FLOW_FAILED",message:"Could not initialize PayPal flow."},PAYPAL_FLOW_OPTION_REQUIRED:{type:f.types.MERCHANT,code:"PAYPAL_FLOW_OPTION_REQUIRED",message:"PayPal flow property is invalid or missing."},PAYPAL_BROWSER_NOT_SUPPORTED:{type:f.types.CUSTOMER,code:"PAYPAL_BROWSER_NOT_SUPPORTED",message:"Browser is not supported."},PAYPAL_POPUP_OPEN_FAILED:{type:f.types.MERCHANT,code:"PAYPAL_POPUP_OPEN_FAILED",message:"PayPal popup failed to open, make sure to tokenize in response to a user action."},PAYPAL_POPUP_CLOSED:{type:f.types.CUSTOMER,code:"PAYPAL_POPUP_CLOSED",message:"Customer closed PayPal popup before authorizing."},PAYPAL_INVALID_PAYMENT_OPTION:{type:f.types.MERCHANT,code:"PAYPAL_INVALID_PAYMENT_OPTION",message:"PayPal payment options are invalid."}},ga={LANDING_FRAME_NAME:"braintreepaypallanding",FLOW_ENDPOINTS:{checkout:"create_payment_resource",vault:"setup_billing_agreement"}},va="3.29.0",ya=fr.INTEGRATION_TIMEOUT_MS;function ba(e){this._client=e.client,this._assetsUrl=e.client.getConfiguration().gatewayConfiguration.paypal.assetsUrl+"/web/"+va,this._isDebug=e.client.getConfiguration().isDebug,this._loadingFrameUrl=this._assetsUrl+"/html/paypal-landing-frame"+qi(this._isDebug)+".html",this._authorizationInProgress=!1}ba.prototype._initialize=function(){var n=this,r=this._client,i=setTimeout(function(){h.sendEvent(r,"paypal.load.timed-out")},ya);return new u(function(t){Go({name:ga.LANDING_FRAME_NAME,dispatchFrameUrl:n._assetsUrl+"/html/dispatch-frame"+qi(n._isDebug)+".html",openFrameUrl:n._loadingFrameUrl},function(e){n._frameService=e,clearTimeout(i),h.sendEvent(r,"paypal.load.succeeded"),t(n)})})},ba.prototype.tokenize=function(n,t){var e,r=this,i=this._client;return t=t&&xr(di(t)),n&&ga.FLOW_ENDPOINTS.hasOwnProperty(n.flow)?(e=new u(function(e,t){r._authorizationInProgress?(h.sendEvent(i,"paypal.tokenization.error.already-opened"),t(new f(ma.PAYPAL_TOKENIZATION_REQUEST_ACTIVE))):(r._authorizationInProgress=!0,x.popupBridge||h.sendEvent(i,"paypal.tokenization.opened"),!0===n.offerCredit&&h.sendEvent(i,"paypal.credit.offered"),r._navigateFrameToAuth(n).catch(t),r._frameService.open({},r._createFrameServiceCallback(n,e,t)))}),t?(e.then(function(e){t(null,e)}).catch(t),this._frameService.createHandler({beforeClose:function(){h.sendEvent(i,"paypal.tokenization.closed.by-merchant")}})):e):(e=new f(ma.PAYPAL_FLOW_OPTION_REQUIRED),t?(t(e),this._frameService.createNoopHandler()):u.reject(e))},ba.prototype._createFrameServiceCallback=function(r,i,o){var a=this,s=this._client;return x.popupBridge?function(e,t){var n=t&&t.path&&"/cancel"===t.path.substring(0,7);a._authorizationInProgress=!1,e||n?(h.sendEvent(s,"paypal.tokenization.closed-popupbridge.by-user"),o(new f(ma.PAYPAL_POPUP_CLOSED))):t&&a._tokenizePayPal(r,t.queryItems).then(i).catch(o)}:function(e,t){a._authorizationInProgress=!1,e?"FRAME_SERVICE_FRAME_CLOSED"===e.code?(h.sendEvent(s,"paypal.tokenization.closed.by-user"),o(new f(ma.PAYPAL_POPUP_CLOSED))):"FRAME_SERVICE_FRAME_OPEN_FAILED"===e.code&&o(new f(ma.PAYPAL_POPUP_OPEN_FAILED)):t&&a._tokenizePayPal(r,t).then(i).catch(o)}},ba.prototype._tokenizePayPal=function(e,t){var n=this,r=this._client;return x.popupBridge||this._frameService.redirect(this._loadingFrameUrl),r.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:this._formatTokenizeData(e,t)}).then(function(e){e=n._formatTokenizePayload(e);return x.popupBridge?h.sendEvent(r,"paypal.tokenization.success-popupbridge"):h.sendEvent(r,"paypal.tokenization.success"),e.creditFinancingOffered&&h.sendEvent(r,"paypal.credit.accepted"),n._frameService.close(),e}).catch(function(e){return x.popupBridge?h.sendEvent(r,"paypal.tokenization.failed-popupbridge"):h.sendEvent(r,"paypal.tokenization.failed"),n._frameService.close(),u.reject(fi(e,{type:ma.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:ma.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:ma.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message}))})},ba.prototype._formatTokenizePayload=function(e){var t={},e={nonce:(t=e.paypalAccounts?e.paypalAccounts[0]:t).nonce,details:{},type:t.type};return t.details&&t.details.payerInfo&&(e.details=t.details.payerInfo),t.details&&t.details.creditFinancingOffered&&(e.creditFinancingOffered=t.details.creditFinancingOffered),e},ba.prototype._formatTokenizeData=function(e,t){var n=this._client.getConfiguration(),r=n.gatewayConfiguration,n="TOKENIZATION_KEY"===n.authorizationType,n={paypalAccount:{correlationId:t.ba_token||t.token,options:{validate:"vault"===e.flow&&!n}}};return t.ba_token?n.paypalAccount.billingAgreementToken=t.ba_token:(n.paypalAccount.paymentToken=t.paymentId,n.paypalAccount.payerId=t.PayerID,n.paypalAccount.unilateral=r.paypal.unvettedMerchant,e.hasOwnProperty("intent")&&(n.paypalAccount.intent=e.intent)),n},ba.prototype._navigateFrameToAuth=function(t){var n=this,r=this._client,e="paypal_hermes/"+ga.FLOW_ENDPOINTS[t.flow];return r.request({endpoint:e,method:"post",data:this._formatPaymentResourceData(t)}).then(function(e){e="checkout"===t.flow?e.paymentResource.redirectUrl:e.agreementSetup.approvalUrl;"commit"===t.useraction&&(e=Rr.queryify(e,{useraction:"commit"})),x.popupBridge&&h.sendEvent(r,"paypal.tokenization.opened-popupbridge"),n._frameService.redirect(e)}).catch(function(e){var t=e.details&&e.details.httpStatus;return n._frameService.close(),n._authorizationInProgress=!1,422===t?u.reject(new f({type:ma.PAYPAL_INVALID_PAYMENT_OPTION.type,code:ma.PAYPAL_INVALID_PAYMENT_OPTION.code,message:ma.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:e}})):u.reject(fi(e,{type:ma.PAYPAL_FLOW_FAILED.type,code:ma.PAYPAL_FLOW_FAILED.code,message:ma.PAYPAL_FLOW_FAILED.message}))})},ba.prototype._formatPaymentResourceData=function(e){var t,n=this._client.getConfiguration().gatewayConfiguration,r=this._frameService._serviceId,i={returnUrl:n.paypal.assetsUrl+"/web/"+va+"/html/paypal-redirect-frame"+qi(this._isDebug)+".html?channel="+r,cancelUrl:n.paypal.assetsUrl+"/web/"+va+"/html/paypal-cancel-frame"+qi(this._isDebug)+".html?channel="+r,offerPaypalCredit:!0===e.offerCredit,experienceProfile:{brandName:e.displayName||n.paypal.displayName,localeCode:e.locale,noShipping:(!e.enableShippingAddress).toString(),addressOverride:!1===e.shippingAddressEditable,landingPageType:e.landingPageType}};if(x.popupBridge&&"function"==typeof x.popupBridge.getReturnUrlPrefix&&(i.returnUrl=x.popupBridge.getReturnUrlPrefix()+"return",i.cancelUrl=x.popupBridge.getReturnUrlPrefix()+"cancel"),"checkout"===e.flow)for(t in i.amount=e.amount,i.currencyIsoCode=e.currency,e.hasOwnProperty("intent")&&(i.intent=e.intent),e.shippingAddressOverride)e.shippingAddressOverride.hasOwnProperty(t)&&(i[t]=e.shippingAddressOverride[t]);else i.shippingAddress=e.shippingAddressOverride,e.billingAgreementDescription&&(i.description=e.billingAgreementDescription);return i},ba.prototype.closeWindow=function(){this._authorizationInProgress&&h.sendEvent(this._client,"paypal.tokenize.closed.by-merchant"),this._frameService.close()},ba.prototype.focusWindow=function(){this._frameService.focus()},ba.prototype.teardown=sr(function(){return this._frameService.teardown(),nr(this,er(ba.prototype)),h.sendEvent(this._client,"paypal.teardown-completed"),u.resolve()});var _a=ba;var Pn={create:sr(function(e){return dr.verify({name:"PayPal",client:e.client}).then(function(){return!0!==e.client.getConfiguration().gatewayConfiguration.paypalEnabled?u.reject(new f(ma.PAYPAL_NOT_ENABLED)):(h.sendEvent(e.client,"paypal.initialized"),new _a(e)._initialize())})}),isSupported:function(){return!0},VERSION:"3.29.0"},wa={PAYPAL_NOT_ENABLED:{type:f.types.MERCHANT,code:"PAYPAL_NOT_ENABLED",message:"PayPal is not enabled for this merchant."},PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED:{type:f.types.MERCHANT,code:"PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED",message:"A linked PayPal Sandbox account is required to use PayPal Checkout in Sandbox. See https://developers.braintreepayments.com/guides/paypal/testing-go-live/#linked-paypal-testing for details on linking your PayPal sandbox with Braintree."},PAYPAL_TOKENIZATION_REQUEST_ACTIVE:{type:f.types.MERCHANT,code:"PAYPAL_TOKENIZATION_REQUEST_ACTIVE",message:"Another tokenization request is active."},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:f.types.NETWORK,code:"PAYPAL_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's PayPal account."},PAYPAL_FLOW_FAILED:{type:f.types.NETWORK,code:"PAYPAL_FLOW_FAILED",message:"Could not initialize PayPal flow."},PAYPAL_FLOW_OPTION_REQUIRED:{type:f.types.MERCHANT,code:"PAYPAL_FLOW_OPTION_REQUIRED",message:"PayPal flow property is invalid or missing."},PAYPAL_POPUP_OPEN_FAILED:{type:f.types.MERCHANT,code:"PAYPAL_POPUP_OPEN_FAILED",message:"PayPal popup failed to open, make sure to tokenize in response to a user action."},PAYPAL_POPUP_CLOSED:{type:f.types.CUSTOMER,code:"PAYPAL_POPUP_CLOSED",message:"Customer closed PayPal popup before authorizing."},PAYPAL_INVALID_PAYMENT_OPTION:{type:f.types.MERCHANT,code:"PAYPAL_INVALID_PAYMENT_OPTION",message:"PayPal payment options are invalid."}};function Sa(e){this._client=e.client}Sa.prototype.createPayment=function(t){var e;return t&&ga.FLOW_ENDPOINTS.hasOwnProperty(t.flow)?(e="paypal_hermes/"+ga.FLOW_ENDPOINTS[t.flow],h.sendEvent(this._client,"paypal-checkout.createPayment"),!0===t.offerCredit&&h.sendEvent(this._client,"paypal-checkout.credit.offered"),this._client.request({endpoint:e,method:"post",data:this._formatPaymentResourceData(t)}).then(function(e){e="checkout"===t.flow?e.paymentResource.paymentToken:e.agreementSetup.tokenId;return e}).catch(function(e){return 422===(e.details&&e.details.httpStatus)?u.reject(new f({type:wa.PAYPAL_INVALID_PAYMENT_OPTION.type,code:wa.PAYPAL_INVALID_PAYMENT_OPTION.code,message:wa.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:e}})):u.reject(fi(e,{type:wa.PAYPAL_FLOW_FAILED.type,code:wa.PAYPAL_FLOW_FAILED.code,message:wa.PAYPAL_FLOW_FAILED.message}))})):u.reject(new f(wa.PAYPAL_FLOW_OPTION_REQUIRED))},Sa.prototype.tokenizePayment=function(e){var t,n=this,r=this._client,i={flow:e.billingToken?"vault":"checkout",intent:e.intent},e={ecToken:e.paymentToken,billingToken:e.billingToken,payerId:e.payerID,paymentId:e.paymentID};return h.sendEvent(r,"paypal-checkout.tokenization.started"),r.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:n._formatTokenizeData(i,e)}).then(function(e){return t=n._formatTokenizePayload(e),h.sendEvent(r,"paypal-checkout.tokenization.success"),t.creditFinancingOffered&&h.sendEvent(r,"paypal-checkout.credit.accepted"),t}).catch(function(e){return h.sendEvent(r,"paypal-checkout.tokenization.failed"),u.reject(fi(e,{type:wa.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:wa.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:wa.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message}))})},Sa.prototype._formatPaymentResourceData=function(e){var t,n=this._client.getConfiguration().gatewayConfiguration,r={returnUrl:"x",cancelUrl:"x",offerPaypalCredit:!0===e.offerCredit,experienceProfile:{brandName:e.displayName||n.paypal.displayName,localeCode:e.locale,noShipping:(!e.enableShippingAddress).toString(),addressOverride:!1===e.shippingAddressEditable,landingPageType:e.landingPageType}};if("checkout"===e.flow)for(t in r.amount=e.amount,r.currencyIsoCode=e.currency,e.hasOwnProperty("intent")&&(r.intent=e.intent),e.shippingAddressOverride)e.shippingAddressOverride.hasOwnProperty(t)&&(r[t]=e.shippingAddressOverride[t]);else r.shippingAddress=e.shippingAddressOverride,e.billingAgreementDescription&&(r.description=e.billingAgreementDescription);return r},Sa.prototype._formatTokenizeData=function(e,t){var n=this._client.getConfiguration(),r=n.gatewayConfiguration,n="TOKENIZATION_KEY"===n.authorizationType,n={paypalAccount:{correlationId:t.billingToken||t.ecToken,options:{validate:"vault"===e.flow&&!n}}};return t.billingToken?n.paypalAccount.billingAgreementToken=t.billingToken:(n.paypalAccount.paymentToken=t.paymentId,n.paypalAccount.payerId=t.payerId,n.paypalAccount.unilateral=r.paypal.unvettedMerchant,e.intent&&(n.paypalAccount.intent=e.intent)),n},Sa.prototype._formatTokenizePayload=function(e){var t={},e={nonce:(t=e.paypalAccounts?e.paypalAccounts[0]:t).nonce,details:{},type:t.type};return t.details&&t.details.payerInfo&&(e.details=t.details.payerInfo),t.details&&t.details.creditFinancingOffered&&(e.creditFinancingOffered=t.details.creditFinancingOffered),e},Sa.prototype.teardown=function(){return nr(this,er(Sa.prototype)),u.resolve()};var Ea=sr.wrapPrototype(Sa);var Ln={create:sr(function(t){return dr.verify({name:"PayPal Checkout",client:t.client}).then(function(){var e=t.client.getConfiguration();return e.gatewayConfiguration.paypalEnabled?e.gatewayConfiguration.paypal.clientId?(h.sendEvent(t.client,"paypal-checkout.initialized"),new Ea(t)):u.reject(new f(wa.PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED)):u.reject(new f(wa.PAYPAL_NOT_ENABLED))})}),isSupported:function(){return!0},VERSION:"3.29.0"},Aa=ve.assign;function ka(e){this._client=e.client,this._braintreeGeneratedPaymentRequestConfiguration=ca(this._client.getConfiguration())}ka.prototype.createPaymentDataRequest=function(e){return h.sendEvent(this._client,"google-payment.createPaymentDataRequest"),Aa({},this._braintreeGeneratedPaymentRequestConfiguration,e)},ka.prototype.parseResponse=function(n){var r=this._client;return u.resolve().then(function(){var e=JSON.parse(n.paymentMethodToken.token),t=e.error;return t?u.reject(t):(t=e.androidPayCards[0],h.sendEvent(r,"google-payment.parseResponse.succeeded"),u.resolve({nonce:t.nonce,type:t.type,description:t.description,details:{cardType:t.details.cardType,lastFour:t.details.lastFour,lastTwo:t.details.lastTwo},binData:t.binData}))}).catch(function(e){return h.sendEvent(r,"google-payment.parseResponse.failed"),u.reject(new f({code:"GOOGLE_PAYMENT_GATEWAY_ERROR",message:"There was an error when tokenizing the Google Pay payment method.",type:f.types.UNKNOWN,details:{originalError:e}}))})},ka.prototype.teardown=function(){return nr(this,er(ka.prototype)),u.resolve()};var Ta=sr.wrapPrototype(ka);var dt={create:sr(function(e){return dr.verify({name:"Google Pay",client:e.client}).then(function(){return e.client.getConfiguration().gatewayConfiguration.androidPay?new Ta(e):u.reject(new f({type:f.types.MERCHANT,code:"GOOGLE_PAYMENT_NOT_ENABLED",message:"Google Pay is not enabled for this merchant."}))})}),VERSION:"3.29.0"},Ca="braintreethreedsecurelanding",Ia={THREEDS_AUTHENTICATION_IN_PROGRESS:{type:f.types.MERCHANT,code:"THREEDS_AUTHENTICATION_IN_PROGRESS",message:"Cannot call verifyCard while existing authentication is in progress."},THREEDS_MISSING_VERIFY_CARD_OPTION:{type:f.types.MERCHANT,code:"THREEDS_MISSING_VERIFY_CARD_OPTION"},THREEDS_NO_VERIFICATION_PAYLOAD:{type:f.types.MERCHANT,code:"THREEDS_NO_VERIFICATION_PAYLOAD",message:"No verification payload available."},THREEDS_NOT_ENABLED:{type:f.types.MERCHANT,code:"THREEDS_NOT_ENABLED",message:"3D Secure is not enabled for this merchant."},THREEDS_CAN_NOT_USE_TOKENIZATION_KEY:{type:f.types.MERCHANT,code:"THREEDS_CAN_NOT_USE_TOKENIZATION_KEY",message:"3D Secure can not use a tokenization key for authorization."},THREEDS_HTTPS_REQUIRED:{type:f.types.MERCHANT,code:"THREEDS_HTTPS_REQUIRED",message:"3D Secure requires HTTPS."},THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN:{type:f.types.INTERNAL,code:"THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN",message:"Term Url must be on a Braintree domain."}},xa=Je(["AUTHENTICATION_COMPLETE"],"threedsecure:"),Pa=ve.assign,Ma="3.29.0";function Oa(e){this._options=e,this._assetsUrl=e.client.getConfiguration().gatewayConfiguration.assetsUrl,this._isDebug=e.client.getConfiguration().isDebug,this._client=e.client}Oa.prototype.verifyCard=function(e){var t,i,o,n,r,a=this;return e=e||{},!0===this._verifyCardInProgress?n=Ia.THREEDS_AUTHENTICATION_IN_PROGRESS:e.nonce?e.amount?"function"!=typeof e.addFrame?r="an addFrame function":"function"!=typeof e.removeFrame&&(r="a removeFrame function"):r="an amount":r="a nonce",(n=r?{type:Ia.THREEDS_MISSING_VERIFY_CARD_OPTION.type,code:Ia.THREEDS_MISSING_VERIFY_CARD_OPTION.code,message:"verifyCard options must include "+r+"."}:n)?u.reject(new f(n)):(t=!1!==e.showLoader,this._verifyCardInProgress=!0,i=di(e.addFrame),o=di(e.removeFrame),r="payment_methods/"+e.nonce+"/three_d_secure/lookup",this._client.request({endpoint:r,method:"post",data:{amount:e.amount}}).then(function(e){return a._lookupPaymentMethod=e.paymentMethod,new u(function(n,r){a._verifyCardCallback=function(e,t){a._verifyCardInProgress=!1,e?r(e):n(t)},a._handleLookupResponse({showLoader:t,lookupResponse:e,addFrame:i,removeFrame:o})})}).catch(function(e){return a._verifyCardInProgress=!1,u.reject(e)}))},Oa.prototype.cancelVerifyCard=function(){var e;return this._verifyCardInProgress=!1,this._lookupPaymentMethod?(e=Pa({},this._lookupPaymentMethod,{liabilityShiftPossible:this._lookupPaymentMethod.threeDSecureInfo.liabilityShiftPossible,liabilityShifted:this._lookupPaymentMethod.threeDSecureInfo.liabilityShifted,verificationDetails:this._lookupPaymentMethod.threeDSecureInfo.verificationDetails}),u.resolve(e)):u.reject(new f(Ia.THREEDS_NO_VERIFICATION_PAYLOAD))},Oa.prototype._handleLookupResponse=function(e){var t=e.lookupResponse;t.lookup&&t.lookup.acsUrl&&0<t.lookup.acsUrl.length?e.addFrame(null,this._createIframe({showLoader:e.showLoader,response:t.lookup,removeFrame:e.removeFrame})):this._verifyCardCallback(null,{nonce:t.paymentMethod.nonce,liabilityShiftPossible:t.threeDSecureInfo.liabilityShiftPossible,liabilityShifted:t.threeDSecureInfo.liabilityShifted,verificationDetails:t.threeDSecureInfo})},Oa.prototype._createIframe=function(t){var e,n,r=window.location.href,i=t.response;return this._bus=new Vi({channel:Pr(),merchantUrl:location.href}),n=this._assetsUrl+"/web/"+Ma+"/html/three-d-secure-authentication-complete-frame.html?channel="+encodeURIComponent(this._bus.channel)+"&",-1<r.indexOf("#")&&(r=r.split("#")[0]),this._bus.on(Vi.events.CONFIGURATION_REQUEST,function(e){e({acsUrl:i.acsUrl,pareq:i.pareq,termUrl:i.termUrl+"&three_d_secure_version="+Ma+"&authentication_complete_base_url="+encodeURIComponent(n),md:i.md,parentUrl:r})}),this._bus.on(xa.AUTHENTICATION_COMPLETE,function(e){this._handleAuthResponse(e,t)}.bind(this)),e=this._assetsUrl+"/web/"+Ma+"/html/three-d-secure-bank-frame"+qi(this._isDebug)+".html?showLoader="+t.showLoader,this._bankIframe=Di({src:e,height:400,width:400,name:Ca+"_"+this._bus.channel}),this._bankIframe},Oa.prototype._handleAuthResponse=function(e,t){var n=JSON.parse(e.auth_response);this._bus.teardown(),t.removeFrame(),di(function(){n.success?this._verifyCardCallback(null,this._formatAuthResponse(n.paymentMethod,n.threeDSecureInfo)):n.threeDSecureInfo&&n.threeDSecureInfo.liabilityShiftPossible?this._verifyCardCallback(null,this._formatAuthResponse(this._lookupPaymentMethod,n.threeDSecureInfo)):this._verifyCardCallback(new f({type:f.types.UNKNOWN,code:"UNKNOWN_AUTH_RESPONSE",message:n.error.message}))}.bind(this))()},Oa.prototype._formatAuthResponse=function(e,t){return{nonce:e.nonce,details:e.details,description:e.description,liabilityShifted:t.liabilityShifted,liabilityShiftPossible:t.liabilityShiftPossible}},Oa.prototype.teardown=function(){var e;return nr(this,er(Oa.prototype)),h.sendEvent(this._options.client,"threedsecure.teardown-completed"),this._bus&&this._bus.teardown(),this._bankIframe&&(e=this._bankIframe.parentNode)&&e.removeChild(this._bankIframe),u.resolve()};var Ra=sr.wrapPrototype(Oa);var ja=function(e){return"https:"===(e=e||x.location.protocol)};var Se={create:sr(function(n){return dr.verify({name:"3D Secure",client:n.client}).then(function(){var e,t=n.client.getConfiguration();return t.gatewayConfiguration.threeDSecureEnabled||(e=Ia.THREEDS_NOT_ENABLED),"TOKENIZATION_KEY"===t.authorizationType&&(e=Ia.THREEDS_CAN_NOT_USE_TOKENIZATION_KEY),(e="production"===t.gatewayConfiguration.environment&&!ja()?Ia.THREEDS_HTTPS_REQUIRED:e)?u.reject(new f(e)):(h.sendEvent(n.client,"threedsecure.initialized"),new Ra(n))})}),VERSION:"3.29.0"},Da={events:Je(["HOSTED_FIELDS_FETCH_CAPABILITIES","HOSTED_FIELDS_ENROLL","HOSTED_FIELDS_TOKENIZE"],"union-pay:"),HOSTED_FIELDS_FRAME_NAME:"braintreeunionpayhostedfields"},Na={UNIONPAY_NOT_ENABLED:{type:f.types.MERCHANT,code:"UNIONPAY_NOT_ENABLED",message:"UnionPay is not enabled for this merchant."},UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID:{type:f.types.MERCHANT,code:"UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID",message:"Found an invalid Hosted Fields instance. Please use a valid Hosted Fields instance."},UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:f.types.MERCHANT,code:"UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED",message:"Could not find the Hosted Fields instance."},UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:f.types.MERCHANT,code:"UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED",message:"A card or a Hosted Fields instance is required. Please supply a card or a Hosted Fields instance."},UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES:{type:f.types.MERCHANT,code:"UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES",message:"Please supply either a card or a Hosted Fields instance, not both."},UNIONPAY_EXPIRATION_DATE_INCOMPLETE:{type:f.types.MERCHANT,code:"UNIONPAY_EXPIRATION_DATE_INCOMPLETE",message:"You must supply expiration month and year or neither."},UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID:{type:f.types.CUSTOMER,code:"UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID",message:"Enrollment failed due to user input error."},UNIONPAY_ENROLLMENT_NETWORK_ERROR:{type:f.types.NETWORK,code:"UNIONPAY_ENROLLMENT_NETWORK_ERROR",message:"Could not enroll UnionPay card."},UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR:{type:f.types.NETWORK,code:"UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR",message:"Could not fetch card capabilities."},UNIONPAY_TOKENIZATION_NETWORK_ERROR:{type:f.types.NETWORK,code:"UNIONPAY_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},UNIONPAY_MISSING_MOBILE_PHONE_DATA:{type:f.types.MERCHANT,code:"UNIONPAY_MISSING_MOBILE_PHONE_DATA",message:"A `mobile` with `countryCode` and `number` is required."},UNIONPAY_FAILED_TOKENIZATION:{type:f.types.CUSTOMER,code:"UNIONPAY_FAILED_TOKENIZATION",message:"The supplied card data failed tokenization."}},La=Da.events;function $a(e){this._options=e}$a.prototype.fetchCapabilities=function(e){var r=this,n=this._options.client,t=e.card?e.card.number:null,i=e.hostedFields;return t&&i?u.reject(new f(Na.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):t?n.request({method:"get",endpoint:"payment_methods/credit_cards/capabilities",data:{_meta:{source:"unionpay"},creditCard:{number:t}}}).then(function(e){return h.sendEvent(n,"unionpay.capabilities-received"),e}).catch(function(e){var t=e.details&&e.details.httpStatus;return h.sendEvent(n,"unionpay.capabilities-failed"),403===t?u.reject(e):u.reject(new f({type:Na.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.type,code:Na.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.code,message:Na.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.message,details:{originalError:e}}))}):i?i._bus?new u(function(t,n){r._initializeHostedFields(function(){r._bus.emit(La.HOSTED_FIELDS_FETCH_CAPABILITIES,{hostedFields:i},function(e){e.err?n(new f(e.err)):t(e.payload)})})}):u.reject(new f(Na.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):u.reject(new f(Na.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},$a.prototype.enroll=function(e){var r=this,i=this._options.client,t=e.card,o=e.mobile,a=e.hostedFields;if(!o)return u.reject(new f(Na.UNIONPAY_MISSING_MOBILE_PHONE_DATA));if(a)return a._bus?t?u.reject(new f(Na.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):new u(function(t,n){r._initializeHostedFields(function(){r._bus.emit(La.HOSTED_FIELDS_ENROLL,{hostedFields:a,mobile:o},function(e){e.err?n(new f(e.err)):t(e.payload)})})}):u.reject(new f(Na.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID));if(t&&t.number){if(e={_meta:{source:"unionpay"},unionPayEnrollment:{number:t.number,mobileCountryCode:o.countryCode,mobileNumber:o.number}},t.expirationDate)e.unionPayEnrollment.expirationDate=t.expirationDate;else if(t.expirationMonth||t.expirationYear){if(!t.expirationMonth||!t.expirationYear)return u.reject(new f(Na.UNIONPAY_EXPIRATION_DATE_INCOMPLETE));e.unionPayEnrollment.expirationYear=t.expirationYear,e.unionPayEnrollment.expirationMonth=t.expirationMonth}return i.request({method:"post",endpoint:"union_pay_enrollments",data:e}).then(function(e){return h.sendEvent(i,"unionpay.enrollment-succeeded"),{enrollmentId:e.unionPayEnrollmentId,smsCodeRequired:e.smsCodeRequired}}).catch(function(e){var t,n=e.details&&e.details.httpStatus;return 403===n?t=e:n<500?(t=new f(Na.UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID)).details={originalError:e}:(t=new f(Na.UNIONPAY_ENROLLMENT_NETWORK_ERROR)).details={originalError:e},h.sendEvent(i,"unionpay.enrollment-failed"),u.reject(t)})}return u.reject(new f(Na.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},$a.prototype.tokenize=function(e){var t,r=this,i=this._options.client,n=e.card,o=e.hostedFields;return n&&o?u.reject(new f(Na.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):n?(t={_meta:{source:"unionpay"},creditCard:{number:e.card.number,options:{unionPayEnrollment:{id:e.enrollmentId}}}},e.smsCode&&(t.creditCard.options.unionPayEnrollment.smsCode=e.smsCode),n.expirationDate?t.creditCard.expirationDate=n.expirationDate:n.expirationMonth&&n.expirationYear&&(t.creditCard.expirationYear=n.expirationYear,t.creditCard.expirationMonth=n.expirationMonth),e.card.cvv&&(t.creditCard.cvv=e.card.cvv),i.request({method:"post",endpoint:"payment_methods/credit_cards",data:t}).then(function(e){e=e.creditCards[0];return delete e.consumed,delete e.threeDSecureInfo,h.sendEvent(i,"unionpay.nonce-received"),e}).catch(function(e){var t,n=e.details&&e.details.httpStatus;return h.sendEvent(i,"unionpay.nonce-failed"),403===n?t=e:n<500?(t=new f(Na.UNIONPAY_FAILED_TOKENIZATION)).details={originalError:e}:(t=new f(Na.UNIONPAY_TOKENIZATION_NETWORK_ERROR)).details={originalError:e},u.reject(t)})):o?o._bus?new u(function(t,n){r._initializeHostedFields(function(){r._bus.emit(La.HOSTED_FIELDS_TOKENIZE,e,function(e){e.err?n(new f(e.err)):t(e.payload)})})}):u.reject(new f(Na.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):u.reject(new f(Na.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},$a.prototype.teardown=function(){return this._bus&&(this._hostedFieldsFrame.parentNode.removeChild(this._hostedFieldsFrame),this._bus.teardown()),nr(this,er($a.prototype)),u.resolve()},$a.prototype._initializeHostedFields=function(t){var e,n,r=Pr();this._bus?t():(e=this._options.client.getConfiguration().gatewayConfiguration.assetsUrl,n=this._options.client.getConfiguration().isDebug,this._bus=new Vi({channel:r,merchantUrl:location.href}),this._hostedFieldsFrame=Di({name:Da.HOSTED_FIELDS_FRAME_NAME+"_"+r,src:e+"/web/3.29.0/html/unionpay-hosted-fields-frame"+qi(n)+".html",height:0,width:0}),this._bus.on(Vi.events.CONFIGURATION_REQUEST,function(e){e(this._options.client),t()}.bind(this)),document.body.appendChild(this._hostedFieldsFrame))};var Ba=sr.wrapPrototype($a);var e={create:sr(function(t){return dr.verify({name:"UnionPay",client:t.client}).then(function(){var e=t.client.getConfiguration();return e.gatewayConfiguration.unionPay&&!0===e.gatewayConfiguration.unionPay.enabled?(h.sendEvent(t.client,"unionpay.initialized"),new Ba(t)):u.reject(new f(Na.UNIONPAY_NOT_ENABLED))})}),VERSION:"3.29.0"},Ua={US_BANK_ACCOUNT_OPTION_REQUIRED:{type:f.types.MERCHANT,code:"US_BANK_ACCOUNT_OPTION_REQUIRED"},US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS:{type:f.types.MERCHANT,code:"US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS"},US_BANK_ACCOUNT_LOGIN_LOAD_FAILED:{type:f.types.NETWORK,code:"US_BANK_ACCOUNT_LOGIN_LOAD_FAILED",message:"Bank login flow failed to load."},US_BANK_ACCOUNT_LOGIN_CLOSED:{type:f.types.CUSTOMER,code:"US_BANK_ACCOUNT_LOGIN_CLOSED",message:"Customer closed bank login flow before authorizing."},US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE:{type:f.types.MERCHANT,code:"US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE",message:"Another bank login tokenization request is active."},US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR:{type:f.types.NETWORK,code:"US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},US_BANK_ACCOUNT_FAILED_TOKENIZATION:{type:f.types.CUSTOMER,code:"US_BANK_ACCOUNT_FAILED_TOKENIZATION",message:"The supplied data failed tokenization."},US_BANK_ACCOUNT_NOT_ENABLED:{type:f.types.MERCHANT,code:"US_BANK_ACCOUNT_NOT_ENABLED",message:"US bank account is not enabled."},US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED:{type:f.types.MERCHANT,code:"US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED",message:"Bank login is not enabled."}},Fa="https://cdn.plaid.com/link/v2/stable/link-initialize.js";function za(e){this._client=e.client,this._isTokenizingBankLogin=!1,h.sendEvent(this._client,"usbankaccount.initialized")}function Va(e){var t=e.details&&e.details.httpStatus,t=new f(401===t?tr.BRAINTREE_API_ACCESS_RESTRICTED:t<500?Ua.US_BANK_ACCOUNT_FAILED_TOKENIZATION:Ua.US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR);return t.details={originalError:e},t}function Ha(e){return{nonce:e.data.id,details:{},description:e.data.description,type:e.data.type}}function qa(t,n){function r(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(t.removeEventListener("error",i),t.removeEventListener("load",r),t.removeEventListener("readystatechange",r),n(null,x.Plaid))}function i(){t.parentNode.removeChild(t),n(new f(Ua.US_BANK_ACCOUNT_LOGIN_LOAD_FAILED))}t.addEventListener("error",i),t.addEventListener("load",r),t.addEventListener("readystatechange",r)}za.prototype.tokenize=function(e){return(e=e||{}).mandateText?e.bankDetails&&e.bankLogin?u.reject(new f({type:Ua.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.type,code:Ua.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.code,message:"tokenize must be called with bankDetails or bankLogin, not both."})):e.bankDetails?this._tokenizeBankDetails(e):e.bankLogin?this._tokenizeBankLogin(e):u.reject(new f({type:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"tokenize must be called with bankDetails or bankLogin."})):u.reject(new f({type:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"mandateText property is required."}))},za.prototype._tokenizeBankDetails=function(e){var t=this._client,n=e.bankDetails;return t.request({method:"POST",endpoint:"tokens",api:"braintreeApi",data:Si({type:"us_bank_account",routingNumber:n.routingNumber,accountNumber:n.accountNumber,firstName:n.firstName,lastName:n.lastName,businessName:n.businessName,accountType:n.accountType,ownershipType:n.ownershipType,billingAddress:Si(n.billingAddress||{}),achMandate:{text:e.mandateText}})}).then(function(e){return h.sendEvent(t,"usbankaccount.bankdetails.tokenization.succeeded"),u.resolve(Ha(e))}).catch(function(e){e=Va(e);return h.sendEvent(t,"usbankaccount.bankdetails.tokenization.failed"),u.reject(e)})},za.prototype._tokenizeBankLogin=function(i){var o=this,a=this._client,e=a.getConfiguration().gatewayConfiguration,s="production"===e.environment,c=e.usBankAccount.plaid;return i.bankLogin.displayName?c?this._isTokenizingBankLogin?u.reject(new f(Ua.US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE)):(this._isTokenizingBankLogin=!0,new u(function(n,r){o._loadPlaid(function(e,t){e?r(e):(t.create({clientName:i.bankLogin.displayName,apiVersion:"v2",env:s?"production":"sandbox",key:c.publicKey,product:"auth",selectAccount:!0,onExit:function(){o._isTokenizingBankLogin=!1,h.sendEvent(a,"usbankaccount.banklogin.tokenization.closed.by-user"),r(new f(Ua.US_BANK_ACCOUNT_LOGIN_CLOSED))},onSuccess:function(e,t){a.request({method:"POST",endpoint:"tokens",api:"braintreeApi",data:Si({type:"plaid_public_token",publicToken:e,accountId:s?t.account_id:"plaid_account_id",achMandate:{text:i.mandateText},ownershipType:i.bankLogin.ownershipType,firstName:i.bankLogin.firstName,lastName:i.bankLogin.lastName,businessName:i.bankLogin.businessName,billingAddress:Si(i.bankLogin.billingAddress||{})})}).then(function(e){o._isTokenizingBankLogin=!1,h.sendEvent(a,"usbankaccount.banklogin.tokenization.succeeded"),n(Ha(e))}).catch(function(e){o._isTokenizingBankLogin=!1,e=Va(e),h.sendEvent(a,"usbankaccount.banklogin.tokenization.failed"),r(e)})}}).open(),h.sendEvent(a,"usbankaccount.banklogin.tokenization.started"))})})):u.reject(new f(Ua.US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED)):u.reject(new f({type:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:Ua.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"displayName property is required when using bankLogin."}))},za.prototype._loadPlaid=function(e){var t;e=xr(e),x.Plaid?e(null,x.Plaid):(t=document.querySelector('script[src="'+Fa+'"]'))?qa(t,e):((t=document.createElement("script")).src=Fa,t.async=!0,qa(t,e),document.body.appendChild(t),this._plaidScript=t)},za.prototype.teardown=function(){return this._plaidScript&&document.body.removeChild(this._plaidScript),nr(this,er(za.prototype)),u.resolve()};var Wa=sr.wrapPrototype(za);ye={create:sr(function(e){return dr.verify({name:"US Bank Account",client:e.client}).then(function(){return e.client.getConfiguration().gatewayConfiguration.braintreeApi?e.client.getConfiguration().gatewayConfiguration.usBankAccount?new Wa(e):u.reject(new f(Ua.US_BANK_ACCOUNT_NOT_ENABLED)):u.reject(new f(tr.BRAINTREE_API_ACCESS_RESTRICTED))})}),VERSION:"3.29.0"};function Ya(e){this._client=e.client}function Ga(e){var t={nonce:e.nonce,default:e.default,details:e.details,type:e.type};return e.description&&(t.description=e.description),e.binData&&(t.binData=e.binData),t}Ya.prototype.fetchPaymentMethods=function(e){e=!0===(e=e||{}).defaultFirst?1:0;return this._client.request({endpoint:"payment_methods",method:"get",data:{defaultFirst:e}}).then(function(e){return e.paymentMethods.map(Ga)})},Ya.prototype.teardown=function(){return nr(this,er(Ya.prototype)),u.resolve()};var Ka=sr.wrapPrototype(Ya);var fe={create:sr(function(e){return dr.verify({name:"Vault Manager",client:e.client}).then(function(){return new Ka(e)})}),VERSION:"3.29.0"},Ja={VENMO_NOT_ENABLED:{type:f.types.MERCHANT,code:"VENMO_NOT_ENABLED",message:"Venmo is not enabled for this merchant."},VENMO_TOKENIZATION_REQUEST_ACTIVE:{type:f.types.MERCHANT,code:"VENMO_TOKENIZATION_REQUEST_ACTIVE",message:"Another tokenization request is active."},VENMO_APP_FAILED:{type:f.types.UNKNOWN,code:"VENMO_APP_FAILED",message:"Venmo app encountered a problem."},VENMO_APP_CANCELED:{type:f.types.CUSTOMER,code:"VENMO_APP_CANCELED",message:"Venmo app authorization was canceled."},VENMO_CANCELED:{type:f.types.CUSTOMER,code:"VENMO_CANCELED",message:"User canceled Venmo authorization, or Venmo app is not available."}},Qa=/webkit/i;var Xa=fo,Za=mo,es=Wi,ts=function(e){return e=e||navigator.userAgent,Wi(e)&&e.match(Qa)&&-1===e.indexOf("CriOS")},ns=ho,rs=function(e){return e=e||x.navigator.userAgent,bo(e)||/iPhone|iPod|iPad|Mobile|Tablet/i.test(e)&&/Firefox/i.test(e)},is=500,os=1e3,as="https://venmo.com/braintree/checkout";function ss(e){var t;this._client=e.client,t=this._client.getConfiguration(),this._isDebug=t.isDebug,this._assetsUrl=t.gatewayConfiguration.assetsUrl+"/web/3.29.0",this._allowNewBrowserTab=!1!==e.allowNewBrowserTab}function cs(){return x.location.hash.substring(1).split("&").reduce(function(e,t){var t=t.split("="),n=decodeURIComponent(t[0]),t=decodeURIComponent(t[1]);return e[n]=t,e},{})}function us(){var e;return void 0!==x.document.hidden?e="visibilitychange":void 0!==x.document.msHidden?e="msvisibilitychange":void 0!==x.document.webkitHidden&&(e="webkitvisibilitychange"),e}ss.prototype._initialize=function(){var e=x.location.href.replace(x.location.hash,""),t=Rr.parse(x.location.href),n=this._client.getConfiguration().gatewayConfiguration.payWithVenmo,r=this._client.getConfiguration().analyticsMetadata,r={_meta:{version:r.sdkVersion,integration:r.integration,platform:r.platform,sessionId:r.sessionId}};return t["x-success"]=e+"#venmoSuccess=1",t["x-cancel"]=e+"#venmoCancel=1",t["x-error"]=e+"#venmoError=1",t.ua=x.navigator.userAgent,t.braintree_merchant_id=n.merchantId,t.braintree_access_token=n.accessToken,t.braintree_environment=n.environment,t.braintree_sdk_data=btoa(JSON.stringify(r)),this._url=as+"?"+Rr.stringify(t),u.resolve(this)},ss.prototype.isBrowserSupported=function(){var e=Xa()&&Za(),t=es()&&Za(),e=ts()||e,t=t||ns()||rs();return e||this._allowNewBrowserTab&&t},ss.prototype.hasTokenizationResult=function(){var e=cs();return void 0!==(e.venmoSuccess||e.venmoError||e.venmoCancel)},ss.prototype.tokenize=function(){var n=this;return!0===this._tokenizationInProgress?u.reject(new f(Ja.VENMO_TOKENIZATION_REQUEST_ACTIVE)):this.hasTokenizationResult()?this._processResults():new u(function(e,t){n._tokenizationInProgress=!0,n._previousHash=x.location.hash,x.open(n._url),n._visibilityChangeListener=function(){x.document.hidden||(n._tokenizationInProgress=!1,setTimeout(function(){n._processResults().then(e).catch(t).then(function(){x.location.hash=n._previousHash,n._removeVisibilityEventListener(),delete n._visibilityChangeListener})},os))},setTimeout(function(){x.document.addEventListener(us(),n._visibilityChangeListener)},is)})},ss.prototype.teardown=function(){return this._removeVisibilityEventListener(),nr(this,er(ss.prototype)),u.resolve()},ss.prototype._removeVisibilityEventListener=function(){x.document.removeEventListener(us(),this._visibilityChangeListener)},ss.prototype._processResults=function(){var r=this,i=cs();return new u(function(e,t){var n;i.venmoSuccess?(h.sendEvent(r._client,"venmo.appswitch.handle.success"),e((e=i,{nonce:n?n.nonce:e.paymentMethodNonce,type:"VenmoAccount",details:{username:e.username}}))):i.venmoError?(h.sendEvent(r._client,"venmo.appswitch.handle.error"),t(new f({type:Ja.VENMO_APP_FAILED.type,code:Ja.VENMO_APP_FAILED.code,message:Ja.VENMO_APP_FAILED.message,details:{originalError:{message:decodeURIComponent(i.errorMessage),code:i.errorCode}}}))):i.venmoCancel?(h.sendEvent(r._client,"venmo.appswitch.handle.cancel"),t(new f(Ja.VENMO_APP_CANCELED))):(h.sendEvent(r._client,"venmo.appswitch.cancel-or-unavailable"),t(new f(Ja.VENMO_CANCELED))),"function"==typeof x.history.replaceState&&history.pushState({},"",x.location.href.slice(0,x.location.href.indexOf("#")))})};var ls=sr.wrapPrototype(ss);var He={create:sr(function(t){return dr.verify({name:"Venmo",client:t.client}).then(function(){var e;return t.client.getConfiguration().gatewayConfiguration.payWithVenmo?(e=new ls(t),h.sendEvent(t.client,"venmo.initialized"),e._initialize()):u.reject(new f(Ja.VENMO_NOT_ENABLED))})}),VERSION:"3.29.0"},ds={VISA_CHECKOUT_NOT_ENABLED:{type:f.types.MERCHANT,code:"VISA_CHECKOUT_NOT_ENABLED",message:"Visa Checkout is not enabled for this merchant."},VISA_CHECKOUT_INIT_OPTIONS_REQUIRED:{type:f.types.MERCHANT,code:"VISA_CHECKOUT_INIT_OPTIONS_REQUIRED",message:"initOptions requires an object."},VISA_CHECKOUT_PAYMENT_REQUIRED:{type:f.types.MERCHANT,code:"VISA_CHECKOUT_PAYMENT_REQUIRED",message:"tokenize requires callid, encKey, and encPaymentData."},VISA_CHECKOUT_TOKENIZATION:{type:f.types.NETWORK,code:"VISA_CHECKOUT_TOKENIZATION",message:"A network error occurred when processing the Visa Checkout payment."}},fs={Visa:"VISA",MasterCard:"MASTERCARD",Discover:"DISCOVER","American Express":"AMEX"};function ps(e){this._client=e.client}ps.prototype.createInitOptions=function(e){var t=this._client.getConfiguration().gatewayConfiguration,n=t.visaCheckout;if(!e)throw new f(ds.VISA_CHECKOUT_INIT_OPTIONS_REQUIRED);return(e=vr(e)).apikey=e.apikey||n.apikey,e.externalClientId=e.externalClientId||n.externalClientId,e.settings=e.settings||{},e.settings.dataLevel="FULL",e.settings.payment=e.settings.payment||{},e.settings.payment.cardBrands||(e.settings.payment.cardBrands=t.visaCheckout.supportedCardTypes.reduce(function(e,t){return fs.hasOwnProperty(t)?e.concat(fs[t]):e},[])),e},ps.prototype.tokenize=function(e){var t=this;return e.callid&&e.encKey&&e.encPaymentData?this._client.request({method:"post",endpoint:"payment_methods/visa_checkout_cards",data:{_meta:{source:"visa-checkout"},visaCheckoutCard:{callId:e.callid,encryptedPaymentData:e.encPaymentData,encryptedKey:e.encKey}}}).then(function(e){return h.sendEvent(t._client,"visacheckout.tokenize.succeeded"),e.visaCheckoutCards[0]}).catch(function(e){return h.sendEvent(t._client,"visacheckout.tokenize.failed"),u.reject(new f({type:ds.VISA_CHECKOUT_TOKENIZATION.type,code:ds.VISA_CHECKOUT_TOKENIZATION.code,message:ds.VISA_CHECKOUT_TOKENIZATION.message,details:{originalError:e}}))}):u.reject(new f(ds.VISA_CHECKOUT_PAYMENT_REQUIRED))},ps.prototype.teardown=function(){return nr(this,er(ps.prototype)),u.resolve()};var hs=sr.wrapPrototype(ps);var ms={americanExpress:ke,applePay:pe,client:_e,dataCollector:be,hostedFields:ge,ideal:ut,masterpass:he,googlePayment:dt,paymentRequest:xn,paypal:Pn,paypalCheckout:Ln,threeDSecure:Se,unionpay:e,usBankAccount:ye,vaultManager:fe,venmo:He,visaCheckout:{create:sr(function(e){return dr.verify({name:"Visa Checkout",client:e.client}).then(function(){return e.client.getConfiguration().gatewayConfiguration.visaCheckout?(h.sendEvent(e.client,"visacheckout.initialized"),new hs(e)):u.reject(new f(ds.VISA_CHECKOUT_NOT_ENABLED))})}),VERSION:"3.29.0"},VERSION:"3.29.0"},t=(o(gs,[{key:"connect",value:function(){throw new Error("not implemented")}},{key:"getClientToken",value:function(){throw new Error("not implemented")}},{key:"getNonce",value:function(){throw new Error("not implemented")}},{key:"setup",value:function(){throw new Error("not implemented")}},{key:"getCustomer",value:function(){throw new Error("not implemented")}},{key:"createTransaction",value:function(){throw new Error("not implemented")}},{key:"getTransaction",value:function(){throw new Error("not implemented")}},{key:"voidTransaction",value:function(){throw new Error("not implemented")}},{key:"refundTransaction",value:function(){throw new Error("not implemented")}},{key:"createUser",value:function(){throw new Error("not implemented")}},{key:"getUser",value:function(){throw new Error("not implemented")}},{key:"handleError",value:function(){throw new Error("not implemented")}}]),gs);function gs(e,t){i(this,gs),this.connection=null,this.environment=e,this.merchant=t||{},this.errors={NO_CONNECTION:new Error("No connection made yet"),NO_RESPONSE:new Error("No gateway response"),PROCESSOR_DECLINED:new Error("Processor Declined")}}s(ys,t),o(ys,[{key:"connect",value:function(e){var i=this;return new Promise(function(n,r){ms.client.create({authorization:e},function(e,t){e&&r(e),i.connection=t,n()})})}},{key:"getNonce",value:function(e,t){var i=this;return this.connection?(y.isString(t.cvv)||(t.cvv=t.cvv.toString()),y.isString(e.postalCode)||(e.postalCode=e.postalCode.toString()),new Promise(function(n,r){i.connection.request({endpoint:"payment_methods/credit_cards",method:"post",data:{creditCard:{number:t.creditCard,cvv:t.cvv,expirationDate:t.expirationMonth+"/"+t.expirationYear,billingAddress:{postalCode:e.postalCode}}}},function(e,t){if(e&&r(e),!t||!y.isArray(t.creditCards))return r(new Error("no result from braintree"));e=y.first(t.creditCards);e||r(new Error("no credit card information returned from braintree")),n(e.nonce)})})):Promise.reject(new Error("not connected"))}},{key:"getClientToken",value:function(){var e=new Un;return fetch(this.api.url,{method:"GET",headers:{"x-session-api-key":this.api.key,"x-request-id":e.id}}).then(function(e){return e.success?e.clientToken:new Error(e.message)})}}]);var vs=ys;function ys(e,t){i(this,ys);var n=c(this,(ys.__proto__||Object.getPrototypeOf(ys)).call(this));return n.api={url:e,key:t},n}o(bs,[{key:"connect",value:function(){throw new Error("not implemented")}},{key:"createOrder",value:function(){throw new Error("not implemented")}},{key:"updateOrder",value:function(){throw new Error("not implemented")}},{key:"processOrder",value:function(){throw new Error("not implemented")}},{key:"completeOrder",value:function(){throw new Error("not implemented")}},{key:"voidOrder",value:function(){throw new Error("not implemented")}},{key:"getOrder",value:function(){throw new Error("not implemented")}},{key:"getOrders",value:function(){throw new Error("not implemented")}}]);ve=bs;function bs(){i(this,bs),this.errors={GENERAL_ORDER_ERROR:Error("There was an error processing your order"),MISSING_PRODUCT_ERROR:Error("The order is missing a purchasable product"),ORDER_NOT_INSTANCE:Error("Order not instance of EnterpriseOrder"),ORDER_PROCESSING:Error("Order is processing")}}s(ws,ve),o(ws,[{key:"connect",value:function(e){this.api.key=e}},{key:"getOrder",value:function(e){var t=new Un,n=this.api.url+"/order";return e&&(n+="/"+e),fetch(n,{method:"GET",headers:new Headers({"x-session-api-key":this.api.key,"x-request-id":t.id}),credentials:"include"}).then(Ss).then(Es).then(As)}},{key:"getOrders",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,n=new Un;return fetch(this.api.url+"/order/search?skip="+e+"&limit="+t,{method:"GET",headers:new Headers({"x-session-api-key":this.api.key,"x-request-id":n.id}),credentials:"include"}).then(Ss).then(Es).then(As)}}]);var _s=ws;function ws(e,t){i(this,ws);var n=c(this,(ws.__proto__||Object.getPrototypeOf(ws)).call(this));return n.api={url:e||"/api/enterprise",key:t},n}function Ss(e){var t;if(200<=e.status&&e.status<300)return e;throw(t=new Error(e.statusText)).response=e,t}function Es(e){return e.json()}function As(e){return e&&e.data}function ks(e,t){i(this,ks);var n=c(this,(ks.__proto__||Object.getPrototypeOf(ks)).call(this));return n.gatewayService=new vs(e,t),n.orderService=new _s(e,t),n}s(ks,l),xs.exports=ks}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Is("timers").setImmediate)},{crypto:1106,timers:1239}],5:[function(e,i,t){"use strict";var n=e("./package.json").version,o=e("./lib/browser").Cookie,a=e("./lib/browser").Local,s=e("./lib/browser").Session,c=e("./lib/memory"),e=e("./lib/cleanup");i.exports={version:n,Cookie:o,Local:a,Session:s,Memory:c,startCleanup:e.start,stopCleanup:e.stop,setIntervalLength:e.setIntervalLength,getIntervalLength:e.getIntervalLength,set:function(e,t,n){i.exports.remove(e);var r=n&&n.expires;("page"===r?c:"session"===r?s:a).set(e,t,n)},get:function(e){for(var t=[c,s,a,o],n=0;n<t.length;n++){var r=t[n].get(e);if(void 0!==r)return r}},list:function(e){c.list(e),s.list(e),a.list(e),o.list(e)},getLists:function(){return{Memory:c.getList(),Session:s.getList(),Local:a.getList(),Cookie:o.getList()}},remove:function(e){c.remove(e),s.remove(e),a.remove(e),o.remove(e)},clear:function(){c.clear(),s.clear(),a.clear(),o.clear()}},e.start([o,a,s,c])},{"./lib/browser":7,"./lib/cleanup":8,"./lib/memory":13,"./package.json":17}],6:[function(e,r,t){"use strict";var n,i,o,a,s=e("./package.json").version;"undefined"!=typeof window?r.exports=e("./browser"):(i=e("./lib/config"),n=e("./lib/cleanup"),i=e("path").dirname(e.main&&e.main.filename||".")+i.vaultFile,o=e("./lib/file"),a=e("./lib/memory"),r.exports={version:s,startCleanup:n.start,stopCleanup:n.stop,setIntervalLength:n.setIntervalLength,getIntervalLength:n.getIntervalLength,File:o.init(i),Memory:a,set:function(e,t,n){r.exports.remove(e),(n&&n.expires&&"session"===n.expires?a:o).set(e,t,n)},get:function(e){for(var t=[a,o],n=0;n<t.length;n++){var r=t[n].get(e);if(void 0!==r)return r}},list:function(e){a.list(e),o.list(e)},getLists:function(){return{Memory:a.getList(),File:o.getList()}},remove:function(e){a.remove(e),o.remove(e)},clear:function(){a.clear(),o.clear()}},n.start([o,a]))},{"./browser":5,"./lib/cleanup":8,"./lib/config":9,"./lib/file":11,"./lib/memory":13,"./package.json":17,path:1196}],7:[function(e,t,n){"use strict";function r(e){try{var i=window[e],t="vault-test";try{i.foo;i.setItem(t,"bar"),i.removeItem(t)}catch(e){i=void 0}}catch(e){i=void 0}return i?{type:e,get:function(e,t){if(void 0===i[e])return t;if(o.checkKeyMeta(i,e))return t;t=c(i[e]);return t&&t.value||t},getAndRemove:function(e){var t=this.get(e);return this.remove(e),t},getList:function(){var e,t=[];for(e in i){var n={},r=this.get(e);n[e]=r,t.push(n)}return t},set:function(e,t,n){if(e)try{return o.setKeyMeta(i,e,n),i.setItem(e,s(t))}catch(e){}},remove:function(e){return o.clearKeyMeta(i,e),i.removeItem(e)},clear:function(){return i.clear()},list:function(e){if(0!==i.length)for(var t in i)"__vaultData"!==t&&(e?c(i[t]):this.get(t))}}:a}var o=e("./meta"),a=e("./cookie"),s=e("./prepare"),c=e("./parse");t.exports={Local:r("localStorage"),Session:r("sessionStorage"),Cookie:a}},{"./cookie":10,"./meta":14,"./parse":15,"./prepare":16}],8:[function(e,t,n){"use strict";t.exports={start:function(e){!e&&i?e=i:i=e;!function e(t){t.forEach(function(e){try{e.getList()}catch(e){0}});o&&(r=setTimeout(function(){e(t)},a))}(e)},stop:function(){o=!1,clearTimeout(r)},getIntervalLength:function(){return a},setIntervalLength:function(e){a=e}};var r,i=[],o=!0,a=5e3},{}],9:[function(e,t,n){"use strict";t.exports={vaultFile:"/.vault.json",vaultData:"__vaultData"}},{}],10:[function(e,t,n){"use strict";var c=e("./prepare"),r=e("./parse"),u=e("./getExpires");t.exports={type:"cookie",parse:function(e){return r(decodeURIComponent(e))},get:function(e,t){for(var n=document.cookie.split(";"),r=n.length,i=0;i<r;i++){var o=n[i].split("=");if(o[0]=o[0].replace(/^[ ]/,""),o[0]===e)return this.parse(o[1])}return t},getAndRemove:function(e,t){var n=this.get(e);return this.remove(e,t),n},getList:function(){var e=[];if(""!==document.cookie)for(var t=document.cookie.split(";"),n=t.length,r=0;r<n;r++){var i=t[r].split("="),o=(i[0]=i[0].replace(/^[ ]/,""),{});o[i[0]]=this.parse(i[1]),e.push(o)}return e},set:function(e,t,n){var r,i,o,a,s;e&&(r="",n&&n.expires&&(r="; expires="+u(n).toUTCString()),i="",n&&n.max_age&&(i="; max-age="+n.max_age),o="",n&&n.domain&&(o="; domain="+n.domain),a="",n&&n.path&&(a="; path="+n.path),s="",n&&n.sameSite&&(s="; SameSite="+n.sameSite),n=n&&(n.secure||"None"===n.sameSite)?"; secure":"",t=encodeURIComponent(c(t))+a+o+i+r+s+n,document.cookie=e+"="+t)},remove:function(e,t){(t=t||{}).expires="1970-01-01T00:00:01Z",this.set(e,"",t)},clear:function(){for(var e=document.cookie.split(";"),t=e.length,n=0;n<t;n++){var r=e[n].split("=");r[0]=r[0].replace(/^[ ]/,""),this.remove(r[0])}},list:function(){var e=document.cookie.split(";"),t=e.length;if(""!==document.cookie&&0!==t)for(var n=0;n<t;n++){var r=e[n].split("=");r[0]=r[0].replace(/^[ ]/,"")}}}},{"./getExpires":12,"./parse":15,"./prepare":16}],11:[function(e,t,n){"use strict";var r,i,o=e("./meta"),a=e("fs");t.exports={type:"File",init:function(t){r=t;try{i=a.readFileSync(t)}catch(e){a.writeFileSync(t,JSON.stringify({},null,2))}if(i)try{i=JSON.parse(i)}catch(e){}else i={};return this},save:function(e){a.writeFileSync(r,JSON.stringify(i,null,2))},get:function(e,t){if(o.checkKeyMeta(this,e))return t;e=i[e];return void 0===e?t:e},getItem:function(e,t){return this.get(e,t)},getAndRemove:function(e){var t=i[e];return delete i[e],this.save(),t},getList:function(){var e,t=[];for(e in i){var n={},r=this.get(e);n[e]=r,t.push(n)}return t},set:function(e,t,n){if(e)return i[e]=t,o.setKeyMeta(this,e,n),this.save(),i[e]},setItem:function(e,t,n){return this.set(e,t,n)},remove:function(e){try{delete i[e]}catch(e){}this.save()},removeItem:function(e){this.remove(e)},clear:function(){i={},this.save()},list:function(){}}},{"./meta":14,fs:1092}],12:[function(e,t,n){"use strict";t.exports=function(e){if(e.expires.match(/^(\+|\-)\d+\s\w+/)){var t=new Date,n=e.expires.substring(0,1),r=e.expires.substring(1).split(" "),i=parseInt(r[0],10),o=r[1];switch(o){case"millisecond":case"milliseconds":o="Milliseconds";break;case"second":case"seconds":o="Seconds";break;case"minute":case"minutes":o="Minutes";break;case"hour":case"hours":o="Hours";break;case"day":case"days":o="Date";break;case"month":case"months":o="Month";break;case"year":case"years":o="FullYear"}return"-"===n?t["set"+o](t["get"+o]()-i):t["set"+o](t["get"+o]()+i),t}return new Date(e.expires)}},{}],13:[function(e,t,n){"use strict";var r=e("./meta"),i=e("./parse"),o={};t.exports={type:"Memory",get:function(e,t){if(r.checkKeyMeta(this,e))return t;e=o[e];return void 0===e?t:i(e)},getItem:function(e,t){return this.get(e,t)},getAndRemove:function(e){var t=o[e];return delete o[e],t},getList:function(){var e,t=[];for(e in o){var n={},r=this.get(e);n[e]=r,t.push(n)}return t},set:function(e,t,n){if(e)return o[e]=t,r.setKeyMeta(this,e,n),o[e]},setItem:function(e,t,n){return this.set(e,t,n)},remove:function(e){try{delete o[e]}catch(e){}},removeItem:function(e){this.remove(e)},clear:function(){o={}},list:function(){}}},{"./meta":14,"./parse":15}],14:[function(e,t,n){"use strict";function o(e){return e="string"==typeof(e=(e=e.getItem(s.vaultData))||{})?JSON.parse(e):e}function i(e,t){if(t===s.vaultData)return!1;try{return o(e)[t]}catch(e){return}}function a(e,t){if(t===s.vaultData)return!1;try{var n=o(e);delete n[t],e.setItem(s.vaultData,c(n))}catch(e){}}var s=e("./config"),c=e("./prepare"),u=e("./parse"),l=e("./getExpires");t.exports={getData:o,setKeyMeta:function(e,t,n){if(t===s.vaultData)return!1;n=n||{};var r,i=o(e);i[t]||(i[t]={}),n.expires?(r=l(n),i[t].expires=r&&r.valueOf()):delete i[t].expires,n.path?i[t].path=n.path:delete i[t].path,e.setItem(s.vaultData,c(i))},getKeyMeta:i,clearKeyMeta:a,checkKeyMeta:function(e,t){if(t===s.vaultData)return!1;try{var n=u(e[t]),r=i(e,t);if(r){if(r.path&&"undefined"!=typeof window)if(!(window.location.pathname||window.location.path).match(r.path))return!0;if(!r.expires&&n&&n.expires&&(r.expires=n.expires),r.expires&&r.expires<=new Date)return new Date(r.expires).toString(),a(e,t),e.removeItem(t),!0}}catch(e){}return!1}}},{"./config":9,"./getExpires":12,"./parse":15,"./prepare":16}],15:[function(e,t,n){"use strict";t.exports=function(t){if(null!=t&&"undefined"!==t){if("null"===t)return null;if(!0===t||"true"===t)return!0;if(!1===t||"false"===t)return!1;if(""!==t&&!isNaN(Number(t)))return+t;if(t.indexOf&&(0===t.indexOf("{")||0===t.indexOf("[")))try{return JSON.parse(t)}catch(e){return t}return t}}},{}],16:[function(e,t,n){"use strict";t.exports=function(e){if(null==e)return e;if("object"==typeof(e=e&&e.indexOf&&(0===e.indexOf("{")||0===e.indexOf("["))?JSON.parse(e):e))try{return JSON.stringify(e)}catch(e){}return e}},{}],17:[function(e,t,n){t.exports={name:"@creativelive/vault.js",version:"1.1.1",description:"Key-Value Storage of true data types for the browser and node",main:"index.js",author:"Jimmy Byrum (https://github.com/jimmybyrum)",license:"MIT",repository:{type:"git",url:"git@github.com:jimmybyrum/vault.js.git"},bugs:{url:"https://github.com/jimmybyrum/vault.js/issues"},homepage:"http://jimmybyrum.github.io/vault.js/",scripts:{test:"alias gulp='node_modules/gulp/bin/gulp.js';gulp eslint;mocha ./test;",build:""},keywords:["localStorage","sessionStorage","cookie","cookies","local","session","file","store","storage","key","value","key-value","json"],devDependencies:{gulp:"4.x.x","gulp-eslint":"^0.2.0",mocha:"^2.2.5"},_resolved:"https://npm.prod.creativelive.com/@creativelive%2fvault.js/-/vault.js-1.1.1.tgz",_integrity:"sha512-2C/XQ/v4vvwpSz2PGNg/pX9vVY35UMhFVi++G94LBs7iT+tvlFT56iFOT0FkdI1fJNGryZ+k7bJtvbgpP+BMlA==",_from:"@creativelive/vault.js@1.1.1"}},{}],18:[function(require,module,exports){document.createElement("video"),document.createElement("audio"),document.createElement("track");var vjs=function(e,t,n){var r;if("string"==typeof e){if(0===e.indexOf("#")&&(e=e.slice(1)),vjs.players[e])return t&&vjs.log.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&vjs.players[e].ready(n),vjs.players[e];r=vjs.el(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return r.player||new vjs.Player(r,t,n)},videojs=window.videojs=vjs;function _handleMultipleEvents(t,n,e,r){vjs.arr.forEach(e,function(e){t(n,e,r)})}vjs.CDN_VERSION="4.12",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.VERSION="4.12.15",vjs.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],inactivityTimeout:2e3,children:{mediaLoader:{},posterImage:{},loadingSpinner:{},textTrackDisplay:{},bigPlayButton:{},controlBar:{},errorDisplay:{},textTrackSettings:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."},"GENERATED_CDN_VSN"!==vjs.CDN_VERSION&&(videojs.options.flash.swf=vjs.ACCESS_PROTOCOL+"vjs.zencdn.net/"+vjs.CDN_VERSION+"/video-js.swf"),vjs.addLanguage=function(e,t){return void 0!==vjs.options.languages[e]?vjs.options.languages[e]=vjs.util.mergeOptions(vjs.options.languages[e],t):vjs.options.languages[e]=t,vjs.options.languages},vjs.players={},"function"==typeof define&&define.amd?define("videojs",[],function(){return videojs}):"object"==typeof exports&&"object"==typeof module&&(module.exports=videojs),vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(e){var t,n,r=(e=e||{}).init||e.init||this.prototype.init||this.prototype.init||function(){};for(n in(((t=function(){r.apply(this,arguments)}).prototype=vjs.obj.create(this.prototype)).constructor=t).extend=vjs.CoreObject.extend,t.create=vjs.CoreObject.create,e)e.hasOwnProperty(n)&&(t.prototype[n]=e[n]);return t},vjs.CoreObject.create=function(){var e=vjs.obj.create(this.prototype);return this.apply(e,arguments),e},vjs.on=function(o,e,t){if(vjs.obj.isArray(e))return _handleMultipleEvents(vjs.on,o,e,t);var a=vjs.getData(o);a.handlers||(a.handlers={}),a.handlers[e]||(a.handlers[e]=[]),t.guid||(t.guid=vjs.guid++),a.handlers[e].push(t),a.dispatcher||(a.disabled=!1,a.dispatcher=function(e){if(!a.disabled){e=vjs.fixEvent(e);var t=a.handlers[e.type];if(t)for(var n=t.slice(0),r=0,i=n.length;r<i&&!e.isImmediatePropagationStopped();r++)n[r].call(o,e)}}),1==a.handlers[e].length&&(o.addEventListener?o.addEventListener(e,a.dispatcher,!1):o.attachEvent&&o.attachEvent("on"+e,a.dispatcher))},vjs.off=function(t,e,n){if(vjs.hasData(t)){var r=vjs.getData(t);if(r.handlers){if(vjs.obj.isArray(e))return _handleMultipleEvents(vjs.off,t,e,n);function i(e){r.handlers[e]=[],vjs.cleanUpEvents(t,e)}if(e){var o=r.handlers[e];if(o)if(n){if(n.guid)for(var a=0;a<o.length;a++)o[a].guid===n.guid&&o.splice(a--,1);vjs.cleanUpEvents(t,e)}else i(e)}else for(var s in r.handlers)i(s)}}},vjs.cleanUpEvents=function(e,t){var n=vjs.getData(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),vjs.isEmpty(n.handlers)&&(delete n.handlers,delete n.dispatcher,delete n.disabled),vjs.isEmpty(n)&&vjs.removeData(e)},vjs.fixEvent=function(e){function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var r,i,o,a=e||window.event;for(r in e={},a)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&("returnValue"==r&&a.preventDefault||(e[r]=a[r]));e.target||(e.target=e.srcElement||document),e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement,e.preventDefault=function(){a.preventDefault&&a.preventDefault(),e.returnValue=!1,e.isDefaultPrevented=t,e.defaultPrevented=!0},e.isDefaultPrevented=n,e.defaultPrevented=!1,e.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),e.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!=e.clientX&&(i=document.documentElement,o=document.body,e.pageX=e.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),e.which=e.charCode||e.keyCode,null!=e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e},vjs.trigger=function(e,t){var n=vjs.hasData(e)?vjs.getData(e):{},r=e.parentNode||e.ownerDocument;return t=vjs.fixEvent(t="string"==typeof t?{type:t,target:e}:t),n.dispatcher&&n.dispatcher.call(e,t),r&&!t.isPropagationStopped()&&!1!==t.bubbles?vjs.trigger(r,t):r||t.defaultPrevented||(n=vjs.getData(t.target),t.target[t.type]&&(n.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),n.disabled=!1)),!t.defaultPrevented},vjs.one=function(e,t,n){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.one,e,t,n);function r(){vjs.off(e,t,r),n.apply(this,arguments)}r.guid=n.guid=n.guid||vjs.guid++,vjs.on(e,t,r)};var hasOwnProp=Object.prototype.hasOwnProperty,y00,B00,C00,A00;function _logType(e,t){var t=Array.prototype.slice.call(t),n=function(){},n=window.console||{log:n,warn:n,error:n};e?t.unshift(e.toUpperCase()+":"):e="log",vjs.log.history.push(t),t.unshift("VIDEOJS:"),n[e].apply&&n[e].apply(n,t)}vjs.createEl=function(e,t){var n;return e=e||"div",t=t||{},n=document.createElement(e),vjs.obj.each(t,function(e,t){-1!==e.indexOf("aria-")||"role"==e?n.setAttribute(e,t):n[e]=t}),n},vjs.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(e){function t(){}return t.prototype=e,new t},vjs.obj.each=function(e,t,n){for(var r in e)hasOwnProp.call(e,r)&&t.call(n||this,r,e[r])},vjs.obj.merge=function(e,t){if(!t)return e;for(var n in t)hasOwnProp.call(t,n)&&(e[n]=t[n]);return e},vjs.obj.deepMerge=function(e,t){var n,r,i;for(n in e=vjs.obj.copy(e),t)hasOwnProp.call(t,n)&&(r=e[n],i=t[n],vjs.obj.isPlain(r)&&vjs.obj.isPlain(i)?e[n]=vjs.obj.deepMerge(r,i):e[n]=t[n]);return e},vjs.obj.copy=function(e){return vjs.obj.merge({},e)},vjs.obj.isPlain=function(e){return!!e&&"object"==typeof e&&"[object Object]"===e.toString()&&e.constructor===Object},vjs.obj.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},vjs.isNaN=function(e){return e!=e},vjs.bind=function(e,t,n){t.guid||(t.guid=vjs.guid++);function r(){return t.apply(e,arguments)}return r.guid=n?n+"_"+t.guid:t.guid,r},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(e){var t=(t=e[vjs.expando])||(e[vjs.expando]=vjs.guid++);return vjs.cache[t]||(vjs.cache[t]={}),vjs.cache[t]},vjs.hasData=function(e){e=e[vjs.expando];return!(!e||vjs.isEmpty(vjs.cache[e]))},vjs.removeData=function(t){var e=t[vjs.expando];if(e){delete vjs.cache[e];try{delete t[vjs.expando]}catch(e){t.removeAttribute?t.removeAttribute(vjs.expando):t[vjs.expando]=null}}},vjs.isEmpty=function(e){for(var t in e)if(null!==e[t])return!1;return!0},vjs.hasClass=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},vjs.addClass=function(e,t){vjs.hasClass(e,t)||(e.className=""===e.className?t:e.className+" "+t)},vjs.removeClass=function(e,t){var n,r;if(vjs.hasClass(e,t)){for(r=(n=e.className.split(" ")).length-1;0<=r;r--)n[r]===t&&n.splice(r,1);e.className=n.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),y00=document.createElement("track"),y00.kind="captions",y00.srclang="en",y00.label="English",vjs.TEST_VID.appendChild(y00),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var e=vjs.USER_AGENT.match(/OS (\d+)_/i);if(e&&e[1])return e[1]}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=(A00=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),A00?(B00=A00[1]&&parseFloat(A00[1]),C00=A00[2]&&parseFloat(A00[2]),B00&&C00?parseFloat(A00[1]+"."+A00[2]):B00||null):null),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.IS_IE8=/MSIE\s8\.0/.test(vjs.USER_AGENT),vjs.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),vjs.BACKGROUND_SIZE_SUPPORTED="backgroundSize"in vjs.TEST_VID.style,vjs.setElementAttributes=function(n,e){vjs.obj.each(e,function(e,t){null==t||!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)})},vjs.getElementAttributes=function(e){var t,n,r={},i=",autoplay,controls,loop,muted,default,";if(e&&e.attributes&&0<e.attributes.length)for(var o,a=(o=e.attributes).length-1;0<=a;a--)t=o[a].name,n=o[a].value,"boolean"!=typeof e[t]&&-1===i.indexOf(","+t+",")||(n=null!==n),r[t]=n;return r},vjs.getComputedDimension=function(e,t){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(n=e["client"+t.substr(0,1).toUpperCase()+t.substr(1)]+"px"),n},vjs.insertFirst=function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},vjs.browser={},vjs.el=function(e){return 0===e.indexOf("#")&&(e=e.slice(1)),document.getElementById(e)},vjs.formatTime=function(e,t){t=t||e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),o=Math.floor(t/60%60),t=Math.floor(t/3600);return(i=0<(i=!isNaN(e)&&e!==1/0?i:r=n="-")||0<t?i+":":"")+(r=((i||10<=o)&&r<10?"0"+r:r)+":")+(n=n<10?"0"+n:n)},vjs.blockTextSelection=function(){document.body.focus(),document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(e){return(e+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(e,t){return t=t||0,Math.round(e*Math.pow(10,t))/Math.pow(10,t)},vjs.createTimeRange=function(e,t){return void 0===e&&void 0===t?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:1,start:function(){return e},end:function(){return t}}},vjs.setLocalStorage=function(e,t){try{var n=window.localStorage||!1;if(!n)return;n[e]=t}catch(e){22==e.code||1014==e.code?vjs.log("LocalStorage Full (VideoJS)",e):18==e.code?vjs.log("LocalStorage not allowed (VideoJS)",e):vjs.log("LocalStorage Error (VideoJS)",e)}},vjs.getAbsoluteURL=function(e){return e=e.match(/^https?:\/\//)?e:vjs.createEl("div",{innerHTML:'<a href="'+e+'">x</a>'}).firstChild.href},vjs.parseUrl=function(e){var t,n=["protocol","hostname","port","pathname","search","hash","host"],r=vjs.createEl("a",{href:e}),i=""===r.host&&"file:"!==r.protocol;i&&((t=vjs.createEl("div")).innerHTML='<a href="'+e+'"></a>',r=t.firstChild,t.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(t));for(var o={},a=0;a<n.length;a++)o[n[a]]=r[n[a]];return"http:"===o.protocol&&(o.host=o.host.replace(/:80$/,"")),"https:"===o.protocol&&(o.host=o.host.replace(/:443$/,"")),i&&document.body.removeChild(t),o},vjs.log=function(){_logType(null,arguments)},vjs.log.history=[],vjs.log.error=function(){_logType("error",arguments)},vjs.log.warn=function(){_logType("warn",arguments)},vjs.findPosition=function(e){var t,n,r,i;return(t=e.getBoundingClientRect&&e.parentNode?e.getBoundingClientRect():t)?(e=document.documentElement,i=document.body,r=e.clientLeft||i.clientLeft||0,n=window.pageXOffset||i.scrollLeft,n=t.left+n-r,r=e.clientTop||i.clientTop||0,e=window.pageYOffset||i.scrollTop,i=t.top+e-r,{left:vjs.round(n),top:vjs.round(i)}):{left:0,top:0}},vjs.arr={},vjs.arr.forEach=function(e,t,n){if(vjs.obj.isArray(e)&&t instanceof Function)for(var r=0,i=e.length;r<i;++r)t.call(n||vjs,e[r],r,e);return e},vjs.xhr=function(e,t){var n,r,i,o,a,s,c;videojs.util.mergeOptions({method:"GET",timeout:45e3},e="string"==typeof e?{uri:e}:e),t=t||function(){},s=function(){window.clearTimeout(a),t(null,n,n.response||n.responseText)},c=function(e){window.clearTimeout(a),e&&"string"!=typeof e||(e=new Error(e)),t(e,n)},r=window.XMLHttpRequest,(n=new(r=void 0===r?function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}:r)).uri=e.uri,r=vjs.parseUrl(e.uri),i=window.location,!(r.protocol+r.host!==i.protocol+i.host)||!window.XDomainRequest||"withCredentials"in n?(o="file:"==r.protocol||"file:"==i.protocol,n.onreadystatechange=function(){if(4===n.readyState){if(n.timedout)return c("timeout");(200===n.status||o&&0===n.status?s:c)()}},e.timeout&&(a=window.setTimeout(function(){4!==n.readyState&&(n.timedout=!0,n.abort())},e.timeout))):((n=new window.XDomainRequest).onload=s,n.onerror=c,n.onprogress=function(){},n.ontimeout=function(){});try{n.open(e.method||"GET",e.uri,!0)}catch(e){return c(e)}e.withCredentials&&(n.withCredentials=!0),e.responseType&&(n.responseType=e.responseType);try{n.send()}catch(e){return c(e)}return n},vjs.util={},vjs.util.mergeOptions=function(e,t){var n,r,i;for(n in e=vjs.obj.copy(e),t)t.hasOwnProperty(n)&&(r=e[n],i=t[n],vjs.obj.isPlain(r)&&vjs.obj.isPlain(i)?e[n]=vjs.util.mergeOptions(r,i):e[n]=t[n]);return e},vjs.EventEmitter=function(){},vjs.EventEmitter.prototype.allowedEvents_={},vjs.EventEmitter.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=Function.prototype,vjs.on(this,e,t),this.addEventListener=n},vjs.EventEmitter.prototype.addEventListener=vjs.EventEmitter.prototype.on,vjs.EventEmitter.prototype.off=function(e,t){vjs.off(this,e,t)},vjs.EventEmitter.prototype.removeEventListener=vjs.EventEmitter.prototype.off,vjs.EventEmitter.prototype.one=function(e,t){vjs.one(this,e,t)},vjs.EventEmitter.prototype.trigger=function(e){var t=e.type||e;e=vjs.fixEvent(e="string"==typeof e?{type:t}:e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),vjs.trigger(this,e)},vjs.EventEmitter.prototype.dispatchEvent=vjs.EventEmitter.prototype.trigger,vjs.Component=vjs.CoreObject.extend({init:function(e,t,n){this.player_=e,this.options_=vjs.obj.copy(this.options_),t=this.options(t),this.id_=t.id||t.el&&t.el.id,this.id_||(this.id_=(e.id&&e.id()||"no_player")+"_component_"+vjs.guid++),this.name_=t.name||null,this.el_=t.el||this.createEl(),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}}),vjs.Component.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),vjs.removeData(this.el_),this.el_=null},vjs.Component.prototype.player_=!0,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(e){return void 0===e?this.options_:this.options_=vjs.util.mergeOptions(this.options_,e)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(e,t){return vjs.createEl(e,t)},vjs.Component.prototype.localize=function(e){var t=this.player_.language(),n=this.player_.languages();return n&&n[t]&&n[t][e]?n[t][e]:e},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(e){return this.childIndex_[e]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(e){return this.childNameIndex_[e]},vjs.Component.prototype.addChild=function(e,t){var n,r="string"==typeof e?(n=e,r=(t=t||{}).componentClass||vjs.capitalize(n),t.name=n,new window.videojs[r](this.player_||this,t)):e;return this.children_.push(r),"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(n=n||r.name&&r.name())&&(this.childNameIndex_[n]=r),"function"==typeof r.el&&r.el()&&this.contentEl().appendChild(r.el()),r},vjs.Component.prototype.removeChild=function(e){if((e="string"==typeof e?this.getChild(e):e)&&this.children_){for(var t,n=!1,r=this.children_.length-1;0<=r;r--)if(this.children_[r]===e){n=!0,this.children_.splice(r,1);break}n&&(this.childIndex_[e.id()]=null,this.childNameIndex_[e.name()]=null,(t=e.el())&&t.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el()))}},vjs.Component.prototype.initChildren=function(){var e,t,n,r=this,i=r.options(),o=i.children;if(o)if(n=function(e,t){!1!==(t=void 0!==i[e]?i[e]:t)&&(r[e]=r.addChild(e,t))},vjs.obj.isArray(o))for(var a=0;a<o.length;a++)t="string"==typeof(t=o[a])?(e=t,{}):(e=t.name,t),n(e,t);else vjs.obj.each(o,n)},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(e,t,n){var r,i,o,a,s;return"string"==typeof e||vjs.obj.isArray(e)?vjs.on(this.el_,e,vjs.bind(this,t)):(r=e,i=t,o=vjs.bind(this,n),s=this,(a=function(){s.off(r,i,o)}).guid=o.guid,this.on("dispose",a),(t=function(){s.off("dispose",a)}).guid=o.guid,e.nodeName?(vjs.on(r,i,o),vjs.on(r,"dispose",t)):"function"==typeof e.on&&(r.on(i,o),r.on("dispose",t))),this},vjs.Component.prototype.off=function(e,t,n){var r;return!e||"string"==typeof e||vjs.obj.isArray(e)?vjs.off(this.el_,e,t):(r=e,t=t,n=vjs.bind(this,n),this.off("dispose",n),e.nodeName?(vjs.off(r,t,n),vjs.off(r,"dispose",n)):(r.off(t,n),r.off("dispose",n))),this},vjs.Component.prototype.one=function(e,t,n){var r,i,o,a,s;return"string"==typeof e||vjs.obj.isArray(e)?vjs.one(this.el_,e,vjs.bind(this,t)):(r=e,i=t,o=vjs.bind(this,n),a=this,(s=function(){a.off(r,i,s),o.apply(this,arguments)}).guid=o.guid,this.on(r,i,s)),this},vjs.Component.prototype.trigger=function(e){return vjs.trigger(this.el_,e),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(e){return e&&(this.isReady_?e.call(this):(void 0===this.readyQueue_&&(this.readyQueue_=[]),this.readyQueue_.push(e))),this},vjs.Component.prototype.triggerReady=function(){this.isReady_=!0;var e=this.readyQueue_;if(this.readyQueue_=[],e&&0<e.length){for(var t=0,n=e.length;t<n;t++)e[t].call(this);this.trigger("ready")}},vjs.Component.prototype.hasClass=function(e){return vjs.hasClass(this.el_,e)},vjs.Component.prototype.addClass=function(e){return vjs.addClass(this.el_,e),this},vjs.Component.prototype.removeClass=function(e){return vjs.removeClass(this.el_,e),this},vjs.Component.prototype.show=function(){return this.removeClass("vjs-hidden"),this},vjs.Component.prototype.hide=function(){return this.addClass("vjs-hidden"),this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide(),this.show=function(){}},vjs.Component.prototype.width=function(e,t){return this.dimension("width",e,t)},vjs.Component.prototype.height=function(e,t){return this.dimension("height",e,t)},vjs.Component.prototype.dimensions=function(e,t){return this.width(e,!0).height(t)},vjs.Component.prototype.dimension=function(e,t,n){if(void 0!==t)return-1!==(""+(t=null!==t&&!vjs.isNaN(t)?t:0)).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",n||this.trigger("resize"),this;if(!this.el_)return 0;t=this.el_.style[e],n=t.indexOf("px");return-1!==n?parseInt(t.slice(0,n),10):parseInt(this.el_["offset"+vjs.capitalize(e)],10)},vjs.Component.prototype.onResize,vjs.Component.prototype.emitTapEvents=function(){var t,e,n,r,i=0,o=null;this.on("touchstart",function(e){1===e.touches.length&&(o=vjs.obj.copy(e.touches[0]),i=(new Date).getTime(),t=!0)}),this.on("touchmove",function(e){1<e.touches.length?t=!1:o&&(n=e.touches[0].pageX-o.pageX,r=e.touches[0].pageY-o.pageY,10<Math.sqrt(n*n+r*r)&&(t=!1))}),this.on("touchleave",e=function(){t=!1}),this.on("touchcancel",e),this.on("touchend",function(e){!(o=null)===t&&(new Date).getTime()-i<200&&(e.preventDefault(),this.trigger("tap"))})},vjs.Component.prototype.enableTouchActivity=function(){var t,n,e;this.player().reportUserActivity&&(t=vjs.bind(this.player(),this.player().reportUserActivity),this.on("touchstart",function(){t(),this.clearInterval(n),n=this.setInterval(t,250)}),e=function(e){t(),this.clearInterval(n)},this.on("touchmove",t),this.on("touchend",e),this.on("touchcancel",e))},vjs.Component.prototype.setTimeout=function(e,t){e=vjs.bind(this,e);function n(){this.clearTimeout(r)}var r=setTimeout(e,t);return n.guid="vjs-timeout-"+r,this.on("dispose",n),r},vjs.Component.prototype.clearTimeout=function(e){clearTimeout(e);function t(){}return t.guid="vjs-timeout-"+e,this.off("dispose",t),e},vjs.Component.prototype.setInterval=function(e,t){e=vjs.bind(this,e);function n(){this.clearInterval(r)}var r=setInterval(e,t);return n.guid="vjs-interval-"+r,this.on("dispose",n),r},vjs.Component.prototype.clearInterval=function(e){clearInterval(e);function t(){}return t.guid="vjs-interval-"+e,this.off("dispose",t),e},vjs.Button=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.emitTapEvents(),this.on("tap",this.onClick),this.on("click",this.onClick),this.on("focus",this.onFocus),this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(e,t){return t=vjs.obj.merge({className:this.buildCSSClass(),role:"button","aria-live":"polite",tabIndex:0},t),e=vjs.Component.prototype.createEl.call(this,e,t),t.innerHTML||(this.contentEl_=vjs.createEl("div",{className:"vjs-control-content"}),this.controlText_=vjs.createEl("span",{className:"vjs-control-text",innerHTML:this.localize(this.buttonText)||"Need Text"}),this.contentEl_.appendChild(this.controlText_),e.appendChild(this.contentEl_)),e},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(e){32!=e.which&&13!=e.which||(e.preventDefault(),this.onClick())},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.bar=this.getChild(this.options_.barName),this.handle=this.getChild(this.options_.handleName),this.on("mousedown",this.onMouseDown),this.on("touchstart",this.onMouseDown),this.on("focus",this.onFocus),this.on("blur",this.onBlur),this.on("click",this.onClick),this.on(e,"controlsvisible",this.update),this.on(e,this.playerEvent,this.update)}}),vjs.Slider.prototype.createEl=function(e,t){return(t=t||{}).className=t.className+" vjs-slider",t=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},t),vjs.Component.prototype.createEl.call(this,e,t)},vjs.Slider.prototype.onMouseDown=function(e){e.preventDefault(),vjs.blockTextSelection(),this.addClass("vjs-sliding"),this.on(document,"mousemove",this.onMouseMove),this.on(document,"mouseup",this.onMouseUp),this.on(document,"touchmove",this.onMouseMove),this.on(document,"touchend",this.onMouseUp),this.onMouseMove(e)},vjs.Slider.prototype.onMouseMove=function(){},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection(),this.removeClass("vjs-sliding"),this.off(document,"mousemove",this.onMouseMove),this.off(document,"mouseup",this.onMouseUp),this.off(document,"touchmove",this.onMouseMove),this.off(document,"touchend",this.onMouseUp),this.update()},vjs.Slider.prototype.update=function(){var e,t,n,r,i;this.el_&&(n=this.getPercent(),e=this.handle,t=this.bar,i=n="number"!=typeof n||n!=n||n<0||n===1/0?0:n,e&&(r=this.el_.offsetWidth,i=(r=n*(1-(n=(n=e.el().offsetWidth)?n/r:0)))+n/2,e.el().style.left=vjs.round(100*r,2)+"%"),t&&(t.el().style.width=vjs.round(100*i,2)+"%"))},vjs.Slider.prototype.calculateDistance=function(e){var t,n,r,i=this.el_,o=vjs.findPosition(i),a=i=i.offsetWidth,s=this.handle;return this.options().vertical?(r=o.top,t=(e.changedTouches?e.changedTouches[0]:e).pageY,s&&(r+=(n=s.el().offsetHeight)/2,i-=n),Math.max(0,Math.min(1,(r-t+i)/i))):(n=o.left,r=(e.changedTouches?e.changedTouches[0]:e).pageX,s&&(n+=(t=s.el().offsetWidth)/2,a-=t),Math.max(0,Math.min(1,(r-n)/a)))},vjs.Slider.prototype.onFocus=function(){this.on(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onKeyPress=function(e){37==e.which||40==e.which?(e.preventDefault(),this.stepBack()):38!=e.which&&39!=e.which||(e.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){this.off(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onClick=function(e){e.stopImmediatePropagation(),e.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(e,t){return(t=t||{}).className=t.className+" vjs-slider-handle",t=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},t),vjs.Component.prototype.createEl.call(this,"div",t)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(e){this.addChild(e),e.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var e=this.options().contentElType||"ul",e=(this.contentEl_=vjs.createEl(e,{className:"vjs-menu-content"}),vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"}));return e.appendChild(this.contentEl_),vjs.on(e,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),e},vjs.MenuItem=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t),this.selected(t.selected)}}),vjs.MenuItem.prototype.createEl=function(e,t){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label)},t))},vjs.MenuItem.prototype.onClick=function(){this.selected(!0)},vjs.MenuItem.prototype.selected=function(e){e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t),this.update(),this.on("keydown",this.onKeyPress),this.el_.setAttribute("aria-haspopup",!0),this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.update=function(){var e=this.createMenu();this.menu&&this.removeChild(this.menu),this.menu=e,this.addChild(e),this.items&&0===this.items.length?this.hide():this.items&&1<this.items.length&&this.show()},vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var e=new vjs.Menu(this.player_);if(this.options().title&&e.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.options().title),tabindex:-1})),this.items=this.createItems(),this.items)for(var t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onClick=function(){this.one("mouseout",vjs.bind(this,function(){this.menu.unlockShowing(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(e){32==e.which||13==e.which?(this.buttonPressed_?this.unpressButton():this.pressButton(),e.preventDefault()):27==e.which&&(this.buttonPressed_&&this.unpressButton(),e.preventDefault())},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-pressed",!0),this.items&&0<this.items.length&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-pressed",!1)},vjs.MediaError=function(e){"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:"object"==typeof e&&vjs.obj.merge(this,e),this.message||(this.message=vjs.MediaError.defaultMessages[this.code]||"")},vjs.MediaError.prototype.code=0,vjs.MediaError.prototype.message="",vjs.MediaError.prototype.status=null,vjs.MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],vjs.MediaError.defaultMessages={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."};for(var errNum=0,id0,jd0,kd0,ld0,E40,C50,D50,R50,S50,T50,C60,D60,E60,cx,w80,x80,y80,z80,A80,B80,C80,D80,F80,G80,Dj0,Ej0,Fj0;errNum<vjs.MediaError.errorTypes.length;errNum++)vjs.MediaError[vjs.MediaError.errorTypes[errNum]]=errNum,vjs.MediaError.prototype[vjs.MediaError.errorTypes[errNum]]=errNum;for(vjs.browser.fullscreenAPI,jd0=(id0=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]])[0],ld0=0;ld0<id0.length;ld0++)if(id0[ld0][1]in document){kd0=id0[ld0];break}if(kd0)for(vjs.browser.fullscreenAPI={},ld0=0;ld0<kd0.length;ld0++)vjs.browser.fullscreenAPI[jd0[ld0]]=kd0[ld0];vjs.Player=vjs.Component.extend({init:function(e,t,n){(this.tag=e).id=e.id||"vjs_video_"+vjs.guid++,this.tagAttributes=e&&vjs.getElementAttributes(e),t=vjs.obj.merge(this.getTagSettings(e),t),this.language_=t.language||vjs.options.language,this.languages_=t.languages||vjs.options.languages,this.cache_={},this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,t.reportTouchActivity=!1,this.isAudio("audio"===this.tag.nodeName.toLowerCase()),vjs.Component.call(this,this,t,n),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.isAudio()&&this.addClass("vjs-audio"),vjs.players[this.id_]=this,t.plugins&&vjs.obj.each(t.plugins,function(e,t){this[e](t)},this),this.listenForUserActivity()}}),vjs.Player.prototype.language_,vjs.Player.prototype.language=function(e){return void 0===e?this.language_:(this.language_=e,this)},vjs.Player.prototype.languages_,vjs.Player.prototype.languages=function(){return this.languages_},vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),vjs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech&&this.tech.dispose(),vjs.Component.prototype.dispose.call(this)},vjs.Player.prototype.getTagSettings=function(e){var t={sources:[],tracks:[]},n=vjs.getElementAttributes(e),r=n["data-setup"];if(null!==r&&vjs.obj.merge(n,vjs.JSON.parse(r||"{}")),vjs.obj.merge(t,n),e.hasChildNodes())for(var i,o,a=e.childNodes,s=0,c=a.length;s<c;s++)"source"===(o=(i=a[s]).nodeName.toLowerCase())?t.sources.push(vjs.getElementAttributes(i)):"track"===o&&t.tracks.push(vjs.getElementAttributes(i));return t},vjs.Player.prototype.createEl=function(){var t,n=this.el_=vjs.Component.prototype.createEl.call(this,"div"),e=this.tag;return e.removeAttribute("width"),e.removeAttribute("height"),t=vjs.getElementAttributes(e),vjs.obj.each(t,function(e){"class"==e?n.className=t[e]:n.setAttribute(e,t[e])}),e.id+="_html5_api",e.className="vjs-tech",(e.player=n.player=this).addClass("vjs-paused"),this.width(this.options_.width,!0),this.height(this.options_.height,!0),e.initNetworkState_=e.networkState,e.parentNode&&e.parentNode.insertBefore(n,e),vjs.insertFirst(e,n),this.el_=n,this.on("loadstart",this.onLoadStart),this.on("waiting",this.onWaiting),this.on(["canplay","canplaythrough","playing","ended"],this.onWaitEnd),this.on("seeking",this.onSeeking),this.on("seeked",this.onSeeked),this.on("ended",this.onEnded),this.on("play",this.onPlay),this.on("firstplay",this.onFirstPlay),this.on("pause",this.onPause),this.on("progress",this.onProgress),this.on("durationchange",this.onDurationChange),this.on("fullscreenchange",this.onFullscreenChange),n},vjs.Player.prototype.loadTech=function(e,t){this.tech&&this.unloadTech(),"Html5"!==e&&this.tag&&(vjs.Html5.disposeMediaElement(this.tag),this.tag=null),this.techName=e,this.isReady_=!1;var n=vjs.obj.merge({source:t,parentEl:this.el_},this.options_[e.toLowerCase()]);t&&(this.currentType_=t.type,t.src==this.cache_.src&&0<this.cache_.currentTime&&(n.startTime=this.cache_.currentTime),this.cache_.src=t.src),this.tech=new window.videojs[e](this,n),this.tech.ready(function(){this.player_.triggerReady()})},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1,this.tech.dispose(),this.tech=!1},vjs.Player.prototype.onLoadStart=function(){this.removeClass("vjs-ended"),this.error(null),this.paused()?this.hasStarted(!1):this.trigger("firstplay")},vjs.Player.prototype.hasStarted_=!1,vjs.Player.prototype.hasStarted=function(e){return void 0!==e?(this.hasStarted_!==e&&((this.hasStarted_=e)?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):this.hasStarted_},vjs.Player.prototype.onLoadedMetaData,vjs.Player.prototype.onLoadedData,vjs.Player.prototype.onLoadedAllData,vjs.Player.prototype.onPlay=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0)},vjs.Player.prototype.onWaiting=function(){this.addClass("vjs-waiting")},vjs.Player.prototype.onWaitEnd=function(){this.removeClass("vjs-waiting")},vjs.Player.prototype.onSeeking=function(){this.addClass("vjs-seeking")},vjs.Player.prototype.onSeeked=function(){this.removeClass("vjs-seeking")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused")},vjs.Player.prototype.onTimeUpdate,vjs.Player.prototype.onProgress=function(){1==this.bufferedPercent()&&this.trigger("loadedalldata")},vjs.Player.prototype.onEnded=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause()},vjs.Player.prototype.onDurationChange=function(){var e=this.techGet("duration");e&&(this.duration(e=e<0?1/0:e),e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"))},vjs.Player.prototype.onVolumeChange,vjs.Player.prototype.onFullscreenChange=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.onError,vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(e,t){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[e](t)});else try{this.tech[e](t)}catch(e){throw vjs.log(e),e}},vjs.Player.prototype.techGet=function(t){if(this.tech&&this.tech.isReady_)try{return this.tech[t]()}catch(e){throw void 0===this.tech[t]?vjs.log("Video.js: "+t+" method not defined for "+this.techName+" playback technology.",e):"TypeError"==e.name?(vjs.log("Video.js: "+t+" unavailable on "+this.techName+" playback technology element.",e),this.tech.isReady_=!1):vjs.log(e),e}},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return!1!==this.techGet("paused")},vjs.Player.prototype.currentTime=function(e){return void 0!==e?(this.techCall("setCurrentTime",e),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(e){return void 0!==e?(this.cache_.duration=parseFloat(e),this):(void 0===this.cache_.duration&&this.onDurationChange(),this.cache_.duration||0)},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var e=this.techGet("buffered");return e=e&&e.length?e:vjs.createTimeRange(0,0)},vjs.Player.prototype.bufferedPercent=function(){var e,t,n=this.duration(),r=this.buffered(),i=0;if(!n)return 0;for(var o=0;o<r.length;o++)e=r.start(o),i+=(t=n<(t=r.end(o))?n:t)-e;return i/n},vjs.Player.prototype.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),e=e.end(e.length-1);return e=t<e?t:e},vjs.Player.prototype.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall("setVolume",t),vjs.setLocalStorage("volume",t),this):(t=parseFloat(this.techGet("volume")),isNaN(t)?1:t)},vjs.Player.prototype.muted=function(e){return void 0!==e?(this.techCall("setMuted",e),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.isFullscreen_=!1,vjs.Player.prototype.isFullscreen=function(e){return void 0!==e?(this.isFullscreen_=!!e,this):this.isFullscreen_},vjs.Player.prototype.isFullScreen=function(e){return vjs.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")'),this.isFullscreen(e)},vjs.Player.prototype.requestFullscreen=function(){var t=vjs.browser.fullscreenAPI;return this.isFullscreen(!0),t?(vjs.on(document,t.fullscreenchange,vjs.bind(this,function(e){this.isFullscreen(document[t.fullscreenElement]),!1===this.isFullscreen()&&vjs.off(document,t.fullscreenchange,arguments.callee),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.requestFullScreen=function(){return vjs.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")'),this.requestFullscreen()},vjs.Player.prototype.exitFullscreen=function(){var e=vjs.browser.fullscreenAPI;return this.isFullscreen(!1),e?document[e.exitFullscreen]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){return vjs.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()"),this.exitFullscreen()},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey)),document.documentElement.style.overflow="hidden",vjs.addClass(document.body,"vjs-full-window"),this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(e){27===e.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1,vjs.off(document,"keydown",this.fullWindowOnEscKey),document.documentElement.style.overflow=this.docOrigOverflow,vjs.removeClass(document.body,"vjs-full-window"),this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(e){for(var t=0,n=this.options_.techOrder;t<n.length;t++){var r=vjs.capitalize(n[t]),i=window.videojs[r];if(i){if(i.isSupported())for(var o=0,a=e;o<a.length;o++){var s=a[o];if(i.canPlaySource(s))return{source:s,tech:r}}}else vjs.log.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return!1},vjs.Player.prototype.src=function(e){return void 0===e?this.techGet("src"):(vjs.obj.isArray(e)?this.sourceList_(e):"string"==typeof e?this.src({src:e}):e instanceof Object&&(e.type&&!window.videojs[this.techName].canPlaySource(e)?this.sourceList_([e]):(this.cache_.src=e.src,this.currentType_=e.type||"",this.ready(function(){window.videojs[this.techName].prototype.hasOwnProperty("setSource")?this.techCall("setSource",e):this.techCall("src",e.src),"auto"==this.options_.preload&&this.load(),this.options_.autoplay&&this.play()}))),this)},vjs.Player.prototype.sourceList_=function(e){e=this.selectSource(e);e?e.tech===this.techName?this.src(e.source):this.loadTech(e.tech,e.source):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options().notSupportedMessage)})},0),this.triggerReady())},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.currentType=function(){return this.currentType_||""},vjs.Player.prototype.preload=function(e){return void 0!==e?(this.techCall("setPreload",e),this.options_.preload=e,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(e){return void 0!==e?(this.techCall("setAutoplay",e),this.options_.autoplay=e,this):this.techGet("autoplay",e)},vjs.Player.prototype.loop=function(e){return void 0!==e?(this.techCall("setLoop",e),this.options_.loop=e,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(e){return void 0===e?this.poster_:(this.poster_=e=e||"",this.techCall("setPoster",e),this.trigger("posterchange"),this)},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(e){return void 0!==e?(this.controls_!==(e=!!e)&&((this.controls_=e)?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(e){return void 0!==e?(this.usingNativeControls_!==(e=!!e)&&((this.usingNativeControls_=e)?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error_=null,vjs.Player.prototype.error=function(e){return void 0===e?this.error_:(null===e?(this.error_=e,this.removeClass("vjs-error")):(e instanceof vjs.MediaError?this.error_=e:this.error_=new vjs.MediaError(e),this.trigger("error"),this.addClass("vjs-error"),vjs.log.error("(CODE:"+this.error_.code+" "+vjs.MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_)),this)},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.seekable=function(){return this.techGet("seekable")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(e){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(e){return void 0!==e?((e=!!e)!==this.userActive_&&((this.userActive_=e)?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech&&this.tech.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var t,n,r,i,o=vjs.bind(this,this.reportUserActivity),e=function(e){e.screenX==r&&e.screenY==i||(r=e.screenX,i=e.screenY,o())},a=function(e){o(),this.clearInterval(t)};this.on("mousedown",function(){o(),this.clearInterval(t),t=this.setInterval(o,250)}),this.on("mousemove",e),this.on("mouseup",a),this.on("keydown",o),this.on("keyup",o),this.setInterval(function(){var e;this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),this.clearTimeout(n),0<(e=this.options().inactivityTimeout)&&(n=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e)))},250)},vjs.Player.prototype.playbackRate=function(e){return void 0!==e?(this.techCall("setPlaybackRate",e),this):this.tech&&this.tech.featuresPlaybackRate?this.techGet("playbackRate"):1},vjs.Player.prototype.isAudio_=!1,vjs.Player.prototype.isAudio=function(e){return void 0!==e?(this.isAudio_=!!e,this):this.isAudio_},vjs.Player.prototype.networkState=function(){return this.techGet("networkState")},vjs.Player.prototype.readyState=function(){return this.techGet("readyState")},vjs.Player.prototype.textTracks=function(){return this.tech&&this.tech.textTracks()},vjs.Player.prototype.remoteTextTracks=function(){return this.tech&&this.tech.remoteTextTracks()},vjs.Player.prototype.addTextTrack=function(e,t,n){return this.tech&&this.tech.addTextTrack(e,t,n)},vjs.Player.prototype.addRemoteTextTrack=function(e){return this.tech&&this.tech.addRemoteTextTrack(e)},vjs.Player.prototype.removeRemoteTextTrack=function(e){this.tech&&this.tech.removeRemoteTextTrack(e)},vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.LiveDisplay=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.LiveDisplay.prototype.createEl=function(){var e=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-live-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE"),"aria-live":"off"}),e.appendChild(this.contentEl_),e},vjs.PlayToggle=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t),this.on(e,"play",this.onPlay),this.on(e,"pause",this.onPause)}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.el_.children[0].children[0].innerHTML=this.localize("Pause")},vjs.PlayToggle.prototype.onPause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.el_.children[0].children[0].innerHTML=this.localize("Play")},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.on(e,"timeupdate",this.updateContent)}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var e=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"}),e.appendChild(this.contentEl_),e},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var e=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Current Time")+"</span> "+vjs.formatTime(e,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.on(e,"timeupdate",this.updateContent),this.on(e,"loadedmetadata",this.updateContent)}}),vjs.DurationDisplay.prototype.createEl=function(){var e=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00","aria-live":"off"}),e.appendChild(this.contentEl_),e},vjs.DurationDisplay.prototype.updateContent=function(){var e=this.player_.duration();e&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> "+vjs.formatTime(e))},vjs.TimeDivider=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.on(e,"timeupdate",this.updateContent)}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var e=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00","aria-live":"off"}),e.appendChild(this.contentEl_),e},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -"+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText_.innerHTML=this.localize("Fullscreen")):(this.player_.requestFullscreen(),this.controlText_.innerHTML=this.localize("Non-Fullscreen"))},vjs.ProgressControl=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},vjs.SeekBar=vjs.Slider.extend({init:function(e,t){vjs.Slider.call(this,e,t),this.on(e,"timeupdate",this.updateARIAAttributes),e.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var e=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(100*this.getPercent(),2)),this.el_.setAttribute("aria-valuetext",vjs.formatTime(e,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){return this.player_.currentTime()/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(e){vjs.Slider.prototype.onMouseDown.call(this,e),this.player_.scrubbing=!0,this.player_.addClass("vjs-scrubbing"),this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},vjs.SeekBar.prototype.onMouseMove=function(e){e=this.calculateDistance(e)*this.player_.duration();e==this.player_.duration()&&(e-=.1),this.player_.currentTime(e)},vjs.SeekBar.prototype.onMouseUp=function(e){vjs.Slider.prototype.onMouseUp.call(this,e),this.player_.scrubbing=!1,this.player_.removeClass("vjs-scrubbing"),this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.on(e,"progress",this.update)}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},vjs.LoadProgressBar.prototype.update=function(){function e(e,t){return 100*(e/t||0)+"%"}var t,n,r,i,o=this.player_.buffered(),a=this.player_.duration(),s=this.player_.bufferedEnd(),c=this.el_.children;for(this.el_.style.width=e(s,a),t=0;t<o.length;t++)n=o.start(t),r=o.end(t),(i=(i=c[t])||this.el_.appendChild(vjs.createEl())).style.left=e(n,s),i.style.width=e(r-n,s);for(t=c.length;t>o.length;t--)this.el_.removeChild(c[t-1])},vjs.PlayProgressBar=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},vjs.SeekHandle=vjs.SliderHandle.extend({init:function(e,t){vjs.SliderHandle.call(this,e,t),this.on(e,"timeupdate",this.updateContent)}}),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})},vjs.SeekHandle.prototype.updateContent=function(){var e=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.innerHTML='<span class="vjs-control-text">'+vjs.formatTime(e,this.player_.duration())+"</span>"},vjs.VolumeControl=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),e.tech&&!1===e.tech.featuresVolumeControl&&this.addClass("vjs-hidden"),this.on(e,"loadstart",function(){!1===e.tech.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},vjs.VolumeBar=vjs.Slider.extend({init:function(e,t){vjs.Slider.call(this,e,t),this.on(e,"volumechange",this.updateARIAAttributes),e.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(100*this.player_.volume(),2)),this.el_.setAttribute("aria-valuetext",vjs.round(100*this.player_.volume(),2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(e){this.player_.muted()&&this.player_.muted(!1),this.player_.volume(this.calculateDistance(e))},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t),this.on(e,"volumechange",this.update),e.tech&&!1===e.tech.featuresVolumeControl&&this.addClass("vjs-hidden"),this.on(e,"loadstart",function(){!1===e.tech.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"</span></div>"})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(!this.player_.muted())},vjs.MuteToggle.prototype.update=function(){var e=this.player_.volume(),t=3;0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2),this.player_.muted()?this.el_.children[0].children[0].innerHTML!=this.localize("Unmute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Unmute")):this.el_.children[0].children[0].innerHTML!=this.localize("Mute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Mute"));for(var n=0;n<4;n++)vjs.removeClass(this.el_,"vjs-vol-"+n);vjs.addClass(this.el_,"vjs-vol-"+t)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(e,t){vjs.MenuButton.call(this,e,t),this.on(e,"volumechange",this.volumeUpdate),e.tech&&!1===e.tech.featuresVolumeControl&&this.addClass("vjs-hidden"),this.on(e,"loadstart",function(){!1===e.tech.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}),this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var e=new vjs.Menu(this.player_,{contentElType:"div"}),t=new vjs.VolumeBar(this.player_,this.options_.volumeBar);return t.on("focus",function(){e.lockShowing()}),t.on("blur",function(){e.unlockShowing()}),e.addChild(t),e},vjs.VolumeMenuButton.prototype.onClick=function(){vjs.MuteToggle.prototype.onClick.call(this),vjs.MenuButton.prototype.onClick.call(this)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"</span></div>"})},vjs.VolumeMenuButton.prototype.volumeUpdate=vjs.MuteToggle.prototype.update,vjs.PlaybackRateMenuButton=vjs.MenuButton.extend({init:function(e,t){vjs.MenuButton.call(this,e,t),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",this.updateVisibility),this.on(e,"ratechange",this.updateLabel)}}),vjs.PlaybackRateMenuButton.prototype.buttonText="Playback Rate",vjs.PlaybackRateMenuButton.prototype.className="vjs-playback-rate",vjs.PlaybackRateMenuButton.prototype.createEl=function(){var e=vjs.MenuButton.prototype.createEl.call(this);return this.labelEl_=vjs.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),e.appendChild(this.labelEl_),e},vjs.PlaybackRateMenuButton.prototype.createMenu=function(){var e=new vjs.Menu(this.player()),t=this.player().options().playbackRates;if(t)for(var n=t.length-1;0<=n;n--)e.addChild(new vjs.PlaybackRateMenuItem(this.player(),{rate:t[n]+"x"}));return e},vjs.PlaybackRateMenuButton.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},vjs.PlaybackRateMenuButton.prototype.onClick=function(){for(var e=this.player().playbackRate(),t=this.player().options().playbackRates,n=t[0],r=0;r<t.length;r++)if(t[r]>e){n=t[r];break}this.player().playbackRate(n)},vjs.PlaybackRateMenuButton.prototype.playbackRateSupported=function(){return this.player().tech&&this.player().tech.featuresPlaybackRate&&this.player().options().playbackRates&&0<this.player().options().playbackRates.length},vjs.PlaybackRateMenuButton.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},vjs.PlaybackRateMenuButton.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},vjs.PlaybackRateMenuItem=vjs.MenuItem.extend({contentElType:"button",init:function(e,t){var n=this.label=t.rate,r=this.rate=parseFloat(n,10);t.label=n,t.selected=1===r,vjs.MenuItem.call(this,e,t),this.on(e,"ratechange",this.update)}}),vjs.PlaybackRateMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player().playbackRate(this.rate)},vjs.PlaybackRateMenuItem.prototype.update=function(){this.selected(this.player().playbackRate()==this.rate)},vjs.PosterImage=vjs.Button.extend({init:function(e,t){vjs.Button.call(this,e,t),this.update(),e.on("posterchange",vjs.bind(this,this.update))}}),vjs.PosterImage.prototype.dispose=function(){this.player().off("posterchange",this.update),vjs.Button.prototype.dispose.call(this)},vjs.PosterImage.prototype.createEl=function(){var e=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1});return vjs.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=vjs.createEl("img"),e.appendChild(this.fallbackImg_)),e},vjs.PosterImage.prototype.update=function(){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},vjs.PosterImage.prototype.setSrc=function(e){var t;this.fallbackImg_?this.fallbackImg_.src=e:(t="",this.el_.style.backgroundImage=t=e?'url("'+e+'")':t)},vjs.PosterImage.prototype.onClick=function(){this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t)}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"></span>',"aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.ErrorDisplay=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.update(),this.on(e,"error",this.update)}}),vjs.ErrorDisplay.prototype.createEl=function(){var e=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-error-display"});return this.contentEl_=vjs.createEl("div"),e.appendChild(this.contentEl_),e},vjs.ErrorDisplay.prototype.update=function(){this.player().error()&&(this.contentEl_.innerHTML=this.localize(this.player().error().message))},vjs.MediaTechController=vjs.Component.extend({init:function(e,t,n){(t=t||{}).reportTouchActivity=!1,vjs.Component.call(this,e,t,n),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),this.initControlsListeners(),this.featuresNativeTextTracks||this.emulateTextTracks(),this.initTextTrackListeners()}}),vjs.MediaTechController.prototype.initControlsListeners=function(){var e=this.player(),t=function(){e.controls()&&!e.usingNativeControls()&&this.addControlsListeners()};this.ready(t),this.on(e,"controlsenabled",t),this.on(e,"controlsdisabled",this.removeControlsListeners),this.ready(function(){this.networkState&&0<this.networkState()&&this.player().trigger("loadstart")})},vjs.MediaTechController.prototype.addControlsListeners=function(){var t;this.on("mousedown",this.onClick),this.on("touchstart",function(e){t=this.player_.userActive()}),this.on("touchmove",function(e){t&&this.player().reportUserActivity()}),this.on("touchend",function(e){e.preventDefault()}),this.emitTapEvents(),this.on("tap",this.onTap)},vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap"),this.off("touchstart"),this.off("touchmove"),this.off("touchleave"),this.off("touchcancel"),this.off("touchend"),this.off("click"),this.off("mousedown")},vjs.MediaTechController.prototype.onClick=function(e){0===e.button&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())},vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())},vjs.MediaTechController.prototype.manualProgressOn=function(){this.manualProgress=!0,this.trackProgress()},vjs.MediaTechController.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress()},vjs.MediaTechController.prototype.trackProgress=function(){this.progressInterval=this.setInterval(function(){var e=this.player().bufferedPercent();this.bufferedPercent_!=e&&this.player().trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()},500)},vjs.MediaTechController.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},vjs.MediaTechController.prototype.manualTimeUpdatesOn=function(){var e=this.player_;this.manualTimeUpdates=!0,this.on(e,"play",this.trackCurrentTime),this.on(e,"pause",this.stopTrackingCurrentTime),this.one("timeupdate",function(){this.featuresTimeupdateEvents=!0,this.manualTimeUpdatesOff()})},vjs.MediaTechController.prototype.manualTimeUpdatesOff=function(){var e=this.player_;this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off(e,"play",this.trackCurrentTime),this.off(e,"pause",this.stopTrackingCurrentTime)},vjs.MediaTechController.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.player().trigger("timeupdate")},250)},vjs.MediaTechController.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.dispose=function(){this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),vjs.Component.prototype.dispose.call(this)},vjs.MediaTechController.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.initTextTrackListeners=function(){function e(){var e=t.getChild("textTrackDisplay");e&&e.updateDisplay()}var t=this.player_,n=this.textTracks();n&&(n.addEventListener("removetrack",e),n.addEventListener("addtrack",e),this.on("dispose",vjs.bind(this,function(){n.removeEventListener("removetrack",e),n.removeEventListener("addtrack",e)})))},vjs.MediaTechController.prototype.emulateTextTracks=function(){var e,t,n,r=this.player_;window.WebVTT||((n=document.createElement("script")).src=r.options()["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js",r.el().appendChild(n),window.WebVTT=!0),(t=this.textTracks())&&(t.addEventListener("change",e=function(){var e,t,n=r.getChild("textTrackDisplay");for(n.updateDisplay(),e=0;e<this.length;e++)(t=this[e]).removeEventListener("cuechange",vjs.bind(n,n.updateDisplay)),"showing"===t.mode&&t.addEventListener("cuechange",vjs.bind(n,n.updateDisplay))}),this.on("dispose",vjs.bind(this,function(){t.removeEventListener("change",e)})))},vjs.MediaTechController.prototype.textTracks_,vjs.MediaTechController.prototype.textTracks=function(){return this.player_.textTracks_=this.player_.textTracks_||new vjs.TextTrackList,this.player_.textTracks_},vjs.MediaTechController.prototype.remoteTextTracks=function(){return this.player_.remoteTextTracks_=this.player_.remoteTextTracks_||new vjs.TextTrackList,this.player_.remoteTextTracks_},E40=function(e,t,n,r,i){var o=e.textTracks();return(i=i||{}).kind=t,n&&(i.label=n),r&&(i.language=r),i.player=e.player_,t=new vjs.TextTrack(i),o.addTrack_(t),t},vjs.MediaTechController.prototype.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return E40(this,e,t,n)},vjs.MediaTechController.prototype.addRemoteTextTrack=function(e){e=E40(this,e.kind,e.label,e.language,e);return this.remoteTextTracks().addTrack_(e),{track:e}},vjs.MediaTechController.prototype.removeRemoteTextTrack=function(e){this.textTracks().removeTrack_(e),this.remoteTextTracks().removeTrack_(e)},vjs.MediaTechController.prototype.setPoster=function(){},vjs.MediaTechController.prototype.featuresVolumeControl=!0,vjs.MediaTechController.prototype.featuresFullscreenResize=!1,vjs.MediaTechController.prototype.featuresPlaybackRate=!1,vjs.MediaTechController.prototype.featuresProgressEvents=!1,vjs.MediaTechController.prototype.featuresTimeupdateEvents=!1,vjs.MediaTechController.prototype.featuresNativeTextTracks=!1,vjs.MediaTechController.withSourceHandlers=function(r){r.registerSourceHandler=function(e,t){var n=(n=r.sourceHandlers)||(r.sourceHandlers=[]);void 0===t&&(t=n.length),n.splice(t,0,e)},r.selectSourceHandler=function(e){for(var t=r.sourceHandlers||[],n=0;n<t.length;n++)if(t[n].canHandleSource(e))return t[n];return null},r.canPlaySource=function(e){var t=r.selectSourceHandler(e);return t?t.canHandleSource(e):""},r.prototype.setSource=function(e){var t=r.selectSourceHandler(e);return t||(r.nativeSourceHandler?t=r.nativeSourceHandler:vjs.log.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),this.currentSource_=e,this.sourceHandler_=t.handleSource(e,this),this.on("dispose",this.disposeSourceHandler),this},r.prototype.disposeSourceHandler=function(){this.sourceHandler_&&this.sourceHandler_.dispose&&this.sourceHandler_.dispose()}},vjs.media={},vjs.Html5=vjs.MediaTechController.extend({init:function(e,t,n){!1!==t.nativeCaptions&&!1!==t.nativeTextTracks||(this.featuresNativeTextTracks=!1),vjs.MediaTechController.call(this,e,t,n),this.setupTriggers();var r,i,o,a,s,n=t.source;if(n&&(this.el_.currentSrc!==n.src||e.tag&&3===e.tag.initNetworkState_)&&this.setSource(n),this.el_.hasChildNodes()){for(i=(r=this.el_.childNodes).length,s=[];i--;)"track"===(a=r[i]).nodeName.toLowerCase()&&(this.featuresNativeTextTracks?this.remoteTextTracks().addTrack_(a.track):s.push(a));for(o=0;o<s.length;o++)this.el_.removeChild(s[o])}vjs.TOUCH_ENABLED&&!0===e.options().nativeControlsForTouch&&this.useNativeControls(),e.ready(function(){this.src()&&this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())}),this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.Html5.disposeMediaElement(this.el_),vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var e,t,n,r=this.player_,i=r.tag;if(!i||!1===this.movingMediaElementInDOM){if(i?(n=i.cloneNode(!1),vjs.Html5.disposeMediaElement(i),i=n,r.tag=null):(i=vjs.createEl("video"),n=videojs.util.mergeOptions({},r.tagAttributes),vjs.TOUCH_ENABLED&&!0===r.options().nativeControlsForTouch||delete n.controls,vjs.setElementAttributes(i,vjs.obj.merge(n,{id:r.id()+"_html5_api",class:"vjs-tech"}))),(i.player=r).options_.tracks)for(a=0;a<r.options_.tracks.length;a++)e=r.options_.tracks[a],(t=document.createElement("track")).kind=e.kind,t.label=e.label,t.srclang=e.srclang,t.src=e.src,"default"in e&&t.setAttribute("default","default"),i.appendChild(t);vjs.insertFirst(i,r.el())}for(var o=["autoplay","preload","loop","muted"],a=o.length-1;0<=a;a--){var s=o[a],c={};void 0!==r.options_[s]&&(c[s]=r.options_[s]),vjs.setElementAttributes(i,c)}return i},vjs.Html5.prototype.setupTriggers=function(){for(var e=vjs.Html5.Events.length-1;0<=e;e--)this.on(vjs.Html5.Events[e],this.eventHandler)},vjs.Html5.prototype.eventHandler=function(e){"error"==e.type&&this.error()?this.player().error(this.error().code):(e.bubbles=!1,this.player().trigger(e))},vjs.Html5.prototype.useNativeControls=function(){var e,t,n,r=this,i=this.player();r.setControls(i.controls()),e=function(){r.setControls(!0)},t=function(){r.setControls(!1)},i.on("controlsenabled",e),i.on("controlsdisabled",t),r.on("dispose",n=function(){i.off("controlsenabled",e),i.off("controlsdisabled",t)}),i.on("usingcustomcontrols",n),i.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){vjs.log(e,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(e){this.el_.volume=e},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(e){this.el_.muted=e},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.supportsFullScreen=function(){return!("function"!=typeof this.el_.webkitEnterFullScreen||!/Android/.test(vjs.USER_AGENT)&&/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT))},vjs.Html5.prototype.enterFullScreen=function(){var e=this.el_;"webkitDisplayingFullscreen"in e&&this.one("webkitbeginfullscreen",function(){this.player_.isFullscreen(!0),this.one("webkitendfullscreen",function(){this.player_.isFullscreen(!1),this.player_.trigger("fullscreenchange")}),this.player_.trigger("fullscreenchange")}),e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.returnOriginalIfBlobURI_=function(e,t){return t&&e&&/^blob\:/i.test(e)?t:e},vjs.Html5.prototype.src=function(e){var t=this.el_.src;if(void 0===e)return this.returnOriginalIfBlobURI_(t,this.source_);this.setSrc(e)},vjs.Html5.prototype.setSrc=function(e){this.el_.src=e},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){var e=this.el_.currentSrc;return this.currentSource_?this.returnOriginalIfBlobURI_(e,this.currentSource_.src):e},vjs.Html5.prototype.poster=function(){return this.el_.poster},vjs.Html5.prototype.setPoster=function(e){this.el_.poster=e},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(e){this.el_.preload=e},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(e){this.el_.autoplay=e},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(e){this.el_.controls=!!e},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(e){this.el_.loop=e},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.seekable=function(){return this.el_.seekable},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.prototype.playbackRate=function(){return this.el_.playbackRate},vjs.Html5.prototype.setPlaybackRate=function(e){this.el_.playbackRate=e},vjs.Html5.prototype.networkState=function(){return this.el_.networkState},vjs.Html5.prototype.readyState=function(){return this.el_.readyState},vjs.Html5.prototype.textTracks=function(){return this.featuresNativeTextTracks?this.el_.textTracks:vjs.MediaTechController.prototype.textTracks.call(this)},vjs.Html5.prototype.addTextTrack=function(e,t,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,n):vjs.MediaTechController.prototype.addTextTrack.call(this,e,t,n)},vjs.Html5.prototype.addRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.addRemoteTextTrack.call(this,e);var t=document.createElement("track");return(e=e||{}).kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),this.el().appendChild(t),this.remoteTextTracks().addTrack_(t.track),t},vjs.Html5.prototype.removeRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.removeRemoteTextTrack.call(this,e);var t,n;for(this.remoteTextTracks().removeTrack_(e),t=this.el().querySelectorAll("track"),n=0;n<t.length;n++)if(t[n]===e||t[n].track===e){t[n].parentNode.removeChild(t[n]);break}},vjs.Html5.isSupported=function(){try{vjs.TEST_VID.volume=.5}catch(e){return!1}return!!vjs.TEST_VID.canPlayType},vjs.MediaTechController.withSourceHandlers(vjs.Html5),C50=vjs.Html5.prototype.setSource,D50=vjs.Html5.prototype.disposeSourceHandler,vjs.Html5.prototype.setSource=function(e){var t=C50.call(this,e);return this.source_=e.src,t},vjs.Html5.prototype.disposeSourceHandler=function(){return this.source_=void 0,D50.call(this)},vjs.Html5.nativeSourceHandler={},vjs.Html5.nativeSourceHandler.canHandleSource=function(e){function t(e){try{return vjs.TEST_VID.canPlayType(e)}catch(e){return""}}return e.type?t(e.type):e.src?t("video/"+((e=e.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i))&&e[1])):""},vjs.Html5.nativeSourceHandler.handleSource=function(e,t){t.setSrc(e.src)},vjs.Html5.nativeSourceHandler.dispose=function(){},vjs.Html5.registerSourceHandler(vjs.Html5.nativeSourceHandler),vjs.Html5.canControlVolume=function(){var e=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=e/2+.1,e!==vjs.TEST_VID.volume},vjs.Html5.canControlPlaybackRate=function(){var e=vjs.TEST_VID.playbackRate;return vjs.TEST_VID.playbackRate=e/2+.1,e!==vjs.TEST_VID.playbackRate},vjs.Html5.supportsNativeTextTracks=function(){var e=!!vjs.TEST_VID.textTracks;return e=(e=e&&0<vjs.TEST_VID.textTracks.length?"number"!=typeof vjs.TEST_VID.textTracks[0].mode:e)&&vjs.IS_FIREFOX?!1:e},vjs.Html5.prototype.featuresVolumeControl=vjs.Html5.canControlVolume(),vjs.Html5.prototype.featuresPlaybackRate=vjs.Html5.canControlPlaybackRate(),vjs.Html5.prototype.movingMediaElementInDOM=!vjs.IS_IOS,vjs.Html5.prototype.featuresFullscreenResize=!0,vjs.Html5.prototype.featuresProgressEvents=!0,vjs.Html5.prototype.featuresNativeTextTracks=vjs.Html5.supportsNativeTextTracks(),S50=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,T50=/^video\/mp4/i,vjs.Html5.patchCanPlayType=function(){4<=vjs.ANDROID_VERSION&&(R50=R50||vjs.TEST_VID.constructor.prototype.canPlayType,vjs.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&S50.test(e)?"maybe":R50.call(this,e)}),vjs.IS_OLD_ANDROID&&(R50=R50||vjs.TEST_VID.constructor.prototype.canPlayType,vjs.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&T50.test(e)?"maybe":R50.call(this,e)})},vjs.Html5.unpatchCanPlayType=function(){var e=vjs.TEST_VID.constructor.prototype.canPlayType;return vjs.TEST_VID.constructor.prototype.canPlayType=R50,R50=null,e},vjs.Html5.patchCanPlayType(),vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.Html5.disposeMediaElement=function(e){if(e){for(e.player=null,e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);if(e.removeAttribute("src"),"function"==typeof e.load)try{e.load()}catch(e){}}},vjs.Flash=vjs.MediaTechController.extend({init:function(e,t,n){vjs.MediaTechController.call(this,e,t,n);var r=t.source,n=e.id()+"_flash_api",i=e.options_,i=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:i.autoplay,preload:i.preload,loop:i.loop,muted:i.muted},t.flashVars),o=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},t.params),n=vjs.obj.merge({id:n,name:n,class:"vjs-tech"},t.attributes);r&&this.ready(function(){this.setSource(r)}),vjs.insertFirst(this.el_,t.parentEl),t.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(t.startTime)}),vjs.IS_FIREFOX&&this.ready(function(){this.on("mousemove",function(){this.player().trigger({type:"mousemove",bubbles:!1})})}),e.on("stageclick",e.reportUserActivity),this.el_=vjs.Flash.embed(t.swf,this.el_,i,o,n)}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(e){return void 0===e?this.currentSrc():this.setSrc(e)},vjs.Flash.prototype.setSrc=function(e){var t;e=vjs.getAbsoluteURL(e),this.el_.vjs_src(e),this.player_.autoplay()&&(t=this).setTimeout(function(){t.play()},0)},vjs.Flash.prototype.setCurrentTime=function(e){this.lastSeekTarget_=e,this.el_.vjs_setProperty("currentTime",e),vjs.MediaTechController.prototype.setCurrentTime.call(this)},vjs.Flash.prototype.currentTime=function(e){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},vjs.Flash.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.setPoster=function(){},vjs.Flash.prototype.seekable=function(){return 0===this.duration()?vjs.createTimeRange():vjs.createTimeRange(0,this.duration())},vjs.Flash.prototype.buffered=function(){return this.el_.vjs_getProperty?vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered")):vjs.createTimeRange()},vjs.Flash.prototype.duration=function(){return this.el_.vjs_getProperty?this.el_.vjs_getProperty("duration"):0},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1};var pg0,mg0=vjs.Flash.prototype,ng0="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),og0="error,networkState,readyState,seeking,initialTime,startOffsetTime,paused,played,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(","),xh0;function rg0(e){mg0[e]=function(){return this.el_.vjs_getProperty(e)}}for(pg0=0;pg0<ng0.length;pg0++)rg0(ng0[pg0]),function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);mg0["set"+e]=function(e){return this.el_.vjs_setProperty(t,e)}}(ng0[pg0]);for(pg0=0;pg0<og0.length;pg0++)rg0(og0[pg0]);for(xh0 in vjs.Flash.isSupported=function(){return 10<=vjs.Flash.version()[0]},vjs.MediaTechController.withSourceHandlers(vjs.Flash),vjs.Flash.nativeSourceHandler={},vjs.Flash.nativeSourceHandler.canHandleSource=function(e){return e.type&&e.type.replace(/;.*/,"").toLowerCase()in vjs.Flash.formats?"maybe":""},vjs.Flash.nativeSourceHandler.handleSource=function(e,t){t.setSrc(e.src)},vjs.Flash.nativeSourceHandler.dispose=function(){},vjs.Flash.registerSourceHandler(vjs.Flash.nativeSourceHandler),vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.onReady=function(e){var e=vjs.el(e),t=e&&e.parentNode&&e.parentNode.player;t&&(e.player=t,vjs.Flash.checkReady(t.tech))},vjs.Flash.checkReady=function(e){e.el()&&(e.el().vjs_getProperty?e.triggerReady():this.setTimeout(function(){vjs.Flash.checkReady(e)},50))},vjs.Flash.onEvent=function(e,t){vjs.el(e).player.trigger(t)},vjs.Flash.onError=function(e,t){var e=vjs.el(e).player,n="FLASH: "+t;"srcnotfound"==t?e.error({code:4,message:n}):e.error(n)},vjs.Flash.version=function(){var t="0,0,0";try{t=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(t=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(e){}}return t.split(",")},vjs.Flash.embed=function(e,t,n,r,i){var e=vjs.Flash.getEmbedCode(e,n,r,i),n=vjs.createEl("div",{innerHTML:e}).childNodes[0],r=t.parentNode,o=(t.parentNode.replaceChild(n,t),n[vjs.expando]=t[vjs.expando],r.childNodes[0]);return setTimeout(function(){o.style.display="block"},1e3),n},vjs.Flash.getEmbedCode=function(e,t,n,r){var i="",o="",a="";return t&&vjs.obj.each(t,function(e,t){i+=e+"="+t+"&amp;"}),n=vjs.obj.merge({movie:e,flashvars:i,allowScriptAccess:"always",allowNetworking:"all"},n),vjs.obj.each(n,function(e,t){o+='<param name="'+e+'" value="'+t+'" />'}),r=vjs.obj.merge({data:e,width:"100%",height:"100%"},r),vjs.obj.each(r,function(e,t){a+=e+'="'+t+'" '}),'<object type="application/x-shockwave-flash" '+a+">"+o+"</object>"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.streamFromParts=function(e,t){return e+"&"+t},vjs.Flash.streamToParts=function(e){var t={connection:"",stream:""};if(!e)return t;var n,r=e.indexOf("&");return-1!==r?n=r+1:0===(r=n=e.lastIndexOf("/")+1)&&(r=n=e.length),t.connection=e.substring(0,r),t.stream=e.substring(n,e.length),t},vjs.Flash.isStreamingType=function(e){return e in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(e){return vjs.Flash.RTMP_RE.test(e)},vjs.Flash.rtmpSourceHandler={},vjs.Flash.rtmpSourceHandler.canHandleSource=function(e){return vjs.Flash.isStreamingType(e.type)||vjs.Flash.isStreamingSrc(e.src)?"maybe":""},vjs.Flash.rtmpSourceHandler.handleSource=function(e,t){e=vjs.Flash.streamToParts(e.src);t.setRtmpConnection(e.connection),t.setRtmpStream(e.stream)},vjs.Flash.registerSourceHandler(vjs.Flash.rtmpSourceHandler),vjs.MediaLoader=vjs.Component.extend({init:function(e,t,n){if(vjs.Component.call(this,e,t,n),e.options_.sources&&0!==e.options_.sources.length)e.src(e.options_.sources);else for(var r=0,i=e.options_.techOrder;r<i.length;r++){var o=vjs.capitalize(i[r]),a=window.videojs[o];if(a&&a.isSupported()){e.loadTech(o);break}}}}),vjs.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"},vjs.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},vjs.TextTrack=function(e){var t,n,r,i,o,l,d,a,s,c,u;if(!(e=e||{}).player)throw new Error("A player was not provided.");if(t=this,vjs.IS_IE8)for(u in t=document.createElement("custom"),vjs.TextTrack.prototype)t[u]=vjs.TextTrack.prototype[u];if(t.player_=e.player,r=vjs.TextTrackMode[e.mode]||"disabled",i=vjs.TextTrackKind[e.kind]||"subtitles",o=e.label||"",l=e.language||e.srclang||"",n=e.id||"vjs_text_track_"+vjs.guid++,"metadata"!==i&&"chapters"!==i||(r="hidden"),t.cues_=[],t.activeCues_=[],d=new vjs.TextTrackCueList(t.cues_),a=new vjs.TextTrackCueList(t.activeCues_),c=!1,s=vjs.bind(t,function(){this.activeCues,c&&(this.trigger("cuechange"),c=!1)}),"disabled"!==r&&t.player_.on("timeupdate",s),Object.defineProperty(t,"kind",{get:function(){return i},set:Function.prototype}),Object.defineProperty(t,"label",{get:function(){return o},set:Function.prototype}),Object.defineProperty(t,"language",{get:function(){return l},set:Function.prototype}),Object.defineProperty(t,"id",{get:function(){return n},set:Function.prototype}),Object.defineProperty(t,"mode",{get:function(){return r},set:function(e){vjs.TextTrackMode[e]&&("showing"===(r=e)&&this.player_.on("timeupdate",s),this.trigger("modechange"))}}),Object.defineProperty(t,"cues",{get:function(){return this.loaded_?d:null},set:Function.prototype}),Object.defineProperty(t,"activeCues",{get:function(){var e,t,n,r,i;if(!this.loaded_)return null;if(0===this.cues.length)return a;for(r=this.player_.currentTime(),e=0,t=this.cues.length,n=[];e<t;e++)((i=this.cues[e]).startTime<=r&&i.endTime>=r||i.startTime===i.endTime&&i.startTime<=r&&i.startTime+.5>=r)&&n.push(i);if(c=!1,n.length!==this.activeCues_.length)c=!0;else for(e=0;e<n.length;e++)-1===E60.call(this.activeCues_,n[e])&&(c=!0);return this.activeCues_=n,a.setCues_(this.activeCues_),a},set:Function.prototype}),e.src?C60(e.src,t):t.loaded_=!0,vjs.IS_IE8)return t},vjs.TextTrack.prototype=vjs.obj.create(vjs.EventEmitter.prototype),vjs.TextTrack.prototype.constructor=vjs.TextTrack,vjs.TextTrack.prototype.allowedEvents_={cuechange:"cuechange"},vjs.TextTrack.prototype.addCue=function(e){var t=this.player_.textTracks(),n=0;if(t)for(;n<t.length;n++)t[n]!==this&&t[n].removeCue(e);this.cues_.push(e),this.cues.setCues_(this.cues_)},vjs.TextTrack.prototype.removeCue=function(e){for(var t=0,n=this.cues_.length,r=!1;t<n;t++)this.cues_[t]===e&&(this.cues_.splice(t,1),r=!0);r&&this.cues.setCues_(this.cues_)},C60=function(e,r){vjs.xhr(e,vjs.bind(this,function(e,t,n){if(e)return vjs.log.error(e);r.loaded_=!0,D60(n,r)}))},D60=function(e,t){if("function"!=typeof window.WebVTT)return window.setTimeout(function(){D60(e,t)},25);var n=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){vjs.log.error(e)},n.parse(e),n.flush()},E60=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0==i)return-1;t=+t||0;if(i<=(t=Math.abs(t)===1/0?0:t))return-1;for(n=Math.max(0<=t?t:i-Math.abs(t),0);n<i;){if(n in r&&r[n]===e)return n;n++}return-1},vjs.TextTrackList=function(e){var t,n=this,r=0;if(vjs.IS_IE8)for(t in n=document.createElement("custom"),vjs.TextTrackList.prototype)n[t]=vjs.TextTrackList.prototype[t];for(e=e||[],n.tracks_=[],Object.defineProperty(n,"length",{get:function(){return this.tracks_.length}});r<e.length;r++)n.addTrack_(e[r]);if(vjs.IS_IE8)return n},vjs.TextTrackList.prototype=vjs.obj.create(vjs.EventEmitter.prototype),vjs.TextTrackList.prototype.constructor=vjs.TextTrackList,vjs.TextTrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},vjs.TextTrackList.prototype.allowedEvents_)vjs.TextTrackList.prototype["on"+xh0]=null;function I80(e){return"string"==typeof e&&(!!G80[e.toLowerCase()]&&e.toLowerCase())}function J80(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)e[n]=r[n]}return e}function K80(l,d,f){var e=this,t=/MSIE\s8\.0/.test(navigator.userAgent),n={},r=(t?e=document.createElement("custom"):n.enumerable=!0,e.hasBeenReset=!1,""),i=!1,o=l,a=d,s=f,c=null,u="",p=!0,h="auto",m="start",g=50,v="middle",y=50,b="middle";if(Object.defineProperty(e,"id",J80({},n,{get:function(){return r},set:function(e){r=""+e}})),Object.defineProperty(e,"pauseOnExit",J80({},n,{get:function(){return i},set:function(e){i=!!e}})),Object.defineProperty(e,"startTime",J80({},n,{get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");o=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"endTime",J80({},n,{get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");a=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"text",J80({},n,{get:function(){return s},set:function(e){s=""+e,this.hasBeenReset=!0}})),Object.defineProperty(e,"region",J80({},n,{get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"vertical",J80({},n,{get:function(){return u},set:function(e){e="string"==typeof(e=e)&&(!!F80[e.toLowerCase()]&&e.toLowerCase());if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"snapToLines",J80({},n,{get:function(){return p},set:function(e){p=!!e,this.hasBeenReset=!0}})),Object.defineProperty(e,"line",J80({},n,{get:function(){return h},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"lineAlign",J80({},n,{get:function(){return m},set:function(e){e=I80(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"position",J80({},n,{get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"positionAlign",J80({},n,{get:function(){return v},set:function(e){e=I80(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"size",J80({},n,{get:function(){return y},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(e,"align",J80({},n,{get:function(){return b},set:function(e){e=I80(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),e.displayState=void 0,t)return e}function Hj0(e){return"number"==typeof e&&0<=e&&e<=100}function Ij0(){var t=100,n=3,r=0,i=100,o=0,a=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!Hj0(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return n},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");n=e}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!Hj0(e))throw new Error("RegionAnchorX must be between 0 and 100.");i=e}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!Hj0(e))throw new Error("RegionAnchorY must be between 0 and 100.");r=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!Hj0(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!Hj0(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){e="string"==typeof(e=e)&&(!!Fj0[e.toLowerCase()]&&e.toLowerCase());if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");s=e}}})}vjs.TextTrackList.prototype.addTrack_=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),e.addEventListener("modechange",vjs.bind(this,function(){this.trigger("change")})),this.tracks_.push(e),this.trigger({type:"addtrack",track:e})},vjs.TextTrackList.prototype.removeTrack_=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e){this.tracks_.splice(t,1);break}this.trigger({type:"removetrack",track:e})},vjs.TextTrackList.prototype.getTrackById=function(e){for(var t,n=0,r=this.length,i=null;n<r;n++)if((t=this[n]).id===e){i=t;break}return i},vjs.TextTrackCueList=function(e){var t,n=this;if(vjs.IS_IE8)for(t in n=document.createElement("custom"),vjs.TextTrackCueList.prototype)n[t]=vjs.TextTrackCueList.prototype[t];if(vjs.TextTrackCueList.prototype.setCues_.call(n,e),Object.defineProperty(n,"length",{get:function(){return this.length_}}),vjs.IS_IE8)return n},vjs.TextTrackCueList.prototype.setCues_=function(e){var t,n=this.length||0,r=0,i=e.length;if(this.cues_=e,this.length_=e.length,t=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})},n<i)for(r=n;r<i;r++)t.call(this,r)},vjs.TextTrackCueList.prototype.getCueById=function(e){for(var t,n=0,r=this.length,i=null;n<r;n++)if((t=this[n]).id===e){i=t;break}return i},function(){"use strict";vjs.TextTrackDisplay=vjs.Component.extend({init:function(r,e,t){vjs.Component.call(this,r,e,t),r.on("loadstart",vjs.bind(this,this.toggleDisplay)),r.ready(vjs.bind(this,function(){var e,t,n;if(r.tech&&r.tech.featuresNativeTextTracks)this.hide();else for(r.on("fullscreenchange",vjs.bind(this,this.updateDisplay)),t=r.options_.tracks||[],e=0;e<t.length;e++)n=t[e],this.player_.addRemoteTextTrack(n)}))}}),vjs.TextTrackDisplay.prototype.toggleDisplay=function(){this.player_.tech&&this.player_.tech.featuresNativeTextTracks?this.hide():this.show()},vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},vjs.TextTrackDisplay.prototype.clearDisplay=function(){"function"==typeof window.WebVTT&&window.WebVTT.processCues(window,[],this.el_)};function a(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}function s(e,t,n){try{e.style[t]=n}catch(e){}}var c={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};vjs.TextTrackDisplay.prototype.updateDisplay=function(){var e,t=this.player_.textTracks(),n=0;if(this.clearDisplay(),t)for(;n<t.length;n++)"showing"===(e=t[n]).mode&&this.updateForTrack(e)},vjs.TextTrackDisplay.prototype.updateForTrack=function(e){if("function"==typeof window.WebVTT&&e.activeCues){for(var t,n,r=0,i=this.player_.textTrackSettings.getValues(),o=[];r<e.activeCues.length;r++)o.push(e.activeCues[r]);for(window.WebVTT.processCues(window,e.activeCues,this.el_),r=o.length;r--;)t=o[r].displayState,i.color&&(t.firstChild.style.color=i.color),i.textOpacity&&s(t.firstChild,"color",a(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(t.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&s(t.firstChild,"backgroundColor",a(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?s(t,"backgroundColor",a(i.windowColor,i.windowOpacity)):t.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?t.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===i.edgeStyle?t.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===i.edgeStyle?t.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===i.edgeStyle&&(t.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&1!==i.fontPercent&&(n=window.parseFloat(t.style.fontSize),t.style.fontSize=n*i.fontPercent+"px",t.style.height="auto",t.style.top="auto",t.style.bottom="2px"),i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?t.firstChild.style.fontVariant="small-caps":t.firstChild.style.fontFamily=c[i.fontFamily])}},vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(e,t){var n,r,i=this.track=t.track,o=e.textTracks();o&&(n=vjs.bind(this,function(){var e,t,n,r="showing"===this.track.mode;if(this instanceof vjs.OffTextTrackMenuItem)for(r=!0,t=0,n=o.length;t<n;t++)if((e=o[t]).kind===this.track.kind&&"showing"===e.mode){r=!1;break}this.selected(r)}),o.addEventListener("change",n),e.on("dispose",function(){o.removeEventListener("change",n)})),t.label=i.label||i.language||"Unknown",t.selected=i.default||"showing"===i.mode,vjs.MenuItem.call(this,e,t),o&&void 0===o.onchange&&this.on(["tap","click"],function(){if("object"!=typeof window.Event)try{r=new window.Event("change")}catch(e){}r||(r=document.createEvent("Event")).initEvent("change",!0,!0),o.dispatchEvent(r)})}}),vjs.TextTrackMenuItem.prototype.onClick=function(){var e,t=this.track.kind,n=this.player_.textTracks(),r=0;if(vjs.MenuItem.prototype.onClick.call(this),n)for(;r<n.length;r++)(e=n[r]).kind===t&&(e===this.track?e.mode="showing":e.mode="disabled")},vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(e,t){t.track={kind:t.kind,player:e,label:t.kind+" off",default:!1,mode:"disabled"},vjs.TextTrackMenuItem.call(this,e,t),this.selected(!0)}}),vjs.CaptionSettingsMenuItem=vjs.TextTrackMenuItem.extend({init:function(e,t){t.track={kind:t.kind,player:e,label:t.kind+" settings",default:!1,mode:"disabled"},vjs.TextTrackMenuItem.call(this,e,t),this.addClass("vjs-texttrack-settings")}}),vjs.CaptionSettingsMenuItem.prototype.onClick=function(){this.player().getChild("textTrackSettings").show()},vjs.TextTrackButton=vjs.MenuButton.extend({init:function(e,t){var n,r;vjs.MenuButton.call(this,e,t),n=this.player_.textTracks(),this.items.length<=1&&this.hide(),n&&(r=vjs.bind(this,this.update),n.addEventListener("removetrack",r),n.addEventListener("addtrack",r),this.player_.on("dispose",function(){n.removeEventListener("removetrack",r),n.removeEventListener("addtrack",r)}))}}),vjs.TextTrackButton.prototype.createItems=function(){var e,t,n=[];if(!(this instanceof vjs.CaptionsButton)||this.player().tech&&this.player().tech.featuresNativeTextTracks||n.push(new vjs.CaptionSettingsMenuItem(this.player_,{kind:this.kind_})),n.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_})),!(t=this.player_.textTracks()))return n;for(var r=0;r<t.length;r++)(e=t[r]).kind===this.kind_&&n.push(new vjs.TextTrackMenuItem(this.player_,{track:e}));return n},vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(e,t,n){vjs.TextTrackButton.call(this,e,t,n),this.el_.setAttribute("aria-label","Captions Menu")}}),vjs.CaptionsButton.prototype.kind_="captions",vjs.CaptionsButton.prototype.buttonText="Captions",vjs.CaptionsButton.prototype.className="vjs-captions-button",vjs.CaptionsButton.prototype.update=function(){var e=2;vjs.TextTrackButton.prototype.update.call(this),this.player().tech&&this.player().tech.featuresNativeTextTracks&&(e=1),this.items&&this.items.length>e?this.show():this.hide()},vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(e,t,n){vjs.TextTrackButton.call(this,e,t,n),this.el_.setAttribute("aria-label","Subtitles Menu")}}),vjs.SubtitlesButton.prototype.kind_="subtitles",vjs.SubtitlesButton.prototype.buttonText="Subtitles",vjs.SubtitlesButton.prototype.className="vjs-subtitles-button",vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(e,t,n){vjs.TextTrackButton.call(this,e,t,n),this.el_.setAttribute("aria-label","Chapters Menu")}}),vjs.ChaptersButton.prototype.kind_="chapters",vjs.ChaptersButton.prototype.buttonText="Chapters",vjs.ChaptersButton.prototype.className="vjs-chapters-button",vjs.ChaptersButton.prototype.createItems=function(){var e,t=[],n=this.player_.textTracks();if(!n)return t;for(var r=0;r<n.length;r++)(e=n[r]).kind===this.kind_&&t.push(new vjs.TextTrackMenuItem(this.player_,{track:e}));return t},vjs.ChaptersButton.prototype.createMenu=function(){for(var e,t,n=this.player_.textTracks()||[],r=0,i=n.length,o=this.items=[];r<i;r++)if((e=n[r]).kind==this.kind_){if(e.cues){t=e;break}e.mode="hidden",window.setTimeout(vjs.bind(this,function(){this.createMenu()}),100)}var a=this.menu;if(void 0===a&&(a=new vjs.Menu(this.player_)).contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1})),t){for(var s,c=t.cues,r=0,i=c.length;r<i;r++)s=c[r],s=new vjs.ChaptersTrackMenuItem(this.player_,{track:t,cue:s}),o.push(s),a.addChild(s);this.addChild(a)}return 0<this.items.length&&this.show(),a},vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(e,t){var n=this.track=t.track,r=this.cue=t.cue,i=e.currentTime();t.label=r.text,t.selected=r.startTime<=i&&i<r.endTime,vjs.MenuItem.call(this,e,t),n.addEventListener("cuechange",vjs.bind(this,this.update))}}),vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},vjs.ChaptersTrackMenuItem.prototype.update=function(){var e=this.cue,t=this.player_.currentTime();this.selected(e.startTime<=t&&t<e.endTime)}}(),function(){"use strict";function l(e){var t;return e.selectedOptions?t=e.selectedOptions[0]:e.options&&(t=e.options[e.options.selectedIndex]),t.value}function n(e,t){var n;if(t){for(n=0;n<e.options.length&&e.options[n].value!==t;n++);e.selectedIndex=n}}vjs.TextTrackSettings=vjs.Component.extend({init:function(e,t){vjs.Component.call(this,e,t),this.hide(),vjs.on(this.el().querySelector(".vjs-done-button"),"click",vjs.bind(this,function(){this.saveSettings(),this.hide()})),vjs.on(this.el().querySelector(".vjs-default-button"),"click",vjs.bind(this,function(){this.el().querySelector(".vjs-fg-color > select").selectedIndex=0,this.el().querySelector(".vjs-bg-color > select").selectedIndex=0,this.el().querySelector(".window-color > select").selectedIndex=0,this.el().querySelector(".vjs-text-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-bg-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-window-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-edge-style select").selectedIndex=0,this.el().querySelector(".vjs-font-family select").selectedIndex=0,this.el().querySelector(".vjs-font-percent select").selectedIndex=2,this.updateDisplay()})),vjs.on(this.el().querySelector(".vjs-fg-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-bg-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".window-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-text-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-bg-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-window-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-font-percent select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-edge-style select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-font-family select"),"change",vjs.bind(this,this.updateDisplay)),e.options().persistTextTrackSettings&&this.restoreSettings()}}),vjs.TextTrackSettings.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:'<div class="vjs-tracksettings"><div class="vjs-tracksettings-colors"><div class="vjs-fg-color vjs-tracksetting"><label class="vjs-label">Foreground</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-text-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Opaque</option></select></span></div><div class="vjs-bg-color vjs-tracksetting"><label class="vjs-label">Background</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-bg-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div><div class="window-color vjs-tracksetting"><label class="vjs-label">Window</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-window-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div></div><div class="vjs-tracksettings-font"><div class="vjs-font-percent vjs-tracksetting"><label class="vjs-label">Font Size</label><select><option value="0.50">50%</option><option value="0.75">75%</option><option value="1.00" selected>100%</option><option value="1.25">125%</option><option value="1.50">150%</option><option value="1.75">175%</option><option value="2.00">200%</option><option value="3.00">300%</option><option value="4.00">400%</option></select></div><div class="vjs-edge-style vjs-tracksetting"><label class="vjs-label">Text Edge Style</label><select><option value="none">None</option><option value="raised">Raised</option><option value="depressed">Depressed</option><option value="uniform">Uniform</option><option value="dropshadow">Dropshadow</option></select></div><div class="vjs-font-family vjs-tracksetting"><label class="vjs-label">Font Family</label><select><option value="">Default</option><option value="monospaceSerif">Monospace Serif</option><option value="proportionalSerif">Proportional Serif</option><option value="monospaceSansSerif">Monospace Sans-Serif</option><option value="proportionalSansSerif">Proportional Sans-Serif</option><option value="casual">Casual</option><option value="script">Script</option><option value="small-caps">Small Caps</option></select></div></div></div><div class="vjs-tracksettings-controls"><button class="vjs-default-button">Defaults</button><button class="vjs-done-button">Done</button></div>'})},vjs.TextTrackSettings.prototype.getValues=function(){var e,t=this.el(),n=l(t.querySelector(".vjs-edge-style select")),r=l(t.querySelector(".vjs-font-family select")),i=l(t.querySelector(".vjs-fg-color > select")),o=l(t.querySelector(".vjs-text-opacity > select")),a=l(t.querySelector(".vjs-bg-color > select")),s=l(t.querySelector(".vjs-bg-opacity > select")),c=l(t.querySelector(".window-color > select")),u={backgroundOpacity:s,textOpacity:o,windowOpacity:l(t.querySelector(".vjs-window-opacity > select")),edgeStyle:n,fontFamily:r,color:i,backgroundColor:a,windowColor:c,fontPercent:window.parseFloat(l(t.querySelector(".vjs-font-percent > select")))};for(e in u)(""===u[e]||"none"===u[e]||"fontPercent"===e&&1===u[e])&&delete u[e];return u},vjs.TextTrackSettings.prototype.setValues=function(e){var t=this.el();n(t.querySelector(".vjs-edge-style select"),e.edgeStyle),n(t.querySelector(".vjs-font-family select"),e.fontFamily),n(t.querySelector(".vjs-fg-color > select"),e.color),n(t.querySelector(".vjs-text-opacity > select"),e.textOpacity),n(t.querySelector(".vjs-bg-color > select"),e.backgroundColor),n(t.querySelector(".vjs-bg-opacity > select"),e.backgroundOpacity),n(t.querySelector(".window-color > select"),e.windowColor),n(t.querySelector(".vjs-window-opacity > select"),e.windowOpacity),e=(e=e.fontPercent)&&e.toFixed(2),n(t.querySelector(".vjs-font-percent > select"),e)},vjs.TextTrackSettings.prototype.restoreSettings=function(){var e;try{e=JSON.parse(window.localStorage.getItem("vjs-text-track-settings"))}catch(e){}e&&this.setValues(e)},vjs.TextTrackSettings.prototype.saveSettings=function(){var e;if(this.player_.options().persistTextTrackSettings){e=this.getValues();try{vjs.isEmpty(e)?window.localStorage.removeItem("vjs-text-track-settings"):window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e))}catch(e){}}},vjs.TextTrackSettings.prototype.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}}(),vjs.JSON,void 0!==window.JSON&&"function"==typeof window.JSON.parse?vjs.JSON=window.JSON:(vjs.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,vjs.JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(r=walk(i,n))?i[n]=r:delete i[n]);return reviver.call(e,t,i)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data")}),vjs.autoSetup=function(){var e,t,n,r=document.getElementsByTagName("video"),i=document.getElementsByTagName("audio"),o=[];if(r&&0<r.length)for(t=0,n=r.length;t<n;t++)o.push(r[t]);if(i&&0<i.length)for(t=0,n=i.length;t<n;t++)o.push(i[t]);if(o&&0<o.length)for(t=0,n=o.length;t<n;t++){if(!(e=o[t])||!e.getAttribute){vjs.autoSetupTimeout(1);break}void 0===e.player&&null!==e.getAttribute("data-setup")&&videojs(e)}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(e){setTimeout(vjs.autoSetup,e)},"complete"===document.readyState?vjs.windowLoaded=!0:vjs.one(window,"load",function(){vjs.windowLoaded=!0}),vjs.autoSetupTimeout(1),vjs.plugin=function(e,t){vjs.Player.prototype[e]=t},w80=this,x80=w80.vttjs={},y80=x80.VTTCue,z80=x80.VTTRegion,A80=w80.VTTCue,B80=w80.VTTRegion,x80.shim=function(){x80.VTTCue=y80,x80.VTTRegion=z80},x80.restore=function(){x80.VTTCue=A80,x80.VTTRegion=B80},C80=this,D80=this.vttjs||{},F80={"":!0,lr:!0,rl:!0},G80={start:!0,middle:!0,end:!0,left:!0,right:!0},K80.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},C80.VTTCue=C80.VTTCue||K80,D80.VTTCue=K80,Dj0=this,Ej0=this.vttjs||{},Fj0={"":!0,up:!0},Dj0.VTTRegion=Dj0.VTTRegion||Ij0,Ej0.VTTRegion=Ij0;var _j0=this,a90=(this.vttjs,Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return w90.prototype=e,new w90});function w90(){}function b90(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function c90(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}e=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return e?e[3]?t(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?t(e[1],e[2],0,e[4]):t(0,e[1],e[2],e[4]):null}function d90(){this.values=a90(null)}function e90(e,t,n,r){var i,o,a=r?e.split(r):[e];for(i in a)"string"==typeof a[i]&&(2===(o=a[i].split(n)).length&&t(o[0],o[1]))}((b90.prototype=a90(Error.prototype)).constructor=b90).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},d90.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var g90={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},h90={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},i90={v:"title",lang:"lang"},j90={rt:"ruby"};function k90(i,t){function l(e){return g90[e]}for(var e,n,r,o,a,s=i.document.createElement("div"),c=s,u=[];null!==(e=function(){if(!t)return null;var e=t.match(/^([^<]*)(<[^>]+>?)?/);return e=e[1]||e[2],t=t.substr(e.length),e}());)"<"!==e[0]?c.appendChild(i.document.createTextNode(function(e){for(;r=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(r[0],l);return e}(e))):"/"!==e[1]?(o=c90(e.substr(1,e.length-2)))?(n=i.document.createProcessingInstruction("timestamp",o),c.appendChild(n)):(r=e.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/))&&(n=function(e,t){var n=h90[e];if(!n)return null;var r=i.document.createElement(n);return r.localName=n,(n=i90[e])&&t&&(r[n]=t.trim()),r}(r[1],r[3]))&&(o=c,j90[(a=n).localName]&&j90[a.localName]!==o.localName||(r[2]&&(n.className=r[2].substr(1).replace("."," ")),u.push(r[1]),c.appendChild(n),c=n)):u.length&&u[u.length-1]===e.substr(2).replace(">","")&&(u.pop(),c=c.parentNode);return s}var l90=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];function m90(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function o(e,t){for(var n=t.childNodes.length-1;0<=n;n--)e.push(t.childNodes[n])}for(o(t,e);n=function e(t){if(!t||!t.length)return null;var n,r=t.pop(),i=r.textContent||r.innerText;return i?(n=i.match(/^.*(\n|\r)/))?n[t.length=0]:i:"ruby"===r.tagName?e(t):r.childNodes?(o(t,r),e(t)):void 0}(t);)for(var r=0;r<n.length;r++)for(var i=n.charCodeAt(r),a=0;a<l90.length;a++)if(l90[a]===i)return"rtl";return"ltr"}function o90(){}function p90(e,t,n){var r=/MSIE\s8\.0/.test(navigator.userAgent),i="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)",i=(r&&(i="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),o90.call(this),this.cue=t,this.cueDiv=k90(e,t.text),{color:i,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"}),a=(r||(i.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",i.unicodeBidi="plaintext"),this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},r||(i.direction=m90(this.cueDiv),i.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"plaintext"),this.applyStyles(i),this.div.appendChild(this.cueDiv),0);switch(t.positionAlign){case"start":a=t.position;break;case"middle":a=t.position-t.size/2;break;case"end":a=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(a,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(a,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function q90(e){var t,n,r,i,o=/MSIE\s8\.0/.test(navigator.userAgent);e.div&&(t=e.div.offsetHeight,n=e.div.offsetWidth,r=e.div.offsetTop,i=(i=e.div.childNodes)&&(i=i[0])&&i.getClientRects&&i.getClientRects(),e=e.div.getBoundingClientRect(),i=i?Math.max(i[0]&&i[0].height||0,e.height/i.length):0),this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||t,this.bottom=e.bottom||r+(e.height||t),this.width=e.width||n,this.lineHeight=void 0!==i?i:e.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function r90(l,e,s,d){var t,n=new q90(e),r=e.cue,i=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(r),o=[];if(r.snapToLines){switch(r.vertical){case"":o=["+y","-y"],t="height";break;case"rl":o=["+x","-x"],t="width";break;case"lr":o=["-x","+x"],t="width"}var a=n.lineHeight,c=a*Math.round(i),u=s[t]+a,f=o[0];Math.abs(c)>u&&(c=c<0?-1:1,c*=Math.ceil(u/a)*a),i<0&&(c+=""===r.vertical?s.height:s.width,o=o.reverse()),n.move(f,c)}else{var p=n.lineHeight/s.height*100;switch(r.lineAlign){case"middle":i-=p/2;break;case"end":i-=p}switch(r.vertical){case"":e.applyStyles({top:e.formatStyle(i,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(i,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(i,"%")})}o=["+y","-x","+x","-y"],n=new q90(e)}u=function(e,t){for(var n,r=new q90(e),i=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(s,t[o])||e.within(s)&&e.overlapsAny(d);)e.move(t[o]);if(e.within(s))return e;var a=e.intersectPercentage(s);a<i&&(n=new q90(e),i=a),e=new q90(r)}return n||r}(n,o);e.move(u.toCSSCompatValues(s))}function s90(){}o90.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},o90.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(p90.prototype=a90(o90.prototype)).constructor=p90,q90.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},q90.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},q90.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},q90.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},q90.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},q90.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},q90.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},q90.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},s90.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},s90.convertCueToDOMTree=function(e,t){return e&&t?k90(e,t):null},s90.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return 1}(t))for(var i,o,a=[],s=q90.getSimpleBoxPosition(r),l={font:Math.round(.05*s.height*100)/100+"px sans-serif"},c=0;c<t.length;c++)o=t[c],i=new p90(e,o,l),r.appendChild(i.div),r90(0,i,s,a),o.displayState=i.div,a.push(q90.getSimpleBoxPosition(i));else for(var u=0;u<t.length;u++)r.appendChild(t[u].displayState)},(s90.Parser=function(e,t,n){n||(n=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof b90))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var r=this;function t(){for(var e=r.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var n=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,r.buffer=e.substr(t),n}function n(e){e90(e,function(e,t){var i;"Region"===e&&(e=t,i=new d90,e90(e,function(e,t){switch(e){case"id":i.set(e,t);break;case"width":i.percent(e,t);break;case"lines":i.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var r=new d90;if(r.percent("x",n[0]),r.percent("y",n[1]),!r.has("x")||!r.has("y"))break;i.set(e+"X",r.get("x")),i.set(e+"Y",r.get("y"));break;case"scroll":i.alt(e,t,["up"])}},/=/,/\s/),i.has("id")&&((e=new(r.vttjs.VTTRegion||r.window.VTTRegion)).width=i.get("width",100),e.lines=i.get("lines",3),e.regionAnchorX=i.get("regionanchorX",0),e.regionAnchorY=i.get("regionanchorY",100),e.viewportAnchorX=i.get("viewportanchorX",0),e.viewportAnchorY=i.get("viewportanchorY",100),e.scroll=i.get("scroll",""),r.onregion&&r.onregion(e),r.regionList.push({id:i.get("id"),region:e})))},/:/)}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var i,o=(i=t()).match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new b90(b90.Errors.BadSignature);r.state="HEADER"}for(var a=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(a?a=!1:i=t(),r.state){case"HEADER":/:/.test(i)?n(i):i||(r.state="ID");continue;case"NOTE":i||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){r.state="NOTE";break}if(!i)continue;if(r.cue=new(r.vttjs.VTTCue||r.window.VTTCue)(0,0,""),r.state="CUE",-1===i.indexOf("--\x3e")){r.cue.id=i;continue}case"CUE":try{!function(t,e,o){var n,a,r=t;function i(){var e=c90(t);if(null===e)throw new b90(b90.Errors.BadTimeStamp,"Malformed timestamp: "+r);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=i(),s(),"--\x3e"!==t.substr(0,3))throw new b90(b90.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);t=t.substr(3),s(),e.endTime=i(),s(),n=t,e=e,a=new d90,e90(n,function(e,t){switch(e){case"region":for(var n=o.length-1;0<=n;n--)if(o[n].id===t){a.set(e,o[n].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),i=r[0];a.integer(e,i),a.percent(e,i)&&a.set("snapToLines",!1),a.alt(e,i,["auto"]),2===r.length&&a.alt("lineAlign",r[1],["start","middle","end"]);break;case"position":r=t.split(","),a.percent(e,r[0]),2===r.length&&a.alt("positionAlign",r[1],["start","middle","end"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),e.region=a.get("region",null),e.vertical=a.get("vertical",""),e.line=a.get("line","auto"),e.lineAlign=a.get("lineAlign","start"),e.snapToLines=a.get("snapToLines",!0),e.size=a.get("size",100),e.align=a.get("align","middle"),e.position=a.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=a.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}(i,r.cue,r.regionList)}catch(e){r.reportOrThrowError(e),r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(a=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=i;continue;case"BADCUE":i||(r.state="ID");continue}}}catch(e){r.reportOrThrowError(e),"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new b90(b90.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},_j0.WebVTT=s90},{}],19:[function(e,t,n){"use strict";!function(u){var l=function(e){return/^\d+$/.test(e)?e+"p":e};u.ResolutionMenuItem=u.MenuItem.extend({init:function(e,t){var n=this;t.label=l(t.res),t.selected=t.res.toString()===e.getCurrentRes().toString(),u.MenuItem.call(n,e,t),n.resolution=t.res,n.on(["click","tap"],n.onSelect),e.on("changeRes",u.bind(n,function(){n.resolution===e.getCurrentRes()?n.selected(!0):n.selected(!1)}))}}),u.ResolutionMenuItem.prototype.onClick=function(e){e.preventDefault(),e.stopPropagation()},u.ResolutionMenuItem.prototype.onSelect=function(e){e.preventDefault(),e.stopPropagation(),this.player().changeRes(this.resolution)},u.ResolutionTitleMenuItem=u.MenuItem.extend({init:function(e,t){u.MenuItem.call(this,e,t),this.off("click")}}),u.ResolutionSelector=u.MenuButton.extend({init:function(e,t){e.availableRes=t.availableRes,e.hideMenuTitle=t.hideMenuTitle,u.MenuButton.call(this,e,t),this.el().firstChild.firstChild.innerHTML=t.buttonText,this.on(["click","tap"],this.switch)}}),u.ResolutionSelector.prototype.className="vjs-res-button",u.ResolutionSelector.prototype.createItems=function(){var e,t=this.player(),n=[];for(e in t.hideMenuTitle||n.push(new u.ResolutionTitleMenuItem(t,{el:u.Component.prototype.createEl("li",{className:"vjs-menu-title vjs-res-menu-title",innerHTML:t.localize("Quality")})})),t.availableRes)"length"!==e&&n.push(new u.ResolutionMenuItem(t,{res:e}));return n.sort(function(e,t){return void 0===e.resolution?-1:parseInt(t.resolution)-parseInt(e.resolution)}),n},u.ResolutionSelector.prototype.onClick=function(e){e.preventDefault(),e.stopPropagation()},u.ResolutionSelector.prototype.switch=function(e){var t,n=this.player(),r=0,i=0,o=[];for(t in e.preventDefault(),e.stopPropagation(),n.availableRes)"length"!==t&&(o.push(t),t===n.currentRes&&(r=i),i++);r>=o.length-1?r=0:r++,this.player().changeRes(o[r])},u.plugin("resolutionSelector",function(e){var c;this.el().firstChild.canPlayType&&("function"!=typeof this.localize&&(this.localize=function(e){return e}),this.getCurrentRes=function(){if(void 0!==this.currentRes)return this.currentRes;try{return res=this.options().sources[0]["data-res"]}catch(e){return""}},this.changeRes=function(e){var t,n,r=this.el().firstChild,i=this.paused(),o=this.currentTime();if(this.getCurrentRes()!==e&&this.availableRes&&this.availableRes[e]){if("none"===r.preload&&(r.preload="metadata"),this.src(this.availableRes[e]).one("loadedmetadata",function(){this.currentTime(o),this.addClass("vjs-has-started"),i||this.play()}),this.currentRes=e,this.controlBar.resolutionSelector)for(n=(t=this.controlBar.resolutionSelector.el().firstChild.children).length;0<n;)if("vjs-control-text"===t[--n].className){t[n].innerHTML=l(e);break}this.trigger("changeRes")}},this.setResOptions=function(e){var t,e=u.util.mergeOptions({default_res:"",force_types:!1,hide_menu_title:!1,available_res:{}},e||{}),n=function(e,t){var n,r=e.options().sources,i=r.length;if(t.length)return t;for(;0<i;)r[--i]["data-res"]&&("object"!=typeof t[n=r[i]["data-res"]]&&(t[n]=[],t.length++),t[n].unshift(r[i]));return t}(this,e.available_res);for(t in(n=function(e,t){var n,r,i,o;if(e)for(o in t)if("length"!==o){for(n=e.length,i=0;0<n;)for(n--,r=t[o].length;0<r;)if(r--,e[n]===t[o][r].type){i++;break}i<e.length&&(delete t[o],t.length--)}return t}(e.force_types,n)).length=0,n)n.hasOwnProperty(t)&&"length"!==t&&n.length++;if(!(n.length<2)){for(var r=e.default_res&&"string"==typeof e.default_res?e.default_res.split(","):[],i=this,o=r,a=n,s=0;s<o.length;s++)if(a[o[s]]){i.src(a[o[s]]),i.currentRes=o[s];break}r=(r=this.getCurrentRes())&&l(r);this.controlBar.removeChild(c),c=new u.ResolutionSelector(this,{buttonText:this.localize(r||"Quality"),availableRes:n,hideMenuTitle:e.hide_menu_title}),this.controlBar.resolutionSelector=this.controlBar.addChild(c)}},this.setResOptions(e))})}(videojs)},{}],20:[function(wc,Sc,e){!function(_c){!function(){"use strict";var r=(e=wc("underscore"))&&"object"==typeof e&&"default"in e?e.default:e,I="undefined"!=typeof window?window:void 0!==_c?_c:"undefined"!=typeof self?self:{};function i(e,t){return e(t={exports:{}},t.exports),t.exports}function Be(e,t){return v.call(e,t)}function Ue(e){try{return!!e()}catch(e){return!0}}function o(e){return _?b.createElement(e):{}}function p(e,t,n){var r,i,o,l=e&p.F,a=e&p.G,s=e&p.P,d=e&p.B,c=a?Fe:e&p.S?Fe[t]||(Fe[t]={}):(Fe[t]||{})[M],u=a?y:y[t]||(y[t]={}),f=u[M]||(u[M]={});for(r in n=a?t:n)i=((o=!l&&c&&void 0!==c[r])?c:n)[r],o=d&&o?et(i,Fe):s&&"function"==typeof i?et(Function.call,i):i,c&&x(c,r,i,e&p.U),u[r]!=i&&Xe(u,r,o),s&&f[r]!=i&&(f[r]=i)}function a(e){var t=y.Symbol||(y.Symbol=Fe.Symbol||{});"_"==e.charAt(0)||e in t||N(t,e,{value:D.f(e)})}function qe(e,t){return(e=tt(e))<0?W(e+t,0):Y(e,t)}function We(s){return function(e,t,n){var r,i=z(e),o=nt(i.length),a=qe(n,o);if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}}function s(e){return G[e]||(G[e]=Ze(e))}function c(e,t){var n,r=z(e),i=0,o=[];for(n in r)n!=J&&Be(r,n)&&o.push(n);for(;t.length>i;)Be(r,n=t[i++])&&(~K(o,n)||o.push(n));return o}function Ye(e){return Object(F(e))}function u(){}function l(e){var t=ke[e]=rt(ye[we]);return t._k=e,t}function d(e,t){S(e);for(var n,r=te(t=z(t)),i=0,o=r.length;i<o;)Oe(e,n=r[i++],t[n]);return e}function f(e){var t=Ee.call(this,e=Ke(e,!0));return!(this===Ce&&Be(ke,e)&&!Be(Te,e))&&(!(t||!Be(this,e)||!Be(ke,e)||Be(this,Se)&&this[Se][e])||t)}function h(e,t){var n;if(e=z(e),t=Ke(t,!0),e!==Ce||!Be(ke,t)||Be(Te,t))return!(n=me(e,t))||!Be(ke,t)||Be(e,Se)&&e[Se][t]||(n.enumerable=!0),n}function m(e){for(var t,n=ve(z(e)),r=[],i=0;n.length>i;)Be(ke,t=n[i++])||t==Se||t==he||r.push(t);return r}function g(e){for(var t,n=e===Ce,r=ve(n?Te:z(e)),i=[],o=0;r.length>o;)!Be(ke,t=r[o++])||n&&!Be(Ce,t)||i.push(ke[t]);return i}var Fe=i(function(e){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)}),v={}.hasOwnProperty,Ge=!Ue(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),y=i(function(e){e=e.exports={version:"2.6.9"},"number"==typeof __e&&(__e=e)}),ze=function(e){return"object"==typeof e?null!==e:"function"==typeof e},S=function(e){if(!ze(e))throw TypeError(e+" is not an object!");return e},b=Fe.document,_=ze(b)&&ze(b.createElement),w=!Ge&&!Ue(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),Ke=function(e,t){if(!ze(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!ze(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!ze(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!ze(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},E=Object.defineProperty,Je={f:Ge?Object.defineProperty:function(e,t,n){if(S(e),t=Ke(t,!0),S(n),w)try{return E(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},Qe=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Xe=Ge?function(e,t,n){return Je.f(e,t,Qe(1,n))}:function(e,t,n){return e[t]=n,e},A=0,k=Math.random(),Ze=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++A+k).toString(36))},T=i(function(e){var t="__core-js_shared__",n=Fe[t]||(Fe[t]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:y.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})}),C=T("native-function-to-string",Function.toString),x=i(function(e){var o=Ze("src"),a=(""+C).split("toString");y.inspectSource=function(e){return C.call(e)},(e.exports=function(e,t,n,r){var i="function"==typeof n;i&&(Be(n,"name")||Xe(n,"name",t)),e[t]!==n&&(i&&(Be(n,o)||Xe(n,o,e[t]?""+e[t]:a.join(String(t)))),e===Fe?e[t]=n:r?e[t]?e[t]=n:Xe(e,t,n):(delete e[t],Xe(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||C.call(this)})}),P=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},et=function(r,i,e){if(P(r),void 0===i)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}},M="prototype",Ve=(Fe.core=y,p.F=1,p.G=2,p.S=4,p.P=8,p.B=16,p.W=32,p.U=64,p.R=128,p),O=i(function(e){function n(e){t(e,r,{value:{i:"O"+ ++i,w:{}}})}var r=Ze("meta"),t=Je.f,i=0,o=Object.isExtensible||function(){return!0},a=!Ue(function(){return o(Object.preventExtensions({}))}),s=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!ze(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Be(e,r)){if(!o(e))return"F";if(!t)return"E";n(e)}return e[r].i},getWeak:function(e,t){if(!Be(e,r)){if(!o(e))return!0;if(!t)return!1;n(e)}return e[r].w},onFreeze:function(e){return a&&s.NEED&&o(e)&&!Be(e,r)&&n(e),e}}}),He=i(function(e){var t=T("wks"),n=Fe.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:Ze)("Symbol."+e))}).store=t}),R=Je.f,j=He("toStringTag"),B=function(e,t,n){e&&!Be(e=n?e:e.prototype,j)&&R(e,j,{configurable:!0,value:t})},D={f:He},N=Je.f,L={}.toString,$=function(e){return L.call(e).slice(8,-1)},U=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==$(e)?e.split(""):Object(e)},F=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},z=function(e){return U(F(e))},V=Math.ceil,H=Math.floor,tt=function(e){return isNaN(e=+e)?0:(0<e?H:V)(e)},q=Math.min,nt=function(e){return 0<e?q(tt(e),9007199254740991):0},W=Math.max,Y=Math.min,G=T("keys"),K=We(!1),J=s("IE_PROTO"),Q="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),X=Object.keys||function(e){return c(e,Q)},Z={f:Object.getOwnPropertySymbols},ee={f:{}.propertyIsEnumerable},te=function(e){var t=X(e),n=Z.f;if(n)for(var r,i=n(e),o=ee.f,a=0;i.length>a;)o.call(e,r=i[a++])&&t.push(r);return t},ne=Array.isArray||function(e){return"Array"==$(e)},re=Ge?Object.defineProperties:function(e,t){S(e);for(var n,r=X(t),i=r.length,o=0;o<i;)Je.f(e,n=r[o++],t[n]);return e},e=Fe.document,ie=e&&e.documentElement,oe=s("IE_PROTO"),ae="prototype",se=function(){var e=o("iframe"),t=Q.length;for(e.style.display="none",ie.appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),se=e.F;t--;)delete se[ae][Q[t]];return se()},rt=Object.create||function(e,t){var n;return null!==e?(u[ae]=S(e),n=new u,u[ae]=null,n[oe]=e):n=se(),void 0===t?n:re(n,t)},ce=Q.concat("length","prototype"),it={f:Object.getOwnPropertyNames||function(e){return c(e,ce)}},ue=it.f,le={}.toString,de="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],fe={f:function(e){if(!de||"[object Window]"!=le.call(e))return ue(z(e));var t=e;try{return ue(t)}catch(t){return de.slice()}}},pe=Object.getOwnPropertyDescriptor,ot={f:Ge?pe:function(e,t){if(e=z(e),t=Ke(t,!0),w)try{return pe(e,t)}catch(e){}if(Be(e,t))return Qe(!ee.f.call(e,t),e[t])}},he=O.KEY,me=ot.f,ge=Je.f,ve=fe.f,ye=Fe.Symbol,be=Fe.JSON,_e=be&&be.stringify,we="prototype",Se=He("_hidden"),e=He("toPrimitive"),Ee={}.propertyIsEnumerable,Ae=T("symbol-registry"),ke=T("symbols"),Te=T("op-symbols"),Ce=Object[we],t="function"==typeof ye&&!!Z.f,Ie=Fe.QObject,xe=!Ie||!Ie[we]||!Ie[we].findChild,Pe=Ge&&Ue(function(){return 7!=rt(ge({},"a",{get:function(){return ge(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=me(Ce,t);r&&delete Ce[t],ge(e,t,n),r&&e!==Ce&&ge(Ce,t,r)}:ge,Me=t&&"symbol"==typeof ye.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof ye},Oe=function(e,t,n){return e===Ce&&Oe(Te,t,n),S(e),t=Ke(t,!0),S(n),Be(ke,t)?(n.enumerable?(Be(e,Se)&&e[Se][t]&&(e[Se][t]=!1),n=rt(n,{enumerable:Qe(0,!1)})):(Be(e,Se)||ge(e,Se,Qe(1,{})),e[Se][t]=!0),Pe(e,t,n)):ge(e,t,n)};t||(x((ye=function(){if(this instanceof ye)throw TypeError("Symbol is not a constructor!");var t=Ze(0<arguments.length?arguments[0]:void 0),n=function(e){this===Ce&&n.call(Te,e),Be(this,Se)&&Be(this[Se],t)&&(this[Se][t]=!1),Pe(this,t,Qe(1,e))};return Ge&&xe&&Pe(Ce,t,{configurable:!0,set:n}),l(t)})[we],"toString",function(){return this._k}),ot.f=h,Je.f=Oe,it.f=fe.f=m,ee.f=f,Z.f=g,Ge&&x(Ce,"propertyIsEnumerable",f,!0),D.f=function(e){return l(He(e))}),Ve(Ve.G+Ve.W+Ve.F*!t,{Symbol:ye});for(var Re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),je=0;Re.length>je;)He(Re[je++]);for(var De=X(He.store),Ne=0;De.length>Ne;)a(De[Ne++]);Ve(Ve.S+Ve.F*!t,"Symbol",{for:function(e){return Be(Ae,e+="")?Ae[e]:Ae[e]=ye(e)},keyFor:function(e){if(!Me(e))throw TypeError(e+" is not a symbol!");for(var t in Ae)if(Ae[t]===e)return t},useSetter:function(){xe=!0},useSimple:function(){xe=!1}}),Ve(Ve.S+Ve.F*!t,"Object",{create:function(e,t){return void 0===t?rt(e):d(rt(e),t)},defineProperty:Oe,defineProperties:d,getOwnPropertyDescriptor:h,getOwnPropertyNames:m,getOwnPropertySymbols:g});function Le(e,t){var n=(y.Object||{})[e]||Object[e],r={};r[e]=t(n),Ve(Ve.S+Ve.F*Ue(function(){n(1)}),"Object",r)}function $e(e,t){if(S(e),!ze(t)&&null!==t)throw TypeError(t+": can't set as prototype!")}function at(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),St))?e:Et?$(t):"Object"==(e=$(t))&&"function"==typeof t.callee?"Arguments":e}function st(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}function ct(e,t,n){var r={},i=Ue(function(){return It[e]()||""!=""[e]()}),t=r[e]=i?t(Mt):It[e];n&&(r[n]=t),Ve(Ve.P+Ve.F*i,"String",r)}function ut(e,t,n){var r;return(t=t.constructor)!==n&&"function"==typeof t&&(r=t.prototype)!==n.prototype&&ze(r)&&Lt&&Lt(e,r),e}function lt(e){if("string"==typeof(t=Ke(e,!1))&&2<t.length){var t,n,r,i=(t=qt?t.trim():Ut(t,3)).charCodeAt(0);if(43===i||45===i){if(88===(e=t.charCodeAt(2))||120===e)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+t}for(var o,a=t.slice(2),s=0,c=a.length;s<c;s++)if((o=a.charCodeAt(s))<48||r<o)return NaN;return parseInt(a,n)}}return+t}var Ie=Ue(function(){Z.f(1)}),dt=(Ve(Ve.S+Ve.F*Ie,"Object",{getOwnPropertySymbols:function(e){return Z.f(Ye(e))}}),be&&Ve(Ve.S+Ve.F*(!t||Ue(function(){var e=ye();return"[null]"!=_e([e])||"{}"!=_e({a:e})||"{}"!=_e(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(ze(t)||void 0!==e)&&!Me(e))return ne(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Me(t))return t}),r[1]=t,_e.apply(be,r)}}),ye[we][e]||Xe(ye[we],e,ye[we].valueOf),B(ye,"Symbol"),B(Math,"Math",!0),B(Fe.JSON,"JSON",!0),Ve(Ve.S,"Object",{create:rt}),Ve(Ve.S+Ve.F*!Ge,"Object",{defineProperty:Je.f}),Ve(Ve.S+Ve.F*!Ge,"Object",{defineProperties:re}),ot.f),ft=(Le("getOwnPropertyDescriptor",function(){return function(e,t){return dt(z(e),t)}}),s("IE_PROTO")),pt=Object.prototype,ht=Object.getPrototypeOf||function(e){return e=Ye(e),Be(e,ft)?e[ft]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?pt:null},mt=(Le("getPrototypeOf",function(){return function(e){return ht(Ye(e))}}),Le("keys",function(){return function(e){return X(Ye(e))}}),Le("getOwnPropertyNames",function(){return fe.f}),O.onFreeze),gt=(Le("freeze",function(t){return function(e){return t&&ze(e)?t(mt(e)):e}}),O.onFreeze),vt=(Le("seal",function(t){return function(e){return t&&ze(e)?t(gt(e)):e}}),O.onFreeze),yt=(Le("preventExtensions",function(t){return function(e){return t&&ze(e)?t(vt(e)):e}}),Le("isFrozen",function(t){return function(e){return!ze(e)||!!t&&t(e)}}),Le("isSealed",function(t){return function(e){return!ze(e)||!!t&&t(e)}}),Le("isExtensible",function(t){return function(e){return!!ze(e)&&(!t||t(e))}}),Object.assign),bt=!yt||Ue(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=yt({},e)[n]||Object.keys(yt({},t)).join("")!=r})?function(e,u){for(var t=Ye(e),n=arguments.length,r=1,i=Z.f,l=ee.f;r<n;)for(var o,a=U(arguments[r++]),s=i?X(a).concat(i(a)):X(a),d=s.length,c=0;c<d;)o=s[c++],Ge&&!l.call(a,o)||(t[o]=a[o]);return t}:yt,_t=(Ve(Ve.S+Ve.F,"Object",{assign:bt}),Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}),wt=(Ve(Ve.S,"Object",{is:_t}),{set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,r){try{(r=et(Function.call,ot.f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return $e(e,t),n?e.__proto__=t:r(e,t),e}}({},!1):void 0),check:$e}),St=(Ve(Ve.S,"Object",{setPrototypeOf:wt.set}),He("toStringTag")),Et="Arguments"==$(function(){return arguments}()),Ie={},At=(Ie[He("toStringTag")]="z",Ie+""!="[object z]"&&x(Object.prototype,"toString",function(){return"[object "+at(this)+"]"},!0),[].slice),kt={},Tt=Function.bind||function(a){var s=P(this),c=At.call(arguments,1),u=function(){var e=c.concat(At.call(arguments));if(this instanceof u){var t=s,n=e.length,r=e;if(!(n in kt)){for(var i=[],o=0;o<n;o++)i[o]="a["+o+"]";kt[n]=Function("F,a","return new F("+i.join(",")+")")}return kt[n](t,r)}return st(s,e,a)};return ze(s.prototype)&&(u.prototype=s.prototype),u},t=(Ve(Ve.P,"Function",{bind:Tt}),Je.f),e=Function.prototype,Ct=/^\s*function ([^ (]*)/,Ie=("name"in e||Ge&&t(e,"name",{configurable:!0,get:function(){try{return(""+this).match(Ct)[1]}catch(e){return""}}}),He("hasInstance")),t=Function.prototype,It=(Ie in t||Je.f(t,Ie,{value:function(e){if("function"!=typeof this||!ze(e))return!1;if(!ze(this.prototype))return e instanceof this;for(;e=ht(e);)if(this.prototype===e)return!0;return!1}}),"\t\n\v\f\r \u2028\u2029\ufeff"),e="["+It+"]",xt=RegExp("^"+e+e+"*"),Pt=RegExp(e+e+"*$"),Mt=ct.trim=function(e,t){return e=String(F(e)),1&t&&(e=e.replace(xt,"")),2&t?e.replace(Pt,""):e},t=ct,Ot=Fe.parseInt,Rt=t.trim,jt=/^[-+]?0[xX]/,Ie=8!==Ot(It+"08")||22!==Ot(It+"0x16")?function(e,t){return e=Rt(String(e),3),Ot(e,t>>>0||(jt.test(e)?16:10))}:Ot,Dt=(Ve(Ve.G+Ve.F*(parseInt!=Ie),{parseInt:Ie}),Fe.parseFloat),Nt=t.trim,e=1/Dt(It+"-0")!=-1/0?function(e){var t=Nt(String(e),3);return 0===(e=Dt(t))&&"-"==t.charAt(0)?-0:e}:Dt,Lt=(Ve(Ve.G+Ve.F*(parseFloat!=e),{parseFloat:e}),wt.set),n=it.f,$t=ot.f,Bt=Je.f,Ut=t.trim,Ft="Number",zt=Yt=Fe[Ft],Vt=Yt.prototype,Ht=$(rt(Vt))==Ft,qt="trim"in String.prototype;if(!Yt(" 0o1")||!Yt("0b1")||Yt("+0x1")){for(var Wt,Yt=function(e){var e=arguments.length<1?0:e,t=this;return t instanceof Yt&&(Ht?Ue(function(){Vt.valueOf.call(t)}):$(t)!=Ft)?ut(new zt(lt(e)),t,Yt):lt(e)},Gt=Ge?n(zt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Kt=0;Gt.length>Kt;Kt++)Be(zt,Wt=Gt[Kt])&&!Be(Yt,Wt)&&Bt(Yt,Wt,$t(zt,Wt));(Yt.prototype=Vt).constructor=Yt,x(Fe,Ft,Yt)}function Jt(e,t){if("number"!=typeof e&&"Number"!=$(e))throw TypeError(t);return+e}function Qt(e){var t=String(F(this)),n="",r=tt(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}function Xt(e,t){for(var n=-1,r=t;++n<6;)r+=e*an[n],an[n]=r%1e7,r=on(r/1e7)}function Zt(e){for(var t=6,n=0;0<=--t;)n+=an[t],an[t]=on(n/e),n=n%e*1e7}function en(){for(var e,t=6,n="";0<=--t;)""===n&&0!==t&&0===an[t]||(e=String(an[t]),n=""===n?e:n+Qt.call("0",7-e.length)+e);return n}function tn(e,t,n){return 0===t?n:t%2==1?tn(e,t-1,n*e):tn(e*e,t/2,n)}function nn(e){return!ze(e)&&isFinite(e)&&ln(e)===e}var rn=1..toFixed,on=Math.floor,an=[0,0,0,0,0,0],sn="Number.toFixed: incorrect invocation!",cn=(Ve(Ve.P+Ve.F*(!!rn&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0))||!Ue(function(){rn.call({})})),"Number",{toFixed:function(e){var t,n,r=Jt(this,sn),i=tt(e),o="",e="0";if(i<0||20<i)throw RangeError(sn);if(r!=r)return"NaN";if(r<=-1e21||1e21<=r)return String(r);if(r<0&&(o="-",r=-r),1e-21<r)if(r=(n=function(e){for(var t=0,n=e;4096<=n;)t+=12,n/=4096;for(;2<=n;)t+=1,n/=2;return t}(r*tn(2,69,1))-69)<0?r*tn(2,-n,1):r/tn(2,n,1),r*=4503599627370496,0<(n=52-n)){for(Xt(0,r),t=i;7<=t;)Xt(1e7,0),t-=7;for(Xt(tn(10,t,1),0),t=n-1;23<=t;)Zt(1<<23),t-=23;Zt(1<<t),Xt(1,1),Zt(2),e=en()}else Xt(0,r),Xt(1<<-n,0),e=en()+Qt.call("0",i);return 0<i?o+((n=e.length)<=i?"0."+Qt.call("0",i-n)+e:e.slice(0,n-i)+"."+e.slice(n-i)):o+e}}),1..toPrecision),un=(Ve(Ve.P+Ve.F*(Ue(function(){return"1"!==cn.call(1,void 0)})||!Ue(function(){cn.call({})})),"Number",{toPrecision:function(e){var t=Jt(this,"Number#toPrecision: incorrect invocation!");return void 0===e?cn.call(t):cn.call(t,e)}}),Ve(Ve.S,"Number",{EPSILON:Math.pow(2,-52)}),Fe.isFinite),ln=(Ve(Ve.S,"Number",{isFinite:function(e){return"number"==typeof e&&un(e)}}),Math.floor),dn=(Ve(Ve.S,"Number",{isInteger:nn}),Ve(Ve.S,"Number",{isNaN:function(e){return e!=e}}),Math.abs),fn=(Ve(Ve.S,"Number",{isSafeInteger:function(e){return nn(e)&&dn(e)<=9007199254740991}}),Ve(Ve.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),Ve(Ve.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),Ve(Ve.S+Ve.F*(Number.parseFloat!=e),"Number",{parseFloat:e}),Ve(Ve.S+Ve.F*(Number.parseInt!=Ie),"Number",{parseInt:Ie}),Math.log1p||function(e){return-1e-8<(e=+e)&&e<1e-8?e-e*e/2:Math.log(1+e)}),pn=Math.sqrt,n=Math.acosh,e=(Ve(Ve.S+Ve.F*!(n&&710==Math.floor(n(Number.MAX_VALUE))&&n(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:94906265.62425156<e?Math.log(e)+Math.LN2:fn(e-1+pn(e-1)*pn(e+1))}}),Math.asinh);Ve(Ve.S+Ve.F*!(e&&0<1/e(0)),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});function hn(o){return function(e,t){var n,r=String(F(e)),i=tt(t),e=r.length;return i<0||e<=i?o?"":void 0:(t=r.charCodeAt(i))<55296||56319<t||i+1===e||(n=r.charCodeAt(i+1))<56320||57343<n?o?r.charAt(i):t:o?r.slice(i,i+2):n-56320+(t-55296<<10)+65536}}function mn(e,t,n){e.prototype=rt(Fn,{next:Qe(1,n)}),B(e,t+" Iterator")}function gn(){return this}function vn(l,e,t,d,n,f,p){function r(e){if(!Vn&&e in s)return s[e];switch(e){case"keys":case Hn:return function(){return new t(this,e)}}return function(){return new t(this,e)}}mn(t,e,d);var i,o,a,h=e+" Iterator",m=n==Hn,g=!1,s=l.prototype,c=s[zn]||s["@@iterator"]||n&&s[n],u=c||r(n),v=n?m?r("entries"):u:void 0;if((d="Array"==e&&s.entries||c)&&(a=ht(d.call(new l)))!==Object.prototype&&a.next&&(B(a,h,!0),"function"==typeof a[zn]||Xe(a,zn,gn)),m&&c&&c.name!==Hn&&(g=!0,u=function(){return c.call(this)}),!Vn&&!g&&s[zn]||Xe(s,zn,u),Un[e]=u,Un[h]=gn,n)if(i={values:m?u:r(Hn),keys:f?u:r("keys"),entries:v},p)for(o in i)o in s||x(s,o,i[o]);else Ve(Ve.P+Ve.F*(Vn||g),e,i);return i}function yn(e){var t;return ze(e)&&(void 0!==(t=e[Yn])?!!t:"RegExp"==$(e))}function bn(e,t,n){if(yn(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(F(e))}function _n(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[Gn]=!1,!"/./"[t](n)}catch(e){}}return!0}function wn(e,t,n,r){var i=String(F(e)),e="<"+t;return""!==n&&(e+=" "+n+'="'+String(r).replace(Zn,"&quot;")+'"'),e+">"+i+"</"+t+">"}function Sn(t,e){var n={};n[t]=e(wn),Ve(Ve.P+Ve.F*Ue(function(){var e=""[t]('"');return e!==e.toLowerCase()||3<e.split('"').length}),"String",n)}function En(e){return 9<e?e:"0"+e}function An(e,t,n,r){try{return r?t(S(n)[0],n[1]):t(n)}catch(t){throw void 0!==(n=e.return)&&S(n.call(e)),t}}function kn(e){return void 0!==e&&(Un.Array===e||ar[or]===e)}function Tn(e,t,n){t in e?Je.f(e,t,Qe(0,n)):e[t]=n}var Ie=Math.atanh,Cn=(Ve(Ve.S+Ve.F*!(Ie&&1/Ie(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}}),Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}),In=(Ve(Ve.S,"Math",{cbrt:function(e){return Cn(e=+e)*Math.pow(Math.abs(e),1/3)}}),Ve(Ve.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}}),Math.exp),n=(Ve(Ve.S,"Math",{cosh:function(e){return(In(e=+e)+In(-e))/2}}),Math.expm1),xn=!n||22025.465794806718<n(10)||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n,e=(Ve(Ve.S+Ve.F*(xn!=Math.expm1),"Math",{expm1:xn}),Math.pow),Pn=e(2,-52),Mn=e(2,-23),On=e(2,127)*(2-Mn),Rn=e(2,-126),jn=Math.fround||function(e){var t=Math.abs(e),n=Cn(e);return t<Rn?n*(t/Rn/Mn+1/Pn-1/Pn)*Rn*Mn:On<(t=(e=(1+Mn/Pn)*t)-(e-t))||t!=t?n*(1/0):n*t},Dn=(Ve(Ve.S,"Math",{fround:jn}),Math.abs),Nn=(Ve(Ve.S,"Math",{hypot:function(e,t){for(var n,r,i=0,o=0,a=arguments.length,s=0;o<a;)s<(n=Dn(arguments[o++]))?(i=i*(r=s/n)*r+1,s=n):i+=0<n?(r=n/s)*r:n;return s===1/0?1/0:s*Math.sqrt(i)}}),Math.imul),Ln=(Ve(Ve.S+Ve.F*Ue(function(){return-5!=Nn(4294967295,5)||2!=Nn.length}),"Math",{imul:function(e,t){var n=+e,r=+t;return 0|(e=65535&n)*(t=65535&r)+((65535&n>>>16)*t+e*(65535&r>>>16)<<16>>>0)}}),Ve(Ve.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),Ve(Ve.S,"Math",{log1p:fn}),Ve(Ve.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),Ve(Ve.S,"Math",{sign:Cn}),Math.exp),$n=(Ve(Ve.S+Ve.F*Ue(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(xn(e)-xn(-e))/2:(Ln(e-1)-Ln(-e-1))*(Math.E/2)}}),Math.exp),Bn=(Ve(Ve.S,"Math",{tanh:function(e){var t=xn(e=+e),n=xn(-e);return t==1/0?1:n==1/0?-1:(t-n)/($n(e)+$n(-e))}}),Ve(Ve.S,"Math",{trunc:function(e){return(0<e?Math.floor:Math.ceil)(e)}}),String.fromCharCode),Ie=String.fromCodePoint,Un=(Ve(Ve.S+Ve.F*(!!Ie&&1!=Ie.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;i<r;){if(t=+arguments[i++],qe(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?Bn(t):Bn(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}}),Ve(Ve.S,"String",{raw:function(e){for(var t=z(e.raw),n=nt(t.length),r=arguments.length,i=[],o=0;o<n;)i.push(String(t[o++])),o<r&&i.push(String(arguments[o]));return i.join("")}}),t("trim",function(e){return function(){return e(this,3)}}),{}),Fn={},zn=(Xe(Fn,He("iterator"),function(){return this}),He("iterator")),Vn=!([].keys&&"next"in[].keys()),Hn="values",qn=hn(!0),Wn=(vn(String,"String",function(e){this._t=String(e),this._i=0},function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=qn(e,t),this._i+=t.length,{value:t,done:!1})}),hn(!1)),Yn=(Ve(Ve.P,"String",{codePointAt:function(e){return Wn(this,e)}}),He("match")),Gn=He("match"),Kn="endsWith",Jn=""[Kn],Qn=(Ve(Ve.P+Ve.F*_n(Kn),"String",{endsWith:function(e){var t=bn(this,e,Kn),n=1<arguments.length?arguments[1]:void 0,r=nt(t.length),r=void 0===n?r:Math.min(nt(n),r),e=String(e);return Jn?Jn.call(t,e,r):t.slice(r-e.length,r)===e}}),Ve(Ve.P+Ve.F*_n("includes"),"String",{includes:function(e){return!!~bn(this,e,"includes").indexOf(e,1<arguments.length?arguments[1]:void 0)}}),Ve(Ve.P,"String",{repeat:Qt}),"startsWith"),Xn=""[Qn],Zn=(Ve(Ve.P+Ve.F*_n(Qn),"String",{startsWith:function(e){var t=bn(this,e,Qn),n=nt(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),e=String(e);return Xn?Xn.call(t,e,n):t.slice(n,n+e.length)===e}}),/"/g),er=(Sn("anchor",function(t){return function(e){return t(this,"a","name",e)}}),Sn("big",function(e){return function(){return e(this,"big","","")}}),Sn("blink",function(e){return function(){return e(this,"blink","","")}}),Sn("bold",function(e){return function(){return e(this,"b","","")}}),Sn("fixed",function(e){return function(){return e(this,"tt","","")}}),Sn("fontcolor",function(t){return function(e){return t(this,"font","color",e)}}),Sn("fontsize",function(t){return function(e){return t(this,"font","size",e)}}),Sn("italics",function(e){return function(){return e(this,"i","","")}}),Sn("link",function(t){return function(e){return t(this,"a","href",e)}}),Sn("small",function(e){return function(){return e(this,"small","","")}}),Sn("strike",function(e){return function(){return e(this,"strike","","")}}),Sn("sub",function(e){return function(){return e(this,"sub","","")}}),Sn("sup",function(e){return function(){return e(this,"sup","","")}}),Ve(Ve.S,"Date",{now:function(){return(new Date).getTime()}}),Ve(Ve.P+Ve.F*Ue(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=Ye(this),n=Ke(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}}),Date.prototype.getTime),tr=Date.prototype.toISOString,n=Ue(function(){return"0385-07-25T07:06:39.999Z"!=tr.call(new Date(-5e13-1))})||!Ue(function(){tr.call(new Date(NaN))})?function(){if(!isFinite(er.call(this)))throw RangeError("Invalid time value");var e=this.getUTCFullYear(),t=this.getUTCMilliseconds(),n=e<0?"-":9999<e?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+En(this.getUTCMonth()+1)+"-"+En(this.getUTCDate())+"T"+En(this.getUTCHours())+":"+En(this.getUTCMinutes())+":"+En(this.getUTCSeconds())+"."+(99<t?t:"0"+En(t))+"Z"}:tr,e=(Ve(Ve.P+Ve.F*(Date.prototype.toISOString!==n),"Date",{toISOString:n}),Date.prototype),nr="Invalid Date",rr=e.toString,ir=e.getTime,Ie=(new Date(NaN)+""!=nr&&x(e,"toString",function(){var e=ir.call(this);return e==e?rr.call(this):nr}),He("toPrimitive")),n=Date.prototype,or=(Ie in n||Xe(n,Ie,function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return Ke(S(this),"number"!=e)}),Ve(Ve.S,"Array",{isArray:ne}),He("iterator")),ar=Array.prototype,sr=He("iterator"),cr=y.getIteratorMethod=function(e){if(null!=e)return e[sr]||e["@@iterator"]||Un[at(e)]},ur=He("iterator"),lr=!1;try{var dr=[7][ur]();dr.return=function(){lr=!0},Array.from(dr,function(){throw 2})}catch(e){}function fr(e,t){if(!t&&!lr)return!1;var n=!1;try{var r=[7],i=r[ur]();i.next=function(){return{done:n=!0}},r[ur]=function(){return i},e(r)}catch(e){}return n}function pr(e,t){return!!e&&Ue(function(){t?e.call(null,function(){},1):e.call(null)})}Ve(Ve.S+Ve.F*!fr(function(e){Array.from(e)}),"Array",{from:function(e){var u,t,n,r,i=Ye(e),o="function"==typeof this?this:Array,l=arguments.length,a=1<l?arguments[1]:void 0,s=void 0!==a,c=0,e=cr(i);if(s&&(a=et(a,2<l?arguments[2]:void 0,2)),null==e||o==Array&&kn(e))for(t=new o(u=nt(i.length));c<u;c++)Tn(t,c,s?a(i[c],c):i[c]);else for(r=e.call(i),t=new o;!(n=r.next()).done;c++)Tn(t,c,s?An(r,a,[n.value,c],!0):n.value);return t.length=c,t}}),Ve(Ve.S+Ve.F*Ue(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);e<t;)Tn(n,e,arguments[e++]);return n.length=t,n}});function hr(e,t){return new(Cr(e))(t)}function mr(d,e){var f=1==d,p=2==d,h=3==d,m=4==d,g=6==d,v=5==d||g,y=e||hr;return function(e,t,n){for(var r,i,o=Ye(e),a=U(o),l=et(t,n,3),s=nt(a.length),c=0,u=f?y(e,s):p?y(e,0):void 0;c<s;c++)if((v||c in a)&&(i=l(r=a[c],c,o),d))if(f)u[c]=i;else if(i)switch(d){case 3:return!0;case 5:return r;case 6:return c;case 2:u.push(r)}else if(m)return!1;return g?-1:h||m?m:u}}function gr(e,t,n,r,i){P(t);var o=Ye(e),a=U(o),s=nt(o.length),c=i?s-1:0,u=i?-1:1;if(n<2)for(;;){if(c in a){r=a[c],c+=u;break}if(c+=u,i?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;i?0<=c:c<s;c+=u)c in a&&(r=t(r,a[c],c,o));return r}function vr(e){Ur[Br][e]=!0}function yr(e){for(var t=Ye(this),n=nt(t.length),r=arguments.length,i=qe(1<r?arguments[1]:void 0,n),o=void 0===(r=2<r?arguments[2]:void 0)?n:qe(r,n);i<o;)t[i++]=e;return t}function br(e){e=Fe[e],Ge&&e&&!e[qr]&&Je.f(e,qr,{configurable:!0,get:function(){return this}})}function _r(e,t){return{value:t,done:!!e}}function wr(){var e=S(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}var Sr=[].join,Er=(Ve(Ve.P+Ve.F*(U!=Object||!pr(Sr)),"Array",{join:function(e){return Sr.call(z(this),void 0===e?",":e)}}),[].slice),Ar=(Ve(Ve.P+Ve.F*Ue(function(){ie&&Er.call(ie)}),"Array",{slice:function(e,t){var n=nt(this.length),r=$(this);if(t=void 0===t?n:t,"Array"==r)return Er.call(this,e,t);for(var i=qe(e,n),n=qe(t,n),o=nt(n-i),a=new Array(o),s=0;s<o;s++)a[s]="String"==r?this.charAt(i+s):this[i+s];return a}}),[].sort),kr=[1,2,3],Tr=(Ve(Ve.P+Ve.F*(Ue(function(){kr.sort(void 0)})||!Ue(function(){kr.sort(null)})||!pr(Ar)),"Array",{sort:function(e){return void 0===e?Ar.call(Ye(this)):Ar.call(Ye(this),P(e))}}),He("species")),Cr=function(e){var t;return ne(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!ne(t.prototype)||(t=void 0),ze(t)&&null===(t=t[Tr])&&(t=void 0)),void 0===t?Array:t},Ir=mr(0),e=pr([].forEach,!0),xr=(Ve(Ve.P+Ve.F*!e,"Array",{forEach:function(e){return Ir(this,e,arguments[1])}}),mr(1)),Pr=(Ve(Ve.P+Ve.F*!pr([].map,!0),"Array",{map:function(e){return xr(this,e,arguments[1])}}),mr(2)),Mr=(Ve(Ve.P+Ve.F*!pr([].filter,!0),"Array",{filter:function(e){return Pr(this,e,arguments[1])}}),mr(3)),Or=(Ve(Ve.P+Ve.F*!pr([].some,!0),"Array",{some:function(e){return Mr(this,e,arguments[1])}}),mr(4)),Rr=(Ve(Ve.P+Ve.F*!pr([].every,!0),"Array",{every:function(e){return Or(this,e,arguments[1])}}),Ve(Ve.P+Ve.F*!pr([].reduce,!0),"Array",{reduce:function(e){return gr(this,e,arguments.length,arguments[1],!1)}}),Ve(Ve.P+Ve.F*!pr([].reduceRight,!0),"Array",{reduceRight:function(e){return gr(this,e,arguments.length,arguments[1],!0)}}),We(!1)),jr=[].indexOf,Dr=!!jr&&1/[1].indexOf(1,-0)<0,Nr=(Ve(Ve.P+Ve.F*(Dr||!pr(jr)),"Array",{indexOf:function(e){return Dr?jr.apply(this,arguments)||0:Rr(this,e,arguments[1])}}),[].lastIndexOf),Lr=!!Nr&&1/[1].lastIndexOf(1,-0)<0,$r=(Ve(Ve.P+Ve.F*(Lr||!pr(Nr)),"Array",{lastIndexOf:function(e){if(Lr)return Nr.apply(this,arguments)||0;var t=z(this),n=nt(t.length),r=n-1;for((r=1<arguments.length?Math.min(r,tt(arguments[1])):r)<0&&(r=n+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}}),[].copyWithin||function(e,t){var n=Ye(this),r=nt(n.length),i=qe(e,r),o=qe(t,r),t=2<arguments.length?arguments[2]:void 0,a=Math.min((void 0===t?r:qe(t,r))-o,r-i),s=1;for(o<i&&i<o+a&&(s=-1,o+=a-1,i+=a-1);0<a--;)o in n?n[i]=n[o]:delete n[i],i+=s,o+=s;return n}),Br=He("unscopables"),Ur=Array.prototype,Fr=(null==Ur[Br]&&Xe(Ur,Br,{}),Ve(Ve.P,"Array",{copyWithin:$r}),vr("copyWithin"),Ve(Ve.P,"Array",{fill:yr}),vr("fill"),mr(5)),zr=!0,Vr=("find"in[]&&Array(1).find(function(){zr=!1}),Ve(Ve.P+Ve.F*zr,"Array",{find:function(e){return Fr(this,e,1<arguments.length?arguments[1]:void 0)}}),vr("find"),mr(6)),n="findIndex",Hr=!0,qr=(n in[]&&Array(1)[n](function(){Hr=!1}),Ve(Ve.P+Ve.F*Hr,"Array",{findIndex:function(e){return Vr(this,e,1<arguments.length?arguments[1]:void 0)}}),vr(n),He("species")),Wr=(br("Array"),vn(Array,"Array",function(e,t){this._t=z(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,_r(1)):_r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values")),Yr=(Un.Arguments=Un.Array,vr("keys"),vr("values"),vr("entries"),Je.f),Ie=it.f,Gr=Zr=Fe.RegExp,Kr=Zr.prototype,Jr=/a/g,Qr=/a/g,Xr=new Zr(Jr)!==Jr;if(Ge&&(!Xr||Ue(function(){return Qr[He("match")]=!1,Zr(Jr)!=Jr||Zr(Qr)==Qr||"/a/i"!=Zr(Jr,"i")}))){for(var Zr=function(e,t){var n=this instanceof Zr,r=yn(e),i=void 0===t;return!n&&r&&e.constructor===Zr&&i?e:ut(Xr?new Gr(r&&!i?e.source:e,t):Gr((r=e instanceof Zr)?e.source:e,r&&i?wr.call(e):t),n?this:Kr,Zr)},ei=Ie(Gr),ti=0;ei.length>ti;)!function(t){t in Zr||Yr(Zr,t,{configurable:!0,get:function(){return Gr[t]},set:function(e){Gr[t]=e}})}(ei[ti++]);(Kr.constructor=Zr).prototype=Kr,x(Fe,"RegExp",Zr)}br("RegExp");function ni(e){x(RegExp.prototype,hi,e,!0)}function ri(e,t,n){return t+(n?gi(e,t).length:1)}function ii(e,t){var n=e.exec;if("function"==typeof n){if("object"!=typeof(n=n.call(e,t)))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==at(e))throw new TypeError("RegExp#exec called on incompatible receiver");return vi.call(e,t)}function oi(n,e,t){var o,r,i=He(n),a=!Ue(function(){var e={};return e[i]=function(){return 7},7!=""[n](e)}),s=a?!Ue(function(){var e=!1,t=/a/;return t.exec=function(){return e=!0,null},"split"===n&&(t.constructor={},t.constructor[yi]=function(){return t}),t[i](""),!e}):void 0;a&&s&&("replace"!==n||bi)&&("split"!==n||_i)||(o=/./[i],t=(s=t(F,i,""[n],function(e,t,n,r,i){return t.exec===pi?a&&!i?{done:!0,value:o.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}))[0],r=s[1],x(String.prototype,n,t),Xe(RegExp.prototype,i,2==e?function(e,t){return r.call(e,this,t)}:function(e){return r.call(e,this)}))}function ai(e,t){var n;return void 0===(e=S(e).constructor)||null==(n=S(e)[Ti])?t:P(n)}var si,ci=RegExp.prototype.exec,ui=String.prototype.replace,dr=ci,li="lastIndex",di=(e=/a/,n=/b*/g,ci.call(e,"a"),ci.call(n,"a"),0!==e[li]||0!==n[li]),fi=void 0!==/()??/.exec("")[1],pi=dr=di||fi?function(e){var t,n,r,i;return fi&&(n=new RegExp("^"+this.source+"$(?!\\s)",wr.call(this))),di&&(t=this[li]),r=ci.call(this,e),di&&r&&(this[li]=this.global?r.index+r[0].length:t),fi&&r&&1<r.length&&ui.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}:dr,hi=(Ve({target:"RegExp",proto:!0,forced:pi!==/./.exec},{exec:pi}),Ge&&"g"!=/./g.flags&&Je.f(RegExp.prototype,"flags",{configurable:!0,get:wr}),"toString"),mi=/./[hi],gi=(Ue(function(){return"/a/b"!=mi.call({source:"a",flags:"b"})})?ni(function(){var e=S(this);return"/".concat(e.source,"/","flags"in e?e.flags:!Ge&&e instanceof RegExp?wr.call(e):void 0)}):mi.name!=hi&&ni(function(){return mi.call(this)}),hn(!0)),vi=RegExp.prototype.exec,yi=He("species"),bi=!Ue(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),_i=(si=(Ie=/(?:)/).exec,Ie.exec=function(){return si.apply(this,arguments)},2===(Ie="ab".split(Ie)).length&&"a"===Ie[0]&&"b"===Ie[1]),wi=(oi("match",1,function(r,i,c,u){return[function(e){var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t=u(c,e,this);if(t.done)return t.value;var n=S(e),r=String(this);if(!n.global)return ii(n,r);for(var i=n.unicode,o=[],a=n.lastIndex=0;null!==(s=ii(n,r));){var s=String(s[0]);""===(o[a]=s)&&(n.lastIndex=ri(r,nt(n.lastIndex),i)),a++}return 0===a?null:o}]}),Math.max),Si=Math.min,Ei=Math.floor,Ai=/\$([$&`']|\d\d?|<[^>]*>)/g,ki=/\$([$&`']|\d\d?)/g,Ti=(oi("replace",2,function(i,o,_,w){return[function(e,t){var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):_.call(String(n),e,t)},function(l,e){var d=w(_,l,this,e);if(d.done)return d.value;var t=S(l),n=String(this),f="function"==typeof e;f||(e=String(e));var p,h=t.global;h&&(p=t.unicode,t.lastIndex=0);for(var r=[];null!==(s=ii(t,n))&&(r.push(s),h);)""===String(s[0])&&(t.lastIndex=ri(n,nt(t.lastIndex),p));for(var i,m="",o=0,a=0;a<r.length;a++){for(var s=r[a],g=String(s[0]),c=wi(Si(tt(s.index),n.length),0),v=[],y=1;y<s.length;y++)v.push(void 0===(i=s[y])?i:String(i));var b,u=s.groups,u=f?(b=[g].concat(v,c,n),void 0!==u&&b.push(u),String(e.apply(void 0,b))):function(o,a,s,c,u,e){var l=s+o.length,d=c.length,t=ki;return void 0!==u&&(u=Ye(u),t=Ai),_.call(e,t,function(e,t){var n;switch(t.charAt(0)){case"$":return"$";case"&":return o;case"`":return a.slice(0,s);case"'":return a.slice(l);case"<":n=u[t.slice(1,-1)];break;default:var r,i=+t;if(0==i)return e;if(d<i)return 0!==(r=Ei(i/10))&&r<=d?void 0===c[r-1]?t.charAt(1):c[r-1]+t.charAt(1):e;n=c[i-1]}return void 0===n?"":n})}(g,n,c,v,u,e);o<=c&&(m+=n.slice(o,c)+u,o=c+g.length)}return m+n.slice(o)}]}),oi("search",1,function(r,i,o,a){return[function(e){var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},function(e){if((n=a(o,e,this)).done)return n.value;var t=S(e),n=String(this),e=t.lastIndex;return _t(e,0)||(t.lastIndex=0),n=ii(t,n),_t(t.lastIndex,e)||(t.lastIndex=e),null===n?-1:n.index}]}),He("species")),Ci=Math.min,Ii=[].push,xi="split",Pi="length",Mi="lastIndex",Oi=4294967295,Ri=!Ue(function(){RegExp(Oi,"y")});oi("split",2,function(i,o,h,m){var g="c"=="abbc"[xi](/(b)*/)[1]||4!="test"[xi](/(?:)/,-1)[Pi]||2!="ab"[xi](/(?:ab)*/)[Pi]||4!="."[xi](/(.?)(.?)/)[Pi]||1<"."[xi](/()()/)[Pi]||""[xi](/.?/)[Pi]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!yn(e))return h.call(n,e,t);for(var r,i,o,a=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),s=0,c=void 0===t?Oi:t>>>0,u=new RegExp(e.source,l+"g");(r=pi.call(u,n))&&!(s<(i=u[Mi])&&(a.push(n.slice(s,r.index)),1<r[Pi]&&r.index<n[Pi]&&Ii.apply(a,r.slice(1)),o=r[0][Pi],s=i,a[Pi]>=c));)u[Mi]===r.index&&u[Mi]++;return s===n[Pi]?!o&&u.test("")||a.push(""):a.push(n.slice(s)),a[Pi]>c?a.slice(0,c):a}:"0"[xi](void 0,0)[Pi]?function(e,t){return void 0===e&&0===t?[]:h.call(this,e,t)}:h;return[function(e,t){var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):g.call(String(n),e,t)},function(e,t){if((i=m(g,e,this,t,g!==h)).done)return i.value;var n=S(e),r=String(this),i=ai(n,RegExp),l=n.unicode,e=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(Ri?"y":"g"),o=new i(Ri?n:"^(?:"+n.source+")",e),a=void 0===t?Oi:t>>>0;if(0==a)return[];if(0===r.length)return null===ii(o,r)?[r]:[];for(var s=0,c=0,u=[];c<r.length;){o.lastIndex=Ri?c:0;var d,f=ii(o,Ri?r:r.slice(c));if(null===f||(d=Ci(nt(o.lastIndex+(Ri?0:c)),r.length))===s)c=ri(r,c,l);else{if(u.push(r.slice(s,c)),u.length===a)return u;for(var p=1;p<=f.length-1;p++)if(u.push(f[p]),u.length===a)return u;c=s=d}}return u.push(r.slice(s)),u}]});function ji(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}function Di(){var e,t=+this;Vi.hasOwnProperty(t)&&(e=Vi[t],delete Vi[t],e())}function Ni(e){Di.call(e.data)}function Li(){function e(){var e,t;for(Ki&&(e=Yi.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?a():r=void 0,e}}r=void 0,e&&e.enter()}var n,r,t,i,o,a=Ki?function(){Yi.nextTick(e)}:!Wi||Fe.navigator&&Fe.navigator.standalone?Gi&&Gi.resolve?(t=Gi.resolve(void 0),function(){t.then(e)}):function(){qi.call(Fe,e)}:(i=!0,o=document.createTextNode(""),new Wi(e).observe(o,{characterData:!0}),function(){o.data=i=!i});return function(e){e={fn:e,next:void 0},r&&(r.next=e),n||(n=e,a()),r=e}}var $i,Bi=i(function(e){var d={},f={};(e=e.exports=function(e,t,n,l,r){var i,o,a,s,r=r?function(){return e}:cr(e),c=et(n,l,t?2:1),u=0;if("function"!=typeof r)throw TypeError(e+" is not iterable!");if(kn(r)){for(i=nt(e.length);u<i;u++)if((s=t?c(S(o=e[u])[0],o[1]):c(e[u]))===d||s===f)return s}else for(a=r.call(e);!(o=a.next()).done;)if((s=An(a,c,o.value,t))===d||s===f)return s}).BREAK=d,e.RETURN=f}),Ui=Fe.process,e=Fe.setImmediate,n=Fe.clearImmediate,dr=Fe.MessageChannel,Fi=Fe.Dispatch,zi=0,Vi={},Hi="onreadystatechange",Ie=(e&&n||(e=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return Vi[++zi]=function(){st("function"==typeof e?e:Function(e),t)},$i(zi),zi},n=function(e){delete Vi[e]},"process"==$(Ui)?$i=function(e){Ui.nextTick(et(Di,e,1))}:Fi&&Fi.now?$i=function(e){Fi.now(et(Di,e,1))}:dr?(dr=(Ie=new dr).port2,Ie.port1.onmessage=Ni,$i=et(dr.postMessage,dr,1)):Fe.addEventListener&&"function"==typeof postMessage&&!Fe.importScripts?($i=function(e){Fe.postMessage(e+"","*")},Fe.addEventListener("message",Ni,!1)):$i=Hi in o("script")?function(e){ie.appendChild(o("script"))[Hi]=function(){ie.removeChild(this),Di.call(e)}}:function(e){setTimeout(et(Di,e,1),0)}),{set:e,clear:n}),qi=Ie.set,Wi=Fe.MutationObserver||Fe.WebKitMutationObserver,Yi=Fe.process,Gi=Fe.Promise,Ki="process"==$(Yi);function Ji(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=P(n),this.reject=P(r)}function Qi(e,t){return S(e),ze(t)&&t.constructor===e?t:((0,(e=lo.f(e)).resolve)(t),e.promise)}function Xi(e,t,n){for(var r in t)x(e,r,t[r],n);return e}function Zi(){}function eo(e,t){if(!ze(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}function to(e,t){var n,r=xo(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n}function no(n,l,d,f,r,t){function e(e){var n=u[e];x(u,e,"delete"==e?function(e){return!(t&&!ze(e))&&n.call(this,0===e?0:e)}:"has"==e?function(e){return!(t&&!ze(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return t&&!ze(e)?void 0:n.call(this,0===e?0:e)}:"add"==e?function(e){return n.call(this,0===e?0:e),this}:function(e,t){return n.call(this,0===e?0:e,t),this})}var i,p,h,m,o,a=Fe[n],s=a,c=r?"set":"add",u=s&&s.prototype,g={};return"function"==typeof s&&(t||u.forEach&&!Ue(function(){(new s).entries().next()}))?(p=(i=new s)[c](t?{}:-0,1)!=i,h=Ue(function(){i.has(1)}),m=fr(function(e){new s(e)}),o=!t&&Ue(function(){for(var e=new s,t=5;t--;)e[c](t,t);return!e.has(-0)}),m||(((s=l(function(e,t){return ji(e,s,n),e=ut(new a,e,s),null!=t&&Bi(t,r,e[c],e),e})).prototype=u).constructor=s),(h||o)&&(e("delete"),e("has"),r&&e("get")),(o||p)&&e(c),t&&u.clear&&delete u.clear):(s=f.getConstructor(l,n,r,c),Xi(s.prototype,d),O.NEED=!0),B(s,n),g[n]=s,Ve(Ve.G+Ve.W+Ve.F*(s!=a),g),t||f.setStrong(s,n,r),s}function ro(e){return e._l||(e._l=new io)}function io(){this.a=[]}function oo(e,t){return Do(e.a,function(e){return e[0]===t})}var ao,so,co,uo,lo={f:function(e){return new Ji(e)}},fo=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},dr=Fe.navigator,po=dr&&dr.userAgent||"",ho=Ie.set,mo=Li(),go="Promise",vo=Fe.TypeError,yo=Fe.process,e=yo&&yo.versions,bo=e&&e.v8||"",_o=Fe[go],wo="process"==at(yo),So=so=lo.f,n=!!function(){try{var e=_o.resolve(1),t=(e.constructor={})[He("species")]=function(e){e(Zi,Zi)};return(wo||"function"==typeof PromiseRejectionEvent)&&e.then(Zi)instanceof t&&0!==bo.indexOf("6.6")&&-1===po.indexOf("Chrome/66")}catch(e){}}(),Eo=function(e){var t;return!(!ze(e)||"function"!=typeof(t=e.then))&&t},Ao=function(d,t){var n;d._n||(d._n=!0,n=d._c,mo(function(){for(var i,u=d._v,l=1==d._s,e=0;n.length>e;)!function(e){var t,n,r,i,o=l?e.ok:e.fail,a=e.resolve,s=e.reject,c=e.domain;try{o?(l||(2==d._h&&(i=d,ho.call(Fe,function(){var e;wo?yo.emit("rejectionHandled",i):(e=Fe.onrejectionhandled)&&e({promise:i,reason:i._v})})),d._h=1),!0===o?t=u:(c&&c.enter(),t=o(u),c&&(c.exit(),r=!0)),t===e.promise?s(vo("Promise-chain cycle")):(n=Eo(t))?n.call(t,a,s):a(t)):s(u)}catch(e){c&&!r&&c.exit(),s(e)}}(n[e++]);d._c=[],d._n=!1,t&&!d._h&&(i=d,ho.call(Fe,function(){var e,t,n=i._v,r=ko(i);if(r&&(e=fo(function(){wo?yo.emit("unhandledRejection",n,i):(t=Fe.onunhandledrejection)?t({promise:i,reason:n}):(t=Fe.console)&&t.error&&t.error("Unhandled promise rejection",n)}),i._h=wo||ko(i)?2:1),i._a=void 0,r&&e.e)throw e.v}))}))},ko=function(e){return 1!==e._h&&0===(e._a||e._c).length},To=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Ao(t,!0))},Co=function(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw vo("Promise can't be resolved itself");(n=Eo(e))?mo(function(){var t={_w:r,_d:!1};try{n.call(e,et(Co,t,1),et(To,t,1))}catch(e){To.call(t,e)}}):(r._v=e,r._s=1,Ao(r,!1))}catch(e){To.call({_w:r,_d:!1},e)}}},Io=(n||(_o=function(e){ji(this,_o,go,"_h"),P(e),ao.call(this);try{e(et(Co,this,1),et(To,this,1))}catch(e){To.call(this,e)}},(ao=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Xi(_o.prototype,{then:function(e,t){var n=So(ai(this,_o));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=wo?yo.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Ao(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),co=function(){var e=new ao;this.promise=e,this.resolve=et(Co,e,1),this.reject=et(To,e,1)},lo.f=So=function(e){return e===_o||e===uo?new co:so(e)}),Ve(Ve.G+Ve.W+Ve.F*!n,{Promise:_o}),B(_o,go),br(go),uo=y[go],Ve(Ve.S+Ve.F*!n,go,{reject:function(e){var t=So(this);return(0,t.reject)(e),t.promise}}),Ve(Ve.S+Ve.F*!n,go,{resolve:function(e){return Qi(this,e)}}),Ve(Ve.S+Ve.F*!(n&&fr(function(e){_o.all(e).catch(Zi)})),go,{all:function(e){var a=this,t=So(a),s=t.resolve,c=t.reject,n=fo(function(){var r=[],i=0,o=1;Bi(e,!1,function(e){var t=i++,n=!1;r.push(void 0),o++,a.resolve(e).then(function(e){n||(n=!0,r[t]=e,--o||s(r))},c)}),--o||s(r)});return n.e&&c(n.v),t.promise},race:function(e){var t=this,n=So(t),r=n.reject,i=fo(function(){Bi(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),Je.f),xo=O.fastKey,Po=Ge?"_s":"size",Mo={getConstructor:function(e,i,n,r){var o=e(function(e,t){ji(e,o,i,"_i"),e._t=i,e._i=rt(null),e._f=void 0,e._l=void 0,e[Po]=0,null!=t&&Bi(t,n,e[r],e)});return Xi(o.prototype,{clear:function(){for(var e=eo(this,i),t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[Po]=0},delete:function(e){var t,n=eo(this,i),r=to(n,e);return r&&(t=r.n,e=r.p,delete n._i[r.i],r.r=!0,e&&(e.n=t),t&&(t.p=e),n._f==r&&(n._f=t),n._l==r&&(n._l=e),n[Po]--),!!r},forEach:function(e){eo(this,i);for(var t,n=et(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!to(eo(this,i),e)}}),Ge&&Io(o.prototype,"size",{get:function(){return eo(this,i)[Po]}}),o},def:function(e,t,n){var r,i=to(e,t);return i?i.v=n:(e._l=i={i:r=xo(t,!0),k:t,v:n,p:n=e._l,n:void 0,r:!1},e._f||(e._f=i),n&&(n.n=i),e[Po]++,"F"!==r&&(e._i[r]=i)),e},getEntry:to,setStrong:function(e,n,t){vn(e,n,function(e,t){this._t=eo(e,n),this._k=t,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?_r(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,_r(1))},t?"entries":"values",!t,!0),br(n)}},Oo=no("Map",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){return(e=Mo.getEntry(eo(this,"Map"),e))&&e.v},set:function(e,t){return Mo.def(eo(this,"Map"),0===e?0:e,t)}},Mo,!0),Ro=no("Set",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return Mo.def(eo(this,"Set"),e=0===e?0:e,e)}},Mo),jo=O.getWeak,Do=mr(5),No=mr(6),Lo=0,$o=(io.prototype={get:function(e){if(e=oo(this,e))return e[1]},has:function(e){return!!oo(this,e)},set:function(e,t){var n=oo(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(t){var e=No(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},{getConstructor:function(e,n,r,i){var o=e(function(e,t){ji(e,o,n,"_i"),e._t=n,e._i=Lo++,e._l=void 0,null!=t&&Bi(t,r,e[i],e)});return Xi(o.prototype,{delete:function(e){if(!ze(e))return!1;var t=jo(e);return!0===t?ro(eo(this,n)).delete(e):t&&Be(t,this._i)&&delete t[this._i]},has:function(e){if(!ze(e))return!1;var t=jo(e);return!0===t?ro(eo(this,n)).has(e):t&&Be(t,this._i)}}),o},def:function(e,t,n){var r=jo(S(t),!0);return!0===r?ro(e).set(t,n):r[e._i]=n,e},ufstore:ro}),dr=i(function(e){function t(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}}var i,n=mr(0),r=!Fe.ActiveXObject&&"ActiveXObject"in Fe,o="WeakMap",a=O.getWeak,s=Object.isExtensible,c=$o.ufstore,u={get:function(e){var t;if(ze(e))return!0===(t=a(e))?c(eo(this,o)).get(e):t?t[this._i]:void 0},set:function(e,t){return $o.def(eo(this,o),e,t)}},l=e.exports=no(o,t,u,$o,!0,!0);r&&(i=$o.getConstructor(t,o),bt(i.prototype,u),O.NEED=!0,n(["delete","has","get","set"],function(n){var e=l.prototype,r=e[n];x(e,n,function(e,t){return!ze(e)||s(e)?r.call(this,e,t):(this._f||(this._f=new i),t=this._f[n](e,t),"set"==n?this:t)})}))});no("WeakSet",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return $o.def(eo(this,"WeakSet"),e,!0)}},$o,!1,!0);for(var Bo,Uo=Ze("typed_array"),Fo=Ze("view"),e=!(!Fe.ArrayBuffer||!Fe.DataView),zo=e,Vo=0,Ho="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");Vo<9;)(Bo=Fe[Ho[Vo++]])?(Xe(Bo.prototype,Uo,!0),Xe(Bo.prototype,Fo,!0)):zo=!1;function qo(e){if(void 0===e)return 0;var t=tt(e);if(t!==(e=nt(t)))throw RangeError("Wrong length!");return e}function Wo(e){this._t=S(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)}var Yo={ABV:e,CONSTR:zo,TYPED:Uo,VIEW:Fo},Go=i(function(c,u){var d=it.f,p=Je.f,t="ArrayBuffer",i="DataView",r="prototype",h="Wrong index!",o=Fe[t],a=Fe[i],e=Fe.Math,m=Fe.RangeError,g=Fe.Infinity,v=o,y=e.abs,f=e.pow,b=e.floor,_=e.log,w=e.LN2,S="byteLength",e="byteOffset",E=Ge?"_b":"buffer",l=Ge?"_l":S,A=Ge?"_o":e;function k(e,t,n){var r,i,o=new Array(n),a=8*n-t-1,s=(1<<a)-1,c=s>>1,l=23===t?f(2,-24)-f(2,-77):0,u=0,d=e<0||0===e&&1/e<0?1:0;for((e=y(e))!=e||e===g?(i=e!=e?1:0,r=s):(r=b(_(e)/w),e*(n=f(2,-r))<1&&(r--,n*=2),2<=(e+=1<=r+c?l/n:l*f(2,1-c))*n&&(r++,n/=2),s<=r+c?(i=0,r=s):1<=r+c?(i=(e*n-1)*f(2,t),r+=c):(i=e*f(2,c-1)*f(2,t),r=0));8<=t;o[u++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;0<a;o[u++]=255&r,r/=256,a-=8);return o[--u]|=128*d,o}function T(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=n-1,u=127&(n=e[c--]);for(n>>=7;0<s;u=256*u+e[c],c--,s-=8);for(r=u&(1<<-s)-1,u>>=-s,s+=t;0<s;r=256*r+e[c],c--,s-=8);if(0===u)u=1-a;else{if(u===o)return r?NaN:n?-g:g;r+=f(2,t),u-=a}return(n?-1:1)*r*f(2,u-t)}function C(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function I(e){return[255&e]}function x(e){return[255&e,e>>8&255]}function P(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function M(e){return k(e,52,8)}function O(e){return k(e,23,4)}function R(e,t,n){p(e[r],t,{get:function(){return this[n]}})}function n(e,t,n,r){var i=qo(+n);if(i+t>e[l])throw m(h);return n=e[E]._b,e=i+e[A],t=n.slice(e,e+t),r?t:t.reverse()}function s(e,t,n,r,i,o){if((n=qo(+n))+t>e[l])throw m(h);for(var a=e[E]._b,s=n+e[A],c=r(+i),u=0;u<t;u++)a[s+u]=c[o?u:t-u-1]}if(Yo.ABV){if(!Ue(function(){o(1)})||!Ue(function(){new o(-1)})||Ue(function(){return new o,new o(1.5),new o(NaN),o.name!=t})){for(var j,D=(o=function(e){return ji(this,o),new v(qo(e))})[r]=v[r],N=d(v),L=0;N.length>L;)(j=N[L++])in o||Xe(o,j,v[j]);D.constructor=o}var D=new a(new o(2)),$=a[r].setInt8;D.setInt8(0,2147483648),D.setInt8(1,2147483649),!D.getInt8(0)&&D.getInt8(1)||Xi(a[r],{setInt8:function(e,t){$.call(this,e,t<<24>>24)},setUint8:function(e,t){$.call(this,e,t<<24>>24)}},!0)}else o=function(e){ji(this,o,t),e=qo(e),this._b=yr.call(new Array(e),0),this[l]=e},a=function(e,t,n){ji(this,a,i),ji(e,o,i);var r=e[l];if((t=tt(t))<0||r<t)throw m("Wrong offset!");if(r<t+(n=void 0===n?r-t:nt(n)))throw m("Wrong length!");this[E]=e,this[A]=t,this[l]=n},Ge&&(R(o,S,"_l"),R(a,"buffer","_b"),R(a,S,"_l"),R(a,e,"_o")),Xi(a[r],{getInt8:function(e){return n(this,1,e)[0]<<24>>24},getUint8:function(e){return n(this,1,e)[0]},getInt16:function(e){return((e=n(this,2,e,arguments[1]))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=n(this,2,e,arguments[1]))[1]<<8|e[0]},getInt32:function(e){return C(n(this,4,e,arguments[1]))},getUint32:function(e){return C(n(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return T(n(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return T(n(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){s(this,1,e,I,t)},setUint8:function(e,t){s(this,1,e,I,t)},setInt16:function(e,t){s(this,2,e,x,t,arguments[2])},setUint16:function(e,t){s(this,2,e,x,t,arguments[2])},setInt32:function(e,t){s(this,4,e,P,t,arguments[2])},setUint32:function(e,t){s(this,4,e,P,t,arguments[2])},setFloat32:function(e,t){s(this,4,e,O,t,arguments[2])},setFloat64:function(e,t){s(this,8,e,M,t,arguments[2])}});B(o,t),B(a,i),Xe(a[r],Yo.VIEW,!0),u[t]=o,u[i]=a}),n=Fe.ArrayBuffer,Ko=Go.ArrayBuffer,Jo=Go.DataView,Qo=Yo.ABV&&n.isView,Xo=Ko.prototype.slice,Zo=Yo.VIEW,e="ArrayBuffer",n=(Ve(Ve.G+Ve.W+Ve.F*(n!==Ko),{ArrayBuffer:Ko}),Ve(Ve.S+Ve.F*!Yo.CONSTR,e,{isView:function(e){return Qo&&Qo(e)||ze(e)&&Zo in e}}),Ve(Ve.P+Ve.U+Ve.F*Ue(function(){return!new Ko(2).slice(1,void 0).byteLength}),e,{slice:function(e,t){if(void 0!==Xo&&void 0===t)return Xo.call(S(this),e);for(var n=S(this).byteLength,r=qe(e,n),i=qe(void 0===t?n:t,n),n=new(ai(this,Ko))(nt(i-r)),o=new Jo(this),a=new Jo(n),s=0;r<i;)a.setUint8(s++,o.getUint8(r++));return n}}),br(e),Ve(Ve.G+Ve.W+Ve.F*!Yo.ABV,{DataView:Go.DataView}),i(function(i){var y,p,h,b,d,_,o,m,s,c,w,S,u,l,f,E,g,A,k,T,C,I,x,P,M,O,R,j,D,N,L,$,B,U,F,z,V,e,H,q,W,Y,G,K,J,Q,X,Z,ee,te,ne,re,ie,oe,ae,se,ce,ue,le,de,fe,pe,he,me,ge,ve,ye,t,be,_e,we,Se,Ee,Ae,ke,a,Te,Ce,Ie,n,xe,Pe,Me,Oe,Re,je,De,Ne,Le,$e,r,v;Ge?(p=Ue,h=Ve,b=Yo,d=et,_=ji,o=Qe,m=Xe,s=Xi,c=tt,w=nt,S=qo,u=qe,l=Ke,f=Be,E=at,g=ze,A=Ye,k=kn,T=rt,C=ht,I=it.f,x=cr,$e=Ze,n=He,r=mr,P=We,M=ai,O=Wr,R=Un,j=fr,D=br,N=yr,L=$r,U=($=Je).f,F=(B=ot).f,z=(y=Fe).RangeError,V=y.TypeError,e=y.Uint8Array,q="Shared"+(H="ArrayBuffer"),W="BYTES_PER_ELEMENT",Y="prototype",t=Array[Y],G=Go.ArrayBuffer,K=Go.DataView,J=r(0),Q=r(2),X=r(3),Z=r(4),ee=r(5),te=r(6),ne=P(!0),re=P(!1),ie=O.values,oe=O.keys,ae=O.entries,se=t.lastIndexOf,ce=t.reduce,ue=t.reduceRight,le=t.join,de=t.sort,fe=t.slice,pe=t.toString,he=t.toLocaleString,me=n("iterator"),ge=n("toStringTag"),ve=$e("typed_constructor"),ye=$e("def_constructor"),t=b.CONSTR,be=b.TYPED,_e=b.VIEW,we="Wrong length!",Se=r(1,function(e,t){return Te(M(e,e[ye]),t)}),Ee=p(function(){return 1===new e(new Uint16Array([1]).buffer)[0]}),Ae=!!e&&!!e[Y].set&&p(function(){new e(1).set({})}),ke=function(e,t){if((e=c(e))<0||e%t)throw z("Wrong offset!");return e},a=function(e){if(g(e)&&be in e)return e;throw V(e+" is not a typed array!")},Te=function(e,t){if(!(g(e)&&ve in e))throw V("It is not a typed array constructor!");return new e(t)},Ce=function(e,t){return Ie(M(e,e[ye]),t)},Ie=function(e,t){for(var n=0,r=t.length,i=Te(e,r);n<r;)i[n]=t[n++];return i},n=function(e,t,n){U(e,t,{get:function(){return this._d[n]}})},xe=function(e){var t,n,r,i,o,a,s=A(e),u=arguments.length,c=1<u?arguments[1]:void 0,l=void 0!==c,e=x(s);if(null!=e&&!k(e)){for(a=e.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(l&&2<u&&(c=d(c,arguments[2],2)),t=0,n=w(s.length),i=Te(this,n);t<n;t++)i[t]=l?c(s[t],t):s[t];return i},Pe=function(){for(var e=0,t=arguments.length,n=Te(this,t);e<t;)n[e]=arguments[e++];return n},Me=!!e&&p(function(){he.call(new e(1))}),Oe=function(){return he.apply(Me?fe.call(a(this)):a(this),arguments)},Re={copyWithin:function(e,t){return L.call(a(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return Z(a(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return N.apply(a(this),arguments)},filter:function(e){return Ce(this,Q(a(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return ee(a(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return te(a(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){J(a(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return re(a(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ne(a(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return le.apply(a(this),arguments)},lastIndexOf:function(e){return se.apply(a(this),arguments)},map:function(e){return Se(a(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return ce.apply(a(this),arguments)},reduceRight:function(e){return ue.apply(a(this),arguments)},reverse:function(){for(var e,t=a(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return X(a(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return de.call(a(this),e)},subarray:function(e,t){var n=a(this),r=n.length,e=u(e,r);return new(M(n,n[ye]))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,w((void 0===t?r:u(t,r))-e))}},je=function(e,t){return Ce(this,fe.call(a(this),e,t))},De=function(e){a(this);var t=ke(arguments[1],1),n=this.length,r=A(e),i=w(r.length),o=0;if(n<i+t)throw z(we);for(;o<i;)this[t+o]=r[o++]},Ne={entries:function(){return ae.call(a(this))},keys:function(){return oe.call(a(this))},values:function(){return ie.call(a(this))}},Le=function(e,t){return g(e)&&e[be]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},$e=function(e,t){return Le(e,t=l(t,!0))?o(2,e[t]):F(e,t)},r=function(e,t,n){return!(Le(e,t=l(t,!0))&&g(n)&&f(n,"value"))||f(n,"get")||f(n,"set")||n.configurable||f(n,"writable")&&!n.writable||f(n,"enumerable")&&!n.enumerable?U(e,t,n):(e[t]=n.value,e)},t||(B.f=$e,$.f=r),h(h.S+h.F*!t,"Object",{getOwnPropertyDescriptor:$e,defineProperty:r}),p(function(){pe.call({})})&&(pe=he=function(){return le.call(this)}),v=s({},Re),s(v,Ne),m(v,me,Ne.values),s(v,{slice:je,set:De,constructor:function(){},toString:pe,toLocaleString:Oe}),n(v,"buffer","b"),n(v,"byteOffset","o"),n(v,"byteLength","l"),n(v,"length","e"),U(v,ge,{get:function(){return this[be]}}),i.exports=function(e,u,t,i){function f(e,r){U(e,r,{get:function(){return(e=(e=this)._d).v[s](r*u+e.o,Ee);var e},set:function(e){return n=r,e=e,t=(t=this)._d,i&&(e=(e=Math.round(e))<0?0:255<e?255:255&e),void t.v[c](n*u+t.o,e,Ee);var t,n},enumerable:!0})}var l=e+((i=!!i)?"Clamped":"")+"Array",s="get"+e,c="set"+e,d=y[l],o=d||{},n=d&&C(d),r=!d||!b.ABV,e={},a=d&&d[Y];r?(d=t(function(e,t,n,r){_(e,d,l,"_d");var i,o,a=0,s=0;if(g(t)){if(!(t instanceof G||(c=E(t))==H||c==q))return be in t?Ie(d,t):xe.call(d,t);var c=t,s=ke(n,u),n=t.byteLength;if(void 0===r){if(n%u)throw z(we);if((i=n-s)<0)throw z(we)}else if(n<(i=w(r)*u)+s)throw z(we);o=i/u}else o=S(t),c=new G(i=o*u);for(m(e,"_d",{b:c,o:s,l:i,e:o,v:new K(c)});a<o;)f(e,a++)}),a=d[Y]=T(v),m(a,"constructor",d)):p(function(){d(1)})&&p(function(){new d(-1)})&&j(function(e){new d,new d(null),new d(1.5),new d(e)},!0)||(d=t(function(e,t,n,r){var i;return _(e,d,l),g(t)?t instanceof G||(i=E(t))==H||i==q?void 0!==r?new o(t,ke(n,u),r):void 0!==n?new o(t,ke(n,u)):new o(t):be in t?Ie(d,t):xe.call(d,t):new o(S(t))}),J(n!==Function.prototype?I(o).concat(I(n)):I(o),function(e){e in d||m(d,e,o[e])}),(d[Y]=a).constructor=d),t=!!(r=a[me])&&("values"==r.name||null==r.name),n=Ne.values,m(d,ve,!0),m(a,be,l),m(a,_e,!0),m(a,ye,d),(i?new d(1)[ge]==l:ge in a)||U(a,ge,{get:function(){return l}}),e[l]=d,h(h.G+h.W+h.F*(d!=o),e),h(h.S,l,{BYTES_PER_ELEMENT:u}),h(h.S+h.F*p(function(){o.of.call(d,1)}),l,{from:xe,of:Pe}),W in a||m(a,W,u),h(h.P,l,Re),D(l),h(h.P+h.F*Ae,l,{set:De}),h(h.P+h.F*!t,l,Ne),a.toString==pe||(a.toString=pe),h(h.P+h.F*p(function(){new d(1).slice()}),l,{slice:je}),h(h.P+h.F*(p(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!p(function(){a.toLocaleString.call([1,2])})),l,{toLocaleString:Oe}),R[l]=t?r:n,t||m(a,me,n)}):i.exports=function(){}})),ea=(n("Int8",1,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}},!0),n("Int16",2,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Uint16",2,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Int32",4,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Uint32",4,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Float32",4,function(r){return function(e,t,n){return r(this,e,t,n)}}),n("Float64",8,function(r){return function(e,t,n){return r(this,e,t,n)}}),(Fe.Reflect||{}).apply),ta=Function.apply,na=(Ve(Ve.S+Ve.F*!Ue(function(){ea(function(){})}),"Reflect",{apply:function(e,t,n){return e=P(e),n=S(n),ea?ea(e,t,n):ta.call(e,t,n)}}),(Fe.Reflect||{}).construct),ra=Ue(function(){function e(){}return!(na(function(){},[],e)instanceof e)}),ia=!Ue(function(){na(function(){})}),oa=(Ve(Ve.S+Ve.F*(ra||ia),"Reflect",{construct:function(e,t){P(e),S(t);var n=arguments.length<3?e:P(arguments[2]);if(ia&&!ra)return na(e,t,n);if(e!=n)return r=n.prototype,n=rt(ze(r)?r:Object.prototype),r=Function.apply.call(e,n,t),ze(r)?r:n;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(Tt.apply(e,r))}}),Ve(Ve.S+Ve.F*Ue(function(){Reflect.defineProperty(Je.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){S(e),t=Ke(t,!0),S(n);try{return Je.f(e,t,n),!0}catch(e){return!1}}}),ot.f);Ve(Ve.S,"Reflect",{deleteProperty:function(e,t){var n=oa(S(e),t);return!(n&&!n.configurable)&&delete e[t]}});mn(Wo,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),Ve(Ve.S,"Reflect",{enumerate:function(e){return new Wo(e)}}),Ve(Ve.S,"Reflect",{get:function e(t,n){var r,i=arguments.length<3?t:arguments[2];return S(t)===i?t[n]:(r=ot.f(t,n))?Be(r,"value")?r.value:void 0!==r.get?r.get.call(i):void 0:ze(t=ht(t))?e(t,n,i):void 0}}),Ve(Ve.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return ot.f(S(e),t)}}),Ve(Ve.S,"Reflect",{getPrototypeOf:function(e){return ht(S(e))}}),Ve(Ve.S,"Reflect",{has:function(e,t){return t in e}});var aa=Object.isExtensible,e=(Ve(Ve.S,"Reflect",{isExtensible:function(e){return S(e),!aa||aa(e)}}),Fe.Reflect),sa=e&&e.ownKeys||function(e){var t=it.f(S(e)),n=Z.f;return n?t.concat(n(e)):t},ca=(Ve(Ve.S,"Reflect",{ownKeys:sa}),Object.preventExtensions);Ve(Ve.S,"Reflect",{preventExtensions:function(e){S(e);try{return ca&&ca(e),!0}catch(e){return!1}}}),Ve(Ve.S,"Reflect",{set:function e(t,n,r){var i,o=arguments.length<4?t:arguments[3],a=ot.f(S(t),n);if(!a){if(ze(i=ht(t)))return e(i,n,r,o);a=Qe(0)}if(Be(a,"value")){if(!1===a.writable||!ze(o))return!1;if(i=ot.f(o,n)){if(i.get||i.set||!1===i.writable)return!1;i.value=r,Je.f(o,n,i)}else Je.f(o,n,Qe(0,r));return!0}return void 0!==a.set&&(a.set.call(o,r),!0)}}),wt&&Ve(Ve.S,"Reflect",{setPrototypeOf:function(e,t){wt.check(e,t);try{return wt.set(e,t),!0}catch(e){return!1}}});var ua=We(!0),la=(Ve(Ve.P,"Array",{includes:function(e){return ua(this,e,1<arguments.length?arguments[1]:void 0)}}),vr("includes"),He("isConcatSpreadable"));function da(e,t,n,r){var i=String(F(e)),e=i.length,n=void 0===n?" ":String(n);return(t=nt(t))<=e||""==n?i:(e=t-e,(n=Qt.call(n,Math.ceil(e/n.length))).length>e&&(n=n.slice(0,e)),r?n+i:i+n)}function fa(e,t){this._r=e,this._s=t}function pa(s){return function(e){for(var t,n=z(e),r=X(n),i=r.length,o=0,a=[];o<i;)t=r[o++],Ge&&!Ma.call(n,t)||a.push(s?[t,n[t]]:n[t]);return a}}function ha(e,t){var n=[];return Bi(e,!1,n.push,n,t),n}function ma(e){return function(){if(at(this)!=e)throw TypeError(e+"#toJSON isn't generic");return ha(this)}}function ga(e){Ve(Ve.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}function va(e){Ve(Ve.S,e,{from:function(e){var t,n,r,i,o=arguments[1];return P(this),(t=void 0!==o)&&P(o),null==e?new this:(n=[],t?(r=0,i=et(o,arguments[2],2),Bi(e,!1,function(e){n.push(i(e,r++))})):Bi(e,!1,n.push,n),new this(n))}})}function ya(e,t,n){var r=Ba.get(e);if(!r){if(!n)return;Ba.set(e,r=new Oo)}if(!(e=r.get(t))){if(!n)return;r.set(t,e=new Oo)}return e}function ba(e,t,n){return qa(e,t,n)?Wa(e,t,n):null!==(t=ht(t))?ba(e,t,n):void 0}function _a(e,t){var n=Ga(e,t);return null!==(e=ht(e))&&(t=_a(e,t)).length?n.length?ha(new Ro(n.concat(t))):t:n}function wa(e,t,n){return!!es(e,t,n)||null!==(t=ht(t))&&wa(e,t,n)}function Sa(e){return null==e?void 0:P(e)}function Ea(e){var t=e._c;t&&(e._c=void 0,t())}function Aa(e){return void 0===e._o}function ka(e){Aa(e)||(e._o=void 0,Ea(e))}function Ta(e,t){S(e),this._c=void 0,this._o=e,e=new fs(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:P(n),this._c=n)}catch(t){return void e.error(t)}Aa(this)&&Ea(this)}function Ca(i){return function(e,t){var n=2<arguments.length,r=n&&hs.call(arguments,2);return i(n?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,t)}}var Ia=function l(e,t,n,d,f,r,i,p){for(var o,a,s=f,c=0,u=!!i&&et(i,p,3);c<d;){if(c in n){if(o=u?u(n[c],c,t):n[c],a=!1,(a=ze(o)?void 0!==(a=o[la])?!!a:ne(o):a)&&0<r)s=l(e,t,o,nt(o.length),s,r-1)-1;else{if(9007199254740991<=s)throw TypeError();e[s]=o}s++}c++}return s},xa=(Ve(Ve.P,"Array",{flatMap:function(e){var t,n,r=Ye(this);return P(e),t=nt(r.length),n=hr(r,0),Ia(n,r,r,t,0,1,e,arguments[1]),n}}),vr("flatMap"),Ve(Ve.P,"Array",{flatten:function(){var e=arguments[0],t=Ye(this),n=nt(t.length),r=hr(t,0);return Ia(r,t,t,n,0,void 0===e?1:tt(e)),r}}),vr("flatten"),hn(!0)),n=(Ve(Ve.P,"String",{at:function(e){return xa(this,e)}}),/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(po)),e=(Ve(Ve.P+Ve.F*n,"String",{padStart:function(e){return da(this,e,1<arguments.length?arguments[1]:void 0,!0)}}),/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(po)),Pa=(Ve(Ve.P+Ve.F*e,"String",{padEnd:function(e){return da(this,e,1<arguments.length?arguments[1]:void 0,!1)}}),t("trimLeft",function(e){return function(){return e(this,1)}},"trimStart"),t("trimRight",function(e){return function(){return e(this,2)}},"trimEnd"),RegExp.prototype),Ma=(mn(fa,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),Ve(Ve.P,"String",{matchAll:function(e){if(F(this),!yn(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in Pa?String(e.flags):wr.call(e);return(n=new RegExp(e.source,~n.indexOf("g")?n:"g"+n)).lastIndex=nt(e.lastIndex),new fa(n,t)}}),a("asyncIterator"),a("observable"),Ve(Ve.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=z(e),i=ot.f,o=sa(r),a={},s=0;o.length>s;)void 0!==(n=i(r,t=o[s++]))&&Tn(a,t,n);return a}}),ee.f),Oa=pa(!1),Ra=(Ve(Ve.S,"Object",{values:function(e){return Oa(e)}}),pa(!0)),n=(Ve(Ve.S,"Object",{entries:function(e){return Ra(e)}}),!Ue(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete Fe[e]})),ja=(Ge&&Ve(Ve.P+n,"Object",{__defineGetter__:function(e,t){Je.f(Ye(this),e,{get:P(t),enumerable:!0,configurable:!0})}}),Ge&&Ve(Ve.P+n,"Object",{__defineSetter__:function(e,t){Je.f(Ye(this),e,{set:P(t),enumerable:!0,configurable:!0})}}),ot.f),Da=(Ge&&Ve(Ve.P+n,"Object",{__lookupGetter__:function(e){var t,n=Ye(this),r=Ke(e,!0);do{if(t=ja(n,r))return t.get}while(n=ht(n))}}),ot.f),Na=(Ge&&Ve(Ve.P+n,"Object",{__lookupSetter__:function(e){var t,n=Ye(this),r=Ke(e,!0);do{if(t=Da(n,r))return t.set}while(n=ht(n))}}),Ve(Ve.P+Ve.R,"Map",{toJSON:ma("Map")}),Ve(Ve.P+Ve.R,"Set",{toJSON:ma("Set")}),ga("Map"),ga("Set"),ga("WeakMap"),ga("WeakSet"),va("Map"),va("Set"),va("WeakMap"),va("WeakSet"),Ve(Ve.G,{global:Fe}),Ve(Ve.S,"System",{global:Fe}),Ve(Ve.S,"Error",{isError:function(e){return"Error"===$(e)}}),Ve(Ve.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}}),Ve(Ve.S,"Math",{DEG_PER_RAD:Math.PI/180}),180/Math.PI),La=(Ve(Ve.S,"Math",{degrees:function(e){return e*Na}}),Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}),$a=(Ve(Ve.S,"Math",{fscale:function(e,t,n,r,i){return jn(La(e,t,n,r,i))}}),Ve(Ve.S,"Math",{iaddh:function(e,t,n,r){return(t>>>0)+(r>>>0)+(((e>>>=0)&(n>>>=0)|(e|n)&~(e+n>>>0))>>>31)|0}}),Ve(Ve.S,"Math",{isubh:function(e,t,n,r){return(t>>>0)-(r>>>0)-((~(e>>>=0)&(n>>>=0)|~(e^n)&e-n>>>0)>>>31)|0}}),Ve(Ve.S,"Math",{imulh:function(e,t){var n=+e,r=+t,e=65535&n,t=65535&r;return(n=n>>16)*(r=r>>16)+((t=(n*t>>>0)+(e*t>>>16))>>16)+((e*r>>>0)+(65535&t)>>16)}}),Ve(Ve.S,"Math",{RAD_PER_DEG:180/Math.PI}),Math.PI/180),e=(Ve(Ve.S,"Math",{radians:function(e){return e*$a}}),Ve(Ve.S,"Math",{scale:La}),Ve(Ve.S,"Math",{umulh:function(e,t){var n=+e,r=+t,e=65535&n,t=65535&r;return(n=n>>>16)*(r=r>>>16)+((t=(n*t>>>0)+(e*t>>>16))>>>16)+((e*r>>>0)+(65535&t)>>>16)}}),Ve(Ve.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:0<e}}),Ve(Ve.P+Ve.R,"Promise",{finally:function(t){var n=ai(this,y.Promise||Fe.Promise),e="function"==typeof t;return this.then(e?function(e){return Qi(n,t()).then(function(){return e})}:t,e?function(e){return Qi(n,t()).then(function(){throw e})}:t)}}),Ve(Ve.S,"Promise",{try:function(e){var t=lo.f(this);return((e=fo(e)).e?t.reject:t.resolve)(e.v),t.promise}}),T("metadata")),Ba=e.store||(e.store=new dr),t={store:Ba,map:ya,has:function(e,t,n){return void 0!==(n=ya(t,n,!1))&&n.has(e)},get:function(e,t,n){return void 0===(n=ya(t,n,!1))?void 0:n.get(e)},set:function(e,t,n,r){ya(n,r,!0).set(e,t)},keys:function(e,t){var t=ya(e,t,!1),n=[];return t&&t.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){Ve(Ve.S,"Reflect",e)}},Ua=t.key,Fa=t.set,za=(t.exp({defineMetadata:function(e,t,n,r){Fa(e,t,S(n),Ua(r))}}),t.key),Va=t.map,Ha=t.store,qa=(t.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:za(arguments[2]),r=Va(S(t),n,!1);return!(void 0===r||!r.delete(e))&&(!!r.size||((r=Ha.get(t)).delete(n),!!r.size||Ha.delete(t)))}}),t.has),Wa=t.get,Ya=t.key,Ga=(t.exp({getMetadata:function(e,t){return ba(e,S(t),arguments.length<3?void 0:Ya(arguments[2]))}}),t.keys),Ka=t.key,Ja=(t.exp({getMetadataKeys:function(e){return _a(S(e),arguments.length<2?void 0:Ka(arguments[1]))}}),t.get),Qa=t.key,Xa=(t.exp({getOwnMetadata:function(e,t){return Ja(e,S(t),arguments.length<3?void 0:Qa(arguments[2]))}}),t.keys),Za=t.key,es=(t.exp({getOwnMetadataKeys:function(e){return Xa(S(e),arguments.length<2?void 0:Za(arguments[1]))}}),t.has),ts=t.key,ns=(t.exp({hasMetadata:function(e,t){return wa(e,S(t),arguments.length<3?void 0:ts(arguments[2]))}}),t.has),rs=t.key,is=(t.exp({hasOwnMetadata:function(e,t){return ns(e,S(t),arguments.length<3?void 0:rs(arguments[2]))}}),t.key),os=t.set,as=(t.exp({metadata:function(n,r){return function(e,t){os(n,r,(void 0!==t?S:P)(e),is(t))}}}),Li()),ss=Fe.process,cs="process"==$(ss),us=(Ve(Ve.G,{asap:function(e){var t=cs&&ss.domain;as(t?t.bind(e):e)}}),Li()),ls=He("observable"),ds=Bi.RETURN,fs=(Ta.prototype=Xi({},{unsubscribe:function(){ka(this)}}),function(e){this._s=e}),ps=(fs.prototype=Xi({},{next:function(e){var t=this._s;if(!Aa(t)){var n=t._o;try{var r=Sa(n.next);if(r)return r.call(n,e)}catch(e){try{ka(t)}finally{throw e}}}},error:function(e){var t=this._s;if(Aa(t))throw e;var n=t._o;t._o=void 0;try{var r=Sa(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{Ea(t)}finally{throw e}}return Ea(t),e},complete:function(e){var t=this._s;if(!Aa(t)){var n=t._o;t._o=void 0;try{var r=Sa(n.complete);e=r?r.call(n,e):void 0}catch(e){try{Ea(t)}finally{throw e}}return Ea(t),e}}}),function(e){ji(this,ps,"Observable","_f")._f=P(e)}),hs=(Xi(ps.prototype,{subscribe:function(e){return new Ta(e,this._f)},forEach:function(r){var i=this;return new(y.Promise||Fe.Promise)(function(e,t){P(r);var n=i.subscribe({next:function(e){try{return r(e)}catch(e){t(e),n.unsubscribe()}},error:t,complete:e})})}}),Xi(ps,{from:function(e){var t,n="function"==typeof this?this:ps,r=Sa(S(e)[ls]);return r?(t=S(r.call(e))).constructor===n?t:new n(function(e){return t.subscribe(e)}):new n(function(t){var n=!1;return us(function(){if(!n){try{if(Bi(e,!1,function(e){if(t.next(e),n)return ds})===ds)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:ps)(function(t){var n=!1;return us(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),Xe(ps.prototype,ls,function(){return this}),Ve(Ve.G,{Observable:ps}),br("Observable"),[].slice),n=/MSIE .\./.test(po);Ve(Ve.G+Ve.B+Ve.F*n,{setTimeout:Ca(Fe.setTimeout),setInterval:Ca(Fe.setInterval)}),Ve(Ve.G+Ve.B,{setImmediate:Ie.set,clearImmediate:Ie.clear});for(var ms=He("iterator"),gs=He("toStringTag"),vs=Un.Array,ys={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},bs=X(ys),_s=0;_s<bs.length;_s++){var ws,Ss=bs[_s],Es=ys[Ss],As=Fe[Ss],ks=As&&As.prototype;if(ks&&(ks[ms]||Xe(ks,ms,vs),ks[gs]||Xe(ks,gs,Ss),Un[Ss]=vs,Es))for(ws in Wr)ks[ws]||x(ks,ws,Wr[ws],!0)}i(function(e){function a(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof p?t:p,t=Object.create(t.prototype),r=new y(r||[]);return t._invoke=(i=e,o=n,a=r,s=w,function(e,t){if(s===E)throw new Error("Generator is already running");if(s===u){if("throw"===e)throw t;return _()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){var r=function e(t,n){var r=t.iterator[n.method];if(r!==c)return"throw"===(r=f(r,t.iterator,n.arg)).type?(n.method="throw",n.arg=r.arg,n.delegate=null,l):(r=r.arg)?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=c),n.delegate=null,l):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,l);if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=c,e(t,n),"throw"===n.method))return l;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}(n,a);if(r){if(r===l)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===w)throw s=u,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);if(s=E,"normal"===(r=f(i,o,a)).type){if(s=a.done?u:S,r.arg!==l)return{value:r.arg,done:a.done}}else"throw"===r.type&&(s=u,a.method="throw",a.arg=r.arg)}}),t}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function p(){}function s(){}function t(){}function h(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function m(o){function a(e,t,n,r){var i;if("throw"!==(e=f(o[e],o,t)).type)return(t=(i=e.arg).value)&&"object"==typeof t&&d.call(t,"__await")?Promise.resolve(t.__await).then(function(e){a("next",e,n,r)},function(e){a("throw",e,n,r)}):Promise.resolve(t).then(function(e){i.value=e,n(i)},r);r(e.arg)}var t;"object"==typeof r.process&&r.process.domain&&(a=r.process.domain.bind(a)),this._invoke=function(n,r){function e(){return new Promise(function(e,t){a(n,r,e,t)})}return t=t?t.then(e,e):e()}}function g(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function v(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(g,this),this.reset(!0)}function b(t){if(t){var n,e=t[k];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(d.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=c,e.done=!0,e}).next=e}return{next:_}}function _(){return{value:c,done:!0}}var c,w,S,E,u,l,n,o,r="object"==typeof I?I:"object"==typeof window?window:"object"==typeof self?self:I,A=Object.prototype,d=A.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},k=i.iterator||"@@iterator",T=i.asyncIterator||"@@asyncIterator",C=i.toStringTag||"@@toStringTag";(o=r.regeneratorRuntime)?e.exports=o:((o=r.regeneratorRuntime=e.exports).wrap=a,w="suspendedStart",S="suspendedYield",E="executing",u="completed",l={},(e={})[k]=function(){return this},(i=(i=Object.getPrototypeOf)&&i(i(b([]))))&&i!==A&&d.call(i,k)&&(e=i),n=t.prototype=p.prototype=Object.create(e),(s.prototype=n.constructor=t).constructor=s,t[C]=s.displayName="GeneratorFunction",o.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===s||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,t):(e.__proto__=t,C in e||(e[C]="GeneratorFunction")),e.prototype=Object.create(n),e},o.awrap=function(e){return{__await:e}},h(m.prototype),m.prototype[T]=function(){return this},o.AsyncIterator=m,o.async=function(e,t,n,r){var i=new m(a(e,t,n,r));return o.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},h(n),n[C]="Generator",n[k]=function(){return this},n.toString=function(){return"[object Generator]"},o.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=b,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(v),!e)for(var t in this)"t"===t.charAt(0)&&d.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=d.call(i,"catchLoc"),s=d.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&d.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),v(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,v(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=c),l}})});Ts=/[\\^$*+?.()|[\]{}]/g,Is=(Cs="\\$&")===Object(Cs)?function(e){return Cs[e]}:Cs;var Ts,Cs,Is,xs=function(e){return String(e).replace(Ts,Is)};if(Ve(Ve.S,"RegExp",{escape:function(e){return xs(e)}}),I._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");I._babelPolyfill=!0;function Ps(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}Ps(String.prototype,"padLeft","".padStart),Ps(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&Ps(Array,e,Function.call.bind([][e]))});function Ms(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Os,Rs,js,Ds,Ns,Ls,$s,Bs,Us,Fs,e=function(e,t,n){return t&&oc(e.prototype,t),n&&oc(e,n),e},zs=(e(ic,[{key:"set",value:function(e){this._id=(e=e||{})._id||null,this.segment=e.segment||null,this.course=e.course||null,this.timeWatched=e.timeWatched||null,this.timestamp=e.timestamp||Math.floor(Date.now()/1e3),this.broadcastType=e.broadcastType||null}},{key:"toObject",value:function(){return Object.assign({},this)}}]),ic),Vs=(e(rc,[{key:"get",value:function(){return r.values(this.index)}},{key:"set",value:function(e){var t=this;if(Array.isArray(e))return r.each(e,function(e){e=new zs(e),t.index[e.id]=e}),this}},{key:"toJson",value:function(){var e="";try{e=JSON.stringify(this.get())}catch(e){}return e}}]),rc),Hs=(e(nc,[{key:"get",value:function(){return(this.cacheService.get(this.__cacheKey)||[]).map(function(e){return new zs(e)})}},{key:"set",value:function(e){var t=new zs(e);(e=this.get()).push(t),this.cacheService.set(this.__cacheKey,e,this.__cacheConfig)}},{key:"flush",value:function(){this.cacheService.set(this.__cacheKey,[],this.__cacheConfig)}},{key:"getByUser",value:function(e){return r.findWhere(this.get(),{user:e})}},{key:"getBySegment",value:function(e){return r.findWhere(this.get(),{segment:e})}},{key:"getByCourse",value:function(e){return r.findWhere(this.get(),{course:e})}},{key:"toJson",value:function(){var e="";try{e=JSON.stringify(this.get())}catch(e){}return e}}]),nc),qs=(e(tc,[{key:"resume",value:function(){this.running=!0}},{key:"pause",value:function(){this.running=!1}},{key:"cancel",value:function(){this.running=!1,clearInterval(this.interval)}}]),tc),Ws=(e(ec,[{key:"init",value:function(e){return this.model=e,this}},{key:"start",value:function(){this.running?this.interval.resume():(this.running=!0,this.interval=new qs(this.monitor.bind(this),this.__intervalRate))}},{key:"stop",value:function(){this.running&&(this.interval.cancel(),this.interval=null,this.running=!1)}},{key:"pause",value:function(){this.running&&this.interval.pause()}},{key:"monitor",value:function(){this.running&&(this.model?this.cache.set(this.model.toObject()):this.stop())}}]),ec),Ys=(e(Zs,[{key:"start",value:function(){this.running?this.interval.resume():(this.running=!0,this.interval=new qs(this.sync.bind(this),this.__syncRate))}},{key:"stop",value:function(){this.running&&(this.interval.cancel(),this.interval=null,this.running=!1)}},{key:"pause",value:function(){this.running&&this.interval.pause()}},{key:"sync",value:function(){var t=this,e=this.collector.collect();return 0===e.get().length?Promise.resolve():(this.__syncKeyFunc&&(this.__syncOptions.headers.Authorization="Bearer "+this.__syncKeyFunc()),this.http(this.__syncUrl,r.extend({},this.__syncOptions,{body:e.toJson()})).then(function(e){return t.cache.flush(),e.text}))}}]),Zs),Gs=(e(Xs,[{key:"collect",value:function(){var n=this,e=r.chain(this.cache.get()).groupBy(function(e){return e.segment}).map(function(e){var t=n.interval*e.length,e=r.first(e);return new zs({segment:e.segment,course:e.course,broadcastType:e.broadcastType,timeWatched:t,timestamp:e.timestamp})}).value();return new Vs(e)}}]),Xs),Ks=wc("@creativelive/vault.js"),Js=(e(Qs,[{key:"init",value:function(e){return this.model.set(e),this.monitor.init(this.model),this}},{key:"start",value:function(){this.model.broadcastType||(this.monitor.start(this.model),this.sync.start())}},{key:"stop",value:function(){this.model.broadcastType||(this.monitor.stop(),this.sync.sync(),this.sync.stop())}},{key:"pause",value:function(){this.model.broadcastType||(this.monitor.pause(),this.sync.sync(),this.sync.pause())}}]),Qs);function Qs(e,t){Ms(this,Qs);var n=e.monitor.interval,r=e.cache.ttl,i=e.sync.interval,o=e.api.url,a=e.api.keyFunc,e=new Hs(r,Ks.Local),r=new Gs(n,e);return this.monitor=new Ws(n,e),this.sync=new Ys(i,o,a,e,t,r),this.model=new zs,this}function Xs(e,t){Ms(this,Xs),this.interval=e,this.cache=t}function Zs(e,t,n,r,i,o){Ms(this,Zs),this.__syncRate=e,this.__syncUrl=t,this.__syncOptions={method:"POST",headers:{},credentials:"same-origin"},this.__syncKeyFunc=n,this.http=i,this.cache=r,this.collector=o,this.running=!1}function ec(e,t){return Ms(this,ec),this.__intervalRate=e,this.interval=null,this.cache=t,this.running=!1,this.model=null,this}function tc(e,t){var n=this;Ms(this,tc),this.running=!0,this.interval=setInterval(function(){n.running&&e()},t)}function nc(e,t){Ms(this,nc),this.__cacheKey="video-usage-cache",this.__cacheConfig={path:"/",expires:"+"+e+" Milliseconds"},this.cacheService=t}function rc(e){return Ms(this,rc),this.index={},this.set(e),this}function ic(e){Ms(this,ic),this.set(e)}function oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ac(e,t){return fetch(e,t)}function sc(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function cc(e){return"string"!=typeof e?String(e):e}function uc(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return Rs&&(e[Symbol.iterator]=function(){return e}),e}function lc(t){this.map={},t instanceof lc?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function dc(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function fc(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function pc(e){var t=new FileReader,n=fc(t);return t.readAsArrayBuffer(e),n}function hc(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function mc(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(js&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(Ds&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(Os&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(Ns&&js&&$s(e))this._bodyArrayBuffer=hc(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!Ns||!ArrayBuffer.prototype.isPrototypeOf(e)&&!Bs(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=hc(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Os&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},js&&(this.blob=function(){var e=dc(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?dc(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(pc)}),this.text=function(){var e,t,n=dc(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,n=fc(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Ds&&(this.formData=function(){return this.text().then(vc)}),this.json=function(){return this.text().then(JSON.parse)},this}function gc(e,t){var n,r=(t=t||{}).body;if(e instanceof gc){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new lc(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new lc(t.headers)),this.method=(e=(n=t.method||this.method||"GET").toUpperCase(),-1<Us.indexOf(e)?e:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function vc(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(e=(t=e.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),n.append(decodeURIComponent(e),decodeURIComponent(t)))}),n}function yc(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new lc(t.headers),this.url=t.url||"",this._initBody(e)}function bc(e){var t=e.config,n=(this.on("video-queued",function(e){n&&"function"==typeof n.stop&&n.stop(),e=(e||{}).data||{},n=null,(n=new Js(t,ac)).init({segment:e._id,course:e.course,broadcastType:e.broadcastType})}),this.on("play",function(){n.start()}),this.on("pause",i),this.on("ended",i),this.on("dispose",r),this.on("abort",r),null);function r(){n.stop()}function i(){n.pause()}}(dr="undefined"!=typeof self?self:void 0).fetch||(Os="URLSearchParams"in dr,Rs="Symbol"in dr&&"iterator"in Symbol,js="FileReader"in dr&&"Blob"in dr&&function(){try{return new Blob,!0}catch(e){return!1}}(),Ds="FormData"in dr,(Ns="ArrayBuffer"in dr)&&(Ls=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],$s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},Bs=ArrayBuffer.isView||function(e){return e&&-1<Ls.indexOf(Object.prototype.toString.call(e))}),lc.prototype.append=function(e,t){e=sc(e),t=cc(t);var n=this.map[e];this.map[e]=n?n+","+t:t},lc.prototype.delete=function(e){delete this.map[sc(e)]},lc.prototype.get=function(e){return e=sc(e),this.has(e)?this.map[e]:null},lc.prototype.has=function(e){return this.map.hasOwnProperty(sc(e))},lc.prototype.set=function(e,t){this.map[sc(e)]=cc(t)},lc.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},lc.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),uc(n)},lc.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),uc(t)},lc.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),uc(n)},Rs&&(lc.prototype[Symbol.iterator]=lc.prototype.entries),Us=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],gc.prototype.clone=function(){return new gc(this,{body:this._bodyInit})},mc.call(gc.prototype),mc.call(yc.prototype),yc.prototype.clone=function(){return new yc(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new lc(this.headers),url:this.url})},yc.error=function(){var e=new yc(null,{status:0,statusText:""});return e.type="error",e},Fs=[301,302,303,307,308],yc.redirect=function(e,t){if(-1===Fs.indexOf(t))throw new RangeError("Invalid status code");return new yc(null,{status:t,headers:{location:e}})},dr.Headers=lc,dr.Request=gc,dr.Response=yc,dr.fetch=function(n,o){return new Promise(function(r,e){var t=new gc(n,o),i=new XMLHttpRequest;i.onload=function(){var n,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",n=new lc,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":");(e=t.shift().trim())&&(t=t.join(":").trim(),n.append(e,t))}),n)},t=(e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL"),"response"in i?i.response:i.responseText);r(new yc(t,e))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.open(t.method,t.url,!0),"include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),"responseType"in i&&js&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},dr.fetch.polyfill=!0),wc("@creativelive/video.js").plugin("videoUsage",bc),Sc.exports=bc}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@creativelive/vault.js":6,"@creativelive/video.js":18,underscore:void 0}],21:[function(e,F,t){!function($,B,U){!function(){!function(){var t,g={};function v(){}function i(e){return e}function n(e){return!!e}function r(e){return!e}var o="object"==typeof self&&self.self===self&&self||"object"==typeof B&&B.global===B&&B||this;function l(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function y(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=o&&(t=o.async),g.noConflict=function(){return o.async=t,g};var a=Object.prototype.toString,b=Array.isArray||function(e){return"[object Array]"===a.call(e)};function c(e){return b(e)||"number"==typeof e.length&&0<=e.length&&e.length%1==0}function _(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function s(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function u(e){return s(Array(e),function(e,t){return t})}function S(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var E=Object.keys||function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n};function d(e){var t,n,r=-1;return c(e)?(t=e.length,function(){return++r<t?r:null}):(n=E(e),t=n.length,function(){return++r<t?n[r]:null})}function w(r,i){return i=null==i?r.length-1:+i,function(){for(var e=Math.max(arguments.length-i,0),t=Array(e),n=0;n<e;n++)t[n]=arguments[n+i];switch(i){case 0:return r.call(this,t);case 1:return r.call(this,arguments[0],t)}}}function f(r){return function(e,t,n){return r(e,n)}}var p="function"==typeof U&&U,h=p?function(e){p(e)}:function(e){setTimeout(e,0)};function m(u){return function(n,r,i){i=y(i||v);var o=d(n=n||[]);if(u<=0)return i(null);var a=!1,s=0,c=!1;!function t(){if(a&&s<=0)return i(null);for(;s<u&&!c;){var e=o();if(null===e)return a=!0,void(s<=0&&i(null));s+=1,r(n[e],e,l(function(e){--s,e?(i(e),c=!0):t()}))}}()}}function A(r){return function(e,t,n){return r(g.eachOf,e,t,n)}}function k(i){return function(e,t,n,r){return i(m(t),e,n,r)}}function T(r){return function(e,t,n){return r(g.eachOfSeries,e,t,n)}}function C(e,t,i,n){n=y(n||v);var o=c(t=t||[])?[]:{};e(t,function(e,n,r){i(e,function(e,t){o[n]=t,r(e)})},function(e){n(e,o)})}function I(e,t,i,n){var o=[];e(t,function(t,n,r){i(t,function(e){e&&o.push({index:n,value:t}),r()})},function(){n(s(o.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function x(e,t,n,r){I(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function e(a,s,c){return function(e,t,r,i){function n(){i&&i(c(!1,void 0))}function o(t,e,n){if(!i)return n();r(t,function(e){i&&s(e)&&(i(c(!0,t)),i=r=!1),n()})}3<arguments.length?a(e,t,o,n):(i=r,r=t,a(e,o,n))}}function P(e,t){return t}function M(e,t,n){n=n||v;var i=c(t)?[]:{};e(t,function(e,n,r){e(w(function(e,t){t.length<=1&&(t=t[0]),i[n]=t,r(e)}))},function(e){n(e,i)})}function O(e,t,r,n){var i=[];e(t,function(e,t,n){r(e,function(e,t){i=i.concat(t||[]),n(e)})},function(e){n(e,i)})}function R(n,e,t){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");function r(t,e,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(t.started=!0,0===(e=b(e)?e:[e]).length&&t.idle())return g.setImmediate(function(){t.drain()});_(e,function(e){e={data:e,callback:r||v};n?t.tasks.unshift(e):t.tasks.push(e),t.tasks.length===t.concurrency&&t.saturated()}),g.setImmediate(t.process)}var i=0,o=[],a={tasks:[],concurrency:e,payload:t,saturated:v,empty:v,drain:v,started:!1,paused:!1,push:function(e,t){r(a,e,!1,t)},kill:function(){a.drain=v,a.tasks=[]},unshift:function(e,t){r(a,e,!0,t)},process:function(){for(;!a.paused&&i<a.concurrency&&a.tasks.length;){var e=a.payload?a.tasks.splice(0,a.payload):a.tasks.splice(0,a.tasks.length),t=s(e,function(e){return e.data}),e=(0===a.tasks.length&&a.empty(),i+=1,o.push(e[0]),l(function(t,n){return function(){--i;var r=!1,e=arguments;_(n,function(n){_(o,function(e,t){e!==n||r||(o.splice(t,1),r=!0)}),n.callback.apply(n,e)}),t.tasks.length+i===0&&t.drain(),t.process()}}(a,e)));n(t,e)}},length:function(){return a.tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return a.tasks.length+i===0},pause:function(){a.paused=!0},resume:function(){if(!1!==a.paused){a.paused=!1;for(var e=Math.min(a.concurrency,a.tasks.length),t=1;t<=e;t++)g.setImmediate(a.process)}}};return a}function j(n){return w(function(e,t){e.apply(null,t.concat([w(function(e,t){"object"==typeof console&&(e||console[n]&&_(t,function(e){}))})]))})}function D(r){return function(e,t,n){r(u(e),t,n)}}function N(o){return w(function(t,e){var n=w(function(r){var i=this,e=r.pop();return o(t,function(e,t,n){e.apply(i,r.concat([n]))},e)});return e.length?n.apply(this,e):n})}function L(r){return w(function(e){var t=e.pop(),n=(e.push(function(){var e=arguments;n?g.setImmediate(function(){t.apply(null,e)}):t.apply(null,e)}),!0);r.apply(this,e),n=!1})}"object"==typeof $&&"function"==typeof $.nextTick?g.nextTick=$.nextTick:g.nextTick=h,g.setImmediate=p?h:g.nextTick,g.forEach=g.each=function(e,t,n){return g.eachOf(e,f(t),n)},g.forEachSeries=g.eachSeries=function(e,t,n){return g.eachOfSeries(e,f(t),n)},g.forEachLimit=g.eachLimit=function(e,t,n,r){return m(t)(e,f(n),r)},g.forEachOf=g.eachOf=function(e,t,n){n=y(n||v);for(var r,i=d(e=e||[]),o=0;null!=(r=i());)o+=1,t(e[r],r,l(a));function a(e){o--,e?n(e):null===r&&o<=0&&n(null)}0===o&&n(null)},g.forEachOfSeries=g.eachOfSeries=function(e,r,i){i=y(i||v);var o=d(e=e||[]),a=o();!function t(){var n=!0;if(null===a)return i(null);r(e[a],a,l(function(e){if(e)i(e);else{if(null===(a=o()))return i(null);n?g.setImmediate(t):t()}})),n=!1}()},g.forEachOfLimit=g.eachOfLimit=function(e,t,n,r){m(t)(e,n,r)},g.map=A(C),g.mapSeries=T(C),g.mapLimit=k(C),g.inject=g.foldl=g.reduce=function(e,r,i,t){g.eachOfSeries(e,function(e,t,n){i(r,e,function(e,t){r=t,n(e)})},function(e){t(e,r)})},g.foldr=g.reduceRight=function(e,t,n,r){e=s(e,i).reverse();g.reduce(e,t,n,r)},g.transform=function(e,r,i,t){3===arguments.length&&(t=i,i=r,r=b(e)?[]:{}),g.eachOf(e,function(e,t,n){i(r,e,t,n)},function(e){t(e,r)})},g.select=g.filter=A(I),g.selectLimit=g.filterLimit=k(I),g.selectSeries=g.filterSeries=T(I),g.reject=A(x),g.rejectLimit=k(x),g.rejectSeries=T(x),g.any=g.some=e(g.eachOf,n,i),g.someLimit=e(g.eachOfLimit,n,i),g.all=g.every=e(g.eachOf,r,r),g.everyLimit=e(g.eachOfLimit,r,r),g.detect=e(g.eachOf,i,P),g.detectSeries=e(g.eachOfSeries,i,P),g.detectLimit=e(g.eachOfLimit,i,P),g.sortBy=function(e,t,n){function r(e,t){e=e.criteria,t=t.criteria;return e<t?-1:t<e?1:0}g.map(e,function(n,r){t(n,function(e,t){e?r(e):r(null,{value:n,criteria:t})})},function(e,t){if(e)return n(e);n(null,s(t.sort(r),function(e){return e.value}))})},g.auto=function(s,c,u){"function"==typeof arguments[1]&&(u=c,c=null),u=y(u||v);var e=E(s),t=e.length;if(!t)return u(null);c=c||t;var l={},d=0,f=!1,n=[];function p(e){n.unshift(e)}function h(e){e=S(n,e);0<=e&&n.splice(e,1)}function m(){t--,_(n.slice(0),function(e){e()})}p(function(){t||u(null,l)}),_(e,function(o){if(!f){for(var e,t=b(s[o])?s[o]:[s[o]],n=w(function(e,t){var n,r,i;d--,t.length<=1&&(t=t[0]),e?(n={},i=function(e,t){n[t]=e},_(E(r=l),function(e){i(r[e],e)}),n[o]=t,f=!0,u(e,n)):(l[o]=t,g.setImmediate(m))}),a=t.slice(0,t.length-1),r=a.length;r--;){if(!(e=s[a[r]]))throw new Error("Has nonexistent dependency in "+a.join(", "));if(b(e)&&0<=S(e,o))throw new Error("Has cyclic dependencies")}i()?(d++,t[t.length-1](n,l)):p(function e(){i()&&(d++,h(e),t[t.length-1](n,l))})}function i(){return d<c&&(r=function(e,t){return e&&l.hasOwnProperty(t)},i=!0,_(a,function(e,t,n){i=r(i,e,t,n)}),i)&&!l.hasOwnProperty(o);var r,i}})},g.retry=function(e,t,n){var r=[],i={times:5,interval:0};var o=arguments.length;if(o<1||3<o)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");if(o<=2&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e){var o=i,a=e;if("number"==typeof a)o.times=parseInt(a,10)||5;else{if("object"!=typeof a)throw new Error("Unsupported argument type for 'times': "+typeof a);o.times=parseInt(a.times,10)||5,o.interval=parseInt(a.interval,10)||0}}function s(n,t){for(;i.times;){var e=!--i.times;r.push(function(e,r){return function(n){e(function(e,t){n(!e||r,{err:e,result:t})},t)}}(i.task,e)),!e&&0<i.interval&&r.push(function(t){return function(e){setTimeout(function(){e(null)},t)}}(i.interval))}g.series(r,function(e,t){t=t[t.length-1],(n||i.callback)(t.err,t.result)})}return i.callback=n,i.task=t,i.callback?s():s},g.waterfall=function(e,i){return i=y(i||v),b(e)?e.length?void function n(r){return w(function(e,t){e?i.apply(null,[e].concat(t)):((e=r.next())?t.push(n(e)):t.push(i),L(r).apply(null,t))})}(g.iterator(e))():i():(e=new Error("First argument to waterfall must be an array of functions"),i(e))},g.parallel=function(e,t){M(g.eachOf,e,t)},g.parallelLimit=function(e,t,n){M(m(t),e,n)},g.series=function(e,t){M(g.eachOfSeries,e,t)},g.iterator=function(r){return function e(t){function n(){return r.length&&r[t].apply(null,arguments),n.next()}return n.next=function(){return t<r.length-1?e(t+1):null},n}(0)},g.apply=w(function(t,n){return w(function(e){return t.apply(null,n.concat(e))})}),g.concat=A(O),g.concatSeries=T(O),g.whilst=function(n,r,i){var o;i=i||v,n()?(o=w(function(e,t){e?i(e):n.apply(this,t)?r(o):i.apply(null,[null].concat(t))}),r(o)):i(null)},g.doWhilst=function(e,t,n){var r=0;return g.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},g.until=function(e,t,n){return g.whilst(function(){return!e.apply(this,arguments)},t,n)},g.doUntil=function(e,t,n){return g.doWhilst(e,function(){return!t.apply(this,arguments)},n)},g.during=function(n,r,i){i=i||v;var o=w(function(e,t){e?i(e):(t.push(a),n.apply(this,t))}),a=function(e,t){e?i(e):t?r(o):i(null)};n(a)},g.doDuring=function(e,t,n){var r=0;g.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},g.queue=function(n,e){return R(function(e,t){n(e[0],t)},e,1)},g.priorityQueue=function(e,t){function i(e,t){return e.priority-t.priority}function r(t,e,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(t.started=!0,0===(e=b(e)?e:[e]).length)return g.setImmediate(function(){t.drain()});_(e,function(e){e={data:e,priority:n,callback:"function"==typeof r?r:v};t.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);0<=n(t,e[o])?r=o:i=o-1}return r}(t.tasks,e,i)+1,0,e),t.tasks.length===t.concurrency&&t.saturated(),g.setImmediate(t.process)})}var o=g.queue(e,t);return o.push=function(e,t,n){r(o,e,t,n)},delete o.unshift,o},g.cargo=function(e,t){return R(e,1,t)},g.log=j("log"),g.dir=j("dir"),g.memoize=function(n,r){var o={},a={},s=Object.prototype.hasOwnProperty,e=(r=r||i,w(function(e){var t=e.pop(),i=r.apply(null,e);s.call(o,i)?g.setImmediate(function(){t.apply(null,o[i])}):s.call(a,i)?a[i].push(t):(a[i]=[t],n.apply(null,e.concat([w(function(e){o[i]=e;var t=a[i];delete a[i];for(var n=0,r=t.length;n<r;n++)t[n].apply(null,e)})])))}));return e.memo=o,e.unmemoized=n,e},g.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},g.times=D(g.map),g.timesSeries=D(g.mapSeries),g.timesLimit=function(e,t,n,r){return g.mapLimit(u(e),t,n,r)},g.seq=function(){var t=arguments;return w(function(e){var r=this,n=e[e.length-1];"function"==typeof n?e.pop():n=v,g.reduce(t,e,function(e,t,n){t.apply(r,e.concat([w(function(e,t){n(e,t)})]))},function(e,t){n.apply(r,[e].concat(t))})})},g.compose=function(){return g.seq.apply(null,Array.prototype.reverse.call(arguments))},g.applyEach=N(g.eachOf),g.applyEachSeries=N(g.eachOfSeries),g.forever=function(e,t){var n=l(t||v),r=L(e);!function e(t){if(t)return n(t);r(e)}()},g.ensureAsync=L,g.constant=w(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),g.wrapSync=g.asyncify=function(i){return w(function(e){var t,n,r=e.pop();try{t=i.apply(this,e)}catch(e){return r(e)}("function"==(n=typeof(e=t))||"object"==n&&e)&&"function"==typeof t.then?t.then(function(e){r(null,e)}).catch(function(e){r(e.message?e:new Error(e))}):r(null,t)})},"object"==typeof F&&F.exports?F.exports=g:"function"==typeof define&&define.amd?define([],function(){return g}):o.async=g}()}.call(this)}.call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:1203,timers:1239}],22:[function(e,t,n){t.exports=e("./load-image"),e("./load-image-scale"),e("./load-image-meta"),e("./load-image-fetch"),e("./load-image-exif"),e("./load-image-exif-map"),e("./load-image-iptc"),e("./load-image-iptc-map"),e("./load-image-orientation")},{"./load-image":31,"./load-image-exif":24,"./load-image-exif-map":23,"./load-image-fetch":25,"./load-image-iptc":27,"./load-image-iptc-map":26,"./load-image-meta":28,"./load-image-orientation":29,"./load-image-scale":30}],23:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return t?String.fromCharCode(t[0],t[1],t[2],t[3]):void 0;case"ComponentsConfiguration":return t?this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]]:void 0;case"GPSVersionID":return t?t[0]+"."+t[1]+"."+t[2]+"."+t[3]:void 0}return String(t)};var t,n=e.ExifMap.prototype,r=n.tags,i=n.map;for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(i[r[t]]=t);e.ExifMap.prototype.getAll=function(){var e,t,n={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t=this.tags[e])&&(n[t]=this.getText(t));return n}})},{"./load-image":31,"./load-image-exif":24}],24:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-meta")):e(window.loadImage)}(function(f){"use strict";f.ExifMap=function(){return this},f.ExifMap.prototype.map={Orientation:274},f.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},f.getExifThumbnail=function(e,t,n){if(n&&!(t+n>e.byteLength))return f.createObjectURL(new Blob([e.buffer.slice(t,t+n)]))},f.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,n){return e.getUint16(t,n)},size:2},4:{getValue:function(e,t,n){return e.getUint32(t,n)},size:4},5:{getValue:function(e,t,n){return e.getUint32(t,n)/e.getUint32(t+4,n)},size:8},9:{getValue:function(e,t,n){return e.getInt32(t,n)},size:4},10:{getValue:function(e,t,n){return e.getInt32(t,n)/e.getInt32(t+4,n)},size:8}},f.exifTagTypes[7]=f.exifTagTypes[1],f.getExifValue=function(e,l,t,n,r,i){var o,a,s,c,d,u=f.exifTagTypes[n];if(u&&!((o=4<(n=u.size*r)?l+e.getUint32(t+8,i):t+8)+n>e.byteLength)){if(1===r)return u.getValue(e,o,i);for(a=[],s=0;s<r;s+=1)a[s]=u.getValue(e,o+s*u.size,i);if(u.ascii){for(c="",s=0;s<a.length&&"\0"!==(d=a[s]);s+=1)c+=d;return c}return a}},f.parseExifTag=function(e,t,n,r){return{number:e.getUint16(n,r),value:f.getExifValue(e,t,n,e.getUint16(n+2,r),e.getUint32(n+4,r),r)}},f.parseExifTags=function(e,t,n,r,i){var o,a,s,c,u;if(!(n+6>e.byteLength||(a=n+2+12*(o=e.getUint16(n,r)))+4>e.byteLength)){for(s=0;s<o;s+=1)u=this.parseExifTag(e,t,c=n+2+12*s,r,i),i.exif[u.number]=u.value,i.exifOffsets&&(i.exifOffsets[u.number]=c);return e.getUint32(a,r)}},f.parseExifData=function(e,t,n,r,i){if(!i.disableExif){var o,a=t+10;if(1165519206===e.getUint32(t+4)&&!(a+8>e.byteLength)&&0===e.getUint16(t+8)){switch(e.getUint16(a)){case 18761:o=!0;break;case 19789:o=!1;break;default:return}42===e.getUint16(a+2,o)&&(t=e.getUint32(a+4,o),r.exif=new f.ExifMap,i.disableExifOffsets||(r.exifOffsets=new f.ExifMap,r.exifTiffOffset=a,r.exifLittleEndian=o),(t=f.parseExifTags(e,a,a+t,o,r))&&!i.disableExifThumbnail&&(f.parseExifTags(e,a,a+t,o,t={exif:{}}),t.exif[513]&&(r.exif.Thumbnail=f.getExifThumbnail(e,a+t.exif[513],t.exif[514]))),r.exif[34665]&&!i.disableExifSub&&f.parseExifTags(e,a,a+r.exif[34665],o,r),r.exif[34853]&&!i.disableExifGps&&f.parseExifTags(e,a,a+r.exif[34853],o,r))}}},f.metaDataParsers.jpeg[65505].push(f.parseExifData),f.exifWriters={274:function(e,t,n){return new DataView(e,t.exifOffsets[274]+8,2).setUint16(0,n,t.exifLittleEndian),e}},f.writeExifData=function(e,t,n,r){f.exifWriters[t.exif.map[n]](e,t,r)}})},{"./load-image":31,"./load-image-meta":28}],25:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-meta")):e(window.loadImage)}(function(i){"use strict";"undefined"!=typeof fetch&&"undefined"!=typeof Request?i.fetchBlob=function(e,t,n){i.hasMetaOption(n)?fetch(new Request(e,n)).then(function(e){return e.blob()}).then(t).catch(function(e){t()}):t()}:"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof ProgressEvent&&(i.fetchBlob=function(e,t,n){var r;i.hasMetaOption(n)?(n=n||{},(r=new XMLHttpRequest).open(n.method||"GET",e),n.headers&&Object.keys(n.headers).forEach(function(e){r.setRequestHeader(e,n.headers[e])}),r.withCredentials="include"===n.credentials,r.responseType="blob",r.onload=function(){t(r.response)},r.onerror=r.onabort=r.ontimeout=function(e){t()},r.send(n.body)):t()})})},{"./load-image":31,"./load-image-meta":28}],26:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-iptc"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-iptc")):e(window.loadImage)}(function(e){"use strict";e.IptcMap.prototype.tags={3:"ObjectType",4:"ObjectAttribute",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectRef",15:"Category",20:"SupplCategory",22:"FixtureID",25:"Keywords",26:"ContentLocCode",27:"ContentLocName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"RefService",47:"RefDate",50:"RefNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"CountryName",103:"OrigTransRef",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",122:"WriterEditor",130:"ImageType",131:"ImageOrientation",135:"LanguageID"},e.IptcMap.prototype.getText=function(e){e=this.get(e);return String(e)};var t,n=e.IptcMap.prototype,r=n.tags,i=n.map||{};for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(i[r[t]]=t);e.IptcMap.prototype.getAll=function(){var e,t,n={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t=this.tags[e])&&(n[t]=this.getText(t));return n}})},{"./load-image":31,"./load-image-iptc":27}],27:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-meta")):e(window.loadImage)}(function(c){"use strict";c.IptcMap=function(){return this},c.IptcMap.prototype.map={ObjectName:5},c.IptcMap.prototype.get=function(e){return this[e]||this[this.map[e]]},c.parseIptcTags=function(e,t,n,r){for(var i,o,a=t;a<t+n;)28===e.getUint8(a)&&2===e.getUint8(a+1)&&(o=e.getUint8(a+2))in r.iptc.tags&&(i=e.getInt16(a+3),i=function(e,t,n){for(var r="",i=t;i<t+n;i++)r+=String.fromCharCode(e.getUint8(i));return r}(e,a+5,i),Object.prototype.hasOwnProperty.call(r.iptc,o)?r.iptc[o]instanceof Array?r.iptc[o].push(i):r.iptc[o]=[r.iptc[o],i]:r.iptc[o]=i),a++},c.parseIptcData=function(e,t,n,r,i){if(!i.disableIptc)for(var o=t+n;t+8<o;){if(s=t,943868237===(a=e).getUint32(s)&&1028===a.getUint16(s+4)){var a=e.getUint8(t+7),s=(a%2!=0&&(a+=1),t+8+(a=0===a?4:a));if(o<s)break;a=e.getUint16(t+6+a);if(o<t+a)break;return r.iptc=new c.IptcMap,c.parseIptcTags(e,s,a,r)}t++}},c.metaDataParsers.jpeg[65517].push(c.parseIptcData)})},{"./load-image":31,"./load-image-meta":28}],28:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof n&&n.exports?e(t("./load-image")):e(window.loadImage)}(function(p){"use strict";var e="undefined"!=typeof Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),o=(p.blobSlice=e&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},p.metaDataParsers={jpeg:{65505:[],65517:[]}},p.parseMetaData=function(e,u,l,d){d=d||{};var f=this,t=(l=l||{}).maxMetaDataSize||262144;!!("undefined"!=typeof DataView&&e&&12<=e.size&&"image/jpeg"===e.type&&p.blobSlice)&&p.readFile(p.blobSlice.call(e,0,t),function(e){if(e.target.error)u(d);else{var t,n,r,i,e=e.target.result,o=new DataView(e),a=2,s=o.byteLength-4,c=a;if(65496===o.getUint16(0)){for(;a<s&&(65504<=(t=o.getUint16(a))&&t<=65519||65534===t)&&!(a+(n=o.getUint16(a+2)+2)>o.byteLength);){if((r=p.metaDataParsers.jpeg[t])&&!l.disableMetaDataParsers)for(i=0;i<r.length;i+=1)r[i].call(f,o,a,n,d,l);c=a+=n}!l.disableImageHead&&6<c&&(e.slice?d.imageHead=e.slice(0,c):d.imageHead=new Uint8Array(e).subarray(0,c))}u(d)}},"readAsArrayBuffer")||u(d)},p.replaceHead=function(t,n,r){p.parseMetaData(t,function(e){r(new Blob([n,p.blobSlice.call(t,e.imageHead.byteLength)],{type:"image/jpeg"}))},{maxMetaDataSize:256,disableMetaDataParsers:!0})},p.hasMetaOption=function(e){return e&&e.meta},p.transform);p.transform=function(t,n,r,i,e){p.hasMetaOption(n)?p.parseMetaData(i,function(e){o.call(p,t,n,r,i,e)},n,e):o.apply(p,arguments)}})},{"./load-image":31}],29:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],e):"object"==typeof n&&n.exports?e(t("./load-image"),t("./load-image-scale"),t("./load-image-meta")):e(window.loadImage)}(function(s){"use strict";var e,t=s.hasCanvasOption,n=s.hasMetaOption,c=s.transformCoordinates,a=s.getTransformedOptions;(e=document.createElement("img")).onload=function(){s.orientation=1===e.width&&2===e.height},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==",s.hasCanvasOption=function(e){return!0==!!e.orientation&&!s.orientation||1<e.orientation&&e.orientation<9||t.call(s,e)},s.hasMetaOption=function(e){return e&&!0===e.orientation&&!s.orientation||n.call(s,e)},s.transformCoordinates=function(e,t){c.call(s,e,t);var n=e.getContext("2d"),r=e.width,i=e.height,o=e.style.width,a=e.style.height,t=t.orientation;if(1<t&&t<9)switch(4<t&&(e.width=i,e.height=r,e.style.width=a,e.style.height=o),t){case 2:n.translate(r,0),n.scale(-1,1);break;case 3:n.translate(r,i),n.rotate(Math.PI);break;case 4:n.translate(0,i),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-i);break;case 7:n.rotate(.5*Math.PI),n.translate(r,-i),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-r,0)}},s.getTransformedOptions=function(e,t,n){var r,i,o=a.call(s,e,t),e=o.orientation;if(!0===e){if(s.orientation)return o;e=n&&n.exif&&n.exif.get("Orientation")}if(!(1<e&&e<9))return o;for(i in r={},o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i]);switch(r.orientation=e){case 2:r.left=o.right,r.right=o.left;break;case 3:r.left=o.right,r.top=o.bottom,r.right=o.left,r.bottom=o.top;break;case 4:r.top=o.bottom,r.bottom=o.top;break;case 5:r.left=o.top,r.top=o.left,r.right=o.bottom,r.bottom=o.right;break;case 6:r.left=o.top,r.top=o.right,r.right=o.bottom,r.bottom=o.left;break;case 7:r.left=o.bottom,r.top=o.right,r.right=o.top,r.bottom=o.left;break;case 8:r.left=o.bottom,r.top=o.left,r.right=o.top,r.bottom=o.right}return 4<r.orientation&&(r.maxWidth=o.maxHeight,r.maxHeight=o.maxWidth,r.minWidth=o.minHeight,r.minHeight=o.minWidth,r.sourceWidth=o.sourceHeight,r.sourceHeight=o.sourceWidth),r}})},{"./load-image":31,"./load-image-meta":28,"./load-image-scale":30}],30:[function(t,n,e){!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof n&&n.exports?e(t("./load-image")):e(window.loadImage)}(function(_){"use strict";var o=_.transform;_.transform=function(e,t,n,r,i){o.call(_,_.scale(e,t,i),t,n,r,i)},_.transformCoordinates=function(){},_.getTransformedOptions=function(e,t){var n,r,i,o=t.aspectRatio;if(!o)return t;for(r in n={},t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.crop=!0,o<(i=e.naturalWidth||e.width)/(e=e.naturalHeight||e.height)?(n.maxWidth=e*o,n.maxHeight=e):(n.maxWidth=i,n.maxHeight=i/o),n},_.renderImageToCanvas=function(e,t,n,r,i,o,a,s,l,d,c){var u=e.getContext("2d");return!1===c.imageSmoothingEnabled?u.imageSmoothingEnabled=!1:c.imageSmoothingQuality&&(u.imageSmoothingQuality=c.imageSmoothingQuality),u.drawImage(t,n,r,i,o,a,s,l,d),e},_.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},_.scale=function(e,t,l){t=t||{};var n,r,d,f,i,o,p,h,m,a=document.createElement("canvas"),g=e.getContext||_.hasCanvasOption(t)&&a.getContext,v=e.naturalWidth||e.width,s=e.naturalHeight||e.height,c=v,u=s;function y(){var e=Math.max((d||c)/c,(f||u)/u);1<e&&(c*=e,u*=e)}function b(){var e=Math.min((n||c)/c,(r||u)/u);e<1&&(c*=e,u*=e)}if(g&&(p=(t=_.getTransformedOptions(e,t,l)).left||0,h=t.top||0,t.sourceWidth?(i=t.sourceWidth,void 0!==t.right&&void 0===t.left&&(p=v-i-t.right)):i=v-p-(t.right||0),t.sourceHeight?(o=t.sourceHeight,void 0!==t.bottom&&void 0===t.top&&(h=s-o-t.bottom)):o=s-h-(t.bottom||0),c=i,u=o),n=t.maxWidth,r=t.maxHeight,d=t.minWidth,f=t.minHeight,g&&n&&r&&t.crop?(l=i/o-(c=n)/(u=r))<0?(o=r*i/n,void 0===t.top&&void 0===t.bottom&&(h=(s-o)/2)):0<l&&(i=n*o/r,void 0===t.left&&void 0===t.right&&(p=(v-i)/2)):((t.contain||t.cover)&&(d=n=n||d,f=r=r||f),t.cover?(b(),y()):(y(),b())),g){if(1<(s=t.pixelRatio)&&(a.style.width=c+"px",a.style.height=u+"px",c*=s,u*=s,a.getContext("2d").scale(s,s)),0<(m=t.downsamplingRatio)&&m<1&&c<i&&u<o)for(;c<i*m;)a.width=i*m,a.height=o*m,_.renderImageToCanvas(a,e,p,h,i,o,0,0,a.width,a.height,t),h=p=0,i=a.width,o=a.height,(e=document.createElement("canvas")).width=i,e.height=o,_.renderImageToCanvas(e,a,0,0,i,o,0,0,i,o,t);return a.width=c,a.height=u,_.transformCoordinates(a,t),_.renderImageToCanvas(a,e,p,h,i,o,0,0,c,u,t)}return e.width=c,e.height=u,e}})},{"./load-image":31}],31:[function(e,n,t){!function(i){"use strict";function a(t,n,r){var i,o=document.createElement("img");return o.onerror=function(e){return a.onerror(o,e,t,n,r)},o.onload=function(e){return a.onload(o,e,t,n,r)},"string"==typeof t?(a.fetchBlob(t,function(e){e&&a.isInstanceOf("Blob",e)?(t=e,i=a.createObjectURL(t)):(i=t,r&&r.crossOrigin&&(o.crossOrigin=r.crossOrigin)),o.src=i},r),o):a.isInstanceOf("Blob",t)||a.isInstanceOf("File",t)?(i=o._objectURL=a.createObjectURL(t))?(o.src=i,o):a.readFile(t,function(e){var t=e.target;t&&t.result?o.src=t.result:n&&n(e)}):void 0}var t=i.createObjectURL&&i||i.URL&&URL.revokeObjectURL&&URL||i.webkitURL&&webkitURL;function o(e,t){!e._objectURL||t&&t.noRevoke||(a.revokeObjectURL(e._objectURL),delete e._objectURL)}a.fetchBlob=function(e,t){t()},a.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},a.transform=function(e,t,n,r,i){n(e,i)},a.onerror=function(e,t,n,r,i){o(e,i),r&&r.call(e,t)},a.onload=function(e,t,n,r,i){o(e,i),r&&a.transform(e,i,r,n,{originalWidth:e.naturalWidth||e.width,originalHeight:e.naturalHeight||e.height})},a.createObjectURL=function(e){return!!t&&t.createObjectURL(e)},a.revokeObjectURL=function(e){return!!t&&t.revokeObjectURL(e)},a.readFile=function(e,t,n){if(i.FileReader){var r=new FileReader;if(r.onload=r.onerror=t,r[n=n||"readAsDataURL"])return r[n](e),r}return!1},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof n&&n.exports?n.exports=a:i.loadImage=a}("undefined"!=typeof window&&window||this)},{}],32:[function(e,t,n){"use strict";var i=e("slugify"),o=e("util")._extend,a=(t.exports=function(e,t,n){t=n?o(s,t):(n=t,s);var r=function(e,t){var n=i(t.key||e.toString()),e=a[n];e||(a[n]={callbacks:[],expires:c(t.expires),clear:function(){a[n]=void 0}},e=a[n]);return e}(e,t);if(function(e,t){if(e.results&&t.useCache){var n=new Date;if(!(e.expires<n))return e;t.debug,e.expires=c(t.expires),e.results=void 0}return}(r,t))return t.debug,n.apply(this,r.results),r;r.callbacks.push(n),1!==r.callbacks.length&&t.useCache||(t.debug,e(function(){for(r.results=arguments,t.debug&&r.callbacks.length;0<r.callbacks.length;)r.callbacks.shift().apply(this,r.results)},r));return r},{}),s={debug:!1,useCache:!0,expires:"+1 minute"};function c(e){if(e.match(/^(\+|\-)\d+\s\w+/)){var t=new Date,n=e.substring(0,1),e=e.substring(1).split(" "),r=parseInt(e[0],10),i=e[1];switch(i){case"millisecond":case"milliseconds":i="Milliseconds";break;case"second":case"seconds":i="Seconds";break;case"minute":case"minutes":i="Minutes";break;case"hour":case"hours":i="Hours";break;case"day":case"days":i="Date";break;case"month":case"months":i="Month";break;case"year":case"years":i="FullYear"}return"-"===n?t["set"+i](t["get"+i]()-r):t["set"+i](t["get"+i]()+r),t}return new Date}},{slugify:63,util:1244}],33:[function(e,t,n){"use strict";var r=e("get-intrinsic"),i=e("./"),o=i(r("String.prototype.indexOf"));t.exports=function(e,t){t=r(e,!!t);return"function"==typeof t&&-1<o(e,".prototype.")?i(t):t}},{"./":34,"get-intrinsic":42}],34:[function(e,t,l){"use strict";var n=e("function-bind"),e=e("get-intrinsic"),r=e("%Function.prototype.apply%"),i=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||n.call(i,r),a=e("%Object.getOwnPropertyDescriptor%",!0),s=e("%Object.defineProperty%",!0),c=e("%Math.max%");if(s)try{s({},"a",{value:1})}catch(e){s=null}t.exports=function(e){var t=o(n,i,arguments);return a&&s&&a(t,"length").configurable&&s(t,"length",{value:1+c(0,e.length-(arguments.length-1))}),t};function u(){return o(n,r,arguments)}s?s(t.exports,"apply",{value:u}):t.exports.apply=u},{"function-bind":41,"get-intrinsic":42}],35:[function(e,t,n){var r,i;r=this,i=function(){"use strict";function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function C(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?t(Object(i),!0).forEach(function(e){var t,n;t=r,n=i[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var e="undefined"!=typeof window&&void 0!==window.document,a=e?window:{},s=!(!e||!a.document.documentElement)&&"ontouchstart"in a.document.documentElement,c=e&&"PointerEvent"in a,u="cropper",m="".concat(u,"-crop"),g="".concat(u,"-disabled"),k="".concat(u,"-hidden"),v="".concat(u,"-hide"),y="".concat(u,"-invisible"),b="".concat(u,"-modal"),_="".concat(u,"-move"),w="".concat(u,"Action"),S="".concat(u,"Preview"),E="cropend",A="cropmove",x="cropstart",P=c?"pointerdown":s?"touchstart":"mousedown",M=c?"pointermove":s?"touchmove":"mousemove",O=c?"pointerup pointercancel":s?"touchend touchcancel":"mouseup",R="image/jpeg",j=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,D=/^data:/,N=/^data:image\/jpeg;base64,/,L=/^img|canvas$/i,$={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},B=Number.isNaN||a.isNaN;function f(e){return"number"==typeof e&&!B(e)}function U(e){return 0<e&&e<1/0}function F(e){return void 0===e}function z(e){return"object"===n(e)&&null!==e}var V=Object.prototype.hasOwnProperty;function H(e){if(!z(e))return!1;try{var t=e.constructor,n=t.prototype;return t&&n&&V.call(n,"isPrototypeOf")}catch(e){return!1}}function l(e){return"function"==typeof e}var q=Array.prototype.slice;function W(e){return Array.from?Array.from(e):q.call(e)}function T(n,r){return n&&l(r)&&(Array.isArray(n)||f(n.length)?W(n).forEach(function(e,t){r.call(n,e,t,n)}):z(n)&&Object.keys(n).forEach(function(e){r.call(n,n[e],e,n)})),n}var p=Object.assign||function(n){for(var e=arguments.length,t=new Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return z(n)&&0<t.length&&t.forEach(function(t){z(t)&&Object.keys(t).forEach(function(e){n[e]=t[e]})}),n},Y=/\.\d*(?:0|9){12}\d*$/;function G(e,t){t=1<arguments.length&&void 0!==t?t:1e11;return Y.test(e)?Math.round(e*t)/t:e}var K=/^width|height|left|top|marginLeft|marginTop$/;function J(e,t){var n=e.style;T(t,function(e,t){K.test(t)&&f(e)&&(e="".concat(e,"px")),n[t]=e})}function d(e,t){var n;t&&(f(e.length)?T(e,function(e){d(e,t)}):e.classList?e.classList.add(t):(n=e.className.trim())?n.indexOf(t)<0&&(e.className="".concat(n," ").concat(t)):e.className=t)}function Q(e,t){t&&(f(e.length)?T(e,function(e){Q(e,t)}):e.classList?e.classList.remove(t):0<=e.className.indexOf(t)&&(e.className=e.className.replace(t,"")))}function X(e,t,n){t&&(f(e.length)?T(e,function(e){X(e,t,n)}):(n?d:Q)(e,t))}var Z=/([a-z\d])([A-Z])/g;function ee(e){return e.replace(Z,"$1-$2").toLowerCase()}function te(e,t){return z(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(ee(t)))}function ne(e,t,n){z(n)?e[t]=n:e.dataset?e.dataset[t]=n:e.setAttribute("data-".concat(ee(t)),n)}var re,ie,oe=/\s\s*/,ae=(ie=!1,e&&(re=!1,c=function(){},s=Object.defineProperty({},"once",{get:function(){return ie=!0,re},set:function(e){re=e}}),a.addEventListener("test",c,s),a.removeEventListener("test",c,s)),ie);function r(n,e,r,t){var i=3<arguments.length&&void 0!==t?t:{},o=r;e.trim().split(oe).forEach(function(e){var t;ae||(t=n.listeners)&&t[e]&&t[e][r]&&(o=t[e][r],delete t[e][r],0===Object.keys(t[e]).length&&delete t[e],0===Object.keys(t).length&&delete n.listeners),n.removeEventListener(e,o,i)})}function h(o,e,a,t){var s=3<arguments.length&&void 0!==t?t:{},c=a;e.trim().split(oe).forEach(function(r){var e,i;s.once&&!ae&&(e=o.listeners,c=function(){delete i[r][a],o.removeEventListener(r,c,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(o,t)},(i=void 0===e?{}:e)[r]||(i[r]={}),i[r][a]&&o.removeEventListener(r,i[r][a],s),i[r][a]=c,o.listeners=i),o.addEventListener(r,c,s)})}function se(e,t,n){var r;return l(Event)&&l(CustomEvent)?r=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,n),e.dispatchEvent(r)}function ce(e){e=e.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ue=a.location,le=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function de(e){e=e.match(le);return null!==e&&(e[1]!==ue.protocol||e[2]!==ue.hostname||e[3]!==ue.port)}function fe(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function pe(e){var t=e.rotate,n=e.scaleX,r=e.scaleY,i=e.translateX,e=e.translateY,o=[],i=(f(i)&&0!==i&&o.push("translateX(".concat(i,"px)")),f(e)&&0!==e&&o.push("translateY(".concat(e,"px)")),f(t)&&0!==t&&o.push("rotate(".concat(t,"deg)")),f(n)&&1!==n&&o.push("scaleX(".concat(n,")")),f(r)&&1!==r&&o.push("scaleY(".concat(r,")")),o.length?o.join(" "):"none");return{WebkitTransform:i,msTransform:i,transform:i}}function he(e,t){var n=e.pageX,e=e.pageY,r={endX:n,endY:e};return t?r:C({startX:n,startY:e},r)}function me(e,t){var n,r=e.aspectRatio,i=e.height,e=e.width,t=1<arguments.length&&void 0!==t?t:"contain",o=U(e),a=U(i);return o&&a?(n=i*r,"contain"===t&&e<n||"cover"===t&&n<e?i=e/r:e=i*r):o?i=e/r:a&&(e=i*r),{width:e,height:i}}var ge=String.fromCharCode;var ve=/^data:.*,/;function ye(l){var t,e,n,r,i,d,o,a=new DataView(l);try{if(255===a.getUint8(0)&&216===a.getUint8(1))for(var f=a.byteLength,s=2;s+1<f;){if(255===a.getUint8(s)&&225===a.getUint8(s+1)){e=s;break}s+=1}if(e&&(r=e+10,"Exif"===function(e,t,n){var r="";n+=t;for(var i=t;i<n;i+=1)r+=ge(e.getUint8(i));return r}(a,e+4,4)&&(!(o=18761===(i=a.getUint16(r)))&&19789!==i||42!==a.getUint16(r+2,o)||8<=(d=a.getUint32(r+4,o))&&(n=r+d))),n)for(var c,p=a.getUint16(n,o),u=0;u<p;u+=1)if(c=n+12*u+2,274===a.getUint16(c,o)){c+=8,t=a.getUint16(c,o),a.setUint16(c,1,o);break}}catch(e){t=1}return t}var e={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,n=this.container,r=this.cropper,i=Number(t.minContainerWidth),t=Number(t.minContainerHeight),i=(d(r,k),Q(e,k),{width:Math.max(n.offsetWidth,0<=i?i:200),height:Math.max(n.offsetHeight,0<=t?t:100)});J(r,{width:(this.containerData=i).width,height:i.height}),d(e,k),Q(r,k)},initCanvas:function(){var e=this.containerData,t=this.imageData,n=this.options.viewMode,r=Math.abs(t.rotate)%180==90,i=r?t.naturalHeight:t.naturalWidth,r=r?t.naturalWidth:t.naturalHeight,t=i/r,o=e.width,a=e.height,t=(e.height*t>e.width?3===n?o=e.height*t:a=e.width/t:3===n?a=e.width/t:o=e.height*t,{aspectRatio:t,naturalWidth:i,naturalHeight:r,width:o,height:a});this.canvasData=t,this.limited=1===n||2===n,this.limitCanvas(!0,!0),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=(e.width-t.width)/2,t.top=(e.height-t.height)/2,t.oldLeft=t.left,t.oldTop=t.top,this.initialCanvasData=p({},t)},limitCanvas:function(e,t){var n=this.options,r=this.containerData,i=this.canvasData,o=this.cropBoxData,a=n.viewMode,s=i.aspectRatio,c=this.cropped&&o;e&&(e=Number(n.minCanvasWidth)||0,n=Number(n.minCanvasHeight)||0,1<a?(e=Math.max(e,r.width),n=Math.max(n,r.height),3===a&&(e<n*s?e=n*s:n=e/s)):0<a&&(e?e=Math.max(e,c?o.width:0):n?n=Math.max(n,c?o.height:0):c&&((e=o.width)<(n=o.height)*s?e=n*s:n=e/s)),e=(s=me({aspectRatio:s,width:e,height:n})).width,n=s.height,i.minWidth=e,i.minHeight=n,i.maxWidth=1/0,i.maxHeight=1/0),t&&((c?0:1)<a?(s=r.width-i.width,e=r.height-i.height,i.minLeft=Math.min(0,s),i.minTop=Math.min(0,e),i.maxLeft=Math.max(0,s),i.maxTop=Math.max(0,e),c&&this.limited&&(i.minLeft=Math.min(o.left,o.left+(o.width-i.width)),i.minTop=Math.min(o.top,o.top+(o.height-i.height)),i.maxLeft=o.left,i.maxTop=o.top,2===a&&(i.width>=r.width&&(i.minLeft=Math.min(0,s),i.maxLeft=Math.max(0,s)),i.height>=r.height&&(i.minTop=Math.min(0,e),i.maxTop=Math.max(0,e))))):(i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=r.width,i.maxTop=r.height))},renderCanvas:function(e,t){var n,r,i=this.canvasData,o=this.imageData;t&&(o=(t=function(e){var t=e.width,n=e.height,e=e.degree;if(90==(e=Math.abs(e)%180))return{width:n,height:t};var r=e%90*Math.PI/180,i=Math.sin(r),r=Math.cos(r),o=t*r+n*i,t=t*i+n*r;return 90<e?{width:t,height:o}:{width:o,height:t}}({width:o.naturalWidth*Math.abs(o.scaleX||1),height:o.naturalHeight*Math.abs(o.scaleY||1),degree:o.rotate||0})).width,t=t.height,n=i.width*(o/i.naturalWidth),r=i.height*(t/i.naturalHeight),i.left-=(n-i.width)/2,i.top-=(r-i.height)/2,i.width=n,i.height=r,i.aspectRatio=o/t,i.naturalWidth=o,i.naturalHeight=t,this.limitCanvas(!0,!1)),(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,J(this.canvas,p({width:i.width,height:i.height},pe({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,n=this.imageData,r=n.naturalWidth*(t.width/t.naturalWidth),i=n.naturalHeight*(t.height/t.naturalHeight);p(n,{width:r,height:i,left:(t.width-r)/2,top:(t.height-i)/2}),J(this.image,p({width:n.width,height:n.height},pe(p({translateX:n.left,translateY:n.top},n)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,n=e.aspectRatio||e.initialAspectRatio,e=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};n&&(t.height*n>t.width?r.height=r.width/n:r.width=r.height*n),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*e),r.height=Math.max(r.minHeight,r.height*e),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=p({},r)},limitCropBox:function(e,t){var n,r,i=this.options,o=this.containerData,a=this.canvasData,s=this.cropBoxData,c=this.limited,u=i.aspectRatio;e&&(e=Number(i.minCropBoxWidth)||0,i=Number(i.minCropBoxHeight)||0,n=c?Math.min(o.width,a.width,a.width+a.left,o.width-a.left):o.width,r=c?Math.min(o.height,a.height,a.height+a.top,o.height-a.top):o.height,e=Math.min(e,o.width),i=Math.min(i,o.height),u&&(e&&i?e<i*u?i=e/u:e=i*u:e?i=e/u:i&&(e=i*u),n<r*u?r=n/u:n=r*u),s.minWidth=Math.min(e,n),s.minHeight=Math.min(i,r),s.maxWidth=n,s.maxHeight=r),t&&(c?(s.minLeft=Math.max(0,a.left),s.minTop=Math.max(0,a.top),s.maxLeft=Math.min(o.width,a.left+a.width)-s.width,s.maxTop=Math.min(o.height,a.top+a.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=o.width-s.width,s.maxTop=o.height-s.height))},renderCropBox:function(){var e=this.options,t=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,e.movable&&e.cropBoxMovable&&ne(this.face,w,n.width>=t.width&&n.height>=t.height?"move":"all"),J(this.cropBox,p({width:n.width,height:n.height},pe({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),se(this.element,"crop",this.getData())}},c={initPreview:function(){var e=this.element,n=this.crossOrigin,t=this.options.preview,r=n?this.crossOriginUrl:this.url,i=e.alt||"The image to preview",o=document.createElement("img");n&&(o.crossOrigin=n),o.src=r,o.alt=i,this.viewBox.appendChild(o),this.viewBoxImage=o,t&&("string"==typeof(o=t)?o=e.ownerDocument.querySelectorAll(t):t.querySelector&&(o=[t]),T(this.previews=o,function(e){var t=document.createElement("img");ne(e,S,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),n&&(t.crossOrigin=n),t.src=r,t.alt=i,t.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(t)}))},resetPreview:function(){T(this.previews,function(t){var n=te(t,S),n=(J(t,{width:n.width,height:n.height}),t.innerHTML=n.html,t),t=S;if(z(n[t]))try{delete n[t]}catch(e){n[t]=void 0}else if(n.dataset)try{delete n.dataset[t]}catch(e){n.dataset[t]=void 0}else n.removeAttribute("data-".concat(ee(t)))})},preview:function(){var a=this.imageData,e=this.canvasData,t=this.cropBoxData,s=t.width,c=t.height,u=a.width,l=a.height,d=t.left-e.left-a.left,f=t.top-e.top-a.top;this.cropped&&!this.disabled&&(J(this.viewBoxImage,p({width:u,height:l},pe(p({translateX:-d,translateY:-f},a)))),T(this.previews,function(e){var t=te(e,S),n=t.width,t=t.height,r=n,i=t,o=1;s&&(i=c*(o=n/s)),c&&t<i&&(r=s*(o=t/c),i=t),J(e,{width:r,height:i}),J(e.getElementsByTagName("img")[0],p({width:u*o,height:l*o},pe(p({translateX:-d*o,translateY:-f*o},a))))}))}},s={bind:function(){var e=this.element,t=this.options,n=this.cropper;l(t.cropstart)&&h(e,x,t.cropstart),l(t.cropmove)&&h(e,A,t.cropmove),l(t.cropend)&&h(e,E,t.cropend),l(t.crop)&&h(e,"crop",t.crop),l(t.zoom)&&h(e,"zoom",t.zoom),h(n,P,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&h(n,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&h(n,"dblclick",this.onDblclick=this.dblclick.bind(this)),h(e.ownerDocument,M,this.onCropMove=this.cropMove.bind(this)),h(e.ownerDocument,O,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&h(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,n=this.cropper;l(t.cropstart)&&r(e,x,t.cropstart),l(t.cropmove)&&r(e,A,t.cropmove),l(t.cropend)&&r(e,E,t.cropend),l(t.crop)&&r(e,"crop",t.crop),l(t.zoom)&&r(e,"zoom",t.zoom),r(n,P,this.onCropStart),t.zoomable&&t.zoomOnWheel&&r(n,"wheel",this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&r(n,"dblclick",this.onDblclick),r(e.ownerDocument,M,this.onCropMove),r(e.ownerDocument,O,this.onCropEnd),t.responsive&&r(window,"resize",this.onResize)}},be={resize:function(){var e,t,n,r,i,o,a;this.disabled||(e=this.options,r=this.container,t=this.containerData,n=r.offsetWidth/t.width,r=r.offsetHeight/t.height,1!=(i=Math.abs(n-1)>Math.abs(r-1)?n:r)&&(e.restore&&(o=this.getCanvasData(),a=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(T(o,function(e,t){o[t]=e*i})),this.setCropBoxData(T(a,function(e,t){a[t]=e*i})))))},dblclick:function(){var e,t;this.disabled||"none"===this.options.dragMode||this.setDragMode((e=this.dragBox,t=m,(e.classList?e.classList.contains(t):-1<e.className.indexOf(t))?"move":"crop"))},wheel:function(e){var t=this,n=Number(this.options.wheelZoomRatio)||.1,r=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?r=0<e.deltaY?1:-1:e.wheelDelta?r=-e.wheelDelta/120:e.detail&&(r=0<e.detail?1:-1),this.zoom(-r*n,e)))},cropStart:function(e){var t,n=e.buttons,r=e.button;this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(f(n)&&1!==n||f(r)&&0!==r||e.ctrlKey)||(n=this.options,t=this.pointers,e.changedTouches?T(e.changedTouches,function(e){t[e.identifier]=he(e)}):t[e.pointerId||0]=he(e),r=1<Object.keys(t).length&&n.zoomable&&n.zoomOnTouch?"zoom":te(e.target,w),j.test(r)&&!1!==se(this.element,x,{originalEvent:e,action:r})&&(e.preventDefault(),this.action=r,this.cropping=!1,"crop"===r&&(this.cropping=!0,d(this.dragBox,b))))},cropMove:function(e){var t,n=this.action;!this.disabled&&n&&(t=this.pointers,e.preventDefault(),!1!==se(this.element,A,{originalEvent:e,action:n})&&(e.changedTouches?T(e.changedTouches,function(e){p(t[e.identifier]||{},he(e,!0))}):p(t[e.pointerId||0]||{},he(e,!0)),this.change(e)))},cropEnd:function(e){var t,n;this.disabled||(t=this.action,n=this.pointers,e.changedTouches?T(e.changedTouches,function(e){delete n[e.identifier]}):delete n[e.pointerId||0],t&&(e.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,X(this.dragBox,b,this.cropped&&this.options.modal)),se(this.element,E,{originalEvent:e,action:t})))}},_e={change:function(l){function e(e){switch(e){case"e":y+u.x>S&&(u.x=S-y);break;case"w":i+u.x<_&&(u.x=_-i);break;case"n":o+u.y<w&&(u.y=w-o);break;case"s":b+u.y>E&&(u.y=E-b)}}var d,f,p,h=this.options,m=this.canvasData,g=this.containerData,t=this.cropBoxData,v=this.pointers,n=this.action,r=h.aspectRatio,i=t.left,o=t.top,a=t.width,s=t.height,y=i+a,b=o+s,_=0,w=0,S=g.width,E=g.height,c=!0,A=(!r&&l.shiftKey&&(r=a&&s?a/s:1),this.limited&&(_=t.minLeft,w=t.minTop,S=_+Math.min(g.width,m.width,m.left+m.width),E=w+Math.min(g.height,m.height,m.top+m.height)),v[Object.keys(v)[0]]),u={x:A.endX-A.startX,y:A.endY-A.startY};switch(n){case"all":i+=u.x,o+=u.y;break;case"e":if(0<=u.x&&(S<=y||r&&(o<=w||E<=b))){c=!1;break}e("e"),(a+=u.x)<0&&(n="w",i-=a=-a),r&&(o+=(t.height-(s=a/r))/2);break;case"n":if(u.y<=0&&(o<=w||r&&(i<=_||S<=y))){c=!1;break}e("n"),s-=u.y,o+=u.y,s<0&&(n="s",o-=s=-s),r&&(i+=(t.width-(a=s*r))/2);break;case"w":if(u.x<=0&&(i<=_||r&&(o<=w||E<=b))){c=!1;break}e("w"),a-=u.x,i+=u.x,a<0&&(n="e",i-=a=-a),r&&(o+=(t.height-(s=a/r))/2);break;case"s":if(0<=u.y&&(E<=b||r&&(i<=_||S<=y))){c=!1;break}e("s"),(s+=u.y)<0&&(n="n",o-=s=-s),r&&(i+=(t.width-(a=s*r))/2);break;case"ne":if(r){if(u.y<=0&&(o<=w||S<=y)){c=!1;break}e("n"),s-=u.y,o+=u.y,a=s*r}else e("n"),e("e"),!(0<=u.x)||y<S?a+=u.x:u.y<=0&&o<=w&&(c=!1),u.y<=0&&!(w<o)||(s-=u.y,o+=u.y);a<0&&s<0?(n="sw",o-=s=-s,i-=a=-a):a<0?(n="nw",i-=a=-a):s<0&&(n="se",o-=s=-s);break;case"nw":if(r){if(u.y<=0&&(o<=w||i<=_)){c=!1;break}e("n"),s-=u.y,o+=u.y,i+=t.width-(a=s*r)}else e("n"),e("w"),!(u.x<=0)||_<i?(a-=u.x,i+=u.x):u.y<=0&&o<=w&&(c=!1),u.y<=0&&!(w<o)||(s-=u.y,o+=u.y);a<0&&s<0?(n="se",o-=s=-s,i-=a=-a):a<0?(n="ne",i-=a=-a):s<0&&(n="sw",o-=s=-s);break;case"sw":if(r){if(u.x<=0&&(i<=_||E<=b)){c=!1;break}e("w"),a-=u.x,i+=u.x,s=a/r}else e("s"),e("w"),!(u.x<=0)||_<i?(a-=u.x,i+=u.x):0<=u.y&&E<=b&&(c=!1),0<=u.y&&!(b<E)||(s+=u.y);a<0&&s<0?(n="ne",o-=s=-s,i-=a=-a):a<0?(n="se",i-=a=-a):s<0&&(n="nw",o-=s=-s);break;case"se":if(r){if(0<=u.x&&(S<=y||E<=b)){c=!1;break}e("e"),s=(a+=u.x)/r}else e("s"),e("e"),!(0<=u.x)||y<S?a+=u.x:0<=u.y&&E<=b&&(c=!1),0<=u.y&&!(b<E)||(s+=u.y);a<0&&s<0?(n="nw",o-=s=-s,i-=a=-a):a<0?(n="sw",i-=a=-a):s<0&&(n="ne",o-=s=-s);break;case"move":this.move(u.x,u.y),c=!1;break;case"zoom":this.zoom((f=C({},d=v),p=0,T(d,function(i,e){delete f[e],T(f,function(e){var t=Math.abs(i.startX-e.startX),n=Math.abs(i.startY-e.startY),r=Math.abs(i.endX-e.endX),e=Math.abs(i.endY-e.endY),t=Math.sqrt(t*t+n*n),n=(Math.sqrt(r*r+e*e)-t)/t;Math.abs(n)>Math.abs(p)&&(p=n)})}),p),l),c=!1;break;case"crop":if(!u.x||!u.y){c=!1;break}d=ce(this.cropper),i=A.startX-d.left,o=A.startY-d.top,a=t.minWidth,s=t.minHeight,0<u.x?n=0<u.y?"se":"ne":u.x<0&&(i-=a,n=0<u.y?"sw":"nw"),u.y<0&&(o-=s),this.cropped||(Q(this.cropBox,k),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}c&&(t.width=a,t.height=s,t.left=i,t.top=o,this.action=n,this.renderCropBox()),T(v,function(e){e.startX=e.endX,e.startY=e.endY})}},we={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&d(this.dragBox,b),Q(this.cropBox,k),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=p({},this.initialImageData),this.canvasData=p({},this.initialCanvasData),this.cropBoxData=p({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(p(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Q(this.dragBox,b),d(this.cropBox,k)),this},replace:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,T(this.previews,function(e){e.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Q(this.cropper,g)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,d(this.cropper,g)),this},destroy:function(){var e=this.element;return e[u]&&(e[u]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate()),this},move:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=this.canvasData,r=n.left,n=n.top;return this.moveTo(F(e)?e:r+Number(e),F(t)?t:n+Number(t))},moveTo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=this.canvasData,r=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(f(e)&&(n.left=e,r=!0),f(t)&&(n.top=t,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(e,t){var n=this.canvasData;return e=Number(e),this.zoomTo(n.width*(e=e<0?1/(1-e):1+e)/n.naturalWidth,null,t)},zoomTo:function(e,t,n){var l,d,r,i=this.options,o=this.canvasData,a=o.width,s=o.height,c=o.naturalWidth,u=o.naturalHeight;if(0<=(e=Number(e))&&this.ready&&!this.disabled&&i.zoomable){i=c*e,u=u*e;if(!1===se(this.element,"zoom",{ratio:e,oldRatio:a/c,originalEvent:n}))return this;n?(e=this.pointers,c=ce(this.cropper),e=e&&Object.keys(e).length?(r=d=l=0,T(e,function(e){var t=e.startX,e=e.startY;l+=t,d+=e,r+=1}),{pageX:l/=r,pageY:d/=r}):{pageX:n.pageX,pageY:n.pageY},o.left-=(i-a)*((e.pageX-c.left-o.left)/a),o.top-=(u-s)*((e.pageY-c.top-o.top)/s)):H(t)&&f(t.x)&&f(t.y)?(o.left-=(i-a)*((t.x-o.left)/a),o.top-=(u-s)*((t.y-o.top)/s)):(o.left-=(i-a)/2,o.top-=(u-s)/2),o.width=i,o.height=u,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return f(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,f(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(f(t)?t:1,e)},scale:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=this.imageData,r=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(f(e)&&(n.scaleX=e,r=!0),f(t)&&(n.scaleY=t,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var n,r,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.options,i=this.imageData,o=this.canvasData,a=this.cropBoxData;return this.ready&&this.cropped?(n={x:a.left-o.left,y:a.top-o.top,width:a.width,height:a.height},r=i.width/i.naturalWidth,T(n,function(e,t){n[t]=e/r}),e&&(o=Math.round(n.y+n.height),a=Math.round(n.x+n.width),n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=a-n.x,n.height=o-n.y)):n={x:0,y:0,width:0,height:0},t.rotatable&&(n.rotate=i.rotate||0),t.scalable&&(n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1),n},setData:function(e){var t,n=this.options,r=this.imageData,i=this.canvasData,o={};return this.ready&&!this.disabled&&H(e)&&(t=!1,n.rotatable&&f(e.rotate)&&e.rotate!==r.rotate&&(r.rotate=e.rotate,t=!0),n.scalable&&(f(e.scaleX)&&e.scaleX!==r.scaleX&&(r.scaleX=e.scaleX,t=!0),f(e.scaleY)&&e.scaleY!==r.scaleY&&(r.scaleY=e.scaleY,t=!0)),t&&this.renderCanvas(!0,!0),n=r.width/r.naturalWidth,f(e.x)&&(o.left=e.x*n+i.left),f(e.y)&&(o.top=e.y*n+i.top),f(e.width)&&(o.width=e.width*n),f(e.height)&&(o.height=e.height*n),this.setCropBoxData(o)),this},getContainerData:function(){return this.ready?p({},this.containerData):{}},getImageData:function(){return this.sized?p({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,n={};return this.ready&&T(["left","top","width","height","naturalWidth","naturalHeight"],function(e){n[e]=t[e]}),n},setCanvasData:function(e){var t=this.canvasData,n=t.aspectRatio;return this.ready&&!this.disabled&&H(e)&&(f(e.left)&&(t.left=e.left),f(e.top)&&(t.top=e.top),f(e.width)?(t.width=e.width,t.height=e.width/n):f(e.height)&&(t.height=e.height,t.width=e.height*n),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return(e=this.ready&&this.cropped?{left:t.left,top:t.top,width:t.width,height:t.height}:e)||{}},setCropBoxData:function(e){var t,n,r=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&H(e)&&(f(e.left)&&(r.left=e.left),f(e.top)&&(r.top=e.top),f(e.width)&&e.width!==r.width&&(t=!0,r.width=e.width),f(e.height)&&e.height!==r.height&&(n=!0,r.height=e.height),i&&(t?r.height=r.width/i:n&&(r.width=r.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var l=this.canvasData,t=(T=this.image,s=this.imageData,i=l,n=e,C=s.aspectRatio,v=s.naturalWidth,y=s.naturalHeight,S=void 0===(S=s.rotate)?0:S,E=void 0===(E=s.scaleX)?1:E,s=void 0===(s=s.scaleY)?1:s,r=i.aspectRatio,_=i.naturalWidth,i=i.naturalHeight,b=void 0===(b=n.fillColor)?"transparent":b,A=void 0===(A=n.imageSmoothingEnabled)||A,k=void 0===(k=n.imageSmoothingQuality)?"low":k,o=void 0===(o=n.maxWidth)?1/0:o,a=void 0===(a=n.maxHeight)?1/0:a,t=void 0===(t=n.minWidth)?0:t,n=void 0===(n=n.minHeight)?0:n,u=document.createElement("canvas"),c=u.getContext("2d"),w=me({aspectRatio:r,width:o,height:a}),r=me({aspectRatio:r,width:t,height:n},"cover"),_=Math.min(w.width,Math.max(r.width,_)),w=Math.min(w.height,Math.max(r.height,i)),r=me({aspectRatio:C,width:o,height:a}),i=me({aspectRatio:C,width:t,height:n},"cover"),o=Math.min(r.width,Math.max(i.width,v)),a=Math.min(r.height,Math.max(i.height,y)),C=[-o/2,-a/2,o,a],u.width=G(_),u.height=G(w),c.fillStyle=b,c.fillRect(0,0,_,w),c.save(),c.translate(_/2,w/2),c.rotate(S*Math.PI/180),c.scale(E,s),c.imageSmoothingEnabled=A,c.imageSmoothingQuality=k,c.drawImage.apply(c,[T].concat(I(C.map(function(e){return Math.floor(G(e))})))),c.restore(),u);if(!this.cropped)return t;var d,f,p,h,m,g,n=this.getData(),v=n.x,r=n.y,i=n.width,y=n.height,o=t.width/Math.floor(l.naturalWidth),a=(1!=o&&(v*=o,r*=o,i*=o,y*=o),i/y),b=me({aspectRatio:a,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),_=me({aspectRatio:a,width:e.minWidth||0,height:e.minHeight||0},"cover"),w=me({aspectRatio:a,width:e.width||(1!=o?t.width:i),height:e.height||(1!=o?t.height:y)}),S=w.width,E=w.height,S=Math.min(b.width,Math.max(_.width,S)),E=Math.min(b.height,Math.max(_.height,E)),s=document.createElement("canvas"),A=s.getContext("2d"),k=(s.width=G(S),s.height=G(E),A.fillStyle=e.fillColor||"transparent",A.fillRect(0,0,S,E),e.imageSmoothingEnabled),T=e.imageSmoothingQuality,C=(A.imageSmoothingEnabled=void 0===k||k,T&&(A.imageSmoothingQuality=T),t.width),c=t.height,u=v,n=r,l=(u<=-i||C<u?m=p=d=u=0:u<=0?(p=-u,u=0,m=d=Math.min(C,i+u)):u<=C&&(p=0,m=d=Math.min(i,C-u)),d<=0||n<=-y||c<n?g=h=f=n=0:n<=0?(h=-n,n=0,g=f=Math.min(c,y+n)):n<=c&&(h=0,g=f=Math.min(y,c-n)),[u,n,d,f]);return 0<m&&0<g&&l.push(p*(a=S/i),h*a,m*a,g*a),A.drawImage.apply(A,[t].concat(I(l.map(function(e){return Math.floor(G(e))})))),s},setAspectRatio:function(e){var t=this.options;return this.disabled||F(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t,n,r=this.options,i=this.dragBox,o=this.face;return this.ready&&!this.disabled&&(n=r.movable&&"move"===e,r.dragMode=e=(t="crop"===e)||n?e:"none",ne(i,w,e),X(i,m,t),X(i,_,n),r.cropBoxMovable||(ne(o,w,e),X(o,m,t),X(o,_,n))),this}},Se=a.Cropper,Ee=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this,r=i;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");if(!e||!L.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=p({},$,H(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var e,t,n;return e=i,n=[{key:"noConflict",value:function(){return window.Cropper=Se,i}},{key:"setDefaults",value:function(e){p($,H(e)&&e)}}],(t=[{key:"init",value:function(){var e,t=this.element,n=t.tagName.toLowerCase();if(!t[u]){if(t[u]=this,"img"===n){if(this.isImg=!0,e=t.getAttribute("src")||"",!(this.originalUrl=e))return;e=t.src}else"canvas"===n&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t,n,r,i,o,a,s=this;e&&(this.url=e,this.imageData={},t=this.element,(n=this.options).rotatable||n.scalable||(n.checkOrientation=!1),n.checkOrientation&&window.ArrayBuffer?D.test(e)?N.test(e)?this.read((a=(a=e).replace(ve,""),r=atob(a),a=new ArrayBuffer(r.length),T(i=new Uint8Array(a),function(e,t){i[t]=r.charCodeAt(t)}),a)):this.clone():(o=new XMLHttpRequest,a=this.clone.bind(this),this.reloading=!0,(this.xhr=o).onabort=a,o.onerror=a,o.ontimeout=a,o.onprogress=function(){o.getResponseHeader("content-type")!==R&&o.abort()},o.onload=function(){s.read(o.response)},o.onloadend=function(){s.reloading=!1,s.xhr=null},n.checkCrossOrigin&&de(e)&&t.crossOrigin&&(e=fe(e)),o.open("GET",e,!0),o.responseType="arraybuffer",o.withCredentials="use-credentials"===t.crossOrigin,o.send()):this.clone())}},{key:"read",value:function(e){var t=this.options,n=this.imageData,r=ye(e),i=0,o=1,a=1;1<r&&(this.url=function(e,t){for(var n=[],r=new Uint8Array(e);0<r.length;)n.push(ge.apply(null,W(r.subarray(0,8192)))),r=r.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(n.join("")))}(e,R),i=(e=function(e){var t=0,n=1,r=1;switch(e){case 2:n=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90,r=-1;break;case 6:t=90;break;case 7:t=90,n=-1;break;case 8:t=-90}return{rotate:t,scaleX:n,scaleY:r}}(r)).rotate,o=e.scaleX,a=e.scaleY),t.rotatable&&(n.rotate=i),t.scalable&&(n.scaleX=o,n.scaleY=a),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,n=e.crossOrigin,r=t,i=(this.options.checkCrossOrigin&&de(t)&&(n=n||"anonymous",r=fe(t)),this.crossOrigin=n,this.crossOriginUrl=r,document.createElement("img"));n&&(i.crossOrigin=n),i.src=r||t,i.alt=e.alt||"The image to crop",(this.image=i).onload=this.start.bind(this),i.onerror=this.stop.bind(this),d(i,v),e.parentNode.insertBefore(i,e.nextSibling)}},{key:"start",value:function(){function e(e,t){p(r.imageData,{naturalWidth:e,naturalHeight:t,aspectRatio:e/t}),r.initialImageData=p({},r.imageData),r.sizing=!1,r.sized=!0,r.build()}var t,n,r=this,i=this.image,o=(i.onload=null,i.onerror=null,this.sizing=!0,a.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(a.navigator.userAgent));!i.naturalWidth||o?(t=document.createElement("img"),n=document.body||document.documentElement,(this.sizingImage=t).onload=function(){e(t.width,t.height),o||n.removeChild(t)},t.src=i.src,o||(t.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",n.appendChild(t))):e(i.naturalWidth,i.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){var e,t,n,r,i,o,a,s,c;this.sized&&!this.ready&&(e=this.element,t=this.options,n=this.image,r=e.parentNode,(i=document.createElement("div")).innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',o=(i=i.querySelector(".".concat(u,"-container"))).querySelector(".".concat(u,"-canvas")),a=i.querySelector(".".concat(u,"-drag-box")),c=(s=i.querySelector(".".concat(u,"-crop-box"))).querySelector(".".concat(u,"-face")),this.container=r,this.cropper=i,this.canvas=o,this.dragBox=a,this.cropBox=s,this.viewBox=i.querySelector(".".concat(u,"-view-box")),this.face=c,o.appendChild(n),d(e,k),r.insertBefore(i,e.nextSibling),this.isImg||Q(n,v),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,d(s,k),t.guides||d(s.getElementsByClassName("".concat(u,"-dashed")),k),t.center||d(s.getElementsByClassName("".concat(u,"-center")),k),t.background&&d(i,"".concat(u,"-bg")),t.highlight||d(c,y),t.cropBoxMovable&&(d(c,_),ne(c,w,"all")),t.cropBoxResizable||(d(s.getElementsByClassName("".concat(u,"-line")),k),d(s.getElementsByClassName("".concat(u,"-point")),k)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),l(t.ready)&&h(e,"ready",t.ready,{once:!0}),se(e,"ready"))}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Q(this.element,k))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&o(e.prototype,t),n&&o(e,n),i}();return p(Ee.prototype,e,c,s,be,_e,we),Ee},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):(r="undefined"!=typeof globalThis?globalThis:r||self).Cropper=i()},{}],36:[function(e,t,n){"use strict";var a=e("underscore"),r=e("deep-equal");t.exports=function(){function o(e,t,n){return a.isFunction(n)?n(e,t):a.isString(n)?e[n]===t[n]:r(e,t)}return function(e,t){function n(){}return n.prototype=e.prototype,a.each(t,function(e,t){n.prototype[t]=e}),new n}(Array,{hasItem:function(t,n){return a.isObject(t)?void 0!==a.find(this,function(e){return o(e,t,n)}):-1<this.indexOf(t)},addToSet:function(e,t){return null!=e&&(a.isArray(e)?this.addEachToSet(e,t):!this.hasItem(e,t)&&(this.push(e),!0))},addEachToSet:function(e,t){var n=this,r=[];return a.each(e,function(e){e=n.addToSet(e,t);r.push(e)}),r},pull:function(n,r){var i;a.isObject(n)?a.each(this,function(e,t){o(e,n,r)&&(i=t)}):i=this.indexOf(n),-1<i&&this.splice(i,1)},clear:function(){this.splice(0,this.length)}})}},{"deep-equal":37,underscore:void 0}],37:[function(e,t,n){var l=e("object-keys"),d=e("is-arguments"),f=e("object-is"),p=e("is-regex"),h=e("regexp.prototype.flags"),m=e("is-date-object"),g=Date.prototype.getTime;function v(e,t,n){var r,i,n=n||{};{if(n.strict?f(e,t):e===t)return!0;if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return n.strict?f(e,t):e==t;var o=e,a=t,s=n;if(typeof o!=typeof a)return!1;if(y(o)||y(a))return!1;if(o.prototype!==a.prototype)return!1;if(d(o)!==d(a))return!1;if(e=p(o),t=p(a),e!==t)return!1;if(e||t)return o.source===a.source&&h(o)===h(a);if(m(o)&&m(a))return g.call(o)===g.call(a);if(e=b(o),t=b(a),e!==t)return!1;if(e||t){if(o.length!==a.length)return!1;for(r=0;r<o.length;r++)if(o[r]!==a[r])return!1;return!0}if(typeof o!=typeof a)return!1;try{var c=l(o),u=l(a)}catch(e){return!1}if(c.length!==u.length)return!1;for(c.sort(),u.sort(),r=c.length-1;0<=r;r--)if(c[r]!=u[r])return!1;for(r=c.length-1;0<=r;r--)if(i=c[r],!v(o[i],a[i],s))return!1;return!0}}function y(e){return null==e}function b(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(0<e.length&&"number"!=typeof e[0]))}t.exports=v},{"is-arguments":47,"is-date-object":48,"is-regex":49,"object-is":52,"object-keys":56,"regexp.prototype.flags":60}],38:[function(e,t,n){"use strict";function r(e,t,n,r){for(var i=(t=Array.isArray(t)?t:t.split(".")).length-1,o=0;o<i;o+=1){if(void 0!==n&&void 0===e[t[o]])e[t[o]]={};else if(!e.hasOwnProperty(t[o])||void 0===e[t[o]])return;e=e[t[o]]}if(void 0!==n){if(r)return delete e[t[i]];e[t[i]]=n}return e[t[i]]}t.exports=r,t.exports.get=function(e,t){return r(e,t)},t.exports.set=function(e,t,n){return r(e,t,n)},t.exports.del=function(e,t){return r(e,t,null,!0)},t.exports.dotpath=function(){return Array.prototype.slice.call(arguments).join(".")}},{}],39:[function(e,t,i){"use strict";function n(e,t){var n=2<arguments.length?arguments[2]:{},r=u(t);l&&(r=d.call(r,Object.getOwnPropertySymbols(t)));for(var i,o,a,s,c=0;c<r.length;c+=1)i=e,o=r[c],a=t[r[c]],s=n[r[c]],o in i&&(!p(s)||!s())||(h?f(i,o,{configurable:!0,enumerable:!1,value:a,writable:!0}):i[o]=a)}var u=e("object-keys"),l="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,d=Array.prototype.concat,f=Object.defineProperty,p=function(e){return"function"==typeof e&&"[object Function]"===r.call(e)},h=f&&function(){var e={};try{for(var t in f(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}();n.supportsDescriptors=!!h,t.exports=n},{"object-keys":56}],40:[function(e,t,n){"use strict";var c=Array.prototype.slice,u=Object.prototype.toString;t.exports=function(t){var n=this;if("function"!=typeof n||"[object Function]"!==u.call(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r,e,i=c.call(arguments,1),o=Math.max(0,n.length-i.length),a=[],s=0;s<o;s++)a.push("$"+s);return r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){var e;return this instanceof r?(e=n.apply(this,i.concat(c.call(arguments))),Object(e)===e?e:this):n.apply(t,i.concat(c.call(arguments)))}),n.prototype&&((e=function(){}).prototype=n.prototype,r.prototype=new e,e.prototype=null),r}},{}],41:[function(e,t,n){"use strict";e=e("./implementation");t.exports=Function.prototype.bind||e},{"./implementation":40}],42:[function(n,i,o){"use strict";var e,f=SyntaxError,a=Function,p=TypeError,s=function(e){try{return a('"use strict"; return ('+e+").constructor;")()}catch(e){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(e){h=null}function c(){throw new p}function b(e){var t,n;return"%AsyncFunction%"===e?t=s("async function () {}"):"%GeneratorFunction%"===e?t=s("function* () {}"):"%AsyncGeneratorFunction%"===e?t=s("async function* () {}"):"%AsyncGenerator%"===e?(n=b("%AsyncGeneratorFunction%"))&&(t=n.prototype):"%AsyncIteratorPrototype%"!==e||(n=b("%AsyncGenerator%"))&&(t=r(n.prototype)),g[e]=t}var u=h?function(){try{return c}catch(e){try{return h(arguments,"callee").get}catch(e){return c}}}():c,t=n("has-symbols")(),r=Object.getPrototypeOf||function(e){return e.__proto__},m={},l="undefined"==typeof Uint8Array?e:r(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?e:ArrayBuffer,"%ArrayIteratorPrototype%":t?r([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":m,"%AsyncGenerator%":m,"%AsyncGeneratorFunction%":m,"%AsyncIteratorPrototype%":m,"%Atomics%":"undefined"==typeof Atomics?e:Atomics,"%BigInt%":"undefined"==typeof BigInt?e:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?e:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?e:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?e:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":m,"%Int8Array%":"undefined"==typeof Int8Array?e:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?e:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":t?r(r([][Symbol.iterator]())):e,"%JSON%":"object"==typeof JSON?JSON:e,"%Map%":"undefined"==typeof Map?e:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&t?r((new Map)[Symbol.iterator]()):e,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?e:Promise,"%Proxy%":"undefined"==typeof Proxy?e:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?e:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?e:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&t?r((new Set)[Symbol.iterator]()):e,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":t?r(""[Symbol.iterator]()):e,"%Symbol%":t?Symbol:e,"%SyntaxError%":f,"%ThrowTypeError%":u,"%TypedArray%":l,"%TypeError%":p,"%Uint8Array%":"undefined"==typeof Uint8Array?e:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?e:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?e:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?e:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?e:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?e:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?e:WeakSet},_={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},t=n("function-bind"),v=n("has"),w=t.call(Function.call,Array.prototype.concat),S=t.call(Function.apply,Array.prototype.splice),E=t.call(Function.call,String.prototype.replace),y=t.call(Function.call,String.prototype.slice),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g;i.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new p("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof t)throw new p('"allowMissing" argument must be a boolean');var n=function(e){var t=y(e,0,1),n=y(e,-1);if("%"===t&&"%"!==n)throw new f("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new f("invalid intrinsic syntax, expected opening `%`");var i=[];return E(e,A,function(e,t,n,r){i[i.length]=n?E(r,k,"$1"):t||e}),i}(e),l=0<n.length?n[0]:"",r=function(e,t){var n,r=e;if(v(_,r)&&(r="%"+(n=_[r])[0]+"%"),v(g,r)){var i=g[r];if(void 0===(i=i===m?b(r):i)&&!t)throw new p("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new f("intrinsic "+e+" does not exist!")}("%"+l+"%",t),i=(r.name,r.value),d=!1,r=r.alias;r&&(l=r[0],S(n,w([0,1],r)));for(var o=1,a=!0;o<n.length;o+=1){var s=n[o],c=y(s,0,1),u=y(s,-1);if(('"'===c||"'"===c||"`"===c||'"'===u||"'"===u||"`"===u)&&c!==u)throw new f("property names with quotes must have matching quotes");if("constructor"!==s&&a||(d=!0),v(g,c="%"+(l+="."+s)+"%"))i=g[c];else if(null!=i){if(!(s in i)){if(!t)throw new p("base intrinsic for "+e+" exists, but the property is not available.");return}i=h&&o+1>=n.length?(a=!!(u=h(i,s)))&&"get"in u&&!("originalValue"in u.get)?u.get:i[s]:(a=v(i,s),i[s]),a&&!d&&(g[c]=i)}}return i}},{"function-bind":41,has:46,"has-symbols":43}],43:[function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=e("./shams");t.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},{"./shams":44}],44:[function(e,t,n){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}return!0}},{}],45:[function(e,t,n){"use strict";var r=e("has-symbols/shams");t.exports=function(){return r()&&!!Symbol.toStringTag}},{"has-symbols/shams":44}],46:[function(e,t,n){"use strict";e=e("function-bind");t.exports=e.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":41}],47:[function(e,t,n){"use strict";function r(e){return!(o&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===a(e)}function i(e){return!!r(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Array]"!==a(e)&&"[object Function]"===a(e.callee)}var o=e("has-tostringtag/shams")(),a=e("call-bind/callBound")("Object.prototype.toString"),e=function(){return r(arguments)}();r.isLegacyArguments=i,t.exports=e?r:i},{"call-bind/callBound":33,"has-tostringtag/shams":45}],48:[function(e,t,n){"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o=e("has-tostringtag/shams")();t.exports=function(e){{if("object"!=typeof e||null===e)return!1;if(!o)return"[object Date]"===i.call(e);var t=e;try{return r.call(t),!0}catch(e){return!1}}}},{"has-tostringtag/shams":45}],49:[function(e,t,l){"use strict";var n,r,i,o,a,s=e("call-bind/callBound"),e=e("has-tostringtag/shams")(),c=(e&&(n=s("Object.prototype.hasOwnProperty"),r=s("RegExp.prototype.exec"),i={},a={toString:o=function(){throw i},valueOf:o},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=o)),s("Object.prototype.toString")),u=Object.getOwnPropertyDescriptor;t.exports=e?function(e){if(!e||"object"!=typeof e)return!1;var t=u(e,"lastIndex");if(!(t&&n(t,"value")))return!1;try{r(e,a)}catch(e){return e===i}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===c(e)}},{"call-bind/callBound":33,"has-tostringtag/shams":45}],50:[function(E,A,e){!function(S){!function(){!function(e){"use strict";var a,c,u,f,p;if(e){var n,t=e.crypto||e.msCrypto;if(!a&&t&&t.getRandomValues)try{var h=new Uint8Array(16);f=a=function(){return t.getRandomValues(h),h},a()}catch(e){}a||(n=new Array(16),c=a=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n})}else if("function"==typeof E)try{var m=E("crypto").randomBytes;u=a=m&&function(){return m(16)},a()}catch(e){}for(var g="function"==typeof S?S:Array,r=[],v={},i=0;i<256;i++)r[i]=(i+256).toString(16).substr(1),v[r[i]]=i;function l(e,t){t=t||0;return r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[+t]]}var o=a(),y=[1|o[0],o[1],o[2],o[3],o[4],o[5]],b=16383&(o[6]<<8|o[7]),d=0,_=0;function w(e,t,n){var r=t&&n||0,i=("string"==typeof e&&(t="binary"===e?new g(16):null,e=null),(e=e||{}).random||(e.rng||a)());if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;o++)t[r+o]=i[o];return t||l(i)}var s=w;s.v1=function(e,t,n){var r=t&&n||0,i=t||[],n=null!=(e=e||{}).clockseq?e.clockseq:b,o=null!=e.msecs?e.msecs:(new Date).getTime(),a=null!=e.nsecs?e.nsecs:_+1;if((s=o-d+(a-_)/1e4)<0&&null==e.clockseq&&(n=n+1&16383),1e4<=(a=(s<0||d<o)&&null==e.nsecs?0:a))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=o,b=n;for(var s=(1e4*(268435455&(o+=122192928e5))+(_=a))%4294967296,a=(i[r++]=s>>>24&255,i[r++]=s>>>16&255,i[r++]=s>>>8&255,i[r++]=255&s,o/4294967296*1e4&268435455),c=(i[r++]=a>>>8&255,i[r++]=255&a,i[r++]=a>>>24&15|16,i[r++]=a>>>16&255,i[r++]=n>>>8|128,i[r++]=255&n,e.node||y),u=0;u<6;u++)i[r+u]=c[u];return t||l(i)},s.v4=w,s.parse=function(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=v[e])});i<16;)t[r+i++]=0;return t},s.unparse=l,s.BufferClass=g,s._rng=a,s._mathRNG=c,s._nodeRNG=u,s._whatwgRNG=f,void 0!==A&&A.exports?A.exports=s:"function"==typeof define&&define.amd?define(function(){return s}):(p=e.uuid,s.noConflict=function(){return e.uuid=p,s},e.uuid=s)}("undefined"!=typeof window?window:null)}.call(this)}.call(this,E("buffer").Buffer)},{buffer:1093,crypto:1106}],51:[function(e,t,n){"use strict";function r(e){return e!=e}t.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!r(e)||!r(t))}},{}],52:[function(e,t,n){"use strict";var r=e("define-properties"),i=e("call-bind"),o=e("./implementation"),a=e("./polyfill"),e=e("./shim"),i=i(a(),Object);r(i,{getPolyfill:a,implementation:o,shim:e}),t.exports=i},{"./implementation":51,"./polyfill":53,"./shim":54,"call-bind":34,"define-properties":39}],53:[function(e,t,n){"use strict";var r=e("./implementation");t.exports=function(){return"function"==typeof Object.is?Object.is:r}},{"./implementation":51}],54:[function(e,t,n){"use strict";var r=e("./polyfill"),i=e("define-properties");t.exports=function(){var e=r();return i(Object,{is:e},{is:function(){return Object.is!==e}}),e}},{"./polyfill":53,"define-properties":39}],55:[function(e,n,r){"use strict";var f,p,h,m,g,v,y,t,b,i;Object.keys||(f=Object.prototype.hasOwnProperty,p=Object.prototype.toString,h=e("./isArguments"),e=Object.prototype.propertyIsEnumerable,m=!e.call({toString:null},"toString"),g=e.call(function(){},"prototype"),v=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],y=function(e){var t=e.constructor;return t&&t.prototype===e},t={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},b=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!t["$"+e]&&f.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{y(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),i=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===p.call(e),r=h(e),i=t&&"[object String]"===p.call(e),o=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var l=g&&n;if(i&&0<e.length&&!f.call(e,0))for(var a=0;a<e.length;++a)o.push(String(a));if(r&&0<e.length)for(var s=0;s<e.length;++s)o.push(String(s));else for(var c in e)l&&"prototype"===c||!f.call(e,c)||o.push(String(c));if(m)for(var d=function(e){if("undefined"==typeof window||!b)return y(e);try{return y(e)}catch(e){return!1}}(e),u=0;u<v.length;++u)d&&"constructor"===v[u]||!f.call(e,v[u])||o.push(v[u]);return o}),n.exports=i},{"./isArguments":57}],56:[function(e,t,n){"use strict";var r=Array.prototype.slice,i=e("./isArguments"),o=Object.keys,a=o?function(e){return o(e)}:e("./implementation"),s=Object.keys;a.shim=function(){return Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return i(e)?s(r.call(e)):s(e)}):Object.keys=a,Object.keys||a},t.exports=a},{"./implementation":55,"./isArguments":57}],57:[function(e,t,n){"use strict";var r=Object.prototype.toString;t.exports=function(e){var t=r.call(e);return"[object Arguments]"===t||"[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===r.call(e.callee)}},{}],58:[function(e,t,n){var r,i;Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),r=this,i=function(){"use strict";var c,e,u,i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i?i:{},o=!i.document&&!!i.postMessage,l=o&&/(\?|&)papaworker(=|&|$)/.test(i.location.search),d=!1,f={},p=0,w={parse:function(e,t){var n=(t=t||{}).dynamicTyping||!1;if(N(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!N(t.transform)&&t.transform,t.worker&&w.WORKERS_SUPPORTED)return(n=function(){if(!w.WORKERS_SUPPORTED)return!1;if(!d&&null===w.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=w.SCRIPT_PATH||c,e=(e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker",new i.Worker(e));return e.onmessage=v,e.id=p++,f[e.id]=e}()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=N(t.step),t.chunk=N(t.chunk),t.complete=N(t.complete),t.error=N(t.error),delete t.worker,void n.postMessage({input:e,config:t,workerId:n.id});n=null;return w.NODE_STREAM_INPUT,"string"==typeof e?n=new(t.download?h:r)(t):!0===e.readable&&N(e.read)&&N(e.on)?n=new g(t):(i.File&&e instanceof File||e instanceof Object)&&(n=new m(t)),n.stream(e)},unparse:function(e,t){var n=!1,g=!0,v=",",y="\r\n",r='"',i=!1,s=("object"==typeof t&&("string"!=typeof t.delimiter||w.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(v=t.delimiter),"boolean"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(i=t.skipEmptyLines),"string"==typeof t.newline&&(y=t.newline),"string"==typeof t.quoteChar&&(r=t.quoteChar),"boolean"==typeof t.header&&(g=t.header)),new RegExp(D(r),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return a(null,e,i);if("object"==typeof e[0])return a(o(e[0]),e,i)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:o(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),a(e.fields||[],e.data||[],i);throw"exception: Unable to serialize unrecognized input";function o(e){if("object"!=typeof e)return[];var t,n=[];for(t in e)n.push(t);return n}function a(e,t,n){var r="",i=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(i&&g){for(var o=0;o<e.length;o++)0<o&&(r+=v),r+=b(e[o],o);0<t.length&&(r+=y)}for(var a=0;a<t.length;a++){var s=(i?e:t[a]).length,d=!1,f=i?0===Object.keys(t[a]).length:0===t[a].length;if(n&&!i&&(d="greedy"===n?""===t[a].join("").trim():1===t[a].length&&0===t[a][0].length),"greedy"===n&&i){for(var p=[],c=0;c<s;c++){var h=l?e[c]:c;p.push(t[a][h])}d=""===p.join("").trim()}if(!d){for(var u=0;u<s;u++){0<u&&!f&&(r+=v);var m=i&&l?e[u]:u;r+=b(t[a][m],u)}a<t.length-1&&(!n||0<s&&!f)&&(r+=y)}}return r}function b(e,t){return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(e=e.toString().replace(s,r+r),"boolean"==typeof n&&n||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(e,w.BAD_DELIMITERS)||-1<e.indexOf(v)||" "===e.charAt(0)||" "===e.charAt(e.length-1)?r+e+r:e)}}};function a(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=E(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new n(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){this.isFirstChunk&&N(this._config.beforeFirstChunk)&&(void 0!==(n=this._config.beforeFirstChunk(e))&&(e=n)),this.isFirstChunk=!1;var n=this._partialLine+e,e=(this._partialLine="",this._handle.parse(n,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){var r=e.meta.cursor,n=(this._finished||(this._partialLine=n.substring(r-this._baseIndex),this._baseIndex=r),e&&e.data&&(this._rowCount+=e.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview);if(l)i.postMessage({results:e,workerId:w.WORKER_ID,finished:n});else if(N(this._config.chunk)&&!t){if(this._config.chunk(e,this._handle),this._handle.paused()||this._handle.aborted())return;this._completeResults=e=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(e.data),this._completeResults.errors=this._completeResults.errors.concat(e.errors),this._completeResults.meta=e.meta),this._completed||!n||!N(this._config.complete)||e&&e.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n||e&&e.meta.paused||this._nextChunk(),e}},this._sendError=function(e){N(this._config.error)?this._config.error(e):l&&this._config.error&&i.postMessage({workerId:w.WORKER_ID,error:e,finished:!1})}}function h(e){var r;(e=e||{}).chunkSize||(e.chunkSize=w.RemoteChunkSize),a.call(this,e),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),o||(r.onload=s(this._chunkLoaded,this),r.onerror=s(this._chunkError,this)),r.open("GET",this._input,!o),this._config.downloadRequestHeaders){var e,t=this._config.downloadRequestHeaders;for(e in t)r.setRequestHeader(e,t[e])}var n;this._config.chunkSize&&(n=this._start+this._config.chunkSize-1,r.setRequestHeader("Range","bytes="+this._start+"-"+n),r.setRequestHeader("If-None-Match","webkit-no-cache"));try{r.send()}catch(t){this._chunkError(t.message)}o&&0===r.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){var e;4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>(null===(e=r.getResponseHeader("Content-Range"))?-1:parseInt(e.substr(e.lastIndexOf("/")+1))),this.parseChunk(r.responseText)))},this._chunkError=function(e){e=r.statusText||e;this._sendError(new Error(e))}}function m(e){(e=e||{}).chunkSize||(e.chunkSize=w.LocalChunkSize),a.call(this,e);var n,r,i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,i?((n=new FileReader).onload=s(this._chunkLoaded,this),n.onerror=s(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,t=(this._config.chunkSize&&(t=Math.min(this._start+this._config.chunkSize,this._input.size),e=r.call(e,this._start,t)),n.readAsText(e,this._config.encoding));i||this._chunkLoaded({target:{result:t}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(n.error)}}function r(e){var n;a.call(this,e=e||{}),this.stream=function(e){return n=e,this._nextChunk()},this._nextChunk=function(){var e,t;if(!this._finished)return t=(e=this._config.chunkSize)?n.substr(0,e):n,n=e?n.substr(e):"",this._finished=!n,this.parseChunk(t)}}function g(e){a.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){a.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){a.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=s(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=s(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=s(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=s(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function n(g){var i,o,d,t,v=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,y=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,n=this,r=0,f=0,a=!1,e=!1,p=[],h={data:[],errors:[],meta:{}};function b(e){return"greedy"===g.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function s(){if(h&&d&&(_("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+w.DefaultDelimiter+"'"),d=!1),g.skipEmptyLines)for(var e=0;e<h.data.length;e++)b(h.data[e])&&h.data.splice(e--,1);if(m()&&h){for(var t=0;m()&&t<h.data.length;t++)for(var n=0;n<h.data[t].length;n++){var l=h.data[t][n];g.trimHeaders&&(l=l.trim()),p.push(l)}h.data.splice(0,1)}if(!h||!g.header&&!g.dynamicTyping&&!g.transform)return h;for(var r,i,o=0;o<h.data.length;o++){for(var a=g.header?{}:[],s=0;s<h.data[o].length;s++){var c=s,u=h.data[o][s];g.header&&(c=s>=p.length?"__parsed_extra":p[s]),g.transform&&(u=g.transform(u,c)),i=u,r=r=c,g.dynamicTypingFunction&&void 0===g.dynamicTyping[r]&&(g.dynamicTyping[r]=g.dynamicTypingFunction(r)),u=!0===(g.dynamicTyping[r]||g.dynamicTyping)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(v.test(i)?parseFloat(i):y.test(i)?new Date(i):""===i?null:i):i,"__parsed_extra"===c?(a[c]=a[c]||[],a[c].push(u)):a[c]=u}h.data[o]=a,g.header&&(s>p.length?_("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+s,f+o):s<p.length&&_("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+s,f+o))}return g.header&&h.meta&&(h.meta.fields=p),f+=h.data.length,h}function m(){return g.header&&0===p.length}function _(e,t,n,r){h.errors.push({type:e,code:t,message:n,row:r})}N(g.step)&&(t=g.step,g.step=function(e){h=e,m()?s():(s(),0!==h.data.length&&(r+=e.data.length,g.preview&&r>g.preview?o.abort():t(h,n)))}),this.parse=function(e,t,n){var r=g.quoteChar||'"',r=(g.newline||(g.newline=function(e,t){e=e.substr(0,1048576);var t=new RegExp(D(t)+"([^]*?)"+D(t),"gm"),n=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<n[0].length;if(1===n.length||e)return"\n";for(var r=0,i=0;i<n.length;i++)"\n"===n[i][0]&&r++;return r>=n.length/2?"\r\n":"\r"}(e,r)),d=!1,g.delimiter?N(g.delimiter)&&(g.delimiter=g.delimiter(e),h.meta.delimiter=g.delimiter):((r=function(l,d,f,p){for(var e,t,n=[",","\t","|",";",w.RECORD_SEP,w.UNIT_SEP],r=0;r<n.length;r++){for(var i,h=n[r],o=0,a=0,m=0,s=void 0,c=new S({comments:p,delimiter:h,newline:d,preview:10}).parse(l),u=0;u<c.data.length;u++)f&&b(c.data[u])?m++:(a+=i=c.data[u].length,void 0!==s?1<i&&(o+=Math.abs(i-s),s=i):s=0);0<c.data.length&&(a/=c.data.length-m),(void 0===t||t<o)&&1.99<a&&(t=o,e=h)}return{successful:!!(g.delimiter=e),bestDelimiter:e}}(e,g.newline,g.skipEmptyLines,g.comments)).successful?g.delimiter=r.bestDelimiter:(d=!0,g.delimiter=w.DefaultDelimiter),h.meta.delimiter=g.delimiter),E(g));return g.preview&&g.header&&r.preview++,i=e,o=new S(r),h=o.parse(i,t,n),s(),a?{meta:{paused:!0}}:h||{meta:{paused:!1}}},this.paused=function(){return a},this.pause=function(){a=!0,o.abort(),i=i.substr(o.getCharIndex())},this.resume=function(){a=!1,n.streamer.parseChunk(i,!0)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),h.meta.aborted=!0,N(g.complete)&&g.complete(h),i=""}}function D(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(e){var k,T=(e=e||{}).delimiter,C=e.newline,I=e.comments,x=e.step,P=e.preview,j=e.fastMode,M=k=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(M=e.escapeChar),("string"!=typeof T||-1<w.BAD_DELIMITERS.indexOf(T))&&(T=","),I===T)throw"Comment character same as delimiter";!0===I?I="#":("string"!=typeof I||-1<w.BAD_DELIMITERS.indexOf(I))&&(I=!1),"\n"!==C&&"\r"!==C&&"\r\n"!==C&&(C="\n");var O=0,R=!1;this.parse=function(n,l,d){if("string"!=typeof n)throw"Input must be a string";var f=n.length,p=T.length,e=C.length,h=I.length,m=N(x),t=[],g=[],r=[],v=O=0;if(!n)return u();if(j||!1!==j&&-1===n.indexOf(k)){for(var y=n.split(C),i=0;i<y.length;i++){if(r=y[i],O+=r.length,i!==y.length-1)O+=C.length;else if(d)return u();if(!I||r.substr(0,h)!==I){if(m){if(t=[],_(r.split(T)),A(),R)return u()}else _(r.split(T));if(P&&P<=i)return t=t.slice(0,P),u(!0)}}return u()}for(var o,a=n.indexOf(T,O),s=n.indexOf(C,O),b=new RegExp(D(M)+D(k),"g");;)if(n[O]!==k)if(I&&0===r.length&&n.substr(O,h)===I){if(-1===s)return u();O=s+e,s=n.indexOf(C,O),a=n.indexOf(T,O)}else if(-1!==a&&(a<s||-1===s))r.push(n.substring(O,a)),O=a+p,a=n.indexOf(T,O);else{if(-1===s)break;if(r.push(n.substring(O,s)),E(s+e),m&&(A(),R))return u();if(P&&t.length>=P)return u(!0)}else for(o=O,O++;;){if(-1===(o=n.indexOf(k,o+1)))return d||g.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:t.length,index:O}),S();if(o===f-1)return S(n.substring(O,o).replace(b,k));if(k!==M||n[o+1]!==M){if(k===M||0===o||n[o-1]!==M){var c=w(-1===s?a:Math.min(a,s));if(n[o+1+c]===T){r.push(n.substring(O,o).replace(b,k)),O=o+1+c+p,a=n.indexOf(T,O),s=n.indexOf(C,O);break}c=w(s);if(n.substr(o+1+c,e)===C){if(r.push(n.substring(O,o).replace(b,k)),E(o+1+c+e),a=n.indexOf(T,O),m&&(A(),R))return u();if(P&&t.length>=P)return u(!0);break}g.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:t.length,index:O}),o++}}else o++}return S();function _(e){t.push(e),v=O}function w(e){var t=0;return-1===e||(e=n.substring(o+1,e))&&""===e.trim()&&(t=e.length),t}function S(e){return d||(void 0===e&&(e=n.substr(O)),r.push(e),O=f,_(r),m&&A()),u()}function E(e){O=e,_(r),r=[],s=n.indexOf(C,O)}function u(e){return{data:t,errors:g,meta:{delimiter:T,linebreak:C,aborted:R,truncated:!!e,cursor:v+(l||0)}}}function A(){x(u()),t=[],g=[]}},this.abort=function(){R=!0},this.getCharIndex=function(){return O}}function v(e){var t=e.data,n=f[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(N(n.userStep)){for(var o=0;o<t.results.data.length&&(n.userStep({data:[t.results.data[o]],errors:t.results.errors,meta:t.results.meta},i),!r);o++);delete t.results}else N(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var n=f[e];N(n.userComplete)&&n.userComplete(t),n.terminate(),delete f[e]}function b(){throw"Not implemented."}function E(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=E(e[t]);return n}function s(e,t){return function(){e.apply(t,arguments)}}function N(e){return"function"==typeof e}return w.RECORD_SEP=String.fromCharCode(30),w.UNIT_SEP=String.fromCharCode(31),w.BYTE_ORDER_MARK="\ufeff",w.BAD_DELIMITERS=["\r","\n",'"',w.BYTE_ORDER_MARK],w.WORKERS_SUPPORTED=!o&&!!i.Worker,w.SCRIPT_PATH=null,w.NODE_STREAM_INPUT=1,w.LocalChunkSize=10485760,w.RemoteChunkSize=5242880,w.DefaultDelimiter=",",w.Parser=S,w.ParserHandle=n,w.NetworkStreamer=h,w.FileStreamer=m,w.StringStreamer=r,w.ReadableStreamStreamer=g,i.jQuery&&((u=i.jQuery).fn.parse=function(a){var n=a.config||{},s=[];return this.each(function(e){if("INPUT"!==u(this).prop("tagName").toUpperCase()||"file"!==u(this).attr("type").toLowerCase()||!i.FileReader||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)s.push({file:this.files[t],inputElem:this,instanceConfig:u.extend({},n)})}),e(),this;function e(){if(0!==s.length){var e,t,n,r=s[0];if(N(a.before)){var i=a.before(r.file,r.inputElem);if("object"==typeof i){if("abort"===i.action)return e=r.file,t=r.inputElem,n=i.reason,N(a.error)&&a.error({name:"AbortError"},e,t,n),0;if("skip"===i.action)return c(),0;"object"==typeof i.config&&(r.instanceConfig=u.extend(r.instanceConfig,i.config))}else if("skip"===i)return c(),0}var o=r.instanceConfig.complete;r.instanceConfig.complete=function(e){N(o)&&o(e,r.file,r.inputElem),c()},w.parse(r.file,r.instanceConfig)}else N(a.complete)&&a.complete()}function c(){s.splice(0,1),e()}}),l?i.onmessage=function(e){var e=e.data;void 0===w.WORKER_ID&&e&&(w.WORKER_ID=e.workerId),"string"==typeof e.input?i.postMessage({workerId:w.WORKER_ID,results:w.parse(e.input,e.config),finished:!0}):!(i.File&&e.input instanceof File||e.input instanceof Object)||(e=w.parse(e.input,e.config))&&i.postMessage({workerId:w.WORKER_ID,results:e,finished:!0})}:w.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),c=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){d=!0},!0):d=!0),(h.prototype=Object.create(a.prototype)).constructor=h,(m.prototype=Object.create(a.prototype)).constructor=m,(r.prototype=Object.create(r.prototype)).constructor=r,(g.prototype=Object.create(a.prototype)).constructor=g,w},"function"==typeof define&&define.amd?define([],i):"object"==typeof t&&void 0!==n?t.exports=i():r.Papa=i()},{}],59:[function(e,t,n){"use strict";var r=Object,i=TypeError;t.exports=function(){if(null!=this&&this!==r(this))throw new i("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e}},{}],60:[function(e,t,n){"use strict";var r=e("define-properties"),i=e("call-bind"),o=e("./implementation"),a=e("./polyfill"),e=e("./shim"),i=i(a());r(i,{getPolyfill:a,implementation:o,shim:e}),t.exports=i},{"./implementation":59,"./polyfill":61,"./shim":62,"call-bind":34,"define-properties":39}],61:[function(e,t,n){"use strict";var r=e("./implementation"),i=e("define-properties").supportsDescriptors,o=Object.getOwnPropertyDescriptor;t.exports=function(){if(i&&"gim"===/a/gim.flags){var e=o(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof/a/.dotAll)return e.get}return r}},{"./implementation":59,"define-properties":39}],62:[function(e,t,n){"use strict";var r=e("define-properties").supportsDescriptors,i=e("./polyfill"),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,c=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!r||!c)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=i(),t=c(u),n=o(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},{"./polyfill":61,"define-properties":39}],63:[function(e,t,n){var o={"":"A","":"A","":"A","":"A","":"A","":"A","":"AE","":"C","":"E","":"E","":"E","":"E","":"I","":"I","":"I","":"I","":"D","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"U","":"U","":"U","":"U","":"U","":"Y","":"TH","":"ss","":"a","":"a","":"a","":"a","":"a","":"a","":"ae","":"c","":"e","":"e","":"e","":"e","":"i","":"i","":"i","":"i","":"d","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"u","":"u","":"u","":"u","":"u","":"y","":"th","":"y","":"SS","":"a","":"b","":"g","":"d","":"e","":"z","":"h","":"8","":"i","":"k","":"l","":"m","":"n","":"3","":"o","":"p","":"r","":"s","":"t","":"y","":"f","":"x","":"ps","":"w","":"a","":"e","":"i","":"o","":"y","":"h","":"w","":"s","":"i","":"y","":"y","":"i","":"A","":"B","":"G","":"D","":"E","":"Z","":"H","":"8","":"I","":"K","":"L","":"M","":"N","":"3","":"O","":"P","":"R","":"S","":"T","":"Y","":"F","":"X","":"PS","":"W","":"A","":"E","":"I","":"O","":"Y","":"H","":"W","":"I","":"Y","":"s","":"S","":"i","":"I","":"g","":"G","":"a","":"b","":"v","":"g","":"d","":"e","":"yo","":"zh","":"z","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"f","":"h","":"c","":"ch","":"sh","":"sh","":"u","":"y","":"","":"e","":"yu","":"ya","":"A","":"B","":"V","":"G","":"D","":"E","":"Yo","":"Zh","":"Z","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"S","":"T","":"U","":"F","":"H","":"C","":"Ch","":"Sh","":"Sh","":"U","":"Y","":"","":"E","":"Yu","":"Ya","":"Ye","":"I","":"Yi","":"G","":"ye","":"i","":"yi","":"g","":"c","":"d","":"e","":"n","":"r","":"s","":"t","":"u","":"z","":"C","":"D","":"E","":"N","":"R","":"S","":"T","":"U","":"Z","":"a","":"c","":"e","":"l","":"n","":"s","":"z","":"z","":"A","":"C","":"e","":"L","":"N","":"S","":"Z","":"Z","":"a","":"e","":"g","":"i","":"k","":"l","":"n","":"u","":"A","":"E","":"G","":"i","":"k","":"L","":"N","":"u","":"euro","":"cruzeiro","":"french franc","":"pound","":"lira","":"mill","":"naira","":"peseta","":"rupee","":"won","":"new shequel","":"dong","":"kip","":"tugrik","":"drachma","":"penny","":"peso","":"guarani","":"austral","":"hryvnia","":"cedi","":"cent","":"yen","":"yuan","":"yen","":"rial","":"ecu","":"currency","":"baht",$:"dollar","":"(c)","":"oe","":"OE","":"sum","":"(r)","":"+","":'"',"":'"',"":"'","":"'","":"d","":"f","":"tm","":"sm","":"...","":"o","":"o","":"a","":"*","":"delta","":"infinity","":"love","&":"and","|":"or","<":"less",">":"greater"};t.exports=function(e,t){t=t||"-";for(var n="",r=0;r<e.length;r++){var i=e[r];n+=i=(i=o[i]?o[i]:i).replace(/[^\w\s$\*\_\+~\.\(\)\'\"\!\-:@]/g,"")}return(n=(n=n.replace(/^\s+|\s+$/g,"")).replace(/[-\s]+/g,t)).replace("#{replacement}$",""),n}},{}],64:[function(e,t,n){"use strict";var r,i;r=this,i=function(){var v=/\s/,y=/<(\w*)>/g;return function(e,t,l){var n,d,r,e=e||"",i=0,f=0,o="",a="",s=!1;for("string"==typeof t?t=function(e){var t,n=[];for(;null!==(t=y.exec(e));)n.push(t[1]);return 0!==n.length?n:null}(t):Array.isArray(t)||(t=null),n=0,d=e.length;n<d;n++)switch(r=e[n]){case"<":if(s)break;if(" "==e[n+1]){u(r);break}if(0==i){i=1,u(r);break}if(1==i){f++;break}u(r);break;case">":if(f){f--;break}if(s)break;if(1==i){if(s=i=0,t){h=p=c=g=m=void 0;var c,p,h,m="",g=!1;e:for(c=0,p=(a+=">").length;c<p;c++)switch(h=a[c].toLowerCase()){case"<":break;case">":break e;case"/":g=!0;break;default:if(h.match(v)){if(g)break e}else g=!0,m+=h}-1!==t.indexOf(m)?o+=a:l&&(o+=l),a=""}break}if(2==i){s=i=0,a="";break}if(3==i&&"-"==e[n-1]&&"-"==e[n-2]){s=i=0,a="";break}u(r);break;case'"':case"'":1==i&&(s=s!=r&&(s||r)),u(r);break;case"!":if(1==i&&"<"==e[n-1]){i=2;break}u(r);break;case"-":if(2==i&&"-"==e[n-1]&&"!"==e[n-2]){i=3;break}u(r);break;case"E":case"e":if(2==i&&"doctype"==e.substr(n-6,7).toLowerCase()){i=1;break}u(r);break;default:u(r)}function u(e){0==i?o+=e:t&&1==i&&(a+=e)}return o}},"function"==typeof define&&define.amd?define([],i):"object"==typeof t&&t.exports?t.exports=i():r.striptags=i()},{}],65:[function(e,t,n){var r=e("./v1"),e=e("./v4"),i=e;i.v1=r,i.v4=e,t.exports=i},{"./v1":68,"./v4":69}],66:[function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var t=t||0,n=r;return[n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[+t]]].join("")}},{}],67:[function(e,t,n){var r,i,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(r=new Uint8Array(16),t.exports=function(){return o(r),r}):(i=new Array(16),t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i})},{}],68:[function(e,t,n){var l,d,f=e("./lib/rng"),p=e("./lib/bytesToUuid"),h=0,m=0;t.exports=function(e,t,n){var r=t&&n||0,i=t||[],o=(e=e||{}).node||l,n=void 0!==e.clockseq?e.clockseq:d,a=(null!=o&&null!=n||(a=f(),null==o&&(o=l=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==n&&(n=d=16383&(a[6]<<8|a[7]))),void 0!==e.msecs?e.msecs:(new Date).getTime()),s=void 0!==e.nsecs?e.nsecs:m+1,c=a-h+(s-m)/1e4;if(c<0&&void 0===e.clockseq&&(n=n+1&16383),1e4<=(s=(c<0||h<a)&&void 0===e.nsecs?0:s))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=a,d=n,c=(1e4*(268435455&(a+=122192928e5))+(m=s))%4294967296,i[r++]=c>>>24&255,i[r++]=c>>>16&255,i[r++]=c>>>8&255,i[r++]=255&c,e=a/4294967296*1e4&268435455,i[r++]=e>>>8&255,i[r++]=255&e,i[r++]=e>>>24&15|16,i[r++]=e>>>16&255,i[r++]=n>>>8|128,i[r++]=255&n;for(var u=0;u<6;++u)i[r+u]=o[u];return t||p(i)}},{"./lib/bytesToUuid":66,"./lib/rng":67}],69:[function(e,t,n){var a=e("./lib/rng"),s=e("./lib/bytesToUuid");t.exports=function(e,t,n){var r=t&&n||0,i=("string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),(e=e||{}).random||(e.rng||a)());if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||s(i)}},{"./lib/bytesToUuid":66,"./lib/rng":67}],70:[function(e,t,n){"use strict";var r=angular.module("cl-angular");t.exports=r},{}],71:[function(e,t,n){"use strict";var f=e("node-uuid");t.exports=["$rootScope","$window","$document","$filter","clAnalytics","PipelineResource","Vault",function(e,u,t,l,i,o,d){var a={};return e.$on("user:login",r),e.$on("user:register",r),angular.element(document).ready(n),{analyticsEnabled:s,alias:function(e){if(s()){var t=void 0;try{t=window.analytics.user().anonymousId()}catch(e){}analytics.alias(e,t)}},identify:function(e,t,n,r){t&&s()?analytics.identify(t,{name:n&&n.displayName},{},r):r()},track:function(e,t,n,r){t.uuid=t.uuid||f.v4();try{rind.config.analytics&&rind.config.analytics.conversions_enabled&&rind.config.analytics.convert_events&&0<=rind.config.analytics.convert_events.indexOf(e)&&(t.email=t.email||rind.context.session.user.primary_email.address,t.uid=t.uid||rind.context.session.user.uid,o.trackConvert({event:e,platform:"client",properties:t}))}catch(e){}s()?i.track(e,t,n,r):(i.queueTrackEvent(e,t),angular.isFunction(r)&&r())},page:function(e){e.uuid=e.uuid||f.v4();try{e.email=e.email||rind.context.session.user.primary_email.address,e.uid=e.uid||rind.context.session.user.uid}catch(e){}if(rind.config.analytics&&rind.config.analytics.conversions_enabled)try{o.trackConvert({event:"Page",platform:"client",properties:{uuid:e.uuid,email:e.email,uid:e.uid}})}catch(e){}s()&&i.trackPage(e)},registerModule:function(e,t,n,r){a[e];a[e]={name:t,node:n,setFn:r}},getModuleLocation:function(e){return a[e].location},getViaProperty:function(e,t,n){e=e+"_"+t;n&&(e=n+"-"+e);return e},findModuleLocations:n,refreshModule:c,analyticsTrack:i&&i.analyticsTrack||angular.noop,addExtraProperties:i&&i.addExtraProperties||angular.noop,addProperties:i&&i.addProperties||angular.noop,clearExtraProperties:i&&i.clearExtraProperties||angular.noop,getAssociatedBundles:i&&i.getAssociatedBundles||angular.noop,trackAffiliateLinkConversion:function(e){e&&(e="https://shareasale.com/sale.cfm?amount=0.00&tracking="+e+"&transtype=lead&merchantID=59453",angular.element(document.body).append('<img src="'+e+'" width="1" height="1" style="display:none;">'))}};function s(){return i&&i.segmentLoaded&&i.segmentLoaded()&&i.ready}function n(){var e=t[0].querySelectorAll("[cl-via]");angular.forEach(e,function(e,t){var e=angular.element(e).attr("cl-module-id");t=t,a[e=e]&&(a[e].location=t)})}function r(){n(),angular.forEach(a,function(e,t){c(t)})}function c(e){a[e].setFn(a[e].location)}}]},{"node-uuid":50}],72:[function(e,t,n){"use strict";t.exports=["config",function(e){return{replaceHost:function(e){return e},isApiUrl:function(e){return!1}}}]},{}],73:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/auth",{},{submitDevice:{url:"/api/auth/device",method:"POST"},initiateServiceProviderLogin:{url:"/api/sso/login",method:"POST"}})}]},{}],74:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/banner/:id",{id:"@id"},{getAllBFF:{url:"/bff/banners",cache:!0,isArray:!0},getAll:{url:"/api/banners"},getCurrent:{url:"/api/banner",cache:!0}})}]},{}],75:[function(e,t,n){"use strict";r.$inject=["$q","bannerResource","$rootScope","TargetService","moment","DataSet"];var d=e("cache-stack");function r(a,s,c,o,e,u){var l=this;return l.banners=[],{Resource:s,getById:function(e){var t=a.defer();return d(function(t){s.get({id:e},function(e){t(e&&e.data)})},{key:"bannerService.get:"+e},t.resolve),t.promise},getAll:function(){var t=a.defer();return n().then(function(e){t.resolve(e)}),t.promise},getCurrent:function(e,t,n,r){var i=a.defer(),o={categorySlug:e,pathname:t},e="bannerService.getCurrent:"+e+t;n&&(o.selectedType=n,e+=n);c.user.valid()&&(o.traits=c.user.getTraits());r&&angular.extend(o,r);return d(function(t){s.getCurrent(o,function(e){t(e&&e.data)})},{key:e},i.resolve),i.promise},getCurrentBanner:function(){var t=a.defer();return n().then(function(){var n=new u,r=e().unix(),i=[];if(_.each(l.banners,function(t){var e;t.start_time<r&&t.end_time>r&&(t.targets&&0!==t.targets.length?(e=o.hasAnyTargets,"AND"===t.operation&&(e=o.hasAllTargets),i.push(e(t.targets).then(function(e){return!!e&&t}))):n.addToSet(t))}),0===i.length)return n=_.sortBy(n,"priority"),t.resolve(n[0]);a.all(i).then(function(e){_.each(e,function(e){e&&n.addToSet(e)}),n=_.sortBy(n,"priority"),t.resolve(n[0])})}),t.promise}};function n(){var e=a.defer();return d(function(t){s.getAllBFF(function(e){l.banners=e,t(e)})},{key:"bannerService.fetch"},e.resolve),e.promise}}t.exports=r},{"cache-stack":32}],76:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/blog/posts",{},{getPosts:{url:"/api/blog/posts",cache:!0},getFullPosts:{url:"/api/blog/posts/full",cache:!0},getBlogCategories:{url:"/api/blog/categories",cache:!0},getPostsByCategory:{url:"/api/blog/posts/category/:category",cache:!0}})}]},{}],77:[function(e,t,n){"use strict";var o=e("underscore");t.exports=["BlogResource","$q",function(r,i){return{getPosts:function(e){return t(e,!1)},getFullPosts:function(e){return t(e,!0)},getCategories:function(){return r.getBlogCategories().$promise.then(function(e){return o.uniq(e.data)})},getPostsByCategory:function(e){return r.getPostsByCategory({category:e}).$promise.then(function(e){return e.data})}};function t(e,t){var n=i.defer();return r[t?"getFullPosts":"getPosts"](e).$promise.then(function(e){if(e&&e.data)return n.resolve(angular.copy(e.data));n.reject(e.status)},function(e){n.reject(e)}),n.promise}}]},{underscore:void 0}],78:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/bundle",{slug:"@slug"},{getBffById:{url:t.cachingDomain+"/bff/bundle/:id"},findById:{url:"/api/bundle/id/:id",cache:!0},findBySlug:{url:"/api/bundle/slug/:slug",cache:!0},findByCourseId:{url:"/api/bundle/course/:courseId",cache:!0},getLearningPath:{params:{type:"learning_path"},cache:!0},getCounts:{url:"/api/bundle/counts",cache:!0}})}]},{}],79:[function(e,t,n){"use strict";t.exports=["$q","bundleResource","cacheStack",function(o,a,s){return{Resource:a,findById:function(e,n,r){var i=o.defer();return e?(n=n||{},r=r||{},s(function(t){r.bff?a.getBffById({id:e},t,i.reject):a.findById(angular.extend({id:e},n),function(e){t(e&&e.data)},i.reject)},{key:"bundleService.findById:"+e+":"+JSON.stringify(n)+JSON.stringify(r)},function(e){c(e),i.resolve(e)}),i.promise):o.reject("no id")},findByCourseId:function(e,t,n){var r=o.defer();return e?(t=t||{},n=n||{},s(function(t){a.findByCourseId({courseId:e},function(e){t(e&&e.data)},r.reject)},{key:"bundleService.findById:"+e+":"+JSON.stringify(t)+JSON.stringify(n)},function(e){angular.forEach(e,function(e){c(e)}),r.resolve(e)}),r.promise):o.reject("no courseId")},getLearningPath:function(){var n=o.defer();return a.getLearningPath().$promise.then(function(e){var t=e&&e.data;t?(angular.forEach(t,function(e){c(e)}),n.resolve(t)):n.reject(e)},n.reject),n.promise},getBySlug:function(e){var n=o.defer();a.getBySlug({slug:e}).$promise.then(function(e){var t=e&&e.data;t?(c(t),n.resolve(t)):n.reject(e)},n.reject)},getCounts:function(e){var r=o.defer();return a.getCounts({id:e}).$promise.then(function(e){var t=e&&e.data,n=e&&e.success;t&&n?r.resolve(t):r.reject(e)},r.reject),r.promise}};function c(t){t&&!t.flagged&&(t.flagged={},angular.forEach(t.flags,function(e){"!"===e[0]?(e=e.substr(1),t.flagged[e]=!1):t.flagged[e]=!0}))}}]},{}],80:[function(e,t,n){"use strict";var c=e("async");t.exports=["$resource","$q","CatalogService","channelResource","config","_",function(e,a,i,t,n,o){var s=e("/api/cache/clear",null,{clearCthulhu:{url:"/api/cache/clear",method:"POST",isArray:!1},clearGanges:{url:"/cache/clear",method:"POST",isArray:!1,ignoreAuthIntercept:!0}});return s.clearCourse=function(e){var t=[],n=[];if(t.push("course.slug:"+e.slug),n.push("course.getCourseBySlug:courseSlug%3A"+e.slug),t.push("course.schedule:undefined%3A%7B%22id%22%3A%22"+e._id+"%22%7D"),n.push("course.getCourseById:course%3A"+e._id),n.push("course.getCourseById:course%3A%7B%22id%22%3A%22"+e._id),n.push("event.get:v2-"+e._id),n.push("course.getCountsById:%7B%22id%22%3A%"+e._id),e.instructors&&e.instructors.length)for(var r=0;r<e.instructors.length;r++)t.push("instructor.slug:%7B%22slug%22%3A%22"+e.instructors[r].slug+"%22%7D"),n.push("instructor.getBy:instructor%3A"+e.instructors[r].slug);t.push("instructor.directory"),t.push("instructor.search"),t.push("reviews.slug:"+e.slug+"%3A%7B%22slug%22%3A%22"+e.slug+"%22%7D"),t.push("course.counts:undefined%3A%7B%22id%22%3A%22"+e._id+"%22%7D"),t.push("upcoming"),n.push("upcoming.getUpcoming"),t.push("catalog.filters"),t.push("catalog.data"),t.push("catalog.search"),t.push("channel.watch"),t.push("channel.live"),n.push("channel.getChannelBySlug:channelSlug"),n.push("course.getBonusMaterials:course"),t.push("verticals");var i=s.clearGanges({prefixes:t}),o=s.clearCthulhu({prefixes:n});a.all([i.$promise.then(function(e){return e}),o.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearCourseCounts=function(e){if(!e)return!0;e=["course.counts:undefined%3A%7B%22id%22%3A%22"+e._id+"%22%7D"],e=s.clearGanges({prefixes:e});a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearI18n=function(){var e=s.clearGanges({prefixes:["i18n"]});a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearBanner=function(e){var t=[],e=(angular.forEach(e,function(e){t.push("banner.getCurrent:%7B%22categorySlug%22%3A%22"+(e.slug||e)+"%22%7D")}),t.push("banner.getCurrent:%7B%22pathname%22%3A%22%2F%22%7D"),t.push("banner.getCurrent:%7B%7D"),s.clearGanges({prefixes:["banner"]})),n=s.clearCthulhu({prefixes:t});a.all([e.$promise.then(function(e){return e}),n.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearReview=function(e){e=["reviews.slug:"+e.slug+"%3A%7B%22slug%22%3A%22"+e.slug+"%22%7D","course.counts:undefined%3A%7B%22id%22%3A%22"+e._id+"%22%7D"],e=s.clearGanges({prefixes:e});a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearGalleryCourse=function(e){e=s.clearCthulhu({prefixes:["gallery.getCourse:"+e]});return a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearGalleryUser=function(e){e=s.clearCthulhu({prefixes:["gallery.getUser:"+e]});return a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearGalleryImage=function(e){var t=[];try{var n=e.owner.user.slug;n&&t.push(s.clearGalleryUser(n))}catch(e){}try{var r=o.chain(e.courses).pluck("slug").flatten().uniq().value();angular.forEach(r,function(e){t.push(s.clearGalleryCourse(e))})}catch(e){}return a.all(t)},s.clearBundle=function(e){var t=[],e=(t.push("bundle.slug:"+e.slug),t.push("catalog.filters"),t.push("catalog.data"),t.push("catalog.search"),t.push("verticals"),s.clearGanges({prefixes:t}));a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearChannel=function(n){var r=[],i=[];t.get({id:n._id||n}).$promise.then(function(e){var e=(n=e&&e.data).slug.match(/[a-z]*/)[0],e=(r.push("channel."+e+":"+n.slug),i.push("channel.getChannelBySlug:channelSlug%3A"+n.slug),s.clearGanges({prefixes:r})),t=s.clearCthulhu({prefixes:i});a.all([e.$promise.then(function(e){return e}),t.$promise.then(function(e){return e})]).then(function(e){return e})})},s.clearEvent=function(e){var t=[],n=e&&(e._id||e),n=(n&&(t.push("event.get:v2-%7B%22id%22%3A%22"+n),t.push("event.getMaterials"),t.push("event.get:v2-%7B%22broadcastType%22%3A%22live%22%2C%22date"),t.push("event.get:v2-%7B%22date"),t.push("event.get:v2-%7B%22when%22%3A%22range")),e&&e.product&&e.product.source&&e.product.source.source_id),e=((n=n&&n._id?n._id:n)&&(t.push("event.get:v2-%7B%22courseId%22%3A%22"+n),t.push("event.get:v2-%7B%22id%22%3A%22"+n)),s.clearCthulhu({prefixes:t}));a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearBroadcasts=function(e){var n={},r={};c.each(e,function(e,t){e.channel&&(n[e.channel.slug]=e.channel),e.content&&e.content.content_id?(e=e.content.content_id._id||e.content.content_id,i.getCourseById(e).then(function(e){r[e._id]=e,t()},t)):t()},function(){o.each(o.values(n),function(e){s.clearChannel(e)}),o.each(o.values(r),function(e){s.clearCourse(e)})})},s.clearPages=function(e,t){var n=[],e=(n.push("page:"+(e||"")),t&&n.push("urls:%7B%7D"),s.clearGanges({prefixes:n}));a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearInstructor=function(e){var t=[],n=[];t.push("instructor.slug:%7B%22slug%22%3A%22"+e.slug),t.push("instructor.directory"),t.push("instructor.search");for(var r=0;r<e.courses.length;r++)t.push("course.slug:"+e.courses[r].slug),n.push("course.getCourseBySlug:courseSlug%3A"+e.courses[r].slug),n.push("course.getCourseById:course%3A"+e.courses[r]._id);t.push("catalog.data"),n.push("instructor.list"),n.push("upcoming.getUpcoming"),n.push("instructor.getBy:instructor%3A"+e.slug);var i=s.clearGanges({prefixes:t}),o=s.clearCthulhu({prefixes:n});a.all([i.$promise.then(function(e){return e}),o.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearPartner=function(e){var t=[],n=[],e=(t.push("partner.slug:%7B%22slug%22%3A%22"+e.slug),n.push("partner.get:slug%3A"+e.slug),s.clearGanges({prefixes:t})),t=s.clearCthulhu({prefixes:n});a.all([e.$promise.then(function(e){return e}),t.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearProduct=function(e){"bundle"===e.type||"conference"===e.type?s.clearBundle(e):s.clearCourse(e)},s.clearEnterprise=function(){var e=[],e=(e.push("enterprise.getAllAccounts:%7B%7D"),s.clearCthulhu({prefixes:e}));return a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s.clearSubscriptions=function(){var e=[],e=(e.push("subscription.getAllSubscriptions:%7B%7D"),e.push("subscription.getAllSeats:%7B%7D"),s.clearCthulhu({prefixes:e}));return a.all([e.$promise.then(function(e){return e})]).then(function(e){return e})},s}]},{async:21}],81:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/ecom/cart",{},{get:{method:"GET"},has:{method:"GET",url:"/api/ecom/cart/has"},add:{method:"POST",url:"/api/ecom/cart/add"},remove:{method:"POST",url:"/api/ecom/cart/remove"},clear:{method:"POST",url:"/api/ecom/cart/clear"},addCoupon:{method:"POST",url:"/api/ecom/cart/addcoupon"},removeCoupon:{method:"POST",url:"/api/ecom/cart/removecoupon"}})}]},{}],82:[function(e,t,n){"use strict";var c=e("deepval"),u=e("underscore");t.exports=["CartResource","$q","$rootScope","$filter",function(i,o,r,n){var a={};return{get:function(e){var t=o.defer();if(!e&&a&&a.cart)return o.resolve(a);var n={session:!0};e&&(n.r=(new Date).valueOf());return i.get(n).$promise.then(function(e){if(!e||!e.data)return o.reject();s(e.data),t.resolve(a)},t.reject),t.promise},has:function(e){var t=o.defer();if(!e&&a&&a.cart)return o.resolve(a);var n={session:!0};e&&(n.r=(new Date).valueOf());return i.has(n).$promise.then(function(e){return e?e.data?(s(e.data),void t.resolve(e.data)):(r.$broadcast("cart:needs-init"),o.resolve(!1)):o.reject()},t.reject),t.promise},add:function(e,t){t=t||{};var n=o.defer(),r={session:!0};if(!e)return o.reject("Products are required.");angular.isArray(e)||(e=[e]);r.products=e,t.gift&&(r.gift=t.gift);t.coupons&&(r.coupons=t.coupons);t.token&&(r.token=t.token);return i.add(r).$promise.then(function(e){e&&e.data&&e.data.cart?(s(e.data),n.resolve(a)):n.reject(e)},n.reject),n.promise},remove:function(e){var t=o.defer();if(!e)return o.reject("Products are required.");angular.isArray(e)||(e=[e]);return i.remove({products:e,session:!0}).$promise.then(function(e){e&&e.data&&e.data.cart?(s(e.data),t.resolve(a)):t.reject(e)},t.reject),t.promise},clear:function(e,t){var n=o.defer();return i.clear({cartId:e}).$promise.then(function(e){e&&e.data?(t||s(e.data),n.resolve(a)):n.reject(e)},n.reject),n.promise},addCoupon:function(e,t){var n=o.defer();return e?(i.addCoupon({couponCode:e,cartId:t}).$promise.then(function(e){e&&e.data&&e.data.cart?(s(e.data),n.resolve(a)):n.reject(e)},n.reject),n.promise):o.reject("Require a code to add coupon to cart.")},removeCoupon:function(e,t){var n=o.defer();return e?(i.removeCoupon({couponCode:e,cartId:t}).$promise.then(function(e){e&&e.data&&e.data.cart?(s(e.data),n.resolve(a)):n.reject(e)},n.reject),n.promise):o.reject("Require a code to remove coupon to cart.")}};function s(e){var t;t=e,angular.forEach(t.lineItems,function(r){r.isdiscounted=r.pricing.full_price>r.pricing.display_price,r.oneTimeDiscounts=!0,r.unlimitedDiscounts=!0,r.productLink=n("linkToProduct")(r,!1),t.appliedDiscounts.forEach(function(e){var t,n;r.unlimitedDiscounts=r.unlimitedDiscounts&&e.discount&&-1===e.discount.billingCycles,r.oneTimeDiscounts=r.oneTimeDiscounts&&e.discount&&!e.discount.billingCycles,"cross-sell"===e.action.type&&e.targetId===r._id&&(r.isCrossSellItem=!0,r.cross_sells=[],t=c(e,"discount.conditions"),n=u.findIndex(t,function(e){return-1<u.indexOf(u.keys(e),"products")}),r.anchor_id=c(t[n],"products.0"),"flat"===e.action.discount.type?r.crossSellDiscount="$"+e.action.discount.amount/100:r.crossSellDiscount=e.action.discount.amount+"%")})}),a=e,r.$broadcast("cart:updated",a)}}]},{deepval:38,underscore:void 0}],83:[function(e,t,n){"use strict";r.$inject=["CatalogService","categoryResource","TaxonomyService","InstructorService","$q"];var g=e("underscore");function r(i,e,o,a,s){return{run:function(){var l=s.defer(),e=i.getSocialProofData(),t=i.getAllCourses(),n=o.get(),r=a.getInstructors(),d=[{key:"_id",label:"Course Id"},{key:"sku",label:"SKU"},{key:"created",label:"Created (Unix Time)"},{key:"short_title",label:"Title"},{key:"instructors",label:"Instructors"},{key:"primary_category",label:"Category"},{key:"taxonomy",label:"Taxonomy"},{key:"units_sold.30d",label:"Units Sold"},{key:"lessonCount",label:"Lesson Count"},{key:"popularity",label:"Popularity"},{key:"reviews",label:"Number of Reviews"},{key:"not_recommended",label:"Not Recommended Reviews"},{key:"recommended",label:"Recommended Reviews"},{key:"students",label:"Students"},{key:"reviewsPercent",label:"Reviews Percent"},{key:"flagged.for_sale",label:"for_sale"},{key:"flagged.featured",label:"featured"},{key:"flagged.subscription_only",label:"subscription_only"},{key:"flagged.owner_only",label:"owner_only"},{key:"flagged.published",label:"published"},{key:"flagged.on_calendar",label:"on_calendar"},{key:"flagged.show_on_catalog",label:"show_on_catalog"},{key:"flagged.allow_enrollment",label:"allow_enrollment"},{key:"flagged.allow_seo_robot_indexing",label:"allow_seo_robot_indexing"},{key:"flagged.on_catalog",label:"on_catalog"},{key:"flagged.consumer_subscription",label:"consumer_subscription"}],f={courses:{},categories:{},topics:{},social:{},instructors:{}};return s.all({social:e,courses:t,taxonomy:n,instructors:r}).then(function(e){var t,n,o,a,r,s,i=e.courses,c=e.social,u=e.taxonomy,e=e.instructors,i=(f.courses=i,t={},n={},g.each(u,function(e){t[e._id]=g.pick(e,"title","slug"),g.each(e.topics,function(e){n[e._id]=g.pick(e,"name","slug")})}),{categories:t,topics:n}),u=i.topics,i=(f.categories=i.categories,f.topics=u,f.social=p(c,"id"),f.instructors=p(e,"_id"),o=d,a=f,s=r="",g.each(o,function(e){""!==r&&(r+=","),r+=e.label}),s+=r+"\n",g.each(a.courses,function(n){e=a,(r=n).instructors=h(r.instructors,e.instructors,"profile","name").replace(/\"/g,"'"),r.primary_category=m("",r.primary_category,e.categories,"title"),r.taxonomy=h(r.taxonomy,e.topics,"name"),g.each(e.social[r._id],function(e,t){r[t]=e}),n=g.extend(r,g.pick(e.social[r._id],"reviews","not_recommended","recommended","students","reviewsPercent"));var r,e,i="";g.each(o,function(e){""!==i&&(i+=",");var t=e.key.split("."),e=n[e.key];1<t.length&&(e=n[t[0]][t[1]]),i+='"'+(e||"")+'"'}),s+=i+"\n"}),s);l.resolve(i)},l.reject),l.promise}};function p(e,n){return g.reduce(e,function(e,t){return e[t[n]]=t,e},{})}function h(e,n,r,i){return g.reduce(e,function(e,t){return m(e,t,n,r,i)},"")}function m(e,t,n,r,i){n=n[t];return n&&n[r]&&!i?(""!==e&&(e+=", "),e+=n[r]):n&&n[r]&&n[r][i]&&(""!==e&&(e+=", "),e+=n[r][i]),e}}t.exports=r},{underscore:void 0}],84:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/catalog",{},{getTags:{url:"/api/catalog/filters",cache:!0},search:{url:"/api/catalog/search",method:"POST"},searchCourses:{url:"/bff/catalog/search/courses",method:"GET"},searchLessons:{url:"/bff/catalog/search/lessons",method:"GET"},updateCourse:{url:"/api/catalog/update/:id",method:"POST"},updateAll:{url:"/api/catalog/update-all"},updateAllIndexes:{url:"/api/catalog/updateall",method:"POST"},counts:{url:"/api/catalog/counts",cache:!0},get:{url:t.cachingDomain+"/bff/catalog",cache:!0,isArray:!0},getBundles:{url:t.cachingDomain+"/bff/bundles",cache:!0,isArray:!0},getPages:{url:t.cachingDomain+"/bff/pages",cache:!0,isArray:!0},getPrices:{url:t.cachingDomain+"/bff/catalog/prices",cache:!0,isArray:!0},getSocialProofData:{url:t.cachingDomain+"/bff/catalog/social-proof",cache:!0,isArray:!0}})}]},{}],85:[function(e,t,n){"use strict";r.$inject=["$rootScope","$q","catalogResource","categoryResource","productResource","CourseService","BundleService","tagResource","subTopicResource","lessonResource","DataSet","taxonomyResource","TaxonomyService","InstructorService"];var U=e("underscore"),F=e("async"),z=e("node-uuid"),V=e("cache-stack");function r(e,f,o,i,c,u,l,d,v,y,b,t,_,w){var n={category:{},topic:{},subtopic:{},tag:{}},r={category:{},topic:{},subtopic:{},tag:{}},p={},h={},S={},E={},A={},k={},T={},a={},C={},I={};return m(),{maps:n,lookups:r,search:M,searchAutocomplete:function(i){var o=f.defer(),e=U.extend({limit:3,page:!1},i);{var a,s,c,u,l;i.against&&"description"===i.against[0]?M(e,{},{},!0).then(function(t){(t=t&&t.courses)&&t.exact?g(U.pluck(t.exact,"id"),{keys:["instructors"]}).then(function(e){o.resolve({courses:e,metadata:{searchId:t.searchId,version:t.version}})},o.reject):o.reject()},o.reject):(a=[],l=!(s=""),m().then(function(){var e,t,n,r=/[-\/\\^$*+?.()|[\]{}]/g;c=i.text.split(" "),U.each(c,function(e){s+="(?=.*"+e.replace(r,"\\$&")+")"});try{u=new RegExp(s,"i")}catch(e){l=!1}l&&(U.each(p,function(e){d(e,u)&&a.push(e)}),U.each(h,function(e){d(e,u)&&a.push(e)}),U.each(S,function(e){d(e,u)&&e.url&&a.push(e)}),a.length&&a.sort(function(e,t){if("page"===e.content_type)return-1;if("page"===t.content_type)return 1;e=("bundle"===e.content_type?e.nid:e.popularity)||0;return(("bundle"===t.content_type?t.nid:t.popularity)||0)-e}),e=a,t=f.defer(),n=[],F.eachSeries(e,function(e,t){N(e).then(L).then(function(e){n.push(e),t()},function(e){t(e)})},function(e){e?t.reject(e):t.resolve(n)}),t.promise.then(function(e){o.resolve({courses:e,metadata:{searchId:z.v4()}})}))},o.reject))}function d(e,t){if(e&&(!e.flagged||!1!==e.flagged.show_on_catalog)){if(t.test(e.title))return 1;var n=e.instructors;if(n&&0<n.length)for(var r=0,i=n.length;r<i;r++){var o=n[r];if(o&&o.name&&t.test(o.name))return 1}var a=e.taxonomy;if(a&&0<a.length)for(var s=0,c=a.length;s<c;s++){var u=a[s];if(u&&u.name&&t.test(u.name))return 1}}}return o.promise},searchLessons:x,searchCourses:P,Resource:o,getCategory:function(t){return t?i.getCategoryBySlug({slug:t},function(e){e.data&&e.data.title||(e.data={title:"Not Found"}),e.data.name=e.data.title,n.category[t]=e.data,r.category[t]=e.data}).$promise:O("getCategory-no-slug")},getTopics:function(e){if(!e)return O("getTopic-no-slug");if(r.topic[e])return O("getTopic-cache-used");return t.get({},function(e){e.forEach(function(e){var t=e.slug;r.topic[t]||(r.topic[t]=[]),e.topics.forEach(function(e){e.url=e.path,r.topic[t].push(e),n.topic[e.path]=e})})}).$promise},getSubTopics:function(t){return t?(r.subtopic[t]=[],v.getSubTopicByPath({path:t},function(e){e.data.forEach(function(e){e.url=e.path,n.subtopic[e.path]=e,r.subtopic[t].push(e)})}).$promise):O("getSubTopics-no-path")},getTags:function(t){return t?d.getTagsByPath({path:t,flags:["is_search"]},function(e){r.tag[t]=[],e.data.forEach(function(e){e.url=e.path,n.tag[e.path]=e,r.tag[t].push(e)})}).$promise:O("getTags-no-path")},fetch:m,get:function(){return o.get().$promise},getCourseById:j,getLessonById:function(e,t){return angular.isString(e)?y.getLesson(U.extend({id:e},t)).$promise:f.reject()},getCoursesByIds:g,getCourseBySlug:function(t,n,r){var i=f.defer();return m().then(function(){var e=E[t];(e?j(e,n,r):u.findBySlug(t,r,n)).then(i.resolve,i.reject)},i.reject),i.promise},getCourseByNid:function(e,t,n){var r=f.defer();return m().then(function(){j(k[e],t,n).then(r.resolve,r.reject)},r.reject),r.promise},getCourseByProduct:$,getCoursesByProducts:function(e,r,i){var t=f.defer();return m().then(function(){r=r||{};var n=[];F.eachSeries(e,function(e,t){$(e,r,i).then(function(e){e&&n.push(e),t()},function(e){t()})},function(){r.sort&&n.sort(function(e,t){var n=r.sortBy||"title",t=(e[n],t[n],t[n]-e[n]);return angular.isNumber(r.sortDir),t}),angular.isNumber(r.limit)&&(n=n.slice(0,r.limit)),t.resolve(n)})},t.reject),t.promise},getCoursesByTopic:function(t,n,r){var i=f.defer();return m().then(function(){var e=a[t];if(!e||!e.length)return i.resolve();g(e,n,r).then(i.resolve,i.reject)},i.reject),i.promise},getCoursesByTopics:function(e,n,r){var t=f.defer(),i=new b;return m().then(function(){F.each(e,function(e,t){e=a[e];if(!e||!e.length)return t();g(e,angular.extend({},n,{limit:9999}),r).then(function(e){i.addEachToSet(e,"_id"),t()},function(e){t(e)})},function(e){e&&t.reject(e),n.sort&&(i=U.sortBy(i,n.sort).reverse()),n.limit&&(i=i.splice(0,n.limit)),t.resolve(i)})},t.reject),t.promise},getCoursesByCategory:function(t,n,r){var i=f.defer();return m().then(function(){var e=C[t];if(!e.length)return i.resolve();g(e,n,r).then(i.resolve,i.reject)},i.reject),i.promise},getCoursesByInstructor:function(t,n,r){var i=f.defer();return m().then(function(){var e=I[t];if(!e.length)return i.resolve();g(e,n,r).then(i.resolve,i.reject)},i.reject),i.promise},getCoursesByInstructors:function(e,r){return m().then(function(){var n={};return U.each(e,function(e){var t=I[e];n[e]=g(t,r)}),f.all(n)})},getCoursesByCourseBundles:function(t,r,n,i){var o=[];return B(t).then(function(e){return U.each(e,function(e){n&&e._id!==n||(o=o.concat(e.courses))}),g(o=i?o:U.without(o,t),null,null)}).then(function(e){return e.length?("topics"===r.sort?(n=U.pluck(p[t].taxonomy,"slug"),e.sort(function(e,t){e=U.pluck(e.taxonomy,"slug"),t=U.pluck(t.taxonomies,"slug"),e=U.intersection(n,e).length;return U.intersection(n,t).length-e})):r.sort&&(e=U.sortBy(e,r.sort).reverse()),r.limit?e.splice(0,r.limit):e):e;var n})},getAllCourses:function(){var e=f.defer();return m().then(function(){e.resolve(p)},e.reject),e.promise},getLearningPath:function(t,n){var r=f.defer();return s().then(function(){if(t)return(e=h[t])?r.resolve(e):r.reject("no results");var e=[],e=n&&"unpublished"===n.allow?U.where(U.values(h),{type:"learning_path"}):U.filter(U.values(h),function(e){return"learning_path"===e.type&&e.flagged.published});r.resolve(e)},r.reject),r.promise},getBundleById:function(e,t){if(!e)return f.reject("getBundleById: no id");var n=f.defer();return s().then(function(){h[e]?n.resolve(h[e]):n.reject("no results")},n.reject),n.promise},getBundleBySlug:function(t,e){if(!t)return f.reject("getBundleBySlug: no slug");var n=f.defer();return s().then(function(){var e=A[t];e&&h[e]?n.resolve(h[e]):n.reject("no results")},n.reject),n.promise},getBundlesByCourseId:B,getPrices:function(){var n=f.defer();return V(function(t){o.getPrices().$promise.then(function(e){t(null,e)},t)},{key:"CatalogService.FetchProductPrices",expires:"+15 minutes"},function(e,t){e||!t?n.reject(e):n.resolve(t)}),n.promise},getSocialProofData:function(){var n=f.defer();return V(function(t){o.getSocialProofData().$promise.then(function(e){t(null,e)},t)},{key:"CatalogService.FetchSocialProofData",expires:"+6 hours"},function(e,t){e||!t?n.reject(e):n.resolve(t)}),n.promise},getTrendingClasses:function(){var n=f.defer();return V(function(t){o.get().$promise.then(function(e){e=U.filter(e,function(e){if(e.badges)return e.badges.trending});e.sort(function(e,t){return t.units_sold["30d"]-e.units_sold["30d"]}),t(null,e)},t)},{key:"CatalogService.FetchTrendingClasses",expires:"+10 minutes"},function(e,t){e||!t?n.reject(e):n.resolve(t)}),n.promise},getMostPopularClasses:function(){var n=f.defer();return V(function(t){o.get().$promise.then(function(e){e=U.filter(e,function(e){if(e&&e.badges)return e.badges.most_popular});t(null,e)},t)},{key:"CatalogService.FetchMostPopularClasses",expires:"+6 hours"},function(e,t){e||!t?n.reject(e):n.resolve(t)}),n.promise},getStaffFavoriteClasses:function(){var n=f.defer();return V(function(t){o.get().$promise.then(function(e){e=U.filter(e,function(e){if(e&&e.badges)return e.badges.staff_favorite});t(null,e)},t)},{key:"CatalogService.FetchStaffFavoriteClasses",expires:"+6 hours"},function(e,t){e||!t?n.reject(e):n.resolve(t)}),n.promise}};function x(e,t){var n=f.defer(),e=U.extend({},e,t);return o.searchLessons(e,function(e){n.resolve(e&&e.data)}),n.promise}function P(e,t){var n=f.defer(),e=U.extend({},e,t);return o.search(e,function(e){n.resolve(e&&e.data)}),n.promise}function M(n,e,r,i){var o=f.defer();return Object.keys(n).forEach(function(e){n[e]||delete n[e]}),F.parallel([function(t){P(n,e).then(function(e){t(null,e)}).catch(t)},function(t){!i&&n.q&&n.searchLessons||r.force?x(n,r).then(function(e){t(null,e)}).catch(t):t(null,[])},function(t){r.is_preview="true",!i&&n.q&&n.searchLessons||r.force?x(n,r).then(function(e){t(null,e)}).catch(t):t(null,[])}],function(e,t){o.resolve({courses:t&&t[0],lessons:t&&t[1],freeLessons:t&&t[2]})}),o.promise}function O(e){var t=f.defer();return t.resolve(e),t.promise}function m(){var i=f.defer();return V(function(t){o.get().$promise.then(function(e){angular.forEach(e||[],function(e){R(e)}),t(!0)},t)},{key:"CatalogService.Fetch",expires:"+5 minutes"},function(r){s().then(function(t){var n;n=f.defer(),V(function(t){o.getPages().$promise.then(function(e){angular.forEach(e||[],function(e){R(e,!1,!0)}),t(!0)},t)},{key:"CatalogService.FetchPages",expires:"+5 minutes"},function(e){e?n.resolve(e):n.reject()}),n.promise.then(function(e){r&&t&&e?i.resolve(r):i.reject()},i.reject)},i.reject)}),i.promise}function s(){var t=f.defer();return V(function(t){o.getBundles().$promise.then(function(e){angular.forEach(e||[],function(e){R(e,!0)}),t(!0)},t)},{key:"CatalogService.FetchBundles",expires:"+5 minutes"},function(e){e?t.resolve(e):t.reject()}),t.promise}function R(t,e,n){try{e?((h[t._id]=t).content_type="bundle",A[t.slug]=t._id):n?t.title&&((S[t._id]=t).content_type="page"):((p[t._id]=t).content_type="course",E[t.slug]=t._id),k[t.nid]=t._id;var r=t.primary_category&&t.primary_category._id||t.primary_category;C[r]||(C[r]=[]),C[r].push(t._id),t.title||(t.title=t.short_title),t.product&&(T[t.product._id||t.product]=t._id),angular.forEach(t.taxonomy||[],function(e){e&&(a[e._id||e]||(a[e._id||e]=[]),a[e._id||e].push(t._id))}),angular.forEach(t.instructors||[],function(e){e&&(I[e._id||e]||(I[e._id||e]=[]),I[e._id||e].push(t._id))})}catch(e){}}function j(r,i,o){if(i=i||{},o=o||{},!angular.isString(r))return f.reject();var a=f.defer();return e.user&&angular.isFunction(e.user.hasContent)&&e.user.hasContent("purchased","course",r)&&(o.owner_only=!0),m().then(function(){var t,e=p[r],n=e||h[r];n?(t=!0,angular.isArray(i.keys)&&angular.forEach(i.keys,function(e){void 0!==n[e]&&null!==n[e]&&null!==n[e][0]||(t=!1)}),i.fetch||!t?D(r,i,o).then(function(t){i.keys&&angular.forEach(i.keys,function(e){n[e]=t[e]}),a.resolve(t)},a.reject):N(n).then(L).then(a.resolve,a.reject)):D(r,i,o).then(a.resolve,a.reject)},a.reject),a.promise}function D(n,e,r){var i,t=f.defer();return r=r||{},F.series([function(t){s().then(function(){var e=h[n];e&&(i=e),t()},function(){t()})},function(t){return!i&&(r.owner_only||r.allow||r.fetch||e.keys)?void u.findById(n,r,e).then(function(e){i=e,t()},function(){t()}):t()},function(t){if(i)return t();l.findById(n,r,e).then(function(e){i=e,t()},function(){t()})}],function(){i?t.resolve(i):t.reject("no results")}),t.promise}function N(t){if(!t.taxonomy||0===t.taxonomy.length||U.isObject(t.taxonomy[0])&&t.primary_category&&!U.isObject(t.primary_category))return _.getByIds([t.primary_category]).then(function(e){return e&&e[0]&&U.isObject(e[0])&&(t.primary_category=e[0]),t});if(!t.taxonomy||0===t.taxonomy.length||U.isObject(t.taxonomy[0]))return f.resolve(t);var n=f.defer();return _.getByIds(t.taxonomy).then(function(e){t.taxonomy=e,t.primary_category&&!U.isObject(t.primary_category)&&(t.primary_category=_.getById(t.primary_category)),n.resolve(t)},n.reject),n.promise}function L(t){if(!t.instructors||0===t.instructors.length||U.isObject(t.instructors[0]))return f.resolve(t);var n=f.defer();return w.findByIds({ids:t.instructors,bff:!0}).then(function(e){t.instructors=e,n.resolve(t)},n.reject),n.promise}function $(t,n,r){var i=f.defer();return m().then(function(){var e=T[t];e?j(e,n,r).then(i.resolve,i.reject):c.findById({id:t}).$promise.then(function(e){i.resolve(e&&e.data&&e.data.source)})},i.reject),i.promise}function g(e,r,i){var t=f.defer();return m().then(function(){r=r||{};var n=[];F.eachSeries(e,function(e,t){j(e,r,i).then(function(e){!e||r.coursesOnly&&"course"!==e.content_type||n.push(e),t()},function(e){t()})},function(){r.sort&&n.sort(function(e,t){var n=r.sortBy||"title",t=(e[n],t[n],t[n]-e[n]);return angular.isNumber(r.sortDir),t}),angular.isNumber(r.limit)&&(n=n.slice(0,r.limit)),t.resolve(n)})},t.reject),t.promise}function B(n,r){var t=f.defer();return n?(s().then(function(){var e=U.chain(h).values().filter(function(e){var t;return r&&"unpublished"===r.allow?U.contains(e.courses,n):(t=e.courses,angular.isObject(t[0])&&(t=U.pluck(t,"_id")),U.contains(t,n)&&e.flagged.published)}).value();t.resolve(e)},t.reject),t.promise):t.reject("no results")}}t.exports=r},{async:21,"cache-stack":32,"node-uuid":50,underscore:void 0}],86:[function(e,t,n){"use strict";t.exports=["$resource","$cacheFactory","config",function(e,t,n){var r=n.cachingDomain+"/api/category/primary",n=e("/api/category",{},{getPrimary:{url:r,cache:!0},getCategoryById:{url:"/api/category/:id",cache:!0},getCategoryBySlug:{url:"/api/category/slug/:slug",cache:!0},updateCategoryById:{method:"PUT",url:"/api/category/:id"}});return n.get=n.getCategoryById,n.clearPrimaryCache=function(){t.get("$http").remove(r)},n}]},{}],87:[function(e,t,n){"use strict";t.exports=["$resource","$q","$timeout","config",function(e,r,i,t){var o={},a=e("/api/data/channel",null,{get:{url:"/api/data/channel/:id",cache:!0},getAll:{url:t.cachingDomain+"/api/channel",cache:!0},query:{isArray:!1,method:"GET"}});return a.findById=function(t){var n=r.defer(),e=o[t];return e?i(function(){n.resolve(e)}):a.getAll(function(e){e.data.forEach(function(e){o[e._id]=e}),n.resolve(o[t])}),n.promise},a}]},{}],88:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e(t.cachingDomain+"/bff/channel/topics",null,{get:{method:"GET",isArray:!0,cache:!0}})}]},{}],89:[function(e,t,n){"use strict";var l=e("underscore"),d=(t.exports=["ChannelTopicResource","$q","DataSet",function(e,i,o){var c={channels:[],topics:[],topicsByChannel:{}};return{get:u,search:function(o,a){var s=i.defer();return u().then(function(e){var n,t=[],r=[],i=0;l.each(c.topics,function(e){(function(e,t){var n,r="",i=!0;e=e.split(" "),l.each(e,function(e){var t;t=e,l.each(["&"],function(e){t=t.replace(e,"")}),(e=t.trim())&&(r+="(?=.*"+l.escape(e)+")")});try{n=new RegExp(r,"i")}catch(e){i=!1}return!!i&&n.test(t)})(o,e.name)&&i<a.limit&&(t.push(e),i++)}),t.length&&(t=l.sortBy(t,"name"),n=l.groupBy(t,function(e){return e.primary_category._id||e.primary_category}),l.each(d,function(e){var t=n[e];t&&(e={_id:e,title:c.channelsById[e].title,topics:t},r.push(e))})),s.resolve(r)}),s.promise},cache:c,getTopicByTaxonomyIds:function(t){var r=i.defer();return u().then(function(e){var n=new o;l.each(t,function(t){l.each(c.topics,function(e){-1!==l.indexOf(e.ids,t)&&n.addToSet(e)})}),r.resolve(n)}),r.promise},getChannelByIds:function(n){var r=i.defer();return u().then(function(e){var t=new o;l.each(n,function(e){t.addToSet(c.channelsById[e])}),r.resolve(t)}),r.promise},getTopicByPageId:function(t){var n=i.defer();return u().then(function(){var e=c.topicsByPageId[t];n.resolve(e)}),n.promise}};function u(r){r=r||{};var t=i.defer();return c.channels.length?t.resolve(c.channels):e.get().$promise.then(function(e){e?(r.sort&&(e=e.sort(function(e,t){var n=r.sortBy||"title",t=(e[n],t[n],t[n]-e[n]);return angular.isNumber(r.sortDir),t})),c.channels=e,c.channelsById=l.indexBy(e,"_id"),c.topics=l.chain(e).pluck("topics").flatten().value(),c.topicsByPageId=l.indexBy(c.topics,"page_id"),c.topicsByChannel=l.indexBy(e,"_id"),t.resolve(e)):t.reject(new Error("ChannelTopicResource returned an empty response."))},t.reject),t.promise}}],["5503288e81dd8b840d980475","5503288e81dd8b840d980476","5503288e81dd8b840d980472","5503288e81dd8b840d980473","5503288e81dd8b840d980477"])},{underscore:void 0}],90:[function(e,t,n){"use strict";t.exports=["UserResource","$rootScope",function(t,e){var n={};return{kickedUsers:n,initKickedUser:function(){t.getKickedUsers({timeInHours:24}).$promise.then(function(e){e.success&&e.data.forEach(function(e){n[e._id]=!0})}),e.$on("join-message",function(e,t){n[t.payload.user]=!1}),e.$on("kick-message",function(e,t){n[t.payload.user]=!0})},kickUser:function(e){return t.kickUser({userId:e}).$promise.then(function(e){e.success})},unkickUser:function(e){return t.unkickUser({userId:e}).$promise.then(function(e){e.success})}}}]},{}],91:[function(e,t,n){"use strict";t.exports=["deepval","config","$rootScope",function(e,u,l){return function(e){var t=l.user.hasContent&&l.user.hasContent("purchased","course",e._id),n=e&&e.flagged&&e.flagged.consumer_subscription&&l.user.hasActiveConsumerSubscription&&l.user.hasActiveConsumerSubscription(),r=l.user.hasActiveEnterpriseSubscription&&l.user.hasActiveEnterpriseSubscription(),i=e&&e.eventData,o=u.classMktgPage||{},a=e.primary_category&&e.primary_category.slug,s=_.find(e.taxonomy,function(e){return e.slug}),c=o.defaultTopic||"general",s=(s&&(c=s.slug),_.contains(o.whitelistedCategories,a)||_.contains(o.whitelistedSlugs,e.slug)),t=!t&&!n&&!r,n=l.user.getTrait&&l.user.getTrait(o.traitsBucketPrefix),r=o.enableTraitsBucketing&&(!0===n||"true"===n);return s&&t&&r&&!i?"/"+a+"/"+c+"/"+e.slug:"/class/"+e.slug}}]},{}],92:[function(e,t,n){"use strict";t.exports=["config",function(e){return{request:function(e){return e}}}]},{}],93:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/counter",{type:"@type"},{getNext:{url:"/api/counter/next/:type"}})}]},{}],94:[function(e,t,n){"use strict";var a=e("moment");t.exports=["$resource","$q","populate","depopulate",function(e,t,r,n){var i={$or:[{$text:{$search:":query"}},{"conditions.coupons":":query"}]},o=e("/api/data/coupon",null,{_get:{url:"/api/data/coupon/:id"},delete:{method:"DELETE",url:"/api/data/coupon/:id"},findByCouponCode:{url:"/api/data/coupon?criteria="+JSON.stringify({coupon_code:{$regex:":query",$options:"i"}})},search:{url:"/api/data/coupon?criteria="+JSON.stringify(i)},searchFuzzy:{url:"/api/data/coupon?criteria="+JSON.stringify({$or:[{$text:{$search:":query"}},{title:{$regex:":query",$options:"i"}},{"conditions.coupons":":query"}]})},searchCount:{url:"/api/count/coupon?criteria="+JSON.stringify(i)+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},findByProduct:{url:"/api/data/coupon?criteria="+JSON.stringify({"conditions.products":":id"})},findByProductDate:{url:"/api/data/coupon?criteria="+JSON.stringify({"conditions.products":":id","conditions.start":{$gte:":start"},"conditions.end":{$lte:":end"}})},getCoupons:{url:"/api/data/coupon"},getCouponsCount:{url:"/api/count/coupon?fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},count:{url:"/api/count/coupon",params:{fields:{_id:1}},responseType:"json"},generate:{method:"POST",url:"/api/ecom/coupon/validator/generate"},getOrderDateByVirtualCoupon:{method:"POST",url:"/api/ecom/order/coupon"},save:{method:"POST",url:"/api/ecom/coupon"}});return o.get=function(n){return t(function(t,e){o._get(n,function(e){r(e.data,"product user",function(){t(e)})})})},o.create=function(e,t){e.created=a().unix(),o.save(e,t)},o}]},{moment:void 0}],95:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/course",{slug:"@slug",id:"@id",topicId:"@topicId"},{get:{url:t.cachingDomain+"/bff/course/:id",cache:!0},getBffBySlug:{url:t.cachingDomain+"/bff/course/slug/:slug",cache:!0},findById:{url:t.cachingDomain+"/bff/course/:id",cache:!0},findBySlug:{url:t.cachingDomain+"/bff/course/slug/:slug",cache:!0},findByNid:{url:"/api/courses/multiple?:ids",cache:!0},getStudentCount:{url:"/api/course/id/:id/counts"},getTileData:{url:"/api/courses/multiple?ids=:ids",cache:!0},findReviewsBySlug:{url:"/api/course/slug/:slug/reviews"},findReviewsByCourseId:{url:"/api/course/id/:id/reviews"},submitReviewBySlug:{url:"/api/course/slug/:slug/reviews",method:"POST"},updateReviewById:{url:"/api/course/:id/reviews/:reviewId",method:"PUT"},getGallery:{url:"/api/galleries/course/:slug",cache:!0},getWatchedData:{url:"/api/user/segments/course/:id"},getByTopic:{url:"/api/course/topic/:id"},addTopic:{method:"POST",url:"/api/course/:id/topic/:topicId"},removeTopic:{method:"DELETE",url:"/api/course/:id/topic/:topicId"},getAllCourses:{url:"/api/courses",cache:!0}})}]},{}],96:[function(e,t,n){"use strict";var O=e("async");t.exports=["$q","$filter","$rootScope","$location","qs","moment","courseResource","lessonResource","ecommerceResource","galleryResource","MediaService","deepval","cacheStack","DataSet","_","scheduleResource","ContentAccessService","SubscriptionService","rind",function(c,f,a,m,g,p,s,t,o,v,r,y,u,e,h,b,n,_,w){var S={},E={},A={},l=new e;return{Resource:s,cacheById:{},lessonCacheById:{},watchDataCache:l,findById:i,findBySlug:function(t,n,r){n=n||{},r=r||{};var i="CourseService.findBySlug:"+t+":"+JSON.stringify(n)+JSON.stringify(r);if(!t)return c.reject("no slug");var o=c.defer();return u(function(e){(r.bff?s.getBffBySlug(angular.extend({slug:t},n)):s.findBySlug(angular.extend({slug:t},n))).$promise.then(h.bind(k,null,r,o,e)).catch(function(){e()})},{key:i},function(e){e=e&&e.data||e;e?(T(e,i),o.resolve(e)):o.reject("[CourseService] No json data")}),o.promise},getLessonList:function(e){var t=c.defer();return u(function(t){return i(e,{},{bff:!0}).then(function(n){var e=h.reduce(n.sessions,function(e,t){return t.segments&&t.segments.length?(1<n.sessions.length&&e.push({type:"session",title:t.title}),e.concat(t.segments)):e},[]);t({courseData:n,lessons:e})}).catch(function(e){t(e)})},{key:"CourseService.getLessonList:"+e},function(e){e&&e.courseData?t.resolve(e):t.reject(e)}),t.promise},getLessonTranscript:function(e){return t.getTranscript({id:e},function(e){return e&&e.data}).$promise},getLessonCaptions:function(e){return t.getCaptions({id:e,format:"json"},function(e){return e&&e.data}).$promise},getMaterialList:function(e){return i(e,{},{bff:!0}).then(C).then(function(e){return{courseData:e,materials:h.chain(e.segments).flatten().value()}}).catch(function(e){return e})},getTokens:C,getSegmentByIdx:function(e,t){return I(e)[t]},cacheWatchData:function(e){e&&e.length&&(l.addToSet(e,"_id"),this.watchDataCache=l)},setWatchData:function(e){var n=I(e);if(!n||!n.length)return null;var r=h.find(e.taxonomy,function(e){return e.topic&&e.topic._id});angular.forEach(n,function(e,t){e.idx=t+1,e.lastIdx=n.length,e.taxonomy=r;t=h.findWhere(l,{segment:e._id});t&&(e.watchData=t,angular.extend(e.watchData,x(e)))})},getWatchData:function(e){return h.where(l,{course:e})},getFurthestSegmentForCourse:function(e){e=I(e);return e&&e.length?(angular.forEach(e,function(e){if(e.watchData)return e}),e[0]):null},getLatestSegmentForCourse:function(e){var t=I(e);if(!t||!t.length)return null;var n=[],r={};angular.forEach(t,function(e){e.watchData&&n.push(e.watchData),r[e._id]=e}),n=h.sortBy(n,"modified").reverse(),l&&(n=h.where(l,{course:e._id}));for(var i=t[0],o=0,a=n.length;o<a;o++){var s=(n[o]||{}).segment;if(s){s=s._id||s;if(s&&r[s]){s=r[s];s.watchData=n[0],i=s;break}}}e=h.findIndex(t,function(e){return e._id===i._id});return i.index=e+1,i},getCourseProgress:function(t){var e=0;if(!a.user.valid())return e;if(!l)return e;var n=h.chain(t.sessions).map(function(e){return h.pluck(e.segments,"_id")}).flatten().value(),r=[];return h.each(l,function(e){e.course===t._id&&r.push(e)}),e=100*r.length/n.length},getSegmentWatchDetails:x,getStudentCount:function(t){var n=c.defer();return u(function(e){s.getStudentCount({id:t},e)},{key:"CourseService.getCounts:"+t,expires:"+5 minutes"},function(e){n.resolve(e&&e.data)}),n.promise},getPrice:P,getReviews:function(e,t){e=E[e];return e?M(e._id,t):c.reject()},getReviewsByCourseId:M,getGallery:function(e,t){var n=c.defer(),r=angular.extend({type:"course",slug:e},t);return u(function(e){v.getImagesByTypeSlug(r).$promise.then(e,e)},{key:"CourseService.getGallery:"+JSON.stringify(r),expires:"+5 minutes"},function(e){e&&e.success?n.resolve(e&&e.data):n.reject(e)}),n.promise},getPromoVideo:function(n){var t=c.defer();return n&&n.promo&&n.promo.length?(u(function(e){var t=y(n,"promo.0.media");t.play_url?r.tokenById(t._id).then(e,function(){e()}).catch(function(){e()}):e()},{key:"CourseService.getPromoVideo:"+n._id,expires:"+5 minutes"},function(e){e?t.resolve({playUrl:e}):t.reject()}),t.promise):t.reject()},getCourseTaxonomy:function(e,t){return i(e,{},angular.extend({bff:!0},t)).then(function(e){return{courseData:e,channel:e.primary_category,primary_category:e.primary_category,topics:h.filter(e.taxonomy,function(e){return e.primary_category})}}).catch(function(e){return e})},getSharingData:function(e,d){return i(e,{},{bff:!0}).then(function(e){var t=(d.clUrl||m.absUrl()).split("?")[0],n=d.segmentId||"",r=(!n&&d.segmentSlug&&e.sessions&&(r=h.chain(e.sessions).pluck("segments").flatten().value(),(r=h.findWhere(r,{slug:d.segmentSlug}))&&r._id&&(n=r._id)),{utm_medium:"social-share",utm_campaign:e._id+"_"+n+"_"+p().format("YYYY-MM-DD")}),n=t+g.stringify(angular.extend({utm_source:"student-email"},r)),i=t+g.stringify(angular.extend({utm_source:"twitter"},r)),o=t+g.stringify(angular.extend({utm_source:"pinterest"},r)),a=t+g.stringify(angular.extend({utm_source:"facebook"},r)),r=t+g.stringify(angular.extend({utm_source:"linkedin"},r)),s={title:d.clTitle||e.short_title,url:t,course:e,emailLink:n,twitterLink:i,pinterestLink:o,facebookLink:a,linkedinLink:r,image:f("magick")(e.image,{width:300})},c=d.clTweetText||f("i18n")("cl-cta-share-course-retweet-text","Check out this amazing class from CreativeLive",s),u=d.clEmailSubject||f("i18n")("cl-cta-share-course-email-subject","Check out {{ title }}",s),l=d.clEmailBody||f("i18n")("cl-cta-share-course-email-body","Thought you might be interested in {{ title }} on CreativeLive. You can take a look here: {{ emailLink }}",s);return{url:t,courseData:e,tweetText:c,twitterLink:i,pinterestLink:o,facebookLink:a,linkedinLink:r,emailSubject:u,emailBody:l,emailLink:n,linkedinUrl:"https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(r),twitterUrl:"https://twitter.com/intent/tweet?url="+encodeURIComponent(i)+"&text="+encodeURIComponent(c),facebookUrl:"https://www.facebook.com/dialog/share?app_id=406852872685050&href="+encodeURIComponent(a),pinterestUrl:"https://pinterest.com/pin/create/button/?url="+encodeURIComponent(o)+"&media="+encodeURIComponent(s.image)+"&description="+c,emailUrl:"mailto:?subject="+encodeURIComponent(u)+"&body="+encodeURIComponent(l)}}).catch(function(e){return e})},getScheduleData:function(e,a){if(!e)return c.reject("no courseId");var s=c.defer();return i(e,{},{bff:!0}).then(function(i){var o={courseData:i};a.getEventsByCourseId(i._id).then(function(e){var t,n,r,e=e[0];e?(o.event_is_container=e.is_container,n=a.getEventBroadcastData(e),t=y(e,"product.source"),t=a.organizeBroadcastsForSource(n.all,i,t),r=n.first,(n=n.all.reverse().find(function(e){return e.broadcast_type&&"live"===e.broadcast_type}))&&(o.inAudienceTime=d(r.start_time,n.end_time)),r=function(e,t){var n={current:e.current,next:e.next,schedule:e.current||e.next||{}};n.schedule.eventId=n.schedule.eventId||t,e.lives.length&&e.rebroadcasts.length?(t=e.lives.concat(e.rebroadcasts),t=h.sortBy(t,"start_time"),n.broadcast=d(h.first(t).start_time,h.last(t).end_time)):e.lives.length?(n.liveBroadcast=!0,n.broadcast=d(h.first(e.lives).start_time,h.last(e.lives).end_time)):e.rebroadcasts.length?n.broadcast=d(h.first(e.rebroadcasts).start_time,h.last(e.rebroadcasts).end_time):e.schedule&&(n.broadcast=d(schedule.start_time,schedule.end_time));return n}(t,e._id),angular.extend(o,r),s.resolve(o)):b.findByContentId({id:i._id,after:p().unix()}).$promise.then(function(e){e=h.first(e&&e.data);e&&(o.schedule=e,o.broadcast=d(e.start_time,e.end_time)),s.resolve(o)})}).catch(s.reject)}).catch(s.reject),s.promise},getWhatYouGetData:function(e){if(!e)return c.reject("No course id");var t=c.defer(),r={};return O.series([function(n){i(e,{},{bff:!0}).then(function(e){var t;e.flagged?t=e.flagged.for_sale:e.flags&&(t=-1<e.flags.indexOf("for_sale")),r.courseId=e._id,r.segmentsLength=I(e).length,r.hasBonusMaterial=0<function(e,t){var n=e;angular.isObject(n)||(n=S[e]);return n?h.where(n.segments,{required_access:t}):null}(e,"purchase").length,r.hasForSaleFlag=t,r.productId=e.product&&e.product._id,r.duration=e.duration,n()}).catch(n)},function(t){a.user.hasContent?n("course",r.courseId).then(function(e){r.hasAccess=e.owned||e.subscribed||e.comped,t(null,r)}).catch(t):(r.hasAccess=!1,t())},function(t){P(r.productId).then(function(e){r.current_price=e.current_price,t()}).catch(t)}],function(e){if(e)return t.reject(e);t.resolve(r)}),t.promise}};function i(t,n,r){r=r||{},!(n=n||{}).owner_only&&a.user&&angular.isFunction(a.user.hasContent)&&(a.user.hasContent("purchased","course",t)?n.owner_only=!0:(w.dump.isLMS&&(n.owner_only=!0),n.subscription_only=!0));var i="CourseService.findById:"+t+":"+JSON.stringify(n)+JSON.stringify(r),o=c.defer();return t?(u(function(e){(r.bff?s.get(angular.extend({id:t},n)):s.findById(angular.extend({id:t},n))).$promise.then(h.bind(k,null,r,o,e)).catch(function(){e()})},{key:i},function(e){var t=e&&e.data||e;t?(T(t,i),t.consumer_subscriptions=!1,_.getSubscriptionsByUser().then(function(e){return e}).catch(function(e){return e}).then(function(e){return 0<h.filter(e,function(e){return e&&"consumer"===e.type}).length}).then(function(e){t.consumer_subscriptions=e,o.resolve(t)}).catch(function(e){o.resolve(t)})):o.reject("[CourseService] No json data")}),o.promise):c.reject("no id")}function k(e,t,n,r){r&&!r.error?n(r):n()}function T(t,e){t&&(t.flagged||(t.flagged={},h.each(t.flags,function(e){"!"===e[0]?(e=e.substr(1),t.flagged[e]=!1):t.flagged[e]=!0})),S[t._id]=t,E[t.slug]=t,e&&(A[e]=t))}function C(t){return r.getCourseTokensBySlug(t.slug).then(function(e){return t.tokens=e,t})}function I(e){var t=e;return(t=angular.isObject(t)?t:S[e])?h.chain(t.sessions).pluck("segments").flatten().value():null}function x(e){var t,n={},r=y(e,"media.0.duration");return r&&e.watchData&&(e=e.watchData.latestIndex||e.watchData.furthestIndex,e=Math.floor(e/1e3),t=f("pad")(e%60),n.watchProgressString=Math.floor(e/60)+":"+t,n.totalSegmentLengthString=Math.floor(r/60)+":"+f("pad")(r%60),n.progressPercent=e/r*100),n}function P(t){var n=c.defer(),e="CourseService.getPrice:"+t,r="price",i=a.user&&a.user.get("_id");return i&&(r="userPrice",e+=":"+i),u(function(e){o[r]({productId:t,userId:i}).$promise.then(e,e)},{key:e,expires:"+5 minutes"},function(e){n.resolve(e&&e.data)}),n.promise}function M(e,t){var n=c.defer(),r=angular.extend({id:e},t);return u(function(e){s.findReviewsByCourseId(r).$promise.then(e,function(){e()})},{key:"CourseService.getReviewsByCourseId:"+e+JSON.stringify(t||{}),expires:"+5 minutes"},function(e){e&&e.data?n.resolve(e.data):n.reject()}),n.promise}function d(e,t){var n=p().unix(),n={start:e,end:t,playingNow:e<=n&&n<=t};return p.unix(t).diff(p.unix(e),"minutes")<=1440&&(n.singleDay=!0),p.unix(e).month()===p.unix(t).month()&&(n.singleMonth=!0),n}}]},{async:21}],97:[function(e,t,n){"use strict";var c=e("moment");t.exports=["$resource","$q","populate","depopulate",function(e,t,r,n){var i={$text:{$search:":query"},"actions.type":"discount"},o={$text:{$search:":query"},"actions.type":"cross-sell"},a={$text:{$search:":query"},"actions.type":"discount"},s=e("/api/data/discount",null,{_get:{url:"/api/data/discount/:id"},delete:{method:"DELETE",url:"/api/data/discount/:id"},findByCouponCode:{url:"/api/data/discount?criteria="+JSON.stringify({coupon_code:{$regex:":query",$options:"i"}})},search:{url:"/api/data/discount?criteria="+JSON.stringify(i)},searchCrossSell:{url:"/api/data/discount?criteria="+JSON.stringify(o)},searchDiscount:{url:"/api/data/discount?criteria="+JSON.stringify(a)},searchCount:{url:"/api/count/discount?criteria="+JSON.stringify(i)+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},searchDiscountCount:{url:"/api/count/discount?criteria="+JSON.stringify(a)+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},searchCrossSellCount:{url:"/api/count/discount?criteria="+JSON.stringify(o)+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},findByProduct:{url:"/api/data/discount?criteria="+JSON.stringify({"conditions.products":"id::id"})},findCrossSellsByTargetProduct:{url:"/api/data/discount?criteria="+JSON.stringify({"actions.type":"cross-sell","actions.products":"id::id"})},findByProductDate:{url:"/api/data/discount?criteria="+JSON.stringify({"conditions.products":"id::id","conditions.start":{$gte:":start"},"conditions.end":{$lte:":end"}})},getDiscounts:{url:"/api/data/discount?criteria="+JSON.stringify({"actions.type":"discount"})},getDiscountsCount:{url:"/api/count/discount?criteria="+JSON.stringify({"actions.type":"discount"})+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},getCrossSells:{url:"/api/data/discount?criteria="+JSON.stringify({"actions.type":"cross-sell"})},getCrossSellsCount:{url:"/api/count/discount?criteria="+JSON.stringify({"actions.type":"cross-sell"})+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data.count=e.data.data.length,e}}},filter:{url:"/api/data/discount?criteria=:filterOpts"},searchActive:{url:"/api/data/discount?criteria="+JSON.stringify({$text:{$search:":query"},"conditions.start":{":startCondition":Date.now()/1e3},"conditions.end":{":endCondition":Date.now()/1e3}})},searchUpcoming:{url:"/api/data/discount?criteria="+JSON.stringify({$text:{$search:":query"},"conditions.start":{":startCondition":Date.now()/1e3}})},searchPast:{url:"/api/data/discount?criteria="+JSON.stringify({$text:{$search:":query"},"conditions.end":{":endCondition":Date.now()/1e3}})},count:{url:"/api/count/discount",params:{fields:{_id:1}},responseType:"json"}});return s.get=function(n){return t(function(t,e){s._get(n,function(e){r(e.data,"product user",function(){t(e)})})})},s._save=s.save,s.save=function(e,t){e=n(angular.copy(e),["product","user"]);return s._save({},e,t,t)},s.create=function(e,t){e.created=c().unix(),s.save(e,t)},s}]},{moment:void 0}],98:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/discount",{},{getBff:{url:t.cachingDomain+"/bff/discounts",cache:!0,isArray:!0}})}]},{}],99:[function(e,t,n){"use strict";r.$inject=["$q","clDiscountResource","CatalogService","cacheStack","DataSet","_"];var l=e("async");function r(r,i,o,a,s,c){var u={};return{Resource:i,findCrossSellById:function(e){var t=r.defer(),n=[];return function(){var t=r.defer();return a(function(t){i.getBff().$promise.then(function(e){angular.forEach(e||[],function(e){var t,n;"cross-sell"===e.type&&(t=void 0,n=[],c.each(e.conditions,function(e){e.products&&e.products[0]&&(t=e.products[0])}),c.each(e.actions,function(e){e.products&&e.products.length&&(n=e.products)}),u[t]||(u[t]=new s),t&&n.length&&u[t].addToSet(n),c.each(n,function(e){u[e]||(u[e]=new s),t&&e&&u[e].addToSet(t)}))}),t(!0)},t)},{key:"DiscountService.Fetch",expires:"+5 minutes"},function(e){e?t.resolve(e):t.reject()}),t.promise}().then(function(){l.each(u[e],function(e,t){o.getCourseByProduct(e).then(function(e){n.push(e),t()},function(e){t(e)})},function(e){e||t.resolve(n),t.reject()})}),t.promise}}}t.exports=r},{async:21}],100:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/ecom",{},{price:{url:"/api/ecom/price/:productId",cache:!0},prices:{url:t.cachingDomain+"/bff/product/price/:productIds",method:"GET",isArray:!0,cache:!0},userPrice:{url:"/api/ecom/price/:productId/user/:userId",cache:!0}})}]},{}],101:[function(e,t,n){"use strict";t.exports=["$cacheFactory",function(e){return e("EnterpriseAccount")}]},{}],102:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/enterprise";return e(t,null,{getAccounts:{method:"GET",url:t,isArray:!1},get:{method:"GET",url:t+"/id/:id",params:{id:"@id"},isArray:!1},getByName:{method:"GET",url:t+"/name/:name",params:{name:"@name"},isArray:!1},getFromSubscription:{method:"GET",url:t+"/subscription/:subscriptionId",params:{subscriptionId:"@subscriptionId"},isArray:!1},create:{method:"POST",url:t,isArray:!1},update:{method:"PUT",url:t+"/:id",params:{id:"@_id"},isArray:!1},remove:{method:"DELETE",url:t+"/:id",params:{_id:"@id"},isArray:!1},count:{method:"GET",url:t+"/count",isArray:!1},searchCount:{method:"GET",url:t+"/count",isArray:!1},getEnterpriseProducts:{method:"GET",url:t+"-product",isArray:!1},getEnterpriseProductsBySkus:{method:"GET",url:t+"-product-by-skus",isArray:!1},getEnterpriseProductById:{method:"GET",url:t+"-product/:id",isArray:!1},createEnterpriseProduct:{method:"POST",url:t+"-product"},updateEnterpriseProduct:{method:"PUT",url:t+"-product/:id",params:{id:"@_id"}},deleteEnterpriseProduct:{method:"DELETE",url:t+"-product/:id",params:{id:"@_id"}},countEnterpriseProducts:{method:"GET",url:t+"-product/count",isArray:!1},checkout:{method:"POST",url:t+"/checkout",isArray:!1,headers:{"x-recaptcha-token":function(e){var t=e&&e.data&&e.data.captchaToken;return t&&delete e.data.captchaToken,t}},interceptor:{response:function(e){return e&&e.data}},transformResponse:function(e,t){return t().location}},getToken:{method:"GET",url:t+"/checkout/token",isArray:!1},getOrders:{method:"GET",url:t+"/order/search",isArray:!1},getOrder:{method:"GET",url:t+"/order/:id",isArray:!1}})}]},{}],103:[function(e,t,n){"use strict";function r(i,n,r){return{getAccounts:function(){return r.wrapResponse(i.getAccounts().$promise)},get:function(e){return r.wrapResponse(i.get({id:e}).$promise)},getByName:function(e){return r.wrapResponse(i.getByName({name:e}).$promise)},getFromSubscription:function(e){return r.wrapResponse(i.getFromSubscription({subscriptionId:e}).$promise)},create:function(e){return r.wrapResponse(i.create(e).$promise)},update:function(e){return r.wrapResponse(i.update(e).$promise)},remove:function(e){return r.wrapResponse(i.remove({id:e}).$promise)},getEnterpriseProducts:function(e){return r.wrapResponse(i.getEnterpriseProducts(e).$promise)},getEnterpriseProductsBySkus:function(e){return r.wrapResponse(i.getEnterpriseProductsBySkus(e).$promise)},getEnterpriseProductById:function(e,t){e=r.wrapResponse(i.getEnterpriseProductById({id:e}).$promise);return t?e.then(function(t){return n.getContentById(t.content).then(function(e){return angular.extend(t,{content:e})})}):e},updateEnterpriseProduct:function(e){return r.wrapResponse(i.updateEnterpriseProduct(e).$promise)},createEnterpriseProduct:function(e){return r.wrapResponse(i.createEnterpriseProduct(e).$promise)},deleteEnterpriseProduct:function(e){return r.wrapResponse(i.deleteEnterpriseProduct({id:e}).$promise)},checkout:function(e,t,n,r){return i.checkout({accountInfo:e,nonce:t,cart:n,captchaToken:r}).$promise},getToken:function(){return r.wrapResponse(i.getToken().$promise)},getOrders:function(e,t){return r.wrapResponse(i.getOrders({skip:e,limit:t}).$promise)},getOrder:function(e){return r.wrapResponse(i.getOrder({id:e}).$promise)}}}r.$inject=["EnterpriseResource","SavedSearchService","responseUtils"],t.exports=r},{}],104:[function(e,t,n){"use strict";r.$inject=["$timeout","$q","CatalogService","PlaylistService","channelResource","deepval"];var p=e("underscore");function r(s,c,u,l,d,f){return function(e){var i=this;function t(){var t=Math.round(new Date/1e3);i.nextBroadcast=null,i.prevBroadcast=null,i.currentBroadcast=null,i.broadcasts.sort(function(e,t){return e.start_time-t.start_time}),angular.forEach(i.broadcasts,function(e){!i.currentBroadcast&&e.start_time<=t&&e.end_time>=t?i.currentBroadcast=e:!i.nextBroadcast&&e.start_time>t?i.nextBroadcast=e:!i.prevBroadcast&&e.end_time<t&&(i.prevBroadcast=e)})}function n(e){var t,n=f(e||{},"broadcast.content.content_id"),r=f(e||{},"broadcast.content.content_type"),n=n||f(e||{},"content.content_id"),r=r||f(e||{},"content.content_type");return(n=n&&n._id?n._id:n)?"playlist"===r?(e=n,t=c.defer(),l.findById(e).then(function(e){e=f(e||{},"segments.0.course");u.getCourseById(e).then(function(e){t.resolve(e)})}),t.promise):u.getCourseById(n):c.reject()}function r(){var e=c.defer();return i.currentBroadcast?(n(i.currentBroadcast).then(e.resolve,e.resolve),e.promise):c.reject("no current broadcast")}function o(){var e=c.defer();return i.nextBroadcast?(n(i.nextBroadcast).then(e.resolve,e.resolve),e.promise):c.reject("no upcoming broadcast")}function a(){var e=c.defer();return i.prevBroadcast?(n(i.prevBroadcast).then(e.resolve,e.resolve),e.promise):c.reject("no previous broadcast")}angular.extend(i,{setBroadcasts:function(n){var r=c.defer();return i.broadcasts=n,i.getCurrentBroadcast(),i.broadcastStart(),i.setNextTimer(),d.getAll().$promise.then(function(e){var t=p.indexBy(e&&e.data,"_id");angular.forEach(n,function(e){e.channel&&(e.channel=t[e.channel._id||e.channel])}),r.resolve()},r.reject),r.promise},getUpdatedData:function(){var e=c.defer(),t={};function n(e){}return r().then(function(e){e=p.pick(e,"image","title","short_title","instructors","content_type","product","slug","_id","flagged");e.broadcast=p.pick(i.currentBroadcast,"broadcast_type","end_time","start_time"),t.currentBroadcast=e},n).then(o).then(function(e){e=p.pick(e,"image","title","short_title","instructors","content_type","product","slug","_id","flagged");e.broadcast=p.pick(i.nextBroadcast,"broadcast_type","end_time","start_time"),t.nextBroadcast=e},n).then(a).then(function(e){e=p.pick(e,"image","title","short_title","instructors","content_type","product","slug","_id","flagged");e.broadcast=p.pick(i.prevBroadcast,"broadcast_type","end_time","start_time"),t.prevBroadcast=e},n).then(function(){e.resolve(t)}),e.promise},getCourse:r,getNextCourse:o,getPrevCourse:a,getCurrentBroadcast:function(){return t(),i.currentBroadcast},getNextBroadcast:function(){return t(),i.nextBroadcast},getPrevBroadcast:function(){return t(),i.prevBroadcast},setNextTimer:function(){i.currentBroadcast&&i.currentBroadcast.channel?i.startTimer(i.currentBroadcast.end_time):i.nextBroadcast&&i.startTimer(i.nextBroadcast.start_time)},startTimer:function(e){var t=Math.round(new Date/1e3),e=e-t+1;86400<e&&(e=86400);s.cancel(i.timeout),i.timeout=s(function(){i.getCurrentBroadcast(),i.broadcastStart(),i.setNextTimer()},1e3*e)},broadcastStart:function(){i.onBroadcastStart(i.currentBroadcast)},onBroadcastStart:angular.noop},e)}}t.exports=r},{underscore:void 0}],105:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/event/:id",{id:"@id"},{get:{cache:!0},search:{url:"/api/event"},findById:{url:t.cachingDomain+"/bff/event/:id"},materials:{url:t.cachingDomain+"/api/event/:id/materials"},counts:{url:t.cachingDomain+"/bff/event/:id/counts"},getBFF:{url:t.cachingDomain+"/bff/events",cache:!0,isArray:!0}})}]},{}],106:[function(e,t,n){"use strict";r.$inject=["$filter","$q","_","deepval","cacheStack","CatalogService","eventResource","channelResource","broadcastService","DataSet"];var T=e("async"),C=e("moment"),e=C.duration(5,"days").asSeconds(),I={pre_live:{name:"Pre-Live",start:8,duration:1,maxDuration:e,icon:"fa-desktop",continuation:!1,content_type:"course"},live:{name:"Live",start:9,duration:7,maxDuration:e,icon:"fa-video-camera",continuation:!1,content_type:"course"},rebroadcast:{name:"Rebroadcast",start:16,duration:16,maxDuration:e,icon:"fa-repeat",continuation:!0,content_type:"course"},rebroadcast_edited:{name:"Rebroadcast Edited",start:9,duration:24,maxDuration:e,icon:"fa-film",continuation:!1,content_type:"playlist"},playlist:{name:"Playlist",start:9,duration:24,maxDuration:e,icon:"fa-list",continuation:!0,content_type:"playlist"},base_playlist:{name:"Base Playlist",start:9,duration:24,maxDuration:e,icon:"fa-list",continuation:!0,content_type:"basePlaylist"},link:{name:"Link",start:9,duration:8,icon:"fa-link",continuation:!1,content_type:null}},x={event:{},query:{},pending:{},broadcast:{},broadcasts:[],events:[]};function r(n,a,l,p,h,u,i,e,m,o){var t=[],g={},s={},r={},c={},d={};return{byEventId:s,byCourseId:r,ByCategoryId:c,byInstructorId:d,broadcastTypes:I,Resource:i,get:function(e){var t=a.defer();return h(function(n){i.get(e,function(t){if(!t||!t.data||!t.data.length)return n(t);T.eachSeries(t&&t.data,function(i,o){a.resolve().then(function(){var e=p(i,"product.source.source_id");if(e)return u.getCourseById(e,{},{allow:"unpublished"})}).then(function(t){var n=void 0,r=(n=(t||i).primary_category).slug,e=l.chain(i.swimlanes).pluck("broadcasts").flatten().value();l.each(e,function(e){e.eventId=i._id,e.channel=g[e.channel],i.is_container&&(x.event[i._id]||(x.event[i._id]=!0,x.events.push({id:i._id,title:i.title,allDay:!0,start_time:i.start_time,end_time:i.end_time,start:C.unix(i.start_time).startOf("day").toDate(),end:C.unix(i.end_time).endOf("day").add(1,"second").toDate(),className:"event-type-allday event-type-live bg-"+r+"-lighter bd-"+r+"-lighter",url:"/admin/scheduler/#/event/"+i._id,primary_category:n,broadcast:e}))),x.broadcast[i._id+"-"+e._id]||(x.broadcast[i._id+"-"+e._id]=!0,e={id:e._id,title:t?t.short_title||t.title:e.title||i.title,allDay:!1,start_time:e.start_time,end_time:e.end_time,start:C.unix(e.start_time).toDate(),end:C.unix(e.end_time).toDate(),className:"event-type-"+e.broadcast_type+" bg-"+r+"-lighter bd-"+r+"-lighter",url:"/admin/scheduler/#/event/"+i._id,primary_category:n,broadcast:e},x.broadcasts.push(e))}),o()}).catch(function(){o()})},function(e){n(t)})})},{key:"EventService:get:"+JSON.stringify(e),expires:"+30 seconds"},t.resolve),t.promise},addToCache:function(e,t,n){x[e][t]=n},cache:x,channels:t,channel:g,getChannels:function(){return e.getAll(function(e){return(t=e.data).forEach(function(e){g[e._id]=e}),t}).$promise},getEventUIData:function(t){var n=a.defer();{var e;t.product?(e=t.product._id||t.product,u.getCourseByProduct(e).then(function(e){e.start_time=t.start_time,e.end_time=t.end_time,n.resolve(e)},n.reject)):n.resolve(t)}return n.promise},getCurrentLiveEvents:function(e){var t=[];return e=l.sortBy(e,"start_time"),angular.forEach(e,function(e){e.live&&t.push(e)}),t},getNearestEvent:function(e){var t=Math.round(new Date/1e3);return(e=l.chain(e).filter(function(e){return e.start_time>t}).sortBy("start_time").value())[0]},getEventBroadcastData:_,organizeEventsForCalendar:function(e,t){var i=[],o=[],a=[],s=[],c=C();T.each(e,function(e,t){var n=e,r=function(){y(e),e.currentBroadcast?(e.type="onair",i.push(e)):C.unix(e.end_time).isBefore(c)?(e.type="history",a.push(e)):e.live||C.unix(e.start_time).isAfter(c)?(e.type="upcoming",o.push(e)):(e.type=void 0,s.push(e)),t()};n.product&&!function(e){return p(e,"product.source._id")}(n)?u.getCourseByProduct(n.product._id||n.product).then(function(e){n.product={source:e},r()}):r()},function(){t({onair:i,upcoming:o,history:a,unknown:s})})},organizeBroadcastsForSource:function(e,n,r){var t,i,o=[],a=[],s=[];{var c,u;e&&(c=Math.round(new Date/1e3),e.sort(function(e,t){return e.start_time-t.start_time}),u=e&&e[0]&&e[0].eventId,l.each(e,function(e){var t=e.meta&&e.meta.courses;(e.content.content_id&&(e.content.content_id._id||e.content.content_id))!==n._id&&!l.contains(t,n._id)||e.eventId!==u||("pre_live"===e.broadcast_type?o.push(e):"live"===e.broadcast_type?a.push(e):e.broadcast_type.match(/playlist|rebroadcast/)&&s.push(e)),!r||n._id!==r.source_id||"rebroadcast_edited"!==e.broadcast_type&&"playlist"!==e.broadcast_type||(e.content.content_id=r.source_id,e.content.content_type=r.source_type,s.push(e))}),l.each([o,a,s],function(e){t&&i||l.each(e,function(e){!t&&e.start_time<=c&&e.end_time>=c?t=e:!i&&e.start_time>c&&(i=e)})}))}return{lives:a,rebroadcasts:s,current:t,next:i}},addEventBroadcastData:y,getMaterials:function(e,n){var t=a.defer();return h(function(t){i.materials({id:e,requiredAccess:n},function(e){t(e&&e.data)})},{key:"EventService:getMaterials:"+e+n},t.resolve),t.promise},fetch:f,getUpcomingEvents:function(){return f().then(function(){return l.sortBy(l.values(s),"start_time")})},getEventById:function(n){if(!angular.isString(n))return a.reject();var r=a.defer();return f().then(function(){var e,t=s[n];t?r.resolve(t):(e=n,t=a.defer(),h(function(t){i.findById({id:e},function(e){t(e&&e.data||e)})},{key:"EventService:findById:"+e},t.resolve),t.promise.then(function(e){e?(s[n]=e,r.resolve(e)):r.reject()}))},r.reject),r.promise},getEventsByCourseId:S,getEventsByCategoryId:E,getEventsByInstructorId:function(e){return f().then(function(){return d[e]})},getCurrentEventsByCourseId:A,getCurrentEventsByCategoryId:function(e){if(!angular.isString(e))return a.reject();var r=a.defer();return E(e).then(function(e){var t=C().unix(),n=[];angular.forEach(e||[],function(e){e.start_time<=t&&e.end_time>=t&&n.push(e)}),n.length?r.resolve(n):r.reject()},r.reject),r.promise},getUpcomingEventsByCategoryId:function(e){if(!angular.isString(e))return a.reject();var r=a.defer();return E(e).then(function(e){var t=C().unix(),n=[];angular.forEach(e||[],function(e){e.start_time>t&&n.push(e)}),n.length?r.resolve(n):r.reject()},r.reject),r.promise},getCurrentBroadcast:k,getCurrentBroadcastByCourseId:function(e){if(!e)return a.reject("no courseId");var n=a.defer();return A(e).then(function(t){k(t[0]._id,e).then(function(e){e.eventId=t[0]._id,n.resolve(e)},n.reject)},n.reject),n.promise},getNextBroadcast:function(n,r){if(!n)return a.reject("no eventId");a.defer();return f().then(function(){var e=s[n];if(!e)return a.reject("no event");var t=new m,e=e.swimlanes[r||0];return t.setBroadcasts(e.broadcasts).then(function(){var e=t.getNextBroadcast();return e||a.reject("no nextBroadcast")})})},isCurrentlyStreaming:b,getInstructors:function(n){return f().then(function(){var t,e=s[n];if(e)return e=l.chain(e.swimlanes).pluck("broadcasts").flatten().pluck("content").flatten().filter(function(e){return"course"===e.content_type||"bundle"===e.content_type}).pluck("content_id").flatten().value(),t=new o,u.getCoursesByIds(e).then(function(e){e=l.chain(e).pluck("instructors").flatten().value();return t.addEachToSet(e,"_id"),t})})},getEventCategory:v,getEventTaxonomy:function(e){if(e.taxonomy&&0<e.taxonomy.length)return e.taxonomy;return(e.product&&e.product.source||{}).taxonomy||[]},getEventImage:function(e){var t=e.product&&e.product.source||{};return(e.image&&("string"==typeof e.image||e.image.file)?e.image.file:t.image)||""},getEventTitle:function(e){var t=e.product&&e.product.source||{};return e.title||t.title},getEventShortTitle:function(e){var t=e.product&&e.product.source||{};return e.title||t.short_title},getEventInstructors:function(e){var t=e.product&&e.product.source||{};return(e.instructors&&0<e.instructors.length?e:t).instructors},isEventEnrollable:function(e){var t=e.product&&e.product.source||{};return t.flagged&&t.flagged.allow_enrollment||e.flags&&0<=e.flags.indexOf("allow_enrollment")},isEventOnCalendar:function(e){var t=e.product&&e.product.source||{};return t.flagged&&t.flagged.on_calendar||e.flags&&0<=e.flags.indexOf("on_calendar")},getEventUrl:function(e){var t=e.product&&e.product.source||{};return e.url||n("linkToSource")(t)||""},isEventLiveNow:function(e){e.hasOwnProperty("currentBroadcast")||y(e);if(!e.currentBroadcast)return!1;var t=e.currentBroadcast.broadcast_type;return"live"===t||"live_event"===e.revenue_attribution&&"link"===t},getEventIsNew:function(e){return e.label&&e.label.new}};function v(e){return e.primary_category||e.product&&e.product.source&&e.product.source.primary_category}function y(e){var t=_(e).all,n=(e.currentBroadcast=l.find(t,b),e.onAirNow=void 0!==e.currentBroadcast,"live_event"===e.revenue_attribution),t=l.filter(t,function(e){return"live"===e.broadcast_type||"link"===e.broadcast_type&&n});t.length&&(e.hasLiveBroadcasts=!0,e.liveStartTime=l.first(t).start_time,e.liveEndTime=l.last(t).end_time)}function b(e){var t=C();return C.unix(e.start_time).isBefore(t)&&C.unix(e.end_time).isAfter(t)}function _(e){if(!e)return{all:[]};var t=[];return(t=(l.isArray(e)?l.chain(e).pluck("swimlanes").flatten():l.chain(e.swimlanes)).pluck("broadcasts").flatten().value()).sort(function(e,t){return e.start_time-t.start_time}),{all:t,first:l.first(t),last:l.last(t)}}function f(){var t=a.defer();return h(function(t){i.getBFF().$promise.then(function(e){angular.forEach(e||[],function(e){var t=e,n=(s[t._id]=t,new o),e=p(t||{},"product.source")||{},r=("course"===e.source_type&&(e=e.source_id,n.addToSet(e),w(e,t)),t),i=v(r);i&&(i=l.isString(i)?i:i._id,c[i]||(c[i]=new o),c[i].addToSet(r,"_id")),e=l.chain(t.swimlanes).pluck("broadcasts").flatten().pluck("content").flatten().value(),angular.forEach(e,function(e){"course"===e.content_type&&(n.addToSet(e.content_id),w(e.content_id,t))}),u.getCoursesByIds(n,{bff:!0}).then(function(e){e=l.chain(e).pluck("instructors").flatten().reject(function(e){return!e}).value();angular.forEach(e,function(e){d[e._id]||(d[e._id]=new o),d[e._id].addToSet(t,"_id")})})}),t(!0)},t)},{key:"EventService.Fetch",expires:"+5 minutes"},function(e){e?t.resolve(e):t.reject()}),t.promise}function w(e,t){r[e]||(r[e]=new o),r[e].addToSet(t,"_id")}function S(t){if(!angular.isString(t))return a.reject();var n=a.defer();return f().then(function(){var e=r[t];e?n.resolve(e):n.reject()},n.reject),n.promise}function E(t){if(!angular.isString(t))return a.reject();var n=a.defer();return f().then(function(){var e=c[t];e?n.resolve(e):n.reject()},n.reject),n.promise}function A(e){if(!angular.isString(e))return a.reject();var r=a.defer();return S(e).then(function(e){var t=C().unix(),n=[];angular.forEach(e||[],function(e){e.start_time<=t&&e.end_time>=t&&n.push(e)}),n.length?r.resolve(n):r.reject()},r.reject),r.promise}function k(r,i){if(!r)return a.reject("no eventId");a.defer();return f().then(function(){var e=s[r];if(!e)return a.reject("no event");var t=new m,n=0,e=(1<e.swimlanes.length&&i&&e.swimlanes.forEach(function(e,t){0!==t&&l.chain(e.broadcasts).pluck("content").pluck("content_id").flatten().value().includes(i)&&(n=t)}),e.swimlanes[n]);return t.setBroadcasts(e.broadcasts).then(function(){var e=t.getCurrentBroadcast();return e||a.reject("no currentBroadcast")})})}}t.exports=r},{async:21,moment:void 0}],107:[function(e,t,n){"use strict";t.exports=["$http",function(t){return{init:function(e){return t.post("/bff/fb-oauth-init",e,{headers:{Authorization:!0}})}}}]},{}],108:[function(e,t,n){"use strict";t.exports=["$rootScope","$q","$window","Vault","FacebookResource",function(t,r,i,o,n){return{login:function(e){if(!window.FB)return r.reject();if(e)return s(!0);return function(){var t=r.defer();return window.FB.getLoginStatus(function(e){t.resolve(e)},!0),t.promise}().then(function(e){return"connected"===e.status?a(e):s(!1)})}};function a(e){return n.init(e).then(function(e){return t.user.Auth.facebook(e.data)}).catch(function(n){return n&&400!==n.status?r.reject(n):(t=r.defer(),window.FB.api("/me/permissions",function(e){t.resolve(e)}),t.promise.then(function(e){e=e&&e.data,t=[],angular.forEach(e,function(e){"granted"===e.status&&t.push(e.permission)});var t,e=c(t);return e.length&&(n.missingPerms=e),r.reject(n)}));var t})}function s(e){var t,n;return rind.context.ua.mobile?(o.Session.set("next",window.location.href,{expires:"+5 minutes"}),t="https://www.facebook.com/dialog/oauth?client_id="+rind.config.facebook.app_id+"&redirect_uri="+i.location.origin+"/settings/register/facebook&scope=email",e&&(t+="&auth_type=rerequest"),window.location=encodeURI(t),r.resolve()):(t={scope:"email",return_scopes:!0},e&&(t.auth_type="rerequest"),n=r.defer(),window.FB.login(function(e){n.resolve(e)},t),n.promise.then(function(e){if(e&&"connected"!==e.status)return r.reject({connectionError:!0});if(!e||!e.authResponse)return r.reject("No data from FB.");var t=[];try{t=e.authResponse.grantedScopes.split(",")}catch(e){}t=c(t);return t.length?r.reject({missingPerms:t,status:400}):a(e)}))}function c(e){return e.indexOf("email")<0?["email"]:[]}}]},{}],109:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/data/file",null,{get:{url:"/api/data/file/:id"},findByKey:{url:"/api/data/file?criteria="+JSON.stringify({key:":key"})},findByBucketAndKey:{url:"/api/data/file?criteria="+JSON.stringify({bucket:":bucket",key:":key"})},findById:{url:"/api/data/file?"+JSON.stringify({_id:":_id"})+"&limit=1",method:"GET",isArray:!1,transformResponse:function(e,t){return{data:e.data&&e.data[0]}},responseType:"json"},findByCriteria:{url:"/api/data/file?criteria=:criteria",responseType:"json"}})}]},{}],110:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/data/galleryimage",null,{get:{url:"/api/galleries/image",cache:!0},getComments:{url:"/api/galleries/comment",cache:!0},getList:{url:"/api/galleries/:type/:slug",cache:!0},search:{url:"/api/galleries/image/search/:query"},updateImage:{url:"/api/galleries/image/update",method:"POST"},removeImage:{url:"/api/galleries/image/delete",method:"DELETE"},comment:{url:"/api/galleries/comment/image",method:"POST"},removeComment:{url:"/api/galleries/comment/image",method:"DELETE"},like:{url:"/api/galleries/image/like",method:"POST"},unlike:{url:"/api/galleries/image/unlike",method:"POST"},publish:{url:"/api/galleries/image/publish",method:"POST"},unpublish:{url:"/api/galleries/image/unpublish",method:"POST"},accept:{url:"/api/galleries/image/accept",method:"POST"},reject:{url:"/api/galleries/image/reject",method:"POST"},moderateComment:{url:"/api/galleries/comment/moderate",method:"POST"},setFlag:{url:"/api/galleries/image/flag",method:"POST"},flagImage:{url:"/api/galleries/image/flag",method:"POST"},flagComment:{url:"/api/galleries/comment/flag",method:"POST"},findById:{url:"/api/data/galleryimage/:id"},findByOwner:{url:"/api/data/galleryimage?criteria="+angular.toJson({owner:":_id"})},getImagesByTypeSlug:{url:"/api/galleries/:type/:slug"}})}]},{}],111:[function(e,t,n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=e("@creativelive/vault.js"),u=e("deepval"),l=e("moment"),d=e("underscore");t.exports=["$filter",function(e){var n=e("i18n")("cl-gift-recipient-message-text","Hey, I thought you'd love this class.");return{get:r,setObject:t,setProperty:function(e,t){var n=r();u.set(n,e,t),c.Local.set("gift_data",n,{path:"/"})},createGiftObject:i,clear:o,saveToLocalStorage:function(e){t(i(null,e))},isGiftValid:a};function r(e){var t=c.Local.get("gift_data");return t&&a(t)?e?u.get(t,e):t:null}function t(e){e&&a(e)?c.Local.set("gift_data",e,{path:"/"}):o()}function i(e,t){return{product_id:(t=t||{}).product_id||e||null,recipient:{name:u(t,"recipient.name")||null,email:u(t,"recipient.email")||null},sender:{name:u(t,"sender.name")||null,email:u(t,"sender.email")||null},delivery_date:t.delivery_date||l().unix(),message:t.message||n,state:t.state||"init"}}function o(){c.Local.remove("gift_data")}function a(n){var r=["delivery_date"],e=Object.keys(function e(t){var n=["string","number","function"];var r={};for(var i in t)if(null===t[i]||0<=n.indexOf(s(t[i]))||Array.isArray(t[i])||t[i]instanceof Date)r[i]=t[i];else if("object"===s(t[i])){var o,a=e(t[i]);for(o in a)r[i+"."+o]=a[o]}return r}(n));return!d.some(e,function(e){var t=u(n,e);return 0<=r.indexOf(e)?!(!t||"number"==typeof t):!(!t||"string"==typeof t)})}}]},{"@creativelive/vault.js":6,deepval:38,moment:void 0,underscore:void 0}],112:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/global-module",{id:"@id"},{get:{url:"/api/global-module/:id"},getBySlug:{url:"/api/global-module/slug/:slug"},save:{method:"POST",url:"/api/global-module/:id?"},deleteModule:{method:"DELETE",url:"/api/global-module/:id"}})}]},{}],113:[function(e,t,n){"use strict";var c=e("cache-stack");t.exports=["$q","GlobalModuleResource","_",function(i,o,r){var a={},s={};return{Resource:o,cacheById:a,cacheBySlug:s,get:function(e,t){var n=i.defer();return o.get({limit:e,offset:t}).$promise.then(function(e){e=e&&e.data;e&&(a=r.indexBy(e,"_id"),s=r.indexBy(e,"slug")),n.resolve(e)},n.reject),n.promise},getById:function(e,n){var t=a[e];if(t)return i.resolve(t);var r=i.defer();return c(function(t){o.get({id:e,mcp:n},function(e){t(e&&e.data&&e.data[0])},function(e){r.reject()})},{key:"GlobalModuleService.getById:"+e,expires:"5 seconds"},r.resolve),r.promise},getBySlug:function(n,e){var t=s[n];if(t)return i.resolve(t);var r=i.defer();return c(function(t){o.getBySlug({slug:n,mcp:e},function(e){e=e&&e.data&&e.data[0];s[n]=e,t(e)},function(e){r.reject()})},{key:"GlobalModuleService.getBySlug:"+n,expires:"5 seconds"},r.resolve),r.promise}}}]},{"cache-stack":32}],114:[function(e,t,n){"use strict";t.exports=["$resource","rind",function(e,t){var n=Math.round((new Date).getTime()/1e3).toString();return e("https://maps.googleapis.com/",null,{timezoneApi:{url:"https://maps.googleapis.com/maps/api/timezone/json?location=:lat,:long&timestamp="+n+"&key="+t.config.google.app_api_key}})}]},{}],115:[function(e,t,n){"use strict";t.exports=["$q","googleResource",function(r,i){return{getTimeZoneFromLocation:function(e,t){var n=r.defer();return i.timezoneApi({lat:e,long:t}).$promise.then(function(e){e?n.resolve(e):n.reject(e)}),n.promise}}}]},{}],116:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/i18n",{},{getStrings:{url:t.cachingDomain+"/api/i18n"},addString:{method:"POST",url:"/api/i18n/strings"},saveString:{method:"PUT",url:"/api/i18n/strings"}})}]},{}],117:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){var t=t.cachingDomain,n="/api/instructor/";return e(n,null,{getBFF:{url:t+"/bff/instructors/",isArray:!0,cache:!0},findBySlug:{url:t+n+"slug/:slug",cache:!0},findById:{url:t+n+"id/:id",cache:!0}})}]},{}],118:[function(e,t,n){"use strict";t.exports=["$q","cacheStack","deepval","_","InstructorResource",function(i,t,o,a,s){var c={},u={};return{getInstructors:function(e){if(e&&e.bff)return r();e=i.defer();return t(function(t){s.get({},function(e){e=e&&e.data;l(e),t(e)},function(e){})},{key:"InstructorService.getInstructors"},e.resolve),e.promise},findByIds:function(t){if(!t.ids||!t.ids.length)return i.reject("no id");var n=i.defer();return r().then(function(){var e=a.map(t.ids,function(e){return c[e]});n.resolve(e)}),n.promise},findById:function(e){if(!e.id)return i.reject("no id");if(!e.bff)return n("findById",{id:e.id});var t=i.defer();return r().then(function(){c[e.id]?t.resolve(c[e.id]):t.reject("instructor not found")},t.reject),t.promise},findBySlug:function(e){if(!e.slug)return i.reject("no slug");if(!e.bff)return n("findBySlug",{slug:e.slug});var t=i.defer();return r().then(function(){u[e.slug]?t.resolve(u[e.slug]):t.reject("instructor not found")},t.reject),t.promise},search:function(e,t){var n=new RegExp(e,"gi");return a.filter(t||a.values(c),function(e){return n.test(e.index)})}};function l(e,r){angular.forEach(e,function(t){var n;t&&(r?(c[t._id]||(c[t._id]=t),u[t.slug]||(u[t.slug]=t)):(n=[],a.each(["profile.name","profile.first_name","profile.last_name","profile.bio.short"],function(e){e=o(t,e);e&&n.push(e)}),t.index=n.join(" "),c[t._id]=t,u[t.slug]=t))})}function n(e,n){if(n.id&&c[n.id]&&c[n.id].index)return i.resolve(c[n.id]);if(n.slug&&u[n.slug]&&u[n.slug].index)return i.resolve(u[n.slug]);var r=i.defer();return t(function(t){s[e](n,function(e){e=e&&e.data;e?(l([e]),t(e)):r.reject(e)})},{key:"InstructorService.findBy:"+e+JSON.stringify(n||{})},r.resolve),r.promise}function r(){var e=i.defer();return t(function(t){s.getBFF({},function(e){l(e,!0),t(e)},function(e){})},{key:"InstructorService.get"},e.resolve),e.promise}}]},{}],119:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/integrations";return e(t,null,{findUniversity:{method:"GET",url:t+"/sheerid/universities",isArray:!1}})}]},{}],120:[function(e,t,n){"use strict";t.exports=["IntegrationsResource","responseUtils",function(t,n){return{findUniversity:function(e){return n.wrapResponse(t.findUniversity({name:e}).$promise)}}}]},{}],121:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/api/segment",{},{getLesson:{url:t.cachingDomain+"/api/segment/:id",cache:!0},getTranscript:{url:t.cachingDomain+"/api/segment/:id/transcript",cache:!0},getCaptions:{url:t.cachingDomain+"/api/segment/:id/captions",cache:!0}})}]},{}],122:[function(e,t,n){"use strict";t.exports=["$http","$q",function(e,n){return{get:function(){var t=n.defer();return e.get("/admin/config").then(function(e){200===e.status?t.resolve(e.data):t.reject(e)}),t.promise}}}]},{}],123:[function(e,t,n){"use strict";t.exports=["$resource","$window",function(e,t){return e("/api/media/play",null,{get:{url:"/api/data/media/:id"},getMedia:{url:"/api/media/id/:id"},save:{method:"POST",url:"/api/data/media"},tokenById:{url:"/api/media/play/id/:id"},token:{url:"/api/media/play",headers:{"x-media-token":function(e){var t=e.params&&e.params.token;return t&&delete e.params.token,t}}},tokenDownload:{url:"/api/media/download",headers:{"x-media-token":function(e){var t=e.params&&e.params.token;return t&&delete e.params.token,t}}},getToken:{method:"POST",url:"/api/media/token"},getCourseTokensBySlug:{url:"/bff/course/slug/:slug/tokens",headers:{Authorization:!0,"x-referrer":function(){return t.document.referrer}}}})}]},{}],124:[function(e,t,n){"use strict";t.exports=["_","$q","$rootScope","$location","mediaResource","cacheStack","ContentAccessService","rind",function(u,i,l,o,d,a,f,p){return{Resource:d,token:function(e,t){if(!e)return i.reject("token no token");var n=i.defer();t?a(function(t){d.tokenDownload({token:e}).$promise.then(function(e){t(e&&e.data&&e.data.playUrl)}).catch(n.reject)},{key:"MediaService.tokenDownload:"+e},n.resolve):a(function(t){d.token({token:e}).$promise.then(function(e){t(e&&e.data&&e.data.playUrl)}).catch(n.reject)},{key:"MediaService.token:"+e,expires:"+1 hour"},n.resolve);return n.promise},mediaById:function(e){{if(!e)return i.reject("mediaById no id",e);if(!angular.isString(e))return i.reject("id is not a string",e)}var n=i.defer();return a(function(t){d.getMedia({id:e}).$promise.then(function(e){e=e&&e.data;e?t(e):n.reject("bad data")}).catch(n.reject)},{key:"MediaService.mediaById:"+e},n.resolve),n.promise},tokenById:function(e){if(!e)return i.reject("tokenById no id",e);if(!angular.isString(e))return i.reject("id is not a string",e);var n=i.defer(),t={key:"MediaService.tokenById:"+e},r=p.config&&p.config.cacheStack;r&&r.mediaTokenById&&(t.expires=r.mediaTokenById);return a(function(t){d.tokenById({id:e}).$promise.then(function(e){e=e&&e.data&&e.data.playUrl;e?t(e):n.reject("bad data")}).catch(n.reject)},t,n.resolve),n.promise},getCourseTokensBySlug:function(n,e){if(!n||!angular.isString(n))return i.reject("getCourseTokensBySlug no courseSlug",n);var s=void 0,c=void 0;try{c=p.dump.course._id,s=(s=o.path().split("/lessons/")[1]||"").split("/")[0]}catch(e){s=""}var t=i.defer(),r=!0;e&&(r=!1);return a(function(i){var o=p.config.cardStorageKey,a=Vault.Local.get(o);f("course",c).then(function(e){var t={slug:n};return s&&(t.lesson=s),a&&(t.card=a),(e.owned||e.subscribed)&&(t.owned=!0),d.getCourseTokensBySlug(t).$promise}).then(function(e){var t,n,r,e=e&&e.data;e?((t=e.card)?(r=p.dump&&p.dump.course,u.each(r.sessions,function(e){n||(e=u.find(e.segments,function(e){return e.slug===s}))&&(n=e._id)}),c&&n&&(l.cardedSegment=n),t.new&&(l.$emit("libcard:create",c,n,t.id),Vault.Local.set(o,t.id))):a&&Vault.Local.remove(o),i(e.tokens||{})):i({})}).catch(t.reject)},{key:"MediaService.getCourseTokensBySlug:"+n,expires:"+2 seconds",useCache:r},t.resolve),t.promise}}}]},{}],125:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/page/:id",{id:"@id"},{getAll:{url:"/api/page",cache:!0},get:{url:"/api/page/:id/current",cache:!0}})}]},{}],126:[function(e,t,n){"use strict";var i=e("cache-stack");t.exports=["$q","PageResource","responseUtils",function(n,r,e){return{getById:function(e){var t=n.defer();return i(function(t){r.get({id:e},function(e){t(e&&e.data)},function(e){})},{key:"PageService.getById:"+e},t.resolve),t.promise},getAll:function(){return e.wrapResponse(r.getAll().$promise)}}}]},{"cache-stack":32}],127:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/partner",null,{get:{url:"/api/partner",method:"GET",cache:!0},search:{url:"/api/partner",method:"GET"},count:{url:"/api/partner/count",method:"GET",isArray:!1,responseType:"json"},findBySlug:{url:"/api/partner",method:"GET"}})}]},{}],128:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("https://"+t.pipeline.hostname+"/event/:topic?cluster=:cluster",{topic:"@topic",cluster:t.pipeline.cluster},{trackConvert:{method:"POST",url:"https://"+t.pipeline.hostname+"/event/marketing/clc"}})}]},{}],129:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["$rootScope","$q","$window","PipelineResource","config","rind","gangesSessionService",function(e,t,n,r,i,o,a){return{reportWatchProgress:function(e,t){e=function(e,t,n,r){var i=[];return e.forEach(function(e){i.push({type:"Watched Progress",properties:{bucket:e,course:t,segment:n,user:r}})}),i}(e.watched,e.course,e.segment,e.user);r.save({topic:"watchedprogress"},e,t)},reportVideoView:function(e,t){e={type:e.type,properties:s(c.omit(e,"type"))};r.save({topic:"media_view"},e,t)},reportExperimentViewed:function(e,t){e={type:"experiment_viewed",properties:s(e)};r.save({topic:"client"},e,t)},reportPageView:function(){var e={type:"page_viewed",properties:s({})};r.save({topic:"client"},e)},reportOrderError:function(e){e={type:"order_error",properties:s(e)};r.save({topic:"client"},e)},reportSessionErrorDiagnostic:function(e,t){o.config.logSessionDiagnostics?(e={type:"session_error_diagnostics",timestamp:Date.now(),properties:c.extend(e,{jwt:a.getToken(),cookie_cc:a.getPersistentCookie(),cookie_crlv:a.getCrlvCookie()})},r.save({topic:"auth"},e,t)):t&&t()}};function s(t){t.device="browser",t.platform="web",o&&(t.build=o.pkg&&o.pkg.version,t.version=t.build,o.context&&(t.browser=o.context.ua.family,t.os=o.context.ua.os.family));try{t.page=n.location.pathname.slice(1),t.querystring=n.location.search}catch(e){t.page="unknown"}return t.referrer=document.referrer||null,t.session_token=a.getSessionId(),t.logged_in=e.user&&e.user.valid(),t.logged_in&&(t.user_id=e.user.get("_id"),t.uid=e.user.get("uid")),t.cc=a.getPersistentCookie(!1),t}}]},{underscore:void 0}],130:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/playlist",null,{get:{url:"/api/playlist/id/:id"},getData:{url:"/api/data/playlist/:id"}})}]},{}],131:[function(e,t,n){"use strict";var o=e("cache-stack");t.exports=["$q","playlistResource",function(r,i){return{Resource:i,findById:function(e){var n={id:e},t=r.defer();return o(function(t){i.get(n).$promise.then(function(e){e=e&&e.data;t(e)})},{key:"PlaylistService.get:"+JSON.stringify(n)},function(e){t.resolve(e)}),t.promise}}}]},{"cache-stack":32}],132:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/product",{id:"@id"},{findById:{url:"/api/product/id/:id",cache:!0},findBySourceId:{url:"/api/product/source/:id",cache:!0}})}]},{}],133:[function(e,t,n){"use strict";i.$inject=["$q","productResource","ecommerceResource","$rootScope"];var c=e("cache-stack"),r=e("underscore");function i(o,n,a,s){return{Resource:n,findBySourceId:function(e){var t=o.defer();e?c(function(t){n.findBySourceId({id:e}).$promise.then(function(e){e=e&&e.data&&e.data[0];t(e)},t)},{key:"ProductService:findBySourceId:"+e},function(e){t.resolve(e)}):t.reject("no id");return t.promise},findById:function(e){return e?n.findById({id:e}).$promise.then(function(e){return e&&e.data?e.data:null}):o.reject("no id")},getSource:function(e){var t=o.defer();e?c(function(t){n.findById({id:e._id||e}).$promise.then(function(e){e=e&&e.data&&e.data.source;t(e)},t)},{key:"ProductService:getSource:"+(e._id||e)},function(e){t.resolve(e)}):t.reject("no product");return t.promise},getPrice:function(t){var n=o.defer(),e="ProductService.getPrice:"+t,r="price",i=s.user&&s.user.get("_id");i&&(r="userPrice",e+=":"+i);return c(function(e){a[r]({productId:t,userId:i}).$promise.then(e,e)},{key:e,expires:"+5 minutes"},function(e){n.resolve(e&&e.data)}),n.promise},isSourcePurchasable:function(e){if(e&&e.flags&&1<=r.intersection(e.flags,["!published","!for_sale"]).length)return!1;e=e&&e.flagged||{};return!1!==e.published&&!1!==e.for_sale}}}t.exports=i},{"cache-stack":32,underscore:void 0}],134:[function(e,t,n){"use strict";function r(i,o,a){return{get:s,save:function(e){e=e||500;var t,n=a.dump&&a.dump.bundle,r=a.dump&&a.dump.course,r=i(n||r||{},"product._id");r&&(t="course",n={type:t=n?"learning_path"===n.type?"learning_path":"bundle":t,productId:r,timeStamp:Math.round(new Date/1e3)},(t=s()).push(n),t=o.last(t,e),Vault.Local.set("productViewHistory",t))}};function s(t,e){var n=Vault.Local.get("productViewHistory")||[];if(!e)return n;var r={},i=[];return n.reverse().forEach(function(e){if(!r[e.productId]){if(t&&e.type===t)return r[e.productId]=!0,void i.push(e);r[e.productId]=!0,i.push(e)}}),i}}r.$inject=["deepval","_","rind"],t.exports=r},{}],135:[function(e,t,n){"use strict";var p=e("async"),h=e("underscore");t.exports=["$rootScope","$q","courseResource","ScoresService","CatalogService",function(i,u,l,o,d){return{getPopularRecommendations:function(e){var t=u.defer(),n={userid:a,courseid:s,category:c,categoryid:c,categories:c,topics:c},r=e.courseid?"courseid":e.topics?"topics":e.categories?"categories":"userid";return(0,n[r])(e).then(function(e){t.resolve(e)}),t.promise},getRecommendationsByUser:a,getRecommendationsByCourse:s,getRecommendations:c};function a(t){var n=u.defer(),e=new o,r=t.topicsCount||5;return e.fetchFilteredTopics(function(e){e=e.slice(0,parseInt(r,10));t.topics=h.chain(e).pluck("_id").value().join(","),c(t).then(function(e){n.resolve(e)})}),n.promise}function s(t){var n=u.defer(),r=t.limit||10;return t.limit=r+1,l.findById({id:t.courseid}).$promise.then(function(e){t.topics=h.chain(e.data.taxonomy).flatten().pluck("topic").without(void 0).value().join(","),delete t.courseid,c(t).then(function(e){e=(e=function(t,e){{var n;if(t)return n=[],h.each(e,function(e){t!==e._id&&n.push(e)}),n}return e}(t.courseid,e)).slice(0,r);n.resolve(e)})},n.reject),n.promise}function c(e){var n,o,a,s,t=u.defer(),r=0,c=e.limit||10;return e.sort=e.sort||"popularity",p.series([function(e){if(!i.user.get("_id"))return e();n=i.user.get("contentRights"),r=n.purchased.courses.length,o=n.starred.courses,e()},function(t){e.topics?d.getCoursesByTopics(e.topics,{limit:e.limit+r,sort:1<e.topics.length?e.sort:null}).then(function(e){a=f(n,e),t()}):(e.limit=c+r,l.getAllCourses(e).$promise.then(function(e){a=f(n,e.data),t()}))},function(e){var t,n,r,i;t=o,i=a,n=[],r=[],h.each(i,function(e){(t&&-1<t.indexOf(e._id)?n:r).push(e)}),s=n.concat(r),i=s,(s=h.filter(i,function(e){return e.flagged.show_on_catalog})).length>c&&(s=h.first(s,c)),e()}],function(e){if(e)return t.reject(e);t.resolve(s)}),t.promise}function f(t,e){return t&&t.purchased.courses.length?h.filter(e,function(e){return t.purchased.courses.indexOf(e._id)<0}):e}}]},{async:21,underscore:void 0}],136:[function(e,t,n){"use strict";var r=e("deepval");t.exports=["$resource",function(e){var t="https://"+(r(window.extole||{},"PROGRAM.programDomain")||"refer.creativelive.com")+"/api/v4";return e(t,null,{getToken:{url:t+"/token"},getRewards:{url:t+"/me/rewards?access_token=:token",isArray:!0},deleteToken:{method:"DELETE",url:t+"/token/:token"}})}]},{deepval:38}],137:[function(e,t,n){"use strict";t.exports=["$rootScope","$q","referralResource",function(t,r,i){return{init:function(){t.$on("user:login",e),t.$on("user:register",n),-1!==window.location.search.indexOf("utm_source=extole")&&o()},logout:function(e){var t=r.defer(),n=Vault.Cookie.getAndRemove("extole_access_token");return i.deleteToken({token:n}).$promise.finally(function(){t.resolve()}),t.promise}};function e(e){o()}function n(e){o()}function o(){var e,n;e=Vault.Cookie.get("extole_access_token"),n=r.defer(),e?i.getRewards({token:e}).$promise.then(function(e){var t;e?(t=_.pluck(e,"code"),n.resolve(t)):n.reject(e)}):n.resolve(),n.promise.then(function(e){t.user.addApplicableCoupon(e)})}}]},{}],138:[function(e,t,n){"use strict";t.exports={login:{states:{success:"login_success",facebook:{emailMissing:"fb_email_missing",connect:"fb_connect",create:"fb_create",login:"fb_login"},google:{emailMissing:"google_email_missing",connect:"google_connect",create:"google_create",login:"google_login"}},messages:{facebook:{emailMissing:'We require an email to be shared from Facebook. <a href="https://www.facebook.com/settings?tab=applications&section=all" target="_blank">Change permissions for CreativeLive here.</a>',error:"An error occurred while logging in with Facebook."},google:{emailMissing:'We require an email to be shared from Google. <a href="https://security.google.com/settings/security/permissions" target="_blank">Change permissions for CreativeLive here.</a>',error:"An error occurred while logging in with Google."}},errors:{}},register:{states:{},messages:{fail:"We couldn't register a new account with those details",error:"An error occured"},errors:{}},auth:{states:{},errors:{corruptToken:"x-session-api-key not found",missingToken:"x-session-api-key missing"},messages:{}}}},{}],139:[function(e,t,n){"use strict";t.exports=["$resource","$rootScope",function(e,t){return e("/api/review",null,{get:{url:"/api/reviews",method:"GET",cache:!0},search:{url:"/api/reviews",method:"GET",cache:!0},update:{url:"/api/review",method:"POST"},flag:{url:"/api/review/flag",method:"POST"},unflag:{url:"/api/review/unflag",method:"POST"},searchCount:{url:"/api/reviews/count?criteria="+JSON.stringify({comment:{$regex:":query",$options:"i"}})+"&fields="+JSON.stringify({_id:1})+"&limit=9999",interceptor:{response:function(e){return e.data}},method:"GET"},count:{url:"/api/reviews/count",method:"GET",isArray:!1,responseType:"json"}})}]},{}],140:[function(e,t,n){"use strict";t.exports=["$q","reviewResource","cacheStack","$rootScope",function(t,i,o,a){return{Resource:i,findByCourseId:function(e){if(!e)return t.reject("no courseId");var n=t.defer();return o(function(t){i.get({courseId:e}).$promise.then(function(e){t(e&&e.data)}).catch(n.reject)},{key:"ReviewService.findByCourseId:"+e},n.resolve),n.promise},findByUserId:function(e){if(!e)return t.reject("no userId");var n=t.defer();return o(function(t){i.get({userId:e}).$promise.then(function(e){t(e&&e.data)}).catch(n.reject)},{key:"ReviewService.findByUserId:"+e},n.resolve),n.promise},userReviewForCourse:function(e){var n=t.defer(),r={course:e.courseId,user:e.userId||a.user._data._id};return o(function(t){i.search({criteria:JSON.stringify(r)},function(e){t(e&&e.data)},n.reject)},{key:"reviewService.userReviewForCourse:"+r.course+r.user,expires:"+5 minutes"},n.resolve),n.promise}}}]},{}],141:[function(e,t,n){"use strict";t.exports=["$http",function(t){this.initiateServiceProviderLogin=function(e){return t.post("/api/sso/login",{entityId:e}).then(function(e){if(!e.data)throw new Error("No response");return e.data})}}]},{}],142:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/saved-search";return e(t,{},{get:{params:{select:"_id name created modified"}},getBff:{method:"GET",url:"/bff/saved-search",isArray:!0},getContentById:{method:"GET",url:t+"/content/:id",params:{id:"@id"}},getById:{method:"GET",url:t+"/:id",params:{id:"@id"}},count:{method:"GET",url:t+"/count"},create:{method:"POST",url:t},remove:{method:"DELETE",url:t+"/:id",params:{id:"@id"}},update:{method:"PUT",url:t+"/:id",params:{id:"@id"}}})}]},{}],143:[function(e,t,n){"use strict";r.$inject=["responseUtils","SavedSearchResource","_","$q"];var s=e("cache-stack");function r(r,i,n,o){var a=this;return angular.extend(a,{savedSearchIndex:{}}),{getContentById:function(e,t){e={id:e};t&&n.extend(e,{select:t});return r.wrapResponse(i.getContentById(e).$promise)},getById:function(t,e){if(!e)return r.wrapResponse(i.getById({id:t}).$promise);var n=o.defer();return function(){var t=o.defer();return s(function(t){i.getBff().$promise.then(function(e){angular.forEach(e||[],function(e){a.savedSearchIndex[e._id]=e}),t(!0)},t)},{key:"SavedSearchService.Fetch",expires:"+5 minutes"},function(e){e?t.resolve(e):t.reject()}),t.promise}().then(function(){var e=a.savedSearchIndex[t];e?n.resolve(e):n.reject()},n.reject),n.promise},get:function(e){return e=e||null,r.wrapResponse(i.get(e).$promise)},bff:function(){return r.wrapResponse(i.getBff().$promise)},create:function(e){return r.wrapResponse(i.create(e).$promise)},remove:function(e){return r.wrapResponse(i.remove({id:e}).$promise)},update:function(e,t){return r.wrapResponse(i.update({id:e,savedSearch:t}).$promise)}}}t.exports=r},{"cache-stack":32}],144:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/schedule",null,{findByContentId:{url:"/api/schedule/content/:id"}})}]},{}],145:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/scheduled-email";return e(t,{},{getAllScheduledEmails:{method:"GET",url:t},getScheduledEmailById:{method:"GET",url:t+"/id/:id"},getScheduledEmailsBySubscription:{method:"GET",url:t+"/subscription/:subscription"},getScheduledEmailBySeat:{method:"GET",url:t+"/seat/:seat",cache:!0},getScheduledEmailsByRange:{method:"GET",url:t+"/range",query:{start:"@start",end:"@end"}},createScheduledEmail:{method:"POST",url:t},updateScheduledEmail:{method:"PUT",url:t+"/:id",params:{id:"@scheduledEmailId"}},deleteSubscription:{method:"DELETE",url:t+"/:id",params:{id:"@scheduledEmailId"}},countScheduledEmails:{method:"GET",url:t+"/count"}})}]},{}],146:[function(e,t,n){"use strict";t.exports=["$q","$rootScope","parseQS","getUserId","responseUtils","ScheduledEmailResource",function(e,t,n,r,i,o){return{getAllScheduledEmails:function(){return i.wrapResponse(o.getAllScheduledEmails().$promise)},getScheduledEmailById:function(e){return i.wrapResponse(o.getScheduledEmailById({id:e}).$promise)},getScheduledEmailsBySubscription:function(e){return i.wrapResponse(o.getScheduledEmailsBySubscription({subscription:e}).$promise)},getScheduledEmailBySeat:function(e){return i.wrapResponse(o.getScheduledEmailBySeat({seat:e}).$promise)},getScheduledEmailsByRange:function(e,t){return i.wrapResponse(o.getScheduledEmailsByRange({start:e,end:t}).$promise)},createScheduledEmail:function(e){return i.wrapResponse(o.createScheduledEmail(e).$promise)},updateScheduledEmail:function(e,t){return i.wrapResponse(o.updateScheduledEmail({scheduledEmailId:e,update:t}).$promise)},deleteScheduledEmail:function(e){return i.wrapResponse(o.deleteScheduledEmail({id:e}).$promise)}}}]},{}],147:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/user",null,{update:{url:"/api/user/:id/scores",method:"POST"},patch:{url:"/api/user/:id/scores",method:"PATCH"},engagement:{url:"/api/user/:id/engagement-score",method:"POST"}})}]},{}],148:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","$q","categoryResource","TopicService","InstructorService","ScoresResource","_","moment","Vault",function(h,m,g,v,y,b,_,w,S,E){return function(e){var o=this,r=h.user&&h.user._data&&h.user._data.user;function t(){return r&&r.scores?p(r.scores):p({categories:[],topics:[],instructors:[]})}function i(e,t){var n=c(),r=[],i=[];return t&&e.unshift(t),angular.forEach(e,function(e){e.score=n[e._id],(e.score?r:i).push(e)}),r.sort(function(e,t){return t.score-e.score}),r=r.concat(i)}function n(e){var t=u();return w.each(e,function(e){e.score=t[e._id]}),w.sortBy(e,"score").reverse()}function a(e){var t=[],n=u();return w.each(e,function(e){n[e._id]&&(e.score=n[e._id],t.push(e))}),w.sortBy(t,"score").reverse()}function s(e){var t=[],n=d();return w.each(e,function(e){n[e._id]&&(e.score=n[e._id],t.push(e))}),w.sortBy(t,"score").reverse()}function c(){var e=t(),n={};return w.each(e.categories,function(e){var t;e.source&&(t=e.source._id||e.source,n[t]=e.score)}),n}function u(){var e=t(),n={};return w.each(e.topics,function(e){var t;e.source&&(t=e.source._id||e.source,n[t]=e.score)}),n}function d(){var e=t(),n={};return w.each(e.instructors,function(e){var t;e.source&&(t=e.source._id||e.source,n[t]=e.score)}),n}function f(){r&&r._id&&_.update({id:r._id},null)}function l(){return E.Local.get("engagement")||{last_saved:S().unix(),categories:{},topics:{},instructors:{}}}function p(e){if(!o.useEngagementScores)return e;var n={categories:[],topics:[],instructors:[],version:e.version,timestamp:e.timestamp},r=l(),i={};return w.each(e.categories,function(e){var t=e.source._id||e.source;r.categories&&(e.score+=r.categories[t]||0),i[t]=!0,n.categories.push(e)}),w.each(e.topics,function(e){var t=e.source._id||e.source;r.topics&&(e.score+=r.topics[t]||0),i[t]=!0,n.topics.push(e)}),w.each(e.instructors,function(e){var t=e.source._id||e.source;r.instructors&&(e.score+=r.instructors[t]||0),i[t]=!0,n.instructors.push(e)}),w.each(r.categories,function(e,t){i[t]||n.categories.push({source:t,score:e})}),w.each(r.topics,function(e,t){i[t]||n.topics.push({source:t,score:e})}),w.each(r.instructors,function(e,t){i[t]||n.instructors.push({source:t,score:e})}),n}E.Local.remove("pageViews"),angular.extend(o,{useEngagementScores:!0,setUser:function(e){r=angular.copy(e)},getScores:t,getSortedCategories:i,fetchSortedCategories:function(e,n){v.getPrimary({},function(t){n?v.getCategoryBySlug({slug:e}).$promise.then(function(e){n(i(t.data,e.data))}):(n=e)(i(t.data))})},getSortedTopics:n,getFilteredTopics:a,getFilteredInstructors:s,fetchSortedTopics:function(t){y.get({}).then(function(e){t(n(e))})},fetchFilteredTopics:function(t){y.get({}).then(function(e){t(a(e))})},fetchFilteredInstructors:function(t){b.getInstructors().then(function(e){t(s(e))})},getCategoriesByScore:c,getScoreByCategory:function(e){var t=c();return t[e]||0},getScoreByTopic:function(e){var t=u();return t[e]||0},getScoreByInstructor:function(e){var t=d();return t[e]||0},updateScores:f,patchScores:function(t){r&&r._id&&_.patch({id:r._id},null,function(e){r.scores=e.data,t()})},engagement:function(e){var t=l(),n=isNaN(e.amount)?1:e.amount;w.each(e.categories,function(e){e&&(t.categories||(t.categories={}),t.categories[e]||(t.categories[e]=0),t.categories[e]+=n)}),w.each(e.topics,function(e){e&&(t.topics||(t.topics={}),t.topics[e]||(t.topics[e]=0),t.topics[e]+=n)}),w.each(e.instructors,function(e){e&&(t.instructors||(t.instructors={}),t.instructors[e]||(t.instructors[e]=0),t.instructors[e]+=n)}),E.Local.set("engagement",t)},watchEngagement:function e(){var t=S.duration(5,"minutes");var n=l();if(n.last_saved&&n.last_saved>S().subtract(t).unix())return n=n.last_saved-S().subtract(t).unix(),void m(e,1e3*n);o.saveEngagement().then(function(){m(e,t.milliseconds()),f()},function(e){})},saveEngagement:function(){var t=g.defer(),e=l(),n={categories:[],topics:[],instructors:[]};if(w.each(e.categories,function(e,t){t&&"undefined"!==t&&n.categories.push({source:t,increment:e})}),w.each(e.topics,function(e,t){t&&"undefined"!==t&&n.topics.push({source:t,increment:e})}),w.each(e.instructors,function(e,t){t&&"undefined"!==t&&n.instructors.push({source:t,increment:e})}),0===n.categories.length&&0===n.topics.length&&0===n.instructors.length)return E.Local.remove("engagement"),g.resolve();r&&r._id?_.engagement({id:r._id},{scores:n},function(e){E.Local.remove("engagement"),t.resolve()}):t.reject("User is not logged in");return t.promise},disableEngagementScores:function(){o.useEngagementScores=!1}},e||{})}}]},{}],149:[function(e,t,n){"use strict";var r=e("underscore"),c=(t.exports=["mediaResource",function(s){return function(e){var i,o=this,a=[],n=[];o.$scope=e,angular.extend(this,{getCourseToken:function(e,t){s.getCourseTokensBySlug({slug:e},function(e){a=e.data||{},t()})},getSegments:function(e){return r.chain(e.sessions).pluck("segments").flatten().flatten().value()},getCurrentSegment:function(){return i},getNextSegment:function(){var e=0,t=n.length;for(;e<t-1;e++)if(i===n[e])return n[e+1]},setMediaPermission:function(e){var t=r.chain(e).pluck("media").flatten().value();return r.each(t,function(e){e&&(e.permission=void 0!==a[e._id])}),n=e},isVideo:function(e){try{return null!==e.media[0].type.match(/(hd|low|mp4|video)/i)}catch(e){return!1}},fileIcon:function(e){e=e&&(e.media[0]||e.media),e=c[e.type];return e?"fa-file-"+e+"-o":"fa-file-o"},play:function(t){var e,n,r;t.media[0]&&!t.media[0].permission&&!t.is_preview||(o.$scope.$broadcast("video:stream:pause"),e=function(e){e.data.playUrl&&(o.$scope.$broadcast("video:queue",{playUrl:e.data.playUrl,segment:t}),i=t,o.$scope.$broadcast("video:send-command","play"))},(r=(r=t)&&(r.media[0]||r.media))&&r._id&&(n=a[r._id],!1!==r.permission&&n&&s.token({token:n},e)))}})}}],{pdf:"pdf",zip:"zip",doc:"word",docx:"word",xls:"excel",numbers:"excel",ppt:"powerpoint",txt:"text",mp3:"sound",gif:"image",jpg:"image",png:"image",svg:"image",html:"code",js:"code",css:"code",HD:"video",Low:"video"})},{underscore:void 0}],150:[function(e,t,n){"use strict";var o=e("node-uuid");t.exports=["rind","Vault",function(r,i){function t(){var e=i.Cookie.get("cc");e&&"undefined"!==e||i.Cookie.set("cc",o.v4(),{path:"/",expires:"+10 years",sameSite:"None"})}return t(),{useApiKey:function(){return!1},getToken:function(){return i.Local.get(r.config.auth.storage)||""},setToken:function(e){if(e)try{var t=JSON.parse(window.atob(e.split(".")[1].replace("-","+").replace("_","/")));window.rind.context.sessionId=t.data.id}catch(e){}return i.Local.set(r.config.auth.storage||"session",e)},removeToken:function(){i.Local.remove(r.config.auth.storage)},getPersistentCookie:function(e){return e&&t(),i.Cookie.get("cc")},getCrlvCookie:function(){return i.Cookie.get("CRLV")},getSessionId:function(){var e=i.Local.get(r.config.auth.storage),t=void 0;try{t=JSON.parse(window.atob(e.split(".")[1].replace("-","+").replace("_","/"))).data.id}catch(e){}return t=t||(r.context.sessionId||i.Cookie.get(r.config.auth.cookie))},extractSessionOrigins:function(){var e={},t=i.Local.get(r.config.auth.storage);if(!t)return e;try{var n=JSON.parse(window.atob(t.split(".")[1].replace("-","+").replace("_","/"))).data;n.utmC&&"undefined"!==n.utmC&&(e.session_utm_campaign=n.utmC),n.utmM&&"undefined"!==n.utmM&&(e.session_utm_medium=n.utmM),n.utmS&&"undefined"!==n.utmS&&(e.session_utm_source=n.utmS),n.utmContent&&"undefined"!==n.utmContent&&(e.session_utm_content=n.utmContent),n.lp&&"undefined"!==n.lp&&(e.session_landing_page=n.lp),n.ref&&"undefined"!==n.ref&&(e.session_referrer=n.ref),n.oc&&"undefined"!==n.oc&&(e.session_origin_channel=n.oc)}catch(e){}return e}}}]},{"node-uuid":50}],151:[function(e,t,n){"use strict";var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(){var v=500,y=null,t=null,n=null,b=1,r=new RegExp("(^/api/auth$)|(^/api/auth/valid$)"),_=new RegExp("^/api|starfleet|bff/register/"),w=!1;this.requestDelay=function(e){v=e},this.authConfig=function(e){y=e},this.hostConfig=function(e){t=e},this.maxRetries=function(e){b=e},this.pipelineConfig=function(e){n="https://"+e.hostname+"/event/auth?cluster="+e.cluster},this.enableDiagnosticLogs=function(e){w=e},this.$get=["$rootScope","$injector","$q","$timeout","$log",function(h,s,i,c,u){if(!y||"object"!==(void 0===y?"undefined":S(y)))throw new Error("httpAuthIntercept expects an authConfig object containing  appKey {String} and sessionService {String} (parsed and injected) properties");if(!t||"object"!==(void 0===t?"undefined":S(t)))throw new Error("httpAuthIntercept expects a hostConfig with an api {String} property");var o={},l=s.get(y.sessionService);function d(e,t){if(w&&n&&!l.useApiKey())return t.cookie_cc=l.getPersistentCookie(),t.cookie_crlv=l.getCrlvCookie(),t.source="httpAuthIntercept",e={type:e,timestamp:Date.now(),properties:t},s.get("$http").post(n,e)}function a(r){var e=0;function n(e){var t,n=l.getToken();return l.useApiKey()?(t=e.data.data&&e.data.data.session_api_key,r.config.headers["x-session-api-key"]=t,delete r.config.headers.Authorization,angular.isFunction(l.setToken)&&l.setToken(t)):(n&&r.tokenUsedOnRequest!==n?d("session_error_diagnostics",{stage:"refresh session token - use stored",jwt:t=n,url:r.config.url,from_error:r.fromError||!1}):(t=e&&e.data&&e.data.token,angular.isFunction(l.setToken)&&l.setToken(t),d("session_error_diagnostics",{stage:"refresh session token - store new",jwt:t,url:r.config.url,from_error:r.fromError||!1})),r.config.headers.Authorization="Bearer "+t),r.deferred.resolve(r.config)}function i(e){return d("session_error_diagnostics",{stage:"refresh session token failed",url:r.config.url,from_error:r.fromError||!1,error:e&&e.status+" "+e.statusText}),r.deferred.reject(e)}var t=l.getToken();return t?(l.useApiKey()?(r.config.headers["x-session-api-key"]=t,delete r.config.headers.Authorization):r.config.headers.Authorization="Bearer "+t,r.deferred.resolve(r.config)):e<3?(c(function(){var e,t=s.get("$http"),t=l.useApiKey()?t.bind(null,{url:"/api/auth",method:"POST",headers:{"x-application-api-key":y.appKey}}):(e=void 0,angular.isFunction(l.getPersistentCookie)&&(e=l.getPersistentCookie()),t.get.bind(null,"/session/"+e));t().then(n,i),h.$applyAsync()},500,!1),e++):l.removeToken(),r.deferred.promise}function f(e){e&&p(e)&&o[e]&&delete o[e]}function p(e){return!!e.match(_)}function m(e,t,n){return 401===n.status&&(u.warn("session invalid"),(n=l.getToken())&&n===e&&angular.isFunction(l.removeToken)?(l.removeToken(),d("session_error_diagnostics",{stage:"invalid token check - removed",jwt:n,url:t})):d("session_error_diagnostics",{stage:"invalid token check - did not remove",jwt:n,old_jwt:e,url:t}),!0)}function g(e){return l.useApiKey()?e&&e["x-session-api-key"]:e&&e.Authorization&&e.Authorization.split("Bearer ")[1]}return{request:function(e){return!e||p(e.url)&&!e.url.match(r)||!0===e.headers.Authorization?a({deferred:i.defer(),config:e}):e},response:function(e){return f(e&&e.config&&e.config.url),e},responseError:function(e){var t,n,r;return e&&e.config&&p(e.config.url)&&(!(r=e.config.method)||"OPTIONS"!==r.toUpperCase())?(t=g(e.config.headers),r=e.config.url,(m(t,r,e)||-1!==[503].indexOf(e.status))&&!o[e.config.url]?(n=i.defer("responseErrorHttpBuffer"),a({tokenUsedOnRequest:t,config:e.config,deferred:i.defer(),fromError:!0,requestDelay:v}).then(function(){!function t(n){var e,r=n.config,i=n.deferred;function o(e){return d("session_error_diagnostics",e?{stage:"retry success",jwt:n.tokenUsedOnRequest,url:n.config.url,status_code:e.status}:{stage:"retry success - null response",jwt:n.tokenUsedOnRequest,url:n.config.url}),f(n.config.url),i.resolve(e)}function a(e){return m(n.tokenUsedOnRequest,n.config.url,e)?(f(n.config.url),i.reject(e)):t(n)}return l.useApiKey()||(e=g(r.headers),d("session_error_diagnostics",{stage:"retry http request",jwt:n.tokenUsedOnRequest,new_jwt:e,url:n.config.url}),n.tokenUsedOnRequest=e),n.retries<=b?(c(function(){u.warn("Retrying: count",n.retries),s.get("$http")(r).then(o,a)},n.requestDelay),n.retries++,n.requestDelay<2e3&&(n.requestDelay+=Math.floor(n.requestDelay/2)),i.promise):(f(n.config.url),i.reject())}({tokenUsedOnRequest:t,config:e.config,deferred:n,retries:0})}),o[r]=n,o[r].promise):i.reject(e)):i.reject(e)}}}]}},{}],152:[function(e,t,n){"use strict";t.exports=["$window",function(t){var n=new RegExp("^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$");return{useApiKey:function(){return!0},getToken:function(){var e=t.localStorage.getItem("token");return e&&e.match(n)?e:null},setToken:function(e){return!(!e||!e.match(n))&&(t.localStorage.setItem("token",e),!0)},removeToken:function(){this.clearToken()},clearToken:function(){return t.localStorage.removeItem("token"),t.localStorage.removeItem("mcpUser"),!0}}}]},{}],153:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/stats",{},{getSocial:{method:"GET",url:"/api/stats/social",cache:!0}})}]},{}],154:[function(e,t,n){"use strict";t.exports=["$q","StatsResource",function(e,t){return{getSocial:function(){return t.getSocial().$promise}}}]},{}],155:[function(e,t,n){"use strict";t.exports=["$q","$rootScope","DataSet","cacheStack","UserResource","galleryResource",function(t,n,r,i,o,a){return{findById:function(e){if(!e)return t.reject("no id");if("me"===e){if(!n.user.valid())return t.reject("user is not logged in");e=n.user._data._id}return s("findById",{id:e})},findBySlug:function(e){""===e&&n.user.valid()&&(e=n.user.get("slug"));return e?s("findBySlug",{slug:e}):t.reject("no slug")},isMe:c,getFollows:function(e){var t={instructors:[],categories:new r,topics:new r,byCategoryId:{},byTopicId:{}};return o.getFollows({userId:e}).$promise.then(function(e){return e.success?e.data?(t.event=e.data.event,t.instructor=e.data.instructor,t.bundle=e.data.bundle,t.course=e.data.course,angular.forEach(e.data.topic,function(e){t.categories.addToSet(e.primary_category),t.topics.addToSet(e,"_id"),t.byCategoryId[e.primary_category]||(t.byCategoryId[e.primary_category]=new r),t.byCategoryId[e.primary_category].addToSet(e,"_id"),t.byTopicId[e._id]=e}),t):new Error("getFollows error: no data"):new Error("getFollows error: "+e.message)})},getGallery:function(e,t){e=angular.extend({type:"user",slug:e},t);return a.getImagesByTypeSlug(e).$promise.then(function(e){return e&&e.success?e&&e.data:new Error("galleryResource error",e)})},getStats:function(e,t){return o.stats(angular.extend({userId:e},t)).$promise.then(function(e){return e&&e.data})}};function s(e,n){var r=t.defer();return i(function(t){o[e](n,function(e){e=e&&e.data;e?(e.me=c(e),t(e)):r.reject(e)})},{key:"StudentService.findBy:"+e+JSON.stringify(n||{})},r.resolve),r.promise}function c(e){return!!n.user.valid()&&(!!n.user._data&&e.user._id===n.user._data._id)}}]},{}],156:[function(e,t,n){"use strict";t.exports=["$cacheFactory",function(e){return e("Subscription")}]},{}],157:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/subscription",n="/starfleet/enterprise-platform/v1";return e(t,{},{getAllSubscriptions:{method:"GET",url:t,isArray:!1},getSubscriptionById:{method:"GET",url:t+"/id/:id",isArray:!1},searchSubscriptions:{method:"GET",url:t+"/search",isArray:!1},getSubscriptionBySlug:{method:"GET",url:t+"/slug/:slug",isArray:!1},createSubscription:{method:"POST",url:t,isArray:!1},updateSubscription:{method:"PUT",url:t+"/:id",params:{id:"@subscriptionId"},isArray:!1},updateSubscriptionState:{method:"PUT",url:t+"/:id/state",params:{id:"@subscriptionId"},isArray:!1},deleteSubscription:{method:"DELETE",url:t+"/:id",params:{id:"@subscriptionId"},isArray:!1},count:{method:"GET",url:t+"/count",isArray:!1},hasEligibility:{method:"GET",url:t+"/:id/eligibility/user/:userId",params:{id:"@subscriptionId"},isArray:!1},activateSeat:{method:"POST",url:t+"/:subscriptionId/seat/user/:userId/activate",params:{subscriptionId:"@subscriptionId",userId:"@userId"},isArray:!1},getSubscriptionSeat:{method:"GET",url:t+"/:subscriptionId/user/:userId/seat",params:{subscriptionId:"@subscriptionId",userId:"@userId"},isArray:!1},getSubscriptionSeats:{method:"GET",url:t+"/:id/seats",params:{id:"@id"},isArray:!1},getSubscriptionSeatsWithUsage:{method:"GET",url:n+"/subscription/:subscriptionId/seats",params:{subscriptionId:"@subscriptionId"},cache:!0,isArray:!0},getSubscriptionUsageByRange:{method:"GET",url:n+"/report/usage/:subscriptionId/range",params:{subscriptionId:"@subscriptionId"},query:{before:"@before",after:"@after",mode:"@mode"},isArray:!1,interceptor:{response:function(e){return e&&e.data}},transformResponse:function(e,t){return t().location}},getSeatsByUser:{method:"GET",url:t+"/:id/seats/:user",params:{id:"@id",user:"@user"},isArray:!1},createSeat:{method:"POST",url:t+"/:subscriptionId/seats",params:{subscriptionId:"@subscriptionId"}},createTrialSeat:{method:"POST",url:t+"/:subscriptionId/seat/user/:userId/activate-trial",params:{subscriptionId:"@subscriptionId",userId:"@userId"}},updateSeat:{method:"PUT",url:t+"/:subscriptionId/seats/:seatId",params:{subscriptionId:"@subscriptionId",seatId:"@seatId"}},importSeatsFromUsers:{method:"POST",url:t+"/:subscriptionId/seats/import",params:{subscriptionId:"@subscriptionId"}},sendInvitationEmail:{method:"POST",url:t+"/:subscriptionId/send-invitation/:userId",params:{subscriptionId:"@subscriptionId",userId:"@userId"}},hasContentAccess:{method:"GET",url:t+"/access/user/:userId/:contentType/:contentId",params:{userId:"me"},isArray:!1},getSubscriptionContentByUser:{method:"GET",url:t+"/content/user/:userId",params:{userId:"me",getAll:"@getAll"},isArray:!1},getSubscriptionsByUser:{method:"GET",url:t+"/user/:userId",params:{userId:"me"}},sendTrialInvitation:{method:"POST",url:t+"/seat/trial-invite",params:{emails:"@emails",campaignId:"@campaignId"}},getSubscriptionOrderDetailsById:{method:"GET",url:t+"/:id/order",isArray:!1},sendActivateEmail:{method:"POST",url:t+"/send-activate/:userId",params:{userId:"me"}}})}]},{}],158:[function(e,t,n){"use strict";var h=e("underscore");t.exports=["$q","$rootScope","cacheStack","parseQS","getUserId","responseUtils","SavedSearchService","SubscriptionResource","ScheduledEmailService",function(s,c,u,o,a,i,l,d,f){return{hasContentAccess:function(e,n){var r=s.defer();return u(function(t){d.hasContentAccess({contentType:e,contentId:n}).$promise.then(function(e){t(e&&e.data)},r.reject)},{key:"SubscriptionService.hasContentAccess:"+e+n},r.resolve),r.promise},getSubscriptionsByUser:function(e,t){var n=!e||!e.userId||e.userId===(c.user&&c.user.get("_id")),r=e&&e.inactive;{var i,o;{if(!t&&!r&&n&&c.user&&c.user.valid())return i=e&&e.isAdmin,o=e&&e.unverified,t=h.filter(c.user.get("seats"),function(e){var t=e&&e.subscription&&"inactive"!==e.subscription.state,n=!i||e&&"admin"===e.role,e=!e||"unverified"!==e.state||o;return t&&n&&e}),s.resolve(h.pluck(t,"subscription"));if(!(r||!n||c.user&&c.user.valid()&&c.user.get("seats")&&c.user.get("seats").length))return s.resolve([])}}var a=s.defer(),t=!e||!e.nocache;return c.user.valid()?(u(function(t){d.getSubscriptionsByUser(e).$promise.then(function(e){t(e&&e.data)},a.reject)},{key:"SubscriptionService.getSubscriptionsByUser:"+JSON.stringify(e||{}),useCache:t},a.resolve),a.promise):s.reject()},getSubscriptionContentByUser:function(e){var n=s.defer(),t=!0;e&&(t=!1);return u(function(t){d.getSubscriptionContentByUser().$promise.then(function(e){t(e&&e.data)},n.reject)},{key:"SubscriptionService.getSubscriptionContentByUser",useCache:t},n.resolve),n.promise},getAllSubscriptions:function(e){return i.wrapResponse(d.getAllSubscriptions(e).$promise)},getSubscriptionById:function(e,r){var t=s.defer();return u(function(n){d.getSubscriptionById({id:e}).$promise.then(function(e){var t=e&&e.data;if(!r)return n(t);l.getContentById(t.content).then(function(e){angular.extend(t,{content:e}),n(t)})},t.reject)},{key:"SubscriptionService.getSubscriptionById:"+e+r},t.resolve),t.promise},getSubscriptionBySlug:function(e,r){var t=s.defer();return u(function(n){d.getSubscriptionBySlug({slug:e}).$promise.then(function(e){var t=e&&e.data;if(!r)return n(t);l.getContentById(t.content).then(function(e){angular.extend(t,{content:e}),n(t)})},function(){return n()})},{key:"SubscriptionService.getSubscriptionBySlug:"+e+r},function(e){e?t.resolve(e):t.reject()}),t.promise},createSubscription:function(e){return i.wrapResponse(d.createSubscription(e).$promise)},updateSubscription:function(e,t){return i.wrapResponse(d.updateSubscription({subscriptionId:e,subscription:t}).$promise)},deleteSubscription:function(e){return i.wrapResponse(d.deleteSubscription({id:e}).$promise)},updateSubscriptionState:function(e,t){return i.wrapResponse(d.updateSubscriptionState({subscriptionId:e,state:t}).$promise)},hasEligibility:function(e,t,n,r){return i.wrapResponse(d.hasEligibility({id:e,userId:t||"me",props:n||{},readOnly:r}).$promise)},activateSeat:function(e,t){t=a(t);var n=o();t||s.reject(new Error("Missing UserId"));return i.wrapResponse(d.activateSeat({subscriptionId:e,userId:t,email:n.email,hash:n.hash}).$promise)},getSubscriptionSeats:function(e){return i.wrapResponse(d.getSubscriptionSeats({id:e}).$promise)},getSubscriptionSeatsWithUsage:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=s.defer();if(t)return d.getSubscriptionSeatsWithUsage({subscriptionId:e}).$promise;return u(function(t){d.getSubscriptionSeatsWithUsage({subscriptionId:e}).$promise.then(function(e){t(e)},n.reject)},{key:"SubscriptionService.getSubscriptionSeatsWithUsage:"+e},n.resolve),n.promise},getSubscriptionUsageByRange:function(e,n,r,i){var o=s.defer();return u(function(t){d.getSubscriptionUsageByRange({subscriptionId:e,before:n,after:r,mode:i}).$promise.then(function(e){t(e)},o.reject)},{key:"SubscriptionService.getSubscriptionUsageByRange:"+e+n+r+i},o.resolve),o.promise},getSubscriptionSeat:function(e,n){n=a(n);var r=o();n||s.reject(new Error("Missing UserId"));var i=s.defer();return u(function(t){d.getSubscriptionSeat({subscriptionId:e,userId:n,email:r.email,hash:r.hash}).$promise.then(function(e){t(e&&e.data)},i.reject)},{key:"SubscriptionService.getSubscriptionSeat:"+e+n+JSON.stringify(r||{})},i.resolve),i.promise},createSeat:function(e,t){return i.wrapResponse(d.createSeat({subscriptionId:e,seat:t}).$promise)},createTrialSeat:function(e,t){return t=a(t),i.wrapResponse(d.createTrialSeat({subscriptionId:e,userId:t}).$promise)},updateSeat:function(e,t,n){return i.wrapResponse(d.updateSeat({subscriptionId:e,seatId:t,seat:n}).$promise)},importSeatsFromUsers:function(e,t,n){h.isNull(n)&&(n=void 0);return i.wrapResponse(d.importSeatsFromUsers({subscriptionId:e},{users:t,sendAt:n}).$promise)},sendInvitationEmail:function(t,n,r,e){return!e||h.isNull(r)||h.isUndefined(r)?p(t,n,r):f.getScheduledEmailBySeat(e).then(function(e){return e&&0!==e.length?f.updateScheduledEmail(e[0]._id,{sendAt:r,status:"scheduled"}):p(t,n,r)})},sendTrialInvitation:function(e,t){return i.wrapResponse(d.sendTrialInvitation({emails:e,campaignId:t}).$promise)},sendActivateEmail:function(){return i.wrapResponse(d.sendActivateEmail().$promise)},getOrderDetailsById:function(e){var n=s.defer();return u(function(t){d.getSubscriptionOrderDetailsById({id:e}).$promise.then(function(e){t(e&&e.data)},n.reject)},{key:"SubscriptionService.getSubscriptionOrderDetailsById:"+e},n.resolve),n.promise}};function p(e,t,n){return h.isNull(n)&&(n=void 0),i.wrapResponse(d.sendInvitationEmail({subscriptionId:e,userId:t},{sendAt:n}).$promise)}}]},{underscore:void 0}],159:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/subscriptionplans";return e(t,{},{get:{method:"GET",url:t,isArray:!1},getAllSubscriptionPlans:{method:"GET",url:t,isArray:!1},count:{method:"GET",url:t+"/count",isArray:!1},searchSubscriptionPlans:{method:"GET",url:t+"/search",isArray:!1},createSubscriptionPlan:{method:"POST",url:t,isArray:!1},getSubscriptionPlanById:{method:"GET",url:t+"/id/:id",isArray:!1},updateSubscriptionPlan:{method:"PATCH",url:t+"/:id",params:{id:"@subscriptionPlanId"},isArray:!1},deleteSubscriptionPlan:{method:"DELETE",url:t+"/:id",params:{id:"@subscriptionPlanId"},isArray:!1}})}]},{}],160:[function(e,t,n){"use strict";function r(t,i,n,r,o,e){return{getAllSubscriptionPlans:function(){return n.wrapResponse(o.getAllSubscriptionPlans().$promise)},getSubscriptionPlanById:function(e,n){var r=t.defer();return i(function(t){a(e,n).then(function(e){t(e)},r.reject)},{key:"SubscriptionPlanService.getSubscriptionPlanById:"+e+n},r.resolve),r.promise},getFreshSubscriptionPlanById:a,createSubscriptionPlan:function(e){return n.wrapResponse(o.createSubscriptionPlan(e).$promise)},updateSubscriptionPlan:function(e,t){return n.wrapResponse(o.updateSubscriptionPlan({subscriptionPlanId:e,subscriptionPlan:t}).$promise)},deleteSubscriptionPlan:function(e){return n.wrapResponse(o.deleteSubscriptionPlan({id:e}).$promise)}};function a(e,n){return o.getSubscriptionPlanById({id:e}).$promise.then(function(e){var t=e&&e.data;return n?r.getContentById(t.content).then(function(e){return angular.extend(t,{content:e}),t}):t})}}r.$inject=["$q","cacheStack","responseUtils","SavedSearchService","SubscriptionPlanResource","ProductService"],t.exports=r},{}],161:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/subtopic",{},{get:{url:"/api/subtopic/:id"},getByPath:{url:"/api/subtopic/path/:path"},getByTopic:{url:"/api/subtopic/topic/:topic"},getBySlug:{url:"/api/subtopic/slug/:slug"},getAllSubTopics:{url:"/api/subtopic",cache:!0},getSubTopicById:{url:"/api/subtopic/:id",cache:!0},getSubTopicByPath:{url:"/api/subtopic/path/:path",cache:!0},getSubTopicBySlug:{url:"/api/subtopic/slug/:slug",cache:!0}})}]},{}],162:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/tag",{},{getTopics:{url:"/api/tag",cache:!0},getTagById:{url:"/api/tag/:id",cache:!0},getTagBySlug:{url:"/api/tag/slug/:slug",cache:!0},getTagsByPath:{url:"/api/tag/path/:path",cache:!0}})}]},{}],163:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/tag",{},{getById:{url:"/api/tag/:id",isArray:!1,cache:!0},searchTags:{url:"/api/tag/search/:displayName",isArray:!0,cache:!0}})}]},{}],164:[function(e,t,n){"use strict";t.exports=["clTagResource","responseUtils",function(t,n){return{getById:function(e){return n.wrapResponse(t.getById({id:e}).$promise).then(function(e){return e[0]})},searchTags:function(e){return t.searchTags({displayName:e}).$promise}}}]},{}],165:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/target",{},{getById:{url:"/api/target/:id",isArray:!1,cache:!0},create:{method:"POST",url:"/api/target"},update:{method:"PUT",url:"/api/target/:id"},delete:{method:"DELETE",url:"/api/target/:id"}})}]},{}],166:[function(e,t,n){"use strict";function r(n,y,e,b,o,k,t,T,_,w){var S=this;return S.targetBySlug={},S.targetById={},S.targets=new t,S.currentTargets=[],S.currentTargetBySlug={},S.targetsReady=!1,S.optimizeTestCount=0,S.experimentConditions=[],{get:function(){var e=y.defer();return r().then(function(){e.resolve(S.targets)},e.reject),e.promise},getById:function(e){return n.getById({id:e}).$promise.then(function(e){return e&&e.data})},has:function(e){return!!S.currentTargetBySlug[e]},hasAnyTargets:function(e){var t=y.defer();return r().then(function(){return i(w.reduce(e,function(e,t){return S.targetBySlug[t]&&e.push(S.targetBySlug[t]),e},[])).then(function(e){t.resolve(0<e.length)})},t.reject),t.promise},hasAllTargets:function(t){var n=y.defer();return r().then(function(){return i(w.reduce(t,function(e,t){return S.targetBySlug[t]&&e.push(S.targetBySlug[t]),e},[])).then(function(e){n.resolve(e.length===t.length)})},n.reject),n.promise},testUserTargets:function(){var e=y.defer();return r().then(function(){S.currentTargets=w.reduce(S.targets,a,[]),e.resolve(S.currentTargets)},e.reject),e.promise},testTargets:i,createTarget:function(e){return n.create(e).$promise.then(function(e){return e&&e.data})},updateTarget:function(e){return n.update({id:e._id},e).$promise.then(function(e){return e&&e.data})},deleteTarget:function(e){return n.delete({id:e._id}).$promise.then(function(e){return e&&e.data})},targetBySlug:S.targetBySlug,resource:n};function r(){var t=y.defer();return e(function(t){n.get().$promise.then(function(e){angular.forEach(e.data||[],function(e){e=e,S.targetBySlug[e.slug]=e,S.targetById[e._id]=e,S.targets.addToSet(e,"_id")}),t(!0)},t)},{key:"TargetResource.Fetch",expires:"+5 minutes"},function(e){e?t.resolve(e):t.reject()},t.reject),t.promise}function a(e,t){return C(t)&&e.push(t),e}function i(e){var t=y.defer(),n=[];return w.each(e,function(e){n.push(C(e))}),y.all(n).then(function(e){t.resolve(w.without(e,!1))}),t.promise}function C(n){var r=y.defer(),t=(S.currentTargetBySlug[n.slug]&&y.resolve(n),[]);return w.each(n.conditions,function(e){t.push(function(n){var e=y.defer();if(n.editing)return!1;var t=_.getCreatorPassSubscription(),r=b.user.purchaseHistory(),i=b.user.cart,o=i&&i.lineItems,a=T&&T.dump,a=a.course&&a.course.primary_category||a.bundle&&a.bundle.primary_category||a.data&&a.data.primary_category,l=a&&a.slug;switch(n.slug){case"has-creator-pass":return y.resolve(E(n,t));case"has-monthly-pass":return y.resolve(E(n,t.monthly));case"has-yearly-pass":return y.resolve(E(n,t.yearly));case"has-starter-pass":return y.resolve(E(n,_.getSubcriptionBySlug("starter-pass")));case"has-consumer-pass":return y.resolve(E(n,_.getSubscriptionByType("consumer")));case"has-enterprise-pass":return y.resolve(E(n,_.getSubscriptionByType("enterprise")));case"expiration":var s={},c=(w.each(b.user.getActiveSubscriptions(),function(e){e.subscriptionPlan&&(s[e.subscriptionPlan.slug]=e.expiration)}),s["creator-pass"]||s["monthly-creator-pass"]||s["starter-pass"]);return y.resolve(A(c,n));case"subscription-created":var u={},c=(w.each(b.user.getActiveSubscriptions(),function(e){e.subscriptionPlan&&(u[e.subscriptionPlan.slug]=e.created)}),u["creator-pass"]||u["monthly-creator-pass"]||u["starter-pass"]);return y.resolve(A(c,n));case"auto-renew-enable":var d=!1;return w.each(b.user.getActiveSubscriptions(),function(e){"renewing"===e.state&&(d=!0)}),y.resolve(d.toString()===n.value);case"cart-value":c=i&&i.subtotal;return y.resolve(function(e,t){{if(">"===t.comparator&&e>t.num_value)return!0;if("<"===t.comparator&&e<t.num_value)return!0;if("="===t.comparator&&e===t.num_value)return!0;if("!="===t.comparator&&e!==t.num_value)return!0}return!1}(c/100,n));case"any-class-in-cart":var f=!1;return w.find(o,function(e){if(e&&e.source&&"course"===e.source.source_type)return f=!0}),f.toString()===n.value;case"particular-class-in-cart":var p=!1;return w.find(o,function(e){if(e&&e.slug===n.course)return p=!0}),p;case"any-bundle-in-cart":var h=!1;return w.find(o,function(e){if(e&&e.source&&"bundle"===e.source.source_type)return h=!0}),h.toString()===n.value;case"particular-bundle-in-cart":var m=!1;return w.find(o,function(e){if(e&&e.slug===n.bundle)return m=!0}),m;case"any-sub-in-cart":var g=!1;return w.find(o,function(e){if(e&&e.source&&"subscriptionPlan"===e.source.source_type)return g=!0}),g.toString()===n.value;case"particular-sub-in-cart":var v=!1;return w.find(o,function(e){if(e&&e.slug===n.subscriptionPlan)return v=!0}),v;case"has-made-purchase":c=b.user.hasTraits({"has-purchased":!0});return y.resolve(c.toString()===n.value);case"last-purchase":if(!r||0===r.length)return y.resolve(!1);c=r[0].purchased.date;return y.resolve(A(c,n));case"is-redeeming":return y.resolve(b.user.redeemInSession().toString()===n.value);case"is-logged-in":return y.resolve(b.user.valid().toString()===n.value);case"user-created":return y.resolve(A(b.user.get("created"),n));case"last-login":return y.resolve(A(b.user.get("last_login"),n));case"first-time-seen":return y.resolve(!!k.Session.set("first_time_user").toString()===n.value);case"page-category":return y.resolve(l===n.value);case"has-target":return y.resolve(C(S.targetBySlug[n.target]));case"url-target":c=window.location.pathname;return""===c&&(c="/"),y.resolve(function(e,t){var n=new RegExp(t.value);switch(t.comparator){case"equals":return e===t.value;case"contains":return e.includes(t.value);case"starts":return e.startsWith(t.value);case"ends":return e.endsWith(t.value);case"regex":return n.test(e);case"not-equal":return e!==t.value;case"not-contain":return!e.includes(t.value);case"not-start":return!e.startsWith(t.value);case"not-end":return!e.endsWith(t.value);case"not-regex":return!n.test(e)}return!1}(c,n));case"has-traits":c=n.value.reduce(function(e,t){return e[t.key]=t.value,e},{});return y.resolve(b.user.hasTraits(c));case"is-experiment":window.dataLayer.hide&&window.dataLayer.hide.end?(S.experimentConditions.push({deferred:e,condition:n}),window.dataLayer.hide.end=function(){w.each(S.experimentConditions,function(e){var t=window.google_optimize.get(e.condition.comparator);e.deferred.resolve(!(!t&&0!==t)&&t.toString()===n.value)}),S.experimentConditions=[]}):(c=window.google_optimize.get(n.comparator),e.resolve(!(!c&&0!==c)&&c.toString()===n.value));break;default:return y.resolve(!1)}return e.promise}(e))}),y.all(t).then(function(e){var t=-1===w.indexOf(e,!1),e=-1!==w.indexOf(e,!0);return"AND"===n.operation&&t||"OR"===n.operation&&e?(S.currentTargetBySlug[n.slug]=n,r.resolve(n)):void r.resolve(!1)}),r.promise}function E(e,t){switch(e.value){case"past":return!!t&&0===t.active.length&&0<t.inactive.length;case"true":return!!t&&0<t.active.length;case"false":return!t||0===t.all.length}return!1}function A(e,t){if(!e)return!1;e=o().diff(1e3*e),e=Math.abs(o.duration(e).as(t.type_time));return">"===t.comparator&&e>t.num_time||"<"===t.comparator&&e<t.num_time}}r.$inject=["TargetResource","$q","cacheStack","$rootScope","moment","Vault","DataSet","rind","UserSubscriptionService","_"],t.exports=r},{}],167:[function(e,t,n){"use strict";t.exports=["$resource","config",function(e,t){return e("/bff/taxonomy",{},{get:{url:t.cachingDomain+"/bff/taxonomy",cache:!0,isArray:!0}})}]},{}],168:[function(e,t,n){"use strict";var d=e("cache-stack");t.exports=["$q","taxonomyResource","_",function(i,n,o){var r={},a={},s={},c={};return{get:u,getById:l,getByIds:function(e){var n=i.defer();return u().then(function(){var t=new DataSet;o.each(e,function(e){e=l(e);t.addToSet(e)}),n.resolve(t)}),n.promise},getBySlug:function(e){return a[e]||c[e]},getTopicBySlugAndCategory:function(t,n){return u().then(function(e){e=o.findWhere(e,{slug:t});return e?o.findWhere(e.topics,{slug:n})||new Error("Topic for category not found"):new Error("Category Slug not found "+t)})},getCategoryBySlug:function(t){var n=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t});e?n.resolve(e):n.reject(new Error("Category Slug not found "+t))}),n.promise},getH1ByCategory:function(t){var n=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t});e&&e.seo_header?n.resolve(e.seo_header):n.reject(new Error("Category Slug not found "+t))}),n.promise},getH1ByTopic:function(t,n){var r=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t}),e=o.findWhere(e.topics,{path:n});e&&e.seo_header?r.resolve(e.seo_header):r.reject(new Error("topic path not found "+n))}),r.promise},getSeoTitleByCategory:function(t){var n=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t});e&&e.head_title?n.resolve(e.head_title):n.reject(new Error("Category Slug not found "+t))}),n.promise},getSeoTitleByTopic:function(t,n){var r=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t}),e=o.findWhere(e.topics,{path:n});e&&e.head_title?r.resolve(e.head_title):r.reject(new Error("topic path not found "+n))}),r.promise},getDescriptionByCategory:function(t){var n=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t});e&&e.description?n.resolve(e.description):n.reject(new Error("Category Slug not found "+t))}),n.promise},getDescriptionByTopic:function(t,n){var r=i.defer();return u().then(function(e){e=o.findWhere(e,{slug:t}),e=o.findWhere(e.topics,{path:n});e&&e.description?r.resolve(e.description):r.reject(new Error("topic path not found "+n))}),r.promise}};function u(){var e=i.defer();return d(function(t){n.get().$promise.then(function(e){angular.forEach(e,function(e){r[e._id]=e,a[e.slug]=e,angular.forEach(e.topics,function(){})}),t(e)}).catch(e.reject)},{key:"TaxonomyService.get"},e.resolve),e.promise}function l(e){return r[e]||s[e]}}]},{"cache-stack":32}],169:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/tier/:id?",{id:"@_id"},{count:{},search:{url:"/api/tiers"},update:{method:"PUT"},create:{method:"POST",url:"/api/tier"}})}]},{}],170:[function(e,t,n){"use strict";t.exports=["$q","TierResource",function(n,r){return{getTier:function(e){var t=n.defer();return r.get({id:e},function(e){t.resolve(e&&e.data)},t.reject),t.promise},getAllTiers:function(){var t=n.defer();return r.get({},function(e){t.resolve(e&&e.data)},t.reject),t.promise},updateTier:function(e){var t=n.defer();return r.update(e).$promise.then(function(e){t.resolve(e&&e.data)},t.reject),t.promise},createTier:function(e){var t=n.defer();return r.create(e).$promise.then(function(e){t.resolve(e&&e.data)},t.reject),t.promise},deleteTier:function(e){return r.delete({id:e}).$promise}}}]},{}],171:[function(e,t,n){"use strict";t.exports=["$resource",function(e){e=e("/api/topic",{id:"@id"},{getAllTopics:{url:"/api/topic",cache:!0},getTopicById:{url:"/api/topic/:id"},getTopicBySlug:{url:"/api/topic/slug/:slug"},getTopicByCategory:{url:"/api/topic/category/:id"},getAllByCategory:{url:"/api/topic/all/category",cache:!0},updateOrphanTopicCourses:{method:"PATCH",url:"/api/topic/:id"},addTopicToTopics:{method:"POST",url:"/api/topic/:id/add-to"},search:{url:"/api/topic/search/:query"},delete:{method:"DELETE",url:"/api/topic/:id"}});return e.get=e.getTopicById,e}]},{}],172:[function(e,t,n){"use strict";var a=e("cache-stack");t.exports=["$q","topicResource",function(n,r){var i={},o={};return{Resource:r,get:function(e){e=e||{};var t=n.defer();return a(function(t){r.get(e).$promise.then(function(e){e=e&&e.data;e&&angular.forEach(e,function(e){o[e._id]=e,i[e.primary_category]||(i[e.primary_category]=[]),i[e.primary_category].push(e)}),t(e)})},{key:"TopicService.get:"+JSON.stringify(e)},function(e){t.resolve(e)}),t.promise},search:function(e){var t=n.defer();return r.search({query:e}).$promise.then(function(e){t.resolve(e.data)}),t.promise},getAllByCategory:function(e){e=e||{};var t=n.defer();return a(function(t){r.getAllByCategory({primary:e.primary||!0}).$promise.then(function(e){t(e&&e.data)})},{key:"TopicService.getAllByCategory:"+JSON.stringify(e)},function(e){t.resolve(e)}),t.promise},getById:function(e){return o[e]},topicsByCategory:function(){return i},topicsById:function(){return o}}}]},{"cache-stack":32}],173:[function(e,t,n){"use strict";t.exports=["$resource",function(e){var t="/api/tracking/usage";return e(t,null,{getAll:{url:t},getByRange:{url:t+"/range"}})}]},{}],174:[function(e,t,n){"use strict";t.exports=["UsageTrackingResource","responseUtils",function(n,r){return{getAll:function(){return r.wrapResponse(n.getAll().$promise)},getByRange:function(e,t){return r.wrapResponse(n.getByRange({before:e,after:t}).$promise)}}}]},{}],175:[function(e,t,n){"use strict";function r(a,s,c,m,e,n,i,o,u,l,g,v,y,d,f,p,b){function t(e){this.user=e}return angular.extend(t.prototype,{validateOperation:function(e,t){var n=s.defer();!angular.isObject(t)||this.user.getPending(e)?n.reject():(this.user.setPending(e,!0),n.resolve());return n.promise},setUser:function(e){angular.extend(this.user._data,e),n.context.session=angular.copy(e),a.$broadcast("user:updated")},register:function(t){var n=this,r=s.defer(),i=_(t);return n.validateOperation("register",i).then(function(){return t=s.defer(),b.getCaptcha("registration",function(e){t.resolve(e)}),t.promise;var t}).then(function(e){l.register({email:i.email,password:i.password,profile:i.profile,captchaToken:e}).$promise.then(function(e){e&&e.success?p.bind(w,n)(i).then(function(){a.$broadcast("user:register");var e={cta_label:t.cta_label,student_email:t.email};n.signUpComplete("email",n.user.get("uid"),e,r.resolve)},r.reject):r.reject(g.register.messages.fail)},function(e){r.reject(h(e,"register"))}).finally(function(){n.user.removePending("register")})},r.reject),r.promise},login:function(e){var n=this,r=s.defer(),i=_(e);return n.validateOperation("login",i).then(function(){p.bind(w,n)(i).then(function(e){a.$broadcast("user:login");var t={label:"email",student_email:i.email};n.signInComplete("email",n.user.get("uid"),t,function(){r.resolve(e.data)})},function(e){r.reject(h(e,"login"))}).finally(function(){n.user.removePending("login")})},r.reject),r.promise},facebook:function(t){var n=this,r=s.defer();return t?n.validateOperation("facebook",{}).then(function(){if(t.token&&f.setToken(t.token),t.userData)return n.setUser(t.userData),t.userData.status;r.reject(t)}).then(function(e){d.Session.set("oauthLoginInSession",!0,{expires:"+5 minutes"}),"fb_register"!==e?(e={label:"facebook",student_email:(e=t.userData&&t.userData.user)&&e.primary_email&&e.primary_email.address},n.signInStart(e),n.signInComplete("facebook",n.user.get("uid"),e,r.resolve),a.$broadcast("user:login")):a.$broadcast("user:facebook-social-register",c.location.pathname)}).catch(function(e){a.$broadcast("user:facebook:error"),r.reject(h(e,"facebook"))}).finally(function(){n.user.removePending("facebook")}):r.reject("Missing Response"),r.promise},oauthVerifyToken:function(t,e){var n=this,r=d.Local.get(i.auth.storage||"session");return l.oauthVerifyToken({service:t},{oauthToken:e,sessionToken:r}).$promise.then(function(e){S.call(n,t,e)})},startOauth:function(e){var t=d.Local.get(i.auth.storage||"session");!function(e){{var t;n.context.ua.mobile?((t=d.Session.get("next"))&&(0<=e.indexOf("?")?e+="&":e+="?",e+="dest="+encodeURIComponent(t)),window.location.href=e):c.open(e,"clSocialLogin","width=800, height=600, resizeable, centerscreen").focus()}}("/session/oauth-init/"+e+"?token="+t)},oauthRegister:S,socialRegistration:function(t,n){var r=this;return l.oauthRegistration({service:n},t).$promise.then(function(e){return E.call(r,e,t,n)})},facebookRegistration:function(t,n){var r=this;return l.facebookRegistration(t).$promise.then(function(e){return E.call(r,e,t,n)})},logout:function(e,t){e&&e.preventDefault();var n=this,r=s.defer();return(new y).saveEngagement(),n.validateOperation("logout",{}).then(function(){var e=f.getPersistentCookie(!1);l.logout({cc:e}).$promise.then(function(e){f.setToken(e&&e.token),r.resolve(!0)}).catch(function(e){d.Local.remove(i.auth.storage||"session"),r.reject(e&&e.data&&e.data.message)}).finally(function(){d.Local.remove("subscription"),n.handleCompletion(!1),v.logout().then(function(){t&&t.noRedirect?c.location.reload():c.location="/"}),n.user.removePending("logout")})},r.reject),r.promise},resetPassword:function(e){var t=this,n=s.defer();return t.validateOperation("resetPassword",e).then(function(){l.resetPassword({email:e.email}).$promise.then(function(e){n.resolve(e)},n.reject).finally(function(){t.user.removePending("resetPassword")})},n.reject),n.promise},updatePassword:function(e){var t=this,n=s.defer();return t.validateOperation("updatePassword",e).then(function(){l.updatePassword(e).$promise.then(function(e){n.resolve(e)},n.reject).finally(function(){t.user.removePending("updatePassword")})},n.reject),n.promise},resetPasswordStatus:function(e,t){return l.resetPasswordStatus({email:e,hash:t}).$promise.then(function(e){return e&&e.success?e.data:s.reject(e.message||new Error("Failed to get password reset status"))}).catch(function(e){return e})},resetPasswordStatusById:function(e,t){return l.resetPasswordStatusById({userId:e,t:t}).$promise.then(function(e){return e&&e.success?e.data:s.reject(e.message||new Error("Failed to get password reset status"))}).catch(function(e){return s.reject(e)})},signInStart:function(e){e={label:e.label,student_email:e.student_email};u.signInStart(e)},signUpStart:function(e){u.signUpStart(e)},signInComplete:function(e,t,n,r){var i=this;n.from_reg||d.Session.set("first_time_user",!1);i.user.addClientTraits(!1,null),i.sendAuthAnalytics(function(){u.signInComplete(n,function(){i.handleCompletion(!0,e,"login"),r()})})},signUpComplete:function(e,t,n,r){var i=this;i.user.addClientTraits(!0,null),o.alias(t),i.sendAuthAnalytics(function(){n.label=e,u.signUpComplete(n,function(){i.handleCompletion(!0,e,"register"),r()})})},handleCompletion:function(e,t,n){e?(this.user.mergeExistingInterests(),this.user.updateInterest().then(function(){r(0,t)})):r(0,t)},filterLogInState:function(e){{var t;if(e)return t=this.user.get("_id"),"signedIn"===e&&t||"signedOut"===e&&!t}return!0},sendAuthAnalytics:function(e){o.identify(Date.now(),this.user.get("uid"),this.user.get("profile"),e),o.trackAffiliateLinkConversion(this.user.get("_id")),o.clearExtraProperties()},modalShown:function(e,t){o.addExtraProperties(e),u.accountModalShown(t)}}),t;function _(e){if(angular.isObject(e))return e=angular.copy(e),e.email=e.email.toLowerCase(),e}function h(e,t){var n=e&&e.status,e=e&&e.data&&e.data.message;return 401===n&&e===g.auth.errors.corruptToken&&c.location.reload(),(e="facebook"===t?g.login.messages.facebook.error:e)||n||void 0}function w(e){var t=this,n=f.getPersistentCookie(!1);return l.login({cc:n},{email:e.email,password:e.password}).$promise.then(function(e){if((e=angular.isString(e)?angular.fromJson(e):e).token)return f.setToken(e.token),l.getContext().$promise}).then(function(e){return(e=angular.isString(e)?angular.fromJson(e):e).data?(t.setUser(e.data),s.resolve(e)):s.reject(e)})}function S(n,r){var i=this,o=s.defer(),e="string"==typeof r?r:JSON.stringify(r||{});return r?i.validateOperation(n,{}).then(function(){if((r=r&&r.token?r:JSON.parse(e)).token&&f.setToken(r.token),r.userData)return i.setUser(r.userData),r.userData.status;o.reject(r)}).then(function(e){var t=!1;"oauth_register"!==e?("oauth_register_complete"===e&&(t=!0,e={cta_label:"Sign Up",student_email:i.user.get("primary_email").address},i.signUpComplete(n,i.user.get("uid"),e,function(){})),e=r.userData&&r.userData.user,e={label:n,student_email:e&&e.primary_email&&e.primary_email.address,from_reg:t},i.signInStart(e),i.signInComplete(n,i.user.get("uid"),e,o.resolve),a.$broadcast("user:login")):a.$broadcast("user:"+n+"-social-register",c.location.pathname)}).catch(function(e){a.$broadcast("user:"+n+":error"),o.reject(h(e,n))}).finally(function(){i.user.removePending(n)}):o.reject("Missing Response"),o.promise}function E(e,t,n){var r=s.defer();if(!e||!e.token||!e.userData)return s.reject("incomplete reg response");f.setToken(e.token),this.setUser(e.userData);e={cta_label:"Sign Up",student_email:t.email};return this.signUpComplete(n,this.user.get("uid"),e,function(){a.$broadcast("user:register"),r.resolve()}),r.promise}function r(e,t){0<=window.location.pathname.indexOf("settings/register/facebook")||d.Session.remove("next"),"google"!==t&&"microsoft"!==t||(d.Session.remove("next"),i=d.Session.getAndRemove("redeem_next")),d.Session.remove("redeem_next");var t=null!=window.location.pathname.match(/(login|register)/),n="/"===window.location.pathname,r=null!==window.location.pathname.match(/checkout/),i=d.Session.getAndRemove("next")||i,o="/",a=function(){var n=m.search();if(!p.isEmpty(n))return n;var e=c.location.search.substr(1).split("&");return p.each(e,function(e){var e=e.split("="),t=e[0],e=decodeURIComponent(e[1]);n[t]=e}),n}(),s=[];p.each(a,function(e,t){"dest"===t?o=e:s.push(t+"="+e)}),i?c.location.href=i:!t&&!n&&"/"===o||r||n&&"/"===o||(0<s.length&&s[0]&&(o+="?"+s.join("&")),c.location.href=o)}}r.$inject=["$rootScope","$q","$window","$location","$http","rind","config","AnalyticsService","trackFactory","UserResource","Responses","ReferralService","ScoresService","Vault","gangesSessionService","_","CaptchaService"],t.exports=r},{}],176:[function(e,t,n){"use strict";function r(a,s){return{get:function(e){var t=s.defer(),n=a.user.purchaseHistory(),r=a.user.cart;switch(e){case"subscription_expiration":var i={},o=(_.each(a.user.getActiveSubscriptions(),function(e){e.subscriptionPlan&&(i[e.subscriptionPlan.slug]=e.expiration)}),i["creator-pass"]||i["monthly-creator-pass"]||i["starter-pass"]);return s.resolve(o);case"registration":return s.resolve(a.user.get("created"));case"last_login":return s.resolve(a.user.get("last_login"));case"cart_created":if(r&&r.cart)return s.resolve(r.cart.created);case"last_purchase":if(!n||0===n.length)return s.resolve(!1);o=n[0].purchased.date;return s.resolve(o)}return t.promise}}}r.$inject=["$rootScope","$q"],t.exports=r},{}],177:[function(e,t,n){"use strict";t.exports=["UserResource",function(n){return{updateIntent:function(e){return n.updateIntent(e).$promise},getRecommendations:function(e,t){return n.getIntent({user:e,category:t}).$promise}}}]},{}],178:[function(e,t,n){"use strict";t.exports=["$resource","deepval",function(e,r){var i=e("/api/user/profile",null,{emailVerify:{url:"/api/user/verify/send",method:"POST"}});function o(e,t){return t._id===e._data._id}function a(e,t){var n=r(t,"user.primary_email.verified");return o(e,t)&&!n}function s(e,t){var n=e._data.profile,n=n.hasOwnProperty("first_name")&&0<n.first_name.length;return o(e,t)&&!n}this.emailVerifySend=function(t){i.emailVerify(function(e){t(null,e)},function(e){t(e)})},this.requireEmailVerification=a,this.requireProfileInformation=s,this.setEmailVerified=function(e){e&&e.user&&e.user.primary_email&&(e.user.primary_email.verified=!0)},this.requireVerification=function(e,t){var n=s(e,t);return a(e,t)||n},this.save=function(e,t){var n=angular.extend({},e.profile),r={};angular.forEach(c,function(e){void 0!==n[e]&&(r[e]=n[e])}),i.save(r,function(e){t(null,e)},t)}}];var c=["display_name","first_name","last_name","bio","headline","city","country","website","twitter","facebook","instagram"]},{}],179:[function(e,t,n){"use strict";t.exports=["$resource","$rootScope",function(e,t){return e("/api/auth",{userId:"@userId"},{validSession:{method:"GET",url:"/api/auth/valid"},login:{method:"PUT",url:"/session/:cc",headers:{Authorization:!0}},logout:{method:"DELETE",url:"/session/:cc",headers:{Authorization:!0}},facebookLogin:{method:"POST",url:"/api/user/facebook"},facebookRegistration:{method:"POST",url:"/bff/facebook/register",headers:{Authorization:!0}},oauthRegistration:{method:"POST",url:"/bff/register/:service",headers:{Authorization:!0}},register:{method:"POST",url:"/bff/register",headers:{"x-recaptcha-token":function(e){var t=e&&e.data&&e.data.captchaToken;return t&&delete e.data.captchaToken,t}}},oauthVerifyToken:{method:"POST",url:"/bff/oauth-verify-token/:service",headers:{Authorization:!0}},resetPassword:{method:"POST",url:"/api/user/reset-password/send"},updatePassword:{method:"POST",url:"/session/reset-password"},resetPasswordStatus:{url:"/api/user/reset-password/status"},resetPasswordStatusById:{url:"/api/user/reset-password/status/:userId"},saveProfile:{method:"POST",url:"/api/user/profile"},search:{url:"/api/user/search"},findById:{url:"/api/user/id/:id"},findBySlug:{url:"/api/user/slug/:slug"},content:{url:"/api/user/content"},getFull:{url:"/api/user/full"},getContext:{url:"/api/user"},enroll:{method:"POST",url:"/api/user/content/enroll"},unenroll:{method:"POST",url:"/api/user/content/unenroll"},star:{method:"POST",url:"/api/user/content/star"},unstar:{method:"POST",url:"/api/user/content/unstar"},checkValidEmail:{method:"POST",url:"/api/user/checkemail"},activationStatus:{method:"POST",url:"/api/user/activation/status"},sendActivation:{method:"POST",url:"/api/user/activation/send"},deleteUser:{method:"DELETE",url:"/api/user"},updateIntent:{method:"PUT",url:"/api/user/intent"},getIntent:{url:"/api/user/intent",cache:!0},getNotifications:{url:"/api/user/:userId/notifications"},setNotifications:{method:"POST",url:"/api/user/:userId/notifications"},addTraits:{method:"POST",url:"/api/user/traits"},getTraits:{method:"GET",url:"/api/user/traits"},addCoupons:{method:"POST",url:"/api/user/:userId/coupon"},getCoupons:{method:"GET",url:"/api/user/:userId/coupon"},removeCoupons:{method:"DELETE",url:"/api/user/:userId/coupon/:couponCode"},updateFurthestSegmentIndex:{method:"POST",url:"/api/user/segment/furthest"},follow:{method:"POST",url:"/api/user/:userId/follows/:entity",params:{entity:"@entity",userId:n},transformRequest:r},unfollow:{method:"DELETE",url:"/api/user/:userId/follows/:entity/:entityType/:entityKey",params:{entity:"@entity",userId:n},transformRequest:r},getFollows:{method:"GET",url:"/api/user/:userId/follows",params:{userId:n}},getFollow:{method:"GET",url:"/api/user/:userId/follows/:entity/:entityId",params:{entity:"@entity",userId:n},transformRequest:r},watchData:{url:"/api/user/segment"},getEvents:{url:"/api/user/:userId/events",cache:!0},getOrders:{url:"/api/user/orders"},getOrder:{url:"/api/user/order/:orderId"},authenticate:{url:"/api/auth/check-password",method:"POST"},checkName:{url:"/api/user/checkname",method:"GET"},update:{url:"/api/user/settings",method:"POST"},stats:{url:"/api/user/stats"},addCompany:{method:"PATCH",url:"/api/user/me/company"},kickUser:{url:"/api/user/:userId/kick",method:"POST"},unkickUser:{url:"/api/user/:userId/unkick",method:"POST"},getKickedUsers:{url:"/api/user/get-kicked/:timeInHours",method:"GET"},verifyEmail:{url:"/api/user/verify/confirm",method:"POST"},masquerade:{url:"/bff/session/masquerade",method:"POST"},getMySettingsOptions:{url:"/api/user/:userId/features",method:"GET",params:{userId:"@userId"}}});function n(){return t.user.valid()?t.user._data.user._id:null}function r(e){return e&&e.entity&&delete e.entity,angular.toJson(e)}}]},{}],180:[function(e,t,n){"use strict";r.$inject=["$rootScope","$q","$location","$window","qs","DataSet","UserAuthService","CatalogService","EventService","UserResource","bundleResource","CourseService","UserIntent","trackFactory","cacheClear","CartService","ProductService","UserSubscriptionService","PipelineService","_","deepval","moment","config"];var q=e("async"),W=e("cache-stack");function r(f,s,l,i,d,h,e,o,m,p,t,g,v,y,b,_,w,n,S,c,a,E,r){var u="trait_",A={bundle:t,course:g.Resource},k=E().unix();function T(){this.reset()}function C(){return n.getSubscriptionByState("active")}function I(){var e=n.getSubscriptionByType("consumer");return e&&e.active&&0<e.active.length}function x(){var e=n.getCreatorPassSubscription();return e.active&&0<e.active.length}function P(){var e,t=n.getCreatorPassSubscription(),t=t&&t.yearly&&t.yearly.active&&t.yearly.active[0];return!!t&&(e=t.expiration-E().unix(),t.expire_soon=E.duration(e,"seconds").asWeeks()<12,t)}function M(){var e,t=n.getCreatorPassSubscription(),t=t&&t.monthly&&t.monthly.active&&t.monthly.active[0];return!!t&&(e=t.expiration-E().unix(),t.expire_soon=E.duration(e,"seconds").asDays()<12,t)}function O(){var e=n.getSubscriptionByType("enterprise");return e&&e.active&&0<e.active.length}function R(){var e=n.getSubcriptionBySlug("starter-pass"),e=e&&e.active&&e.active.length,t=n.getSubcriptionBySlug("back-to-biz"),t=t&&t.active&&t.active.length;this.set("hasAnnualSubscription",!!this.getAnnualCreatorPassSubscription()),this.set("hasMonthlySubscription",!!this.getMonthlyCreatorPassSubscription()),this.set("hasConsumerSubscription",this.hasActiveConsumerSubscription()),this.set("hasMicrosoftSubscription",e&&this.getTrait("microsoft")),this.set("hasBackToBizSubscription",t),this.set("showCPHeader",this.showCPHeader())}function j(){_.has(!0)}function D(e,t,n){if(!this[e].user&&"timezone"===t)return"America/Los_Angeles";if(!this[e].user)return n;if("profile"===t)return this[e].profile||n;if("contentRights"===t)return this[e].contentRights||n;if("contentDetail"===t)return this[e].contentDetail||n;if("seats"===t)return this[e].seats||n;if("timezone"===t)return(r=this._data.user.timezone)&&r.name||n||"America/Los_Angeles";var r={};try{r=a(this,e+".user")}catch(e){return n}return r[t]||n}function N(e,t,n){return angular.isDefined(t)?(this[e].user||(this[e].user={}),a.set(this[e].user,t,n),a(this[e].user,t)):null}function L(e,t){if(!angular.isDefined(t)||!this[e].user)return null;a.del(this[e].user,t)}function $(e,t){return c.bind(L,this,"_pending",e)()}function B(e){var n={},e=(e._data.user&&angular.extend(n,e._data.user.traits),window.Vault.Local.getList());return c.each(e,function(e){var t=c.keys(e)[0],e=e[t];"string"!=typeof t||0!==t.indexOf(u)||0!==(t=t.replace(/trait_/,"")).indexOf("_")&&0!==t.indexOf("^")&&(n[t]=e)}),n}angular.extend(T.prototype,{cache:{},valid:function(){return!(!this._data||!this._data._id)},reset:function(){this._data={},this._pending={},this.cart=null,this.Auth=new e(this),"undefined"!=typeof rind&&rind&&function(){var n=this;rind.context.session&&rind.context.session.user&&rind.context.session.user._id&&j();f.$on("cart:updated",function(e,t){n.cart=t,function(e,t){if(!t.lineItems)return s.resolve();if(!t.lineItems.length)return s.resolve(t);var r=c.chain(t.lineItems).pluck("cross_sells").flatten().indexBy("courseId").value(),n=c.keys(r);return e.getCoursesByIds(n,{keys:["description","instructors","tagline","flags"]}).then(function(e){var n=c.chain(e).map(function(e){var t=r[e._id];return t&&(t.current_price=t.price,c.extend(e,t)),e}).indexBy("courseId").value();return t.lineItems=c.map(t.lineItems,function(e){return e.cross_sells=c.chain(e.cross_sells).reject(function(e){return!e}).reduce(function(e,t){return n[t.courseId]&&e.push(n[t.courseId]),e},[]).filter(w.isProductPurchasable).value(),e}),t})}(o,t).then(function(e){n.cart=e,n.populatedCart=e})}),f.$on("user:login",j.bind(null)),f.$on("user:register",j.bind(null)),f.$on("user:updated",R.bind(this))}.call(this)},get:function(e,t){return c.bind(D,this,"_data",e,t)()},set:function(e,t){return c.bind(N,this,"_data",e,t)()},del:function(e,t){return c.bind(L,this,"_data",e)()},setData:function(e){this._data=e,this.onUser()},getPending:function(e,t){return c.bind(D,this,"_pending",e,t)()},setPending:function(e,t){return c.bind(N,this,"_pending",e,t)()},delPending:$,removePending:$,hasContent:function(e,t,n){if(!n||!this._data.contentRights)return!1;t=t||"course";e=this._data.contentRights[e];return!!e&&c.contains(e[r.contentTypeMap[t]],n)},addContent:function(e){"course"!==e.source.source_type&&"bundle"!==e.source.source_type||this.get("contentRights").purchased[r.contentTypeMap[e.source.source_type]].push(e.source._id)},hasRole:function(e){return!!(this._data&&this._data.user&&this._data.user.roles)&&-1<this._data.user.roles.indexOf(e)},getFull:function(e){var t=this,n=s.defer();return p.getFull(e).$promise.then(function(e){t._data.user=e.data.user,t.onUser(),n.resolve(e&&e.data)},n.reject),n.promise},getContent:function(e){e=c.extend({populate:!1},e);var t=s.defer();return W(function(t){p.content(e).$promise.then(function(e){q.each(e.data,function(t,n){return t&&t.courses&&angular.isArray(t.courses)&&angular.isString(t.courses[0])?void o.getCoursesByIds(t.courses,{},{owner_only:!0,subscription_only:!0}).then(function(e){t.courses=e,n()}):n()},function(){t(e.data)})})},{key:"UserService.getContent:"+JSON.stringify(e)},function(e){t.resolve(e)}),t.promise},getContext:function(e){var t=this,n=s.defer();return p.getContext(e).$promise.then(function(e){t._data.user=e.data.user,t.onUser(),n.resolve(e&&e.data)},function(e){S.reportSessionErrorDiagnostic({source:"user.getContext",status_code:e&&e.status}),n.reject(e)}),n.promise},updateContent:function(a,s,o,c,u,l){var d=this;return s=s||"course",p[a]({id:o,type:s},function(){p.content({populate:!1},function(e){{var t;(d._data.contentRights=e.data,f.$broadcast("user:updateContent"),e=o,r=s,i=function(e){var t=a,n=s,r=e,i=u,o=l;if(r)switch("string"==typeof r.product&&(r.product={_id:r.product,source:{source_type:n,source_id:r._id,nid:r.nid}}),t){case"star":y.star(r,i,o);break;case"unstar":y.unStar(r,i,o);break;case"enroll":y.rsvp(r,i,o);break;case"unenroll":y.unRsvp(r,i,o)}"course"===s&&b.clearCourseCounts(e)},n=c)?i(n):(n=r,r=e,t=i,(n=A[n])&&n.findById?n.findById({id:r},function(e){t(e.data||e)}):t())}var n,r,i})})},checkForInterests:function(){var n=this;["","Pending"].forEach(function(e){var t=n["get"+e]("follows");(t=t||n["set"+e]("follows",{})).topic||(t.topic=[])})},hasInterests:function(e){if(this.checkForInterests(),e)return 0<this.getPending("follows").topic.length;return 0<this.get("follows").topic.length},hasPendingInterests:function(){var e=this.getPending("follows").topic.length,t=this.get("follows").topic.length;return e!==t},hasInterest:function(e){this.checkForInterests();var t=this.getPending("follows"),n=this.get("follows");if(0<t.topic.length)return 0<=t.topic.indexOf(e);return 0<=n.topic.indexOf(e)},addInterest:function(e){this.checkForInterests(),this.hasInterest(e)||this.getPending("follows").topic.push(e)},removeInterest:function(t){this.checkForInterests();var e=this.getPending("follows");e.topic=e.topic.filter(function(e){return e!==t})},mergeExistingInterests:function(){this.checkForInterests();var e=this.get("follows"),t=this.getPending("follows");t.topic=c.union(t.topic,e.topic),this.setPending("follows",t)},updateInterest:function(){var e=s.defer(),t=(this.checkForInterests(),this.get("follows").topic),n=this.getPending("follows").topic,r=c.difference(t,n),n=c.difference(n,t);return s.all([this.follow("topic",{entityIds:n}),this.unfollow("topic",{entityIds:r})]).finally(function(){e.resolve()}),e.promise},checkValidEmail:function(e){return p.checkValidEmail({email:e}).$promise},activationStatus:function(e,t){return p.activationStatus({email:e,type:t}).$promise},sendActivation:function(e,t){return p.sendActivation({email:e,type:t}).$promise},deleteUser:function(){return p.deleteUser().$promise},getTrait:function(e){if(!this.valid())return Vault.Local.get(u+e)||void 0;var t=this.get("traits");return t&&0!==c.size(t)?t[e]:void 0},getTraits:function(){{var n,e;return this._data&&this._data.user&&this._data.user._id?this.get("traits"):(n={},e=Vault.Local.getList(),c.each(e,function(e){var t=Object.keys(e)[0];t&&0===t.indexOf(u)&&(n[t.replace(u,"")]=e[t])}),n)}},setTrait:function(e,t,n,r){this.setTraitOnClient(e,t,n),this.addTraits([e],r)},setTraits:function(e,n,t){var r=this;t||(t=n,n=void 0);var i=[];angular.forEach(e,function(e,t){i.push(t),r.setTraitOnClient(t,e,n)}),this.addTraits(i,t)},setTraitOnClient:F,hasTraits:function(n){var r=B(this),e=c.keys(n),i=!0;return angular.forEach(e,function(e){var t=r[e];i&&z(t)!==z(n[e])&&(i=!1)}),i},addTraits:function(e,t){var n=this,r=this._data&&this._data.user&&this._data.user._id;{var i,o,a;r?(a=Vault.Local.getList(),i={},c.each(a,function(e){var t=Object.keys(e)[0];t&&0===t.indexOf(u)&&(i[t.replace(/trait_/,"")]=e[t])}),o={},c.each(e,function(e){var t=i[e],n="boolean"==typeof t||"number"==typeof t;!t&&!n||((t=n?t:decodeURIComponent(i[e]))||n)&&(o[e]=t)}),o=this.minimizeSendData(o,rind.context.session.user.traits||{}),0<Object.keys(o).length?(a={_id:r,traits:o},p.addTraits(a,function(e){n._data.user.traits||(n._data.user.traits={}),angular.forEach(o,function(e,t){n._data.user.traits[t]=e,e=t,!0&&U.indexOf(e)<0&&Vault.Local.remove(u+e)}),c.isFunction(t)&&t()})):c.isFunction(t)&&t()):c.isFunction(t)&&t()}},addProps:function(e,t){this.valid()&&(this._data.generatedProps||(this._data.generatedProps={}),this._data.generatedProps[e]=t)},getProps:function(e){if(this.valid())return this._data.generatedProps&&this._data.generatedProps[e]},removeProps:function(e){this.valid()&&delete this._data.generatedProps[e]},getMySettingsOptions:function(){var t=s.defer(),e=this.get("_id");return W(function(t){p.getMySettingsOptions({userId:e}).$promise.then(function(e){t(e.data)})},{key:"UserService.getMySettingsOptions:"+e},function(e){t.resolve(e)}),t.promise},traitsMeetConditional:function(e){var n=!0;{var r;e&&e.length&&(n=!1,this._data.user&&(r=B(this),angular.forEach(e,function(e){var t=e.key,e=e.value&&e.value.toString();(r[t]&&r[t].toString())===e&&(n=!0)})))}return n},filterBucket:function(e){return 0===c.size(e)},filterConfig:function(e){if(0===c.size(e))return!0;var o=f.rind.config;return c.reduce(e,function(e,t){n=o,r=t.name;var n,r,i=c.reduce(r.split("."),function(e,t){return e&&e[t]},n);switch(!0){case"show"===t.action:return i&&!0===i.enable;case"hide"===t.action:return!i||!1===i.enable}},!1)},getApplicableCoupons:function(){var t=s.defer(),n=this,e=this.get("_id");e?(e={userId:e},p.getCoupons(e,function(e){e=e&&e.data||[];n.set("coupons",e),t.resolve(e)})):t.reject(new Error("no userId"));return t.promise},addApplicableCoupon:function(n){var r=s.defer(),i=this,e=this.get("_id");e&&n?p.addCoupons({userId:e},{coupons:n},function(e){var t=i.get("coupons")||[];t.concat(n),i.set("coupons",t),r.resolve(t)}):r.reject(new Error("no userId"));return r.promise},removeApplicableCoupon:function(e){var t=s.defer(),n=this,r=this.get("_id");r&&e?(r={userId:r,couponCode:e},p.removeCoupons(r,function(e){e=e&&e.coupons||[];n.set("coupons",e),t.resolve(e)})):t.reject(new Error("no userId"));return t.promise},checkUTM:function(){var e=l.absUrl(),e=e.substring(e.indexOf("?"),e.length),t=d.parse(e),e=Vault.Local.get("trait_source");F("source",e||"unknown");(t.utm_source||t.utm_medium||t.utm_campaign||t.utm_content||t.utm_term)&&(c.each(U,function(e){"_"!==e[0]&&Vault.Local.remove(u+e)}),e=c.filter(U,function(e){return"_"!==e[0]}),c.each(e,function(e){t["utm_"+e]&&F(e,t["utm_"+e])}),this.addUTMTraits())},addUTMTraits:function(){this.addTraits(U)},addQueryTraits:function(){var e=l.absUrl(),e=e.substring(e.indexOf("?"),e.length),n=d.parse(e),r=[];c.each(Object.keys(n),function(e){var t;0===e.indexOf("cltrait_")&&(F(t=e.substring("cltrait_".length),n[e],{}),r.push(t))}),r.length&&this.addTraits(r)},addClientTraits:function(e,t){var n=function(){var e=Vault.Local.getList(),t=[];return c.each(e,function(e){e=Object.keys(e)[0];e&&0===e.indexOf(u)&&t.push(e.replace(/trait_/,""))}),t}();e||(n=c.difference(n,U));this.addTraits(n,t)},minimizeSendData:function(e,t){var n,r={};for(n in e)0===n.indexOf("_")?t[n]||(r[n]=e[n]):!function(e){return c.contains(["campaign","medium","content","source","term"],e)}(n)&&e[n]===t[n]||(r[n]=e[n]);return r},updateTraits:function(t){var n=this,e=this._data&&this._data.user&&this._data.user._id;e&&(e={_id:e},p.getTraits(e,function(e){rind.context.session.user.traits=e.data,n._data.traits=e.data,t&&t()}))},updateUserIntent:function(e,t){this.valid()&&v.updateIntent({category:e||"all",tag:t||null})},updateFurthestSegmentIndex:function(e,t){p.updateFurthestSegmentIndex(e,function(e){t&&t()})},getNotifications:function(e){return p.getNotifications({userId:e||"me"}).$promise},setNotifications:function(e,t){e=angular.extend({userId:e||"me"},t);return p.setNotifications(e).$promise},follow:function(t,e){var n=s.defer(),r=this,i={entity:t};if(!r.valid())return n.reject(),n.promise;if(e.entityId)i.entityId=e.entityId;else if(angular.isArray(e.entityIds)){if(0===e.entityIds.length)return n.reject(),n.promise;i.entityId=e.entityIds.join(",")}else if(e.entitySlug)i.entitySlug=e.entitySlug;else{if(!e.entityName)return n.reject(),n.promise;i.entityName=e.entityName}return p.follow(i).$promise.then(function(e){e&&e.success&&e.data?(angular.isArray(e.data)?angular.forEach(e.data,function(e){-1===r.get("follows")[t].indexOf(e._id)&&r._data.user.follows[t].push(e._id)}):-1===r.get("follows")[t].indexOf(e.data._id)&&r._data.user.follows[t].push(e.data._id),f.$broadcast("user:follow",e.data),n.resolve(e.data)):n.reject()},function(e){n.reject(e)}),n.promise},unfollow:function(e,t){var n=null,r=[],i=null,o=this,a={entity:e};if(!o.valid())return(n=s.defer()).reject(),n.promise;if(t.entityId)i=[t.entityId],a.entityType="id";else if(angular.isArray(t.entityIds))i=t.entityIds,a.entityType="id";else if(t.entitySlug)i=[t.entitySlug],a.entityType="slug";else{if(!t.entityName)return(n=s.defer()).reject(),n.promise;i=[t.entityName],a.entityType="name"}return i.forEach(function(e){var t=angular.copy(a),e=(t.entityKey=e,s.defer());!function(t){var n=s.defer(),r=this;return p.unfollow(t).$promise.then(function(e){e&&e.success&&e.data&&(angular.isArray(e.data)?angular.forEach(e.data,function(e){r._data.user.follows[t.entity].splice(r._data.user.follows[t.entity].indexOf(e._id),1)}):r._data.user.follows[t.entity].splice(r._data.user.follows[t.entity].indexOf(e.data._id),1),f.$broadcast("user:unfollow",e.data),n.resolve(e.data)),n.reject()},function(e){n.reject(e)}),n.promise}.call(o,t).then(e.resolve,e.reject),r.push(e.promise)}),s.all(r)},getFollow:function(e,t){return p.getFollow({entity:e,entityId:t}).$promise},getFollows:function(){return p.getFollows().$promise},isFollowing:function(t,n){var r=s.defer(),i=this,o=null;if(!i.valid())return r.reject(),r.promise;i.get("follows")||i.set("follows",{});i.get("follows")[t]||i.set("follows."+t,[]);n.entityId?r.resolve(-1<i._data.user.follows[t].indexOf(n.entityId)):angular.isArray(n.entityIds)?(o=n.entityIds.filter(function(e){return-1<i._data.user.follows[t].indexOf(e)}),r.resolve(0<n.entityIds.length&&0<o.length)):p.getFollows().$promise.then(function(e){e&&e.success&&e.data&&(e.data[t]||angular.isArray(e.data[t])?(o=0<e.data[t].filter(function(e){return n.entitySlug?e.slug===n.entitySlug:n.entityName?e.name===n.entityName:void 0}).length,r.resolve(o)):r.resolve(!1))});return r.promise},followEventSource:function(e,n){var r=this,e=angular.isArray(e)?e:[e];angular.forEach(e,function(e){m.getEventById(e).then(function(e){e&&e.product&&(e=angular.isObject(e.product)?e.product._id:e.product,o.getCourseByProduct(e).then(function(e){var t;e&&(t=e.courses?"bundle":"course",r[n](t,{entityId:e._id}))}))})})},watchHistory:V,recentlyWatched:function(e){var n=this,r=s.defer();return V(e).then(function(e){var t;if(angular.forEach(e,function(e){e.segment&&e.course&&!t&&n.hasContent("purchased","course",e.course)&&(t=e.course)}),!t)return r.resolve();o.getCourseById(t,{bff:!0}).then(r.resolve).catch(function(e){r.resolve()})}).catch(function(e){}),r.promise},recentlyWatchedCourses:function(n){var r=s.defer();return V({limit:100}).then(function(e){var t=new h;angular.forEach(e,function(e){e.course&&t.length<n.limit&&t.addToSet(e.course)}),o.getCoursesByIds(t).then(r.resolve).catch(function(e){r.reject()})}).catch(function(e){}),r.promise},purchaseHistory:function(){var t,n=c.indexBy(this.get("contentDetail"),function(e){return e.course}),e=this.get("contentRights")?angular.copy(this.get("contentRights").purchased.courses).reverse():[];if(e.length)return t=[],c.each(e,function(e){e=n[e];e&&(e.course||e.bundle)&&t.push(e)}),t},recentPurchase:function(){var r=this,e=s.defer();return W(function(t){var n,e=r.purchaseHistory();return e&&(n=e[0])&&n.course?void o.getCourseById(n.course).then(function(e){if(!e)return t();e.purchased=a(n||{},"purchased.date"),t(e)},function(){t()}):t()},{key:"UserService:recentPurchase"},e.resolve),e.promise},recentInteraction:function(e){var r=s.defer(),i={recentlyWatched:void 0,recentPurchase:void 0};return s.all([this.recentlyWatched().then(function(e){i.recentlyWatched=e},angular.noop),this.recentPurchase().then(function(e){i.recentPurchase=e},angular.noop)]).finally(function(){var e,t=0,n=i.recentPurchase&&i.recentPurchase.purchased||0;!i.recentlyWatched||(e=g.getLatestSegmentForCourse(i.recentlyWatched))&&e.watchData&&(t=e.watchData.modified),i.recentlyWatched&&n<=t?i.mostRecent=i.recentlyWatched:i.recentPurchase&&(i.mostRecent=i.recentPurchase),r.resolve(i)}),r.promise},recentInteractions:function(n){n=n||{};var i=this,e=s.defer(),t=i.purchaseHistory();return t=n.limit?t.slice(0,n.limit):t,W(function(e){var r={courses:new h,index:{},history:{watch:new h,purchased:new h}};q.series([function(t){i.recentInteraction().then(function(e){e&&e.mostRecent&&(r.recent=e.mostRecent,r.recent.type="keep-watching",r.courses.addToSet(r.recent,H),r.index[r.recent._id]=r.recent),t()}).catch(function(){t()})},function(e){q.each(t,function(e,t){o.getCourseById(e.course,{bff:!0}).then(function(e){e&&r.courses.addToSet(e,H)&&(e.type="keep-watching",r.index[e._id]=e),t()},t)},function(){e()})},function(e){var t=angular.copy(i.get("contentRights").starred.courses).reverse();n.limit&&(t=t.slice(0,n.limit)),q.each(t,function(e,t){o.getCourseById(e,{bff:!0}).then(function(e){e&&r.courses.addToSet(e,H)&&(e.type="wishlisted",r.index[e._id]=e),t()},t)},function(){e()})},function(t){i.watchHistory().then(function(e){q.each(e,function(t,n){o.getCourseById(t.course,{bff:!0}).then(function(e){e&&(e.last_watched=a(t||{},"modified"),e.last_interaction=a(t||{},"modified"),r.history.watch.addToSet(e)),n()},n)},function(){t()})}).catch(function(){t()})},function(e){angular.forEach(t,function(e){var t=r.index[e.course];t&&(t.purchased=a(e||{},"purchased.date"),(!t.last_interaction||t.purchased>t.last_interaction)&&(t.last_interaction=t.purchased),r.history.purchased.addToSet(t))}),e()},function(t){i.getEvents({limit:0,populate:"product"}).then(function(e){e=e.events;e&&(r.onair=m.getCurrentLiveEvents(e),r.onair.length&&(c.each(r.onair,function(e){e.type="live-now"}),r.courses.addToSet(r.onair,H)),angular.forEach(e,function(e){var t=r.courses.addToSet(e,H);e.end_time<k&&(e.type="past-event"),t&&!e.type&&(e.type="upcoming-event")})),t()}).catch(function(){t()})}],function(){e(r)})},{key:"UserService.recentInteractions:"+JSON.stringify(n)},e.resolve),e.promise},getEvents:function(i){var e=s.defer();i=i||{};i.userId||(i.userId=this.get("_id"));return W(function(r){p.getEvents(i).$promise.then(function(e){var t,n=e&&e.data;i.upcoming&&(t=n,n=c.filter(t,function(e){return e.end_time>k})),r({events:n,count:e.count})},r)},{key:"UserService:getEvents:"+JSON.stringify(i),expires:"+30 seconds"},e.resolve),e.promise},getOrders:function(e){var t=s.defer();return W(function(t){p.getOrders(e).$promise.then(function(e){t(e&&e.data)},t)},{key:"UserService:getOrders:"+JSON.stringify(e||{}),expires:"+1 minute"},t.resolve),t.promise},getOrder:function(e,t){t=t||{};var n=s.defer();return W(function(t){p.getOrder(e).$promise.then(function(e){t(e&&e.data)},t)},{key:"UserService:getOrder:"+JSON.stringify(e||{}),expires:t.expires||"+5 minute"},n.resolve),n.promise},updateUserAccount:function(e,t){e={email:e.primary_email.address,username:e.slug,timezone:e.timezone&&e.timezone.name};p.update(e,function(e){t(null,e)},t)},checkName:function(e,t){p.checkName({username:e},function(e){t(e||{})})},addCompany:function(t,n,r){var i=this;return p.addCompany({company_name:t,company_size:n,job_title:r}).$promise.then(function(e){return i.set("company.name",t),i.set("company.size",n),i.set("company.job_title",r),e})},isMyself:function(e){return!!this.valid()&&(this._data&&this._data.user&&this._data.user._id)===e},setHomepage:function(){var e=Vault.Local.get("subscription"),t=i.location.href,n=new RegExp("\\b(?:"+i.location.protocol+"//"+i.location.host+").*?"),r=new RegExp("\\b(?:"+i.location.protocol+"//"+i.location.host+"/[a-zA-Z0-9]).*?");this.valid()&&n.test(t)&&!r.test(t)?e&&!e.homepage&&e.slug?(i.location.href=i.location.protocol+"//"+i.location.host+e.slug,f.hasTeamHomepage=!0):(e&&e.homepage&&(Vault.Local.remove("subscription"),f.hasTeamHomepage=!1),0!==(n=c.pluck(this.get("seats"),"subscription")).length?n.forEach(function(e){e&&e.slug&&e.homepage&&e.homepage.page?(Vault.Local.set("subscription",{slug:e.homepage.page}),i.location.href=i.location.protocol+"//"+i.location.host+e.homepage.page,f.hasTeamHomepage=!0):f.homepageSet=!0}):f.homepageSet=!0):(f.homepageSet=!0,f.hasTeamHomepage=!(!e||!e.slug))},getActiveSubscriptions:C,getActiveSubscriptionsContentIds:function(){var e=C();return c.pluck(e,"content").join(",")},getActiveSubscriptionsLabel:function(){var e=C();if(1<e.length)return"Subscriptions";if(0===e.length)return"";if(x())return"Creator Pass";return"consumer"===e[0].type?e[0].subscriptionPlan.short_title:e[0].name},getActiveSubscriptionPlans:function(){return n.getSubscriptionPlanByState("active")},getNumActiveSubscriptions:function(){return C().length},hasActiveConsumerSubscription:I,hasCreatorPassSubscription:x,getAnnualCreatorPassSubscription:P,getMonthlyCreatorPassSubscription:M,hasActiveEnterpriseSubscription:O,showCPHeader:function(){var e=P();{if(function(){var e=!1;r&&r.globalNav&&r.globalNav.CPHeaderCTAUrlBlacklist&&(e=-1!==c.indexOf(r.globalNav.CPHeaderCTAUrlBlacklist,i.location.pathname));return e}()||O()||this.get("hasBackToBizSubscription"))return!1;if(!I())return!0;if(e&&e.expire_soon)return!0;if(!e&&!M())return!0}return!1},redeemInSession:Y,onUser:R});var U=["_source","_medium","_campaign","_content","_term","source","medium","campaign","content","term"];function F(e,t,n){Vault.Local.set(u+e,t,n)}function z(e){return"true"===e||"false"!==e&&e}function V(e){var t=s.defer(),r=angular.extend({limit:10,sort:"-modified"},e);return W(function(n){p.watchData(r).$promise.then(function(e){g.cacheWatchData(e.data);var t=new h;angular.forEach(e.data,function(e){t.addToSet(e,"course")}),n(t)},t.reject)},{key:"UserService:watchHistory:"+JSON.stringify(r)},t.resolve),t.promise}function H(e,t){e=(e=a(e,"product"))&&(e._id||e),t=a(t,"product");return e===(t=t&&(t._id||t))}return T}function Y(){return Vault.Session.get("redeemInSession")}t.exports=r},{async:21,"cache-stack":32}],181:[function(e,t,n){"use strict";function r(e,t,a,n){var s={active:new a,inactive:new a},c={active:new a,inactive:new a},u={},l={},d={all:new a,active:new a,inactive:new a},f=t.creatorPass&&t.creatorPass.contentId;return r(),e.$on("user:login",r),e.$on("user:addSubscription",r),e.$on("user:register",r),{init:r,getSubscriptionByState:function(e){return s[e]},getSubscriptionPlanByState:function(e){return c[e]},getCreatorPassSubscription:function(){return d},getSubcriptionBySlug:function(e){return l[e]},getSubscriptionByType:function(e){return u[e]}};function r(){var e=n&&n.context&&n.context.session&&n.context.session.seats;_.each(e,function(e){var t,n,r,i,o=e.subscription;o&&(t=o.subscriptionPlan&&o.subscriptionPlan.slug||o.slug,l[t]||(l[t]={all:new a,active:new a,inactive:new a}),l[t].all.addToSet(o),u[o.type]||(u[o.type]={all:new a,active:new a,inactive:new a}),u[o.type].all.addToSet(o),"consumer"===o.type&&o.content===f&&(r=(n=e).subscription,d.all.addToSet(r),i=r.subscriptionPlan.billingFrequency,d[i]||(d[i]={all:new a,active:new a,inactive:new a}),d[i].all.addToSet(r),"active"===n.state&&r&&"inactive"!==r.state&&(d.active.addToSet(r),d[i].active.addToSet(r)),r&&"inactive"===r.state&&(d.inactive.addToSet(r),d[i].inactive.addToSet(r))),"active"===e.state&&o&&"inactive"!==o.state&&(s.active.addToSet(o,"_id"),o.subscriptionPlan&&c.active.addToSet(o.subscriptionPlan,"_id"),l[t].active.addToSet(o),u[o.type].active.addToSet(o)),o&&"inactive"===o.state&&(s.inactive.addToSet(o,"_id"),o.subscriptionPlan&&c.inactive.addToSet(o.subscriptionPlan,"_id"),l[t].inactive.addToSet(o),u[o.type].inactive.addToSet(o)))})}}r.$inject=["$rootScope","config","DataSet","rind"],t.exports=r},{}],182:[function(e,t,n){"use strict";var f=e("async");t.exports=["CatalogService","EventService","broadcastService","segmentService","trackFactory","$timeout",function(c,t,r,i,u,l){var d={};return{addVideoPlayer:function(t,e,n){e={$scope:e,autoplay:!0,broadcasts:new r({onBroadcastStart:function(e){o(t,e,n)}}),segments:new i(e)};return d[t]=e},getVideoPlayer:function(e){return d[e]},playBroadcast:o};function o(o,a,s){var e;a&&a.eventId&&(e=a.eventId,void 0===s&&(s=!0),t.getEventById(e).then(function(e){var t,n,r,i=d[o];a&&a.channel?(t={streamId:a.channel.stream_config.stream_id,autoplay:i.autoplay&&(void 0===a.autoplay||a.autoplay)},n=e&&e.product&&e.product.source.source_id,r={},f.series([function(t){c.getCourseById(n).then(function(e){r=e,t()},function(){t()})}],function(){t.posterUrl=r.image,t.title=r.title,s&&u.liveOrRebroadcastPings(r,a.eventId,a.broadcast_type),l(function(){i.$scope.$broadcast("video:stream",t)})})):i.$scope.$broadcast("video:stream:pause")}).catch(function(e){}))}}]},{async:21}],183:[function(e,t,n){"use strict";t.exports=[function(){return function(e,t){return angular.isNumber(e)&&angular.isNumber(t)?e+t:0}}]},{}],184:[function(e,t,n){"use strict";t.exports=["$httpParamSerializer","_",function(s,c){return function(e,t,n){if(!e)return"";if(!t)return e;var r="",i=e.split("#"),o=c.last(i);if(1<i.length&&"#"!==o&&(r="#"+o,!n))return e;var o=i[0].split("?"),n=o[0],e=2===o.length?o[1]:"",a={};return e&&c.each(e.split("&"),function(e){e=e.split("=");a[e[0]]=e[1]}),angular.extend(a,t),0<c.size(a)?n+"?"+s(a)+r:n+r}}]},{}],185:[function(e,t,n){"use strict";t.exports=function(){return function(e){try{return JSON.stringify(e).length}catch(e){}return""}}},{}],186:[function(e,t,n){"use strict";t.exports=[function(){return function(e){return e?e.substring(0,1).toUpperCase()+e.substring(1):""}}]},{}],187:[function(e,t,n){"use strict";t.exports=function(){return function(e,t,n,r,i){if(0===e)return i||"";if(!e)return"";t=t||"";i=(e/100).toFixed(n=void 0===n?2:n);return 0==e%100&&r&&(i*=1),(t+i).replace(t+"-","-"+t)}}},{}],188:[function(e,t,n){"use strict";var i=e("underscore");t.exports=function(){return i.memoize(function(n,r){return angular.isArray(n)?(angular.isNumber(r)||(r=2),i.chain(n).groupBy(function(e,t){return Math.floor(t/(n.length/r))}).toArray().value()):n},function(e,t,n){return n?e.map(function(e){return e[n]}):e})}},{underscore:void 0}],189:[function(e,t,n){"use strict";t.exports=["moment","$filter",function(r,e){return function(e,t,n){e=r.duration(e);return e&&e._data?(t=(t=(t=(t=(t=(t=(t=t.replace(/\by\b/,e._data.years)).replace(/\bM\b/,e._data.months)).replace(/\bw\b/,e._data.weeks)).replace(/\bd\b/,e._data.days)).replace(/\bh\b/,e._data.hours)).replace(/\bms\b/,e._data.milliseconds)).replace(/\bm\b/,e._data.minutes)).replace(/\bs\b/,e._data.seconds):""}}]},{}],190:[function(e,t,n){"use strict";t.exports=function(){return function(e){return encodeURIComponent(e)}}},{}],191:[function(e,t,n){"use strict";t.exports=function(){return function(e){return e.match(/\/([^/]*)$/)[1]}}},{}],192:[function(e,t,n){"use strict";var o=e("underscore"),a={B:1e9,M:1e6,K:1e3},s={B:2,M:2,K:0};t.exports=["$filter",function(t){return function(n,e){return void 0===n?"":(o.each(a,function(e,t){!r&&e<n&&(r=n/e,i=t)}),!e&&i&&(e=s[i]),t("number")(r||n,e||0).replace(/\.0$/gi,"")+(i||""));var r,i}}]},{underscore:void 0}],193:[function(e,t,n){"use strict";var r=e("underscore"),i=e("crypto");t.exports=function(){return r.memoize(function(e,t){return r.groupBy(e,t)},function(e){if(e)return i.createHash("md5").update(JSON.stringify(e)).digest("hex")})}},{crypto:1106,underscore:void 0}],194:[function(e,t,n){"use strict";t.exports=function(){return function(e){e=angular.copy(e);return angular.isObject(e)?"string"==typeof(e.file||e).key:!!e&&(!(!e.match(/cl-public/)&&!e.match(/^\/?sites\/default/))||!!(e.match(/^\/(ugc|agc)/)||"/"!==e.substr(0,1)&&"http"!==e.substr(0,4)))}}},{}],195:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter","i18nResource","i18n","$interpolate","$sce",function(e,t,o,a,s,c){var u=new RegExp("{{"),l={};return function(e,t,n){if(!e)return"";if(!a||!a.strings)return t?n&&u.test(t)?s(t)(n,!1,c.HTML):t:e;var r=t,i=a.strings[e];return void 0!==i||l[e]?r=i:(l[e]=!0,o.addString({key:e,value:t})),r=(r=void 0===r&&void 0===i&&t?t:r)&&n&&u.test(r)?s(r)(n,!1,c.HTML):r}}]},{}],196:[function(e,t,n){"use strict";t.exports=["ClassUrlGenerator",function(n){return function(e,t){t=n(t);return t.startsWith("/class/")&&e?t+"/lessons/"+e.slug:t}}]},{}],197:[function(e,t,n){"use strict";t.exports=["ClassUrlGenerator",function(n){return function(e){if(!e)return null;if(!e.slug)return null;var t={subscriptionPlan:"/pass/",conference:"/bundle/",bundle:"/bundle/",learning_path:"/bundle/",courses:"/class/"};return"courses"===e.type?n(e.source):t[e.type]?t[e.type]+e.slug:null}}]},{}],198:[function(e,t,n){"use strict";t.exports=["ClassUrlGenerator",function(a){return function(e,t){if(!e)return null;var n=t?"/admin/bundles/#/":"/bundle/",r=t?"/admin/playlists/#/":"/playlist/",i=t?"/admin/instructors/#/":"/instructor/",o=t?"/admin/subscriptions/#/":"/creator-pass";return e.profile&&e.profile.bio?i+e.slug:e.event&&e.event.url?e.event.url:e.url||(e.nid?e.courses||"bundle"===e.content_type||"learning_path"===e.content_type?n+e.slug:"subscriptionPlan"===e.source_type?t?o+e.subscriptionId:o:a(e):void 0!==e.segments?r+e.slug:"")}}]},{}],199:[function(e,t,n){"use strict";t.exports=["$window","$sce","config",function(a,e,s){var c=a.devicePixelRatio||1,u=function(){var e=a.innerWidth;return e<480?"screen-xs":480<=e&&e<768?"screen-sm":768<=e&&e<992?"screen-md":992<=e&&e<1200?"screen-lg":1200<=e&&e<1500?"screen-xl":1500<=e&&e<2e3?"screen-xxl":2e3<=e?"screen-xxxl":void 0}();return function(e,t){e=angular.copy(e);if(angular.isObject(e)){var n=e.file||e;if("string"!=typeof(r=n.key))return null;e=n.key}if(!e)return null;if(e.match(/cl-public/)||e.match(/^\/?sites\/default/))return e;var r,i,o=angular.extend({},l,t);if(o.magickmangler=s.hostname.protocol+"://"+(s.magickmangler||s.hostname.cdn),e.match(/^\/?(cl-ugc|ugc|gallery|profile)/)?(e=(e=(e=(e=e.replace(/\/?cl-ugc-west-2\//,"")).replace(/\/?ugc\/gallery\//,"gallery/")).replace(/\/?ugc\/profile-image\//,"profile-image/")).replace(/\/?ugc\/profile-background\//,"profile-background/"),e=s.hostname.protocol+"://"+s.cdn.ugc+"/"+e):e.match(/^\/?(cl-agc|agc)/)?e=s.hostname.protocol+"://"+s.cdn.agc+"/"+e:e.match(/^\/?(keyframes)/)&&(e=e.replace(/\/?keyframes\//,""),e=s.hostname.protocol+"://"+s.cdn.keyframes+"/"+e),o.raw)return e;o.url=encodeURIComponent(e),!o.fullWidth&&a.innerWidth&&(o.customSize&&f[o.customSize]?(r=480,angular.forEach(d,function(e,t,n){0!==t&&a.innerWidth<=e&&a.innerWidth>n[t-1]&&(r=e)}),o.width=f[o.customSize][r]):o.breakpointConfig&&o.breakpointConfig[u]?(i=o.breakpointConfig[u],n=Object.keys(i),angular.forEach(n,function(e){o[e]=i[e]})):angular.forEach(d,function(e){var t=Math.round(e*c);a.innerWidth<=e&&o.width>t&&(o.width=t)})),o.src=[o.magickmangler,o.method,o.url,o.width],!o.height&&0!==o.height||o.src.push(o.height);t=o.src.join("/");return t=o.quality?t+"?q="+o.quality.toString():t}}];var l={method:"fit",width:50},d=[480,768,992,1200,1500,2e3,2560,3840],f={catalog:{480:432,768:441,992:200,1200:263,1500:353,2e3:372,2560:325,3840:500}}},{}],200:[function(e,t,n){"use strict";t.exports=[function(){return function(e,t){t.push(e);t=t.reduce(function(e,t){return Math.max(e,t)});return"number"!=typeof t||isNaN(t)?e:t}}]},{}],201:[function(e,t,n){"use strict";var r=e("crypto");t.exports=["$filter",function(e){return function(e){var t=r.createHash("md5");return t.update(e),t.digest("hex")}}]},{crypto:1106}],202:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=["$sce",function(t){return function(e){return e&&("string"==typeof e?e=e.replace(/<a /g,'<a rel="nofollow" '):"object"===(void 0===e?"undefined":r(e))&&e.constructor&&"TrustedValueHolderType"===e.constructor.name&&(e=t.trustAsHtml(t.getTrustedHtml(e).replace(/<a /g,'<a rel="nofollow" ')))),e}}]},{}],203:[function(e,t,n){"use strict";t.exports=function(){return function(e){return 1<(""+e).length?e:"0"+e}}},{}],204:[function(e,t,n){"use strict";t.exports=function(){return function(e,t,n,r){if(t<2)return e;t="s";return(n||r)&&(t=n?"es":"ies",e=r?e.slice(0,e.length-1):e),e+t}}},{}],205:[function(e,t,n){"use strict";t.exports=[function(){return function(e){if(null!=e&&""!==e)return angular.isFunction(e.toLocaleString)?e.toLocaleString():e}}]},{}],206:[function(e,t,n){"use strict";t.exports=["$rootScope","TimezoneService",function(t,n){return function(e){return e=e||t.user.get("timezone"),n.zoneNames[e]||e}}]},{}],207:[function(e,t,n){"use strict";t.exports=["$rootScope",function(c){return function(e,t,n,r,i,o){if(t=t||"Creativelive Student",!e)return t;if(r&&e._id===c.user.get("_id"))return"you";var r=e.profile&&e.profile.first_name||e.first_name,a=e.profile&&e.profile.last_name||e.last_name,s=e.profile&&e.profile.display_name||e.display_name;if(o)return o=[],r&&o.push(r),a&&o.push(a),o.join(" ");if(i&&r)return r;if(s&&!s.match(/^user|^fbuser/gi))return s;if(r)return r;if(!1!==n){a=e.slug||e.user&&e.user.slug;if(a)return a}return t}}]},{}],208:[function(e,t,n){"use strict";t.exports=function(){return function(e){return e=e&&"string"==typeof e?e.replace(/\[BLANK]/g,"____"):e}}},{}],209:[function(e,t,n){"use strict";t.exports=[function(){return function(e,t){if(!e)return"";if(e.indexOf("/")<0)return t+e;e=e.split("//");return 1<(e=((1<e.length?e[1]:e[0])||"").split("/")).length?t+e[1]:""}}]},{}],210:[function(e,t,n){"use strict";t.exports=["$filter",function(o){return function(e,t,n){var r=e%3600%60,r=n?""+r:o("pad")(r),i=Math.floor(e%3600/60),i=n?""+i:o("pad")(i),n=Math.floor(e/3600);return"microformat"===t?"T"+(n=n?n+"H":"")+i+"M"+r+"S":"secondless"===t?(n=n?n+"h ":"")+i+"m":""+(n=n?n+":":"")+i+":"+r}}]},{}],211:[function(e,t,n){"use strict";t.exports=["Slug",function(t){return function(e){return t.slugify(e||"")}}]},{}],212:[function(e,t,n){"use strict";t.exports=["$filter",function(t){return function(e){return"string"==typeof e?t("titleCase")(e.split("_").join(" ")):e}}]},{}],213:[function(e,t,n){"use strict";t.exports=[function(){return function(e){return e?parseInt(e,10):0}}]},{}],214:[function(e,t,n){"use strict";var r=e("striptags");t.exports=["$filter",function(e){return function(e){return r(e).replace(/&#39;/g,"'")}}]},{striptags:64}],215:[function(e,t,n){"use strict";var r=e("moment");t.exports=["$filter",function(e){return function(e,t){return r.unix(e).fromNow()}}]},{moment:void 0}],216:[function(e,t,n){"use strict";t.exports=function(){return function(e){return"string"==typeof e?e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "):e}}},{}],217:[function(e,t,n){"use strict";var c=e("moment");t.exports=["$filter",function(s){return function(e,t,n,r,i){i=i||"day";var o,a=s("date")(1e3*e,n);return t&&(e=c.unix(e),o=c.unix(t),e.isSame(o,i)||(a=(a+=r||"-")+s("date")(1e3*t,n))),a}}]},{moment:void 0}],218:[function(e,t,n){"use strict";var o=e("underscore");function i(e,t){var n,r=[],i={};return o.each(e,function(e){n=t?e[t]:JSON.stringify(e),i[n]||(i[n]=!0,r.push(e))}),r}t.exports=function(){return function(e,t,n){return o.isArray(e)?(r=!0,o.each(e,function(e){r=r&&o.isObject(e)&&!o.isArray(e)&&!o.isFunction(e)}),r?n?i(e,t):i(e.reverse(),t).reverse():o.uniq(e)):e;var r}}},{underscore:void 0}],219:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter","moment",function(e,i,o){var a=e.user.get("timezone")||"America/Los_Angeles";return function(e,t,n,r){return e?("days"===(e="quarterly"===(e="monthly"===(e="yearly"===(e="now"===e?Math.round(new Date/1e3):e)?o().add(1,"year").unix():e)?o().add(1,"month").unix():e)?o().add(3,"month").unix():e)&&(e=o().add(r,"day").unix()),n?o.unix(e).tz(a).format(t):i("date")(1e3*e,t)):""}}]},{}],220:[function(e,t,n){"use strict";var r=e("underscore"),i=e("deepval"),o=e("@creativelive/vault.js"),a=e("moment"),s=e("cache-stack"),c=(e("./vendor/slick.js"),e("./vendor/moment-timezone.js"),angular.module("cl-angular",["ui.bootstrap","ngCookies","ngResource","ngRoute","ngWebSocket","ngSanitize","ngFileUpload","slugifier","monospaced.elastic","qsServices","duScroll","dibari.angular-ellipsis","tableSort",angularDragula(angular)]));r.mixin({deepOmit:function(e,n){"string"==typeof n&&(n=n.split(" "));var t=!0;return r.isArray(e)||(t=!(e=[e])),r.each(e,function(t,e){r.each(n,function(e){i.del(t,e)})}),t?e:e[0]}}),c.value("Responses",e("./data/responses")),c.value("Vault",o),c.value("moment",a),c.value("_",r),c.value("deepval",i),c.value("cacheStack",s),c.filter("max",e("./filters/maxNumber")),c.filter("bytes",e("./filters/bytes")),c.filter("pluralize",e("./filters/pluralize")),c.filter("centsToDollars",e("./filters/centsToDollars")),c.filter("duration",e("./filters/duration")),c.filter("magick",e("./filters/magick")),c.filter("hasImage",e("./filters/hasImage")),c.filter("md5",e("./filters/md5")),c.filter("pad",e("./filters/pad")),c.filter("secondsToHours",e("./filters/secondsToHours")),c.filter("twoDateSplit",e("./filters/twoDateSplit")),c.filter("unixDate",e("./filters/unixDate")),c.filter("stripHtml",e("./filters/stripHtml")),c.filter("timeAgo",e("./filters/timeAgo")),c.filter("titleCase",e("./filters/titleCase")),c.filter("friendlyNumber",e("./filters/friendlyNumber")),c.filter("prettyUsername",e("./filters/prettyUsername")),c.filter("prettyTimezone",e("./filters/prettyTimezone")),c.filter("prettyNumber",e("./filters/prettyNumber")),c.filter("addQueryParams",e("./filters/addQueryParams")),c.filter("i18n",e("./filters/i18n")),c.filter("linkToSource",e("./filters/linkToSource")),c.filter("linkToLesson",e("./filters/linkToLesson")),c.filter("linkToProduct",e("./filters/linkToProduct")),c.filter("filenameFromPath",e("./filters/filenameFromPath")),c.filter("capitalize",e("./filters/capitalize")),c.filter("chunk",e("./filters/chunk")),c.filter("stringToInt",e("./filters/stringToInt")),c.filter("slugify",e("./filters/slugify")),c.filter("add",e("./filters/add")),c.filter("unique",e("./filters/unique")),c.filter("encode",e("./filters/encode")),c.filter("groupBy",e("./filters/groupBy")),c.filter("snakeToTitleCase",e("./filters/snakeToTitleCase")),c.filter("noFollowLinks",e("./filters/noFollowLinks")),c.filter("resolveSocialUrl",e("./filters/resolveSocialUrl")),c.filter("replaceBlank",e("./filters/replaceBlank")),c.factory("api",e("./data/api")),c.factory("mcpConfig",e("./data/mcpConfig")),c.factory("cacheClear",e("./data/cacheClear")),c.factory("responseUtils",e("./utils/services/responseUtils")),c.factory("promiseUtils",e("./utils/services/promiseUtils")),c.factory("apiConfig",e("./data/config")),c.factory("authResource",e("./data/auth")),c.factory("counterResource",e("./data/counter")),c.factory("i18nResource",e("./data/i18n")),c.factory("categoryResource",e("./data/category")),c.factory("ecommerceResource",e("./data/ecommerce")),c.factory("fileResource",e("./data/file")),c.factory("galleryResource",e("./data/gallery")),c.factory("partnerResource",e("./data/partner")),c.factory("channelResource",e("./data/channel")),c.factory("scheduleResource",e("./data/schedule")),c.factory("subTopicResource",e("./data/subtopic")),c.factory("tagResource",e("./data/tag")),c.factory("discountResource",e("./data/discount")),c.factory("couponResource",e("./data/coupon")),c.factory("reviewResource",e("./data/review/resource")),c.factory("ReviewService",e("./data/review/service")),c.factory("RecommendationsService",e("./data/recommendations/service")),c.factory("AnalyticsService",e("./data/analytics/service")),c.factory("BannerService",e("./data/banner/service")),c.factory("bannerResource",e("./data/banner/resource")),c.factory("CourseService",e("./data/course/service")),c.factory("courseResource",e("./data/course/resource")),c.factory("ClassUrlGenerator",e("./data/classUrlGenerator/service")),c.factory("playlistResource",e("./data/playlist/resource")),c.service("PlaylistService",e("./data/playlist/service")),c.factory("bundleResource",e("./data/bundle/resource")),c.service("BundleService",e("./data/bundle/service")),c.factory("clDiscountResource",e("./data/discount/discount-resource")),c.service("DiscountService",e("./data/discount/discount-service")),c.factory("GlobalModuleResource",e("./data/globalModule/resource")),c.service("GlobalModuleService",e("./data/globalModule/service")),c.factory("productResource",e("./data/product/resource")),c.service("ProductService",e("./data/product/service")),c.service("ReferralService",e("./data/referral/service")),c.factory("referralResource",e("./data/referral/resource")),c.factory("ScoresService",e("./data/scores/service")),c.factory("ScoresResource",e("./data/scores/resource")),c.service("segmentService",e("./data/segment/service")),c.factory("videoPlayerFactory",e("./data/videoPlayer/service")),c.factory("catalogResource",e("./data/catalog/resource")),c.factory("CatalogService",e("./data/catalog/service")),c.factory("CatalogExporter",e("./data/catalog/exporter")),c.factory("lessonResource",e("./data/lesson/resource")),c.factory("mediaResource",e("./data/media/resource")),c.factory("MediaService",e("./data/media/service")),c.factory("topicResource",e("./data/topic/resource")),c.factory("TopicService",e("./data/topic/service")),c.factory("TierResource",e("./data/tiers/resource")),c.factory("TierService",e("./data/tiers/service")),c.factory("UserResource",e("./data/user/resource")),c.service("UserAuthService",e("./data/user/auth")),c.service("UserService",e("./data/user/service")),c.service("UserDateService",e("./data/user/dateService")),c.service("UserSubscriptionService",e("./data/user/subscriptionService")),c.service("UserIntent",e("./data/user/intentService")),c.service("UserProfileService",e("./data/user/profileService")),c.service("StudentService",e("./data/student/service")),c.factory("EventService",e("./data/event/service")),c.factory("eventResource",e("./data/event/resource")),c.service("broadcastService",e("./data/event/broadcastService")),c.provider("httpAuthIntercept",e("./data/session/httpAuthIntercept")),c.service("gangesSessionService",e("./data/session/gangesSessionService")),c.service("mcpSessionService",e("./data/session/mcpSessionService")),c.factory("BlogResource",e("./data/blog/resource")),c.service("BlogService",e("./data/blog/service")),c.factory("StatsResource",e("./data/stats/resource")),c.service("StatsService",e("./data/stats/service")),c.factory("PipelineResource",e("./data/pipeline/resource")),c.service("PipelineService",e("./data/pipeline/service")),c.factory("PageResource",e("./data/page/resource")),c.service("PageService",e("./data/page/service")),c.factory("topicResource",e("./data/topic/resource")),c.service("topicService",e("./data/topic/service")),c.factory("taxonomyResource",e("./data/taxonomy/resource")),c.service("TaxonomyService",e("./data/taxonomy/service")),c.factory("ChannelTopicResource",e("./data/channelTopic/resource")),c.factory("ChannelTopicService",e("./data/channelTopic/service")),c.factory("InstructorResource",e("./data/instructors/resource")),c.factory("instructorResource",e("./data/instructors/resource")),c.factory("InstructorService",e("./data/instructors/service")),c.factory("CartResource",e("./data/cart/resource")),c.factory("CartService",e("./data/cart/service")),c.factory("GiftService",e("./data/gift/service")),c.factory("SubscriptionResource",e("./data/subscription/subscriptionResource")),c.service("SubscriptionService",e("./data/subscription/subscriptionService")),c.factory("SubscriptionCache",e("./data/subscription/subscriptionCache")),c.factory("SubscriptionPlanResource",e("./data/subscriptionPlan/subscriptionPlanResource")),c.service("SubscriptionPlanService",e("./data/subscriptionPlan/subscriptionPlanService")),c.factory("EnterpriseResource",e("./data/enterprise/enterpriseResource")),c.factory("EnterpriseService",e("./data/enterprise/enterpriseService")),c.factory("EnterpriseCache",e("./data/enterprise/enterpriseCache")),c.factory("SavedSearchResource",e("./data/savedSearch/savedSearchResource")),c.factory("SavedSearchService",e("./data/savedSearch/savedSearchService")),c.factory("ScheduledEmailResource",e("./data/scheduledEmail/scheduledEmailResource")),c.factory("ScheduledEmailService",e("./data/scheduledEmail/scheduledEmailService")),c.factory("FacebookResource",e("./data/facebook/resource")),c.factory("FacebookService",e("./data/facebook/service")),c.factory("IntegrationsResource",e("./data/integrations/integrationsResource")),c.service("IntegrationsService",e("./data/integrations/integrationsService")),c.factory("UsageTrackingResource",e("./data/usageTracking/usageTrackingResource")),c.factory("UsageTrackingService",e("./data/usageTracking/usageTrackingService")),c.factory("googleResource",e("./data/google/resource")),c.service("GoogleService",e("./data/google/service")),c.factory("ProductViewHistoryService",e("./data/productViewhistory/service")),c.factory("clTagResource",e("./data/tag/tagResource")),c.service("clTagService",e("./data/tag/tagService")),c.factory("TargetResource",e("./data/target/targetResource")),c.service("TargetService",e("./data/target/targetService")),c.service("SAMLSSOService",e("./data/samlSso")),c.factory("focus",e("./utils/services/focus")),c.factory("keyboard",e("./utils/services/keyboardService")),c.factory("DataSet",e("./utils/services/dataSet")),c.factory("TransitionalHeight",e("./utils/services/transitionalHeight")),c.service("arrayMove",e("./utils/services/arrayMove")),c.service("parseQS",e("./utils/services/parseQs")),c.service("parseTransclusions",e("./utils/services/parseTransclusions")),c.service("flowControl",e("./utils/services/flowControl")),c.service("DuplicateService",e("./utils/services/duplicateService")),c.service("urlify",e("./utils/services/urlify")),c.service("locationChanger",e("./utils/services/locationChanger")),c.service("ChatService",e("./data/chat/service")),c.service("inViewDirector",e("./utils/services/inViewDirector")),c.service("ContentAccessService",e("./utils/services/contentAccess")),c.service("getUserId",e("./utils/services/getUserId")),c.service("ScrollSpy",e("./utils/services/scrollSpy")),c.service("Timer",e("./utils/services/timer")),c.service("TimezoneService",e("./utils/services/timezone")),c.service("Viewport",e("./utils/services/viewport")),c.service("uuid",e("./utils/services/uuid")),c.service("optimizelyUtils",e("./utils/services/optimizelyUtils")),c.service("urlUtils",e("./utils/services/urlUtils")),c.service("BusinessEmailService",e("./utils/services/businessEmail")),c.service("LockBody",e("./utils/services/lockBody")),c.service("ugcImagePath",e("./utils/services/ugcImagePath")),c.service("CaptchaService",e("./utils/services/captcha")),c.controller("isolateScope",e("./utils/services/isolateScope")),c.directive("clReadFile",e("./utils/directives/readFile")),c.directive("autoFocus",e("./utils/directives/autoFocus")),c.directive("clDocumentTitle",e("./utils/directives/documentTitle")),c.directive("clVia",e("./utils/directives/clVia")),c.directive("compile",e("./utils/directives/compile")),c.directive("contactForm",e("./utils/directives/contactForm")),c.directive("eventFocus",e("./utils/directives/eventFocus")),c.directive("fillViewport",e("./utils/directives/fillViewport")),c.directive("homepageLoad",e("./utils/directives/homepageLoad")),c.directive("featureToggle",e("./utils/directives/featureToggle")),c.directive("loginRequired",e("./utils/directives/loginRequired")),c.directive("verificationRequired",e("./utils/directives/verificationRequired")),c.directive("popup",e("./utils/directives/popup")),c.directive("presence",e("./utils/directives/presence")),c.directive("ngClickable",e("./utils/directives/ngClickable")),c.directive("ngVisible",e("./utils/directives/ngVisible")),c.directive("clSetFocus",e("./utils/directives/setFocus")),c.directive("clScrollSpy",e("./utils/directives/scrollSpy")),c.directive("clScrollSpyTarget",e("./utils/directives/scrollSpyTarget")),c.directive("clLazyLoad",e("./utils/directives/lazyLoad")),c.directive("clBackgroundImage",e("./utils/directives/backgroundImage")),c.directive("clTheme",e("./utils/directives/theme")),c.directive("clTimer",e("./utils/directives/timer")),c.directive("clLazyLoadDirective",e("./utils/directives/lazyLoadDirective")),c.directive("clBusinessEmail",e("./utils/directives/businessEmail")),c.directive("clTouchIfValue",e("./utils/directives/touchIfValue")),c.directive("typewriter",e("./utils/directives/typewriter")),c.directive("vaultProvider",e("./utils/directives/vaultProvider")),c.directive("checkOverflow",e("./utils/directives/checkOverflow")),c.directive("details",e("./utils/directives/clDetails")),c.provider("httpBffIntercept",e("./utils/providers/httpBffIntercept")),c.provider("httpTemplateIntercept",e("./utils/providers/httpTemplateIntercept")),c.config(["$httpProvider","$provide",function(e,t){e.interceptors.push("apiConfig"),t.decorator("$exceptionHandler",["$delegate",function(n){return function(e,t){try{newrelic.noticeError(e)}catch(e){}n(e,t)}}]),t.decorator("$timeout",["$delegate",function(r){function e(e,t,n){return 2147483647<t?(Math.round(100*(t/864e5)),!1):r(e,t,n)}return angular.extend(e,r),e}])}])},{"./data/analytics/service":71,"./data/api":72,"./data/auth":73,"./data/banner/resource":74,"./data/banner/service":75,"./data/blog/resource":76,"./data/blog/service":77,"./data/bundle/resource":78,"./data/bundle/service":79,"./data/cacheClear":80,"./data/cart/resource":81,"./data/cart/service":82,"./data/catalog/exporter":83,"./data/catalog/resource":84,"./data/catalog/service":85,"./data/category":86,"./data/channel":87,"./data/channelTopic/resource":88,"./data/channelTopic/service":89,"./data/chat/service":90,"./data/classUrlGenerator/service":91,"./data/config":92,"./data/counter":93,"./data/coupon":94,"./data/course/resource":95,"./data/course/service":96,"./data/discount":97,"./data/discount/discount-resource":98,"./data/discount/discount-service":99,"./data/ecommerce":100,"./data/enterprise/enterpriseCache":101,"./data/enterprise/enterpriseResource":102,"./data/enterprise/enterpriseService":103,"./data/event/broadcastService":104,"./data/event/resource":105,"./data/event/service":106,"./data/facebook/resource":107,"./data/facebook/service":108,"./data/file":109,"./data/gallery":110,"./data/gift/service":111,"./data/globalModule/resource":112,"./data/globalModule/service":113,"./data/google/resource":114,"./data/google/service":115,"./data/i18n":116,"./data/instructors/resource":117,"./data/instructors/service":118,"./data/integrations/integrationsResource":119,"./data/integrations/integrationsService":120,"./data/lesson/resource":121,"./data/mcpConfig":122,"./data/media/resource":123,"./data/media/service":124,"./data/page/resource":125,"./data/page/service":126,"./data/partner":127,"./data/pipeline/resource":128,"./data/pipeline/service":129,"./data/playlist/resource":130,"./data/playlist/service":131,"./data/product/resource":132,"./data/product/service":133,"./data/productViewhistory/service":134,"./data/recommendations/service":135,"./data/referral/resource":136,"./data/referral/service":137,"./data/responses":138,"./data/review/resource":139,"./data/review/service":140,"./data/samlSso":141,"./data/savedSearch/savedSearchResource":142,"./data/savedSearch/savedSearchService":143,"./data/schedule":144,"./data/scheduledEmail/scheduledEmailResource":145,"./data/scheduledEmail/scheduledEmailService":146,"./data/scores/resource":147,"./data/scores/service":148,"./data/segment/service":149,"./data/session/gangesSessionService":150,"./data/session/httpAuthIntercept":151,"./data/session/mcpSessionService":152,"./data/stats/resource":153,"./data/stats/service":154,"./data/student/service":155,"./data/subscription/subscriptionCache":156,"./data/subscription/subscriptionResource":157,"./data/subscription/subscriptionService":158,"./data/subscriptionPlan/subscriptionPlanResource":159,"./data/subscriptionPlan/subscriptionPlanService":160,"./data/subtopic":161,"./data/tag":162,"./data/tag/tagResource":163,"./data/tag/tagService":164,"./data/target/targetResource":165,"./data/target/targetService":166,"./data/taxonomy/resource":167,"./data/taxonomy/service":168,"./data/tiers/resource":169,"./data/tiers/service":170,"./data/topic/resource":171,"./data/topic/service":172,"./data/usageTracking/usageTrackingResource":173,"./data/usageTracking/usageTrackingService":174,"./data/user/auth":175,"./data/user/dateService":176,"./data/user/intentService":177,"./data/user/profileService":178,"./data/user/resource":179,"./data/user/service":180,"./data/user/subscriptionService":181,"./data/videoPlayer/service":182,"./filters/add":183,"./filters/addQueryParams":184,"./filters/bytes":185,"./filters/capitalize":186,"./filters/centsToDollars":187,"./filters/chunk":188,"./filters/duration":189,"./filters/encode":190,"./filters/filenameFromPath":191,"./filters/friendlyNumber":192,"./filters/groupBy":193,"./filters/hasImage":194,"./filters/i18n":195,"./filters/linkToLesson":196,"./filters/linkToProduct":197,"./filters/linkToSource":198,"./filters/magick":199,"./filters/maxNumber":200,"./filters/md5":201,"./filters/noFollowLinks":202,"./filters/pad":203,"./filters/pluralize":204,"./filters/prettyNumber":205,"./filters/prettyTimezone":206,"./filters/prettyUsername":207,"./filters/replaceBlank":208,"./filters/resolveSocialUrl":209,"./filters/secondsToHours":210,"./filters/slugify":211,"./filters/snakeToTitleCase":212,"./filters/stringToInt":213,"./filters/stripHtml":214,"./filters/timeAgo":215,"./filters/titleCase":216,"./filters/twoDateSplit":217,"./filters/unique":218,"./filters/unixDate":219,"./utils/directives/autoFocus":221,"./utils/directives/backgroundImage":222,"./utils/directives/businessEmail":223,"./utils/directives/checkOverflow":224,"./utils/directives/clDetails":225,"./utils/directives/clVia":226,"./utils/directives/compile":227,"./utils/directives/contactForm":228,"./utils/directives/documentTitle":229,"./utils/directives/eventFocus":230,"./utils/directives/featureToggle":231,"./utils/directives/fillViewport":232,"./utils/directives/homepageLoad":233,"./utils/directives/lazyLoad":234,"./utils/directives/lazyLoadDirective":235,"./utils/directives/loginRequired":236,"./utils/directives/ngClickable":237,"./utils/directives/ngVisible":238,"./utils/directives/popup":239,"./utils/directives/presence":240,"./utils/directives/readFile":241,"./utils/directives/scrollSpy":242,"./utils/directives/scrollSpyTarget":243,"./utils/directives/setFocus":244,"./utils/directives/theme":245,"./utils/directives/timer":246,"./utils/directives/touchIfValue":247,"./utils/directives/typewriter":248,"./utils/directives/vaultProvider":249,"./utils/directives/verificationRequired":250,"./utils/providers/httpBffIntercept":251,"./utils/providers/httpTemplateIntercept":252,"./utils/services/arrayMove":253,"./utils/services/businessEmail":254,"./utils/services/captcha":255,"./utils/services/contentAccess":256,"./utils/services/dataSet":257,"./utils/services/duplicateService":258,"./utils/services/flowControl":259,"./utils/services/focus":260,"./utils/services/getUserId":261,"./utils/services/inViewDirector":262,"./utils/services/isolateScope":263,"./utils/services/keyboardService":264,"./utils/services/locationChanger":265,"./utils/services/lockBody":266,"./utils/services/optimizelyUtils":267,"./utils/services/parseQs":268,"./utils/services/parseTransclusions":269,"./utils/services/promiseUtils":270,"./utils/services/responseUtils":271,"./utils/services/scrollSpy":272,"./utils/services/timer":273,"./utils/services/timezone":274,"./utils/services/transitionalHeight":275,"./utils/services/ugcImagePath":276,"./utils/services/urlUtils":277,"./utils/services/urlify":278,"./utils/services/uuid":279,"./utils/services/viewport":280,"./vendor/moment-timezone.js":1,"./vendor/slick.js":2,"@creativelive/vault.js":6,"cache-stack":32,deepval:38,moment:void 0,underscore:void 0}],221:[function(e,t,n){"use strict";t.exports=["$timeout",function(n){return{restrict:"A",link:function(e,t){n(function(){t[0].focus()})}}}]},{}],222:[function(e,t,n){"use strict";var p=e("blueimp-load-image");t.exports=["$filter","$rootScope","$timeout","clUploadService",function(u,l,d,f){return{restrict:"A",scope:{image:"=?clBackgroundImage",options:"=?clBackgroundOptions",allowUpload:"@"},link:function(n,r,i){var e,t="true"===i.clBackgroundWatch,o=n.$watch("image",c),a=n.options||{width:1600},s=(c(),i.$observe("allowUpload",function(){var e,t;i.allowUpload&&"false"!==i.allowUpload&&(e='<input type="file" accept="{{ fileType }}" style="visibility:hidden;display:none">',r.append(e),t=$(e),r.bind("click",function(e){e.preventDefault(),e.stopPropagation(),"file"!==angular.element(e.target).attr("type")&&t.trigger("click")}),t.on("change",function(e){e&&e.target&&e.target.files&&(e=e.target.files[0],r.addClass("loading"),!e||e.size>f.MAX_SIZE?d(function(){r.removeClass("loading"),r.addClass("error"),d(function(){r.removeClass("error")},2e3)},2e3):p(e,function(e){e=e.toDataURL("image/jpeg");r.css("background-image",'url("'+e+'")'),n.$digest(),f.upload({dataURL:e,type:i.allowUpload},function(e,t){t=t||{},r.removeClass("loading"),e||!t.success?c():(r.addClass("done"),e=i.allowUpload,t=t.data,l.user.valid()&&"profile"===e&&(l.user._data.profile.image=t.image),n.image||(n.image=t.image,c()),d(function(){r.removeClass("done")},2e3))},function(e){n.progress=e})},{orientation:!0,canvas:!0}))}),s())}));function c(){n.image?("string"==typeof n.image&&(n.image=n.image.replace(/^'|'$/g,"")),(e=u("magick")(n.image,a))&&r.css("background-image",'url("'+e+'")'),t||o()):r.css("background-image",!1)}}}}]},{"blueimp-load-image":22}],223:[function(e,t,n){"use strict";t.exports=["BusinessEmailService",function(i){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){var t=i.validate(e);if(void 0!==t)return r.$setValidity("businessEmail",t),t?e:void 0}),r.$formatters.unshift(function(e){return r.$setValidity("businessEmail",i.validate(e)),e})}}}]},{}],224:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"A",link:function(t,n,e){var r=e.height?parseInt(e.height):null,i=!1;t.$watch(function(){return n[0].scrollHeight},function(e){e&&(t.heightOverflowed=!!r&&n[0].scrollHeight>r,t.heightOverflowed&&!i&&(n.addClass("height-overflowed"),i=!0),!t.heightOverflowed&&i&&(n.removeClass("height-overflowed"),i=!1))})}}}},{}],225:[function(e,t,n){"use strict";function r(i,o){return{restrict:"E",link:function(e,t){var n=-1!==i.context.uaString.indexOf("Trident/"),r=-1!==i.context.uaString.indexOf("Edge/");t.find("summary").click(function(e){e.stopPropagation(),t[0].hasAttribute("open")&&o.scrollTo(t,120),(n||r)&&(t[0].hasAttribute("open")?t[0].removeAttribute("open"):t[0].setAttribute("open",""))})}}}r.$inject=["rind","$document"],t.exports=r},{}],226:[function(e,t,n){"use strict";var i=e("underscore");t.exports=["$filter","$timeout","AnalyticsService",function(c,r,u){return{restrict:"A",link:function(e,o,t){var a=t.clModule,n=t.clModuleId,s=t.clFreeformName;1===o[0].nodeType&&a&&(t=i.debounce(function(e){var r,i,t=o[0].querySelectorAll("a"),n=o[0].querySelectorAll("form");r=u.getViaProperty(a,e,s),i={via:r},angular.forEach(t,function(e){var t,n,r;e.getAttribute&&null!==e.getAttribute("no-cl-via")||(t=e.href,n=c("addQueryParams")(e.href,i),r=t.match(/\A?via=[^&]+&*/g),t===n||r||(e.href=n))}),angular.forEach(n,function(e){var t,n=e.querySelector("input.via");n?(t=n.getAttribute("value"),r!==t&&n.setAttribute("value",r)):angular.element(e).append('<input type="hidden" name="via" class="via" value="'+r+'">')})},300),a=a.replace(/\-cms$/,""),u.registerModule(n,a,o,t),e.$watch(i.debounce(function(){r(function(){u.refreshModule(n)})},300)))}}}]},{underscore:void 0}],227:[function(e,t,n){"use strict";t.exports=["$compile",function(o){return function(t,n,r){var i=t.$watch(function(e){return e.$eval(r.compile)},function(e){n.html(e),o(n.contents())(t),i()})}}]},{}],228:[function(e,t,n){"use strict";t.exports=["$http",function(i){return{restrict:"A",link:function(t,r,e){r.bind("submit",function(){var n={url:window.location.pathname},e=r[0].querySelectorAll("input, select, textarea");angular.forEach(e,function(e){var t=e.getAttribute("ng-model");e.getAttributeNode("type")&&"checkbox"===e.getAttributeNode("type").value&&t?n[t]=e.checked:t&&(n[t]=e.value)}),i.post("/bff/email",n).then(function(){t.sendSuccess=!0},function(e){t.sendError=e})})}}}]},{}],229:[function(e,t,n){"use strict";t.exports=["$document",function(r){return{restrict:"A",link:function(e,t,n){r[0].title=[n.clTitlePrefix||"",n.clDocumentTitle,n.clTitleSuffix||""].join("")}}}]},{}],230:[function(e,t,n){"use strict";t.exports=["focus",function(r){return function(e,t,n){t.on(n.eventFocus,function(e){r(n.eventFocusId,e)}),e.$on("$destroy",function(){t.off(n.eventFocus)})}}]},{}],231:[function(e,t,n){"use strict";function r(i,o,e,t){return{priority:300,restrict:"A",compile:function(e,t){return{post:function(e,n,r){function t(e){o.each(e,function(e,t){r.feature!==t||e||("remove_padding"===r.feature?n&&n[0]&&n[0].classList&&o.each(n[0].classList,function(e){e&&-1!==e.indexOf("padding")&&n[0].classList.remove(e)}):n.remove())})}i.user.valid()&&i.user.getMySettingsOptions().then(function(e){e&&(e.site&&t(e.site),e.course&&t(e.course))})}}}}}r.$inject=["$rootScope","_","$window","UserService"],t.exports=r},{}],232:[function(e,t,n){"use strict";t.exports=["$window","$document",function(i,o){return{restrict:"AE",replace:!0,scope:{},link:function(e,t,n){e.minHeight=n.minHeight&&parseInt(n.minHeight)||300;try{var r=Math.max(o[0].documentElement.clientHeight,i.innerHeight||0)-t[0].offsetTop+1;r>e.minHeight&&t.css("height",r+"px")}catch(e){}}}}]},{}],233:[function(e,t,n){"use strict";function r(i){return{priority:300,restrict:"A",compile:function(e,t){return{post:function(e,t,n){var r;i.homepageSet||(t[0].style.display="none"),r=i.$watch("homepageSet",function(e){e&&(t[0].style.display="block"),r()})}}}}}r.$inject=["$rootScope"],t.exports=["$rootScope",r]},{}],234:[function(e,t,n){"use strict";t.exports=["inViewDirector","$filter",function(e,t){return{restrict:"A",scope:{src:"@lazyLoadSrc",bkg:"@lazyLoadBkg",bounds:"=lazyLoadBounds",debounce:"=lazyLoadDebounce",delay:"=lazyLoadDelay",done:"=lazyLoadDone",initDelay:"=lazyLoadInitDelay",reInit:"=lazyLoadReInit"},link:function(t,n){var r,i=[],o=e({debounce:t.debounce,bounds:t.bounds,deltaSpeed:t.deltaSpeed,deltaTimeout:t.deltaTimeout}),a=("boolean"==typeof t.initDelay?r=t.$watch("initDelay",function(e){e&&(s(),r())}):s(),t.$watch("reInit",function(e){e&&(s(),a())}));function s(){n.ready(function(){var e;t.src||t.bkg?(i.push(n[0]),o.track(n[0]).then(u,angular.noop,c)):((e=n[0].querySelectorAll("[lazy-load-src], [lazy-load-bkg]")).length&&Array.prototype.forEach.call(e,function(e){l(e,"transparent"),-1===i.indexOf(e)&&i.push(e)}),0<i.length&&o.track(i).then(u,angular.noop,c))})}function c(n){var r=n.getAttribute("src"),e=n.getAttribute("lazy-load-src"),t=n.getAttribute("lazy-load-bkg");n.addEventListener("error",function e(t){r&&n.setAttribute("src",r);n.removeEventListener("error",e,!1)},!1),n.addEventListener("load",function(e){l(n,"lazyLoaded"),function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}(n,"transparent")},!1),e?n.setAttribute("src",e):t&&(n.style.backgroundImage='url("'+t+'")')}function u(){angular.isFunction(t.done)&&t.done()}function l(e,t){e.classList?e.classList.add(t):e.className+=" "+t}t.$on("$$destroy",function(){o.destroy()})}}}]},{}],235:[function(e,t,n){"use strict";function r(c,u,l,d,f,p){return{priority:300,restrict:"A",compile:function(e,t){return{post:function(t,n,i){var o,a=!!(p&&p.context&&p.context.ua&&p.context.ua.mobile)&&f.screen.width<768,e=(u.$on("scroll:to:anchor",function(e,t){o=t}),c({deltaTimeout:0,bounds:300}));function r(e){var r;e===n[0]&&(a?i.mobileLoadOnInView?(t.moduleInView=!0,$(i.mobileTarget).off()):$(i.mobileTarget).on("show.bs.collapse",function(){t.moduleInView=!0,$(i.mobileTarget).off()}):(t.moduleInView=!0,i.providerReady&&(r=t.$watch(i.providerReady,function(e){e&&o&&d(function(){var e=o.target[0].getBoundingClientRect().top,t=(f.scrollTo(0,f.scrollY+e-175),o.element[0]);if(t&&1!==t.nodeType){for(;!t.hasAttribute("cl-scroll-spy-target")||!t.parentElement;)t=t.parentElement;var n="current-id-"+o.target.selector.slice(1),e=t.classList;l.each(e,function(e){e.includes("current-id")&&t.classList.replace(e,n)}),r()}else r()},200)}))))}function s(){e.destroy()}t.moduleInView=!1,n.ready(function(){e.track(n[0]).then(s,angular.noop,r)})}}}}}r.$inject=["inViewDirector","$rootScope","_","$timeout","$window","rind"],t.exports=r},{}],236:[function(e,t,n){"use strict";function r(s,c,e,u,t){return{restrict:"A",link:function(n,r,i){var o,a=!1;function e(){var e,t;a&&(e=s.user,t=rind.context.session||{},""===i.verificationRequired&&u.requireVerification(e,t)?(s.$broadcast("user:verify",{description:i.verificationRequiredDescription}),o=o||s.$on("user:verified",function(){o(),c(function(){if("false"!==i.clickAfterValid)try{r[0].click()}catch(e){r.click()}})})):c(function(){if("false"!==i.clickAfterValid)try{r[0].click()}catch(e){r.click()}}))}s.$on("user:login",e),s.$on("user:register",e),s.$on("user:logout",e),r.on("mousedown keydown touchstart click",function(e){var t;e&&"keydown"===e.type&&13!==e.keyCode||s.user.valid()||(e.preventDefault(),e.stopPropagation(),a=!0,i.contentId?Vault.Session.set("loginLessonAutoplay",i.contentId,{expires:"+5 minutes"}):Vault.Session.remove("loginLessonAutoplay"),e={buttonType:n.product?"buy":n.toggleFollow?"remind":void 0,courseName:(t=rind&&rind.dump&&rind.dump.course||{},n.entityName||t.short_title||t.title),meta:(t={},n.entity&&(n.entityId||n.entityIds)&&(t.entity=n.entity,t.entityIds=n.entityId?[n.entityId]:n.entityIds),t),cta_label:e.currentTarget&&e.currentTarget.innerText,regPrompt:(t=e).target&&t.target.dataset&&t.target.dataset.cta&&"rsvp"===t.target.dataset.cta?"rsvp":t.target&&t.target.dataset&&t.target.dataset.cta&&"follow"===t.target.dataset.cta?"follow":t.target&&t.target.dataset&&t.target.dataset.cta&&"save learning path"===t.target.dataset.cta?"save learning path":t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.cta&&"gift"===t.currentTarget.dataset.cta?"gift":t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.cta&&"log-in"===t.currentTarget.dataset.cta?"log in/sign up":t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.cta&&"save class"===t.currentTarget.dataset.cta?"save class":t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.cta&&"log in during watch limit"===t.currentTarget.dataset.cta?"log in during watch limit":t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.cta},s.$broadcast("login:show",{dest:i.dest,onboarding:"true"===i.onboarding,prompt:e.courseName?e.buttonType:"default",promptClass:e.courseName,meta:e.meta,cta_label:e.cta_label,via:i.via,configKey:i.cta,activationMode:"click",regPrompt:e.regPrompt,template:i.template||null}))})}}}r.$inject=["$rootScope","$timeout","$window","UserProfileService","$compile"],t.exports=r},{}],237:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{model:"=ngClickable"},link:function(e,t,n){e.$watch("model",function(e){e?t.css("pointer-events","auto").removeClass("disable-pointer"):t.css("pointer-events","none").addClass("disable-pointer")})}}}]},{}],238:[function(e,t,n){"use strict";t.exports=function(){return function(e,t,n){e.$watch(n.ngVisible,function(e){e?t.addClass("ng-visible"):t.removeClass("ng-visible")})}}},{}],239:[function(e,t,n){"use strict";var o=e("underscore");t.exports=["$window",function(i){return{restrict:"EA",scope:{},link:function(t,e,n){try{t.config=n.popup?JSON.parse(n.popup):{}}catch(e){t.config={}}var r=[];t.config.width||(t.config.width=640),t.config.height||(t.config.height=480),t.config.top||(t.config.top=i.screen.height/2-t.config.height/2),t.config.left||(t.config.left=i.screen.width/2-t.config.width/2),o.each(t.config,function(e,t){r.push(t+"="+e)}),e.on("click",function(e){e.preventDefault(),i.open(n.href,"clpopup",r.join(","))})}}}]},{underscore:void 0}],240:[function(e,t,n){"use strict";function r(c,u){return{restrict:"EA",scope:{},link:function(e,t,n){var r,i,o,a,s=n.presenceTimes,n=n.presenceLabel;s&&n&&(0!==(r=s.split(",").map(function(e){return 1e3*Number(e)}).filter(function(e){return Number.isInteger(e)})).length&&(o=c(function e(){a.timePresent=r[i];u.presence(a);i++;if(i>=r.length)return;var t=r[i]-r[i-1];o=c(e,t,1)},r[i=0],1),a={timePresent:0,label:n},e.$on("$destroy",function(){o&&c.cancel(o)})))}}}r.$inject=["$interval","trackFactory"],t.exports=r},{}],241:[function(e,t,n){"use strict";t.exports=["$q","_",function(a,s){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){var i;function o(r){return a(function(t,n){var e=new FileReader;switch(e.onload=function(e){t(e.target.result)},e.onerror=function(e){n(e)},i){case"arrayBuffer":e.readAsArrayBuffer(r);break;case"binaryString":e.readAsBinaryString(r);break;case"dataURL":e.readAsDataURL(r);break;case"text":e.readAsText(r);break;default:throw new Error("Specified Read Type is not supported. SEE:  https://developer.mozilla.org/en-US/docs/Web/API/FileReader")}})}r&&"file"===n.type&&(i=n.readType||"text",t.bind("change",function(e){var t=e.target,e=Array.prototype.slice.call(t.files,0).map(o);a.all(e).then(function(e){e=e||[],r.$setViewValue(t.multiple?e:s.first(e))})}))}}}]},{}],242:[function(e,t,n){"use strict";t.exports=["ScrollSpy",function(i){return{restrict:"A",link:function(e,t,n){var r=n.clScrollSpyKey||"clScrollSpy";(e[r]=i).onResize(function(){angular.extend(e[r],i)})}}}]},{}],243:[function(e,t,n){"use strict";t.exports=["$timeout","ScrollSpy","_","trackFactory",function(s,c,u,l){return{restrict:"A",link:function(n,e,r){var i,t,o,a="";r.clScrollSpyTarget&&(t=r.clScrollSpyTarget.split(","),o=parseInt(r.clScrollSpyTargetThrottle||1e3,10),c.on(r.clScrollSpyTarget,u.throttle(function(){angular.forEach(t,function(e){c.setBounds(e)})},o)),"-1"!==r.clScrollSpyUnwatchAfterSeconds&&(o=1e3*parseInt(r.clScrollSpyUnwatchAfterSeconds||10),s(function(){c.off(r.clScrollSpyTarget)},o)),r.clScrollSpyTargetCurrent&&angular.forEach(t,function(t){c.on("clScrollSpyTarget-"+t,function(){var e;c.elementIsMainFocus(t,r.clScrollSpyOffset)&&(e=(e=t.replace("#","id-")).replace(".","class-"),n[r.clScrollSpyTargetCurrent]=e),s.cancel(i),i=s(function(){a!==n[r.clScrollSpyTargetCurrent]&&(n[r.clScrollSpyTargetCurrent]&&l.scrollToAnchor(n[r.clScrollSpyTargetCurrent]),a=n[r.clScrollSpyTargetCurrent])},300)})}))}}}]},{}],244:[function(e,t,n){"use strict";t.exports=["$parse",function(r){return{restrict:"A",link:function(e,t,n){e.$watch(function(){return r(n.clSetFocus)(e)},function(e){e&&t.focus()})}}}]},{}],245:[function(e,t,n){"use strict";t.exports=["$rootScope",function(r){return{restrict:"E",scope:{theme:"@"},link:function(e,t,n){r.headerTheme=e.theme,r.$applyAsync()}}}]},{}],246:[function(e,t,n){"use strict";t.exports=["$timeout",function(o){return{restrict:"AE",scope:{timerDuration:"@",onDone:"<",startTimer:"<",resetTimer:"<?",clearTimer:"<?",refresh:"<?"},transclude:!0,template:"<div ng-transclude></div>",link:function(t){var n,r=!1;function i(){t.timer--,0<t.timer?n=o(i,1e3):t.onDone()}t.$watch("startTimer",function(e){o.cancel(n),e&&(r=!0,t.timer=t.timerDuration,i())}),t.$watch("clearTimer",function(e){e&&(o.cancel(n),r=!1)}),t.$watch("refresh",function(e){e&&t.resetTimer&&r&&(t.timer=t.timerDuration,o.cancel(n),i())})}}}]},{}],247:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){r.$formatters.unshift(function(e){return e&&r.$setTouched(),e})}}}},{}],248:[function(e,t,n){"use strict";function r(m,n,g){return{restrict:"A",template:'<span ng-bind="render"></span>',replace:!0,link:function(d,r,e){var i,o=e.text.split(","),a=-1,s="in",c=1,u=0,l=parseInt(e.speed,10)||50,f=parseInt(e.waitWord,10)||1e3,p="true"===e.stop;function t(){var n=0;-1===a?m.each(o,function(e,t){e=h(e);n<e&&(n=e,a=t)}):n=h(o[a]),r.css("width",n)}function h(e){var t=r.clone(),e=(t.html(e),t.css("border-bottom","none"),t.css("width","auto"),r.parent().append(t[0]),t[0].offsetWidth);return t.remove(),e}r.css("display","inline-block"),r.css("background-image","url(https://downloads.creativelive.com/creator-pass/yellow-brush-stroke.png)"),r.css("background-size","contain"),r.css("background-repeat","no-repeat"),r.css("background-position","center"),r.css("text-align","center"),r.css("padding","0 5px"),r.css("margin-left","-5px"),n.addEventListener("resize",m.throttle(t,300),!1),t(),function e(){g.cancel(i);var t=o[u];var n=t.slice(0,c);d.render=n;if(p&&n===m.last(o))return;switch(!0){case"in"===s&&n===t:s="out",c--,i=g(e,f);break;case"in"===s&&n!==t:c++,i=g(e,l);break;case"out"===s&&1===c:++u>=o.length&&(u=0),s="in",i=g(e,l);break;case"out"===s&&0<c:c--,i=g(e,l)}}()}}}r.$inject=["_","$window","$timeout"],t.exports=r},{}],249:[function(e,t,n){"use strict";function r(a,e){return{restrict:"AE",replace:!0,link:function(e,t,n){var r=a.Local;switch(n.vaultMethod){case"Session":r=a.Session;break;case"Cookie":r=a.Cookie}function i(){"pageLoad"===n.vaultAction&&n.vaultKey&&n.vaultData&&r.set(n.vaultKey,n.vaultData)}var o=n.$observe("vaultData",function(){i(),o()});e.vaultData=r.get(n.vaultKey)||0,e.Vault=a,t.on(n.vaultAction,function(){e.vaultData++,r.set(n.vaultKey,e.vaultData)}),i()}}}r.$inject=["Vault","_"],t.exports=r},{}],250:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","UserProfileService",function(o,a,s){return{restrict:"A",link:function(e,t,n){var r=!1,i=o.user;o.$on("user:verified",function(){var e=rind.context.session||{};e&&s.setEmailVerified(e);r&&a(function(){try{t[0].click()}catch(e){t.click()}})}),t.on("mousedown keydown touchstart",function(e){var t=rind.context.session||{};o.user.valid()&&s.requireVerification(i,t)&&(e.preventDefault(),e.stopPropagation(),r=!0,o.$broadcast("user:verify",{description:n.verificationRequiredDescription}))})}}}]},{}],251:[function(e,t,n){"use strict";t.exports=function(){var p=500,h=0;this.requestDelay=function(e){p=e},this.maxRetries=function(e){h=e},this.$get=["$rootScope","$injector","$q","$timeout","$log",function(e,o,i,a,s){var c=[];function u(t){var e=t.config,n=t.deferred;function r(e){return function(e){if(e&&e.data&&e.data.error)return!0;return!1}(t.response=e)?f(e)?u(t):n.reject(e):(t.config&&t.config.url&&l(t.config.url),n.resolve(e))}function i(e){return f(t.response=e)?u(t):n.reject(e)}return t.retries<h?(a(function(){s.warn("Retrying: count",t.retries),o.get("$http")(e).then(r,i)},t.requestDelay),t.retries++,t.requestDelay<2e3&&(t.requestDelay+=Math.floor(t.requestDelay/2)),n.promise):n.reject(t.response)}function l(e){e&&d(e)&&-1<c.indexOf(e)&&c.splice(c.indexOf(e),1)}function d(e){return e&&0<=e.indexOf("/bff/")}function f(e){return-1!==[503].indexOf(e.status)}return{response:function(e){return l(e&&e.config&&e.config.url),e},responseError:function(e){var t,n,r;return e&&e.config&&d(e.config.url)&&-1===c.indexOf(e.config.url)&&f(e)?(t=i.defer(),n={response:e,config:e.config,deferred:t,retries:0},(r=e.headers())["retry-after"]?n.requestDelay=1e3*r["retry-after"]:n.requestDelay=p,c.push(e.config.url),u(n),t.promise):i.reject(e)}}}]}},{}],252:[function(e,t,n){"use strict";t.exports=function(){var t=new RegExp("^/templates/"),n="";this.setCachingDomain=function(e,t){void 0!==e&&t===location.hostname&&(n=e)},this.$get=[function(){return{request:function(e){return t.test(e.url)&&"string"==typeof n&&(e.url=n+e.url),e}}}]}},{}],253:[function(e,t,n){"use strict";t.exports=[function(){return function(e,t,n){if(n>=e.length)for(var r=n-e.length;1+r--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}}]},{}],254:[function(e,t,n){"use strict";t.exports=function(){var t=/^(gmail|yahoo|sbcglobal|verizon|icloud|hotmail|comcast|aol|me|mail|mac|earthlink|bellsouth|msn|live|outlook)$/;this.validate=function(e){e=function(e){if(!e)return;if(!/\@/.test(e))return;if(!/\./.test(e))return;e=e.split("@");if(!e||0===e.length)return;e=e[1].split(".");return e&&0!==e.length?e[0]:void 0}(e);return!!e&&!t.test(e)}}},{}],255:[function(e,t,n){"use strict";r.$inject=["config","$q"];var s=e("async"),c=1,u=1e4;function r(n,r){return{getCaptcha:function(n,r){window.grecaptcha?s.parallel([function(e){setTimeout(function(){e("timed-out")},u)},function(e){window.grecaptcha.ready(function(){return e("ready",!0)})}],function(e,t){"ready"===e&&t[1]?function n(r,i,o){s.parallel([function(e){setTimeout(function(){e("timed-out")},u)},function(e){a(r,e)}],function(e,t){"success"!==e?i<c?(i++,setTimeout(function(){n(r,i,o)},3e3)):o():o(t[1])})}(n,0,r):r()}):r()}};function a(e,t){r.resolve().then(function(){return window.grecaptcha.execute(n.recaptcha.site_key,{action:e})}).then(function(e){t("success",e)}).catch(function(e){t(e)})}}t.exports=r},{async:21}],256:[function(e,t,n){"use strict";t.exports=["$rootScope","SubscriptionService","$q","config","_",function(o,a,s,c,u){return function(t,n,e,r){var i={owned:!1,comped:!1,subscribed:!1,followed:!1,streamOnly:!1};return n&&o.user.valid()?s.all({isFollowing:(e=e)?o.user.isFollowing("event",{entityId:e}):s.resolve(!1),userSubscriptionData:a.getSubscriptionContentByUser(r),userSubscriptions:a.getSubscriptionsByUser()}).then(function(e){return c&&c.contentTypeMap&&c.contentTypeMap[t]&&(i.owned=o.user.hasContent("purchased",c.contentTypeMap[t],n)),o.user.hasRole("streaming_only")&&(i.streamOnly=!0),i.comped=!i.owned&&(o.user&&o.user.hasRole&&o.user.hasRole("owns_all_courses")),i.followed=e.isFollowing,i.subscribed=u.contains(e.userSubscriptionData,n),i.subscription_ids=[],u.each(e.userSubscriptions,function(e){i.subscription_ids.push(e._id)}),i}):s.resolve(i)}}]},{}],257:[function(e,t,n){"use strict";var a=e("underscore");t.exports=[function(){var e=angular.copy(Array);function o(e,t,n){return angular.isFunction(n)?n(e,t):angular.isString(n)?e[n]===t[n]:angular.equals(e,t)}return window.DataSet=e,angular.extend(e.prototype,{hasItem:function(t,n){return angular.isObject(t)?void 0!==a.find(this,function(e){return o(e,t,n)}):-1<this.indexOf(t)},addToSet:function(e,t){return null!=e&&(angular.isArray(e)?this.addEachToSet(e,t):!this.hasItem(e,t)&&(this.push(e),!0))},addEachToSet:function(e,t){var n=this,r=[];return angular.forEach(e,function(e){e=n.addToSet(e,t);r.push(e)}),r},pull:function(n,r){var i;angular.isObject(n)?a.each(this,function(e,t){o(e,n,r)&&(i=t)}):i=this.indexOf(n),-1<i&&this.splice(i,1)},clear:function(){this.splice(0,this.length)}}),e}]},{underscore:void 0}],258:[function(e,t,n){"use strict";t.exports=["DataSet",function(e){var r=new e;return{getList:function(){return r},hasItem:r.hasItem,registerItem:r.addToSet,removeItem:r.pull,clear:r.clear,addItem:i,addItems:function(t,e,n){angular.forEach(e,function(e){i(t,e,n)})}};function i(e,t,n){r.addToSet(t,n)&&(e.addToSet?e.addToSet(t,n):e.push(t))}}]},{}],259:[function(e,t,n){"use strict";var l=e("underscore");t.exports=[function(){return function(n,e,t){t=t||{},angular.extend(n,{call:function(e,t){n[e](t)},show:function(e,t){n.views[e].onShow=t},done:function(e){if(t.onDone)return t.onDone(e,a);a()},cancel:function(e){if(t.onCancel)return t.onCancel(e,s);s()},abort:function(e){if(t.onAbort)return t.onAbort(e,o);o()},complete:o,markAsDone:function(e){e&&(n.views[e].done=!0)},allDone:c,views:{},flows:[],showView:u,nextView:a,previousView:s,view:{idx:0,current:void 0}});for(var r=0;r<e.length;r++){var i=e[r].tagName.toLowerCase();n.views[i]={name:i,done:!1},n.flows.push(i)}function o(e){if(t.onComplete)return t.onComplete(e,n.onComplete);n.onComplete&&n.onComplete()}function a(){n.view.idx++,u(!0)}function s(){n.view.idx--,u(!0)}function c(){var e=n.flows.length,t=0;return l.each(n.views,function(e){e.done&&t++}),t===e}function u(e){if(c())return o();if(n.flows){n.view.current=n.flows[n.view.idx];var t=n.views[n.view.current];if(t){if(t.done)return a();"function"==typeof t.onShow&&t.onShow()}!t&&e&&o()}}}}]},{underscore:void 0}],260:[function(e,t,n){"use strict";t.exports=["$timeout","$window",function(r,i){return function(e,t){t&&t.preventDefault();var n=i.document.getElementById(e);n&&(n.focus(),r(function(){n.focus()}))}}]},{}],261:[function(e,t,n){"use strict";t.exports=["parseQS","$rootScope","deepval",function(t,n,r){return function(e){return e||(e=t().u||"me"),r(n||{},"user.valid")?e:null}}]},{}],262:[function(e,t,n){"use strict";t.exports=["$window","$document","$timeout","$q",function(r,l,i,d){var f=null,p=null,h=null,t={},n={},o=null,a=[],m=[],g=null,s=null,c=!1,v=null,e=null;return function(e){return f=(e=e||{}).bounds||0,p=e.debounce||50,h=e.clickTimeout||250,n.timeout=e.deltaTimeout||50,n.speed=e.deltaSpeed||500,{track:y,untrack:b,destroy:_}};function y(e){return o=o||d.defer(),c||(c=!0,angular.element(r).bind("scroll",w),angular.element(r).bind("scroll",u),angular.element(r).bind("mouseup",function(){i(u,h)}),angular.element(r).bind("touchend",u),r.addEventListener("resize",u,!1),w()),e&&(angular.isElement(e)&&-1===a.indexOf(e)?a.push(e):angular.isArray(e)&&angular.forEach(e,function(e){angular.isElement(e)&&-1===a.indexOf(e)&&a.push(e)})),S(function(){E()},p)(),o.promise}function b(e){angular.isElement(e)&&-1<a.indexOf(e)?a.splice(a.indexOf(e),1):angular.isArray(e)&&angular.forEach(e,function(e){angular.isElement(e)&&-1<a.indexOf(e)&&a.splice(a.indexOf(e))})}function _(){angular.element(r).off("scroll",w),angular.element(r).off("scroll",u),r.removeEventListener("resize",u),a=[],e=c=!(m=[]),o=null}function w(){var e;g=r.scrollY||r.pageYOffset,null!==s&&(t.velocity=g-s,t.delta=0<=t.velocity?t.velocity:-1*t.velocity),s=g,e&&i.cancel(e),i(function(){s=null},30,!0)}function S(n,r){return function(){var e=this,t=arguments;i.cancel(v),v=i(function(){n.apply(e,t)},r)}}function u(){t.delta<n.speed&&(e||(e=!0,E(),i(function(){e=!1},n.timeout))),S(function(){E()},p)()}function E(){c&&!a.length&&(o.resolve(),_());var n=[];angular.forEach(a,function(e){var t;0<=(t=(t=e).getBoundingClientRect()).bottom&&0<=t.right&&t.top<=(r.innerHeight||l[0].documentElement.clientHeight)+f&&t.left<=(r.innerWidth||l[0].documentElement.clientWidth)+f?(o.notify(e),-1===m.indexOf(e)&&m.push(e)):n.push(e)}),a=n}}]},{}],263:[function(e,t,n){"use strict";t.exports=["$scope",function(e){}]},{}],264:[function(e,t,n){"use strict";t.exports=["$document","_",function(e,r){var t=this,i={KEY_DOWN:"KEY_DOWN",RIGHT:39,LEFT:37,DOWN:40,UP:38,ENTER:13,SPACE:32,ESC:27,NEXT:190,PREV:188},o=(r.extend(t,{EVENTS:i,ready:!1,disable:function(){r.each(o,function(e,t){e.active=!1})},enable:function(){r.each(o,function(e,t){e.active=!0})},on:function(e,t,n){a(),o[e]||(o[e]={active:!0});o[e][t]=n},off:function(e,t){o[e]&&(t?delete o[e][t]:delete o[e])},focus:function(e){r.each(o,function(t,n){t.active=!1,r.each(e,function(e){n===e&&(t.active=!0)})})},blur:function(){r.each(o,function(e){e.active=!0})}}),{});return a(),t;function a(){t.ready||(t.ready=!0,e[0].body.onkeydown=n)}function n(t){var n=arguments;r.each(o,function(e){e.active&&e[t.keyCode]&&e[t.keyCode].apply(this,n),e.active&&e[i.KEY_DOWN]&&e[i.KEY_DOWN].apply(this,n)})}}]},{}],265:[function(e,t,n){"use strict";t.exports=["$location","$route","$rootScope","$timeout",function(r,n,i,o){this.skipReload=function(){var e=n.current,t=i.$on("$locationChangeSuccess",function(){n.current=e,t()});return this},this.withoutRefresh=function(e,t,n){o(function(){t?r.path(e).replace():r.path(e||"/")},n||0)}}]},{}],266:[function(e,t,n){"use strict";function r(n,e){var r={},i=!!(e&&e.context&&e.context.ua&&e.context.ua.mobile),o=e.context&&e.context.ua&&e.context.ua.os&&"iOS"===e.context.ua.os.family;return{lock:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e&&(!1===t&&i&&o||(r[e]=!0,n.lockBody=!0))},unlock:function(e){void 0!==r[e]&&delete r[e];0===Object.keys(r).length&&(n.lockBody=!1)},lockContent:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e&&(e+="-content",!1===t&&i&&o||(r[e]=!0,n.lockContent=!0))},unlockContent:function(e){void 0!==r[e+="-content"]&&delete r[e];0===Object.keys(r).length&&(n.lockContent=!1)}}}r.$inject=["$rootScope","rind"],t.exports=r},{}],267:[function(e,t,n){"use strict";t.exports=["$rootScope",function(e){return{variationExists:function(e){return!1},getAllVariationNames:function(){return[]},experimentRunning:function(e){return!1},experimentAndVariationExists:function(e,t){return!1}}}]},{}],268:[function(e,t,n){"use strict";t.exports=["$window",function(n){return function(){var e,t={};return n.location&&n.location.search&&(e=decodeURIComponent(n.location.search).substr(1).split("&"),angular.forEach(e,function(e){e=e.split("=");t[e[0]]=e[1]})),t}}]},{}],269:[function(e,t,n){"use strict";t.exports=["$rootScope","$compile",function(s,c){return function(e,n){var r={text:[],nodes:{}},t=(n=n||{}).compileScope||s.$new();if(1===e.length)r.raw=e[0];else for(var i=0;i<e.length;i++){var o,a=angular.copy(e[i]);1===a.nodeType?(r.nodes[a.tagName]=a,n.$scope&&(o=angular.element(a),n.$scope[a.tagName]=o.html(),c(o)(t))):3===a.nodeType&&r.text.push(a)}return n.nodeMap&&n.$element&&angular.forEach(n.nodeMap,function(e,t){e=r.nodes[e];e&&angular.element(n.$element[0].querySelector(t)).html(e.outerHTML)}),n.$element&&c(n.$element)(t),r}}]},{}],270:[function(e,t,n){"use strict";t.exports=["$q",function(t){return{series:function(e){return angular.isArray(e)?e.reduce(function(e,t){return e.then(t).catch(function(e){return e})},t.resolve()):t.reject(new TypeError("promises must be an array of promises."))}}}]},{}],271:[function(e,t,n){"use strict";t.exports=["$q","deepval",function(t,n){return{wrapResponse:function(e){return e.then(function(e){return e&&e.success?n(e||{},"data"):t.reject(e.message)})},wrapRawResponse:function(e){return e.then(function(e){return e&&e.data&&e.data.success?n(e||{},"data.data"):t.reject(e.data.message)})}}}]},{}],272:[function(e,t,n){"use strict";t.exports=["$window","$document","Vault","_",function(r,l,d,i){var t,f,e={XS:576,SM:768,MD:992,LG:1200,XL:1600},o=[],p=[],a={},s={},n={},h=(v(),r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame);function m(){h(function(){i.each(o,function(e){e.fn()})})}var c=i.throttle(m,50),u=!1,g=!1;return w(),{BREAKPOINTS:e,on:function(e,t){var n=i.findWhere(o,{id:e});n?(n.fn=t,n.scroll=!0,n.resize=!0):o.push({id:e,fn:t,scroll:!0,resize:!0});E()},off:function(e){i.findWhere(o,{id:e}).scroll=!1,A()},run:c,setBounds:function(e){if(!e)return!1;var t=document.querySelector(e);if(!t)return!1;a[e]||(a[e]={element:t,top:void 0,bottom:void 0});var n=a[e],t=t.getBoundingClientRect();n.top=(r.scrollY||r.pageYOffset)+t.top,n.bottom=n.top+t.height,!0===d.get("clScrollSpyDebug")&&(s[e]||(s[e]=angular.element("<div></div>"),angular.element(document.body).append(s[e])),s[e].css({border:"1px solid red",background:"rgba(255, 0, 0, .3)",position:"absolute",left:t.left+"px",top:n.top+"px",width:t.width+"px",height:t.height+"px"}).html('<h3 style="background: rgba(255, 255, 255, .8);padding: 15px;">'+e+"</h3>"));return n},elements:a,inView:b,windowHeight:t,windowWidth:f,viewportData:n,elementInView:function(e){e=a[e];if(e)return b(e.top,e.bottom)},elementTopInView:function(e){e=a[e];if(e)return y().bottom>=e.top},elementBottomInView:function(e){e=a[e];if(e)return y().top<=e.bottom},elementIsMainFocus:function(e,t){var n,e=a[e];if(e)return void 0===t&&(t=200),t=parseInt(t,10),n=y(),n=Math.round(n.top+t),e.bottom>n&&e.top<n},enable:function(){E(!0),w(!0)},disable:function(){A(!0),angular.element(r).off("resize",_),g=!1},onResize:function(e){p.push(e)},setThrottle:function(e,t){c=i.throttle(m,e,t)}};function v(){t=$(window).height(),f=$(window).width(),n.width=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n.height=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n.width<e.XS?n.size="xs":n.width<e.SM?n.size="sm":n.width<e.MD?n.size="md":n.width<e.LG?n.size="lg":n.size="xl",n.width>n.height?n.orientation="landscape":n.orientation="portrait"}function y(){var e=r.scrollY||r.pageYOffset;return{top:e,bottom:e+t,middle:e+Math.round(t/2)}}function b(e,t){var n=y();return isNaN(e)||isNaN(t)?isNaN(e)?!!isNaN(t)||n.bottom>t:n.top<e:n.bottom>=e&&n.top<=t}function _(e){v(),c(e),angular.forEach(p,function(e){e()})}function w(e){g&&!e||(g=!0,angular.element(r).bind("resize",_))}function S(){return i.where(o,{scroll:!0})}function E(e){var t=S();(!u||e)&&0<t.length&&(u=!0,angular.element(r).bind("scroll",c))}function A(e){var t=S();(u||e)&&t.length<1&&(angular.element(r).off("scroll",c),u=!1)}}]},{}],273:[function(e,t,n){"use strict";t.exports=["$interval","$timeout",function(c,u){return function(e,t,n){var r,i,o,a=t,s=("interval"===e?c:u).cancel;this.pause=function(){s(i),o=!1,a-=new Date-r},this.reset=function(){a=t,this.resume()},this.resume=function(){o=!0,r=new Date,angular.isDefined(i)&&s(i),"interval"===e?i=c(n,t):"timeout"===e&&(i=u(n,a))},this.cancel=function(){o=!1,s(i)},this.isCounting=function(){return o},this.resume()}}]},{}],274:[function(e,t,n){"use strict";t.exports=["_",function(e){var t={"America/Puerto_Rico":"Atlantic","America/New_York":"Eastern","America/Chicago":"Central","America/Denver":"Mountain","America/Phoenix":"Arizona","America/Los_Angeles":"Pacific","America/Anchorage":"Alaska","Pacific/Honolulu":"Hawaii","America/Adak":"Adak","America/Anguilla":"Anguilla","America/Antigua":"Antigua","America/Araguaina":"Araguaina","America/Argentina/Buenos_Aires":"Argentina - Buenos Aires","America/Argentina/Catamarca":"Argentina - Catamarca","America/Argentina/ComodRivadavia":"Argentina - ComodRivadavia","America/Argentina/Cordoba":"Argentina - Cordoba","America/Argentina/Jujuy":"Argentina - Jujuy","America/Argentina/La_Rioja":"Argentina - La Rioja","America/Argentina/Mendoza":"Argentina - Mendoza","America/Argentina/Rio_Gallegos":"Argentina - Rio Gallegos","America/Argentina/Salta":"Argentina - Salta","America/Argentina/San_Juan":"Argentina - San Juan","America/Argentina/San_Luis":"Argentina - San Luis","America/Argentina/Tucuman":"Argentina - Tucuman","America/Argentina/Ushuaia":"Argentina - Ushuaia","America/Aruba":"Aruba","America/Asuncion":"Asuncion","America/Atikokan":"Atikokan","America/Atka":"Atka","America/Bahia":"Bahia","America/Bahia_Banderas":"Bahia Banderas","America/Barbados":"Barbados","America/Belem":"Belem","America/Belize":"Belize","America/Blanc-Sablon":"Blanc-Sablon","America/Boa_Vista":"Boa Vista","America/Bogota":"Bogota","America/Boise":"Boise","America/Buenos_Aires":"Buenos Aires","America/Cambridge_Bay":"Cambridge Bay","America/Campo_Grande":"Campo Grande","America/Cancun":"Cancun","America/Caracas":"Caracas","America/Catamarca":"Catamarca","America/Cayenne":"Cayenne","America/Cayman":"Cayman","America/Chihuahua":"Chihuahua","America/Coral_Harbour":"Coral Harbour","America/Cordoba":"Cordoba","America/Costa_Rica":"Costa Rica","America/Creston":"Creston","America/Cuiaba":"Cuiaba","America/Curacao":"Curacao","America/Danmarkshavn":"Danmarkshavn","America/Dawson":"Dawson","America/Dawson_Creek":"Dawson Creek","America/Detroit":"Detroit","America/Dominica":"Dominica","America/Edmonton":"Edmonton","America/Eirunepe":"Eirunepe","America/El_Salvador":"El Salvador","America/Ensenada":"Ensenada","America/Fortaleza":"Fortaleza","America/Fort_Wayne":"Fort Wayne","America/Glace_Bay":"Glace Bay","America/Godthab":"Godthab","America/Goose_Bay":"Goose Bay","America/Grand_Turk":"Grand Turk","America/Grenada":"Grenada","America/Guadeloupe":"Guadeloupe","America/Guatemala":"Guatemala","America/Guayaquil":"Guayaquil","America/Guyana":"Guyana","America/Halifax":"Halifax","America/Havana":"Havana","America/Hermosillo":"Hermosillo","America/Indiana/Indianapolis":"Indiana - Indianapolis","America/Indiana/Knox":"Indiana - Knox","America/Indiana/Marengo":"Indiana - Marengo","America/Indiana/Petersburg":"Indiana - Petersburg","America/Indiana/Tell_City":"Indiana - Tell City","America/Indiana/Vevay":"Indiana - Vevay","America/Indiana/Vincennes":"Indiana - Vincennes","America/Indiana/Winamac":"Indiana - Winamac","America/Indianapolis":"Indianapolis","America/Inuvik":"Inuvik","America/Iqaluit":"Iqaluit","America/Jamaica":"Jamaica","America/Jujuy":"Jujuy","America/Juneau":"Juneau","America/Kentucky/Louisville":"Kentucky - Louisville","America/Kentucky/Monticello":"Kentucky - Monticello","America/Kralendijk":"Kralendijk","America/Knox_IN":"Knox IN","America/La_Paz":"La Paz","America/Lima":"Lima","America/Louisville":"Louisville","America/Lower_Princes":"Lower Princes","America/Maceio":"Maceio","America/Managua":"Managua","America/Manaus":"Manaus","America/Marigot":"Marigot","America/Martinique":"Martinique","America/Matamoros":"Matamoros","America/Mazatlan":"Mazatlan","America/Mendoza":"Mendoza","America/Menominee":"Menominee","America/Merida":"Merida","America/Metlakatla":"Metlakatla","America/Mexico_City":"Mexico City","America/Miquelon":"Miquelon","America/Moncton":"Moncton","America/Monterrey":"Monterrey","America/Montevideo":"Montevideo","America/Montreal":"Montreal","America/Montserrat":"Montserrat","America/Nassau":"Nassau","America/Nipigon":"Nipigon","America/Nome":"Nome","America/Noronha":"Noronha","America/North_Dakota/Beulah":"Beulah","America/North_Dakota/Center":"North Dakota - Center","America/North_Dakota/New_Salem":"North Dakota - New Salem","America/Ojinaga":"Ojinaga","America/Panama":"Panama","America/Pangnirtung":"Pangnirtung","America/Paramaribo":"Paramaribo","America/Port-au-Prince":"Port-au-Prince","America/Porto_Acre":"Porto Acre","America/Port_of_Spain":"Port of Spain","America/Porto_Velho":"Porto Velho","America/Rainy_River":"Rainy River","America/Rankin_Inlet":"Rankin Inlet","America/Recife":"Recife","America/Regina":"Regina","America/Resolute":"Resolute","America/Rio_Branco":"Rio Branco","America/Rosario":"Rosario","America/Santa_Isabel":"Santa Isabel","America/Santarem":"Santarem","America/Santiago":"Santiago","America/Santo_Domingo":"Santo Domingo","America/Sao_Paulo":"Sao Paulo","America/Scoresbysund":"Scoresbysund","America/Shiprock":"Shiprock","America/Sitka":"Sitka","America/St_Barthelemy":"St Barthelemy","America/St_Johns":"St Johns","America/St_Kitts":"St Kitts","America/St_Lucia":"St Lucia","America/St_Thomas":"St Thomas","America/St_Vincent":"St Vincent","America/Swift_Current":"Swift Current","America/Tegucigalpa":"Tegucigalpa","America/Thule":"Thule","America/Thunder_Bay":"Thunder Bay","America/Tijuana":"Tijuana","America/Toronto":"Toronto","America/Tortola":"Tortola","America/Vancouver":"Vancouver","America/Virgin":"Virgin","America/Whitehorse":"Whitehorse","America/Winnipeg":"Winnipeg","America/Yakutat":"Yakutat","America/Yellowknife":"Yellowknife","Europe/Amsterdam":"Amsterdam","Europe/Andorra":"Andorra","Europe/Athens":"Athens","Europe/Belfast":"Belfast","Europe/Belgrade":"Belgrade","Europe/Berlin":"Berlin","Europe/Bratislava":"Bratislava","Europe/Brussels":"Brussels","Europe/Bucharest":"Bucharest","Europe/Budapest":"Budapest","Europe/Chisinau":"Chisinau","Europe/Copenhagen":"Copenhagen","Europe/Dublin":"Dublin","Europe/Gibraltar":"Gibraltar","Europe/Guernsey":"Guernsey","Europe/Helsinki":"Helsinki","Europe/Isle_of_Man":"Isle of Man","Europe/Istanbul":"Istanbul","Europe/Jersey":"Jersey","Europe/Kaliningrad":"Kaliningrad","Europe/Kiev":"Kiev","Europe/Lisbon":"Lisbon","Europe/Ljubljana":"Ljubljana","Europe/London":"London","Europe/Luxembourg":"Luxembourg","Europe/Madrid":"Madrid","Europe/Malta":"Malta","Europe/Mariehamn":"Mariehamn","Europe/Minsk":"Minsk","Europe/Monaco":"Monaco","Europe/Moscow":"Moscow","Europe/Nicosia":"Nicosia","Europe/Oslo":"Oslo","Europe/Paris":"Paris","Europe/Podgorica":"Podgorica","Europe/Prague":"Prague","Europe/Riga":"Riga","Europe/Rome":"Rome","Europe/Samara":"Samara","Europe/San_Marino":"San Marino","Europe/Sarajevo":"Sarajevo","Europe/Simferopol":"Simferopol","Europe/Skopje":"Skopje","Europe/Sofia":"Sofia","Europe/Stockholm":"Stockholm","Europe/Tallinn":"Tallinn","Europe/Tirane":"Tirane","Europe/Tiraspol":"Tiraspol","Europe/Uzhgorod":"Uzhgorod","Europe/Vaduz":"Vaduz","Europe/Vatican":"Vatican","Europe/Vienna":"Vienna","Europe/Vilnius":"Vilnius","Europe/Volgograd":"Volgograd","Europe/Warsaw":"Warsaw","Europe/Zagreb":"Zagreb","Europe/Zaporozhye":"Zaporozhye","Europe/Zurich":"Zurich","Asia/Aden":"Aden","Asia/Almaty":"Almaty","Asia/Amman":"Amman","Asia/Anadyr":"Anadyr","Asia/Aqtau":"Aqtau","Asia/Aqtobe":"Aqtobe","Asia/Ashgabat":"Ashgabat","Asia/Ashkhabad":"Ashkhabad","Asia/Baghdad":"Baghdad","Asia/Bahrain":"Bahrain","Asia/Baku":"Baku","Asia/Bangkok":"Bangkok","Asia/Beirut":"Beirut","Asia/Bishkek":"Bishkek","Asia/Brunei":"Brunei","Asia/Calcutta":"Calcutta","Asia/Choibalsan":"Choibalsan","Asia/Chongqing":"Chongqing","Asia/Chungking":"Chungking","Asia/Colombo":"Colombo","Asia/Dacca":"Dacca","Asia/Damascus":"Damascus","Asia/Dhaka":"Dhaka","Asia/Dili":"Dili","Asia/Dubai":"Dubai","Asia/Dushanbe":"Dushanbe","Asia/Gaza":"Gaza","Asia/Harbin":"Harbin","Asia/Hebron":"Hebron","Asia/Ho_Chi_Minh":"Ho Chi Minh","Asia/Hong_Kong":"Hong Kong","Asia/Hovd":"Hovd","Asia/Irkutsk":"Irkutsk","Asia/Istanbul":"Istanbul","Asia/Jakarta":"Jakarta","Asia/Jayapura":"Jayapura","Asia/Jerusalem":"Jerusalem","Asia/Kabul":"Kabul","Asia/Kamchatka":"Kamchatka","Asia/Karachi":"Karachi","Asia/Kashgar":"Kashgar","Asia/Kathmandu":"Kathmandu","Asia/Katmandu":"Katmandu","Asia/Kolkata":"Kolkata","Asia/Krasnoyarsk":"Krasnoyarsk","Asia/Kuala_Lumpur":"Kuala Lumpur","Asia/Kuching":"Kuching","Asia/Kuwait":"Kuwait","Asia/Macao":"Macao","Asia/Macau":"Macau","Asia/Magadan":"Magadan","Asia/Makassar":"Makassar","Asia/Manila":"Manila","Asia/Muscat":"Muscat","Asia/Nicosia":"Nicosia","Asia/Novokuznetsk":"Novokuznetsk","Asia/Novosibirsk":"Novosibirsk","Asia/Omsk":"Omsk","Asia/Oral":"Oral","Asia/Phnom_Penh":"Phnom Penh","Asia/Pontianak":"Pontianak","Asia/Pyongyang":"Pyongyang","Asia/Qatar":"Qatar","Asia/Qyzylorda":"Qyzylorda","Asia/Rangoon":"Rangoon","Asia/Riyadh":"Riyadh","Asia/Saigon":"Saigon","Asia/Sakhalin":"Sakhalin","Asia/Samarkand":"Samarkand","Asia/Seoul":"Seoul","Asia/Shanghai":"Shanghai","Asia/Singapore":"Singapore","Asia/Taipei":"Taipei","Asia/Tashkent":"Tashkent","Asia/Tbilisi":"Tbilisi","Asia/Tehran":"Tehran","Asia/Tel_Aviv":"Tel Aviv","Asia/Thimbu":"Thimbu","Asia/Thimphu":"Thimphu","Asia/Tokyo":"Tokyo","Asia/Ujung_Pandang":"Ujung Pandang","Asia/Ulaanbaatar":"Ulaanbaatar","Asia/Ulan_Bator":"Ulan Bator","Asia/Urumqi":"Urumqi","Asia/Vientiane":"Vientiane","Asia/Vladivostok":"Vladivostok","Asia/Yakutsk":"Yakutsk","Asia/Yekaterinburg":"Yekaterinburg","Asia/Yerevan":"Yerevan","Africa/Abidjan":"Abidjan","Africa/Accra":"Accra","Africa/Addis_Ababa":"Addis Ababa","Africa/Algiers":"Algiers","Africa/Asmara":"Asmara","Africa/Asmera":"Asmera","Africa/Bamako":"Bamako","Africa/Bangui":"Bangui","Africa/Banjul":"Banjul","Africa/Bissau":"Bissau","Africa/Blantyre":"Blantyre","Africa/Brazzaville":"Brazzaville","Africa/Bujumbura":"Bujumbura","Africa/Cairo":"Cairo","Africa/Casablanca":"Casablanca","Africa/Ceuta":"Ceuta","Africa/Conakry":"Conakry","Africa/Dakar":"Dakar","Africa/Dar_es_Salaam":"Dar es Salaam","Africa/Djibouti":"Djibouti","Africa/Douala":"Douala","Africa/El_Aaiun":"El Aaiun","Africa/Freetown":"Freetown","Africa/Gaborone":"Gaborone","Africa/Harare":"Harare","Africa/Johannesburg":"Johannesburg","Africa/Juba":"Juba","Africa/Kampala":"Kampala","Africa/Khartoum":"Khartoum","Africa/Kigali":"Kigali","Africa/Kinshasa":"Kinshasa","Africa/Lagos":"Lagos","Africa/Libreville":"Libreville","Africa/Lome":"Lome","Africa/Luanda":"Luanda","Africa/Lubumbashi":"Lubumbashi","Africa/Lusaka":"Lusaka","Africa/Malabo":"Malabo","Africa/Maputo":"Maputo","Africa/Maseru":"Maseru","Africa/Mbabane":"Mbabane","Africa/Mogadishu":"Mogadishu","Africa/Monrovia":"Monrovia","Africa/Nairobi":"Nairobi","Africa/Ndjamena":"Ndjamena","Africa/Niamey":"Niamey","Africa/Nouakchott":"Nouakchott","Africa/Ouagadougou":"Ouagadougou","Africa/Porto-Novo":"Porto-Novo","Africa/Sao_Tome":"Sao Tome","Africa/Timbuktu":"Timbuktu","Africa/Tripoli":"Tripoli","Africa/Tunis":"Tunis","Africa/Windhoek":"Windhoek","Australia/ACT":"ACT","Australia/Adelaide":"Adelaide","Australia/Brisbane":"Brisbane","Australia/Broken_Hill":"Broken Hill","Australia/Canberra":"Canberra","Australia/Currie":"Currie","Australia/Darwin":"Darwin","Australia/Eucla":"Eucla","Australia/Hobart":"Hobart","Australia/LHI":"LHI","Australia/Lindeman":"Lindeman","Australia/Lord_Howe":"Lord Howe","Australia/Melbourne":"Melbourne","Australia/North":"North","Australia/NSW":"NSW","Australia/Perth":"Perth","Australia/Queensland":"Queensland","Australia/South":"South","Australia/Sydney":"Sydney","Australia/Tasmania":"Tasmania","Australia/Victoria":"Victoria","Australia/West":"West","Australia/Yancowinna":"Yancowinna","Indian/Antananarivo":"Antananarivo","Indian/Chagos":"Chagos","Indian/Christmas":"Christmas","Indian/Cocos":"Cocos","Indian/Comoro":"Comoro","Indian/Kerguelen":"Kerguelen","Indian/Mahe":"Mahe","Indian/Maldives":"Maldives","Indian/Mauritius":"Mauritius","Indian/Mayotte":"Mayotte","Indian/Reunion":"Reunion","Atlantic/Azores":"Azores","Atlantic/Bermuda":"Bermuda","Atlantic/Canary":"Canary","Atlantic/Cape_Verde":"Cape Verde","Atlantic/Faeroe":"Faeroe","Atlantic/Faroe":"Faroe","Atlantic/Jan_Mayen":"Jan Mayen","Atlantic/Madeira":"Madeira","Atlantic/Reykjavik":"Reykjavik","Atlantic/South_Georgia":"South Georgia","Atlantic/Stanley":"Stanley","Atlantic/St_Helena":"St Helena","Pacific/Apia":"Apia","Pacific/Auckland":"Auckland","Pacific/Chuuk":"Chuuk","Pacific/Chatham":"Chatham","Pacific/Easter":"Easter","Pacific/Efate":"Efate","Pacific/Enderbury":"Enderbury","Pacific/Fakaofo":"Fakaofo","Pacific/Fiji":"Fiji","Pacific/Funafuti":"Funafuti","Pacific/Galapagos":"Galapagos","Pacific/Gambier":"Gambier","Pacific/Guadalcanal":"Guadalcanal","Pacific/Guam":"Guam","Pacific/Johnston":"Johnston","Pacific/Kiritimati":"Kiritimati","Pacific/Kosrae":"Kosrae","Pacific/Kwajalein":"Kwajalein","Pacific/Majuro":"Majuro","Pacific/Marquesas":"Marquesas","Pacific/Midway":"Midway","Pacific/Nauru":"Nauru","Pacific/Niue":"Niue","Pacific/Norfolk":"Norfolk","Pacific/Noumea":"Noumea","Pacific/Pago_Pago":"Pago Pago","Pacific/Palau":"Palau","Pacific/Pitcairn":"Pitcairn","Pacific/Pohnpei":"Pohnpei","Pacific/Ponape":"Ponape","Pacific/Port_Moresby":"Port Moresby","Pacific/Rarotonga":"Rarotonga","Pacific/Saipan":"Saipan","Pacific/Samoa":"Samoa","Pacific/Tahiti":"Tahiti","Pacific/Tarawa":"Tarawa","Pacific/Tongatapu":"Tongatapu","Pacific/Truk":"Truk","Pacific/Wake":"Wake","Pacific/Wallis":"Wallis","Pacific/Yap":"Yap","Antarctica/Casey":"Casey","Antarctica/Davis":"Davis","Antarctica/DumontDUrville":"DumontDUrville","Antarctica/Macquarie":"Macquarie","Antarctica/Mawson":"Mawson","Antarctica/McMurdo":"McMurdo","Antarctica/Palmer":"Palmer","Antarctica/Rothera":"Rothera","Antarctica/South_Pole":"South Pole","Antarctica/Syowa":"Syowa","Antarctica/Vostok":"Vostok","Arctic/Longyearbyen":"Longyearbyen",UTC:"Coordinated Universal Time"};return{zoneNames:t,getTimezones:function(){return e.keys(t)}}}]},{}],275:[function(e,t,n){"use strict";function r(r){return{removeHeight:function(e){e&&e.css({height:""})},setHeight:function(t,n){var e;t&&n&&(e=t.height(),t.css({height:e}),r(function(){var e=n.height();t.css({height:e})},350))}}}r.$inject=["$timeout"],t.exports=r},{}],276:[function(e,t,n){"use strict";t.exports=[function(){return{getAvatarPath:function(e,t){var n="";return e&&t?encodeURI("https://ugc.creativelive.com/ugc/"+e+"/profile-"+t+".jpg"):n},getBackgroundPath:function(e,t){var n="";return e&&t?encodeURI("https://ugc.creativelive.com/ugc/"+e+"/background-"+t+".jpg"):n}}}]},{}],277:[function(e,t,n){"use strict";t.exports=["$rootScope","$window",function(e,r){return{isTopicFilteredCatalogPage:function(){var e=!1,t=r.location.pathname.split("/"),n=t.indexOf("catalog");t[0<=n?n+2:-1]&&(e=!0);return e}}}]},{}],278:[function(e,t,n){"use strict";t.exports=["Slug",function(r){return function(e){var t,n="";return"string"==typeof e&&e.match(/\?|\//)?(1<(t=e.split(/[\?]/)).length&&(n="?"+(t[1]||"")),1===(t=t[0].split("/")).length?t[0]+n:(t=(t=(t=t.map(function(e){return e&&r.slugify(e)||""})).join("/")).replace(/\/+/g,"/"))+n):e}}]},{}],279:[function(e,t,n){"use strict";t.exports=function(){return{generate:function(){var n=Date.now();"undefined"!=typeof performance&&"function"==typeof performance.now&&(n+=performance.now());return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)})}}}},{}],280:[function(e,t,n){"use strict";t.exports=["$window","$document",function(e,t){var n,r;return{getWidth:function(){return i(),n},getHeight:function(){return i(),r}};function i(){n=e.innerWidth||t[0].documentElement.clientWidth,r=e.innerHeight||t[0].documentElement.clientHeight}}]},{}],281:[function(e,t,n){"use strict";e("./common/module"),e("./modules/account.mod/module"),e("./modules/add-to-calendar.mod/module"),e("./modules/applicable-coupons.mod/module"),e("./modules/audio.mod/module"),e("./modules/back.mod/module"),e("./modules/banner-top.mod/module"),e("./modules/banner.mod/module"),e("./modules/blog-post.mod/module"),e("./modules/blog-posts.mod/module"),e("./modules/broadcast-time.mod/module"),e("./modules/bundle-courses.mod/module"),e("./modules/bundles.mod/module"),e("./modules/call-to-audience.mod/module"),e("./modules/carousel-slide.mod/module"),e("./modules/carousel.mod/module"),e("./modules/content-tile.mod/module"),e("./modules/content-list-collection.mod/module"),e("./modules/category-filters.mod/module"),e("./modules/category-nav.mod/module"),e("./modules/category-stats.mod/module"),e("./modules/channel-hero.mod/module"),e("./modules/channel-snapshot.mod/module"),e("./modules/channel-tile.mod/module"),e("./modules/cl-analytics.mod/module"),e("./modules/cl-auth.mod/module"),e("./modules/cl-course-badge.mod/module"),e("./modules/cl-course-summary.mod/module"),e("./modules/cl-ent-checkout.mod/module"),e("./modules/cl-ent-subscription-checkout.mod/module"),e("./modules/cl-filters.mod/module"),e("./modules/cl-free-trial-onboarding.mod/module"),e("./modules/cl-free-trial-onboarding-consumer.mod/module"),e("./modules/cl-gift.mod/module"),e("./modules/cl-instructor.mod/module"),e("./modules/cl-list-hover-selector.mod/module"),e("./modules/cl-steps.mod/module"),e("./modules/cl-tooltip.mod/module"),e("./modules/cl-upload.mod/module"),e("./modules/cl-verify.mod/module"),e("./modules/cl-video-player.mod/module"),e("./modules/class-list-collection.mod/module"),e("./modules/class-recommendation.mod/module"),e("./modules/class-tile.mod/module"),e("./modules/cms-page.mod/module"),e("./modules/conditionals.mod/module"),e("./modules/cms-content-finder.mod/module"),e("./modules/cl-catalog.mod/module"),e("./modules/collapsible-list.mod/module"),e("./modules/countdown-timer.mod/module"),e("./modules/coupon-provider.mod/module"),e("./modules/course-collection.mod/module"),e("./modules/course-modal.mod/module"),e("./modules/course-navigation.mod/module"),e("./modules/course-onair.mod/module"),e("./modules/course-share.mod/module"),e("./modules/course-stats.mod/module"),e("./modules/course-tile.mod/module"),e("./modules/course-video.mod/module"),e("./modules/course-what-you-get.mod/module"),e("./modules/course.mod/module"),e("./modules/covered-topics.mod/module"),e("./modules/cross-sell-tile.mod/module"),e("./modules/cta.mod/module"),e("./modules/ecom.mod/module"),e("./modules/enterprise-product-pricing.mod/module"),e("./modules/enterprise-provider.mod/module"),e("./modules/error-page.mod/module"),e("./modules/event.mod/module"),e("./modules/export-import.mod/module"),e("./modules/facepile.mod/module"),e("./modules/follow-count.mod/module"),e("./modules/followed.mod/module"),e("./modules/form.mod/module"),e("./modules/freeform.mod/module"),e("./modules/galleries.mod/module"),e("./modules/global-module.mod/module"),e("./modules/h.mod/module"),e("./modules/heading.mod/module"),e("./modules/home-hero.mod/module"),e("./modules/icon.mod/module"),e("./modules/image-dropdown.mod/module"),e("./modules/in-studio.mod/module"),e("./modules/instructors.mod/module"),e("./modules/interest.mod/module"),e("./modules/keep-watching.mod/module"),e("./modules/landing-page-collection.mod/module"),e("./modules/landing-tracking.mod/module"),e("./modules/landing-traits.mod/module"),e("./modules/learning-path.mod/module"),e("./modules/leon.mod/module"),e("./modules/lesson-list.mod/module"),e("./modules/lesson-transcript.mod/module"),e("./modules/line-item-tiles.mod/module"),e("./modules/linemove.mod/module"),e("./modules/link-to-catalog.mod/module"),e("./modules/live-now.mod/module"),e("./modules/material-list.mod/module"),e("./modules/modal.mod/module"),e("./modules/module-settings.mod/module"),e("./modules/my-classes.mod/module"),e("./modules/my-stuff.mod/module"),e("./modules/my-topics.mod/module"),e("./modules/onboarding.mod/module"),e("./modules/overflow-tooltip.mod/module"),e("./modules/owned-courses.mod/module"),e("./modules/page-footer.mod/module"),e("./modules/partner.mod/module"),e("./modules/partner-row.mod/module"),e("./modules/past-event.mod/module"),e("./modules/price-provider.mod/module"),e("./modules/price.mod/module"),e("./modules/product.mod/module"),e("./modules/product-card.mod/module"),e("./modules/product-view-history.mod/module"),e("./modules/progress-chart.mod/module"),e("./modules/quick-watch.mod/module"),e("./modules/quiz.mod/module"),e("./modules/recently-watched.mod/module"),e("./modules/reviews.mod/module"),e("./modules/rsvp-courses.mod/module"),e("./modules/saved-search-picker.mod/module"),e("./modules/saved-search-provider.mod/module"),e("./modules/saved-search-snapshot.mod/module"),e("./modules/scroll-to-anchor.mod/module"),e("./modules/scrollbar.mod/module"),e("./modules/search-autocomplete.mod/module"),e("./modules/segment.mod/module"),e("./modules/site-banner.mod/module"),e("./modules/student-snapshot.mod/module"),e("./modules/student-work.mod/module"),e("./modules/student.mod/module"),e("./modules/subscription-admin-menu-item.mod/module"),e("./modules/subscription-eligibility.mod/module"),e("./modules/subscription-invitation.mod/module"),e("./modules/subscription-seat-management.mod/module"),e("./modules/subscription-snapshot.mod/module"),e("./modules/subscription-provider.mod/module"),e("./modules/swimlanes.mod/module"),e("./modules/tags-manager.mod/module"),e("./modules/target.mod/module"),e("./modules/taxonomy.mod/module"),e("./modules/testimonials.mod/module"),e("./modules/thank-you.mod/module"),e("./modules/time.mod/module"),e("./modules/title.mod/module"),e("./modules/topic-editor.mod/module"),e("./modules/topic-hero.mod/module"),e("./modules/topic-list.mod/module"),e("./modules/topic-tile.mod/module"),e("./modules/track.mod/module"),e("./modules/tutorial.mod/module"),e("./modules/upcoming-classes.mod/module"),e("./modules/upcoming-event.mod/module"),e("./modules/upcoming-events.mod/module"),e("./modules/update-password.mod/module"),e("./modules/user-notifications.mod/module"),e("./modules/user-recommendations.mod/module"),e("./modules/user-scores.mod/module"),e("./modules/user-subscriptions.mod/module"),e("./modules/vertical-featured.mod/module"),e("./modules/vertical-search.mod/module"),e("./modules/video-player.mod/module"),e("./modules/watch-progress.mod/module"),e("./modules/welcome-header.mod/module"),e("./modules/wishlisted.mod/module"),e("./modules/welcome.mod/module"),e("./modules/enterprise-account-admin.mod/module"),e("./modules/sso-saml-integration/module")},{"./common/module":220,"./modules/account.mod/module":289,"./modules/add-to-calendar.mod/module":294,"./modules/applicable-coupons.mod/module":296,"./modules/audio.mod/module":301,"./modules/back.mod/module":304,"./modules/banner-top.mod/module":306,"./modules/banner.mod/module":314,"./modules/blog-post.mod/module":316,"./modules/blog-posts.mod/module":320,"./modules/broadcast-time.mod/module":322,"./modules/bundle-courses.mod/module":326,"./modules/bundles.mod/module":329,"./modules/call-to-audience.mod/module":331,"./modules/carousel-slide.mod/module":333,"./modules/carousel.mod/module":337,"./modules/category-filters.mod/module":341,"./modules/category-nav.mod/module":345,"./modules/category-stats.mod/module":347,"./modules/channel-hero.mod/module":351,"./modules/channel-snapshot.mod/module":356,"./modules/channel-tile.mod/module":358,"./modules/cl-analytics.mod/module":359,"./modules/cl-auth.mod/module":371,"./modules/cl-catalog.mod/module":382,"./modules/cl-course-badge.mod/module":387,"./modules/cl-course-summary.mod/module":389,"./modules/cl-ent-checkout.mod/module":394,"./modules/cl-ent-subscription-checkout.mod/module":402,"./modules/cl-filters.mod/module":408,"./modules/cl-free-trial-onboarding-consumer.mod/module":411,"./modules/cl-free-trial-onboarding.mod/module":415,"./modules/cl-gift.mod/module":420,"./modules/cl-instructor.mod/module":422,"./modules/cl-list-hover-selector.mod/module":425,"./modules/cl-steps.mod/module":427,"./modules/cl-tooltip.mod/module":429,"./modules/cl-upload.mod/module":434,"./modules/cl-verify.mod/module":439,"./modules/cl-video-player.mod/module":458,"./modules/class-list-collection.mod/module":468,"./modules/class-recommendation.mod/module":473,"./modules/class-tile.mod/module":475,"./modules/cms-content-finder.mod/module":479,"./modules/cms-page.mod/module":481,"./modules/collapsible-list.mod/module":484,"./modules/conditionals.mod/module":487,"./modules/content-list-collection.mod/module":489,"./modules/content-tile.mod/module":491,"./modules/countdown-timer.mod/module":493,"./modules/coupon-provider.mod/module":494,"./modules/course-collection.mod/module":499,"./modules/course-modal.mod/module":501,"./modules/course-navigation.mod/module":504,"./modules/course-onair.mod/module":506,"./modules/course-share.mod/module":508,"./modules/course-stats.mod/module":511,"./modules/course-tile.mod/module":513,"./modules/course-video.mod/module":516,"./modules/course-what-you-get.mod/module":518,"./modules/course.mod/module":520,"./modules/covered-topics.mod/module":523,"./modules/cross-sell-tile.mod/module":526,"./modules/cta.mod/module":537,"./modules/ecom.mod/module":549,"./modules/enterprise-account-admin.mod/module":567,"./modules/enterprise-product-pricing.mod/module":571,"./modules/enterprise-provider.mod/module":572,"./modules/error-page.mod/module":575,"./modules/event.mod/module":585,"./modules/export-import.mod/module":587,"./modules/facepile.mod/module":591,"./modules/follow-count.mod/module":593,"./modules/followed.mod/module":595,"./modules/form.mod/module":610,"./modules/freeform.mod/module":613,"./modules/galleries.mod/module":630,"./modules/global-module.mod/module":635,"./modules/h.mod/module":637,"./modules/heading.mod/module":641,"./modules/home-hero.mod/module":645,"./modules/icon.mod/module":684,"./modules/image-dropdown.mod/module":686,"./modules/in-studio.mod/module":688,"./modules/instructors.mod/module":696,"./modules/interest.mod/module":701,"./modules/keep-watching.mod/module":704,"./modules/landing-page-collection.mod/module":708,"./modules/landing-tracking.mod/module":711,"./modules/landing-traits.mod/module":714,"./modules/learning-path.mod/module":720,"./modules/leon.mod/module":746,"./modules/lesson-list.mod/module":757,"./modules/lesson-transcript.mod/module":759,"./modules/line-item-tiles.mod/module":761,"./modules/linemove.mod/module":763,"./modules/link-to-catalog.mod/module":767,"./modules/live-now.mod/module":770,"./modules/material-list.mod/module":772,"./modules/modal.mod/module":774,"./modules/module-settings.mod/module":777,"./modules/my-classes.mod/module":779,"./modules/my-stuff.mod/module":781,"./modules/my-topics.mod/module":786,"./modules/onboarding.mod/module":795,"./modules/overflow-tooltip.mod/module":799,"./modules/owned-courses.mod/module":803,"./modules/page-footer.mod/module":805,"./modules/partner-row.mod/module":808,"./modules/partner.mod/module":811,"./modules/past-event.mod/module":813,"./modules/price-provider.mod/module":815,"./modules/price.mod/module":817,"./modules/product-card.mod/module":819,"./modules/product-view-history.mod/module":822,"./modules/product.mod/module":824,"./modules/progress-chart.mod/module":826,"./modules/quick-watch.mod/module":829,"./modules/quiz.mod/module":832,"./modules/recently-watched.mod/module":836,"./modules/reviews.mod/module":845,"./modules/rsvp-courses.mod/module":848,"./modules/saved-search-picker.mod/module":849,"./modules/saved-search-provider.mod/module":851,"./modules/saved-search-snapshot.mod/module":854,"./modules/scroll-to-anchor.mod/module":856,"./modules/scrollbar.mod/module":858,"./modules/search-autocomplete.mod/module":861,"./modules/segment.mod/module":867,"./modules/site-banner.mod/module":869,"./modules/sso-saml-integration/module":870,"./modules/student-snapshot.mod/module":874,"./modules/student-work.mod/module":877,"./modules/student.mod/module":880,"./modules/subscription-admin-menu-item.mod/module":883,"./modules/subscription-eligibility.mod/module":885,"./modules/subscription-invitation.mod/module":887,"./modules/subscription-provider.mod/module":888,"./modules/subscription-seat-management.mod/module":891,"./modules/subscription-snapshot.mod/module":893,"./modules/swimlanes.mod/module":897,"./modules/tags-manager.mod/module":899,"./modules/target.mod/module":900,"./modules/taxonomy.mod/module":902,"./modules/testimonials.mod/module":906,"./modules/thank-you.mod/module":908,"./modules/time.mod/module":912,"./modules/title.mod/module":914,"./modules/topic-editor.mod/module":917,"./modules/topic-hero.mod/module":921,"./modules/topic-list.mod/module":925,"./modules/topic-tile.mod/module":928,"./modules/track.mod/module":932,"./modules/tutorial.mod/module":934,"./modules/upcoming-classes.mod/module":941,"./modules/upcoming-event.mod/module":944,"./modules/upcoming-events.mod/module":946,"./modules/update-password.mod/module":948,"./modules/user-notifications.mod/module":950,"./modules/user-recommendations.mod/module":952,"./modules/user-scores.mod/module":954,"./modules/user-subscriptions.mod/module":956,"./modules/vertical-featured.mod/module":959,"./modules/vertical-search.mod/module":962,"./modules/video-player.mod/module":978,"./modules/watch-progress.mod/module":980,"./modules/welcome-header.mod/module":985,"./modules/welcome.mod/module":988,"./modules/wishlisted.mod/module":992}],282:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=this,s=(angular.extend(a,{onMobileClick:function(e){r.innerWidth<s&&(n.navAccountOpen=!n.navAccountOpen,n.navAccountOpen&&(e.preventDefault(),e.stopPropagation()))},hasConsumerSubscription:!1}),i.getSubscriptionsByUser({unverified:!0}).then(function(e){o.find(e,function(e){return"consumer"===e.type})&&(a.hasConsumerSubscription=!0)}),768);n.showAccountNav=!0,r.innerWidth<s&&e.on("click",function(){n.navAccountOpen&&(n.navAccountOpen=!1)}),n.activeView=t.routeParams&&t.routeParams.view||"profile"}r.$inject=["$document","$rootScope","$scope","$window","SubscriptionService","_"],t.exports=r},{}],283:[function(e,t,n){"use strict";function r(t,e,n){n.orderId=e.routeParams&&e.routeParams.id,e.$on("$locationChangeSuccess",function(){var e=t.path().split("/");"account"===e[1]&&"orders"===e[2]&&(n.orderId=e[3])})}r.$inject=["$location","$rootScope","$scope"],t.exports=r},{}],284:[function(e,t,n){"use strict";function r(i,o,e,r,d,f,p,a,t,n,s,h,m){var c=e.clStudentProviderKey||"clStudentData",g=(angular.element(t).on("resize",y),i.$on("account-tab-switched",function(e){e.preventDefault(),angular.element(t).off("resize",y)}),a.$on("interests:modal:close",function(e){d.getFollows(i[c].user._id).then(function(e){return i[c].followsData=e}).catch(function(e){})}),!1),u=this,v=(u.originalData=null,u.timezones=n.getTimezones(),angular.extend(u,{indicators:{},errors:{},isMobile:h.context.ua.mobile||t.innerWidth<768,saveProfile:_,saveSlug:function(n,t){var r;u.indicators[n]="",u.errors.ProfileWebAdderss="",t?u.originalData&&(r=function(e){e||(/[^\-A-Za-z0-9]+/.test(t)?u.errors.ProfileWebAdderss=s("i18n")("cl-settings-profile-web-address-illegal-token-error",'Sorry, your Profile Web Address may only include "-" character, lettes, and numbers.'):(u.indicators[n]="saving",a.user.updateUserAccount(i[c].user,function(e,t){l(n,e),o(function(){u.indicators[n]=""},2500)})))},i[c].user?i[c].user.slug!==u.originalData.user.slug?a.user.checkName(i[c].user.slug,function(e){e.success?"slug_used"===e.status?(u.errors.ProfileWebAdderss=s("i18n")("cl-settings-profile-web-address-taken-error","Sorry, this Profile Web Address is already taken."),r(e)):r(null,e):(u.errors.ProfileWebAdderss=e&&e.message,r(e))}):r(null,"same value"):r("no user")):u.errors.ProfileWebAdderss=s("i18n")("cl-settings-profile-web-address-empty-error","A Profile Web Address is required.")},saveTimezone:m.throttle(b,3e3,{leading:!1}),initializeGoogleApi:function(){var e,n;!g&&google&&(g=!0,e=document.getElementById("city-autocomplete"),(n=new google.maps.places.Autocomplete(e,{types:["(cities)"]})).addListener("place_changed",function(){var e,t=n.getPlace();t&&(i[c].profile.city=t.address_components[0].long_name,i[c].profile.country=t.address_components[t.address_components.length-1].long_name,i[c].profile.city&&(u.location=i[c].profile.city),i[c].profile.city&&i[c].profile.country&&(u.location+=", "),i[c].profile.country&&(u.location+=i[c].profile.country),e=t.geometry.location.lat(),t=t.geometry.location.lng(),p.getTimeZoneFromLocation(e,t).then(function(e){e.timeZoneId&&(i[c].user.timezone.name=e.timeZoneId,b(!0))}),_("location"))}))},googleAPI:"https://maps.googleapis.com/maps/api/js?libraries=places&key="+f(h,"config.google.app_api_key")}),a.initializedGoogleApiOnAccount||(e=document.getElementsByTagName("head"))&&e.length&&((e=e[0])&&((n=document.createElement("script")).setAttribute("src",u.googleAPI),n.setAttribute("type","text/javascript"),e.appendChild(n),a.initializedGoogleApiOnAccount=!0)),i.$watch(c,function(e){e&&e.profile&&(u.originalData||(u.originalData=angular.copy(e),u.ready=!0,e.profile.city&&(u.location=e.profile.city),e.profile.city&&e.profile.country&&(u.location+=", "),e.profile.country&&(u.location+=e.profile.country)),u.errors={},v())},!0));function y(e){u.isMobile=h.context.ua.mobile||t.innerWidth<768}function l(e,t){u.indicators[e]=t?"error":"saved"}function b(e){u.errors.timezone="",e?(u.indicators.timezone="saving",a.user.updateUserAccount(i[c].user,function(e,t){m.isObject(t.data.updateTimezone)&&!1===t.data.updateTimezone.success?(l("timezone",!0),u.errors.timezone=s("i18n")("cl-settings-profile-timezone-invalid-error","A valid timezone is required.")):(l("timezone",e),u.errors.timezone=""),o(function(){u.indicators.timezone=""},2500)})):u.errors.timezone=s("i18n")("cl-settings-profile-timezone-empty-error","A timezone is required.")}function _(n,e,t){!(u.indicators[n]="")===t&&!e||("first_name"!==n&&"last_name"!==n||((t=i[c].profile).display_name=t.last_name?t.first_name+" "+t.last_name:t.first_name),u.indicators[n]="saving",r.save(i[c],function(e,t){l(n,e),o(function(){u.indicators[n]=""},2500)}))}}r.$inject=["$scope","$timeout","$attrs","UserProfileService","StudentService","deepval","GoogleService","$rootScope","$window","TimezoneService","$filter","rind","_"],t.exports=r},{}],285:[function(e,t,n){"use strict";function r(t,r,n,i,o,e){var a=this,s=(angular.extend(a,{originalData:null,errors:{},indicators:{},resetPassword:function(){var e=t.clStudentData.user.primary_email.address;r.user.Auth.setUser({primary_email:{address:e}});r.$broadcast("reset:show",{settingsPage:!0})},saveEmailAddress:function(e){a.indicators.email="",a.errors.email="";if(e)return a.settingsForm.$valid?e===a.originalData.primary_email.address?(a.indicators.email="saved",void i(function(){a.indicators.email=""},2500)):(a.indicators.email="saving",void r.user.checkValidEmail(e).then(function(e){e.success&&(e.data&&e.data.user?(a.errors.email=n("i18n")("cl-settings-email-taken-error","Sorry, this Email Address is already taken."),a.indicators.email="error"):r.user.updateUserAccount(t.clStudentData.user,function(e,t){e&&(a.indicators.email="error");e=t&&t.data&&t.data.updateEmail;a.indicators.email=e.success?"saved":"error",i(function(){a.indicators.email=""},2500)}))})):(a.errors.email=n("i18n")("cl-settings-email-not-valid-error","Whoops! That's not an email address."),void(a.indicators.email="error"));a.errors.email=n("i18n")("cl-settings-email-empty-error","An Email Address is required."),a.indicators.email="error"},deleteAccount:function(){var e={templateUrl:"/templates/account/deleteAccountModal.html",windowClass:"cl-modal modal-delete-account",backdropClass:"bg-white",controller:["$scope","$uibModalInstance",function(e,t){function n(){t.dismiss()}angular.extend(e,{confirmDeleteAccount:function(){var e={templateUrl:"/templates/account/confirmDeleteAccountModal.html",windowClass:"cl-modal modal-delete-account",backdropClass:"bg-white",controller:["$scope","$uibModalInstance",function(t,e){angular.extend(t,{doDelete:function(){r.user.deleteUser().then(function(e){r.user.Auth.logout()}).catch(function(e){t.hasError=!0})},closeConfirmation:function(){e.dismiss()},typedEmail:"",actualEmail:r.user.get("primary_email").address.toLowerCase(),hasError:!1})}]};n(),o.open(e)},closeModal:n})}]};o.open(e)},showManagementOption:"true"===e.search().manage}),t.$watch("clStudentData",function(e){e&&e.user&&e.user._id&&(a.originalData||(a.originalData=angular.copy(t.clStudentData.user)),s())}))}r.$inject=["$scope","$rootScope","$filter","$timeout","$uibModal","$location"],t.exports=r},{}],286:[function(e,t,n){"use strict";function r(e,t,n,r,c,i,o,d,f){var a=this,i=i.context.ua.mobile||n.innerWidth<768;function s(e){e=angular.extend(e||{},{populateImage:!0,unverified:!0});o.getSubscriptionsByUser(e,!0).then(function(e){a.subscriptions=e.filter(function(e){return e.type&&"consumer"===e.type}).map(function(e){var t,n=l(e.product&&e.product.full_price,e.discounts),r=0===e.product.full_price,i=((n=n<0?0:n)<=0&&!r&&(t=[],angular.forEach(e.discounts,function(e){e.unlimitedCycles&&t.push(e)}),r=l(e.product&&e.product.full_price,t)<=0),e.subscriptionPlan),o=void 0,a=(r||("yearly"===i.billingFrequency?o="Billed Annually":"monthly"===i.billingFrequency&&(1!==i.requiredBillingCycle&&i.requiredBillingCycle?12===i.requiredBillingCycle&&(o="Annual Commitment. Billed Monthly"):o="Billed Monthly")),e.state);if(1<i.requiredBillingCycle&&("past_due"===a||"soft_failure"===a))for(var a="renewing",s=e.workflow_actions.length-1;0<=s;s--){var c=e.workflow_actions[s].type;if("renewing"===c||"nonrenewing"===c){a=c;break}}return Object.assign({},e,{renewalState:a,nonRenewable:i.nonRenewable,date:u(e.expiration),noBillingRequirement:1===i.requiredBillingCycle||!i.requiredBillingCycle,billingText:o,requiredExpiration:u(e.required_expiration),title:i.short_title,slug:i.slug,discountedPrice:n,total:e.product&&e.product.full_price,alwaysFree:r,image:i.image&&i.image.file,trialExpiration:e.trial&&e.trial.expiration&&u(e.trial.expiration),pastExpiration:0<Date.now()/1e3-e.expiration})})})}function u(e){return c.unix(e).format("MMM. Do, YYYY")}function l(t,e){return _.each(e,function(e){t=function(e,t){if(t&&"flat"===t.action_type)return e-t.amount;{var n;if(t&&"percent"===t.action_type)return n=e-e*t.amount/100,"discount"===t.source_type&&(50==n-100*Math.floor(n/100)&&(n=100*Math.floor(n/100)),n=100*Math.round(n/100)),"discount"===t.source_type?Math.round(n):n}return e}(t,e)}),t}angular.extend(a,{subscriptions:[],userId:e.clStudentData.user._id,isMobile:i,sendActivateEmail:function(){a.verifying=!0,a.errorMessage=void 0,o.sendActivateEmail(function(e,t){!e||429===e.status?a.type="success":417===e.status?(a.type="success",a.verifying=!1,a.verified=!0):(a.errorMessage=e.data&&e.data.message,a.type="danger",a.verifying=!1)})},verifyCancel:function(t){var e=a.subscriptions.find(function(e){return e._id===t}),e={expiration:e.date,subscription:e,trialActive:e.trial&&e.trial.active};r(e)}}),s(),t.$on("email-verified",function(){s({nocache:!0})}),angular.element(n).on("focus",function(){a.verifying&&t.user.getContext().then(function(e){e=d(e||{},"user.primary_email");e&&e.verified&&(a.verifying=!1,a.verified=!0,f(function(){a.verified=!1},3e3),t.$broadcast("email-verified"))})})}r.$inject=["$scope","$rootScope","$window","clAccountSubscriptionAutoRenewModal","moment","rind","SubscriptionService","deepval","$timeout"],t.exports=r},{}],287:[function(e,t,n){"use strict";r.$inject=["$rootScope","$location","$filter","CatalogService","SubscriptionPlanService","deepval"];var u=e("moment");function r(r,i,o,a,s,c){return{restrict:"AE",templateUrl:"/templates/account/orders-list.html",link:function(t,e,n){t.ordersList=[],t.hostUrl="https://"+i.host(),r.user.getOrders().then(function(e){return e.map(function(n){return e=(r=n).line_items.map(function(t){var e;return"subscriptionPlan"===c(t,"product.source.source_type")?(e=c(t,"product.source.source_id"),s.getSubscriptionPlanById(e).then(function(e){var t=void 0,n="gift"===r.order_type;return"yearly"===e.billingFrequency?"back-to-biz"!==e.slug&&(t=n?"1 Year Access":"Billed Annually"):"monthly"===e.billingFrequency&&(1===e.requiredBillingCycle?t=n?"1 Month Access":"Billed Monthly":12===e.requiredBillingCycle&&(t="Annual Commitment. Billed Monthly")),{title:e.short_title,image:e.image,billingText:t,href:o("linkToSource")(e&&e.product&&e.product.source)}}).catch(function(e){return{title:c(t,"product.short_title")}})):(e=t.product.course_id||t.product.bundle_id,a.getCourseById(e,null,{allow:"unpublished"}).then(function(e){return{title:e.title||e.short_title,instructors:e.instructors,image:e.image,href:o("linkToSource")(e)}}).catch(function(e){return{title:c(t,"product.short_title")}}))}),Promise.all(e).then(function(e){e=e.map(function(e){return{title:e.title||e.short_title,billingText:e.billingText,instructors:e.instructors,image:e.image,href:e.href}});return _.without(e,void 0)}).catch(function(e){}).then(function(e){return{id:n._id,orderPlaced:(t=n.created,u.unix(t).format("MMM Do, YYYY")),total:n.total,status:n.order_status,orderNumber:n.oid,lineItems:e,order_type:n.order_type};var t});var r,e})}).then(function(e){return Promise.all(e)}).then(function(e){t.ordersList=_.without(e,void 0).reverse()}).catch(function(e){})}}}t.exports=r},{moment:void 0}],288:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",templateUrl:"/templates/account/save-indicator.html",scope:{inputField:"="}}}},{}],289:[function(e,t,n){"use strict";var r=e("../../common/app");document.location.pathname.match(/^\/account/)&&r.config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0)}]),r.controller("clAccountController",e("./controllers/account")),r.controller("clAccountSettingsController",e("./controllers/settings")),r.controller("clAccountSubscriptionsController",e("./controllers/subscriptions")),r.controller("clOrdersController",e("./controllers/orders")),r.controller("clPrivateProfileController",e("./controllers/privateProfile")),r.service("clAccountSubscriptionAutoRenewModal",e("./services/subscriptionAutoRenewModal")),r.directive("clStudentOrders",e("./directives/orders")),r.directive("clAccountSaveIndicator",e("./directives/save-indicator"))},{"../../common/app":70,"./controllers/account":282,"./controllers/orders":283,"./controllers/privateProfile":284,"./controllers/settings":285,"./controllers/subscriptions":286,"./directives/orders":287,"./directives/save-indicator":288,"./services/subscriptionAutoRenewModal":290}],290:[function(e,t,n){"use strict";function r(n,r,s,e,i,c){return function(a){r.lock("subCancel");var e={templateUrl:"/templates/account/subscriptionAutoRenewModal.html",windowClass:"cl-modal modal-cl-subscription-renewal",backdropClass:"bg-white",controller:["$scope","$uibModalInstance",function(t,e){function o(){e.dismiss()}angular.extend(t,{updateSubscription:function(i){var e={subscriptionId:a.subscription._id,transition:i};s.updateSubscription(e,function(e){if(e.success){switch(i){case"renew":a.subscription.state="renewing",a.subscription.renewalState="renewing";break;case"cancel":if("past_due"===a.subscription.state||"soft_failure"===a.subscription.state){a.subscription.state="inactive";break}case"cancel-trial":if(a.trialActive){a.subscription.state="inactive",a.subscription.trial.active=!1;break}a.subscription.state="nonrenewing",a.subscription.renewalState="nonrenewing"}e=i,t=a.trialActive,n=a.subscription,"cancel-trial"===e&&(e="cancel"),r=n.subscriptionPlan&&n.subscriptionPlan.billingFrequency,t={isTrial:t,billingCycle:r,subscriptionId:n._id,subscriptionPlanSlug:n.subscriptionPlan&&n.subscriptionPlan.slug},c.trackSubscription(e,t)}var t,n,r;o()},function(e){t.trialCancellationFailed=!0})},closeModal:o,expiration:a.expiration,required_expiration:a.subscription.requiredExpiration,subscriptionState:i.clone(a.subscription.state),noBillingRequirement:a.subscription.noBillingRequirement,trialActive:a.trialActive}),t.showEnableDisableAutoRenew=!a.trialActive&&("renewing"===t.subscriptionState||"nonrenewing"===t.subscriptionState)}]};function t(e){r.unlock("subCancel"),0}n.open(e).result.then(t,t)}}r.$inject=["$uibModal","LockBody","Ecommerce","$location","_","trackFactory"],t.exports=r},{}],291:[function(e,t,n){"use strict";var d=e("moment");t.exports=["$rootScope","EventService","$window",function(c,u,l){return{restrict:"E",scope:{eventId:"=",eventEnd:"=?"},templateUrl:"/templates/add-to-calendar/link.html",replace:!0,link:function(t){function n(){t.eventEnd&&d().isAfter(d.unix(t.eventEnd).startOf("day"))?t.showAddToCalendarLink=!1:t.showAddToCalendarLink=!0}function e(e){return"/bff/event/"+t.eventId+"/"+e+"?source=web-link&user_uid="+c.user.get("uid")}function r(){l.open(e("apple"),"_self")}function i(){l.open(e("outlook"),"_self")}function o(){t.isMobile?l.open(e("android"),"_self"):s(e("google"),"Add to Google Calendar")}function a(){s(e("yahoo"),"Add to Yahoo Calendar")}function s(e,t){e=l.open(e,t,"height=800,width=1000");window.focus&&e.focus()}t.isMobile=!!rind.context.ua.mobile,t.showAddToCalendarLink=!0,!t.eventEnd&&t.eventId?u.getEventById(t.eventId).then(function(e){e&&(t.event=e,t.eventEnd=t.event.end_time,n())}):n(),t.openOutlookCalLink=i,t.openAppleCalLink=r,t.openGoogleCalLink=o,t.openYahooCalLink=a}}}]},{moment:void 0}],292:[function(e,t,n){"use strict";t.exports=[function(){return{scope:{},template:'<div ng-click="closeMobileCalMenu()" ng-transclude></div>',transclude:!0,replace:!0,link:function(e,t,n){e.closeMobileCalMenu=function(){try{document.querySelector("html").classList.remove("mobile-cal-menu-open")}catch(e){}}}}}]},{}],293:[function(e,t,n){"use strict";t.exports=[function(){return{scope:{},replace:!0,link:function(e,t,n){t.bind("click",function(e){e.preventDefault();try{document.querySelector("html").classList.toggle("mobile-cal-menu-open")}catch(e){}})}}}]},{}],294:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("addToCalendar",e("./directives/link")),r.directive("mobileCalMenuOff",e("./directives/menu-off")),r.directive("mobileCalMenuToggle",e("./directives/menu-toggle"))},{"../../common/app":70,"./directives/link":291,"./directives/menu-off":292,"./directives/menu-toggle":293}],295:[function(e,t,n){"use strict";t.exports=["$rootScope","UserService",function(a,s){return{restrict:"EA",templateUrl:"/templates/applicable-coupons/view.html",replace:!0,scope:{user:"=?"},link:function(t,e,n){var r=this,i=(angular.extend(t,{addCoupon:function(){t.couponToAdd&&(t.couponToAdd=t.couponToAdd.toUpperCase(),r.user.addApplicableCoupon([t.couponToAdd]).then(function(){o(),t.couponToAdd=""}))},removeCoupon:function(e){e&&r.user.removeApplicableCoupon(e).then(o)},couponToAdd:""}),r.user=a.user,o(),t.$watch("user._id",function(){t.user&&t.user._id&&(r.user=new s,r.user._data={user:t.user},o(),i())}));function o(){r.user&&r.user.get("_id")&&r.user.getApplicableCoupons().then(function(e){t.coupons=e,t.user.applicable_coupons=e})}a.$on("user:applicable_coupons:updated",function(){o()})}}}]},{}],296:[function(e,t,n){"use strict";e("../../common/app").directive("applicableCoupons",e("./directives/index"))},{"../../common/app":70,"./directives/index":295}],297:[function(e,t,n){"use strict";function r(e,r,t){return{restrict:"EA",templateUrl:"/templates/audio/cms-edit.html",replace:!0,link:function(t,e,n){angular.extend(t,{config:r,onUploadAudio:function(e){t.data.audioS3url="https://agc.creativelive.com/"+e.key}}),t.data||(t.data=t.$parent.data)}}}r.$inject=["$filter","config","_"],t.exports=r},{}],298:[function(e,t,n){"use strict";function r(r){return{restrict:"AE",scope:{data:"=?"},replace:!0,templateUrl:"/templates/audio/cms-view.html",link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data),e.data.containerClass=e.data.containerClass||"container"}}}r.$inject=["config"],t.exports=r},{}],299:[function(e,t,n){"use strict";function r(e,g){return{restrict:"AE",templateUrl:"/templates/audio/player.html",scope:{source:"=?"},link:function(n,t,e){var r=void 0,i=void 0;function o(e){r&&r.play().catch(function(e){})}function a(){r&&(r.pause(),n.settings.isPlaying=!1)}function s(){n.settings={ready:!1,isPlaying:!1,muted:!1,currentTime:"0:00",duration:"0:00",playbarStyle:{width:"0%"},loadbarStyle:{width:"0%"}},r&&(r.removeEventListener("durationchange",u),r.removeEventListener("timeupdate",l),r.removeEventListener("progress",f),r.removeEventListener("canplay",c),r.removeEventListener("play",d),r.removeEventListener("ended",p),g.off("audio-play-button",g.EVENTS.ENTER))}function c(){n.settings.ready=!0}function u(){n.settings.duration=h(r.duration)}function d(){n.settings.isPlaying=!0}function f(){var e=r.buffered.length;0<e&&(e=r.buffered.end(e-1),m("load",Math.ceil(e/r.duration*100)))}function l(){n.settings.currentTime=h(r.currentTime),m("play")}function p(){n.settings.isPlaying=!1}function h(e){var t=Math.floor(e/60),e=Math.floor(e-60*t);return t+":"+(e<10?"0"+e:""+e)}function m(e,t){r&&(t=t||r.currentTime/r.duration*100,n.$apply(function(){n.settings[e+"barStyle"].width=t+"%"}))}angular.extend(n,{pause:a,play:o,setTime:function(e){e.preventDefault(),r&&(r.removeEventListener("timeupdate",l),r.currentTime=e.offsetX/i*r.duration,n.settings.isPlaying||(e=Math.ceil(r.currentTime/r.duration*100),n.settings.playbarStyle.width=e+"%"))},setOnTimeChange:function(){r.addEventListener("timeupdate",l)},setVolume:function(){var e=!r.muted;r.muted=e,n.settings.muted=e}}),s(),n.$watch("source",function(e){e&&(e=e,s(),n.source=e,i=t[0].querySelector(".audio-progress").offsetWidth,(r=t[0].querySelector("audio")).addEventListener("durationchange",u),r.addEventListener("timeupdate",l),r.addEventListener("progress",f),r.addEventListener("canplay",c),r.addEventListener("play",d),r.addEventListener("ended",p),n.settings.muted=r.muted,g.on("audio-play-button",g.EVENTS.ENTER,function(){r&&(n.settings.isPlaying?a:o)()}))})}}}r.$inject=["$rootScope","keyboard"],t.exports=r},{}],300:[function(e,t,n){"use strict";function r(a,s,c,u,l,d,f){return{restrict:"AE",templateUrl:"/templates/audio/podcast.html",scope:{episodeNumber:"<",podcastTitle:"<",description:"<",image:"<",audioUrl:"<"},link:function(r,e,t){var n=f.context&&f.context.ua&&f.context.ua.os&&"iOS"===f.context.ua.os.family,i=-1!==f.context.uaString.indexOf("Trident/");function o(e){r.tooltip[e]=!0,c(function(){r.tooltip[e]=!1},2e3)}r.description=u.trustAsHtml(r.description),angular.extend(r,{id:function(){var e,t=r.episodeNumber+":"+r.podcastTitle,n={a:"|||",A:"|||",e:"||",E:"||",i:"||",I:"||",o:"|||",O:"|||",u:"|||",U:"|||",c:"",C:"",n:"",N:""};for(e in n)t=t.replace(new RegExp(n[e],"g"),e);return t.replace(/\s/g,"-")}(),hideDownload:n||i,tooltip:{copied:!1,downloaded:!1},copyToClipboard:function(){var e=s.absUrl(),t=e.indexOf("#");-1!==t&&(e=e.substring(0,t));t=document.createElement("textarea");t.value=e+"#"+r.id,t.style.display="absolute",t.style.left="9999px",t.style.top="9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),d.trackPodcast("permalink podcast",{podcast_url:r.audioUrl,title:r.podcastTitle}),o("copied")},isIOS:n,download:function(){d.trackPodcast("download podcast",{podcast_url:r.audioUrl,title:r.podcastTitle}),o("downloaded")},play:function(){d.trackPodcast("play podcast",{podcast_url:r.audioUrl,title:r.podcastTitle}),a.$broadcast("audio:show-modal",{source:r.audioUrl})}}),e.ready(function(){l()}),r.$on("audio:show-modal",function(e,t){t&&(r.activePodcast=t.source===r.audioUrl)}),r.$on("audio:close-modal",function(e){return r.activePodcast=!1})}}}r.$inject=["$rootScope","$location","$timeout","$sce","$anchorScroll","trackFactory","rind"],t.exports=r},{}],301:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("podcastCms",e("./directives/cms/view")),r.directive("podcastCmsEdit",e("./directives/cms/edit")),r.directive("clAudioPlayer",e("./directives/player")),r.directive("clPodcast",e("./directives/podcast")),r.service("clAudioPlayerModal",e("./services/player-modal"))},{"../../common/app":70,"./directives/cms/edit":297,"./directives/cms/view":298,"./directives/player":299,"./directives/podcast":300,"./services/player-modal":302}],302:[function(e,t,n){"use strict";function r(r,i){var o=void 0,a=void 0;return function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};function n(){a&&(a.style.bottom="1%"),r.$broadcast("audio:close-modal"),o=void 0}o?r.$broadcast("audio-player:set-opts",t):(e={templateUrl:"/templates/audio/modal.html",windowClass:"cl-audio-modal",backdrop:!1,controller:["$scope","$uibModalInstance",function(n,e){n.source=t.source,n.close=function(){e.dismiss()},n.$on("audio-player:set-opts",function(e,t){angular.extend(n,{source:t.source})}),(a=document.querySelector(".zls-btnmn"))&&(a.style.bottom="55px")}]},(o=i.open(e)).result.then(n,n))}}r.$inject=["$rootScope","$uibModal"],t.exports=r},{}],303:[function(e,t,n){"use strict";t.exports=["$window",function(i){return{restrict:"AE",scope:{link:"=?",action:"=?"},transclude:!0,replace:!0,priority:-1,templateUrl:function(e,t){return"/templates/back/"+(t.template||"link")+".html"},controllerAs:"ctrl",controller:["$scope",function(e){var t=this,n=e.$watchGroup(["link","action"],function(e){(e[0]||e[1])&&(angular.extend(t,{link:e[0],action:e[1]||r}),n())});function r(e){t.link?e.stopPropagation():(e.preventDefault(),2<i.history.length?angular.isFunction(i.history.back)?i.history.back():i.history.go(-1):i.location.href="/")}t.action||(t.action=r)}]}}]},{}],304:[function(e,t,n){"use strict";e("../../common/app").directive("clBack",e("./directive"))},{"../../common/app":70,"./directive":303}],305:[function(e,t,n){"use strict";function r(s,c,u,e,l,d,f,p,h,m,g){return{restrict:"AE",scope:{position:"="},templateUrl:function(e,t,n){if(""===e.html()&&!t.disableTemplate)return"/templates/banner-top/view.html";this.replace=!1},replace:!0,transclude:!0,link:function(t,e,n){var r=c&&c.dump;function i(){return t.banner?{cta_label:t.banner.ctaText,targets:t.banner.targets,cta_module:"banner_top",label:t.banner.text,color:t.banner.color,banner_id:t.banner._id}:{}}function o(){t.banner&&t.banner.url&&(t.bannerUrl=u("addQueryParams")(t.banner.url,{via:"header-banner_-1"}))}function a(){r&&s.getCurrentBanner().then(function(e){e?e!==t.banner&&(t.banner=e,t.banner.text=m.getTrustedHtml(t.banner.text),t.banner.timer&&t.banner.timer.enable&&"trait"===t.banner.timer.type&&(t.banner.timer.time=l.user.getTrait(t.banner.timer.trait)),t.banner.timer&&t.banner.timer.enable&&"user-props"===t.banner.timer.type&&f.get(t.banner.timer.props).then(function(e){t.banner.timer.shift&&(e=p(1e3*e).add(t.banner.timer.num_time,t.banner.timer.type_time).unix()),t.banner.timer.time=e}),t.banner.timer&&t.banner.timer.enable&&"fixed"===t.banner.timer.type&&((e=h.Session.get("fixed_timer_"+t.banner._id))||(e=p().add(t.banner.timer.num_time,t.banner.timer.type_time).unix(),h.Session.set("fixed_timer_"+t.banner._id,e)),t.banner.timer.time=e),o(),t.banner&&t.banner.selectedType&&"hero"!==t.banner.selectedType&&(t.ready=!0),d.track("Banner Top Impression",i()),t.ready&&g(function(){l.$emit("banner:ready",t.banner)})):(t.banner=void 0,t.ready=!1)})}t.iosSmartBannerIsShowing=function(){var e=c&&c.context&&c.context.ua,t=c.config&&c.config.smartbanner;if(!t||!e)return!1;e=e.os,t=Number(t.minMajorVersion);if(e&&"iOS"===e.family&&Number(e.major)>=t)return!0;return!1}(),l.$on("user:login",a),l.$on("user:addSubscription",a),l.$on("user:register",a),l.$on("cart:updated",a),l.$on("$locationChangeSuccess",a),n.bannerId?s.getById(n.bannerId).then(function(e){t.banner=e,o(),t.banner&&"hero"!==t.banner.selectedType&&(c.context&&c.context.pathname.includes("/checkout")&&!t.banner.targeting.checkout?t.ready=!1:t.ready=!0)}):a(),t.onClickBanner=function(){d.track("Banner Top Click",i())}}}}r.$inject=["BannerService","rind","$filter","deepval","$rootScope","AnalyticsService","UserDateService","moment","Vault","$sce","$timeout"],t.exports=r},{}],306:[function(e,t,n){"use strict";e("../../common/app").directive("bannerTop",e("./directives/view"))},{"../../common/app":70,"./directives/view":305}],307:[function(e,t,n){"use strict";t.exports=["$rootScope",function(r){return{restrict:"AE",templateUrl:"/templates/banner/creator-pass.html",replace:!0,link:function(e,t,n){e.hasCreatorPass=r.user.hasCreatorPassSubscription(),e.hasActiveConsumerSubscription=r.user.hasActiveConsumerSubscription()}}}]},{}],308:[function(e,t,n){"use strict";t.exports=["$window","$document",function(r,i){return{restrict:"E",transclude:!0,replace:!0,templateUrl:"/templates/banner/fixed.html",link:function(e,t,n){r.addEventListener("scroll",function e(){t.removeClass("pristine");r.removeEventListener("scroll",e)}),i[0].body.classList.contains("mobile")||i[0].body.appendChild(t[0])}}}]},{}],309:[function(e,t,n){"use strict";var a=e("moment");t.exports=["EventService","$rootScope",function(n,o){return{restrict:"AE",templateUrl:"/templates/banner/rsvp-course.html",scope:{course:"="},link:function(i,e,t){angular.extend(i,{hasContent:function(){return!!i.product&&o.user.hasContent("enrolled",i.product.type,i.product._id)},product:null}),i.$watch("course",function(e){i.course&&i.course._id&&n.getCurrentEventsByCourseId(i.course._id).then(function(e){var t,n,r;i.event=e,i.event&&i.event.is_container&&(i.is_container=i.event.is_container,i.event.product&&(i.product={_id:i.event.product.source.source_id._id,type:i.event.product.source.source_type,nid:i.event.product.source.nid,product:i.event.product}),i.date=(e=a.unix(i.event.start_time).format("MMM"),t=a.unix(i.event.end_time).format("MMM"),n=a.unix(i.event.start_time).format("D"),r=a.unix(i.event.end_time).format("D"),e===t?n===r?e+" "+n:e+" "+n+" - "+r:e+" "+n+" - "+t+""+r),o.user&&o.user.hasContent&&(i.owned=o.user.hasContent("purchased","courses",i.course._id),!1===i.owned&&o.user.hasRole("owns_all_courses")&&(i.owned=!0,i.comped=!0),i.$applyAsync()))})})}}}]},{moment:void 0}],310:[function(e,t,n){"use strict";t.exports=["config",function(r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/banner/rsvp-edit.html",replace:!0,link:function(t,e,n){t.config=r,t.data||(t.data=t.$parent.data),t.data.event||(t.data.event={}),t.event=angular.copy(t.data.event),t.addEvent=function(e){t.data.event=e,t.data.event={_id:e._id,title:e.title}},t.removeEvent=function(){t.data.event={}}}}}]},{}],311:[function(e,t,n){"use strict";var a=e("moment");t.exports=["config","EventService","$rootScope",function(n,r,o){return{restrict:"AE",templateUrl:"/templates/banner/rsvp.html",scope:{data:"=?"},replace:!0,link:function(i,e,t){i.config=n,i.isAdmin="true"===t.isAdmin,angular.extend(i,{hasContent:function(){return!!i.product&&o.user.hasContent("enrolled",i.product.type,i.product._id)},isUpcoming:function(){return!!i.event&&a.unix(i.event.end_time).unix()>a().unix()},product:null}),i.data||(i.data=i.$parent&&i.$parent.data),i.data.event._id&&i.$watch("data.event",function(e){r.getEventById(i.data.event._id).then(function(e){var t,n,r;i.event=e,i.product={_id:i.event.product.source.source_id._id,type:i.event.product.source.source_type,nid:i.event.product.source.nid,product:i.event.product},i.date=(e=a.unix(i.event.start_time).format("MMM"),t=a.unix(i.event.end_time).format("MMM"),n=a.unix(i.event.start_time).format("D"),r=a.unix(i.event.end_time).format("D"),e===t?n===r?e+" "+n:e+" "+n+" - "+r:e+" "+n+" - "+t+""+r)})})}}}]},{moment:void 0}],312:[function(e,t,n){"use strict";var p=e("moment");t.exports=["$rootScope","$timeout","Vault",function(l,d,f){return{restrict:"AE",templateUrl:"/templates/banner/terms.html",replace:!0,link:function(n,u,e){var r,i=e.bannerTermsStart&&""!==e.bannerTermsStart&&p(e.bannerTermsStart).hours(0).minutes(0).seconds(0),o=e.bannerTermsEnd&&""!==e.bannerTermsEnd&&p(e.bannerTermsEnd).hours(0).minutes(0).seconds(0),a={};function t(){var e,t=p();i&&i.isBefore(t)&&o&&o.isAfter(t)&&(n.showTermsBanner=!0,r="terms-"+i.format("YYYY-MM-DD"),a[r]=!0,t=f.Session.get("first_time_user")||!1,e=l.user&&l.user.hasTraits(a),n.showTermsBanner=!t&&!e)}function s(){a[r]&&l.user&&(l.user.setTraits(a),angular.element(document.querySelector(".banner-terms")).addClass("hide-terms"),c(),d(function(){n.showTermsBanner=!1},301))}function c(){r&&a[r]&&l.user&&l.user.addTraits([r])}n.onTermsClick=s,l.$on("user:login",function(){d(t,300)}),l.$on("user:register",function(){s(),c()}),t()}}}]},{moment:void 0}],313:[function(e,t,n){"use strict";t.exports=["TaxonomyService","ScoresService","$location","$filter",function(c,i,u,o){return{restrict:"AE",scope:{},link:function(n,t,e){var a=new i;function s(e){e&&e.image&&e.image.key?(e=o("magick")(e.image.key,{width:1440}),t.css("background-image",'url("'+e+'")')):t.css("background-image","url(data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=)")}function r(e){var t,n="",r="",i=u.path();function o(e){var t={categories:[],topics:[]};e.primary_category?(t.categories.push(e.primary_category),t.topics.push(e._id)):t.categories.push(e._id),a.engagement(t)}(r=e||i.replace(/[/]catalog[/]/,"")).indexOf("/")&&(t=(e=r.split("/"))[1],n=e[0]),"all-classes"!==n&&"all-lessons"!==n||(n=""),(t="all-classes"!==t&&"all-lessons"!==t?t:"")&&n?c.getTopicBySlugAndCategory(n,t).then(function(e){s(e),o(e)}).catch(function(e){}):n?c.getCategoryBySlug(n).then(function(e){s(e),o(e)}).catch(function(e){}):s({image:{key:"agc/banners/Catalog_Banner__0007_AllCatalog_General_MattMcMonagle-5829.jpg"}})}r(),n.$on("CatalogSearch:changedChannel",function(e,t){n.imageUrl=void 0,n.altText="",r(t)})}}}]},{}],314:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("bannerFixed",e("./directives/fixed")),r.directive("bannerRsvp",e("./directives/rsvp")),r.directive("bannerRsvpCourse",e("./directives/rsvp-course")),r.directive("bannerRsvpEdit",e("./directives/rsvp-edit")),r.directive("bannerTerms",e("./directives/terms")),r.directive("bannerTopic",e("./directives/topic")),r.directive("bannerCreatorPass",e("./directives/creator-pass"))},{"../../common/app":70,"./directives/creator-pass":307,"./directives/fixed":308,"./directives/rsvp":311,"./directives/rsvp-course":309,"./directives/rsvp-edit":310,"./directives/terms":312,"./directives/topic":313}],315:[function(e,t,n){"use strict";t.exports=["BlogService","ScoresService","moment",function(t,e,r){return{restrict:"AE",scope:{magickFilterWidth:"@?"},templateUrl:"/templates/blog-post/view.html",replace:!0,link:function(n){(new e).fetchSortedCategories(function(e){t.getPosts({limit:5,category:e[0]._id}).then(function(e){var t;e&&e.length&&(t=Math.floor(Math.random()*e.length),e[0].date>r().subtract(7,"days").unix()&&(t=0),n.post=e[t])})})}}}]},{}],316:[function(e,t,n){"use strict";e("../../common/app").directive("blogPost",e("./directives/view"))},{"../../common/app":70,"./directives/view":315}],317:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){return e&&e.length&&t&&t.length?e.filter(function(e){return!!e.categories&&e.categories.filter(function(e){return 0<=t.indexOf(e)}).length===t.length}):e}}},{}],318:[function(e,t,n){"use strict";t.exports=["config","BlogService",function(r,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/blog-posts/edit.html",replace:!0,link:function(t,e,n){t.config=r,t.data||(t.data=t.$parent.data),angular.isArray(t.data.categories)||(t.data.categories=[]),i.getCategories().then(function(e){t.categories=e})}}}]},{}],319:[function(e,t,n){"use strict";t.exports=["config","BlogService","trackFactory","$filter","$q","_",function(o,a,s,c,u,l){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/blog-posts/view.html",replace:!0,link:function(t,e,n){var r,i;t.config=o,t.data||(t.data=t.$parent.data),t.data.categories&&t.data.categories.length?(i=[],l.each(t.data.categories,function(e){i.push(a.getPostsByCategory(e))}),u.all(i).then(function(e){r=l.flatten(e),t.postList=c("limitTo")(r,t.data.maxPosts)})):a.getPosts().then(function(e){r=c("categoriesFilter")(e,t.data.categories),r=c("limitTo")(r,t.data.maxPosts),t.postList=r}),t.track=function(){s.clickExternalLink(t.data.title,"thumbnail","Blog",n.clModuleId)}}}}]},{}],320:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("blogPosts",e("./directives/view")),r.directive("blogPostsEdit",e("./directives/edit")),r.filter("categoriesFilter",e("./categoriesFilter"))},{"../../common/app":70,"./categoriesFilter":317,"./directives/edit":318,"./directives/view":319}],321:[function(e,t,n){"use strict";var r=e("moment"),i=e("underscore");t.exports=function(){return{restrict:"AE",replace:!0,scope:{startTime:"=?",endTime:"=?",monthFormat:"@",dayFormat:"@",yearFormat:"@",fullFormat:"@",separator:"@"},transclude:!0,templateUrl:"/templates/broadcast-time/view.html",link:function(t){angular.extend(t,{monthFormat:t.monthFormat||"MMM",dayFormat:t.dayFormat||"dd",yearFormat:t.yearFormat||"yyyy",separator:t.separator||"-"}),t.fullFormat=t.fullFormat||t.monthFormat+" "+t.dayFormat+", "+t.yearFormat;var n=t.$watchCollection("[startTime, endTime]",function(e){i.contains(e,void 0)||(t.multiMonth=!r.unix(e[0]).isSame(r.unix(e[1]),"month"),n())})}}}},{moment:void 0,underscore:void 0}],322:[function(e,t,n){"use strict";e("../../common/app").directive("broadcastTime",e("./directive"))},{"../../common/app":70,"./directive":321}],323:[function(e,t,n){"use strict";t.exports=["bundle",function(i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/bundle-courses/edit.html",replace:!0,link:function(t,e,n,r){t.data||(t.data=t.$parent.data),t.addBundle=function(e){i.getPopulated({slug:e.slug},function(e){e.data&&(e={_id:e.data._id,image:e.data.image.file.key,title:e.data.title,short_title:e.data.short_title},t.data.bundle=e)})},t.removeBundle=function(e){t.data={}}}}}]},{}],324:[function(e,t,n){"use strict";var a=e("underscore");t.exports=["bundleResource","$filter",function(i,o){return{restrict:"AE",replace:!0,scope:{bundleId:"@",bundleSlug:"@",imageWidth:"@"},templateUrl:"/templates/bundle-courses/view.html",link:function(t){var n=500;function e(e){e&&e.data&&e.data.courses&&(e=e.data.courses,a.each(e,function(e){e.image&&e.image.file&&(e.imageUrl=o("magick")(e.image.file.key,{width:t.imageWidth||n}))}),t.bundleCourses=e)}function r(e){}t.bundleId?i.findById({id:t.bundleId},e,r):t.bundleSlug&&i.findBySlug({slug:t.bundleSlug},e,r)}}}]},{underscore:void 0}],325:[function(e,t,n){"use strict";t.exports=["bundleResource",function(o){return{restrict:"AE",replace:!0,scope:{data:"=?"},templateUrl:"/templates/bundle-courses/view.html",link:function(n,e,t,r,i){n.data||(n.data=n.$parent.data),n.$watch("data.bundle",function(e,t){e&&(e=e._id,o.findById({id:e},function(e){e&&(n.bundleCourses=e.data.courses)},function(e){}))},!0)}}}]},{}],326:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("bundleCourses",e("./directives/view")),r.directive("bundleCoursesEdit",e("./directives/edit")),r.directive("bundleCoursesList",e("./directives/list"))},{"../../common/app":70,"./directives/edit":323,"./directives/list":324,"./directives/view":325}],327:[function(e,t,n){"use strict";t.exports=["$filter",function(r){return{restrict:"AE",replace:!0,scope:{bundles:"="},templateUrl:"/templates/bundles/list.html",controllerAs:"bundlesListCtrl",controller:["$scope","$attrs",function(t,e){var n=t.$watch("bundles",function(e){e&&(_.each(t.bundles,function(e){e.image&&e.image.file&&(e.imageUrl=r("magick")(e.image.file.key,{width:380}))}),n())})}]}}]},{}],328:[function(e,t,n){"use strict";t.exports=["$rootScope","CatalogService","BundleService",function(l,d,f){return{restrict:"A",link:function(n,u,r){var i=[],o=(angular.forEach(["clBundleId","clBundleIds","clBundleSlug","clBundleNid","clProductId","clCourseId","showOnlyPurchasable"],function(e){e=r.$observe(e,a);i.push(e)}),r.clBundleKey||"bundleData"),e={},t={};try{e=JSON.parse(r.clCourseOpts)}catch(e){}try{t=JSON.parse(r.clCourseParams)}catch(e){}function a(){r.clBundleId?d.getCourseById(r.clBundleId,e,t).then(s).catch(c):r.clBundleIds?d.getCoursesByIds(r.clBundleIds.split(","),e,t).then(s).catch(c):r.clBundleSlug?d.getCourseBySlug(r.clBundleSlug,e,t).then(s).catch(c):r.clBundleNid?d.getCourseByNid(r.clBundleNid,e,t).then(s).catch(c):r.clProductId?d.getCourseByProduct(r.clProductId,e,t).then(s).catch(c):r.clCourseId&&f.findByCourseId(r.clCourseId,t,e).then(s).catch(c),n.bundleAnalytics=l.analytics}function s(e){var t=angular.isArray(e);t||(e=[e]),r.clBundleType&&(e=_.filter(e,function(e){return e.type===r.clBundleType})),"true"!==r.clBundleProviderAllowPromotional&&(e=_.reject(e,function(e){return!0===(e.flagged||{}).promotional})),"true"!==r.clBundleProviderAllowUnpublished&&(e=_.reject(e,function(e){return!1===(e.flagged||{}).published})),t||(e=e[0]),"true"===r.showOnlyPurchasable&&(e=_.reject(e,function(e){return!1===e.flagged.for_sale})),n[o]=e,r.clDebug,"true"!==r.watch&&angular.forEach(i,function(e){e()})}function c(e){}}}}]},{}],329:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("bundlesList",e("./directives/list")),r.directive("clBundleProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/list":327,"./directives/provider":328}],330:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"A",link:function(e,t,n){angular.extend(e,{dayMonthFormat:n.clCallToAudienceDayMonthFormat||"dddd, MMM Do",dayFormat:n.clCallToAudienceDayFormat||"dddd, Do",hourFormat:n.clCallToAudienceHourFormat||"h::mm a",title:n.clCallToAudienceTitle||"Join the studio audience",ctaText:n.clCallToAudienceCtaText||"Click Here"}),n.clDebug}}}]},{}],331:[function(e,t,n){"use strict";e("../../common/app").directive("clCallToAudience",e("./directives/index"))},{"../../common/app":70,"./directives/index":330}],332:[function(e,t,n){"use strict";t.exports=["$compile",function(i){return{restrict:"E",scope:{clSlide:"="},template:'<div ng-bind-html="clSlide.content"></div>',link:function(t,n,e,r){t.$watch("clSlide.content",function(){try{var e=angular.element(t.clSlide.content);n.empty().append(e),i(e)(t)}catch(e){t.$parent.edit}})}}}]},{}],333:[function(e,t,n){"use strict";e("../../common/app").directive("carouselSlide",e("./directives/view"))},{"../../common/app":70,"./directives/view":332}],334:[function(e,t,n){"use strict";var l=e("deepval");t.exports=["config","courseResource","arrayMove","constants","moment",function(o,a,s,c,u){return{restrict:"AE",templateUrl:"/templates/carousel/edit.html",replace:!0,link:function(r,e,t){angular.extend(r,{config:o,addSlide:function(){r.data.slides.push({}),i()},addStartAndEndTimes:function(e){var t=u().tz("America/Los_Angeles").hours(8).startOf("hour");e.start=t.unix(),e.end=t.add(1,"week").unix()},removeStartAndEndTimes:function(e){delete e.start,delete e.end},removeSlide:function(e){r.data.slides.splice(e,1),i()},getCurrentSlide:function(e){var t=r.data.slides[r.data.currentSlideIndex];return e?t[e]:t},dropSlide:function(e,t,n){s(e,t,n),r.data.currentSlideIndex=n,r.$apply()},onUpload:function(e){r.data.slides[r.data.currentSlideIndex].image={key:e.key,bucket:r.config.agc.folder}},uploadFreeform:function(e){var t=r.data.slides[r.data.currentSlideIndex];t.freeformImages=t.freeformImages||[],t.freeformImages.push(r.cdn+e.key)},setBackgroundImageFromCourse:function(e){a.findBySlug({slug:e.slug},function(e){var e=e&&e.data||e,t=r.data.slides[r.data.currentSlideIndex];e&&e.image&&e.image.file&&(t.image={key:l(e,"image.file.key"),bucket:r.config.agc.folder})})},copyLink:function(e){try{var t=document.createRange();t.selectNode(e.currentTarget),window.getSelection().addRange(t),document.execCommand("copy")}catch(e){}},themes:{white:"Light Text",black:"Dark Text"}}),r.constants=c,r.data.interval=r.data.interval||5;var n=o.hostname;function i(){r.data.slides&&(r.maxReached=10===r.data.slides.length,r.data.currentSlideIndex=r.data.slides.length-1)}r.cdn=n.protocol+"://"+o.cdn.agc+"/",i()}}}]},{deepval:38}],335:[function(e,t,n){"use strict";t.exports=["$sce",function(e){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/carousel/view.html",replace:!0,link:function(e,t,n){e.data||(e.data=e.$parent.data),e.data.slides||(e.data.slides=[])}}}]},{}],336:[function(e,t,n){"use strict";var l=e("underscore"),d=e("deepval");t.exports=["$rootScope","$timeout","moment",function(s,c,u){return{restrict:"AE",scope:{editIndex:"=?",slides:"=",interval:"="},templateUrl:"/templates/carousel/index.html",link:function(n,t,e){function r(){var e=o(),e=(n.currentIndex>=e.length?n.currentIndex=0:n.currentIndex<0&&(n.currentIndex=e.length-1),e[n.currentIndex]);e&&e.headerTheme&&(s.headerTheme=e.headerTheme,s.$applyAsync())}var i;function o(){return l.filter(n.slides,function(e){if(!e.start&&!e.end)return!0;var t=u().tz("America/Los_Angeles").unix();return e.start<=t&&e.end>t})}function a(){return d(n,"$parent.$parent.edit.editing")}angular.extend(n,{getActiveSlide:function(e,t){return a()?n.editIndex===t:e},getCurrentSlides:function(){return a()?n.slides:o()},onUserNav:function(e){n.currentIndex=e,r(),n.sliding=!0,i&&c.cancel(i);i=c(function(){n.sliding=!1},500)},currentIndex:0,sliding:!1}),r(),t.bind("slide.bs.carousel",function(){if(!n.sliding)try{var e=angular.element(t[0].querySelector(".carousel-inner .item.active")).attr("index");n.currentIndex=++e,r()}catch(e){}})}}}]},{deepval:38,underscore:void 0}],337:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clCarousel",e("./directives/index")),r.directive("carouselCms",e("./directives/cms/view")),r.directive("carouselCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":334,"./directives/cms/view":335,"./directives/index":336}],338:[function(e,t,n){"use strict";function r(r,i,e,t,o,a){var n;"true"===i.initWithCourses?n=r.$watch("courses",function(e){e&&e.length&&(r.hasCustomTopics=_.isArray(r.customTopics)&&0<r.customTopics.length,o.initializeWithCourses(e,r.customTopics),n())}):"true"===i.initWithTaxonomy?o.initializeWithTaxonomy():o.initialize(),angular.extend(r,{getCategoryLink:function(e,t){var n=e.category,e=e.topic;return o.getLink({category:n,topic:e},t)},containerStyle:i.containerStyle||"btn-group-switch",btnStyle:i.btnStyle||"btn btn-tag btn-switch btn-link",labelAll:i.labelAll||t("i18n")("onair-filter-broadcast-types-all","All"),labelLive:i.labelLive||t("i18n")("onair-filter-broadcast-types-live","Live"),expendedMobileMenu:!1}),o.onReady(function(){r.categories=o.categories,r.categoryIndex=o.categoryIndex,r.topicIndex=o.topicIndex,r.categoryById=o.categoryById,r.topicById=o.topicById}),r.onSelect=function(e,t,n){e&&e.preventDefault(),r.filtersOpen=!1,i.module&&(e="",t&&(e=r.categoryIndex[t]),n&&(e=r.topicIndex[t+"_"+n]),a.interact(i.module,e,"sidebar")),o.onSelect(null,t,n)},r.onClickCategory=function(e,t){e?(e.preventDefault(),t===r.urlCategory?o.onSelect(null,""):o.onSelect(null,t)):r.expendedMobileMenu=!r.expendedMobileMenu}}r.$inject=["$scope","$attrs","$location","$filter","CategoryFilterService","CatalogAnalyticsService"],t.exports=r},{}],339:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",transclude:!0,templateUrl:function(e,t){return"/templates/category-filters/"+(t.template||"combined")+".html"},controller:"CategoryFiltersController"}}},{}],340:[function(e,t,n){"use strict";t.exports=["CategoryFilterService",function(r){return{restrict:"AE",controller:["$scope",function(e){function t(){e.urlCategory=r.urlCategory,e.urlTopic=r.urlTopic,e.urlBroadcastType=r.urlBroadcastType,e.urlCategoryTitle=r.urlCategoryTitle}r.onReady(t),r.onChange(t)}],link:function(e,t,n){n.baseUrl&&(r.baseUrl=n.baseUrl||"/onair"),!1!==e.deepLinking&&(r.deepLinking=!0)}}}]},{}],341:[function(e,t,n){"use strict";var r=e("../../common/app");r.config(["$routeProvider","$locationProvider",function(e,t){var n;!window.rind||window.rind.dump||(n=window.rind.dump.data)&&n.flags&&n.flags.html5_mode&&!document.location.pathname.match(/^\/admin/)&&t.html5Mode(!0)}]),r.service("CategoryFilterService",e("./services/index")),r.directive("categoryFilters",e("./directives/index")),r.directive("categoryFiltersProvider",e("./directives/provider")),r.directive("onairFilters",e("./directives/index")),r.directive("onairFiltersProvider",e("./directives/provider")),r.controller("CategoryFiltersController",e("./controllers/categoryFiltersController"))},{"../../common/app":70,"./controllers/categoryFiltersController":338,"./directives/index":339,"./directives/provider":340,"./services/index":342}],342:[function(e,t,n){"use strict";function r(t,d,f,e,p,i,h,s){var n=!1,c=this,r=new t;function o(){g(),f.$on("$locationChangeSuccess",function(e,t){g();var n={urlCategory:c.urlCategory,urlTopic:c.urlTopic,urlBroadcastType:c.urlBroadcastType};angular.forEach(c._onChange,function(e){e(n)})}),m()}function a(e,a,t){e=s.reduce(e,function(e,t){var n,r,i,o=t.primary_category.slug;return c.categoryIndex[o]||(c.categoryIndex[o]=t.primary_category,c.categoryIndex[o].courses=[],e.push(c.categoryIndex[o])),c.categoryIndex[o].courses.push(t._id),n=t,r=o,i=a,s.each(n.taxonomy,function(e){(!s.isArray(i)||0<=s.pluck(i,"topic").indexOf(e._id))&&u(e,r).courses.push(n._id)}),s.each(c.topicIndex,function(e){c.topicById[e._id]=e}),e},[]);s.each(e,function(e){c.categoryById[e._id]=e}),s.each(e,function(n){s.each(n.topics,function(e){var t=n.slug+"_"+e.slug;c.topicIndex[t]&&(e.courses=c.topicIndex[t].courses)})}),c.categories=r.getSortedCategories(e),t()}function u(e,t){t=t+"_"+e.slug;return c.topicIndex[t]||(e={_id:e._id,slug:e.slug,path:e.path,name:e.name,image:e.image,seo_header:e.seo_header||e.name,featured:e.flags.featured,courses:[]},c.topicIndex[t]=e),c.topicIndex[t]}function m(){c.ready=!0,angular.forEach(c._onReady,function(e){e(c)})}function g(){var e=(i.path()||p.location.pathname).replace(c.baseUrl,"").split("/"),t=s.findWhere(c.categories,{slug:e[1]||""}),n=c.topicIndex[e[1]+"_"+e[2]];t&&(c.urlCategory=t.slug,c.urlCategoryTitle=t.title),n?(c.urlTopic=n.slug,c.urlTopicTitle=n.title,n.featured||(t.seeAll=!0)):(c.urlTopic="",c.urlTopicTitle=""),t&&t.slug||(c.urlCategory="",l(e[1])),void 0!==e[2]&&l(e[2])}function l(e){c.urlBroadcastType="live"===e?"live":""}s.extend(c,{ready:!1,baseUrl:"/onair",urlBroadcastType:e.broadcastType||"",urlCategory:e.category||"",urlTopic:e.topic||"",deepLinking:!1,categories:[],categoryIndex:{},categoryById:{},topicIndex:{},topicById:{},_onReady:[],onReady:function(e){c.ready?m():c._onReady.push(e)},_onChange:[],onChange:function(e){c._onChange.push(e)},onSelect:function(e,t,n){e&&e.preventDefault();var e=c.categoryIndex[t],t=c.topicIndex[t+"_"+n],r=(c.urlCategory=e?e.slug:"",c.urlTopic=t?t.slug:"",c.urlCategoryTitle=e?e.title:"",{urlCategory:c.urlCategory,urlTopic:c.urlTopic,urlBroadcastType:l()});angular.forEach(c._onChange,function(e){e(r)}),c.deepLinking&&i.path(c.getLink({category:c.urlCategory,topic:c.urlTopic})).search("page",null).search("page-lessons",null)},getLink:function(e,t){var n=e.category,e=e.topic,r=c.baseUrl||"/onair";n&&(r+="/"+n);e&&(r+="/"+e);void 0!==t&&(r+="/"+t);i.hash()&&(r+="#"+i.hash());return r},initialize:function(e){var t;n||(n=!0,e?a(e,null,o):(t=o,r.fetchSortedCategories("cltv",function(e){angular.forEach(e,function(e){c.categories.push(e)}),t()})))},getCurrentCategory:function(){if(c.urlCategory)return c.categoryIndex[c.urlCategory]},getCurrentTopic:function(){if(c.urlTopic)return c.topicIndex[c.urlCategory+"_"+c.urlTopic]},initializeWithCourses:function(e,t){n||(n=!0,e&&a(e,t,o))},initializeWithTaxonomy:function(){var t;n||(n=!0,t=o,d.get().then(function(e){c.categories=s.sortBy(e,"order"),s.each(c.categories,function(t){t.topics=s.sortBy(t.topics,function(e){return!e.flags.featured}),c.categoryIndex[t.slug]=t,s.each(t.topics,function(e){u(e,t.slug)})}),t()}))}})}r.$inject=["ScoresService","TaxonomyService","$rootScope","$routeParams","$window","$location","$filter","_"],t.exports=r},{}],343:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/category-nav/edit.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data)}}}]},{}],344:[function(e,t,n){"use strict";t.exports=["$sce","config","categoryResource",function(e,r,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/category-nav/view.html",replace:!0,link:function(t,e,n){t.config=r,t.data||(t.data=t.$parent.data),i.getPrimary(function(e){t.categories=e.data})}}}]},{}],345:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("categoryNav",e("./directives/view")),r.directive("categoryNavEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":343,"./directives/view":344}],346:[function(e,t,n){"use strict";t.exports=["StatsService",function(e){return{restrict:"AE",scope:{categorySlug:"@"},templateUrl:"/templates/category-stats/view.html",replace:!0,link:function(t){e.getSocial().then(function(e){t.stats=e.data})}}}]},{}],347:[function(e,t,n){"use strict";e("../../common/app").directive("categoryStats",e("./directives/view"))},{"../../common/app":70,"./directives/view":346}],348:[function(e,t,n){"use strict";var o=e("underscore");t.exports=["config","courseResource","categoryResource",function(e,r,i){return{restrict:"EA",templateUrl:"/templates/channel-hero/cms-edit.html",link:function(t){angular.extend(t,{config:e,setImageFromCourse:function(e){r.findBySlug({slug:e.slug},function(e){e=e&&e.data||e;e.image&&(t.data.image=e.image)})},themes:{white:"Light Text",black:"Dark Text"}}),t.data.theme||(t.data.theme="white"),t.data.category||(t.data.category={});var n=t.$watch("page.primary_category",function(e){e&&i.getCategoryById({id:e}).$promise.then(function(e){e&&e.success&&e.data&&e.data.slug&&(t.data.category=o.pick(e.data,["_id","slug","title"]),n())})});t.$watch("data.theme",function(e){t.page.theme=e})}}}]},{underscore:void 0}],349:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/channel-hero/cms-view.html",scope:{data:"=?"},controllerAs:"channelHeroCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],350:[function(e,t,n){"use strict";t.exports=["$filter","config","rind","$sce","trackFactory",function(r,i,o,a,s){return{restrict:"E",templateUrl:"/templates/channel-hero/view.html",replace:!0,transclude:!0,scope:{imagePath:"@",videoPath:"@",title:"@clTitle",lead:"@",statement:"@",category:"=?",isPrimary:"=?"},link:function(t,n){var e;angular.extend(t,{toggleSound:function(){t.muted?(n.find("video").prop("muted",!1),t.muted=!1):(n.find("video").prop("muted",!0),t.muted=!0);var e={action:t.muted?"mute":"unmute"};s.trackChannelHeroVideo(e)}}),t.muted=!0,t.imagePath&&(e=r("magick")(t.imagePath,{width:1600}),n.css("background-image","url("+e+")")),o&&o.context&&o.context.ua&&(t.mobile=o.context.ua.mobile),t.videoPath&&(t.videoUrl=a.trustAsResourceUrl(i.hostname.protocol+"://"+i.cdn.agc+"/"+t.videoPath))}}}]},{}],351:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("channelHero",e("./directives/index")),r.directive("channelHeroCms",e("./directives/cms/view")),r.directive("channelHeroCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":348,"./directives/cms/view":349,"./directives/index":350}],352:[function(e,t,n){"use strict";t.exports=["config",function(r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/channel-snapshot/edit.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data),e.data.limit||(e.data.limit=5)}}}]},{}],353:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/channel-snapshot/view.html",controllerAs:"channelSnapshotCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}},{}],354:[function(e,t,n){"use strict";var c=e("async");t.exports=["$rootScope","$timeout","$filter","DuplicateService","categoryResource","ScoresService","RecommendationsService","trackFactory",function(e,t,i,o,n,a,s,r){return{restrict:"AE",templateUrl:"/templates/channel-snapshot/index.html",scope:{limit:"=?"},link:function(r,e,t){var n;angular.extend(r,{categories:[]}),(new a).fetchSortedCategories(function(e){n=e,c.eachSeries(n,function(t,n){var e={categories:t._id,limit:r.limit};t.courses=[],s.getRecommendations(e).then(function(e){o.addItems(t.courses,e,"_id"),n()})},function(){angular.forEach(n,function(e){e.title=i("titleCase")(e.title)}),r.categories=n})})}}}]},{async:21}],355:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{course:"=?clChannelSnapshotRecommendation"},templateUrl:"/templates/channel-snapshot/recommendation.html"}}]},{}],356:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clChannelSnapshot",e("./directives/index")),r.directive("channelSnapshotCms",e("./directives/cms/view")),r.directive("channelSnapshotCmsEdit",e("./directives/cms/edit")),r.directive("clChannelSnapshotRecommendation",e("./directives/tiles/recommendation"))},{"../../common/app":70,"./directives/cms/edit":352,"./directives/cms/view":353,"./directives/index":354,"./directives/tiles/recommendation":355}],357:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"E",templateUrl:function(e,t){return"/templates/channel-tile/"+(t.template||"view")+".html"},replace:!0,scope:{category:"=?"}}}]},{}],358:[function(e,t,n){"use strict";e("../../common/app").directive("channelTile",e("./directives/index"))},{"../../common/app":70,"./directives/index":357}],359:[function(e,t,n){"use strict";e("../../common/app").service("clAnalytics",e("./services/clAnalytics"))},{"../../common/app":70,"./services/clAnalytics":360}],360:[function(e,t,n){"use strict";var r=e("crypto").createHash,T=e("moment");t.exports=["$rootScope","$q","CatalogService","PipelineService","analytics","Vault","rind","_","$timeout","gangesSessionService",function(p,h,n,w,m,g,v,y,e,b){var d=this;angular.extend(d,{ready:!1,getQueryParam:_,getMd5:function(e){var t=r("md5");return t.update(e),t.digest("hex")},analyticsTrack:function(){var e=g.Session.get("externalReferrer"),t=document.referrer||null;y.isUndefined(e)&&(""===t&&(t=null),g.Session.set("externalReferrer",t))},analyticsReady:function(){d.ready=!0,function(){var e=g.Session.get("analyticsToTrack");e&&(angular.forEach(e,function(e){t.apply(document,e)}),g.Session.remove("analyticsToTrack"))}()},track:t,trackPage:function(t){if(0!==window.location.pathname.indexOf("/auth/iframe")){try{n=v.context.session.user.uid}catch(e){}var e=window.location.pathname.match(/\W[a-z]*/)[0],n={platform:"web",page_title:document.title,url:window.location.href,page_level_1:e,page:window.location.pathname,date:Date.now(),externalReferrer:g.Session.get("externalReferrer"),logged_in:!!v.context.session._id,first_time_user:g.Session.get("first_time_user")||!1,path:window.location.pathname||"/",productVersion:v.pkg.version,uid:n,cc:b.getPersistentCookie(!1),crlv:b.getCrlvCookie(),session_token:b.getSessionId()};n=y.extend(n,b.extractSessionOrigins());n.GoogleRemarketingPageType={"/":"home","/catalog":"searchresults","/courses":"program"}[e]||"other";t.course&&("/courses"===e||"/class"===e)&&(n.courseID=t.course.nid,n.course_page_price=t.course.product.current_price_formatted,n.channel=t.course.primary_category.title,n.course_title=t.course.title,n.product_id=t.course.product._id||t.course.product,n.productIDs=[t.course._id],n.content_ids=[t.course._id],n.content_type="product",n.category_ids=[t.course.primary_category._id],n.topics_ids=y.chain(t.course.taxonomy).flatten().pluck("topic").pluck("_id").without(void 0).value(),t.course.badges&&(t.course.badges.most_popular?n.flair="most-popular":t.course.badges.trending?n.flair="trending":t.course.badges.staff_favorite&&(n.flair="staff-favorite")),a=t.course.sessions,(a=y.chain(a).map(function(e){return e.segments}).flatten().find(function(e){return e.slug===window.location.pathname.split("/lessons/")[1]}).value())&&(n.is_preview=a.is_preview),a=t.course.schedule,r=t.course.flagged,a&&a[0]?(a=a[0],o=T().unix(),("playlist"===(i=a.broadcast_type)||"rebroadcast"===i||"rebroadcast_edited"===i)&&o<a.start_time&&r&&r.allow_enrollment?n.scheduled=!0:n.scheduled=!1):n.scheduled=!1),!t.bundle||"/bundle"!==e&&"/learning"!==e||(i=t.bundle.primary_category||{},o=t.bundle.product||{},n.bundleID=t.bundle.nid,n.bundle_page_price=o.current_price_formatted,n.channel=i.title,n.bundle_title=t.bundle.title,n.product_id=o._id||o,n.productIDs=[t.bundle._id],n.content_ids=[t.bundle._id],n.content_type="product",n.category_ids=[i._id],n.topics_ids=y.chain(t.bundle.taxonomy).flatten().pluck("topic").pluck("_id").without(void 0).value()),t.data&&(n.category_ids=[t.data.primary_category&&t.data.primary_category._id],n.topics_ids=y.chain(t.data.taxonomy).flatten().pluck("topic").without(void 0).value(),n.type=t.data.type),E(n,S()),k(n);var r,i,o,a=_(document.URL,"via"),s=(a&&(n.via=a),h.all([A(t.course&&t.course._id,n)]).then(function(e){e=e&&e[0]||t;m.page(e)}),null);try{s=window.analytics.user().anonymousId()}catch(e){}try{var c,l=v.config.goptimize.exp_name_to_id;for(c in p.buckets.experimentMap){var u=l[c]||"",d=p.buckets.experimentMap[c],f=d;try{f=google_optimize.get(u)}catch(e){}w.reportExperimentViewed({experiment_name:c,experiment_id:u,variation_name:d,variation_id:f,session:s})}}catch(e){}}},queueTrackEvent:function(e,t){var n=g.Session.get("analyticsToTrack",[]);n.push([e,t]),g.Session.set("analyticsToTrack",n)},addExtraProperties:function(e){m._readied&&e&&((e=$(e.relatedTarget||e.currentTarget).data("analytics"))&&(d.extraPropsTimer&&clearTimeout(d.extraPropsTimer),d.extraProps=e))},addProperties:function(e){d.extraProps=e},clearExtraProperties:function(e){m._readied&&(d.extraPropsTimer=setTimeout(function(){e&&!e()||(d.extraProps={})},500))},getAssociatedBundles:A,segmentLoaded:function(){return window.analytics&&angular.isFunction(window.analytics.track)}}),g.Local.get("prior_visit")||g.Session.set("first_time_user",!0);g.Local.set("prior_visit",!0),m._readied?d.analyticsReady():(m.on("ready",function(){d.analyticsReady()}),e(function(){d.ready||d.analyticsReady()},1e3));function _(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===t||t&&"string"!=typeof t[1]&&t[1].length?"":decodeURIComponent(t[1]).replace(/\+/g," ")}function t(e,t,l,n){try{o=v.context.session.user.uid}catch(e){}var r=y.extend({platform:"web",page:window.location.pathname,url:window.location.href,date:Date.now(),externalReferrer:g.Session.get("externalReferrer")||null,logged_in:!!v.context.session._id,first_time_user:g.Session.get("first_time_user")||!1,cta_label:g.Session.getAndRemove("cta_label"),cc:b.getPersistentCookie(!1),crlv:b.getCrlvCookie(),productVersion:v.pkg.version,uid:o,session_token:b.getSessionId()},d.extraProps,t,b.extractSessionOrigins());m._history=[],E(r,S()),k(r);try{r.email=v.context.session.user.primary_email.address,r.hashed_email=d.getMd5(v.context.session.user.primary_email.address)}catch(e){}var i,o,a,s,c,u=v.context.session.contentRights;if(u&&u.starred&&u.enrolled&&u.purchased){for(i in r.units=0,u.purchased)r.units+=u.purchased[i].length;for(i in r.stars=0,u.starred)r.stars+=u.starred[i].length;for(i in r.enrollments=0,u.enrolled)r.enrollments+=u.enrolled[i].length}if(v.dump.course&&v.dump.course&&v.dump.course.badges&&(v.dump.course.badges.most_popular?r.flair="most-popular":v.dump.course.badges.trending?r.flair="trending":v.dump.course.badges.staff_favorite&&(r.flair="staff-favorite")),(r.product_id||r.product_ids)&&v.context&&v.context.session&&v.context.session.seats&&(o=!1,r.product_id?o=y.find(v.context.session.seats,function(e){return e&&e.subscription&&e.subscription.product&&e.subscription.product._id===r.product_id}):r.product_ids&&(o=y.find(v.context.session.seats,function(e){return y.contains(r.product_ids,e&&e.subscription&&e.subscription.product&&e.subscription.product._id)})),o&&(r.subscription_extension=!0)),l&&!0===l.trackOnNextPage){t=g.Session.get("analyticsToTrack",[]);t.push([e,r]),g.Session.set("analyticsToTrack",t)}else{if(m._history.push({name:e,event:r}),9<m._history.length&&m._history.pop(),"Order Completed"===e)return a=e,c=n,void((s=r)&&s.deferred?f(a,s,c):m.track(a,s,{integrations:{ShareASale:!1}},function(){f(a,s,c)}));m.track(e,r,{},function(){y.isFunction(n)&&n()})}}function f(e,t,n){!t.revenue&&0!==t.revenue||(t.total=t.revenue,delete t.revenue);m.track(e,t,{integrations:{All:!1,ShareASale:!0}},n)}function S(){return p.user&&p.user.getTraits&&p.user.getTraits()}function E(n,e){y.isObject(n)&&y.each(e,function(e,t){n["trait_"+t]=e})}function A(e,r){return e&&r?n.getBundlesByCourseId(e).then(function(e){var t=[],n=[];return y.each(e,function(e){("learning_path"!==e.type?t:n).push(e._id)}),r.bundles=t,r.learning_paths=n,r.has_bundles=!!t.length,r.has_learning_paths=!!n.length,r}).catch(function(e){return r}):h.resolve(r)}function k(e){try{var t,n=v.config.goptimize.exp_name_to_id;for(t in p.buckets.experimentMap)e["expcl_"+t+"_"+(n[t]||"")]=p.buckets.experimentMap[t]}catch(e){}}}]},{crypto:1106,moment:void 0}],361:[function(e,t,n){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(o){return{restrict:"AE",templateUrl:function(){return"/templates/cl-auth/activate-email.html"},link:function(t,e,n){function r(){t.errorText="",t.sending=!1,t.successText="Email Sent!"}function i(e){t.sending=!1,t.successText="",e&&"object"===(void 0===e?"undefined":a(e))||(t.errorText="Something went wrong.");e=e.data;429===e.statusCode?t.errorText="An email was already sent recently. Please wait a moment before you retry.":400<=e.statusCode&&e.statusCode<500?t.errorText="Email failed to send - missing information.":t.errorText="Something went wrong, please try again later."}angular.extend(t,{errorText:"",sending:!1,successText:"",onSend:function(e){e.preventDefault(),t.sending=!0,o.user.sendActivation(o.user._data.primary_email.address,t.activationType).then(r,i)},onEdit:function(){o.$broadcast("auth:change-state","intro")},activationType:n.activationType})}}}r.$inject=["$rootScope"],t.exports=r},{}],362:[function(e,t,n){"use strict";t.exports=["$rootScope","$location","authResource","AnalyticsService",function(i,o,a,s){return{restrict:"AE",templateUrl:"/templates/cl-auth/device.html",link:function(t,e,n){function r(){i.user.valid()?t.state="form":t.state="logout"}t.deviceType="tvos",o.search().code&&(t.devicePin=o.search().code),i.$on("user:login",r),i.$on("user:logout",r),r(),angular.extend(t,{onRegisterDevice:function(){var e={device_pin:t.devicePin.toUpperCase(),device_type:t.deviceType};a.submitDevice({},e).$promise.then(function(e){e.success?(s.track("Authorization",{tvosCode:t.devicePin.toUpperCase(),accountType:"web",userAgent:"browser"},{},function(){}),t.state="thankyou"):t.error="This code is invalid or has expired."})}})}}}]},{}],363:[function(e,t,n){"use strict";function r(i){return{restrict:"AE",templateUrl:"/templates/cl-auth/forgot-password.html",link:function(n,e,t){function r(e){var t;-1===e?n.errorMsg="Please try again later":(t=e&&e.data&&e.data.message,e&&e.status&&404===e.status&&(t=void 0),n.errorMsg=t||"Please check the email address you have submitted.")}angular.extend(n,{onResetPassword:function(){i.user.Auth.resetPassword({email:i.user._data.primary_email.address}).then(function(e){e.success?n.sent=!0:n.error=e&&e.message||"Please check the email address you have submitted."},r)},closeModal:function(){i.$broadcast("user:reset-password")},sent:!1}),n.isSettingsPage=!0===n.settingsPage,n.returnToSettings=function(){return i.$broadcast("auth:cancel")},n.returnToLogin=function(){return i.$broadcast("login:show",{via:"password"})}}}}r.$inject=["$rootScope"],t.exports=r},{}],364:[function(e,t,n){"use strict";function r(c,u){return{restrict:"AE",scope:{theme:"@?",prompt:"=?",promptClass:"=?",state:"=?",done:"&onDone",cancel:"&onCancel",close:"&onClose",analyticsProps:"=?",activationMode:"=?",configKey:"=?",authLead:"=?",authDescription:"=?",authBackgroundImage:"=?",authRemind:"=?",enablePasswordReset:"@?",partner:"@?"},templateUrl:function(e,t){return t.template?"/templates/cl-auth/"+t.template+".html":"/templates/cl-auth/modalView.html"},controller:["$scope","$element","$compile","$window","$location",function(n,e,t,r,i){angular.extend(n,{inputFocus:function(e){n.accountType=e,s||(s=!0,e={label:e,modal_id:a[n.state]},c.user&&c.user._data&&c.user._data.primary_email&&(e.student_email=c.user._data.primary_email.address),c.user.Auth[o[n.state]](e))},paramEmail:decodeURIComponent(i.search().email||""),accountType:void 0,resetState:function(){n.state="intro"}}),n.enablePasswordReset&&i.search().u&&i.search().t?c.user.Auth.resetPasswordStatusById(i.search().u,i.search().t).then(function(e){n.state=e?"reset":"intro"}).catch(function(){n.state="intro"}):n.state="intro",n.i18_suffix=n.configKey?"-"+n.configKey:"",n.authLead||(n.authLead=u("i18n")("cl-auth-lead"+n.i18_suffix,"JOIN THE COMMUNITY")),n.authDescription||(n.authDescription=u("i18n")("cl-auth-description"+n.i18_suffix,"Log in for free access to on air classes led by the world's top experts. The creative community is stronger with you in it!")),n.authBackgroundImage||(n.authBackgroundImage=u("i18n")("cl-auth-background-image"+n.i18_suffix,"https://downloads.creativelive.com/homepage/login-image.jpg"));var o={login:"signInStart",intro:"signInStart",reg:"signUpStart",invalid:"signUpInvalid",activate:"signUpStart",reset:"signInStart"},a={intro:"clIntroModal",login:"clLoginModal",reg:"clRegisterModal",forgot:"clPasswordModal",invalid:"clInvalidEmailModal",activate:"clActivateEmailModal",reset:"clResetPwdModal"},s=(n.$on("user:login",function(e){"onboarding"!==n.state&&(c.$broadcast("auth:hide"),n.done(e,"login_success"))}),n.$on("user:register",function(e){n.onboarding&&!rind.context.ua.mobile?n.state="onboarding":n.thankyou?n.state="thankyou":n.done(e,"registration_success")}),n.$on("user:reset-password",n.done),n.$on("auth:set-opts",function(e,t){angular.extend(n,t)}),n.$on("auth:change-state",function(e,t){t&&(n.state=t)}),!1);n.$watch("state",function(e){n.error="";try{n.email=c.user._data.primary_email.address}catch(e){n.email=n.paramEmail||""}c.$broadcast("cl-form:verify-email"),"registerPrompt"===n.state?n.elementId="registerPrompt":n.elementId="clAuth",s=!1})}]}}r.$inject=["$rootScope","$filter"],t.exports=r},{}],365:[function(e,t,n){"use strict";t.exports=["$window","$timeout","$rootScope","ChannelTopicService","trackFactory","ScoresService",function(o,a,s,c,u,l){return{restrict:"AE",templateUrl:"/templates/cl-auth/interests.html",link:function(n,e,t){var r;function i(){s.$broadcast("auth:cancel")}angular.extend(n,{save:function(){u.onboardingFinishUp(n.accountType),n.forceAbort=!0,i()},skip:function(){if(s.user.hasInterests(!1))return u.onboardingFinishUp(n.accountType),n.forceAbort=!0,i();u.onboardingSkip(n.accountType),n.verifyAbort=!0},back:function(){o.history.go(-1)},forceSkip:function(){u.onboardingQuit(n.accountType),n.forceAbort=!0,i()},continue:function(){u.onboardingContinue(n.accountType),n.verifyAbort=!1},isModal:!0,verifyAbort:!1,forceAbort:!1}),n.$watch("verifyAbort",function(e){try{n.$parent.$parent.closeButton=!e,n.$on("modal.closing",function(e){n.forceAbort||(u.onboardingX(n.accountType),n.verifyAbort||(n.verifyAbort=!0),n.verifyAbort?e.preventDefault():u.onboardingSkipX(n.accountType))})}catch(e){n.isModal=!1}}),s.user.mergeExistingInterests(),r=new l,c.get().then(function(e){var t={};try{t=n.meta||n.$parent.meta}catch(e){}angular.isObject(t)&&a(function(){(t.entityIds||[]).forEach(function(e){e&&s.user.addInterest(e)})}),e.sort(function(e,t){return r.getScoreByCategory(t._id)-r.getScoreByCategory(e._id)}),e.forEach(function(e){e.topics.sort(function(e,t){return r.getScoreByTopic(t.ids[0])-r.getScoreByTopic(e.ids[0])})}),n.channelTopics=e,n.$emit("channelTopics:complete",e)})}}}]},{}],366:[function(e,t,n){"use strict";function r(n,o,a,e,s){return{restrict:"AE",templateUrl:function(e,t){return"/templates/cl-auth/"+(t.template||"intro")+".html"},controller:["$scope","$attrs",function(r,e){angular.extend(r,{checkEmail:function(t){i(),t.$viewValue?t.$valid?r.activationType?n.user.activationStatus(t.$viewValue,r.activationType).then(function(e){e.success&&e.data?(n.user.Auth.setUser({primary_email:{address:t.$viewValue}}),e.data.user?(n.user.Auth.setUser({primary_email:{address:t.$viewValue}}),e.data.blocked?n.$broadcast("auth:change-state","blocked"):e.data.activated?n.$broadcast("auth:change-state","login"):n.$broadcast("auth:change-state","activate")):n.$broadcast("auth:change-state","invalid")):r.error="Something went wrong. Please try again."},function(){r.error="Something went wrong"}):n.user.checkValidEmail(t.$viewValue).then(function(e){e.success&&e.data?(e.data.user?(n.user.Auth.setUser({first_name:e.data.first_name}),n.$broadcast("auth:change-state","login")):n.$broadcast("auth:change-state","reg"),n.user.Auth.setUser({primary_email:{address:t.$viewValue},enterpriseDomain:e.data.enterpriseDomain})):r.error="Something went wrong. Please try again."},function(){r.error="Something went wrong"}):"true"===e.displayEnterprise?r.error="Please enter a valid corporate email address.":r.error=o("i18n")("cl-auth-intro-error","Whoops! That's not an email address."):r.error=o("i18n")("cl-auth-intro-error-missing-email","Whoops! We need your email.")},onFacebook:function(){i();var n=Vault.Local.get("fbPermRerequest"),e="requested"===n;e&&Vault.Local.set("fbPermRerequest","retried");s.login(e).catch(function(e){var t;e&&400===e.status&&e.missingPerms?(t="Unable to log in. Please allow us access to your Facebook "+e.missingPerms.join(", ")+" so we can provide you with the best experience.",n?t+=" To continue with Facebook, go to your Facebook account's app settings and remove the CreativeLive app. Then, try logging in again.":(t+=" To continue with Facebook, try again and edit your permissions.",Vault.Local.set("fbPermRerequest","requested")),r.fbError=t):e&&e.connectionError?r.fbError="You need to log in to Facebook to continue.":r.fbError="Something went wrong."})},onGoogle:function(){i(),Vault.Session.set("next",window.location.href,{expires:"+5 minutes"}),n.user.Auth.startOauth("google")},onApple:function(){i(),Vault.Session.set("next",window.location.href,{expires:"+5 minutes"}),n.user.Auth.startOauth("apple")},onMicrosoft:function(){i(),Vault.Session.set("next",window.location.href,{expires:"+5 minutes"}),n.user.Auth.startOauth("microsoft")},activationType:e.activationType,displaySocial:!!angular.isUndefined(e.displaySocial)||"true"===e.displaySocial,displayEnterprise:!angular.isUndefined(e.displayEnterprise)&&"true"===e.displayEnterprise,emailLabel:e.emailLabel,showMore:!1,clickShowMore:function(){r.showMore=!0}});var t={COURSE_SLUG:r.$parent.promptClass};function i(){r.fbError=null,r.error=null}r.$parent.authRemind?r.authRemind=a(r.$parent.authRemind)(t):r.authRemind=o("i18n")("cl-auth-remind-lead","We will send you a reminder for {{ COURSE_SLUG }} ",t)}]}}r.$inject=["$rootScope","$filter","$interpolate","$location","FacebookService"],t.exports=r},{}],367:[function(e,t,n){"use strict";function r(r){return{restrict:"AE",templateUrl:function(){return"/templates/cl-auth/invalid-email.html"},link:function(e,t,n){angular.extend(e,{onEdit:function(){r.$broadcast("auth:change-state","intro")},authLead:n.authLead,authDescription:n.authDescription})}}}r.$inject=["$rootScope"],t.exports=r},{}],368:[function(e,t,n){"use strict";r.$inject=["$rootScope","$filter"],t.exports=r;var u={"cl-auth-login-greeting":'<h4 class="text-center  margin-bottom-m">It\'s great to see you again{{ name }}!</h4>',"cl-auth-suggest-login-with-oauth":'<h4 class="text-center">Hold on a sec...</h4><p class="text-center margin-bottom-m">We recommend signing in with Google to access all your subscription content.</p>',"cl-auth-login-greeting-immersive":'<h3 class="margin-bottom-m">Welcome back{{ name }}!</h3>',"cl-auth-login-locked":"Uh Oh! Try again later.","cl-auth-password-reset":"Reset your password","cl-auth-password-wrong":"Whoops! This password isn't valid.","cl-auth-password-warning":"That's 5 attempts. 1 more and your account will be locked.","cl-auth-password-locked":"That's 6 attempts. Your account has been locked."};function r(s,c){return{restrict:"AE",templateUrl:function(e,t){return"/templates/cl-auth/"+(t.template||"login")+".html"},link:function(t,e,n){function r(){t.error=void 0,t.submitted=!1,t.loginAttempts=0}function i(e){if(-1===e)t.error="Please try again later";else if("Not Implemented"===e)t.error=a("cl-auth-password-reset");else if("Rate limit exceeded"===e)t.error=a("cl-auth-login-locked");else if(t.loginAttempts++,t.loginAttempts<5)t.error=a("cl-auth-password-wrong");else{if(5!==t.loginAttempts)return t.error=a("cl-auth-password-locked"),t.greeting=a("cl-auth-login-locked"),void(t.submitted=!0);t.error=a("cl-auth-password-warning")}t.submitted=!1}function o(){var e={name:function(){var e=s.user._data.first_name;if(e)return", "+e;return""}()};t.greeting=a("cl-auth-login-greeting",e),t.suggestLoginWithOauth=a("cl-auth-suggest-login-with-oauth")}function a(e,t){return c("i18n")(e,u[e],t)}angular.extend(t,{error:!1,submitted:!1,onLogin:function(e){e.preventDefault(),t.submitted=!0,s.user.Auth.login({email:s.user._data.primary_email.address,password:t.password,profile:s.user.get("profile")}).then(r,i)},loginAttempts:0,onGoogle:function(){Vault.Session.set("next",window.location.href,{expires:"+5 minutes"}),s.user.Auth.startOauth("google")}}),o(),s.$on("user:updated",o)}}}},{}],369:[function(e,t,n){"use strict";r.$inject=["$rootScope","$timeout","$filter"],t.exports=r;var u={"cl-auth-reg-greeting":'<h4 class="text-center">Nice! Almost done...</h4><p class="text-center margin-bottom-m">Type your name and choose a password, and you\'ll be good to go.</p>',"cl-auth-reg-greeting-immersive":'<h3 class="margin-none">LET\'S CREATE</h3><h3>(THIS ACCOUNT)!</h3>',"cl-auth-suggest-reg-with-oauth":'<h4 class="text-center">Hold on a sec...</h4><p class="text-center margin-bottom-m">We recommend registering with Google to access all your subscription content.</p>'};function r(s,e,c){return{restrict:"AE",templateUrl:function(e,t){return"/templates/cl-auth/"+(t.template||"registration")+".html"},link:function(t,e,n){function r(e){return c("i18n")(e,u[e])}function i(){t.passwordError?t.iconColor="brand-warning":t.passwordSuccess?t.iconColor="brand-affirmative":t.iconColor="gray3"}function o(){t.passwordError=void 0,t.passwordSuccess=void 0,t.submitted=!1,i()}function a(e){t.passwordError=!0,t.iconClass="exclamation-circle",e&&"string"==typeof e&&0<=e.toLowerCase().indexOf("unprocessable entity")?t.passwordErrorMsg="There was a problem. Please check your info and try again.":t.passwordErrorMsg=-1===e?"Please try again later":"There was a problem. Please try again.",t.submitted=!1,i()}angular.extend(t,{passwordError:!1,passwordErrorMsg:"at least 8 characters long",passwordSuccess:!1,submitted:!1,onRegister:function(e){e.preventDefault(),t.submitted=!0,s.user.Auth.register({cta_label:"Sign Up",email:s.user._data.primary_email.address,password:t.regPassword,profile:s.user._data.profile}).then(o,a)},showRequired:function(e){return t.formDirty=e.$dirty,e.$dirty&&!e.firstName.$viewValue?"Required":""},iconClass:"exclamation-circle",onGoogle:function(){Vault.Session.set("next",window.location.href,{expires:"+5 minutes"}),s.user.Auth.startOauth("google")}}),t.$watch("regPassword",function(){t.passwordError=!1,t.passwordSuccess=!1,t.regPassword&&t.regPassword.length<8?t.passwordError=!0:t.regPassword&&8<=t.regPassword.length&&(t.passwordSuccess=!0,t.iconClass="check-circle"),i()}),t.regGreeting=r("cl-auth-reg-greeting"),t.suggestRegWithOauth=r("cl-auth-suggest-reg-with-oauth")}}}},{}],370:[function(e,t,n){"use strict";t.exports=["$rootScope",function(o){return{restrict:"AE",scope:{provider:"="},templateUrl:"/templates/cl-auth/social.html",replace:!0,controller:["$scope",function(n){var e=o.user._data,t=(n.register="facebook"===n.provider?r:i,n.user={email:e.email},{student_email:e.email});function r(){n.submitted=!0;var e=void 0,t=void 0;try{e=n.user.profile.first_name,t=n.user.profile.last_name}catch(e){}n.user.displayName=e+" "+t,o.user.Auth.facebookRegistration(n.user,n.provider).then(angular.noop,a)}function i(){n.submitted=!0;var e=void 0,t=void 0;try{e=n.user.profile.first_name,t=n.user.profile.last_name}catch(e){}n.user.displayName=e+" "+t,o.user.Auth.socialRegistration(n.user,n.provider).then(angular.noop,a)}"facebook"===n.provider?(t.label="facebook",o.user.Auth.signUpStart(t),n.register=r,n.user.profile={first_name:e.first_name||"",last_name:e.last_name||""},n.user.fb_id=e.id,n.user.profilePicture=!e.picture.data.is_silhouette&&e.picture.data.url):(t.label=n.provider,o.user.Auth.signUpStart(t),n.register=i,n.user.profile={first_name:e.name.givenName||"",last_name:e.name.familyName||""},n.user[n.provider+"_id"]=e.id,n.user.profilePicture=e.image&&!e.image.isDefault&&e.image.url)}]};function a(e){o.$broadcast("auth:cancel")}}]},{}],371:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("clAuthModal",e("./services/clAuthModal")),r.service("clRegGate",e("./services/clRegGate")),r.directive("clAuth",e("./directives/index")),r.directive("clAuthIntro",e("./directives/intro")),r.directive("clAuthDevice",e("./directives/device")),r.directive("clLogIn",e("./directives/login")),r.directive("clActivateEmail",e("./directives/activate-email")),r.directive("clInvalidEmail",e("./directives/invalid-email")),r.directive("clReg",e("./directives/registration")),r.directive("clAuthSocial",e("./directives/social")),r.directive("clForgot",e("./directives/forgot-password")),r.directive("clInterests",e("./directives/interests"))},{"../../common/app":70,"./directives/activate-email":361,"./directives/device":362,"./directives/forgot-password":363,"./directives/index":364,"./directives/interests":365,"./directives/intro":366,"./directives/invalid-email":367,"./directives/login":368,"./directives/registration":369,"./directives/social":370,"./services/clAuthModal":372,"./services/clRegGate":373}],372:[function(e,t,n){"use strict";function r(o,a,s,e,c,t,u,l,d,f){var p;return function(r){l.lock("authModal"),u.disable();var e="/templates/cl-auth/"+((r=r||{}).template||"modal")+".html";{var t,n,i;p?o.$broadcast("auth:set-opts",r):(t=function(){n({regPrompt:r.regPrompt,cta_label:r.cta_label,state:r.state,via:r.via}),l.unlock("authModal"),u.enable(),p=void 0},n=function(e){f.accountModalClosed(e)},i={templateUrl:e,windowClass:"cl-modal modal-cl-auth",backdrop:!0,controller:["$scope","$uibModalInstance",function(e,t){e.$on("modal.closing",function(){o.$emit("auth.modal.closing")}),e.state=r.state,e.dest=r.dest,e.onboarding=r.onboarding,e.thankyou=r.thankyou,e.prompt=r.prompt,e.regPrompt=r.regPrompt,e.promptClass=r.promptClass,e.meta=r.meta,e.activationMode=r.activationMode,e.configKey=r.configKey,e.authLead=r.authLead,e.authDescription=r.authDescription,e.authBackgroundImage=r.authBackgroundImage,e.authRemind=r.authRemind,e.closeButton=!("closeButton"in r)||r.closeButton,e.template=r.template,e.isRegGate=!!r.isRegGate,e.settingsPage=r.settingsPage||!1,e.activationMode&&Vault.Local.set("registrationActivationMode",e.activationMode,{expires:"+5 minutes"}),"intro"===e.state&&Vault.Local.set("regLoginInitiated",!0,{expires:"+5 minutes"}),e.dest&&d.search("dest",e.dest);e.analyticsProps=e.analyticsProps||{};var n={modal_id:{intro:"clIntroModal",login:"clLoginModal",reg:"clRegisterModal",forgot:"clPasswordModal"}[e.state],via:e.analyticsProps.via||r.via,cta_label:r.cta_label,regPrompt:r.regPrompt};o.user.Auth.modalShown(void 0,n),e.$on("auth:cancel",t.dismiss),s(function(){o.$broadcast("auth:set-opts",r)})}]},c.each(["backdrop","keyboard"],function(e){e in r&&(i[e]=r[e])}),(p=a.open(i)).result.then(t,t))}}}r.$inject=["$rootScope","$uibModal","$timeout","rind","_","deepval","keyboard","LockBody","$location","trackFactory"],t.exports=r},{}],373:[function(e,t,n){"use strict";var se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(s,v,y,b,_,c,w,u,l,d,S,t,E,A,k){var T,C,I,x,f,p,h,P,n,r,M,O,i=0,o=10,R=2,j=2e4,D=36e5,m=!0,N=1e3,L=12e4,B=!1,U=!0,F=!0,g=!1,a=!0,z=!1,V=!1,H=!1,q=[];function W(e,t){"broadcast"===t.type&&(t={id:t.source.eventId},V?Y():(V=!0,S.getEventById(t.id).then(function(e){if(e)try{G(S.getEventBroadcastData(e).all)}catch(e){}else g=!0})))}function Y(){d.each(q,function(e){e.off(e.events.STARTED,W)})}function G(e){(r=new t({onBroadcastStart:function(e){e&&(g="pre_live"===e.broadcast_type||"pre"==e.broadcast_type?!(a=!0):!(a=!1))}})).setBroadcasts(e),s.$on("swimlane:select",function(e,t){t&&t.swimlane&&t.swimlane.broadcasts&&r.setBroadcasts(t.swimlane.broadcasts)}),P(),Y()}function K(){return s.user&&"function"==typeof s.user.valid&&s.user.valid()}function J(e){switch(e){case"video:event:play":case"segment":case"video":M=!(O=!0);break;case"video:stream:play-watch-counter":case"broadcast":M=!(O=!1);break;default:M=O=!1}}function Q(){return X()&&U&&!a}function X(){return ee(f)>=L&&(s.$broadcast("freePreview:hasMetWatchLimit"),!0)}function Z(e,t){var n;t&&t.source&&t.source.course&&(t=t.source.course,n=k().toJSON(),s.$broadcast("freePreview:amountWatched",e,L),l.Local.set(t+"-amountWatched",e),l.Local.set(t+"-datum",n))}function ee(e){if(!e||!e.source||!e.source.course)return 0;var e=e.source.course,t=l.Local.get(e+"-amountWatched"),e=l.Local.get(e+"-datum"),n=k(),r=k().subtract(1,"days");return e&&k(e).isBetween(r,n)&&t&&d.isNumber(t)||Z(t=0),t}function te(){I||(I=0,v(function(){I++},1e3))}function ne(e){return!!M||(e&&e.segment&&e.segment._id?!T[e.segment._id]:e&&"segment"===e.type?!T[e.source._id]:!(!e||!e.playUrl)&&(z=!0))}function re(){var e,t;u.context&&u.context.ua&&u.context.ua.os&&"iOS"===u.context.ua.os.family&&(t=(e=$("#ustreamVideoPlayer")).attr("src"),e.attr("src",t),E.getAllVideoPlayers(function(e){e.pause();var e="#"+e.id+"_ustream",e=$(e),t=e.attr("src");e.attr("src",t)}))}function ie(){return 0===angular.element(document.querySelector(".modal.in")).length}function oe(){var e={lastPage:c.location.pathname,pageCount:1};return l.Local.set("pageHistory",e),e}function ae(e){K()||(s.$broadcast("video:exitFullscreen"),e=d.extend({onboarding:!1,state:"intro",activationMode:"video-view-"+L/1e3,configKey:"video-view",regPrompt:"video-view-"+L/1e3,class:f&&f.source&&f.source.course},e),ie()&&(s.$broadcast("video:displayRegOverlay",e),B=!0,E.getAllVideoPlayers(function(e){var t=v(function(){"paused"===e.state&&v.cancel(t),"playing"===e.state&&(v.cancel(t),y(function(){e.pause(),m=!0},100))},500)})),y(function(){re();var e=$(".header-text");0<e.length&&e.addClass("pad-left-m").addClass("pad-right-m")}))}return function(){K()||(E.getAllVideoPlayers(function(e){H||(e.on(e.events.STARTED,W),q.push(e))}),P=s.$on("video:stream:play-watch-counter",function(e,t,n){var r,i,o,a;V?P():(u.dump&&u.dump.course?u.dump.course.broadcast_schedules&&u.dump.course.broadcast_schedules.length?G(u.dump.course.broadcast_schedules):r={courseId:u.dump.course._id,allowPrelive:!0,when:"now"}:!document.querySelectorAll("[event-id]").length||(i=(i=document.querySelectorAll("[event-id]")[0])?i.getAttribute("event-id"):void 0)&&(r={id:i}),r&&(V=!0,r.courseId?(o="getEventsByCourseId",a=r.courseId):r.id&&(o="getEventById",a=r.id),o&&a&&S[o](a).then(function(e){if(e)try{G(S.getEventBroadcastData(e).all)}catch(e){}else g=!0})))}),function e(t){y.cancel(n);i<=o?c.regOpts?t(c.regOpts):(i++,n=y(function(){e(t)})):t({})}(function(e){t=c.location.href,o=d.find(["/onair","/stories","/catalog","/enterprise"],function(e){return 0<=t.indexOf(e)}),U=!o;var t,n,r,i=c.location.href,o=d.find(["/enterprise","/marketing/roam247"],function(e){return 0<=i.indexOf(e)}),a=(u&&u.context&&u.context.ua&&u.context.ua.mobile&&(o="mobile"),w.search().partner&&"starbucks"===w.search().partner&&(o="starbucks"),F=!o,e);s.$on("auth:set-opts",function(){h&&h.pause(),p&&(p.cancel(),p=void 0),l.Session.set("authModalShown",!0),l.Local.set("lastAuthModalShown",k().unix())}),s.$on("reg-login:cancelled",function(){X()&&(s.$broadcast("video:reset"),z&&s.$broadcast("videojs:reset"),E.getAllVideoPlayers(function(e){e.stop()})),!m&&h?h.resume():p&&p.resume()}),s.$on("reg-gate:pause-currentVideoItem",function(e,t){m=!0,h.pause()}),s.$on("reg-gate:play-currentVideoItem",function(e,t){m=!(g=!0),(f=t)&&"promo"!==t.type&&h.resume()}),E.getAllVideoPlayers(function(e){function t(){m=!0,K()||(h&&h.pause(),p&&p.resume())}e.on(e.events.STARTED,function(e,t){if(J(t.type),!1===ne(f=t)&&(s.$broadcast("video:removeRegOverlay"),B=!1),!K()&&ne(t)&&!a.isPromotional&&(h&&h.resume(),p&&p.pause(),O&&(C=te(),g=!0),l.Local.set("pressedPlay",!0,{expires:"+10 minutes"}),ne(t))){if(Q())return m=!0,void ae(a);m=!1}}),e.on(e.events.PAUSED,t),e.on(e.events.ENDED,t)}),d.each(["video:event:play","video:stream:play-watch-counter"],function(e){s.$on(e,function(e,t,n){if(J(e.name),!K()&&ne(n)&&!a.isPromotional&&(h&&h.resume(),p&&p.pause(),O&&(C=te(),g=!0),l.Local.set("pressedPlay",!0,{expires:"+10 minutes"}),ne(n))){if(Q())return m=!0,void ae(a);m=!1}})}),d.each(["video:event:pause","video:stream:pause-watch-counter"],function(e){s.$on(e,function(e,t){m=!0,K()||(h&&h.pause(),p&&p.resume())})}),n=e,F&&(R=n.pageViewsBeforeAuth||R,j=n.delayBeforeSmartAuth||j,D=n.minimumTimeBetweenSmartAuth||D,"5_minutes"===s.buckets.experimentMap.cltv_reg_gate_timing&&(j=3e5),function(){var e=function(){var e=l.Local.get("pageHistory");(!e||"object"!=(void 0===e?"undefined":se(e))||"undefined"===e.lastPage||"string"!=typeof e.lastPage||void 0===e.pageCount||"number"!=typeof e.pageCount||e.pageCount<1)&&(e=oe());return e}();e&&e.lastPage!=c.location.pathname&&(e.lastPage=c.location.pathname,e.pageCount++,l.Local.set("pageHistory",e));return e}().pageCount>=R&&function(){if(!0===B)return!1;var e=k().unix(),t=l.Local.get("lastAuthModalShown");("number"!=typeof t||"number"==typeof t&&e<t)&&(t=0);var n=l.Session.get("authModalShown");if(D/1e3<=e-t||!n)return!0;return!1}()&&(p=new A("timeout",j,function(t){return function(){var e;ie()&&(oe(),h&&h.pause(),e={onboarding:!1,activationMode:"timer-"+t/1e3,configKey:"timer",regPrompt:"timer-"+t/1e3,via:"timer"},!0===l.Session.get("first_time_user")&&(e.authLead=b("i18n")("first_time_user_auth_lead")||"join the creative community",e.authDescription=b("i18n")("first_time_user_auth_description")||"Log in or sign up for free access to on air classes led by the world's top experts.  The creative community is stronger with you in it!"),n.authLead&&(e.authLead=n.authLead),n.authDescription&&(e.authDescription=n.authDescription),s.$emit("register:prompt",e))}}(j)))),U&&(o=e,_.ready(function(){angular.element("video").bind("contextmenu",function(){return!1})}),L=o.freeViewLimit||L,x=ee(f),T=function(){var t={};u.dump.course&&u.dump.course.promo&&d.isArray(u.dump.course.promo)&&d.each(u.dump.course.promo,function(e){e._id&&e.type&&"promo"===e.type&&(t[e._id]=e)});return t}(),r=o,h=new A("interval",N,function(){var e,t,n;f&&!m&&g&&(X()?(ae(r),m=!0):(t=x,n=ee(e=f),d.isNumber(n)&&(x=t<=n?n:t),Z(x+=N,e)))}),d.each(["user:login","user:register"],function(e){s.$on(e,function(){s.$broadcast("video:removeRegOverlay"),B=!1,y(function(){var e;l.Local.get("pressedPlay")&&(M?s.$broadcast("video:stream:play"):(e=angular.element('[ng-show="playUrl"]')[0])&&(e=e.getAttribute("player-id"),(e=videojs(e))&&(e.play(),e.currentTime(I),v.cancel(C))),E.getAllVideoPlayers(function(e){e.play()}))})})}))}))}}r.$inject=["$rootScope","$interval","$timeout","$filter","$document","$window","$location","rind","Vault","_","EventService","broadcastService","videoPlayerCollection","Timer","moment"],t.exports=r},{}],374:[function(e,t,n){"use strict";function r(r,t,n,e,i,o,a){var s;function c(e){n.getCoursesByIds(e).then(function(e){e=_.sortBy(e,"popularity");r.courses=e.reverse(),u(1)})}function u(e){e?r.pagination.currentPage=e:r.preventScroll||(e=$(".content-finder").offset(),a.scrollTo(0,e.top,300)),o.search(t.pageKey,r.pagination.currentPage),r.urlCategory?r.filteredCourses=_.reduce(r.courses,function(e,t){var n=t.primary_category.slug===r.urlCategory;return(n=r.urlTopic?_.find(t.taxonomy,function(e){return e.slug===r.urlTopic}):n)&&e.push(t),e},[]):r.filteredCourses=r.courses;e=(r.pagination.currentPage-1)*r.pagination.perPageLimit;r.visibleItems=r.filteredCourses.slice(e,e+r.pagination.perPageLimit),r.pagination.totalItems=r.filteredCourses.length}r.ctrl||(angular.extend(r,{pageChanged:u,pagination:{currentPage:o.search().page||1,pages:0,perPageLimit:parseInt(t.perPageLimit,0)||12},pageKey:r.pageKey||t.pageKey,subscriptionPlanId:r.subscriptionPlanId||t.subscriptionPlanId,savedSearchId:r.savedSearchId||t.savedSearchId,bundleId:r.bundleId||t.bundleId,hideTopics:r.hideTopics,customTopics:r.customTopics,preventScroll:r.preventScroll,deepLinking:r.deepLinking}),r.pageKey||(t.pageKey="page"),r.subscriptionPlanId&&(s=r.subscriptionPlanId,i.getSubscriptionPlanById(s,!0).then(function(e){r.title=e.title,"true"!==t.useSearch&&c(e.content)})),r.savedSearchId&&(i=r.savedSearchId,e.getContentById(i).then(function(e){c(e)})),r.bundleId&&(s=r.bundleId,n.getBundleById(s).then(function(e){c(e.courses)})),r.hideTopics&&(r.hideTopics=!0),r.$watch("urlCategory",function(e,t){r.courses&&r.courses.length&&u(void 0!==t&&e!==t?1:r.pagination.currentPage)}),r.$watch("urlTopic",function(e,t){r.courses&&r.courses.length&&u(void 0!==t&&e!==t?1:r.pagination.currentPage)}))}r.$inject=["$scope","$attrs","CatalogService","SavedSearchService","SubscriptionPlanService","$location","$window"],t.exports=r},{}],375:[function(e,t,n){"use strict";function r(s,c,u,e,l,d){var f=this;function t(){e.init(f.populated).on("searchResult",i)}function i(e,t){n("exact",t)?r("exact",t):n("popular",t)?r("popular",t):n("fuzzy",t)?r("fuzzy",t):n("unfiltered",t)?r("unfiltered",t):(s.pagination.totalItems=0,f.populated?f.populated=!1:(s.populated=!1,s.visibleItems=[]))}function n(e,t){var n=c.contentKey||"courses";return t&&t[n]&&t[n][e]&&t[n][e].length}function r(e,t){switch(c.contentKey){case"courses":i=e,o=t,a=_.pluck(o.courses[i],"id"),u.getCoursesByIds(a).then(function(e){s.pagination.totalItems=o.courses.counts[i],s.pagination.currentPage=l.search()[c.pageKey],s.savedSearchIds=l.search()["saved-search-id"];var t=(d.user.hasActiveConsumerSubscription()||d.user.hasActiveEnterpriseSubscription())&&!s.savedSearchIds;!f.populated||t||"owned-classes"===s.savedSearchIds||"saved-classes"===s.savedSearchIds?(f.populated=!1,s.populated=!1,s.visibleItems=e):f.populated=!1});break;case"lessons":case"freeLessons":a=e,n=t,l.search()["free-lessons"]?c.contentKey="freeLessons":c.contentKey="lessons",0!==(r=n[c.contentKey][a]).length?(a=_.chain(r).pluck("courseId").uniq().value(),u.getCoursesByIds(a).then(function(e){var t={};_.each(e,function(e){t[e._id]=e}),_.each(r,function(e){e.course=t[e.courseId]}),s.visibleItems=r,s.pagination.totalItems=n[c.contentKey].total,s.pagination.currentPage=l.search()[c.pageKey],s.savedSearchIds=l.search()["saved-search-id"]},function(e){})):(s.visibleItems=[],s.pagination.totalItems=n[c.contentKey].total)}var n,r,i,o,a}angular.extend(f,{init:t,populated:"true"===c.populated}),angular.extend(s,{pageChanged:function(e){e&&(s.pagination.currentPage=e);l.search(c.pageKey,s.pagination.currentPage)},populated:"true"===c.populated,pagination:{currentPage:l.search().page||1,pages:0,perPageLimit:parseInt(c.perPageLimit,0)||12}}),c.pageKey||(c.pageKey="page"),s.$on("$locationChangeSuccess",function(){d.path=l.path()}),t()}r.$inject=["$scope","$attrs","CatalogService","SearchService","$location","$rootScope"],t.exports=r},{}],376:[function(e,t,n){"use strict";function r(e,i){e.$on("filter:selected",function(e,t,n,r){i.interact(t,n,r)})}r.$inject=["$scope","CatalogAnalyticsService"],t.exports=r},{}],377:[function(e,t,n){"use strict";function r(t,e,n,r,i){var o=n.search()["saved-search-id"],n=r.user.getActiveSubscriptionsContentIds();t.$on("filter:selected",function(e,t,n,r){i.interact(t,n,r)}),o&&"all-classes"!==o&&o!==n&&""!==o&&e.getById(o,!0).then(function(e){e={slug:o,label:e.name,display:!0};t.filters.push(e),t.queryFilter=e})}r.$inject=["$scope","SavedSearchService","$location","$rootScope","CatalogAnalyticsService"],t.exports=r},{}],378:[function(e,t,n){"use strict";function r(o,l,n,d,a,e){l.on("searchResult",function(e,t){o.query=a.search().q,o.filter=a.search().filter,o.collection=f[a.search().collection]||"Classes",o.hasCollectionFilter=!!a.search().collection,o.exactCount=t.courses.counts.exact,o.popularCount=t.courses.counts.popular,o.fuzzyCount=t.courses.counts.fuzzy,o.hasFreeLesson=t.freeLessons&&t.freeLessons.total,o.lessonsCount=a.search()["free-lessons"]?t.freeLessons&&t.freeLessons.total:t.lessons&&t.lessons.total,o.unfilteredCount=t.courses.counts.unfiltered,o.showSpinner=!1,o.category=n.getCurrentCategory(),o.topic=n.getCurrentTopic(),o.categoryFilter=o.topic||o.category||null,o.h1Text=o.categoryFilter&&o.categoryFilter.seo_header||(t.category?"&nbsp;":"All Online Classes"),i=!0,r&&(o.ready=!0);!function(){var e=a.path().split("/"),t=e[1],n=e[2],e=e[3],r=a.absUrl().split("?"),r=(o.queryString=r[1],o.urlAll="/"+t,[{nextStep:o.category,currentStep:!0,label:"All",url:"/"+t},{nextStep:o.topic,currentStep:o.category,label:o.category&&o.category.title,url:"/"+t+"/"+n},{nextStep:!1,currentStep:o.topic,label:o.topic&&o.topic.name,url:"/"+t+"/"+n+"/"+e}]);o.breadcrumb=_.reduce(r,function(e,t){var n=t.currentStep,r=t.nextStep,i=t.label,o=t.url,t=t.queryString;if(!n)return e;n={label:i};return r&&(n.url=t?o+"?"+t:o),e.push(n),e},[])}()}),n.onReady(s),n.onChange(s),e.$on("$locationChangeSuccess",t);var r=!1,i=!1,f={"fast-class":"Fast Classes"};function t(){c("saved-search-id","all-classes"===o.defaultSavedSearchId?e.user.getActiveSubscriptionsContentIds():"all-classes","page"),o.showAllClasses="all-classes"===o.defaultSavedSearchId&&!o.param["saved-search-id"]||"all-classes"!==o.defaultSavedSearchId&&o.param["saved-search-id"],o.showSubscription="all-classes"!==o.defaultSavedSearchId&&!o.param["saved-search-id"]||"all-classes"===o.defaultSavedSearchId&&o.param["saved-search-id"],o.urlAllClasses=("all-classes"===o.defaultSavedSearchId?o.urlWithout:o.urlWith)["saved-search-id"],o.urlSubscription=("all-classes"===o.defaultSavedSearchId?o.urlWith:o.urlWithout)["saved-search-id"],o.hasSavedSearchFilter="all-classes"!==o.defaultSavedSearchId&&!o.param["saved-search-id"]||0<=["owned-classes","saved-classes"].indexOf(o.param["saved-search-id"]),o.showSubscriptionSwitch=o.param["saved-search-id"]===e.user.getActiveSubscriptionsContentIds()||o.defaultSavedSearchId===e.user.getActiveSubscriptionsContentIds(),"all-classes"!==o.param["saved-search-id"]&&""!==o.param["saved-search-id"]&&o.param["saved-search-id"]!==e.user.getActiveSubscriptionsContentIds()?d.getById(o.param["saved-search-id"],!0).then(function(e){o.currentSavedSearch=e.name,o.showSubscriptionSwitch=!1},function(e){o.currentSavedSearch=""}):o.currentSavedSearch="",c("free-lessons","true","page-lessons"),o.showSpinner=!0}function s(){o.category=n.getCurrentCategory(),o.topic=n.getCurrentTopic(),o.categoryFilter=o.topic||o.category||null,o.h1Text=o.categoryFilter&&o.categoryFilter.seo_header||"All Online Classes",r=!0,i&&(o.ready=!0)}function c(e,t,n){var r=_.clone(a.search()),i=a.absUrl().split("?")[0];o.param[e]=r[e],r[e]=null,r[n]=null,o.urlWithout||(o.urlWithout={}),o.urlWithout[e]=""+i+u(r),r[e]=t,o.urlWith||(o.urlWith={}),o.urlWith[e]=""+i+u(r)}function u(e){return _.reduce(e,function(e,t,n){return t?e+(e?"&":"?")+n+"="+t:e},"")}angular.extend(o,{query:a.search().q,collection:"Classes",defaultSavedSearchId:e.user.hasActiveConsumerSubscription()||e.user.hasActiveEnterpriseSubscription()?e.user.getActiveSubscriptionsContentIds():"all-classes",param:{},ready:!1,h1Text:"&nbsp;",removeFilter:function(e,t){o.showSubscription&&"saved-search-id"===t?a.search(t,"all-classes"):a.search(t,null);e.preventDefault()},filters:{featured:"Featured","best-sellers":"Best Sellers","top-rated":"Top Rated",upcoming:"Upcoming","on-sale":"On Sale",new:"New"}}),t()}r.$inject=["$scope","SearchService","CategoryFilterService","SavedSearchService","$location","$rootScope"],t.exports=r},{}],379:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{savedSearchId:"<?",bundleId:"<?",hideTopics:"<?",customTopics:"<?",preventScroll:"<?",deepLinking:"<?"},templateUrl:function(e,t){return t.template||"/templates/cl-catalog/content-finder/index.html"},replace:!0,controller:"ContentFinderController"}}},{}],380:[function(e,t,n){"use strict";function r(o,a,s){return{scope:{redirectToCatalog:"<?",showSearchButton:"<?"},restrict:"AE",templateUrl:function(e,t){return t.template||"/templates/cl-catalog/search.html"},replace:!0,link:function(n,e,t){var r=o.search().q||"";function i(){r!==n.prequery&&o.search("page",null),n.prequery?(r=n.prequery,o.search("q",n.prequery)):o.search("q",null)}n.prequery=r,n.onSearchInput=function(e,t){"blur"===t&&(n.focusInput=!1),"focus"===t&&(n.focusInput=!0),"clear"===t&&(n.prequery="",n.focusInput=!1,s.interact("catalog","Sidebar Button","Clear"),i()),"submit"===t&&(e.preventDefault(),n.focusInput=!1,s.interact("catalog","Sidebar Button","See All Search Results"),i(),n.redirectToCatalog&&(t="",o.search().q&&(t="?q="+o.search().q),a.location.href="/catalog"+t))}}}}r.$inject=["$location","$window","CatalogAnalyticsService"],t.exports=r},{}],381:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",templateUrl:function(e,t){return t.template||"/templates/cl-catalog/state/header.html"},replace:!0,controller:"CatalogStateController"}}},{}],382:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("contentFinder",e("./directives/content-finder")),r.directive("catalogSearch",e("./directives/search")),r.directive("catalogState",e("./directives/state")),r.service("SearchService",e("./services/searchService")),r.service("CatalogAnalyticsService",e("./services/catalogAnalyticsService")),r.service("CatalogTitle",e("./services/catalogTitleService")),r.controller("CatalogCoursesController",e("./controllers/courses-controller")),r.controller("CatalogStateController",e("./controllers/state-controller")),r.controller("ContentFinderController",e("./controllers/content-finder-controller")),r.controller("SavedSearchFilterController",e("./controllers/saved-search-filter-controller")),r.controller("CatalogFilterController",e("./controllers/filter-controller"))},{"../../common/app":70,"./controllers/content-finder-controller":374,"./controllers/courses-controller":375,"./controllers/filter-controller":376,"./controllers/saved-search-filter-controller":377,"./controllers/state-controller":378,"./directives/content-finder":379,"./directives/search":380,"./directives/state":381,"./services/catalogAnalyticsService":383,"./services/catalogTitleService":384,"./services/searchService":385}],383:[function(e,t,n){"use strict";function r(a,e,n,s,c,u,l,d,m,t){var f=this,r=(u.extend(f,{init:function(e){if(f.ready)return f;return t.init(),t.on("title:change",o),e.on("searchResult",i),f},interact:function(e,t,n){f.ctaLabel=n,f.ctaType=t,f.module=e,f.nonInteraction=0,f.action="filter"===t||"save-search-id"===t?"filtering":"sort"===t?"sorting":"searchStart"},props:null,propsSegment:null,nonInteraction:0,SEO_title:""}),["exact","fuzzy","popular"]);function i(e,t){var n,r,i,o;n=t,r=c.defer(),i=u.pluck(h(n,"courses"),"id"),o=u.pluck(h(n,"lessons"),"id"),t=s.path().split("/"),f.category=t[2],f.topic=t[3],f.page=s.search().page,f.q=s.search().q,f.filter=s.search().filter,f.sort=s.search().sort||"popular",f["free-lessons"]=s.search()["free-lessons"],f["saved-search-id"]=s.search()["saved-search-id"],f["page-lessons"]=s.search()["page-lessons"],a.getCoursesByIds(i,{keys:["product"]}).then(function(e){var t={list_id:n.courses.searchId,category:f.topic?f.category+"/"+f.topic:f.category,filters:p(["category","topic","page","q","filter","free-lessons","page-lessons","saved-search-id"]),sorts:p(["sort"]),products:function(e){var n=[],r="";f.category&&(r=f.category);f.topic&&(r+="/"+f.topic);return u.each(e,function(e,t){e={product_id:u.isObject(e.product)?e.product._id:e.product,sku:e.sku,category:r,type:"class",name:e.title,price:e.price&&e.price.current_price,url:l("linkToSource")(e),image_url:l("magick")(e.image),position:t};n.push(e)}),n}(e)},e=u.chain(e).pluck("product").value(),e=(u.isObject(e[0])&&(e=u.chain(e).pluck("_id").value()),{search_id:n.courses.searchId,search_page:f.page||1,search_version:n.lessons.version||"",num_results:n.courses.total,top_course_ids:i.slice(0,3),top_product_ids:e.slice(0,3),top_segment_ids:o.slice(0,3),nonInteraction:f.nonInteraction,query:f.q||"",src:"explicit",search_SEOHeader:f.SEO_title,category_selected_name:null,category_refined_names:f.category?[f.category]:[],topic_selected_name:null,topic_refined_names:f.topic?[f.topic]:[],filter_selected_name:null,filter_refined_names:f.filter?[f.filter]:[],cta_label:f.ctaLabel,cta_type:f.ctaType,cta_location:2,cta_module:f.module||"catalog",internal_search_terms:f.q||"",sort_method:f.sort||"popular",action:f.action||"search"});r.resolve({catalog:e,productList:t})},r.reject),r.promise.then(function(e){d.track("Product List Filtered",e.productList),m.catalog(e.catalog.action,e.catalog)})}function p(e){var t=[];return u.each(e,function(e){f[e]&&t.push({type:e,value:f[e]})}),t}function h(e,t){var n=function(t,n){if(s.search().q)return"exact";return u.find(r,function(e){return t&&t[n]&&t[n][e]&&t[n][e].length})}(e,t);return e&&e[t]&&e[t][n]||[]}function o(e,t){var n=t.title,t=t.subtitle;f.SEO_title=n,f.SEO_title+=t?" "+t:""}}r.$inject=["CatalogService","$rootScope","CategoryFilterService","$location","$q","_","$filter","AnalyticsService","trackFactory","CatalogTitle"],t.exports=r},{}],384:[function(e,t,n){"use strict";function r(a,s,n,c,u,l,d){var f=this,p=(_.extend(f,{init:function(){if(f.ready)return f;f.ready=!0,a.$on("$locationChangeSuccess",e),c.onReady(e)},ready:!1,defaultSavedSearchId:a.user.hasActiveConsumerSubscription()||a.user.hasActiveEnterpriseSubscription()?a.user.getActiveSubscriptionsContentIds():"all-classes",registeredEvent:{},on:function(e,t){f.registeredEvent[e]||(f.registeredEvent[e]=[]);f.registeredEvent[e].push(t)},off:function(n,r){_.each(f.registeredEvent[n],function(e,t){e===r&&f.registeredEvent[n].splice(t,1)})}}),{featured:"Featured","best-sellers":"Best Sellers","top-rated":"Top Rated",upcoming:"Upcoming","on-sale":"On Sale",new:"New"});return f;function e(){var e=s.search();f.showAllClasses="all-classes"===f.defaultSavedSearchId&&!e["saved-search-id"]||"all-classes"!==f.defaultSavedSearchId&&e["saved-search-id"],f.showSubscription="all-classes"!==f.defaultSavedSearchId&&!e["saved-search-id"]||"all-classes"===f.defaultSavedSearchId&&e["saved-search-id"],f.mySavedSearch=e["saved-search-id"]===a.user.getActiveSubscriptionsContentIds()||f.defaultSavedSearchId===a.user.getActiveSubscriptionsContentIds(),"all-classes"!==e["saved-search-id"]&&""!==e["saved-search-id"]&&e["saved-search-id"]!==a.user.getActiveSubscriptionsContentIds()?n.getById(e["saved-search-id"],!0).then(function(e){f.currentSavedSearch=e.name,f.mySavedSearch=!1,t()},function(e){f.currentSavedSearch="",t()}):(f.currentSavedSearch="",t())}function t(){var e=s.search(),t=(f.category=c.getCurrentCategory(),f.topic=c.getCurrentTopic(),f.categoryFilter=f.topic||f.category||null,""),n="",n=!f.showAllClasses&&!f.mySavedSearch||e.filter||e.q?(t=(t=(t+=e.filter?p[e.filter]+" ":"")+(f.currentSavedSearch?f.currentSavedSearch+" ":""))+(e.q?'"'+e.q+'" ':"")+"Classes",f.categoryFilter&&f.categoryFilter.seo_header?"in "+f.categoryFilter.seo_header:"in All Online Classes "):(f.mySavedSearch?t=(t+=f.categoryFilter&&f.categoryFilter.seo_header?""+f.categoryFilter.seo_header:"All Classes")+(f.showSubscription?" In My "+a.user.getActiveSubscriptionsLabel():""):t+="All "+f.currentSavedSearch+" Classes",""),e=(function(e){var t=arguments;_.each(f.registeredEvent[e],function(e){e&&e.apply(this,t)})}("title:change",{title:t,subtitle:n}),f.category),t=f.topic,n=["Browse the",e?" "+e.title:""," catalog for ",t?t.name+" ":"","classes to watch on-demand. Own the classes you love."].join(""),r=null,i=n,n=(function(e,t){var n=d.defer();t?u.getDescriptionByTopic(e,t).then(function(e){n.resolve(e)}).catch(function(e){n.reject(null)}):e?u.getDescriptionByCategory(e).then(function(e){n.resolve(e)}).catch(function(e){n.reject(null)}):n.reject(null);return n.promise}(e&&e.slug,t&&t.path).then(function(e){r=e,angular.forEach(l[0].querySelectorAll('meta[itemprop="description"], meta[name="description"], meta[property="og:description"], meta[property="twitter:description"]'),function(e){e.content=r})}).catch(function(e){angular.forEach(l[0].querySelectorAll('meta[itemprop="description"], meta[name="description"], meta[property="og:description"], meta[property="twitter:description"]'),function(e){e.content=i})}),s.search()),o="";e?o=t?e.title+" "+t.name:e.title:(o="All",o+=n.filter?" "+p[n.filter]:""),o+=" Classes | CreativeLive",function(e,t){var n=d.defer();t?u.getSeoTitleByTopic(e,t).then(function(e){n.resolve(e)}).catch(function(e){n.reject(null)}):e?u.getSeoTitleByCategory(e).then(function(e){n.resolve(e)}).catch(function(e){n.reject(null)}):n.reject(null);return n.promise}(e&&e.slug,t&&t.path).then(function(t){t=t+" | CreativeLive",l[0].title=t,angular.forEach(l[0].querySelectorAll('meta[property="og:title"], meta[property="twitter:title"]'),function(e){e.content=t})}).catch(function(e){angular.forEach(l[0].querySelectorAll('meta[property="og:title"], meta[property="twitter:title"]'),function(e){e.content=o}),l[0].title=o})}}r.$inject=["$rootScope","$location","SavedSearchService","CategoryFilterService","TaxonomyService","$document","$q"],t.exports=r},{}],385:[function(e,t,n){"use strict";function r(p,h,m,t,g,i,v){var y=this;function n(){p.search=h.search();var e,t=h.search().q,n=h.search().page,r=h.search()["page-lessons"],l=h.search().sort,d=h.search().filter,f=h.search().collection,i=h.search()["saved-search-id"]||y.defaultSavedSearchId,o=("all-classes"===i&&(i=""),h.path().split("/")),a=o[2],o=o[3],s=[],c=(a&&(e="/"+a,o&&(e+="/"+o),s.push(e)),y.taxonomies=s,y.category=a,y.topic=o,y.page=n,y.pageLessons=r,y.query=t,y.sort=l,y.filter=d,y.collection=f,y.savedSearchIds=i&&i.split(","),{category:y.category,topic:y.topic,tags:[],filter:y.filter||"",collection:y.collection||"",sort:y.sort||"popular",taxonomies:y.taxonomies,text:y.query,q:y.query,savedSearchIds:y.savedSearchIds}),u=m.search;switch(y.savedSearchIds[0]){case"owned-classes":y.query?v&&v.context&&v.context.session&&v.context.session.contentRights&&(c.courseIds=v.context.session.contentRights.purchased.courses):u=b;break;case"saved-classes":y.query?v&&v.context&&v.context.session&&v.context.session.contentRights&&(c.courseIds=v.context.session.contentRights.starred.courses):u=_}u(c,{limit:y.limit,page:y.page},{limit:y.limitLesson,from:y.pageLessons?(y.pageLessons-1)*y.limitLesson:0,force:v.config.catalog.showLessons,populated:!0,slim:!0,order:"desc"}).then(function(e){!function(e){var t=arguments;g.each(y.registeredEvent[e],function(e){e&&e.apply(this,t)})}("searchResult",e)},function(e){})}function b(t,n){var e,r=i.defer();return v&&v.context&&v.context.session&&v.context.session.contentRights&&(e=v.context.session.contentRights,m.getCoursesByIds(e.purchased.courses).then(function(e){o(e,t,n,r)})),r.promise}function _(t,n){var e,r=i.defer();return v&&v.context&&v.context.session&&v.context.session.contentRights&&(e=v.context.session.contentRights,m.getCoursesByIds(e.starred.courses).then(function(e){o(e,t,n,r)})),r.promise}function o(e,r,t,n){var e=g.reduce(e,function(e,t){var n=g.chain(t.taxonomy).pluck("path").map(function(e){return"/"+e}).value(),n=(t&&t.primary_category&&n.push("/"+t.primary_category.slug),g.intersection(n,r.taxonomies));return r.taxonomies&&r.taxonomies.length&&!n.length||e.push({id:t._id,type:"course"}),e},[]),i=(t.page=t.page||1,(t.page-1)*t.limit),o=i+t.limit,e={courses:{counts:{exact:e.length},exact:e.slice(i,o)},lessons:[],total:t.limit};return n.resolve(e)}g.extend(y,{init:function(e){if(y.ready)return y;y.ready=!0,p.$on("$locationChangeSuccess",n),t.init(y),(p.user.hasActiveConsumerSubscription()||p.user.hasActiveEnterpriseSubscription())&&(y.defaultSavedSearchId=p.user.getActiveSubscriptionsContentIds());e||n();return y},taxonomies:[],query:"",page:1,limit:24,limitLesson:24,defaultSavedSearchId:"",registeredEvent:{},on:function(e,t){y.registeredEvent[e]||(y.registeredEvent[e]=[]);y.registeredEvent[e].push(t)},off:function(n,r){g.each(y.registeredEvent[n],function(e,t){e===r&&y.registeredEvent[n].splice(t,1)})}})}r.$inject=["$rootScope","$location","CatalogService","CatalogAnalyticsService","_","$q","rind"],t.exports=r},{}],386:[function(e,t,n){"use strict";t.exports=["CatalogService",function(e){return{restrict:"E",scope:{course:"<",badgeCounts:"=?",location:"<"},templateUrl:function(e,t){return"catalog"===t.location?"/templates/cl-course-badge/catalogBadge.html":(t.location,"/templates/cl-course-badge/courseBadge.html")},link:function(e,t,n){e.mostPopular=!1,e.trending=!1,e.staffFavorite=!1,e.newClass=!1;var r=e.course;r.slug&&(r&&r.badges&&r.badges.most_popular&&(e.mostPopular=!0),r&&r.badges&&r.badges.trending&&(e.mostPopular||(e.trending=!0)),r&&r.badges&&r.badges.staff_favorite&&(e.mostPopular||e.trending||(e.staffFavorite=!0)),r&&r.badges&&r.badges.new&&(e.mostPopular||e.trending||e.staffFavorite||(e.newClass=!0)))}}}]},{}],387:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseBadge",e("./directives/badge"))},{"../../common/app":70,"./directives/badge":386}],388:[function(e,t,n){"use strict";var u=e("deepval");t.exports=["$rootScope","$window","$location","$filter","$uibModal","mediaResource","trackFactory",function(e,t,o,a,n,s,c){return{restrict:"AE",templateUrl:"/templates/cl-course-summary/summary.html",scope:{product:"="},link:function(n,e,t){var r,i;n.product&&(r=(i=n.product).cross_sells?"anchor":"cross",angular.extend(n,{onVideoPlayerReady:function(){var t=n.$watch("playUrl",function(e){e&&(n.$broadcast("video:queue",{playUrl:e,posterUrl:n.product.image}),t(),n.$broadcast("video:send-command","play"),c.onDemandVideoView(n.product))})},seeMore:function(){o.path(n.productLink)},productId:n.product._id,productLink:a("linkToProduct")(n.product)+"?via=course-summary-modal_"+r}),"anchor"!=r&&"cross"!=r||angular.extend(n,{productTitle:i.title||i.source.title,productShortTitle:i.short_title||i.source.short_title,productInstructors:i.instructors||i.source.instructors,productDescription:i.description||i.source.description,productImage:i.image||i.source.image,productTagline:i.tagline||i.source.tagline,isCrossSell:"cross"==r}),!n.product.hasPromoVideo&&"promo"!==u(n.product,"source.media.0.type")||(i=n.product.promo?u(n.product,"promo.0.media._id"):u(n.product,"source.media.0.media"),s.tokenById({id:i},function(e){e&&e.data&&(n.playUrl=e.data.playUrl)})))}}}]},{deepval:38}],389:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("clCourseSummaryModal",e("./services/clCourseSummaryModal")),r.directive("clCourseSummary",e("./directives/summary"))},{"../../common/app":70,"./directives/summary":388,"./services/clCourseSummaryModal":390}],390:[function(e,t,n){"use strict";t.exports=["$rootScope","$uibModal","trackFactory",function(e,t,i){return function(r){t.open({templateUrl:"/templates/cl-course-summary/modal.html",windowClass:"cl-modal modal-course-summary",controller:["$scope","$uibModalInstance",function(e,t){function n(){t.dismiss()}r.product&&(e.product=r.product,e.$on("cart:updated",function(e,t){n()}),angular.extend(e,{abort:function(){n(),i.clearMediaViewInterval(),i.courseSummaryModal(e.product,null,"x")}}),r.dismiss&&(e.dismiss=!0))}]}).result.finally(function(){i.clearMediaViewInterval()})}}]},{}],391:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/cl-ent-checkout/cms.html",replace:!0,link:function(e,t,n){e.config=r,e.edit=e.$parent.edit,e.data||(e.data=e.$parent.data||n.data&&JSON.parse(n.data))}}}]},{}],392:[function(e,t,n){"use strict";t.exports=[function(e){return{restrict:"AE",scope:{},templateUrl:"/templates/cl-ent-checkout/edit.html",replace:!0,link:function(t,e,n){t.data=t.$parent.data,t.data.skus=t.data.skus||"",t.data.termsLink=t.data.termsLink||"/enterprise/msa",t.data.redirectOnSuccess=t.data.redirectOnSuccess||"",t.data.buttonText=t.data.buttonText||"COMPLETE PURCHASE",t.data.subscriptionId=t.data.subscriptionId||"",t.data.seatPricing=t.data.seatPricing||"",t.data.itemsHeader=t.data.itemsHeader||"ITEMS",t.data.signedInAsHeader=t.data.signedInAsHeader||"SIGNED-IN AS",t.data.seatSelectionHeader=t.data.seatSelectionHeader||"TEAM MEMBERS",t.data.billingContactHeader=t.data.billingContactHeader||"BILLING CONTACT",t.data.billingAddressHeader=t.data.billingAddressHeader||"BILLING ADDRESS",t.data.billingPaymentHeader=t.data.billingPaymentHeader||"BILLING PAYMENT",t.data.paymentSummaryHeader=t.data.paymentSummaryHeader||"PAYMENT SUMMARY",t.data.payPeriodHeader=t.data.payPeriodHeader||"PAY PERIOD",angular.extend(t,{addSku:function(e){t.data.skus=e.sku||""}})}}}]},{}],393:[function(e,t,n){"use strict";t.exports=["config","$timeout","$window","$document",function(i,e,t,n){return{restrict:"AE",scope:{skus:"@",termsLink:"@",redirectOnSuccess:"@",buttonText:"@",subscriptionId:"@",seatPricing:"@",itemsHeader:"@",signedInAsHeader:"@",seatSelectionHeader:"@",billingContactHeader:"@",billingAddressHeader:"@",billingPaymentHeader:"@",paymentSummaryHeader:"@",payPeriodHeader:"@"},templateUrl:function(e,t){return"/templates/cl-ent-checkout/view.html"},replace:!0,link:function(e,t,n,r){e.config=i}}}]},{}],394:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clEntCheckout",e("./directives/view")),r.directive("clEntCheckoutCms",e("./directives/cms/cms")),r.directive("clEntCheckoutCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/cms":391,"./directives/cms/edit":392,"./directives/view":393}],395:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/checkout-view.html",transclude:{billingcontact:"billingcontact",payment:"payment"},controller:["$q","_","$scope","$rootScope","$timeout","$filter","EnterpriseService","EnterpriseSubscriptionService","AnalyticsService","VAT",function(l,n,e,t,r,d,f,p,h,m){var i=this,o=t.user,a=p.cart,g=!1,s=o.get("profile")||{},v=o.get("primary_email")||{};function c(e){i.vatError=e,a.isVatValid=!e}function u(e){var t={};i.userLoggedIn&&(i.accountInfo.email=o.get("primary_email").address),a.accountInfo=i.accountInfo,a.paymentInfo=i.paymentInfo,t=i.companyNameInvalid?{companyNameInvalid:!0}:{companyNameInvalid:!1},r(function(){e&&a.updateTotal(),a.validateCheckoutForm(t)})}angular.extend(i,{$onInit:function(){angular.extend(i,{accountInfo:{firstName:s.first_name,lastName:s.last_name,companyName:null,email:v.address,phoneNumber:s.phoneNumber,country:s.country,state:s.state,city:null,address:null,extendedAddress:null,postalCode:s.postalCode,vat:{},vatExemptCodeValid:!1},paymentInfo:{creditCard:null,expirationMonth:null,expirationYear:null,cvv:null},processing:!1,subTotal:0,companyNameInvalid:!1,showVat:!1,vatError:!1}),e.$watch(function(){return i.accountInfo.country},function(e){e&&(i.showVat=e.vat&&m.isVATCountry(e.code),i.accountInfo.vat={})}),e.$watch(function(){return a.total},function(e){i.subTotal=e}),e.$watch(function(){return a.isPriceFlat},function(e){i.isPriceFlat=e}),e.$watch(function(){return a.isPricePer},function(e){i.isPricePer=e}),e.$watch(function(){return i.accountInfo.vat.full},function(e){e||(i.accountInfo.vatExemptCodeValid=!1,c(!1),u(!0))}),e.$watch(function(){return a.userLoggedIn},function(e){e&&(i.accountInfo.email=o.get("primary_email").address),i.userLoggedIn=e,r(function(){a.validateCheckoutForm()},0)}),e.$on("user:login",a.isLoggedIn.bind(a)),e.$on("user:register",a.isLoggedIn.bind(a)),a.isLoggedIn()},productsNotPurchased:[],isPriceFlat:!1,isPricePer:!1,updateFormData:u,checkoutInvalid:{},userLoggedIn:!1,validateCompanyName:n.throttle(function(){(!i.accountInfo.companyName||i.accountInfo.companyName.length<2)&&u();p.validateCompanyName(i.accountInfo.companyName).then(function(e){i.companyNameInvalid=!e,u()})},200,{leading:!1}),applyVatExemptCode:function(){i.accountInfo.vatExemptCodeValid=!1,c(!1);var t={countryCode:i.accountInfo.country.code,number:i.accountInfo.vat.full.substr(2)},e=i.accountInfo.vat.full.substr(0,2).match(/[A-Za-z]{2}/),e=e&&e[0];if(!i.accountInfo.country.code&&e)t.countryCode=e.toUpperCase();else if(!e||i.accountInfo.country.code.toLowerCase()!==e.toLowerCase())return c(!0),void u(!0);!t.countryCode||2!==t.countryCode.length||t.number.length<8?(c(!0),u(!0)):m.verify(t.countryCode,t.number,function(e){if(!e.valid)return c(!0),void u(!0);i.accountInfo.vatExemptCodeValid=!0,e.vat_number&&(i.accountInfo.vat={full:t.countryCode+e.vat_number,countryCode:t.countryCode,number:e.vat_number},u(!0))})}}),e.$watchCollection(function(){return a.productsNotPurchased},function(e){e&&(!g&&0<e.length&&(h.track("Product Viewed",{user:t.user.get("_id"),products:n.map(e,function(t){var e=n.find(a.products,function(e){return e.sku===t});return{product_id:e._id,sku:e.sku,name:e.name}}),traits:t.user.get("traits"),category:"enterprise"}),g=!0),i.productsNotPurchased=e)}),e.$watch(function(){return a.checkoutInvalid},function(e){i.checkoutInvalid=e})}]}},{}],396:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/items.html",bindings:{skus:"@"},transclude:{header:"header"},controllerAs:"ctrl",controller:["_","$timeout","$scope","$transclude","SubscriptionService","EnterpriseSubscriptionService",function(t,n,e,r,i,o){var a=this,s=o.cart;angular.extend(a,{items:{},selectedItems:null,$onInit:function(){s.getProducts(a.skus).then(function(e){s.isPriceFlat=!1,s.isPricePer=!1,a.isPriceFlat=!1,a.isPricePer=!1,e&&e[0]&&e[0].pricing&&e[0].pricing[0]&&(e[0].pricing[0].priceFlat&&(s.isPriceFlat=!0,a.isPriceFlat=!0),e[0].pricing[0].pricePer&&(s.isPricePer=!0,a.isPricePer=!0)),t.each(e,function(e){t.each(e.pricing,function(e){s.minSeats=0===s.minSeats||s.minSeats>e.seatRange.start?e.seatRange.start:s.minSeats,s.maxSeats=0===s.maxSeats||s.maxSeats<e.seatRange.end?e.seatRange.end:s.maxSeats})}),s.products=e}),s.getCurrentSubscriptionSkus().then(function(e){s.currentSubscriptionSkus=e}),e.$watch(function(){return s.products},function(e){a.items=e,s.getProductsNotPurchased()}),e.$watch(function(){return s.currentSubscriptionSkus},function(e){a.currentSubscriptionSkusObj=e,s.getProductsNotPurchased()}),e.$watchCollection(function(){return s.productsNotPurchased},function(e,t){a.productsNotPurchased=e||[]})},selectItem:function(e){a.selectedItem=e},updateItemsInCart:function(e){var t="";e.currentTarget.name&&(t=e.currentTarget.name,e.currentTarget.checked?s.addToCart(t):s.removeFromCart(t))},initItemsInCart:function(e){{var t;e&&(t="#"+e,n(function(){angular.element(t).attr({checked:"checked",disabled:!0}).triggerHandler("click")}))}},currentSubscriptionSkusObj:{},isPriceFlat:!1,isPricePer:!1,productsNotPurchased:[],hasCartItems:function(){return s.getCartQty()},selectpriceFlatItem:function(e,t,n,r,i,o){a.selectedIndex=t,s.updatepriceFlatCart(n,r,i,o)},selectedIndex:null})}]}},{}],397:[function(e,t,n){"use strict";function r(e,t){var n=this;angular.extend(n,{$onInit:function(){angular.extend(n,{})}})}r.$inject=["$q","_"],t.exports={bindings:{skus:"@",termsLink:"@",redirectOnSuccess:"@",buttonText:"@"},templateUrl:"/templates/cl-ent-subscription-checkout/main.html",transclude:{subscriptionId:"subscriptionId",seatPricing:"seatPricing",itemsHeader:"itemsHeader",signedInAsHeader:"signedInAsHeader",seatSelectionHeader:"seatSelectionHeader",billingContactHeader:"billingContactHeader",billingAddressHeader:"billingAddressHeader",billingPaymentHeader:"billingPaymentHeader",paymentSummaryHeader:"paymentSummaryHeader",payPeriodHeader:"payPeriodHeader"},controllerAs:"ctrl",controller:r}},{}],398:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/pay-periods.html",transclude:{header:"header"},controllerAs:"ctrl",controller:["$scope","EnterpriseSubscriptionService",function(e,t){var o,n=this;function r(e,t){var n=e.type;!e.type&&t&&t.currentTarget&&t.currentTarget.id&&(n=t.currentTarget.id),o.updateTotal(e,n)}n.isPriceFlat||(o=t.cart,angular.extend(n,{prices:o.prices,selectPayPeriod:function(e){o.payPeriod=e},updateTotal:r,$onInit:function(){e.$watchCollection(function(){return o.pricingObj},function(e){var r,i;r=(e=e)&&e.prices?e.prices:{},i=e&&(e.seats>=parseInt(o.minSeats)||e.seats<=parseInt(o.maxSeats))?e.seats:0,n.prices=i<=0?{}:Object.keys(r).map(function(e){var t=0,n=0;return r[e].forEach(function(e){n+=parseInt(e)},this),t+=parseInt(n)*parseInt(i),{type:e,pricePerSeat:o.pricePerSeatSelected=n,pricePerPeriod:t}})}),e.$watchCollection(function(){return n.prices},function(e){_.isEmpty(e)&&r({})})},productsNotPurchased:[],isPriceFlat:!1,isPricePer:!1}),e.$watchCollection(function(){return o.productsNotPurchased},function(e,t){n.productsNotPurchased=e||[]}),e.$watch(function(){return o.isPriceFlat},function(e){n.isPriceFlat=e}),e.$watch(function(){return o.isPricePer},function(e){n.isPricePer=e}))}]}},{}],399:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/seats-input.html",bindings:{onEdit:"&",onSubmit:"&"},transclude:{header:"header"},controllerAs:"ctrl",controller:["$scope","EnterpriseSubscriptionService",function(e,t){var n=this,r=t.cart;function i(){if(!n.seats||n.seats<parseInt(r.minSeats)||n.seats>parseInt(r.maxSeats))return n.seatsInBounds=!1,void r.setSeats(0);n.seatsInBounds=!0,r.setSeats(n.seats)}angular.extend(n,{payPeriods:[],selectedPayPeriod:null,$onInit:function(){n.seatsInBounds=!1,n.showSeatsTooltip=!1},setSeats:i,hasCartItems:function(){return r.getCartQty()},productsNotPurchased:[],isPriceFlat:!1,isPricePer:!1,seatsInBounds:!0,showSeatsTooltip:!1,updateFormData:function(){r.validateCheckoutForm()},userLoggedIn:!1}),e.$watchCollection(function(){return r.productsNotPurchased},function(e,t){n.productsNotPurchased=e||[]}),e.$watch(function(){return r.minSeats},function(e){n.minSeats=parseInt(e),n.maxSeats=parseInt(r.maxSeats),n.seats=parseInt(e),i()}),e.$watch(function(){return r.userLoggedIn},function(e){n.userLoggedIn=e}),e.$watch(function(){return r.isPriceFlat},function(e){n.isPriceFlat=e}),e.$watch(function(){return r.isPricePer},function(e){n.isPricePer=e})}]}},{}],400:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/summary.html",bindings:{termsLink:"@",redirectOnSuccess:"@",buttonText:"@"},transclude:{header:"header"},controllerAs:"ctrl",controller:["$q","_","$scope","$rootScope","$filter","EnterpriseService","EnterpriseSubscriptionService",function(e,t,n,r,i,u,o){var a=this,s=o.cart;function c(){s.orderResponse={}}angular.extend(a,{$onInit:function(){s.validateCheckoutForm(),angular.extend(a,{processing:!1,orderResponse:{},subTotal:0,tax:0,total:0,seats:0,payPeriod:"",pricePer:0,pricePerSeatSelected:0,billingPeriod:"",invalid:!0,enterpriseCartAgreement:!1,resetOrderResponse:c,isPriceFlat:!1,isPricePer:!1}),n.$watch(function(){return s.total},function(e){a.subTotal=s.subTotal,a.tax=s.tax,a.total=e,a.seats=s.seats,a.payPeriod=s.payPeriod,a.pricePerSeatSelected=s.pricePerSeatSelected,a.billingPeriod=s.billingPeriod}),n.$watchCollection(function(){return s.checkoutInvalid},function(e){a.invalid=!!Object.keys(e).length}),n.$watch(function(){return s.pricingObj.prices},function(e){e&&e[s.payPeriod]&&e[s.payPeriod].length?(a.pricePer=0,e[s.payPeriod].map(function(e){a.pricePer+=e})):a.pricePer=0}),n.$watchCollection(function(){return s.orderResponse},function(e){a.processing=!1,e&&(a.orderResponse=e)}),n.$watch(function(){return s.userLoggedIn},function(e){e&&(a.email=r.user.get("primary_email").address),a.userLoggedIn=e,s.validateCheckoutForm()}),n.$watch(function(){return s.isPriceFlat},function(e){a.isPriceFlat=e}),n.$watch(function(){return s.isPricePer},function(e){a.isPricePer=e})},productsNotPurchased:[],submit:function(){a.processing=!0,s.submit(a.redirectOnSuccess)},email:null,userLoggedIn:!1}),n.$watchCollection(function(){return s.productsNotPurchased},function(e){a.productsNotPurchased=e||[]})}]}},{}],401:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/cl-ent-subscription-checkout/usersignedinas.html",transclude:{header:"header"},controllerAs:"ctrl",controller:["$rootScope","$scope","$timeout","EnterpriseSubscriptionService",function(t,e,n,r){var i=this,o=r.cart;angular.extend(i,{$onInit:function(){e.$watchCollection(function(){return o.productsNotPurchased},function(e,t){i.productsNotPurchased=e||[]}),e.$watch(function(){return o.userLoggedIn},function(e){e&&(i.email=t.user.get("primary_email").address,o.accountInfo.email=i.email),i.userLoggedIn=e,n(function(){o.validateCheckoutForm()},0)}),e.$watch(function(){return o.isPriceFlat},function(e){i.isPriceFlat=e}),e.$watch(function(){return o.isPricePer},function(e){i.isPricePer=e})},email:null,userLoggedIn:!1,productsNotPurchased:[],isPriceFlat:!1,isPricePer:!1})}]}},{}],402:[function(e,t,n){"use strict";var r=e("../../common/app");r.component("clEntSubscriptionCheckout",e("./components/main")),r.component("clEntSubscriptionCheckoutView",e("./components/checkout-view")),r.component("clEntSubscriptionItems",e("./components/items")),r.component("clEntSubscriptionPayPeriods",e("./components/pay-periods")),r.component("clEntSubscriptionSeats",e("./components/seats")),r.component("clEntSubscriptionSummary",e("./components/summary")),r.component("clEntSubscriptionSignedInAs",e("./components/usersignedinas")),r.service("EnterpriseSubscriptionService",e("./services/main")),r.factory("EnterpriseSubscriptionCartService",e("./services/cart")),r.factory("EnterpriseSubscriptionPriceService",e("./services/price")),r.factory("EnterpriseSubscriptionTaxService",e("./services/tax"))},{"../../common/app":70,"./components/checkout-view":395,"./components/items":396,"./components/main":397,"./components/pay-periods":398,"./components/seats":399,"./components/summary":400,"./components/usersignedinas":401,"./services/cart":403,"./services/main":404,"./services/price":405,"./services/tax":406}],403:[function(e,t,n){"use strict";var E=e("@creativelive/federation/dist/federation.min");t.exports=["_","$rootScope","$timeout","EnterpriseService","EnterpriseSubscriptionPriceService","SubscriptionService","$q","AnalyticsService","CaptchaService","$http","responseUtils","deepval","config",function(s,c,u,i,r,o,l,d,p,a,h,n,m){var f=new E,g=(new Date).getFullYear(),v=new r;function e(){angular.extend(this,{items:{},userLoggedIn:!1,products:[],isPriceFlat:!1,isPricePer:!1,isVatValid:!1,currentSubscriptionSkus:{},productsNotPurchased:[],seats:0,maxSeats:0,minSeats:0,pricingObj:{prices:{},seats:0},price:null,orderResponse:{},getPrices:S,payPeriod:"",updateTotal:b,subTotal:0,tax:0,total:0,pricePerSeatSelected:0,priceFlat:0,accountInfo:{firstName:null,lastName:null,email:null,phoneNumber:null,companyName:null,country:null,state:null,city:null,address:null,extendedAddress:null,postalCode:null},paymentInfo:{creditCard:null,expirationMonth:null,expirationYear:null,cvv:null},checkoutInvalid:{}})}return i.getToken().then(function(e){f.gatewayService.connect(e)}).catch(function(e){}),angular.extend(e.prototype,{getProducts:function(e){return i.getEnterpriseProductsBySkus({skus:e}).then(function(e){if(e&&e.length)return e})},getCurrentSubscriptionSkus:function(){var t={};return o.getSubscriptionsByUser().then(function(e){return e.forEach(function(e){e.enterpriseProduct&&e.enterpriseProduct.sku&&(t[e.enterpriseProduct.sku]=!0)}),t})},getProductsNotPurchased:function(){var t=[],e=this.products,n=this.currentSubscriptionSkus;e&&0<e.length&&e.forEach(function(e){(Object.keys(n).length<=0||0<Object.keys(n).length&&!n[e.sku])&&t.push(e.sku)});return this.productsNotPurchased=t,this.productsNotPurchased},setSeats:y,addToCart:function(t){var e;!t&&this.products[t]||(e=s.find(this.products,function(e){return e.sku===t}),d.track("Product Added",{user:c.user.get("_id"),products:[{product_id:e._id,sku:e.sku,name:e.name}],traits:c.user.get("traits"),category:"enterprise"}),this.items[t]=t,this.getPrices())},removeFromCart:function(t){var e;t&&(e=s.find(this.products,function(e){return e.sku===t}),d.track("Product Removed",{user:c.user.get("_id"),products:[{product_id:e._id,sku:e.sku,name:e.name}],traits:c.user.get("traits"),category:"enterprise"}),delete this.items[t],this.getPrices())},getCartQty:t,hasCartItems:function(){if(0<t())return!0;return!1},validateCheckoutForm:function(e){var t=this;!t.seats||t.seats<parseInt(t.minSeats)||t.seats>parseInt(t.maxSeats)?t.checkoutInvalid.seats=!0:delete t.checkoutInvalid.seats;t.total?delete t.checkoutInvalid.total:t.checkoutInvalid.total=!0;!t.accountInfo.firstName||t.accountInfo.firstName.length<2?t.checkoutInvalid.firstName=!0:delete t.checkoutInvalid.firstName;!t.accountInfo.lastName||t.accountInfo.lastName.length<2?t.checkoutInvalid.lastName=!0:delete t.checkoutInvalid.lastName;t.accountInfo.email&&function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}(t.accountInfo.email)?delete t.checkoutInvalid.email:t.checkoutInvalid.email=!0;!t.accountInfo.companyName||t.accountInfo.companyName.length<2||e&&e.companyNameInvalid?t.checkoutInvalid.companyName=!0:delete t.checkoutInvalid.companyName;t.accountInfo.phoneNumber&&function(e){return e=(e=(e=e.replace(/\s/g,"")).replace(/-/g,"")).replace(/\./g,""),/([0-9]\d{9})/.test(e)}(t.accountInfo.phoneNumber)?delete t.checkoutInvalid.phoneNumber:t.checkoutInvalid.phoneNumber=!0;!t.accountInfo.country||!t.accountInfo.country.code||t.accountInfo.country.code.length<2?t.checkoutInvalid.country=!0:delete t.checkoutInvalid.country;!t.accountInfo.state||!t.accountInfo.state.name||t.accountInfo.state.name.length<2||t.accountInfo.country&&"US"===t.accountInfo.country.code&&!t.accountInfo.state.code?t.checkoutInvalid.state=!0:delete t.checkoutInvalid.state;!t.accountInfo.city||!t.accountInfo.city||t.accountInfo.city.length<2?t.checkoutInvalid.city=!0:delete t.checkoutInvalid.city;!t.accountInfo.address||t.accountInfo.address.length<6?t.checkoutInvalid.address=!0:delete t.checkoutInvalid.address;!t.accountInfo.postalCode||t.accountInfo.postalCode<2?t.checkoutInvalid.postalCode=!0:delete t.checkoutInvalid.postalCode;t.paymentInfo.creditCard&&function(e){return 12<(e=e.replace(/\s/g,"")).length&&e.length<20}(t.paymentInfo.creditCard)?delete t.checkoutInvalid.creditCard:t.checkoutInvalid.creditCard=!0;!t.paymentInfo.expirationMonth||parseInt(t.paymentInfo.expirationMonth)<1||12<parseInt(t.paymentInfo.expirationMonth)?t.checkoutInvalid.expirationMonth=!0:delete t.checkoutInvalid.expirationMonth;!t.paymentInfo.expirationYear||parseInt(t.paymentInfo.expirationYear)<g?t.checkoutInvalid.expirationYear=!0:delete t.checkoutInvalid.expirationYear;!t.paymentInfo.cvv||!/^(\d*)$/.test(t.paymentInfo.cvv)||t.paymentInfo.cvv.toString().split("").length<3||4<t.paymentInfo.cvv.toString().split("").length?t.checkoutInvalid.cvv=!0:delete t.checkoutInvalid.cvv;return t.checkoutInvalid},submit:function(t){var n,o,a=this,r={items:Object.keys(a.items),seats:a.seats,payPeriod:a.payPeriod,traits:c.user.get("traits")};a.priceFlat&&0<a.priceFlat&&(r.priceFlat=a.priceFlat);a.pricePerSeatSelected&&0<a.pricePerSeatSelected&&(r.pricePerSeat=a.pricePerSeatSelected);if(r.seats&&!(0<!r.items.length)&&r.payPeriod)return d.track("Checkout Started",{user:c.user.get("_id"),products:s.map(a.items,function(t){var e=s.find(a.products,function(e){return e.sku===t}),n=Math.round(a.total/100)||0;return{product_id:e._id,sku:e.sku,name:e.name,price:n}}),traits:c.user.get("traits"),category:"enterprise",seats:a.seats,subtotal:a.subTotal,tax:a.tax,total:a.total}),(n=angular.copy(a.paymentInfo))&&"string"==typeof n.creditCard&&(n.creditCard=n.creditCard.trim()),o=void(a.isVatValid||(a.accountInfo.vat={})),function(){var t=l.defer();return p.getCaptcha("enterpriseOrderCreate",function(e){t.resolve(e)}),t.promise}().then(function(e){return o=e,r=angular.copy(a.accountInfo),i=n,l(function(t,n){f.gatewayService.getNonce(r,i).then(function(e){t(e)}).catch(function(e){n(e)})});var r,i}).then(function(e){return i.checkout(a.accountInfo,e,r,o)}).then(function(e){u(function(){_.call(a,e,300,t)},300)}).catch(function(e){w.call(a,e)})},isLoggedIn:function(){c.user&&c.user.valid()?this.userLoggedIn=!0:this.userLoggedIn=!1;return this.userLoggedIn},updatepriceFlatCart:function(t,e,n,r){var i,o=this;!t&&this.products[t]||(i=s.find(this.products,function(e){return e.sku===t}),d.track("Flat Rate Product Cart Update",{user:c.user.get("_id"),products:[{product_id:i._id,sku:i.sku,name:i.name}],traits:c.user.get("traits"),category:"enterprise"}),o.items[t]=t,y.call(o,e),!r||r<1?(o.total=0,o.pricePerSeatSelected=0,o.priceFlat=0,o.payPeriod=""):(o.total=r,o.pricePerSeatSelected=0,o.priceFlat=r,o.payPeriod=n))}}),e;function t(){return Object.keys(this.items).length}function y(e){e?this.seats=e:(this.seats=0,this.pricingObj={},this.total=0),this.getPrices()}function b(t,n){var r=this;!(t=t||r.price)||!t.pricePerPeriod||t.pricePerPeriod<=0||!t.pricePerSeat||t.pricePerSeat<=0?(r.subTotal=0,r.tax=0,r.total=0,r.pricePerSeatSelected=0,r.priceFlat=0,r.payPeriod=""):(r.price=t,v.getTotal(r.accountInfo,t.pricePerPeriod).then(function(e){r.subTotal=t.pricePerPeriod,r.tax=e,r.total=r.subTotal+r.tax,r.pricePerSeatSelected=t.pricePerSeat,r.priceFlat=0,r.payPeriod=n||t.type}))}function _(t,n,r){var i=this;t&&angular.isString(t)&&h.wrapRawResponse(a({method:"GET",url:"/api"+t})).then(function(e){return e?"created"===e||"processing"===e?_.call(i,t,2*n):"voided"===e?new Error("Order Voided"):"completed"!==e?new Error("Unknown response"):(i.orderResponse={success:!0,message:e,time:new Date},d.track("Checkout Completed",{user:c.user.get("_id"),products:s.map(i.items,function(t){var e=s.find(i.products,function(e){return e.sku===t});return{product_id:e._id,sku:e.sku,name:e.name}}),traits:c.user.get("traits"),category:"enterprise",seats:i.seats,total:i.total}),c.$broadcast("user:addSubscription"),void(r&&r.length&&u(function(){window.location.href=r},2500))):new Error("No response")}).catch(function(e){d.track("Checkout Cancelled",{user:c.user.get("_id"),products:s.map(i.items,function(t){var e=s.find(i.products,function(e){return e.sku===t});return{product_id:e._id,sku:e.sku,name:e.name}}),traits:c.user.get("traits"),category:"enterprise"}),w.call(i,e)})}function w(e){var t;e&&(t=e.message,e.data&&e.data.status&&(t=e.data.status),e.data&&e.data.data&&e.data.data.status&&(t=e.data.data.status),n(e||{},"details.originalError.error.message")&&(t=n(e||{},"details.originalError.error.message")),this.orderResponse={error:!0,message:t,time:new Date})}function S(){var n=this;n.seats<=0||s.isEmpty(n.items)?this.pricingObj={prices:{},seats:0}:(n.pricingObj.prices=[],n.pricingObj.seats=n.seats,s.values(n.products).forEach(function(e){var t=e;e.pricing.forEach(function(e){t&&t.sku&&n.items[t.sku]&&e&&e.seatRange&&e.seatRange.end>=n.pricingObj.seats&&e.seatRange.start<=n.pricingObj.seats&&(Array.isArray(n.pricingObj.prices[e.payPeriod])||(n.pricingObj.prices[e.payPeriod]=[]),n.pricingObj.prices[e.payPeriod].push(e.pricePer))})}),this.pricingObj=n.pricingObj)}}]},{"@creativelive/federation/dist/federation.min":4}],404:[function(e,t,n){"use strict";t.exports=["$q","Slug","EnterpriseSubscriptionCartService","EnterpriseSubscriptionPriceService","SubscriptionService","EnterpriseService",function(e,n,t,r,i,o){this.cart=new t,this.price=new r,this.validateCompanyName=function(t){var e=t&&t.replace(/[^\w\s-]/g,"-"),e=n.slugify(e).replace(/^-+|-$/g,"");return i.getSubscriptionBySlug(e).then(function(){return!1}).catch(function(e){return o.getByName(t).then(function(e){return!e}).catch(function(){return!0})})}}]},{}],405:[function(e,t,n){"use strict";t.exports=["EnterpriseSubscriptionTaxService","$q",function(e,n){return function(){angular.extend(this,{getTotal:t,taxService:new e})};function t(e,t){return e&&t?this.taxService.calculateTax(e,t):n.reject("err")}}]},{}],406:[function(e,t,n){"use strict";t.exports=["_","$q","Ecommerce",function(n,r,i){function e(e,t){return!e.country||n.isUndefined(t)||e.vatExemptCodeValid?r.resolve(0):i.getTax({billingInfo:n.extend({selectedState:e.state},e),amount:t}).$promise.then(function(e){if(e.success)return e.data.total})}return function(){this.tax=0,this.calculateTax=e}}]},{}],407:[function(e,t,n){"use strict";function r(s,c,u){return{restrict:"AE",templateUrl:function(e,t){return t.template||"/templates/cl-filters/list-checkbox.html"},replace:!0,link:function(n,e,o){n.bold="true"===o.bold;var t=s.search()[o.filterKey]||o.filterDefault;function r(){u.each(n.filters,function(e){i(e)?e.display=!0:e.display=!1})}function i(e){var t=!1;return e&&(e.conditions||(t=!0),u.each(e.conditions,function(e){s.search()[e.param]===e.value&&(t=!0),s.search()[e.param]||e.value||(t=!0)})),t}function a(e,t,n){return t===o.filterKey&&n===o.filterDefault?e:(""!==e&&(e+="&"),e+(t+"=")+n)}t&&(n.queryFilter=u.findWhere(n.filters,{slug:t})),c.$on("$locationChangeSuccess",function(){var e=s.search()[o.filterKey]||o.filterDefault;r(),i(n.queryFilter)?n.queryFilter&&e===n.queryFilter.slug||(n.queryFilter=u.findWhere(n.filters,{slug:e})):(s.search(o.filterKey,null),o.filterDefault&&(n.queryFilter=u.findWhere(n.filters,{slug:o.filterDefault})))}),r(),n.onSelectFilter=function(e,t){e&&e.preventDefault(),n.open=!1,n.$emit("filter:selected",o.module||"catalog",o.filterKey,t.label),(n.queryFilter=t).slug&&t.slug!==o.filterDefault?s.search(o.filterKey,t.slug):s.search(o.filterKey,null)},n.onRemoveFilter=function(e,t){e&&e.preventDefault(),n.queryFilter=null,s.search(o.filterKey,null)},n.getQueryFilterLink=function(n){var e=s.search(),r="",i=!1,t=s.url().split("?")[0];return u.each(e,function(e,t){t===o.filterKey&&(e=n.slug,i=!0),r=a(r,t,e)}),t+"?"+(r=i?r:a(r,o.filterKey,n.slug))}}}}r.$inject=["$location","$rootScope","_"],t.exports=r},{}],408:[function(e,t,n){"use strict";e("../../common/app").directive("clFilters",e("./directives/index"))},{"../../common/app":70,"./directives/index":407}],409:[function(e,t,n){"use strict";t.exports={bindings:{campaignId:"@",btnClasses:"@"},transclude:!0,template:'\n    <button class="btn {{ $ctrl.btnClasses }}" ng-click="$ctrl.open($ctrl.campaignId)">\n      <ng-transclude>Invite</ng-transclude> \n\t\t</button>\n  ',controller:["clFreeTrialInvitationModalService",function(e){this.btnClasses=this.btnClasses||"btn btn-dark",this.open=e}]}},{}],410:[function(e,t,n){"use strict";function r(n,e,t,l,r,i,d,f,o,a,p,s,h){var c=this,u=(i(function(){c.referrerMap=c.referrerMap&&!e.isEmpty(c.referrerMap)?JSON.parse(c.referrerMap):{}}),r.user.get("profile")),m=r.user.get("primary_email");function g(){r.user.Auth.logout(null,{noRedirect:!0}).then(function(e){o.localStorage.removeItem("token"),o.localStorage.removeItem("mcpUser"),r.user={},r.loggedIn=!1,o.location.reload()})}function v(){return s.track("Free Trial - Consumer Get Subscription Seat Start",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],email:c.email,traits:r.user.get("traits"),category:"consumer"}),a.getSubscriptionSeat(c.subscriptionId,"me").then(function(e){if(c.subscriptionId!==e.subscription)return s.track("Free Trial - Consumer Seat Does Not Exist",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,email:c.email,traits:r.user.get("traits"),category:"consumer"}),e;s.track("Free Trial - Consumer Seat Exists",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,email:c.email,traits:r.user.get("traits"),category:"consumer"}),i(function(){r.mcpReady||(""!==c.redirectOnSuccess?window.location=window.location.origin+c.redirectOnSuccess:c.hideOnSuccess&&(c.activated=!0),c.ready=!0)},100)})}angular.extend(c,{$onInit:function(){r.user.valid()?(c.userValid=!0,angular.extend(c,{email:m&&m.address||"",first_name:u&&u.first_name||"",last_name:u&&u.last_name||""}),v()):c.userValid=!1;r.mcpReady&&(c.showOnQs=!1,c.hideOnSuccess=!1)},submit:function(e){return e.preventDefault(),c.processing=!0,s.track("Free Trial - Consumer Login or Register",{traits:r.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"consumer"}),r.user.checkValidEmail(c.email).then(function(e){return e.success&&e.data?e.data.user?(s.track("Free Trial - Consumer Login Started",{traits:r.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"consumer"}),r.user.Auth.login({email:c.email,password:c.password,profile:{}}).then(function(e){return c.invalidPassword=!1,s.track("Free Trial - Consumer Login Success",{traits:r.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"consumer"}),v()}).catch(function(e){return c.invalidPassword=!0,e})):(s.track("Free Trial - Consumer Register User Started",{traits:r.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"consumer"}),r.user.Auth.register({email:c.email,password:c.password,profile:{}}).then(function(e){return s.track("Free Trial - Consumer Register User Success",{traits:r.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"consumer"}),e})):(t.error="Something went wrong. Please try again.",t.error)},function(){return t.error="Something went wrong",t.error}).then(function(){return n.all([function(){s.track("Free Trial - Consumer Sign-Up - Add User First and Last Name",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],user_name:[{first_name:c.first_name,last_name:c.last_name}],campaignId:c.campaignId,campaignName:c.campaignName,traits:r.user.get("traits"),category:"consumer"});var t={profile:{}};c.first_name&&(t.profile.first_name=c.first_name);c.last_name&&(t.profile.last_name=c.last_name);return 0!==Object.keys(t.profile).length?n(function(e){p.save(t,function(){e()})}):n.resolve()}(),function(){var t=null;{var e;c.referrer?(e={freeTrialReferrer:c.referrer},t=t?angular.extend(t,e):e):c.extraFieldValue&&(e=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},c.extraField,c.extraFieldValue),t=t?angular.extend(t,e):e)}return t?n(function(e){r.user.setTrait(t,!0,{},function(){e()})}):n.resolve()}(),r.user.setNotifications("me",{class_reminders:!1,marketing:!1,notifications:!1,optout:!0,partner:!1,special_offers:!1,upcoming_classes:!1}),(s.track("Free Trial - Consumer Activate Seat Started",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,traits:r.user.get("traits"),category:"consumer"}),a.createTrialSeat(c.subscriptionId,"me")),c.campaignId?a.sendTrialInvitation([c.email],c.campaignId):n.resolve()])}).then(function(){s.track("Free Trial - Consumer Activate Seat Success",{user:r.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,traits:r.user.get("traits"),category:"consumer"}),c.processing=!1,i(function(){r.mcpReady||(""!==c.redirectOnSuccess?window.location=window.location.origin+c.redirectOnSuccess:c.hideOnSuccess&&(c.activated=!0),c.ready=!0)},100)}).catch(function(){return!1})},getEmailErrorMessage:function(e){{var t;if(e.required)return t=i(function(){g(),i.cancel(t)},2e3),"You must register with your email address."}return""},setDisplayState:function(){var e=c.ready;if("true"===c.hideOnSuccess&&c.activated)return l.addClass("pad-top-none"),!1;null!==c.showOnQs&&void 0!==c.showOnQs&&""!==c.showOnQs&&(e=c.qs[c.showOnQs]);e||l.addClass("pad-top-none");return e},logoutReload:g,userValid:!1,processing:!1,invalidPassword:!1,inputChanged:e.once(function(e,t){s.track("Free Trial - Consumer Form Started",{input:[{element_name:e||"",value:t||""}],campaignId:c.campaignId,campaignName:c.campaignName,traits:r.user.get("traits"),category:"consumer"})}),referrer:{},activated:!1,qs:h(),hideOnSuccess:"true"===c.hideOnSuccess,extraFieldValue:null,ready:!1})}r.$inject=["$q","_","$scope","$element","$rootScope","$timeout","$filter","$location","$window","SubscriptionService","UserProfileService","AnalyticsService","parseQS"],t.exports={bindings:{campaignId:"@",subscriptionId:"@",redirectOnSuccess:"@",hideOnSuccess:"@",referrerMap:"@",campaignName:"@",showOnQs:"@",extraField:"@"},templateUrl:"/templates/cl-free-trial-onboarding-consumer/onboarding-consumer.html",transclude:{buttonText:"buttonText"},controller:r}},{}],411:[function(e,t,n){"use strict";var r=e("../../common/app");r.component("clFreeTrialOnboardingConsumer",e("./components/onboarding-consumer")),r.component("clFreeTrialConsumerInvitationCta",e("./components/invite-cta")),r.service("clFreeTrialConsumerInvitationModalService",e("./services/main"))},{"../../common/app":70,"./components/invite-cta":409,"./components/onboarding-consumer":410,"./services/main":412}],412:[function(e,t,n){"use strict";function r(e,n,t,r,i,o,a){return function(r){a.lock("FreeTrialInvitationModal"),i.disable();var e=n.open({templateUrl:"/templates/cl-free-trial-onboarding-consumer/invitation-modal.html",windowClass:"cl-modal",controllerAs:"$ctrl",controller:["$scope","$uibModalInstance",function(e,t){var n=this;angular.extend(this,{emails:"",getInputErrorMessage:function(e){return"multipleEmails"!==e?"Please enter a valid business email address":"Emails must be comma delimited"},submit:function(){o.sendTrialInvitation(n.emails,r).then(function(){t.dismiss()}).catch(function(e){n.error=e})}})}]});function t(){a.unlock("FreeTrialInvitationModal"),i.enable(),e=void 0}return e.result.then(t).catch(t)}}r.$inject=["$rootScope","$uibModal","rind","deepval","keyboard","SubscriptionService","LockBody"],t.exports=r},{}],413:[function(e,t,n){arguments[4][409][0].apply(n,arguments)},{dup:409}],414:[function(e,t,n){"use strict";function r(r,l,t,d,i,n,f,p,o,a,h,s,m){var c=this,e=(n(function(){c.referrerMap=c.referrerMap&&!l.isEmpty(c.referrerMap)?JSON.parse(c.referrerMap):{}}),i.user.get("profile")),u=i.user.get("company"),g=i.user.get("primary_email");function v(){i.user.Auth.logout(null,{noRedirect:!0}).then(function(e){o.localStorage.removeItem("token"),o.localStorage.removeItem("mcpUser"),i.user={},i.loggedIn=!1,o.location.reload()})}function y(){return s.track("Free Trial Get Subscription Seat Start",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],email:c.email,traits:i.user.get("traits"),category:"enterprise"}),a.getSubscriptionSeat(c.subscriptionId,"me").then(function(e){if(c.subscriptionId!==e.subscription)return s.track("Free Trial Seat Does Not Exist",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,email:c.email,traits:i.user.get("traits"),category:"enterprise"}),e;s.track("Free Trial Seat Exists",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,email:c.email,traits:i.user.get("traits"),category:"enterprise"}),n(function(){i.mcpReady||(""!==c.redirectOnSuccess?window.location=window.location.origin+c.redirectOnSuccess:c.hideOnSuccess&&(c.activated=!0),c.ready=!0)},100)})}angular.extend(c,{$onInit:function(){i.user.valid()?(c.userValid=!0,angular.extend(c,{email:g&&g.address||"",first_name:e&&e.first_name||"",last_name:e&&e.last_name||"",company_name:u&&u.name||"",company_size:u&&u.size||"",job_title:u&&u.job_title||""}),y()):c.userValid=!1;i.mcpReady&&(c.showOnQs=!1,c.hideOnSuccess=!1)},submit:function(e){return e.preventDefault(),c.processing=!0,s.track("Free Trial Login or Register",{traits:i.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"enterprise"}),i.user.checkValidEmail(c.email).then(function(e){return e.success&&e.data?e.data.user?(s.track("Free Trial Login Started",{traits:i.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"enterprise"}),i.user.Auth.login({email:c.email,password:c.password,profile:{}}).then(function(e){return c.invalidPassword=!1,s.track("Free Trial Login Success",{traits:i.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"enterprise"}),y()}).catch(function(e){return c.invalidPassword=!0,e})):(s.track("Free Trial Register User Started",{traits:i.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"enterprise"}),i.user.Auth.register({email:c.email,password:c.password,profile:{}}).then(function(e){return s.track("Free Trial Register User Success",{traits:i.user.get("traits"),campaignId:c.campaignId,campaignName:c.campaignName,category:"enterprise"}),e})):(t.error="Something went wrong. Please try again.",t.error)},function(){return t.error="Something went wrong",t.error}).then(function(){return r.all([function(){s.track("Free Trial Sign-Up Add User First and Last Name",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],user_name:[{first_name:c.first_name,last_name:c.last_name}],campaignId:c.campaignId,campaignName:c.campaignName,traits:i.user.get("traits"),category:"enterprise"});var t={profile:{}};c.first_name&&(t.profile.first_name=c.first_name);c.last_name&&(t.profile.last_name=c.last_name);return 0!==Object.keys(t.profile).length?r(function(e){h.save(t,function(){e()})}):r.resolve()}(),function(){var t=null;{var e;c.referrer?(e={freeTrialReferrer:c.referrer},t=t?angular.extend(t,e):e):c.extraFieldValue&&(e=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},c.extraField,c.extraFieldValue),t=t?angular.extend(t,e):e)}return t?r(function(e){i.user.setTrait(t,!0,{},function(){e()})}):r.resolve()}(),i.user.setNotifications("me",{class_reminders:!1,marketing:!1,notifications:!1,optout:!0,partner:!1,special_offers:!1,upcoming_classes:!1}),(e=c.company_name,t=c.company_size,n=c.job_title,s.track("Free Trial Sign-Up Add Company Data",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],company:[{company_name:e,company_size:t,job_title:n}],campaignId:c.campaignId,campaignName:c.campaignName,traits:i.user.get("traits"),category:"enterprise"}),i.user.addCompany(e,t,n)),(s.track("Free Trial Activate Seat Started",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,traits:i.user.get("traits"),category:"enterprise"}),a.createTrialSeat(c.subscriptionId,"me")),c.campaignId?a.sendTrialInvitation([c.email],c.campaignId):r.resolve()]);var e,t,n}).then(function(){s.track("Free Trial Activate Seat Success",{user:i.user.get("_id"),subscription:[{subscription_id:c.subscriptionId,name:"Free Trial"}],campaignId:c.campaignId,campaignName:c.campaignName,traits:i.user.get("traits"),category:"enterprise"}),c.processing=!1,n(function(){i.mcpReady||(""!==c.redirectOnSuccess?window.location=window.location.origin+c.redirectOnSuccess:c.hideOnSuccess&&(c.activated=!0),c.ready=!0)},100)}).catch(function(){return!1})},getEmailErrorMessage:function(e){{var t;if(e.required||e.businessEmail)return t=n(function(){v(),n.cancel(t)},2e3),"You must register with your business email address."}return""},logoutReload:v,setDisplayState:function(){var e=c.ready;if("true"===c.hideOnSuccess&&c.activated)return d.addClass("pad-top-none"),!1;null!==c.showOnQs&&void 0!==c.showOnQs&&""!==c.showOnQs&&(e=c.qs[c.showOnQs]);e||d.addClass("pad-top-none");return e},userValid:!1,processing:!1,invalidPassword:!1,inputChanged:l.once(function(e,t){s.track("Free Trial From Started",{input:[{element_name:e||"",value:t||""}],campaignId:c.campaignId,campaignName:c.campaignName,traits:i.user.get("traits"),category:"enterprise"})}),referrer:"",activated:!1,qs:m(),showCompanyName:"true"===c.showCompanyName,showCompanySize:"true"===c.showCompanySize,showJobTitle:"true"===c.showJobTitle,hideOnSuccess:"true"===c.hideOnSuccess,ready:!1})}r.$inject=["$q","_","$scope","$element","$rootScope","$timeout","$filter","$location","$window","SubscriptionService","UserProfileService","AnalyticsService","parseQS"],t.exports={bindings:{campaignId:"@",subscriptionId:"@",redirectOnSuccess:"@",hideOnSuccess:"@",referrerMap:"@",campaignName:"@",extraField:"@",showOnQs:"@",showCompanyName:"@",showCompanySize:"@",showJobTitle:"@"},templateUrl:"/templates/cl-free-trial-onboarding/onboarding.html",transclude:{buttonText:"buttonText"},controller:r}},{}],415:[function(e,t,n){"use strict";var r=e("../../common/app");r.component("clFreeTrialOnboarding",e("./components/onboarding")),r.component("clFreeTrialInvitationCta",e("./components/invite-cta")),r.service("clFreeTrialInvitationModalService",e("./services/main"))},{"../../common/app":70,"./components/invite-cta":413,"./components/onboarding":414,"./services/main":416}],416:[function(e,t,n){"use strict";function r(e,n,t,r,i,o,a){return function(r){a.lock("FreeTrialInvitationModal"),i.disable();var e=n.open({templateUrl:"/templates/cl-free-trial-onboarding/invitation-modal.html",windowClass:"cl-modal",controllerAs:"$ctrl",controller:["$scope","$uibModalInstance",function(e,t){var n=this;angular.extend(this,{emails:"",getInputErrorMessage:function(e){return"multipleEmails"!==e?"Please enter a valid business email address":"Emails must be comma delimited"},submit:function(){o.sendTrialInvitation(n.emails,r).then(function(){t.dismiss()}).catch(function(e){n.error=e})}})}]});function t(){a.unlock("FreeTrialInvitationModal"),i.enable(),e=void 0}return e.result.then(t).catch(t)}}r.$inject=["$rootScope","$uibModal","rind","deepval","keyboard","SubscriptionService","LockBody"],t.exports=r},{}],417:[function(e,t,n){"use strict";var p=e("moment");t.exports=["$rootScope","$timeout","$filter","trackFactory","deepval",function(e,u,l,d,f){return{restrict:"AE",templateUrl:"/templates/cl-gift/recipientDetails.html",link:function(n,e,t){var r=1e3,i=!1,o=(angular.extend(n,{limitMessageCharCount:c,onRecipientFormFocus:function(e){i||(i=!0,d.gifting("start",n.analyticsProps))},checkSameEmail:function(){rind.context.session.user.primary_email.address===n.gift.recipient.email?n.sameEmail=!0:n.sameEmail=!1},togglePopup:function(){n.isMobile?u(function(){document.querySelector("#mobile-date-picker").click()}):n.popupOpen=!n.popupOpen;d.gifting("reschedule",n.analyticsProps)},title:t.title,buttonText:t.buttonText,proceed:function(){n.setUnixDeliveryDate();var e={recipient_email:n.gift.recipient.email,note_added:n.gift.message!==l("i18n")("cl-gift-recipient-message-text")};_.extend(e,n.analyticsProps),window.location.pathname.match(/my-orders/)?d.gifting("resend",{gift_type:"order details",coupon_code:n.gift.coupon_code}):d.gifting("complete",e);n.nextState(n.recipientForm.$valid)},popupOpen:!1,setButtonText:function(){if(!n.gift)return n.buttonText;if(-1<["error","error-sent"].indexOf(n.gift.state))return o;return n.buttonText},dismissError:s}),n.analyticsProps={modal_id:"gift",gift_type:"recipient detail"},f(rind||{},"dump.course._id")?n.analyticsProps.course_id=rind.dump.course._id:f(rind||{},"dump.bundle._id")&&(n.analyticsProps.bundle_id=rind.dump.bundle._id),f(rind||{},"dump.course.product._id")?n.analyticsProps.product_id=rind.dump.course.product._id:f(rind||{},"dump.bundle.product._id")&&(n.analyticsProps.product_id=rind.dump.bundle.product._id),n.showNotification=!1,n.sameEmail=!1,c(),l("i18n")("cl-gift-recipient-button-save-and-resend","Save and Resend"));var a=n.date.javascript_delivery_date_object;function s(){n.showNotification=!1}function c(){n.gift&&n.gift.message?(n.gift.message.length>r&&(n.gift.message=n.gift.message.slice(0,1e3)),n.charRemaining=r-n.gift.message.length):n.charRemaining=r}n.$watch("date.javascript_delivery_date_object",function(e,t){n.popupOpen&&(n.popupOpen=!1),p(n.date.javascript_delivery_date_object).isAfter(p(n.maxDate))?n.showNotification=!0:(a=e,s(),n.setUnixDeliveryDate(),n.setDeliveryDateMessage())}),n.$watch("showNotification",function(e,t){e||(n.date.javascript_delivery_date_object=a)}),n.$on("user:gift:cancel",function(){d.gifting("x",n.analyticsProps)})}}}]},{moment:void 0}],418:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter","trackFactory","deepval",function(o,a,s,c){return{restrict:"AE",templateUrl:"/templates/cl-gift/senderDetails.html",link:function(t,e,n){var r,i=!1;angular.extend(t,{seeMore:function(e){t.showFullMessage=!0},onSenderFormFocus:function(){i||(i=!0,s.gifting("start",t.analyticsProps))},edit:function(){var e={recipient_email:t.gift.recipient.email,note_added:t.gift.message!==a("i18n")("cl-gift-recipient-message-text")};_.extend(e,t.analyticsProps),s.gifting("edit",e),t.prevState()},proceed:function(){s.gifting("complete",t.analyticsProps),t.nextState(t.senderForm.$valid)}}),t.analyticsProps={modal_id:"gift",gift_type:"recipient confirm"},c(rind||{},"dump.course._id")?t.analyticsProps.course_id=rind.dump.course._id:c(rind||{},"dump.bundle._id")&&(t.analyticsProps.bundle_id=rind.dump.bundle._id),c(rind||{},"dump.course.product._id")?t.analyticsProps.product_id=rind.dump.course.product._id:c(rind||{},"dump.bundle.product._id")&&(t.analyticsProps.product_id=rind.dump.bundle.product._id),t.gift.sender.name="",o.user.valid()&&((r=o.user.get("profile")).first_name&&(t.gift.sender.name=r.first_name,r.last_name&&(t.gift.sender.name=t.gift.sender.name+" "+r.last_name)),t.gift.sender.email=o.user.get("primary_email").address,t.saveGiftToLocalStorage(t.gift)),t.showFullMessage=!1,t.setDeliveryDateMessage(),t.$on("user:gift:cancel",function(){s.gifting("x",t.analyticsProps)}),t.$on("user:gift:back",function(){s.gifting("back",t.analyticsProps)})}}}]},{}],419:[function(e,t,n){"use strict";var r=e("moment");t.exports=["$rootScope",function(e){return{restrict:"AE",templateUrl:"/templates/cl-gift/summary.html",scope:{gift:"=?"},link:function(e,t,n){e.deliveryDate=r.unix(e.gift.delivery_date).format("MMM Do, YYYY")}}}]},{moment:void 0}],420:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("clGiftModal",e("./services/clGiftModal")),r.directive("clGiftRecipientDetails",e("./directives/recipientDetails")),r.directive("clGiftSenderDetails",e("./directives/senderDetails")),r.directive("clGiftSummary",e("./directives/summary"))},{"../../common/app":70,"./directives/recipientDetails":417,"./directives/senderDetails":418,"./directives/summary":419,"./services/clGiftModal":421}],421:[function(e,t,n){"use strict";function r(l,d,f,e,p,h,m,g,v,b,y){return function(u){y.lock("giftingModal"),g.disable(),e.open({templateUrl:function(){return u.gift?"/templates/cl-gift/edit-modal.html":"/templates/cl-gift/modal.html"},windowClass:"cl-modal",controller:["$scope","$uibModalInstance",function(t,n){var e;function r(){var e=new Date;t.gift.delivery_date&&(e=new Date(1e3*t.gift.delivery_date)),t.date.javascript_delivery_date_object=e}function i(){var e=p.tz(t.date.javascript_delivery_date_object,p.tz.guess());e.isAfter(p(),"day")?(t.sendToday=!1,t.delivery_date_message=e.format("MMMM DD, YYYY"),t.delivery_date_message_timing="(Approx. 6AM "+e.format("zz")+")"):(t.sendToday=!0,t.delivery_date_message=f("i18n")("cl-gift-recipient-delivery-date-message","Today"))}function o(){s(t.gift),t.stateIndex=0===t.stateIndex?t.stateIndex:--t.stateIndex,t.state=t.giftingStates[t.stateIndex]}function a(){return m.get()}function s(e){m.saveToLocalStorage(e)}function c(){g.enable(),y.unlock("giftingModal")}angular.extend(t,{nextState:function(e){e&&(u.gift?h.updateGift({orderId:u.orderId},{gift:t.gift}).$promise.then(n.close,n.dismiss):(s(t.gift),t.stateIndex<t.giftingStates.length-1?(t.stateIndex++,t.state=t.giftingStates[t.stateIndex]):d.location.href="/checkout/gift"))},prevState:o,saveGiftToLocalStorage:s,setJsDeliveryDate:r,setDeliveryDateMessage:i,setUnixDeliveryDate:function(){var e=p(t.date.javascript_delivery_date_object);e.isAfter(p(),"day")?e.hours(6).startOf("hour"):e.isBefore(p(),"day")&&(t.date.javascript_delivery_date_object=new Date,e=p());t.gift.delivery_date=e.unix()},date:{},gift:u.gift||{},title:u.title,abort:function(){l.$broadcast("user:gift:cancel",t.stateIndex),n.dismiss()},back:function(){l.$broadcast("user:gift:back",t.stateIndex),o()}}),t.today=new Date,t.maxDate=p().add(6,"M").toDate(),t.isMobile=!!rind.context.ua.mobile,t.giftingStates=["recipient","sender"],n.result.then(c,c),u.product&&((e=a())&&e.product_id===u.product._id?(t.gift=e,t.stateIndex=function(){var e;b.some(["product_id","recipient.name","recipient.email","delivery_date","message","state"],function(e){return!v(t.gift,e)})&&(e="recipient");return 0<=(e=t.giftingStates.indexOf(e))?e:t.giftingStates.length-1}()):(m.clear(),m.setObject(m.createGiftObject(u.product._id)),t.gift=a(),t.stateIndex=0),t.state=t.giftingStates[t.stateIndex]),r(),i()}]})}}r.$inject=["$rootScope","$window","$filter","$uibModal","moment","Ecommerce","GiftService","keyboard","deepval","_","LockBody"],t.exports=r},{}],422:[function(e,t,n){"use strict";e("../../common/app").directive("clInstructorProvider",e("./provider"))},{"../../common/app":70,"./provider":423}],423:[function(e,t,n){"use strict";t.exports=["InstructorService","_",function(c,u){return{restrict:"A",link:function(t,e,n){var r=[],i=(angular.forEach(["clInstructorId","clInstructorSlug","clInstructors"],function(e){e=n.$observe(e,o);r.push(e)}),n.clInstructorProviderKey||"clInstructor");function o(){(n.clInstructorId?c.findById({id:n.clInstructorId}):n.clInstructorSlug?c.findBySlug({slug:n.clInstructorSlug}):c.getInstructors()).then(a).catch(s)}function a(e){e.courses=u.sortBy(e.courses,function(e){return-1*(e.start_time||e.created||0)}),t[i].data=e,n.clDebug,t[i].ready=!0}function s(e){t[i]={clInstructorProviderError:!0,error:e}}t[i]={search:u.throttle(function(e){t[i].query!==e&&((t[i].query=e)?a(c.search(e)):c.getInstructors().then(a).catch(s))},300)}}}}]},{}],424:[function(e,t,n){"use strict";t.exports=["rind","_",function(e,u){return{restrict:"A",link:function(e,t){var n,r,i,o,a,s,c;window.screen.availWidth<768||(window.screen.availWidth<1200&&angular.element("a[cl-list-hover-selector-list-element]").on("click",function(e){e.preventDefault()}),t=t,n=angular.element("[cl-list-hover-selector-list]"),c=function(t){!a||function(e){var t=!1,n=angular.element("[cl-list-hover-selector-list-element]")[0];n&&(n=n.getBoundingClientRect(),e.clientX<n.left&&(t=!0));return t}(t)?i||(o=void 0):s&&(e=angular.element("[cl-list-hover-selector-list-element]"),o=u.find(e,function(e){e=e.getBoundingClientRect();if(function(e,t){var n=!1;e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom&&(n=!0);return n}(t,e))return!0}));var e=o,n=(e=e?"["+e.getAttribute("cl-list-hover-selector-list-element")+"-l3]":"[default-l3]",angular.element(e));try{i=i||"[default-l3]",angular.element(i).addClass("clListHoverSelectorHide"),n.removeClass("clListHoverSelectorHide"),i=e}catch(e){}},t.on("mouseenter",function(e){a=!0}),t.on("mouseleave",function(e){a=!1}),n.on("mouseenter",function(e){s=!0}),n.on("mouseleave",function(e){s=!1}),t.on("mousemove",function(e){var t;clearTimeout(r),r=setTimeout((t=e,function(){c(t)}),100)}))}}}]},{}],425:[function(e,t,n){"use strict";e("../../common/app").directive("clListHoverSelector",e("./directives/index"))},{"../../common/app":70,"./directives/index":424}],426:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{totalSteps:"=",currentStep:"="},templateUrl:"/templates/cl-steps/view.html",replace:!0,link:function(n,e){n.steps={};for(var t=0;t<n.totalSteps;t++)n.steps[t]=!1;n.$watch("currentStep",function(e,t){angular.isNumber(e)&&e<n.totalSteps&&(n.steps[t]=!1,n.steps[e]=!0)})}}}]},{}],427:[function(e,t,n){"use strict";e("../../common/app").directive("clSteps",e("./directives/index"))},{"../../common/app":70,"./directives/index":426}],428:[function(e,t,n){"use strict";var o;function r(t,i){return{restrict:"AE",templateUrl:"/templates/cl-tooltip/sign-in.html",replace:!0,link:function(n,r){function e(e){var t=r[0]===e.target,e=r[0]===e.target.parentElement;t||e||n.onClose()}o&&o.onClose(),o=n,i.tooltipModalShown({cta_label:n.params.cta_label,regPrompt:n.params.regPrompt}),$("body").on("mousedown",e),n.onClose=function(){n.tooltipVisible=!1,o=!1,$("body").off("mousedown",e),r.remove()},n.onClickLogin=function(){t.$broadcast("login:show",{onboarding:n.params.onboarding,prompt:n.params.courseName?n.params.buttonType:"default",promptClass:n.params.courseName,meta:n.params.meta,cta_label:n.params.cta_label,configKey:n.params.cta,activationMode:n.params.activationMode,regPrompt:n.params.regPrompt,template:n.params.template||null}),n.tooltipVisible=!1,r.remove()}}}}r.$inject=["$rootScope","trackFactory"],t.exports=r},{}],429:[function(e,t,n){"use strict";e("../../common/app").directive("clTooltip",e("./directives/tooltip-directive"))},{"../../common/app":70,"./directives/tooltip-directive":428}],430:[function(e,t,n){"use strict";t.exports=["clUploadModalService",function(i){return{restrict:"A",link:function(t,e){function n(e){return null!=e&&e.preventDefault(),e.originalEvent.dataTransfer.effectAllowed="copy",!(t.dragging=!0)}function r(e){return null!=e&&e.preventDefault(),t.dragging=!1}e.on("dragover",n),e.on("dragenter",n),e.on("dragout",r),e.on("dragleave",r),e.on("drop",function(e){null!=e&&e.preventDefault();if(t.dragging=!1,t.ctrl&&t.ctrl.updateImage)return t.ctrl.updateImage(e.originalEvent.dataTransfer.files[0]),!1;e={image:t.image,imageClass:"gallery-upload",type:"gallery",croppingOptions:t.croppingOptions,data:t.data};i(e)})}}}]},{}],431:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"A",transclude:!0,templateUrl:"/templates/cl-upload/file-upload-button.html",scope:{fileType:"@",fileChange:"&"},controller:["$scope","$element",function(t,e){e.on("change",function(e){e&&e.target&&e.target.files&&t.fileChange({file:e.target.files[0]})})}],link:function(e,t){var n=t,r=t.find("input[type=file]");n.bind("click",function(e){"file"!==angular.element(e.target).attr("type")&&r.trigger("click")})}}}},{}],432:[function(e,t,n){"use strict";var i=e("cropperjs"),o={preview:".image-preview",rotatable:!1,zoomable:!0,movable:!0,resizable:!0,autoCrop:!0};t.exports=function(){return{restrict:"AE",template:"<img/>",scope:{options:"=",data:"=cropSize",imageUrl:"=imageUrl",cropUrl:"="},link:function(t,e){var n,r=angular.extend({},o,t.options),e=e.find("img");r.cropend=function(e){t.cropUrl=n.getCroppedCanvas().toDataURL("image/jpeg")},n=new i(e[0],r),t.$watch("imageUrl",function(e){n.replace(e)}),t.$on("$destroy",function(){n.loaded=!1,n.destroy()})}}}},{cropperjs:35}],433:[function(e,t,n){"use strict";t.exports=["clUploadModalService",function(r){return{restrict:"A",scope:{title:"@clTitle",image:"=",imageClass:"@",uploadType:"@",croppingOptions:"=?",data:"=?"},link:function(t,e,n){e.on("click",function(){var e={title:t.title,image:t.image,imageClass:t.imageClass,type:t.uploadType,croppingOptions:t.croppingOptions,data:t.data};r(e)})}}}]},{}],434:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("clUploadModalService",e("./services/uploadModal")),r.service("clUploadService",e("./services/uploadService")),r.directive("clUploadModalButton",e("./directives/uploadModalButton")),r.directive("clFileUploadButton",e("./directives/fileUploadButton")),r.directive("clImageCrop",e("./directives/imageCrop")),r.directive("clDropArea",e("./directives/droparea"))},{"../../common/app":70,"./directives/droparea":430,"./directives/fileUploadButton":431,"./directives/imageCrop":432,"./directives/uploadModalButton":433,"./services/uploadModal":435,"./services/uploadService":436}],435:[function(e,t,n){"use strict";r.$inject=["$rootScope","$uibModal","$filter","cacheClear","_","rind","deepval","moment","keyboard","$window","LockBody"];var y=e("blueimp-load-image");function r(t,n,e,f,r,p,g,v,i,h,o){var a,m={MAX_SIZE:e("i18n")("upload-modal-error-max-size","We don't accept images with a file size greater than <strong>10MB</strong>. Please select another image."),DEFAULT:e("i18n")("upload-modal-error-default","<strong>There was an error!</strong> Please select another image")};return function(d){var e,t;o.lock("uploadModal"),i.disable(),a||(e=function(){i.enable(),o.unlock("uploadModal"),a=void 0},t={templateUrl:"/templates/cl-upload/modal.html",windowClass:"cl-modal modal-cl-upload",controllerAs:"ctrl",controller:["$scope","$rootScope","$timeout","$uibModalInstance","$filter","clUploadService","AnalyticsService",function(o,n,r,i,e,a,l){var t,s=this,e=e("magick")(d.image,{width:parseInt(s.width,10)||600});function c(e,t){e=e[0]+e[1]/60+e[2]/3600;return"S"!=t&&"W"!=t||(e*=-1),e}function u(e,t){n.user.valid()&&("profile"===e&&(n.user._data.profile.image=t.image,s.data.profile.image=t.image),"background"===e&&(s.data.profile.background=t.background),"gallery"===e&&void 0!==d.galleryProvider&&(t.newlyUploaded=!0,d.galleryProvider.addImage(t)))}angular.extend(d,{viewMode:2,checkOrientation:!1,movable:!1,zoomable:!1}),angular.extend(s,{googleAPI:"https://maps.googleapis.com/maps/api/js?libraries=places&key="+g(p,"config.google.app_api_key"),cropping:!1,saving:!1,cropURL:null,error:!1,imageURL:e,originalURL:e,toggleCrop:function(){s.cropping=!s.cropping,!s.cropping&&s.cropURL&&(s.updated=!0,s.imageURL=s.cropURL)},cancelCrop:function(){s.cropping=!s.cropping},closeModal:function(){s.saving=!1,s.error=!1,a.abort(),i.close()},updateImage:function(e){s.location=void 0,s.dateCreated=void 0,s.latitude=void 0,s.longitude=void 0,!e||e.size>a.MAX_SIZE?(s.error=m.MAX_SIZE,r(function(){s.error=!1},5e3)):y(e,function(e,n){if(n.exif){["make","model","apertureValue","shutterSpeedValue","lensMake","lensModel"].forEach(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);s[e]=n.exif.get(t)}),s.ISO=n.exif.get("PhotographicSensitivity"),s.dateTime=n.exif.get("DateTime"),s.dateTime&&((t=s.dateTime.split(" "))[0]=t[0].split(":").join("-"),t=v(t.join()),s.dateCreated=new Date(t.format()));var t=n.exif.get("GPSLatitude"),r=n.exif.get("GPSLongitude");if(void 0!==t||void 0!==r){s.latitude=c(t,n.exif.get("GPSLatitudeRef")),s.longitude=c(r,n.exif.get("GPSLongitudeRef"));try{(new google.maps.Geocoder).geocode({location:{lat:s.latitude,lng:s.longitude}},function(e,t){"OK"===t&&e[0]&&(s.location=e[0].formatted_address)})}catch(e){}}}var i,t=e.toDataURL("image/jpeg");r=t,(i=new Image).onload=function(){s.imageSizeWarning=i.width<800},i.src=r,s.updated=!0,s.originalURL=t,s.imageURL=s.originalURL,o.$digest()},{orientation:!0,canvas:!0,meta:!0})},refresh:u,save:function(){var t;("gallery"!==s.type||s.title)&&s.updated&&(s.saving=!0,t={dataURL:s.imageURL,courseNid:s.course&&s.course.nid},["type","dateCreated","location","title","description","make","model","apertureValue","shutterSpeedValue","lensMake","lensModel","ISO"].forEach(function(e){"dateCreated"===e?null!==s[e]&&void 0!==s[e]&&0!==s[e]&&(t[e]=new Date(s[e]).getTime()/1e3,t.dateTime=s.dateTime):"location"===e?void 0!==s[e]&&0!==s[e].length&&(t[e]=s[e],t.latitude=s.latitude,t.longitude=s.longitude):t[e]=s[e]}),a.upload(t,function(e,t){if(t=t||{},e||!t.success)return s.error=m.DEFAULT,void r(function(){s.error=!1},5e3);u(s.type,t.data),"gallery"===d.type&&(t.data&&t.data.owner&&t.data.owner.user&&t.data.owner.user.slug&&f.clearGalleryUser(t.data.owner.user.slug),l.track("Gallery Upload Success",{cta_label:"gallery_image_submit",cta_item_id:t.data._id,cta_item_title:t.data.title,cta_item_description:t.data.description})),s.saving=!1,i.close()},function(e){s.progress=e}))}},d),h.google&&h.google.maps||(e=document.getElementsByTagName("head"))&&e.length&&((e=e[0])&&((t=document.createElement("script")).setAttribute("src",s.googleAPI),t.setAttribute("type","text/javascript"),e.appendChild(t)))}]},r.each(["backdrop","keyboard"],function(e){e in d&&(t[e]=d[e])}),(a=n.open(t)).result.then(e,e))}}t.exports=r},{"blueimp-load-image":22}],436:[function(e,t,n){"use strict";t.exports=["Upload","_",function(o,e){var a=this;function s(){a.instance&&(a.instance.abort(),a.instance=null)}e.extend(a,{MAX_SIZE:10485760,instance:null,upload:function(t,n,r){var e="",i={image_file:function(e){for(var e=e.split(","),t=atob(e[1]),e=e[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),r=0,i=t.length,r=0;r<i;r++)n[r]=t.charCodeAt(r);return new Blob([n],{type:e})}(t.dataURL),nid:t.courseNid};switch(t.type){case"profile":case"background":e="/api/user/upload/"+t.type+"-image";break;case"gallery":e="/api/galleries/image/add";["title","description","location","dateCreated","dateTime","make","model","latitude","longitude","apertureValue","shutterSpeedValue","lensMake","lensModel","ISO"].forEach(function(e){i[e]=t[e]})}s(),a.instance=o.upload({url:e,data:i}),a.instance.then(function(e){a.instance=null,n(null,e.data)},function(e){a.instance=null,n(e)},function(e){e=parseInt(100*e.loaded/e.total);r(e)})},abort:s})}]},{}],437:[function(e,t,n){"use strict";t.exports=["$rootScope","$window","deepval","UserProfileService","SubscriptionService",function(t,e,n,r,i){var o=rind.context.session||{},a=t.user,s=this;s.type="info",s.email=((rind.context.session.user||{}).primary_email||{}).address,s.show=r.requireEmailVerification(a,o),angular.isString(s.email)&&((a=s.email.split("@")).length?(s.emailStart=a[0],s.emailEnd="@"+a[1]):s.emailStart=email);angular.element(e).on("focus",function(){s.verifying&&t.user.getContext().then(function(e){e=n(e||{},"user.primary_email");e&&e.verified&&(s.verifying=!1,s.verified=!0,t.$broadcast("email-verified"))})}),s.verify=function(){s.verifying=!0,s.errorMessage=void 0,r.emailVerifySend(function(e,t){!e||429===e.status?s.type="success":417===e.status?(s.type="success",s.verifying=!1,s.verified=!0):(s.errorMessage=e.data&&e.data.message,s.type="danger",s.verifying=!1)})},s.sendActivateTrialEmail=function(){s.verifying=!0,s.errorMessage=void 0,i.sendActivateEmail().then(function(e){s.type="success"}).catch(function(e){e&&(429===e.status?s.type="success":417===e.status?(s.type="success",s.verifying=!1,s.verified=!0):(s.errorMessage=e.data&&e.data.message,s.type="danger",s.verifying=!1))})},s.close=function(){s.show=!1}}]},{}],438:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter","$timeout","$window","deepval","UserProfileService",function(a,s,c,u,l,d){return{restrict:"AE",scope:{done:"&onDone",description:"=?"},templateUrl:"/templates/cl-verify/modalView.html",controller:["$scope","$element","$compile",function(r,e,t){var n={default:s("i18n")("cl-verify-id-modal-headline-default","take action"),review:s("i18n")("cl-verify-id-modal-headline-review","write a review"),upload:s("i18n")("cl-verify-id-modal-headline-upload","upload work"),comment:s("i18n")("cl-verify-id-modal-headline-comment","leave a comment"),like:s("i18n")("cl-verify-id-modal-headline-like","like this work")},i={default:s("i18n")("cl-verify-id-modal-text-default","taking action"),review:s("i18n")("cl-verify-id-modal-text-review","writing the review"),upload:s("i18n")("cl-verify-id-modal-text-upload","work this is"),comment:s("i18n")("cl-verify-id-modal-text-comment","leaving the comment"),like:s("i18n")("cl-verify-id-modal-text-like","liking their work")},o=rind.context.session||{};r.description||(r.description="default"),r.savedProfileInfo=!1,r.savingProfileInfo=!1,r.onVerify=function(){var e=a.user._data;r.showEmailValidation&&d.emailVerifySend(function(e,t){e&&429!==e.status&&417!==e.status||(r.emailValidationSent=!0)});r.showProfilePrompt&&(r.savingProfileInfo=!0,d.save(e,function(){r.savedProfileInfo=!0,r.savingProfileInfo=!1,r.showEmailValidation||c(function(){r.savedProfileInfo=!1,r.$broadcast("user:verified"),r.done()},1e3)}))},r.showSaveButton=function(){var e=r.showProfilePrompt&&!r.savedProfileInfo&&!r.savingProfileInfo&&!r.showEmailValidation,t=r.showEmailValidation&&!r.emailValidationSent&&!r.showProfilePrompt,n=r.showProfilePrompt&&!r.savedProfileInfo&&!r.savingProfileInfo&&r.showEmailValidation&&!r.emailValidationSent;return e||t||n},r.headlineDescriptor=n[r.description],r.infoTextDescriptor=i[r.description],r.savedText=s("i18n")("cl-verify-id-modal-saved-text","Info saved"),r.savingText=s("i18n")("cl-verify-id-modal-saving-text","Info saving..."),r.emailValidationText=s("i18n")("cl-verify-id-modal-email-sent","Email sent"),r.emailValidationSent=!1,r.showProfilePrompt=d.requireProfileInformation(a.user,o),r.showEmailValidation=d.requireEmailVerification(a.user,o),n=r.showProfilePrompt&&r.showEmailValidation?s("i18n")("cl-verify-id-modal-save-and-verify","Save Info and Send Verify Email"):r.showProfilePrompt?s("i18n")("cl-verify-id-modal-save","Save Info"):s("i18n")("cl-verify-id-modal-verify","Send Verify Email"),r.saveButtonText=n,angular.element(u).on("focus",function t(){r.emailValidationSent&&a.user.getContext().then(function(e){e=l(e||{},"user.primary_email");e&&e.verified&&(angular.element(u).off("focus",t),c(function(){r.done()},250))})})}]}}]},{}],439:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("clVerifyModal",e("./services/clVerifyModal")),r.directive("clVerify",e("./directives/clVerify")),r.controller("EmailVerifyController",e("./controllers/email-verify-controller"))},{"../../common/app":70,"./controllers/email-verify-controller":437,"./directives/clVerify":438,"./services/clVerifyModal":440}],440:[function(e,t,n){"use strict";function r(e,r,t,i,o,a){return function(n){a.lock("verifyModal");var t={templateUrl:"/templates/cl-verify/verifyModal.html",windowClass:"cl-modal modal-cl-verify",controller:["$scope","$uibModalInstance",function(e,t){e.description=n.description,e.dismiss=function(){o.enable(),t.dismiss()}}]};i.each(["backdrop","keyboard"],function(e){e in n&&(t[e]=n[e])}),o.disable(),r.open(t).result.then(function(){a.unlock("verifyModal"),o.enable(),e.$broadcast("user:verified")},function(){a.unlock("verifyModal")})}}r.$inject=["$rootScope","$uibModal","$timeout","_","keyboard","LockBody"],t.exports=r},{}],441:[function(e,t,n){"use strict";t.exports=["$scope","$attrs","$timeout","deepval","EventService","config",function(e,t,n,r,i,o){angular.extend(e,{numberPlayed:0,playCountTimer:void 0,lessonPlayLimitCount:o.lessonPlayLimits.lessons,lessonPlayLimitInverval:o.lessonPlayLimits.interval}),e.$watch("videoPlayer",function(){e.videoPlayer&&(a=e.videoPlayer).on("play",function(){s._id!==a.currentVideoItem._id&&(s=a.currentVideoItem,e.playCountTimer=e.playCountTimer||n(function(){e.numberPlayed=0,delete e.playCountTimer},e.lessonPlayLimitInverval),e.numberPlayed=e.numberPlayed||0,e.numberPlayed++),e.numberPlayed=e.numberPlayed||0,e.numberPlayed>=e.lessonPlayLimitCount&&(a.pause(),a.setState(a.states.BLOCKED),a.analytics.trackBlocked())})});var a,s={}}]},{}],442:[function(e,t,n){"use strict";r.$inject=["$attrs","$scope","EventService","CatalogService","$rootScope","categoryResource","$filter","moment","$timeout","$interval","$http","$q","config"];var C=e("async"),I=e("underscore");function r(n,r,i,c,u,e,l,f,p,g,v,y,h){r.$watch("videoPlayer",function(e){e&&n.categoryId&&C.series([t,d,b],function(e){I.each(r.events,w),I.each(r.upcomingEvents,function(e){T(e).then(function(){r.events.push(e),r.upcomingEvents=I.without(r.upcomingEvents,e),w(e),!m(e)&&r.events[0]!==e||a(e),A()}),A()}),E()})});var o=this;function t(t){e.getCategoryById({id:n.categoryId}).$promise.then(function(e){e&&e.success&&e.data&&e.data.slug&&(r.category=I.pick(e.data,["_id","slug","title"])),t()}).catch(t)}function d(t){i.getCurrentEventsByCategoryId(n.categoryId).then(function(e){r.events=e,C.each(r.events,_,t)}).catch(t)}function b(t){i.getUpcomingEventsByCategoryId(n.categoryId).then(function(e){r.upcomingEvents=e,C.each(r.upcomingEvents,_,t)}).catch(t)}function _(t,n){if(t.product&&t.product.source&&"course"===t.product.source.source_type)return c.getCourseById(t.product.source.source_id).then(function(e){t.title=t.title||e.short_title,t.slug=e.slug,n()});var e="",e=(r.category&&(e=r.category.title),t.title+" "+e);t.slug=e.toLowerCase().replace(/[^a-zA-Z0-9-_]/g,"-"),n()}function w(e){m(e)&&(r.liveEvent=e),S(e),k(e,!0).then(function(){r.events=I.without(r.events,e),m(e)&&(r.liveEvent=void 0),s(e)&&E()})}function S(t){i.getCurrentBroadcast(t._id).then(function(e){e.title&&(t.title=e.title,t.instructors=[]),k(e).then(function(){var e=f().unix();t.end_time<=e||(s(t)&&a(t),S(t))})}).catch(function(){var e=t;r.events=I.without(r.events,e),s(e)&&E(),i.getNextBroadcast(e._id).then(T).then(function(){r.events.push(e),S(e),r.events[0]===e&&a(e)})})}function E(){var e;if(!r.events||0===r.events.length)return o.videoItem?(r.videoPlayer.trigger(r.videoPlayer.events.ENDED,o.videoItem),r.videoPlayer.clear()):r.videoPlayer.trigger(r.videoPlayer.events.READY),e=void 0,r.nextEvent&&r.nextEvent.image?e=r.nextEvent.image:r.data&&r.data.image&&(e=r.data.image.file),void(r.posterUrl=l("magick")(e,{width:1600}));var t=r.events[0];I.each(r.events,function(e){m(e)&&(t=e)}),a(t)}function a(n){r.currentEventId=n._id,r.currentEventSlug=n.slug,i.getCurrentBroadcast(n._id).then(function(e){var t=n;e.title&&(t.title=e.title,t.instructors=[]),o.videoItem=r.videoPlayer.queueBroadcast(e),o.videoItem.title=t.title,o.videoItem.source.eventId=t._id,r.videoPlayer.trigger(r.videoPlayer.events.READY,o.videoItem),r.videoPlayer.play(),e=n,u.$broadcast("video-chat:channel-switch",{channel:e.slug.toLowerCase().replace(/[^a-zA-Z0-9-_]/g,"-"),currentVideoItem:o.videoItem}),r.leonHeaderInformation.swimlaneTitle=e.title,r.leonHeaderInformation.type="conference",r.leonHeaderInformation.title=r.category.title})}function A(){var t=void 0,n=void 0;angular.forEach(r.upcomingEvents||[],function(e){"live_event"===e.revenue_attribution&&(!t||e.start_time<t.start_time)&&(t=e),(!n||e.start_time<n.start_time)&&(n=e)}),r.nextEvent=t||n}function k(e,t){var n,r,i,o,a,s,l,c=y.defer(),u=f().unix(),d=1e3*(e.end_time-u);return t&&m(e)?(t=I.last(e.swimlanes),t=(t=I.last(t.broadcasts)).channel&&t.channel.stream_config&&t.channel.stream_config.stream_id,r=e.end_time-e.start_time,n=h.cltv&&h.cltv.percentageOfLiveToCompleteBeforeSwitching||70,n=e.start_time+n/100*r,r=t,t=d=0<=n-u?1e3*(n-u):0,i=y.defer(),o=1e3*(h.cltv&&h.cltv.secondsToPollOfflineBroadcasts)||5e3,a=h.cltv&&h.cltv.consecutiveIntervalsToMarkAsOffline||3,s=0,l="https://api.video.ibm.com/channels/"+r+".json",p(function(){var t=g(function(){v({method:"GET",url:l}).then(function(e){"offair"===(e.data&&e.data.channel&&e.data.channel.status)?s++:s=0,a<=s&&(g.cancel(t),t=void 0,i.resolve())},function(e){})},o)},t),i.promise.then(function(){c.resolve(e)})):p(function(){c.resolve(e)},d),c.promise}function T(e){var t=y.defer(),n=f().unix(),n=1e3*(e.start_time-n);return p(function(){t.resolve(e)},n),t.promise}function s(e){return r.currentEventId===e._id}function m(e){return"live_event"===e.revenue_attribution}r.events=[],o.videoItems=[],angular.extend(r,{playEvent:a,isLive:m,isActive:s}),r.leonHeaderInformation={}}t.exports=r},{async:21,underscore:void 0}],443:[function(e,t,n){"use strict";var a=e("moment");t.exports=["$scope","$attrs","deepval","EventService",function(i,e,t,n){var r;function o(){var e=t(r,"course._id");e&&n.getCurrentEventsByCourseId(e).then(function(e){var t,n,r;i.event=e[0],i.event&&i.event.is_container&&(i.date=(e=a.unix(i.event.start_time).format("MMM"),t=a.unix(i.event.end_time).format("MMM"),n=a.unix(i.event.start_time).format("D"),r=a.unix(i.event.end_time).format("D"),e===t?n===r?e+" "+n:e+" "+n+" - "+r:e+" "+n+" - "+t+""+r))})}i.$watch("videoPlayer",function(){i.videoPlayer&&(r=i.videoPlayer).on(i.videoPlayer.events.READY,o)})}]},{moment:void 0}],444:[function(e,t,n){"use strict";var h=e("async");t.exports=["EventService","$scope","$attrs","deepval","_","ContentAccessService",function(e,r,i,n,o,t){var a=r.$watch("videoPlayer",function(e){e&&i.clCourseId&&(e.setCourse(i.clCourseId).then(function(){r.posterUrl=i.posterUrl||e.posterUrl,h.series([c,l,d,f,p],function(){r.videoPlayer.trigger(r.videoPlayer.events.READY,s.videoItem)})}),a())}),s=this;function c(e){i.clLessonSlug&&(s.videoItem=r.videoPlayer.queueSegment(i.clLessonSlug),s.videoItem.watchData&&s.videoItem.watchData.latestIndex&&r.videoPlayer.seek(s.videoItem.watchData.latestIndex/1e3)),e()}function l(n){if(s.videoItem)return n();t("course",i.clCourseId).then(function(e){if(e.owned||e.subscribed){e=o.filter(r.videoPlayer.playlist.videoItems,function(e){return e.watchData});if(!e.length){var t=o.first(r.videoPlayer.playlist.videoItems);if(u(t))return s.videoItem=t,r.videoPlayer.bufferVideoItem(s.videoItem),n()}t=o.sortBy(e,function(e){return e.watchData.modified}).reverse();u(t[0])&&(s.videoItem=t[0],r.videoPlayer.bufferVideoItem(s.videoItem),s.videoItem.watchData&&s.videoItem.watchData.latestIndex&&r.videoPlayer.seek(s.videoItem.watchData.latestIndex/1e3)),n()}else n()}).catch(function(){n()})}function d(t){e.getCurrentBroadcastByCourseId(i.clCourseId).then(function(e){("playlist"===e.content.content_type||"course"===e.content.content_type&&e.content.content_id===i.clCourseId)&&("live"===e.broadcast_type&&(s.videoItem=r.videoPlayer.queueBroadcast(e)),s.videoItem?r.videoPlayer.currentBroadcast=e:s.videoItem=r.videoPlayer.queueBroadcast(e)),t()}).catch(function(){t()})}function f(t){r.videoPlayer.getCoursePromo().then(function(e){n(e||{},"source.media")&&(s.videoItem||(s.videoItem=e,r.videoPlayer.bufferVideoItem(s.videoItem))),t()}).catch(function(){t()})}function p(e){if(s.videoItem)return e();var t=o.find(r.videoPlayer.playlist.videoItems,function(e){return e.token});t&&u(t)&&(s.videoItem=t,r.videoPlayer.bufferVideoItem(s.videoItem)),e()}function u(e){return n(e||{},"source.media.0")}}]},{async:21}],445:[function(e,t,n){"use strict";function r(e,r,t,n){var i=t.get("clLessonEndControllerDuration")||10,o=r.$watch("videoPlayer",function(){r.videoPlayer&&(r.videoPlayer.on(r.videoPlayer.events.TIME_UPDATE,a),o())});function a(e,t,n){n=n.currentTarget;n&&0!==(t=Math.floor(t.duration-n.currentTime))&&t<i+1?(s(!0),r.countdown_timer=t):s(!1)}function s(e){r.course.hasAccess?r.ending=e:r.ending=!1}s(!1),e.user.getTrait("microsoft")&&"true"===e.user.getTrait("microsoft").toString()&&n.getBySlug("ms-video-messaging").then(function(e){e&&e.module&&e.module.data&&(r.alternateMessage=e.module.data.content)})}r.$inject=["$rootScope","$scope","Vault","GlobalModuleService"],t.exports=r},{}],446:[function(e,t,n){"use strict";t.exports=["MediaService","$scope","$attrs",function(e,n,r){n.$watch("videoPlayer",function(t){t&&r.mediaId&&(r.posterUrl&&(t.setPoster(r.posterUrl),n.posterUrl=r.posterUrl),r.courseId&&t.setCourse(r.courseId),e.mediaById(r.mediaId).then(function(e){e=t.queueMedia(e);n.videoPlayer.trigger(n.videoPlayer.events.READY,e)}))})}]},{}],447:[function(e,t,n){"use strict";function r(e,n,r,i){angular.extend(n,{setBrowserLocation:a,setClassLocation:function(){i.path(r.clClassPath||n.$parent.clClassPath||"")}});var t=n.$watch("videoPlayer",function(){n.videoPlayer&&(n.videoPlayer.on(n.videoPlayer.events.ENDED,o),e.$on("video:displayRegOverlay",function(e,t){e.preventDefault(),n.displayRegOverlay=!0}),e.$on("video:removeRegOverlay",function(e){e.preventDefault(),n.displayRegOverlay=!1}),t())});function o(){n.course.hasAccess&&(n.videoPlayer.next(),a(n.videoPlayer.currentVideoItem))}function a(e,t){e&&e.slug&&((t=(t||r.clLessonPath||n.$parent.clLessonPath||"")+e.slug)!==i.path()&&i.path(t))}}r.$inject=["$rootScope","$scope","$attrs","$location"],t.exports=r},{}],448:[function(e,t,n){"use strict";function r(n,e,r){var t=n.$watch("videoPlayer",function(){(n.videoPlayer||n.videoTagPlayer)&&(n.$on("video:displayRegOverlay",function(e,t){e.preventDefault(),Object.assign(i,t),n.displayRegOverlay=!0,r.videoRegGate({action:"reg gate overlay",label:"reg-gate: overlay shown",cta_label:"reg-gate: overlay shown"})}),n.$on("video:removeRegOverlay",function(e){e.preventDefault(),n.displayRegOverlay=!1}),t())}),i={state:"intro",activationMode:"video-view",configKey:"video-view",regPrompt:"video-view",via:"video"};n.register=function(){e.$emit("register:show",i)}}r.$inject=["$scope","$rootScope","trackFactory"],t.exports=r},{}],449:[function(e,t,n){"use strict";function r(t,n,e,r,s,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/cl-video-player/cms/edit.html",replace:!0,link:function(a){a.config=r,a.data||(a.data=a.$parent.data),a.data.playerType||(a.data.playerType="category"),a.data.image||(a.data.image={}),a.data.imagePosition||(a.data.imagePosition="cover"),a.data.enableAutoplay||(a.data.enableAutoplay=!1),a.data.courses||(a.data.courses=[]),a.addSegment=function(e){a.data.courseId=e.course,a.data.mediaId=e.media[0],a.data.segmentSlug=e.slug,a.data.segmentId=e._id,a.data.title=e.title,a.data.description=e.description},a.addCourse=function(e){t.getCourseById(e._id,{keys:["promo"]}).then(function(e){var t=i.reduce(e.instructors,function(e,t){return""!=e&&(e+=", "),e+=t.name},"");e.instructors=t,e.image=n("magick")(e.image,{width:600}),a.data.courses.push(i.pick(e,"_id","short_title","instructors","promo","image"))})},a.remove=function(e){a.data.courses.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}r.$inject=["CatalogService","$filter","$sce","config","arrayMove","_"],t.exports=r},{}],450:[function(e,t,n){"use strict";t.exports=["$sce",function(e){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/cl-video-player/cms/view.html",replace:!0,link:function(e){e.data||(e.data=e.$parent.data)}}}]},{}],451:[function(e,t,n){"use strict";function r(s,c){return{restrict:"AE",templateUrl:function(e,t){return t.clTemplate?"/templates/cl-video-player/overlays/"+t.clTemplate+".html":"/templates/cl-video-player/overlays/index.html"},transclude:!0,link:{pre:function(n,e,t){var r=n.$parent,i=r.$watch("videoPlayer",function(){var t;r.videoPlayer&&(n.videoPlayer=r.videoPlayer,s.each(r.videoPlayer.events,function(e){r.videoPlayer.on(e,a)}),n.leonHeaderInformation={},n.course&&(t=n.course,c.getPrice(t.product._id).then(function(e){angular.extend(n.leonHeaderInformation,{type:"course",title:t.short_title,instructors:t.instructors,accessRight:t.accessRight,flagged:t.flagged,productId:t.product._id,full_price:e.full_price,on_sale:e.on_sale,current_price:e.current_price})})),i())}),o=s.keys(t.$attr);function a(e,t){n.event=e,n.data=t}s.each(o,function(e){n[e]=t[e]})}}}}r.$inject=["_","CourseService"],t.exports=r},{}],452:[function(e,t,n){"use strict";e("../../vendor/ustream-embedapi"),t.exports=["$window","$timeout","FullScreenService","videoPlayerCollection",function(b,_,w,S){return{templateUrl:function(e,t){return t.clTemplate||"/templates/cl-video-player/ustream.html"},replace:!0,link:function(r,l,d){var i,o,e,t,a=!1,f=!1;function p(e,t){a!==t&&((a=t)?(S.pauseAllVideoPlayer(r.clPlayerId),r.videoPlayer.trigger(r.videoPlayer.events.STARTED,o,e),r.videoPlayer.analytics.setProperties(r.videoPlayer.analytics.propertiesKeys.PLAY,{cta_label:"perfect timing",cta_type:"button",cta_module:"overlay_perfect_timing"}),f||r.videoPlayer.trigger(r.videoPlayer.events.TIME_UPDATE,o,e)):r.videoPlayer.trigger(r.videoPlayer.events.PAUSED,o,e))}function n(){i&&(a=!1,i.callMethod("pause"),r.videoPlayer.trigger(r.videoPlayer.events.PAUSED,o))}function s(){i&&(a=!1,i.callMethod("pause"),r.videoPlayer.trigger(r.videoPlayer.events.PAUSED,o))}function c(e,t){var n;"broadcast"!==t.type||(n=t.getStreamId())!==r.streamId&&(r.streamId=n,o=t,a=!1,i&&i.callMethod("load","channel",n))}function u(e,t){r.params.autoplay="true",c(0,t),i&&i.callMethod("play")}function h(e,t){t!==r.videoPlayer.volume&&r.videoPlayer.trigger(r.videoPlayer.events.VOLUME,t)}function m(e,t){i&&i.callMethod("volume",t)}function g(){i&&(!1!==r.clVideoPlayerEnableFullscreen?e||(e=angular.element(document.getElementById("ustreamFullScreenButton")),(t=angular.element('[cl-fullscreen-player="'+r.clPlayerId+'"]'))&&t[0]&&(w.registerFullScreenElement(t),e.bind("click",v))):e&&(e.off("click",v),e=void 0))}function v(){t&&w.toggleFullScreen(t)}function y(){r.videoPlayer.off(r.videoPlayer.events.PLAY,u),r.videoPlayer.off(r.videoPlayer.events.PAUSE,n),r.videoPlayer.off(r.videoPlayer.events.STOP,s),r.videoPlayer.off(r.videoPlayer.events.BUFFER,c),r.videoPlayer.off(r.videoPlayer.events.VOLUME,m),r.videoPlayer.off(r.videoPlayer.events.DESTROY_USTREAM,y)}angular.extend(r,{init:function(){_(function(){(i=b.UstreamEmbed(r.clPlayerId+"_ustream"))&&(i.addListener("playing",p),i.addListener("volume",h),r.videoPlayer.setVolume(r.volume)),g()})},clPlayerId:r.clPlayerId||"ustreamVideoPlayer",autoplay:"false",html5Ui:r.html5Ui||!0,controls:!0===r.clVideoPlayerControls,volume:r.clVideoPlayerVolume,showTitle:r.showTitle||!1,streamId:null}),r.params={autoplay:r.autoplay,controls:r.controls,showtitle:r.showTitle,volume:r.volume},r.html5Ui&&(r.params.html5ui=1),r.$watch("videoPlayer",function(e){e&&(r.videoPlayer.on(r.videoPlayer.events.PLAY,u),r.videoPlayer.on(r.videoPlayer.events.PAUSE,n),r.videoPlayer.on(r.videoPlayer.events.STOP,s),r.videoPlayer.on(r.videoPlayer.events.BUFFER,c),r.videoPlayer.on(r.videoPlayer.events.VOLUME,m),r.videoPlayer.on(r.videoPlayer.events.DESTROY_USTREAM,y),r.videoPlayer.setVolume(r.volume))}),r.$watch("clVideoPlayerEnableFullscreen",g),r.playerLoaded=!1,l.ready(function(){_(function(){r.playerLoaded=!0})})}}}]},{"../../vendor/ustream-embedapi":464}],453:[function(e,t,n){"use strict";var L=e("@creativelive/video.js");e("@creativelive/videojs-video-usage"),e("@creativelive/videojs-resolution-selector"),t.exports=["$q","$timeout","rind","config","deepval","gangesSessionService","videoPlayerCollection","FullScreenService","_",function(x,P,M,O,e,R,j,D,N){return{restrict:"AE",templateUrl:function(e,t){return t.clTemplate||"/templates/cl-video-player/videojs.html"},replace:!0,link:function(r,i,t){var c,o,a,e={},u=void 0,f=!(!M.context||!M.context.ua.mobile),s=[],p=void 0,l=!1,h=(r.$watch("videoPlayer",function(){r.videoPlayer&&(r.videoPlayer.on(r.videoPlayer.events.PLAY,k),r.videoPlayer.on(r.videoPlayer.events.PAUSE,v),r.videoPlayer.on(r.videoPlayer.events.STOP,y),r.videoPlayer.on(r.videoPlayer.events.BUFFER,d),r.videoPlayer.on(r.videoPlayer.events.SEEK,b),r.videoPlayer.on(r.videoPlayer.events.SKIP_BACK,w),r.videoPlayer.on(r.videoPlayer.events.SKIP_AHEAD,S),r.videoPlayer.on(r.videoPlayer.events.VOLUME,E),r.videoPlayer.on(r.videoPlayer.events.DESTROY_VIDEOJS,I),i.ready(function(){i.bind("contextmenu",function(){return!1}),(c=L(r.clPlayerId,{techOrder:["html5","flash"],plugins:e,playbackRates:[.75,1,1.25,1.5,2]})).on("pause",function(e){P(function(){r.videoPlayer.trigger(r.videoPlayer.events.PAUSED,u,e)})}),c.on("play",function(e){j.pauseAllVideoPlayer(r.clPlayerId),r.videoPlayer.trigger(r.videoPlayer.events.STARTED,u,e)}),c.on("timeupdate",function(e){r.videoPlayer.trigger(r.videoPlayer.events.TIME_UPDATE,u,e)}),c.on("ended",function(e){P(function(){r.videoPlayer.trigger(r.videoPlayer.events.ENDED,u,e)})}),c.on("loadeddata",function(e){for(;s.length;){var t=s.shift();angular.isFunction(t)&&t()}}),c.on("ratechange",function(e){Vault.Local.set("playbackRate",e.currentTarget.playbackRate)}),r.$watch("clVideoPlayerEnableFullscreen",T),T()}))}),n=void 0===r.noVideoConfig,r.preload||(r.preload="metadata"),M.context&&-1!==M.context.uaString.indexOf("Trident/")),n=!h&&n,m=O.videoUsage;function g(){c&&c.ready(function(){c.playbackRate(Vault.Local.get("playbackRate")||1),c.play()})}function v(){c&&c.ready(function(){c.pause()})}function y(){c&&c.ready(function(){c.pause().currentTime(0).trigger("loadstart")})}function b(e,t,n,r){c&&c.ready(function(){0===c.readyState()&&s.push(function(){_(t)}),n?d(0,n).then(function(){P(function(){_(t),r&&c.play()},f?601:0)}):_(t)})}function _(e){c&&c.ready(function(){c.currentTime(e)})}function w(e,t,n){c&&c.ready(function(){})}function S(e,t,n){c&&c.ready(function(){c.currentTime(c.currentTime()+t)})}function E(e,t){c&&c.ready(function(){c.volume(t/100)})}function d(e,t){return"broadcast"===t.type||(c?u!==t||l?t.hasMultipleResolution?t.getAllURL().then(function(e){if(1===N.size(e))return A(t,N.values(e)[0]);A(t,e)}).catch(function(e){}):t.getURL(null,!1).then(function(e){A(t,e)}).catch(function(e){}):x.resolve():x.reject("no player"))}function A(e,t){var n=e.source;if(c&&n){var r,i,o=c.textTracks();if(o&&0<o.length){var a=[];angular.forEach(o,function(e){a.push(e)}),angular.forEach(a,function(e){c.removeRemoteTextTrack(e)});try{c.controlBar.subtitlesButton.hide()}catch(e){}}if(n.media){if(n.media.captions)r=n.media.captions.key,i=n.media.captions.label;else for(var s=0;s<n.media.length;s++)if(n.media[s]&&n.media[s].captions){r=n.media[s].captions.key,i=n.media[s].captions.label;break}r&&c.addRemoteTextTrack({kind:"subtitles",src:"https://"+O.cdn.captions+"/"+r,language:"en",label:i||"English",default:!1})}}u===e&&!l||(l=!1,P.cancel(p),p=P(function(){l=!0},54e5),(u=e)&&u.source&&c.trigger({type:"video-queued",data:u.source}),N.isString(t)?c.src(t):h?c.src(t.HD):c.setResOptions({default_res:c.getCurrentRes()||"HD",available_res:t,hide_menu_title:!0}))}function k(e,t){return"broadcast"===t.type||(c?u!==t||l?d(0,t).then(function(){r.videoPlayer&&r.videoPlayer.getState()===r.videoPlayer.states.BLOCKED||g()}):(g(),x.resolve()):x.reject("no player"))}function T(){var e,t,n;!1!==r.clVideoPlayerEnableFullscreen?o||((a=angular.element('[cl-fullscreen-player="'+r.clPlayerId+'"]'))&&a[0]&&D.registerFullScreenElement(a),(e=document.createElement("div")).className="vjs-fullscreen-control vjs-control cl-fullscreen-control",e.innerHTML='<div class="vjs-control-content"><span class="vjs-control-text">Non-Fullscreen</span></div>',t=i.find(".vjs-control-bar")[0],n=i.find(".vjs-fullscreen-control")[0],t.insertBefore(e,n),e&&(o=angular.element(e)).bind("click",function(e){e.preventDefault(),e.stopPropagation(),C()})):o&&(o.off("click",C),o=void 0)}function C(){a&&D.toggleFullScreen(a)}function I(){r.videoPlayer.off(r.videoPlayer.events.PLAY,k),r.videoPlayer.off(r.videoPlayer.events.PAUSE,v),r.videoPlayer.off(r.videoPlayer.events.STOP,y),r.videoPlayer.off(r.videoPlayer.events.BUFFER,d),r.videoPlayer.off(r.videoPlayer.events.SEEK,b),r.videoPlayer.off(r.videoPlayer.events.SKIP_BACK,w),r.videoPlayer.off(r.videoPlayer.events.SKIP_AHEAD,S),r.videoPlayer.off(r.videoPlayer.events.VOLUME,E),r.videoPlayer.off(r.videoPlayer.events.DESTROY_VIDEOJS,I)}angular.extend(m.api||{},{keyFunc:R.getToken,url:m.api.url}),O.videoUsage.enabled&&n&&(e.videoUsage={config:m}),h||(e.resolutionSelector={}),r.$on("$destroy",function(){I(),c.off(),c.dispose()})}}}]},{"@creativelive/video.js":18,"@creativelive/videojs-resolution-selector":19,"@creativelive/videojs-video-usage":20}],454:[function(e,t,n){"use strict";t.exports=["videoPlayerCollection",function(i){return{restrict:"AE",link:function(n,e,t){function r(e,t){n.event=e,n.data=t}i.getVideoPlayer(t.clPlayerId).then(function(e){n.videoPlayer=e,_.each(n.videoPlayer.events,function(e){n.videoPlayer.on(e,r)})})}}}]},{}],455:[function(e,t,n){"use strict";t.exports=["videoPlayerCollection","WatchProgressService","keyboard","$timeout",function(a,s,c,u){return{restrict:"AE",templateUrl:function(e,t){return t.clTemplate||"/templates/cl-video-player/video-player.html"},replace:!0,transclude:{overlaySlot:"overlay",overlayToggle:"overlayToggle",panelSlot:"panel"},link:function(t,e,n){var r;function i(){t.videoPlayer.trigger(t.videoPlayer.events.USER_ACTIVE),o()}function o(){u.cancel(r),r=u(function(){t.videoPlayer.trigger(t.videoPlayer.events.USER_INACTIVE)},parseInt(n.clVideoPlayerHoverTimeout||2e3,10))}t.panelOpen=!1,t.clPlayerId=n.clPlayerId,t.videoPlayer=a.registerVideoPlayer(t.clPlayerId),n.clVideoPlayerEnableFullscreen&&n.$observe("clVideoPlayerEnableFullscreen",function(){t.clVideoPlayerEnableFullscreen="true"===n.clVideoPlayerEnableFullscreen}),n.clVideoPlayerControls?n.$observe("clVideoPlayerControls",function(){t.clVideoPlayerControls="true"===n.clVideoPlayerControls}):t.clVideoPlayerControls=!0,n.clVideoPlayerVolume?n.$observe("clVideoPlayerVolume",function(){t.clVideoPlayerVolume=parseInt(n.clVideoPlayerVolume,10),t.videoPlayer.setDefaultVolume(t.clVideoPlayerVolume)}):t.clVideoPlayerVolume=t.videoPlayer.defaultVolume,e.bind("mouseenter",function(e){i()}),e.bind("touchstart",function(e){i()}),e.bind("touchmove",function(e){i()}),e.bind("touchend",function(e){o()}),e.bind("mouseover",function(e){i()}),e.bind("mouseleave",function(e){o()}),e.bind("mousemove",function(e){i()}),s.init(t.clPlayerId),"true"===n.autoplay&&(t.videoPlayer.setAutoplay(!0),t.videoPlayer.on(t.videoPlayer.events.READY,function(){"true"===n.autoplay&&t.videoPlayer.play()}),t.videoPlayer.on(t.videoPlayer.events.STARTED,function(){n.autoplay=!1})),t.videoPlayer.on(t.videoPlayer.events.PLAY,function(){t.panelOpen=!1}),t.videoPlayer.on(t.videoPlayer.events.PAUSED,function(){t.panelOpen=!1}),t.videoPlayer.on(t.videoPlayer.events.QUIZ,function(){t.panelOpen=!1}),c.on("videoplayer",c.EVENTS.LEFT,function(){t.videoPlayer.skipBack(15)}),c.on("videoplayer",c.EVENTS.RIGHT,function(){t.videoPlayer.skipAhead(15)}),c.on("videoplayer",c.EVENTS.PREV,function(){t.videoPlayer.previous()}),c.on("videoplayer",c.EVENTS.NEXT,function(){t.videoPlayer.next()}),c.on("videoplayer",c.EVENTS.SPACE,function(e){"playing"===t.videoPlayer.getState()&&(e.preventDefault(),t.videoPlayer.pause()),"paused"===t.videoPlayer.getState()&&(e.preventDefault(),t.videoPlayer.play())})}}}]},{}],456:[function(e,t,n){"use strict";function r(E,A,k,T,C,I,x,P,M,O,e){return{restrict:"A",link:function(n,e,t){n.videoTagPlayer=!0;var a=t.contentType,l=t.courseId,s=t.contentId,d=parseInt(t.urlExpirationTimeS,10)||0,f=parseInt(t.urlRefreshS,10)||0,p=null,r=null,t=t.poster,h=new x,c=new I,u=e.find("video")[0],m=M&&M.videoUsage&&M.videoUsage.monitor&&M.videoUsage.monitor.interval||6e4,i={course:l};function g(t){c.getURL(null,!1).then(function(e){r=e,t&&n.startPlay()}).catch(function(e){})}function v(n,r,i,o){C.getCourseById(l,{fetch:!0,keys:"sessions.segments.media"}).then(function(e){switch(a){case"segment":var t=P.chain(e.sessions).pluck("segments").flatten().value(),t=P.find(t,function(e){return e._id===s});c.setSegment(t);break;case"promo":t=P.find(e.promo,function(e){return e._id===s});c.setPromo(t)}i&&g(o),n&&(u.addEventListener("play",y),u.addEventListener("pause",b),u.addEventListener("ended",_),u.addEventListener("timeupdate",w)),r&&0<r&&function e(t){p&&T.cancel(p),p=T(function(){g(!1),e(t)},1e3*t)}(r)})}function y(e){var t;r&&u.src!==r&&(t=u.currentTime,u.src=r,u.currentTime=t,r=null,u.play()),n.hasPlayed=!0,i.startTime=Date.now(),h.onStarted(e,c),c&&"promo"===c.type&&E.$broadcast("video:removeRegOverlay"),E.user.valid()||E.$broadcast("reg-gate:play-currentVideoItem",c)}function b(e){o(),h.onPaused(e,c),E.user.valid()||E.$broadcast("reg-gate:pause-currentVideoItem",c)}function _(e){o(),h.onEnded(e,c),E.user.valid()||E.$broadcast("reg-gate:pause-currentVideoItem",c)}function w(e){n.hasPlayed=!0,i.startTime=Date.now(),u.hasAttribute("controls")||(u.setAttribute("controls","controls"),u.removeEventListener("timeupdate",w))}function S(e,t){delete i.startTime,i.timeWatched=0,"segment"===t?i.segment=e:delete i.segment}function o(){var e;i.segment&&i.startTime&&(e=Date.now(),i.timeWatched+=e-i.startTime,i.timestamp=Math.round(e/1e3),delete i.startTime,i.timeWatched>=m&&(O.save([P.clone(i)]),i.timeWatched=0))}screen&&1024<=screen.width&&(u.poster=k("magick")(t,{width:1200})),S(s,a),s&&l&&("segment"===a||"promo"===a)&&(e=Math.floor(Date.now()/1e3),v(!0,f,d&&d-60<e,!1),A.addEventListener("beforeunload",o),E.$on("video:change-lesson",function(e,t){var n;s=t.contentId,a=t.contentType,r=null,u.currentTime=0,o(),S(s,a),v(!1,t.urlRefreshS,t.isPlayUrlStale,!0),angular.element(u).find("track").remove(),t.captions&&((n=document.createElement("track")).kind="subtitles",n.label=t.captionsLabel||"English",n.srclang="en",n.src="https://"+M.cdn.captions+"/"+t.captions,n.addEventListener("load",function(){this.mode="showing",u.textTracks[0].mode="showing"}),u.appendChild(n)),t.isPlayUrlStale||(u.src=t.playUrl,u.play())}),E.$on("video:exitFullscreen",function(e,t){u.pause();var n=!1;["webkitExitFullscreen","exitFullscreen","mozExitFullScreen","mozCancelFullScreen"].forEach(function(e){document[e]&&(document[e](),n=!0)}),n||document.getElementsByTagName("video")[0]&&document.getElementsByTagName("video")[0].webkitExitFullScreen()}),n.hasPlayed=!1,n.startPlay=function(){r&&u.src!==r&&(u.src=r,r=null),u.play()})}}}r.$inject=["$rootScope","$window","$filter","$timeout","CatalogService","VideoItemService","VideoPlayerAnalytics","_","config","UsageTrackingResource","trackFactory"],t.exports=r},{}],457:[function(e,t,n){"use strict";t.exports=["$q","VideoPlayerService","_",function(n,r,i){var o={},a={},s=[];return{registerVideoPlayer:function(e){var t=new r({id:e});if(o[e]=t,a[e])for(;a[e].length;)a[e].shift().resolve(o[e]);return i.each(s,function(e){e(t)}),t},getVideoPlayer:function(e){var t=o[e];if(t)return n.resolve(t);t=n.defer();a[e]||(a[e]=[]);return a[e].push(t),t.promise},getAllVideoPlayers:function(e){s.push(e),i.each(o,e)},pauseAllVideoPlayer:function(t){i.each(o,function(e){e.id!==t&&e.pause()})}}}]},{}],458:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clVideoPlayer",e("./directives/videoPlayer")),r.directive("clVideoPlayerProvider",e("./directives/provider")),r.directive("clVideoPlayerVideojs",e("./directives/players/videojs")),r.directive("clVideoPlayerUstream",e("./directives/players/ustream")),r.directive("clOverlay",e("./directives/overlay")),r.directive("clVideoAnalytics",e("./directives/videoTagPlayer")),r.controller("clRegGateController",e("./controllers/regGate-overlay")),r.controller("clLessonController",e("./controllers/lesson")),r.controller("clLessonEndController",e("./controllers/lesson-end")),r.controller("clCoursePlayerController",e("./controllers/course-player")),r.controller("clCategoryPlayerController",e("./controllers/category-player")),r.controller("clLessonPlayerController",e("./controllers/lesson-player")),r.controller("clConferenceOverlayController",e("./controllers/conference-overlay")),r.controller("clBlockedOverlayController",e("./controllers/blocked-overlay")),r.factory("videoPlayerCollection",e("./factories/videoPlayerCollection")),r.service("VideoPlayerService",e("./services/videoPlayerService")),r.service("VideoPlaylistService",e("./services/playlistService")),r.service("VideoItemService",e("./services/videoItemService")),r.service("FullScreenService",e("./services/fullScreenService")),r.service("VideoPlayerAnalytics",e("./services/videoPlayerAnalytics")),r.directive("videoPlayerCms",e("./directives/cms/view")),r.directive("videoPlayerCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./controllers/blocked-overlay":441,"./controllers/category-player":442,"./controllers/conference-overlay":443,"./controllers/course-player":444,"./controllers/lesson":447,"./controllers/lesson-end":445,"./controllers/lesson-player":446,"./controllers/regGate-overlay":448,"./directives/cms/edit":449,"./directives/cms/view":450,"./directives/overlay":451,"./directives/players/ustream":452,"./directives/players/videojs":453,"./directives/provider":454,"./directives/videoPlayer":455,"./directives/videoTagPlayer":456,"./factories/videoPlayerCollection":457,"./services/fullScreenService":459,"./services/playlistService":460,"./services/videoItemService":461,"./services/videoPlayerAnalytics":462,"./services/videoPlayerService":463}],459:[function(e,t,n){"use strict";t.exports=["$rootScope","$document",function(t,e){return r(),{registerFullScreenElement:function(n){e.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){var e,t;t="fullscreen",e=(e=n)[0],r()?e.classList?e.classList.add(t):e.className+=" "+t:e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")})},toggleFullScreen:function(e){r()?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():(e=e[0]).requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}};function r(){var e=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||!1;return t.isFullScreen=e}}]},{}],460:[function(e,t,n){"use strict";t.exports=["CourseService","MediaService","VideoItemService","DataSet","$q","$rootScope","_",function(s,c,u,l,d,f,p){return function(e){var i=this;function t(){return p.find(i.videoItems,function(e){return e.hasAccess()})}function n(){return!i.currentVideoItem&&i.currentIndex<i.videoItems.length-1}function r(){return!i.currentVideoItem&&0<i.currentIndex}function o(){return i.currentVideoItem?t():p.find(i.videoItems,function(e,t){return!(t<=i.currentIndex)&&e.hasAccess()})}function a(){if(i.currentVideoItem)return!1;var e=p.find(i.videoItems.reverse(),function(e,t){return!(e.index>=i.currentIndex)&&e.hasAccess()});return i.videoItems.reverse(),e}angular.extend(i,{initWithCourseId:function(t){var n=d.defer();return s.findById(t).then(function(e){e=p.chain(e.sessions).pluck("segments").flatten().flatten().value();p.each(e,function(e,t){var n=new u;n.setSegment(e),n.index=t,i.videoItems.addToSet(n),i.videoItemsById[n._id]=n,p.each(e.media,function(e){i.videoItemsByMediaId[e._id]=n}),n.slug&&(i.videoItemsBySlug[n.slug]=n)}),n.resolve(t)}).catch(n.reject),n.promise},setVideoItemPermissionsByCourseId:function(t,n){var r=d.defer();return s.findById(t).then(function(e){c.getCourseTokensBySlug(e.slug,n).then(function(e){p.each(e,function(e,t){var n=i.videoItemsByMediaId[t];n&&(n.token=e),n&&n.source&&n.source.media&&((n=p.findWhere(n.source.media,{_id:t}))&&(n.token=e))}),r.resolve(t)}).catch(r.reject)}).catch(r.reject),r.promise},setWatchProgressByCourseId:function(t){var n=d.defer();if(!p.isFunction(f.user.watchHistory)||!f.user.valid())return n.resolve(t),n.promise;var e={limit:300,courses:t};return f.user.watchHistory(e).then(function(){var e=s.getWatchData(t);p.each(e,function(e){i.videoItemsById[e.segment]&&i.videoItemsById[e.segment].setWatchData(e)}),n.resolve(t)}).catch(n.reject),n.promise},setCurrentVideoItem:function(e){var t=i.videoItemsById[e._id];t?(i.currentIndex=t.index,i.currentVideoItem=void 0,e.token&&!t.token&&(t.token=e.token)):i.currentVideoItem=e},getCurrentVideoItem:function(){return i.currentVideoItem||i.videoItems[i.currentIndex]},getPreviousVideoItem:function(){if(r())return i.videoItems[i.currentIndex-1]},getNextVideoItem:p.throttle(function(){if(n())return i.videoItems[i.currentIndex+1]},500,{trailing:!1}),getFirstPlayableVideoItem:t,getNextPlayableVideoItem:o,getPreviousPlayableVideoItem:a,getVideoItemBySlug:function(e){return i.videoItemsBySlug[e]},getVideoItemById:function(e){return i.videoItemsById[e]},nextVideoItem:function(){n()&&i.currentIndex++},previousVideoItem:function(){r()&&i.currentIndex--},nextPlayableVideoItem:function(){var e=o();e&&(i.currentIndex=e.index,i.currentVideoItem=void 0)},previousPlayableVideoItem:function(){var e=a();e&&(i.currentIndex=e.index,i.currentVideoItem=void 0)},hasNextVideoItem:n,hasPreviousVideoItem:r,hasPlayableNextVideoItem:o,hasPlayablePreviousVideoItem:a,clear:function(){i.currentVideoItem=void 0},videoItems:new l,videoItemsById:{},videoItemsBySlug:{},currentVideoItem:void 0,videoItemsByMediaId:{},currentIndex:0},e)}}]},{}],461:[function(e,t,n){"use strict";var u=e("async");t.exports=["MediaService","deepval","$q","_",function(o,a,s,c){return function(e){var n=this;function i(e,t){e=r(e);return e.token?o.token(e.token,t):n.token&&"promo"!==n.token?o.token(n.token):e.title||"promo"!==e.type?o.tokenById(e&&e._id):s.reject("There is no promo video for this class")}function r(e){return!!n.source.media&&(c.findWhere(n.source.media,{type:e})||n.source.media[0]||n.source.media)}angular.extend(n,{_id:void 0,title:void 0,type:void 0,duration:void 0,slug:void 0,token:void 0,source:{},watchData:void 0,startTime:void 0,endTime:void 0,quiz:void 0,hasMultipleResolution:!1,hasAccess:function(){return this&&(this.token||"broadcast"===this.type||"media"===this.type||"quiz"===this.type)},setSegment:function(e){this._id=e._id,this.title=e.title,this.type=e.type||"segment";var t=c.first(e.media);t&&(this.duration=t.duration,this.hasMultipleResolution=1<e.media.length);this.source=e,this.slug=e.slug,this.token=e.token,this.hasMedia=e.media&&e.media.length,e.quiz&&(this.quiz=e.quiz,this.type="quiz")},setBroadcast:function(e,t){t&&(this.source.course=t._id);this._id=e._id,this.type="broadcast",this.startTime=e.start_time,this.endTime=e.end_time,this.source.eventId=e.eventId,this.source.broadcastType=e.broadcast_type,this.source.contentId=e.content.content_id,this.source.contentType=e.content.content_type,this.streamId=a(e,"channel.stream_config.stream_id")},setPromo:function(e){this._id=e._id,this.type="promo";var t=c.first(e.media);t&&(this.duration=t.duration);this.source=e,this.token="promo"},setMedia:function(e){delete e.token,this._id=e._id,this.type="media",this.title=e.title,this.duration=e.duration,this.source.media=e,this.source.contentType="media",this.source.captions=e.captions},setWatchData:function(e){this.watchData=e},getMediaByType:r,getURL:i,getAllURL:function(){var t=s.defer(),r={};return u.each(n.source.media,function(t,n){i(t.type,!1).then(function(e){r[t.type]=e,n()},n)},function(e){if(e)return t.reject(e);t.resolve(r)}),t.promise},getStreamId:function(){return this.streamId}},e)}}]},{async:21}],462:[function(e,t,n){"use strict";t.exports=["CourseService","ContentAccessService","trackFactory","Vault","_",function(g,v,y,b,_){return function(l){var n=this,i="play";angular.extend(n,{videoPlayer:l,propertiesKeys:{PLAY:"PLAY",PAUSE:"PAUSE",ENDED:"ENDED"},properties:{},setProperties:r,getProperties:o,trackBlocked:function(){y.trackLessonBlocked()},onStarted:e,onEnded:t,onPaused:a}),n.videoPlayer&&(n.videoPlayer.on(n.videoPlayer.events.STARTED,e),n.videoPlayer.on(n.videoPlayer.events.PAUSED,a),n.videoPlayer.on(n.videoPlayer.events.ENDED,t),i=n.videoPlayer.getAutoplay()?"autoplay":"play");function r(e,t){n.properties[e]=t}function o(e){var t=_.clone(n.properties[e]);return r(e,{}),t||{}}function e(e,n){var r=n.source.course;_.contains(w,n.type)&&g.findById(r).then(function(e){"broadcast"===n.type?y.liveOrRebroadcastPings(e,n.source.eventId,n.source.broadcastType):y.onDemandVideoView(e,n.source),y.playVideo()}),v("course",r).then(function(e){var t=u(r,n,e);h(n,e),s(t)}).catch(function(){var e=u(r,n);h(n),s(e)})}function t(e,t){var n;m(),t&&t.source&&(n=t.source.course,v("course",n).then(function(e){d(u(n,t,e))}).catch(function(){d(u(n,t))}))}function a(e,t){var n=t.source.course;y.pauseVideo(),v("course",n).then(function(e){c(u(n,t,e))}).catch(function(){c(u(n,t))}),m()}function s(e){var t=o(n.propertiesKeys.PLAY);e=angular.extend(e,t,{action:i}),y.trackVideoPlayer(e)}function c(e){var t=o(n.propertiesKeys.PAUSE);e=angular.extend(e,t,{action:"pause"}),y.trackVideoPlayer(e)}function d(e){var t=o(n.propertiesKeys.ENDED);e=angular.extend(e,t,{action:"ended"}),y.trackVideoPlayer(e)}function u(e,t,n){var r={};return r.course_id=e,r.video_type="broadcast"===t.type?"on_air":"on_demand",r.access_type=p(t),r.event_id=t.source.eventId,r.ownership_type=f(n),r.action=i,"video"!==t.type&&"segment"!==t.type||(r.segment_id=t.source._id),"promo"===t.type&&(r.promo_media_id=t.source.media._id),r}function f(e){switch(!0){case e&&e.owned:return"owned";case e&&e.subscribed:return"subscribed";default:return"free"}}function p(e){switch(!0){case"broadcast"===e.type:return e.source.broadcastType;case"video"===e.type:case"segment"===e.type:case"media"===e.type:return e.source.is_preview?"preview":"lesson";case"promo"===e.type:return"promo";default:return e.type}}function h(i,o){var a;"broadcast"!==i.type&&(a=b.get("time_watched_in_second")||0,clearInterval(n.interval),n.interval=setInterval(function(){switch(a++,b.set("time_watched_in_second",a),!0){case 600===a:case 300===a:case 180===a:case 120===a:e=a,n=o,(r={}).course_id=(t=i).source.course,r.action="video_view",r.video_type="broadcast"===t.type?"on_air":"on_demand",r.event_id=t.source.eventId,r.time_watch=e,r.access_type=p(t),r.ownership_type=f(n),y.trackVideoPlayer(r)}var e,t,n,r},1e3))}function m(){clearInterval(n.interval)}}}];var w=["segment","video","broadcast","media"]},{}],463:[function(e,t,n){"use strict";function r(p,h,m,g,v,y,e,b,_,w){return function(l){var i=this;function e(){i.course&&(i.playlist.setVideoItemPermissionsByCourseId(i.course._id,!0),i.playlist.setWatchProgressByCourseId(i.course._id))}function t(){if(!i.course)return y.reject();var e=b.first(i.course.promo);if(!e)return y.reject();e.course=i.course._id;var t=new m;return t.setPromo(e),t.getURL(null,!1).then(function(){return i.promo=t})}function r(e){var t,n=i.currentVideoItem||{};if(b.isObject(e)){if(e._id===n._id)return i.currentVideoItem;(t=new m).setSegment(e)}if(b.isString(e)){if(e===n._id)return i.currentVideoItem;t=(t=i.playlist.getVideoItemById(e))||i.playlist.getVideoItemBySlug(e)}return t&&c(t),t}function n(){var e=i.playlist.getCurrentVideoItem();e&&s(e)}function o(){i.trigger(i.events.PAUSE,i.currentVideoItem)}function a(e){i.volume=e,i.trigger(i.events.VOLUME,i.volume)}function d(e){e&&(i.defaultVolume=e)}function f(e){"broadcast"!==e.type&&"broadcast"===i.currentVideoItem.type?i.trigger(i.events.DESTROY_USTREAM,i.currentVideoItem):"segment"!==e.type&&"segment"===i.currentVideoItem.type&&i.trigger(i.events.PAUSE,i.currentVideoItem)}function s(e){if("segment"!==e.type||e.hasMedia){if(!e.hasAccess()||"quiz"===e.type)return i.pause(),f(e),i.playlist.setCurrentVideoItem(e),u(),"quiz"!==e.type||i.trigger(i.events.QUIZ,i.currentVideoItem),void i.setState(i.states.READY);f(e),i.playlist.setCurrentVideoItem(e),u(),i.trigger(i.events.PLAY,e)}}function c(e){i.playlist.setCurrentVideoItem(e),u(),i.trigger(i.events.BUFFER,e)}function u(){var e;i.hasMedia=e=!1===(e=b.any(i.playlist.videoItems,function(e){return _(e,"source.media.0")}))?"promo"===_(i.playlist,"currentVideoItem.source.type"):e,i.hasLessons=b.any(i.playlist.videoItems,function(e){return _(e,"source.media.0")}),i.currentVideoItem=i.playlist.getCurrentVideoItem(),i.firstPlayableVideoItem=i.playlist.getFirstPlayableVideoItem(),i.nextVideoItem=i.playlist.getNextVideoItem(),i.nextPlayableVideoItem=i.playlist.getNextPlayableVideoItem(),i.previousVideoItem=i.playlist.getPreviousVideoItem(),i.previousPlayableVideoItem=i.playlist.getPreviousPlayableVideoItem(),i.hasNext=i.playlist.hasNextVideoItem(),i.hasPrevious=i.playlist.hasPreviousVideoItem(),i.hasPlayableNext=i.playlist.hasPlayableNextVideoItem(),i.hasPlayablePrevious=i.playlist.hasPlayablePreviousVideoItem(),i.isBroadcasting=i.currentVideoItem&&"broadcast"===i.currentVideoItem.type,i.ready=!0}angular.extend(i,{on:function(e,t){i.registeredEvent[e]||(i.registeredEvent[e]=[]),i.registeredEvent[e].push(t)},off:function(n,r){b.each(i.registeredEvent[n],function(e,t){e===r&&i.registeredEvent[n].splice(t,1)})},trigger:function(e){var n=arguments;b.each(i.registeredEvent[e],function(e,t){e&&e.apply(this,n)})},setCourse:function(e){var n=y.defer();return g.findById(e).then(function(t){i.course=t,i.posterUrl=t.image,i.playlist.initWithCourseId(e).then(function(e){return i.playlist.setVideoItemPermissionsByCourseId(e,!0)}).then(i.playlist.setWatchProgressByCourseId).then(function(){u(),n.resolve(t)}).catch(function(e){n.resolve(t)})}),n.promise},setPoster:function(e){i.posterUrl=e},getCoursePromo:t,getState:function(){return i.state},setState:function(e){i.state=e},getAutoplay:function(){return i.autoplay},setAutoplay:function(e){i.autoplay=e},play:n,pause:o,stop:function(){i.trigger(i.events.STOP,i.currentVideoItem)},clear:function(){i.playlist.clear(),u()},togglePlayPause:function(){(i.state!==i.states.PLAYING?n:o)()},defaultVolume:100,setDefaultVolume:d,setVolume:a,toggleVolume:function(){i.volume?(d(i.volume),a(0)):a(i.defaultVolume)},buffer:function(){c(i.playlist.getCurrentVideoItem())},playVideoItem:b.throttle(s,500,{trailing:!1}),bufferVideoItem:c,playSegment:function(e){(e=r(e))&&s(e)},playBroadcast:function(e){var t;e&&((t=new m).setBroadcast(e,i.course),t&&s(t))},playPromo:function(){t().then(function(e){s(e),i.course&&i.course.slug&&w.path("/class/"+i.course.slug)})},queueSegment:r,queueBroadcast:function(e){var t;return b.isObject(e)&&((t=new m).setBroadcast(e,i.course),c(t)),t},queueMedia:function(e){var t;return b.isObject(e)&&((t=new m).setMedia(e),i.playlist.setCurrentVideoItem(t),u()),t},next:b.throttle(function(){i.playlist.hasNextVideoItem()?(i.playlist.nextVideoItem(),u(),i.playVideoItem(i.currentVideoItem),i.trigger(i.events.NEXT,i.currentVideoItem)):i.setState(i.states.COMPLETED)},500,{trailing:!1}),nextPlayable:b.throttle(function(){i.playlist.hasPlayableNextVideoItem()&&(i.playlist.nextPlayableVideoItem(),u(),i.playVideoItem(i.currentVideoItem),i.trigger(i.events.NEXT,i.currentVideoItem))},500,{trailing:!1}),previous:function(){i.playlist.previousVideoItem(),u(),i.playVideoItem(i.currentVideoItem),i.trigger(i.events.PREVIOUS,i.currentVideoItem)},previousPlayable:function(){i.playlist.previousPlayableVideoItem(),u(),i.playVideoItem(i.currentVideoItem),i.trigger(i.events.PREVIOUS,i.currentVideoItem)},skipBack:function(e){i.trigger(i.events.SKIP_BACK,parseInt(e,10),i.currentVideoItem)},skipAhead:function(e){i.trigger(i.events.SKIP_AHEAD,parseInt(e,10),i.currentVideoItem)},seek:function(e,t,n){t&&r(t),i.trigger(i.events.SEEK,e,i.currentVideoItem,n)},currentVideoItem:void 0,currentBroadcast:void 0,nextVideoItem:void 0,previousVideoItem:void 0,firstPlayableVideoItem:void 0,nextPlayableVideoItem:void 0,previousPlayableVideoItem:void 0,isBroadcasting:!1,hasNext:!1,hasPrevious:!1,hasPlayableNext:!1,hasPlayablePrevious:!1,hasPlayed:!1,promo:void 0,playlist:new h,course:void 0,posterUrl:void 0,registeredEvent:{},state:void 0,states:{ENDED:"ended",READY:"ready",LOADING:"loading",PAUSED:"paused",PLAYING:"playing",BLOCKED:"blocked",COMPLETED:"completed"},events:{READY:"ready",PLAY:"play",BUFFER:"buffer",PAUSE:"pause",STOP:"stop",PAUSED:"paused",VOLUME:"volume",ENDED:"ended",STARTED:"started",NEXT:"next",QUIZ:"quiz",PREVIOUS:"previous",SKIP_BACK:"skip_back",SKIP_AHEAD:"skip_ahead",TIME_UPDATE:"time_update",SEEK:"seek",USER_ACTIVE:"user_active",USER_INACTIVE:"user_inactive",HOVER:"hover",BLUR:"blur",DESTROY_USTREAM:"destroy_ustream",DESTROY_VIDEOJS:"destroy_videojs"},hovering:!1,autoplay:!1,userActive:!1},l),p.$on("user:login",e),p.$on("user:register",e),p.$on("order:free:complete",e),i.analytics=new v(i),i.on(i.events.HOVER,function(){i.hovering=!0}),i.on(i.events.BLUR,function(){i.hovering=!1}),i.on(i.events.USER_ACTIVE,function(){i.userActive=!0}),i.on(i.events.USER_INACTIVE,function(){i.userActive=!1}),i.on(i.events.READY,function(){i.getState()!==i.states.BLOCKED&&i.setState(i.states.READY)}),i.on(i.events.ENDED,function(){i.setState(i.states.ENDED)}),i.on(i.events.PLAY,function(){"playing"!==i.state&&i.setState(i.states.LOADING)}),i.on(i.events.STARTED,function(){i.hasPlayed=!0,i.setState(i.states.PLAYING)}),i.on(i.events.PAUSED,function(){i.getState()!==i.states.BLOCKED&&i.setState(i.states.PAUSED)})}}r.$inject=["$rootScope","VideoPlaylistService","VideoItemService","CourseService","VideoPlayerAnalytics","$q","$timeout","_","deepval","$location"],t.exports=r},{}],464:[function(e,t,n){"use strict";(function(){var v=void 0!==Object.keys,y={},t=new RegExp("^(http(?:s)?://[^/]+)","im");function e(e){var t=function(i){var n,o,a,s,c=!1,u=!1,l=[],d={},f={},p=[];function r(e){var t;if("socialstream"!==e)c?(t=arguments,(t=Array.prototype.slice.call(t,0).slice(1))[0]&&"function"==typeof t[0]&&(d[e]||(d[e]=[]),d[e].push(t[0])),E(i,o,{cmd:e,args:t})):(l=l||[]).push(arguments);else if(k(window,"message",h),s=b(arguments[1]),a=A(s.getAttribute("src")),u=!0,p.length)for(var n=0,r=p.length;n<r;n++)S(p[n])}function h(e){var t=s;(t&&t.contentWindow&&t.contentWindow===e.source||e.source===s.id)&&n.onmessage(e)}function m(e){var t,e=JSON.parse(e.data);e.cmd&&"ready"==e.cmd?E(s,a,{cmd:"ready"}):(t=(t=[e.cmd]).concat(e.args),r.apply(this,t))}function g(){c=!0,E(i,o,{cmd:"apihandshake",args:[]}),function(){if(l){for(;l.length;)r.apply(this,l.shift());l=null}}()}function e(){r.apply(this,arguments)}return o=A(i.getAttribute("src")).toLowerCase(),E(i,o,{cmd:"ready"}),n={host:o,callMethod:e,getProperty:function(){e.apply(this,arguments)},addListener:function(e,t){f[e]||(f[e]=[]),f[e].push(t)},removeListener:function(e,t){if(t)for(var n=0,r=f[e].length;n<r;n++)f[e][n]===t&&f[e].splice(n,1);else f[e]=null},onmessage:function(e){var t;if(o||a||p.push({origin:e.origin,data:e.data}),e.origin.toLowerCase()==o){try{t=JSON.parse(e.data)}catch(e){return}if(t.sstream)m(e);else if(t.event&&t.event.ready&&(g(),_(f,"ready")),t.event&&!0===t.event.live)_(f,"live");else if(t.event&&!1===t.event.live)_(f,"offline");else{if(t.event&&!t.event.ready)if(v)Object.keys(t.event).forEach(function(e){_(f,e,t.event[e])});else for(var n in t.event)t.event.hasOwnProperty(n)&&_(f,n,t.event[n]);if(t.property)if(v)Object.keys(t.property).forEach(function(e){w(d,e,t.property[e])});else for(var n in t.property)t.property.hasOwnProperty(n)&&w(d,n,t.property[n])}}else u&&e.origin==a&&m(e)},destroy:function(){u=c=!1,a=o="",s=null,l=[],d={},f={},p=[],y[i.id]&&(y[i.id]=null),i=null}}}(e=b(e));return e.id||(e.id="UstreamEmbed"+Math.ceil(1e5*Math.random())),t.id=e.id,y[e.id]=t}function b(e){return e="string"==typeof e?document.getElementById(e):e}function _(e,t,n){for(var r in e[t])e[t].hasOwnProperty(r)&&e[t][r].call(window,t,n)}function w(e,t,n){var r;e[t]&&(r=e[t],e[t]=null,delete e[t],r.forEach(function(e){e.call(window,n)}))}function S(e){var t,n;for(t in y)y.hasOwnProperty(t)&&y[t]&&((n=document.getElementById(t))&&n.contentWindow?n.contentWindow===e.source&&y[t].onmessage(e):"string"==typeof e.source&&e.source==t&&y[t].onmessage(e))}function E(e,t,n){e.contentWindow.postMessage(JSON.stringify(n),t)}function A(e){return(e=e.indexOf("http")<0?location.protocol+e:e).match(t)[1].toString()}function k(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}if(k(window,"message",S),"function"!=typeof define||!define.amd)return window.UstreamEmbed=e;define([],function(){return e})})()},{}],465:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["categoryResource","courses","arrayMove",function(r,o,s){return{restrict:"AE",scope:{},templateUrl:"/templates/class-list-collection/edit.html",replace:!0,link:function(a,e,t){a.data=a.$parent.data,a.data.courses||(a.data.courses=[]);var n=!1;function i(e,t){o.getComplete({slug:e.slug},function(e){e.data&&(e={_id:e.data._id,nid:e.data.nid,slug:e.data.slug,image:e.data.image,title:e.data.title,title2:e.data.title2,short_title:e.data.short_title,instructors:c.deepOmit(e.data.instructors,"courses profile.bio profile.short_bio"),product:e.data.product._id,primary_category:e.data.primary_category,taxonomy:[c.find(e.data.taxonomy,function(e){return e.topic}).topic]},t&&"function"==typeof t?t(null,e):a.data.courses.push(e))})}a.data.courses.forEach(function(e){e.primary_category&&e.taxonomy||(n=!0)}),a.data.seeMoreLink&&void 0===a.data.showSeeMore&&(a.data.showSeeMore=!0),angular.extend(a,{addCourse:i,removeCourse:function(e){a.data.courses.splice(e,1)},onDrop:function(e,t,n,r,i,o){s(e,o,r),a.$apply()},setSeeMoreLinkFromTitle:function(){a.$parent.page.primary_category?r.getCategoryById({id:a.$parent.page.primary_category}).$promise.then(function(e){e&&e.success&&e.data&&(a.data.seeMoreLink="/catalog/"+e.data.slug+"?q="+encodeURIComponent(a.data.title))}):a.data.seeMoreLink="/catalog?q="+encodeURIComponent(a.data.title)},setCTALinkFromTitle:function(){a.$parent.page.primary_category?r.getCategoryById({id:a.$parent.page.primary_category}).$promise.then(function(e){e&&e.success&&e.data&&(a.data.ctaLink="/catalog/"+e.data.slug+"?q="+encodeURIComponent(a.data.title))}):a.data.ctaLink="/catalog?q="+encodeURIComponent(a.data.title)},refetchCourseData:function(){a.data.courses.forEach(function(e,n,r){i(e,function(e,t){r[n]=t})}),a.needsCourseRefresh=!1},needsCourseRefresh:n})}}}]},{underscore:void 0}],466:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/class-list-collection/cms.html",replace:!0,link:function(e,t,n){e.config=r,e.edit=e.$parent.edit,e.data||(e.data=e.$parent.data||n.data&&JSON.parse(n.data))}}}]},{}],467:[function(e,t,n){"use strict";t.exports=["config","courseResource","CatalogService","$timeout","$interpolate","$window","$document",function(a,s,c,u,l,d,f){return{restrict:"AE",scope:{courses:"=?",courseIds:"@",clTitle:"@",textCase:"@",hFormat:"@?",showSeeMore:"<?",seeMoreLink:"@",seeMoreTitle:"@?",pageName:"@",hideSeeMoreTile:"@?",moduleSlug:"@",showCategory:"@",showBadge:"<?",showPriceAndSocialData:"<?",category:"<?",topic:"<?"},templateUrl:function(e,t){return t.template?"/templates/class-list-collection/"+t.template+".html":"/templates/class-list-collection/view.html"},replace:!0,link:function(t,n,r){function e(){t.topic?t.seeMoreTile={title:t.topic.name,path:"/"+t.topic.path}:t.category?t.seeMoreTile={title:t.category.title,path:"/"+t.category.slug}:t.seeMoreTile={title:t.seeMoreTitle||"",path:""}}function i(){var e={infinite:!r.infinite||"true"===r.infinite,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]};"hover"===r.template&&(e={infinite:!0,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1}}]}),n.find(".class-carousel").not(".slick-initialized").slick(e),t.seeMoreLink&&!t.hideSeeMoreTile&&t.seeMoreTile&&$(".class-carousel .slick-slide").length===t.displayCourses.length&&(""!==t.seeMoreTile.title&&(t.seeMoreTile.title+="<br/>"),e='<div class="xs-padding-side-alt-m"><a href="'+t.seeMoreLink+t.seeMoreTile.path+'" class="see-more-tile"><div class="tile-see-more-content">see more<br/> '+t.seeMoreTile.title+" Classes</div></a></div>",n.find(".class-carousel").slick("slickAdd",e))}function o(){t.courses&&t.courses.length?(t.showSlick=function(){var e=d.innerWidth||f[0].documentElement.clientWidth;if(1200<e&&t.courses.length<=4)return!1;if(1024<e&&t.courses.length<=3)return!1;if(768<=e&&t.courses.length<=2)return!1;return 1!==t.courses.length}(),n.find(".class-carousel").is(".slick-initialized")&&n.find(".class-carousel").slick("unslick"),t.displayCourses=t.courses,u(i)):t.displayCourses=t.courses}angular.extend(t,{ctaThumbnail:function(){return t.seeMore},ctaButton:function(){return t.cta},seeMoreTile:{title:t.seeMoreTitle||"",path:t.seeMoreLink}}),t.config=a,t.classTileTemplate=r.classTileTemplate||"class-thumbnail",t.courseIds&&s.getTileData({ids:t.courseIds},function(e){t.courses=e.data},function(e){}),t.showPriceAndSocialData&&(c.getPrices().then(function(e){t.pricingData=e}),c.getSocialProofData().then(function(e){t.socialProofData=e})),t.$watch("subtitle",function(e){e=e?"{{ subtitle }}":'{{ "class-list-collection-subtitle" | i18n:"Classes" }}';t.subtitleAttribute=l(e)(t)}),t.$watch("courses",o),t.$watch("category",e),t.$watch("topic",e),t.$watch("courses.length",o),t.$watch("seeMoreTitle",e)}}}]},{}],468:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("classListCollection",e("./directives/view")),r.directive("classListCollectionCms",e("./directives/cms/view")),r.directive("classListCollectionCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":465,"./directives/cms/view":466,"./directives/view":467}],469:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/class-recommendation/edit.html",replace:!0,link:function(e,t,n){e.data=e.$parent.data,e.data.topicsCount||(e.data.topicsCount=5),e.data.coursesLimitMax||(e.data.coursesLimitMax=7),e.data.coursesLimitMin||(e.data.coursesLimitMin=2),e.data.typeDisplay||(e.data.typeDisplay="multiRow")}}}]},{}],470:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/class-recommendation/cms.html",replace:!0,link:function(e,t,n){e.config=r,e.isAdmin="true"===n.isAdmin,e.edit=e.$parent.edit,e.data||(e.data=e.$parent.data||n.data&&JSON.parse(n.data))}}}]},{}],471:[function(e,t,n){"use strict";function r(r,h,m,i,g,s,v,y){return{restrict:"AE",link:function(u,t,l){var d=l.clCourseRecommendationsProviderKey||"clCourseRecommendations",f=l.clCourseRecommendationsType||"category",o="true"===l.clCourseRecommendationsShowHiddenFromCatalog||!1,a=[];function p(e,t,n,r){e=g.reject(e,function(e){return!o&&!e.flagged.show_on_catalog||e._id===l.clCourseId||r&&g.contains(a,e._id)}),"true"===l.clCourseRecommendationsProviderRandomize&&(e=g.shuffle(e));var i=parseInt(l.clCourseRecommendationsProviderDisplayLimit||t,10);return n?(u[d]=[],g.each(e,function(e){!s.hasItem(e,"_id")&&u[d].length<i&&s.addItem(u[d],e,"_id")})):e=(e=g.uniq(e,function(e){return e._id})).slice(0,i).map(function(e){return g.clone(e)}),e}function n(){h.getCourseById(l.clCourseId,{bff:!0}).then(function(e){var n,r,i,t,o,a=void 0,s={limit:parseInt(l.clCourseRecommendationsProviderLimit||10,10),sort:l.clCourseRecommendationsProviderSort||null};if("instructor-taxonomy-map"===f)return n=e,(r=s).coursesOnly=!0,i={},t={},o={},g.each(n.instructors,function(e){e.name&&(o[e.name]=e.slug,t[e.name]=h.getCoursesByInstructor(e._id,r,null))}),void y.all(t).then(function(e){g.each(e,function(e,t){e=p(e,r.limit,!1,!1);e.length&&(i[t]={courses:e,seeMoreTitle:t,seeMoreLink:"/instructor/"+o[t]})});var t={};return g.each(n.taxonomy,function(e){e.name&&(t[e._id]=h.getCoursesByTopic(e._id,r,null))}),y.all(t)}).then(function(e){return g.each(e,function(e,t){t=m.getById(t);!t||(e=p(e,r.limit,!1,!0)).length&&(i[t.name]={courses:e,seeMoreTitle:t.name,seeMoreLink:"/catalog/"+t.path})}),h.getCoursesByCategory(n.primary_category._id,r,null)}).then(function(e){var t=n.primary_category,e=p(e,r.limit,!1,!0);e.length&&(i[t.title]={courses:e,seeMoreTitle:t.title,seeMoreLink:"/catalog/"+t.slug})}).then(function(){u[d]=i,l.clDebug,u[d+"ProviderReady"]=!0});switch(f){case"topics":var c=g.pluck(e.taxonomy,"_id"),a=h.getCoursesByTopics(c,s);break;case"topic":c=l.clTopicId;a=h.getCoursesByTopic(c,s);break;case"instructor":c=l.clInstructorId;a=h.getCoursesByInstructor(c,s);break;case"category":c=e.primary_category._id;a=h.getCoursesByCategory(c,s);break;case"cross-sell":c=e.product._id||e.product;a=v.findCrossSellById(c);break;case"bundle":a=h.getCoursesByCourseBundles(l.clCourseId,s,l.clCourseRecommendationsProviderBundleId,!1)}a.then(function(e){p(e,s.limit,!0,!0),l.clDebug,u[d+"ProviderReady"]=!0}).catch(function(e){})})}r.user.valid()&&(a=i(r.user.get("contentRights"),"purchased.courses")||[]);var e=l.$observe("clCourseId",function(){var t;l.clCourseId&&(l.lazyLoadData?t=u.$watch("moduleInView",function(e){e&&(n(),t())}):n(),e())})}}}r.$inject=["$rootScope","CatalogService","TaxonomyService","deepval","_","DuplicateService","DiscountService","$q"],t.exports=r},{}],472:[function(e,t,n){"use strict";var s=e("async");t.exports=["RecommendationsService","ScoresService","DuplicateService",function(i,o,a){return{restrict:"AE",templateUrl:"/templates/class-recommendation/view.html",replace:!0,scope:{topicsCount:"<",coursesLimitMax:"<",coursesLimitMin:"<",typeDisplay:"<",clTitle:"<",topicTitleClass:"<?",subtitle:"<",randomize:"<"},link:function(r,e,t){var n;angular.extend(r,{topics:[]}),(new o).fetchFilteredTopics(function(e){switch(n=e.slice(0,r.topicsCount),r.typeDisplay){case"multiRow":s.eachSeries(n,function(t,n){var e={topics:[t._id],limit:r.coursesLimitMax};t.courses=[],i.getRecommendations(e).then(function(e){a.addItems(t.courses,e,"_id"),t.courses=_.first(t.courses,r.coursesLimitMax),r.randomize&&(t.courses=_.shuffle(t.courses)),n()})},function(){var e,t;r.topics=(e=n,t=[],angular.forEach(e,function(e){e.courses&&e.courses.length>=r.coursesLimitMin&&t.push(e)}),t)});break;case"popular":n=n.slice(0,3),t={topics:_.pluck(n,"_id"),limit:r.coursesLimitMax},i.getRecommendations(t).then(function(e){var t={};r.randomize&&(e=_.shuffle(e)),t.courses=_.first(e,r.coursesLimitMax),t.courses&&t.courses.length>=r.coursesLimitMin&&r.topics.push(t)})}var t})}}}]},{async:21}],473:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("classRecommendation",e("./directives/view")),r.directive("classRecommendationCms",e("./directives/cms/view")),r.directive("classRecommendationCmsEdit",e("./directives/cms/edit")),r.directive("clCourseRecommendationsProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/cms/edit":469,"./directives/cms/view":470,"./directives/provider":471,"./directives/view":472}],474:[function(e,t,n){"use strict";t.exports=["$rootScope","$q","AnalyticsService","CatalogService","CourseService","EventService","SubscriptionService","trackFactory","Viewport","videoPlayerFactory","$filter","rind","moment","deepval","_",function(c,e,u,l,d,f,p,h,y,b,m,_,w,g,v){return{restrict:"AE",scope:{course:"=?",courseId:"@",eventId:"@",productId:"@",event:"=?",hideOnair:"@",hideOwned:"@?",image:"@",liveNow:"<?",title:"@clTitle",hasRSVP:"@rsvp",personalize:"<?",instructors:"@",autoplayLink:"<?",linkTarget:"@",autoplay:"<?",showProgress:"<?",summary:"<?",autoplayOnHover:"<?",clModuleId:"@?",clModule:"@?",backgroundImageOptions:"=?",pricingData:"<?",socialProofData:"<?",showBadge:"<?",showSocialData:"<?",showPriceAndSocialData:"<?",showPrice:"<?"},templateUrl:function(e,t){return t.template?"/templates/class-tile/"+t.template+".html":"/templates/class-tile/class-responsive.html"},replace:!0,link:function(a,n,e){angular.extend(a,{allowUnfollow:"true"===e.allowUnfollow,actionable:"false"!==e.actionable,showCategory:"true"===e.showCategory,linkTarget:e.linkTarget||"_self",onMouseOver:function(){a.videoPlayer&&a.autoplayOnHover&&(a.videoPlayer.$scope.$broadcast("video:stream:play"),a.mouseover=!0)},onMouseOut:function(){a.videoPlayer&&a.autoplayOnHover&&(a.videoPlayer.$scope.$broadcast("video:stream:pause"),a.mouseover=!1)},showSummary:function(e,t,n){!a.summary||y.getWidth()<480||(t.stopPropagation(),t.preventDefault(),c.$emit("course-modal:show",{courseId:e._id,clModule:a.clModule,clModuleLocation:u.getModuleLocation(a.clModuleId),linkTarget:a.linkTarget,dismiss:!0}),t={action:"modal shown",courseId:e._id,ctaType:"button",ctaLabel:m("i18n")("learning-path-tile-view-class","view class"),clModuleId:a.clModuleId,clModule:a.clModule,productId:e.product._id||e.product,productType:"course"},h.courseModal("learning-path",t))}}),a.hideOwned=a.hideOwned||!1;var t=a.$watch("course",function(){a.course&&(a.eventId&&(a.course.eventId=a.eventId),a.course.title=a.course.short_title,a.productId=a.course._id,!a.event&&a.course.eventId&&f.getEventById(a.course.eventId).then(function(e){a.event=e,(a.autoplay||a.autoplayOnHover)&&o()}),a.course.eventData&&(a.event=a.course.eventData,(a.autoplay||a.autoplayOnHover)&&o()),function(){if(!c.user.valid())return;var e=g(c.user.get("contentRights"),"purchased.courses")||[],t=g(c.user.get("contentRights"),"starred.courses")||[],n=g(c.user.get("follows"),"topic")||[],r=[];a.course&&a.course.taxonomy&&(r=v.pluck(a.course.taxonomy,"_id"));e.length&&(a.isOwned=v.some(e,function(e){return e===a.course._id}));t.length&&(a.isStarred=v.some(t,function(e){return e===a.course._id}));var i,o,e=[];n.length&&(e=v.intersection(n,r),a.isRecommended=!!e);a.isOwned?(i=m("i18n")("class-tile-personalization-owned","Owned Class"),o="owned-class"):a.isStarred?(i=m("i18n")("class-tile-personalization-wishlisted","Saved Class"),o="whish-listed"):a.isRecommended&&(i=0<e.length?m("i18n")("class-tile-personalization-recommended","Recommended for you"):null,o="recommended");p.getSubscriptionContentByUser().then(function(e){a.isSubscribed=v.contains(e,a.course._id),a.isSubscribed&&(i=m("i18n")("class-tile-personalization-subscribed","Subscribed Class"),o="owned-class")}),a.personalizationString=i,a.personalizationStyle=o}(),t(),s())}),r=a.$watch("event",function(){{var e;a.event&&(a.eventId=a.event._id,f.addEventBroadcastData(a.event),a.event.hasLiveBroadcasts&&((e=g(a.event||{},"currentBroadcast.broadcast_type"))&&(a.event.isLiveNow="live"===e),a.event.liveStartTime&&(a.event.start_time=a.event.liveStartTime),a.event.liveEndTime&&(a.event.end_time=a.event.liveEndTime),e=a.event.end_time-a.event.start_time,a.eventDurationInDays=Math.ceil(w.duration(1e3*e).asDays())),a.course&&(a.event.url&&(a.course.url=a.event.url),a.event.title&&(a.course.short_title=a.event.title),a.event.is_container&&f.getInstructors(a.event._id).then(function(e){a.course.instructors=e}),(e=a.event.image&&a.event.image.file&&a.event.image.file.key)&&(a.course.image=e)),a.event.currentBroadcast?(a.event.currentBroadcast.url&&(a.course.url=a.event.currentBroadcast.url),a.event.currentBroadcast.title&&(a.course.short_title=a.event.currentBroadcast.title,a.course.instructors=void 0)):a.event.nextBroadcast&&(a.event.nextBroadcast.url&&(a.course.url=a.event.nextBroadcast.url),a.event.nextBroadcast.title&&(a.course.short_title=a.event.nextBroadcast.title,a.course.instructors=void 0)),r())}}),i=a.$watch("showProgress",s);function o(){g(_,"context.ua.mobile")||(a.videoPlayer=b.addVideoPlayer(a.event._id,a,!1),a.autoplayOnHover&&(a.videoPlayer.autoplay=!1),a.videoPlayer.broadcasts.setBroadcasts(a.event.swimlanes[0].broadcasts),a.$on("ustream:ready",function(e,t){t.addListener("playing",function(e,t){t?a.autoplayOnHover&&a.mouseover||!a.autoplayOnHover?n.addClass("video-playing"):(n.removeClass("video-playing"),a.videoPlayer.$scope.$broadcast("video:stream:pause")):n.removeClass("video-playing")})}))}function s(){a.course&&!a.course.gettingWatchData&&a.showProgress&&g(a,"course._id")&&(a.course.gettingWatchData=!0,d.findById(a.course._id,{},{bff:!0}).then(function(e){a.course.sessions=e.sessions,a.progress=d.getCourseProgress(e),a.currentSegment=d.getLatestSegmentForCourse(e),a.currentSegment&&!a.currentSegment.watchData?delete a.currentSegment:a.watchDetails=d.getSegmentWatchDetails(a.currentSegment),i()}))}a.$watch("pricingData",function(){a.pricingData&&(a.course.product?v.isObject(a.course.product)?a.course.price=a.course.product:a.course.price=v.findWhere(a.pricingData,{id:a.course.product}):d.findBySlug(a.course.slug).then(function(e){e&&e.product&&(a.course.product=e.product._id,a.course.price=v.findWhere(a.pricingData,{id:a.course.product}))}))}),a.$watch("socialProofData",function(){{var e,t;a.socialProofData&&(e=a.course,a.course.counts=v.findWhere(a.socialProofData,{id:e._id}),e.counts&&(t=e.counts.recommended+e.counts.not_recommended,e.socialProof={isPositive:0<e.counts.reviews&&.6<=e.counts.recommended/t,positiveReviewsPercent:Math.floor(e.counts.recommended/t*100)}))}}),a.courseId?l.getCourseById(a.courseId,{keys:["instructors","short_description"]},{owner_only:!0,subscription_only:!0}).then(function(e){a.course=e,a.productId=a.courseId,a.event||(a.event=f.getNearestEvent(a.course.broadcast_schedules)),a.reInit=!0}):a.reInit=!0,a.backgroundImageOptions||(a.backgroundImageOptions={width:500}),(a.showPriceAndSocialData||a.showPrice)&&(a.pricingData||l.getPrices().then(function(e){a.pricingData=e})),(a.showPriceAndSocialData||a.showSocialData)&&(a.socialProofData||l.getSocialProofData().then(function(e){a.socialProofData=e}))}}}]},{}],475:[function(e,t,n){"use strict";e("../../common/app").directive("classTile",e("./directives/view"))},{"../../common/app":70,"./directives/view":474}],476:[function(e,t,n){"use strict";t.exports=["$filter","$timeout","config","_","arrayMove","toastr","courseResource","savedSearchPicker",function(e,t,r,i,n,o,a,s){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/cms-content-finder/cms-edit.html",replace:!0,link:function(n){n.data||(n.data=n.$parent.data),n.data.template||(n.data.template="grid"),n.data.dataSourceType||(n.data.dataSourceType="bundle"),!1!==n.data.deepLinking&&(n.data.deepLinking=!0),n.data.showAll||(n.data.showAll=!1),n.$watch("data.dataSourceType",function(e,t){e!==t&&(n.data.dataSourceId=null,n.data.dataSource=null)}),angular.extend(n,{config:r,pickBundle:function(e){e&&e.flags&&-1<e.flags.indexOf("!published")?(o.warning("Can't add an unpublished bundle","CMS Content Finder"),n.data.dataSourceId=null):(n.data.dataSourceId=null,t(function(){n.data.dataSourceId=e._id,n.data.dataSource=i.pick(n.data.dataSource,"product","short_title")}))},pickSavedSearch:function(){s().result.then(function(e){e?(n.data.dataSourceId=null,t(function(){n.data.dataSourceId=e})):o.warning("No content selected.")})}})}}}]},{}],477:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{data:"=?",clModuleId:"@"},templateUrl:"/templates/cms-content-finder/cms-view.html",controllerAs:"contentFinderCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{},this.hideTopics=!0,this.deepLinking=this.data&&this.data.deepLinking,this.data.customTopics&&(this.hideTopics=!1,this.customTopics=this.data.customTopics)}]}}},{}],478:[function(e,t,n){"use strict";t.exports=["config","trackFactory","_",function(o,a,s){return{restrict:"AE",scope:{title:"@clTitle",sub:"@clSub",ctaText:"@",primaryTopics:"=?",secondaryTopics:"=?",showAll:"=?",columns:"=?",pageName:"@",moduleSlug:"@",clModuleId:"@"},templateUrl:"/templates/cms-content-finder/view.html",replace:!0,link:function(t,e,n){angular.extend(t,{config:o,showMore:function(){t.showingMore=!0,a.expandTopics(t.ctaText,"button","Topic List",t.clModuleId)},showingMore:!1,activeIndex:null});var r=t.$watch("primaryTopics",function(e){t.primaryTopics&&(s.each(t.primaryTopics,function(e){e.ids=e.follows,e.name=e.title,e.path=e.link}),r())}),i=t.$watch("secondaryTopics",function(e){t.secondaryTopics&&(s.each(t.secondaryTopics,function(e){e.ids=e.follows,e.name=e.title,e.path=e.link}),i())})}}}]},{}],479:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("cmsContentFinder",e("./directives/index")),r.directive("cmsContentFinderCms",e("./directives/cms/view")),r.directive("cmsContentFinderCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":476,"./directives/cms/view":477,"./directives/index":478}],480:[function(e,t,n){"use strict";t.exports=["$rootScope","$scope","$window","$location","$routeParams","qs","rind","AnalyticsService",function(n,r,e,t,i,l,o,d){var a=o&&o.dump&&o.dump.data||{},e=(angular.forEach(a.modules,function(e){angular.isString(e.data.content)&&(e.data.content=e.data.content.replace(/\&lt\;script/gi,"<script"),e.data.content=e.data.content.replace(/\&lt\;\/script\&gt/gi,"<\/script>"))}),angular.extend(r,{$window:e,setPageTheme:u,routeParams:o&&o.dump&&o.dump.routeParams,page:a}),{});try{var s=t.absUrl(),f=s.substring(s.indexOf("?"),s.length);e=l.parse(f)}catch(e){}var c=angular.extend({},e,t.search(),i,r.routeParams);function u(e,t){n.headerTheme=t||n.headerTheme||r.page.theme}angular.forEach(c,function(e,t){"true"===e?c[t]=!0:"false"===e?c[t]=!1:isNaN(e)||(c[t]=+e)}),n.routeParams=c,r.$on("user:login",u),r.$on("user:register",u)}]},{}],481:[function(e,t,n){"use strict";var r=e("../../common/app");r.config(["$locationProvider",function(e){try{rind&&rind.context&&rind.context.flags&&rind.context.flags.html5_mode&&e.html5Mode(!0)}catch(e){}}]),r.controller("cmsPage",e("./controllers/page"))},{"../../common/app":70,"./controllers/page":480}],482:[function(e,t,n){"use strict";function r(s){return{restrict:"AE",scope:{list:"=?",itemTitle:"=?",itemBody:"=?",header:"=?",subheader:"=?",editingItem:"=?"},templateUrl:"/templates/collapsible-list/cms/edit.html",link:function(a){a.data=a.$parent.data,a.data.list=a.data.list||[],a.data.template=a.data.template||"dark",a.data.seoType=a.data.seoType||"none",angular.extend(a,{editingIdx:-1,updateItem:function(){a.editingIdx<0?a.data.list.push({title:a.itemTitle,body:a.itemBody}):a.data.list[a.editingIdx]={title:a.itemTitle,body:a.itemBody};a.itemTitle="",a.itemBody="",a.editingIdx=-1},editItem:function(e,t){a.editingIdx=t,a.itemTitle=e.title,a.itemBody=e.body},removeItem:function(e){a.data.list.splice(e,1),a.itemTitle="",a.itemBody="",a.editingIdx=-1},onDrop:function(e,t,n,r,i,o){s(e,o,r),a.$apply()}})}}}r.$inject=["arrayMove"],t.exports=r},{}],483:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/collapsible-list/cms/view.html",link:function(e){e.data||(e.data=e.$parent.data)}}}},{}],484:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("collapsibleListCmsEdit",e("./directives/cms/edit")),r.directive("collapsibleListCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/edit":482,"./directives/cms/view":483}],485:[function(e,t,n){"use strict";t.exports=["$timeout",function(r){return{restrict:"AE",scope:{conditions:"=?",startText:"@",addText:"@"},templateUrl:"/templates/conditionals/edit.html",replace:!0,link:function(t,e,n){angular.extend(t,{addCondition:function(){t.newCondition.key&&t.newCondition.value&&(t.conditions=t.conditions||[],t.conditions.push(angular.copy(t.newCondition)),t.addingCondition=!1,t.newCondition.key="",t.newCondition.value="")},addNewCondition:function(){t.addingCondition=!0,r(function(){e[0].querySelector("input").focus()},10)},notAddingCondition:function(){t.addingCondition=!1},removeCondition:function(e){t.conditions.splice(e,1)},removeAllConditions:function(){t.conditions=[]},startText:n.startText||"If",addText:n.addText||"Add condition",newCondition:{key:"",value:""}}),t.data=t.$parent.module&&t.$parent.module.data,t.conditions||(t.data&&!t.data.conditions&&(t.data.conditions=[]),t.conditions=t.data&&t.data.conditions||[]),t.addingCondition=!t.conditions.length}}}]},{}],486:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{conditions:"=?",readOnly:"@",onRemove:"&",startText:"@"},templateUrl:"/templates/conditionals/list.html",replace:!0,link:function(e,t,n){e.startText=n.startText||"If"}}}]},{}],487:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("conditionalsEdit",e("./directives/edit")),r.directive("conditionalsList",e("./directives/list"))},{"../../common/app":70,"./directives/edit":485,"./directives/list":486}],488:[function(e,t,n){"use strict";function r(i,e,t,o,a,s,c){return{restrict:"AE",scope:{contents:"=?",tileCtrl:"@",courseIds:"@",clTitle:"@",textCase:"@",hFormat:"@?",showSeeMore:"<?",seeMoreLink:"@",pageName:"@",moduleSlug:"@",showCategory:"@",showPriceAndSocialData:"<?"},templateUrl:function(e,t){return t.template?"/templates/content-list-collection/"+t.template+".html":"/templates/content-list-collection/hover.html"},replace:!0,link:function(t,n,r){function e(){var e=!r.infinite||"true"===r.infinite;t.reInit=!0,e={infinite:e,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]},"hover"===r.template&&(e={infinite:!0,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1}}]}),n.find(".content-carousel").not(".slick-initialized").slick(e)}angular.extend(t,{ctaThumbnail:function(){return t.seeMore},ctaButton:function(){return t.cta}}),t.config=i,t.$watch("subtitle",function(e){e=e?"{{ subtitle }}":'{{ "class-list-collection-subtitle" | i18n:"Classes" }}';t.subtitleAttribute=a(e)(t)}),t.$watch("contents.length",function(){t.contents&&t.contents.length&&(t.showSlick=function(){var e=s.innerWidth||c[0].documentElement.clientWidth;if(1200<e&&t.contents.length<=4)return!1;if(1024<e&&t.contents.length<=3)return!1;if(768<=e&&t.contents.length<=2)return!1;return 1!==t.contents.length}(),n.find(".content-carousel").is(".slick-initialized")&&n.find(".content-carousel").slick("unslick"),o(e))})}}}r.$inject=["config","courseResource","CatalogService","$timeout","$interpolate","$window","$document"],t.exports=r},{}],489:[function(e,t,n){"use strict";e("../../common/app").directive("contentListCollection",e("./directives/view"))},{"../../common/app":70,"./directives/view":488}],490:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{baseModel:"<",ctrl:"<?"},controller:["$controller","$scope",function(e,t){if(t.ctrl)return e(t.ctrl,{$scope:t});angular.extend(t,{content:t.baseModel})}],templateUrl:function(e,t){return t.template?"/templates/content-tile/"+t.template+".html":"/templates/content-tile/onair-responsive.html"},replace:!0,link:function(e,t,n){angular.extend(e,{allowUnfollow:"true"===n.allowUnfollow,actionable:"false"!==n.actionable,showCategory:"true"===n.showCategory,linkTarget:n.linkTarget||"_self",onMouseOver:function(){e.videoPlayer&&e.autoplayOnHover&&(e.videoPlayer.$scope.$broadcast("video:stream:play"),e.mouseover=!0)},onMouseOut:function(){e.videoPlayer&&e.autoplayOnHover&&(e.videoPlayer.$scope.$broadcast("video:stream:pause"),e.mouseover=!1)}}),e.backgroundImageOptions||(e.backgroundImageOptions={width:500})}}}},{}],491:[function(e,t,n){"use strict";e("../../common/app").directive("contentTile",e("./directives/view"))},{"../../common/app":70,"./directives/view":490}],492:[function(e,t,n){"use strict";var s=e("moment");t.exports=["$interval",function(a){return{restrict:"AE",templateUrl:function(e,t){return t.template?"/templates/countdown-timer/"+t.template+".html":t.clCountdownTimerTemplateUrl||"/templates/countdown-timer/view.html"},replace:!0,scope:{daysBeforeCountdown:"=?",wording:"@",dealStart:"=",dealEnd:"=",format:"=?",showProgressBar:"="},link:function(o,e){function t(e){o.daysBeforeCountdown=o.daysBeforeCountdown||6;var t,n=s.unix(e||o.dealEnd),e=s.unix(o.dealStart),r=n.diff(e,"milliseconds");function i(){var e=s(),e=n.diff(e,"milliseconds");o.percent=100-Math.round(100*e/r),o.displayTimer=0<=e,o.displayTimer?(e=s.duration(e),o.days=Math.floor(e.asDays()),o.hours=e.hours(),o.minutes=e.minutes(),o.seconds=e.seconds(),o.countdownSale=o.days<=o.daysBeforeCountdown):a.cancel(t)}t=a(function(){i()},o.getTimeout()),i()}o.$watch("dealEnd",t),t()},controller:["$scope",function(o){var a="dd-hh-mm-ss";o.getTimeout=function(){var e,t=["ss","mm","hh","dd"],n={ss:1e3,mm:6e4,hh:36e5,dd:864e5},r=t.length;if(void 0===o.format)return o.format=a,1e3;for(var i=0;i<r;i++)if(o.hasFormat(e=t[i]))return n[e];return o.format=a,1e3},o.hasFormat=function(e){return 0<=o.format.indexOf(e)}}]}}]},{moment:void 0}],493:[function(e,t,n){"use strict";e("../../common/app").directive("countdownTimer",e("./directives/view"))},{"../../common/app":70,"./directives/view":492}],494:[function(e,t,n){"use strict";e("../../common/app").directive("couponProvider",e("./provider"))},{"../../common/app":70,"./provider":495}],495:[function(e,t,n){"use strict";function r(c){return{restrict:"A",link:function(n,e,r){var i=[],t=(angular.forEach(["clCouponCode"],function(e){i.push(r.$observe(e,o))}),c("/api/ecom/coupon/:token",{token:"@token"}));function o(){r.clCouponCode?t.get({token:r.clCouponCode}).$promise.then(s).catch(a):a()}function a(){n.couponProviderReady=!0}function s(e){var e=e.data,t=r.clCouponKey;n[t=t||"clCoupon"]={valid:!!e,expired:e&&e.expired||!1,used:e&&e.isUsed||!1},a(),!0!==r.watch&&angular.forEach(i,function(e){e()})}}}}r.$inject=["$resource"],t.exports=r},{}],496:[function(e,t,n){"use strict";var r=e("underscore");t.exports=["courses","arrayMove",function(n,s){return{restrict:"AE",scope:{},templateUrl:"/templates/course-collection/edit.html",replace:!0,link:function(a,e,t){a.data=a.$parent.data,a.data.courses||(a.data.courses=[]),a.addCourse=function(e){n.getComplete({slug:e.slug},function(e){e.data&&(e={_id:e.data._id,nid:e.data.nid,slug:e.data.slug,image:e.data.image,title:e.data.title,short_title:e.data.short_title,instructors:r.deepOmit(e.data.instructors,"courses profile.bio profile.short_bio")},a.data.courses.push(e))})},a.removeCourse=function(e){a.data.courses.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{underscore:void 0}],497:[function(e,t,n){"use strict";t.exports=["$sce","config","constants",function(e,r,i){return{restrict:"AE",scope:{model:"=ngModel",edit:"=",size:"@"},templateUrl:"/templates/course-collection/tile.html",replace:!0,link:function(e,t,n){e.config=r,e.constants=i}}}]},{}],498:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/course-collection/view.html",replace:!0,link:function(t,e,n){t.config=r,t.edit=t.$parent.edit,t.data||(t.data=t.$parent.data),t.$watch("data.courses",function(){if(t.edit){if(0<t.data.courses.length){t.courses=[],t.firstCourse=t.data.courses[0];for(var e=1;e<t.data.courses.length;e++)t.courses.push(t.data.courses[e])}}else t.courses=angular.copy(t.data.courses),t.firstCourse=t.courses.shift()},!0)}}}]},{}],499:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("courseCollection",e("./directives/view")),r.directive("courseCollectionTile",e("./directives/tile")),r.directive("courseCollectionEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":496,"./directives/tile":497,"./directives/view":498}],500:[function(e,t,n){"use strict";t.exports=["$filter","$uibModal","CatalogService","CourseService","trackFactory",function(e,t,o,a,s){return{restrict:"AE",scope:{courseId:"@?",productId:"@?",clModule:"@?",clModuleLocation:"@?"},templateUrl:function(e,t){return"/templates/course-modal/courseCard.html"},link:function(n,e,t){var r;function i(e){n.course=e,n.productId=e.product._id||e.product,a.getPromoVideo(n.course).then(function(e){n.playUrl=e.playUrl})}(n.courseId||n.productId)&&(angular.extend(n,{onVideoPlayerReady:function(){var t=n.$watch("playUrl",function(e){e&&(n.$broadcast("video:queue",{playUrl:e,posterUrl:n.course.image}),t(),n.$broadcast("video:send-command","play"),s.onDemandVideoView(n.course))})},linkTarget:t.linkTarget||"_self"}),r={keys:["instructors","sessions","segments","description","product"],fetch:!0},n.courseId?o.getCourseById(n.courseId,r).then(i):n.productId&&o.getCourseByProduct(n.productId,r).then(i),"catalogPreview"===t.template&&s.catalog("search",{action:"modal shown",modal_id:"course_preview_modal"},{},_.noop))}}}]},{}],501:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("courseModal",e("./services/courseModal")),r.directive("courseCard",e("./directives/courseCard"))},{"../../common/app":70,"./directives/courseCard":500,"./services/courseModal":502}],502:[function(e,t,n){"use strict";t.exports=["$uibModal","trackFactory",function(e,t){return function(n){e.open({templateUrl:function(){var e="/templates/course-modal/courseModal.html";return e=n.template?"/templates/course-modal/"+n.template+"Modal.html":e},windowClass:"cl-modal modal-course-summary",controller:["$scope","$uibModalInstance",function(e,t){if(!n.courseId&&!n.productId)return t.dismiss();angular.extend(e,{courseId:n.courseId,productId:n.productId,clModule:n.clModule,clModuleLocation:n.clModuleLocation,linkTarget:n.linkTarget,dismiss:n.dismiss,template:n.template,closeModal:t.dismiss})}]}).result.finally(function(){t.clearMediaViewInterval()})}}]},{}],503:[function(e,t,n){"use strict";t.exports=["CourseService",function(o){return{restrict:"A",link:function(n,e,r){var i=r.$observe("clCourseId",function(){var t;r.clCourseId&&(t=r.clCourseNavigationProviderKey||"clCourseNavigationProvider",o.getCourseTaxonomy(r.clCourseId).then(function(e){n[t]=e,n.clCourseNavigationProviderReady=!0,i()}))})}}}]},{}],504:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseNavigationProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":503}],505:[function(e,t,n){"use strict";t.exports=["CourseService","EventService","rind","$window",function(a,s,c,u){return{restrict:"AE",link:function(r,e,i){var o=i.$observe("clCourseId",function(){var e,t;function n(){var e=document,t=e.createElement("script"),e=(t.type="text/javascript",t.defer=!0,t.src="https://salesiq.zoho.com/support.creativelive/float.ls?embedname=creativelive",e.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}i.clCourseId&&(r.canUnfollow="true"===i.canUnfollow,r.monthDayFormat=i.monthDayFormat||"MMM D",r.dayFormat=i.dayFormat||"D",r.hourFormat=i.hourFormat||"h:mmA",r.hourTimezoneFormat=i.hourFormat||"h:mmA z",r.hourMinutesTimezoneFormat=i.hourFormat||"h:mmA z",r.buttonCta=i.buttonCta||"rsvp",r.description=i.description||"stream this class online for free",r.isRsvpRemovalVariation=!1,r.chatSupportVariation=!1,e=!!(c&&c.context&&c.context.ua&&c.context.ua.mobile),r.isMobile=e&&u.screen.width<768,t=i.clCourseOnairProviderKey||"clCourseOnair",a.getScheduleData(i.clCourseId,s).then(function(e){r[t]=e,r[t].showRsvp=!0,"bootcamp"!==c.dump.course.course_type&&r.isRsvpRemovalVariation&&e.next&&"pre_live"!==e.next.broadcast_type&&"live"!==e.next.broadcast_type&&(r[t].showRsvp=!1),!e.next||"pre_live"!==e.next.broadcast_type&&"live"!==e.next.broadcast_type||(r[t].isLiveBroadcast=!0),e.current&&"pre_live"!==e.current.broadcast_type&&"live"!==e.current.broadcast_type&&r.chatSupportVariation&&!r.isMobile&&n(),i.clDebug,r.clCourseOnairReady=!0,o()}).catch(function(e){e||!r.chatSupportVariation||r.isMobile||n()}))})}}}]},{}],506:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseOnairProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":505}],507:[function(e,t,n){"use strict";t.exports=["CourseService","_",function(o,a){return{restrict:"A",link:function(n,e,r){var t=a.throttle(function(){r.clCourseId&&o.getSharingData(r.clCourseId,angular.extend({segmentSlug:r.clSegmentSlug},r)).then(function(e){var t=r.clCourseShareProviderKey||"clCourseShare";n[t]=e,n.clCourseShareReady=!0,i()})},300),i=r.$observe("clCourseId",t);r.$observe("clSegmentSlug",t)}}}]},{}],508:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseShareProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":507}],509:[function(e,t,n){"use strict";t.exports=["$q","_","CourseService","CatalogService","productResource",function(c,u,l,d,f){return{restrict:"AE",replace:!0,link:function(n,e,t){var r,i,o=t.clCourseStatsProviderKey||"clCourseStatsProvider",a=(n[o]={},t.$observe("clProductId",function(){t.clProductId&&(f.findById({id:t.clProductId}).$promise.then(function(e){e&&e.data&&(r=e.data,i=e.data.source,n[o].product=r,"bundle"===(n[o].source=i).source_type||"bundle"===i.type||"conference"===i.source_type||"conference"===i.type?(s(),n[o].showReviews=!1):(l.findById(i._id).then(function(e){i=e}),s(),l.getGallery(i.slug,{page:1,perpage:1}).then(function(e){n[o].gallery=e}),n[o].showReviews=!0),n[o].clCourseStatsProviderReady=!0)}),a())}));function s(){var t=i._id;if("bundle"===i.source_type&&(t=i.source_id.courses.join(",")),!(t="bundle"!==i.type&&"conference"!==i.type?t:i.courses.join(",")))return c.resolve();d.getSocialProofData().then(function(e){var e=u.find(e,function(e){return e.id===t});n[o].counts=e,n[o].counts&&(e=n[o].counts.recommended+n[o].counts.not_recommended,(n[o].counts.recommendPercentage=0)<e&&(n[o].counts.recommendPercentage=Math.round(n[o].counts.recommended/e*100)))})}}}}]},{}],510:[function(e,t,n){"use strict";t.exports=["_","CourseService","CatalogService","productResource","$document","$location",function(o,a,s,c,e,t){return{restrict:"AE",replace:!0,scope:{productId:"="},templateUrl:function(e,t){return t.template?"/templates/course-stats/"+t.template+".html":"/templates/course-stats/view.html"},link:function(n,e,t){var r=n.$watch("productId",function(e){e&&(c.findById({id:n.productId},function(e){e&&e.data&&(n.product=e.data,n.source=n.product.source,"bundle"===n.source.source_type||"bundle"===n.source.type||"conference"===n.source.source_type||"conference"===n.source.type?(i(),n.showReviews=!1):(a.Resource.findById({id:n.source._id},function(e){n.source=e.data}),i(),a.Resource.getGallery({slug:n.source.slug,page:1,perpage:8},function(e){n.gallery=e.data}),n.showReviews=!0))}),r())});function i(){var t=n.source._id;"bundle"===n.source.source_type&&(t=n.source.source_id.courses.join(",")),(t="bundle"!==n.source.type&&"conference"!==n.source.type?t:n.source.courses.join(","))&&s.getSocialProofData().then(function(e){var e=o.find(e,function(e){return e.id===t});n.counts=e,n.counts&&(e=n.counts.recommended+n.counts.not_recommended,(n.counts.recommendPercentage=0)<e&&(n.counts.recommendPercentage=Math.round(n.counts.recommended/e*100)))})}}}}]},{}],511:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("courseStats",e("./directives/view")),r.directive("clCourseStatsProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":509,"./directives/view":510}],512:[function(e,t,n){"use strict";t.exports=["$rootScope","_","deepval","optimizelyUtils","ClassUrlGenerator",function(i,o,a,s,c){return{restrict:"AE",scope:{model:"=ngModel",onClick:"&?",badgeCounts:"="},templateUrl:"/templates/course-tile/viewPriceReview.html",replace:!0,link:function(t,e,n){t.optimizelyUtils=s,t.onClick=t.onClick||angular.noop;var r=t.$watch("model",function(){if(!t.model.slug)return null;var e=i.user.valid()&&a(i.user.get("contentRights"),"purchased.courses")||[];e.length&&(t.isOwned=o.some(e,function(e){return e===t.model._id}));t.hidePrice=i.subscriptionViewActive&&(i.user.hasActiveConsumerSubscription()||i.user.hasActiveEnterpriseSubscription()),t.url=c(t.model),r()})}}}]},{}],513:[function(e,t,n){"use strict";e("../../common/app").directive("courseTile",e("./directives/view"))},{"../../common/app":70,"./directives/view":512}],514:[function(e,t,n){"use strict";t.exports=["config",function(r){return{restrict:"AE",templateUrl:"/templates/course-video/edit.html",replace:!0,scope:{data:"=?"},link:function(t,e,n){t.config=r,t.data||(t.data=t.$parent.data),t.data.course||(t.data.course={}),t.course=angular.copy(t.data.course),t.addCourse=function(e){t.data.course={_id:e._id,slug:e.slug,short_title:e.short_title}},t.removeCourse=function(){t.data.course={}}}}}]},{}],515:[function(e,t,n){"use strict";t.exports=["$rootScope","config","courseResource","videoPlayerFactory",function(i,o,a,s){return{restrict:"AE",templateUrl:"/templates/course-video/view.html",replace:!0,scope:{data:"=?"},link:function(t,e,n){function r(){t.segments=t.videoPlayer.segments.getSegments(t.course)}t.config=o,t.data||(t.data=t.$parent&&t.$parent.data),t.data.course._id&&t.$watch("data.course",function(e){a.findById({id:t.data.course._id},function(e){e=e&&e.data||e;t.course=e,t.product=t.course.product,i.user&&i.user.hasContent&&(t.owned=i.user.hasContent("purchased","courses",t.course._id),!1===t.owned&&i.user.hasRole("owns_all_courses")&&(t.owned=!0,t.comped=!0),t.$applyAsync()),t.videoPlayer=s.addVideoPlayer(t.course._id,t),t.videoPlayer.segments.getCourseToken(t.course.slug,r)})})}}}]},{}],516:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("courseVideo",e("./directives/view")),r.directive("courseVideoEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":514,"./directives/view":515}],517:[function(e,t,n){"use strict";t.exports=["CourseService",function(t){return{restrict:"AE",link:function(n,e,r){var i=r.$observe("clCourseId",function(){r.clCourseId&&t.getWhatYouGetData(r.clCourseId).then(function(e){var t=r.clCourseWhatYouGetProviderKey||"clCourseWhatYouGet";n[t]=e,n.clCourseWhatYouGetReady=!0,i()}).catch(function(e){})})}}}]},{}],518:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseWhatYouGetProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":517}],519:[function(e,t,n){"use strict";function r(g,v,y,b,_,w,S){return{restrict:"A",link:function(s,l,t){var n=[],c=(angular.forEach(["clCourseId","clCourseIds","clCourseSlug","clCourseNid","clProductId"],function(e){e=t.$observe(e,f);n.push(e)}),t.clCourseProviderKey||t.clCourseKey||"clCourse"),i=(s.$on("user:login",a),s.$on("user:register",a),s.$on("user:logout",a),s.$on("user:follow",a),s.$on("order:free:complete",a),s.$on("videoplayer-toggleChatModal",function(e,t){e.preventDefault(),e.stopPropagation(),s.showChatButton=void 0!==t?t:m()}),s.$on("$locationChangeSuccess",function(){var e=v.path();0===e.indexOf("/class/")&&(h(),5===(e=e.split("/")).length&&"lessons"===e[3]&&e[4]&&(s.lessonSlug=e[4]))}),g.$on("libcard:create",function(e,t,n,r){w.onLibraryCard(t,n,r),i&&i()})),d=y("i18n")("cl-class-page-lesson-entity-name","Lesson");var e={},r={};try{e=JSON.parse(t.clCourseOpts)}catch(e){}try{r=JSON.parse(t.clCourseParams)}catch(e){}function f(){t.clCourseId?b.getCourseById(t.clCourseId,e,r).then(o).catch(u):t.clCourseIds?b.getCoursesByIds(t.clCourseIds.split(","),e,r).then(o).catch(u):t.clCourseSlug?b.getCourseBySlug(t.clCourseSlug,e,r).then(o).catch(u):t.clCourseNid?b.getCourseByNid(t.clCourseNid,e,r).then(o).catch(u):t.clProductId&&b.getCourseByProduct(t.clProductId,e,r).then(o).catch(u)}function o(t,e){_("course",t._id,null,e).then(function(e){t.accessRight=e,t.hasAccess=e.owned||e.subscribed||e.comped,t.canDownload=e.owned&&!e.streamOnly||g.user.hasRole("owns_all_courses"),t.currentLesson=void 0,t.breadcrumbs=void 0,p(t)}).catch(function(){p(t)})}function p(e){s[c]=e,t.clDebug,0===v.path().indexOf("/class/")&&h(),s.showChatButton=m(),s[c].ready=!0,"true"!==t.watch&&angular.forEach(n,function(e){e()})}function h(){var e=s[c],t=(s[c].breadcrumbs=(r=[],(t=e)&&t.primary_category&&(n={title:"all "+t.primary_category.slug+" classes",link:"/catalog/"+t.primary_category.slug},r.push(n)),t&&t.taxonomy&&t.taxonomy[0]&&(n={title:t.taxonomy[0].name,link:"/catalog/"+t.taxonomy[0].path},r.push(n)),r),s[c].display_title=e.short_title,null),n=v.path(),r=e.slug,i="/class/"+r+"/lessons/",o={title:e.short_title},a=void 0;-1<n.indexOf(i)&&((i=n.split(i)[1])&&(t=i)),t&&(i=S.chain(e.sessions).map(function(e){return e.segments}).flatten().value(),e=S.findWhere(i,{slug:t}),t=S.pluck(i,"slug").indexOf(t),e&&(s[c].currentLesson=e,s[c].currentLessonPrefix=d+" "+(t+1),s[c].currentLesson.idxAndTitle=d+" "+(t+1)+" of "+i.length+" - "+e.title,o.link="/class/"+r,a={title:e.title})),s[c].breadcrumbs.push(o),a&&s[c].breadcrumbs.push(a)}function a(e,t){s[c]._id&&o(s[c],t)}function u(e){s[c]={clCourseProviderError:!0,error:e}}function m(){return!0===(void 0!==t.clShowChatButton&&JSON.parse(t.clShowChatButton))}}}}r.$inject=["$rootScope","$location","$filter","CatalogService","ContentAccessService","trackFactory","_"],t.exports=r},{}],520:[function(e,t,n){"use strict";e("../../common/app").directive("clCourseProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":519}],521:[function(e,t,n){"use strict";function r(e,r,i,o){return{restrict:"AE",templateUrl:function(e,t){return"/templates/covered-topics/covered-topic-summary.html"},scope:{topic:"<?",primaryCategory:"<?",courseNid:"@?"},replace:!0,link:function(t,e,n){t.topic||t.primaryCategory,r.getCoursesByTopics([t.topic._id],{sort:"popularity"}).then(function(e){e&&(t.relavantCourses=o.filter(e,function(e){return"course"===e.content_type}),t.numOfMoreClassesString=i("i18n")("cl-covered-topics-plus-more-classes","+{{ classCount - 3 }} more",{classCount:t.relavantCourses.length}))}),t.seeAllTopicPath=t.courseNid?i("addQueryParams")("/catalog/"+t.topic.path,{via:"navpath_"+t.courseNid}):"/catalog/"+t.topic.path,t.seeAllString=i("i18n")("cl-covered-topics-cta","SEE ALL {{ topic }} CLASSES",{topic:t.topic.name})}}}r.$inject=["ChannelTopicService","CatalogService","$filter","_"],t.exports=r},{}],522:[function(e,t,n){"use strict";function r(r,i){return{restrict:"AE",replace:!0,scope:{courseId:"@?"},templateUrl:"/templates/covered-topics/covered-topics.html",link:function(t,e,n){t.courseId&&(r.getCourseById(t.courseId).then(function(e){t.courseData=e}),t.onClick=function(e){i.open({topic:e,primaryCategory:t.courseData.primary_category,courseNid:t.courseData.nid})})}}}r.$inject=["CatalogService","clCoveredTopicModal"],t.exports=r},{}],523:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clCoveredTopics",e("./directives/index")),r.directive("clCoveredTopicSummary",e("./directives/covered-topic-summary")),r.service("clCoveredTopicModal",e("./services/covered-topic-modal"))},{"../../common/app":70,"./directives/covered-topic-summary":521,"./directives/index":522,"./services/covered-topic-modal":524}],524:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$uibModal=e}o.$inject=["$uibModal"],r(o,[{key:"open",value:function(n){function e(){this.modal=void 0}this.modal=this.$uibModal.open({templateUrl:"/templates/covered-topics/covered-topic-modal.html",windowClass:"cl-modal modal-fill-screen-mobile",controller:["$scope","$uibModalInstance",function(e,t){n&&(angular.extend(e,n),e.dismiss=function(){t.dismiss()})}]}),this.modal.result.then(e.bind(this),e.bind(this))}}]),t.exports=o},{}],525:[function(e,t,n){"use strict";t.exports=["$rootScope","CatalogService","$location","$filter","mediaResource","trackFactory",function(i,o,a,s,c,u){return{restrict:"AE",scope:{product:"=",dismiss:"=?"},templateUrl:function(e,t){return t.template?"/templates/cross-sell-tile/cross-sell-"+t.template+".html":"/templates/cross-sell-tile/cross-sell-large.html"},replace:!0,link:function(r,e,t){var n;r.product&&(n=r.$watch("product",function(e){e&&(r.reInit=!0,n())}),angular.extend(r,{onVideoPlayerReady:function(){var t=r.$watch("playUrl",function(e){e&&(r.$broadcast("video:queue",{playUrl:e,posterUrl:r.product.image}),t())})},productId:r.product._id,productLink:s("linkToSource")(r.product,!1),seeMore:function(){a.path(r.productLink)},showSummary:function(e,t){i.$emit("summary:show",{product:e,dismiss:!0}),u.courseSummaryModal(e,t.target,"modal shown")}}),r.product.image=s("magick")(r.product.image,{width:768}),r.getCrossSellDiscountPercent=function(e){return e&&e.price&&e.full_price?100-Math.round(e.price/e.full_price*100):0},r.getCrossSellDiscountAmount=function(e){return e&&e.price&&e.full_price?Math.round((e.full_price-e.price)/100):0},o.getCourseById(r.product.courseId,{fetch:!0,bff:!1,keys:["promo"]}).then(function(e){return angular.extend(r.product,e)}).catch(console.error).then(function(e){r.course=e,"small"!==t.template&&r.course.promo&&r.course.promo[0]&&r.course.promo[0].media&&r.course.promo[0].media.title&&c.tokenById({id:r.course.promo[0].media._id},function(e){e&&e.data&&(r.course.hasPromoVideo=!0,r.playUrl=e.data.playUrl)})}),i.$on("video:event",function(e,t,n){n.playUrl&&n.playUrl===r.playUrl&&u.onDemandVideoView(r.course)}))}}}]},{}],526:[function(e,t,n){"use strict";e("../../common/app").directive("crossSellTile",e("./directives/cross-sell"))},{"../../common/app":70,"./directives/cross-sell":525}],527:[function(e,t,n){"use strict";var q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(P,M,O,U,R,F,z,V,j,D,N,L,$,H,B){return{restrict:"AE",scope:{productId:"@",product:"=?",via:"=?",loginVia:"@?",type:"@?",noReload:"@?",smoothUpdate:"@?",transcludeWhenFree:"@?",forceTransclude:"@?",freeBuyRedirectPath:"@?",mediaDuration:"@?",overrideInCart:"@?"},templateUrl:function(e,t){return t.clTemplateUrl||"/templates/cta/buy.html"},replace:!0,transclude:!0,link:function(s,c,u,e,r){var i=void 0,o=void 0,l=this,d="/checkout",m="/redeem";function a(e){e&&("object"===(void 0===e?"undefined":q(e))&&i(),s.productId=s.productId||s.product&&s.product.product&&s.product.product._id||s.product&&s.product._id,R.findById(s.productId).then(function(e){return e?(s.product=e,null):M.reject("no product")}).then(b).then(E).then(t))}function g(){return s.product}function v(e){l.cart=e,s.cart=e,t()}function y(){return-1!==N.pluck(l.cart.lineItems,"type").indexOf("subscriptionPlan")}function f(){return s.product&&s.product.source&&s.product.source.source_type||s.sourceType}function b(){var t=M.defer(),e=P.user&&P.user.get("_id");return z[e?"userPrice":"price"]({productId:s.product._id,userId:P.user&&P.user.get("_id")},function(e){s.price=e.data,t.resolve()},t.reject),t.promise}function t(){var e=_(),t=p(),n=w(),r=S();switch(s.purchasable=e,u.class||c.attr("class","btn btn-primary product-buy-button"),!0){case n:c.addClass("hide"),s.forceTransclude||c.removeClass("btn-primary"),s.showTransclude=!!s.forceTransclude,s.buttonText=D("i18n")("cta-buy-item-owned","Owned"),h();break;case t:c.removeClass("hide"),s.forceTransclude||c.addClass("btn-primary"),s.showTransclude=!!s.forceTransclude,s.buttonText=D("i18n")("item-in-cart","In Cart"),h();break;case e&&r:c.addClass("cta-buy-free-class"),s.transcludeWhenFree||(s.showTransclude=!!s.forceTransclude,s.mediaDuration&&"0"!==s.mediaDuration?s.buttonText=D("i18n")("cl-cta-buy-free","Watch Free Now"):s.buttonText=D("i18n")("cl-cta-buy-free-no-media","Redeem Free Class"));break;case e:var i=s.clone&&s.clone.length;c.removeClass("hide"),s.forceTransclude||c.addClass("btn-primary"),s.showTransclude=!0,s.buttonText=i?"":"Buy",h();break;default:c.addClass("hide"),s.forceTransclude||c.removeClass("btn-primary"),s.showTransclude=!!s.forceTransclude,s.buttonText="",h()}}function _(){var t,e=g();if("subscriptionPlan"===f())return t=!0,l.subscriptions&&l.subscriptions.forEach(function(e){e&&(e.product&&e.product._id)===s.productId&&e.trial&&e.trial.active&&(t=!1)}),t;try{return R.isSourcePurchasable(e.source)}catch(e){return!0}}function p(){if(s.overrideInCart)return!1;var e=l.cart;return!(!e||!e.cart)&&(!!s.productId&&!!N.contains(e.cart.items,s.productId))}function w(){var e=g(),t=f();if(!P.user.valid())return!1;switch(t){case"course":case"bundle":var n=L(e||{},"source._id")||L(e||{},"source.source_id._id");return P.user.hasContent("purchased",t,n);default:return!1}}function S(){var e=s.price,t=f();return("course"===t||"bundle"===t)&&e&&0===e.current_price}function E(){if("subscriptionPlan"!==f())return M.resolve();V.getSubscriptionsByUser({unverified:!0}).then(function(e){l.subscriptions=e}).catch(function(e){if(l.subscriptions=[],e)return M.reject(e)})}function A(){return"crossSell"===s.type}function k(e){var t=f(),n=p(),r=u.link;if(l.modalId="modal"===s.via?"course summary modal":"",l.elementText=c.text().trim(),l.ctaType=u.ctaType||"button",l.source=L(s,"product.source"),l.type=A()?"cross":"anchor",!r||n)switch(e&&(e.preventDefault(),e.stopPropagation()),!0){case!P.user.valid():var i=t,o=S(),a="subscriptionPlan"===i?"buy_pass":"buy";i={onboarding:!1,state:"intro",activationMode:"buy",configKey:"buy",via:s.loginVia||"buy",regPrompt:o?"get-free-class":a},s.regModalTriggered=!0,s.mediaDuration&&"0"!==s.mediaDuration||(B.Session.set("redeem_next",o?m:d+"?products="+s.productId,{expires:"+5 minutes"}),B.Session.set("next",d+"?products="+s.productId,{expires:"+5 minutes"})),P.$emit("register:show",i);break;case p():O.location.href=d;break;case A():C(),j.add(s.productId).then(function(){$.addToCart(s.product,l.type,l.elementText,l.ctaType,l.source,l.modalId),s.$emit("dropdownCart:open"),window.scrollTo(0,0)},function(e){I()});break;case S():C(),s.buttonText="",F.processFreeOrder({productId:s.product._id}).$promise.then(function(){$.freeClassOptInComplete(s.product,c.text().trim(),s.buyType,function(){P.user.addContent(s.product),P.$broadcast("order:free:complete",!0),(new H).updateScores(),h(),s.freeBuyRedirectPath&&(O.location.href=s.freeBuyRedirectPath)})});break;case"course"===t:case"bundle"===t:case"subscriptionPlan"===t:T()}else $.trackClick(u.ctaLabel||l.elementText,"CTA buy Link",l.ctaType)}function T(){j.get(!0).then(function(e){l.cart=e,s.cart=e;e=l.cart.lineItems;if("subscriptionPlan"===f()&&0!==e.length){var t=void 0;y()&&(t=l.cart&&l.cart.coupons&&l.cart.coupons[0]&&l.cart.coupons[0].code),j.clear(l.cart.cart._id,s.smoothUpdate).then(n).then(function(){t&&j.addCoupon(t,l.cart.cart._id)})}else{if(y())return U.open({templateUrl:"/templates/cta/mixed-cart-modal.html",controllerAs:"ctrl",bindToController:!0,controller:function(){var e=L(s,"product.source.flags"),e=!!N.find(e,function(e){return"consumer_subscription"===e});angular.extend(this,{buyItem:function(){j.clear(s.cart.cart._id).then(function(){n()})},consumerSubscription:e})}}).result.catch(function(){});n()}}).catch(function(){n()})}function n(){return C(),j.add(s.productId).then(function(){$.addToCart(s.product,l.type,l.elementText,l.ctaType,l.source,l.modalId),s.noReload||(O.location.href=d)},function(){I()})}function C(){s.showSpinner=!0,s.showTransclude=!1,s.buttonText=""}function h(){s.showSpinner=!1}function I(){h(),s.buttonText="We are experiencing technical difficulties. Please try again later."}function x(){b().then(E).then(t).then(function(){var e=_(),t=p(),n=w();s.regModalTriggered&&e&&!t&&!n&&(s.regModalTriggered=!1,k())})}angular.extend(s,{showTransclude:!0,toggle:k}),i=s.$watch("product",a),s.$watch("productId",a),P.$on("cart:updated",function(e,t){v(t)}),o=P.$watch("user.cart",function(e){e&&(v(e),o())}),r(function(e){s.clone=e}),N.each(["user:register","user:login"],function(e){P.$on(e,x)}),P.$on("reg-login:cancelled",function(){s.regModalTriggered=!1})}}}r.$inject=["$rootScope","$q","$window","$uibModal","ProductService","Ecommerce","ecommerceResource","SubscriptionService","CartService","$filter","_","deepval","trackFactory","ScoresService","Vault"],t.exports=r},{}],528:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","parseTransclusions",function(c,u,l){return{restrict:"AE",scope:{entity:"@",entityId:"@",entityIds:"=?",entitySlug:"@",entityName:"@",ctaLabel:"@"},replace:!0,transclude:!0,template:'<small ng-cloak ng-show="following && ready" ng-transclude class="follow-status"></small>',link:function(t,n,e,r,i){var o=c.user;angular.extend(t,{following:!1}),t.$on("user:updateContent",s),t.$on("user:login",s),t.$on("user:register",s),(t.entityId||t.entitySlug||t.entityName)&&u(s,0);var a=t.$watch("entityIds",function(e){e&&(u(s,0),a())});function s(){e={},t.entityId?e.entityId=t.entityId:angular.isArray(t.entityIds)?e.entityIds=t.entityIds:t.entitySlug?e.entitySlug=t.entitySlug:t.entityName&&(e.entityName=t.entityName);var e;o&&angular.isFunction(o.valid)&&(o.isFollowing(t.entity,e).then(function(e){t.following=e}),t.ready=!0)}t.$watchCollection(function(){return c.user&&angular.isFunction(c.user.valid)&&c.user.valid()&&c.user._data&&c.user._data.user.follows&&c.user._data.user.follows[t.entity]},s),i(t,function(e){e=l(e);n.html(e.nodes.FOLLOWING||'<span class="text-uppercase">Following<span>')})}}}]},{}],529:[function(e,t,n){"use strict";var h=e("underscore");t.exports=["$rootScope","$timeout","$compile","trackFactory","ScoresService",function(d,e,t,f,p){return{restrict:"AE",scope:{entity:"@",entityId:"@",entityIds:"=?",entitySlug:"@",entityName:"@",ctaLabel:"@"},replace:!0,transclude:{follow:"?follow",following:"?following"},templateUrl:"/templates/cta/follow.html",link:function(i,n,o,e,t){var a={cta_label:i.ctaLabel||n.find("button").text()||"Follow",follow_type:i.entity||void 0,follow_name:i.entityName||i.entitySlug||void 0},s=d.user,c=(angular.extend(i,{toggleFollow:function(e){var n,r,t;e.target.classList.contains("dropdown-toggle")||i.following&&!i.canUnfollow||(e.preventDefault(),i.pending||(i.pending=!0,r=u(),t="learning_path"===i.entity?"bundle":i.entity,s.isFollowing(t,r).then(function(e){return("unfollow"!=(n=e?"unfollow":"follow")||i.canUnfollow)&&("follow"!=n||i.canFollow)?("follow"==n&&"event"===t&&d.user.followEventSource(r.entityId||r.entityIds,n),void s[n](t,r).then(function(e){try{var t=h.keys(r)[0]}catch(e){}c=!0,f.follow(n,a,r[t],o.moduleLocation,"button"),l(),(new p).updateScores()}).finally(function(){i.pending=!1})):i.pending=!1})))},ready:!1,following:!1,pending:!1,getParams:u,canFollow:"false"!==o.canFollow,canUnfollow:"false"!==o.canUnfollow}),l(),i.$on("user:updateContent",l),i.$on("user:follow",l),i.$on("user:unfollow",l),i.$on("user:login",l),i.$on("user:register",l),i.$watch("entityIds",l),!1);function u(){var e={};return i.entityId?e.entityId=i.entityId:angular.isArray(i.entityIds)?e.entityIds=i.entityIds:i.entitySlug?e.entitySlug=i.entitySlug:i.entityName&&(e.entityName=i.entityName),e}function l(){var e="learning_path"===i.entity?"bundle":i.entity,t=u();s&&angular.isFunction(s.valid)&&s.isFollowing(e,t).then(function(e){i.following=e,c&&n.addClass("trigger-animate")},function(){i.following=!1,n.removeClass("trigger-animate")}),i.ready=!0}}}}]},{underscore:void 0}],530:[function(e,t,n){"use strict";function r(o,e){return{restrict:"AE",scope:{productId:"@",onToggle:"=?",via:"@?"},templateUrl:function(e,t){return t.clTemplateUrl||"/templates/cta/get-access.html"},replace:!0,transclude:!0,link:function(n,r,e,t,i){angular.extend(n,{showTransclude:!0,toggle:function(){angular.isFunction(n.onToggle)&&n.onToggle();var e=r.text().trim(),t=n.productId?"Product CTA":"CP CTA";o({productId:n.productId,ctaLabel:e,ctaType:t,via:n.via})}}),i(function(e){n.clone=e}),i=n.clone&&n.clone.length,r.removeClass("hide"),r.addClass("btn-primary"),n.showTransclude=!0,n.buttonText=i?"":"Get Access"}}}r.$inject=["priceAnchoringModal","trackFactory"],t.exports=r},{}],531:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter","trackFactory","productResource",function(a,s,c,u){return{restrict:"AE",scope:{product:"=?",productId:"@?",price:"=?"},templateUrl:function(e,t){return t.clCtaGiftTemplate||"/templates/cta/gift.html"},replace:!0,transclude:!0,link:function(t,e,n){var r=t.$watch("product",i);function i(e){e&&((e=e)&&e.source&&e.source.flags?(o(),r()):(t.productId=t.productId||e._id,u.findById({id:t.productId},function(e){t.product=e.data,o()})))}function o(){t.purchasable=-1===t.product.source.flags.indexOf("!for_sale"),t.isFreeCourse=0===t.product.full_price,t.price&&0===t.price.current_price&&(t.isFreeCourse=!0)}t.$watch("productId",i),t.startGifting=function(){var e={product:t.product};n.title&&(e.title=n.title),a.$emit("user:gift",e),c.addToCart(t.product,"gift",s("i18n")("gifting-button","gift this class"),n.ctaType)}}}}]},{}],532:[function(e,t,n){"use strict";function r(f,e,t,p,h,m){return{restrict:"AE",scope:{productId:"=?",monthlyId:"@?",yearlyId:"@?",annualMonthlyId:"@?",cart:"=?",type:"=?"},templateUrl:function(e,t){return t.clTemplateUrl||"/templates/cta/price-anchoring.html"},replace:!0,link:function(t,i,e){function n(){t.monthlyId&&o(t.monthlyId),t.yearlyId&&s(t.yearlyId),t.annualMonthlyId&&c(t.annualMonthlyId),t.productId&&u(t.productId)}f.$on("user:login",n),f.$on("user:register",n),t.clickPass=function(e,t,n){var r=i.find(t);n||m(function(){r.triggerHandler("click")})},t.source={},t.ctaType=e.ctaType||"button";var r=t.$watch("monthlyId",o);function o(e){e&&p.getPrice(e).then(function(e){r(),t.monthly=e},function(e){})}var a=t.$watch("yearlyId",s);function s(e){e&&p.getPrice(e).then(function(e){a(),e.monthly_price=e.current_price/12,e.rounded_monthly_price=100*Math.ceil(e.current_price/1200),t.yearly=e},function(e){})}var l=t.$watch("annualMonthlyId",c);function c(e){e&&p.getPrice(e).then(function(e){l(),t.annualMonthly=e},function(e){})}var d=t.$watch("productId",u);function u(e){e&&(p.getSource({_id:e}).then(function(e){t.source=e},function(e){}),p.getPrice(e).then(function(e){t.product=e},function(e){}),d())}t.$watch("cart",function(e){e&&e.items&&e.lineItems&&(t.selected=e.items[0],t.lineItem=e.lineItems[0])}),h.getBySlug("price-anchoring-modal").then(function(e){e&&e.module&&e.module.data&&(t.globalModule=e.module.data.content)})}}}r.$inject=["$rootScope","SubscriptionPlanService","$q","ProductService","GlobalModuleService","$timeout"],t.exports=r},{}],533:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{redeemCode:"@?",subscriptionSlug:"@",buttonLabel:"@?",redirectPath:"@?"},templateUrl:"/templates/cta/redeem-subscription.html",replace:!0,transclude:!0,link:function(e,t,n){}}}},{}],534:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","parseTransclusions","ScoresService",function(f,p,h,m){return{restrict:"AE",scope:{product:"=",productAction:"@",ctaLabel:"@",ctaType:"@",productId:"@",productType:"@"},template:'<span data-cta="rsvp" ng-cloak ng-show="ready && productId && enrollable" ng-click="toggleRsvp($event)" ng-transclude></span>',replace:!0,transclude:!0,link:function(n,r,e,l,t){var i,o,a="true"===e.canUnRsvp,d=(n.toggleRsvp=function(e){e.preventDefault();e=c()?"unenroll":"enroll";if("unenroll"==e&&!a)return!1;s();var t=n.ctaLabel||r.text().trim();f.user.updateContent(e,n.productType,n.productId,n.product,t,n.ctaType),(new m).updateScores()},n.$on("user:updateContent",u),n.$on("user:login",u),n.$on("user:register",u),p(u,100),n.$watch("product",function(){n.product&&(s(),u(),d())}));function s(){n.productId=n.productId||n.product&&n.product._id,n.productType=n.productType||n.product&&n.product.type;try{n.enrollable=-1===n.product.flags.indexOf("!allow_enrollment")}catch(e){n.enrollable=!0}}function c(){return f.user.hasContent&&(s(),f.user.hasContent("enrolled",n.productType,n.productId))}function u(){c()?r.html(o):r.html(i),n.ready=!0}t(n,function(e){e=h(e);i=e.nodes.RSVP||e.raw||'<span class="btn btn-dark rsvp-button">RSVP</span>',o=e.nodes.ENROLLED||'<span class="text-muted">You are enrolled.</span>'})}}}]},{}],535:[function(e,t,n){"use strict";t.exports=["rind","$filter","_",function(o,a,t){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"/templates/cta/share.html",scope:{product:"<",currentLesson:"<",url:"<"},link:function(r){var i=r.$watch("product",function(e){var t,n;e&&(e=r.product.social||{},n={title:t=r.product.short_title,url:r.url},e=e.retweet_text||a("i18n")("cl-cta-share-product-retweet-text","Check out this amazing class from CreativeLive",n),r.url=r.url||encodeURIComponent(o.context.url),r.img=a("magick")(r.product.image.file,{raw:!0}),r.emailSubject=a("i18n")("cl-cta-share-product-email-subject","Check out {{ title }}",n),r.emailBody=a("i18n")("cl-cta-share-product-email-body","Thought you might be interested in {{ title }} on CreativeLive. You can take a look here: {{ url }}",n),r.pinterest=e,r.twitter=e,r.facebook=t,i())});r.$watch("currentLesson",function(e){e&&t.keys(e).length&&"promo"!==e.type&&(r.url=r.url+"?autoplay=true"||encodeURIComponent(o.context.url),e={courseTitle:r.product.short_title,lessonTitle:e.title,url:r.url},r.emailSubject=a("i18n")("cl-cta-share-current-lesson-email-subject","Just for you - an essential lesson from {{ courseTitle }}",e),r.emailBody=a("i18n")("cl-cta-share-current-lesson-email-body","We thought you'd like {{ lessonTitle }}, an essential lesson from {{ courseTitle }}. Take a look here: {{ url }}",e),r.pinterest=a("i18n")("cl-cta-share-current-lesson-pinterest","Don't miss out on an essential lesson from CreativeLive.",e),r.twitter=a("i18n")("cl-cta-share-current-lesson-twitter","Discover a world-class lesson from CreativeLive.",e),r.facebook=a("i18n")("cl-cta-share-current-lesson-facebook","Just for you - an essential lesson from {{ courseTitle }}",e))}),r.app_id=o.config.facebook.app_id}}}]},{}],536:[function(e,t,n){"use strict";t.exports=["$rootScope","ScoresService",function(s,e){var c=new e;return{restrict:"AE",scope:{product:"=",ctaType:"@",productId:"@",productType:"@",hideLabel:"=",onLabel:"@",offLabel:"@"},templateUrl:function(e,t){return t.templateUrl||"/templates/cta/star.html"},replace:!0,transclude:!0,link:function(n,r,e,t,i){var o;function a(){if(s&&s.user&&"function"==typeof s.user.hasContent)return n.starred=s.user.hasContent("starred",n.productType,n.productId),n.starred}n.toggleStar=function(e){e.preventDefault(),e.stopPropagation();var e="star",t="follow";n.starred&&(e="unstar",t="unfollow");s.user.updateContent(e,n.productType,n.productId,n.product,r.text().trim(),n.ctaType||"button"),s.user[t](n.productType||"course",{entityId:n.productId}),c.updateScores()},n.$on("user:updateContent",a),n.$watch("starred",function(){n.onLabel&&n.offLabel?n.starred?n.buttonLabel=n.onLabel:n.buttonLabel=n.offLabel:n.buttonLabel=i()[0]&&i()[0].textContent}),n.product?o=n.$watch("product",function(e){e&&(n.productId=e._id,n.productType=e.type,a(),o())}):a()}}}]},{}],537:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("priceAnchoringModal",e("./services/price-anchoring-modal")),r.directive("ctaBuy",e("./directives/buy")),r.directive("ctaRsvp",e("./directives/rsvp")),r.directive("ctaStar",e("./directives/star")),r.directive("ctaShare",e("./directives/share")),r.directive("ctaFollow",e("./directives/follow")),r.directive("ctaFollowStatus",e("./directives/follow-status")),r.directive("ctaGift",e("./directives/gift")),r.directive("ctaPriceAnchoring",e("./directives/price-anchoring")),r.directive("ctaGetAccess",e("./directives/get-access")),r.directive("ctaRedeemSub",e("./directives/redeem-subscription"))},{"../../common/app":70,"./directives/buy":527,"./directives/follow":529,"./directives/follow-status":528,"./directives/get-access":530,"./directives/gift":531,"./directives/price-anchoring":532,"./directives/redeem-subscription":533,"./directives/rsvp":534,"./directives/share":535,"./directives/star":536,"./services/price-anchoring-modal":538}],538:[function(e,t,n){"use strict";function r(r,i,o,a,e,t,s,c){var u;return function(n){r.lock("authModal"),i.disable();var t={templateUrl:(n=n||{}).template||"/templates/cta/price-anchoring-modal.html",windowClass:"cl-modal modal-price-anchoring",backdrop:!0,controller:["$scope","$uibModalInstance",function(e,t){e.$on("modal.closing",function(){o.$emit("auth.modal.closing")}),e.productId=n.productId}]};function e(){c.priceAnchoringModalClosed({cta_label:n.ctaLabel,cta_type:n.ctaType}),r.unlock("authModal"),i.enable(),u=void 0}s.each(["backdrop","keyboard"],function(e){e in n&&(t[e]=n[e])}),u=a.open(t),c.priceAnchoringModalShown({cta_label:n.ctaLabel,cta_type:n.ctaType,via:n.via}),u.result.then(e,e)}}r.$inject=["LockBody","keyboard","$rootScope","$uibModal","$timeout","rind","_","trackFactory"],t.exports=r},{}],539:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/ecom/billingForm.html"}}]},{}],540:[function(e,t,n){"use strict";var f=e("underscore");t.exports=["$rootScope","trackFactory","ContentAccessService",function(e,d,i){return{restrict:"AE",templateUrl:"/templates/ecom/cart.html",replace:!0,scope:{data:"=?"},link:function(l,n){function r(e,t,n,r){var i=void 0,o=void 0,a=0,s=void 0,c=void 0,u=[],e=(l.lineItems&&l.lineItems.length&&(s=l.lineItems.length,c=f.pluck(l.lineItems,"_id"),i=l.lineItems.filter(function(e){return!f.contains(e.cross_sells,e._id)}).length,o=l.lineItems.filter(function(e){return e.isCrossSellItem}).length,l.lineItems.forEach(function(e){e.cross_sells&&e.cross_sells.length&&(a+=e.cross_sells.length)})),f.each(l.lineItems,function(e){var t={};t.product_id=e._id,e.source&&e.source.source_type&&(t.category=e.source.source_type),t.name=e.short_title,t.price=e.pricing.price,t.url=e.productLink,u.push(t)}),{action:e,cta_type:t,count_anchor:i,count_cross:o,count_offer:a,num_items:s,product_ids:c,products:u});n&&(e.cta_label=n),r&&(e.offer_type="cross",e.product_id=r),d.cart(e)}angular.extend(l,{cartDropdownOpen:!1,anchorClassesCount:0,crossSellCount:0,crossSells:[]}),l.$watch("cartDropdownOpen",function(e){e&&r("dropdown","button")}),e.$on("dropdownCart:open",function(){l.cartDropdownOpen=!0}),e.$watch("user.populatedCart",function(){e.user.cart&&(e.user.cart.lineItems&&e.user.cart.lineItems.length?(l.lineItems=e.user.cart.lineItems,l.numLineItems=l.lineItems.length,l.crossSells=[],l.lineItems.forEach(function(e){e.cross_sells.forEach(function(t){i("course",t.courseId).then(function(e){e.owned||e.subscribed||l.crossSells.push(t)})})})):l.numLineItems=0)}),l.toggleCart=function(){l.cartDropdownOpen=!l.cartDropdownOpen},l.closeDropdownCart=function(){l.cartDropdownOpen=!1},$(document.body).mousedown(function(e){var e=!$.contains(n[0],e.target),t=!!$(".modal-cl-auth")[0];e&&!t&&(l.cartDropdownOpen=!1)}),l.removeCrossSellFromCart=function(t){l.crossSells=f.filter(l.crossSells,function(e){return e._id!==t}),r("dismiss","button","dismiss",t)}}}}]},{underscore:void 0}],541:[function(e,t,n){"use strict";t.exports=["PaymentCards",function(d){return{restrict:"E",templateUrl:"/templates/ecom/ccFormatDetect.html",link:function(e,t,n){var r,c=d,t=angular.element(t.find("input")[0]),o=19;function i(e){return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(e=String.fromCharCode(e.which),!!/[\d\s]/.test(e))))}function a(e){var t,n,r=$(e.currentTarget),e=String.fromCharCode(e.which);if(/^\d+$/.test(e)&&!(null!=(t=r).prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")||null!=("undefined"!=typeof document&&null!==document&&null!=(n=document.selection)?n.createRange:void 0)&&document.selection.createRange().text))return(n=u(t=(r.val()+e).replace(/\D/g,"")))?t.length<=n.length[n.length.length-1]:t.length<=o}function l(e){var t,n,r,i=String.fromCharCode(e.which);/^\d+$/.test(i)&&(t=$(e.currentTarget),e=u((r=t.val())+i),n=(r.replace(/\D/g,"")+i).length,(e?e.length[e.length.length-1]:o)<n||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==r.length||((n=e&&"amex"===e.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(r)?setTimeout(function(){t.val(r+" "+i)},50):n.test(r+i)&&setTimeout(function(){t.val(r+i+" ")},50)))}function s(e){var o=$(e.currentTarget);return setTimeout(function(){var e,t,n,r=o.val(),r=function(e){var t,n;if(e=e.replace(/\D/g,""),!(t=u(e)))return e;{if(n=t.length[t.length.length-1],e=e.slice(0,n),t.format.global)return null!=(n=e.match(t.format))?n.join(" "):void 0;if(null!=(n=t.format.exec(e)))return n.shift(),(n=$.grep(n,function(e){return e})).join(" ")}}(function(e){for(var t,n,r,i,o=0,a=(t=(e=null==e?"":e).split(i="")).length;o<a;o++)n=t[o],i+=n=-1<(r="".indexOf(n))?"0123456789"[r]:n;return i}(r)),i=o;try{t=i.prop("selectionStart")}catch(e){t=null}if(n=i.val(),i.val(r),null!==t&&i.is(":focus"))return t===n.length&&(t=r.length),n!==r&&(n=n.slice(t-1,+t+1||9e9),e=r.slice(t-1,+t+1||9e9),r=r[t],/\d/.test(r)&&n===r+" "&&e===" "+r&&(t+=1)),i.prop("selectionStart",t),i.prop("selectionEnd",t)})}function u(e){var t,n,r,i,o,a,s;for(e=(e+"").replace(/\D/g,""),r=0,o=c.length;r<o;r++)for(i=0,a=(s=(t=c[r]).patterns).length;i<a;i++)if(n=s[i],e.substr(0,(n=n+"").length)===n)return t}e.cardType=!1,e.$watch("paymentInfo.creditCard",function(){e.paymentInfo&&(r=u(e.paymentInfo.creditCard),e.cardType=!!r&&r.type)}),e.tabIndex=n.tabIndex||0,e.required=n.required||!1,t.on("keypress",i),t.on("keypress",a),t.on("keypress",l),t.on("paste",s),t.on("change",s),t.on("input",s)}}}]},{}],542:[function(e,t,n){"use strict";r.$inject=["$rootScope","$timeout","$location","$filter","$q","deepval","trackFactory","Countries","States","Provinces","Years","Cart","Ecommerce","VAT","BillingInfo","PaymentInfo","CartService","ContentAccessService","GiftService","cacheClear","ScoresService","_","config","PipelineService","SubscriptionService","moment","UserSubscriptionService","CaptchaService"];var we=e("async");function r(G,K,ie,oe,J,Q,X,ae,se,ce,ue,le,Z,de,fe,pe,ee,he,me,ge,ve,te,e,ne,ye,re,be,_e){return{restrict:"AE",templateUrl:function(e,t){return t.template?"/templates/ecom/"+t.template+".html":"/templates/ecom/checkout.html"},replace:!0,scope:{userCart:"=cart",type:"@"},link:function(p,e){var l=!1,d=!1,f=!1,h=!1,m=(te.extend(p,{error:{},cart:{},items:[],checkoutForm:{},coupon:{},couponCodeError:"",removingCard:!1,freeOrder:!1,enableLineItemRemove:"gift"!==p.type,currency:"USD",currencySymbol:"$",billingAddress:{},paymentInfo:{},paypal:{},countries:ae,states:se,provinces:ce,years:ue,checkout:!1,vatExemptCodeValid:!1,setSelectedPaymentMethod:s,isCardPayment:j,isNewCardPayment:D,isPurchaseDisabled:function(){return!(!p.oneOnOneCoachingBundleInCart||p.tocAccepted)},removeCard:function(t){p.removingCard||(p.removingCard=t,Z.removeCard({ccToken:t},function(e){p.removingCard=!1,e.success?(p.customer.creditCards&&(p.customer.creditCards=te.reject(p.customer.creditCards,function(e){return e.token===t}),p.customer.creditCards.length||s("CreditCard")),p.customer.paypalAccounts&&(p.customer.paypalAccounts=te.reject(p.customer.paypalAccounts,function(e){return e.token===t}))):u(E)}))},removePayPal:L,applyCoupon:$,applyVatExemptCode:function(){p.vatError="",p.vatExemptCodeValid=!1,B(),p.vat&&p.vat.countryCode&&2===p.vat.countryCode.length&&8<=p.vat.number.length?de.verify(p.vat.countryCode,p.vat.number,function(e){e.valid?(p.vatExemptCodeValid=!0,e.vat_number&&(p.billingAddress.vat=p.vat.countryCode+e.vat_number)):(p.vatError=t,p.vatExemptCodeValid=!1),a()}):(p.vatError=t,p.vatExemptCodeValid=!1,a())},removeCoupon:function(e){ee.removeCoupon(e,p.cart._id).then(function(e){},function(e){e.message&&u(e.message)})},removeVatExemptCode:function(){p.vatExemptCodeValid=!1,p.billingAddress.vat=void 0,a()},onSubmit:function(){if(p.checkoutForm.$submitted=true,p.showSpinner=true,c(),p.paymentInfo)return p.freeOrder?U():(p.billingAddress||(p.billingAddress={}),p.paymentInfo.selectedPaymentMethod?p.billingAddress.firstName&&p.billingAddress.lastName&&p.billingAddress.country&&p.billingAddress.country.code&&p.billingAddress.streetAddress&&p.billingAddress.city&&p.billingAddress.zipCode&&(!N()||p.billingAddress.selectedState&&p.billingAddress.selectedState.code)?p.billingAddress.country.vat&&p.billingAddress.vat?(B(),p.vat&&p.vat.countryCode?de.verify(p.vat.countryCode,p.vat.number,function(e){return e.valid?U():u(t)}):u(t)):U():u(k):u(A))},onFocus:function(){d||(X.checkout("start","billing",p.analyticsProps),d=!0)},couponStart:function(){X.checkout("start","coupon",p.analyticsProps)},couponKeypressHandler:function(e){13===e.keyCode&&p.coupon.code&&$()},onTabSelected:function(e){var t=p.paymentInfo&&p.paymentInfo.selectedPaymentMethod&&p.paymentInfo.selectedPaymentMethod.type;t&&t!==e&&X.tabSection(null,e);s(e)},orderProcessing:!1,crossSells:[],basePriceOnly:!1,subscriptionNewExpiration:!1,subscriptionChangeFrequency:!1,subscriptionTrialActive:!1,subscriptionExistingLabelFrequency:null}),"Coupon code invalid"),t="Invalid exemption code",g="Please provide your PayPal Account",v="We had trouble processing your order. Check your payment info and try again.",y="We had trouble validating your payment information. Please try again later.",b="Address Missing State or Territory",_="We had trouble processing your order. Check your information and try again.",w="We had trouble processing your order. Please check your PayPal account and try again.",S="Oops, we're missing your card info",E="There was an error removing your card, please try again",A="Please select a payment method",k="You forgot something, please complete all fields to complete purchase.",i="payPalNonce",T=!1,n=!1,r=ie.search(),C=(p.$watchCollection("paymentInfo",o),p.$watchCollection("billingAddress",o),p.$watch("billingAddress.country",function(e,t){t&&t.code&&(delete p.billingAddress.selectedState,delete p.billingAddress.inputState);p.showVat=p.billingAddress&&p.billingAddress.country&&p.billingAddress.country.vat,p.isVATCountry=!1,p.showVat&&(p.isVATCountry=de.isVATCountry(p.billingAddress.country.code));p.billingAddress.vat="",p.vatExemptCodeValid=!1,p.vatError="",a()}),p.$watch("billingAddress.selectedState",function(){a(),o()}),p.$watch("billingAddress.zipCode",function(){var e=p.billingAddress.selectedState;e&&0<=rind.config.ecom.taxedStates.indexOf(e.code)&&5<=p.billingAddress.zipCode.length&&a()}),p.$watchCollection("paymentInfo.selectedPaymentMethod",O),p.$watch("total",function(e){p.freeOrder=0===e,p.freeOrder&&!p.hasRenewingItem&&(p.checkoutForm.$invalid=!1,c())}),G.$on("cart:needs-init",function(){ee.get(!0),C()}));function I(e){if(T||e){if(e?(C(),x(e)):p.cart={items:[]},G.ready||n)return;n=!0,function(){if(!(r.products||r.token||r.couponCode))return J.resolve();var e=r.products?r.products.split(","):[],t=r.couponCode?[r.couponCode]:[],n=r.token;return J.resolve().then(function(){if(!("true"===r.add)&&(r.products||r.token)&&p.cart&&p.cart.lineItems&&p.cart.lineItems.length)return ee.clear()}).then(function(){return ee.add(e,{coupons:t,token:n})}).then(function(e){x(e)})}().then(function(){M()||G.user.getApplicableCoupons().then(function(e){we.eachSeries(e,function(e,t){M()||(p.coupon.code=e,$(function(){K(function(){t()},10)}))})})}).then(function(){n=!1,G.ready=!0}).catch(function(){n=!1,G.ready=!0})}T=!0}function x(e){var t,n;le.set(e.cart,e.lineItems),p.cart=le.get(),p.items=e.lineItems,p.coupons=e.coupons,p.uniqueCoupons=oe("unique")(e.coupons,"code"),p.subtotal=e.subtotal,p.total=e.total,p.freeTrial=!1,te.each(e.lineItems,function(e){e.deferred_payment&&0<e.deferred_payment.days&&"gift"!==p.type&&(p.freeTrial=e.deferred_payment.days&&0<p.total&&!G.user.getTrait("^subscription-trial-student")?e.deferred_payment.days:0),p.billingFrequency=e&&e.source&&e.source.billingFrequency,p.labelFrequency="monthly"===p.billingFrequency?"month":"quarterly"===p.billingFrequency?"quarter":"year"}),p.subscriptionInCart=(t=p.items,te.find(t,function(e){return e.source&&e.source.source_type&&"subscriptionPlan"===e.source.source_type})),p.cpInCart=(t=p.items,te.find(t,function(e){return e.source&&e.source.content===rind.config.creatorPass.contentId})),p.hasRenewingItem=(t=p.items,te.find(t,function(e){return e.source&&e.source.source_id&&e.source.source_id.billingFrequency&&!e.source.source_id.nonRenewable&&"gift"!==p.type})),!p.subscriptionInCart||"annual-paid-monthly-creator-pass"!==p.subscriptionInCart.slug||(t=be.getSubcriptionBySlug("annual-paid-monthly-creator-pass"))&&t.active&&0<t.active.length&&ee.clear(),p.oneOnOneCoachingBundleInCart=!1;if(te.contains(p.cart.items,"5b07470093be8e05005999c5")&&(p.oneOnOneCoachingBundleInCart=!0,o()),p.oneOnOneCoachingClassTermsCheckboxChange=function(e){p.tocAccepted=e,o()},p.discountedTotal=te.reduce(te.pluck(p.coupons,"impact"),function(e,t){return e+t},0),e.coupons&&e.coupons[0]&&e.coupons[0].condition&&te.each(e.coupons[0].condition,function(e){e.basePriceOnly&&(p.basePriceOnly=!0)}),0!==p.total||p.hasRenewingItem?R():(p.checkoutForm.$invalid=!1,c()),(t=p.cart)&&(p.subscriptionNewExpiration=!1,te.each(t.lineItems,function(t){t.deferred_payment&&0<t.deferred_payment.days&&(t.free_trial=0!==p.total&&!G.user.getTrait("^subscription-trial-student")),t.source&&t.source.billingFrequency&&!t.source.nonRenewable&&(t.will_renew=0!==p.total),G.user.hasCreatorPassSubscription()?ye.getSubscriptionsByUser({},!0).then(function(e){e=te.find(e,function(e){try{return e.content.toString()===t.source.content.toString()}catch(e){return!1}});e&&(t.changingFrequency=e.subscriptionPlan.billingFrequency!==t.source.billingFrequency,t.changingPlan=e.subscriptionPlan._id!==t.source._id,p.subscriptionExistingLabelFrequency="monthly"===e.subscriptionPlan.billingFrequency?"month":"quarterly"===e.subscriptionPlan.billingFrequency?"quarter":"year",p.subscriptionChangeFrequency=t.changingFrequency,"yearly"===t.source.billingFrequency?t.newExpiration=re.unix(e.expiration).add(1,"years").unix():"monthly"===t.source.billingFrequency?t.newExpiration=re.unix(e.expiration).add(t.source.requiredBillingCycle,p.labelFrequency).unix():"quarterly"===t.source.billingFrequency&&(t.newExpiration=re.unix(e.expiration).add(3,"months").unix()),p.subscriptionNewExpiration=t.newExpiration,p.requiredBillingCycle=t.source.requiredBillingCycle,p.subscriptionExistingRequiredBillingCycle=e.subscriptionPlan.requiredBillingCycle,p.subscriptionRenewalDay=re.unix(e.expiration).format("Do"),p.subscriptionNewBillingDate=re.unix(e.expiration).add(1,p.labelFrequency).unix(),e.trial.active&&(p.subscriptionTrialActive=!0))}):("yearly"===p.billingFrequency?t.expirationDate=re().add(1,"years").unix():"monthly"===p.billingFrequency?t.expirationDate=re().add(t.source.requiredBillingCycle,"months").unix():"quarterly"===p.billingFrequency&&(t.expirationDate=re().add(3,"months").unix()),t.unlimitedDiscounts?(p.subscriptionPrice=t.pricing.price,p.hasLimitedRecurringDiscounts=!1):(p.subscriptionPrice=t.pricing.full_price,p.hasLimitedRecurringDiscounts=!t.oneTimeDiscounts),p.requiredBillingCycle=t.source.requiredBillingCycle,p.subscriptionExpiration=t.expirationDate,p.subscriptionRenewalDay=re().format("Do"))})),a(),p.providerToken&&braintree.setup(p.providerToken,"custom",{onReady:function(e){p.checkout=e},onError:function(e){},onPaymentMethodReceived:function(e){var t,n;c(),document.getElementById(i).setAttribute("value",e.nonce),"PayPal"!==p.paymentInfo.selectedPaymentMethod?s("PayPal"):O(),"PayPalAccount"===e.type&&(p.paypal=e,e=p.paypal.details,(n=p.billingAddress).firstName=e.firstName||n.firstName,n.lastName=e.lastName||n.lastName,e.billingAddress&&((t=e).billingAddress.countryCodeAlpha2&&(p.billingAddress.country=p.countries.filter(function(e){return e.code===t.billingAddress.countryCodeAlpha2})[0]),p.billingAddress.streetAddress="",t.billingAddress.streetAddress&&(p.billingAddress.streetAddress+=t.billingAddress.streetAddress),t.billingAddress.extendedAddress&&(p.billingAddress.streetAddress+=", "+t.billingAddress.extendedAddress),t.billingAddress.locality&&(p.billingAddress.city=t.billingAddress.locality),N()?p.billingAddress.selectedState=p.states.concat(p.provinces).filter(function(e){return e.code===t.billingAddress.region})[0]:t.billingAddress.region&&"undefined"!==t.billingAddress.region&&(p.billingAddress.inputState=t.billingAddress.region),t.billingAddress.postalCode&&(p.billingAddress.zipCode=t.billingAddress.postalCode)))},paypal:{paymentMethodNonceInputField:i,singleUse:!p.subscriptionInCart||"gift"===p.type||!p.hasRenewingItem,headless:!0,amount:parseFloat(oe("centsToDollars")(p.total)),currency:"USD",locale:"en_us"},dataCollector:{paypal:!0}}),"gift"!==p.type&&(p.crossSells=[],p.items.forEach(function(e){e.cross_sells.forEach(function(t){he("course",t.courseId).then(function(e){e.owned||e.subscribed||p.crossSells.push(t)})})})),function(){if(!p.cart||!p.cart._id)return!1;if(!p.recentOrder||"processing"!==p.recentOrder.order_status)return!1;var e=Q(p.recentOrder,"raw.cart._id");return p.cart._id===e}())return V(),p.order=p.recentOrder,p.showSpinner=!0,void q();e=P(p.items,"course"),t=P(p.items,"bundle"),n=P(p.items,"subscriptionPlan"),p.analyticsProps={num_items:p.items.length,course_ids:e,bundle_ids:t,subscriptionPlanIds:n,product_ids:te.pluck(p.items,"_id"),content_ids:te.pluck(p.items,"_id")},e.length||t.length?p.analyticsProps.hasAlaCarte=!0:p.analyticsProps.hasAlaCarte=!1,n.length?p.analyticsProps.hasSubscription=!0:p.analyticsProps.hasSubscription=!1,e={action:"start",checkout_type:"order"},p.customer&&p.customer.creditCards&&p.customer.creditCards.length&&(e.action="auto",e.checkout_type="billing"),t=function(e){var t=[];return te.each(e,function(e){e={id:e._id,product_id:e._id,quantity:1,price:e.pricing.price/100,name:e.short_title,category:e.source.source_type};t.push(e)}),t}(p.items),l||(te.extend(e,p.analyticsProps,{products:t}),X.checkoutOrderStart(e),l=!0),h&&!f&&(X.checkout("complete","billing",p.analyticsProps),f=!0)}function P(e,t){return te.chain(e).pluck("source").filter(function(e){return e.source_type===t}).pluck("_id").value()}function M(){return p.coupons&&p.coupons.length}function O(){R()}function R(){p.paymentInfo.selectedPaymentMethod&&(j()||D()?o():angular.element("#"+i).val()?p.checkoutForm.$invalid=!1:p.checkoutForm.$invalid=!0)}function o(){var e,t;te.find(p.uniqueCoupons,function(e){return te.find(e.condition,function(e){return e.noPaymentInfoOnFree})})?p.checkoutForm.$invalid=!1:(p.checkoutForm.$invalid=!0,e=p.billingAddress,N()?e.selectedState&&(t=e.selectedState.code):t=!0,e.firstName&&e.lastName&&e.country&&e.streetAddress&&e.city&&t&&e.zipCode&&(D()?p.paymentInfo.creditCard&&p.paymentInfo.expirationMonth&&p.paymentInfo.expirationYear&&p.paymentInfo.cvv?(p.checkoutForm.$invalid=!1,p.cart.selectedPaymentMethod="CreditCard"):p.checkoutForm.$invalid=!0:(p.checkoutForm.$invalid=!1,p.cart.selectedPaymentMethod="Existing")),p.oneOnOneCoachingBundleInCart&&!p.tocAccepted&&(p.checkoutForm.$invalid=!0),p.checkoutForm.$invalid||f||(h=!0),e.vat||(p.vatError=""))}function a(){p.billingAddress.country&&!te.isUndefined(p.total)&&(p.vatExemptCodeValid?(p.total=p.subtotal-(p.discountedTotal||0),p.taxobject={total:0,userVAT:p.billingAddress.vat,countryCode:p.billingAddress.country.code}):(p.calculatingTax=!0,Z.getTax({billingInfo:p.billingAddress,amount:p.subtotal-(p.discountedTotal||0)},function(e){e.success&&(p.total=p.subtotal-(p.discountedTotal||0)+e.data.total,p.taxobject=e.data),p.calculatingTax=!1})))}function j(){return!!p.paymentInfo.selectedPaymentMethod&&("CreditCard"===p.paymentInfo.selectedPaymentMethod.type&&p.paymentInfo.selectedPaymentMethod.token)}function D(){return!!p.paymentInfo.selectedPaymentMethod&&("CreditCard"===p.paymentInfo.selectedPaymentMethod.type&&!p.paymentInfo.selectedPaymentMethod.token)}function N(){return p.billingAddress.country&&("US"===p.billingAddress.country.code||"CA"===p.billingAddress.country.code)}function s(e,t){c();var n=((p.paymentInfo||{}).selectedPaymentMethod||{}).type;n&&n!==e&&X.tabSection(null,n),"CreditCard"!==e||t||p.customer&&p.customer.creditCards&&p.customer.creditCards.length&&(t=p.customer.creditCards[0].token),p.paymentInfo.selectedPaymentMethod={type:e,token:t||null}}function L(){p.paypal={},document.getElementById(i).setAttribute("value",""),O()}function $(t){t=t||function(){},p.cart&&p.cart._id&&p.coupon&&p.coupon.code&&(p.couponCodeError="",p.applyingCoupon=!0,p.coupon&&p.coupon.code&&(p.coupon.code=p.coupon.code.toUpperCase()),ee.addCoupon(p.coupon.code,p.cart._id).then(function(e){p.applyingCoupon=!1;e=te.find(e.appliedDiscounts,function(e){return e.code===p.coupon.code}),e={coupon_id:te.chain(e).pick("discountId").values().first().value()};te.extend(e,p.analyticsProps),X.checkout("complete","coupon",e),p.coupon.code="",t(null,!0)},function(e){p.applyingCoupon=!1,e.message?p.couponCodeError=e.message:p.couponCodeError=m,t(null,!1)}))}function B(){var e=p.billingAddress.vat.substr(0,2).match(/[A-Za-z]{2}/),t=p.billingAddress.vat.substr(2);e?p.billingAddress.country.code&&p.billingAddress.country.code.toLowerCase()!==e[0].toLowerCase()?p.vat={}:p.vat={countryCode:e[0].toUpperCase(),number:t}:p.vat={countryCode:p.billingAddress.country.code,number:t}}function U(){var t,n,r,e=te.find(p.uniqueCoupons,function(e){return te.find(e.condition,function(e){return e.noPaymentInfoOnFree})});if(0!==p.total||p.hasRenewingItem&&!e)if(D())(e={number:p.paymentInfo.creditCard,expirationMonth:p.paymentInfo.expirationMonth,expirationYear:p.paymentInfo.expirationYear,cvv:p.paymentInfo.cvv}).billingAddress=Y(p.billingAddress),e&&e.number&&e.expirationMonth&&e.expirationYear&&e.cvv?Z.validatePayment(p.providerToken,e).then(function(e){return p.paymentInfo.ccToken=e,F()},function(e){return ne.reportOrderError({error_type:"validate_payment_error",error:e}),u(y),H()}):u(S);else if(p.paymentInfo.selectedPaymentMethod&&"PayPal"===p.paymentInfo.selectedPaymentMethod.type)(e=angular.element("#"+i).val())?(p.cart.selectedPaymentMethod="PayPal",p.paymentInfo.ccToken=e,F()):(ne.reportOrderError({error_type:"missing_paypal_nonce"}),u(g));else{if(!j())return u(v);p.cart.selectedPaymentMethod="Existing",p.paymentInfo.ccToken=p.paymentInfo.selectedPaymentMethod.token,(t={}).billingAddress=Y(p.billingAddress),n=te.find(p.customer.creditCards,function(e){return e.token===p.paymentInfo.ccToken}),r=!1,Object.keys(t.billingAddress).forEach(function(e){!0!==r&&n.billingAddress&&(r=t.billingAddress[e]!==n.billingAddress[e])}),r&&Z.updateCard({ccToken:p.paymentInfo.ccToken,options:t}),F()}else p.cart.selectedPaymentMethod="Free",p.paymentInfo.ccToken="Free",F(!0)}function F(e){var t;p.orderProcessing||(V(),fe.set(p.billingAddress),pe.set(p.paymentInfo),t={ccToken:pe.get().ccToken,selectedPaymentMethod:p.cart.selectedPaymentMethod,experiments:G.buckets.experimentMap},e||(t.billingInfo=fe.get()),"gift"===p.type&&(t.gift=me.get()),_e.getCaptcha("orderCreate",function(e){t.captchaToken=e,Z.review(t,function(e){if(e.success){p.order=e.data.order;var t=p.user.traits,n=Vault.Local.getList(),r={};te.each(n,function(e){var t=Object.keys(e)[0];t&&0===t.indexOf("trait_")&&(r[t.replace(/trait_/,"")]=e[t])}),p.order.traits=angular.extend({},r,t);try{p.order.user.full_name=rind.context.session.profile.first_name+" "+rind.context.session.profile.last_name}catch(e){p.order.user.full_name=""}p.showSpinner=!0;var i={};angular.forEach(["iterableEmailCampaignId","iterableTemplateId"],function(e){var t=Vault.Cookie.get(e);t&&(i[e]=t)}),Z.process({order:p.order,campaignData:i,device_data:p.checkout.deviceData},function(e){q()},function(e){return z(),e.config&&delete e.config,ne.reportOrderError({error_type:"order_process_error",error:e}),u()})}else if(!e.success&&e.message){var o;return z(),"braintree"===e.processor?(e.message?(o=e.message,e.code&&(o+=". Please verify the information provided and try again ("+e.code+").")):o=v,ne.reportOrderError({error_type:"order_creation_failed",error:o}),u(o)):u(e.message)}},function(e){var t=null;return e&&e.data&&400===e.data.statusCode&&e.data.message&&e.data.message.match(/state/i)&&(t=b),z(),ne.reportOrderError({error_type:"order_creation_threw",error:te.omit(e,"config")}),u(t)})}))}function z(){p.enableLineItemRemove="gift"!==p.type,p.orderProcessing=!1,p.orderCreateError=!0}function V(){p.enableLineItemRemove=!1,p.orderProcessing=!0,p.orderCreateError=!1}function c(){p.error={}}function H(){p.enableLineItemRemove="gift"!==p.type,p.showSpinner=!1}function u(e){return p.error.message=e=e||_,H()}function q(f){f=f||500,!p.order||!p.order._id||!G.user||!G.user.getOrder||64e3<f?W():G.user.getOrder({orderId:p.order._id},{expires:"0 seconds"}).then(function(e){if("processing"===e.order_status||"in_checkout"===e.order_status)K(function(){q(2*f)},f);else if("completed"===e.order_status||"deferred"===e.order_status){var t=p.order,n=(n=G.user.get("contentRights")).purchased&&n.purchased.courses&&n.purchased.courses.length||0,r=Q(t||{},"raw.cart.coupon_codes.0"),i={repeat:0<n,revenue:t.deferred||!t.summaries.revenue?0:t.summaries.revenue,deferred:t.deferred,checkout_type:"order",coupon_code:r,coupon:r,payment_method:p.paymentInfo&&p.paymentInfo.selectedPaymentMethod&&p.paymentInfo.selectedPaymentMethod.type,salePrice:t.summaries.salePrice},o=[],a=!1;try{te.each(t.line_items,function(e){var t=!!e.pricing.owned_discount;a=t||a,o.push({product_id:e.product.id,id:e.product.id,sku:e.product.sku,category:e.product.source.source_type,name:e.product.short_title,price:e.pricing.final_price/100,quantity:1,partial_bundle_purchase:t})})}catch(e){o=t.summaries.products}i.products=o,i.partial_bundle_purchase=a,i.order_id=t.oid,te.extend(i,p.analyticsProps);var s=p.user.traits;if(s&&te.each(Object.keys(s),function(e){i["trait_"+e]=s[e]}),G.user.updateTraits(function(){X.checkoutOrderComplete(i)}),p.subscriptionInCart){n=e;r=p.subscriptionInCart;t=p.subscriptionNewExpiration;var e=n.deferred,c=r.source&&r.source.billingFrequency,l=n.order_type,u=void 0;try{u=te.find(n.line_items,function(e){return e.product.subscription_id}).product.subscription_id}catch(e){}var d=r.source&&r.source.slug,n=n.total,t=t?"extend":"start";e&&(n=0);e={isTrial:e,subscriptionId:u,subscriptionPlanSlug:d,billingCycle:c,nonRenewable:r.source.nonRenewable,order_type:l,revenue:n};X.trackSubscription(t,e)}u=p.order;(u=Q(u||{},"raw.cart.coupon_codes.0"))&&G.user.removeApplicableCoupon(u),p.items.forEach(function(e){ge.clearProduct(e)}),p.redeem?p.partner&&p.partner.slug?(ie.path("/redeem/"+p.partner.slug+"/confirmation"),p.showSpinner=!1):window.location="/redeem/confirmation":K(function(){p.$emit("ecom:order:process:success",void 0),p.showSpinner=!1},250),p.orderSuccess=!0,(new ve).updateScores()}else W()}).catch(function(e){W()})}function W(){return z(),p.order&&p.order.payee_details&&p.order.payee_details.method&&"PayPal"===p.order.payee_details.method.card_type?(L(),u(w)):u(),0}function Y(e){return{countryName:e.country.name,firstName:e.firstName,lastName:e.lastName,locality:e.city,postalCode:e.zipCode,streetAddress:e.streetAddress,company:e.companyName||"",region:("US"===e.country.code||"CA"===e.country.code?e.selectedState.code:e.inputState)||""}}p.$on("ecom:checkout:data:received",function(){s("CreditCard"),a(),p.$watch("userCart",I)})},controllerAs:"EcommerceCheckoutCtrl",controller:["$scope","$element",function(n,e){te.extend(n,{user:rind.context.session.user,recentOrder:null,populateBillingFromCreditCard:o}),J.all({getToken:Z.getToken().$promise,getCustomer:Z.getCustomer({customer_id:n.user._id}).$promise,getRecentOrder:Z.getOrder().$promise}).then(function(e){if(e.getToken.success){n.providerToken=e.getToken.data.token,n.customer=e.getCustomer.braintree,n.historical=e.getCustomer.historical,n.recentOrder=e.getRecentOrder&&e.getRecentOrder.data;try{i(),n.$emit("ecom:checkout:data:received")}catch(e){}}else G.errorStatus=500},function(e){G.errorStatus=500,G.ready=!0});var r=n.$watch("paymentInfo.selectedPaymentMethod",function(t){t.token&&"CreditCard"===t.type&&(o(te.find(n.customer.creditCards,function(e){return e.token===t.token})),r())});function i(){n.billingAddress=Q(n.historical||{},"payee_details.billing_info"),n.billingAddress&&"undefined"===n.billingAddress.companyName&&delete n.billingAddress,n.billingAddress&&n.billingAddress.country&&n.billingAddress.selectedState?(n.billingAddress.country=n.countries.filter(function(e){return e.code===n.billingAddress.country.code})[0],n.billingAddress.selectedState=n.states.filter(function(e){return e.code===n.billingAddress.selectedState.code})[0]):n.billingAddress&&n.billingAddress.country?n.billingAddress.country=n.countries.filter(function(e){return e.code===n.billingAddress.country.code})[0]:n.billingAddress={}}function o(e){var t=e&&e.billingAddress;t?(n.billingAddress={firstName:t.firstName,lastName:t.lastName,streetAddress:t.streetAddress,zipCode:t.postalCode,city:t.locality},t.company&&"undefined"!==t.company&&(n.billingAddress.companyName=t.company),n.billingAddress.country=n.countries.filter(function(e){return e.code===t.countryCodeAlpha2})[0],"US"===n.billingAddress.country.code?n.billingAddress.selectedState=n.states.filter(function(e){return e.code===t.region})[0]:"CA"===n.billingAddress.country.code?n.billingAddress.selectedState=n.provinces.filter(function(e){return e.code===t.region})[0]:t.region&&"undefined"!==t.region&&(n.billingAddress.inputState=t.region)):i()}}]}}t.exports=r},{async:21}],543:[function(e,t,n){"use strict";function r(l,e,r,t,d,f){return{restrict:"E",templateUrl:function(e,t){return t.template?"/templates/ecom/"+t.template+".html":"/templates/ecom/upsell.html"},link:function(i,e,t){c(),i.annualProductId=r.config.creatorPass.planProductIds[0],i.monthlyProductId=r.config.creatorPass.planProductIds[1],i.annualPaidMonthlyProductId=r.config.creatorPass.planProductIds[2],i.displayUpsell=!i.subscriptionInCart&&!d.user.hasCreatorPassSubscription()&&n();var o=i.$watch("userCart",u),a="individual",s="yearly";function c(){i.defaultCart=f.clone(i.cart),i.defaultCart.items=f.clone(i.cart.items),i.classTotal=f.clone(i.total)}function n(){var t=!0,e=f.clone(i.cart.lineItems);return f.each(e,function(e){e=e,-1===f.indexOf(e.source.flags,"consumer_subscription")&&-1===f.indexOf(e.source.flags,"show_cp_cta")&&(t=!1)}),t}function u(){i.displayUpsell=!f.clone(i.subscriptionInCart)&&!d.user.hasCreatorPassSubscription()&&n();var e=i.frequency;(e=i.total<r.config.bargainShopper.maxPriceMonthly?"monthly":e)!==i.frequency&&(i.frequency=e)}i.total<r.config.bargainShopper.maxPriceMonthly&&(s="monthly"),i.enablebutton=!0,i.upsellSelection=a,i.frequency=s,i.changeFrequency=function(e,t){i.frequency=t},i.toggle=function(e){"individual"===e&&(i.upsellSelection="cp"),"cp"===e&&(i.upsellSelection="individual");var e=i.upsellSelection,t=(o(),!1);if(i.enablebutton&&e&&(i.upsellSelection!==a||i.frequency!==s)){i.upsellSelection!==a&&(t=!0),a=i.upsellSelection,s=i.frequency;var n=void 0,r=void 0;switch(i.upsellSelection){case"cp":"yearly"===i.frequency?n=i.annualProductId:"annualPaidMonthly"===i.frequency?n=i.annualPaidMonthlyProductId:"monthly"===i.frequency&&(n=i.monthlyProductId),t&&(c(),r=i.defaultCart.items);break;case"individual":r=[i.annualProductId,i.annualPaidMonthlyProductId,i.monthlyProductId],n=i.defaultCart.items}n&&r?(i.enablebutton=!1,l.add(n).then(function(){l.remove(r).then(function(){i.enablebutton=!0,"individual"===i.upsellSelection&&(o=i.$watch("userCart",u))},function(){})},function(){})):i.enablebutton=!0}}}}}r.$inject=["CartService","trackFactory","rind","ProductService","$rootScope","_"],t.exports=r},{}],544:[function(e,t,n){"use strict";var v=e("moment");t.exports=["$rootScope","$location","$filter","rind","config","VAT","CatalogService","trackFactory","deepval","SubscriptionPlanService",function(s,c,u,l,d,f,p,h,m,g){return{restrict:"EA",templateUrl:"/templates/ecom/orderDetail.html",scope:{order:"=?",orderId:"@"},link:function(r,e,t){angular.extend(r,{appStoreUrl:l.config.appStoreUrl,editGift:function(){s.$emit("user:gift",{gift:r.order.gift,orderId:r.order._id}),h.gifting("edit",{gift_type:"order details",coupon_code:r.order.gift.coupon_code,orderId:r.order._id})},onPrint:function(){var e=new String(document.title),t=u("unixDate")(r.order.modified,"MMM Do YYYY",!0);document.title="CreativeLive "+t+"-"+r.order.oid,window.print(),document.title=e},currency:"USD",currencySymbol:"$",basePriceOnly:!1});var i=r.$watch("orderId",function(){s.user.valid()&&r.orderId&&s.user.getOrder({orderId:r.orderId,select:"slim"}).then(n,a)}),o=r.$watch("order",function(){r.order&&n(r.order)});function n(e){if(!e)return a(new Error("no-order"));r.order=e,r.taxobject={total:0,userVAT:e&&e.payee_details&&e.payee_details.billing_info&&e.payee_details.billing_info.vat,taxtotal:e.tax_total,countryCode:e.payee_details&&e.payee_details.billing_info&&e.payee_details.billing_info.country&&e.payee_details.billing_info.country.code},t=f.getVatForOrder(r.order),r.taxobject.userVAT=t.userVAT,r.taxobject.clVAT=t.clVAT,angular.isObject(r.order)&&d&&d.registrationNumbers&&(t=m(r.order,"payee_details.billing_info.country.code"),n=m(r.order,"payee_details.billing_info.selectedState.code"),t&&(t=t.toLowerCase(),d.registrationNumbers[t]&&(r.taxobject.registrationNumber=d.registrationNumbers[t])),t&&n&&(n=n.toLowerCase(),"ca"===t&&"qc"===n?r.taxobject.registrationNumber2=d.registrationNumbers.quebec:"ca"===t&&"bc"===n&&(r.taxobject.registrationNumber2=d.registrationNumbers.britishColumbia))),r.coupons=e.raw.coupons,r.appliedDiscounts=m(e||{},"raw.cart.discounts"),r.uniqueCoupons=u("unique")(e.raw.coupons||[],"code"),r.subtotal=e.subtotal,r.total=e.total,r.coupons&&r.coupons[0]&&r.coupons[0].condition&&_.each(r.coupons[0].condition,function(e){e.basePriceOnly&&(r.basePriceOnly=!0)});var t=m(r.order||{},"payee_details.method.card_type"),n=(t&&(r.order.payee_details.method.card_type=t.toLowerCase()),angular.forEach(r.order.line_items,function(n){var e=n&&n.product;e&&(e.source&&"subscriptionPlan"===e.source.source_type?g.getSubscriptionPlanById(e.source.source_id).then(function(e){r.billingFrequency=e.billingFrequency;var t="gift"===r.order.order_type;l.config.ecom.hideOrderPricesForSubSlugs&&0<=l.config.ecom.hideOrderPricesForSubSlugs.indexOf(e.slug)&&0===r.total&&(r.coupons=[],r.appliedDiscounts=null,r.uniqueCoupons=[],r.subtotal=0,r.total=0),"yearly"===e.billingFrequency?"back-to-biz"!==e.slug&&(n.billingText=t?"1 Year Access":"Billed Annually"):"monthly"===e.billingFrequency&&(1===e.requiredBillingCycle?n.billingText=t?"1 Month Access":"Billed Monthly":12===e.requiredBillingCycle&&(n.billingText="Annual Commitment. Billed Monthly"))}):(e=n.product.course_id||n.product.bundle_id,p.getCourseById(e).then(function(e){n.instructors=e.instructors,r.gift&&(n.slug=e.slug)})))}),r.countryCode=m(r,"order.payee_details.billing_info.country.code"),r.isVATCountry=f.isVATCountry(r.countryCode),r.order.charge_time||r.order.created);r.order.billDate=v.unix(n).format("MMM Do, YYYY"),r.orderDetailReady=!0,i(),o()}function a(e){c.path("/my-orders").replace(),i()}}}}]},{moment:void 0}],545:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","moment",function(s,c,u){return{restrict:"EA",templateUrl:"/templates/ecom/orderHistory.html",link:function(t,e,n){var r=5e3,i=12,o={};function a(e){var t=u().subtract(12,"hours");return!u.unix(e.created).isBefore(t)}angular.extend(t,{orderFilter:function(e){return"processing"!==e.order_status||a(e)},checkOrderStatus:function t(n){if(!n||!n._id)return;if(!a(n))return;o[n._id]||(o[n._id]=0);if(o[n._id]>i)return void(n.order_status="error");s.user.getOrder({orderId:n._id,select:"slim"},{expires:"0 seconds"}).then(function(e){"processing"===e.order_status?(o[n._id]++,c(function(){t(n)},r)):angular.extend(n,e)}).catch(function(e){})}}),s.user.valid()&&s.user.getOrders({select:"slim"}).then(function(e){t.orders=e,t.orderHistoryReady=!0},function(e){t.orderHistoryReady=!0})}}}]},{}],546:[function(e,t,n){"use strict";function r(v,y,b,_,w,S,E,A,k,T){return{restrict:"AE",templateUrl:function(e,t){return t.clTemplateUrl||"/templates/ecom/payment.html"},scope:{userId:"@",subscription:"<"},link:function(i,l,d){function n(t){t=t||i.payment,i.creditCards.forEach(function(e){e.active=e.token===t.token})}function r(){i.vatExemptCodeValid=!1,i.billingAddress.vat=void 0,i.vatError=""}function o(){i.vatError="Invalid exemption code",i.vatExemptCodeValid=!1}function a(){i.vatError="",i.vatExemptCodeValid=!1;var t={countryCode:i.billingAddress.country.code,number:i.billingAddress.vat.substr(2)},e=i.billingAddress.vat.substr(0,2).match(/[A-Za-z]{2}/),e=e&&e[0];if(!i.billingAddress.country.code&&e)t.countryCode=e.toUpperCase();else if(!e||i.billingAddress.country.code.toLowerCase()!==e.toLowerCase())return void o();!t.countryCode||2!==t.countryCode.length||t.number.length<8?o():_.verify(t.countryCode,t.number,function(e){e.valid?(i.vatExemptCodeValid=!0,e.vat_number&&(i.billingAddress.vat=t.countryCode+e.vat_number)):o()})}function f(){i.showVat=i.billingAddress&&i.billingAddress.country&&i.billingAddress.country.vat,i.isVATCountry=!1,i.showVat&&(i.isVATCountry=_.isVATCountry(i.billingAddress.country.code))}function p(){return{firstName:i.billingAddress.firstName,lastName:i.billingAddress.lastName,locality:i.billingAddress.locality,streetAddress:i.billingAddress.streetAddress,company:i.billingAddress.companyName,countryName:i.billingAddress.country.name,region:i.billingAddress.region?i.billingAddress.region.code:"",postalCode:i.billingAddress.postalCode}}function s(t){t=t||i.payment,i.paypalAccounts.forEach(function(e){return e.active=e.token===t.token})}function c(){k(function(){i.indicator.status=null,i.indicator.message=null,e()},1500)}function u(t){if(i.subscription.processor.payment_token===t.token&&((!i.subscription.billing_info||!i.subscription.billing_info.vat)&&!i.billingAddress.vat||i.subscription.billing_info&&i.subscription.billing_info.vat===i.billingAddress.vat))return i.indicator.status="saved",c();S.updateSubscription({subscriptionId:i.subscription._id,braintreeId:i.subscription.processor.customer_id?void 0:i.customerId,token:t.token,vat:i.billingAddress.vat},function(e){if(!e.success)return i.indicator.status="error",void(i.indicator.message="Could not be set as your new payment.");i.indicator.status="saved",i.subscription.payment=angular.copy(t),i.subscription.processor.payment_token=angular.copy(t.token),i.subscription.billing_info={vat:i.billingAddress.vat},i.payment=angular.copy(t),i.subscription.state="renewing",n(),s(),k(function(){c()},1500)})}function e(){A.isEmpty(i.payment)||(i.updatingCard=!i.updatingCard,i.updatingCard||(i.newCreditCardView=!1))}function t(e){var t=e?e.billingAddress:E(i.payment,"billingAddress");t&&(e&&n(e),e=t.countryCodeAlpha2||t.country&&t.country.code,i.newCreditCardView=!1,i.billingAddress={firstName:t.firstName,lastName:t.lastName,streetAddress:t.streetAddress,companyName:t.companyName,country:{code:e,name:t.countryName||t.country&&t.country.name,vat:_.isVATCountry(e)},region:{code:t.region.code||t.region},postalCode:t.postalCode,locality:t.locality,vat:i.subscription.billing_info&&i.subscription.billing_info.vat},f(),(i.billingAddress.vat?a:r)())}function h(){i.indicator.status="error",i.indicator.message="Please select account first."}function m(){i.creditCardsToDelete.length&&(i.creditCardsToDelete.forEach(function(e){var t;t=e.token,S.removeCard({ccToken:t},function(e){i.removingCard=!1,e.success?i.creditCards=A.reject(i.creditCards,function(e){return e.token===t}):(i.indicator.status="error",i.indicator.message="Error removing credit card. Please try again later.")})}),i.creditCardsToDelete=[])}function g(e,t){T.resolve().then(function(){if(!i.customerId)return S.createCustomer({billingInfo:{firstName:i.billingAddress.firstName,lastName:i.billingAddress.lastName}}).$promise}).then(function(e){e&&e.data&&e.data.ecommerce&&e.data.ecommerce&&(i.customerId=e.data&&e.data.ecommerce&&e.data.ecommerce.braintree_id)}).then(function(){S.addPayment({ccToken:e,braintreeId:i.customerId},t,t)}).catch(function(e){t(e)})}angular.extend(i,{countries:v,states:y,provinces:b,years:w,paymentInfo:{},isEmpty:A.isEmpty,updatingCard:!1,indicator:{},billingAddress:{},vatExemptCodeValid:!1,vatError:"",paymentReady:!1,token:E(i.subscription,"processor.payment_token"),creditCardsToDelete:[],onSubmit:function(e){var t=!1;i.indicator.status="saving",i.vatExemptCodeValid||r();i.creditCardsToDelete.length&&(m(),t=!0);if("paypal"!==e){if(i.newCreditCardView||!i.creditCards.length)return S.getToken().$promise.then(function(e){var t=e&&e.data&&e.data.token;return t&&e.success?S.validatePayment(t,{number:i.paymentInfo.creditCard,expirationMonth:i.paymentInfo.expirationMonth,expirationYear:i.paymentInfo.expirationYear,cvv:i.paymentInfo.cvv,billingAddress:p()}).then(function(e){return e},function(e){return null}):(i.indicator.status="error",i.indicator.message="Could not validate the new payment.",null)}).then(function(e){if(!e)return i.indicator.status="error",void(i.indicator.message="Could not validate the new payment.");g(e,function(e){if(!e||!e.success)return i.indicator.status="error",void(i.indicator.message="Could not add the new payment.");e=Object.assign({},e.data,{billingAddress:i.billingAddress,expirationDate:e.data.cardExpiration,expirationMonth:e.data.cardExpiration.slice(0,2),expirationYear:e.data.cardExpiration.slice(4),last4:e.data.cardMask.slice(-4),token:e.data.paymentToken});i.creditCards.push(e),u(e)})});var n=i.creditCards.find(function(e){return e.active});return!n&&t?void c():n?(i.indicator.message=null,function(t,n){var r=p(),e=A.pick(t.billingAddress,"firstName","lastName","locality","streetAddress","companyName","countryName","region","postalCode");if(A.isEqual(r,e))return n();S.updateCard({subscriptionId:i.subscription._id,ccToken:t.token,options:{billingAddress:r}},function(e){if(!e.success)return i.indicator.status="error",void(i.indicator.message="Could not update the new billing information on your payment.");t.billingAddress=r,n()})}(n,function(){return u(n)})):void h()}e=i.paypalAccounts.find(function(e){return e.active});e?(i.indicator.message=null,u(e)):h()},onTabSelected:function(e,t){t&&(t.preventDefault(),t.stopPropagation());i.indicator.status=null,i.indicator.message=null,i.activePaymentTab=e},setActivePaypal:s,toggleUpdateCard:e,toggleNewPaypalView:function(){i.newPaypalView=!i.newPaypalView},toggleNewCreditCardView:function(){i.newCreditCardView=!i.newCreditCardView,i.paymentInfo={}},deleteOnUpdate:function(e){e.delete=!0,i.creditCardsToDelete.push(e)},deleteCreditCards:m,resetForm:function(){t(),e(),i.creditCardsToDelete.forEach(function(e){delete e.delete}),i.creditCardsToDelete=[]},populateBillingAddressFromCreditCard:t,onCountryChanged:function(){f(),i.billingAddress.vat="",i.vatExemptCodeValid=!1,i.vatError="",i.billingAddress.country&&delete i.billingAddress.region},applyVatExemptCode:a,removeVatExemptCode:r}),S.getCustomer({customer_id:i.userId}).$promise.then(function(e){if(angular.extend(i,{customerId:E(e,"braintree.id"),creditCards:E(e,"braintree.creditCards")||[],paypalAccounts:E(e,"braintree.paypalAccounts")||[]}),S.getToken().$promise.then(function(e){var t=e&&e.data&&e.data.token;t&&e.success&&braintree.setup(t,"custom",{onReady:function(e){return i.checkout=e},onError:function(e){},onPaymentMethodReceived:function(t){g(t.nonce,function(e){if(!e||!e.success||!e.data.paymentToken)return i.indicator.status="error",void(i.indicator.message="Could not add the new payment.");e=Object.assign({},t.details,{token:e.data.paymentToken,active:!0});i.paypalAccounts.push(e),u(e)})},paypal:{paymentMethodNonceInputField:"payPalNonce",singleUse:!1,headless:!0,locale:"en_us"},dataCollector:{paypal:!0}})}),i.token){if(i.paypalAccounts.length){e=i.paypalAccounts.find(function(e){return e.token===i.token});if(e)return i.activePaymentTab=1,i.payment=e,i.paymentReady=!0,s(e)}i.activePaymentTab=0;e=i.creditCards.find(function(e){return e.token===i.token});return e?(t(e),e.active=!0):i.updatingCard=!0,i.paymentReady=!0,i.payment=e||{}}i.paymentReady=!0})}}}r.$inject=["Countries","States","Provinces","VAT","Years","Ecommerce","deepval","_","$timeout","$q"],t.exports=r},{}],547:[function(e,t,n){"use strict";t.exports=["$timeout","$window","$rootScope","Ecommerce",function(i,e,t,o){return{restrict:"EA",scope:{inputName:"@",inputEmail:"@",sku:"@",coupon:"@"},templateUrl:"/templates/ecom/receiptRedeemForm.html",link:function(r){angular.extend(r,{inputReceiptNum:"",redeemSucceeded:!1,errorText:"",orderId:null,newRedeem:!0,submitReceipt:function(){var t=this;this.inputName&&this.inputEmail&&this.inputReceiptNum?(r.redeeming=!0,this.clearError(),o.redeemReceipt({name:this.inputName,email:this.inputEmail,receipt:this.inputReceiptNum,sku:this.sku,coupon:this.coupon}).$promise.then(function(e){e.data.orderId?(t.orderId=e.data.orderId,t.checkOrderStatus()):t.setSuccessState(!1)},function(e){e.data&&"bad email"===e.data.message?t.setError("That's not an email address."):t.setError()})):this.setError("all fields are required")},setError:function(e){r.redeeming=!1,r.errorText=e||"something went wrong"},clearError:function(){r.errorText=""},onOrderSuccess:function(){this.setSuccessState(!0),t.user.valid()&&e.location.reload()},checkOrderStatus:function(t){var n=this;t=t||500;64e3<t?r.throwError():o.getOrderStatus({orderId:this.orderId}).$promise.then(function(e){e=e.data;"processing"===e.order_status||"in_checkout"===e.order_status?i(function(){n.checkOrderStatus(2*t)},t):"completed"===e.order_status?n.onOrderSuccess():n.setError()},function(){n.setError()}).catch(function(){n.setError()})},setSuccessState:function(e){r.redeeming=!1,r.redeemSucceeded=!0,r.newRedeem=e}})}}}]},{}],548:[function(e,t,n){"use strict";t.exports=["_",function(r){return{restrict:"E",scope:{order:"=",cart:"=",coupons:"=",savings:"=",subtotal:"=",total:"=",freeTrial:"=",taxobject:"=",discountedTotal:"=?",currency:"=",currencySymbol:"=",basePriceOnly:"=?",appliedDiscounts:"=?",subscriptionNewExpiration:"=?",calculatingTax:"=?",billingFrequency:"=?"},templateUrl:"/templates/ecom/totals.html",link:function(t,e,n){t.$watch("taxobject",function(){t.taxobject&&(t.taxtotal=t.taxobject.total||t.taxobject.taxtotal||0)}),t.$watch("coupons",function(){t.discountedTotal=r.reduce(r.pluck(t.coupons,"impact"),function(e,t){return e+t},0)}),t.$watch("appliedDiscounts",function(e){t.billingCycles={},t.subscriptionNewExpiration||(t.totalDiscount=0,r.each(e,function(e){"cross-sell"===e.action.type?t.totalDiscount+=e.impact:"discount"===e.action.type?(t.billingCycles.discount=e.discount.billingCycles,t.totalDiscount+=e.impact):"coupon"===e.action.type&&(t.billingCycles.coupon=e.discount.billingCycles)}))}),t.$watch("subscriptionNewExpiration",function(){t.billingCycles={},t.subscriptionNewExpiration||r.each(t.appliedDiscounts,function(e){"discount"===e.action.type?t.billingCycles.discount=e.discount.billingCycles:"coupon"===e.action.type&&(t.billingCycles.coupon=e.discount.billingCycles)})}),t.$watch("billingFrequency",function(){"monthly"===t.billingFrequency?(t.discountCycleLabel="Monthly",t.discountPeriodLabel="month"):"yearly"===t.billingFrequency?(t.discountCycleLabel="Annual",t.discountPeriodLabel="year"):"quarterly"===t.billingFrequency?(t.discountCycleLabel="Quarterly",t.discountPeriodLabel="quarter"):(t.discountCycleLabel="",t.discountPeriodLabel="billing cycle")})}}}]},{}],549:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clEcomCart",e("./directives/cart")),r.directive("clCheckout",e("./directives/checkout")),r.directive("ccFormatDetect",e("./directives/ccFormatDetect")),r.directive("cpUpsell",e("./directives/cpUpsell")),r.directive("billingForm",e("./directives/billingForm")),r.directive("totals",e("./directives/totals")),r.directive("orderHistory",e("./directives/orderHistory")),r.directive("orderDetail",e("./directives/orderDetail")),r.directive("clPayment",e("./directives/payment")),r.directive("receiptRedeem",e("./directives/receiptRedeem")),r.service("BillingInfo",e("./services/billingInfo")),r.service("PaymentInfo",e("./services/paymentInfo")),r.service("Cart",e("./services/cart")),r.service("Ecommerce",e("./services/ecommerce")),r.service("Product",e("./services/product")),r.service("Countries",e("./services/countries")),r.service("PaymentCards",e("./services/paymentCards")),r.service("Years",e("./services/years")),r.service("States",e("./services/states")),r.service("Provinces",e("./services/provinces")),r.service("VAT",e("./services/vat"))},{"../../common/app":70,"./directives/billingForm":539,"./directives/cart":540,"./directives/ccFormatDetect":541,"./directives/checkout":542,"./directives/cpUpsell":543,"./directives/orderDetail":544,"./directives/orderHistory":545,"./directives/payment":546,"./directives/receiptRedeem":547,"./directives/totals":548,"./services/billingInfo":550,"./services/cart":551,"./services/countries":552,"./services/ecommerce":553,"./services/paymentCards":554,"./services/paymentInfo":555,"./services/product":556,"./services/provinces":557,"./services/states":558,"./services/vat":559,"./services/years":560}],550:[function(e,t,n){"use strict";t.exports=function(){var t={};return{set:function(e){(t=e||{})&&t.country&&"US"!==t.country.code&&"CA"!==t.country.code&&(t.selectedState={code:"",name:t.inputState||""})},get:function(){return t}}}},{}],551:[function(e,t,n){"use strict";t.exports=function(){var n={lineItems:null};return{set:function(e,t){(n=e).lineItems=t,n.lineItems&&(e=_.map(n.lineItems,function(e){if(e.flags)return e.flags}),e=_.compact(_.uniq(_.flatten(e))),n.flagged||(n.flagged={}),e&&e.length&&_.each(e,function(e){"!"===e[0]?(e=e.substr(1),n.flagged[e]=!1):n.flagged[e]=!0}))},get:function(){return n}}}},{}],552:[function(e,t,n){"use strict";t.exports=function(){return[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia",vat:!0},{code:"GB",name:"United Kingdom",vat:!0},{code:"DE",name:"Germany",vat:!0},{code:void 0,name:"-----------------------"},{name:"Afghanistan",code:"AF"},{name:"land",code:"AX"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU",vat:!0},{name:"Austria",code:"AT",vat:!0},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE",vat:!0},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bonaire, Sint Eustatius and Saba",code:"BQ"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG",vat:!0},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo (Brazzaville)",code:"CG"},{name:"Congo (Kinshasa)",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cte d'Ivoire",code:"CI"},{name:"Croatia",code:"HR",vat:!0},{name:"Cuba",code:"CU"},{name:"Curaao",code:"CW"},{name:"Cyprus",code:"CY",vat:!0},{name:"Czech Republic",code:"CZ",vat:!0},{name:"Denmark",code:"DK",vat:!0},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE",vat:!0},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI",vat:!0},{name:"France",code:"FR",vat:!0},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Lands",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE",vat:!0},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"EL",vat:!0},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard and McDonald Islands",code:"HM"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU",vat:!0},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE",vat:!0},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT",vat:!0},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea, North",code:"KP"},{name:"Korea, South",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Laos",code:"LA"},{name:"Latvia",code:"LV",vat:!0},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT",vat:!0},{name:"Luxembourg",code:"LU",vat:!0},{name:"Macau",code:"MO"},{name:"Macedonia",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT",vat:!0},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia",code:"FM"},{name:"Moldova",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montenegro",code:"ME"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL",vat:!0},{name:"Netherlands Antilles",code:"AN"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO",vat:!0},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestine",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL",vat:!0},{name:"Portugal",code:"PT",vat:!0},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO",vat:!0},{name:"Russian Federation",code:"RU"},{name:"Rwanda",code:"RW"},{name:"Saint Barthlemy",code:"BL"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Martin (French part)",code:"MF"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia",code:"RS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Sint Maarten (Dutch part)",code:"SX"},{name:"Slovakia",code:"SK",vat:!0},{name:"Slovenia",code:"SI",vat:!0},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Georgia and South Sandwich Islands",code:"GS"},{name:"South Sudan",code:"SS"},{name:"Spain",code:"ES",vat:!0},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen Islands",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE",vat:!0},{name:"Switzerland",code:"CH",vat:!0},{name:"Syria",code:"SY"},{name:"Taiwan",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB",vat:!0},{name:"United States Minor Outlying Islands",code:"UM"},{name:"United States of America",code:"US"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Vatican City",code:"VA"},{name:"Venezuela",code:"VE"},{name:"Vietnam",code:"VN"},{name:"Virgin Islands, British",code:"VG"},{name:"Virgin Islands, U.S.",code:"VI"},{name:"Wallis and Futuna Islands",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}]}},{}],553:[function(e,t,n){"use strict";function r(e,i,t){e=e("/api/ecom",{},{getCart:{url:"/api/ecom/cart"},addItem:{method:"POST",url:"/api/ecom/cart/add"},addCoupon:{method:"POST",url:"/api/ecom/cart/addcoupon",transformRequest:function(e){return e.couponCode=e.couponCode.toUpperCase(),JSON.stringify(e)}},removeCoupon:{method:"POST",url:"/api/ecom/cart/removecoupon"},removeItem:{method:"POST",url:"/api/ecom/cart/remove"},review:{method:"POST",url:"/api/ecom/order/create",headers:{"x-recaptcha-token":function(e){var t=e&&e.data&&e.data.captchaToken;return t&&delete e.data.captchaToken,t}}},process:{method:"POST",url:"/api/ecom/order/process"},processFreeOrder:{method:"POST",url:"/api/ecom/order/free"},getToken:{url:"/api/ecom/provider/token"},getOrder:{url:"/api/ecom/order"},getOrderStatus:{url:"/api/ecom/order/:orderId/status"},getCustomer:{url:"/api/ecom/customer/:customer_id"},createCustomer:{method:"POST",url:"/api/ecom/customer"},addPayment:{method:"POST",url:"/api/ecom/customer/payment"},removeCard:{method:"POST",url:"/api/ecom/customer/removecard"},updateCard:{method:"PATCH",url:"/api/ecom/customer/updatecard"},updateSubscription:{method:"PATCH",url:"/api/ecom/customer/subscription"},getTax:{method:"POST",url:"/api/ecom/tax/calculate"},updateGift:{method:"PATCH",url:"/api/ecom/order/:orderId/gift"},redeem:{method:"POST",url:"/api/ecom/redeem"},redeemReceipt:{method:"POST",url:"/api/ecom/receipt/redeem"}});return e.validatePayment=function(e,t,n){var r=i.defer();return new braintree.api.Client({clientToken:e}).tokenizeCard(t,function(e,t){if(e)return r.reject(e);r.resolve(t)}),r.promise},e}r.$inject=["$resource","$q","$timeout"],t.exports=r},{}],554:[function(e,t,n){"use strict";t.exports=function(){var e=/(\d{1,4})/g;return[{type:"visa",patterns:[4],format:e,length:[13,19],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:e,length:[16,19],cvcLength:[3],luhn:!0}]}},{}],555:[function(e,t,n){"use strict";t.exports=function(){var t=null;return{set:function(e){t=e},get:function(){return t}}}},{}],556:[function(e,t,n){"use strict";t.exports=["$resource",function(e){return e("/api/product",{},{findById:{url:"/api/product/id/:id"}})}]},{}],557:[function(e,t,n){"use strict";t.exports=function(){return[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland and Labrador"},{code:"NS",name:"Nova Scotia"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewan"},{code:"NT",name:"Northwest Territories"},{code:"NU",name:"Nunavut"},{code:"YT",name:"Yukon"}]}},{}],558:[function(e,t,n){"use strict";t.exports=function(){return[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AS",name:"American Samoa"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"DC",name:"District Of Columbia"},{code:"FM",name:"Federated States Of Micronesia"},{code:"FL",name:"Florida"},{code:"GA",name:"Georgia"},{code:"GU",name:"Guam"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MH",name:"Marshall Islands"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"MP",name:"Northern Mariana Islands"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PW",name:"Palau"},{code:"PA",name:"Pennsylvania"},{code:"PR",name:"Puerto Rico"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VI",name:"Virgin Islands"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"},{code:"AA",name:"AA"},{code:"AE",name:"AE"},{code:"AP",name:"AP"}]}},{}],559:[function(e,t,n){"use strict";t.exports=["$resource","config","deepval","_",function(e,r,i,o){var a=e("/api/vat/verify/:country/:number",{country:"@country",number:"@number"});this.verify=function(e,t,n){a.get({country:e,number:t},function(e){return n(e.data)},function(e){return n({valid:!0})})},this.isVATCountry=function(e){if(e)return e=e.toLowerCase(),!(!r.vat.eu_countries[e]&&"no"!==e&&"ch"!==e&&"au"!==e)},this.getVatForOrder=function(e){var t,n;return angular.isObject(e)&&(o.each(e.tax,function(e){e.cl_exemption_code&&(t=e.exemption_code,n=e.cl_exemption_code)}),n||!r||!r.vat||(e=i(e,"payee_details.billing_info.country.code"))&&("no"===(e=e.toLowerCase())?n=r.vat.norway:"ch"===e&&(n=r.vat.CH),r.vat.eu_countries[e]&&(n=r.vat.EU))),{userVAT:t,clVAT:n}}}]},{}],560:[function(e,t,n){"use strict";t.exports=function(){for(var e=[],t=(new Date).getFullYear(),n=t+15,r=t;r<=n;r++)e.push(r);return e}},{}],561:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/enterprise-account-admin/account-selector.html",controller:["EnterpriseAccountAdminService",function(e){this.service=e}]}},{}],562:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/enterprise-account-admin/index.html",controller:"EnterpriseAccountAdminController"}},{}],563:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["$scope","SubscriptionService","EnterpriseService","Routes","EnterpriseAccountAdminService","$route",function(e,t,n,r,i,o){var a=this;function s(){a.activeRoute=o&&o.current&&o.current.$$route&&o.current.$$route.name}this.Routes=r,this.service=i,this.$onInit=function(){t.getSubscriptionsByUser({admin:!0}).then(function(e){return e&&e.length?(c.each(e,function(e){"enterprise"===e.type&&(i.subscriptions[e._id]=e)}),Promise.all(i.subscriptionIds.map(function(e){return n.getFromSubscription(e)}))):null}).then(function(e){c.each(e,function(e){e.subscriptions=e.subscriptions.filter(function(e){return!!i.subscriptions[e]}),i.accounts[e._id]=e}),i.accountIds&&1===i.accountIds.length&&i.selectAccount(i.accountIds[0])}),s()},e.$on("$routeChangeSuccess",s)}]},{underscore:void 0}],564:[function(e,t,n){"use strict";var c="cl-enterprise-admin-account",u="cl-enterprise-admin-subscription";t.exports=["$route","$rootScope","Vault","EnterpriseService","EnterpriseCache",function(n,e,r,t,i){var o,a=this,s=this,e=(this.accounts={},this.account=r.Local.get(c),this.subscriptions={},this.subscription=r.Local.get(u),this.savingSettings=!1,e.$on("user:logout",function(){r.Local.remove(c),r.Local.remove(u)}),this.features={site:{sales_banner:!1},course:{gifting:!1,reviews:!1,chat:!1,galleries:!1,bundle:!1,recommendations:!1,similar_topic_classes:!1,social_sharing:!1,social_proof:!1,course_page_flair:!1,buy:!1,remove_padding:!1}},this.account&&this.account._id&&this.account.subscriptions||r.Local.remove(c),this.subscription&&this.subscription._id&&this.subscription.name||r.Local.remove(u),o={},_.each(s.features,function(e,n){_.each(e,function(e,t){o[t]={enumerable:!0,get:function(){return!!s.account.features&&(!!s.account.features[n]&&!!s.account.features[n][t])},set:function(e){s.account.features||(s.account.features={}),s.account.features[n]||(s.account.features[n]={}),s.account.features[n][t]=e}}})}),o);Object.defineProperties(this,Object.assign({accountIds:{get:function(){return Object.keys(a.accounts)}},subscriptionIds:{get:function(){return Object.keys(a.subscriptions)}}},e)),this.selectAccount=function(e,t){e&&(a.account=a.accounts[e],r.Local.set(c,a.account),t&&(s.subscription={},r.Local.remove(u)),a.account&&a.account.subscriptions&&1===a.account.subscriptions.length&&a.selectSubscription(a.account.subscriptions[0]))},this.selectSubscription=function(e,t){e&&(a.subscription=a.subscriptions[e],r.Local.set(u,a.subscription),t&&n.reload())},this.updateAccountSettings=function(){return a.savingSettings=!0,t.update(a.account).then(function(){r.Local.set(c,a.account),a.savingSettings=!1}).catch(function(){a.savingSettings=!1})}}]},{}],565:[function(e,t,n){"use strict";t.exports={templateUrl:" /templates/enterprise-account-admin/users.html",controller:"EnterpriseAccountAdminController"}},{}],566:[function(e,t,n){"use strict";t.exports={templateUrl:" /templates/enterprise-account-admin/settings.html",controller:"EnterpriseAccountAdminController"}},{}],567:[function(e,t,n){"use strict";var r=e("../../common/app"),i="/enterprise/admin",o={Settings:i+"/settings",Users:i+"/users"},a=new RegExp("/enterprise/admin");location.pathname.match(a)&&r.config(["$locationProvider",function(e){e.html5Mode(!0)}]),r.config(["$routeProvider",function(e){e.when(i,{redirectTo:o.Users}),e.when(o.Settings,{template:"<cl-enterprise-account-settings></cl-enterprise-account-settings>",name:"Settings"}),e.when(o.Users,{template:"<cl-enterprise-account-users></cl-enterprise-account-users>",name:"Users"})}]),r.run(["$route",function(e){e.reload()}]),r.constant("Routes",o),r.controller("EnterpriseAccountAdminController",e("./enterpriseAccountAdminController")),r.service("EnterpriseAccountAdminService",e("./enterpriseAccountAdminService")),r.component("clEnterpriseAccountAdmin",e("./enterpriseAccountAdmin")),r.component("clEnterpriseAccountSelector",e("./accountSelector")),r.component("clSubscriptionSelector",e("./subscriptionSelector")),r.component("clEnterpriseAccountSettings",e("./enterpriseAcountSettings")),r.component("clEnterpriseAccountUsers",e("./enterpriseAccountUsers"))},{"../../common/app":70,"./accountSelector":561,"./enterpriseAccountAdmin":562,"./enterpriseAccountAdminController":563,"./enterpriseAccountAdminService":564,"./enterpriseAccountUsers":565,"./enterpriseAcountSettings":566,"./subscriptionSelector":568}],568:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/enterprise-account-admin/subscription-selector.html",controller:["EnterpriseAccountAdminService",function(e){this.service=e}]}},{}],569:[function(e,t,n){"use strict";t.exports=["$timeout",function(t){return{restrict:"A",scope:{pricing:"=clAltPricing",isFlat:"=clIsFlatRate"},link:function(e){e.$watch("isFlat",function(){t(function(){e.pricing.pricePer&&e.isFlat?e.pricing.pricePer=null:e.pricing.priceFlat&&!e.isFlat&&(e.pricing.priceFlat=null)})})}}}]},{}],570:[function(e,t,n){"use strict";var a=e("underscore"),s=e("uuid"),c=["monthly","quarterly","bi-yearly","yearly"];t.exports={templateUrl:"/templates/enterprise-product-pricing/main.html",bindings:{pricing:"<"},controller:["$scope","$timeout","toastr",function(n,r,t){var i=this,o=(angular.extend(this,{add:function(){var e=void 0;try{e={id:s.v4(),pricePer:2e4,payPeriod:"",seatRange:{start:5,end:25}}}catch(e){return void t.error(e&&e.message)}i.pricing.push(e)},remove:function(t){i.pricing=a.filter(i.pricing,function(e){return e!==t})},payPeriods:c}),n.pricingResolved=!1,this);o.$onInit=function(){},o.$onChanges=function(e){var t;(t=e).pricing&&Array.isArray(t.pricing.currentValue)&&r(function(){o.pricing=e.pricing.currentValue,n.pricingResolved=!0},1e3)}}]}},{underscore:void 0,uuid:65}],571:[function(e,t,n){"use strict";var r=e("../../common/app");r.component("clEnterpriseProductPricing",e("./enterpriserProductPricing")),r.directive("clClearAltPricing",e("./clearAltPricing"))},{"../../common/app":70,"./clearAltPricing":569,"./enterpriserProductPricing":570}],572:[function(e,t,n){"use strict";e("../../common/app").directive("enterpriseProvider",e("./provider"))},{"../../common/app":70,"./provider":573}],573:[function(e,t,n){"use strict";t.exports=["EnterpriseService","SubscriptionService",function(a,s){return{restrict:"A",link:function(t,e,n){var r=[];function i(){n.clAccountId?a.get(n.clAccountId).then(o):n.clAccountName?a.getAccountByName(n.clAccountName).then(o):n.clProductId?a.getEnterpriseProductById(n.clProductId).then(o):n.clSubscriptionId?a.getFromSubscription(n.clSubscriptionId).then(o):n.clSubscriptionSlug&&s.getSubscriptionBySlug(n.clSubscriptionSlug).then(function(e){return a.getFromSubscription(e._id)}).then(o)}function o(e){t[n.clEnterpriseKey||"enterpriseAccount"]=e,!0!==n.watch&&angular.forEach(r,function(e){e()})}angular.forEach(["clAccountId","clAccountName","clProductId","clSubscriptionId","clSubscriptionSlug"],function(e){e=n.$observe(e,i);r.push(e)})}}}]},{}],574:[function(e,t,n){"use strict";var f=e("underscore");t.exports=["$filter","deepval","i18n",function(l,e,d){return{restrict:"E",templateUrl:"/templates/error-page/main.html",link:function(e,u,t){var n,t=t.statusCode||"404",r="error-page-"+t,i=d.strings,o=null,a=null;function s(e){e=r+"-"+e;return a&&(e+="-"+a),l("i18n")(e)}function c(e,t,n){return new RegExp(r+"-"+n+"-"+t).test(e)}angular.isObject(i)&&(o=f.chain(i).keys().filter(function(e){return new RegExp(r+"-[a-zA-Z]+-\\d").test(e)}).value(),n=f.groupBy(o,function(e){return e.charAt(e.length-1)}),Object.keys(n).forEach(function(e){!function(e,t){if(!Array.isArray(e)||0===e.length)return!1;var n=!1,r=!1,i=!1;return e.forEach(function(e){t=e.charAt(e.length-1),/message/.test(e)?n=c(e,t,"message"):/quote/.test(e)?r=c(e,t,"quote"):/author/.test(e)&&(i=c(e,t,"author"))}),n&&r&&i}(n[e],e)&&delete n[e]}),o=f.keys(n),a=o[function(e){e=e.length-1;return Math.round(Math.random()*e+0)}(o)]),angular.extend(e,{statusCode:t,quote:s("quote"),author:s("author"),message:s("message")})}}}]},{underscore:void 0}],575:[function(e,t,n){"use strict";e("../../common/app").directive("clErrorPage",e("./directive"))},{"../../common/app":70,"./directive":574}],576:[function(e,t,n){"use strict";function r(e,t){if(e.baseModel){try{e.content=(n=e.baseModel,{isLiveNow:t.isEventLiveNow(n),short_title:t.getEventShortTitle(n),image:t.getEventImage(n),_id:n._id,flagged:{allow_enrollment:t.isEventEnrollable(n)},instructors:t.getEventInstructors(n),title:t.getEventTitle(n),url:t.getEventUrl(n),primary_category:t.getEventCategory(n),content_type:"event",broadcasts:n.swimlanes[0].broadcasts,has_live:n.hasLiveBroadcasts,is_new:t.getEventIsNew(n),liveStartTime:n.liveStartTime,start_time:n.start_time,end_time:n.end_time})}catch(e){}var n;e.reInit=!0}}r.$inject=["$scope","EventService"],t.exports=r},{}],577:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/event/hero-cms.html",replace:!0,link:function(e,t,n){e.config=r,e.isAdmin="true"===n.isAdmin,e.edit=e.$parent.edit,e.data||(e.data=e.$parent.data||n.data&&JSON.parse(n.data))}}}]},{}],578:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/event/hero-edit.html",replace:!0,link:function(e,t,n){e.data=e.$parent.data}}}]},{}],579:[function(e,t,n){"use strict";t.exports=["$timeout","EventService",function(o,n){return{restrict:"AE",link:function(i,e,t){""!==t.eventIsLive&&n.getEventById(t.eventIsLive).then(function(e){!function e(t){var n=Math.round(new Date/1e3);var r=t.start_time<=n&&t.end_time>=n;i.isLive=r;n<t.start_time&&(r=t.start_time-n,o(function(){e(t)},r))}(e)})}}}]},{}],580:[function(e,t,n){"use strict";t.exports=["$rootScope","$window","EventService","mediaResource","deepval",function(c,o,u,l,d){return{restrict:"AE",templateUrl:"/templates/event/materials.html",scope:{eventId:"@",requiredAccess:"@?"},replace:!0,controller:["$scope",function(t){angular.extend(t,{materials:[],onDownload:function(e){l.token({token:e.token}).$promise.then(function(e){try{o.location.href=e.data.playUrl}catch(e){}})}}),c.$on("user:follow",i);var n,a,r=t.$watch("eventId",function(e){if(!e)return!1;u.getEventById(e).then(function(e){n=d(e||{},"product.source.source_type"),a=d(e||{},"product.source.source_id"),u.getMaterials(t.eventId).then(function(e){s=e,r(),i()})})}),s=[];function i(){if(!t.eventId||!s.length)return!1;c.user.isFollowing("event",{entityId:t.eventId}).then(e,e)}function e(r){var i=[],o=!1,e=(n&&a&&(o=c.user.hasContent("purchased",n,a)),t.requiredAccess);angular.forEach(s,function(n){e&&n.required_access!==e||angular.forEach(n.media,function(e){var e=angular.copy(e),t=!0;(t=c.user&&c.user.valid()&&("purchase"!==n.required_access||o)&&("enroll"!==n.required_access||r)?t:!1)?e.permission=!0:(e.permission=!1,delete e.token),i.push(e)})}),t.materials=[{media:i}]}}]}}]},{}],581:[function(e,t,n){"use strict";function r(c,u,l,d,e,f,p,h){return{restrict:"AE",templateUrl:"/templates/event/player.html",scope:{eventId:"@",mediaId:"@",posterUrl:"@",showChatButton:"@",autoplay:"@?",autoplayVolume:"@?"},replace:!0,link:function(i,e,t){var n=i.$watch("eventId",function(){i.eventId&&(i.$on("videojs-player:ready-for-event-promo",function(e){a=!0,e.preventDefault(),e.stopPropagation(),s()}),u.getEventById(i.eventId).then(function(e){e&&(i.event=e,p.addVideoPlayer(i.eventId,i),i.event&&!i.event.live&&(e=Math.round(new Date/1e3),e=i.event.start_time-e,d(function(){i.event.live=!0},e)))}).then(function(){s()}),n())}),r=i.$watch("mediaId",function(e){e&&(r(),s())}),o=i.$watch("posterUrl",function(e){e&&(o(),s())}),a=!1;function s(){return!i.isBroadcasting&&(i.mediaId?void(a&&i.posterUrl&&f.tokenById({id:i.mediaId},function(e){if(e.data&&e.data.playUrl){if(i.isBroadcasting)return!1;e={playUrl:e.data.playUrl,posterUrl:i.posterUrl};l.$broadcast("video:queue",e)}else l.$broadcast("video:show-poster")})):l.$broadcast("video:show-poster"))}i.showChatButton="true"===i.showChatButton||!1,i.$on("video:stream:pause",s),i.$on("video:stream",function(e,t,n){var r={event_id:i.event._id},t=(r.action=t.autoplay?"autoplay":"play",u.getEventBroadcastData(i.event));c.each(t.all,function(e){u.isCurrentlyStreaming(e)&&(r.access_type=e.broadcast_type)}),h.trackOnAirPlay(r)})}}}r.$inject=["_","EventService","$rootScope","$timeout","$document","mediaResource","videoPlayerFactory","trackFactory"],t.exports=r},{}],582:[function(e,t,n){"use strict";t.exports=["EventService","moment","_",function(s,c,u){return{restrict:"AE",link:function(n,e,r){var i=r.clEventProviderKey||"clEvent",o=r.clEventDataProviderKey||"clEventData";function t(e){var t;n[i]=e,r.clDebug,n.clEventProviderReady=!0,r.clEventId&&(n[o]=n[i].EventService.byEventId[r.clEventId],e=n[o].swimlanes[0],t=c().unix(),u.each(e.broadcasts,function(e){e.start_time<=t&&e.end_time>t&&(n[o].currentBroadcast=e)}))}function a(e){n[i]={clEventProviderError:!0,error:e}}("upcoming"===r.clEventProvider?s.getUpcomingEvents().then(function(e){t({EventService:s,events:e})}):s.fetch().then(function(){t({EventService:s})})).catch(a)}}}]},{}],583:[function(e,t,n){"use strict";t.exports=["EventService",function(e){return{restrict:"AE",templateUrl:"/templates/course-stats/view.html",scope:{eventId:"@"},replace:!0,link:function(t){var n=t.$watch("eventId",function(){e.Resource.counts({id:t.eventId}).$promise.then(function(e){t.counts=e.data,n()})})}}}]},{}],584:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService","broadcastService",function(i,o,a){return{restrict:"AE",link:function(r,e,t){r.currentLaneIdx=0;var n=t.$observe("eventId",function(){o.getEventById(t.eventId).then(function(e){e&&(r.event=e,_.each(r.event.swimlanes,function(t){var n=new a({onBroadcastStart:function(e){n.getUpdatedData().then(function(e){t.course=e.currentBroadcast,t.nextCourse=e.nextBroadcast,t.prevCourse=e.prevBroadcast,r.$applyAsync()})}});n.setBroadcasts(t.broadcasts),n.getUpdatedData().then(function(e){t.course=e.currentBroadcast,t.nextCourse=e.nextBroadcast,t.prevCourse=e.prevBroadcast,r.$applyAsync()})}))}),n()});i.$on("swimlane:select",function(e,t){r.currentLaneIdx=t.index})}}}]},{}],585:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("eventIsLive",e("./directives/isLive")),r.directive("eventMaterials",e("./directives/materials")),r.directive("eventPlayer",e("./directives/player")),r.directive("eventStats",e("./directives/stats")),r.directive("eventSwimlaneProvider",e("./directives/swimlaneProvider")),r.directive("clEventProvider",e("./directives/provider")),r.directive("eventPlayerHeroCms",e("./directives/hero-cms")),r.directive("eventPlayerHeroCmsEdit",e("./directives/hero-edit")),r.controller("eventContentController",e("./controllers/event-content"))},{"../../common/app":70,"./controllers/event-content":576,"./directives/hero-cms":577,"./directives/hero-edit":578,"./directives/isLive":579,"./directives/materials":580,"./directives/player":581,"./directives/provider":582,"./directives/stats":583,"./directives/swimlaneProvider":584}],586:[function(e,t,n){"use strict";t.exports=["ExportImportService",function(r){return{restrict:"AE",replace:!0,transclude:!0,scope:{getData:"&",onImport:"&"},template:function(e,t){return"export"===t.template?'<a download="{{ filename }}" ng-href="{{ url }}" ng-mousedown="onExport($event)" ng-transclude></a>':'<label for="fileImport"><span ng-transclude></span><input id="fileImport" class="file-import hide" type="file"></label>'},link:function(t,e,n){angular.extend(t,{onExport:function(e){e.preventDefault(),t.getData().then(function(e){if(!e)return!1;r.exportJson(e.json,e.filename).then(function(e){t.filename=e.filename,t.url=e.url})})}}),angular.element(e[0].querySelectorAll(".file-import")).bind("change",function(e){e=e.target.files&&e.target.files[0];r.importJson(e).then(function(e){t.onImport({json:e})})})}}}]},{}],587:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("ExportImportService",e("./services/exportImport")),r.directive("exportImport",e("./directives/exportImport"))},{"../../common/app":70,"./directives/exportImport":586,"./services/exportImport":588}],588:[function(e,t,n){"use strict";t.exports=["$q","$timeout",function(o,a){return{exportJson:function(e,t){var n=o.defer(),r=window.URL||window.webkitURL,e=angular.copy(e),e=(e._id=void 0,e.created=void 0,e.modified=void 0,JSON.stringify(e)),i=new Blob([e],{type:"application/json"}),e=r.createObjectURL(i);return n.resolve({filename:t,url:e}),a(function(){r.revokeObjectURL(i)},1e3),n.promise},importJson:function(e,t){var n=o.defer(),r=new FileReader;return r.onload=function(e){try{var t=JSON.parse(e.target.result);n.resolve(t)}catch(e){n.reject("Error parsing json",e)}},r.onerror=n.reject,r.readAsText(e),n.promise}}}]},{}],589:[function(e,t,n){"use strict";t.exports=["config","instructorResource","arrayMove",function(e,n,s){return{restrict:"AE",scope:{tagline:"=?",headline:"="},templateUrl:"/templates/facepile/edit.html",replace:!0,link:function(a,e,t){a.data=a.$parent.data,a.config=a.config,a.data.instructors||(a.data.instructors=[]),a.data.template||(a.data.template="facepile"),a.addTile=function(){n.findBySlug({slug:a.instructorOnDeck.slug},function(e){e=e.data,e={_id:e._id,slug:e.slug,name:e.profile.name,image:e.profile.image,tagline:a.tagline};"carousel-with-class"===a.data.template&&a.courseOnDeck&&(e.courseSlug=a.courseOnDeck.slug,e.courseTitle=a.courseOnDeck.short_title,e.isNewInstructor=a.isNewInstructor),void 0!==a.editingTile?(delete e.image,angular.extend(a.instructorOnDeck,e),a.data.instructors[a.editingTile]=a.instructorOnDeck):a.data.instructors.push(e),a.tagline="",a.instructorOnDeck=void 0,a.courseOnDeck=void 0,a.editingTile=void 0,a.image=e.image,a.isNewInstructor=void 0})},a.editTile=function(e,t){a.editingTile=t,a.tagline=e.tagline,a.image=e.image,(a.instructorOnDeck=e).courseSlug?a.courseOnDeck={slug:e.courseSlug,short_title:e.courseTitle}:a.courseOnDeck=void 0,a.isNewInstructor=e.isNewInstructor},a.remove=function(e){a.data.instructors.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{}],590:[function(e,t,n){"use strict";t.exports=["$sce","config",function(r,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/facepile/view.html",replace:!0,link:function(e,t,n){e.config=i,e.data||(e.data=e.$parent.data),e.data&&(r.trustAsResourceUrl(e.data.courseUrl),r.trustAsResourceUrl(e.data.image))}}}]},{}],591:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("facepile",e("./directives/view")),r.directive("facepileEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":589,"./directives/view":590}],592:[function(e,t,n){"use strict";t.exports=["$rootScope","$window","AnalyticsService",function(n,e,r){return{restrict:"AE",scope:{moduleSlug:"@",clModuleId:"@"},templateUrl:"/templates/follow-count/index.html",link:function(e){function t(){e.count=i(n.user.get("follows"),"topic.length")}angular.extend(e,{trackTopicClick:function(){r.getModuleLocation(e.moduleSlug)}}),t(),e.$on("user:follow",t)}}}];var i=e("deepval")},{deepval:38}],593:[function(e,t,n){"use strict";e("../../common/app").directive("clFollowCount",e("./directives/index"))},{"../../common/app":70,"./directives/index":592}],594:[function(e,t,n){"use strict";function r(i,t,n,o){return{restrict:"AE",scope:{},templateUrl:function(e,t){return"/templates/followed/instructor-class-list.html"},controllerAs:"ctrl",controller:["$scope","$attrs",function(r,e){angular.extend(r,{followedInstructors:[]}),t.user.valid()&&t.user.getFollows().then(function(e){return e.success?e.data?void Promise.all([o.findByIds({ids:e.data.instructor,bff:!0}),n.getCoursesByInstructors(e.data.instructor)]).then(function(e){var t=e[0],n=e[1];i.each(t,function(e){n[e._id]&&(e.courses=n[e._id])}),r.followedInstructors=t}):new Error("getFollows error: no data"):new Error("getFollows error: "+e.message)})}]}}r.$inject=["_","$rootScope","CatalogService","InstructorService"],t.exports=r},{}],595:[function(e,t,n){"use strict";e("../../common/app").directive("followedInstructors",e("./directives/instructors"))},{"../../common/app":70,"./directives/instructors":594}],596:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/form/country.html",require:{ngModelCtrl:"^ngModel"},bindings:{ngModel:"<",tabIndex:"@",ngDisabled:"<",isError:"<"},controller:["Countries","$attrs",function(e,t){var n=this;angular.extend(this,{$onInit:function(){angular.extend(n,{countries:e,tabIndex:n.tabIndex||1,required:t.required||!1,isError:{}})},$doCheck:function(){n.ngModel!==n.ngModelCtrl.$viewValue&&(n.ngModelCtrl.$setViewValue(n.ngModel),n.ngModelCtrl.$render())},$onChanges:function(e){e.ngDisabled&&e.ngDisabled.previousValue&&e.ngDisabled.previousValue!==e.ngDisabled.currentValue&&(n.ngDisabled=e.ngDisabled.currentValue);e.isError&&e.isError.previousValue&&e.isError.previousValue!==e.isError.currentValue&&(n.isError.error=e.isError.currentValue.error,n.isError.message=e.isError.currentValue.message)},ngDisabled:n.ngDisabled||!1})}]}},{}],597:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/form/cvv.html",require:{ngModelCtrl:"^ngModel"},bindings:{ngModel:"<",tabIndex:"@",ngDisabled:"<",isError:"<"},controller:["$attrs",function(e){var t=this;angular.extend(this,{$onInit:function(){angular.extend(t,{tabIndex:t.tabIndex||1,required:e.required||!1,isError:{}})},$doCheck:function(){t.ngModel!==t.ngModelCtrl.$viewValue&&(t.ngModelCtrl.$setViewValue(t.ngModel),t.ngModelCtrl.$render())},$onChanges:function(e){e.ngDisabled&&e.ngDisabled.previousValue&&e.ngDisabled.previousValue!==e.ngDisabled.currentValue&&(t.ngDisabled=e.ngDisabled.currentValue);e.isError&&e.isError.previousValue&&e.isError.previousValue!==e.isError.currentValue&&(t.isError.error=e.isError.currentValue.error,t.isError.message=e.isError.currentValue.message)},ngDisabled:t.ngDisabled||!1})}]}},{}],598:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/form/month.html",require:{ngModelCtrl:"^ngModel"},bindings:{ngModel:"<",tabIndex:"@",ngDisabled:"<",isError:"<"},controller:["$attrs",function(e){var t=this;angular.extend(this,{$onInit:function(){angular.extend(t,{tabIndex:t.tabIndex||1,required:e.required||!1,isError:{}})},$doCheck:function(){t.ngModel!==t.ngModelCtrl.$viewValue&&(t.ngModelCtrl.$setViewValue(t.ngModel),t.ngModelCtrl.$render())},$onChanges:function(e){e.ngDisabled&&e.ngDisabled.previousValue&&e.ngDisabled.previousValue!==e.ngDisabled.currentValue&&(t.ngDisabled=e.ngDisabled.currentValue);e.isError&&e.isError.previousValue&&e.isError.previousValue!==e.isError.currentValue&&(t.isError.error=e.isError.currentValue.error,t.isError.message=e.isError.currentValue.message)},ngDisabled:t.ngDisabled||!1})}]}},{}],599:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/form/state.html",require:{ngModelCtrl:"^ngModel"},bindings:{ngModel:"<",tabIndex:"@",countryCode:"=",ngDisabled:"<",isError:"<"},controller:["States","Provinces","$attrs",function(e,t,n){var r=this;angular.extend(this,{$onInit:function(){angular.extend(r,{states:e,provinces:t,tabIndex:r.tabIndex||1,required:n.required||!1,isError:{},selectedState:{code:"",name:""},inputState:""}),r.ngModelCtrl.$setViewValue(r.selectedState),r.ngModelCtrl.$render()},$doCheck:function(){"US"!==r.countryCode&&"CA"!==r.countryCode?r.selectedState={code:"",name:r.inputState||""}:r.selectedState||(r.selectedState={code:"",name:""});r.ngModelCtrl.$viewValue&&r.selectedState.name!==r.ngModelCtrl.$viewValue.name&&(r.ngModelCtrl.$setViewValue(r.selectedState),r.ngModelCtrl.$render())},$onChanges:function(e){e.ngDisabled&&e.ngDisabled.previousValue&&e.ngDisabled.previousValue!==e.ngDisabled.currentValue&&(r.ngDisabled=e.ngDisabled.currentValue);e.isError&&e.isError.previousValue&&e.isError.previousValue!==e.isError.currentValue&&(r.isError.error=e.isError.currentValue.error,r.isError.message=e.isError.currentValue.message)},ngDisabled:!0})}]}},{}],600:[function(e,t,n){"use strict";t.exports={templateUrl:"/templates/form/year.html",require:{ngModelCtrl:"^ngModel"},bindings:{ngModel:"<",tabIndex:"@",ngDisabled:"<",isError:"<"},controller:["Years","$attrs",function(e,t){var n=this;angular.extend(this,{$onInit:function(){angular.extend(n,{years:e,tabIndex:n.tabIndex||1,required:t.required||!1,isError:{}})},$doCheck:function(){n.ngModel!==n.ngModelCtrl.$viewValue&&(n.ngModelCtrl.$setViewValue(n.ngModel),n.ngModelCtrl.$render())},$onChanges:function(e){e.ngDisabled&&e.ngDisabled.previousValue&&e.ngDisabled.previousValue!==e.ngDisabled.currentValue&&(n.ngDisabled=e.ngDisabled.currentValue);e.isError&&e.isError.previousValue&&e.isError.previousValue!==e.isError.currentValue&&(n.isError.error=e.isError.currentValue.error,n.isError.message=e.isError.currentValue.message)},ngDisabled:n.ngDisabled||!1})}]}},{}],601:[function(e,t,n){"use strict";t.exports=["PaymentCards",function(l){return{restrict:"E",templateUrl:"/templates/form/clCcFormatDetect.html",link:function(s,e,t){var n,c=l,e=angular.element(e.find("input")[0]);function r(e){return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(e=String.fromCharCode(e.which),!!/[\d\s]/.test(e))))}function i(e){var t,n,r=$(e.currentTarget),e=String.fromCharCode(e.which);if(/^\d+$/.test(e)&&!(null!=(t=r).prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")||null!=("undefined"!=typeof document&&null!==document&&null!=(n=document.selection)?n.createRange:void 0)&&document.selection.createRange().text))return(n=u(t=(r.val()+e).replace(/\D/g,"")))?t.length<=n.length[n.length.length-1]:t.length<=16}function o(e){var t,n,r,i,o,a=String.fromCharCode(e.which);if(/^\d+$/.test(a)&&(t=$(e.currentTarget),n=u((o=t.val())+a),r=(o.replace(/\D/g,"")+a).length,i=16,!((i=n?n.length[n.length.length-1]:i)<=r||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==o.length)))return(i=n&&"amex"===n.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(o)?(e.preventDefault(),setTimeout(function(){var e=o+" "+a;t.val(e),s.paymentInfo.creditCard=e})):i.test(o+a)?(e.preventDefault(),setTimeout(function(){var e=o+a+" ";t.val(e),s.paymentInfo.creditCard=e})):void 0}function a(e){var o=$(e.currentTarget);return setTimeout(function(){var e,t,n,r=o.val(),r=function(e){var t,n;if(e=e.replace(/\D/g,""),!(t=u(e)))return e;{if(n=t.length[t.length.length-1],e=e.slice(0,n),t.format.global)return null!=(n=e.match(t.format))?n.join(" "):void 0;if(null!=(n=t.format.exec(e)))return n.shift(),(n=$.grep(n,function(e){return e})).join(" ")}}(function(e){for(var t,n,r,i,o=0,a=(t=(e=null==e?"":e).split(i="")).length;o<a;o++)n=t[o],i+=n=-1<(r="".indexOf(n))?"0123456789"[r]:n;return i}(r)),i=o;try{t=i.prop("selectionStart")}catch(e){t=null}if(n=i.val(),i.val(r),null!==t&&i.is(":focus"))return t===n.length&&(t=r.length),n!==r&&(n=n.slice(t-1,+t+1||9e9),e=r.slice(t-1,+t+1||9e9),r=r[t],/\d/.test(r)&&n===r+" "&&e===" "+r&&(t+=1)),i.prop("selectionStart",t),i.prop("selectionEnd",t)})}function u(e){var t,n,r,i,o,a,s;for(e=(e+"").replace(/\D/g,""),r=0,o=c.length;r<o;r++)for(i=0,a=(s=(t=c[r]).patterns).length;i<a;i++)if(n=s[i],e.substr(0,(n=n+"").length)===n)return t}s.cardType=!1,s.$watch("paymentInfo.creditCard",function(){s.paymentInfo&&(n=u(s.paymentInfo.creditCard),s.cardType=!!n&&n.type)}),s.tabIndex=s.tabIndex||0,s.required=t.required||!1,s.isDisabled=t.isDisabled||!1,s.isError=t.isError||!1,s.errorMsg=t.errorMsg||"",t.$observe("isDisabled",function(e){s.isDisabled=e}),t.$observe("isError",function(e){s.isError=e}),t.$observe("errorMsg",function(e){s.errorMsg=e}),e.on("keypress",r),e.on("keypress",i),e.on("keypress",o),e.on("paste",a),e.on("change",a),e.on("input",a)}}}]},{}],602:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AC",require:"?ngModel",link:function(e,t,n,r){var i="input-filled",o=t&&t[0]&&t[0].tagName;function a(){var e;r&&s()&&(""!==(e=(e=r.$viewValue)||"")?t.addClass(i):t.removeClass(i),t.val(e))}function s(){return"INPUT"===o||"TEXTAREA"===o}r&&s()&&(r.$render=a,t.bind("focus",a),t.bind("blur",a),t.bind("change",a))}}}},{}],603:[function(e,t,n){"use strict";t.exports=function(){return{templateUrl:"/templates/form/credit-card.html",require:"^ngModel",link:function(t,e,n,r){t.required=n.required||!1,t.tabIndex=n.tabIndex||0,t.isDisabled=n.isDisabled||!1,t.isError=n.isError||!1,t.errorMsg=n.errorMsg||"",t.paymentInfo={creditCard:r.$viewValue},n.$observe("isDisabled",function(e){t.isDisabled=e}),n.$observe("isError",function(e){t.isError=e}),n.$observe("errorMsg",function(e){t.errorMsg=e}),t.$watch("paymentInfo.creditCard",function(e){e&&(r.$setViewValue(e),r.$render())})}}}},{}],604:[function(e,t,n){"use strict";function i(e){return(e/100).toFixed(2)}t.exports=function(){return{restrict:"A",require:"ngModel",link:["$scope","$element","$attrs","ngModelCtrl",function(e,t,n,r){r.$parsers.push(function(e){return 100*e}),r.$render=function(){t.val(i(r.$viewValue))},t.on("change",i)}]}}},{}],605:[function(e,t,n){"use strict";var s=e("underscore");t.exports=["$rootScope",function(a){return{restrict:"AC",require:"?ngModel",link:function(e,t,n,r){var i;function o(e){}r&&(i=function(){""!==r.$viewValue&&r.$viewValue?a.user.checkValidEmail(r.$viewValue).then(function(e){e.success&&(e.data?r.$setValidity("emailExist",!1):r.$setValidity("emailExist",!0))},o):r.$setValidity("emailExist",!0)},i=s.debounce(i,300),t.bind("change",i),t.bind("keyup",i),t.bind("blur",i),e.$on("$$destroy",function(){t.unbind("keyup change blur",i)}),a.$on("cl-form:verify-email",function(){i()}))}}}]},{underscore:void 0}],606:[function(e,t,n){"use strict";t.exports=["$log",function(s){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var i,n=n["cl-email-ref"],o="Missing cl-email-ref attribute",a="cl-business-email requires cl-email-ref attribute to function.";n?(n=n.split("@"),n&&n.length||s.error(o,a),i=n[1],r.$parsers.unshift(function(e){!i||(e=e.split("@"))&&e.length&&(e=e[1],r.$setValidity("sameBusinessEmail",e===i))}),r.$formatters.unshift(function(e){if(!i)return e;var t=e.split("@");if(!t||!t.length)return e;t=t[1];return r.$setValidity("sameBusinessEmail",t===i),e})):s.error(o,a)}}}]},{}],607:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"E",templateUrl:"/templates/form/message.html",scope:{model:"=",modelConfirm:"=",message:"=",sideAlert:"=",color:"=",textClass:"@",icon:"@",defaultIcon:"@",type:"@"},link:function(e,t,n){e.invalidEmailFormat=function(){return!e.model.$error.emailExist&&e.model.$invalid&&!e.emptyInput()},e.emailExist=function(){return e.model.$error.emailExist&&!e.emptyInput()},e.emptyInput=function(){return""===e.model.$viewValue||!e.model.$dirty&&!e.model.$viewValue},e.validInput=function(){return e.model.$valid&&!e.emptyInput()},e.invalidInput=function(){return e.model.$invalid&&!e.emptyInput()},e.largeIcon=void 0!==n.largeIcon,e.textClass=e.textClass||"text-left"}}}]},{}],608:[function(e,t,n){"use strict";t.exports=["$rootScope",function(){return{restrict:"A",require:"?ngModel",scope:{clFormModelMatch:"="},link:function(e,t,n,r){function i(){""!==r.$viewValue&&r.$dirty&&r.$viewValue!==e.clFormModelMatch.$viewValue?r.$setValidity("match",!1):r.$setValidity("match",!0)}r&&(t.bind("input change blur",i),e.$on("$$destroy",function(){t.unbind("input change blur",i)}))}}}]},{}],609:[function(e,t,n){"use strict";t.exports=function(){return{require:"ngModel",link:function(e,t,n,r){var i=/^[\W]*([\w+\-.%]+@[\w\-.]+\.[A-Za-z]{2,4}[\W]*,{1}[\W]*)*([\w+\-.%]+@[\w\-.]+\.[A-Za-z]{2,4})[\W]*$/;r.$parsers.unshift(function(e){if(i.test(e))return r.$setValidity("multipleEmails",!0),e;r.$setValidity("multipleEmails",!1)})}}}},{}],610:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clFormControl",e("./directives/control")),r.directive("clFormMessage",e("./directives/message")),r.directive("clFormModelMatch",e("./directives/modelMatch")),r.directive("clFormEmailValidation",e("./directives/emailValidation")),r.directive("clFormCreditCard",e("./directives/credit-card")),r.directive("clCcFormatDetect",e("./directives/clCcFormatDetect")),r.directive("clSameBusinessEmail",e("./directives/isSameBusinessEmail")),r.directive("clMultipleEmails",e("./directives/multipleEmails")),r.directive("dollarsToCents",e("./directives/dollarsToCents")),r.component("clFormCvv",e("./components/cvv")),r.component("clFormMonth",e("./components/month")),r.component("clFormYear",e("./components/year")),r.component("clFormCountry",e("./components/country")),r.component("clFormState",e("./components/state"))},{"../../common/app":70,"./components/country":596,"./components/cvv":597,"./components/month":598,"./components/state":599,"./components/year":600,"./directives/clCcFormatDetect":601,"./directives/control":602,"./directives/credit-card":603,"./directives/dollarsToCents":604,"./directives/emailValidation":605,"./directives/isSameBusinessEmail":606,"./directives/message":607,"./directives/modelMatch":608,"./directives/multipleEmails":609}],611:[function(e,t,n){"use strict";t.exports=["constants",function(r){return{restrict:"AE",scope:{},templateUrl:"/templates/freeform/edit.html",replace:!0,link:function(e,t,n){angular.extend(e,{constants:r,data:e.$parent.data}),e.data.templates||(e.data.templates=[]),void 0===e.data.renderHtml&&(e.data.renderHtml=!0)}}}]},{}],612:[function(e,t,n){"use strict";t.exports=["$compile","trackFactory",function(r,i){return{restrict:"AE",scope:{data:"=?",useParentData:"<?"},templateUrl:"/templates/freeform/view.html",replace:!0,link:function(t,n,e){t.isAdmin="true"===e.isAdmin,angular.extend(t,{trackFactory:i}),t.data||(t.data=t.$parent.data||{}),t.isAdmin&&!1===t.data.renderHtml?t.htmlContent='<div class="module-placeholder">Freeform '+t.data.name+"</div>":(t.data.freeFormModuleId=e.clModuleId,t.$watch("data.content",function(){try{var e=angular.element(t.data.content);n.empty().append(e),t.useParentData?r(e)(t.$parent):r(e)(t)}catch(e){t.$parent.edit}}))}}}]},{}],613:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("freeform",e("./directives/view")),r.directive("freeformEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":611,"./directives/view":612}],614:[function(e,t,n){"use strict";var i=e("underscore");t.exports=["$scope","$location","$routeParams","galleryResource",function(n,e,r,t){n.type=n.type||e.url().split("/")[1].slice(0,-1),n.slug=r.slug,n.gallery=t.getList({type:n.type,slug:n.slug}).$promise.then(function(e){n.gallery=e.data}),n.$watch("gallery",function(e){var t;e&&e.images&&-1<(t=i.chain(e.images).pluck("_id").indexOf(r.photoId).value())&&n.$applyAsync(function(){n.image=e.images[t]})},!0)}]},{underscore:void 0}],615:[function(e,t,n){"use strict";t.exports=["$scope","$uibModalInstance",function(e,t){e.cancel=function(){t.dismiss("cancel")}}]},{}],616:[function(e,t,n){"use strict";t.exports=["$filter","$location","GalleryUploaderService",function(e,t,i){return{restrict:"EA",templateUrl:"/templates/galleries/fileUpload.html",scope:{onFile:"&",errors:"="},replace:!0,link:function(t,n,e){function r(){i.getDataUri(t.files[0]).then(function(e){t.imageSource=e.result,t.onFile()(t.files)},function(e){t.errors=e})}t.label=e.label||"Share your work with the community",t.icon=e.icon||"cl-icon-font cl-icon-cloud",t.imageSource=void 0,t.files=[],t.openFileDialog=function(){n.find("input").click()};e=n[0].querySelector("#fileInput"),angular.element(e).bind("change",function(e){e.target.files&&(t.files=e.target.files,r())}),e=angular.element(document.body);e.bind("dragenter dragover",function(e){e.preventDefault(),e.stopPropagation(),n.addClass("active")}),e.bind("dragend dragleave",function(e){e.preventDefault(),e.stopPropagation(),n.removeClass("active")}),e.bind("drop",function(e){e.preventDefault(),e.stopPropagation(),n.removeClass("active");e=e.originalEvent||e;e.dataTransfer&&e.dataTransfer.files&&(t.files=e.dataTransfer.files,r())})}}}]},{}],617:[function(e,t,n){"use strict";var u=e("underscore");t.exports=["$rootScope","AnalyticsService","galleryResource","keyboard","deepval","cacheClear",function(n,i,o,a,s,c){return{restrict:"EA",templateUrl:function(e,t){return t.template?"/templates/galleries/"+t.template+".html":"/templates/galleries/galleryComments.html"},scope:{image:"="},replace:!0,link:function(r,e,t){r.$watch("image",function(){r.displayComment=!1}),"true"===t.allowKeyboard&&a.on("comment",a.EVENTS.ENTER,function(e){e.preventDefault(),r.addComment()}),r.addComment=function(){var e;r.newComment&&(e={text:r.newComment,image_id:r.image._id},r.displayComment=!1,o.comment(e).$promise.then(function(e){var t;e.success&&(r.image.comments.push(e.data),i.track("Gallery Submit Comment",{cta_label:"submit_comment",cta_item_id:r.image._id}),e=s(r,"image.courses.0.slug"),t=s(r,"image.owner.user.slug"),c.clearGalleryUser(t),c.clearGalleryCourse(e),r.clearComment())}))},r.clearComment=function(){r.newComment=""},r.removeComment=function(n){o.removeComment({comment_id:n}).$promise.then(function(e){var t;e.success&&(r.image.comments=u.reject(r.image.comments,function(e){return e._id===n}),e=s(r,"image.courses.0.slug"),t=s(r,"image.owner.user.slug"),c.clearGalleryUser(t),c.clearGalleryCourse(e))})},r.$watch(function(){return n.user},function(){r.placeholder=n.user.valid()?"Leave a comment ...":"Please log in to comment ..."})}}}]},{underscore:void 0}],618:[function(e,t,n){"use strict";var o=e("underscore");t.exports=["AnalyticsService","CourseService",function(t,i){return{restrict:"EA",templateUrl:"/templates/galleries/galleryDetail.html",replace:!0,scope:{gallery:"=",image:"=",type:"@",imageWidth:"@",imageHeight:"@"},link:function(n){n.ready=!1;function r(){n.alt=(n.image.title||"Gallery Image")+" by "+(n.image.owner.display_name||"a CreativeLive student"),n.course&&n.topics&&(n.alt+=" for "+n.course.title+" in "+n.topics)}n.imageLoaded=function(){var e,t;0<n.image.courses.length?(e=n.image.courses[0]._id,t=function(e){n.course=e,n.topics=function(e){e=o.compact(o.map(e.taxonomy,function(e){if(e.topic)return e.topic.name}));return e.slice(0,-2).join(", ")+(e.slice(0,-2).length?", ":"")+e.slice(-2).join(" and ")}(e),r()},i.findById(e,null,{allow:"unpublished"}).then(function(e){t(e)})):r(),n.$applyAsync(function(){n.ready=!0})},n.onUserClick=function(e){e.preventDefault(),setTimeout(function(){window.location="/users/"+n.image.owner.user.slug},120),t.track("Gallery Tap Profile Icon",{cta_item_id:n.image._id,cta_label:"profile_submitter"})}}}}]},{underscore:void 0}],619:[function(e,t,n){"use strict";function r(n,e,r){n.cancel=e.dismiss,n.onSubmit=function(){var e,t=n.image;(t._id||t.title||t.description)&&(e={id:t._id},t.title&&(e.title=t.title),t.description&&(e.description=t.description),r.updateImage(e).$promise.then(function(e){e.success&&n.cancel()}))}}t.exports=["$uibModal","galleryResource",function(t){return{templateUrl:"/templates/galleries/galleryEditButton.html",replace:!0,link:function(e){e.openModal=function(){t.open({templateUrl:"/templates/galleries/galleryEditModal.html",controller:["$scope","$uibModalInstance","galleryResource",r],scope:e})}}}}]},{}],620:[function(e,t,n){"use strict";t.exports=["$rootScope","$uibModal","galleryResource",function(i,e,n){return{templateUrl:function(e,t){return t.template?"/templates/galleries/"+t.template+".html":"/templates/galleries/galleryFlagging.html"},scope:{image:"=",comment:"=",type:"="},replace:!0,link:function(r,e,t){r.flag={},r.showFlag=function(){if(!(i.user&&i.user.valid()))return!1;var e=r.image&&"accepted"===r.image.moderation_state,t=r.image||r.comment,n=t&&t.owner&&t.owner.user&&t.owner.user._id;return t&&i.user._data._id!==n&&!e},r.toggleFlagDialog=function(){r.showFlagDialog=!r.showFlagDialog,r.showFlagDialog&&(r.feedback=!1)},r.feedback=!1,r.submitFlag=function(){var e,t=r.image||r.comment;if(!(t&&t.owner&&t.owner.user&&t.owner.user._id))return r.feedback="danger",!(r.feedbackMessage="At the moment this user does not exist in our system. Please try again later.");r.disabled=!0;t=r.flag;if(r.image)e="flagImage",t.image_uploader_id=r.image.owner.user._id,t.image_id=r.image._id;else{if(!r.comment)return!1;e="flagComment",t.commenter_id=r.comment.owner.user._id,t.comment_id=r.comment._id}n[e](t,function(){r.disabled=!1,r.feedback="success",r.feedbackMessage="Thanks for the feedback."},function(){r.disabled=!1,r.feedback="danger",r.feedbackMessage="There was an error."})}}}}]},{}],621:[function(e,t,n){"use strict";function r(u,l,d,f,p,e){return{restrict:"EA",templateUrl:function(e,t){return t.oldTemplate?"/templates/galleries/galleryImageCurrentClassPage.html ":"/templates/galleries/galleryImage.html"},scope:{gallery:"<",image:"<",type:"@",owner:"<",clCourseSlug:"@",clStudentSlug:"@",basePath:"@",imageOptions:"=?"},replace:!0,link:function(n,t,r){var i=n.basePath,e="_self";function o(){(i=n.basePath).endsWith&&i.endsWith("/")&&(i=i.slice(0,-1)),n.href=i+"/photo/"+n.image._id;var e=t.find(".gallery-img");e.on("load",s),e.on("error",a)}function a(e){e=e.target;$(e).off("onError"),n.image.onLoadError=!0,n.image.isLoaded=!0,n.image.onLoaded.resolve(n.image)}function s(e){e=e.target;n.image.isLoaded||($(e).off("load",s),n.image.isLoaded=!0,n.image.offsetWidth=e.offsetWidth,n.image.offsetHeight=e.offsetHeight,n.image.onLoaded.resolve(n.image))}function c(){return d.clearGalleryImage(n.image)}n.$watch("basePath",o),angular.extend(n,{width:r.width||800,height:r.height||800,method:r.method||"fit",imgClass:r.imgClass||"img-responsive",target:"_self",onClick:function(e){l.trackGalleryImageTap({cta_label:"gallery_tile",cta_item_id:this.image._id}),"modal"===r.display&&(e.preventDefault(),e={image:n.image,type:n.type,clCourseSlug:n.clCourseSlug,clStudentSlug:n.clStudentSlug,sort:n.sort,basePath:n.basePath,scope:n},f(e))},deleteImage:function(e){e.preventDefault(),e.stopPropagation(),p.removeImage({image_id:n.image._id}).$promise.then(function(e){var t=n.gallery.images.indexOf(n.image);c().then(function(){n.$applyAsync(function(){n.gallery.images.splice(t,1),n.$emit("gallery:action",{type:"delete"})})})})},publishImage:function(e){e.preventDefault(),e.stopPropagation(),p.publish({id:n.image._id}).$promise.then(function(e){c().then(function(){n.$applyAsync(function(){n.image.state="published",n.$emit("gallery:action",{type:"publish"})})})})},unpublishImage:function(e){e.preventDefault(),e.stopPropagation(),p.unpublish({id:n.image._id}).$promise.then(function(e){c().then(function(){n.$applyAsync(function(){n.image.state="unpublished",n.$emit("gallery:action",{type:"publish"})})})})},sort:r.sort||"desc"}),(u.slug||u.userId)&&(e=void 0),angular.extend(n,{imgClass:r.imgClass||"img-responsive",target:e}),n.backgroundImageOptions={width:n.width,method:n.method,breakpointConfig:{"screen-xs":{width:211,quality:30},"screen-sm":{width:355,quality:40}}},r.quality&&(n.backgroundImageOptions.quality=r.quality),n.imageOptions&&(n.backgroundImageOptions=n.imageOptions),o()}}}r.$inject=["$routeParams","trackFactory","cacheClear","clGalleryImageModal","galleryResource","_"],t.exports=r},{}],622:[function(e,t,n){"use strict";t.exports=["$rootScope","AnalyticsService","galleryResource","cacheClear","_",function(o,a,s,c,u){return{restrict:"EA",templateUrl:function(e,t){return t.template?"/templates/galleries/"+t.template+".html":"/templates/galleries/galleryLikes.html"},scope:{image:"<",iconClass:"@"},replace:!0,link:function(n,e,t){function r(){var e=n.image.likes,e=u.map(e,function(e){return e.user?'<a class="profile-liker" data-like-id="'+e._id+'" target="_blank" href="/users/'+e.user.slug+'">'+e.display_name+"</a>":""});n.usersThatLiked=e.join("<br/>")}function i(){"true"===t.clearCache&&c.clearGalleryImage(n.image)}n.$watch("image",function(){n.hasUserLiked=function(){if(!angular.isArray(n.image&&n.image.likes))return!1;var t=!1;return angular.forEach(n.image.likes,function(e){angular.isObject(e)&&e.user&&e.user._id&&e.user._id===o.user._data._id&&(t=!0)}),t}()}),e.on("click",".profile-liker",function(e){e.preventDefault();var e=angular.element(e.target).data("like-id"),t=u.findWhere(n.image.likes,{_id:e});setTimeout(function(){window.location="/users/"+t.user.slug},120),a.track("Gallery Liker Profile Tap",{cta_label:"gallery_liker_tooltip",cta_item_id:t.user.slug})}),n.$watch("image.likes",function(){n.image&&n.image.likes&&(n.image.like_count=n.image.likes.length||0,r())},!0),n.onClick=function(e){if(e.preventDefault(),e.stopPropagation(),n.image&&n.image.owner&&n.image.owner.user&&n.image.owner.user._id===o.user._data._id)return!1;n.hasUserLiked?s.unlike({id:n.image._id}).$promise.then(function(e){e.success&&(n.image.likes=u.reject(n.image.likes,function(e){return!(!e||!e.user)&&e.user._id===o.user._data._id}),n.hasUserLiked=!1,n.$applyAsync(),i())}):s.like({id:n.image._id}).$promise.then(function(e){e.success&&(n.hasUserLiked=!0,e={display_name:o.user._data.profile.display_name,user:{_id:o.user._data._id,slug:o.user._data.user.slug}},n.image.likes.push(e),n.$applyAsync(),i())}),r()}}}}]},{}],623:[function(e,t,n){"use strict";function r(c,u,l,d,e,f){return{restrict:"EA",scope:{provider:"=",title:"@galleryListTitle",basePath:"@",slug:"@",type:"@"},templateUrl:function(e,t){return t.template||"templates/galleries/galleryList.html"},replace:!0,link:function(n,e,t){n.$on("load-gallery-images",function(e){e.preventDefault(),0!==n.provider.maxGalleryCount&&(n.loading=!0)}),n.$watch("provider.gallery.images.length",function(e){e&&(n.inited?a:i)()}),n.$watch("provider.sort",function(e){s()}),n.$watch("provider.maxGalleryCount",function(e){n.maxGalleryCount!==e&&s()});var r=u.innerWidth;function i(){n.inited=!0,n.imagesCount=0,n.columns=[];var e=c(n,"provider.gallery.images");n.galleryCount=e.length,n.maxGalleryCount=c(n,"provider.maxGalleryCount"),n.showLoadMoreButton=n.galleryCount<n.maxGalleryCount,e&&0!==e.length&&0!==n.maxGalleryCount&&(e=e.slice(0,function(){switch(!0){case n.galleryCount<=4:case u.innerWidth<992:return 2;case u.innerWidth<1200:return 3;default:return 4}}()),n.loading=!0,d.each(e,function(e){n.imagesCount++,e.isLoaded=!!e.isLoaded,e.onLoaded=l.defer(),e.onLoaded.promise.then(o),n.columns.push([e]),e.isLoaded&&e.onLoaded.resolve(e)}))}function o(e){var t;n.loading&&(t=f.user&&f.user._data&&f.user._data._id,e=e.owner,e=(e=d.isObject(e)?e&&e.user&&e.user._id:e)===t,t="user"===n.type,n.onOwnersProfile=e&&t,e=d.chain(n.columns).flatten().pluck("isLoaded").value(),n.loading=-1!==d.indexOf(e,!1),n.loading||a())}function a(){e=d.map(n.columns,function(e){return d.reduce(e,function(e,t){return t.onLoadError?e:e+(0<t.offsetWidth?t.offsetHeight/t.offsetWidth:1)},0)}),t=d.min(e);var e=d.indexOf(e,t),t=c(n,"provider.gallery.images");n.galleryCount=t.length,n.showLoadMoreButton=n.galleryCount<n.maxGalleryCount,n.imagesCount>=n.galleryCount||0===n.maxGalleryCount||0===n.columns.length||((t=t[n.imagesCount++]).isLoaded=!!t.isLoaded,t.onLoaded=l.defer(),t.onLoaded.promise.then(o),n.loading=!0,n.columns[e].push(t),t.isLoaded&&t.onLoaded.resolve(t))}function s(){n.columns=[],i()}n.loading=!1,n.inited=!1,angular.element(u).on("resize",function(){!function(){if(u.innerWidth===r)return!1;switch(!0){case u.innerWidth<992&&992<=r:return 992<r;case u.innerWidth<1200:return 1200<=r||r<992;default:return r<1200}}()||(n.columnContainerHeight=100,r=u.innerWidth,s())})}}}r.$inject=["deepval","$window","$q","_","$timeout","$rootScope"],t.exports=r},{}],624:[function(e,t,n){"use strict";var s=e("underscore");t.exports=["$location","$routeParams","$timeout",function(a,e,t){return{restrict:"EA",templateUrl:"/templates/galleries/galleryNav.html",scope:{gallery:"=",image:"=",type:"=",edit:"="},replace:!0,link:function(o,e){function t(){var e,t,n,r,i;o.image&&o.gallery&&o.gallery.images&&(e=a.url().split("/"),t=s.pluck(o.gallery.images,"_id").indexOf(o.image._id),i=o.gallery.images,0<=t&&0<=t-1&&(r=i[t-1]._id),0<=t&&t+1<i.length&&(n=i[t+1]._id),o.prev=r,o.next=n,o.base="/"+e[1]+"/"+e[2])}o.type=o.type||a.url().split("/")[1],t(),o.$watch("image",t),o.$watch("gallery.images",t)}}}]},{underscore:void 0}],625:[function(e,t,n){"use strict";function r(h,m,g,v,y,b){return{restrict:"A",link:function(i,l,o){var e=parseInt(o.clGalleryProviderCount||0,10),t=parseInt(o.clGalleryProviderPerLoad||8,10),n=o.clGalleryProviderSort||"created",r=o.clGalleryProviderSortDir||"desc",d=o.clGalleryProviderImageState,a=o.clGalleryProviderKey||"clGalleryProvider",f=o.$observe("clCourseSlug",s),p=o.$observe("clStudentSlug",s);h.$on("clGalleryProvider:init",function(e,t){i.clGalleryProviderReady=!1,s(t).then(function(){i.clGalleryProviderReady=!0})});function s(t){return o.clCourseSlug||o.clStudentSlug?(o.clImageId&&(e={image:{_id:o.clImageId},type:o.clCourseSlug?"course":"user",clCourseSlug:o.clCourseSlug,clStudentSlug:o.clStudentSlug,basePath:o.clBasePath,initialPath:o.clBasePath},y(e)),o.lazyLoadData?(n=m.defer(),r=i.$watch("moduleInView",function(e){e&&(c(t).then(n.resolve),r())}),n.promise):c(t)):m.reject();var e,n,r}function c(e){return u(e).then(function(e){o.clDebug,i.clGalleryProviderReady=!0,f(),p()}).catch(function(e){})}function u(t){var e,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=(o.clCourseSlug&&(e=g.getGallery,n=o.clCourseSlug),o.clStudentSlug&&(e=v.getGallery,n=o.clStudentSlug),h.$broadcast("load-gallery-images"),{count:t?0:i[a].count,perload:t&&i[a].count>i[a].perLoad?i[a].count:i[a].perLoad,sort:r.sort||i[a].sort,sortDir:i[a].sortDir});return i[a].imageState&&(r.state=i[a].imageState),e(n,r).then(function(e){e&&(t&&(i[a].gallery.images.splice(0,i[a].gallery.images.length),i[a].count=0),i[a].gallery.images=i[a].gallery.images.concat(e.images),i[a].count+=e.images.length,i[a].maxGalleryCount=e.count)})}i[a]={count:e,perLoad:t,gallery:{images:[]},loadImages:u,addImage:function(e){i[a].gallery.images.unshift(e),i[a].count++,i[a].maxGalleryCount++},maxGalleryCount:0,sort:n,sortDir:r,setSort:function(e){u(!0,{sort:e}).then(function(){i[a].sort=e})},setSortDir:function(e){i[a].sortDir=e},imageState:d},i.$on("slider:setting-image",function(e,n){var t=i[a].gallery.images;b.reduce(t,function(e,t){return e||n._id===t._id},!1)||(t.push(n),i[a].count+=1,i[a].showLoadMoreButton=i[a].count<0)})}}}r.$inject=["$rootScope","$q","CourseService","StudentService","clGalleryImageModal","_"],t.exports=r},{}],626:[function(e,t,n){"use strict";t.exports=["rind","AnalyticsService",function(i,o){return{templateUrl:"/templates/galleries/gallerySharing.html",scope:{image:"=",type:"="},replace:!0,link:function(n,e,t){var r="";n.$watch("image",function(){var e,t;n.image&&(t=angular.isArray(n.image.courses)&&0<n.image.courses.length?n.image.courses[0]:{},e=n.image.owner,"course"===n.type?r+="/courses/"+t.slug:r+=e?"/users/"+e.user.slug:"/courses/"+t.slug,n.imageUrl=r+"/photo/"+n.image._id,n.imageSrc=i.config.cdn.assets+n.image.image,n.shareText="Check out ",e&&(e.display_name||e.slug)?n.shareText+=(e.display_name||e.slug)+"'s":n.shareText+="my",n.shareText+=" work from @CreativeLive's "+(t||{}).short_title+" "||(t||{}).title+" student gallery")}),n.onFacebook=function(e){window.FB&&window.FB.ui&&(e.preventDefault(),e.stopPropagation(),e={method:"feed",link:i.context.url,picture:n.imageSrc,caption:n.image.description,name:n.image.title,description:n.shareText},window.FB.ui(e)),o.track("Gallery Social Share",{cta_label:"tap_social_share",social_share_type:"facebook",cta_item_id:this.image._id})},n.onTwitter=function(e){o.track("Gallery Social Share",{cta_label:"tap_social_share",social_share_type:"twitter",cta_item_id:this.image._id})},n.onPinterest=function(e){o.track("Gallery Social Share",{cta_label:"tap_social_share",social_share_type:"pinterest",cta_item_id:this.image._id})}}}}]},{}],627:[function(e,t,n){"use strict";t.exports=["clUploadModalService","$rootScope","$location","AnalyticsService",function(i,o,a,s){return{restrict:"EA",templateUrl:function(e,t){return t.galleryUploadModalTemplateUrl||"/templates/galleries/galleryUpload.html"},scope:{galleryProvider:"=",course:"=",image:"="},replace:!0,link:function(t,e,n){function r(){var e={imageClass:"gallery",type:"gallery",course:t.course,galleryProvider:t.galleryProvider,croppingOptions:{viewMode:2,minWidth:400,checkOrientation:!0,movable:!1,zoomable:!1}};i(e),s.track("Gallery Upload Modal Shown",{cta_label:"modal_shown",modal_ID:"galleryImageUpload"})}t.onClick=function(){o.user.valid()&&(n.href?window.location.href=n.href:(s.track("Gallery Upload Tap",{cta_label:"gallery_uploadwork"}),r()))},a.$$search.upload&&(o.user&&o.user._data._id?r():(o.$broadcast("login:show",{onboarding:!1,via:"gallery-upload"}),t.$broadcast("user:login",function(){r()})))}}}]},{}],628:[function(e,t,n){"use strict";var r=e("underscore");t.exports=function(){return function(e){if(Array.isArray(e))return r.filter(e,function(e){return"published"===e.state})}}},{underscore:void 0}],629:[function(e,t,n){"use strict";var r=e("underscore");t.exports=function(){return function(e){if(Array.isArray(e))return r.filter(e,function(e){return"unpublished"===e.state})}}},{underscore:void 0}],630:[function(e,t,n){"use strict";var r=e("../../common/app");r.controller("GalleryCtrl",e("./controllers/gallery")),r.controller("GalleryModal",e("./controllers/galleryModal")),r.service("clGalleryImageModal",e("./services/galleryImageModal")),r.service("GalleryUploaderService",e("./services/uploader")),r.directive("galleryList",e("./directives/galleryList")),r.directive("galleryDetail",e("./directives/galleryDetail")),r.directive("galleryNav",e("./directives/galleryNav")),r.directive("galleryImage",e("./directives/galleryImage")),r.directive("galleryLikes",e("./directives/galleryLikes")),r.directive("galleryComments",e("./directives/galleryComments")),r.directive("galleryUploadModal",e("./directives/galleryUploadModal")),r.directive("gallerySharing",e("./directives/gallerySharing")),r.directive("fileUpload",e("./directives/fileUpload")),r.directive("galleryFlagging",e("./directives/galleryFlagging")),r.directive("galleryEdit",e("./directives/galleryEdit")),r.directive("clGalleryProvider",e("./directives/galleryProvider")),r.filter("publishedImages",e("./filters/publishedImages")),r.filter("unpublishedImages",e("./filters/unpublishedImages"))},{"../../common/app":70,"./controllers/gallery":614,"./controllers/galleryModal":615,"./directives/fileUpload":616,"./directives/galleryComments":617,"./directives/galleryDetail":618,"./directives/galleryEdit":619,"./directives/galleryFlagging":620,"./directives/galleryImage":621,"./directives/galleryLikes":622,"./directives/galleryList":623,"./directives/galleryNav":624,"./directives/galleryProvider":625,"./directives/gallerySharing":626,"./directives/galleryUploadModal":627,"./filters/publishedImages":628,"./filters/unpublishedImages":629,"./services/galleryImageModal":631,"./services/uploader":632}],631:[function(e,t,n){"use strict";function r(y,n,b,r){var i;return function(v){var e,t;r.lock("galleryImageModal"),i?y.$broadcast("galleryModal:set-opts",v):(e=function(e){r.unlock("galleryImageModal"),i=void 0},t={templateUrl:"/templates/galleries/galleryModal.html",windowClass:"cl-modal modal-cl-gallery",backdropClass:"bg-white",scope:v.scope,controller:["$scope","$uibModalInstance","$location","$timeout","$filter","$compile","CourseService","StudentService","keyboard","rind","$window","trackFactory",function(i,e,o,l,d,f,p,h,t,n,m,g){var a,r=0,s=v.initialPath||o.path();function c(e,t){var n,r;i.image=i.images[e],o.path(i.basePath+"/photo/"+i.image._id),g.trackGalleryImageView({image_id:i.image._id}),i.$parent.$emit("slider:setting-image",i.image),e>=i.images.length-1&&(n=t,a.getGallery(i.slug,{perpage:10,imageId:i.image._id,direction:"prev",sort:v.sort}).then(function(e){b.each(e.images,function(e){u(n,e)}),i.images=i.images.concat(e.images)})),e<=0&&(r=t,a.getGallery(i.slug,{perpage:10,imageId:i.image._id,direction:"next",sort:v.sort}).then(function(e){b.each(e.images.reverse(),function(e){u(r,e,!0)}),i.images=e.images.reverse().concat(i.images)}))}function u(e,t,n){n&&(e.currentSlide=e.currentSlide+1);t='<div class="image" style="background-image: url('+d("magick")(t.image,{width:1600})+')" alt="'+t.title+'"><div icon template="loader" class="cl-loader"></div></div>';e.slickAdd(t,n),f($("[icon]"))(y)}i.image=v.image,i.basePath=v.basePath,i.clCourseSlug=v.clCourseSlug,i.clStudentSlug=v.clStudentSlug,i.type=v.type,"course"===i.type?(a=p,i.slug=i.clCourseSlug):"user"===i.type&&(a=h,i.slug=i.clStudentSlug),e.result.then(function(){return o.path(s)},function(){return o.path(s)}),i.close=function(){t.off("gallery"),t.off("comment"),t.blur(),e.close()},t.on("gallery",t.EVENTS.ESC,function(){return i.close()}),t.focus(["gallery","comment"]),a.getGallery(i.slug,{perpage:2,imageId:i.image._id,sort:v.sort||"created",sortDir:"desc"}).then(function(e){i.images=e.images,b.each(i.images,function(e,t){e._id===i.image._id&&(r=t)}),l(function(){$(".image-slider").on("init",function(e,t){c(r,t)}),$(".image-slider").slick({centerMode:!0,slidesToShow:1,slidesToScroll:1,infinite:!1,initialSlide:r}),$(".image-slider").on("afterChange",function(e,t,n){c(n,t)}),t.on("gallery",t.EVENTS.RIGHT,function(){$(".image-slider").slick("next")}),t.on("gallery",t.EVENTS.LEFT,function(){$(".image-slider").slick("prev")})})},function(){i.close()}),"Firefox"!==n.context.ua.family||n.context.ua.mobile||"user"!==i.type||m.scrollTo(0,0)}]},b.each(["backdrop","keyboard"],function(e){e in v&&(t[e]=v[e])}),(i=n.open(t)).result.then(e,e))}}r.$inject=["$rootScope","$uibModal","_","LockBody"],t.exports=r},{}],632:[function(e,t,n){"use strict";t.exports=["$rootScope","$q","$http",function(e,a,s){function t(e){var t=a.defer(),n=new FileReader;return n.onload=function(e){16777216<=e.total&&t.reject("tooLarge"),t.resolve(n)},n.readAsDataURL(e),t.promise}return{getDataUri:t,uploadFile:function(n,r,i){i=i||{};var o=a.defer();return t(r).then(function(e){var t=new FormData;t.append("nid",n),t.append("image_file",function(e){for(var e=e.split(","),t=atob(e[1]),e=e[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([n],{type:e})}(e.result),r.name),"string"==typeof i.description&&t.append("description",i.description),"string"==typeof i.title&&t.append("title",i.title),s.post("/api/galleries/image/add",t,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(o.resolve).error(o.reject)}),o.promise}}}]},{}],633:[function(e,t,n){"use strict";t.exports=["GlobalModuleService","_",function(i,o){return{restrict:"AE",scope:{},templateUrl:"/templates/global-module/edit.html",replace:!0,link:function(r,e,t){function n(n){r.data.id=n._id,r.data.params||(r.data.params={}),angular.forEach(n.params,function(e){r.data.params[e]||(r.data.params[e]="")}),angular.forEach(r.data.params,function(e,t){o.contains(n.params,t)||delete r.data.params[t]})}angular.extend(r,{data:r.$parent.data,setModule:n}),i.get().then(function(e){r.modules=e,!r.data.id||(e=o.findWhere(e,{_id:r.data.id}))&&n(e)})}}}]},{}],634:[function(e,t,n){"use strict";t.exports=["$rootScope","$compile","GlobalModuleService","deepval",function(a,s,c,u){var l=new RegExp(/^\$root(Scope)?\./);return{restrict:"A",scope:{data:"=?"},template:'<div class="cl-global-module" ng-if="::clGlobalModuleReady"></div>',link:function(n,t,e){n.data||(n.data=n.$parent.data||{});var r=e.clGlobalModuleId||n.data.id,i=n.data.params;if(e.clGlobalModuleParams)try{i=JSON.parse(e.clGlobalModuleParams||{})}catch(e){}var o="true"===e.isAdmin?' is-admin="true"':"";r&&c.getById(r).then(function(e){e&&(n.data=e.module.data||{},angular.forEach(i,function(e,t){l.test(e)?(e=e.replace(l,""),u.set(n,t,u(a,e))):u.set(n,t,e)}),e=angular.element("<div "+e.module.slug+o+' use-parent-data="true" data="data"></div>'),s(e)(n),t.html(e),n.clGlobalModuleReady=!0)}).catch(function(e){})}}}]},{}],635:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clGlobalModule",e("./directives/index")),r.directive("clGlobalModuleEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":633,"./directives/index":634}],636:[function(e,t,n){"use strict";t.exports=["$compile","$timeout",function(s,e){return{restrict:"E",scope:{isPrimary:"=?",title:"@hTitle",level:"@hLevel",format:"@hFormat",textCase:"@hCase"},transclude:!0,link:function(n,e,i,t,o){var a=e;n.$watchGroup(["title","level","format","textCase","class"],function(){e=n.isPrimary?"h1":"h1"!==n.level&&n.level||"h2";var r=angular.element("<"+e+">"),e=n.title,t=o().contents().text();t&&(e=t);r.html(e),n.format&&r.addClass(n.format);n.textCase&&r.addClass(n.textCase);n.level&&r.addClass(n.level);angular.forEach(i,function(e,t){var n;"string"==typeof e&&("class"===t?(n=e.split(" "),angular.forEach(n,function(e){r.addClass(e)})):r.attr(t,e))});try{a.replaceWith(r),s(r)(t?n.$parent:n),a=r}catch(e){}})}}}]},{}],637:[function(e,t,n){"use strict";e("../../common/app").directive("h",e("./directives/view"))},{"../../common/app":70,"./directives/view":636}],638:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/heading/edit.html",replace:!0,link:function(e,t,n){e.levels=[1,2,3,4,5,6],e.data=e.$parent.data,e.$watch("data.isPrimary",function(){e.data.isPrimary||"h1"!==e.data.hLevel?e.data.isPrimary&&(e.data.hLevel="h1"):e.data.hLevel="h2"}),e.data.topPadding="pad-top-xl",e.data.bottomPadding="pad-bottom-xl",e.data.hLevel||(e.data.hLevel="h2"),e.data.template||(e.data.template="center"),e.data.containerClass||(e.data.containerClass="container")}}}]},{}],639:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?",clModuleId:"@"},templateUrl:"/templates/heading/view.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data),e.data.containerClass=e.data.containerClass||"container"}}}]},{}],640:[function(e,t,n){"use strict";t.exports=["$interpolate",function(r){return{restrict:"AE",scope:{clTitle:"@",hLevel:"@",hFormat:"@",_subtitle:"@subtitle",isPrimary:"=?",textAlign:"@",textCase:"@",boldHr:"=?",showFollow:"=?",seeMoreLink:"@",topPadding:"@",bottomPadding:"@",moduleSlug:"@",clModuleId:"@",template:"@",containerClass:"@",lead:"=?"},templateUrl:"/templates/heading/index.html",transclude:{right:"?right"},link:function(e,t,n){e.clTitle&&(e.clTitle=r(e.clTitle)(e)),e._subtitle&&(e.subtitle=r(e._subtitle)(e)),e.lead&&(e.lead=r(e.lead)(e)),e.data&&(e.data.topPadding||e.data.bottomPadding||e.data.textAlign||e.data.hLevel||(e.data.topPadding="pad-top-xl",e.data.bottomPadding="pad-bottom-xl",e.data.textAlign="text-center"),e.data.hLevel=e.hLevel||"h2"),e.containerClass=e.containerClass||"container"}}}]},{}],641:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clHeading",e("./directives/index")),r.directive("headingCms",e("./directives/cms/view")),r.directive("headingCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":638,"./directives/cms/view":639,"./directives/index":640}],642:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/home-hero/edit.html",replace:!0,link:function(e,t,n){e.levels=[1,2,3,4,5,6],e.data=e.$parent.data,e.$watch("data.isPrimary",function(){e.data.isPrimary||"h1"!==e.data.hLevel?e.data.isPrimary&&(e.data.hLevel="h1"):e.data.hLevel="h2"}),e.data.template||(e.data.template="default")}}}]},{}],643:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?",clModuleId:"@"},templateUrl:"/templates/home-hero/view.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data)}}}]},{}],644:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"E",templateUrl:function(e,t){return t.template?"/templates/home-hero/"+t.template+".html":"/templates/home-hero/index.html"},replace:!0}}]},{}],645:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("homeHero",e("./directives/index")),r.directive("homeHeroCms",e("./directives/cms/view")),r.directive("homeHeroCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":642,"./directives/cms/view":643,"./directives/index":644}],646:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/arrow-down-circle-filled.html",replace:!0}}]},{}],647:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/arrow-down-circle.html",replace:!0}}]},{}],648:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{circle:"@",polygon:"@"},templateUrl:"/templates/icon/arrow-up-circle.html",replace:!0}}]},{}],649:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{color:"@"},templateUrl:"/templates/icon/bookmark-outline.html",replace:!0}}]},{}],650:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/bookmark.html",replace:!0}}]},{}],651:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/caret-left.html",replace:!0}}]},{}],652:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{color:"@"},templateUrl:"/templates/icon/check.html",replace:!0}}]},{}],653:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{color:"@",strokeWidth:"@"},templateUrl:"/templates/icon/close.html",replace:!0}}]},{}],654:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{color:"@",text:"@"},templateUrl:"/templates/icon/download.html",replace:!0}}]},{}],655:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/facebook.html",replace:!0}}]},{}],656:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-chart.html",replace:!0}}]},{}],657:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-default.html",replace:!0}}]},{}],658:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{extension:"<?iconFileDownloadExtension"},templateUrl:"/templates/icon/file-download.html",replace:!0}}]},{}],659:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-HD.html",replace:!0}}]},{}],660:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-image.html",replace:!0}}]},{}],661:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-pdf.html",replace:!0}}]},{}],662:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-sound.html",replace:!0}}]},{}],663:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-video.html",replace:!0}}]},{}],664:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-word.html",replace:!0}}]},{}],665:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/icon/file-zip.html",replace:!0}}]},{}],666:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/gear.html",replace:!0}}]},{}],667:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/globe.html",replace:!0}}]},{}],668:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:function(e,t){return"/templates/icon/"+(t.template||"index")+".html"},replace:!0}}]},{}],669:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/instagram.html",replace:!0}}]},{}],670:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/map-marker.html",replace:!0}}]},{}],671:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{value:"@iconMicrosoftLogo"},templateUrl:"/templates/icon/microsoft-logo.html",replace:!0}}]},{}],672:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/pause.html",replace:!0}}]},{}],673:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/pin.html",replace:!0}}]},{}],674:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/play-circle.html",replace:!0}}]},{}],675:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{circle:"@",polygon:"@"},templateUrl:"/templates/icon/play-transparent.html",replace:!0}}]},{}],676:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{circle:"@",polygon:"@"},templateUrl:"/templates/icon/play.html",replace:!0}}]},{}],677:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/right-bracket.html",replace:!0}}]},{}],678:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{value:"@iconSkipAheadValue"},templateUrl:"/templates/icon/skip-ahead.html",replace:!0}}]},{}],679:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{value:"@iconSkipBackValue"},templateUrl:"/templates/icon/skip-back.html",replace:!0}}]},{}],680:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{value:"@iconTrashcan"},templateUrl:"/templates/icon/trashcan.html",replace:!0}}]},{}],681:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/twitter.html",replace:!0}}]},{}],682:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/user.html",replace:!0}}]},{}],683:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/icon/video-play.html",replace:!0}}]},{}],684:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clIcon",e("./directives/index")),r.directive("iconUser",e("./directives/user")),r.directive("iconPlay",e("./directives/play")),r.directive("iconPlayCircle",e("./directives/play-circle")),r.directive("iconPause",e("./directives/pause")),r.directive("iconCheck",e("./directives/check")),r.directive("iconPlayTransparent",e("./directives/play-transparent")),r.directive("iconRightBracket",e("./directives/right-bracket")),r.directive("iconClose",e("./directives/close")),r.directive("iconFileChart",e("./directives/file-chart")),r.directive("iconFileDefault",e("./directives/file-default")),r.directive("iconFileDownload",e("./directives/file-download")),r.directive("iconFileHd",e("./directives/file-hd")),r.directive("iconFileImage",e("./directives/file-image")),r.directive("iconFilePdf",e("./directives/file-pdf")),r.directive("iconFileSound",e("./directives/file-sound")),r.directive("iconFileVideo",e("./directives/file-video")),r.directive("iconFileWord",e("./directives/file-word")),r.directive("iconFileZip",e("./directives/file-zip")),r.directive("iconSkipAhead",e("./directives/skip-ahead")),r.directive("iconSkipBack",e("./directives/skip-back")),r.directive("iconVideoPlay",e("./directives/video-play")),r.directive("iconDownload",e("./directives/download")),r.directive("iconArrowUpCircle",e("./directives/arrow-up-circle")),r.directive("iconArrowDownCircle",e("./directives/arrow-down-circle")),r.directive("iconArrowDownCircleFilled",e("./directives/arrow-down-circle-filled")),r.directive("iconGear",e("./directives/gear")),r.directive("iconMapMarker",e("./directives/map-marker")),r.directive("iconGlobe",e("./directives/globe")),r.directive("iconFacebook",e("./directives/facebook")),r.directive("iconTwitter",e("./directives/twitter")),r.directive("iconInstagram",e("./directives/instagram")),r.directive("iconTrashcan",e("./directives/trashcan")),r.directive("iconCaretLeft",e("./directives/caret-left")),r.directive("iconPin",e("./directives/pin")),r.directive("iconBookmark",e("./directives/bookmark")),r.directive("iconBookmarkOutline",e("./directives/bookmark-outline")),r.directive("iconMicrosoftLogo",e("./directives/microsoft-logo"))},{"../../common/app":70,"./directives/arrow-down-circle":647,"./directives/arrow-down-circle-filled":646,"./directives/arrow-up-circle":648,"./directives/bookmark":650,"./directives/bookmark-outline":649,"./directives/caret-left":651,"./directives/check":652,"./directives/close":653,"./directives/download":654,"./directives/facebook":655,"./directives/file-chart":656,"./directives/file-default":657,"./directives/file-download":658,"./directives/file-hd":659,"./directives/file-image":660,"./directives/file-pdf":661,"./directives/file-sound":662,"./directives/file-video":663,"./directives/file-word":664,"./directives/file-zip":665,"./directives/gear":666,"./directives/globe":667,"./directives/index":668,"./directives/instagram":669,"./directives/map-marker":670,"./directives/microsoft-logo":671,"./directives/pause":672,"./directives/pin":673,"./directives/play":676,"./directives/play-circle":674,"./directives/play-transparent":675,"./directives/right-bracket":677,"./directives/skip-ahead":678,"./directives/skip-back":679,"./directives/trashcan":680,"./directives/twitter":681,"./directives/user":682,"./directives/video-play":683}],685:[function(e,t,n){"use strict";var i=e("underscore");t.exports=["$document","$filter",function(n,r){return{restrict:"AE",scope:{selectedImageKey:"=?",imageKeys:"=",onSelectImage:"&"},templateUrl:"/templates/image-dropdown/view.html",link:function(t,e){t.showImageSelections=!1,t.imageURLs=[],t.$watch("imageKeys",function(e){e&&(t.imageURLs=[],i.each(t.imageKeys,function(e){t.imageURLs.push(r("magick")(e,{width:380}))}))},!0),n.on("click",function(){t.showImageSelections=!1,t.$applyAsync()}),t.toggleImageSelections=function(){t.showImageSelections=!t.showImageSelections},t.onSelect=function(e){t.onSelectImage()(e),t.showImageSelections=!1}}}}]},{underscore:void 0}],686:[function(e,t,n){"use strict";e("../../common/app").directive("imageDropdown",e("./directives/view"))},{"../../common/app":70,"./directives/view":685}],687:[function(e,t,n){"use strict";var C=e("underscore"),I=e("async"),x={topics:"_id",categories:"primary_category"};t.exports=["$rootScope","$timeout","EventService","CatalogService","ScoresService","ChannelTopicService","moment","deepval",function(_,w,S,e,E,A,k,T){return{restrict:"AE",scope:{},templateUrl:"/templates/in-studio/index.html",link:function(o,l,d){var f=this,e=new E,i=(e.setUser(_.user._data.user),[]),a="America/Los_Angeles";function t(){_.user&&_.user.valid()&&(a=_.user.get("timezone"))}function r(){o.allOnairCourses=[],o.allUpcomingCourses=[],o.onairCourses=new DataSet,o.upcomingCourses=new DataSet,o.displayedCourses=new DataSet,o.maxCourseCount=parseInt(d.maxCourseCount||0,10),i=[h,m,p];var t=0;I.doWhilst(function(e){i[t++].call(f,e)},function(){return o.displayedCourses.length<2&&i[t]},function(){var t,n;o.displayedCourses=o.displayedCourses.slice(0,2),n=k().unix(),C.each(o.displayedCourses,function(e){(!t||e.end_time<t)&&e.end_time>n&&(t=e.end_time)}),n<t&&w(function(){w(r)},1e3*(t-n+1))})}function p(t){function n(e){var t=o.recentInteractions;S.organizeEventsForCalendar(t.onair,function(t){I.series([function(e){c(t.onair),C.each(o.allUpcomingCourses,function(e){e.rsvp=!0}),e()},u,u],e)})}function r(e){var t=o.recentInteractions;t.recent&&o.displayedCourses.addToSet(t.recent),e()}_.user.valid()&&_.user.recentInteractions?_.user.recentInteractions({limit:o.maxCourseCount}).then(function(e){o.recentInteractions=e,o.indexOnair=0,I.series([n,r],function(e){o.displayedCourses.length<2&&(i.push(s),i.push(u)),t()})}):(i.push(s),i.push(u),t())}function h(t){e.fetchSortedCategories(function(e){o.categories=e,t()})}function m(t){e.fetchFilteredTopics(function(e){o.topics=e,t()})}function s(t){o.allOnairCourses=[],o.allUpcomingCourses=[],S.getUpcomingEvents().then(function(e){S.organizeEventsForCalendar(e,function(e){c(e.onair),c(e.upcoming),t()})})}function c(e){angular.forEach(e,function(e){var t;!0===T(e||{},"product.source.flagged.on_calendar")&&((t=angular.copy(e.product.source)).eventData=angular.copy(e),o.allUpcomingCourses.push(t))})}function u(e){y(),o.allOnairCourses=C.filter(o.allUpcomingCourses,function(e){return"onair"===e.eventData.type});var t=n(o.allOnairCourses);0<t.length&&(t=b(t),o.displayedCourses.addToSet(t[0],"_id")||o.displayedCourses.addToSet(t[1])),o.displayedCourses.length<2&&0<o.allUpcomingCourses.length&&i.push(g),e()}function g(e){y(),o.allUpcomingCourses=C.filter(o.allUpcomingCourses,function(e){return"upcoming"===e.eventData.type});var t=n(o.allUpcomingCourses);0<t.length&&(t=b(t),o.displayedCourses.addToSet(t[0])),o.displayedCourses.length<2&&i.push(v),e()}function v(t){A.get().then(function(){var e=o.categories[0]._id,e=C.extend(A.cache.channelsById[e],o.categories[0]);e.type="channel",o.displayedCourses.addToSet(e),t()})}function y(){o.filterParam="categories",o.filters=[o.categories[0]],o.categories[0].score||(o.filterParam="live"),0<o.topics.length&&(o.filterParam="topics",o.filters=o.topics)}function n(e){var i=new DataSet;return angular.forEach(e,function(e){var t,n,r;t=i,n=(e=e).flagged&&!0===e.flagged.on_calendar,r=void 0!==e.type,((n||r)&&function(r){return r.score=0,o.filterParam===r.broadcast_type||C.any(o.filters,function(e,t){if(function(e,t){if(!T(e,"taxonomy.length")){var e=e.primary_category&&e.primary_category._id||e.primary_category,n=t&&t._id||t,t=t&&t.primary_category;if(e===n||e===t)return!0}return!1}(r,e))return r.score+=e.score||0,r.eventData.live&&(r.score+=.5),r.eventData.is_container&&(r.score+=.1),!0;var n=x[o.filterParam];return-1<C.pluck(r.taxonomy,n).indexOf(e._id)&&(r.score+=e.score||0,"live"===r.broadcast_type&&(r.score+=.5),!0)})}(e)||e.rsvp)&&t.addToSet(e,"_id")}),0===i.length&&"categories"!==o.filterParam&&(o.filterParam="categories",o.filters=[o.categories[0]],i=n(e)),i}function b(e){return e.sort(function(e,t){var n=k.unix(e.eventData.start_time).tz(a),r=k.unix(t.eventData.start_time).tz(a),i=k.unix(Date.now()/1e3);return n.diff(i,"days")<0&&(n=i),r.diff(i,"days")<0&&(r=i),0!==(i=n.diff(r,"days"))?i:t.score-e.score}),e}t(),o.$on("user:login",t),o.$on("user:register",t),r()}}}]},{async:21,underscore:void 0}],688:[function(e,t,n){"use strict";e("../../common/app").directive("inStudio",e("./directives/index"))},{"../../common/app":70,"./directives/index":687}],689:[function(e,t,n){"use strict";t.exports=["$timeout",function(i){return{restrict:"A",scope:{initOnload:"@",initialSlide:"=",instructors:"="},link:function(e,t){var n,r=function(){return i(function(){$(t).slick({slidesToShow:4,arrows:!0,infinite:!0,centerPadding:"40px",initialSlide:e.initialSlide||3,responsive:[{breakpoint:1500,settings:{centerPadding:"40px",slidesToShow:3,centerMode:!1}},{breakpoint:1024,settings:{centerPadding:"40px",slidesToShow:2,centerMode:!1}},{breakpoint:767,settings:{centerPadding:"40px",slidesToShow:1,centerMode:!1}}]})})};return e.initOnload?(n=!1,e.$watch("instructors.length",function(e){if(null!=e&&!n)return r(),n=!0})):r()}}}]},{}],690:[function(e,t,n){"use strict";t.exports=["$timeout",function(i){return{restrict:"A",scope:{initOnload:"@",initialSlide:"=",instructors:"="},link:function(e,t){var n,r=function(){return i(function(){$(t).slick({centerMode:!0,centerPadding:"60px",slidesToShow:3,variableWidth:!0,arrows:!0,infinite:!0,initialSlide:e.initialSlide||3,responsive:[{breakpoint:767,settings:{slidesToShow:1,centerMode:!1,variableWidth:!1}}]})})};return e.initOnload?(n=!1,e.$watch("instructors.length",function(e){if(null!=e&&!n)return r(),n=!0})):r()}}}]},{}],691:[function(e,t,n){"use strict";t.exports=["$sce","rind",function(n,r){return{restrict:"AE",scope:{instructors:"="},templateUrl:"/templates/instructors/facepile.html",replace:!0,link:function(e){e.instructors.forEach(function(e,t){e.img=n.trustAsResourceUrl("//"+r.config.cdn.assets+"/"+e.image)})}}}]},{}],692:[function(e,t,n){"use strict";function r(e,a){return{restrict:"AE",scope:{instructors:"=",clickable:"=?"},templateUrl:function(e,t){return"/templates/instructors/"+(t.template||"list")+".html"},link:function(e,t,n){var o=parseInt(n.instructorsListShowCountAt||8,10);e.styles=n.styles||"instructor-name caption xs-one-line sm-one-line",e.$watch("instructors",function(){if(e.instructors){var r="",i="";if(e.instructors.length>o)return r="with "+e.instructors.length+" instructors",i=r,e.instructorsString=r,void(e.instructorsStringHtml=i);a.each(e.instructors,function(e,t){var n;e&&(n=e.name||e.profile&&e.profile.name||"",t<3?(""!==r&&(r+=", ",i+=", "),r+=n,i+='<a class="instructor-name instructor-clickable caption" href="/instructor/'+e.slug+'">'+n+"</a>"):3===t&&(e.name||e.profile)&&(r+=" and more",i+=" and more"))}),e.instructorsString=r,e.instructorsStringHtml=i}})}}}r.$inject=["$sce","_"],t.exports=r},{}],693:[function(e,t,n){"use strict";var s=e("underscore");t.exports=["$sce","$rootScope","trackFactory","FollowService","$timeout",function(e,i,t,o,a){return{restrict:"AE",scope:{instructor:"="},templateUrl:"/templates/instructors/profile-lg.html",replace:!0,link:function(n,e,t){n.followingInstructor=!1;var r={ctaLabel:"",follow_type:"instructor"};n.followInstructor=function(t){o.followInstructor(t,r).then(function(e){e?o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e}):(i.$broadcast("login:show",{onboarding:"false",prompt:"follow",promptClass:n.courseTitle,cta_label:"Follow",regPrompt:"follow",via:"follow"}),s.each(["user:register","user:login"],function(e){i.$on(e,function(){n.followInstructor(t)})}))})},n.unfollowInstructor=function(e){o.unfollowInstructor(e,r).then(function(e){o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e})})},a(function(){o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e}),r.follow_name=n.instructor.slug||void 0},400)}}}]},{underscore:void 0}],694:[function(e,t,n){"use strict";var a=e("underscore");t.exports=["$sce","$rootScope","trackFactory","FollowService",function(e,i,t,o){return{restrict:"AE",scope:{instructor:"=",courseTitle:"="},templateUrl:"/templates/instructors/profile-md.html",replace:!0,link:function(n,e,t){n.followingInstructor=!1;var r={ctaLabel:"",follow_type:"instructor",follow_name:n.instructor.slug||void 0};n.followInstructor=function(t){o.followInstructor(t,r).then(function(e){e?o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e}):(i.$broadcast("login:show",{onboarding:"false",prompt:"follow",promptClass:n.courseTitle,cta_label:"Follow",regPrompt:"follow",via:"follow"}),a.each(["user:register","user:login"],function(e){i.$on(e,function(){n.followInstructor(t)})}))})},n.unfollowInstructor=function(e){o.unfollowInstructor(e,r).then(function(e){o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e})})},o.checkFollow(n.instructor._id).then(function(e){n.followingInstructor=e})}}}]},{underscore:void 0}],695:[function(e,t,n){"use strict";t.exports=["$sce",function(e){return{restrict:"AE",scope:{instructor:"="},templateUrl:"/templates/instructors/profile-sm.html",replace:!0}}]},{}],696:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("instructorFacepile",e("./directives/facepile")),r.directive("instructorCarousel",e("./directives/carousel")),r.directive("instructorCarouselWithClass",e("./directives/carousel-with-class")),r.directive("instructorProfileLg",e("./directives/profile-lg")),r.directive("instructorProfileMd",e("./directives/profile-md")),r.directive("instructorProfileSm",e("./directives/profile-sm")),r.directive("instructorList",e("./directives/list")),r.factory("FollowService",e("./service/follow.js"))},{"../../common/app":70,"./directives/carousel":690,"./directives/carousel-with-class":689,"./directives/facepile":691,"./directives/list":692,"./directives/profile-lg":693,"./directives/profile-md":694,"./directives/profile-sm":695,"./service/follow.js":697}],697:[function(e,t,n){"use strict";t.exports=["$rootScope","trackFactory","$q",function(i,o,a){return{checkFollow:function(e){var t=a.defer();i.user.valid()&&i.user.isFollowing("instructor",{entityId:e}).then(function(e){t.resolve(e)});return t.promise},followInstructor:function(e,t,n){var r=a.defer();i.user.valid()?(t.ctaLabel="follow",o.follow("follow",t,e,n,"button"),i.user.follow("instructor",{entityId:e}).then(function(e){r.resolve(e)})):r.resolve(!1);return r.promise},unfollowInstructor:function(e,t,n){var r=a.defer();return t.ctaLabel="following",o.follow("unfollow",t,e,n,"button"),i.user.unfollow("instructor",{entityId:e}).then(function(e){r.resolve(e)}),r.promise}}}]},{}],698:[function(e,t,n){"use strict";t.exports=[function(){return{require:"^clViewFlow",restrict:"AE",template:'<div class="cl-interest-category">Categories</div>',replace:!0,link:function(e,t,n,r){r.done()}}}]},{}],699:[function(e,t,n){"use strict";t.exports=["$rootScope","trackFactory","topicResource","ScoresService",function(i,o,a,s){return{restrict:"AE",scope:{onDone:"&onDone",cancel:"&onCancel",abort:"&onAbort"},templateUrl:"/templates/interest/index.html",link:function(t,e,n,r){angular.extend(t,{data:{},categoriesOpen:!1,currentCategory:{},done:function(){o.onboardingContinue(t.currentCategory.active?"topic":"category",t.currentCategory.title),i.user.valid()&&((new s).updateScores(),i.user.updateInterest());t.onDone()},selectCategory:function(e){e.active?o.onboardingBack():o.interestCategorySelected(e.title,"add");e.active=!e.active,t.currentCategory=e,t.categoriesOpen=e.active},selectTopic:function(e,t){e.active=!e.active,t.activeCount||(t.activeCount=0);t.activeCount=e.active?t.activeCount+1:t.activeCount-1,e.active?(i.user.addInterest(e._id),o.interestTopicSelected(e.name,"add")):(i.user.removeInterest(e._id),o.interestTopicSelected(e.name,"remove"),t.activeCount<1&&(i.user.removeInterest("category",t.slug),o.interestCategorySelected(t.title,"remove")))}}),a.getAllByCategory({onboarding:!0,primary:!0}).$promise.then(function(e){e&&e.success&&e.data&&(t.data=angular.copy(e.data),i.user.mergeExistingInterests(),angular.forEach(t.data,function(e){e.activeCount=e.topics.filter(function(e){return 0<=i.user.get("follows").topic.indexOf(e._id)}).length}))})}}}]},{}],700:[function(e,t,n){"use strict";t.exports=[function(){return{require:"^clViewFlow",restrict:"AE",template:'<div class="cl-interest-tag">Tag</div>',replace:!0,link:function(e,t,n,r){r.done()}}}]},{}],701:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clInterest",e("./directives/index")),r.directive("clInterestCategory",e("./directives/category")),r.directive("clInterestTag",e("./directives/tag"))},{"../../common/app":70,"./directives/category":698,"./directives/index":699,"./directives/tag":700}],702:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/keep-watching/cms-view.html",scope:{data:"=?"},controllerAs:"keepWatchingCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],703:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService","CourseService","$filter","CatalogService",function(n,e,a,s,c){return{restrict:"AE",scope:{course:"=?"},templateUrl:function(e,t){return t.template?"/templates/"+t.template+".html":"/templates/keep-watching/view.html"},controllerAs:"ctrl",controller:["$scope","$attrs",function(r,e){var i=this;function t(e){if(!e)return!1;e._id&&c.getCourseById(e._id,{keys:["sessions","segments"],fetch:!0},{owner_only:!0,subscription_only:!0}).then(function(e){var t,n;a.setWatchData(e),i.course=e,r.reInit=!0,i.course&&(i.courseUrl="/courses/"+s("addQueryParams")(i.course.slug,{autoplay:!0}),i.segment=a.getLatestSegmentForCourse(i.course),i.segment&&(t=i.segment.watchData)?(i.watchProgressString=t.watchProgressString,i.totalSegmentLengthString=t.totalSegmentLengthString,i.progressPercent=t.progressPercent,i.nextSegment=a.getSegmentByIdx(i.course,i.segment.idx),e=t.progressPercent,i.progressTimeLeftPosition=85<e?85:e<8?8:e,t=i.segment.idx,e=i.segment.lastIdx,n=i.progressPercent,i.view=t===e&&90<n?"complete":void 0,(e=i.course.taxonomy)&&(i.taxonomy=_.find(e,function(e){return e.topic&&!e.topic.archive}))):o())})}function o(){i.watchProgressString=void 0,i.totalSegmentLengthString=void 0,i.progressPercent=0,i.progressTimeLeftPosition=void 0,i.nextSegment=void 0,i.view=void 0}angular.extend(i,{view:void 0}),"true"===e.watch&&r.$watch("course",t),r.course?t(r.course):n.user&&n.user.recentInteraction&&n.user.recentInteraction().then(function(e){t(e.mostRecent)})}]}}]},{}],704:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clKeepWatching",e("./directives/view")),r.directive("keepWatchingCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/view":702,"./directives/view":703}],705:[function(e,t,n){"use strict";t.exports=["courses","arrayMove","urlify",function(r,s,i){return{restrict:"AE",scope:{},templateUrl:"/templates/landing-page-collection/edit.html",replace:!0,link:function(a,e,t){var n;a.data=a.$parent.data,a.data.tiles||(a.data.tiles=[]),a.addCourse=function(e){r.getComplete({slug:e.slug},function(e){(n=e.data)&&n.slug&&(a.image=n.image,a.slug=n.slug,a.url||(a.url="/courses/"+n.slug),a.title||(a.title=n.short_title))})},a.addTile=function(){a.url=i(a.url);var t={};["title","url","image","slug"].forEach(function(e){t[e]=a[e]}),void 0!==a.editingTile?a.data.tiles[a.editingTile]=t:a.data.tiles.push(t),a.title="",a.url="",a.courseData=void 0,a.editingTile=void 0},a.editTile=function(e,t){a.editingTile=t,a.title=e.title,a.url=e.url,a.image=e.image,r.getComplete({slug:e.slug},function(e){a.courseData=e.data})},a.removeTile=function(e){a.data.tiles.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{}],706:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{model:"=ngModel",size:"@"},templateUrl:"/templates/landing-page-collection/tile.html",replace:!0,link:function(e,t,n){e.config=r}}}]},{}],707:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/landing-page-collection/view.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data),e.$watch("data.tiles",function(){e.tiles=angular.copy(e.data.tiles),e.firstTile=e.tiles.shift()},!0)}}}]},{}],708:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("landingPageCollection",e("./directives/view")),r.directive("landingPageCollectionTile",e("./directives/tile")),r.directive("landingPageCollectionEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":705,"./directives/tile":706,"./directives/view":707}],709:[function(e,t,n){"use strict";t.exports=["arrayMove",function(e){return{restrict:"AE",scope:{kvps:"=?",key:"=?",value:"=?",expires:"=?",editingKVP:"=?"},templateUrl:"/templates/landing-tracking/edit.html",replace:!0,link:function(n,e,t){n.data=n.$parent.data,n.data.kvps=n.data.kvps||[],n.illegalKeyName=!1,n.addKVP=function(){var e={key:n.key,value:n.value,expires:n.expires};void 0!==n.editingKVP?(n.data.kvps[n.editingKVP]=e,n.editingKVP=void 0):n.data.kvps.push(e)},n.editKVP=function(e,t){n.editingKVP=t,n.key=e.key,n.value=e.value,n.expires=e.expires},n.remove=function(e){n.data.kvps.splice(e,1)},n.startsWithIllegalChar=function(e){e=/^\^/.test(e);return n.illegalKeyName=e,n.illegalKeyName}}}}]},{}],710:[function(e,t,n){"use strict";function r(r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/landing-tracking/view.html",replace:!0,link:function(n,e,t){n.isAdmin="true"===t.isAdmin,n.data||(n.data=n.$parent.data),n.data&&angular.forEach(n.data.kvps,function(e){var t;e&&e.key&&(n.isAdmin||(r.user.valid()?r.user.setTrait(e.key,encodeURIComponent(e.value)):(t=encodeURIComponent(e.value),window.Vault.Local.set("trait_"+e.key,t,{expires:"+"+e.expires+" days",path:"/"}))))})}}}r.$inject=["$rootScope"],t.exports=r},{}],711:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("landingTracking",e("./directives/view")),r.directive("landingTrackingEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":709,"./directives/view":710}],712:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{items:"=?",item:"=?",editingItem:"=?"},templateUrl:"/templates/landing-traits/edit.html",replace:!0,link:function(n,e,t){n.data=n.$parent.data,n.add=function(){n.data.items||(n.data.items=[]);var e=n.item;void 0!==n.editingItem?(n.data.items[n.editingItem]=e,n.editingItem=void 0):n.data.items.push(e)},n.editItem=function(e,t){n.editingItem=t,n.item=e},n.remove=function(e){n.data.items.splice(e,1)},n.startsWithIllegalChar=function(e){e=/^\^/.test(e);return n.illegalKeyName=e,n.illegalKeyName}}}}]},{}],713:[function(e,t,n){"use strict";t.exports=["$rootScope","config",function(r,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/landing-traits/view.html",replace:!0,link:function(e,t,n){e.isAdmin="true"===n.isAdmin,e.config=i,e.data||(e.data=e.$parent.data),e.isAdmin||r.user.addTraits(e.data.items)}}}]},{}],714:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("landingTraits",e("./directives/view")),r.directive("landingTraitsEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":712,"./directives/view":713}],715:[function(e,t,n){"use strict";t.exports=["config","_","arrayMove",function(e,t,s){return{restrict:"EA",templateUrl:"/templates/learning-path/edit.html",link:function(a){a.data.filters||(a.data.filters=[]),a.edit={filter:!1},a.newFilter=function(){a.edit.filter={ids:[],populate:[],sorting:"",type:"",limit:0,action:"save"}},a.selectTaxonomy=function(){a.edit.filter.ids=t.chain(a.edit.filter.taxonomy).pluck("topic").without(void 0).value()},a.addProduct=function(e){a.edit.filter.ids.push(e._id)},a.addFilter=function(){var e=t.clone(a.edit.filter);"selected_topics"===e.type&&(e.ids=t.chain(e.taxonomy).pluck("topic").without(void 0).value()),"save"===e.action&&a.data.filters.push(t.omit(e,"action")),a.edit.filter=!1},a.isFilterReady=function(){return!!a.edit.filter&&(!!a.edit.filter.type&&(-1===a.edit.filter.type.indexOf("selected")||0!==a.edit.filter.ids.length))},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{}],716:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/learning-path/cms-view.html",scope:{data:"<?"},link:function(t,e,n){t.isAdmin="true"===n.isAdmin,t.data||(t.data=t.$parent.data||n.data&&JSON.parse(n.data)),"page"===t.data.template&&(t.data.template="page-header"),n.$observe("clModuleId",function(e){t.data.clModuleId=e})}}}]},{}],717:[function(e,t,n){"use strict";function r(u,l){return{restrict:"AE",templateUrl:function(e,t){return t.empty?"/templates/learning-path/empty-state.html":"/templates/learning-path/view.html"},replace:!0,scope:{template:"@?",clModuleId:"@",paginationView:"@",grid:"@",container:"@",theme:"@",limit:"@",allowCategoryFilter:"<?",filters:"<",preserveOrder:"@?",trackProductPageView:"@?"},link:function(t,n,e){t.$on("user:login",o),t.$on("user:register",o),t.$on("user:logout",o),t.learningPaths=[],t.emptyStateImage="https://agc.creativelive.com/agc/pages/Learning_Paths_Empty_State_cropped.png",angular.extend(t,{pagination:{currentPage:1,pages:0,perPageLimit:6,learningPathsPerRow:3,amountVisible:6},showAll:!1,visibleLearningPaths:[],changeCollapsedState:function(e){t.showAll=!e,c(),!1===t.showAll&&1<t.pagination.currentPage&&s(1)},pageChanged:s}),t.$watch(function(){return n[0].scrollWidth},c),t.$watch("perPageLimit",function(){return s()});var r=t.$watch("filters",function(e){e&&(r(),i())});function i(){var e=_.clone(t.filters);e&&(t.template=t.template||"inline",t.paginationView=t.paginationView&&"true"===t.paginationView,l.getLearningPaths(e,parseInt(t.limit,10)).then(a))}function o(){t.learningPathsSet=!1,t.learningPath={},t.learningPaths=[],i()}function a(e){e.length<0||(t.learningPaths=e,t.learningPath=e[0],t.learningPathsSet=!0,t.trackProductPageView&&u.analytics.productPageView(t.learningPath),t.paginationView&&(c(),s(t.currentPage)))}function s(e){e&&(t.pagination.currentPage=e);e=(t.pagination.currentPage-1)*t.pagination.perPageLimit;t.visibleLearningPaths=t.learningPaths.slice(e,e+t.pagination.perPageLimit)}function c(){var e=n[0].scrollWidth;0!==e&&(t.pagination.learningPathsPerRow=e<768?1:e<1200?2:3,t.pagination.perPageLimit=2*t.pagination.learningPathsPerRow,t.pagination.amountVisible=t.showAll?t.pagination.perPageLimit:t.pagination.learningPathsPerRow)}}}}r.$inject=["$rootScope","LearningPathService"],t.exports=r},{}],718:[function(e,t,n){"use strict";t.exports=["LearningPathService","_",function(a,s){return{restrict:"A",link:function(t,e,n){function r(){t.learningPath={},t.learningPaths=[],i()}function i(){var e=parseInt(n.limit||0,10),t=n.sorting||"interactions";n.clCourseId&&a.getLearningPaths([{type:"selected_courses",ids:[n.clCourseId],sorting:t,limit:e}]).then(o),n.bundleId&&a.getLearningPaths([{type:"selected_learning_paths",ids:[n.bundleId],sorting:t,limit:e}]).then(o),n.follow&&a.getLearningPaths([{type:"user_followed_paths",sorting:t,limit:e}]).then(o)}function o(e){t.learningPath=s.first(e),t.learningPaths=e,t.clLearningPathProviderReady=!0,n.clDebug}t.$on("user:login",r),t.$on("user:register",r),t.$on("user:logout",r),i()}}}]},{}],719:[function(e,t,n){"use strict";t.exports=["LearningPathService","CourseService","$timeout","$rootScope","$window","$filter",function(m,g,v,y,e,t){return{restrict:"AE",templateUrl:function(e,t){return t.template?"/templates/learning-path/"+t.template+".html":"/templates/learning-path/inline.html"},replace:!0,link:function(i,r,t){i.$on("user:follow",u),i.$on("user:unfollow",u),y.$on("user:login",function(){i.$watch("learningPathsSet",function(){i.learningPathsSet&&e()})}),i.coursesPopulated=!1;var n,l="page-header"===t.template||"inline"===t.template?["short_description","product"]:[],d=t.$observe("preserveOrder",function(){void 0!==t.preserveOrder&&(n=i.$watch("learningPath",e),d())});function e(){var e;i.learningPath&&(i.learningPath.statesReady=!1,i.learningPath.individual_cost=0,e=o(),_.each(e,function(t){_.each(t.preview,function(e){i.freePreview||(i.freePreview=e,i.freePreviewCourse=t)})}),i.learningPath&&m.getCounts(i.learningPath._id).then(function(e){var t=0,n=0;_.each(e.reviews,function(e){n+=e.recommended,t+=e.recommended+e.not_recommended}),i.recommendation=Math.round(100*n/t)||0,i.coursesCount=o().length,i.segmentsCount=i.learningPath.lessonCount,i.studentCount=e.studentCount}),i.learningPath&&g.getPrice(i.learningPath.product).then(function(e){i.learningPath.current_price=e.current_price,i.learningPath.partial_bundle=e.partial_bundle,i.learningPath.full_price=e.full_price}),u(),e="true"===t.preserveOrder,m.getLearningPathCourses(i.learningPath,l,e).then(function(){t=s(),_.size(t)?i.learningPath.hasAccessRights=_.chain(t).values().all(function(e){return e.owned||e.subscribed}).value():i.learningPath.hasAccessRights=!1,i.numOfOwnedCourses=(t=s(),_.chain(t).values().where({owned:!0}).value().length),i.numOfLessonWatched=_.reduce(a().courses,function(e,t){return t.watched&&(e+=t.watched),e},0),n=s(),i.coursesWatchedCount=_.reduce(o(),function(e,t){t=n[t._id];return t&&(t.watched||t.active)?e+1:e},0),i.learningPath&&(r=s(),i.learningPath.individual_cost=_.reduce(i.learningPath.courses,function(e,t){var n=t&&t.product&&t.product.full_price||0;return!n||r[t._id].owned?e:e+n},0));var n,r,e,t=o();a()&&(e=i.learningPath.states.activeCourse,i.learningPath.currentCourse=t[e]),f(),i.learningPath.statesReady=!0,i.coursesPopulated=!0}),n())}function f(){switch(t.template){case"inline":v(p);break;case"page-header":v(h)}}function o(){return i.learningPath?i.learningPath.courses:[]}function a(){return i.learningPath&&i.learningPath.states}function s(){return(a()||{}).courses||{}}function p(){i.reInit=!0;var e=i.learningPath&&i.learningPath.states?i.learningPath.states.activeCourse:void 0,t=o().length,e={infinite:!1,variableWidth:!1,mobileFirst:!0,slidesToShow:1,slidesToScroll:1,initialSlide:c(e,t,1),responsive:[{breakpoint:1200,settings:{slidesToShow:3,initialSlide:c(e,t,3)}},{breakpoint:850,settings:{slidesToShow:2,initialSlide:c(e,t,2)}}]};r.find(".class-carousel").not(".slick-initialized").slick(e)}function h(){i.reInit=!0;var e=i.learningPath&&i.learningPath.states?i.learningPath.states.activeCourse:void 0,t=o().length||5,n={infinite:!1,variableWidth:!1,mobileFirst:!0,slidesToShow:1,slidesToScroll:1,initialSlide:c(e,t,1),responsive:[{breakpoint:1024,settings:{slidesToShow:3,initialSlide:c(e,t,3)}},{breakpoint:768,settings:{slidesToShow:2,initialSlide:c(e,t,2)}}]};4<=t&&n.responsive.push({breakpoint:1500,settings:{slidesToShow:4,initialSlide:c(e,t,4)}}),5<=t&&n.responsive.push({breakpoint:2e3,settings:{slidesToShow:5,initialSlide:c(e,t,5)}}),r.find(".class-carousel").not(".slick-initialized").slick(n)}function c(e,t,n){return t-n<e?t-n:e}function u(){var e;_.isFunction(y.user.valid)&&y.user.valid()&&i.learningPath&&(e={entityId:i.learningPath._id},y.user.isFollowing("bundle",e).then(function(e){i.learningPath&&(i.learningPath.active=e)}))}f()}}}]},{}],720:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("LearningPathService",e("./service")),r.directive("clLearningPaths",e("./directives/index")),r.directive("clLearningPath",e("./directives/single")),r.directive("clLearningPathProvider",e("./directives/provider")),r.directive("learningPathCms",e("./directives/cms/view")),r.directive("learningPathCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":715,"./directives/cms/view":716,"./directives/index":717,"./directives/provider":718,"./directives/single":719,"./service":721}],721:[function(e,t,n){"use strict";t.exports=["$q","$rootScope","BundleService","CourseService","CatalogService","SubscriptionService","ScoresService","cacheStack","deepval","_","DataSet",function(c,u,n,i,o,e,r,a,s,l,d){var f=this;return l.extend(f,{allLearningPaths:[],userPurchases:[],subscriptionContent:[],userContent:[],userTopicScores:[],coursesIds:new d}),{getLearningPaths:function t(n,r,i){var o=c.defer();i=i||new d;if(0===n.length||r&&i.length>=r)return o.resolve(i),o.promise;var a=n.shift();v(a).then(function(e){return I(e,a.sorting)}).then(function(e){return a.limit&&(e=e.splice(0,a.limit)),i.addToSet(e,"_id"),t(n,r,i)}).then(function(e){r&&(e=e.splice(0,r)),o.resolve(e)});return o.promise},getCounts:function(e){var t=c.defer();return a(function(t){n.getCounts(e).then(function(e){t(e)}).catch(function(){})},{key:"LearningPathService.getCounts."+e},t.resolve),t.promise},getLearningPathCourses:function(e,t,n){return c.all([function(r,e,t){var n=c.defer(),i=l.flatten(r.courses);return i=l.reject(i,function(e){return l.isObject(e)}),f.coursesIds.addToSet(i),o.getCoursesByIds(f.coursesIds,{bff:!0,keys:e||[]}).then(function(e){var n=l.indexBy(e,"_id");return r.lessonCount=0,r.courses=l.map(r.courses,function(e,t){e=n[e._id||e];return void 0===e?(r.hasUndefinedCourseData=!0,t):(r.lessonCount+=e.lessonCount,angular.copy(e))}),r.preserveOrder=t,r}).then(C).then(function(e){n.resolve(e)}),n.promise}(e,t,n),function(){var n=c.defer();if(!l.isFunction(u.user.watchHistory)||!u.user.valid())return n.resolve({segmentsCount:[],coursesWatched:[]}),n.promise;var e={limit:300,courses:f.coursesIds};return u.user.watchHistory(e).then(function(e){var e=l.chain(e).pluck("course").without(void 0).uniq().value(),t=l.countBy(i.watchDataCache,"course");n.resolve({segmentsCount:t,coursesWatched:e})}),n.promise}()]).then(function(e){var t=e[0],e=e[1];return(n?k:A)(t,e.segmentsCount,e.coursesWatched)})}};function p(){var e=c.defer();return a(function(t){o.getLearningPath().then(function(e){var n,r;f.allLearningPaths=e,f.learningPathById=_(f.allLearningPaths),f.learningPathByCourse=w(f.allLearningPaths),f.learningPathByTopic=(e=f.allLearningPaths,n={},l.each(e,function(t){l.each(t.taxonomy,function(e){n[e]?n[e].push(t):n[e]=[t]})}),n),f.learningPathByCategory=(e=f.allLearningPaths,r={},l.each(e,function(e){var t=e.primary_category&&e.primary_category._id;r[t]?r[t].push(e):r[t]=[e]}),r),t(f.allLearningPaths)}).catch(function(){})},{key:"LearningPathService.getLearningPath"},e.resolve),e.promise}function v(e){switch(e.type){case"all":return e.ids,a=c.defer(),c.all([p(),h()]).then(function(e){e=e[0];a.resolve(e)}),a.promise;case"user_followed_paths":case"user_followed_topics":case"user_purchased_paths":case"user_purchased_courses":case"user_scores":return i=e.type,o=c.defer(),c.all([p(),h()]).then(y).then(b).then(function(){if(!l.isFunction(u.user.valid)||!u.user.valid())return o.resolve();switch(i){case"user_followed_paths":S(f.userBundleFollows).then(g).then(function(e){o.resolve(e)});break;case"user_followed_topics":m(f.userTopicFollows).then(g).then(function(e){o.resolve(e)});break;case"user_purchased_paths":e=c.defer(),c.all([p(),h()]).then(function(){var t=new d;l.each(f.allLearningPaths,function(e){!function(e,t){if(!e||!t||!t.length)return!1;e=l.map(e.courses,function(e){return e._id||e});return l.intersection(e,t).length===e.length}(e,f.userPurchases)||t.addToSet(e,"_id")}),e.resolve(t)}),e.promise.then(g).then(function(e){o.resolve(e)});break;case"user_purchased_courses":E(f.userPurchases).then(g).then(function(e){o.resolve(e)});break;case"user_scores":m(l.pluck(f.userTopicScores,"_id")).then(g).then(function(e){o.resolve(e)});break;default:o.resolve([])}var e}),o.promise;case"selected_category":return n=[e.ids],r=c.defer(),c.all([p(),h()]).then(function(){var t=new d;l.each(n,function(e){t.addToSet(f.learningPathByCategory[e],"_id")}),r.resolve(t)}),r.promise;case"selected_topics":return m(e.ids);case"selected_learning_paths":return S(e.ids);case"selected_courses":return E(e.ids);default:var t=c.defer();return t.resolve([]),t.promise}var n,r,i,o,a}function h(){var e=c.defer();return l.isFunction(u.user.valid)&&u.user.valid()?(function(){var t=c.defer();if(0<f.userPurchases.length)return t.resolve(),t.promise;return u.user.getContent().then(function(e){e=s(e||{},"purchased.courses"),e=l.pluck(e,"_id");f.userPurchases=e,t.resolve()}).catch(function(){t.resolve()}),t.promise}().then(t).then(function(){f.userContent=l.uniq(f.userPurchases.concat(f.subscriptionContent)),f.indexUserContent=l.object(l.map(f.userContent,function(e){return[e,!0]})),e.resolve()}).catch(function(){e.resolve()}),e.promise):e.resolve()}function t(){var t=c.defer();return 0<f.subscriptionContent.length?t.resolve():e.getSubscriptionContentByUser().then(function(e){f.subscriptionContent=e,t.resolve()}).catch(function(){t.resolve()}),t.promise}function y(){var t=c.defer();return l.isFunction(u.user.getFollows)&&u.user.valid()?(u.user.getFollows().then(function(e){f.userBundleFollows=s(e,"data.bundle"),f.userTopicFollows=l.pluck(s(e,"data.topic"),"_id"),t.resolve()}),t.promise):t.resolve()}function b(){var t=c.defer(),e=new r;return 0<f.userTopicScores.length?t.resolve():e.fetchFilteredTopics(function(e){f.userTopicScores=e,t.resolve()}),t.promise}function _(e){var t={};return l.each(e,function(e){t[e._id]?t[e._id].push(e):t[e._id]=[e]}),t}function w(e){var n={};return l.each(e,function(t){l.each(t.courses,function(e){e=e._id||e;n[e]?n[e].push(t):n[e]=[t]})}),n}function S(e){var n=c.defer();return c.all([p(),h()]).then(function(){var t=new d;l.each(e,function(e){f.learningPathById[e]&&t.addToSet(f.learningPathById[e],"_id")}),n.resolve(t)}),n.promise}function E(e){var n=c.defer();return c.all([p(),h()]).then(function(){var t=new d;l.each(e,function(e){t.addToSet(f.learningPathByCourse[e],"_id")}),n.resolve(t)}),n.promise}function m(e){var n=c.defer();return c.all([p(),h()]).then(function(){var t=new d;l.each(e,function(e){t.addToSet(f.learningPathByTopic[e],"_id")}),n.resolve(t)}),n.promise}function A(e,t,n){var r,i,o=[],a=l.clone(e.courses),s=T(a,t),c=a.reduce(function(e,t,n){return e[t._id]={index:n,course:t},e},{});l.each(n,function(e){var t;void 0!==c[e]&&((t=c[e].course)&&o.push(t),c[e]=void 0)}),l.each(a,function(e){void 0!==c[e._id]&&(o.push(e),c[e._id]=void 0)}),o.sort(function(e,t){e=s.courses[e._id]||{},t=s.courses[t._id]||{};return e.completed?-1:t.completed?1:e.owned||e.subscribed?-1:t.owned||t.subscribed?1:0}),t=o,r=s,i=0,angular.forEach(t,function(e,t){r.courses[e._id].completed&&i++}),0<=i&&t[i]&&(t=t[i]._id,r.hasActiveCourse=!0,r.activeCourse=i,r.courses[t].active=!0),e.courses=o,e.states=s}function k(e,t){var n=l.clone(e.courses),t=T(n,t);e.courses=n,e.states=t}function T(e,n){var r={courses:{}};return l.each(e,function(e){r.courses[e._id]={owned:(t=e._id,l.contains(f.userPurchases,t)),subscribed:(t=e._id,l.contains(f.subscriptionContent,t))};var t=l.findWhere(i.watchDataCache,{course:e._id});t&&(r.courses[e._id].lastWatched=t.modified),void 0!==n[e._id]&&(r.courses[e._id].watched=n[e._id],e.lessonCount&&r.courses[e._id].watched===e.lessonCount&&(r.courses[e._id].completed=!0))}),r}function C(t){var n={},e={};return t.instructors=[],l.each(t.courses,function(t){e[t._id]=t,l.each(t.instructors,function(e){n[e._id]?n[e._id].courses.push(t._id):(n[e._id]=e,n[e._id].courses=[t._id])})}),t.indexInstructors=n,t.indexCourses=e,l.each(n,function(e){t.instructors.push(e)}),t}function I(e,t){var r,i,n,o,a,s=c.defer();switch(t){case"interactions":return g(e);case"ownership":return n=e,o=c.defer(),a=[],l.isFunction(u.user.valid)&&u.user.valid()?(l.each(n,function(e){var t=l.isObject(e.courses[0])?l.pluck(e.courses,"_id"):n.courses;e.numOfOwnCourses=l.intersection(t,f.userPurchases).length,a.push(e)}),a=l.sortBy(a,"numOfOwnCourses").reverse(),o.resolve(a),o.promise):n;case"scores":return r=e,i=c.defer(),b().then(function(){var n=l.indexBy(f.userTopicScores,"_id"),e=(l.each(r,function(t){t.score=0,l.each(t.taxonomy,function(e){n[e]&&(t.score+=n[e].score)})}),r.sort(function(e,t){return t.score-e.score}));i.resolve(e)}),i.promise;default:return s.resolve(e),s.promise}}function g(o){var a=c.defer();return l.isFunction(u.user.recentInteractions)&&u.user.valid()?u.user.recentInteractions().then(function(e){var t=s(e,"history.watch"),e=s(e,"history.purchased"),t=t.concat(e),t=l.chain(t).sortBy("last_interaction").reverse().pluck("_id").uniq().value(),n=[],r=w(o),i=_(o);l.each(t,function(e){r[e]&&r[e].length&&l.each(r[e],function(e){i[e._id]&&(n.push(e),delete i[e._id])})}),l.each(i,function(e){e&&(n=n.concat(e))}),a.resolve(n)}):a.resolve(o),a.promise}}]},{}],722:[function(e,t,n){"use strict";t.exports=function(){return{templateUrl:"/templates/leon/auth-template.html",replace:!0,scope:{data:"=",image:"<"},controller:["$scope","$http","$timeout","authService","messageService",function(n,e,t,r,i){n.message="",n.isJoining=function(){return i.isJoining(n.data.channel)},n.isAuthorizing=function(){return i.isAuthorizing(n.data.channel)},n.disabled=function(e){return e.$invalid||n.isAuthorizing()},n.clearAuthError=function(){n.errorMessage=""},n.onSubmit=function(){n.message="",n.errorMessage="",i.authorizeChannel(n.data.channel,n.data,function(e,t){e&&(n.errorMessage=e.message)})}}]}}},{}],723:[function(e,t,n){"use strict";var d=e("../utils/filters"),f=e("underscore");t.exports=function(){return{templateUrl:"/templates/leon/channel-messages-template.html",replace:!0,scope:!0,link:function(t,e,n){e.on("wheel",function(){t.$emit("input-blur")}),e.on("touchmove",function(){t.$emit("input-blur")}),n.$observe("title",function(e){t.title=t.$eval(e)}),n.$observe("state",function(e){t.state=t.$eval(e)}),n.$observe("display",function(e){t.display=t.$eval(e)}),n.$observe("allowLoadOldMessages",function(e){t.allowLoadOldMessages=t.$eval(e)}),t.allowLoadOldMessages=!0,t.linked=!0},controller:["$scope","$rootScope","$interval","$timeout","$document","$window","$sanitize","$element","messageService","configService","trackFactory",function(i,e,t,n,u,l,r,o,a,s,c){i.$rootScope=e,i.$sanitize=r,i.cfg=s,i.text="",i.sync=!1,i.content="chat",i.autoScroll=!0,i.updating=!1,i.messagesUpdated=0,i.channelManager=i.getChannelManager();i.messageDisplayLimit=100,i.getState=function(){return i.state},i.update=function(e,t){var n,r=!1;f.isArray(e)&&(t&&i.state!==t||(n=[],e.forEach(function(e){n.push(d[e])}),i.display.filters=n,r=!0)),"thread"===i.mode&&(i.getModeFilter(i.mode),r=!0),i.updateMessages(r)},i.interval=t(i.update,500,0,!1),i.$on("update",function(){i.updateMessages()}),e.$on("updateFilter",function(e,t,n){var r={filters:t,admin:i.channelManager.channel.admin,channel:i.channelManager.channelName};c.trackChat("Chat Filter Updated",r),e.preventDefault(),i.update(t,n)}),i.$on("sent",function(e,t){i.channelManager.getMessageCollection().saveMessage(t),i.updateMessages()}),i.$on("chat-input-has-been-focused",function(){i.messageDisplayLimit=100}),i.updateMessages=function(e){var t;i.linked&&(t=i.channelManager.getMessageCollection(),!e&&"stream"!==i.channelManager.getChannelMode()&&t.updated===i.messagesUpdated||(i.messagesUpdated=t.updated,e=function(e){e=e.reduce(function(e,t){return e["pinned"===(t.payload&&t.payload.content)?"pinned":"chat"].push(t),e},{chat:[],pinned:[]});{var t;0<e.pinned.length&&(t=Object.assign(e.pinned[0],{mod:i.data.mod}),i.$emit("pinned-message",t))}return e.chat}(e=t.getMessages()),t=(t=e).filter(d.isNotHidden).filter(d.isQuestion).length,i.$emit("display-num-of-leon-broadcast-qs",t),e.filter(function(e){return e.metadata.replies&&e.metadata.replies.length}).forEach(function(e){var t;e.metadata.nonHiddenReplyCount=(t=0,e.metadata.replies.forEach(function(e){e=i.channelManager.getMessageCollection().findMessage(e.reference);e&&e.metadata&&"hidden"!==e.metadata.state&&t++}),t)}),t=[d.isNotHidden],i.display.filters&&i.display.filters.length&&(t=i.display.filters),i.messages=e,t.forEach(function(e){i.messages=i.messages.filter(e)})))},i.$on("$destroy",function(){t.cancel(i.interval)}),i.hasChannelActivity=function(){return a.hasActivity(i.data.channel)},i.loadOlderMessages=function(){var e;i.messages.length<i.messageDisplayLimit+50&&(e=o[0].scrollHeight,i.channelManager.loadOlderMessages(function(){n(function(){o[0].scrollTop+=o[0].scrollHeight-e},0)})),i.messageDisplayLimit+=50,c.trackChat("Load More Chat Messages",{name:i.channelManager.channelName,messageDisplayLimit:i.messageDisplayLimit,admin:i.channelManager.channel.admin})},i.hasOlderMessages=function(){var e=i.allowLoadOldMessages&&i.channelManager.hasOlderMessages;return e=i.messages?e||i.messages.length>i.messageDisplayLimit:e},i.getMessages=function(){return i.messages},i.getChannelMode=function(){return i.channelManager.getChannelMode(i.data.channel)}}]}}},{"../utils/filters":755,underscore:void 0}],724:[function(e,t,n){"use strict";var g=e("@creativelive/editable-content-helper");t.exports=function(){return{templateUrl:"/templates/leon/chat-input-template.html",replace:!0,scope:{data:"=",mod:"<",channelManager:"="},controller:["$scope","$document","$window","$element","$timeout","deepval","rind","configService","keyboard",function(r,l,d,i,f,o,a,p,t){r.canMod=!0===r.mod;var h=i.find("#chat-prompt")[0],e=r.canMod?"pinned":"question",m=new g.echFilter(["#"+e],'<span class="tag">$&</span>'),n=new g.EditableContentHelper(h,{inputLimit:300,tags:[e],onStateChange:function(e){return e.includes(""+e)?r.form.content=""+e:r.form.content="chat"}});function s(e){return(e=(e=(e=(e=(e=(e=e.replace(/(<([^>]+)>)|(<>)/gi,"")).replace(/(&lt;([^>]+)&gt;)|(&lt;&gt;)/gi,"")).replace(/(&nbsp;)/gi," ")).replace(/(&lt;)/gi,"<")).replace(/(&gt;)/gi,">")).replace(/(&amp;)/gi,"&")).trim()}function c(){var e=i.find("#chat-prompt");e&&(e.focus(),r.isFocus=!0,n.replaceCursor())}function u(){var e,t,n=i.find("#chat-prompt");n&&n[0]&&(r.form.text=n[0].innerHTML,0<(e=s(r.form.text)).length&&((t=r.channelManager.getThreadMessageId())?r.$emit("reply",{text:e,reference:t}):r.$emit("chat",{text:e,content:r.form.content,sync:r.form.sync})),r.form.text="",n[0].innerHTML="",r.form.sync="stream"===r.channelManager.getChannelMode(),r.form.content="chat",o(a,"context.ua.mobile")?(prompt=i.find("#chat-prompt"))&&(prompt.blur(),r.isFocus=!1):c())}n.addFilter(m),n.init(),r.form={text:"",sync:!1,content:"chat"},r.isFocus=!0,r.placeholder=p.getPrompt("chat",!1),r.isPromptEmpty=function(){r.prompt||(r.prompt=i.find("#chat-prompt"));var e=r.prompt[0].innerHTML;return""===e||""===s(e)&&!(r.prompt[0].innerHTML="")},r.onBlur=function(e){r.isFocus=!1,t.blur(),o(a,"context.ua.mobile")||r.$emit("input-blur")},r.onFocus=function(e){t.focus(["chat-"+r.$id]),r.isFocus=!0,r.$emit("input-focus")},r.toggleTag=function(e){r.form.content===e?(n.removeTag(e),r.form.content="chat"):r.form.content=e,o(a,"context.ua.mobile")||c()},r.$watch(function(){return r.channelManager.getChannelMode()},function(e){o(a,"context.ua.mobile")||c(),r.form.sync="stream"===e,r.isThread="thread"===e}),t.on("chat-"+r.$id,t.EVENTS.ENTER,function(e){e.preventDefault(),r.isFocus&&u()}),r.$on("$destroy",function(){t.off("chat-"+r.$id)}),r.send=function(){r.isFocus=!0,u()}}]}}},{"@creativelive/editable-content-helper":3}],725:[function(e,t,n){"use strict";var f=e("../models/chat-message"),p=e("../models/vote-message"),h=e("../models/flag-message"),m=e("../models/state-message"),g=e("../models/activity-message");t.exports=function(){return{templateUrl:"/templates/leon/conversation-template.html",replace:!0,scope:{data:"=",mode:"=",thread:"="},controller:["$scope","$interval","$rootScope","$timeout","$document","$window","deepval","rind","messageService","ChatService","configService",function(r,n,i,o,u,e,l,d,a,s,c){function t(){r.setAutoScroll(!0)}r.channelManager=a.startChannelManager(r.data.channel,r.mode,r.thread),r.$emit("play"),r.$on("pinned-message",function(e,t){e.preventDefault(),t.metadata&&"hidden"===t.metadata.state?r.pinnedMessage=void 0:r.pinnedMessage&&r.pinnedMessage.messageId===t.messageId||(r.pinnedMessage=void 0,o(function(){r.$apply(function(){r.pinnedMessage=t})},600))}),e.addEventListener("blur",t),r.autoScroll=!0,r.getGroupScope=function(){return r},r.setAutoScroll=function(e){r.autoScroll=e},r.getAutoScroll=function(){return r.autoScroll},r.isLoading=function(){return a.isLoading(r.data.channel)},r.getChannelManager=function(){return r.channelManager},r.getThreadMessage=function(){return r.channelManager.getThreadMessage()},r.updating=!1,r.update=function(){r.$broadcast("update")},r.interval=n(r.update,3e4,0,!1),r.$watch("mode",function(e){r.channelManager.setChannelMode(e),r.display.filters=[r.getModeFilter(e)],r.setAutoScroll(!0)}),r.createChatMessage=function(e,t,n){0===(t=t.trim()).indexOf("/")&&(e="command",t=t.substring(1));e=new f({payload:{channel:r.data.channel,user:r.data.user,author:r.data.author,avatar:r.data.avatar,content:e,text:t}});return r.addMessageMetadata(e,n)},r.addMessageMetadata=function(e,t){return t&&(e.metadata.reference=t),r.data.currentVideoItem&&(e.metadata.media=[],r.data.currentVideoItem.source&&r.data.currentVideoItem.source.course&&e.metadata.media.push({id:r.data.currentVideoItem.source.course,offsetMS:-1,type:"course"}),r.data.currentVideoItem.source&&r.data.currentVideoItem.source.eventId&&e.metadata.media.push({id:r.data.currentVideoItem.source.eventId,offsetMS:1e3*Math.max(Math.round(Date.now()/1e3)-r.data.currentVideoItem.startTime,0),type:"event"}),"playlist"===r.data.currentVideoItem.source.contentType&&e.metadata.media.push({id:r.data.currentVideoItem.source.contentId,offsetMS:1e3*Math.max(Math.round(Date.now()/1e3)-r.data.currentVideoItem.startTime,0),type:"playlist"})),e},r.createVoteMessage=function(e,t){return new p({payload:{user:r.data.user,author:r.data.author,avatar:r.data.avatar,channel:r.data.channel,vote:e},metadata:{reference:t}})},r.createFlagMessage=function(e,t){return new h({payload:{user:r.data.user,author:r.data.author,avatar:r.data.avatar,channel:r.data.channel,content:e||"review"},metadata:{reference:t}})},r.createStateMessage=function(e,t){return new m({payload:{user:r.data.user,author:r.data.author,avatar:r.data.avatar,channel:r.data.channel,content:e||"reviewed"},metadata:{reference:t}})},r.createActivityMessage=function(){return new g({payload:{channel:r.data.channel,user:r.data.user}})},r.$on("video-chat:channel-switch",function(e,t){e.preventDefault(),n.cancel(r.interval),r.channelManager.stop(),angular.extend(r.data,{channel:t.channel,currentVideoItem:t.currentVideoItem}),a.authorizeChannel(t.channel,r.data,function(e){e&&(r.errorMessage=e.message)}),i.$broadcast("reset-chat-filters")}),r.$on("$destroy",function(){n.cancel(r.interval),r.channelManager&&r.channelManager.stop()}),r.$on("reply",function(e,t){t=r.createChatMessage(r.content,t.text,t.reference);a.send(t),t.isSending=!0,r.$broadcast("sent",t)}),r.$on("vote",function(e,t){t=r.createVoteMessage(t.vote,t.reference);a.send(t),r.$broadcast("sent",t)}),r.$on("flag",function(e,t){t=r.createFlagMessage(t.flag,t.reference);a.send(t),r.$broadcast("sent",t)}),r.$on("state",function(e,t){t=r.createStateMessage(t.state,t.reference);a.send(t),r.$broadcast("sent",t),r.$broadcast("update")}),r.$on("activity",function(e,t){var n=r.createActivityMessage();a.send(n)}),r.$on("chat",function(e,t){var n=r.createChatMessage(t.content,t.text);!t.sync||(t=a.getChannelMediaOffset(r.data.channel))&&n.setMediaOffset(t.id,t.offset),a.send(n),n.isSending=!0,r.$broadcast("sent",n)}),r.$on("input-focus",function(){r.setAutoScroll(!0),r.$broadcast("chat-input-has-been-focused")}),r.$on("input-blur",function(){r.setAutoScroll(!1)}),r.$on("thread-modal-close",function(){r.setAutoScroll(!0)}),r.$on("message-sent",function(){r.setAutoScroll(!0)}),r.getChannelError=function(){var e=a.getChannel(r.data.channel);return e&&e.error||null},r.clearChannelError=function(){var e=a.getChannel(r.data.channel);e&&(e.error=null)},r.getChannelMode=function(){return r.channelManager.getChannelMode()},r.setChannelMode=function(e){r.channelManager.setChannelMode(e)},r.getPrompt=function(e,t){return c.getPrompt(e,t)},r.getTitle=function(e,t){return c.getTitle(e,t)},r.getModeFilter=function(e){return"best"===e?function(e){return 0<e.metadata.score&&("note"===e.payload.content||"question"===e.payload.content||"like"===e.payload.content)}:"stream"===e?function(e){var t=a.getChannelMediaOffset(r.channelManager.channelName);return"chat"===e.type&&"hidden"!==e.metadata.state&&t&&e.isMediaOffsetInRange(t.id,t.offset)}:function(e){return"hidden"!==e.metadata.state}},r.display={filters:[r.getModeFilter(r.mode)]},r.$on("$destroy",function(){e.removeEventListener("blur",t)}),r.$on("user-kicked",function(e,t){e.preventDefault(),s.kickUser(t.user).then(function(){r.$emit("chat",{text:"kick "+t.user+" "+t.author,content:"command"})})}),r.$on("user-unkicked",function(e,t){e.preventDefault(),s.unkickUser(t.payload.user)})}]}}},{"../models/activity-message":734,"../models/chat-message":736,"../models/flag-message":737,"../models/state-message":743,"../models/vote-message":745}],726:[function(e,t,n){"use strict";var h=e("../utils/filters");t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/leon/deckard.html",replace:!1,link:function(e,t,n){},controller:["$scope","$rootScope","$filter","$routeParams","$window","messageService","threadModalService","confirmKickModalService","CatalogService","config","deepval",function(n,e,t,r,i,o,a,l,d,f,s){var c={title:"general",show:!0,state:"default",autoScroll:!0,display:{filters:[h.isNotHidden]}},p={title:"candidate",show:!0,state:"candidate",autoScroll:!1,display:{filters:[h.isCandidate]}},u={title:"on-deck",show:!0,state:"on-deck",autoScroll:!1,display:{filters:[h.isNotAsked]}},c=(n.columns={general:c,ondeck:u,candidate:p},n.data||(n.data={}),angular.extend(n.data,{channel:r.channel||"default",admin:!0,read:!0,write:!0,vote:!0,mod:!0,mode:"live"}),{});e.user.valid()&&(u=t("magick")(s(e,"user._data.profile.image")),c={author:e.user.slug.split("-").join(" ").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})||s(e,"user.slug")||"CreativeLive Student",user:i.localStorage.mcpUser||"",email:e.user.primary_email.address||"",avatar:u||!1}),angular.extend(n.data,c),n.messageService=o,n.messageService.authorizeChannel(n.data.channel,n.data,function(e,t){}),n.$on("thread",function(e,t){a.open({scope:n,thread:t})}),n.$on("kick-user",function(e,t){l.open({scope:n,message:t})}),n.isChannelAuthorized=function(){var e=n.messageService.getChannel(n.data.channel);return e&&"authorized"===e.authState},n.getChannelMode=function(){return n.data.mode},d.getCourseBySlug(r.channel).then(function(e){n.information=e}).catch(function(){n.information={short_title:r.channel}})}]}}]},{"../utils/filters":755}],727:[function(e,t,n){"use strict";function r(r){return{templateUrl:"/templates/leon/filter-template.html",replace:!0,scope:!0,link:function(t,e,n){t.$on("reset-chat-filters",function(e){e.preventDefault(),t.displayedFilter=t.displayedFilterOptions[n.defaultValue]}),n.$observe("filterOptions",function(e){e&&(t.displayedFilterOptions=JSON.parse(e),t.displayedFilter||(t.displayedFilter=t.displayedFilterOptions[n.defaultValue]))}),n.$observe("filterState",function(e){e&&(t.filterState=e)}),t.updateFilter=function(e){t.displayedFilter=t.displayedFilterOptions[e],r.$broadcast("updateFilter",e.split(","),t.filterState)}}}}r.$inject=["$rootScope"],t.exports=r},{}],728:[function(e,t,n){"use strict";function r(o,a,s,c){return{restrict:"A",scope:{channel:"=",player:"=",showButton:"=",shiftDown:"=?",information:"=?",multipleSwimlanes:"@"},templateUrl:"templates/leon/leon-button.html",link:function(t,e,n){var r=s.context.uaString.includes("Trident/"),i=s.context.uaString.includes("Edge/");t.isEdgeOrIE=r||i,e.on("click",function(){if(!0===t.showButton){if(!c.user||!c.user.valid())return!1;t.data={channel:t.channel,currentVideoItem:t.player.currentVideoItem};var e=a.find("#video-player");e=e||t.player,o.open({scope:t,player:e[0]})}})}}}r.$inject=["leonModalService","$document","rind","$rootScope"],t.exports=r},{}],729:[function(e,t,n){"use strict";var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(){return{restrict:"AE",templateUrl:"/templates/leon/leon.html",replace:!0,controller:["$scope","$rootScope","$filter","$location","$attrs","messageService","threadModalService","confirmKickModalService","kickNoticeModalService","deepval","trackFactory",function(n,e,t,l,r,i,o,a,d,s,f){var c,u={},p=(e.user.valid()&&(c=t("magick")(e.user._data.profile.image),u={author:t("prettyUsername")(s(e,"user._data"),"Creativelive Student",!0,!1,!0,!0),user:s(e,"user._data._id"),email:s(e,"user._data.user.primary_email.address"),avatar:c||!1}),"object"!==h(n.data)&&(n.data={}),angular.extend(n.data,u),angular.extend(n.data,{channel:n.data.channel||r.channel||"default",mod:!1,mode:"live"}),n.messageService=i,n.messageService.authorizeChannel(n.data.channel,n.data,function(e,t){e||angular.extend(n.data,{read:t.read,write:t.write,vote:t.vote,admin:t.admin})}),e.$on("display-kick-notice-to-user-modal",function(e,t){i.leave(t.payload,!0),e.preventDefault(),e.stopPropagation(),d.open({scope:n})}));n.$on("thread",function(e,t){o.open({scope:n,thread:t})}),n.$on("kick-user",function(e,t){a.open({scope:n,message:t})}),n.isChannelAuthorized=function(){var e=n.messageService.getChannel(n.data.channel);return e&&"authorized"===e.authState},n.getChannelMode=function(){return n.data.mode},n.$on("$destroy",function(){p()})}]}}},{}],730:[function(e,t,n){"use strict";var l=e("moment"),d=e("underscore"),f=e("@creativelive/editable-content-helper");t.exports=function(){return{restrict:"E",replace:!0,transclude:!0,scope:{message:"<",user:"<",reference:"<",mod:"<",admin:"<",mode:"<",isFirst:"<",isLast:"<",idx:"<",kickedUsers:"<?"},templateUrl:function(e,t){return t.template?"/templates/leon/"+t.template+".html":"/templates/leon/message-template.html"},controller:["$scope","$rootScope","$element","$timeout","$filter","deepval","rind","StudentService","messageService",function(s,t,n,r,i,o,e,a,c){s.messageId=s.$id,s.sendFailed=!1,r(function(){var e=n.find("#message-payload-"+s.messageId)[0],t=new f.echFilter(["#question"],'<span class="tag">$&</span>'),e=new f.EditableContentHelper(e);e.addFilter(t),e.init()}),s.showStudentCard=!1,s.createdDate="just now",s.replyData={text:"",show:!1},s.showFlagMenu=!1,s.showModMenu=!1,s.isMobile=o(e,"context.ua.mobile"),s.state=s.message.metadata.state,s.togglePinnedMessage="hide",s.showPinnedMessage=!0,s.message.metadata.reference&&(s.reference&&s.reference.payload.author?s.formattedReference="In reply to "+s.reference.payload.author+"'s comment":s.formattedReference=s.message.payload.author+" replied"),"system"===s.message.type&&"welcome"===s.message.payload.content&&(s.message.payload.text=function(){{var e;t.user.valid()&&(e={studentFirstName:o(t,"user._data.profile.first_name")?" "+t.user._data.profile.first_name:""})}return i("i18n")("cl-chat-welcome-message",'Welcome to the class{{ studentFirstName }}!<br> Chat with your fellow students, or click the <strong class="brand-highlight">?</strong> if you want to ask a question.',e)}()),"chat"===s.message.type&&"command"===s.message.payload.content&&(e=s.message.payload.text.split(" "),s.command=e[0],s.victimName=e.slice(2).join(" ")),s.$watch("message.isSending",function(e){"chat"===s.message.type&&(e?r(function(){s.message.isSending&&(s.sendFailed=!0)},5e3):s.sendFailed=!1)});var u,e=Date.now()-s.message.metadata.created;6048e5<e?s.createdDate="":1728e5<e?s.createdDate="a few days ago":864e5<e?s.createdDate="a day ago":0<e&&s.$watch(function(e){return l(e.message.metadata.created).fromNow().replace(/seconds|minutes|hours/g,function(e){switch(e){case"minutes":return"min";case"hours":return"hr";case"seconds":return"sec";default:return e}})},function(e){s.createdDate=e}),!s.mod||(e=s.message.metadata.transitions)&&e.length&&(e=(u=e[e.length-1]).user,a.findById(e).then(function(e){s.moderatorName=i("prettyUsername")(e,e.user.slug,!0,!0,!0,!0),s.moderationAction=function(e){var t=null;switch(e){case"hidden":t="Hidden";break;case"asked":t="Asked";break;default:t="Moved"}return t}(u.state)})),s.joinedString=i("i18n")("cl-chat-joined","joined"),s.leftString=i("i18n")("cl-chat-left","left"),s.viewThreadString=i("i18n")("cl-chat-view-thread","View Thread"),s.replyString=i("i18n")("cl-chat-reply","Reply"),s.flaggedString=i("i18n")("cl-chat-flagged","Flagged"),s.failedToSendString=i("i18n")("cl-chat-send-failed-message","Failed to send"),s.retryString=i("i18n")("cl-chat-retry","Retry"),s.showString=i("i18n")("cl-chat-mod-show","Show"),s.hideString=i("i18n")("cl-chat-mod-hide","hide"),s.removeFlagString=i("i18n")("cl-chat-mod-remove-flag","remove flag"),s.kickString=i("i18n")("cl-chat-mod-kick","kick"),s.unkickString=i("i18n")("cl-chat-mod-unkick","unkick"),s.offensiveString=i("i18n")("cl-chat-flag-offensive","offensive"),s.offTopicString=i("i18n")("cl-chat-flag-off-topic","off topic"),s.spamString=i("i18n")("cl-chat-flag-spam","spam/promotional"),s.miscategorizedString=i("i18n")("cl-chat-flag-miscategorized","miscategorized"),s.numAndReplyString=i("i18n")("cl-chat-number-reply","{{ replyCount }} {{ replyCount > 1 ? 'replies' : 'reply' }}",{replyCount:s.message.metadata.nonHiddenReplyCount}),s.viewReplyString=i("i18n")("cl-chat-view-reply","{{ replyCount > 1 ? 'View Replies' : 'View Reply' }}",{replyCount:s.message.metadata.nonHiddenReplyCount}),s.markAsAskedString=i("i18n")("cl-chat-mark-as-asked","mark as asked"),s.unmarkAskedString=i("i18n")("cl-chat-unmark-asked","unmark asked"),s.systemOnlyVisibleToYouString=i("i18n")("cl-chat-system-only-visible-to-you","This is only visible to you."),s.togglePinned=function(){s.showPinnedMessage=!s.showPinnedMessage,s.togglePinnedMessage=s.showPinnedMessage?"hide":"show"},s.openThread=function(){s.showFlagMenu=!1,s.showModMenu=!1,s.$emit("thread",s.message.metadata.reference||s.message.messageId)},s.kickUser=function(){s.$emit("kick-user",s.message)},s.unkickUser=function(){s.$emit("user-unkicked",s.message),s.submitCommand("unkick")},s.toggleReplyForm=function(){s.replyData.show=!s.replyData.show},s.showReplyForm=function(){return s.replyData.show},s.submitReply=function(){var e=s.message.metadata.reference||s.message.messageId;s.$emit("reply",{text:s.replyData.text,reference:e}),s.replyData.text="",s.replyData.show=!1},s.submitVote=function(e){var t=e?1:-1;s.myVote+=t,s.totalVote+=t,s.$emit("vote",{vote:e,reference:s.message.messageId})},s.submitFlag=function(e){s.showFlagMenu=!1,s.showModMenu=!1,s.$emit("flag",{flag:e,reference:s.message.messageId})},s.submitMod=function(e){s.showFlagMenu=!1,s.showModMenu=!1,s.$emit("state",{state:e,reference:s.message.messageId})},s.submitCommand=function(e){s.$emit("chat",{text:e+" "+s.message.payload.user+" "+s.message.payload.author,content:"command"})},s.isSelfPost=function(){return!!s.message.payload.user&&(!!t.user.valid()&&(!!t.user._data&&s.message.payload.user===(t.user._id||t.user._data._id)))},s.getVote=function(){for(var e=0,t=s.message.metadata.voters||[],n=0,r=t.length;n<r;n++){var i=t[n];i.user===s.user&&(e=i.vote)}return e},s.getTotalVote=function(){for(var e={},t=s.message.metadata.voters||[],n=0,r=t.length;n<r;n++){var i=t[n];s.message.payload.user!==i.user&&(e[i.user]=i.vote)}var o,a=0;for(o in e)a+=e[o];return a},s.selfPost=s.isSelfPost(),s.canVote=!s.selfPost,"chat"===s.message.type&&(s.canVote&&(s.myVote=s.getVote()),s.totalVote=s.getTotalVote()),s.canMod=s.mod,s.getReplyCount=function(){for(var e={},t=s.message.metadata.replies||[],n=0,r=t.length;n<r;n++){var i=t[n];e[i.reference]=i}return d.size(e)};s.getTime=function(){if(!s.message.metadata.media||!s.message.metadata.media.length)return null;var t=c.getChannel(s.message.payload.channel);if(!t||!t.currentMedia)return null;var e=s.message.metadata.media.find(function(e){return e.id===t.currentMedia});if(!e)return null;var e=e.offset,n=Math.floor(e/36e5),r=(e-=36e5*n,Math.floor(e/6e4)),e=(e-=6e4*r,Math.floor(e/1e3));return(n<10?"0":"")+n+":"+((r<10?"0":"")+r)+":"+((e<10?"0":"")+e)},s.toggleStudentCard=function(e){var t=e?!1:!1;(t=null===e?!s.showStudentCard:t)?(s.showStudentCard=!0,r(function(){s.openStudentCard=!0})):(s.openStudentCard=!1,r(function(){s.showStudentCard=!1},1e3))},s.resend=function(){c.send(s.message)}}]}}},{"@creativelive/editable-content-helper":3,moment:void 0,underscore:void 0}],731:[function(e,t,n){"use strict";t.exports=function(){return{templateUrl:"/templates/leon/message-list-template.html",replace:!0,transclude:!0,scope:!0,controller:["$scope","ChatService",function(t,e){t.kickedUsers={},e.initKickedUser(),t.kickedUsers=e.kickedUsers,t.getReference=function(e){return e.metadata.reference?t.channelManager.getMessageCollection().findMessage(e.metadata.reference):null}}]}}},{}],732:[function(e,t,n){"use strict";var u=e("../models/chat-message"),l=e("../models/vote-message"),d=e("../models/flag-message"),f=e("../models/state-message"),p=e("../models/activity-message");t.exports=["ChatService",function(r){return{templateUrl:"/templates/leon/moderation-template.html",replace:!0,scope:{data:"=",mode:"=",columns:"="},link:function(n,e,t){n.$on("user-kicked",function(e,t){e.preventDefault(),r.kickUser(t.user).then(function(){n.$emit("chat",{text:"kick "+t.user+" "+t.author,content:"command"})})}),n.$on("user-unkicked",function(e,t){e.preventDefault(),r.unkickUser(t.payload.user)})},controller:["$scope","$interval","$timeout","$document","$window","messageService","configService","dragulaService","_",function(o,e,t,n,r,a,i,s,c){o.$on("pinned-message",function(e,t){e.preventDefault(),o.pinnedMessage=t}),o.channelManager=a.startChannelManager(o.data.channel,o.mode,o.thread,!0),o.$emit("play"),o.dragable=!0,r.onblur=function(){o.setAutoScroll(!0)},o.getGroupScope=function(){return o},o.setAutoScroll=function(t){c.each(o.columns,function(e){e.autoScroll=t})},o.updateGeneralFilter=function(e){o.displayedGeneralFilter=o.displayedGeneralFilterOptions[e],o.$broadcast("updateFilter",e,"reviewed")},o.updateOndeckFilter=function(e){o.displayedOndeckFilter=o.displayedOndeckFilterOptions[e],o.$broadcast("updateFilter",e,"on-deck")},o.updating=!1,o.update=function(){o.$broadcast("update")},o.interval=e(o.update,3e4,0,!1),o.$watch("mode",function(e){o.channelManager.setChannelMode(e),o.setAutoScroll(!0)}),o.createChatMessage=function(e,t,n){return 0===(t=t.trim()).indexOf("/")&&(e="command",t=t.substring(1)),new u({payload:{channel:o.data.channel,user:o.data.user,author:o.data.author,avatar:o.data.avatar,content:e,text:t},metadata:{reference:n}})},o.createVoteMessage=function(e,t){return(new l).load({payload:{user:o.data.user,author:o.data.author,avatar:o.data.avatar,channel:o.data.channel,vote:e},metadata:{reference:t}})},o.createFlagMessage=function(e,t){return new d({payload:{user:o.data.user,author:o.data.author,avatar:o.data.avatar,channel:o.data.channel,content:e||"review"},metadata:{reference:t}})},o.createStateMessage=function(e,t){return new f({payload:{user:o.data.user,author:o.data.author,avatar:o.data.avatar,channel:o.data.channel,content:e||"reviewed"},metadata:{reference:t}})},o.createActivityMessage=function(){return new p({payload:{channel:o.data.channel,user:o.data.user}})},o.isReady=function(){return a.isReady()},o.isChannelAuthorized=function(){var e=a.getChannel(o.data.channel);return e&&"authorized"===e.authState},o.$on("$destroy",function(){o.channelManager.stop(),e.cancel(o.interval)}),o.$on("reply",function(e,t){t=o.createChatMessage(o.content,t.text,t.reference);a.send(t),t.isSending=!0,o.$broadcast("sent",t),o.focusInput()}),o.$on("vote",function(e,t){t=o.createVoteMessage(t.vote,t.reference);a.send(t),o.$broadcast("sent",t)}),o.$on("flag",function(e,t){t=o.createFlagMessage(t.flag,t.reference);a.send(t),o.$broadcast("sent",t),o.$broadcast("update")}),o.$on("activity",function(e,t){var n=o.createActivityMessage();a.send(n)}),o.$on("state",function(e,t){t=o.createStateMessage(t.state,t.reference);a.send(t),o.$broadcast("sent",t),o.$broadcast("update")}),o.$on("chat",function(e,t){var n=o.createChatMessage(t.content,t.text);!t.sync||(t=a.getChannelMediaOffset(o.data.channel))&&n.setMediaOffset(t.id,t.offset),a.send(n),n.isSending=!0,o.$broadcast("sent",n)}),o.$on("input-focus",function(){o.setAutoScroll(!0),o.$broadcast("chat-input-has-been-focused")}),o.$on("input-blur",function(){o.setAutoScroll(!1)}),o.getChannelError=function(){var e=a.getChannel(o.data.channel);return e&&e.error||null},o.clearChannelError=function(){var e=a.getChannel(o.data.channel);e&&(e.error=null)},o.getChannelMode=function(){return o.channelManager.getChannelMode()},o.setChannelMode=function(e){o.channelManager.setChannelMode(e)},o.getChannelManager=function(){return o.channelManager},o.getThreadMessage=function(){return o.channelManager.getThreadMessage()},o.getPrompt=function(e,t){return i.getPrompt(e,t)},o.getTitle=function(e,t){return i.getTitle(e,t)},s.options(o,"bag",{moves:function(e,t,n,r){return n.classList.contains("handle")||n.parentNode.classList.contains("handle")}}),o.$on("bag.drag",function(e,t){t.addClass("ui comments dragging-message"),o.dragging=angular.element(t[0]).scope().m.messageId}),o.$on("bag.drop",function(e,t,n,r,i){t.removeClass("ui comments dragging-message");t=angular.element(n).scope(),n=o.createStateMessage(t.getState(),o.dragging);a.send(n),o.$broadcast("sent",n),o.$broadcast("update")}),o.$on("bag.over",function(e,t,n,r){n.addClass("dragging-over")}),o.$on("bag.out",function(e,t,n,r){n.removeClass("dragging-over")}),o.$on("bag.cancel",function(e,t){t.removeClass("ui comments dragging-message")}),o.$on("bag.dragend",function(e,t){t.removeClass("ui comments dragging-message")})}]}}]},{"../models/activity-message":734,"../models/chat-message":736,"../models/flag-message":737,"../models/state-message":743,"../models/vote-message":745}],733:[function(e,t,n){"use strict";t.exports=["$timeout",function(r){return{restrict:"A",link:function(t,e,n){t.scheduleScrollCheck=function(){t.timer||(t.timer=r(function(){t.timer=null,e[0].scrollTop=e[0].scrollHeight,t.scheduleScrollCheck()},500,!1))},t.$watch(n.autoScroll,function(e){t.autoScroll=e,t.autoScroll?t.scheduleScrollCheck():t.timer&&(r.cancel(t.timer),t.timer=null)}),t.$on("$destroy",function(){t.timer&&(r.cancel(t.timer),t.timer=null)})}}}]},{}],734:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"activity",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),this}}]),n}();t.exports=e},{"./message":742}],735:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("./message-collection");function a(e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.name=e,this.managers=[],this.token=null,this.user=null,this.author=null,this.avatar=null,this.email=null,this.read=!1,this.write=!1,this.vote=!1,this.mod=!1,this.admin=!1,this.streamMessages=new o,this.authState="unauthorized",this.joinState="idle",this.isLoading=!1,this.joinCallback=null,this.joinRequests=[],this.error=null,this.lastActive=0,this.mode="best"}r(a,[{key:"isAuthorized",value:function(){return!!this.token}},{key:"setAuthInfo",value:function(e){this.authInfo=e}}]),t.exports=a},{"./message-collection":741}],736:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return v(r,t,n)}var o=e("./message"),e=function(){var e=g,t=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function g(e){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var t=this,e=(g.__proto__||Object.getPrototypeOf(g)).call(this,"chat",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(g,[{key:"load",value:function(e){if(e===this)return this;if(v(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"load",this).call(this,e),e.payload&&(e.payload.text&&(this.payload.text=e.payload.text),e.payload.content&&"chat"!==e.payload.content&&(this.payload.content=e.payload.content)),e.metadata){if(e.metadata.replies&&e.metadata.replies.length){this.metadata.replies=this.metadata.replies||[];for(var t=0,l=e.metadata.replies.length;t<l;++t){var d=e.metadata.replies[t];this.saveReply(d.user,d.reference)}}if(e.metadata.voters&&e.metadata.voters.length){this.metadata.voters=this.metadata.voters||[];for(var n=0,f=e.metadata.voters.length;n<f;++n){var r=e.metadata.voters[n];this.saveVote(r.user,r.vote,r.reference)}this.metadata.score=this.computeScore()}if(e.metadata.flaggers&&e.metadata.flaggers.length){this.metadata.flaggers=this.metadata.flaggers||[];for(var i=0,p=e.metadata.flaggers.length;i<p;++i){var o=e.metadata.flaggers[i];this.saveFlag(o.user,o.flag,o.reference)}}if(e.metadata.transitions&&e.metadata.transitions.length){this.metadata.transitions=this.metadata.transitions||[];for(var a=0,h=e.metadata.transitions.length;a<h;++a){var s=e.metadata.transitions[a];this.saveTransition(s.user,s.state,s.reference)}}if(e.metadata.media&&e.metadata.media.length)for(var c=0,m=e.metadata.media.length;c<m;++c){var u=e.metadata.media[c];this.setMediaOffset(u.id,u.offsetMS,u.type)}}return this}},{key:"copy",value:function(){return new g(this)}},{key:"hasReferences",value:function(e){if(this===e||this.metadata.updated===e.metadata.updated)return!0;if(!(e instanceof g))throw new Error("type mismatch");for(var t=e.metadata.voters||[],n=0,r=t.length;n<r;++n)if(!this.hasVote(t[n].reference))return!1;for(var i=e.metadata.replies||[],o=0,l=i.length;o<l;++o)if(!this.hasReply(i[o].reference))return!1;for(var a=e.metadata.flaggers||[],s=0,d=a.length;s<d;++s)if(!this.hasFlag(a[s].reference))return!1;for(var c=e.metadata.transitions||[],u=0,f=c.length;u<f;++u)if(!this.hasTransition(c[u].reference))return!1;return!0}},{key:"hasReply",value:function(t){return-1!==(this.metadata.replies||[]).findIndex(function(e){return e.reference===t})}},{key:"saveReply",value:function(e,t){var n=!0,r={user:e,reference:t};return this.metadata.replies?this.metadata.replies.find(function(e){return e.reference===r.reference})?n=!1:this.metadata.replies.push(r):this.metadata.replies=[r],n}},{key:"hasVote",value:function(t){return-1!==(this.metadata.voters||[]).findIndex(function(e){return e.reference===t})}},{key:"saveVote",value:function(e,t,n){var r=!0,i={user:e,vote:t,reference:n};return this.metadata.voters?this.metadata.voters.find(function(e){return e.reference===i.reference})?r=!1:this.metadata.voters.push(i):this.metadata.voters=[i],r}},{key:"getFlagState",value:function(){return JSON.stringify(this.metadata.flaggers)}},{key:"hasFlag",value:function(t){return-1!==(this.metadata.flaggers||[]).findIndex(function(e){return e.reference===t})}},{key:"saveFlag",value:function(e,t,n){var r=!0,i={user:e,flag:t,reference:n};return this.metadata.flaggers?this.metadata.flaggers.find(function(e){return e.reference===i.reference})?r=!1:this.metadata.flaggers.push(i):this.metadata.flaggers=[i],r}},{key:"hasTransition",value:function(t){return-1!==(this.metadata.transitions||[]).findIndex(function(e){return e.reference===t})}},{key:"saveTransition",value:function(e,t,n){var r=!0,i={user:e,state:t,reference:n};return this.metadata.transitions?this.metadata.transitions.find(function(e){return e.reference===i.reference})?r=!1:this.metadata.transitions.push(i):this.metadata.transitions=[i],this.metadata.state=this.metadata.transitions[this.metadata.transitions.length-1].state,r}},{key:"isHidden",value:function(){return this.metadata.state&&"hidden"===this.metadata.state}},{key:"isFlagged",value:function(t){return!(!this.metadata.flaggers||!this.metadata.flaggers.length)&&(!t||!!this.metadata.flaggers.find(function(e){return e.user===t}))}},{key:"getFlagCount",value:function(){if(!this.metadata.flaggers||!this.metadata.flaggers.length)return 0;for(var e={},t=0,n=0,r=this.metadata.flaggers.length;n<r;++n){var i=this.metadata.flaggers[n];e[i.user]||t++,e[i.user]=i.flag}return t}},{key:"setMediaOffset",value:function(t,e,n){this.metadata.media||(this.metadata.media=[]);var r=this.metadata.media.find(function(e){return e.id===t});r?(r.offsetMS=e,r.type=n):this.metadata.media.push({id:t,offsetMS:e,type:n})}},{key:"getMediaOffset",value:function(t){if(!this.metadata.media||!this.metadata.media.length)return-1;var e=this.metadata.media.find(function(e){return e.id===t});return e?e.offsetMS:-1}},{key:"isMediaOffsetInRange",value:function(e,t){e=this.getMediaOffset(e);return-1!==e&&e<=t}},{key:"computeScore",value:function(){for(var e={},t=(this.metadata.voters||(this.metadata.score=0),this.metadata.voters||[]),n=0,r=t.length;n<r;++n){var i=t[n];this.payload.user!==i.user&&(e[i.user]=i.vote)}var o,a=0;for(o in e)a+=e[o];return a}}],[{key:"compareByMediaOffset",value:function(e,t,n){var r=e instanceof g?e.getMediaOffset(n||this):-1,n=t instanceof g?t.getMediaOffset(n||this):-1;return-1!==r&&-1!==n&&Math.abs(r-n)<6e4&&Math.abs(e.metadata.created-t.metadata.created)<6e4?o.compareByCreated(e,t):n<r?1:r<n?-1:o.compareByCreated(e,t)}},{key:"compare",value:function(e,t,n){return n?g.compareByMediaOffset(e,t,n):o.compareByCreated(e,t)}}]),g}();t.exports=e},{"./message":742}],737:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"flag",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742}],738:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("uuid/v4"),s=e("./message"),e=function(){var e=n,t=s;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,"hello",e));return e.messageId=a(),e.metadata={created:Date.now()},e.payload={clientId:void 0},e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||(o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),e.payload&&e.payload.clientId&&(this.payload.clientId=e.payload.clientId)),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742,"uuid/v4":69}],739:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"join",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||(o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),e.payload&&(Number.isInteger(e.payload.flags)&&(this.payload.flags=e.payload.flags),e.payload.token&&(this.payload.token=e.payload.token)),e.metadata&&(e.metadata.result&&e.metadata.result.error?this.metadata.result={error:e.metadata.result.error,success:!1}:e.metadata.result&&e.metadata.result.success&&(this.metadata.result={success:!0}))),this}},{key:"copy",value:function(){return new n(this)}},{key:"isSuccess",value:function(){return this.metadata.result&&this.metadata.result.success}},{key:"isError",value:function(){return!this.metadata.result||this.metadata.result&&this.metadata.result.error}},{key:"getErrorMessage",value:function(){return!this.metadata.result||this.metadata.result.success?null:this.metadata.result.message||"join error"}},{key:"getError",value:function(){return!this.metadata.result||this.metadata.result.success?null:this.metadata.result.error||"JOIN_ERROR"}}]),n}();t.exports=e},{"./message":742}],740:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"leave",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742}],741:[function(e,t,l){"use strict";var n=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("uuid/v4"),o=e("./message"),a=e("./chat-message"),s=e("./system-message"),c=e("./join-message"),d=e("./leave-message"),e=(n(u,[{key:"clear",value:function(){this.index={},this.messages.length=0,this.updated=Date.now()}},{key:"findMessage",value:function(e){return this.index[e]}},{key:"retractMessage",value:function(e){}},{key:"saveUncommittedUpdate",value:function(t){var e;t.metadata.reference&&((e=(e=this.uncommitted[t.metadata.reference])||(this.uncommitted[t.metadata.reference]=[])).find(function(e){return e.messageId===t.messageId})||e.push(t))}},{key:"applyUncommittedUpdates",value:function(e){e=this.index[e];if(e){var t=this.uncommitted[e.messageId];if(t){for(var n=0,r=t.length;n<r;++n)this.updateReferencedMessage(t[n]);delete this.uncommitted[e.messageId]}}}},{key:"saveMessage",value:function(e){if(this.filter&&!this.filter(e))return null;var t=this.index[e.messageId];if(t){if(t===e)return null;if(t.isSending&&delete t.isSending,t.metadata.updated===e.metadata.updated)return null;if(!(t instanceof a))return null;if(t.hasReferences(e))return null;var t=t.copy().load(e),n=this.findIndex(e);if(-1===n)throw new Error("message collection is inconsistent!");return this.messages[n]=this.index[t.messageId]=t,this.updated=Date.now(),this.notify(e),t}return this.updated=Date.now(),(this.index[e.messageId]=e)instanceof a||e instanceof s||e instanceof c||e instanceof d?(this.sortedInsert(e),this.applyUncommittedUpdates(e)):this.modifiers.push(e),e.metadata.reference&&!this.index[e.metadata.reference]&&this.saveUncommittedUpdate(e),this.notify(e),this.updateReferencedMessage(e),e}},{key:"findInsertionIndex",value:function(e){for(var t=this.getMessages(),n=-1,r=t.length;1+n!==r;){var i=n+(r-n>>1),o=this.comparator(e,t[i]);if(o<0)r=i;else{if(!(0<o))return i;n=i}}return r}},{key:"findIndex",value:function(e){var t=this.findInsertionIndex(e);return t===this.messages.length||this.messages[t].messageId!==e.messageId?-1:t}},{key:"sortedInsert",value:function(e){var t=this.getMessages(),n=this.findInsertionIndex(e);t.splice(n,0,e)}},{key:"updateReferencedMessage",value:function(e){var t,n=e.metadata.reference;!n||(n=this.index[n])&&(n=n.copy(),t=!1,"chat"===e.type?t=n.saveReply(e.payload.user,e.messageId):"vote"===e.type?(t=n.saveVote(e.payload.user,e.payload.vote,e.messageId))&&(n.metadata.score=n.computeScore()):"flag"===e.type?t=n.saveFlag(e.payload.user,e.payload.content,e.messageId):"state"===e.type&&(t=n.saveTransition(e.payload.user,e.payload.content,e.messageId)),t&&(e.metadata.created>(n.metadata.updated||0)&&(n.metadata.updated=e.metadata.created),this.saveMessage(n)))}},{key:"saveMessages",value:function(e){if(!e)return this;if(e instanceof u)return this.addAllMessages(e),this;if(Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.saveMessage(e[t]);else{if(e!==Object(e))throw new Error("unknown type of message source");for(var r in e)this.saveMessage(e[r])}return this}},{key:"subscribe",value:function(e){if(!this.listeners.includes(e)){this.listeners.push(e);for(var t,n=0,r=this.messages.length;n<r;++n)e.saveMessage(this.messages[n]);for(t in this.uncommitted)if(this.uncommitted.hasOwnProperty(t))for(var i=this.uncommitted[t],o=0,a=i.length;o<a;++o)e.saveMessage(i[o])}}},{key:"unsubscribe",value:function(e){e=this.listeners.indexOf(e);-1!==e&&this.listeners.splice(e,1)}},{key:"notify",value:function(e){for(var t=0,n=this.listeners.length;t<n;++t)this.listeners[t].update(e)}},{key:"update",value:function(e){this.saveMessage(e)&&this.notify(e)}},{key:"getMessages",value:function(){return this.messages}},{key:"addAllMessages",value:function(e){if(e)for(var t=e.getMessages(),n=0,r=t.length;n<r;++n)this.saveMessage(t[n])}}]),u);function u(e,t,n){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");this.index={},this.messages=[],this.uncommitted={},this.modifiers=[],this.updated=Date.now(),this.id=i(),this.listeners=[],this.comparator=t||o.compareByCreated,this.filter=n||function(){return!0},e&&this.saveMessages(e)}t.exports=e},{"./chat-message":736,"./join-message":739,"./leave-message":740,"./message":742,"./system-message":744,"uuid/v4":69}],742:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("uuid/v4");function a(e,t){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.type=e,this.metadata={},this.payload={},t&&this._load(t),this.messageId||(this.messageId=o()),this.metadata.created||(this.metadata.created=Date.now()),t&&this.load(t)}r(a,[{key:"load",value:function(e){return this._load(e)}},{key:"_load",value:function(e){if(e===this)return this;if(this.messageId&&e.messageId&&this.messageId!==e.messageId)throw new Error("reassigned id");if(this.type&&e.type&&this.type!==e.type)throw new Error("reassigned type");e.messageId&&(this.messageId=e.messageId),e.metadata&&(e.metadata.created&&(this.metadata.created=e.metadata.created),e.metadata.updated&&e.metadata.updated>this.metadata.updated&&(this.metadata.updated=e.metadata.updated),e.metadata.reference&&(this.metadata.reference=e.metadata.reference),e.metadata.referenced&&(this.metadata.referenced=e.metadata.referenced),e.metadata.gateway&&(this.metadata.gateway=e.metadata.gateway)),e.payload&&(e.payload.user&&(this.payload.user=e.payload.user),e.payload.author&&(this.payload.author=e.payload.author),e.payload.avatar&&(this.payload.avatar=e.payload.avatar),e.payload.channel&&(this.payload.channel=e.payload.channel),e.payload.content&&(this.payload.content=e.payload.content))}}],[{key:"compareByCreated",value:function(e,t){e=e.metadata.created,t=t.metadata.created;return t<e?-1:e<t?1:0}},{key:"compareByUpdated",value:function(e,t){e=e.metadata.updated||e.metadata.created,t=t.metadata.updated||t.metadata.created;return t<e?-1:e<t?1:0}},{key:"compareByModified",value:function(e,t){e=e.metadata.modified||e.metadata.updated||e.metadata.created,t=t.metadata.modified||t.metadata.updated||t.metadata.created;return t<e?-1:e<t?1:0}}]),t.exports=a},{"uuid/v4":69}],743:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"state",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742}],744:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var t=this,e=(n.__proto__||Object.getPrototypeOf(n)).call(this,"system",e);if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||(o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),e.payload&&(e.payload.text&&(this.payload.text=e.payload.text),e.payload.code&&(this.payload.code=e.payload.code),e.payload.content&&"system"!==e.payload.content&&(this.payload.content=e.payload.content))),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742}],745:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0!==r){if("value"in r)return r.value;r=r.get;return void 0!==r?r.call(n):void 0}if(null!==(r=Object.getPrototypeOf(e)))return o(r,t,n)}var a=e("./message"),e=function(){var e=n,t=a;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,"vote",e));return Number.isInteger(e.payload.vote)||(e.payload.vote=0),e}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),r(n,[{key:"load",value:function(e){return e===this||(o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"load",this).call(this,e),e.payload&&Number.isInteger(e.payload.vote)&&(this.payload.vote=e.payload.vote)),this}},{key:"copy",value:function(){return new n(this)}}]),n}();t.exports=e},{"./message":742}],746:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("configService",e("./services/config-service")),r.service("messageService",e("./services/message-service")),r.service("authService",e("./services/auth-service")),r.service("threadModalService",e("./services/thread-modal-service")),r.service("leonModalService",e("./services/leon-modal-service")),r.service("kickNoticeModalService",e("./services/kick-notice-modal-service")),r.service("confirmKickModalService",e("./services/confirm-kick-modal-service")),r.directive("leon",e("./directives/leon")),r.directive("deckard",e("./directives/deckard")),r.directive("leonButton",e("./directives/leon-button")),r.directive("leonAuth",e("./directives/auth-directive")),r.directive("conversation",e("./directives/conversation-directive")),r.directive("channelMessages",e("./directives/channel-messages-directive")),r.directive("chatInput",e("./directives/chat-input-directive")),r.directive("message",e("./directives/message-directive")),r.directive("messageList",e("./directives/message-list-directive")),r.directive("moderation",e("./directives/moderation-directive")),r.directive("autoScroll",e("./directives/scroller-directive")),r.directive("leonFilter",e("./directives/filter-directive"))},{"../../common/app":70,"./directives/auth-directive":722,"./directives/channel-messages-directive":723,"./directives/chat-input-directive":724,"./directives/conversation-directive":725,"./directives/deckard":726,"./directives/filter-directive":727,"./directives/leon":729,"./directives/leon-button":728,"./directives/message-directive":730,"./directives/message-list-directive":731,"./directives/moderation-directive":732,"./directives/scroller-directive":733,"./services/auth-service":747,"./services/config-service":748,"./services/confirm-kick-modal-service":749,"./services/kick-notice-modal-service":750,"./services/leon-modal-service":751,"./services/message-service":752,"./services/thread-modal-service":753}],747:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n,r){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$http=e,this.$window=n,this.$cookies=t,this.config=r,this.channels={}}o.$inject=["$http","$cookies","$window","config"],r(o,[{key:"authorize",value:function(e,t,i){this.$http.post(this.config.leon["api-prefix"]+"/auth/leon/token",t,{headers:{Authorization:!0}}).success(function(e,t,n,r){return 403===t?i(new Error(e&&e.message)):500<=t?i(new Error("unable to access channel")):void i(null,e&&e.data)}).error(function(e,t,n,r){e=e&&e.message||(-1===t||500===t||503===t?"temporarily unable to authorize access to this channel":"unauthorized to join this channel");i(new Error(e))})}}]),t.exports=o},{}],748:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o={chat:{styles:"talk outline icon",title1:"Student chat",prompt1:"<em>Use the <strong>?</strong> to ask questions.</em>",title2:"Comment",prompt2:"Comment on this part..."},like:{styles:"thumbs outline up icon",title1:"Loving it!",prompt1:"Share some love...",tag1:"like",title2:"Love this part!",prompt2:"Share some love about this part...",tag2:"like"},question:{styles:"help circle outline icon",title1:"Question for instructor",prompt1:"Ask instructor a question...",tag1:"question",title2:"Question for instructor about this part",prompt2:"Ask instructor a question about this part...",tag2:"question"},note:{styles:"sticky note outline icon",title1:"Share a note",tag1:"note",prompt1:"Share a note about the content...",title2:"Attach a note",prompt2:"Attach a note about this part...",tag2:"note"},tech:{styles:"wrench icon",title1:"Tech issue",tag1:"tech",prompt1:"Hey CreativeLive, something seems broken...",title2:"Tech issue about this part of the content",prompt2:"Hey CreativeLive, this part of the content seems broken...",tag2:"tech"},error:{styles:"error icon"},command:{styles:"settings icon"}};function a(e,t){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.$http=e,this.config=t.leon}a.$inject=["$http","config"],r(a,[{key:"getStyles",value:function(e){return o[e].styles}},{key:"getPrompt",value:function(e,t){return t?o[e].prompt2:o[e].prompt1}},{key:"getTag",value:function(e,t){return t?o[e].tag2:o[e].tag1}},{key:"getTitle",value:function(e,t){return t?o[e].title2:o[e].title1}},{key:"start",value:function(){var i=this;this.$http.get("config").success(function(e,t,n,r){try{i.config=e}catch(e){}}).error(function(e,t,n,r){i.$timeout(function(){i.start()},2e3+3e3*Math.random())})}}]),t.exports=a},{}],749:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$uibModal=e,this.$rootScope=t}o.$inject=["$uibModal","$rootScope"],r(o,[{key:"open",value:function(r){var t={templateUrl:"/templates/leon/confirm-kick-modal.html",windowClass:"cl-modal confirm-kick-modal",backdropClass:"bg-black",scope:r.scope,controller:["$scope","$uibModalInstance","$filter",function(e,t,n){e.message=r.message,e.titleString=n("i18n")("cl-chat-confirm-kick-title","Are you sure? You're about to kick:"),e.kickUserString=n("i18n")("cl-chat-confirm-kick-kick-user","kick user"),e.spareUserString=n("i18n")("cl-chat-confirm-kick-spare-user","spare them"),e.kickUser=function(){e.$parent.$broadcast("user-kicked",{user:e.message.payload.user,author:e.message.payload.author}),e.closeModal()},e.spareUser=function(){e.closeModal()},e.closeModal=function(){t.dismiss()}}]};function e(){this.modal=void 0}_.each(["backdrop","keyboard"],function(e){e in r&&(t[e]=r[e])}),this.modal=this.$uibModal.open(t),this.modal.result.then(e.bind(this),e.bind(this))}}]),t.exports=o},{}],750:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$uibModal=e,this.$rootScope=t}o.$inject=["$uibModal","$rootScope"],r(o,[{key:"open",value:function(t){var n={templateUrl:"/templates/leon/kick-notice-modal.html",windowClass:"cl-modal kick-notice-modal",backdropClass:"bg-black",scope:t.scope,controller:["$scope","$uibModalInstance","$filter",function(e,t,n){e.kickedNoticeTitle=n("i18n")("cl-chat-kicked-notice-title",'<span class="h3">Youve been removed from the chat.</span>'),e.kickedNoticeContent=n("i18n")("cl-chat-kicked-notice-content",'You have been banned from the chat for 24 hours, of this class, because we felt that you have violated our <a href="/terms">Terms of Service</a>. If you feel that we have made a mistake please contact: <a ng-href="mailto:support@creativelive.com?subject=Chat%20Issues">support@creativelive.com</a>'),e.closeNotice=function(){t.dismiss()}}]};function e(){this.modal=void 0,this.$rootScope.$broadcast("close-leon-modal")}_.each(["backdrop","keyboard"],function(e){e in t&&(n[e]=t[e])}),this.modal=this.$uibModal.open(n),this.modal.result.then(e.bind(this),e.bind(this))}}]),t.exports=o},{}],751:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}o.$inject=["$uibModal","$rootScope","$timeout","LockBody"],r(o,[{key:"open",value:function(t){function e(){a.LockBody.unlock("nexusModal"),t.player.classList.remove("leon-open"),t.scope.$emit("videoplayer-toggleChatModal",!0),r=void 0}var a=this,n=(this.LockBody.lock("nexusModal",!0),{templateUrl:"/templates/leon/leon-modal.html",windowClass:"cl-modal leon-modal",backdropClass:"bg-black",scope:t.scope,controller:["$scope","$uibModalInstance","$interval","$filter",function(n,e,r,i){var o;n.videoIsBroadcasting=!0,n.lostConnection=!1,n.reconnectCountdown=5,n.chatNotActiveString=i("i18n")("cl-chat-not-active",'<p class="gray 3 margin-bottom-m" style="font-size:18px;">Bummer... This channel is not ON AIR, so <strong>this chat is not active</strong>.</p><p class="gray3">Check out the other channel if youre feeling chatty.</p>'),n.$on("display-num-of-leon-broadcast-qs",function(e,t){e.preventDefault(),e.stopPropagation(),n.numOfQuestions=t}),n.$on("video-chat:is-currently-broadcasting",function(e,t){e.preventDefault(),n.videoIsBroadcasting=t}),n.$on("close-leon-modal",function(e){e.preventDefault(),n.close()}),a.$rootScope.$on("lost-connection",function(e,t){n.lostConnection=t,n.lostConnection?o=r(function(){n.tryToReconnectString=i("i18n")("cl-chat-trying-to-reconnect","Trying to reconnect in {{ reconnectCountdown }}s...",{reconnectCountdown:n.reconnectCountdown}),n.reconnectCountdown?n.reconnectCountdown--:n.reconnectCountdown=5},1e3):r.cancel(o)}),t.player.classList.add("leon-open"),n.$emit("videoplayer-toggleChatModal",!1),n.close=function(){e.close()}}]}),r=(_.each(["backdrop","keyboard"],function(e){e in t&&(n[e]=t[e])}),this.$uibModal.open(n));r.result.then(e,e)}}]);r=o;function o(e,t,n,r){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$uibModal=e,this.$rootScope=t,this.LockBody=r}t.exports=r},{}],752:[function(e,t,i){"use strict";var o=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=e("uuid/v4"),a=e("../utils/channel-manager"),s=e("../models/channel"),y=e("../models/join-message"),b=e("../models/leave-message"),_=e("../models/chat-message"),E=e("../models/activity-message"),n=e("../models/hello-message"),w=e("../models/vote-message"),A=e("../models/state-message"),S=e("../models/flag-message"),k=e("../models/system-message"),e=(d.$inject=["$websocket","$location","$rootScope","$http","$timeout","$interval","$httpParamSerializer","$q","configService","authService","trackFactory"],o(d,[{key:"isReady",value:function(){return!!this.configService.config}},{key:"open",value:function(){var t=this;this.ws||(this.ws=this.$websocket(this.configService.config["socket-url"],{reconnectIfNotNormalClose:!0,maxTimeout:3e4}),this.ws.onOpen(function(e){return t.onOpen(e)}),this.ws.onClose(function(e){return t.onClose(e)}),this.ws.onError(function(e){return t.onError(e)}),this.ws.onMessage(function(e){return t.onMessage(e)}))}},{key:"send",value:function(e){this.trackFactory.trackChat("Chat Message",Object.assign(e,{admin:this.admin})),this.ws.send(e)}},{key:"activateChannel",value:function(e){var t=this.channels[e];return t||(this.inactiveChannels[e]?(t=this.channels[e]=this.inactiveChannels[e],delete this.inactiveChannels[e]):t=this.channels[e]=new s(e)),t}},{key:"deactivateChannel",value:function(e){var t=this.channels[e];t&&("joined"===t.joinState&&this.leave(t),t.authState="unauthorized",this.inactiveChannels[e]=t,delete this.channels[e])}},{key:"startChannelManager",value:function(e,t,n,r){var i=new a(this,e,t,n);return i.channel.managers.push(i),i.channel.streamMessages.subscribe(i.inputMessageCollection),i.updateInterval=this.$interval(function(){"authorized"===i.channel.authState&&i.update().then(function(){r&&i.moderationArchiveRequest()})},500),i}},{key:"stopChannelManager",value:function(t){var e;return t.updateInterval&&(this.$interval.cancel(t.updateInterval),-1!==(e=t.channel.managers.findIndex(function(e){return t===e}))&&t.channel.managers.splice(e,1),delete t.updateInterval,0===t.channel.managers.length&&this.deactivateChannel(t.channel.name)),t.channel.streamMessages.unsubscribe(t.inputMessageCollection),t}},{key:"authorizeChannel",value:function(e,t,n){var r=this,i=2147483648,o=this.activateChannel(e);o.error=null,o.authState="authorizing",this.authService.authorize(e,t,function(e,t){if(e)return o.authState="unauthorized",o.error=e,void n(e);o.authState="authorized",o.token=t.token,o.avatar=t.avatar||!1,o.email=t.email,o.user=t.user,o.author=t.author,o.read=!!(t.flags&(1|i)),o.write=!!(t.flags&(2|i)),o.vote=!!(t.flags&(4|i)),o.admin=!!(t.flags&(8|i)),r.admin=o.admin,n(null,o)})}},{key:"requestJoin",value:function(e){var t,n=this.channels[e];n&&"joined"!==n.joinState&&(n.joinState="joining",this.isOpen?n&&((t=new y).payload.channel=e,t.payload.user=n.user,t.payload.author=n.author,t.payload.avatar=n.avatar,t.payload.token=n.token,this.ws.send(t)):this.open())}},{key:"join",value:function(e){var t=this.activateChannel(e),n=this.$q.defer();return"authorized"!==t.authState?n.reject(new Error("unauthorized")):"joined"===t.joinState?n.resolve():(this.requestJoin(e),t.joinRequests.push(n),this.$timeout(function(){n.reject(new Error("timeout waiting for Join acknowledgment"))},1e4)),n.promise}},{key:"getChannelMediaOffset",value:function(e){e=this.activateChannel(e);return e.currentMedia?{id:e.currentMedia,offset:e.currentOffset}:null}},{key:"setChannelMediaOffset",value:function(e,t,n){var r,i=this.activateChannel(e);for(r in i.currentMedia=t,i.currentOffset=n,i.managers)i.managers[r].setChannelMediaOffset(t,n)}},{key:"getChannel",value:function(e){return this.channels[e]}},{key:"isLoading",value:function(e){e=this.channels[e];return e&&e.isLoading}},{key:"isJoining",value:function(e){e=this.channels[e];return e&&"joining"===e.joinState}},{key:"isAuthorizing",value:function(e){e=this.channels[e];return e&&"authorizing"===e.authState}},{key:"hasActivity",value:function(e){e=this.channels[e];return e&&Date.now()-e.lastActive<1e4}},{key:"leave",value:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1]?this.trackFactory.trackChat("User Kicked From Chat",{channel:e.channel}):this.trackFactory.trackChat("Leave Chat",e);var t=new b({payload:{channel:e.name,user:e.user,author:e.author,avatar:e.avatar}});this.send(t),e.joinState="idle"}},{key:"onMessage",value:function(l){try{var e=JSON.parse(l.data);if("chat"===e.type&&e.payload.channel){var t=new _(e),n=this.channels[t.payload.channel];n&&(t.metadata.created>n.lastActive&&(n.lastActive=0),n.streamMessages.saveMessage(t))}else if("activity"===e.type){var r=new E(e),i=this.channels[r.payload.channel];i&&r.metadata.created>i.lastActive&&(i.lastActive=r.metadata.created)}else if("join"===e.type){var d=new y(e);this.$rootScope.$emit("join-message",e),this.onJoinMessage(d)}else if("vote"===e.type&&e.payload.channel){var o=new w(e),a=this.channels[o.payload.channel];a&&a.streamMessages.saveMessage(o)}else if("state"===e.type&&e.payload.channel){var f=new A(e),p=this.channels[f.payload.channel];p&&p.streamMessages.saveMessage(f)}else if("flag"===e.type&&e.payload.channel&&e.payload.content){var h=new S(e),m=this.channels[h.payload.channel];m&&m.streamMessages.saveMessage(h)}else if("leave"===e.type&&e.payload.channel){var s=new b(e),c=this.channels[s.payload.channel];if(!c)return;"kick"===s.payload.content&&(this.$rootScope.user.isMyself&&this.$rootScope.user.isMyself(s.payload.user)?this.$rootScope.$emit("display-kick-notice-to-user-modal",e):this.$rootScope.$emit("kick-message",e)),s.payload.user===c.user?c.joinState="idle":s.metadata.created>c.lastActive&&(c.lastActive=0)}else if("system"===e.type){var u=new k(e);if(u.payload.channel){var g=this.channels[u.payload.channel];g&&g.streamMessages.saveMessage(u)}else for(var v in this.channels)this.channels.hasOwnProperty(v)&&this.channels[v].streamMessages.saveMessage(u)}}catch(e){}}},{key:"onJoinMessage",value:function(t){var n,e,r=this.channels[t.payload.channel];r&&(t.payload.user===r.user?(t.isSuccess()?(r.joinState="joined",r.joinRequests.forEach(function(e){e.resolve(t)}),this.trackFactory.trackChat("Join Chat",r)):(r.joinState="failed",n=new Error("unable to join: "+t.getErrorMessage()),r.error=t.getErrorMessage(),"TOKEN_VERIFY_ERROR"!==(e=t.getError())&&"JOIN_PAYLOAD_MISMATCH"!==e&&"KICKED_FROM_CHANNEL"!==e||(r.authState="unauthorized"),r.joinRequests.forEach(function(e){e.reject(n)})),r.joinRequests=[]):t.metadata.created>r.lastActive&&(r.lastActive=0))}},{key:"onOpen",value:function(){this.isOpen=!0;var e,t=new n;for(e in t.payload.clientId=this.clientId,this.ws.send(t),this.channels)this.channels.hasOwnProperty(e)&&"joining"===this.channels[e].joinState&&(this.requestJoin(e),this.$rootScope.$broadcast("lost-connection",!1))}},{key:"onClose",value:function(){for(var e in this.isOpen=!1,this.channels)!this.channels.hasOwnProperty(e)||"joined"===(e=this.channels[e]).joinState&&(this.$rootScope.$broadcast("lost-connection",!0),e.joinState="joining")}},{key:"onError",value:function(){}},{key:"getArchiveMessages",value:function(i,e,o){var t=this.configService.config["server-prefix"]+"/messages/"+i.name,e=this.$httpParamSerializer(e=e||{});0<e.length&&(t+="?"+e),i.isLoading=!0,this.$http.get(t,{headers:{"x-token":i.token}}).success(function(e,t,n,r){if(401===t)return i.authState="unauthorized",o(new Error("unauthorized"));if(500<=t&&t<600)return i.error="unable to get archive messages",o(new Error(i.error));i.isLoading=!1;t=e.result.map(d.createMessage);o(null,t)}).error(function(e,t,n,r){i.isLoading=!1;e=e&&e.result||(-1===t||500===t||503===t?"temporarily unable to get archive messages":"unable to get archive messages");i.error=e,o(new Error(e))})}}],[{key:"createMessage",value:function(e){return"chat"===e.type?new _(e):"vote"===e.type?new w(e):"flag"===e.type?new S(e):"hello"===e.type?new n(e):"join"===e.type?new y(e):"leave"===e.type?new b(e):null}}]),d);function d(e,t,n,r,i,o,a,s,c,u,l){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.configService=c,this.authService=u,this.$websocket=e,this.$location=t,this.$rootScope=n,this.$q=s,this.$timeout=i,this.$interval=o,this.$httpParamSerializer=a,this.$http=r,this.trackFactory=l,this.channels={},this.inactiveChannels={},this.clientId=f(),this.isOpen=!1,this.admin=!1}t.exports=e},{"../models/activity-message":734,"../models/channel":735,"../models/chat-message":736,"../models/flag-message":737,"../models/hello-message":738,"../models/join-message":739,"../models/leave-message":740,"../models/state-message":743,"../models/system-message":744,"../models/vote-message":745,"../utils/channel-manager":754,"uuid/v4":69}],753:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.$uibModal=e,this.$rootScope=t}o.$inject=["$uibModal","$rootScope"],r(o,[{key:"open",value:function(n){var t={templateUrl:"/templates/leon/thread-modal.html",windowClass:"cl-modal thread-modal",backdropClass:"bg-black",scope:n.scope,controller:["$scope","$uibModalInstance",function(e,t){e.thread=n.thread,e.getThread=function(){return e.thread},e.hasThread=function(){return!!e.thread},e.clearThread=function(){e.thread=null,r()},e.closeThread=function(){t.dismiss()}}]};function r(){this.modal=void 0,n.scope.$broadcast("thread-modal-close")}_.each(["backdrop","keyboard"],function(e){e in n&&(t[e]=n[e])}),this.modal=this.$uibModal.open(t),this.modal.result.then(r.bind(this),r.bind(this))}}]),t.exports=o},{}],754:[function(e,t,n){"use strict";var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("uuid/v4"),a=e("../models/message-collection"),s=e("../models/message"),e=(r(c,[{key:"getChannel",value:function(){return this.channel}},{key:"getMediaOffset",value:function(){return this.currentMedia?{id:this.currentMedia,offset:this.currentOffset}:null}},{key:"saveAuthorization",value:function(e){this.messageService.saveAuthorization(e)}},{key:"stop",value:function(){return this.messageService.stopChannelManager(this)}},{key:"update",value:function(){var r=this;return this.messageService.$q(function(e,t){if(!r.updating){r.updating=!0;var n=function(){r.updating=!1,e()};switch(r.mode){case"live":r.updateLiveMode(n);break;case"stream":r.updateStreamMode(n);break;case"best":r.updateBestMode(n);break;case"thread":r.updateThreadMode(n);break;default:throw r.updating=!1,new Error("bad mode "+r.mode)}}})}},{key:"getChannelMode",value:function(){return this.mode}},{key:"setChannelMode",value:function(e,t){var n=this;if(this.mode!==e){switch(this.thread="thread"===e&&t?t:null,this.outputMessageCollection&&this.inputMessageCollection.unsubscribe(this.outputMessageCollection),this.outputMessageCollection=new a,e){case"live":this.outputMessageCollection.filter=null,this.outputMessageCollection.comparator=s.compareByCreated;break;case"stream":this.outputMessageCollection.filter=null,this.outputMessageCollection.comparator=ChatMessage.compareByMediaOffset.bind(this.currentMedia);break;case"best":this.outputMessageCollection.filter=null,this.outputMessageCollection.comparator=s.compareByCreated;break;case"thread":this.outputMessageCollection.filter=function(e){return e.messageId===n.thread||e.metadata.reference===n.thread},this.outputMessageCollection.comparator=s.compareByCreated}this.inputMessageCollection.subscribe(this.outputMessageCollection),this.dirty=!0,this.dirtyMod=!0,this.oldestMessage={},this.channel.error=null,this.mode=e}}},{key:"streamModeArchiveRequest",value:function(){var a=this;return this.messageService.$q(function(n,r){var i,o;a.dirty?(i=a.currentMedia,o=a.currentOffset,a.messageService.getArchiveMessages(a.channel,{limit:1e3,media:a.currentMedia,offset:a.currentOffset},function(e,t){e?r(e):(a.inputMessageCollection.saveMessages(t),(e=a.currentOffset-o)<0&&(e=-e),a.dirty=a.currentMedia!==i||6e4<e,n())})):n()})}},{key:"liveModeArchiveRequest",value:function(){var i=this;return this.messageService.$q(function(n,r){i.dirty?i.messageService.getArchiveMessages(i.channel,{limit:100},function(e,t){i.dirty=!1,e?r(e):(i.hasOlderMessages=100<=t.length,i.updateOldestMessage(t),i.inputMessageCollection.saveMessages(t),n())}):n()})}},{key:"moderationArchiveRequest",value:function(){var i=this;return this.messageService.$q(function(n,r){i.dirtyMod?i.messageService.getArchiveMessages(i.channel,{state:"on-deck"},function(e,t){i.dirtyMod=!1,e?r(e):(i.inputMessageCollection.saveMessages(t),n())}):n()})}},{key:"bestModeArchiveRequest",value:function(){var i=this;return this.messageService.$q(function(n,r){i.dirty?i.messageService.getArchiveMessages(i.channel,{limit:100,score:1,content:["question","like","note"]},function(e,t){i.dirty=!1,e?r(e):(i.inputMessageCollection.saveMessages(t),n())}):n()})}},{key:"threadModeArchiveRequest",value:function(){var i=this;return this.messageService.$q(function(n,r){i.dirty?i.messageService.getArchiveMessages(i.channel,{limit:100,reference:i.thread},function(e,t){i.dirty=!1,e?r(e):(i.inputMessageCollection.saveMessages(t),n())}):n()})}},{key:"setChannelMediaOffset",value:function(e,t){this.dirty=this.dirty||e!==this.currentMedia||t>this.currentOffset+6e4||t<this.currentOffset-6e4,this.currentMedia=e,this.currentOffset=t}},{key:"resolved",value:function(){return this.messageService.$q.when()}},{key:"updateLiveMode",value:function(t){var e=[this.liveModeArchiveRequest(),this.messageService.join(this.channel.name)];this.messageService.$q.all(e).then(function(){t()},function(e){t(e)})}},{key:"updateStreamMode",value:function(t){var e=[this.streamModeArchiveRequest(),this.messageService.join(this.channel.name)];this.messageService.$q.all(e).then(function(){t()},function(e){t(e)})}},{key:"updateBestMode",value:function(t){this.bestModeArchiveRequest().then(function(){return t()},function(e){t(e)})}},{key:"updateThreadMode",value:function(t){var e=[this.threadModeArchiveRequest(),this.messageService.join(this.channel.name)];this.messageService.$q.all(e).then(function(){t()},function(e){t(e)})}},{key:"getMessageCollection",value:function(){return this.outputMessageCollection}},{key:"getMessages",value:function(){var e,t=this,n=this.inputMessageCollection.getMessages();return"stream"===this.mode?(this.messages=n.filter(function(e){return e instanceof ChatMessage&&-1!==e.getMediaOffset(t.currentMedia)}).sort(ChatMessage.compareByMediaOffset.bind(this.currentMedia)),-1===(e=this.messages.findIndex(function(){}))?this.messages:this.messages.slice(0,e)):(this.messages=n.slice(0).sort(s.compareByCreated),this.messages)}},{key:"getThreadMessageId",value:function(){return this.thread}},{key:"getThreadMessage",value:function(){return"thread"===this.mode&&this.thread?this.inputMessageCollection.findMessage(this.thread):null}},{key:"updateOldestMessage",value:function(e){var t=0;if(0<e.length)for(var t=e[0].metadata.created,n=1,r=e.length;n<r;++n)e[n].metadata.created<t&&(t=e[n].metadata.created,this.oldestMessage=e[n])}},{key:"loadOlderMessages",value:function(n){var e,r=this,t=0,t=(this.oldestMessage&&this.oldestMessage.metadata||(e=this.inputMessageCollection.getMessages(),this.updateOldestMessage(e)),this.oldestMessage.metadata.created);this.messageService.getArchiveMessages(this.channel,{createdBefore:t,limit:150},function(e,t){e&&(r.channel.error=e.message),r.hasOlderMessages=100<=t.length,r.updateOldestMessage(t),r.inputMessageCollection.saveMessages(t),n&&n()})}}]),c);function c(e,t,n,r){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.id=o(),this.messageService=e,this.channelName=t,this.channel=e.activateChannel(t),this.currentMedia=null,this.currentOffset=-1,this.inputMessageCollection=new a,this.channel.streamMessages.subscribe(this.inputMessageCollection),this.outputMessageCollection=null,this.setChannelMode(n,r)}t.exports=e},{"../models/message":742,"../models/message-collection":741,"uuid/v4":69}],755:[function(e,t,n){"use strict";function r(e){return e.metadata&&"on-deck"===e.metadata.state}function i(e){return e.metadata&&"asked"===e.metadata.state}t.exports={isOnDeck:function(e){return r(e)||i(e)},isAsked:i,isNotAsked:r,isHidden:function(e){return e.metadata&&"hidden"===e.metadata.state},isFlagged:function(e){return"chat"===e.type&&0<e.getFlagCount()},isNotHidden:function(e){return e.metadata&&"hidden"!==e.metadata.state},isCandidate:function(e){return e.metadata&&"candidate"===e.metadata.state},isQuestion:function(e){var t=e.metadata&&"on-deck"===e.metadata.state,n=e.payload&&"question"===e.payload.content,e=e.metadata&&"asked"===e.metadata.state;return t||n||e},best:function(e){return 0<e.metadata.score&&("note"===e.payload.content||"question"===e.payload.content||"like"===e.payload.content)}}},{}],756:[function(e,t,n){"use strict";function r(m,g,v,y,e,b,_,w,A,S,k,E){return{restrict:"A",link:function(o,t,a){var s,c,u=a.clLessonListProviderKey||"clLessonList",i=a.$observe("clCourseId",function(){a.clCourseId&&(y.findById(a.clCourseId).then(function(e){return y.getPromoVideo(e)}).then(function(e){o[u]=o[u]||{},angular.extend(o[u],{hasPromo:!(w.isObject(e)&&w.isEmpty(e))})}).catch(function(e){}),y.getLessonList(a.clCourseId).then(function(e){var t,n;o[u]=o[u]||{},a.clSegmentId&&(n=w.find(e.lessons,{_id:a.clSegmentId}),t=w.pick(e.courseData,"_id","short_title","instructors","taxonomy","primary_category"),angular.extend(o[u],{lesson:n,courseData:t})),a.clCourseId&&(n=e.lessons,o[u].lessonList&&o[u].lessonList.length&&o[u].lessonList.length!==e.lessons.length&&(n=l(o[u].lessonList,c.playlist.videoItems)),angular.extend(o[u],{lessonList:n})),(s=s||new b).initWithCourseId(a.clCourseId).then(function(){r().then(function(){a.clPlayerId||d(),i()}).catch(function(e){})})}).catch(function(e){}))}),f=a.$observe("clPlayerId",function(){a.clPlayerId&&e.getVideoPlayer(a.clPlayerId).then(function(e){"ready"===(c=e).getState()?n():c.on("ready",n),c.on("started",function(e,t){if(t){if(t.slug)return o.showTranscript[t._id]=!0,o[u].setBrowserLocation(t),void h();"promo"===t.type&&((t=o.baseUrl).includes("/lessons/")&&(t=t.slice(0,t.indexOf("/lessons/"))),m.path(t))}}),c.on("paused",function(e){c.currentVideoItem&&(c.currentVideoItem.token||(c.trigger(c.events.READY,c.currentVideoItem.token),o.showTranscript[c.currentVideoItem._id]=!0))})})});function n(){s=c.playlist;var n=0,r=v.cardedSegment,i=!1,e=(angular.forEach(s.videoItems,function(e){var t=_(e||{},"source.media.0.duration")||0;n+=t,!0===e.source.is_preview&&(i=!0)}),o[u]=o[u]||{},c.playlist.videoItems);o[u].lessonList&&o[u].lessonList.length&&o[u].lessonList.length!==c.playlist.videoItems.length&&(e=l(o[u].lessonList,c.playlist.videoItems)),angular.extend(o[u],{watchNowFilter:function(e){var t=!0===e.source.is_preview,e=r&&e._id===r;return t||e},lastLessonsFilter:function(e,t){var n=c.playlist.videoItems.length;return 7===n?t===n-1||t===n-2:t===n-1},totalSeconds:n,videoPlayer:c,downloadLesson:p,freeLessonsExist:i,lessonList:e}),o[u].setBrowserLocation=function(e){e&&e.slug&&((e=(a.clBaseUrl||"")+e.slug)!==m.path()&&m.path(e))},o[u].freeLessonLabelLoggedOut=g("i18n")("cl-free-lesson-label-logged-out",'<span class="brand-highlight clickable">Log in or Sign up</span> for FREE and get full access to these and thousands of other Open Lessons in our catalog!'),o[u].freeLessonLabelLoggedIn=g("i18n")("cl-free-lesson-label-logged-in","The following lessons are open for all CreativeLive Students. Enjoy!"),d(),f()}function l(e,n){var r=0;return w.reduce(e,function(e,t){return"session"===t.type?e.push(t):e.push(n[r++]),e},[])}function d(){a.clDebug,o.clLessonListReady=!0,k(h,1e3)}function r(e,t){if(!s)return E.reject("no playlist");var n=a.clCourseId||o[u].videoPlayer&&o[u].videoPlayer.course&&o[u].videoPlayer.course._id;return n?s.setVideoItemPermissionsByCourseId(n,t):E.reject("no courseId")}function p(e,t,n){e.preventDefault(),e.stopPropagation(),t&&t.token&&t.getURL(n,!0).then(function(e){S.location.href=e;e=t.getMediaByType(n);A.downloadItem(t.source,e,t.source.course)}).catch(function(e){})}function h(){var e=t.find(".playing");t.length&&e.length&&t.scrollToElement(e,0,300)}a.$observe("clCurrentLessonSlug",function(){o.currentLessonSlug=a.clCurrentLessonSlug}),a.clLessonListProviderEnableDownloads&&a.$observe("clLessonListProviderEnableDownloads",function(){o.enableDownloads="true"===a.clLessonListProviderEnableDownloads}),a.clLessonListProviderShowDownloads&&a.$observe("clLessonListProviderShowDownloads",function(){o.showDownloads="true"===a.clLessonListProviderShowDownloads}),o.$on("user:login",r),o.$on("user:register",r),o.$on("user:logout",r),o.$on("user:follow",r),o.$on("order:free:complete",r),angular.extend(o,{showTranscripts:"true"===a.showTranscripts,showTranscript:{},baseUrl:a.clBaseUrl,courseId:a.clCourseId,playerId:a.clPlayerId,hostUrl:S.location.origin})}}}r.$inject=["$location","$filter","$rootScope","CourseService","videoPlayerCollection","VideoPlaylistService","deepval","_","trackFactory","$window","$timeout","$q"],t.exports=r},{}],757:[function(e,t,n){"use strict";e("../../common/app").directive("clLessonListProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":756}],758:[function(e,t,n){"use strict";t.exports=["$q","deepval","_","CourseService","videoPlayerCollection",function(_,w,S,E,A){return{restrict:"A",link:function(r,d,i){var t,n,o,s,a,c="",u=[],l=!1,f={},p=S.throttle(function(e){var t=(""+e.target.currentTime).split(".")[0];"undefined"===t&&(t=(t=w(e||{},"target.firstChild.currentTime"))&&t.toString());e=f[t];e&&(o&&!function(e){b(e).removeClass("video-caption-active")}(o),function(e){e=b(e);e.addClass("video-caption-active"),h(e)}(o=e),o.active=!0)},500),h=S.throttle(function(e){{var t;"true"===i.clLessonTranscriptProviderAutoScroll&&(t=(a=a&&a[0]?a:angular.element(d[0].querySelector(".cl-lesson-transcript"))).height()/2,angular.forEach(e,function(e){e.offsetTop>t&&a.scrollTo(0,e.offsetTop-t,300)}))}},500),m=i.clLessonTranscriptProviderKey||"clLessonTranscript",g=(angular.extend(r,{gotoTime:function(e){s&&r.transcriptNavigationEnabled&&s.seek(e,n,!0)}}),i.$observe("clLessonId",function(){i.clLessonId&&(r.clLessonId=i.clLessonId,r.clCourseId=i.clCourseId,v(),E.getLessonList(i.clCourseId).then(function(e){t=e.lessons,n=S.findWhere(t,{_id:i.clLessonId}),w(n||{},"media.0.captions")?_.all([E.getLessonTranscript(i.clLessonId),E.getLessonCaptions(i.clLessonId)]).then(function(e){var o,t,a;e&&(c=e[0]&&e[0].data&&e[0].data.transcript,l=e[0]&&e[0].data&&e[0].data.autogenerated,u=e[1]&&e[1].data,o=c,e=l,t=u,r[m]={transcript:o,captions:t,autogenerated:e},i.clPlayerId&&A.getVideoPlayer(i.clPlayerId).then(function(e){s=e,S.each(s.events,function(e){s.on(e,y)})}),a=/[-\/\\^$*+?.()|[\]{}]/g,angular.forEach(t,function(e,t){e.startSeconds=(n=(n=e.start).split(".")[0].split(":"),r=parseInt(n[0],10),i=parseInt(n[1],10),n=parseInt(n[2],10),parseInt(r*k+60*i+n,10));var n,r=(f[e.startSeconds]=e).text.replace(a,"\\$&").trim(),i=o.match("([\n ]+)?"+r+"([\n ]+)?");i&&i[0]&&(e.transcriptLine=i[0].replace(/\n\n/gi,"<br>"))}),i.clDebug,r.clLessonTranscriptReady=!0,"true"===!i.clLessonTranscriptProviderWatch&&g())}).catch(function(e){}):v()}))}));function v(){r[m]={transcript:"",autogenerated:!1,captions:[]}}function y(e,t,n){t=t||{},n=n||{},"time_update"===e&&t._id===i.clLessonId&&n.target&&p(n),r.event=e,r.data=t}function b(e){return angular.element(document.querySelectorAll(".video-caption-"+r.clCourseId+"-"+r.clLessonId+"-"+e.startSeconds))}i.$observe("clLessonTranscriptNavigationEnabled",function(){r.transcriptNavigationEnabled=""!==i.clLessonTranscriptNavigationEnabled})}}}];var k=3600},{}],759:[function(e,t,n){"use strict";e("../../common/app").directive("clLessonTranscriptProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":758}],760:[function(e,t,n){"use strict";t.exports=["$rootScope","$window","_","moment","CartService","trackFactory","SubscriptionService",function(n,r,i,e,t,o,a){return{restrict:"AE",scope:{cart:"=",enableRemove:"=?",currency:"=",currencySymbol:"=",total:"=",type:"<?",subscriptionChangeFrequency:"=?",subscriptionExistingLabelFrequency:"=?",subscriptionNewExpiration:"=?",subscriptionTrialActive:"=?"},templateUrl:function(){return"/templates/line-item-tiles/view.html"},link:function(e){void 0===e.enableRemove&&(e.enableRemove=!0),angular.extend(e,{lineItems:null,numLineItems:0,reInit:!0,removeFromCart:function(n){t.remove(n._id).then(function(){o.removeFromCart(n,n.crossSellDiscount?"cross":n.type,"remove");var e=r.location.pathname.split("/"),t=e[2],e=e[1];t!==n._id&&t!==n.slug||(r.location.href=n.productLink),"creator-pass"!==n.slug||"creator-pass"!==e&&"class"!==e||r.location.reload()})},showSummary:function(e,t){n.$emit("summary:show",{product:e,dismiss:!0}),o.courseSummaryModal(e,t.target,"modal shown")}}),e.$watch("cart",function(t){t&&t.lineItems&&(i.each(t.lineItems,function(e){e.source&&e.source.billingFrequency&&!e.source.nonRenewable&&(e.will_renew=0!==t.total)}),e.lineItems=t.lineItems,e.numLineItems=e.lineItems.length)})}}}]},{}],761:[function(e,t,n){"use strict";e("../../common/app").directive("lineItemTiles",e("./directives/index"))},{"../../common/app":70,"./directives/index":760}],762:[function(e,t,n){"use strict";t.exports=["$timeout",function(i){return{restrict:"A",link:function(e,n){n.addClass("tabs-style-linemove");var r=angular.element('<li id="moving-line"></li>');function t(){var e,t=n[0].querySelector("li.active");t&&(e=t.querySelector("uib-tab-heading"),r.css({width:e.offsetWidth,left:t.offsetLeft,top:t.offsetTop}))}angular.element(n[0].querySelector("ul")).append(r),i(t),e.ctrl&&e.ctrl.tab?e.$watch("ctrl.tab",function(){i(t)}):n.bind("click",t)}}}]},{}],763:[function(e,t,n){"use strict";e("../../common/app").directive("linemove",e("./directives/index"))},{"../../common/app":70,"./directives/index":762}],764:[function(e,t,n){"use strict";t.exports=["categoryResource",function(e){return{restrict:"EA",templateUrl:"/templates/link-to-catalog/cms-edit.html",scope:{data:"=?",meta:"=?"},link:function(t){t.data=t.data||t.$parent.data||{},t.meta=t.meta||t.$parent.meta||{},t.$parent.page.primary_category&&e.getCategoryById({id:t.$parent.page.primary_category}).$promise.then(function(e){e=e&&e.data||{};t.data.path||(t.data.path=e.slug),t.data.topic||(t.data.topic=e.title)}),t.$watchGroup(["data.topic","data.path"],function(){t.meta.valid=t.linkToCatalogForm.$valid})}}}]},{}],765:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"EA",templateUrl:"/templates/link-to-catalog/cms-view.html",scope:{data:"=?"},link:function(e){e.data=e.data||e.$parent.data||{}}}}},{}],766:[function(e,t,n){"use strict";t.exports=["config",function(e){return{restrict:"E",templateUrl:"/templates/link-to-catalog/view.html",replace:!0,scope:{showAsButton:"=?",topic:"@",path:"@",url:"@"},link:function(e){e.link=e.url||"/catalog/",e.path&&(e.link+=e.path)}}}]},{}],767:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("linkToCatalog",e("./directives/index")),r.directive("linkToCatalogCms",e("./directives/cms/view")),r.directive("linkToCatalogCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":764,"./directives/cms/view":765,"./directives/index":766}],768:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/live-now/cms-view.html",scope:{data:"=?"},controllerAs:"liveNowCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],769:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService","$filter",function(e,i,o){return{restrict:"AE",scope:{event:"=?"},templateUrl:"/templates/live-now/index.html",controllerAs:"ctrl",controller:["$scope","$attrs",function(e,t){var n=this;function r(){e.event&&(n.event=e.event,i.getEventUIData(n.event).then(function(e){n.course=e,n.courseUrl=o("linkToSource")(n.course),n.courseUrl=o("addQueryParams")(n.courseUrl,{autoplay:!0})}))}"true"===t.watch?e.$watch("event",r):e.event&&r()}]}}]},{}],770:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clLiveNow",e("./directives/index")),r.directive("liveNowCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/view":768,"./directives/index":769}],771:[function(e,t,n){"use strict";t.exports=["CourseService","trackFactory","MediaService","$q","$window","deepval","_",function(u,l,d,f,p,h,m){return{restrict:"A",link:function(r,e,n){var i=n.clMaterialListProviderKey||"clMaterialListProvider",t={},o=(angular.extend(r,{fileIcon:function(e){return g[e.type]||"default"},download:function(e,t,n){e.preventDefault(),e.stopPropagation(),t.token&&(e=h(r[i],"courseData._id"),l.downloadItem(n,t,e),d.Resource.token({token:t.token}).$promise.then(function(e){p.location.href=e&&e.data&&e.data.playUrl}))}}),n.$observe("clCourseId",function(){var t;n.clCourseId&&(n.lazyLoadData?t=r.$watch("moduleInView",function(e){e&&(a(),t())}):a())}));function a(){u.getMaterialList(n.clCourseId).then(function(e){t=e,c().then(function(){s()}).catch(function(e){s()})}).catch(function(e){s()})}function s(){r[i]=t,r[i].hasMedia=m.any(t.materials,function(e){return h(e||{},"media.0.title")}),r[i].media=m.chain(t.materials).pluck("media").flatten().value(),n.clDebug,r.clMaterialListProviderReady=!0,o()}function c(){return t?t.courseData?d.getCourseTokensBySlug(t.courseData.slug).then(function(e){var n=m.chain(t.materials).pluck("media").flatten().value();m.each(e,function(e,t){t=m.findWhere(n,{_id:t});t&&(t.token=e)})}):f.reject("no courseData"):f.reject("no data")}r.$on("user:login",c),r.$on("user:register",c),r.$on("user:logout",c),r.$on("user:follow",c)}}}];var g={pdf:"pdf",zip:"zip",doc:"word",docx:"word",xls:"chart",numbers:"chart",ppt:"chart",txt:"word",mp3:"sound",gif:"image",jpg:"image",png:"image",svg:"image",html:"default",js:"default",css:"default",HD:"hd",Low:"video"}},{}],772:[function(e,t,n){"use strict";e("../../common/app").directive("clMaterialListProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":771}],773:[function(e,t,n){"use strict";var s=e("underscore");t.exports=["$uibModal",function(a){return{restrict:"AE",link:function(r,e,i){r.modal=void 0;var o,t="cl-modal:show:"+i.id;r.$on(t,function(e,t){var n="";t&&t.attrs&&s.each(t.attrs,function(e,t){n+=" "+t+'="'+e+'"'}),i.clModalTemplate?o='<div class="modal-body">'+angular.render(i.clModalTemplate)+"</div>":i.clModalContent&&(o='<div class="modal-body" '+n+" "+i.clModalContent+' on-complete="modal.dismiss()"></div>'),r.modal=a.open({template:o,windowClass:"cl-modal modal-"+i.id})})}}}]},{underscore:void 0}],774:[function(e,t,n){"use strict";e("../../common/app").directive("clModal",e("./directives/index"))},{"../../common/app":70,"./directives/index":773}],775:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/module-settings/edit.html",replace:!0,scope:{module:"=?"},link:function(e){e.module.data&&!e.module.data.configs&&(e.module.data.configs=[]),e.module.data&&!e.module.data.paramConditions&&(e.module.data.paramConditions=[])}}}]},{}],776:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/module-settings/view.html",replace:!0,scope:{module:"=?"},link:function(e){e.showSettings=e.module.data.conditions&&0<e.module.data.conditions.length||0<e.module.data.buckets.length}}}]},{}],777:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("moduleSettingsEdit",e("./directives/edit")),r.directive("moduleSettings",e("./directives/view"))},{"../../common/app":70,"./directives/edit":775,"./directives/view":776}],778:[function(e,t,n){"use strict";var o=e("underscore");t.exports=["$rootScope",function(i){return{restrict:"AE",scope:{},templateUrl:"/templates/my-classes/index.html",link:function(t,e,n){var r=function(){};i.user.valid()&&i.user.recentInteractions&&i.user.recentInteractions({limit:t.maxCourseCount}).then(function(e){t.courses=e.courses,o.each(t.courses,function(e){switch(e.type){case"keep-watching":t.ownedCourses.push(e);break;case"onair":case"upcoming":case"upcoming-event":case"live-now":t.upcomingCourses.push(e)}}),r()}),t.ownedCourses=[],t.upcomingCourses=[],t.maxCourseCount=parseInt(n.maxCourseCount||0,10)}}}]},{underscore:void 0}],779:[function(e,t,n){"use strict";e("../../common/app").directive("myClasses",e("./directives/index"))},{"../../common/app":70,"./directives/index":778}],780:[function(e,t,n){"use strict";var r=e("underscore");t.exports=[function(){return{restrict:"AE",scope:{courses:"=",type:"@",onSelect:"&",sortBy:"@",sortDir:"@"},templateUrl:"/templates/my-stuff/index.html",transclude:!0,controllerAs:"MyStuffCtrl",controller:["$element","$scope",function(e,n){var t;t=n.$watch("courses",function(e){e&&e.length&&(!function(t){n.courseList=r.filter(n.courses,function(e){return e[t]===n[t]})}("type"),n.sortBy&&function(e,t){n.courseList=r.sortBy(n.courseList,e),"desc"===t&&n.courseList.reverse()}(n.sortBy,n.sortDir),t())}),angular.extend(this,{selectCourse:n.onSelect()})}]}}]},{underscore:void 0}],781:[function(e,t,n){"use strict";e("../../common/app").directive("clMyStuff",e("./directives/index"))},{"../../common/app":70,"./directives/index":780}],782:[function(e,t,n){"use strict";t.exports=["ChannelTopicService","ScoresService","$window",function(n,r,e){return{restrict:"AE",scope:{},templateUrl:"/templates/my-topics/channels.html",replace:!0,link:function(t,e){(new r).fetchSortedCategories(function(e){e=_.pluck(e,"_id");n.getChannelByIds(e).then(function(e){t.channelTopics=e})})}}}]},{}],783:[function(e,t,n){"use strict";function r(a,s,c,u,l,d,f,p,h,m){return{restrict:"AE",scope:{copyOptions:"<?"},templateUrl:function(e,t){return"/templates/my-topics/"+(t.template||"followed-topics")+".html"},replace:!0,link:function(r){var e;function n(n){e.fetchFilteredTopics(function(e){var e=h.pluck(e,"_id"),t=f(a,"user._data.user.follows.topic"),t=h.chain(e).intersection(t).union(t).value();s.getTopicByTaxonomyIds(t).then(function(e){r.topics=e,n()})})}function t(e,t){n(function(){o(),i(!0)})}function i(e){r.expand=void 0!==e?e:!r.expand,r.expand?r.limitTo=1e3:r.limitTo=r.numberTopicToShow,r.buttonCTA=r.expand?r.buttonCtaLess:r.buttonCtaMore}function o(){var e=l.innerWidth||d[0].documentElement.clientWidth;r.numberTopicToShow=1500<=e?12:e<1500&&1200<=e?8:e<1200&&992<=e?6:e<992&&768<=e?4:2,r.limitTo=r.numberTopicToShow,r.topics&&!r.topics.length&&(r.emptyTopicsRange=h.range(r.numberTopicToShow/2))}a.user.valid()?(r.copyOptions||(r.copyOptions={}),r.buttonCtaMore=r.copyOptions.seeAllCta||u("i18n")("my-topics-show-more","show more"),r.buttonCtaLess=r.copyOptions.showLessCta||u("i18n")("my-topics-show-less","show less"),e=new c,r.expand=!1,r.buttonClick=i,r.trackClick=function(){p.trackClick(r.copyOptions.emptyTileCta,"button",r.copyOptions.title+" Empty Tile")},n(function(){i(!1),r.$on("user:follow",t),r.$on("user:unfollow",t),f(m,"config.newMyCL.enable")?r.$watch(function(){return l.innerWidth||d[0].documentElement.clientWidth},function(e){o()}):(r.numberTopicToShow=6,r.limitTo=r.numberTopicToShow)})):r.topics=[]}}}r.$inject=["$rootScope","ChannelTopicService","ScoresService","$filter","$window","$document","deepval","trackFactory","_","rind"],t.exports=r},{}],784:[function(e,t,n){"use strict";t.exports=["$rootScope","ScoresService",function(r,i){return{restrict:"AE",templateUrl:"/templates/my-topics/index.html",replace:!0,link:function(t,e,n){r.user.valid()?(new i).fetchFilteredTopics(function(e){t.showChannels=!e.length}):t.showChannels=!1}}}]},{}],785:[function(e,t,n){"use strict";var u=e("underscore");t.exports=["$rootScope","ChannelTopicService","ScoresService","$filter","deepval",function(i,o,a,s,c){return{restrict:"AE",scope:{},templateUrl:"/templates/my-topics/recommended-topics.html",replace:!0,link:function(n,e){var t;function r(){t.fetchFilteredTopics(function(e){var t=c(i,"user._data.user.follows.topic"),e=u.chain(e).pluck("_id").difference(t).value();n.expand=!1,n.buttonCTA=s("i18n")("my-topics-show-more","show more"),o.getTopicByTaxonomyIds(e).then(function(e){n.topics=e,n.contentOverFlowed=n.topics.length>n.numOfTopicsShown})})}i.user.valid()&&(t=new a,n.NUMBER_TOPIC_TO_SHOW=8,n.limitTo=n.NUMBER_TOPIC_TO_SHOW,n.$on("user:follow",r),r(),n.buttonClick=function(){n.expand=!n.expand,n.expand?n.limitTo=1e3:n.limitTo=n.NUMBER_TOPIC_TO_SHOW,n.buttonCTA=n.expand?s("i18n")("my-topics-show-less","show less"):s("i18n")("my-topics-show-more","show more")})}}}]},{underscore:void 0}],786:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clMyTopics",e("./directives/index")),r.directive("followedTopics",e("./directives/followed-topics")),r.directive("recommendedTopics",e("./directives/recommended-topics")),r.directive("channels",e("./directives/channels"))},{"../../common/app":70,"./directives/channels":782,"./directives/followed-topics":783,"./directives/index":784,"./directives/recommended-topics":785}],787:[function(e,t,n){"use strict";function r(e,t,o,a){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"activeSubscription")+".html"},replace:!0,link:function(i){t.getSubscriptionsByUser({userId:e.user.get("_id"),unverified:"true",inactive:"true"}).then(function(e){var t=e&&e[0]&&e[0].subscriptionPlan&&e[0].subscriptionPlan.slug,e=a.pluck(e,"subscriptionPlan"),e=a.find(e,function(e){return"creator-pass"===e.slug||"monthly-creator-pass"===e.slug||"annual-paid-monthly-creator-pass"===e.slug}),n=o("i18n")("cl-dashboard-background-image-"+t,"https://downloads.creativelive.com/creator-pass/hero-"+t+".jpg"),r=!1;e&&(n=o("i18n")("cl-dashboard-background-image-creator-pass","https://downloads.creativelive.com/creator-pass/header-creator-pass.jpg"));"back-to-biz"===t&&(r=!0);i.$emit("cl-onboarding-stripe:set-background-image",{backgroundImage:n,shortImage:r})})}}}r.$inject=["$rootScope","SubscriptionService","$filter","_"],t.exports=r},{}],788:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout",function(r,i){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"followingTopic")+".html"},replace:!0,link:function(e){var t;function n(){e.hasTopics=r.user&&r.user.hasInterests(!1)}n(),angular.isFunction(e.onDone)&&(t=e.$on("interests:modal:close",function(){n(),e.hasTopics&&(t(),i(function(){e.onDone()},3e3))}))}}}]},{}],789:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","ChannelTopicService","ScoresService","deepval","_",function(s,c,u,l,d,f){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"inlineFollowingTopic")+".html"},replace:!0,link:function(n){var e=new l,t=angular.noop;function r(e){t(),angular.isFunction(n.onDone)&&c(function(){n.onDone()},e||3e3)}function i(t){return n.currentIndex++,(t=n.userTopics[n.currentIndex])||(n.currentIndex=0,t=n.userTopics[n.currentIndex]),t?t.score<1?o(t):void u.getTopicByTaxonomyIds([t._id]).then(function(e){e=d(e||[],"0.image.key");e&&n.$emit("cl-onboarding-stripe:set-background-image",{backgroundImage:e}),n.topic=t}):r(1)}function o(t){n.userTopics=f.reject(n.userTopics,function(e){return e._id===t._id}),e.engagement({topics:[t._id],amount:-t.score}),i()}function a(){n.hasTopics=s.user&&s.user.hasInterests&&s.user.hasInterests(!1)||0===n.userTopics.length}angular.extend(n,{followTopic:function(e){s.user.follow("topic",{entityId:e._id})},nextTopic:i,rejectTopic:o,userTopics:[],currentIndex:-1}),e.setUser(s.user._data.user),e.fetchFilteredTopics(function(e){n.userTopics=f.reject(angular.copy(e),function(e){return e.score<1}),a(),i()}),angular.isFunction(n.onDone)&&(t=n.$on("user:follow",function(){a(),n.hasTopics&&r()}))}}}]},{}],790:[function(e,t,n){"use strict";t.exports=["$rootScope","UserProfileService","deepval","$timeout",function(r,t,i,o){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"profileName")+".html"},replace:!0,link:function(n){angular.extend(n,{save:function(){var e=i(r,"user._data.user");n.profile&&(e.profile=n.profile,t.save(e,function(e,t){e||!t||t&&!t.success?n.error=!0:(r.user.set("profile",n.profile),n.verified=!0,o(function(){n.onDone()},2e3))}))},tryAgain:function(){n.error=!1,n.verified=!1}}),r.user.valid()&&(n.profile=r.user.get("profile"))}}}]},{}],791:[function(e,t,n){"use strict";t.exports=["$rootScope","flowControl","trackFactory",function(e,t,r){return{restrict:"AE",scope:{onComplete:"&",onAbort:"&",modal:"="},templateUrl:"/templates/onboarding/reg.html",replace:!0,link:{pre:function(n,e){n.goBack=function(){n.verifyAbort=!1},n.quit=function(){r.onboardingQuit()},n.finishUp=function(){r.onboardingFinishUp()},t(n,e.children()[0].children,{onAbort:function(e,t){r.onboardingX(),n.allDone()?t&&t():n.verifyAbort=!0}}),n.showView()}}}}]},{}],792:[function(e,t,n){"use strict";t.exports=["OnboardingService","$rootScope","$compile","$timeout","_",function(r,i,o,e,a){return{restrict:"AE",template:'<div ng-show="ready" ng-class="{\'cl-onboarding-stripe-short\': shortImage}" class="cl-onboarding-stripe" cl-background-image="backgroundImage" cl-background-watch="true"></div>',replace:!0,link:function(n,t){function e(){var e=r.getNextStep();e?(e=angular.element("<div "+e.directive+' on-done="onDone()"></div>'),o(e)(n),t.html(e),n.ready=!0):n.ready=!1}angular.extend(n,{onDone:function(){r.setStepComplete(),r.refresh(),r.setNextStep(),e()}}),i.user.hasCreatorPassSubscription()||(n.backgroundImage=a.sample(["https://downloads.creativelive.com/onboarding/bg-1.jpg","https://downloads.creativelive.com/onboarding/bg-2.jpg","https://downloads.creativelive.com/onboarding/bg-3.jpg","https://downloads.creativelive.com/onboarding/bg-4.jpg","https://downloads.creativelive.com/onboarding/bg-5.jpg"])),n.$on("cl-onboarding-stripe:set-background-image",function(e,t){t.backgroundImage&&(n.backgroundImage=t.backgroundImage),t.shortImage&&(n.shortImage=!0)}),r.onReady(e),r.init()}}}]},{}],793:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout",function(e,n){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"verifyEmail")+".html"},replace:!0,controller:"EmailVerifyController",controllerAs:"verifyCtrl",link:function(e){var t;angular.isFunction(e.onDone)&&(t=e.$watch("verifyCtrl.verified",function(){e.verifyCtrl.verified&&(t(),n(function(){e.onDone()},3e3))}))}}}]},{}],794:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout",function(e,n){return{restrict:"AE",scope:{onDone:"&"},templateUrl:function(e,t){return"/templates/onboarding/"+(t.template||"verifySubscription")+".html"},replace:!0,controller:"EmailVerifyController",controllerAs:"verifyCtrl",link:function(e){var t;angular.isFunction(e.onDone)&&(t=e.$watch("verifyCtrl.verified",function(){e.verifyCtrl.verified&&(t(),n(function(){e.onDone()},3e3))}))}}}]},{}],795:[function(e,t,n){"use strict";var r=e("../../common/app");r.service("OnboardingService",e("./services/index")),r.service("clOnboardingModal",e("./services/modal")),r.directive("clOnboardingReg",e("./directives/reg")),r.directive("clOnboardingStripe",e("./directives/stripe")),r.directive("clOnboardingVerifyEmail",e("./directives/verifyEmail")),r.directive("clOnboardingActiveSubscription",e("./directives/activeSubscription")),r.directive("clOnboardingVerifySubscription",e("./directives/verifySubscription")),r.directive("clOnboardingProfileName",e("./directives/profileName")),r.directive("clOnboardingFollowingTopic",e("./directives/followingTopic")),r.directive("clOnboardingInlineFollowingTopic",e("./directives/inlineFollowingTopic"))},{"../../common/app":70,"./directives/activeSubscription":787,"./directives/followingTopic":788,"./directives/inlineFollowingTopic":789,"./directives/profileName":790,"./directives/reg":791,"./directives/stripe":792,"./directives/verifyEmail":793,"./directives/verifySubscription":794,"./services/index":796,"./services/modal":797}],796:[function(e,t,n){"use strict";r.$inject=["$rootScope","$timeout","Vault","_","ScoresService","SubscriptionService"];var _=e("async");function r(o,l,n,a,d,f){var r,e=new d,t=[{name:"verifySubscription",done:void 0,directive:"cl-onboarding-verify-subscription",verify:function(t){var n=this,e=o.user.get("primary_email"),r=o.user.getTrait("^subscription-trial-student"),i=o.user.getTrait("active_consumer_subscription");e&&!1===e.verified&&r&&i?f.getSubscriptionsByUser({unverified:!0}).then(function(e){n.done=!a.find(e,function(e){return"unverified"===e.state}),t()}):(this.done=e&&!0===e.verified||!r||!i,t())}},{name:"activeSubscription",done:void 0,directive:"cl-onboarding-active-subscription",verify:function(e){var t=o.user.hasActiveConsumerSubscription();this.done=!t,e()}},{name:"verifyEmail",done:void 0,directive:"cl-onboarding-verify-email",verify:function(e){var t=o.user.get("primary_email");this.done=t&&!0===t.verified,e()}},{name:"profileName",done:void 0,directive:"cl-onboarding-profile-name",verify:function(e){var t=o.user.get("profile");this.done=t&&t.first_name&&""!==t.first_name,e()}},{name:"followingTopic",done:void 0,directive:"cl-onboarding-following-topic",verify:function(t){var n=this;e.fetchFilteredTopics(function(e){n.done=o.user.hasInterests&&o.user.hasInterests(!1)||0<e.length,t()})}},{name:"inlineFollowingTopic",done:void 0,directive:"cl-onboarding-inline-following-topic",verify:function(t){var n=this;e.fetchFilteredTopics(function(e){e=a.reject(e,function(e){return e.score<1}),n.done=o.user.hasInterests&&o.user.hasInterests(!1)||0===e.length,t()})}}],i=[],s=!1,p=!1,c=[],h=[],u=300,m=a.once(g);return{init:function(){if(p)return g();s||(s=!0,e.setUser(o.user._data.user),y())},refresh:y,setNextStep:b,getNextStep:function(){return r},setStepComplete:function(){u&&n.Local.set("cl-onboarding-seen",!0,{expires:"+"+u+" seconds"})},onboardingSteps:t,setSteps:function(e){e=e||["followingTopic","profileName","verifyEmail"],i.splice(0,i.length),angular.forEach(e,function(e){e=a.findWhere(t,{name:e});e&&e.verify&&i.push(e)})},onReady:function(e){c.push(e)},onDone:function(e){h.push(e)},setOnboardingDelayInSeconds:function(e){a.isNumber(e)&&(u=e)}};function g(){for(b(),p=!0;c.length;){var e=c.shift();angular.isFunction(e)&&e()}}function v(){angular.forEach(h,function(e){e()})}function y(){o.user&&o.user.valid()?_.eachSeries(i,function(e,t){e.verify(function(){t()})},m):m()}function b(){if(n.Local.get("cl-onboarding-seen"))return r=void 0,v();var e=void 0!==r,t=void 0;angular.forEach(i,function(e){!e||t||e.done||(t=e)}),r=t,e&&!t&&v()}}t.exports=r},{async:21}],797:[function(e,t,n){"use strict";function r(c,u,t,l,d,f){return function(e,s){s=s||{},t.open({backdrop:"static",keyboard:!1,templateUrl:"/templates/onboarding/modal.html",windowClass:"cl-modal modal-interests",controller:["$scope","$uibModalInstance","rind",function(n,e,t){var r=n.$on("user:follow",o),i=n.$on("user:unfollow",o);function o(){n.userIsFollowing=c.user&&c.user.hasInterests&&c.user.hasInterests(!1)}function a(){var e=document.querySelector(".onboarding-interests-modal").getBoundingClientRect(),t=e.top+(e.top+e.height)/2,e=f.findLastIndex(n.channelTopics,function(e){return document.getElementById("anchor-"+e._id).getBoundingClientRect().top<t});n.selectedChannelId=n.channelTopics[e]._id}n.isMobile=t&&t.context&&t.context.ua&&t.context.ua.mobile,d.lock("onboardingModal",!0),l.onboardingModalShown(s.via),n.close=function(){d.unlock("onboardingModal"),c.$broadcast("interests:modal:close"),r(),i(),e.dismiss()},n.$on("channelTopics:complete",function(e,t){n.channelTopics=t,n.selectedChannelId=n.channelTopics[0]._id,n.isMobile||angular.element(".interests-container").on("scroll",f.throttle(a,300,{leading:!1}))}),n.goToAnchor=function(e){u.yOffset=60,u("anchor-"+e),n.selectedChannelId=e}}]})}}r.$inject=["$rootScope","$anchorScroll","$uibModal","trackFactory","LockBody","_"],t.exports=r},{}],798:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["$window",function(s){return{restrict:"EA",link:function(e,t,n){var r;if(t.addClass("overflow-tooltip"),!n.overflowTitle||!n.overflowToggle)return["clOverflowTooltip:","https://github.com/creativelive/frontend/blob/f9b027248fd9e19b111b896692eb2e3f8a312c84/cl-angular/modules/overflow-tooltip.mod/directives/index.js","Params:"," * overflow-title [string] - the text for the tooltip"," * overflow-toggle [string] - the name of the $scope var to access"," * overflow-class [string] (optional) - className of the child element to check"].join("\n"),!1;var i=e.$watch("segment.title",function(){e.segment&&e.segment.title&&(a(),i())}),o=e.$watch("videoItem.title",function(){e.videoItem&&e.videoItem.title&&(a(),o())});function a(){(r=r||function(){var e=n.overflowClass;return e?t[0].querySelector(e):t[0]}()).scrollWidth>r.offsetWidth?e[n.overflowToggle]=n.overflowTitle:e[n.overflowToggle]=void 0}s.addEventListener("resize",c.debounce(a,300)),e.onHover=a}}}]},{underscore:void 0}],799:[function(e,t,n){"use strict";e("../../common/app").directive("clOverflowTooltip",e("./directives/index"))},{"../../common/app":70,"./directives/index":798}],800:[function(e,t,n){"use strict";function r(r,i){return{restrict:"A",templateUrl:"/templates/owned-courses/empty.html",link:function(n,e,t){r.user.valid()&&r.user.recentInteractions&&r.user.getContent().then(function(e){var t=i.chain(e.purchased.courses).union(e.purchased.bundles).indexBy("_id").value(),e=i.chain(e.starred.courses).union(e.starred.bundles).reject(function(e){return!e._id||!1===(e.flagged||{}).published||void 0!==t[e._id]}).value();n.showEmpty=i.isEmpty(t)&&!e.length})}}}r.$inject=["$rootScope","_"],t.exports=r},{}],801:[function(e,t,n){"use strict";function r(r){return{restrict:"A",templateUrl:"/templates/owned-courses/find-class-tile.html",scope:{ctaLabel:"@",label:"@"},link:function(e,t,n){e.trackClick=function(){r.trackClick(e.ctaLabel,"link","emptyOwnedCoursesLink")}}}}r.$inject=["trackFactory"],t.exports=r},{}],802:[function(e,t,n){"use strict";function r(s,c,u){return{restrict:"AE",scope:{options:"<?"},templateUrl:function(e,t){return t.template?"/templates/owned-courses/"+t.template+".html":"/templates/owned-courses/index.html"},transclude:{emptyState:"?emptyState",firstTile:"?firstTile",lastTile:"?lastTile"},controller:["$transclude","$scope",function(e,t){t.hasEmptyState=e.isSlotFilled("emptyState"),t.hasFirstTile=e.isSlotFilled("firstTile"),t.hasLastTile=e.isSlotFilled("lastTile")}],link:function(n,e,t){n.allCourses=new c,n.maxCourseCount=parseInt(t.maxCourseCount||0,10);var r=function(){a()},i=(s.user.valid()&&s.user.recentInteractions&&s.user.recentInteractions({limit:n.maxCourseCount}).then(function(e){var t=_.sortBy(e.history.purchased,"last_interaction").reverse();_.each(t,function(e){e&&e._id&&"keep-watching"===e.type&&n.allCourses.addToSet(e,"_id")}),_.each(e.courses,function(e){e&&e._id&&"keep-watching"===e.type&&n.allCourses.addToSet(e,"_id")}),n.pages=Math.ceil(n.allCourses.length/n.limit),r()}),void 0),o=void 0;function a(){var e=(n.currentPage-1)*n.limit;n.displayedCourses=n.allCourses.slice(e,e+n.limit),n.overflowed=n.displayedCourses.length>n.hideLimit||1<n.currentPage,n.isLastPage=!n.displayedCourses.length||n.currentPage===n.pages,n.isLastPage?u.setHeight(i,o):u.removeHeight(i)}n.options||(n.options={}),_.extend(n,{currentPage:1,limit:12,maxSize:5,pages:0,showAllClasses:!1,collapse:function(){n.showAllClasses=!1,1<n.currentPage&&(n.currentPage=1,a());u.removeHeight(i)},expand:function(){n.showAllClasses=!0,i||(i=e.find("#tileContainer"+n.$id),o=e.find("#tileContainerInner"+n.$id))},pageChanged:a}),n.$watch(function(){return e[0].scrollWidth},function(e){n.hideLimit=1082<=e?4:e<1082&&895<e?3:2})}}}r.$inject=["$rootScope","DataSet","TransitionalHeight"],t.exports=r},{}],803:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("ownedCourses",e("./directives/index")),r.directive("emptyOwnedCourses",e("./directives/empty")),r.directive("findClassTile",e("./directives/find-class-tile"))},{"../../common/app":70,"./directives/empty":800,"./directives/find-class-tile":801,"./directives/index":802}],804:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{},templateUrl:function(e,t){if(""===e.html()&&!t.disableTemplate)return"/templates/page-footer/view.html";this.replace=!1},replace:!0,link:function(e,t,n){e.config=r,e.year=(new Date).getFullYear(),e.piClick=function(e){"prod"!==r.env&&e&&e.shiftKey&&(e.ctrlKey||e.metaKey)&&window.open("https://www.youtube.com/watch?v=pXPXMxsXT28")}}}}]},{}],805:[function(e,t,n){"use strict";e("../../common/app").directive("pageFooter",e("./directives/view"))},{"../../common/app":70,"./directives/view":804}],806:[function(e,t,n){"use strict";t.exports=["config",function(r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/partner-row/edit.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data)}}}]},{}],807:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/partner-row/view.html",replace:!0,link:function(e,t,n){e.data||(e.data=e.$parent.data)}}}]},{}],808:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("partnerRow",e("./directives/view")),r.directive("partnerRowEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":806,"./directives/view":807}],809:[function(e,t,n){"use strict";t.exports=["$sce","partnerResource",function(i,o){return{restrict:"AE",templateUrl:"/templates/partner/button.html",replace:!0,scope:{partner:"="},link:function(t,e,n){t.cta=n.cta;var r=t.$watch("partner",function(e){e&&(e={},t.partner._id?e.id=t.partner._id:t.partner.slug?e.slug=t.partner.slug:e.slug=t.partner,o.get(e,function(e){t.partner=e.data,t.partner&&(_.each(t.partner.campaigns,function(e){"redeem-button"===e.slug&&e.freeform&&(t.redeemButtonLabel=i.trustAsHtml(e.freeform))}),t.redeemButtonLabel||(e=t.partner.name||"",t.redeemButtonLabel="Redeem "+e+" Purchase"))}),r())})}}}]},{}],810:[function(e,t,n){"use strict";var u=e("underscore");t.exports=["$sce","partnerResource",function(s,c){return{restrict:"AE",template:'<div><div class="partner" ng-bind-html="campaign.freeform"></div><div ng-transclude ng-show="showTransclude"></div></div>',replace:!0,transclude:!0,scope:{partner:"=?",partnerSlug:"=?",campaignSlug:"=?"},link:function(t,e,n){t.showTransclude=!1,t.cta=n.cta,t.campaign=null,t.watchUpdatedCount=0;var r=t.$watch("partner",function(e){t.watchUpdatedCount++,e&&o(),a()}),i=t.$watch("partnerSlug",function(e){t.watchUpdatedCount++,e&&o(),a()});function o(){r&&r(),i&&i()}function a(){var e={};if(t.partner)t.partner._id?e.id=t.partner._id:t.partner.slug&&(e.slug=t.partner.slug);else{if(!t.partnerSlug)return void(2<=t.watchUpdatedCount&&(t.showTransclude=!0));e.slug=t.partnerSlug}c.get(e,function(e){t.partner=e.data,t.partner&&u.each(t.partner.campaigns,function(e){e.slug===t.campaignSlug&&(t.campaign=e,t.campaign.freeform&&(t.showTransclude=!1,t.campaign.freeform=s.trustAsHtml(t.campaign.freeform)))}),t.campaign&&t.campaign.freeform||(t.showTransclude=!0)})}}}}]},{underscore:void 0}],811:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("partnerCampaign",e("./directives/campaign")),r.directive("partnerButton",e("./directives/button"))},{"../../common/app":70,"./directives/button":809,"./directives/campaign":810}],812:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService","$filter",function(e,i,o){return{restrict:"AE",scope:{event:"=?"},templateUrl:"/templates/past-event/index.html",controllerAs:"ctrl",controller:["$scope","$attrs",function(e,t){var n=this;function r(){e.event&&(n.event=e.event,i.getEventUIData(n.event).then(function(e){n.course=e,n.course.display_date=o("date")(1e3*n.course.start_time,"MMMM d, yyyy")}))}"true"===t.watch?e.$watch("event",r):e.event&&r()}]}}]},{}],813:[function(e,t,n){"use strict";e("../../common/app").directive("clPastEvent",e("./directives/index"))},{"../../common/app":70,"./directives/index":812}],814:[function(e,t,n){"use strict";function r(d,f,p,h){return{restrict:"A",link:function(o,l,a){d.$on("user:login",r),d.$on("user:register",r);var n=[],e=(angular.forEach(["clProductId","clCourseId","clCourseSlug","clCourseNid","clBundleId","clBundleSlug"],function(e){e=a.$observe(e,r);n.push(e)}),{}),t={};try{e=JSON.parse(a.clSourceOpts)}catch(e){}try{t=JSON.parse(a.clSourceParams)}catch(e){}function r(){a.clProductId?i(a.clProductId):a.clCourseId?f.getCourseById(a.clCourseId,e,t).then(i).catch(c):a.clCourseIds?f.getCoursesByIds(a.clCourseIds.split(","),e,t).then(i).catch(c):a.clCourseSlug?f.getCourseBySlug(a.clCourseSlug,e,t).then(i).catch(c):a.clCourseNid?f.getCourseByNid(a.clCourseNid,e,t).then(i).catch(c):a.clBundleId?f.getBundleById(a.clBundleId,e,t).then(i).catch(c):a.clBundleSlug&&f.getBundleBySlug(a.clBundleSlug,e,t).then(i).catch(c)}function i(e){e=a.clProductId||("string"==typeof e.product?e.product:e.product._id);p.getPrice(e).then(function(e){var t;return o[a.clPriceKey||"priceData"]=e,"true"!==a.watch&&angular.forEach(n,function(e){e()}),a.clMonthlyPrice&&(t=100*Math.ceil(e.current_price/1200),o[a.clPriceKey||"priceData"].monthlyPrice=t),e}).then(s).then(u).catch(c)}function s(e){var t=o[a.clPriceKey||"priceData"].current_price,n=o[a.clPriceKey||"priceData"].full_price;o[a.clPriceKey||"priceData"].percentDiscount=Math.floor(100*(n-t)/n);try{var r,i=e.applied_discounts[0];i.conditions&&(r=h.find(i.conditions,function(e){return e.start})||!0),o[a.clPriceKey||"priceData"].onSaleTiming=r}catch(e){}return e}function c(e){}function u(e){var t,e=e&&e.product&&e.product.source;e&&"bundle"===e.source_type&&a.clBundleFullPrice&&(e=f.getCoursesByIds(e.courses,{keys:["product"]}),t=f.getPrices(),Promise.all([e,t]).then(function(e){var n=h.pluck(e[0],"product"),e=h.reduce(e[1],function(e,t){return-1!==h.indexOf(n,t.id)&&(e.prices.push(t),e.full_price+=t.full_price),e},{full_price:0,prices:[]});o[a.clPriceKey||"priceData"].bundle_full_price=e.full_price}))}}}}r.$inject=["$rootScope","CatalogService","CourseService","_"],t.exports=r},{}],815:[function(e,t,n){"use strict";e("../../common/app").directive("clPriceProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":814}],816:[function(e,t,n){"use strict";t.exports=["$timeout",function(r){return{restrict:"E",scope:{current:"=",full:"=",sale:"="},templateUrl:"/templates/price/current.html",replace:!0,link:function(n){n.$watch("sale.end",function(e,t){e&&(e=1e3*e-Date.now(),r(function(){n.sale=!1,n.current=n.full},e))})}}}]},{}],817:[function(e,t,n){"use strict";e("../../common/app").directive("priceCurrent",e("./directives/current"))},{"../../common/app":70,"./directives/current":816}],818:[function(e,t,n){"use strict";var d=e("underscore"),f=e("moment");t.exports=["productResource","CourseService","scheduleResource","EventService",function(s,c,u,l){return{restrict:"AE",templateUrl:function(e,t){return t.template?"/templates/"+t.template+".html":"/templates/product-card/view.html"},replace:!0,scope:{productId:"=",eventId:"@"},link:function(r,e,t){var n;function i(){s.findById({id:r.productId},function(e){r.product=e.data,r.source=r.product.source,u.findByContentId({id:r.source._id,time:"end_time",when:"after"},function(e){var e=l.organizeBroadcastsForSource(e.data,r.source),t=e.current,n=e.next;r.schedule=t||n,e.lives.length?r.broadcast=a(d.first(e.lives).start_time,d.last(e.lives).end_time):e.rebroadcasts.length?r.broadcast=a(d.first(e.rebroadcasts).start_time,d.last(e.rebroadcasts).end_time):r.schedule&&(r.broadcast=a(r.schedule.start_time,r.schedule.end_time)),r.title=r.schedule&&r.schedule.meta&&r.schedule.meta.title})})}function o(){c.getPrice(r.productId).then(function(e){r.price=e;try{var t,n=r.price.applied_discounts[0];n.conditions&&(t=d.find(n.conditions,function(e){return e.start})||!0),r.onSale=t}catch(e){}})}function a(e,t){var n={start:e,end:t};return f.unix(e).dayOfYear()===f.unix(t).dayOfYear()&&(n.singleDay=!0),f.unix(e).month()===f.unix(t).month()&&(n.singleMonth=!0),n}r.productTitle=t.productTitle,r.productId?(i(),o()):n=r.$watch("productId",function(e){e&&(i(),o(),n())})}}}]},{moment:void 0,underscore:void 0}],819:[function(e,t,n){"use strict";e("../../common/app").directive("productCard",e("./directives/index"))},{"../../common/app":70,"./directives/index":818}],820:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{allCourses:"="},templateUrl:function(e,t){return"/templates/product-view-history/grid.html"},transclude:{emptyState:"?emptyState",firstTile:"?firstTile",lastTile:"?lastTile"},controller:["$transclude","$scope",function(e,t){t.hasEmptyState=e.isSlotFilled("emptyState"),t.hasFirstTile=e.isSlotFilled("firstTile"),t.hasLastTile=e.isSlotFilled("lastTile")}],link:function(t,e,n){function r(){var e=(t.currentPage-1)*t.limit;t.displayedCourses=t.allCourses.slice(e,e+t.limit),t.isLastPage=!t.displayedCourses.length||t.currentPage===t.pages}_.extend(t,{limit:12,currentPage:1,maxSize:5,pages:0,pageChanged:r}),r()}}}},{}],821:[function(e,t,n){"use strict";function r(o,a){return{restrict:"A",link:function(t,e,n){var r=n.clProductViewHistoryKey||"clProductViewHistory",i=parseInt(n.clProductViewHistoryLimit)||void 0,n=n.clProductViewHistoryContentType,n=o.get(n,!0).slice(1,i&&i+1);t[r]={ready:!1},a.getCoursesByProducts(_.pluck(n,"productId"),{bff:!0}).then(function(e){t[r].history=e,t[r].ready=!0}).catch(function(e){})}}}r.$inject=["ProductViewHistoryService","CatalogService"],t.exports=r},{}],822:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clProductViewHistoryProvider",e("./directives/provider")),r.directive("clMyProductViewHistory",e("./directives/index"))},{"../../common/app":70,"./directives/index":820,"./directives/provider":821}],823:[function(e,t,n){"use strict";function r(a){return{restrict:"A",link:function(t,e,n){var r=n.clProductProviderKey||"clProductData";function i(e){t[r]=e,t[r].productDataReady=!0,n.clDebug}function o(e){n.clDebug}n.clProductId&&a.findById(n.clProductId).then(i).catch(o)}}}r.$inject=["ProductService"],t.exports=r},{}],824:[function(e,t,n){"use strict";e("../../common/app").directive("clProductProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":823}],825:[function(e,t,n){"use strict";t.exports=["$filter",function(i){return{restrict:"AE",replace:!0,scope:{total:"<",current:"<",currentText:"@?",totalText:"@?",noProgressText:"@?",inProgressText:"@?",completeText:"@?",showPercentage:"<?"},templateUrl:function(e,t){return t.template?"/templates/progress-chart/"+t.template+".html":"/templates/progress-chart/small.html"},link:function(t,e,n){switch(n.template){case"large":t.currentText=t.currentText||i("i18n")("progress-chart-current-text","Watched"),t.totalText=t.totalText||i("i18n")("progress-chart-total-text","Total"),t.completeText=t.completeText||i("i18n")("progress-chart-complete-text","COMPLETE");break;case"medium":t.inProgressText=t.inProgressText||i("i18n")("progress-chart-in-progress-text","Start Next&nbsp;Lesson"),t.noProgressText=t.noProgressText||i("i18n")("progress-chart-no-progress-text","Start&nbsp;Path"),t.completeText=t.completeText||i("i18n")("progress-chart-complete-text","COMPLETE")}var r=t.$watch("current",function(e){void 0===e?t.current=0:(t.percent=Math.round(t.current/t.total*100),0<e&&r(),t.ready=!0)})}}}]},{}],826:[function(e,t,n){"use strict";e("../../common/app").directive("progressChart",e("./directives/index"))},{"../../common/app":70,"./directives/index":825}],827:[function(e,t,n){"use strict";var l=e("underscore"),d=e("async");t.exports=["$sce","config","arrayMove","courses","mediaResource","fileResource",function(e,r,s,o,c,u){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/quick-watch/edit.html",replace:!0,link:function(a,e,t){var n;a.config=r,a.data||(a.data=a.$parent.data),a.data.segments||(a.data.segments=[]),a.segments=angular.copy(a.data.segments),a.addSegment=function(n){var r,i;d.series([function(t){if(!n.course)return t();o.getCompleteById({id:n.course},function(e){r=e.data,t()})},function(t){c.get({id:n.media[0]},function(e){i=e,t()})},function(t){if(i.data.token)return t();u.get({id:i.data.file._id||i.data.file},function(e){i.data.videoUrl="https://s3-us-west-2.amazonaws.com/"+e.data.bucket+"/"+e.data.key,t()})}],function(){var e={_id:n._id,slug:n.slug,title:n.title,thumbnail_url:n.thumbnail_url,videoUrl:i.data.videoUrl,token:i.data.token};r&&(e.course={title:r.title,url:"/courses/"+r.slug,image:r.image.file.key,instructors:l.deepOmit(r.instructors,"courses profile.bio profile.short_bio"),primary_category:r.primary_category}),a.data.segments.push(e)})},a.removeSegment=function(e){a.data.segments.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()},a.freeWatch=0===a.data.freeWatchLength,a.$watch("freeWatch",function(){a.freeWatch?(n=a.data.freeWatchLength,a.data.freeWatchLength=0):n&&(a.data.freeWatchLength=n)})}}}]},{async:21,underscore:void 0}],828:[function(e,t,n){"use strict";t.exports=["$sce","$timeout","$filter","config","mediaResource",function(e,c,u,l,d){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/quick-watch/view.html",replace:!0,link:function(i,e,t){var n;function r(e,t,n){var r=e.course&&e.course.image||e.thumbnail_url;i.posterUrl=u("magick")(r,{width:500}),i.currentSegment=e,i.$broadcast("video:queue",{playUrl:n&&n.data&&n.data.playUrl||e.videoUrl,posterUrl:i.posterUrl,segment:e}),t&&c(function(){i.$broadcast("video:send-command","play")})}function o(t,n){if(i.showWall=!1,!t.token)return c(function(){r(t,n)},300);d.token({token:t.token},function(e){r(t,n,e)})}i.config=l,i.video={},i.setSegment=o,i.onVideoPlayerReady=function(e){i.video=e,0<a&&i.video.on("play",function(e){n&&c.cancel(n),n=c(function(){i.showWall=!0,i.$broadcast("video:send-command","pause")},a)});try{o(i.data.segments[0])}catch(e){throw e}},i.data||(i.data=i.$parent.data);var a=!isNaN(i.data.freeWatchLength)&&0<=i.data.freeWatchLength?1e3*i.data.freeWatchLength:9e4,s=i.$watch("data.segments",function(){try{o(i.data.segments[0],!1),s()}catch(e){}},!0)}}}]},{}],829:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("quickWatch",e("./directives/view")),r.directive("quickWatchEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":827,"./directives/view":828}],830:[function(e,t,n){"use strict";function r(r,e){return{restrict:"AE",scope:{quizId:"=",resultId:"=",question:"=",onNext:"=",onConfirm:"="},templateUrl:function(e,t){return t.template?"/templates/quiz/"+t.template+".html":"/templates/quiz/question.html"},replace:!0,link:function(o,e,t){function n(i){return r.reduce(o.question.choices,function(e,t,n){var r=void 0;return"checkbox"===o.question.displayType&&(r=!!i[n]),(r="radio"===o.question.displayType?i===n:r)&&e.push(t._id),e},[])}angular.extend(o,{confirm:function(){var e=[];"checkbox"===o.question.displayType&&(e=n(o.data.checkbox));"radio"===o.question.displayType&&(e=n(o.data.radio));o.onConfirm(e)},confirmEnabled:function(){var e=!1;{var t;"checkbox"===o.question.displayType&&(t=r.without(o.data.checkbox,null,!1),e=0<t.length)}"radio"===o.question.displayType&&(e=-1!==o.data.radio);return e},next:function(){o.onNext(),o.data={checkbox:[],radio:-1},o.disabled=!1},disabled:!1,data:{checkbox:[],radio:-1}})}}}r.$inject=["_","QuizService"],t.exports=r},{}],831:[function(e,t,n){"use strict";function r(e,i){return{restrict:"AE",scope:{quizId:"@",quizTitle:"@",onComplete:"&"},templateUrl:function(e,t){return t.template?"/templates/quiz/"+t.template+".html":"/templates/quiz/quiz.html"},replace:!0,link:function(t,e,n){function r(){i.getQuiz(t.quizId).then(function(e){t.quiz=e,t.resultId=e._id,t.currentQuestion=function(e){var t=0;for(;e.questions[t].answered;)t++;return t}(e)})}angular.extend(t,{currentQuestion:0,onNext:function(){t.currentQuestion++,t.currentQuestion>=t.quiz.questions.length&&(t.correctAnswersCount=t.quiz.questions.reduce(function(e,t){return t.correct&&e++,e},0),t.percentage=Math.round(100*t.correctAnswersCount/t.quiz.questions.length))},onConfirm:function(e){i.select(t.quizId,t.resultId,t.quiz.questions[t.currentQuestion]._id,e).then(function(e){t.quiz.questions[t.currentQuestion]=e})},retake:function(){r()},complete:function(){t.onComplete()},newQuiz:r,correctAnswersCount:0,percentage:0}),t.$watch("quizId",function(e){r()})}}}r.$inject=["_","QuizService"],t.exports=r},{}],832:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clQuiz",e("./directives/quiz")),r.directive("clQuizQuestion",e("./directives/question")),r.service("QuizService",e("./services/quiz-service")),r.factory("QuizResource",e("./resources/quiz-resource"))},{"../../common/app":70,"./directives/question":830,"./directives/quiz":831,"./resources/quiz-resource":833,"./services/quiz-service":834}],833:[function(e,t,n){"use strict";function r(e){var t=void 0;return e&&e.data&&e.data.authHeader&&(t=e.data.authHeader,delete e.data.authHeader),t}t.exports=["$resource",function(e){return e("/quiz",{id:"@id",resultId:"@resultId"},{getQuizToken:{url:"/api/quiz-session",method:"POST",format:"json"},getQuiz:{url:"/quiz/:id/results",method:"POST",format:"json",headers:{Authorization:r}},select:{url:"/quiz/:id/results/:resultId/questions",method:"PUT",format:"json",headers:{Authorization:r}}})}]},{}],834:[function(e,t,n){"use strict";function r(s,o,e,t){var c=this;return c.quizToken=null,{getQuiz:function t(n){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];var i=void 0;{if(!e.user.valid())return o.reject("no user found");i=e.user._data._id}return u(n,!1).then(function(e){return s.getQuiz({id:n},{authHeader:"Bearer "+e,userId:i}).$promise}).catch(function(e){if(e&&(401===e.status||403===e.status)&&r)return c.quizToken=null,t(n,!1)})},select:function t(n,r,i,o){var a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];return u(n,!1).then(function(e){e={authHeader:"Bearer "+e,questionId:i,choices:o};return s.select({id:n,resultId:r},e).$promise}).catch(function(e){if(e&&(401===e.status||403===e.status)&&a)return c.quizToken=null,t(n,r,i,o,!1)})}};function u(e,t){if(!t&&c.quizToken){t=void 0;try{t=JSON.parse(window.atob(token.split(".")[1].replace("-","+").replace("_","/"))).data}catch(e){}if(t&&t.quizId===e&&t.exp>Date.now()/1e3+10)return o.resolve(c.quizToken)}return s.getQuizToken({quizId:e}).$promise.then(function(e){return c.quizToken=e&&e.token,c.quizToken})}}r.$inject=["QuizResource","$q","$rootScope","_"],t.exports=r},{}],835:[function(e,t,n){"use strict";function r(i,o){return{restrict:"AE",scope:{options:"<?"},templateUrl:function(e,t){return t.template?"/templates/recently-watched/"+t.template+".html":"/templates/recently-watched/index.html"},link:function(t,e,n){t.options||(t.options={}),t.recentCourses=new o,t.maxCourseCount=parseInt(n.maxCourseCount||16,10);var r=function(){};i.user.valid()&&i.user.recentlyWatchedCourses&&i.user.recentlyWatchedCourses({limit:t.maxCourseCount}).then(function(e){t.recentCourses=e,r()})}}}r.$inject=["$rootScope","DataSet"],t.exports=r},{}],836:[function(e,t,n){"use strict";e("../../common/app").directive("recentlyWatched",e("./directives/index"))},{"../../common/app":70,"./directives/index":835}],837:[function(e,t,n){"use strict";function r(n,r,e,i,o){function a(){i.cacheClear.clearReview(r.source)}r.cancel=e.dismiss,r.source=i.source,r.previousReview=!!i.previousReview,r.comment=i.previousReview?i.previousReview.comment:"",r.recommended=!i.previousReview||i.previousReview.recommended,r.submitReview=function(){var e=void 0,t=void 0,t=i.previousReview?(e=i.resource.updateReviewById,{id:i.source._id,reviewId:i.previousReview._id}):(e=i.resource.submitReviewBySlug,{slug:r.source.slug});e(t,{subject:"",comment:r.comment,recommended:r.recommended},function(){r.reviewSubmitted=!0,n.user&&n.user.valid()&&n.$emit("review:submitted",{userId:n.user.get("_id"),sourceId:r.source._id}),(new o).updateScores(),a()},a)},r.enableSubmit=function(){return!(!1===r.recommended&&!r.comment)&&(!0===r.recommended||r.comment&&""!==r.comment)}}r.$inject=["$rootScope","$scope","$uibModalInstance","args","ScoresService"],t.exports=r},{}],838:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"E",scope:{reviewCount:"="},templateUrl:"/templates/reviews/icon.html",replace:!0}}]},{}],839:[function(e,t,n){"use strict";t.exports=["ReviewModalService",function(r){return{restrict:"A",scope:{source:"=reviewModalToggleSource",counts:"=reviewModalToggleCounts",onSubmit:"&reviewModalOnSubmit"},link:function(e,t){var n=new r(e.source,e.counts,e.onSubmit);t.bind("click",function(){n.toggleModal()})}}}]},{}],840:[function(e,t,n){"use strict";r.$inject=["$rootScope","CourseService","ReviewService","deepval","_"];var k=e("moment");function r(_,w,S,E,A){return{restrict:"AE",link:function(r,t,i){var n,o=i.clReviewsProviderKey||"clReviewsProvider",a=i.$observe("clCourseId",function(){var t;i.clCourseId&&(i.lazyLoadData?t=r.$watch("moduleInView",function(e){e&&(u(),t())}):u())}),d=i.$observe("clUserId",function(){var t;i.clUserId&&(i.lazyLoadData?t=r.$watch("moduleInView",function(e){e&&(l(),t())}):l())}),s=i.clReviewsProviderRequiredKeys||!1,f=i.clReviewsProviderSort||"created",p="true"===i.clReviewsProviderOnlyRecommended,h="true"===i.clReviewsProviderWithRecommendation,m=parseInt(i.clReviewsProviderSortDir||-1,10),c=parseInt(i.clReviewsProviderMinScore||-9999,10),g=parseInt(i.clReviewsProviderContentLengthLimit||9999,10),v=parseInt(i.clReviewsProviderLimit||0,10),y=parseInt(i.clReviewsProviderPage||1,10),b=parseInt(i.clReviewsProviderPageSize||10,10);function e(e){var n,t;p&&(e=A.filter(e,function(e){return!0===e.recommended})),h&&(e=A.filter(e,function(e){return!0===e.recommended||!1===e.recommended})),-9999!==c&&(e=A.filter(e,function(e){e=E(e,"sentiment.score");return e&&c<=e})),A.each(e,function(e){e.sentiment||(e.sentiment={score:0})}),s&&(n=s.split(","),e=A.filter(e,function(t){return A.each(n,function(e){if(!E(t,e))return!1}),!0})),e=A.filter(e,function(e){var t=e.comment&&e.comment.length<g,e=!0!==e.flagged;return t&&e}),e=A.map(e,function(e){var t=k.unix(e.created);return e.yearMonth=""+t.year()+t.month(),e.featured||(e.featured=!1),e}),r[o].reviews=e,t=function(){i.clDebug,r.clReviewsProviderReady=!0},_.user&&_.user.valid()&&i.clCourseId?S.userReviewForCourse({courseId:i.clCourseId,userId:_.user.get("_id")}).then(function(e){r[o].userReview=e&&e[0],t()}):t(),d(),a()}_.user&&_.user.valid()&&(n=_.$on("review:submitted",function(e,t){_.user.get("_id")===t.userId&&i.clCourseId===t.sourceId&&(r[o].userReviewSubmitted=!0,n())}),r.$on("$destroy",n)),r[o]={page:y,pageSize:b,hide:!1};var u=A.once(function(){w.getReviewsByCourseId(i.clCourseId,{sort:f,sortDir:m,limit:v}).then(e).catch(function(e){})}),l=A.once(function(){S.findByUserId(i.clUserId).then(e).catch(function(e){})})}}}t.exports=r},{moment:void 0}],841:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{review:"=reviewsReview",height:"@?clReviewHeight"},replace:!0,templateUrl:function(e,t){return t.clTemplate||"/templates/reviews/review.html"},link:function(e,t,n){e.height?e.heightCss="height: "+e.height+";overflow:hidden":e.heightCss="height:auto;"}}}]},{}],842:[function(e,t,n){"use strict";t.exports=["CourseService",function(l){return{restrict:"AE",scope:{},templateUrl:function(e,t){return t.clReviewsTemplate||"/templates/reviews/reviews.html"},link:function(t,u,e){var n=e.clReviewsTemplate&&e.clReviewsKey||"clReviews",r=e.$observe("clCourseId",function(){e.clCourseId&&!e.lazyLoadData&&l.getReviewsByCourseId(e.clCourseId,{sort:i,sortDir:o,limit:a}).then(function(e){t[n].reviews=e,t.clReviewsReady=!0,r()}).catch(function(e){})}),i=e.clSort||"created",o=parseInt(e.clReviewsSortDir||-1,10),a=parseInt(e.clReviewsLimit||0,10),s=parseInt(e.clReviewsPage||1,10),c=parseInt(e.clReviewsPageSize||10,10);t[n]={page:s,pageSize:c}}}}]},{}],843:[function(e,t,n){"use strict";t.exports=["_",function(s){return{restrict:"A",scope:{reviews:"<?clReviewStatsData",counts:"<?clReviewStatsCounts",hide:"=?clReviewStatsHide"},templateUrl:function(e,t){return t.clReviewStatsTemplate||"/templates/reviews/stats.html"},link:function(i,e,o){var a=o.clReviewStatsTemplate&&o.clReviewStatsKey||"clReviewStats",t=(i[a]={description:o.clReviewStatsDescription},i.$watch("reviews",function(){r(t)})),n=i.$watch("counts",function(){r(n)});function r(e){var t,n,r;(i.reviews&&i.reviews.length||i.counts&&(!i.counts||i.counts.recommended))&&(r=n=void 0,r=i.counts?(n={recommended:i.counts.recommended,notRecommended:i.counts.not_recommended},i.counts.reviewsPercent):(t=s.reject(i.reviews,function(e){return void 0===e.recommended}),n=s.countBy(t,function(e){return e.recommended?"recommended":"notRecommended"}),isNaN(n.recommended)&&(n.recommended=0),isNaN(n.notRecommended)&&(n.notRecommended=0),Math.round(n.recommended/t.length*100)),n.totalRatings=n.recommended+n.notRecommended,i[a].stats=n,i[a].recommendedPercentage=r,i[a].notRecommendedPercentage=100-r,(0===n.recommended||n.notRecommended>n.recommended)&&(i.hide=!0),o.clDebug,i[a].recommendedPercentage&&(i.clReviewStatsReady=!0),e())}}}}]},{}],844:[function(e,t,n){"use strict";t.exports=["$timeout","courseResource",function(r,i){return{restrict:"AE",scope:{slug:"@",review:"="},replace:!0,templateUrl:"/templates/reviews/submit.html",link:function(n,e,t){n.writeReview=function(){n.writingReview=!0,r(function(){e[0].querySelector("textarea").focus()})},n.submitReview=function(){i.submitReviewBySlug({slug:n.slug},{subject:"",comment:n.review},function(e,t){n.writingReview=!1})}}}}]},{}],845:[function(e,t,n){"use strict";var r=e("../../common/app");r.controller("reviewModalController",e("./controllers/modal")),r.service("ReviewModalService",e("./services/modal")),r.directive("clReviews",e("./directives/reviews")),r.directive("clReviewsProvider",e("./directives/provider")),r.directive("reviewsReview",e("./directives/review")),r.directive("reviewsIcon",e("./directives/icon")),r.directive("reviewSubmit",e("./directives/submit")),r.directive("clReviewStats",e("./directives/stats")),r.directive("reviewModalToggle",e("./directives/modal-toggle"))},{"../../common/app":70,"./controllers/modal":837,"./directives/icon":838,"./directives/modal-toggle":839,"./directives/provider":840,"./directives/review":841,"./directives/reviews":842,"./directives/stats":843,"./directives/submit":844,"./services/modal":846}],846:[function(e,t,n){"use strict";t.exports=["$rootScope","$uibModal","ReviewService","courseResource","trackFactory","cacheClear","keyboard",function(e,r,n,i,o,a,s){function t(e,t,n){this.set("source",e),this.set("counts",t),this.set("onSubmit",n)}return angular.extend(t.prototype,{source:void 0,counts:void 0,set:function(e,t){this[e]=t},toggleModal:function(){var t=this;if(!t.source)return!1;e.user.valid()&&n.userReviewForCourse({courseId:t.source._id,userId:e.user.get("_id")}).then(function(e){0===e.length?t.showReviewModal():t.showReviewModal(e[0])})},showReviewModal:function(e){s.disable();var t=this,n=r.open({templateUrl:"/templates/reviews/submit-modal.html",controller:"reviewModalController",resolve:{args:function(){return{resource:i,cacheClear:a,source:t.source,previousReview:e}}}});o.reviewModal(t.source,t.counts),n.result.then(function(){t.onModalDismiss()},function(){t.onModalDismiss()})},onModalDismiss:function(){s.enable(),"function"==typeof this.onSubmit&&this.onSubmit()}}),t}]},{}],847:[function(e,t,n){"use strict";var i=e("async");t.exports=["$rootScope","CatalogService","deepval","moment",function(n,a,e,s){return{restrict:"AE",scope:{},templateUrl:"/templates/rsvp-courses/index.html",link:function(o,e,t){o.displayedCourses=new DataSet,o.maxCourseCount=parseInt(t.maxCourseCount||0,10);var r=function(){};n.user.valid()&&n.user.recentInteractions&&n.user.recentInteractions({limit:o.maxCourseCount}).then(function(e){o.courses=e.courses;for(var t=0,n=new DataSet;t<o.courses.length;)"upcoming-event"!==o.courses[t].type&&"live-now"!==o.courses[t].type||n.addToSet(o.courses[t],"_id"),t++;i.series([function(e){i.each(n,function(e,t){var r,i;r=e,i=function(){t()},a.getCourseByProduct(r.product._id).then(function(e){if(r.end_time<s().unix())return i();e.eventId=r._id;var e=angular.extend(r,e),t=e.flagged&&!0===e.flagged.on_calendar,n=void 0!==e.type;(t||n)&&o.displayedCourses.addToSet(e),i()},i)},e)},function(e){o.displayedCourses.sort(function(e,t){var e=s.unix(e.start_time),t=s.unix(t.start_time),n=s.unix();return e.diff(n,"days")<0&&(e=n),t.diff(n,"days")<0&&(t=n),e.diff(t,"days")}),_.each(o.displayedCourses,function(e){e.rsvp=!0}),e()}],r)})}}}]},{async:21}],848:[function(e,t,n){"use strict";e("../../common/app").directive("rsvpCourses",e("./directives/index"))},{"../../common/app":70,"./directives/index":847}],849:[function(e,t,n){"use strict";e("../../common/app").service("savedSearchPicker",e("./savedSearchPickerService"))},{"../../common/app":70,"./savedSearchPickerService":850}],850:[function(e,t,n){"use strict";t.exports=["$uibModal","SavedSearchService",function(e,n){return function(){return e.open({templateUrl:"/templates/saved-search-picker/main.html",controller:["$scope","$uibModalInstance",function(t,e){n.get({select:"_id"}).then(function(e){t.searches=e}),angular.extend(t,{selected:null,selectSearch:function(e){t.selected!==e?t.selected=e:t.selected=null}})}]})}}]},{}],851:[function(e,t,n){"use strict";e("../../common/app").directive("savedSearchProvider",e("./provider"))},{"../../common/app":70,"./provider":852}],852:[function(e,t,n){"use strict";t.exports=["SavedSearchService",function(o){return{restrict:"A",link:function(t,e,n){var r=[];function i(){o.getById(n.clSavedSearchId).then(function(e){t[n.clSavedSearchKey||"savedSearch"]=e,n.searchContent&&o.getContentById(n.clSavedSearchId).then(function(e){t[n.clSavedSearchContentKey||"savedSearchContent"]=e,!0!==n.watch&&angular.forEach(r,function(e){e()})})})}angular.forEach(["clSavedSearchId"],function(e){e=n.$observe(e,i);r.push(e)})}}}]},{}],853:[function(e,t,n){"use strict";t.exports=["$q","SavedSearchService",function(n,r){return{restrict:"EA",scope:{id:"<?savedSearchId"},templateUrl:"/templates/saved-search-snapshot/main.html",controllerAs:"ctrl",controller:["$scope",function(e){var t=this,e=e.id;e&&n.all({savedSearch:r.getById(e),content:r.getContentById(e)}).then(function(e){t.savedSearch=e.savedSearch,t.content=e.content})}]}}]},{}],854:[function(e,t,n){"use strict";e("../../common/app").directive("savedSearchSnapshot",e("./directive"))},{"../../common/app":70,"./directive":853}],855:[function(e,t,n){"use strict";t.exports=["$window","$location","$document","$timeout","$anchorScroll","ScrollSpy","$rootScope",function(g,v,y,b,e,_,w,t){return{restrict:"A",link:function(l,t,n){if("A"===t[0].nodeName&&!n.href)throw new Error('[scrollToAnchor] scroll-to-anchor directive on an <a> element requires an "href" attribute');if("A"!==t[0].nodeName){if(n.href)throw new Error('[scrollToAnchor] "href" attribute should only be used on an <a> element. Please use "scroll-target" instead');if(void 0===n.scrollTarget)throw new Error('[scrollToAnchor] scroll-to-anchor directive requires a "scroll-target" attribute')}var r,i,e=v.$$html5||"true"===n.html5,o=g.location.hash,a=n.href||n.scrollTarget,o=g.location.href.replace(o,"")+(e?"":"#")+a,d="false"!==n.clSetLocation,f=parseInt(n.clOffset||0,10),s=0,p=parseInt(n.clTransitionTime||300,10),c=n.clParent?y.find(n.clParent):y,u=n.clQuerySelector;function h(t){t=t||angular.noop,b(function(){var e=c.find(u);e&&(r=angular.element(e)),t()})}function m(){var e;n.clOffsetElement&&(!(e=document.querySelector(n.clOffsetElement))||(e=e.getBoundingClientRect())&&e.height&&(s=e.height))}n.href&&t.attr("href",o),!a||(i=a.replace("#",""))&&(u="#"+i),h(function(){n.clScrollSpy&&u&&(_.setBounds(u),_.on(u,function(){var e=_.elementInView(u);!0===e?t.addClass("cl-scrollspy-in-view"):!1===e&&t.removeClass("cl-scrollspy-in-view")}),_.onResize(function(){m(),h()})),m(),e&&t.bind("click",function(e){e.preventDefault(),e.stopPropagation(),n.propagateId&&$(n.propagateId).click();e=(c=n.clParent?y.find(n.clParent):y).find(u),e&&(r=angular.element(e)),e=s+f;u?(r&&(w.$emit("scroll:to:anchor",{target:r,element:t}),c.scrollToElement(r,e,p)),d&&v.hash(i)):(c.scrollTo(0,e,p),v.hash(""),g.history.pushState({},document.title,v.path()))})})}}}]},{}],856:[function(e,t,n){"use strict";e("../../common/app").directive("scrollToAnchor",e("./directive"))},{"../../common/app":70,"./directive":855}],857:[function(e,t,n){"use strict";t.exports=["$document",function(){return{restrict:"AE",replace:!0,templateUrl:"/templates/scrollbar/view.html",scope:{containerId:"@",container:"=?"},controller:["$scope","$document","$element","$timeout",function(e,t,n,l){var d,r,f,p,i=n[0],h=n[0].querySelector(".scrollbar-thumb"),m=t[0].querySelector("body"),g=n[0].querySelector(".gradient-bottom"),v=n[0].querySelector(".gradient-top"),o=0,a=(e.containerId&&(e.container=angular.element(t[0].querySelector("#"+e.containerId))),e.container[0]),y=(e.container.addClass("scrollbar-container"),a.children);function b(){l.cancel(b),r=parseInt(getComputedStyle(a).height,10),f=parseInt(getComputedStyle(y[0]).height,10),r<=(d=r*(p=r/f))?(s(i,"disabled"),s(a,"no-scrollbar")):(c(i,"disabled"),c(a,"no-scrollbar")),h.style.height=d+"px",u(0)}function s(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function c(e,t){e.classList?e.classList.remove(t):e.className=i.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function u(e){a.scrollTop+=e;e=parseInt(a.scrollTop*p);h.style.top=e+"px",(e<=0?c:s)(v,"active"),(r-10<=e+d?c:s)(g,"active")}function _(e){var t,e=e.y||e.clientY;o?(t=e-o,o=e,u(t/p)):o=e}function w(){b(),u(0)}l(b,100),e.container.bind("wheel",function(e){i.classList.contains("disabled")||(e.stopPropagation(),e.preventDefault(),u(e.originalEvent.deltaY))}),h.addEventListener("mousedown",function(){t[0].addEventListener("mousemove",_),s(i,"active"),s(m,"noselect")}),t[0].addEventListener("mouseup",function(){t[0].removeEventListener("mousemove",_),o=0,c(i,"active"),c(m,"noselect")}),window.addEventListener("resize",function(){w()}),e.$on("video:scrollbar:refresh",function(){w()}),e.$on("video:queue",function(e,t){l(function(){var e,t,n=a.querySelector(".playing");n&&(e=n.getBoundingClientRect(),t=a.getBoundingClientRect(),(e.bottom>=t.bottom||e.top<=t.top)&&(a.scrollTop=n.offsetTop-50,u(0)))},100)})}]}}]},{}],858:[function(e,t,n){"use strict";e("../../common/app").directive("clScrollbar",e("./directives/index"))},{"../../common/app":70,"./directives/index":857}],859:[function(e,t,n){"use strict";var E=e("underscore"),A=e("async"),k=e("node-uuid");t.exports=["CatalogService","InstructorSearchService","TopicService","SearchAnalyticsService","$document","$window","$filter","$timeout","$q",function(h,m,g,v,y,b,_,w,S,e){return{restrict:"AE",replace:!0,templateUrl:"/templates/search-autocomplete/dropdown.html",scope:{query:"=",searchFocus:"=",onSearchInput:"=?",inputId:"@"},link:function(c,e,n){var o,a=3,t="/catalog",i="/class/",s="/bundle/";function r(i,e){i!==e&&(i&&3<=i.length?(c.keyboardNavigation.splice(0,c.keyboardNavigation.length),c.url=t+"?q="+i,A.parallel({courseResult:function(n){!function(n){var r=S.defer();n&&h.searchAutocomplete({text:n,q:n,limit:a}).then(function(e){var t=e.courses;t&&t.length<3?h.searchAutocomplete({text:n,q:n,against:["description"]}).then(function(e){c.courses=E.union(t,e.courses),r.resolve({courses:c.courses,metadata:e.metadata})}):c.courses=t,c.selectedItem=-1,r.resolve({courses:c.courses,metadata:e.metadata})},r.reject);return r.promise}(i).then(function(e){var t=e.courses;t&&(t&&(t.length>a&&t.splice(a),u(t,!0)),c.instructors=m.getInstructors(i,t),u(c.instructors,!0)),n(null,e)},function(){n()})},topics:function(r){g.search(i).then(function(e){c.categories=(t=e,n={},t=E.filter(e,function(e){return!e.archive}),E.each(t,function(e){var t=e.taxonomy.category;"other"===t||(n[t]?n[t].topics.push(e):n[t]={title:t,topics:[e]})}),Object.values(n));var t,n,e=E.chain(c.categories).pluck("topics").flatten().value();u(e),r(null,e)},function(){r()})}},function(e,t){var n=t.courseResult||{},t=t.topics,r=n.metadata||{};r.searchId=r.searchId||k.v4(),c.currentSearchId=r.searchId,o(i,n.courses,r,t),f()}),c.inputId===document.activeElement.id&&(c.searchFocus=!0)):(c.courses=[],c.channels=[],c.instructors=[],c.columns=0))}function u(e,t){c.keyboardNavigation=t?E.union(e,c.keyboardNavigation):E.union(c.keyboardNavigation,e),c.keyboardNavigation=E.flatten(c.keyboardNavigation)}function l(e){return e&&"bundle"===e.content_type}function d(e,t,n,r,i){var o=e.shiftKey||e.ctrlKey||e.metaKey,a=(o||e.preventDefault(),e.currentTarget.innerText),s=(angular.isString(a)&&(a=a.replace(/\n/g," "),angular.isFunction(a.trim)&&(a=a.trim())),{search_id:c.currentSearchId,index:r,search_rank:r+1,cta_label:a});switch(t){case"catalog":l(n)?(s.bundle_bid=n.nid,s.bundle_id=n._id):(s.course_cid=n.nid,s.course_id=n._id);break;case"topic":s.result_page_path=n.path;case"instructor":s.instructor_id=n._id}v.trackSearch("searchComplete",s,function(){o||(b.location.href=i||e.currentTarget.href)})}function f(){c.columns=0,E.each(["courses","categories","instructors"],function(e){c[e]&&c[e].length&&c.columns++})}function p(e){if(c.searchFocus)switch(r(!0),e.keyCode){case 40:e.preventDefault(),c.selectedItem++,c.selectedItem>=c.keyboardNavigation.length&&(c.endOfList=!0,c.selectedItem=c.keyboardNavigation.length),r();break;case 38:e.preventDefault(),c.endOfList=!1,c.selectedItem--,c.selectedItem<0&&(c.selectedItem=-1),r();break;case 13:if(-1===c.selectedItem)return;if(e.preventDefault(),c.selectedItem===c.keyboardNavigation.length)return void c.onSearchInput(e,"submit");var t,n=c.keyboardNavigation[c.selectedItem];n&&(n.slug?(t=l(n)?s:i,d(e,"catalog",n,c.selectedItem,t+n.slug)):n.path&&d(e,"topic",n,c.selectedItem-a,n.path))}function r(e){var t=c.keyboardNavigation[c.selectedItem];t&&(t.active=!e)}}angular.extend(c,{updateQuery:function(e){c.query=e,w(function(){$("#"+c.inputId).focus()},1)},selectedItem:-1,keyboardNavigation:[],popularSearches:[_("i18n")("search-autcomplete-popular-search-1","Lightroom"),_("i18n")("search-autcomplete-popular-search-2","Wedding Photography"),_("i18n")("search-autcomplete-popular-search-3","Marketing"),_("i18n")("search-autcomplete-popular-search-4","Illustrator"),_("i18n")("search-autcomplete-popular-search-5","Etsy"),_("i18n")("search-autcomplete-popular-search-6","Fundamentals")],currentSearchId:null,onClickResult:d,columns:0}),o=E.debounce(v.trackSearchStart,500),c.$watch("query",E.debounce(r,100)),c.$watch("courses",function(e){e&&(c.instructors=m.getInstructors(c.query,e),f())}),y.keydown(p)}}}]},{async:21,"node-uuid":50,underscore:void 0}],860:[function(e,t,n){"use strict";function r(s,c,n){return{restrict:"AE",replace:!0,templateUrl:"/templates/search-autocomplete/view.html",scope:{prequery:"=?",onSearchInput:"=?",displayClose:"=?",focusInput:"=?",value:"@",useSubmitBtn:"@",inputClass:"@",inputId:"@",appliedClass:"@",subscriptionViewActive:"<?",showSearchButton:"<?"},link:function(i,o,e){var a,t=!1;e.inputId||(e.inputId="q"),i.subscriptionViewActive||(i.subscriptionViewActive=!1),angular.extend(i,{onFocus:function(e){i.focusInput=!0,i.onSearchInput(e,"focus"),c.disable(),t||(n.init(),t=!0);s.cancel(a),rind.context.ua.mobile&&window.scrollTo(0,o[0].getBoundingClientRect().top-10)},clearSearch:function(e){i.prequery="",i.displayClose=!1,i.onSearchInput(e,"clear")},search:function(e,t){t?i.onSearchInput(e,"submit"):angular.element.find("form")[0].submit()},focusInput:!1}),i.$on("CatalogSearch:submit",function(e,t){i.focusInput=!1}),$(document.body).mousedown(function(e){var t=$(e.target).hasClass("fa-search")||$(e.target).parent().hasClass("fa-search"),n=$(e.target).hasClass("icon-search")||$(e.target).parent().hasClass("icon-search"),r=e.target.ownerSVGElement&&$(e.target.ownerSVGElement).parent().hasClass("icon-search");$.contains(o[0],e.target)||t||n||r?i.focusInput=!0:function(e){i.onSearchInput(e,"blur"),i.focusInput&&c.enable();i.focusInput=!1,a=s(function(){i.displayClose=!1},300)}(e)})}}}r.$inject=["$timeout","keyboard","InstructorSearchService"],t.exports=r},{}],861:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clSearchAutocomplete",e("./directives/index")),r.directive("clSearchAutocompleteDropdown",e("./directives/dropdown")),r.service("InstructorSearchService",e("./services/instructorSearchService")),r.service("SearchAnalyticsService",e("./services/searchAnalyticsService"))},{"../../common/app":70,"./directives/dropdown":859,"./directives/index":860,"./services/instructorSearchService":862,"./services/searchAnalyticsService":863}],862:[function(e,t,n){"use strict";t.exports=["$q","InstructorService",function(e,t){var o;return{init:function(){t.getInstructors().then(function(e){o=[],_.each(e,function(e){o.push({_id:e._id,profile:e.profile,slug:e.slug})})})},getInstructors:function(e,t){var n=[],t=(t=function(e){var r,i=[];return _.each(e,function(n){_.each(n.instructors,function(e){var t;(r=_.findWhere(i,{_id:e._id}))?r.popularity=r.popularity+n.popularity:(t=_.findWhere(o,{_id:e._id}))&&t.profile&&i.push({_id:e._id,name:e.name,slug:e.slug,profile:t.profile,popularity:n.popularity})})}),i.sort(function(e,t){return t.popularity-e.popularity}),i}(t),e=function(e){var t,n=[],r="";return e=e.split(" "),_.each(e,function(e){r+="(?=.*"+_.escape(e)+")"}),t=new RegExp(r,"i"),_.each(o,function(e){t.test(e.profile.name)&&n.push(e)}),n}(e),_.union(t,e));return _.each(t,function(e){_.findWhere(n,{_id:e._id})||n.push({_id:e._id,name:e.name||e.profile&&e.profile.name||"",profile:e.profile,slug:e.slug})}),n}}}]},{}],863:[function(e,t,n){"use strict";t.exports=["trackFactory",function(r){return{trackSearch:i,trackSearchStart:function(e,t,n,r){n=n||{},t=_.map(t,function(e){return e._id}),r=_.map(r,function(e){return e.path}),n={search_id:n.searchId,search_version:n.version||"",top_course_ids:t,top_page_paths:r,num_results:t.length};n.query=e,i("searchStart",n,null)}};function i(e,t,n){r.catalog(e,_.extend({src:"autocomplete",cta_location:1,cta_module:"searchbar",cta_type:"searchbar"},t),{},n)}}]},{}],864:[function(e,t,n){"use strict";t.exports=["courseResource","videoPlayerFactory",function(o,a){return{restrict:"E",scope:{course:"="},templateUrl:"/templates/segment/index.html",replace:!0,link:function(t,e,n){var r=t.$watch("course",function(e){e&&(o.findById({id:t.course._id},function(e){e=e&&e.data||e;t.course=e,t.videoPlayer=a.getVideoPlayer(t.course._id),t.videoPlayer.segments.getCourseToken(t.course.slug,i)}),r())});function i(){t.segments=t.videoPlayer.segments.getSegments(t.course),t.segments=t.videoPlayer.segments.setMediaPermission(t.segments),t.currentSegment=t.videoPlayer.segments.currentSegment}},controller:["$scope",function(n){angular.extend(n,{play:function(e){n.videoPlayer.segments.play(e)},isVideo:function(e){n.videoPlayer.segments.isVideo(e)}}),n.$on("video:queue",function(e,t){t=t.segment||{};n.currentSegment=t})}]}}]},{}],865:[function(e,t,n){"use strict";t.exports=["CatalogService","ContentAccessService","trackFactory","config",function(i,o,a,s){return{restrict:"E",scope:{segments:"=",currentSegment:"=",onPlay:"&",onDownload:"&",courseId:"="},templateUrl:function(e,t){return t.template?"/templates/segment/"+t.template+".html":"/templates/segment/list.html"},replace:!0,link:function(r,e,t){angular.extend(r,{showSegmentTitle:"false"!==t.showSegmentTitle,isVideo:function(e){try{return null!==e.media[0].type.match(/(hd|low|mp4|video)/i)}catch(e){return!1}},videoIcon:function(e){return"Low"!==e.type?'<span class="text-uppercase pad-left-m pad-right-m">hd <i class="fa fa-download"></i></span><span class="strong"></span>':'<span class="pad-left-m pad-right-m"><i class="fa fa-download"></i></span>'},fileIcon:function(e){e=c[e.type];return e?"fa-file-"+e+"-o":"fa-file-o"},showTranscript:s.showTranscriptPages,play:r.onPlay(),download:r.onDownload(),enableDownload:!1}),angular.forEach(r.segments,function(e){var t;!e.title||1<(t=e.title.split(" with ")).length&&(e.mainTitle=t[0],e.subtitle="with "+t[1])}),"downloads"===t.template?o("course",r.courseId).then(function(e){r.enableDownload=!e.streamOnly&&(e.owned||!e.subscribed)}):r.enableDownload=!0;var n=r.$watch("courseId",function(e){e&&(i.getCourseById(e).then(function(e){r.course=e}),n())});r.downloadItem=function(e,t,n){e.preventDefault(),e.stopPropagation(),r.enableDownload&&t&&t.permission&&(a.downloadItem(n,t,r.courseId),r.download(t))}}}}];var c={pdf:"pdf",zip:"zip",doc:"word",docx:"word",xls:"excel",numbers:"excel",ppt:"powerpoint",txt:"text",mp3:"sound",gif:"image",jpg:"image",png:"image",svg:"image",html:"code",js:"code",css:"code",HD:"video",Low:"video"}},{}],866:[function(e,t,n){"use strict";r.$inject=["CatalogService"];var u=e("underscore");function r(c){return{restrict:"A",link:function(t,e,n){var r=[],i=(angular.forEach(["clCourseId","clSegmentId"],function(e){e=n.$observe(e,o);r.push(e)}),n.clSegmentProviderKey||n.clSegmentKey||"clSegment");function o(){n.clSegmentId&&n.clCourseId&&c.getCourseById(n.clCourseId,{keys:["sessions"]},{}).then(a).catch(s)}function a(e){segments=u.chain(e.sessions).pluck("segments").flatten().flatten().value()}function s(e){t[i]={clSegmentProviderError:!0,error:e}}}}}t.exports=r},{underscore:void 0}],867:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("segmentLesson",e("./directives/lesson")),r.directive("segmentList",e("./directives/list")),r.directive("clSegmentProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/lesson":864,"./directives/list":865,"./directives/provider":866}],868:[function(e,t,n){"use strict";t.exports=["$sce","config","BannerService",function(r,i,o){return{restrict:"AE",scope:{data:"=?"},template:'<div ng-show="banner" class="col-sm-12 header-banner font-family-brand" ng-bind-html="banner"></div>',replace:!0,link:function(t,e,n){t.config=i,t.data||(t.data=t.$parent.data),o.getAll().then(function(e){e=e&&e.banner;e&&(t.banner=r.trustAsHtml(e))})}}}]},{}],869:[function(e,t,n){"use strict";e("../../common/app").directive("siteBanner",e("./directives/view"))},{"../../common/app":70,"./directives/view":868}],870:[function(e,t,n){"use strict";e("../../common/app").component("ssoSamlIntegration",e("./ssoSamlIntegration"))},{"../../common/app":70,"./ssoSamlIntegration":871}],871:[function(e,t,n){"use strict";t.exports={template:'\n    <div class="enterprise-saml-sso-integration">\n      <button \n        class="btn btn-primary" \n        ng-disabled="$ctrl.inProgress || $ctrl.disableUntilReload || $root.user.valid()" \n        ng-click="$ctrl.initiateServiceProviderLogin()"\n      >\n        <span ng-hide="$ctrl.inProgress || $root.user.valid()" ng-transclude></span>\n        <span ng-show="$ctrl.inProgress"><i class="fa fa-spinner"></i></span>\n        <span ng-show="$root.user.valid()">You\'re all set!</span>\n      </button>\n      <div \n        class="error-message-container font-weight-thin font-size-sm margin-top-xl" \n        style="color: red;" \n        ng-show="$ctrl.errorMessage" \n        ng-bind="$ctrl.errorMessage"></div>\n    </div>',transclude:!0,bindings:{clAccountName:"@"},controller:["EnterpriseService","SAMLSSOService",function(e,t){var n=this;this.errorMessage=null,this.disableUntilReload=!1,this.inProgress=!1;this.initiateServiceProviderLogin=function(){return n.inProgress=!0,e.getByName(n.clAccountName).then(function(e){return(e=e)&&e.integrations&&e.integrations.saml&&e.integrations.saml.entityId}).then(function(e){if(!e)throw n.disableUntilReload=!0,new Error("This account is not configured for SAML SSO authentication. Please contact your account administrator.");return t.initiateServiceProviderLogin(e)}).then(function(e){var t;if(!e)throw(t=new Error("Error handling identity provider info.")).useDefaultMessage=!0,t;n.inProgress=!1,window.location.href=e}).catch(function(e){n.inProgress=!1;n.errorMessage=e&&e.useDefaultMessage?"There was a problem with the login process. Please contact your login provider":e&&e.message})},this.assertSignedResponse=function(){}}]}},{}],872:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/student-snapshot/cms-view.html",scope:{data:"=?"},controllerAs:"studentSnapshotCtrl",controller:["$scope","$attrs",function(e,t){this.data=e.data||e.$parent.data||{},e.isAdmin="true"===t.isAdmin}]}}]},{}],873:[function(e,t,n){"use strict";var u=e("deepval"),l=e("async");t.exports=["$rootScope","DataSet","EventService",function(s,r,c){return{restrict:"AE",templateUrl:"/templates/student-snapshot/index.html",controllerAs:"StudentSnapshotCtrl",controller:["$scope",function(e){var n=this,t=new r;function i(e){e.short_title||(e.short_title=u(e,"swimlanes.0.broadcasts.0.meta.short_title")),e.instructors||(e.instructors=u(e,"swimlanes.0.broadcasts.0.meta.instructors")),t.addToSet(e,"_id")}function o(t){n.selectedCourse=_.find(n.courses,function(e){return e._id===t})}function a(e){e&&o(e._id),n.selectedCourse&&(_.each(n.courses,function(e){e.selected=!1}),n.selectedCourse.selected=!0,n.view=n.selectedCourse.type)}angular.extend(n,{onSelect:a,hasCourses:!0,courses:new r}),s.user.valid()&&s.user.recentInteractions&&s.user.recentInteractions().then(function(e){var r;l.each(e.courses,function(t,n){t.swimlanes?c.getEventUIData(t).then(function(e){e.type=t.type,r||!t.live||s.user.hasContent("purchased","course",e._id)||(r=e._id),i(e),n()},function(){n()}):(i(t),n())},function(){n.courses=t,r||n.courses.length?(o(r||n.courses[0]._id),a()):n.hasCourses=!1})})}]}}]},{async:21,deepval:38}],874:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clStudentSnapshot",e("./directives/index")),r.directive("studentSnapshotCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/view":872,"./directives/index":873}],875:[function(e,t,n){"use strict";var c=e("async");t.exports=["galleryImage","user","arrayMove",function(i,o,s){return{restrict:"AE",scope:{},templateUrl:"/templates/student-work/edit.html",replace:!0,link:function(a,e,t){a.data=a.$parent.data,a.data.slides||(a.data.slides=[]),a.addImage=function(n){a.errorAddingImage=!1;var r={};c.series({getImage:function(t){i.findByIdWithImage({id:n},function(e){if(!e.success)return t(new Error("Error getting image data for: "+n));r.image=e.data[0]||e.data,t(null)})},getUserProfile:function(t){if(!r.image.owner||!r.image.owner.slug)return t(null);o.getBySlug({slug:r.image.owner.slug},function(e){if(!e.success)return t(new Error("Error getting user data for: "+r.image.owner.slug));r.profile=e.data.profile,t(null)})}},function(e){e&&(a.errorAddingImage=!0),r.image&&a.data.slides.push(r),a.imageId=""})},a.removeImage=function(e){a.data.slides.splice(e,1)},a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{async:21}],876:[function(e,t,n){"use strict";t.exports=["config",function(r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/student-work/view.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data)}}}]},{}],877:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("studentWork",e("./directives/view")),r.directive("studentWorkEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":875,"./directives/view":876}],878:[function(e,t,n){"use strict";t.exports=["$rootScope",function(n){n.$on("gallery:action",function(e,t){n.$broadcast("clGalleryProvider:init",!0)})}]},{}],879:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/student/student-card.html",scope:{studentId:"<?",studentSlug:"<?",tipDirection:"<?",onClickFunc:"<"},replace:!0,link:function(t,n,e){function r(e){t.clickedOutside=!$.contains(n[0],e.target),t.onClickFunc(t.clickedOutside)}$(document.body).mousedown(r),t.$on("$destroy",function(){$(document.body).off("mousedown",r)})}}}]},{}],880:[function(e,t,n){"use strict";var r=e("../../common/app");document.location.pathname.match(/^\/settings/)&&r.config(["$routeProvider","$locationProvider",function(e,t){e.when("/settings",{}),t.html5Mode(!0)}]),r.directive("clStudentProvider",e("./provider")),r.directive("clStudentCard",e("./directives/student-card")),r.controller("clProfileController",e("./controllers/profile"))},{"../../common/app":70,"./controllers/profile":878,"./directives/student-card":879,"./provider":881}],881:[function(e,t,n){"use strict";function r(s,c,u,l,d,f){return{restrict:"A",link:function(t,e,n){var r=n.clStudentProviderKey||"clStudentData",i=!!(f&&f.context&&f.context.ua&&f.context.ua.mobile);function o(e){t[r]=e,t[r].profileDataReady=!0,t[r].isMobile=i&&u.screen.width<=768,"true"===n.clPopulateFollows&&s.getFollows(t[r].user._id).then(function(e){t[r].followsData=e}),"true"===n.clGetStats&&s.getStats(t[r].user._id,{watchedProgress:!0}).then(function(e){e.totalTimeInSeconds&&(e.totalTimeInMinutes=Math.round(l.duration(e.totalTimeInSeconds,"seconds").asMinutes())),t[r].statsData=e}),"true"===n.clGetStatus&&t[r].user.primary_email.address.match(/[A-Za-z0-9._%+-]+(@creativelive)+\.com/g)&&(t[r].status="employee"),n.clDebug}function a(e){e=function(e){if(c.routeParams.hash&&f.context.isEmailHashValid)return{email:d.Cookie.get("iterableEndUserId")};return e}({clStudentProviderError:!0,error:e});(t[r]=e).clStudentProviderError}c.routeParams.hash&&f.context.isEmailHashValid?a("email hash is valid"):(n.clStudentId?s.findById(n.clStudentId):s.findBySlug(n.clStudentSlug)).then(o).catch(a)}}}r.$inject=["StudentService","$rootScope","$window","moment","Vault","rind"],t.exports=r},{}],882:[function(e,t,n){"use strict";t.exports=function(){return{templateUrl:"/templates/subscription-admin-menu-item/main.html",replace:!0,transclude:!0,controllerAs:"$ctrl",controller:["Vault",function(t){angular.extend(this,{isAdmin:!1,href:"/enterprise/admin",text:"",$onInit:function(){var e=t.Local.get("session");if(e){try{e=JSON.parse(atob(e.split(".")[1].replace("-","+").replace("_","/")))}catch(e){}this.isAdmin=e.data&&e.data.adminSubscriptions&&0<e.data.adminSubscriptions.length}}})}]}}},{}],883:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionAdminMenuItem",e("./directive"))},{"../../common/app":70,"./directive":882}],884:[function(e,t,n){"use strict";t.exports=["SubscriptionService","IntegrationsService","moment","_",function(o,n,a,s){return{scope:{id:"@?subscriptionId"},templateUrl:"/templates/subscription-eligibility/main.html",transclude:{heading:"heading",check:"check",pending:"pending",approved:"approved",rejected:"rejected"},controllerAs:"ctrl",controller:["$scope",function(e){var r=this,i=e.id;function t(e,t){var n={};angular.forEach(e,function(e,t){e&&e.$modelValue&&(n[t]="dateOfBirth"===t?a(e.$modelValue).format("YYYY-MM-DD"):"organizationId"===t?e.$modelValue.id:e.$modelValue)}),o.hasEligibility(i,null,n,t).then(function(e){"qualified"===e.status?r.status="approved":"unqualified"===e.status?r.status="rejected":"pending"===e.status?r.status="pending":"n/a"===e.state?r.status="":r.state="unknown"})}i&&(t({},!0),angular.extend(r,{subscriptionUrl:"",checkEligibility:t,findUniversity:s.throttle(function(e){return n.findUniversity(e).then(function(e){return e})},300)}))}]}}]},{}],885:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionEligibility",e("./directive"))},{"../../common/app":70,"./directive":884}],886:[function(e,t,n){"use strict";var h=e("@creativelive/vault.js");t.exports=["$rootScope","parseQS","SubscriptionService","trackFactory","$routeParams","$window","getUserId",function(c,e,u,l,d,f,p){return{scope:{id:"@?subscriptionId",slug:"@?subscriptionSlug"},templateUrl:"/templates/subscription-invitation/main.html",controllerAs:"ctrl",controller:["$scope",function(e){var t=this,n=!1,r=e.id,e=e.slug;function i(){t.pleaseWait=!1,f.location.href="/"}function o(){t.displayError=!0}function a(){var e=c.user.get("_id")||p()||null;e?u.getSubscriptionSeat(r,e).then(function(e){(t.seat=e)&&e.state&&"active"===e.state&&!c.user.valid()&&(c.$on("user:login",i),t.showLoginButton=!0,c.$broadcast("login:show"))}).catch(function(e){o()}):o()}function s(){t.pleaseWait=!0;var e=c.user.get("_id")||p()||null;u.activateSeat(r,e).then(function(){c.user.Auth.logout()}).catch(function(){t.pleaseWait=!1,o()})}(r||e)&&(angular.extend(t,{start:function(){n||(n=!0,l.signUpStart({account_type:"subscription",subscription_id:r}))},completeWithUpdate:function(){l.signUpComplete({account_type:"subscription",subscription_id:r}),function(){t.pleaseWait=!0;var e=c.user.get("_id")||p()||null;u.activateSeat(r,e).then(function(){i()}).catch(function(){t.pleaseWait=!1,o()})}()},activate:s,email:h.Cookie.get("iterableEndUserId"),hash:d.hash||(c.routeParams||{}).hash,awaitingReset:!1,displayError:!1,subscriptionUrl:"",seat:{},showLoginButton:!1,pleaseWait:!1}),!r&&e?u.getSubscriptionBySlug(e).then(function(e){r=e._id,a()}):a(),c.user&&c.user.Auth&&c.user.Auth.resetPasswordStatus(t.email,t.hash).then(function(e){t.awaitingReset=e,c.user.valid()||(!e&&t.seat&&"active"===t.seat.state?(t.showLoginButton=!0,c.$on("user:login",i),c.$broadcast("login:show","enterprise")):!e&&t.seat&&"invited"===t.seat.state&&s())}).catch(function(){o()}))}]}}]},{"@creativelive/vault.js":6}],887:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionInvitation",e("./directive"))},{"../../common/app":70,"./directive":886}],888:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionProvider",e("./provider"))},{"../../common/app":70,"./provider":889}],889:[function(e,t,n){"use strict";function r(c){return{restrict:"A",link:function(r,e,i){var o=[],a={};function t(){i.clSubscriptionId?c.getSubscriptionById(i.clSubscriptionId).then(n).catch(s):i.clSubscriptionSlug?c.getSubscriptionBySlug(i.clSubscriptionSlug).then(n).catch(s):i.clSubscriptionUser?c.getSubscriptionsByUser({userId:i.clSubscriptionUser,unverified:"true"===i.clSubscriptionUnverified,inactive:"true"===i.clSubscriptionInactive},"true"===i.clSubscriptionDetailed).then(n).catch(s):i.clSubscriptionUserContent?c.getSubscriptionContentByUser().then(n).catch(s):s()}function s(){r.subscriptionProviderReady=!0}function n(e){angular.forEach(e,function(e){e&&e.subscriptionPlan?a[e.subscriptionPlan.slug]=e:e&&e.slug&&(a[e.slug]=e)});var t=i.clSubscriptionKey,n=(t=t||(i.clSubscriptionId||i.clSubscriptionSlug?"subscription":i.clSubscriptionUserContent?"subscriptionUserContent":"subscriptions"))+"BySlug";r[t]=e,r[n]=a,s(),!0!==i.watch&&angular.forEach(o,function(e){e()})}angular.forEach(["clSubscriptionId","clSubscriptionSlug","clSubscriptionUser","clSubscriptionUserContent"],function(e){o.push(i.$observe(e,t))})}}}r.$inject=["SubscriptionService"],t.exports=r},{}],890:[function(e,t,n){"use strict";var D=e("papaparse"),N=e("moment");t.exports=["$rootScope","$http","$q","$window","$parse","$routeParams","$location","$uibModal","$sce","SubscriptionService","EnterpriseService","AnalyticsService","ScheduledEmailService","$filter","ugcImagePath","responseUtils","deepval","$timeout","keyboard","_",function(v,C,y,b,I,x,P,_,M,w,S,E,O,e,R,t,A,j,k,T){return{restrict:"E",scope:{subscriptionId:"@?",subscriptionSlug:"@?",actionCallbacks:"<?",userUrlBase:"@?",userUrlId:"@?",enableTotalUsage:"@?"},transclude:{addSeat:"?addSeat"},templateUrl:"/templates/subscription-seat-management/view.html",controllerAs:"ctrl",controller:["$scope","$transclude",function(n,e){var a=this,s=n.subscriptionId,c=n.subscriptionSlug;function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=null;s?t=y.all({subscription:w.getSubscriptionById(s),seats:w.getSubscriptionSeatsWithUsage(s,e)}):c&&(t=w.getSubscriptionBySlug(c).then(function(t){return s=t._id,w.getSubscriptionSeatsWithUsage(s,e).then(function(e){return{subscription:t,seats:e}})})),t.then(function(e){if(e)return e.subscription&&!e.subscription.status&&angular.extend(a.subscription,e.subscription),e.seats&&!e.seats.status&&(e.seats||[]).forEach(function(t){t.latestInteraction&&(t.latestInteractionFormatted=N.unix(t.latestInteraction).fromNow()),"invited"===t.state?O.getScheduledEmailBySeat(t._id).then(function(e){e&&e[0]&&"scheduled"===e[0].status&&(e=N.unix(e[0].sendAt).format("LLL"),t.invite=e),a.seats[t._id]=t}).catch(function(e){a.seats[t._id]=t}):a.seats[t._id]=t}),S.getEnterpriseProductById(a.subscription.plan)}).then(function(e){if(e)return angular.extend(a.enterpriseProduct,e),S.getFromSubscription(s)}).then(function(e){e&&(angular.extend(a.enterpriseAccount,e),angular.isFunction(a.actionCallbacks.init)&&a.actionCallbacks.init())}).catch(function(e){angular.isFunction(a.actionCallbacks.init)&&a.actionCallbacks.init(e)})}function r(e,t){a.csvProcessing=!0;var n=0,r=0;e&&e.start&&e.end?(n=e.start,r=e.end):(r=N().unix(),n=a.subscription.created),w.getSubscriptionUsageByRange(s,r,n,t).then(function(e){o(e,800)})}function o(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:800;t&&angular.isString(t)&&C({method:"GET",url:"/starfleet/enterprise-platform/v1"+t,transformResponse:function(e,t){return t()}}).then(function(e){return e||e.data||e.data.state?"init"===e.data.state||"in_progress"===e.data.state?(a.csvProcessing=!0,j(function(){return o.call(null,t,2*n)},n)):void("complete"===e.data.state&&(a.closeDateRangeModal(),a.csvProcessing=!1,e=e.data.location,b.location.href=b.location.protocol+"//"+b.location.host+"/starfleet/enterprise-platform/v1/report/usage/"+e+"/csv")):(a.closeDateRangeModal(),a.csvProcessing=!1,new Error("no data"))}).catch(function(e){a.closeDateRangeModal(),a.csvProcessing=!1;e&&(e.message,e.data&&e.data.status&&e.data.status,e.data&&e.data.data&&e.data.data.status&&e.data.data.status,A(e||{},"details.originalError.error.message")&&A(e||{},"details.originalError.error.message"),new Date)})}function f(t,e){var n=a.seats[t];if(E.track("Set Seat Role",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",cta_type:"link",cta_label:"Set Role: "+e,action:"set",traits:v.user.get("traits")}),n){if(n.role===e)return y.resolve();var r=T.where(a.seats,{role:"admin"});return("admin"!==e||"user"!==n.role)&&r.length<=1?d("Change Seat Role","User requesting role change is the only admin. Blocking this request to prevent account lockout.",null,"Close"):"user"===e&&"admin"===n.role&&n.user&&n.user._id===v.user.get("_id")?d("Change Seat Role","Are you sure you want lose your admin privileges?","Yes","No").then(function(){u(t,{role:e}).then(function(){n.role=e})}):u(t,{role:e}).then(function(){n.role=e,E.track("Set Seat Role Success",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"set",traits:v.user.get("traits")}),angular.isFunction(a.actionCallbacks.setRole)&&a.actionCallbacks.setRole()}).catch(function(e){E.track("Set Seat Role Failed",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"set",errorInfo:e,traits:v.user.get("traits")})})}}function u(e,t){return w.updateSeat(s,e,t)}function p(){var e=(a.enterpriseAccount&&a.enterpriseAccount.seats||0)-(l()||0);return 0<e?e:0}function t(){return T.values(a.seats)}function h(){return t().length}function l(){return T.chain(a.seats).values().filter(function(e){return"active"===e.state||"invited"===e.state}).value().length}function m(e){return!(!e||!e.user)&&(!a.filterUsers||(t=e&&e.user&&e.user.primary_email&&e.user.primary_email.address?e.user.primary_email.address:"",n=e.user&&e.user&&e.user.slug?e.user.slug:"",r=e.user&&e.user&&e.user.first_name?e.user.first_name:"",e=e.user&&e.user&&e.user.last_name?e.user.last_name:"",i=new RegExp(a.filterUsers.replace(/(\-|\+|\.)/g,"\\$1"),"i"),r&&r.match(i)||e&&e.match(i)||t&&t.match(i)||n&&n.match(i)||!1));var t,n,r,i}function d(e,t,n,r){return _.open({templateUrl:"/templates/subscription-seat-management/general-modal.html",controllerAs:"ctrl",bindToController:!0,controller:function(){angular.extend(this,{title:e,body:t,acceptText:n,rejectText:r})}}).result}function g(n,r){return _.open({templateUrl:"/templates/subscription-seat-management/send-at-modal.html",size:"md",controllerAs:"ctrl",bindToController:!0,controller:["$scope",function(e){var t=this;angular.extend(t,{sendAt:void 0,displayDates:!1,start_time:"",timeZone:N.tz.guess(),userId:n,minDate:N(N().add(1,"hour")).unix(),sendLater:function(){t.displayDates=!0},sendNow:function(){return r(t.userId,null)},setSendDate:function(){var e=N(1e3*t.start_time).format("YYYY-MM-DD HH:mm:ss Z");return r(t.userId,e)},clear:function(){t.sendAt=void 0,t.displayDates=!1}}),e.$watch(function(){return t.sendAt},function(e){if(e)return e})}]}).result}(s||c)&&n.userUrlBase&&n.userUrlId&&(n.$on("user:login",i),n.$on("user:logout",i),angular.extend(a,{enterpriseAccount:{},enterpriseProduct:{},subscription:{},seats:{},numSeats:h,numActiveSeats:l,usageReportData:"",getCSV:r,csvProcessing:!1,isLoading:!1,actionCallbacks:n.actionCallbacks||{},getUserUrl:function(e){var t=n.userUrlBase,e=I(n.userUrlId)({seat:e});return t+e},getSeatsRemaining:p,getAllSeats:t,getSeats:function(){var e=T.filter(T.values(a.seats),m),t=(P.search("filterUsers",a.filterUsers||null).replace(),a.userCount=e.length,(a.currentPage-1)*a.pageSize),n=a.currentPage*a.pageSize;return e.slice(t,n)},addSeat:function(t,n){var r={};t&&(r.user=t._id,r.subscription=s,r.enterpriseAccount=a.enterpriseAccount._id,E.track("Add Seat",{seatId:s,seatSlug:c,seat:r,sendAt:n,category:"enterprise",action:"add",traits:v.user.get("traits")}),w.createSeat(s,r).then(function(e){e.user=t,a.seats[e._id]=e,E.track("Add Seat Success",{seatId:s,seatSlug:c,seat:r,sendAt:n,seatResult:e,category:"enterprise",action:"add",traits:v.user.get("traits")}),angular.isFunction(a.actionCallbacks.addSeat)&&a.actionCallbacks.addSeat(),a.filterUsers||(a.filterUsers=t.primary_email.address)}).catch(function(e){E.track("Add Seat Failed",{seatId:s,seatSlug:c,seat:r,seatResult:newSeat,category:"enterprise",action:"add",errorInfo:e,traits:v.user.get("traits")}),angular.isFunction(a.actionCallbacks.addSeat)&&a.actionCallbacks.addSeat(e.message||e||"There was a problem adding the seat.")}))},enableSeat:function(e,t){e.preventDefault();var n=a.seats[t];E.track("Enable Seat",{seatId:t,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",cta_type:"link",cta_label:"Enable",action:"enable",traits:v.user.get("traits")}),n&&"active"!==n.state&&u(t,{state:"active"}).then(function(){n.state="active",E.track("Enable Seat Success",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"enable",traits:v.user.get("traits")}),angular.isFunction(a.actionCallbacks.enableSeat)&&a.actionCallbacks.enableSeat()}).catch(function(e){E.track("Enable Seat Failed",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"enable",errorInfo:e,traits:v.user.get("traits")}),n.state="inactive"})},disableSeat:function(e,t){e.preventDefault();var n=a.seats[t];E.track("Disable Seat",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",cta_type:"link",cta_label:"Disable",action:"disable",traits:v.user.get("traits")}),n&&"inactive"!==n.state&&f(t,"user").then(function(){u(t,{state:"inactive"}).then(function(){n.state="inactive",E.track("Disable Seat Success",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"disable",traits:v.user.get("traits")}),angular.isFunction(a.actionCallbacks.disableSeat)&&a.actionCallbacks.disableSeat()}).catch(function(e){E.track("Disable Seat Failed",{seatId:t,seatSlug:c,seat:Object.assign({},n,{user:n.user&&n.user._id||n.user}),category:"enterprise",action:"disable",errorInfo:e,traits:v.user.get("traits")}),n.state="active"})})},setSeatRole:f,addMembers:function(){E.track("Open Add Members Modal",{seatId:s,seatSlug:c,category:"enterprise",cta_type:"button",cta_label:"Add Members",action:"open modal",traits:v.user.get("traits")}),a.addError=!1,_.open({templateUrl:"/templates/subscription-seat-management/add-members-modal.html",size:"lg",controllerAs:"ctrl",bindToController:!0,controller:["$scope",function(e){var t=5,n=p(),r=o(!0),i=this;function o(e){if(e)return t<n?t:n;e=i.totalFields.length;return e+t<n?t:n-e}angular.extend(i,{seats:h(),numActiveSeats:l(),maxSeats:a.enterpriseAccount.seats,totalFields:T.range(r),addMore:function(){var e=o(!1);i.totalFields.length+e<=i.maxSeats&&(E.track("Add More",{seatId:s,seatSlug:c,category:"enterprise",cta_type:"button",cta_label:"Add More",action:"Add Seat Member",traits:v.user.get("traits")}),i.totalFields=i.totalFields.concat(T.range(i.totalFields.length,i.totalFields.length+e)))},importCSV:angular.noop,inputs:{},file:null}),e.$watch(function(){return i.file},function(e){var t;!e||(e=D.parse(e,{header:!0,skipEmptyLines:!0}))&&e.data&&(t=[],T.each(e.data,function(e){""!==e.first_name&&""!==e.last_name&&""!==e.email&&t.push(e)}),i.totalFields=T.range(0,t.length),T.each(t,function(n,e){T.each(n,function(e,t){n[t]=e.trim()}),i.inputs[e]=n}))}),k.on(".add-seat-input",k.EVENTS.ENTER,function(e){e.preventDefault()})}]}).result.then(function(n){return!n&&T.isFunction(a.actionsCallbacks.addMembers)?(E.track("Add Members Modal Displayed Failed",{seatId:s,seatSlug:c,category:"enterprise",action:"display modal",error:"Something went wrong importing",traits:v.user.get("traits")}),void a.actionsCallbacks.addMembers(new Error("Something went wrong importing"))):T.keys(n).length>a.getSeatsRemaining()?(E.track("Add Members Modal Displayed",{seatId:s,seatSlug:c,category:"enterprise",action:"display modal",traits:v.user.get("traits")}),d("All of your "+a.enterpriseAccount.seats+" seats are being used",M.trustAsHtml('You can disable users or cancel invites to free up seats. <br>Need more? <a href="mailto:support@creativelive.com">Email us</a>'),"OK")):(a.isLoading=!0,g(null,function(e,t){return w.importSeatsFromUsers(s,T.values(n),t).then(function(){},function(e){a.addError=!0})}))}).then(function(){E.track("Add Members Modal Import Seats Success",{seatId:s,seatSlug:c,category:"enterprise",action:"display modal",traits:v.user.get("traits")}),i(!(a.isLoading=!1))}).catch(function(e){a.isLoading=!1})},exportSeats:function(){E.track("Export Seats",{seatId:s,seatSlug:c,category:"enterprise",cta_type:"button",cta_label:"Export",action:"export",traits:v.user.get("traits")});var e=T.chain(a.seats).values().filter(function(e){return e.user}).map(function(e){return{first_name:e.user.first_name,last_name:e.user.last_name,email:e.user.primary_email.address,role:e.role,status:e.state}}).value();!function(e,t){E.track("Export Seat CSV",{category:"enterprise",csvTitle:t,action:"export file",traits:v.user.get("traits")});t=t+".csv"||"export.csv",e=new Blob([e],{type:"text/csv;charset=utf-8;"});{var n;navigator.msSaveBlob?navigator.msSaveBlob(e,t):void 0!==(n=document.createElement("a")).download&&(e=URL.createObjectURL(e),n.setAttribute("href",e),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n))}E.track("Export Seat CSV Blob",{category:"enterprise",csvFilename:t,action:"export file",traits:v.user.get("traits")})}(D.unparse(e),a.subscription.name+"-members")},inviteSeat:function(t,n){E.track("Seat Invite",{seatId:s,seatSlug:c,seatUserId:t,sendAt:n,category:"enterprise",cta_type:"link",cta_label:"Re-Send Invite Email",action:"email invite",traits:v.user.get("traits")});var e=T.find(a.seats,function(e){if(e&&e.user&&e.user.user)return e.user.user===t}),r=null;e&&(r=e._id);w.sendInvitationEmail(s,t,n,r).then(function(){E.track("Seat Invite Success",{seatId:s,seatSlug:c,seatUserId:t,sendAt:n,category:"enterprise",action:"email invite",traits:v.user.get("traits")}),i(),T.isFunction(a.actionCallbacks.inviteSeat)&&a.actionCallbacks.inviteSeat()}).catch(function(e){E.track("Seat Invite Failed",{seatId:s,seatSlug:c,seatUserId:t,sendAt:n,category:"enterprise",action:"email invite",errorInfo:e,traits:v.user.get("traits")}),T.isFunction(a.actionCallbacks.inviteSeat)&&a.actionCallbacks.inviteSeat(e)})},displaySendAtModal:g,displayDateRangeModal:function(n){return a.dateRangeModal=_.open({templateUrl:"/templates/subscription-seat-management/date-range-modal.html",size:"md",controllerAs:"ctrl",bindToController:!0,controller:["$scope",function(e){var t=this;angular.extend(this,{displayDates:!a.enableTotalUsage,dateRange:{},timeZone:N.tz.guess(),mode:n,isProcessing:a.isProcessing,totalRange:function(){r(null,t.mode)},chooseRange:function(){t.displayDates=!0},onDateChange:function(){var e;t.dateRange.start&&(e=N(1e3*t.dateRange.start),t.dateRange.endMax=N(e).add(1,"years").toDate(),t.dateRange.endMin=e.toDate(),t.dateRange.end&&1<N(1e3*t.dateRange.end).diff(e,"years",!0)&&(t.dateRange.end=N(e).add(1,"years").unix()))},submitRange:function(){t.dateRange&&t.dateRange.start&&t.dateRange.end?r(t.dateRange,t.mode):angular.isFunction(t.actionCallbacks.warnOnDateRange)&&t.actionCallbacks.warnOnDateRange("Please submit a start and end time")},clear:function(){t.displayDates=!1},close:function(){a.dateRangeModal=null,t.$close()}})}]}),a.dateRangeModal.result},closeDateRangeModal:function(){a.dateRangeModal&&(a.dateRangeModal.close(),a.dateRangeModal=null)},isProcessing:function(){return a.csvProcessing},dateRangeModal:null,enableTotalUsage:"true"===n.enableTotalUsage||!1,seatSearch:"",filterSeats:m,filterUsers:x.filterUsers||"",clearFilters:function(){a.filterUsers=null},isTranscluded:e.isSlotFilled("addSeat"),getAvatarPath:function(e,t){return R.getAvatarPath(e,t)}}),i())}]}}]},{moment:void 0,papaparse:58}],891:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionSeatManagement",e("./directive"))},{"../../common/app":70,"./directive":890}],892:[function(e,t,n){"use strict";function r(p,h,m){return{restrict:"EA",scope:{id:"@?subscriptionId",slug:"@?subscriptionSlug"},templateUrl:function(e,t){var n="/templates/subscription-snapshot";return t.template?n+"/"+t.template+".html":n+"/main.html"},controllerAs:"ctrl",controller:["$scope","$element","$attrs",function(t,n,r){var e,i=this,o=t.id,a=t.slug,s=void 0,c=void 0;function l(){p.getSubscriptionSeat(o).then(function(e){(i.seat=e)&&"invited"===e.state?"content"===r.template&&n.addClass("hide"):e&&"active"===e.state&&"content"===r.template&&n.removeClass("hide")})}function u(){var e=(i.currentPage-1)*i.limit;i.courses=i.allCourses.slice(e,e+i.limit),"mycl"===r.template&&(i.overflowed=i.courses.length>i.hideLimit||1<i.currentPage,i.isLastPage=!i.courses.length||i.currentPage===i.pages,i.isLastPage?m.setHeight(s,c):m.removeHeight(s))}function d(){i.showAllClasses=!1,1<i.currentPage&&(i.currentPage=1,u()),m.removeHeight(s)}function f(){i.showAllClasses=!0,s||(s=n.find("#tileContainer"+t.$id),c=n.find("#tileContainerInner"+t.$id))}(o||a)&&(angular.extend(i,{limit:12,currentPage:1,maxSize:5,pageChanged:u}),t.$on("subscription-seat--activated",l),e=void 0,o?e=p.getSubscriptionById(o,!0):a&&(e=p.getSubscriptionBySlug(a,!0)),e.then(function(e){if(i.subscription=e,o=o||e._id,r.template)return"content"===r.template?h.getCoursesByIds(e.content).then(function(e){i.allCourses=e,u()}):"mycl"===r.template?h.getCoursesByIds(e.content).then(function(e){_.extend(i,{allCourses:e,pages:Math.ceil(e.length/i.limit),showAllClasses:!1,collapse:d,expand:f}),t.$watch(function(){return n[0].querySelector("section").scrollWidth},function(e){i.hideLimit=1082<=e?4:e<1082&&895<e?3:2,u()})}):r.template&&"seat"===r.template?l():void 0}).catch(function(e){}))}]}}r.$inject=["SubscriptionService","CatalogService","TransitionalHeight"],t.exports=r},{}],893:[function(e,t,n){"use strict";e("../../common/app").directive("subscriptionSnapshot",e("./directive"))},{"../../common/app":70,"./directive":892}],894:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{},templateUrl:"/templates/swimlanes/cms-edit.html",replace:!0,link:function(t,e,n){t.data=t.$parent.data,angular.extend(t,{set:function(e){t.data.event=t.data.event||{},t.data.event._id=e._id,t.data.event.title=e.title}})}}}]},{}],895:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/swimlanes/cms-view.html",replace:!0,link:function(e,t,n){e.data||(e.data=e.$parent.data)}}}]},{}],896:[function(e,t,n){"use strict";r.$inject=["EventService","CatalogService","broadcastService","$rootScope"];var p=e("underscore"),h=e("moment");function r(r,f,i,o){return{restrict:"AE",scope:{eventId:"@",broadcastType:"@",broadcastMatch:"@"},templateUrl:function(e,t){return t.templateUrl||"/templates/swimlanes/view.html"},replace:!0,link:function(u,e,t){var n=u.$watch("eventId",function(e){e&&(r.getEventById(e).then(function(e){var s,c,t,n;e&&(s={},c=[],p.each(e.swimlanes,function(a){-1===c.indexOf(a.name)&&c.push(a.name),p.each(a.broadcasts,function(t){var n,r,i,e=!1;if("equal"===u.broadcastMatch)e=t.broadcast_type===u.broadcastType;else if("regex"===u.broadcastMatch)try{var o=new RegExp(u.broadcastType),e=t.broadcast_type.match(o)}catch(e){}e&&(!t.meta&&t.content&&t.content.content_id&&f.getCourseById(t.content.content_id).then(function(e){t.meta=e}),o=h.unix(t.start_time).tz(l).startOf("day"),e=parseInt(o.unix(),10),n=h.unix(t.start_time).tz(l).startOf("minute").format("HH:mm"),r=c.indexOf(a.name),s[e]=s[e]||{moment:o,timeslot:[]},d<t.end_time&&(d=t.end_time),i=!1,p.each(s[e].timeslot,function(e){e.time===n&&(e.classes[r]=t,i=!0)}),i||((o=[])[r]=t,s[e].timeslot.push({time:n,timestamp:t.start_time,classes:o})))})}),p.each(s,function(e,t){s[t].timeslot=p.sortBy(e.timeslot,function(e){return e.time})}),(t=p.keys(s))&&t.length&&(n=s[t[0]]&&s[t[0]].moment,u.today.isBefore(n)?u.activeDate=0:t.forEach(function(e,t){u.today.tz(l).startOf("day").unix()===parseInt(e,10)&&(u.activeDate=t)})),n=h.unix(d),u.isPast=u.today.isAfter(n),u.days=s,u.laneNames=c,u.event=e,u.event.swimlanes.forEach(function(t){new i({onBroadcastStart:function(e){t.broadcast=e,u.$applyAsync()}}).setBroadcasts(t.broadcasts)}))}),t.isAdmin||n())}),l=o.user.get("timezone")||"America/Los_Angeles",d=0;angular.extend(u,{isPlaying:function(e,t){return!!t&&(!!u.event.swimlanes[e].broadcast&&u.event.swimlanes[e].broadcast._id===t._id)},today:h().tz(l).startOf("day"),dateFormat:"ddd MM/DD",hasBorderBottom:function(e,t,n){if(!u.days[e].timeslot[t+1])return!1;if(u.days[e].timeslot[t+1].classes[n])return!1;var r=u.days[e].timeslot[t].classes[n],i=u.days[e].timeslot[t],o=t;for(;!r&&0<o;)o--,r=u.days[e].timeslot[o].classes[n];return!r||r.end_time>i.timestamp},changeTab:function(e){u.activeDate=e}}),u.broadcastType||(u.broadcastType="live"),u.broadcastMatch||(u.broadcastMatch="equal")}}}t.exports=r},{moment:void 0,underscore:void 0}],897:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("eventSwimlanes",e("./directives/view")),r.directive("swimlanes",e("./directives/cms/view")),r.directive("swimlanesEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":894,"./directives/cms/view":895,"./directives/view":896}],898:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{tags:"=?",autocomplete:"=?",placeholder:"@"},templateUrl:"/templates/tags-manager/view.html",link:function(t){angular.extend(t,{newTag:"",add:function(e){angular.isString(e)&&(t.newTag=e);""!==t.newTag&&-1===t.tags.indexOf(t.newTag)&&t.tags.push(t.newTag);t.newTag=""},remove:function(e){t.tags.splice(e,1)},placeholder:t.placeholder||"Press <enter> to add tag"})}}}},{}],899:[function(e,t,n){"use strict";e("../../common/app").directive("tagsManager",e("./directives/view"))},{"../../common/app":70,"./directives/view":898}],900:[function(e,t,n){"use strict";e("../../common/app").directive("clTargetProvider",e("./provider"))},{"../../common/app":70,"./provider":901}],901:[function(e,t,n){"use strict";t.exports=["TargetService","_",function(c,u){return{restrict:"A",link:function(n,e,r){var t=[],i=(angular.forEach(["clTargetId","clTargetSlug"],function(e){e=r.$observe(e,o);t.push(e)}),r.clTargetProviderKey||"clTarget");function o(){var t,n;r.clTargetId?(t=r.clTargetId.split(","),c.get().then(function(e){return u.filter(e,function(e){return u.contains(t,e._id)})}).then(a).catch(s)):r.clTargetSlug?(n=r.clTargetSlug.split(","),c.get().then(function(e){return u.filter(e,function(e){return u.contains(n,e.slug)})}).then(a).catch(s)):c.get().then(a).catch(s)}function a(t){r.clDebug,c.testTargets(t).then(function(e){n[i].all=e.length===t.length,n[i].any=0<e.length,u.each(t,function(e){n[i][e.slug]=!1}),u.each(e,function(e){n[i][e.slug]=!0}),n[i].ready=!0})}function s(e){n[i]={clTargetProviderError:!0,error:e}}n[i]={}}}}]},{}],902:[function(e,t,n){"use strict";e("../../common/app").directive("clTaxonomyProvider",e("./provider"))},{"../../common/app":70,"./provider":903}],903:[function(e,t,n){"use strict";t.exports=["TaxonomyService",function(o){return{restrict:"A",link:function(t,e,n){var r=n.clTaxonomyProviderKey||"clTaxonomyData";function i(e){e={clTaxonomyProviderError:!0,error:e};t[r]=e}o.get().then(function(){var e;n.clCategoryId||n.clTopicId?e=o.getById(n.clCategoryId||n.clTopicId):(n.clCategorySlug||n.clTopicSlug)&&(e=o.getBySlug(n.clCategorySlug||n.clTopicSlug)),e?(e=e,t[r]=e,n.clDebug):i("no taxonomy found")}).catch(i)}}}]},{}],904:[function(e,t,n){"use strict";t.exports=["config","arrayMove",function(n,s){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/testimonials/edit.html",replace:!0,link:function(a,e,t){a.config=n,a.data||(a.data=a.$parent.data),a.data.testimonials||(a.data.testimonials=[]),angular.extend(a,{addReview:function(e){e={_id:e._id,testimonial:e.comment,studentName:e.user&&e.user.slug};a.data.testimonials.push(e)},removeTestimonial:function(e){a.data.testimonials.splice(e,1)},addTestimonial:function(){a.data.testimonials.push({testimonial:"",studentName:""})},removeTitle:function(){a.data.noTitle&&(a.data.title="")},onDrop:function(e,t,n,r,i,o){s(e,o,r),a.$apply()}})}}}]},{}],905:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/testimonials/view.html",replace:!0,link:function(e,t,n){e.data||(e.data=e.$parent.data),e.data.title||e.data.noTitle||(e.data.title="What our students are saying")}}}]},{}],906:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("testimonials",e("./directives/view")),r.directive("testimonialsEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":904,"./directives/view":905}],907:[function(e,t,n){"use strict";t.exports=["$rootScope","$window","courseResource","bundleResource","config","SubscriptionService",function(e,t,s,c,u,l){return{restrict:"E",templateUrl:"/templates/thank-you/view.html",replace:!0,scope:{order:"=",debug:"="},link:function(n,e){n.courses=[],n.freeClass=void 0;var r=n.$watch("order",function(e){var t;e&&(n.freeClass="Free"===e.summaries.paymentMethod,i(e.line_items),n.hasSubscription=d.find(e.line_items,function(e){if(e.product&&e.product.source&&e.product.source.source_type)return"subscriptionPlan"===e.product.source.source_type}),n.isCreatorPass=!!n.hasSubscription&&(t=u.creatorPass.planSkus||[],d.any(e.line_items,function(e){return 0<=t.indexOf(e.product.sku)})),n.freeTrial="deferred"===e.order_status,n.freeTrial&&(n.product=e.line_items[0].product),r())});function i(e){var t=d.chain(e).pluck("product").flatten().pluck("course_id").value().join(","),e=d.chain(e).pluck("product").flatten().pluck("bundle_id").value();s.getTileData({ids:"["+t+"]"},function(e){e&&d.each(e.data,a)},function(e){}),d.each(e,o)}function o(e){void 0!==e&&c.findById({id:e},function(e){e&&d.each(e.data.courses,a)},function(e){})}function a(e){n.courses.push(e)}n.debug&&i(f),angular.extend(n,{getCourses:i,sendActivateEmail:function(){n.verifying=!0,n.errorMessage=void 0,l.sendActivateEmail(function(e){!e||429===e.status?n.type="success":417===e.status?(n.type="success",n.verifying=!1,n.verified=!0):(n.errorMessage=e.data&&e.data.message,n.type="danger",n.verifying=!1)})}})}}}];var d=e("underscore"),f=[{breakdown:[{course_id:"54fa2be82edec09f07081b1c"},{course_id:"54fa2bf42edec09f07082c16"},{course_id:"54fa2be92edec09f07082010"}]}]},{underscore:void 0}],908:[function(e,t,n){"use strict";e("../../common/app").directive("clThankyou",e("./directives/index"))},{"../../common/app":70,"./directives/index":907}],909:[function(e,t,n){"use strict";var o=e("moment");t.exports=["$timeout",function(t){return{restrict:"EA",scope:{ngModel:"=",minDate:"=?",maxDate:"=?",onChange:"&"},templateUrl:"/templates/time/datetimeDropdown.html",replace:!0,controllerAs:"ctrl",controller:["$scope",function(r){var i=this;angular.extend(i,{displayFormat:"MMM Do, h:mma",datePickerOptions:{},updateDatePickerOptions:function(){r.minDate||(r.minDate=o("2010-04-01T09:00:00").toDate());i.datePickerOptions.minDate=r.minDate,r.maxDate?i.datePickerOptions.maxDate=r.maxDate:i.datePickerOptions.maxDate=null},toView:function(e){e&&(i.jsDate=1e3*e,i.date=e);return""},toModel:function(e,t){{var n;!e||(n=Math.round(e/1e3))>=Math.round(r.minDate/1e3)&&(i.date=n,r.ngModel=i.date,r.onChange&&r.onChange({date:e,previous:t,unixDate:i.date,unixPrevious:Math.round(new Date(t)/1e3)}))}},keepOpen:function(e){e&&(e.preventDefault(),e.stopPropagation());t(function(){i.dropdownOpen=!0})}})}],link:function(e,t,n,r){n.displayFormat&&(r.displayFormat=n.displayFormat),e.$watch("ngModel",r.toView),e.$watch("ctrl.jsDate",r.toModel),e.$watch("minDate",r.updateDatePickerOptions),e.$watch("maxDate",r.updateDatePickerOptions)}}}]},{moment:void 0}],910:[function(e,t,n){"use strict";var o=e("moment");t.exports=["$timeout",function(e){return{restrict:"EA",scope:{ngModel:"=",minDate:"@",onChange:"&"},templateUrl:"/templates/time/datetimeStatic.html",replace:!0,controllerAs:"ctrl",controller:["$scope",function(r){var i=this;angular.extend(i,{minDate:1e3*r.minDate||o("2010-04-01T09:00:00").unix(),datePickerOptions:{showWeeks:!1},toView:function(e){e&&(i.jsDate=1e3*e);return""},toModel:function(e,t){{var n;!e||(n=Math.round(e/1e3))>=i.minDate&&(i.date=n,r.ngModel=i.date,r.onChange&&r.onChange({date:Math.round(e/1e3),previous:t,unixDate:i.date,unixPrevious:Math.round(t/1e3)}))}}})}],link:function(e,t,n,r){e.$watch("ngModel",r.toView),e.$watch("ctrl.jsDate",r.toModel)}}}]},{moment:void 0}],911:[function(e,t,n){"use strict";var i=e("moment"),o=e("dataset.js");t.exports=function(){return{scope:{dates:"=?",onChange:"="},templateUrl:"/templates/time/multiDatetimeDropdown.html",controllerAs:"ctrl",controller:["$scope","$attrs",function(t,e){var n=this,r=new o;angular.extend(n,{dates:t.dates?r.addEachToSet(t.dates):r,btnText:e.btnText,add:function(){var e=function e(t){return n.dates.hasItem(t.unix())?e(t.add(1,"days")):t}(i().startOf("day"));n.dates.addToSet(e.unix())},remove:function(e){n.dates.pull(e)},onChange:function(e){e&&(n.dates.hasItem(e.unixDate)||(e.unixDate!==e.unixPrevious&&n.dates.pull(e.unixPrevious),n.dates.addToSet(e.unixDate),t.onChange(e.unixDate)))}})}]}}},{"dataset.js":36,moment:void 0}],912:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clDatetimeDropdown",e("./directives/datetime-dropdown")),r.directive("clDatetimeStatic",e("./directives/datetime-static")),r.directive("clMultiDatetimeDropdown",e("./directives/multi-datetime-dropdown"))},{"../../common/app":70,"./directives/datetime-dropdown":909,"./directives/datetime-static":910,"./directives/multi-datetime-dropdown":911}],913:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"E",scope:{title:"@",subTitle:"@"},replace:!0,templateUrl:"/templates/title/section.html"}}},{}],914:[function(e,t,n){"use strict";e("../../common/app").directive("titleSection",e("./directives/section"))},{"../../common/app":70,"./directives/section":913}],915:[function(e,t,n){"use strict";t.exports=["topicService",function(e){return{restrict:"AE",replace:!0,templateUrl:"/templates/topic-editor/index.html",link:function(t){e.getAllByCategory().then(function(e){t.categories=e})}}}]},{}],916:[function(e,t,n){"use strict";var d=e("deepval");t.exports=["$rootScope","$window","$document",function(c,u,l){return{restrict:"AE",replace:!0,templateUrl:"/templates/topic-editor/page.html",link:function(t,n,e){var r=angular.element(u);function i(){var e=l[0].body.scrollTop,t=n[0].querySelector(".header");30<=e?t.classList.add("fix"):e<=30&&t.classList.remove("fix")}function o(){t.$watchCollection(a,s)}function a(){return d(c.user.get("follows"),"topic")}function s(e){angular.isArray(e)&&(t.topicsFollowed=e&&e.length)}c.$on("user:login",o),c.$on("user:register",o),angular.extend(t,{topicsFollowed:0}),c.user&&c.user._data&&c.user.valid()&&o(),r.on("scroll",i),t.$on("$$destroy",function(){r.off("scroll",i)})}}}]},{deepval:38}],917:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("topicEditor",e("./directives/index")),r.directive("topicEditorPage",e("./directives/page"))},{"../../common/app":70,"./directives/index":915,"./directives/page":916}],918:[function(e,t,n){"use strict";t.exports=["config","_","courseResource",function(r,i,o){return{restrict:"EA",templateUrl:"/templates/topic-hero/cms-edit.html",link:function(t,e,n){angular.extend(t,{config:r,setImageFromCourse:function(e){o.findBySlug({slug:e.slug},function(e){!e||(e=e&&e.data||e).image&&(t.data.image=e.image)})},themes:{white:"Light Text",black:"Dark Text"},addFollow:function(e){i.indexOf(t.data.topics,e.topic._id)<0&&t.data.topics.push(e.topic._id)},removeFollow:function(e){e=i.indexOf(t.data.topics,e.topic._id);0<=e&&t.data.topics.splice(e,1)},topics:[],tags:[]}),t.data.topics||(t.data.topics=[]),!t.data.header&&t.data.topic&&(t.data.header=t.data.topic),t.data.category=t.page&&t.page.primary_category,t.data.theme||(t.data.theme="white")}}}]},{}],919:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/topic-hero/cms-view.html",scope:{data:"=?"},controllerAs:"topicHeroCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],920:[function(e,t,n){"use strict";t.exports=["$filter","categoryResource","parseTransclusions",function(s,c,u){return{restrict:"E",templateUrl:"/templates/topic-hero/view.html",replace:!0,transclude:!0,scope:{categorySlug:"@",categoryId:"@",backgroundImage:"@",header:"@",lead:"@",theme:"@",topics:"=?",isPrimary:"=?"},link:function(t,e,n,r,i){function o(e){t.category=e.data}var a;t.categorySlug?c.getCategoryBySlug({slug:t.categorySlug}).$promise.then(o):t.categoryId&&c.getCategoryById({id:t.categoryId}).$promise.then(o),t.backgroundImage&&(a=s("magick")(t.backgroundImage,{width:1600}),e.css("background-image","url("+a+")")),t.data={HEADER:t.header,LEAD:t.lead},i(t,function(e){u(e,{$scope:t.data,compileScope:t.$parent.$parent})})}}}]},{}],921:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clTopicHero",e("./directives/index")),r.directive("topicHero",e("./directives/cms/view")),r.directive("topicHeroEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":918,"./directives/cms/view":919,"./directives/index":920}],922:[function(e,t,n){"use strict";t.exports=["$filter","config","_","arrayMove","toastr","courseResource",function(e,r,i,s,o,c){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/topic-list/cms-edit.html",replace:!0,link:function(a){function t(t,e,n){0<a.data.primaryTopics.concat(a.data.secondaryTopics).filter(function(e){return e.title===t}).length?o.warning("This topic already exists.","Topics Collection Module"):e&&8<=a.data.primaryTopics.length?o.warning("There can only be a max of 8 primary topics.","Topics Collection Module"):16<=a.data.primaryTopics.length+a.data.secondaryTopics.length?o.warning("There can only be a max of 16 total topics.","Topics Collection Module"):n()}function n(e,t){c.findBySlug({slug:e.slug},function(e){e=e&&e.data||e;if(!e.image)return o.error("There was no image returned from that course. Try another course");e.image&&e.image.file&&(a[t?"selectedPrimaryTopic":"selectedSecondaryTopic"].topic.image=e.image.file)})}a.data||(a.data=a.$parent.data),a.data.primaryTopics||(a.data.primaryTopics=[]),a.data.secondaryTopics||(a.data.secondaryTopics=[]),a.data.columns||(a.data.columns=3),a.data.showAll||(a.data.showAll=!1),angular.extend(a,{config:r,removeTopic:function(e,t){a.data[t?"primaryTopics":"secondaryTopics"].splice(e,1)},changeTopic:function(){var e=null;null!==a.selectedPrimaryTopic||""!==a.primaryTopic?null!==a.selectedPrimaryTopic?(e=a.data.primaryTopics[a.selectedPrimaryTopic.index])&&e.title===a.selectedPrimaryTopic.topic.title&&(e.title=a.primaryTopic,a.selectedPrimaryTopic=null):function(e){t(e,!0,function(){a.data.primaryTopics.push({title:e,primary:!0,link:null,image:null,follows:[],topics:[]}),a.primaryTopic=""})}(a.primaryTopic):null!==a.selectedSecondaryTopic?(e=a.data.secondaryTopics[a.selectedSecondaryTopic.index])&&e.title===a.selectedSecondaryTopic.topic.title&&(e.title=a.secondaryTopic,a.selectedSecondaryTopic=null):function(e){t(e,!1,function(){a.data.secondaryTopics.push({title:e,primary:!1,link:null,follows:[],topics:[]}),a.secondaryTopic=""})}(a.secondaryTopic)},selectPrimaryTopic:function(e,t){e.follows||(e.follows=[]);a.selectedSecondaryTopic=null,a.secondaryTopic="",a.primaryTopic=e.title,a.selectedPrimaryTopic={topic:e,index:t}},selectSecondaryTopic:function(e,t){e.follows||(e.follows=[]);a.selectedPrimaryTopic=null,a.primaryTopic="",a.secondaryTopic=e.title,a.selectedSecondaryTopic={topic:e,index:t}},clear:function(e){a.data.primaryTopics[e].image=null},setPrimaryImageFromCourse:function(e){n(e,!0)},setSecondaryImageFromCourse:function(e){n(e,!1)},onDrop:function(e,t,n,r,i,o){s(e,o,r),a.$apply()},onUpload:function(e){var t=a.selectedPrimaryTopic||a.selectSecondaryTopic,t=(a.selectedPrimaryTopic?a.data.primaryTopics:a.data.secondaryTopics)[t.index];t&&t.image&&(t.image=e)},primaryTopic:"",secondaryTopic:"",selectedPrimaryTopic:null,selectedSecondaryTopic:null,addFollow:function(e,t){i.indexOf(e.follows,t.topic._id)<0&&e.follows.push(t.topic._id)},removeFollow:function(e,t){t=i.indexOf(e.follows,t.topic._id);0<=t&&e.follows.splice(t,1)},topics:[],tags:[]})}}}]},{}],923:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{data:"=?",clModuleId:"@"},templateUrl:"/templates/topic-list/cms-view.html",controllerAs:"topicListCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}},{}],924:[function(e,t,n){"use strict";t.exports=["config","trackFactory","_",function(o,a,s){return{restrict:"AE",scope:{title:"@clTitle",sub:"@clSub",ctaText:"@",primaryTopics:"=?",secondaryTopics:"=?",showAll:"=?",columns:"=?",pageName:"@",moduleSlug:"@",clModuleId:"@"},templateUrl:"/templates/topic-list/view.html",replace:!0,link:function(t,e,n){angular.extend(t,{config:o,showMore:function(){t.showingMore=!0,a.expandTopics(t.ctaText,"button","Topic List",t.clModuleId)},showingMore:!1,activeIndex:null});var r=t.$watch("primaryTopics",function(e){t.primaryTopics&&(s.each(t.primaryTopics,function(e){e.ids=e.follows,e.name=e.title,e.path=e.link}),r())}),i=t.$watch("secondaryTopics",function(e){t.secondaryTopics&&(s.each(t.secondaryTopics,function(e){e.ids=e.follows,e.name=e.title,e.path=e.link}),i())})}}}]},{}],925:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("topicList",e("./directives/index")),r.directive("topicListCms",e("./directives/cms/view")),r.directive("topicListCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":922,"./directives/cms/view":923,"./directives/index":924}],926:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["ChannelTopicService","CatalogService","TopicSummaryModal",function(o,a,s){return{restrict:"AE",replace:!0,scope:{data:"=?",id:"@",pageId:"@",follow:"<?",followStatus:"<?",showCategory:"<?",useModal:"<?"},templateUrl:function(e,t){return t.template?"/templates/topic-tile/"+t.template+".html":"/templates/topic-tile/with-image.html"},link:function(t,e,n){var r;function i(){c.each(t.data.ids,function(e){a.getCoursesByTopic(e,{}).then(function(e){e&&(t.numCourses+=e.length)})})}angular.extend(t,{numCourses:0,onClick:function(e){t.follow?e.preventDefault():!1!==t.useModal&&(e.preventDefault(),s({topic:t.data}))}}),(t.data||t.id||t.pageId)&&(t.data?r=t.$watch("data",function(e){e&&(i(),r())}):(t.id&&o.getTopicByTaxonomyIds([t.id]).then(function(e){e&&e[0]&&(t.data=e[0],i())}),t.pageId&&o.getTopicByPageId(t.pageId).then(function(e){e&&(t.data=e,i())})))}}}]},{underscore:void 0}],927:[function(e,t,n){"use strict";t.exports=["$rootScope","$timeout","PageService","ChannelTopicService","CatalogService","_",function(o,a,s,c,u,l){return{restrict:"AE",templateUrl:function(e,t){return"/templates/topic-tile/"+(t.template||"topic-summary")+".html"},scope:{pageId:"@?clTopicSummary",onFollow:"&"},replace:!0,link:function(t,e,n){var r;function i(){angular.isFunction(t.onFollow)&&t.onFollow(),r()}o.user.valid()?(r=angular.noop,c.get().then(function(e){t.topicData=l.findWhere(c.cache.topics,{page_id:t.pageId}),s.getById(t.pageId).then(function(e){e&&(t.topicHeroModule=l.findWhere(e.modules,{slug:"topic-hero"}),(e=l.findWhere(e.modules,{slug:"class-list-collection-cms"}))&&e.data&&(e=l.pluck(e.data.courses,"_id"),u.getCoursesByIds(e).then(function(e){t.classList=e,a(function(){r=t.$on("user:follow",i)})})))},console.warn)},console.warn)):t.showChannels=!1}}}]},{}],928:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("topicTile",e("./directives/index")),r.directive("clTopicSummary",e("./directives/topic-summary")),r.service("TopicSummaryModal",e("./services/topic-summary-modal"))},{"../../common/app":70,"./directives/index":926,"./directives/topic-summary":927,"./services/topic-summary-modal":929}],929:[function(e,t,n){"use strict";t.exports=["$uibModal","$timeout","trackFactory",function(e,i,t){return function(r){e.open({templateUrl:"/templates/topic-tile/topic-summary-modal.html",windowClass:"cl-modal modal-topic-summary",controller:["$scope","$uibModalInstance",function(e,t){var n;r&&r.topic&&(angular.extend(e,{topic:r.topic,onFollow:function(){i(t.dismiss,n)},dismiss:t.dismiss}),n=parseInt(r.afterFollowDelay||1e3,10))}]})}}]},{}],930:[function(e,t,n){"use strict";t.exports=["trackFactory",function(r){return{restrict:"AE",link:function(e,t,n){e[n.clTrackProviderKey||"clTrackFactory"]=r}}}]},{}],931:[function(e,n,r){"use strict";var w,S,E,x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=(t.$inject=["$filter","$rootScope","$timeout","$q","courseResource","categoryResource","CartService","EventService","AnalyticsService","TopicService","PipelineService","CatalogService","_","ContentAccessService"],e("async")),A=e("deepval"),k=(n.exports=t,3e5),T=60,M=1e3*T,C=0,I=!1;function t(s,o,a,e,t,i,c,h,u,n,m,g,l,v){return{globalNav:function(e){e=angular.extend({},e,{action:"click"});u.track("Global Nav",e)},trackChat:function(e,t){switch(e){case"Leave Chat":case"Join Chat":u.track(e,{channel:t.name});break;case"Load More Chat Messages":u.track(e,{channel:t.name,messageDisplayLimit:t.messageDisplayLimit,admin:t.admin});break;case"User Kicked From Chat":case"Chat Filter Updated":u.track(e,t);break;default:var n=t.metadata&&t.metadata.reference?"thread":void 0,n={channel:t.payload.channel,messageType:t.payload.content||n,admin:t.admin};n.messageType&&"command"!==n.messageType&&u.track("Chat Message",n)}},trackExpand:function(e,t,n){e={cta_label:e,cta_type:t,cta_module:n};u.track("Expand",e)},trackExpandableElt:function(e,t,n,r){t={cta_label:t,cta_type:n,cta_module:r},n=document.getElementById(e);n&&(r=n.hasAttribute("open")?"Hide":"Expand",u.track(r,t))},scrollToAnchor:function(e){e={cta_module:e};u.track("Scroll To Anchor",e)},trackClick:function(e,t,n){t={cta_label:e,cta_type:t,cta_module:n,label:e};u.track("Click",t)},presence:function(e){e={cta_label:e.label,time_present:e.timePresent};u.track("Class Presence",e)},productPageView:function(e){var t=e&&e._id;e.product&&(t=e.product._id||e.product);var n={content_type:"product",content_ids:[t],nonInteraction:1,quantity:1};try{n.category=e.product.source.source_type,n.sku=e.product.sku,n.content_title=e.short_title}catch(e){}n.product_id=t;t=o.user&&o.user.get("primary_email");t&&t.address&&(n.email=t.address,n.hashed_email=s("md5")(t.address));u.getAssociatedBundles(e._id,n).then(function(e){u.track("Product Viewed",e)})},star:function(e,t,n){var r=p(e);r.cta_label=t,r.cta_type=n,u.getAssociatedBundles(e._id,r).then(function(e){u.track("Starred",e)})},unStar:function(e,t,n){var r=p(e);r.cta_label=t,r.cta_type=n,u.getAssociatedBundles(e._id,r).then(function(e){u.track("Unstar",e)})},rsvp:function(e,t,n){var r=p(e);r.cta_label=t,r.cta_type=n,u.getAssociatedBundles(e._id,r).then(function(e){u.track("Enrollment",e)})},unRsvp:function(e,t,n){var r=p(e);r.cta_label=t,r.cta_type=n,u.getAssociatedBundles(e._id,r).then(function(e){u.track("Unenrollment",e)})},tabSection:function(e,t,n){var r={value:0,nonInteraction:0};t?r.label=t:n&&(r.cta_label=n);e&&(r.category=e);u.track("Section View",r)},downloadItem:function(n,r,e){t.findById({id:e},function(e){var e=e&&e.data||e,t=p(e);t.segment_id=n._id||null,t.required_access=n.is_preview?"none":n.required_access||null,t.itemType=r.type,t.segment_title=r.title,"HD"===r.type||"Low"===r.type?(t.itemType="video",t.videoDownloadType=r.type,t.video_length=r.duration):t.itemType="material",u.getAssociatedBundles(e._id,t).then(function(e){u.track("Download Item",e)})})},catalog:function(e,t,n,r){var i,o={search:"Catalog Page View"},a={searchStart:"search_start",searchComplete:"search_complete",filtering:"filtering",sorting:"sorting"};t=t||{};o[e]?i=o[e]:a[e]&&(t.action=a[e],i="Products Searched");i?u.track(i,t,n,r):r()},cart:function(e){e=l.extend(e,{cta_type:e.cta_type||"button"});u.track("Cart Viewed",e)},addToCart:function(e,t,n,r,i,o){var a=e&&e.source,s=p(a);l.extend(s,{cta_label:n,cta_type:r||"button",action:"add",offer_type:t||null,display_price:(e.pricing||{}).display_price||e.full_price,list_price:(e.pricing||{}).current_price||e.price,product_type:"course",product_id:e._id,course_id:e.courseId||a._id,course_cid:e.nid||a.nid,bundle_id:null,bundle_bid:null,subscriptionPlan_id:null,subscriptionPlan_sid:null,modal_id:o,title:e.short_title||a.title,hasSubscription:!1,hasAlaCarte:!0}),l.extend(s,{price:(e.pricing||{}).display_price||e.full_price,sku:e.sku,category:a.source_type,name:e.short_title||a.title}),"bundle"===a.source_type&&("course"===a.type?s.product_type="bundle":s.product_type=a.type,s.bundle_id=a._id,s.bundle_bid=a.nid,s.course_id=null,s.course_cid=null);"subscriptionPlan"===a.source_type&&(s.product_type=a.source_type,s.bundle_id=null,s.bundle_bid=null,s.course_id=null,s.course_cid=null,s.subscriptionPlan_id=a._id,s.subscriptionPlan_sid=a.nid,s.hasSubscription=!0,s.hasAlaCarte=!1);"cross"===t&&(i||e.source)&&(s.anchor_id=(i||e.source).product);e&&(s.content_ids=[e._id]);s.content_type="product",s.content_title=a.short_title,c.get().then(function(e){s.products=y(e),u.getAssociatedBundles(a._id,s).then(function(e){"gift"===t?u.track("Add Gift to Cart",e):u.track("Product Added",e)})})},removeFromCart:function(e,t,n,r){var i=e&&e.source,o=p(i);l.extend(o,{cta_label:n,cta_type:r||"button",action:"remove",offer_type:t||null,product_type:"course",course_id:i._id,course_cid:i.nid,bundle_id:null,bundle_bid:null}),e&&(o.product_id=e._id,o.name=i.title||i.short_title,n=e.price||e.current_price||e.pricing&&e.pricing.price,angular.isNumber(n)&&(o.display_price=n,o.price=n));"cross"===t&&e.anchor_id&&(o.anchor_id=e.anchor_id);i&&i.type&&("course"===i.type?o.product_type="bundle":o.product_type=i.type,o.bundle_id=i._id,o.bundle_bid=i.nid,o.course_id=null,o.course_cid=null);o.category=i&&i.source_type,c.get().then(function(e){o.products=y(e),u.getAssociatedBundles(i._id,o).then(function(e){u.track("Product Removed",e)})})},addCrossCart:function(e,t,n){var r=p(e);r.cta_label=t,r.cta_type=n||"button",e&&(r.productId=e.nid,r.anchorId=e.source&&e.source.nid,t=e.price||e.full_price,r.title=e.short_title||e.title,r.currentPrice=t/100,r.content_ids=[e.courseId],r.content_type="product");u.track("Add Cross Cart",r)},onDemandVideoView:function(e,t){var n={type:"video_view",video_type:"on_demand",segment_id:(t=t||e.source||{})._id||null};o.user.valid()&&(i=(i=o.user.hasContent("purchased","courses",e._id))||o.user.hasRole("owns_all_courses"));var r="lesson";"promo"===t.type||t.media&&t.media[0]&&"promo"===t.media[0].type?r="promo":t.is_preview&&!i?r="preview":i||t._id!==o.cardedSegment||(r="card");n.access_type=r;var i=l.findWhere(t.media,{type:"HD"});i=i||(t.media&&t.media.length&&t.media[0]||t.media||{});i&&(n.media_id=i._id,n.video_length=i.duration||null);b(n,e)},liveOrRebroadcastPings:function(e,t,n){b({type:"video_view",video_type:"on_air",segment_id:void 0,video_length:void 0,access_type:n,event_id:t},e),S&&a.cancel(S);!function e(t,n,r,i,o){S=a(function(){var e=p(r);e.minutesWatched=t/1e3/60,e.intervalMinutesWatched=(t-n)/1e3/60,e.broadcast_type=o,delete e.ID,e.course_nid=r.nid,e.course_id=r._id,e.event_id=i,u.track("Broadcast Video View",e)},t);t===k?e(3*t,t,r,i,o):t<576e5&&e(2*t,t,r,i,o)}(k,0,e,t,n)},clearMediaViewInterval:function(){w&&(clearInterval(w),C=0)},playVideo:function(){I=!0},pauseVideo:function(){I=!1},videoEnded:function(){I=!1},reviewModal:function(e,t){var n=p(e);n.counts=t,u.getAssociatedBundles(e._id,n).then(function(e){u.track("Review Modal",e)})},interestTopicSelected:function(e,t){e={topic:e,action:t};u.track("Interest Topic Selected",e)},interestCategorySelected:function(e,t){e={category:e,action:t};u.track("Interest Category Selected",e)},courseSummaryModal:function(e,t,n){var r=e.cross_sells?"anchor":"cross",n={action:n,modal_id:"course summary modal",offer_type:r,cta_label:t&&t.innerText||null,cta_type:t&&("IMG"===t.nodeName||-1<t.className.indexOf("play-icon"))?"thumbnail":"text",product_id:e._id,product_type:e.type,product_title:e.short_title};"courses"===e.type&&angular.extend(n,{anchor_id:"cross"==r?e.source.product:null,course_id:"cross"==r?e.courseId:e.source._id,course_cid:("cross"==r?e.source:e).nid});"anchor"!=r||"bundle"!==e.type&&"conference"!==e.type||angular.extend(n,{bundle_id:e.source._id,bundle_bid:e.source.nid});u.track("Cart Viewed",n)},tooltipModalShown:function(e){e={cta_label:e.cta_label,action:"shown",regPrompt:e.regPrompt};u.track("Tooltip Modal Shown",e)},accountModalShown:function(e){var t=Vault.Local.get("registrationActivationMode"),n={cta_label:e.cta_label,action:"shown",via:e.via,regPrompt:e.regPrompt};"click"===t&&(n.cta_location=0,n.cta_module="site-header");E=e.regPrompt,n=f(n,t),u.track("Account Modal Shown",n)},accountModalClosed:function(e){var t=Vault.Local.get("registrationActivationMode"),n={cta_label:e.cta_label,action:"close",via:e.via,regPrompt:e.regPrompt};"click"===t&&(n.cta_location=0,n.cta_module="site-header");E=e.regPrompt,n=f(n,t),u.track("Account Modal Closed",n)},priceAnchoringModalShown:function(e){e={cta_label:e.cta_label,cta_type:e.cta_type,action:"shown",via:e.via};u.track("PriceAnchoring Modal Shown",e)},priceAnchoringModalClosed:function(e){e={cta_label:e.cta_label,cta_type:e.cta_type,action:"close"};u.track("PriceAnchoring Modal Closed",e)},onboardingModalShown:function(e){e={via:e};u.track("Account Modal Shown",e)},signInStart:function(e){var t=Vault.Local.get("registrationActivationMode"),n=angular.extend(d(e.label,"start"),{cta_type:"button",student_email:e.student_email});n.cta_label="Continue with "+e.label,n=f(n,t),u.track("Login",n)},signInComplete:function(e,t){var n=Vault.Local.get("registrationActivationMode"),r=angular.extend(d(e.label,"complete"),{cta_type:"button",student_email:e.student_email});r.cta_label="email"===e.label?"Log in":"Continue with "+e.label,r.regPrompt=E,r=f(r,n),u.track("Login",r,{},t)},signUpStart:function(e){var t=Vault.Local.get("registrationActivationMode"),n=angular.extend(d(e.label,"start"),{modal_id:e.modal_id,student_email:e.student_email,regPrompt:E},e);n.cta_type="button",n.cta_label="Continue with "+e.label,n=f(n,t),u.track("Registration Start",n)},signUpComplete:function(e,t){var n=Vault.Local.get("registrationActivationMode"),r=rind&&rind.dump,r=r&&r.course&&r.course._id||r&&r.bundle&&r.bundle._id,i=angular.extend(d(e.label,"complete"),e);i.cta_type="button",i.cta_label=e.cta_label,i.student_email=e.student_email,i.regPrompt=E,r&&(i.productIDs=[r]);i=f(i,n),o.user.setTrait("_regPrompt",E),E=void 0,u.track("Registration Complete",i,{},t)},referralComplete:function(e){e={productIDs:[e.productNid],recipientEmail:[e.recipientEmail],noteAdded:!!e.note};u.track("Referral Submitted",e)},referralStart:function(e){e={productIDs:[e]};u.track("Referral Start",e)},onboardingContinue:function(e){r("continue",e)},onboardingQuit:function(e){r("quit",e)},onboardingX:function(e){r("x",e)},onboardingFinishUp:function(e){o.$broadcast("user:finish-onboarding"),r("finish",e)},onboardingSkip:function(e){r("skip",e)},onboardingSkipX:function(e){r("skipX",e)},onboardingAddTopic:function(e,t,n){r("add",e,t,n)},onboardingRemoveTopic:function(e,t,n){r("remove",e,t,n)},lowFreePreview:function(e){var t=p(e),t=angular.extend({},t,{type:"Video Player",action:"play",access_type:"preview",course_id:e.course,segment_id:e._id,video_type:"on_demand",cta_label:e.title,cta_type:"button",cta_location:2});u.track("Video Player",t)},clickExternalLink:function(e,t,n,r){r=r?u.getModuleLocation(r):"",e={cta_label:e,cta_type:t,cta_module:n||"NA",cta_location:r};u.track("Click External Link",e)},clickMoreMyCourses:function(){u.track("Click My Courses CTA",{cta_type:"button"})},expandTopics:function(e,t,n,r){r=u.getModuleLocation(r),e={cta_label:e,cta_type:t||"button",cta_module:n||"NA",cta_location:r};u.track("Expand Topics",e)},follow:function(t,n,r,i,o){var a={};"string"==typeof r&&(r=[r]);P.series([function(t){var e;"event"===n.follow_type?(e=r[0],h.getEventById(e).then(function(e){return e&&(a={productId:A(e,"product._id"),fullPrice:A(e,"product.full_price"),sourceId:A(e,"product.source.source_id"),sourceType:A(e,"product.source.source_type")}).sourceId?void u.getAssociatedBundles(a.sourceId,n).then(function(e){t()}):t()})):t()},function(t){if(!a.sourceId)return t();g.getCourseById(a.sourceId).then(function(e){a=l.extend(a,p(e)),t()})}],function(){var e={action:t,follow_type:n.follow_type,follow_name:n.follow_name,follow_id:r[0],category_ids:a.category_ids,topic_ids:a.topic_ids,cta_label:n.ctaLabel||"Follow",cta_type:o||"button",cta_module:"cta-follow",cta_location:i,bundles:n.bundles,learning_paths:n.learning_paths,has_bundles:n.has_bundles,has_learning_paths:n.has_learning_paths,product_type:a.sourceType,product_id:a.productId,page_price:s("centsToDollars")(a.fullPrice,!1,2)};u.track("Follow",e)})},freeClassOptInComplete:_.bind(null,"Complete"),freeClassOptInStart:_.bind(null,"Start"),checkout:function(e,t,n){e={action:e,checkout_type:t};l.extend(e,n),u.track("Checkout",e)},checkoutOrderStart:function(e){angular.extend(e,{action:"start",checkout_type:"order"}),u.track("Checkout Started",e)},checkoutOrderComplete:function(e){angular.extend(e,{action:"complete",checkout_type:"order"}),u.track("Order Completed",e)},gifting:function(e,t){e={action:e};l.extend(e,t),u.track("Gifting",e)},courseModal:function(e,t){t={action:t.action,course_id:t.courseId,cta_type:t.ctaType,cta_location:u.getModuleLocation(t.clModuleId),cta_label:t.ctaLabel,cta_module:t.clModule,product_id:t.productId,product_type:t.productType,modal_id:"path-detail-modal"};u.track(e,t)},playLessonPlayer:function(e){e=angular.extend({},e,{type:"Video Player",action:"play",access_type:"preview",video_type:"on_demand",cta_type:"button",cta_location:2,cta_module:"lesson_preview_set"});u.track("Video Player",e)},trackFreeVideoPlay:function(e){var t={};e.segment.is_preview?(t.access_type="preview",t.segment_id=e.segment._id):(t.access_type="promo",t.promo_media_id=e.segment.media._id);angular.extend(t,{type:"Video Player",action:"play",course_id:e.segment.course,video_type:"on_demand",cta_label:e.playCtaText||null,cta_type:"button",cta_location:1}),u.track("Video Player",t)},trackOnAirPlay:function(e){e=angular.extend({},e,{video_type:"on_air",type:"Video Player",playback_type:"streaming",cta_label:null,cta_location:2});u.track("Video Player",e)},trackChannelHeroVideo:function(e){e={video_type:"on_demand",type:"Video Player",action:e.action,access_type:"sizzle"};u.track("Video Player",e)},trackVideoPlayer:function(e){var t=angular.extend(e,{type:"Video Player",playback_type:"streaming"});u.getAssociatedBundles(e.course_id,t).then(function(e){u.track("Video Player",e)})},trackSocialShare:function(e){e={cta_label:e||"social share button",cta_type:"button",type:"Social Share"};u.track("Social Share",e)},trackGalleryImageTap:function(e){u.track("Gallery Image Tap",e)},trackGalleryImageView:function(e){u.track("Gallery Image View",e)},videoRegGate:function(e){var t={cta_action:"login/signup",cta_module:"overlay shown"};Object.assign(t,e),u.track("Video Reg Gate",t)},onLibraryCard:function(e,t,n){e={course_id:e,segment_id:t,card_id:n};u.track("Library Card Created",e)},trackPodcast:function(e,t){t={cta_module:"podcast",action:"click",podcast_url:t.podcastUrl,title:t.title};u.track(e,t)},trackSubscription:function(e,t){angular.extend(t,{action:e,isTrial:t.isTrial||!1}),u.track("Subscription Update",t)},trackLessonBlocked:function(e){u.track("Lesson Blocked",e)}};function y(e){var n=[];return e&&e.lineItems&&l.each(e.lineItems,function(e){var t=e.pricing?e.pricing.price:void 0;n.push({id:e._id,price:t/100,quantity:1})}),n}function b(t,n){function r(){i.getPrimary().$promise.then(function(e){e=l.findWhere(e&&e.data,{_id:n&&n.primary_category&&(n.primary_category._id||n.primary_category)});e&&(t.channel=s("titleCase")(e.title)),t.interval_seconds_watched=T,t.total_seconds_watched=0,m.reportVideoView(t),w=setInterval(function(){I&&(C++,t.total_seconds_watched=T*C,t.total_seconds_watched>t.video_length&&(t.total_seconds_watched=t.video_length),m.reportVideoView(t))},M)})}w&&(clearInterval(w),C=0),t.action="play",n&&(t.course_id=n.courseId||n._id,t.product_id=n.product&&(n.product._id||n.product)),v("course",t.course_id).then(function(e){switch(!0){case e&&e.owned:t.ownership_type="owned";break;case e&&e.subscribed:t.ownership_type="subscribed",t.subscription_ids=e.subscription_ids,"preview"===t.access_type&&(t.access_type="lesson");break;default:t.ownership_type="free"}r()}).catch(function(){t.ownership_type="free",n&&o.user&&o.user.valid()&&o.user.hasContent("purchased","course",n._id)&&(t.ownership_type="owned"),r()})}function d(e,t){return{interface:"browser",account_type:e,action:t}}function f(e,t){return e=e||{},t&&(0<=t.indexOf("click")?(e.cta_type=e.cta_type||"text",e.modal_id="clIntroModal"):0<=t.indexOf("video-view")?(e.cta_type=e.cta_type||t,e.modal_id="clIntroModalView"):0<=t.indexOf("timer")&&(e.cta_type=e.cta_type||t,e.modal_id="clIntroModalTimer")),e}function r(e,t,n,r){r=angular.extend({event_category:"onboarding",category:r||null,topic:n||null,cta_label:t,modal_type:"onboarding"},d(t,e));u.track("Onboarding",r)}function p(e){if(!e)return{};var t="object"===x(e.product)&&e.product||{},n=(e.price||{}).current_price||t.full_price,n=s("centsToDollars")(n,!1,2),r=l.chain(e.taxonomy).flatten().pluck("topic").pluck("_id").without(void 0).value(),i=l.chain(e.taxonomy).pluck("_id").without(void 0).value(),r=r.length?r:i;return{ID:e.nid,title:e.title||e.short_title,channel:e.primary_category&&e.primary_category.title,product_type:t.source&&t.source.source_type,product_id:t._id,page_price:n,category_ids:[e.primary_category&&e.primary_category._id],topic_ids:r}}function _(t,e,n,r,i){var o=p(e);o.cta_label=n,o.cta_type=r,o.cta_module="Product Card",o.cta_location=1,u.getAssociatedBundles(e.source._id,o).then(function(e){u.track("Free Class Opt-In "+t,e,{},i)})}}},{async:21,deepval:38}],932:[function(e,t,n){"use strict";var r=e("../../common/app");r.factory("trackFactory",e("./factories/main")),r.directive("clTrackProvider",e("./directives/provider"))},{"../../common/app":70,"./directives/provider":930,"./factories/main":931}],933:[function(e,t,n){"use strict";function r(s,c,u,l){return{restrict:"E",templateUrl:"/templates/tutorial/index.html",replace:!0,link:function(t){function e(){t.show=!1,t.tooltip&&u.Session.set("has_seen_tooltip",!0)}function n(){c.user._data.user&&c.user._data.user._id&&!u.Session.get("first_time_user")&&!u.Cookie.get("has_seen_my_library_update")&&(u.Cookie.set("has_seen_my_library_update",!0),s(function(){t.show=!0,t.introduction=!1,t.myLibraryUpdate=!0}),s(e,3e4))}angular.extend(t,{show:!1,onClose:e}),n(),t.$on("tutorial:show",function(){s(function(){t.show=!0,t.introduction=!0,t.myLibraryUpdate=!1}),u.Cookie.set("has_seen_my_library_update",!0)}),t.$on("tutorial:hide",function(){s(function(){t.show=!1})}),t.$on("tutorial:my-library-update",function(){n()});var r,i=c.user.getAnnualCreatorPassSubscription(),o=c.user.getActiveSubscriptionPlans(),a=c.user.showCPHeader();a&&c.user.getTrait("microsoft")&&"true"===c.user.getTrait("microsoft").toString()&&!u.Session.get("has_seen_tooltip")&&!u.Session.get("redeemInSession")?l.getBySlug("tooltip-microsoft").then(function(e){e&&e.module&&e.module.data&&(t.tooltip=e.module.data.content,t.show=!0)}):a&&i&&i.expire_soon&&!u.Session.get("has_seen_tooltip")?l.getBySlug("cp-renew-early").then(function(e){e&&e.module&&e.module.data&&(t.tooltip=e.module.data.content,t.show=!0)}):!a||o&&0!==o.length||u.Session.get("has_seen_tooltip")||(r=function(){var e="cp-promotion";c.buckets.experimentMap.feb_cp_banner&&(e=c.buckets.experimentMap.feb_cp_banner),l.getBySlug(e).then(function(e){e&&e.module&&e.module.data&&(t.tooltip=e.module.data.content,t.show=!0)})},c.$on("optimize-loaded",function(){r()}),r())}}}r.$inject=["$timeout","$rootScope","Vault","GlobalModuleService"],t.exports=r},{}],934:[function(e,t,n){"use strict";e("../../common/app").directive("clTutorial",e("./directives/index"))},{"../../common/app":70,"./directives/index":933}],935:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/upcoming-classes/edit.html",replace:!0,link:function(n,e,t){angular.extend(n,{clearFilters:function(){n.data.filters=[],n.$broadcast("clearCategoryFilters")},updateFilters:function(t){var e=n.data.filters.length;n.data.filters=_.filter(n.data.filters,function(e){return e._id!==t._id}),e===n.data.filters.length&&n.data.filters.push(t)},onSelectGrid:function(){n.data.upcomingTile="upcoming-responsive",n.data.onairTile="onair-responsive"},onSelectList:function(){n.data.upcomingTile="upcoming-line",n.data.onairTile="onair-line"},onSelectCarousel:function(){n.data.upcomingTile=null,n.data.onairTile="onair-hover",n.data.organizeClasses="",n.data.broadcastStatus="onair"}}),n.config=r,n.data||(n.data=n.$parent.data),n.data.filterParam||(n.data.filterParam="categories",n.data.filters=[],n.data.channelCount="5"),void 0===n.data.showButton&&(n.data.showButton=!0),void 0===n.data.showClassCategory&&(n.data.showClassCategory=!1),n.data.sorting||(n.data.sorting="date"),n.data.courseType||(n.data.courseType="all"),n.data.broadcastStatus||(n.data.broadcastStatus="all"),n.data.backfill||(n.data.backfill={live:!1,onair:!1}),n.data.onairTile||(n.data.onairTile="onair-responsive"),n.data.upcomingTile||(n.data.upcomingTile="upcoming-responsive"),n.data.layout||(n.data.layout="grid"),n.data.organizeClasses||(n.data.organizeClasses=""),n.data.limit||(n.data.limit="3")}}}]},{}],936:[function(e,t,n){"use strict";t.exports=["$sce","config",function(e,r){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/upcoming-classes/frontrow-edit.html",replace:!0,link:function(e,t,n){e.config=r,e.data||(e.data=e.$parent.data)}}}]},{}],937:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"AE",templateUrl:"/templates/upcoming-classes/frontrow-view.html",scope:{data:"=?"},link:function(e,t,n){e.data||(e.data=e.$parent.data),e.isAdmin="true"===n.isAdmin}}}]},{}],938:[function(e,t,n){"use strict";t.exports=["$sce",function(e){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/upcoming-classes/view.html",replace:!0,link:function(e,t,n){e.data||(e.data=e.$parent.data),e.isAdmin="true"===n.isAdmin,e.data.sorting||(e.data.sorting=e.data.filterParam),e.data.courseType||(e.data.courseType=e.data.showLive?"live":"all"),e.data.broadcastStatus||(e.data.broadcastStatus=e.data.showOnair?"onair":"all"),e.data.onairTile||(e.data.onairTile="onair-responsive"),e.data.upcomingTile||(e.data.upcomingTile="upcoming-responsive"),e.data.layout||(e.data.layout="grid")}}}]},{}],939:[function(e,t,n){"use strict";t.exports=["EventService","CatalogService","moment","deepval","DataSet","_",function(o,a,s,c,e,u){return{restrict:"AE",scope:{location:"@"},templateUrl:"/templates/upcoming-classes/frontrow.html",link:function(i){i.locationMapping={onLocation:"On Location",seattle:"Seattle"},i.upcoming=new e,o.getUpcomingEvents().then(function(e){var r,n,t;e&&e.length&&(r=function(e,t){a.getCourseById(e,null,{allow:"unpublished"}).then(function(e){e&&e.accepting_studio_audience&&(e.start_time=t.start_time,e.end_time=n(t),e.filming_location===i.locationMapping[i.location]&&i.upcoming.addToSet(e,"_id"))})},n=function(e){var t,n;return e&&e.swimlanes&&(e=o.getEventBroadcastData(e),0<=(n=u.findLastIndex(e.all,{broadcast_type:"live"}))&&(t=e.all[n].end_time)),t},t=s().unix(),e=function(e,n){var t,r;if(angular.isArray(e)&&angular.isString(n))return t=[],r={},u.each(e,function(t){t.swimlanes&&t.swimlanes.length&&u.each(t.swimlanes,function(e){e.broadcasts&&e.broadcasts.length&&u.find(e.broadcasts,function(e){return e.broadcast_type===n})&&(r[t._id]=t)})}),u.each(Object.keys(r),function(e){t.push(r[e])}),t}(u.filter(e,function(e){return e.start_time>t}),"live"),u.each(e,function(e){var t=c(e||{},"product.source.source_id"),n=c(e||{},"product.source.source_type");"course"===n?r(t,e):"bundle"===n&&(t=o.getEventBroadcastData(e),n=u.where(t.all,{broadcast_type:"live"}),angular.forEach(n,function(e){var t=c(e||{},"content.content_id");"course"===c(e||{},"content.content_type")&&t&&r(t,e)}))}))})}}}]},{}],940:[function(e,t,n){"use strict";r.$inject=["$sce","$rootScope","$timeout","$location","moment","DataSet","deepval","EventService","CatalogService","categoryResource","ScoresService","broadcastService","_"];var x=e("async"),P={userTopics:"_id",userCategories:"primary_category",categories:"primary_category"};function r(e,b,_,t,w,S,E,A,n,k,T,C,I){return{restrict:"AE",scope:{filterParam:"<",passedFilters:"<filters",channelCount:"<",sorting:"<",courseType:"<",broadcastStatus:"<",limit:"<",backfill:"<",showClassCategory:"<",showButton:"<",showAnchorButton:"<",onairTile:"<",upcomingTile:"<",layout:"<",container:"<?",copy:"<",slug:"<",anchorCopy:"<",anchorTarget:"<",clTitle:"<",hideTitle:"<",subtitle:"<",allowCategoryFilterUrl:"<",allowLiveFilterUrl:"<",organizeClasses:"<",userId:"<?"},templateUrl:"/templates/upcoming-classes/index.html",replace:!0,link:function(o,l,d){angular.extend(o,{getClass:function(e){return e%3?"col-xs-6 section-secondary":"sm-pad-bottom-m section-primary"},channels:{},allUpcomingCourses:new S,displayedCourses:new S,filters:angular.copy(o.passedFilters),onairTile:o.onairTile||"onair-responsive",upcomingTile:o.upcomingTile||"upcoming-responsive",layout:o.layout||"grid",urlCategoryTitle:"",displayedCoursesSet:!1,allowUnfollow:"true"===d.allowUnfollow});var n=new T,e=I.throttle(function(e){{var t;o.allUpcomingCourses&&o.allUpcomingCourses.length&&(c(t=new S),function(e){"live"===o.courseType&&e.length<o.limit&&o.backfill&&o.backfill.live&&(o.courseType="all",c(e));"onair"===o.broadcastStatus&&e.length<o.limit&&o.backfill&&o.backfill.onair&&(o.broadcastStatus="all",c(e))}(t),angular.forEach(t,v),function(e){"date"===o.sorting&&"upcoming"===o.broadcastStatus?function(e){I.each(e,function(e){var n;I.each(e.eventData.swimlanes,function(e){var t=new C;t.setBroadcasts(e.broadcasts),(!n||t.getNextBroadcast()&&n&&n.start_time>=t.getNextBroadcast().start_time)&&(n=t.getNextBroadcast())}),n&&(e.eventData.nextBroadcast=n)}),e.sort(function(){})}(e):"date"===o.sorting?function(e){function n(e){e=(e.eventData.currentBroadcast||e.eventData.nextBroadcast||e.eventData.prevBroadcast||e.eventData).start_time;return e}I.each(e,function(e){var n,r,i;I.each(e.eventData.swimlanes,function(e){var t=new C;t.setBroadcasts(e.broadcasts),(!n||t.getNextBroadcast()&&n&&n.start_time>=t.getNextBroadcast().start_time)&&(n=t.getNextBroadcast()),!r&&t.getCurrentBroadcast()&&(r=t.getCurrentBroadcast()),(!i||t.getPrevBroadcast()&&i&&i.start_time<=t.getPrevBroadcast().start_time)&&(i=t.getPrevBroadcast())}),n&&(e.eventData.nextBroadcast=n),r&&(e.eventData.currentBroadcast=r),i&&(e.eventData.prevBroadcast=i)}),e.sort(function(e,t){return n(e)-n(t)})}(e):"userCategories"!==o.sorting&&"userTopics"!==o.sorting||function(e){e.sort(function(e,t){var n=w.unix(e.eventData.start_time).tz(a),r=w.unix(t.eventData.start_time).tz(a),i=w().tz(a);return n.diff(i,"days")<0&&(n=i),r.diff(i,"days")<0&&(r=i),0!==(i=n.diff(r,"days"))?i:t.score-e.score})}(e)}(t),function(e){var r,i;o.organizeClasses&&""!==o.organizeClasses&&(r={},i=[],I.each(e,function(e){e.eventData.nextBroadcast&&(e.eventData.start_time=e.eventData.nextBroadcast.start_time);var t=w.unix(e.eventData.start_time).tz(a).format(o.organizeClasses),n=[];-1!==t.indexOf(",")&&(n=t.split(", ")),r[t]?r[t].courses.push(e):(r[t]={label:t,parts:n,courses:[e]},i.push(r[t]))}),o.periods=i)}(t),"all"!==o.limit&&(t=t.splice(0,parseInt(o.limit))),o.displayedCourses.clear(),angular.forEach(t,function(e){o.displayedCourses.addToSet(e,y)}),o.displayedCourses.length||(o.displayedCoursesSet=!0))}angular.isFunction(e)&&e()},300,{leading:!1}),a="America/Los_Angeles";function r(){x.series([p,h,m,g,e,f],function(e){o.ready=!0,o.$applyAsync()})}function t(){try{var e=b.user.valid()&&b.user.get("timezone");angular.isString(e)&&(a=e)}catch(e){}}function f(e){var t,n=Math.round(Date.now());I.each(o.displayedCourses,function(e){e.eventData.currentBroadcast&&(!t||e.eventData.currentBroadcast.end_time<t)&&(t=e.eventData.currentBroadcast.end_time)}),n/1e3<t&&_(r,1e3*t-n+1e3),e()}function p(t){k.getPrimary().$promise.then(function(e){o.categories=e.data,angular.forEach(o.categories,function(e){e.upcoming=[]}),o.categoriesById=I.indexBy(o.categories,"_id"),s()&&(o.sortedChannels=n.getSortedCategories(e.data),o.channels=I.indexBy(o.sortedChannels,function(e){return e.title})),t()})}function h(t){var e;"userTopics"===o.filterParam?n.fetchFilteredTopics(function(e){o.filters=e,t()}):("userCategories"===o.filterParam?(e=o.sortedChannels.slice(0,o.channelCount),o.filters=I.filter(e,function(e){return e.score}),0===o.filters.length&&(o.filters=o.sortedChannels,I.each(o.filters,function(e){e.score=6-e.order}))):o.filters||(o.filters=[],I.each(o.categories,function(e){o.filters.push(e)})),t())}function m(t){"userTopics"===o.sorting?n.fetchFilteredTopics(function(e){o.sortedItems=e,0===o.sortedItems.length&&(o.sorting="userCategories",I.each(o.channels,function(e){e.score=6-e.order,o.sortedItems.push(e)})),t()}):("userCategories"===o.sorting&&(o.sortedItems=o.sortedChannels),t())}function g(t){var e,n;"userTopics"!==o.filterParam||o.filters.length?(e=A.get,n={date:w().tz(a).startOf("hour").unix(),sort:"start_time",time:"end_time",when:"after",limit:200},o.userId&&(e=b.user.getEvents,n={limit:100,userId:o.userId,upcoming:!0}),e(n).then(function(e){e=e&&e.data||e.events||e;A.organizeEventsForCalendar(e,function(e){i(e.onair),i(e.upcoming),t()})})):t()}function i(e){angular.forEach(e,function(e){if(!0===E(e||{},"product.source.flagged.on_calendar")&&((n=angular.copy(e.product.source)).eventData=angular.copy(e),o.allUpcomingCourses.push(n)),s()){var t,n=e.product.source;try{t=n.primary_category.title}catch(e){}if(!t)try{t=n.content.content_id.primary_category.title}catch(e){}o.channels&&t&&((t=o.channels[t])&&t.upcoming&&t.upcoming.push(n))}})}function s(){return"userTopics"===o.filterParam||"userCategories"===o.filterParam||"userTopics"===o.sorting||"userCategories"===o.sorting}function c(t){angular.forEach(o.allUpcomingCourses,function(e){(!o.filterParam&&!o.urlCategory||function(e){if(!function(r){if(o.filterParam&&-1<Object.keys(P).indexOf(o.filterParam))return I.any(o.filters,function(e,t){if(u(r,e))return!0;var n=P[o.filterParam];return-1<I.pluck(r.taxonomy,n).indexOf(e._id)&&(r.score=e.score,!0)})}(e))return!1;if(!function(e){switch(o.courseType){case"live":return e.eventData.hasLiveBroadcasts;case"catalog":return!e.eventData.hasLiveBroadcasts;case"all":return 1}}(e))return!1;if(function(e){switch(o.broadcastStatus){case"onair":return"onair"===e.eventData.type;case"upcoming":return"upcoming"===e.eventData.type;case"all":return 1}}(e)){return!!(!o.allowCategoryFilterUrl||(!o.urlCategory||!(!(e=o.categoriesById[e.primary_category._id||e.primary_category])||e.slug!==o.urlCategory)));return!!void 0}return!1}(e))&&t.addToSet(e,y)})}function u(e,t){return!(E(e,"taxonomy.length")&&"categories"!==o.filterParam||e.primary_category!==t._id&&e.primary_category._id!==t._id)}function v(r){r.score=0,I.any(o.sortedItems,function(e,t){u(r,e)&&(r.score+=e.score||0,"live"===r.broadcast_type&&(r.score+=.1),r.is_container&&(r.score+=.1));var n=P[o.sorting];-1<I.pluck(r.taxonomy,n).indexOf(e._id)&&(r.score+=e.score||0,r.eventData.hasLiveBroadcasts&&(r.score+=.1))})}function y(e,t){e=E(e||{},"eventData._id"),t=E(t||{},"eventData._id");return!(!e||!t||e!==t)}t(),"me"===o.userId&&(b.user.valid()||(o.userId=null),o.userId=b.user._data._id),o.$on("user:login",t),o.$on("user:register",t),o.$watch("filterParam",e),o.allowCategoryFilterUrl&&o.$watch("urlCategory",function(){o.displayedCoursesSet=!1,e()}),o.allowLiveFilterUrl&&(o.displayedCoursesSet=!1,o.$watch("urlBroadcastType",function(){"live"===o.urlBroadcastType?o.courseType="live":o.courseType="all",e()})),r()}}}t.exports=r},{async:21}],941:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("upcomingClasses",e("./directives/index")),r.directive("upcomingClassesCms",e("./directives/cms/view")),r.directive("upcomingClassesCmsEdit",e("./directives/cms/edit")),r.directive("upcomingFrontrow",e("./directives/frontrow")),r.directive("upcomingFrontrowCms",e("./directives/cms/frontrow/view")),r.directive("upcomingFrontrowCmsEdit",e("./directives/cms/frontrow/edit"))},{"../../common/app":70,"./directives/cms/edit":935,"./directives/cms/frontrow/edit":936,"./directives/cms/frontrow/view":937,"./directives/cms/view":938,"./directives/frontrow":939,"./directives/index":940}],942:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/upcoming-event/cms-view.html",scope:{data:"=?"},controllerAs:"upcomingEventCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],943:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService",function(i,o){return{restrict:"AE",scope:{event:"=?"},templateUrl:"/templates/upcoming-event/index.html",controllerAs:"ctrl",controller:["$scope","$attrs",function(t,e){var n=this;function r(){t.event&&(n.event=t.event,o.getEventUIData(n.event).then(function(e){n.course=e}))}"true"===e.watch?t.$watch("event",r):t.event?r():i.user&&i.user.getEvents&&i.user.getEvents().then(function(e){t.event=o.getNearestEvent(e.events),r()})}]}}]},{}],944:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clUpcomingEvent",e("./directives/index")),r.directive("upcomingEventCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/view":942,"./directives/index":943}],945:[function(e,t,n){"use strict";r.$inject=["$sce","$rootScope","$timeout","$location","moment","DataSet","deepval","EventService","CatalogService","categoryResource","ScoresService","broadcastService","_"];var I=e("async"),x={userTopics:"_id",userCategories:"primary_category",categories:"primary_category"};function r(e,b,_,t,w,S,n,E,r,A,k,T,C){return{restrict:"AE",scope:{filterParam:"<",passedFilters:"<filters",channelCount:"<",sorting:"<",broadcastType:"<",broadcastStatus:"<",limit:"<",backfill:"<",showClassCategory:"<",showButton:"<",showAnchorButton:"<",onairTile:"<",upcomingTile:"<",layout:"<",container:"<?",copy:"<",slug:"<",anchorCopy:"<",anchorTarget:"<",clTitle:"<",hideTitle:"<",subtitle:"<",allowCategoryFilterUrl:"<",allowLiveFilterUrl:"<",organizeClasses:"<",userId:"<?"},templateUrl:"/templates/upcoming-events/index.html",replace:!0,link:function(o,t,d){angular.extend(o,{getClass:function(e){return e%3?"col-xs-6 section-secondary":"sm-pad-bottom-m section-primary"},channels:{},allUpcomingEvents:new S,displayedEvents:new S,filters:angular.copy(o.passedFilters),onairTile:o.onairTile||"onair-responsive",upcomingTile:o.upcomingTile||"upcoming-responsive",layout:o.layout||"grid",urlCategoryTitle:"",displayedEventsSet:!1,allowUnfollow:"true"===d.allowUnfollow});var n=new k,r=C.throttle(function(e){{var t;o.allUpcomingEvents&&o.allUpcomingEvents.length&&(l(t=new S),function(e){"live"===o.broadcastType&&e.length<o.limit&&o.backfill&&o.backfill.live&&(o.broadcastType="all",l(e));"onair"===o.broadcastStatus&&e.length<o.limit&&o.backfill&&o.backfill.onair&&(o.broadcastStatus="all",l(e))}(t),angular.forEach(t,v),function(e){"date"===o.sorting&&"upcoming"===o.broadcastStatus?function(e){C.each(e,function(e){var n;C.each(e.swimlanes,function(e){var t=new T;t.setBroadcasts(e.broadcasts),(!n||t.getNextBroadcast()&&n&&n.start_time>=t.getNextBroadcast().start_time)&&(n=t.getNextBroadcast())}),n&&(e.nextBroadcast=n)}),e.sort(function(e,t){return(e.nextBroadcast?e.nextBroadcast.start_time:0)-(t.nextBroadcast?t.nextBroadcast.start_time:0)})}(e):"date"===o.sorting?function(e){function n(e){e=(e.currentBroadcast||e.nextBroadcast||e.prevBroadcast||e).start_time;return e}C.each(e,function(e){var n,r,i;C.each(e.swimlanes,function(e){var t=new T;t.setBroadcasts(e.broadcasts),(!n||t.getNextBroadcast()&&n&&n.start_time>=t.getNextBroadcast().start_time)&&(n=t.getNextBroadcast()),!r&&t.getCurrentBroadcast()&&(r=t.getCurrentBroadcast()),(!i||t.getPrevBroadcast()&&i&&i.start_time<=t.getPrevBroadcast().start_time)&&(i=t.getPrevBroadcast())}),n&&(e.nextBroadcast=n),r&&(e.currentBroadcast=r),i&&(e.prevBroadcast=i)}),e.sort(function(e,t){return n(e)-n(t)})}(e):"userCategories"!==o.sorting&&"userTopics"!==o.sorting||function(e){e.sort(function(e,t){var n=w.unix(e.start_time).tz(a),r=w.unix(t.start_time).tz(a),i=w().tz(a);return n.diff(i,"days")<0&&(n=i),r.diff(i,"days")<0&&(r=i),0!==(i=n.diff(r,"days"))?i:t.score-e.score})}(e)}(t),function(e){var r,i;o.organizeClasses&&""!==o.organizeClasses&&(r={},i=[],C.each(e,function(e){e.nextBroadcast&&(e.start_time=e.nextBroadcast.start_time);var t=w.unix(e.start_time).tz(a).format(o.organizeClasses),n=[];-1!==t.indexOf(",")&&(n=t.split(", ")),r[t]?r[t].events.push(e):(r[t]={label:t,parts:n,events:[e]},i.push(r[t]))}),o.periods=i)}(t),"all"!==o.limit&&(t=t.splice(0,parseInt(o.limit))),o.displayedEvents.clear(),angular.forEach(t,function(e){o.displayedEvents.addToSet(e,y)}),o.displayedEvents.length||(o.displayedEventsSet=!0))}angular.isFunction(e)&&e()},300,{leading:!1}),a="America/Los_Angeles";function i(e){var t=[];e?(angular.forEach(o.categories,function(e){e.upcoming=[]}),t.push(s)):t.push(p,h,s),t.push(m,r,f),I.series(t,function(e){o.ready=!0,o.$applyAsync()})}function e(){try{var e=b.user.valid()&&b.user.get("timezone");angular.isString(e)&&(a=e)}catch(e){}}function f(e){var t=0,n=Math.round(Date.now());C.each(o.displayedEvents,function(e){e.currentBroadcast&&(!t||e.currentBroadcast.end_time<t)&&(t=e.currentBroadcast.end_time)}),n/1e3<t&&(n=1e3*t-n+1e3,_(i.bind(this,!0),n)),e()}function p(t){A.get().$promise.then(function(e){o.categories=e.data,angular.forEach(o.categories,function(e){e.upcoming=[]}),u()&&(o.sortedChannels=n.getSortedCategories(e.data),o.channels=C.indexBy(o.sortedChannels,function(e){return e.title})),t()})}function h(t){var e;"userTopics"===o.filterParam?n.fetchFilteredTopics(function(e){o.filters=e,t()}):("userCategories"===o.filterParam?(e=o.sortedChannels.slice(0,o.channelCount),o.filters=C.filter(e,function(e){return e.score}),0===o.filters.length&&(o.filters=o.sortedChannels,C.each(o.filters,function(e){e.score=6-e.order}))):o.filters||(o.filters=[],C.each(o.categories,function(e){o.filters.push(e)})),t())}function s(t){"userTopics"===o.sorting?n.fetchFilteredTopics(function(e){o.sortedItems=e,0===o.sortedItems.length&&(o.sorting="userCategories",C.each(o.channels,function(e){e.score=6-e.order,o.sortedItems.push(e)})),t()}):("userCategories"===o.sorting&&(o.sortedItems=o.sortedChannels),t())}function m(t){var e,n;"userTopics"!==o.filterParam||o.filters.length?(e=E.get,n={date:w().tz(a).startOf("hour").unix(),sort:"start_time",time:"end_time",when:"after",limit:200},o.userId&&(e=b.user.getEvents,n={limit:100,userId:o.userId,upcoming:!0,populate:"instructors"}),e(n).then(function(e){e=e&&e.data||e.events||e;E.organizeEventsForCalendar(e,function(e){c(e.onair),c(e.upcoming),t()})})):t()}function c(e){angular.forEach(e,function(e){if(E.isEventOnCalendar(e)&&o.allUpcomingEvents.push(e),u()){var t=E.getEventCategory(e);if(!(t=t?t.title:""))try{t=e.content.content_id.primary_category.title}catch(e){}o.channels&&t&&((t=o.channels[t])&&t.upcoming&&t.upcoming.push(e))}})}function u(){return"userTopics"===o.filterParam||"userCategories"===o.filterParam||"userTopics"===o.sorting||"userCategories"===o.sorting}function l(t){angular.forEach(o.allUpcomingEvents,function(e){(!o.filterParam&&!o.urlCategory||function(e){if(!function(r){if(o.filterParam&&-1<Object.keys(x).indexOf(o.filterParam))return C.any(o.filters,function(e){if(g(r,e))return!0;var t=x[o.filterParam],n=E.getEventTaxonomy(r);return-1<C.pluck(n,t).indexOf(e._id)&&(r.score=e.score,!0)})}(e))return!1;if(!function(e){switch(o.broadcastType){case"live":return e.hasLiveBroadcasts;case"catalog":return!e.hasLiveBroadcasts;case"all":return 1}}(e))return!1;if(function(e){switch(o.broadcastStatus){case"onair":return"onair"===e.type;case"upcoming":return"upcoming"===e.type;case"all":return 1}}(e)){return!!(!o.allowCategoryFilterUrl||(!o.urlCategory||!(!(e=E.getEventCategory(e))||e.slug!==o.urlCategory)));return!!void 0}return!1}(e))&&t.addToSet(e,y)})}function g(e,t){if(!E.getEventTaxonomy(e).length||"categories"===o.filterParam){e=E.getEventCategory(e);if(e===t._id||e&&e._id===t._id)return 1}}function v(r){r.score=0,C.any(o.sortedItems,function(e){g(r,e)&&(r.score+=e.score||0,r.currentBroadcast&&"live"===r.currentBroadcast.broadcast_type&&(r.score+=.1),r.is_container&&(r.score+=.1));var t=x[o.sorting],n=E.getEventTaxonomy(r);-1<C.pluck(n,t).indexOf(e._id)&&(r.score+=e.score||0,r.hasLiveBroadcasts&&(r.score+=.1))})}function y(e,t){e=e._id,t=t._id;return e&&t&&e===t}e(),"me"===o.userId&&(b.user.valid()||(o.userId=null),o.userId=b.user._data._id),o.$on("user:login",e),o.$on("user:register",e),o.$watch("filterParam",r),o.allowCategoryFilterUrl&&o.$watch("urlCategory",function(){o.displayedEventsSet=!1,r()}),o.allowLiveFilterUrl&&(o.displayedEventsSet=!1,o.$watch("urlBroadcastType",function(){"live"===o.urlBroadcastType?o.broadcastType="live":o.broadcastType="all",r()})),i()}}}t.exports=r},{async:21}],946:[function(e,t,n){"use strict";e("../../common/app").directive("upcomingEvents",e("./directives/index"))},{"../../common/app":70,"./directives/index":945}],947:[function(e,t,n){"use strict";function r(a,s,c,u,l){return{scope:{onFocus:"&?",onSubmit:"&?",btnText:"@?",redirect:"<?",onBack:"&?",showMarketingOptin:"@?",email:"@?"},transclude:{heading:"?heading","button-text":"?buttonText","password-label":"?passwordLabel","password-confirm-label":"?passwordConfirmLabel"},templateUrl:function(e,t){return t.template?"/templates/update-password/"+t.template+".html":"/templates/update-password/main.html"},controllerAs:"ctrl",controller:["$scope","$attrs",function(n,e){var r=this,i=e.type||null;function t(e){var t;o()&&!r.pending&&(r.pending=!0,r.loading=!0,r.success=null,t={id:(t=a()).u,token:t.t,password:r.password,password2:r.confirmPassword},i&&(t.type=i),s.user.Auth.updatePassword(t).then(function(){var t;r.success="Your Password has been reset.",t=e,c.findById({id:a().u},function(e){s.user.Auth.login({email:e.data.user.primary_email.address,password:r.password,profile:s.user.get("profile")}).then(function(){return n.showMarketingOptin?s.user.setNotifications("me",{class_reminders:!!r.isMarketingOptin,marketing:!!r.isMarketingOptin,notifications:!!r.isMarketingOptin,optout:!r.isMarketingOptin,partner:!!r.isMarketingOptin,special_offers:!!r.isMarketingOptin,upcoming_classes:!!r.isMarketingOptin}):l.resolve()}).then(function(){angular.isFunction(t)&&t(),u.history.pushState(null,null,u.location.pathname),r.redirect&&(u.location="/")}).catch(function(){angular.isFunction(t)&&t(),r.redirect&&(u.location="/settings/login")})})}).catch(function(){r.error="There was a problem resetting your password, try requesting the password reset email again."}).finally(function(){r.submitted=!0,r.loading=!1,r.pending=!1}))}function o(){return r.error=null,!(!r.password||!r.confirmPassword)&&(r.password!==r.confirmPassword?!(r.error="The passwords don't match."):!(r.password.length<=7)||!(r.error="Passwords must be at least 8 characters."))}angular.extend(r,{onSubmit:function(){if(!angular.isFunction(n.onSubmit))return t();t(n.onSubmit)},onFocus:function(){angular.isFunction(n.onFocus)&&n.onFocus()},validatePasswords:o,pending:!1,loading:!1,error:null,success:null,submitted:!1,redirect:n.redirect,isMarketingOptin:!0})}]}}r.$inject=["parseQS","$rootScope","UserResource","$window","$q"],t.exports=r},{}],948:[function(e,t,n){"use strict";e("../../common/app").directive("updatePassword",e("./directive"))},{"../../common/app":70,"./directive":947}],949:[function(e,t,n){"use strict";t.exports=["UserResource","$rootScope","$routeParams","$filter","$timeout","_","Vault",function(u,l,d,f,p,h,m){return{restrict:"EA",templateUrl:"/templates/user-notifications/view.html",replace:!0,scope:{update:"=?",userId:"@",hideSave:"@"},link:function(n,e,t){angular.extend(n,{ready:!1,notificationOptions:[{key:"upcoming_classes",title:f("i18n")("cl-notifications-upcoming_classes-title","Upcoming Classes"),description:f("i18n")("cl-notifications-upcoming_classes-description","Emails about upcoming classes."),default:!0},{key:"special_offers",title:f("i18n")("cl-notifications-special_offers-title","Special Offers"),description:f("i18n")("cl-notifications-special_offers-description","We'll let you know when classes go on sale."),default:!0},{key:"notifications",title:f("i18n")("cl-notifications-notifications-title","Notifications"),description:f("i18n")("cl-notifications-notifications-description","Notifications about activity related to you."),default:!0},{key:"class_reminders",title:f("i18n")("cl-notifications-class_reminders-title","Class Reminders"),description:f("i18n")("cl-notifications-class_reminders-description","Reminder emails for classes you've RSVP'd to."),default:!0},{key:"partner",title:f("i18n")("cl-notifications-partner-title","Special Offers from Partners"),description:f("i18n")("cl-notifications-partner-description","Partner promotions"),default:!0}],optoutButton:{key:"optout",title:f("i18n")("cl-notifications-optout-title","Global Unsubscribe"),description:f("i18n")("cl-notifications-optout-description","Unsubscribe from all emails."),default:!1},email:void 0,notifications:{},initialize:i,hasChanges:function(){return!angular.equals(n.master,n.notifications)},onChange:function(e){"optout"===e?(n.notifications.optout=!n.notifications.optout,angular.forEach(n.notifications,function(e,t){"optout"!==t&&(n.notifications[t]=!1)}),o()):(n.notifications.optout=!1,n.hideSave&&o())},update:o,showAlert:c,closeAlert:function(){n.alert=null}}),n.validKeys=h.pluck(n.notificationOptions,"key"),n.validKeys.push("optout");var r=n.$watch("userId",i);function i(){var e=a();e&&(n.email=m.Cookie.get("iterableEndUserId")),n.userId&&(u.getNotifications({userId:n.userId,email:n.email,hash:e}).$promise.then(function(e){n.notifications=e.data||{},h.each(n.notifications,function(e,t){-1===h.indexOf(n.validKeys,t)&&(n.notifications[t]=void 0)}),h.each(n.notificationOptions,function(e){void 0===n.notifications[e.key]&&(n.notifications[e.key]=e.default)}),s(n.notifications),n.ready=!0},function(e){c("Loading settings failed - please try again later","danger")}),r())}function o(){n.status="updating";var e=a();e&&(n.email=m.Cookie.get("iterableEndUserId")),u.setNotifications({userId:n.userId,email:n.email,hash:e},n.notifications).$promise.then(function(e){s(e&&e.data),n.status="updated",p(function(){n.status=void 0},1e3)},function(e){c("Failed to update notifications","danger"),n.status=void 0})}function a(){return d.hash||(l.routeParams||{}).hash}function s(e){n.master=angular.copy(e)}function c(e,t){n.alert={type:t,message:e,show:!0}}}}}]},{}],950:[function(e,t,n){"use strict";e("../../common/app").directive("userNotifications",e("./directives/index"))},{"../../common/app":70,"./directives/index":949}],951:[function(e,t,n){"use strict";t.exports=["$rootScope","RecommendationsService",function(r,i){return{restrict:"EA",templateUrl:"/templates/user-recommendations/view.html",replace:!0,scope:{sort:"@?sortBy",categoryid:"@?",countTopics:"@?",category:"@?",categories:"@?",topics:"@?",courseid:"@?",limit:"@?"},link:function(t,e){var n={userid:r.user.get("_id"),sort:t.sort,category:t.category,categoryid:t.categoryid,categories:t.categories,topics:t.topics,courseid:t.courseid,countTopics:t.countTopics,limit:t.limit};i.getPopularRecommendations(n).then(function(e){t.recommendations=e},function(e){})}}}]},{}],952:[function(e,t,n){"use strict";e("../../common/app").directive("userRecommendations",e("./directives/index"))},{"../../common/app":70,"./directives/index":951}],953:[function(e,t,n){"use strict";var s=e("moment");t.exports=["$rootScope","categoryResource","ScoresService",function(e,t,a){return{restrict:"EA",templateUrl:"/templates/user-scores/view.html",replace:!0,scope:{user:"=?"},link:function(t,e,n){angular.extend(t,{updateScores:function(){r.patchScores(o)},getVersion:function(){return r.getScores()?r.getScores().version:""},getTime:function(){return r.getScores()?s.unix(r.getScores().timestamp).format("YYYY/MM/DD h:mm:ss a"):""},limit:5});var r=new a,i=("true"===n.disableEngagementScores&&r.disableEngagementScores(),t.$watch("user._id",function(){t.user&&t.user._id&&(i(),r.setUser(t.user),o())}));function o(){r.fetchSortedCategories("cltv",function(e){t.categories=e}),r.fetchFilteredTopics(function(e){t.topics=e}),r.fetchFilteredInstructors(function(e){t.instructors=e})}}}}]},{moment:void 0}],954:[function(e,t,n){"use strict";e("../../common/app").directive("userScores",e("./directives/index"))},{"../../common/app":70,"./directives/index":953}],955:[function(e,t,n){"use strict";function r(e,i,o){return{restrict:"AE",templateUrl:"/templates/user-subscriptions/view.html",scope:{headerClass:"@?",headerTitle:"@?",useContentTemplate:"@?"},link:function(t,e,n){var r=-1<Object.keys(n).indexOf("adminOnly"),n=(t.headerTitle||(t.headerTitle="Subscriptions"),t.useContentTemplate||(t.useContentTemplate=!1),{});r&&(n.admin=!0),i.getSubscriptionsByUser(n).then(function(e){t.subscriptions=o.map(e,function(e){var t;return o.extend(e,{url:(r?"/teams/admin/":"/team/")+e.slug,displayName:(t=(e=e).subscriptionPlan)?t.short_title||t.title:e.name})})})}}}r.$inject=["$rootScope","SubscriptionService","_"],t.exports=r},{}],956:[function(e,t,n){"use strict";e("../../common/app").directive("userSubscriptions",e("./directives/index"))},{"../../common/app":70,"./directives/index":955}],957:[function(e,t,n){"use strict";t.exports=["courses","config",function(r,i){return{restrict:"AE",scope:{},templateUrl:"/templates/vertical-featured/edit.html",replace:!0,link:function(t,e,n){t.data=t.$parent.data,t.setCourse=function(e){r.getComplete({slug:e.slug},function(e){delete t.data.course,t.data.slug=e.data.slug,t.data.title=e.data.short_title,t.data.url="/courses/"+e.data.slug,t.data.image={file:e.data.image.file}})},t.config=i,t.onUpload=function(e){t.data.image={file:e}}}}}]},{}],958:[function(e,t,n){"use strict";t.exports=["$sce","config",function(i,o){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/vertical-featured/view.html",replace:!0,link:function(e,t,n){function r(){i.trustAsResourceUrl(e.data.courseUrl),i.trustAsResourceUrl(e.image)}e.config=o,e.data||(e.data=e.$parent.data),e.data&&r(),void 0!==e.$parent.edit&&e.$watch("data.image",r)}}}]},{}],959:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("verticalFeatured",e("./directives/view")),r.directive("verticalFeaturedEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":957,"./directives/view":958}],960:[function(e,t,n){"use strict";var c=e("underscore");t.exports=["$sce","config","courses","instructor","category","urlify",function(e,i,o,t,a,s){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/vertical-search/edit.html",replace:!0,link:function(n,e,t){n.data||(n.data=n.$parent.data),angular.extend(n,{config:i,setCourse:function(e){o.getComplete({slug:e.slug},function(e){e.data&&(n.data.course={title:e.data.short_title,instructors:c.deepOmit(e.data.instructors,"courses profile.bio profile.short_bio"),slug:"/courses/"+e.data.slug},n.data.image=e.data.image.file.key,a.findBySlug({slug:e.data.primary_category.slug},function(e){n.vertical=e.data}))})},vertical:{}}),n.$watch("data.customLinkURL",function(e,t){n.data.customLinkURL=e?s(e):void 0});var r=!0;n.$watch("vertical",function(e){!r&&e&&(n.data.vertical={_id:e._id,slug:e.slug,title:e.title},e.slug?n.data.actionUrl="/catalog/"+e.slug:n.data.actionUrl="/catalog/all"),r=!1}),n.data.vertical&&(n.vertical=n.data.vertical)}}}]},{underscore:void 0}],961:[function(e,t,n){"use strict";t.exports=["$sce","config",function(r,i){return{restrict:"AE",scope:{data:"=?"},templateUrl:"/templates/vertical-search/view.html",replace:!0,link:function(t,e,n){t.config=i,t.data||(t.data=t.$parent.data),t.$watch("data.actionUrl",function(){var e;t.data&&t.data.actionUrl&&(e=t.data.actionUrl,t.actionUrl=r.trustAsResourceUrl(e))})}}}]},{}],962:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("verticalSearch",e("./directives/view")),r.directive("verticalSearchEdit",e("./directives/edit"))},{"../../common/app":70,"./directives/edit":960,"./directives/view":961}],963:[function(e,t,n){"use strict";t.exports=["$rootScope",function(n){return{restrict:"AE",scope:{lesson:"<?",course:"<?"},templateUrl:"/templates/video-player/featured-lesson.html",link:function(e,t){angular.extend(e,{showFeaturedLesson:!0}),e.$watch("lesson.playable",function(){e.lesson.playable&&t.one("click",function(){n.$broadcast("video:send-command","play")})}),e.$on("video:event:play",function(){e.showFeaturedLesson=!1})}}}]},{}],964:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",replace:!0,templateUrl:"/templates/video-player/fullscreen.html",scope:{container:"="},controller:["$scope","$document",function(n,e){var t=e[0],r=n.container;e.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){var e="fullscreen",t=r[0];n.isFullScreen()?t.classList?t.classList.add(e):t.className+=" "+e:t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}),n.isFullScreen=function(){return t.fullScreen||t.webkitIsFullScreen||t.mozFullScreen||t.msFullscreenElement},n.toggleFullScreen=function(){n.isFullScreen()?t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.mozExitFullScreen?t.mozExitFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.msExitFullscreen&&t.msExitFullscreen():r[0].requestFullscreen?r[0].requestFullscreen():r[0].webkitRequestFullscreen?r[0].webkitRequestFullscreen():r[0].mozRequestFullScreen?r[0].mozRequestFullScreen():r[0].msRequestFullscreen&&r[0].msRequestFullscreen()}}]}}},{}],965:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",scope:{ctrl:"="},replace:!0,templateUrl:function(e,t){return t.template?"/templates/"+t.template+".html":"/templates/video-player/index.html"},link:function(n,r){n.$on("ustream:ready",function(e,t){t.addListener("playing",function(e,t){t?r.addClass("video-playing"):r.removeClass("video-playing")})}),n.$on("video:event",function(e,t){n.playState=t,n.$applyAsync()}),n.$on("panel:event",function(e,t){"open"===t?r.addClass("panel-open"):r.removeClass("panel-open")}),r.ready(function(){n.$broadcast("video:register-command",["on","play",function(){r.addClass("video-playing")}]),n.$broadcast("video:register-command",["on","pause",function(){r.removeClass("video-playing")}])})},controller:["$scope","$element",function(e,t){e.element=t}]}}},{}],966:[function(e,t,n){"use strict";t.exports=["$interval",function(a){return{restrict:"AE",replace:!0,templateUrl:"/templates/video-player/interstitial.html",scope:{ctrl:"=",posterUrl:"@"},link:function(e,t,n){var r;function i(){!e.ctrl.displayCountDown&&e.ctrl.hasAccess&&e.ctrl.nextSegment?e.ctrl.playNextSegment():e.ctrl.playSegment(e.ctrl.currentSegment),e.ctrl.displayCountDown=!1,a.cancel(r)}function o(){e.sec--,0===e.sec&&i()}angular.extend(e,{sec:5,onPlay:i,state:"open"===n.initialState}),(e.ctrl.hasAccess&&e.ctrl.nextSegment||e.ctrl.displayCountDown)&&(r=a(function(){o()},1e3),o())},controller:["$scope","$element",function(e,t){e.container=angular.element(t[0].querySelector(".panel-segment"))}]}}]},{}],967:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"/templates/video-player/overlay.html"}}},{}],968:[function(e,t,n){"use strict";t.exports=["$window",function(r){return{restrict:"AE",replace:!0,scope:{posterUrl:"@",currentBroadcast:"=?"},templateUrl:"/templates/video-player/perfect-timing.html",link:function(e){function t(){e.showPerfectTiming=!0}function n(){e.showPerfectTiming=!1}t(),e.onClick=function(){e.currentBroadcast&&e.currentBroadcast.conference?r.location=e.currentBroadcast.conference.url:(e.$emit("video:stream:play"),n())},e.$on("perfect-timing:show",t),e.$on("perfect-timing:hide",n)}}}]},{}],969:[function(e,t,n){"use strict";t.exports=["$filter",function(i){return{scope:{posterUrl:"=?",alt:"=?",course:"=?",currentBroadcast:"=?",streamId:"=?",height:"@",width:"@",autoplay:"@?",autoplayVolume:"@?"},replace:!0,templateUrl:"/templates/video-player/dynamic.html",link:function(r){function n(e){r.thumbnail=i("magick")(e.posterUrl,{raw:!0});var t=e.segment||{},n=e.media||t.media&&t.media[0]||{};r.videoTitle=e.title||t.title,r.duration=e.duration||n.duration,r.created=n.created,r.streamId=e.streamId,r.$applyAsync()}r.height=r.height||300,r.width=r.width||1600,r.$on("video:reset",function(e,t){r.$broadcast("videojs:reset"),r.$broadcast("video:stream:pause"),r.$broadcast("perfect-timing:show")}),r.$on("video:exitFullscreen",function(){var t=!1;["webkitExitFullscreen","exitFullscreen","mozExitFullScreen","mozCancelFullScreen"].forEach(function(e){document[e]&&(document[e](),t=!0)}),t||(document.getElementsByTagName("video")[0]&&document.getElementsByTagName("video")[0].webkitExitFullScreen(),r.$broadcast("video:stream:stop"))}),r.$on("video:show-poster",function(e,t){r.playState=""}),r.$on("video:stream",function(e,t){r.playState="stream",n(t)}),r.$on("video:queue",function(e,t){r.playState="video",n(t)}),r.$on("video:send-command",function(){r.playState="video"}),r.$emit("videojs-player:ready-for-event-promo")}}}]},{}],970:[function(e,t,n){"use strict";t.exports=["$rootScope","mediaResource","trackFactory","_",function(e,t,i,n){return{restrict:"AE",scope:{autoplay:"=?",mediaId:"@",videoPlayerId:"@",posterUrl:"@?",playUrl:"=?"},templateUrl:"/templates/video-player/lesson-player.html",link:function(r,e){r.isVideoPlayerReady=!1,r.isMediaReady=!1,r.playUrl?r.isMediaReady=!0:r.mediaId&&r.mediaId.match(/^[0-9a-fA-F]{24}$/)&&t.tokenById({id:r.mediaId},function(e){e.success&&(r.playUrl=e.data.playUrl,r.isMediaReady=!0)}),r.$on("video:event:play",function(e,t,n){r.videoPlayerId===n.playerId&&i.playLessonPlayer(n)}),r.$watchCollection("[isVideoPlayerReady, isMediaReady]",function(e){n.every(e,function(e){return!0===e})&&(r.$broadcast("video:queue",{playUrl:r.playUrl,posterUrl:r.posterUrl,playerId:r.videoPlayerId,media_id:r.mediaId}),r.autoplay&&r.$broadcast("video:send-command","play"))}),r.$on("videojs:ready",function(e,t,n){n.id_===r.videoPlayerId&&(r.isVideoPlayerReady=!0)})}}}]},{}],971:[function(e,t,n){"use strict";var u=e("underscore");e("../../vendor/ustream-embedapi"),t.exports=["$window","$timeout","trackFactory",function(a,s,c){return{scope:{playerId:"@",posterUrl:"=?",currentBroadcast:"=?",thumbnail:"=?",videoTitle:"=?",duration:"=?",autoplay:"@",html5Ui:"@",controls:"@",streamId:"@",autoplayVolume:"@?"},templateUrl:"/templates/video-player/ustream.html",link:function(n,t,e){var r;function i(e,t){t?(n.$emit("video:stream:play-watch-counter"),c.playVideo()):(n.$emit("video:stream:pause-watch-counter"),c.pauseVideo())}function o(e){r&&r.callMethod(e)}angular.extend(n,{playerId:n.playerId||"ustreamVideoPlayer",autoplay:n.autoplay||"true",html5Ui:n.html5Ui||!0,controls:n.controls||!0,volume:!isNaN(parseFloat(n.autoplayVolume))&&n.autoplay?n.autoplayVolume:e.volume||60,showTitle:n.showTitle||!1,width:e.width||"100%",height:e.height||300,streamId:null,init:function(){var e=t[0].querySelector("iframe");s(function(){try{(r=a.UstreamEmbed(e))&&(n.$emit("ustream:ready",r),r.addListener("playing",i))}catch(e){}})}}),n.params={autoplay:n.autoplay,controls:n.controls,showtitle:n.showTitle,volume:n.volume},n.html5Ui&&(n.params.html5ui=1),n.$on("video:stream",function(e,t){n.autoplay=t.autoplay||!1,n.params.autoplay=n.autoplay,n.streamId=t.streamId,r&&r.callMethod("load","channel",t.streamId)}),n.$on("video:stream:play",u.bind(o,self,"play")),n.$on("video:stream:pause",u.bind(o,self,"pause")),n.$on("video:stream:stop",u.bind(o,self,"stop")),n.playerLoaded=!1,t.ready(function(){s(function(){n.playerLoaded=!0})})}}}]},{"../../vendor/ustream-embedapi":979,underscore:void 0}],972:[function(e,t,n){"use strict";r.$inject=["gangesSessionService","config","$rootScope","$sce","$filter","$timeout","trackFactory"];var h=e("@creativelive/video.js");function r(o,u,l,d,e,f,p){return{restrict:"AE",scope:{playerId:"@",posterUrl:"=",thumbnail:"=",videoTitle:"=",duration:"=",playUrl:"=?",onReady:"&",noVideoConfig:"@?",preload:"@?"},templateUrl:"/templates/video-player/videojs.html",replace:!0,link:function(a,e,t){a.playUrl=void 0,a.width=t.width||"100%",a.height=t.height||300,t=void 0===a.noVideoConfig,a.preload||(a.preload="metadata");var s,c,n=u.videoUsage,r=(angular.extend(n.api||{},{keyFunc:o.getToken,url:n.api.url}),{});function i(e,t){if(!s)return!0;var n=(t=angular.isArray(t)?t:[t]).shift(),n=s[n];try{n.apply(s,t)}catch(e){}}u.videoUsage.enabled&&t&&(r.videoUsage={config:n}),f(function(){e.ready(function(){s=h(a.playerId,{techOrder:["html5","flash"],plugins:r}),l.$broadcast("videojs:ready","ready",s),a.$on("videojs:reset",function(e,t){s.pause().currentTime(0).trigger("loadstart")}),s.poster(a.posterUrl),s.on("ended",function(e){p.videoEnded(),l.$broadcast("video:event","ended",c)}),s.on("play",function(e){p.playVideo(),l.$broadcast("video:event","play",c),l.$broadcast("video:event:play","play",c)}),s.on("pause",function(e){p.pauseVideo(),l.$broadcast("video:event:pause",{currentVideo:c,e:e})}),s.on("timeupdate",function(e){l.$broadcast("video:event:timeupdate",{currentVideo:c,e:e})}),s.on("canplay",function(e){a.lastWatchTime&&(s.currentTime(a.lastWatchTime),s.posterImage.hide(),a.lastWatchTime=void 0)}),s.on("error",function(e){var t;s.error_&&(t=new Error(s.error_.code+" "+s.error_.message),window.newrelic&&window.newrelic.noticeError(t))}),a.$emit("videojs-player:ready-for-event-promo");try{a.onReady()(s)}catch(e){}})}),a.$on("video:queue",function(e,t){if(c=t,a.playUrl=c.playUrl,s){if(s.trigger({type:"video-queued",data:c.segment}),c.posterUrl&&s.poster(c.posterUrl),t.currentTime&&(a.lastWatchTime=t.currentTime),!h.IS_FIREFOX){var n=t.segment;if(s&&n){t=s.textTracks();if(t&&0<t.length){var r=[];angular.forEach(t,function(e){r.push(e)}),angular.forEach(r,function(e){s.removeRemoteTextTrack(e)});try{s.controlBar.subtitlesButton.hide()}catch(e){}}if(n.media)for(var i=0;i<n.media.length;i++){var o=n.media[i];if(o&&o.captions&&o.captions.key){s.addRemoteTextTrack({kind:"subtitles",src:"https://"+u.cdn.captions+"/"+o.captions.key,language:"en",label:o.captions.label||"English",default:!1});break}}}}s.src({type:"video/mp4",src:d.trustAsResourceUrl(a.playUrl)})}}),a.$on("video:register-command",i),a.$on("video:send-command",i)}}}e("@creativelive/videojs-video-usage"),t.exports=r},{"@creativelive/video.js":18,"@creativelive/videojs-video-usage":20}],973:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"/templates/video-player/side-panel.html",scope:{segmentsCount:"@"},link:function(n,e,t){n.state="open"===t.initialState,n.$on("video:send-command",function(e,t){"play"===t&&(n.state=!1)}),n.$on("video:stream",function(e,t){n.state=!1}),n.$watch("state",function(e){n.$emit("panel:event",n.state?"open":"close")})},controller:["$scope","$element",function(e,t){e.container=angular.element(t[0].querySelector(".side-panel-content"))}]}}},{}],974:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"A",link:function(n,r){n.$on("ustream:ready",function(e,t){t.addListener("playing",function(e,t){t?r.addClass("video-playing"):r.removeClass("video-playing")})}),n.$on("video:event",function(e,t){n.playState=t,n.$applyAsync()}),n.$on("panel:event",function(e,t){"open"===t?r.addClass("panel-open"):r.removeClass("panel-open")}),r.ready(function(){n.$broadcast("video:register-command",["on","play",function(){r.addClass("video-playing")}]),n.$broadcast("video:register-command",["on","pause",function(){r.removeClass("video-playing")}])})}}}},{}],975:[function(e,t,n){"use strict";function r(o,a,s,e){return{restrict:"AE",templateUrl:"/templates/video-player/swimlanes.html",replace:!0,$scope:{event:"=",showChatButton:"="},link:function(r,e,t){var n=r.$watch("event",function(e){e&&(o.getEventById(r.event._id).then(function(e){r.event=e,r.videoPlayer=a.getVideoPlayer(r.event._id),r.videoPlayer||(r.videoPlayer=a.addVideoPlayer(r.event._id,r.$parent)),r.event.swimlanes&&(r.event.swimlanes.forEach(i),r.select(0))}),n(),r.leonHeaderInformation={},r.showChatButton="true"===r.showChatButton||!1,r.event&&angular.extend(r.leonHeaderInformation,{swimlaneTitle:c(r.event.swimlanes[0]),type:"conference",title:r.event.title}))});function i(t){var n=new s({onBroadcastStart:function(e){n.getUpdatedData().then(function(e){t.course=e.currentBroadcast,t.nextCourse=e.nextBroadcast,t.prevCourse=e.prevBroadcast,r.$applyAsync()})}});n.setBroadcasts(t.broadcasts)}},controller:["$rootScope","$scope","rind","$timeout",function(t,n,e,r){n.isMobile=e.context.ua.mobile,n.$on("videoplayer-toggleChatModal",function(e,t){e.preventDefault(),n.showChatButton=t}),n.$watch("videoPlayer.broadcasts.currentBroadcast",function(){n.isBroadcasting=i(n.videoPlayer),n.isLive=function(e){if(!e||!e.broadcasts||!e.broadcasts.currentBroadcast)return!1;e=e.broadcasts.currentBroadcast.broadcast_type;return"live"===e||"pre_live"===e}(n.videoPlayer)}),n.select=function(e){n.current=n.event.swimlanes[e],n.videoPlayer.broadcasts.setBroadcasts(n.current.broadcasts),t.$broadcast("swimlane:select",{index:e,swimlane:n.current,event:n.event,video:n.videoPlayer}),r(function(){i(n.videoPlayer)?(t.$broadcast("video-chat:is-currently-broadcasting",!0),t.$broadcast("video-chat:channel-switch",{channel:n.channelTitle(),currentVideoItem:function(e){if(!e||!e.broadcasts||!e.broadcasts.currentBroadcast)return{};var e=e.broadcasts.currentBroadcast,t=e.content,e={source:{eventId:e.eventId,contentType:t.content_type,contentId:t.content_id},startTime:e.start_time};"course"===t.content_type&&(e.source.course=t.content_id);return e}(n.videoPlayer)})):t.$broadcast("video-chat:is-currently-broadcasting",!1),n.leonHeaderInformation.swimlaneTitle=c(n.current)})},n.channelTitle=function(){return[n.event.title,n.current.name].reduce(function(e,t,n){t=t?t.toLowerCase().replace(/[^a-zA-Z0-9-_]/g,"-"):"";return 0===n?t:e+"-"+t},"")}}]}}function i(e){if(!e||!e.broadcasts||!e.broadcasts.currentBroadcast)return!1;e=e.broadcasts.currentBroadcast.broadcast_type;return"live"===e||"pre_live"===e||"rebroadcast"===e||"playlist"===e}function c(e){var t=e.name;return e.course&&(t+=" - "+e.course.short_title),t}r.$inject=["EventService","videoPlayerFactory","broadcastService","$rootScope"],t.exports=r},{}],976:[function(e,t,n){"use strict";t.exports=["$rootScope",function(n){return{restrict:"AE",scope:{text:"="},templateUrl:"/templates/video-player/play-cta.html",link:function(e,t){angular.extend(e,{showPlayCta:!0}),t.one("click",function(){n.$broadcast("video:send-command","play")}),e.$on("video:event:play",function(){e.showPlayCta=!1})}}}]},{}],977:[function(e,t,n){"use strict";t.exports=["$sce","qs","ustreamUrl",function(n,r,i){return function(e,t){e=i+e;return t&&angular.isObject(t)&&(e+=r.stringify(t)),n.trustAsResourceUrl(e)}}]},{}],978:[function(e,t,n){"use strict";var r=e("../../common/app");r.factory("ustreamUrl",["config",function(e){return e.hostname.protocol+"://www.ustream.tv/embed/"}]),r.directive("videoPlayer",e("./directives/index")),r.directive("videoPlayerStates",e("./directives/states")),r.directive("videoPlayerOverlay",e("./directives/overlay")),r.directive("videoPlayerFullscreen",e("./directives/fullscreen")),r.directive("videoPlayerSidePanel",e("./directives/side-panel")),r.directive("videoPlayerPerfectTiming",e("./directives/perfect-timing")),r.directive("videoPlayerFeaturedLesson",e("./directives/featured-lesson")),r.directive("videoPlayerPlayCta",e("./directives/videoPlayerCta")),r.directive("videoPlayerInterstitial",e("./directives/interstitial")),r.directive("videoPlayerSwimlanes",e("./directives/swimlanes")),r.directive("videoPlayerVideojs",e("./directives/players/videojs")),r.directive("videoPlayerUstream",e("./directives/players/ustream")),r.directive("videoPlayerDynamic",e("./directives/players/dynamic")),r.directive("lessonPlayer",e("./directives/players/lesson-player")),r.filter("ustreamEmbedUrl",e("./filters/ustreamEmbedUrl"))},{"../../common/app":70,"./directives/featured-lesson":963,"./directives/fullscreen":964,"./directives/index":965,"./directives/interstitial":966,"./directives/overlay":967,"./directives/perfect-timing":968,"./directives/players/dynamic":969,"./directives/players/lesson-player":970,"./directives/players/ustream":971,"./directives/players/videojs":972,"./directives/side-panel":973,"./directives/states":974,"./directives/swimlanes":975,"./directives/videoPlayerCta":976,"./filters/ustreamEmbedUrl":977}],979:[function(e,t,n){arguments[4][464][0].apply(n,arguments)},{dup:464}],980:[function(e,t,n){"use strict";e("../../common/app").service("WatchProgressService",e("./services/index"))},{"../../common/app":70,"./services/index":981}],981:[function(e,t,n){"use strict";t.exports=["$rootScope","$interval","$window","PipelineService","videoPlayerCollection",function(d,i,n,u,l){var f,p,o,m=5e3,r=3e4,h=3e3,a=v.throttle(function(e){s(e)},100,{leading:!0});return{init:function(e){var t;e?l.getVideoPlayer(e).then(function(e){var i,t;e=e,"undefined"!=typeof Vault&&(i=Vault.Local.get("watchProgress")||{},p=0,o=o||new g(function(){s(i)},r),t=v.bind(c,{},i),e.on(e.events.TIME_UPDATE,v.throttle(t,999)),e.on(e.events.PAUSED,function(e,t,n){var r;o&&o.pause(),n&&(n=y(n||{},"currentTarget.currentTime"),v.isNumber(n)&&(n=1e3*Math.floor(n),v.isNumber(p)&&(r=n-p,t=y(t||{},"_id"),t=i[t],0<r&&r<h&&t&&(t.currChunkMsWatched+=r)),p=n)),a(i)}),e.on(e.events.ENDED,function(){a(i),o&&o.pause()}),e.on(e.events.STARTED,function(e,t,n){o&&o.resume(),n&&(p=(p=y(n||{},"currentTarget.currentTime"))&&1e3*Math.floor(p))}),e.on(e.events.SKIP_AHEAD,function(e,t){p+=1e3*t}),e.on(e.events.SKIP_BACK,function(e,t){p-=1e3*t}),d.$on("$locationChangeStart",function(){a(i)}),n.onbeforeunload=function(){a(i)})}):(t=Vault.Local.get("watchProgress")||{},o=o||new g(function(){s(t)},r),e=v.bind(c,{},t),d.$on("video:event:timeupdate",v.throttle(e,999)),d.$on("video:event",function(){a(t)}),d.$on("video:event:pause",function(e){a(t),o&&o.pause()}),d.$on("video:event:play",function(e){o&&o.resume()}),d.$on("$locationChangeStart",function(){a(t)}),n.onbeforeunload=function(){a(t)})},flushCache:s};function s(e){if(d.user&&d.user.valid()){for(var t in e=e||(Vault.Local.get("watchProgress")||{})){var n;"undefined"!==t?(n={segment:t,course:e[t].course,furthestIndex:e[t].furthestIndex,modified:e[t].modified,type:e[t].type,addtlMsWatched:e[t].currChunkMsWatched},d.user.updateFurthestSegmentIndex(n),d.$emit("segment:watched",n),u.reportWatchProgress({course:e[t].course,segment:t,user:d.user.get("_id"),watched:e[t].watched}),delete e[t]):delete e[t]}Vault.Local.remove("watchProgress")}}function c(e,l,t,n){var r=y(t||{},"e.currentTarget.currentTime"),i=y(t||{},"type"),o=y(t||{},"currentVideo.segment._id"),a=y(t||{},"currentVideo.segment.course"),s=!1,c=!1,u=0;n&&(r=y(n||{},"currentTarget.currentTime"),s=y(n||{},"currentTarget.paused"),c=y(n||{},"currentTarget.seeking"),a=y(t||{},"source.course"),o=y(t||{},"_id"),y.set(t||{},"watchData",e)),r?(r=1e3*Math.floor(r),v.isNumber(p)&&!s&&!c&&p<r&&r-p<h&&(u=r-p),e[o]?(n=Math.floor(r/m),(t=e[o]).currChunkMsWatched+=u,t.furthestIndex<r&&(t.furthestIndex=r),t.modified=Math.round(new Date/1e3),n!==f&&(t.watched.push(n),Vault.Local.set("watchProgress",e),f=n)):(e[o]={course:a,watched:[],furthestIndex:r,currChunkMsWatched:u},Vault.Local.set("watchProgress",e)),s={segment:o,course:a,modified:Math.round(new Date/1e3),furthestIndex:r},d.$emit("segment:watched",s),p=r):a&&"broadcast"===i&&(e[a]={course:a,modified:Math.round(new Date/1e3),watched:[],type:"live"},Vault.Local.set("watchProgress",e))}function g(e,t){var n=!0;return i(function(){n||(e(),r())},t),{pause:function(){n=!0},resume:r};function r(){n=!1}}}];var v=e("underscore"),y=e("deepval")},{deepval:38,underscore:void 0}],982:[function(e,t,n){"use strict";t.exports=["OnboardingService","arrayMove","_",function(e,s,t){return{estrict:"EA",templateUrl:"/templates/welcome-header/edit.html",scope:{data:"=?",meta:"=?"},link:function(a){a.data=a.data||a.$parent.data||{},a.meta=a.meta||a.$parent.meta||{},a.onboardingSteps=t.pluck(e.onboardingSteps,"name"),a.data.onboardingSteps||(a.data.onboardingSteps=angular.copy(a.onboardingSteps)),void 0===a.data.useOnboarding&&(a.data.useOnboarding="false"),void 0===a.data.onboardingDelayInSeconds&&(a.data.onboardingDelayInSeconds=300),void 0===a.data.showText&&(a.data.showText="true"),a.data.defaultImageUrl||(a.data.defaultImageUrl="https://agc.creativelive.com/agc/pages/welcomeHeaderDefault.jpg"),a.onDrop=function(e,t,n,r,i,o){s(e,o,r),a.$apply()}}}}]},{}],983:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/welcome-header/cms-view.html",scope:{data:"<?"},link:function(e,t,n){e.isAdmin="true"===n.isAdmin,e.data=e.data||e.$parent.data||{}}}}]},{}],984:[function(e,t,n){"use strict";var p=e("underscore");t.exports=["$rootScope","ScoresService","OnboardingService","ChannelTopicService","$filter","$compile",function(s,c,u,l,d,f){return{restrict:"AE",templateUrl:"/templates/welcome-header/index.html",link:function(i,e,t){if(i.data||(i.data=i.$parent.data),i.data&&"true"===i.data.useOnboarding){var n=0,r=(void 0!==i.data.onboardingDelayInSeconds&&(n=parseInt(i.data.onboardingDelayInSeconds,10)),s.user.get("created"));if(Math.round(new Date/1e3)-r<n)return o();u.onReady(function(){u.getNextStep()?i.showOnboarding=!0:o()}),u.onDone(function(){i.showOnboarding=!1,o()}),u.setOnboardingDelayInSeconds(n),u.setSteps(i.data.onboardingSteps),u.init()}else o();function o(){i.data.showCustomHeader&&i.data.customHeader?(i.showCustomHeader=i.data.showCustomHeader,i.customHeader=angular.element(i.data.customHeader),f(i.customHeader)(i),e.empty().append(i.customHeader)):a()}function a(){var e=s.user&&s.user._data,e=d("prettyUsername")(e,"there",!1,!1,!0),r=("there"!==e&&angular.isString(e)&&(e=d("titleCase")(e.toLowerCase())),i.name=e,i.showText=i.data&&"false"!==i.data.showText,[]);(new c).fetchFilteredTopics(function(t){if(0===t.length)return i.image=i.data&&i.data.defaultImageUrl,void(i.reInit=!0);t=t.slice(0,7),l.get().then(function(e){var n=p.chain(e).pluck("topics").flatten().value();p.each(t,function(t){var e=p.find(n,function(e){return p.find(e.ids,function(e){return e===t._id})});r.push(e)}),r=p.chain(r).without(void 0).value().slice(0,5),r=p.chain(r).shuffle().value(),i.displayedTopic=r[0],i.image=i.displayedTopic&&i.displayedTopic.image,i.reInit=!0})})}}}}]},{underscore:void 0}],985:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clWelcomeHeader",e("./directives/index")),r.directive("welcomeHeaderCms",e("./directives/cms/view")),r.directive("welcomeHeaderCmsEdit",e("./directives/cms/edit"))},{"../../common/app":70,"./directives/cms/edit":982,"./directives/cms/view":983,"./directives/index":984}],986:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/welcome/cms-view.html",scope:{data:"=?"},controllerAs:"welcomeCtrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],987:[function(e,t,n){"use strict";t.exports=["$rootScope","$filter",function(t,n){return{restrict:"AE",templateUrl:"/templates/welcome/index.html",replace:!0,controllerAs:"welcomeCtrl",controller:[function(){var e=t.user&&t.user._data,e=n("prettyUsername")(e,"there",!1,!1,!0);"there"!==e&&angular.isString(e)&&(e=n("titleCase")(e.toLowerCase())),angular.extend(this,{name:e})}]}}]},{}],988:[function(e,t,n){"use strict";var r=e("../../common/app");r.directive("clWelcome",e("./directives/index")),r.directive("welcomeCms",e("./directives/cms/view"))},{"../../common/app":70,"./directives/cms/view":986,"./directives/index":987}],989:[function(e,t,n){"use strict";t.exports=[function(){return{restrict:"EA",templateUrl:"/templates/wishlisted/cms-view.html",scope:{data:"=?"},controllerAs:"ctrl",controller:["$scope",function(e){this.data=e.data||e.$parent.data||{}}]}}]},{}],990:[function(e,t,n){"use strict";t.exports=["$rootScope","EventService",function(e,t){return{restrict:"AE",scope:{course:"=?"},templateUrl:"/templates/wishlisted/index.html",controllerAs:"ctrl",controller:["$scope","$attrs",function(e,t){var n=this;function(){}