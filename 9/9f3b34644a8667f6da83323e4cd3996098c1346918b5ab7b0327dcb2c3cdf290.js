!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.postscribe=e():t.postscribe=e()}(this,function(){return i={},n.m=r=[function(t,e,n){"use strict";var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};t.exports=o.default},function(t,e,n){"use strict";function s(){}function u(){var t,e=h.shift();e&&((t=o.last(e)).afterDequeue(),e.stream=function(t,e,r){function i(t){t=r.beforeWrite(t),p.write(t),r.afterWrite(t)}(p=new d.default(t,r)).id=f++,p.name=r.name||p.id,c.streams[p.name]=p;var n=t.ownerDocument,o={close:n.close,open:n.open,write:n.write,writeln:n.writeln};l(n,{close:s,open:s,write:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i(e.join(""))},writeln:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i(e.join("")+"\n")}});var a=p.win.onerror||s;return p.win.onerror=function(t,e,n){r.error({msg:t+" - "+e+": "+n}),a.apply(p.win,[t,e,n])},p.write(e,function(){l(n,o),p.win.onerror=a,r.done(),p=null,u()}),p}.apply(void 0,e),t.afterStreamStart())}function c(t,e,n){if(o.isFunction(n))n={done:n};else if("clear"===n)return h=[],p=null,void(f=0);n=o.defaults(n,a);var r=[t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t,e,n];return t.postscribe={cancel:function(){r.stream?r.stream.abort():r[1]=s}},n.beforeEnqueue(r),h.push(r),p||u(),t.postscribe}e.__esModule=!0;var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.default=c;var r,i=n(2),d=(r=i)&&r.__esModule?r:{default:r},o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(4)),a={afterAsync:s,afterDequeue:s,afterStreamStart:s,afterWrite:s,autoFix:!0,beforeEnqueue:s,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:s,error:function(t){throw new Error(t.msg)},releaseAsync:!1},f=0,h=[],p=null;l(c,{streams:{},queue:h,WriteStream:d.default})},function(t,e,n){"use strict";function i(t,e){var n=l+e,r=t.getAttribute(n);return c.existy(r)?String(r):r}function o(t,e,n){var r=2<arguments.length&&void 0!==n?n:null,i=l+e;c.existy(r)&&""!==r?t.setAttribute(i,r):t.removeAttribute(i)}e.__esModule=!0;var r,s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(3),u=(r=a)&&r.__esModule?r:{default:r},c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(4)),l="data-ps-",d="ps-style",f="ps-script",h=(p.prototype.write=function(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();c.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},p.prototype._callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},p.prototype._writeImpl=function(t){this.parser.append(t);for(var e=void 0,n=void 0,r=void 0,i=[];(e=this.parser.readToken())&&!(n=c.isScript(e))&&!(r=c.isStyle(e));)(e=this.options.beforeWriteToken(e))&&i.push(e);0<i.length&&this._writeStaticTokens(i),n&&this._handleScriptToken(e),r&&this._handleStyleToken(e)},p.prototype._writeStaticTokens=function(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,this._walkChunk(),e):null},p.prototype._buildChunk=function(t){for(var e=this.actuals.length,n=[],r=[],i=[],o=t.length,a=0;a<o;a++){var s,u=t[a],c=u.toString();n.push(c),u.attrs?/^noscript$/i.test(u.tagName)||(s=e++,r.push(c.replace(/(\/?>)/," "+l+"id="+s+" $1")),u.attrs.id!==f&&u.attrs.id!==d&&i.push("atomicTag"===u.type?"":"<"+u.tagName+" "+l+"proxyof="+s+(u.unary?" />":">"))):(r.push(c),i.push("endTag"===u.type?c:""))}return{tokens:t,raw:n.join(""),actual:r.join(""),proxy:i.join("")}},p.prototype._walkChunk=function(){for(var t=void 0,e=[this.proxyRoot];c.existy(t=e.shift());){var n,r=1===t.nodeType;r&&i(t,"proxyof")||(r&&o(this.actuals[i(t,"id")]=t,"id"),(n=t.parentNode&&i(t.parentNode,"proxyof"))&&this.actuals[n].appendChild(t)),e.unshift.apply(e,c.toArray(t.childNodes))}},p.prototype._handleScriptToken=function(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,function(){e._onScriptDone(t)}))},p.prototype._handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",(t=this.options.beforeWriteToken(t))&&this._writeStyleToken(t),e&&this.write()},p.prototype._writeStyleToken=function(t){var e=this._buildStyle(t);this._insertCursor(e,d),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},p.prototype._buildStyle=function(t){var n=this.doc.createElement(t.tagName);return n.setAttribute("type",t.type),c.eachKey(t.attrs,function(t,e){n.setAttribute(t,e)}),n},p.prototype._insertCursor=function(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},p.prototype._onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},p.prototype._onScriptDone=function(t){return t!==this.scriptStack[0]?void this.options.error({msg:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)))},p.prototype._writeScriptToken=function(t,e){var n=this._buildScript(t),r=this._shouldRelease(n),i=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,r?i:function(){e(),i()}));try{this._insertCursor(n,f),n.src&&!r||e()}catch(t){this.options.error(t),e()}},p.prototype._buildScript=function(t){var n=this.doc.createElement(t.tagName);return c.eachKey(t.attrs,function(t,e){n.setAttribute(t,e)}),t.content&&(n.text=t.content),n},p.prototype._scriptLoadHandler=function(e,n){function r(){e=e.onload=e.onreadystatechange=e.onerror=null}function t(){r(),null!=n&&n(),n=null}function i(t){r(),a(t),null!=n&&n(),n=null}function o(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var a=this.options.error;o(e,"load"),o(e,"error"),s(e,{onload:function(){if(e._onload)try{e._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){i({msg:"onload handler failed "+t+" @ "+e.src})}t()},onerror:function(){if(e._onerror)try{e._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){return void i({msg:"onerror handler failed "+t+" @ "+e.src})}i({msg:"remote script failed "+e.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(e.readyState)&&t()}})},p.prototype._shouldRelease=function(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},p);function p(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,p),this.root=t,this.options=e,this.doc=t.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new u.default("",{autoFix:e.autoFix}),this.actuals=[t],this.proxyHistory="",this.proxyRoot=this.doc.createElement(t.nodeName),this.scriptStack=[],this.writeQueue=[],o(this.proxyRoot,"proxyof",0)}e.default=h},function(t,e,n){t.exports=function(n){function r(t){if(i[t])return i[t].exports;var e=i[t]={exports:{},id:t,loaded:!1};return n[t].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}var i={};return r.m=n,r.c=i,r.p="",r(0)}([function(t,e,n){"use strict";var r=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(r);t.exports=i.default},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.__esModule=!0;var i=n(2),s=r(i),o=n(3),u=r(o),a=n(6),c=function(t){return t&&t.__esModule?t:{default:t}}(a),l=n(5),d={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},f=function(){function a(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,a),this.stream=e;var r=!1,i={};for(var o in s)s.hasOwnProperty(o)&&(n.autoFix&&(i[o+"Fix"]=!0),r=r||i[o+"Fix"]);r?(this._readToken=(0,c.default)(this,i,function(){return t._readTokenImpl()}),this._peekToken=(0,c.default)(this,i,function(){return t._peekTokenImpl()})):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return a.prototype.append=function(t){this.stream+=t},a.prototype.prepend=function(t){this.stream=t+this.stream},a.prototype._readTokenImpl=function(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},a.prototype._peekTokenImpl=function(){for(var t in d)if(d.hasOwnProperty(t)&&d[t].test(this.stream)){var e=u[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},a.prototype.peekToken=function(){return this._peekToken()},a.prototype.readToken=function(){return this._readToken()},a.prototype.readTokens=function(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},a.prototype.clear=function(){var t=this.stream;return this.stream="",t},a.prototype.rest=function(){return this.stream},a}();for(var h in(e.default=f).tokenToString=function(t){return t.toString()},f.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,l.escapeQuotes)(t[n],null));return e},f.supports=s)s.hasOwnProperty(h)&&(f.browserHasFlaw=f.browserHasFlaw||!s[h]&&h)},function(t,e){"use strict";var n=!(e.__esModule=!0),r=!1,i=window.document.createElement("div");try{var o="<P><I></P></I>";i.innerHTML=o,e.tagSoup=n=i.innerHTML!==o}catch(t){e.tagSoup=n=!1}try{i.innerHTML="<P><i><P></P></i></P>",e.selfClose=r=2===i.childNodes.length}catch(t){e.selfClose=r=!1}i=null,e.tagSoup=n,e.selfClose=r},function(t,e,n){"use strict";function i(t){var e=t.indexOf(">");if(-1!==e){var o=t.match(s.startTag);if(o){var n=function(){var n={},r={},i=o[2];return o[2].replace(s.attr,function(t,e){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(n[arguments[5]]="",r[arguments[5]]=!0):n[e]=arguments[2]||arguments[3]||arguments[4]||s.fillAttr.test(e)&&e||"":n[e]="",i=i.replace(t,"")}),{v:new a.StartTagToken(o[1],o[0].length,n,r,!!o[3],i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))}}();if("object"===(void 0===n?"undefined":r(n)))return n.v}}}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=function(t){var e=t.indexOf("--\x3e");if(0<=e)return new a.CommentToken(t.substr(4,e-1),e+3)},e.chars=function(t){var e=t.indexOf("<");return new a.CharsToken(0<=e?e:t.length)},e.startTag=i,e.atomicTag=function(t){var e=i(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var r=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(r)return new a.AtomicTagToken(e.tagName,r[0].length+e.length,e.attrs,e.booleanAttrs,r[1])}}},e.endTag=function(t){var e=t.match(s.endTag);if(e)return new a.EndTagToken(e[1],e[0].length)};var a=n(4),s={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=void 0;var a=n(5),r=(e.Token=function t(e,n){s(this,t),this.type=e,this.length=n,this.text=""},e.CommentToken=function(){function n(t,e){s(this,n),this.type="comment",this.length=e||(t?t.length:0),this.text="",this.content=t}return n.prototype.toString=function(){return"\x3c!--"+this.content},n}(),e.CharsToken=function(){function e(t){s(this,e),this.type="chars",this.length=t,this.text=""}return e.prototype.toString=function(){return this.text},e}(),e.TagToken=function(){function o(t,e,n,r,i){s(this,o),this.type=t,this.length=n,this.text="",this.tagName=e,this.attrs=r,this.booleanAttrs=i,this.unary=!1,this.html5Unary=!1}return o.formatTag=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r="<"+t.tagName;for(var i in t.attrs){t.attrs.hasOwnProperty(i)&&(r+=" "+i,e=t.attrs[i],void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[i]||(r+='="'+(0,a.escapeQuotes)(e)+'"'))}return t.rest&&(r+=" "+t.rest),r+=t.unary&&!t.html5Unary?"/>":">",null!=n&&(r+=n+"</"+t.tagName+">"),r},o}());e.StartTagToken=function(){function a(t,e,n,r,i,o){s(this,a),this.type="startTag",this.length=e,this.text="",this.tagName=t,this.attrs=n,this.booleanAttrs=r,this.html5Unary=!1,this.unary=i,this.rest=o}return a.prototype.toString=function(){return r.formatTag(this)},a}(),e.AtomicTagToken=function(){function o(t,e,n,r,i){s(this,o),this.type="atomicTag",this.length=e,this.text="",this.tagName=t,this.attrs=n,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1,this.content=i}return o.prototype.toString=function(){return r.formatTag(this,this.content)},o}(),e.EndTagToken=function(){function n(t,e){s(this,n),this.type="endTag",this.length=e,this.text="",this.tagName=t}return n.prototype.toString=function(){return"</"+this.tagName+">"},n}()},function(){},function(t,e){"use strict";function u(t){return t&&"startTag"===t.type&&(t.unary=n.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function c(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}e.__esModule=!0,e.default=function(o,n,a){function(){}