
function getBaseEventLogin(Event,BeaconID){return{'event_location':'login'||'','event':Event||'','beacon_id':BeaconID||'','asset_location':'account_sign_in'||'','email':'','crm_id':'','buyer_number':''};};var doTagGTMLoginSuccess=function(email,crmId,buyerNumber){var events=Object.assign(getBaseEventLogin("sign_in",'10.00'),{'page_name':'Login','email':email,'crm_id':crmId,'buyer_number':buyerNumber});googleTagManager.track(events);};

var doTagBreakerBid4UClick=function(buyerNumber,crmId){var events={buyer_number:buyerNumber,crm_id:crmId,event_location:'bb4u_header_click',beacon_id:'8.00',event:'bb4u_header_click',asset_location:'header',asset_type:'bb4u_header_click'}
googleTagManager.track(events);};var doTagBreakerBid4UFormComplete=function(buyerNumber,crmId,lotNumber){var events={event_location:'bb4u_form_send',beacon_id:'8.01',event:'bb4u_success',buyer_number:buyerNumber,crm_id:crmId,asset_location:'bb4u_send_button',asset_type:'bb4u_form_submit',lot_number:lotNumber}
googleTagManager.track(events);};

var doTagGtmSellForBusinessClick=function(buyerNumber,crmId){var events={event_location:'sell_for_business',beacon_id:'7.00',event:'sell_for_business',buyer_number:buyerNumber||'',crm_id:crmId||'',asset_location:'header',asset_type:'sell_for_business'}
googleTagManager.track(events);}
var doTagGtmSellForBusinessFormComplete=function(buyerNumber,crmId,sellerType){var events={event_location:'sell_for_business',beacon_id:'7.01',event:'sell_for_business_send',buyer_number:buyerNumber||'',crm_id:crmId||'',asset_location:'send_button',asset_type:'sell_for_business_success',seller_type:sellerType||''}
googleTagManager.track(events);};

function getBaseEventHomePage(Event,BeaconID,AssetLocation){return{'event_location':'hp','event':Event||'','beacon_id':BeaconID||'','asset_location':AssetLocation||''};};var doTagGTMHomeRegisterToStartBidding=function(){var events=Object.assign(getBaseEventHomePage("register_to_bid",'1.01',"top_banner"),{'asset_type':"carousel_banner_1"})
googleTagManager.track(events);};var doTagGTMHomeRegisterHeader=function(){var events=Object.assign(getBaseEventHomePage("register_to_bid",'1.02',"header"),{'event_location':'header_right'})
googleTagManager.track(events);};var doTagGTMHomeLiveAuctionsHappeningNow=function(){var events=getBaseEventHomePage("enter_live_auctions",'1.03',"top_banner")
googleTagManager.track(events);};var doTagGTMHomeSearchInventory=function(searchText){var events=Object.assign(getBaseEventHomePage("enter_search_results",'1.04',"header"),{'value':searchText||'','event_location':'header_search'})
googleTagManager.track(events);};var doTagGTMHomeSearchInventoryVehicleCount=function(){var events=Object.assign(getBaseEventHomePage("enter_search_results",'1.05',"top_banner"),{'asset_type':"yellow_number"})
googleTagManager.track(events);};var doTagGTMHomeSearchInventoryNumberwords=function(){var events=Object.assign(getBaseEventHomePage("enter_search_results",'1.06',"top_banner"),{'asset_type':"yellow_number_words"})
googleTagManager.track(events);};var doTagGTMRegisterNowMembershipOption=function(){var events=Object.assign(getBaseEventHomePage("register_to_bid",'1.07',"body"),{'asset_type':"membership_options"})
googleTagManager.track(events);};var doTagGTMBecomeAMember=function(){var events=Object.assign(getBaseEventHomePage("register_to_bid",'1.08',"body"),{'asset_type':"4grid"})
googleTagManager.track(events);};var doTagGTMGridClick=function(){var events=Object.assign(getBaseEventHomePage("enter_search_results",'1.09',"body"),{'asset_type':"4grid"})
googleTagManager.track(events);};var doTagGTMFooterRegister=function(){var events=getBaseEventHomePage("register_to_bid",'1.10',"footer")
googleTagManager.track(events);};var doTagGTMHeaderLanguageChange=function(languageName){var events=Object.assign(getBaseEventHomePage("language_change",'1.11',"header"),{'value':languageName})
googleTagManager.track(events);};var doTagGTMHeaderCountryChange=function(countryName){var events=Object.assign(getBaseEventHomePage("region_change",'1.11',"header"),{'value':countryName})
googleTagManager.track(events);};var doTagGTMFooterLanguageChange=function(languageName){var events=Object.assign(getBaseEventHomePage("language_change",'1.12',"footer"),{'value':languageName})
googleTagManager.track(events);};var doTagGTMFooterCountryChange=function(languageName){var events=Object.assign(getBaseEventHomePage("region_change",'1.12',"footer"),{'value':languageName})
googleTagManager.track(events);};

var doTagGTMAuctionDashboardPageLoad=function(){googleTagManager.track({'event':"click_join_live_auctions",'event_location':'adb','beacon_id':'6.00'});};
'use strict';var Logger=function(params){var formatMessage=function(input){try{if(!input){throw new Error('No input specified.');}else{var message=input[0].toString();for(var i=1;i<input.length;i++){var obj=(input[i]!==null&&input[i]!==undefined)?input[i].toString():'';message=message.replace('\{\}',obj);}
return message;}}catch(err){if(window.console)
console.log('Logger.formatMessage error: '+err);}
return null;};var getErrorMessage=function(args){return(logName+' ERROR: '+formatMessage(args));};var getWarnMessage=function(args){return(logName+' WARN: '+formatMessage(args));};var getInfoMessage=function(args){return(logName+' INFO: '+formatMessage(args));};var getDebugMessage=function(args){return(logName+' DEBUG: '+formatMessage(args));};var getConsoleMessage=function(args){return(logName+' LOG: '+formatMessage(args));};var getAuditMessage=function(args){return(logName+' AUDIT: '+formatMessage(args));};var deriveLevel=function(value){if(typeof(value)==='string'){value=value.toUpperCase();if(value==='NONE')
return Logger.NONE;else if(value==='ERROR')
return Logger.ERROR;else if(value==='WARN')
return Logger.WARN;else if(value==='INFO')
return Logger.INFO;else if(value==='DEBUG')
return Logger.DEBUG;}else if(typeof(value)==='number'){if(value===Logger.NONE)
return Logger.NONE;else if(value===Logger.ERROR)
return Logger.ERROR;else if(value===Logger.WARN)
return Logger.WARN;else if(value===Logger.INFO)
return Logger.INFO;else if(value===Logger.DEBUG)
return Logger.DEBUG;}
return Logger.DEFAULT;};var send=function(level,msg){msg+='; LOCATION: '+window.location.href;msg+='; AGENT: '+navigator.userAgent;msg+='; CSIZE: '+jQuery.cookie('cCSC');};this.setLevel=function(value){logLevel=deriveLevel(value);};this.getLevel=function(){return logLevel;};this.getName=function(){return logName;};this.error=function(){if(logLevel>=Logger.ERROR&&window.console)
console.log(getErrorMessage(arguments));};this.error.server=function(){if(logLevel>=Logger.ERROR){var msg=getErrorMessage(arguments);if(window.console)
console.log(msg);send(Logger.ERROR,msg);}};this.warn=function(){if(logLevel>=Logger.WARN&&window.console)
console.log(getWarnMessage(arguments));};this.warn.server=function(){if(logLevel>=Logger.WARN){var msg=getWarnMessage(arguments);if(window.console)
console.log(msg);send(Logger.WARN,msg);}};this.info=function(){if(logLevel>=Logger.INFO&&window.console)
console.log(getInfoMessage(arguments));};this.info.server=function(){if(logLevel>=Logger.INFO){var msg=getInfoMessage(arguments);if(window.console)
console.log(msg);send(Logger.INFO,msg);}};this.debug=function(){if(logLevel>=Logger.DEBUG&&window.console)
console.log(getDebugMessage(arguments));};this.debug.server=function(){if(logLevel>=Logger.DEBUG){var msg=getDebugMessage(arguments);if(window.console)
console.log(msg);send(Logger.DEBUG,msg);}};this.console=function(){if(logLevel>Logger.NONE&&window.console)
console.log(getConsoleMessage(arguments));};this.console.server=function(){if(logLevel>Logger.NONE){var msg=getConsoleMessage(arguments);if(window.console)
console.log(msg);send(Logger.INFO,msg);}};this.server=function(){if(logLevel>Logger.NONE)
send(Logger.INFO,getConsoleMessage(arguments));};this.audit=function(){if(logLevel>Logger.NONE&&jQuery.cookie('jsAuditLogs'))
send(Logger.INFO,getAuditMessage(arguments));};if(!params)params={};var logName=(params.name)?params.name:'Logger';var logLevel=(params.level)?deriveLevel(params.level):Logger.DEFAULT;var logNative=(params.native===false)?false:true;if(logNative){window.onerror=function(message,file,line){if(logLevel>=Logger.ERROR){var msg=getErrorMessage(['{}, file={}, line={}',message,file,line]);send(Logger.ERROR,msg);}};}};Logger.NONE=0;Logger.ERROR=1;Logger.WARN=2;Logger.INFO=3;Logger.DEBUG=4;Logger.DEFAULT=Logger.WARN;

var doTagGTMPageload=function(prefix,pageName,pageNameUrl,lotNumber){var events={'page_name':prefix+pageName,'beacon_id':'0.00','event':'virtual_pageview'}
if(lotNumber){Object.assign(events,{'lot_number':lotNumber,'value':'prodView'})}
googleTagManager.track(events);};function getBaseEventNavigation(Event,BeaconID,AssetLocation){return{event_location:'mbp',event:Event,beacon_id:BeaconID||'',asset_location:AssetLocation||''};};var doTagMBPPaymentPortalLink=function(){var events=Object.assign(getBaseEventNavigation('payments_due','5.00','header'),{'asset_type':'unpaid_invoices'})
googleTagManager.track(events);};

var app=angular.module('g2app',['ngRoute','ngCookies','angular-loading-bar','ui.bootstrap','LocalStorageModule','ngSanitize','oc.lazyLoad','vcRecaptcha']);app.factory("config",["$location","$cookies",function($location,$cookies){if(AppUtils.isUndefined(appInit))
throw Error('Missing "appInit" object.');var logLevel=appInit.logLevel;logLevel=(AppUtils.isString(logLevel))?logLevel.toLowerCase().trimToNull():'info';logLevel=(logLevel!==null)?logLevel:'info';var userLang=AppUtils.trimToNull(appInit.userLang);userLang=(!AppUtils.isUndefined(userLang))?userLang.toLowerCase():'en';var userVariant=AppUtils.trimToNull(appInit.userVariant);userVariant=(!AppUtils.isUndefined(userVariant))?userVariant.toLowerCase():null;var userTerritory=AppUtils.trimToNull(appInit.userTerritory);_.templateSettings={interpolate:/\[\[(.+?)\]\]/g,evaluate:/\{\[(.+?)\]\}/g};return{appName:'Member',appDescription:'Copart Member',appRelease:'0.0.1',logLevel:logLevel?logLevel:'debug',locale:{lang:userLang,variant:userVariant,territory:userTerritory}};}]);
;

app.config(['$routeProvider','$locationProvider','copartUserProvider','$httpProvider','$compileProvider','localStorageServiceProvider','$cookiesProvider','$windowProvider','searchCriteriaConstants',function($routeProvider,$locationProvider,copartUserProvider,$httpProvider,$compileProvider,localStorageServiceProvider,$cookiesProvider,$windowProvider,searchCriteriaConstants){$compileProvider.debugInfoEnabled(false);var $thisWindow=$windowProvider.$get();$httpProvider.defaults.headers.common['X-Requested-With']='XMLHttpRequest';if(!$httpProvider.defaults.headers.get){$httpProvider.defaults.headers.get={};}
function filterContentUrl(url){var contentPath=url;return contentPath;}
var region=(appInit.appPlatform=="gbl")?"_GLOBAL":"";localStorageServiceProvider.setPrefix('g2app').setStorageType('sessionStorage').setNotify(true,true);$cookiesProvider.defaults.domain="."+copartUserProvider.$get().config.siteDomain;$cookiesProvider.defaults.path="/";$httpProvider.defaults.headers.get['If-Modified-Since']='Mon, 26 Jul 1997 05:00:00 GMT';$httpProvider.defaults.timeout=15000;$httpProvider.defaults.headers.get['Cache-Control']='no-cache';$httpProvider.defaults.headers.get['Pragma']='no-cache';if(appInit.csrfToken!=null){$httpProvider.defaults.xsrfHeaderName='X-XSRF-TOKEN';$httpProvider.defaults.headers.common['Accept']='application/json, text/plain, */*';$httpProvider.defaults.headers.common['Access-Control-Allow-Headers']='Content-Type, X-XSRF-TOKEN';$httpProvider.defaults.headers.common['X-XSRF-TOKEN']=appInit.csrfToken;}
$httpProvider.interceptors.push('templateInterceptor');$httpProvider.interceptors.push('authHttpResponseInterceptor');$httpProvider.interceptors.push('HttpRequestTimeoutInterceptor');$httpProvider.interceptors.push('XSSRequestWrapperInterceptor');$locationProvider.html5Mode(true);$httpProvider.interceptors.push(['$q','$cookies',function($q,$cookies){return{'request':function(config){if($cookies.get('JWT_TOKEN'))
{$httpProvider.defaults.headers.common.Authorization=$cookies.get('JWT_TOKEN');}
return config;}};}]);var getVehicleFinderRoute=function(){if('CPRTMEA'==copartUserProvider.$get().config.siteCode){return{templateUrl:'/public/vehicleFinder',resolve:{lazyLoadPageBundle:lazyLoadFiles([getResourcePath("VEHICLE_FINDER_BUNDLE")])},controller:'vehicleFinderController',allowAccess:["ROLE_ANONYMOUS"],pageName:"vehiclefinder",titleKey:"app.vehiclefinder.title",descKey:"app.vehiclefinder.description",activeTab:"findVehicles",caseInsensitiveMatch:true};}else{return{templateUrl:function(){return undefined;},activeTab:"findVehicles",isAngularRoute:true}}};var getLocDetailsRouteInfo=function(){return{templateUrl:function(){return undefined;},activeTab:"locations",isAngularRoute:true};};var getLocListRouteInfo=function(){return{templateUrl:function(){return undefined;},activeTab:"locations",isAngularRoute:true};};var getVehicleSearchRouteMetaData=function(parameters){if(getCookieByName("classicSearchResultsView")==="true"){var params=getOrDefaultParams(parameters);return{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestore:true,scrollRestoreKey:params.seoPageName,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:createMiscSearchQueryForVehicleSearch},seoPageName:params.seoPageName,originalParams:{seoPageName:params.seoPageName,titleKey:params.titleKey,descKey:params.descKey},pageActivatedForSEO:params.pageActivatedForSEO,allowSEOforUsedOrSalvaged:params.allowSEOforUsedOrSalvaged,initialParam:params.initialParam,titleKey:params.titleKey,descKey:params.descKey,arguments:!!params.arguments&&!params.descArguments?params.arguments:null,titleArguments:params.arguments,descArguments:params.descArguments,autoCheckFilter:params.autoCheckFilter,ldJsonScriptName:params.ldJsonScriptName,callBackForSearchCriteria:params.callBackForSearchCriteria};}else{return{templateUrl:fetchSearchResultStyles,resolve:{lazyLoadPageBundle:function(){}},reloadOnSearch:false,isAngularRoute:true}}};var getOrDefaultParams=function(parameters){var params=parameters;if(!params.titleKey){params.titleKey="app.quickpick.searchresults.title";}
if(!params.descKey){params.descKey="app.quickpick.searchresults.description";}
if(!params.arguments){params.arguments=["searchText"];}
return params;};var createMiscSearchQueryForVehicleSearch=['searchCriteriaFactory','$q','$route','vehicleSearchService',function(searchCriteriaFactory,$q,$route,vehicleSearchService){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);vehicleSearchService.updateVehicleSearchRouteParams();vehicleSearchService.buildSearchCriteria(searchCriteria).then(function(){deferred.resolve(searchCriteria);},function(){vehicleSearchService.setDefaultSearchCriteria(searchCriteria);deferred.resolve(searchCriteria);});return deferred.promise;}];var lazyLoadFiles=function(files,modules){return['$ocLazyLoad','appConfigService','$q',function($ocLazyLoad,appConfigService,$q){var deferred=$q.defer();$ocLazyLoad.load({serie:true,files:files,modules:modules}).then(function(){if(typeof referenceDataLess!="undefined"){appConfigService.appConfig.update(referenceDataLess);}
deferred.resolve();})
return deferred.promise;}];};var originalWhen=$routeProvider.when;$routeProvider.when=function(path,route){route.resolve=(route.resolve)?route.resolve:{};var lazyLoadAllBundlesResolve={lazyLoadAllBundles:lazyLoadFiles(appInit.allJSBundles,appInit.allExternalModules)};if(!route.resolve.lazyLoadPageBundle||!appInit.enableModularResources){angular.extend(lazyLoadAllBundlesResolve,route.resolve);route.resolve=lazyLoadAllBundlesResolve;}
return originalWhen.call($routeProvider,path,route);};$routeProvider.when('/',{templateUrl:(appInit.isUserAgentBOT?'/public/home/content?userLang=':'/home/content?userLang=')+appInit.selectedLang+'&initialPageLayout='+appInit.initialPageLayout,pageName:'homepage',resolve:{cldrData:waitForCLDRInitialization.cldrData,lazyLoadPageBundle:lazyLoadFiles([getResourcePath("HOME_BUNDLE")])},controller:'homeContentController',allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.home.title",descKey:"app.home.description",redirectAfterLoginUrl:"/dashboard",displayAnchorAds:true,pageLayout:appInit.layout.HOME_PAGE,activeTab:"homePage"}).when('/scheduleMaintainance/',{templateUrl:'/public/fetchDirective.html?directive=error/schedule-maintainance'}).when('/dashboard/',{templateUrl:'/fetchDirective.html?directive=home/dashboard2',controller:'dashBoardController2',pageName:'dashboard',activeTab:"dashboard",resolve:{init:['copartUser','accountAlertsService',function(copartUser,accountAlertsService){if(!copartUser.displayAlertsModal){var pendingUserActions=accountAlertsService.filterAlertsForUserViewFromUserActivities(accountAlertsService.getAlerts());pendingUserActions=accountAlertsService.filterAlertsPastActivationDate(pendingUserActions);accountAlertsService.updateDisplayAlertsModal(true);accountAlertsService.openAlertModalsForView(pendingUserActions);}}]}}).when('/redirectToPaymentGateway/:flag',{templateUrl:'/public/fetchDirective.html?directive=home/RenewalFeesModal',controller:'UpgradeMembershipController',allowAccess:["ROLE_ANONYMOUS"]}).when('/contactUs/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/contact-us/member-services',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support",pageName:"contactUs"}).when('/myBids/',{templateUrl:'/fetchDirective.html?directive=bidStatus/myBids',controller:'myBidsController',scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"myBids",noCache:true,activeTab:"bidStatus",pageName:"myBids"}).when('/myBids/:filterType/',{templateUrl:'/fetchDirective.html?directive=bidStatus/myBids',controller:'myBidsController',scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"paymentHistory",noCache:true,activeTab:"bidStatus"}).when('/content/:region/:lang/:contentPath*',{caseInsensitiveMatch:true,templateUrl:function(loc){var contentPath=filterContentUrl(loc.contentPath);try{if(appInit.localeString.toLowerCase()!=loc.lang.toLowerCase()){$("body").trigger("contentRoute",[appInit.localeString,loc.region,contentPath]);}}
catch(e){console.log(e);}
return'/CMS/'+appInit.localeString+'/content/'+loc.region+'/'+appInit.localeString+'/'+contentPath;},controller:'cmsController',titleKey:"app.content.title",descKey:"app.content.description",titleArguments:["title"],descArguments:["description"],pageName:"content",ignoreCanonicalRef:true,reloadOnSearch:false}).when('/:lang/content/:region/:lang/:contentPath*',{caseInsensitiveMatch:true,templateUrl:function(loc){var contentPath=filterContentUrl(loc.contentPath);try{if(appInit.localeString.toLowerCase()!=loc.lang.toLowerCase()){$("body").trigger("contentRoute",[appInit.localeString,loc.region,contentPath]);}}
catch(e){console.log(e);}
return'/CMS/'+appInit.localeString+'/content/'+loc.region+'/'+appInit.localeString+'/'+contentPath;},controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"content",ignoreCanonicalRef:true,reloadOnSearch:false}).when('/international-shipping',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/landing-page/international-shipping-index',controller:'shippingContentController',pageName:"international-shipping"}).when('/setNewPassword',{controller:'loginController'}).when('/tempPasswordExpired',{templateUrl:'/public/fetchDirective.html?directive=registration/tempPasswordExpired'}).when('/login-error',{templateUrl:function(){return undefined;},isAngularRoute:true}).when('/locations/',getLocListRouteInfo()).when('/locationsList/',getLocListRouteInfo()).when('/locations/state/:locationState',{templateUrl:function(){return undefined;},activeTab:"locations",isAngularRoute:true}).when('/locations/state/:country/:locationState',{templateUrl:function(){return undefined;},activeTab:"locations",isAngularRoute:true}).when('/locations/:locationName',getLocDetailsRouteInfo()).when('/locationDetail/:yardNumber/',getLocDetailsRouteInfo()).when('/location/:yardNumber/',getLocDetailsRouteInfo()).when('/contactBroker/',{templateUrl:'/fetchDirective.html?directive=bidderManagement/contactBroker',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/expiredPassword/',{templateUrl:'/public/fetchDirective.html?directive=registration/changePassword',controller:'accountInfoChangePwdController'}).when('/bidders/',{templateUrl:'/fetchDirective.html?directive=bidderManagement/bidders',controller:'bidderManagementController',activeTab:"myAccount"}).when('/thankyou/',{templateUrl:function($routeParams)
{return' /CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/registration/thank-you'+($routeParams.type?('-'+$routeParams.type):'');},controller:'thankYouController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"registration-thankyou"}).when('/sitemapslimfooter/',{templateUrl:'/public/fetchDirective.html?directive=sitemap/sitemapslimfooter',controller:'siteMapController',allowAccess:["ROLE_ANONYMOUS"],pageName:"sitemapslimfooter"}).when('/collect-security-questions',{templateUrl:'/public/fetchDirective.html?directive=registration/collect-security-questions',controller:'CollectSecurityQuestionsController',resolve:{referenceData:waitForReferenceDataMoreInitialization.referenceData}}).when('/create-password',{templateUrl:'/public/fetchDirective.html?directive=registration/create-password',controller:'CreatePasswordController',pageName:'create-password'}).when('/registrationlanding/',{templateUrl:'/public/fetchDirective.html?directive=registration/registrationlanding',controller:'registrationController',pageName:"registrationlanding"}).when('/doRegistration/:activeStep?',{templateUrl:'/public/fetchDirective.html?directive=registration/'+('CPRTMEA'==copartUserProvider.$get().config.siteCode?'register':'registration')+'&initialPageLayout='+appInit.initialPageLayout,controller:function(){if('CPRTMEA'==copartUserProvider.$get().config.siteCode)return'registrationController';else return'registrationBaseController';}(),redirectAfterLoginUrl:"/dashboard",removeChatOnRouteChange:true,titleKey:"app.register.title",descKey:"app.register.description",resolve:{lazyLoadPageBundle:lazyLoadFiles([getResourcePath("REGISTRATION_BUNDLE")]),childParam:function(){return"";}},pageLayout:appInit.layout.REGISTRATION_PAGE}).when('/usregister/:activeStep?',{templateUrl:'/public/fetchDirective.html?directive=registration/us/usRegistration',controller:'registrationBaseController',titleKey:"app.register.title",descKey:"app.register.description",resolve:{childParam:function(){return"";}}}).when('/vehicleAlerts/',{templateUrl:'/public/fetchDirective.html?directive=vehicle/vehicleAlerts',controller:'VehicleAlertsController',resolve:waitForReferenceDataInitialization,allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description",pageName:"VehicleAlerts",activeTab:"findVehicles"}).when('/vehicleAlerts/:subscribe',{templateUrl:'./public/fetchDirective.html?directive=vehicle/vehicleAlerts',controller:'VehicleAlertsController',allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description",activeTab:"findVehicles"}).when('/smsAlerts',{templateUrl:'./public/fetchDirective.html?directive=vehicle/smsvehicleAlertsLoading',controller:'smsVehicleAlertsController',allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description"}).when('/us/VehicleAlert/:subscribe',{allowAccess:["ROLE_ANONYMOUS"],redirectTo:"/vehicleAlerts/:subscribe",titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description"}).when('/updateBrokerBidderEmail/',{templateUrl:'/fetchDirective.html?directive=bidderManagement/updateEmail',controller:'brokerBidderEmailController'}).when('/downloadSalesData/',{templateUrl:'/fetchDirective.html?directive=sales/downloadSalesData',controller:'downloadSalesDataController',activeTab:"findVehicles",pageName:"downloadSalesData"}).when('/condition-report/lot/:lotId/:lotInfo?',{templateUrl:'/fetchDirective.html?directive=/conditionReport/conditionReport',controller:'conditionReportController',pageName:"condition-report"}).when('/yard-condition-report/lot/:lotId/:lotInfo?',{templateUrl:'/public/fetchDirective.html?directive=/conditionReport/conditionReport',controller:'conditionReportApiController',pageName:"yard-condition-report"}).when('/todaysAuction/',{templateUrl:'/public/fetchDirective.html?directive=auction/todaysAuction',controller:'todaysAuctionController',resolve:{initData:['appConfigService','startupRestService','$q',function(appConfigService,startupRestService,$q){var deferred=$q.defer();if(AppUtils.isUndefined(appConfigService.getEnvConfigProps())){startupRestService.getEnvConfigProps(function(response){deferred.resolve(response);});}
else{deferred.resolve(appConfigService.envConfigProps);}
return deferred.promise;}]},allowAccess:["ROLE_ANONYMOUS"],pageName:"todaysauction_list",titleKey:"app.todaysauction.title",descKey:"app.todaysauction.description",activeTab:"Auctions"}).when('/savedsearch/',{templateUrl:'/fetchDirective.html?directive=savedSearches/savedsearch',controller:'savedSearchesController',allowAccess:["ROLE_ANONYMOUS"],title:"Saved Searches",pageName:"SavedSearch",titleKey:"app.header.savedSearch.title",descKey:"app.header.savedSearch.description",activeTab:"findVehicles",blockAccess:["ROLE_GUEST"]}).when('/auctionCalendar/',{templateUrl:function(){return mobileCheck()?'/public/fetchDirective.html?directive=auction/auctionCalendarMobile':'/public/fetchDirective.html?directive=auction/auctionCalendar';},controller:'auctionCalendarController',allowAccess:["ROLE_ANONYMOUS"],pageName:"auction_calendar",scrollRestore:true,scrollRestoreKey:"auction_calendar",titleKey:"app.auctioncalendar.title",descKey:"app.auctioncalendar.description",activeTab:"Auctions"}).when('/contact/',{templateUrl:'/pages/contact.htm',controller:'contactController'}).when('/accountInformation/complete-registration/',{redirectTo:"/complete-registration/",hideAccntAlerts:true}).when('/accountInformation/:navMenu?/:edit?',{templateUrl:'/fetchDirective.html?directive=accountinfo/accountinfo',controller:'AccountInfoController',blockAccess:["COUNTERMAN"],activeTab:"myAccount",pageName:"accountInformation"}).when('/complete-registration/',{templateUrl:'/fetchDirective.html?directive=completeRegistration/completeRegistration',controller:'completeRegistrationController',hideAccntAlerts:true,pageName:"complete-registration",resolve:{data:['copartUser','startupRestService',function(copartUser,startupRestService){copartUser.setDisplayAlertsModal(false);startupRestService.updateDisplayAlertsModal({'displayAlertsModal':false});}]}}).when('/driverseat/:view',{templateUrl:'/fetchDirective.html?directive=/driverseat/driverseat',controller:'driverSeatController',scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"driverSeatResults",activeTab:"driverseat",resolve:{cldrData:waitForCLDRInitialization.cldrData,searchQueryCriteria:['searchCriteriaFactory','$route','$location','$q',function(searchCriteriaFactory,$route,$location,$q){var deferred=$q.defer();var routeParam=$route.current.params.view?$route.current.params.view:'mylots';var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants[routeParam]);if(searchCriteria.getSearchCriteriaObj()){$location.search("searchCriteria",JSON.stringify(searchCriteria.getSearchCriteriaObj()));}
deferred.resolve(searchCriteria);return deferred.promise;}]}}).when('/vehicle-search-model/:category?/:make/:model',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-model",pageActivatedForSEO:true,initialParam:"make",titleKey:"app.vehicle-search-model.title",descKey:"app.vehicle-search-model.description",arguments:["make","model"],descArgument:["yearRange","make","model"],autoCheckFilter:true})).when('/vehicle-search-year/:category?/:make/:year',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-year-for-make",initialParam:"make",titleKey:"app.make.vehicle-search-year.title",descKey:"app.make.vehicle-search-year.description",arguments:["make","year"]})).when('/vehicle-search-year/:category?/:make/:model/:year',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-year-for-model",initialParam:"make",titleKey:"app.model.vehicle-search-year.title",descKey:"app.model.vehicle-search-year.description",arguments:["make","model","year"]})).when('/vehicle-search-make/:category?/:make',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-make",initialParam:"make",pageActivatedForSEO:true,allowSEOforUsedOrSalvaged:true,autoCheckFilter:true,ldJsonScriptName:"vehicle-search-make",callBackForSearchCriteria:"getSearchCriteriaParamsFromCallbackForMake"})).when('/vehicle-search-featured/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-featured",autoCheckFilter:true})).when('/vehicle-search-type/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-type",pageActivatedForSEO:true,autoCheckFilter:true})).when('/vehicle-search/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search"})).when('/vehicle-search-title/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-title",autoCheckFilter:true})).when('/vehicle-search-damage/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-damage",autoCheckFilter:true})).when('/vehicle-search-category/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-category",autoCheckFilter:true})).when('/vehicle-search-primary-damage/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-primary-damage",autoCheckFilter:true})).when('/vehicle-search-grade/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-grade",autoCheckFilter:true})).when('/vehicle-search-bid/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-bid"})).when('/vehicle-search-source/:category?/:value',getVehicleSearchRouteMetaData({seoPageName:"vehicle-search-source"})).when('/popular/:item/:value',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"searchResults",reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$location','$q','$route','$filter',function(searchCriteriaFactory,$location,$q,$route,$filter){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);searchCriteria.setQuery($filter('sanitize_html')($route.current.params.value));searchCriteria.setFreeForm(true);searchCriteria.reset();deferred.resolve(searchCriteria);return deferred.promise;}]},titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]}).when('/quickpick/:value/',getVehicleSearchRouteMetaData({seoPageName:"quickpick"})).when('/search/:value/',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"search",noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['startupRestService','searchCriteriaFactory','$q','$route',function(startupRestService,searchCriteriaFactory,$q,$route){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);startupRestService.getQuickPicks('VEHICLE_FINDER',function(quickPicks){if(quickPicks&&quickPicks.quickPicksByUri[$route.current.params.value]){var miscFilter=[];miscFilter.push(quickPicks.quickPicksByUri[$route.current.params.value]);searchCriteria.setMiscFilter(miscFilter);searchCriteria.setDisplayStr(quickPicks.displayNameByUri[$route.current.params.value]);deferred.resolve(searchCriteria);}
else{deferred.reject(searchCriteria);}});return deferred.promise;}]},titleKey:"app.quickpick.searchresults.title",descKey:"app.quickpick.searchresults.description",arguments:["searchText"]}).when('/public/quickPickSearch/:pageId/:category/:value/',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"public/quickPickSearch",noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['startupRestService','searchCriteriaFactory','$q','$route',function(startupRestService,searchCriteriaFactory,$q,$route){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var miscFilter=searchCriteria.getMiscFilter();if((!searchCriteria||!miscFilter||miscFilter.length==0)){startupRestService.getQuickPicks($route.current.params.pageId,function(quickPicks){if(quickPicks&&quickPicks.quickPicksByUri[$route.current.params.value]){miscFilter.push(quickPicks.quickPicksByUri[$route.current.params.value]);searchCriteria.setMiscFilter(miscFilter);searchCriteria.setDisplayStr(quickPicks.displayNameByUri[$route.current.params.value]);deferred.resolve(searchCriteria);}
else{deferred.reject(searchCriteria);}});}
else{deferred.resolve(searchCriteria);}
return deferred.promise;}]},titleKey:"app.quickpick.searchresults.title",descKey:"app.quickpick.searchresults.description",arguments:["searchText"]}).when('/public/watchList/',{templateUrl:'/fetchDirective.html?directive=watchlist/watchlistContent',controller:'appController',allowAccess:["ROLE_ANONYMOUS"],title:"Watchlist",pageName:"Public:watchlist",titleKey:"app.header.watchlist.title",descKey:"app.header.watchlist.description",redirectAfterLoginUrl:"/watchList",activeTab:"findVehicles"}).when('/saleListResult/auctionId/:auctionId/:yard/:auctionDate',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]},canonicalRef:'/saleListResult'}).when('/saleListResult/auctionId/:auctionId',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]},canonicalRef:'/saleListResult'}).when('/saleListResult/auctionId/:auctionId/:lane',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]},canonicalRef:'/saleListResult'}).when('/salesListResult/',{templateUrl:'/salesListResultPage',controller:'salesListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sales List",noCache:true,pageName:"upcomingauction_list",scrollRestore:true,scrollRestoreKey:"salesListResult",titleKey:"app.saleslist.title",descKey:"app.saleslist.description",activeTab:"findVehicles"}).when('/saleListResultAll/inventory/:yardNumber',{templateUrl:"/saleListResultAll",controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location)}]},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when('/location/inventory/:yardNumber',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResultAll/auctionId/:auctionId',{templateUrl:'/saleListResultAll',controller:'saleListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when('/saleListResultAll/auctionId/:auctionId/:lane',{templateUrl:'/saleListResultAll',controller:'saleListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollRestoreKey:"saleListResultAll",noCache:true,resolve:{miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResultAll/:yard',{templateUrl:'/saleListResultAll',controller:'saleListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when('/saleListResultAll/:yard/:auctionDate/',{templateUrl:'/saleListResultAll',controller:'saleListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,scrollRestore:true,scrollRestoreKey:"saleListResultAll",resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResultAll/:yard/:auctionDate/:lane',{templateUrl:'/saleListResultAll',controller:'saleListController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollRestoreKey:"saleListResultAll",noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/paymentHistory/',{redirectTo:function(){var paymentDuePreference=(copartUserProvider.$get().config.displayPref&&copartUserProvider.$get().config.displayPref.paymentDuePreference)||{};if(paymentDuePreference&&paymentDuePreference.enableMBPPayments){return"/member-payments/payment-history?viewType=invoice";}else{return;}},templateUrl:function()
{var paymentUrl=(appInit.appPlatform=='gbl')?'/fetchDirective.html?directive=payments/paymentsHistoryGlobal':'/payment-history-view';return paymentUrl;},controller:function()
{var paymentsHistoryController=(appInit.appPlatform=='gbl')?'paymentsHistoryGlobalController':'paymentHistoryController';return paymentsHistoryController;}(),scrollRestore:true,scrollOnEvent:true,resolve:{cldrData:waitForCLDRInitialization.cldrData},scrollRestoreKey:"paymentHistory",pageName:"paymenthistory",activeTab:"payments"}).when('/paymentOptions/',{templateUrl:'/fetchDirective.html?directive=payments/paymentOptions',controller:'appController',pageName:"payment-options"}).when('/login/',{templateUrl:'/login.html',controller:'loginController',pageName:"signin",redirectAfterLoginUrl:"/dashboard",titleKey:"app.login.title",descKey:"app.login.description"}).when('/logout',{templateUrl:function()
{$thisWindow.location.href="/doLogout.html";return null;},controller:'appController',pageName:"logout"}).when('/sso/login/',{templateUrl:'/public/fetchDirective.html?directive=login/ssoLogin',controller:'ssoController'}).when('/vehicleFinderDirective/',{templateUrl:function(){var templateUrl='/public/fetchDirective.html?directive=vehicleFinder/vehicleFinderDirective';var vehicleFinderPreference=copartUserProvider.$get().config.vehicleFinderPreference||{};var hideNewLayout=Boolean(vehicleFinderPreference.hideNewLayout);if(hideNewLayout){templateUrl=templateUrl+'_old';}
return templateUrl;},allowAccess:["ROLE_ANONYMOUS"],pageName:"vehiclefinder",titleKey:"app.vehiclefinder.title",descKey:"app.vehiclefinder.description"}).when('/vehicleFinder/',getVehicleFinderRoute()).when('/lotsWon/',{templateUrl:'/fetchDirective.html?directive=bidStatus/lotswon',controller:'bidStatusLotsWonController',scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"lotsWon",noCache:true,pageName:"lotswon",resolve:{cldrData:waitForCLDRInitialization.cldrData},activeTab:"bidStatus"}).when('/lotsLost/',{templateUrl:'/fetchDirective.html?directive=bidStatus/lotslost',controller:'bidStatusLotsLostController',scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"lotsLost",noCache:true,pageName:"lotslost",activeTab:"bidStatus"}).when('/compareLots/:lotIdList/',{templateUrl:'/public/fetchDirective.html?directive=lotDetail/compareLotSearch_'+appInit.appPlatform,controller:'compareLotsController',allowAccess:["ROLE_ANONYMOUS"],pageName:"comparevehicles"}).when('/lotDetail/:lotId/:showAllPhotos?',{allowAccess:["ROLE_ANONYMOUS"],redirectTo:"/lot/:lotId",titleKey:"app.lotdetails.title",descKey:"app.lotdetails.description",arguments:["lotDesc","yardName","saleDate"]}).when('/lot/:lotId/Photos/:lotInfo?',{templateUrl:'/public/fetchDirective.html?directive=lotDetail/lotdetails',controller:'lotDetailsController',restoreUrlOnLogin:true,allowAccess:["ROLE_ANONYMOUS"],resolve:{lazyLoadPageBundle:lazyLoadFiles([getResourcePath("LOT_DETAILS_BUNDLE")]),staticLotDetails:['startupRestService','$q','$route',function(startupRestService,$q,$route){var deferred=$q.defer();var lotId=$route.current.params.lotId;startupRestService.getLotDetails(lotId,function(response){deferred.resolve(response.data);});return deferred.promise;}],cldrData:waitForCLDRInitialization.cldrData},pageName:"lotdetails",titleKey:"app.lotdetails.title",descKey:"app.lotdetails.description",titleArguments:["lotDesc","yardName","saleDate"],descArguments:["lotDesc","yardName","saleDate"]}).when('/lot/:lotId/:lotInfo?',{templateUrl:'/public/fetchDirective.html?directive=lotDetail/lotdetails',controller:'lotDetailsController',restoreUrlOnLogin:true,allowAccess:["ROLE_ANONYMOUS"],resolve:{lazyLoadPageBundle:lazyLoadFiles([getResourcePath("LOT_DETAILS_BUNDLE")]),staticLotDetails:['startupRestService','$q','$route',function(startupRestService,$q,$route){var deferred=$q.defer();var lotId=$route.current.params.lotId;startupRestService.getLotDetails(lotId,function(response){deferred.resolve(response.data);});return deferred.promise;}],cldrData:waitForCLDRInitialization.cldrData},pageName:"lotdetails",titleKey:"app.lotdetails.title",descKey:"app.lotdetails.description",titleArguments:["lotDesc","yardName","saleDate"],descArguments:["lotDesc","yardName","saleDate"]}).when('/manageCounterman/',{templateUrl:'/fetchDirective.html?directive=counterman/counterman',controller:'manageCountermanController',pageName:"profile_managecounterman"}).when('/findAPart/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/counterman/findapart',pageName:"findapart",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/paymentsDue/',{redirectTo:function(){var paymentDuePreference=(copartUserProvider.$get().config.displayPref&&copartUserProvider.$get().config.displayPref.paymentDuePreference)||{};if(paymentDuePreference&&paymentDuePreference.enableMBPPayments){return"/member-payments/unpaid-invoices/";}else{return;}},templateUrl:function()
{var paymentUrl=(appInit.appPlatform=='gbl')?'/fetchDirective.html?directive=payments/paymentsDue/paymentsDueGlobal':'/fetchDirective.html?directive=payments/paymentsDue/paymentsDue';return paymentUrl;},controller:function()
{var paymentController=(appInit.appPlatform=='gbl')?'paymentsDueGlobalController':'paymentsDueController';return paymentController;}(),scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"paymentsDue",resolve:{cldrData:waitForCLDRInitialization.cldrData},blockAccess:["ROLE_BROKER_BIDDER"],altRoute:"/contactBroker",pageName:"paymentsdue",activeTab:"payments"}).when('/paymentsDueNew/:param1?/',{blockAccess:["ROLE_BROKER_BIDDER"],template:'',isAngularRoute:true}).when('/paymentsDueOld/',{templateUrl:'/fetchDirective.html?directive=payments/paymentsDue/paymentsDue',controller:'paymentsDueController',resolve:{cldrData:waitForCLDRInitialization.cldrData},activeTab:"payments",blockAccess:["ROLE_BROKER_BIDDER"]}).when('/paymentHistoryOld/',{templateUrl:function()
{var paymentUrl=(appInit.appPlatform=='gbl')?'/fetchDirective.html?directive=payments/paymentsHistoryGlobal':'/payment-history-view';return paymentUrl;},controller:function()
{var paymentsHistoryController=(appInit.appPlatform=='gbl')?'paymentsHistoryGlobalController':'paymentHistoryController';return paymentsHistoryController;}(),scrollRestore:true,scrollOnEvent:true,resolve:{cldrData:waitForCLDRInitialization.cldrData},scrollRestoreKey:"paymentHistory",pageName:"paymenthistory",activeTab:"payments"}).when('/select/protectionpledge/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/copart-select-protection-pledge',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"selectprotectionpledge"}).when('/makePayment/',{templateUrl:'/fetchDirective.html?directive=payments/paymentsDue/makePayment',controller:'makePaymentController',resolve:{cldrData:waitForCLDRInitialization.cldrData},pageName:"makePayment",activeTab:"payments"}).when('/MEAPaymentRedirection/:currencyCode',{templateUrl:function($routeParams)
{return'/MEAPaymentConfirmation/'+$routeParams.currencyCode+'?orderRefId='+$routeParams.ref;},pageName:"networkOnlineResponse"}).when('/auctionDashboard',{templateUrl:'/public/fetchDirective.html?directive=auction/auctionDashboard',controller:'auctionDashboardController',pageName:"auctionjoin",titleKey:"app.auctiondashboard.title",descKey:"app.auctiondashboard.description",activeTab:"Auctions"}).when('/auctions/auctionDashboard',{redirectTo:"/auctionDashboard",activeTab:"Auctions"}).when('/invoiceDetails/:invoiceId/:paymentType/:selectedCurrency/',{templateUrl:'/fetchDirective.html?directive=payments/paymentsDue/invoiceDetails',controller:'invoiceDetailsController',pageName:"invoice"}).when('/invoiceDetails/:invoiceId/:paymentType/:selectedCurrency/:invoiceType/:lotNumber/:secretId?/:bidderNumber?',{templateUrl:'./fetchDirective.html?directive=payments/paymentsDue/invoiceDetails',controller:'invoiceDetailsController',pageName:"invoice"}).when('/paidInvoicesList/:transactionId?/:paymentType?/:paidInvoiceSecretId?/:currencyCode?',{templateUrl:'/fetchDirective.html?directive=payments/paymentsDue/paidInvoiceList',controller:'paidInvoiceListController',pageName:"paymentsdue"}).when('/inspectors',{templateUrl:'/public/fetchDirective.html?directive=support/services/inspectors',controller:'SupportServicesController',allowAccess:["ROLE_ANONYMOUS"],title:"Inspectors",pageName:"inspector_services",titleKey:"app.inspectors.title",descKey:"app.inspectors.description",reloadOnSearch:false,activeTab:"services"}).when('/inspectorDetails/:inspectorNumber/',{templateUrl:'/public/fetchDirective.html?directive=support/services/inspectorDetails',controller:'InspectorController',allowAccess:["ROLE_ANONYMOUS"],title:"Inspector Details",pageName:"inspectordetails_services"}).when('/brokersmarketmakers/:tab/',{templateUrl:'/public/fetchDirective.html?directive=support/services/brokersmarketmakers',controller:'SupportServicesBrokersController',allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers",titleKey:"app.brokersmarketmakers.title",descKey:"app.brokersmarketmakers.description",activeTab:"services"}).when('/hireabroker/:lotNumber',{templateUrl:'/fetchDirective.html?directive=broker/hireABroker',controller:'hireABrokerController',allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:['startupRestService','$q','$route',function(startupRestService,$q,$route){var deferred=$q.defer();var lotNumber=$route.current.params.lotNumber;startupRestService.getLotDetails(lotNumber,function(response){deferred.resolve(response.data);});return deferred.promise;}]},pageName:"hirebroker"}).when('/brokerdetail/:lotNumber/:brokerID',{templateUrl:'/fetchDirective.html?directive=broker/brokerDetail',controller:'brokerDetailController',allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:['startupRestService','$q','$route',function(startupRestService,$q,$route){var deferred=$q.defer();var lotNumber=$route.current.params.lotNumber;startupRestService.getLotDetails(lotNumber,function(response){deferred.resolve(response.data);});return deferred.promise;}]},pageName:"broker_detail"}).when('/viewbroker/:brokerNumber/',{templateUrl:'/public/fetchDirective.html?directive=support/services/viewbroker',controller:'SupportServicesViewBrokerController',allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers_"}).when('/towproviders/',{templateUrl:'/public/fetchDirective.html?directive=support/services/towProviders',controller:'TowProviderContactUsController',allowAccess:["ROLE_ANONYMOUS"],pageName:"towproviders",titleKey:"app.towproviders.title",descKey:"app.towproviders.description"}).when('/viewmarketmaker/:marketMaker/',{templateUrl:'/public/fetchDirective.html?directive=support/services/viewmarketmaker',controller:'SupportServicesViewMarketMakerController',allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers"}).when('/brokerProfile/',{templateUrl:'/fetchDirective.html?directive=broker/brokerprofile',controller:'brokerProfileController',pageName:"broker-profile",activeTab:"myAccount"}).when('/countermanInventorySearchResults/',{templateUrl:'/fetchDirective.html?directive=counterman/inventorySearchResults',controller:'inventorySearchResultsController',pageName:"counterman-inventory-search-results"}).when('/aboutus/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/about-copart/about-copart',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"aboutus"}).when('/aboutusDir/',{templateUrl:'/public/fetchDirective.html?directive=cms/cmsDirective'}).when('/helpWithLicensing/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/licensing/index',pageName:"licensing",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when('/copartreview/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/landing-page/copart-reviews?intcmp=footer_aboutcopart_copartreviews',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"copartreview"}).when('/glossary/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/support/faq-topics/common-terms',pageName:"faq_common-terms",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/paymentOptions/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/buyer/payments/payment-options',pageName:"paymentoptions",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/sellForDealers/',{templateUrl:'/public/fetchDirective.html?directive=sell/sellForDealers',controller:'registrationController',pageName:"dealeradvantage",activeTab:"sellAVehicle"}).when('/messagesettings/email-subscriptions/',{templateUrl:'/fetchDirective.html?directive=accountinfo/messagesettings',controller:'emailSubscriptionController',pageName:"message-settings",activeTab:"myAccount"}).when('/messagesettings/text-subscriptions/',{templateUrl:'/fetchDirective.html?directive=accountinfo/messagesettings',controller:'textMessageSubscriptionController',pageName:"message-settings",activeTab:"myAccount"}).when('/messagesettings/:navMenu/',{templateUrl:'/fetchDirective.html?directive=accountinfo/messagesettings',controller:'MessageSettingsController',pageName:"message-settings",activeTab:"myAccount"}).when('/termsAndConditions/',{templateUrl:'/public/fetchDirective.html?directive=login/termsandcondition',controller:'termsAndConditionsController',pageName:"member-terms-and-conditions",hideAccntAlerts:true}).when('/sellForIndividuals/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/how-to-sell/for-individual.html',controller:'SellByIndividualController',resolve:waitForReferenceDataInitialization,pageName:"howtosell_individual",titleKey:"app.sellForIndividual.title",descKey:"app.sellForIndividual.description",activeTab:"sellAVehicle"}).when('/sellForBusiness/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/how-to-sell/for-business.html',controller:'SellByBusinessOrDealerController',pageName:"howtosell_business",titleKey:"app.sellForBusiness.title",descKey:"app.sellForBusiness.description",activeTab:"sellAVehicle"}).when('/BreakerBid4U/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/breakerbid4u',controller:'breakerBid4UController',pageName:"BreakerBid4U",activeTab:"services"}).when('/vehicleDelivery/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/vehicledelivery',controller:'vehicleDeliveryController',pageName:"vehicleDelivery",activeTab:"services"}).when('/sellForDealer/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/how-to-sell/for-dealer-advantage.html',controller:'SellByBusinessOrDealerController',pageName:"dealeradvantage",titleKey:"app.sellForDealer.title",descKey:"app.sellForDealer.description"}).when('/aboutus2/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/about-copart/about-copart-g2',pageName:"about-us",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/overview/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/support/how-to-buy/overview',pageName:"htb_overview",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when('/how-it-works/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/how-it-works',pageName:"how-it-works",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"how-it-works"}).when('/faq/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/support/faq-topics/buying',pageName:"faq_buying",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when('/cms/pressreleases/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/press-releases/index',pageName:"press-release",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/howVb3Works/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/support/how-vb3-works',pageName:"how-vb3-works",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when('/investorrelation/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/investor-relations/investor-relations',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"investorrelation"}).when('/unknown-error',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/landing-page/page-not-available'}).when('/notfound-error',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/landing-page/page-not-available'}).when('/copartVideos/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/videos/popular',controller:'copartVideosController',pageName:"videos_copartvideos",titleKey:"app.videos.title",descKey:"app.videos.description",activeTab:"support"}).when('/memberFees/',{templateUrl:function()
{var templateUrl='/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString;return templateUrl+((appInit.regionCode=='uk')?'/landing-page/member-fees':'/premier-member-fees');},blockAccess:["ROLE_ANONYMOUS"],altRoute:'/login',activeTab:"myAccount",pageName:"memberFees"}).when('/public/memberFees/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/premier-member-fees'}).when('/termsofservice',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/terms-of-service',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/privacypolicy',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/privacy-policy',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/termConditionModal',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/member-terms-and-conditions',controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when('/confirmSubscription',{templateUrl:'/public/fetchDirective.html?directive=registration/confirmSubscription',pageName:"confirmEmailSubscription",controller:'confirmEmailSubscriptionController'}).when('/confirmUnSubscription',{templateUrl:'/public/fetchDirective.html?directive=registration/confirmSubscription',pageName:"confirmEmailSubscription",controller:'confirmEmailSubscriptionController'}).when('/network-response',{templateUrl:'/public/fetchDirective.html?directive=uitemp/network-response',controller:'appController',pageName:"network-response"}).when('/ctv',{caseInsensitiveMatch:true,templateUrl:'/CMS/content/us/en/ctv',controller:'validateTowProviderController'}).when('/member-subscriptions',{templateUrl:'/public/fetchDirective.html?directive=login/memberSubscriptions',controller:'accountInfoSubscriptionPreferenceController'}).when('/document-status-pending',{templateUrl:'/public/fetchDirective.html?directive=login/documentApprovalPending',controller:'awaitingDocApprovalController'}).when('/help',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/content-search',controller:'helpController',activeTab:"support",pageName:"help"}).when('/help/results',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/content-search',controller:'helpController',activeTab:"support",pageName:"help/results"}).when('/kiosk/login?',{templateUrl:function($location){if(!_.isUndefined($location.uid))
return'/public/member/login?uid='+$location.uid;else
return'/public/member/login';},controller:'loginController',pageName:"signin"}).when('/kiosklotSearchResults',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results"}).when('/regstep2',{templateUrl:'/public/fetchDirective.html?directive=registration/step2',controller:'step2Controller'}).when('/intlShippingSearch',{templateUrl:'/public/fetchDirective.html?directive=transportation/intlShippingSearch',controller:'intlShippingSearchController',allowAccess:["ROLE_ANONYMOUS"]}).when('/esign-document/:formtype',{templateUrl:'/fetchDirective.html?directive=copartForms/copartFormHolder',controller:'copartFormBaseController',pageName:'copart-form',hideAccntAlerts:true}).when('/member-fees-us-licensed/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/member-fees-us-licensed',controller:'licensedMemberFeesController',pageName:"member-fees-us-licensed",blockAccess:["ROLE_ANONYMOUS"],altRoute:'/login',activeTab:"myAccount"}).when('/member-fees-us-non-licensed/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/member-fees-us-non-licensed',pageName:"member-fees-us-non-licensed",blockAccess:["ROLE_ANONYMOUS"],altRoute:'/login',activeTab:"myAccount"}).when('/payments/',{templateUrl:'/fetchDirective.html?directive=payments/payments',controller:'paymentsController',scrollRestoreKey:"payments",pageName:"payments",activeTab:"payments"}).when('/member-payments/:param1?/:param2?/:param3?',{template:'',activeTab:"payments",isAngularRoute:true}).when('/select/',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/select',pageName:"copart-select",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",caseInsensitiveMatch:true}).when('/blog',{templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/blog',pageName:"blog",controller:'cmsController',titleArguments:["title"],descArguments:["description"],titleKey:"app.blog.title",descKey:"app.blog.description",caseInsensitiveMatch:true}).when('/blog/:langCode/:blogTitle/',{templateUrl:function(params){return'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/'+params.blogTitle;},pageName:"blogDetail",controller:'cmsController',titleArguments:["title"],descArguments:["description"],caseInsensitiveMatch:true}).when('/noSearchResults',{templateUrl:function(){return undefined;},isAngularRoute:true}).otherwise({templateUrl:'/CMS/'+appInit.localeString+'/content/'+appInit.regionCode+'/'+appInit.localeString+'/landing-page/page-not-available',controller:['$scope',function($scope){$scope.message='Stay tuned!!!';}],allowAccess:["ROLE_ANONYMOUS"]});if(getCookieByName("classicSearchResultsView")==="true"){$routeProvider.when('/lotSearchResults',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"searchResults",reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,lazyLoadPageBundle:lazyLoadFiles([getResourcePath("SEARCH_RESULTS_BUNDLE")]),miscSearchQuery:['searchCriteriaFactory','$location','startupRestService','urlService','$q','$filter',function(searchCriteriaFactory,$location,startupRestService,urlService,$q,$filter){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var searchQuery=$filter('sanitize_html')($location.search().query);if($location.search().YardNumber&&$location.search().searchTitle){var yard=$location.search().YardNumber;var displayStr=$location.search().searchTitle;var newUrl="/saleListResult/"+yard+"/?location="+displayStr;$location.url(newUrl).replace();return;}
if(!_.isUndefined(searchQuery)&&!_.isNull(searchQuery)&&!isNaN(searchQuery)&&!_.isEmpty(searchQuery)&&searchQuery.length>4){var lotSearchArr=[];lotSearchArr.push("ps_lot_number:"+searchQuery);var lotSearchCriteria={MISC:lotSearchArr};searchCriteria.setMiscFilter(lotSearchArr);startupRestService.getLotsByLotNumber({filter:lotSearchCriteria},function(response){try{if(!_.isUndefined(response.data.data.results.content)&&response.data.data.results.content.length==1){var lot=response.data.data.results.content[0];$location.url(urlService.lotDetailUrl+lot.ln);}else if(response.data.data.results.content.length==0){searchCriteria.reset();deferred.resolve(searchCriteria);}
else{searchCriteria.setMiscFilter(lotSearchArr);deferred.resolve(searchCriteria);}}catch(e){searchCriteria.reset();deferred.resolve(searchCriteria);}});}else{searchCriteria.reset();deferred.resolve(searchCriteria);}
return deferred.promise;}]},titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]}).when('/saleListResult/:yard/:auctionDate',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResultWithDate.title",descKey:"app.label.saleListResultWithDate.description",arguments:["searchText","auctionDate"],noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResult/state/:country/:state',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResult/:yard/:auctionDate/:lane',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResult/:yard',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/saleListResult/inventory/:yardNumber',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q','$route','$location',function(searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(searchCriteria,$q,$route,$location);}]}}).when('/watchList',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',title:"Watchlist",noCache:true,scrollOnEvent:true,scrollRestore:true,reloadOnSearch:false,scrollRestoreKey:"watchlist",allowAccess:["ROLE_ANONYMOUS"],resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:['searchCriteriaFactory','$q',function(searchCriteriaFactory,$q){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);searchCriteria.reset();deferred.resolve(searchCriteria);return deferred.promise;}]},pageName:"watchlist",titleKey:"app.header.watchlist.title",descKey:"app.header.watchlist.description",activeTab:"findVehicles"}).when('/vehicleFinderSearch',{templateUrl:'/lotSearchResultsPage',controller:'lotSearchResultsController',allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestore:true,scrollRestoreKey:"vehicleFinderSearch",resolve:{miscSearchQuery:['searchCriteriaFactory','$location','History',function(searchCriteriaFactory,$location,History){var searchStr=$location.search().searchStr;var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);if(_.isUndefined(searchStr)){history.pushState(null,null,"/"+History.secondLastRoute);var vehicleFinderSearch={"MISC":searchCriteria.getMiscFilter(),"sortByZip":searchCriteria.getSortByZip(),"buyerEnteredZip":searchCriteria.getBuyerEnteredZip(),"milesAway":searchCriteria.getMilesAway()};$location.search("searchStr",JSON.stringify(vehicleFinderSearch));}else{searchCriteria.reInitialize(JSON.parse($location.search().searchStr));}
return searchCriteria;}]},titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]})}else{var searchResultsRouteConfig={templateUrl:fetchSearchResultStyles,resolve:{lazyLoadPageBundle:function(){}},reloadOnSearch:false,isAngularRoute:true};$routeProvider.when('/lotSearchResults',searchResultsRouteConfig).when('/saleListResult/:yard',searchResultsRouteConfig).when('/saleListResult/:yard/:auctionDate',searchResultsRouteConfig).when('/saleListResult/state/:country/:state',searchResultsRouteConfig).when('/saleListResult/:yard/:auctionDate/:lane',searchResultsRouteConfig).when('/saleListResult/inventory/:yardNumber',searchResultsRouteConfig).when('/watchList',searchResultsRouteConfig).when('/vehicleFinderSearch',searchResultsRouteConfig)}}]);var fetchSearchResultStyles=function(){if(appInit.initialPageLayout!==appInit.layout.SEARCH_RESULTS_PAGE){return"/public/fetchDirective.html?directive=lotSearchResult/lotSearchResultStyles"}
return undefined;}
app.factory('authHttpResponseInterceptor',['$q','$location','$window','$log','copartUser','urlStore','HttpPendingRequestsService','userService',function($q,$location,$window,$log,copartUser,urlStore,HttpPendingRequestsService,userService){return{response:function(response){var contentPath=location.pathname;var contentPathWithNoTrailingSlash=contentPath.substr(-1)==='/'?contentPath.substr(0,contentPath.length-1):contentPath;if(urlStore.protectedUrls.indexOf(contentPathWithNoTrailingSlash)>-1&&userService.isAnonymous()){$location.url('/login?redirectUrl='+contentPath);}
return response||$q.when(response);},responseError:function(rejection){if(rejection.status===401){jQuery('.modal-backdrop').remove();HttpPendingRequestsService.cancelAll();copartUser.refreshAndGetConfig().then(function(){$window.location.href=urlStore.login+"?redirectUrl="+encodeURIComponent($location.url());});}else if(rejection.status===403){console.error("Access denied 403:",rejection);jQuery('#UnAuthorizedAccessModal').modal('show');}
else if(rejection.status===460||rejection.status==='460'){HttpPendingRequestsService.cancelAll();$window.location.href="/termsAndConditions";}
else if(rejection.status===461||rejection.status=='461'||rejection.status==469){HttpPendingRequestsService.cancelAll();$window.location.href="/redirectToPaymentGateway/renewal";}
else if(rejection.status===462||rejection.status=='462'){HttpPendingRequestsService.cancelAll();$window.location.href="/collect-security-questions";}
else if(rejection.status===463||rejection.status=='463'){HttpPendingRequestsService.cancelAll();$window.location.href="/member-subscriptions";}
else if(rejection.status===467||rejection.status=='467'){HttpPendingRequestsService.cancelAll();$window.location.href="/document-status-pending";}
else if(rejection.status===500||rejection.status===503){try{$log.error(rejection.status+" ERROR");console.log(rejection);var url='';if(rejection&&rejection.config&&rejection.config.url){url=rejection.config.url||'';url=url.toLowerCase();}
$log.error("Error fetching the source for "+url);}catch(e){console.error(e);}}
return $q.reject(rejection);}}}]);app.factory('templateInterceptor',['$q',function($q){return{response:function(response){return response||$q.when(response);},responseError:function(rejection){return $q.reject(rejection);}}}]);var waitForCLDRInitialization={cldrData:['$q',function($q){var deferred=$q.defer();if(app.globalizeNumberFormatter){deferred.resolve(app.globalizeNumberFormatter);}
else{app.globalizeNumberFormatterPromise=deferred;}
return deferred.promise;}]};var waitForReferenceDataInitialization={referenceData:['appConfigService','$q',function(appConfigService,$q){var deferred=$q.defer();if(!appConfigService.isLoaded){appConfigService.isLoaded=deferred;}
else{deferred.resolve(appConfigService.isLoaded);}
return deferred.promise;}]};var waitForReferenceDataMoreInitialization={referenceData:function(){return true;}};function searchFunctionForSalelist(searchCriteria,$q,$route,$location){var deferred=$q.defer();var saleDateInUrl=$location.search().saleDate;searchCriteria.reset();var miscFilter=searchCriteria.getMiscFilter();if($route.current.params.auctionId)
{miscFilter.push("auction_id:"+$route.current.params.auctionId);}
if($route.current.params.yard){miscFilter.push("auction_host_id:"+$route.current.params.yard);}
if($route.current.params.yardNumber){miscFilter.push("physical_yard_number:"+$route.current.params.yardNumber);}
if($route.current.params.lane){miscFilter.push("auction_lane:"+$route.current.params.lane);}
var auctionId=$location.search().auctionId;if(auctionId){miscFilter.push("auction_assignment_number:"+auctionId);}
if($route.current.params.country){var threeCharCountryCode=$route.current.params.country.toUpperCase();miscFilter.push("location_country:"+threeCharCountryCode);}
if($route.current.params.state){var stateCode=$route.current.params.state.toUpperCase();miscFilter.push("location_state:"+stateCode);}
if(saleDateInUrl&&$route.current.params.auctionDate){saleDateInUrl=moment.utc(parseInt(saleDateInUrl));miscFilter.push("auction_date_utc:"+getFullDayRange(saleDateInUrl));if(!$route.current.params.auctionId){miscFilter.push("auction_date_type:F");}}
else if($route.current.params.auctionDate){var auctionDate=$route.current.params.auctionDate;miscFilter.push("auction_date_utc:"+getFullDayRange(moment(auctionDate).utc(auctionDate)));if(!auctionId){miscFilter.push("auction_date_type:F");}}else if(saleDateInUrl=="Future"){var currentSaleDate=$location.search().recentSale;var nextSaleDate=$location.search().nextSale;var fixedAuctionDate=(nextSaleDate)?nextSaleDate:currentSaleDate;if(fixedAuctionDate){miscFilter.push("auction_date_utc:"+getFutureRange(moment(fixedAuctionDate).utc(fixedAuctionDate))+"+OR+auction_date_type:E");}
else if($route.current.params.from=="/lot"){miscFilter.push("auction_date_type:E");}
else{if(!auctionId){miscFilter.push("auction_date_type:F");}}}
searchCriteria.setMiscFilter(miscFilter);deferred.resolve(searchCriteria);return deferred.promise;};

function NumberFormatterUtils(){var self=this;self.phoneNumFormatter={GBR:"0{3} {3} {4}",IRL:"{3} {3}-{4}",ARE:"{2} {3}-{4}",BHR:"{4}-{4}",OMN:"{4}-{4}",US:"({3}) {3}-{4}",USA:"({3}) {3}-{4}",CAN:"({3}) {3}-{4}"};self.formatPhoneNumber=function(input,countryCode){if(countryCode=="OMN"||countryCode=="BHR"){input=input.substr(1);}
var number=String(input);number=number.replace(/[^\d]/g,'');for(var code in self.phoneNumFormatter){if(code==countryCode){var format=self.phoneNumFormatter[code];var pattern=self.generatePattern(format);var tempformat=self.phoneNumFormatter[code];var length=0;format=format.replace(/[^\d]/g,'');for(var i=0;i<format.length;i++){length+=Number(format[i]);}
if(number.length>length){number=number.substring((number.length-length),number.length-1);}
number=number.replace(new RegExp(pattern,''),self.constructDelimitedPattern(tempformat));}}
return number;};self.constructDelimitedPattern=function(format){format=format.replace(/{([^}]*)}/g,"^");var returnVal='';var index=1;for(var i=0;i<format.length;i++)
{if(format[i]=='^')
{returnVal=returnVal+'$'+index++;}
else
{returnVal=returnVal+format[i];}}
return returnVal;};self.generatePattern=function(str){var re=/{([^}]+)}/g;var text;var pattern="";while(text=re.exec(str)){pattern+="(\\d{"+text[1]+"})";}
return pattern;};};
'use strict';app.service('copartUtils',['userService','$interpolate',function(userService,$interpolate){var self=this;self.locale={};var log=new Logger({name:'copartUtils'});var vehicleFinderPreference=userService.userConfig.vehicleFinderPreference||{};self.mailTo=function(to,subj,body,signature){var envelope="mailto:"+to+"?Subject="+subj+"&body="+body;return envelope;};self.splitArrayIntoChunks=function(array,size){var results=[];while(array.length){results.push(array.splice(0,size));}
return results;};self.splitIntoArray=function(input,delimiter,trimspaces){if(input.length>1){delimiter=(delimiter==null)?",":delimiter;if((typeof delimiter=='undefined')&&delimiter.length<1){delimiter=",";}
var _eleArray=input.split(delimiter);trimspaces=(trimspaces==null||trimspaces===false)?false:true;if(trimspaces){for(var i=0;i<_eleArray.length;i++){_eleArray[i]=_eleArray[i].replace(/\s+/g,'');}}
return _eleArray;}else{console.log("Invalid input to parse");}};self.validateFile=function(inputFile,validFormats,sizeLimit){var isValidFormat=false;if(typeof sizeLimit!=="undefined"){if(inputFile.size>sizeLimit){return false;}}
var _fileUploadedExt=inputFile.name.substring(inputFile.name.lastIndexOf(".")+1,inputFile.name.length);for(var i=0;i<validFormats.length;i++){if(_fileUploadedExt.toLowerCase()==validFormats[i].toLowerCase()){isValidFormat=true;break;}}
return isValidFormat;};self.getLanguageFromAbbreviation=function(langAbbreviations,locale,delimiter){var languages={};delimiter=(delimiter==null)?"|":delimiter;var langsAbbrArray=langAbbreviations.split(delimiter);for(var i=0;i<langsAbbrArray.length;i++){languages[i]=locale.getMessage('app.lang.'+langsAbbrArray[i].trim());}
return languages;};self.closeModal=function(id){$('#'+id).modal('hide');$('body').removeClass('modal-open');$('.modal-backdrop').remove();};self.isNumber=function($event){if(isNaN(String.fromCharCode($event.keyCode))){$event.preventDefault();return false;}
return true;};self.clubFacets=function(items,quickPickCode){if(quickPickCode.indexOf("SDAT")>-1){var retArr=[];var momentDateFormat=userService.userConfig.displayPref.dateFormat.toUpperCase();;items=_.chain(items).groupBy(function(item){var utcDate=moment.utc(item.displayName.toUpperCase(),moment.ISO_8601);var date=utcDate.tz(userService.userConfig.selectedTimezone).format(momentDateFormat);item.query="auction_date_utc:"+getFullDayRange(utcDate);item.displayName=date;return date;}).mapObject(function(facets,key){var retObj=_.clone(_.first(facets));var counts=_.pluck(facets,'count');var sum=_.reduce(counts,function(memo,num){return memo+num;},0);retObj.count=sum;return retObj;}).values().value();return items;}else{return items;}};self.appendQueryStringToURL=function appendQueryString(url,queryVars){var firstSeperator=(url.indexOf('?')==-1?'?':'&');var queryStringParts=new Array();for(var key in queryVars){if(!_.isUndefined(queryVars[key])){queryStringParts.push(key+'='+queryVars[key]);}}
var queryString=queryStringParts.join('&');return url+firstSeperator+queryString;};self.isNullOrBlank=function(str){return!!(str||'').match(/^\s*$/);};self.formatCopartDate=function(date){if(date){var year=date.substr(0,4);var month=date.substr(4,2);var day=date.substr(6,2);return year+"-"+month+"-"+day}
return'';};self.validateVIN=function(vin){var searchVinLength=vehicleFinderPreference.searchVinLength||17;var regEx=vehicleFinderPreference.regEx||"^[A-HJ-NPR-Z\\d]{8}[\\dX][A-HJ-NPR-Z\\d]{2}\\d{6}$";if(vin.length!==searchVinLength)return false;vin=vin.toUpperCase();var re=new RegExp(regEx);return vin.match(re);};self.validateLotNumber=function(lotNumber){if(lotNumber){var regEx=new RegExp("^[0-9]{3,10}$");return regEx.test(lotNumber);}
return false;}
self.getUnFormattedUrl=function(url){url=url||'';if(url.charAt(0)==='.'&&url.charAt(1)==='/'){return url.substring(1);}else if(url.charAt(0)==='/'){return url;}else{return"/"+url;}};self.getFormattedUrlForLocale=function(url){url=url||'';if(url.charAt(0)==='.'&&url.charAt(1)==='/'){return url;}else if(url.charAt(0)==='/'){return"."+url;}else{return"./"+url;}};self.validateIfImage=function(url){url=url||'';return(/\.(gif|jpg|jpeg|tiff|png)$/i).test(url);};self.removeTrailingSlash=function(url){url=url||'';try{return url.charAt(url.length-1)==='/'?url.slice(0,url.length-1):url;}catch(e){log.error("Error in removeTrailingSlash for "+url,e)}};self.removeDoubleQuotes=function(string){try{return!_.isEmpty(string)?string.replace(/"/g,""):'';}catch(e){log.error("Error while removing trailing double quotes from "+string,e);}};self.getSiteRegionCode=function(){return userService.userConfig.siteRegionCode;}
self.getFormDataForLicenseUpload=function(licenseFiles,params){var formData=new FormData();_.each(licenseFiles,function(licenseFile,index){formData.append('documentServiceInquiryVOS['+index+'].file',licenseFile.file);formData.append('documentServiceInquiryVOS['+index+'].documentCategory',licenseFile.documentCategory);if(file.documentMetaData.documentNumber){formData.append('documentServiceInquiryVOS['+index+'].documentNumber',licenseFile.documentNumber);}
if(file.documentMetaData.country){formData.append('documentServiceInquiryVOS['+index+'].documentCountry',licenseFile.country);}
if(file.documentMetaData.state){formData.append('documentServiceInquiryVOS['+index+'].documentState',licenseFile.state);}
if(file.documentMetaData.expDate){formData.append('documentServiceInquiryVOS['+index+'].expiryDate',licenseFile.expDate);}});formData.append('applicationName',params.applicationName||'G2MBR');formData.append('destination',params.destination||'CAS');formData.append('fileType',params.fileType||'DOCUMENT');formData.append('documentType',params.documentType||'BUYER_LICENSE');formData.append('objectType',params.objectType||'MEMBER');formData.append('country',self.getSiteRegionCode());return formData;}
self.bytesToSize=function(bytes,decimalPoint){if(bytes==0)return'0 Bytes';var k=1024,dm=decimalPoint||2,sizes=['Bytes','KB','MB','GB','TB','PB','EB','ZB','YB'],i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(dm))+' '+sizes[i];};self.isNonSyncedBuyer=function(){return userService.userConfig.isNonSyncedBuyer;};self.sanitizePhoneNumber=function(phoneVO){if(phoneVO&&phoneVO.phoneNumber){var phoneNumber=phoneVO.phoneNumber+"";return phoneNumber.replace(/[^a-zA-Z0-9]+/g,'');}};self.setCountryCodeForAddress=function(address){if(_.isEmpty(address)){return{};}
var addressWithCountryCode=angular.copy(address);addressWithCountryCode.country=address.country?address.country.code:"";return addressWithCountryCode;};self.updatedConfig=function(data){if(data){return{'selectedLang':data['selectedLang'],'selectedTimezone':data['selectedTimezone'],'zipToCoordinate':data['zipToCoordinate']}}};self.parseJwt=function(token){if(token){var base64Url=token.split('.')[1];var base64=base64Url.replace(/-/g,'+').replace(/_/g,'/');var jsonPayload=decodeURIComponent(atob(base64).split('').map(function(c){return'%'+('00'+c.charCodeAt(0).toString(16)).slice(-2);}).join(''));return JSON.parse(jsonPayload);}
return null;};self.mapPhysicalAddress=function(params){var address=new AddressVO();if(params){address.line1=params.addressLine1;address.line2=params.addressLine2;address.city=params.city;address.state=params.state;address.country=params.country;address.postCode=params.zip1;}
return address;};self.formattedDate=function(date,inputDateFormat,outputDateFormat){if(_.isUndefined(date)){return;}
var formattedDate=moment(date,(inputDateFormat||"YYYYMMDD"));return formattedDate.format(outputDateFormat||("MMMM Do YYYY"));};self.appendScriptsToDOM=function(filePath){if(!(document.querySelector('script[src="'+filePath+'"]'))){var script=document.createElement('script');script.src=filePath;var bodyElement=$(document).find('body');if(bodyElement&&bodyElement.length>0){bodyElement[0].appendChild(script);}}}
self.appendLinksToDOM=function(filePath){if(!(document.querySelector('link[href="'+filePath+'"]'))){var linkElement=document.createElement('link');linkElement.setAttribute('rel','stylesheet');linkElement.setAttribute('type','text/css');linkElement.setAttribute('href',filePath);var bodyElement=$(document).find('body');if(bodyElement&&bodyElement.length>0){bodyElement[0].appendChild(linkElement);}}}
self.getTwoCharFromThreeCharCntryCode=function(countryList,threeCharCntryCode){if(threeCharCntryCode){var countryObj=_.find(countryList,{code:threeCharCntryCode})||{};if(!_.isEmpty(countryObj)){return countryObj.twoCharCountryCode&&countryObj.twoCharCountryCode.toLowerCase();}}
return"";}
self.isResponseValid=function(response){return response&&response.returnCode!==-1&&response.data;}
self.isNestedResponseValid=function(response){return response&&response.data&&response.data.returnCode!==-1&&response.data.data;}
self.getRouteParamToFilterQuickpicks=function(route){var initialParam=route.current.$$route.initialParam;if(!initialParam){initialParam="value";}
return initialParam;};self.showNotificationModal=function(modalId,flag){if(flag){jQuery('#'+modalId).modal('show');}else{jQuery('#'+modalId).modal('hide');jQuery(".modal-backdrop").remove();jQuery('body').removeClass('modal-open');}};self.modifiedVehicleFinderSearchCriteria=function(miscSearchCriteria){angular.forEach(miscSearchCriteria,function(value,index){if(value.indexOf("#LocRange:")>-1){value=JSON.parse(value.replace("#LocRange:",""));var zipQuery=$interpolate("{!geofilt pt={{latitude}}\,{{longitude}} sfield=yard_location d={{miles}}}")(value);miscSearchCriteria.splice(index);miscSearchCriteria.push(encodeURIComponent(zipQuery));}});return miscSearchCriteria;};self.formatQuickPickPathParams=function(value){return value.toLowerCase().replace(/\s+/,'-').replace(/\//,'-');}
self.formatQuickPickPathParams=function(value){return value.toLowerCase().replace(/\s+/,'-').replace(/\//,'-');}
self.getDifferenceInDatesFromToday=function(discountEndDate){var diffInDays="";if(discountEndDate){diffInDays=moment.utc(discountEndDate,'YYYYMMDD').diff(moment.utc(new Date()),'days');}
return diffInDays;}
self.formatQuickPickPathParams=function(value){return value.toLowerCase().replace(/\s+/,'-').replace(/\//,'-');}}]);app.filter('phoneFormatterFilter',[function(){return function(value){if(typeof value===undefined){}else{var phNum=value+"";phNum=phNum.substring(0,3)+"-"+phNum.substring(3);return phNum;}};}]);app.service('backToLinkService',['localStorageService',function(localStorageService){var self=this;self.backToLink="";self.backToLinkText="";self.setBackToLink=function(backTo){self.backToLink=localStorageService.set("back-to-link-service",backTo);};self.getBackToLink=function(){return localStorageService.get("back-to-link-service");};self.setBackToLinkText=function(backToText){self.backToLinkText=backToText;};self.getBackToLinkText=function(){return self.backToLinkText;}}]);app.service('saveLotNumbersService',[function(){var self=this;var lotNumbers=[];self.clearAll=function(){lotNumbers=[];};self.addLotNumber=function(lotNumber){var flag=0;if(!Array.prototype.indexOf)
{for(var i=0;i<lotNumbers.length;i++){if(lotNumbers[i]===lotNumber)
flag=1;}}
else
{if(lotNumbers.indexOf(lotNumber)!=-1)
flag=1;}
if(!flag){lotNumbers.push(lotNumber);}};self.getLotNumber=function(index){return lotNumbers[index];};self.getListLength=function(){return lotNumbers.length;}
self.getResultIndex=function(lotNumberToAdd){if(lotNumbers.length>0){return _.findIndex(lotNumbers,function(lotNumber){return lotNumber==lotNumberToAdd});}
return lotNumbers.length;};}]);app.service('dataTableConfig',[function(){var self=this;var config={dom:'<"top"iflp<"clear">>rt<"bottom"iflp<"clear">>',pagingType:"full_numbers"};var isMobile=window.matchMedia("screen and (max-width: 479px)").matches;if(isMobile){config.dom='<"top"fp<"clear">>rt<"bottom"lpif<"clear">>';config.pagingType="full";config.columnDef={"visible":false,"targets":0};}
self.getConfig=function(){return config;}}]);app.service('deviceService',[function(){var self=this;var isMobileSize=window.matchMedia("(max-width: 768px)").matches;var isTabletSize=window.matchMedia("(max-width: 1024px) and (min-width: 769px)").matches;var isMobileDevice=mobileCheck();self.isMobileSize=function(){return isMobileSize;}
self.isMobileDevice=function(){return isMobileDevice;}
self.isTabletSize=function(){return isTabletSize;}
self.isMobileSizeOrDevice=function(){return isMobileSize||isMobileDevice;}}]);$.fn.beforeprint=function(callback){return $(this).each(function(){if(!jQuery.isWindow(this))
return;if(this.onbeforeprint!==undefined)
$(this).on('beforeprint',callback);else if(this.matchMedia)
this.matchMedia('print').addListener(callback);});};$.fn.afterprint=function(callback){return $(this).each(function(){if(!jQuery.isWindow(this))
return;if(this.onafterprint!==undefined)
$(this).on('afterprint',callback);else if(this.matchMedia)
$(this).one('mouseover',callback);});};function getFullDayRange(utcDate){var ret="["+utcDate.startOf("day").format("[\"]YYYY-MM-DDTHH:mm:ss[Z][\"]")+" TO "+utcDate.endOf("day").format("[\"]YYYY-MM-DDTHH:mm:ss[Z][\"]")+"]";return ret;}
function getFutureRange(utcDate){var ret="["+utcDate.endOf("day").format("[\"]YYYY-MM-DDTHH:mm:ss[Z][\"]")+" TO *]";return ret;}
var mobileCheck=function(){var check=false;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){check=true;}
return check;};function validateVin(vin){if(vin.length!==17)return false;vin=vin.toUpperCase();var re=new RegExp("^[A-Z\\d]{11}\\d{6}$");return vin.match(re);}
app.service('saleListOnMessageService',[function(){var self=this;var msgFunction=function(evt){};self.setMsgFunction=function(func){msgFunction=func;}
self.onMessage=function(evt){if(msgFunction){msgFunction(evt);}};}]);var getEmailContent=function(copartUser,$location,siteCatalyst,attrs,searchCriteria){var siteCode=copartUser.getUserConfig().siteCode;var subject;subject=globalLocale.getMessageStr('app.email.subject',[]);var body;var url=$location.absUrl();if($location.search().searchCriteria){var i=url.indexOf("searchCriteria=");if(i>-1){url=url.substring(0,i-1);}
var symbol=url.indexOf("/?")>-1?"&":"?";url+=symbol+"searchCriteria="+searchCriteria;}
body=globalLocale.getMessageStr('app.email.body',[attrs.doctitle,url]);return"mailto:?subject="+encodeURIComponent(subject)+"&body="+encodeURIComponent(body);};app.service('addressValidationService',['constants',function(constants){var self=this;self.validateAddress=function(address){if(null!=address){return self.checkForSpecialCharacters(address.line1,true)&&self.checkForSpecialCharacters(address.line2,true)&&self.checkForSpecialCharacters(address.city,false)&&self.checkForSpecialCharacters(address.state,false)&&self.checkForSpecialCharacters(address.country,false)&&self.checkForSpecialCharacters(address.postCode,true);}
return false;};self.checkForSpecialCharacters=function(checkString,allowNumbers){if(!_.isUndefined(checkString)){var alphabetPatternRegex=new RegExp(constants.ALPHABET_ALLOWED_CHARACTERS_PATTERN);var alphaNumericPatternRegex=new RegExp(constants.ALPHA_NUMERIC_ALLOWED_CHARACTERS_PATTERN);return allowNumbers?alphaNumericPatternRegex.test(checkString):alphabetPatternRegex.test(checkString);}
return true;};}]);
'use strict';app.filter('nospace',[function(){return function(value){return(!value)?'':value.replace(/ /g,'');};}]);app.filter('alphanumeric',[function(){return function(value){return(!value)?'':value.replace(/\W/g,'');};}]);app.filter('trim',[function(){return function(value){if(_.isUndefined(value))
return'';if(!angular.isString(value)){return value;}
return value.replace(/^\s+|\s+$/g,'');};}]);app.filter('addDaysToDate',[function(){return function(inputDate,noOfDays,dateFormat){return moment(inputDate).add(noOfDays,'days').format(dateFormat);}}]);app.filter('to_trusted',['$sce',function($sce){return function(text){return $sce.trustAsHtml(text);};}]);app.filter('sanitize_html',['$sanitize',function($sanitize){return function(text){var sanitized=$sanitize(text);return _.escape(sanitized);};}]);app.filter('currency_format',[function(){return function(value,scope){var myFormat=app.getControllerScope(scope).ds.getAppConfigValue('culture.amountFormat');if(myFormat)
{var rawOpts=myFormat.split("#");var opts={aSep:rawOpts[0],aDec:rawOpts[1],dGroup:parseInt(rawOpts[2])};return formatCurrencySlim(Math.floor(value)+'',opts);}
else
{return value;}
return value;};}]);app.filter('redact',[function(){return function(value,maxLength){try
{if(value.length>maxLength){value=value.substring(0,maxLength)+value.substring(maxLength,value.length).replace(/./g,'*');}}
catch(e)
{}
return value;};}]);app.filter('ellipses',[function(){return function(value,maxLength){try
{if(value.length>maxLength){value=value.substring(0,maxLength)+"...";}}
catch(e)
{}
return value;};}]);app.filter('yes_no_expansion',[function(){return function(value,locale){if(locale){if(value==='Y'||value==='y'){return locale.messages["app.label.yes"];}
else if(value==='N'||value==='n'){return locale.messages["app.label.no"];}}
else{if(value==='Y'||value==='y'){return"Yes";}
else if(value==='N'||value==='n'){return"No";}}
return value;};}]);app.filter('yesNoForBoolean',[function(){return function(value,locale){if(locale){if(value===true){return locale.messages["app.label.yes"];}
else if(value===false){return locale.messages["app.label.no"];}}else{if(value===true){return"Yes";}
else if(value===false){return"No";}}
return value;};}]);app.filter('date_format',[function(){return function(value,scope){var myFormat=app.getControllerScope(scope).ds.getAppConfigValue('culture.dateFormat');if(myFormat){var d=new Date(value);if(d.getTimezoneOffset()>0){d.setDate(d.getDate()+1);}
return d.format(myFormat);}
else{return value;}
return value;};}]);app.filter('to_titleCase',[function(){return function(value){return value?value.toTitleCase():value;};}]);app.filter('to_lowerCase',[function(){return function(value){return value?value.toLowerCase():value;};}]);app.filter('translateRefData',[function(){return function(value,scope){return app.getControllerScope(scope).ds.getRefDataTranslation(value);};}]);app.filter('arrayContains',[function(){return function(array,value){if(!_.isUndefined(array)&&!_.isNull(array)){return array.indexOf(value)>-1;}
else{return false;}};}]);app.filter('facetFormat',['dateFilter','userService','globalize_format_datetimeFilter','capitalizeFilter',function(dateFilter,userService,globalize_format_datetimeFilter,capitalizeFilter){return function(input,optional1){var momentDateFormat=userService.userConfig.displayPref.dateFormat.toUpperCase();var output=input;if(optional1=="LOC"||optional1=="SLOC"||optional1=="ENGN")
{output=input.toUpperCase();}else if(optional1=='MAKE'){output=capitalizeFilter(input,true);}
return output;}}]);app.filter('capitalize',[function(){return function(input,all){var reg=(all)?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return(!!input)?input.replace(reg,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();}):'';}}]);app.filter('toInteger',[function(){return function(value){if(value||value===0)
return parseInt(value);return null;}}]);app.filter('formatDateWithTimeZone',["userService",function(userService){return function(value){if(value)
{var date=moment(value).toISOString;date=moment.utc(date).tz(userService.userConfig.selectedTimezone).format(date);date=moment.utc(date).tz(userService.userConfig.selectedTimezone).format("MM/DD/YYYY hh:mm A zz");return date;}
else
return null;}}]);app.filter('formatUTCDateWithTimeZone',["userService",function(userService){return function(value){if(value)
{var dateTimeFormat=userService.userConfig.displayPref.dateFormat.toUpperCase()+" "+userService.userConfig.displayPref.timeFormat+" zz";var date=moment.utc(value).tz(userService.userConfig.selectedTimezone).format(dateTimeFormat);return date;}
else
return null;}}]);app.filter('globalize_number',[function(){return function(value){if(value||value===0)
return app.globalizeNumberFormatter(value);return'';};}]);var parseAmount=function(value,decimalLimit){if((value||value===0)){if(decimalLimit==0){value=parseInt(value);}else{value=parseFloat(value);}
return value;}
return null;}
app.filter('globalize_currency',[function(){return function(value,code,decimalLimit){if(decimalLimit===undefined||decimalLimit==null){decimalLimit=0;}
var amount=parseAmount(value,decimalLimit);if(amount!=null&&amount!=undefined){if(code){code=code.trim();return Globalize.currencyFormatter(code,{maximumFractionDigits:decimalLimit})(amount);}
else{return amount;}}
return"";};}]);app.filter('globalize_currency_using_code',["userService",function(userService){return function(value,code,decimalLimit){if(decimalLimit===undefined||decimalLimit==null){decimalLimit=2;}
var amount=parseAmount(value,decimalLimit);if(!_.isNaN(amount)&&amount!=null){if(code){code=code.trim();var formattedCurrency=Globalize.currencyFormatter(code,{maximumFractionDigits:decimalLimit})(amount);return appInit.appPlatform==='gbl'?formattedCurrency:formattedCurrency+" "+code;}
else{return amount;}}
return value?value:"";};}]);app.filter("currency_semantic_code",["$sce",'deviceService',function($sce,deviceService){return function(value,code,decimalLimit,returnSemanticMarkup){var isMobile=deviceService.isMobileSizeOrDevice();if(decimalLimit===undefined||decimalLimit==null||((value%1==0)&&(isMobile))){decimalLimit=0;}
var amount=parseAmount(value,decimalLimit);if(!_.isNaN(amount)&&amount!=null){if(code){code=code.trim();var formattedCurrency=Globalize.currencyFormatter(code,{maximumFractionDigits:decimalLimit})(amount);return($sce.trustAsHtml("<span class='currencyAmount'>"+formattedCurrency+"</span>")+" "+(returnSemanticMarkup?$sce.trustAsHtml("<span class='currencyCode'>"+code+"</span>"):code));}
else{return amount;}}
return value?value:"";};}]);app.filter('odometer_reading_display',["userService",function(userService){return function(odometerReading,odometerBranding,odometerUnit){var showBrandingFlag=userService.userConfig.defaultDisplayPref.odometerBrandDisplayPreference;var formattedValue;if(odometerReading||odometerReading==0){formattedValue=app.globalizeNumberFormatter(odometerReading);}
if(showBrandingFlag!=null&&showBrandingFlag==false&&odometerReading==0){return"";}else if(showBrandingFlag!=null&&showBrandingFlag==false&&odometerReading>0){odometerUnit=odometerUnit!==undefined?odometerUnit:"";return formattedValue+" "+odometerUnit;}else{return formattedValue+" "+odometerBranding;}}}]);app.filter('globalize_currency_prepend_code',["userService",function(userService){return function(value,code){if(value&&code)
return code+" "+Globalize.currencyFormatter(code,{maximumFractionDigits:0})(value);return null;};}]);app.filter('globalize_currency_symbol',[function(){return function(code){try{return code?Globalize.getCurencySymbol(code):null;}catch(e){log.error("Exception while loading currency symbol from globalize",e)}};}]);app.filter('globalize_currency_exclude_symbol',[function(){return function(value,code){try{value=parseInt(value);if(!_.isNaN(value)&&code)
return app.globalizeNumberFormatter(parseInt(value))+" "+code.trim();return value?value:"";}catch(e){log.error("Exception while loading globalize library",e)}};}]);app.filter('globalize_format_date',["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({date:format})(utcDate.toDate());}
return null;};}]);app.filter('globalize_format_time',["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({time:format})(utcDate.toDate());}
return null;};}]);app.filter('globalize_format_datetime',["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({datetime:format})(utcDate.toDate());}
return null;};}]);app.filter('globalize_format_date_custom',["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({skeleton:format})(utcDate.toDate());}
return null;};}]);app.filter('globalize_parse_date',[function(){return function(value,format){if(value){if(format)
return Globalize.dateParser({skeleton:format})(value);else
return Globalize.dateParser()(value);}
return null;};}]);app.filter('globalize_length_unit_format',[function(){return function(value,country){if(value||value==0){if(country&&country!=""){return Globalize.unitFormatter("length-"+country.toLowerCase(),{form:"short"})(value);}else{return Globalize.unitFormatter("length-mile",{form:"short"})(value);}}
return null;};}]);app.filter('format_intl_phone_number',['userService',function(userService){var regionToPhoneMap={"US":"US","UK":"GB","DE":"DE","ES":"ES","IN":"IN","CPRTCA":"CA","CPRTMEA":"AE"};return function(value,country,format){country=regionToPhoneMap[userService.userConfig.siteCode.toUpperCase()]||regionToPhoneMap[userService.userConfig.siteRegionCode.toUpperCase()];if(value&&country){$.fn["intlTelInput"].loadUtils("/js/lib/intlTelInput/utils.js");return intlTelInputUtils.formatNumber(value,country,format);}
return value;};}]);app.filter('format_date',['userService',function(userService){return function(dateString,format){format=format||userService.userConfig.displayPref.dateFormat.toUpperCase();if(dateString&&format){if(dateString<=0){return"";}
var date=moment(dateString,"YYYYMMDD");return date.format(format);}
return null;};}]);app.filter('format_telephone',[function(){return function(value){if(value)
{value=value.toString();if(value.length==10)
{return"("+value.substr(0,3)+") "+value.substr(3,3)+" "+value.substring(6);}
else
return value;}
else
return null;}}]);app.filter('unique',[function(){return function(arr,field){return _.uniq(arr,function(a){return a[field];});};}]);app.filter('convertTimeTo12Hour',['userService',function(userService){return function(value){var timeFormat=userService.userConfig.timeFormat;if(value){var split=value.split(" ");var open=split[0];var to=split[1];var close=split[2];open=moment(open,["HH:mm"]).format(timeFormat);close=moment(close,["HH:mm"]).format(timeFormat);return open+" "+to+" "+close+" ";}
else{return null;}}}]);app.filter('convert24hrsTo12hrs',[function(){return function(hrs){if(hrs){hrs=paddy(hrs,4);hrs=moment(hrs,["HHmm"]).format("hh:mm A");return hrs;}
else{return null;}}}]);app.filter('titleGroupFilter',[function(){return function(value){if(value){value=value.split("_");return value[1];}
else{return null;}}}]);function paddy(n,p,c){var pad_char=typeof c!=='undefined'?c:'0';var pad=new Array(1+p).join(pad_char);return(pad+n).slice(-pad.length);}
var refCodeLookupMap={EBD:'EVERY BUSINESS DAY ',MSD:'MULTIPLE SALE DAYS PER WEEK',FRI:'Friday',MON:'Monday',SAT:'Saturday',SUN:'Sunday',THR:'Thursday',TUE:'Tuesday',WED:'Wednesday',BFR:'BIWEEKLY FRIDAY',BMO:'BIWEEKLY MONDAY',BSN:'BIWEEKLY SUNDAY',BST:'BIWEEKLY SATURDAY',BTH:'BIWEEKLY THURSDAY',BTU:'BIWEEKLY TUESDAY',BWD:'BIWEEKLY WEDNESDAY',MNT:'MONTHLY'};app.filter('refCodeToText',[function(){return function(code){return refCodeLookupMap[code]?refCodeLookupMap[code]:code;}}]);app.filter('preferencesFilter',['copartUser',function(copartUser){return function(input,prefCode){var result=[];if(!Array.isArray(input)){return result;}
angular.forEach(input,function(value){if(copartUser.hasAccessSitePref(prefCode,value)){result.push(value);}});return result;}}]);app.filter('phoneNum_format',[function(){return new NumberFormatterUtils().formatPhoneNumber;}]);app.filter('format_datetime_by_pref',["userService",function(userService){return function(UTCEpochTime){if(UTCEpochTime){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);var dateTimeFormat=userService.userConfig.dateFormat+" "+userService.userConfig.timeFormat;return utcDate.format(dateTimeFormat);}
return null;};}]);app.filter('redactFilter',["userService",function(userService){return function(input,prefType,replaceWith){if(input===undefined||input==null){return"";}
if(userService.userConfig.defaultDisplayPref[prefType]==null){return input.trim();}
var limit=userService.userConfig.defaultDisplayPref[prefType];var formattedValue=input.trim();if(limit!=null&&input.toString().length>limit){if(replaceWith){formattedValue=formattedValue.substring(0,limit)+formattedValue.substring(limit,formattedValue.length).replace(/./g,replaceWith);}
else{formattedValue=formattedValue.substring(0,limit);}}
return formattedValue;}}]);app.filter('searchTextDisplayFilter',[function(){return function(searchText){var displayText=searchText||"";if(searchText.trim().toUpperCase()==="FARMERS"){displayText="Farmers";}
return displayText;}}]);app.filter('saleNameFilter',[function(){return function(name,isVirtual){if(isVirtual&&isVirtual=="Y"&&!name.startsWith("*")){name="*"+name;}
return name;}}]);app.filter('formatVin',[function(){return function(vinText,k){if(_.isUndefined(vinText))
return'';return(vinText.trim().length<k)?vinText.trim():(vinText.trim().substring(0,k)+(new Array((vinText.trim().length-k)+1).join('*')));}}]);app.filter('sanitizeUrl',[function(){return function(urlName){if(urlName){urlName=urlName.replace(/\/$/,'');}
return urlName;}}]);app.filter('isValidDate',[function(){return function(inputDate){if(!inputDate){return false;}
var date=new Date(inputDate);return angular.isDate(date);};}]);app.filter('countryDesc',["appConfigService",function(appConfigService){return function(countryCode){if(!countryCode){return'';}
var countries=appConfigService.getAppConfig().countries||{};var countryObj=_.find(countries,{code:countryCode})||{};return countryObj.description||'';};}]);app.filter('convertMiscellaneousText',[function(){return function(value,locale){if(value==='Miscellaneous Invoices'){value=locale.messages['payments.misc.invoice'];}
return value;}}]);app.filter('escape',[function(){return function(input){if(input){return input.replace(/[\/. ]/g,'-');;}
return"";}}]);app.filter('trustedResource',['$sce',function($sce){return function(url){return $sce.trustAsResourceUrl(url);};}]);
'use strict';function QuickPicks(params,pageId){var constants={VEHICLE_MAKES:'MAKE',FEATURED_ITEMS:'FETI',VEHICLE_TYPES:'VEHT',CATEGORY:'ABI'};var self=this;var columnize=function(arr,size){var newArr=[];for(var i=0;arr&&i<arr.length;i+=size){newArr.push(arr.slice(i,i+size));}
return newArr;};self.updateList=function(params){self.makes=columnize(params[constants.VEHICLE_MAKES],7);self.vehicleTypes=columnize(params[constants.VEHICLE_TYPES],5);self.categories=columnize(params[constants.FEATURED_ITEMS],7);self.category=params[constants.CATEGORY];};self.updateVehicleFinderList=function(params){for(var title in params){params[title]=columnize(params[title],4);}
self.paramMap=params;};if(params==null){self.paramMap={};}
else{self.quickPicksByUri={};self.displayNameByUri={};self.categoryNameByUri={};self.includeTagByField={};for(var title in params){for(var item in params[title]){self.quickPicksByUri[params[title][item].uri]=params[title][item].searchQuery;self.displayNameByUri[params[title][item].uri]=params[title][item].itemName;self.categoryNameByUri[params[title][item].uri]=title;self.includeTagByField[params[title][item].uri]=params[title][item].includeTagByField;}}
if(pageId==='HOME'){self.updateList(params);}
else{self.updateVehicleFinderList(params);}}};
'use strict';app.service('appConfigService',['$q','startupRestService','$filter','$http','copartUser',function($q,startupRestService,$filter,$http,copartUser){var self=this;self.appConfig=new AppConfig(startupRestService,$filter,copartUser);self.isLoaded=null;if(typeof referenceDataLess!="undefined"){self.appConfig.update(referenceDataLess);}
if(self.isLoaded!=null&&typeof self.isLoaded!==undefined&&typeof self.isLoaded!=='boolean'){self.isLoaded.resolve(true);}
else
{self.isLoaded=true;}
self.getAppConfig=function(){return self.appConfig;};self.setEnvConfigProps=function(envConfigProps){self.envConfigProps=envConfigProps;self.appConfig.evnConfigProperties=envConfigProps;};self.getEnvConfigProps=function()
{return self.envConfigProps;};self.getLocationsListBySite=function(callBack){if(self.appConfig.yardLocations==null){$http.get('/public/data/locations/retrieveLocationsListBySite').success(function(response){self.appConfig.yardLocations=response;if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});}
else if(callBack)
{callBack(self.appConfig.yardLocations);}};var filterList=function(list,filterObj){return _.where(list,filterObj);};var distinctList=function(list,property){return _.uniq(_.filter(list,function(value){return value[property]!="";}),function(x){return x[property];});};var getVehTypeFilterObj=function(vehicleType,filterByVehType)
{var vehTypeObj={};if(filterByVehType){vehTypeObj={type:vehicleType.code};if(vehicleType.category){vehTypeObj.category=vehicleType.category;}}
return vehTypeObj;};self.getVehicleMakes=function(vehicleType,filterByVehType){if(!vehicleType){return;}
var filteredList=filterList(self.appConfig.vehicleMakes,getVehTypeFilterObj(vehicleType,filterByVehType));return distinctList(filteredList,'code');};self.getVehicleModels=function(vehicleType,vehicleMake,filterByVehType){if(!vehicleMake||!vehicleType){return;}
var filterObj=getVehTypeFilterObj(vehicleType,filterByVehType);filterObj.group=vehicleMake.code;var filteredList=filterList(self.appConfig.vehicleMakeandModels,filterObj);return distinctList(filteredList,'description');};self.findAndRemoveDocumentCategory=function(documentCategoryCodeToRemove,documentCategories){var removedCategoryObj;if(documentCategories&&Array.isArray(documentCategories)){var categoryToRemoveIndex=_.findIndex(documentCategories,function(category){return category.documentCategoryCode==documentCategoryCodeToRemove;});if(categoryToRemoveIndex>-1){var removedObj=documentCategories.splice(categoryToRemoveIndex,1);if(removedObj&&removedObj[0]){removedCategoryObj=removedObj[0];}}}
return removedCategoryObj;}
self.moveDocumentCategory=function(documentCategoryCode,documentCategories,position){if(!!position&&!!documentCategories&&Array.isArray(documentCategories)&&documentCategories.length>2){var removedCategoryObj=self.findAndRemoveDocumentCategory(documentCategoryCode,documentCategories);if(!!removedCategoryObj){if(position==='start'){documentCategories.unshift(removedCategoryObj);}
if(position==='end'){documentCategories.push(removedCategoryObj);}}}}
self.moveDocumentCategoryToLast=function(documentCategoryCode,documentCategories){self.moveDocumentCategory(documentCategoryCode,documentCategories,"end");}
self.moveDocumentCategoryToFirst=function(documentCategoryCode,documentCategories){self.moveDocumentCategory(documentCategoryCode,documentCategories,"start");}
self.customCategoryOrder=["ID","MISC"];self.categoriesToRemove=["UNKWN"];self.distinctDocCategories=function(){var uniqueCategories=_.uniq(self.appConfig.getDocumentCategories(),'documentCategoryCode');for(var i=0;i<self.categoriesToRemove.length;i++){self.findAndRemoveDocumentCategory(self.categoriesToRemove[i],uniqueCategories);}
for(var i=self.customCategoryOrder.length-2;i>=0;i--){self.moveDocumentCategoryToFirst(self.customCategoryOrder[i],uniqueCategories);}
if(self.customCategoryOrder.length>0){self.moveDocumentCategoryToLast(self.customCategoryOrder[self.customCategoryOrder.length-1],uniqueCategories);}
return uniqueCategories;};self.getValidHighLightIcons=function(iconCodes){var iconCodesObjArray=[];var showHighlightIconsArray=_.where(self.appConfig.getHighlightIcons(),{iconType:'H'});_.each(iconCodes,function(iconCodeObj){_.find(showHighlightIconsArray,function(obj){if(obj.iconCode==iconCodeObj){iconCodesObjArray.push(obj);return true;}});});return iconCodesObjArray;};}]);function AppConfig(startupRestService,$filter,copartUser){ModelBase(this);var self=this;self.defaultMemberChoices={};var loadDynamicReferenceData=function(methodName,fieldName,filter,callback)
{if(!callback)
{return;}
if(self[fieldName]&&self[fieldName][filter])
{callback(self[fieldName][filter]);}
else
{startupRestService[methodName](filter,function(response)
{if(response.returnCode==1)
{if(!(self[fieldName]))
{self[fieldName]={};}
self[fieldName][filter]=response.data[fieldName];callback(response.data[fieldName]);}});}};self.vehicleModels=function(make,callback)
{loadDynamicReferenceData("getVehicleModels","vehicleMakeandModels",make,callback);};self.getVehicleMakes=function(vehicleType,callback)
{loadDynamicReferenceData("getVehicleMakes","vehicleMakes",vehicleType,callback);};self.getStatesOfCountry=function(country,callback)
{loadDynamicReferenceData("getStates","statesOfCountry",country,callback);};self.update=function(params){if(params==null){return;}
if((params.vehicleTypes)){self.vehicleTypes=params.vehicleTypes;}
if((params.percentageMaximums)){self.percentageMaximums=params.percentageMaximums;}
if((params.vehicleMakeandModels)){self.vehicleMakeandModels=params.vehicleMakeandModels;}
if((params.searchYears)){self.searchYears=params.searchYears;}
if((params.vehicleMakes)){self.vehicleMakes=params.vehicleMakes;}
if((params.countries)){self.countries=params.countries;}
if((params.states)){self.states=params.states;}
if((params.colors)){self.colors=params.colors;}
self.categories=params.vehicleCategories;if((params.zipMiles)){self.zipMiles=params.zipMiles.sort(function(zipMile1,zipMile2){return zipMile1.description-zipMile2.description;});}
if((params.languages)){self.languages=params.languages;}
if((params.defaultLotResultsFields)){self.defaultLotResultsFields=params.defaultLotResultsFields;}
if(params.securityQuestions){self.securityQuestions=_.chain(params.securityQuestions).map(function(value1,key1){return{questionId:value1.code,questionDesc:value1.description}}).value();}
if((params.countryStates)){self.countryStates=params.countryStates;}
if((params.shippingServices)){self.shippingServices=params.shippingServices;}
if((params.bidIncrements)){self.bidIncrements=params.bidIncrements;}
if((params.highlightIcons)){self.highlightIcons=params.highlightIcons;}
if((params.validHighlightIcons)){self.validHighlightIcons=params.validHighlightIcons;}
if((params.ccMaxLimit)){self.ccMaxLimit=params.ccMaxLimit;}
if((params.titleLongDescription)){self.titleLongDescription=params.titleLongDescription;}
if((params.yardLocations)){self.yardLocations=params.yardLocations;self.yardsMap=_.indexBy(params.yardLocations,'yardNumber');}
if((params.yards)){self.yards=params.yards;}
if(params.defaultMemberChoices){self.defaultMemberChoices=params.defaultMemberChoices;}
if((params.damageTypes)){self.damageTypes=params.damageTypes;}};self.getDefaultMemberChoices=function(){return self.defaultMemberChoices;}
self.refData={HIGHLIGHTICONS:'highlightIcons',COUNTRIES:'countries',YARDS:'yards',TITLELONGDESCRIPTION:'titleLongDescription',CCMAXKIMIT:'ccMaxLimit',BIDINCREMENTSBYSITE:'bidIncrementsBySite',SHIPPINGSERVICES:'shippingServices',COUNTRYSTATES:'countryStates',SECURITYQUESTATIONS:'securityQuestions',LANGUAGES:'languages',COLORS:'colors',REGISTRATIONSOURCE:'registrationSource',DOCUMENTCATEGORIES:'documentCategories',PRODUCTSITES:'productSites',PAYMENTMETHODS:'paymentMethods',SUBSCRIPTIONPREFERENCES:'availableSubscriptionPreferences',ESIGNDOCUMENTS:'eSignDocuments',REFUNDREASONS:'refundReasons'};self.getHighlightIcons=function(){return self.loadReferenceDataByObject(self.refData.HIGHLIGHTICONS);}
self.getYards=function(){return self.loadReferenceDataByObject(self.refData.YARDS);}
self.getTitleLongDescription=function(){return self.loadReferenceDataByObject(self.refData.TITLELONGDESCRIPTION);}
self.getCcMaxLimit=function(){return self.loadReferenceDataByObject(self.refData.CCMAXKIMIT);}
self.getBidIncrementsBySite=function(){return self.loadReferenceDataByObject(self.refData.BIDINCREMENTSBYSITE);}
self.getShippingServices=function(){return self.loadReferenceDataByObject(self.refData.SHIPPINGSERVICES);}
self.getCountryStates=function(){return self.loadReferenceDataByObject(self.refData.COUNTRYSTATES);}
self.getSecurityQuestions=function(){return self.loadReferenceDataByObject(self.refData.SECURITYQUESTATIONS);}
self.getLanguages=function(){return self.loadReferenceDataByObject(self.refData.LANGUAGES);}
self.getColors=function(){return self.loadReferenceDataByObject(self.refData.COLORS);}
self.getRegistrationSource=function(){return self.loadReferenceDataByObject(self.refData.REGISTRATIONSOURCE);}
self.getDocumentCategories=function(){return self.loadReferenceDataByObject(self.refData.DOCUMENTCATEGORIES);}
self.getProductSites=function(){return self.loadReferenceDataByObject(self.refData.PRODUCTSITES);};self.getPaymentMethods=function(){return self.loadReferenceDataByObject(self.refData.PAYMENTMETHODS);};self.getSubscriptionPreferences=function(){return self.loadReferenceDataByObject(self.refData.SUBSCRIPTIONPREFERENCES);};self.getCopartForms=function(){return self.loadReferenceDataByObject(self.refData.ESIGNDOCUMENTS);};self.getRefundReasons=function(){return self.loadReferenceDataByObject(self.refData.REFUNDREASONS);};self.loadReferenceDataByObject=function(object){if(self[object])
return self[object];var result;$.ajax({type:"GET",url:"/public/data/referenceDataByObject/"+object,success:function(response){result=response;},error:function(){},async:false});if(object==self.refData.SECURITYQUESTATIONS){result=_.chain(result).map(function(value1,key1){return{questionId:value1.code,questionDesc:value1.description}}).value();}
self[object]=result;return result;};self.immutableCountriesList=[];self.prepareCountriesList=function(){var userConfig=copartUser.getUserConfig();var preferredCountryCodes=["us","ca"];if(userConfig.countryFlagsPreference&&userConfig.countryFlagsPreference.prefCountries){preferredCountryCodes=userConfig.countryFlagsPreference.prefCountries}
preferredCountryCodes=_.map(preferredCountryCodes,function(prefCountryCode){return prefCountryCode.toUpperCase();});var countriesRefData=self.loadReferenceDataByObject(self.refData.COUNTRIES);var preferredCountryObjs=[];var excludedCountryObjs=[];_.each(countriesRefData,function(countryRefObj){var priorityCountryIndex=preferredCountryCodes.indexOf(countryRefObj.twoCharCountryCode);if(priorityCountryIndex>-1){var tempCountryRefObj=_.clone(countryRefObj);tempCountryRefObj.priorityIndex=priorityCountryIndex;preferredCountryObjs.push(tempCountryRefObj);}
excludedCountryObjs.push(countryRefObj);});excludedCountryObjs=_.sortBy(excludedCountryObjs,'description');preferredCountryObjs=_.sortBy(preferredCountryObjs,'priorityIndex');var finalList=[];finalList=finalList.concat(preferredCountryObjs);finalList.push({code:"ignore",description:'---------'});finalList=finalList.concat(excludedCountryObjs);return finalList;};self.getCountries=function(){if(self.immutableCountriesList&&self.immutableCountriesList.length===0){self.immutableCountriesList=self.prepareCountriesList();}
return self.immutableCountriesList;}};
'use strict';function EnvConfigProps(params){ModelBase(this);if(params==null){params={};}
return params;};

var submitForm=function(action,form){var hash=decodeURIComponent(self.document.location.hash);if(hash&&hash.indexOf("#")===-1){hash="#"+hash;}
form.action=action+hash;return true;};function emailPassword(){jQuery("#statusMsg").hide();var email_address=jQuery("#email").val();if(!email_address||!validateEmail(email_address)){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidEmail).show();return;}
jQuery.ajax({url:'rest/public/data/seller/emailPassword/'+email_address+'/',data:{},type:'GET',cache:false,dataType:'json',success:function(json,status,xhr){if(json.returnCode==-1){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(json.returnCodeDesc).show();}else{jQuery("#statusMsg").addClass("alert-success").removeClass("alert-danger").html(message.passwordConfirmation+" "+email_address).show();}},error:function(xhtml,status,xhr){alert(' error: '+status+xhr+xhtml);}});}
function updatePassword(){jQuery("#statusMsg").hide();var email_address=jQuery("#email").val();if(!email_address||!validateEmail(email_address)){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidEmail).show();return;}
var password=jQuery("#password").val();var cnfrmPassword=jQuery("#confirmPassword").val();if(!password){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.passwordEmpty).show();jQuery("#password").focus();return;}
if(!cnfrmPassword){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.passwordEmpty).show();jQuery("#confirmPassword").focus();return;}
if(password.length<8||password.length>12){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidPasswordLength).show();jQuery("#password").focus();return;}
if(cnfrmPassword.length<8||cnfrmPassword.length>12){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidPasswordLength).show();jQuery("#confirmPassword").focus();return;}
jQuery.ajax({url:'rest/public/data/seller/accountInformation/createPassword',data:{'email':email_address,'password':password,'confirmPassword':cnfrmPassword},type:'POST',cache:false,dataType:'json',success:function(json,status,xhr){if(json.returnCode==-1){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(json.returnCodeDesc).show();}else{location.href="memberhome.html";}},error:function(xhtml,status,xhr){alert(' error: '+status+xhr+xhtml);}});}
function validateEmail(email){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(!emailReg.test(email)){return false;}else{return true;}};

function show()
{var account=document.getElementById('opt').value;console.log("from",account);if(account==0)
{document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";}
if(account==1)
{document.getElementById("sel_access").style.display="block";document.getElementById("show").style.display="none";}
if(account==2)
{document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";}}
function showAccountType(account)
{if(account==0)
{document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";document.getElementById("opt").value=account;}
if(account==1)
{document.getElementById("sel_access").style.display="block";document.getElementById("show").style.display="none";document.getElementById("opt").value=account;}
if(account==2)
{document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";document.getElementById("opt").value=account;}};

function AddressVO(params){ModelBase(this);var self=this;if(params==null){params={};}
self.line1=params.line1;self.line2=params.line2;self.city=params.city;self.state=params.state;self.country=params.country;self.postCode=params.postCode;};

app.constant('constants',{"MAX_CREDIT_CARD_YEARS_INTO_FUTURE":20,"CREDIT_CARD_MIN_LENGTH":12,"CREDIT_CARD_MAX_LENGTH":19,"CREDIT_CARD_CVN_LABEL":"CVV","CREDIT_CARD_CVN_MIN_LENGTH":3,"CREDIT_CARD_INVALID_ERR_MSG":"Please enter a valid card number","CREDIT_CARD_CVN_INVALID_ERR_MSG":"Please enter a valid {0}","CARD_TYPES":[{"displayName":"Credit card","code":"CRDCARD"},{"displayName":"Debit card","code":"DBTCARD"}],"SUBSCRIBED":"SUBSCRIBED","NOT_SUBSCRIBED":"NOT_SUBSCRIBED","UNSUBSCRIBED":"UNSUBSCRIBED","REGISTRATION_PREF_COL_STR":"registrationPreference.components","SUBSCRIPTIONS":"subscriptions","NO":"N","YES":"Y","THANK_YOU":"thankyou","DEFAULT_PAYMENT_METHOD":"CRDCARD","CARD_PAYMENT_METHOD_CODE":"CRDCARD","CREDIT_CARD_PAYMENT_METHOD_CODE":"CRDCARD","DEBIT_CARD_PAYMENT_METHOD_CODE":"DBTCARD","PAYPAL_PAY_METHOD_CODE":"PAYPAL","APPLE_PAY_METHOD_CODE":"APLPAY","GOOGLE_PAY_METHOD_CODE":"GPAY","WIRE_PAY_METHOD_CODE":"WIRE","EPAY_PAYMENT_METHOD_CODE":"EPAY","BANK_PAY_PAYMENT_METHOD_CODE":"BANK_PAY","APPLE_PAY_LABEL":"Copart Inc.","PAYMENT_METHOD_ORDER":['CRDCARD','PAYPAL','APLPAY','GPAY','WIRE','BANK_PAY'],"INDIVIDUAL":"individual","BUSINESS":"business","UNEXPECTED_ERROR":"Unexpected Error Occurred","BANNER":"BANNER","SHOW_PRIMARY_PHONE_ON_STEP1":"showPrimaryPhoneOnStep1","SHOW_PRIMARY_PHONE_ON_STEP3":"showPrimaryPhoneOnStep3","PASSWORD_MIN_LENGTH":5,"PASSWORD_MAX_LENGTH":25,"PATTERN":"^(?=.{5,10}$)(?=.*[0-9])(?=.*[A-Za-z]).*$","ALERT_TYPE_STATUS":{"pendingMemPayment":"MEMBERSHIP_PAYMENT","missingAccInfo":"VERIFY_ACCOUNT_INFO","noUploadDoc":"NEW_DOCUMENT_UPLOAD","noActiveDoc":"ID_DOCUMENT_PROCESS","docReadyForEsign":"ESIGNATURE_DOCUMENT_VERIFICATION","unknown":"UNKNOWN"},"DEFAULT_CURRENCY_CODE":"USD","REGISTRATION_USER_ACTIVITY":'MEMBER_REGISTRATION',"EXPIRING_MEMBERSHIP_ACTIVITY":'MBRSHP_EXP',"EXPIRING_MEMBERSHIP_ACTION_ITEM":'MEMBERSHIP_EXPIRATION',"USER_ACTIONS":{"MEMBERSHIP_PAYMENT":{"redirectUrl":"accountInformation/complete-registration#paymentAccordion","label":"pendingMemPayment","code":"pendingMemPayment"},"VERIFY_ACCOUNT_INFO":{"redirectUrl":"accountInformation/complete-registration#addressForm","label":"missingAccInfo","code":"missingAccInfo"},"NEW_DOCUMENT_UPLOAD":{"redirectUrl":"./accountInformation/accountSetting?showAcc=Y#licenses","label":"noUploadDoc","code":""},"ID_DOCUMENT_PROCESS":{"redirectUrl":"./accountInformation/accountSetting?showAcc=Y#licenses","code":""}},"DEFAULT_COUNTY_FOR_SITE":{"CPRTUS":"USA","CPRTUK":"GBR","CPRTMEA":"ARE","CPRTIE":"IRL","CPRTCA":"CAN","CPRTDE":"DEU","CPRTIN":"IND","CPRTES":"ESP","CRTSUS":"USA","DEFAULT":"USA"},"ALERT_FILTER_ACTION_STATUS":"REMIND_ME_LATER","CITY_PATTERNS":{"CAN":"^[a-zA-Z.'-\\s-]*$","DEFAULT":"^[a-zA-Z\\s-]*$"},"ALERTS_REMIND_LATER_STATUS":"REMIND_ME_LATER","ALERTS_INITIATED_STATUS":"INITIATED","ALERTS_COMPLETED_STATUS":"COMPLETED","DOMESTIC_COUNTRIES":["USA","CAN"],"NAME_PATTERNS":{"CPRTCA":"^[a-zA-Z,.\(\)\"\;\'\-\*\\&\\s]*$","DEFAULT":"^[a-zA-Z\\s]*$"},"ADDRESS_LINE_PATTERNS":{"CAN":"^[a-zA-Z0-9,.#\(\)\"\;\'\-\*\\&\\s]*$","DEFAULT":"^[a-zA-Z0-9\\s-]*$"},"ALPHA_NUMERIC_ALLOWED_CHARACTERS_PATTERN":"^[a-zA-Z0-9,.#()'/\\-*&\\s]*$","ALPHABET_ALLOWED_CHARACTERS_PATTERN":"^[a-zA-Z,.#()'/\\-*&\\s]*$","CITY_VALIDATION_PATTERN":"^[a-zA-Z,.'&\\s]*$","ZIP_CODE_PATTERNS":{"AMERICA_US":{"USA":"^\\d{5}(?:[-\\s]\\d{4})?$","CAN":"^(?:A|B|C|E|G|H|J|K|L|M|N|P|R|S|T|V|X|Y){1}[0-9]{1}(?:A|B|C|E|G|H|J|K|L|M|N|P|R|S|T|V|W|X|Y|Z){1}\\s?[0-9]{1}(?:A|B|C|E|G|H|J|K|L|M|N|P|R|S|T|V|W|X|Y|Z){1}[0-9]{1}$"},"EURO_UK":"^[A-Z0-9-\\s]+$","EURO_IR":"^[ACDEFHKNPRTVWXY]{1}[0-9]{1}[0-9W]{1}[\\ \\-]?[0-9ACDEFHKNPRTVWXY]{4}$","DEFAULT":"^[A-Z0-9\\s-]*$"},"MAX_ACCEPTED_FILE_SIZE":"10485760","DOCUMENT_UPLOAD_SUCCESS_MODAL":"documentUploadSuccessModal","DOCUMENT_UPLOAD_WARNING_MODAL":"documentUploadModal","DOCUMENT_UPLOAD_FAILED_MODAL":"documentUploadFailedInfoModal","PHYSICAL_ADDRESS_REF":"Physical","SPACE":" ","QUESTION_MARK":"?","FORWARD_SLASH":"/","POUND_SIGN":"#","MARKETING_SUBSCRIPTIONS":{"CPRTUK":"MKT_NEWS_UK","CPRTIE":"MKT_NEWS_IE"},"DASH":"-","MARKETING_SUBSCRIPTIONS_PREF":"marketingSubscriptions","ACCNT_ALERTS_BANNER_DFLT_SLIDE_INTVL":15000,"AGREEMENT_STATUS":{"READY_FOR_SIGNATURE":"OUT_FOR_SIGNATURE","CPRT_DOC_INITIATED":"ESIGN_DOC_INITIATED","PENDING":"PENDING","ACTIVE":"ACTIVE","APPROVED_PENDING_REVIEW":"APPROVED_PENDING_REVIEW"},"ESIGN_MAX_RETRIES":10,"ESIGN_MAX_TIMEOUT_FOR_RETRY":30000,"ESIGN_RETRY_INTERVAL":3000,"STATUS_SUCCESS":"SUCCESS","PHONE_NUM_MIN_LENGTH":7,"PHONE_NUM_MAX_LENGTH":15,"CARD_MASK":"**** **** ****","CARD_TYPE_LABELS":{"001":"Visa","002":"Mastercard","003":"American Express","004":"Discover","005":"Diners Club","007":"JCB","024":" Maestro UK Domestic","042":"Maestro International"},"TIMED_OUT":"timedOut","MEMBERSHIP_EXPIRES_IN_DAYS_DEFAULT":60,"ASK_WALLET_QUESTIONS":"ASK_WALLET_QUESTIONS","ID_VERIFICATION_STATUS":{"INITIATED":'INITIATED',"PENDING":'PENDING',"FAILED":'FAILED',"CLEARED":'CLEARED'},"EXIT_CONFIRMATION_PAGES":{"PAYMENT":"payment"},"DISCOUNT_TYPE_CODES":{"AMOUNT":{"code":"AMOUNT","description":"Amount discounted"},"RATE":{"code":"RATE","description":"Percentage discounted"}},"COMMA_DELIMTER":",","DYNAMIC_MODAL":{"HEADER":{"SUCCESS":"SUCCESS","ERROR":"ERROR","INFO":"INFO"}},"TOW_REPORT_MAX_LOT_LIMIT":10,"DOCS_ORDERING_RANK":{"EXPIRED":1,"EXPIRING":2,"INACTIVE":3,"ACTIVE":4},"LICENSE_CONTENT_TYPE":{"ALL":"all","ID":"id","POR":"por"}});app.constant('memberChoicesConstants',{"memberType":"WBDY","businessType":"BUTP","vehicleType":"VHTP","vehiclePurpose":"VPRP","pairWithBroker":"PBRK","copartPrimaryUseCode":"PUCF","emailLanguage":"ELNG","individual":"INDL","business":"BSNS","businessUse":"BSNUSE","personalUse":"PRSLUSE","memberChoicesFilterIds":{'VHTP':'vehicleTypes','VPRP':'vehiclePurpose','DTYP':'dealershipTypes','VSRC':'vehicleSources','BRND':'brands','ELNG':'emailLanguage'},"shippingPrefConst":{'SELF_PICKUP':'SLFPCKP','REPRESENTATIVE_PICKUP':'RPPCKP'}});app.constant('registrationConstants',{"START_STEP":'STEP1',"uk":{"STEP1":{"nextStep":"STEP2","description":"basicInfo"},"STEP2":{"nextStep":"STEP3","description":"payment"},"STEP3":{"description":"addrAndDocUpload"}},"us":{"STEP1":{"nextStep":"STEP2","description":"basicInfo"},"STEP2":{"nextStep":"STEP3","description":"payment"},"STEP3":{"description":"addrAndDocUpload"}},REGISTRATION_ORDER:["MEMBERSHIP_PAYMENT","VERIFY_ACCOUNT_INFO"],REGISTRATION_USER_ACTIVITY:'MEMBER_REGISTRATION',PROMO_COOKIE_EXPIRY_DAYS:1});app.constant('navigationUrlConstants',{"ACCOUNT_UPGRADE_MEMBERSHIP":"accountInformation/accountSetting?accSettingUpgradeMem=true","DOCUMENT_UPLOAD":'/accountInformation/accountSetting?showAcc=Y#licenses',"COMPLETE_REGISTRATION":"complete-registration"});app.constant('paymentConstants',{"DEFAULT_AMOUNT_FOR_NEW_CARD":"0"});app.constant('threeDS2Constants',{"PENDING_AUTH_STATUS":"PENDING_AUTHENTICATION","AUTH_SUCCESS_STATUS":"AUTHENTICATION_SUCCESSFUL","AUTH_FAILED_STATUS":"AUTHENTICATION_FAILED"});app.constant('ADOBE_CONSTANTS',{"ESIGN_URLS":["https://secure.echosign.com","https://secure.na1.echosign.com/","https://secure.na2.echosign.com","https://secure.eu1.echosign.com","https://secure.au1.echosign.com","https://secure.jp1.echosign.com"],"EVENTS":{"SIGN_DOC":"ESIGN","REJECT_DOC":"REJECT","VIEW_DOC":"PAGE_LOAD"}});app.constant('FORMS',{"NAMES":{"AFFIDAVIT":{"description":"Copart affidavit form","code":"affidavit","documentCode":"AFFIDAVIT"},"MULTI_STATE_TAX":{"description":"Copart multi state form","code":"multi-state-tax","documentCode":"MULTI_STATE_TAX"}},"MULTI_STATE":{"REG_TYPE_REF":{"WHOLESALER":{"id":"wholesaler","label":"WHOLESALER"},"RETAILER":{"id":"retailer","label":"RETAILER"},"SELLER":{"id":"seller","label":"SELLER"},"EXPORTER":{"id":"exporter","label":"EXPORTER (Property is to be transported out-of-state for resale & no other purpose)"}},"RESELL_TYPE_REF":{"VEHICLE":{"id":"vehicle","label":"VEHICLES/WATERCRAFT/POWER SPORTS EQUIPMENT"},"PARTS":{"id":"parts","label":"PARTS"},"OTHER":{"id":"other","label":"OTHER"}},"TAX_PERMIT_REF":{"SALES_TAX_PERMIT":{"id":"sales_tax_permit","label":"State Registration or Seller's Permit number of Purchaser"},"OTHER":{"id":"no_sales_tax_permit","label":"OTHER (Attach your completed Sales Tax Exempt form along with this completed form.)"}},"RESELLING_TYPE_OTHER_REF_DATA":{"BOATS":{"id":"boats","label":"Boats"},"SCRAP":{"id":"scrap","label":"Scrap"},"SALVAGE":{"id":"salvage","label":"Salvage"},"ATVS":{"id":"atvs","label":"ATVs"},"CAMPERS":{"id":"campers","label":"Campers"},"TRAILERS":{"id":"trailers","label":"Trailers"},"MOPEDS_SCOOTERS":{"id":"mopeds_scooters","label":"Mopeds/Scooters"},"MACHINERY":{"id":"machinery","label":"Machinery"}}},"AFFIDAVIT":{"TANGIBLE_PROP_REF":{"PROP_DESC":{"id":"description_of_property","label":"Motor Vehicles/Watercraft/Power Sports and/or Auto Parts"},"OTHER":{"id":"other","label":"OTHER"}},"TAX_PERMIT_REF":{"SALES_TAX_PERMIT":{"id":"sales_tax_permit","label":"I hold a state sales tax permit"},"OTHER":{"id":"no_sales_tax_permit","label":"I do not hold a state sales tax permit"}},"TANGIBLE_PROPERTY_OTHER":{"BOATS":{"id":"boats","label":"Boats"},"SCRAP":{"id":"scrap","label":"Scrap"},"SALVAGE":{"id":"salvage","label":"Salvage"},"ATVS":{"id":"atvs","label":"ATVs"},"CAMPERS":{"id":"campers","label":"Campers"},"TRAILERS":{"id":"trailers","label":"Trailers"},"MOPEDS_SCOOTERS":{"id":"mopeds_scooters","label":"Mopeds/Scooters"},"MACHINERY":{"id":"machinery","label":"Machinery"}}}});app.constant('LOG_CONSTANTS',{"SUCCESS_STATUS":"SUCCESS","ERROR_STATUS":"FAILURE","UNKNOWN_STATUS":"UNKNOWN"});app.constant('robotsTagConstants',{"NO_INDEX":"noindex","NO_FOLLOW":"nofollow","NO_ARCHIVE":"noarchive","NO_IMAGE_INDEX":"noimageindex"});app.constant('idVerificationConstants',{"EVS_ID_CHK":"EVS_ID_VERIFY_CHECK","AUTO_APRV_ID_DOC":"AUTO_APPROVE_ID_DOCUMENT"});app.constant('vehicleFinderConstants',{ALL_DAMAGE_TYPES:"All Damage Types",SEARCH:"Search",DAMAGE_TYPE_CATEGORIES:{ALL_DAMAGE_TYPES:{description:["All Damage Types"],category:"",priority:3},NORMAL_WEAR:{description:["NORMAL WEAR"],category:"Normal Wear",priority:2},LOW_DAMAGE:{description:["HAIL","MINOR DENT/SCRATCHES"],category:"Low Damage",priority:1},MEDIUM_HIGH_DAMAGE:{description:[],category:"Medium - High Damage",priority:0}}});

function LoggingVO(params){ModelBase(this);var self=this;if(params==null){params={};}
self.status=params.status;self.event=params.event;self.message=params.message;self.payload=params.payload;};
'use strict';app.service('startupRestService',['$http','$q','$location','$locale','config','$sce','copartUtils','userService',function($http,$q,$location,$locale,config,$sce,copartUtils,userService){var log=new Logger({name:'G2DataService'});var userConfig=userService.userConfig;var self=this;self.SUCCESS=1;self.ERROR=-1;self.quickPicks={};self.yardLocations=null;var locale=new LocaleService($locale,$sce,config);locale.refDataMessages=locale.getResource('RefDataTranslations');self.getLocale=function(){return locale;};self.updateUserConfig=function(data,callBack){var deferred=$q.defer();var req={method:'POST',url:'/public/data/userConfigUpdate',data:copartUtils.updatedConfig(data),noCancelOnRouteChange:true};$http(req).then(function(response){deferred.resolve(response.data);},function errorCallback(response){deferred.reject("failed to update user config");log.error("failed to update user config"
+response);});return deferred.promise;};self.updateAccountAlertsUserConfig=function(data,callBack){var deferred=$q.defer();var req={method:'POST',url:'public/data/userConfig/account-alerts',data:data,noCancelOnRouteChange:true};$http(req).then(function(response){deferred.resolve(response.data);console.log("Successully updated account alert",data,response);},function errorCallback(response){deferred.reject("failed to update user config");console.log("Failed to update account alert",data,response);});return deferred.promise;};self.getSuggestion=function(val){var data=$.param({q:val});var deferred=$q.defer();var req={method:'POST',url:'/public/data/lots/suggest',data:data,headers:{'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'}};$http(req).then(function(response){deferred.resolve(response.data)},function errorCallback(response){deferred.reject("failed_to_get_suggestions_dataservice");log.error("Error for getSuggestion returned in dataservice"
+response);});return deferred.promise;};self.getQuickPicks=function(pageId,callBack){if(self.quickPicks[pageId]){if(callBack){callBack(self.quickPicks[pageId])}else{return;}}
$http.get('/public/data/quickPicks/'
+pageId).then(function(response){self.quickPicks[pageId]=new QuickPicks(response.data.data.quickPicks,pageId);if(callBack)
callBack(self.quickPicks[pageId]);},function(response){if(callBack)
callBack({});log.error("Error returned"
+response);});};self.getQuickPickCounts=function(pageId,callback){$http.get('/public/data/quickPickCounts/'
+pageId).then(function(response){self.totalItemsOnSale=response.data.data.totalItemsOnSale;if(callback)
callback(response);},function(response){if(callback)
callback({});log.error("Error returned"
+response);});};self.getUserConfig=function(){$http.get('/public/data/userConfig').then(function(response){},function(response){if(callBack)
callBack({});log.error("Error returned"
+response);});};self.loadReferenceDataLess=function(callBack){jQuery.ajax({cache:false,url:'/public/data/referenceData/less',success:function(response){if(callBack){callBack((response));}},async:false});};self.loadReferenceData=function(callBack){$http({url:"/public/data/referenceData",method:"GET",noCancelOnRouteChange:true}).then(function(response){if(callBack){callBack((response));}});};self.getFilteredReferenceData=function(filters,callBack){$http({url:"/public/data/referenceData/graph",method:"GET",params:{services:filters}}).then(function(response){if(callBack){callBack((response));}});};self.getEnvConfigProps=function(callBack){$http({url:"/public/data/envconfig/properties",method:"GET",noCancelOnRouteChange:true}).then(function(response){if(callBack){callBack(response.data.data);}});};self.getLocationDetail=function(yardNumber,callBack){var data={'yardNumber':yardNumber};$http.get('/public/data/locations/retrieveLocationDetail',{params:data}).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"
+response);});};self.getNearestLocationDetail=function(data,callBack){var req={method:'POST',url:'/public/data/locations/nearest/zip',data:data};$http(req).then(function(response){if(callBack)
callBack(response);},function(response){log.error("Error returned"+response);});};self.getCldrData=function(language,locale,callBack){$http({method:'GET',url:'/public/data/cldrData/'
+language+'/'+locale,noCancelOnRouteChange:true}).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});};self.postFeedback=function(data,callBack){$http.post('/public/data/feedback',data).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("postFeedback Error returned"
+response);});};self.getVehicleModels=function(makeId,callback){$http.get('/public/data/VehicleModels/'+makeId).success(function(response){if(callback)
callback(response);}).error(function(response){log.error("Error returned"+response);});}
self.getVehicleMakes=function(vehTypeId,callback){$http.get('/public/data/VehicleMakes/'+vehTypeId).success(function(response){if(callback)
callback(response);}).error(function(response){log.error("Error returned"+response);});;}
self.getStates=function(countryId,callback){$http.get('/public/data/states/'+countryId).success(function(response){if(callback)
callback(response);}).error(function(response){log.error("Error returned"+response);});}
self.updateLanguagePreference=function(selectedLanguage,callBack){$http({url:"/data/updateLanguagePreference",method:"POST",data:selectedLanguage}).success(function(data,status,headers,config){var data=data;console.log(data);if(callBack){callBack(data);}}).error(function(data,status,headers,config){log.error("Error returned in sale Receipt"
+response);});}
self.emailPassword=function(userIDOrEmail,callBack){$http.post('/public/data/emailPassword',userIDOrEmail).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});};self.getSavedSecurityQuestions=function(email,callBack){$http({url:"/public/data/securityQuestions?email="+email,method:"GET"}).success(function(response){callBack.onSuccess(response);}).error(function(){callBack.onFailure(response);});};self.performLogin=function(url,form,successCallback,errorCallback){$http.post(url,form).success(function(response){if(_.isFunction(successCallback)){successCallback(response);}}).error(function(response){if(_.isFunction(errorCallback)){errorCallback(response);}});}
self.userLocationInfo=function(callBack,errorCallBack){var req={method:'GET',url:'/g2mext/api/v1/public/location-info'};$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error fetching userLocationInfo"+response);if(errorCallBack){errorCallBack(response);}});};self.g2mExtSecuredCall=function(request,callBack){var url="/public/g2m/extension/auth-headers";$http.get(url).success(function(response){request.data.buyerNumber=userConfig.buyerNumber;request.data.siteCode=userConfig.siteCode;request.headers={"Authorization":response.data};if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});}
self.updateLocationInfo=function(location,callBack){var req={method:'POST',url:'/g2mext/api/v1/public/update-location',data:location};self.g2mExtSecuredCall(req,function(g2mAuthResponse){$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error updating location"+response);});})};self.isKioskUser=function(callback){$http.get('/data/kioskuser').then(function(response){if(callback)
callback(response);});};self.verifySecurityQuestions=function(questions,callBack){$http({url:"/public/data/securityQuestions/verify",method:"POST",data:questions}).success(function(response){callBack.onSuccess(response);}).error(function(response){callBack.onFailure(response);})};self.getSiteKey=function(callBack){var req={method:'GET',url:'/public/data/reCaptcha/secretKey'};$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error getting site key"+response);});}
self.getEnvConfigPropsPromise=function(){var deferred=$q.defer();$http({url:"/public/data/envconfig/properties",method:"GET",noCancelOnRouteChange:true}).then(function(response){deferred.resolve(response.data.data);},function(error){deferred.reject("error getting envconfig properties");log.error("error getting envconfig properties",error);});return deferred.promise;};self.getAccountAlerts=function(callBack){var deferred=$q.defer();$http.get('/data/member/account/alerts').success(function(response){deferred.resolve(response);}).error(function(response){deferred.reject("failed to update user config");log.error("Error fetching account alerts"+response);});return deferred.promise;};self.updateAccountAlerts=function(data,callBack){var deferred=$q.defer();$http.post('/data/member/account/alerts',data).success(function(response){deferred.resolve(response);}).error(function(response){deferred.reject("failed to update user config");log.error("Error fetching account alerts"+response);});return deferred.promise;};self.updateDisplayAlertsModal=function(data,callBack){var deferred=$q.defer();$http.post('/public/data/userConfig/account-alerts-modal',data).success(function(response){deferred.resolve(response);}).error(function(response){deferred.reject("failed to update user config");log.error("Error fetching account alerts"+response);});return deferred.promise;};self.getUserActions=function(callBack){var deferred=$q.defer();$http.get('/data/member/user-actions').success(function(response){deferred.resolve(response);}).error(function(response){deferred.reject("failed to update user config");log.error("Error fetching account alerts"+response);});return deferred.promise;};self.getGlobalAlerts=function(callBack){var url="/public/data/global/alerts";$http.get(url).then(function(response){if(callBack)
callBack(response);},function(error){if(callBack)
callBack(error);});};self.logToServer=function(data,callBack){var request={method:"POST",url:"/public/data/log",data:data,headers:{'Content-Type':'application/json'}};$http(request).then(function(response){if(callBack)
callBack(response);},function(response){console.log("Error publishing client logs");});};self.getAuctionsCalendarList=function(callBack){var req={method:'GET',url:'/public/data/auctionsCalendarList',noCancelOnRouteChange:true,ignoreLoadingBar:true};$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});};self.getCreditCardDetailsForDepositRefund=function(){var deferred=$q.defer();$http.post('/data/getCreditCardDetailsForDepositRefund').then(function(response){deferred.resolve(response);},function(response){console.log("Error getCreditCardDetailsForDepositRefund");deferred.reject(response);});return deferred.promise;};self.getDepositRefundBalance=function(){var deferred=$q.defer();$http.post('/data/getDepositRefundBalance').then(function(response){deferred.resolve(response);},function(response){console.log("Error getDepositRefundBalance");deferred.reject(response);});return deferred.promise;};self.setPciParam=function(requestParam,callBack,url){if(requestParam.cookieValue==undefined){requestParam.cookieValue=$location.path();}
$http.post(((url)?url:'/data/payments/setPciParam/'),requestParam).success(function(response){if(response.data.systemUp===false){$location.path("scheduleMaintainance");return;}
if(callBack)
callBack(response);}).error(function(response){log.error("Error returned"+response);});};self.getAccountInformation=function(callBack,errorCallback){$http.get('/public/data/contactinfo').then(function(response){if(callBack){callBack(response.data);}},function(errors){if(errorCallback){errorCallback(errors);}
console.log("Error retrieving Contact info");});};self.getLotImages=function(lotNumber,callback,countryCode){var url="/public/data/lotdetails/solr/lotImages/"+lotNumber;if(countryCode){url=url+"/"+countryCode;}
$http.get(url).then(function(response){if(callback)
callback(response);});};self.getLotsByLotNumber=function(data,callBack){$http.post('/public/lots/number/search',data).then(function(response){if(callBack)
callBack(response);},function(response){log.error("Error returned"
+response);});};self.getLotsByVIN=function(data,callBack){$http.post('/public/lots/vin/search',data).then(function(response){if(callBack)
callBack(response);},function(response){log.error("Error returned"
+response);});};self.getLotDetails=function(lotNumber,callback){$http.get('/public/data/lotdetails/solr/'
+lotNumber).then(function(response){if(callback)
callback(response);});};self.popularSearches=function(popularSearchCriteria,callBack){popularSearchCriteria=popularSearchCriteria||{};var popularRecommendationSearchCriteria={};popularRecommendationSearchCriteria.searchType=popularSearchCriteria.searchType;popularRecommendationSearchCriteria.buyerNumber=popularSearchCriteria.buyerNumber;popularRecommendationSearchCriteria.country=popularSearchCriteria.country;popularRecommendationSearchCriteria.state=popularSearchCriteria.state?popularSearchCriteria.state:'';if(popularSearchCriteria.coordinates!="undefined, undefined"){popularRecommendationSearchCriteria.coordinates=popularSearchCriteria.coordinates;}
var url='/g2mext/api/v1/public/popularSearches';var req={method:'POST',url:url,headers:{'siteCode':userConfig.siteCode,'languageCode':userConfig.selectedLang},data:popularRecommendationSearchCriteria};$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error fetching lotRecommendationSearch"+response);});};self.lotRecommendationSearch=function(lotSearchCriteria,callBack){lotSearchCriteria=lotSearchCriteria||{};var lotRecommendationSearchCriteria={};lotRecommendationSearchCriteria.searchType=lotSearchCriteria.searchType;lotRecommendationSearchCriteria.recommendationType=lotSearchCriteria.recommendationType;lotRecommendationSearchCriteria.buyerNumber=lotSearchCriteria.buyerNumber;if(lotSearchCriteria.lotNumber){lotRecommendationSearchCriteria.lotNumber=lotSearchCriteria.lotNumber;}
lotRecommendationSearchCriteria.country=lotSearchCriteria.country;lotRecommendationSearchCriteria.state=lotSearchCriteria.state;if(lotSearchCriteria.coordinates!="undefined, undefined"){lotRecommendationSearchCriteria.coordinates=lotSearchCriteria.coordinates;}
var url='/g2mext/api/v1/public/lotRecommendations';var req={method:'POST',url:url,headers:{'siteCode':userConfig.siteCode,'languageCode':userConfig.selectedLang},data:lotRecommendationSearchCriteria};$http(req).success(function(response){if(callBack)
callBack(response);}).error(function(response){log.error("Error fetching lotRecommendationSearch"+response);});};self.downloadCSV=function(url,successCallBack,failureCallBack){$http.get(url).then(function(response){if(successCallBack){successCallBack(response);}},function(response){if(failureCallBack)
failureCallBack({});log.error("Error returned"+response);});};}]);
'use strict';angular.module('g2app').service('watchListRestService',['$http','$q','$location','$locale','config','$sce',function($http,$q,$location,$locale,config,$sce){var log=new Logger({name:'watchListRestService'});var self=this;var locale=new LocaleService($locale,$sce,config);self.getLocale=function(){return locale;};self.addAllCheckedToWatchlist=function(lots,callBack){var data={lots:lots};$http.post('/data/lots/add/checked/watchlist',data).then(function(response){if(callBack){callBack(response);}},function(response){if(callBack)
callBack({});log.error("Error returned"+response);});};self.addAllToWatchlist=function(data,callBack){var req={method:'POST',url:'/data/lots/add/all/watchlist',data:data};$http(req).then(function(response){if(callBack)
callBack(response);},function(response){log.error("Error returned"+response);});};self.removeCheckedFromWatchlist=function(lots,callBack){var data={lots:lots};$http.post('/data/lots/remove/checked/watchlist',data).then(function(response){if(callBack){callBack(response);}},function(response){if(callBack)
callBack({});log.error("Error returned"+response);});};self.removeAllFromWatchlist=function(data,callBack){var req={method:'POST',url:'/data/lots/remove/all/watchlist',data:data};$http(req).then(function(response){if(callBack)
callBack(response);},function(response){log.error("Error returned"+response);});};self.getWatchListForBuyer=function(callBack){$http({method:'GET',url:'/data/lots/watchList',noCancelOnRouteChange:true}).then(function successCallback(response){if(callBack){callBack(response);}},function errorCallback(response){log.error("Error is fetching WatchList"
+JSON.stringify(response));});};self.addToWatchList=function(lotNumber,callBack){$http({method:'POST',url:'/data/lots/addToWatchList/'+lotNumber}).then(function successCallback(response){if(callBack){if(response.data.returnCode!=1){response.data.data.message=locale.messages['app.watchlist.modified.sproc.error.'+response.data.data.code]?locale.messages['app.watchlist.modified.sproc.error.'+response.data.data.code]:response.data.data.message;}
callBack(response);}},function errorCallback(response){log.error("Error: Failed to add lot in watch list");});};self.removeFromWatchList=function(lotNumber,callBack){$http({method:'POST',url:'/data/lots/removeFromWatchList/'+lotNumber}).then(function successCallback(response){if(callBack){callBack(response);}},function errorCallback(response){log.error("Error: Failed to removed lot from watch list");});};}]);

app.factory('searchCriteriaFactory',['$location','$filter','copartUtils',function($location,$filter,copartUtils){var self=this;var searchCriteriaMap={};function lotSearchCriteria(){var self=this;var MISC=[];var SEOData={};var sortByZip=false;var buyerEnteredZip=null;var displayStr=null;var headerText=null;var milesAway=null;var searchCriteriaObj=null;var includeTagByField=null;var categoryNameByUri=null;var displayNameByUri=null;self.setDisplayNameByUri=function(displayName){displayNameByUri=displayName;};self.getDisplayNameByUri=function(){return displayNameByUri;};self.setCategoryNameByUri=function(categoryName){categoryNameByUri=categoryName;};self.getCategoryNameByUri=function(){return categoryNameByUri;};self.setIncludeTagByField=function(includeTag){includeTagByField=includeTag;};self.getIncludeTagByField=function(){return includeTagByField;};self.setSortByZip=function(sortByZipValue){sortByZip=sortByZipValue;};self.getSortByZip=function(){return sortByZip;};self.setBuyerEnteredZip=function(zipCode){buyerEnteredZip=zipCode;};self.getBuyerEnteredZip=function(){return buyerEnteredZip;};self.setMiscFilter=function(miscFilter){MISC=miscFilter;};self.getMiscFilter=function(){return MISC;};self.getQuery=function(){return $filter('sanitize_html')($location.search().query||'');};self.setQuery=function(query){$location.search().query=query;};self.isFreeForm=function(){return $location.search().free||false;};self.setFreeForm=function(free){$location.search().free=free||false;};self.setDisplayStr=function(msg){displayStr=msg;};self.getDisplayStr=function(){return displayStr;};self.setSEOData=function(data){SEOData=data;};self.getSEOData=function(){return SEOData;};self.setHeaderText=function(text){headerText=text;};self.getHeaderText=function(){return headerText;};self.setMilesAway=function(miles){milesAway=miles;};self.getMilesAway=function(){return milesAway;};self.reInitialize=function(newSearchCriteria){MISC=copartUtils.modifiedVehicleFinderSearchCriteria(newSearchCriteria.MISC);sortByZip=newSearchCriteria.sortByZip;buyerEnteredZip=newSearchCriteria.buyerEnteredZip;milesAway=newSearchCriteria.milesAway;};self.setSearchCriteriaObj=function(searchCriteria){searchCriteriaObj=searchCriteria;};self.getSearchCriteriaObj=function(){return searchCriteriaObj;};self.reset=function(){MISC=[];SEOData={};sortByZip=false;buyerEnteredZip=null;displayStr=null;headerText=null;milesAway=null;searchCriteriaObj=null;}};self.getSearchCriteria=function(key){return searchCriteriaMap[key];}
searchCriteriaMap.lotSearchCriteria=new lotSearchCriteria();searchCriteriaMap.myLotsCriteria=new lotSearchCriteria();searchCriteriaMap.myBidsCriteria=new lotSearchCriteria();searchCriteriaMap.myCounterBidsCriteria=new lotSearchCriteria();searchCriteriaMap.lotWonSearchCriteria=new lotSearchCriteria();searchCriteriaMap.paymentsDueSearchCriteria=new lotSearchCriteria();searchCriteriaMap.titleStatusSearchCriteria=new lotSearchCriteria();searchCriteriaMap.toBePickedupLotsSearchCriteria=new lotSearchCriteria();searchCriteriaMap.lotsHistorySearchCriteria=new lotSearchCriteria();searchCriteriaMap.makeModelSearchCriteria=new lotSearchCriteria();return self;}]);app.constant('searchCriteriaConstants',{lotSearch:'lotSearchCriteria',mylots:'myLotsCriteria',mybids:'myBidsCriteria',mycounterbids:'myCounterBidsCriteria',lotswon:'lotWonSearchCriteria',paymentsdue:'paymentsDueSearchCriteria',titlestatus:'titleStatusSearchCriteria',tobepickeduplots:'toBePickedupLotsSearchCriteria',lotshistory:'lotsHistorySearchCriteria',makeModelSearch:'makeModelSearchCriteria'});

app.service('HttpPendingRequestsService',['$q','cfpLoadingBar',function($q,cfpLoadingBar){var cancelPromises=[];function newTimeout(){cfpLoadingBar.start();var cancelPromise=$q.defer();cancelPromises.push(cancelPromise);return cancelPromise.promise;}
function cancelAll(){cfpLoadingBar.complete();angular.forEach(cancelPromises,function(cancelPromise){cancelPromise.promise.isGloballyCancelled=true;cancelPromise.resolve();});cancelPromises.length=0;}
return{newTimeout:newTimeout,cancelAll:cancelAll};}]);app.factory('HttpRequestTimeoutInterceptor',['$q','HttpPendingRequestsService','$sce','$location',function($q,HttpPendingRequestsService,$sce,$location){return{request:function(config){config=config||{};if(config.timeout===undefined&&!config.noCancelOnRouteChange){config.timeout=HttpPendingRequestsService.newTimeout();}
return config;},responseError:function(response){if(response.config&&response.config.timeout&&response.config.timeout.isGloballyCancelled){return $q.defer().promise;}
return $q.reject(response);}};}]);app.factory('XSSRequestWrapperInterceptor',['$location',function($location){return{request:function(config){if($location.search()&&!_.isEmpty($location.search())){var search={};_.each($location.search(),function(value,key){if(/<(.|\n)*?>/g.test(value))search[key]=value.replace(/<(.|\n)*?>/g,'')
else search[key]=value;});$location.search(search);}
return config;}};}]);

app.service('metaDataService',['$rootScope','$location','startupRestService','copartUser','$sce','copartUtils',function($rootScope,$location,startupRestService,copartUser,$sce,copartUtils){var self=this;var defaultTitleKey="app.home.title";var defaultDescKey="app.home.description";var metaArgs={};var currentRoute={};var sce=$sce;var seoCountryCodeMap={'USA':'US','CAN':'CA','GBR':'GB','IRL':'IE','ARE':'AE','BHR':'BH','OMN':'OM','DEU':'DE','IND':'IN','ESP':'ES','BRA':'BR','CHN':'CN'};self.getSiteLogoURL=function(locale){var logoPath=locale.messages['app.logo.ImgPath'];return window.location.origin+logoPath;}
var seoCountryCodeTitleMap={'CPRTUS':'Copart','CPRTCA':'Copart Canada','CRTSUS':'CrashedToys','DRIVUS':'DRIVE Auto Auctions','CPRTUK':'Copart UK','CPRTMEA':'Copart MEA','CPRTIE':'Copart Ireland','CPRTDE':'Copart Germany','CPRTES':'Copart Spanish','CPRTIN':'Copart India','CPRTFI':'Copart Finland'};self.getSiteTitleFromCountryCode=function(siteCode){return seoCountryCodeTitleMap[siteCode];}
self.getAbsoluteUrl=function(relativeUrl){var absUrl;if(!!relativeUrl){var link=document.createElement("a");link.href=relativeUrl;absUrl=link.href;}
return absUrl;};self.getLocalBusinessSeoObj=function(url){url=copartUtils.removeTrailingSlash(url);return{"@context":"http://www.schema.org","@type":"LocalBusiness","name":"","url":url,"image":"","telephone":"","openingHours":[],"address":{"@type":"PostalAddress","streetAddress":"","addressLocality":"","postalCode":"","addressCountry":""}}};self.getProductEventSeoObj=function(url){url=copartUtils.removeTrailingSlash(url);return{"@context":"http://www.schema.org","@type":"Event","name":"","description":"","startDate":[],"endDate":[],"url":url,"image":window.location.origin+"/images/logo.svg","location":{"@type":"Place","name":"","address":""},"eventStatus":"https://schema.org/EventScheduled","eventAttendanceMode":"https://schema.org/OnlineEventAttendanceMode","Organizer":{"@type":"Corporation","name":"Copart"}}};self.getEventsSeoObj=function(url){url=copartUtils.removeTrailingSlash(url);return{"@context":"http://www.schema.org","@type":"Event","name":"","description":"","startDate":[],"endDate":[],"eventStatus":"https://schema.org/EventScheduled","eventAttendanceMode":"https://schema.org/OnlineEventAttendanceMode","location":{"@type":"VirtualLocation","url":url},"image":window.location.origin+"/images/logo.svg","Organizer":{"@type":"Corporation","name":"Copart"}}};self.getProductsSeoObj=function(url){url=copartUtils.removeTrailingSlash(url);return{"@context":"https://schema.org","@type":"Product","name":"","image":"","description":"","brand":{"@type":"Brand","name":""},"offers":{"@type":"Offer","url":url,"price":"","priceCurrency":"USD"}}};self.appendEventToSEO=function(seoObj,script,eventList){if(window.appInit.isUserAgentBOT&&eventList&&seoObj&&script){eventList.forEach(function(auction){seoObj.startDate.push(moment(auction.auctionDate.date).format('MM/DD/YYYY'))
seoObj.endDate.push(moment(auction.auctionDate.date).format('MM/DD/YYYY'))});script.html(JSON.stringify(seoObj));}};self.updateEventSEOAddr=function(seoObj,script,yardDetails,locale){if(window.appInit.isUserAgentBOT&&yardDetails&&script&&seoObj){seoObj.name=yardDetails.yardName;var descVar=' - '+yardDetails.yardName+','+yardDetails.yardMailingStateCode;seoObj.description=sce.getTrustedHtml(locale.getMessage('seo.event.yard.description',descVar));script.html(JSON.stringify(seoObj));}};self.prepareProductEventDetails=function(lotDetails,locale){if(!lotDetails||!lotDetails.phynumb)return false;if(lotDetails.ils==true)return false;var script=$('#seoEventScript');if(script.length==0){script=$(document.createElement('script'));script.attr('type','application/ld+json');$("body").append(script);}
var langCode='';if(locale.lang!=='en'){langCode="/"+locale.lang;}
var seoEventUrl=langCode+"/lot/"+lotDetails.lotNumberStr+"/"+lotDetails.ldu;var seoObj=self.getProductEventSeoObj(self.getAbsoluteUrl(seoEventUrl));seoObj.name=lotDetails.ld;seoObj.description="Register to Start Bidding";seoObj.image=(lotDetails.tims!=null)?lotDetails.tims:self.getSiteLogoURL(locale);seoObj.location.address=lotDetails.syn;seoObj.location.name=lotDetails.syn;if(lotDetails.ifs==false&&lotDetails.ad){seoObj.startDate=moment(lotDetails.ad).tz(copartUser.getUserConfig().selectedTimezone).format('MM/DD/YYYY');seoObj.endDate=moment(lotDetails.ad).tz(copartUser.getUserConfig().selectedTimezone).format('MM/DD/YYYY');script.html(JSON.stringify(seoObj));}else{script.remove();}};self.prepareJSONLDLotProductDetails=function(lotDetails,locale){if(!lotDetails||!lotDetails.phynumb)return;if(lotDetails.ils||lotDetails.ifs)return;if(!lotDetails.la||lotDetails.la<1)return;if(!lotDetails.mkn||!lotDetails.cuc||!lotDetails.ld)return;var script=$('#seoProductScript');if(script.length==0){script=$(document.createElement('script'));script.attr('type','application/ld+json');$("body").append(script);}
var langCode='';if(locale.lang!=='en'){langCode="/"+locale.lang;}
var seoProductUrl=langCode+"/lot/"+lotDetails.lotNumberStr+"/"+lotDetails.ldu;var seoObj=self.getProductsSeoObj(self.getAbsoluteUrl(seoProductUrl));seoObj.name=lotDetails.ld;seoObj.image=(lotDetails.tims!=null)?lotDetails.tims:self.getSiteLogoURL((locale));seoObj.description="Register now to start bidding";seoObj.brand.name=lotDetails.mkn;seoObj.offers.price=lotDetails.la;seoObj.offers.priceCurrency=lotDetails.cuc;script.html(JSON.stringify(seoObj));}
self.prepareSEOLocalBusinessDetails=function(yardNumber,locale,response){var script=$('#seoLocalBusiness');if(script.length==0){script=$(document.createElement('script'));script.attr('id','seoLocalBusiness');script.attr('type','application/ld+json');$("body").append(script);}
var seoObj=self.getLocalBusinessSeoObj($location.absUrl());if(response&&response.data&&script&&seoObj){var yardDetails=response.data;seoObj.name=yardDetails.yardName;if(locale.messages['app.label.seo.copart']!==undefined){seoObj.name=locale.messages['app.label.seo.copart']+seoObj.name;}
seoObj.image=self.getSiteLogoURL(locale);seoObj.address.streetAddress=yardDetails.yardAddress1;seoObj.address.addressLocality=yardDetails.yardCity;seoObj.address.postalCode=yardDetails.yardZip;seoObj.address.addressCountry=yardDetails.yardCountryCode;seoObj.telephone="+"+yardDetails.yardPhoneAreaCode+yardDetails.yardPhoneNumber;var changeTimeTo12HourFormat=self.changeTimeTo12HourFormat(yardDetails.yardHours);seoObj.openingHours=yardDetails.yardBeginDay+"-"+yardDetails.yardEndDay+","+changeTimeTo12HourFormat+" "+yardDetails.timeZoneFromSolr;script.html(JSON.stringify(seoObj));}else{script.remove();}};self.changeTimeTo12HourFormat=function(time){var formatTime=time.split(" ");var timeStart=self.changeTimeZoneFunction(formatTime[0]);var timeEnd=self.changeTimeZoneFunction(formatTime[2]);return timeStart+"-"+timeEnd;}
self.changeTimeZoneFunction=function(hours){hours=hours.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[hours];if(hours.length>1){hours=hours.slice(1);hours[5]=+hours[0]<12?'AM':'PM';hours[0]=+hours[0]%12||12;}
return hours.join('');}
self.prepareSEOLotDetails=function(lotDetails,locale){if(!lotDetails||!lotDetails.phynumb)return false;if(lotDetails.ils==true)return false;var siteCode=copartUser.getUserConfig().siteCode;var siteTitle=self.getSiteTitleFromCountryCode(siteCode);var script=$('#seoScript');if(script.length==0){script=$(document.createElement('script'));script.attr('id','seoScript');script.attr('type','application/ld+json');$("body").append(script);}
var seoObj=self.getEventsSeoObj($location.absUrl());startupRestService.getLocationDetail(lotDetails.phynumb,function(response){if(response&&response.data&&script&&seoObj){var yardDetails=response.data;seoObj.name=yardDetails.yardName;seoObj.description=siteTitle+" - "+yardDetails.yardName+", Upcoming Auto Auction";seoObj.image=self.getSiteLogoURL(locale);if(lotDetails.ifs==false&&lotDetails.ad){seoObj.startDate=moment(lotDetails.ad).tz(copartUser.getUserConfig().selectedTimezone).format('MM/DD/YYYY');seoObj.endDate=moment(lotDetails.ad).tz(copartUser.getUserConfig().selectedTimezone).format('MM/DD/YYYY');script.html(JSON.stringify(seoObj));}else{script.remove();}}else{script.remove();}});};self.prepareSEOLotProductDetails=function(lotDetails){if(!lotDetails||!lotDetails.phynumb)return;if(lotDetails.ils||lotDetails.ifs)return;if(!lotDetails.la||lotDetails.la<1)return;if(!lotDetails.mkn||!lotDetails.cuc||!lotDetails.ld)return;var script=$('#seoProductScript');if(script.length==0){script=$(document.createElement('script'));script.attr('id','seoProductScript');script.attr('type','application/ld+json');$("body").append(script);}
var seoObj=self.getProductsSeoObj($location.absUrl());seoObj.name=lotDetails.ld;seoObj.image=(lotDetails.tims!=null)?lotDetails.tims:self.getSiteLogoURL;seoObj.description="Register now to start bidding";seoObj.brand.name=lotDetails.mkn;seoObj.offers.url=$location.absUrl();seoObj.offers.price=lotDetails.la;seoObj.offers.priceCurrency=lotDetails.cuc;script.html(JSON.stringify(seoObj));};self.prepareSEOAddrSalesList=function(startTime,saleName,startDate,nextSaleDate,yardNum,isLiveAuction,locale){if(!startTime||!saleName||!startDate||!yardNum)return false;startupRestService.getLocationDetail(yardNum,function(response){var locationDetail=response.data;if(locationDetail){if("IRL"==locationDetail.yardCountryCode){locationDetail.yardZip="R14 YK37";locationDetail.yardMailingZip="R14 YK37";}
var script=$(document.createElement('script'));script.attr('id','seoScript');script.attr('type','application/ld+json');var seoObj=self.getEventsSeoObj($location.absUrl());locationDetail.name=saleName;var startDateTemp='';if(nextSaleDate){startDateTemp=nextSaleDate;}else{if(isLiveAuction){var currDate=moment().tz(copartUser.getUserConfig().selectedTimezone).format(copartUser.getUserConfig().displayPref.dateFormat.toUpperCase());startDateTemp=currDate;}else{startDateTemp=startDate;}}
locationDetail.startDate=startDateTemp;self.updateEventSEOAddrSalesList(seoObj,script,locationDetail,locale);$("body").append(script);}});};self.updateEventSEOAddrSalesList=function(seoObj,script,yardDetails,locale){if(yardDetails&&script&&seoObj){var name=locale.getMessage('app.label.yardDetails.yardName')||"Copart ";seoObj.name=name+yardDetails.name+" Upcoming Auto Auctions";seoObj.description=name+yardDetails.name+" Upcoming Auto Auctions";seoObj.startDate=yardDetails.startDate;seoObj.endDate=yardDetails.startDate;seoObj.location.name=yardDetails.name;seoObj.location.address.streetAddress=yardDetails.yardAddress1+','+yardDetails.yardAddress2;seoObj.location.address.addressLocality=yardDetails.yardCity;seoObj.location.address.addressRegion=yardDetails.yardStateName;seoObj.location.address.postalCode=yardDetails.yardZip;seoObj.location.address.addressCountry=yardDetails.yardCountryCode;script.html(JSON.stringify(seoObj));}};self.getTitleForRoute=function(route,locale){currentRoute=route;var ret="";try{if(route.titleKey){ret=locale.getMessageForKey(route.titleKey,getArgsValFromMetaArgs(route.arguments?route.arguments:route.titleArguments),locale.titleDescription);if(!(ret)||ret==='')
{ret=locale.messages[defaultTitleKey];}}else{ret=locale.getMessageForKey(defaultTitleKey);}}catch(e){ret=locale.getMessageForKey(defaultTitleKey);}
return ret;};self.getDescForRoute=function(route,locale){currentRoute=route;var ret="";try{if(route.descKey){ret=locale.getMessageForKey(route.descKey,getArgsValFromMetaArgs(route.arguments?route.arguments:route.descArguments),locale.titleDescription);if(!(ret)||ret==='')
{ret=locale.messages[defaultTitleKey];}}else{ret=locale.getMessageForKey(defaultDescKey);}}catch(e){ret=locale.getMessageForKey(defaultDescKey);}
return ret;};self.refresh=function(locale){$rootScope.title=self.getTitleForRoute(currentRoute,locale);$rootScope.description=self.getDescForRoute(currentRoute,locale);};self.setPreviousPage=function(url){$rootScope.previousPage=url;};self.setNextPage=function(url){$rootScope.nextPage=url;};self.clearPageTags=function(){$rootScope.previousPage=null;$rootScope.nextPage=null;};var metaDataUpdateEvent=$rootScope.$on("meta-args-update",function(event,data){var keys=_.keys(data);for(var i=0;i<keys.length;i++){metaArgs[keys[i]]=data[keys[i]];}
$rootScope.$emit('update-site-meta');});var getArgsValFromMetaArgs=function(args){var ret=[];if(args){for(var i=0;i<args.length;i++){ret.push(metaArgs[args[i]]);}
return ret;}else{return ret;}}
self.getValFromMetaArgs=function(arg){return metaArgs[arg];};self.prepareEventMarkupSeoObj=function(totalItemsOnSale,startDate){return{"@context":"http://schema.org","@type":"Corporation","name":"Copart","description":"Leader in online salvage & insurance auto auctions & sales. Over 130,000 total loss cars, clean title, used cars, trucks, SUVs & fleet vehicles.","url":"https://www.copart.com/","logo":"https://www.copart.com/images/logo.svg","address":{"streetAddress":"14185 Dallas Parkway, Suite 300","addressLocality":"Dallas","addressRegion":"TX","postalCode":"75254","addressCountry":"USA"},"sameAs":["https://www.facebook.com/Copart","https://twitter.com/copart","https://plus.google.com/+CopartTV","https://www.instagram.com/copart1982/","https://www.youtube.com/copart","https://www.linkedin.com/company/copart","https://en.wikipedia.org/wiki/Copart"],"telephone":""}};self.prepareEventMarkupSeoScriptObj=function(totalItemsOnSale,url,startDate){url=copartUtils.removeTrailingSlash(url);return{"@context":"http://schema.org","@type":"Event","name":"Over "+totalItemsOnSale+" Vehicles on sale now!","url":url,"startDate":startDate,"endDate":startDate,"Location":{"@type":"Place","address":url}}}
self.callPrepareEventMarkupSeoObj=function(){setTimeout(function(){var startDate=moment().tz(copartUser.getUserConfig().selectedTimezone).format(copartUser.getUserConfig().defaultDisplayPref.dateFormat.toUpperCase());var markupSeoObj=self.prepareEventMarkupSeoObj(startupRestService.totalItemsOnSale,startDate);var script=$(document.createElement('script'));script.attr('type','application/ld+json');script.html(JSON.stringify(markupSeoObj));$("body").append(script);},1000);}
self.callPrepareEventMarkupSeoScriptObj=function(){setTimeout(function(){var startDate=moment().tz(copartUser.getUserConfig().selectedTimezone).format(copartUser.getUserConfig().defaultDisplayPref.dateFormat.toUpperCase());var markupSeoObj=self.prepareEventMarkupSeoScriptObj(startupRestService.totalItemsOnSale,window.location.href,startDate);var script=$(document.createElement('script'));script.attr('type','application/ld+json');script.html(JSON.stringify(markupSeoObj));$("body").append(script);},1000);}}]);

app.service('geocodingService',['userService','startupRestService',function(userService,startupRestService){var self=this;self.zipToCoord={};var userConfig=userService.userConfig;self.threeCharCountryCode=userConfig.preferredCountryCode?userConfig.preferredCountryCode.toUpperCase():'';self.getCoordinatesForZip=function(zip,callback,errorCallback){if(_.isEmpty(self.zipToCoord)){self.zipToCoord=userService.userConfig.zipToCoordinate||{};}
var retData={latitude:0.000000,longitude:0.000000};if(!_.isEmpty(self.zipToCoord[zip])){retData.latitude=self.zipToCoord[zip].latitude;retData.longitude=self.zipToCoord[zip].longitude;if(callback){callback(retData);}}
else{getCoordinatesFromLocationInfoService(zip,retData,callback,errorCallback);}};var getCoordinatesFromLocationInfoService=function(zip,retData,callback,errorCallback){var zipCode=zip?zip.trim():"";var location={"threeCharCountryCode":self.threeCharCountryCode,"zipCode":zipCode};if(location.threeCharCountryCode==='CAN'||location.threeCharCountryCode==='IRL'){location.zipCode=zipCode.slice(0,3);}
startupRestService.updateLocationInfo(location,function(response){if((response.returnCode!=-1)&&!(_.isEmpty(response.data))){if(response.data.length>0){retData.latitude=response.data[0].latitude;retData.longitude=response.data[0].longitude;self.zipToCoord[zip]={latitude:retData.latitude,longitude:retData.longitude}
var zipToCoordinate={};zipToCoordinate[zip]=retData;startupRestService.updateUserConfig({'zipToCoordinate':zipToCoordinate});}
if(callback){callback(retData);}}
else if(response.returnCode==-1){errorCallback(response.returnCode);}},function(error){console.log.error("Failed to fetch Location coordinates"+error);if(callback){callback(retData);}});}}]);
'use strict';app.service('userService',['copartUser',function(copartUser){var self=this;self.userConfig=copartUser.config;self.bidIncrements=[];var pagesWithPreBid=["/saleListResult","/watchList","/saleListResultAll"];var pagesWithShowAll=["saleListResult"];self.isAnonymous=function(){if(_.contains(self.userConfig.roles,'ROLE_ANONYMOUS')){return true;}else{return false;}};self.isPremium=function(){if(_.contains(self.userConfig.roles,'ROLE_PREMIUM')){return true;}else{return false;}};self.isInActive=function(){if(self.userConfig.buyerStatus=='I'){return true;}else{return false;}};self.isBroker=function(){if(_.contains(self.userConfig.roles,'ROLE_BROKER')){return true;}else{return false;}};self.isMaster=function(){if(_.contains(self.userConfig.roles,'ROLE_MASTER')){return true;}else{return false;}};self.isEligibleToMultiBid=function(url){for(var i=0;i<pagesWithPreBid.length;i++){var item=pagesWithPreBid[i];if(url.indexOf(item)!=-1){return copartUser.hasAccessPrivilege('MULTI_LOT_BIDDING');}}
return false;};self.isShowAllEnabled=function(url){for(var i=0;i<pagesWithShowAll.length;i++){var item=pagesWithShowAll[i];if(url.indexOf(item)!=-1){if(copartUser.getUserConfig().isKioskBidder&&item=='saleListResult')
return false;else
return true;}}
return false};self.getBuyerNumber=function(){if(!_.isUndefined(self.userConfig.buyerNumber)){return self.userConfig.buyerNumber;}else{return"1";}};}]);
'use strict'
app.service('memberChoicesService',['appConfigService','$locale','$sce','config',function(appConfigService,$locale,$sce,config){var log=new Logger({name:'memberChoicesService'});var locale=new LocaleService($locale,$sce,config);var self=this;self.memberChoices=null;var selectedChoices={};self.init=function(){selectedChoices={};};self.getSelectedChoices=function(){return selectedChoices;}
self.setSelectedChoices=function(questionCode,choiceTypes){if(choiceTypes&&choiceTypes.length>0){selectedChoices[questionCode]=choiceTypes;}else{delete selectedChoices[questionCode];}}
self.getSelectedChoicesAsArray=function(){return _.values(self.getSelectedChoices());}
self.getQuestion=function(choiceTypeCode){try{var memChoices=self.getMemberChoices();return memChoices&&memChoices[choiceTypeCode]?memChoices[choiceTypeCode][0]:null;}catch(e){log.error("Error in fetching the choices for code {}-> ",choiceTypeCode,e)
return null;}};self.getMemberChoices=function(){if(!self.memberChoices){var defaultMemberChoices=appConfigService.appConfig.getDefaultMemberChoices();self.memberChoices=_.groupBy(defaultMemberChoices,"questionCode");}
return self.memberChoices;};self.addChoiceSelection=function(choiceArray,choiceType){choiceArray=choiceArray||[];choiceArray.push(choiceType);return choiceArray;}
self.removeChoiceSelection=function(choiceArray,choiceType){choiceArray=choiceArray||[];choiceArray.splice(choiceArray.indexOf(choiceType),1);return choiceArray;}
self.updateChoiceSelections=function(questionCode,choiceType,replaceChoices){var choicesArray=(self.getSelectedChoices()[questionCode]&&!replaceChoices)?self.getSelectedChoices()[questionCode]:[];if(self.verifyIfChoiceExists(choicesArray,choiceType)){choicesArray=self.removeChoiceFromArray(choicesArray,choiceType);}else{if(choiceType){choiceType.selected=true;choicesArray.push(choiceType);}}
self.setSelectedChoices(questionCode,choicesArray);}
self.displaySelectedChoices=function(questionCode){var choiceAnswers=self.getSelectedChoices()[questionCode]||[];return choiceAnswers;}
self.verifyIfChoiceExists=function(choiceArray,choiceType){return _.some(choiceArray,function(choice){return choice.answerCode==choiceType.answerCode;})}
self.removeChoiceFromArray=function(choiceArray,choiceType){return _.reject(choiceArray,function(choice){return choice.answerCode==choiceType.answerCode;})}}]);

app.service('auctionsCalendarService',['startupRestService','$q','$interval','copartUser',function(startupRestService,$q,$interval,copartUser){var self=this;self.todaysAuctionDate=moment();self.globalPromise=null;self.getAuctionsCalender=function(refresh){var deferred;if(refresh){self.globalPromise=null;deferred=$q.defer();}else{if(self.globalPromise){return self.globalPromise;}
deferred=$q.defer();if(!_.isEmpty(self.allList)){deferred.resolve();return deferred.promise;}}
startupRestService.getAuctionsCalendarList(function(response){self.todayAuctions={liveAuctions:[],endedAuctions:[],laterAuctions:[]};self.futureAuctions=[];if(response.returnCode==1&&response.returnCodeDesc=="Success"){self.todaysAuctionDate=moment.utc(response.data.todaysAuctionDate);self.offset=copartUser.getUserTimzoneOffset();self.todayDate=self.todaysAuctionDate.utcOffset(self.offset).format("YYYYMMDD");if(moment.utc(response.data.todaysAuctionDate).startOf('isoWeek').toDate().getDay()==0){self.startDayofWeek=moment.utc(response.data.todaysAuctionDate).startOf('isoWeek').utcOffset(self.offset).add(1,'days');}else{self.startDayofWeek=moment.utc(response.data.todaysAuctionDate).startOf('isoWeek').utcOffset(self.offset);}
self.allList=response.data.saleList;self.reGroupAuctions();deferred.resolve();}else{deferred.reject();}
self.globalPromise=null;});self.globalPromise=deferred.promise;return self.globalPromise;};self.reGroupAuctions=function(){self.todayAuctions={liveAuctions:[],endedAuctions:[],laterAuctions:[]};_.each(self.allList,function(auction){if(auction.auctionDate!=null){if(auction.auctionDate.dateAsInt==self.todayDate){if(auction.isLive){self.todayAuctions.liveAuctions.push(auction);}
else if(auction.closedFlag=="Y"){self.todayAuctions.endedAuctions.push(auction);}
else if(auction.closedFlag=="N"||auction.closedFlag==""||auction.closedFlag=="E"){self.todayAuctions.laterAuctions.push(auction);}}
else if(auction.auctionDate.dateAsInt>self.todayDate){self.futureAuctions.push(auction);}}});};function refereshAuctionCalendar(){self.allList=[];}
$interval(refereshAuctionCalendar,180000);self.getAllList=function(){var deferred=$q.defer();self.getAuctionsCalender(false).then(function(){deferred.resolve();});return deferred.promise;};self.getAllAuctionData=function(){var deferred=$q.defer();self.getAuctionsCalender(false).then(function(){var data={};data.allList=self.allList;data.todayAuctions=self.todayAuctions;deferred.resolve(data);});return deferred.promise;};self.todayAuctionsByYard=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var auction=_.filter(self.allList,function(list){var yardList=_.filter(list.yards,function(yard){return yard.number==yardNumber&&(list.auctionDate.dateAsInt==self.todayDate);});return yardList.length>0;});deferred.resolve(auction);});return deferred.promise;};self.laterAuctionsByYard=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var auction=_.filter(self.allList,function(list){var yardList=_.filter(list.yards,function(yard){return yard.number==yardNumber&&(list.auctionDate.dateAsInt>self.todayDate)});return yardList.length>0;});auction.sort(function(a,b){var auction1=parseInt((a['auctionDate']&&a['auctionDate'].dateAsInt)?a['auctionDate'].dateAsInt:0);var auction2=parseInt((b['auctionDate']&&b['auctionDate'].dateAsInt)?b['auctionDate'].dateAsInt:0);if(auction1===auction2){auction1=parseInt(a['fullTime']?a['fullTime']:0);auction2=parseInt(b['fullTime']?b['fullTime']:0);}
return auction1-auction2;});deferred.resolve(auction);});return deferred.promise;};self.auctionByYard=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var futureYardList=_.filter(self.allList,function(auction){var UnixAuctionDate=new Date(auction.auctionDate.date);var month=(UnixAuctionDate.getMonth()+1)>9?UnixAuctionDate.getMonth()+1:"0"+UnixAuctionDate.getMonth()+1;var date=UnixAuctionDate.getDate()>9?UnixAuctionDate.getDate():"0"+UnixAuctionDate.getDate();var yardAuctionDate=""+UnixAuctionDate.getFullYear()+month+date;return Number(yardAuctionDate)>=Number(self.todayDate);});var auction=_.find(_.sortBy(futureYardList,function(auctionYard){return auctionYard.auctionDate.dateAsInt;}),function(item){return item.closedFlag!='Y'&&item.yardNumber==yardNumber;});deferred.resolve(auction);});return deferred.promise;};self.timeToAuction=function(auctionDate){if(!auctionDate){return null;}
var now=Date.now();var diff=(auctionDate-now)/1000;if(diff<0){return null;}
var mins=Math.floor((diff/60)%60);var hours=Math.floor((diff/60/60)%24);var days=Math.floor(diff/60/60/24);return days+'D '+hours+'H '+mins+'min';};self.getLanesListForLiveYard=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var laneInfoList={};if(self.todayAuctions.liveAuctions.length>0){_.each(self.todayAuctions.liveAuctions,function(list){_.each(list.yards,function(yard){if(yard.number==yardNumber){laneInfoList[list.saleName]=list.laneInfoList;}});});}
deferred.resolve(laneInfoList);});return deferred.promise;};self.isYardLive=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var flag=false;if(self.todayAuctions.liveAuctions.length>0){_.each(self.todayAuctions.liveAuctions,function(auction){if(auction.yardNumber==yardNumber){flag=true;}});}
deferred.resolve(flag);});return deferred.promise;};self.isAuctionLive=function(yardNumber,lane,auctionDate,auctionId){var deferred=$q.defer();var flag=false;self.getAllList().then(function(){if(self.todayAuctions.liveAuctions.length>0){_.find(self.todayAuctions.liveAuctions,function(auction){if((auctionId&&auction.auctionId&&auctionId===auction.auctionId)||(auction.yardNumber==yardNumber&&moment.utc(auctionDate).isSame(moment.utc(auction.currentSaleTimeEpoch),'day'))){_.find(auction.laneInfoList,function(laneInfo){if(laneInfo.lane==lane&&laneInfo.closedFlag=="I")
{flag=true;return flag;}});return flag;}});}
deferred.resolve(flag);});return deferred.promise;};self.getAuctionDetails=function(auctionId,yardNumber,epochDateTime){var deferred=$q.defer();self.getAllList().then(function(){var auction=auctionId?_.find(self.allList,function(item){return(item.auctionId==auctionId);}):_.find(self.allList,function(item){return(epochDateTime?(item.yardNumber==yardNumber&&moment.utc(epochDateTime).isSame(moment.utc(item.currentSaleTimeEpoch),'day')):(item.yardNumber==yardNumber));});deferred.resolve(auction);});return deferred.promise;};self.getLotAuctionStatus=function(solrLots){var deferred=$q.defer();self.getAllList().then(function(){var data={"returnCode":2,"returnCodeDesc":"Success","data":{}};var lots={};_.each(solrLots,function(solrLot){var flag=false;var lot={};lot.lotNum=solrLot.ln;if(self.todayAuctions.liveAuctions.length>0){var liveAuctionForYard=_.find(self.todayAuctions.liveAuctions,function(auction){if(solrLot.adt!='E'&&auction.yardNumber==solrLot.ynumb&&moment.utc(solrLot.ad).isSame(moment.utc(auction.currentSaleTimeEpoch),'day')){flag=true;return auction;}});lot.lotAuctionStatus=flag==true?'LIVE_BIDDING':'';lot.las=flag==true?'LIVE_BIDDING':'';}else{lot.lotAuctionStatus='';lot.las='';}
lots[solrLot.ln]=lot;});data.data=lots;deferred.resolve(data);});return deferred.promise;}}]);app.service('auctionsCalendarStoreService',['$q','$interval',function($q,$interval){var self=this;var allList=[];self.auctionByYard=function(yardNumber){var deferred=$q.defer();self.getAllList().then(function(){var auction=_.find(allList,function(item){return item.yardNumber==yardNumber;});deferred.resolve(auction);});return deferred.promise;};self.setAllList=function(list){allList=list;}}]);

app.service('accountAlertsService',['copartUser','startupRestService','constants','$q','copartUtils','userService','logService','LOG_CONSTANTS',function(copartUser,startupRestService,constants,$q,copartUtils,userService,logService,LOG_CONSTANTS){var self=this;self.locale=startupRestService.getLocale();var BLOCKING_MODALS_ID="#blockingModals";var allowedActionStatusList=[constants.ALERTS_INITIATED_STATUS,constants.ALERTS_REMIND_LATER_STATUS];var BASIC_GRAND_FATHER_BUYER='BASICGF';self.getAccountAlerts=function(ignoreUpdatingAlertsObj){var deferred=$q.defer();var alerts=[];if(!alerts||alerts.length===0){startupRestService.getAccountAlerts().then(function(response){if(copartUtils.isResponseValid(response)){alerts=response.data;if(!ignoreUpdatingAlertsObj){self.alerts=alerts||[];}}
self.updateCompleteRegistrationProviderFlag();deferred.resolve(alerts);},function(error){self.updateCompleteRegistrationProviderFlag();deferred.reject(alerts);console.log(error);logService.logToServer("GET_ACCOUNT_ALERTS","Fetching account alerts failed",error,LOG_CONSTANTS.ERROR_STATUS);});}
if(alerts&&alerts.length>0){deferred.resolve(alerts);}
return deferred.promise;};self.getBannerAlerts=function(alerts){var bannerAlerts=undefined;if(alerts){for(var index=0;index<alerts.length;index++){if(alerts&&alerts[index]&&alerts[index]['alertCategory']===constants.BANNER){bannerAlerts=alerts[index].alerts;}}}
return bannerAlerts;};self.updateAccountAlerts=function(userActionCode){var deferred=$q.defer();self.removeAlert(userActionCode,constants.ALERTS_REMIND_LATER_STATUS);return deferred.promise;};self.updateDisplayAlertsModal=function(value){copartUser.setDisplayAlertsModal(value);startupRestService.updateDisplayAlertsModal({'displayAlertsModal':value});};self.removeAlert=function(userActionCode,actionStatus){var deferred=$q.defer();if(userActionCode){startupRestService.updateAccountAlerts(self.generateRequestData(userActionCode,actionStatus)).then(function(response){if(response&&response.data&&response.returnCode!==-1){self.removeAlertBannerAndModalFromView(userActionCode);deferred.resolve(response.data);}},function(error){console.log(error);deferred.reject(error);});}
return deferred.promise;};self.removeAlertBannerAndModalFromView=function(userActionCode){jQuery('#carousel-banner #banner-'+userActionCode).remove();jQuery('#carousel-banner').children().removeClass('active');jQuery('#carousel-banner .item').first().addClass('active');jQuery('#alertsContent #modal-'+userActionCode).remove();jQuery('#alertsContent .item').first().addClass('active');};self.generateRequestData=function(userActionCode,actionStatus){var data={};var pendingActions=self.getAlertsFromUserActivity(self.alerts);if(userActionCode&&pendingActions&&pendingActions.length>0){pendingActions.forEach(function(alert){if(userActionCode===alert.customUserActionCode){data.userActionId=alert.userActionId;data.actionStatus=actionStatus;}});}
return data;};self.getAlerts=function(){return self.alerts;};self.getPendingActionsFromUserActivity=function(userActivities){var pendingActions=[];if(userActivities&&userActivities.length>0){userActivities.forEach(function(activity){if(activity&&activity.accountAlerts&&activity.accountAlerts.length>0){activity.accountAlerts.forEach(function(alert){pendingActions.push(alert);});}});}
return pendingActions;};self.getAlertsFromUserActivity=function(userActivities){var pendingActions=self.getPendingActionsFromUserActivity(userActivities);var alerts=[];for(var i=0;i<pendingActions.length;++i){if(pendingActions[i]&&pendingActions[i].actionStatus!==constants.ALERT_FILTER_ACTION_STATUS){alerts.push(pendingActions[i]);}}
return alerts;};self.verifyUserActivityCompleted=function(userActivities,userActivity){if(userActivities&&userActivities.length>0&&userActivity){for(var i=0;i<userActivities.length;++i){if(userActivities[i].userActivity===userActivity){return userActivities[i].accountAlerts&&userActivities[i].accountAlerts.length===0;}}}
return true;};self.verifyUserActionCompleted=function(userActivities,userAction){for(var i=0;i<userActivities.length;++i){if(userActivities[i]&&userActivities[i].userActionCode===userAction){return false;}}
return true;};self.verifyUserActionCompletedFromActivities=function(userAction){var pendingUserActions=self.getPendingActionsFromUserActivity(self.alerts);for(var i=0;i<pendingUserActions.length;++i){if(pendingUserActions[i]&&pendingUserActions[i].userActionCode===userAction){return false;}}
return true;};self.verifyUserActivityCompletedByIgnoringAlert=function(userActivities,userActivity,ignoreAlert){if(userActivities&&userActivities.length>0&&userActivity){for(var i=0;i<userActivities.length;++i){if(userActivities[i].userActivity===userActivity&&userActivities[i].accountAlerts&&userActivities[i].accountAlerts.length>0){var userActivitesAlertList=angular.copy(userActivities[i].accountAlerts);if(ignoreAlert){userActivitesAlertList=_.without(userActivitesAlertList,_.findWhere(userActivitesAlertList,{userActionCode:ignoreAlert}))}
return userActivitesAlertList&&userActivitesAlertList.length===0;}}}
return true;};self.filterAlertsForUserViewFromUserActivities=function(userActivities){var pendingActions=[];if(userActivities&&userActivities.length>0){userActivities.forEach(function(activity){if(activity&&activity.accountAlerts&&activity.accountAlerts.length>0){activity.accountAlerts.forEach(function(alert){if(alert&&alert.actionStatus&&allowedActionStatusList.indexOf(alert.actionStatus)>-1)
{pendingActions.push(alert);}});}});}
return _.uniq(pendingActions,function(action){return action.customUserActionCode;});};self.filterBlockingModalUserActions=function(userActions){var blockingUserActions=[];if(!_.isEmpty(userActions)){_.each(userActions,function(userAction){if(!_.isEmpty(userAction.alertsConfig)){_.each(userAction.alertsConfig,function(alertsConfig){if(alertsConfig.blockUI){blockingUserActions.push(userAction);}})}})}
return blockingUserActions;}
self.getActivityFromList=function(userActivitiesList,userActivity){return _.find(userActivitiesList,{userActivity:userActivity})||{};};self.getActionFromList=function(userActionsList,userAction){return _.find(userActionsList,{userActionCode:userAction})||{};};self.isRegistrationComplete=function(){if(userService.isAnonymous()){return false;}
return(self.isActionCompleteForActivity(constants.REGISTRATION_USER_ACTIVITY,constants.ALERT_TYPE_STATUS.missingAccInfo)&&self.isActionCompleteForActivity(constants.REGISTRATION_USER_ACTIVITY,constants.ALERT_TYPE_STATUS.pendingMemPayment));};self.updateCompleteRegistrationProviderFlag=function(){if(self.isRegistrationComplete()){copartUser.setRegistrationCompleteFlag(true);}else{copartUser.setRegistrationCompleteFlag(false);}};self.isActionCompleteForActivity=function(activity,action){if(!activity&&!action)return false;var retrievedActivity=self.getActivityFromList(self.alerts,activity);if(!_.isEmpty(retrievedActivity)){if(!_.isEmpty(self.getActionFromList(retrievedActivity.accountAlerts,action))){return false;}}
return true;}
self.checkIfGrandFatherBuyer=function(accountInfo){return false;};var closeOpenModals=function(selector){var modalSelector=".modal";var modalBackdropSelector=".modal-backdrop";if(selector){modalSelector=selector+" "+modalSelector;}
if($(modalSelector)&&$(modalSelector).length>0){$(modalSelector).modal('hide');while($(modalBackdropSelector).length>0){$(modalBackdropSelector).remove();}}};self.clearBlockingModalsContent=function(){closeOpenModals(BLOCKING_MODALS_ID);var blockingAlertPlaceholder=$("#allAccountAlerts "+BLOCKING_MODALS_ID);if(blockingAlertPlaceholder&&blockingAlertPlaceholder.length>0){blockingAlertPlaceholder.empty();}};self.openAlertModalsForView=function(pendingUserActions){if(copartUser.getUserConfig()&&copartUser.getUserConfig().displayAlertsModal&&pendingUserActions&&pendingUserActions.length>0){if(pendingUserActions[0]&&pendingUserActions[0].customUserActionCode){var banner=jQuery('#banner-'+pendingUserActions[0].customUserActionCode);if(banner&&banner.length>0){banner.click();}
$('#actionItemModal').modal('show');}
self.updateDisplayAlertsModal(!copartUser.getUserConfig().displayAlertsModal);}};self.filterAlertsPastActivationDate=function(pendingUserActions){return pendingUserActions.filter(function(value){if(value.actionActivationDate&&value.actionActivationDate.date){var actionActivationDate=moment.utc(value.actionActivationDate.date);var today=moment.utc();return actionActivationDate.isBefore(today);}
return true;});}}]);
'use strict';app.service('accountInfoDataService',['$q','startupRestService','$window','userService','copartUtils',function($q,startupRestService,$window,userService,copartUtils){var self=this;var creditCards={};var refundBalance=null;var showHideDepositBalance='UnInitialized';self.accountInfoData={};self.getRefundBalance=function(){return refundBalance;};self.setRefundBalance=function(newValue){refundBalance=newValue;};self.getDepositRefundDetails=function(){var deferred=$q.defer();if(showHideDepositBalance==='UnInitialized'){startupRestService.getCreditCardDetailsForDepositRefund().then(function(response){var successCode=response.data.returnCodeDesc;if(successCode==='Success'){creditCards=response.data.data.depositRefundCardDetails;self.getDepositRefundBalance().then(function(showHideDepositBalance){deferred.resolve(showHideDepositBalance);});}});}else{deferred.resolve(showHideDepositBalance);}
return deferred.promise;};self.getDepositRefundBalance=function(){var deferred=$q.defer();startupRestService.getDepositRefundBalance().then(function(response){var successCode=response.data.returnCodeDesc;if(successCode==='Success'){refundBalance=response.data.data.depositRefundBalance;if(refundBalance&&refundBalance.depositBalance!==undefined&&refundBalance.depositBalance!=null&&refundBalance.depositBalance>0){showHideDepositBalance='show';}else{showHideDepositBalance='hide';}
deferred.resolve(showHideDepositBalance);}});return deferred.promise;};self.getCreditCardDetailsForDepositRefund=function(){var deferred=$q.defer();if(creditCards&&creditCards.length>0){deferred.resolve(creditCards);}else{startupRestService.getCreditCardDetailsForDepositRefund().then(function(response){var successCode=response.data.returnCodeDesc;if(successCode==='Success'){creditCards=response.data.data.depositRefundCardDetails;deferred.resolve(creditCards);}else{deferred.reject();}});}
return deferred.promise;};self.getRefundBalanceAmount=function(){var deferred=$q.defer();if(refundBalance&&refundBalance.depositBalance!==undefined&&refundBalance.depositBalance!=null&&refundBalance.depositBalance>0){deferred.resolve(refundBalance);}else{startupRestService.getDepositRefundBalance().then(function(response){var successCode=response.data.returnCodeDesc;if(successCode==='Success'){refundBalance=response.data.data.depositRefundBalance;deferred.resolve(refundBalance);}else{deferred.reject();}});}
return deferred.promise;};self.getShowHideDepositBalance=function(){return showHideDepositBalance;};self.setShowHideDepositBalanceFlag=function(newVal){showHideDepositBalance=newVal;};self.renewalFees=function(){var requestParam={};requestParam.GATEWAY_URL_KEY="RENEWAL_FEES";requestParam.cancelCallBackUrl="/logout";requestParam.successCallBackURL="dashboard";startupRestService.setPciParam(requestParam,function(response){if(response.returnCode==1){$window.location.href=response.data.pciURL.trim();}else{console.log("Error in Gateway");}});};self.getAccountInfoData=function(){return self.accountInfoData;};self.setAccountInfoData=function(accountInfoData){if(accountInfoData){self.accountInfoData=accountInfoData;}};self.getAccountInformation=function(refresh){var deferred=$q.defer();if(Boolean(refresh)||_.isEmpty(self.accountInfoData)){startupRestService.getAccountInformation(function(response){if(copartUtils.isResponseValid(response)&&response.data.contactInfoList){self.accountInfoData=response.data.contactInfoList;deferred.resolve(self.accountInfoData);}else{console.log("accountInfoService.getContactInfo -> Failed "+response);deferred.reject({});}},function(error){console.log("accountInfoService.getContactInfo -> Failed "+error);deferred.reject({});});}
else{deferred.resolve(self.accountInfoData);}
return deferred.promise;}
self.isWireTransferInitiated=function(){var deferred=$q.defer();if(!_.isEmpty(self.accountInfoData)){deferred.resolve(self.accountInfoData.wireTransferPaymentInitiated);}else{self.getAccountInformation().then(function(response){deferred.resolve(self.accountInfoData.wireTransferPaymentInitiated);},function(error){console.log("Failed to fetch account info");deferred.reject(false);});}
return deferred.promise;}
self.getMembershipExpiresInDays=function(){var deferred=$q.defer();self.getAccountInformation().then(function(){var accountInfoData=self.getAccountInfoData();if(Boolean(accountInfoData.memberSites.membershipValidThroughDate.date)){var expiryDate=accountInfoData.memberSites.membershipValidThroughDate.date;var diffTime=new Date(expiryDate)-new Date();var numOfDays=Math.ceil(diffTime/(1000*60*60*24));deferred.resolve(numOfDays);}else{deferred.reject({});}},function(){deferred.reject({});});return deferred.promise;}}]);

app.service('cmsContentService',['$http','$q','userService','copartUser','$rootScope','urlService',function($http,$q,userService,copartUser,$rootScope,urlService){var log=new Logger({name:'cmsContentService'});var self=this;var cmsContentMap={};var cmsContentPromises={};self.getFragmentContent=function(fragmentUri){if(cmsContentPromises[fragmentUri]){return cmsContentPromises[fragmentUri];}
var deferred=$q.defer();if(_.isUndefined(cmsContentMap[fragmentUri])){cmsContentPromises[fragmentUri]=deferred.promise;var req={method:'GET',url:self.getCmsContentUrl(fragmentUri)};$http(req).then(function(response){var result=cmsContentMap[fragmentUri]=response.data;deferred.resolve(result);delete cmsContentPromises[fragmentUri];},function errorCallback(response){log.error("Error connecting fetching content",response);deferred.reject("");});}else{deferred.resolve(cmsContentMap[fragmentUri]);}
return deferred.promise;};self.setParentFragment=function(parentFragment){if(cmsContentPromises[parentFragment]){return cmsContentPromises[parentFragment];}
var deferred=$q.defer();if(_.isUndefined(cmsContentMap[parentFragment])){cmsContentPromises[parentFragment]=deferred.promise;var req={method:'GET',url:self.getCmsContentUrl(parentFragment)};$http(req).then(function(response){cmsContentMap[parentFragment]=response.data;delete cmsContentPromises[parentFragment];deferred.resolve(true);},function errorCallback(response){deferred.reject(false);});}else{deferred.resolve(true);}
return deferred.promise;};self.getContentUrl=function(fragmentId){var site=userService.userConfig.siteCode;var finalUrl=self.constructUrl(fragmentId);finalUrl=copartUser.getLocationUrlWithLocale(finalUrl);if(site==="DRIVUS"){finalUrl=finalUrl.toLowerCase();}
return finalUrl;};self.getCmsContentUrl=function(fragmentId){var lang=appInit.localeString;return"/CMS/"+lang+self.constructUrl(fragmentId);};self.constructUrl=function(fragmentId){var region=appInit.regionCode;var lang=appInit.localeString;var path=self.getFormattedUrl(fragmentId);var finalUrl="/Content/"+region+"/"+lang+"/"+path;return finalUrl;};self.getFormattedUrl=function(url){if(url.charAt(0)==='.'&&url.charAt(1)==='/'){var splitArray=url.split("/");splitArray.splice(0,1);url=splitArray.join("/");}
var splitArray=url.split("/");if(splitArray[0]===""){splitArray.splice(0,1);url=splitArray.join("/");}
if(splitArray[0].toLowerCase()==="content"){var splitArray1=url.split("/");splitArray1.splice(0,3);url=splitArray1.join("/");}
if(splitArray[0]==="CMS"){var splitArray1=url.split("/");splitArray1.splice(0,4);url=splitArray1.join("/");}
return url;};self.setCanonicalHref=function(url){$rootScope.canonicalHref=url;};self.createCanonicalHref=function(url){var sitDomainUrl=urlService.getSiteUrlFromLocation();return sitDomainUrl+copartUser.getLocationUrlWithLocale(url);}
self.fetchAndAppendFragmentContentToDom=function(fragmentUri,fragmentParentId,fragmentIdList){var deferred=$q.defer();self.getFragmentContent(fragmentUri).then(function(html){var parentFragmentHolder=angular.element(document.querySelector("#"+fragmentParentId));if(parentFragmentHolder&&parentFragmentHolder.length>0){_.forEach(fragmentIdList,function(fragmentId){var fragmentTemplate=(angular.element(html)).filter("#"+fragmentId);if(fragmentTemplate&&fragmentTemplate.length>0){parentFragmentHolder.append(fragmentTemplate.html());}});deferred.resolve(parentFragmentHolder);}
deferred.resolve("");},function(error){console.log("Error fetching fragment");deferred.reject("");});return deferred.promise;}}]);

app.factory('urlStore',[function(){return{redirectUrl:"/dashboard/",dashboard:"/dashboard/",pwdExpired:"/expiredPassword/",forgetPassword:"/expiredPassword/?fp=true",updateBrokerBidderEmail:"/updateBrokerBidderEmail/",login:"/login",lotDetailUrl:"/lotDetail/",noWatchlistLots:"/noResults/watchlist",noLotsFound:"/noResults/lots",home:"/",protectedUrls:['/Content/US/en/Premier-Member-Fees','/memberFees','/member-fees-us-licensed','/member-fees-us-non-licensed']}}]);app.factory('urlService',['$location','$filter','userService','auctionsCalendarService','$q','$sce','$routeParams','$rootScope','copartUser','copartUtils','appConfigService','$window',function($location,$filter,userService,auctionsCalendarService,$q,$sce,$routeParams,$rootScope,copartUser,copartUtils,appConfigService,$window){return{redirectUrl:"/dashboard/",dashboard:"/dashboard/",pwdExpired:"/expiredPassword/",forgetPassword:"/expiredPassword/?fp=true",updateBrokerBidderEmail:"/updateBrokerBidderEmail/",login:"/login",lotDetailUrl:"/lotDetail/",noWatchlistLots:"/public/fetchDirective.html?directive=watchlist/noItemsWatchList",noLotsFound:"/public/fetchDirective.html?directive=vehicleFinder/noSearchFound",home:"/",missingSecurityQuestions:"/collect-security-questions",singleSignOnStart:"/sso/signon/start/",getContentURL:function(context){var url=appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString;if(context){url+="/"+context;}
console.log("URL generated as :"+url);return url;},getURLProtocol:function(){return $location.protocol();},getHeadingForURL:function(url,locale){if(url.indexOf("/watchList")!=-1){return locale.messages['app.label.myWatchList'];}else if(url.indexOf("saleListResult")!=-1){var location=$location.search().displayStr;if(_.isUndefined(location)){location=$location.search().location;}
if(_.isUndefined(location)&&url.indexOf("saleListResult")!=-1)
{location=$filter('filter')(referenceDataLess.yardLocations,{'yardNumber':url.substring(url.lastIndexOf("/")+1,url.length)});if(!_.isUndefined(location)&&location.length>0){location=location[0].yardName;}}
$rootScope.$emit('meta-args-update',{searchText:location});return locale.messages['app.label.saleListFor']+' '+location;}else if(url.indexOf("vehicleFinderSearch")!=-1){var displayStr=$location.search().displayStr;$rootScope.$emit('meta-args-update',{searchText:displayStr});return locale.messages['app.label.searchResultsFor']+' '+displayStr;}else if(url.indexOf("/search/")!=-1||url.indexOf("/quickpick/")!=-1||url.indexOf("vehicle-search")!=-1){var displayStr=$location.search().displayStr;$rootScope.$emit('meta-args-update',{searchText:displayStr});return locale.messages['app.label.searchResultsFor']+' '+displayStr;}else{return locale.messages['app.label.search.results'];}},getSubHeaderForURL:function(url,locale){var deferred=$q.defer();if(url.indexOf("saleListResult")!=-1){var view_location=locale.messages['app.label.viewLocation'];var sale_date_time=locale.messages['app.label.saleDateTime'];var pre_bid_ends=locale.messages['app.label.preBidEnds'];var yardNum=$location.search().yardNum||$routeParams.yard;auctionsCalendarService.auctionByYard(yardNum).then(function(auction){var saleDate=parseInt($location.search().saleDate);var yardNum=$routeParams.yard;if(!_.isUndefined(saleDate)&&!isNaN(saleDate)){if('Future'==saleDate){deferred.resolve(sale_date_time+' '+saleDate+" (<a class='cursor-pointer' data-uname='lotLocation' location-modal yard-number='"+yardNum+"' yard-details='yardDetails' show-inventory=false>"+view_location+"</a>)");}
else{var date=moment(saleDate);var preBidStart=moment(saleDate);var prelimOffset=auction.endOfPreBid,prelimOffsetParts=prelimOffset.split(':'),hourDelta=prelimOffsetParts[0],minuteDelta=prelimOffsetParts[1];preBidStart.subtract({hours:hourDelta,minutes:minuteDelta});var dateTimeFormat=userService.userConfig.dateFormat+" "+userService.userConfig.timeFormat+" zz";var dateStr=date.tz(userService.userConfig.selectedTimezone).format(dateTimeFormat);var preBidStartStr=preBidStart.tz(userService.userConfig.selectedTimezone).format(dateTimeFormat);if(date.isValid()&&preBidStart.isValid()){deferred.resolve(sale_date_time+' '+dateStr+' '+pre_bid_ends+' '+preBidStartStr+" (<a class='cursor-pointer' data-uname='lotLocation' location-modal yard-number='"+yardNum+"' yard-details='yardDetails' show-inventory=false>"+view_location+"</a>)");}else{deferred.resolve();}}}
else
deferred.resolve();});}else{deferred.resolve();}
return deferred.promise;},getNoResultsURL:function(url){if(url.indexOf("/watchList")!=-1){return this.noWatchlistLots;}else{return this.noLotsFound;}},getAllLaneSaleListResultUrl:function(auction){return this.getSaleListResultUrl(auction,false);},getSaleListResultUrl:function(auction,byLane){var liveAuction=auction.liveAuction==true?true:false;var date2;if(auction.hasOwnProperty("auctionDateSolr")){var auctionDate=String(auction.auctionDateSolr.dateAsInt);var date1=moment(new Date(auctionDate.substring(0,4),(parseInt(auctionDate.substring(4,6))-1),auctionDate.substring(6,8)));date2=date1.format("YYYY-MM-DD");}else if(auction.auctionDate!=undefined&&auction.auctionDate.dateAsInt!=undefined){date2=auction.auctionDate?copartUtils.formatCopartDate(auction.auctionDate.dateAsInt.toString()):undefined;}else{date2=auction.auctionDate?copartUtils.formatCopartDate(auction.auctionDate.dateAsString):undefined;}
var baseUrl="/saleListResult/";var uri=null;if(auction.auctionId){uri="auctionId/"+auction.auctionId;}
else{uri=auction.yardNumber+"/"+date2;}
if(byLane&&auction.lane){uri=uri+"/"+auction.lane;}
var auctionHostId;var auctionHostName;if(auction.auctionHostName&&auction.auctionId)
{auctionHostName=auction.auctionHostName;auctionHostId=auction.auctionId;}
else
{auctionHostName=auction.saleName||$filter("saleNameFilter")(auction.yardName,auction.isVirtual);auctionHostId=auction.yardNumber;}
var saleDate=auction.currentSaleTimeEpoch||auction.saleUtcDateTime;return baseUrl+uri+"?location="+auctionHostName+"&saleDate="+saleDate+"&liveAuction="+liveAuction+"&from="+"&yardNum="+auctionHostId;},getLocationUrl:function(yardNumber)
{if(appConfigService&&appConfigService.getAppConfig().yardsMap)
{var yard=appConfigService.getAppConfig().yardsMap[yardNumber];if(yard&&yard.locationUrl)
{return yard.locationUrl;}}
return"/locationDetail/"+yardNumber;},getSiteUrlFromLocation:function(){return $location.$$protocol+'://'+$location.host();},getAuctionURIWithLotNumber:function(auctionHostId,auctionLane,lotId){return"./auctionDashboard?auctionDetails="+auctionHostId+"-"+auctionLane+"-"+lotId;},saveStateToRouteHistory:function(paramMap){$window.history.replaceState(paramMap,'',$window.location.href);},removeStateFromRouteHistory:function(){$window.history.replaceState(null,'',$window.location.href);}};}]);app.service('functionQueueService',['$location',function($location){var self=this;var functionQueue=[];self.addToQueue=function(funcCall){functionQueue.push(funcCall);};self.executeQueue=function(){for(var i=0;i<functionQueue.length;i++){var funcCall=functionQueue[i];funcCall.funcRef(funcCall.paramArr[0]);}
functionQueue=[];};}]);app.factory('History',[function(){return{lastRoute:{},secondLastRoute:{}}}]);app.factory('licenseUploadFactory',[function(){return{params:{"applicationName":"G2MBR","destination":"CAS","fileType":"DOCUMENT","documentType":"BUYER_LICENSE","objectType":"MEMBER"}}}]);app.service('smoothScroll',['deviceService',function(deviceService){var self=this;self.targetElement=function(elemId){if(deviceService.isMobileSizeOrDevice()){jQuery(document).ready(function(){jQuery('html, body').animate({scrollTop:$("#"+elemId).offset().top},300);},false);}};}]);app.service('openAccordionService',[function(){var self=this;self.targetAccordion=function(elem){jQuery("#"+elem).trigger('click');};}]);
;

app.service('scrollService',[function(){var self=this;self.scrollToId=function(targetDiv){jQuery(document).ready(function(){jQuery('html, body').animate({scrollTop:$("#"+targetDiv).offset().top},300);},false);}
self.scrollToClass=function(targetClass){jQuery(document).ready(function(){jQuery('html, body').animate({scrollTop:$("."+targetClass).offset().top},300);},false);}
self.scrollToTop=function(){jQuery(document).ready(function(){jQuery('html,body').animate({scrollTop:0},'slow');},false);}
self.scrollToElement=function(targetElement){if(targetElement&&targetElement.length>0){jQuery(document).ready(function(){jQuery('html, body').animate({scrollTop:targetElement.offset().top},300);},false);}}}]);
'use strict';app.service('loginService',['$http','startupRestService','$rootScope','$location','urlService','$window','functionQueueService','siteCatalyst','localStorageService','appConfigService','copartUser','userService','constants','vcRecaptchaService',function($http,startupRestService,$rootScope,$location,urlService,$window,functionQueueService,siteCatalyst,localStorageService,appConfigService,copartUser,userService,constants,vcRecaptchaService){var self=this;var thisLocale=startupRestService.getLocale();self.appConfig=appConfigService.getAppConfig();var isGlobal=(appInit.appPlatform==='gbl');self.emailRule=copartUser.getUserConfig().emailRule;self.reCaptchaConf={widgetId:null,showLoginRecaptcha:false,publicKey:null};var statusEnum={ERROR:"ERROR",SUCCESS:"SUCCESS",PASSWORD_EXPIRED:"PASSWORD_EXPIRED",FORGET_PASSWORD:"FORGET_PASSWORD",ACCOUNT_VOIDED:"ACCOUNT_VOIDED",ACCOUNT_SUSPENDED:"ACCOUNT_SUSPENDED",UPDATE_BROKER_BIDDER_EMAIL:"UPDATE_BROKER_BIDDER_EMAIL",ACCOUNT_LOCKED:"ACCOUNT_LOCKED",BAD_CREDENTIALS:"BAD_CREDENTIALS",INVALID_RECAPTCHA:"INVALID_RECAPTCHA",TERMS_AND_CONDITIONS_FAILED:"TERMS_AND_CONDITIONS_FAILED",ACCOUNT_LAPSED:"ACCOUNT_LAPSED",MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID:"MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID",BIDDER_ACCOUNT_VACANT_LOGIN_FAILURE:"BIDDER_ACCOUNT_VACANT_LOGIN_FAILURE",CROSS_SITE_LOGIN_NOT_ALLOWED:"CROSS_SITE_LOGIN_NOT_ALLOWED",DEVICE_LOGIN_BLOCKED:"DEVICE_LOGIN_BLOCKED"};var statusErrorMsgEnum={ERROR:"internalServerError",SUCCESS:"success",PASSWORD_EXPIRED:"pwdExpired",FORGET_PASSWORD:"forgetPassword",ACCOUNT_VOIDED:"accntVoided",ACCOUNT_SUSPENDED:"accntSuspended",UPDATE_BROKER_BIDDER_EMAIL:"updateBrokerBidderEmail",ACCOUNT_LOCKED:"accountLocked",BAD_CREDENTIALS:"badCredentials",INVALID_RECAPTCHA:"invalidReCaptcha",TERMS_AND_CONDITIONS_FAILED:"termsAndCondFailed",ACCOUNT_LAPSED:"accntLapsed",MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID:"multipleAccountsWithSameEmailId",BIDDER_ACCOUNT_VACANT_LOGIN_FAILURE:"bidderAccountVacantLoginFailure",CROSS_SITE_LOGIN_NOT_ALLOWED:"crossSiteLoginNotAllowed",DEVICE_LOGIN_BLOCKED:"deviceLoginBlocked"};self.loginAlerts=[];self.accountType="0";self.preLoginFunction=null;var passwordRulePref=copartUser.getUserConfig().displayPref.passwordRule||{};var currentPasswordMinLength=passwordRulePref.currentPasswordMinLength?passwordRulePref.currentPasswordMinLength:constants.PASSWORD_MIN_LENGTH;var maxLength=passwordRulePref.maxLength?passwordRulePref.maxLength:constants.PASSWORD_MAX_LENGTH;self.submitForm=function(action,form,isFirstTime,isKiosk){if(form.accountType!=1){if(validateForm(form)){form.accountTypeValue=form.accountType;if(self.preLoginFunction&&jQuery.isFunction(self.preLoginFunction)){self.preLoginFunction();self.preLoginFunction=null;}
$("#password").attr("disabled","disabled");var loginUrl=action+(userService.userConfig.mobileAppUser?'?MobileAppUser=true':'');startupRestService.performLogin(loginUrl,form,function(data){self.resetLoginErrors();$("#password").removeAttr("disabled");if(data.data.result=="updateBrokerBidderEmail"){resetFailedLoginAttempts();$window.location.href=urlService.updateBrokerBidderEmail;}
else if(data.data.result=="success"){resetFailedLoginAttempts();var buyerNumberTrack=data.data.buyerNumber||"";var emailTrack=data.data.email||"";var crmIdTrack=data.data.crmid||"";functionQueueService.executeQueue();doTagGTMLoginSuccess(emailTrack,crmIdTrack,buyerNumberTrack);var username=form.rememberme?form.username:'';localStorageService.cookie.set('username',username,365);if(isKiosk||(data.data.isKioskBidder)){$window.location.href='/kiosklotSearchResults';}else{$window.location.href=_.isEmpty($rootScope.storeUserURl)?urlService.redirectUrl:$rootScope.storeUserURl;}}
else
{incrementFailedLoginAttempts();switch(data.data.error)
{case statusEnum.PASSWORD_EXPIRED:if(isGlobal){var pwdExipredMsg=thisLocale.messages['app.login.label.passwordExpired']}
else{var pwdExipredMsg=thisLocale.messages['app.login.label.passwordExpired1']+"<a href='#forgotuserid' data-toggle='modal' data-uname='loginRestPassword' ng-click='openForgotPassword();'>"+
thisLocale.messages['app.label.dashboard.pwdexpire3']+"</a> "+thisLocale.messages['app.login.label.passwordExpired2'];}
addLoginAlerts("danger",pwdExipredMsg,isFirstTime,statusErrorMsgEnum.PASSWORD_EXPIRED);break;case statusEnum.FORGET_PASSWORD:$window.location.href=urlService.forgetPassword;break;case statusEnum.ACCOUNT_SUSPENDED:addLoginAlerts("danger",thisLocale.messages['app.errorMessage.suspended.buyer'],isFirstTime,statusErrorMsgEnum.ACCOUNT_SUSPENDED);break;case statusEnum.ACCOUNT_LAPSED:addLoginAlerts("danger",thisLocale.messages['app.errorMessage.lapsed.buyer'],isFirstTime,statusErrorMsgEnum.ACCOUNT_LAPSED);break;case statusEnum.ERROR:addLoginAlerts("danger",thisLocale.messages['app.login.label.internalServerError'],isFirstTime,statusErrorMsgEnum.ERROR);break;case statusEnum.ACCOUNT_LOCKED:var lockMsg=thisLocale.messages['app.login.label.accountLocked']+"<a ng-click='openForgotPassword();'>"+thisLocale.messages['app.label.dashboard.pwdexpire3']+"</a> "+thisLocale.messages['app.login.label.accountLocked2'];addLoginAlerts("danger",lockMsg,isFirstTime,statusErrorMsgEnum.ACCOUNT_LOCKED);break;case statusEnum.MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID:addLoginAlerts("danger",thisLocale.messages['app.error.label.MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID'],isFirstTime,statusErrorMsgEnum.MULTIPLE_ACCOUNTS_WITH_SAME_EMAIL_ID);break;case statusEnum.BIDDER_ACCOUNT_VACANT_LOGIN_FAILURE:addLoginAlerts("danger",thisLocale.messages['app.login.label.bidderAccountVacantLogin'],isFirstTime,statusErrorMsgEnum.BIDDER_ACCOUNT_VACANT_LOGIN_FAILURE);break;case statusEnum.CROSS_SITE_LOGIN_NOT_ALLOWED:addLoginAlerts("danger",thisLocale.messages['app.login.label.CROSS_SITE_LOGIN_NOT_ALLOWED'],isFirstTime,statusErrorMsgEnum.CROSS_SITE_LOGIN_NOT_ALLOWED);break;case statusEnum.BAD_CREDENTIALS:addLoginAlerts("danger",thisLocale.messages['app.login.label.badCredentials'],isFirstTime,statusErrorMsgEnum.BAD_CREDENTIALS);break;case statusEnum.INVALID_RECAPTCHA:addLoginAlerts("danger",thisLocale.messages['app.login.label.invalidReCaptcha'],isFirstTime,statusErrorMsgEnum.INVALID_RECAPTCHA);break;case statusEnum.DEVICE_LOGIN_BLOCKED:addLoginAlerts("danger",thisLocale.messages['app.login.label.deviceLoginBlocked'],isFirstTime,statusErrorMsgEnum.DEVICE_LOGIN_BLOCKED);break;}}},function(data){incrementFailedLoginAttempts();self.resetLoginErrors();if(data!=undefined&&data!=null){var dbMessage=data.message;if(dbMessage!=undefined&&dbMessage!=null){if(dbMessage.indexOf("BadCredentialsException">-1)){var userMessage=dbMessage.substring(dbMessage.indexOf(':'),dbMessage.length);addLoginAlerts("danger","Unable to continue."+userMessage,isFirstTime);}}}else{addLoginAlerts("danger",thisLocale.messages['app.login.label.badCredentials'],isFirstTime);}});return true;}
else{incrementFailedLoginAttempts();if(isFirstTime){$window.location.href="/tempPasswordExpired";}
return false;}}};var incrementFailedLoginAttempts=function(){var failedLoginAttempts=localStorageService.get("failedLoginAttempts")||0;localStorageService.set("failedLoginAttempts",failedLoginAttempts+1);self.resetLoginReCaptcha();self.handleLoginReCaptchaDisplay();};var resetFailedLoginAttempts=function(){localStorageService.set("failedLoginAttempts",0);self.resetLoginReCaptcha();self.reCaptchaConf.showLoginRecaptcha=false;};self.resetLoginReCaptcha=function(){if(self.reCaptchaConf.widgetId!=null){vcRecaptchaService.reload(self.reCaptchaConf.widgetId);}};self.handleLoginReCaptchaDisplay=function(){var failedLoginAttempts=localStorageService.get("failedLoginAttempts")||0;var envConfigs=appConfigService.getEnvConfigProps();var showLoginRecaptcha=false;if(envConfigs&&envConfigs.failureAttemptsToShowCaptcha&&envConfigs.failureAttemptsToShowCaptcha>0){if(!!self.reCaptchaConf.publicKey&&failedLoginAttempts>=envConfigs.failureAttemptsToShowCaptcha){showLoginRecaptcha=true;}}
self.reCaptchaConf.showLoginRecaptcha=showLoginRecaptcha;};var validateForm=function(form){var username=form.username;var password=form.password;self.resetLoginErrors();if(form.userUId){return true;}
if(/\s/.test(username)){addLoginAlerts("danger","Spaces are not allowed in User ID");return false;}
if(isDecimalIfNumber(username)){addLoginAlerts("danger","Decimals are not allowed in User ID");return false;}
if(!username||0===username.length){addLoginAlerts("danger",thisLocale.messages['app.login.label.emailOrUserId']);return false;}
if(!password||0===password.length){addLoginAlerts("danger","Password is required");return false}
if(!username&&!password){addLoginAlerts("danger",thisLocale.messages['app.login.label.badCredentials']);return false}
if(!username||username.length>self.emailRule.maxLength){addLoginAlerts("danger",thisLocale.messages['app.login.label.badCredentials']);return false}
if(isNaN(username)){if(!validateEmail(username)){addLoginAlerts("danger",thisLocale.messages['app.login.label.badCredentials']);return false;}}
if(password.length<currentPasswordMinLength||password.length>maxLength){addLoginAlerts("danger",thisLocale.getMessageStr('app.error.invalid.password.length',[currentPasswordMinLength,maxLength]));return false}
if(self.reCaptchaConf.showLoginRecaptcha&&!form.reCaptchaResponse){addLoginAlerts("danger",thisLocale.messages['app.login.label.invalidReCaptcha']);return false;}
else{return true;}};function isDecimalIfNumber(username){if(username&&!isNaN(username)){var onlyDigitsPattern=/^-?[0-9]+$/;if(!onlyDigitsPattern.test(username)){return true;}}
return false;}
self.resetPwdForm={};self.emailPassword=function(isIDProvided){if(!isIDProvided){self.resetPwdForm.showEmailRequiredError=true;}else if(!isNaN(self.resetPwdForm.userIDOrEmail)||validateEmail(self.resetPwdForm.userIDOrEmail)){if(!isNaN(self.resetPwdForm.userIDOrEmail)){if(self.resetPwdForm.userIDOrEmail.length>6){self.resetPwdForm.showEmailRequiredError=true;return;}}
self.emailPasswordService(self.resetPwdForm.userIDOrEmail);}else{self.resetPwdForm.showEmailRequiredError=true;}};self.emailPasswordService=function(userIDOrEmail){startupRestService.emailPassword(userIDOrEmail,function(response){if(response.returnCode==1){$('#forgotuserid').modal('hide');$('#Successforgotuserid').modal('show');}else if(response.returnCodeDesc=='InvalidUserID'){self.resetPwdForm.showEmailRequiredError=true;}else if(response.returnCodeDesc=='UnknownError'){$('#forgotuserid').modal('hide');$('#forgotuseridFailed').modal('show');}else{$('#forgotuserid').modal('hide');$('#forgotuseridFailed').modal('show');}});}
self.getEmailID=function(){return this.emailId;};self.getSavedSecurityQuestions=function(email){if(!email){self.resetPwdForm.showEmailRequiredError=true;return;}else if(!isNaN(email)||validateEmail(email)){self.emailId=email;if(!isNaN(email)){if(email.length>6){self.resetPwdForm.showEmailRequiredError=true;return;}}
self.userQuestion=[];startupRestService.getSavedSecurityQuestions(email,{onSuccess:function(response){if(response.returnCode==1){if(response.data.questions&&response.data.questions.length>0){self.questions=self.appConfig.getSecurityQuestions();_.each(response.data.questions,function(selectedQuestion){_.each(self.questions,function(availableQuestion){if(availableQuestion.questionId==selectedQuestion.questionId){self.userQuestion.push(availableQuestion);}});});$('#askSecurityQuestions').modal('show');$('#forgotuserid').modal('hide');$('#loginRegister').modal('hide');}else{$('#NoSecurityQuestions').modal('show');$('#forgotuserid').modal('hide');$('#loginRegister').modal('hide');}}else{$('#forgotuseridFailed').modal('show');$('#forgotuserid').modal('hide');$('#loginRegister').modal('hide');}},onFailure:function(response){}});}else{self.resetPwdForm.showEmailRequiredError=true;}
return self.userQuestion;};function validateEmail(email){var emailReg=isGlobal?/^([\w-\.]+@([\w-]+\.)+[\w-]{2,})?$/:/^([\w-\.]+@([\w-]+\.)+[\w-]{2,})?$/;if(!emailReg.test(email)){return false;}else{return true;}}
var addLoginAlerts=function(type,msg,isFirstTime,errorCode){if(isFirstTime){$window.location.href="/login-error?errorCode="+errorCode;}
else{self.loginAlerts.push({msg:msg,type:type});}};self.resetLoginErrors=function(){self.loginAlerts.splice(0,self.loginAlerts.length);};self.closeLoginAlert=function(index){self.loginAlerts.splice(index,1);};}]);
'use strict';app.service('logService',['startupRestService','LOG_CONSTANTS','$q',function(startupRestService,LOG_CONSTANTS,$q){var self=this;self.logToServer=function(event,message,payload,status){var deferred=$q.defer();status=status||LOG_CONSTANTS.UNKNOWN_STATUS;var data=getLoggingRequestPayload(event,message,payload,status);log(data).then(function(response){deferred.resolve(response);},function(error){deferred.reject(error);});return deferred.promise;};var log=function(data){var deferred=$q.defer();if(!_.isEmpty(data)){startupRestService.logToServer(data,function(response){deferred.resolve(response);},function(error){deferred.reject(error);});}else{console.log("Invalid payload for logging");deferred.reject({});}
return deferred.promise;};var getLoggingRequestPayload=function(event,message,payload,status){return new LoggingVO({"event":event,"message":message,"payload":payload,"status":status});}}]);

app.service('modalService',['$timeout','$rootScope',function($timeout,$rootScope){var self=this;self.message="";self.modalType="";self.showModal=false;self.openModal=function(modalType,message){self.message=message;self.modalType=modalType;self.showModal=true;$rootScope.$broadcast('event:showDynamicModal',{'message':self.message,'modalType':self.modalType});};self.closeModal=function(){self.message="";self.modalType="";self.showModal=false;$rootScope.$broadcast('event:closeDynamicModal',{});};self.toggleModal=function(showModal){self.showModal=showModal;};}]);
'use strict';app.service('vehicleSearchService',['$http','$q','$httpParamSerializerJQLike','startupRestService','copartUtils','$route','$rootScope','copartUser','userService','$location','$filter',function($http,$q,$httpParamSerializerJQLike,startupRestService,copartUtils,$route,$rootScope,copartUser,userService,$location,$filter){var self=this;var HOME="HOME";var VEHICLE_FINDER="VEHICLE_FINDER";var vehicleFinderPreference=userService.userConfig.vehicleFinderPreference||{};var quickPickConfig=[{pageName:"VEHICLE_FINDER",pageCategories:[{category:'all',quickPickCode:'VEHF',solrPage:'VEHICLE_FINDER'},{category:"used",quickPickCode:"VHFU",solrPage:'VEHICLE_FINDER_USED'},{category:"salvage",quickPickCode:"VHFS",solrPage:'VEHICLE_FINDER_SALVAGE'}]},{pageName:"HOME",pageCategories:[{category:"all",quickPickCode:"HOME",solrPage:'HOME'},{category:"used",quickPickCode:"HOME",solrPage:'HOME'},{category:"salvage",quickPickCode:"HOME",solrPage:'HOME'}]}];self.getQuickPickMetaDataByCategory=function(pageName,category){category=category?category.toLowerCase():'all';var metaDataByPage=_.find(quickPickConfig,{pageName:pageName});if(!_.isEmpty(metaDataByPage&&metaDataByPage.pageCategories)){return _.find(metaDataByPage.pageCategories,{category:category})||{};}
return{};};self.getAdditionalFiltersByCategory=function(category){if(category){category=category.toLowerCase();var solrFiltersBYCategory=_.clone(vehicleFinderPreference.solrFiltersByCategory&&vehicleFinderPreference.solrFiltersByCategory[category]);if(!_.isEmpty(solrFiltersBYCategory)){return solrFiltersBYCategory.join(' OR ');}}
return"";};self.getSearchCriteriaParams=function(quickPicks){var routeValue=self.getRouteValue();var miscFilter=[];if(!_.isEmpty(routeValue)&&!_.isEmpty(quickPicks.quickPicksByUri[routeValue])){if("MAKE"===quickPicks.categoryNameByUri[routeValue]){miscFilter.push(quickPicks.quickPicksByUri[routeValue].split(":")[0]+":\""+copartUtils.removeDoubleQuotes(quickPicks.quickPicksByUri[routeValue].split(":")[1])+"\"");}else{miscFilter.push(quickPicks.quickPicksByUri[routeValue]);}}
var initialParamDisplay=quickPicks.displayNameByUri[routeValue];var displayStr=self.getAdditionalSearchParams(miscFilter,initialParamDisplay);return{miscFilter:miscFilter,displayStr:displayStr,includeTagByField:quickPicks.includeTagByField[routeValue],categoryNameByUri:quickPicks.categoryNameByUri[routeValue],displayNameByUri:quickPicks.displayNameByUri[routeValue]};};self.getSearchCriteriaParamsFromCallbackForMake=function(){var routeValue=self.getRouteValue();var make=routeValue.toUpperCase();var miscFilter=[];var displayStr="";var callBack=$route.current.$$route.callBackForSearchCriteria;if(callBack){miscFilter.push("#MakeCode:\""+make+"\" OR #MakeDesc:\""+make+"\"");displayStr=self.getAdditionalSearchParams(miscFilter,routeValue);}
return{miscFilter:miscFilter,displayStr:displayStr};};self.getAdditionalSearchParams=function(miscFilter,initialParamDisplay){var modelName=$route.current.pathParams.model;var yearValue=$route.current.pathParams.year;var category=$route.current.pathParams.category;var additionalFiltersByCategory=self.getAdditionalFiltersByCategory(category);if(!_.isEmpty(additionalFiltersByCategory)){miscFilter.push(additionalFiltersByCategory);}
var modelNameDisplay="";var yearValueDisplay="";if(!!modelName){modelNameDisplay=modelName.toTitleCase().replace(/[\/-]/g," ");modelNameDisplay=" "+modelNameDisplay;}
if(!!yearValue){miscFilter.push("#LotYear:["+yearValue+" TO "+yearValue+"]");yearValueDisplay=yearValue+" ";}
$rootScope.$emit('meta-args-update',{year:yearValueDisplay.trim(),make:initialParamDisplay.trim(),model:modelNameDisplay.trim()});return yearValueDisplay+initialParamDisplay+modelNameDisplay;};self.routeValuePresentInQuickPick=function(quickPicks,routeValue,deferred){if(quickPicks&&!_.isEmpty(quickPicks)&&quickPicks.quickPicksByUri[routeValue]){deferred.resolve(quickPicks);return true;}
return false;};self.getRouteValue=function(){var routeParamName=copartUtils.getRouteParamToFilterQuickpicks($route);return $route.current.pathParams[routeParamName];};self.fetchVehicleSearchQuickPicks=function(){var deferred=$q.defer();var routeValue=self.getRouteValue();var lookupPages=getLookupPages();startupRestService.getQuickPicks(lookupPages.parentPage,function(quickPicks){if(!self.routeValuePresentInQuickPick(quickPicks,routeValue,deferred)){startupRestService.getQuickPicks(lookupPages.backupPage,function(quickPicks){if(!self.routeValuePresentInQuickPick(quickPicks,routeValue,deferred)){deferred.reject();}},function(){deferred.reject();});}},function(){deferred.reject();});return deferred.promise;};var getLookupPages=function(){try{var category=$route.current.pathParams.category;var parentPage=$location.search().from||"HOME";if(!!parentPage&&parentPage.indexOf("vehicleFinder")>-1){parentPage=VEHICLE_FINDER;}else{parentPage=HOME;}
var backupPage=VEHICLE_FINDER;if(parentPage==VEHICLE_FINDER){backupPage=HOME;}
parentPage=self.getQuickPickMetaDataByCategory(parentPage,category).solrPage;backupPage=self.getQuickPickMetaDataByCategory(backupPage,category).solrPage;return{parentPage:parentPage,backupPage:backupPage};}catch(e){return{parentPage:HOME,backupPage:VEHICLE_FINDER};}};self.getVehicleSearchSEOData=function(miscFilter){var deferred=$q.defer();var seoPageName=$route.current.$$route.seoPageName;if(seoPageName==='vehicle-search-model'&&_.isArray(miscFilter)&&miscFilter.length>0){$http({method:'post',url:"/public/vehicleFinder/search",data:$httpParamSerializerJQLike({filter:{"MISC":miscFilter[0]},query:"*"}),headers:{'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'}}).then(function(response){var seoData={};if(response&&response.data&&response.data.data&&response.data.data.results&&Array.isArray(response.data.data.results.facetFields)){var modelData=_.filter(response.data.data.results.facetFields,function(facetField){return facetField.quickPickCode==='MODL';});if(Array.isArray(modelData)&&modelData.length===1){seoData={'MODL':modelData[0].facetCounts};miscFilter.push('#LotModel:"'+$route.current.pathParams.model+'"');}}
deferred.resolve(seoData);},function(){deferred.reject();});}else{deferred.resolve({});}
return deferred.promise;};var getModelGroup=function(facetCounts){var modelName=$route.current.pathParams.model;var modelGroupName=null;angular.forEach(facetCounts,function(facet){if(facet.query&&facet.query.includes(':')){var query=facet.query.split(':')[1];var value=query.split('\"').join('');var key=$filter('escape')(value.trim().toLowerCase());if(angular.equals(key,modelName)){modelGroupName=value;}}});return modelGroupName!=null?modelGroupName:modelName;};self.setSearchCriteriaObj=function(searchCriteria,params){var deferred=$q.defer();searchCriteria.setMiscFilter(params.miscFilter);searchCriteria.setDisplayStr(params.displayStr);searchCriteria.setIncludeTagByField(params.includeTagByField);searchCriteria.setCategoryNameByUri(params.categoryNameByUri);searchCriteria.setDisplayNameByUri(params.displayNameByUri);var headerText=self.buildHeaderText(params);searchCriteria.setHeaderText(headerText);self.getVehicleSearchSEOData(params.miscFilter).then(function(data){searchCriteria.setSEOData(data);deferred.resolve();},function(){deferred.reject();});return deferred.promise;};self.buildSearchCriteria=function(searchCriteria){var deferred=$q.defer();self.fetchVehicleSearchQuickPicks().then(function(quickPicks){var params=self.getSearchCriteriaParams(quickPicks);self.setSearchCriteria(searchCriteria,params,deferred)},function(){var callBackForSearchCriteria=$route.current.$$route.callBackForSearchCriteria;if(!_.isUndefined(callBackForSearchCriteria)){var callBackFunction=self[callBackForSearchCriteria];if(!_.isUndefined(callBackFunction)&&_.isFunction(callBackFunction)){var params=callBackFunction.call();self.setSearchCriteria(searchCriteria,params,deferred);}else{deferred.reject();}}else{deferred.reject();}});return deferred.promise;};self.setSearchCriteria=function(searchCriteria,params,deferred){self.setSearchCriteriaObj(searchCriteria,params).then(function(){deferred.resolve();},function(){deferred.reject();});};self.buildHeaderText=function(params){try{var locale=startupRestService.getLocale();var seoPageNameLabel=$route.current.seoPageName.replace(/[-]/g,".");var key="app.label."+seoPageNameLabel+".header";var headerText=locale.getMessageStr(key,[params.displayStr]);var showVariableHeaderText=copartUser.hasAccessSitePref("seo.variableHeaderText",true);if(showVariableHeaderText&&headerText){return headerText;}}catch(e){return null;}
return null;};self.updateVehicleSearchRouteParams=function(){var pathParams=$route.current.pathParams;$route.current.$$route.titleKey=$route.current.$$route.originalParams.titleKey;$route.current.$$route.descKey=$route.current.$$route.originalParams.descKey;$route.current.$$route.seoPageName=$route.current.$$route.originalParams.seoPageName;if(pathParams&&pathParams.category&&!_.isEmpty(pathParams.category)){var category=pathParams.category;$route.current.$$route.titleKey+="."+category;$route.current.$$route.descKey+="."+category;$route.current.$$route.seoPageName+="-"+category;}};self.setDefaultSearchCriteria=function(searchCriteria){var displayStr="";_.each($route.current.pathParams,function(value,key){displayStr+=value+" ";});searchCriteria.setDisplayStr(displayStr.trim());};self.redirectToVehicleFinderSearch=function(searchCriteria,queryString){var vehicleFinderSearch={MISC:searchCriteria.getMiscFilter(),sortByZip:searchCriteria.getSortByZip(),buyerEnteredZip:searchCriteria.getBuyerEnteredZip(),milesAway:searchCriteria.getMilesAway()};var searchStr=encodeURIComponent(JSON.stringify(vehicleFinderSearch));$location.url("/vehicleFinderSearch?searchStr="+searchStr+" &displayStr="+queryString);}}]);

angular.module('g2app').factory('watchListCache',['$cacheFactory',function($cacheFactory){return $cacheFactory('watchlist-cache');}]);angular.module('g2app').service('watchListService',['userService','appConfigService','$http','watchListRestService','functionQueueService','siteCatalyst',function(userService,appConfigService,$http,watchListRestService,functionQueueService,siteCatalyst){var self=this;var watchList=[];var isWatchList=false;var log=new Logger({name:'watchListService'});self.addToWatchListForCompare=function(lotNumber){var item={};item.lotId=lotNumber;watchList.push(item);doTagGTMSearchClassicViewAddWatchList(lotNumber);}
self.removeFromWatchListForCompare=function(lotNumber){var index=_.findIndex(watchList,function(lot){return lot.lotId==lotNumber});if(index!=-1){watchList.splice(index,1);}
doTagGTMSearchClassicViewRemoveWatchList(lotNumber);}
self.setWatchListDefinition=function(url){if(url.indexOf("/watchList")!=-1){isWatchList=true;}else{isWatchList=false;}
if(!userService.isAnonymous()){self.getWatchListForBuyer();}};self.isWatchList=function(){return isWatchList;};var refreshWatchListData=function(callBack){watchListRestService.getWatchListForBuyer(function(response){if(_.isUndefined(watchList)){watchList=response.data.data.watchList;}
else{watchList=_.union(watchList,response.data.data.watchList);}
if(callBack){callBack(response);}});};var forceRefreshWatchListData=function(){watchListRestService.getWatchListForBuyer(function(response){watchList=response.data.data.watchList;});};self.getWatchListForBuyer=function(){if(_.isUndefined(watchList)||watchList.length==0){watchListRestService.getWatchListForBuyer(function(response){if(_.isUndefined(watchList)){watchList=response.data.data.watchList;}
else{watchList=_.union(watchList,response.data.data.watchList);}});}};self.isAlreadyAdded=function(lotNumber){var object=_.find(watchList,function(item){return item.lotId==lotNumber;});if(object){return true;}else{return false;}};self.addToWatchList=function(lotNumber,callBack,lotDetailPage){if(!userService.isAnonymous()){watchListRestService.addToWatchList(lotNumber,function(response){if(response.data.returnCode==1){var item={};item.lotId=lotNumber;watchList.push(item);if(callBack){callBack(response);}
if(lotDetailPage){doTagGTMLotDetailsAddWatchList(lotNumber)}else{doTagGTMSearchClassicViewAddWatchList(lotNumber);}}else{if(response.data.data&&response.data.data.code&&response.data.data.message){alert(response.data.data.message);log.error("Failed to add lot in watch list--"+response.data.data.code);}}});}else{localStorage.setItem('addtoWatchlistLotId',JSON.stringify({lotId:lotNumber,timestamp:new Date().getTime()+(180000)}));}};self.addtoWatchlistAssumingLoggedInUser=function(lotNumber){watchListRestService.addToWatchList(lotNumber,function(response){if(response.data.returnCode==1){var item={};item.lotId=lotNumber;watchList.push(item);}else{log.error("Failed to add lot in watch list");}});};self.removeFromWatchList=function(lotNumber,callBack,lotDetailPage){if(!userService.isAnonymous()){watchListRestService.removeFromWatchList(lotNumber,function(response){if(response.data.returnCode==1){var index=_.findIndex(watchList,function(lot){return lot.lotId==lotNumber});if(index!=-1){watchList.splice(index,1);}
if(callBack){callBack(response);}
if(lotDetailPage){doTagGTMLotDetailsRemoveWatchList(lotNumber)}else{doTagGTMSearchClassicViewRemoveWatchList(lotNumber);}}else{log.error("Failed to removed lot from watch list")}});}};self.addAllCheckedToWatchList=function(selectedLots,callBack,errorCallBack){watchListRestService.addAllCheckedToWatchlist(_.pluck(selectedLots,"lotId"),function(response){if(response.data.returnCode!=-1){watchList=_.union(watchList,selectedLots);if(callBack){callBack(response);}}else{errorCallBack(response);}})};self.addAllToWatchList=function(data,callBack,errorCallBack,syncCallBack){watchListRestService.addAllToWatchlist(data,function(response){if(response.data.returnCode!=-1){refreshWatchListData(syncCallBack);if(callBack){callBack(response);}}else{errorCallBack(response);}})};self.removeAllFromWatchlist=function(data,callBack){watchListRestService.removeAllFromWatchlist(data,function(response){if(response.data.returnCode!=-1){forceRefreshWatchListData();}
if(callBack){callBack(response);}})};self.removeCheckedFromWatchlist=function(selectedLots,callBack){watchListRestService.removeCheckedFromWatchlist(_.pluck(selectedLots,"lotId"),function(response){if(response.data.returnCode!=-1){watchList=_.filter(watchList,function(item){return _.isUndefined(_.findWhere(selectedLots,{lotId:item.lotId.toString()}));});if(callBack){callBack(response);}}});for(var i in selectedLots){if(!AppUtils.isUndefined(selectedLots)&&!AppUtils.isUndefined(selectedLots[i].lotId)){doTagGTMSearchClassicViewRemoveWatchList(selectedLots[i].lotId);}}};window.getWatchListLots=function(){return watchList;}}]);
'use strict'
app.service('singleSignOnService',['copartUser','urlService','copartUtils',function(copartUser,urlService,copartUtils){var log=new Logger({name:'singleSignOnService'});var self=this;self.isEligibleForSingleSignOn=function(brand){return copartUser.hasAccessPrivilege('SINGLE_SIGN_ON')&&brand=='DRIVE';};self.getSingleSignOnUrl=function(url,brand){var queryParamObj={redirectUrl:encodeURIComponent(copartUser.getLocationUrlWithLocale(url))};var baseUrl=urlService.singleSignOnStart+brand.toLowerCase();return copartUtils.appendQueryStringToURL(baseUrl,queryParamObj);}}]);

app.directive('searchplaceholder',[function(){return{restrict:'A',link:function(scope,element,attrs){$('.my_textarea').each(function(){$(this).data('placeholder',$(this).attr('placeholder')).blur(function(){changePlaceholder();});});function changePlaceholder(){if($(window).width()<1200){var text=scope.$parent.locale.messages['app.label.searchPlaceHolder'];$('.my_textarea').attr('placeholder',text);}else{$('.my_textarea').each(function(){$(this).attr('placeholder',attrs.placeText);});}}
$(window).resize(changePlaceholder).trigger('resize');}}}]);app.directive('placeHolderText',[function(){return{restrict:'A',link:function(scope,element,attrs){element.attr('placeholder',attrs.placeText);element.on('blur',function(){element.attr('placeholder',attrs.placeText);});element.on('focus',function(){element.attr('placeholder','');});}}}]);app.directive('siteCatalyst',['userService','$q','siteCatalyst',function(userService,$q,siteCatalyst){return{restrict:'A',transclude:false,link:function(scope,elem,attrs){elem.bind('click',function(){var val=scope.$eval('('+attrs.siteCatalyst+')');var memNumber=userService.userConfig.buyerNumber;var crmId=userService.userConfig.crmId;var selectedLanguage=userService.userConfig.selectedLang;if(attrs.selectedLang)
{appInit.localeString=attrs.selectedLang;}
var defer=!AppUtils.isUndefined(attrs.waitForSuccess);if(val['lotId']!=undefined&&val['lotId'].includes("#")){if(attrs.catalystModal){val['lotId']=scope[attrs.catalystModal][val['lotId'].substr(1)];}
else{val['lotId']=scope[val['lotId'].substr(1)];}}
if(val['linkName']!=undefined&&val['linkName'].includes("#")){val['linkName']=scope[attrs.catalystModal][val['linkName'].substr(1)];}
if(val['download']!=undefined&&val['lotId']!=undefined&&val['download'].includes("#")){val['download']=scope[attrs.catalystModal][val['download'].substr(1)];}
if(val['addremove']!=undefined&&val['addremove'].includes("#")){val['addremove']=scope[attrs.catalystModal][val['addremove'].substr(1)];}
if(val['channel']!=undefined&&val['channel'].includes("#")){val['channel']=scope[attrs.catalystModal][val['channel'].substr(1)];}
if(val['pagename']!=undefined&&val['pagename'].includes("#")){val['pagename']=scope[attrs.catalystModal][val['pagename'].substr(1)];}
if(val['server']!=undefined&&val['server'].includes("#")){val['server']=scope[attrs.catalystModal][val['server'].substr(1)];}
if(val['ipaddress']!=undefined&&val['ipaddress'].includes("#")){val['ipaddress']=scope[attrs.catalystModal][val['ipaddress'].substr(1)];}
if(val['country']!=undefined&&val['country'].includes("#")){val['country']=scope[attrs.catalystModal][val['country'].substr(1)];}
if(val['state']!=undefined&&val['state'].includes("#")){val['state']=scope[attrs.catalystModal][val['state'].substr(1)];}
if(val['city']!=undefined&&val['city'].includes("#")){val['city']=scope[attrs.catalystModal][val['city'].substr(1)];}
if(val['zipcode']!=undefined&&val['zipcode'].includes("#")){val['zipcode']=scope[attrs.catalystModal][val['zipcode'].substr(1)];}
if(val['yardname']!=undefined&&val['yardname'].includes("#")){val['yardname']=scope[attrs.catalystModal][val['yardname'].substr(1)];}
if(val['type']!=undefined&&val['type'].includes("#")){val['type']=scope[attrs.catalystModal][val['type'].substr(1)];}
if(val['doctitle']!=undefined&&val['doctitle'].includes("#")){val['doctitle']=scope[attrs.catalystModal][val['doctitle'].substr(1)];}
if(val['widgetName']!=undefined&&val['widgetName'].includes("#")){val['widgetName']=scope[attrs.catalystModal][val['widgetName'].substr(1)];}
if(val['videoUrl']!=undefined&&val['videoUrl'].includes("#")){val['videoUrl']=scope[attrs.catalystModal][val['videoUrl'].substr(1)];}
if(val['imageNumber']!=undefined&&val['imageNumber'].includes("#")){val['imageNumber']=scope[attrs.catalystModal][val['imageNumber'].substr(1)];}
if(val['tag']!=undefined&&val['tag'].includes("#")){val['tag']=scope[attrs.catalystModal][val['tag'].substr(1)];}
if(defer)
{siteCatalyst.addToQueue(val['fname'],val);}
else
{copartOmnitureCall(val['fname'],val['lotId'],memNumber,val['linkName'],val['download'],val['addremove'],val['channel'],val['pagename'],val['server'],val['ipaddress'],val['country'],val['state'],val['city'],val['zipcode'],val['yardname'],val['type'],val['doctitle'],val['widgetName'],memNumber,selectedLanguage,memNumber,val['videoUrl'],val['imageNumber'],val['tag'],crmId);}});}}}]);app.directive('checkForLoggedInUser',['userService','loginService','$location','$rootScope','localStorageService',function(userService,loginService,$location,$rootScope,localStorageService){var url=$location.path();return{restrict:'AE',transclude:false,link:function(scope,elem,attrs){elem.bind('click',function(e){$rootScope.storeUserURl=$location.url();if(userService.isAnonymous()){e.preventDefault();e.stopPropagation();$(".dropdown").removeClass('open');$('#loginRegister').modal('show');if(attrs.stateRestore=="true"){loginService.preLoginFunction=function(){localStorageService.set("restore-search-state",true);localStorageService.set("restore-search-state-from-anywhere",true);}}
scope.$apply(function(){loginService.resetLoginErrors();loginService.resetPwdForm.showEmailRequiredError=false;});}});}}}]);app.directive('menuclick',[function(){return{restrict:'A',transclude:false,link:function(scope,elem,attrs){$('.navbar ul.nav .dropdown').hover(function(){$(this).find('>.dropdown-menu').stop(true,true).delay(200).fadeIn();},function(){$(this).find('>.dropdown-menu').stop(true,true).delay(200).fadeOut();});$('.navbar .dropdown-menu').hover(function(){$(this).stop(true,true);},function(){$(this).stop(true,true);});$(".navbar .dropdown-menu>li>a").on('click',function(event){$(this).closest('.mainmenudiv').removeClass("in");$('a.active').removeClass('active');$(this).addClass('active');});$('.navbar .dropdown-menu>li.dropdown-submenu>ul>li>a').on('click',function(event){$(this).closest('.dropdown-menu').parent().closest('.dropdown-menu').stop(true,true).delay(100).fadeOut();});}}}]);app.directive('signinmenu',[function(){return{restrict:'A',transclude:false,link:function(scope,elem,attrs){$('.search-filters .dropdown-menu').mouseleave(function(){$(this).parent('li').removeClass("open");$(this).parent('li').find('a').attr("aria-expanded","false");});}}}]);app.directive('backToTop',[function(){return{restrict:'A',link:function(scope,$elm,attrs){$elm.on('click',function(){jQuery("body").animate({scrollTop:0},"slow");});}}}]);app.directive('scrollToDiv',["scrollService",'$location',function(scrollService,$location){return{restrict:'A',link:function(scope,element,attrs){var targetDiv=attrs.targetdiv;element.on('click',function(){scrollService.scrollToId(targetDiv);});}}}]);app.directive('dynamicBackToTop',["$window","scrollService",function($window,scrollService){return{restrict:'A',link:function(scope,element){var isObserverAPINotSupported=function(){return(!('IntersectionObserver'in window)||!('IntersectionObserverEntry'in window)||!('isIntersecting'in window.IntersectionObserverEntry.prototype));};if(!isObserverAPINotSupported()){new IntersectionObserver(function(entries){entries.forEach(function(entry){element[0].style.display=entry.intersectionRatio==0?'block':'none';});},{threshold:[0,1]}).observe(element.parent()[0]);}
scope.scrollToTop=function(){scrollService.scrollToTop();}}};}]);app.directive('timeModal',[function(){return{restrict:'AE',link:function(scope,element,attrs){},controller:'timeModalController'}}]);app.directive('errorImage',[function(){return{restrict:'A',replace:true,scope:false,link:function postLink(scope,iElement,iAttrs){var errorFunc=function(){angular.element(this).attr("src",iAttrs.errorImage?iAttrs.errorImage:'images/testImages/no_photo.jpg');scope.defaultBanner=true;};if(appInit.isUserAgentBOT){errorFunc=function(){};}
iElement.bind('error',errorFunc);},template:''}}]);app.directive('checkAccessByPrivilege',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.checkAccessByPrivilege;var returnBool=conditionsStr.indexOf("!")>-1?copartUser.hasAccessPrivilege(conditionsStr.split("!")[1]):!copartUser.hasAccessPrivilege(conditionsStr);if(returnBool)
{element.addClass('hide');}
else
{if(attrs.hasOwnProperty('altUrl'))
{attrs.$set('href',attrs.altUrl);}
if(attrs.hasOwnProperty('addClass'))
{element.addClass(attrs.addClass);}}}};}]);app.directive('checkAccessByRole',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.checkAccessByRole;if((conditionsStr.indexOf(' and ')>0)||(conditionsStr.indexOf(' or ')>0))
{var roles=conditionsStr.indexOf(' and ')>0?conditionsStr.split(' and '):conditionsStr.split(' or ');var operators={and:function(values){var returnBool=false;for(var i in values)
{returnBool=returnBool&&(values[i].indexOf("!")>-1?copartUser.hasRoleAccess(values[i].split("!")[1]):!copartUser.hasRoleAccess(values[i]));}
return returnBool;},or:function(values){var returnBool=false;for(var i in values)
{returnBool=returnBool||(values[i].indexOf("!")>-1?copartUser.hasRoleAccess(values[i].split("!")[1]):!copartUser.hasRoleAccess(values[i]));}
return returnBool;}};var operator=conditionsStr.indexOf('and')>-1?operators.and:operators.or;if(operator(roles))
{element.addClass('hide');}}
else
{var returnBool=conditionsStr.indexOf("!")>-1?copartUser.hasRoleAccess(conditionsStr.split("!")[1]):!copartUser.hasRoleAccess(conditionsStr);if(returnBool){if(attrs.hasOwnProperty('altUrl')){attrs.$set('href',attrs.altUrl);}
else if(attrs.hasOwnProperty('addClass')){element.addClass(attrs.addClass);if(attrs.addClass=="disabled"){attrs.$set("disabled","disabled");}}
else{element.addClass('hide');}}}}};}]);app.directive('bindHtmlCompile',['$compile',function($compile){return{restrict:'A',link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.bindHtmlCompile);},function(value){element.html(value);$compile(element.contents())(scope);});}};}]);app.directive('tooltip',[function(){return{restrict:'A',link:function(scope,element,attrs){var params={};params.placement='auto right';params.live=true;params.trigger='manual';if(attrs.popoverid){params.html=true;params.content=function(){return $('#'+attrs.popoverid).html();}}
if(attrs.popup=="popupParam"){params.placement='auto left';var isMobile=window.matchMedia("only screen and (max-width: 760px)");if(isMobile.matches){if(attrs.popoverid){params.placement='auto top';}}}
jQuery(element).popover(params);var action=attrs.action||'click';element.bind(action,function(){jQuery(element).popover('show');}).on('mouseleave',function(e){jQuery(element).popover("hide");});}};}]);app.directive('navcollapse',[function(){return{restrict:'A',link:function(scope,element,attrs){$('.navbar-collapse .menu_click').click(function(){$(".navbar-collapse").collapse('hide');});}}}]);app.directive('clicksigninmenu',[function(){return{restrict:'A',transclude:false,link:function(scope,elem,attrs){$('.header').on('show.bs.collapse',function(){var actives=$(this).find('.collapse.in'),hasData;if(actives&&actives.length){hasData=actives.data('collapse');if(hasData&&hasData.transitioning)return;actives.collapse('hide');hasData||actives.data('collapse',null)}});}}}]);app.directive('nameAbbr',[function(){return{restrict:'AE',transclude:false,link:function(scope,elem,attrs){var Shortname=$('#outputname').text();var initials=Shortname.match(/\b\w/g)||[];initials=((initials.shift()||'')+(initials.pop()||'')).toUpperCase();$("#outputname").text(initials);}}}]);app.directive('elipses',[function(){return{restrict:'AE',transclude:false,link:function(scope,elem,attrs){var name=attrs.value||elem.text();elem.attr("title",name);var maxlength=parseInt(attrs.elipses);if(name.length>maxlength){elem.text(name.substring(0,maxlength)+"...");}}}}]);app.directive('checkAccessBySitePref',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||'';var accessValue=attrs.accessValue||'';var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(!returnBool)
{element.addClass('hide');}}};}]);app.directive('hideCookieBanner',['localStorageService','$cookies','userService','userLocationService','$rootScope','$window','$interval',function(localStorageService,$cookies,userService,userLocationService,$rootScope,$window,$interval){return{restrict:'A',link:function(scope,element,attrs){var hideBanner=function(){element.hide();};var showBanner=function(){element.show();};hideBanner();scope.showCookiePolicy=function(cookiePolicyCountries){if(userService.userConfig.siteRegionCode=='us'){userLocationService.getUserLocationInfo().then(function(locationDetails){var locationInfo=locationDetails||{};var country=locationInfo.countryCode||'';if(!localStorageService.cookie.get('acceptCookiePolicy')&&_.contains(cookiePolicyCountries,country)){showBanner();}},function(){hideBanner();});}else if(!localStorageService.cookie.get('acceptCookiePolicy')){showBanner();}}
element.on('click','#acceptCookieBanner',function(){localStorageService.cookie.set("acceptCookiePolicy",true);hideBanner();});$rootScope.$on("envConfigPropertiesData",function(event){event.preventDefault();var intervalForCookiePolicy=$interval(function(){if($window.userInteractionCaptured){$interval.cancel(intervalForCookiePolicy);scope.showCookiePolicy(scope.$parent.cookiePolicyCountries);}},100);});}};}]);app.directive('contentNgHref',['cmsContentService',function(cmsContentService){return{restrict:'A',transclude:false,link:function(scope,element,attr){var path=attr.contentNgHref;jQuery(element).removeAttr('content-ng-href');var finalUrl=path;try
{finalUrl=cmsContentService.getContentUrl(path);}
catch(e)
{}
jQuery(element).attr("href",finalUrl);}}}]);app.directive('reviveBannerTagging',[function(){return{restrict:'A',transclude:false,link:function(scope,elem,attrs){elem.bind('click',function(e){scope.doTagHomePageBannerZoneId(attrs.zoneid);});}}}]);app.directive('printpage',['siteCatalyst','$q',function(siteCatalyst,$q){return{restrict:'AE',replace:true,link:function(scope,element,attrs){function sleep(time){var deferred=$q.defer();setTimeout(function(){deferred.resolve();},time);return deferred.promise;}
element.bind('click',function(e){$(this).parents().find(".table").removeClass("dropping_table");$("body").trigger("beforeprint");sleep(2000).then(function(){window.print();$(this).parents().find(".table").addClass("dropping_table");});return false;});},template:'<li>'+'<a href="#" class="ng-binding"><i class="fa fa-print"></i>{{locale.messages["app.label.print"]}}</a></li>'}}]);app.directive('livechat',['copartUser','cmsContentService',function(copartUser,cmsContentService){var blockLiveChat=copartUser.getUserConfig().blockLiveChat;if(blockLiveChat){return;}else{return{restrict:'EA',link:{post:function(scope,elem,attrs){if(copartUser.getUserConfig().siteRegionCode=="uk"){jQuery('#lhnHocButton').show();jQuery('#lhnHocInvite').show();jQuery('#lhnHelpOutCenter').show();}}},templateUrl:function(){return cmsContentService.getCmsContentUrl('/content/us/en/live-help-chat');}};}}]);app.directive('jivoChat',['copartUser',function(copartUser){var allowJivoChat=copartUser.getUserConfig().allowJivoChat;if(allowJivoChat){return{restrict:'EA',link:{post:function(scope,elem,attrs){angular.element(document.querySelector('script[plugin="jivoChat"]')).remove();var jivoChatScript='<script src="//code.jivosite.com/widget/z76883uYlJ" async plugin="jivoChat"></script>';jQuery('head').append(jivoChatScript);}}};}else{return;}}]);app.directive("showHidePassword",[function(){return{restrict:"EA",link:function(scope,elem,attrs){var self=scope;self.showPassword=false;elem.bind('click',function(e){self.showPassword=!self.showPassword;self.$apply();});}}}]);app.directive('exportCsv',['startupRestService','$q','$interpolate','userService',function(startupRestService,$q,$interpolate,userService){return{restrict:'EA',scope:{csvUrl:'@',csvCriteria:'@',csvHeader:'=',exportFileName:'@',csvClass:'@',exportLabel:'@'},template:function(element,scope){if(userService.isAnonymous()){return'<a check-for-logged-in-user class="{{csvClass}}" data-uname="lotsearchExport" id="exportButton"><i class="fa fa-cloud-download"></i>{{exportLabel}}</a>';}
return'<a class="{{csvClass}}" data-uname="lotsearchExport" id="exportButton" ng-csv="getCSVResult()" filename="{{exportFileName}}" csv-header="csvHeader" add-bom="true"><i class="fa fa-cloud-download"></i>{{exportLabel}}</a>';},link:function(scope,element,attrs){var locale=scope.$parent.locale;scope.exportLabel=scope.exportLabel||(locale?locale.messages['app.label.export']:'Export');var convertToJson=function(response){var jsonArray=[];$(response).find('tr').each(function(){var row=[];$(this).find('td').each(function(){row.push(_.unescape($(this).html().trim()));});jsonArray.push(row);});return jsonArray;}
var url=scope.csvUrl;var csvCriteria=scope.csvCriteria;if(!url){console.log("Service url cannot be empty");return;}
scope.getCSVResult=function(){var deferred=$q.defer();var csvResult=[];var successCallBack=function(response){var csvResult=convertToJson($interpolate(response.data)(scope.$parent));deferred.resolve(csvResult);}
var failureCallBack=function(){deferred.resolve(csvResult);}
startupRestService.downloadCSV(url,successCallBack,failureCallBack);return deferred.promise;}}}}]);app.directive('preventRightClick',[function(){return{restrict:'A',link:function($scope,$elem){$elem.bind("contextmenu",function(e){e.preventDefault();});}};}]);app.directive('backButton',['$window',function($window){return{restrict:'A',link:function(scope,elem,attrs){elem.bind('click',function(){$window.history.back();});}};}]);angular.module('g2app').directive('numbersOnly',[function(){return{require:'ngModel',link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){var transformedInput;transformedInput=inputValue.replace(/[^0-9,]/g,'');if(transformedInput!=inputValue){modelCtrl.$setViewValue(transformedInput);modelCtrl.$render();}
return transformedInput;});}};}]);angular.module('g2app').directive('onFinishRender',['$timeout',function($timeout){return{restrict:'A',link:function(scope,element,attr){var event=attr.onFinishRender;if(!event){event='ngRepeatFinished';}
if(scope.$last===true){$timeout(function(){scope.$emit(event);});}}};}]);app.directive('emailpage',['copartUser','$location','siteCatalyst','$window',function(copartUser,$location,siteCatalyst,$window){return{restrict:'AE',replace:true,link:function(scope,element,attrs){element.bind('click',function(e){$window.location.href=getEmailContent(copartUser,$location,siteCatalyst,attrs);return false;});},template:'<li id="email">'+'<a href="#" class="emailpage">'+'<i class="fa fa-envelope"></i>'+'<span class="ng-binding">{{locale.messages["app.label.email"]}}</span>'+'</a>'+'</li>'};}]);app.directive('dropdowncontent',[function(){return{restrict:'A',link:function(scope,element,attrs){var params={};jQuery('.dropdown-menu').click(function(e){e.stopPropagation();});}};}]);app.directive('intBuyerPopUp',['$window','$location','userService','userLocationService','localStorageService','cmsContentService',function($window,$location,userService,userLocationService,localStorageService,cmsContentService){return{restrict:'AE',controller:["$scope","$location",function($scope,$location){var self=$scope;self.checkCountries={};self.checkCountries.redirectToCountry=function(){if(!self.isIntBuyer){return;}
self.closeIntPopUpModal();window.location.href=self.detectedCountryObj.countryUrl;};self.closeIntPopUpModal=function(){self.isIntBuyer=false;localStorageService.cookie.set("isIntPopUpClosed",true);};self.goToIntResource=function(lang,url){self.closeIntPopUpModal();$location.url(url);};}],link:function(scope){var self=scope;var url="content/us/en/checkcountries";if(!localStorageService.cookie.get("isIntPopUpClosed")){cmsContentService.getFragmentContent(url).then(function(listOfCountries){self.listOfCountries=jQuery(listOfCountries);self.countryMap=new Map();angular.forEach(self.listOfCountries,function(countryElement){self.countryMap.set(countryElement.countryCode,{countryName:countryElement.countryName,url:countryElement.countryUrl});});userLocationService.getUserLocationInfo().then(function(locationDetails){self.international_buyer_country=locationDetails.countryCode;if(self.countryMap.has(self.international_buyer_country)){self.isIntBuyer=true;self.detectedCountryObj={countryCode:self.international_buyer_country,countryName:self.countryMap.get(self.international_buyer_country).countryName,countryUrl:self.countryMap.get(self.international_buyer_country).url};}else{self.isIntBuyer=false;}
var countryCodeBySiteCode=userService.userConfig.countryCode;self.isIntBuyer=self.isIntBuyer&&(self.international_buyer_country!=countryCodeBySiteCode);});},function(){self.listOfCountries=[];});}else{self.isIntBuyer=false;}},templateUrl:'/public/fetchDirective.html?directive=home/locationPopupInternationalBuyers'};}]);app.directive('a',function(){return{restrict:'E',link:function(scope,elem,attrs){if(attrs.href&&attrs.href.indexOf('#')===0){elem.on('click',function(e){e.preventDefault();});}}};});

app.directive('allowAccessByPrivilege',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.allowAccessByPrivilege;var returnBool=!copartUser.hasAccessPrivilege(conditionsStr);if(returnBool){element.addClass('hide');}else{if(attrs.hasOwnProperty('altUrl')){attrs.$set('href',attrs.altUrl);}
if(attrs.hasOwnProperty('addClass')){element.addClass(attrs.addClass);}}}};}]);app.directive('blockAccessByPrivilege',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.blockAccessByPrivilege;var returnBool=copartUser.hasAccessPrivilege(conditionsStr);if(returnBool){element.addClass('hide');}else{if(attrs.hasOwnProperty('altUrl')){attrs.$set('href',attrs.altUrl);}
if(attrs.hasOwnProperty('addClass')){element.addClass(attrs.addClass);}}}};}]);app.directive('allowAccessByRole',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.allowAccessByRole;if((conditionsStr.indexOf(' and ')>0)||(conditionsStr.indexOf(' or ')>0)){var roles=conditionsStr.indexOf(' and ')>0?conditionsStr.split(' and '):conditionsStr.split(' or ');var operators={and:function(values){var returnBool=false;for(var i in values){returnBool=returnBool&&(!copartUser.hasRoleAccess(values[i]));}
return returnBool;},or:function(values){var returnBool=false;for(var i in values){returnBool=returnBool||(!copartUser.hasRoleAccess(values[i]));}
return returnBool;}};var operator=conditionsStr.indexOf('and')>-1?operators.and:operators.or;if(operator(roles)){element.addClass('hide');}}
else{var returnBool=!copartUser.hasRoleAccess(conditionsStr);if(returnBool){if(attrs.hasOwnProperty('altUrl')){attrs.$set('href',attrs.altUrl);}else if(attrs.hasOwnProperty('addClass')){element.addClass(attrs.addClass);}else{element.addClass('hide');}}}}};}]);app.directive('blockAccessByRole',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var conditionsStr=attrs.blockAccessByRole;if((conditionsStr.indexOf(' and ')>0)||(conditionsStr.indexOf(' or ')>0)){var roles=conditionsStr.indexOf(' and ')>0?conditionsStr.split(' and '):conditionsStr.split(' or ');var operators={and:function(values){var returnBool=false;for(var i in values){returnBool=returnBool&&(copartUser.hasRoleAccess(values[i]));}
return returnBool;},or:function(values){var returnBool=false;for(var i in values){returnBool=returnBool||(copartUser.hasRoleAccess(values[i]));}
return returnBool;}};var operator=conditionsStr.indexOf('and')>-1?operators.and:operators.or;if(operator(roles)){element.addClass('hide');}}
else{var returnBool=copartUser.hasRoleAccess(conditionsStr);if(returnBool){if(attrs.hasOwnProperty('altUrl')){attrs.$set('href',attrs.altUrl);}else if(attrs.hasOwnProperty('addClass')){element.addClass(attrs.addClass);}else{element.addClass('hide');}}}}};}]);app.directive('allowAccessByPreference',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||'';var accessValue=attrs.accessValue||'';var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(!returnBool){element.addClass('hide');}}};}]);app.directive('blockAccessByPreference',['copartUser',function(copartUser){return{restrict:'AE',link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||'';var accessValue=attrs.accessValue||'';var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(returnBool){element.addClass('hide');}}};}]);

app.directive('cmsContentFragment',['$sce','$rootScope','$timeout','cmsContentService',function($sce,$rootScope,$timeout,cmsContentService){return{transclude:true,restrict:'AE',scope:true,link:function(scope,element,attrs){cmsContentService.getFragmentContent(attrs.parentId).then(function(data){scope.fragmentedCms=jQuery(data).filter("#"+attrs.fragmentId);if(scope.fragmentedCms&&scope.fragmentedCms.length>0){if(attrs.removeInlineStyle||attrs.removeInlineStyle===''){jQuery(scope.fragmentedCms).find('[style]').removeAttr('style');}
scope.fragmentedCms=jQuery(scope.fragmentedCms).html();if(scope.fragmentedCms&&scope.fragmentedCms.indexOf("]]&gt;")>-1){scope.fragmentedCms=scope.fragmentedCms.replace(new RegExp(']]&gt;','g'),'');}
scope.fragmentedCms=$sce.trustAsHtml(scope.fragmentedCms);if(attrs.compileCmsContent||attrs.compileCmsContent===''){scope.compileFragment=true;}else{scope.bindFragment=true;}}else{scope.fetchFailed=true;}},function(){scope.fetchFailed=true;});},template:'<ng-transclude ng-if="fetchFailed"></ng-transclude><div ng-if="bindFragment" ng-bind-html="fragmentedCms"></div><div ng-if="compileFragment" compile-trusted-html="fragmentedCms"></div>'}}]);app.directive('compileTrustedHtml',['$compile','$parse',function($compile,$parse){return{restrict:'A',link:function(scope,element,attrs){var parsedContent=$parse(attrs.compileTrustedHtml)(scope);element.html(parsedContent.toString());$compile(element.contents())(scope);}}}]);app.directive('cmsContent',['cmsContentService',function(cmsContentService){return{restrict:'AE',templateUrl:function(element,attrs){return cmsContentService.getCmsContentUrl(attrs.fragment);},link:function($scope,elem,attrs){elem.ready(function(){$(elem).find('a').each(function(){var href=$(this).attr('href');if(href){var redirectHref=href.replace('~','');var hrefLowerCase=redirectHref.toLowerCase();$(this).attr('href',redirectHref);}});if($(elem).html()&&$(elem).html().indexOf("]]&gt;")>-1){var modifiedHtml=$(elem).html().replace("]]&gt;","");$(elem).html(modifiedHtml);}})}};}]);app.directive('lotHighlightsToolTip',['cmsContentService','$q','$http','deviceService',function(cmsContentService,$q,$http,deviceService){return{restrict:'AE',scope:{popoverid:'@'},link:function(scope,element,attrs){var parentFragmentId="Content/"+appInit.regionCode+"/"+appInit.localeString+"/_LotIcons/Lot-Icon-List.html";var action=attrs.action||'click';var isMobileDevice=deviceService.isMobileDevice();if(isMobileDevice){jQuery("body").addClass("cursor-pointer");}
element.popover({html:true,placement:'auto right',live:true,trigger:'manual',content:'<div><img src="./images/icons/loader.gif"></div>'});element.bind(action,function(){var e=angular.element(this);e.off('hover');angular.element(element).popover('toggle');cmsContentService.getFragmentContent(parentFragmentId).then(function(fragmentCMSContent){fragmentCMSContent=jQuery(fragmentCMSContent).filter("#"+attrs.fragmentId);var popover=angular.element(element).data('bs.popover');popover.tip().find(".popover-content").html(fragmentCMSContent);})}).on('mouseleave',function(e){var e=angular.element(this);e.popover("hide");});}}}]);app.directive('reviveFragmentedContent',['$sce','cmsContentService','userService','$location','copartUser',function($sce,cmsContentService,userService,$location,copartUser){return{transclude:true,restrict:'AE',scope:true,link:function(scope,element,attrs,parentCtrl){var reviveUrl="";var setReviveParams=function(){var isAnonymous=userService.isAnonymous();var membershipType=copartUser.getUserConfig().membershipType||"membershipType";var licenceCategory=copartUser.getUserConfig().licenceCategory||"";var pageUrl=$location.path();reviveUrl="&ismember=true&isloggedin="+!isAnonymous+"&membertype="+membershipType+"&sitelang=en&pageurl="+pageUrl+"&intcmp=&cid=&eid=&memberlicensecategory="+licenceCategory;if(attrs.reviveappendurl){reviveUrl=reviveUrl+attrs.reviveappendurl;}};cmsContentService.getFragmentContent(attrs.parentId).then(function(data){setReviveParams();scope.fragmentedCms=jQuery(data).filter("#"+attrs.fragmentId);scope.fragmentedCms=jQuery(scope.fragmentedCms).html();if(scope.fragmentedCms&&scope.fragmentedCms.indexOf("?WCOPARAMS")>-1){scope.fragmentedCms=scope.fragmentedCms.replace("?WCOPARAMS",reviveUrl);}
scope.fragmentedCms=$sce.trustAsHtml(scope.fragmentedCms);if(scope.fragmentedCms){scope.loaded=true;}else{scope.loaded=false;}});},template:'<ng-transclude ng-if="!loaded"></ng-transclude><div ng-bind-html="fragmentedCms"></div>'}}]);

app.directive('carouselControls',['startupRestService','localStorageService','copartUser','$timeout',function(startupRestService,localStorageService,copartUser,$timeout){return{require:'^uibCarousel',link:function(scope,element,attrs,carouselCtrl){var self=scope;var no_photo_url='/images/testImages/lot_NoPhoto.png';scope.actionToExecute=null;scope.goPrevSlide=function(lot_Number){scope.actionToExecute="prev";getLotImages(lot_Number);};scope.changeImage=function(){if(scope.actionToExecute=="prev"){carouselCtrl.prev();}
if(scope.actionToExecute=="next"){carouselCtrl.next();}
scope.actionToExecute=null;};scope.$on('ngRepeatFinished',function(){scope.changeImage();});var siteCatalystEvent=attrs.siteCatalystEvent?attrs.siteCatalystEvent:null;scope.goNextSlide=function(lot_Number){scope.actionToExecute="next";getLotImages(lot_Number);};scope.viewVehicle=function(recommendedLot,currentPageNumber,clickedLotIndex){localStorageService.set("from-rec-engine",true);doTagGTMLotDetailsrRecEngine(recommendedLot.lotNumber,self.$parent.displaySaleDate,self.$parent.bidEligibilityFlag);var recLotEngine={};var pageNumber=currentPageNumber>4?Math.ceil(currentPageNumber/4):currentPageNumber;recLotEngine.parentLotNumber=recommendedLot.parentLotNumber;recLotEngine.recEngineLotNumber=recommendedLot.lotNumber;recLotEngine.clickedLotIndex=pageNumber>1?currentPageNumber+clickedLotIndex:clickedLotIndex+1;recLotEngine.memNumber=copartUser.getUserConfig().buyerNumber;if(siteCatalystEvent){copartOmnitureCallOne(siteCatalystEvent,recLotEngine);}};var serviceInvoked;var getLotImages=function(lot_Number){if(!serviceInvoked){serviceInvoked=true;startupRestService.getLotImages(lot_Number,function(response){if(response&&response.returnCode!=-1){var imagesList=response.data.data.imagesList||{};scope.fullSizeImages=imagesList.FULL_IMAGE;scope.recommendedLot.images=[];_.each(scope.fullSizeImages,function(image,index,list){scope.recommendedLot.images.push(list[index].url);});if(!imagesList.FULL_IMAGE){scope.recommendedLot.images.push(no_photo_url);}}});}else{scope.changeImage();}};}};}]);

app.directive('accountAlerts',['copartUser','startupRestService','$sce','$templateRequest','$compile','constants','accountAlertsService','$timeout','$window','$location','cmsContentService','appConfigService','$rootScope','openAccordionService','accountInfoDataService','$q','localStorageService','copartUtils',function(copartUser,startupRestService,$sce,$templateRequest,$compile,constants,accountAlertsService,$timeout,$window,$location,cmsContentService,appConfigService,$rootScope,openAccordionService,accountInfoDataService,$q,localStorageService,copartUtils){return{restrict:'E',replace:true,transclude:true,scope:{},controller:['$scope','$route',function($scope,$route){var self=$scope;self.locale=startupRestService.getLocale();self.alertsData=[];self.alertsContent="";self.banners={};self.modals={};self.pendingUserActions=[];self.currentBannersCount=0;self.currentModalsCount=0;self.enableBanners=true;self.enableModals=true;self.membershipExpiresInDays=constants.MEMBERSHIP_EXPIRES_IN_DAYS_DEFAULT;self.accountAlertsContentUrl="content/us/en/account-alerts.html";self.enableAlerts=false;self.hideAccntAlerts=Boolean($route.current.$$route.hideAccntAlerts);self.paymentAmount=0;self.paymentMode="";self.currencyCode="";self.discountCodeEndDateAsInt="";self.earlyBirdDiscountExpiresInDays="";$scope.$watch(function(){return accountAlertsService.getAlerts();},function(newAlerts){if(!_.isEmpty(newAlerts)&&!_.isEqual(self.alertsData,newAlerts)){self.alertsData=newAlerts;self.enableAlerts=true;self.currentBannersCount=0;self.currentModalsCount=0;self.pendingUserActions=accountAlertsService.filterAlertsForUserViewFromUserActivities(newAlerts);self.pendingUserActions=accountAlertsService.filterAlertsPastActivationDate(self.pendingUserActions);accountInfoDataService.getMembershipExpiresInDays().then(function(expiryDays){if(expiryDays){self.membershipExpiresInDays=expiryDays;}
self.showAlerts();},function(error){self.showAlerts();});}});}],link:{pre:function(){},post:function($scope,element,attrs){var self=$scope;var BLOCKING_MODALS_ID="#blockingModals";self.remindLater=function(userActionCode){if(userActionCode){accountAlertsService.removeAlert(userActionCode,constants.ALERTS_REMIND_LATER_STATUS).then(function(){self.updateAlertCount();},function(error){console.log("Remind later failed for",userActionCode);});}};self.updateAlertCount=function(){self.currentModalsCount-=1;if(self.currentModalsCount===0){$('body').removeClass('modal-open');$("#actionItemModal").removeClass('in');$('.modal-backdrop').remove();self.enableAlerts=false;}};self.removeBannerAndModal=function(userActionCode){accountAlertsService.removeAlertBannerAndModalFromView(userActionCode);self.updateAlertCount();};self.gotoAction=function($event,userActionCode,href){self.updateConfigForViewedAlert(userActionCode);$('#actionItemModal').modal("hide");$location.url(href);};self.gotoAccordion=function($event,userActionCode,href,id){$location.url(href);setTimeout(function(){openAccordionService.targetAccordion(id);},1000);};var handleBlockingAlerts=function(){try{if(!_.isEmpty(self.blockingModalUserActions)){var userAction=_.first(self.blockingModalUserActions);var blockingModalId="blocking_modal-"+userAction.userActionCode;var blockingModalFragmentId="fragment_"+blockingModalId;self.loadAlertsContent(blockingModalFragmentId).then(function(response){var blockingAlertPlaceholder=element.find(BLOCKING_MODALS_ID);var compiledResponse=$compile(response)(self);blockingAlertPlaceholder.append(compiledResponse);if(!self.hideAccntAlerts){$("#"+blockingModalId).modal('show');}},function(error){self.blockingModalUserActions.shift();handleBlockingAlerts();});}}catch(e){log.error("Error handling blocking alerts",e)}}
self.renderAccountAlerts=function(){if(!_.isEmpty(self.pendingUserActions)){if(self.pendingUserActions&&self.pendingUserActions.length>0){$timeout(function(){initializeCarousel();enableBannersAndModals();activateAlertsInCarousel();addClickEvents();if(_.isEmpty(self.blockingModalUserActions)){self.openAlertModalOnConfigReload();}
enableModalEvents();$('#notification-modal-carousel').bind('slid.bs.carousel',function(e){var currentActiveModal=jQuery('#alertsContent .active');if(currentActiveModal&&currentActiveModal.length>0&&currentActiveModal.attr('id').replace('modal-','')){var userActionCode=currentActiveModal.attr('id').replace('modal-','');var banner=jQuery('#carousel-banner #banner-'+userActionCode);if(banner&&banner.length>0){jQuery('#carousel-banner').children().removeClass('active');banner.addClass('active');}}});});}}};self.loadAlertsContent=function(fragmentId){var deferred=$q.defer();cmsContentService.getFragmentContent(self.accountAlertsContentUrl).then(function(data){if(data){var fragmentedContent=data;if(fragmentId){fragmentedContent=jQuery(data).filter("#"+fragmentId);}
if(fragmentedContent&&fragmentedContent.length>0){deferred.resolve(fragmentedContent);}else{deferred.reject("");}}else{deferred.reject("");}},function(error){deferred.reject("");});return deferred.promise;}
self.showAlerts=function(){accountAlertsService.clearBlockingModalsContent();self.blockingModalUserActions=accountAlertsService.filterBlockingModalUserActions(self.pendingUserActions);if(!_.isEmpty(self.blockingModalUserActions)){handleBlockingAlerts();}
createAlertsViewPerSessionBasedOnConfig();self.compileCmsContent();};self.compileCmsContent=function(){self.loadAlertsContent().then(function(html){var alertsModalHolder=angular.element(document.querySelector("#alertsContent"));var alertsBannerHolder=angular.element(document.querySelector("#carousel-banner"));if(Boolean(alertsModalHolder&&alertsModalHolder.length>0||alertsBannerHolder&&alertsBannerHolder.length>0)){alertsModalHolder.empty();alertsBannerHolder.empty();self.pendingUserActions.forEach(function(alert,index){if(!!alert&&!!alert.actionDetailsMap){populateAlertActionDetails(alert.actionDetailsMap);}
var bannersForActionCode=$(html).find("#banner-"+alert.customUserActionCode);var alertBannerForUserActionCode=bannersForActionCode&&bannersForActionCode.last();if(alertBannerForUserActionCode&&alertBannerForUserActionCode.length>0){createBannerForAlert(alert,index);alertsBannerHolder.append(alertBannerForUserActionCode);}
var modalsForActionCode=$(html).find("#modal-"+alert.customUserActionCode);var alertModalForUserActionCode=modalsForActionCode&&modalsForActionCode.last();if(alertModalForUserActionCode&&alertModalForUserActionCode.length>0){createModalForAlert(alert,index);alertsModalHolder.append(alertModalForUserActionCode);}});computeDataForBanners();toggleBanners();toggleModals();compileAlerts(alertsBannerHolder,alertsModalHolder);self.renderAccountAlerts();}},function(error){});};var populateAlertActionDetails=function(alertActionDetails){Object.keys(self).concat(Object.keys(alertActionDetails)).sort().reduce(function(r,a,i,aa){if(i&&aa[i-1]===a){self[a]=alertActionDetails[a];}});}
var createBannerForAlert=function(alert,index){if(self.banners){self.banners[alert.customUserActionCode]={};self.banners[alert.customUserActionCode].value=true;self.banners[alert.customUserActionCode].index=index;self.currentBannersCount+=1;}};var createModalForAlert=function(alert,index){if(self.modals){self.modals[alert.customUserActionCode]={};self.modals[alert.customUserActionCode].value=true;self.modals[alert.customUserActionCode].index=index;self.currentModalsCount+=1;}};var toggleBanners=function(){if(self.currentBannersCount===0){self.enableBanners=false;}};var computeDataForBanners=function(){self.earlyBirdDiscountExpiresInDays=copartUtils.getDifferenceInDatesFromToday(self.discountCodeEndDateAsInt)}
var toggleModals=function(){if(self.currentModalsCount===0){self.enableModals=false;}};var compileAlerts=function(alertsBannerHolder,alertsModalHolder){if(self.enableBanners){$compile(alertsBannerHolder)(self);}
if(self.enableModals){$compile(alertsModalHolder)(self);}};var initializeCarousel=function(){jQuery("#notification-carousel").carousel({interval:getAlertsSlideInterval()||(constants.ACCNT_ALERTS_BANNER_DFLT_SLIDE_INTVL),pause:'hover'});};var enableBannersAndModals=function(){for(var banner in self.banners){self.banners[banner].value=true;}
for(var modal in self.modals){self.modals[modal].value=true;}};var activateAlertsInCarousel=function(){jQuery('#carousel-banner').children().removeClass('active');jQuery('#carousel-banner .item').first().addClass('active');jQuery('#alertsContent .item').first().addClass('active');};var addClickEvents=function(){self.pendingUserActions.forEach(function(alert,index){var banner=jQuery('#banner-'+alert.customUserActionCode);var modal=jQuery('#alertsContent #modal-'+alert.customUserActionCode);if(banner.length>0&&modal.length>0){banner&&banner.click(function(e){jQuery('#alertsContent').children().removeClass('active');modal&&modal.addClass('active');});modal&&modal.click(function(e){jQuery('#carousel-banner').children().removeClass('active');banner.addClass('active');});}});};var getAlertsSlideInterval=function(){return(getNestedProperty('envConfigProps.accountAlertsSlideInterval',appConfigService))||constants.ACCNT_ALERTS_BANNER_DFLT_SLIDE_INTVL;};self.openAlertModalOnConfigReload=function(){accountAlertsService.openAlertModalsForView(self.pendingUserActions);};var enableModalEvents=function(){var carouselModal=jQuery('#actionItemModal');var bannerCarousel=jQuery("#notification-carousel");carouselModal.on('show.bs.modal',function(e){bannerCarousel.carousel('pause');});carouselModal.on('hide.bs.modal',function(e){bannerCarousel.carousel({interval:getAlertsSlideInterval()||(constants.ACCNT_ALERTS_BANNER_DFLT_SLIDE_INTVL),pause:'hover'});});};self.closeModal=function(){$('#actionItemModal').modal('hide');jQuery("#notification-carousel").carousel('cycle');$('body').removeClass('modal-open');$('.modal-backdrop').remove();}
self.completeActionAndCloseModal=function(userActionCode){accountAlertsService.removeAlert(userActionCode,constants.ALERTS_COMPLETED_STATUS);self.closeModal();};self.completeActionAndPerformGoToAction=function($event,userActionCode,href){accountAlertsService.removeAlert(userActionCode,constants.ALERTS_COMPLETED_STATUS);self.gotoAction($event,userActionCode,href);};var enableBlockingAlert=function(){if(!_.isEmpty(self.blockingModalUserActions)){var userAction=_.first(self.blockingModalUserActions);if(userAction&&userAction.userActionCode){var blockingModalId="blocking_modal-"+userAction.userActionCode;var blockingModal=$("#"+blockingModalId);if(blockingModal&&blockingModal.length){blockingModal.modal('show');}else{self.blockingModalUserActions.shift();enableBlockingAlert();}}}}
var createAlertsViewPerSessionBasedOnConfig=function(){var viewOncePerSessionAlerts=[];self.pendingUserActions.forEach(function(pendingUserAction){if(pendingUserAction.alertsConfig&&pendingUserAction.alertsConfig.length>0){_.each(pendingUserAction.alertsConfig,function(alertsConfig){if(alertsConfig.renotify===false){viewOncePerSessionAlerts.push(pendingUserAction.customUserActionCode);}});}});if(viewOncePerSessionAlerts.length>0){updateAlertViewConfig(viewOncePerSessionAlerts);}}
var updateAlertViewConfig=function(viewOncePerSessionAlerts){var alerts=localStorageService.cookie.get('alerts')||{};if(alerts){for(var i=0;i<viewOncePerSessionAlerts.length;++i){if(!alerts.hasOwnProperty(viewOncePerSessionAlerts[i])){alerts[viewOncePerSessionAlerts[i]]={'mv':1,'cv':0}}else if(alerts.hasOwnProperty(viewOncePerSessionAlerts[i])&&alerts[viewOncePerSessionAlerts[i]]['mv']===alerts[viewOncePerSessionAlerts[i]]['cv']){self.pendingUserActions=self.pendingUserActions.filter(function(userAction){return userAction.userActionCode!==viewOncePerSessionAlerts[i];});}}}
localStorageService.cookie.set('alerts',alerts);}
self.updateConfigForViewedAlert=function(userActionCode){var alerts=localStorageService.cookie.get('alerts')||{};if(alerts){if(alerts.hasOwnProperty(userActionCode)){alerts[userActionCode]['cv']=alerts[userActionCode]['cv']+1;self.removeBannerAndModal(userActionCode);}}
localStorageService.cookie.set('alerts',alerts);}
self.$on('$routeChangeStart',function(event,next,current){self.hideAccntAlerts=Boolean(next.$$route.hideAccntAlerts);if(!self.hideAccntAlerts){$timeout(function(){self.blockingModalUserActions=accountAlertsService.filterBlockingModalUserActions(self.pendingUserActions);if(!_.isEmpty(self.blockingModalUserActions)){enableBlockingAlert();}},1000);}});}},templateUrl:'/fetchDirective.html?directive=accountAlerts/accountAlerts'}}]);

app.directive('globalAlerts',['startupRestService','$templateRequest','$q','cmsContentService','$compile','$timeout','constants','appConfigService',function(startupRestService,$templateRequest,$q,cmsContentService,$compile,$timeout,constants,appConfigService){return{restrict:'E',replace:true,transclude:true,scope:true,controller:['$scope',function(){}