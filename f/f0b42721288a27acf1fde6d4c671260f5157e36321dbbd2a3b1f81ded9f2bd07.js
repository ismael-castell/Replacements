!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).KaChing=t()}(this,(function(){"use strict";function e(e,t,i){return e(i={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&i.path)}},i.exports),i.exports}var t=e((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),i=e((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)})),n=(i.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),r=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e},o=function(e){try{return!!e()}catch(t){return!0}},a=!o((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),s=t.document,u=n(s)&&n(s.createElement),d=!a&&!o((function(){return 7!=Object.defineProperty((e="div",u?s.createElement(e):{}),"a",{get:function(){return 7}}).a;var e})),c=Object.defineProperty,l={f:a?Object.defineProperty:function(e,t,i){if(r(e),t=function(e,t){if(!n(e))return e;var i,r;if(t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;if("function"==typeof(i=e.valueOf)&&!n(r=i.call(e)))return r;if(!t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(t,!0),r(i),d)try{return c(e,t,i)}catch(o){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},f=a?function(e,t,i){return l.f(e,t,function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}(1,i))}:function(e,t,i){return e[t]=i,e},g={}.hasOwnProperty,p=function(e,t){return g.call(e,t)},h=0,m=Math.random(),v=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++h+m).toString(36))},b=e((function(e){var n=t["__core-js_shared__"]||(t["__core-js_shared__"]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})})),y=b("native-function-to-string",Function.toString),_=e((function(e){var n=v("src"),r=(""+y).split("toString");i.inspectSource=function(e){return y.call(e)},(e.exports=function(e,i,o,a){var s="function"==typeof o;s&&(p(o,"name")||f(o,"name",i)),e[i]!==o&&(s&&(p(o,n)||f(o,n,e[i]?""+e[i]:r.join(String(i)))),e===t?e[i]=o:a?e[i]?e[i]=o:f(e,i,o):(delete e[i],f(e,i,o)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[n]||y.call(this)}))})),w=function(e,t,i){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,r){return e.call(t,i,n,r)}}return function(){return e.apply(t,arguments)}},S=function(e,n,r){var o,a,s,u,d=e&S.F,c=e&S.G,l=e&S.S,g=e&S.P,p=e&S.B,h=c?t:l?t[n]||(t[n]={}):(t[n]||{}).prototype,m=c?i:i[n]||(i[n]={}),v=m.prototype||(m.prototype={});for(o in c&&(r=n),r)s=((a=!d&&h&&void 0!==h[o])?h:r)[o],u=p&&a?w(s,t):g&&"function"==typeof s?w(Function.call,s):s,h&&_(h,o,s,e&S.U),m[o]!=s&&f(m,o,u),g&&v[o]!=s&&(v[o]=s)};t.core=i,S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var P=S,E={}.toString,z=function(e){return E.call(e).slice(8,-1)},M=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==z(e)?e.split(""):Object(e)},j=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},k=function(e){return Object(j(e))},x=Math.ceil,A=Math.floor,I=function(e){return isNaN(e=+e)?0:(e>0?A:x)(e)},O=Math.min,T=function(e){return e>0?O(I(e),9007199254740991):0},C=Array.isArray||function(e){return"Array"==z(e)},F=e((function(e){var i=b("wks"),n=t.Symbol,r="function"==typeof n;(e.exports=function(e){return i[e]||(i[e]=r&&n[e]||(r?n:v)("Symbol."+e))}).store=i})),U=F("species"),q=function(e,t){return new(function(e){var t;return C(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!C(t.prototype)||(t=void 0),n(t)&&null===(t=t[U])&&(t=void 0)),void 0===t?Array:t}(e))(t)},R=F("unscopables"),N=Array.prototype;null==N[R]&&f(N,R,{});var B,D,V,L,W,G,K,H,$,J=function(e){N[R][e]=!0},Q=(V=1==(B=5),L=2==B,W=3==B,G=4==B,K=6==B,H=5==B||K,$=D||q,function(e,t,i){for(var n,r,o=k(e),a=M(o),s=w(t,i,3),u=T(a.length),d=0,c=V?$(e,u):L?$(e,0):void 0;u>d;d++)if((H||d in a)&&(r=s(n=a[d],d,o),B))if(V)c[d]=r;else if(r)switch(B){case 3:return!0;case 5:return n;case 6:return d;case 2:c.push(n)}else if(G)return!1;return K?-1:W||G?G:c}),Y=!0;"find"in[]&&Array(1).find((function(){Y=!1})),P(P.P+P.F*Y,"Array",{find:function(e){return Q(this,e,arguments.length>1?arguments[1]:void 0)}}),J("find");var X=Math.max,Z=Math.min,ee=function(e,t){return(e=I(e))<0?X(e+t,0):Z(e,t)};P(P.P,"Array",{fill:function(e){for(var t=k(this),i=T(t.length),n=arguments.length,r=ee(n>1?arguments[1]:void 0,i),o=n>2?arguments[2]:void 0,a=void 0===o?i:ee(o,i);a>r;)t[r++]=e;return t}}),J("fill");var te,ie,ne=function(e){return M(j(e))},re=b("keys"),oe=(te=!1,function(e,t,i){var n,r=ne(e),o=T(r.length),a=ee(i,o);if(te&&t!=t){for(;o>a;)if((n=r[a++])!=n)return!0}else for(;o>a;a++)if((te||a in r)&&r[a]===t)return te||a||0;return!te&&-1}),ae=re[ie="IE_PROTO"]||(re[ie]=v(ie)),se="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ue=Object.keys||function(e){return function(e,t){var i,n=ne(e),r=0,o=[];for(i in n)i!=ae&&p(n,i)&&o.push(i);for(;t.length>r;)p(n,i=t[r++])&&(~oe(o,i)||o.push(i));return o}(e,se)},de={f:Object.getOwnPropertySymbols},ce={f:{}.propertyIsEnumerable},le=Object.assign,fe=!le||o((function(){var e={},t={},i=Symbol(),n="abcdefghijklmnopqrst";return e[i]=7,n.split("").forEach((function(e){t[e]=e})),7!=le({},e)[i]||Object.keys(le({},t)).join("")!=n}))?function(e,t){for(var i=k(e),n=arguments.length,r=1,o=de.f,a=ce.f;n>r;)for(var s,u=M(arguments[r++]),d=o?ue(u).concat(o(u)):ue(u),c=d.length,l=0;c>l;)a.call(u,s=d[l++])&&(i[s]=u[s]);return i}:le;function ge(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t,i){return t&&ge(e.prototype,t),i&&ge(e,i),e}function he(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(){return(me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function ve(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,be(e,t)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}P(P.S+P.F,"Object",{assign:fe});var _e=function(e,t,i,n){return void 0===t&&(t=!1),void 0===i&&(i=[]),void 0===n&&(n=void 0),new Promise((function(r,o){if("undefined"==typeof document)return r();var a=document.createElement("script");return t&&(a.async=!0),i.length&&i.forEach((function(e){a.setAttribute(e.name,e.value)})),a.src=e,a.onload=r,a.onerror=o,n?n.appendChild(a):(n=document.getElementsByTagName("script")[0])&&n.parentNode&&n.parentNode.insertBefore(a,n),null}))},we=function(e){},Se=we;-1!==window.location.search.indexOf("pbjs_debug=true")&&(we=Function.prototype.bind.call(console.log,console,"%cKa-Ching","display: inline-block; color: #F2F3EF; background: #E8634E; padding: 1px 4px; border-radius: 3px;"),Se=Function.prototype.bind.call(console.warn,console,"%cKa-Ching","display: inline-block; color: #F2F3EF; background: #E8634E; padding: 1px 4px; border-radius: 3px;"));var Pe=we;function Ee(e,t){void 0===t&&(t={bubbles:!1,cancelable:!1,detail:void 0});var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail),i}Ee.prototype=Event.prototype;var ze="function"!=typeof CustomEvent?Ee:CustomEvent;function Me(e,t){var i=new ze(e,{detail:t});document.dispatchEvent(i)}var je,ke="render.init",xe="render.complete",Ae=function(e,t){setTimeout((function(){Pe("emitting on channel KaChing."+e,t),je("KaChing."+e,t)}),0)},Ie="preload",Oe="defineSlot",Te="beforePublish",Ce="beforeInit",Fe="init",Ue="afterInit",qe="reset",Re=function(){function e(){}return e.run=function(e,t,i){var n=t.find((function(e){return"RequestNonPersonalizedAds"===e.getName()})),r=t.map((function(t){if(!t[e])return null;if(n&&!i.config.get("personalAds")&&t.getName().match(/Cxense|Prebid/))return Pe("[ADAPTER "+t.getName()+" "+e+" skipped because of requestNonPersonalisedAds]"),null;var r=t[e];return Pe("[ADAPTER "+t.getName()+"] "+e),r.call(t,i)}));return Promise.all(r)},e}(),Ne=function(){function e(e){he(this,"_slots",[]),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],this.googletag=window.googletag,e.blockads||_e("https://securepubads.g.doubleclick.net/tag/js/gpt.js")}var t=e.prototype;return t.defineSlot=function(e){return this._slots.push(e),e},t._registerSlot=function(e,t){var i,n=t.adunit||e.adUnit;if(t.isOutOfPage)i=this.googletag.defineOutOfPageSlot(n,t.elementId);else if(t.interstitial){var r=(i=this.googletag.defineOutOfPageSlot(n,this.googletag.enums.OutOfPageFormat.INTERSTITIAL)).getSlotElementId();t.elementId=r}else{var o=e.get("adFormats");i=this.googletag.defineSlot(n,o[t.format].sizes||o[t.format],t.elementId)}if(i)for(var a in t.sizeMapping&&t.sizeMapping.length&&function(e,t,i){var n=e.sizeMapping();i.forEach((function(e){var t=e[0],i=e[1];n.addSize(t,i)})),t.defineSizeMapping(n.build())}(this.googletag,i,t.sizeMapping),t.isVideoCompanion&&i.addService(this.googletag.companionAds()),i.addService(this.googletag.pubads()),t.targeting)t.targeting[a]&&(Pe("adding "+a+" ("+t.targeting[a]+") to slot "+t+"."),i.setTargeting(a,t.targeting[a]));else Pe("[SLOT]",document.querySelectorAll("#"+t).length+" ad positions found with "+t+" id");return i},t.display=function(e,t){var i=this;Array.isArray(t)||(t=[t]);var n=[];return t.forEach((function(t){if(t&&!t.isDisplayed()){var r=i._registerSlot(e,t);n.push(t),Pe("[SLOT]","displaying "+t),t.displayed=!0,t.setDfpSlot(r),i.googletag.display(t.elementId)}})),n},t.setTargeting=function(e,t){var i=this;this.googletag.cmd.push((function(){Pe("adding "+e+" ("+t+") to DFP request."),i.googletag.pubads().setTargeting(e,t)}))},t.clearTargeting=function(){var e=this;this.googletag.cmd.push((function(){Pe("clearing the key-values from the DFP request."),e.googletag.pubads().clearTargeting()}))},t.sizeMapping=function(){var e=this;return new Promise((function(t){e.googletag.cmd.push((function(){t(e.googletag.sizeMapping())}))}))},t.setRequestNonPersonalizedAds=function(e){var t=this;this.googletag.cmd.push((function(){Pe("adding non personalised ads value ("+e+") to DFP request."),t.googletag.pubads().setRequestNonPersonalizedAds(e)}))},t.beforeFirstPublish=function(e){var t=this;return new Promise((function(i){t.googletag.cmd.push((function(){t.googletag.pubads().addEventListener("slotRenderEnded",(function(i){var n=e.get("features")||{},r=i.slot,o=i.isEmpty,a=i.size,s=r.getResponseInformation()||{},u=t._slots.find((function(e){return e.elementId===r.getSlotElementId()})),d={identifier:u.identifier,format:u.format,slot:u.slot||null,isEmpty:!!o||11725554===s.creativeTemplateId,size:a},c=r.getTargeting("hb_size");if(a&&1===a[0]&&1===a[1]&&c&&c.length)try{d.size=c[0].split("x").map(Number)}catch(l){}u.context=d,Ae(ke,d),o&&!n.blockEventCompleteOnEmpty&&(Se("[DEPRECATED] blockEventCompleteOnEmpty is false: we still send render complete messages even when it's empty."),Ae(xe,d))})),t.googletag.pubads().addEventListener("slotOnload",(function(e){var i=e.slot,n=t._slots.find((function(e){return e.elementId===i.getSlotElementId()}));Ae(xe,n.context)})),t.googletag.pubads().collapseEmptyDivs(null),t.googletag.pubads().enableAsyncRendering(),t.googletag.pubads().enableSingleRequest(),t.googletag.pubads().disableInitialLoad(),t.googletag.enableServices()})),i()}))},t.publish=function(e){var t=this;return new Promise((function(i){t.googletag.cmd.push((function(){e.get("video")&&(t.googletag.companionAds().setRefreshUnfilledSlots(!0),t.googletag.pubads().enableVideoAds());var n=e.get("lazyload")||{fetchMarginPercent:25,renderMarginPercent:10,mobileScaling:2,scatterSlots:!1};t.googletag.pubads().enableLazyLoad({fetchMarginPercent:n.fetchMarginPercent,renderMarginPercent:n.renderMarginPercent,mobileScaling:n.mobileScaling});var r=t.display(e,t._slots),o=function(e,t){return t.reduce((function(t,i){var n=i[e];return t[n]=(t[n]||[]).concat(i),t}),{})}("group",r);return Re.run(Te,e.adapters,{config:e,dfp:t,event:{slots:r}}).then((function(){return Pe("send request"),Object.keys(o).forEach((function(e){if("None"===e&&n.scatterSlots)o[e].forEach((function(e){t.googletag.pubads().refresh([e.dfpSlot])}));else{var i=o[e].reduce((function(e,t){return e.push(t.dfpSlot)&&e}),[]);t.googletag.pubads().refresh(i)}})),i()}))}))}))},t._getPubIdFromAdUnitPath=function(e){var t=null;return e.slot&&e.slot.getAdUnitPath&&(t=e.slot.getAdUnitPath().split("/")[1]),t},t.destroySlots=function(e){var t=this;return void 0===e&&(e=void 0),new Promise((function(i){t.googletag.cmd.push((function(){if(e){var n=[];e.forEach((function(e){var i=t.googletag.pubads().getSlots().find((function(t){return t.getSlotElementId()===e}));i&&n.push(i),t._slots=t._slots.filter((function(t){return t.elementId!==e}))})),t.googletag.destroySlots(n)}else t._slots=[],t.googletag.destroySlots();i()}))}))},e}();var Be=function(){function e(){}var t=e.prototype;return t.init=function(e){var t=e.config,i=(e.dfp,t.get("targeting")),n=t.get("adunit");t.set("targeting",me({},i,{adunit:n}))},t.beforePublish=function(e){var t=e.config,i=e.dfp,n=t.get("targeting");Object.keys(n).forEach((function(e){n[e]&&i.setTargeting(e,n[e])}))},e}(),De=function(){function e(){}return e.prototype.defineSlot=function(e){var t=e.config,i=e.event.slot,n=t.get("adFormats");if(n&&n[i.format]&&n[i.format].sizeMapping){var r=n[i.format].sizeMapping;if(!r)return;var o=[];for(var a in o.push([[0,0],[]]),r){var s=[Number(a),0];o.push([s,r[a]])}i.setSizeMapping(o)}},e}(),Ve="https://pubads.g.doubleclick.net/gampad/ads",Le=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return he(ye(t=e.call.apply(e,[this].concat(n))||this),"name","Video"),t}ve(t,e);var i=t.prototype;return i.init=function(t){e.prototype.init.call(this,t)},i.getUrl=function(e){if(void 0===e&&(e=null),!this._lastEvent)return null;var t=this._lastEvent.url;if(e&&(t+="$vid="+e),e){var i=encodeURIComponent("videoId="+e+"&");t=t.replace(/(.*cust_params=)(.*)/,"$1"+i+"$2")}return t},i.addVastSize=function(){this._vastUrl+="?sz=620x345"},i.addCompanionSizes=function(e){var t=e.config,i=e.event,n=t.get("adFormats"),r=i.slots.filter((function(e){return e.isVideoCompanion})).map((function(e){return n[e.format].sizes.filter(Array.isArray).map((function(e){return e.join("x")})).join("|")})).join(",");r&&(this._vastUrl+="&ciu_szs="+r)},i.addCMSId=function(){},i.beforePublish=function(t){e.prototype.beforePublish.call(this,t)},i.afterInit=function(t){e.prototype.afterInit.call(this,t)},t}(function(){function e(){he(this,"name","Vast"),he(this,"_lastEvent",null),he(this,"hasPublished",!1),he(this,"_vastUrl",Ve)}var t=e.prototype;return t.init=function(e){var t=e.config;this.hasPublished=!1,this._lastEvent=null;var i=t.get("videoTargeting"),n=t.get("targeting");t.set("videoTargeting",me({},n,i))},t._publish=function(e){var t={format:this.name,isEmpty:!1,url:e,size:null,slot:null};this._lastEvent=t,Ae(ke,t),Ae(xe,t)},t.getUrl=function(e){return null},t.appDescriptionUrl=function(){var e=RegExp("^(file://)|^(https://theoplayer)"),t=window.location.href;return e.test(t)?"https://www.belfasttelegraph.co.uk/video":encodeURIComponent(t)},t.addVastSize=function(){this._vastUrl+="?"},t.addCompanionSizes=function(e){e.config,e.event},t.addCMSId=function(){},t.addTargeting=function(e){var t=e.config.get("videoTargeting");if(t){var i=Object.keys(t).length;this.log("Adding video targeting (count: "+i+") to VAST tag");var n=Object.keys(t).map((function(e){return e+"="+t[e]})).filter(Boolean);if(n.length){var r=encodeURIComponent(n.join("&"));this._vastUrl+="&cust_params="+r}}},t.beforePublish=function(e){var t=e.config;this.hasPublished||(this.addVastSize(),this._vastUrl+="&ad_type="+this.name.toLowerCase()+"&iu="+t.adUnit+"&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&description_url="+this.appDescriptionUrl()+"&correlator=[timestamp]&ad_rule=1",this.addCompanionSizes(e),this.addCMSId(),this.addTargeting(e),this._publish(this._vastUrl))},t.afterInit=function(e){var t=e.config;this._vastUrl=Ve,t.get("blockads")&&this._publish("")},e}()),We=function(){function e(t,i,n){var r=this;he(this,"_read",(function(){if(window.sessionStorage&&window.sessionStorage.getItem)try{var e=window.sessionStorage.getItem(r._key);if(r._del(),e){var t=JSON.parse(e);if(t.source===r._remote)return Pe("get "+r._key+"="+t.value+" from session storage"),t.value}}catch(i){Pe(i.message)}return!1})),he(this,"_write",(function(){var t={source:r._local,value:e.randomString()};if(window.sessionStorage&&window.sessionStorage.setItem)try{window.sessionStorage.setItem(r._key,JSON.stringify(t)),Pe("set "+r._key+"="+JSON.stringify(t)+" to session storage")}catch(i){Pe(i.message)}return t.value})),he(this,"_del",(function(){if(window.sessionStorage&&window.sessionStorage.removeItem){Pe("delete "+r._key+" from session storage");try{window.sessionStorage.removeItem(r._key)}catch(e){Pe(e.message)}}})),this._key=t,this._local=i,this._remote=n}return pe(e,[{key:"sync",get:function(){return this._read()||this._write()}}]),e}();he(We,"randomString",(function(){for(var e=[],t=16,i="abcdefghijklmnopqrstuvwxyz0123456789";t--;)e.push(i.charAt(Math.floor(Math.random()*i.length)));return e.join("")}));var Ge=function(){function e(){he(this,"getSegments",(function(e){var t=[];if(window.localStorage&&window.localStorage.getItem){Pe("get segments from storage");try{var i=window.localStorage.getItem(e);if(null===i)throw new Error("Segments not found in storage");t=JSON.parse(i)}catch(n){Pe(n.message)}}else Pe("Storage api not found");return t})),he(this,"getUser",(function(){var t=null;if(window.localStorage&&window.localStorage.getItem){Pe("get userid from storage");try{t=window.localStorage.getItem(e.STORAGE_KEY_USER)}catch(i){Pe(i.message)}}else Pe("Storage api not found");return t}))}return e.prototype.beforeInit=function(e){var t=this,i=e.config,n=i.get("targeting"),r=new We("cxPrnd","ga","cx"),o={};[{name:"CxSegments",storage:"adv_identity"}].forEach((function(){}