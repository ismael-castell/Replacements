(self.webpackChunk=self.webpackChunk||[]).push([[1411],{58013:function(t){var e;"undefined"!=typeof self&&self,e=()=>(()=>{var t={31:t=>{window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=4)}([function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s}));var i=0,r={pixelPositionX:i++,pixelPositionY:i++,groupIndex:i++,iconIndex:i++,priority:i++},o=Object.keys(r).length;function a(t,e){for(var n=0,i=0;n<e.length;n++,i+=o){var a=e[n];t[i+r.pixelPositionX]=a.pixelPosition[0],t[i+r.pixelPositionY]=a.pixelPosition[1],t[i+r.groupIndex]=a.groupIndex,t[i+r.iconIndex]=a.iconIndex,t[i+r.priority]=Boolean(a.priority)?1:0}}function s(t,e){for(var n=0,i=0;n<t.length;n++,i+=o)t[n].iconIndex=e[i+r.iconIndex]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s}));var i=0,r={markerIndex:i++,offsetX:i++,offsetY:i++,width:i++,height:i++,display:i++,minZoom:i++},o=7;function a(t,e,n){for(var i=0,a=0;a<e.length;a++){var s=e[a].htmlLabel;void 0!==s&&(t[i+r.markerIndex]=a,t[i+r.offsetX]=s.offset[0]*n,t[i+r.offsetY]=s.offset[1]*n,t[i+r.width]=s.width*n,t[i+r.height]=s.height*n,t[i+r.display]=s.display?1:0,t[i+r.minZoom]=s.minZoom,i+=o)}}function s(t,e){for(var n=0,i=0,a=t;i<a.length;i++){var s=a[i].htmlLabel;void 0!==s&&(s.display=1===e[n+r.display],s.minZoom=e[n+r.minZoom],n+=o)}}},function(t,e,n){function i(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n.oe=function(t){throw console.error(t),t};var i=n(n.s=ENTRY_MODULE);return i.default||i}var r="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+r+").*?\\)";function a(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(t,e,i){var s={};s[i]=[];var l=e.toString(),c=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return s;for(var u,d=c[1],h=new RegExp("(\\\\n|\\W)"+a(d)+o,"g");u=h.exec(l);)"dll-reference"!==u[3]&&s[i].push(u[3]);for(h=new RegExp("\\("+a(d)+'\\("(dll-reference\\s('+r+'))"\\)\\)'+o,"g");u=h.exec(l);)t[u[2]]||(s[i].push(u[1]),t[u[2]]=n(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);for(var f,p=Object.keys(s),m=0;m<p.length;m++)for(var v=0;v<s[p[m]].length;v++)f=s[p[m]][v],isNaN(1*f)||(s[p[m]][v]=1*s[p[m]][v]);return s}function l(t){return Object.keys(t).reduce((function(e,n){return e||t[n].length>0}),!1)}t.exports=function(t,e){e=e||{};var r={main:n.m},o=e.all?{main:Object.keys(r.main)}:function(t,e){for(var n={main:[e]},i={main:[]},r={main:{}};l(n);)for(var o=Object.keys(n),a=0;a<o.length;a++){var c=o[a],u=n[c].pop();if(r[c]=r[c]||{},!r[c][u]&&t[c][u]){r[c][u]=!0,i[c]=i[c]||[],i[c].push(u);for(var d=s(t,t[c][u],c),h=Object.keys(d),f=0;f<h.length;f++)n[h[f]]=n[h[f]]||[],n[h[f]]=n[h[f]].concat(d[h[f]])}}return i}(r,t),a="";Object.keys(o).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;o[t][e];)e++;o[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+t+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o[t].map((function(e){return JSON.stringify(e)+": "+r[t][e].toString()})).join(",")+"});\n"})),a=a+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o.main.map((function(t){return JSON.stringify(t)+": "+r.main[t].toString()})).join(",")+"}))(self);";var c=new window.Blob([a],{type:"text/javascript"});if(e.bare)return c;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),d=new window.Worker(u);return d.objectURL=u,d}},function(t,e,n){"use strict";n.r(e);var i={min:-1/0,max:1/0},r={min:-1/0,max:1/0},o={min:-1/0,max:1/0},a={min:0,max:1/0};function s(t,e,n){var s,c,u,d,h=e.anchorX-t.anchorX,f=e.anchorY-t.anchorY;return l(i,t.minX,t.maxX,e.minX,e.maxX,h),l(r,t.minY,t.maxY,e.minY,e.maxY,f),c=i,u=r,d=a,(s=o).min=Math.max(c.min,u.min,d.min),s.max=Math.min(c.max,u.max,d.max),o.min>=o.max?-1/0:n+Math.log(o.max)/Math.log(2)}function l(t,e,n,i,r,o){var a=o>0?e-r:i-n,s=o>0?n-i:r-e;t.min=a/Math.abs(o),t.max=s/Math.abs(o)}var c=n(0),u=n(1),d={minX:0,minY:0,maxX:0,maxY:0},h={minX:0,minY:0,maxX:0,maxY:0},f={minX:0,minY:0,maxX:0,maxY:0},p={minX:0,minY:0,maxX:0,maxY:0},m=[];function v(t,e,n,i,r,o,a,s){for(var l=t.bounds,u=t.priorityGroups,d=t.sprites,h=t.markers,f=t.markerCount,p=0;p<u.length;p++)if(d[u[p].iconIndex])for(var m=0!==p?n[p-1]:void 0,v=p!==u.length-1?n[p]:void 0,_=0;_<f;_++){var g=-1!==o[_],b=1===h[c.c*_+c.a.priority];(a&&g||!a&&!g)&&(s&&b||!s&&!b)&&y(h,u,d,l,m,v,e,i,r,p,_)}}function _(t,e,n,i,r,o,a,s,l){for(var d=t.bounds,h=t.markers,f=t.labels,p=t.labelCount,m=t.currentZoom,v=0;v<p;v++){var _=f[v*u.c+u.a.markerIndex],y=1===o[v]&&m>=a[v],b=1===h[_*c.c+c.a.priority];(s&&y||!s&&!y)&&(l&&b||!l&&!b)&&g(h,f,d,e,n,i,m,r,v)}}function y(t,e,n,i,r,o,a,s,l,u,p){var m=e[u],v=m.safeZone,_=m.iconIndex,y=m.margin,g=m.degradation,S=n[_],M=S.size,P=S.anchor,T=c.c,k=c.a,L=p*T,z=t[L+k.groupIndex],E=t[L+k.pixelPositionX]-i.minX,C=t[L+k.pixelPositionY]-i.minY;z>u||(I(h,s,l,M,P,E,C,y),w(h)||z===u&&r&&b(r,s,h)||(I(d,s,l,M,P,E,C,v),w(d)||b(a,s,d)||(I(f,s,l,M,P,E,C,g),x(a,s,h),o&&x(o,s,f),t[L+k.iconIndex]=_)))}function g(t,e,n,i,r,o,a,l,d){var h=u.c,f=u.a,v=d*h,_=e[v+f.markerIndex]*c.c;if(-1!==t[_+c.a.iconIndex]){var y=t[_+c.a.pixelPositionX]-n.minX,g=t[_+c.a.pixelPositionY]-n.minY,S=[e[v+f.width],e[v+f.height]],M=[-e[v+f.offsetX]/S[0],-e[v+f.offsetY]/S[1]];if(I(p,r,o,S,M,y,g,l),!w(p)&&!b(i,r,p)){x(i,r,p),e[v+f.display]=1;for(var P={anchorX:y,anchorY:g,minX:-S[0]*M[0],minY:-S[1]*M[1],maxX:S[0]*(1-M[0]),maxY:S[1]*(1-M[1]),minZoom:-1/0},T=0,k=m;T<k.length;T++){var L=k[T],z=s(L,P,a);z>P.minZoom&&z>L.minZoom&&(P.minZoom=z)}e[v+f.minZoom]=P.minZoom,m.push(P)}}}function b(t,e,n){for(var i=n.minX,r=n.minY,o=n.maxX,a=n.maxY,s=r;s<a;s++){var l=s*e+i>>3,c=s*e+o>>3,u=0;if(l===c)u=t[l]&255>>(7&i)&255<<8-(7&o);else{u=t[l]&255>>(7&i);for(var d=l+1;d<c;d++)u=t[d]|u;u=t[c]&255<<8-(7&o)|u}if(0!==u)return!0}return!1}function x(t,e,n){for(var i=n.minX,r=n.minY,o=n.maxX,a=n.maxY,s=r;s<a;s++){var l=s*e+i>>3,c=s*e+o>>3;if(l===c)t[l]=t[l]|255>>(7&i)&255<<8-(7&o);else{t[l]=t[l]|255>>(7&i);for(var u=l+1;u<c;u++)t[u]=255;t[c]=t[c]|255<<8-(7&o)}}}function w(t){return t.minX===t.maxX||t.minY===t.maxY}function I(t,e,n,i,r,o,a,s){var l=o-i[0]*r[0]-s|0,c=a-i[1]*r[1]-s|0,u=o+i[0]*(1-r[0])+s|0,d=a+i[1]*(1-r[1])+s|0;t.minX=l>0?l<e?l:e:0,t.minY=c>0?c<n?c:n:0,t.maxX=u>0?u<e?u:e:0,t.maxY=d>0?d<n?d:n:0}e.default=function(t){t.onmessage=function(e){!function(t){for(var e=t.bounds,n=t.priorityGroups,i=t.markers,r=t.markerCount,o=t.labels,a=t.labelCount,s=t.labelMargin,l=1+(e.maxX-e.minX>>3)<<3,d=e.maxY-e.minY,h=l*d+8>>3,f=new Uint8Array(h),p=new Uint8Array(h),y=[],g=0;g<n.length;g++)y[g]=new Uint8Array(h);var b=new Int8Array(r);for(g=0;g<r;g++){var x=g*c.c+c.a.iconIndex;b[g]=i[x],i[x]=-1}var w=new Uint8Array(a),I=new Float32Array(a);for(g=0;g<a;g++){var S=g*u.c+u.a.display,M=g*u.c+u.a.minZoom;w[g]=o[S],I[g]=o[M],o[S]=0,o[M]=-1/0}m=[],v(t,f,y,l,d,b,!0,!0),v(t,f,y,l,d,b,!1,!0),_(t,p,l,d,s,w,I,!0,!0),_(t,p,l,d,s,w,I,!1,!0),v(t,f,y,l,d,b,!0,!1),v(t,f,y,l,d,b,!1,!1),_(t,p,l,d,s,w,I,!0,!1),_(t,p,l,d,s,w,I,!1,!1)}(e.data);var n=e.data,i=n.markers,r=n.labels;t.postMessage({markerArray:i,labelArray:r},[i.buffer,r.buffer])}}},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(1),o=n(2),a=n.n(o),s=function(){function t(){var t=this;this.worker=a()(3),this.queue=[],this.currentJob=void 0,this.markerArray=new Float32Array(1e3*i.c),this.labelArray=new Float32Array(1e3*r.c),this.worker.onmessage=function(e){if(void 0!==t.currentJob){var n=t.currentJob,o=n.markers,a=n.resolve,s=e.data;i.d(o,s.markerArray),r.d(o,s.labelArray),t.markerArray=s.markerArray,t.labelArray=s.labelArray,t.currentJob=void 0,t.dequeue(),a()}}}return t.prototype.generalize=function(t,e,n,i,r,o){var a=this,s={bounds:t,priorityGroups:e,sprites:n,currentZoom:r,labelMargin:o*window.devicePixelRatio},l=i.length,c=i.filter((function(t){return void 0!==t.htmlLabel})).length;return new Promise((function(t){a.queue.push({message:s,markers:i,resolve:t,markerCount:l,labelCount:c}),a.dequeue()}))},t.prototype.clear=function(){this.queue=[]},t.prototype.pack=function(t,e,n){e*i.c>this.markerArray.length&&(this.markerArray=new Float32Array(e*i.c)),n*r.c>this.labelArray.length&&(this.labelArray=new Float32Array(n*r.c)),i.b(this.markerArray,t),r.b(this.labelArray,t,window.devicePixelRatio)},t.prototype.dequeue=function(){if(void 0===this.currentJob){var t=this.queue.shift();if(void 0!==t){this.pack(t.markers,t.markerCount,t.labelCount);var e=t.message;e.markers=this.markerArray,e.markerCount=t.markerCount,e.labels=this.labelArray,e.labelCount=t.labelCount,this.worker.postMessage(e,[e.markers.buffer,e.labels.buffer]),this.currentJob=t}}},t}();n.d(e,"General",(function(){return s}))}])},122:t=>{(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{geoLineDistance:()=>g,geoToMapDistance:()=>_,getCenterZoomByPoints:()=>T,getMetersFromPixels:()=>E,getMousePositionInContainer:()=>k,projectGeoToMap:()=>p,projectGeoToScreen:()=>L,projectMapToGeo:()=>m,projectMapToScreen:()=>C,projectScreenToGeo:()=>z});var i=1e-6,r="undefined"!=typeof Float64Array?Float64Array:Array;function o(){var t=new r(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t,e,n){var i=new r(3);return i[0]=t,i[1]=e,i[2]=n,i}Math.random,Math.PI,o(),Object.create,Object.create;var s={fov:60,near:1e3,far:Math.pow(2,34),minCalculationScreenHeight:1e3,viewportLimitRatio:2};function l(){var t=new r(2);return t[0]=0,t[1]=0,t}function c(t,e){var n=new r(2);return n[0]=t,n[1]=e,n}!function(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);t.concat(i||Array.prototype.slice.call(e))}(["Commercial_poi_default","Commercial_poi_custom","Commercial_poi_navi"],["Commercial_poi_city"],!0),l();var u=Math.pow(2,32);function d(t,e){return{min:t||c(1/0,1/0),max:e||c(-1/0,-1/0)}}function h(t,e){var n,i,r;n=t.min,i=t.min,r=e,n[0]=Math.min(i[0],r[0]),n[1]=Math.min(i[1],r[1]),function(t,e,n){t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1])}(t.max,t.max,e)}Math.pow(2,20),Math.pow(2,16);var f=2*Math.PI*6378137;function p(t){var e=u/2,n=Math.sin(S(t[1])),i=t[0]*u/360,r=Math.log((1+n)/(1-n))*u/(4*Math.PI);return a(I(i,-e,e),I(r,-e,e),0)}function m(t){var e=[0,0];e[0]=360*t[0]/u;var n=-2*Math.PI/u;return e[1]=90-Math.atan(Math.exp(t[1]*n))/Math.PI*180*2,e}function v(t){return Math.max(t,s.minCalculationScreenHeight)}function _(t,e){var n;return e*(u/f)*(n=t[1],1/Math.cos(S(n)))}function y(t,e){var n=Math.PI/180,i=t[1]*n,r=e[1]*n,o=Math.sin((e[1]-t[1])*n/2),a=Math.sin((e[0]-t[0])*n/2),s=o*o+Math.cos(i)*Math.cos(r)*a*a,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return Math.round(6371e3*l)}function g(t){var e=0;if(t.length>1)for(var n=0;n<t.length-1;n++)e+=y(t[n],t[n+1]);return e}function b(t,e){return 0===t?-1/0:-Math.log(256*e/(t*u))/Math.LN2}d([-u/2,-u/2],[u/2,u/2]),l(),l();var x=[0,0,1],w=function(){function t(t){this.state=t,this.position=[0,0,0],this.projectionMatrix=[],this.viewMatrix=[],this.viewProjectionMatrix=[],this.viewProjectionMatrixInverse=[],this.update()}return t.prototype.setState=function(t){this.state=t,this.update()},t.prototype.update=function(){var t,e,n,i,r,o,a,s,l,c,u,d,h,f,p,m,v,_,y,g,b,x,w,I,S,M,P,T,k,L,z;this.updatePosition(),this.updateProjectionMatrix(),this.updateViewMatrix(),function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=n[0],b=n[1],x=n[2],w=n[3];t[0]=g*i+b*s+x*d+w*m,t[1]=g*r+b*l+x*h+w*v,t[2]=g*o+b*c+x*f+w*_,t[3]=g*a+b*u+x*p+w*y,g=n[4],b=n[5],x=n[6],w=n[7],t[4]=g*i+b*s+x*d+w*m,t[5]=g*r+b*l+x*h+w*v,t[6]=g*o+b*c+x*f+w*_,t[7]=g*a+b*u+x*p+w*y,g=n[8],b=n[9],x=n[10],w=n[11],t[8]=g*i+b*s+x*d+w*m,t[9]=g*r+b*l+x*h+w*v,t[10]=g*o+b*c+x*f+w*_,t[11]=g*a+b*u+x*p+w*y,g=n[12],b=n[13],x=n[14],w=n[15],t[12]=g*i+b*s+x*d+w*m,t[13]=g*r+b*l+x*h+w*v,t[14]=g*o+b*c+x*f+w*_,t[15]=g*a+b*u+x*p+w*y}(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),t=this.viewProjectionMatrixInverse,n=(e=this.viewProjectionMatrix)[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],v=e[14],(z=(y=n*s-i*a)*(L=h*(_=e[15])-f*v)-(g=n*l-r*a)*(k=d*_-f*m)+(b=n*c-o*a)*(T=d*v-h*m)+(x=i*l-r*s)*(P=u*_-f*p)-(w=i*c-o*s)*(M=u*v-h*p)+(I=r*c-o*l)*(S=u*m-d*p))&&(z=1/z,t[0]=(s*L-l*k+c*T)*z,t[1]=(r*k-i*L-o*T)*z,t[2]=(m*I-v*w+_*x)*z,t[3]=(h*w-d*I-f*x)*z,t[4]=(l*P-a*L-c*M)*z,t[5]=(n*L-r*P+o*M)*z,t[6]=(v*b-p*I-_*g)*z,t[7]=(u*I-h*b+f*g)*z,t[8]=(a*k-s*P+c*S)*z,t[9]=(i*P-n*k-o*S)*z,t[10]=(p*w-m*b+_*y)*z,t[11]=(d*b-u*w-f*y)*z,t[12]=(s*M-a*T-l*S)*z,t[13]=(n*T-i*M+r*S)*z,t[14]=(m*g-p*x-v*y)*z,t[15]=(u*x-d*g+h*y)*z)},t.prototype.putProject=function(t,e){var n=this.state,i=n.size,r=n.viewport,o=this.viewProjectionMatrix,a=e[0],s=e[1],l=e[2],c=i[0]/2,u=i[1]/2,d=o[3]*a+o[7]*s+o[11]*l+o[15];t[0]=c+r.left+(o[0]*a+o[4]*s+o[12])*c/d,t[1]=u+r.top-(o[1]*a+o[5]*s+o[9]*l+o[13])*u/d},t.prototype.project=function(t){var e=[0,0,0];return this.putProject(e,t),e},t.prototype.unproject=function(t){var e,n,i,r,o,a,s,l=this.state,c=l.size,u=l.viewport,d=[(t[0]-u.left)/c[0]*2-1,-(t[1]-u.top)/c[1]*2+1,0];if(e=d,n=d,i=this.viewProjectionMatrixInverse,r=n[0],o=n[1],a=n[2],s=(s=i[3]*r+i[7]*o+i[11]*a+i[15])||1,e[0]=(i[0]*r+i[4]*o+i[8]*a+i[12])/s,e[1]=(i[1]*r+i[5]*o+i[9]*a+i[13])/s,e[2]=(i[2]*r+i[6]*o+i[10]*a+i[14])/s,d[0]-=this.position[0],d[1]-=this.position[1],d[2]-=this.position[2],function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o)}(d,d),0!==d[2]){var h=-this.position[2]/d[2];h>=0?(d[0]=this.position[0]+d[0]*h,d[1]=this.position[1]+d[1]*h,d[2]=this.position[2]+d[2]*h):d[0]=d[1]=d[2]=0}else d[0]=d[1]=d[2]=0;return d},t.prototype.getViewportVertices=function(){var t=this.state,e=t.size,n=t.viewport;return[this.unproject([n.left,e[1]+n.top,0]),this.unproject([e[0]+n.left,e[1]+n.top,0]),this.unproject([e[0]+n.left,n.top,0]),this.unproject([n.left,n.top,0])]},t.prototype.updatePosition=function(){var t=this.state,e=t.center,n=t.rotation,i=t.zoom,r=t.pitch,o=function(t,e){return v(e[1])*u/(512*Math.tan(S(s.fov)/2)*Math.pow(2,t))}(i,t.size),a=Math.max(o*Math.sin(r),1);this.position[0]=e[0]+Math.sin(n)*a,this.position[1]=e[1]-Math.cos(n)*a,this.position[2]=o*Math.cos(r)},t.prototype.updateViewMatrix=function(){!function(t,e,n,r){var o,a,s,l,c,u,d,h,f,p,m=e[0],v=e[1],_=e[2],y=r[0],g=r[1],b=r[2],x=n[0],w=n[1],I=n[2];Math.abs(m-x)<i&&Math.abs(v-w)<i&&Math.abs(_-I)<i?mat4.identity(t):(d=m-x,h=v-w,f=_-I,o=g*(f*=p=1/Math.sqrt(d*d+h*h+f*f))-b*(h*=p),a=b*(d*=p)-y*f,s=y*h-g*d,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0),l=h*s-f*a,c=f*o-d*s,u=d*a-h*o,(p=Math.sqrt(l*l+c*c+u*u))?(l*=p=1/p,c*=p,u*=p):(l=0,c=0,u=0),t[0]=o,t[1]=l,t[2]=d,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=f,t[11]=0,t[12]=-(o*m+a*v+s*_),t[13]=-(l*m+c*v+u*_),t[14]=-(d*m+h*v+f*_),t[15]=1)}(this.viewMatrix,this.position,this.state.center,x)},t.prototype.updateProjectionMatrix=function(){var t=s.fov,e=s.near,n=s.far,i=this.correctViewAndSize(),r=i.size,o=i.view,a=r[0]/r[1],l=e*Math.tan(S(t)/2),c=2*l,u=a*c,d=-u/2;o&&(d+=o.x*u/r[0],l-=o.y*c/r[1],u*=o.width/r[0],c*=o.height/r[1]);var h=d+u,f=l-c,p=this.projectionMatrix;p[0]=2*e/(h-d),p[5]=2*e/(l-f),p[8]=(h+d)/(h-d),p[9]=(l+f)/(l-f),p[10]=-(n+e)/(n-e),p[11]=-1,p[14]=-2*n*e/(n-e),p[1]=p[2]=p[3]=p[4]=p[6]=p[7]=p[12]=p[13]=p[15]=0},t.prototype.correctViewAndSize=function(){var t=this.state,e=t.size,n=t.pitch,i=t.padding,r=Math.max(0,i.top-i.bottom)*Math.tan(n),o=v(e[1])+r,a={x:(i.right-i.left)/2,y:(i.bottom-i.top)/2,width:e[0],height:e[1]};return a.y+=(o-e[1])/2,{view:a,size:[e[0],o]}},t}();function I(t,e,n){return t=Math.max(t,e),Math.min(t,n)}function S(t){return t*Math.PI/180}function M(t,e){!function(t,e,n){t[0]=e,t[1]=n}(t,Math.cos(e)*t[0]-Math.sin(e)*t[1],Math.sin(e)*t[0]+Math.cos(e)*t[1])}function P(t,e){return Math.min(b(e[0],Math.abs(t.max[0]-t.min[0])),b(e[1],Math.abs(t.max[1]-t.min[1])))}function T(t,e,n){var i=function(t,e,n){if(0!==t.length){for(var i=S(e),r=d(),a=0,s=t;a<s.length;a++){var l=p(s[a]);M(l,-i),h(r,l)}var c,u,f=o();return u=r,(c=f)[0]=u.min[0]+(u.max[0]-u.min[0])/2,c[1]=u.min[1]+(u.max[1]-u.min[1])/2,M(f,i),{center:f,zoom:P(r,n)}}}(t,e,n);if(i)return{zoom:i.zoom,center:m(i.center)}}function k(t,e,n){var i=t.getBoundingClientRect();return[e-i.left-t.clientLeft,n-i.top-t.clientTop]}function L(t,e,n,i,r,o,a,s){return void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0}),new w({center:p(t),zoom:e,rotation:S(n),size:i,pitch:S(r),viewport:a,padding:s}).project(p(o))}function z(t,e,n,i,r,o,a,s){return void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0}),m(new w({center:p(t),zoom:e,rotation:S(n),size:i,pitch:S(r),viewport:a,padding:s}).unproject(o))}function E(t,e,n,i,r,o,a,s,l){return void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0}),function(t,e,n,i,r,o,a,s,l,c){void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0});var u=new w({center:p(t),zoom:e,rotation:S(n),size:i,pitch:S(r),viewport:a,padding:s}),d=m(u.unproject(o)),h=m(u.unproject([o[0]+l,o[1]+c]));return Math.max(1,y(d,h))}(t,e,n,i,r,o,a,s,l,l)}function C(t,e){return new w(t).project(e)}t.exports=n})()},925:t=>{self,t.exports=(()=>{"use strict";var t={103:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_lxLX8k02JhUZQLnJt5Mm {\n    font-family: Helvetica, Arial, sans-serif !important;\n    font-size: 8px !important;\n    line-height: 8px !important;\n    text-align: right !important;\n    display: flex;\n    align-items: flex-start;\n    color: #6d7173 !important;\n}\n\n.mapgl_AsSWrna6OS9VEoYItIZV {\n    display: block;\n}\n\na.mapgl_N4E6A6Wp5fYeXBf2QGWt {\n    color: #6d7173 !important;\n    text-decoration: none !important;\n}\n\na.mapgl_N4E6A6Wp5fYeXBf2QGWt:hover {\n    color: #929292 !important;\n}\n",""]),a.locals={container:"mapgl_lxLX8k02JhUZQLnJt5Mm",text:"mapgl_AsSWrna6OS9VEoYItIZV",link:"mapgl_N4E6A6Wp5fYeXBf2QGWt"};const s=a},274:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_SqprqBDt0m3ck8ImwnZ0 {\n    position: absolute;\n    pointer-events: none;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n}\n\n.mapgl_zXpm2Oitx3qOyLXwyVKj {\n    position: absolute;\n    display: flex;\n    z-index: 50;\n    pointer-events: none;\n    width: 100%;\n    height: 100%;\n}\n\n.mapgl_zXpm2Oitx3qOyLXwyVKj > div > * {\n    pointer-events: auto;\n}\n\n.mapgl_r_oD6okoyw2O0sKMERju {\n    flex-direction: column;\n    align-items: flex-start;\n}\n\n.mapgl_FmkgHxvqVart7hWj1dIm {\n    flex-direction: row;\n    justify-content: center;\n    align-items: flex-start;\n}\n\n.mapgl_OS0i93oEEcYSyKRHurat {\n    flex-direction: column;\n    align-items: flex-end;\n}\n\n.mapgl_BIfihGR7X9awnUFk62BQ {\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-start;\n}\n\n.mapgl_vpFke4npOo1b8whqwKPv {\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-end;\n}\n\n.mapgl_gLybMsoqNs2Phzvi6hS5 {\n    flex-direction: column-reverse;\n    align-items: flex-start;\n}\n\n.mapgl_GbiZTwfDOnlyI6flVbL_ {\n    flex-direction: row;\n    justify-content: center;\n    align-items: flex-end;\n}\n\n.mapgl_YoIqRTD9ccmcm_A81adk {\n    flex-direction: column-reverse;\n    align-items: flex-end;\n}\n\n.mapgl_r_oD6okoyw2O0sKMERju > div + div,\n.mapgl_OS0i93oEEcYSyKRHurat > div + div,\n.mapgl_BIfihGR7X9awnUFk62BQ > div + div,\n.mapgl_vpFke4npOo1b8whqwKPv > div + div {\n    margin-top: 10px;\n}\n\n.mapgl_gLybMsoqNs2Phzvi6hS5 > div + div,\n.mapgl_YoIqRTD9ccmcm_A81adk > div + div {\n    margin-bottom: 10px;\n}\n\n.mapgl_FmkgHxvqVart7hWj1dIm > div + div,\n.mapgl_GbiZTwfDOnlyI6flVbL_ > div + div {\n    margin-left: 10px;\n}\n",""]),a.locals={controlPane:"mapgl_SqprqBDt0m3ck8ImwnZ0",container:"mapgl_zXpm2Oitx3qOyLXwyVKj",topLeft:"mapgl_r_oD6okoyw2O0sKMERju",topCenter:"mapgl_FmkgHxvqVart7hWj1dIm",topRight:"mapgl_OS0i93oEEcYSyKRHurat",centerLeft:"mapgl_BIfihGR7X9awnUFk62BQ",centerRight:"mapgl_vpFke4npOo1b8whqwKPv",bottomLeft:"mapgl_gLybMsoqNs2Phzvi6hS5",bottomCenter:"mapgl_GbiZTwfDOnlyI6flVbL_",bottomRight:"mapgl_YoIqRTD9ccmcm_A81adk"};const s=a},306:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_T5RQQ2NOfnY3_e00os8n {\n    font-family: Helvetica, Arial, sans-serif !important;\n    font-size: 8px !important;\n    line-height: 8px !important;\n    text-align: right !important;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    color: #6d7173 !important;\n}\n\n.mapgl_h7bp68SOWSVBX9Orf9BN {\n    display: flex;\n    flex-direction: column;\n    padding-right: 4px;\n}\n\n.mapgl_fMmrF9RliMxNiObbmFUm {\n    display: flex;\n    flex-direction: row;\n}\n\n.mapgl_mIYahvUhOA0HDmHGtdtA {\n    animation: mapgl_mIUQLFgaHsaFSSZFHkpH 5s forwards;\n}\n\na.mapgl_rs_xxgfm2WZu987bybgD {\n    color: #6d7173 !important;\n    text-decoration: none !important;\n}\n\na.mapgl_rs_xxgfm2WZu987bybgD:hover {\n    color: #929292 !important;\n}\n@keyframes mapgl_mIUQLFgaHsaFSSZFHkpH {\n    85% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0;\n    }\n}\n",""]),a.locals={container:"mapgl_T5RQQ2NOfnY3_e00os8n",text:"mapgl_h7bp68SOWSVBX9Orf9BN",copyrights:"mapgl_fMmrF9RliMxNiObbmFUm",autoHide:"mapgl_mIYahvUhOA0HDmHGtdtA",hideAnimation:"mapgl_mIUQLFgaHsaFSSZFHkpH",link:"mapgl_rs_xxgfm2WZu987bybgD"};const s=a},704:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_ByGR_EaTxrFwgYplL9Rn {\n    position: relative;\n}\n\n.mapgl_rV7SBEVklXHee7q0ro4A {\n    display: flex;\n    max-height: 40vh;\n    background: #ffffff;\n    width: 32px;\n    overflow: hidden;\n    border-radius: 4px;\n    box-shadow: 0 1px 3px 0 rgba(38, 38, 38, 0.5);\n}\n\n.mapgl_eTkkBoRhhRCs7jEwQ2Wb {\n    width: 100%;\n    overflow-x: hidden;\n    overflow-y: auto;\n    -moz-padding-end: 17px;\n    -webkit-padding-end: 17px;\n    -webkit-margin-end: -17px;\n}\n\n.mapgl_gnVYSnZbzDyDuJqZz3mJ {\n    display: flex;\n    flex-direction: column-reverse;\n}\n\n.mapgl_zsd_0yR5qXs0D4rXioaV {\n    padding: 0;\n\n    border: none;\n    background: #ffffff;\n    height: 32px;\n    width: 32px;\n    color: #262626;\n    cursor: pointer;\n    border-bottom: 1px solid #e6e6e6;\n    box-sizing: border-box;\n    flex-shrink: 0;\n}\n.mapgl_zsd_0yR5qXs0D4rXioaV:focus {\n    outline: 0;\n}\n.mapgl_zsd_0yR5qXs0D4rXioaV:first-child {\n    border-bottom: none;\n}\n.mapgl_zsd_0yR5qXs0D4rXioaV:hover {\n    color: rgba(38, 38, 38, 0.7);\n}\n.mapgl_zsd_0yR5qXs0D4rXioaV:active {\n    color: #028eff;\n}\n.mapgl_zsd_0yR5qXs0D4rXioaV:disabled {\n    background: #f2f2f2;\n    color: #929292;\n    cursor: default;\n}\n\n.mapgl_IpWyhNkbWQBqP479eDE2 {\n    font-size: 18px;\n    line-height: 32px;\n    font-weight: 400;\n    overflow-wrap: break-word;\n\n    position: relative;\n    text-align: center;\n    height: 100%;\n}\n\n.mapgl_yUGrJifDT7VmwlUOKi8_:after {\n    content: '';\n    position: absolute;\n    top: 4px;\n    bottom: 4px;\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: #028eff;\n}\n",""]),a.locals={root:"mapgl_ByGR_EaTxrFwgYplL9Rn",container:"mapgl_rV7SBEVklXHee7q0ro4A",scroller:"mapgl_eTkkBoRhhRCs7jEwQ2Wb",content:"mapgl_gnVYSnZbzDyDuJqZz3mJ",control:"mapgl_zsd_0yR5qXs0D4rXioaV",label:"mapgl_IpWyhNkbWQBqP479eDE2",_hasResult:"mapgl_yUGrJifDT7VmwlUOKi8_"};const s=a},32:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_y5CSWkmzFZelEK3XsNPI {\n    background: rgba(255, 255, 255, 0.68);\n    border-width: 0 1px 1px 1px;\n    border-color: #7a7a7a;\n    border-style: solid;\n    border-radius: 0;\n    min-width: 64px;\n    height: 16px;\n    overflow: hidden;\n    pointer-events: none !important;\n}\n\n.mapgl_jEDrEoj7PBYIc0hBFCRq {\n    min-width: 50px;\n    height: 12px;\n    margin-top: 2px;\n    margin-left: 6px;\n    font-family: Helvetica, Arial, sans-serif !important;\n    font-style: normal;\n    font-weight: 400;\n    font-size: 9px;\n    line-height: 12px;\n\n    color: #262626;\n}\n",""]),a.locals={root:"mapgl_y5CSWkmzFZelEK3XsNPI",label:"mapgl_jEDrEoj7PBYIc0hBFCRq"};const s=a},928:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_XiKtyzV1PZ9N9z7NbBH0 {\n    background: #fff;\n    box-shadow: 0 1px 3px 0 rgba(38, 38, 38, 0.5);\n    border-radius: 4px;\n    width: 32px;\n    overflow: hidden;\n}\n\n.mapgl_TCECw1gCo4pPgxN8WlHv {\n    padding: 0;\n    outline: 0;\n    border: none;\n    cursor: pointer;\n    box-sizing: border-box;\n    font-size: 18px;\n    font-weight: 400;\n    width: 32px;\n    height: 32px;\n    color: #262626;\n    background: #fff;\n}\n\n.mapgl_aifLu_eH4oBoq5TCFEl1:hover {\n    opacity: 0.7;\n}\n\n.mapgl_AZeLf0JO9BdLfzixjszM {\n    background: #299400;\n    color: #fff;\n}\n.mapgl_g9fon0BTtGdnOX4Ce0gE {\n    background: #ffb81c;\n    color: #fff;\n}\n.mapgl_GDc542cVDcz8I8tKJtvz {\n    background: #fe5000;\n    color: #fff;\n}\n\n.mapgl_AZeLf0JO9BdLfzixjszM:hover,\n.mapgl_g9fon0BTtGdnOX4Ce0gE:hover,\n.mapgl_GDc542cVDcz8I8tKJtvz:hover {\n    color: rgba(38, 38, 38, 0.7);\n}\n",""]),a.locals={root:"mapgl_XiKtyzV1PZ9N9z7NbBH0",button:"mapgl_TCECw1gCo4pPgxN8WlHv",none:"mapgl_aifLu_eH4oBoq5TCFEl1",easy:"mapgl_AZeLf0JO9BdLfzixjszM",medium:"mapgl_g9fon0BTtGdnOX4Ce0gE",hard:"mapgl_GDc542cVDcz8I8tKJtvz"};const s=a},585:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_RyvsmCnoVe7ui2MClLMS {\n    width: 32px;\n    box-shadow: 0 1px 3px 0 rgba(38, 38, 38, 0.5);\n    border-radius: 4px;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    background: #fff;\n}\n\n.mapgl_Tdw0Vs7iQuaknNHHD21k {\n    padding: 0;\n    outline: 0;\n    border: none;\n    cursor: pointer;\n\n    background: #fff;\n    width: 32px;\n    height: 32px;\n    color: #262626;\n    box-sizing: border-box;\n}\n\n.mapgl_Tdw0Vs7iQuaknNHHD21k:hover {\n    opacity: 0.7;\n}\n\n.mapgl_Tdw0Vs7iQuaknNHHD21k:active {\n    color: #028eff;\n}\n\n.mapgl_Tdw0Vs7iQuaknNHHD21k:disabled {\n    background: #f2f2f2;\n    color: #929292;\n    cursor: default;\n}\n\n.mapgl_JwF7YmgOItTjpjwxORCk {\n    border-bottom: 1px solid #e6e6e6;\n}\n\n.mapgl_Tvr6BDuVyr8143cFJ4nJ {\n    border-bottom: none;\n}\n",""]),a.locals={root:"mapgl_RyvsmCnoVe7ui2MClLMS",button:"mapgl_Tdw0Vs7iQuaknNHHD21k",zoomIn:"mapgl_JwF7YmgOItTjpjwxORCk",zoomOut:"mapgl_Tvr6BDuVyr8143cFJ4nJ"};const s=a},438:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(276),r=n.n(i),o=n(368),a=n.n(o)()(r());a.push([t.id,".mapgl_Zqe1f2Ik8_MdehkwZiwo {\n    pointer-events: none;\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 10px;\n    background-color: rgba(0, 0, 0, 0.2);\n    cursor: default;\n}\n\n.mapgl_RBLYLi7mJFgKIKMPLvv_ {\n    text-align: center;\n    font-size: 24px;\n    font-family: Helvetica, Arial, sans-serif;\n    font-weight: bold;\n    color: white;\n}\n",""]),a.locals={wrap:"mapgl_Zqe1f2Ik8_MdehkwZiwo",container:"mapgl_RBLYLi7mJFgKIKMPLvv_"};const s=a},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},a=[],s=0;s<t.length;s++){var l=t[s],c=i.base?l[0]+i.base:l[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var h=n(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)e[h].references++,e[h].updater(f);else{var p=r(f,i);i.byIndex=s,e.splice(s,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var l=i(t,r),c=0;c<o.length;c++){var u=n(o[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3:t=>{self,t.exports=function(){var t={3704:function(t,e){!function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<t.length;i++)n[t.charCodeAt(i)]=i;e.c=function(e){var n,i=new Uint8Array(e),r=i.length,o="";for(n=0;n<r;n+=3)o+=t[i[n]>>2],o+=t[(3&i[n])<<4|i[n+1]>>4],o+=t[(15&i[n+1])<<2|i[n+2]>>6],o+=t[63&i[n+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}}()},3431:function(t){var e=.1,n="function"==typeof Float32Array;function i(t,e){return 1-3*e+3*t}function r(t,e){return 3*e-6*t}function o(t){return 3*t}function a(t,e,n){return((i(e,n)*t+r(e,n))*t+o(e))*t}function s(t,e,n){return 3*i(e,n)*t*t+2*r(e,n)*t+o(e)}function l(t){return t}t.exports=function(t,i,r,o){if(!(0<=t&&t<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===i&&r===o)return l;for(var c=n?new Float32Array(11):new Array(11),u=0;u<11;++u)c[u]=a(u*e,t,r);function d(n){for(var i=0,o=1;10!==o&&c[o]<=n;++o)i+=e;--o;var l=i+(n-c[o])/(c[o+1]-c[o])*e,u=s(l,t,r);return u>=.001?function(t,e,n,i){for(var r=0;r<4;++r){var o=s(e,n,i);if(0===o)return e;e-=(a(e,n,i)-t)/o}return e}(n,l,t,r):0===u?l:function(t,e,n,i,r){var o,s,l=0;do{(o=a(s=e+(n-e)/2,i,r)-t)>0?n=s:e=s}while(Math.abs(o)>1e-7&&++l<10);return s}(n,i,i+e,t,r)}return function(t){return 0===t?0:1===t?1:a(d(t),i,o)}}},187:function(t,e,n){n.d(e,{Z:function(){return s}});var i=n(8081),r=n.n(i),o=n(3645),a=n.n(o)()(r());a.push([t.id,".mapgl-hover {\n    cursor: pointer;\n}\n\n.mapgl-dragging {\n    cursor: grabbing;\n}\n\n.mapgl-rotating {\n    cursor: move;\n}\n",""]);var s=a},3645:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&a[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},8081:function(t){t.exports=function(t){return t[1]}},9187:function(t){function e(t,e,o){o=o||2;var a,s,l,d,h,p,m,v=e&&e.length,_=v?e[0]*o:t.length,y=n(t,0,_,o,!0),g=[];if(!y||y.next===y.prev)return g;if(v&&(y=function(t,e,r,o){var a,s,l,d=[];for(a=0,s=e.length;a<s;a++)(l=n(t,e[a]*o,a<s-1?e[a+1]*o:t.length,o,!1))===l.next&&(l.steiner=!0),d.push(f(l));for(d.sort(c),a=0;a<d.length;a++)r=i(r=u(d[a],r),r.next);return r}(t,e,y,o)),t.length>80*o){a=l=t[0],s=d=t[1];for(var b=o;b<_;b+=o)(h=t[b])<a&&(a=h),(p=t[b+1])<s&&(s=p),h>l&&(l=h),p>d&&(d=p);m=0!==(m=Math.max(l-a,d-s))?1/m:0}return r(y,g,o,a,s,m),g}function n(t,e,n,i,r){var o,a;if(r===P(t,e,n,i)>0)for(o=e;o<n;o+=i)a=I(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=I(o,t[o],t[o+1],a);return a&&_(a,a.next)&&(S(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!_(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,c,u,d,f){if(t){!f&&d&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=h(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1)}(r)}(t,c,u,d);for(var p,m,v=t;t.prev!==t.next;)if(p=t.prev,m=t.next,d?a(t,c,u,d):o(t))e.push(p.i/n),e.push(t.i/n),e.push(m.i/n),S(t),t=m.next,v=m.next;else if((t=m)===v){f?1===f?r(t=s(i(t),e,n),e,n,c,u,d,2):2===f&&l(t,e,n,c,u,d):r(i(t),e,n,c,u,d,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(v(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(p(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&v(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function a(t,e,n,i){var r=t.prev,o=t,a=t.next;if(v(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,d=h(s,l,e,n,i),f=h(c,u,e,n,i),m=t.prevZ,_=t.nextZ;m&&m.z>=d&&_&&_.z<=f;){if(m!==t.prev&&m!==t.next&&p(r.x,r.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,_!==t.prev&&_!==t.next&&p(r.x,r.y,o.x,o.y,a.x,a.y,_.x,_.y)&&v(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;m&&m.z>=d;){if(m!==t.prev&&m!==t.next&&p(r.x,r.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;_&&_.z<=f;){if(_!==t.prev&&_!==t.next&&p(r.x,r.y,o.x,o.y,a.x,a.y,_.x,_.y)&&v(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function s(t,e,n){var r=t;do{var o=r.prev,a=r.next.next;!_(o,a)&&y(o,r,r.next,a)&&x(o,a)&&x(a,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(a.i/n),S(r),S(r.next),r=t=a),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,a,s){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&m(l,c)){var u=w(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,e,n,o,a,s),void r(u,e,n,o,a,s)}c=c.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n;var l,c=n,u=n.x,h=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&p(o<h?r:a,o,u,h,o<h?a:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),x(i,t)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,f=l)),i=i.next}while(i!==c);return n}(t,e);if(!n)return e;var r=w(n,t),o=i(n,n.next);return i(r,r.next),e===n?o:e}function d(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function h(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||_(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,i){var r=b(v(t,e,n)),o=b(v(t,e,i)),a=b(v(n,i,t)),s=b(v(n,i,e));return r!==o&&a!==s||!(0!==r||!g(t,n,e))||!(0!==o||!g(t,i,e))||!(0!==a||!g(n,t,i))||!(0!==s||!g(n,e,i))}function g(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function x(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function w(t,e){var n=new M(t.i,t.x,t.y),i=new M(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function I(t,e,n,i){var r=new M(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(P(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var c=e[s]*n,u=s<l-1?e[s+1]*n:t.length;a-=Math.abs(P(t,c,u,n))}var d=0;for(s=0;s<i.length;s+=3){var h=i[s]*n,f=i[s+1]*n,p=i[s+2]*n;d+=Math.abs((t[h]-t[p])*(t[f+1]-t[h+1])-(t[h]-t[f])*(t[p+1]-t[h+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},645:function(t,e){e.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?r-1:0,h=n?-1:1,f=t[e+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+t[e+d],d+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+t[e+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=c}return(f?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var a,s,l,c=8*o-r-1,u=(1<<c)-1,d=u>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,p=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(e*l-1)*Math.pow(2,r),a+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=255&s,f+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;t[n+f]=255&a,f+=p,a/=256,c-=8);t[n+f-p]|=128*m}},3614:function(t,e,n){t.exports=r;var i=n(645);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var o=4294967296,a=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function c(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function d(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function _(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function x(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=b(this.buf,this.pos)+b(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=b(this.buf,this.pos)+w(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return c(t,i,e);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return c(t,i,e);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return c(t,i,e);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return c(t,i,e);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return c(t,i,e);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return c(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&s?function(t,e,n){return s.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var o,a,s,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[r+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&((c=(15&l)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var n=l(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*a),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*a),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&u(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&u(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,_,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,g,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},8166:function(t){t.exports=function(){function t(n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*u/s+d)),Math.min(o,Math.floor(i+(s-l)*u/s+d)),a)}var h=n[i],f=r,p=o;for(e(n,r,i),a(n[o],h)>0&&e(n,r,o);f<p;){for(e(n,f,p),f++,p--;a(n[f],h)<0;)f++;for(;a(n[p],h)>0;)p--}0===a(n[r],h)?e(n,r,p):e(n,++p,o),p<=i&&(r=p+1),i<=p&&(o=p-1)}}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}return function(e,i,r,o,a){t(e,i,r||0,o||e.length-1,a||n)}}()},5510:function(t,e,n){t.exports=r,t.exports.default=r;var i=n(8166);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],l(r,t.leaf?i(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function d(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,r,o){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=r||(a=e+Math.ceil((n-e)/r/2)*r,i(t,a,e,n,o),s.push(e,a,a,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,o,a,s,l=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],p(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):f(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],p(t,a=e.leaf?n(o):o)){if(e.leaf||f(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,a,s=this.data,l=this.toBBox(t),c=[],u=[];s||c.length;){if(s||(s=c.pop(),i=c[c.length-1],n=u.pop(),a=!0),s.leaf&&-1!==(r=o(t,s.children,e)))return s.children.splice(r,1),c.push(s),this._condense(c),this;a||s.leaf||!f(s,l)?i?(n++,s=i.children[n],a=!1):s=null:(c.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return a(r=m(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=m([])).leaf=!1,r.height=i;var l,c,u,d,h=Math.ceil(o/s),f=h*Math.ceil(Math.sqrt(s));for(v(t,e,n,f,this.compareMinX),l=e;l<=n;l+=f)for(v(t,l,u=Math.min(l+f-1,n),h,this.compareMinY),c=l;c<=u;c+=h)d=Math.min(c+h-1,u),r.children.push(this._build(t,c,d,i-1));return a(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,l,c,u,h,f,p;i.push(e),!e.leaf&&i.length-1!==n;){for(u=h=1/0,r=0,o=e.children.length;r<o;r++)l=d(a=e.children[r]),f=t,p=a,(c=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<h?(h=c,u=l<u?l:u,s=a):c===h&&l<u&&(u=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),l(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=m(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,a,l,c,u,h,f,p,m,v,_,y;for(c=u=1/0,i=e;i<=n-e;i++)f=r=s(t,0,i,this.toBBox),p=o=s(t,i,n,this.toBBox),m=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),_=Math.min(f.maxX,p.maxX),y=Math.min(f.maxY,p.maxY),a=Math.max(0,_-m)*Math.max(0,y-v),l=d(r)+d(o),a<c?(c=a,h=i,u=l<u?l:u):a===c&&l<u&&(u=l,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:c,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,a=this.toBBox,c=s(t,0,e,a),u=s(t,n-e,n,a),d=h(c)+h(u);for(r=e;r<n-e;r++)o=t.children[r],l(c,t.leaf?a(o):o),d+=h(c);for(r=n-e-1;r>=e;r--)o=t.children[r],l(u,t.leaf?a(o):o),d+=h(u);return d},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},3379:function(t){var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},a=[],s=0;s<t.length;s++){var l=t[s],c=i.base?l[0]+i.base:l[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var h=n(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)e[h].references++,e[h].updater(f);else{var p=r(f,i);i.byIndex=s,e.splice(s,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var l=i(t,r),c=0;c<o.length;c++){var u=n(o[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=l}}},569:function(t){var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:function(t,e,n){t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:function(t){t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},7322:function(t,e,n){n.d(e,{Z:function(){return r}});var i=function(){function t(e,n){this._initData=e,this.byteLength=void 0!==e.byteLength?e.byteLength:e,this.type=t.ArrayBuffer,this.drawType=t.StaticDraw,this.options=Object.assign({},t.defaultOptions,n),this._glBuffer=null,this._glContext=null}return t.prototype.bind=function(e,n,i){return this._glBuffer||this.prepare(e),this.type===t.ArrayBuffer?(e.bindBuffer(e.ARRAY_BUFFER,this._glBuffer),i=i||this.options,e.vertexAttribPointer(n,i.itemSize,this._toGlParam(e,i.dataType),i.normalized,i.stride,i.offset)):this.type===t.ElementArrayBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer),this},t.prototype.remove=function(){return this._unprepare(),this},t.prototype.subData=function(t,e,n){return t.bindBuffer(this._toGlParam(t,this.type),this._glBuffer),t.bufferSubData(this._toGlParam(t,this.type),e,n),this},t.prototype.prepare=function(t){return this._glContext=t,this._glBuffer=t.createBuffer(),t.bindBuffer(this._toGlParam(t,this.type),this._glBuffer),t.bufferData(this._toGlParam(t,this.type),this._initData,this._toGlParam(t,this.drawType)),this._initData=null,this},t.prototype._unprepare=function(){this._glBuffer&&(this._glContext.deleteBuffer(this._glBuffer),this._glBuffer=null,this._glContext=null)},t.prototype._toGlParam=function(e,n){return n===t.ArrayBuffer?e.ARRAY_BUFFER:n===t.ElementArrayBuffer?e.ELEMENT_ARRAY_BUFFER:n===t.StaticDraw?e.STATIC_DRAW:n===t.DynamicDraw?e.DYNAMIC_DRAW:n===t.Byte?e.BYTE:n===t.Short?e.SHORT:n===t.Int?e.INT:n===t.Float?e.FLOAT:n===t.UnsignedByte?e.UNSIGNED_BYTE:n===t.UnsignedShort?e.UNSIGNED_SHORT:n===t.UnsignedInt?e.UNSIGNED_INT:null},t}();i.ArrayBuffer=1,i.ElementArrayBuffer=2,i.StaticDraw=10,i.DynamicDraw=11,i.Float=20,i.UnsignedByte=21,i.UnsignedShort=22,i.UnsignedInt=23,i.Byte=24,i.Short=25,i.Int=26,i.defaultOptions={itemSize:3,dataType:i.Float,stride:0,offset:0,normalized:!1};var r=i},3287:function(t,e,n){n.d(e,{Ib:function(){return i},WT:function(){return r}});var i=1e-6,r="undefined"!=typeof Float64Array?Float64Array:Array;Math.random,Math.PI},127:function(t,e,n){n.d(e,{Ue:function(){return r},JG:function(){return o},p4:function(){return a},U_:function(){return s},Jp:function(){return l},Iu:function(){return c},bA:function(){return u},Iw:function(){return d},G3:function(){return h},M5:function(){return f},zB:function(){return p},dC:function(){return m},wA:function(){return v}});var i=n(3287);function r(){var t=new i.WT(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],v=e[14],_=e[15],y=n*s-i*a,g=n*l-r*a,b=n*c-o*a,x=i*l-r*s,w=i*c-o*s,I=r*c-o*l,S=u*m-d*p,M=u*v-h*p,P=u*_-f*p,T=d*v-h*m,k=d*_-f*m,L=h*_-f*v,z=y*L-g*k+b*T+x*P-w*M+I*S;return z?(z=1/z,t[0]=(s*L-l*k+c*T)*z,t[1]=(r*k-i*L-o*T)*z,t[2]=(m*I-v*w+_*x)*z,t[3]=(h*w-d*I-f*x)*z,t[4]=(l*P-a*L-c*M)*z,t[5]=(n*L-r*P+o*M)*z,t[6]=(v*b-p*I-_*g)*z,t[7]=(u*I-h*b+f*g)*z,t[8]=(a*k-s*P+c*S)*z,t[9]=(i*P-n*k-o*S)*z,t[10]=(p*w-m*b+_*y)*z,t[11]=(d*b-u*w-f*y)*z,t[12]=(s*M-a*T-l*S)*z,t[13]=(n*T-i*M+r*S)*z,t[14]=(m*g-p*x-v*y)*z,t[15]=(u*x-d*g+h*y)*z,t):null}function l(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=n[0],b=n[1],x=n[2],w=n[3];return t[0]=g*i+b*s+x*d+w*m,t[1]=g*r+b*l+x*h+w*v,t[2]=g*o+b*c+x*f+w*_,t[3]=g*a+b*u+x*p+w*y,g=n[4],b=n[5],x=n[6],w=n[7],t[4]=g*i+b*s+x*d+w*m,t[5]=g*r+b*l+x*h+w*v,t[6]=g*o+b*c+x*f+w*_,t[7]=g*a+b*u+x*p+w*y,g=n[8],b=n[9],x=n[10],w=n[11],t[8]=g*i+b*s+x*d+w*m,t[9]=g*r+b*l+x*h+w*v,t[10]=g*o+b*c+x*f+w*_,t[11]=g*a+b*u+x*p+w*y,g=n[12],b=n[13],x=n[14],w=n[15],t[12]=g*i+b*s+x*d+w*m,t[13]=g*r+b*l+x*h+w*v,t[14]=g*o+b*c+x*f+w*_,t[15]=g*a+b*u+x*p+w*y,t}function c(t,e,n){var i,r,o,a,s,l,c,u,d,h,f,p,m=n[0],v=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=d,t[9]=h,t[10]=f,t[11]=p,t[12]=i*m+s*v+d*_+e[12],t[13]=r*m+l*v+h*_+e[13],t[14]=o*m+c*v+f*_+e[14],t[15]=a*m+u*v+p*_+e[15]),t}function u(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function d(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3],l=r+r,c=o+o,u=a+a,d=r*l,h=r*c,f=r*u,p=o*c,m=o*u,v=a*u,_=s*l,y=s*c,g=s*u,b=i[0],x=i[1],w=i[2];return t[0]=(1-(p+v))*b,t[1]=(h+g)*b,t[2]=(f-y)*b,t[3]=0,t[4]=(h-g)*x,t[5]=(1-(d+v))*x,t[6]=(m+_)*x,t[7]=0,t[8]=(f+y)*w,t[9]=(m-_)*w,t[10]=(1-(d+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function h(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t}function f(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*c,t[15]=1,t}function p(t,e,n,r){var o,a,s,l,c,u,d,h,f,p,m=e[0],v=e[1],_=e[2],y=r[0],g=r[1],b=r[2],x=n[0],w=n[1],I=n[2];return Math.abs(m-x)<i.Ib&&Math.abs(v-w)<i.Ib&&Math.abs(_-I)<i.Ib?mat4.identity(t):(d=m-x,h=v-w,f=_-I,o=g*(f*=p=1/Math.sqrt(d*d+h*h+f*f))-b*(h*=p),a=b*(d*=p)-y*f,s=y*h-g*d,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0),l=h*s-f*a,c=f*o-d*s,u=d*a-h*o,(p=Math.sqrt(l*l+c*c+u*u))?(l*=p=1/p,c*=p,u*=p):(l=0,c=0,u=0),t[0]=o,t[1]=l,t[2]=d,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=f,t[11]=0,t[12]=-(o*m+a*v+s*_),t[13]=-(l*m+c*v+u*_),t[14]=-(d*m+h*v+f*_),t[15]=1,t)}var m=l;function v(t,e,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}},378:function(t,e,n){n.d(e,{Ue:function(){return r},d9:function(){return o},al:function(){return a},JG:function(){return s},t8:function(){return l},IH:function(){return c},$X:function(){return u},VV:function(){return d},Fp:function(){return h},bA:function(){return f},TE:function(){return p},kE:function(){return m},Fv:function(){return v},AK:function(){return _},t7:function(){return y},I6:function(){return g},fS:function(){return b},Zh:function(){return x},lu:function(){return w},TK:function(){return I}});var i=n(3287);function r(){var t=new i.WT(2);return t[0]=0,t[1]=0,t}function o(t){var e=new i.WT(2);return e[0]=t[0],e[1]=t[1],e}function a(t,e){var n=new i.WT(2);return n[0]=t,n[1]=e,n}function s(t,e){return t[0]=e[0],t[1]=e[1],t}function l(t,e,n){return t[0]=e,t[1]=n,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function u(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function d(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function h(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function f(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function p(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)}function m(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function v(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t}function _(t,e){return t[0]*e[0]+t[1]*e[1]}function y(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function g(t,e){return t[0]===e[0]&&t[1]===e[1]}function b(t,e){var n=t[0],r=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=i.Ib*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i.Ib*Math.max(1,Math.abs(r),Math.abs(a))}var x=m,w=u,I=p;r()},9450:function(t,e,n){n.d(e,{Ue:function(){return r},d9:function(){return o},kE:function(){return a},al:function(){return s},JG:function(){return l},t8:function(){return c},IH:function(){return u},VV:function(){return d},Fp:function(){return h},bA:function(){return f},od:function(){return p},Fv:function(){return m},AK:function(){return v},kC:function(){return _},t7:function(){return y},fF:function(){return g},kK:function(){return b},I6:function(){return x},fS:function(){return w},lu:function(){return I},TK:function(){return S},Zh:function(){return M}});var i=n(3287);function r(){var t=new i.WT(3);return t[0]=0,t[1]=0,t[2]=0,t}function o(t){var e=new i.WT(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function s(t,e,n){var r=new i.WT(3);return r[0]=t,r[1]=e,r[2]=n,r}function l(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function d(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function h(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function f(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function p(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function m(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function v(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=r*l-o*s,t[1]=o*a-i*l,t[2]=i*s-r*a,t}function y(t,e,n,i){var r=e[0],o=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t}function g(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,t}function b(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function x(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function w(t,e){var n=t[0],r=t[1],o=t[2],a=e[0],s=e[1],l=e[2];return Math.abs(n-a)<=i.Ib*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=i.Ib*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=i.Ib*Math.max(1,Math.abs(o),Math.abs(l))}var I=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},S=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)},M=a;r()},1245:function(t,e,n){n.d(e,{d9:function(){return o},al:function(){return a},JG:function(){return s},t8:function(){return l},IH:function(){return c},bA:function(){return u},kE:function(){return d},we:function(){return h},Fv:function(){return f},AK:function(){return p},t7:function(){return m},I6:function(){return v},fS:function(){return _}});var i,r=n(3287);function o(t){var e=new r.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(t,e,n,i){var o=new r.WT(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function l(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function d(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)}function h(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function f(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function m(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t[3]=s+i*(n[3]-s),t}function v(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function _(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],l=e[1],c=e[2],u=e[3];return Math.abs(n-s)<=r.Ib*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=r.Ib*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=r.Ib*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-u)<=r.Ib*Math.max(1,Math.abs(a),Math.abs(u))}(i=new r.WT(4))[0]=0,i[1]=0,i[2]=0,i[3]=0},1026:function(t,e,n){n.r(e),n.d(e,{MAP_DEFAULTS:function(){return a},tiles:function(){return s},hillshade:function(){return l},commercialPoi:function(){return c},modelCacheSize:function(){return u},loadModelsInfoStyleZoom:function(){return d},atlasSize:function(){return h},urls:function(){return f},traffic:function(){return p},fonts:function(){return m},icons:function(){return v},styles:function(){return _},events:function(){return y},analytics:function(){return g},workerResetDebounceTime:function(){return b},houseHover:function(){return x},tileAnimation:function(){return w},buildingAnimation:function(){return I},entranceAnimation:function(){return S},identify:function(){return M},labeling:function(){return P},render:function(){return T},defaultLang:function(){return k},zoom:function(){return L},inertia:function(){return z},camera:function(){return E},floors:function(){return C},fences:function(){return A},performanceCheck:function(){return D},commercialCitySublayers:function(){return R},commercialSublayers:function(){return O},personalSublayers:function(){return F},landmarkPoiSublayers:function(){return B},landmarkRasterSizes:function(){return j},defaultMarkerIcon:function(){return Z},defaultMarkerAnchor:function(){return U}});var i=n(655),r=n(8249),o=n(9099),a={minZoom:2,maxZoom:20},s={protocol:"https",server:o.X,subdomains:"0123",tileSet:r.X?"web":"vector_b",tileKey:"empty",appId:"empty",cacheRatio:2,maxUniverseZoom:8,maxRegionalZoom:15,maxDetailLevel:17,displayBounds:!1},l={minZoom:5,maxZoom:11},c={minZoom:10,maxZoom:14,tileSet:"com_poi_web",rasterSizes:[96,84,72,60,48,36,24]},u=100,d=13.5,h=[2048,2048],f={tiles:"{protocol}://{host}/vt?r={request}&ts={tileSet}&key={tileKey}&appId={appId}&lang={lang}&default_lang={defaultLang}&s={sessionId}",metatile:"{protocol}://{host}/metafiles/{hash}/metatile.json?ts={tileSet}",modelInfo:"{protocol}://{host}/metafiles/{regionId}/models.json?ts={tileSet}",model:"{protocol}://{host}/metafiles/{regionId}/{name}?ts={tileSet}",convertData:"{protocol}://{host}/metafiles/{hash}/convert.json?ts={tileSet}",dynamicPoi:"{protocol}://{host}/metafiles/{regionId}/poi/{id}_{width}_{height}.png?ts={tileSet}"},p={protocol:"https",host:o._A,url:"{protocol}://{host}/tiles?tls={tiles}&reg={regions}&tm={time}&fmt=json&z={z}",timestampUrl:"{protocol}://{host}/meta?reg={regions}&time&score",updateInterval:12e4,minZoom:10,maxZoom:16,maxDetailLevel:17},m={defaultUrl:o.hs,gamma:.08,baseSize:24,baseLineHeight:1.2,bomCharCode:65279},v={defaultUrl:o.R_,nameTemplate:"{name}"},_={url:o.k1,path:"styles/{id}"},y={doubleClickTime:185,dragThreshold:2,pitchWaitingTime:200,pitchThreshold:7},g={gaCode:"UA-25529177-4",gaName:"mapglEngine"},b=3e3,x={inAnimationTime:180,inAnimationType:"linear",outAnimationTime:800,outAnimationType:"linear"},w={time:300,type:"linear"},I={minStyleZoom:16,duration:500,easing:"easeOutQuint"},S={bounceType:"easeOutElastic",bounceTime:750,growType:"easeInOutQuad",growTime:750,stagger:0},M={pixelDensity:.5,sceneOpacity:0,cacheDebounceTime:400,pickDistance:3},P={interval:220,animationTime:200,animationType:"linear",tileMultiplier:1.5,axisAngleToleranceDeg:45,axisCheckDistancePx:13,commercialMargins:{default:{topBottom:60,leftRight:60},city:{topBottom:500,leftRight:500}},lineLabelsHidePitchDeg:40,maxLabelLength:30},T={alwaysRerender:!1},k="en",L={mouseDelta:.65,macTouchDelta:.0018,animDuration:400,throttleDelay:100,mouseRotateDelta:2.5,mousePitchDelta:2.5,mobilePinchDelta:1,mobileTapDelta:10},z={duration:1300,maxSpeed:8,minSpeed:.02,nonLinearity:5},E={fov:60,near:1e3,far:Math.pow(2,34),minCalculationScreenHeight:1e3,viewportLimitRatio:2},C={enabled:!0,url:o.kv,displayStyleZoom:17,wallHeight:800,islandHeight:400,wallMinBrightness:.8265,wallMaxBrightness:.95,viewportPadding:.2},A={lightIntensity:.1},D={fpsCaveat:10},R=["Commercial_poi_city"],O=(0,i.ev)(["Commercial_poi_default","Commercial_poi_custom","Commercial_poi_navi"],R,!0),F=["s_personal_poi"],B=["Landmark_poi","Landmark_point"],j=[105,84,63,42,21],Z="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSI0OHB4IiB2aWV3Qm94PSIwIDAgMzAgNDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1MS4yICg1NzUxOSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+PHRpdGxlPlBhZ2UgMSBDb3B5PC90aXRsZT48ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz48ZGVmcz48bGluZWFyR3JhZGllbnQgeDE9IjUwJSIgeTE9IjUwJSIgeDI9IjUwJSIgeTI9IjAlIiBpZD0ibGluZWFyR3JhZGllbnQtMSI+PHN0b3Agc3RvcC1jb2xvcj0iIzFCODlFRSIgb2Zmc2V0PSIwJSI+PC9zdG9wPjxzdG9wIHN0b3AtY29sb3I9IiMzMTk4RUMiIG9mZnNldD0iMTAwJSI+PC9zdG9wPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGlkPSJSZWNvdmVyeS0wMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTgzOS4wMDAwMDAsIC00MjUuMDAwMDAwKSI+PGcgaWQ9IlBhZ2UtMS1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MzkuMDAwMDAwLCA0MjUuMDAwMDAwKSI+PGVsbGlwc2UgaWQ9Ik92YWwtMyIgZmlsbD0iIzAwMDAwMCIgb3BhY2l0eT0iMC4wMzYzODA1OTciIGN4PSIxNSIgY3k9IjQ1LjUiIHJ4PSIzIiByeT0iMS41Ij48L2VsbGlwc2U+PGVsbGlwc2UgaWQ9Ik92YWwtMy1Db3B5IiBmaWxsPSIjMDAwMDAwIiBvcGFjaXR5PSIwLjAzNjM4MDU5NyIgY3g9IjE1IiBjeT0iNDUuNSIgcng9IjQuNSIgcnk9IjIuNSI+PC9lbGxpcHNlPjxwYXRoIGQ9Ik0xNSw0NS44ODM2MzUzIEwxNS44ODIzNTI5LDQ1Ljg4MzYzNTMgQzE1Ljg4MjM1MjksMjkuMjE3NzUyOSAyMC43NzY3NjQ3LDIzLjc5NzQ1ODggMjcuOTg3MzUyOSwyMy43OTc0NTg4IEwyOC4zMjk3MDU5LDIzLjc5NzQ1ODggQzI5LjA3Nzk0MTIsMjEuNTkwNjk0MSAzMCwxNy45OTE1NzY1IDMwLDE1LjAwMDQgQzMwLDcuMTQzOTI5NDEgMjMuNzY3OTQxMiwwLjAwMDQgMTUsMC4wMDA0IEM2LjIzMjA1ODgyLDAuMDAwNCAwLDcuMTQzOTI5NDEgMCwxNS4wMDA0IEMwLDE3Ljk5MTU3NjUgMC45MjIwNTg4MjQsMjEuNTkwNjk0MSAxLjY3MDI5NDEyLDIzLjc5NzQ1ODggTDIuMDEyNjQ3MDYsMjMuNzk3NDU4OCBDOS4yMjQxMTc2NSwyMy43OTc0NTg4IDE0LjExNzY0NzEsMjkuMjE3NzUyOSAxNC4xMTc2NDcxLDQ1Ljg4MzYzNTMgTDE1LDQ1Ljg4MzYzNTMgWiIgaWQ9IkZpbGwtMSIgZmlsbD0idXJsKCNsaW5lYXJHcmFkaWVudC0xKSI+PC9wYXRoPjwvZz48L2c+PC9nPjwvc3ZnPg==",U=[15,43]},8249:function(t,e,n){n.d(e,{X:function(){return i}});var i=!1},9099:function(t,e,n){n.d(e,{X:function(){return r},_A:function(){return o},kv:function(){return a},k1:function(){return s},hs:function(){return l},R_:function(){return c},ns:function(){return u},k0:function(){return d},aT:function(){return h}});var i=n(8249),r=i.X?"%TILESERVER%":"tile{subdomain}.maps.2gis.com",o=i.X?"%TRAFFICSERVER%":"jam.api.2gis.com",a=i.X?"%FLOORSSERVER%":"https://floors.api.2gis.ru",s="https://styles.api.2gis.com",l="https://mapgl.2gis.com/api/fonts",c="https://disk.2gis.com/styles/{id}",u=i.X?"%KEYSERVER%":"https://keys.api.2gis.com/public/v1/keys/{keyID}/services/mapgl-js-api",d=i.X?"%RTLPLUGIN%":"https://mapgl.2gis.com/api/js/plugins/rtl-v1.0.0.js",h=i.X?"%RTLPLUGINHASH%":"sha512-YAPPEl+Atvsm/cMkrfWefmlQLAlKTGaqFjIkI6urAnDgam2uTVEVVnZZEhHCa91JjYYxa5yr4Ndb4Vl3NUovfA=="},242:function(t,e,n){n.d(e,{y4:function(){return i},sX:function(){return r},_9:function(){return o},Bq:function(){return a},LF:function(){return s},$U:function(){return l},Cd:function(){return c},Gt:function(){return u},Rw:function(){return d},vL:function(){return h},Fv:function(){return f},p7:function(){return p},Uo:function(){return m},Hg:function(){return v},CW:function(){return _},DL:function(){return y},L2:function(){return g}});var i=256,r=Math.pow(2,32),o=Math.pow(2,20),a=Math.pow(2,16)-1,s=2.54,l=96,c=r/(i/l*s),u=.7071067811865475,d=4294967295,h=1175494351e-47,f=3402823466e29,p=["Arial","Helvetica","HelveticaNeueCyr","Open_Sans","Open_Sans_Semibold","Open_Sans_Italic","Segoe_UI","PT_Sans_Caption","PT_Sans","Verdana","Verdana_bold","Noto_Sans","Noto_Sans_Semibold","Noto_Sans_Italic","SuisseIntl_Bold"],m="Noto_Sans",v=1,_=v/2,y=-3,g=-4},3936:function(t,e,n){n.d(e,{jf:function(){return u},FJ:function(){return m},hX:function(){return v}});var i=n(2267),r=n(5109),o=n(242),a=n(8550),s=n(9266),l=n(9746),c=n(2241),u=0,d={type:i.f.Static,index:-1,key:(0,a.fF)("",.5,.5),isSvg:!1,name:"",fileName:"",rasters:[],anchorX:.5,anchorY:.5},h=["default","marker","markerText","htmlLabel"],f={default:0,marker:1,markerText:2,htmlLabel:3},p={default:{default:!0,marker:!1,markerText:!0,htmlLabel:!0},marker:{default:!1,marker:!1,markerText:!0,htmlLabel:!1},markerText:{default:!0,marker:!0,markerText:!0,htmlLabel:!1},htmlLabel:{default:!0,marker:!1,markerText:!1,htmlLabel:!1}};function m(t){for(var e=[],n=Object.keys(r.Dz).length,i=0;i<n;i++)e[i]=NaN;for(var o in t){if(void 0===r.Dz[o])throw new Error("No such tile prop '".concat(o,"'"));e[r.Dz[o]]=t[o]}return e}var v=function(){function t(){this.style={id:u,revision:0,background:{color:(0,c.MV)("f6f2de")},layers:[],layersById:{},layerIdToInnerId:{},groupsById:{},iconBaseUrl:"",iconNameTemplate:"",fontUrlTemplate:"",rasterSets:{byIndex:{},byKey:{}},labelingGroups:{indexToGroup:h,groupToIndex:f,table:p},fonts:o.p7,fontNameToIndex:(0,l.PU)(o.p7),icons:{},dem:(0,s.vR)({})},this.needRenderIndexRebuild=!1,this.zIndexById={};var t=(0,s.qw)({type:"line",id:"debug-tile-bounds",minzoom:-1/0,maxzoom:1/0,style:{color:"#ff0000",width:1}});t&&this.addLayer(t,0)}return t.prototype.getStyle=function(){return this.style},t.prototype.appendRasterSet=function(t,e){this.style.rasterSets.byIndex[t.index]=t,void 0!==e&&(this.style.rasterSets.byKey[e]=t)},t.prototype.removeRasterSet=function(t){this.style.rasterSets.byIndex[t]=d},t.prototype.getLabelingGroupIndex=function(t){var e=this.style.labelingGroups.groupToIndex;return void 0!==e[t]?e[t]:e.default},t.prototype.addLayer=function(t,e){this.style.layers.push(t),this.style.layersById[t.innerId]=t,void 0!==e&&(this.zIndexById[t.innerId]=e),this.needRenderIndexRebuild=!0},t.prototype.removeLayer=function(t){var e=this.style.layersById[t];if(e){var n=this.style.layers.indexOf(e);-1!==n&&this.style.layers.splice(n,1),delete this.style.layersById[t]}},t.prototype.update=function(){this.needRenderIndexRebuild&&(this.rebuildRenderIndex(),this.needRenderIndexRebuild=!1)},t.prototype.updateLayerStyle=function(t,e){var n=e.style,i=e.dataKeys,r=this.style.layersById[t];r&&(r.style=n,r.dataKeys=i)},t.prototype.rebuildRenderIndex=function(){var t=this;this.style.layers.sort((function(e,n){var i,r;return(null!==(i=t.zIndexById[e.innerId])&&void 0!==i?i:0)-(null!==(r=t.zIndexById[n.innerId])&&void 0!==r?r:0)}));for(var e=0;e<this.style.layers.length;e++)this.style.layers[e].renderIndex=e},t}()},2241:function(t,e,n){n.d(e,{iL:function(){return o},gC:function(){return a},MV:function(){return s}});var i=n(8550),r=(0,i.lK)([255,0,0,255]);function o(t){return"string"==typeof t&&/(#(?:[0-9a-f]{2}){2,4}|#[0-9a-f]{3}|(?:rgba?|hsla?)\((?:\d+%?(?:,|\s)+){2,3}[\s\/]*[\d\.]+%?\))/i.test(t)}function a(t){return"object"==typeof t&&t.type&&"color"===t.type}function s(t){var e=t.toLowerCase(),n=r;switch(e[0]){case"#":n=function(t){if(!new RegExp("^#[a-f0-9]{".concat(t.length-1,"}$")).test(t)||![4,5,7,9].includes(t.length))return r;var e=function(t){return t.length<7?t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(5===t.length?t[4]+t[4]:"ff"):7===t.length?t+"ff":t}(t),n=parseInt(e[1]+e[2],16),o=parseInt(e[3]+e[4],16),a=parseInt(e[5]+e[6],16),s=parseInt(e[7]+e[8],16);return(0,i.lK)([n,o,a,s])}(e);break;case"h":n=function(t){var e=l(t);e[0]/=360,e[1]/=100,e[2]/=100;var n=function(t,e,n){if(0===e)return[255*n,255*n,255*n];var i=n<.5?n*(1+e):n+e-n*e,r=2*n-i;return[255*c(r,i,t+1/3),255*c(r,i,t),255*c(r,i,t-1/3)]}(e[0],e[1],e[2]),r=n[0],o=n[1],a=n[2],s=void 0!==e[3]?255*e[3]:255;return(0,i.lK)([Math.round(r),Math.round(o),Math.round(a),Math.round(s)])}(e);break;case"r":n=function(t){var e=l(t),n=e[0],r=e[1],o=e[2],a=e[3],s=void 0!==a?255*a:255;return(0,i.lK)([Math.round(n),Math.round(r),Math.round(o),Math.round(s)])}(e)}return n}function l(t){return t.split("(")[1].split(")")[0].split(",").map((function(t){return parseFloat(t)}))}function c(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},9266:function(t,e,n){n.d(e,{vR:function(){return k},ys:function(){return I},z8:function(){return S},Cp:function(){return w},qw:function(){return T}});var i=n(655),r=n(2241),o=n(7357),a=n(8550),s=n(3750),l=n(3411),c=n(242),u=n(2267),d=n(7624);function h(t){for(var e=function(t){for(var e=t.groups,n=t.overlay,i=t.intersect,r=e.reduce((function(t,e,n){return t[e]=n,t}),{}),o=[],a=0;a<e.length;a++){for(var s=[],l=0;l<e.length;l++)s.push(!0);o.push(s)}for(var c=0;c<n.length;c++){var u=n[c];for(a=0;a<u.length;a++)for(l=a+1;l<u.length;l++){var d=r[u[a]],h=r[u[l]];o[d][h]=!1,o[h][d]=!1}}for(c=0;c<i.length;c++){var f=i[c];for(a=0;a<f.length;a++)for(l=a+1;l<f.length;l++)d=r[f[a]],h=r[f[l]],o[d][h]=!0,o[h][d]=!0}return{groups:e,table:o}}(function(t){var e=(t.groups||[]).concat(o.YW.groups).reduce((function(t,e){return t.includes(e)||t.push(e),t}),[]),n=(t.overlay||[]).concat(o.YW.overlay).concat(e.reduce((function(t,e){return e===o.T_||e===o.R_||e===o.n3||t.push([e,o.R_]),t}),[])).reduce((function(t,n){for(var i=[],r=0,o=n;r<o.length;r++){var a=o[r];e.includes(a)&&i.push(a)}return i.length>1&&t.push(i),1===n.length&&1===i.length&&t.push(i),t}),[]);return{groups:e,overlay:n,intersect:o.YW.intersect}}(t)),n=e.groups,i=e.table,r={},a=0;a<i.length;a++){var s=i[a],l=n[a];r[l]={};for(var c=0;c<s.length;c++){var u=n[c];r[l][u]=i[a][c]}}var d=n.reduce((function(t,e,n){return t[e]=n,t}),{});return{indexToGroup:n,groupToIndex:d,table:r}}var f=n(9746),p=n(3062),m=n(9460),v=n(3131),_=function(t){function e(e){var n=this.constructor,i=t.call(this,"Unknown expression type '".concat(e[0],"' in '").concat(JSON.stringify(e),"'"))||this;return i.name="UnknownExpressionTypeError",Object.setPrototypeOf(i,n.prototype),i}return(0,i.ZT)(e,t),e}(Error);function y(t,e){if((0,a.aH)(t))return(0,r.iL)(t)?(0,r.MV)(t):t;switch(t[0]){case"all":return function(t,e){return{type:"all",array:t.slice(1).map((function(t){return y(t,e)}))}}(t,e);case"any":return function(t,e){return{type:"any",array:t.slice(1).map((function(t){return y(t,e)}))}}(t,e);case"match":return function(t,e){for(var n={type:"match",input:y(t[1],e),cases:[],defaultOutput:y(t[t.length-1],e)},i=t.slice(2,-1),r=0;r<i.length;r+=2){var o=i[r].reduce((function(t,e){return"boolean"==typeof e&&t.push(Number(e)),t.push(e),t}),[]),a={values:new Set(o),output:y(i[r+1],e)};n.cases.push(a)}return n}(t,e);case"in":return function(t,e){var n=y(t[1],e),i=t[2][0];if("get"!==i&&"global"!==i&&"sourceAttr"!==i)throw new Error("InExpression supports only get, global or source attr expression as a second argument");return{type:"in",element:n,array:y(t[2],e)}}(t,e);case"interpolate":return b(t,e);case"step":return function(t,e){var n={type:"step",steps:[],value:y(t[1],e)},i={key:0,value:y(t[2],e)};n.steps.push(i);for(var r=t.slice(3),o=0;o<r.length;o+=2){var a={key:r[o],value:y(r[o+1],e)};n.steps.push(a)}return n}(t,e);case"get":case"sourceAttr":case"global":return x(t,e);case"zoom":return{type:"zoom"};case"heatmap-density":return{type:"heatmap-density"};case"shading-intensity":return{type:"shading-intensity"};case"to-boolean":case"to-color":case"!":return function(t,e){return{type:t[0],value:y(t[1],e)}}(t,e);case"==":case"!=":case"<":case"<=":case">":case">=":return function(t,e){var n=y(t[1],e),i=y(t[2],e);return{type:t[0],leftValue:n,rightValue:i}}(t,e);default:throw new _(t)}}function g(t,e){return void 0===t?t:y(t,e)}function b(t,e){var n={type:"interpolate",base:1,argument:y(t[2],e),steps:[]};"exponential"===t[1][0]&&void 0!==t[1][1]&&(n.base=t[1][1]);for(var i=t.slice(3),r=0;r<i.length;r+=2){var o={key:i[r],value:y(i[r+1],e)};n.steps.push(o)}return n}function x(t,e){var n=t[0],i=(0,p.qS)(t[1]);return{type:n,dataIndex:e?e.getUniqueIndex("".concat(n,":").concat(i)):NaN,property:i}}function w(t,e,n){var o,a,s,u=k(null!==(a=t.dem)&&void 0!==a?a:{}),d={id:e,revision:0,background:{color:(0,r.MV)(t.background.color)},layers:[],layersById:(o={},o[m.h]=u,o),layerIdToInnerId:{},groupsById:{},iconBaseUrl:"",iconNameTemplate:"",fontUrlTemplate:"",fonts:c.p7,fontNameToIndex:(0,f.PU)(c.p7),rasterSets:{byIndex:{},byKey:{}},icons:t.icons||{},labelingGroups:h(null!==(s=t.labelingGroups)&&void 0!==s?s:{}),dem:u},p=new l.x,_=t.layers;n&&(_=function(t,e){var n=0,r=0;function o(t,e){"custom"!==t.type&&((0,f.Kx)(t.filter)&&(n=e),"point"===t.type&&t.style.iconPriority&&t.style.iconPriority>r&&(r=t.style.iconPriority))}return t.forEach((function(t,e){"group"===t.type?t.layers.forEach((function(t){return o(t,e)})):o(t,e)})),e.forEach((function(){})),(0,i.ev)((0,i.ev)((0,i.ev)([],t.slice(0,n+1),!0),e,!0),t.slice(n+1),!0)}(t.layers,v.T));for(var y=0,g=_;y<g.length;y++){var b=I(g[y]);b&&("group"===b.type&&(d.groupsById[b.innerId]=b,d.layerIdToInnerId[b.id]=b.innerId),("group"===b.type?b.layers:[b]).forEach((function(t){d.layers.push(t),d.layersById[t.innerId]=t,d.layerIdToInnerId[t.id]=t.innerId,"point"===t.type&&S(t,p).forEach((function(t){d.rasterSets.byKey[t.key]||(d.rasterSets.byIndex[t.index]=t,d.rasterSets.byKey[t.key]=t)}))})))}return d}function I(t){return"group"===t.type?(e=t,i=new l.x,r=null===(n=e.orderBy)||void 0===n?void 0:n.map((function(t){return x(t,i)})),o={id:e.id,innerId:(0,m.U)(),renderIndex:M.getIndex(),type:e.type,layers:[],orderBy:null!=r?r:[]},e.layers.forEach((function(t,e){var n=T(t,r);n&&(n.groupId=o.innerId,n.groupIndex=e,n.renderIndex=o.renderIndex,o.layers.push(n))})),o):T(t);var e,n,i,r,o}function S(t,e){var n=[];return t.style.iconImage&&(0,d.EG)(t.style.iconImage).forEach((function(i){if(i.length){var r=(0,a.fF)(i,t.style.iconAnchor[0],t.style.iconAnchor[1]),o={type:u.f.Static,index:e.getUniqueIndex(r),key:r,isSvg:!0,name:i,fileName:i,anchorX:t.style.iconAnchor[0],anchorY:t.style.iconAnchor[1],rasters:[]};n.push(o)}})),n}var M=new l.x;function P(t,e){return"appearance"===t.type?{type:t.type,tipMovementAmplitude:y(t.tipMovementAmplitude,e)}:t}function T(t,e){if("custom"===t.type)return{type:"custom",id:t.id,innerId:(0,m.U)(),renderIndex:M.getIndex(),filter:!1,minzoom:-1/0,maxzoom:1/0,dataKeys:[],style:{}};if(t.style&&"none"!==t.style.visibility){var n,r=new l.x(e?e.length:0);try{var c={id:t.id,innerId:(0,m.U)(),renderIndex:M.getIndex(),filter:y(t.filter||!1),minzoom:L(t.minzoom,-1/0),maxzoom:L(t.maxzoom,1/0),dataKeys:[]};switch(t.type){case"line":var u=(0,o.q0)(t.style);n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),width:y(u.width,r)}});break;case"lineExtrusion":u=(0,o.l7)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{sideColor:y(u.sideColor,r),strokeWidth:y(u.strokeWidth,r),strokeColor:y(u.strokeColor,r),height:y(u.height,r)}});break;case"polygon":u=(0,o.IJ)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),strokeColor:y(u.strokeColor,r),strokeWidth:y(u.strokeWidth,r)}});break;case"polygonExtrusion":u=(0,o.bN)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{topColor:y(u.topColor,r),sideColor:y(u.sideColor,r),strokeColor:y(u.strokeColor,r),strokeWidth:y(u.strokeWidth,r)}});break;case"dashedLine":u=(0,o.N5)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),gapColor:y(u.gapColor,r),width:y(u.width,r),gapLength:y(u.gapLength,r),dashLength:y(u.dashLength,r)}});break;case"shiftedLine":u=(0,o.sd)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),width:y(u.width,r),shift:y(u.shift,r)}});break;case"oneWayLine":u=(0,o.zn)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),lineWidth:y(u.lineWidth,r),lineLength:y(u.lineLength,r),tipWidth:u.tipWidth,tipHeight:u.tipHeight,priority:u.priority,duplicationSpacing:y(u.duplicationSpacing,r),endingOffsets:u.endingOffsets,labelingGroup:u.labelingGroup}});break;case"buildingModel":u=(0,o._0)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),strokeColor:y(u.strokeColor,r),strokeWidth:y(u.strokeWidth,r)}});break;case"labelLine":u=(0,o.Ym)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{textField:y(u.textField,r),textFont:u.textFont,textColor:y(u.textColor,r),textFontSize:y(u.textFontSize,r),textLetterSpacing:u.textLetterSpacing,textHaloColor:y(u.textHaloColor,r),textHaloWidth:u.textHaloWidth,textPriority:u.textPriority,textLabelingSideMargin:u.textLabelingSideMargin,textDuplicationSpacing:y(u.textDuplicationSpacing,r),labelingGroup:u.labelingGroup,lineEndingOffsets:u.lineEndingOffsets}});break;case"point":u=(0,o.TI)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{allowOverlap:u.allowOverlap,allowElevation:u.allowElevation,iconImage:y(u.iconImage,r),iconAnchor:u.iconAnchor,iconOffset:u.iconOffset,iconWidth:y(u.iconWidth,r),iconTextField:y(u.iconTextField,r),iconTextFont:g(u.iconTextFont,r),iconTextAnchor:u.iconTextAnchor,iconTextOffset:u.iconTextOffset,iconTextColor:y(u.iconTextColor,r),iconTextFontSize:y(u.iconTextFontSize,r),iconTextLineHeight:u.iconTextLineHeight,iconTextLetterSpacing:u.iconTextLetterSpacing,iconTextPadding:u.iconTextPadding,iconTextHaloWidth:(0,a.Wx)(u.iconTextHaloWidth),iconTextHaloColor:y(u.iconTextHaloColor,r),iconOpacity:y(u.iconOpacity,r),iconPriority:u.iconPriority,iconLabelingMargin:u.iconLabelingMargin,iconLabelingGroup:u.iconLabelingGroup,iconRotation:y(u.iconRotation,r),textField:y((0,a.Wx)(u.textField),r),textFont:y((0,a.Wx)(u.textFont),r),textColor:y((0,a.Wx)(u.textColor),r),textFontSize:y((0,a.Wx)(u.textFontSize),r),textLineHeight:(0,a.Wx)(u.textLineHeight),textLetterSpacing:(0,a.Wx)(u.textLetterSpacing),textField2:g((0,a._e)(u.textField),r),textFont2:g((0,a._e)(u.textFont),r),textColor2:g((0,a._e)(u.textColor),r)||y((0,a.Wx)(u.textColor),r),textFontSize2:g((0,a._e)(u.textFontSize),r)||y((0,a.Wx)(u.textFontSize),r),textMaxLengthPerLine:u.textMaxLengthPerLine,textPlacement:u.textPlacement,textPriority:u.textPriority,textOffset:y((0,a.Wx)(u.textOffset),r),textOffset2:g((0,a._e)(u.textOffset),r),textHaloColor:y((0,a.Wx)(u.textHaloColor),r),textHaloColor2:g((0,a._e)(u.textHaloColor),r)||y((0,a.Wx)(u.textHaloColor),r),textHaloWidth:(0,a.Wx)(u.textHaloWidth),textHaloWidth2:(0,a._e)(u.textHaloWidth)||(0,a.Wx)(u.textHaloWidth),textLabelingMargin:(0,a.Wx)(u.textLabelingMargin),textLabelingMargin2:(0,a._e)(u.textLabelingMargin)||(0,a.Wx)(u.textLabelingMargin),textLabelingGroup:(0,a.Wx)(u.textLabelingGroup),textLabelingGroup2:(0,a._e)(u.textLabelingGroup)||(0,a.Wx)(u.textLabelingGroup),duplicationSpacing:y(u.duplicationSpacing,r),endingOffsets:u.endingOffsets}});break;case"arrow":u=(0,o.z4)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),strokeColor:y(u.strokeColor,r),lineWidth:y(u.lineWidth,r),strokeWidth:y(u.strokeWidth,r),tipWidth:y(u.tipWidth,r),tipHeight:y(u.tipHeight,r),animation:P(u.animation,r)}});break;case"stretchableImage":n=(0,i.pi)((0,i.pi)({},c),{type:"stretchableImage",style:t.style});break;case"raster":u=(0,o.tC)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{opacity:y(u.opacity,r)}});break;case"circle":u=(0,o.th)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),strokeColor:y(u.strokeColor,r),strokeColor2:y(u.strokeColor2,r),width:y(u.width,r),strokeWidth:y(u.strokeWidth,r),strokeWidth2:y(u.strokeWidth2,r)}});break;case"heatmap":u=(0,o.Mk)(t.style),n=(0,i.pi)((0,i.pi)({},c),{type:t.type,style:{color:y(u.color,r),radius:y(u.radius,r),opacity:y(u.opacity,r),intensity:y(u.intensity,r),weight:y(u.weight,r),downscale:u.downscale},framebufferId:{framebuffer:s.z}})}}catch(e){if(e instanceof _)return void console.warn("Problem with layer #".concat(t.id,": ").concat(e));throw e}if(n){n.dataKeys=function(t){var e=[];for(var n in t){var i=n.split(":"),r=i[0],o=i.slice(1);e[t[n]]={type:r,key:o.join(":")}}return e}(r.getIndexedKeys());for(var d=0,h=null!=e?e:[];d<h.length;d++){var f=h[d];n.dataKeys[f.dataIndex]={type:f.type,key:f.property}}}return n}}function k(t){var e=(0,o.sy)(t);return{id:"dem",type:"dem",innerId:m.h,filter:!0,dataKeys:[],minzoom:-1/0,maxzoom:1/0,renderIndex:-1/0,style:{lightingDirection:y(e.lightingDirection),shadingIntensity:y(e.shadingIntensity),shadingPalette:b(e.shadingPalette),verticalScale:y(e.verticalScale)},framebufferId:{elevation:s.z}}}function L(t,e){return"number"!=typeof t||Number.isNaN(t)?e:t}},7357:function(t,e,n){n.d(e,{IJ:function(){return o},bN:function(){return a},q0:function(){return s},_0:function(){return l},l7:function(){return c},Ym:function(){return u},zn:function(){return d},N5:function(){return h},sd:function(){return f},th:function(){return p},TI:function(){return m},z4:function(){return v},tC:function(){return _},Mk:function(){return y},sy:function(){return g},R_:function(){return b},n3:function(){return x},T_:function(){return w},YW:function(){return I}});var i=n(372);function r(t,e){for(var n in e)void 0!==e[n]&&(t[n]=e[n])}function o(t){var e={color:"#000000",strokeColor:"#000000",strokeWidth:1,visibility:"visible"};return r(e,t),void 0===t.strokeColor&&(e.strokeColor=e.color),e}function a(t){var e={topColor:"#000000",strokeColor:"#000000",strokeWidth:1,sideColor:"#000000",visibility:"visible"};return r(e,t),void 0===t.strokeColor&&(e.strokeColor=e.topColor),void 0===t.sideColor&&(e.sideColor=e.topColor),e}function s(t){var e={color:"#000000",width:1,visibility:"visible"};return r(e,t),e}function l(t){var e={color:"#000000",strokeColor:"#000000",strokeWidth:1,visibility:"visible"};return r(e,t),void 0===t.strokeColor&&(e.strokeColor=e.color),e}function c(t){var e={sideColor:"#000000",strokeColor:"#000000",strokeWidth:1,height:0,visibility:"visible"};return r(e,t),void 0===t.strokeColor&&(e.strokeColor=e.sideColor),e}function u(t){var e={textField:["get","db_label"],textFont:"Noto_Sans",textColor:"#000000",textFontSize:16,textLetterSpacing:0,textHaloColor:"rgba(0, 0, 0, 0)",textHaloWidth:0,textPriority:0,textLabelingSideMargin:0,textDuplicationSpacing:0,lineEndingOffsets:0,visibility:"visible",labelingGroup:w};return r(e,t),e}function d(t){var e={color:"#000000",lineWidth:2,lineLength:10,tipWidth:1.5,tipHeight:2,priority:0,duplicationSpacing:0,endingOffsets:0,visibility:"visible",labelingGroup:w};return r(e,t),e}function h(t){var e={color:"#000000",gapColor:"#00000000",width:1,gapLength:1,dashLength:1,visibility:"visible"};return r(e,t),e}function f(t){var e={color:"#000000",width:1,shift:0,visibility:"visible"};return r(e,t),e}function p(t){var e={color:"#ffffff",strokeColor:"#3388ff",strokeColor2:"#00000000",width:20,strokeWidth:3,strokeWidth2:0,visibility:"visible"};return r(e,t),e}function m(t){var e={allowOverlap:!1,allowElevation:!1,iconOpacity:1,iconImage:"",iconAnchor:[.5,.5],iconOffset:[0,0],iconWidth:16,iconTextField:["get","db_label2"],iconTextFont:"",iconTextAnchor:[.5,.5],iconTextOffset:[0,0],iconTextColor:"#000000",iconTextFontSize:16,iconTextLineHeight:1.2,iconTextLetterSpacing:0,iconTextPadding:[0,0,0,0],iconTextHaloWidth:0,iconTextHaloColor:"rgba(0, 0, 0, 0)",iconPriority:0,iconRotation:0,iconLabelingGroup:w,iconLabelingMargin:{topBottom:0,leftRight:0},textField:[["get","db_label"],["get","db_label2"]],textFont:"",textColor:"#000000",textFontSize:16,textLineHeight:1.2,textLetterSpacing:0,textPlacement:"bottomCenter",textOffset:0,textHaloColor:"rgba(0, 0, 0, 0)",textHaloWidth:0,textLabelingMargin:{topBottom:0,leftRight:0},textPriority:0,textMaxLengthPerLine:30,visibility:"visible",textLabelingGroup:w,duplicationSpacing:100,endingOffsets:0};return r(e,t),e}function v(t){var e={color:"#000000",strokeColor:"#000000",lineWidth:1,strokeWidth:0,tipWidth:1,tipHeight:1,animation:{type:"appearance",tipMovementAmplitude:0},visibility:"visible"};return void 0===t.strokeColor&&(e.strokeColor=e.color),r(e,t),e}function _(t){var e={opacity:1,visibility:"visible"};return r(e,t),e}function y(t){return(0,i.kn)(t,{color:["interpolate",["linear"],["heatmap-density"],0,"rgba(53, 136, 253, 0)",.2,"rgba(53, 136, 253, 0.2)",.4,"rgb(255, 201, 77)",.6,"rgb(255, 202, 20)",.75,"rgb(245, 0, 7)",1,"rgb(255, 0, 0)"],radius:30,opacity:1,intensity:1,weight:1,downscale:1,visibility:"visible"})}function g(t){return(0,i.kn)(t,{lightingDirection:315,shadingIntensity:.15,verticalScale:1,shadingPalette:["interpolate",["exponential",2],["shading-intensity"],0,0,1,.95]})}var b="__overlapped",x="__commercial",w="default",I={groups:[w,b,x],overlay:[[w,b]],intersect:[[]]}},8550:function(t,e,n){function i(t){return"number"==typeof t||"boolean"==typeof t||"string"==typeof t||null===t}function r(t){if(Array.isArray(t)){var e=t;if(!e.length)return!1;if({zoom:!0,"heatmap-density":!0,"shading-intensity":!0,step:!0,interpolate:!0,all:!0,get:!0,sourceAttr:!0,global:!0,match:!0,in:!0,any:!0,"!":!0,"==":!0,"!=":!0,">=":!0,">":!0,"<=":!0,"<":!0,"to-boolean":!0,"to-color":!0}[e[0]])return!0}return!1}function o(t){return!Array.isArray(t)&&"object"==typeof t&&null!==t&&void 0!==t.type&&"color"!==t.type}function a(t){return{type:"color",value:t}}function s(t,e,n){return"".concat(t,"_").concat(e,"_").concat(n)}function l(t,e){return"unique-".concat(t,"_").concat(e)}function c(t){return Array.isArray(t)?r(t)?t:t[0]:t}function u(t){if(Array.isArray(t)&&!r(t)&&void 0!==t[1])return t[1]}n.d(e,{aH:function(){return i},Uu:function(){return o},lK:function(){return a},fF:function(){return s},zV:function(){return l},Wx:function(){return c},_e:function(){return u}})},3411:function(t,e,n){n.d(e,{x:function(){return i}});var i=function(){function t(t){void 0===t&&(t=0),this.index=t,this.keysMap={}}return t.prototype.getIndex=function(){var t=this.index;return this.index+=1,t},t.prototype.getUniqueIndex=function(t){return void 0===this.keysMap[t]&&(this.keysMap[t]=this.index,this.index+=1),this.keysMap[t]},t.prototype.getIndexedKeys=function(){return this.keysMap},t}()},9460:function(t,e,n){n.d(e,{U:function(){return r},h:function(){return o}});var i=0;function r(){return i++}var o=r()},7624:function(t,e,n){n.d(e,{FR:function(){return l},UP:function(){return u},zn:function(){return d},vn:function(){return h},Q9:function(){return f},o4:function(){return p},jJ:function(){return m},bs:function(){return v},ci:function(){return _},OW:function(){return y},m2:function(){return x},EG:function(){return w}});var i=n(8550),r=n(2241),o=n(6328),a=n(8131),s=null;function l(t,e){if(!(0,i.Uu)(t))return t;if(e.allowedExpressions&&!e.allowedExpressions.has(t.type))return(0,o.cM)("Expression of type ".concat(t.type," is not allowed here")),s;switch(t.type){case"all":return function(t,e){return t.array.every((function(t){return!0===l(t,e)}))}(t,e);case"any":return function(t,e){return t.array.some((function(t){return!0===l(t,e)}))}(t,e);case"get":return function(t,e){var n,i,r;if("binder"===e.type||"labeling"===e.type)return null!==(n=c(e.tileData[t.dataIndex]))&&void 0!==n?n:null;var o=null!==(r=null===(i=e.tileAttrs)||void 0===i?void 0:i[e.tileProps[t.property]])&&void 0!==r?r:null;return Number.isNaN(o)?null:c(o)}(t,e);case"global":return function(t,e){var n;return null!==(n=e.styleState[t.property])&&void 0!==n?n:null}(t,e);case"sourceAttr":return function(t,e){var n,i;return"geojsonFilter"===e.type||"filter"===e.type?null!==(n=e.sourceAttrs[t.property])&&void 0!==n?n:null:"binder"!==e.type&&"labeling"!==e.type||null===(i=c(e.tileData[t.dataIndex]))||void 0===i?null:i}(t,e);case"in":return function(t,e){var n=l(t.element,e),i=l(t.array,e);return null!==i&&(Array.isArray(i)?i.some((function(t){return t===n})):((0,o.cM)("InExpression second argument resolved to non-array value: ".concat(i)),null))}(t,e);case"interpolate":return function(t,e){if(0===t.steps.length)return(0,o.cM)("Interpolate expression contains 0 steps, cannot interpolate"),s;var n=l(t.steps[0].value,e),i=l(t.argument,e);return"number"!=typeof i?((0,o.cM)("Interpolate value resolved to non-number value: ".concat(i," ").concat(t.argument)),0):(0,r.gC)(n)?p(t,i,e):u(t,i,e)}(t,e);case"match":return function(t,e){var n,i=l(t.input,e),r=t.cases.find((function(t){return t.values.has(i)}));return l(null!==(n=null==r?void 0:r.output)&&void 0!==n?n:t.defaultOutput,e)}(t,e);case"step":return function(t,e){var n=g(t,Number(l(t.value,e)))-1;return l(t.steps[n].value,e)}(t,e);case"to-boolean":return function(t,e){return Boolean(l(t.value,e))}(t,e);case"to-color":return function(t,e){var n=l(t.value,e);return(0,r.iL)(n)?(0,r.MV)(n):(0,r.gC)(n)?n:(console.warn("Can't resolve expression. Must be color, but got ".concat(n)),(0,i.lK)([0,0,0,0]))}(t,e);case"!":return function(t,e){return!l(t.value,e)}(t,e);case"==":case"!=":return function(t,e){var n=l(t.leftValue,e),i=l(t.rightValue,e);switch(t.type){case"==":return n===i;case"!=":return n!==i}}(t,e);case">":case"<":case">=":case"<=":return function(t,e){var n=l(t.leftValue,e);if(null===n)return null;var i=l(t.rightValue,e);if(null===i)return null;switch(t.type){case"<":return n<i;case">":return n>i;case"<=":return n<=i;case">=":return n>=i}}(t,e);case"zoom":return"binder"===e.type||"labeling"===e.type?e.styleZoom:((0,o.cM)("Zoom expression cannot be used in filter context"),s);default:return(0,o.cM)("Not supported expression type <<".concat(t.type,">> in ").concat(JSON.stringify(t))),s}}function c(t){return(0,a.nI)(t)?(0,a.Ak)(t):t}function u(t,e,n){var i=g(t,e);if(0===i)return Number(l(t.steps[0].value,n));if(i===t.steps.length)return function(t,e,n){var i=t.steps[t.steps.length-1],r=t.base;return 1===r?h(i.value,e):h(i.value,e)*Math.pow(r,n-i.key)}(t,n,e);var r=Number(l(t.steps[i-1].value,n));if("labeling"===n.type&&n.interpolateExpressionAsStep)return r;var o=b(t,e,i);return(1-o)*r+o*Number(l(t.steps[i].value,n))}function d(t,e){var n=l(t,e);return(0,r.gC)(n)?n:(console.warn("Can't resolve expression. Must be color, but got ".concat(n)),(0,i.lK)([0,0,0,0]))}function h(t,e,n){void 0===n&&(n=NaN);var i=l(t,e);return"number"==typeof i?i:n}function f(t,e,n){void 0===n&&(n="");var i=l(t,e);return"string"==typeof i?i:n}function p(t,e,n){var r=g(t,e);if(0===r)return d(t.steps[0].value,n);if(r===t.steps.length)return d(t.steps[t.steps.length-1].value,n);var o=b(t,e,r),a=d(t.steps[r-1].value,n).value,s=d(t.steps[r].value,n).value;return(0,i.lK)([a[0]*(1-o)+s[0]*o,a[1]*(1-o)+s[1]*o,a[2]*(1-o)+s[2]*o,a[3]*(1-o)+s[3]*o])}function m(t,e,n){return{type:"binder",styleZoom:t,styleState:e,tileData:n}}function v(t,e,n,i){return{type:"labeling",styleZoom:t,styleState:e,interpolateExpressionAsStep:n,tileData:i}}function _(t,e,n,i,r){return{type:"filter",metatile:t,styleState:e,tileProps:i,tileAttrs:r,sourceAttrs:n}}function y(t,e,n,i,r){return{type:"geojsonFilter",metatile:t,styleState:e,sourceAttrs:n,tileProps:i,tileAttrs:r}}function g(t,e){for(var n=0;n<t.steps.length&&!(e<t.steps[n].key);)n++;return n}function b(t,e,n){var i=t.base,r=t.steps[n].key-t.steps[n-1].key,o=e-t.steps[n-1].key;return 1===i?o/r:(Math.pow(i,o)-1)/(Math.pow(i,r)-1)}function x(t){var e=t.value,n=e[0],i=e[1],r=e[2],o=e[3];return[((n*o+127)/255>>>0)/255,((i*o+127)/255>>>0)/255,((r*o+127)/255>>>0)/255,o/255]}function w(t){var e=new Set;return I(e,t),Array.from(e)}function I(t,e){if((0,i.Uu)(e))switch(e.type){case"all":return function(t,e){e.array.forEach((function(e){return I(t,e)}))}(t,e);case"match":return function(t,e){I(t,e.defaultOutput),e.cases.forEach((function(e){return I(t,e.output)}))}(t,e);case"step":case"interpolate":return function(t,e){e.steps.forEach((function(e){return I(t,e.value)}))}(t,e)}else t.add(e)}},3750:function(t,e,n){n.d(e,{z:function(){return i}});var i=-1},9746:function(t,e,n){function i(t){return!!t&&"line"===t.type}function r(t){return t.reduce((function(t,e,n){return t[e]=n,t}),{})}function o(t){if(void 0===t||"boolean"==typeof t)return Boolean(t);var e=JSON.stringify(t);return Boolean(e.match(/\["get","(db_)?sublayer"]/))}n.d(e,{ot:function(){return i},PU:function(){return r},Kx:function(){return o}})},197:function(t,e,n){n.r(e),n.d(e,{Circle:function(){return Ts},CircleMarker:function(){return nt},CircleMarkerOptions:function(){return m.CircleMarkerOptions},CircleOptions:function(){return m.CircleOptions},CommPoiEvent:function(){return p.CommPoiEvent},DashedPolyline:function(){return Is},DashedPolylineOptions:function(){return m.DashedPolylineOptions},DataTileLayer:function(){return rl},DataTileLayerOptions:function(){return y.DataTileLayerOptions},DraggablePointerEvent:function(){return p.DraggablePointerEvent},DynamicObject:function(){return U},DynamicObjectPointerEvent:function(){return p.DynamicObjectPointerEvent},Entrance:function(){return Ko},EntranceOptions:function(){return m.EntranceOptions},FirmsToFloorIndexMap:function(){return _.FirmsToFloorIndexMap},FloorComplexHideEvent:function(){return p.FloorComplexHideEvent},FloorComplexShowEvent:function(){return p.FloorComplexShowEvent},FontName:function(){return ro.FontName},GeoJsonSource:function(){return Ee.gs},GeoJsonSourceOptions:function(){return Ee.GeoJsonSourceOptions},GeoJsonTileSource:function(){return Ee.Xm},GeoJsonTileSourceOptions:function(){return Ee.GeoJsonTileSourceOptions},HTMLMarkerShownEvent:function(){return p.HTMLMarkerShownEvent},Heatmap:function(){return Bs},HeatmapOptions:function(){return a.HeatmapOptions},HeatmapPalette:function(){return a.HeatmapPalette},HeatmapPoint:function(){return a.HeatmapPoint},HillshadeOptions:function(){return v.HillshadeOptions},HtmlMarker:function(){return Wo},HtmlMarkerOptions:function(){return m.HtmlMarkerOptions},IconTransformerParams:function(){return f.IconTransformerParams},InteractionEvent:function(){return p.InteractionEvent},InteractionTarget:function(){return p.InteractionTarget},LabelsDebugOptions:function(){return o.LabelsDebugOptions},Map:function(){return vs},MapClass:function(){return vs},MapEvent:function(){return p.MapEvent},MapOptions:function(){return v.MapOptions},MapPointerEvent:function(){return p.MapPointerEvent},Marker:function(){return Xs},MarkerIconOptions:function(){return c.MarkerIconOptions},MarkerLabelOptions:function(){return c.MarkerLabelOptions},MarkerOptions:function(){return c.MarkerOptions},OnlineMarker:function(){return nl},OnlineMarkerIcon:function(){return f.OnlineMarkerIcon},OnlineMarkerOptions:function(){return f.OnlineMarkerOptions},Padding:function(){return v.Padding},PersonalPoi:function(){return v.PersonalPoi},PointLabel:function(){return Gs},PointLabelOptions:function(){return l.PointLabelOptions},Polygon:function(){return Ps},PolygonOptions:function(){return m.PolygonOptions},Polyline:function(){return xs},PolylineOptions:function(){return m.PolylineOptions},Raster:function(){return $s},RasterOptions:function(){return d.RasterOptions},RasterTileSource:function(){return el},RasterTileSourceOptions:function(){return h.RasterTileSourceOptions},Rect:function(){return Qs},RectOptions:function(){return u.RectOptions},RulerChangeEvent:function(){return p.RulerChangeEvent},SourceMetatile:function(){return ro.SourceMetatile},Stats:function(){return v.Stats},StretchableImage:function(){return Zs},StretchableImageOptions:function(){return s.StretchableImageOptions},StretchableImageSource:function(){return s.StretchableImageSource},TileCoords:function(){return v.TileCoords},TileLoadEvent:function(){return p.TileLoadEvent},TrafficScoreEvent:function(){return p.TrafficScoreEvent},Viewport:function(){return v.Viewport},config:function(){return g},mapglUtils:function(){return r},utils:function(){return i}});var i={};n.r(i),n.d(i,{geoLineDistance:function(){return x.XV},geoToMapDistance:function(){return x.a4},getCenterZoomByPoints:function(){return k},getMetersFromPixels:function(){return D},getMousePositionInContainer:function(){return L},projectGeoToMap:function(){return x.yq},projectGeoToScreen:function(){return C},projectMapToGeo:function(){return x.PA},projectMapToScreen:function(){return R},projectScreenToGeo:function(){return A}});var r={};n.r(r),n.d(r,{getMetersFromPixelsXY:function(){return x.$X},getUrl:function(){return O.Gr},hashToString:function(){return F.GG}});var o={};n.r(o),n.d(o,{Q:function(){return Ya}});var a={};n.r(a),n.d(a,{X:function(){return Bs}});var s={};n.r(s),n.d(s,{q:function(){return Zs}});var l={};n.r(l),n.d(l,{S:function(){return Gs}});var c={};n.r(c),n.d(c,{J:function(){return Xs}});var u={};n.r(u),n.d(u,{U:function(){return Qs}});var d={};n.r(d),n.d(d,{n:function(){return $s}});var h={};n.r(h),n.d(h,{P:function(){return el}});var f={};n.r(f),n.d(f,{c:function(){return nl}});var p={};n.r(p);var m={};n.r(m);var v={};n.r(v);var _={};n.r(_);var y={};n.r(y),n.d(y,{l:function(){return rl}});var g=n(1026),b=n(372),x=n(3308),w=n(1859),I=n(9450),S=n(7120),M=n(1992);function P(t,e,n){if(0!==t.length){for(var i=(0,b.Id)(e),r=S.Ue(),o=0,a=t;o<a.length;o++){var s=a[o],l=(0,x.yq)(s);(0,M.hk)(l,-i),S.aM(r,l)}var c=I.Ue();return S.be(c,r),(0,M.hk)(c,i),{center:c,zoom:T(r,n)}}}function T(t,e){return Math.min((0,x.to)(e[0],Math.abs(t.max[0]-t.min[0])),(0,x.to)(e[1],Math.abs(t.max[1]-t.min[1])))}function k(t,e,n){var i=P(t,e,n);if(i)return{zoom:i.zoom,center:(0,x.PA)(i.center)}}function L(t,e,n){var i=t.getBoundingClientRect();return[e-i.left-t.clientLeft,n-i.top-t.clientTop]}function z(t,e){for(var n=[],i=0;i<t.length;i++)n[i]=L(e,t[i].clientX,t[i].clientY);return n}function E(t){return t.touches.length>1}function C(t,e,n,i,r,o,a,s){return void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0}),new w.V({center:(0,x.yq)(t),zoom:e,rotation:(0,b.Id)(n),size:i,pitch:(0,b.Id)(r),viewport:a,padding:s}).project((0,x.yq)(o))}function A(t,e,n,i,r,o,a,s){void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0});var l=new w.V({center:(0,x.yq)(t),zoom:e,rotation:(0,b.Id)(n),size:i,pitch:(0,b.Id)(r),viewport:a,padding:s});return(0,x.PA)(l.unproject(o))}function D(t,e,n,i,r,o,a,s,l){return void 0===a&&(a={top:0,right:0,bottom:0,left:0}),void 0===s&&(s={top:0,right:0,bottom:0,left:0}),(0,x.$X)(t,e,n,i,r,o,a,s,l,l)}function R(t,e){return new w.V(t).project(e)}var O=n(9170),F=n(5109),B=n(655),j=n(5964),Z=n(5773),U=function(t){function e(e){var n=t.call(this)||this;return n.uniqId=(0,Z.f)(),n.modules=e.modules,n.mapState=e.state,n.tileObjects=[],n.identifyIds=[],n}return(0,B.ZT)(e,t),e.prototype.update=function(){},e.prototype.destroy=function(){var t=this,e=this.modules;this.tileObjects.forEach((function(n){n.clean(t.mapState),e.tileManager.removeObject(n)})),this.tileObjects=[],e.layers.removeLayer(this),this.mapState.needRerender=!0},e.prototype.getIdentifyData=function(){var t=this;return this.identifyIds.map((function(e){return{dynamicObjectId:t.uniqId,metatileHash:-1,ids:e}}))},e}(j.c),N=n(378),H=n(5233),G=n(8131),V=n(7277);function W(t,e){if(void 0!==e){if(e.sourceId){var n=t.getSourceById(e.sourceId);if("default"!==(null==n?void 0:n.type))return}var i={id:(0,G.Ak)(e.id),symbol:e.symbol};return"point"===e.symbol&&(i.isText=1===e.instanceId),e.sublayer&&(i.isCityCommercial=(0,V.wu)(e.sublayer),i.isCommercial=(0,V.Ty)(e.sublayer),i.isPersonal=(0,V.h3)(e.sublayer),"point"!==e.symbol||i.isCommercial||(i.sysCode=e.objectClass)),i}}function X(t,e){if(void 0!==e){if(e.sourceId){var n=t.getSourceById(e.sourceId);if(n&&"geojson"===n.type)return"internal"===n.subtype?{type:"geojson",id:(0,G.Ak)(e.id),feature:n.getFeatureById(e.id),source:n}:{type:"geojsonTile",getFeatureProperties:function(){var t;return n.getObjectAttributes(e.id.lo,null!==(t=e.tileKey)&&void 0!==t?t:"")},source:n}}return{type:"default",id:(0,G.Ak)(e.id)}}}function Y(t,e,n,i,r){var o=(0,x.PA)(r.camera.unproject(i));if(e&&void 0!==e.dynamicObjectId){var a=t,s=r.layers.getDynamicObjectLayers().find((function(t){return t.uniqId===e.dynamicObjectId}));if(!s)return;var l={lngLat:o,originalEvent:n,point:i,targetData:s};s.emit(a,l)}else{var c={lngLat:o,originalEvent:n,point:i,target:W(r.sourceStorage,e),targetData:X(r.sourceStorage,e)},u=t;r.map.emit(u,c)}}var q=function(t){function e(e,n){var i=t.call(this,e)||this;return i.start=function(t){var e=i,n=e.modules,r=e.container;if(0===t.button){var o=L(r,t.clientX,t.clientY);i.contains(o)&&(n.handler.block(),n.mouseMoveHandler.block(),i.dragStartCursorPoint=o,i.dragStartAnchorPoint=n.camera.project(i.getPosition()),document.addEventListener("mouseup",i.stop),document.addEventListener("mousemove",i.move),i.emitEvent("dragstart",t))}},i.move=function(t){var e=i,n=e.dragStartAnchorPoint,r=e.dragStartCursorPoint,o=e.container;if(void 0!==n&&void 0!==r){var a=L(o,t.clientX,t.clientY),s=N.d9(n);N.IH(s,s,a),N.lu(s,s,r),i.setPosition(i.modules.camera.unproject(s)),i.emitEvent("drag",t)}},i.stop=function(t){if(0===t.button){i.dragStartCursorPoint=void 0,i.dragStartAnchorPoint=void 0,document.removeEventListener("mouseup",i.stop),document.removeEventListener("mousemove",i.move);var e=i.modules;e.handler.unblock(),e.mouseMoveHandler.unblock(),i.emitEvent("dragend",t),i.isInteractive()&&e.identifier.resetCache()}},i.container=e.modules.layout.mapContainer,n&&i.container.addEventListener("mousedown",i.start,!0),i}return(0,B.ZT)(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.container.removeEventListener("mousedown",this.start,!0),document.removeEventListener("mouseup",this.stop),document.removeEventListener("mousemove",this.move)},e.prototype.emitEvent=function(t,e){var n=this.getPosition(),i=(0,x.PA)(n),r=this.modules.camera.project(n),o=this.modules.identifier.searchSync(r),a=void 0!==o&&void 0===o.dynamicObjectId?W(this.modules.sourceStorage,o):void 0;this.emit(t,{originalEvent:e,target:a,targetData:this,lngLat:i,point:r})},e}(U),J=n(5951),K=n(3526),Q=n(3936),$=n(9266),tt=n(5869),et=n(7624),nt=function(t){function e(e,n){var i,r,o=this;(o=t.call(this,e,null!==(i=n.draggable)&&void 0!==i&&i)||this).options=n,o.interactive=null===(r=o.options.interactive)||void 0===r||r,o.center=(0,x.yq)(o.options.coordinates);var a=o.modules,s=a.dynamicStyle,l=a.collector,c=a.renderer,u=a.tileManager,d=a.identifier,h=a.layers;if(o.layer=(0,$.qw)({type:"circle",id:"dynamic-circleMarker-".concat(o.uniqId),minzoom:o.options.minZoom,maxzoom:o.options.maxZoom,style:{color:o.options.color,strokeColor:o.options.borderColor,strokeColor2:o.options.border2Color,width:o.options.width,strokeWidth:o.options.borderWidth,strokeWidth2:o.options.border2Width}}),!o.layer)return o;s.addLayer(o.layer,o.options.zIndex);var f=(0,K.IR)(o.center),p=(0,Q.FJ)({id:o.interactive?(0,G.Ru)(0,0):NaN});(0,J.XI)({collector:l,generator:tt.p.generate,args:[s.getStyle().id,o.layer,F.Dz,p,[[0],[0]]]});var m=l.getAccumulatedData(),v=new H.W("dynamicObject",m.data,c,f);return u.addObject(v),o.tileObjects.push(v),o.interactive&&o.identifyIds.push(m.identifyIds),h.addLayer(o),l.reset(),o.mapState.needRerender=!0,o.interactive&&d.resetCache(),o}return(0,B.ZT)(e,t),e.prototype.remove=function(){this.layer&&this.modules.dynamicStyle.removeLayer(this.layer.innerId),this.interactive&&this.modules.identifier.resetCache(),t.prototype.destroy.call(this)},e.prototype.setPosition=function(t){var e=this.mapState,n=this.tileObjects[0];void 0!==n&&(this.center=t,n.setTileCoords((0,K.IR)(t)),e.needRerender=!0)},e.prototype.getPosition=function(){return this.center},e.prototype.isInteractive=function(){return this.interactive},e.prototype.contains=function(t){if(!this.layer)return!1;var e=this.layer,n=this.modules.camera.project(this.center),i=(0,et.vn)(e.style.width,(0,et.jJ)(this.mapState.styleZoom,this.mapState.styleState,[]))/2+(0,et.vn)(e.style.strokeWidth,(0,et.jJ)(this.mapState.styleZoom,this.mapState.styleState,[]));return N.TK(n,t)<=i},e}(q),it=n(258);function rt(t,e,n){var i=t.viewport,r=i.top,o=i.right,a=i.bottom,s=i.left,l=e.clientWidth,c=e.clientHeight;t.size=[Math.max(1,l-s-o),Math.max(1,c-r-a)],n.updateIdentifySize()}function ot(t,e){var n=t.padding,i=n.top,r=n.right,o=n.bottom,a=n.left;t.padding={top:i,right:r,bottom:o,left:a},t.needRerender=!0,e.updateIdentifySize()}var at="inertia",st=it.sT.bind(null,at),lt=function(t,e){it.sT(at,e),t.classList.remove("mapgl-inertia")},ct="center",ut=function(t,e,n){void 0===n&&(n={}),it.sT(ct,t),st(t);var i=I.Ue();if(S.Rk(i,t.maxBounds,e),!1===n.animate||0===n.duration)t.center=i,"zoom"===t.zoomTypePreserving?t.styleZoom=(0,x.X$)(t.zoom,e):t.zoom=(0,x.Z3)(t.styleZoom,e);else{var r=void 0!==n.easing?n.easing:"linear",o=void 0!==n.duration?n.duration:250;it.BL(ct,{easing:r},t,t.center,i,o)}},dt=it.sT.bind(null,ct),ht=it.Vx.bind(null,ct,{step:function(t,e){t.center=e,"zoom"===t.zoomTypePreserving?t.styleZoom=(0,x.X$)(t.zoom,e):t.zoom=(0,x.Z3)(t.styleZoom,e)}}),ft="rotation";function pt(t,e){return(t-=e)>=Math.PI?t=(t+Math.PI)%(2*Math.PI)-Math.PI:t<-Math.PI&&(t=Math.PI-(Math.PI-t)%(2*Math.PI)),t+e}function mt(t,e,n){if(void 0===n&&(n={}),it.sT(ft,t),!1===n.animate||0===n.duration)t.rotation=pt(e,0);else{var i=void 0===n.normalize||n.normalize;it.BL(ft,{easing:n.easing||"linear"},t,t.rotation,i?pt(e,t.rotation):e,n.duration||250)}}var vt=it.sT.bind(null,ft),_t=it.Vx.bind(null,ft,{step:function(t,e){return t.rotation=pt(e,0)}}),yt="pitch";function gt(t,e,n){void 0===n&&(n={}),it.sT(yt,t);var i=(0,b.uZ)(e,t.minPitch,t.maxPitch);!1===n.animate||0===n.duration?t.pitch=i:it.BL(yt,{easing:n.easing||"linear"},t,t.pitch,i,n.duration||300)}var bt=it.sT.bind(null,yt),xt=it.Vx.bind(null,yt,{step:function(t,e){return t.pitch=e}}),wt="zoom",It=function(t,e,n){void 0===n&&(n={}),it.sT(wt,t);var i=(0,b.uZ)(e,t.minZoom,t.maxZoom);if(i!==t.zoom)if(!1===n.animate||0===n.duration)n.zoomPoint&&(I.IH(t.center,t.center,(0,b.Kv)(t,n.zoomPoint,{zoom:i})),S.Rk(t.center,t.maxBounds,t.center)),t.zoom=i,t.styleZoom=(0,x.X$)(i,t.center);else{var r=n.animateHeight?(0,x.r9)(t.zoom,t.size):t.zoom,o=n.animateHeight?(0,x.r9)(i,t.size):i,a=void 0!==n.easing?n.easing:"easeOutCubic",s=void 0!==n.duration?n.duration:250;it.BL(wt,{easing:a},t,r,o,s,{zoomPoint:n.zoomPoint,animateHeight:!!n.animateHeight,blockBuildingAnimation:!!n.blockBuildingAnimation})}},St=it.sT.bind(null,wt),Mt=it.Vx.bind(null,wt,{step:function(t,e,n){void 0===n&&(n={});var i=n&&n.animateHeight?(0,x.nn)(e,t.size):e;n&&n.zoomPoint&&(I.IH(t.center,t.center,(0,b.Kv)(t,n.zoomPoint,{zoom:i})),S.Rk(t.center,t.maxBounds,t.center)),t.zoom=i,t.styleZoom=(0,x.X$)(i,t.center)}}),Pt=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,Tt=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||Pt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,kt=At("webkit"),Lt=At("chrome")||At("crios"),zt=(window,!Lt&&At("safari")),Et=(At("gecko")&&!kt&&window.opera,navigator.platform.toUpperCase().indexOf("MAC")>=0),Ct=At("firefox");function At(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function Dt(t,e){var n=(0,B.pi)({hitType:"event",eventCategory:"Metrics"},t);window.ga&&window.ga("".concat(g.analytics.gaName,".send"),n)}function Rt(t,e){var n,i=!1;function r(){i=!1,n&&(o.apply(void 0,n),n=!1)}function o(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];i?n=o:(t.apply(void 0,o),setTimeout(r,e),i=!0)}return o}function Ot(t){St(t),dt(t),vt(t),bt(t),st(t)}var Ft=function(){function t(t,e){var n=this;this.onWheelScroll=function(t){t.preventDefault(),void 0===t.deltaMode&&void 0===t.deltaY||(n.state.userHasInteracted=!0,n.screenPoint=L(n.container,t.clientX,t.clientY),t.ctrlKey?n.deltaAccumulator-=10*t.deltaY:1===t.deltaMode?n.deltaAccumulator-=20*t.deltaY:n.deltaAccumulator-=t.deltaY,n.eventCount+=1)},this.startZooming=function(){var t,e=n.state;t=Et?n.getDelta()*g.zoom.macTouchDelta:(0,b.Xx)(n.getDelta())*g.zoom.mouseDelta;var i=e.zoom+t,r=(0,b.uZ)(i,e.minZoom,e.maxZoom);r!==e.zoom&&(Ot(e),It(e,r,{duration:g.zoom.animDuration,animate:!Et,zoomPoint:e.keepCenterWhileUserZoomRotate?void 0:n.screenPoint,blockBuildingAnimation:!0}))},this.stop=function(){n.state.userHasInteracted=!0,St(n.state)},this.state=t,this.container=e,Et||(this.startZooming=Rt(this.startZooming,g.zoom.throttleDelay)),this.deltaAccumulator=0,this.eventCount=0,this.screenPoint=[0,0],this.container.addEventListener("wheel",this.onWheelScroll),this.container.addEventListener("mousedown",this.stop)}return t.prototype.destroy=function(){this.container.removeEventListener("wheel",this.onWheelScroll),this.container.removeEventListener("mousedown",this.stop)},t.prototype.update=function(){0!==this.eventCount&&(this.startZooming(),this.state.needRerender=!0)},t.prototype.getDelta=function(){var t=this.deltaAccumulator/this.eventCount;return this.deltaAccumulator=0,this.eventCount=0,t},t}(),Bt=function(){function t(t){this.defs=t.map((function(t){return new jt(t)}))}return t.prototype.check=function(t){for(var e=this.defs,n=!1,i=0;i<e.length;i++)n?e[i].update(t):n=!e[i].equal(t);return n},t}(),jt=function(){function t(t){this.path=Array.isArray(t.path)?t.path:[t.path],this.type=t.type,"number"===this.type?(this.last=NaN,this.compare=this.primitive,this.updateFn=this.primitiveUpdate):"boolean"===this.type?(this.last=void 0,this.compare=this.primitive,this.updateFn=this.primitiveUpdate):"vec2"===this.type?(this.last=[NaN,NaN],this.compare=this.vec2,this.updateFn=this.vec2Update):"string"===this.type?(this.last="",this.compare=this.primitive,this.updateFn=this.primitiveUpdate):"padding"===this.type&&(this.last={left:0,right:0,bottom:0,top:0},this.compare=this.padding,this.updateFn=this.paddingUpdate)}return t.prototype.equal=function(t){var e=this.take(t),n=this.compare(this.last,e);return this.updateFn(e),n},t.prototype.update=function(t){this.updateFn(this.take(t))},t.prototype.take=function(t){var e=this.path,n=0;do{t=t[e[n++]]}while(n<e.length);return t},t.prototype.primitive=function(t,e){return t===e},t.prototype.padding=function(t,e){return t.top===e.top&&t.bottom===e.bottom&&t.left===e.left&&t.right===e.right},t.prototype.paddingUpdate=function(t){this.last.top=t.top,this.last.bottom=t.bottom,this.last.right=t.right,this.last.left=t.left},t.prototype.vec2=function(t,e){return t[0]===e[0]&&t[1]===e[1]},t.prototype.primitiveUpdate=function(t){this.last=t},t.prototype.vec2Update=function(t){this.last[0]=t[0],this.last[1]=t[1]},t}(),Zt=function(){function t(t,e){var n=this;this.onMouseUp=function(t){1===t.which&&n.start()},this.onTouchEnd=function(t){0===t.touches.length&&n.start()},this.start=function(){var t=n.state;t.userHasInteracted=!0;var e=n.getCurrentSpeed(t.time),i=I.kE(e);if(!((0,x.ik)(i,t.zoom)<=g.inertia.minSpeed)){var r=(0,x.h0)(g.inertia.maxSpeed,t.zoom),o=Math.min(i,r),a=n.calcDistanceByStartSpeed(o),s=I.d9(t.center),l=I.Ue();I.Fv(l,e),function(t,e,n,i,r){it.BL(at,{easing:"inertia"},t,0,r,g.inertia.duration,{startPoint:e,startSpeed:n,direction:i,startTime:t.time})}(t,s,o,l,a),n.container.classList.add("mapgl-inertia")}},this.stop=function(){st(n.state),n.container.classList.remove("mapgl-inertia"),n.times=[],n.positions=[]},this.state=t,this.container=e,this.container.addEventListener("mouseup",this.onMouseUp),this.container.addEventListener("mousedown",this.stop),Tt&&(this.container.addEventListener("touchend",this.onTouchEnd),this.container.addEventListener("touchstart",this.stop)),this.zoomDiffer=new Bt([{path:"zoom",type:"number"}]),this.styleZoomDiffer=new Bt([{path:"styleZoom",type:"number"}]),this.centerDiffer=new Bt([{path:"center",type:"vec2"}]),this.times=[],this.positions=[]}return t.prototype.destroy=function(){this.container.removeEventListener("mouseup",this.onMouseUp),this.container.removeEventListener("mousedown",this.stop),this.container.removeEventListener("touchend",this.onTouchEnd),this.container.removeEventListener("touchstart",this.stop)},t.prototype.update=function(){var t=this.state;this.centerDiffer.check(t)&&this.rememberTimeAndPosition(t),("zoom"===t.zoomTypePreserving?this.zoomDiffer.check(t):this.styleZoomDiffer.check(t))&&this.stop()},t.prototype.removeOldRecords=function(t){for(;t-this.times[0]>100&&this.times.length;)this.times.shift(),this.positions.shift()},t.prototype.rememberTimeAndPosition=function(t){var e=t.time;this.removeOldRecords(e),this.times.push(e),this.positions.push(I.d9(t.center))},t.prototype.getCurrentSpeed=function(t){if(this.removeOldRecords(t),this.times.length<2)return I.Ue();var e=I.d9(this.positions[this.positions.length-1]);return I.lu(e,e,this.positions[0]),I.bA(e,e,1/(this.times[this.times.length-1]-this.times[0])),e},t.prototype.calcDistanceByStartSpeed=function(t){return t*g.inertia.duration/(g.inertia.nonLinearity+1)},t}(),Ut=function(){function t(t){var e=this;this.emitMouseEvent=function(t){var n=L(e.container,t.clientX,t.clientY);e.emitEvent(t,n)},this.emitTouchEvent=function(t){var n=L(e.container,t.changedTouches[0].clientX,t.changedTouches[0].clientY);e.emitEvent(t,n)},this.container=t.layout.mapContainer,this.modules=t,this.container.addEventListener("mouseup",this.emitMouseEvent),this.container.addEventListener("touchend",this.emitTouchEvent)}return t.prototype.destroy=function(){this.container.removeEventListener("mouseup",this.emitMouseEvent),this.container.removeEventListener("touchend",this.emitTouchEvent)},t.prototype.update=function(){},t.prototype.emitEvent=function(t,e){var n=this;if(this.modules.layout.isActionWithCanvas(t)){var i=t.type;this.modules.identifier.search(i,e).then((function(r){Y(i,r,t,e,n.modules)}))}},t}(),Nt=function(){function t(t,e,n){var i=this;this.rotationDetected=!1,this.onGestureStart=function(t){t.preventDefault(),i.startRotation=i.state.rotation,i.rotationDetected=!1,i.gestureRotation=0,i.isGestureStart=!0,i.startZoom=i.state.zoom,i.screenPoint=L(i.container,t.clientX,t.clientY),i.state.userHasInteracted=!0,i.state.disableRotationByUserInteraction||i.container.classList.add("mapgl-rotating"),i.map.emit("interactionstart",{target:"zoom/rotation"})},this.onGestureEnd=function(t){t.preventDefault(),i.isGestureStart&&(i.isGestureStart=!1,i.state.userHasInteracted=!0,i.container.classList.remove("mapgl-rotating"),i.map.emit("interactionend",{target:"zoom/rotation"}))},this.onGestureChange=function(t){t.preventDefault(),i.state.userHasInteracted=!0;var e=t.rotation/40;!i.rotationDetected&&Math.abs(e)>i.state.touchRotationThreshold&&(i.rotationDetected=!0,i.startRotation=i.state.rotation-e),i.rotationDetected&&(i.gestureRotation=e),t.scale>1?i.gestureZoom=t.scale-1:i.gestureZoom=-1/t.scale+1},this.state=t,this.container=e,this.map=n,this.isGestureStart=!1,this.gestureRotation=0,this.gestureZoom=0,this.screenPoint=[0,0],this.startRotation=0,this.startZoom=0,this.container.addEventListener("gesturestart",this.onGestureStart),this.container.addEventListener("gestureend",this.onGestureEnd),this.container.addEventListener("gesturechange",this.onGestureChange)}return t.prototype.destroy=function(){this.container.removeEventListener("gesturestart",this.onGestureStart),this.container.removeEventListener("gestureend",this.onGestureEnd),this.container.removeEventListener("gesturechange",this.onGestureChange)},t.prototype.update=function(){if(0!==this.gestureRotation||0!==this.gestureZoom){var t=this.state,e=this.startZoom+this.gestureZoom,n=this.startRotation+this.gestureRotation,i=I.Ue(),r=t.keepCenterWhileUserZoomRotate?I.Ue():(0,b.Kv)(t,this.screenPoint,{zoom:e,rotation:n});I.IH(i,t.center,r),Ot(t),ut(t,i,{animate:!1}),It(t,e,{animate:!1}),t.disableRotationByUserInteraction||mt(t,n,{animate:!1}),this.gestureRotation=0,this.gestureZoom=0}},t}(),Ht=function(t){function e(e){var n=t.call(this)||this;return n.durations=[],n.earlyTimes=[],n.countToCheck=75,n.mayCountMetrics=!1,n.startRenderTime=0,n.catchNextUpdate=!1,n.mapState=e,setTimeout((function(){n.mayCountMetrics=!0}),1e4),n}return(0,B.ZT)(e,t),e.prototype.update=function(){var t=this.mapState,e=t.time,n=t.needRerender;this.mayCountMetrics?(this.catchNextUpdate&&(this.durations.push(e-this.startRenderTime),this.catchNextUpdate=!1),n&&(this.startRenderTime=e,this.catchNextUpdate=!0),this.durations.length>this.countToCheck&&this.check()):this.earlyTimes.push(e)},e.prototype.getEarlyFps=function(){if(!this.mayCountMetrics){for(var t=[],e=1;e<this.earlyTimes.length;e++)t.push(this.earlyTimes[e]-this.earlyTimes[e-1]);return Gt(t)}},e.prototype.check=function(){var t=Gt(this.durations);this.emit("fps",t),t<g.performanceCheck.fpsCaveat&&(this.mapState.performanceCaveatEmitted=!0,this.emit("performancecaveat")),this.durations=[],this.countToCheck=Math.min(1e3,2*this.countToCheck)},e}(j.c);function Gt(t){t.sort((function(t,e){return t-e}));var e=t[Math.floor(3*t.length/4)];return Math.round(1e3/e)}var Vt=n(7097),Wt=function(){function t(){this.differ=new Bt([{path:"center",type:"vec2"},{path:"zoom",type:"number"},{path:"rotation",type:"number"},{path:"pitch",type:"number"}]),this.debouncedSet=(0,Vt.D)((function(t){it.BL("stillness",{},t,t.stillness,1,400)}),100,!1),this.stillnessTickerUpdate=it.Vx.bind(null,"stillness",{step:function(t,e){t.stillness=e}})}return t.prototype.update=function(t){this.differ.check(t)&&(t.stillness=0,it.sT("stillness",t),this.debouncedSet(t)),this.stillnessTickerUpdate(t)},t}(),Xt=function(){function t(t){var e=this;this.onTouchStart=function(){e.isTouchStartEmitted=!0},this.onMouseOut=function(t){if(e.prevGeo){var n=L(e.container,t.clientX,t.clientY);Y("mouseout",e.prevGeo,t,n,e.modules),e.prevGeo=void 0,e.skipIdentifyEvents=!0,e.modules.defaultSource.resetHoverId(),e.container.classList.remove("mapgl-hover")}},this.onMouseMove=function(t){if(e.isTouchStartEmitted)e.isTouchStartEmitted=!1;else if(e.skipIdentifyEvents=!1,!e.isBlocked){var n=L(e.container,t.clientX,t.clientY);Promise.resolve().then((function(){return e.modules.layout.isActionWithCanvas(t)?e.modules.identifier.search("mouseMove",n):void 0})).then((function(i){if(!e.skipIdentifyEvents){var r=i&&e.prevGeo&&(!(0,G.v7)(i.id,e.prevGeo.id)||i.instanceId!==e.prevGeo.instanceId||i.dynamicObjectId!==e.prevGeo.dynamicObjectId||i.symbol!==e.prevGeo.symbol);!e.prevGeo||i&&!r||(Y("mouseout",e.prevGeo,t,n,e.modules),e.prevGeo=void 0,e.container.classList.remove("mapgl-hover"),e.modules.defaultSource.resetHoverId()),!i||e.prevGeo&&!r||(e.prevGeo=i,e.container.classList.add("mapgl-hover"),Y("mouseover",i,t,n,e.modules),e.modules.defaultSource.setHoverId(i.id)),Y("mousemove",i,t,n,e.modules)}}))}},this.modules=t,this.isTouchStartEmitted=!1,this.skipIdentifyEvents=!1,this.isBlocked=!1,this.prevGeo=void 0,this.container=this.modules.layout.mapContainer,this.container.addEventListener("touchstart",this.onTouchStart),this.container.addEventListener("mousemove",this.onMouseMove),this.container.addEventListener("mouseout",this.onMouseOut)}return t.prototype.destroy=function(){this.container.removeEventListener("touchstart",this.onTouchStart),this.container.removeEventListener("mousemove",this.onMouseMove),this.container.removeEventListener("mouseout",this.onMouseOut)},t.prototype.update=function(){},t.prototype.block=function(){this.isBlocked=!0},t.prototype.unblock=function(){this.isBlocked=!1},t}(),Yt=function(t,e,n,i){it.sT("buildingHeight"+i,t),!1===n.animate||0===n.duration?(e.set(i,n.to),t.needLabeling=!0):it.BL("buildingHeight"+i,{easing:n.easing},t,n.from,n.to,n.duration)},qt=function(){function t(t,e){this.state=t,this.modules=e,this.differ=new Bt([{path:"styleZoom",type:"number"}]),this.buildingHeights=new Map,this.minZoomBuildingHeight=1/0}return t.prototype.getBuildingHeight=function(t){return void 0!==t?(this.buildingHeights.has(t)||this.addBuildingHeightZoom(t),this.buildingHeights.get(t)||0):this.getDefaultBuildingHeight()},t.prototype.update=function(){var t=this;this.buildingHeights.forEach((function(e,n){t.updateByZoom(n,e),t.isAnimating()&&function(t,e,n){it.Vx.call(null,"buildingHeight"+n,{step:function(t,i){return e.set(n,i)},complete:function(t){return t.needLabeling=!0}},t)}(t.state,t.buildingHeights,n)}))},t.prototype.isAnimating=function(){var t=this;return Array.from(this.buildingHeights.keys()).some((function(e){return void 0!==it.U2("buildingHeight"+e,t.state)}))},t.prototype.clearBuildingHeights=function(){this.buildingHeights.clear(),this.minZoomBuildingHeight=1/0},t.prototype.getDefaultBuildingHeight=function(){var t=this.minZoomBuildingHeight!==1/0?this.minZoomBuildingHeight:16;return this.state.styleZoom<t?0:1},t.prototype.updateByZoom=function(t,e){var n=this.state,i=it.U2("zoom",n),r=it.U2("buildingHeight"+t,n),o=void 0!==r?r.to:e,a=void 0!==i?i.attributes.blockBuildingAnimation:this.differ.check(n);n.styleZoom>=t&&this.modules.tileManager.viewportTilesReady()&&1!==o&&!a?Yt(n,this.buildingHeights,{animate:!0,easing:g.buildingAnimation.easing,from:e,to:1,duration:g.buildingAnimation.duration*(1-e)},t):n.styleZoom<t&&0!==o&&Yt(n,this.buildingHeights,{animate:!1,to:0},t)},t.prototype.addBuildingHeightZoom=function(t){var e=t<this.state.styleZoom?0:1;this.buildingHeights.set(t,e),this.minZoomBuildingHeight>t&&(this.minZoomBuildingHeight=t)},t}(),Jt=n(834),Kt=function(){function t(){this._objects=[],this.type=0}return t.prototype.render=function(){return this._objects=[],this},t.prototype.addObject=function(t){return this._objects.push(t),this},t.prototype.hasObjects=function(){return this._objects.length>0},t}(),Qt=function(t){function e(){var e=t.call(this)||this;return e.type=17,e}return(0,B.ZT)(e,t),e.prototype.render=function(t){return this._objects.forEach((function(e){return e.render(t)})),this._objects=[],this},e}(Kt),$t=function(){function t(t){if((t=t||{}).canvas){this._canvasElement="string"==typeof t.canvas?document.getElementById(t.canvas):t.canvas;var e={antialias:void 0===t.antialias||t.antialias,stencil:void 0!==t.stencil&&t.stencil,failIfMajorPerformanceCaveat:void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,preserveDrawingBuffer:void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer};this._gl=2===t.version?this._canvasElement.getContext("webgl2",e):this._canvasElement.getContext("webgl",e)||this._canvasElement.getContext("experimental-webgl",e)}else this._gl=t.gl;this._pixelRatio=t.pixelRatio||1,this.autoClear=void 0===t.autoClear||t.autoClear,this.clearColor=t.clearColor||[1,1,1,1],this.sortObjects=!0,this._plugins=[],this._pluginsByType={},this._maxPluginOrder=0,this.addPlugin(new Qt,0),this.webGlExtensions={}}return t.prototype.addPlugin=function(t,e){return void 0===e&&(e=this._maxPluginOrder+1),this._plugins.push({plugin:t,order:e}),this._plugins.sort((function(t,e){return t.order-e.order})),this._pluginsByType[t.type]=t,this._maxPluginOrder=Math.max.apply(Math,this._plugins.map((function(t){return t.order}))),this},t.prototype.removePlugin=function(t){var e=this;return this._plugins.some((function(n,i){return n.plugin instanceof t&&(delete e._pluginsByType[e._plugins[i].plugin.type],e._plugins.splice(i,1),!0)})),this},t.prototype.setPixelRatio=function(t){return this._pixelRatio=t,this},t.prototype.getPixelRatio=function(){return this._pixelRatio},t.prototype.setSize=function(t,e){return this._size=[t*this._pixelRatio,e*this._pixelRatio],this._canvasElement&&(this._canvasElement.width=this._size[0],this._canvasElement.height=this._size[1],this._canvasElement.style.width=t+"px",this._canvasElement.style.height=e+"px"),this.setViewport(),this},t.prototype.setViewport=function(t,e){return void 0!==t&&void 0!==e?this._gl.viewport(0,0,t,e):this._gl.viewport(0,0,this._size[0],this._size[1]),this},t.prototype.getSize=function(){return this._size},t.prototype.setRenderTarget=function(t){return this._renderTarget=t,this},t.prototype.readPixels=function(t,e,n,i,r){var o=this._gl;return this._renderTarget?(this._renderTarget.bind(o),o.readPixels(t,e,n,i,o.RGBA,o.UNSIGNED_BYTE,r),this._renderTarget.unbind(o)):o.readPixels(t,e,n,i,o.RGBA,o.UNSIGNED_BYTE,r),this},t.prototype.clear=function(){var t=this._gl;return t.clearColor.apply(t,this.clearColor),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this},t.prototype.render=function(t,e,n){var i=this._gl;t.typifyForRender(this._pluginsByType),this._renderTarget&&this._renderTarget.bind(i),i.clearDepth(1),i.clearStencil(0),this.autoClear&&this.clear(),e.updateLocalMatrix(),e.updateWorldMatrix();for(var r={renderer:this,extensions:this.webGlExtensions,scene:t,camera:e,gl:i,userData:n},o=this._plugins.map((function(t){return t.plugin})).filter((function(t){return t.hasObjects()})),a=0;a<o.length;a++)o[a].render(r,o[a-1],o[a+1]);return this._renderTarget&&this._renderTarget.unbind(i),this},t.prototype.addExtension=function(t){return this.webGlExtensions[t]=this._gl.getExtension(t),this},t}(),te=function(){function t(e,n){void 0===n&&(n={}),this._src=e||null,this.options=Object.assign({},t.defaultOptions,n),this._glContext=null}return t.prototype.enable=function(t,e){var n=void 0!==e?e:this.options.unit;return void 0!==n&&t.activeTexture(t.TEXTURE0+n),this._texture||this.prepare(t),t.bindTexture(t.TEXTURE_2D,this._texture),this},t.prototype.remove=function(){return this._texture&&(this._glContext.deleteTexture(this._texture),this._glContext=null,this._texture=null),this},t.prototype.getTexture=function(){return this._texture},t.prototype.subImage=function(t,e,n,i){return t.bindTexture(t.TEXTURE_2D,this._texture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.options.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),t.texSubImage2D(t.TEXTURE_2D,0,n,i,this._toGlParam(t,this.options.format),this._toGlParam(t,this.options.type),e),this},t.prototype.prepare=function(e){return this._glContext=e,this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,this.options.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),this.options.size?e.texImage2D(e.TEXTURE_2D,0,this._toGlParam(e,this.options.format),this.options.size[0],this.options.size[1],0,this._toGlParam(e,this.options.format),this._toGlParam(e,this.options.type),this._src):e.texImage2D(e.TEXTURE_2D,0,this._toGlParam(e,this.options.format),this._toGlParam(e,this.options.format),this._toGlParam(e,this.options.type),this._src),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._toGlParam(e,this.options.wrapS)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._toGlParam(e,this.options.wrapT)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._toGlParam(e,this.options.magFilter)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._toGlParam(e,this.options.minFilter)),this.options.generateMipmaps&&this.options.minFilter!==t.NearestFilter&&this.options.minFilter!==t.LinearFilter&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),this},t.prototype._toGlParam=function(e,n){return n===t.ClampToEdgeWrapping?e.CLAMP_TO_EDGE:n===t.Repeat?e.REPEAT:n===t.MirroredRepeat?e.MIRRORED_REPEAT:n===t.NearestFilter?e.NEAREST:n===t.NearestMipMapNearestFilter?e.NEAREST_MIPMAP_NEAREST:n===t.NearestMipMapLinearFilter?e.NEAREST_MIPMAP_LINEAR:n===t.LinearFilter?e.LINEAR:n===t.LinearMipMapNearestFilter?e.LINEAR_MIPMAP_NEAREST:n===t.LinearMipMapLinearFilter?e.LINEAR_MIPMAP_LINEAR:n===t.RgbaFormat?e.RGBA:n===t.AlphaFormat?e.ALPHA:n===t.RgbFormat?e.RGB:n===t.UnsignedByte?e.UNSIGNED_BYTE:n===t.Float?e.FLOAT:null},t}();te.ClampToEdgeWrapping=8,te.Repeat=9,te.MirroredRepeat=10,te.NearestFilter=1,te.NearestMipMapNearestFilter=2,te.NearestMipMapLinearFilter=3,te.LinearFilter=4,te.LinearMipMapNearestFilter=5,te.LinearMipMapLinearFilter=6,te.RgbaFormat=11,te.AlphaFormat=12,te.RgbFormat=13,te.UnsignedByte=14,te.Float=15,te.defaultOptions={magFilter:te.LinearFilter,minFilter:te.LinearMipMapLinearFilter,wrapS:te.ClampToEdgeWrapping,wrapT:te.ClampToEdgeWrapping,format:te.RgbaFormat,generateMipmaps:!0,flipY:!0,premultiplyAlpha:!0,type:te.UnsignedByte};var ee=te,ne=function(){function t(e){void 0===e&&(e={}),this.options=Object.assign({},t.defaultOptions,e),this._texture=new ee(null,this.options),this._glContext=null}return t.prototype.bind=function(t){return this._frameBuffer||this._prepare(t),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this},t.prototype.unbind=function(t){return t.bindFramebuffer(t.FRAMEBUFFER,null),this},t.prototype.remove=function(){return this._unprepare(),this},t.prototype.setSize=function(t){return this.options.size=t,this._unprepare(),this},t.prototype.getTexture=function(){return this._texture},t.prototype._prepare=function(t){this._glContext=t,this._texture||(this._texture=new ee(null,this.options)),this._texture.prepare(t),this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.options.size[0],this.options.size[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture.getTexture(),0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._renderBuffer),this._checkComplete(t),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},t.prototype._unprepare=function(){this._texture&&(this._texture.remove(this._glContext),this._texture=null),this._frameBuffer&&(this._glContext.deleteFramebuffer(this._frameBuffer),this._glContext.deleteRenderbuffer(this._renderBuffer),this._frameBuffer=null,this._renderBuffer=null)},t.prototype._checkComplete=function(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);e!==t.FRAMEBUFFER_COMPLETE&&(e===t.FRAMEBUFFER_UNSUPPORTED?console.log("Framebuffer is unsupported"):e===t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT?console.log("Framebuffer incomplete attachment"):e===t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS?console.log("Framebuffer incomplete dimensions"):e===t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT?console.log("Framebuffer incomplete missing attachment"):console.log("Unexpected framebuffer status: "+e))},t}();ne.defaultOptions=Object.assign({},ee.defaultOptions,{size:[0,0],generateMipmaps:!1});var ie=ne,re=n(242),oe=(g.floors.wallMinBrightness,g.floors.wallMaxBrightness,g.fences.lightIntensity),ae=[oe,oe,oe],se=[.05,.05,.05],le=[1,0,0],ce=[1,1,1],ue=function(){},de=function(t,e,n){var i=n.size,r=window.devicePixelRatio;e.bind(t,{u_vec2_vpt_size:[i[0]*r,i[1]*r]})},he=function(t,e,n){var i=(0,x.EO)(n.zoom);e.bind(t,{u_vec3_projection_scale_style_scale_dpi:[i,i,re.$U*window.devicePixelRatio]})},fe=function(t,e,n){var i=(0,x.EO)(n.styleZoom);e.bind(t,{u_vec3_projection_scale_style_scale_dpi:[i,i,re.$U*window.devicePixelRatio]})},pe=function(t,e,n,i){e.bind(t,{u_float_height_factor:i.buildingHeightAnimator.getDefaultBuildingHeight()})},me=function(t,e,n){e.bind(t,{u_float_height_limitation:(0,x.r9)(n.zoom,n.size)*Math.cos(n.pitch)*.75,u_float_tile_height:re._9})},ve=function(t,e){e.bind(t,{u_float_height_limitation:re._9,u_float_tile_height:re._9})},_e=function(t,e){e.bind(t,{u_vec3_light_color:se,u_vec3_light_direction:le,u_vec3_ambient_color:ce})},ye=function(t,e){e.bind(t,{u_vec3_light_color:ae,u_vec3_light_direction:le,u_vec3_ambient_color:ce})},ge=function(t,e,n){e.bind(t,{u_float_rounding_factor:n.stillness})},be=function(t,e){e.bind(t,{u_float_border_width_offset:1/window.devicePixelRatio})},xe=function(t,e){e.bind(t,{u_float_z_offset:0})},we=function(t,e){e.bind(t,{u_float_z_offset:-1e-5})},Ie=function(t,e){e.bind(t,{u_sr2d_texture:0})},Se=function(t,e){e.bind(t,{u_vec2_scale_limits:[0,re.Cd]})},Me=function(t,e){e.bind(t,{u_vec4_border_color:[0,0,0,0]})},Pe=function(t,e){e.bind(t,{u_vec4_space_color:[0,0,0,0]})},Te=function(t,e,n,i){i.assetManager.textures.forEach((function(e){return e.enable(t)}))};function ke(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e,n,i,r){t.forEach((function(t){return t(e,n,i,r)}))}}var Le=n(1245),ze=n(7244),Ee=n(5850),Ce=n(8550),Ae=n(127),De=n(5424),Re=n(558),Oe=n(7322),Fe=function(){function t(t,e){void 0===e&&(e={}),this._buffer=t,this.options=Object.assign({},Oe.Z.defaultOptions,e)}return t.prototype.bind=function(t,e){this._buffer.bind(t,e,this.options)},t}(),Be=function(){function t(t,e){void 0===e&&(e={}),this._vao=null,this._attributes=e,this._shaderProgram=t,this._ext=null}return t.prototype.bind=function(t){var e=t.extensions.OES_vertex_array_object;return e?this._bind(t.gl,e):this._shaderProgram.bind(t.gl,null,this._attributes),this},t.prototype.unbind=function(){return this._ext&&this._ext.bindVertexArrayOES(null),this},t.prototype.remove=function(){return this._vao&&this._ext.deleteVertexArrayOES(this._vao),this},t.prototype._bind=function(t,e){this._vao?e.bindVertexArrayOES(this._vao):this._prepare(t,e)},t.prototype._prepare=function(t,e){this._ext=e,this._vao=e.createVertexArrayOES(),e.bindVertexArrayOES(this._vao);var n=this._shaderProgram.attributes,i=this._attributes;for(var r in i){var o=n[r];!0!==o.index&&t.enableVertexAttribArray(o.location),i[r].bind(t,o.location)}},t}(),je=n(2089),Ze=n(2004),Ue=n(5855),Ne=n(1524),He=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:8,offset:0,normalized:!0});return new Be(e,{a_vec2_vertex:n})},Ge=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:8,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:8,offset:4,normalized:!0});return new Be(e,{a_vec2_vertex:n,a_vec4_identifier:i})},Ve=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:12,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:12,offset:4,normalized:!1});return new Be(e,{a_vec2_vertex:n,a_vec4_normals:i})},We=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:16,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:16,offset:4,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Float,stride:16,offset:8,normalized:!1});return new Be(e,{a_vec2_vertex:n,a_vec4_normals:i,a_vec2_shift:r})},Xe=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:12,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:12,offset:4,normalized:!1}),r=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:12,offset:8,normalized:!0});return new Be(e,{a_vec2_vertex:n,a_vec4_normals:i,a_vec4_identifier:r})},Ye=function(t,e){var n=28,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:4,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Byte,stride:n,offset:8,normalized:!1}),a=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:12,normalized:!1}),s=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:16,normalized:!1}),l=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:20,normalized:!1}),c=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:n,offset:24,normalized:!0});return new Be(e,{a_vec2_vertex:i,a_vec2_texture_widen:o,a_vec2_widen:r,a_float_vertex_distance:a,a_float_component_distance:s,a_float_object_length:l,a_vec4_identifier:c})},qe=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:20,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:20,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:20,offset:12,normalized:!1});return new Be(e,{a_vec4_position:n,a_vec2_offset:i,a_vec2_texcoord:r})},Je=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:20,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:20,offset:8,normalized:!1}),r=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:20,offset:16,normalized:!0});return new Be(e,{a_vec4_position:n,a_vec2_offset:i,a_vec4_identifier:r})},Ke=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:28,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:28,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Float,stride:28,offset:12,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Float,stride:28,offset:20,normalized:!1});return new Be(e,{a_vec4_position:n,a_vec2_offset:r,a_vec2_texcoord:i,a_vec2_style_zoom_limits:o})},Qe=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:20,offset:0,normalized:!0}),i=new Fe(t,{itemSize:3,dataType:Oe.Z.Byte,stride:20,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:20,offset:16,normalized:!1});return new Be(e,{a_vec3_vertex:n,a_vec3_normal:i,a_vec2_dem_position:r})},$e=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:20,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:20,offset:12,normalized:!0}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:20,offset:16,normalized:!1});return new Be(e,{a_vec3_vertex:n,a_vec4_identifier:i,a_vec2_dem_position:r})},tn=function(t,e){var n=20,i=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:1,dataType:Oe.Z.Short,stride:n,offset:6,normalized:!0}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Byte,stride:n,offset:8,normalized:!1}),a=new Fe(t,{itemSize:2,dataType:Oe.Z.Byte,stride:n,offset:10,normalized:!1}),s=new Fe(t,{itemSize:3,dataType:Oe.Z.Byte,stride:n,offset:12,normalized:!1}),l=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:16,normalized:!1});return new Be(e,{a_vec4_vertex:i,a_vec2_normal:o,a_vec2_normal_delta:a,a_vec3_direction:s,a_float_distance:r,a_vec2_dem_position:l})},en=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:24,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:24,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:24,offset:12,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:24,offset:16,normalized:!1});return new Be(e,{a_vec3_position:n,a_vec2_offset:i,a_vec2_texcoord:r,a_vec2_range:o})},nn=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:24,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:24,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:24,offset:12,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:24,offset:16,normalized:!1}),a=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:24,offset:20,normalized:!0});return new Be(e,{a_vec3_position:n,a_vec2_offset:i,a_vec2_texcoord:r,a_vec2_range:o,a_vec4_identifier:a})},rn=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:16,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:16,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:16,offset:12,normalized:!1});return new Be(e,{a_vec2_position:n,a_vec2_direction:i,a_vec2_widen_direction:r})},on=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:20,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:20,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:20,offset:16,normalized:!1});return new Be(e,{a_vec3_vertex:n,a_vec2_texcoord:i,a_vec2_dem_position:r})},an=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:8,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:8,offset:4,normalized:!1});return new Be(e,{a_vec3_vertex:n,a_vec4_direction_distance:i})},sn=function(t,e){var n=new Fe(t,{itemSize:3,dataType:Oe.Z.UnsignedShort,stride:16,offset:0,normalized:!0}),i=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:16,offset:8,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:16,offset:12,normalized:!1});return new Be(e,{a_vec3_vertex:n,a_vec4_direction_distance:i,a_vec2_dem_position:r})},ln=function(t,e){var n=36,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:4,normalized:!0}),o=new Fe(t,{itemSize:4,dataType:Oe.Z.Byte,stride:n,offset:8,normalized:!1}),a=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:12,normalized:!1}),s=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:16,normalized:!1}),l=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:20,normalized:!1}),c=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:24,normalized:!1}),u=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:28,normalized:!1}),d=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:n,offset:32,normalized:!0});return new Be(e,{a_vec2_vertex:i,a_vec2_segment_end:r,a_vec4_texture_widen_arrow_widen:o,a_vec2_widen:a,a_vec2_direction:s,a_float_distance_from_start:l,a_float_object_length:c,a_float_type:u,a_vec4_identifier:d})},cn=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:12,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:12,offset:4,normalized:!1});return new Be(e,{a_vec4_vertex:n,a_vec2_widen:i})},un=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:12,offset:0,normalized:!0}),i=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:12,offset:4,normalized:!1}),r=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:12,offset:8,normalized:!0});return new Be(e,{a_vec4_vertex:n,a_vec2_widen:i,a_vec4_identifier:r})},dn=function(t,e){var n=je.z.sinks.fill.stride,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:4,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:8,normalized:!1});return new Be(e,{a_vec2_position:i,a_vec2_offset:r,a_vec2_texcoord:o})},hn=function(t,e){var n=je.z.sinks.fill.stride,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!1}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.Short,stride:n,offset:4,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:8,normalized:!1}),a=new Fe(t,{itemSize:4,dataType:Oe.Z.UnsignedByte,stride:n,offset:12,normalized:!0});return new Be(e,{a_vec2_position:i,a_vec2_offset:r,a_vec2_texcoord:o,a_vec4_identifier:a})},fn=function(t,e){var n=Ze.h.sinks.fill.stride,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:4,normalized:!1});return new Be(e,{a_vec2_vertex:i,a_vec2_texcoord:r})},pn=function(t,e){var n=Ue.B.sinks.framebuffer.stride,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:1,dataType:Oe.Z.Float,stride:n,offset:4,normalized:!1}),o=new Fe(t,{itemSize:2,dataType:Oe.Z.Byte,stride:n,offset:8,normalized:!1});return new Be(e,{a_vec2_position:i,a_vec2_widen:o,a_float_weight:r})},mn=function(t,e){var n=new Fe(t,{itemSize:2,dataType:Oe.Z.Float,stride:0,offset:0,normalized:!1});return new Be(e,{a_vec2_position:n})},vn=function(t,e){return new Be(e,{a_vec2_position:t})},_n=function(t,e){var n=Ne._.sinks.elevation.stride,i=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:0,normalized:!0}),r=new Fe(t,{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:n,offset:4,normalized:!1});return new Be(e,{a_vec2_vertex:i,a_vec2_texcoord:r})},yn=n(6384),gn=n(9460),bn=function(){function t(t,e){var n;this.destroyed=!1,this.modules=t.modules,this.program=this.modules.renderer.getShaderProgram("demMesh"),this.tiles=new Map,this.edgesCount=void 0!==e.tileSize?Math.pow(2,Math.trunc(Math.log2(e.tileSize))):64,this.maxZoom=null!==(n=e.maxZoom)&&void 0!==n?n:13;for(var i=[],r=0;r<this.edgesCount;r++)for(var o=0;o<this.edgesCount;o++)i.push(r,o,r+1,o,r,o+1),i.push(r,o+1,r+1,o,r+1,o+1);for(var a=re.Bq/this.edgesCount,s=0;s<i.length;s++)i[s]*=a;this.buffer=new Oe.Z(new Uint16Array(i),{itemSize:2,dataType:Oe.Z.UnsignedShort,stride:0,offset:0,normalized:!0}),this.buffer.drawType=Oe.Z.StaticDraw,this.vao=vn(this.buffer,this.program)}return t.prototype.updateStyleId=function(){var t=this;this.tiles.forEach((function(e){e.children.forEach((function(e){e.attributes.styleId=t.modules.map.state.handyStyleId})),e.identifyChildren.forEach((function(e){e.attributes.styleId=t.modules.map.state.handyStyleId}))}))},t.prototype.updateView=function(){var t=this;if(!this.destroyed){var e=this.modules.map.state,n=Math.trunc(e.styleZoom),i=Math.min(n,Math.max(this.maxZoom,n-2)),r=(0,K.aq)(i)/this.edgesCount/2,o=(0,K.b5)(this.modules.map.state,i,0,i).reduce((function(t,e){return t.set((0,K.gx)(e),e),t}),new Map);this.tiles.forEach((function(e,n){o.has(n)||(t.modules.tileManager.removeObject(e),t.tiles.delete(n))})),o.forEach((function(n,i){var o;if(!t.tiles.has(i)){var a=new H.W("raster",[],t.modules.renderer,n);a.modelMatrix[12]+=r,a.modelMatrix[13]+=r,null===(o=t.modules.renderer.symbolSettingsList.dem.mesh)||void 0===o||o.forEach((function(n){var i={type:yn.H.Tile,symbol:"dem",sink:"mesh",tile:a,attributes:{layerId:gn.h,styleId:e.handyStyleId,tileData:[]},stride:4,rangeStart:0,rangeEnd:t.buffer.byteLength,attributesHash:"",layerSettings:n,vao:t.vao};!0===n.identify?a.identifyChildren.push(i):a.children.push(i)})),t.modules.tileManager.addObject(a),t.tiles.set(i,a)}}))}},t.prototype.destroy=function(){var t=this;this.destroyed||(this.tiles.forEach((function(e){t.modules.tileManager.removeObject(e)})),this.tiles.clear(),this.vao.unbind(),this.vao.remove(),this.buffer.remove(),this.destroyed=!0)},t}(),xn=n(3287);function wn(){var t=new xn.WT(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function In(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Sn(){var t=new xn.WT(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}Le.d9,Le.al,Le.JG,Le.t8,Le.IH,Le.bA,Le.AK,Le.t7,Le.kE,Le.we,Le.Fv,Le.I6,Le.fS,I.Ue(),I.al(1,0,0),I.al(0,1,0),Sn(),Sn(),wn();var Mn=function(){function t(){this.children=[],this.parent=null,this.visible=!0,this.scale=I.al(1,1,1),this.position=I.Ue(),this.quaternion=Sn(),this.localMatrix=Ae.Ue(),this.worldMatrix=Ae.Ue(),this.worldMatrixNeedsUpdate=!1,this.type=12}return t.prototype.add=function(t){return t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),this},t.prototype.remove=function(t){var e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1)),this},t.prototype.render=function(){return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),this):this},t.prototype.updateLocalMatrix=function(){return Ae.Iw(this.localMatrix,this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0,this},t.prototype.updateWorldMatrix=function(){return this.parent?Ae.dC(this.worldMatrix,this.parent.worldMatrix,this.localMatrix):Ae.JG(this.worldMatrix,this.localMatrix),this.children.forEach((function(t){return t.updateWorldMatrix()})),this.worldMatrixNeedsUpdate=!1,this},t.prototype.getWorldPosition=function(){return I.al(this.worldMatrix[12],this.worldMatrix[13],this.worldMatrix[14])},t.prototype.traverse=function(t){return t(this),this.children.forEach((function(e){return e.traverse(t)})),this},t.prototype.traverseVisible=function(t){return this.visible?(t(this),this.children.forEach((function(e){return e.traverseVisible(t)})),this):this},t.prototype.typifyForRender=function(t){return this.visible?(t[17].addObject(this),this.children.forEach((function(e){return e.typifyForRender(t)})),this):this},t}(),Pn=function(t){function e(e){var n=t.call(this)||this;return n.color=e,n}return(0,B.ZT)(e,t),e}(Mn);!function(t){(0,B.ZT)((function(e){var n=t.call(this,e)||this;return n.type=3,n}),t)}(Pn);var Tn={texture:"USE_TEXTURE",directionLights:"DIR_LIGHT_NUM"},kn=function(){function t(t){this.name=t.name,this.index=t.index,this.location=void 0!==t.location?t.location:-1,this._enable=!1}return t.prototype.bindLocation=function(t,e){return-1!==this.location&&!0!==this.index&&t.bindAttribLocation(e,this.location,this.name),this},t.prototype.getLocation=function(t,e){return-1===this.location&&!0!==this.index&&(this.location=t.getAttribLocation(e,this.name)),this},t.prototype.bind=function(t,e){return this._enable||!0===this.index||(t.enableVertexAttribArray(this.location),this._enable=!0),e.bind(t,this.location),this},t.prototype.disable=function(t){return this._enable&&!0!==this.index&&(t.disableVertexAttribArray(this.location),this._enable=!1),this},t}(),Ln=function(){function t(t){this.name=t.name,this.type=t.type,this.location=-1}return t.prototype.getLocation=function(t,e){return this.location=t.getUniformLocation(e,this.name),this},t.prototype.bind=function(t,e){var n=this.type;return"mat2"===n?t.uniformMatrix2fv(this.location,!1,e):"mat3"===n?t.uniformMatrix3fv(this.location,!1,e):"mat4"===n?t.uniformMatrix4fv(this.location,!1,e):"2f"===n?t.uniform2f(this.location,e[0],e[1]):"3f"===n?t.uniform3f(this.location,e[0],e[1],e[2]):"4f"===n?t.uniform4f(this.location,e[0],e[1],e[2],e[3]):"2i"===n?t.uniform2i(this.location,e[0],e[1]):"3i"===n?t.uniform3i(this.location,e[0],e[1],e[2]):"4i"===n?t.uniform4i(this.location,e[0],e[1],e[2],e[3]):t["uniform"+n](this.location,e),this},t}(),zn=function(){function t(t){var e=this;t=t||{},this._vertexShader=t.vertex,this._fragmentShader=t.fragment,this.uniforms={},t.uniforms=t.uniforms||[],t.uniforms.forEach((function(t){e.uniforms[t.name]=new Ln(t)})),this.attributes={},t.attributes=t.attributes||[],t.attributes.forEach((function(t){e.attributes[t.name]=new kn(t)})),this._linked=!1,this._located=!1,this._error=!1}return t.prototype.enable=function(t){return this._error||(this.link(t),this.locate(t),this._error||t.useProgram(this._webglProgram)),this},t.prototype.bind=function(t,e,n){if(this._error)return this;if(e)for(var i in e)this.uniforms[i].bind(t,e[i]);if(n)for(var i in n)this.attributes[i].bind(t,n[i]);return this},t.prototype.disable=function(t){if(this._error)return this;for(var e in this.attributes)this.attributes[e].disable(t);return this},t.prototype.link=function(t){if(this._linked||this._error)return this;try{for(var e in this._webglProgram=t.createProgram(),this._vertexShader&&t.attachShader(this._webglProgram,this._vertexShader.get(t)),this._fragmentShader&&t.attachShader(this._webglProgram,this._fragmentShader.get(t)),this.attributes)this.attributes[e].bindLocation(t,this._webglProgram);if(t.linkProgram(this._webglProgram),!t.getProgramParameter(this._webglProgram,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(this._webglProgram));this._linked=!0}catch(t){throw this._error=!0,t}return this},t.prototype.locate=function(t){if(this._located||this._error)return this;for(var e in this.attributes)this.attributes[e].getLocation(t,this._webglProgram);for(var e in this.uniforms)this.uniforms[e].getLocation(t,this._webglProgram);return this._located=!0,this},t}(),En=function(){function t(e,n,i){void 0===i&&(i=[]),this.type="vertex"===e?t.Vertex:t.Fragment,this._code=Array.isArray(n)?n.join("\n"):n||"",this._code=i.map((function(t){return void 0!==t.value?"#define "+t.type+" "+t.value:"#define "+t.type})).join("\n")+"\n"+this._code}return t.prototype.get=function(t){return this._shader||this._compile(t),this._shader},t.prototype.remove=function(t){this._shader&&t.deleteShader(this._shader)},t.prototype._compile=function(e){var n=this.type===t.Vertex?e.VERTEX_SHADER:e.FRAGMENT_SHADER,i=this._shader=e.createShader(n);if(!i||e.isContextLost())throw new Error("[2gl] Failed to create shader. Shader is null: ".concat(!i,". Context is lost: ").concat(e.isContextLost()));if(e.shaderSource(i,this._code),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(i))},t}();En.Vertex=1,En.Fragment=2;var Cn=En,An={},Dn=function(){function t(){this._attributes=[],this._uniforms=[{name:"uColorAlpha",type:"1f"}],this._definitions=[],this._shader=null,this.opacity=1}return t.prototype.enable=function(t){return this._shaderProgram||this._prepare(t),this._shaderProgram.enable(t.gl),this._shaderProgramBind(t),this},t.prototype.disable=function(t){return this._shaderProgram&&this._shaderProgram.disable(t),this},t.prototype.define=function(t,e){return Tn[t]&&this._definitions.push({type:Tn[t],value:e}),this},t.prototype.typifyForRender=function(t,e){1===this.opacity?t[13].addObject(e):t[14].addObject(e)},t.prototype._getCachedProgramKey=function(){var t=this.constructor.name;return this._definitions.forEach((function(e){t+=":"+e.type+":"+(e.value||"")})),t},t.prototype._getCachedProgram=function(){return An[this._getCachedProgramKey()]},t.prototype._prepare=function(t){var e=this._getCachedProgram();e&&t===e.glContext?this._shaderProgram=e.program:(this._shaderProgram=new zn({vertex:new Cn("vertex",this._shader.vertex,this._definitions),fragment:new Cn("fragment",this._shader.fragment,this._definitions),uniforms:this._uniforms,attributes:this._attributes}),An[this._getCachedProgramKey()]={glContext:t,program:this._shaderProgram})},t.prototype._shaderProgramBind=function(t){var e=t.gl,n=t.object,i={};this._attributes.forEach((function(t){i[t.name]=n.geometry.getBuffer(t.name)}));var r={uColorAlpha:this.opacity};this._shaderProgram.bind(e,r,i)},t}(),Rn={fragment:"\nprecision mediump float;\n\nuniform float uColorAlpha;\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor.rgb, uColorAlpha);\n}\n",vertex:"\nattribute vec3 position;\n\nuniform mat4 uPosition;\nuniform mat4 uCamera;\nuniform vec3 uColor;\nuniform vec3 uEmissive;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n    vColor = uColor;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n"};!function(t){function e(){var e=t.call(this)||this;return e._attributes=[{name:"position"}],e._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uColor",type:"3fv"}],e._shader=Rn,e.color=[0,0,0],e.type=5,e}(0,B.ZT)(e,t),e.prototype._shaderProgramBind=function(t){var e=t.gl,n=t.object,i=t.camera,r={};this._attributes.forEach((function(t){r[t.name]=n.geometry.getBuffer(t.name)}));var o={uColorAlpha:this.opacity,uPosition:new Float32Array(n.worldMatrix),uCamera:new Float32Array(i.modelViewMatrix),uColor:this.color};this._shaderProgram.bind(e,o,r)}}(Dn);var On=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._array=e,i.length=e.length/i.options.itemSize,i}return(0,B.ZT)(e,t),e.prototype.getArray=function(){return this._array},e.prototype.getElement=function(t){return this._array.subarray(t*this.options.itemSize,(t+1)*this.options.itemSize)},e.prototype.getTriangle=function(t){return t*=3,[this.getElement(t),this.getElement(t+1),this.getElement(t+2)]},e.prototype.concat=function(t){var e=t.getArray(),n=new this._array.constructor(this._array.length+e.length);return n.set(this._array,0),n.set(e,this._array.length),this._array=n,this.length=n.length/this.options.itemSize,this},e}(Oe.Z),Fn=function(){function t(t,e){this.min=t||I.Ue(),this.max=e||I.Ue()}return t.prototype.containsPoint=function(t){return t[0]>this.min[0]&&t[0]<this.max[0]&&t[1]>this.min[1]&&t[1]<this.max[1]&&t[2]>this.min[2]&&t[2]<this.max[2]},t.prototype.expandByPoint=function(t){return I.VV(this.min,this.min,t),I.Fp(this.max,this.max,t),this},t}();!function(t){function e(){var e=t.call(this)||this;return e.type=13,e}(0,B.ZT)(e,t),e.prototype.render=function(t){var e=t.gl;return e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.cullFace(e.BACK),e.enable(e.CULL_FACE),e.disable(e.BLEND),t.renderer.sortObjects&&this._objects.sort(this._renderOrderSort),this._objects.forEach((function(e){return e.render(t)})),this._objects=[],this},e.prototype._renderOrderSort=function(t,e){return t.renderOrder-e.renderOrder}}(Kt);var Bn={fragment:"\nprecision mediump float;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D uTexture;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\nuniform float uColorAlpha;\nvarying vec3 vLightWeighting;\nvarying vec3 vColor;\nvarying vec3 vEmissive;\n\nvoid main(void) {\n    vec4 color = vec4(vColor.rgb, uColorAlpha);\n\n    #ifdef USE_TEXTURE\n        if (vTextureEnable > 0.5) {\n            vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n            color = vec4(textureColor.rgb * color.rgb, color.a);\n        }\n    #endif\n\n    gl_FragColor = vec4(color.rgb * vLightWeighting + vEmissive, color.a);\n}\n",vertex:"\nattribute vec3 position;\nattribute vec3 color;\nattribute vec3 emissive;\n\n#ifdef USE_TEXTURE\n    attribute vec2 texture;\n    attribute float textureEnable;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\n#if DIR_LIGHT_NUM > 0\n    attribute vec3 normal;\n    uniform vec3 uDirectionLightColors[DIR_LIGHT_NUM];\n    uniform vec3 uDirectionLightPositions[DIR_LIGHT_NUM];\n    uniform mat3 uNormalMatrix;\n#endif\n\nuniform mat4 uPosition;\nuniform vec3 uAmbientLightColor;\nuniform mat4 uCamera;\n\nvarying vec3 vColor;\nvarying vec3 vEmissive;\nvarying vec3 vLightWeighting;\n\nvoid main(void) {\n    vColor = color;\n    vEmissive = emissive;\n\n    #ifdef USE_TEXTURE\n        vTextureCoord = texture;\n        vTextureEnable = textureEnable;\n    #endif\n\n    vec3 vLightTemp = vec3(0.0);\n\n    #if DIR_LIGHT_NUM > 0\n        vec3 transformedNormal = uNormalMatrix * normal;\n\n        for(int i = 0; i < DIR_LIGHT_NUM; i++) {\n            float dotProduct = dot(transformedNormal, uDirectionLightPositions[i]);\n            vec3 directionalLightWeighting = vec3(max(dotProduct, 0.0));\n            vLightTemp += uDirectionLightColors[i] * directionalLightWeighting;\n        }\n    #endif\n\n    vLightWeighting = uAmbientLightColor + vLightTemp;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n"};!function(t){function e(){var e=t.call(this)||this;return e._attributes=[{name:"position"},{name:"color"},{name:"emissive"}],e._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uAmbientLightColor",type:"3fv"}],e._shader=Bn,e._texture=null,e.type=6,e}(0,B.ZT)(e,t),e.prototype.setTexture=function(t){return this._texture=t,this},e.prototype.getTexture=function(){return this._texture},e.prototype._prepare=function(e){this._enableLight(e),this._texture&&this._enableTexture(),t.prototype._prepare.call(this,e)},e.prototype._enableLight=function(t){var e=t.scene,n=0;e.getLights().forEach((function(t){4===t.type&&n++})),this.define("directionLights",n),n>0&&(this._attributes.push({name:"normal"}),this._uniforms.push({name:"uDirectionLightColors",type:"3fv"},{name:"uDirectionLightPositions",type:"3fv"},{name:"uNormalMatrix",type:"mat3"}))},e.prototype._enableTexture=function(){this.define("texture"),this._attributes.push({name:"texture"},{name:"textureEnable"}),this._uniforms.push({name:"uTexture",type:"1i"})},e.prototype._shaderProgramBind=function(t){var e=t.gl,n=t.scene,i=t.camera,r=t.object,o={},a={};this._texture&&(this._texture.enable(e,0),o.uTexture=0);var s,l,c,u,d,h,f,p,m,v,_,y,g,b,x,w=n.getLights();if(w.length){var S=[],M=[];if(w.forEach((function(t){if(3===t.type)o.uAmbientLightColor=t.color;else if(4===t.type){S=S.concat(t.color);var e=I.Ue();I.bA(e,t.position,-1),M=M.concat(Array.prototype.slice.call(e))}})),S.length&&M.length){var P=wn();In(P,r.worldMatrix),s=P,c=(l=P)[0],u=l[1],d=l[2],h=l[3],f=l[4],p=l[5],m=l[6],v=l[7],(x=c*(y=(_=l[8])*f-p*v)+u*(g=-_*h+p*m)+d*(b=v*h-f*m))&&(x=1/x,s[0]=y*x,s[1]=(-_*u+d*v)*x,s[2]=(p*u-d*f)*x,s[3]=g*x,s[4]=(_*c-d*m)*x,s[5]=(-p*c+d*h)*x,s[6]=b*x,s[7]=(-v*c+u*m)*x,s[8]=(f*c-u*h)*x),function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(P,P),o.uNormalMatrix=new Float32Array(P),a.normal=r.geometry.getBuffer("normal")}o.uDirectionLightColors=new Float32Array(S),o.uDirectionLightPositions=new Float32Array(M)}this._attributes.forEach((function(t){"normal"!==t.name&&(a[t.name]=r.geometry.getBuffer(t.name))})),o.uPosition=new Float32Array(r.worldMatrix),o.uCamera=new Float32Array(i.modelViewMatrix),o.uColorAlpha=this.opacity,this._shaderProgram.bind(e,o,a)}}(Dn),function(t){(0,B.ZT)((function(e){var n=t.call(this,e)||this;return n.type=4,n}),t)}(Pn);var jn=function(){function t(t,e){this.normal=t||I.Ue(),this.constant=e||0}return t.prototype.distanceToPoint=function(t){return I.AK(this.normal,t)+this.constant},t.prototype.setComponents=function(t,e,n,i){return I.t8(this.normal,t,e,n),this.constant=i,this},t.prototype.normalize=function(){var t=1/I.Zh(this.normal);return I.bA(this.normal,this.normal,t),this.constant*=t,this},t}();!function(){function t(t){this.planes=t,this.planes&&6===this.planes.length||(this.planes=[new jn,new jn,new jn,new jn,new jn,new jn]),this._v1=I.Ue(),this._v2=I.Ue()}t.prototype.setFromMatrix=function(t){var e=this.planes;return e[0].setComponents(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]).normalize(),e[1].setComponents(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]).normalize(),e[2].setComponents(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]).normalize(),e[3].setComponents(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]).normalize(),e[4].setComponents(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]).normalize(),e[5].setComponents(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]).normalize(),this},t.prototype.intersectsBox=function(t){for(var e=this._v1,n=this._v2,i=this.planes,r=t.min,o=t.max,a=0;a<6;a++){var s=i[a],l=s.normal;e[0]=l[0]>0?r[0]:o[0],n[0]=l[0]>0?o[0]:r[0],e[1]=l[1]>0?r[1]:o[1],n[1]=l[1]>0?o[1]:r[1],e[2]=l[2]>0?r[2]:o[2],n[2]=l[2]>0?o[2]:r[2];var c=s.distanceToPoint(e),u=s.distanceToPoint(n);if(c<0&&u<0)return!1}return!0}}();var Zn=function(){function t(){this.buffers={},this._boundingBox=null}return t.prototype.setBuffer=function(t,e){return this.buffers[t]=e,this},t.prototype.getBuffer=function(t){return this.buffers[t]},t.prototype.computeNormals=function(){var t=this.buffers.position;if(!t)return this;for(var e=new Float32Array(t.length*t.options.itemSize),n=I.Ue(),i=I.Ue(),r=I.Ue(),o=0;o<t.length;o+=3){var a=t.getTriangle(o/3);I.lu(n,a[0],a[1]),I.lu(i,a[2],a[1]),I.kC(r,n,i),I.Fv(r,r),e.set(r,3*o),e.set(r,3*(o+1)),e.set(r,3*(o+2))}return this.setBuffer("normal",new On(e,{itemSize:3})),this},t.prototype.getBoundingBox=function(){return this._boundingBox||this.computeBoundingBox(),this._boundingBox},t.prototype.computeBoundingBox=function(){var t=this._boundingBox=new Fn,e=this.buffers.position;if(e)for(var n=0;n<e.length;n++)t.expandByPoint(e.getElement(n))},t.prototype.concat=function(t){for(var e in this.buffers)this.buffers[e].concat(t.buffers[e])},t}();!function(t){function e(e,n){var i=t.call(this)||this;return i.geometry=e,i.material=n,i.renderOrder=0,i.type=9,i}(0,B.ZT)(e,t),e.prototype.render=function(t){var e=t.gl;return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),t.object=this,this.material.enable(t),e.drawArrays(e.TRIANGLES,0,this.geometry.getBuffer("position").length),this.material.disable(e),this):this},e.prototype.typifyForRender=function(t){return this.visible?(this.material.typifyForRender(t,this),this.children.forEach((function(e){return e.typifyForRender(t)})),this):this}}(Mn),function(){function t(t,e){this.start=t||I.Ue(),this.end=e||I.Ue()}t.prototype.closestPointToPointParameter=function(t,e){var n=I.Ue(),i=I.Ue();I.lu(n,t,this.start),I.lu(i,this.end,this.start);var r,o=I.AK(i,i),a=I.AK(i,n)/o;return e&&(a=(r=a)<0?0:r>1?1:r),a},t.prototype.closestPointToPoint=function(t,e,n){var i=this.closestPointToPointParameter(t,e),r=n||I.Ue();return r=this.delta(r),I.bA(r,r,i),I.IH(r,r,this.start),r},t.prototype.delta=function(t){var e=t||I.Ue();return I.lu(e,this.end,this.start),e}}(),function(t){function e(e,n){var i=t.call(this)||this;return i.material=n,i.type=11,i._initArrays(e),i._initGeometry(),i}(0,B.ZT)(e,t),e.prototype.setOpacity=function(t,e){var n=this._data.colorAlpha.array,i=6*t;return n[i]=e,n[i+1]=e,n[i+2]=e,n[i+3]=e,n[i+4]=e,n[i+5]=e,this._data.colorAlpha.dirty=!0,this},e.prototype.setPosition=function(t,e){var n=this._data.position.array,i=18*t;return n[i]=e[0],n[i+1]=e[1],n[i+3]=e[0],n[i+4]=e[1],n[i+6]=e[0],n[i+7]=e[1],n[i+9]=e[0],n[i+10]=e[1],n[i+12]=e[0],n[i+13]=e[1],n[i+15]=e[0],n[i+16]=e[1],this._data.position.dirty=!0,this},e.prototype.setElevation=function(t,e){var n=this._data.position.array,i=18*t;return n[i+2]=e,n[i+5]=e,n[i+8]=e,n[i+11]=e,n[i+14]=e,n[i+17]=e,this._data.position.dirty=!0,this},e.prototype.setSize=function(t,e){var n=this._data.scale.array,i=12*t;return n[i]=e[0],n[i+1]=e[1],n[i+2]=e[0],n[i+3]=e[1],n[i+4]=e[0],n[i+5]=e[1],n[i+6]=e[0],n[i+7]=e[1],n[i+8]=e[0],n[i+9]=e[1],n[i+10]=e[0],n[i+11]=e[1],this._data.scale.dirty=!0,this},e.prototype.setOffset=function(t,e){var n=this._data.offset.array,i=12*t;return n[i]=e[0],n[i+1]=e[1],n[i+2]=e[0],n[i+3]=e[1],n[i+4]=e[0],n[i+5]=e[1],n[i+6]=e[0],n[i+7]=e[1],n[i+8]=e[0],n[i+9]=e[1],n[i+10]=e[0],n[i+11]=e[1],this._data.offset.dirty=!0,this},e.prototype.setUV=function(t,e){var n=this._data.texture.array,i=12*t;return n[i]=e[2],n[i+1]=1-e[3],n[i+2]=e[2],n[i+3]=1-e[1],n[i+4]=e[0],n[i+5]=1-e[3],n[i+6]=e[0],n[i+7]=1-e[1],n[i+8]=e[0],n[i+9]=1-e[3],n[i+10]=e[2],n[i+11]=1-e[1],this._data.texture.dirty=!0,this},e.prototype.render=function(t){var e=t.gl,n=t.shaderProgram,i=this._geometry;for(var r in n.bind(e,null,{texture:i.getBuffer("texture"),position:i.getBuffer("position"),colorAlpha:i.getBuffer("colorAlpha"),scale:i.getBuffer("scale"),offset:i.getBuffer("offset"),disposition:i.getBuffer("disposition")}),this._data)this._data[r].dirty&&(this._geometry.getBuffer(r).subData(e,0,this._data[r].array),this._data[r].dirty=!1);return this.material.enable(t),e.drawArrays(e.TRIANGLES,0,this._geometry.getBuffer("disposition").length),this.material.disable(),this},e.prototype.typifyForRender=function(t){return this.visible&&this.material.getTexture()?(t[16].addObject(this),this.children.forEach((function(e){return e.typifyForRender(t)})),this):this},e.prototype._initArrays=function(t){var e=t.length,n=[.5,-.5,0,.5,.5,0,-.5,-.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0],i=new Float32Array(18*e),r=new Float32Array(12*e),o=new Float32Array(18*e),a=new Float32Array(12*e),s=new Float32Array(12*e),l=new Float32Array(6*e);this._data={disposition:{array:i,dirty:!1},texture:{array:r,dirty:!1},position:{array:o,dirty:!1},scale:{array:a,dirty:!1},offset:{array:s,dirty:!1},colorAlpha:{array:l,dirty:!1}};for(var c=0;c<e;c++){var u=t[c];i.set(n,18*c),this.setUV(c,u.uv||[0,0,1,1]),this.setSize(c,u.size||[0,0]),this.setOffset(c,u.offset||[0,0]),this.setOpacity(c,void 0!==u.opacity?u.opacity:1),this.setPosition(c,u.position),this.setElevation(c,u.elevation||0)}},e.prototype._initGeometry=function(){this._geometry=new Zn;var t=new On(this._data.texture.array,{itemSize:2});t.drawType=On.DynamicDraw;var e=new On(this._data.position.array,{itemSize:3});e.drawType=On.DynamicDraw;var n=new On(this._data.scale.array,{itemSize:2});n.drawType=On.DynamicDraw;var i=new On(this._data.offset.array,{itemSize:2});i.drawType=On.DynamicDraw;var r=new On(this._data.colorAlpha.array,{itemSize:1});r.drawType=On.DynamicDraw;var o=new On(this._data.disposition.array,{itemSize:3});this._geometry.setBuffer("disposition",o).setBuffer("texture",t).setBuffer("position",e).setBuffer("scale",n).setBuffer("offset",i).setBuffer("colorAlpha",r)}}(Mn),function(){function t(){this.smoothing=1,this._texture=null,this.type=8}t.prototype.setTexture=function(t){return this._texture=t,this},t.prototype.getTexture=function(){return this._texture},t.prototype.enable=function(t){var e=t.gl;t.shaderProgram.bind(e,{uSmoothing:this.smoothing}),this._texture&&this._texture.enable(e)},t.prototype.disable=function(){}}(),function(t){function e(){var e=t.call(this)||this;return e._shaderProgram=new zn({vertex:new Cn("vertex","\nattribute vec2 texture;\n\nattribute vec3 position;\n\nattribute vec2 disposition;\nattribute vec2 scale;\nattribute vec2 offset;\nattribute float colorAlpha;\n\nuniform float uSmoothing;\nuniform mat4 uPCamera;\nuniform vec2 uHalfSize;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main() {\n    vTextureCoord = texture;\n    vColorAlpha = colorAlpha;\n\n    vec4 anchor = uPCamera * vec4(position, 1.0);\n    vec2 align = (disposition * scale + offset) / uHalfSize;\n    vec2 pos_2d = anchor.xy + align.xy * anchor.w;\n\n    vec2 round_pos = floor((pos_2d.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 round_delta = round_pos - pos_2d.xy;\n\n    if (vColorAlpha == 0.0) {\n        pos_2d = vec2(-2.0, -2.0);\n    } else {\n        pos_2d.xy = pos_2d.xy + round_delta * uSmoothing;\n    }\n\n    gl_Position = vec4(pos_2d, anchor.z, anchor.w);\n}\n"),fragment:new Cn("fragment","\nprecision mediump float;\n\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * vColorAlpha;\n}\n"),uniforms:[{name:"uPCamera",type:"mat4"},{name:"uHalfSize",type:"2f"},{name:"uTexture",type:"1i"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"disposition"},{name:"texture"},{name:"position"},{name:"colorAlpha"},{name:"scale"},{name:"offset"}]}),e.type=16,e}(0,B.ZT)(e,t),e.prototype.render=function(t){var e=t.gl,n=t.camera,i=t.renderer.getSize();return t.shaderProgram=this._shaderProgram,e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(e).bind(e,{uPCamera:new Float32Array(n.modelViewMatrix),uHalfSize:[i[0]/2,i[1]/2],uTexture:0}),e.activeTexture(e.TEXTURE0),this._objects.forEach((function(e){return e.render(t)})),this._objects=[],this._shaderProgram.disable(e),this}}(Kt);var Un=function(t){function e(){var e=t.call(this)||this;return e.up=I.al(0,1,0),e.projectionMatrix=Ae.Ue(),e.modelViewMatrix=Ae.Ue(),e.worldInverseMatrix=Ae.Ue(),e._mat3=wn(),e._mat4a=Ae.Ue(),e._mat4b=Ae.Ue(),e}return(0,B.ZT)(e,t),e.prototype.updateProjectionMatrix=function(){},e.prototype.updateWorldMatrix=function(){t.prototype.updateWorldMatrix.call(this),Ae.U_(this.worldInverseMatrix,this.worldMatrix),Ae.Jp(this.modelViewMatrix,this.projectionMatrix,this.worldInverseMatrix)},e.prototype.project=function(t){var e=I.Ue();return I.fF(e,t,this.modelViewMatrix),e},e.prototype.unproject=function(t){var e=this._mat4a,n=this._mat4b,i=I.Ue();return Ae.U_(n,this.projectionMatrix),Ae.dC(e,this.worldMatrix,n),I.fF(i,t,e),i},e.prototype.lookAt=function(t){var e=this._mat4a,n=this._mat3;return Ae.zB(e,this.position,t,this.up),Ae.p4(e,e),In(n,e),function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}}(this.quaternion,n),this},e}(Mn);!function(t){function e(e,n,i,r,o,a){var s=t.call(this)||this;return s.left=e,s.right=n,s.top=i,s.bottom=r,s.near=o,s.far=a,s.type=1,s}(0,B.ZT)(e,t),e.prototype.updateProjectionMatrix=function(){Ae.M5(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far)}}(Un),function(t){function e(e,n,i,r){var o=t.call(this)||this;return o.fov=e,o.aspect=n,o.near=i,o.far=r,o.type=2,o}(0,B.ZT)(e,t),e.prototype.updateProjectionMatrix=function(){Ae.G3(this.projectionMatrix,this.fov*Math.PI/180,this.aspect,this.near,this.far)}}(Un),function(t){function e(){var e=t.call(this)||this;return e._lights=[],e}(0,B.ZT)(e,t),e.prototype.addLight=function(t){return this._lights.push(t),this},e.prototype.getLights=function(){return this._lights}}(Mn),function(t){function e(e){var n=t.call(this)||this;return n.material=e,n.offset=N.Ue(),n.type=10,n}(0,B.ZT)(e,t),e.prototype.render=function(t){if(!this.visible||!this.material.getTexture())return this;this.worldMatrixNeedsUpdate&&this.updateWorldMatrix();var e=t.gl;return t.object=this,this.material.enable(t),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),this.material.disable(t.gl),this},e.prototype.typifyForRender=function(t){return this.visible?(t[15].addObject(this),this.children.forEach((function(e){return e.typifyForRender(t)})),this):this}}(Mn),function(){function t(){this.opacity=1,this.smoothing=0,this._texture=null,this.type=7}t.prototype.setTexture=function(t){return this._texture=t,this},t.prototype.getTexture=function(){return this._texture},t.prototype.enable=function(t){var e=t.gl,n=t.object,i=t.shaderProgram,r=t.renderer.getSize();i.bind(e,{uColorAlpha:this.opacity,uSmoothing:this.smoothing,uHalfSize:[r[0]/2,r[1]/2],uOffset:n.offset,uScale:n.scale,uPosition:[n.worldMatrix[12],n.worldMatrix[13],n.worldMatrix[14]]}),this._texture&&this._texture.enable(e)},t.prototype.disable=function(){}}(),function(t){function e(){var e=t.call(this)||this;return e._geometry=new Zn,e._geometry.setBuffer("position",new On(new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]))).setBuffer("texture",new On(new Float32Array([0,0,1,0,1,1,0,1]),{itemSize:2})).setBuffer("index",new On(new Uint16Array([1,2,0,3,0,2]),{itemSize:1})),e._geometry.getBuffer("index").type=On.ElementArrayBuffer,e._shaderProgram=new zn({vertex:new Cn("vertex","\nattribute vec2 position;\nattribute vec2 texture;\n\nuniform vec3 uPosition;\nuniform mat4 uPCamera;\nuniform vec2 uScale;\nuniform vec2 uHalfSize;\nuniform vec2 uOffset;\nuniform float uSmoothing;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vTextureCoord = texture;\n\n    vec2 alignedPosition = position * uScale;\n    alignedPosition += uOffset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(uPosition, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    vec2 roundedPosition = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 roundingDelta = roundedPosition - ndcPosition.xy;\n\n    ndcPosition.xy = ndcPosition.xy + roundingDelta * uSmoothing;\n\n    gl_Position = ndcPosition;\n}\n"),fragment:new Cn("fragment","\nprecision mediump float;\n\nuniform float uColorAlpha;\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * uColorAlpha;\n}\n"),uniforms:[{name:"uPCamera",type:"mat4"},{name:"uPosition",type:"3f"},{name:"uColorAlpha",type:"1f"},{name:"uScale",type:"2f"},{name:"uTexture",type:"1i"},{name:"uHalfSize",type:"2f"},{name:"uOffset",type:"2f"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"position"},{name:"texture"},{name:"index",index:!0}]}),e.type=15,e}(0,B.ZT)(e,t),e.prototype.render=function(t){var e=t.gl,n=t.camera;return t.shaderProgram=this._shaderProgram,e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(e).bind(e,{uPCamera:new Float32Array(n.modelViewMatrix),uTexture:0},{position:this._geometry.getBuffer("position"),texture:this._geometry.getBuffer("texture"),index:this._geometry.getBuffer("index")}),e.activeTexture(e.TEXTURE0),this._objects.forEach((function(e){return e.render(t)})),this._objects=[],this._shaderProgram.disable(e),this}}(Kt);var Nn=function(){function t(t,e){this.origin=t||I.Ue(),this.direction=e||I.Ue()}return t.prototype.clone=function(){return new t(I.d9(this.origin),I.d9(this.direction))},t.prototype.at=function(t){var e=I.Ue();return I.od(e,this.origin,this.direction,t),e},t.prototype.intersectBox=function(t){var e,n,i,r,o,a,s=1/this.direction[0],l=1/this.direction[1],c=1/this.direction[2],u=this.origin;return s>=0?(e=(t.min[0]-u[0])*s,n=(t.max[0]-u[0])*s):(e=(t.max[0]-u[0])*s,n=(t.min[0]-u[0])*s),l>=0?(i=(t.min[1]-u[1])*l,r=(t.max[1]-u[1])*l):(i=(t.max[1]-u[1])*l,r=(t.min[1]-u[1])*l),e>r||i>n?null:((i>e||e!=e)&&(e=i),(r<n||n!=n)&&(n=r),c>=0?(o=(t.min[2]-u[2])*c,a=(t.max[2]-u[2])*c):(o=(t.max[2]-u[2])*c,a=(t.min[2]-u[2])*c),e>a||o>n?null:((o>e||e!=e)&&(e=o),(a<n||n!=n)&&(n=a),n<0?null:this.at(e>=0?e:n)))},t.prototype.applyMatrix4=function(t){return I.IH(this.direction,this.direction,this.origin),I.fF(this.direction,this.direction,t),I.fF(this.origin,this.origin,t),I.lu(this.direction,this.direction,this.origin),I.Fv(this.direction,this.direction),this},t.prototype.intersectTriangle=function(t,e){var n=I.Ue(),i=I.Ue(),r=I.Ue();I.lu(n,t[1],t[0]),I.lu(i,t[2],t[0]),I.kC(r,n,i);var o,a=I.AK(this.direction,r);if(a>0){if(e)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}var s=I.Ue();I.lu(s,this.origin,t[0]);var l=I.Ue();I.kC(l,s,i);var c=o*I.AK(this.direction,l);if(c<0)return null;var u=I.Ue();I.kC(u,n,s);var d=o*I.AK(this.direction,u);if(d<0)return null;if(c+d>a)return null;var h=-o*I.AK(s,r);return h<0?null:this.at(h/a)},t.prototype.distanceToPlane=function(t){var e=I.AK(t.normal,this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(I.AK(this.origin,t.normal)+t.constant)/e;return n>=0?n:null},t.prototype.intersectPlane=function(t){var e=this.distanceToPlane(t);return null===e?null:this.at(e)},t}();!function(){function t(t,e,n,i){var r;this.precision=1e-4,this.ray=new Nn(t,e),this.near=n||0,this.far=i||1/0,this.intersectMethodsByType=((r={})[9]="intersectMesh",r),this._vec3=I.Ue(),this._mat3=wn()}t.prototype.setFromCamera=function(t,e){if(2===e.type){I.JG(this.ray.origin,e.position);var n=I.t8(this._vec3,t[0],t[1],.5);n=e.unproject(n),I.lu(n,n,e.position),I.Fv(n,n),this.ray.direction=n}else if(1===e.type){var i=I.t8(this._vec3,t[0],t[1],-1);this.ray.origin=e.unproject(i),I.t8(this.ray.direction,0,0,-1),In(this._mat3,e.worldMatrix),I.kK(this.ray.direction,this.ray.direction,this._mat3),I.Fv(this.ray.direction,this.ray.direction)}},t.prototype.intersectObject=function(t,e,n){n=n||[];var i=this.intersectMethodsByType[t.type];return i&&this[i]?this[i](t,e,n):e&&this.intersectObjects(t.children,e,n),n.sort(this._descSort),n},t.prototype.intersectObjects=function(t,e,n){var i=this;return n=n||[],t.forEach((function(t){return i.intersectObject(t,e,n)})),n},t.prototype.intersectMesh=function(t,e,n){n=n||[];var i=Ae.Ue();Ae.U_(i,t.worldMatrix);var r=this.ray.clone();r.applyMatrix4(i);var o=t.geometry.getBoundingBox();if(!r.intersectBox(o))return t;for(var a=t.geometry.buffers.position,s=0;s<a.length;s+=3){var l=a.getTriangle(s/3),c=r.intersectTriangle(l,!1);if(c){I.fF(c,c,t.worldMatrix);var u=I.TK(this.ray.origin,c);u<this.precision||u<this.near||u>this.far||n.push({distance:u,point:c,object:t})}}return e&&this.intersectObjects(t.children,e,n),n},t.prototype._descSort=function(t,e){return t.distance-e.distance}}(),function(t){function e(){var e=t.call(this)||this;return e.type=14,e}(0,B.ZT)(e,t),e.prototype.render=function(t){var e=t.gl;return e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),t.renderer.sortObjects&&this._sortObjects(t),this._objects.forEach((function(e){return e.render(t)})),this._objects=[],this},e.prototype._sortObjects=function(t){var e=t.camera,n=this._reversePainterSortStable.bind(this,e);this._objects.sort(n)},e.prototype._reversePainterSortStable=function(t,e,n){if(e.renderOrder!==n.renderOrder)return e.renderOrder-n.renderOrder;var i=t.project(e.getWorldPosition())[2];return t.project(n.getWorldPosition())[2]-i}}(Kt);var Hn=n(5510),Gn=n(5452),Vn=new(n(1253).TD)("main").getPacked(),Wn=64,Xn=function(){function t(t,e,n){var i=this;this.id=t,this.modules=e,this.options=n,this.type="dem",this.tree=Hn(),this.minElevation=0,this.tileLoader=new Gn.U("arrayBuffer"),this.attributes={},this.tiles=new Map,this.textureIndices=new Map,this.url=function(t){var e=(0,K._W)(t),n=e[0],r=e[1],o=e[2];return i.options.url(n,r,o)}}return t.prototype.abortTileFetch=function(t){this.tileLoader.abortRequest((0,K.gx)(t))},t.prototype.deleteTile=function(t){var e=(0,K.gx)(t);if(this.tiles.get(e)){var n=(0,K.Sl)(t);this.tree.remove({minX:n.min[0],minY:n.min[1],maxX:n.max[0],maxY:n.max[1]},(function(t,n){return e===n.key}))}this.tiles.delete(e),this.updateMinElevation()},t.prototype.fetchTile=function(t){var e=this,n=(0,K.gx)(t),i=[{regionId:0,metatileHash:-1}];if(this.tiles.has(n))return Promise.resolve(i);var r=this.url(t);return this.tileLoader.fetch(t,(function(){return r})).then((function(r){return r.rejected||e.tiles.set(n,r.data?e.tileDataToFloat32Array(r.data,t):void 0),i}),(function(){return Promise.resolve(void 0)}))},t.prototype.generateTile=function(t,e,n,i,r,o){return(0,B.mG)(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,h;return(0,B.Jh)(this,(function(f){return t=[],n=[],i=(0,K.gx)(e),(r=this.tiles.get(i))?(o=(0,K.aq)(e[2]),a=(0,K.Sl)(e),this.tree.insert((0,B.pi)({key:i,minX:a.min[0],minY:a.min[1],maxX:a.max[0],maxY:a.max[1],cellSize:o/Wn},r)),this.updateMinElevation(),s=this.modules.renderer.getRenderingContext(),l=new ee(r.data,{size:[Wn,Wn],format:ee.AlphaFormat,type:ee.Float,flipY:!0,magFilter:ee.LinearFilter,minFilter:ee.LinearFilter}).prepare(s),c=this.modules.imageManager.addPreparedTexture(l),this.textureIndices.set(i,c),u=this.modules.map.state.handyStyleId,d=[[0,0,0,0],[1,0,1,0],[0,1,0,1],[0,1,0,1],[1,0,1,0],[1,1,1,1]],h=Ne._.generateElevation(this.modules.collector,d,u,gn.h,c),t.push({regionId:0,metatileHash:-1,styleId:u,collectorOutput:{data:[h],labels:[],geoIds:new Uint32Array,floorHidingMap:[],rastersToLoad:new Float64Array,transferable:[],identifyIds:Vn}}),[2,Promise.resolve({results:t,transferable:n})]):[2,Promise.resolve({results:t,transferable:n})]}))}))},t.prototype.tileDataToFloat32Array=function(t,e){for(var n=e[0],i=e[1],r=e[2],o=e[3],a=new Uint8Array(t),s=new Float32Array(Math.pow(Wn,2)),l=1/0,c=-1/0,u=0;u<Wn;u++)for(var d=(0,x.PA)((0,K.Oy)([n,i+.015625*u,r,o])),h=(0,x.Xg)(d[1]),f=0;f<Wn;f++){var p=f+u*Wn,m=(a[p]+256*a[Math.pow(Wn,2)+p]-1e4)*h;l=Math.min(m,l),c=Math.max(m,c),s[p]=m}return{data:s,minZ:l,maxZ:c}},t.prototype.getAttributes=function(){return this.attributes},t.prototype.setAttributes=function(t){this.attributes=t},t.prototype.getId=function(){return this.id},t.prototype.destroy=function(){var t=this.modules.imageManager;this.tileLoader.destroy(),this.tiles.clear(),this.tree.clear(),this.textureIndices.forEach((function(e){return t.deleteTexture(e)})),this.textureIndices.clear()},t.prototype.getElevation=function(t){var e=this.tree.search({minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}).reduce((function(t,e){return!t||t.cellSize>e.cellSize?e:t}),void 0);if(e)return function(t,e){var n=(0,b.uZ)((e[0]-t.minX)/t.cellSize,0,63),i=(0,b.uZ)((e[1]-t.minY)/t.cellSize,0,63),r=Math.trunc(n),o=Math.trunc(i),a=Math.min(r+1,63),s=Math.min(o+1,63),l=N.t7([],[t.data[Yn(o)*Wn+r],t.data[Yn(s)*Wn+r]],[t.data[Yn(o)*Wn+a],t.data[Yn(s)*Wn+a]],n%1);return(0,b.t7)(l[0],l[1],i%1)}(e,t)},t.prototype.getMinElevation=function(){return this.minElevation},t.prototype.updateMinElevation=function(){this.minElevation=this.tree.all().reduce((function(t,e){return void 0===t?e.minZ:Math.min(t,e.minZ)}),void 0)},t}();function Yn(t){return 63-t}var qn=n(3750),Jn=Ae.wA([],[-1,-1,0],[2,2,1]),Kn=Ae.wA([],[.5,.5,0],[.5,.5,1]),Qn=function(){function t(t){this.demTextureMatrix=new Float64Array(Ae.Ue()),this.centerPosition=[0,0,0],this.flatFbVpTransformMatrix=new Float64Array(Ae.Ue()),this.demFbVpMatrix=new Float64Array(Ae.Ue()),this.flatFbVpMatrix=new Float64Array(Ae.Ue()),this.demFramebufferId=qn.z,this.flatFramebufferId=qn.z,this.hillshadeRampTextureId=NaN,this.flatFramebufferBottomExt=0,this.lastStyleId=NaN,this.demModelMatrix=new Float64Array(Ae.Ue()),this.modules=t,this.enabled=!1,this.sources=[],this.tileLayers=[],this.differ=new Bt([])}return t.prototype.enable=function(){this.differ=new Bt([{path:"center",type:"vec2"},{path:"zoom",type:"number"},{path:"size",type:"vec2"},{path:"rotation",type:"number"},{path:"pitch",type:"number"},{path:"demMode",type:"boolean"},{path:"elevation",type:"number"},{path:"minElevation",type:"number"}]),this.demFramebufferId=this.createDemFramebuffer(),this.flatFramebufferId=this.createFlatFramebuffer(),this.addDefaultSources(),this.modules.styleManager.setFramebufferId(this.modules.map.state.handyStyleId,gn.h,{elevation:this.demFramebufferId});var t=this.modules.styleManager.getStyle(this.modules.map.state.handyStyleId);(null==t?void 0:t.dem)&&(this.hillshadeRampTextureId=this.modules.imageManager.addPreparedTexture(function(t,e,n){for(var i=(0,et.jJ)(t.styleZoom,t.styleState,[]),r=[],o=0;o<256;o++){var a=o/255,s=256*(0,et.UP)(e,a,i);r.push(s)}return new ee(new Uint8Array(r),{size:[256,1],format:ee.AlphaFormat})}(this.modules.map.state,t.dem.style.shadingPalette))),this.modules.defaultSource.disableHillshade(),this.enabled=!0},t.prototype.disable=function(){var t,e=this;this.enabled&&(null===(t=this.meshSource)||void 0===t||t.destroy(),this.meshSource=void 0,this.tileLayers.forEach((function(t){e.modules.tileManager.removeTileLayer(t)})),this.tileLayers=[],this.sources.forEach((function(t){t.destroy()})),this.sources=[],this.modules.styleManager.removeLayer("demo_raster_layer"),this.modules.styleManager.setFramebufferId(this.modules.map.state.handyStyleId,gn.h,{elevation:qn.z}),this.modules.renderer.removeFramebuffer(this.demFramebufferId),this.modules.renderer.removeFramebuffer(this.flatFramebufferId),this.modules.defaultSource.enableHillshade({}),this.enabled=!1)},t.prototype.update=function(){var t,e;if(this.enabled){var n=this.modules.map.state;this.lastStyleId!==n.handyStyleId&&(null===(t=this.meshSource)||void 0===t||t.updateStyleId(),this.lastStyleId=n.handyStyleId),this.differ.check(this.modules.map.state)&&(null===(e=this.meshSource)||void 0===e||e.updateView(),this.updateDemFramebufferMatrix(),this.updateFlatFramebufferMatrix())}},t.prototype.isEnabled=function(){return this.enabled},t.prototype.getDemFramebufferId=function(){return this.demFramebufferId},t.prototype.getFlatFramebufferId=function(){return this.flatFramebufferId},t.prototype.getHillshadeRampTextureId=function(){return this.hillshadeRampTextureId},t.prototype.getElevation=function(t){var e;if(this.enabled)return this.sources.forEach((function(n){var i=n.getElevation(t);void 0!==i&&(e=i)})),e},t.prototype.getMinElevation=function(){return this.sources.reduce((function(t,e){var n=e.getMinElevation();return void 0===n?t:void 0===t?n:Math.min(t,n)}),void 0)},t.prototype.addDefaultSources=function(){this.enabled||(this.addElevationSource({url:function(t,e,n){return"https://tileserver.web-staging.2gis.ru/v2/ald?ts=relief_hd&x=".concat(t,"&y=").concat(e,"&z=").concat(n)},minZoom:5,maxZoom:13,attributes:{}}),this.meshSource=new bn(this.modules.map,{maxZoom:13}))},t.prototype.addElevationSource=function(t){var e=new Xn((0,De.Q)(),this.modules,t);this.sources.push(e);var n=t.minZoom,i=t.maxZoom,r=new Re.I(n,i,n,i,this.modules,this.modules.map.state,e);this.modules.tileManager.addTileLayer(r),this.tileLayers.push(r)},t.prototype.getDemTextureSize=function(){var t=this.modules.map.state.size[1]*g.camera.viewportLimitRatio;return Math.min(Math.ceil(Math.hypot(t,t)/re.y4),64)},t.prototype.updateFlatFramebufferExt=function(){var t=this.modules.map.state,e=(0,b.Id)(g.camera.fov),n=t.size[1]<g.camera.minCalculationScreenHeight?e/g.camera.minCalculationScreenHeight*t.size[1]:e,i=2*Math.tan(n/2),r=Math.tan(t.maxPitch+n/2)-Math.tan(n/2);this.flatFramebufferBottomExt=(0,b.uZ)(r/i,1,1)},t.prototype.createDemFramebuffer=function(){var t=this,e=this.modules.renderer.getRenderingContext(),n=64*this.getDemTextureSize(),i=new ie({size:[n,n],magFilter:ee.LinearFilter,minFilter:ee.LinearFilter,wrapS:ee.ClampToEdgeWrapping,wrapT:ee.ClampToEdgeWrapping,flipY:!0,type:ee.Float});return this.modules.renderer.addFramebuffer({clearColor:[0,0,0,0],onResize:function(){var r=64*t.getDemTextureSize();r!==n&&(console.log("[DEM] Texture resized: ".concat(n)),n=r,i.setSize([n,n]),i.bind(e),i.unbind(e))},renderTarget:i,getViewProjectionMatrix:function(){return t.demFbVpMatrix},renderIndex:0,onRenderStart:function(){e.activeTexture(e.TEXTURE0+6),e.bindTexture(e.TEXTURE_2D,null)}})},t.prototype.createFlatFramebuffer=function(){var t=this,e=this.modules.renderer.getRenderingContext(),n=this.modules.map.state.size;this.updateFlatFramebufferExt();var i=[3*n[0],n[1]*(1+this.flatFramebufferBottomExt+1)],r=new ie({size:[Math.ceil(i[0]),Math.ceil(i[1])],magFilter:ee.LinearFilter,minFilter:ee.LinearFilter,wrapS:ee.ClampToEdgeWrapping,wrapT:ee.ClampToEdgeWrapping});return this.modules.renderer.addFramebuffer({clearColor:[0,0,0,0],onResize:function(){t.updateFlatFramebufferExt();var i=[3*n[0],n[1]*(1+t.flatFramebufferBottomExt+1)];r.setSize([Math.ceil(i[0]),Math.ceil(i[1])]),r.bind(e),r.unbind(e)},getViewProjectionMatrix:function(){return t.flatFbVpMatrix},renderTarget:r,renderIndex:2})},t.prototype.updateDemFramebufferMatrix=function(){var t=this.modules.map.state,e=Math.trunc(t.styleZoom),n=(0,K.aq)(Math.min(e,13)),i=n*this.getDemTextureSize(),r=i/2,o=n/64,a=[t.center[0]-r,t.center[1]-r],s=[];N.lu(s,this.modules.camera.position,t.center);var l=N.Zh(s);N.Fv(s,s);var c=(r-l-o)*Math.sin(t.pitch/t.maxPitch*(Math.PI/2));N.bA(s,s,c),N.lu(a,a,s),Ae.wA(this.demModelMatrix,[Math.trunc(a[0]/o)*o,Math.trunc(a[1]/o)*o,0],[i,i,re._9]),Ae.U_(this.demTextureMatrix,this.demModelMatrix),Ae.Jp(this.demFbVpMatrix,Jn,this.demTextureMatrix),I.fF(this.centerPosition,this.modules.map.state.center,this.demTextureMatrix)},t.prototype.updateFlatFramebufferMatrix=function(){var t=1+this.flatFramebufferBottomExt+1;Ae.wA(this.flatFbVpTransformMatrix,[0,0,0],[1/3,1/t,1]),Ae.Jp(this.flatFbVpMatrix,this.flatFbVpTransformMatrix,this.modules.camera.viewProjectionMatrix),Ae.Jp(this.flatFbVpTransformMatrix,Kn,this.flatFbVpTransformMatrix)},t}();function $n(t,e){return 0===e?1:1===e?t.labelingOpacity:1-t.labelingOpacity}var ti=function(t,e,n,i,r,o,a){var s=(0,et.zn)(o.style.color,ji(n,r));return Le.JG(a.value,s.value),!0},ei=function(t,e,n,i,r,o,a){var s=(0,et.zn)(o.style.topColor,ji(n,r));return Le.JG(a.value,s.value),!0},ni=function(t,e,n,i,r,o,a){var s=(0,et.zn)(o.style.sideColor,ji(n,r));return Le.JG(a.value,s.value),!0},ii=function(t,e,n,i,r,o,a){var s=(0,et.zn)(o.style.strokeColor,ji(n,r));return Le.JG(a.value,s.value),!0},ri=function(t,e,n,i,r,o,a){var s=(0,et.zn)(o.style.strokeColor2,ji(n,r));return Le.JG(a.value,s.value),!0},oi=function(t,e,n,i,r,o,a){return void 0===r.attributes.id||(a.value[3]*=i.modelLayer.getOpacity(r.attributes.id,o.minzoom)),!0},ai=function(t,e,n,i,r,o,a){var s=i.modelLayer;if(void 0===r.attributes.hiddenObjectId)return!0;if(r.attributes.hiddenObjectId&&!s.hasModel(r.attributes.hiddenObjectId))return!0;var l=s.getVisibleModelData(r.attributes.hiddenObjectId);if(!l)return!0;var c=1-l.opacity;return!(c<.5||(a.value[3]*=c,0))},si=function(t,e){return e.bind(t,{u_float_opacity:1}),!0},li=function(t,e,n,i,r,o,a){var s=ji(n,r),l=(0,et.zn)(o.style.strokeColor,s).value,c=(0,et.vn)(o.style.strokeWidth,s);return Le.fS(a.value,l)&&1===a.value[3]&&c<=1&&(a.value[3]*=n.stillness),!0},ci=function(t,e,n,i,r,o,a){var s=ji(n,r),l=(0,et.zn)(o.style.topColor,s).value,c=(0,et.vn)(o.style.strokeWidth,s);return Le.fS(a.value,l)&&1===a.value[3]&&c<=1&&(a.value[3]*=n.stillness),!0},ui=function(t,e,n,i,r,o,a){return a.value[3]*=n.stillness,!0},di=function(t,e,n,i,r,o,a){var s=(0,et.m2)(a);return Le.bA(s,s,r.tile.readiness),0!==a.value[3]&&(e.bind(t,{u_vec4_color:s}),!0)},hi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.width,ji(n,r));return 0!==a&&(e.bind(t,{u_float_width:a*window.devicePixelRatio}),!0)},fi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.strokeWidth,ji(n,r));return 0!==a&&(e.bind(t,{u_float_width:a*window.devicePixelRatio}),!0)},pi=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.strokeWidth,a);if(0===s)return!1;var l=(0,et.vn)(o.style.width,a)+2*s;return e.bind(t,{u_float_width:l*window.devicePixelRatio}),!0},mi=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.strokeWidth2,a);if(0===s)return!1;var l=(0,et.vn)(o.style.width,a)+2*(0,et.vn)(o.style.strokeWidth,a)+2*s;return e.bind(t,{u_float_width:l*window.devicePixelRatio}),!0},vi=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.width,a)+2*(0,et.vn)(o.style.strokeWidth,a)+2*(0,et.vn)(o.style.strokeWidth2,a);return 0!==s&&(e.bind(t,{u_float_width:s*window.devicePixelRatio}),!0)},_i=function(t,e,n,i,r,o){var a=ji(n,r);return(0,et.vn)(o.style.iconWidth,a)>0},yi=function(t,e,n,i,r,o){return e.bind(t,{u_float_shift:(0,et.vn)(o.style.shift,ji(n,r))*window.devicePixelRatio}),!0},gi=function(t,e,n,i,r,o){return 0!==$n(n,r.attributes.animDirection)},bi=function(t,e,n,i,r,o){var a=$n(n,r.attributes.animDirection);return 0!==a&&(e.bind(t,{u_float_opacity:a}),!0)},xi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.iconRotation,ji(n,r));return e.bind(t,{u_vec2_rotation:[Math.cos(a),Math.sin(a)]}),!0},wi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.opacity,ji(n,r));return e.bind(t,{u_float_opacity:r.tile.readiness*a}),!0},Ii=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.opacity,ji(n,r));return e.bind(t,{u_float_opacity:a}),!0},Si=function(t,e,n,i,r){var o=i.floorManager;return void 0===r.attributes.hiddenObjectId||!o.hasDisplayedFloorBuilding(r.attributes.hiddenObjectId)},Mi=function(t,e,n,i,r){var o=i.modelLayer;if(void 0===r.attributes.hiddenObjectId)return!0;if(!o.hasModel(r.attributes.hiddenObjectId))return!0;var a=o.getVisibleModelData(r.attributes.hiddenObjectId);return!a||1!==a.opacity},Pi=function(t,e,n,i,r){return e.bind(t,{u_sr2d_texture:r.attributes.atlasIndex}),!0},Ti=function(t,e,n,i,r){var o=r.attributes,a=o.range,s=o.fontIndex,l=o.styleId,c=i.styleManager.getStyle(l);if(!c)return!1;var u=c.fonts[s],d=i.assetManager.getFontTextureByName(u,a);return void 0!==d&&(d.enable(t),!0)},ki=function(t,e,n,i,r){var o=i.imageManager.getTexture(r.attributes.textureIndex);return void 0!==o&&(o.enable(t,0),e.bind(t,{u_sr2d_texture:0}),!0)},Li=function(t,e,n,i,r){var o=i.imageManager.getTexture(r.attributes.rampTextureIndex);return void 0!==o&&(o.enable(t,1),e.bind(t,{u_sr2d_ramp_texture:1}),!0)},zi=function(t,e,n,i,r,o){var a=r.tile,s=(0,et.zn)(o.style.gapColor,ji(n,r));if(!s)return!0;var l=(0,et.m2)((0,et.zn)(s,ji(n,r)));return Le.bA(l,l,a.readiness),e.bind(t,{u_vec4_space_color:l}),!0},Ei=function(t,e,n,i,r,o){var a=n.styleZoom,s=ji(n,r),l=r.tile,c=(0,et.m2)((0,et.zn)(o.style.color,s));Le.bA(c,c,l.readiness),s.styleZoom=Math.floor(a);var u=Math.pow(2,(0,b.vO)(a)),d=(0,et.vn)(o.style.dashLength,s)*u,h=(0,et.vn)(o.style.gapLength,s)*u;return e.bind(t,{u_vec4_dash_color:c,u_vec2_scaler_params:[0,re.Cd],u_float_dash_length:(0,x.Qn)(d,l.size),u_float_dash2_length:(0,x.Qn)(d,l.size),u_float_space_length:(0,x.Qn)(h,l.size)}),!0},Ci=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.tipWidth,a),l=(0,et.vn)(o.style.tipHeight,a),c=s,u=N.al(-c,-0);N.Fv(u,u);var d=N.al(s,l);return N.Fv(d,d),e.bind(t,{u_vec2_wing_normal:u,u_vec2_tip_normal:d,u_float_tip_height_multiplier:l,u_float_wing_height_multiplier:0,u_float_wing_width_multiplier:c,u_float_size_factor:(0,x.Qn)(1,r.tile.size)/2}),!0},Ai=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.lineLength,a),l=(0,et.vn)(o.style.lineWidth,a);return e.bind(t,{u_float_length:s,u_float_width:l,u_float_border_width:0}),!0},Di=function(t,e,n,i,r,o){var a=ji(n,r),s=r.tile,l=r.attributes.isLongArrow,c=r.tile.dynamicObject,u=0,d=1;c&&(l?d=c.growPosition:u=c.bouncePosition);var h=0;return"appearance"===o.style.animation.type&&(h=(0,et.vn)(o.style.animation.tipMovementAmplitude,a)),e.bind(t,{u_float_width_zpt:(0,et.vn)(o.style.lineWidth,a),u_float_border_width_zpt:(0,et.vn)(o.style.strokeWidth,a),u_float_tip_movement_amplitude:(0,x.Qn)(h,s.size),u_float_vertex_shift:u,u_float_relative_end_position:d}),!0},Ri=function(t,e,n,i,r){var o=i.modelLayer,a=r.attributes,s=a.texture,l=a.id;if(void 0===l)return!1;var c=o.getTexture(l,s);return void 0!==c&&(c.enable(t,0),e.bind(t,{u_sr2d_texture:0}),!0)},Oi=function(t,e,n,i,r,o){if(void 0===r.attributes.id)return!0;var a=i.modelLayer.getOpacity(r.attributes.id,o.minzoom),s=1===i.modelLayer.getBuildingHeight(r.attributes.id)?1:a;return e.bind(t,{u_float_height_factor:s}),!0},Fi=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.height,a);return e.bind(t,{u_float_height_factor:(0,K.VW)(s)}),!0},Bi=function(t,e,n,i,r,o){var a=i.buildingHeightAnimator.getBuildingHeight(o.minzoom);return i.demManager.isEnabled()&&(a=.001+.999*a),r.attributes.hiddenObjectId&&i.modelLayer.setBuildingHeight(r.attributes.hiddenObjectId,a),e.bind(t,{u_float_height_factor:a}),!0};function ji(t,e){return(0,et.jJ)(t.styleZoom,t.styleState,e.attributes.tileData)}var Zi=function(t,e,n,i,r,o){var a=r.tile,s=a.purpose,l=a.detailLevel,c=n.styleZoom;switch(s){case"terrain":case"traffic":case"geojson":var u=l<function(t){switch(t){case"terrain":return g.tiles.maxDetailLevel;case"traffic":return g.traffic.maxDetailLevel;case"geojson":return Ee.rR}}(s)?(0,b.uZ)(c,l,l+.99999):c;return o.minzoom<=u&&u<o.maxzoom;case"dynamicObject":return o.minzoom<=c&&c<=o.maxzoom;default:return o.minzoom<=c&&c<o.maxzoom}},Ui=function(t,e,n,i,r){var o=n.styleZoom;return!("terrain"===r.tile.purpose&&o<=g.tiles.maxUniverseZoom)},Ni=function(t,e,n,i,r,o){var a=n.styleZoom;return a>=o.minzoom&&a<o.maxzoom},Hi=function(t,e,n,i,r,o){var a=r.tile,s=(0,et.vn)(o.style.width,ji(n,r));return 0!==s&&(e.bind(t,{u_float_width:(0,x.Qn)(s,a.size)/2,u_float_width_offset:(0,x.Qn)(1/window.devicePixelRatio,a.size)/2}),!0)},Gi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.radius,ji(n,r));return!(a<=0||(e.bind(t,{u_float_radius:a*window.devicePixelRatio}),0))},Vi=function(t,e,n,i,r,o){var a=(0,et.vn)(o.style.intensity,ji(n,r));return e.bind(t,{u_float_intensity:a}),!0},Wi=function(t,e,n,i,r,o){var a=ji(n,r),s=(0,et.vn)(o.style.textFontSize,a);if("point"===r.symbol){var l=r.attributes.labelIndex;l===ze.bR.Second&&o.style.textFontSize2?s=(0,et.vn)(o.style.textFontSize2,a):l===ze.bR.Icon&&o.style.iconTextFontSize&&(s=(0,et.vn)(o.style.iconTextFontSize,a))}return e.bind(t,{u_float_scale:s*window.devicePixelRatio/g.fonts.baseSize}),!0},Xi=function(t,e,n,i,r,o){var a,s,l=o.style;if("point"===r.symbol)switch(r.attributes.labelIndex){case ze.bR.Second:return(null!==(a=l.textHaloWidth2)&&void 0!==a?a:0)>0&&!!l.textHaloColor2;case ze.bR.Icon:return(null!==(s=l.iconTextHaloWidth)&&void 0!==s?s:0)>0&&!!l.iconTextHaloColor;case ze.bR.First:}return l.textHaloWidth>0&&!!l.textHaloColor},Yi=function(t,e,n,i,r,o){return Ji(t,e,n,r,o.style.textFontSize,o.style.textColor,o.style.textHaloWidth,o.style.textHaloColor,r.layerSettings.uniformSet)},qi=function(t,e,n,i,r,o){var a=r.layerSettings.uniformSet,s=r.attributes.labelIndex,l=o.style,c=l.textFontSize,u=l.textHaloWidth,d=l.textColor,h=l.textHaloColor;switch(s){case ze.bR.Icon:c=l.iconTextFontSize,u=l.iconTextHaloWidth,d=l.iconTextColor,h=l.iconTextHaloColor;break;case ze.bR.Second:c=l.textFontSize2,u=l.textHaloWidth2,d=l.textColor2,h=l.textHaloColor2}return Ji(t,e,n,r,c,d,u,h,a)},Ji=function(t,e,n,i,r,o,a,s,l){var c,u=ji(n,i),d=(0,et.vn)(r,u)/g.fonts.baseSize,h=d*window.devicePixelRatio,f=g.fonts.gamma/h;if("fontHalo"===l){if(!s)return!1;c=(0,et.m2)((0,et.zn)(s,u))}else c=(0,et.m2)((0,et.zn)(o,u));var p="fontHalo"===l?(6-(0,et.vn)(a,u)/d)/8:.75;return e.bind(t,{u_float_buffer:p,u_float_gamma:f,u_vec4_color:c}),!0},Ki=function(t,e,n,i,r){var o=r.attributes,a=o.offsetX,s=o.offsetY,l=window.devicePixelRatio;return e.bind(t,{u_vec2_offset:[a*l,s*l]}),!0},Qi=function(t,e,n){return e.bind(t,{u_float_style_zoom:n.styleZoom}),!0},$i=function(t,e,n,i,r){var o=r.tile,a=n.zoom,s=re.y4*Math.pow(2,a-o.zoomLevel)*window.devicePixelRatio;return e.bind(t,{u_float_tile_to_pixel_ratio:1/s}),!0},tr=function(t,e,n,i,r){var o;if(!i.demManager.isEnabled())return er(t,e);var a=i.demManager.getDemFramebufferId(),s=i.renderer.getFramebuffer(a),l=i.styleManager.getStyle(r.attributes.styleId);if(!s||!l)return er(t,e);var c=s.renderTarget.getTexture(),u=c.options.size;if(!u)return er(t,e);var d=i.imageManager.getTexture(i.demManager.getHillshadeRampTextureId());if(void 0===c||void 0===d)return er(t,e);var h=ji(n,r),f=(0,et.vn)(l.dem.style.verticalScale,h),p=(0,x.v3)((0,b.Id)((0,et.vn)(l.dem.style.lightingDirection,h))-n.rotation),m=(0,et.vn)(l.dem.style.shadingIntensity,h),v=x.Ax/(64*Math.pow(2,Math.trunc(n.styleZoom)));return c.enable(t,6),d.enable(t,7),e.bind(t,{u_float_dem_scale:f,u_float_dem_resolution:u[0],u_float_dem_cell_size:v,u_float_dem_light_direction:p,u_float_dem_shade_intension:m,u_tex_dem:6,u_tex_hillshade_ramp:7,u_float_map_center_elevation:null!==(o=n.elevation)&&void 0!==o?o:0}),!0},er=function(t,e){return e.bind(t,{u_float_dem_scale:0}),!0},nr=function(t,e,n,i){var r=i.demManager,o=i.renderer;if(!r.isEnabled())return!1;var a=r.getFlatFramebufferId(),s=o.getFramebuffer(a);return!!s&&(s.renderTarget.getTexture().enable(t,0),e.bind(t,{u_flat_tex:0,u_mat4_flat_tex:r.flatFbVpTransformMatrix}),!0)};function ir(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=(0,Ce.lK)([0,0,0,0]);return function(e,i,r,o,a,s){for(var l=0;l<t.length;l++)if(!t[l](e,i,r,o,a,s,n))return!1;return!0}}var rr=function(t){t.depthMask(!0),t.enable(t.DEPTH_TEST),t.depthFunc(t.LESS),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.disable(t.BLEND),t.blendFunc(t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.disable(t.POLYGON_OFFSET_FILL)},or=function(t){rr(t),t.depthMask(!1),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},ar=function(t){rr(t),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.disable(t.CULL_FACE)},sr=function(t){rr(t),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},lr=function(t){rr(t),t.disable(t.DEPTH_TEST),t.colorMask(!0,!1,!1,!0)},cr=function(t){rr(t),t.disable(t.DEPTH_TEST)},ur=function(t){rr(t),t.depthMask(!1)},dr=function(t){rr(t),t.colorMask(!1,!1,!1,!1)},hr=function(t){rr(t),t.depthFunc(t.EQUAL),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},fr=function(t){rr(t),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},pr=function(t){rr(t),t.polygonOffset(1,2),t.enable(t.POLYGON_OFFSET_FILL),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},mr=function(t){rr(t),t.disable(t.DEPTH_TEST),t.cullFace(t.FRONT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},vr=function(t){t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE)},_r=function(){function t(t){this.gl=t,this.ext=t.getExtension("EXT_disjoint_timer_query"),this.queries=[]}return t.prototype.addTimer=function(){if(this.ext){var t=this.ext.createQueryEXT();this.queries.push(t),this.ext.beginQueryEXT(this.ext.TIME_ELAPSED_EXT,t)}},t.prototype.stopTimer=function(){this.ext&&this.queries.length&&this.ext.endQueryEXT(this.ext.TIME_ELAPSED_EXT)},t.prototype.tryToGetFirstTimerValue=function(){if(this.ext){var t=this.queries[0];if(t){var e=this.ext,n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT),i=this.gl.getParameter(e.GPU_DISJOINT_EXT);if(n&&!i){var r=e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT);return e.deleteQueryEXT(t),this.queries.shift(),Number(r)}}}},t}(),yr="vec4 apply_opacity(const vec4 color, const float opacity)\n{\nreturn color * opacity;\n}\n",gr={affine_step:"\nfloat affine_step(const float edge0, const float edge1, const float x)\n{\nreturn clamp((x - edge0) / (edge1 - edge0), 0., 1.);\n}\n",apply_opacity:yr,color:"varying vec4 v_vec4_color;\nvoid main()\n{\ngl_FragColor = v_vec4_color;\n}\n",line:"varying vec4 v_vec4_color;\nvarying float v_float_distance;\nvoid main()\n{\ngl_FragColor = v_vec4_color * (1. - abs(v_float_distance * gl_FragCoord.w));\n}\n",lowp_float:"precision lowp float;\n",mediump_float:"precision mediump float;\n",highp_float:"precision highp float;\n",pointsprite:"uniform sampler2D u_sr2d_texture;\nuniform float u_float_opacity;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\ngl_FragColor = apply_opacity(texture2D(u_sr2d_texture, v_vec2_texcoord), u_float_opacity);\n}\n",striped_line:"varying vec4 v_vec4_dash_color;\nvarying vec4 v_vec4_space_color;\nvarying vec4 v_vec4_border_color;\nvarying vec2 v_vec2_circle;\nvarying float v_float_width;\nvarying float v_float_part_color_swap_threshold;\nvarying float v_float_distance_in_parts;\nvec4 distance_func_smooth(in vec4 main_color, in vec4 border_color, in vec2 circle)\n{\nfloat circle_length = length(circle);\nfloat distance = circle_length - v_float_width;\nmat2 derivatives = mat2(dFdx(v_vec2_circle), dFdy(v_vec2_circle));\nvec2 circle_dx = derivatives[0];\nvec2 circle_dy = derivatives[1];\nfloat distance_dx = dot(v_vec2_circle, circle_dx);\nfloat distance_dy = dot(v_vec2_circle, circle_dy);\nfloat derivative_denominator = circle_length;\nfloat width = max(abs(distance_dx), abs(distance_dy));\nvec4 from_main_to_border = mix(\nmain_color,\nborder_color,\naffine_step(-width, 0., distance * derivative_denominator));\nvec4 from_color_to_fade = mix(\nfrom_main_to_border,\nvec4(0.),\naffine_step(0., +width, distance * derivative_denominator));\nreturn from_color_to_fade;\n}\nfloat calculate_segment_color_factor(in float distance_in_parts, in float threshold)\n{\nfloat color_factor = abs(fract(distance_in_parts + 0.5 - 0.5 * threshold) - 0.5);\nfloat parts_affine_step_width = fwidth(distance_in_parts);\nfloat smoothed_color_factor = affine_step(\n0.5 * threshold - 0.5 * parts_affine_step_width,\n0.5 * threshold + 0.5 * parts_affine_step_width,\ncolor_factor);\nreturn smoothed_color_factor;\n}\nvoid main()\n{\nvec4 current_segment_color = mix(\nv_vec4_dash_color,\nv_vec4_space_color,\ncalculate_segment_color_factor(\nv_float_distance_in_parts,\nv_float_part_color_swap_threshold));\nvec4 final_border_color = (1.0 - v_vec4_border_color.a) * current_segment_color + v_vec4_border_color;\ngl_FragColor = distance_func_smooth(current_segment_color, final_border_color, v_vec2_circle);\n}\n",label:"uniform sampler2D u_sr2d_texture;\nuniform float u_float_buffer;\nuniform float u_float_gamma;\nuniform vec4 u_vec4_color;\nuniform float u_float_opacity;\nvarying vec2 v_vec2_texcoord;\nvoid main() {\n    float dist = texture2D(u_sr2d_texture, v_vec2_texcoord).a;\n    float alpha = smoothstep(\n        u_float_buffer - u_float_gamma,\n        u_float_buffer + u_float_gamma,\n        dist\n    );\n    gl_FragColor = apply_opacity(u_vec4_color * alpha, u_float_opacity);\n}\n",one_way_line:"uniform vec2 u_vec2_wing_normal;\nuniform vec2 u_vec2_tip_normal;\nuniform float u_float_width;\nuniform float u_float_length;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_tip_height_multiplier;\nuniform float u_float_wing_height_multiplier;\nvarying vec4 v_vec4_color;\nvarying vec4 v_vec4_border_color;\nvarying vec2 v_vec2_texcoord;\nvarying float v_float_border_width;\nvarying float v_float_zpt_to_texcoord_factor;\nvarying float v_float_outer_width;\nvarying float v_float_opacity;\nfloat one_way_line_distance(const ArrowDistances ad)\n{\nreturn max(max(max(ad.top_tip_cut, ad.bottom_tip_cut), max(ad.top_left_wing, ad.top_right_wing)), min(ad.line, min(ad.bottom_left_wing, ad.bottom_right_wing)));\n}\nvoid main()\n{\nmat2 derivatives = mat2(dFdx(v_vec2_texcoord), dFdy(v_vec2_texcoord));\nArrowDistanceParameters arrow_parameters = calculate_arrow_distance_parameters(\nu_vec2_wing_normal,\nu_vec2_tip_normal,\nu_float_width * v_float_zpt_to_texcoord_factor,\nu_float_length * v_float_zpt_to_texcoord_factor,\nu_float_tip_height_multiplier,\nu_float_wing_height_multiplier);\nfloat border_clipping = (abs(v_vec2_texcoord.y) - v_float_outer_width) / max(abs(derivatives[0].y), abs(derivatives[1].y));\nfloat fill_factor = affine_step(-1., 0., one_way_line_distance(calculate_arrow_distances(arrow_parameters, v_vec2_texcoord, 0., derivatives)));\nfloat border_factor = max(border_clipping, affine_step(0., 1., one_way_line_distance(calculate_arrow_distances(arrow_parameters, v_vec2_texcoord, v_float_border_width, derivatives))));\ngl_FragColor = apply_opacity(mix(mix(v_vec4_color, v_vec4_border_color, fill_factor), vec4(0.), border_factor), v_float_opacity);\n}\n",color_identify:"varying vec4 v_vec4_identifier;\nvoid main()\n{\ngl_FragColor = v_vec4_identifier;\n}\n",pointsprite_identify:"uniform sampler2D u_sr2d_texture;\nvarying vec2 v_vec2_texcoord;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\nvec4 color = texture2D(u_sr2d_texture, v_vec2_texcoord);\nif (color.a < 0.3) {\ndiscard;\n} else {\ngl_FragColor = v_vec4_identifier;\n}\n}\n",model:"uniform sampler2D u_sr2d_texture;\nuniform vec4 u_vec4_color;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\ngl_FragColor = texture2D(u_sr2d_texture, v_vec2_texcoord) * u_vec4_color;\n}\n",simple_line:"uniform vec4 u_vec4_color;\nvarying float v_float_distance;\nvarying float v_float_distance_offset;\nvoid main()\n{\nvec4 color = u_vec4_color;\ngl_FragColor = color * clamp(\n1. + v_float_distance_offset - abs(v_float_distance * gl_FragCoord.w),\n0.,\n1.);\n}\n",enable_standard_derivatives:"#extension GL_OES_standard_derivatives: enable\n",arrow_functions:"struct ArrowDistanceParameters\n{\nvec2 wing_normal;\nvec2 tip_normal;\nvec2 mirrored_wing_normal;\nvec2 mirrored_tip_normal;\nfloat width;\nfloat full_length;\nfloat arrow_height;\n};\nArrowDistanceParameters calculate_arrow_distance_parameters(\nconst vec2 wing_normal,\nconst vec2 tip_normal,\nconst float width_zpt,\nconst float length_zpt,\nconst float tip_height_multiplier,\nconst float wing_height_multiplier)\n{\nvec2 mirrored_wing_normal = vec2(wing_normal.x, -wing_normal.y);\nvec2 mirrored_tip_normal = vec2(tip_normal.x, -tip_normal.y);\nfloat width = 0.5 * width_zpt;\nfloat length = 0.5 * length_zpt;\nfloat arrow_height = width_zpt * (tip_height_multiplier - wing_height_multiplier);\nreturn ArrowDistanceParameters(\nwing_normal,\ntip_normal,\nmirrored_wing_normal,\nmirrored_tip_normal,\nwidth,\nlength,\narrow_height);\n}\nstruct ArrowDistances\n{\nfloat top_tip_cut;\nfloat bottom_tip_cut;\nfloat line;\nfloat bottom_left_wing;\nfloat bottom_right_wing;\nfloat top_left_wing;\nfloat top_right_wing;\n};\nArrowDistances calculate_arrow_distances(\nconst ArrowDistanceParameters arrow_parameters,\nconst vec2 texcoord,\nconst float offset,\nconst mat2 derivatives)\n{\nfloat derivatives_x_multiplier = 1. / max(abs(derivatives[0].x), abs(derivatives[1].x));\nfloat dt = ( texcoord.x - arrow_parameters.full_length - offset) * derivatives_x_multiplier;\nfloat d0 = (-texcoord.x - arrow_parameters.full_length - offset) * derivatives_x_multiplier;\nfloat d1 = (abs(texcoord.y) - arrow_parameters.width - offset) / max(abs(derivatives[0].y), abs(derivatives[1].y));\nfloat d2 = (dot(texcoord - vec2(arrow_parameters.full_length - arrow_parameters.arrow_height, 0.), arrow_parameters.wing_normal) - offset) / max(abs(dot(derivatives[0], arrow_parameters.wing_normal)), abs(dot(derivatives[1], arrow_parameters.wing_normal)));\nfloat d3 = (dot(texcoord - vec2(arrow_parameters.full_length - arrow_parameters.arrow_height, 0.), arrow_parameters.mirrored_wing_normal) - offset) / max(abs(dot(derivatives[0], arrow_parameters.mirrored_wing_normal)), abs(dot(derivatives[1], arrow_parameters.mirrored_wing_normal)));\nfloat d4 = (dot(texcoord - vec2(arrow_parameters.full_length, 0.), arrow_parameters.tip_normal) - offset) / max(abs(dot(derivatives[0], arrow_parameters.tip_normal)), abs(dot(derivatives[1], arrow_parameters.tip_normal)));\nfloat d5 = (dot(texcoord - vec2(arrow_parameters.full_length, 0.), arrow_parameters.mirrored_tip_normal) - offset) / max(abs(dot(derivatives[0], arrow_parameters.mirrored_tip_normal)), abs(dot(derivatives[1], arrow_parameters.mirrored_tip_normal)));\nreturn ArrowDistances(dt, d0, d1, d2, d3, d4, d5);\n}\n",circle_functions:"\nconst float g_distance_precision_limit = 1e-4;\nstruct CircleDistance\n{\nfloat distance;\nfloat width;\n};\nCircleDistance circle_color_distance(\nconst mat2 derivatives,\nconst vec2 circle,\nconst float circle_width)\n{\nfloat circle_length = length(circle);\nfloat distance = circle_length - circle_width;\nvec2 circle_dx = derivatives[0];\nvec2 circle_dy = derivatives[1];\nfloat distance_dx = dot(circle, circle_dx);\nfloat distance_dy = dot(circle, circle_dy);\nfloat derivative_denominator = circle_length;\nfloat width = max(abs(distance_dx), abs(distance_dy));\nreturn CircleDistance(\ndistance * derivative_denominator,\nwidth);\n}\nvec4 distance_to_color(\nconst float fill_distance,\nconst float border_distance,\nconst vec4 fill_color,\nconst vec4 border_color)\n{\nfloat fill_factor = affine_step(-1., 0., fill_distance);\nfloat border_factor = affine_step(0., 1., border_distance);\nreturn\nmix(mix(fill_color, border_color, fill_factor), vec4(.0), border_factor);\n}\nvec4 distance_to_color(\nconst CircleDistance circle_distance,\nconst vec4 fill_color)\n{\nfloat fill_factor = circle_distance.distance < g_distance_precision_limit\n? 0.\n: affine_step(0., circle_distance.width, circle_distance.distance);\nreturn mix(fill_color, vec4(0.), fill_factor);\n}\n",arrow_line:"uniform vec2 u_vec2_wing_normal;\nuniform vec2 u_vec2_tip_normal;\nuniform float u_float_tip_height_multiplier;\nuniform float u_float_wing_height_multiplier;\nvarying vec2 v_vec2_line_type_arrow_tail;\nvarying vec4 v_vec4_arrow_width_length_border_outer;\nvarying vec4 v_vec4_texcoord_arrow_line;\nvarying vec4 v_vec4_distance_vertex_hiding;\nvarying vec4 v_vec4_color;\nvarying vec4 v_vec4_border_color;\nconst float g_type_arrow = 1.;\nconst float g_type_start_border = 2.;\nbool lookalike(const float a, const float b)\n{\nreturn abs(a - b) < 1e-4;\n}\nfloat filter_border(const float start, const float value)\n{\nreturn step(start, value) * 2. - 1.;\n}\nfloat arrow_distance(\nconst ArrowDistanceParameters arrow_parameters,\nconst vec2 texcoord,\nconst float offset,\nconst mat2 derivatives,\nconst float line_distance,\nconst float line_distance_no_offset)\n{\nArrowDistances ad = calculate_arrow_distances(arrow_parameters, texcoord, offset, derivatives);\nfloat derivatives_x_multiplier = 1. / max(abs(derivatives[0].x), abs(derivatives[1].x));\nfloat intersection_point = arrow_parameters.full_length - arrow_parameters.arrow_height - arrow_parameters.width * u_vec2_wing_normal.y / u_vec2_wing_normal.x;\nfloat tail_arrow_intersection = filter_border(-1., (texcoord.x - intersection_point) * derivatives_x_multiplier);\nfloat tail_hide_part = v_vec2_line_type_arrow_tail.y;\nfloat tail_hide_mask = (-texcoord.x - tail_hide_part) * derivatives_x_multiplier;\nfloat clipped_tail = max(tail_hide_mask, max(line_distance, max(ad.top_left_wing, ad.top_right_wing)));\nfloat line_without_offset = filter_border(0., line_distance_no_offset);\nfloat wings_with_tail = max(min(min(ad.bottom_left_wing, ad.bottom_right_wing), line_without_offset), max(ad.top_left_wing, ad.top_right_wing));\nreturn (v_vec4_distance_vertex_hiding.x < v_vec4_distance_vertex_hiding.y)\n? max(ad.top_tip_cut, max(-max(tail_arrow_intersection, line_without_offset), wings_with_tail))\n: max(ad.top_tip_cut, min(clipped_tail, max(-max(tail_arrow_intersection, line_without_offset), wings_with_tail)));\n}\nvec4 distance_to_arrow_line_color(\nconst float fill_distance,\nconst float border_distance)\n{\nreturn distance_to_color(fill_distance, border_distance, v_vec4_color, v_vec4_border_color);\n}\nvec4 arrow_color(\nconst vec2 texcoord,\nconst ArrowDistanceParameters arrow_parameters,\nconst float line_fill_distance,\nconst float line_border_distance)\n{\nmat2 derivatives = mat2(dFdx(texcoord), dFdy(texcoord));\nfloat border_clipping = (abs(texcoord.y) - v_vec4_arrow_width_length_border_outer.w) / max(abs(derivatives[0].y), abs(derivatives[1].y));\nfloat arrow_border_distance = arrow_distance(\narrow_parameters,\ntexcoord,\nv_vec4_arrow_width_length_border_outer.z,\nderivatives,\nline_border_distance,\nline_fill_distance);\nfloat border_factor = max(border_clipping, affine_step(0., 1., arrow_border_distance));\nreturn distance_to_arrow_line_color(\narrow_distance(arrow_parameters, texcoord, 0., derivatives, line_fill_distance, line_fill_distance),\nborder_factor);\n}\nfloat line_start_distance(\nconst vec2 texcoord,\nconst float offset,\nconst mat2 derivatives,\nconst float line_distance)\n{\nfloat tail_hide_part = v_vec2_line_type_arrow_tail.y;\nfloat d0 = (-texcoord.x - offset) / max(abs(derivatives[0].x), abs(derivatives[1].x));\nfloat dh = (texcoord.x - tail_hide_part) / max(abs(derivatives[0].x), abs(derivatives[1].x));\nreturn max(d0, max(line_distance, dh));\n}\nvec4 line_color(const float line_fill_distance, const float line_border_distance)\n{\nfloat type = v_vec2_line_type_arrow_tail.x;\nfloat fill_distance = line_fill_distance;\nfloat border_distance = line_border_distance;\nif (lookalike(type, g_type_start_border))\n{\nvec2 texcoord = v_vec4_texcoord_arrow_line.xy;\nmat2 derivatives = mat2(dFdx(texcoord), dFdy(texcoord));\nfill_distance = line_start_distance(texcoord, 0., derivatives, line_fill_distance);\nborder_distance = line_start_distance(texcoord, v_vec4_arrow_width_length_border_outer.z, derivatives, line_border_distance);\n}\nreturn distance_to_arrow_line_color(fill_distance, border_distance);\n}\nvec4 arrow_line_color()\n{\nif (lookalike(min(v_vec4_distance_vertex_hiding.y, 1.), 1.)\n|| lookalike(v_vec4_distance_vertex_hiding.w, 1.)\n|| !lookalike(v_vec2_line_type_arrow_tail.x, g_type_arrow) && (v_vec4_distance_vertex_hiding.x < v_vec4_distance_vertex_hiding.y || v_vec4_distance_vertex_hiding.x > v_vec4_distance_vertex_hiding.z))\n{\ndiscard;\n}\nArrowDistanceParameters arrow_parameters = calculate_arrow_distance_parameters(\nu_vec2_wing_normal,\nu_vec2_tip_normal,\nv_vec4_arrow_width_length_border_outer.x,\nv_vec4_arrow_width_length_border_outer.y,\nu_float_tip_height_multiplier,\nu_float_wing_height_multiplier);\nfloat line_width = arrow_parameters.width;\nfloat line_border = v_vec4_arrow_width_length_border_outer.z;\nvec2 line_texcoord = v_vec4_texcoord_arrow_line.zw;\nmat2 line_derivatives = mat2(dFdx(line_texcoord), dFdy(line_texcoord));\nCircleDistance circle_fill_distance = circle_color_distance(line_derivatives, line_texcoord, line_width);\nCircleDistance circle_border_distance = circle_color_distance(line_derivatives, line_texcoord, line_width + line_border);\nfloat line_fill_distance = affine_step(-1., 0., circle_fill_distance.distance / circle_fill_distance.width) - 1.;\nfloat line_border_distance = affine_step(0., circle_border_distance.width, circle_border_distance.distance);\nreturn lookalike(v_vec2_line_type_arrow_tail.x, g_type_arrow)\n? arrow_color(v_vec4_texcoord_arrow_line.xy, arrow_parameters, line_fill_distance, line_border_distance)\n: line_color(line_fill_distance, line_border_distance);\n}\nvoid main()\n{\ngl_FragColor = arrow_line_color();\n}\n",arrow_line_identify:"\nvarying vec2 v_vec2_line_type_arrow_tail;\nvarying vec4 v_vec4_distance_vertex_hiding;\nvarying vec4 v_vec4_identifier;\nconst float g_type_arrow = 1.;\nbool lookalike(const float a, const float b)\n{\nreturn abs(a - b) < 1e-5;\n}\nvoid main()\n{\nif (lookalike(min(v_vec4_distance_vertex_hiding.y, 1.), 1.)\n|| lookalike(v_vec4_distance_vertex_hiding.w, 1.)\n|| !lookalike(v_vec2_line_type_arrow_tail.x, g_type_arrow) && (v_vec4_distance_vertex_hiding.x < v_vec4_distance_vertex_hiding.y || v_vec4_distance_vertex_hiding.x > v_vec4_distance_vertex_hiding.z))\n{\ndiscard;\n}\n    gl_FragColor = v_vec4_identifier;\n}\n",circle_marker:"uniform vec4 u_vec4_color;\nvarying vec2 v_vec2_circle;\nvarying float v_float_width;\nvoid main() {\n    float center_distance = dot(v_vec2_circle, v_vec2_circle);\n    gl_FragColor = u_vec4_color * affine_step(1.0, 1.0 - 4.0 / v_float_width, center_distance);\n}\n",road:"uniform vec4 u_vec4_color;\nvarying vec2 v_vec2_normal;\nvarying float v_float_half_width;\nvoid main()\n{\n    \n    float opacity = 1.0 - affine_step(\n        v_float_half_width - length(fwidth(v_vec2_normal)),\n        v_float_half_width,\n        length(v_vec2_normal)\n    );\n    gl_FragColor = u_vec4_color * opacity;\n}\n",road_identify:"varying vec4 v_vec4_identifier;\nvarying vec2 v_vec2_normal;\nvarying float v_float_half_width;\nvoid main()\n{\n    if (dot(v_vec2_normal, v_vec2_normal) > v_float_half_width * v_float_half_width) {\n        discard;\n    }\n    gl_FragColor = v_vec4_identifier;\n}\n",stretchable_image:"uniform sampler2D u_sr2d_texture;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\n  gl_FragColor = texture2D(u_sr2d_texture, v_vec2_texcoord);\n}\n",stretchable_image_identify:"uniform sampler2D u_sr2d_texture;\nvarying vec2 v_vec2_texcoord;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\n  vec4 color = texture2D(u_sr2d_texture, v_vec2_texcoord);\n  if (color.a < 0.1) {\n    discard;\n  } else {\n    gl_FragColor = v_vec4_identifier;\n  }\n}\n",rect:"uniform vec4 u_vec4_color;\nvoid main()\n{\ngl_FragColor = u_vec4_color;\n}\n",rect_with_texture:"uniform sampler2D u_sr2d_texture;\nuniform float u_float_opacity;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\n  gl_FragColor = apply_opacity(texture2D(u_sr2d_texture, v_vec2_texcoord), u_float_opacity);\n}\n",heatmap:"uniform highp float u_float_intensity;\nvarying float v_float_weight;\nvarying vec2 v_vec2_extrude;\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n    float d = -0.5 * 3.0 * 3.0 * dot(v_vec2_extrude, v_vec2_extrude);\n    float val = v_float_weight * u_float_intensity * GAUSS_COEF * exp(d);\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n}",heatmap_texture:"uniform sampler2D u_sr2d_texture;\nuniform sampler2D u_sr2d_ramp_texture;\nuniform float u_float_opacity;\nvarying vec2 v_vec2_position;\nvoid main() {\n    float t = texture2D(u_sr2d_texture, v_vec2_position).r;\n    vec4 color = texture2D(u_sr2d_ramp_texture, vec2(t, 0.5));\n    gl_FragColor = color * u_float_opacity;\n}",dem_mesh:"\nuniform sampler2D u_flat_tex;\nuniform sampler2D u_tex_hillshade_ramp;\nuniform float u_float_dem_shade_intension;\nvarying vec3 v_vec3_texcoord;\nvarying float v_float_hillshade;\nconst float M_PI = 3.1415926535897932384626433832795;\nconst float zenith = 45. * M_PI / 180.;\nconst float HILLSHADE_OFFSET = cos(zenith) - 0.5;\nvoid main()\n{\nif (v_vec3_texcoord.z == 0.) {\ndiscard;\n}\nfloat shade_value = texture2D(u_tex_hillshade_ramp, vec2(v_float_hillshade, 0.5)).a;\nfloat base = 1. - u_float_dem_shade_intension;\ngl_FragColor = texture2D(u_flat_tex, v_vec3_texcoord.xy);\ngl_FragColor.rgb = (gl_FragColor.rgb * base) + (gl_FragColor.rgb * 2. * u_float_dem_shade_intension * (shade_value - HILLSHADE_OFFSET));\n}",dem_elevation:"uniform sampler2D u_sr2d_texture;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\n  vec4 color = texture2D(u_sr2d_texture, v_vec2_texcoord);\n  gl_FragColor = vec4(color.a, 0, 0, 1);\n}"},br={apply_height_factor:"vec4 apply_z_limitation(vec4 vertex, float tile_height, float height_limitation)\n{\nvertex.z = min(vertex.z, height_limitation / tile_height);\nreturn vertex;\n}\nvec4 apply_height_factor(const vec3 vertex, const float height_factor)\n{\nvec3 result_vertex = vertex;\nresult_vertex.z *= height_factor;\nreturn vec4(result_vertex, 1.0);\n}\n",apply_opacity:yr,color:"uniform mat4 u_mat4_mvp;\nuniform vec4 u_vec4_color;\nuniform float u_float_opacity;\nattribute vec2 a_vec2_vertex;\nvarying vec4 v_vec4_color;\nvoid main()\n{\nv_vec4_color = apply_opacity(u_vec4_color, u_float_opacity);\ngl_Position = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0);\n}\n",diffuse:"uniform mat4 u_mat4_mvp;\nuniform vec3 u_vec3_light_direction;\nuniform vec3 u_vec3_light_color;\nuniform vec3 u_vec3_ambient_color;\nuniform vec4 u_vec4_color;\nuniform float u_float_height_limitation;\nuniform float u_float_tile_height;\nuniform float u_float_height_factor;\nuniform float u_float_opacity;\nattribute vec3 a_vec3_vertex;\nattribute vec3 a_vec3_normal;\nattribute vec2 a_vec2_dem_position;\nvarying vec4 v_vec4_color;\nconst float g_wall_offset_isometric = .001;\nconst float g_wall_offset_perspective = 8.;\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\nif (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nv_vec4_color = vec4(0, 0, 0, 0);\nreturn;\n    }\nv_vec4_color = apply_opacity(\nvec4(\nu_vec4_color.rgb * (u_vec3_ambient_color + u_vec3_light_color * abs(dot(u_vec3_light_direction, normalize_s08(a_vec3_normal)))),\nu_vec4_color.a),\nu_float_opacity);\nvec4 vertex_hf = apply_height_factor(a_vec3_vertex, u_float_height_factor);\nvertex_hf.z += height;\nvertex_hf = apply_z_limitation(vertex_hf, u_float_tile_height, u_float_height_limitation);\nvertex_hf.z = max(vertex_hf.z, height);\ngl_Position = u_mat4_mvp * vertex_hf;\nif (normalize_s08(a_vec3_normal).z < .5)\n{\nif ((u_mat4_mvp[0][3] == 0.) && (u_mat4_mvp[1][3] == 0.) && (u_mat4_mvp[2][3] == 0.))\n{\ngl_Position.z += g_wall_offset_isometric;\n}\nelse\n{\nif (height == 0.) {\ngl_Position.z += g_wall_offset_perspective;\n} else {\ngl_Position.z += g_wall_offset_isometric;\n}\n}\n}\n}\n",line:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_light_direction;\nuniform vec3 u_vec3_light_color;\nuniform vec3 u_vec3_ambient_color;\nuniform vec4 u_vec4_color;\nuniform float u_float_height_limitation;\nuniform float u_float_tile_height;\nuniform float u_float_height_factor;\nuniform float u_float_opacity;\nattribute vec4 a_vec4_vertex;\nattribute vec2 a_vec2_normal;\nattribute vec2 a_vec2_normal_delta;\nattribute vec3 a_vec3_direction;\nattribute float a_float_distance;\nattribute vec2 a_vec2_dem_position;\nvarying vec4 v_vec4_color;\nvarying float v_float_distance;\nconst float g_shift_pixels = 1.;\nconst float g_min_denominator = 1e-4;\nconst float g_w_factor = 1e-6;\nvec2 multiply_complex(vec2 lhs, vec2 rhs)\n{\nreturn vec2(lhs.x * rhs.x - lhs.y * rhs.y, lhs.x * rhs.y + lhs.y * rhs.x);\n}\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\n    if (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\n        return;\n    }\nvec2 half_viewport = u_vec2_vpt_size / vec2(2.);\nvec4 clip_space_direction = u_mat4_mvp * vec4(normalize_s08(vec3(a_vec3_direction.xy, a_vec3_direction.z + height)), 0.);\nvec4 vertex_hf = apply_height_factor(a_vec4_vertex.xyz, u_float_height_factor);\nvertex_hf.z += height;\nvertex_hf = apply_z_limitation(vertex_hf, u_float_tile_height, u_float_height_limitation);\nvertex_hf.z = max(vertex_hf.z, height);\nvec4 clip_space_vertex = u_mat4_mvp * vertex_hf;\nvec2 screen_space_direction = (clip_space_direction.xy * clip_space_vertex.w - clip_space_vertex.xy * clip_space_direction.w) * half_viewport;\nvec2 screen_space_perp = vec2(-screen_space_direction.y, screen_space_direction.x);\nfloat denominator = max(g_min_denominator, length(screen_space_perp));\nvec2 bevel_normal = normalize_s08(a_vec2_normal);\nvec2 normal_delta = normalize_s08(a_vec2_normal_delta);\nvec4 clip_space_bevel_normal = u_mat4_mvp * vec4(bevel_normal, 0., 0.);\nvec2 screen_space_bevel_normal = (clip_space_bevel_normal.xy * clip_space_vertex.w - clip_space_vertex.xy * clip_space_bevel_normal.w) * half_viewport;\nfloat bevel_denominator = max(g_min_denominator, length(screen_space_bevel_normal));\nfloat normal_factor = -dot(screen_space_bevel_normal, screen_space_perp) / denominator / bevel_denominator;\nvec2 wall_normal = multiply_complex(bevel_normal, vec2(normal_delta.x, sign(normal_factor) * normal_delta.y));\nfloat bevel_diffuse = abs(dot(u_vec3_light_direction.xy, bevel_normal));\nfloat wall_diffuse = abs(dot(u_vec3_light_direction.xy, wall_normal));\nfloat diffuse = mix(bevel_diffuse, wall_diffuse, abs(normal_factor));\ngl_Position = g_w_factor * (clip_space_vertex + vec4(screen_space_perp / half_viewport, 0., 0.) * g_shift_pixels * a_float_distance / denominator * clip_space_vertex.w);\nv_vec4_color = vec4(u_vec4_color.rgb * (u_vec3_ambient_color + u_vec3_light_color * diffuse), u_vec4_color.a);\nv_float_distance = a_float_distance * gl_Position.w;\n}\n",packed_attributes:"\nvec2 normalize_s08(vec2 value)\n{\nreturn value * (1. / 127.);\n}\nvec3 normalize_s08(vec3 value)\n{\nreturn value * (1. / 127.);\n}\nfloat normalize_s16(float value)\n{\nreturn value * (1. / 32767.);\n}\nvec2 normalize_s16(vec2 value)\n{\nreturn value * (1. / 32767.);\n}\nvec3 normalize_s16(vec3 value)\n{\nreturn value * (1. / 32767.);\n}\nvec2 unpack_widen(vec2 widen_packed)\n{\nreturn normalize_s08(widen_packed) * sqrt(2.);\n}\nvec2 unpack_texcoord(vec2 texcoord)\n{\nreturn texcoord * (1. / 32768.);\n}\nvec2 unpack_model_texcoord(vec2 texcoord)\n{\nconst float min_value = -3.0;\nconst float max_value = 5.0;\nreturn texcoord * (max_value - min_value) / 65536.0 + min_value;\n}\n",pixel_offset:"\nconst float g_min_denominator = 1e-7;\nconst float g_max_factor = 10000.;\nfloat calculate_multiplication_factor(\nvec2 half_viewport,\nvec4 clip_space_widen,\nvec4 clip_space_widen_perp,\nvec4 clip_space_vertex,\nfloat shift_pixels)\n{\nfloat limited_factor = 0.;\n{\nvec2 screen_space_widen = (clip_space_widen.xy * clip_space_vertex.w - clip_space_vertex.xy * clip_space_widen.w) * half_viewport;\nvec2 screen_space_widen_perp = (clip_space_widen_perp.xy * clip_space_vertex.w - clip_space_vertex.xy * clip_space_widen_perp.w) * half_viewport;\nvec2 perp = vec2(screen_space_widen_perp.y, -screen_space_widen_perp.x);\nfloat perp_length = length(perp);\nvec4 v = clip_space_vertex;\nvec4 n = clip_space_widen;\nfloat denominator = dot(perp, screen_space_widen) / shift_pixels - n.w * v.w * perp_length;\nif (abs(denominator) > g_min_denominator)\n{\nfloat factor = v.w * v.w * perp_length / denominator;\nlimited_factor = sign(factor) * min(g_max_factor, abs(factor));\n}\n}\nreturn limited_factor;\n}\n",pointsprite:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform float u_float_height_factor;\nuniform float u_float_rounding_factor;\nuniform vec2 u_vec2_rotation; \nattribute vec3 a_vec3_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nattribute vec2 a_vec2_range;\nattribute vec2 a_vec2_rescale;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\nfloat height = dem_height(a_vec3_position.xy);\n    if (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nreturn;\n    } \nmat2 rotation_matrix = mat2(\nu_vec2_rotation.x, -u_vec2_rotation.y,\nu_vec2_rotation.y, u_vec2_rotation.x\n);\nvec2 inv_half_size = 2.0 / u_vec2_vpt_size;\nvec4 anchor = apply_height_factor(a_vec3_position, u_float_height_factor);\nanchor.z += height;\nanchor = u_mat4_mvp * anchor;\nvec2 offset = rescale(rotation_matrix * a_vec2_offset, a_vec2_rescale, a_vec2_range, u_vec3_projection_scale_style_scale_dpi.y);\nvec2 pos_2d = anchor.xy + overlay_transform(offset, inv_half_size) * anchor.w;\nvec2 corner = make_position(pos_2d, anchor.w, inv_half_size, u_float_rounding_factor);\ngl_Position = vec4(corner, anchor.z, clipw(anchor.w, a_vec2_range, u_vec3_projection_scale_style_scale_dpi.y));\nv_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}\n",precision_constants:"\nconst float g_circle_scale_precision_factor = 1e8;\n",striped_line:"uniform mat4 u_mat4_mvp;\nuniform vec4 u_vec4_dash_color;\nuniform vec4 u_vec4_space_color;\nuniform vec4 u_vec4_border_color;\nuniform mediump vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform float u_float_width;\nuniform float u_float_width_offset;\nuniform vec2 u_vec2_scaler_params;\nuniform float u_float_dash_length;\nuniform float u_float_space_length;\nuniform float u_float_dash2_length;\nuniform float u_float_opacity;\nattribute vec2 a_vec2_vertex;\nattribute vec2 a_vec2_texture_widen;\nattribute vec2 a_vec2_widen;\nattribute float a_float_vertex_distance;\nattribute float a_float_component_distance;\nattribute float a_float_object_length;\nvarying vec4 v_vec4_dash_color;\nvarying vec4 v_vec4_space_color;\nvarying vec4 v_vec4_border_color;\nvarying vec2 v_vec2_circle;\nvarying float v_float_width;\nvarying float v_float_part_color_swap_threshold;\nvarying float v_float_distance_in_parts;\nconst float g_shift_pixels = 2.;\nconst float g_w_factor = 1e-7;\nPolylineDistance decode_line_distance()\n{\nreturn PolylineDistance(\na_float_vertex_distance,\na_float_component_distance,\na_float_object_length);\n}\nStripedLineInParams decode_line_params(const Scale scale)\n{\nfloat width = calculate_final_width(scale, u_float_width, u_float_width_offset);\nfloat dash_length  = scale.calculation * u_float_dash_length;\nfloat space_length = scale.calculation * u_float_space_length;\nfloat dash2_length = scale.calculation * u_float_dash2_length;\nreturn StripedLineInParams(\ndash_length,\nspace_length,\ndash2_length,\nwidth);\n}\nvoid main()\n{\nScale scale = calculate_scale(u_vec3_projection_scale_style_scale_dpi, u_vec2_scaler_params);\nStripedLineInParams params = decode_line_params(scale);\nvec2 widen = unpack_widen(a_vec2_widen);\nvec2 widen_perp = vec2(-widen.y, widen.x);\nvec4 clip_space_widen = u_mat4_mvp * vec4(widen, 0., 0.);\nvec4 clip_space_widen_perp = u_mat4_mvp * vec4(widen_perp, 0., 0.);\nvec4 clip_space_vertex = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0) + clip_space_widen * params.line_width;\nvec2 half_viewport = 0.5 * u_vec2_vpt_size;\nfloat limited_factor = calculate_multiplication_factor(\nhalf_viewport,\nclip_space_widen,\nclip_space_widen_perp,\nclip_space_vertex,\ng_shift_pixels);\nPolylineDistance distance_decoded = decode_line_distance();\nStripedLineOutParams output_params;\ncalculate_line_params(distance_decoded, params, output_params);\nvec2 texture_widen_with_shift_sign = unpack_widen(a_vec2_texture_widen);\nfloat shift_sign = sign(dot(widen, texture_widen_with_shift_sign));\nvec2 texture_widen = shift_sign * texture_widen_with_shift_sign;\nvec2 texture_widen_perp = vec2(-texture_widen.y, texture_widen.x);\nfloat distance_shift = shift_sign * abs(dot(widen, texture_widen_perp)) * params.line_width;\nfloat circle_factor = g_circle_scale_precision_factor / scale.calculation;\nv_vec2_circle = texture_widen * (params.line_width + limited_factor) * circle_factor;\nv_float_width = params.line_width * circle_factor;\nv_float_part_color_swap_threshold = output_params.part_color_swap_threshold;\nv_float_distance_in_parts = output_params.distance_in_parts;\nv_vec4_dash_color = apply_opacity(u_vec4_dash_color, u_float_opacity);\nv_vec4_space_color = apply_opacity(u_vec4_space_color, u_float_opacity);\nv_vec4_border_color = apply_opacity(u_vec4_border_color, u_float_opacity);\ngl_Position = (clip_space_vertex + clip_space_widen * limited_factor) * g_w_factor;\n}\n",striped_line_identify:"uniform mat4 u_mat4_mvp;\nuniform vec4 u_vec4_dash_color;\nuniform vec4 u_vec4_space_color;\nuniform vec4 u_vec4_border_color;\nuniform mediump vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform float u_float_width;\nuniform float u_float_width_offset;\nuniform vec2 u_vec2_scaler_params;\nuniform float u_float_dash_length;\nuniform float u_float_space_length;\nuniform float u_float_dash2_length;\nuniform float u_float_opacity;\nattribute vec2 a_vec2_vertex;\nattribute vec2 a_vec2_texture_widen;\nattribute vec2 a_vec2_widen;\nattribute float a_float_vertex_distance;\nattribute float a_float_component_distance;\nattribute float a_float_object_length;\nattribute vec4 a_vec4_identifier;\nvarying vec4 v_vec4_identifier;\nvarying vec4 v_vec4_dash_color;\nvarying vec4 v_vec4_space_color;\nvarying vec4 v_vec4_border_color;\nvarying vec2 v_vec2_circle;\nvarying float v_float_width;\nvarying float v_float_part_color_swap_threshold;\nvarying float v_float_distance_in_parts;\nconst float g_shift_pixels = 2.;\nconst float g_w_factor = 1e-7;\nPolylineDistance decode_line_distance()\n{\nreturn PolylineDistance(\na_float_vertex_distance,\na_float_component_distance,\na_float_object_length);\n}\nStripedLineInParams decode_line_params(const Scale scale)\n{\nfloat width = calculate_final_width(scale, u_float_width, u_float_width_offset);\nfloat dash_length  = scale.calculation * u_float_dash_length;\nfloat space_length = scale.calculation * u_float_space_length;\nfloat dash2_length = scale.calculation * u_float_dash2_length;\nreturn StripedLineInParams(\ndash_length,\nspace_length,\ndash2_length,\nwidth);\n}\nvoid main()\n{\nScale scale = calculate_scale(u_vec3_projection_scale_style_scale_dpi, u_vec2_scaler_params);\nStripedLineInParams params = decode_line_params(scale);\nvec2 widen = unpack_widen(a_vec2_widen);\nvec2 widen_perp = vec2(-widen.y, widen.x);\nvec4 clip_space_widen = u_mat4_mvp * vec4(widen, 0., 0.);\nvec4 clip_space_widen_perp = u_mat4_mvp * vec4(widen_perp, 0., 0.);\nvec4 clip_space_vertex = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0) + clip_space_widen * params.line_width;\nvec2 half_viewport = 0.5 * u_vec2_vpt_size;\nfloat limited_factor = calculate_multiplication_factor(\nhalf_viewport,\nclip_space_widen,\nclip_space_widen_perp,\nclip_space_vertex,\ng_shift_pixels);\nPolylineDistance distance_decoded = decode_line_distance();\nStripedLineOutParams output_params;\ncalculate_line_params(distance_decoded, params, output_params);\nvec2 texture_widen_with_shift_sign = unpack_widen(a_vec2_texture_widen);\nfloat shift_sign = sign(dot(widen, texture_widen_with_shift_sign));\nvec2 texture_widen = shift_sign * texture_widen_with_shift_sign;\nvec2 texture_widen_perp = vec2(-texture_widen.y, texture_widen.x);\nfloat distance_shift = shift_sign * abs(dot(widen, texture_widen_perp)) * params.line_width;\nfloat circle_factor = g_circle_scale_precision_factor / scale.calculation;\nv_vec2_circle = texture_widen * (params.line_width + limited_factor) * circle_factor;\nv_float_width = params.line_width * circle_factor;\nv_float_part_color_swap_threshold = output_params.part_color_swap_threshold;\nv_float_distance_in_parts = output_params.distance_in_parts;\nv_vec4_dash_color = apply_opacity(u_vec4_dash_color, u_float_opacity);\nv_vec4_space_color = apply_opacity(u_vec4_space_color, u_float_opacity);\nv_vec4_border_color = apply_opacity(u_vec4_border_color, u_float_opacity);\nv_vec4_identifier = a_vec4_identifier;\nif (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n{\ngl_Position = (clip_space_vertex + clip_space_widen * limited_factor) * g_w_factor;\n}\nelse\n{\ngl_Position = vec4(1., 1., 1., 1.);\n}\n}\n",striped_line_functions:"struct PolylineDistance\n{\nfloat vertex_distance_from_start;\nfloat segment_distance_from_start;\nfloat total_length;\n};\nstruct StripedLineInParams\n{\nfloat dash_length;\nfloat space_length;\nfloat dash2_length;\nfloat line_width;\n};\nstruct StripedLineOutParams\n{\nfloat part_color_swap_threshold;\nfloat distance_in_parts;\n};\nvoid calculate_line_params(in PolylineDistance polyline_distance, in StripedLineInParams striped_line_params, out StripedLineOutParams line_params)\n{\nfloat requested_part_length =\nstriped_line_params.dash_length\n+ striped_line_params.space_length;\nfloat space2_length = requested_part_length - striped_line_params.dash2_length;\nfloat min_part_length =\nrequested_part_length\n- 0.5 * min(striped_line_params.space_length, space2_length);\nfloat part_count = max(\nfloor(polyline_distance.total_length / requested_part_length + 0.5),\n1.0);\nfloat part_length = polyline_distance.total_length / part_count;\nfloat dash_length = (part_length / requested_part_length) * striped_line_params.dash2_length;\nfloat part_color_swap_threshold;\nif (polyline_distance.total_length < min_part_length)\n{\ndash_length = part_length;\npart_color_swap_threshold = 1.0;\n}\nelse\n{\npart_color_swap_threshold = dash_length / part_length;\n}\nfloat segment_start = fract((polyline_distance.segment_distance_from_start + 0.5 * dash_length) / part_length);\nfloat vertex_normalized_distance = segment_start + polyline_distance.vertex_distance_from_start / part_length;\nline_params = StripedLineOutParams(\npart_color_swap_threshold,\nvertex_normalized_distance);\n}\n",label_fixed_anchor:"uniform mat4 u_mat4_mvp;\nattribute vec4 a_vec4_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nuniform vec2 u_vec2_offset;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_scale;\nuniform float u_float_height_factor;\nvarying vec2 v_vec2_texcoord;\nvoid main() {\n    float height = dem_height(a_vec4_position.xy);\n    \n    if (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\n        return;\n    }\n    vec4 ndcPosition = apply_height_factor(a_vec4_position.xyz, u_float_height_factor);\n    ndcPosition.z += height;\n    ndcPosition = u_mat4_mvp * ndcPosition;\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += (a_vec2_offset * u_float_scale + u_vec2_offset) / u_vec2_vpt_size * 2.0;\n    gl_Position = ndcPosition;\n    v_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}\n",label_fixed_anchor_identify:"uniform mat4 u_mat4_mvp;\nattribute vec4 a_vec4_position;\nattribute vec2 a_vec2_offset;\nattribute vec4 a_vec4_identifier;\nuniform vec2 u_vec2_offset;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_scale;\nvarying vec4 v_vec4_identifier;\nvoid main() {\n    float height = dem_height(a_vec4_position.xy);\n    \n    if (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\n        return;\n    }\n    \n    v_vec4_identifier = a_vec4_identifier;\n    if (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n    {\n        vec4 ndcPosition = u_mat4_mvp * vec4(a_vec4_position.xy, a_vec4_position.z + height, a_vec4_position.w);\n        ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n        ndcPosition.w = 1.0;\n        ndcPosition.xy += (a_vec2_offset * u_float_scale + u_vec2_offset) / u_vec2_vpt_size * 2.0;\n        gl_Position = ndcPosition;\n    }\n    else\n    {\n        gl_Position = vec4(1., 1., 1., 1.);\n    }\n}\n",label_directional:"uniform mat4 u_mat4_mvp;\nattribute vec4 a_vec4_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nattribute vec2 a_vec2_style_zoom_limits;\nuniform float u_float_style_zoom;\nuniform float u_float_scale;\nuniform float u_float_tile_to_pixel_ratio;\nvarying vec2 v_vec2_texcoord;\nfloat clipw(const float w, const vec2 range, const float zoom) {\n    return w * (step(range.x, zoom) - step(range.y, zoom));\n}\nvoid main() {\n    vec4 newPosition = a_vec4_position;\n    newPosition.xy += a_vec2_offset * u_float_scale * u_float_tile_to_pixel_ratio;\n    newPosition = u_mat4_mvp * newPosition;\n    gl_Position = vec4(newPosition.xyz, clipw(newPosition.w, a_vec2_style_zoom_limits, u_float_style_zoom));\n    v_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}\n",one_way_line:"uniform vec4 u_vec4_color;\nuniform vec4 u_vec4_border_color;\nuniform mat4 u_mat4_mvp;\nuniform mediump vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform vec2 u_vec2_scale_limits;\nuniform float u_float_border_width;\nuniform float u_float_border_width_offset;\nuniform float u_float_size_factor;\nuniform mediump float u_float_width;\nuniform mediump float u_float_length;\nuniform float u_float_wing_width_multiplier;\nuniform float u_float_opacity;\nattribute vec2 a_vec2_position;\nattribute vec2 a_vec2_direction;\nattribute vec2 a_vec2_widen_direction;\nvarying vec4 v_vec4_color;\nvarying vec4 v_vec4_border_color;\nvarying vec2 v_vec2_texcoord;\nvarying float v_float_border_width;\nvarying float v_float_zpt_to_texcoord_factor;\nvarying float v_float_outer_width;\nvarying float v_float_opacity;\nconst float g_shift_pixels = 2.;\nconst float g_w_factor = 1e-7;\nvoid main()\n{\nfloat style_scale_clamped = clamp(u_vec3_projection_scale_style_scale_dpi.y, u_vec2_scale_limits.x, u_vec2_scale_limits.y);\nfloat scale_ratio = u_vec3_projection_scale_style_scale_dpi.x / u_vec3_projection_scale_style_scale_dpi.y;\nfloat calculation_scale = style_scale_clamped * scale_ratio;\nArrowParameters arrow_parameters = calculate_arrow_parameters(\ncalculation_scale,\nu_float_width,\nu_float_border_width,\nu_float_length,\nu_float_wing_width_multiplier,\nu_float_size_factor);\nv_float_zpt_to_texcoord_factor = arrow_parameters.zpt_to_texcoord_factor;\nv_float_outer_width = arrow_parameters.outer_width;\nvec2 direction = normalize_s08(a_vec2_direction);\nvec2 untransformed_widen = a_vec2_widen_direction * arrow_parameters.widen_size;\nvec2 widen = multiply_complex(untransformed_widen * arrow_parameters.final_size, direction);\nfloat shift_pixels = g_shift_pixels * sqrt(2.) / min(abs(untransformed_widen.x), abs(untransformed_widen.y));\nVertexShiftParameters shift_parameters = calculate_vertex_shift_parameters(\nu_mat4_mvp,\nu_vec2_vpt_size,\na_vec2_position,\nwiden,\nshift_pixels);\ngl_Position = shift_parameters.clip_space_vertex / arrow_parameters.final_size * g_w_factor;\nv_vec2_texcoord = untransformed_widen * (1. + shift_parameters.limited_factor);\nfloat border_width = u_float_border_width * v_float_zpt_to_texcoord_factor;\nfloat border_width_offset = u_float_border_width_offset * v_float_zpt_to_texcoord_factor;\nv_float_border_width = max(0., border_width - u_vec3_projection_scale_style_scale_dpi.y / style_scale_clamped * border_width_offset);\nv_vec4_color = apply_opacity(u_vec4_color, u_float_opacity);\nv_vec4_border_color = apply_opacity(u_vec4_border_color, u_float_opacity);\nv_float_opacity = u_float_opacity;\n}\n",round_position:"\nvec4 round_position(const vec4 position, const vec2 half_viewport)\n{\nif (\nposition.w < 0.\n|| position.x < -position.w\n|| position.x > position.w\n|| position.y < -position.w\n|| position.y > position.w\n|| position.z < -position.w\n|| position.z > position.w)\n{\nreturn position;\n}\nelse\n{\nreturn vec4(\nsign(position.xy) * floor(abs(position.xy) * half_viewport / position.w + .5)\n* position.w / half_viewport,\nposition.zw);\n}\n}\n",color_identify:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nattribute vec2 a_vec2_vertex;\nattribute vec4 a_vec4_identifier;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\nv_vec4_identifier = a_vec4_identifier;\nif (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n{\ngl_Position = round_position(u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.), .5 * u_vec2_vpt_size);\n}\nelse\n{\ngl_Position = vec4(1., 1., 1., 1.);\n}\n}\n",model_identify:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nattribute vec3 a_vec3_vertex;\nattribute vec4 a_vec4_identifier;\nattribute vec2 a_vec2_dem_position;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\nif (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nreturn;\n    }\nv_vec4_identifier = a_vec4_identifier;\nif (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n{\ngl_Position = round_position(u_mat4_mvp * vec4(a_vec3_vertex.xy, a_vec3_vertex.z + height, 1.), .5 * u_vec2_vpt_size);\n}\nelse\n{\ngl_Position = vec4(1., 1., 1., 1.);\n}\n}\n",pointsprite_identify:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform float u_float_height_factor;\nuniform vec2 u_vec2_rotation; \nattribute vec3 a_vec3_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nattribute vec2 a_vec2_range;\nattribute vec2 a_vec2_rescale;\nattribute vec4 a_vec4_identifier;\nvarying vec2 v_vec2_texcoord;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\nif (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n{\nfloat height = dem_height(a_vec3_position.xy);\nif (height == DEM_INVALID_VALUE) {\ngl_Position = vec4(0, 0, 0, 0);\nreturn;\n} \nmat2 rotation_matrix = mat2(\nu_vec2_rotation.x, -u_vec2_rotation.y,\nu_vec2_rotation.y, u_vec2_rotation.x\n);\nvec2 inv_half_size = 2.0 / u_vec2_vpt_size;\nvec4 anchor = apply_height_factor(a_vec3_position, u_float_height_factor);\nanchor.z += height;\nanchor = u_mat4_mvp * anchor;\nvec2 offset = rescale(rotation_matrix * a_vec2_offset, a_vec2_rescale, a_vec2_range, u_vec3_projection_scale_style_scale_dpi.y);\nvec2 pos_2d = anchor.xy + overlay_transform(offset, inv_half_size) * anchor.w;\nvec2 corner = make_position(pos_2d, anchor.w, inv_half_size, 1.0);\ngl_Position = vec4(corner, anchor.z, clipw(anchor.w, a_vec2_range, u_vec3_projection_scale_style_scale_dpi.y));\n}\nelse\n{\ngl_Position = vec4(1., 1., 1., 1.);\n}\nv_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\nv_vec4_identifier = a_vec4_identifier;\n}\n",model:"uniform mat4 u_mat4_mvp;\nuniform float u_float_height_factor;\nattribute vec3 a_vec3_vertex;\nattribute vec2 a_vec2_texcoord;\nattribute vec2 a_vec2_dem_position;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\nif (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nreturn;\n    }\nv_vec2_texcoord = unpack_model_texcoord(a_vec2_texcoord);\nvec4 vh = apply_height_factor(a_vec3_vertex, u_float_height_factor);\nvh.z += height;\ngl_Position = u_mat4_mvp * vh;\n}\n",simple_line:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_width;\nuniform float u_float_height_factor;\nuniform float u_float_height_limitation;\nuniform float u_float_tile_height;\nuniform float u_float_z_offset;\nattribute vec3 a_vec3_vertex;\nattribute vec4 a_vec4_direction_distance;\nattribute vec2 a_vec2_dem_position;\nvarying float v_float_distance;\nvarying float v_float_distance_offset;\nconst float g_smooth_width = 1.;\nconst float g_min_denominator = 1e-4;\nconst float g_w_factor = 1e-6;\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\n    if (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nreturn;\n    } \nfloat shift_pixels = 0.5 * max(u_float_width - 1., 0.);\nfloat shift_pixels_added = shift_pixels + g_smooth_width;\nvec3 direction = a_vec4_direction_distance.xyz;\nfloat distance = a_vec4_direction_distance.w;\nvec2 half_viewport = u_vec2_vpt_size / vec2(2.);\nvec4 clip_space_direction = normalize(u_mat4_mvp * vec4(normalize_s08(direction), 0.));\nvec4 clip_space_vertex = apply_height_factor(a_vec3_vertex, u_float_height_factor);\nclip_space_vertex.z += height;\nclip_space_vertex = apply_z_limitation(\nclip_space_vertex,\nu_float_tile_height, u_float_height_limitation\n);\nclip_space_vertex.z = max(clip_space_vertex.z, height);\nclip_space_vertex = u_mat4_mvp * clip_space_vertex;\nvec2 screen_space_direction =\n(clip_space_direction.xy * clip_space_vertex.w - clip_space_vertex.xy * clip_space_direction.w) * half_viewport;\nvec2 screen_space_perp = vec2(-screen_space_direction.y, screen_space_direction.x);\nfloat denominator = max(g_min_denominator, length(screen_space_perp));\ngl_Position = g_w_factor * (clip_space_vertex + vec4(screen_space_perp / half_viewport, 0., 0.)\n* distance * shift_pixels_added / denominator * clip_space_vertex.w);\ngl_Position.z += u_float_z_offset;\nv_float_distance = shift_pixels_added * distance * gl_Position.w;\nv_float_distance_offset = shift_pixels;\n}\n",arrow_line_entrance:"uniform vec4 u_vec4_color;\nuniform vec4 u_vec4_border_color;\nuniform mat4 u_mat4_mvp;\nuniform mediump vec2 u_vec2_vpt_size;\nuniform vec3 u_vec3_projection_scale_style_scale_dpi;\nuniform vec2 u_vec2_scale_limits;\nuniform float u_float_width_zpt;\nuniform float u_float_wing_width_multiplier;\nuniform float u_float_border_width_zpt;\nuniform float u_float_size_factor;\nuniform float u_float_border_width_offset;\nuniform float u_float_tip_height_multiplier;\nuniform float u_float_relative_end_position;\nuniform float u_float_tip_movement_amplitude;\nuniform float u_float_vertex_shift; \nuniform float u_float_opacity;\nattribute vec2 a_vec2_vertex;\nattribute vec2 a_vec2_segment_end;\nattribute vec4 a_vec4_texture_widen_arrow_widen;\nattribute vec2 a_vec2_widen;\nattribute vec2 a_vec2_direction; \nattribute float a_float_distance_from_start;\nattribute float a_float_object_length;\nattribute float a_float_type;\nattribute vec4 a_vec4_identifier; \nvarying vec2 v_vec2_line_type_arrow_tail;\nvarying vec4 v_vec4_arrow_width_length_border_outer;\nvarying vec4 v_vec4_texcoord_arrow_line;\nvarying vec4 v_vec4_distance_vertex_hiding;\nvarying vec4 v_vec4_identifier;\nvarying vec4 v_vec4_color;\nvarying vec4 v_vec4_border_color;\nconst float g_w_factor = 1e-7;\nconst float g_type_line = 0.;\nconst float g_type_arrow = 1.;\nconst float g_type_start_border = 2.;\nconst float g_type_line_ending = 3.;\nconst float g_type_line_cut = 4.;\nconst float g_shift_pixels = 2.;\nconst float g_line_overlapping_part = .2;\nstruct ArrowLineViewParameters\n{\nfloat vertex_type;\nfloat width_zpt;\nfloat border_width_zpt;\nfloat border_width_offset;\nfloat arrow_segment_length_zpt;\nfloat wing_width_multiplier;\nfloat size_factor;\nvec2 vertex_position;\nvec2 vertex_widen;\nvec2 line_texture_widen;\nvec2 arrow_texture_widen;\nvec2 segment_direction;\nfloat segment_length;\nfloat distance_to_end;\n};\nstruct DistanceShiftParameters\n{\nfloat shift;\nbool invisible;\n};\nvec2 perp(const vec2 vector)\n{\nreturn vec2(-vector.y, vector.x);\n}\nvec2 vertex_shift(const Scale scale)\n{\nreturn u_float_vertex_shift * u_float_tip_movement_amplitude * normalize_s08(a_vec2_direction) * scale.calculation;\n}\nvec2 arrow_shift(const ArrowLineViewParameters view)\n{\nreturn view.segment_direction * view.distance_to_end;\n}\nfloat erase_length_end()\n{\nreturn clamp(u_float_relative_end_position, 0., 1.) * a_float_object_length;\n}\nvoid set_texcoord_varyings(const vec2 arrow_texcoord, const vec2 line_texcoord)\n{\nv_vec4_texcoord_arrow_line = vec4(arrow_texcoord, line_texcoord);\n}\nvoid set_arrow_varyings(\nconst float arrow_width,\nconst float arrow_length,\nconst float arrow_border,\nconst float arrow_outer_width,\nconst float arrow_tail_hide_part)\n{\nv_vec4_arrow_width_length_border_outer = vec4(\narrow_width,\narrow_length,\narrow_border,\narrow_outer_width);\nv_vec2_line_type_arrow_tail = vec2(\na_float_type,\narrow_tail_hide_part);\n}\nDistanceShiftParameters calculate_entrance_arrow_distances(\nconst ArrowLineViewParameters view,\nconst float signed_distance_shift,\nconst float arrow_final_size,\nconst float entrance_arrow_distance_shift)\n{\nDistanceShiftParameters line_distance_parameters = DistanceShiftParameters(\nsigned_distance_shift + entrance_arrow_distance_shift,\nfalse);\nif (a_float_type == g_type_arrow)\n{\nbool outside_of_current_segment = view.distance_to_end > view.segment_length + entrance_arrow_distance_shift;\nbool inside_end_hide = a_float_distance_from_start + entrance_arrow_distance_shift > erase_length_end();\nreturn DistanceShiftParameters(\nline_distance_parameters.shift + view.distance_to_end,\noutside_of_current_segment || inside_end_hide\n);\n}\nelse\n{\nreturn line_distance_parameters;\n}\n}\nvoid set_distance_varyings(\nconst ArrowLineViewParameters view,\nconst float arrow_final_size,\nconst float signed_shift_distance)\n{\nfloat entrance_arrow_distance_shift = arrow_final_size * (2. - g_line_overlapping_part);\nDistanceShiftParameters distance_shift_parameters = calculate_entrance_arrow_distances(\nview,\nsigned_shift_distance,\narrow_final_size,\nentrance_arrow_distance_shift);\nv_vec4_distance_vertex_hiding =\nvec4(\na_float_distance_from_start + distance_shift_parameters.shift,\n0.,\nerase_length_end(),\ndistance_shift_parameters.invisible\n? a_float_object_length\n: 0.\n) / a_float_object_length;\n}\nArrowLineViewParameters decode_arrow_line_view_parameters()\n{\nfloat width_zpt = u_float_width_zpt;\nfloat border_width_zpt = u_float_border_width_zpt;\nfloat arrow_segment_length_zpt = width_zpt * u_float_tip_height_multiplier + border_width_zpt;\nfloat vertex_type = a_float_type;\nvec2 segment_direction = (vertex_type == g_type_line_ending || vertex_type == g_type_line_cut)\n? normalize(a_vec2_vertex - a_vec2_segment_end)\n: normalize(a_vec2_segment_end - a_vec2_vertex);\nfloat segment_length = length(a_vec2_segment_end - a_vec2_vertex);\nfloat distance_to_end = erase_length_end() - a_float_distance_from_start;\nreturn ArrowLineViewParameters(\nvertex_type,\nwidth_zpt,\nborder_width_zpt,\nu_float_border_width_offset,\narrow_segment_length_zpt,\nu_float_wing_width_multiplier,\nu_float_size_factor,\na_vec2_vertex,\nunpack_widen(a_vec2_widen),\nunpack_widen(a_vec4_texture_widen_arrow_widen.xy),\nunpack_widen(a_vec4_texture_widen_arrow_widen.zw),\nsegment_direction,\nsegment_length,\ndistance_to_end);\n}\nvec4 process_arrow_line_vertex(const Scale scale, const mat4 mvp, const vec2 vpt_size)\n{\nArrowLineViewParameters view = decode_arrow_line_view_parameters();\nArrowParameters arrow_parameters = calculate_arrow_parameters(\nscale.calculation,\nview.width_zpt,\nview.border_width_zpt,\nview.arrow_segment_length_zpt,\nview.wing_width_multiplier,\nview.size_factor);\nvec2 vertex_widen = view.vertex_widen;\nvec2 texture_widen_with_sign = view.line_texture_widen;\nfloat shift_sign = sign(dot(vertex_widen, texture_widen_with_sign));\nvec2 line_texture_widen = shift_sign * texture_widen_with_sign;\nfloat line_final_size = (view.width_zpt + 2. * view.border_width_zpt) * view.size_factor * scale.calculation;\nfloat final_size = (view.vertex_type == g_type_arrow)\n? arrow_parameters.final_size\n: line_final_size;\nvec2 line_texture_widen_perp = perp(line_texture_widen);\nfloat shift_distance = abs(dot(vertex_widen, line_texture_widen_perp)) * final_size;\nvec2 shift_direction = line_texture_widen_perp * sign(dot(vertex_widen, line_texture_widen_perp));\nvec2 line_vertex_shift = vertex_widen * final_size - shift_direction * max(0., shift_distance - .5 * view.segment_length);\nvec2 arrow_vertex_widen = vertex_widen * arrow_parameters.final_size;\nvec2 scene_vertex_shift = (view.vertex_type == g_type_arrow)\n? arrow_vertex_widen\n: line_vertex_shift;\nvec2 arrow_position_shift = (view.vertex_type == g_type_arrow)\n? arrow_shift(view)\n: vec2(0.);\nfloat shift_pixels = g_shift_pixels * sqrt(2.);\nVertexShiftParameters line_shift_parameters = calculate_vertex_shift_parameters(\nmvp,\nvpt_size,\nview.vertex_position + (vertex_shift(scale) + arrow_position_shift),\nscene_vertex_shift,\nshift_pixels);\nfloat arrow_line_texcoord_scale = line_final_size / arrow_parameters.final_size;\nfloat line_texcoord_scale = (view.vertex_type != g_type_arrow)\n? arrow_line_texcoord_scale\n: 1.;\nvec2 line_texcoord = line_texture_widen * (1. + line_shift_parameters.limited_factor) * line_texcoord_scale;\nfloat arrow_texcoord_scale = (view.vertex_type == g_type_start_border)\n? arrow_line_texcoord_scale\n: 1.;\nvec2 arrow_texcoord = view.arrow_texture_widen * (1. + line_shift_parameters.limited_factor) * arrow_texcoord_scale;\nset_texcoord_varyings(arrow_texcoord, line_texcoord);\nfloat arrow_width = view.width_zpt * arrow_parameters.zpt_to_texcoord_factor;\nfloat arrow_length = view.arrow_segment_length_zpt * arrow_parameters.zpt_to_texcoord_factor;\nfloat texcoord_border_width = view.border_width_zpt * arrow_parameters.zpt_to_texcoord_factor;\nfloat border_width_texcoord_offset = view.border_width_offset * arrow_parameters.zpt_to_texcoord_factor;\nfloat arrow_border = max(0., texcoord_border_width - scale.style / scale.style_clamped * border_width_texcoord_offset);\nfloat tail_shift_direction = (view.vertex_type == g_type_line_ending || view.vertex_type == g_type_start_border) ? 1. : -1.;\nfloat tail_hide_shift = dot(arrow_vertex_widen, tail_shift_direction * view.segment_direction);\nfloat arrow_tail_hide_part = (view.distance_to_end - tail_hide_shift) * arrow_parameters.zpt_to_texcoord_factor / view.size_factor;\nset_arrow_varyings(\narrow_width,\narrow_length,\narrow_border,\narrow_parameters.outer_width,\narrow_tail_hide_part);\nset_distance_varyings(\nview,\narrow_parameters.final_size,\nshift_sign * shift_distance);\nreturn line_shift_parameters.clip_space_vertex / final_size;\n}\nvoid main()\n{\nv_vec4_identifier = a_vec4_identifier; \nScale scale = calculate_scale(u_vec3_projection_scale_style_scale_dpi, u_vec2_scale_limits);\nvec4 processed_vertex = process_arrow_line_vertex(scale, u_mat4_mvp, u_vec2_vpt_size);\ngl_Position = processed_vertex * g_w_factor;\nv_vec4_color = apply_opacity(u_vec4_color, u_float_opacity);\nv_vec4_border_color = apply_opacity(u_vec4_border_color, u_float_opacity);\n}\n",diffuse_identify:"uniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_height_limitation;\nuniform float u_float_tile_height;\nuniform float u_float_height_factor;\nattribute vec3 a_vec3_vertex;\nattribute vec4 a_vec4_identifier;\nattribute vec2 a_vec2_dem_position;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\nfloat height = dem_height(unpack_dem_position(a_vec2_dem_position));\nif (height == DEM_INVALID_VALUE) {\n        gl_Position = vec4(0, 0, 0, 0);\nreturn;\n    }\nv_vec4_identifier = a_vec4_identifier;\nif (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n{\nvec4 vertex_hf = apply_height_factor(a_vec3_vertex, u_float_height_factor);\nvertex_hf.z += height;\nvertex_hf = apply_z_limitation(vertex_hf, u_float_tile_height, u_float_height_limitation);\nvertex_hf.z = max(vertex_hf.z, height);\ngl_Position = round_position(\nu_mat4_mvp * vertex_hf,\n.5 * u_vec2_vpt_size);\n}\nelse\n{\ngl_Position = vec4(1., 1., 1., 1.);\n}\n}\n",calculate_scale:"struct Scale\n{\nfloat projection;\nfloat style;\nfloat style_clamped;\nfloat calculation;\n};\nScale calculate_scale(const vec3 projection_scale_style_scale_dpi, const vec2 scale_limits)\n{\nfloat style_scale_clamped = clamp(projection_scale_style_scale_dpi.y, scale_limits.x, scale_limits.y);\nfloat scale_ratio = projection_scale_style_scale_dpi.x / projection_scale_style_scale_dpi.y;\nfloat calculation_scale = style_scale_clamped * scale_ratio;\nreturn Scale(\nprojection_scale_style_scale_dpi.x,\nprojection_scale_style_scale_dpi.y,\nstyle_scale_clamped,\ncalculation_scale);\n}\nconst float g_min_scale_factor = 1e-2;\nconst float g_max_scale_factor = 1e2;\nconst float g_base_scale_numerator = 1e2;\nfloat normalize_scale_to_tile(const float scale, const float tile_size)\n{\nreturn clamp(\n    (scale - g_min_scale_factor) / (tile_size - g_min_scale_factor),\n    g_min_scale_factor,\n    g_max_scale_factor);\n}",line_width:"float calculate_final_width(\nconst Scale scale,\nconst float width,\nconst float width_offset)\n{\nfloat final_width = max(0., scale.calculation * width - scale.projection * width_offset);\nreturn final_width;\n}\n",arrow_functions:"\nvec2 multiply_complex(const vec2 lhs, const vec2 rhs)\n{\nreturn vec2(lhs.x * rhs.x - lhs.y * rhs.y, lhs.x * rhs.y + lhs.y * rhs.x);\n}\nstruct ArrowParameters\n{\nfloat zpt_to_texcoord_factor;\nfloat final_size;\nfloat outer_width;\nvec2 widen_size;\n};\nArrowParameters calculate_arrow_parameters(\nconst float calculation_scale,\nconst float width_zpt,\nconst float border_width_zpt,\nconst float segment_length_zpt,\nconst float wing_width_multiplier,\nconst float size_factor)\n{\nfloat quad_width = 2.0 * border_width_zpt + 2.0 * wing_width_multiplier * width_zpt;\nfloat quad_height = 2.0 * border_width_zpt + segment_length_zpt;\nfloat max_quad_dimension = max(quad_width, quad_height);\nfloat zpt_to_texcoord_factor = 2.0 / max_quad_dimension;\nfloat final_size = calculation_scale * size_factor * max_quad_dimension;\nvec2 widen_size = 0.5 * vec2(quad_height, quad_width) * zpt_to_texcoord_factor;\nfloat outer_width = (width_zpt * wing_width_multiplier + border_width_zpt) * zpt_to_texcoord_factor;\nreturn ArrowParameters(\nzpt_to_texcoord_factor,\nfinal_size,\nouter_width,\nwiden_size);\n}\nstruct VertexShiftParameters\n{\nvec4 clip_space_vertex;\nfloat limited_factor;\n};\nVertexShiftParameters calculate_vertex_shift_parameters(\nconst mat4 mvp,\nconst vec2 vpt_size,\nconst vec2 vertex,\nconst vec2 widen,\nconst float shift_pixels)\n{\nvec2 widen_perp = vec2(-widen.y, widen.x);\nvec4 clip_space_widen = mvp * vec4(widen, 0., 0.);\nvec4 clip_space_widen_perp = mvp * vec4(widen_perp, 0., 0.);\nvec2 half_viewport = vpt_size / 2.;\nvec4 clip_space_vertex = mvp * vec4(vertex, 0.0, 1.0) + clip_space_widen;\nfloat limited_factor = calculate_multiplication_factor(\nhalf_viewport,\nclip_space_widen,\nclip_space_widen_perp,\nclip_space_vertex,\nshift_pixels);\nreturn VertexShiftParameters(\nclip_space_vertex + clip_space_widen * limited_factor,\nlimited_factor);\n}\n",circle_marker:"attribute vec4 a_vec4_vertex;\nattribute vec2 a_vec2_widen;\nuniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_width;\nvarying vec2 v_vec2_circle;\nvarying float v_float_width;\nvoid main() {\n    vec4 clip_space_position = u_mat4_mvp * a_vec4_vertex;\n    vec4 ndc_position = clip_space_position / clip_space_position.w;\n    ndc_position.xy += a_vec2_widen * u_float_width / u_vec2_vpt_size;\n    gl_Position = ndc_position;\n    v_vec2_circle = a_vec2_widen;\n    v_float_width = u_float_width;\n}\n",circle_marker_identify:"attribute vec4 a_vec4_vertex;\nattribute vec2 a_vec2_widen;\nattribute vec4 a_vec4_identifier;\nuniform mat4 u_mat4_mvp;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_width;\nvarying vec2 v_vec2_circle;\nvarying vec4 v_vec4_identifier;\nvoid main() {\n    v_vec2_circle = a_vec2_widen;\n    v_vec4_identifier = a_vec4_identifier;\n    if (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n    {\n        vec4 clip_space_position = u_mat4_mvp * a_vec4_vertex;\n        vec4 ndc_position = clip_space_position / clip_space_position.w;\n        ndc_position.xy += a_vec2_widen * u_float_width / u_vec2_vpt_size;\n        gl_Position = ndc_position;\n    }\n    else\n    {\n        gl_Position = vec4(1., 1., 1., 1.);\n    }\n}\n",raster_functions:"\nfloat unpack_scale(float value)\n{\nreturn exp(abs(value) / 256.) * sign(value);\n}\nfloat unpack_positive_value(float value)\n{\nreturn exp(value / 256.);\n}\nvec2 make_position(const vec2 position, const float w, const vec2 inv_half_size, const float rounding_factor)\n{\nvec2 non_rounded_position = (position + w) / (w * inv_half_size);\nvec2 rounded_position = floor(non_rounded_position + 0.5);\nvec2 rounding_delta = rounded_position - non_rounded_position;\nvec2 pixel_coord = non_rounded_position + rounding_factor * rounding_delta - 0.5;\nreturn (pixel_coord * inv_half_size) * w - w;\n}\nvec2 overlay_transform(const vec2 position, const vec2 inv_half_size)\n{\nreturn position * inv_half_size;\n}\nfloat clipw(const float w, const vec2 range, const float scale)\n{\nreturn w * (step(unpack_scale(range.x), scale) - step(unpack_positive_value(range.y), scale));\n}\nvec2 rescale(const vec2 corner, const vec2 rescale, const vec2 scale_range, const float style_scale)\n{\nif (scale_range.x < 0.)\n{\nfloat default_scale_denominator = unpack_positive_value(rescale.x);\nfloat rescale_coeff = unpack_positive_value(rescale.y);\nfloat min_scale = unpack_positive_value(-scale_range.x);\nfloat stretch_exponent = floor(0.5 + log2(\nmax(1., 1. + rescale_coeff * (1. / max(min_scale, style_scale) - default_scale_denominator))));\nreturn corner.xy * exp2(stretch_exponent);\n}\nreturn corner;\n}\n",road:"attribute vec2 a_vec2_vertex;\nattribute vec4 a_vec4_normals;\nattribute vec2 a_vec2_shift;\nuniform mat4 u_mat4_mvp;\nuniform float u_float_width;\nuniform float u_float_tile_to_pixel_ratio;\nuniform float u_float_shift;\nvarying vec2 v_vec2_normal;\nvarying float v_float_half_width;\nconst float g_w_factor = 1e-6;\nconst float normal_unpack_multiplier = 0.011135539861205473;\nvoid main()\n{\n    \n    float half_width = 0.5 * (u_float_width + 1.0);\n    \n    vec4 normals = a_vec4_normals * normal_unpack_multiplier * half_width;\n    vec2 extender = normals.xy;\n    vec2 normal = normals.zw;\n    vec2 shift = a_vec2_shift * u_float_shift;\n    \n    vec4 shifted_vertex = vec4(a_vec2_vertex + (shift + extender) * u_float_tile_to_pixel_ratio, 0.0, 1.0);\n    gl_Position = g_w_factor * u_mat4_mvp * shifted_vertex;\n    v_vec2_normal = normal;\n    v_float_half_width = half_width;\n}\n",road_identify:"attribute vec2 a_vec2_vertex;\nattribute vec4 a_vec4_normals;\nattribute vec4 a_vec4_identifier;\nuniform mat4 u_mat4_mvp;\nuniform float u_float_width;\nuniform float u_float_tile_to_pixel_ratio;\nvarying vec2 v_vec2_normal;\nvarying vec4 v_vec4_identifier;\nvarying float v_float_half_width;\nconst float g_w_factor = 1e-6;\nconst float normal_unpack_multiplier = 0.011135539861205473;\nvoid main()\n{\n    \n    float half_width = 0.5 * (u_float_width + 1.0);\n    \n    vec4 normals = a_vec4_normals * normal_unpack_multiplier * half_width;\n    vec2 extender = normals.xy;\n    vec2 normal = normals.zw;\n    if (vec4(1., 1., 1., 1.) != a_vec4_identifier) {\n        \n        vec4 shifted_vertex = vec4(a_vec2_vertex + extender * u_float_tile_to_pixel_ratio, 0.0, 1.0);\n        gl_Position = g_w_factor * u_mat4_mvp * shifted_vertex;\n    } else {\n        gl_Position = vec4(1., 1., 1., 1.);\n    }\n    v_vec2_normal = normal;\n    v_vec4_identifier = a_vec4_identifier;\n    v_float_half_width = half_width;\n}\n",stretchable_image:"uniform mat4 u_mat4_mvp;\nuniform vec4 u_vec4_color;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_rounding_factor;\nattribute vec2 a_vec2_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\n  vec2 inv_half_size = 2.0 / u_vec2_vpt_size;\n  vec4 anchor = u_mat4_mvp * vec4(a_vec2_position, 0.0, 1.0);\n  vec2 pos_2d = anchor.xy + overlay_transform(a_vec2_offset, inv_half_size) * anchor.w;\nvec2 pos_2d_rounded = make_position(pos_2d, anchor.w, inv_half_size, u_float_rounding_factor);\n  gl_Position = vec4(pos_2d_rounded, anchor.z, anchor.w);\n  v_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}\n",stretchable_image_identify:"uniform mat4 u_mat4_mvp;\nuniform vec4 u_vec4_color;\nuniform vec2 u_vec2_vpt_size;\nuniform float u_float_rounding_factor;\nattribute vec2 a_vec2_position;\nattribute vec2 a_vec2_offset;\nattribute vec2 a_vec2_texcoord;\nattribute vec4 a_vec4_identifier;\nvarying vec2 v_vec2_texcoord;\nvarying vec4 v_vec4_identifier;\nvoid main()\n{\n  if (vec4(1., 1., 1., 1.) != a_vec4_identifier)\n  {\n    vec2 inv_half_size = 2.0 / u_vec2_vpt_size;\n    vec4 anchor = u_mat4_mvp * vec4(a_vec2_position, 0.0, 1.0);\n    vec2 pos_2d = anchor.xy + overlay_transform(a_vec2_offset, inv_half_size) * anchor.w;\n  vec2 pos_2d_rounded = make_position(pos_2d, anchor.w, inv_half_size, u_float_rounding_factor);\n    gl_Position = vec4(pos_2d_rounded, anchor.z, anchor.w);\n  }\n  else\n  {\n    gl_Position = vec4(1., 1., 1., 1.);\n  }\n  v_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n  v_vec4_identifier = a_vec4_identifier;\n}\n",rect:"uniform mat4 u_mat4_mvp;\nattribute vec2 a_vec2_vertex;\nvoid main()\n{\ngl_Position = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0);\n}\n",rect_with_texture:"uniform mat4 u_mat4_mvp;\nattribute vec2 a_vec2_vertex;\nattribute vec2 a_vec2_texcoord;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\ngl_Position = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0);\nv_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}\n",heatmap:"attribute vec2 a_vec2_position;\nattribute vec2 a_vec2_widen;\nattribute float a_float_weight;\nvarying vec2 v_vec2_extrude;\nvarying float v_float_weight;\nuniform mat4 u_mat4_mvp;\nuniform float u_float_radius;\nuniform float u_float_intensity;\nuniform float u_float_tile_to_pixel_ratio;\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n    float S = sqrt(-2.0 * log(ZERO / a_float_weight / u_float_intensity / GAUSS_COEF)) / 3.0;\n    v_vec2_extrude = S * a_vec2_widen;\n    v_float_weight = a_float_weight;\n    vec2 pos = a_vec2_position + a_vec2_widen * u_float_radius * u_float_tile_to_pixel_ratio;\n    gl_Position = u_mat4_mvp * vec4(pos, 0.0, 1.0);\n}",heatmap_texture:"attribute vec2 a_vec2_position;\nvarying vec2 v_vec2_position;\nvoid main() {\n    gl_Position = vec4(a_vec2_position, 0.0, 1.0);\n    v_vec2_position = clamp(a_vec2_position, vec2(0,0), vec2(1,1));\n}",dem_mesh:"uniform mat4 u_mat4_mvp;\nuniform mat4 u_mat4_flat_tex;\nattribute vec2 a_vec2_position;\nvarying vec3 v_vec3_texcoord;\nvarying float v_float_hillshade;\nvoid main()\n{\nvec4 coords = u_mat4_mvp * vec4(a_vec2_position, 0.0, 1.0);\nvec4 tex_pos = u_mat4_flat_tex * (coords / coords.w);\nfloat height = dem_height(a_vec2_position);\nif (height == DEM_INVALID_VALUE) {\ngl_Position = coords;\nv_vec3_texcoord = vec3(tex_pos.xy, 0);\nv_float_hillshade = 0.;\n} else {\ngl_Position = u_mat4_mvp * vec4(a_vec2_position, height, 1.0);\nv_vec3_texcoord = vec3(tex_pos.xy, 1);\nv_float_hillshade = dem_hillshade(a_vec2_position);\n}\n}",dem:"\nuniform sampler2D u_tex_dem;\nuniform float u_float_dem_resolution;\nuniform float u_float_dem_cell_size;\nuniform float u_float_dem_light_direction;\nuniform mat4 u_mat4_dem_mvp;\nuniform float u_float_dem_scale;\nuniform float u_float_map_center_elevation;\nconst float DEM_INVALID_VALUE = -9999.;\nconst float METERS_TO_MAP_POINTS = 107.17323258889581;\nconst float TILE_HEIGHT = 1048576.;\nconst float METERS_TO_TILE = METERS_TO_MAP_POINTS / TILE_HEIGHT;\nconst float M_PI = 3.1415926535897932384626433832795;\nconst float zenith = 45. * M_PI / 180.;\nfloat tex_step = 1. / u_float_dem_resolution;\nfloat dem_height(const vec2 coords) {\nif (u_float_dem_scale == 0.) {\nreturn 0.;\n}\nvec4 tex_pos = u_mat4_dem_mvp * vec4(coords, 0.0, 1.0);\nvec4 elevation = texture2D(u_tex_dem, tex_pos.xy);\nif (elevation.a == 0.) {\nreturn DEM_INVALID_VALUE;\n} else {\nreturn u_float_dem_scale * METERS_TO_TILE * (elevation.r - u_float_map_center_elevation);\n}\n}\nvec2 unpack_dem_position(const vec2 pos) {\nreturn (pos * 8.) / 65535.;\n}\nmat3 get_kernel(vec2 pos, float step, float defval) {\nmat3 kernel;\nfor (int x = 0; x < 3; x++) {\nvec3 col;\nfor (int y = 0; y < 3; y++) {\ncol[y] = texture2D(u_tex_dem, vec2(pos.x + float(x - 1) * step, pos.y + float(y - 1) * step)).r;\nif (col[y] == DEM_INVALID_VALUE) {\ncol[y] = defval;\n}\n}\nkernel[x] = col;\n}\nreturn kernel;\n}\nfloat calc_aspect(mat3 kernel) {\n    float dzdx = ((kernel[2].z + 2.0 * kernel[2].y + kernel[2].x) - (kernel[0].z + 2.0 * kernel[0].y + kernel[0].x)) / 8.;\n    float dzdy = ((kernel[0].x + 2.0 * kernel[1].x + kernel[2].x) - (kernel[0].z + 2.0 * kernel[1].z + kernel[2].z)) / 8.;\n    return atan(-dzdx, dzdy);\n}\nfloat calc_slope(mat3 kernel, float cell_size) {\n    float dzdx = ((kernel[2].z + 2. * kernel[2].y + kernel[2].x) - (kernel[0].z + 2. * kernel[0].y + kernel[0].x)) / (8. * cell_size);\n    float dzdy = ((kernel[0].x + 2. * kernel[1].x + kernel[2].x) - (kernel[0].z + 2. * kernel[1].z + kernel[2].z)) / (8. * cell_size);\n    float rise_run = sqrt(dzdx * dzdx + dzdy * dzdy);\n    return atan(rise_run);\n}\nfloat dem_hillshade(const vec2 coords)\n{\nif (u_float_dem_scale == 0.) {\nreturn 0.;\n}\nvec4 tex_pos = u_mat4_dem_mvp * vec4(coords, 0.0, 1.0);\nvec4 e = texture2D(u_tex_dem, tex_pos.xy);\nif (e.a == 0. || e.r == DEM_INVALID_VALUE) {\nreturn 0.;\n}\nmat3 kernel = get_kernel(tex_pos.xy, tex_step, e.r);\nfloat aspect = calc_aspect(kernel);\n    float slope = calc_slope(kernel, u_float_dem_cell_size);\nfloat azimuth = u_float_dem_light_direction;\nreturn (cos(zenith) * cos(slope)) + \n             (sin(zenith) * sin(slope) * cos(azimuth - aspect));\n}",dem_elevation:"uniform mat4 u_mat4_mvp;\nattribute vec2 a_vec2_vertex;\nattribute vec2 a_vec2_texcoord;\nvarying vec2 v_vec2_texcoord;\nvoid main()\n{\ngl_Position = u_mat4_mvp * vec4(a_vec2_vertex, 0.0, 1.0);\nv_vec2_texcoord = unpack_texcoord(a_vec2_texcoord);\n}"},xr={color:["apply_opacity","color"],diffuse:["dem","packed_attributes","apply_height_factor","apply_opacity","diffuse"],line:["dem","packed_attributes","apply_height_factor","apply_opacity","line"],pointSprite:["dem","packed_attributes","apply_height_factor","raster_functions","pointsprite"],labelPoint:["dem","packed_attributes","apply_height_factor","label_fixed_anchor"],labelPointIdentify:["dem","label_fixed_anchor_identify"],labelLine:["packed_attributes","label_directional"],stripedLine:["packed_attributes","pixel_offset","calculate_scale","line_width","apply_opacity","precision_constants","striped_line_functions","striped_line"],stripedLineIdentify:["packed_attributes","pixel_offset","calculate_scale","line_width","apply_opacity","precision_constants","striped_line_functions","striped_line_identify"],oneWayLine:["packed_attributes","pixel_offset","arrow_functions","apply_opacity","one_way_line"],colorIdentify:["round_position","color_identify"],modelIdentify:["dem","round_position","model_identify"],buildingIdentify:["dem","round_position","apply_height_factor","diffuse_identify"],pointSpriteIdentify:["dem","packed_attributes","apply_height_factor","raster_functions","pointsprite_identify"],model:["dem","packed_attributes","apply_height_factor","model"],simpleLine:["dem","packed_attributes","apply_height_factor","simple_line"],entranceArrow:["packed_attributes","pixel_offset","arrow_functions","calculate_scale","apply_opacity","arrow_line_entrance"],circleMarker:["circle_marker"],circleMarkerIdentify:["circle_marker_identify"],rect:["rect"],road:["road"],roadIdentify:["road_identify"],rectWithTexture:["packed_attributes","apply_opacity","raster_functions","rect_with_texture"],stretchableImage:["packed_attributes","raster_functions","stretchable_image"],stretchableImageIdentify:["packed_attributes","raster_functions","stretchable_image_identify"],heatmap:["heatmap"],heatmapTexture:["heatmap_texture"],demMesh:["dem","dem_mesh"],demElevation:["packed_attributes","dem_elevation"]},wr={color:["lowp_float","color"],line:["mediump_float","line"],pointSprite:["mediump_float","apply_opacity","pointsprite"],label:["mediump_float","apply_opacity","label"],stripedLine:["enable_standard_derivatives","mediump_float","affine_step","striped_line"],oneWayLine:["enable_standard_derivatives","mediump_float","affine_step","apply_opacity","arrow_functions","one_way_line"],colorIdentify:["lowp_float","color_identify"],pointSpriteIdentify:["mediump_float","pointsprite_identify"],model:["lowp_float","model"],simpleLine:["lowp_float","simple_line"],entranceArrow:["enable_standard_derivatives","highp_float","affine_step","arrow_functions","circle_functions","arrow_line"],entranceArrowIdentify:["lowp_float","arrow_line_identify"],circleMarker:["mediump_float","affine_step","circle_marker"],rect:["lowp_float","rect"],road:["enable_standard_derivatives","mediump_float","affine_step","road"],roadIdentify:["enable_standard_derivatives","lowp_float","road_identify"],stretchableImage:["mediump_float","stretchable_image"],rectWithTexture:["mediump_float","apply_opacity","rect_with_texture"],stretchableImageIdentify:["mediump_float","stretchable_image_identify"],heatmap:["mediump_float","heatmap"],heatmapTexture:["mediump_float","heatmap_texture"],demMesh:["highp_float","dem_mesh"],demElevation:["highp_float","dem_elevation"]},Ir={},Sr={};for(var Mr in xr){var Pr=xr[Mr].map((function(t){return br[t]}));Sr[Mr]=Pr}for(var Mr in wr)Pr=wr[Mr].map((function(t){return gr[t]})),Ir[Mr]=Pr;function Tr(t){return new Cn("vertex",Sr[t])}function kr(t){return new Cn("fragment",Ir[t])}var Lr=[{name:"u_tex_dem",type:"1i"},{name:"u_tex_hillshade_ramp",type:"1i"},{name:"u_mat4_dem_mvp",type:"mat4"},{name:"u_float_dem_scale",type:"1f"},{name:"u_float_dem_resolution",type:"1f"},{name:"u_float_dem_cell_size",type:"1f"},{name:"u_float_dem_light_direction",type:"1f"},{name:"u_float_dem_shade_intension",type:"1f"},{name:"u_float_map_center_elevation",type:"1f"}],zr=n(2241),Er=function(t,e){var n=e.renderer.getRenderingContext();return{drawSymbol:Ar,useProgram:function(i){var r=i[0].layerSettings,o=r.globalBinder,a=r.programName,s=e.renderer.getShaderProgram(a);s.enable(n),o(n,s,t,e)},useState:function(t){t[0].layerSettings.stateBinder(n)},useDemForDrawing:!1}},Cr=new Float32Array(Ae.Ue()),Ar=function(t,e,n,i,r){var o=i.renderer.getRenderingContext(),a=i.renderer.webGlExtensions,s=t[0],l=s.layerSettings,c=l.objectBinder,u=l.programName,d=i.renderer.getShaderProgram(u);c(o,d,n,i,s,e)&&(r&&tr(o,d,n,i,s),t.forEach((function(t){"buildingModel"===t.symbol?(Ae.dC(Cr,i.camera.viewProjectionMatrix,t.attributes.matrix),d.bind(o,{u_mat4_mvp:Cr})):"heatmap"===t.symbol&&"fill"===t.sink||d.bind(o,{u_mat4_mvp:t.tile.mvpMatrix}),r&&d.bind(o,{u_mat4_dem_mvp:t.tile.demMvpMatrix}),t.vao.bind({gl:o,extensions:a});var e=t.rangeStart/t.stride,s=(t.rangeEnd-t.rangeStart)/t.stride,l="buildingModel"===t.symbol&&"fill"===t.sink&&1===t.attributes.primitiveType?o.TRIANGLE_STRIP:o.TRIANGLES;o.drawArrays(l,e,s),n.collectStats&&!t.layerSettings.identify&&(n.stats.drawCount++,n.stats.vertexCount+=s)})))},Dr=n(6328),Rr=function(t,e,n,i){Xr(n,t).forEach((function(n){return Or(t,e,n,i)}))},Or=function(t,e,n,i){qr(e.styleManager,n,t).forEach((function(n){Hr(e.styleManager,n[0])?Fr(t,e,n,i):Br(t,e,n,i)}))},Fr=function(t,e,n,i){var r=Hr(e.styleManager,n[0]);if(r){var o=function(n,a){a>=r.orderBy.length?Br(t,e,n,i):Kr(r.orderBy[a],n,t).forEach((function(t,e){return o(t,e+1)}))};o(n,0)}},Br=function(t,e,n,i){var r=n[0];if((null==r?void 0:r.type)===yn.H.Custom)e.styleManager.callCustomLayerRender(r.attributes.layerId);else{var o=n;o.sort((function(t,e){return t.tile.zoomLevel-e.tile.zoomLevel})),Yr(e.styleManager,o,t).forEach((function(n){return jr(t,e,n,i)}))}},jr=function(t,e,n,i){Jr(n,t).forEach((function(n){return Zr(t,e,n,i)}))},Zr=function(t,e,n,i){Qr(n,t).forEach((function(n){return Ur(t,e,n,i)}))},Ur=function(t,e,n,i){i.useProgram(n),$r(n,t).forEach((function(n){Nr(t,e,n,i)}))},Nr=function(t,e,n,i){i.useState(n);var r=n[0],o=function(t,e){var n=t.getStyle(e.attributes.styleId);if(n){var i=n.layersById[e.attributes.layerId];return i&&i.type!==e.symbol&&(0,Dr.cM)("Expecting layer with type '".concat(e.symbol,"' but got '").concat(i.type,"'")),i}}(e.styleManager,r);o&&to(n,t).forEach((function(n){i.drawSymbol(n,o,t,e,i.useDemForDrawing)}))};function Hr(t,e){var n=t.getStyle(e.attributes.styleId);if(n){var i=n.layersById[e.attributes.layerId];if(i&&void 0!==i.groupId){var r=n.groupsById[i.groupId];if(!r||"group"===r.type)return r;(0,Dr.cM)("Expecting layer with type 'group' but got '".concat(r.type,"'"))}}}var Gr=function(t,e){return Number(t)-Number(e)},Vr=function(t){return function(e,n){for(var i={},r=0;r<e.length;r++){var o=e[r],a=t(o,n),s=i[a];void 0===s?i[a]=[o]:s.push(o)}var l=Object.keys(i);l.sort(Gr);var c=[];for(r=0;r<l.length;r++)c.push(i[l[r]]);return c}},Wr=function(t){return function(e,n){for(var i=new Map,r=0;r<e.length;r++){var o=e[r],a=t(o,n);i.has(a)?i.get(a).push(o):i.set(a,[o])}return i}},Xr=Vr((function(t){var e=t.attributes.styleId;return e===Q.jf?1:-e})),Yr=function(t,e,n){return Vr((function(e){return function(t,e,n){var i=t.getStyle(e);if(!i)return(0,Dr.cM)("Cannot get style with id=".concat(e," for renderIndex")),NaN;var r=i.layersById[n];return r?r.groupIndex||0:NaN}(t,e.attributes.styleId,e.attributes.layerId)}))(e,n)},qr=function(t,e,n){return Vr((function(e){return function(t,e,n){var i=t.getStyle(e);if(!i)return(0,Dr.cM)("Cannot get style with id=".concat(e," for renderIndex")),NaN;var r=i.layersById[n];return r?r.renderIndex:NaN}(t,e.attributes.styleId,e.attributes.layerId)}))(e,n)},Jr=Vr((function(t){return t.layerSettings.subRenderIndex||0})),Kr=function(t,e,n){return Vr((function(e,n){var i=(0,et.jJ)(n.styleZoom,n.styleState,e.attributes.tileData);return(0,et.vn)(t,i,0)}))(e,n)},Qr=Wr((function(t){return t.layerSettings.programName})),$r=Wr((function(t){return t.layerSettings.stateBinder})),to=Wr((function(t){return t.sink+"_"+t.attributesHash+"_"+t.tile.readiness})),eo=function(t){function e(e,n){var i=t.call(this,{canvas:n.layout.canvas,antialias:!1,stencil:!0,clearColor:(0,et.m2)((0,zr.MV)(e.defaultBackgroundColor)),preserveDrawingBuffer:e.preserveDrawingBuffer})||this;return i.framebuffers=[],i.lastRenderedFramebuffers=[],i.trackContextLost=function(t){t.preventDefault(),i.modules.map.destroy(),Dt({eventAction:"WebGlContext",eventLabel:"webglcontextlost"}),Dt({eventCategory:"WebGlContext",eventAction:"webglcontextlost",eventLabel:t.statusMessage||""})},i.state=e,i.modules=n,i.identifyBuffer=new ie,i.shaderPrograms={diffuse:new zn({vertex:Tr("diffuse"),fragment:kr("color"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec3_light_direction",type:"3fv"},{name:"u_vec3_light_color",type:"3fv"},{name:"u_vec3_ambient_color",type:"3fv"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_height_limitation",type:"1f"},{name:"u_float_tile_height",type:"1f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_opacity",type:"1f"}],Lr,!0),attributes:[{name:"a_vec3_vertex",location:0},{name:"a_vec3_normal",location:1},{name:"a_vec2_dem_position",location:2}]}),labelLine:new zn({vertex:Tr("labelLine"),fragment:kr("label"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_float_tile_to_pixel_ratio",type:"1f"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_buffer",type:"1f"},{name:"u_float_gamma",type:"1f"},{name:"u_float_scale",type:"1f"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_style_zoom",type:"1f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec4_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2},{name:"a_vec2_style_zoom_limits",location:3}]}),labelPoint:new zn({vertex:Tr("labelPoint"),fragment:kr("label"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2f"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_buffer",type:"1f"},{name:"u_float_gamma",type:"1f"},{name:"u_float_scale",type:"1f"},{name:"u_vec4_color",type:"4fv"},{name:"u_vec2_offset",type:"2f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_opacity",type:"1f"}],Lr,!0),attributes:[{name:"a_vec4_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2}]}),labelPointIdentify:new zn({vertex:Tr("labelPointIdentify"),fragment:kr("colorIdentify"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2f"},{name:"u_float_scale",type:"1f"},{name:"u_vec2_offset",type:"2f"}],Lr,!0),attributes:[{name:"a_vec4_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec4_identifier",location:2}]}),line:new zn({vertex:Tr("line"),fragment:kr("line"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec3_light_direction",type:"3fv"},{name:"u_vec3_light_color",type:"3fv"},{name:"u_vec3_ambient_color",type:"3fv"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_height_limitation",type:"1f"},{name:"u_float_tile_height",type:"1f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_opacity",type:"1f"}],Lr,!0),attributes:[{name:"a_vec4_vertex",location:0},{name:"a_vec2_normal",location:1},{name:"a_vec2_normal_delta",location:2},{name:"a_vec3_direction",location:3},{name:"a_float_distance",location:4},{name:"a_vec2_dem_position",location:5}]}),pointSprite:new zn({vertex:Tr("pointSprite"),fragment:kr("pointSprite"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_rounding_factor",type:"1f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_opacity",type:"1f"},{name:"u_vec2_rotation",type:"2fv"}],Lr,!0),attributes:[{name:"a_vec3_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2},{name:"a_vec2_range",location:3},{name:"a_vec2_rescale",location:4}]}),pointSpriteIdentify:new zn({vertex:Tr("pointSpriteIdentify"),fragment:kr("pointSpriteIdentify"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_height_factor",type:"1f"},{name:"u_vec2_rotation",type:"2fv"}],Lr,!0),attributes:[{name:"a_vec3_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2},{name:"a_vec2_range",location:3},{name:"a_vec2_rescale",location:4},{name:"a_vec4_identifier",location:5}]}),stripedLine:new zn({vertex:Tr("stripedLine"),fragment:kr("stripedLine"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_vec2_scaler_params",type:"2fv"},{name:"u_float_dash_length",type:"1f"},{name:"u_float_space_length",type:"1f"},{name:"u_float_dash2_length",type:"1f"},{name:"u_vec4_dash_color",type:"4fv"},{name:"u_vec4_space_color",type:"4fv"},{name:"u_vec4_border_color",type:"4fv"},{name:"u_float_width",type:"1f"},{name:"u_float_width_offset",type:"1f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_texture_widen",location:1},{name:"a_vec2_widen",location:2},{name:"a_float_vertex_distance",location:3},{name:"a_float_component_distance",location:4},{name:"a_float_object_length",location:5},{name:"a_vec4_identifier",location:6}]}),stripedLineIdentify:new zn({vertex:Tr("stripedLineIdentify"),fragment:kr("colorIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_vec2_scaler_params",type:"2fv"},{name:"u_float_dash_length",type:"1f"},{name:"u_float_space_length",type:"1f"},{name:"u_float_dash2_length",type:"1f"},{name:"u_vec4_dash_color",type:"4fv"},{name:"u_vec4_space_color",type:"4fv"},{name:"u_vec4_border_color",type:"4fv"},{name:"u_float_width",type:"1f"},{name:"u_float_width_offset",type:"1f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_texture_widen",location:1},{name:"a_vec2_widen",location:2},{name:"a_float_vertex_distance",location:3},{name:"a_float_component_distance",location:4},{name:"a_float_object_length",location:5},{name:"a_vec4_identifier",location:6}]}),vtxColor:new zn({vertex:Tr("color"),fragment:kr("color"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0}]}),vtxColorIdentify:new zn({vertex:Tr("colorIdentify"),fragment:kr("colorIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec4_identifier",location:1}]}),modelIdentify:new zn({vertex:Tr("modelIdentify"),fragment:kr("colorIdentify"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"}],Lr,!0),attributes:[{name:"a_vec3_vertex",location:0},{name:"a_vec4_identifier",location:1},{name:"a_vec2_dem_position",location:2}]}),buildingIdentify:new zn({vertex:Tr("buildingIdentify"),fragment:kr("colorIdentify"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_float_height_limitation",type:"1f"},{name:"u_float_tile_height",type:"1f"},{name:"u_float_height_factor",type:"1f"}],Lr,!0),attributes:[{name:"a_vec3_vertex",location:0},{name:"a_vec4_identifier",location:1},{name:"a_vec2_dem_position",location:2}]}),oneWayLine:new zn({vertex:Tr("oneWayLine"),fragment:kr("oneWayLine"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2f"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_vec4_color",type:"4f"},{name:"u_vec4_border_color",type:"4f"},{name:"u_vec2_wing_normal",type:"2f"},{name:"u_vec2_tip_normal",type:"2f"},{name:"u_float_width",type:"1f"},{name:"u_float_length",type:"1f"},{name:"u_float_border_width",type:"1f"},{name:"u_float_border_width_offset",type:"1f"},{name:"u_float_size_factor",type:"1f"},{name:"u_vec2_scale_limits",type:"2fv"},{name:"u_float_tip_height_multiplier",type:"1f"},{name:"u_float_wing_height_multiplier",type:"1f"},{name:"u_float_wing_width_multiplier",type:"1f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_position",location:0},{name:"a_vec2_direction",location:1},{name:"a_vec2_widen_direction",location:2}]}),model:new zn({vertex:Tr("model"),fragment:kr("model"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec4_color",type:"4fv"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_height_factor",type:"1f"}],Lr,!0),attributes:[{name:"a_vec3_vertex",location:0},{name:"a_vec2_texcoord",location:1},{name:"a_vec2_dem_position",location:2}]}),simpleLine:new zn({vertex:Tr("simpleLine"),fragment:kr("simpleLine"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_width",type:"1f"},{name:"u_float_height_factor",type:"1f"},{name:"u_float_height_limitation",type:"1f"},{name:"u_float_tile_height",type:"1f"},{name:"u_float_z_offset",type:"1f"}],Lr,!0),attributes:[{name:"a_vec3_vertex",location:0},{name:"a_vec4_direction_distance",location:1},{name:"a_vec2_dem_position",location:2}]}),road:new zn({vertex:Tr("road"),fragment:kr("road"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_width",type:"1f"},{name:"u_float_tile_to_pixel_ratio",type:"1f"},{name:"u_float_shift",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec4_normals",location:1},{name:"a_vec2_shift",location:2}]}),roadIdentify:new zn({vertex:Tr("roadIdentify"),fragment:kr("roadIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_float_width",type:"1f"},{name:"u_float_tile_to_pixel_ratio",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec4_normals",location:1},{name:"a_vec4_identifier",location:2}]}),entrance:new zn({vertex:Tr("entranceArrow"),fragment:kr("entranceArrow"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2f"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_vec2_scale_limits",type:"2fv"},{name:"u_vec4_color",type:"4f"},{name:"u_vec4_border_color",type:"4f"},{name:"u_vec2_wing_normal",type:"2f"},{name:"u_vec2_tip_normal",type:"2f"},{name:"u_float_width_zpt",type:"1f"},{name:"u_float_tip_height_multiplier",type:"1f"},{name:"u_float_wing_width_multiplier",type:"1f"},{name:"u_float_wing_height_multiplier",type:"1f"},{name:"u_float_border_width_zpt",type:"1f"},{name:"u_float_size_factor",type:"1f"},{name:"u_float_border_width_offset",type:"1f"},{name:"u_float_total_line_length",type:"1f"},{name:"u_float_relative_end_position",type:"1f"},{name:"u_float_vertex_shift",type:"1f"},{name:"u_float_tip_movement_amplitude",type:"1f"},{name:"u_vec2_bounce_direction",type:"2f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_segment_end",location:1},{name:"a_vec4_texture_widen_arrow_widen",location:2},{name:"a_vec2_widen",location:3},{name:"a_vec2_direction",location:4},{name:"a_float_distance_from_start",location:5},{name:"a_float_object_length",location:6},{name:"a_float_type",location:7},{name:"a_vec4_identifier",location:8}]}),entranceIdentify:new zn({vertex:Tr("entranceArrow"),fragment:kr("entranceArrowIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2f"},{name:"u_vec3_projection_scale_style_scale_dpi",type:"3fv"},{name:"u_vec2_scale_limits",type:"2fv"},{name:"u_vec4_color",type:"4f"},{name:"u_vec4_border_color",type:"4f"},{name:"u_vec2_wing_normal",type:"2f"},{name:"u_vec2_tip_normal",type:"2f"},{name:"u_float_width_zpt",type:"1f"},{name:"u_float_tip_height_multiplier",type:"1f"},{name:"u_float_wing_width_multiplier",type:"1f"},{name:"u_float_wing_height_multiplier",type:"1f"},{name:"u_float_border_width_zpt",type:"1f"},{name:"u_float_size_factor",type:"1f"},{name:"u_float_border_width_offset",type:"1f"},{name:"u_float_total_line_length",type:"1f"},{name:"u_float_relative_end_position",type:"1f"},{name:"u_float_vertex_shift",type:"1f"},{name:"u_float_tip_movement_amplitude",type:"1f"},{name:"u_vec2_bounce_direction",type:"2f"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_segment_end",location:1},{name:"a_vec4_texture_widen_arrow_widen",location:2},{name:"a_vec2_widen",location:3},{name:"a_vec2_direction",location:4},{name:"a_float_distance_from_start",location:5},{name:"a_float_object_length",location:6},{name:"a_float_type",location:7},{name:"a_vec4_identifier",location:8}]}),circleMarker:new zn({vertex:Tr("circleMarker"),fragment:kr("circleMarker"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_vec4_color",type:"4fv"},{name:"u_float_width",type:"1f"}],attributes:[{name:"a_vec4_vertex",location:0},{name:"a_vec2_widen",location:1}]}),rect:new zn({vertex:Tr("rect"),fragment:kr("rect"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec4_color",type:"4fv"}],attributes:[{name:"a_vec2_vertex",location:0}]}),rectWithTexture:new zn({vertex:Tr("rectWithTexture"),fragment:kr("rectWithTexture"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_texcoord",location:1}]}),circleMarkerIdentify:new zn({vertex:Tr("circleMarkerIdentify"),fragment:kr("colorIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_float_width",type:"1f"}],attributes:[{name:"a_vec4_vertex",location:0},{name:"a_vec2_widen",location:1},{name:"a_vec4_identifier",location:2}]}),stretchableImage:new zn({vertex:Tr("stretchableImage"),fragment:kr("stretchableImage"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_rounding_factor",type:"1f"}],attributes:[{name:"a_vec2_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2}]}),stretchableImageIdentify:new zn({vertex:Tr("stretchableImageIdentify"),fragment:kr("stretchableImageIdentify"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_vec2_vpt_size",type:"2fv"},{name:"u_sr2d_texture",type:"1i"},{name:"u_float_rounding_factor",type:"1f"}],attributes:[{name:"a_vec2_position",location:0},{name:"a_vec2_offset",location:1},{name:"a_vec2_texcoord",location:2},{name:"a_vec4_identifier",location:3}]}),heatmap:new zn({vertex:Tr("heatmap"),fragment:kr("heatmap"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_float_radius",type:"1f"},{name:"u_float_intensity",type:"1f"},{name:"u_float_tile_to_pixel_ratio",type:"1f"}],attributes:[{name:"a_vec2_position",location:0},{name:"a_vec2_widen",location:1},{name:"a_float_weight",location:2}]}),heatmapTexture:new zn({vertex:Tr("heatmapTexture"),fragment:kr("heatmapTexture"),uniforms:[{name:"u_sr2d_texture",type:"1i"},{name:"u_sr2d_ramp_texture",type:"1i"},{name:"u_float_opacity",type:"1f"}],attributes:[{name:"a_vec2_position",location:0}]}),demMesh:new zn({vertex:Tr("demMesh"),fragment:kr("demMesh"),uniforms:(0,B.ev)([{name:"u_mat4_mvp",type:"mat4"},{name:"u_mat4_flat_tex",type:"mat4"},{name:"u_flat_tex",type:"1i"}],Lr,!0),attributes:[{name:"a_vec2_position",location:0}]}),demElevation:new zn({vertex:Tr("demElevation"),fragment:kr("demElevation"),uniforms:[{name:"u_mat4_mvp",type:"mat4"},{name:"u_sr2d_texture",type:"1i"}],attributes:[{name:"a_vec2_vertex",location:0},{name:"a_vec2_texcoord",location:1}]})},n.map.once("idle",(function(){return function(t,e){if(window.requestIdleCallback){var n=function(n){var i=t[n];window.requestIdleCallback((function(){e.isContextLost()||(i.link(e),setTimeout((function(){window.requestIdleCallback((function(){}