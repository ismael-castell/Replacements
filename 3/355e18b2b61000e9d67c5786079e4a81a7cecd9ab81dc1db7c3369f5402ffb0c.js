(function(){var t={1579:function(t,e,a){"use strict";a.d(e,{Z:function(){return u}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post-card thumb-post-card"},[a("section",{staticClass:"post-card-wrap"},[a("router-link",{attrs:{to:{name:"post",params:{postId:t.id}},title:t.title,target:t.newTab}},[a("div",{staticClass:"post-card-content"},[t.loading?t._e():a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.thumb||t.defaultThumb,expression:"thumb || defaultThumb",arg:"background-image"}],staticClass:"cover",attrs:{"data-thumb":""}}),a("transition",{attrs:{name:"fade-fast"}},[t.loading?a("div",{staticClass:"placeholder"}):t._e()]),"undefined"!==typeof t.rankIndex?a("div",{staticClass:"rank",class:{first:0===t.rankIndex,second:1===t.rankIndex,third:2===t.rankIndex},domProps:{textContent:t._s(t.rankIndex+1)}}):t._e(),a("div",{staticClass:"flag"},[t.sticky?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"sticky"},[t._v("置顶")]):t._e(),t.recommend?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"recommend"},[t._v("推荐")]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"body"},[a("div",{staticClass:"title-wrap"},[a("div",{staticClass:"title",domProps:{innerHTML:t._s(t.highlightSearchkey(t.searchKey,t.title))}})]),a("div",{staticClass:"meta-wrap clearfix"},[a("router-link",{staticClass:"author meta-label float-left text-truncate",attrs:{to:{name:"user",params:{userId:t.authorId}},title:t.authorName},domProps:{textContent:t._s(t.authorName)}}),t.views>0?a("span",{staticClass:"view meta-label float-left"},[t._v(t._s(t.views)+"次围观")]):t._e(),a("v-time",{staticClass:"date float-right",attrs:{type:t.dateDisplay,date:t.date}})],1)])],1)])],1)])},i=[],r=a(2165),n=a(5146),o={name:"thumbPostCard",mixins:[r.z,n.j]},l=o,c=a(1001),d=(0,c.Z)(l,s,i,!1,null,null,null),u=d.exports},6425:function(t,e,a){"use strict";a.d(e,{Z:function(){return d}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"comboclick",rawName:"v-comboclick",value:t.options,expression:"options"}],staticClass:"xmas-hat",class:t.classNames})},i=[],r={bind(t,e){const a=parseInt(e.value.delay),s=e.value.reset,i=e.value.change;let r,n,o,l=0;t.addEventListener("click",(()=>{"undefined"!==typeof s&&!0!==s||(o&&clearTimeout(o),o=setTimeout((()=>{l=0,r=n=null,i&&i(0)}),a)),r=(new Date).getTime(),0===l||r-n<=a?(l++,i&&i(l),n=r):(l=1,i&&i(l),n=r)}),!1)}},n={name:"Hat",data(){return{classNames:{green:!1,rgb:!1},options:{delay:200,reset:!1,change:t=>{this.handleClick(t)}}}},directives:{comboclick:r},methods:{handleClick(t){t>0&&t%2===0&&(this.classNames.green=!this.classNames.green),t>0&&t%5===0&&(this.classNames.rgb=!this.classNames.rgb)}}},o=n,l=a(1001),c=(0,l.Z)(o,s,i,!1,null,"5fe3c89e",null),d=c.exports},8776:function(t,e,a){"use strict";a.d(e,{Z:function(){return Z}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("aside",{staticClass:"col-md-4 col-sm-12 order-sm-last",attrs:{id:"sidebar"}},[a("div",{staticClass:"auth-card sidebar-card"},[t.auth?a("div",{staticClass:"auth-info"},[a("div",{staticClass:"avatar-box",style:{backgroundImage:"url("+t.currentUser.banner+")"}},["christmas"===t.theme?a("Hat",{staticClass:"sidebar-avatar"}):t._e(),a("router-link",{attrs:{to:{name:"user",params:{userId:t.currentUser.id}}}},[a("img",{staticClass:"avatar",attrs:{src:t.currentUser.avatar,alt:t.currentUser.nickname}})]),t.currentUserRoles.length?a("span",{staticClass:"role",domProps:{textContent:t._s(t.roleLabel)}}):t._e()],1),a("div",{staticClass:"info-box"},[a("div",{staticClass:"name"},[a("router-link",{staticClass:"display-name",attrs:{to:{name:"user",params:{userId:t.currentUser.id}}}},[t._v(" "+t._s(t.currentUser.nickname)+" ")]),a("span",{staticClass:"label label-warning label-rounded"},[t._v("Lv."+t._s(t.currentUser.level))])],1),a("div",{staticClass:"description",attrs:{title:t.currentUser.description}},[t._v(" "+t._s(t.currentUser.description)+" ")])]),a("div",{staticClass:"post-box"},[a("ul",{staticClass:"count"},t._l(t.count,(function(e,s){return a("li",{key:s},[a("router-link",{attrs:{to:{name:e.pathName,params:{userId:t.currentUser.id}}}},[a("div",{staticClass:"name"},[t._v(t._s(e.label))]),a("div",{staticClass:"num"},[t._v(t._s(t.currentUser[e.key]||0))])])],1)})),0)]),a("div",{staticClass:"footer"},[a("ul",{staticClass:"operate"},[t.showManagePostBtn?a("li",[a("router-link",{staticClass:"primary operate-btn",attrs:{to:{name:"managePost"}}},[t._v("投稿管理")])],1):t._e(),t.showAuthorApplicateBtn?a("li",[a("a",{staticClass:"warning operate-btn",attrs:{href:t.authorApplicate.mailto}},[t._v("申请作者")])]):t._e(),t.currentUser.is_signed?t._e():a("li",[a("a",{staticClass:"warning operate-btn",class:{loading:t.signinLoading},attrs:{href:"javascript:;"},on:{click:t.signin}},[t._v("签到")])]),a("li",[a("a",{staticClass:"success operate-btn",attrs:{href:"javascript:;"},on:{click:t.logout}},[t._v("登出")])])])])]):a("div",{staticClass:"auth-links"},[a("div",{staticClass:"link-btn"},[a("router-link",{staticClass:"btn btn-primary btn-block",attrs:{to:{name:"login",params:{redirect:t.currentPath}}}},[t._v("登录")])],1),a("div",{staticClass:"link-btn"},[a("router-link",{staticClass:"btn btn-danger btn-block",attrs:{to:{name:"register",params:{redirect:t.currentPath}}}},[t._v("注册")])],1)])]),a("AdBox",{staticClass:"mb-4",attrs:{sets:t.ads.ad_side_first_game}}),t.isMobile?t._e():a("AdBox",{staticClass:"mb-4",attrs:{sets:t.ads.ad_side_second_game}}),!t.isMobile&&t.auth?a("RankPost",{class:{"r18-mask":!t.auth}}):t._e(),t.isMobile?t._e():a("AdBox",{staticClass:"mb-4",attrs:{sets:t.ads.ad_side_first_box}}),t.isMobile?t._e():a("HotPost"),t.isMobile?t._e():a("AdBox",{staticClass:"mb-4",attrs:{sets:t.ads.ad_side_second_box}}),!t.isMobile&&t.auth?a("LatestComment",{class:{"r18-mask":!t.auth}}):t._e(),t.isMobile?t._e():a("AdBox",{staticClass:"mb-4",attrs:{sets:t.ads.ad_side_third_box}}),t.isMobile?t._e():a("Link")],1)},i=[],r=a(4296),n=a(5146),o=a(7843),l=a(9878),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card sidebar-card sidebar-rank-post-card",class:{"theme-christmas-card":"christmas"===t.theme}},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"card-nav"},[a("nav",{staticClass:"nav nav-pills nav-fill"},[t._l(t.rank,(function(e,s){return a("a",{key:s,staticClass:"nav-item nav-link",class:{active:t.activeIndex===s},attrs:{href:"javascript:;"},on:{click:function(e){return t.setNav(s)}}},[t._v(t._s(e.label))])})),a("router-link",{staticClass:"nav-item nav-link",attrs:{to:{name:"rank"}}},[t._v("更多")])],2)]),a("transition-group",{staticClass:"post reset-ul-style",attrs:{name:"fade-fast",tag:"ul"}},t._l(t.post,(function(e,s){return a("li",{key:s},[a("div",{staticClass:"sidebar-rank-post-wrap"},[a("router-link",{attrs:{to:{name:"post",params:{postId:e.id}},target:t.newTab}},[a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.thumb||t.defaultThumb,expression:"item.thumb || defaultThumb",arg:"background-image"}],staticClass:"cover",attrs:{"data-thumb":""}}),a("div",{staticClass:"info"},[a("div",{staticClass:"rank-num",class:{first:0===s,second:1===s,third:2===s}},[t._v(" "+t._s(s+1)+" ")]),a("div",{staticClass:"title text-truncate"},[t._v(t._s(e.title))])])])],1)])})),0),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.empty?a("div",{staticClass:"empty text-center"},[t._v("暂无数据")]):t._e()],1)])},d=[];const u={computed:{theme(){return window.Config.options.theme}},methods:{loadCacheData(t,e){const a=this.$store.getters.getCache[this.cacheKey];void 0===a?e():t(a)}}};var m={name:"rankPost",mixins:[u],data(){return{rank:[{label:"日榜",value:"daily"},{label:"周榜",value:"weekly"},{label:"月榜",value:"monthly"}],activeIndex:0,post:[],loading:!1,empty:!1,pageSize:3}},computed:{cacheKey(){return"widgetRankPost_"+this.activeIndex},defaultThumb(){const t=this.$store.getters.getCache.defalutOption||{};return t.post_default_thumb||null}},methods:{setNav(t){this.activeIndex=t,this.getCache()},getData(){this.post=[],this.empty=!1,this.loading=!0;const t=this.activeIndex,e=this.rank[this.activeIndex].value;let a=0;"daily"===e?a=this.dayjs().dayOfYear():"weekly"===e?a=this.dayjs().week():"monthly"===e&&(a=this.dayjs().month()+1),(0,r.cr)({per_page:this.pageSize,year:this.dayjs().year(),date_type:e,date_value:a,simple:1}).then((e=>{const a=e.data;if(0===a.code){if(this.activeIndex!==t)return;this.post=a.data,this.$store.dispatch("setCache",{key:this.cacheKey,value:a.data})}this.empty=0===this.post.length,this.loading=!1})).catch((()=>{this.empty=!0,this.loading=!1}))},getCache(){this.loadCacheData((t=>{this.post=t,this.post.length||(this.empty=!0),this.activeIndex=Number(this.cacheKey.split("_")[1])}),(()=>{this.getData()}))}},created(){this.getCache()}},p=m,h=a(1001),g=(0,h.Z)(p,c,d,!1,null,"4f6dedf2",null),v=g.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card sidebar-card",class:{"theme-christmas-card":"christmas"===t.theme}},[a("div",{staticClass:"card-heading"},[t._v("热门主题")]),a("div",{staticClass:"card-body"},[a("ul",{staticClass:"post reset-ul-style"},t._l(t.post,(function(e,s){return a("li",{key:s},[a("router-link",{attrs:{to:{name:"post",params:{postId:e.id}},target:t.newTab}},[a("div",{staticClass:"title text-truncate",domProps:{textContent:t._s(e.title)}})])],1)})),0),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e()])])},b=[],y={name:"hotPost",mixins:[u],data(){return{post:[],loading:!1,pageSize:5,cacheKey:"widgetHotPost"}},methods:{getData(){this.loading=!0,(0,r.UI)({per_page:this.pageSize,order_by:"comment_count",order:"desc",start_at:this.dayjs().subtract(7,"day").format("YYYY-MM-DD"),simple:1,cache:1}).then((t=>{const e=t.data;0===e.code&&(this.post=e.data,this.$store.dispatch("setCache",{key:this.cacheKey,value:e.data})),this.loading=!1}))},getCache(){this.loadCacheData((t=>{this.post=t}),(()=>{this.getData()}))}},created(){this.getCache()}},_=y,C=(0,h.Z)(_,f,b,!1,null,"203149a7",null),w=C.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card sidebar-card",class:{"theme-christmas-card":"christmas"===t.theme}},[a("div",{staticClass:"card-heading"},[t._v("最新评论")]),a("div",{staticClass:"card-body"},[t.comment.length>0?a("ul",{staticClass:"comment reset-ul-style"},t._l(t.comment,(function(e,s){return a("li",{key:s,staticClass:"clearfix"},[a("div",{staticClass:"head float-left"},[e.user?a("router-link",{attrs:{to:{name:"user",params:{userId:e.user.id}}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.user.avatar,expression:"comment.user.avatar"}],staticClass:"avatar"})]):t._e()],1),a("div",{staticClass:"body"},[a("div",{staticClass:"auther-name"},[e.user?a("router-link",{attrs:{to:{name:"user",params:{userId:e.user.id}}},domProps:{textContent:t._s(e.user.nickname)}}):t._e()],1),a("div",{staticClass:"content"},[null!==e.post?a("router-link",{attrs:{to:{name:"post",params:{postId:e.post.id},hash:"#comment-"+e.id},target:t.newTab},domProps:{innerHTML:t._s(t.formatContent(e.content,!1))}}):t._e()],1),a("div",{staticClass:"source"},[a("span",{staticClass:"date"},[a("timeago",{attrs:{datetime:e.created_at,"auto-update":60}}),t._v(" @ ")],1),null!==e.post?a("router-link",{attrs:{to:{name:"post",params:{postId:e.post.id}},target:t.newTab},domProps:{textContent:t._s(e.post.title)}}):a("span",[t._v("主题不存在")])],1)])])})),0):t._e(),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e()])])},k=[],$=a(8145),P={name:"latestComment",mixins:[u,$.j],data(){return{comment:[],loading:!1,pageSize:5,cacheKey:"widgetLatestComment"}},methods:{getData(){this.loading=!0,(0,r.Rw)({per_page:this.pageSize,order_by:"created_at",with:["user","post"],include:"user,post:simple",cache:1}).then((t=>{const e=t.data;0===e.code&&(this.comment=e.data,this.$store.dispatch("setCache",{key:this.cacheKey,value:e.data})),this.loading=!1}))},getCache(){this.loadCacheData((t=>{this.comment=t}),(()=>{this.getData()}))}},created(){this.getCache()}},E=P,S=(0,h.Z)(E,x,k,!1,null,"04b2d092",null),I=S.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card sidebar-card",class:{"theme-christmas-card":"christmas"===t.theme}},[a("div",{staticClass:"card-heading"},[t._v("友情链接")]),a("div",{staticClass:"card-body"},[a("div",{staticClass:"tab-content"},[a("div",{staticClass:"tab-panel"},[a("ul",{staticClass:"link-list reset-ul-style"},[t._l(t.link,(function(e,s){return a("li",{directives:[{name:"show",rawName:"v-show",value:s+1<=t.hidden.max||!t.hidden.status,expression:"index + 1 <= hidden.max || !hidden.status"}],key:s,staticClass:"link"},[a("a",{attrs:{href:e.url,target:"_blank"},domProps:{textContent:t._s(e.name)}})])})),t.link.length>t.hidden.max?a("li",{staticClass:"nav-toggle",on:{click:t.toggleHidden}},[t.hidden.status?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"})]):t._e()],2),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e()])])])])},N=[],D={name:"linkComponent",mixins:[u],data(){return{link:[],hidden:{max:5,status:!0},loading:!1,cacheKey:"widgetLink"}},methods:{getData(){this.loading=!0,(0,r.lk)({all:1}).then((t=>{const e=t.data;0===e.code&&(this.link=e.data,this.$store.dispatch("setCache",{key:this.cacheKey,value:e.data})),this.loading=!1}))},toggleHidden(){this.hidden.status=!this.hidden.status},getCache(){this.loadCacheData((t=>{this.link=t}),(()=>{this.getData()}))}},created(){this.getCache()}},j=D,L=(0,h.Z)(j,A,N,!1,null,"2ab80e79",null),T=L.exports,z=a(6425),R={name:"sidebar",components:{RankPost:v,HotPost:w,LatestComment:I,Link:T,Hat:z.Z},mixins:[n.j,o.j,l.j],data(){return{signinLoading:!1,manageRoles:["author","editor","administrator","contributor"],authorApplicate:{roles:["contributor"],minPostCount:3,mailto:"mailto:admin@cangku.in?subject=%E7%BB%85%E5%A3%AB%E4%BB%93%E5%BA%93%E4%BD%9C%E8%80%85%E7%94%B3%E8%AF%B7&amp;body=%E7%BB%85%E5%A3%AB%E4%BB%93%E5%BA%93%E7%AB%99%E5%86%85%E6%98%B5%E7%A7%B0%EF%BC%9A%0A%0A%E7%BB%85%E5%A3%AB%E4%BB%93%E5%BA%93%E7%94%A8%E6%88%B7%20ID%EF%BC%9A%0A%0A%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F%EF%BC%9A%0A%0A%E5%85%B6%E5%AE%83%E4%BF%A1%E6%81%AF%EF%BC%9A"},count:[{label:"投稿",key:"post_count",pathName:"userPost"},{label:"吐槽",key:"comment_count",pathName:"userComment"},{label:"收藏",key:"favorite_post_count",pathName:"userFavorite"}]}},computed:{showManagePostBtn(){return!!this.hasRole(this.manageRoles,!1)},showAuthorApplicateBtn(){return!!(this.auth&&this.hasRole(this.authorApplicate,!1)&&this.currentUser.post_count>=this.authorApplicate.minPostCount)},currentPath(){return this.$route.path},roleLabel(){return this.currentUserRoles.map((t=>this.formatRole(t))).join(",")},isMobile(){return this.device.mobile()}},methods:{setSigned(){this.$store.dispatch("setUser",this._.assign(this._.cloneDeep(this.currentUser),{is_signed:!0}))},logout(){confirm("确定登出吗？")&&(0,r.kS)().then((t=>{0===t.data.code&&window.location.reload()}))},signin(){this.signinLoading=!0,(0,r.xJ)().then((t=>{if(0===t.data.code){const e=t.data.data;this.toast({message:(e.continuous_signin>1?"连续签到 "+e.continuous_signin+" 天":"签到成功")+`，经验+${e.exp}，积分+${e.point}`,type:"success"}),this.setSigned()}this.signinLoading=!1})).catch((()=>{this.signinLoading=!1,this.toast({message:"今日已经签到过了哟",type:"error"}),this.setSigned()}))}}},q=R,M=(0,h.Z)(q,s,i,!1,null,"367302f8",null),Z=M.exports},2165:function(t,e,a){"use strict";a.d(e,{z:function(){return r}});var s=a(5177),i=a.n(s);const r={props:{loading:{type:Boolean,default:!1},id:{type:[Number,String],default:0},thumb:{type:String,default:""},sticky:{type:Boolean,default:!1},recommend:{type:Boolean,default:!1},title:{type:String,default:""},authorId:{type:Number,default:0},authorName:{type:String,default:""},views:{type:[String,Number],default:0},date:{type:String,default:""},categories:{type:Array,default(){return[]}},rankIndex:{type:Number},searchKey:{type:String,default:""}},computed:{defaultThumb(){const t=this.$store.getters.getCache.defalutOption||{};return t.post_default_thumb||null}},methods:{highlightSearchkey(t,e){return e=i()(e),e.replace(t,""!==t?"<b>"+t+"</b>":"")}}}},5128:function(t,e){"use strict";e["Z"]=[{name:"新版泡泡",src:"new_paopao",type:!0,length:66},{name:"泡泡",src:"paopao",type:!0,length:33},{name:"QQ",src:"qq",type:!0,ext:"gif",length:92},{name:"aru",src:"aru",type:!0,length:122},{name:"颜文字",src:"yan",type:!1,length:["(=・ω・=)","(｀・ω・´)","(･∀･)","(°∀°)ﾉ","(<ゝω・)~☆","ε-(´∀｀; )","(*´艸`*)ﾉ","ヽ(〃∀〃)ﾉ","ヽ(；▽；)ノ","(*'▽'*)","(ฅ´ω`ฅ)","( ´_ゝ｀)","←_←","→_→","(ﾟДﾟ≡ﾟдﾟ)!?","Σ(ﾟдﾟ;)","눈_눈","(¬д¬。)","(๑•̀ㅂ•́)و✧","ฅ(๑˙o˙๑)ฅ","( •̀д•́)","(´；ω；`)","(^・ω・^ )","(｡･ω･｡)","(´･_･`)","(-_-#)","(..•˘_˘•..)","╮(๑•́ ₃•̀๑)╭","(๑¯ิε ¯ิ๑)","ԅ(¯﹃¯ԅ)","( ͡° ͜ʖ ͡°)","（￣へ￣）","ヽ(`Д´)ﾉ","(╯°口°)╯(┴—┴","（#-_-)┯━┯","_(:3」∠)_","((٩(//̀Д/́/)۶))","(｡ì _ í｡)","(σ‘・д・)σ","（#－.－）","＞△＜"]}]},8623:function(t,e){"use strict";e["Z"]=[{label:"百度网盘",key:"baidu",url:"https://pan.baidu.com/#bdlink=",prefix:"",home:"https://pan.baidu.com/disk/home"},{label:"阿里云盘",key:"ali",url:"https://www.aliyundrive.com/drive/#alink=",prefix:"aliyunpan://",home:"https://www.aliyundrive.com/drive"}]},6972:function(t,e){"use strict";e["Z"]={sex:[{label:"秘密",value:"secret"},{label:"男",value:"male"},{label:"女",value:"female"},{label:"伪娘",value:"otokonoko"},{label:"扶她",value:"futa"}],roles:[{value:"administrator",label:"管理员",type:"danger"},{value:"editor",label:"编辑",type:"danger"},{value:"author",label:"作者",type:"primary"},{value:"contributor",label:"成员",type:"info"}],preference:{post_display:[{label:"缩略图",value:"thumb"},{label:"全图",value:"full"}],date_display:[{label:"相对时间",value:"ago"},{label:"标准时间",value:"standard"}]},creditLog:{types:[{label:"签到",value:1},{label:"激活邮箱",value:2},{label:"奖励或惩罚",value:3},{label:"首次上传头像",value:4},{label:"首次上传空间背景",value:5},{label:"抽奖",value:6},{label:"红包",value:7},{label:"发表文章",value:100},{label:"发表评论",value:101},{label:"文章被推荐",value:102},{label:"使用兑换码",value:1001}]}}},1989:function(t,e,a){"use strict";var s=a(1357),i=a(5098),r=a(2809),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",attrs:{id:"home"}},[a("Sidebar"),a("div",{staticClass:"col-md-8 col-sm-12"},[a("Slider",{staticClass:"mb-4",attrs:{interval:5e3,speed:800,height:300,width:750,data:t.ads.ad_top_slider}}),t.announce?a("div",{staticClass:"alert alert-warning global-announce"},[a("span",{domProps:{innerHTML:t._s(t.announce)}})]):t._e(),"thumb"===t.postDisplay?a("AdBox",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"mb-4 ad-home",attrs:{sets:t.ads.ad_first_index}}):t._e(),a("div",{ref:"postWrapper",staticClass:"post-list"},[t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),"thumb"===t.postDisplay?a("transition-group",{staticClass:"row",attrs:{name:"fade-fast"}},t._l(t.thumbPostList.filter((function(e){return!t._.isEmpty(e.data)})),(function(e,s){return a("div",{key:s,staticClass:"post",class:{"col-sm-12":"ad"===e.type,"col-sm-12 col-md-6 col-lg-6":"post"===e.type}},["ad"===e.type?a("AdBox",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"mb-4 ad-home",attrs:{sets:e.data}}):t._e(),"post"===e.type?a("ThumbPostCard",{attrs:{id:e.data.id,thumb:e.data.thumb,sticky:e.data.is_sticky,recommend:e.data.is_recommended,title:e.data.title,"author-id":e.data.user.id,"author-name":e.data.user.nickname,views:e.data.view_count,date:e.data.created_at,loading:t.loading}}):t._e()],1)})),0):t._e(),"full"===t.postDisplay?a("transition-group",{staticClass:"row",attrs:{name:"fade-fast"}},t._l(t.post,(function(e,s){return a("div",{key:s,staticClass:"post col-sm-12"},[0===s?a("AdBox",{staticClass:"mb-4 ad-home",attrs:{sets:t.ads.ad_first_index}}):t._e(),1===s?a("AdBox",{staticClass:"mb-4 ad-home",attrs:{sets:t.ads.ad_second_index}}):t._e(),a("FullPostCard",{attrs:{id:e.id,thumb:e.thumb,sticky:e.is_sticky,recommend:e.is_recommended,title:e.title,"author-id":e.user.id,"author-name":e.user.nickname,views:e.view_count,date:e.created_at,categories:e.categories,loading:t.loading}})],1)})),0):t._e()],1),a("AdBox",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"mb-4 ad-home",attrs:{sets:t.ads.ad_third_index}}),a("el-pagination",{staticClass:"page-pagination",attrs:{background:"","hide-on-single-page":"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.displayPageSize,layout:"prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)],1)},o=[],l=a(4296),c=a(5146),d=a(9878),u={page:{pageSize:{default:9,home:{full:9,thumb:18},user:12,comment:20,other:12,manage:10,notification:12,rank:9},limit:{mobile:4,normal:9}}},m=a(8269);const p={data(){return{initLoading:!0,pagination:{total:0,currentPage:1,pageSize:u.page.pageSize["default"],limit:u.page.limit[m.Z.mobile()?"mobile":"normal"]}}},computed:{query(){const t={};for(const e of this.queryData)if("dateRange"===e.type){const a=this.getQueryValue(e.alias[0],e.params),s=this.getQueryValue(e.alias[1],e.params);a&&s&&this.dayjs(a).isValid()&&this.dayjs(s).isValid()&&(t[e.alias[0]]=this.dayjs(a).format("YYYY-MM-DD"),t[e.alias[1]]=this.dayjs(s).format("YYYY-MM-DD"))}else{const a=this.getQueryValue(e.alias,e.params);""!==a&&null!==a&&"undefined"!==typeof a&&(t[e.alias]=this.formatQueryType(a,e.type))}return t},instanceQuery(){const t={};for(const e of this.queryData)if("dateRange"===e.type){const a=this._.get(this,e.key);"undefined"===typeof e.default&&(e.default=""),this._.isArray(a)&&a[0]&&a[1]&&e.default[0]!==a[0]&&e.default[1]!==a[1]&&(t[e.alias[0]]=this.dayjs(a[0]).format("YYYY-MM-DD"),t[e.alias[1]]=this.dayjs(a[1]).format("YYYY-MM-DD"))}else{const a=this._.get(this,e.key);""!==a&&null!==a&&"undefined"!==typeof a&&e.default!==a&&(t[e.alias]=a)}return t}},watch:{query:{handler:function(t,e){if(!this._.isEqual(t,e)){for(const e of this.queryData)if("dateRange"===e.type){const a=t[e.alias[0]],s=t[e.alias[1]];a&&s?this._.set(this,e.key,[this.dayjs(a).toDate(),this.dayjs(s).toDate()]):this._.set(this,e.key,e.default||("array"===e.type?[]:""))}else{const a=t[e.alias];if(""!==a&&null!==a&&"undefined"!==typeof a)this._.set(this,e.key,this.formatQueryType(a,e.type));else{let t="";"array"===e.type?t=[]:"boolean"===e.type&&(t=!!this._.isBoolean(e.default)&&e.default),this._.set(this,e.key,e.default||t)}}this.initLoading?this.getData():this.initLoading=!0}},immediate:!0}},methods:{formatQueryType(t,e){return"number"===e?Number(t):"boolean"===e?(["false","0","null","undefined"].includes(t)&&(t=!1),Boolean(t)):"date"===e||"dateRange"===e?this.dayjs(t).format("YYYY-MM-DD"):"array"===e?this._.isString(t)?[t]:this._.cloneDeep(t):t},getQueryValue(t,e){return this.$route[e?"params":"query"][t]},handleSearch(){this.refreshChangePage(!0)},handleCurrentChange(t){this.pagination.currentPage=t,this.pushRouter(this.routerName)},handleSizeChange(t){this.pagination.pageSize=t,this.pushRouter(this.routerName)},refreshChangePage(t){t&&(this.pagination.currentPage=1),this._.isEqual(this.instanceQuery,this.query)?this.getData():this.pushRouter(this.routerName)},pushRouter(t){const e={},a=this._.cloneDeep(this.instanceQuery);for(const s of this.queryData)s.params&&"undefined"!==typeof a[s.key]&&(e[s.key]=a[s.key],delete a[s.key]);this.$router.push({name:t,query:a,params:e})}}};var h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.data.length?a("SliderContainer",{attrs:{animation:"fade",interval:t.interval,speed:t.speed,height:t.containerHeight+"px"}},t._l(t.data,(function(t,e){return a("SliderItem",{key:e},[a("a",{attrs:{href:t.url,target:"_blank"}},[a("img",{style:{width:"100%",display:"block",height:"100%"},attrs:{src:t.img}})])])})),1):t._e()},g=[],v=a(2851),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slider",style:{width:t.width,height:t.height}},[a(t.animation,{ref:"content",tag:"component",staticClass:"slider-content",style:{transition:"all "+t.thisSpeed+"s"},attrs:{speed:t.thisSpeed}},[t._t("default")],2),t.controlBtn?a("div",{staticClass:"slider-btn slider-left-btn",on:{click:function(e){return e.stopPropagation(),t.preview.apply(null,arguments)}}},[a("i",{staticClass:"slider-icon slider-icon-left"})]):t._e(),t.controlBtn?a("div",{staticClass:"slider-btn slider-right-btn",on:{click:function(e){return e.stopPropagation(),t.next.apply(null,arguments)}}},[a("i",{staticClass:"slider-icon slider-icon-right"})]):t._e(),!1!==t.indicators?a("div",{staticClass:"slider-indicators",class:t.indicatorClass,on:{click:function(t){t.stopPropagation()}}},t._l(t.childrenArr,(function(e,s){return a("i",{key:s,staticClass:"slider-indicator-icon",class:{"slider-indicator-active":t.posFlag===s},on:{click:function(e){return t.jump2(s)}}})})),0):t._e()],1)},b=[],y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._t("default")],2)},_=[],C={data(){return{width:"",childrenLen:0}},methods:{scaleWidth(t){const e=t*++this.childrenLen;this.width=t,this.$el.style.width=`${e}px`},animation(t,e,a){this.$el.style.transform=`translate3d( ${e*-this.width}px, 0, 0 )`,this.$el.style.webkitTransform=`translate3d( ${e*-this.width}px, 0, 0 )`}}},w=C,x=a(1001),k=(0,x.Z)(w,y,_,!1,null,null,null),$=k.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._t("default")],2)},E=[],S={data(){return{items:{}}},props:{speed:String},methods:{animation(t,e,a){const s=this.items.length;function i(t,e){this.items[t].style.opacity=0,this.items[e].style.opacity=1,setTimeout((()=>{this.items[t].style.zIndex=s,this.items[e].style.zIndex=s+1}),1e3*parseInt(this.speed))}"preview"===a?e===s-1?i.call(this,0,e):i.call(this,e+1,e):"jump"===a?(Array.prototype.forEach.call(this.items,((t,e)=>{t.style.opacity=0,setTimeout((()=>{t.style.zIndex=s}),1e3*parseInt(this.speed))})),this.items[e].style.opacity=1,setTimeout((()=>{this.items[e].style.zIndex=s+1}),1e3*parseInt(this.speed))):0===e?i.call(this,s-1,e):i.call(this,e-1,e)},init(){const t=this.items=this.$el.children,e=t.length;e&&(Array.prototype.forEach.call(t,((t,a)=>{t.style.position="absolute",t.style.left=0,t.style.top=0,t.style.zIndex=e-a,t.style.transition=`opacity ${this.speed}s`,t.style.opacity=0})),t[0].style.opacity=1)}},mounted(){this.init()}},I=S,A=(0,x.Z)(I,P,E,!1,null,null,null),N=A.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},j=[],L={},T=(0,x.Z)(L,D,j,!1,null,null,null),z=(T.exports,{data(){return{posFlag:0,childrenArr:[],timer:null}},props:{width:{type:String,default:"auto"},height:{type:String,default:"300px"},interval:{type:Number,default:3e3},speed:{type:Number,default:500},auto:{type:Boolean,default:!0},indicators:{default:"center"},controlBtn:{type:Boolean,default:!0},animation:{type:String,default:"normal"}},computed:{thisSpeed(){const t=this.speed/1e3;return t.toFixed(2)},indicatorClass(){return this.indicators?`slider-${this.indicators}`:""}},methods:{autoplay(){const t=this.$refs.content,e=this,a=this.posFlag;function s(){return setInterval((()=>{e.posFlag<t.$children.length-1?e.posFlag++:e.posFlag=0,t.animation(a,e.posFlag)}),e.interval)}return function(){this.timer?(clearInterval(this.timer),this.timer=s()):e.auto&&t.$children.length>1&&(this.timer=s())}},next(){const t=this.$refs.content,e=this.posFlag;this.posFlag<t.$children.length-1?++this.posFlag:this.posFlag=0,t.animation(e,this.posFlag),this.autoplay()},preview(){const t=this.$refs.content,e=this.posFlag;this.posFlag>0?--this.posFlag:this.posFlag=t.$children.length-1,t.animation(e,this.posFlag,"preview"),this.autoplay()},jump2(t){const e=this.$refs.content,a=this.posFlag;e.animation(a,t,"jump"),this.posFlag=t,this.autoplay()},addChildrenLength(){this.childrenArr.push(this.childrenArr.length)},scaleItemsWidth(t){t.style.width=`${this.$el.clientWidth}px`},newItem(t){const e=this.$refs.content;this.addChildrenLength(),this.scaleItemsWidth(t),e.scaleWidth&&e.scaleWidth(this.$el.clientWidth),e.init&&e.init(),this.autoplay()}},mounted(){this.autoplay=this.autoplay(),this.autoplay()},beforeDestroy(){clearInterval(this.timer)},components:{normal:$,fade:N}}),R=z,q=(0,x.Z)(R,f,b,!1,null,"8a7ba5a0",null),M=q.exports,Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slider-item"},[t._t("default")],2)},U=[],O={mounted(){const t=this.$parent;t.$parent.newItem(this.$el)}},B=O,F=(0,x.Z)(B,Z,U,!1,null,"ac959c6e",null),H=F.exports,Y={name:"Slider",props:{speed:{type:Number,default:500},interval:{type:Number,default:5e3},height:{type:Number,required:!0},width:{type:Number,required:!0},data:{type:Array,default(){return[]}}},components:{SliderContainer:M,SliderItem:H},data(){return{containerHeight:0}},watch:{data:{handler(){this.$nextTick((()=>{this.calHeight()}))},deep:!0}},methods:{calHeight:v.Z.throttle((function(){const t=this.$el.offsetWidth||0;this.containerHeight=t*this.height/this.width}),300)},mounted(){window.addEventListener("resize",this.calHeight)},beforeDestroy(){window.removeEventListener("resize",this.calHeight)}},K=Y,V=(0,x.Z)(K,h,g,!1,null,"e643de18",null),W=V.exports,G=a(8776),Q=a(1579),J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post-card full-post-card"},[a("section",{staticClass:"post-card-wrap"},[a("div",{staticClass:"post-card-content",class:{loading:t.loading}},[a("div",{staticClass:"body"},[a("div",{staticClass:"title-wrap"},[a("router-link",{staticClass:"title",attrs:{to:{name:"post",params:{postId:t.id}},target:t.newTab},domProps:{innerHTML:t._s(t.highlightSearchkey(t.searchKey,t.title))}})],1),t.recommend?a("div",{staticClass:"recommend"},[a("span",[t._v("推荐")])]):t._e(),t.sticky?a("div",{staticClass:"sticky"},[a("font-awesome-icon",{staticClass:"fa-icon",attrs:{icon:"bookmark"}})],1):t._e(),a("div",{staticClass:"meta-wrap clearfix"},[a("router-link",{staticClass:"meta-label",attrs:{to:{name:"user",params:{userId:t.authorId}}}},[a("span",{staticClass:"author",domProps:{textContent:t._s(t.authorName)}})]),t.categories.length?a("span",{staticClass:"meta-label"},t._l(t.categories,(function(e,s){return a("span",{key:s},[a("router-link",{staticClass:"category",attrs:{to:{name:"category",params:{categoryId:e.id}}},domProps:{textContent:t._s(e.name)}}),s!==t.categories.length-1?a("span",[t._v(" , ")]):t._e()],1)})),0):t._e(),a("v-time",{staticClass:"date meta-label",attrs:{type:t.dateDisplay,date:t.date}}),t.views>0?a("span",{staticClass:"view meta-label"},[t._v(t._s(t.views)+"次围观")]):t._e()],1)]),a("div",{staticClass:"cover"},[t.loading?t._e():a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.thumb||t.defaultThumb,expression:"thumb || defaultThumb"}]}),a("transition",{attrs:{name:"fade-fast"}},[t.loading?a("div",{staticClass:"placeholder"}):t._e()])],1)])])])},X=[],tt=a(2165),et={name:"fullPostCard",mixins:[tt.z,c.j]},at=et,st=(0,x.Z)(at,J,X,!1,null,null,null),it=st.exports,rt={name:"home",head:{title:{inner:window.Config.options.title}},mixins:[c.j,d.j,p],components:{Slider:W,Sidebar:G.Z,ThumbPostCard:Q.Z,FullPostCard:it},data(){return{post:[],init:!0,loading:!1,queryData:[{key:"pagination.currentPage",alias:"page",type:"number",default:1}],routerName:"home"}},computed:{isMobile(){return this.device.mobile()},displayPageSize(){return u.page.pageSize.home[this.postDisplay]},thumbPostList(){const t=this.post.map(((t,e)=>({type:"post",data:t})));return t.splice(this.isMobile?1:2,0,{type:"ad",data:this.ads.ad_second_index}),t},announce(){const t=this.$store.getters.getCache.defalutOption||{};return t.announce||""}},methods:{getData(){this.loading=!0;const t={page:this.pagination.currentPage,per_page:this.displayPageSize,with:["user","categories"],include:"user,categories:simple",simple:1};this.auth||(t.cache=1),(0,l.UI)(t).then((t=>{const e=t.data;0===e.code&&(this.post=e.data,this.pagination.total=e.meta.pagination.total,this.pagination.currentPage=e.meta.pagination.current_page),this.loading=!1,this.init&&(this.init=!1)}))}}},nt=rt,ot=(0,x.Z)(nt,n,o,!1,null,null,null),lt=ot.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user"}},[a("div",{staticClass:"user-page"},[t.user.is_banned?a("div",{staticClass:"banned-tip"},[t._v(" 该用户因违反网站相关规定，已被封禁 ")]):t._e(),a("div",{staticClass:"user-header"},[a("div",{staticClass:"user-header-info-wrap"},[a("transition",{attrs:{name:"fade-fast"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id>0,expression:"user.id > 0"}],staticClass:"user-header-info-body"},[a("div",{staticClass:"head-banner",style:{backgroundImage:"url("+t.user.banner+")"}}),a("div",{staticClass:"head-detail"},[a("div",{staticClass:"user-info text-center"},[a("div",{staticClass:"user-avatar"},["christmas"===t.theme?a("Hat"):t._e(),a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.user.avatar,expression:"user.avatar"}],staticClass:"avatar"})],1),a("div",{staticClass:"user-middle"},[a("span",{staticClass:"nickname"},[t._v(t._s(t.user.nickname))]),a("div",{staticClass:"level"},[a("span",{staticClass:"label label-warning label-rounded ml-2"},[t._v("Lv."+t._s(t.user.level))])])]),a("div",{staticClass:"user-description mx-auto"},[a("span",{domProps:{textContent:t._s(t.user.description)}})]),a("div",{staticClass:"user-meta"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.user.location,expression:"user.location"}],staticClass:"local",attrs:{title:"地址"}},[t._v(" "+t._s(t.user.location)+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.user.sex,expression:"user.sex"}],staticClass:"sex",attrs:{title:"性别"}},[t._v(" "+t._s(t.formatSex(t.user.sex).label)+" ")])])])])])])],1),a("div",{staticClass:"user-header-nav"},[a("div",{staticClass:"nav-wrap mx-auto"},[a("ul",{staticClass:"reset-ul-style"},[t._l(t.tabs,(function(e,s){return a("li",{key:s},[a("router-link",{attrs:{to:{name:e.pathName}}},[t._v(t._s(e.label))])],1)})),t.isMobile?t._e():a("li",{staticClass:"user-search-btn"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.toolbar.search,expression:"toolbar.search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索本作者的文章"},domProps:{value:t.toolbar.search},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchPost.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.toolbar,"search",e.target.value)}}})])],2)])])]),a("div",{staticClass:"user-panel"},[a("router-view",{attrs:{"user-id":t.userId}})],1)])])},dt=[],ut=a(7843),mt=a(6972),pt=a(6425),ht={name:"userIndex",head:{title(){return{inner:this.user.nickname||""}}},mixins:[ut.j,c.j],components:{Hat:pt.Z},data(){return{user:{},toolbar:{search:""},options:{sex:mt.Z.sex},tabs:[{label:"投稿",pathName:"userPost",auth:!1},{label:"回复",pathName:"userComment",auth:!1},{label:"收藏",pathName:"userFavorite",auth:!1}]}},computed:{userId(){return parseInt(this.$route.params.userId)},searchKey(){return this.$route.query.q},isMobile(){return this.device.mobile()},sexMap(){return this._.keyBy(this.options.sex,"value")}},watch:{userId(){this.getData()},searchKey:{handler:function(t){this.toolbar.search=t},immediate:!0}},methods:{getData(){this.getUser()},searchPost(){this.$router.push({name:"userPost",query:{q:this.toolbar.search}})},getUser(){const t={id:this.userId};(0,l.PR)(t).then((t=>{0===t.data.code&&(this.user=t.data.data,this.$emit("updateHead"))})).catch((t=>{404===t.response.status&&this.$router.push({name:"404Page"})}))},formatSex(t){return this.sexMap.hasOwnProperty(t)?this.sexMap[t]:{label:t}}},created(){this.getData()}},gt=ht,vt=(0,x.Z)(gt,ct,dt,!1,null,"2fdcb9ae",null),ft=vt.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user-post"}},[a("transition-group",{staticClass:"row",attrs:{name:"fade-fast"}},t._l(t.post,(function(e,s){return a("div",{key:s,staticClass:"post col-md-3 col-sm-6"},[a("SimplePostCard",{attrs:{id:e.id,thumb:e.thumb,recommend:e.is_recommended,title:e.title,views:e.view_count,date:e.created_at,loading:t.loading}})],1)})),0),t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.empty?a("div",{staticClass:"empty"},[t._v("这里空空如也~")]):t._e(),a("el-pagination",{staticClass:"page-pagination mb-0 mt-2",attrs:{background:"","hide-on-single-page":"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.pagination.pageSize,layout:"prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)},yt=[],_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post-card simple-post-card"},[a("section",{staticClass:"post-card-wrap"},[a("router-link",{attrs:{to:{name:"post",params:{postId:t.id}},title:t.title,target:t.newTab}},[a("div",{staticClass:"post-card-content"},[t.loading?t._e():a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.thumb||t.defaultThumb,expression:"thumb || defaultThumb",arg:"background-image"}],staticClass:"cover",attrs:{"data-thumb":""}}),a("transition",{attrs:{name:"fade-fast"}},[t.loading?a("div",{staticClass:"placeholder"}):t._e()])],1),a("div",{staticClass:"flag"},[t.recommend?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"recommend"},[t._v("推荐")]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"title text-truncate",domProps:{innerHTML:t._s(t.highlightSearchkey(t.searchKey,t.title))}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"status clearfix"},[t.views>0?a("span",{staticClass:"item view"},[t._v(t._s(t.views))]):t._e(),a("v-time",{staticClass:"item date float-right",attrs:{type:t.dateDisplay,date:t.date}})],1),t.loading?a("div",{staticClass:"placeholder-block"}):t._e()])],1)])},Ct=[],wt={name:"simplePostCard",mixins:[tt.z,c.j]},xt=wt,kt=(0,x.Z)(xt,_t,Ct,!1,null,null,null),$t=kt.exports;const Pt={mixins:[p],props:{userId:{type:Number,required:!0}},data(){return{init:!0,loading:!1,empty:!1,pagination:{pageSize:u.page.pageSize.user}}},watch:{userId(){this.getData()}}};var Et={name:"userPost",mixins:[Pt],components:{SimplePostCard:$t},data(){return{post:[],toolbar:{search:""},queryData:[{key:"toolbar.search",alias:"q"},{key:"pagination.currentPage",alias:"page",type:"number",default:1}],routerName:"userPost"}},methods:{getData(){this.empty&&(this.init=!0),this.empty=!1,this.loading=!0;const t={id:this.userId,page:this.pagination.currentPage,per_page:this.pagination.pageSize,simple:1};this.toolbar.search&&(t.search=this.toolbar.search),(0,l.O$)(t).then((t=>{const e=t.data;0===e.code&&(this.post=e.data,this.pagination.total=e.meta.pagination.total,this.pagination.currentPage=e.meta.pagination.current_page),this.empty=0===this.post.length,this.loading=!1,this.init&&(this.init=!1)}))}}},St=Et,It=(0,x.Z)(St,bt,yt,!1,null,"102f770c",null),At=It.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user-favorite"}},[a("transition-group",{staticClass:"row",attrs:{name:"fade-fast"}},t._l(t.post,(function(e){return a("div",{key:e.id,staticClass:"post col-md-3 col-sm-6"},[a("SimplePostCard",{attrs:{id:e.id,thumb:e.thumb,recommend:e.is_recommended,title:e.title,views:e.view_count,date:e.created_at,loading:t.loading}}),t.isCurrentUser?a("div",{staticClass:"delete",on:{click:function(a){return t.deleteFavorite(e.id)}}},[a("i",{staticClass:"el-icon-delete"})]):t._e()],1)})),0),t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.empty?a("div",{staticClass:"empty"},[t._v("这里空空如也~")]):t._e(),a("el-pagination",{staticClass:"page-pagination mb-0 mt-2",attrs:{background:"","hide-on-single-page":"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.pagination.pageSize,layout:"prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)},Dt=[],jt={name:"userFavorite",mixins:[Pt],components:{SimplePostCard:$t},data(){return{post:[],queryData:[{key:"pagination.currentPage",alias:"page",type:"number",default:1}],routerName:"userFavorite"}},computed:{isCurrentUser(){return this.$store.getters.getUser.id===this.userId}},methods:{deleteFavorite(t){confirm("是否确认删除该收藏？")&&(0,l.kU)({id:t}).then((t=>{0===t.data.code&&this.getData(!1)}))},getData(t=!0){this.empty&&(this.init=!0),this.empty=!1,t&&(this.loading=!0);const e={id:this.userId,page:this.pagination.currentPage,per_page:this.pagination.pageSize,simple:1};(0,l.Vd)(e).then((t=>{const e=t.data;0===e.code&&(this.post=e.data,this.pagination.total=e.meta.pagination.total,this.pagination.currentPage=e.meta.pagination.current_page),this.empty=0===this.post.length,this.loading=!1,this.init&&(this.init=!1)}))}}},Lt=jt,Tt=(0,x.Z)(Lt,Nt,Dt,!1,null,"f1a30172",null),zt=Tt.exports,Rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user-comment"}},[a("div",{staticClass:"comment-wrapper"},[a("transition-group",{staticClass:"comment-list",class:{loading:t.loading},attrs:{name:"fade-fast"}},t._l(t.comment,(function(e,s){return a("div",{key:s,staticClass:"comment-item"},[a("div",{staticClass:"content"},[a("router-link",{attrs:{to:{name:"post",params:{postId:e.post?e.post.id:null},hash:"#comment-"+e.id}},domProps:{innerHTML:t._s(t.formatContent(e.content))}})],1),a("div",{staticClass:"source"},[a("timeago",{staticClass:"date",attrs:{datetime:e.created_at,"auto-update":60}}),t._v(" 发布在 "),e.post?a("router-link",{attrs:{to:{name:"post",params:{postId:e.post.id}}}},[t._v(" "+t._s(e.post.title)+" ")]):a("span",[t._v("主题不存在")])],1)])})),0),t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.empty?a("div",{staticClass:"empty"},[t._v("这里空空如也~")]):t._e(),a("el-pagination",{staticClass:"page-pagination mb-0",attrs:{background:"","hide-on-single-page":"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.pagination.pageSize,layout:"prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)])},qt=[],Mt=a(8145),Zt={name:"userComment",mixins:[Pt,Mt.j],data(){return{comment:[],queryData:[{key:"pagination.currentPage",alias:"page",type:"number",default:1}],routerName:"userComment"}},methods:{getData(){this.empty=!1,this.loading=!0;const t={id:this.userId,page:this.pagination.currentPage,per_page:this.pagination.pageSize,with:["user","post"],include:"user, post:simple"};(0,l.Z4)(t).then((t=>{const e=t.data;0===e.code&&(this.comment=e.data,this.pagination.total=e.meta.pagination.total,this.pagination.currentPage=e.meta.pagination.current_page),this.empty=0===this.comment.length,this.loading=!1,this.init&&(this.init=!1)}))}}},Ut=Zt,Ot=(0,x.Z)(Ut,Rt,qt,!1,null,"0d506468",null),Bt=Ot.exports,Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",attrs:{id:"post"}},[t.isMobile?t._e():a("Sidebar"),t.isMobile&&!t._.isEmpty(t.ads.ad_mobile_top_post)?a("div",{staticClass:"col-sm-12 mb-3"},[a("AdBox",{attrs:{sets:t.ads.ad_mobile_top_post}})],1):t._e(),a("div",{staticClass:"col-md-8 col-sm-12"},[a("transition",{attrs:{name:"fade-fast"}},[t.post.arguement?a("div",{staticClass:"alert alert-warning arguement-warning"},[a("i",{staticClass:"el-icon-extend el-icon-extend-warning mr-2"}),a("span",{domProps:{innerHTML:t._s(t.post.arguement)}})]):t._e()]),a("div",{staticClass:"post-wrap"},[t.post.is_recommended?a("div",{staticClass:"recommend-flag"},[a("span",[t._v("推荐")])]):t._e(),t.post.is_sticky?a("div",{staticClass:"sticky-flag"},[a("font-awesome-icon",{staticClass:"fa-icon",attrs:{icon:"bookmark"}})],1):t._e(),a("AdBox",{staticClass:"mt-2 mb-3 post-top-mobile-ad",attrs:{sets:t.ads.ad_top_post}}),a("article",{staticClass:"article"},[a("transition",{attrs:{name:"fade"}},[t.authorized?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"header"},[t.post.id?a("div",{staticClass:"title"},[a("h1",[a("router-link",{attrs:{to:{name:"post",params:{postId:t.post.id}}}},[t._v(" "+t._s(t.post.title)+" ")])],1)]):t._e(),a("div",{staticClass:"meta"},[t.post.user?a("router-link",{attrs:{to:{name:"user",params:{userId:t.post.user.id}}},domProps:{textContent:t._s(t.post.user.nickname)}}):t._e(),t._l(t.post.categories,(function(e){return[a("router-link",{key:e.id,staticClass:"meta-label",attrs:{to:{name:"category",params:{categoryId:e.id}}},domProps:{textContent:t._s(e.name)}})]})),a("v-time",{attrs:{type:t.dateDisplay,date:t.post.created_at,title:t.formatDateTitle(t.post.created_at)}}),t.post.view_count>0?a("span",{domProps:{textContent:t._s(t.post.view_count+"次围观")}}):t._e(),t.auth?[a("a",{staticClass:"meta-label primary text-small",attrs:{href:"javascript:;"},on:{click:t.toggleFavoritePost}},[t._v(" "+t._s(t.post.favorited?"取消收藏":"收藏")+" "+t._s(t.post.favorite_count>0?" "+t.post.favorite_count:"")+" ")]),a("a",{staticClass:"meta-label text-small",class:[{rubberBand:t.vote.active},t.post.upvoted?"success":""],attrs:{href:"javascript:;",title:"点赞"},on:{click:t.toggleVotePost}},[a("font-awesome-icon",{attrs:{icon:"chevron-up"}}),a("span",{staticClass:"vote-count ml-1",domProps:{textContent:t._s(t.post.vote_count)}})],1),t.showEditBtn?a("a",{staticClass:"meta-label primary text-small",attrs:{href:"javascript:;"},on:{click:t.goEditPage}},[t._v(" 编辑文章 ")]):t._e()]:t._e()],2)]):t._e()]),a("transition",{attrs:{name:"fade"}},[t.authorized?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"content",staticClass:"content format-content",domProps:{innerHTML:t._s(t.post.content)}}):t._e()]),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.authorized?t._e():a("div",{staticClass:"alert alert-warning mt-3"},[a("h4",{staticClass:"alert-heading"},[t._v("内容未授权")]),a("p",[t._v("由于该内容未对您的账号授权，所以您暂时无法查看。")]),a("hr"),a("p",{staticClass:"mb-0"},[t._v("如有任何疑问，请联系管理员。")])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"tag-wrapper"},[a("ul",{staticClass:"tag-list clearfix"},t._l(t.post.tags,(function(e,s){return a("li",{key:s,staticClass:"float-left"},[a("router-link",{staticClass:"tag-label",attrs:{to:{name:"tag",params:{tagId:e.name}}},domProps:{textContent:t._s(e.name)}})],1)})),0)]),t.post.user.id?a("div",{staticClass:"author-right"},[a("p",[t._v(" 转载请先获得 "),a("router-link",{attrs:{to:{name:"user",params:{userId:t.post.user.id}}},domProps:{textContent:t._s(t.post.user.nickname)}}),t._v(" 同意，并注明出处、保留链接："),a("router-link",{attrs:{to:{name:"post",params:{postId:t.post.id}},title:t.baseUrl+"/archives/"+t.post.id},domProps:{textContent:t._s(t.baseUrl+"/archives/"+t.post.id)}})],1)]):t._e()],1),a("RelatedPost",{attrs:{data:t.relatedData}}),a("AdBox",{attrs:{sets:t.ads.ad_bottom_post}}),t.post.user?a("Comment",{attrs:{"post-id":t.id,"author-id":t.post.user.id,"is-author":t.isAuthor}}):t._e()],1)],1)},Ht=[],Yt=a(7446),Kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"comment"}},[a("div",{staticClass:"comment-form"},[t.auth?a("form",{staticClass:"form-wrap",class:{"inline-form-group-error":t.$v.reply.content.$error}},[a("div",{directives:[{name:"dragover",rawName:"v-dragover"}],staticClass:"textarea-wrapper"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reply.content,expression:"reply.content"}],ref:"reply",staticClass:"form-control",attrs:{type:"text",placeholder:"不说点什么吗？",rows:"5"},domProps:{value:t.reply.content},on:{paste:function(e){return t.handlePaste(e,!1)},drop:function(e){return e.preventDefault(),t.handleDrop(e,!1)},input:function(e){e.target.composing||t.$set(t.reply,"content",e.target.value)}}})]),a("div",{staticClass:"form-group-message"},[t.$v.reply.content.$dirty&&!t.$v.reply.content.required?a("span",{key:"required",staticClass:"message"},[t._v(" 评论不能为空 ")]):t._e(),t.$v.reply.content.$dirty&&!t.$v.reply.content.maxLength?a("span",{key:"maxLength",staticClass:"message"},[t._v(" 评论不能超过"+t._s(t.$v.reply.content.$params.maxLength.max)+"个字符 ")]):t._e()]),a("div",{staticClass:"comment-action clearfix"},[a("div",{staticClass:"emoji-action float-left"},[a("Emoji",{on:{setContent:function(e){return t.appendContent(!1,e)}}})],1),a("div",{staticClass:"submit-action float-right"},[a("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:t.reply.pending},on:{click:t.submitComment}},[t._v(" "+t._s(t.reply.pending?"发送中":"回复")+" ")])]),a("div",{staticClass:"comment-limit float-right",class:{error:t.reply.max<t.reply.content.length}},[t._v(" "+t._s(t.reply.max-t.reply.content.length)+" ")])])]):a("div",{staticClass:"auth-tip"},[t._v(" 请登录后再发表评论，"),a("router-link",{attrs:{to:{name:"login",params:{redirect:t.$route.fullPath}}}},[t._v("登录")]),t._v(" 或 "),a("router-link",{attrs:{to:{name:"register",params:{redirect:t.$route.fullPath}}}},[t._v("立即注册")])],1)]),t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),a("div",{staticClass:"comment-wrap"},[t.comment.length?a("div",{staticClass:"comment-panel"},[a("div",{staticClass:"comment-header"},[a("div",{staticClass:"comment-count"},[t._v(" "+t._s(t.pagination.total+" 条评论")+" ")]),a("ul",{staticClass:"tab-order clearfix"},t._l(t.tabs.options,(function(e){return a("li",{key:e.value,class:{active:t.tabs.value===e.value},on:{click:function(a){return t.switchOrder(e.value)}}},[t._v(" "+t._s(e.label)+" ")])})),0),t.pagination.totalPage>1&&!t.isMobile?a("div",{staticClass:"meta-pagination"},[a("span",{staticClass:"result",domProps:{textContent:t._s("共"+t.pagination.totalPage+"页")}}),a("el-pagination",{attrs:{small:"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.pagination.pageSize,layout:"prev, pager, next",total:t.pagination.total},on:{"current-change":function(e){return t.changePage(!1,e)},"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1):t._e()]),a("div",{staticClass:"comment-body",class:{"comment-loading":t.loading}},[a("ul",{staticClass:"comment-list reset-ul-style"},t._l(t.comment,(function(e,s){return a("li",{key:e.id,attrs:{id:"comment-"+e.id}},[a("div",{staticClass:"comment-item clearfix"},[a("div",{staticClass:"avatar-wrap float-left"},[e.user?a("router-link",{attrs:{to:{name:"user",params:{userId:e.user.id}}}},[a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.user.avatar,expression:"comment.user.avatar",arg:"background-image"}],staticClass:"lazy-avatar"})]):a("div",{staticClass:"no-user-avatar"})],1),a("div",{staticClass:"content-wrap"},[e.user?a("div",{staticClass:"comment-meta clearfix"},[a("router-link",{staticClass:"author",attrs:{to:{name:"user",params:{userId:e.user.id}}},domProps:{textContent:t._s(e.user.nickname)}}),a("span",{staticClass:"label label-warning label-rounded level"},[t._v("Lv."+t._s(e.user.level))]),""!==t.roleLabel(e.user.roles||t.userRoleList[e.user.id])?a("span",{staticClass:"role-mark",domProps:{textContent:t._s(t.roleLabel(e.user.roles||t.userRoleList[e.user.id]))}}):t._e(),e.user.id===t.authorId?a("span",{staticClass:"author-mark"},[t._v(" 作者 ")]):t._e(),e.is_sticky?a("span",{staticClass:"float-right badge sticky-mask"},[t._v(" 置顶 ")]):t._e()],1):a("div",{staticClass:"comment-meta"},[a("span",{staticClass:"no-user-head"},[t._v("该用户不存在")])]),a("div",{staticClass:"comment-content"},[a("div",{ref:"content",refInFor:!0,staticClass:"comment-text",domProps:{innerHTML:t._s(t.formatContent(e.content))}})]),a("div",{staticClass:"comment-operate"},[a("timeago",{attrs:{datetime:e.created_at,"auto-update":60,title:t.formatDateTitle(e.created_at)}}),a("a",{staticClass:"operate-btn",class:{active:t.upvotedList.includes(e.id)},attrs:{href:"javascript:;",disabled:t.upvotedLoadingList.includes(e.id)},on:{click:function(a){return t.voteComment(e,!0)}}},[a("i",{staticClass:"el-icon-extend el-icon-extend-thumbs-up"}),e.vote_count>0?a("span",{staticClass:"vote-num"},[t._v(" ("+t._s(e.vote_count)+") ")]):t._e()]),t.auth&&e.user?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.toggleSubComment(s)}}},[t._v(" 回复 ")]):t._e(),t.auth&&t.showDeleteBtn((e.user||{}).id)?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteComment(!1,s)}}},[t._v(" 删除 ")]):t._e(),t.isAuthor||t.hasPermission("edit_others_comments")?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(a){return t.stickyComment(e,e.is_sticky)}}},[t._v(" "+t._s(e.is_sticky?"取消置顶":"置顶")+" ")]):t._e(),t.auth&&(e.user||{}).id===t.currentUser.id?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(a){return t.notifyComment(e,e.is_notify)}}},[t._v(" "+t._s((e.is_notify?"取消":"开启")+"提醒")+" ")]):t._e(),t.auth?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(a){return t.openReportDialog(e.id)}}},[t._v(" 举报 ")]):t._e()],1),a("div",{staticClass:"comment-tags"},[e.is_author_voted?a("span",[t._v("作者觉得很赞")]):t._e()]),e.children.data.length?a("ul",{staticClass:"comment-list sub-comment-list reset-ul-style",class:{"comment-loading":e.loading}},[t._l(e.children.data,(function(i,r){return a("li",{key:i.id,attrs:{id:"comment-"+i.id}},[a("div",{staticClass:"comment-item clearfix"},[a("div",{staticClass:"avatar-wrap float-left"},[i.user?a("router-link",{attrs:{to:{name:"user",params:{userId:i.user.id}}}},[a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:i.user.avatar,expression:"childComment.user.avatar",arg:"background-image"}],staticClass:"lazy-avatar"})]):a("div",{staticClass:"no-user-avatar"})],1),a("div",{staticClass:"content-wrap"},[i.user?a("div",{staticClass:"comment-meta"},[a("router-link",{staticClass:"author",attrs:{to:{name:"user",params:{userId:i.user.id}}},domProps:{textContent:t._s(i.user.nickname)}}),a("span",{staticClass:"label label-warning label-rounded level"},[t._v(" Lv."+t._s(i.user.level)+" ")]),""!==t.roleLabel(i.user.roles||t.userRoleList[i.user.id])?a("span",{staticClass:"role-mark",domProps:{textContent:t._s(t.roleLabel(i.user.roles||t.userRoleList[i.user.id]))}}):t._e(),i.user.id===t.authorId?a("span",{staticClass:"author-mark"},[t._v(" 作者 ")]):t._e(),i.reply_to_meta&&i.reply_to_meta.user?a("span",{staticClass:"comment-at"},[t._v(" 回复 "),a("router-link",{staticClass:"author",attrs:{to:{name:"user",params:{userId:i.reply_to_meta.user.id}}},domProps:{textContent:t._s("@"+i.reply_to_meta.user.nickname)}})],1):t._e()],1):a("div",{staticClass:"comment-meta"},[a("span",{staticClass:"no-user-head"},[t._v("该用户不存在")])]),a("div",{staticClass:"comment-content"},[a("div",{ref:"content",refInFor:!0,staticClass:"comment-text",domProps:{innerHTML:t._s(t.formatContent(i.content))}})]),a("div",{staticClass:"comment-operate"},[a("timeago",{attrs:{datetime:i.created_at,"auto-update":60,title:t.formatDateTitle(i.created_at)}}),a("a",{staticClass:"operate-btn",class:{active:t.upvotedList.includes(i.id)},attrs:{href:"javascript:;",disabled:t.upvotedLoadingList.includes(i.id)},on:{click:function(e){return t.voteComment(i)}}},[a("i",{staticClass:"el-icon-extend el-icon-extend-thumbs-up"}),i.vote_count>0?a("span",{staticClass:"vote-num"},[t._v(" ("+t._s(i.vote_count)+") ")]):t._e()]),t.auth&&e.user?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.toggleSubComment(s,r)}}},[t._v(" 回复 ")]):t._e(),t.auth&&t.showDeleteBtn((i.user||{}).id)?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteComment(!0,s,r)}}},[t._v(" 删除 ")]):t._e(),t.auth&&(i.user||{}).id===t.currentUser.id?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.notifyComment(i,i.is_notify)}}},[t._v(" "+t._s((i.is_notify?"取消":"开启")+"提醒")+" ")]):t._e(),t.auth?a("a",{staticClass:"operate-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.openReportDialog(i.id)}}},[t._v(" 举报 ")]):t._e()],1)])])])})),a("li",[a("el-pagination",{staticClass:"page-pagination mt-2 mb-0",attrs:{"hide-on-single-page":"","current-page":e.children.meta.pagination.current_page,"pager-count":t.pagination.limit,"page-size":t.subReply.pageSize,layout:"prev, pager, next",total:e.children.meta.pagination.total},on:{"current-change":function(e){return t.changePage(!0,e,s)},"update:currentPage":function(a){return t.$set(e.children.meta.pagination,"current_page",a)},"update:current-page":function(a){return t.$set(e.children.meta.pagination,"current_page",a)}}})],1)],2):t._e()]),t.subReply.index===s?a("div",{directives:[{name:"show",rawName:"v-show",value:t.subReply.active,expression:"subReply.active"}],staticClass:"comment-form sub-comment-form"},[a("form",{staticClass:"form-wrap",class:{"inline-form-group-error":t.$v.subReply.content.$error}},[a("div",{directives:[{name:"dragover",rawName:"v-dragover"}],staticClass:"textarea-wrapper"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.subReply.content,expression:"subReply.content"}],ref:"subReply",refInFor:!0,staticClass:"form-control",attrs:{type:"text",rows:"4",placeholder:t.subReply.placeholder},domProps:{value:t.subReply.content},on:{paste:function(e){return t.handlePaste(e,!0)},drop:function(e){return e.preventDefault(),t.handleDrop(e,!0)},input:function(e){e.target.composing||t.$set(t.subReply,"content",e.target.value)}}})]),a("div",{staticClass:"form-group-message"},[t.$v.subReply.content.$dirty&&!t.$v.subReply.content.required?a("span",{staticClass:"message"},[t._v("评论不能为空")]):t._e(),t.$v.subReply.content.$dirty&&!t.$v.subReply.content.maxLength?a("span",{staticClass:"message"},[t._v("评论不能超过"+t._s(t.$v.subReply.content.$params.maxLength.max)+"个字符")]):t._e()]),a("div",{staticClass:"comment-action clearfix"},[a("div",{staticClass:"emoji-action float-left"},[a("Emoji",{on:{setContent:function(e){return t.appendContent(!0,e)}}})],1),a("div",{staticClass:"submit-action float-right"},[a("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:t.subReply.pending},on:{click:function(e){return t.submitSubComment(s)}}},[t._v(" "+t._s(t.subReply.pending?"发送中":"回复")+" ")])]),a("div",{staticClass:"comment-limit float-right",class:{error:t.subReply.max<t.subReply.content.length}},[t._v(" "+t._s(t.subReply.max-t.subReply.content.length)+" ")])])])]):t._e()])])})),0)])]):t._e(),t.empty?a("div",{staticClass:"empty"},[t._v("暂无评论，沙发等你来抢~")]):t._e(),a("div",{staticClass:"comment-footer"},[a("el-pagination",{staticClass:"page-pagination",attrs:{background:"","hide-on-single-page":"","current-page":t.pagination.currentPage,"pager-count":t.pagination.limit,"page-size":t.pagination.pageSize,layout:"prev, pager, next",total:t.pagination.total},on:{"current-change":function(e){return t.changePage(!1,e)},"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)]),a("ReportDialog",{ref:"reportDialog",attrs:{data:t.dialog.report.data,visible:t.dialog.report.visible},on:{"update:visible":function(e){return t.$set(t.dialog.report,"visible",e)},success:t.handleReport}}),a("UploadImage",{ref:"uploadImage",attrs:{request:t.uploadImage,"max-size":1024},on:{success:t.handleInsertImage}})],1)},Vt=[],Wt=a(7063),Gt=a(6409),Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"on-click-outside",rawName:"v-on-click-outside",value:t.closeModel,expression:"closeModel"}],staticClass:"emoji-container"},[a("button",{staticClass:"btn emoji-btn",class:{active:t.active},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleModel.apply(null,arguments)}}},[t._v(" 表情 ")]),a("div",{staticClass:"emoji-inner-wrapper"},[a("transition",{attrs:{name:"fade-fast"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"emoji-inner",on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[a("ul",{staticClass:"emoji-nav"},t._l(t.groups,(function(e){return a("li",{key:e.src,class:{active:t.nav.current===e.src},domProps:{textContent:t._s(e.name)},on:{click:function(a){return t.setNav(e.src)}}})})),0),a("div",{staticClass:"emoji-content"},t._l(t.filterGroups,(function(e){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.nav.current===e.src,expression:"nav.current === item.src"}],key:e.src,staticClass:"emoji-list"},t._l(e.length,(function(s,i){return a("a",{key:i,staticClass:"emoji-item",class:{yan:!e.type},attrs:{href:"javascript:;"},on:{click:function(a){return t.select(e.type,e.src,i)}}},[e.type?a("img",{staticClass:"emoji",attrs:{src:t.completeUrl(e.src,e.ext,i)}}):a("span",{domProps:{textContent:t._s(s)}})])})),0)})),0)])])],1)])},Jt=[],Xt=a(5128),te={name:"emoji",props:{target:{type:String,default:""}},data(){return{path:window.Config.cdnDomain+"/images/stickers/",active:!1,groups:Xt.Z,nav:{current:null,activated:[]}}},computed:{filterGroups(){return this.groups.filter((t=>this.nav.activated.includes(t.src)))}},methods:{setNav(t){this.nav.current=t,this.nav.activated.includes(t)||this.nav.activated.push(t)},select(t,e,a){let s="";s=t?"["+e+":"+(a+1)+"]":this.groups.find((t=>t.src===e)).length[a],this.$emit("setContent",s),this.closeModel()},openModel(){this.active=!0},closeModel(){this.active=!1},toggleModel(){!this.nav.current&&Xt.Z.length&&this.setNav(Xt.Z[0].src),this.active=!this.active},completeUrl(t,e,a){return this.path+t+"/"+(a+1)+"."+(e||"png")}}},ee=te,ae=(0,x.Z)(ee,Qt,Jt,!1,null,"72ac81ae",null),se=ae.exports,ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("input",{staticClass:"hide",attrs:{type:"file",accept:"image/*"},on:{change:t.uploadImage}})},re=[],ne={name:"uploadImage",props:{request:Function,requestBody:{type:Object,default(){return{}}},maxSize:{type:Number,default:1024},params:{type:Object,default(){return{}}}},data(){return{supportedTypes:["image/jpg","image/jpeg","image/png","image/gif","image/webp"]}},methods:{handleClick(){this.$el.click()},dropImage(t){this.handleUpload(t)},uploadImage(t){const e=t.target.files[0];this.handleUpload(e)},handleUpload(t){if(t)if(-1===this.supportedTypes.indexOf(t.type))this.toast({message:"不支持的文件类型",type:"error"});else if(t.size>1024*this.maxSize)this.toast({message:"图片大小不得超过"+this.maxSize/1024+"MB",type:"error"});else{const e=new FormData;e.append("image",t);for(const t in this.params)e.append(t,this.params[t]);this.request(e,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{0===t.data.code&&this.$emit("success",t.data.data)})).catch((t=>{if(t.response){const e=(t.response.data||{}).message;e&&this.toast({message:e,type:"error"})}}))}}}},oe=ne,le=(0,x.Z)(oe,ie,re,!1,null,"25eaf821",null),ce=le.exports,de=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,visible:t.visible,width:"600px","custom-class":"custom-dialog","append-to-body":""},on:{close:t.closeDialog,closed:t.resetForm}},[a("el-form",{ref:t.form.ref,staticClass:"custom-form",attrs:{model:t.form.data,rules:t.form.rules,"label-position":t.form.config.labelPosition}},[a("el-form-item",{staticClass:"mb-3",attrs:{label:"选择理由",prop:"type"}},t._l(t.form.options.type,(function(e){return a("el-radio",{key:e.value,attrs:{label:e.value},model:{value:t.form.data.type,callback:function(e){t.$set(t.form.data,"type",e)},expression:"form.data.type"}},[t._v(t._s(e.label))])})),1),t.currentType.custom?a("el-form-item",{attrs:{prop:"reason"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请在这里说明理由，以便帮助审核人员更快处理",rows:4},model:{value:t.form.data.reason,callback:function(e){t.$set(t.form.data,"reason",e)},expression:"form.data.reason"}})],1):t._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.closeDialog}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitForm}},[t._v("确定")])],1)],1)},ue=[],me=[{label:"不受欢迎的垃圾内容",value:1},{label:"刻意的人身攻击",value:2},{label:"色情或暴力内容",value:3},{label:"政治敏感内容",value:4},{label:"其他",value:0,custom:!0}];const pe={id:"",type:"",reason:""};var he={name:"reportDialog",props:{visible:{type:Boolean,default:!1},data:{type:Object,default(){return{}}}},watch:{visible(t){t&&this.$nextTick((function(){this.form.data=this._.assign({},pe,this.data)}))}},data(){return{title:"请选择举报理由",form:{ref:"updateForm",data:this._.cloneDeep(pe),config:{labelPosition:"top"},options:{type:me},rules:{type:[{required:!0,message:"请选择理由",trigger:"change"}],reason:[{required:!0,message:"请完善举报内容",trigger:"blur"},{max:2e4,message:"长度不可超过 20000 个字符",trigger:"blur"}]}}}},computed:{currentType(){return this.form.options.type.find((t=>t.value===this.form.data.type))||{}}},methods:{closeDialog(){this.$emit("update:visible",!1)},submitForm(){this.$refs[this.form.ref].validate((t=>{t&&this.$emit("success",this.form.data)}))},resetForm(){this.$refs[this.form.ref].resetFields()}}},ge=he,ve=(0,x.Z)(ge,de,ue,!1,null,"d1878a5a",null),fe=ve.exports;const be=5e3;var ye={name:"comment",props:{postId:{type:Number,required:!0},authorId:{type:Number},isAuthor:{type:Boolean,required:!1}},mixins:[c.j,Mt.j],components:{Emoji:se,UploadImage:ce,ReportDialog:fe},directives:{dragover:{inserted:function(t){t.addEventListener("dragover",(function(){this.classList.add("is-dragover")}),!1),t.addEventListener("drop",(function(){this.classList.remove("is-dragover")}),!1),t.addEventListener("dragleave",(function(){this.classList.remove("is-dragover")}),!1)}}},data(){return{uploadImage:l.Ix,init:!0,loading:!1,empty:!1,dialog:{report:{visible:!1,data:{}}},tabs:{value:"vote_count",options:[{label:"按热度排序",value:"vote_count"},{label:"按时间排序",value:"created_at"}]},comment:[],upvotedList:[],upvotedLoadingList:[],userRoleList:{},reply:{content:"",max:be,pending:!1},subReply:{content:"",max:be,active:!1,index:null,subIndex:null,pending:!1,placeholder:"",pageSize:6},drag:{subComment:!1},pagination:{total:0,currentPage:1,totalPage:1,pageSize:u.page.pageSize.comment,limit:u.page.limit[this.device.mobile()?"mobile":"normal"]}}},validations:{reply:{content:{required:Gt.C1,maxLength:(0,Gt.BS)(be)}},subReply:{content:{required:Gt.C1,maxLength:(0,Gt.BS)(be)}}},computed:{isMobile(){return this.device.mobile()},trustedHost(){const t=this.$store.getters.getCache.defalutOption||{};return t.comment_trustedhost_whitelist||[]}},watch:{postId(){this.getCommentList(),this.clearReply(),this.clearSubReply()},trustedHost(){this.bindContentEvent()}},methods:{getCommentList(){this.loading=!0;const t={post_id:this.postId,parent_id:0,page:this.pagination.currentPage,per_page:this.pagination.pageSize,with:["children","user"],include:`children:include(user):per_page(${this.subReply.pageSize}),user`,order_by:this.tabs.value,order:"desc",sticky:1};"vote_count"===this.tabs.value&&(t.default_order_by="created_at",t.default_order="desc"),(0,l.Rw)(t).then((t=>{const e=t.data;if(0===e.code){for(const t of e.data)t.loading=!1;this.comment=e.data,this.auth&&this.getUpvotedList(this.getIds(this.comment)),this.getUserRoleList(this.getIds(this.comment,"user_id")),this.pagination.total=e.meta.pagination.total,this.pagination.totalPage=e.meta.pagination.total_pages,this.pagination.currentPage=e.meta.pagination.current_page,this.bindContentEvent()}this.empty=0===this.comment.length,this.loading=!1,this.init&&(this.init=!1)})).catch((()=>{this.loading=!1}))},getSubCommentList(t){const e=this.comment[t];e.loading=!0;const a={post_id:this.postId,parent_id:e.id,page:e.children.meta.pagination.current_page,per_page:this.subReply.pageSize,order_by:"created_at",order:"asc",with:["user"],include:"user"};(0,l.Rw)(a).then((t=>{const a=t.data;0===a.code&&(e.children.data=t.data.data,e.children.meta=t.data.meta,this.getUpvotedList(this.getIds(e.children.data)),this.getUserRoleList(this.getIds(e.children.data,"user_id")),this.bindContentEvent()),e.loading=!1})).catch((()=>{e.loading=!1}))},switchOrder(t){this.tabs.value=t,this.getCommentList()},getUpvotedList(t){const e=[];this.upvotedLoadingList=t;for(const s of t)this.upvotedList.includes(s)||e.push(s);if(!e.length)return;const a={ids:e,relation:"upvote",type:"comment"};(0,l.tT)(a).then((t=>{const e=t.data;0===e.code&&(this.upvotedList=[...e.data,this.upvotedList]),this.upvotedLoadingList=[]}))},getUserRoleList(t){const e=[],a=Object.keys(this.userRoleList).map((t=>Number(t)));for(const s of t)a.includes(s)||e.push(s);e.length&&(0,l.SS)({ids:e}).then((t=>{const e=t.data;if(0===e.code){const t={};for(const a of e.data)t[a.id]=a.roles;this.userRoleList={...this.userRoleList,...t}}}))},getIds(t,e="id"){const a=[];for(const s of t){const t=this._.get(s,e);if(a.includes(t)||a.push(t),s.children&&s.children.data)for(const i of s.children.data){const t=this._.get(i,e);a.includes(t)||a.push(t)}}return a},showDeleteBtn(t){const e=["administrator","editor"],a=["delete_others_comments"];return t===this.currentUser.id||(this.currentUser.id===this.authorId||(!!this.hasPermission(a,!1)||!!this.hasRole(e,!1)))},appendContent(t=!1,e){t?(this.subReply.content+=e,this.$refs.subReply[0].focus()):(this.reply.content+=e,this.$refs.reply.focus())},toggleSubComment(t,e=null){if(this.subReply.index!==t||this.subReply.subIndex!==e){const a=this.comment[t],s=null!==e?a.children.data[e].user.nickname:a.user.nickname;this.subReply.index=t,this.subReply.subIndex=e,this.subReply.placeholder="回复 @"+s,this.subReply.active=!0,this.subReply.content="",this.$v.subReply.$reset()}else this.subReply.active=!this.subReply.active;this.$nextTick((function(){this.$refs.subReply[0].focus()}))},submitComment(){if(this.$v.reply.$touch(),this.$v.reply.$invalid)this.$refs.reply.focus();else{this.reply.pending=!0;const t={content:this.reply.content,post_id:this.postId,include:`children:include(user):per_page(${this.subReply.pageSize}),user:include(roles)`};(0,l.Yr)(t).then((t=>{const e=t.data;if(0===e.code){if(1===this.pagination.currentPage){e.data.loading=!1;const t=this._.findLastIndex(this.comment,(t=>t.is_sticky))+1;this.comment.splice(t,0,e.data),this.pagination.total+=1}else this.changePage(!1,1);this.bindContentEvent(),this.checkEmpty(),this.clearReply(),this.clearSubReply()}})).catch((()=>{this.reply.pending=!1}))}},submitSubComment(t){if(this.$v.subReply.$touch(),this.$v.subReply.$invalid)this.$refs.subReply[0].focus();else{this.subReply.pending=!0;const e=this.comment[t],a=this.subReply.subIndex;(0,l.Yr)({post_id:this.postId,content:this.subReply.content,reply_to_id:null!==a?e.children.data[a].id:e.id,parent_id:this.comment[t].id,include:"user:include(roles)"}).then((e=>{const a=e.data;0===a.code&&(this.comment[t].children.data.push(a.data),this.bindContentEvent(),this.clearSubReply())})).catch((()=>{this.subReply.pending=!1}))}},voteComment(t,e=!1){if(!this.auth)return this.toast({message:"登录后才能点赞哦",type:"warning"}),!1;if(this.upvotedLoadingList.includes(t.id))return!1;let a=l.bj,s=!0;const i=this.upvotedList.indexOf(t.id);-1!==i&&(a=l.GY,s=!1),this.upvotedLoadingList=[t.id],a({id:t.id}).then((a=>{0===a.data.code&&(t.vote_count+=s?1:-1,s?(this.upvotedList.push(t.id),this.toast({message:"点赞成功",type:"success"})):this.upvotedList.splice(i,1),e&&this.isAuthor&&(t.is_author_voted=s)),this.upvotedLoadingList=[]}))},deleteComment(t=!1,e,a){if(confirm("是否确定要删除该评论？")){const s=this.comment[e];(0,l.YF)({id:t?s.children.data[a].id:s.id}).then((a=>{if(0===a.data.code){if(t){let t=s.children.meta.pagination.current_page;t>=2&&s.children.data.length<=1&&(t-=1),this.changePage(!0,t,e)}else{let t=this.pagination.currentPage;t>=2&&this.comment.length<=1&&(t-=1),this.changePage(!1,t)}this.checkEmpty()}}))}},stickyComment(t,e){const a=e?"取消":"";this.$confirm(`您确定要${a}置顶该评论？`,"提示",{type:"warning"}).then((()=>{(0,l.KK)({id:t.id,state_key:"is_sticky",state_value:!e}).then((t=>{0===t.data.code&&(this.getCommentList(),e||this.toast({message:"置顶成功",type:"success"}))}))}))},notifyComment(t,e){const a=e?"取消":"开启";this.$confirm(`您确定要${a}该评论的提醒？`,"提示",{type:"warning"}).then((()=>{(0,l.KK)({id:t.id,state_key:"is_notify",state_value:e}).then((s=>{0===s.data.code&&(t.is_notify=!e,this.toast({message:a+"成功",type:"success"}))}))}))},openReportDialog(t){this.dialog.report.data={id:t},this.dialog.report.visible=!0},handleReport(t){(0,l.cC)({id:t.id,type:t.type,reason:t.reason}).then((t=>{0===t.data.code&&(this.toast({message:"举报已受理",type:"success"}),this.$refs.reportDialog.closeDialog())})).catch((t=>{this.toast({message:(0,l.e$)(t.response.data.message),type:"error"}),this.$refs.reportDialog.closeDialog()}))},clearReply(){this.reply.content="",this.reply.pending=!1,this.$v.reply.$reset()},clearSubReply(){this.subReply.content="",this.subReply.placeholder="",this.subReply.active=!1,this.subReply.index=null,this.subReply.subIndex=null,this.subReply.pending=!1,this.$v.subReply.$reset()},changePage(t,e,a){t?(this.comment[a].children.meta.pagination.current_page=e,this.getSubCommentList(a)):(this.pagination.currentPage=e,this.getCommentList(),this.clearSubReply())},roleLabel(t){if(!t)return"";const e=["administrator","editor"];return t=t.map((t=>t.name)),t=this._.intersection(t,e),t.map((t=>this.formatRole(t))).join(",")},formatDateTitle(t){return this.dayjs(t).format("YYYY-MM-DD HH:mm:ss")},bindContentEvent(){this.$nextTick((function(){if(this.$refs.content)for(const t of this.$refs.content)(0,Wt.$c)(t)}))},checkEmpty(){this.empty=!this.comment.length},handleDrop(t,e){this.drag.subComment=e,this.$refs.uploadImage.dropImage(t.dataTransfer.files[0])},handlePaste(t,e){if(t.clipboardData&&t.clipboardData.items){const a=t.clipboardData.items;for(let t=0;t<a.length;t++)if(-1!==a[t].type.indexOf("image")){const s=a[t].getAsFile();this.drag.subComment=e,this.$refs.uploadImage.dropImage(s);break}}},handleInsertImage(t){this.toast({message:"图片上传成功",type:"success"}),this.appendContent(this.drag.subComment,t.url)}},created(){this.getCommentList()}},_e=ye,Ce=(0,x.Z)(_e,Kt,Vt,!1,null,null,null),we=Ce.exports,xe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"related-post-wrap"},[a("div",{staticClass:"heading"},[t._v("你可能会喜欢")]),a("div",{staticClass:"related-post clearfix"},[a("transition-group",{attrs:{name:"fade-fast"}},t._l(t.post,(function(e,s){return a("div",{key:s,staticClass:"related-post-card",class:{loading:t.loading}},[a("router-link",{attrs:{to:{name:"post",params:{postId:e.id}},title:e.title,target:t.newTab}},[a("div",{staticClass:"post-card-content"},[a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.thumb||t.defaultThumb,expression:"item.thumb || defaultThumb",arg:"background-image"}],staticClass:"cover",attrs:{"data-thumb":""}}),a("div",{staticClass:"title text-truncate",domProps:{textContent:t._s(e.title)}})])])],1)})),0)],1),t.init?a("div",{staticClass:"spinner"},[a("i")]):t._e(),t.empty?a("div",{staticClass:"empty"},[t._v("暂无推荐")]):t._e()])},ke=[],$e={name:"relatedPost",mixins:[c.j],props:{data:{type:Object,default(){return{}}}},data(){return{post:[],init:!0,loading:!1,empty:!1}},computed:{isMobile(){return this.device.mobile()},defaultThumb(){const t=this.$store.getters.getCache.defalutOption||{};return t.post_default_thumb||null}},watch:{data:{handler:function(t){if(this._.isEmpty(t))return!1;this.getData()},immediate:!0}},methods:{getData(){this.empty&&(this.init=!0),this.empty=!1,this.loading=!0;const t={per_page:1+(this.isMobile?2:3),simple:1,cache:1};this.data.categories.length&&(t.category_in=this.data.categories.map((t=>t.id))),(0,l.UI)(t).then((t=>{0===t.data.code&&(this.post=t.data.data.filter((t=>t.id!==this.data.id)).slice(0,this.isMobile?2:3)),this.loading=!1,this.empty=0===this.post.length,this.init&&(this.init=!1)}))}}},Pe=$e,Ee=(0,x.Z)(Pe,xe,ke,!1,null,"4aa92046",null),Se=Ee.exports,Ie=a(9417),Ae={name:"post",head:{title(){return{inner:this.post.title||"文章"}}},components:{Sidebar:G.Z,Comment:we,RelatedPost:Se},mixins:[c.j,d.j,Yt.j],data(){return{baseUrl:window.Config.cdnDomain,post:{tags:[],categories:[],user:{},favorited:!1,upvoted:!1,arguement:""},loading:!0,authorized:!0,vote:{active:!1},editRoles:["editor","administrator"]}},computed:{id(){return parseInt(this.$route.params.postId)},showEditBtn(){return!(!this.isAuthor&&!this.hasRole(this.editRoles,!1))},isAuthor(){return this.auth&&this.post.user&&this.post.user.id===this.currentUser.id},relatedData(){return this.loading?{}:{categories:this.post.categories,id:this.id}},isMobile(){return this.device.mobile()}},watch:{id(){this.getData()}},methods:{getData(){this.loading=!0;const t={id:this.id,include:"user,tags,categories"};this.auth&&(t.include+=",favorited,upvoted"),(0,l.xl)(t).then((t=>{const e=t.data;0===e.code&&(this.post=this._.assign(this.post,{...e.data,content:this.formatShortcode(e.data.content)}),"publish"!==e.data.status?this.$router.push({name:"previewPost",params:{postId:e.data.id}}):this.storeLocalViewHistory(),e.data.is_arguable?this.getArguement():this.post.arguement=""),this.loading=!1,this.$nextTick((function(){this.bindEvent()})),this.$emit("updateHead")})).catch((t=>{if(t.response){const e=t.response.status;404===e?this.$router.push({name:"404Page"}):this.authorized=!1}this.loading=!1}))},async getMeta(t){return await(0,l.VC)({id:this.id,meta_key:t}).then((t=>0===t.data.code&&t.data.data)).catch((()=>!1))},async getArguement(){const t=await this.getMeta("arguement");t&&(this.post.arguement=t.value)},toggleFavoritePost(){this.post.favorited?this.unfavoritePost():this.favoritePost()},favoritePost(){(0,l.xZ)({id:this.post.id}).then((t=>{0===t.data.code&&(this.post.favorited=!0,this.post.favorite_count+=1,this.toast({message:"收藏成功",type:"success"}))}))},unfavoritePost(){confirm("是否要取消该收藏？")&&(0,l.kU)({id:this.post.id}).then((t=>{0===t.data.code&&(this.post.favorited=!1,this.post.favorite_count-=1)}))},toggleVotePost(){this.post.upvoted?this.unvotePost():this.votePost()},votePost(){(0,l.Gi)({id:this.post.id}).then((t=>{0===t.data.code&&(this.post.upvoted=!0,this.vote.active=!0,setTimeout((()=>{this.vote.active=!1}),1e3),this.post.vote_count+=1)}))},unvotePost(){(0,l.A1)({id:this.post.id}).then((t=>{0===t.data.code&&(this.post.upvoted=!1,this.post.vote_count-=1)}))},goEditPage(){window.open(window.Config.cdnDomain+"/admin/post/update/"+this.id)},formatDateTitle(t){return this.dayjs(t).format("YYYY-MM-DD HH:mm:ss")},storeLocalViewHistory(){Ie.Z.put({id:this.post.id,date:Date.now()})}},created(){this.getData()}},Ne=Ae,De=(0,x.Z)(Ne,Ft,Ht,!1,null,"ba4e0ff2",null),je=De.exports,Le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",attrs:{id:"page"}},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"post-wrap"},[a("article",{staticClass:"article"},[a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"header"},[a("div",{staticClass:"title"},[a("h1",[a("router-link",{attrs:{to:{name:"pages",params:{pageId:t.page.id}}}},[t._v(" "+t._s(t.page.title)+" ")])],1)]),a("div",{staticClass:"meta"},[t.page.user?a("router-link",{staticClass:"item",attrs:{to:{name:"user",params:{userId:t.page.user.id}}},domProps:{textContent:t._s(t.page.user.nickname)}}):t._e(),a("v-time",{staticClass:"item",attrs:{type:t.dateDisplay,date:t.page.created_at,title:t.formatDateTitle(t.page.created_at)}}),t.auth?[t.showEditBtn?a("a",{staticClass:"item meta-label primary",attrs:{href:"javascript:;"},on:{click:t.goEditPage}},[t._v("编辑文章")]):t._e()]:t._e()],2)])]),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"content",staticClass:"content format-content",domProps:{innerHTML:t._s(t.page.content)}})]),t.loading?a("div",{staticClass:"spinner"},[a("i")]):t._e()],1)])])])},Te=[],ze={name:"page",head:{title(){return{inner:this.page.title||"文章"}}},components:{},mixins:[c.j,Yt.j],data(){return{page:{user:{}},loading:!1,editRoles:["editor","administrator"]}},computed:{id(){return parseInt(this.$route.params.pageId)},showEditBtn(){return!(!this.isAuthor&&!this.hasRole(this.editRoles,!1))},isAuthor(){return this.auth&&this.page.user&&this.page.user.id===this.currentUser.id}},watch:{id(){this.getData()}},methods:{getData(){this.loading=!0;const t={id:this.id,include:"user"};(0,l.fx)(t).then((t=>{const e=t.data;0===e.code&&(this.page=this._.assign(this.post,{...e.data,content:this.formatShortcode(e.data.content)})),this.loading=!1,this.$nextTick((function(){this.bindEvent()})),this.$emit("updateHead")})).catch((()=>{this.loading=!1}))},goEditPage(){window.open(window.Config.cdnDomain+"/admin/page/update/"+this.id)},formatDateTitle(t){return this.dayjs(t).format("YYYY-MM-DD HH:mm:ss")}},created(){this.getData()}},Re=ze,qe=(0,x.Z)(Re,Le,Te,!1,null,null,null),Me=qe.exports,Ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-12",attrs:{id:"search"}},[a("div",{staticClass:"search-navbar text-center"},[a("div",{staticClass:"title"},[a("h1",{domProps:{textContent:t._s(t.title)}})])]),""!==t.searchKey?a("div",{staticClass:"simple-navbar tab-navbar text-center"},[a("ul",{staticClass:"list reset-ul-style"},t._l(t.tab,(function(e){return a("li",{key:e.value,staticClass:"item"},[a("a",{class:{active:e.value===t.activeRouter},attrs:{href:"javascript:;"},on:{click:function(a){return t.switchTab(e.value)}}},[t._v(t._s(e.label))])])})),0)]):t._e(),""!==t.searchKey?a("router-view"):t._e()],1)},Ue=[],Oe={name:"search",head:{title