'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('powerbiportal.web.bundle.min.js');var powerbi,__awaiter=this&&this.__awaiter||function(e,n,s,c){return new(s=s||Promise)(function(o,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,a)}i((c=c.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(o,r){var a,i,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,i&&(n=2&t[0]?i.return:t[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,t[1])).done)return n;switch(i=0,(t=n?[2&t[0],n.value]:t)[0]){case 0:case 1:n=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(n=0<(n=s.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){s.label=t[1];break}if(6===t[0]&&s.label<n[1]){s.label=n[1],n=t;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(t);break}n[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(o,s)}catch(e){t=[6,e],i=0}finally{a=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}};!(function(i){!(function(t){var e=jsCommon.Utility,o=i.telemetryEventFactory,r=i.telemetryBaseEventFactory,a=i.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.DashboardRenameReportEventName="PBI.Dashboard.RenameReport",t.DashboardRenameReport=a[t.DashboardRenameReportEventName]=function(e){return o({name:t.DashboardRenameReportEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameReportLoggers})},t.DashboardDeleteReportEventName="PBI.Dashboard.DeleteReport",t.DashboardDeleteReport=a[t.DashboardDeleteReportEventName]=function(e){return o({name:t.DashboardDeleteReportEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteReportLoggers})},t.DashboardInitializeNavigationPaneReportsEventName="PBI.Dashboard.InitializeNavigationPaneReports",t.DashboardInitializeNavigationPaneReports=a[t.DashboardInitializeNavigationPaneReportsEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneReportsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneReportsLoggers})},t.DashboardInitializeNavigationPaneModelsEventName="PBI.Dashboard.InitializeNavigationPaneModels",t.DashboardInitializeNavigationPaneModels=a[t.DashboardInitializeNavigationPaneModelsEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneModelsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneModelsLoggers})},t.DashboardRenameDatasetEventName="PBI.Dashboard.RenameDataset",t.DashboardRenameDataset=a[t.DashboardRenameDatasetEventName]=function(e){return o({name:t.DashboardRenameDatasetEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameDatasetLoggers})},t.DashboardUpdateModelQnaFeaturesEventName="PBI.Dashboard.UpdateModelQnaFeatures",t.DashboardUpdateModelQnaFeatures=a[t.DashboardUpdateModelQnaFeaturesEventName]=function(e){return o({name:t.DashboardUpdateModelQnaFeaturesEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateModelQnaFeaturesLoggers})},t.DashboardUpdateFeaturedQuestionsEventName="PBI.Dashboard.UpdateFeaturedQuestions",t.DashboardUpdateFeaturedQuestions=a[t.DashboardUpdateFeaturedQuestionsEventName]=function(e){return o({name:t.DashboardUpdateFeaturedQuestionsEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateFeaturedQuestionsLoggers})},t.DashboardDeleteDatasetEventName="PBI.Dashboard.DeleteDataset",t.DashboardDeleteDataset=a[t.DashboardDeleteDatasetEventName]=function(e){return o({name:t.DashboardDeleteDatasetEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteDatasetLoggers})},t.DashboardAddUpdateDashboardEventName="PBI.Dashboard.AddUpdateDashboard",t.DashboardAddUpdateDashboard=a[t.DashboardAddUpdateDashboardEventName]=function(e){return o({name:t.DashboardAddUpdateDashboardEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardAddUpdateDashboardLoggers})},t.DashboardInitializeNavigationPaneWorkbooksEventName="PBI.Dashboard.InitializeNavigationPaneWorkbooks",t.DashboardInitializeNavigationPaneWorkbooks=a[t.DashboardInitializeNavigationPaneWorkbooksEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneWorkbooksEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneWorkbooksLoggers})},t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName="PBI.Dashboard.UpdateLocalWorkbookNeverShowExplanation",t.DashboardUpdateLocalWorkbookNeverShowExplanation=a[t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName]=function(e){return o({name:t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers})},t.DashboardRenameWorkbookEventName="PBI.Dashboard.RenameWorkbook",t.DashboardRenameWorkbook=a[t.DashboardRenameWorkbookEventName]=function(e){return o({name:t.DashboardRenameWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameWorkbookLoggers})},t.DashboardRemoveWorkbookEventName="PBI.Dashboard.RemoveWorkbook",t.DashboardRemoveWorkbook=a[t.DashboardRemoveWorkbookEventName]=function(e){return o({name:t.DashboardRemoveWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRemoveWorkbookLoggers})},t.DashboardGetWorkbookWopiAccessInformationEventName="PBI.Dashboard.GetWorkbookWopiAccessInformation",t.DashboardGetWorkbookWopiAccessInformation=a[t.DashboardGetWorkbookWopiAccessInformationEventName]=function(e){return o({name:t.DashboardGetWorkbookWopiAccessInformationEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardGetWorkbookWopiAccessInformationLoggers})},t.DashboardWorkbookEmbeddingExternalSuccessEventName="PBI.Dashboard.WorkbookEmbeddingExternalSuccess",t.DashboardWorkbookEmbeddingExternalSuccess=a[t.DashboardWorkbookEmbeddingExternalSuccessEventName]=function(e){return o({name:t.DashboardWorkbookEmbeddingExternalSuccessEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardWorkbookEmbeddingExternalSuccessLoggers})},t.DashboardWorkbookEmbeddingExternalFailureEventName="PBI.Dashboard.WorkbookEmbeddingExternalFailure",t.DashboardWorkbookEmbeddingExternalFailure=a[t.DashboardWorkbookEmbeddingExternalFailureEventName]=function(e){return o({name:t.DashboardWorkbookEmbeddingExternalFailureEventName,info:e,category:i.TelemetryCategory.CriticalError,loggers:t.DashboardWorkbookEmbeddingExternalFailureLoggers})},t.DashboardImportResourcePackagesOnLoadEventName="PBI.Dashboard.ImportResourcePackagesOnLoad",t.DashboardImportResourcePackagesOnLoad=a[t.DashboardImportResourcePackagesOnLoadEventName]=function(e){return o({name:t.DashboardImportResourcePackagesOnLoadEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardImportResourcePackagesOnLoadLoggers})},t.DashboardGetNavigationPanePackageEventName="PBI.Dashboard.GetNavigationPanePackage",t.DashboardGetNavigationPanePackage=a[t.DashboardGetNavigationPanePackageEventName]=function(e){return o({name:t.DashboardGetNavigationPanePackageEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardGetNavigationPanePackageLoggers})},t.PermissionsObjectNotFoundEventName="PBI.Permissions.ObjectNotFound",t.PermissionsObjectNotFound=a[t.PermissionsObjectNotFoundEventName]=function(e){return o({name:t.PermissionsObjectNotFoundEventName,info:e,category:i.TelemetryCategory.CriticalError,loggers:t.PermissionsObjectNotFoundLoggers})},t.AppsGetAppEventName="PBI.Apps.GetApp",t.AppsGetApp=a[t.AppsGetAppEventName]=function(e){return o({name:t.AppsGetAppEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.AppsGetAppLoggers})},t.AppsUninstallAppEventName="PBI.Apps.UninstallApp",t.AppsUninstallApp=a[t.AppsUninstallAppEventName]=function(e){return o({name:t.AppsUninstallAppEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.AppsUninstallAppLoggers})},t.TileConfigUpgradeTileConfigEventName="PBI.TileConfig.UpgradeTileConfig",t.TileConfigUpgradeTileConfig=a[t.TileConfigUpgradeTileConfigEventName]=function(e){return o({name:t.TileConfigUpgradeTileConfigEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.TileConfigUpgradeTileConfigLoggers})},t.MobileAuthoringDashboardOpenedFromFlyoutEventName="PBI.MobileAuthoring.DashboardOpenedFromFlyout",t.MobileAuthoringDashboardOpenedFromFlyout=a[t.MobileAuthoringDashboardOpenedFromFlyoutEventName]=function(e){return o({name:t.MobileAuthoringDashboardOpenedFromFlyoutEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.MobileAuthoringDashboardOpenedFromFlyoutLoggers})},t.PermissionsUpdateArtifactVisibilityEventName="PBI.Permissions.UpdateArtifactVisibility",t.PermissionsUpdateArtifactVisibility=a[t.PermissionsUpdateArtifactVisibilityEventName]=function(e){return o({name:t.PermissionsUpdateArtifactVisibilityEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.PermissionsUpdateArtifactVisibilityLoggers})},t.BaseDatapoolEventEventName="BaseDatapoolEvent",t.BaseDatapoolEvent=a[t.BaseDatapoolEventEventName]=function(e){return r({info:e,baseEvent:t.CustomerAction(e)})},t.DatapoolDeleteDatapoolEventName="PBI.Datapool.DeleteDatapool",t.DatapoolDeleteDatapool=a[t.DatapoolDeleteDatapoolEventName]=function(e){return o({name:t.DatapoolDeleteDatapoolEventName,baseEvent:t.BaseDatapoolEvent(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DatapoolDeleteDatapoolLoggers})},t.DatapoolUpdatePropertiesEventName="PBI.Datapool.UpdateProperties",t.DatapoolUpdateProperties=a[t.DatapoolUpdatePropertiesEventName]=function(e){return o({name:t.DatapoolUpdatePropertiesEventName,baseEvent:t.BaseDatapoolEvent(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DatapoolUpdatePropertiesLoggers})},t.HttpRequestThrottledEventName="PBI.Http.RequestThrottled",t.HttpRequestThrottled=a[t.HttpRequestThrottledEventName]=function(e){return o({name:t.HttpRequestThrottledEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.HttpRequestThrottledLoggers})},t.DatasetGetSharedDatasetsEventName="PBI.Dataset.GetSharedDatasets",t.DatasetGetSharedDatasets=a[t.DatasetGetSharedDatasetsEventName]=function(e){return o({name:t.DatasetGetSharedDatasetsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DatasetGetSharedDatasetsLoggers})},t.DatasetGetReadonlySharedDatasetsEventName="PBI.Dataset.GetReadonlySharedDatasets",t.DatasetGetReadonlySharedDatasets=a[t.DatasetGetReadonlySharedDatasetsEventName]=function(e){return o({name:t.DatasetGetReadonlySharedDatasetsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DatasetGetReadonlySharedDatasetsLoggers})},t.UserInfoPreviousTenantIdEventName="PBI.UserInfo.PreviousTenantId",t.UserInfoPreviousTenantId=a[t.UserInfoPreviousTenantIdEventName]=function(e){return o({name:t.UserInfoPreviousTenantIdEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.UserInfoPreviousTenantIdLoggers})}})(i.telemetry||(i.telemetry={}))})(powerbi=powerbi||{}),(function(e){var i,n;e=(e=e.dataServices||(e.dataServices={})).compatibility||(e.compatibility={}),i=jsCommon.ArrayExtensions,n=jsCommon.JsonExtensions,e.conformOutgoingTile=function(e){e.layoutConfig;var t=n.tryParseJSON(e.layoutConfig),t=i.extendWithId(t.layouts).withId(0);e.col=t.position.x,e.row=t.position.y,e.colSpan=t.position.width,e.rowSpan=t.position.height},e.conformOutgoingTileLayoutDescriptors=function(e){for(var t=0,o=e;t<o.length;t++){var r=o[t];r.layoutConfig;var a=n.tryParseJSON(r.layoutConfig),a=i.extendWithId(a.layouts).withId(0);r.col=a.position.x,r.row=a.position.y,r.colSpan=a.position.width,r.rowSpan=a.position.height}}})(powerbi=powerbi||{}),(function(s){!(function(e){var i=s.common.NotifyCollection,a=s.common.contracts.PackageType;e.createAppService=function(e,t,o,r){return new n(e,t,o,r)};var n=(t.prototype.ensureAppsInitialization=function(){return this.appStore.ensureAppsInitialization()},t.prototype.getAppByGUID=function(t){var e=_.find(this.appInstances,(function(e){return e.objectId===t}));return e&&e.providerContract},Object.defineProperty(t.prototype,"appInstances",{get:function(){return this.instances.items},enumerable:!1,configurable:!0}),t.prototype.onInstanceAdded=function(e){var t=this,o=this.promiseFactory;if(e.packageType!==a.AppInstance)return o.reject();var r=this.getAppInstance(e.id);return null!=r?o.resolve(r):(e.contentProviderRefId,this.appStore.loadMetadata(e.contentProviderRefId,e.id).then((function(e){return o.resolve(t.onAppAdded(e.App,_.find(e.packages,(function(e){return e.packageType===a.AppInstance}))))})))},t.prototype.getAppInstance=function(e){return this.getAppInstanceInternal(e)},t.prototype.getAppInstanceInternal=function(t){return _.find(this.instances.items,(function(e){return e.packageId===t}))},t.prototype.onAppsUpdated=function(e,t){for(var o=[],r=this.packageIdToAppMap,a=this.dataServiceModelMerger,i=this.dataServiceModelConverter,n=0;n<e.length;n++){var s=e[n],c=t[n],d=r[c.id];d?d.providerContract!==s&&a.mergeInstalledAppModel(d,s,c):d=i.convertInstalledAppModel(s,c),o.push(d)}this.instances.setItems(o),this.packageIdToAppMap=_.keyBy(o,(function(e){return e.packageId}))},t.prototype.onAppAdded=function(e,t){var o=this.packageIdToAppMap[t.id];if(o)return o;e=this.dataServiceModelConverter.convertInstalledAppModel(e,t);return this.instances.addItem(e),this.packageIdToAppMap[t.id]=e},t.prototype.isAppCategory=function(e){return this.appStore.isAppCategory(e)},t);function t(e,t,o,r){var a=this;this.promiseFactory=e,this.dataServiceModelConverter=t,this.appStore=o,this.dataServiceModelMerger=r,this.instances=new i,this.packageIdToAppMap={},this.appStore.installedApps.subscribe((function(e){a.onAppsUpdated(e.apps,e.packages)}))}e.createMockAppService=function(e){return new o(e)};var o=(r.prototype.ensureAppsInitialization=function(){return this.promiseFactory.reject()},r.prototype.appsAfterFolderSwitchPromise=function(){return this.promiseFactory.resolve()},r.prototype.getAppByGUID=function(e){return null},r.prototype.isAppCategory=function(e){return!1},r.prototype.onInstanceAdded=function(e){return this.promiseFactory.reject(null)},r.prototype.getAppInstance=function(e){return null},r);function r(e){this.promiseFactory=e}})(s.dataServices||(s.dataServices={}))})(powerbi=powerbi||{}),(function(t){!(function(){(t.dataServices||(t.dataServices={})).createPermissionRefreshService=function(e,t,o,r){return new a(e,t,o,r)};var a=(e.prototype.refreshDashboardTilePermissionsUponLoad=function(f){return __awaiter(this,void 0,t.Promise,(function(){var t,o,r,a,i,n,s,c,d,l,p,u,h=this;return __generator(this,(function(e){switch(e.label){case 0:return(f.isLoaded,f.contract,t=this.promiseFactory.resolve(null),o=f.contract&&f.contract.tiles,_.isEmpty(o))?[2,t]:(r=this.userInfo,a=this.dashboardDataService,i=f.id,(n=this.inFlightSyncRequests[f.id])?[2,n.promise]:(s=20,r.isUserMetadataRefreshed||!_.some(o,(function(e){return e.errorCode===s}))||a.dropDashboardfromMemoryIfNotActive(i)?[2,t]:(n=this.inFlightSyncRequests[f.id]=this.promiseFactory.defer(),c=function(){return delete h.inFlightSyncRequests[f.id],n.resolve(null),n.promise},[4,this.userInfo.userMetadataPromise])));case 1:for(e.sent(),d=[],l=0,p=o;l<p.length;l++)(u=p[l]).errorCode===s&&d.push(u.id);return _.isEmpty(d)||a.dropDashboardfromMemoryIfNotActive(i)?[2,c()]:[4,this.dashboardSyncService.onTilesAddedOrUpdated(i,d)];case 2:return e.sent(),[2,c()]}}))}))},e.prototype.refreshDashboardTiles=function(e){for(var t=[],o=this.dashboardDataService,r=this.dashboardSyncService,a=0,i=e;a<i.length;a++){var n=i[a];o.dropDashboardfromMemoryIfNotActive(n)||t.push(r.addOrDeepEditDashboard(n))}return this.promiseFactory.allSettled(t)},e);function e(e,t,o,r){this.userInfo=e,this.dashboardSyncService=t,this.dashboardDataService=o,this.promiseFactory=r,this.inFlightSyncRequests={}}})()})(powerbi=powerbi||{}),(function(a){!(function(e){var t=a.common.NotifyCollection;e.createDashboardCollectionService=function(){return new o};var o=(Object.defineProperty(r.prototype,"dashboards",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.map=_.keyBy(e,(function(e){return e.objectId}))},enumerable:!1,configurable:!0}),r.prototype.findDashboardByObjectId=function(e){return this.map[e]},r.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardAdded&&r.onDashboardAdded(e)}},r.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardDeleted&&r.onDashboardDeleted(e)}},r.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onDashboardsReset&&o.onDashboardsReset()}},r.prototype.addDashboard=function(e){this.collection.addItem(e),this.map[e.objectId]=e},r.prototype.removeDashboard=function(t){var e=this.collection.deleteItems((function(e){return e.id===t}));e.length,0!==e.length&&delete this.map[_.first(e).objectId]},r.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},r.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},r);function r(){this.listeners=[],this.collection=new t,this.map={}}})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(t){!(function(r){r.createDashboardDataService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,f,v){return new b(e,t,o,r,a,i,n,s,c,d,l,p,u,f,v)};var b=(e.prototype.registerRefreshStateListener=function(e){_.includes(this.refreshStateListeners,e)||this.refreshStateListeners.push(e)},e.prototype.unregisterRefreshStateListener=function(e){_.remove(this.refreshStateListeners,e)},e.prototype.onDashboardTileRefreshStarted=function(e){this.activeDashboardId===e&&0===this.refreshState&&this.notify(1,e)},e.prototype.onDashboardTileRefreshFinished=function(e){var t=this;this.activeDashboardId===e&&1===this.refreshState&&(this.notify(2,e),this.$timeout((function(){return t.notify(0,e)}),3e3))},e.prototype.notify=function(e,t){this.refreshState=e;for(var o=0,r=this.refreshStateListeners;o<r.length;o++)r[o].onStateChange(this.refreshState,t)},Object.defineProperty(e.prototype,"dashboards",{get:function(){return this.dashboardCollectionService.dashboards},set:function(e){this.dashboardCollectionService.dashboards=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboard",{get:function(){return this.activeDashboardObjectId?this.findDashboardByGUID(this.activeDashboardObjectId):null},set:function(e){e?(this.activeDashboardId=e.id,this.activeDashboardObjectId=e.objectId):(this.activeDashboardId=-1,this.activeDashboardObjectId=null),this.dashboardStore.select(e?e.contract:null),this.refreshState=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboardContainsQnaSupportedModel",{get:function(){return!_.isEmpty(this.activeDashboardQnaModels)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this.activeDashboard?this.activeDashboard.displayName:""},enumerable:!1,configurable:!0}),e.prototype.addDashboard=function(e){e&&(this.findDashboardByGUID(e.objectId)||this.dashboardCollectionService.addDashboard(e))},e.prototype.deleteTile=function(e,t){var r=this,a=this.promiseFactory.defer(),i=this.findDashboard(e);return i?this.tryUpdateTile(i,t,(function(e,t){var o;0<=e&&0<=t?(o=i.contract.tiles[e],i.contract.tiles.splice(e,1),i.tiles.splice(t,1),r.updateQnAEnabledWhenNoTilesOnDashboard(i),i.hasModel(o.modelId)||r.dashboardHttpService.addDashboardRequestToBatch(r.promiseFactory,i.id,!1,0).done((function(e){r.modelMerger.mergeDashboardShallow(i,e.dashboards[0]),r.updateActiveDashboardModels(),a.resolve(null)})).fail((function(){a.reject()}))):a.resolve(null)})):a.resolve(null),a.promise},e.prototype.dropDashboardfromMemoryIfNotActive=function(e){var t=this.activeDashboard;return(!t||t.id!==e)&&(this.findDashboard(e)&&this.dashboardStore.unloadDashboardTiles(e),!0)},e.prototype.findDashboard=function(t){return _.find(this.dashboards,(function(e){return e.id===t}))},e.prototype.findDashboardByGUID=function(e){return this.dashboardCollectionService.findDashboardByObjectId(e)},e.prototype.findDashboardsByPackageId=function(t){var e=this.dashboards;if(e)return _.filter(e,(function(e){return!(!e.contract||!e.contract.originalPackageId)&&e.contract.originalPackageId===t}))},e.prototype.retrieveDashboardForApp=function(t,o){return _.find(this.dashboards,(function(e){return e.getUniquePackageId()===t&&e.contract.originalDashboardObjectId===o}))},e.prototype.tryUpdateTile=function(e,t,o){var r;e&&(r=e.getTileContractIndex(t),t=e.getTileIndex(t),e.contract.tiles.length,e.tiles.length,o(r,t),e.scheduleDelayedLayout(this.activeDashboard!==e))},e.prototype.updateActiveDashboardModels=function(){var e=this.activeDashboard&&this.activeDashboard.contract;this.updateActiveDashboardModelsInternal(e)},e.prototype.updateActiveDashboardModelsInternal=function(o){return __awaiter(this,void 0,t.Promise,(function(){var t=this;return __generator(this,(function(e){switch(e.label){case 0:return o=o||this.activeDashboard&&this.activeDashboard.contract,[4,this.modelService.modelsPromise];case 1:return e.sent(),this.activeDashboardModels=r.DashboardUtils.getDashboardModels(o,this.modelService.getModelContracts()),this.activeDashboardQnaModels=_.filter(this.activeDashboardModels,(function(e){return r.DashboardUtils.isQnaSupportedModel(e)&&t.permissionService.isExplorableModelContract(e)})),this.updateIsQnaEnabled(),[2]}}))}))},e.prototype.isActiveDashboardModelRefreshDisabled=function(){var e=this.activeDashboardModels;if(_.isEmpty(e))return!1;for(var t=this.modelService,o=0,r=e;o<r.length;o++){var a=r[o],a=t.findModel(a.id,a.packageId);if(a&&a.isRefreshDisabledDueToInactivity())return!0}return!1},e.prototype.updateIsQnaEnabled=function(){this.activeDashboard?void 0!==this.activeDashboard.qnaEnabled?this.isQnaEnabled=this.activeDashboard.qnaEnabled:this.isQnaEnabled=this.activeDashboardContainsQnaSupportedModel:this.isQnaEnabled=!1},e.prototype.onModelUpdated=function(e,t){this.modelService.findModel(e,t)&&this.updateActiveDashboardModels()},e.prototype.getDashboards=function(){var e=this;return this.dashboardsDeferred.promise.then((function(){return e.dashboards}))},e.prototype.setQnaEnabled=function(e,t){e=this.findDashboard(e);e&&(e.qnaEnabled=t,this.updateIsQnaEnabled())},e.prototype.subscribe=function(e){this.dashboardCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.dashboardCollectionService.unsubscribe(e)},e.prototype.onDeleted=function(e){this.dashboardCollectionService.onDeleted(e)},e.prototype.dashboardsAfterFolderSwitchPromise=function(){return this.dashboardsAfterFolderSwitchDeferred.promise},e.prototype.updateQnAEnabledWhenNoTilesOnDashboard=function(e){_.isEmpty(e.tiles)&&(e.qnaEnabled=!1)},e);function e(e,t,o,r,a,n,i,s,c,d,l,p,u,h,f){var v=this;this.dashboardHttpService=e,this.groupStore=t,this.promiseFactory=o,this.modelConverter=r,this.modelMerger=a,this.modelService=n,this.dashboardCollectionService=i,this.$timeout=s,this.dashboardStore=c,this.appMetadataService=d,this.permissionService=l,this.datasetRefreshListener=u,this.reportStore=f,this.refreshStateListeners=[],this.dashboardCollectionService=i,this.dashboardsDeferred=o.defer(),this.isQnaEnabled=!1,this.datasetRefreshListener.addModelUpdateListener(this),this.refreshState=0,this.appMetadataService.getAppMetadata().then((function(){v.dashboardStore.selectedDashboard.subscribe((function(e){v.activeDashboardId=e?e.id:v.activeDashboardId,v.activeDashboardObjectId=e?e.objectId:v.activeDashboardObjectId,v.updateActiveDashboardModelsInternal(e)}))})),this.dashboardsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(){v.groupStore.selectedFolderId$.subscribe((function(){v.dashboardsAfterFolderSwitchDeferred.resolve(),v.dashboardsAfterFolderSwitchDeferred=v.promiseFactory.defer()})),p.ensureReportsInitialization().then((function(){v.dashboardStore.dashboards.subscribe((function(e){var o,r,a,i=_.keyBy(v.dashboards,(function(e){return e&&e.objectId}));v.dashboards=_.filter(e,(function(e){return!!e})).map((function(e){var t=i[e.objectId];return t?(v.modelMerger.mergeDashboardShallow(t,e),t):(_.isEmpty(o)&&(o=_.map(n.models,(function(e){return e.contract})),v.reportStore.reports.subscribe((function(e){r=e})),a=_.map(h.workbooks,(function(e){return e.contract}))),v.modelConverter.convertDashboard(e,o,r,a))})),v.dashboardsAfterFolderSwitchDeferred.resolve(),v.dashboardsDeferred.resolve(v)}))}))}),(function(){v.dashboardsDeferred.reject(),v.dashboardsAfterFolderSwitchDeferred.reject()}))}r.DashboardDataService=b})(t.dataServices||(t.dataServices={}))})(powerbi=powerbi||{}),(function(m){!(function(i){var n=m.dataServices.contracts.TileType;i.createDashboarSyncService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,f,v){return new b(e,t,o,r,a,i,n,s,c,d,l,p,u,h,f,v)};var b=(e.prototype.onTilesAddedOrUpdated=function(e,t){var o=this.promiseFactory;return this.customTilesUpdate?(this.customTilesUpdate(e,t),o.resolve(null)):this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)?o.resolve(null):void this.addOrUpdateActiveDashboardTiles(e,t)},e.prototype.addOrDeepEditDashboard=function(t){var o=this,r=this.telemetryService.startEvent(m.telemetry.DashboardAddUpdateDashboard),a=this.promiseFactory.defer();return this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t,!1,0).done((function(e){o.addOrUpdateDashboard(e),o.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),o.dashboardDataService.onDashboardTileRefreshFinished(t),r.resolve(),a.resolve(null)})).fail((function(){r.reject(),a.reject(null)})),a.promise},e.prototype.onDashboardShallowEdit=function(e){var t=e.dashboards[0],e=this.dashboardDataService.findDashboard(t.id);e&&(this.modelMerger.mergeDashboardShallow(e,t),this.rootScope.$emit(i.constants.onDashboardShallowEditEventName,e,t))},e.prototype.onDashboardDeepEdit=function(e){this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e),this.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),this.dashboardDataService.onDashboardTileRefreshFinished(e.dashboards[0].id)},e.prototype.addOrUpdateCustomVisualTile=function(e,t,o){var r=this;this.isResourcePackageInCache(e)?this.addOrUpdateTile(t,o,this.modelService.getModelContracts()):this.resourcePackageListenerService.getAndLoadVisualPlugin(e).then((function(){r.addOrUpdateTile(t,o,r.modelService.getModelContracts())}))},e.prototype.addOrUpdateDashboard=function(e){var t=e.dashboards[0];this.dashboardStore.addOrUpdate(t),this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e);e=this.modelConverter.convertDashboard(t,e.models,e.reports);this.dashboardDataService.onDashboardTileRefreshFinished(e.id)},e.prototype.addOrUpdateTile=function(a,i,n,s){var c=this;a&&(n=n||[],this.updateModelsIfRequired(a,i),this.dashboardDataService.tryUpdateTile(a,i.id,(function(e,t){var o=c.reportService.findReport(i.reportId),r=null;0<=e?(a.contract.tiles[e]=i,0<=t&&(r=a.tiles[t],c.modelMerger.mergeTile(r,i,n,null,c.workbookService.getWorkbookContracts(),c.reportService.reports))):(r=s||c.modelConverter.convertTile(i,n,null,c.workbookService.getWorkbookContracts()),a.contract.tiles.push(i),a.tiles.push(r)),r&&(r.invalidateLayout(),o&&(r.report=o))})))},e.prototype.registerAndUpdateTile=function(e,t){var o=this.dashboardDataService.findDashboard(e);if(t.resourcePackageIds&&0<t.resourcePackageIds.length)for(var r=t.resourcePackageIds.length,a=0;a<r;++a)this.addOrUpdateCustomVisualTile(t.resourcePackageIds[a],o,t);else this.featureSwitchService.featureSwitches.consumePublicCvsWithoutRps?this.ensurePublicCVsAndAddOrUpdateTile(o,t):this.addOrUpdateTile(o,t,this.modelService.getModelContracts())},e.prototype.ensurePublicCVsAndAddOrUpdateTile=function(e,t){var o,r=this,a=this.modelConverter.convertTile(t,this.modelService.getModelContracts(),null,this.workbookService.getWorkbookContracts()),i=a.type===n.composite&&(null===(o=null===(o=null===(o=null===(o=null===(o=a.config)||void 0===o?void 0:o.visualContainer)||void 0===o?void 0:o.$visualContainer)||void 0===o?void 0:o.config)||void 0===o?void 0:o.singleVisual)||void 0===o?void 0:o.visualType);i?this.publicCustomVisualService.getPublicVisualTypes([i]).then((function(e){if(e[0]){e=r.publicCustomVisualService.createPublicResourcePackageByName(i);return r.resourcePackageListenerService.loadVisualPlugin([e])}})).finally((function(){r.addOrUpdateTile(e,t,r.modelService.getModelContracts(),a)})):this.addOrUpdateTile(e,t,this.modelService.getModelContracts(),a)},e.prototype.addOrUpdateActiveDashboardTiles=function(a,e,i){var n=this;if(this.dashboardDataService.selectedDashboardTile){var t=(e=0===e.length?this.dashboardDataService.activeDashboard.tiles.map((function(e){return e.id})):e).indexOf(this.dashboardDataService.selectedDashboardTile.id);if(0<=t&&(e.splice(t,1),0===e.length))return this.promiseFactory.resolve(null)}return this.dashboardHttpService.batchGetTiles(a,e,void 0,!0).then((function(e){var t=e.data;if(!_.isEmpty(t))for(var o=0,r=t.length;o<r;++o)n.registerAndUpdateTile(a,t[o]);i&&n.dashboardDataService.onDashboardTileRefreshFinished(a)}))},e.prototype.updateModelsIfRequired=function(t,e){var o=this,r=t.getTileContractIndex(e.id),a=-1!==r&&2===e.publishState&&1===t.contract.tiles[r].publishState;!a&&t.hasModel(e.modelId)||this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t.id,!1,0).done((function(e){a&&(o.modelMerger.mergeDashboardTiles(t,e),o.rootScope.$emit(i.constants.mergeDashboardContainerModelsReportsAndPackagesEventName,e),o.modelMerger.mergeModelContentProviderId(e.models,e.packages)),o.modelMerger.mergeDashboardShallow(t,e.dashboards[0]),o.dashboardDataService.updateActiveDashboardModels()}))},e.prototype.isResourcePackageInCache=function(t){var e=this.resourcePackagesService.getAllPackages();return _.some(e,(function(e){return e.id===t}))},e);function e(e,t,o,r,a,i,n,s,c,d,l,p,u,h,f,v){var b=this;this.rootScope=e,this.dashboardDataService=t,this.dashboardHttpService=o,this.modelConverter=r,this.modelMerger=a,this.modelService=i,this.promiseFactory=n,this.reportService=s,this.resourcePackageListenerService=c,this.resourcePackagesService=d,this.telemetryService=l,this.workbookService=p,this.dashboardStore=u,this.globalEventBridge=h,this.featureSwitchService=f,this.publicCustomVisualService=v,this.globalEventBridge.createChannelSubscriptionManager().subscribe(m.dataServices.events.syncServiceDashboardEditedEvent,(function(e,t){return b.onDashboardShallowEdit(t)})).subscribe(m.dataServices.events.syncServiceDashboardDeepEditedEvent,(function(e,t){return b.onDashboardDeepEdit(t)})).subscribe(m.dataServices.events.syncServiceTilesAddedOrUpdated,(function(){}