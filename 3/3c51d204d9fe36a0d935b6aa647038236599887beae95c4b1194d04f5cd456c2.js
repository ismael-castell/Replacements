!function(e){"use strict";var t=function(){function e(t){babelHelpers.classCallCheck(this,e),this.name=t}return babelHelpers.createClass(e,[{key:"request",value:function(){}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}}]),e}(),r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"request",value:function(){return{}}}]),t}(t),a=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"dfp"));return a.player=e,a.data=r,a.adServer=pbjs.adServers.dfp,a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"queryStringToObject",value:function(e){var t=decodeURIComponent(e.replace(/\+/g,"%20")),r=t.substring(t.search(/\?/g)+1,t.length),a=r.split(/&(?!amp;)/g),n={};return a.map(function(e){var t=e.split("=");n[t[0]]=t[1]}),n}},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.player.ima,a=r.config.adTagUrl||{},n="string"==typeof a?this.queryStringToObject(a):a.params,i=null!=this.data.bid,s={adUnit:t,params:n};if(i&&e){var u=this.data.bid,l=e.filter(function(e){return e.bidderCode===u||e.bidder==u});l.length>0&&(s.bid=l.shift())}return this.data.hasOwnProperty("url")&&this.data.url.length>0&&(s.url=this.data.url),this.adServer.buildVideoUrl(this.player.evaluateBindings(s))}}]),t}(t),n={BID_REQUEST:"request",COMPLETED:"completed",BID_RESPONSE:"response",ERROR:"error"},i=akamai.fp,s=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.player=e,a.plugin=null!=pbjs?pbjs:window.pbjs,a.adRequestTransformCallback=a.adRequestTransformCallback.bind(a),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getAdUnitCodes",value:function(){var e=function(e){return e instanceof Array?e:[e]};return i.transform(e(this.data.adUnits),i.filter(function(e){return!!e&&e.code}),i.map(function(e){return e.code}))}},{key:"onready",value:function(){null!=this.plugin&&(this.plugin.que=this.plugin.que||[],this.player.addTransform(akamai.amp.TransformType.AD_REQUEST,this.adRequestTransformCallback))}},{key:"adRequestTransformCallback",value:function(e){var t=this;return this.plugin&&this.data.transformEnabled!==!1?this.getAdTag().then(function(t){return e.request.adTagUrl=t,e}).catch(function(){}