/*! For license information please see 2c4de697db3e88cb37c4be0f488ce2a8-v2.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(self,(()=>(self.webpackChunksketchfab=self.webpackChunksketchfab||[]).push([[5991,1572,2322,3764,9661,3709,107,5650,3665,4795,7035],{"1dkX":(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("Iao2"),r=i("R4My"),a=i.n(r),o=i("Hjnd"),s=i.n(o),A=i("k46e"),g=i("Wuy/");const h=n.Z.extend({el:['<div class="widget slider-widget">','          <div class="widget-wrapper">','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:(0,A.Z)({},n.Z.prototype.events,{"mousedown .bar":"trackDrag","mousedown .cursor":"cursorDrag","touchstart .bar":"trackDrag","touchstart .cursor":"cursorDrag"}),constructor:function(e,t){t=(0,g.Z)(t||{},{model:new(a().Model),name:"value",minimum:0,maximum:1,step:.01,orientation:"horizontal"}),n.Z.prototype.constructor.call(this,e,t),void 0===this.get()&&this.set(0)},initialize:function(){this.$slide=this.$(".slide"),"vertical"===this.options.orientation&&this.$el.addClass("--vertical"),this.started=!1,this.render()},delegateEvents:function(){n.Z.prototype.delegateEvents.apply(this,arguments),s()(window).on("mousemove.delegateEvents"+this.cid,this.moveEvent.bind(this)),s()(window).on("mouseup.delegateEvents"+this.cid,this.stopEvent.bind(this)),s()(window).on("touchmove.delegateEvents"+this.cid,this.moveEvent.bind(this)),s()(window).on("touchend.delegateEvents"+this.cid,this.stopEvent.bind(this))},undelegateEvents:function(){n.Z.prototype.undelegateEvents.apply(this,arguments),s()(window).off(".delegateEvents"+this.cid)},render:function(){var e=this.options.maximum-this.options.minimum,t=(this.get()-this.options.minimum)/e*100,i={};"vertical"===this.options.orientation?i.height=t+"%":i.width=t+"%",this.$slide.css(i)},startEvent:function(e){e.preventDefault(),this.$el.addClass("fast"),this.started=!0},stopEvent:function(e){this.started&&(e.preventDefault(),this.$el.removeClass("fast"),this.started=!1)},moveEvent:function(e){this.started&&(e.preventDefault(),this.selectEvent(e))},selectEvent:function(e){var t,i;if(e.preventDefault(),"horizontal"===this.options.orientation){var n=this.$el.offset().left,r=this.$el.width();void 0===(i=e.pageX)&&(i=e.originalEvent.touches[0].pageX),t=(i-n)/r}else if("vertical"===this.options.orientation){var a=this.$el.offset().top,o=this.$el.height();(i=e.pageY)||(i=e.originalEvent.touches[0].pageY),t=(a+o-i)/o}t=Math.min(Math.max(0,t),1),t=this.options.minimum+t*(this.options.maximum-this.options.minimum),this.change(t)},cursorDrag:function(e){this.startEvent(e),e.stopPropagation()},trackDrag:function(e){this.startEvent(e),this.moveEvent(e)}})},yCZG:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("1dkX"),r=i("k46e"),a=i("Wuy/"),o=i("VKI/");const s=n.Z.extend({el:['<div class="widget slider-widget volume-slider-widget">','          <div class="widget-wrapper">','              <a class="fa-regular fa-volume-up"></a>','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:(0,r.Z)({},n.Z.prototype.events,{"click .fa":"onoff","touchstart .fa":"onoff"}),constructor:function(e,t){t=(0,a.Z)(t||{},{name:"volume",minimum:0,maximum:1,step:.1}),n.Z.prototype.constructor.call(this,e,t)},initialize:function(){n.Z.prototype.initialize.apply(this,arguments),this.isMute=0===this.get(),this.value=this.get(),this.model.on("change:"+this.options.name,(0,o.Z)(function(){0===this.get()?(this.isMute=!0,this.mute(this.$(".fa"))):this.isMute&&(this.isMute=!1,this.unmute(this.$(".fa")))}.bind(this)))},mute:function(e){e.removeClass("fa-volume-up").addClass("fa-volume-off")},unmute:function(e){e.removeClass("fa-volume-off").addClass("fa-volume-up")},onoff:function(){this.isMute?(0!==this.value&&null!==this.value||(this.value=1),this.model.set("mute",!1),this.set(this.value),this.model.set("playing",!0)):(this.value=this.get(),this.set(0),this.model.set("mute",!0))},cursorDrag:function(){n.Z.prototype.cursorDrag.apply(this,arguments),this.value=null}})},Iao2:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("Hjnd"),r=i.n(n),a=i("k46e"),o=i("jQDz"),s=i("Sbzs"),A=i("Psgz"),g=i("OM1T"),h=i("ptuJ");const c=A.Z.extend({mixins:[g.Z,h.Z],el:'<div class="widget"/>',constructor:function(e,t){this.environment=(0,a.Z)({},e?e.environment:{},(t||{}).environment),this.options=t||{},this.collection=this.options.collection,this.model=this.options.model,A.Z.call(this,t)},initialize:function(e){A.Z.prototype.initialize.call(this,e),this.render(),void 0!==this.options.id&&(this.id=this.options.id,this.$el.attr("id",this.id)),void 0!==this.options.className&&(this.className=this.options.className,this.$el.addClass(this.className)),void 0!==this.options.title&&this.$el.attr("title",this.options.title)},$:function(e){var t=this.$el;return this.$el.find(e).filter((function(){return r()(this).parent().closest(".widget").is(t)}))},delegateEvents:function(e){e||(e=(0,o.Z)(this,"events")||{});var t=this.$el;return A.Z.prototype.delegateEvents.call(this,Object.keys(e).reduce(function(i,n){var a=e[n];return(0,s.Z)(a)||(a=this[e[n]]),a?(i[n]=function(e){e&&e.currentTarget&&!r()(e.currentTarget).closest(".widget").is(t)||a.apply(this,arguments)}.bind(this),i):i}.bind(this),{})),this.model&&this.model.on("change",this.modelChangeEvent,this),this},undelegateEvents:function(){return A.Z.prototype.undelegateEvents.apply(this,arguments),this.model&&this.model.off("change",this.modelChangeEvent,this),this},modelChangeEvent:function(){var e=this.options.name,t=e+".",i=!e,n=Object.keys(this.model.changedAttributes()||{}).some((function(i){return i===e||0===i.indexOf(t)}));(i||n)&&this.render()},change:function(e,t){1===arguments.length&&(t=e,e=void 0);var i=!0,n=function(){i=!1},r={target:this,which:e,value:t,preventDefault:n};return this.trigger("change.before",r),!!i&&(this.defaultAction(e,t),this.trigger("change"),!0)},defaultAction:function(e,t){this.set(t)},field:function(e){return this.options.name+(e?"."+e:"")},get:function(e){return this.model.get(this.field(e))},set:function(e,t){return 1===arguments.length&&(t=e,e=void 0),this.model.set(this.field(e),t)},disable:function(){this._disabled=!0,this.$el.addClass("disabled")},enable:function(){this._disabled=!1,this.$el.removeClass("disabled")}},{reify:function(){var e=arguments,t=this,i=function(){t.apply(this,e)};return i.prototype=this.prototype,new i}})},zu1l:e=>{var t={ApiCoreVersion:"1_0",start:"-",stop:"-",load:"-",gotoAnnotation:"-",getAnnotationList:"-",lookat:"-",setFov:"-",getCurrentTime:"-",play:"-",pause:"-",seekTo:"-",getAnimations:"-",setCurrentAnimationByUID:"-",setCycleMode:"-",setSpeed:"-",getSceneGraph:"-",getNodeMap:"-",getMatrix:"-",setMatrix:"-",hide:"-",show:"-",translate:"-",rotate:"-",getRootMatrixNode:"-",getCameraLookAt:"-",setCameraLookAt:"-",getScreenShot:"-",getMaterialList:"-",getTextureList:"-",addTexture:"-",updateTexture:"-",setTextureQuality:"-",setMaterial:"-",setPostProcessing:"-",getPostProcessing:"-"},i=Object.assign({},t,{getWorldToScreenCoordinates:"-"}),n=Object.assign({},i,{ApiCoreVersion:"1_2",pickColor:"-",setListenerOptions:"-",unselectAnnotation:"-"}),r=Object.assign({},n,{ApiCoreVersion:"1_3",setCameraEasing:"-",showAnnotation:"-",hideAnnotation:"-",getAnnotation:"-",updateAnnotation:"-",createAnnotation:"-",removeAnnotation:"-",pickFromScene:"-",pickFromScreen:"-",addVideoTexture:"-",translate:"-",rotate:"-"}),a=Object.assign({},r,{}),o=Object.assign({},a,{ApiCoreVersion:"1_4",getEnvironment:"-",getLight:"-",getFov:"-",getRootMatrixNode:"-",getShadingStyle:"-",getWireframe:"-",setCurrentAnimationByUID:"-",setEnvironment:"-",setLight:"-",setShadingStyle:"-",setWireframe:"-"}),s=Object.assign({},o,{ApiCoreVersion:"1_5",setAnnotationsTexture:"-",addVideoTexture:"-",gotoAnnotation:"-",setBackground:"-",getBackgroundList:"-",setEnvironment:"-",getEnvironmentList:"-",setCycleMode:"-"}),A=Object.assign({},s,{}),g=Object.assign({},A,{mouseMove:"-",mouseDown:"-",mouseUp:"-",mouseClick:"-",mouseDblClick:"-",mouseWheel:"-",startRecord:"-",endRecord:"-"}),h=Object.assign({},g,{ApiCoreVersion:"1_6",createAnnotationFromScenePosition:"-",createAnnotationFromWorldPosition:"-",getAnimations:"-",hideAnnotationTooltip:"-",removeAllAnnotations:"-",setCameraConstraints:"-",setEnableCameraConstraints:"-",setAnnotationCameraTransition:"-",showAnnotationTooltip:"-",recenterCamera:"-",setUserInteraction:"-"}),c=Object.assign({},h,{ApiCoreVersion:"1_7",setUVOffset:"-",setUVRotation:"-",setUVScale:"-",refreshCanvas:"-",refreshDraw:"-",setHighlightOptions:"-",highlightMaterial:"-"}),l=Object.assign({},c,{setEnableCameraConstraints:"-"}),u=Object.assign({},l,{ApiCoreVersion:"1_8",isLightFeatureEnabled:"-",startAR:"-",hide:"-",focusOnVisibleGeometries:"-",setCameraLookAtEndAnimationCallback:"-",setEnableCameraConstraints:"-",setLightFeatureEnabled:"-",setSpeed:"-",show:"-"}),d=Object.assign({},u,{createAnnotationFromWorldPosition:"-",createAnnotationFromScenePosition:"-",hideAnnotationTooltip:"-",showAnnotationTooltip:"-",hideAnnotationTooltips:"-",showAnnotationTooltips:"-"}),I=Object.assign({},d,{hideAnnotationTooltip:"-",showAnnotationTooltip:"-",hideAnnotationTooltips:"-",showAnnotationTooltips:"-"}),C=Object.assign({},I,{ApiCoreVersion:"1_9",hideAnnotationTooltip:"-",showAnnotationTooltip:"-",hideAnnotationTooltips:"-",removeTexture:"-"}),f=Object.assign({},C,{ApiCoreVersion:"1_10",createMaterial:"-",assignMaterial:"-",createDecal:"-",destroyDecal:"-",pickFromTextureCoordinates:"-",findDecalFromWorldPosition:"-"}),p=Object.assign({},f,{pickFromTextureCoordinates:"-",findDecalFromWorldPosition:"-"}),m=Object.assign({},p,{_initializeAnnotationMarkdown:"-"}),_=Object.assign({},m,{ApiCoreVersion:"1_11",setCameraRoll:"-"}),E=Object.assign({},_,{ApiCoreVersion:"1_12",getLight:"-",setLight:"-"});e.exports={"1.0.0":t,"1.0.1":t,"1.0.2":t,"1.0.3":t,"1.1.0":i,"1.2.0":n,"1.2.1":n,"1.3.0":r,"1.3.1":a,"1.3.2":a,"1.4.0":o,"1.4.1":o,"1.4.2":o,"1.4.3":o,"1.5.0":s,"1.5.1":A,"1.5.2":g,"1.5.3":g,"1.6.0":h,"1.6.1":h,"1.7.0":c,"1.7.1":l,"1.7.2":l,"1.8.0":u,"1.8.1":d,"1.8.2":I,"1.8.3":I,"1.8.4":I,"1.9.0":C,"1.9.1":C,"1.9.2":C,"1.10.0":f,"1.10.1":p,"1.10.2":p,"1.10.3":p,"1.10.4":m,"1.10.5":m,"1.11.0":_,"1.11.1":_,"1.12.0":E,"1.12.1":E}},"0bhc":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i("JBVY");const r=function(e,t){if(window.parent){var i={type:"api.ready",instanceId:n.ZP.string("api_id",void 0),error:e,httpStatus:t};window.parent.postMessage(i,function(e){if(!e||!e.length)return"*";var t=e.split("//");return t[0]+"//"+t[1].split("/")[0]}(document.referrer))}}},Sgtb:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("k46e"),r=i("0aN2"),a=i("tjn4"),o=i("lotc"),s=i("l5lH"),A=i("eNuK"),g=i("2jst");const h=a.Z.extend((0,n.Z)({optionTypes:{modelUid:o.Z.string},model:r.Z,url:function(){return(0,g.Z)("textures",this.options.modelUid,this.options.checkPrefetch)},comparator:function(e,t){return"None"===e.get("label")?-1:"None"===t.get("label")?1:(0,s.Z)(e.get("label"),t.get("label"))},isValid:function(){this.each((function(e){e.isValid()}))},getImageFromURL:function(e){var t=e.split("/").pop();return this.find((function(e){var i=!1;return e.get("images").forEach((function(e){i||-1!==e.url.indexOf(t)&&(i=!0)})),i}))}},A.Z))},eNuK:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i("AyNe");const r={addNewImage:function(e){if(!this.model)throw new Error("This collection must implement a model.");var t,i=e.uid;i?t=i.replace(/tmp_/,""):i="tmp_"+(t=e.id||(0,n.Z)());var r=new this.model({images:[{uid:i,url:e.url,width:e.width,height:e.height}],uid:i,id:t,name:e.name||"newImage",imageFile:e.imageFile,internal:e.internal});return this.set(r,{merge:!0,add:!0,remove:!1}),r}}},uo4Z:(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("xKIK"),r=i("Hjnd"),a=i.n(r);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function A(e){return{name:"PreventPageScroll",constructor:function(){this.events=function(e,t){var i,n={},r=e?" "+e:"";return n["wheel"+r]=function(e){var t=-1/4*e.originalEvent.wheelDelta;t&&(e.preventDefault(),a()(e.currentTarget).scrollTop(t+a()(e.currentTarget).scrollTop()))},n["touchstart"+r]=function(e){i=e.originalEvent.touches[0].pageY},n["touchmove"+r]=function(e){e.preventDefault();var t=i-e.originalEvent.touches[0].pageY;i=e.originalEvent.touches[0].pageY,a()(e.currentTarget).scrollTop(t+a()(e.currentTarget).scrollTop())},s(s({},t),n)}(e,this.events)}}}},"VlB/":(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("sGMM"),r=i("7isf"),a=i("45Yh"),o=i("Oyie");function s(e){var t=(0,r.Z)(e.find(".image-container"));return new o((function(e){window.requestAnimationFrame((function(){t.forEach((function(e){e.classList.remove("--loading")})),e()}))}))}const A={name:"WithImageContainers",afterRender:function(){var e,t;(e=this.$el,t=(0,r.Z)(e.find(".image-container .image-container__image")).map((function(e){return[e.getAttribute("data-src"),e]})).filter((function(e){return!!(0,n.Z)(e,1)[0]})).map((function(e){var t=(0,n.Z)(e,2),i=t[0],r=t[1];return r.removeAttribute("data-src"),new o((function(e,t){var n=(0,a.jo)(r,(function(o){o&&(n(),(0,a.po)(i).then((function(){r.setAttribute("src",i),e()})).catch((function(){t("Image failed to load on scroll")})))}),{margin:200})}))})),o.all(t).then((function(){return e}))).then(s)}}},yCA5:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("xKIK"),r=i("Hjnd"),a=i.n(r),o=i("Sbzs"),s=i("zIYZ"),A=i("yTkX"),g=Symbol("windowCallbackKey");const h={name:"WithWindowEvents",constructor:function(){var e=this;this[g]={listeners:[]},this.events=(0,s.iE)(this.events,(function(t,i){var r=(0,A.L0)(i);if("window"!==r.selector)return(0,n.Z)({},i,t);if("string"==typeof t&&!e[t])throw new Error("WithWindowEvents error: "+e.displayName+"."+t+" is not defined.");return e[g].listeners.push({eventName:r.eventName,callback:function(){for(var i,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(0,o.Z)(t)?t.call.apply(t,[e].concat(r)):(i=e[t]).call.apply(i,[e].concat(r))}}),{}}))},delegateEvents:function(){this[g].listeners.forEach((function(e){a()(window).on(e.eventName,e.callback)}))},undelegateEvents:function(){this[g].listeners.forEach((function(e){a()(window).off(e.eventName,e.callback)}))},beforeRemove:function(){this[g].listeners.forEach((function(e){a()(window).off(e.eventName,e.callback)}))}}},"zF/U":(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("L0SH"),r=i("Hjnd"),a=i.n(r),o=i("/K0U"),s=i("9O9B"),A=i("amXS"),g=i("mSEu");const h=o.Z.extend({save:function(e,t){null!=e&&"object"!==(0,n.Z)(e)||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile")),i.append("modelUid",t.modelUID),a().ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"})},endpoint:function(){return"/backgrounds".concat(this.isNew()?"":"/".concat(this.get("uid")))}},(0,A.Z)({fileTypes:g.Z.backgroundFiletypes,maxFileSize:g.Z.maxBackgroundFilesize})).extend(s.Z)},ogfj:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("amXS"),r=i("jQKg"),a=i("Yxa5"),o=i("mSEu"),s=i("/K0U"),A=i("RyS8"),g=i("Oyie");const h=s.Z.extend({endpoint:function(){return"/environments/".concat(this.get("uid"))},checkStatusAndRetry:function(){var e=this;return a.Z.retry(1/0,(function(){return r.Z.getEnvironmentProcessingStatus(e.get("uid"),{allowPrefetching:!1}).then((function(e){return e||g.reject(new A.Ms)})).then((function(e){return["SUCCEEDED","FAILED"].includes(e.processing.toUpperCase())?e:g.reject(new A.Ms)}))}),{interval:1e4}).catch((function(){return{processing:"FAILED",error:"The server failed to answer in time"}}))}},(0,n.Z)({fileTypes:o.Z.environmentFiletypes,maxFileSize:o.Z.maxEnvironmentFilesize}))},YBVK:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("L0SH"),r=i("R4My"),a=i.n(r),o=i("Hjnd"),s=i.n(o),A=i("/K0U"),g=i("1nxQ"),h=i("Oyie");const c=A.Z.extend({defaults:function(){return{name:"",content:"",position:[0,0,0],eye:[0,0,0],target:[0,0,0],lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0],uidImage:void 0,imageFile:void 0,preview:"",hovered:!0,geometryUid:-1,indices:[-1,-1,-1],barycentricWeights:[0,0,0],localPosition:[0,0,0],visible:!0}},endpoint:function(){return"/hotspots".concat(this.isNew()?"":"/".concat(this.get("uid")))},remove:function(){return h.resolve(a().ajax({type:"DELETE",url:this.url()}))},appendArray:function(e,t,i){for(var n=0,r=i.length;n<r;++n)e.append(t,i[n])},_dumpOptions:function(){return{eye:this.get("eye").toString(),target:this.get("target").toString(),position:this.get("position").toString(),content:this.get("content").raw,name:this.get("name"),imFile:this.get("imFile")}},registerOptions:function(){this._lastOptions=this._dumpOptions()},hasChangedOptions:function(){if(!this._lastOptions)return!0;var e=this._dumpOptions(),t=this._lastOptions;for(var i in t)if(t[i]!==e[i])return!0;return!1},save:function(e,t){var i=this._lastOptions;if(!this.hasChangedOptions())return h.resolve();this.registerOptions(),null!=e&&"object"!==(0,n.Z)(e)||(t=e);var r=this.isNew(),a=new FormData,o=this.get("imageFile");void 0===this.get("uidImage")&&o&&a.append("imageFile",o),a.append("model",t.modelUID),a.append("name",(0,g.sanitize)(this.get("name")));var A=this.get("content").raw;a.append("content",null!==A?A:""),this.appendArray(a,"eye",this.get("eye")),this.appendArray(a,"target",this.get("target")),this.appendArray(a,"position",this.get("position"));var c=this,l=s().ajax({type:r?"POST":"PATCH",url:this.url(),data:a,cache:!1,contentType:!1,processData:!1,success:function(e){r&&(c.set("uid",e.uid),e.images.length>0&&c.set("uidImage",e.images[0].uid))},error:function(e){this._lastOptions=i,console.error(e.stack)}.bind(this)});return h.resolve(l)},_validate:function(e,t){return(t=t||{}).validate=!0,A.Z.prototype._validate.call(this,e,t)},validate:function(e){var t=e.eye,i=e.target,n=i[0]-t[0],r=i[1]-t[1],a=i[2]-t[2],o=Math.sqrt(n*n+r*r+a*a);if(o<=1e-8)return i[0]=e.position[0],i[1]=e.position[1],i[2]=e.position[2],!1;if(o<=.001){var s=.01/o;i[0]=t[0]+n*s,i[1]=t[1]+r*s,i[2]=t[2]+a*s}return!1}})},"9O9B":(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("IAxr"),r=i("aqzA"),a=i("MQQR"),o=i("YxXF"),s=r.Z.osg,A=function(e,t,i,n){var r=i-e,a=n-t;return r*r+a*a},g=function(e){return o.Z.isPowerOf2(e.width)&&o.Z.isPowerOf2(e.height)};const h={isVideoURL:function(e){var t=e.split("."),i=t[t.length-1].toLowerCase();return"ogv"===i||"ogg"===i||"mp4"===i||"avi"===i||"webm"===i},isVideo:function(){return this.isVideoURL(this.get("images")[0].url)},getUID:function(){return this.get("uid")},getImages:function(){return this.get("images")},getURL:function(){console.error("dont call ImageSet.getURL")},filterPng:function(e,t){var i=e[0];if(!i)return e;for(var r=1;r<e.length;++r)if(e[r].width===i.width&&e[r].height===i.height)return(0,n.Z)(e,(function(e){return e.url.endsWith(".png")===t}));return e},findFormat:function(e){var t=(0,n.Z)(this.get("images"),(function(t){return!t.options||t.options.format===e}));return"N"===e&&(0,a.Z)().preferOriginalNormalMap?this.filterPng(t,!0):t},getFilteredImages:function(e){if(!e||!(0,a.Z)().imageCompression)return this.findFormat();var t;switch(e){case s.Texture.ALPHA:if((t=this.findFormat("A")).length>0)return t;break;case s.Texture.RGB:if((t=this.findFormat("RGB")).length>0)return t;if((t=this.findFormat("N")).length>0)return t;break;case s.Texture.LUMINANCE:if((t=this.findFormat("R")).length>0)return t;if((t=this.findFormat("RGB")).length>0)return t;if((t=this.findFormat("N")).length>0)return t}return this.findFormat()},findImageNearestPowerOfTwoUpToResolution:function(e,t,i){return this.findImageNearestUpToResolution(e,t,!0,i)},findImageNearestUpToResolution:function(e,t,i,n){for(var r,a,o=1/0,s=!1,h=1/0,c=this.getFilteredImages(n),l=0,u=c.length;l<u;++l){var d=c[l],I=A(e,t,d.width,d.height);if(I<o&&(o=I,r=d),!(d.width>e||d.height>t))if(i){var C=g(d);s&&!C||(!a||!s&&C||I<h||h===1/0&&d.width>a.width&&d.height>a.height)&&(a=d,s=C,h=I)}else(!a||I<h||h===1/0&&d.width>a.width&&d.height>a.height)&&(a=d,h=I)}return a||r},findImageSmallest:function(e){return this.findImageNearestToResolution(0,0,e)},findImageWidget:function(){return this.findImageNearestToResolution(0,0,s.Texture.RGB)},findImageNearestToResolution:function(e,t,i){for(var n,r=1/0,a=this.getFilteredImages(i),o=0,s=a.length;o<s;++o){var g=a[o],h=A(e,t,g.width,g.height);h<r&&(r=h,n=g)}return n}}},Igo1:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("L0SH"),r=i("Hjnd"),a=i.n(r),o=i("/K0U"),s=i("9O9B"),A=i("amXS"),g=i("mSEu"),h=i("Oyie");const c=o.Z.extend({endpoint:function(){return"/matcaps".concat(this.isNew()?"":"/".concat(this.get("uid")))},save:function(e,t){null!=e&&"object"!==(0,n.Z)(e)||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("modelUid",t.modelUID),h.resolve(a().ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},getProxyImage:function(){var e=this.findImageSmallest();return e||console.error("MISSING IMAGE DATA!"),{label:this.get("name"),value:this.get("uid")||this.get("id"),image:e.url,imageModel:this,deletable:!this.get("isDefault")}}},(0,A.Z)({fileTypes:g.Z.matcapFiletypes,maxFileSize:g.Z.maxMatcapFilesize})).extend(s.Z)},Zj2R:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n=i("L0SH"),r=i("R4My"),a=i.n(r),o=i("UYGi"),s=i("mSEu"),A=i("amXS"),g=i("FqYX"),h=i("AsK1"),c=i("Oyie");const l=o.Z.extend({getModelOptionPath:function(){return"#.definitions.soundtrack"},getName:function(){return"Soundtrack"},initDefaults:function(e){var t=this._flattenObject(e,this._typeMap);this.set((0,g.Z)(t,this.attributes)),this.get("uid")||this.set("uid","tmp_"+this.get("cid"))},defaults:function(){return{cid:this.cid,lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0]}},isNew:function(){var e=this.get("uid");return void 0===e||!(!e||!e.toString().startsWith("tmp_"))},makeUrl:function(){return h.Z.domain+"/sounds".concat(this.isNew()?"":"/".concat(this.get("uid")))},duplicate:function(){var e=new this.constructor;return e.setJSON(this.getJSON()),e.set("name",this.get("name")),e.set("url",this.get("url")),e.set("files",this.get("files")),e},save:function(e,t){if(!this.isNew())return c.resolve();null!=e&&"object"!==(0,n.Z)(e)||(t=e);var i=new FormData;i.append("soundFile",this.get("files")[0]),i.append("name",this.get("name")),i.append("model",t.modelUID);var r=this;return c.resolve(a().ajax({type:"POST",url:this.makeUrl(),data:i,processData:!1,contentType:!1})).then((function(e){r.set("uid",e.uid)}))}},(0,A.Z)({fileTypes:s.Z.soundFiletypes,maxFileSize:s.Z.maxSoundFilesize}))},"0aN2":(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("L0SH"),r=i("Hjnd"),a=i.n(r),o=i("/K0U"),s=i("9O9B"),A=i("Oyie");const g=o.Z.extend({defaults:{colorSpace:"unknown"},endpoint:function(){return"/textures".concat(this.isNew()?"":"/".concat(this.get("uid")))},isValid:function(){var e=this.get("name");return void 0===e&&console.warn("no name for Texture "+this.id),e=e||this.id,void 0===this.get("images")&&console.warn("no images for Texture "+e),void 0===this.get("uid")&&console.warn("no uid for Texture "+e),!0},save:function(e,t){null!=e&&"object"!==(0,n.Z)(e)||(t=e);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("colorSpace",this.get("colorSpace")),i.append("modelUid",t.modelUID),A.resolve(a().ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},saveColorspace:function(){return A.resolve(a().ajax({url:this.url(),data:{colorSpace:this.get("colorSpace")},type:"PATCH"}))}}).extend(s.Z)},sg6w:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("L0SH"),r=i("/K0U"),a=i("jQKg");const o=r.Z.extend({save:function(e,t){return null!=e&&"object"!==(0,n.Z)(e)||(t=e),a.Z.createThumbnail({imageFile:this.get("imageFile"),source:this.get("source"),modelUid:t.modelUID})},endpoint:function(){return"/thumbnails"}})},amXS:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("lqp/"),r=i("KDlt");function a(e){var t={fileTypes:function(e,t){var i=t.name.replace(/^.*\.([^.]*)$/,"$1").toLowerCase();if(!(-1!==e.indexOf(i)))return{type:"fileTypes",message:"<p>Unsupported format. Please upload a "+e.join(", ").toUpperCase()+".</p>"}},maxFileSize:function(e,t){if(!(t.size<e)){var i=Math.floor(e/1024/1024)+"MB",n=Math.ceil(t.size/1024/1024)+"MB";return{type:"maxFileSize",message:r.Z.getFromString('<p>The {{ fileName | default("selected") }} image file size is too large. The maximum file size is {{ maxSizeLabel}} (your file is {{ currentSizeLabel }}).<p/>',{fileName:t.name,maxSizeLabel:i,currentSizeLabel:n})}}}},i={fileTypes:"<p>The file type you tried to upload is not currently supported by Sketchfab.</p>",maxFileSize:'        <p>To reduce your file size, you can:</p>        <ul class="--disc">            <li>resize your image to a lower resolution.</li>            <li>use a more efficient file format like JPEG.</li>            <li>reduce the JPEG quality.</li>        </ul>        '};return{name:"Validator",validateFile:function(i,r){if(null==e)return console.error("Ruleset not defined");var a,o=[];return(0,n.Z)(e,(function(e,n){(a=t[n](e,i))&&o.push(a)})),r?o.length>0?o:void 0:this.concatErrorMessages(o)},concatErrorMessages:function(e){return e.reduce((function(e,t){return e.concat(e,t.message)}),"")},getExtraErrorInformation:function(e){return i[e]}}}},tjn4:(e,t,i)=>{"use strict";i.d(t,{Z:()=>T});var n=i("mSEu"),r=i("k46e"),a=i("qqsP"),o=i("Cgfs"),s=i("jQDz"),A=i("R4My"),g=i.n(A),h=i("vCKz"),c=i("AsK1"),l=i("lrhy"),u=i("fAYH"),d=i("t3PY"),I=function(e,t){return Math.min(e,Math.max(0,parseInt(t)||0))},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,d.Qc)(e.split("?")[1]||"").page},f=function(){var e={};return{get:function(t){return e[t]},update:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i.forEach((function(i){e[i.uid]=t}))}}};const p=function(e,t){var i=function(){var t=(0,u.Z)(e.lastPage)?e.lastPage:0,i=I(t,e.firstPage);return{lastPage:t,currentPageIndex:i,hasPrevious:0!==i}},n=f(),r=i(),a=function(e){return function(t){return n.update(e,t.results),r.currentPageIndex=e,t.previous||(r.hasPrevious=!1),t.next?r.lastPage=1/0:r.lastPage=e,t}};return{type:"offset",loadPrevious:function(e){var i=I(r.lastPage,r.currentPageIndex-1);return t(i,e).then(a(i))},loadNext:function(e){var i=I(r.lastPage,r.currentPageIndex+1);return t(i,e).then(a(i))},loadFirst:function(e){r=i(),n=f();return t(0,e).then(a(0))},reset:function(){r=i()},hasPrevious:function(){return r.hasPrevious},hasNext:function(){return r.currentPageIndex+1<r.lastPage},isFirst:function(){return 0===r.currentPageIndex},getQueryParamsForElementUid:function(e){return{page:n.get(e)||""}},getQueryParams:function(){return{page:r.currentPageIndex}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=C(e);n.update(i,t.results)}}};var m=i("xKIK");function _(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function E(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_(Object(i),!0).forEach((function(t){(0,m.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,d.Qc)(e.split("?")[1]||"").cursor},S=function(){var e={};return{get:function(t){return e[t]},update:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i.forEach((function(i){e[i.uid]=t}))}}};const B=function(e,t){var i=function(){return{previousCursor:e.previous||null,currentCursor:e.current,nextCursor:e.next||null}},n=S(),r=i(),a=function(e,t){return function(i){return n.update(e,i.results),r.currentCursor=e,t.setNext&&(r.nextCursor=i.next?v(i.next):null),t.setPrevious&&(r.previousCursor=i.previous?v(i.previous):null),i}};return{type:"cursor",loadPrevious:function(e){return t(r.previousCursor,e).then(a(r.previousCursor,E(E({},e),{},{setPrevious:!0})))},loadNext:function(e){return t(r.nextCursor,e).then(a(r.nextCursor,E(E({},e),{},{setNext:!0})))},loadFirst:function(e){return r=i(),n=S(),t(r.currentCursor,e).then(a(r.current,E(E({},e),{},{setNext:!0,setPrevious:!0})))},reset:function(){r=i()},hasPrevious:function(){return null!==r.previousCursor},hasNext:function(){return null!==r.nextCursor},isFirst:function(){return r.currentCursor===e.current},getQueryParamsForElementUid:function(e){return{cursor:n.get(e)}},getQueryParams:function(){return{cursor:r.currentCursor}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=v(e);n.update(i,t.results)}}};var w=i("JBVY"),y=i("zIYZ"),M=i("g/7r");function D(e,t,i){var n=[],r=(0,o.Z)((function(){var e=n.slice();n=[],i.trigger(t,e)}),20),a=function(e){n.push(e),r()};return i.on(e,a),function(){i.off(e,a)}}var b=i("OM1T"),Q=i("Oyie"),x=(0,h.Z)(["initialize"])(g().Collection);const T=x.extend({mixins:[b.Z],optionsTypes:{offset:b.M.number,pageSize:b.M.number,paginationType:b.M.oneOf(["cursor","offset"]),lastPage:b.M.number,firstPage:b.M.number,minOffset:b.M.number,maxOffset:b.M.number,cursor:b.M.shape({previous:b.M.string,next:b.M.string})},defaultOptions:function(){return{pageSize:n.Z.apiPageSize,paginationType:"cursor",offset:0,minOffset:0,maxOffset:1/0,cursor:{previous:null}}},backend:c.Z,previousPromise:Q.resolve(),constructor:function(){this.options=(0,r.Z)({},this.defaultOptions(),(0,a.Z)(arguments[1]||{},(function(e){return void 0!==e}))),x.apply(this,arguments)},initialize:function(){this.options.backend&&(this.backend=this.options.backend),this._loading="none",D("add","afterAdd",this),D("remove","afterRemove",this),this.triggerAfterRequest=(0,o.Z)(this.triggerAfterRequest.bind(this),20),this.initializePagination(),x.prototype.initialize.apply(this,arguments)},at:function(e){return e<0?void 0:x.prototype.at.call(this,e)},domain:function(){return(0,s.Z)(this.backend,"domain")},parse:function(e){return this.backend.parse(e)},queryParams:function(){return this.isCursorPagination()?{cursor:this._currentCursor,count:(0,s.Z)(this.options,"pageSize")}:{offset:this.options.offset,count:(0,s.Z)(this.options,"pageSize")}},url:function(){var e=(0,s.Z)(this,"domain")+(0,s.Z)(this,"endpoint")+w.ZP.craft("?",this.queryParams());return e=e.replace(/(?!^)\/{2,}/g,"/")},fetch:function(){this.triggerBeforeRequest();var e=this.previousPromise;return this.previousPromise=Q.resolve(x.prototype.fetch.apply(this,arguments)).then((function(t){return(0,l.Vs)(1e3,e).catch(M.EI).then((function(){return t}))})),this.previousPromise.then(function(e){return this.previousPromise=Q.resolve(),this.triggerAfterRequest(e),e}.bind(this))},reset:function(){x.prototype.reset.apply(this,arguments),this.pagination.reset()},triggerBeforeRequest:function(){this.trigger("beforeRequest")},triggerAfterRequest:function(e){this.trigger("afterRequest",e)},isCursorPagination:function(){return"cursor"===this.pagination.type},initializePagination:function(){"offset"===this.options.paginationType?this._initializeOffsetPagination():this._initializeCursorPagination()},_initializeCursorPagination:function(){var e=this.options.cursor;this.pagination=B(e,function(e,t){return this._currentCursor=e,Q.resolve(this.fetch((0,r.Z)({},t,{reset:!1,add:!1,remove:!1})))}.bind(this))},_initializeOffsetPagination:function(){var e={lastPage:this.options.lastPage,firstPage:this.options.firstPage};this.pagination=p(e,function(e,t){return this.options.offset=this.options.minOffset+(0,s.Z)(this.options,"pageSize")*e,Q.resolve(this.fetch((0,r.Z)({},t,{reset:!1,add:!1,remove:!1})))}.bind(this))},loadPreviousPage:function(e){var t=this;this.setLoading("previous");var i=e||{};return this.pagination.loadPrevious(i).then((function(e){var n=t.parse(e);return i.setPrevious&&i.setNext?t.set(n):t.add(n,{at:0}),t.setLoading("none"),n})).catch((function(e){throw t.setLoading("none"),e}))},loadNextPage:function(e){var t=this;this.setLoading("next");var i=e||{};return this.pagination.loadNext(i).then((function(e){var n=t.parse(e);return i.setPrevious&&i.setNext?t.set(n):t.add(n),t.setLoading("none"),n})).catch((function(e){throw t.setLoading("none"),e}))},loadFirstPage:function(e){var t=this;return this.setLoading("refresh"),this.pagination.loadFirst(e||{}).then((function(e){var i=t.parse(e);return i.length||t.trigger("empty"),t.set(i),t.setLoading("none"),i})).catch((function(e){throw t.setLoading("none"),e}))},loadLatestItems:function(){var e=this;return this.setLoading("refresh"),this.pagination.loadFirst({allowPrefetching:!1}).then((function(t){var i=e.parse(t);return e.add(i,{at:0}),e.setLoading("none"),i})).catch((function(t){throw e.setLoading("none"),t}))},hasPreviousPage:function(){return this.pagination.hasPrevious()},hasNextPage:function(){return this.pagination.hasNext()},setLoading:function(e){this._loading=e,this.trigger("loadingChanged",e)},loading:function(){return this._loading},isLoading:function(){return"none"!==this._loading}},{extend:function(e,t){var i=(0,r.Z)({},e,{defaultOptions:(0,y.Cn)((0,M.J$)(this.prototype.defaultOptions||{}),(0,M.J$)(e.defaultOptions||{})),optionTypes:(0,r.Z)({},this.prototype.optionTypes||{},e.optionTypes||{})});return x.extend.call(this,i,t)}})},UGpv:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("QbBG"),r=i("zIYZ");const a=n.Z.extend({displayName:"PureComponent",shouldViewUpdate:function(e,t){return!(0,r.w8)(this.options,e)||!(0,r.w8)(this.state,t)}})},"C/2N":(e,t,i)=>{"use strict";i.d(t,{ZP:()=>a});var n=function(e){var t=0;return e<.0031308?e>0&&(t=12.92*e):t=1.055*Math.pow(e,1/2.4)-.055,t},r=function(e){var t=0;return e<.04045?e>=0&&(t=e*(1/12.92)):t=Math.pow((e+.055)*(1/1.055),2.4),t};const a={linearToSrgb1:n,srgbToLinear1:r,linearToSrgb:function(e,t){var i=t||new Array(e.length);return i[0]=n(e[0]),i[1]=n(e[1]),i[2]=n(e[2]),i.length>3&&e.length>3&&(i[3]=e[3]),i},srgbToLinear:function(e,t){var i=t||new Array(e.length);return i[0]=r(e[0]),i[1]=r(e[1]),i[2]=r(e[2]),i.length>3&&e.length>3&&(i[3]=e[3]),i},encodeRGBM:function(e,t,i){i[3]=Math.min(1,Math.max(e[0]/t,i[1]/t,i[2]/t,1e-6)),i[3]=Math.ceil(255*i[3])/255;var n=1/(t*i[3]);return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i},decodeRGBM:function(e,t,i){var n=t*e[3];return i[0]=n*i[0],i[1]=n*i[1],i[2]=n*i[2],i},rgbToHex:function(e){var t=Math.round(255*e.r),i=Math.round(255*e.g);return"#"+(16777216|Math.round(255*e.b)|i<<8|t<<16).toString(16).substr(1)}}},"QG/p":(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("lZH+"),r=i.n(n);function a(){var e={},t=new(r())((function(t,i){e.resolve=t,e.reject=i}));return t.resolve=e.resolve,t.reject=e.reject,t.promise=t,t}},nEhO:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("Hjnd"),r=i.n(n),a=i("mSEu"),o=i("Oyie"),s=["<script>","  (function(d, s, id){","     var js, fjs = d.getElementsByTagName(s)[0];","     if (d.getElementById(id)) {return;}","     js = d.createElement(s); js.id = id;",'     js.src = "//connect.facebook.net/en_US/sdk.js";',"     fjs.parentNode.insertBefore(js, fjs);",'   }(document, "script", "facebook-jssdk"));',"<\/script>"].join(""),A=null;const g={getSDK:function(){return window.FB?o.resolve(window.FB):A||(A=new o((function(e){var t=r()(s);r()("body").append(t),window.fbAsyncInit=function(){window.FB.init({appId:a.Z.facebookAppId,status:!0,cookie:!0,xfbml:!0,version:a.Z.facebookApiVersion}),e(window.FB)}})))}}},O56b:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i("T4DV"),r=i("Wuy/"),a=i("k46e"),o=i("X9mO"),s=i("Hjnd"),A=i.n(s),g=i("R4My"),h=i.n(g),c=i("jpNh"),l=function(e,t){if(Array.isArray(e))this.shortcuts=e||[];else{if(!(0,n.Z)(e))throw new Error("Shortcut manager needs a shortcut object to function");this.shortcutGroup=e,this.shortcuts=e.shortcuts||[]}this.options=t||{},this.handlers={},this.options=(0,r.Z)({},this.options,{listen:!1}),this.options.listen&&this.listen()},u=new(i.n(c)());u.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&("button"===document.activeElement.tagName.toLowerCase()||("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.contentEditable&&"true"===t.contentEditable))},(0,a.Z)(l.prototype,h().Events),l.prototype.listen=function(e){void 0===e?this.shortcuts.forEach(this._listen.bind(this)):Array.isArray(e)?(this.shortcuts=this.shortcuts.concat(e),e.forEach(this._listen.bind(this))):this._listen(e)},l.prototype.stopListening=function(e){e.forEach(function(e){u.unbind(this._getShortcut(e).keyCombinations),delete this.handlers[e]}.bind(this))},l.prototype.getTitle=function(){return this.shortcutGroup&&this.shortcutGroup.name||""},l.prototype.getShortcut=function(e){return this.shortcuts.filter((function(t){return t.id===e}))[0]||""},l.prototype.getShortDescriptionById=function(e){var t="";return this.shortcuts.forEach(function(i){i.id===e&&(t=this._formatKeyCombination(i.keyCombinations).replace("<br />",""))}.bind(this)),t},l.prototype.generateHelpSection=function(){var e=A()("<div />"),t=this.getTitle();return t&&e.append('<span class="title">'+t+"</span>"),this.shortcuts.filter(this._validate).forEach(function(t){t.name&&e.append("<b>"+t.name+"</b>"),e.append(this._formatKeyCombination(t.keyCombinations))}.bind(this)),e.html()||""},l.prototype.hasKeyCombination=function(e){var t=!1;return this.shortcuts.forEach((function(i){t||(Array.isArray(i.shortcuts)?i.shortcuts.forEach((function(i){t=i===e})):t=i.shortcuts===e)})),t},l.prototype._formatKeyCombination=function(e){return[].concat(e).map((function(e){return"<kbd>"+e+"</kbd>"})).join(" or ")+"<br />"},l.prototype._listen=function(e){this._validate(e)&&!this.handlers[e.id]&&(this.handlers[e.id]=this._notify.bind(this,e),u.bind(e.keyCombinations,this.handlers[e.id]))},l.prototype._getShortcut=function(e){return(0,o.Z)(this.shortcuts,(function(t){return t.id===e}))},l.prototype._validate=function(e){return!!e.keyCombinations&&!!e.id},l.prototype._notify=function(e,t){this.trigger(e.id,e,t)};const d=l},"VKI/":(e,t,i)=>{"use strict";function n(e){var t=Array.prototype.slice.call(arguments,1),i=e.bind.apply(e,t);return i(),i}i.d(t,{Z:()=>n})},"QQD/":(e,t,i)=>{"use strict";var n=i("lZH+");i.n(n)().config({warnings:!1,longStackTraces:!1,cancellation:!0,monitoring:!1})},SM3V:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n=function(e){var t,i=window.WebKitBlobBuilder||window.MozBlobBuilder||window.BlobBuilder;t=e.split(",")[0].indexOf("base64")>=0?window.atob(e.split(",")[1]):window.decodeURI(e.split(",")[1]);for(var n,r=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),o=new Uint8Array(a),s=0;s<t.length;s++)o[s]=t.charCodeAt(s);if(void 0!==window.Blob)n=new Blob([o],{type:r});else if(void 0!==i){var A=new i;A.append(a),n=A.getBlob(r)}return n}},md6q:(e,t,i)=>{"use strict";function n(e){return(e=(e=(e=e.substring(e.lastIndexOf("/")+1)).split("."))[e.length>1?e.length-2:e.length-1]).split("_").pop().toLowerCase()}i.d(t,{Z:()=>n})},"2jst":(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("WGQk"),r=i("3XAv"),a="";(0,r.Z)()||(0,n.Z)()||(a+="?optimized=1");const o=function(e,t,i){var n="/i/models/"+t;if(e&&(n+="/"+e+a),i&&!window.prefetchedData[n])throw console.error("Missing prefetch "+n),new Error("Missing prefetch "+n);return n}},"7txH":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n,r=i("MQQR"),a=[{type:"VERTEX_SHADER",text:["attribute vec3 aPosition;","void main() {","gl_Position = vec4(aPosition, 1.0);","}"].join("\n")},{type:"FRAGMENT_SHADER",text:["#version 100","#ifdef GL_FRAGMENT_PRECISION_HIGH","  precision highp float;","#else"," precision mediump float;","#endif","uniform sampler2D uT0;","uniform sampler2D uT1;","uniform sampler2D uT2;","uniform sampler2D uT3;","uniform ivec4 uR;","varying vec2 vT;","varying vec3 vC;","varying vec3 vColor;","varying vec4 vColor2;","void f(in vec3 a, out vec3 b) {","b = 2.0 * a;","}","#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055","#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)","float linearTosRGB(const in float color) { return LIN_SRGB(color); }","vec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }","vec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }","void main(void) {","vec4 col;","col.r = linearTosRGB(vColor2.r);","col.rgb = linearTosRGB(vColor);","f(vC, col.xyz);","if ( uR.x == 3 ) {","  col.rgb = texture2D( uT0, vT ).aaa;","  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","} else if ( uR.x == 2 ) {","  col.rgb = texture2D( uT0, vT ).rgb;","  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","} else {","  col.r = uR.x == 0 ? texture2D( uT0, vT ).r : texture2D( uT0, vT ).a;","  col.g = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","  col.b = uR.z == 0 ? texture2D( uT2, vT ).r : texture2D( uT2, vT ).a;","  col.a = uR.w == 0 ? texture2D( uT3, vT ).r : texture2D( uT3, vT ).a;","}","gl_FragColor = gl_FrontFacing ? vec4(col.rgb, 1.0) : col;","}"].join("\n")}];function o(e){var t=e&&e.getExtension("WEBGL_lose_context");return t&&t.loseContext(),!0}function s(){if(void 0!==window.sketchfabWebGLSupport)return window.sketchfabWebGLSupport;if(n=!1,window.sketchfabWebGLSupport=n,!window.Set||!window.Map||!window.Uint8ClampedArray)return!1;var e=null;try{var t=["webgl","experimental-webgl"],i={antialias:!1},s=document.createElement("canvas");if(!s||!s.getContext)return!1;for(var A=0;A<t.length&&!(e=s.getContext(t[A],i));A++);if(!(e&&e.getParameter&&e.getExtension&&e.getShaderPrecisionFormat))return o(e)&&!1;var g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);if(!g||g<64)return o(e)&&!1;var h=e.getParameter(e.MAX_VARYING_VECTORS);if(!h||h<8)return o(e)&&!1;var c=e.getExtension("WEBGL_debug_renderer_info");if(c&&"Google SwiftShader"===e.getParameter(c.UNMASKED_RENDERER_WEBGL)&&!(0,r.Z)().allowSwiftShader)return o(e)&&!1;n=a.every((function(t){return function(e,t,i){var n=t;"string"==typeof n&&(n=e[t]);var r=e.createShader(n);return e.shaderSource(r,i),e.compileShader(r),!(!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost()&&(console.warn("Could't compile shader "+i),console.warn(e.getShaderInfoLog(r)),console.warn("You may want to consider a browser that fully supports WebGL."),1))}(e,t.type,t.text)})),o(e)}catch(t){return o(e)&&!1}return window.sketchfabWebGLSupport=n,n}},WGQk:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=!1;const r=function(e){return void 0!==e&&(n=e),n}},"+VSF":(e,t,i)=>{"use strict";i.d(t,{Z:()=>a,d:()=>r});var n=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS"),r=n&&navigator.userAgent.match("Version/15.0 Safari");const a=n},vrT6:(e,t,i)=>{"use strict";function n(e,t){var i,n,r=e.length,a=t.length,o=[];if(!r)return a;if(!a)return r;for(i=0;i<=r;i++)o[i]=[i];for(n=0;n<=a;n++)o[0][n]=n;for(n=1;n<=a;n++)for(i=1;i<=r;i++)e[i-1]===t[n-1]?o[i][n]=o[i-1][n-1]:o[i][n]=Math.min(o[i-1][n],o[i][n-1],o[i-1][n-1])+1;return o[r][a]}i.d(t,{Z:()=>n})},"57Pw":(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("mSEu"),r=i("g6dK"),a=i("tbFI");const o={showPopup:function(){var e=a.n2.store.getState(),t=a.wl.authUser.canAccessFeature("ff_read_only_mode",e),i="?utm_source=website&utm_campaign=maintenance_error",o=new r.Z({title:t?"Maintenance":"Error",text:t?'Sketchfab is undergoing maintenance.<br>See: <a href="https://forum.sketchfab.com/t/sketchfab-operations/6678'.concat(i," target=_blank>Operations forum post</a>"):'An unknown error occurred. Please try again later or <a href="'.concat(n.Z.hosts.faq,"/requests/new").concat(i,'&type=website" target="_blank">contact our support team</a> if the problem persists.'),buttons:{ok:!0},safe:!0});return o.open().then((function(){o.close()})),o}}},l5lH:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i("L0SH");const r=function e(t,i){var r,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,A=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,g=/^0x[0-9a-f]+$/i,h=/^0/,c=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},l=c(t).slice(0,50).replace(s,"")||"",u=c(i).slice(0,50).replace(s,"")||"",d=l.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),I=u.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),C=parseInt(l.match(g))||1!==d.length&&l.match(A)&&Date.parse(l),f=parseInt(u.match(g))||C&&u.match(A)&&Date.parse(u)||null;if(f){if(C<f)return-1;if(C>f)return 1}for(var p=0,m=Math.max(d.length,I.length);p<m;p++){if(r=!(d[p]||"").match(h)&&parseFloat(d[p])||d[p]||0,a=!(I[p]||"").match(h)&&parseFloat(I[p])||I[p]||0,isNaN(r)!==isNaN(a))return isNaN(r)?1:-1;if((0,n.Z)(r)!==(0,n.Z)(a)&&(r+="",a+=""),r<a)return-1;if(r>a)return 1}return 0}},lCzS:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n=i("R4My"),r=i.n(n),a=i("JBVY"),o=i("t3PY"),s=i("Bpah"),A=i("mSEu"),g=i("MQQR"),h=i("2jst"),c=i("Oyie"),l=function(e,t){var i=new(r().Model);return i.url=e+t,i.fetch().then((function(e){return window.prefetchedData[t]=e,e}))};const u=function(){var e=function(){if("dev"!==A.Z.buildMode){var e=!1;if(A.Z.prodHookRestrictedDomains.forEach((function(t){document.location.href.indexOf(t)>-1&&(e=!0)})),e)return}if(-1!==window.location.search.substr(1).indexOf("hook_")){for(var t,i="hook_".length,n=window.location.search.substr(1).split(o.BJ),r=0;r<n.length;++r){var s=n[r];if(-1!==s.indexOf("hook_")){t=s.substr(i,s.indexOf("=")-i);break}}if(t&&a.ZP.bool("hook_"+t))return"https://"+("prod"===t?"sketchfab.com":"fatvoxel"===t?"fatvoxel.com":t+".fatvoxel.com")}}();if(e){var t=(0,g.Z)().model;if(t){var i=function(e,t){for(var i=["","animations","backgrounds","environments","hotspots","matcaps","sounds","textures"],n=[],r=0;r<i.length;++r){var a=(0,h.Z)(i[r],t);n.push(l(e,a))}return c.all(n).then((function(i){var n=i[0].version;return l(e,"/i/models/".concat(t,"/versions/").concat(n.uid,"/options")).then((function(e){return i[0].options=e,new s.Z(i[0])}))}))}(e,t);s.Z.get=function(){return i}}}}},"9lp7":(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("Qbh+"),r=i("isBB"),a=i("KDlt"),o=i("QbBG"),s=i("lotc"),A=o.Z.extend({displayName:"UpgradePlanPopupContent",optionTypes:{popupSubTitle:s.Z.string.isRequired},events:{"click .upgrade-additional-callback":"additionalButtonCallback"},additionalButtonCallback:function(e){this.options.additionalButton&&"function"==typeof this.options.additionalButton.callback&&this.options.additionalButton.callback(e)},template:function(){return a.Z.getFromString('\n            {% if options.popupImg %}<div class="illustration --{{ options.popupImg }}"></div>{% endif %}\n            <p class="title">{{ options.popupSubTitle }}</p>\n            <div class="infos">\n                {% for message in options.popupMessages %}\n                    <p>{{message|safe}}</p>\n                {% endfor %}\n            </div>\n            <div class="actions">\n                {% if options.nextPlan %}\n                    <div class="btn-wrapper">\n                        <a class="button btn-huge btn-important upgrade-link" href="{{ url(\'pages:plans\') }}" target="_blank">Upgrade to {{ options.nextPlan }}</a>\n                    </div>\n                {% endif %}\n                {% if options.additionalButton %}\n                    <div class="btn-wrapper">\n                        <a class="button btn-large btn-primary upgrade-additional-callback"\n                        {% if options.additionalButton.href %}href="{{ options.additionalButton.href }}" target="_blank"{% endif %}>{{ options.additionalButton.text }}</a>\n                    </div>\n                {% endif %}\n            </div>\n            ',{options:this.options})}});const g=(0,n.Z)(o.Z.extend({template:function(){return a.Z.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:r.Z,options:{title:"",className:"upgrade-plan-popup",child:{viewClass:A,options:{popupImg:this.options.popupImg,popupSubTitle:this.options.popupSubTitle,popupMessages:this.options.popupMessages,nextPlan:this.options.nextPlan,additionalButton:this.options.additionalButton}}}}})})}}))},"1HPd":(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n=i("rX1A").Z.extend({events:{"click .close":"hide","touchstart .close":"hide"},show:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.removeClass("hidden")},hide:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.addClass("hidden")},isVisible:function(){return!this.el.classList.contains("hidden")}})},rX1A:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i("nv4P");const r=n.Z.extend({constructor:function(e){this.viewer=e.viewer,this.widgets=e.widgets,n.Z.apply(this,arguments)},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},isEnabled:function(){return this.$el.hasClass("disabled")}})},"OUQ+":(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("nv4P"),r=i("jQDz"),a=i("bvKJ"),o=i("Hjnd"),s=i.n(o),A=i("KDlt"),g=i("kAIv"),h=i("lotc");i("1sPI");const c=n.Z.extend({displayName:"Notification",optionTypes:{parent:h.Z.string,class:h.Z.string,content:h.Z.string,delay:h.Z.number},defaultOptions:{parent:".flashmessage-container"},events:{'click [data-action="close"]':"onClickClose"},template:function(){return A.Z.getFromMacro("skfb_front/macros/notification","flashmessage",[this.options.class,this.options.content,{safecontent:"True"}])},initialize:function(){n.Z.prototype.initialize.apply(this,arguments),this.render(),this.options.delay&&this.close(this.options.delay)},render:function(){this.$el.html((0,r.Z)(this,"template")),s()(this.options.parent).append(this.$el);var e=this.$el.find(".notification");e.addClass("hidden"),(0,a.Z)(e.removeClass.bind(e,"hidden"))},onClickClose:function(e){e&&e.preventDefault&&e.preventDefault(),this.close(0)},close:function(e){var t=this;e=e||0;var i=this.$el.find(".notification");return setTimeout((function(){i.addClass("hidden"),(0,g.Z)(i).then((function(){t.$el.parent()[0].removeChild(t.el)}))}),e),this}})},"/X5V":(e,t,i)=>{"use strict";i.d(t,{Z:()=>It});var n=i("Hjnd"),r=i.n(n),a=i("k46e"),o=i("lqp/"),s=i("Cgfs"),A=i("bvKJ"),g=i("Bpah"),h=i("TxBr"),c=i("mSEu"),l=i("5Eyw"),u=i.n(l),d=i("nv4P"),I=i("RyS8"),C=i("7txH"),f=i("WGQk"),p=i("R2Pi"),m=i("+VSF"),_=i("hDfq"),E=i("O56b"),v=i("1nxQ"),S=i("/c5M"),B=i("MQQR"),w=i("aWGP"),y=i("QR/4"),M=i("tjn4");const D=i("/K0U").Z.extend({}),b=M.Z.extend({model:D,parse:function(e){return e.results.images},url:function(){return"/i/models/"+this.options.uid+"/fallback"}});const Q=d.Z.extend({_isLoaded:!1,_context:null,isMoving:!1,startX:0,sensitivity:20,sprite:{current:0,steps:15,ratio:null,width:0},size:1,autospinTimer:null,events:{mousedown:"onMouseDown",mouseup:"onMouseUp","mousemove ":"onMouseMove",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove"},constructor:function(){this._boundResizeEvent=this.onWindowResize.bind(this),d.Z.prototype.constructor.apply(this,arguments)},initialize:function(){d.Z.prototype.initialize.apply(this,arguments),this.$viewport=r()(),this.$image=r()()},delegateEvents:function(){d.Z.prototype.delegateEvents.apply(this,arguments),r()(window).on("resize",this._boundResizeEvent)},undelegateEvents:function(){d.Z.prototype.undelegateEvents.apply(this,arguments),r()(window).off("resize",this._boundResizeEvent),this.autospinTimer&&clearInterval(this.autospinTimer)},isViewerReady:function(){return this._isLoaded},run:function(){var e=new y.Z;this._context=e,this.$el.show(),this.$el.siblings(".webgl").hide(),this.$el.siblings(".osd").hide();var t=this.model.get("uid"),i=this._fallbackCollection=new b([],{uid:t});return i.fetch().then(function(){i.length>0?this.displayFallback():this.displayNoFallbackError()}.bind(this)).catch(function(){this.displayNoFallbackError()}.bind(this)),this._isLoaded=!0,!0},getContext:function(){return this._context},getFeatures:function(){return{}},findBestImage:function(){for(var e,t=this._fallbackCollection.toJSON(),i=this.$el.height(),n=1/0,r=0,a=t.length;r<a;++r){var o=t[r],s=Math.abs(i-o.height);s<n&&(n=s,e=o)}return e},displayFallback:function(){this.$viewport=r()(".fallback-viewport"),this.$image=this.$viewport.find("img.fallback-sprite");var e=this.findBestImage(),t=e.url;this._currentHeight=e.height,this.$image.on("load",function(e){var t=e.target.naturalHeight,i=e.target.naturalWidth/this.sprite.steps;this.sprite.ratio=t?i/t:0,r()(e.target).css("display","block"),this.trigger("secondary-progress",{progress:1}),this.trigger("success"),this.displayFallbackWarning(),this.onWindowResize()}.bind(this)),this.$image.on("error",function(e){console.error("Fallback loading failed. URL : "+t+" ERROR : "+e.toString()),this.trigger("fail"),this.displayFallbackLoadingError()}.bind(this)),this.$image.attr("src",t)},displayFallbackLoadingError:function(){this.$el.find(".fallback-error-loading").show()},displayNoFallbackError:function(){this.$el.find(".fallback-error-nofallback").show()},displayFallbackWarning:function(){this._warningDisplayed||(this._warningDisplayed=!0,this.$el.find(".fallback-warning").show(),this.fallbackWarning=setTimeout(function(){this.$el.find(".fallback-warning").fadeOut()}.bind(this),1e4))},onWindowResize:function(){if(this._fallbackCollection.length){var e,t,i=this.$el.width(),n=this.$el.height(),r=i/n;this.findBestImage().height>this._currentHeight&&this.displayFallback(),2===this.size?r<this.sprite.ratio?(e=i,t=Math.floor(e/this.sprite.ratio)):(t=n,e=Math.floor(t*this.sprite.ratio)):r<this.sprite.ratio?(t=n,e=Math.floor(t*this.sprite.ratio)):(e=i,t=Math.floor(e/this.sprite.ratio)),this.$viewport.width(e).height(t).css({"margin-top":Math.round(-1*t/2),"margin-left":Math.round(-1*e/2)}),this.sprite.width=Math.round(this.$image.prop("scrollHeight")*this.sprite.ratio),this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)}},onMouseDown:function(e){e.preventDefault(),this.isMoving=!0,this.startX=e.clientX},onMouseMove:function(e){e.preventDefault(),this.move(e.clientX)},onMouseUp:function(e){e.preventDefault(),this.isMoving=!1},onTouchStart:function(e){e.preventDefault(),this.isMoving=!0;var t=e.originalEvent.touches[0];this.startX=t.clientX},onTouchMove:function(e){e.preventDefault(),this.move(e.originalEvent.touches[0].clientX)},onTouchEnd:function(e){e.preventDefault(),this.isMoving=!1},move:function(e){this.isMoving&&(this.autospinTimer&&this.stopAutospin(),e>this.startX+this.sensitivity&&(this.startX=e,this.moveRight()),e<this.startX-this.sensitivity&&(this.startX=e,this.moveLeft()))},moveRight:function(){0===this.sprite.current?this.sprite.current=this.sprite.steps-1:this.sprite.current=this.sprite.current-1,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},moveLeft:function(){this.sprite.current=(this.sprite.current+1)%this.sprite.steps,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},startAutospin:function(){this.autospinTimer=setInterval((0,w.Z)((function(){this.moveLeft()}),this),500)},stopAutospin:function(){clearInterval(this.autospinTimer),this.autospinTimer=null},toggleAutospin:function(){this.autospinTimer?this.stopAutospin():this.startAutospin()}});var x=i("vcih");const T=function(e){var t=r()(document);t.on("fullscreenchange",e),t.on("webkitfullscreenchange",e),t.on("MSFullscreenchange",e),t.on("mozfullscreenchange",e)},F=function(e){var t=r()(document);t.off("fullscreenchange",e),t.off("webkitfullscreenchange",e),t.off("MSFullscreenchange",e),t.off("mozfullscreenchange",e)},R=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled},N=function(){return document.fullScreen||document.mozFullScreen||void 0!==document.msFullscreenElement&&null!==document.msFullscreenElement||document.webkitIsFullScreen},L=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()},k=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()};var P=i("aMVL"),U=i("uKuv"),O=i("9lp7"),G=i("1HPd"),H=i("xKIK"),K=i("X9mO"),Z=i("nC8o"),V=i("D7W8"),Y=i("eKF4"),J=i("jQKg"),z=i("CTpj");var j=i("t3PY"),W=i("JBVY"),q=i("KDlt"),X=i("X40V"),$=i("ws/s"),ee=i("rX1A"),te=i("xr2m"),ie=i("pql+"),ne=i("UZbZ"),re=i("kAIv"),ae=(0,te.Z)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>">','   <p class="setting-label"><%= label %></p>',"</div>"].join("")),oe=(0,te.Z)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>" data-setting-type="<%= type %>">','   <p class="setting-label"><%= label %></p>','   <p class="setting-value" data-value="<%= value %>" ><%= prettyValue %></p>',"</div>"].join("")),se=(0,te.Z)(['   <a class="control-menu-back back">Back</a>','   <ul class="setting-list" data-setting="<%= name %>" data-setting-type="<%= type %>">',"       <%= listItems %>","   </ul>"].join("")),Ae=(0,te.Z)(['<li class="setting-item <% if (selected) { %>selected<% } %>" data-value="<%= value %>">',"   <%= prettyValue %>",'   <span class="shortcut" title="Keyboard shortcut"><%= shortcut %></span>',"</li>"].join(""));const ge=ee.Z.extend({events:{"click .setting":"onSettingClick","touchend .setting":"onSettingClick","click .back":"togglePane","touchend .back":"togglePane","click .setting-item":"onSettingValueClick","touchend .setting-item":"onSettingValueClick",'click [data-setting="viewerMode"] li':"onViewerModeChange",'touchend [data-setting="viewerMode"] li':"onViewerModeChange"},initialize:function(e){if(ee.Z.prototype.initialize.apply(this,arguments),this.settings=e.settings,this.viewer=e.viewer,(0,V.Z)(this.settings))return console.warn("No settings object given to SettingsMenu"),void this.$el.hide();this.$list=this.$(".control-menu-list"),this.$pane=this.$(".control-menu-pane"),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"]:not(.active)',this.onWireframeColorClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"].active',this.onDisableWireframeClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeEnable"]',this.onDisableWireframeClick.bind(this)),this.viewer.proxySettings.on("change",this.render.bind(this))},onViewerModeChange:function(e){e&&"touchend"===e.type&&e.preventDefault(),"0"===this.viewer.proxySettings.get("viewerMode")?this.viewer.subviews.osd.show("Click and hold to rotate",{position:"top",duration:3e3}):this.viewer.subviews.osd.show("Mouse to look around, keyboard to move",{position:"top",duration:3e3})},onDisableWireframeClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=this.$('.wireframe-colors [data-setting="wireframeEnable"]');this.viewer.proxySettings.set("wireframeEnable",!1),t.parent().find(".active").removeClass("active"),t.addClass("active")},onWireframeColorClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=r()(e.currentTarget),i=t.attr("data-value");this.viewer.proxySettings.set("wireframeColor",i),this.viewer.proxySettings.set("wireframeEnable",!0),t.parent().find(".active").removeClass("active"),t.addClass("active")},onSettingClick:function(e){e&&"touchend"===e.type&&e.preventDefault&&e.preventDefault();var t=r()(e.currentTarget).attr("data-setting"),i=this.settings[t];if(i.name=t,i.isButton)return this[i.action]&&this[i.action](e);this.renderSettingPane(i),this.togglePane(!0)},onSettingValueClick:function(e){e.preventDefault(),e.stopPropagation();var t=r()(e.currentTarget),i=t.attr("data-value"),n=t.closest("[data-setting]"),a=n.attr("data-setting");switch(n.attr("data-setting-type")||"string"){case"number":i=parseFloat(i);break;case"bool":i="true"===i}this.viewer.proxySettings.set(a,i)},onSettingChangeWhileOpen:function(){this.renderSettingPane(this._currentSetting)},renderSettingPane:function(e){var t,i="",n="string",r=this.viewer.proxySettings.get(e.name),a=this.getSettingFromValue(e.name,r),s=this.viewer._currentModel.get("options").shading.type;this._currentSetting&&this.viewer.proxySettings.off("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),this._currentSetting=e,this._currentSetting&&this.viewer.proxySettings.on("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),"shadingStyle"===e.name&&"lit"!==s||(0,o.Z)(e.settings,(function(e){i+=Ae({value:e.value,type:e.type||n,prettyValue:e.label,selected:a===e,shortcut:e.shortcut||""})})),t=(e.paneTemplate||se)({listItems:i,name:e.name,type:e.type||n,viewerSettings:this.viewer.proxySettings.toJSON()}),this.$pane.html(t);var A=this.viewer.scene.getFeatures().webVR.getModel();"viewerMode"!==this._currentSetting.name||A.get("hasNativeHMD")?this.$('[data-value="2"]').show():this.$('[data-value="2"]').hide()},getSettingFromValue:function(e,t){var i;return(this.settings[e].settings||[]).forEach((function(e){e.value!==t&&e.value+""!=t+""||(i=e)})),i},togglePane:function(e,t){var i=this;t&&"touchend"===t.type&&t.preventDefault(),this.$el.toggleClass("detail",e),(0,re.Z)(this.$(".control-menu-wrapper")).then((function(){i.$el.hasClass("detail")||i.clearPane()}))},clearPane:function(){this.$pane.html("")},render:function(){var e="",t=this.viewer.scene.getFeatures().quality.getModel(),i=this.viewer.scene.getFeatures().hotspot.getModel(),n=this.viewer.scene.getFeatures().animation.getModel(),r=[];(0,o.Z)(this.settings,(function(e,t){var i=(0,ie.Z)(e);i.name=t,r.push(i)})),r=(0,ne.Z)(r,"order"),(0,o.Z)(r,function(t){var i,n=t.name;if(t.isButton)i=ae({name:n,label:t.label,group:t.group});else{var r=this.getSettingFromValue(n,this.viewer.proxySettings.get(n))||t.settings[0];i=oe({name:n,label:t.label,value:r.value,prettyValue:r.label,group:t.group,type:r.type})}e+=i}.bind(this)),this.$list.html(e),ee.Z.prototype.render.apply(this,arguments),n&&n.get("animations").length?this.$('[data-setting-group="animation"]').show():this.$('[data-setting-group="animation"]').hide(),t&&t.get("promiseReady").isFulfilled()?this.$('[data-setting-group="textureQuality"]').show():this.$('[data-setting-group="textureQuality"]').hide(),i&&i.get("hotspots").length?this.$('[data-setting-group="annotation"]').show():this.$('[data-setting-group="annotation"]').hide(),t&&t.get("promiseReady").isFulfilled()&&window.requestAnimationFrame(function(){var e=this.getSettingFromValue("textureQuality",t.get("level"));this.$('[data-setting="textureQuality"] .setting-value').attr("data-value",e.value).text(e.label)}.bind(this))},onTextureQualityReady:function(e){var t=this.viewer.scene.getFeatures().quality;if(t)if(e.low||e.mid||e.high){var i=t.getModel().get("level");this.viewer.proxySettings.set("textureQuality",i),this.render()}else this.$('[data-setting="textureQuality"]').remove()}});var he=i("g6dK");function ce(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function le(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(i),!0).forEach((function(t){(0,H.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ce(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ue=c.Z.shortcuts;(0,B.Z)().uiInspector?(ue.inspectorControl.shortcuts[0].keyCombinations="1",ue.inspectorControl.shortcuts[1].keyCombinations="2",ue.inspectorControl.shortcuts[2].keyCombinations="3",ue.inspectorControl.shortcuts[3].keyCombinations="4",ue.inspectorControl.shortcuts[4].keyCombinations="6",ue.viewerRendering.shortcuts[0].keyCombinations="",ue.viewerRendering.shortcuts[1].keyCombinations="",ue.viewerRendering.shortcuts[2].keyCombinations="",ue.viewerRendering.shortcuts[3].keyCombinations="5"):(ue.inspectorControl.shortcuts[0].keyCombinations="",ue.inspectorControl.shortcuts[1].keyCombinations="",ue.inspectorControl.shortcuts[2].keyCombinations="",ue.inspectorControl.shortcuts[3].keyCombinations="",ue.inspectorControl.shortcuts[4].keyCombinations="");var de=new E.Z(ue.viewerRendering),Ie=function(e){var t=q.Z.getFromString('<a           class="{{ className }} {{ "active" if isActive else "" }}"           data-setting="{{ dataSetting }}"           data-value="{{ dataValue }}"           title="{{ title }}">        </a>');return q.Z.getFromString('<p class="wireframe-title">        Wireframe         <span class="shortcut" title="Keyboard shortcut">           {{ shortcut | safe }}        </span>        </p>        <div class="wireframe-colors">           {{ colorItems | safe }}        </div>')({shortcut:de.getShortDescriptionById("toggleWireframe"),colorItems:[{title:"Off",className:"colors-none",dataSetting:"wireframeEnable",dataValue:"0"},{title:"Black",className:"colors-black",dataSetting:"wireframeColor",dataValue:"000000FF"},{title:"White",className:"colors-white",dataSetting:"wireframeColor",dataValue:"ffffffFF"},{title:"Red",className:"colors-red",dataSetting:"wireframeColor",dataValue:"ff0000FF"},{title:"Blue",className:"colors-blue",dataSetting:"wireframeColor",dataValue:"0000FFFF"},{title:"Green",className:"colors-green",dataSetting:"wireframeColor",dataValue:"00FF00FF"},{title:"Yellow",className:"colors-yellow",dataSetting:"wireframeColor",dataValue:"FFFF00FF"}].map((function(i){return t(le(le({},i),{},{isActive:e.wireframeColor===i.dataValue}))})).join("")})},Ce={};(0,B.Z)().uiInspector||(Ce.shadingStyle={label:"Rendering",settings:[{label:"Lit",value:"lit",shortcut:de.getShortDescriptionById("defaultRenderingMode")},{label:"Shadeless",value:"shadeless",shortcut:de.getShortDescriptionById("shadelessRenderingMode")},{label:"MatCap",value:"matcap",shortcut:de.getShortDescriptionById("matcapRenderingMode")}],paneTemplate:function(e){var t=e.viewerSettings.hasWireframe,i=e.viewerSettings.wireframeColor;return q.Z.getFromString('    <div class="setting-list-header">               <a class="back control-menu-back">Back</a>               <span class="setting-list-header-help">Key</span>           </div>            <ul class="setting-list" data-setting="{{ name }}">                {{ listItems | safe }}            </ul>            {{ wireframe | safe }}',le(le({},e),{},{wireframe:t?Ie({wireframeColor:i}):""}))},order:2});const fe=ee.Z.extend({events:{"click .help":"onHelpClick","click .ar":"onArClick","click .vr":"onVrClick","click .fullscreen":"onFullscreenClick","click .theatre":"onTheatreClick","touchend .control.tooltip":"replaceDOMElement"},constructor:function(){this.fullScreenChange=this.fullScreenChange.bind(this),this.onVrClick=this.onVrClick.bind(this),this.onFullscreenClick=this.onFullscreenClick.bind(this),this.onTheatreClick=this.onTheatreClick.bind(this),this.onArClick=this.onArClick.bind(this),ee.Z.prototype.constructor.apply(this,arguments)},initialize:function(){ee.Z.prototype.initialize.apply(this,arguments),this.enableVR=!1,this.wasClicked=this.$el.parents(".model-container").hasClass("theatre"),!R()&&(0,z.Z)()&&window.self===window.top&&(this.viewer.$el.addClass("no-fullscreen"),this.viewer.$el.find(".controls .settings").addClass("shift-menu-left"));var e=window.innerWidth;try{e=window.parent.innerWidth}catch(e){}(0,X.Nc)({width:e,breakpoint:"breakpointMedium"})&&this.viewer.$el.find(".controls .general-controls .theatre").hide(),this._theatreActive="false"!==h.ZP.get("sb_theatre_mode","false"),this.viewer.$el.toggleClass("theatre-mode-active",this._theatreActive),this.viewer.on("model-loaded",this.updateNavigationSettings.bind(this)),this.generalControlsShortcuts=new E.Z(ue.generalControls),this.generalControlsShortcuts.on("fullscreen",this.onToggleFullScreen,this),this.generalControlsShortcuts.listen([this.generalControlsShortcuts.getShortcut("fullscreen")])},delegateEvents:function(){ee.Z.prototype.delegateEvents.apply(this,arguments),this.onFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.on("change",this.renderSettings,this),this.viewer.on("model-loaded",this.setModelListeners.bind(this))},undelegateEvents:function(){if(ee.Z.prototype.undelegateEvents.apply(this,arguments),!this.$el)return this;this.offFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.off("change",this.renderSettings,this),this.viewer.on("model-loaded",this.removeModelListeners.bind(this))},setModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").on("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.listenTo(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},removeModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").off("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.stopListening(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},setHasAnimations:function(e){this.hasAnimations=e},getSettingLabelForValue:function(e,t){return(0,K.Z)(Ce[e].settings,(function(e){return e.value===t})).label},getEmbedUrl:function(e){var t=W.ZP.craft(le(le({},(0,j.Qc)(location.search)),e));return this.viewer._currentModel.get("embedUrl")+"?"+t},onHelpClick:function(e){e.preventDefault(),e.stopPropagation(),this.viewer.subviews.helpOverlay.show()},generateTextureQualitySettings:function(e){Ce.textureQuality={label:"Textures",group:"textureQuality",settings:[{label:"LD",value:"0"},{label:"SD",value:"1"},{label:"HD",value:"2"}],order:5};var t=0;["low","mid","high"].forEach(function(i,n){e[i]||(Ce.textureQuality.settings.splice(n-t,1),t++)}.bind(this)),(0,Z.Z)(Ce.textureQuality.settings).label="HD",this.renderSettings()},updateNavigationSettings:function(){this.viewer.scene.getFeatures().camera.getModel().get("useCameraConstraints")?delete Ce.viewerMode:Ce.viewerMode||(Ce.viewerMode={label:"Navigation",settings:[{label:"Orbit",value:"0"},{label:"First Person",value:"1"}],order:4}),this.renderSettings()},renderSettings:function(){(0,V.Z)(Ce)?this.$(".control.settings").hide():(this.$(".control.settings").show(),this.settings||(this.settings=new ge({el:this.$(".settings-menu"),viewer:this.viewer,settings:Ce})),this.settings.render())},getQrCode:function(){if((0,B.Z)().uiArQrcode){var e=document.getElementById("qrCode"),t=J.Z.getArRedirectionUrl(this.viewer._currentModel.get("uid"));return Promise.all([i.e(6565),i.e(4161),i.e(316)]).then(i.t.bind(i,"jGum",19)).then((function(i){return i.toCanvas(e,t,(function(e){e&&console.error(e)}))}))}},getPlatform:function(){var e=p.default.apple.device,t=p.default.android.device;if(e){var i=function(){try{return parseInt(navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/)[1],10)}catch(e){console.error(e)}}(),n=document.createElement("a");return i>=11||n.relList&&n.relList.supports("ar")?"ios":"mobileIos"}return t?function(){try{return parseInt(navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/i)[1],10)}catch(e){console.error(e)}}()>=7?"android":"mobileAndroid":"others"},openArDesktopInstructions:function(){this.viewer._currentModel.sharing().then(function(){var e=this.viewer._currentModel.get("sharing").shortUrl;this.viewer.subviews.arOverlayDesktop.setUrl(e),this.viewer.subviews.arOverlayDesktop.show()}.bind(this))},openArMobileInstructions:function(e,t){this.viewer.subviews.arOverlayMobile.setPlatform(e),this.viewer.subviews.arOverlayMobile.setMinVersion(t),this.viewer.subviews.arOverlayMobile.show()},setArLoaderListener:function(){var e=this;document.addEventListener("visibilitychange",(function t(){e.viewer.subviews.arOverlayLoading.hide(),document.removeEventListener("visibilitychange",t,!1)}),!1)},onArClick:function(e){var t=this;e.stopPropagation();var i=this.getPlatform(),n=this.viewer._currentModel.get("viewerUrl"),r=this.viewer._currentModel.get("name");"ios"===i?(this.viewer.subviews.arOverlayLoading.show(),this.setArLoaderListener(),m.Z||setTimeout(function(){this.viewer.subviews.arOverlayLoading.hide()}.bind(this),1e4),J.Z.getModelArEnterprise(i,this.viewer._currentModel.id).then((function(e){var t=document.createElement("a"),i=document.createElement("img");t.href=e.url,t.rel="ar",t.appendChild(i),t.click()})).catch((function(e){t.viewer.subviews.arOverlayLoading.hide(),t.viewer.subviews.arOverlayErrorMessage.show(),console.error(e)}))):"android"===i?(this.viewer.subviews.arOverlayLoading.show(),this.setArLoaderListener(),J.Z.getModelArEnterprise(i,this.viewer._currentModel.id).then((function(e){var t=e.url;window.location.href="intent://arvr.google.com/scene-viewer/1.0?file="+encodeURIComponent(t)+"&mode=ar_preferred&link="+encodeURIComponent(n)+"&title="+encodeURIComponent(r)+"#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;S.browser_fallback_url=https://developers.google.com/ar;end;"})).catch((function(e){t.viewer.subviews.arOverlayLoading.hide(),t.viewer.subviews.arOverlayErrorMessage.show(),console.error(e)}))):"mobileIos"===i?this.openArMobileInstructions("iOS","11"):"mobileAndroid"===i?this.openArMobileInstructions("Android","7"):(this.getQrCode(),this.openArDesktopInstructions())},onVrClick:function(e){var t=this,i=function(){t.widgets.hotspots&&(t.widgets.hotspots.hideTooltips(),t.widgets.hotspots.currentHotspot=-1,t.widgets.hotspots.renderControl());var i=t.viewer.scene.getFeatures().webVR.getModel();if(i.on("presentVrFailed",function(){this.openVrInstructions()}.bind(t)),t.viewer.scene.getViewerOSGJS().isVRSupported()&&!p.default.apple.device){if(t.viewer.scene.getViewerOSGJS().needsVRPolyFill()){var n=new $.Z({message:"Initializing VR ..."});return n.open(),void t.viewer.scene.getViewerOSGJS().loadWebxrPolyFill().then(function(){var t=this,i=new he.Z({title:"Ready",text:'Press the "Enter VR" button to proceed.',buttons:{ok:!0,okLabel:"Enter VR"}});n.replaceWith(i),i.getPromise().then((function(){return t.onVrClick(e)}))}.bind(t)).catch(function(){n.hide(),this.openVrInstructions()}.bind(t))}i.set("enable",!i.get("enable"))}else p.default.any?(i.set("cardboard",!0),t.fullscreenVR(e),i.set("enable",!i.get("enable"))):t.openVrInstructions()};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){"granted"===e&&i()})).catch((function(){alert("Accelerometer permission couldn't be granted. Please try again at a later time.")})):i(),e.stopPropagation()},openVrWindow:function(){this.viewer._currentModel&&window.open(this.getEmbedUrl({cardboard:1,autostart:1}),"skfbCardboard","menubar=no,toolbar=no")},openVrInstructions:function(){this.viewer._currentModel.sharing().then(function(){this.viewer.subviews.helperVrOverlay.setUrl(this.getEmbedUrl({cardboard:1,autostart:1})),this.viewer.subviews.helperVrOverlay.show()}.bind(this))},isTheatreActive:function(){return this._theatreActive},onTheatreClick:function(e){e.stopPropagation(),e.preventDefault();var t=this.isTheatreActive(),i=Y.Z.me().get("isAnonymous")&&!this.wasClicked;this.wasClicked=!0,this.viewer.trigger(t&&!i?"leaveTheatreMode":"enterTheatreMode");try{t&&!i?window.parent.postMessage("leaveTheatreMode","*"):window.parent.postMessage("enterTheatreMode","*")}catch(e){}return h.ZP.set("sb_theatre_mode",!t),this.viewer.$el.toggleClass("theatre-mode-active",!t),this._theatreActive=!t,!1},onFullscreenClick:function(e,t){e.stopPropagation(),this.onToggleFullScreen(t)},onToggleFullScreen:function(e){R()?N()?k():L(this.viewer.el):e?this.openVrWindow():this.openFakeFullscreen()},openFakeFullscreen:function(){this.viewer._currentModel&&(p.default.any?window.open(this.getEmbedUrl()):window.open(this.getEmbedUrl(),"skfbFullscreenFallback","menubar=no,toolbar=no"))},onFullScreenChange:function(e){T(e)},offFullScreenChange:function(e){F(e)},fullScreenChange:function(){r()('[data-action="fullscreen"] > .icon').toggleClass("icon-fullscreen-icon").toggleClass("icon-fullscreen-off-icon"),this.viewer.$el.toggleClass("fullscreen",N()),this.viewer.scene.trigger("resizeViewerOnNextFrame",-1,-1);var e=this.viewer.scene.getFeatures().webVR;if(e){var t=e.getModel();N()?!0===this.enableVR&&t.set("enable",!0):!0===this.enableVR&&(t.set("enable",!1),this.enableVR=!1)}},fullscreenVR:function(e){return this.enableVR=!0,this.onFullscreenClick(e,!0)},replaceDOMElement:(0,s.Z)((function(e){var t=e.target.parentElement,i=e.target.nextSibling;t&&(t.removeChild(e.target),(0,A.Z)((function(){t.insertBefore(e.target,i)})))}),2e3)});var pe={passive:!0};const me=ee.Z.extend({VIEWER_MODE_ORBIT:0,VIEWER_MODE_FPS:1,HOTSPOT_CYCLE_PAUSE:1e4,events:{"click .has-menu":"toggleMenu","touchstart .has-menu":"toggleMenuTouch",keydown:"onKeydown","mousedown  .webgl .canvas":"cameraMoveStart","touchstart .webgl .canvas":"cameraMoveStart","mousedown  .webgl":"mouseDownEvent","touchstart .webgl":"mouseDownEvent","mousedown  .fallback":"mouseDownEvent","touchstart .fallback":"mouseDownEvent"},constructor:function(){this.globalCloseEvent=this.globalCloseEvent.bind(this),this.globalMouseUpEvent=this.globalMouseUpEvent.bind(this),this.onKeydown=this.onKeydown.bind(this),this.onMousewheel=this.onMousewheel.bind(this),ee.Z.prototype.constructor.apply(this,arguments)},delegateEvents:function(){ee.Z.prototype.delegateEvents.apply(this,arguments);var e=r()(document);e.on("keydown",this.onKeydown),e.on("mousedown",this.globalCloseEvent),e.on("mouseup",this.globalMouseUpEvent),e.on("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll),document.addEventListener("wheel",this.onMousewheel,pe)},undelegateEvents:function(){ee.Z.prototype.undelegateEvents.apply(this,arguments);var e=r()(document);e.off("keydown",this.onKeydown),e.off("mousedown",this.globalCloseEvent),e.off("mouseup",this.globalMouseUpEvent),e.off("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll),document.removeEventListener("wheel",this.onMousewheel,pe)},enable:function(){this.$(".gui").removeClass("hidden"),(0,A.Z)(function(){this.$(".gui").addClass("enabled")}.bind(this))},disable:function(){this.$(".gui").removeClass("enabled").addClass("hidden")},closeMenus:function(){this.$(".gui").find(".has-menu").removeClass("active"),this.viewer.subviews.generalControls&&this.viewer.subviews.generalControls.settings&&this.viewer.subviews.generalControls.settings.togglePane(!1)},cameraMoveStart:function(){this.viewer.$(".webgl").addClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots.pauseHotspotCycleInterval()},cameraMoveEnd:function(){this.viewer.$(".webgl").removeClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspotCycleIntervalPaused&&this.viewer.subviews.hotspots.beginHotspotCycleInterval(this.HOTSPOT_CYCLE_PAUSE)},onMousewheel:function(){if(this.viewer.scene){var e=this.viewer.scene.getFeatures();if(Object.prototype.hasOwnProperty.call(e,"camera"))if(e.camera.getModel().get("indexManipulator")===this.VIEWER_MODE_FPS){var t=this.viewer.scene.getViewerOSGJS().getManipulator().getCurrentManipulator()._stepFactor,i=Math.round(t/4*100);this.viewer.subviews.osd.show("Walking speed: "+i,{duration:1e3})}}},onKeydown:function(e){var t=document.activeElement,i="";32===e.which&&t&&(i=t.tagName,-1!==["BODY","CANVAS"].indexOf(i)&&(this.recenter(),e.preventDefault())),e.which>=96&&e.which<=105&&this.timeline&&this.timeline.setCurrentAnimation(e.which-96),27===e.which&&(this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspots.length&&(this.viewer.subviews.hotspots.currentHotspot=-1,this.viewer.subviews.hotspots.applyCurrentHotspot(),this.viewer.subviews.hotspots.unrevealHotspots(),this.viewer.subviews.hotspots.stopHotspotCycleInterval()),this.closeMenus(),this.viewer.subviews.helpOverlay.hide())},preventParentScroll:function(e,t){var i=r()(".hotspot-controls .list"),n=i.height(),a=i.children()[0].scrollHeight,o=i.children()[0].scrollTop;(o===a-n&&t<0||0===o&&t>0)&&e.preventDefault()},preventScroll:function(e){e.preventDefault()},globalMouseUpEvent:function(){this.cameraMoveEnd()},globalCloseEvent:function(e){r()(e.target).hasClass("has-menu")||r()(e.target).parents(".has-menu").length||this.closeMenus(e)},toggleMenuTouch:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation(),this.toggleMenu(e)},toggleMenu:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation();var t=r()(e.currentTarget);t.hasClass("active")?e.currentTarget===e.target&&t.attr("data-title",t.attr("title")).removeClass("active"):(this.closeMenus(),t.attr("title",t.attr("data-title")).removeAttr("data-title").addClass("active"))},renderSetting:function(e,t){this.viewer.$('[data-setting="'+e+'"]').removeClass("active"),"wireframeColor"===e&&!1===this.viewer.proxySettings.get("wireframeEnable")||this.viewer.$('[data-setting="'+e+'"][data-value="'+t+'"]').addClass("active")},getPointerPosition:function(e){var t,i=e.originalEvent?e.originalEvent:e,n={};return i.touches&&i.touches.length||i.changedTouches&&i.changedTouches.length?(t=(t=i.touches&&i.touches.length?i.touches:i.changedTouches)[0],n.x=t.pageX,n.y=t.pageY,n.type="Touch"):(n.x=e.pageX,n.y=e.pageY,n.type="Mouse"),n},mouseDownEvent:function(e){this.mouseDownPosition=this.getPointerPosition(e),this.viewer.subviews.hint.hide(),"touchstart"===e.type&&(e.target===e.currentTarget||this.scene&&this.scene.getCanvas&&e.target===this.viewer.scene.getCanvas())&&e.preventDefault()},recenter:function(){this.viewer.scene&&this.viewer.scene.getViewerOSGJS().getManipulator().computeHomePosition()}}),_e=ee.Z.extend({events:{"click .close":"close"},close:function(e){e&&e.preventDefault&&e.preventDefault()}});var Ee=i("uo4Z"),ve=c.Z.shortcuts;const Se=G.Z.extend({displayName:"HelpOverlay",mixins:[(0,Ee.Z)(".tabs-container")],events:{"click .tabs a":"onTabClick","touchstart .tabs a":"onTabClick",'click [data-action="reset-camera"]':"onResetCameraClick",'touchstart [data-action="reset-camera"]':"onResetCameraClick"},initialize:function(){G.Z.prototype.initialize.apply(this,arguments),this.generalShortcuts=new E.Z(ve.generalControls),this.renderingShortcuts=new E.Z(ve.viewerRendering),this.annotationShortcuts=new E.Z(ve.annotationControl),this.animationShortcuts=new E.Z(ve.animationControl),this.soundShortcuts=new E.Z(ve.sound),this.inspectorShortcuts=new E.Z(ve.inspectorControl),this.render()},onResetCameraClick:function(e){e.preventDefault(),this.hide(),this.viewer.scene.getFeaturesManager().focusOnSavedCamera(2),(0,A.Z)((function(e){e.target.blur()}),e)},render:function(){var e=this.renderingShortcuts.generateHelpSection(),t=this.generalShortcuts.generateHelpSection(),i=this.animationShortcuts.generateHelpSection(),n=this.annotationShortcuts.generateHelpSection(),r=this.inspectorShortcuts.generateHelpSection(),a=this.soundShortcuts.generateHelpSection();this.$(".rendering-shortcuts").html(e),this.$(".general-shortcuts").html(t),this.$(".animation-shortcuts").html(i),this.$(".annotation-shortcuts").html(n),this.$(".inspector-shortcuts").html(r),this.$(".sound-shortcuts").html(a)},onTabClick:function(e){e.preventDefault();var t=r()(e.currentTarget),i=t.attr("data-target"),n=this.$("[data-tab].active"),a=this.$('[data-tab="'+i+'"]');this.$(".tabs li").removeClass("active"),t.parent().addClass("active"),n.removeClass("active"),a.addClass("active")}});var Be=i("Wuy/");const we=ee.Z.extend({initialize:function(){ee.Z.prototype.initialize.apply(this,arguments),this.$hint=this.$(".viewer-hint");var e=p.default.any?"touch &amp; drag<br>to rotate":"click &amp; hold<br>to rotate";this.$hint.find(".viewer-movehint .label").html(e),this.options.fallback&&this.$hint.addClass("fallback-position")},show:function(e){e=(0,Be.Z)((0,a.Z)({},e),{force:!1});var t=1===h.ZP.get("sf_show_viewer_hint",1),i=(0,B.Z)().uiHint;2===i&&(e.force=!0),(e.force||1===i&&t)&&this.$hint.addClass("active")},hide:function(e){e=(0,Be.Z)((0,a.Z)({},e),{remember:!0}),this.$hint.removeClass("active"),e.remember&&h.ZP.set("sf_show_viewer_hint",0,{expires:15552e6})}});var ye=i("3pbp");const Me=G.Z.extend({mixins:[ye.Z,(0,Ee.Z)(".js-scrollable")],setModel:function(e){this.model=e,this.render()},render:function(){this.model&&(this.$(".hotspot-title").html((0,v.sanitize)(this.model.get("name"))),this.$(".hotspot-content").html(this.model.get("content").rendered),this.handleLazyLoading())}});var De=i("aqzA"),be=i("lotc"),Qe=De.Z.osg,xe=new(u())({device:"VWR"});const Te=ee.Z.extend({optionTypes:{color:be.Z.string},reset:function(){this._primaryProgress=0,this._secondaryProgress=0},handleLoading:function(e){e.scene.on("primary-progress",function(e){if(this.setPrimaryProgress(e.progress),(0,B.Z)().isApp){var t=xe.createMessage({data:{progress:e.progress+""}});this.previousMessage&&this.previousMessage.removeFromHash(),t.appendToHash(),this.previousMessage=t}}.bind(this)),e.scene.on("secondary-progress",function(e){this.setSecondaryProgress(e.progress)}.bind(this)),e.scene.on("success",function(){this.viewer.$el.removeClass("model-loading").addClass("model-loaded"),e.model.trigger("status:loaded"),this.trigger("loaded")}.bind(this)),e.scene.on("fail",function(){Qe.error("Viewer instanciation failed")}.bind(this))},setPrimaryProgress:function(e){this._primaryProgress=Math.min(Math.max(this._primaryProgress,e),1),this.updateMainProgressBar(),1===this._primaryProgress&&this.setSecondaryProgress(0)},setSecondaryProgress:function(e){this._secondaryProgress=Math.min(Math.max(0,e),1),this.updateSecondaryProgressBar()},updateMainProgressBar:function(){var e=this._primaryProgress,t=1===e;this.$(".main-progress").toggleClass("loading",!t),this.$(".main-progress-display__progress").css({width:100*e+"%"}),this.$(".main-progress-percentage").text(Math.floor(100*e)+" %")},updateSecondaryProgressBar:function(){var e=this._secondaryProgress;this.$(".secondary-progress-percentage").text(Math.floor(100*e)+" %"),this.$(".secondary-progress-display").css("width",100*e+"%");var t=1===this._primaryProgress,i=1===e;this.$(".secondary-progress").toggleClass("visible",t&&!i)}});var Fe=i("wgEG"),Re=i("3+4K"),Ne=i("p7Vz"),Le=i("yCA5"),ke=i("UGpv"),Pe=i("W4lT"),Ue=(i("qeHZ"),i("45Yh")),Oe=i("p5Lb");function Ge(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function He(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(i),!0).forEach((function(t){(0,H.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ge(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const Ke=ke.Z.extend({displayName:"Dropdown",mixins:[(0,Ee.Z)('[data-ref="menu"]'),Le.Z],optionTypes:{child:be.Z.component.isRequired,labelTitle:be.Z.string,labelValue:be.Z.string,longestLabelValue:be.Z.string,placeholder:be.Z.string,color:be.Z.string,className:be.Z.string,theme:be.Z.oneOf(["dark","light","white-background","grey-background"]),menuAlign:be.Z.oneOf(["left","right"]),disabled:be.Z.bool,withBackground:be.Z.bool,grey:be.Z.bool},defaultOptions:{color:"",theme:"light",menuAlign:"left",disabled:!1,withBackground:!1,grey:!1},events:{'click [data-action="toggle-menu"]:not([data-disabled="true"])':"onToggle","click window":"onWindowClick","resize window":"setMenuPosition"},state:{isOpen:!1},viewDidMount:function(){this.setMenuPosition()},viewDidUpdate:function(){this.setMenuPosition()},onToggle:function(){this.setState({isOpen:!this.state.isOpen})},onWindowClick:function(e){!(0,Ue.Ub)(this.el,e.target)&&this.state.isOpen&&this.setState({isOpen:!1})},setMenuPosition:function(){var e=this.el.getBoundingClientRect(),t=this.refs.menu.getBoundingClientRect();this.refs.$menu.css({bottom:-Math.min(0,window.innerHeight-(e.bottom+t.height+10)),right:"right"===this.options.menuAlign?Math.min(0,e.right-(t.width+10)):"auto",left:"left"===this.options.menuAlign?Math.min(0,window.innerWidth-(e.left+t.width+10)):"auto"})},scrollToHeightPercent:function(e){var t=this.refs.$menu.prop("scrollHeight");this.refs.$menu.scrollTop((0,Oe.vX)(0,1,e)*t)},template:function(){var e=this;return q.Z.getFromMacro("skfb_front/macros/components/atoms/dropdown","dropdown",[{isOpen:this.state.isOpen&&!this.options.disabled,labelTitle:this.options.labelTitle,labelValue:this.options.labelValue,longestLabelValue:this.options.longestLabelValue,placeholder:this.options.placeholder,color:this.options.color,disabled:this.options.disabled,withBackground:this.options.withBackground,grey:this.options.grey,theme:this.options.theme,className:this.options.className,components:this.createChildrenComponents({child:[].concat(this.options.child).map((function(t,i){return He(He({},t),{},{options:He(He({},t.options),{},{key:t.options.key||i,dropdown:{isOpen:e.state.isOpen,onToggle:e.onToggle.bind(e),scrollToHeightPercent:e.scrollToHeightPercent.bind(e)}})})}))})}])}});var Ze=(0,Ne.Z)((function(e,t){return e+t})),Ve=function(e,t){return(0,Pe.zy)(e,{},(function(e){return e.value===t}))},Ye=ke.Z.extend({displayName:"DropdownOptionList",mixins:[Le.Z],optionTypes:{value:be.Z.string.isRequired,options:be.Z.arrayOf(be.Z.shape({title:be.Z.string.isRequired,value:be.Z.string.isRequired,default:be.Z.bool}).isRequired).isRequired,onSelectOption:be.Z.func.isRequired,dropdown:be.Z.shape({isOpen:be.Z.bool.isRequired,onToggle:be.Z.func.isRequired,scrollToHeightPercent:be.Z.func.isRequired}).isRequired,color:be.Z.string,theme:be.Z.string,closeOnSelection:be.Z.bool},events:{'click [data-action="select-option"]':"onOptionClick",'mouseenter [data-action="select-option"]':"onMouseEnterOption",'mouseleave [data-action="select-option"]':"onMouseLeaveOption","keydown window":"onWindowKeyDown"},viewDidMount:function(){this.updateScrollPosition()},viewDidUpdate:function(){this.updateScrollPosition()},getSelectedIndex:function(){return this.options.options.indexOf(Ve(this.options.options,this.options.value))},onOptionClick:function(e){this.options.onSelectOption(e.target.getAttribute("data-value")),this.options.closeOnSelection&&this.options.dropdown.isOpen&&this.options.dropdown.onToggle()},onMouseEnterOption:function(e){e.target.style.color=this.options.color},onMouseLeaveOption:function(e){e.target.getAttribute("data-active")||(e.target.style.color="")},onWindowKeyDown:function(e){this.options.dropdown.isOpen&&this.options.options.length&&(38!==e.which&&40!==e.which||e.preventDefault(),38===e.which&&this.selectIndex(Ze(-1)),40===e.which&&this.selectIndex(Ze(1)))},selectIndex:function(e){var t=this.getSelectedIndex(),i=this.options.options.length,n=(i+e(t))%i;this.options.onSelectOption(this.options.options[n].value),this.scrollAtNextRender=!0},scrollToSelectedOption:function(){var e=(this.getSelectedIndex()-1)/this.options.options.length;this.options.dropdown.scrollToHeightPercent(e)},updateScrollPosition:function(){this.scrollAtNextRender&&(this.scrollAtNextRender=!1,this.scrollToSelectedOption())},template:function(){return q.Z.getFromString(["<ul class=\"c-dropdown-select {{ '--' + theme + '-theme' if theme else '' }}\">","    {% for optionItem in options %}","        {% set isActive = optionItem.value == value %}","        <li",'            class="c-dropdown-select__option {{ {',"                '--active': isActive",'            } | class_names }}"','            style="{{ {',"                'color': color if isActive else ''",'            } | style }}"','            {% if isActive %} data-active="true" {% endif %}','            data-value="{{ optionItem.value }}"','            data-action="select-option">',"            {{ optionItem.title }}","        </li>","    {% endfor %}","</ul>"].join("\n"),{options:this.options.options,value:this.options.value,color:this.options.color,theme:this.options.theme})}});const Je=ke.Z.extend({displayName:"DropdownSelect",optionTypes:{value:be.Z.string.isRequired,onChange:be.Z.func.isRequired,options:be.Z.arrayOf(be.Z.shape({title:be.Z.string.isRequired,value:be.Z.string.isRequired,default:be.Z.bool}).isRequired).isRequired,title:be.Z.string,placeholder:be.Z.string,color:be.Z.string,theme:be.Z.oneOf(["dark","light","white-background","grey-background"]),menuAlign:be.Z.oneOf(["left","right"]),disabled:be.Z.bool,closeOnSelection:be.Z.bool,autoScale:be.Z.bool},defaultOptions:{theme:"light",closeOnSelection:!0,autoScale:!1},initialize:function(){ke.Z.prototype.initialize.apply(this,arguments);var e=this.getDefaultValue();!this.options.value&&e&&this.options.onChange(e)},getDefaultValue:function(){return(0,Pe.zy)(this.options.options,{},(function(e){return e.default})).value},template:function(){return q.Z.getFromString("{{ components.dropdown | component }}",{components:this.createChildrenComponents({dropdown:{viewClass:Ke,options:{disabled:this.options.disabled,labelTitle:this.options.title,labelValue:Ve(this.options.options,this.options.value).title,longestLabelValue:this.options.autoScale?this.options.options.reduce((function(e,t){return e.length>t.title.length?e:t.title}),""):"",placeholder:this.options.placeholder,color:this.options.color,theme:this.options.theme,className:this.options.className,menuAlign:this.options.menuAlign,child:{viewClass:Ye,options:{value:this.options.value,options:this.options.options,color:this.options.color,theme:this.options.theme,closeOnSelection:this.options.closeOnSelection,onSelectOption:this.options.onChange}}}}})})}});var ze=i("KGKI");function je(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function We(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?je(Object(i),!0).forEach((function(t){(0,H.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):je(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var qe=(0,i("ULsr").Z)(ze.Z),Xe=c.Z.shortcuts,$e={render:{title:"Render ("+Xe.inspectorControl.shortcuts[0].keyCombinations+")",displayViews:[{text:"Final Render",icon:"viewer-icon-final-render",value:"Default",has2dView:!1},{text:"No Post-Processing",icon:"viewer-icon-final-render",value:"DefaultNoPostProcess",has2dView:!1}]},animation:{title:"Animation ("+Xe.inspectorControl.shortcuts[4].keyCombinations+")",displayViews:[{text:"Bones",icon:"viewer-icon-bones",value:"Bones",has2dView:!0},{text:"Bones Influence",icon:"viewer-icon-influences",value:"BoneWeights",has2dView:!0}]},materials:{title:"Material channels ("+Xe.inspectorControl.shortcuts[1].keyCombinations+")",displayViews:[{text:"Albedo",icon:"viewer-icon-diffuse",value:"DiffusePBR",has2dView:!0},{text:"Base Color",icon:"viewer-icon-diffuse",value:"AlbedoPBR",has2dView:!0},{text:"Diffuse",icon:"viewer-icon-diffuse",value:"DiffuseColor",has2dView:!0},{text:"Specular",icon:"viewer-icon-specular",value:"SpecularPBR",has2dView:!0},{text:"Metalness",icon:"viewer-icon-metalness",value:"MetalnessPBR",has2dView:!0},{text:"Specular Color",icon:"viewer-icon-specular",value:"SpecularColor",has2dView:!0},{text:"Glossiness",icon:"viewer-icon-roughness",value:"GlossinessPBR",has2dView:!0},{text:"Anisotropy",icon:"viewer-icon-normal-map",value:"Anisotropy",has2dView:!0},{text:"Roughness",icon:"viewer-icon-roughness",value:"RoughnessPBR",has2dView:!0},{text:"Specular Glossiness",icon:"viewer-icon-specular",value:"SpecularHardness",has2dView:!0},{text:"Scattering",icon:"viewer-icon-subsurface",value:"SubsurfaceScattering",has2dView:!0},{text:"Translucency",icon:"viewer-icon-subsurface",value:"SubsurfaceTranslucency",has2dView:!0},{text:"Normal Map",icon:"viewer-icon-normal-map",value:"NormalMap",has2dView:!0},{text:"Bump Map",icon:"viewer-icon-normal-map",value:"BumpMap",has2dView:!0},{text:"AO map",icon:"viewer-icon-AO",value:"AOPBR",has2dView:!0},{text:"Cavity",icon:"viewer-icon-AO",value:"CavityPBR",has2dView:!0},{text:"Lightmap",icon:"viewer-icon-lightmap",value:"DiffuseIntensity",has2dView:!0},{text:"Displacement",icon:"viewer-icon-displacement",value:"Displacement",has2dView:!0},{text:"Opacity",icon:"viewer-icon-transparency",value:"Opacity",has2dView:!0},{text:"Alpha Masking",icon:"viewer-icon-transparency",value:"AlphaMask",has2dView:!0},{text:"Emission",icon:"viewer-icon-emission",value:"EmitColor",has2dView:!0},{text:"Specular F0",icon:"viewer-icon-specular",value:"SpecularF0",has2dView:!0},{text:"Vertex Color",icon:"viewer-icon-diffuse",value:"VertexColor",has2dView:!0},{text:"Vertex Alpha",icon:"viewer-icon-transparency",value:"VertexAlpha",has2dView:!0},{text:"Clear Coat",icon:"viewer-icon-specular",value:"ClearCoat",has2dView:!0},{text:"Clear Coat Roughness",icon:"viewer-icon-roughness",value:"ClearCoatRoughness",has2dView:!0},{text:"Clear Coat Normal Map",icon:"viewer-icon-normal-map",value:"ClearCoatNormalMap",has2dView:!0},{text:"Sheen",icon:"viewer-icon-specular",value:"Sheen",has2dView:!0},{text:"Sheen Roughness",icon:"viewer-icon-roughness",value:"SheenRoughness",has2dView:!0}]},geometry:{title:"Geometry ("+Xe.inspectorControl.shortcuts[2].keyCombinations+")",displayViews:[{text:"Matcap",icon:"viewer-icon-final-render",value:"MatcapFlat",has2dView:!1},{text:"Matcap+Surface",icon:"viewer-icon-final-render",value:"MatcapDetail",has2dView:!1},{text:"Wireframe",icon:"viewer-icon-geometry",value:"Wireframe",has2dView:!0},{text:"Vertex Normals",icon:"viewer-icon-vertex-normals",value:"VertexNormal",has2dView:!1}]},uv:{title:"UV ("+Xe.inspectorControl.shortcuts[3].keyCombinations+")",displayViews:[{text:"UV Checker",icon:"viewer-icon-UV",value:"UVChecker",has2dView:!0}]}},et=q.Z.getFromString('\n        <div class="model-inspector__wireframe">\n            {{ wireframe | safe }}\n        </div>\n        <div class="model-inspector__single-sided-button"></div>\n        {{ components.singleSidedButton | component }}\n        {% if inspectableTextures or isStaff %}\n            <div class="mode__title">Viewport{%if not inspectableTextures and isStaff %} (Staff only){% endif %}</div>\n            <div class="toggle-button{%if not inspectableTextures and isStaff %} --staff{% endif %}">\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="3d" id="splitType-3d">\n                    <label for="splitType-3d">3D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="split" id="splitType-split">\n                    <label for="splitType-split">3D + 2D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="2d" id="splitType-2d">\n                    <label for="splitType-2d">2D</label>\n                </span>\n            </div>\n        {% endif %}\n       {% for category, mode in modes %}\n            {% if mode.displayViews %}\n                <div class="mode__title">{{ mode.title }}</div>\n            {% endif %}\n            <ul>\n                {% for button in mode.displayViews %}\n                    <li                        class="mode {{ "selected" if button.value == active else "" }}" data-mode="{{ mode.title }}" data-value="{{ button.value }}"\n                        style="{{ button.style }}"\n                    >\n                        <i class="mode__icon {{ button.icon }}"></i>\n                        <span>{{ button.text }}</span>\n                    </li>\n                    {% endfor %}\n            </ul>\n       {% endfor %}\n    '),tt=["displayView","material","splitType","texCoord","forceSingleSided"],it={displayView:"Default",forceSingleSided:!1,splitType:"3d"};const nt=ee.Z.extend({mixins:[(0,Ee.Z)(".js-scrollable")],children:{singleSidedButton:{selector:".model-inspector__single-sided-button",viewClass:qe,options:function(){var e=this;return{"data-selenium":"single-sided",children:"Single Sided",value:Boolean(this.model.get("forceSingleSided")),onChange:function(t){return e.model.set("forceSingleSided",t)}}}},materialSelector:{selector:".model-inspector__2D-options .model-inspector__material-options",viewClass:Je,shouldCreateChild:function(){return this.canInspectTextures()&&"3d"!==this.model.get("splitType")},options:function(){var e=this;return{theme:"dark",value:this.model.get("material").toString(),onChange:function(t){return e.model.set("material",t)},options:this.model.get("materialList").filter((function(e){return!e.uidUniqueMerged})).map(function(e){var t=e.uidListUnusedDuplicates.length?"Merged ("+e.name+", ...)":e.name;return{title:this.model.materialHasTextureInView2d(e.uid)?t:t+" (no texture)",value:e.uid}}.bind(this)).sort((function(e,t){return e.title<t.title?-1:e.title>t.title?1:void 0})),closeOnSelection:!1,autoScale:!0}}},UVSelector:{selector:".model-inspector__2D-options .model-inspector__UV-options",viewClass:Je,shouldCreateChild:function(){return this.canInspectTextures()&&this.model.getCurrentUVs().length>1},options:function(){return{theme:"dark",value:this.model.get("texCoord").toString(),onChange:function(e){this.model.set("texCoord",e)}.bind(this),options:this.model.getCurrentUVs().sort((function(e,t){return e-t})).map((function(e){return{title:"UV "+e.toString(),value:e.toString()}})),closeOnSelection:!1,autoScale:!0}}}},events:{"click .mode":"onSelectDisplayView","click .model-inspector__minimize":"toggleVisibility",'click [name="splitType"]':"onSelectSplitType","click [data-setting]":"changeWireframe"},initialize:function(){ee.Z.prototype.initialize.apply(this,arguments),this.initializeShortcuts(),this.updateModes(),this.updateSavedState(),this._selectors=this.$(".model-inspector__2D-options"),this.render(),this._selectors.css({visibility:"hidden"})},delegateEvents:function(){ee.Z.prototype.delegateEvents.apply(this,arguments),this.model.on("change:displayView",this.updateDisplayViewUI,this),this.model.on("change:material change:texCoord change:displayView change:forceSingleSided",this.renderChildren,this),this.model.on("change:material change:displayView change:splitType",this.update2DView,this),this.model.on("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.on("change:uiVisible",this.show,this)},undelegateEvents:function(){ee.Z.prototype.undelegateEvents.apply(this,arguments),this.model.off("change:displayView",this.updateDisplayViewUI,this),this.model.off("change:material change:texCoord change:displayView change:forceSingleSided",this.renderChildren,this),this.model.off("change:material change:displayView change:splitType",this.update2DView,this),this.model.off("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.off("change:uiVisible",this.show,this)},updateModes:function(){var e=this.model.get("availableDisplayView");this.modes=(0,Fe.Z)($e,(function(t,i,n){var r=i.displayViews.filter((function(t){return-1!==e.indexOf(t.value)}));if(0===r.length)return t;var o=(0,a.Z)({},i,{displayViews:r});return t[n]=o,t}),{}),this.modeNamesWith2d=(0,Fe.Z)(this.modes,(function(e,t){var i=t.displayViews.filter((function(e){return e.has2dView})).map((function(e){return e.value}));return e.concat(i)}),[])},changeWireframe:function(e){var t=e.currentTarget.dataset.setting,i=e.currentTarget.dataset.value;if("wireframeEnable"===t){var n=!this.options.wireframeModel.get("wireframeEnable");return this.options.wireframeModel.set("wireframeEnable",n)}this.options.wireframeModel.set("wireframeEnable",!0),this.options.wireframeModel.set(t,i)},onSelectDisplayView:function(e){var t=e.currentTarget.getAttribute("data-value");this.model.set("displayView",t)},canInspectTextures:function(){return this.options.inspectableTextures||Y.Z.me().get("isStaff")},_currentModeHas2dView:function(){var e=this.model.get("displayView");return-1!==this.modeNamesWith2d.indexOf(e)},_getDisplayViewLabel:function(){return this.$el.find("[data-value="+this.model.get("displayView")+"]").text().trim()},updateDisplayViewUI:function(){this.$el.find(".selected").removeClass("selected"),this.$el.find("[data-value="+this.model.get("displayView")+"]").addClass("selected")},updateAvailableDisplayView:function(){this.updateModes(),-1===this.model.get("availableDisplayView").indexOf(this._savedState.displayView)&&(this._savedState.displayView="Default"),this.render()},update2DView:function(){if(this.canInspectTextures())if(this.updateSelectorsUI(),"3d"===this.model.get("splitType")||this.model.materialHasContentInView2d(this.model.get("material")))this.$el.find(".model-inspector__empty-2d-view").text("");else{var e=this.model.get("materialByUid")[this.model.get("material")].name,t=this.$el.find(".model-inspector__empty-2d-view"),i="2d"===this.model.get("splitType")?"50%":"25%",n="";n=this._currentModeHas2dView()?"No data in "+e+"/"+this._getDisplayViewLabel():"2D view isn't available for "+this._getDisplayViewLabel()+".<br>Select a Material Channel to view textures.",t.text(n).css("right",i)}},updateSelectorsUI:function(){"3d"!==this.model.get("splitType")&&this._currentModeHas2dView()?this._selectors.css({visibility:"visible"}):this._selectors.css({visibility:"hidden"})},onSelectSplitType:function(e){this.canInspectTextures()&&this.model.set("splitType",e.currentTarget.getAttribute("data-value"))},initializeShortcuts:function(){var e=new E.Z(Xe.inspectorControl),t=this.onShortcut.bind(this),i=function(){this.toggle()}.bind(this);e.on("render materials geometry uv animation",t),e.on("inspector",i),e.listen()},onShortcut:function(e){var t=this.modes[e.id];if(t){var i=this._savedState.displayView,n=(0,Re.Z)(t.displayViews,(function(e){return e.value===i})),r=(n+1)%t.displayViews.length,a=t.displayViews[r];this.model.get("uiVisible")?this.options.osd.hide():(0,f.Z)()?this.model.set("uiVisible",!0):this.options.osd.show(a.text,{duration:1e3}),this.model.set("displayView",a.value),this.updateSavedState()}},close:function(){this.$el.removeClass("--show"),this.updateSavedState(),this.model.set(it)},show:function(e,t){this.$el.toggleClass("--show --open",t)},restoreState:function(){this.model.set(this._savedState)},updateSavedState:function(){var e=this;this._savedState=tt.reduce((function(t,i){return We(We({},t),{},(0,H.Z)({},i,e.model.get(i)))}),{})},toggle:function(){this.model.get("uiVisible")?(this.model.set("uiVisible",!1),this.close()):(this.model.set("uiVisible",!0),this.restoreState())},toggleVisibility:function(){this.$el.toggleClass("--open")},render:function(){var e=this.viewer.proxySettings.get("setting.name");this.$(".model-inspector__modes").html(et({inspectableTextures:this.options.inspectableTextures,modes:this.modes,active:this.model.get("displayView"),wireframe:Ie({wireframeColor:e}),isStaff:Y.Z.me().get("isStaff")})),this.renderChildren(),this.afterRender()},afterRender:function(){this.$('[data-value="'+this.model.get("splitType")+'"]').prop("checked",!0)}}),rt=ee.Z.extend({events:{"click .osd":"hide"},show:function(e,t){this.osdTimeout&&window.clearTimeout(this.osdTimeout),t=(0,a.Z)({position:"center"},t);var i=this.$(".osd");i.find(".osd-content").html(e),i.addClass("active"),i.removeClass("osd-top osd-center"),i.addClass("osd-"+t.position),t.duration&&(t.duration=Math.max(0,t.duration),t.duration!==1/0&&(this.osdTimeout=setTimeout(this.hide.bind(this),t.duration)))},hide:function(){this.$(".osd").removeClass("active")}});var at=i("sg6w"),ot=i("WjOL"),st=i("SM3V"),At=i("Oyie"),gt=De.Z.osg;const ht=ee.Z.extend({events:{"mouseover .snapshot .button":"showGuides","mouseout .snapshot .button":"hideGuides"},initialize:function(){ee.Z.prototype.initialize.apply(this,arguments),this.$el.find(".snapshot .button").on("click",this.onSnapshot.bind(this))},onSnapshot:function(e){var t=this.viewer.scene;e.preventDefault();var i=this.$el.find(".snapshot"),n=this.$el.find(".snapshot-flash"),r=this.$el.find(".img-container");if(!i.hasClass("progress")){i.addClass("progress"),n.addClass("active"),setTimeout((function(){n.removeClass("active")}),2e3);var a=!0,o=t.getFeatures();if(o.camera){o.camera.getModel().saveCameraPosition();var s=t.getFeatures().saveUI;s||((s=new ot.Z).init(t.getFeaturesManager()._context),s._views[0].enableSaving()),a=s._views[0].save()}At.all([t.getScreenShot(1920,1080),a]).then(this.onTakeScreenshot.bind(this,i,r))}},onTakeScreenshot:function(e,t,i){var n=i[0].toDataURL("image/jpeg"),r=(0,st.Z)(n),a=new at.Z({imageFile:r}),o=this.viewer._currentModel,s=a.save({modelUID:o.get("uid")}),A=t.find("img");A&&(A.remove(),null!==this.previewTimeout&&(window.clearTimeout(this.previewTimeout),this.previewTimeout=null));var g=new Image;g.src=n,t.prepend(g),t.removeClass("invisible"),this.previewTimeout=setTimeout((function(){t.addClass("invisible")}),4e3),s.then((function(){e.removeClass("progress"),e.addClass("success"),setTimeout((function(){e.removeClass("success")}),2e3)})).catch((function(){new he.Z({title:"Save settings error",text:"An unexpected error happened. The thumbnail has NOT been saved.",buttons:{ok:!0}}).open(),gt.error("Error while saving snapshot"),e.removeClass("progress")}))},showGuides:(0,s.Z)((function(){this.$(".snapshot-guides").addClass("active")}),100),hideGuides:(0,s.Z)((function(){this.$(".snapshot-guides").removeClass("active")}),100)});var ct=i("yCZG");const lt=ee.Z.extend({_isHover:!1,events:{touchstart:"onTouchStart",mousedown:"onClick",mouseover:"onMouseover",mouseout:"onMouseout",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(){ee.Z.prototype.initialize.apply(this,arguments),this.previousValue=null,this._touched=!1,this.$icon=this.$(".fa"),this.listenTo(this.model,"change:volume",this.render.bind(this)),this.render(),this.$volumeMenu=this.$(".volume-menu"),this.slider=new ct.Z(void 0,{model:this.model,global:!0,orientation:"vertical"}),this.$volumeMenu.append(this.slider.$el),this.initializeShortcuts()},delegateEvents:function(){ee.Z.prototype.delegateEvents.apply(this,arguments),r()(window).on("mouseup.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this)),r()(window).on("touchend.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this))},undelegateEvents:function(){ee.Z.prototype.undelegateEvents.apply(this,arguments),r()(window).off(".delegateEvents"+this.cid)},initializeShortcuts:function(){this.soundControlShortcuts=new E.Z(c.Z.shortcuts.sound),this.soundControlShortcuts.on("mute",this.toggleMute.bind(this)),this.soundControlShortcuts.listen()},onTouchStart:function(){this._touched=!0},onClick:function(e){e.preventDefault();var t=r()(e.target);t.is(".volume-menu")||t.parents(".volume-menu").length||this.toggleMute()},onMouseEnter:function(){this._isHover=!0},onMouseLeave:function(){this._isHover=!1},toggleMute:function(){this.slider.onoff()},togglePane:function(e){this.$el.toggleClass("--active",e)},onMouseover:function(){this._touched?this._touched=!1:this.togglePane(!0)},onMouseout:function(){!1===this.slider.started&&this.togglePane(!1)},onVolumeInteractionEnd:function(){this.model.get("enable")&&(this._isHover||this.togglePane(!1))},show:function(){this.viewer.$el.addClass("sound-enabled")},hide:function(){this.viewer.$el.removeClass("sound-enabled")},render:function(){var e=this.model.get("volume");return this.$icon.toggleClass("fa-volume-up",e>=.5),this.$icon.toggleClass("fa-volume-down",e>0&&e<.5),this.$icon.toggleClass("fa-volume-off",0===e),this}});var ut=c.Z.shortcuts,dt=new(u())({device:"WEB",listen:!0});const It=d.Z.extend({subviews:{},events:{'click [data-action="start"]':"onStart",'click [data-action="stop"]':"onStop",click:"globalCloseEvent",touchend:"globalCloseEvent",'click [data-action="inspector"]':"toggleInspector",'click [data-action="ascii"]':"toggleASCII"},initialize:function(){d.Z.prototype.initialize.apply(this,arguments),this.canDisplay3D=(0,C.Z)()&&!(0,B.Z)().forceFallback,this.proxySettings=new g.Z({shadingStyle:null,viewerMode:null,wireframeColor:null,wireframeEnable:null,hasWireframe:null,annotationsVisible:null,textureQuality:null,speed:null,cycleMode:null,fps:null}),this.initializeMandatorySubviews(),this.initializeHashMessages(),this.initializeSoundManager(),this.delegateGlobalMoveEvent(),this.delegateSubviews(),this.isVR()&&p.default.apple.device&&this.hackIosCanvasRender(),p.default.any||!m.Z||(0,B.Z)().transparent||this.hackDesktopSafariCanvasBackground()},_createSubview:function(e,t,i){return this.subviews[e]=new t((0,a.Z)({},{viewer:this,widgets:this.subviews},i)),this.subviews[e]},globalCloseEvent:function(e){r()(e.target).hasClass("has-menu")||r()(e.target).parents(".has-menu").length||(this.subviews.hotspots&&this.subviews.hotspots.toggleAnnotationList(!1),this.subviews.gui.closeMenus())},delegateGlobalMoveEvent:function(){if(!(0,f.Z)()){var e="mousedown touchstart",t="mouseup touchend";this.$el.on(e,function(e){"CANVAS"===e.target.tagName&&this.el.classList.add("moving")}.bind(this)),this.$el.on(t,function(e){var t=this;"CANVAS"===e.target.tagName&&(e.preventDefault(),clearTimeout(this._mouseupStopTimeout),this._mouseupStopTimeout=setTimeout((function(){t.el.classList.contains("moving")&&t.el.classList.remove("moving")}),1e3))}.bind(this)),this.$el.on("mousemove touchmove wheel ".concat(e," ").concat(t),this.removeIdle.bind(this)),P.Z.getAllAnimations().then(this.setIdleTimeout.bind(this)),this.$el.on("wheel",function(e){"canvas"===e.target.tagName.toLowerCase()&&(this.el.classList.add("moving"),clearTimeout(this._mousewheelStopTimeout),this._mousewheelStopTimeout=setTimeout(function(){this.el.classList.remove("moving")}.bind(this),300))}.bind(this))}},setIdleTimeout:function(){this.globalIdleTimeout=setTimeout(this.onGlobalIdleTimeout.bind(this),this.el.classList.contains("moving")?4500:3500)},removeIdle:function(){clearTimeout(this.globalIdleTimeout),this.el.classList.contains("idle")&&(this.el.classList.remove("idle"),(0,o.Z)(this.subviews,(function(e){e.trigger("idle",!1)}))),this.setIdleTimeout.call(this)},preventScroll:function(e){if(e.target.classList.contains("canvas"))return e.preventDefault();var t=void 0!==e.target.dataset.hotspotTarget;this.subviews&&this.subviews.helpOverlay&&!this.subviews.helpOverlay.isVisible()&&!t&&e.preventDefault()},onGlobalIdleTimeout:function(){(0,f.Z)()||(this.el.classList.add("idle"),(0,o.Z)(this.subviews,(function(e){e.trigger("idle",!0)})))},initializeMandatorySubviews:function(){this._createSubview("gui",me,{el:this.$el}),this._createSubview("loading",Te,{el:this.$(".loading-container")}),this._createSubview("hint",we,{el:this.$el,fallback:!this.canDisplay3D}),this._createSubview("generalControls",fe,{el:this.canDisplay3D?this.$(".general-controls"):this.$(".fallback .controls"),fallback:!this.canDisplay3D}),this._createSubview("header",_e,{el:this.$(".titlebar")}),this._createSubview("snapshot",ht,{el:this.$el}),this._createSubview("helpOverlay",Se,{el:this.$(".help.overlay")}),this._createSubview("hotspotsOverlay",Me,{el:this.$(".hotspots-overlay")}),this._createSubview("arOverlayDesktop",G.Z.extend({setUrl:function(e){this.$(".url").attr("href",e).text(e)}}),{el:this.$(".ar-overlay-desktop")}),this._createSubview("arOverlayMobile",G.Z.extend({setPlatform:function(e){this.$(".mobilePlatform").text(e)},setMinVersion:function(e){this.$(".minVersion").text(e)}}),{el:this.$(".ar-overlay-mobile")}),this._createSubview("arOverlayLoading",G.Z.extend({}),{el:this.$(".ar-overlay-loading")}),this._createSubview("arOverlayErrorMessage",G.Z.extend({}),{el:this.$(".ar-overlay-error")}),this._createSubview("helperVrOverlay",G.Z.extend({setUrl:function(e){this.$(".url").attr("href",e)}}),{el:this.$(".helper-vr-overlay")}),this._createSubview("osd",rt,{el:this.$el})},initShortcuts:function(){this.viewerRenderingShortcuts=new E.Z(ut.viewerRendering),this.viewerRenderingShortcuts.on("toggleWireframe",function(){if(this.proxySettings.get("hasWireframe")&&(0,B.Z)().uiInspector){var e=!this.proxySettings.get("wireframeEnable");this.proxySettings.set("wireframeEnable",e)}}.bind(this)),this.viewerRenderingShortcuts.on("inspector",this.toggleInspector,this),this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("toggleWireframe"),this.viewerRenderingShortcuts.getShortcut("inspector")]),this.viewerRenderingShortcuts.on("defaultRenderingMode",function(){this.proxySettings.set("shadingStyle","lit")}.bind(this)),this.viewerRenderingShortcuts.on("shadelessRenderingMode",function(){this.proxySettings.set("shadingStyle","shadeless")}.bind(this)),this.viewerRenderingShortcuts.on("matcapRenderingMode",function(){this.proxySettings.set("shadingStyle","matcap")}.bind(this)),this.updateShorcuts()},updateShorcuts:function(){"lit"===this._currentModel.get("options").shading.type||(0,f.Z)()?this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("defaultRenderingMode"),this.viewerRenderingShortcuts.getShortcut("shadelessRenderingMode"),this.viewerRenderingShortcuts.getShortcut("matcapRenderingMode")]):this.viewerRenderingShortcuts.stopListening(["defaultRenderingMode","shadelessRenderingMode","matcapRenderingMode"])},blurHotspots:function(){this.subviews.hotspots&&(this.subviews.hotspots.hideTooltips(),this.subviews.hotspots.currentHotspot=-1,this.subviews.hotspots.renderControl())},initializeHashMessages:function(){(0,B.Z)().isApp&&dt.on("message:vrMode",function(e){var t=parseInt(e.data.vrMode,10);this.blurHotspots(),this.scene.getFeatures().webVR.getModel().set("enable",!!t),e.removeFromHash()}.bind(this))},initializeHotspotsSubviews:function(e){var t=this;Promise.all([i.e(2698),i.e(7341),i.e(1572),i.e(5513),i.e(3729),i.e(1567),i.e(6028)]).then(i.bind(i,"jDby")).then((function(i){var n=i.default,r=t.scene.getFeatures().hotspot.getModel();(t._createSubview("hotspots",n,{el:t.$el,model:r,container:t.$(".hotspots"),fallback:!t.canDisplay3D}),0===(0,B.Z)().annotationTooltipVisible)&&t.subviews.hotspots.hideTooltips();"function"==typeof e&&e()}))},initializeAnimationSubviews:function(e){var t=this;i.e(2177).then(i.bind(i,"+uiz")).then((function(i){var n=i.default,r=t.scene.getFeatures().animation.getModel();t._createSubview("animationControls",n,{el:t.$(".animation-controls"),model:r,currentModel:t._currentModel,enabled:!t.isVR()}),"function"==typeof e&&e()}))},delegateSubviews:function(){this.isVR()?(this.subviews.gui.disable(),this.subviews.header.disable()):(this.subviews.loading.on("loaded",setTimeout.bind(window,this.subviews.gui.enable.bind(this.subviews.gui),500)),this.subviews.header.enable()),this.subviews.loading.on("loaded",function(){(0,B.Z)().transparent||this.el.classList.add("transparent-pattern")}.bind(this))},onStart:function(){this.start(),this._startTracked||(this._startTracked=!0)},start:function(){this.el.classList.add("started"),this.el.classList.contains("transparent")||this.el.classList.add("transparent-pattern"),this._options&&this.load();var e=this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS();return e&&P.Z.getHasAnimation().then(function(t){if(t){var i=this.scene.getFeatures().animation.getModel();this._wasPlaying&&(i.set("playing",!0),this._wasPlaying=void 0)}e.run()}.bind(this)),x.Z.setEnabled(!0),this.trigger("started"),this},onStop:function(){this.subviews.modelInspector&&(this.subviews.modelInspector.close(),r()(".summary").removeClass("shifted"),r()(".watermark").removeClass("shifted-watermark")),this.stop()},stop:function(){this.el.classList.remove("started");var e=this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS();return e&&(P.Z.getHasAnimation().then(function(e){if(e){var t=this.scene.getFeatures().animation.getModel();this._wasPlaying=t.get("playing"),this._wasPlaying&&t.set("playing",!1)}}.bind(this)),e.stop()),this.subviews.hotspots&&this.subviews.hotspots.triggerHotspotCycle(!1),x.Z.setEnabled(!1),this.trigger("stopped"),this},load:function(){if(this._options){var e=this._options;this._options=null,this.scene&&(this.scene.drop(),this.scene=null),this.subviews.loading.reset(),this.el.classList.remove("model-loaded"),this.el.classList.add("model-loading"),g.Z.get(e.uid).then(this.onModelLoad.bind(this,e)).catch((function(e){console.warn(e)}))}},lookat:function(e,t,i){void 0===i&&(i=1);var n=this.scene.getFeatures().camera.getModel();n.set("animationDuration",i),n.setTargetAndEye(t,e)},isVR:function(){return this.scene?this.scene.getFeatures().webVR.getModel().get("enable"):(0,B.Z)().cardboard>0},isCardboard:function(){return(0,B.Z)().cardboard>0},onModelLoad:function(e,t){S.Z.client.configureScope((function(e){e.setTag("frontend","3d")})),this._currentModel=t,t.hit(),this.scene=this.createScene(t,e);var i=this.scene;this.subviews.loading.handleLoading({model:t,scene:i}),i.run(),this.canDisplay3D?(this.initShortcuts(),this.initViewerFeatures(),this.subviews.hint.show(),this.trigger("model-loaded"),S.Z.client.configureScope((function(e){e.setTag("frontend","web")}))):this.el.classList.add("fallback-mode")},errorHandler:function(e){if(e instanceof I.r){var t,n,r,o,s,A=(0,_.Jw)(e.account);switch(e.feature){case"sound":n="sound track",r="sounds",s=e.limit===c.Z.maxSoundtracksPerModel.ent;break;case"hotspot":n="annotation",r="annotations",s=e.limit===c.Z.maxHotspotsPerModel.ent;break;default:throw e}if(s)o=["You have reached the maximum number of <b>"+n+"s</b> allowed by Sketchfab.","Have custom needs?"],t={text:"Contact us",callback:function(e){e.preventDefault(),Promise.all([i.e(6952),i.e(9041)]).then(i.bind(i,"AVrK")).then((function(e){return new e.default({title:"Get in touch"}).open()}))}};else{var g=e.value?e.value-e.limit:0;o=["You have reached the maximum number of <b>"+e.limit+" "+n+v.pluralize(e.limit)+"</b> allowed by your plan.","To add a new "+n+", you need to "+(g?" delete "+g+" "+n+v.pluralize(e.limit)+" or ":"")+"upgrade to "+A+" plan."],t={href:"/plans",text:"Upgrade to "+A}}new O.Z((0,a.Z)(e,{popupSubTitle:"You cannot add a new "+n,popupMessages:o,additionalButton:t,popupImg:r})).open()}else this.subviews.osd.show(e.message,arguments)},setScene:function(e){if(this.scene)throw new Error("It is currently impossible to reset a scene");return this._options=e,this._currentUid=e.uid,this},createScene:function(e,t){if(this.canDisplay3D){var i={};return i.el=this.$(".webgl"),i.features=t.features,i.widgetAPI=t.widgetAPI,i.model=e,i.viewerAPI=t.viewerAPI,new U.Z(i)}return new Q({model:e,el:this.$(".fallback"),features:t.features})},initViewerFeatures:function(){this.initializeSound(),P.Z.getModelDisplayed().then(function(){P.Z.getHasAnimation().then(function(e){e&&this.initializeAnimation()}.bind(this)),this.initializeHotspots(),this.initializeShading(),this.initializeViewerMode(),this.initializeTextureQuality(),this.initializeVr(),this.initializeModelInspector()}.bind(this))},initializeHotspots:function(){var e=this.scene.getFeatures().hotspot,t=e&&e.getModel();t&&this.initializeHotspotsSubviews(function(){var e=this.subviews.hotspots;t.setUpdateCallback(e.refreshHotspots.bind(e));var i=t.get("hotspots");i.on("add remove sort change:title change:description change:position",e.refreshHotspots,e),i.on("add remove sort change:name",e.updateHotspotsControls,e),i.on("add remove",(0,s.Z)(this.subviews.generalControls.renderSettings,100),this.subviews.generalControls),i.on("select",e.onHotspotSelected,e),i.on("add",e.showAnnotations,e),i.on("remove",(function(){0===i.length&&e.hideAnnotations()})),this.proxySettings.on("change:annotationsVisible",function(){i.length&&this.proxySettings.get("annotationsVisible")?e.showAnnotations():e.hideAnnotations()}.bind(this)),this.proxySettings.set("annotationsVisible",t.get("visible"),{silent:!0}),t.set("proxyModel",this.proxySettings),e.refreshHotspots(),e.updateHotspotsControls(),P.Z.getFirstCameraAnimation().then(function(){if(t.on("hotspot-error",this.errorHandler.bind(this)),!0===(0,B.Z)().annotationCycleAutostart){var e=Math.max((0,B.Z)().annotation,1);i.trigger("select",i.at(e-1)),this.subviews.hotspots.triggerHotspotCycle(!0)}else(0,B.Z)().annotation>0&&i.trigger("select",i.at((0,B.Z)().annotation-1))}.bind(this))}.bind(this))},initializeAnimation:function(){var e=this.scene.getFeatures().animation.getModel();this.initializeAnimationSubviews(function(){this.el.classList.add("has-animation"),this.subviews.generalControls.setHasAnimations(!0),this.proxySettings.set("speed",e.get("speed")),this.proxySettings.set("cycleMode",e.get("cycleMode")),this.proxySettings.set("fps",e.get("fps")),this.proxySettings.on("change:speed",(function(t,i){e.set("speed",i)})),this.proxySettings.on("change:cycleMode",(function(t,i){e.set("cycleMode",i)})),this.proxySettings.on("change:fps",(function(t,i){e.set("fps",i)})),e.on("change:fps",function(e,t){this.proxySettings.set("fps",t)}.bind(this)),this.$(".osd").addClass("padded"),this.$(".timeline").removeClass("disabled")}.bind(this))},isFeatureAvailable:function(e,t,i){return e&&t&&0!==i.length},initializeModelInspector:function(){var e=this.scene.getFeatures().inspector,t=this.proxySettings,i=this.$(".model-inspector");if(this.isFeatureAvailable((0,B.Z)().uiInspector,e,i)){var n=e.getModel();this._createSubview("modelInspector",nt,{model:n,inspectableTextures:(0,f.Z)()||this.scene.model.get("isInspectable"),wireframeModel:t,osd:this.subviews.osd,el:i}),(0,B.Z)().uiInspectorOpen&&this.toggleInspector(),this.subviews.generalControls.listenTo(n,"change:uiVisible",function(e,t){this.$('[data-action="inspector"]').toggleClass("active",t),r()(".viewer").toggleClass("--shifted",t),this.subviews.animationControls&&this.subviews.animationControls.updateBarWidth()}.bind(this)),(0,f.Z)()&&this.listenTo(n,"change:uiVisible",function(e,t){var i=this.scene._widgetAPI,n=this.subviews.modelInspector.model;t?(n.initAvailableView(),i.alert("To edit the model, close the Inspector.",{continue:!0,continueLabel:"Close Inspector"}).then(function(){this.$("canvas").focus(),this.toggleInspector()}.bind(this)).catch((function(e){if("Resuming editor"!==e)throw e}))):i.resume()}.bind(this))}else this.$('[data-action="inspector"]').hide()},toggleInspector:function(){this.subviews.modelInspector&&(this.subviews.modelInspector.toggle(),this.subviews.snapshot.$(".snapshot.widget").toggle(),this.subviews.header.$(".actions").toggle())},toggleASCII:function(){var e=new URLSearchParams(window.location.search);e.set("post_process_ascii","1"!==e.get("post_process_ascii")?"1":"0"),window.location.search=e.toString()},initializeTextureQuality:function(){var e=this,t=this.scene.getFeatures().quality;if(t){var i=t.getModel();i.get("promiseReady").then(function(e){this.subviews.generalControls.generateTextureQualitySettings(e),this.subviews.generalControls.settings.onTextureQualityReady.call(this.subviews.generalControls.settings,e)}.bind(this)),this.proxySettings.on("change:textureQuality",(function(){var t=parseInt(this.get("textureQuality"),10);window.requestAnimationFrame((function(){i.set("level",t)}));var n=e.subviews.generalControls.getSettingLabelForValue("textureQuality",t+"");e.$(".control-badge").text(n).addClass("active")}))}},initializeViewerMode:function(){var e=this.scene.getFeatures().camera;if(e){var t=e.getModel(),i=t.get("indexManipulator");this.proxySettings.set("viewerMode",i),this.subviews.gui.renderSetting("viewerMode",i),this.proxySettings.on("change:viewerMode",function(){t.set("indexManipulator",parseInt(this.proxySettings.get("viewerMode"),10)),this.scene.getFeaturesManager().focusOnSavedCamera(1),this.$("canvas").focus()}.bind(this))}},initializeShading:function(){var e=this.scene.getFeatures().shadingStyle;if(e){var t=e.getModel(),i=this,n=function(){i.proxySettings.set("shadingStyle",t.get("type")),i.proxySettings.set("wireframeColor",t.get("wireframeColor")),i.proxySettings.set("wireframeEnable",t.get("wireframeEnable")),i.proxySettings.set("hasWireframe",t.get("hasWireframe")),i.subviews.gui.renderSetting("wireframeColor",i.proxySettings.get("wireframeColor")),i.subviews.gui.renderSetting("wireframeEnable",i.proxySettings.get("wireframeEnable")?1:0),i.subviews.gui.renderSetting("hasWireframe",i.proxySettings.get("hasWireframe")?1:0),i.subviews.gui.renderSetting("shadingStyle",i.proxySettings.get("shadingStyle"))};n(),this.proxySettings.listenTo(t,"change",n),this.proxySettings.on("change:shadingStyle",(function(){t.set("type",this.get("shadingStyle"))})),this.proxySettings.on("change:wireframeColor",(function(){this.get("wireframeEnable")?t.setWireframeColorSmooth(this.get("wireframeColor")):t.set("wireframeColor",this.get("wireframeColor"))})),this.proxySettings.on("change:wireframeEnable",(function(){t.set("wireframeEnable",!!this.get("wireframeEnable"))}))}},initializeVr:function(){this.isVR()?(this.el.classList.add("vr-mode"),1===h.ZP.get("sf_show_vr_hint",1)&&Promise.all([i.e(7341),i.e(1572),i.e(5513),i.e(3729),i.e(1567),i.e(5341)]).then(i.bind(i,"GAau")).then(function(e){var t=e.default()([R()]);this.subviews.osd.show(t,{duration:5e3})}.bind(this)),h.ZP.set("sf_show_vr_hint",0,{expires:504e5})):(0,B.Z)().vrLinkNavigation&&this.subviews.osd.show(p.default.any?"Tap on Screen or Press any button to switch to VR":"Press Enter to switch to VR",{duration:5e3})},initializeSoundManager:function(){this.proxySettings.on("sound-error",this.errorHandler.bind(this)),this.proxySettings.on("sound-hide",this.subviews.osd.hide.bind(this.subviews.osd)),this.proxySettings.on("sound-show",this.subviews.osd.show.bind(this.subviews.osd)),x.Z.setProxyModel(this.proxySettings)},initializeSound:function(){var e=this.scene.getFeatures().sound;if(e){var t=e.getModel(),i=t.get("soundtracks"),n=this._createSubview("sound",lt,{el:this.$(".general-controls .volume"),model:t});i.on("add",n.show,n),i.on("remove",(function(){0===i.length&&n.hide()})),i.length&&t.get("visible")&&n.show(),t.on("sound-error",this.errorHandler.bind(this))}},hackDesktopSafariCanvasBackground:function(){this.$("canvas").parent().css({backgroundColor:"#000"})},hackIosCanvasRender:function(){(0,A.Z)((function(){r()("canvas")[0].style.width=r()("canvas")[0].clientWidth+1+"px",(0,A.Z)((function(){r()("canvas")[0].style.width=r()("canvas")[0].clientWidth-1+"px",r()("canvas")[0].style.width=""}))}))},isStarted:function(){return this.el.classList.contains("started")}})},g6dK:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});i("MQFR");var n=i("lotc"),r=i("KDlt");const a=i("7e5f").Z.extend({displayName:"MessagePopup",optionTypes:{title:n.Z.string.isRequired,text:n.Z.string.isRequired,buttons:n.Z.shape({cancel:n.Z.bool,cancelClass:n.Z.string,cancelLabel:n.Z.string,close:n.Z.bool,closeClass:n.Z.string,closeLabel:n.Z.string,continue:n.Z.bool,continueClass:n.Z.string,continueLabel:n.Z.string,ok:n.Z.bool,okClass:n.Z.string,okLabel:n.Z.string,delete:n.Z.bool,deleteClass:n.Z.string,deleteLabel:n.Z.string}),popupClass:n.Z.string,safe:n.Z.bool,popupClosable:n.Z.bool,shouldRejectOnCancel:n.Z.bool},defaultOptions:{shouldRejectOnCancel:!0},events:{"reset form":"cancel","submit form":"continue"},template:function(){return r.Z.get("skfb_front/popups/message",{title:this.options.title,text:this.options.text,buttons:this.options.buttons,safe:this.options.safe,popupClass:this.options.popupClass,popupClosable:this.options.popupClosable})}})},Pu2i:(e,t,i)=>{"use strict";i.r(t),(0,i("CTpj").Z)(!0);i("BdNe"),i("QQD/");var n=i("Hjnd"),r=i.n(n),a=i("Bpah"),o=i("lCzS"),s=i("MQQR"),A=i("QG/p"),g=i("zu1l"),h=i.n(g),c=i("lZH+"),l=i.n(c);const u=function(){return{_viewer:void 0,version:"0.2",initialize:function(e,t){this._viewer=e,this._uid=t;var i=this;window.addEventListener("message",(function(e){if(e.data&&e.data.command){var t=e.data;"initialize"!==t.command&&Object.prototype.hasOwnProperty.call(i,t.command)&&i[t.command].call(i,t)}}),!1)},ready:function(){this.answer({status:"load"})},clientReady:function(){return l().resolve()},answer:function(e){e.source=this._uid,void 0!==window.parent&&window.parent.postMessage(e,"*")},start:function(){this._viewer.start(),this.answer({status:"start"})},stop:function(){this._viewer.stop(),this.answer({status:"stop"})},lookat:function(e){this._viewer.lookat&&(this._viewer.lookat(e.eye,e.target,e.duration),window.setTimeout(function(){this.answer({status:"lookat"})}.bind(this),1e3*e.duration),this.answer({status:"lookat start"}))},autospin:function(e){!1===e&&(e=0),this.answer({status:"autospin"})},getViewerAPI:function(){}}};var d=i("aqzA"),I=i("AuQH"),C=i("mv18"),f=d.Z.osg,p=function(){f.NodeVisitor.apply(this,arguments),this.reset()};f.createPrototypeObject(p,f.objectInherit(f.NodeVisitor.prototype,{reset:function(){this._nodes=[],this._nodeMap={},this._nodeList={},this._dirty=!0},isDirty:function(){return this._dirty},getRootNode:function(){return this._nodes[0]},getRealNodeMap:function(){return this._nodeList},getRepresentationNodeMap:function(){return this._nodeMap},createNodeEntry:function(e){this._dirty=!1;var t=e.getInstanceID();this._nodeList[t]||(this._nodeList[t]=e);var i={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask()};return this._nodeMap[t]||(this._nodeMap[t]=i),i},applyNode:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.children=this._nodes,i.type="Group",t.push(i),this._nodes=t},applyMatrixTransform:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.children=this._nodes,i.type="MatrixTransform",i.localMatrix=f.mat4.clone(e.getMatrix()),i.worldMatrix=e.getWorldMatrices()[0],t.push(i),this._nodes=t},applyGeometry:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.type=e.className(),t.push(i),this._nodes=t},apply:function(e){var t=e.getTypeID();t===f.Node.typeID?this.applyNode(e):t===f.MatrixTransform.typeID?this.applyMatrixTransform(e):e instanceof f.Geometry?this.applyGeometry(e):this.traverse(e)}}));const m=p;var _=i("4JzO"),E=i("qk4i");function v(){this.handlers=[],this.events=[]}v.prototype={subscribe:function(e){this.events.forEach((function(t){e(t.name,t.args)}));var t=this.handlers.push(e);return function(){this.handlers.split(t-1,1)}},emit:function(e,t){this.events.push({name:e,args:t}),this.handlers.forEach((function(i){i(e,t)}))}};const S=v;var B=d.Z.osg,w=function(e){this._translateUpdateCallbackListPerNode={},this._rotateUpdateCallbackListPerNode={},this._nodeList=e};w.prototype={addTranslateUpdateCallback:function(e,t,i){var n=this._translateUpdateCallbackListPerNode[i];n&&(B.mat4.setTranslation(e.getMatrix(),n._target),t._source=n._target),this._translateUpdateCallbackListPerNode[i]=t},addRotateUpdateCallback:function(e,t,i){var n=this._rotateUpdateCallbackListPerNode[i];if(n){var r=n._target,a=B.mat4.create(),o=B.vec3.create();B.mat4.fromQuat(a,r),B.mat4.getTranslation(o,e.getMatrix()),B.mat4.setTranslation(a,o),B.mat4.copy(e.getMatrix(),a),t._source=n._target}this._rotateUpdateCallbackListPerNode[i]=t},removeTranslateUpdateCallback:function(e){delete this._translateUpdateCallbackListPerNode[e]},removeRotateUpdateCallback:function(e){delete this._rotateUpdateCallbackListPerNode[e]},update:function(e,t){var i,n,r;for(n in this._rotateUpdateCallbackListPerNode)i=this._rotateUpdateCallbackListPerNode[n],r=this._nodeList[n],i.update(r,t);for(n in this._translateUpdateCallbackListPerNode)i=this._translateUpdateCallbackListPerNode[n],r=this._nodeList[n],i.update(r,t);return!0}};var y=function(e,t,i,n,r){this._source=e,this._target=t,this._duration=i,this._started=-1,this._easing=n,this._finished=!1,this._callback=r};y.prototype={isFinished:function(){return this._finished},update:function(e,t){if(this._finished)return!0;E.Z.redrawShadow();var i=t.getFrameStamp().getSimulationTime();this._started<0&&(this._started=i);var n=(i-this._started)/this._duration;return n>1&&(this._finished=!0,this._callback&&this._callback(this._result),n=1),this._easing&&(n=this._easing(n)),this.interpolate(n,e),!0}};var M=function(e,t,i,n,r){y.call(this,e,t,i,n,r),this._result=B.vec3.create()};M.prototype=B.objectInherit(y.prototype,{interpolate:function(e,t){B.vec3.lerp(this._result,this._source,this._target,e),B.mat4.setTranslation(t.getMatrix(),this._result),t.dirtyBound()}});var D=function(e,t,i,n,r){y.call(this,e,t,i,n,r),this._result=B.quat.create(),this._translate=B.vec3.create(),this._finalResult=B.mat4.create()};D.prototype=B.objectInherit(y.prototype,{interpolate:function(e,t){B.quat.slerp(this._result,this._source,this._target,e),B.mat4.getTranslation(this._translate,t.getMatrix()),B.mat4.fromQuat(this._finalResult,this._result),B.mat4.setTranslation(this._finalResult,this._translate),B.mat4.copy(t.getMatrix(),this._finalResult),t.dirtyBound()}});var b,Q,x=i("JbUU"),T=i("FGWR"),F=d.Z.osg,R=d.Z.osgAnimation,N=function(e){this._partial=e,this._events={},this._replayEmitter=new S,this._partial.on("model-loaded",function(){this._emitEvents()}.bind(this)),this._sceneGraphVisitor=new m,this._nodeMap=void 0};N.prototype={_filterAnnotationModelMessage:function(e){delete e.refreshAction,delete e.sticky},addGlobalListener:function(e){this._replayEmitter.subscribe(e)},intersectPoint:function(e,t,i,n){var r=this._getFeatureModel("material").findFirstMaterial(e._nodePath);this._replayEmitter.emit("click",{position3D:t,position2D:i,normal:n,instanceID:this._getHitNodeID(e),material:r?r.getJSON():null})},_getFeatureModel:function(e){var t=this._partial.scene.getFeatures()[e];if(t)return t.getModel()},_getViewerOSG:function(){return this._getViewer()._viewer},_getViewer:function(){return this._partial.scene},_emitEvents:function(){var e=["viewerready","annotationFocus","annotationBlur","click"];this._partial.scene.on("all",function(t,i){-1!==e.indexOf(t)&&this._replayEmitter.emit(t,i)}.bind(this)),this.emitEvents=function(){}},_computeSceneGraph:function(){var e=this._sceneGraphVisitor;e.isDirty()&&this._getViewer().getRootModel().accept(e)},_getRootNode:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRootNode()},_getRealNodeMap:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRealNodeMap()},_getRepresentationNodeMap:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRepresentationNodeMap()},_convertDataUriToImage:function(e,t,i){var n=this._getFeatureModel("material").getImageCollection();_.Z.instance.getOrCreateImage(e).promise.then((function(r){var a=n.addNewImage({uid:t,url:e,width:r.getWidth(),height:r.getHeight(),name:e.slice(0,100)});i(null,a.getUID())})).catch((function(){i("failed to add texture")}))},start:function(e){this._partial.start(),e(null)},stop:function(e){this._partial.stop(),e(null)},load:function(e){this._partial.load(),e(null)},gotoAnnotation:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots"),n=i.at(e);i.trigger("select",n),t(null,e)},getAnnotationList:function(e){var t=this._getFeatureModel("hotspot").get("hotspots").toJSON();t.forEach(this._filterAnnotationModelMessage.bind(this)),e(null,t)},lookat:function(e,t,i,n){this.setCameraLookAt(e,t,i,n)},setFov:function(e,t){var i=this._getFeatureModel("camera");i.set("dollyPrevent",!0);var n=i.setJSON({fov:e});t(n.length?n:null,e),i.set("dollyPrevent",!1)},getCurrentTime:function(e){var t=this._getFeatureModel("animation"),i=t.getCurrentAnimation().get("duration");e(null,t.get("progress")*i/100)},play:function(e){this._getFeatureModel("animation").set("playing",!0),e(null)},pause:function(e){var t=this._getFeatureModel("animation");t?(t.set("playing",!1),e(null)):e("no animation feature")},seekTo:function(e,t){var i=this._getFeatureModel("animation"),n=100*e/i.getCurrentAnimation().get("duration");i.trigger("seek",n),t(null)},getAnimations:function(e){var t=this._getFeatureModel("animation"),i=[];t.get("animations").forEach((function(e){var t=[];t.push(e.get("uid")),t.push(e.get("name")),t.push(e.get("duration")),i.push(t)})),e(null,i)},setCurrentAnimationByUID:function(e,t){this._getFeatureModel("animation").set("currentUID",e),t(null)},setCycleMode:function(e,t){var i=this._getFeatureModel("animation");1===i.get("animations").length&&"all"===e&&(e="one");var n=i.setJSON({cycleMode:e},{validate:!0,warnOnError:!0});t(n&&n.length?n:null)},setSpeed:function(e,t){var i=this._getFeatureModel("animation").setJSON({speed:e},{validate:!0,warnOnError:!0});t(i&&i.length?i:null,e)},getSceneGraph:function(e){e(null,this._getRootNode())},getNodeMap:function(e){e(null,this._getRepresentationNodeMap())},getNodeMask:function(e,t){var i=this._getNodeFromUserNodeID(e);i?t(null,i.getNodeMask()):t("node with id "+e.toString()+" not found")},getMatrix:function(e,t){var i=this._getNodeFromUserNodeID(e);i?t(null,{local:i.getMatrix(),world:i.getWorldMatrices()[0]}):t("node with id "+e.toString()+" not found")},setMatrix:function(e,t,i){var n=this._getNodeFromUserNodeID(e);n?(F.mat4.copy(n.getMatrix(),t),n.dirtyBound(),i(null),E.Z.redrawShadow()):i("node with id "+e.toString()+" not found")},hide:function(e,t){var i=this._getNodeFromUserNodeID(e);i?(i.setNodeMask(0),t(null)):t("show: node id "+e+" not found"),E.Z.redrawShadow()},show:function(e,t){var i=this._getNodeFromUserNodeID(e);i?(i.setNodeMask(-1),t(null)):t("show: node id "+e+" not found"),E.Z.redrawShadow()},translate:function(){var e,t,i=arguments.length,n=arguments[i-1],r=arguments[0],a=arguments[1];4===i?e=arguments[2]:5===i&&(e=arguments[2],t=arguments[3]),e=e||0;var o=R[t]||R.easeOutQuad,s=this._getNodeFromUserNodeID(r);if(s)if(s.getTypeID()===F.MatrixTransform.typeID){if(e>0){var A=F.vec3.create();F.mat4.getTranslation(A,s.getMatrix());var g=new M(A,a,e,o,(function(e){s.removeUpdateCallback(g),n(null,e)}));s.addUpdateCallback(g)}else F.mat4.setTranslation(s.getMatrix(),a),s.dirtyBound(),n(null,a);E.Z.redrawShadow()}else n("you can only translate MatrixTransform nodes");else n("node with id "+r.toString()+" not found")},rotate:(b=F.vec3.create(),Q=F.vec3.create(),function(){var e,t,i=arguments.length,n=arguments[i-1],r=arguments[0],a=arguments[1];4===i?e=arguments[2]:5===i&&(e=arguments[2],t=arguments[3]),e=e||0;var o=R[t]||R.easeOutQuad,s=this._getNodeFromUserNodeID(r);if(s)if(s.getTypeID()===F.MatrixTransform.typeID){var A=F.quat.create(),g=F.mat4.create();if(F.mat4.fromRotation(g,-a[0],F.vec3.set(Q,a[1],a[2],a[3])),F.mat4.getRotation(A,g),e>0){var h=F.quat.create();F.mat4.getRotation(h,s.getMatrix());var c=new D(h,A,e,o,(function(e){s.removeUpdateCallback(c),n(null,e)}));s.addUpdateCallback(c)}else F.mat4.fromQuat(g,A),F.mat4.getTranslation(b,s.getMatrix()),F.mat4.setTranslation(g,b),F.mat4.copy(s.getMatrix(),g),s.dirtyBound(),n(null,a);E.Z.redrawShadow()}else n("you can only translate MatrixTransform nodes");else n("node with id "+r.toString()+" not found")}),getRootMatrixNode:function(e){var t=this._getViewer().getRootModel();if(t||e("No scene loaded"),!this._nodeInTheMiddle){this._nodeInTheMiddle=new F.MatrixTransform,this._nodeInTheMiddle.setName("NITM");for(var i=t.getChildren(),n=0,r=i.length;n<r;n++)this._nodeInTheMiddle.addChild(i[n]);t.removeChildren(),t.addChild(this._nodeInTheMiddle)}e(null,this._nodeInTheMiddle.getInstanceID(),this._nodeInTheMiddle.getMatrix())},getCameraLookAt:function(e){var t=this._getViewerOSG().getManipulator(),i=[],n=[];t.getTarget(i),t.getEyePosition(n),e(null,{position:n,target:i})},setCameraLookAt:function(e,t){var i=this._getFeatureModel("camera"),n=this._getViewerOSG().getManipulator(),r=arguments[arguments.length-1],a=3===arguments.length?2:arguments[2];a<=0?n.setTargetAndEye(t,e):(i.setTargetAndEye(t,e),i.set("animationDuration",a)),E.Z.redrawShadow(),r(null)},getScreenShot:function(){var e,t,i=arguments.length,n=arguments[i-1],r="image/jpeg";if(2===i)r=arguments[0];else if(3===i)e=Math.floor(arguments[0]),t=Math.floor(arguments[1]);else if(4===i)e=Math.floor(arguments[0]),t=Math.floor(arguments[1]),r=arguments[2];else if(1!==i)return void n("Wrong number of arguments, signature should be (width, height, [callback]), (width, height, mimetype, [callback]), (mimetype, [callback]) or ([callback]).");var a=this._getViewer().getScreenShot(e,t);n(null,a.toDataURL(r))},getMaterialList:function(e){var t=this._getFeatureModel("material");e(null,(0,I.Z)(t.getJSON()))},getTextureList:function(e){e(null,this._getFeatureModel("material").getImageCollection().toJSON())},addTexture:function(e,t){this._convertDataUriToImage(e,void 0,t)},updateTexture:function(e,t,i){this._convertDataUriToImage(e,t,function(e){if(e)i(e);else{var n=this._getFeatureModel("material").getMaterials();for(var r in n){var a=n[r].getChannels();for(var o in a){var s=a[o],A=s.getTextureModel();A&&A.getUID()===t&&s.trigger("updateChannel")}}i(null,t)}}.bind(this))},setTextureQuality:function(e,t){var i=this._getFeatureModel("quality");i.get("promiseReady").then(function(n){var r={ld:0,sd:1,hd:2};if(n.high||(r={ld:0,hd:1}),n.mid||(r={hd:0}),e in r){var a=r[e];i.set("level",a),t(null,"texture quality set to "+a)}else{var o=(0,C.Z)(r,(function(e,t){return t})).join(", ");t(['Quality must be a string "ld", "sd" or "hd".'," Available qualities for this model are : ",o].join(""),null)}}.bind(this))},setMaterial:function(e,t){var i=this._getFeatureModel("material"),n=e.stateSetID,r=i.getMaterialByStateSetID(n);r.setMaterialJSON(e,i.getImageCollection(),{validate:!1,warnOnError:!1}),r.trigger("apply"),E.Z.redrawShadow(),t(null)},setPostProcessing:function(e,t){this._getFeatureModel("postProcess").set(e),t(null)},getPostProcessing:function(e){e(this._getFeatureModel("postProcess").toJSON())},getWorldToScreenCoordinates:function(e,t){var i=x.Z.getScreenPositionFromWorldPoint(e);t({glCoord:i.slice(0,2),canvasCoord:T.Z.glCoordToCanvas(i[0],i[1],i).slice(0,2)})},_getNodeFromUserNodeID:function(e){return this._getRealNodeMap()[e]},_getHitNodeID:function(e){if(e&&e._nodePath&&e._nodePath.length){var t=e._nodePath[e._nodePath.length-1];if(t)return t.getInstanceID()}}};const L=N;var k,P,U,O,G=i("4EEe"),H=i("gvzH"),K=i("Lz+S"),Z=i("XkCy"),V=i("aMVL"),Y=i("+cla"),J=i("Oyie"),z=d.Z.osg,j=function(){L.apply(this,arguments),this._displayed=!1,V.Z.getModelDisplayed().then(function(){this._displayed=!0}.bind(this)),this._pickMask={click:H.Z.PICK_GEOMETRY_FAST,mousemove:H.Z.PICK_GEOMETRY_FAST}};j.prototype=(0,Y.Z)(L.prototype,{addGlobalListener:function(e){Z.Z.getBoxReady().then(function(){G.Z.initViewerAPI(this),this._getViewer().getInputManager().setEnable(K.Z.SCENE_VIEWERAPI,!0)}.bind(this)),this._replayEmitter.subscribe(e)},intersectPoint:void 0,_emitEvents:function(){var e={viewerready:"viewerready",started:"viewerstart",stopped:"viewerstop",annotationFocus:"annotationFocus",annotationBlur:"annotationBlur",annotationMouseEnter:"annotationMouseEnter",annotationMouseLeave:"annotationMouseLeave",annotationSelect:"annotationSelect",nodeMouseEnter:"nodeMouseEnter",nodeMouseLeave:"nodeMouseLeave",click:"click",cameraStart:"camerastart",cameraStop:"camerastop"},t=function(t,i){var n=e[t];n&&this._replayEmitter.emit(n,i)}.bind(this);this._partial.on("all",t),this._partial.scene.on("all",t),this._emitEvents=function(){}},onCursorUp:(P=z.vec3.create(),U=z.vec3.create(),O=z.vec2.create(),function(e){if(this._displayed){O[0]=e.canvasX,O[1]=e.canvasY;var t=x.Z.computeNearestIntersection2D(O[0],O[1],this._pickMask.click),i={position3D:null,position2D:O,normal:null,instanceID:null,material:null};if(t){x.Z.getWorldPositionFromHit(t,U,P);var n=this._getFeatureModel("material").findFirstMaterial(t._nodePath);i.normal=P,i.position3D=U,i.instanceID=this._getHitNodeID(t),i.material=n?n.getJSON():null,this._replayEmitter.emit("click",i)}else this._replayEmitter.emit("click",i)}}),onMouseMove:function(){var e,t,i=z.vec3.create(),n=z.vec3.create(),r=z.vec2.create();return function(a){if(this._displayed){r[0]=a.canvasX,r[1]=a.canvasY;var o=x.Z.computeNearestIntersection2D(r[0],r[1],this._pickMask.click);if(o){x.Z.getWorldPositionFromHit(o,n,i);var s=this._getHitNodeID(o),A=this._getFeatureModel("material").findFirstMaterial(o._nodePath);if(t===s)return;return t&&this._replayEmitter.emit("nodeMouseLeave",{position3D:null,position2D:null,normal:i,instanceID:t,material:e}),t=s,e=A?A.getJSON():null,void this._replayEmitter.emit("nodeMouseEnter",{position3D:n,position2D:r,normal:i,instanceID:t,material:e})}t&&(this._replayEmitter.emit("nodeMouseLeave",{position3D:n,position2D:r,normal:i,instanceID:t,material:e}),t=void 0,e=void 0)}}}(),setListenerOptions:function(e){if(e&&"function"!=typeof e)switch(e.name){case"click":this._pickMask.click="slow"===e.pick?H.Z.PICK_GEOMETRY_SLOW:H.Z.PICK_GEOMETRY_FAST;break;case"nodeMouseEnter":case"nodeMouseLeave":this._pickMask.mousemove="slow"===e.pick?H.Z.PICK_GEOMETRY_SLOW:H.Z.PICK_GEOMETRY_FAST}},pickColor:(k=new Uint8Array(4),function(e,t){new J(function(t,i){var n=this._getViewerOSG().getCamera();n.setFinalDrawCallback((function(r){var a=r.getGraphicContext();if(a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE){a.flush(),a.finish();var o=e[0]*(a.drawingBufferWidth/a.canvas.clientWidth),s=a.drawingBufferHeight*(1-e[1]/a.canvas.clientHeight);a.readPixels(o,s,1,1,a.RGBA,a.UNSIGNED_BYTE,k),t(k),n.setFinalDrawCallback(void 0)}else i()}))}.bind(this)).then((function(){t(k)}))}),unselectAnnotation:function(e){this.gotoAnnotation(-1,e)},requestRedraw:function(){E.Z.redrawShadow()}});const W=j;var q=i("jQKg"),X=d.Z.osg,$=d.Z.osgAnimation,ee=function(){W.apply(this,arguments),this.updateDaemon=void 0};ee.prototype=(0,Y.Z)(W.prototype,{setCameraEasing:function(e){this._getFeatureModel("camera").set("easingFunction",e)},hideAnnotation:function(e,t){this._getFeatureModel("hotspot").get("hotspots").at(e).set("visible",!1),E.Z.draw(),t(null)},showAnnotation:function(e,t){this._getFeatureModel("hotspot").get("hotspots").at(e).set("visible",!0),E.Z.draw(),t(null)},createAnnotation:function(e,t,i,n,r,a,o){var s=x.Z.computeNearestIntersection3D(e,t);if(!s)return o(null);var A=this._getFeatureModel("hotspot"),g=A.createHotspot(s,!0);q.Z.getMarkdownPreview(a).then((function(e){g.set({name:r,content:{raw:a,rendered:e.result},eye:i,target:n}),E.Z.redrawShadow(),o(null,A.get("hotspots").length-1),E.Z.draw()}),function(){g.set({name:r,eye:i,target:n}),E.Z.redrawShadow(),o(null,A.get("hotspots").length-1),E.Z.draw()}.bind(this))},updateAnnotation:function(e){var t,i=this._getFeatureModel("hotspot").get("hotspots"),n=i.at(e);if(3===arguments.length){var r=arguments[1],a={};if(r.title&&(a.name=r.title),r.content&&(a.content={raw:r.content}),r.eye&&(a.eye=r.eye),r.target&&(a.target=r.target),t=arguments[2],r.content)return void q.Z.getMarkdownPreview(r.content).then(function(e){a.content.rendered=e.result;var i=n.toJSON();this._filterAnnotationModelMessage(i),t(null,i),n.set(a),E.Z.draw()}.bind(this),function(){var e=n.toJSON();this._filterAnnotationModelMessage(e),t(null,e),n.set(a),E.Z.draw()}.bind(this));n.set(a)}else t=arguments[1];var o=n.toJSON();this._filterAnnotationModelMessage(o),E.Z.redrawShadow(),t(null,o)},getAnnotation:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots").at(e).toJSON();this._filterAnnotationModelMessage(i),t(null,i)},removeAnnotation:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots"),n=i.at(e);i.remove(n),E.Z.redrawShadow(),t(null)},pickFromScreen:function(){var e=X.vec3.create(),t=X.vec3.create();return function(i,n){var r=x.Z.computeNearestIntersection2D(i[0],i[1],this._pickMask.click);if(!r)return n(null);x.Z.getWorldPositionFromHit(r,t,e);var a=this._getHitNodeID(r),o=this._getFeatureModel("material").findFirstMaterial(r._nodePath);n(null,{position3D:t,position2D:i,normal:e,instanceID:a,material:o?o.getJSON():null})}}(),pickFromScene:function(){var e=X.vec3.create(),t=X.vec3.create();return function(i,n,r){var a=x.Z.computeNearestIntersection3D(i,n);if(!a)return r(null);x.Z.getWorldPositionFromHit(a,t,e);var o=this._getHitNodeID(a),s=this._getFeatureModel("material").findFirstMaterial(a._nodePath);r(null,{position3D:t,normal:e,instanceID:o,material:s?s.getJSON():null})}}(),addVideoTexture:function(e,t,i){this._convertVideoDataUriToImage(e,void 0,t,i)},_convertVideoDataUriToImage:function(e,t,i,n){var r=this._getFeatureModel("material").getImageCollection();_.Z.instance.getOrCreateImage(e).promise.then((function(a){var o=r.addNewImage({uid:t,url:e,width:a.getWidth(),height:a.getHeight(),name:e.slice(0,100)});void 0!==i&&a.getImage&&(a.getImage().loop=i),n(null,o.getUID())})).catch((function(){n("failed to add texture")}))},translate:function(e,t,i){var n=arguments.length,r=arguments[n-1],a=0,o=$.easeOutQuad;n>2&&((i=arguments[2]).duration&&(a=i.duration),i.easing&&$[i.easing]&&(o=$[i.easing]));var s=this._getNodeFromUserNodeID(e);if(s)if(s.getTypeID()===X.MatrixTransform.typeID){if(a>0){var A=X.vec3.create();X.mat4.getTranslation(A,s.getMatrix());var g=new M(A,t,a,o,function(t){this.updateDaemon.removeTranslateUpdateCallback(e),r(null,t)}.bind(this));this.updateDaemon||this._initUpdateDaemon(),this.updateDaemon.addTranslateUpdateCallback(s,g,e)}else X.mat4.setTranslation(s.getMatrix(),t),s.dirtyBound(),r(null,t);E.Z.redrawShadow()}else r("you can only translate MatrixTransform nodes");else r("node with id "+e.toString()+" not found")},rotate:function(){var e=X.vec3.create(),t=X.vec3.create();return function(i,n,r){var a=arguments.length,o=arguments[a-1],s=0,A=$.easeOutQuad;a>2&&((r=arguments[2]).duration&&(s=r.duration),r.easing&&$[r.easing]&&(A=$[r.easing]));var g=this._getNodeFromUserNodeID(i);if(g)if(g.getTypeID()===X.MatrixTransform.typeID){var h=X.quat.create(),c=X.mat4.create();if(X.mat4.fromRotation(c,-n[0],X.vec3.set(t,n[1],n[2],n[3])),X.mat4.getRotation(h,c),s>0){var l=X.quat.create();X.mat4.getRotation(l,g.getMatrix());var u=new D(l,h,s,A,function(e){this.updateDaemon.removeRotateUpdateCallback(i),o(null,e)}.bind(this));this.updateDaemon||this._initUpdateDaemon(),this.updateDaemon.addRotateUpdateCallback(g,u,i)}else X.mat4.fromQuat(c,h),X.mat4.getTranslation(e,g.getMatrix()),X.mat4.setTranslation(c,e),X.mat4.copy(g.getMatrix(),c),g.dirtyBound(),o(null,n);E.Z.redrawShadow()}else o("you can only rotate MatrixTransform nodes");else o("node with id "+i.toString()+" not found")}}(),_initUpdateDaemon:function(){var e=this._getViewer().getRootModel();this.updateDaemon=new w(this._getRealNodeMap()),e.addUpdateCallback(this.updateDaemon)}});const te=ee;var ie=d.Z.osg,ne=function(){ie.NodeVisitor.apply(this,arguments),this.reset()};ie.createPrototypeObject(ne,ie.objectInherit(ie.NodeVisitor.prototype,{reset:function(){this._nodes=[],this._nodeMap={},this._nodeList={},this._dirty=!0,this._apiSceneID=0},isDirty:function(){return this._dirty},getRootNode:function(){return this._nodes[0]},getRealNodeMap:function(){return this._nodeList},getRepresentationNodeMap:function(){return this._nodeMap},createNodeEntry:function(e){this._dirty=!1;var t=e._uniqueID;this._nodeList[t]||(this._nodeList[t]=e);var i={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask()};return this._nodeMap[t]||(this._nodeMap[t]=i),i},applyNode:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.children=this._nodes,i.type="Group",t.push(i),this._nodes=t},applyMatrixTransform:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.children=this._nodes,i.type="MatrixTransform",i.localMatrix=ie.mat4.clone(e.getMatrix()),i.worldMatrix=e.getWorldMatrices()[0],t.push(i),this._nodes=t},applyGeometry:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var i=this.createNodeEntry(e);i.type=e.className(),t.push(i),this._nodes=t},apply:function(e){if(void 0!==e._uniqueID){var t=e.getTypeID();t===ie.Node.typeID?this.applyNode(e):t===ie.MatrixTransform.typeID?this.applyMatrixTransform(e):e instanceof ie.Geometry?this.applyGeometry(e):this.traverse(e)}else this.traverse(e)}}));const re=ne;var ae,oe=d.Z.osg,se=function(){te.apply(this,arguments),this._sceneGraphVisitor=new re,this.updateDaemon=void 0,this._startDrag=!1,this._startCoord=oe.vec2.create()};se.prototype=(0,Y.Z)(te.prototype,{addGlobalListener:function(e){Z.Z.getBoxReady().then(function(){G.Z.initViewerAPI_1_4(this),this._getViewer().getInputManager().setEnable(K.Z.SCENE_VIEWERAPI_1_4,!0)}.bind(this)),this._replayEmitter.subscribe(e)},onCursorUp:(ae=oe.vec2.create(),function(e){var t=this._startDrag&&oe.vec2.dist(oe.vec2.set(ae,e.glX,e.glY),this._startCoord)>5;this._startDrag=!1,t||W.prototype.onCursorUp.call(this,e)}),onCursorDown:function(e){oe.vec2.set(this._startCoord,e.glX,e.glY),this._startDrag=!0},getFov:function(e){e(null,this._getFeatureModel("camera").get("fov"))},setCurrentAnimationByUID:function(e,t){L.prototype.setCurrentAnimationByUID.apply(this,arguments),E.Z.redrawShadow(),t(null)},setLight:function(e,t,i){var n=this._getFeatureModel("lighting").get("lights")[e];t&&(void 0!==t.matrix&&n.set("matrix",t.matrix),void 0!==t.enabled&&n.set("enable",t.enabled),void 0!==t.type&&n.set("type",t.type),void 0!==t.shadowEnabled&&n.set("castShadows",t.shadowEnabled),void 0!==t.color&&n.set("color",t.color),void 0!==t.intensity&&n.set("intensity",t.intensity)),E.Z.redrawShadow(),i(null)},getLight:function(e,t){var i=this._getFeatureModel("lighting").get("lights");(!i||e>=i.length)&&t("light with id "+e.toString()+" not found");var n=i[e];t(null,{matrix:n.get("matrix"),enabled:n.get("enable"),shadowEnabled:n.get("castshadows"),color:n.get("color"),intensity:n.get("intensity")})},setEnvironment:function(e,t){var i=this._getFeatureModel("environment");e&&(void 0!==e.enabled&&i.set("enable",e.enabled),void 0!==e.exposure&&i.set("exposure",e.exposure),void 0!==e.lightIntensity&&i.set("lightIntensity",e.lightIntensity),void 0!==e.rotation&&i.set("rotation",e.rotation),void 0!==e.shadowEnabled&&i.set("shadowEnable",e.shadowEnabled)),E.Z.redrawShadow(),t(null)},getEnvironment:function(e){var t=this._getFeatureModel("environment");e(null,{enabled:t.get("enable"),exposure:t.get("exposure"),lightIntensity:t.get("lightIntensity"),rotation:t.get("rotation"),shadowEnabled:t.get("shadowEnable")})},setShadingStyle:function(e,t,i){var n=this._getFeatureModel("shadingStyle");try{n.set("renderer",e),t&&t.type&&n.set("type",t.type)}catch(e){return i(null)}E.Z.redrawShadow(),i(null)},getShadingStyle:function(e){var t=this._getFeatureModel("shadingStyle");e(null,{shadingStyle:t.get("renderer"),type:t.get("type")})},setWireframe:function(e,t,i){var n=this._getFeatureModel("shadingStyle");try{n.set("wireframeEnable",e),t&&t.color&&n.set("wireframeColor",t.color)}catch(e){return i(null)}E.Z.redrawShadow(),i(null)},getWireframe:function(e){var t=this._getFeatureModel("shadingStyle");e(null,{enabled:t.get("wireframeEnable"),color:t.get("wireframeColor")})},_getHitNodeID:function(e){if(e&&e._nodePath&&e._nodePath.length){var t=e._nodePath[e._nodePath.length-1];if(t)return t._uniqueID}},getRootMatrixNode:function(e){var t=this._getViewer().getRootModel();if(t||e("No scene loaded"),!this._nodeInTheMiddle){var i=this._sceneGraphVisitor;i.reset(),this._getViewer().getRootModel().accept(i);var n=0,r=i.getRepresentationNodeMap();for(var a in r){var o=parseInt(a,10);n=n>o?n:o}n++,this._nodeInTheMiddle=new oe.MatrixTransform,this._nodeInTheMiddle.setName("NITM"),this._nodeInTheMiddle._uniqueID=n;for(var s=t.getChildren(),A=0,g=s.length;A<g;A++)this._nodeInTheMiddle.addChild(s[A]);t.removeChildren(),t.addChild(this._nodeInTheMiddle),i.reset(),this._getViewer().getRootModel().accept(i)}e(null,this._nodeInTheMiddle._uniqueID,this._nodeInTheMiddle.getMatrix())}});const Ae=se;var ge=d.Z.osg,he=function(){re.apply(this,arguments)};ge.createPrototypeObject(he,ge.objectInherit(re.prototype,{setApiCore:function(e){this._apicore=e},createNodeEntry:function(e){this._dirty=!1;var t=e._uniqueID;this._nodeList[t]||(this._nodeList[t]=e);var i=this._apicore._getFeatureModel("material"),n=i?i.findFirstMaterial(this.nodePath):"",r={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask(),materialID:n?n.getJSON().id:null};return this._nodeMap[t]||(this._nodeMap[t]=r),r}}));const ce=he;var le=function(){this.actions=[],this.startedAt=0,this.recording=!1};le.prototype={addCamera:function(e){if(this.recording){if(this.lastCamera){var t=this.lastCamera;if(t&&t.position[0]===e.position[0]&&t.position[1]===e.position[1]&&t.position[2]===e.position[2]&&t.target[0]===e.target[0]&&t.target[1]===e.target[1]&&t.target[2]===e.target[2])return}this.lastCamera=e,e.type="camera",void 0===e.timeStamp&&(e.timeStamp=this.timeElapsed()),this.actions.push(e)}},addInputEvent:function(e,t){this.recording&&(t.type=e,t.timeStamp=this.timeElapsed(),this.actions.push(t))},start:function(){this.recording||(this.actions=[],this.startedAt=window.performance.now(),this.recording=!0)},stop:function(){this.recording=!1;for(var e=this.actions.length,t=new Float32Array(8*e),i=0,n=0;n<e;n++){var r=this.actions[n];switch(r.type){case"camera":t[i++]=r.timeStamp,t[i++]=1,t[i++]=r.position[0],t[i++]=r.position[1],t[i++]=r.position[2],t[i++]=r.target[0],t[i++]=r.target[1],t[i++]=r.target[2];break;case"click":t[i++]=r.timeStamp,t[i++]=2,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++;break;case"wheel":t[i++]=r.timeStamp,t[i++]=3,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++;break;case"mousemove":t[i++]=r.timeStamp,t[i++]=4,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++;break;case"mousedown":t[i++]=r.timeStamp,t[i++]=5,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++;break;case"mouseup":t[i++]=r.timeStamp,t[i++]=6,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++;break;case"dblclick":t[i++]=r.timeStamp,t[i++]=7,t[i++]=r.clientX,t[i++]=r.clientY,t[i++]=r.ctrlKey,t[i++]=r.shiftKey,t[i++]=r.altKey,i++}}return this.actions=[],t.slice(0,i)},timeElapsed:function(){return window.performance.now()-this.startedAt}};const ue=le;var de=function(){Ae.apply(this,arguments),this._sceneGraphVisitor=new ce,this._sceneGraphVisitor.setApiCore(this)};de.prototype=(0,Y.Z)(Ae.prototype,{setAnnotationsTexture:function(e,t){this._getFeatureModel("hotspot").set("textureOptions",e),E.Z.redrawShadow(),t(null)},gotoAnnotation:function(e,t,i){var n=this._getFeatureModel("hotspot").get("hotspots"),r=n.at(e);if(!r)return n.trigger("select",r),void i(null,e);r.set("cameraPreventAnimation",t.preventCameraAnimation),r.set("cameraPreventMove",t.preventCameraMove),n.trigger("select",r),r.set("cameraPreventAnimation",!1),r.set("cameraPreventMove",!1),i(null,e)},_convertVideoDataUriToImage:function(e,t,i,n){var r=this._getFeatureModel("material").getImageCollection();_.Z.instance.getOrCreateImage(e,i||{}).promise.then((function(i){var a=r.addNewImage({uid:t,url:e,width:i.getWidth(),height:i.getHeight(),name:e.slice(0,100)});n(null,a.getUID())})).catch((function(){n("failed to add texture")}))},addVideoTexture:function(e,t,i){this._convertVideoDataUriToImage(e,void 0,t,i)},setBackground:function(e,t){var i=this._getFeatureModel("background");e.uid?(i.set("enable","fixed"),i.set("uid",e.uid)):e.color?(i.set("enable","color"),i.set("color",e.color)):e.enable?i.set("enable",e.enable):e.transparent&&i.set("enable","none"),t(null)},_getUserCollectionList:function(e,t){var i=new XMLHttpRequest;i.open("GET","https://api.sketchfab.com/v3/me/"+t,!0),i.responseType="json",i.onload=function(){if(4===i.readyState&&200===i.status){var t=i.response,n=[];for(var r in t.results){var a=t.results[r];a&&a.uid&&n.push({name:a.name,uid:a.uid})}e(n)}},i.onerror=function(){e(null)},i.send(null)},getBackgroundList:function(e){this._getUserCollectionList(e,"backgrounds")},setEnvironment:function(e,t){var i=this._getFeatureModel("environment");e&&(void 0!==e.enabled&&i.set("enable",e.enabled),void 0!==e.exposure&&i.set("exposure",e.exposure),void 0!==e.lightIntensity&&i.set("lightIntensity",e.lightIntensity),void 0!==e.rotation&&i.set("rotation",e.rotation),void 0!==e.shadowEnabled&&i.set("shadowEnable",e.shadowEnabled),void 0!==e.blur&&i.set("blur",e.blur),void 0!==e.uid&&i.set("uid",e.uid)),E.Z.redrawShadow(),t(null)},getEnvironmentList:function(e){this._getUserCollectionList(e,"environments")},setCycleMode:function(e,t){var i,n=this._getFeatureModel("animation");switch(e){case"loopOne":i="one";break;case"loopAll":i="all";break;case"one":i="oneAndStop";break;case"all":i="";break;default:i=e}n.set("cycleMode",i),E.Z.redrawShadow(),t(null)},_emitEvents:function(){var e={viewerready:"viewerready",started:"viewerstart",stopped:"viewerstop",animationChange:"animationChange",animationEnded:"animationEnded",animationPlay:"animationPlay",animationStop:"animationStop",annotationFocus:"annotationFocus",annotationBlur:"annotationBlur",annotationMouseEnter:"annotationMouseEnter",annotationMouseLeave:"annotationMouseLeave",annotationSelect:"annotationSelect",nodeMouseEnter:"nodeMouseEnter",nodeMouseLeave:"nodeMouseLeave",click:"click",cameraStart:"camerastart",cameraStop:"camerastop"},t=function(t,i){var n=e[t];n&&this._replayEmitter.emit(n,i)}.bind(this);this._partial.on("all",t),this._partial.scene.on("all",t),this._emitEvents=function(){}},_userProvidedEventDispatch:function(e,t,i){if(this.actionsRecorder&&this.actionsRecorder.addInputEvent(e,i),!this._getViewer()||!this._getViewer().getFeaturesManager())return!0;var n=!this._getViewer().getFeaturesManager().getCanvas().dispatchEvent(t);return E.Z.redrawShadow(),n},_userProvidedMouseEventDispatch:function(e,t){var i=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey});return this._userProvidedEventDispatch(e,i,t)},mouseMove:function(e,t){t(this._userProvidedMouseEventDispatch("mousemove",e))},mouseDown:function(e,t){t(this._userProvidedMouseEventDispatch("mousedown",e))},mouseUp:function(e,t){t(this._userProvidedMouseEventDispatch("mouseup",e))},mouseClick:function(e,t){t(this._userProvidedMouseEventDispatch("mouseup",e))},mouseDblClick:function(e,t){t(this._userProvidedMouseEventDispatch("dblclick",e))},mouseWheel:function(e,t){var i=new WheelEvent("wheel",{view:window,bubbles:!0,cancelable:!0,deltaX:e.deltaX,deltaY:e.deltaY});t(this._userProvidedEventDispatch("wheel",i,e))},_getCameraInfo:function(){var e={target:[],position:[]};return this.manipulator.getTarget(e.target),this.manipulator.getEyePosition(e.position),e},_cameraRecord:function(){if(this.actionsRecorder){var e=this._getCameraInfo();this.actionsRecorder.addCamera(e),requestAnimationFrame(this._cameraRecordBinding)}},startRecord:function(e){this.actionsRecorder=new ue,this.manipulator=this._getViewerOSG().getManipulator();var t=this._getCameraInfo();this.actionsRecorder.start(),t.timeStamp=0,this.actionsRecorder.addCamera(t),this._cameraRecordBinding=this._cameraRecord.bind(this),requestAnimationFrame(this._cameraRecordBinding),e("recording started")},endRecord:function(e){var t=this._getCameraInfo();this.actionsRecorder.addCamera(t),e(this.actionsRecorder.stop()),this.actionsRecorder=void 0}});const Ie=de;var Ce=function(){Ie.apply(this,arguments)};Ce.prototype=(0,Y.Z)(Ie.prototype,{hideAnnotationTooltip:function(e){this._getFeatureModel("hotspot").get("proxyModel").set("annotationsVisible",!1),e(null)},showAnnotationTooltip:function(e){this._getFeatureModel("hotspot").get("proxyModel").set("annotationsVisible",!0),e(null)},setCameraConstraints:function(e,t){var i=this._getFeatureModel("camera"),n=i.setJSON(e,{validate:!0});i.trigger("change:enableCameraConstraints"),i.set("viewer-api-hotspots",!0),t(n)},setEnableCameraConstraints:function(e,t){this._getFeatureModel("camera").set("enableCameraConstraints",e),t(null)},setAnnotationCameraTransition:function(e,t,i){this._getFeatureModel("hotspot").preventHotspotCameraAction(e,t),i(null)},getAnimations:function(e){var t=this._getFeatureModel("animation").get("animations");if(!t.length)return e(null,[]);var i=new Array(t.length);return t.forEach((function(e){var t=[];t.push(e.get("uid")),t.push(e.get("name")),t.push(e.get("duration")),t.push(e.get("order")),i[e.get("order")]=t})),e(null,i)},_initializeAnnotationMarkdown:function(e,t,i,n,r,a,o){q.Z.getMarkdownPreview(a).then((function(s){t.set({name:r,content:{raw:a,rendered:s.result},eye:i,target:n}),E.Z.redrawShadow(),o(null,e.get("hotspots").length-1),E.Z.draw()}),function(){t.set({name:r,eye:i,target:n}),E.Z.redrawShadow(),o(null,e.get("hotspots").length-1),E.Z.draw()}.bind(this))},createAnnotationFromWorldPosition:function(e,t,i,n,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromWorldPosition(e,!0);this._initializeAnnotationMarkdown(o,s,t,i,n,r,a)},createAnnotationFromScenePosition:function(e,t,i,n,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromScenePosition(e,!0);this._initializeAnnotationMarkdown(o,s,t,i,n,r,a)},removeAllAnnotations:function(e){for(var t=this._getFeatureModel("hotspot").get("hotspots");t.length>0;)t.remove(t.at(0));E.Z.redrawShadow(),e(null)},recenterCamera:function(e){this._getViewerOSG().getManipulator().computeHomePosition(),e(null)},setUserInteraction:function(e,t){this._getViewer().getInputManager().setEnable(K.Z.SCENE,e),t(null)}});const fe=Ce;var pe=function(){fe.apply(this,arguments)};pe.prototype=(0,Y.Z)(fe.prototype,{setUVOffset:function(e,t,i,n,r){this._getFeatureModel("material").setUVOffset(e.stateSetID,t,i,n),r(null)},setUVRotation:function(e,t,i,n){this._getFeatureModel("material").setUVRotation(e.stateSetID,t,i),n(null)},setUVScale:function(e,t,i,n,r){this._getFeatureModel("material").setUVScale(e.stateSetID,t,i,n),r(null)},refreshDraw:function(){E.Z.redrawShadow(),E.Z.requestDrawHiddenDefered()},refreshCanvas:function(){var e=this._getViewer().getCanvas(),t=e.width;e.width=t+1,new(l())((function(e){e()})).finally((function(){e.width=t}))},setHighlightOptions:function(e){var t=this._getFeatureModel("outline");t&&(void 0!==e.outlineWidth&&t.set("outlineWidth",e.outlineWidth),void 0!==e.outlineColor&&t.set("colorSelection",e.outlineColor),void 0!==e.highlightColor&&t.set("colorHover",e.highlightColor),void 0!==e.outlineDuration&&t.set("durationOutline",e.outlineDuration),void 0!==e.highlightDuration&&t.set("durationHighlight",e.highlightDuration))},highlightMaterial:function(e){var t=this._getFeatureModel("outline");if(null==e)return t.trigger("hideOutline"),void t.trigger("hideHighlight");var i=this._getFeatureModel("material"),n=e.stateSetID,r=i.getMaterialByStateSetID(n);t.trigger("displayOutlineNoFocus",r.get("stateSet"))},setEnableCameraConstraints:function(e,t){var i=this._getFeatureModel("camera");i.set("enableCameraConstraints",e),i.set("useCameraConstraints",e),t(null)}});const me=pe;var _e=d.Z.osg,Ee=function(){ce.apply(this,arguments)};_e.createPrototypeObject(Ee,_e.objectInherit(ce.prototype,{setApiCore:function(e){this._apicore=e},createNodeEntry:function(e){this._dirty=!1;var t=e._uniqueID;this._nodeList[t]||(this._nodeList[t]=e);var i=this._apicore._getFeatureModel("material"),n=i?i.findFirstMaterial(this.nodePath):"",r={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask(),materialID:n?n.id:null};return this._nodeMap[t]||(this._nodeMap[t]=r),r}}));const ve=Ee;var Se=i("haCR"),Be=i.n(Se),we=function(){me.apply(this,arguments),this._sceneGraphVisitor=new ve,this._sceneGraphVisitor.setApiCore(this)};we.prototype=(0,Y.Z)(me.prototype,{setSpeed:function(e,t){var i=this._getFeatureModel("animation").setJSON({speed:e},{validate:!0,warnOnError:!0});t(i&&i.length?i:null,e),t(null)},setCameraLookAtEndAnimationCallback:function(){var e=this._getFeatureModel("camera"),t=arguments[arguments.length-1];e.set("userEndAnimationCallback",function(){t(null,!0)}.bind(this))},_emitEvents:function(){var e={viewerready:"viewerready",started:"viewerstart",stopped:"viewerstop",backgroundLoaded:"backgroundLoaded","primary-progress":"modelLoadProgress","secondary-progress":"textureLoadProgress",animationChange:"animationChange",animationEnded:"animationEnded",animationBegan:"animationBegan",animationPlay:"animationPlay",animationStop:"animationStop",annotationFocus:"annotationFocus",annotationBlur:"annotationBlur",annotationMouseEnter:"annotationMouseEnter",annotationMouseLeave:"annotationMouseLeave",annotationSelect:"annotationSelect",nodeMouseEnter:"nodeMouseEnter",nodeMouseLeave:"nodeMouseLeave",click:"click",cameraStart:"camerastart",cameraStop:"camerastop"},t=function(t,i){var n=e[t];n&&this._replayEmitter.emit(n,i)}.bind(this);this._partial.on("all",t),this._partial.scene.on("all",t),this._emitEvents=function(){}},focusOnVisibleGeometries:function(e){var t=this._getViewerOSG().getManipulator().getCurrentManipulator();t.setComputeBoundNodeMaskOverride(0),t.computeHomePosition(2),e(null),E.Z.redrawShadow()},startAR:function(){var e=new Event("fake",{bubbles:!0,cancelable:!1});this._partial.subviews.generalControls.onArClick(e)},setLightFeatureEnabled:function(e,t){this._getFeatureModel("lighting").set("enable",e),E.Z.redrawShadow(),t(null)},isLightFeatureEnabled:function(e){e(null,this._getFeatureModel("lighting").get("enable"))},hide:function(e,t){var i=this._getNodeFromUserNodeID(e);i?(i.setNodeMask(0),i.dirtyBound(),t(null)):t("show: node id "+e+" not found"),E.Z.redrawShadow()},show:function(e,t){var i=this._getNodeFromUserNodeID(e);i?(i.setNodeMask(-1),i.dirtyBound(),t(null)):t("show: node id "+e+" not found"),E.Z.redrawShadow()},setEnableCameraConstraints:function(e,t,i){var n=this._getFeatureModel("camera");n.set("enableCameraConstraints",e),n.set("useCameraConstraints",e),void 0!==i?void 0!==t.preventFocus&&n.set("preventCameraConstraintsFocus",t.preventFocus):i=t,i(null)},_setHotspot:function(e,t,i,n,r,a,o,s){t.set({name:r,content:{raw:a,rendered:o},eye:i,target:n,sticky:null},{silent:!0}),s(null,e.get("hotspots").length-1),t.set("building",void 0),E.Z.draw()},_initializeAnnotationMarkdown:function(e,t,i,n,r,a,o){var s=a&&a.length;if(s){for(var A=[[/!\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g],[/\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g],[/\n([^\n]+)\n/g],[/\n(#+)(.*)/g],[/(\*\*|__)(.*?)\1/g],[/(\*|_)(.*?)\1/g],[/\~\~(.*?)\~\~/g],[/\:\"(.*?)\"\:/g],[/\n\s*```\n([^]*?)\n\s*```\s*\n/g],[/`(.*?)`/g],[/\n(\*|\-|\+)(.*)/g],[/\n[0-9]+\.(.*)/g],[/\n(&gt;|\>)(.*)/g],[/\n-{5,}/g],[/(\|[^\n]+\|\r?\n)((?:\|:?[-]+:?)+\|)(\n(?:\|[^\n]+\|\r?\n?)*)?/g],[/\s?<\/ul>\s?<ul>/g],[/\s?<\/ol>\s?<ol>/g],[/<\/blockquote>\n<blockquote>/g],[/https?:\/\/[^"']*/g]],g=0;g<A.length&&null===a.match(A[g++]););s=!1}if(s)q.Z.getMarkdownPreview(a).then(function(s){this._setHotspot(e,t,i,n,r,a,s.result,o)}.bind(this),function(){this._setHotspot(e,t,i,n,r,void 0,void 0,o),t.set({name:r,eye:i,target:n})}.bind(this));else{var h=Be().sanitize(a);this._setHotspot(e,t,i,n,r,h,h,o)}},createAnnotationFromWorldPosition:function(e,t,i,n,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromWorldPosition(e,!0,!0);this._initializeAnnotationMarkdown(o,s,t,i,n,r,a)},createAnnotationFromScenePosition:function(e,t,i,n,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromScenePosition(e,!0,!0);this._initializeAnnotationMarkdown(o,s,t,i,n,r,a)},_getFeatureModel:function(e){if(this._partial.scene){var t=this._partial.scene.getFeatures()[e];if(t)return t.getModel()}},hideAnnotationTooltip:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots");if(i){var n=1;return i.each((function(t){n===e&&t.set("hideAnnotationTooltip",!0),n++})),void t(null)}t("no annotations at all")},showAnnotationTooltip:function(e,t){var i=this._getFeatureModel("hotspot");i.get("proxyModel").set("hideAnnotationTooltip",void 0);var n=i.get("hotspots");if(n){var r=1;return n.each((function(t){r===e&&t.set("hideAnnotationTooltip",void 0),r++})),void t(null)}t("no annotations at all")},hideAnnotationTooltips:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots");if(i)return i.each((function(e){e.set("hideAnnotationTooltip",!0)})),void t(null);t("no annotations at all")},showAnnotationTooltips:function(e){var t=this._getFeatureModel("hotspot");t.get("proxyModel").set("hideAnnotationTooltip",void 0);var i=t.get("hotspots");if(i)return i.each((function(e){e.set("hideAnnotationTooltip",void 0)})),void e(null);e("no annotations at all")}});const ye=we;var Me=function(){ye.apply(this,arguments)};Me.prototype=(0,Y.Z)(ye.prototype,{hideAnnotationTooltip:function(e,t){var i=this._getFeatureModel("hotspot").get("hotspots");if(i){var n=0;return i.each((function(t){n===e&&t.set("hideAnnotationTooltip",!0),n++})),void t(null)}t("no annotations at all")},showAnnotationTooltip:function(e,t){var i=this._getFeatureModel("hotspot");i.get("proxyModel").set("hideAnnotationTooltip",void 0);var n=i.get("hotspots");if(n){var r=0;return n.each((function(t){r===e&&t.set("hideAnnotationTooltip",void 0),r++})),void t(null)}t("no annotations at all")},hideAnnotationTooltips:function(e){var t=this._getFeatureModel("hotspot").get("hotspots");if(t)return t.each((function(e){e.set("hideAnnotationTooltip",!0)})),void e(null);e("no annotations at all")},removeTexture:function(e,t){var i=!1,n=_.Z.instance.getTextureCollection(),r=n.get(e);r&&(r.isTextureNull&&!r.isTextureNull()&&r.releaseGLObjects(),n.remove(e),r.destroy(),i=!0);var a=this._getFeatureModel("material").getImageCollection();if(a&&a.forEach((function(t){void 0!==t&&(t.getUID()===e&&(a.remove(t),i=!0),0===t.getImages.length&&a.remove(t),t.destroy())})),!i)return t("failed to find  texture "+e);t()}});const De=Me;var be=function(){De.apply(this,arguments)};be.prototype=(0,Y.Z)(De.prototype,{createMaterial:function(e,t){t(null,this._getFeatureModel("material").makeMaterial(e).getJSON())},assignMaterial:function(e,t,i){var n=this._getFeatureModel("material"),r=this._getNodeFromUserNodeID(e.instanceID);r?(n.assignMaterial(r,t),i(null)):i("Couldn't find node, make sure node.instanceID is set with a proper value")},createDecal:function(e,t){try{var i,n=this._getFeatureView("Decals").createDecalFromData(e);t(void 0!==n?null:"Couldn't create the decal (no surface hit for this position and normal)",n)}catch(i){t("Error when creating decal:\n"+i)}},destroyDecal:function(e,t,i){2===arguments.length&&(i=t);try{var n=this._getFeatureView("Decals");n.destroyDecal(e,t),i(null)}catch(t){i("Error when deleting decal: "+e+":\n"+t)}},findDecalFromWorldPosition:function(e,t){try{t(null,this._getFeatureView("Decals").findDecalFromWorldPosition(e))}catch(e){t("Error when trying to find decal:\n"+e)}},pickFromTextureCoordinates:function(e,t,i){try{var n=this._getNodeFromUserNodeID(e.instanceID);i(null,this._getFeatureView("Decals").getWorldHitFromTexCoord(n,t))}catch(e){console.log(e),i("Error when calling pickFromTextureCoordinates:\n"+e)}},_getFeatureView:function(e){if(this._partial.scene){var t=this._partial.scene.getFeatures()[e];if(t)return t._views[0]}},_initializeAnnotationMarkdown:function(e,t,i,n,r,a,o){var s=!1;if(a&&a.length)for(var A=[/!\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,/\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,/\n([^\n]+)\n/g,/\n(#+)(.*)/g,/\*\*(.*?)\*\*/g,/(\*|_)(.*?)\1/g,/\~\~(.*?)\~\~/g,/\:\"(.*?)\"\:/g,/\n\s*```\n([^]*?)\n\s*```\s*\n/g,/`(.*?)`/g,/\n(\*|\-|\+)(.*)/g,/\n[0-9]+\.(.*)/g,/\n(&gt;|\>)(.*)/g,/\n-{5,}/g,/(\|[^\n]+\|\r?\n)((?:\|:?[-]+:?)+\|)(\n(?:\|[^\n]+\|\r?\n?)*)?/g,/\s?<\/ul>\s?<ul>/g,/\s?<\/ol>\s?<ol>/g,/<\/blockquote>\n<blockquote>/g,/https?:\/\/[^"']*/g],g=0;g<A.length;)if(null!==a.match(A[g++])){s=!0;break}if(s)q.Z.getMarkdownPreview(a).then(function(s){this._setHotspot(e,t,i,n,r,a,s.result,o)}.bind(this),function(){this._setHotspot(e,t,i,n,r,void 0,void 0,o),t.set({name:r,eye:i,target:n})}.bind(this));else{var h=Be().sanitize(a);this._setHotspot(e,t,i,n,r,h,h,o)}}});const Qe=be;var xe=function(){Qe.apply(this,arguments)};xe.prototype=(0,Y.Z)(Qe.prototype,{setCameraRoll:function(e,t){this._getViewerOSG().getManipulator().setCameraRoll(e),t(null)}});const Te=xe;var Fe=function(){Te.apply(this,arguments)};Fe.prototype=(0,Y.Z)(Te.prototype,{setLight:function(e,t,i){var n=this._getFeatureModel("lighting").get("lights")[e];t&&(void 0!==t.type&&n.set("type",t.type),void 0!==t.attachedToCamera&&n.set("attachedToCamera",t.attachedToCamera),void 0!==t.matrix&&n.set("matrix",t.matrix),void 0!==t.enabled&&n.set("enable",t.enabled),void 0!==t.type&&n.set("type",t.type),void 0!==t.shadowEnabled&&n.set("castShadows",t.shadowEnabled),void 0!==t.color&&n.set("color",t.color),void 0!==t.intensity&&n.set("intensity",t.intensity),void 0!==t.angle&&n.set("angle",t.angle),void 0!==t.falloff&&n.set("falloff",t.falloff)),E.Z.redrawShadow(),i(null)},getLight:function(e,t){var i=this._getFeatureModel("lighting").get("lights");(!i||e>=i.length)&&t("light with id "+e.toString()+" not found");var n=i[e];t(null,{type:n.get("type"),attached:n.get("attachedToCamera"),matrix:n.get("matrix"),enabled:n.get("enable"),shadowEnabled:n.get("castShadows"),color:n.get("color"),intensity:n.get("intensity"),angle:n.get("angle"),falloff:n.get("falloff")})}});const Re=Fe;var Ne=i("7txH"),Le=i("eKF4"),ke={APICore1_0:L,APICore1_2:W,APICore1_3:te,APICore1_4:Ae,APICore1_5:Ie,APICore1_6:fe,APICore1_7:me,APICore1_8:ye,APICore1_9:De,APICore1_10:Qe,APICore1_11:Te,APICore1_12:Re},Pe=function(e){this._definitions={},this._instance=void 0,this._instanceId=e,this._name=void 0,this._parentDomain=this.getMessageTargetDomain(document.referrer),this._defer=new A.Z};Pe.create=function(e,t,i,n){var r;if(t){var a=t;r=new Pe(e);var o=h()[t];if(!o){var s=Object.keys(h()),A=s[s.length-1];o=h()[A],console.warn("you requested api version "+t+" but this version is not available. Returned api version "+A+" instead"),a=A}var g=function(e,t){return new ke[e](t)}("APICore"+o.ApiCoreVersion,i);r.register(a,o,g)}else(r=new u).initialize(i,n),console.warn("you are using a deprecated api, please update to the new one, read mode xxxx");return r},Pe.prototype={ready:function(){if(window.parent){var e=(0,s.Z)().apiHookEnv;if(void 0!==e)if(Le.Z.me().get("isStaff")){var t=new XMLHttpRequest,i=function(e){if(t.readyState===XMLHttpRequest.DONE){var i=JSON.parse(e.target.response);if(i.domain){var n=i.domain;if(n===window.location.hostname);else{var r={type:"api.ready",instanceId:this._instanceId,results:[this._instanceId],options:{domain:n}};window.parent.postMessage(r,this._parentDomain)}}}}.bind(this);t.addEventListener("load",i),t.open("GET","/i/users/viewer-api/authorized-domains?domain="+e);var n=document.cookie.match(new RegExp("sb_csrftoken=([^;]+)"));n||console.error("CRSF cookie missing");var r=n[1];t.setRequestHeader("X-CSRFToken",r),t.send()}var a={type:"api.ready",instanceId:this._instanceId,results:[this._instanceId]};(0,Ne.Z)()||(a.error="No Hardware Support for Webgl"),window.parent.postMessage(a,this._parentDomain)}},clientReady:function(){return this._defer.promise},register:function(e,t,i){this._name=e,this._members=Object.keys(t),this._membersMapping=t,this._instance=i,this.init()},getViewerAPI:function(){return this._instance},getMessageTargetDomain:function(e){if(!e||!e.length)return"*";var t=e.split("//");return t[0]+"//"+t[1].split("/")[0]},init:function(){this._defer.resolve();var e=["api.initialize","api.request"],t=Object.getPrototypeOf(this._instance);window.addEventListener("message",function(i){if((i.origin===this._parentDomain||"*"===this._parentDomain)&&i.data&&i.data.type){var n=i.data.type;if(-1!==e.indexOf(n)){var r="api.initialize"!==n;if(!r||i.data.instanceId&&i.data.instanceId===this._instanceId)try{if(r&&this._instanceId!==i.data.instanceId)throw"Invalid request : instance does not exists";if("api.request"===i.data.type){var a=this._membersMapping[i.data.member];if("-"===a&&(a=i.data.member),!a||!t[a])throw"Invalid request : member function does not exists: "+a;if("function"!=typeof t[a])throw"Invalid request : member function does not exists: "+a;for(var o=t[a],s=i.data.arguments.slice(),A=s.length-1;A>=0&&void 0===s[A];A--)s.splice(A,1);return o.length&&"function"==typeof s[o.length-1]&&(s.length=o.length-1),s.push(function(){i.source.postMessage({type:"api.request.result",instanceId:this._instanceId,requestId:i.data.requestId,results:Array.prototype.slice.call(arguments)},this._parentDomain)}.bind(this)),void o.apply(this._instance,s)}if("api.initialize"===i.data.type){if(this._name!==i.data.name)throw"No API named '"+i.data.name+"'";var g=this._members,h=this._instance;if(void 0!==h.addGlobalListener){var c=function(){var e={type:"api.event",instanceId:this._instanceId,results:Array.prototype.slice.call(arguments)};i.source.postMessage(e,this._parentDomain)}.bind(this);h.addGlobalListener(c)}return void i.source.postMessage({type:"api.initialize.result",instanceId:this._instanceId,requestId:i.data.requestId,results:[null,this._instanceId,g]},this._parentDomain)}}catch(e){console.error(e),i.source.postMessage({type:n+".result",instanceId:this._instanceId,requestId:i.data.requestId,results:[e.stack?e.stack:e]},this._parentDomain)}}}}.bind(this))}};const Ue=Pe;var Oe=i("EbOf"),Ge=i("3pbp"),He=i("VlB/"),Ke=i("nv4P");function Ze(){var e=!0,t=!1;try{t=window.self!==window.top}catch(e){t=!0}try{document.cookie}catch(t){e=!1}return t&&!e}var Ve=i("U6YP"),Ye=i("/X5V"),Je=i("1HPd"),ze=i("P8KE");const je=Je.Z.extend({events:{"click .share-link button":"copyToClipboard",'click [data-action="share-on-facebook"]':"shareOnFacebook",'click [data-action="share-on-linkedin"]':"shareOnLinkedin",'click [data-action="share-on-pinterest"]':"shareOnPinterest",'click [data-action="share-on-reddit"]':"shareOnReddit",'click [data-action="share-on-tumblr"]':"shareOnTumblr",'click [data-action="share-on-twitter"]':"shareOnTwitter"},constructor:function(){this.handleKeyboardEvents=this.handleKeyboardEvents.bind(this),Je.Z.prototype.constructor.apply(this,arguments)},show:function(){var e=this;this.model||(this.model=this.viewer._currentModel),this.model.sharing(),this.model.on("change:sharing",this.render.bind(this)),Je.Z.prototype.show.apply(this,arguments),this.clipboard||Promise.all([i.e(8486),i.e(8926),i.e(3009),i.e(6701),i.e(1777)]).then(i.t.bind(i,"F1yB",23)).then((function(t){e.clipboard=new t.default(e.$(".share-link button")[0]),e.listenClipboard.call(e),"function"==typeof e.callAfterClipboardLoaded&&e.callAfterClipboardLoaded()}))},delegateEvents:function(){Je.Z.prototype.delegateEvents.apply(this,arguments),r()(document).on("keyup",this.handleKeyboardEvents)},undelegateEvents:function(){Je.Z.prototype.undelegateEvents.apply(this,arguments),r()(document).off("keyup",this.handleKeyboardEvents)},handleKeyboardEvents:function(e){27===e.keyCode&&this.hide()},render:function(){this.$(".share-link .text").val(this.model.get("sharing").shortUrl),this.$(".share-social").attr("href",this.model.get("viewerUrl")+"#email"),this.$(".share-embed .button").attr("href",this.model.get("viewerUrl")+"#embed"),this.$(".share-mail").attr("href",ze.Z.getMailTo({modelName:this.model.get("name"),userName:this.model.get("user").displayName,url:this.model.get("viewerUrl"),isCollectionMode:!1}))},listenClipboard:function(){this.clipboard.on("success",function(){var e=this.viewer?this.viewer:this.options.embedPage.viewer;e&&e.subviews.osd.show("Copied to clipboard.",{duration:5e3,position:"top"})}.bind(this)),this.clipboard.on("error",function(){this.viewer.subviews.osd.show("Could not copy to clipboard.",{duration:5e3,position:"top"})}.bind(this))},copyToClipboard:function(){this.clipboard||(this.callAfterClipboardLoaded=this.copyToClipboard)},getShareModel:function(){return i.e(2542).then(i.bind(i,"PNd5")).then((function(e){return e.default}))},shareOnFacebook:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnFacebook(t.model.get("sharing").shortUrl)}))},shareOnTwitter:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnTwitter(t.model.toJSON(),t.model.get("sharing"))}))},shareOnPinterest:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnPinterest(t.model.toJSON(),t.model.get("sharing"))}))},shareOnReddit:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnReddit(t.model.toJSON(),t.model.get("sharing"))}))},shareOnTumblr:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnTumblr(t.model.toJSON(),t.model.get("sharing"))}))},shareOnLinkedin:function(e){var t=this;e.preventDefault(),this.getShareModel().then((function(e){e.shareOnLinkedin(t.model.toJSON(),t.model.get("sharing"))}))}});var We=i("fEbO");const qe=Ke.Z.extend({mixins:[He.Z,Ge.Z],events:{'click [data-action="start"]':"start",'click [data-action="allowRestricted"]':"allowRestricted"},initialize:function(){if(Ze())this.$el.addClass("embed-sandboxed");else if(Ke.Z.prototype.initialize.apply(this,arguments),!0!==this.model.get("isDeleted")){var e=!!(0,s.Z)().autostart;(e||(0,s.Z)().apiId)&&this.start(e);var t=(0,s.Z)().uiInfos;if(void 0===t){var i=(0,s.Z)().descButton;t=void 0===i||i}this.initializeSharingOverlay(),this.afterRender(),Le.Z.me().canAccessFeature("ff_useonevieweratatime")&&this.attachPostMessageListener()}},attachPostMessageListener:function(){var e=this;window.addEventListener("message",(function(t){if(e.viewer)switch(t.data){case We.s0:return e.viewer.stop();case We.d9:return e.viewer.start()}}),!1)},start:(0,Oe.Z)((function(e){this.initializeViewer(e)})),allowRestricted:function(){Le.Z.me().setAllowsRestricted(!0),this.$(".overlay.restricted").addClass("hidden")},initializeSharingOverlay:function(){this.shareOverlay=new je({el:this.$(".share.overlay"),model:this.model,embedPage:this}),this.onShareClick=this.onShareClick.bind(this),this.$(".titlebar .actions .share").on("click",this.onShareClick)},onShareClick:function(){this.shareOverlay.show()},onViewerStart:function(){this.$(".titlebar .actions .share").off("click",this.onShareClick)},onViewerStop:function(){},initializeViewer:function(e){var t=this.$(".viewer");this.$(".play-button").addClass("loading"),e&&t.addClass("started");var i=new Ye.Z({el:t});this.viewer=i;var n=(0,s.Z)().apiVersion,r=Ue.create((0,s.Z)().apiId,n,i,this.model.get("uid"));i.on("start",this.onViewerStart),i.on("stop",this.onViewerStop),i.setScene({uid:this.model.get("uid"),features:Ve.Z,viewerAPI:r.getViewerAPI()}),this.$(".play-button").removeClass("loading"),r?(this.api=r,r.ready(),r.clientReady().then((function(){e&&i.start(e)}))):e&&i.start(e)},toggleUserSummary:function(){var e=!(!this.inAvatar&&!this.inUserSummary);this.userSummary[e?"show":"hide"]()},enterAvatar:function(e){var t=r()(e.currentTarget).data("user");this.inAvatar=!0,this.userSummary.setUser(t),this.userSummary.anchor(e.currentTarget),this.toggleUserSummary()},leaveAvatar:function(){this.inAvatar=!1,this.toggleUserSummary()},enterUserSummary:function(){this.inUserSummary=!0,this.toggleUserSummary()},leaveUserSummary:function(){this.inUserSummary=!1,this.toggleUserSummary()}});var Xe=i("ejdl"),$e=i("iu9k");function et(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return tt(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return tt(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}(0,s.Z)().dnt||i.e(9224).then(i.bind(i,"rzdX"));var it=["models:embed","models:embed_specific_version"];(0,Xe.fN)((function(){(0,o.Z)();var e=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.pathname+window.location.search,n=et(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=(0,$e.EQ)(r,i);if(a)return a}}catch(e){n.e(e)}finally{n.f()}return{}}(it),t=e.model_id;a.Z.get(t).then((function(e){if("ok"===e.get("displayStatus"))return new qe({model:e,el:"body"})}))}))},ULsr:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("sQwH"),r=i("3MRe"),a=i("3Z9q"),o=i("AnwU"),s=i("tbFI"),A=i("QbBG"),g=["el","_isChildOfAComponent"];function h(e){return A.Z.extend({displayName:"FromReact(".concat(e.displayName||e.name,")"),optionTypes:e.propTypes,initialize:function(){A.Z.prototype.initialize.apply(this,arguments)},viewDidMount:function(){this.render()},viewWillReceiveOptions:function(e){this.renderReact(e)},shouldViewUpdate:function(){return!1},template:function(){return""},render:function(){this.renderReact(this.options)},viewWillUnmount:function(){this.el&&(0,o.unmountComponentAtNode)(this.el)},renderReact:function(t){if(!this.el)throw i=this.displayName,new Error("\n\nReactDOM.render error: `".concat(i,"` Component doesn't have a valid mount point. Check its selector.\n"));var i;(0,o.render)((0,n.Z)(s.n2.Provider,{},void 0,a.createElement(e,function(e){return e.el,e._isChildOfAComponent,(0,r.Z)(e,g)}(t))),this.el)}})}},"3pbp":(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("olZw");function r(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,A=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){A=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(A)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}const o={name:"LazyLoading",handleLazyLoading:function(){var e=this,t=function(){var t=e.$(".lazyload");if(t.length){var i,a=r(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(!(o instanceof HTMLElement))break;(0,n.S)(o)}}catch(e){a.e(e)}finally{a.f()}t.removeClass("lazyload")}};"complete"===document.readyState?t():window.addEventListener("load",t)},afterInitialize:function(){this.handleLazyLoading()},afterViewDidMount:function(){this.handleLazyLoading()},afterViewDidUpdate:function(){this.handleLazyLoading()}}},ejdl:(e,t,i)=>{"use strict";i.d(t,{$u:()=>s,fN:()=>A});var n=i("JBVY"),r=i("MQQR"),a=i("mSEu");function o(){var e;try{if(!(e=window.location!==window.parent.location?document.referrer:document.location.href))throw new Error("url is not defined")}catch(t){e=document.referrer}var t=document.createElement("a");return t.href=e,t}function s(){return o().hostname.replace(/^www\./,"")}function A(e){var t=o().host,i=!1;t===window.location.host?i=!0:a.Z.internalDomains.forEach((function(e){(t===e.domain||e.allowSubdomains&&t&&t.endsWith("."+e.domain))&&(i=!0)})),(0,r.Z)().internal&&!i?document.location.replace(n.ZP.craft("?",n.ZP.reset(window.location.search.substr(1),{internal:null}))):e()}},P8KE:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("nEhO"),r=i("KDlt");i("MPMW");const a={shareOnFacebook:function(e,t){n.Z.getSDK().then((function(i){i.ui({method:"share",href:e,quote:t})}))},shareOnTwitter:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{via:"sketchfab"},n=800,r=400,a=window.screen.width/2-n/2,o=window.screen.height/2-r/2,s="https://twitter.com/intent/tweet?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(t);Object.prototype.hasOwnProperty.call(i,"via")&&null!==i.via&&(s+="&via="+i.via);var A=window.open(s,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+n+", height="+r);A&&A.moveTo(a,o)},shareOnPinterest:function(e,t,i){var n=window.screen.width/2-390,r=window.screen.height/2-200,a="http://pinterest.com/pin/create/button/?url="+encodeURIComponent(e)+"&description="+encodeURIComponent(t)+"&media="+encodeURIComponent(i),o=window.open(a,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=780, height=400");o&&o.moveTo(n,r)},shareOnReddit:function(e,t){var i="https://www.reddit.com/submit?url="+encodeURIComponent(e)+"&title="+encodeURIComponent(t);window.open(i,"_blank")},shareOnTumblr:function(e,t){var i=window.screen.width/2-270,n=window.screen.height/2-300,a=r.Z.get("skfb_front/partials/embed/iframe",{model:e,parameters:{flags:[]}}),o="https://www.tumblr.com/widgets/share/tool?posttype=video&content="+encodeURIComponent(a.replace(/(\r\n|\n|\r)/gm,""))+"&canonicalUrl="+encodeURIComponent(t),s=window.open(o,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width=540, height=600");s&&s.moveTo(i,n)},shareOnLinkedin:function(e){var t=window.screen.width/2-300,i=window.screen.height/2-235,n="https://www.linkedin.com/sharing/share-offsite/?url=".concat(e),r=window.open(n,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=470");r&&r.moveTo(t,i)},getMailTo:function(e){var t=e.modelName,i=e.userName,n=e.isCollectionMode,r=e.url,a=t+" by "+i,o=n?["Check out this collection of 3D/VR models on Sketchfab:","\n",a,"\n",r+"?utm_source=email&utm_medium=email&utm_campaign=collection-shared"].join(""):["Check out this model in 3D and virtual reality on Sketchfab:","\n",a,"\n",r+"?utm_source=email&utm_medium=email&utm_campaign=model-shared"].join("");return"mailto:?subject="+encodeURIComponent(a)+"&body="+encodeURIComponent(o)}}},olZw:(e,t,i)=>{"use strict";i.d(t,{S:()=>n});var n=function(e){var t=e.dataset.uri||"",i=new Image;i.classList.add("lazyloaded"),i.onload=i.onerror=function(){var t=e.offsetWidth,n=i.naturalWidth>t?i.naturalHeight*(t/i.naturalWidth):i.naturalHeight;t?(["transitionend","webkittransitionend","moztransitionend"].forEach((function(t){return e.addEventListener(t,(function(){return e.replaceWith(i)}))}),{once:!0}),n!==e.offsetHeight?e.style.minHeight="".concat(n,"px"):e.classList.add("loaded")):e.replaceWith(i)},i.src=t}},KGKI:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("D4hk"),r=i("sQwH"),a=i("3MRe"),o=i("3Z9q"),s=i("X40V"),A=["onChange","value","name","disabled","className","data-selenium","checked","children"];const g=function(e){var t=e.onChange,i=e.value,g=e.name,h=void 0===g?"":g,c=e.disabled,l=void 0!==c&&c,u=e.className,d=e["data-selenium"],I=e.checked,C=void 0===I?i:I,f=e.children,p=(0,a.Z)(e,A);return o.createElement("div",(0,n.Z)({onClick:function(e){l||(e.preventDefault(),t(!i))},className:(0,s.AK)(u,"form-onoff-wrapper",{"--checked":C}),"data-selenium":"switch-".concat(d)},p),(0,r.Z)("input",{className:"form-onoff",type:"checkbox","data-ref":"input",checked:C,onChange:function(e){return t(e.target.checked)}}),(0,r.Z)("label",{className:(0,s.AK)({"form-onoff-actor":!0,disabled:l}),htmlFor:h}),(0,r.Z)("div",{className:(0,s.AK)("form-onoff__label",{"--disabled":l})},void 0,f))}},fEbO:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>g,d9:()=>s,s0:()=>o});var n=i("3Z9q"),r=i("xIYY"),a=i("tbFI"),o="viewer/stop",s="viewer/start";function A(e,t){try{e&&e.contentWindow&&e.contentWindow.postMessage(t,"*")}catch(e){console.error(e)}}function g(){var e;(0,r.v9)(a.wl.authUser.canAccessFeature("ff_useonevieweratatime"))&&n.useEffect((function(){return A(e=document.querySelector("#api-frame"),o),function(){A(e,s)}}),[])}},jX4j:()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/layouts/popup.jinja"]={b_popup_header:function(e,t,i,n,r){var a="";try{i=i.push(!0),a+='\n                <div class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupTitleStyle"),e.opts.autoescape),a+='">\n                    ',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupTitle"),e.opts.autoescape),r(null,a+="\n                </div>\n            ")}catch(e){r(n.handleError(e,null,null))}},b_popup_content:function(e,t,i,n,r){var a="";try{i=i.push(!0),r(null,a+="\n            ")}catch(e){r(n.handleError(e,null,null))}},b_popup_footer:function(e,t,i,n,r){var a="";try{i=i.push(!0),r(null,a+="\n                ")}catch(e){r(n.handleError(e,null,null))}},root:function(e,t,i,n,r){var a="";try{var o,s,A,g,h,c,l,u,d,I,C,f,p,m;n.contextOrFrameLookup(t,i,"isWhiteBackground")?(a+="\n    ",o="c-popup c-popup__container",i.set("popupStyle",o,!0),i.topLevel&&t.setVariable("popupStyle",o),i.topLevel&&t.addExport("popupStyle",o),a+="\n    ",s="c-popup__header",i.set("popupHeaderStyle",s,!0),i.topLevel&&t.setVariable("popupHeaderStyle",s),i.topLevel&&t.addExport("popupHeaderStyle",s),a+="\n    ",A="c-popup__title",i.set("popupTitleStyle",A,!0),i.topLevel&&t.setVariable("popupTitleStyle",A),i.topLevel&&t.addExport("popupTitleStyle",A),a+="\n    ",g="c-popup__actions",i.set("popupActionsStyle",g,!0),i.topLevel&&t.setVariable("popupActionsStyle",g),i.topLevel&&t.addExport("popupActionsStyle",g),a+="\n    ",h="c-popup__close",i.set("popupCloseStyle",h,!0),i.topLevel&&t.setVariable("popupCloseStyle",h),i.topLevel&&t.addExport("popupCloseStyle",h),a+="\n    ",c="c-popup__content",i.set("popupContentStyle",c,!0),i.topLevel&&t.setVariable("popupContentStyle",c),i.topLevel&&t.addExport("popupContentStyle",c),a+="\n    ",l="c-popup__footer",i.set("popupFooterStyle",l,!0),i.topLevel&&t.setVariable("popupFooterStyle",l),i.topLevel&&t.addExport("popupFooterStyle",l),a+="\n"):(a+="\n    ",u="popup",i.set("popupStyle",u,!0),i.topLevel&&t.setVariable("popupStyle",u),i.topLevel&&t.addExport("popupStyle",u),a+="\n    ",d="popup-header",i.set("popupHeaderStyle",d,!0),i.topLevel&&t.setVariable("popupHeaderStyle",d),i.topLevel&&t.addExport("popupHeaderStyle",d),a+="\n    ",I="popup-title",i.set("popupTitleStyle",I,!0),i.topLevel&&t.setVariable("popupTitleStyle",I),i.topLevel&&t.addExport("popupTitleStyle",I),a+="\n    ",C="popup-actions",i.set("popupActionsStyle",C,!0),i.topLevel&&t.setVariable("popupActionsStyle",C),i.topLevel&&t.addExport("popupActionsStyle",C),a+="\n    ",f="popup-close",i.set("popupCloseStyle",f,!0),i.topLevel&&t.setVariable("popupCloseStyle",f),i.topLevel&&t.addExport("popupCloseStyle",f),a+="\n    ",p="popup-content",i.set("popupContentStyle",p,!0),i.topLevel&&t.setVariable("popupContentStyle",p),i.topLevel&&t.addExport("popupContentStyle",p),a+="\n    ",m="popup-footer",i.set("popupFooterStyle",m,!0),i.topLevel&&t.setVariable("popupFooterStyle",m),i.topLevel&&t.addExport("popupFooterStyle",m),a+="\n"),a+='\n\n<div class="popup-container',n.contextOrFrameLookup(t,i,"popupNeedsLoading")&&(a+=" popup-loading"),a+=" ",a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupClass"),e.opts.autoescape),a+='">\n    <form class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupStyle"),e.opts.autoescape),a+=' js-popup" method="post"',n.contextOrFrameLookup(t,i,"allowAutocomplete")||(a+=' autocomplete="off"'),a+=" ",n.contextOrFrameLookup(t,i,"popupAction")&&(a+='action="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupAction"),e.opts.autoescape),a+='"'),a+=">\n\n        ",n.contextOrFrameLookup(t,i,"allowAutocomplete")||(a+="\n            ",a+='\n            <input type="text" style="display:none" />\n            <input type="password" style="display:none" />\n        '),a+='\n\n        <header class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupHeaderStyle"),e.opts.autoescape),a+='">\n\n            ',t.getBlock("popup_header")(e,t,i,n,(function(o,s){o?r(o):(a+=s,a+='\n\n            <div class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupActionsStyle"),e.opts.autoescape),a+='">\n                ',n.contextOrFrameLookup(t,i,"popupClosable")&&(a+='\n                    <a class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupCloseStyle"),e.opts.autoescape),a+='" data-action="close" data-selenium="close-popup">\n                        <i class="fa-regular fa-times"></i>\n                    </a>\n                '),a+='\n            </div>\n\n        </header>\n\n        <div class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupContentStyle"),e.opts.autoescape),a+=" ",a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupContentClass"),e.opts.autoescape),a+='">\n            ',t.getBlock("popup_content")(e,t,i,n,(function(o,s){o?r(o):(a+=s,a+="\n        </div>\n\n        ",e.getFilter("default").call(t,n.contextOrFrameLookup(t,i,"withFooter"),!0)&&(a+='\n            <footer class="',a+=n.suppressValue(n.contextOrFrameLookup(t,i,"popupFooterStyle"),e.opts.autoescape),a+='">\n                ',t.getBlock("popup_footer")(e,t,i,n,(function(e,t){e?r(e):(a+=t,a+="\n            </footer>\n        ")}))),r(null,a+="\n\n    </form>\n\n</div>\n"))})))}))}catch(e){r(n.handleError(e,null,null))}}}},qeHZ:()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/atoms/dropdown.jinja"]={root:function(e,t,i,n,r){var a="";try{var o=n.makeMacro([],["options"],(function(r){var a=i;i=new n.Frame,(r=r||{}).hasOwnProperty("caller")&&i.set("caller",r.caller),i.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n    ",o=e.getFilter("merge").call(t,{labelTitle:"",labelValue:"",className:"",longestLabelValue:"",placeholder:"",theme:"",color:"",components:{},disabled:!1,isOpen:!1,withBackground:!1,grey:!1},n.contextOrFrameLookup(t,i,"options")),i.set("options",o,!0),i.topLevel&&t.setVariable("options",o),i.topLevel&&t.addExport("options",o),s+='\n    <div\n        class="c-dropdown ',s+=n.suppressValue(e.getFilter("class_names").call(t,{"--disabled":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"disabled"),"--open":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"isOpen"),"--with-background":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withBackground"),"--grey":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"grey")}),e.opts.autoescape),s+=" ",s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),s+=" ",s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"theme")?"--"+n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"theme")+"-theme":"",e.opts.autoescape),s+='">\n        <div\n            class="c-dropdown__label"\n            data-action="toggle-menu"\n            data-disabled="',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"disabled"),e.opts.autoescape),s+='">\n            <span\n                data-ref="labelTitle"\n                class="c-dropdown__label-title">\n                ',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelTitle")?n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelTitle"):"",e.opts.autoescape),s+='\n            </span>\n\n            <span\n                class="',s+=n.suppressValue(e.getFilter("class_names").call(t,{"c-dropdown__label-value":!0,"--placeholder":!n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelValue")}),e.opts.autoescape),s+='"\n                style="',s+=n.suppressValue(e.getFilter("style").call(t,{color:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelValue")?n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"color"):""}),e.opts.autoescape),s+='">\n                <span class="c-dropdown__label-value__text ',s+=n.suppressValue(e.getFilter("class_names").call(t,{"--absolute":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"longestLabelValue")}),e.opts.autoescape),s+='">\n                    ',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelValue")?n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"labelValue"):n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"placeholder"),e.opts.autoescape),s+='\n                </span>\n\n                <span class="c-dropdown__label-value__hidden">',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"longestLabelValue"),e.opts.autoescape),s+='</span>\n            </span>\n        </div>\n        <div\n            data-ref="menu"\n            class="c-dropdown__menu ',s+=n.suppressValue(e.getFilter("class_names").call(t,{"--open":n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"isOpen")}),e.opts.autoescape),s+='">\n            ',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"isOpen")?e.getFilter("component").call(t,n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"components"),"child")):"",e.opts.autoescape),s+="\n        </div>\n    </div>\n",i=a,new n.SafeString(s)}));t.addExport("dropdown"),t.setVariable("dropdown",o),r(null,a+="\n")}catch(e){r(n.handleError(e,null,null))}}}},VlHN:()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/hotspot.jinja"]={root:function(e,t,i,n,r){var a=null,o=null;try{var s=n.makeMacro([],["options"],(function(r){var s=i;i=new n.Frame,(r=r||{}).hasOwnProperty("caller")&&i.set("caller",r.caller),i.set("options",r.hasOwnProperty("options")?r.options:{});var A="";A+="\n",i.set("width_before",30,!0),i.topLevel&&t.setVariable("width_before",30),i.topLevel&&t.addExport("width_before",30),A+="\n",i.set("width_next",960,!0),i.topLevel&&t.setVariable("width_next",960),i.topLevel&&t.addExport("width_next",960),A+='\n        <div class="vr-hotspot-content" style="width:',A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),A+='px;" id="hotspot',A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"hotspotIndex"),e.opts.autoescape),A+='">\n            <div class="cell" id="default" style="width:1024px;height:576px;position:absolute;top:0;left:0"></div>',i=i.push();var g=(a=5,o=32,n.callWrap(n.contextOrFrameLookup(t,i,"range"),"range",t,[0,n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"column")]));if(g)for(var h=g.length,c=0;c<g.length;c++){var l,u,d=g[c];i.set("column",d),i.set("loop.index",c+1),i.set("loop.index0",c),i.set("loop.revindex",h-c),i.set("loop.revindex0",h-c-1),i.set("loop.first",0===c),i.set("loop.last",c===h-1),i.set("loop.length",h),A+='<div class="page" id="column',A+=n.suppressValue(d,e.opts.autoescape),A+='" style="width:1024px;height:576px;position:absolute;top:0;left:',A+=n.suppressValue(1024*d,e.opts.autoescape),A+='px; overflow: visible">',d>0&&(A+='<div style="width:40px;height:40px;position:absolute;top:250px;left:30px" class="vr-icon vr-icon-arrow-left-white"></div>\n                        <button id="prevPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; left: 0;"></button>'),l=n.contextOrFrameLookup(t,i,"width_before")+1024,i.set("width_before",l,!0),i.topLevel&&t.setVariable("width_before",l),i.topLevel&&t.addExport("width_before",l),A+='\n                    <div class="vr-hotspot-title">',A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"title"),e.opts.autoescape),A+="</div>",d<1&&(A+='<div class="vr-hotspot-description" style="column-count:',A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"column"),e.opts.autoescape),A+=";width:",A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"widthContent"),e.opts.autoescape),A+='px">',A+=n.suppressValue(e.getFilter("safe").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"description")),e.opts.autoescape),A+="</div>"),d+1<n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"column")&&(A+='<button id="nextPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; right: 0;"></button>\n                        <div style="width:40px;height:40px;position:absolute;top:250px;left:960px" class="vr-icon vr-icon-arrow-right-white"></div>\n                        ',u=n.contextOrFrameLookup(t,i,"width_next")+1024,i.set("width_next",u,!0),i.topLevel&&t.setVariable("width_next",u),i.topLevel&&t.addExport("width_next",u)),A+='<div class="vr-hotspot-footer">\n                        <div class="vr-hotspot-container-button" >',n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"displayNavigation")?A+='<button id="prevButton" class="vr-hotspot-button">Prev</button>\n                                <button id="closeButton" class="vr-hotspot-button">Close annotation</button>\n                                <button id="nextButton" class="vr-hotspot-button">Next</button>':A+='<button id="closeButton" class="vr-hotspot-button">Close annotation</button>',A+="</div>\n                    </div>\n                </div>"}return i=i.pop(),A+="</div>\n",i=s,new n.SafeString(A)}));t.addExport("panel"),t.setVariable("panel",s),r(null,"")}catch(e){r(n.handleError(e,a,o))}}}},dElF:()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/model.jinja"]={root:function(e,t,i,n,r){var a=null,o=null,s="";try{var A=n.makeMacro(["model"],["options"],(function(r,s){var A=i;i=new n.Frame,(s=s||{}).hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("model",r),i.set("options",s.hasOwnProperty("options")?s.options:{});var g,h,c="";return c+="\n    ",g=e.getFilter("merge").call(t,{withStaffpickFlag:!0,withStaffpickLink:!1,withRestrictedFlag:!0,displayRecentlyStaffpicked:!1},n.contextOrFrameLookup(t,i,"options")),i.set("options",g,!0),i.topLevel&&t.setVariable("options",g),i.topLevel&&t.addExport("options",g),c+="\n    ",h=n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"displayRecentlyStaffpicked")&&n.memberLookup(r,"recentlyStaffpicked"),i.set("recentlyStaffpicked",h,!0),i.topLevel&&t.setVariable("recentlyStaffpicked",h),i.topLevel&&t.addExport("recentlyStaffpicked",h),c+="\n\n    ",n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withStaffpickLink")&&n.memberLookup(r,"staffpickedAt")?(c+='\n        <meta itemprop="award" content="Staff Pick" />\n        <a href="',c+=n.suppressValue((a=11,o=21,n.callWrap(n.contextOrFrameLookup(t,i,"url"),"url",t,["models:staffpicks"])),e.opts.autoescape),c+='" class="flag --staffpicked" title="See all staff picks"></a>\n    '):n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withStaffpickFlag")&&n.memberLookup(r,"staffpickedAt")?(c+='\n        <meta itemprop="award" content="Staff Pick" />\n        <span class="flag --staffpicked ',n.contextOrFrameLookup(t,i,"recentlyStaffpicked")&&(c+="--with-text"),c+='" title="Staff Picks"></span>\n    ',c+="\n    "):0==n.memberLookup(r,"isPublished")&&(c+='\n        <span class="flag --draft"></span>\n    '),c+="\n\n    ",(n.memberLookup(r,"isRestricted")||n.memberLookup(r,"isAdult"))&&(c+="\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withRestrictedFlag")&&(c+='\n            <a\n                href="https://help.sketchfab.com/hc/en-us/articles/214867883-What-is-Restricted-Content-?utm_source=website&utm_campaign=restrictedcontent"\n                target="_blank"\n                class="flag --restricted"\n                title="Restricted Content"\n                rel="noopener noreferrer"></a>\n        '),c+="\n    "),c+="\n",i=A,new n.SafeString(c)}));t.addExport("model_labels"),t.setVariable("model_labels",A),s+="\n\n";var g=n.makeMacro(["model"],["options"],(function(r,s){var A=i;i=new n.Frame,(s=s||{}).hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("model",r),i.set("options",s.hasOwnProperty("options")?s.options:{});var g,h="";return g=e.getFilter("merge").call(t,{clickable:!0},n.contextOrFrameLookup(t,i,"options")),i.set("options",g,!0),i.topLevel&&t.setVariable("options",g),i.topLevel&&t.addExport("options",g),h+='<span class="model-name">\n\n        ',n.memberLookup(r,"visibility")&&(h+="\n            ","private"==n.memberLookup(r,"visibility")?h+='\n                <i class="icon viewer-icon-eye-slash"></i>\n            ':"protected"==n.memberLookup(r,"visibility")&&(h+='\n                <i class="icon viewer-icon-lock"></i>\n            '),h+="\n        "),h+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"clickable")?(h+='\n            <a class="model-name__label" data-route href="',h+=n.suppressValue(n.memberLookup(r,"viewerUrl"),e.opts.autoescape),h+='"',n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"target")&&(h+=' target="',h+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"target"),e.opts.autoescape),h+='"'),h+=' title="',h+=n.suppressValue("store"==n.memberLookup(r,"downloadType")?"Buy ":"",e.opts.autoescape),h+=n.suppressValue(n.memberLookup(r,"name"),e.opts.autoescape),h+=' 3D Model">',h+=n.suppressValue(n.memberLookup(r,"name"),e.opts.autoescape),h+="</a>\n        "):(h+='\n            <span class="model-name__label">',h+=n.suppressValue(n.memberLookup(r,"name"),e.opts.autoescape),h+="</span>\n        "),h+="\n\n        ",h+=n.suppressValue((a=52,o=21,n.callWrap(n.contextOrFrameLookup(t,i,"model_labels"),"model_labels",t,[r,n.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),h+="\n\n    </span>",i=A,new n.SafeString(h)}));t.addExport("model_name"),t.setVariable("model_name",g),s+="\n\n";var h=n.makeMacro(["model"],["options"],(function(r,a){var o=i;i=new n.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",r),i.set("options",a.hasOwnProperty("options")?a.options:{});var s,A,g="";return s=e.getFilter("merge").call(t,{withUsernameMention:!0,withSuffix:!1,withUid:!0},n.contextOrFrameLookup(t,i,"options")),i.set("options",s,!0),i.topLevel&&t.setVariable("options",s),i.topLevel&&t.addExport("options",s),A=n.memberLookup(r,"org")?n.memberLookup(r,"org"):n.memberLookup(r,"user"),i.set("uploader",A,!0),i.topLevel&&t.setVariable("uploader",A),i.topLevel&&t.addExport("uploader",A),g+=n.suppressValue(n.memberLookup(r,"name")+" - "+("store"==n.memberLookup(r,"downloadType")?"Buy Royalty Free ":"free"==n.memberLookup(r,"downloadType")?"Download Free ":"")+"3D model by "+n.memberLookup(n.contextOrFrameLookup(t,i,"uploader"),"displayName")+(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withUsernameMention")&&e.getFilter("lower").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"uploader"),"displayName"))!=e.getFilter("lower").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"uploader"),"username"))?" (@"+n.memberLookup(n.contextOrFrameLookup(t,i,"uploader"),"username")+")":"")+(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withUid")?" ["+e.getFilter("truncate").call(t,n.memberLookup(r,"uid"),n.makeKeywordArgs({length:7,killwords:n.contextOrFrameLookup(t,i,"True"),end:""}))+"]":"")+(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"withSuffix")?" - Sketchfab"+("store"==n.memberLookup(r,"downloadType")?" Store":""):""),e.opts.autoescape),i=o,new n.SafeString(g)}));t.addExport("model_page_title"),t.setVariable("model_page_title",h),s+="\n\n";var c=n.makeMacro(["list"],["options"],(function(r,s){var A=i;i=new n.Frame,(s=s||{}).hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("list",r),i.set("options",s.hasOwnProperty("options")?s.options:{});var g,h,c,l="";g=e.getFilter("merge").call(t,{maxDisplayed:3,othersHref:""},n.contextOrFrameLookup(t,i,"options")),i.set("options",g,!0),i.topLevel&&t.setVariable("options",g),i.topLevel&&t.addExport("options",g),h=e.getFilter("first_n").call(t,r,n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"maxDisplayed")),i.set("shortList",h,!0),i.topLevel&&t.setVariable("shortList",h),i.topLevel&&t.addExport("shortList",h),c=e.getFilter("length").call(t,r)-e.getFilter("length").call(t,n.contextOrFrameLookup(t,i,"shortList")),i.set("otherCount",c,!0),i.topLevel&&t.setVariable("otherCount",c),i.topLevel&&t.addExport("otherCount",c),i=i.push();var u=n.contextOrFrameLookup(t,i,"shortList");if(u)for(var d=u.length,I=0;I<u.length;I++){var C=u[I];i.set("model",C),i.set("loop.index",I+1),i.set("loop.index0",I),i.set("loop.revindex",d-I),i.set("loop.revindex0",d-I-1),i.set("loop.first",0===I),i.set("loop.last",I===d-1),i.set("loop.length",d),n.memberLookup(n.contextOrFrameLookup(t,i,"loop"),"first")||(n.memberLookup(n.contextOrFrameLookup(t,i,"loop"),"last")&&n.contextOrFrameLookup(t,i,"otherCount")<1?l+="<span> and </span>":l+="<span>, </span>"),l+=n.suppressValue((a=86,o=19,n.callWrap(n.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[C,{withStaffpickFlag:!1,withStaffpickLink:!1,withRestrictedFlag:!1}])),e.opts.autoescape)}return i=i.pop(),n.contextOrFrameLookup(t,i,"otherCount")>0&&(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"othersHref")?(l+='<a href="',l+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"othersHref"),e.opts.autoescape),l+='" class="others"> and ',l+=n.suppressValue(n.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),l+=" other",l+=n.suppressValue(e.getFilter("pluralize").call(t,n.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),l+="</a>"):(l+='<span class="others"> and ',l+=n.suppressValue(n.contextOrFrameLookup(t,i,"otherCount"),e.opts.autoescape),l+=" other",l+=n.suppressValue(e.getFilter("pluralize").call(t,n.contextOrFrameLookup(t,i,"otherCount")),e.opts.autoescape),l+="</span>")),i=A,new n.SafeString(l)}));t.addExport("model_name_list"),t.setVariable("model_name_list",c),s+="\n\n";var l=n.makeMacro([],["options"],(function(e){var r=i;i=new n.Frame,(e=e||{}).hasOwnProperty("caller")&&i.set("caller",e.caller),i.set("options",e.hasOwnProperty("options")?e.options:{});var a="";return a+='\n\n    <ul class="hover-menu quicksettings corner',"up"==n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"direction")&&(a+=" hover-menu-up"),"left"==n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"direction")&&(a+=" --left"),a+='">\n        <li><a data-action="remove-model">Remove</a></li>\n    </ul>\n\n',i=r,new n.SafeString(a)}));t.addExport("collection_item_quicksettings"),t.setVariable("collection_item_quicksettings",l),s+="\n\n",s+="\n";var u=n.makeMacro(["authUser","model"],["options"],(function(r,s,A){var g=i;i=new n.Frame,(A=A||{}).hasOwnProperty("caller")&&i.set("caller",A.caller),i.set("authUser",r),i.set("model",s),i.set("options",A.hasOwnProperty("options")?A.options:{});var h,c="";return c+='\n    <div class="model-uploadcard">',h=e.getFilter("merge").call(t,{withStaffpickFlag:!1},n.contextOrFrameLookup(t,i,"options")),i.set("options",h,!0),i.topLevel&&t.setVariable("options",h),i.topLevel&&t.addExport("options",h),c+='<p class="filename">',n.memberLookup(s,"name")?c+=n.suppressValue((a=117,o=27,n.callWrap(n.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[s,n.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape):(c+='<a data-route href="',c+=n.suppressValue(n.memberLookup(s,"viewerUrl"),e.opts.autoescape),c+='">\n                    ',c+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(s,"originalFileName"),"No file name"),e.opts.autoescape),c+="\n                </a>"),c+='</p>\n        <div class="meta">\n            ',n.memberLookup(s,"isPublished")?n.memberLookup(s,"processedAt")?(c+='\n                <span class="date" title="',c+=n.suppressValue(n.memberLookup(s,"processedAt"),e.opts.autoescape),c+='">',c+=n.suppressValue(e.getFilter("time_ago").call(t,n.memberLookup(s,"processedAt")),e.opts.autoescape),c+="</span>\n            "):(c+='\n                <span class="date" title="',c+=n.suppressValue(n.memberLookup(s,"createdAt"),e.opts.autoescape),c+='">',c+=n.suppressValue(e.getFilter("time_ago").call(t,n.memberLookup(s,"createdAt")),e.opts.autoescape),c+="</span>\n            "):(c+='\n                <span class="help">\n                    <span class="date">Expires on ',c+=n.suppressValue(e.getFilter("get_delete_draft_date").call(t,n.memberLookup(s,"createdAt")),e.opts.autoescape),c+='</span>\n                    <div class="tooltip tooltip-down">This model will be deleted automatically on ',c+=n.suppressValue(e.getFilter("get_delete_draft_date").call(t,n.memberLookup(s,"createdAt")),e.opts.autoescape),c+="</div>\n                </span>\n            "),c+='\n        </div>\n\n        <div class="status">',0==n.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small-slow"></i>\n                    <div class="tooltip tooltip-down">Pending</div>\n                </div>':1==n.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small"></i>\n                    <div class="tooltip tooltip-down">Processing</div>\n                </div>':2==n.memberLookup(s,"processingStatus")?n.memberLookup(s,"isPublished")?c+='<div class="help">\n                        <i class="icon fa-regular fa-check"></i>\n                        <div class="tooltip tooltip-down">Published</div>\n                    </div>':(c+='<div class="js-publish-button">\n                        <button type="button" class="button btn-important btn-medium">\n                            Publish\n                        </button>\n                    </div>\n\n                    <a href="',c+=n.suppressValue(n.memberLookup(s,"editorUrl"),e.opts.autoescape),c+='" class="button btn-tertiary btn-medium btn-edit" data-action="edit">\n                        3D Settings\n                    </a>'):3==n.memberLookup(s,"processingStatus")&&(c+='<div class="help">\n                    <i class="icon fa-regular fa-times"></i>\n                    <div class="tooltip tooltip-down">Error</div>\n                </div>'),c+='</div>\n\n        <div class="model-uploadcard-settings">\n            <div class="button btn-medium btn-primary display-icon-only"',n.memberLookup(s,"processingStatus")<2&&(c+=" disabled"),c+='>\n                <i class="fa-regular fa-cog"></i>\n                <div class="js-quicksettings"></div>\n            </div>\n        </div>\n\n    </div>\n\n',i=g,new n.SafeString(c)}));t.addExport("model_uploadcard"),t.setVariable("model_uploadcard",u),s+="\n\n\n";var d=n.makeMacro([],["options"],(function(r){var a=i;i=new n.Frame,(r=r||{}).hasOwnProperty("caller")&&i.set("caller",r.caller),i.set("options",r.hasOwnProperty("options")?r.options:{});var o="";return o+='\n    <div class="annotation" data-hotspot="',o+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"hotspotIndex"),e.opts.autoescape),o+='">\n        <div class="tooltip">\n            <form class="tooltip-content">\n                <div class="edition">\n                    <input class="title" placeholder="Title *" maxlength="64" required>\n                    <textarea class="description" placeholder="Description (add links, images and other formatting with Markdown)" maxlength="1024" rows="2"></textarea>\n                </div>\n                <div class="render">\n                    <div class="title"></div>\n                    <div class="markdown-editor">\n                        <div class="description markdown-rendered-content inversed"></div>\n                    </div>\n                </div>\n                <div class="meta">\n                    <button type="submit" class="submit button btn-primary btn-small">OK</button>\n                    <div class="meta__mode">\n                        <i class="fa-regular fa-pencil activate-edition selected" title="Edit"></i>\n                        <i class="fa-regular fa-eye activate-render" title="Preview"></i>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n',i=a,new n.SafeString(o)}));t.addExport("model_hotspot_edit"),t.setVariable("model_hotspot_edit",d),s+="\n\n";var I=n.makeMacro(["src"],["options"],(function(r,a){var o=i;i=new n.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("src",r),i.set("options",a.hasOwnProperty("options")?a.options:{});var s,A="";return s=e.getFilter("merge").call(t,{title:"A 3D model"},n.contextOrFrameLookup(t,i,"options")),i.set("options",s,!0),i.topLevel&&t.setVariable("options",s),i.topLevel&&t.addExport("options",s),A+="\n    <iframe ",A+=n.suppressValue(e.getFilter("attributes").call(t,{id:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"id"),title:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"title"),class:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"class"),width:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"width"),height:n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"height"),src:r,frameborder:"0",allow:"autoplay; fullscreen; xr-spatial-tracking",allowfullscreen:"",mozallowfullscreen:"true",webkitallowfullscreen:"true","xr-spatial-tracking":"true","execution-while-out-of-viewport":"true","execution-while-not-rendered":"true","web-share":"true"}),e.opts.autoescape),A+="></iframe>",i=o,new n.SafeString(A)}));t.addExport("model_iframe"),t.setVariable("model_iframe",I),s+="\n\n";var C=n.makeMacro(["model"],["options"],(function(r,a){var o=i;i=new n.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",r),i.set("options",a.hasOwnProperty("options")?a.options:{});var s,A="";return A+="\n    ",s=e.getFilter("merge").call(t,{className:""},n.contextOrFrameLookup(t,i,"options")),i.set("options",s,!0),i.topLevel&&t.setVariable("options",s),i.topLevel&&t.addExport("options",s),A+='\n    <span class="',A+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"className"),e.opts.autoescape),A+=' fa-regular fa-eye help">\n        <span class="count">\n            ',A+=n.suppressValue(e.getFilter("humanize_number").call(t,n.memberLookup(r,"viewCount")),e.opts.autoescape),A+='\n        </span>\n        <span class="tooltip tooltip-up">Views</span>\n    </span>\n',i=o,new n.SafeString(A)}));t.addExport("model_view_count"),t.setVariable("model_view_count",C),s+="\n\n";var f=n.makeMacro(["model"],["options"],(function(r,s){var A=i;i=new n.Frame,(s=s||{}).hasOwnProperty("caller")&&i.set("caller",s.caller),i.set("model",r),i.set("options",s.hasOwnProperty("options")?s.options:{});var g,h="";return g=e.getFilter("merge").call(t,{isMine:!1},n.contextOrFrameLookup(t,i,"options")),i.set("options",g,!0),i.topLevel&&t.setVariable("options",g),i.topLevel&&t.addExport("options",g),h+='<div class="model-cell__name-container">\n        <p class="model-cell__name ',h+=n.suppressValue(n.memberLookup(r,"isDeleted")?"--deleted":"",e.opts.autoescape),h+='">\n            ',h+=n.suppressValue((a=260,o=23,n.callWrap(n.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[r,{clickable:!n.memberLookup(r,"isDeleted")}])),e.opts.autoescape),h+="\n        </p>\n\n        ",n.memberLookup(r,"isDeleted")&&(h+='\n            <span class="model-cell__deleted-tooltip help">\n                <i class="fa-regular fa-question-circle"></i>\n                <span class="tooltip tooltip-right">\n                    This model was deleted',h+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"isMine")?"":", but no worries, you can still download the latest version!",e.opts.autoescape),h+="\n                </span>\n            </span>\n        "),h+="\n    </div>\n",i=A,new n.SafeString(h)}));t.addExport("model_cell_name"),t.setVariable("model_cell_name",f),r(null,s+="\n")}catch(e){r(n.handleError(e,a,o))}}}},"1sPI":()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/notification.jinja"]={root:function(e,t,i,n,r){var a="";try{a+="\n\n";var o=n.makeMacro(["type","content"],["options"],(function(r,a,o){var s=i;i=new n.Frame,(o=o||{}).hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("type",r),i.set("content",a),i.set("options",o.hasOwnProperty("options")?o.options:{});var A,g="";return g+="\n\n    ",A=e.getFilter("merge").call(t,{safecontent:!1},n.contextOrFrameLookup(t,i,"options")),i.set("options",A,!0),i.topLevel&&t.setVariable("options",A),i.topLevel&&t.addExport("options",A),g+='\n\n    <div class="flashmessage notification ',g+=n.suppressValue(r,e.opts.autoescape),g+='">\n        <div class="inner">\n            <div class="message">\n                ',n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"safecontent")?(g+="\n                    ",g+=n.suppressValue(e.getFilter("safe").call(t,a),e.opts.autoescape),g+="\n                "):(g+="\n                    ",g+=n.suppressValue(a,e.opts.autoescape),g+="\n                "),g+='\n            </div>\n            <button class="flashmessage-close" data-action="close" title="Close"></button>\n        </div>\n    </div>\n\n',i=s,new n.SafeString(g)}));t.addExport("flashmessage"),t.setVariable("flashmessage",o),r(null,a+="\n")}catch(e){r(n.handleError(e,null,null))}}}},lDpQ:()=>{(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/vr/vr-menu.jinja"]={root:function(e,t,i,n,r){var a="";try{var o=n.makeMacro([],["options"],(function(e){var r=i;i=new n.Frame,(e=e||{}).hasOwnProperty("caller")&&i.set("caller",e.caller),i.set("options",e.hasOwnProperty("options")?e.options:{});var a="";return a+='\n\n<div style="width:700px;">',n.memberLookup(n.contextOrFrameLookup(t,i,"options"),"hasHotspotsNavigation")&&(a+='<div class="vr-menu-row">\n            <button  id="vrPrevButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-left-white"></div>\n            </button>\n            <span class="vr-localize-icon">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-map-marker-white"></div>\n            </span>\n            <button id="vrNextButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-right-white"></div>\n            </button>\n        </div>'),a+='<button id="vrHomeButton" class="vr-button">Home</button>\n    <button id="vrHelpButton" class="vr-button">Help</button>\n    <button id="vrExitButton" class="vr-button vr-round-button">\n        <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-times-white"></div>\n    </button>\n</div>\n',i=r,new n.SafeString(a)}));t.addExport("panel"),t.setVariable("panel",o),r(null,a+="\n")}catch(e){r(n.handleError(e,null,null))}}}},MPMW:(e,t,i)=>{i("dElF"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/partials/embed/iframe.jinja"]={root:function(e,t,i,n,r){var a=null,o=null,s="";try{e.getTemplate("skfb_front/macros/model.jinja",!1,"skfb_front/partials/embed/iframe.jinja",!1,(function(A,g){A?r(A):g.getExported((function(A,g){if(A)r(A);else if(g.hasOwnProperty("model_iframe")){var h=g.model_iframe;t.setVariable("model_iframe",h),s+='<div class="sketchfab-embed-wrapper">',s+=n.suppressValue((a=0,o=108,n.callWrap(h,"model_iframe",t,[e.getFilter("query_string").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"model"),"embedUrl"),n.memberLookup(n.contextOrFrameLookup(t,i,"parameters"),"flags")),{width:n.memberLookup(n.contextOrFrameLookup(t,i,"parameters"),"width"),height:n.memberLookup(n.contextOrFrameLookup(t,i,"parameters"),"height")}])),e.opts.autoescape),n.memberLookup(n.contextOrFrameLookup(t,i,"parameters"),"byline")&&(s+='\n    <p style="font-size: 13px; font-weight: normal; margin: 5px; color: #4A4A4A;">\n        <a href="',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"model"),"viewerUrl"),e.opts.autoescape),s+=n.suppressValue(e.getFilter("safe").call(t,n.contextOrFrameLookup(t,i,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">',s+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"model"),"name"),e.opts.autoescape),s+='</a>\n        by <a href="',s+=n.suppressValue(n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t,i,"model"),"user"),"profileUrl"),e.opts.autoescape),s+=n.suppressValue(e.getFilter("safe").call(t,n.contextOrFrameLookup(t,i,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">',s+=n.suppressValue(n.memberLookup(n.memberLookup(n.contextOrFrameLookup(t,i,"model"),"user"),"displayName"),e.opts.autoescape),s+='</a>\n        on <a href="https://sketchfab.com',s+=n.suppressValue(e.getFilter("safe").call(t,n.contextOrFrameLookup(t,i,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">Sketchfab</a>\n    </p>\n'),r(null,s+="</div>\n")}else r(new Error("cannot import 'model_iframe'"))}))}))}catch(e){r(n.handleError(e,a,o))}}}},MQFR:(e,t,i)=>{i("jX4j"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/popups/message.jinja"]={b_popup_content:function(e,t,i,n,r){var a="";try{i=i.push(!0),a+="\n\n    ",n.contextOrFrameLookup(t,i,"safe")?(a+="\n        ",a+=n.suppressValue(e.getFilter("safe").call(t,n.contextOrFrameLookup(t,i,"text")),e.opts.autoescape),a+="\n    "):(a+="\n        ",a+=n.suppressValue(n.contextOrFrameLookup(t,i,"text"),e.opts.autoescape),a+="\n    "),r(null,a+="\n\n")}catch(e){r(n.handleError(e,null,null))}},b_popup_footer:function(e,t,i,n,r){var a="";try{i=i.push(!0),a+='\n    <div class="actions">\n\n        ',a+="\n        ",a+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"cancel")&&(a+='\n            <button class="button btn-medium btn-tertiary cancel',n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"cancelClass")&&(a+=" ",a+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"cancelClass"),e.opts.autoescape)),a+='" type="reset">',a+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"cancelLabel"),"Cancel"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"close")&&(a+='\n            <button class="button btn-medium btn-tertiary',n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"cancelClass")&&(a+=" ",a+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"closeClass"),e.opts.autoescape)),a+='" type="reset" data-action="close">',a+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"closeLabel"),"Close"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"continue")&&(a+='\n            <button class="button btn-medium btn-primary submit',n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"continueClass")&&(a+=" ",a+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"continueClass"),e.opts.autoescape)),a+='" type="submit">',a+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"continueLabel"),"Continue"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"ok")&&(a+='\n            <button class="button btn-medium btn-primary submit',n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"okClass")&&(a+=" ",a+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"okClass"),e.opts.autoescape)),a+='" type="submit">',a+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"okLabel"),"OK"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"delete")&&(a+='\n            <button class="button btn-medium btn-danger submit',n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"deleteClass")&&(a+=" ",a+=n.suppressValue(n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"deleteClass"),e.opts.autoescape)),a+='" type="submit">',a+=n.suppressValue(e.getFilter("default").call(t,n.memberLookup(n.contextOrFrameLookup(t,i,"buttons"),"deleteLabel"),"Delete"),e.opts.autoescape),a+="</button>\n        "),r(null,a+="\n\n    </div>\n")}catch(e){r(n.handleError(e,null,null))}},root:function(e,t,i,n,r){var a="";try{var o=null;e.getTemplate("skfb_front/layouts/popup.jinja",!0,"skfb_front/popups/message.jinja",!1,(function(s,A){if(s)r(s);else{for(var g in(o=A).blocks)t.addBlock(g,o.blocks[g]);var h,c;a+="\n\n",h=n.contextOrFrameLookup(t,i,"title"),i.set("popupTitle",h,!0),i.topLevel&&t.setVariable("popupTitle",h),i.topLevel&&t.addExport("popupTitle",h),a+="\n\n",n.contextOrFrameLookup(t,i,"popupClass")||(a+="\n    ",c="popup-message",i.set("popupClass",c,!0),i.topLevel&&t.setVariable("popupClass",c),i.topLevel&&t.addExport("popupClass",c),a+="\n"),a+="\n\n",(o?function(e,t,i,n,r){r("")}:t.getBlock("popup_content"))(e,t,i,n,(function(s,A){s?r(s):(a+=A,a+="\n\n",(o?function(e,t,i,n,r){r("")}:t.getBlock("popup_footer"))(e,t,i,n,(function(s,A){s?r(s):(a+=A,a+="\n",o?o.rootRenderFunc(e,t,i,n,r):r(null,a))})))}))}}))}catch(e){r(n.handleError(e,null,null))}}}},"n/oz":(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={"--color-black":"#000000","--color-white":"#ffffff","--color-primary-25":"#f7f9fa","--color-primary-50":"#e8f7fb","--color-primary-100":"#92d9ec","--color-primary-200":"#4cc8f1","--color-primary-300":"#1db9ed","--color-primary-400":"#1caad9","--color-primary-500":"#1c88bb","--color-primary-600":"#007396","--color-primary-700":"#005e74","--color-primary-800":"#023748","--color-primary-900":"#01222d","--color-secondary-25":"#ffe4ee","--color-secondary-300":"#e9256d","--color-secondary-400":"#df1660","--color-secondary-500":"#c81859","--color-secondary-600":"#b1114c","--color-secondary-800":"#700e32","--color-neutral-0":"#ffffff","--color-neutral-25":"#fdfdfd","--color-neutral-50":"#f2f2f2","--color-neutral-100":"#e7e7e7","--color-neutral-200":"#cccccc","--color-neutral-300":"#aaaaaa","--color-neutral-400":"#999999","--color-neutral-500":"#777777","--color-neutral-600":"#555555","--color-neutral-700":"#444444","--color-neutral-800":"#333333","--color-neutral-900":"#222222","--color-neutral-1000":"#000000","--color-success-25":"#e8fbec","--color-success-50":"#c8f6d2","--color-success-100":"#92eca5","--color-success-200":"#1fcc74","--color-success-300":"#1ac95d","--color-success-400":"#00a317","--color-success-500":"#149e49","--color-success-800":"#045724","--color-warning-25":"#fff8eb","--color-warning-50":"#fff3b2","--color-warning-200":"#fed600","--color-warning-300":"#ff9e3a","--color-warning-400":"#ff8507","--color-warning-600":"#ab6f31","--color-warning-800":"#8a3800","--color-error-25":"#fffbfb","--color-error-50":"#f6d3d6","--color-error-200":"#e07881","--color-error-400":"#f02624","--color-error-600":"#d7100e","--color-error-700":"#9a0c0a","--color-error-800":"#750e13","--color-editor-0":"#000000","--color-editor-50":"#0d0d0d","--color-editor-100":"#1a1a1a","--color-editor-200":"#333333","--color-editor-300":"#595959","--color-editor-400":"#666666","--color-editor-500":"#777777","--color-editor-600":"#999999","--color-editor-700":"#aaaaaa","--color-editor-800":"#cccccc","--color-editor-900":"#e7e7e7","--color-editor-1000":"#ffffff","--color-brand-sketchfab":"#1caad9","--color-brand-epic":"#0b0b0b","--color-brand-facebook":"#3a589a","--color-brand-twitter":"#1d9bf0","--color-brand-apple":"#050708","--color-brand-pinterest":"#ce1d21","--color-brand-linkedin":"#1884bc","--color-brand-instagram":"#f00075","--color-brand-tumblr":"#36465d","--color-brand-reddit":"#ff5700","--color-user-pro":"#00aad8","--color-user-prem":"#007395","--color-user-ent":"#222222","--color-user-staff":"#ff9e3a","--color-user-master":"#28cca7","--color-black-a10":"rgba(0, 0, 0, 0.1)","--color-black-a20":"rgba(0, 0, 0, 0.2)","--color-black-a30":"rgba(0, 0, 0, 0.3)","--color-black-a40":"rgba(0, 0, 0, 0.4)","--color-black-a50":"rgba(0, 0, 0, 0.5)","--color-black-a60":"rgba(0, 0, 0, 0.6)","--color-black-a70":"rgba(0, 0, 0, 0.7)","--color-black-a80":"rgba(0, 0, 0, 0.8)","--color-black-a90":"rgba(0, 0, 0, 0.9)","--color-white-a10":"rgba(255, 255, 255, 0.1)","--color-white-a20":"rgba(255, 255, 255, 0.2)","--color-white-a30":"rgba(255, 255, 255, 0.3)","--color-white-a40":"rgba(255, 255, 255, 0.4)","--color-white-a50":"rgba(255, 255, 255, 0.5)","--color-white-a60":"rgba(255, 255, 255, 0.6)","--color-white-a70":"rgba(255, 255, 255, 0.7)","--color-white-a80":"rgba(255, 255, 255, 0.8)","--color-white-a90":"rgba(255, 255, 255, 0.9)","--color-primary-a10":"rgba(28, 170, 217, 0.1)","--color-primary-a20":"rgba(28, 170, 217, 0.2)","--color-primary-a30":"rgba(28, 170, 217, 0.3)","--color-primary-a40":"rgba(28, 170, 217, 0.4)","--color-primary-a50":"rgba(28, 170, 217, 0.5)","--color-primary-a60":"rgba(28, 170, 217, 0.6)","--color-primary-a70":"rgba(28, 170, 217, 0.7)","--color-primary-a80":"rgba(28, 170, 217, 0.8)","--color-primary-a90":"rgba(28, 170, 217, 0.9)","--color-warning-a20":"rgba(255, 158, 58, 0.2)","--color-error-a20":"rgba(240, 38, 36, 0.2)","--color-shadow":"rgba(34, 34, 34, 0.1)","--color-neutral-900-on-100":"#222222","--color-neutral-500-on-0":"#777777","--color-neutral-500-on-100":"#777777","--color-neutral-600-on-200":"#555555","--color-neutral-200-on-600":"#cccccc","--color-primary-400-on-800":"#1caad9","--gradient-primary-500-300-45deg":"linear-gradient(45deg, #1687ac 0%, #41bde7 100%)","--gradient-primary-900-300-45deg":"linear-gradient(45deg, #19295a 0%, #2ec3fb 100%)","--gradient-primary-900-700-45deg":"linear-gradient(45deg, #13161e 0%, #111727 34.35%, #0e4b61 100%)","--gradient-primary-400-200-45deg":"linear-gradient(45deg, #1caad9 0%, #4cc8f1 100%)","--gradient-secondary-600-300-45deg":"linear-gradient(45deg, #a60b43 0%, #f42671 100%)","--gradient-secondary-900-300-45deg":"linear-gradient(45deg, #3e081c 0%, #ff4489 100%)","--gradient-error-page":"linear-gradient(to bottom, #05131a 0%, #0a2633 100%)","--website_background-color":"#f2f2f2","--website_color":"#222222","--website-top_background-color":"#ffffff","--website-top_color":"#222222","--website-top-search-icon_color":"#999999","--website-top-search-input_color":"#000000","--website-inverted_color":"#eeeeee","--org-header-top_background":"#2e3338","--org-header-main_background":"#2a404e","--link_color":"#1caad9","--link--hover_color":"#1c88bb","--link-inverted_color":"#ffffff","--link-inverted--hover_color":"#f2f2f2","--link-primary-inverted_color":"#1caad9","--link-primary-inverted--hover_color":"#1c88bb","--button-primary_background-color":"#1caad9","--button-primary_color":"#ffffff","--button-primary--hover_background-color":"#1c88bb","--button-primary--active_shadow-color":"#005e74","--button-warning_background-color":"#ff9e3a","--button-warning_color":"#ffffff","--button-warning--hover_background-color":"#ff8507","--button-warning--active_shadow-color":"#ab6f31","--button-tertiary_background-color":"transparent","--button-tertiary_color":"#1caad9","--button-tertiary--hover_background-color":"#e8f7fb","--button-tertiary--active_shadow-color":"#92d9ec","--button-tertiary_border-color":"#1caad9","--button-store_background-color":"#df1660","--button-store_color":"#ffffff","--button-store--hover_background-color":"#c81859","--button-store--active_shadow-color":"#700e32","--button-danger_background-color":"#f02624","--button-danger_color":"#ffffff","--button-danger--hover_background-color":"#d7100e","--button-danger--active_shadow-color":"#9a0c0a","--button-success_background-color":"#1ac95d","--button-success_color":"#ffffff","--button-success--hover_background-color":"#149e49","--button-success--active_shadow-color":"#045724","--button-facebook_background-color":"#3a589a","--button-facebook_color":"#ffffff","--button-facebook--hover_background-color":"#324576","--button-facebook--active_shadow-color":"#1a2646","--button-apple_background-color":"#ffffff","--button-apple_color":"#050708","--button-apple--hover_background-color":"#cccccc","--button-apple--active_shadow-color":"#999999","--button-apple_border-color":"#050708","--button-epic_background-color":"#0b0b0b","--button-epic_color":"#ffffff","--button-epic--hover_background-color":"#555555","--button-epic--active_shadow-color":"#999999","--button-google_background-color":"#ffffff","--button-google_color":"#555555","--button-google--hover_background-color":"#cccccc","--button-google--active_shadow-color":"#999999","--button-google_border-color":"#999999","--button-twitter_background-color":"#1d9bf0","--button-twitter_color":"#ffffff","--button-twitter--hover_background-color":"#0d88ed","--button-twitter--active_shadow-color":"#0864b0","--button-plan-pro_background-color":"#00aad8","--button-plan-pro_color":"#ffffff","--button-plan-pro--hover_background-color":"#1c88bb","--button-plan-pro--active_shadow-color":"#023748","--button-plan-prem_background-color":"#007395","--button-plan-prem_color":"#ffffff","--button-plan-prem--hover_background-color":"#005e74","--button-plan-prem--active_shadow-color":"#01222d","--button-plan-ent_background-color":"#222222","--button-plan-ent_color":"#ffffff","--button-plan-ent--hover_background-color":"#0f0f0f","--button-plan-ent--active_shadow-color":"#ffffff","--button-plan-ent_border-color":"#ffffff","--button-primary-inverted_background-color":"#ffffff","--button-primary-inverted_color":"#1caad9","--button-primary-inverted--hover_background-color":"#e8f7fb","--button-primary-inverted--active_shadow-color":"#92d9ec","--button-primary-inverted--hover_color":"#1c88bb","--button-store-inverted_background-color":"#ffffff","--button-store-inverted_color":"#df1660","--button-store-inverted--hover_background-color":"#ffe4ee","--button-store-inverted--active_shadow-color":"#700e32","--button-store-inverted--hover_color":"#c81859","--button-loading_background-color":"#e7e7e7","--button-loading_color":"#007396","--button-loading--hover_background-color":'""',"--button-loading--active_shadow-color":'""',"--button-loading--hover_color":"#007396","--badge--neutral_background-color":"#e7e7e7","--badge--neutral_color":"#333333","--badge--success_background-color":"#c8f6d2","--badge--success_color":"#045724","--badge--primary_background-color":"#92d9ec","--badge--primary_color":"#023748","--badge--warning_background-color":"#fff3b2","--badge--warning_color":"#8a3800","--badge--error_background-color":"#f6d3d6","--badge--error_color":"#750e13","--card-thumbnail_background":"radial-gradient(ellipse at center, #f5f5f5 0%, #d8d8d8 99%)","--card-darken-overlay_background":"rgba(49, 51, 55, 0.5)","--editor-color":"#333333","--editor-important-color":"#0d0d0d","--editor-key-color":"#1a1a1a","--editor-minor-color":"#595959","--editor-trivial-color":"#666666","--editor-text-color":"#cccccc","--editor-strong-color":"#ffffff","--editor-border-color":"#000000","--editor-active-color":"#1caad9","--editor-scrollbar-track-color":"#aaaaaa","--editor-scrollbar-thumb-color":"#595959","--editor-disabled-overlay":"rgba(89, 89, 89, 0.75)","--viewer_background-color":"#000000","--viewer-kdb_background":"linear-gradient(to bottom, #ffffff 0%, #ffffff 5%, #cccccc 6%, #ffffff 100%)","--loading-wave_background":"linear-gradient(to right, #e7e7e7, #dddddd 33%, #e7e7e7 66%)","--checkerboard-pattern_background":"#ffffff","--checkerboard-pattern_color":"#cccccc"}},o01h:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={"website-top-height":"60px","website-big-top-height":"86px","website-banner-height":"50px","website-responsive-top-height":"40px","website-responsive-navigation-width":"250px","website-fullscreen-padding":"30px","editor-header-height":"55px","editor-panel-width":"320px","editor-scrollbar-width":"10px","editor-group-widget-header-height":"30px","editor-group-widget-switch-width":"50px","editor-group-widget-switch-height":"24px","editor-group-widget-switch-margin":"2px","editor-group-widget-switch-cursor-width":"12px","editor-nested-group-widget-switch-margin":"3px","editor-image-widget-width":"30px","editor-image-widget-height":"30px","promotional-banner-height":"70px","viewer-control-size":"30px","website-max-width":"2000px","responsive-breakpoint-x-large":"1400px","responsive-breakpoint-medium":"1100px","responsive-breakpoint-x-small":"800px","responsive-breakpoint-x-x-small":"480px","breakpoint-x-small":"576px","breakpoint-small":"768px","breakpoint-medium-small":"960px","breakpoint-medium":"1024px","breakpoint-medium-large":"1280px","breakpoint-large":"1440px","breakpoint-x-large":"1920px","responsive-grid-one-column":"768px","responsive-grid-two-column":"1024px","responsive-grid-three-column":"1920px"}},Pev1:(e,t,i)=>{"use strict";i.d(t,{Z:()=>C});var n,r,a,o,s,A=i("u5PS"),g=i("GoyH"),h=i("6RPJ"),c=i("W40i"),l=i("CJNH"),u=i("pSxj"),d=i("IpZ9"),I=function(){h.Z.call(this),this._matrix=c._E.create(),this._position=c.R3.create(),this._matrixDirty=!0,this._scale=c.R3.fromValues(1,1,1),this._minimumScale=0,this._maximumScale=Number.MAX_VALUE,this._rotation=c.gf.create(),this._pivotPoint=c.R3.create(),this._autoScaleToScreen=!1,this._autoRotateToScreen=!1,this._cachedMatrix=c._E.create(),this._firstTimeToInitEyePoint=!0,this._autoScaleTransitionWidthRatio=.25,this._billboardAttribute=void 0,this._previousWidth=0,this._previousHeight=0,this._previousProjection=c._E.create(),this._previousModelView=c._E.create(),this._previousPosition=c.R3.create()};g.Z.createPrototypeNode(I,g.Z.objectInherit(h.Z.prototype,{getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix=e,this.dirtyBound()},setPosition:function(e){this._position=e,this._matrixDirty=!0,this.dirtyBound()},getPosition:function(){return this._position},setRotation:function(e){this._rotation=e,this._matrixDirty=!0,this.dirtyBound()},getRotation:function(){return this._rotation},setScale:function(e){this.setScaleFromVec3(c.R3.fromValues(e,e,e))},setScaleFromvec3:function(e){A.Z.warn("deprecated, use setScaleFromVec3"),this.setScaleFromVec3(e)},setScaleFromVec3:function(e){this._scale=e,this._matrixDirty=!0,this.dirtyBound()},getScale:function(){return this._scale},setMinimumScale:function(e){this._minimumScale=e},getMinimumScale:function(){return this._minimumScale},setMaximumScale:function(e){this._maximumScale=e},getMaximumScale:function(){return this._maximumScale},setAutoScaleToScreen:function(e){this._autoScaleToScreen=e,this._matrixDirty=!0},getAutoScaleToScreen:function(){return this._autoScaleToScreen},setAutoRotateToScreen:function(e){this._autoRotateToScreen=e},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setAutoScaleTransitionWidthRatio:function(e){this._autoScaleTransitionWidthRatio=e},getAutoScaleTransitionWidthRatio:function(){return this._autoScaleTransitionWidthRatio},computeLocalToWorldMatrix:function(e){this._matrixDirty&&this.computeMatrix(),this.referenceFrame===u.Z.RELATIVE_RF?c._E.mul(e,e,this._matrix):c._E.copy(e,this._matrix)},computeMatrix:(o=c.R3.create(),s=c._E.create(),function(){this._matrixDirty&&(c._E.fromQuat(this._matrix,this._rotation),c._E.fromTranslation(s,this._position),c._E.mul(this._matrix,s,this._matrix),c._E.scale(this._matrix,this._matrix,this._scale),c._E.translate(this._matrix,this._matrix,c.R3.neg(o,this._pivotPoint)),this._matrixDirty=!1)}),computeWorldToLocalMatrix:function(){var e=c.R3.create(),t=c.gf.create(),i=c.R3.create(),n=c._E.create();return function(r){return(0!==this.scale[0]||0!==this.scale[1]||0!==this.scale[2])&&(i[0]=1/this._scale[0],i[1]=1/this._scale[1],i[2]=1/this._scale[2],this.referenceFrame===u.Z.RELATIVE_RF?(c._E.fromTranslation(n,c.R3.neg(e,this._position)),c._E.mul(r,n,r),c.gf.zeroRotation(this._rotation)||(c._E.fromQuat(n,c.gf.invert(t,this._rotation)),c._E.mul(r,n,r)),c._E.fromScaling(n,i),c._E.mul(r,n,r),c._E.fromTranslation(n,this._pivotPoint),c._E.mul(r,n,r)):(c._E.fromQuat(this._matrix,c.gf.invert(t,this._rotation)),c._E.translate(r,r,c.R3.neg(e,this._position)),c._E.fromScaling(n,i),c._E.mul(r,n,r),c._E.fromTranslation(n,this._pivotPoint),c._E.mul(r,n,r)),!0)}}(),computeBound:(a=c._E.create(),function(e){return this._autoScaleToScreen&&this._firstTimeToInitEyePoint?e:(d.Z.prototype.computeBound.call(this,e),e.valid()?(c._E.identity(a),this.computeLocalToWorldMatrix(a),e.transformMat4(e,a),e):e)}),accept:function(e){if(e.getVisitorType()===l.Z.CULL_VISITOR){var t=e.getViewport().width(),i=e.getViewport().height(),n=e.getCurrentProjectionMatrix(),r=e.getCurrentModelViewMatrix(),a=this._position,o=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(t!==this._previousWidth||i!==this._previousHeight?o=!0:c._E.exactEquals(n,this._previousProjection)&&c._E.exactEquals(r,this._previousModelView)&&c.R3.exactEquals(a,this._previousPosition)||(o=!0)),this._firstTimeToInitEyePoint=!1,o){if(this._autoScaleToScreen){var s=e.getViewport(),A=this.computePixelSizeVector(s,n,r),g=c.vh.fromValues(this._position[0],this._position[1],this._position[2],1),h=c.vh.dot(g,A),u=1/(h=.48/h);if(this._autoScaleTransitionWidthRatio>0){var I,C,f;if(this._minimumScale>0){var p=this._minimumScale,m=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);f=p+(C=1-2*(I=1/(4*(m-p)))*m)*C/(4*I),u<-C/(2*I)?u=this._minimumScale:u<m&&(u=f+C*u+I*(u*u))}if(this._maximumScale<Number.MAX_VALUE){var _=this._maximumScale,E=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);f=_+(C=1-2*(I=1/(4*(E-_)))*E)*C/(4*I),u>-C/(2*I)?u=this._maximumScale:u>E&&(u=f+C*u+I*(u*u))}}this.setScale(u)}if(this._autoRotateToScreen){var v=c.gf.create();c._E.getRotation(v,r),this.setRotation(c.gf.invert(v,v))}this._previousWidth=t,this._previousHeight=i,c.R3.copy(this._previousPosition,a),c._E.copy(this._previousProjection,n),c._E.copy(this._previousModelView,r)}}d.Z.prototype.accept.call(this,e)},computePixelSizeVector:(n=c.R3.create(),r=c.R3.create(),function(e,t,i){var a=t[0]*e.width()*.5,o=t[8]*e.width()*.5+t[11]*e.width()*.5;c.R3.set(n,i[0]*a+i[2]*o,i[4]*a+i[6]*o,i[8]*a+i[10]*o);var s=t[5]*e.height()*.5,A=t[9]*e.height()*.5+t[11]*e.height()*.5;c.R3.set(r,i[1]*s+i[2]*A,i[5]*s+i[6]*A,i[9]*s+i[10]*A);var g=t[11],h=t[15],l=c.vh.fromValues(i[2]*g,i[6]*g,i[10]*g,i[14]*g+i[15]*h),u=.7071067811/Math.sqrt(c.R3.sqrLen(n)+c.R3.sqrLen(r));return c.vh.scale(l,l,u),l})}),"osg","AutoTransform");const C=I},f7MS:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("WWMP"),a=function(e,t,i,n){r.Z.call(this),this._sourceFactor=a.DISABLE,this._destinationFactor=a.DISABLE,this._sourceFactorAlpha=this._sourceFactor,this._destinationFactorAlpha=this._destinationFactor,this._separate=!1,void 0!==e&&this.setSource(e),void 0!==t&&this.setDestination(t),void 0!==i&&this.setSourceAlpha(i),void 0!==n&&this.setDestinationAlpha(n)};a.DISABLE=-1,a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a.ONE_MINUS_DST_COLOR=775,a.SRC_ALPHA_SATURATE=776,a.BLEND_DST_RGB=32968,a.BLEND_SRC_RGB=32969,a.BLEND_DST_ALPHA=32970,a.BLEND_SRC_ALPHA=32971,a.CONSTANT_COLOR=32769,a.ONE_MINUS_CONSTANT_COLOR=32770,a.CONSTANT_ALPHA=32771,a.ONE_MINUS_CONSTANT_ALPHA=32772,a.BLEND_COLOR=32773,n.Z.createPrototypeStateAttribute(a,n.Z.objectInherit(r.Z.prototype,{attributeType:"BlendFunc",cloneType:function(){return new a},setSource:function(e){this.setSourceRGB(e),this.setSourceAlpha(e)},getSource:function(){return this._sourceFactor},setDestination:function(e){this.setDestinationRGB(e),this.setDestinationAlpha(e)},getDestination:function(){return this._destinationFactor},getSeparate:function(){return this._separate},checkSeparate:function(){return this._sourceFactor!==this._sourceFactorAlpha||this._destinationFactor!==this._destinationFactorAlpha},setSourceRGB:function(e){this._sourceFactor="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getSourceRGB:function(){return this._sourceFactor},setSourceAlpha:function(e){this._sourceFactorAlpha="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getSourceAlpha:function(){return this._sourceFactorAlpha},setDestinationRGB:function(e){this._destinationFactor="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getDestinationRGB:function(){return this._destinationFactor},setDestinationAlpha:function(e){this._destinationFactorAlpha="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getDestinationAlpha:function(){return this._destinationFactorAlpha},apply:function(e){e.applyBlendFunc(this)}}),"osg","BlendFunc");const o=a},k3oU:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,r,a=i("u5PS"),o=i("GoyH"),s=i("W40i"),A=function(){this._min=s.R3.create(),this._max=s.R3.create(),this.init()};o.Z.createPrototypeObject(A,{init:function(){s.R3.copy(this._min,s.R3.INFINITY),s.R3.copy(this._max,s.R3.NEGATIVE_INFINITY)},volume:function(){var e=this._max[0]-this._min[0];return e*=this._max[1]-this._min[1],e*=this._max[2]-this._min[2]},copy:function(e){s.R3.copy(this._min,e._min),s.R3.copy(this._max,e._max)},valid:function(){return this._max[0]>=this._min[0]&&this._max[1]>=this._min[1]&&this._max[2]>=this._min[2]},expandByBoundingSphere:function(e){if(e.valid()){var t=this._max,i=this._min,n=e._radius,r=e._center[0],a=e._center[1],o=e._center[2];i[0]=Math.min(i[0],r-n),i[1]=Math.min(i[1],a-n),i[2]=Math.min(i[2],o-n),t[0]=Math.max(t[0],r+n),t[1]=Math.max(t[1],a+n),t[2]=Math.max(t[2],o+n)}},expandByvec3:function(e){a.Z.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:function(e){var t=this._min,i=this._max;t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),i[0]=Math.max(i[0],e[0]),i[1]=Math.max(i[1],e[1]),i[2]=Math.max(i[2],e[2])},expandByBoundingBox:function(e){if(e.valid()){var t=this._min,i=this._max,n=e._min,r=e._max;n[0]<t[0]&&(t[0]=n[0]),r[0]>i[0]&&(i[0]=r[0]),n[1]<t[1]&&(t[1]=n[1]),r[1]>i[1]&&(i[1]=r[1]),n[2]<t[2]&&(t[2]=n[2]),r[2]>i[2]&&(i[2]=r[2])}},center:function(e){var t=this._min,i=this._max;return e[0]=.5*(t[0]+i[0]),e[1]=.5*(t[1]+i[1]),e[2]=.5*(t[2]+i[2]),e},radius:function(){return Math.sqrt(this.radius2())},radius2:function(){var e=this._min,t=this._max,i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return.25*(i*i+n*n+r*r)},getMin:function(){return this._min},getMax:function(){return this._max},setMin:function(e){return s.R3.copy(this._min,e),this},setMax:function(e){return s.R3.copy(this._max,e),this},xMax:function(){return this._max[0]},yMax:function(){return this._max[1]},zMax:function(){return this._max[2]},xMin:function(){return this._min[0]},yMin:function(){return this._min[1]},zMin:function(){return this._min[2]},corner:function(e,t){return t[0]=1&e?this._max[0]:this._min[0],t[1]=2&e?this._max[1]:this._min[1],t[2]=4&e?this._max[2]:this._min[2],t},transformMat4:(n=s.R3.create(),r=s.R3.create(),function(e,t){var i=this.getMin(),a=this.getMax();s._E.getTranslation(n,t),s.R3.copy(r,n);for(var o=0;o<3;++o)for(var A=4*o,g=i[o],h=a[o],c=0;c<3;++c){var l=t[A+c],u=l*h,d=l*g;u<d?(n[c]+=u,r[c]+=d):(n[c]+=d,r[c]+=u)}var I=e.getMax(),C=e.getMin();return I[0]=r[0],I[1]=r[1],I[2]=r[2],C[0]=n[0],C[1]=n[1],C[2]=n[2],e})},"osg","BoundingBox");const g=A},bxht:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n,r,a,o,s=i("u5PS"),A=i("GoyH"),g=i("k3oU"),h=i("W40i"),c=function(){this._center=h.R3.create(),this._radius=-1};A.Z.createPrototypeObject(c,{init:function(){h.R3.init(this._center),this._radius=-1},valid:function(){return this._radius>=0},set:function(e,t){this._center=e,this._radius=t},center:function(){return this._center},radius:function(){return this._radius},radius2:function(){return this._radius*this._radius},volume:function(){var e=this._radius;return e*e*e*Math.PI*4/3},copy:function(e){this._radius=e._radius,h.R3.copy(this._center,e._center)},copyBoundingBox:function(e){e.center(this._center),this._radius=e.radius()},expandByBoundingBox:(a=h.R3.create(),o=new g.Z,function(e){if(e.valid())if(this.valid()){h.R3.copy(o._min,e._min),h.R3.copy(o._max,e._max);for(var t=0;t<8;t++)h.R3.sub(a,e.corner(t,a),this._center),h.R3.normalize(a,a),h.R3.scaleAndAdd(a,this._center,a,-this._radius),o.expandByVec3(a);o.center(this._center),this._radius=o.radius()}else this.copyBoundingBox(e)}),expandByvec3:function(e){s.Z.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:(r=h.R3.create(),function(e){if(this.valid()){h.R3.sub(r,e,this.center(r));var t=h.R3.length(r);if(t>this.radius()){var i=.5*(t-this.radius());this._center[0]+=r[0]*(i/t),this._center[1]+=r[1]*(i/t),this._center[2]+=r[2]*(i/t),this._radius+=i}}else this._center[0]=e[0],this._center[1]=e[1],this._center[2]=e[2],this._radius=0}),expandRadiusBySphere:function(e){if(e.valid())if(this.valid()){var t=h.R3.distance(this._center,e._center)+e._radius;t>this._radius&&(this._radius=t)}else h.R3.copy(this._center,e._center),this._radius=e._radius},expandByBoundingSphere:function(e){if(e.valid()){if(!this.valid())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e.radius());var t=h.R3.distance(e.center(),this.center());if(!(t+e.radius()<=this.radius())){if(t+this.radius()<=e.radius())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e._radius);var i=.5*(this.radius()+t+e.radius()),n=(i-this.radius())/t;this._center[0]+=(e._center[0]-this._center[0])*n,this._center[1]+=(e._center[1]-this._center[1])*n,this._center[2]+=(e._center[2]-this._center[2])*n,this._radius=i}}},contains:function(e){return!!this.valid()&&h.R3.sqrDist(this.center(),e)<=this.radius2()},intersects:function(e){if(!this.valid()||!e.valid())return!1;var t=this.radius()+e.radius();return h.R3.sqrDist(e.center(),this.center())<=t*t},transformMat4:(n=h.R3.create(),function(e,t){if(!this.valid())return e;e._center!==this._center&&(h.R3.copy(e._center,this._center),e._radius=this._radius);var i=e._center,r=e._radius;return h._E.getSqrScale(n,t),r*=Math.sqrt(Math.max(Math.max(n[0],n[1]),n[2])),e._radius=r,h.R3.transformMat4(i,i,t),e})},"osg","BoundingSphere");const l=c},UqX1:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i("u5PS"),r=i("GoyH"),a=i("iUVs"),o=i("/CZr"),s=i("6qT5"),A=i("W40i"),g=i("MQQR"),h=function(e){i("QKpV").Z.logMessage(e)},c=function(e,t,i){o.Z.call(this),this._instanceID=a.Z.getInstanceID(),this.dirty(),this._itemSize=i,this._target="string"==typeof e?c[e]:e,this._type=void 0,this._normalize=!1,t&&(void 0===t.byteLength&&(n.Z.warn("BufferArray with non typedArray elements is deprecated"),t=this._target===c.ELEMENT_ARRAY_BUFFER?new r.Z.Uint16Array(t):new r.Z.Float32Array(t)),this.setElements(t)),this._usage=c.STATIC_DRAW},l=function(e,t){return e+Math.random()*(t-e)},u=A.R3.fromValues(l(.1,10),l(4.2,7.5),l(.7,1.5));c.randa=u,c.ELEMENT_ARRAY_BUFFER=34963,c.ARRAY_BUFFER=34962,c.STATIC_DRAW=35044,c.DYNAMIC_DRAW=35048,c.STREAM_DRAW=35040,c._sDeletedGLBufferArrayCache=new window.Map,c.deleteGLBufferArray=function(e,t){c._sDeletedGLBufferArrayCache.has(e)||c._sDeletedGLBufferArrayCache.set(e,[]),c._sDeletedGLBufferArrayCache.get(e).push(t)},c.flushDeletedGLBufferArrays=function(e,t){if(t<=0)return t;if(!c._sDeletedGLBufferArrayCache.has(e))return t;for(var i=0,n=s.Z.instance().tick(),r=c._sDeletedGLBufferArrayCache.get(e),a=r.length-1;a>=0&&i<t;a--)e.deleteBuffer(r[a]),r.splice(a,1),i=s.Z.instance().deltaS(n,s.Z.instance().tick());return t-i},c.flushAllDeletedGLBufferArrays=function(e){if(c._sDeletedGLBufferArrayCache.has(e))for(var t=c._sDeletedGLBufferArrayCache.get(e),i=t.length-1;i>=0;i--)e.deleteBuffer(t[i]),t.splice(i,1)},c.onLostContext=function(e){c._sDeletedGLBufferArrayCache.has(e)&&(c._sDeletedGLBufferArrayCache.get(e).length=0)},r.Z.createPrototypeObject(c,r.Z.objectInherit(o.Z.prototype,{setUsage:function(e){this._usage=e},getUsage:function(){return this._usage},getInstanceID:function(){return this._instanceID},setItemSize:function(e){this._itemSize=e},isValid:function(){return!!this._buffer||!(!this._elements||!this._elements.length)},invalidate:function(){this._buffer=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._buffer&&null!==this._buffer&&void 0!==this._gl&&(c.deleteGLBufferArray(this._gl,this._buffer),o.Z.removeObject(this._gl,this)),this.invalidate()},setNormalize:function(e){this._normalize=e},getNormalize:function(){return this._normalize},bind:function(e){this._gl||this.setGraphicContext(e);var t=this._target,i=this._buffer;i?e.bindBuffer(t,i):!i&&this._elements.length>0&&(this._buffer=e.createBuffer(),this._numItems=this._elements.length/this._itemSize,e.bindBuffer(t,this._buffer))},getItemSize:function(){return this._itemSize},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},setElements:function(e){var t,i;this._elements=e,this._type=((t=e)instanceof r.Z.Float32Array&&(i=5126),t instanceof r.Z.Int16Array&&(i=5122),t instanceof r.Z.Uint16Array&&(i=5123),t instanceof r.Z.Int8Array&&(i=5120),t instanceof r.Z.Uint8Array&&(i=5121),t instanceof r.Z.Uint8ClampedArray&&(i=5121),t instanceof r.Z.Int32Array&&(i=5124),t instanceof r.Z.Uint32Array&&(i=5125),i),this._dirty=!0},getType:function(){return this._type},compile:function(e){if(this._dirty)return this._QTAN||this._QNOR?this._encodeDirection(e):this._QVS?this._encodeVertex(e):this._QUV?this._encodeUV(e):void this.compileGl(e)},compileGl:function(e){this._dirty&&(e.bufferData(this._target,this._elements,this._usage),this._dirty=!1)},getGlItemSize:function(){return this._glItemSize||this._itemSize},getGlType:function(){return this._glType||this._type},getGlNormalize:function(){return this._glNormalize||this._normalize},getElements:function(){return this._elements},computeMinMaxVertex:function(e,t,i){return this._minMaxVertex(e,t,i)},computeMinMaxUV:function(e,t,i){return this._minMaxUV(e,t,i)},_minMaxVertex:function(e,t,i){for(var n=1/0,r=1/0,a=1/0,o=-1/0,s=-1/0,A=-1/0,g=this.getElements(),h=void 0===i?g.length:i,c=t||0;c<h;c+=3){var l=g[c],u=g[c+1],d=g[c+2];l<n&&(n=l),u<r&&(r=u),d<a&&(a=d),l>o&&(o=l),u>s&&(s=u),d>A&&(A=d)}return o<=n&&(o=.001),s<=r&&(s=.001),A<=a&&(A=.001),e.xmin=n,e.xmax=o,e.ymin=r,e.ymax=s,e.zmin=a,e.zmax=A,e},_minMaxUV:function(e,t,i){for(var n=1/0,r=1/0,a=-1/0,o=-1/0,s=this.getElements(),A=void 0===i?s.length:i,g=t||0;g<A;g+=2){var h=s[g],c=s[g+1];h<n&&(n=h),c<r&&(r=c),h>a&&(a=h),c>o&&(o=c)}return a<=n&&(a=.001),o<=r&&(o=.001),e.xmin=n,e.ymin=r,e.xmax=a,e.ymax=o,e},_compileHook:function(e,t,i,n){var r=this.getElements(),a=this.getItemSize(),o=this.getNormalize();this.setNormalize(i),this.setItemSize(t),this.setElements(e),this._glType=this.getType(),this._glItemSize=t,this._glNormalize=i,this.compileGl(n),this.setElements(r),this.setItemSize(a),this.setNormalize(o),this._dirty=!1},_encodeDirection:function(e){for(var t=this.getElements(),i=t.length,n=32767,r=this.getItemSize(),a=r-1,o=0,s=new Int16Array(a*i/r),A=(0,g.Z)().zoct,h=0;h<i;h+=r){var c=t[h],l=t[h+1],u=t[h+2],d=1/Math.sqrt(c*c+l*l+u*u);if(c*=d,l*=d,u*=d,A){var I=1/(Math.abs(c)+Math.abs(l)+Math.abs(u)),C=c*I,f=l*I,p=u*I,m=p>=0?C:(1-Math.abs(f))*(Math.sign(C)||1),_=p>=0?f:(1-Math.abs(C))*(Math.sign(f)||1);s[o]=n*m,s[o+1]=n*_}else if(u<=-.99999)s[o]=n*Math.sqrt(.5),s[o+1]=n*Math.sqrt(.5);else{var E=1/Math.sqrt(2*u+2);s[o]=n*c*E,s[o+1]=n*l*E}3===a&&(s[o+2]=n*t[h+3]),o+=a}this._compileHook(s,a,!0,e)},_encodeVertex:function(e){var t=this._QVS,i=this._QVT,n=this.getElements(),r=this._FQU||this._minMax&&this._minMax._FQU;r&&h("vFQU - "+this.getInstanceID());for(var a=(0,g.Z)().zq&&!r,o=a?65535:1,s=a?Uint16Array:Float32Array,A=1/(u[0]*t[0]),c=1/(u[1]*t[1]),l=1/(u[2]*t[2]),d=i[0],I=i[1],C=i[2],f=(0,g.Z)().zw,p=this.getItemSize(),m=f?4:3,_=n.length,E=new s(m*_/p),v=0,S=0;S<_;S+=p){var B=A*(n[S]-d),w=c*(n[S+1]-I),y=l*(n[S+2]-C);if(E[v]=o*B,E[v+1]=o*w,E[v+2]=o*y,f){var M=Math.min(E[v],E[v+1],E[v+2]);E[v]-=M,E[v+1]-=M,E[v+2]-=M,E[v+3]=M}v+=m}this._compileHook(E,m,a,e)},_encodeUV:function(e){var t=this._QUV,i=t[0],n=t[1],r=1/t[2],a=1/t[3],o=this.getElements(),s=o.length,g=0;if(Math.max(t[2],t[3])/65535>1/2048)return h("NoQUV - "+this.getInstanceID()),this.compileGl(e),void A.vh.set(t,0,0,1,1);var c=65535*r,l=65535*a,u=new Uint16Array(s);for(g=0;g<s;g+=2)u[g]=c*(o[g]-i),u[g+1]=l*(o[g+1]-n);this._compileHook(u,2,!0,e)}}),"osg","BufferArray");const d=c},eYxU:(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("UqX1"),r=function(e){this._initialBufferArray=void 0,this._bufferArray=void 0,e&&(this.setBufferArray(e),this.setInitialBufferArray(e))},a={setInitialBufferArray:function(e){this._initialBufferArray=e},getInitialBufferArray:function(){return this._initialBufferArray},setBufferArray:function(e){this._bufferArray=e.getBufferArray?e.getBufferArray():e},getBufferArray:function(){return this._bufferArray},getGlItemSize:function(){return this._bufferArray.getGlItemSize()},getGlType:function(){return this._bufferArray.getGlType()},getGlNormalize:function(){return this._bufferArray.getGlNormalize()}},o=function(e){return function(){return e.apply(this._bufferArray,arguments)}};for(var s in n.Z.prototype)a[s]=o(n.Z.prototype[s]);r.prototype=a;const A=r},W6eo:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n,r=i("GoyH"),a=i("6RPJ"),o=i("qlNd"),s=i("W40i"),A=i("5rJd"),g=i("pSxj"),h=function(){a.Z.call(this),o.Z.call(this),this.viewport=void 0,this._graphicContext=void 0,this._scissor=void 0,this.setClearColor(s.vh.fromValues(0,0,0,1)),this.setClearDepth(1),this.setClearMask(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),this.setViewMatrix(s._E.create()),this.setProjectionMatrix(s._E.create()),this.renderOrder=h.NESTED_RENDER,this.renderOrderNum=0,this._view=void 0,this._renderer=void 0,this._attachments={}};h.PRE_RENDER=0,h.NESTED_RENDER=1,h.POST_RENDER=2,h.COLOR_BUFFER_BIT=16384,h.DEPTH_BUFFER_BIT=256,h.STENCIL_BUFFER_BIT=1024,r.Z.createPrototypeNode(h,r.Z.objectInherit(o.Z.prototype,r.Z.objectInherit(a.Z.prototype,{getView:function(){return this._view},setView:function(e){this._view=e},getRenderer:function(){return this._renderer},setRenderer:function(e){this._renderer=e},setFinalDrawCallback:function(e){this._finalDrawCallback=e},getFinalDrawCallback:function(){return this._finalDrawCallback},setInitialDrawCallback:function(e){this._initialDrawCallback=e},getInitialDrawCallback:function(){return this._initialDrawCallback},getAttachments:function(){return this._attachments},setGraphicContext:function(e){this._graphicContext=e},getGraphicContext:function(){return this._graphicContext},setClearDepth:function(e){this.clearDepth=e},getClearDepth:function(){return this.clearDepth},setClearMask:function(e){this.clearMask=e},getClearMask:function(){return this.clearMask},setClearColor:function(e){this.clearColor=e},getClearColor:function(){return this.clearColor},setViewport:function(e){this.viewport=e,this.getOrCreateStateSet().setAttributeAndModes(e)},getViewport:function(){return this.viewport},setScissor:function(e){this._scissor=e,this.getOrCreateStateSet().setAttributeAndModes(this._scissor)},getScissor:function(){return this._scissor},setViewMatrix:function(e){this.modelviewMatrix=e},setViewMatrixAsLookAt:function(e,t,i){s._E.lookAt(this.getViewMatrix(),e,t,i)},setProjectionMatrix:function(e){this.projectionMatrix=e},setProjectionMatrixAsOrtho:function(e,t,i,n,r,a){s._E.ortho(this.getProjectionMatrix(),e,t,i,n,r,a)},isRenderToTextureCamera:function(){return window.Object.keys(this._attachments).length>0},getViewMatrix:function(){return this.modelviewMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getRenderOrder:function(){return this.renderOrder},setRenderOrder:function(e,t){this.renderOrder=e,this.renderOrderNum=t},getFrameBufferObject:function(){return this.frameBufferObject},setFrameBufferObject:function(e){this.frameBufferObject=e},detachAll:function(){this._attachments={},this.frameBufferObject&&this.frameBufferObject.dirty()},resetAttachments:function(){this.frameBufferObject&&(this.frameBufferObject.reset(),this.frameBufferObject=0),this._attachments={}},attachTexture:function(e,t,i){this.frameBufferObject&&this.frameBufferObject.dirty(),i||(i=A.Z.TEXTURE_2D),this._attachments[e]={attachment:e,texture:t,textureTarget:i}},attachRenderBuffer:function(e,t){this.frameBufferObject&&this.frameBufferObject.dirty(),this._attachments[e]={format:t,attachment:e}},computeLocalToWorldMatrix:function(e){return this.referenceFrame===g.Z.RELATIVE_RF?s._E.mul(e,e,this.modelviewMatrix):s._E.copy(e,this.modelviewMatrix),!0},computeWorldToLocalMatrix:(n=s._E.create(),function(e){return s._E.invert(n,this.modelviewMatrix),this.referenceFrame===g.Z.RELATIVE_RF?s._E.mul(e,n,e):s._E.copy(e,n),!0})})),"osg","Camera");const c=h},"t+pa":(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n,r=i("k3oU"),a=i("6Szz"),o=i("W40i"),s=i("6RPJ"),A=i("CJNH"),g=i("GoyH"),h=i("bDLW"),c=i("cyFB"),l=function(e){A.Z.call(this,e),this._pooledMatrix=new c.Z(o._E.create),this._matrixStack=new h.Z,this._matrixStack.push(o._E.IDENTITY),this._bb=new r.Z};g.Z.createPrototypeObject(l,g.Z.objectInherit(A.Z.prototype,{reset:function(){this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(o._E.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();o._E.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this),this.pushMatrix(t),this.traverse(e),this.popMatrix()},apply:function(e){e instanceof s.Z?this.applyTransform(e):e instanceof a.Z?this.applyBoundingBox(e.getBoundingBox()):this.traverse(e)},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()},applyBoundingBox:(n=new r.Z,function(e){e.valid()&&(e.transformMat4(n,this._matrixStack.back()),this._bb.expandByBoundingBox(n))}),getMatrixStack:function(){return this._matrixStack}}),"osg","ComputeBoundsVisitor");const u=l},nbbV:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("WWMP"),a=function(e){r.Z.call(this),this.setMode(void 0!==e?e:a.BACK)};a.DISABLE=0,a.FRONT=1028,a.BACK=1029,a.FRONT_AND_BACK=1032,n.Z.createPrototypeStateAttribute(a,n.Z.objectInherit(r.Z.prototype,{attributeType:"CullFace",cloneType:function(){return new a},setMode:function(e){var t=e;"string"==typeof t&&(t=a[t]),this._mode=t},getMode:function(){return this._mode},apply:function(e){e.applyCullFace(this)}}),"osg","CullFace");const o=a},qlNd:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(){n.prototype.reset.call(this)};n.prototype={reset:function(){this._computeNearFar=!0,this._nearFarRatio=.005,this._enableFrustumCulling=!1,this._settingsSourceOverrider=this,this._LODScale=1,this._clampProjectionMatrixCallback=void 0},setCullSettings:function(e){this._computeNearFar=e._computeNearFar,this._nearFarRatio=e._nearFarRatio,this._enableFrustumCulling=e._enableFrustumCulling,this._settingsSourceOverrider=e._settingsSourceOverrider,this._clampProjectionMatrixCallback=e._clampProjectionMatrixCallback},setNearFarRatio:function(e){this._nearFarRatio=e},getNearFarRatio:function(){return this._nearFarRatio},setComputeNearFar:function(e){this._computeNearFar=e},getComputeNearFar:function(){return this._computeNearFar},setEnableFrustumCulling:function(e){this._enableFrustumCulling=e},getEnableFrustumCulling:function(){return this._enableFrustumCulling},getSettingSourceOverrider:function(){return this._settingsSourceOverrider},setClampProjectionMatrixCallback:function(e){this._clampProjectionMatrixCallback=e},getClampProjectionMatrixCallback:function(){return this._clampProjectionMatrixCallback},setLODScale:function(e){this._LODScale=e},getLODScale:function(){return this._LODScale}};const r=n},Mfw4:(e,t,i)=>{"use strict";i.d(t,{Z:()=>E});var n,r,a,o=i("GoyH"),s=i("bxht"),A=i("W6eo"),g=i("haRL"),h=i("qlNd"),c=i("IQqM"),l=i("W40i"),u=i("itLJ"),d=i("6RPJ"),I=i("pSxj"),C=i("bDLW"),f=i("cyFB"),p=i("gjC8"),m=function(){return new c.Z},_=function(){this._modelViewMatrixStack=new C.Z,this._projectionMatrixStack=new C.Z,this._viewportStack=new C.Z,this._cullingSetStack=new C.Z,this._frustumVolume=-1,this._bbCornerFar=0,this._bbCornerNear=0,this._pooledMatrix=new f.Z(l._E.create),this._pooledCullingSet=new f.Z(m),this._cameraIndexStack=new C.Z,this._cameraModelViewIndexStack=new C.Z,this._cameraMatrixInverse=new p.Z,this._cameraMatrixInverseRoot=void 0};o.Z.createPrototypeObject(_,o.Z.objectInherit(h.Z.prototype,{reset:function(){this._modelViewMatrixStack.reset(),this._projectionMatrixStack.reset(),this._cullingSetStack.reset(),this._pooledMatrix.reset(),this._pooledCullingSet.reset(),this._cameraModelViewIndexStack.reset(),this._cameraIndexStack.reset(),this._cameraMatrixInverse.reset(),this._cameraMatrixInverseRoot=void 0},getProjectionMatrixStack:function(){return this._projectionMatrixStack},getCurrentProjectionMatrix:function(){return this._projectionMatrixStack.back()},getCurrentModelViewMatrix:function(){return this._modelViewMatrixStack.back()},getCameraInverseMatrix:function(){if(!this._cameraIndexStack.getLength())return this._cameraMatrixInverseRoot;var e=this._cameraIndexStack.back(),t=this.getNodePath()[e].getInstanceID(),i=this._cameraMatrixInverse.getMap()[t];if(void 0===i){var n=this._cameraModelViewIndexStack.back(),r=this._modelViewMatrixStack.getArray()[n];i=this._pooledMatrix.getOrCreateObject(),l._E.invert(i,r),this._cameraMatrixInverse.set(t,i)}return i},getCurrentModelMatrix:function(){var e=this.getCameraInverseMatrix(),t=this._pooledMatrix.getOrCreateObject();return l._E.mul(t,e,this.getCurrentModelViewMatrix())},getCurrentViewMatrix:function(){var e=this._modelViewMatrixStack.getArray();return this._cameraIndexStack.getLength()?e[this._cameraModelViewIndexStack.back()]:e[0]},getViewport:function(){if(0!==this._viewportStack.getLength())return this._viewportStack.back()},getLookVectorLocal:function(e){var t=this.getCurrentModelViewMatrix();return l.R3.set(e,-t[2],-t[6],-t[10])},pushViewport:function(e){this._viewportStack.push(e)},popViewport:function(){this._viewportStack.pop()},getFrustumPlanes:(a=l._E.create(),function(e,t,i,n){l._E.mul(a,t,i);var r=!!n,o=e[0];o[0]=a[3]-a[0],o[1]=a[7]-a[4],o[2]=a[11]-a[8],o[3]=a[15]-a[12];var s=e[1];s[0]=a[3]+a[0],s[1]=a[7]+a[4],s[2]=a[11]+a[8],s[3]=a[15]+a[12];var A=e[2];A[0]=a[3]+a[1],A[1]=a[7]+a[5],A[2]=a[11]+a[9],A[3]=a[15]+a[13];var g=e[3];if(g[0]=a[3]-a[1],g[1]=a[7]-a[5],g[2]=a[11]-a[9],g[3]=a[15]-a[13],r){var h=e[4];h[0]=a[3]-a[2],h[1]=a[7]-a[6],h[2]=a[11]-a[10],h[3]=a[15]-a[14];var c=e[5];c[0]=a[3]+a[2],c[1]=a[7]+a[6],c[2]=a[11]+a[10],c[3]=a[15]+a[14]}for(var d=n?6:4,I=0;I<d;I++)u.Z.normalizeEquation(e[I])}),pushCullingSet:function(){var e=this._pooledCullingSet.getOrCreateObject();this._enableFrustumCulling&&(l._E.getFrustumPlanes(e.getFrustum().getPlanes(),this.getCurrentProjectionMatrix(),this.getCurrentModelViewMatrix(),!1),e.getFrustum().setupMask(4)),this._cullingSetStack.push(e)},popCullingSet:function(){return this._cullingSetStack.pop()},getCurrentCullingSet:function(){return this._cullingSetStack.back()},pushCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.pushCurrentMask()},popCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.popCurrentMask()},isVerticesCulled:function(e){return!!this._enableFrustumCulling&&this.getCurrentCullingSet().isVerticesCulled(e)},isBoundingBoxCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingBoxCulled(e))},isBoundingSphereCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingSphereCulled(e))},isCulled:(r=new s.Z,function(e,t){if(!this._enableFrustumCulling)return!1;if(e.isCullingActive()){if(0===this.getCurrentCullingSet().getCurrentResultMask())return!1;var i=this._pooledMatrix.getOrCreateObject();l._E.identity(i);var n=t.length;return e instanceof d.Z&&n--,g.Z.computeLocalToWorld(t,!0,i,n),e.getBound().transformMat4(r,i),this.getCurrentCullingSet().isBoundingSphereCulled(r)}return this.getCurrentCullingSet().resetCullingMask(),!1}),pushModelViewMatrix:(n=l.R3.create(),function(e){var t=this.getNodePath(),i=t.length;if(i){var r=i-1;t[r].getTypeID()===A.Z.getTypeID()&&t[r].getReferenceFrame()===I.Z.ABSOLUTE_RF&&(this._cameraIndexStack.push(r),this._cameraModelViewIndexStack.push(this._modelViewMatrixStack.getLength()))}else{var a=this._pooledMatrix.getOrCreateObject();l._E.invert(a,e),this._cameraMatrixInverseRoot=a}this._modelViewMatrixStack.push(e),this.getLookVectorLocal(n),this._bbCornerFar=(n[0]>=0?1:0)|(n[1]>=0?2:0)|(n[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}),popModelViewMatrix:function(){var e=l.R3.create();return function(){var t=this.getNodePath().length-1;this._cameraIndexStack.getLength()&&t===this._cameraIndexStack.back()&&(this._cameraIndexStack.pop(),this._cameraModelViewIndexStack.pop()),this._modelViewMatrixStack.pop(),this._modelViewMatrixStack.getLength()?this.getLookVectorLocal(e):l.R3.set(e,0,0,-1),this._bbCornerFar=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}}(),pushProjectionMatrix:function(e){this._projectionMatrixStack.push(e),this._frustumVolume=-1,this.pushCullingSet()},popProjectionMatrix:function(){this._projectionMatrixStack.pop(),this._frustumVolume=-1,this.popCullingSet()}}),"osg","CullStack");const E=_},"t5D/":(e,t,i)=>{"use strict";i.d(t,{Z:()=>G});var n,r,a=i("u5PS"),o=i("GoyH"),s=i("LElp"),A=i("CJNH"),g=i("qlNd"),h=i("Mfw4"),c=i("W40i"),l=i("rfV8"),u=i("Pev1"),d=i("WMIH"),I=i("Ln1o"),C=i("SHDx"),f=i("6Szz"),p=i("gtcU"),m=i("hLVw"),_=i("QtIg"),E=i("IpZ9"),v=i("oHbX"),S=i("YVjV"),B=i("+jyg"),w=i("W6eo"),y=i("pSxj"),M=i("11nE"),D=i("5Zr1"),b=i("igDg"),Q=i("mixV"),x=i("bDLW"),T=i("cyFB"),F=function(){return new p.Z},R=function(){return new g.Z},N=function(){A.Z.call(this,A.Z.TRAVERSE_ACTIVE_CHILDREN),g.Z.call(this),h.Z.call(this),this._rootStateGraph=void 0,this._currentStateGraph=void 0,this._currentRenderBin=void 0,this._currentRenderStage=void 0,this._rootRenderStage=void 0,this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this._camera=void 0,this._pooledLeaf=new T.Z(F),this._pooledRenderStages={},this._pooledCullSettings=new T.Z(R),this._renderBinStack=new x.Z,this.visitorType=A.Z.CULL_VISITOR,this._identityMatrix=c._E.create(),this._renderer=void 0,this._renderStageType=_.Z,this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0};N.registerApplyFunction=C.Z.registerApplyFunction,N.getApplyFunction=C.Z.getApplyFunction,o.Z.createPrototypeObject(N,o.Z.objectInherit(h.Z.prototype,o.Z.objectInherit(A.Z.prototype,{applyFunctionArray:C.Z.applyFunctionArray,distance:function(e,t){return-(e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+t[14])},getComputedNear:function(){return this._computedNear},getComputedFar:function(){return this._computedFar},resetStats:function(){this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0},handleCullCallbacksAndTraverse:function(e){var t=e.getCullCallback();t&&!t.cull(e,this)||this.traverse(e)},getCurrentCamera:function(){return this._currentRenderBin.getStage().getCamera()},updateCalculatedNearFar:(n=c.R3.create(),r=c.R3.create(),function(e,t){var i,a,o=t.getBoundingBox();if((i=this.distance(o.corner(this._bbCornerNear,n),e))>(a=this.distance(o.corner(this._bbCornerFar,r),e))){var s=i;i=a,a=s}return!(a<0||(i<this._computedNear&&(this._computedNear=i),a>this._computedFar&&(this._computedFar=a),0))}),setStateGraph:function(e){this._rootStateGraph=e,this._currentStateGraph=e},setRenderStage:function(e){this._rootRenderStage=e,this._currentRenderBin=e},setRenderer:function(e){this._renderer=e},getRenderer:function(){return this._renderer},reset:function(){for(var e in h.Z.prototype.reset.call(this),this._pooledLeaf.reset(),this._pooledCullSettings.reset(),this._pooledRenderStages)this._pooledRenderStages[e].reset();m.Z.reset(),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY},getCurrentRenderBin:function(){return this._currentRenderBin},setCurrentRenderBin:function(e){this._currentRenderBin=e},addPositionedAttribute:function(e,t){var i=e||this._identityMatrix;this._currentRenderBin.getStage().addPositionAttribute(i,t)},pushStateSet:function(e){if(this._currentStateGraph=this._currentStateGraph.findOrInsert(e),void 0!==e.getBinName()){var t=this._renderBinStack,i=this._currentRenderBin;t.push(i),this._currentRenderBin=i.getStage().findOrInsert(e.getBinNumber(),e.getBinName())}},popStateSet:function(){var e=this._currentStateGraph,t=e.getStateSet();if(this._currentStateGraph=e.getParent(),void 0!==t.getBinName()){var i=this._renderBinStack;0===i.getLength()?this._currentRenderBin=this._currentRenderBin.getStage():this._currentRenderBin=i.pop()}},popProjectionMatrix:function(){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var e=this.getCurrentProjectionMatrix();void 0!==this._clampProjectionMatrixCallback?this._clampProjectionMatrixCallback(e,this._computedNear,this._computedFar,this._nearFarRatio):this.clampProjectionMatrix(e,this._computedNear,this._computedFar,this._nearFarRatio)}h.Z.prototype.popProjectionMatrix.call(this)},clampProjectionMatrix:function(e,t,i,n,r){var o,s,A=1e-6;if(i<t-A)return a.Z.log("clampProjectionMatrix not applied, invalid depth range, znear = "+t+"  zfar = "+i,!1,!0),!1;if(i<t+A){var g=.5*(t+i);t=g-A,i=g+A}if(Math.abs(e[3])<A&&Math.abs(e[7])<A&&Math.abs(e[11])<A){var h=.02*(i-t);h<1&&(h=1),t=o=t-h,i=s=i+h,e[10]=-2/(s-o),e[14]=-(s+o)/(s-o)}else{var c=i*n;(o=.98*t)<c&&(o=c),t=o,i=s=1.02*i;var l=e[10],u=e[14],d=e[11],I=e[15],C=(-o*l+u)/(-o*d+I),f=(-s*l+u)/(-s*d+I),p=Math.abs(2/(C-f)),m=-(C+f)/2*p;e[2]=e[2]*p+e[3]*m,e[6]=e[6]*p+e[7]*m,e[10]=l*p+d*m,e[14]=u*p+I*m}return void 0!==r&&(r[0]=t,r[1]=i),!0},popCameraModelViewProjectionMatrix:function(){this.popModelViewMatrix(),this.popProjectionMatrix()},pushCameraModelViewProjectionMatrix:function(e,t,i){this.pushModelViewMatrix(t),this.pushProjectionMatrix(i)},apply:function(e){this.applyFunctionArray[e.nodeTypeID].call(this,e)},createOrReuseRenderLeaf:function(){return this._pooledLeaf.getOrCreateObject()},createOrReuseRenderStage:function(e){var t=e?e.className():"RenderStage";if(!this._pooledRenderStages[t]){var i=e?e.constructor:_.Z;this._pooledRenderStages[t]=new T.Z((function(){return new i}))}return this._pooledRenderStages[t].getOrCreateObject().init()},postPushGeometry:function(e,t){var i,n;t instanceof D.Z?((n=t.getStateSetAnimation())&&e.pushStateSet(n),(i=t.getSourceGeometry())instanceof Q.Z&&(n=i.getStateSetAnimation())&&e.pushStateSet(n)):t instanceof Q.Z&&(n=t.getStateSetAnimation())&&e.pushStateSet(n)},prePopGeometry:function(e,t){if(t instanceof D.Z){var i=t.getSourceGeometry();i instanceof Q.Z&&i.getStateSetAnimation()&&e.popStateSet(),t.getStateSetAnimation()&&e.popStateSet()}else t instanceof Q.Z&&t.getStateSetAnimation()&&e.popStateSet()},pushLeaf:function(e,t){var i=this._currentStateGraph.getLeafs();i.getLength()||this._currentRenderBin.addStateGraph(this._currentStateGraph);var n=this.createOrReuseRenderLeaf();n.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),i.push(n)}})),"osg","CullVisitor");var L=function(e){if(this._numMatrixTransform++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=this._pooledMatrix.getOrCreateObject(),i=this.getCurrentModelViewMatrix();c._E.copy(t,i),e.computeLocalToWorldMatrix(t),this.pushModelViewMatrix(t);var n=e.getStateSet();n&&this.pushStateSet(n),this.handleCullCallbacksAndTraverse(e),n&&this.popStateSet(),this.popModelViewMatrix(),this.popCurrentMask()}},k=function(e){if(this._numNode++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=e.getStateSet();t&&this.pushStateSet(t),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet(),this.popCurrentMask()}},P=c.R3.create(),U=!1,O=function(e){this._numGeometry++;var t=this.getCurrentModelViewMatrix(),i=e.getBoundingBox(),n=i.valid();if(!this._computeNearFar||!n||this.updateCalculatedNearFar(t,e)){var r=e.getCullCallback();if(!r||r.cull(e,this)){var o=e.getStateSet();o&&this.pushStateSet(o),this.postPushGeometry(this,e);var A=0;n?(A=this.distance(i.center(P),t),s.Z.isNaN(A)?U||(a.Z.warn("warning geometry has a NaN depth, "+t+" center "+P),U=!0):this.pushLeaf(e,A)):this.pushLeaf(e,A),this.prePopGeometry(this,e),o&&this.popStateSet()}}};C.Z.registerApplyFunction(E.Z.nodeTypeID,k),C.Z.registerApplyFunction(S.Z.nodeTypeID,k),C.Z.registerApplyFunction(B.Z.nodeTypeID,k),C.Z.registerApplyFunction(w.Z.nodeTypeID,(function(e){this._numCamera++;var t=e.getStateSet();t&&this.pushStateSet(t);var i=this._pooledMatrix.getOrCreateObject(),n=this._pooledMatrix.getOrCreateObject();if(e.getReferenceFrame()===y.Z.RELATIVE_RF){var r=this.getCurrentProjectionMatrix();c._E.mul(n,r,e.getProjectionMatrix());var a=this.getCurrentModelViewMatrix();c._E.mul(i,a,e.getViewMatrix())}else c._E.copy(i,e.getViewMatrix()),c._E.copy(n,e.getProjectionMatrix());var o=this._computedNear,s=this._computedFar,A=this._pooledCullSettings.getOrCreateObject();if(A.reset(),A.setCullSettings(this),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this.setCullSettings(e),A.getSettingSourceOverrider()===this&&A.getEnableFrustumCulling()&&this.setEnableFrustumCulling(!0),this.pushCameraModelViewProjectionMatrix(e,i,n),e.getViewport()&&this.pushViewport(e.getViewport()),e.getRenderOrder()===w.Z.NESTED_RENDER)this.handleCullCallbacksAndTraverse(e);else{var g=this.getCurrentRenderBin(),h=g.getStage(),l=this.createOrReuseRenderStage(this._rootRenderStage);l.setCamera(e),l.setClearDepth(e.getClearDepth()),l.setClearColor(e.getClearColor()),l.setClearMask(e.getClearMask());var u=e.getViewport()?e.getViewport():h.getViewport(),d=e.getScissor()?e.getScissor():h.getScissor();l.setViewport(u),l.setScissor(d),this.setCurrentRenderBin(l),this.handleCullCallbacksAndTraverse(e),this.setCurrentRenderBin(g),e.getRenderOrder()===w.Z.PRE_RENDER?this.getCurrentRenderBin().getStage().addPreRenderStage(l,e.renderOrderNum):this.getCurrentRenderBin().getStage().addPostRenderStage(l,e.renderOrderNum)}this.popCameraModelViewProjectionMatrix(e),e.getViewport()&&this.popViewport(),this.setCullSettings(A),this._computedNear=o,this._computedFar=s,t&&this.popStateSet()})),C.Z.registerApplyFunction(l.Z.nodeTypeID,L),C.Z.registerApplyFunction(d.Z.nodeTypeID,(function(e){this._numProjection++;var t=this.getCurrentProjectionMatrix(),i=this._pooledMatrix.getOrCreateObject();c._E.mul(i,t,e.getProjectionMatrix()),this.pushProjectionMatrix(i);var n=e.getStateSet();n&&this.pushStateSet(n),this.handleCullCallbacksAndTraverse(e),n&&this.popStateSet(),this.popProjectionMatrix()})),C.Z.registerApplyFunction(f.Z.nodeTypeID,O),C.Z.registerApplyFunction(M.Z.nodeTypeID,L),C.Z.registerApplyFunction(b.Z.nodeTypeID,L),C.Z.registerApplyFunction(u.Z.nodeTypeID,L),C.Z.registerApplyFunction(v.Z.nodeTypeID,k),C.Z.registerApplyFunction(I.Z.nodeTypeID,(function(e){this._numLightSource++;var t=e.getStateSet();t&&this.pushStateSet(t);var i=e.getLight();i&&(e.getReferenceFrame()===y.Z.RELATIVE_RF?this.addPositionedAttribute(this.getCurrentModelViewMatrix(),i):this.addPositionedAttribute(null,i)),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet()})),C.Z.registerApplyFunction(D.Z.nodeTypeID,O),C.Z.registerApplyFunction(Q.Z.nodeTypeID,O);const G=N},IQqM:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("e0P+"),r=function(){this._mask=r.DEFAULT_CULLING,this._frustum=new n.Z};r.prototype={reset:function(){this._mask=r.DEFAULT_CULLING,this._frustum.clear()},setCullingMask:function(e){this._mask=e},getCullingMask:function(){return this._mask},setFrustum:function(e){this._frustum=e},getFrustum:function(){return this._frustum},getCurrentResultMask:function(){return this._frustum.getCurrentMask()},pushCurrentMask:function(){this._frustum.pushCurrentMask()},popCurrentMask:function(){this._frustum.popCurrentMask()},resetCullingMask:function(){this._frustum.setResultMask(this._frustum.getCurrentMask())},isBoundingBoxCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingBox(e))},isBoundingSphereCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingSphere(e))},isVerticesCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsVertices(e))}},r.NO_CULLING=0,r.VIEW_FRUSTUM_LEFT_CULLING=1,r.VIEW_FRUSTUM_RIGHT_CULLING=2,r.VIEW_FRUSTUM_TOP_CULLING=3,r.VIEW_FRUSTUM_BOTTOM_CULLING=4,r.NEAR_PLANE_CULLING=5,r.FAR_PLANE_CULLING=6,r.VIEW_FRUSTUM_SIDES_CULLING=r.VIEW_FRUSTUM_LEFT_CULLING|r.VIEW_FRUSTUM_RIGHT_CULLING|r.VIEW_FRUSTUM_BOTTOM_CULLING|r.VIEW_FRUSTUM_TOP_CULLING,r.VIEW_FRUSTUM_CULLING=r.VIEW_FRUSTUM_SIDES_CULLING|r.NEAR_PLANE_CULLING|r.FAR_PLANE_CULLING,r.DEFAULT_CULLING=r.VIEW_FRUSTUM_SIDES_CULLING,r.ENABLE_ALL_CULLING=r.VIEW_FRUSTUM_CULLING;const a=r},uRnn:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("WWMP"),a=function(e,t,i,n){r.Z.call(this),this._func=a.LESS,this._near=0,this._far=1,this._writeMask=!0,void 0!==e&&(this._func="string"==typeof e?a[e]:e),void 0!==t&&(this._near=t),void 0!==i&&(this._far=i),void 0!==n&&(this._writeMask=n)};a.DISABLE=0,a.NEVER=512,a.LESS=513,a.EQUAL=514,a.LEQUAL=515,a.GREATER=516,a.NOTEQUAL=517,a.GEQUAL=518,a.ALWAYS=519,n.Z.createPrototypeStateAttribute(a,n.Z.objectInherit(r.Z.prototype,{attributeType:"Depth",cloneType:function(){return new a},setRange:function(e,t){this._near=e,this._far=t},setWriteMask:function(e){this._writeMask=e},getWriteMask:function(){return this._writeMask},getFunc:function(){return this._func},apply:function(e){e.applyDepth(this)}}),"osg","Depth");const o=a},"Q/WO":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(e,t,i){this._mode=e,this._first=t,this._arrayLengths=i.slice(0)};n.prototype={draw:function(e){for(var t=e.getGraphicContext(),i=this._mode,n=this._first,r=this._arrayLengths,a=0,o=r.length;a<o;a++){var s=r[a];t.drawArrays(i,n,s),n+=s}},getMode:function(){return this._mode},getNumIndices:function(){for(var e=0,t=this._arrayLengths,i=0,n=t.length;i<n;i++)e+=t[i];return e},getCount:function(){return this.getNumIndices()},getArrayLengths:function(){return this._arrayLengths},getFirst:function(){return this._first},setFirst:function(e){this._first=e}};const r=n},Z4fc:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("907W"),r=function(e,t,i){this.mode=e,void 0!==e&&("string"==typeof e&&(e=n.Z[e]),this.mode=e),this.first=t,this.count=i};r.prototype={draw:function(e){0!==this.count&&e.getGraphicContext().drawArrays(this.mode,this.first,this.count)},getMode:function(){return this.mode},setCount:function(e){this.count=e},getCount:function(){return this.count},setFirst:function(e){this.first=e},getFirst:function(){return this.first},getNumIndices:function(){return this.count},index:function(e){return this.first+e}};const a=r},"1PKS":(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("907W"),r=i("BvLe"),a=function(e,t){this.mode=n.Z.POINTS,void 0!==e&&("string"==typeof e&&(e=n.Z[e]),this.mode=e),this.count=0,this.offset=0,this.indices=t,this.uType=a.UNSIGNED_SHORT,void 0!==t&&this.setIndices(t)};a.UNSIGNED_BYTE=5121,a.UNSIGNED_SHORT=5123,a.UNSIGNED_INT=5125,a.prototype={getMode:function(){return this.mode},draw:function(e){0!==this.count&&(e.setIndexArray(this.indices),this.drawElements(e))},drawElements:function(e){e.getGraphicContext().drawElements(this.mode,this.count,this.uType,this.offset)},setIndices:function(e){var t=e.getElements();r.Z.instance().isWebGL2()&&(1===t.BYTES_PER_ELEMENT?-1!==t.indexOf(255)&&(e.setElements(new Uint16Array(t)),t=e.getElements()):2===t.BYTES_PER_ELEMENT?-1!==t.indexOf(65535)&&(e.setElements(new Uint32Array(t)),t=e.getElements()):4===t.BYTES_PER_ELEMENT&&-1!==t.indexOf(4294967295)&&console.error("primitives restart in a 32bits index buffer, unhandled")),this.indices=e,this.count=t.length;var i=t.BYTES_PER_ELEMENT;1===i?this.uType=a.UNSIGNED_BYTE:2===i?this.uType=a.UNSIGNED_SHORT:4===i&&(this.uType=a.UNSIGNED_INT)},getIndices:function(){return this.indices},setFirst:function(e){this.offset=e},getFirst:function(){return this.offset},setCount:function(e){this.count=e},getCount:function(){return this.count},getNumIndices:function(){return this.indices.getElements().length},index:function(e){return this.indices.getElements()[e]}};const o=a},"lU+d":(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("u5PS"),r=i("GoyH"),a=i("/CZr"),o=i("WWMP"),s=i("6qT5"),A=i("BvLe"),g=function(){a.Z.call(this),o.Z.call(this),this._fbo=void 0,this._rbo=void 0,this._attachments=[],this._buffers=[],this._dirty=!0,this._hasMRT=A.Z.instance().getWebGLExtension("WEBGL_draw_buffers")};g.COLOR_ATTACHMENT0=36064,g.DEPTH_ATTACHMENT=36096,g.DEPTH_COMPONENT16=33189,g._sDeletedGLFrameBufferCache=new window.Map,g.deleteGLFrameBuffer=function(e,t){g._sDeletedGLFrameBufferCache.has(e)||g._sDeletedGLFrameBufferCache.set(e,[]),g._sDeletedGLFrameBufferCache.get(e).push(t)},g.flushDeletedGLFrameBuffers=function(e,t){if(t<=0)return t;if(!g._sDeletedGLFrameBufferCache.has(e))return t;var i=g._sDeletedGLFrameBufferCache.get(e);if(0===i.length)return t;for(var n=0,r=s.Z.instance().tick(),a=i.length-1;a>=0&&n<t;a--)e.deleteFramebuffer(i[a]),i.splice(a,1),n=s.Z.instance().deltaS(r,s.Z.instance().tick());return t-n},g.flushAllDeletedGLFrameBuffers=function(e){if(g._sDeletedGLFrameBufferCache.has(e)){var t=g._sDeletedGLFrameBufferCache.get(e);if(0!==t.length)for(var i=t.length-1;i>=0;i--)e.deleteFramebuffer(t[i]),t.splice(i,1)}},g._sDeletedGLRenderBufferCache=new window.Map,g.deleteGLRenderBuffer=function(e,t){g._sDeletedGLRenderBufferCache.has(e)||g._sDeletedGLRenderBufferCache.set(e,[]),g._sDeletedGLRenderBufferCache.get(e).push(t)},g.flushDeletedGLRenderBuffers=function(e,t){if(t<=0)return t;if(!g._sDeletedGLRenderBufferCache.has(e))return t;for(var i=0,n=s.Z.instance().tick(),r=g._sDeletedGLRenderBufferCache.get(e),a=r.length-1;a>=0&&i<t;a--)e.deleteRenderbuffer(r[a]),r.splice(a,1),i=s.Z.instance().deltaS(n,s.Z.instance().tick());return t-i},g.flushAllDeletedGLRenderBuffers=function(e){if(g._sDeletedGLRenderBufferCache.has(e))for(var t=g._sDeletedGLRenderBufferCache.get(e),i=t.length-1;i>=0;i--)e.deleteRenderbuffer(t[i]),t.splice(i,1)},g.onLostContext=function(e){if(g._sDeletedGLFrameBufferCache.has(e)){var t=g._sDeletedGLFrameBufferCache.get(e);t.length=0,g._sDeletedGLRenderBufferCache.has(e)&&((t=g._sDeletedGLRenderBufferCache.get(e)).length=0)}},r.Z.createPrototypeStateAttribute(g,r.Z.objectInherit(a.Z.prototype,r.Z.objectInherit(o.Z.prototype,{attributeType:"FrameBufferObject",cloneType:function(){return new g},invalidate:function(){if(this._rbo&&this._attachments){for(var e=0,t=this._attachments.length;e<t;++e){var i=this._attachments[e];i.texture||(i.renderBufferObject=void 0)}this._rbo=void 0}this._fbo=void 0,this._buffers.length=0,this._dirty=!0},dirty:function(){this._buffers.length=0,this._dirty=!0},isDirty:function(){return this._dirty},setAttachment:function(e){this._attachments.push(e)},getAttachment:function(e){if(this._attachments)for(var t=0,i=this._attachments.length;t<i;++t){var n=this._attachments[t];if(n.attachment===e)return n}},releaseGLObjects:function(){void 0!==this._fbo&&void 0!==this._gl&&g.deleteGLFrameBuffer(this._gl,this._fbo),this._fbo=void 0,void 0!==this._rbo&&void 0!==this._gl&&g.deleteGLRenderBuffer(this._gl,this._rbo),this.invalidate()},_reportFrameBufferError:function(e){switch(e){case 36054:n.Z.debug("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case 36055:n.Z.debug("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case 36057:n.Z.debug("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case 36061:n.Z.debug("FRAMEBUFFER_UNSUPPORTED");break;default:n.Z.debug("FRAMEBUFFER unknown error "+e.toString(16))}},reset:function(){this.releaseGLObjects(),this._attachments=[]},getFrameBufferObject:function(){return this._fbo},getRenderBufferObject:function(){return this._rbo},createFrameBufferObject:function(e){this.setGraphicContext(e.getGraphicContext()),this._fbo=this._gl.createFramebuffer()},setFrameBufferObject:function(e,t){this.setGraphicContext(e.getGraphicContext()),this._fbo=t},createRenderBuffer:function(e,t,i){var n=this._gl,r=n.createRenderbuffer();return n.bindRenderbuffer(n.RENDERBUFFER,r),n.renderbufferStorage(n.RENDERBUFFER,e,t,i),r},framebufferRenderBuffer:function(e,t){var i=this._gl;i.bindRenderbuffer(i.RENDERBUFFER,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,e,i.RENDERBUFFER,t)},framebufferTexture2D:function(e,t,i,n){var r=this._gl;if(e.applyTextureAttribute(1,n),n.isDirty()||!n.getTextureObject())return!1;var a=r.DRAW_FRAMEBUFFER||r.FRAMEBUFFER;return r.framebufferTexture2D(a,t,i,n.getTextureObject().id(),0),!0},bindFrameBufferObject:function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._fbo)},checkStatus:function(){var e=this._gl,t=e.checkFramebufferStatus(e.FRAMEBUFFER);t!==e.FRAMEBUFFER_COMPLETE&&this._reportFrameBufferError(t)},_checkAllowedSize:function(e,t){var i=A.Z.instance().getWebGLParameter("MAX_RENDERBUFFER_SIZE");return!(0===e||0===t||t>i||e>i)||(n.Z.error("width ("+e+") or height ("+e+') makes frame buffer not bindable. Max RenderBuffer is "'+i+'"'),!1)},apply:function(e){this._gl||this.setGraphicContext(e.getGraphicContext());var t=this._gl,i=this._attachments,r=i.length;if(0!==r||this._fbo){var a=0;if(!this.isDirty()){for(a=0;a<r;++a){var o=i[a].texture;o&&o.isDirty()&&e.applyTextureAttribute(1,o)}return t.bindFramebuffer(t.FRAMEBUFFER,this._fbo),void(!0===n.Z.reportWebGLError&&this.checkStatus())}this._fbo||this.createFrameBufferObject(e),this.bindFrameBufferObject();var s=this._hasMRT?this._buffers:void 0,A=!1;for(a=0;a<r;++a){var g=i[a];if(g.texture){var h=g.texture;if(!this._checkAllowedSize(h.getWidth(),h.getHeight()))return void this.releaseGLObjects();if(this._hasMRT&&g.attachment>=t.COLOR_ATTACHMENT0&&g.attachment<=t.COLOR_ATTACHMENT15&&-1===s.indexOf(g.attachment)&&s.push(g.attachment),!this.framebufferTexture2D(e,g.attachment,g.textureTarget,h))return void this.releaseGLObjects()}else{if(!this._checkAllowedSize(g.width,g.height))return void this.releaseGLObjects();g.renderBufferObject?this._rbo=g.renderBufferObject:(this._rbo=this.createRenderBuffer(g.format,g.width,g.height),g.renderBufferObject=this._rbo),this.framebufferRenderBuffer(g.attachment,this._rbo),A=!0}}s&&s.length>0&&t.drawBuffers(s),this.checkStatus(),A&&t.bindRenderbuffer(t.RENDERBUFFER,null),this._dirty=!1}else t.bindFramebuffer(t.FRAMEBUFFER,null)}})),"osg","FrameBufferObject");const h=g},"p6+I":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(){this._frame=0,this._startSimulation=0,this._currentSimulation=0,this._deltaTime=0};n.prototype={setReferenceTime:function(e){this._startSimulation=e},getReferenceTime:function(){return this._startSimulation},setSimulationTime:function(e){this._currentSimulation=e},getSimulationTime:function(){return this._currentSimulation},setDeltaTime:function(e){this._deltaTime=e},getDeltaTime:function(){return this._deltaTime},setFrameNumber:function(e){this._frame=e},getFrameNumber:function(){return this._frame}};const r=n},"/CZr":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});i("u5PS");var n=function(){this._gl=void 0,this._onLostContextCallback=void 0};n.prototype={setGraphicContext:function(e){this._gl=e,n.addObject(this._gl,this)},getGraphicContext:function(){return this._gl},setLostContextCallback:function(e){this._onLostContextCallback=e},onLostContext:function(){this.invalidate&&"function"==typeof this.invalidate&&this.invalidate(),this._onLostContextCallback&&this._onLostContextCallback()}},n._sResourcesArrayCache=new window.Map,n.addObject=function(e,t){n._sResourcesArrayCache.has(e)||n._sResourcesArrayCache.set(e,[]);var i=n._sResourcesArrayCache.get(e);-1===i.indexOf(t)&&i.push(t)},n.removeObject=function(e,t){if(n._sResourcesArrayCache.has(e)){var i=n._sResourcesArrayCache.get(e),r=i.indexOf(t);-1!==r&&i.splice(r,1)}},n.onLostContext=function(e){if(n._sResourcesArrayCache.has(e))for(var t=n._sResourcesArrayCache.get(e),i=0,r=t.length;i<r;i++)t[i].onLostContext()};const r=n},uHj6:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});i("u5PS");var n=i("GoyH"),r=i("iUVs"),a=window.ImageBitmap||function(){},o=function(e){r.Z.call(this),this._imageObject=void 0,this._url=void 0,this._width=void 0,this._height=void 0,this._dirty=!0,this._mipmap=[],e&&this.setImage(e),this._isGreyscale=void 0};n.Z.createPrototypeObject(o,n.Z.objectInherit(r.Z.prototype,{dirty:function(){this._isGreyscale=void 0,this._dirty=!0},isDirty:function(){return this._dirty},setDirty:function(e){this._dirty=e},getImage:function(){return this._imageObject instanceof o?this._imageObject.getImage():this._imageObject},getURL:function(){return this._url},setURL:function(e){this._url=e},useOrCreateImage:function(e){return e instanceof o==!1?new o(e):e},setImage:function(e){if(!this._url&&e&&(e.src||e.currentSrc)&&(this._url=e.src||e.currentSrc),this._mipmap.length=0,Array.isArray(e)){for(var t=0,i=e.length;t<i;t++)this._mipmap.push(this.useOrCreateImage(e[t]));this.setWidth(this._mipmap[0].getWidth()),this.setHeight(this._mipmap[0].getHeight())}else this._mipmap.push(e);this._imageObject=this._mipmap[0],this.dirty()},isCanvas:function(){return this.getImage()instanceof window.HTMLCanvasElement},isBitmap:function(){return this.getImage()instanceof a},isVideo:function(){return this.getImage()instanceof window.HTMLVideoElement},isImage:function(){return this.getImage()instanceof window.Image},isTypedArray:function(){var e=this.getImage();return e instanceof Uint8Array||e instanceof Float32Array||e instanceof Uint16Array},setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},getWidth:function(){var e=this.getImage();return this.isImage()?e.naturalWidth:this.isVideo()?e.videoWidth:this.isCanvas()||this.isBitmap()?e.width:this._width},getHeight:function(){var e=this.getImage();return this.isImage()?e.naturalHeight:this.isVideo()?e.videoHeight:this.isCanvas()||this.isBitmap()?e.height:this._height},isGreyscale:function(e){if(void 0!==this._isGreyscale)return this._isGreyscale;if(void 0!==this._imageObject&&this.isReady()&&void 0===this._isGreyscale){var t=this._imageObject;this.isCanvas()||(t=document.createElement("canvas"));var i,n,r=t.getContext("2d");t.width=this._imageObject.width,t.height=this._imageObject.height,r.drawImage(this._imageObject,0,0),e||(i=t.width,n=t.height),e>0&&(i=n=e=Math.min(Math.min(t.width,t.height),e));for(var a=!0,o=t.width/i,s=t.height/n,A=0;A<i;A++)for(var g=0;g<n;g++){var h=Math.floor(o*(A+.5)),c=Math.floor(s*(g+.5)),l=r.getImageData(h,c,1,1).data;if(l[0]!==l[1]||l[0]!==l[2]){a=!1;break}}this._isGreyscale=a}return this._isGreyscale},isReady:function(){if(this._imageObject&&this._imageObject instanceof o)return this._imageObject.isReady();if(this.isCanvas()||this.isTypedArray()||this.isBitmap())return!0;if(this.isImage()){var e=this.getImage();if(e.complete)return void 0===e.naturalWidth||0!==e.naturalWidth}if(this.isVideo()&&0!==this.getWidth())return!0;var t=this.getImage();return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)},getMipmap:function(){return this._mipmap},hasMipmap:function(){return this._mipmap.length>1},release:function(){this._mipmap.length=0,this._imageObject=void 0}}),"osg","Image");const s=o},"2Vrk":(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("GoyH"),r=i("WWMP"),a=i("64xh"),o=i("W40i"),s=function(e,t){r.Z.call(this);var i=void 0!==e?e:0;this._ambient=o.vh.fromValues(.2,.2,.2,1),this._diffuse=o.vh.fromValues(.8,.8,.8,1),this._specular=o.vh.fromValues(.2,.2,.2,1),this._position=o.vh.fromValues(0,0,1,0),this._direction=o.R3.fromValues(0,0,-1),this._ground=o.vh.fromValues(.2,.2,.2,-1),this._spotCutoff=180,this._spotBlend=.01,this._attenuation=o.vh.fromValues(1,0,0,0),this._lightNumber=i,this._enable=!t,this._dirtyHash=!0,this._hash=""};s.DIRECTION="DIRECTION",s.SPOT="SPOT",s.POINT="POINT",s.HEMI="HEMI",s.uniforms={},n.Z.createPrototypeStateAttribute(s,n.Z.objectInherit(r.Z.prototype,{attributeType:"Light",cloneType:function(){return new s(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this._lightNumber},getUniformName:function(e){return"u"+this.getTypeMember()+"_"+e},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getLightType()+this.isEnabled().toString()},getOrCreateUniforms:function(){var e=s,t=this.getTypeMember();return e.uniforms[t]||(e.uniforms[t]={viewPosition:a.Z.createFloat4(this.getUniformName("viewPosition")),viewDirection:a.Z.createFloat3(this.getUniformName("viewDirection")),modelViewMatrix:a.Z.createMatrix4(this.getUniformName("modelViewMatrix")),modelViewNormalMatrix:a.Z.createMatrix3(this.getUniformName("modelViewNormalMatrix")),ambient:a.Z.createFloat4(this.getUniformName("ambient")),diffuse:a.Z.createFloat4(this.getUniformName("diffuse")),specular:a.Z.createFloat4(this.getUniformName("specular")),attenuation:a.Z.createFloat4(this.getUniformName("attenuation")),spotCutOff:a.Z.createFloat1(this.getUniformName("spotCutOff")),spotBlend:a.Z.createFloat1(this.getUniformName("spotBlend")),ground:a.Z.createFloat4(this.getUniformName("ground"))}),e.uniforms[t]},isEnabled:function(){return this._enable},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},setAmbient:function(e){o.vh.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setDiffuse:function(e){o.vh.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setSpecular:function(e){o.vh.copy(this._specular,e)},getSpecular:function(){return this._specular},setPosition:function(e){o.vh.copy(this._position,e)},getPosition:function(){return this._position},setDirection:function(e){o.R3.copy(this._direction,e)},getDirection:function(){return this._direction},setSpotCutoff:function(e){this._spotCutoff=e},getSpotCutoff:function(){return this._spotCutoff},setSpotBlend:function(e){this._spotBlend=e},getSpotBlend:function(){return this._spotBlend},setGround:function(e){o.R3.copy(this._ground,e)},getGround:function(){return this._ground},setConstantAttenuation:function(e){this._attenuation[0]=e},getConstantAttenuation:function(){return this._attenuation[0]},setLinearAttenuation:function(e){this._attenuation[1]=e},getLinearAttenuation:function(){return this._attenuation[1]},setQuadraticAttenuation:function(e){this._attenuation[2]=e},getQuadraticAttenuation:function(){return this._attenuation[2]},setLightType:function(e){return e===s.DIRECTION?this.setLightAsDirection():e===s.SPOT?this.setLightAsSpot():e===s.HEMI?this.setLightAsHemi():this.setLightAsPoint()},getLightType:function(){return this.isDirectionLight()?s.DIRECTION:this.isSpotLight()?s.SPOT:this.isHemiLight()?s.HEMI:s.POINT},setLightAsSpot:function(){o.vh.set(this._position,0,0,0,1),o.R3.set(this._direction,0,0,-1),this._ground[3]=-1,this._spotCutoff=90,this._dirtyHash=!0},setLightAsPoint:function(){o.vh.set(this._position,0,0,0,1),o.R3.set(this._direction,0,0,-1),this._ground[3]=-1,this._dirtyHash=!0},setLightAsDirection:function(){o.vh.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=-1,this._dirtyHash=!0},setLightAsHemi:function(){o.vh.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=1,this._dirtyHash=!0},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},isSpotLight:function(){return this._spotCutoff<180},isDirectionLight:function(){return 0===this._position[3]&&-1===this._ground[3]},isHemiLight:function(){return 1===this._ground[3]},applyPositionedUniform:function(e){var t=this.getOrCreateUniforms(),i=t.modelViewMatrix.getInternalArray(),n=t.modelViewNormalMatrix.getInternalArray(),r=t.viewPosition.getInternalArray(),a=t.viewDirection.getInternalArray();o._E.copy(i,e),o.wO.normalFromMat4(n,e),o.vh.transformMat4(r,this._position,i),o.R3.transformMat3(a,this._direction,n)},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();if(this.isSpotLight()){var t=Math.cos(this._spotCutoff*Math.PI/180);e.spotCutOff.setFloat(t),e.spotBlend.setFloat((1-t)*this._spotBlend)}this.isHemiLight()&&e.ground.setFloat4(this._ground),e.attenuation.setFloat4(this._attenuation),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.ambient.setFloat4(this._ambient)}}}),"osg","Light");const A=s},Ln1o:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,r=i("GoyH"),a=i("IpZ9"),o=i("pSxj"),s=i("W40i"),A=function(){a.Z.call(this),this.setCullingActive(!1),this._light=void 0,this._referenceFrame=o.Z.RELATIVE_RF};r.Z.createPrototypeNode(A,r.Z.objectInherit(a.Z.prototype,{getLight:function(){return this._light},setLight:function(e){this._light=e},setReferenceFrame:function(e){this._referenceFrame=e},getReferenceFrame:function(){return this._referenceFrame},computeBoundingSphere:(n=s.R3.create(),function(e){if(a.Z.prototype.computeBoundingSphere.call(this,e),void 0!==this._light&&this._referenceFrame===o.Z.RELATIVE_RF){var t=this._light.getPosition();0!==t[3]&&e.expandByVec3(s.R3.scale(n,t,1/t[3]))}return e})}),"osg","LightSource");const g=A},oHbX:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n,r,a,o,s=i("GoyH"),A=i("IpZ9"),g=i("CJNH"),h=i("W40i"),c=i("bxht"),l=function(){A.Z.call(this),this._radius=-1,this._range=[],this._rangeMode=l.DISTANCE_FROM_EYE_POINT,this._userDefinedCenter=[],this._centerMode=l.USE_BOUNDING_SPHERE_CENTER};l.DISTANCE_FROM_EYE_POINT=0,l.PIXEL_SIZE_ON_SCREEN=1,l.USE_BOUNDING_SPHERE_CENTER=0,l.USER_DEFINED_CENTER=1,l.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED=2,s.Z.createPrototypeNode(l,s.Z.objectInherit(A.Z.prototype,{getRadius:function(){return this._radius},setRadius:function(e){this._radius=e},setCenter:function(e){this._centerMode!==l.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&(this._centerMode=l.USER_DEFINED_CENTER),this._userDefinedCenter=e},getCenter:function(){return this._centerMode===l.USER_DEFINED_CENTER||this._centerMode===l.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED?this._userDefinedCenter:this.getBound().center()},setCenterMode:function(e){this._centerMode=e},computeBoundingSphere:function(e){if(this._centerMode===l.USER_DEFINED_CENTER&&this._radius>=0)return e.set(this._userDefinedCenter,this._radius),e;if(this._centerMode===l.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&this._radius>=0){e.set(this._userDefinedCenter,this._radius);var t=new c.Z;return e.expandByBoundingSphere(A.Z.prototype.computeBoundingSphere.call(this,t)),e}return A.Z.prototype.computeBoundingSphere.call(this,e),e},projectBoundingSphere:(o=h.R3.create(),function(e,t,i){h.R3.transformMat4(o,e.center(),t);var n=e.radius2(),r=o[2]*o[2],a=h.R3.sqrLen(o);return-Math.PI*i*i*n*Math.sqrt(Math.abs((a-n)/(n-r)))/(n-r)}),setRangeMode:function(e){this._rangeMode=e},addChildNode:function(e){if(A.Z.prototype.addChild.call(this,e),this.children.length>this._range.length){var t=[],i=0;this._range.lenght>0&&(i=this._range[this._range.length-1][1]),t.push(h.K4.fromValues(i,i)),this._range.push(t)}return!0},addChild:function(e,t,i){if(A.Z.prototype.addChild.call(this,e),this.children.length>this._range.length){var n=[];n.push(h.K4.fromValues(t,t)),this._range.push(n)}return this._range[this.children.length-1][0]=t,this._range[this.children.length-1][1]=i,!0},traverse:(n=h.R3.create(),r=h.R3.create(),a=h._E.create(),function(e){switch(e.traversalMode){case g.Z.TRAVERSE_ALL_CHILDREN:for(var t=0;t<this.children.length;t++)this.children[t].accept(e);break;case g.Z.TRAVERSE_ACTIVE_CHILDREN:var i=0,o=e.getCurrentModelViewMatrix();if(h._E.invert(a,o),this._rangeMode===l.DISTANCE_FROM_EYE_POINT)h.R3.transformMat4(r,n,a),i=h.R3.distance(this.getBound().center(),r)*e.getLODScale();else{var s=e.getCurrentProjectionMatrix();i=(i=this.projectBoundingSphere(this.getBound(),o,s[0]))*e.getViewport().width()*e.getViewport().width()*.25/e.getLODScale()}var A=this.children.length;this._range.length<A&&(A=this._range.length);for(var c=0;c<A;++c)this._range[c][0]<=i&&i<this._range[c][1]&&this.children[c].accept(e)}})}),"osg","Lod");const u=l},P3GF:(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("GoyH"),r=i("WWMP"),a=i("W40i"),o=i("64xh"),s=function(){r.Z.call(this),this._ambient=a.vh.fromValues(.2,.2,.2,1),this._diffuse=a.vh.fromValues(.8,.8,.8,1),this._specular=a.vh.fromValues(0,0,0,1),this._emission=a.vh.fromValues(0,0,0,1),this._shininess=12.5};n.Z.createPrototypeStateAttribute(s,n.Z.objectInherit(r.Z.prototype,{attributeType:"Material",cloneType:function(){return new s},getParameterName:function(e){return"u"+this.getType()+"_"+e},getOrCreateUniforms:function(){var e=s;return e.uniforms||(e.uniforms={ambient:o.Z.createFloat4("uMaterialAmbient"),diffuse:o.Z.createFloat4("uMaterialDiffuse"),specular:o.Z.createFloat4("uMaterialSpecular"),emission:o.Z.createFloat4("uMaterialEmission"),shininess:o.Z.createFloat1("uMaterialShininess")}),e.uniforms},setEmission:function(e){a.vh.copy(this._emission,e)},getEmission:function(){return this._emission},setAmbient:function(e){a.vh.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setSpecular:function(e){a.vh.copy(this._specular,e)},getSpecular:function(){return this._specular},setDiffuse:function(e){a.vh.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setShininess:function(e){this._shininess=e},getShininess:function(){return this._shininess},setTransparency:function(e){this._diffuse[3]=1-e},getTransparency:function(){return this._diffuse[3]},apply:function(){var e=this.getOrCreateUniforms();e.ambient.setFloat4(this._ambient),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.emission.setFloat4(this._emission),e.shininess.setFloat(this._shininess)}}),"osg","Material");const A=s},rfV8:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,r=i("GoyH"),a=i("W40i"),o=i("6RPJ"),s=i("pSxj"),A=function(){o.Z.call(this),this.matrix=a._E.create()};r.Z.createPrototypeNode(A,r.Z.objectInherit(o.Z.prototype,{getMatrix:function(){return this.matrix},setMatrix:function(e){this.matrix=e,this.dirtyBound()},computeLocalToWorldMatrix:function(e){return this.referenceFrame===s.Z.RELATIVE_RF?a._E.mul(e,e,this.matrix):a._E.copy(e,this.matrix),!0},computeWorldToLocalMatrix:(n=a._E.create(),function(e){return a._E.invert(n,this.matrix),this.referenceFrame===s.Z.RELATIVE_RF?a._E.mul(e,n,e):a._E.copy(e,n),!0})}),"osg","MatrixTransform");const g=A},IpZ9:(e,t,i)=>{"use strict";i.d(t,{Z:()=>f});var n=i("GoyH"),r=i("iUVs"),a=i("k3oU"),o=i("bxht"),s=i("o4nZ"),A=i("CJNH"),g=i("W40i"),h=i("cyFB"),c=i("haRL"),l=i("pSxj"),u=function(){r.Z.call(this),this.children=[],this._parents=[],this.nodeMask=-1,this._boundingSphere=new o.Z,this._boundingSphereComputed=!1,this._boundingBox=new a.Z,this._boundingBoxComputed=!1,this._updateCallbacks=[],this._cullCallback=void 0,this._cullingActive=!0,this._numChildrenWithCullingDisabled=0,this._numChildrenRequiringUpdateTraversal=0,this._tmpBox=new a.Z},d=new h.Z(g._E.create),I=function(){var e=d.getOrCreateObject();return g._E.identity(e)},C=new o.Z;n.Z.createPrototypeNode(u,n.Z.objectInherit(r.Z.prototype,{getMinimumBound:function(){var e=this.getBoundingBox(),t=this.getBoundingSphere();return!e.valid()||t.volume()<e.volume()?t:(C.copyBoundingBox(e),C)},getOrCreateStateSet:function(){return this.stateset||this.setStateSet(new s.Z),this.stateset},getStateSet:function(){return this.stateset},accept:function(e){e.validNodeMask(this)&&(e.pushOntoNodePath(this),e.apply(this),e.popFromNodePath())},dirtyBound:function(){if(!0===this._boundingSphereComputed||!0===this._boundingBoxComputed){this._boundingSphereComputed=!1,this._boundingBoxComputed=!1;for(var e=this._parents,t=0,i=e.length;t<i;t++)e[t].dirtyBound()}},setNodeMask:function(e){this.nodeMask=e},getNodeMask:function(){return this.nodeMask},setStateSet:function(e){if(this.stateset!==e){var t=0;this.stateset&&(this.stateset.requiresUpdateTraversal()&&t--,this.stateset.removeParent(this)),e&&(e.addParent(this),e.requiresUpdateTraversal()&&++t),0!==t&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+t),this.stateset=e}},_updateNumChildrenRequeringUpdateTraversal:function(e){if(0===this._numChildrenRequiringUpdateTraversal&&this._parents.length)for(var t=0,i=this._parents.length;t<i;t++){var n=this._parents[t],r=n.getNumChildrenRequiringUpdateTraversal();n.setNumChildrenRequiringUpdateTraversal(r+e)}},setNumChildrenRequiringUpdateTraversal:function(e){if(this._numChildrenRequiringUpdateTraversal!==e){if(!this._updateCallbacks.length&&this._parents.length){var t=0;if(this._numChildrenRequiringUpdateTraversal>0&&--t,e>0&&++t,0!==t)for(var i=this._parents,n=0,r=i.length;n<r;n++){var a=i[n],o=a.getNumChildrenRequiringUpdateTraversal();a.setNumChildrenRequiringUpdateTraversal(o+t)}}this._numChildrenRequiringUpdateTraversal=e}},getNumChildrenRequiringUpdateTraversal:function(){return this._numChildrenRequiringUpdateTraversal},getUpdateCallback:function(){return this._updateCallbacks[0]},addUpdateCallback:function(e){var t=Boolean(this._updateCallbacks.length);this._updateCallbacks.push(e),t||this._updateNumChildrenRequeringUpdateTraversal(1)},removeUpdateCallback:function(e){var t=this._updateCallbacks.indexOf(e);-1!==t&&(this._updateCallbacks.splice(t,1),this._updateCallbacks.length||this._updateNumChildrenRequeringUpdateTraversal(-1))},getUpdateCallbackList:function(){return this._updateCallbacks},setCullCallback:function(e){this._cullCallback=e},getCullCallback:function(){return this._cullCallback},hasChild:function(e){for(var t=0,i=this.children.length;t<i;t++)if(this.children[t]===e)return!0;return!1},addChild:function(e){if(-1===this.children.indexOf(e))return this.children.push(e),e.addParent(this),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+1),(e.getNumChildrenWithCullingDisabled()>0||!1===e.getCullingActive())&&this.setNumChildrenWithCullingDisabled(this.getNumChildrenWithCullingDisabled()+1),e},getChildren:function(){return this.children},getNumChildren:function(){return this.children.length},getChild:function(e){return this.children[e]},getParents:function(){return this._parents},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeChildren:function(){var e=this.children,t=e.length;if(t){for(var i=0,n=0;n<t;n++){var r=e[n];r.removeParent(this),(r.getNumChildrenRequiringUpdateTraversal()>0||r.getUpdateCallbackList().length)&&++i}e.length=0,i&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-i),this.dirtyBound()}},removeChild:function(e){var t=this.children,i=t.indexOf(e);-1!==i&&(e.removeParent(this),t.splice(i,1),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-1))},traverse:function(e){for(var t=this.children,i=0,n=t.length;i<n;i++){t[i].accept(e)}},ascend:function(e){for(var t=this._parents,i=0,n=t.length;i<n;i++){t[i].accept(e)}},getBoundingBox:function(){return this._boundingBoxComputed||(this.computeBoundingBox(this._boundingBox),this._boundingBoxComputed=!0),this._boundingBox},computeBoundingBox:function(e){var t=i("t+pa").Z,n=t.instance=t.instance||new t;return n.setNodeMaskOverride(-1),n.reset(),n.apply(this),e.copy(n.getBoundingBox()),e},getBoundingSphere:function(){return this.getBound()},getBound:function(){return this._boundingSphereComputed||(this.computeBoundingSphere(this._boundingSphere),this._boundingSphereComputed=!0),this._boundingSphere},computeBoundingSphere:function(e){var t,i,n=this.children,r=n.length;if(e.init(),0===r)return e;var a=this._tmpBox;for(a.init(),i=0;i<r;i++)(t=n[i]).referenceFrame!==l.Z.ABSOLUTE_RF&&a.expandByBoundingSphere(t.getBound());if(!a.valid())return e;for(e.set(a.center(e.center()),0),i=0;i<r;i++)(t=n[i]).referenceFrame!==l.Z.ABSOLUTE_RF&&e.expandRadiusBySphere(t.getBound());return e},getWorldMatrices:function(){var e=function(){this.nodePaths=[],this.halt=void 0,A.Z.call(this,A.Z.TRAVERSE_PARENTS)};e.prototype=n.Z.objectInherit(A.Z.prototype,{reset:function(){this.nodePath.length=0,this.nodePaths.length=0},apply:function(e){0===e._parents.length||e===this.halt||e.referenceFrame===l.Z.ABSOLUTE_RF?this.nodePaths.push(this.nodePath.slice(0)):this.traverse(e)}});var t=new e;return t.setNodeMaskOverride(-1),function(e,i){t.reset(),t.halt=e,this.accept(t);for(var n=[],r=i||g._E.create,a=0,o=t.nodePaths.length;a<o;a++){var s=t.nodePaths[a],A=r();0!==s.length&&c.Z.computeLocalToWorld(s,!0,A),n.push(A)}return n}}(),getWorldMatrix:function(e,t){var i=this.getWorldMatrices(e,I);return 0===i.length?g._E.identity(t):g._E.copy(t,i[0]),d.reset(),t},setCullingActive:function(e){if(this._cullingActive!==e){if(0===this._numChildrenWithCullingDisabled&&this._parents.length>0){var t=0;if(this._cullingActive||--t,e||++t,0!==t)for(var i=0,n=this._parents.length;i<n;i++)this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled()+t)}this._cullingActive=e}},getCullingActive:function(){return this._cullingActive},isCullingActive:function(){return 0===this._numChildrenWithCullingDisabled&&this._cullingActive&&this.getBound().valid()},setNumChildrenWithCullingDisabled:function(e){if(this._numChildrenWithCullingDisabled!==e){if(this._cullingActive&&this._parents.length>0){var t=0;if(this._numChildrenWithCullingDisabled>0&&--t,e>0&&++t,0!==t)for(var i=0,n=this._parents.length;i<n;i++)this._parents[i].setNumChildrenWithCullingDisabled(this._parents[i].getNumChildrenWithCullingDisabled()+t)}this._numChildrenWithCullingDisabled=e}},getNumChildrenWithCullingDisabled:function(){return this._numChildrenWithCullingDisabled},releaseGLObjects:function(){void 0!==this.stateset&&this.stateset.releaseGLObjects()}}),"osg","Node");const f=u},CJNH:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=function(e){this.traversalMask=-1,this.nodeMaskOverride=0,this.traversalMode=e,void 0===e&&(this.traversalMode=n.TRAVERSE_ALL_CHILDREN),this.nodePath=[],this.visitorType=n.NODE_VISITOR,this._databaseRequestHandler=void 0,this._frameStamp=void 0,this.traverse=n._traversalFunctions[this.traversalMode],this.pushOntoNodePath=n._pushOntoNodePath[this.traversalMode],this.popFromNodePath=n._popFromNodePath[this.traversalMode]};n.TRAVERSE_PARENTS=1,n.TRAVERSE_ALL_CHILDREN=2,n.TRAVERSE_ACTIVE_CHILDREN=3,n.NODE_VISITOR=0,n.UPDATE_VISITOR=1,n.CULL_VISITOR=2;var r=function(e){e.traverse(this)};n._traversalFunctions=[void 0,function(e){e.ascend(this)},r,r];var a=function(e){this.nodePath.push(e)};n._pushOntoNodePath=[void 0,function(e){this.nodePath.unshift(e)},a,a];var o=function(){this.nodePath.pop()};n._popFromNodePath=[void 0,function(){return this.nodePath.shift()},o,o],n.prototype={reset:function(){this.nodePath.length=0},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setNodeMaskOverride:function(e){this.nodeMaskOverride=e},getNodeMaskOverride:function(){return this.nodeMaskOverride},setTraversalMask:function(e){this.traversalMask=e},getTraversalMask:function(){return this.traversalMask},getNodePath:function(){return this.nodePath},validNodeMask:function(e){var t=e.getNodeMask();return 0!=(this.traversalMask&(this.nodeMaskOverride|t))},apply:function(e){this.traverse(e)},getVisitorType:function(){return this.visitorType},setDatabaseRequestHandler:function(e){this._databaseRequestHandler=e},getDatabaseRequestHandler:function(){return this._databaseRequestHandler}};const s=n},iUVs:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=function(){this._name=void 0,this._userdata=void 0,this._instanceID=r.getInstanceID()};n.Z.createPrototypeObject(r,{cloneType:function(){return new(0,this.constructor)},getInstanceID:function(){return this._instanceID},setName:function(e){this._name=e},getName:function(){return this._name},setUserData:function(e){this._userdata=e},getUserData:function(){return this._userdata}},"osg","Object");var a=0;r.getInstanceID=function(){return a+=1};const o=r},"bYH/":(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n,r=i("u5PS"),a=i("GoyH"),o=i("MQQR"),s=function(){var e={antialias:!0,fullscreen:!0,enableFrustumCulling:!1,scrollwheel:!0,webgl2:(0,o.Z)().webgl2,powerPreference:"high-performance",shaderStats:!1,stats:!1};for(var t in e)this[t]=e[t]};s.getOptionsURL=function(){if(n)return n;if(n={},!window.location.search)return n;for(var e,t=[],i=window.location.search.slice(1).split("&"),a=0;a<i.length;a++){var o=(e=i[a].split("="))[0];t.push(o);var s=e[1];"0"!==s&&"false"!==s&&(void 0===s&&(s="1"),n[o]=s)}if(void 0!==n.log)switch(n.log.toLowerCase()){case"debug":r.Z.setNotifyLevel(r.Z.DEBUG);break;case"info":r.Z.setNotifyLevel(r.Z.INFO);break;case"notice":r.Z.setNotifyLevel(r.Z.NOTICE);break;case"warn":r.Z.setNotifyLevel(r.Z.WARN);break;case"error":r.Z.setNotifyLevel(r.Z.ERROR);break;case"html":var A=[],g=document.createElement("div"),h=document.createElement("pre");document.addEventListener("DOMContentLoaded",(function(){document.body.insertBefore(g,document.body.firstChild),g.appendChild(h)}));var c=function(e){A.unshift(e),h.innerHTML=A.join("\n")};g.style.overflow="hidden",g.style.position="absolute",g.style.zIndex="10000",g.style.height="100%",g.style.maxWidth="600px",g.style.pointerEvents="none",h.style.overflow="scroll",h.style.width="105%",h.style.height="100%",h.style.fontSize="10px",h.style.pointerEvents="none",["log","error","warn","info","debug"].forEach((function(e){window.console[e]=c}))}return n},s.prototype={extend:function(e){return a.Z.objectMix(this,e),this},get:function(e){return this[e]},getBoolean:function(e){var t=this.getString(e);if(t)return"false"!==t&&"0"!==t},getNumber:function(e){var t=this[e];if(t)return Number(t)},getString:function(e){if(void 0!==this[e])return this[e].toString()},extendWithOptionsURL:function(){this.extend(s.getOptionsURL())}};const A=s},"+jyg":(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n,r,a,o=i("GoyH"),s=i("oHbX"),A=i("CJNH"),g=i("W40i"),h=function(){s.Z.call(this),this._perRangeDataList=[],this._loading=!1,this._expiryTime=0,this._expiryFrame=0,this._centerMode=s.Z.USER_DEFINED_CENTER,this._frameNumberOfLastTraversal=0,this._databasePath="",this._numChildrenThatCannotBeExpired=0},c=function(){this.filename="",this.function=void 0,this.loaded=!1,this.timeStamp=0,this.frameNumber=0,this.frameNumberOfLastTraversal=0,this.dbrequest=void 0};o.Z.createPrototypeNode(h,o.Z.objectInherit(s.Z.prototype,{setRange:function(e,t,i){if(e>=this._range.length){var n=[];n.push([t,t]),this._range.push(n)}this._range[e][0]=t,this._range[e][1]=i},setExpiryTime:function(e){this._expiryTime=e},setDatabasePath:function(e){this._databasePath=e},getDatabasePath:function(){return this._databasePath},setFileName:function(e,t){if(e>=this._perRangeDataList.length){var i=new c;i.filename=t,this._perRangeDataList.push(i)}else this._perRangeDataList[e].filename=t},setFunction:function(e,t){if(e>=this._perRangeDataList.length){var i=new c;i.function=t,this._perRangeDataList.push(i)}else this._perRangeDataList[e].function=t},addChild:function(e,t,i){s.Z.prototype.addChild.call(this,e,t,i),this._perRangeDataList.push(new c)},addChildNode:function(e){s.Z.prototype.addChildNode.call(this,e)},setFrameNumberOfLastTraversal:function(e){this._frameNumberOfLastTraversal=e},getFrameNumberOfLastTraversal:function(){return this._frameNumberOfLastTraversal},setTimeStamp:function(e,t){this._perRangeDataList[e].timeStamp=t},setFrameNumber:function(e,t){this._perRangeDataList[e].frameNumber=t},setNumChildrenThatCannotBeExpired:function(e){this._numChildrenThatCannotBeExpired=e},getNumChildrenThatCannotBeExpired:function(){return this._numChildrenThatCannotBeExpired},getDatabaseRequest:function(e){return this._perRangeDataList[e].dbrequest},removeExpiredChildren:function(e,t,i){if(!(this.children.length<=this._numChildrenThatCannotBeExpired)){var n,r,a=this.children.length-1;n=this._perRangeDataList[a].timeStamp+this._expiryTime,r=this._perRangeDataList[a].frameNumber+this._expiryFrame,n<e&&r<t&&(this._perRangeDataList[a].filename.length>0||void 0!==this._perRangeDataList[a].function)&&(i.push(this.children[a]),this.removeChild(this.children[a]),this._perRangeDataList[a].loaded=!1,void 0!==this._perRangeDataList[a].dbrequest&&(this._perRangeDataList[a].dbrequest._groupExpired=!0))}},traverse:(n=g.R3.create(),r=g.R3.create(),a=g._E.create(),function(e){var t=e.traversalMode,i=!1;switch(e.getVisitorType()===A.Z.CULL_VISITOR&&(this._frameNumberOfLastTraversal=e.getFrameStamp().getFrameNumber(),i=!0),t){case A.Z.TRAVERSE_ALL_CHILDREN:for(var o=0;o<this.children.length;o++)this.children[o].accept(e);break;case A.Z.TRAVERSE_ACTIVE_CHILDREN:var h=0,c=e.getCurrentModelViewMatrix();if(g._E.invert(a,c),this._rangeMode===s.Z.DISTANCE_FROM_EYE_POINT)g.R3.transformMat4(r,n,a),h=g.R3.distance(this.getBound().center(),r)*e.getLODScale();else{var l=e.getCurrentProjectionMatrix();(h=(h=this.projectBoundingSphere(this.getBound(),c,l[0]))*e.getViewport().width()*e.getViewport().width()*.25/e.getLODScale())<0&&(h=this._range[this._range.length-1][0])}for(var u=!1,d=-1,I=0;I<this._range.length;++I)this._range[I][0]<=h&&h<this._range[I][1]&&(I<this.children.length?(i&&(this._perRangeDataList[I].timeStamp=e.getFrameStamp().getSimulationTime(),this._perRangeDataList[I].frameNumber=e.getFrameStamp().getFrameNumber()),this.children[I].accept(e),d=I):u=!0);if(u){var C=this.children.length;if(C>0&&C-1!==d&&(i&&(this._perRangeDataList[C-1].timeStamp=e.getFrameStamp().getSimulationTime(),this._perRangeDataList[C-1].frameNumber=e.getFrameStamp().getFrameNumber()),this.children[C-1].accept(e)),C<this._perRangeDataList.length){var f=(this._range[C][0]-h)/(this._range[C][1]-this._range[C][0]);this._rangeMode===s.Z.PIXEL_SIZE_ON_SCREEN&&(f=-f);var p=e.nodePath[e.nodePath.length-1];if(!1===this._perRangeDataList[C].loaded){this._perRangeDataList[C].loaded=!0;var m=e.getDatabaseRequestHandler();this._perRangeDataList[C].dbrequest=m.requestNodeFile(this._perRangeDataList[C].function,this._databasePath+this._perRangeDataList[C].filename,p,e.getFrameStamp().getSimulationTime(),f)}else void 0!==this._perRangeDataList[C].dbrequest?(this._perRangeDataList[C].dbrequest._timeStamp=e.getFrameStamp().getSimulationTime(),this._perRangeDataList[C].dbrequest._priority=f):this._perRangeDataList[C].loaded=!1}}}})}),"osg","PagedLOD");const l=h},itLJ:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n,r=i("GoyH"),a=i("W40i"),o=r.Z.objectInherit(a.vh,{INSIDE:1,INTERSECT:2,OUTSIDE:3,transformProvidingInverse:function(){var e=o.create();return function(t,i){var n=t[0],r=t[1],a=t[2],s=t[3];return e[0]=i[0]*n+i[1]*r+i[2]*a+i[3]*s,e[1]=i[4]*n+i[5]*r+i[6]*a+i[7]*s,e[2]=i[8]*n+i[9]*r+i[10]*a+i[11]*s,e[3]=i[12]*n+i[13]*r+i[14]*a+i[15]*s,o.normalizeEquation(e),o.copy(e,t),t}},normalizeEquation:function(e){var t=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t},getNormal:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},setNormal:function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]},getDistance:function(e){return e[3]},setDistance:function(e,t){e[3]=t},distanceToPlane:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},intersectsOrContainsBoundingSphere:function(e,t){if(!t.valid())return o.OUTSIDE;var i=t.center(),n=t.radius(),r=this.distanceToPlane(e,i);return r<-n?o.OUTSIDE:r<=n?o.INTERSECT:o.INSIDE},instersectsBoundingSphere:function(e,t){return this.intersectsOrContainsBoundingSphere(e,t)===o.INTERSECT},intersectsOrContainsBoundingBox:(n=a.R3.create(),function(e,t){var i=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),r=7&~i;return this.distanceToPlane(e,t.corner(r,n))>0?o.INSIDE:this.distanceToPlane(e,t.corner(i,n))<0?o.OUTSIDE:o.INTERSECT}),intersectsBoundingBox:function(e,t,i){return this.intersectsOrContainsBoundingBox(e,t,i)===o.INTERSECT},intersectOrContainsVertices:function(e,t){for(var i=-1,n=0;n<t.length;n++){var r=this.distanceToPlane(e,t[n]);if(r<0){if(1===i)return o.INTERSECT;i=2}else{if(!(r>0))return o.INTERSECT;if(2===i)return o.INTERSECT;i=1}}return i>0?o.INSIDE:o.OUTSIDE},intersectVertices:function(e,t){return this.intersectOrContainsVertices(e,t)===o.INTERSECT}});const s=o},"e0P+":(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("iUVs"),r=i("itLJ"),a=i("GoyH"),o=i("W40i"),s=i("bDLW"),A=function(){this._clippingMask=0,this._planeList=[r.Z.create(),r.Z.create(),r.Z.create(),r.Z.create(),r.Z.create(),r.Z.create()],this._vertexList=[],this._maskStack=new s.Z,this._resultMask=0,this._maskStack.push(this._resultMask)};a.Z.createPrototypeObject(A,a.Z.objectInherit(n.Z.prototype,{getPlanes:function(){return this._planeList},setPlanes:function(e){this._planeList=e,this.setupMask()},clear:function(){if(this._clippingMask=0,this._planeList)for(var e=0,t=this._planeList.length;e<t;++e)r.Z.init(this._planeList[e]);this._vertexList=[],this.setupMask()},setToUnitFrustum:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._planeList.length=0,this._planeList.push(o.vh.set(r.Z.create(),1,0,0,1)),this._planeList.push(o.vh.set(r.Z.create(),-1,0,0,1)),this._planeList.push(o.vh.set(r.Z.create(),0,1,0,1)),this._planeList.push(o.vh.set(r.Z.create(),0,-1,0,1)),e&&this._planeList.push(o.vh.set(r.Z.create(),0,0,1,1)),t&&this._planeList.push(o.vh.set(r.Z.create(),0,0,-1,1)),this.setupMask()},setToBoundingBox:function(e){this._planeList.length=0,this._planeList.push(o.vh.set(r.Z.create(),1,0,0,-e.getMin()[0])),this._planeList.push(o.vh.set(r.Z.create(),-1,0,0,e.getMax()[0])),this._planeList.push(o.vh.set(r.Z.create(),0,1,0,-e.getMin()[1])),this._planeList.push(o.vh.set(r.Z.create(),0,-1,0,e.getMax()[1])),this._planeList.push(o.vh.set(r.Z.create(),0,0,1,-e.getMin()[2])),this._planeList.push(o.vh.set(r.Z.create(),0,0,-1,e.getMax()[2])),this.setupMask()},setAndTransformProvidingInverse:function(e,t){this._referenceVertexList=e._referenceVertexList;var i=this._maskStack.getLength()-1,n=e._maskStack[i];if(0===n)return this._maskStack.getArray()[i]=0,this._resultMask=0,void(this._planeList.length=0);var a,o=1,s=0;for(a=0;a!==e._planeList.length;++a)n&o&&++s,o<<=1;this._planeList.length=s,this._resultMask=0,o=1;var A=0;for(a=0;a!==e._planeList.length;++a)n&o&&(this._planeList[A]=e._planeList[a],r.Z.transformProvidingInverse(this._planeList[A++],t),this._resultMask=this._resultMask<<1|1),o<<=1;this._maskStack.getArray()[i]=this._resultMask},voidset:function(e){this._planeList=e,this.setupMask()},add:function(e){this._planeList.push(e),this.setupMask()},empty:function(){return 0===this._planeList.length},setReferenceVertexList:function(e){this._referenceVertexList=e},getReferenceVertexList:function(){return this._referenceVertexList},setupMask:function(e){this._resultMask=0;for(var t=void 0!==e?e:this._planeList.length,i=0;i<t;++i)this._resultMask=this._resultMask<<1|1;this._maskStack.reset(),this._maskStack.push(this._resultMask)},getCurrentMask:function(){return this._maskStack.back()},setResultMask:function(e){this._resultMask=e},getResultMask:function(){return this._resultMask},getMaskStack:function(){return this._maskStack},pushCurrentMask:function(){this._maskStack.push(this._resultMask)},popCurrentMask:function(){return this._maskStack.pop()},containsVertex:function(e){var t=this._maskStack.back();if(!t)return!0;for(var i=1,n=0;n<this._planeList.length;++n){if(t&i&&r.Z.distanceToPlane(this._planeList[n],e)<0)return!1;i<<=1}return!0},containsVertices:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var i=0;i<e.length;++i){for(var n=e[i],a=!1,o=1,s=0;!a&&s<this._planeList.length;++s)t&o&&r.Z.distanceToPlane(this._planeList[s],n)<0&&(a=!0),o<<=1;if(!a)return!0}return!1},containsBoundingSphere:function(e){var t=this._maskStack.back();if(!t||!e.valid())return!0;this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n){if(this._resultMask&i){var a=r.Z.intersectsOrContainsBoundingSphere(this._planeList[n],e);if(r.Z.OUTSIDE===a)return!1;r.Z.INSIDE===a&&(this._resultMask^=i)}i<<=1}return!0},containsBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n){if(this._resultMask&i){var a=r.Z.intersectsOrContainsBoundingBox(this._planeList[n],e);if(r.Z.OUTSIDE===a)return!1;r.Z.INSIDE===a&&(this._resultMask^=i)}i<<=1}return!0},containsAllOfVertices:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n){if(this._resultMask&i){if(r.Z.intersectsOrContainsVertices(this._planeList[n],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},containsAllOfBoundingSphere:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n){if(this._resultMask&i){if(r.Z.intersectsOrContainsBoundingSphere(this._planeList[n],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},containsAllOfBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n){if(this._resultMask&i){if(r.Z.intersectsOrContainsBoundingBox(this._planeList[n],e)<1)return!1;this._resultMask^=i}i<<=1}return!0},transformProvidingInverse:function(e){var t=this._maskStack.back();if(t){this._resultMask=t;for(var i=1,n=0;n<this._planeList.length;++n)t&i&&r.Z.transformProvidingInverse(this._planeList[n],e),i<<=1}}}),"osg","Polytope");const g=A},bDLW:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(){this._pool=[],this._length=0};n.prototype={clean:function(){this._length=0,this._pool.length=0},reset:function(){this._length=0},getLength:function(){return this._length},getArray:function(){return this._pool},back:function(){return this._pool[this._length-1]},pop:function(){return this._length--,this._pool[this._length]},push:function(e){this._length===this._pool.length?this._pool.push(e):this._pool[this._length]=e,this._length++},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}};const r=n},gjC8:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("bDLW"),r=function(){this._keys=new n.Z,this._map={}};r.prototype={reset:function(){for(var e=this._keys.getArray(),t=this._keys.getLength(),i=0;i<t;i++){var n=e[i];this._map[n]=void 0}this._keys.reset()},set:function(){},hasKey:function(e){return void 0!==this._map[e]},getMap:function(){return this._map},getKeys:function(){return this._keys},forEach:function(e){for(var t=this._keys.getArray(),i=this._keys.getLength(),n=0;n<i;n++){var r=t[n];e(r,this._map[r])}}};const a=r},cyFB:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(e){this._createFunction=e,this._pool=[],this._length=0};n.prototype={clean:function(){this._pool.length=0,this._length=0},getLength:function(){return this._length},reset:function(){this._length=0},getOrCreateObject:function(){var e;return this._length===this._pool.length?(e=this._createFunction(),this._pool.push(e)):e=this._pool[this._length],this._length++,e},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}};const r=n},"5pih":(e,t,i)=>{"use strict";i.d(t,{Z:()=>_});var n,r=i("GoyH"),a=i("u5PS"),o=i("bYH/"),s=i("/CZr"),A=i("WWMP"),g=i("w/Ui"),h=i("6qT5"),c=i("BvLe"),l=o.Z.getOptionsURL(),u=l.shaderStats?{}:void 0,d=l.forceSyncLink,I=new Uint8Array(4),C=function(e){e.flush(),e.finish(),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,I)},f=/uniform\s+\w+\s+(\w+)((\s)?\[(.*?)\])?/g,p=/(in|attribute)\s+\w+\s+(\w+)\s*;/g,m=function(e,t){s.Z.call(this),A.Z.call(this),this._program=null,this._nullProgram=!0,this._vertex=void 0,this._fragment=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._activeUniforms=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,this._asyncCompilation=void 0,this._asyncLinkingExt=d?void 0:c.Z.instance().getWebGLExtension("KHR_parallel_shader_compile"),this._compileClean=void 0,e&&this.setVertexShader(e),t&&this.setFragmentShader(t),this._dirty=!0};m._sDeletedGLProgramCache=new window.Map,m.deleteGLProgram=function(e,t){m._sDeletedGLProgramCache.has(e)||m._sDeletedGLProgramCache.set(e,[]),m._sDeletedGLProgramCache.get(e).push(t)},m.flushDeletedGLPrograms=function(e,t){if(t<=0)return t;if(!m._sDeletedGLProgramCache.has(e))return t;for(var i=0,n=h.Z.instance().tick(),r=m._sDeletedGLProgramCache.get(e),a=r.length-1;a>=0&&i<t;a--)e.deleteProgram(r[a]),r.splice(a,1),i=h.Z.instance().deltaS(n,h.Z.instance().tick());return t-i},m.flushAllDeletedGLPrograms=function(e){if(m._sDeletedGLProgramCache.has(e))for(var t=m._sDeletedGLProgramCache.get(e),i=t.length-1;i>=0;i--)e.deleteProgram(t[i]),t.splice(i,1)},m.onLostContext=function(e){m._sDeletedGLProgramCache.has(e)&&(m._sDeletedGLProgramCache.get(e).length=0,this._asyncCompilation=void 0,this._asyncLinkingExt=d?void 0:c.Z.instance().getWebGLExtension("KHR_parallel_shader_compile"),this._compileClean=void 0)},r.Z.createPrototypeStateAttribute(m,r.Z.objectInherit(s.Z.prototype,r.Z.objectInherit(A.Z.prototype,{attributeType:"Program",cloneType:function(){return new m},setVertexShader:function(e){this._vertex=e,this._nullProgram=!1,e.setText(g.Z.processShader(e.getText()))},setFragmentShader:function(e){this._fragment=e,this._nullProgram=!1,e.setText(g.Z.processShader(e.getText()))},getVertexShader:function(){return this._vertex},getFragmentShader:function(){return this._fragment},getProgram:function(){return this._program},setActiveUniforms:function(e){this._activeUniforms=e},getActiveUniforms:function(){return this._activeUniforms},setForeignUniforms:function(e){this._foreignUniforms=e},getForeignUniforms:function(){return this._foreignUniforms},setUniformsCache:function(e){this._uniformsCache=e},getUniformsCache:function(){return this._uniformsCache},setAttributesCache:function(e){this._attributesCache=e},getAttributesCache:function(){return this._attributesCache},setTrackAttributes:function(e){this._trackAttributes=e},getTrackAttributes:function(){return this._trackAttributes},releaseGLObjects:function(){void 0!==this._vertex&&this._vertex.releaseGLObjects(),void 0!==this._fragment&&this._fragment.releaseGLObjects(),null!==this._program&&(void 0!==this._gl&&(m.deleteGLProgram(this._gl,this._program),s.Z.removeObject(this._gl,this)),this.invalidate())},dirty:function(){this._program=void 0},invalidate:function(){this._cacheUniformId=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,this._compileClean=void 0,this._program=void 0},_rebuildProgramFromSpector:function(e,t,i,n){this._dirty=!0,this._vertex.invalidate(),this._fragment.invalidate(),this.invalidate(),this._vertex.setText(e),this._fragment.setText(t),this._program=null,this._spectorOnCompiled=i,this._spectorOnError=n,this._compileClean=void 0},_onErrorToSpector:function(e){return!!this._spectorOnError&&(this._spectorOnError(e),!0)},_onCompilationToSpector:function(){this._spectorOnCompiled&&this._spectorOnCompiled(this._program)},_bindProgramToSpector:function(){window&&window.spector&&!this._program.__SPECTOR_rebuildProgram&&(this._program.__SPECTOR_rebuildProgram=this._rebuildProgramFromSpector.bind(this))},_logDebugShaders:function(e,t){if("Failed to create D3D shaders.\n"===t){var i=void 0!==e.rawgl?e.rawgl:e;void 0!==i&&void 0===i.getExtension&&(i=i.getExtension("WEBGL_debug_shaders"))&&(a.Z.error(i.getTranslatedShaderSource(this._vertex.shader)),a.Z.error(i.getTranslatedShaderSource(this._fragment.shader)))}},_activateFailSafe:function(e){var t=e.createProgram();this._vertex.failSafe(e,this._vertex.getText()),this._fragment.failSafe(e,this._fragment.getText()),this._glAttachAndLink(e,t,this._vertex,this._fragment),a.Z.warn("FailSafe shader Activated "),this._program=t},_glAttachAndLink:function(e,t,i,n){e.attachShader(t,i.shader),e.attachShader(t,n.shader),e.linkProgram(t)},_glShaderCompile:function(e,t){t.shader||(u&&(t===this._vertex?u.vert=h.Z.tick():u.frag=h.Z.tick()),t.compile(e,n))},_glShaderCompilationResult:function(e,t){var i=t.getCompilationResult(e,n);return u&&(void 0===this._asyncCompilation&&C(e),t===this._vertex?u.vert=h.Z.tick()-u.vert:u.frag=h.Z.tick()-u.frag),i},compile:function(){var e=this._gl,t=this._fragment.getText(),i=this._vertex.getText();this._attributeMap=function(e){for(var t,i={};null!==(t=p.exec(e));)i[t[2]]=!0;return i}(i),this._uniformMap=function(e){for(var t,i={};null!==(t=f.exec(e));)i[t[1]]=!0;return i}(t+"\n"+i),this._glShaderCompile(e,this._vertex),this._glShaderCompile(e,this._fragment)},getShaderName:function(){if(this._shaderName)return this._shaderName;if(!this._fragment||!this._fragment.getText())return"";var e=this._fragment.getText().match(/^#define\s+SHADER_NAME\s+(.*)$/m);return this._shaderName=e&&e[1]?e[1]:"",this._shaderName},getCompilationResultAndLink:function(e){return!!this._compileClean||(u&&(u.vert=0,u.frag=0,u.link=0,u.total=0,void 0===this._asyncCompilation&&C(e),u.total=h.Z.tick(),a.Z.log(this.getShaderName()+" start"),a.Z.timeStamp(this.getShaderName()+" start")),this._compileClean=this._glShaderCompilationResult(e,this._vertex),this._compileClean=this._glShaderCompilationResult(e,this._fragment)&&this._compileClean,u&&(a.Z.log(this.getShaderName()+" compilation"),a.Z.timeStamp(this.getShaderName()+" compilation")),!!this._compileClean&&(this._program=e.createProgram(),this._attributeMap.Vertex&&e.bindAttribLocation(this._program,0,"Vertex"),this._glAttachAndLink(e,this._program,this._vertex,this._fragment),!0))},getAsyncLinkingStatus:function(){return this._asyncLinkingExt&&!0===this._gl.getProgramParameter(this._program,this._asyncLinkingExt.COMPLETION_STATUS_KHR)},getAsyncCompiling:function(){return this._asyncCompilation},_logShaderStats:function(e){if(void 0===this._asyncCompilation&&C(e),u.link=h.Z.tick()-u.link,u.link){u.total=h.Z.tick()-u.total,this._placeHolder&&(u.total=u.vert+u.frag+u.link);var t=(this._placeHolder?"Async":"")+this.getShaderName()+" - "+u.total.toFixed(2)+"ms";a.Z.group(t),a.Z.log("vertex : "+u.vert.toFixed(2)+"ms"),a.Z.log("fragment : "+u.frag.toFixed(2)+"ms"),a.Z.log("link : "+u.link.toFixed(2)+"ms"),a.Z.log("total : "+u.total.toFixed(2)+"ms"),a.Z.groupEnd(t)}},getLinkResult:function(e){if(this._compileClean){u&&(u.link=h.Z.tick(),a.Z.log(this.getShaderName()+" link"),a.Z.timeStamp(this.getShaderName()+" link"));var t=e.getProgramParameter(this._program,e.LINK_STATUS);if(u&&this._logShaderStats(e),t||e.isContextLost())this._onCompilationToSpector(this._program);else{var i=e.getProgramInfoLog(this._program);if(a.Z.errorFold(i,"can't link program\nvertex shader:\n"+this._vertex.text+"\n fragment shader:\n"+this._fragment.text),this._logDebugShaders(e,i),n&&n(this._vertex.text,this._fragment.text,i),this._compileClean=!1,this._onErrorToSpector(i))return!1}}return this._dirty=!1,this._asyncCompilation=-1,this._placeHolder=void 0,this._uniformsCache={},this._attributesCache={},this._compileClean?(this.cacheAttributeList(e,window.Object.keys(this._attributeMap)),this.cacheUniformList(e,window.Object.keys(this._uniformMap))):this._activateFailSafe(e),this._bindProgramToSpector(),this._compileClean},enableAsyncCompilation:function(e,t){this._placeHolder=e,this._asyncCompilation=t},apply:function(e){if(!this._nullProgram)if(this._gl||this.setGraphicContext(e.getGraphicContext()),!this._program||this._dirty)if(this._placeHolder)this._placeHolder.apply(e);else{if(this.compile(),!this.getCompilationResultAndLink(this._gl))return this._dirty=!1,this._asyncLinkingExt=void 0,void(this._asyncCompilation=-1);var t=this._asyncLinkingExt&&this.getAsyncLinkingStatus(),i=this.getShaderName().toLowerCase();if(t||!this._asyncLinkingExt||i&&(-1!==i.indexOf("packer")||-1!==i.indexOf("environment")||-1!==i.indexOf("hotspot")))return this.getLinkResult(this._gl),e.applyProgram(this._program),this._dirty=!1,this._asyncLinkingExt=void 0,void(this._asyncCompilation=-1);this._asyncCompilation=1}else e.applyProgram(this._program)},cacheUniformList:function(e,t){for(var i=this._uniformsCache,n=0,r=t.length;n<r;n++){var a=t[n],o=e.getUniformLocation(this._program,a);null!=o&&void 0===i[a]&&(i[a]=o)}},cacheAttributeList:function(e,t){for(var i=this._attributesCache,n=0,r=t.length;n<r;n++){var a=t[n],o=e.getAttribLocation(this._program,a);-1!==o&&void 0!==o&&void 0===i[a]&&(i[a]=o)}}})),"osg","Program"),m.registerErrorCallback=function(e){n=e};const _=m},WMIH:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("IpZ9"),a=i("W40i"),o=function(){r.Z.call(this),this.projection=a._E.create()};n.Z.createPrototypeNode(o,n.Z.objectInherit(r.Z.prototype,{getProjectionMatrix:function(){return this.projection},setProjectionMatrix:function(e){this.projection=e}}),"osg","Projection");const s=o},rsXr:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("WWMP"),a=function(e,t,i,n){r.Z.call(this),this._x=void 0!==e?e:-1,this._y=void 0!==t?t:-1,this._width=void 0!==i?i:-1,this._height=void 0!==n?n:-1};n.Z.createPrototypeStateAttribute(a,n.Z.objectInherit(r.Z.prototype,{attributeType:"Scissor",cloneType:function(){return new a},setScissor:function(e,t,i,n){this._x=e,this._y=t,this._width=i,this._height=n},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},apply:function(e){e.applyScissor(this)}}),"osg","Scissor");const o=a},"7itD":(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("u5PS"),r=i("GoyH"),a=i("6qT5"),o=i("/CZr"),s=function(e,t){o.Z.call(this);var i=e;"string"==typeof e&&(i=s[e]),this.type=i,this.setText(t)};s.VERTEX_SHADER=35633,s.FRAGMENT_SHADER=35632;s.VS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\nattribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);}\n",s.FS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\n precision lowp float; void main(void) { gl_FragColor = vec4(1.0, 0.6, 0.6, 1.0);}\n",s._sDeletedGLShaderCache=new window.Map,s.deleteGLShader=function(e,t){s._sDeletedGLShaderCache.has(e)||s._sDeletedGLShaderCache.set(e,[]),s._sDeletedGLShaderCache.get(e).push(t)},s.flushDeletedGLShaders=function(e,t){if(t<=0)return t;if(!s._sDeletedGLShaderCache.has(e))return t;for(var i=0,n=a.Z.instance().tick(),r=s._sDeletedGLShaderCache.get(e),o=r.length-1;o>=0&&i<t;o--)e.deleteShader(r[o]),r.splice(o,1),i=a.Z.instance().deltaS(n,a.Z.instance().tick());return t-i},s.flushAllDeletedGLShaders=function(e){if(s._sDeletedGLShaderCache.has(e))for(var t=s._sDeletedGLShaderCache.get(e),i=t.length-1;i>=0;i--)e.deleteShader(t[i]),t.splice(i,1)},s.onLostContext=function(e){s._sDeletedGLShaderCache.has(e)&&(s._sDeletedGLShaderCache.get(e).length=0)},r.Z.createPrototypeObject(s,r.Z.objectInherit(o.Z.prototype,{setText:function(e){this.text=e},getText:function(){return this.text},failSafe:function(e,t){this.shader=e.createShader(this.type);var i=t.match(/#define[\s]+SHADER_NAME[\s]+([\S]+)(\n|$)/);i=i?i[1]:"";var n=this.type===s.VERTEX_SHADER?s.VS_DBG:s.FS_DBG;n+="\n#define SHADER_NAME FailSafe"+i+"\n#else\n"+t+"\n#endif\n",e.shaderSource(this.shader,n),e.compileShader(this.shader)},processErrors:function(e,t){var i,r,a=/ERROR: [\d]+:([\d]+): (.+)/gim,o=t.split("\n"),s=o.length;if(0!==s)if(null===a.exec(e)&&(a=/Shader compilation errors\n\((\d+)\, \d+\): (.+)/gim),a.lastIndex=0,null!==a.exec(e))for(a.lastIndex=0;null!==(r=a.exec(e));){r.index===a.lastIndex&&a.lastIndex++;var A=parseInt(r[1],10);if(!(A>s)){n.Z.error("ERROR "+r[2]+" in line "+A);var g=Math.max(0,A-7),h=Math.max(0,A-2);for(i=g;i<=h;i++)n.Z.warn(o[i].replace(/^[ \t]+/g,""));for(h=Math.max(0,A-1),n.Z.error(o[h].replace(/^[ \t]+/g,"")),g=Math.min(s,A),h=Math.min(s,A+5),i=g;i<h;i++)n.Z.warn(o[i].replace(/^[ \t]+/g,""))}}else n.Z.error(e)},compile:function(e){this._gl||this.setGraphicContext(e),this.shader=e.createShader(this.type),e.shaderSource(this.shader,this.text),e.compileShader(this.shader)},getCompilationResult:function(e,t){if(e.isContextLost())return n.Z.error("can't compile shader, no context"),!1;if(!e.getShaderParameter(this.shader,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(this.shader);this.processErrors(i,this.text);for(var r=this.text.split("\n"),a="\n",o=0,s=r.length;o<s;++o)a+=o+" "+r[o]+"\n";return n.Z.errorFold("can't compile shader",a),t&&t(this.text,a,i),!1}return!0},releaseGLObjects:function(){void 0!==this._gl&&(s.deleteGLShader(this._gl,this.shader),o.Z.removeObject(this._gl,this)),this.invalidate()},invalidate:function(){this.shader=void 0}}),"osg","Shader");const A=s},UAvO:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=function(){this._globalDefault=void 0,this._lastApplied=void 0,this._changed=!1,this._values=[],this._back=void 0,this._length=0};n.prototype={getLength:function(){return this._length},push:function(e,t){var i;this._length===this._values.length?(i={object:e,value:t},this._values.push(i)):((i=this._values[this._length]).object=e,i.value=t),this._back=i,this._length++},pop:function(){if(this._length){var e=this._values;this._length--;var t=e[this._length];return this._back=this._length?e[this._length-1]:void 0,t}}};const r=n},bfff:(e,t,i)=>{"use strict";i.d(t,{Z:()=>B});var n=i("W40i"),r=i("u5PS"),a=i("iUVs"),o=i("5pih"),s=i("WWMP"),A=i("bDLW"),g=i("UAvO"),h=i("64xh"),c=i("GoyH"),l=i("BvLe"),u=i("uRnn"),d=i("f7MS"),I=i("nbbV"),C=function(){this._stateClearColor={buffer:{red:0,green:0,blue:0,alpha:0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0},this._stateClearDepth={buffer:{value:1},state:{value:void 0},changed:!0},this._stateDepthMask={state:{value:!0},buffer:{value:void 0},changed:!0},this._stateViewport={buffer:{x:0,y:0,width:640,height:480},state:{x:void 0,y:void 0,width:void 0,height:void 0},changed:!0},this._stateColorMask={buffer:{red:!0,green:!0,blue:!0,alpha:!0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0},this._stateScissor={buffer:{enable:!1,x:0,y:0,width:640,height:480},state:{enable:!1,x:void 0,y:void 0,width:void 0,height:void 0},changed:!0},this._stateDepth={buffer:{func:u.Z.LESS,enable:!1,near:0,far:1},state:{func:void 0,enable:!1,near:void 0,far:void 0},changed:!0},this._stateCullFace={buffer:{enable:!1,mode:I.Z.BACK},state:{enable:!1,mode:void 0},changed:!0},this._stateBlendFunc={buffer:{separate:!1,enable:!1,sourceFactor:d.Z.ONE,destinationFactor:d.Z.ZERO,sourceFactorAlpha:d.Z.ONE,destinationFactorAlpha:d.Z.ZERO},state:{separate:void 0,enable:!1,sourceFactor:void 0,destinationFactor:void 0,sourceFactorAlpha:void 0,destinationFactorAlpha:void 0},changed:!0}};C.prototype={clearColor:function(e){var t=this._stateClearColor,i=t.buffer,n=t.state;t.changed=!1,i.red=e[0],i.green=e[1],i.blue=e[2],i.alpha=e[3],n.red===e[0]&&n.green===e[1]&&n.blue===e[2]&&n.alpha===e[3]||(t.changed=!0)},applyClearColor:function(e){var t=this._stateClearColor,i=t.state,n=t.buffer;t.changed=!1,i.red=n.red,i.green=n.green,i.blue=n.blue,i.alpha=n.alpha,e.clearColor(i.red,i.green,i.blue,i.alpha)},clearDepth:function(e){var t=this._stateClearDepth,i=t.buffer,n=t.state;t.changed=!1,i.value=e,n.value!==e&&(t.changed=!0)},applyClearDepth:function(e){var t=this._stateClearDepth,i=t.buffer,n=t.state;t.changed=!1,n.value=i.value,e.clearDepth(n.value)},depthMask:function(e){var t=this._stateDepthMask,i=t.buffer,n=t.state;t.changed=!1,i.value=e,n.value!==e&&(t.changed=!0)},applyDepthMask:function(e){var t=this._stateDepthMask,i=t.buffer,n=t.state;t.changed=!1,n.value=i.value,e.depthMask(n.value)},applyViewportAttribute:function(e){this.viewport(e._x,e._y,e._width,e._height)},viewport:function(e,t,i,n){var r=this._stateViewport,a=r.buffer,o=r.state;r.changed=!1,a.x=e,a.y=t,a.width=i,a.height=n,o.x===e&&o.y===t&&o.width===i&&o.height===n||(r.changed=!0)},applyViewport:function(e){var t=this._stateViewport,i=t.buffer,n=t.state;t.changed=!1,n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,e.viewport(n.x,n.y,n.width,n.height)},applyColorMaskAttribute:function(e){var t=this._stateColorMask,i=t.buffer,n=t.state;t.changed=!1,i.red=e._red,i.green=e._green,i.blue=e._blue,i.alpha=e._alpha,n.red===e._red&&n.green===e._green&&n.blue===e._blue&&n.alpha===e._alpha||(t.changed=!0)},applyColorMask:function(e){var t=this._stateColorMask,i=t.buffer,n=t.state;t.changed=!1,n.red=i.red,n.green=i.green,n.blue=i.blue,n.alpha=i.alpha,e.colorMask(n.red,n.green,n.blue,n.alpha)},applyScissorAttribute:function(e){var t=-1!==e._x,i=this._stateScissor,n=i.buffer,r=i.state;i.changed=!1,n.enable=t,n.x=e._x,n.y=e._y,n.width=e._width,n.height=e._height,r.enable===t&&r.x===e._x&&r.y===e._y&&r.width===e._width&&r.height===e._height||(i.changed=!0)},applyScissor:function(e){var t=this._stateScissor,i=t.buffer,n=t.state;t.changed=!1,n.enable!==i.enable&&(n.enable=i.enable,n.enable?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST)),n.enable&&(n.x===i.x&&n.y===i.y&&n.width===i.width&&n.height===i.height||(n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,e.scissor(n.x,n.y,n.width,n.height)))},applyCullFaceAttribute:function(e){var t=this._stateCullFace,i=t.buffer,n=t.state,r=e._mode!==I.Z.DISABLE;t.changed=!1,i.enable=r,i.mode=e._mode,n.enable===r&&n.mode===e._mode||(t.changed=!0)},applyCullFace:function(e){var t=this._stateCullFace,i=t.buffer,n=t.state;t.changed=!1,n.enable!==i.enable&&(n.enable=i.enable,n.enable?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)),n.enable&&n.mode!==i.mode&&(n.mode=i.mode,e.cullFace(n.mode))},applyDepthAttribute:function(e){var t=e._func!==u.Z.DISABLE,i=this._stateDepth,n=i.buffer,r=i.state;i.changed=!1,n.enable=t,n.func=e._func,n.far=e._far,n.near=e._near,r.enable===t&&r.func===e._func&&r.near===e._near&&r.far===e._far||(i.changed=!0),this.depthMask(e._writeMask)},applyDepth:function(e){var t=this._stateDepth,i=t.buffer,n=t.state;t.changed=!1,n.enable!==i.enable&&(n.enable=i.enable,n.enable?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)),n.enable&&(n.func!==i.func&&(n.func=i.func,e.depthFunc(n.func)),n.near===i.near&&n.far===i.far||(n.far=i.far,n.near=i.near,e.depthRange(n.near,n.far)))},applyBlendFuncAttribute:function(e){var t=this._stateBlendFunc,i=t.buffer,n=t.state,r=e._sourceFactor!==d.Z.DISABLE&&e._destinationFactor!==d.Z.DISABLE;t.changed=!1,i.enable=r,i.separate=e._separate,i.sourceFactor=e._sourceFactor,i.destinationFactor=e._destinationFactor,i.sourceFactorAlpha=e._sourceFactorAlpha,i.destinationFactorAlpha=e._destinationFactorAlpha,n.enable===r&&n.sourceFactor===e._sourceFactor&&n.destinationFactor===e._destinationFactor&&n.sourceFactorAlpha===e._sourceFactorAlpha&&n.destinationFactorAlpha===e._destinationFactorAlpha||(t.changed=!0)},applyBlendFunc:function(e){var t=this._stateBlendFunc,i=t.buffer,n=t.state;t.changed=!1,n.enable!==i.enable&&(n.enable=i.enable,n.enable?e.enable(e.BLEND):e.disable(e.BLEND)),n.enable&&(n.separate=i.separate,n.separate?n.sourceFactor===i.sourceFactor&&n.destinationFactor===i.destinationFactor&&n.sourceFactorAlpha===i.sourceFactorAlpha&&n.destinationFactorAlpha===i.destinationFactorAlpha||(n.sourceFactor=i.sourceFactor,n.destinationFactor=i.destinationFactor,n.sourceFactorAlpha=i.sourceFactorAlpha,n.destinationFactorAlpha=i.destinationFactorAlpha,e.blendFuncSeparate(n.sourceFactor,n.destinationFactor,n.sourceFactorAlpha,n.destinationFactorAlpha)):n.sourceFactor===i.sourceFactor&&n.destinationFactor===i.destinationFactor||(n.sourceFactor=i.sourceFactor,n.destinationFactor=i.destinationFactor,e.blendFunc(n.sourceFactor,n.destinationFactor)))},applyClearStates:function(e){this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateScissor.changed&&this.applyScissor(e),this._stateClearColor.changed&&this.applyClearColor(e),this._stateClearDepth.changed&&this.applyClearDepth(e),this._stateColorMask.changed&&this.applyColorMask(e)},applyDrawStates:function(e){this._stateViewport.changed&&this.applyViewport(e),this._stateScissor.changed&&this.applyScissor(e),this._stateDepth.changed&&this.applyDepth(e),this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateCullFace.changed&&this.applyCullFace(e),this._stateBlendFunc.changed&&this.applyBlendFunc(e),this._stateColorMask.changed&&this.applyColorMask(e)},clear:function(e,t){this.applyClearStates(e),e.clear(t)},drawGeometry:function(e){this.applyDrawStates(e)}};const f=C;var p,m,_,E,v=[void 0,function(e,t){return e[0]===t[0]||(t[0]=e[0],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]||(t[0]=e[0],t[1]=e[1],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!1)}],S=function(e){a.Z.call(this),this._excludeUniforms={uProjectionMatrix:!0,uModelMatrix:!0,uViewMatrix:!0,uModelViewMatrix:!0,uModelNormalMatrix:!0,uModelViewNormalMatrix:!0,uArrayColorEnabled:!0},this._graphicContext=void 0,this._shaderGeneratorProxy=e,void 0===e&&console.break(),this._currentVAO=null,this._currentIndexVBO=null,this._stateSets=new A.Z,this._shaderGeneratorNames=new g.Z,this._uniforms={},this._textureAttributeArrayList=[],this._attributeArray=[],this._projectionMatrix=h.Z.createMatrix4(n._E.create(),"uProjectionMatrix"),this._modelMatrix=h.Z.createMatrix4(n._E.create(),"uModelMatrix"),this._viewMatrix=h.Z.createMatrix4(n._E.create(),"uViewMatrix"),this._modelViewMatrix=h.Z.createMatrix4(n._E.create(),"uModelViewMatrix"),this._modelNormalMatrix=h.Z.createMatrix3(n.wO.create(),"uModelNormalMatrix"),this._modelViewNormalMatrix=h.Z.createMatrix3(n.wO.create(),"uModelViewNormalMatrix");var t=new g.Z;t._globalDefault=h.Z.createFloat1(0,"uArrayColorEnabled"),this._uniforms.ArrayColorEnabled=t,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._frameStamp=void 0,this._programCommonUniformsCache={},this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0,this._program=void 0;var i=new o.Z;this.applyAttribute(i),this._programType=c.Z.getOrCreateStateAttributeTypeMemberIndex(i),this._programAttribute=this._attributeArray[this._programType],this._numPushStateSet=0,this._numApply=0,this._programUniformCache=[],this._cacheUniformId=0,this._stateCache=new f,this.resetStats()};c.Z.createPrototypeObject(S,c.Z.objectInherit(a.Z.prototype,{getExcludeUniforms:function(){return this._excludeUniforms},resetCaches:function(){this._currentVAO=null,this._currentIndexVBO=null,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._programCommonUniformsCache={}},applyColorMask:function(e){this._stateCache.applyColorMaskAttribute(e)},applyBlendFunc:function(e){this._stateCache.applyBlendFuncAttribute(e)},applyCullFace:function(e){this._stateCache.applyCullFaceAttribute(e)},applyDepth:function(e){this._stateCache.applyDepthAttribute(e)},applyViewport:function(e){this._stateCache.applyViewportAttribute(e)},applyScissor:function(e){this._stateCache.applyScissorAttribute(e)},viewport:function(e,t,i,n){this._stateCache.viewport(e,t,i,n)},depthMask:function(e){this._stateCache.depthMask(e)},clearDepth:function(e){this._stateCache.clearDepth(e)},clearColor:function(e){this._stateCache.clearColor(e)},clear:function(e){this._stateCache.clear(this._graphicContext,e)},drawGeometry:function(e){this._stateCache.drawGeometry(this._graphicContext,e)},getCacheUniformsApplyRenderLeaf:function(){return this._programCommonUniformsCache},setGraphicContext:function(e){this._graphicContext=e,this._extVAO=l.Z.instance(e).getWebGLExtension("OES_vertex_array_object")},getGraphicContext:function(){return this._graphicContext},getShaderGeneratorProxy:function(){return this._shaderGeneratorProxy},pushCheckOverride:function(e,t,i){var n=this._evaluateOverrideObjectOnStack(e,t,i);n!==t?e.push(n,e._back.value):e.push(t,i)},_evaluateOverrideObjectOnStack:function(e,t,i){var n=e._back;return 0===e._length?t:n.value&s.Z.OVERRIDE&&!(i&s.Z.PROTECTED)?n.object:t},pushStateSet:function(e){this._numPushStateSet++,this._stateSets.push(e),this.pushAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,i=e._activeTextureAttributeUnit,n=e._activeTextureAttribute,r=0,a=i.length;r<a;r++){var o=i[r],s=t[o],A=this.getOrCreateTextureAttributeArray(o);this.pushAttributeMap(A,s,n)}e.hasUniform()&&this.pushUniformsList(this._uniforms,e.getUniformList());var g=e.getShaderGeneratorPair();g&&this.pushCheckOverride(this._shaderGeneratorNames,g.getShaderGeneratorName(),g.getValue())},getStateSetStackSize:function(){return this._stateSets.getLength()},insertStateSet:(_=new A.Z,E=_.getArray(),function(e,t){_.reset();for(var i=this.getStateSetStackSize();i>e;)_.push(this._stateSets.back()),this.popStateSet(),i--;this.pushStateSet(t);for(var n=_._length-1;n>=0;n--)this.pushStateSet(E[n])}),removeStateSet:function(){var e=new A.Z,t=e.getArray();return function(i){var n=this.getStateSetStackSize();if(i>=n)r.Z.warn("Warning State:removeStateSet "+i+" out of range");else{for(e.reset();n-1>i;)e.push(this._stateSets.back()),this.popStateSet(),n--;this.popStateSet();for(var a=e._length-1;a>=0;a--)this.pushStateSet(t[a])}}}(),resetCacheFrame:function(){this._lastAppliedModelViewMatrix=this._lastAppliedProjectionMatrix=void 0},resetStats:function(){this._numApply=0,this._numPushStateSet=0},applyProgram:function(e){this._program!==e&&(this._program=e,this.getGraphicContext().useProgram(e))},applyModelViewMatrix:(m=n.wO.create(),function(e,t){if(this._lastAppliedModelViewMatrix===e)return!1;var i,r=this.getLastProgramApplied().getUniformsCache(),a=this._modelViewMatrix,o=r.uModelViewMatrix,s=this.getGraphicContext();if(o&&(a.setMatrix4(e),a.apply(s,o)),this._lastAppliedModelViewMatrix){for(var A=this._lastAppliedModelViewMatrix,g=0;g<11;g++)if(e[g]!==A[g]){i=!0;break}}else i=!0;return i&&(a=this._modelViewNormalMatrix,(o=r.uModelViewNormalMatrix)&&(n.wO.normalFromMat4(m,e),a.setMatrix3(m),a.apply(s,o)),(o=r.uModelNormalMatrix)&&(n.wO.normalFromMat4(m,t),a.setMatrix3(m),a.apply(s,o))),this._lastAppliedModelViewMatrix=e,!0}),applyProjectionMatrix:function(e){if(this._lastAppliedProjectionMatrix!==e){this._lastAppliedProjectionMatrix=e;var t=this.getLastProgramApplied(),i=this._projectionMatrix,n=t.getUniformsCache()[i.getName()];n&&(i.setMatrix4(e),i.apply(this.getGraphicContext(),n))}},getCurrentShaderGeneratorStateSet:function(e){var t=this._programAttribute,i=e._attributeArray[this._programType];if(!(0!==t._length&&t._back.value!==s.Z.OFF||i&&i.getValue()!==s.Z.OFF)){var n,r=e.getShaderGeneratorPair(),a=this._shaderGeneratorNames;if(r){var o=r.getValue(),A=r.getShaderGeneratorName();n=this._evaluateOverrideObjectOnStack(this._shaderGeneratorNames,A,o)}else a._length&&(n=a._back.object);var g=n;return this._shaderGeneratorProxy.getShaderGenerator(g)}},_applyAttributeMapStateSet:function(e,t){for(var i=0,n=e.length>t.length?e.length:t.length;i<n;i++){var r,a=i,o=a<e.length?e[a]:void 0,s=a<t.length?t[a]:void 0,A=!!o,g=A&&o._changed;if(s||g){var h=s?s.getAttribute():void 0;if(A)if(h){var c=s.getValue();(r=this._evaluateOverrideObjectOnStack(o,h,c))!==h?o._changed&&(this._applyAttributeStack(r,o),o._changed=!1):this._applyAttributeStack(r,o)&&(o._changed=!0)}else o._length?(o._changed=!1,this._applyAttributeStack(o._back.object,o)):(o._changed=!1,this._applyAttributeStack(o._globalDefault,o));else(o=this._createAttributeStack(e,a,h.cloneType()))._changed=!0,this._applyAttributeStack(h,o)}}},_applyTextureAttributeMapListStateSet:function(e,t){for(var i,n,r,a=0;a<16;a++){var o=a;i=o<e.length?e[o]:void 0;var s=o<t.length?t[o]:void 0;if(i||s){n=r=0,i?(r=i.length,s&&(n=s.length)):(i=this.getOrCreateTextureAttributeArray(o),n=s.length);for(var A=r>n?r:n,g=0;g<A;g++){var h,c=g,l=c<r?i[c]:void 0,u=s&&c<s.length?s[c]:void 0,d=!!l,I=d&&l._changed;if(u||I){var C=u?u.getAttribute():void 0;if(d)if(C){var f=u.getValue();(h=this._evaluateOverrideObjectOnStack(l,C,f))!==C?l._changed&&(this._applyTextureAttribute(o,h,l),l._changed=!1):this._applyTextureAttribute(o,h,l)&&(l._changed=!0)}else l._length?(l._changed=!1,this._applyTextureAttribute(o,l._back.object,l)):(l._changed=!1,this._applyTextureAttribute(o,l._globalDefault,l));else h=u.getAttribute(),(l=this._createAttributeStack(i,c,h.cloneType()))._changed=!0,this._applyTextureAttribute(o,h,l)}}}}},applyStateSet:function(e){this._numApply++;var t,i=this.getLastProgramApplied();if(this._currentShaderGenerator=this.getCurrentShaderGeneratorStateSet(e),this._applyAttributeMapStateSet(this._attributeArray,e._attributeArray),this._applyTextureAttributeMapListStateSet(this._textureAttributeArrayList,e._textureAttributeArrayList),this._currentShaderGenerator){var n=this._currentShaderGenerator.getOrCreateProgram(this);this.applyAttribute(n),t=n,this._applyGeneratedProgramUniforms(n,e)}else t=this.getLastProgramApplied(),this._applyCustomProgramUniforms(t,e);i!==t&&(this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0)},popAllStateSets:function(){for(;this._stateSets._length;)this.popStateSet()},popStateSet:function(){if(this._stateSets._length){var e=this._stateSets.pop();this.popAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,i=e._activeTextureAttributeUnit,n=e._activeTextureAttribute,r=0,a=i.length;r<a;r++){var o=i[r],s=t[o],A=this._textureAttributeArrayList[o];this.popAttributeMap(A,s,n)}e.hasUniform()&&this.popUniformsList(this._uniforms,e.getUniformList()),e.getShaderGeneratorPair()&&this._shaderGeneratorNames.pop()}},_createAttributeStack:function(e,t,i){c.Z.arrayDense(t,e);var n=new g.Z;return n._globalDefault=i,e[t]=n,n},haveAppliedAttribute:function(e){if(e){var t=this._attributeArray,i=c.Z.getOrCreateStateAttributeTypeMemberIndex(e),n=i<t.length?t[i]:void 0;n||(n=this._createAttributeStack(t,i,e.cloneType())),n._lastApplied=e,n._changed=!0}},applyAttribute:function(e){var t=c.Z.getOrCreateStateAttributeTypeMemberIndex(e),i=this._attributeArray,n=t<i.length?i[t]:void 0;n||(n=this._createAttributeStack(i,t,e.cloneType())),n._changed=!0,this._applyAttributeStack(e,n)},_applyAttributeStack:function(e,t){return t._lastApplied!==e&&(e.apply&&e.apply(this),t._lastApplied=e,!0)},_applyTextureAttribute:function(e,t,i){if(i._lastApplied===t)return!1;if(i._lastApplied=t,!t.apply)return!0;var n=this.getGraphicContext();return n.activeTexture(n.TEXTURE0+e),t.apply(this,e),!0},applyTextureAttribute:function(e,t){var i=c.Z.getOrCreateTextureStateAttributeTypeMemberIndex(t),n=this.getOrCreateTextureAttributeArray(e),r=n[i];r||(r=this._createAttributeStack(n,i,t.cloneType())),r._changed=!0,this._applyTextureAttribute(e,t,r)},getLastProgramApplied:function(){return this._programAttribute._lastApplied},applyDefault:function(){this.popAllStateSets(),this._currentShaderGenerator=void 0,this.applyAttributeMap(this._attributeArray),this.applyTextureAttributeMapList(this._textureAttributeArrayList)},applyAttributeMap:function(e){for(var t,i=0,n=e.length;i<n;i++){var r;if(t=e[i])r=t._length?t._back.object:t._globalDefault,t._changed&&(t._lastApplied!==r&&(r.apply&&r.apply(this),t._lastApplied=r),t._changed=!1)}},pushUniformsList:function(e,t){var i,n;for(var r in t){var a=t[r];e[i=(n=a.getUniform()).getName()]||this._createAttributeStack(e,i,n),this.pushCheckOverride(e[i],n,a.getValue())}},popUniformsList:function(e,t){for(var i in t)e[i].pop()},applyTextureAttributeMapList:function(e){for(var t,i=this._graphicContext,n=0,r=e.length;n<r;n++)if(t=e[n])for(var a=0,o=t.length;a<o;a++){var s,A=t[a];if(A)s=A._length?A._back.object:A._globalDefault,A._changed&&(A._lastApplied!==s&&(i.activeTexture(i.TEXTURE0+n),s.apply(this,n),A._lastApplied=s),A._changed=!1)}},setGlobalDefaultAttribute:function(e){var t=c.Z.getOrCreateStateAttributeTypeMemberIndex(e);t>=this._attributeArray.length||!this._attributeArray[t]?this._createAttributeStack(this._attributeArray,t,e):this._attributeArray[t]._globalDefault=e},getGlobalDefaultAttribute:function(e){var t=this._attributeArray,i=c.Z.getIdFromTypeMember(e);if(!(void 0===i||i>=t.length))return t[i]?t[i]._globalDefault:void 0},setGlobalDefaultTextureAttribute:function(e,t){var i=this.getOrCreateTextureAttributeArray(e),n=c.Z.getOrCreateTextureStateAttributeTypeMemberIndex(t);n>=i.length||!i[n]?this._createAttributeStack(i,n,t):i[n]._globalDefault=t},getGlobalDefaultTextureAttribute:function(e,t){var i=this.getOrCreateTextureAttributeArray(e),n=c.Z.getTextureIdFromTypeMember(t);if(!(void 0===n||n>=i.length))return i[n]?i[n]._globalDefault:void 0},getOrCreateTextureAttributeArray:function(e){return c.Z.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]),this._textureAttributeArrayList[e]},pushAttributeMap:function(e,t,i){for(var n,r=t.length,a=e.length,o=0,s=i.length;o<s;o++){var A=i[o],g=A<r?t[A]:void 0,h=g.getAttribute();(n=A<a?e[A]:void 0)||(n=this._createAttributeStack(e,A,h.cloneType())),this.pushCheckOverride(n,h,g.getValue()),n._changed=!0}},popAttributeMap:function(e,t,i){for(var n=0,r=i.length;n<r;n++){var a=e[i[n]];a.pop(),a._changed=!0}},setIndexArray:function(e){var t=this._graphicContext;this._currentIndexVBO!==e&&(e.bind(t),this._currentIndexVBO=e),e.isDirty()&&e.compile(t)},lazyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,i=e.length;t<i;t++){var n=e[t];this._vertexAttribMap[n]&&(this._vertexAttribMap._disable[n]=!0)}},enableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]||(t.setFloat(1),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!0)}},disableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]&&(t.setFloat(0),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!1)}},applyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,i=e.length;t<i;t++)if(!0===this._vertexAttribMap._disable[e[t]]){var n=e[t];this._graphicContext.disableVertexAttribArray(n),this._vertexAttribMap._disable[n]=!1,this._vertexAttribMap[n]=!1}},clearVertexAttribCache:function(){for(var e=this._vertexAttribMap,t=e._keys,i=0,n=t.length;i<n;i++){var r=t[i];e[r]=void 0,e._disable[r]=!1}this._vertexAttribMap._disable.length=0,this._vertexAttribMap._keys.length=0},setVertexArrayObject:function(e){return this._currentVAO!==e&&(this._currentVAO=e,e?e.bind(this._graphicContext):(this._graphicContext.bindVertexArray(null),this.clearVertexAttribCache()),this._currentIndexVBO=void 0,!0)},setVertexAttribArray:function(e,t){var i=this._vertexAttribMap;i._disable[e]=!1;var n=this._graphicContext,r=!1;t.isDirty()&&(t.bind(n),t.compile(n),r=!0);var a=i[e];a!==t&&(r||t.bind(n),a||(n.enableVertexAttribArray(e),void 0===a&&i._keys.push(e)),i[e]=t,n.vertexAttribPointer(e,t.getGlItemSize(),t.getGlType(),t.getGlNormalize(),0,0))},_getActiveUniformsFromProgramAttributes:function(e,t){var i=this._attributeArray,n=e.getTrackAttributes().attributeKeys;if(n.length>0)for(var r=0,a=n.length;r<a;r++){var o=n[r],s=i[this.typeMember[o]];if(s){var A=s._globalDefault;if(A.getOrCreateUniforms){var g=A.getOrCreateUniforms();for(var h in g)t.push(g[h])}}}},_getActiveUniformsFromProgramTextureAttributes:function(e,t){var i=e.getTrackAttributes().textureAttributeKeys;if(i)for(var n=0,r=i.length;n<r;n++){var a=i[n];if(a){var o=this._textureAttributeArrayList[n];if(o)for(var s=0,A=a.length;s<A;s++){var g=o[a[s]];if(g){var h=g._globalDefault;if(h.getOrCreateUniforms){var c=h.getOrCreateUniforms();for(var l in c)t.push(c[l])}}}}}},_cacheUniformsForCustomProgram:function(e,t){this._getActiveUniformsFromProgramAttributes(e,t),this._getActiveUniformsFromProgramTextureAttributes(e,t);for(var i=this._graphicContext,n={},r=0,a=t.length;r<a;r++){var o=t[r],s=o.getName(),A=i.getUniformLocation(e._program,s);null!=A&&(n[s]=o)}e.trackUniforms=n},_applyCustomProgramUniforms:(p=[],function(e,t){p.length=0,void 0!==e.getTrackAttributes()&&void 0===e.trackUniforms&&this._cacheUniformsForCustomProgram(e,p);var i,n,r=e.getUniformsCache(),a=this._uniforms;for(var o in e.trackUniforms&&(i=e.trackUniforms),r){var s=r[o],A=a[o],g=t&&t.uniforms[o];if(A||g)if(g){var h=t.uniforms[o],c=h.getValue(),l=h.getUniform();n=A?this._evaluateOverrideObjectOnStack(A,l,c):l}else n=A._length?A._back.object:A._globalDefault;else{if(void 0===i){this._checkErrorUniform(o);continue}n=i[o]}n.apply(this._graphicContext,s)}}),_checkErrorUniform:function(e){var t=e.substr(7);this._textureAttributeArrayList[t]&&e==="Texture"+t||this._excludeUniforms[e]||(this._excludeUniforms[e]=1,r.Z.error("Uniform not in the scene hierarchy : "+e))},_computeForeignUniforms:function(e,t){var i=[];for(var n in e){void 0!==e[n]&&void 0===t[n]&&(this._excludeUniforms[n]||i.push(n))}return i},_removeUniformsNotRequiredByProgram:function(e,t){for(var i in e){var n=t[i];null==n&&delete e[i]}},_cacheUniformsForGeneratedProgram:function(e){var t=e.getUniformsCache(),i=e.getActiveUniforms(),n=this._computeForeignUniforms(t,i);e.setForeignUniforms(n),this._removeUniformsNotRequiredByProgram(i,t)},_copyUniformEntry:function(e){var t,i=e.getInternalArray();return i.length<16&&(t=new i.constructor(i.length)),t},_initUniformCache:function(e){var t,i,n,r,a,o=e.getActiveUniforms(),s=e.getForeignUniforms(),A=this._uniforms,g=[],h=[];if(e._cacheUniformId=this._cacheUniformId++,this._programUniformCache[e._cacheUniformId]={},s.length)for(n=g,t=0,i=s.length;t<i;t++){var c=A[s[t]];c&&(a=c._globalDefault,r=this._copyUniformEntry(a),n.push(r))}for(var l in o)a=o[l],r=this._copyUniformEntry(a),h.push(r);this._programUniformCache[e._cacheUniformId].foreign=g,this._programUniformCache[e._cacheUniformId].active=h},_checkCacheAndApplyUniform:function(e,t,i,n,r){var a,o=e.getInternalArray(),s=o.length;if(s<=4){var A=t[i];a=v[s](o,A)}else a=!1;if(!a){var g=n[r];e.apply(this._graphicContext,g)}},_applyGeneratedProgramUniforms:function(e,t){var i,n,r,a,o=this._uniforms,s=e.getForeignUniforms();if(!s){if(this._cacheUniformsForGeneratedProgram(e),s=e.getForeignUniforms(),t){var A=t.uniforms;for(a=0;a<s.length;a++)o[n=s[a]]||A[n]&&(i=A[n].getUniform(),this._createAttributeStack(o,n,i))}this._initUniformCache(e)}var g=e.getUniformsCache(),h=e.getActiveUniforms(),c=this._programUniformCache[e._cacheUniformId].active,l=this._programUniformCache[e._cacheUniformId].foreign,u=0;for(var d in h)i=h[d],this._checkCacheAndApplyUniform(i,c,u,g,d),u++;u=0;var I=s.length;for(a=0;a<I;a++){r=o[n=s[a]];var C=t&&t.uniforms[n];if(C||r){if(C){var f=t.uniforms[n],p=f.getValue(),m=f.getUniform();i=this._evaluateOverrideObjectOnStack(r,m,p)}else r._length?i=r._back.object:(i=r._globalDefault,this._checkErrorUniform(n));this._checkCacheAndApplyUniform(i,l,u,g,n),u++}else this._checkErrorUniform(n)}},_setStateSetsDrawID:function(e){for(var t=this._stateSets.getArray(),i=0,n=this._stateSets.length;i<n;i++)t[i].setDrawID(e)},_stateSetStackChanged:function(e,t){var i=this._stateSets.getArray(),n=this._stateSets.length;if(t!==n)return!0;for(var r=0;r<n;r++)if(e!==i[r].getDrawID())return!0;return!1}}),"osg","State");const B=S},WWMP:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("iUVs"),a=function(){r.Z.call(this)};n.Z.createPrototypeStateAttribute(a,n.Z.objectInherit(r.Z.prototype,{_attributeTypeIndex:void 0,getType:function(){return this.attributeType},getTypeMember:function(){return this.attributeType},apply:function(){},getHash:function(){return this.getType()}}),"osg","StateAttribute"),a.OFF=0,a.ON=1,a.OVERRIDE=2,a.PROTECTED=4,a.INHERIT=8,a.OVERRIDE_ON=a.OVERRIDE|a.ON;const o=a},nRYw:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n,r,a=i("GoyH"),o=i("bDLW"),s=i("gjC8"),A=i("cyFB"),g=function(){this._depth=0,this._children=new s.Z,this._leafs=new o.Z,this._stateset=void 0,this._parent=void 0};g.pooledStateGraph=new A.Z((function(){return new g})),g.statsNbMoveStateGraph=0,g.reset=function(){g.pooledStateGraph.reset(),g.statsNbMoveStateGraph=0},a.Z.createPrototypeObject(g,{clean:function(){this._leafs.reset(),this._children.reset(),this._depth=0,this._stateset=void 0,this._parent=void 0},getStateSet:function(){return this._stateset},getLeafs:function(){return this._leafs},getParent:function(){return this._parent},findOrInsert:function(e){var t=e.getInstanceID(),i=this._children.getMap()[t];return i||((i=g.pooledStateGraph.getOrCreateObject()).clean(),i._parent=this,i._depth=this._depth+1,i._stateset=e,this._children.set(t,i)),i}},"osg","StateGraph"),g.moveStateGraph=(n=new o.Z,r=n.getArray(),function(e,t,i){g.statsNbMoveStateGraph++,n.reset();var a,o,s=i,A=t;if(s!==A&&void 0!==s)if(void 0!==A){if(A._parent===s._parent)return void 0!==A._stateset&&e.popStateSet(),void(void 0!==s._stateset&&e.pushStateSet(s._stateset));for(;A._depth>s._depth;)void 0!==A._stateset&&e.popStateSet(),A=A._parent;for(n.reset();s._depth>A._depth;)void 0!==s._stateset&&n.push(s._stateset),s=s._parent;for(;A!==s;)void 0!==A._stateset&&e.popStateSet(),A=A._parent,void 0!==s._stateset&&n.push(s._stateset),s=s._parent;for(a=n._length-1,o=0;a>=o;--a)e.pushStateSet(r[a])}else{do{void 0!==s._stateset&&n.push(s._stateset),s=s._parent}while(s);for(a=n._length-1,o=0;a>=o;--a)e.pushStateSet(r[a])}});const h=g},o4nZ:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("iUVs"),r=i("WWMP"),a=i("GoyH"),o=function(){n.Z.call(this),this._parents=[],this._attributeArray=[],this._textureAttributeArrayList=[],this._activeTextureAttributeUnit=[],this._activeAttribute=[],this._activeTextureAttribute=[],this._binName=void 0,this._binNumber=0,this._shaderGeneratorPair=null,this._updateCallbackList=[],this.uniforms={},this._hasUniform=!1,this._drawID=-1};(o.AttributePair=function(e,t){this._object=e,this._value=t}).prototype={getShaderGeneratorName:function(){return this._object},getAttribute:function(){return this._object},getUniform:function(){return this._object},getValue:function(){return this._value}},a.Z.createPrototypeObject(o,a.Z.objectInherit(n.Z.prototype,{setDrawID:function(e){this._drawID=e},getDrawID:function(){return this._drawID},getAttributePair:function(e,t){return new o.AttributePair(e,t)},addUniform:function(e,t){var i=void 0!==t?t:r.Z.ON,n=e.getName();this.uniforms[n]=this.getAttributePair(e,i),this._hasUniform=!0},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeUniform:function(e){this.removeUniformByName(e.getName())},removeUniformByName:function(e){delete this.uniforms[e],this._hasUniform=!!window.Object.keys(this.uniforms).length},hasUniform:function(){return this._hasUniform},getUniform:function(e){var t=this.uniforms;if(t[e])return t[e].getAttribute()},getUniformList:function(){return this.uniforms},setTextureAttributeAndModes:function(e,t,i){this._setTextureAttribute(e,this.getAttributePair(t,void 0!==i?i:r.Z.ON))},getNumTextureAttributeLists:function(){return this._textureAttributeArrayList.length},getTextureAttribute:function(e,t){var i=a.Z.getTextureIdFromTypeMember(t);if(void 0!==i&&this._hasTextureAttribute(e,i)){var n=this._textureAttributeArrayList[e];return n[i]?n[i].getAttribute():void 0}},removeTextureAttribute:function(e,t){var i=a.Z.getTextureIdFromTypeMember(t);void 0!==i&&this._hasTextureAttribute(e,i)&&(this._textureAttributeArrayList[e][i]=void 0,this._computeValidTextureUnit())},getAttribute:function(e){var t=a.Z.getIdFromTypeMember(e);if(void 0!==t&&this._hasAttribute(t))return this._attributeArray[t].getAttribute()},setAttributeAndModes:function(e,t){this._setAttribute(this.getAttributePair(e,void 0!==t?t:r.Z.ON))},setAttribute:function(e,t){this.setAttributeAndModes(e,t)},removeAttribute:function(e){var t=a.Z.getIdFromTypeMember(e);this._hasAttribute(t)&&(this._attributeArray[t]=void 0,this._computeValidAttribute())},setRenderingHint:function(e){"OPAQUE_BIN"===e?this.setRenderBinDetails(0,"RenderBin"):"TRANSPARENT_BIN"===e?this.setRenderBinDetails(10,"DepthSortedBin"):this.setRenderBinDetails(0,"")},getUpdateCallbackList:function(){return this._updateCallbackList},removeUpdateCallback:function(e){var t=this._updateCallbackList.indexOf(e);if(-1!==t&&(this._updateCallbackList.splice(t,1),0===this._updateCallbackList.length))for(var i=this._parents,n=0,r=i.length;n<r;n++){var a=i[n];a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal()-1)}},requiresUpdateTraversal:function(){return!!this._updateCallbackList.length},addUpdateCallback:function(e){var t=Boolean(this._updateCallbackList.length);if(this._updateCallbackList.push(e),!t)for(var i=this._parents,n=0,r=i.length;n<r;n++){var a=i[n];a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal()+1)}},hasUpdateCallback:function(e){return-1!==this._updateCallbackList.indexOf(e)},setRenderBinDetails:function(e,t){this._binNumber=e,this._binName=t},getAttributeMap:function(){for(var e={},t=0,i=this._attributeArray.length;t<i;t++){var n=this._attributeArray[t];if(n)e[n.getAttribute().getTypeMember()]=n}return e},getBinNumber:function(){return this._binNumber},getBinName:function(){return this._binName},setBinNumber:function(e){this._binNumber=e},setBinName:function(e){this._binName=e},getAttributeList:function(){for(var e=this._attributeArray,t=[],i=0,n=e.length;i<n;i++)e[i]&&t.push(e[i]);return t},setShaderGeneratorName:function(e,t){this._shaderGeneratorPair=this.getAttributePair(e,void 0!==t?t:r.Z.ON)},getShaderGeneratorPair:function(){return this._shaderGeneratorPair},getShaderGeneratorName:function(){return this._shaderGeneratorPair?this._shaderGeneratorPair.getShaderGeneratorName():void 0},releaseGLObjects:function(){for(var e=0,t=this._textureAttributeArrayList.length;e<t;e++){var i=this.getTextureAttribute(e,"Texture");i&&i.releaseGLObjects()}for(var n=this.getAttributeList(),r=0,a=n.length;r<a;r++)n[r]._object.releaseGLObjects&&n[r]._object.releaseGLObjects()},_setTextureAttribute:function(e,t){a.Z.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]);var i=a.Z.getOrCreateTextureStateAttributeTypeMemberIndex(t.getAttribute());a.Z.arrayDense(i,this._textureAttributeArrayList[e]),this._textureAttributeArrayList[e][i]=t,this._computeValidTextureUnit()},_computeValidTextureUnit:function(){this._activeTextureAttributeUnit.length=0,this._activeTextureAttribute.length=0;for(var e=this._textureAttributeArrayList,t=0,i=e.length;t<i;t++){var n=e[t];if(n&&n.length){for(var r=!1,a=0,o=n.length;a<o;a++)n[a]&&(r=!0,-1===this._activeTextureAttribute.indexOf(a)&&this._activeTextureAttribute.push(a));r&&this._activeTextureAttributeUnit.push(t)}}},_computeValidAttribute:function(){this._activeAttribute.length=0;for(var e=this._attributeArray,t=0,i=e.length;t<i;t++)e[t]&&this._activeAttribute.push(t)},_setAttribute:function(e){var t=a.Z.getOrCreateStateAttributeTypeMemberIndex(e.getAttribute());a.Z.arrayDense(t,this._attributeArray),this._attributeArray[t]=e,this._computeValidAttribute()},_hasAttribute:function(e){return!(e>=this._attributeArray.length)&&!!this._attributeArray[e]},_hasTextureAttribute:function(e,t){return!(e>=this._textureAttributeArrayList.length||!this._textureAttributeArrayList[e])&&(!(t>=this._textureAttributeArrayList[e].length)&&!!this._textureAttributeArrayList[e][t])}}),"osg","StateSet");const s=o},YVjV:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("IpZ9"),a=i("CJNH"),o=function(){r.Z.call(this),this._values=[]};n.Z.createPrototypeNode(o,n.Z.objectInherit(r.Z.prototype,{addChild:function(e,t){return r.Z.prototype.addChild.call(this,e),void 0===t&&(t=!0),this.children.length>this._values.length?this._values.push(t):this._values[this.children.length-1]=t,!0},setValue:function(e,t){e<this._values.length&&(this._values[e]=t)},getValue:function(e){if(e<this._values.length)return this._values[e]},setAllChildrenOff:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!1},setAllChildrenOn:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!0},traverse:function(e){switch(e.traversalMode){case a.Z.TRAVERSE_ALL_CHILDREN:for(var t=0;t<this.children.length;++t)this.children[t].accept(e);break;case a.Z.TRAVERSE_ACTIVE_CHILDREN:var i=this.children.length;for(this._values.length<i&&(i=this._values.length),t=0;t<i;++t)!0===this._values[t]&&this.children[t].accept(e)}}}),"osg","Switch");const s=o},"5rJd":(e,t,i)=>{"use strict";i.d(t,{Z:()=>M});var n=i("u5PS"),r=i("GoyH"),a=i("WWMP"),o=i("64xh"),s=i("/CZr"),A=i("6qT5"),g=function(e,t,i,n){this._target=e,this._internalFormat=t,this._width=i,this._height=n,this._size=0,this.computeSize()};g.prototype={match:function(e){return e._target===this._target&&e._internalFormat===this._internalFormat&&e._width===this._width&&e._height===this._height},computeSize:function(){var e=i("5rJd").Z,t=0;switch(this._internalFormat){case 1:case e.ALPHA:case e.LUMINANCE:t=8;break;case e.LUMINANCE_ALPHA:case 2:t=16;break;case e.RGB:case 3:t=24;break;case e.RGBA:case 4:t=32}var n=Math.ceil(this._width*this._height*t)/8;this._target===e.TEXTURE_CUBE_MAP&&(n*=6),n+=n/3,this._size=n},getSize:function(){return this._size}},g.getHash=function(){var e=Array.prototype.slice.call(arguments),t="";return e.forEach((function(e){t+=e})),t};var h=function(e,t,i){this._texture=e,this._id=t,this._textureSet=i};h.prototype={target:function(){return this._textureSet._profile._target},id:function(){return this._id},getTextureSet:function(){return this._textureSet},reset:function(){this._textureObject=null,this._texture=void 0},bind:function(e){e.bindTexture(this.target(),this._id)}};var c=function(e){this._profile=e,this._usedTextureObjects=[],this._orphanedTextureObjects=[]};c.prototype={getProfile:function(){return this._profile},getUsedTextureObjects:function(){return this._usedTextureObjects},getOrphanedTextureObjects:function(){return this._orphanedTextureObjects},takeOrGenerate:function(e,t){var i;if(this._orphanedTextureObjects.length>0)return(i=this.takeFromOrphans())._texture=t,this._usedTextureObjects.push(i),i;var n=e.createTexture();return i=new h(t,n,this),this._usedTextureObjects.push(i),i},takeFromOrphans:function(){if(this._orphanedTextureObjects.length)return this._orphanedTextureObjects.pop()},orphan:function(e){var t=this._usedTextureObjects.indexOf(e);-1!==t&&(this._orphanedTextureObjects.push(this._usedTextureObjects[t]),this._usedTextureObjects.splice(t,1))},flushDeletedTextureObjects:function(e,t){if(t<=0)return t;var i,n=this._orphanedTextureObjects.length,r=0,a=A.Z.instance().tick();for(i=0;i<n&&r<t;i++)e.deleteTexture(this._orphanedTextureObjects[i].id()),this._orphanedTextureObjects[i].reset(),r=A.Z.instance().deltaS(a,A.Z.instance().tick());return this._orphanedTextureObjects.splice(0,i),t-r},flushAllDeletedTextureObjects:function(e){for(var t=this._orphanedTextureObjects.length,i=this.getProfile().getSize(),r=0,a=t;r<a;++r)e.deleteTexture(this._orphanedTextureObjects[r].id()),this._orphanedTextureObjects[r].reset();this._orphanedTextureObjects.length=0,n.Z.info("TextureManager: released "+t+" with "+t*i/1048576+" MB")},onLostContext:function(){var e,t;for(t=this._orphanedTextureObjects.length,e=0;e<t;++e)this._orphanedTextureObjects[e].reset();for(this._orphanedTextureObjects.length=0,t=this._usedTextureObjects.length,e=0;e<t;++e)this._usedTextureObjects[e].reset();this._usedTextureObjects.length=0}};var l=function(){this._textureSetMap={}};l.prototype={generateTextureObject:function(e,t,i,n,r,a){var o=g.getHash(i,n,r,a);return void 0===this._textureSetMap[o]&&(this._textureSetMap[o]=new c(new g(i,n,r,a))),this._textureSetMap[o].takeOrGenerate(e,t)},updateStats:function(e){var t=0,i=0;for(var n in this._textureSetMap){var r=this._textureSetMap[n].getProfile().getSize();t+=this._textureSetMap[n].getUsedTextureObjects().length*r,i+=this._textureSetMap[n].getOrphanedTextureObjects().length*r}var a=1048576;e.getCounter("textureused").set(t/a),e.getCounter("texturereserved").set(i/a),e.getCounter("texturetotal").set((t+i)/a)},reportStats:function(){var e=0;for(var t in this._textureSetMap){var i=this._textureSetMap[t].getProfile(),r=i.getSize()/1048576,a=this._textureSetMap[t].getUsedTextureObjects().length;e+=r*=a,n.Z.notice(String(r)+" MB with "+a+" texture of "+i._width+"x"+i._height+" "+i._internalFormat)}n.Z.notice(String(e)+" MB in total")},flushAllDeletedTextureObjects:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].flushAllDeletedTextureObjects(e)},onLostContext:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].onLostContext(e)},flushDeletedTextureObjects:function(e,t){var i=t;for(var n in this._textureSetMap)if((i=this._textureSetMap[n].flushDeletedTextureObjects(e,i))<=0)break;return i},releaseTextureObject:function(e){e&&e.getTextureSet().orphan(e)}};const u=l;var d=i("BvLe");function I(e,t,i){var n=e.createShader(t);return delete e.shaderSource,e.shaderSource(n,i),delete e.compileShader,e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.log("ERROR TP: "+e.getShaderInfoLog(n)),null)}var C=null;function f(e){if(C)return C;C={};var t=0;e.createVertexArray&&(t=e.createVertexArray(),e.bindVertexArray(t));var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,-1,1,1,-1,1]),e.STATIC_DRAW);var n=e.createProgram(),r=I(e,e.VERTEX_SHADER,"attribute vec2 aVertex;\nvarying highp vec2 vTextureCoord;\n\nvoid main(void) {\n\tgl_Position = vec4(aVertex,0.0,1.0);\n\tvTextureCoord = aVertex*0.5+0.5;\n}\n"),a=I(e,e.FRAGMENT_SHADER,"varying highp vec2 vTextureCoord;precision highp int;uniform sampler2D uT;uniform highp ivec2 uS;uniform bool uY;uniform int uO;int f(int i,int u){int y=i/u;return i-y*u;}int i(int i,int t){if(i<t)return i;return t;}int u(int i,int u){if(i<u)return u;return i;}int f(int y,int t,int f){int x=i(y,t),n=u(y,t);if(f<x)return f*(f+1)/2;if(f<n)return x*(x+1)/2+x*(f-x);int r=f-n;return x*(x+1)/2+x*(n-x)+(x-1)*r-(r-1)*r/2;}int i(int y,int t,ivec2 x){int r=i(y,t),n=u(y,t),v=x.x+x.y;bool h=f(v,2)==0;if(v<r){if(h)return f(y,t,v)+v-x.y;return f(y,t,v)+x.y;}if(v<n){int s=t-x.y-1;if(y<t)s=r-(y-x.x);if(h)return f(y,t,v)+s;return f(y,t,v)+r-s-1;}int s=t-x.y-1,e=r+n-v-1;if(h)return f(y,t,v)+s;return f(y,t,v)+e-s-1;}ivec2 u(int y,int t,int x){int v=i(y,t),r=u(y,t);if(x<v*(v+1)/2){int n=(-1+int(1e-6+sqrt(float(8*x+1))))/2,h=x-f(y,t,n);bool s=f(n,2)==0;if(s)return ivec2(h,n-h);return ivec2(n-h,h);}if(x<v*(v+1)/2+v*(r-v)){x=x-v*(v+1)/2;int n=v+x/v,s=f(x,v);bool h=f(n,2)==0;int g=n-v+s+1,e=v-s-1,S=n-s,T=s;if(y>t){if(h)return ivec2(g,e);return ivec2(S,T);}if(h)return ivec2(T,S);return ivec2(e,g);}int n=v*(v-1)/2-(x-(v*(v+1)/2+v*(r-v)))-1,s=(-1+int(sqrt(float(8*n+1))))/2;n=r+v-s-2;int h=x-f(y,t,n);bool g=f(n,2)==0;int e=v+r-n-1;if(g)h=e-h-1;int S=n+h-y+1;return ivec2(n-S,S);}int f(ivec2 v){int y=uS.x/8,t=uS.y/8,x=i(y,t,ivec2(v.x/8,v.y/8)),n=f(x,4);v.x=f(v.x,8);v.y=f(v.y,8);ivec2 r=v;if(n==1)r.x=7-v.x;if(n==2)r.x=v.y,r.y=v.x;if(n==3)r.x=7-v.y,r.y=v.x;return x*64+r.x+r.y*8;}ivec2 i(int i){int x=uS.x,t=uS.y,v=x*t;if(i<0)i+=v;i=f(i,v);int y=x/8,n=t/8,h=i/64,r=i-h*64,s=r/8,S=r-s*8,e=f(h,4);ivec2 g=u(y,n,h),T=g*8;if(e==0)T.x+=S,T.y+=s;if(e==1)T.x+=7-S,T.y+=s;if(e==2)T.x+=s,T.y+=S;if(e==3)T.x+=s,T.y+=7-S;return T;}int t(ivec2 y,int i){int v=uS.x*uS.y,n=f(y)+i;if(n>v)n-=v;if(n<0)n+=v;if(n>v)return-1;if(n<0)return-2;return n;}void main(){ivec2 y=ivec2(gl_FragCoord);if(uY)y.y=uS.y-y.y-1;if(uO==-1){gl_FragColor=texture2D(uT,vec2(y)/vec2(uS));return;}int n=t(y,uO);if(n>=0)y=i(n),gl_FragColor=texture2D(uT,(vec2(y)+.5)/vec2(uS));else gl_FragColor=vec4(1.,0.,0.,1.);}");if(e.attachShader(n,r),e.attachShader(n,a),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))return null;e.useProgram(n);var o={attribLocations:{vertex:e.getAttribLocation(n,"aVertex")},uniformLocations:{uSampler:e.getUniformLocation(n,"uT"),uSize:e.getUniformLocation(n,"uS"),uOffset:e.getUniformLocation(n,"uO"),uYFlipped:e.getUniformLocation(n,"uY")}};if(t){var s=e.FLOAT;e.vertexAttribPointer(o.attribLocations.vertex,2,s,!1,0,0),e.enableVertexAttribArray(o.attribLocations.vertex)}var A=e.createFramebuffer();return C.prepare=function(r,a,s,A,g){if(e.useProgram(n),e.uniform1i(o.uniformLocations.uOffset,A?-1:r),g||(g=e.TEXTURE0),e.uniform1i(o.uniformLocations.uSampler,g-e.TEXTURE0),e.uniform1i(o.uniformLocations.uYFlipped,s),e.activeTexture(g),e.bindTexture(e.TEXTURE_2D,a),t)e.bindVertexArray(t);else{var h=e.FLOAT;e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(o.attribLocations.vertex,2,h,!1,0,0),e.enableVertexAttribArray(o.attribLocations.vertex)}e.disable(e.BLEND),e.disable(e.DEPTH_TEST),e.disable(e.SCISSOR_TEST),e.depthMask(!1),e.colorMask(!0,!0,!0,!0)},C.renderInto=function(t,i,n){e.uniform2i(o.uniformLocations.uSize,i,n),e.bindFramebuffer(e.FRAMEBUFFER,A),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.viewport(0,0,i,n),e.drawArrays(e.TRIANGLES,0,6)},C}const p=function(e,t,i,n,r,a){var o=e.getParameter(e.ARRAY_BUFFER_BINDING),s=e.getParameter(e.CURRENT_PROGRAM),A=e.getParameter(e.FRAMEBUFFER_BINDING),g=e.isEnabled(e.BLEND),h=e.isEnabled(e.DEPTH_TEST),c=e.getParameter(e.VIEWPORT),l=e.isEnabled(e.SCISSOR_TEST),u=l?e.getParameter(e.SCISSOR_BOX):void 0,d=e.getParameter(e.ACTIVE_TEXTURE),I=0;e.bindVertexArray&&(I=e.getParameter(e.VERTEX_ARRAY_BINDING));var C=e.getParameter(e.DEPTH_WRITEMASK),p=e.getParameter(e.COLOR_WRITEMASK),m=i[5],_=m.width,E=m.height;e.bindTexture(i[0],r),e.texImage2D(i[0],i[1],e.RGBA,_,E,0,e.RGBA,e.UNSIGNED_BYTE,null);var v=e.createTexture();e.bindTexture(e.TEXTURE_2D,v),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n?e.compressedTexImage2D.apply(e,i):e.texImage2D.apply(e,i);var S=f(e);t*=64,t%=_*E,S.prepare(-t,v,a,!1,d),S.renderInto(r,_,E),e.deleteTexture(v),e.bindFramebuffer(e.FRAMEBUFFER,A),e.bindBuffer(e.ARRAY_BUFFER,o),e.useProgram(s),c&&e.viewport(c[0],c[1],c[2],c[3]),l&&(e.enable(e.SCISSOR_TEST),e.scissor(u[0],u[1],u[2],u[3])),g&&e.enable(e.BLEND),h&&e.enable(e.DEPTH_TEST),I?e.bindVertexArray(I):e.bindVertexArray(null),e.depthMask(C),e.colorMask(p[0],p[1],p[2],p[3]),e.activeTexture(d),e.bindTexture(i[0],r)};var m=i("uHj6"),_=window.ImageBitmap||function(){},E=function(e){return 0!==e&&(e&1+~e)===e},v=function(){a.Z.call(this),s.Z.call(this),this.setDefaultParameters(),this._dirty=!0,this._dirtyMipmap=!0,this._applyTexImage2DCallbacks=[],this._textureObject=void 0,this._textureNull=!0},S=function(e,t){var i=v[e];return void 0===i?(n.Z.warn("bad Texture enum argument "+e+"\nfallback to "+t),t):i};v.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,v.UNPACK_FLIP_Y_WEBGL=37440,v.BROWSER_DEFAULT_WEBGL=37444,v.NONE=0,v.DEPTH_COMPONENT=6402,v.DEPTH_COMPONENT16=33189,v.DEPTH_STENCIL=34041,v.DEPTH24_STENCIL8=35056,v.DEPTH_COMPONENT24=33190,v.DEPTH_COMPONENT32F=36012,v.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,v.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,v.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,v.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,v.COMPRESSED_RGB_ATC_WEBGL=35986,v.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987,v.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798,v.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840,v.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841,v.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842,v.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843,v.COMPRESSED_RGB_ETC1_WEBGL=36196,v.LINEAR=9729,v.NEAREST=9728,v.NEAREST_MIPMAP_NEAREST=9984,v.LINEAR_MIPMAP_NEAREST=9985,v.NEAREST_MIPMAP_LINEAR=9986,v.LINEAR_MIPMAP_LINEAR=9987,v.TEXTURE_MAX_ANISOTROPY_EXT=34046,v.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047,v.CLAMP_TO_EDGE=33071,v.REPEAT=10497,v.MIRRORED_REPEAT=33648,v.TEXTURE_2D=3553,v.TEXTURE_CUBE_MAP=34067,v.TEXTURE_BINDING_CUBE_MAP=34068,v.TEXTURE_CUBE_MAP_POSITIVE_X=34069,v.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,v.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,v.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,v.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,v.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,v.MAX_CUBE_MAP_TEXTURE_SIZE=34076,v.UNSIGNED_BYTE=5121,v.UNSIGNED_SHORT=5123,v.UNSIGNED_SHORT_4_4_4_4=32819,v.UNSIGNED_SHORT_5_5_5_1=32820,v.UNSIGNED_SHORT_5_6_5=33635,v.FLOAT=5126,v.HALF_FLOAT_OES=36193,v.HALF_FLOAT=5131,v.UNSIGNED_INT_10F_11F_11F_REV=35899,v.UNSIGNED_INT_24_8=34042,v.ALPHA=6406,v.RGB=6407,v.RGBA=6408,v.LUMINANCE=6409,v.LUMINANCE_ALPHA=6410,v.RED_INTEGER=36244,v.RGB_INTEGER=36248,v.RGBA_INTEGER=36249,v.RG_INTEGER=33320,v.RED=6403,v.R8=33321,v.R8UI=33330,v.RG8=33323,v.RG8UI=33336,v.RGB8=36758,v.RGB565=36194,v.RGB9_E5=35901,v.RGB8UI=36221,v.RGBA8=32856,v.RGB5_A1=32855,v.RGBA4=32854,v.RGBA8UI=36220,v.SRGB8_ALPHA8=35907,v.SRGB8=35905,v.R16F=33325,v.RG16F=33327,v.RGB16F=34843,v.RGBA16F=34842,v.R11F_G11F_B10F=35898,v.R32F=33326,v.RG32F=33328,v.RGB32F=34837,v.RGBA32F=34836;var B,w=((B={})[v.R8]=v.LUMINANCE,B[v.R8UI]=v.LUMINANCE,B[v.R16F]=v.LUMINANCE,B[v.R32F]=v.LUMINANCE,B[v.SRGB8]=v.LUMINANCE,B[v.RG8]=v.RGB,B[v.RG8UI]=v.RGB,B[v.RG16F]=v.RGB,B[v.RG32F]=v.RGB,B[v.RGB8]=v.RGB,B[v.RGB565]=v.RGB,B[v.RGB9_E5]=v.RGB,B[v.RGB8UI]=v.RGB,B[v.RGB5_A1]=v.RGB,B[v.RGB16F]=v.RGB,B[v.RGB32F]=v.RGB,B[v.RGBA8]=v.RGBA,B[v.R11F_G11F_B10F]=v.RGBA,B[v.RGBA16F]=v.RGBA,B[v.RGBA32F]=v.RGBA,B[v.SRGB8_ALPHA8]=v.RGBA,B),y=function(){var e={},t={},i={},n={},r={},a={};return e[v.FLOAT]=t,e[v.HALF_FLOAT]=e[v.HALF_FLOAT_OES]=i,e[v.UNSIGNED_SHORT]=n,e[v.UNSIGNED_INT]=r,e[v.UNSIGNED_INT_24_8]=a,i[v.LUMINANCE]=v.R16F,i[v.RGB]=v.RGB16F,i[v.RGBA]=v.RGBA16F,t[v.LUMINANCE]=v.R32F,t[v.RGB]=v.RGB32F,t[v.RGBA]=v.RGBA32F,n[v.DEPTH_COMPONENT]=v.DEPTH_COMPONENT16,r[v.DEPTH_COMPONENT]=v.DEPTH_COMPONENT32F,a[v.DEPTH_STENCIL]=v.DEPTH24_STENCIL8,e}();v._sTextureManager=new window.Map,v.getTextureManager=function(e){return v._sTextureManager.has(e)||v._sTextureManager.set(e,new u),v._sTextureManager.get(e)},v.getEnumFromString=function(e){var t=e;return"string"==typeof t&&(t=S(t,e)),t},r.Z.createPrototypeStateAttribute(v,r.Z.objectInherit(s.Z.prototype,r.Z.objectInherit(a.Z.prototype,{attributeType:"Texture",cloneType:function(){return new v},invalidate:function(){this._textureObject=void 0,this.dirty()},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},isTextureNull:function(){return this._textureNull},getOrCreateUniforms:function(e){if(void 0===v.uniforms&&(v.uniforms=[]),void 0===v.uniforms[e]){var t=this.getType()+e;v.uniforms[e]={texture:o.Z.createInt1(e,t)}}return v.uniforms[e]},setDefaultParameters:function(){this._image=void 0,this._magFilter=v.LINEAR,this._minFilter=v.LINEAR,this._maxAnisotropy=1,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._textureWidth=0,this._textureHeight=0,this._unrefImageDataAfterApply=!1,this._internalFormat=void 0,this._dirtyMipmap=!0,this._textureTarget=v.TEXTURE_2D,this.setInternalFormatType(v.UNSIGNED_BYTE),this._isCompressed=!1,this._flipY=!0,this._colorSpaceConversion=v.NONE},setColorSpaceConversion:function(e){this._colorSpaceConversion=e},setFlipY:function(e){this._flipY=e},getTextureTarget:function(){return this._textureTarget},getTextureObject:function(){return this._textureObject},setTextureSize:function(e,t){var i=d.Z.instance().getWebGLParameter("MAX_TEXTURE_SIZE");e===this._textureWidth&&t===this._textureHeight||this.dirty(),void 0!==e&&(e>i?(n.Z.error("width ("+e+') too big for GPU. Max Texture Size is "'+i+'"'),this._textureWidth=i):this._textureWidth=e),void 0!==t&&(t>i?(n.Z.error("height ("+t+') too big for GPU. Max Texture Size is "'+i+'"'),this._textureHeight=i):this._textureHeight=t),this._textureNull=!1},init:function(e){this._gl||this.setGraphicContext(e.getGraphicContext()),this._textureObject||(this._textureObject=v.getTextureManager(this._gl).generateTextureObject(this._gl,this,this._textureTarget,this._internalFormat,this._textureWidth,this._textureHeight),this.dirty(),this._dirtyTextureObject=!1,this._textureNull=!1)},addApplyTexImage2DCallback:function(e){this._applyTexImage2DCallbacks.indexOf(e)<0&&this._applyTexImage2DCallbacks.push(e)},removeApplyTexImage2DCallback:function(e){var t=this._applyTexImage2DCallbacks.indexOf(e);t>=0&&this._applyTexImage2DCallbacks.splice(t,1)},getWidth:function(){return this._textureWidth},getHeight:function(){return this._textureHeight},releaseGLObjects:function(){void 0!==this._textureObject&&null!==this._textureObject&&void 0!==this._gl&&(v.getTextureManager(this._gl).releaseTextureObject(this._textureObject),s.Z.removeObject(this._gl,this)),this.invalidate()},getWrapT:function(){return this._wrapT},getWrapS:function(){return this._wrapS},setWrapS:function(e){this._wrapS="string"==typeof e?S(e,v.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},setWrapT:function(e){this._wrapT="string"==typeof e?S(e,v.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},dirtyTextureParameters:function(){this.dirty(),this.dirtyMipmap(),this.dirtyTextureObject()},dirtyTextureObject:function(){this._dirtyTextureObject=!0,this.dirtyMipmap(),this.dirty()},getMinFilter:function(){return this._minFilter},getMagFilter:function(){return this._magFilter},setMaxAnisotropy:function(e){this._maxAnisotropy=e,this.dirtyTextureParameters()},getMaxAnisotropy:function(){return this._maxAnisotropy},setMinFilter:function(e){this._minFilter="string"==typeof e?S(e,v.LINEAR):e,this.dirtyTextureParameters()},setMagFilter:function(e){this._magFilter="string"==typeof e?S(e,v.LINEAR):e,this.dirtyTextureParameters()},setImage:function(e,t){var i=e;(e instanceof window.Image||e instanceof HTMLCanvasElement||e instanceof _||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Float32Array)&&(i=new m.Z(e)),this._image=i,this.setImageFormat(t),i&&(i.getWidth&&i.getHeight?this.setTextureSize(i.getWidth(),i.getHeight()):i.width&&i.height&&this.setTextureSize(i.width,i.height)),this._textureNull=!1,this.dirty()},getImage:function(){return this._image},setImageFormat:function(e){var t=e;t?("string"==typeof t&&(t=v[t]),this._imageFormat=t):this._imageFormat=v.RGBA},setInternalFormatType:function(e){this._type="string"==typeof e?v[e]:e},getInternalFormatType:function(){return this._type},setUnrefImageDataAfterApply:function(e){this._unrefImageDataAfterApply=e},checkIsCompressed:function(e){switch(e||this._internalFormat){case v.COMPRESSED_RGB_S3TC_DXT1_EXT:case v.COMPRESSED_RGBA_S3TC_DXT1_EXT:case v.COMPRESSED_RGBA_S3TC_DXT3_EXT:case v.COMPRESSED_RGBA_S3TC_DXT5_EXT:case v.COMPRESSED_RGB_ATC_WEBGL:case v.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:case v.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:case v.COMPRESSED_RGB_PVRTC_4BPPV1_IMG:case v.COMPRESSED_RGB_PVRTC_2BPPV1_IMG:case v.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:case v.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:case v.COMPRESSED_RGB_ETC1_WEBGL:return!0;default:return!1}},setInternalFormat:function(e){var t=e;t?("string"==typeof t&&(t=v[t]),this._isCompressed=this.checkIsCompressed(t)):(this._isCompressed=!1,t=v.RGBA),this._internalFormat=t},getInternalFormat:function(){return this._internalFormat},isDirtyMipmap:function(){return this._dirtyMipmap},dirtyMipmap:function(){this._dirtyMipmap=!0},applyFilterParameter:function(e,t){if(E(this._textureWidth)&&E(this._textureHeight)||(this._wrapT=v.CLAMP_TO_EDGE,this._wrapS=v.CLAMP_TO_EDGE,this._minFilter!==v.LINEAR_MIPMAP_LINEAR&&this._minFilter!==v.LINEAR_MIPMAP_NEAREST||(this._minFilter=v.LINEAR)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,this._magFilter),e.texParameteri(t,e.TEXTURE_MIN_FILTER,this._minFilter),this._maxAnisotropy>1&&v.ANISOTROPIC_SUPPORT_EXT){var i=this._maxAnisotropy<v.ANISOTROPIC_SUPPORT_MAX?this._maxAnisotropy:v.ANISOTROPIC_SUPPORT_MAX;e.texParameterf(t,v.TEXTURE_MAX_ANISOTROPY_EXT,i)}e.texParameteri(t,e.TEXTURE_WRAP_S,this._wrapS),e.texParameteri(t,e.TEXTURE_WRAP_T,this._wrapT)},generateMipmap:function(e,t){if(this._dirtyMipmap=!1,this.hasMipmapFilter()){var i=this._image;if(i&&i.hasMipmap())for(var n=this._getInternalFormatGL(),r=i.getMipmap(),a=1,o=r.length;a<o;a++){var s=r[a];this._isCompressed?this.applyTexImage2D(e,this._textureTarget,a,n,s.getWidth(),s.getHeight(),0,s.getImage()):this.applyTexImage2D(e,this._textureTarget,a,n,s.getWidth(),s.getHeight(),0,this._internalFormat,this._type,s.getImage())}else e.generateMipmap(t)}},hasMipmapFilter:function(){return this._minFilter===v.NEAREST_MIPMAP_NEAREST||this._minFilter===v.LINEAR_MIPMAP_NEAREST||this._minFilter===v.NEAREST_MIPMAP_LINEAR||this._minFilter===v.LINEAR_MIPMAP_LINEAR},applyTexImage2D:function(e){var t=Array.prototype.slice.call(arguments,1),i=0;if(this._textureObject._texture._textureTarget===e.TEXTURE_2D&&7===t.length&&(i=t.pop()),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._colorSpaceConversion),i){var n=this._textureObject._id;p(e,i,t,this._isCompressed,n,this._flipY)}else e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,this._flipY),this._isCompressed?e.compressedTexImage2D.apply(e,t):e.texImage2D.apply(e,t);var r=this._applyTexImage2DCallbacks.length;if(r>0)for(var a=0,o=r;a<o;a++)this._applyTexImage2DCallbacks[a].call(this)},computeTextureFormat:function(){this._internalFormat||(this._internalFormat=this._imageFormat||v.RGBA),this._imageFormat=this._internalFormat},applyImage:function(e){var t=this._getInternalFormatGL(),i=this._image||null,n=i&&i.getImage(),r=this._getTypeGL();this._isCompressed?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,n):!n||i.isTypedArray()?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,this._internalFormat,r,n):this.applyTexImage2D(e,this._textureTarget,0,t,this._internalFormat,r,n,i.pk),i&&i.setDirty(!1)},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this._dirtyTextureObject=!1,this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{var i=this._image;if(void 0!==i)if(i.isReady()){this.computeTextureFormat();var n=i.getWidth()||this._textureWidth,r=i.getHeight()||this._textureHeight;this.setTextureSize(n,r),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._unrefImageDataAfterApply&&(this._image=void 0),this._dirty=!1}else t.bindTexture(this._textureTarget,null);else 0!==this._textureHeight&&0!==this._textureWidth&&(this.computeTextureFormat(),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._dirty=!1)}else this._textureObject.bind(t),void 0!==this._image&&this._image.isDirty()&&(this.applyImage(t),this.dirtyMipmap()),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget)},_getInternalFormatGL:function(){var e=this._internalFormat;if(!d.Z.instance().isWebGL2())return w[e]||e;var t=y[this._type];return t&&t[e]||e},_getTypeGL:function(){return this._type!==v.HALF_FLOAT||d.Z.instance().isWebGL2()?this._type:v.HALF_FLOAT_OES}})),"osg","Texture"),v.textureNull=new v,v.createFromImage=function(e,t){var i=new v;return i.setImage(e,t),i},v.createFromCanvas=function(e,t){return v.createFromImage(e,t)};const M=v},"6qT5":(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=function(){var e=window||global;if(void 0===e.performance)return function(){return Date.now()};var t=e.performance.now||e.performance.mozNow||e.performance.msNow||e.performance.oNow||e.performance.webkitNow||function(){return Date.now()};return function(){return t.apply(e.performance,arguments)}}(),r=function(){};r.instance=function(){return r._instance||(r._instance=new r),r._instance},r.tick=n,r.prototype={deltaS:function(e,t){return(t-e)/1e3},deltaM:function(e,t){return t-e},tick:function(){return n()}};const a=r},cnke:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("u5PS"),r=i("BvLe"),a=function(e){this._enabled=!1,this.reset(e)};a.FRAME_COUNT=0,a.instance=function(e,t){return a._instance?e&&(a._instance.getContext()!==e||t)&&(a._instance.setContext(e),a._instance.reset(e)):a._instance=new a(e),a._instance},a.prototype={reset:function(e){if(e){var t=r.Z.instance(e).getDisjointTimerQuery();if(!t)return this;if(e.getQueryParameter||(e.getQueryParameter=t.getQueryObjectEXT.bind(t)),this._hasTimeElapsed=e.getQuery(t.TIME_ELAPSED_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,this._hasTimeStamp=e.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,!this._hasTimeElapsed&&!this._hasTimeStamp)return this;this._hasTimeStamp||n.Z.debug("Warning: do not use interleaved GPU query"),this._ext=t,this._gl=e,this._enabled=!0}this._frameAverageCount=10,this._glQueries=[],this._queriesByID={},this._userQueries=[],this._queryCount=0,this._nbOpened=0},getContext:function(){return this._gl},setContext:function(e){this._gl=e},setFrameAverageCount:function(e){this._frameAverageCount=e},clearQueries:function(){for(var e=this._glQueries,t=0,i=e.length;t<i;++t){var n=e[t];this._gl.deleteQuery(n._pollingStartQuery),n._pollingEndQuery&&this._gl.deleteQuery(n)}this._userQueries.length=0,this._glQueries.length=0,this._queriesByID={}},supportTimeStamp:function(){return this._hasTimeStamp},enable:function(){this._enabled=!!this._ext},disable:function(){this._enabled=!1},isEnabled:function(){return this._enabled},setCallback:function(e){this._callback=e},createUserQuery:function(e){var t;return(t=this._hasTimeStamp?this.createGLQuery():{_startIndex:0,_endIndex:0})._id=e,t._frame=a.FRAME_COUNT,t._isOpened=!0,t._siblings=[],t},createGLQuery:function(){var e={_isWaiting:!1,_pollingStartQuery:void 0,_pollingEndQuery:void 0,_averageTimer:0,_resultCount:0};return this._hasTimeStamp&&(e._pollingEndQuery=this._gl.createQuery()),e._pollingStartQuery=this._gl.createQuery(),this._glQueries.push(e),e},getOrCreateLastGLQuery:function(){var e=this._glQueries[this._queryCount-1];return e||(e=this._glQueries[this._queryCount-1]=this.createGLQuery())},beginCurrentQuery:function(){if(0!==this._nbOpened){this._queryCount++;var e=this.getOrCreateLastGLQuery();e._isWaiting||this._gl.beginQuery(this._ext.TIME_ELAPSED_EXT,e._pollingStartQuery)}},endCurrentQuery:function(){0!==this._nbOpened&&(this.getOrCreateLastGLQuery()._isWaiting||this._gl.endQuery(this._ext.TIME_ELAPSED_EXT))},getAvailableQueryByID:function(e){var t=this._queriesByID[e];if(!t)return t=this._queriesByID[e]=this.createUserQuery(e),this._userQueries.push(t),t;if(t._frame===a.FRAME_COUNT){if(t._isOpened)return t;for(var i=t._siblings,n=0,r=i.length;n<r;++n){var o=i[n];if(o._frame!==a.FRAME_COUNT||o._isOpened)return o._frame=a.FRAME_COUNT,o}var s=this.createUserQuery();return i.push(s),s}return t._frame=a.FRAME_COUNT,t},start:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!0,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingStartQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),this._nbOpened++,t._startIndex=this._queryCount,this.beginCurrentQuery())}},end:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!1,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingEndQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),t._endIndex=this._queryCount,this._nbOpened--,this.beginCurrentQuery())}},computeQueryAverageTime:function(e){for(var t=0,i=this._glQueries,n=e._startIndex;n<e._endIndex;++n){var r=i[n]._averageTimer;if(r<0)return-1;t+=r}return t},computeFullAverageTime:function(e){var t=this.computeQueryAverageTime(e);if(t<0)return-1;for(var i=e._siblings,n=0,r=i.length;n<r;++n){var o=i[n];if(o._frame===a.FRAME_COUNT-1){var s=this.computeQueryAverageTime(o);if(s<0)return-1;t+=s}}return t},pollQueries:function(){if(a.FRAME_COUNT++,this._queryCount=0,this._nbOpened=0,this._enabled&&this._callback){var e,t=this._glQueries,i=t.length;if(this._gl.getParameter(this._ext.GPU_DISJOINT_EXT))for(e=0;e<i;++e)t[e]._isWaiting=!1;else{for(e=0;e<i;++e)this.pollQuery(t[e]);var n=this._userQueries,r=n.length;for(e=0;e<r;++e){var o=n[e],s=this.computeFullAverageTime(o);s>0&&this._callback(s,o._id)}}}},pollQuery:function(e){e._isWaiting=!1;var t,i=this._hasTimeStamp?e._pollingEndQuery:e._pollingStartQuery;if(!this._gl.getQueryParameter(i,this._gl.QUERY_RESULT_AVAILABLE))return e._isWaiting=!0,0;if(this._hasTimeStamp){var n=this._gl.getQueryParameter(e._pollingStartQuery,this._gl.QUERY_RESULT);t=this._gl.getQueryParameter(i,this._gl.QUERY_RESULT)-n}else t=this._gl.getQueryParameter(i,this._gl.QUERY_RESULT);return e._resultCount++,e._resultCount>this._frameAverageCount&&(e._averageTimer=0,e._resultCount=1),e._averageTimer=e._averageTimer+(t-e._averageTimer)/e._resultCount,e._averageTimer}};const o=a},"6RPJ":(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,r=i("GoyH"),a=i("IpZ9"),o=i("W40i"),s=i("pSxj"),A=function(){a.Z.call(this),this.referenceFrame=s.Z.RELATIVE_RF};r.Z.createPrototypeNode(A,r.Z.objectInherit(a.Z.prototype,{setReferenceFrame:function(e){this.referenceFrame=e},getReferenceFrame:function(){return this.referenceFrame},computeBoundingSphere:(n=o._E.create(),function(e){return a.Z.prototype.computeBoundingSphere.call(this,e),e.valid()?(o._E.identity(n),this.computeLocalToWorldMatrix(n),e.transformMat4(e,n),e):e})}),"osg","Transform");const g=A},"64xh":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("u5PS"),r=function(e){this._data=void 0,this._transpose=!1,this._glCall="",this._cache=void 0,this._name=e,this._type=void 0,this._isMatrix=!1};r.isUniform=function(e){return"object"==typeof e&&window.Object.getPrototypeOf(e)===r.prototype},(r.prototype={getName:function(){return this._name},getType:function(){return this._type},apply:function(e,t){this._cache||(this._cache=e[this._glCall]),this._isMatrix?this._cache.call(e,t,this._transpose,this._data):this._cache.call(e,t,this._data)},setInternalArray:function(e){n.Z.warn("setInternalArray deprecated, please use getInternalArray instead: "+e.length),this._data=e},getInternalArray:function(){return this._data},setFloat:function(e){this._data[0]=e},setFloat1:function(e){this._data[0]=e[0]},setFloat2:function(e){this._data[0]=e[0],this._data[1]=e[1]},setFloat3:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2]},setFloat4:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3]},setFloat9:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8]},setFloat16:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8],this._data[9]=e[9],this._data[10]=e[10],this._data[11]=e[11],this._data[12]=e[12],this._data[13]=e[13],this._data[14]=e[14],this._data[15]=e[15]}}).setVec2=r.prototype.setFloat2,r.prototype.setVec3=r.prototype.setFloat3,r.prototype.setVec4=r.prototype.setFloat4,r.prototype.setMatrix4=r.prototype.setFloat16,r.prototype.setMatrix3=r.prototype.setFloat9,r.prototype.setInt=r.prototype.setFloat,r.prototype.setInt1=r.prototype.setFloat1,r.prototype.setInt2=r.prototype.setFloat2,r.prototype.setInt3=r.prototype.setFloat3,r.prototype.setInt4=r.prototype.setFloat4;var a=function(e,t,i,n,a,o){var s=t&&t.length?e:void 0,A=new r(void 0!==s?t:e);if(A._data=i,void 0!==s)if(s.length)for(var g=0,h=s.length;g<h;++g)A._data[g]=s[g];else A._data[0]=s;return A._glCall=n,A._type=a,A._isMatrix=!!o,A},o=function(e,t,i){return i&&!i.length?i:"string"!=typeof t?(t.length||1)/e:1};r.createFloat1=function(e,t){return a(e,t,new Float32Array(1*o(1,e,t)),"uniform1fv","float")},r.createFloat2=function(e,t){return a(e,t,new Float32Array(2*o(2,e,t)),"uniform2fv","vec2")},r.createFloat3=function(e,t){return a(e,t,new Float32Array(3*o(3,e,t)),"uniform3fv","vec3")},r.createFloat4=function(e,t){return a(e,t,new Float32Array(4*o(4,e,t)),"uniform4fv","vec4")},r.createInt1=function(e,t){return a(e,t,new Int32Array(1*o(1,e,t)),"uniform1iv","int")},r.createInt2=function(e,t){return a(e,t,new Int32Array(2*o(2,e,t)),"uniform2iv","vec2i")},r.createInt3=function(e,t){return a(e,t,new Int32Array(3*o(3,e,t)),"uniform3iv","vec3i")},r.createInt4=function(e,t){return a(e,t,new Int32Array(4*o(4,e,t)),"uniform4iv","vec4i")},r.createMatrix2=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(4*e),i=0;i<t.length;i+=4)t[i]=t[i+3]=1;return t}(o(4,e,t)),"uniformMatrix2fv","mat2",!0)},r.createMatrix3=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(9*e),i=0;i<t.length;i+=9)t[i]=t[i+4]=t[i+8]=1;return t}(o(9,e,t)),"uniformMatrix3fv","mat3",!0)},r.createMatrix4=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(16*e),i=0;i<t.length;i+=16)t[i]=t[i+5]=t[i+10]=t[i+15]=1;return t}(o(16,e,t)),"uniformMatrix4fv","mat4",!0)},r.float=r.createFloatArray=r.createFloat=r.createFloat1,r.vec2=r.createFloat2Array=r.createFloat2,r.vec3=r.createFloat3Array=r.createFloat3,r.vec4=r.createFloat4Array=r.createFloat4,r.int=r.createIntArray=r.createInt=r.createInt1,r.vec2i=r.createInt2Array=r.createInt2,r.vec3i=r.createInt3Array=r.createInt3,r.vec4i=r.createInt4Array=r.createInt4,r.mat2=r.createMat2Array=r.createMat2=r.createMatrix2,r.mat3=r.createMat3Array=r.createMat3=r.createMatrix3,r.mat4=r.createMat4Array=r.createMat4=r.createMatrix4;const s=r},Qp64:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i("GoyH"),r=i("CJNH"),a=function(){r.Z.call(this),this.visitorType=r.Z.UPDATE_VISITOR,this._numUpdateCallback=0};n.Z.createPrototypeObject(a,n.Z.objectInherit(r.Z.prototype,{resetStats:function(){this._numUpdateCallback=0},apply:function(e){var t=e.getStateSet();if(t&&t.requiresUpdateTraversal()){var i=t.getUpdateCallbackList(),n=i.length;if(n){this._numUpdateCallback+=n;for(var r=0,a=n;r<a;r++)i[r].update(t,this)}}for(var o=e.getUpdateCallbackList(),s=o.length,A=0;A<s;A++)if(this._numUpdateCallback++,!o[A].update(e,this))return;e.getNumChildrenRequiringUpdateTraversal()>0&&this.traverse(e)}}),"osg","NodeVisitor");const o=a},ojCs:(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("GoyH"),r=i("iUVs"),a=i("/CZr"),o=i("6qT5"),s=function(){a.Z.call(this),this._instanceID=r.Z.getInstanceID(),this._vaoObject=void 0,this.dirty()};s._sDeletedGLVertexArrayObjectCache=new window.Map,s.deleteGLVertexArrayObject=function(e,t){s._sDeletedGLVertexArrayObjectCache.has(e)||s._sDeletedGLVertexArrayObjectCache.set(e,[]),s._sDeletedGLVertexArrayObjectCache.get(e).push(t)},s.flushDeletedGLVertexArrayObjects=function(e,t){if(t<=0)return t;if(!s._sDeletedGLVertexArrayObjectCache.has(e))return t;for(var i=0,n=o.Z.instance().tick(),r=s._sDeletedGLVertexArrayObjectCache.get(e),a=r.length-1;a>=0&&i<t;a--)e.deleteVertexArray(r[a]),r.splice(a,1),i=o.Z.instance().deltaS(n,o.Z.instance().tick());return t-i},s.flushAllDeletedGLVertexArrayObjects=function(e){if(s._sDeletedGLVertexArrayObjectCache.has(e))for(var t=s._sDeletedGLVertexArrayObjectCache.get(e),i=t.length-1;i>=0;i--)e.deleteVertexArray(t[i]),t.splice(i,1)},s.onLostContext=function(e){s._sDeletedGLVertexArrayObjectCache.has(e)&&(s._sDeletedGLVertexArrayObjectCache.get(e).length=0)},n.Z.createPrototypeObject(s,n.Z.objectInherit(a.Z.prototype,{getInstanceID:function(){return this._instanceID},invalidate:function(){this._vaoObject=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._vaoObject&&void 0!==this._gl&&(s.deleteGLVertexArrayObject(this._gl,this._vaoObject),a.Z.removeObject(this._gl,this)),this.invalidate()},create:function(e){this._vaoObject=e.createVertexArray(),this._dirty=!1},bind:function(e){this._gl||this.setGraphicContext(e),this._vaoObject&&e.bindVertexArray(this._vaoObject)},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty}}),"osg","VertexArrayObject");const A=s},Yy1w:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n,r,a,o=i("GoyH"),s=i("WWMP"),A=i("W40i"),g=function(e,t,i,n){s.Z.call(this),this._x=void 0!==e?e:0,this._y=void 0!==t?t:0,this._width=void 0!==i?i:800,this._height=void 0!==n?n:600};o.Z.createPrototypeStateAttribute(g,o.Z.objectInherit(s.Z.prototype,{attributeType:"Viewport",cloneType:function(){return new g},setViewport:function(e,t,i,n){this._x=e,this._y=t,this._width=i,this._height=n},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},computeWindowMatrix:(n=A._E.create(),r=A._E.create(),a=A.R3.create(),function(e){A._E.fromTranslation(n,A.R3.ONE),A._E.fromScaling(r,[.5*this._width,.5*this._height,.5]);var t=A._E.fromTranslation(e,A.R3.set(a,this._x,this._y,0));return A._E.mul(t,t,A._E.mul(r,r,n))}),apply:function(e){e.applyViewport(this)}}),"osg","Viewport");const h=g},BvLe:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,r=i("u5PS"),a=i("F5Ms"),o=i("bYH/"),s=i("MQQR"),A=function(){n||(n=i("5rJd").Z),this._checkRTT={},this._webGLExtensions={},this._webGLParameters={},this._webGLShaderMaxInt="NONE",this._webGLShaderMaxFloat="NONE",this._bugsDB={},this._webGLPlatforms={},this._webGLParameters.MAX_COMBINED_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_CUBE_MAP_TEXTURE_SIZE=16,this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS=16,this._webGLParameters.MAX_RENDERBUFFER_SIZE=1,this._webGLParameters.MAX_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_TEXTURE_SIZE=64,this._webGLParameters.MAX_VARYING_VECTORS=8,this._webGLParameters.MAX_VERTEX_ATTRIBS=8,this._webGLParameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS=0,this._webGLParameters.MAX_VERTEX_UNIFORM_VECTORS=128,this._webGLParameters.MAX_VIEWPORT_DIMS=[1,1],this._webGLParameters.NUM_COMPRESSED_TEXTURE_FORMATS=0,this._webGLParameters.MAX_SHADER_PRECISION_FLOAT="none",this._webGLParameters.MAX_SHADER_PRECISION_INT="none",this._gl=void 0};A.instance=function(e,t){if(!A._instance){var i,n=e;if(!n){"undefined"!=typeof window&&window.gli&&(i=window.gli.host.inspectContext,window.gli.host.inspectContext=!1);var s=document.createElement("canvas");s.width=32,s.height=32;var g=new o.Z;g.extend({antialias:!1}),g.extendWithOptionsURL(),n=a.Z.setupWebGL(s,g,(function(){})),this._webglTemporary=n}A._instance=new A,n?A._instance.init(n):r.Z.warn("no support for webgl context detected."),i&&(window.gli.host.inspectContext=i)}if(e){if(this._webglTemporary&&this._webglTemporary!==e){var h=n&&n.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._webglTemporary=null}(t||e!==this._webglTemporary)&&(A._instance.initContextDependant(e),this._webglTemporary=e)}return A._instance},A.prototype={getContext:function(){return this._gl},initContextDependant:function(e){this._gl=e,this._isGL2=void 0!==window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext,this.initWebGLExtensions(e),(0,s.Z)().webglUniforms&&(this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS=64),this.hasLinearHalfFloatRTT(e),this.hasLinearFloatRTT(e),this.hasHalfFloatRTT(e),this.hasFloatRTT(e)},init:function(e){if(this.initWebGLParameters(e),this.initPlatformSupport(),this.initBugDB(e),this.initContextDependant(e),this._isGL2)for(var t=["OES_element_index_uint","EXT_sRGB","EXT_blend_minmax","EXT_frag_depth","WEBGL_depth_texture","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_texture_half_float_linear","OES_texture_float_linear","OES_vertex_array_object","WEBGL_draw_buffers","OES_fbo_render_mipmap","ANGLE_instanced_arrays"],i=A._instance.getWebGLExtensions(),n=function(){},r=0,a=t.length;r<a;r++)i[t[r]]=n},isWebGL2:function(){return this._isGL2},initBugDB:function(e){var t=this._webGLPlatforms,i=this._webGLParameters;if(t.Apple&&(i.UNMASKED_VENDOR_WEBGL&&-1===i.UNMASKED_VENDOR_WEBGL.indexOf("Intel")||(this._bugsDB.OES_standard_derivatives=!0)),e.getExtension("EXT_shader_texture_lod")){var n={type:"FRAGMENT_SHADER",text:["#version 100","#extension GL_EXT_shader_texture_lod : require","#ifdef GL_FRAGMENT_PRECISION_HIGH","  precision highp float;","#else"," precision mediump float;","#endif","uniform samplerCube uT0;","varying vec3 vC;","void main(void) {","  gl_FragColor = textureCubeLodEXT(uT0, vC, 1.0);","}"].join("\n")};this.checkShader(e,n.type,n.text)||(this._bugsDB.EXT_shader_texture_lod=!0)}},checkShader:function(e,t,i){var n=t;"string"==typeof n&&(n=e[t]);var a=e.createShader(n);return e.shaderSource(a,i),e.compileShader(a),!(!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost())||(r.Z.warn(e.getShaderInfoLog(a)),!1)},initPlatformSupport:function(){var e=this._webGLPlatforms;e.Apple=-1!==navigator.vendor.indexOf("Apple")||-1!==navigator.vendor.indexOf("OS X"),e.Mobile=/Mobi/.test(navigator.userAgent)||/ablet/.test(navigator.userAgent)},getWebGLPlatform:function(e){return this._webGLPlatforms[e]},getWebGLPlatforms:function(){return this._webGLPlatforms},getWebGLParameter:function(e){return this._webGLParameters[e]},getWebGLParameters:function(){return this._webGLParameters},getShaderMaxPrecisionFloat:function(){return this._webGLParameters.MAX_SHADER_PRECISION_FLOAT},getShaderMaxPrecisionInt:function(){return this._webGLParameters.MAX_SHADER_PRECISION_INT},checkSupportRTT:function(e,t,i){var r=t+","+i;if(void 0!==this._checkRTT[r])return this._checkRTT[r];if(!e)return!1;switch((0,s.Z)().webglRenderTexture){case"none":return!1;case"float":if(t===n.FLOAT&&i===n.LINEAR)return!1;break;case"half_float":if(t===n.FLOAT)return!1;if(i===n.LINEAR)return!1;break;case"half_float_linear":if(t===n.FLOAT)return!1}var a=e.RGBA,o=a;if(this._isGL2){if(t===n.FLOAT&&(o=e.RGBA32F,i!==n.LINEAR))return this._webGLExtensions.EXT_color_buffer_float;if(t===n.HALF_FLOAT_OES&&(o=e.RGBA16F,i!==n.LINEAR))return this._webGLExtensions.EXT_color_buffer_half_float}var A=e.createTexture();e.bindTexture(e.TEXTURE_2D,A),e.texImage2D(e.TEXTURE_2D,0,o,5,5,0,a,t,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i);var g=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,g),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,A,0);var h=this._checkRTT[r]=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;if(h){e.clearColor(1,0,0,1),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT);var c=new Float32Array(104);e.flush(),e.finish(),e.readPixels(0,0,5,5,e.RGBA,e.FLOAT,c),h=1===c[0]}return e.deleteTexture(A),e.deleteFramebuffer(g),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),h},hasLinearHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float_linear&&this.checkSupportRTT(e,n.HALF_FLOAT_OES,n.LINEAR)},hasLinearFloatRTT:function(e){return this._webGLExtensions.OES_texture_float_linear&&this.checkSupportRTT(e,n.FLOAT,n.LINEAR)},hasHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float&&this.checkSupportRTT(e,n.HALF_FLOAT_OES,n.NEAREST)},hasFloatRTT:function(e){return this._webGLExtensions.OES_texture_float&&this.checkSupportRTT(e,n.FLOAT,n.NEAREST)},queryPrecision:function(e,t,i){var n=e.getShaderPrecisionFormat(t,i);return!!n&&0!==n.precision},hasVAO:function(){return!!this._webGLExtensions.OES_vertex_array_object},getDisjointTimerQuery:function(){return this._webGLExtensions.EXT_disjoint_timer_query_webgl2||this._webGLExtensions.EXT_disjoint_timer_query},initWebGLParameters:function(e){if(e){for(var t=["MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","SHADING_LANGUAGE_VERSION","VERSION","VENDOR","RENDERER","ALIASED_LINE_WIDTH_RANGE","ALIASED_POINT_SIZE_RANGE","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],i=this._webGLParameters,n=0,r=t.length;n<r;++n){var a=t[n];i[a]=e.getParameter(e[a])}this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_FLOAT)?i.MAX_SHADER_PRECISION_FLOAT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_FLOAT)?i.MAX_SHADER_PRECISION_FLOAT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_FLOAT)&&(i.MAX_SHADER_PRECISION_FLOAT="low"),this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_INT)?i.MAX_SHADER_PRECISION_INT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_INT)?i.MAX_SHADER_PRECISION_INT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_INT)&&(i.MAX_SHADER_PRECISION_INT="low");var o=e.getExtension("WEBGL_debug_renderer_info");o&&(i.UNMASKED_RENDERER_WEBGL=e.getParameter(o.UNMASKED_RENDERER_WEBGL),i.UNMASKED_VENDOR_WEBGL=e.getParameter(o.UNMASKED_VENDOR_WEBGL))}},applyExtension:function(e,t){var i=e.getExtension(t),n=t.split("_")[0],r="_"+n,a=new RegExp(n+"$"),o=new RegExp(r);for(var s in i){if("function"==typeof i[s]){var A=s.replace(a,"");void 0===e[A]&&(e[A]=i[s].bind(i))}else{var g=s.replace(o,"");void 0===e[g]&&(e[g]=i[s])}}},getWebGLExtension:function(e){return this._webGLExtensions[e]},getWebGLExtensions:function(){return this._webGLExtensions},_checkShader:function(e,t,i){var n=t;"string"==typeof n&&(n=e[t]);var r=e.createShader(n);return e.shaderSource(r,i),e.compileShader(r),!(!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost())},_doubleCheckExtension:function(e,t){var i=["#version 100","#extension GL_%ext% : require","precision mediump float;","varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"].join("\n");return this._checkShader(e,"FRAGMENT_SHADER",i.replace(/\%ext\%/g,t))},initWebGLExtensions:function(e,t){if(e){var i=t;if(void 0===i&&(i=!0),(0,s.Z)().webglExt){var r=e.getSupportedExtensions();if(r){for(var a=this._webGLExtensions,o=0,A=r.length;o<A;++o){var g=r[o];i&&this._bugsDB[g]||(a[g]=e.getExtension(g),this._isGL2||this.applyExtension(e,g))}if(!this._isGL2){var h="EXT_shader_texture_lod";a[h]&&!this._doubleCheckExtension(e,h)&&delete a[h]}var c=this.getWebGLExtension("EXT_texture_filter_anisotropic");c&&(n.ANISOTROPIC_SUPPORT_EXT=!0,n.ANISOTROPIC_SUPPORT_MAX=e.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT))}}else this._webGLExtensions={}}}};const g=A},haRL:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("W40i"),r=i("pSxj");const a={computeLocalToWorld:function(e,t,i,a){var o=t,s=void 0!==a?a:e.length;void 0===o&&(o=!0);var A=i||n._E.create(),g=0;if(o){for(g=s-1;g>=0;g--){var h=e[g];if("Camera"===h.className()&&(h.getReferenceFrame()!==r.Z.RELATIVE_RF||0===h.getParents().length))break}g+=1}for(var c=g,l=s;c<l;c++){var u=e[c];u.computeLocalToWorldMatrix&&u.computeLocalToWorldMatrix(A)}return A}}},SHDx:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=[];const r={applyFunctionArray:n,registerApplyFunction:function(e,t){n[e]=t},getApplyFunction:function(e){return n[e]}}},W40i:(e,t,i)=>{"use strict";i.d(t,{sh:()=>r,wO:()=>v,_E:()=>E,gf:()=>S,K4:()=>p,R3:()=>m,vh:()=>_});var n=i("LElp"),r=i("F9s5");const a={ArrayType:Float64Array};r.glMatrix.setMatrixArrayType(a.ArrayType),r.glMatrix.EPSILON=1e-9;var o,s,A,g,h,c,l,u,d,I,C,f,p=r.vec2,m=r.vec3,_=r.vec4,E=r.mat4,v=r.mat3,S=r.quat;m.create32=function(){return new Float32Array(3)},m.create64=function(){return new Float64Array(3)},m.fromValues32=function(e,t,i){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=i,n},m.fromValues64=function(e,t,i){var n=new Float64Array(3);return n[0]=e,n[1]=t,n[2]=i,n},m.init=function(e){return m.set(e,0,0,0)},m.transformMat4Rotate=function(e,t,i){var n=t[0],r=t[1],a=t[2];return e[0]=i[0]*n+i[1]*r+i[2]*a,e[1]=i[4]*n+i[5]*r+i[6]*a,e[2]=i[8]*n+i[9]*r+i[10]*a,e},m.valid=function(e){return!n.Z.isNaN(e[0])&&(!n.Z.isNaN(e[1])&&!n.Z.isNaN(e[2]))},m.neg=m.negate,m.ZERO=m.create(),m.ONE=m.fromValues(1,1,1),m.INFINITY=m.fromValues(1/0,1/0,1/0),m.NEGATIVE_INFINITY=m.fromValues(-1/0,-1/0,-1/0),p.create32=function(){return new Float32Array(2)},p.create64=function(){return new Float64Array(2)},p.fromValues32=function(e,t){var i=new Float32Array(2);return i[0]=e,i[1]=t,i},p.fromValues64=function(e,t){var i=new Float64Array(2);return i[0]=e,i[1]=t,i},p.init=function(e){return p.set(e,0,0)},p.valid=function(e){return!n.Z.isNaN(e[0])&&!n.Z.isNaN(e[1])},p.ZERO=p.create(),p.ONE=p.fromValues(1,1),p.INFINITY=p.fromValues(1/0,1/0),p.NEGATIVE_INFINITY=p.fromValues(-1/0,-1/0),_.create32=function(){return new Float32Array(4)},_.create64=function(){return new Float64Array(4)},_.fromValues32=function(e,t,i,n){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},_.fromValues64=function(e,t,i,n){var r=new Float64Array(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},_.init=function(e){return _.set(e,0,0,0,0)},_.valid=function(e){return!n.Z.isNaN(e[0])&&(!n.Z.isNaN(e[1])&&(!n.Z.isNaN(e[2])&&!n.Z.isNaN(e[3])))},_.neg=_.negate,_.ZERO=_.create(),_.ONE=_.fromValues(1,1,1,1),_.INFINITY=_.fromValues(1/0,1/0,1/0,1/0),_.NEGATIVE_INFINITY=_.fromValues(-1/0,-1/0,-1/0,-1/0),S.IDENTITY=S.create(),S.zeroRotation=function(e){return 0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]},S.create32=function(){var e=new Float32Array(4);return e[3]=1,e},S.create64=function(){var e=new Float64Array(4);return e[3]=1,e},S.fromValues32=_.fromValues32,S.fromValues64=_.fromValues64,S.init=S.identity,S.nlerp=function(e,t,i,n){var r,a,o,s,A=t[0],g=t[1],h=t[2],c=t[3],l=i[0],u=i[1],d=i[2],I=i[3],C=1-n;A*l+g*u+h*d+c*I<0?(r=A*C-l*n,a=g*C-u*n,o=h*C-d*n,s=c*C-I*n):(r=A*C+l*n,a=g*C+u*n,o=h*C+d*n,s=c*C+I*n);var f=1/Math.sqrt(r*r+a*a+o*o+s*s);return e[0]=r*f,e[1]=a*f,e[2]=o*f,e[3]=s*f,e},v.IDENTITY=v.create(),v.create32=function(){var e=new Float32Array(9);return e[0]=e[4]=e[8]=1,e},v.create64=function(){var e=new Float64Array(9);return e[0]=e[4]=e[8]=1,e},E.IDENTITY=E.create(),E.create32=function(){var e=new Float32Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},E.create64=function(){var e=new Float64Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},E.setTranslation=function(e,t){return e[12]=t[0],e[13]=t[1],e[14]=t[2],e},E.getFrustum=function(e,t){var i,n,r,a,o,s;if(0!==t[3]||0!==t[7]||-1!==t[11]||0!==t[15])return!1;var A=t[14]/(t[10]-1),g=t[14]/(1+t[10]);return n=A*(t[8]-1)/t[0],i=A*(1+t[8])/t[0],r=A*(1+t[9])/t[5],a=A*(t[9]-1)/t[5],o=A,s=g,e.left=n,e.right=i,e.top=r,e.bottom=a,e.zNear=o,e.zFar=s,!0},E.getPerspective=(o={right:0,left:0,top:0,bottom:0,zNear:0,zFar:0},function(e,t){return E.getFrustum(o,t)&&(e.fovy=180/Math.PI*(Math.atan(o.top/o.zNear)-Math.atan(o.bottom/o.zNear)),e.aspectRatio=(o.right-o.left)/(o.top-o.bottom)),e.zNear=o.zNear,e.zFar=o.zFar,e}),E.getLookAt=(s=E.create(),A=m.create(),g=m.fromValues(0,1,0),h=m.fromValues(0,0,-1),function(e,t,i,n,r){var a=void 0!==r?r:1;E.invert(s,n),E.getTranslation(e,s),m.transformMat4Rotate(i,g,n),m.transformMat4Rotate(t,h,n),m.normalize(t,t),m.add(t,m.scale(A,t,a),e)}),E.getFrustumPlanes=(c=E.create(),function(e,t,i,n){E.mul(c,t,i);var r=!!n,a=e[0];a[0]=c[3]-c[0],a[1]=c[7]-c[4],a[2]=c[11]-c[8],a[3]=c[15]-c[12];var o=e[1];o[0]=c[3]+c[0],o[1]=c[7]+c[4],o[2]=c[11]+c[8],o[3]=c[15]+c[12];var s=e[2];s[0]=c[3]+c[1],s[1]=c[7]+c[5],s[2]=c[11]+c[9],s[3]=c[15]+c[13];var A=e[3];A[0]=c[3]-c[1],A[1]=c[7]-c[5],A[2]=c[11]-c[9],A[3]=c[15]-c[13];var g=4;if(r){g=6;var h=e[4];h[0]=c[3]-c[2],h[1]=c[7]-c[6],h[2]=c[11]-c[10],h[3]=c[15]-c[14];var l=e[5];l[0]=c[3]+c[2],l[1]=c[7]+c[6],l[2]=c[11]+c[10],l[3]=c[15]+c[14]}for(var u=0;u<g;u++){var d=e[u],I=1/Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]*=I,d[1]*=I,d[2]*=I,d[3]*=I}}),E.infiniteFrustum=function(e,t,i,n,r,a){var o=2*a/(i-t),s=2*a/(r-n),A=(i+t)/(i-t),g=(r+n)/(r-n);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=A,e[9]=g,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=-2*a,e[15]=0,e},E.lookAtDirection=(l=m.create(),u=m.create(),d=m.create(),function(e,t,i,n){var r=i;return m.cross(l,r,n),m.normalize(l,l),m.cross(u,l,r),m.normalize(u,u),e[0]=l[0],e[1]=u[0],e[2]=-r[0],e[3]=0,e[4]=l[1],e[5]=u[1],e[6]=-r[1],e[7]=0,e[8]=l[2],e[9]=u[2],e[10]=-r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,E.translate(e,e,m.neg(d,t))}),E.getScale=(I=m.create(),C=m.create(),f=m.create(),function(e,t){return I[0]=t[0],I[1]=t[4],I[2]=t[8],C[0]=t[1],C[1]=t[5],C[2]=t[9],f[0]=t[2],f[1]=t[6],f[2]=t[10],e[0]=m.length(I),e[1]=m.length(C),e[2]=m.length(f),e}),E.getSqrScale=function(){var e=m.create(),t=m.create(),i=m.create();return function(n,r){return e[0]=r[0],e[1]=r[4],e[2]=r[8],t[0]=r[1],t[1]=r[5],t[2]=r[9],i[0]=r[2],i[1]=r[6],i[2]=r[10],n[0]=m.sqrLen(e),n[1]=m.sqrLen(t),n[2]=m.sqrLen(i),n}}();var B=E.rotate;E.rotate=function(e,t,i,n){return B(e,t,i,n)||E.identity(e)};var w=E.fromRotation;E.fromRotation=function(e,t,i){return w(e,t,i)||E.identity(e)}},LElp:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={clamp:function(e,t,i){return Math.min(i,Math.max(t,e))},smoothStep:function(e,t,i){if(i<=e)return 0;if(i>=t)return 1;var n=(i-e)/(t-e);return n*n*(3-2*n)},isNaN:function(e){return e!=e}}},u5PS:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n={};function r(){var e=arguments[0];if(n.console&&!(e>n.currentNotifyLevel)){var t=arguments[1],i=Array.prototype.slice.call(arguments);i=i.splice(2,arguments.length),n.console[t].apply(n.console,i),n.traceLogCall&&e!==n.ERROR&&console.trace()}}function a(e,t,i,r){!n.console||e>n.currentNotifyLevel||(n.console.groupCollapsed&&n.console.groupCollapsed(i),n.console[t](r),n.traceLogCall&&e!==n.ERROR&&console.trace(),n.console.groupEnd&&n.console.groupEnd())}function o(e,t){return t?[e.slice(0,4),e.slice(4,8),e.slice(8,12),e.slice(12,16)]:[[e[0],e[4],e[8],e[12]],[e[1],e[5],e[9],e[13]],[e[2],e[6],e[10],e[14]],[e[3],e[7],e[11],e[15]]]}function s(e,t,i){e>n.currentNotifyLevel||n.console.table&&r("table",o(t,i))}function A(e,t,i,r){e>n.currentNotifyLevel||n.console.table&&a("table",t,o(i,r))}n.ALWAYS=0,n.FATAL=n.ERROR=1,n.WARN=2,n.NOTICE=n.LOG=3,n.INFO=4,n.DEBUG=5,n.currentNotifyLevel=n.LOG,n.console=window.console;for(var g=["error","warn","log","info","debug"],h=0;h<g.length;++h){var c=g[h],l=n[c.toUpperCase()];n[c]=r.bind(n,l,c),n[c+"Fold"]=a.bind(n,l,c),n[c+"Matrix"]=s.bind(n,l),n[c+"MatrixFold"]=A.bind(n,l)}n.group=r.bind(n,n.LOG,"group"),n.groupCollapsed=r.bind(n,n.LOG,"groupCollapsed"),n.groupEnd=n.console.groupEnd,n.notice=n.log,n.noticeFold=n.logFold,n.noticeMatrix=n.logMatrix,n.noticeMatrixFold=n.logMatrixFold,n.timeStamp=function(){},n.assert=function(e,t){void 0===this.console||e||this.console.assert(e,t)},n.setNotifyLevel=function(e,t){n.currentNotifyLevel=e,void 0!==t&&(n.traceLogCall=t)},n.getNotifyLevel=function(){return n.currentNotifyLevel},n.reportWebGLError=!1,n.setConsole=function(e){n.console=e},window.getElementsById=function(e){n.setConsole(e)};const u=n},"5naU":(e,t,i)=>{"use strict";i.d(t,{Z:()=>nt});var n=i("Pev1"),r=i("GoyH"),a=i("WWMP"),o=function(){a.Z.call(this),this._attributeEnable=!1};r.Z.createPrototypeStateAttribute(o,r.Z.objectInherit(a.Z.prototype,{attributeType:"Billboard",cloneType:function(){return new o},setEnabled:function(e){this._attributeEnable=e},isEnabled:function(){return this._attributeEnable},apply:function(){}}),"osg","Billboard");const s=o;var A=i("W40i"),g=function(e){a.Z.call(this),this._constantColor=A.vh.create(),A.vh.set(this._constantColor,1,1,1,1),void 0!==e&&this.setConstantColor(e)};r.Z.createPrototypeStateAttribute(g,r.Z.objectInherit(a.Z.prototype,{attributeType:"BlendColor",cloneType:function(){return new g},setConstantColor:function(e){A.vh.copy(this._constantColor,e)},getConstantColor:function(){return this._constantColor},apply:function(e){e.getGraphicContext().blendColor(this._constantColor[0],this._constantColor[1],this._constantColor[2],this._constantColor[3])}}),"osg","BlendColor");const h=g;var c=i("f7MS"),l=i("k3oU"),u=i("bxht"),d=i("UqX1"),I=i("eYxU"),C=i("W6eo"),f=function(e,t,i,n){a.Z.call(this),this._red=!0,this._green=!0,this._blue=!0,this._alpha=!0,void 0!==e&&void 0!==t&&void 0!==i&&this.setMask(e,t,i,n)};r.Z.createPrototypeStateAttribute(f,r.Z.objectInherit(a.Z.prototype,{attributeType:"ColorMask",cloneType:function(){return new f},setMask:function(e,t,i,n){this._red=!!e,this._green=!!t,this._blue=!!i,this._alpha=!!n},apply:function(e){e.applyColorMask(this)}}),"osg","ColorMask");const p=f;var m,_,E,v=i("t+pa"),S=i("haRL"),B=i("nbbV"),w=i("IQqM"),y=i("qlNd"),M=i("Mfw4"),D=i("t5D/"),b=i("uRnn"),Q=i("Q/WO"),x=i("Z4fc"),T=i("1PKS"),F=function(){this._radiusEquator=F.WGS_84_RADIUS_EQUATOR,this._radiusPolar=F.WGS_84_RADIUS_POLAR,this.computeCoefficients()};F.WGS_84_RADIUS_EQUATOR=6378137,F.WGS_84_RADIUS_POLAR=6356752.3142,F.prototype={setRadiusEquator:function(e){this._radiusEquator=e,this.computeCoefficients()},getRadiusEquator:function(){return this._radiusEquator},setRadiusPolar:function(e){this._radiusPolar=e,this.computeCoefficients()},getRadiusPolar:function(){return this._radiusPolar},convertLatLongHeightToXYZ:function(e,t,i,n){var r=Math.sin(e),a=Math.cos(e),o=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*r*r),s=(o+i)*a*Math.cos(t),A=(o+i)*a*Math.sin(t),g=(o*(1-this._eccentricitySquared)+i)*r;return n[0]=s,n[1]=A,n[2]=g,n},convertXYZToLatLongHeight:function(e,t,i,n){var r=Math.sqrt(e*e+t*t),a=Math.atan2(i*this._radiusEquator,r*this._radiusPolar),o=(this._radiusEquator*this._radiusEquator-this._radiusPolar*this._radiusPolar)/(this._radiusPolar*this._radiusPolar),s=Math.sin(a),A=Math.cos(a),g=Math.atan((i+o*this._radiusPolar*s*s*s)/(r-this._eccentricitySquared*this._radiusEquator*A*A*A)),h=Math.atan2(t,e),c=Math.sin(g),l=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*c*c),u=Math.cos(g);0===u&&(u=1);var d=r/u-l;return n[0]=g,n[1]=h,n[2]=d,n},computeLocalUpVector:function(e,t,i){var n,r,a=this.convertXYZToLatLongHeight(e,t,i,A.R3.create());return n=a[0],r=a[1],[Math.cos(r)*Math.cos(n),Math.sin(r)*Math.cos(n),Math.sin(n)]},isWGS84:function(){return this._radiusEquator===F.WGS_84_RADIUS_EQUATOR&&this._radiusPolar===F.WGS_84_RADIUS_POLAR},computeCoefficients:function(){var e=(this._radiusEquator-this._radiusPolar)/this._radiusEquator;this._eccentricitySquared=2*e-e*e},computeLocalToWorldTransformFromLatLongHeight:function(e,t,i,n){var r=this.convertLatLongHeightToXYZ(e,t,i,n);return A._E.fromTranslation(n,r),this.computeCoordinateFrame(e,t,n),n},computeLocalToWorldTransformFromXYZ:function(e,t,i){var n=this.convertXYZToLatLongHeight(e,t,i,A.R3.create()),r=A._E.fromTranslation(A._E.create(),A.R3.fromValues(e,t,i));return this.computeCoordinateFrame(n[0],n[1],r),r},computeCoordinateFrame:(m=A.R3.create(),_=A.R3.create(),E=A.R3.create(),function(e,t,i){m[0]=Math.cos(t)*Math.cos(e),m[1]=Math.sin(t)*Math.cos(e),m[2]=Math.sin(e),_[0]=-Math.sin(t),_[1]=-Math.cos(t),A.R3.cross(E,m,_),A._E.set(i,_[0],_[1],_[2],0,E[0],E[1],E[2],0,m[0],m[1],m[2],0,0,0,0,1)})};const R=F;var N=i("lU+d"),L=i("p6+I"),k=i("6Szz"),P=i("/CZr"),U=i("uHj6"),O=i("lZH+"),G=i.n(O),H=function(e){U.Z.call(this,e),this._canPlayDefered=void 0};H.PAUSE=0,H.PLAYING=1,r.Z.createPrototypeObject(H,r.Z.objectInherit(U.Z.prototype,{isDirty:function(){return this._status===H.PLAYING},setImage:function(e){U.Z.prototype.setImage.call(this,e),this._status=H.STOP,e.addEventListener("ended",function(){this._imageObject.loop||this.stop()}.bind(this),!0),this.dirty()},setLooping:function(e){this._imageObject.loop=e},play:function(){this._imageObject.play(),this._status=H.PLAYING},stop:function(){this._imageObject.pause(),this._status=H.PAUSE},whenReady:function(){if(!this._imageObject)return G().reject();var e=this;return new(G())((function(t){e._canPlayDefered||(e._canPlayDefered=t,e._imageObject.readyState>3?e._canPlayDefered(e):e._imageObject.addEventListener("canplaythrough",e._canPlayDefered.bind(e._canPlayDefered,e),!0))}))}}),"osg","ImageStream");const K=H;var Z=i("Un/q"),V=i("907W"),Y=i("u5PS"),J=function(e,t){this._bb=new l.Z,this._first=e,this._second=t,this._nodeRayStart=A.R3.create(),this._nodeRayEnd=A.R3.create()},z=function(){this._numVertexIndices=0};z.prototype={apply:function(e){e.getAttributes().Vertex&&(0,Z.Z)(e,this)},operatorPoint:function(){this._numVertexIndices+=2},operatorLine:function(){this._numVertexIndices+=3},operatorTriangle:function(){this._numVertexIndices+=4}};var j=function(e){this._buildKdTree=e,this._numIndices=0};j.prototype={apply:function(e){e.getAttributes().Vertex&&(0,Z.Z)(e,this)},operatorPoint:function(e){var t=this._buildKdTree._kdTree.getVertices(),i=3*e;this._buildKdTree._kdTree.addPoint(e),this._buildKdTree._primitiveIndices[this._numIndices]=this._numIndices;var n=this._buildKdTree._centers,r=3*this._numIndices;n[r]=t[i],n[r+1]=t[i+1],n[r+2]=t[i+2],this._numIndices++},operatorLine:function(e,t){if(e!==t){var i=this._buildKdTree._kdTree.getVertices(),n=3*e,r=3*t;this._buildKdTree._kdTree.addLine(e,t);var a=this._numIndices;this._buildKdTree._primitiveIndices[a]=a;var o=3*a,s=i[n],A=i[n+1],g=i[n+2],h=i[r],c=i[r+1],l=i[r+2],u=s<h?s:h,d=A<c?A:c,I=g<l?g:l,C=s>h?s:h,f=A>c?A:c,p=g>l?g:l,m=this._buildKdTree._centers;m[o]=.5*(u+C),m[o+1]=.5*(d+f),m[o+2]=.5*(I+p),this._numIndices++}},operatorTriangle:function(e,t,i){if(e!==t&&e!==i&&t!==i){var n=this._buildKdTree._kdTree.getVertices(),r=3*e,a=3*t,o=3*i;this._buildKdTree._kdTree.addTriangle(e,t,i);var s=this._numIndices;this._buildKdTree._primitiveIndices[s]=s;var A=3*s,g=n[r],h=n[r+1],c=n[r+2],l=n[a],u=n[a+1],d=n[a+2],I=n[o],C=n[o+1],f=n[o+2],p=g<l?g<I?g:I:l<I?l:I,m=h<u?h<C?h:C:u<C?u:C,_=c<d?c<f?c:f:d<f?d:f,E=g>l?g>I?g:I:l>I?l:I,v=h>u?h>C?h:C:u>C?u:C,S=c>d?c>f?c:f:d>f?d:f,B=this._buildKdTree._centers;B[A]=.5*(p+E),B[A+1]=.5*(m+v),B[A+2]=.5*(_+S),this._numIndices++}}};var W=function(e){this._kdTree=e,this._bb=new l.Z,this._primitiveIndices=void 0,this._centers=void 0,this._axisOrder=A.R3.create(),this._stackLength=0};W.prototype={build:function(e,t){var i=e._targetNumTrianglesPerLeaf,n=t.getVertexAttributeList().Vertex;if(!n)return!1;var r=n.getElements();if(!r)return!1;var a=r.length/3;if(a<i)return!1;this._bb.copy(t.getBoundingBox()),this._kdTree.setVertices(r),this.computeDivisions(e),e._numVerticesProcessed+=a;for(var o=0,s=t.getPrimitiveSetList(),A=s.length,g=0;g<A;g++){var h=s[g],c=h.getMode();c===V.Z.TRIANGLE_STRIP||c===V.Z.TRIANGLE_FAN?o+=3*Math.abs(h.getCount()-2):o+=3*h.getCount()}var u=new z(this);u.apply(t);var d=u._numVertexIndices;this._primitiveIndices=new Uint32Array(o/3),this._centers=new Float32Array(o),this._kdTree.setPrimitiveIndices(new Uint32Array(o));var I=a>65535?new Uint32Array(d):new Uint16Array(d);this._kdTree.setVertexIndices(I);var C=new j(this);C.apply(t);var f=this._kdTree.getPrimitiveIndices().slice(0,this._kdTree.getNumPrimitiveIndices());this._kdTree.setPrimitiveIndices(f);var p=this._kdTree.getVertexIndices().slice(0,this._kdTree.getNumVertexIndices());this._kdTree.setVertexIndices(p),this._primitiveIndices=this._primitiveIndices.slice(0,C._numIndices),this._centers=this._centers.slice(0,3*C._numIndices);var m=new J(-1,this._primitiveIndices.length);m._bb.copy(this._bb);var _=this._kdTree.addNode(m),E=new l.Z;E.copy(this._bb),this.divide(e,E,_,0);var v=this._kdTree.getPrimitiveIndices();for(A=this._primitiveIndices.length,g=0;g<A;++g)this._primitiveIndices[g]=v[this._primitiveIndices[g]];return this._kdTree.setPrimitiveIndices(this._primitiveIndices),this._kdTree.getNodes().length>0},computeDivisions:function(e){this._stackLength=e._maxNumLevels;var t=this._bb._max,i=this._bb._min,n=t[0]-i[0],r=t[1]-i[1],a=t[2]-i[2],o=this._axisOrder;o[0]=n>=r&&n>=a?0:r>=a?1:2,o[2]=n<r&&n<a?0:r<a?1:2;var s=o[0]+o[2];o[1]=3===s?0:2===s?1:2},divide:function(e,t,i,n){var r=this._kdTree,a=this._primitiveIndices,o=r.getNodes(),s=o[i],A=s._first,g=s._second,h=-A-1,c=h+g-1;if(!(n<this._stackLength&&A<0&&g>e._targetNumTrianglesPerLeaf))return A<0&&this.computeNodeBox(s,h,c),i;if(A>=0)return i;for(var l=this._axisOrder[n%3],u=.5*(t._min[l]+t._max[l]),d=0,I=0,C=!1,f=h,p=c,m=this._centers;f<p;){for(;f<p&&m[3*a[f]+l]<=u;)++f;for(;f<p&&m[3*a[p]+l]>u;)--p;if(f<p){var _=a[f];a[f]=a[p],a[p]=_,++f,--p}}f===p&&(m[3*a[f]+l]<=u?++f:--p),p-h<=-1?(d=0,I=i,C=!0):c-f<=-1?(d=i,I=0,C=!0):(d=r.addNode(new J(-h-1,p-h+1)),I=r.addNode(new J(-f-1,c-f+1)));var E=t._max[l];t._max[l]=u;var v=0!==d?this.divide(e,t,d,n+1):0;t._max[l]=E,E=t._min[l],t._min[l]=u;var S=0!==I?this.divide(e,t,I,n+1):0;if(t._min[l]=E,!C){s._first=v,s._second=S,C=!0;var B=s._bb;B.init(),0!==v&&B.expandByBoundingBox(o[v]._bb),0!==S&&B.expandByBoundingBox(o[S]._bb)}return i},computeNodeBox:function(e,t,i){for(var n=1/0,r=1/0,a=1/0,o=-1/0,s=-1/0,A=-1/0,g=this._kdTree.getVertexIndices(),h=this._kdTree.getPrimitiveIndices(),c=this._kdTree.getVertices(),l=t;l<=i;++l)for(var u=h[this._primitiveIndices[l]],d=g[u++],I=0;I<d;++I){var C=3*g[u++],f=c[C],p=c[C+1],m=c[C+2];f<n&&(n=f),p<r&&(r=p),m<a&&(a=m),f>o&&(o=f),p>s&&(s=p),m>A&&(A=m)}var _=1e-6,E=e._bb,v=E._min,S=E._max;v[0]=n-_,v[1]=r-_,v[2]=a-_,S[0]=o+_,S[1]=s+_,S[2]=A+_}};var q=function(){this._vertices=null,this._kdNodes=[],this._primitiveIndices=void 0,this._vertexIndices=void 0,this._numVertexIndices=0,this._numPrimitiveIndices=0};r.Z.createPrototypeObject(q,{getVertices:function(){return this._vertices},setVertices:function(e){this._vertices=e},getNumPrimitiveIndices:function(){return this._numPrimitiveIndices},getNumVertexIndices:function(){return this._numVertexIndices},setPrimitiveIndices:function(e){this._primitiveIndices=e},getPrimitiveIndices:function(){return this._primitiveIndices},setVertexIndices:function(e){this._vertexIndices=e},getVertexIndices:function(){return this._vertexIndices},getNodes:function(){return this._kdNodes},addPoint:function(e){var t=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=t,this._vertexIndices[this._numVertexIndices++]=1,this._vertexIndices[this._numVertexIndices++]=e},addLine:function(e,t){var i=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=i,this._vertexIndices[this._numVertexIndices++]=2,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t},addTriangle:function(e,t,i){var n=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=n,this._vertexIndices[this._numVertexIndices++]=3,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t,this._vertexIndices[this._numVertexIndices++]=i},addNode:function(e){return this._kdNodes.push(e),this._kdNodes.length-1},build:function(e,t){return new W(this).build(e,t)},_intersectFunctor:function(e,t){var i=-t._first-1,n=i+t._second,r=this._vertexIndices;e.setVertices(this._vertices),e.setPrimitiveIndex(i);for(var a=i;a<n;++a){var o=this._primitiveIndices[a],s=r[o++];3===s?e.operatorTriangle(r[o],r[o+1],r[o+2]):2===s?e.operatorLine(r[o],r[o+1]):1===s?e.operatorPoint(r[o]):Y.Z.error("KdTree::intersect() unsupported vertices count :"+s)}},intersect:function(e,t){t._first<0?this._intersectFunctor(e,t):e.enter(t._bb)&&(t._first>0&&this.intersect(e,this._kdNodes[t._first]),t._second>0&&this.intersect(e,this._kdNodes[t._second]),e.leave())},intersectLineSegment:function(e,t,i,n){if(t._first<0)this._intersectFunctor(e,t);else{var r=t._nodeRayStart,a=t._nodeRayEnd;A.R3.copy(r,i),A.R3.copy(a,n);var o,s=this._kdNodes;t._first>0&&(o=s[t._first],e.enter(o._bb,r,a)&&this.intersectLineSegment(e,o,r,a)),t._second>0&&(A.R3.copy(r,i),A.R3.copy(a,n),o=s[t._second],e.enter(o._bb,r,a)&&this.intersectLineSegment(e,o,r,a))}}},"osg","KdTree");const X=q;var $=i("CJNH"),ee=function(e){if($.Z.call(this),this._buildOptions={_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:20},e){var t=e._targetNumTrianglesPerLeaf,i=e._maxNumLevels;void 0!==t&&(this._buildOptions._targetNumTrianglesPerLeaf=t),void 0!==i&&(this._buildOptions._maxNumLevels=i)}};r.Z.createPrototypeObject(ee,r.Z.objectInherit($.Z.prototype,{apply:function(e){if(e.getShape&&void 0===e.getShape()){var t=new X;t.build(this._buildOptions,e)&&e.setShape(t)}this.traverse(e)}}),"osg","KdTreeBuilder");const te=ee;var ie=i("2Vrk"),ne=i("Ln1o"),re=function(e){a.Z.call(this),this.lineWidth=1,void 0!==e&&(this.lineWidth=e)};r.Z.createPrototypeStateAttribute(re,r.Z.objectInherit(a.Z.prototype,{attributeType:"LineWidth",cloneType:function(){return new re},apply:function(e){e.getGraphicContext().lineWidth(this.lineWidth)}}),"osg","LineWidth");const ae=re;var oe=i("oHbX"),se=i("P3GF"),Ae=i("LElp"),ge=i("rfV8"),he=i("cyFB"),ce=i("bDLW"),le=i("gjC8"),ue=i("IpZ9"),de=i("iUVs"),Ie=i("bYH/"),Ce=i("+jyg"),fe=i("e0P+"),pe=i("64xh"),me=function(e){a.Z.call(this),this._enable=!e,this._pointSize=1,this._circleShape=!1,this._dirtyHash=!0,this._hash=""};r.Z.createPrototypeStateAttribute(me,r.Z.objectInherit(a.Z.prototype,{attributeType:"PointSize",cloneType:function(){return new me(!0)},setCircleShape:function(e){this._circleShape=e,this._dirtyHash=!0},isCircleShape:function(){return this._circleShape},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},isEnabled:function(){return this._enable},setPointSize:function(e){this._pointSize=e},getOrCreateUniforms:function(){var e=me;return e.uniforms||(e.uniforms={pointSize:pe.Z.createFloat(1,"uPointSize")}),e.uniforms},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+(this.isEnabled()?"1":"0")+(this._circleShape?"1":"0")},apply:function(){this._enable&&this.getOrCreateUniforms().pointSize.setFloat(this._pointSize)}}),"osg","PointSizeAttribute");const _e=me;var Ee,ve,Se,Be=i("itLJ"),we=[],ye=[];we[V.Z.POINTS]=(Ee=A.R3.create(),function(e,t,i,n,r){for(var a=e+t,o=e;o<a;++o){var s=3*i[o];Ee[0]=r[s],Ee[1]=r[s+1],Ee[2]=r[s+2],n.operatorPoint(Ee)}}),we[V.Z.LINES]=(ve=A.R3.create(),Se=A.R3.create(),function(e,t,i,n,r){for(var a=e+t,o=e;o<a-1;o+=2){var s=3*i[o];ve[0]=r[s],ve[1]=r[s+1],ve[2]=r[s+2],s=3*i[o+1],Se[0]=r[s],Se[1]=r[s+1],Se[2]=r[s+2],n.operatorLine(ve,Se)}}),we[V.Z.LINE_STRIP]=function(){var e=A.R3.create(),t=A.R3.create();return function(i,n,r,a,o){for(var s=i+n,A=i;A<s-1;++A){var g=3*r[A];e[0]=o[g],e[1]=o[g+1],e[2]=o[g+2],g=3*r[A+1],t[0]=o[g],t[1]=o[g+1],t[2]=o[g+2],a.operatorLine(e,t)}}}(),we[V.Z.LINE_LOOP]=function(){var e=A.R3.create(),t=A.R3.create();return function(i,n,r,a,o){for(var s=i+n-1,A=i;A<s;++A){var g=3*r[A];e[0]=o[g],e[1]=o[g+1],e[2]=o[g+2],g=3*r[A+1],t[0]=o[g],t[1]=o[g+1],t[2]=o[g+2],a.operatorLine(e,t)}s=3*r[s],e[0]=o[s],e[1]=o[s+1],e[2]=o[s+2];var h=3*r[0];t[0]=o[h],t[1]=o[h+1],t[2]=o[h+2],a.operatorLine(e,t)}}(),we[V.Z.TRIANGLES]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o,s){for(var A=n+r,g=n;g<A;g+=3){var h=3*a[g];e[0]=s[h],e[1]=s[h+1],e[2]=s[h+2],h=3*a[g+1],t[0]=s[h],t[1]=s[h+1],t[2]=s[h+2],h=3*a[g+2],i[0]=s[h],i[1]=s[h+1],i[2]=s[h+2],o.operatorTriangle(e,t,i)}}}(),we[V.Z.TRIANGLE_STRIP]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o,s){for(var A=2,g=n;A<r;++A,++g){var h=3*a[g];e[0]=s[h],e[1]=s[h+1],e[2]=s[h+2],h=3*a[g+1],t[0]=s[h],t[1]=s[h+1],t[2]=s[h+2],h=3*a[g+2],i[0]=s[h],i[1]=s[h+1],i[2]=s[h+2],A%2?o.operatorTriangle(e,i,t):o.operatorTriangle(e,t,i)}}}(),we[V.Z.TRIANGLE_FAN]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o,s){for(var A=a[n],g=2,h=n+1;g<r;++g,++h){e[0]=s[A],e[1]=s[A+1],e[2]=s[A+2];var c=3*a[h];t[0]=s[c],t[1]=s[c+1],t[2]=s[c+2],c=3*a[h+1],i[0]=s[c],i[1]=s[c+1],i[2]=s[c+2],o.operatorTriangle(e,t,i)}}}(),ye[V.Z.POINTS]=function(){var e=A.R3.create();return function(t,i,n,r){for(var a=t;a<t+i;++a){var o=3*a;e[0]=r[o],e[1]=r[o+1],e[2]=r[o+2],n.operatorPoint(e)}}}(),ye[V.Z.LINES]=function(){var e=A.R3.create(),t=A.R3.create();return function(i,n,r,a){for(var o=i;o<i+n-1;o+=2){var s=3*o;e[0]=a[s],e[1]=a[s+1],e[2]=a[s+2],s=3*(o+1),t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],r.operatorLine(e,t)}}}(),ye[V.Z.LINE_STRIP]=function(){var e=A.R3.create(),t=A.R3.create();return function(i,n,r,a){for(var o=i;o<i+n-1;++o){var s=3*o;e[0]=a[s],e[1]=a[s+1],e[2]=a[s+2],s=3*(o+1),t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],r.operatorLine(e,t)}}}(),ye[V.Z.LINE_LOOP]=function(){var e=A.R3.create(),t=A.R3.create();return function(i,n,r,a){for(var o=i+n-1,s=i;s<o;++s){var A=3*s;e[0]=a[A],e[1]=a[A+1],e[2]=a[A+2],A=3*(s+1),t[0]=a[A],t[1]=a[A+1],t[2]=a[A+2],r.operatorLine(e,t)}o*=3,e[0]=a[o],e[1]=a[o+1],e[2]=a[o+2],i*=3,t[0]=a[i],t[1]=a[i+1],t[2]=a[i+2],r.operatorLine(e,t)}}(),ye[V.Z.TRIANGLES]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o){for(var s=n;s<n+r;s+=3){var A=3*s;e[0]=o[A],e[1]=o[A+1],e[2]=o[A+2],A=3*(s+1),t[0]=o[A],t[1]=o[A+1],t[2]=o[A+2],A=3*(s+2),i[0]=o[A],i[1]=o[A+1],i[2]=o[A+2],a.operatorTriangle(e,t,i)}}}(),ye[V.Z.TRIANGLE_STRIP]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o){for(var s=2,A=n;s<r;++s,++A){var g=3*A;e[0]=o[g],e[1]=o[g+1],e[2]=o[g+2],g=3*(A+1),t[0]=o[g],t[1]=o[g+1],t[2]=o[g+2],g=3*(A+2),i[0]=o[g],i[1]=o[g+1],i[2]=o[g+2],s%2?a.operatorTriangle(e,i,t):a.operatorTriangle(e,t,i)}}}(),ye[V.Z.TRIANGLE_FAN]=function(){var e=A.R3.create(),t=A.R3.create(),i=A.R3.create();return function(n,r,a,o){for(var s=2,A=n+1;s<r;++s,++A){e[0]=o[n],e[1]=o[n+1],e[2]=o[n+2];var g=3*A;t[0]=o[g],t[1]=o[g+1],t[2]=o[g+2],g=3*(A+1),i[0]=o[g],i[1]=o[g+1],i[2]=o[g+2],a.operatorTriangle(e,t,i)}}}();const Me=function(e,t,i){var n=e.getPrimitiveSetList();if(n)for(var r,a=n.length,o=0;o<a;o++){var s=n[o];if(s instanceof T.Z){if(r=we[s.getMode()]){var A=s.indices.getElements();r(s.getFirst()/A.BYTES_PER_ELEMENT,s.getCount(),A,t,i)}}else s instanceof x.Z&&(r=ye[s.getMode()])&&r(s.getFirst(),s.getCount(),t,i)}};var De=i("5pih"),be=i("WMIH"),Qe=i("hLVw"),xe=i("gtcU"),Te=i("QtIg"),Fe=i("7itD"),Re=i("PNpA"),Ne=i("UAvO"),Le=i("bfff"),ke=i("nRYw"),Pe=i("o4nZ"),Ue=i("YVjV"),Oe=i("5rJd"),Ge=function(){Oe.Z.call(this),this._images={};for(var e=0;e<6;e++)this._images[Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X+e]=new U.Z};r.Z.createPrototypeStateAttribute(Ge,r.Z.objectInherit(Oe.Z.prototype,{setDefaultParameters:function(){Oe.Z.prototype.setDefaultParameters.call(this),this._textureTarget=Oe.Z.TEXTURE_CUBE_MAP,this._flipY=!1},invalidate:function(){Oe.Z.prototype.invalidate.call(this);for(var e=Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X;e<Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X+6;e++){var t=this._images[e];this._images[Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()&&t.dirty()}this.dirty()},cloneType:function(){return new Ge},setImage:function(e,t,i){var n=e;"string"==typeof n&&(n=Oe.Z[n]),this._images[n].setImage(t,i),this.setImageFormat(i),this.setTextureSize(this._images[n].getWidth(),this._images[n].getHeight()),this._textureNull=!1,this.dirty()},getImage:function(e){return this._images[e].getImage()},initCubemapContent:function(e){var t=this._internalFormat;return this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),!0},generateMipmap:function(e,t){if(this.hasMipmapFilter()){if(this._images[Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X].hasMipmap())for(var i=0;i<6;i++){var n=this._images[Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X+i];n.hasMipmap()||Y.Z.error("mipmap not set correctly for TextureCubemap");for(var r=this._internalFormat,a=1;a<n.getMipmap().length;a++){var o=n.getMipmap()[a].getWidth();this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,a,r,o,o,0,r,this._type,n.getMipmap()[a].getImage())}}else e.generateMipmap(t);this._dirtyMipmap=!1}},applyImageTarget:function(e,t,i){var n=this._images[i];return n.getImage()&&n.isReady()?n.isDirty()?(this.setTextureSize(n.getWidth(),n.getHeight()),n.setDirty(!1),n.isTypedArray()?this.applyTexImage2D(e,i,0,t,this._textureWidth,this._textureHeight,0,t,this._type,n.getImage()):this.applyTexImage2D(e,i,0,t,t,this._type,n.getImage()),!this._unrefImageDataAfterApply||this.hasMipmap()&&n.hasMipmap()||n.release(),1):1:0},initCubemapContentImage:function(e){var t=this._internalFormat,i=0;return i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_X),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_X),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Y),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Y),i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Z),6===(i+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Z))},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{this._textureObject||(this.computeTextureFormat(),this.init(e)),this._textureObject.bind(t),(this._images[Oe.Z.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()?this.initCubemapContentImage(t):this.initCubemapContent(t))&&(this._dirty=!1,this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget))}else this._textureObject.bind(t),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget)}}),"osg","TextureCubeMap");const He=Ge;var Ke=i("6RPJ"),Ze=function(){},Ve=Ze.functorDrawElements=[],Ye=Ze.functorDrawArrays=[];Ve[V.Z.TRIANGLES]=function(e,t,i,n){for(var r=e+t,a=e;a<r;a+=3)n(i[a],i[a+1],i[a+2])},Ve[V.Z.TRIANGLE_STRIP]=function(e,t,i,n){for(var r=2,a=e;r<t;++r,++a)r%2?n(i[a],i[a+2],i[a+1]):n(i[a],i[a+1],i[a+2])},Ve[V.Z.TRIANGLE_FAN]=function(e,t,i,n){for(var r=i[e],a=2,o=e+1;a<t;++a,++o)n(r,i[o],i[o+1])},Ye[V.Z.TRIANGLES]=function(e,t,i){for(var n=2,r=e;n<t;n+=3,r+=3)i(r,r+1,r+2)},Ye[V.Z.TRIANGLE_STRIP]=function(e,t,i){for(var n=2,r=e;n<t;++n,++r)n%2?i(r,r+2,r+1):i(r,r+1,r+2)},Ye[V.Z.TRIANGLE_FAN]=function(e,t,i){for(var n=2,r=e+1;n<t;++n,++r)i(e,r,r+1)},Ze.prototype={init:function(e,t){this._geom=e,this._cb=t},apply:function(){var e=this._geom.getPrimitiveSetList();if(e)for(var t,i=this._cb,n=e.length,r=0;r<n;r++){var a=e[r];if(a instanceof T.Z){if(t=Ve[a.getMode()]){var o=a.indices.getElements();t(a.getFirst()/o.BYTES_PER_ELEMENT,a.getCount(),o,i)}}else a instanceof x.Z&&(t=Ye[a.getMode()])&&t(a.getFirst(),a.getCount(),i)}}};const Je=Ze;var ze=i("Qp64"),je=i("Yy1w"),We=i("rsXr"),qe=i("pSxj"),Xe=i("6qT5"),$e=i("cnke"),et=i("ojCs"),tt=i("BvLe"),it={};it.AutoTransform=n.Z,it.BillboardAttribute=s,it.BlendColor=h,it.BlendFunc=c.Z,it.BoundingBox=l.Z,it.BoundingSphere=u.Z,it.BufferArray=d.Z,it.BufferArrayProxy=I.Z,it.ColorMask=p,it.Camera=C.Z,it.ColorMask=p,it.ComputeBoundsVisitor=v.Z,r.Z.objectMix(it,S.Z),it.CullFace=B.Z,it.CullingSet=w.Z,it.CullSettings=y.Z,it.CullStack=M.Z,it.CullVisitor=D.Z,it.Depth=b.Z,it.DrawArrayLengths=Q.Z,it.DrawArrays=x.Z,it.DrawElements=T.Z,it.EllipsoidModel=R,it.WGS_84_RADIUS_EQUATOR=R.WGS_84_RADIUS_EQUATOR,it.WGS_84_RADIUS_POLAR=R.WGS_84_RADIUS_POLAR,it.FrameBufferObject=N.Z,it.FrameStamp=L.Z,it.Geometry=k.Z,it.GLObject=P.Z,it.Image=U.Z,it.ImageStream=K,it.KdTree=X,it.KdTreeBuilder=te,it.Light=ie.Z,it.LightSource=ne.Z,it.LineWidth=ae,it.Lod=oe.Z,it.Material=se.Z,r.Z.objectMix(it,Ae.Z),it.MatrixTransform=ge.Z,it.PooledResource=he.Z,it.PooledArray=ce.Z,it.PooledMap=le.Z,it.Node=ue.Z,it.NodeVisitor=$.Z,r.Z.objectMix(it,Y.Z),it.Object=de.Z,it.Options=Ie.Z,it.PagedLOD=Ce.Z,it.Plane=Be.Z,it.PointSizeAttribute=_e,it.Polytope=fe.Z,it.primitiveSet=V.Z,it.primitiveFunctor=Me,it.primitiveIndexFunctor=Z.Z,it.Program=De.Z,it.Projection=be.Z,it.RenderBin=Qe.Z,it.RenderLeaf=xe.Z,it.RenderStage=Te.Z,it.Shader=Fe.Z,r.Z.objectMix(it,Re.Z),it.StackObjectPairPool=Ne.Z,it.State=Le.Z,it.StateAttribute=a.Z,it.StateGraph=ke.Z,it.StateSet=Pe.Z,it.Scissor=We.Z,it.Switch=Ue.Z,it.Texture=Oe.Z,it.TextureCubeMap=He,it.Transform=Ke.Z,it.TriangleIndexFunctor=Je,it.Uniform=pe.Z,it.UpdateVisitor=ze.Z,r.Z.objectMix(it,r.Z),it.Viewport=je.Z,it.VertexArrayObject=et.Z,it.vec2=A.sh.vec2,it.vec3=A.sh.vec3,it.vec4=A.sh.vec4,it.quat=A.sh.quat,it.mat3=A.sh.mat3,it.mat4=A.sh.mat4,it.Transform.RELATIVE_RF=qe.Z.RELATIVE_RF,it.Transform.ABSOLUTE_RF=qe.Z.ABSOLUTE_RF,it.Timer=Xe.Z,it.TimerGPU=$e.Z,it.WebGLCaps=tt.Z;const nt=it},tlSa:()=>{if(window.Set&&window.Map&&window.Uint8ClampedArray){if(Math.sign||(Math.sign=function(e){return e>0?1:e<0?-1:0}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.log10||(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.slice(-e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e}),!Float32Array.prototype.slice){var e=function(e,t){return new this.constructor(this.subarray(e,t))};Int8Array.prototype.slice=e,Uint8Array.prototype.slice=e,Uint8ClampedArray.prototype.slice=e,Int16Array.prototype.slice=e,Uint16Array.prototype.slice=e,Int32Array.prototype.slice=e,Uint32Array.prototype.slice=e,Float32Array.prototype.slice=e,Float64Array.prototype.slice=e}if(!new window.Set(["test"]).has("test")){var t=window.Set;window.Set=function(e){var i=new t;if(e)for(var n=0;n<e.length;++n)i.add(e[n]);return i}}if("object"==typeof window.Event){function i(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}i.prototype=window.Event.prototype,window.Event=i}}},"Un/q":(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n=i("907W"),r=i("1PKS"),a=i("Z4fc"),o=[],s=[];o[n.Z.TRIANGLES]=function(e,t,i,n){for(var r=e+t,a=e;a<r;a+=3)n.operatorTriangle(i[a],i[a+1],i[a+2])},o[n.Z.TRIANGLE_STRIP]=function(e,t,i,n){for(var r=2,a=e;r<t;++r,++a)r%2?n.operatorTriangle(i[a],i[a+2],i[a+1]):n.operatorTriangle(i[a],i[a+1],i[a+2])},o[n.Z.TRIANGLE_FAN]=function(e,t,i,n){for(var r=i[e],a=2,o=e+1;a<t;++a,++o)n.operatorTriangle(r,i[o],i[o+1])},o[n.Z.POINTS]=function(e,t,i,n){for(var r=e+t,a=e;a<r;++a)n.operatorPoint(i[a])},o[n.Z.LINES]=function(e,t,i,n){for(var r=e+t,a=e;a<r;a+=2)n.operatorLine(i[a],i[a+1])},o[n.Z.LINE_STRIP]=function(e,t,i,n){for(var r=e+t,a=e;a<r;++a)n.operatorLine(i[a],i[a+1])},o[n.Z.LINE_LOOP]=function(e,t,i,n){for(var r=e+t,a=e;a<r;++a)n.operatorLine(i[a],i[a+1]);n.operatorLine(i[i.length-1],i[0])},s[n.Z.TRIANGLES]=function(e,t,i){for(var n=2,r=e;n<t;n+=3,r+=3)i.operatorTriangle(r,r+1,r+2)},s[n.Z.TRIANGLE_STRIP]=function(e,t,i){for(var n=2,r=e;n<t;++n,++r)n%2?i.operatorTriangle(r,r+2,r+1):i.operatorTriangle(r,r+1,r+2)},s[n.Z.TRIANGLE_FAN]=function(e,t,i){for(var n=2,r=e+1;n<t;++n,++r)i.operatorTriangle(e,r,r+1)},s[n.Z.POINTS]=function(e,t,i){for(var n=0,r=e;n<t;++n,++r)i.operatorPoint(r)},s[n.Z.LINES]=function(e,t,i){for(var n=1,r=e;n<t;n+=2,r+=2)i.operatorLine(r,r+1)},s[n.Z.LINE_STRIP]=function(e,t,i){for(var n=1,r=e;n<t;++n,++r)i.operatorLine(r,r+1)},s[n.Z.LINE_LOOP]=function(e,t,i){for(var n=1,r=e;n<t;++n,++r)i.operatorLine(r,r+1);i.operatorLine(e+t-1,e)};const A=function(e,t){var i=e.getPrimitiveSetList();if(i)for(var n,A=i.length,g=0;g<A;g++){var h=i[g];if(h instanceof r.Z){if(n=o[h.getMode()]){var c=h.indices.getElements();n(h.getFirst()/c.BYTES_PER_ELEMENT,h.getCount(),c,t)}}else h instanceof a.Z&&(n=s[h.getMode()])&&n(h.getFirst(),h.getCount(),t)}}},"907W":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};const r=n},PNpA:(e,t,i)=>{"use strict";i.d(t,{Z:()=>I});var n=i("W40i"),r=i("UqX1"),a=i("6Szz"),o=i("907W"),s=i("Z4fc"),A=i("1PKS"),g=i("5pih"),h=i("7itD"),c=i("GoyH"),l=function(){var e=new a.Z,t=new c.Z.Float32Array([4,-1,-1,4,-1,-1]),i=new r.Z(r.Z.ARRAY_BUFFER,t,2);e.getAttributes().Vertex=i,e.getAttributes().TexCoord0=i;var n=new s.Z(o.Z.TRIANGLES,0,3);return e.getPrimitives().push(n),function(){return e}}(),u=function(e){void 0===e&&(e=1),void 0===u.getShader&&(u.getShader=function(){if(void 0===u.getShader.program){var e=["attribute vec3 Vertex;","attribute vec4 Color;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec4 vColor;","","void main(void) {","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0));","  vColor = Color;","}"].join("\n"),t=["varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"].join("\n"),i=new g.Z(new h.Z("VERTEX_SHADER",e),new h.Z("FRAGMENT_SHADER",t));u.getShader.program=i}return u.getShader.program});var t=new a.Z,i=new c.Z.Float32Array(18);i[3]=e,i[10]=e,i[17]=e;var n=new c.Z.Float32Array(24);n[0]=n[3]=1,n[4]=n[7]=1,n[9]=n[11]=1,n[13]=n[15]=1,n[18]=n[19]=1,n[22]=n[23]=1,t.getAttributes().Vertex=new r.Z(r.Z.ARRAY_BUFFER,i,3),t.getAttributes().Color=new r.Z(r.Z.ARRAY_BUFFER,n,4);var A=new s.Z(o.Z.LINES,0,6);return t.getPrimitives().push(A),t.getOrCreateStateSet().setAttributeAndModes(u.getShader()),t},d=function(e,t,i,g,h,l,u){e=e||1,g=void 0!==g?g:0,h=void 0!==h?h:2*Math.PI,l=void 0!==l?l:0,u=void 0!==u?u:Math.PI;for(var d=Math.max(3,Math.floor(t)||8),I=Math.max(2,Math.floor(i)||6),C=d*I/3>=65536,f=C?d*I*6:d*I*4,p=new c.Z.Float32Array(3*f),m=new c.Z.Float32Array(3*f),_=new c.Z.Float32Array(2*f),E=C?void 0:new c.Z.Uint16Array(d*I*6),v=0,S=0,B=new c.Z.Float32Array(3),w=new c.Z.Float32Array(3),y=new c.Z.Float32Array(3),M=new c.Z.Float32Array(3),D=new c.Z.Float32Array(3),b=new c.Z.Float32Array(3),Q=new c.Z.Float32Array(3),x=new c.Z.Float32Array(3),T=new c.Z.Float32Array(2),F=new c.Z.Float32Array(2),R=new c.Z.Float32Array(2),N=new c.Z.Float32Array(2),L=function(t,i,r,a,o){r[0]=-e*Math.cos(g+t*h)*Math.sin(l+i*u),r[1]=e*Math.cos(l+i*u),r[2]=e*Math.sin(g+t*h)*Math.sin(l+i*u),n.R3.normalize(a,r),o[0]=t,o[1]=1-i},k=0;k<I;k++)for(var P=0;P<d;P++){L((P+1)/d,k/I,B,D,T),L(P/d,k/I,w,b,F),L(P/d,(k+1)/I,y,Q,R),L((P+1)/d,(k+1)/I,M,x,N);var U=3*v;p[U]=B[0],p[U+1]=B[1],p[U+2]=B[2],p[U+3]=w[0],p[U+4]=w[1],p[U+5]=w[2],p[U+6]=y[0],p[U+7]=y[1],p[U+8]=y[2],m[U]=D[0],m[U+1]=D[1],m[U+2]=D[2],m[U+3]=b[0],m[U+4]=b[1],m[U+5]=b[2],m[U+6]=Q[0],m[U+7]=Q[1],m[U+8]=Q[2];var O=2*v;if(_[O]=T[0],_[O+1]=T[1],_[O+2]=F[0],_[O+3]=F[1],_[O+4]=R[0],_[O+5]=R[1],v+=3,C)p[U=3*v]=B[0],p[U+1]=B[1],p[U+2]=B[2],p[U+3]=y[0],p[U+4]=y[1],p[U+5]=y[2],p[U+6]=M[0],p[U+7]=M[1],p[U+8]=M[2],m[U]=D[0],m[U+1]=D[1],m[U+2]=D[2],m[U+3]=Q[0],m[U+4]=Q[1],m[U+5]=Q[2],m[U+6]=x[0],m[U+7]=x[1],m[U+8]=x[2],_[O=2*v]=T[0],_[O+1]=T[1],_[O+2]=R[0],_[O+3]=R[1],_[O+4]=N[0],_[O+5]=N[1],v+=3;else{p[U=3*v]=M[0],p[U+1]=M[1],p[U+2]=M[2],m[U]=x[0],m[U+1]=x[1],m[U+2]=x[2],_[O=2*v]=N[0],_[O+1]=N[1];var G=3*S,H=v-3;E[G]=H,E[G+1]=H+1,E[G+2]=H+2,E[G+3]=H,E[G+4]=H+2,E[G+5]=H+3,S+=2,v+=1}}var K=new a.Z;return K.getAttributes().Vertex=new r.Z("ARRAY_BUFFER",p,3),K.getAttributes().Normal=new r.Z("ARRAY_BUFFER",m,3),K.getAttributes().TexCoord0=new r.Z("ARRAY_BUFFER",_,2),C?K.getPrimitives().push(new s.Z(o.Z.TRIANGLES,0,p.length/3)):K.getPrimitives().push(new A.Z(o.Z.TRIANGLES,new r.Z("ELEMENT_ARRAY_BUFFER",E,1))),K};const I={createTexturedBoxGeometry:function(e,t,i,n,s,g){var h,l,u,d=void 0!==e?e:0,I=void 0!==t?t:0,C=void 0!==i?i:0,f=void 0!==n?n:1,p=void 0!==s?s:1,m=void 0!==g?g:1,_=new a.Z;h=f/2,l=p/2,u=m/2;var E=new c.Z.Float32Array(72),v=new c.Z.Float32Array(48),S=new c.Z.Float32Array(72);E[0]=d-h,E[1]=I-l,E[2]=C+u,S[0]=0,S[1]=-1,S[2]=0,v[0]=0,v[1]=1,E[3]=d-h,E[4]=I-l,E[5]=C-u,S[3]=0,S[4]=-1,S[5]=0,v[2]=0,v[3]=0,E[6]=d+h,E[7]=I-l,E[8]=C-u,S[6]=0,S[7]=-1,S[8]=0,v[4]=1,v[5]=0,E[9]=d+h,E[10]=I-l,E[11]=C+u,S[9]=0,S[10]=-1,S[11]=0,v[6]=1,v[7]=1,E[12]=d+h,E[13]=I+l,E[14]=C+u,S[12]=0,S[13]=1,S[14]=0,v[8]=0,v[9]=1,E[15]=d+h,E[16]=I+l,E[17]=C-u,S[15]=0,S[16]=1,S[17]=0,v[10]=0,v[11]=0,E[18]=d-h,E[19]=I+l,E[20]=C-u,S[18]=0,S[19]=1,S[20]=0,v[12]=1,v[13]=0,E[21]=d-h,E[22]=I+l,E[23]=C+u,S[21]=0,S[22]=1,S[23]=0,v[14]=1,v[15]=1,E[24]=d+h,E[25]=I-l,E[26]=C+u,S[24]=1,S[25]=0,S[26]=0,v[16]=0,v[17]=1,E[27]=d+h,E[28]=I-l,E[29]=C-u,S[27]=1,S[28]=0,S[29]=0,v[18]=0,v[19]=0,E[30]=d+h,E[31]=I+l,E[32]=C-u,S[30]=1,S[31]=0,S[32]=0,v[20]=1,v[21]=0,E[33]=d+h,E[34]=I+l,E[35]=C+u,S[33]=1,S[34]=0,S[35]=0,v[22]=1,v[23]=1,E[36]=d-h,E[37]=I+l,E[38]=C+u,S[36]=-1,S[37]=0,S[38]=0,v[24]=0,v[25]=1,E[39]=d-h,E[40]=I+l,E[41]=C-u,S[39]=-1,S[40]=0,S[41]=0,v[26]=0,v[27]=0,E[42]=d-h,E[43]=I-l,E[44]=C-u,S[42]=-1,S[43]=0,S[44]=0,v[28]=1,v[29]=0,E[45]=d-h,E[46]=I-l,E[47]=C+u,S[45]=-1,S[46]=0,S[47]=0,v[30]=1,v[31]=1,E[48]=d-h,E[49]=I+l,E[50]=C+u,S[48]=0,S[49]=0,S[50]=1,v[32]=0,v[33]=1,E[51]=d-h,E[52]=I-l,E[53]=C+u,S[51]=0,S[52]=0,S[53]=1,v[34]=0,v[35]=0,E[54]=d+h,E[55]=I-l,E[56]=C+u,S[54]=0,S[55]=0,S[56]=1,v[36]=1,v[37]=0,E[57]=d+h,E[58]=I+l,E[59]=C+u,S[57]=0,S[58]=0,S[59]=1,v[38]=1,v[39]=1,E[60]=d+h,E[61]=I+l,E[62]=C-u,S[60]=0,S[61]=0,S[62]=-1,v[40]=0,v[41]=1,E[63]=d+h,E[64]=I-l,E[65]=C-u,S[63]=0,S[64]=0,S[65]=-1,v[42]=0,v[43]=0,E[66]=d-h,E[67]=I-l,E[68]=C-u,S[66]=0,S[67]=0,S[68]=-1,v[44]=1,v[45]=0,E[69]=d-h,E[70]=I+l,E[71]=C-u,S[69]=0,S[70]=0,S[71]=-1,v[46]=1,v[47]=1;var B=new c.Z.Uint16Array(36);B[0]=0,B[1]=1,B[2]=2,B[3]=0,B[4]=2,B[5]=3,B[6]=4,B[7]=5,B[8]=6,B[9]=4,B[10]=6,B[11]=7,B[12]=8,B[13]=9,B[14]=10,B[15]=8,B[16]=10,B[17]=11,B[18]=12,B[19]=13,B[20]=14,B[21]=12,B[22]=14,B[23]=15,B[24]=16,B[25]=17,B[26]=18,B[27]=16,B[28]=18,B[29]=19,B[30]=20,B[31]=21,B[32]=22,B[33]=20,B[34]=22,B[35]=23,_.getAttributes().Vertex=new r.Z(r.Z.ARRAY_BUFFER,E,3),_.getAttributes().Normal=new r.Z(r.Z.ARRAY_BUFFER,S,3),_.getAttributes().TexCoord0=new r.Z(r.Z.ARRAY_BUFFER,v,2);var w=new A.Z(o.Z.TRIANGLES,new r.Z(r.Z.ELEMENT_ARRAY_BUFFER,B,1));return _.getPrimitives().push(w),_},createTexturedQuadGeometry:function(e,t,i,s,g,h,l,u,d,I,C,f,p){void 0===f&&void 0===p&&(f=I,p=C,I=0,C=0);var m=new a.Z,_=new c.Z.Float32Array(12);_[0]=e+l,_[1]=t+u,_[2]=i+d,_[3]=e,_[4]=t,_[5]=i,_[6]=e+s,_[7]=t+g,_[8]=i+h,_[9]=e+s+l,_[10]=t+g+u,_[11]=i+h+d,void 0===f&&(f=1),void 0===p&&(p=1);var E=new c.Z.Float32Array(8);E[0]=I,E[1]=p,E[2]=I,E[3]=C,E[4]=f,E[5]=C,E[6]=f,E[7]=p;var v=n.R3.fromValues(s,g,h);n.R3.cross(v,v,n.R3.fromValues(l,u,d)),n.R3.normalize(v,v);var S=new c.Z.Float32Array(12);S[0]=v[0],S[1]=v[1],S[2]=v[2],S[3]=v[0],S[4]=v[1],S[5]=v[2],S[6]=v[0],S[7]=v[1],S[8]=v[2],S[9]=v[0],S[10]=v[1],S[11]=v[2];var B=new c.Z.Uint16Array(6);B[0]=0,B[1]=1,B[2]=2,B[3]=0,B[4]=2,B[5]=3,m.getAttributes().Vertex=new r.Z(r.Z.ARRAY_BUFFER,_,3),m.getAttributes().Normal=new r.Z(r.Z.ARRAY_BUFFER,S,3),m.getAttributes().TexCoord0=new r.Z(r.Z.ARRAY_BUFFER,E,2);var w=new A.Z(o.Z.TRIANGLES,new r.Z(r.Z.ELEMENT_ARRAY_BUFFER,B,1));return m.getPrimitives().push(w),m},createTexturedSphereGeometry:d,createTexturedFullScreenFakeQuadGeometry:l,createAxisGeometry:u,createTexturedSphere:d,createGridGeometry:function(e,t,i,n,A,g,h,c,l,u,d){e=void 0!==e?e:-.5,t=void 0!==t?t:-.5,i=void 0!==i?i:0,n=void 0!==n?n:1,A=void 0!==A?A:0,g=void 0!==g?g:0,h=void 0!==h?h:0,c=void 0!==c?c:1,l=void 0!==l?l:0,u=void 0!==u?u:5,d=void 0!==d?d:u,u+=2,d+=2;var I=new a.Z,C=new Float32Array(2*(u+d)*3),f=0,p=0,m=n/(u-1),_=A/(u-1),E=g/(u-1),v=e+n+h,S=t+A+c,B=i+g+l;for(f=0;f<u;++f)C[p=6*f]=e+m*f,C[p+1]=t+_*f,C[p+2]=i+E*f,C[p+3]=v-m*(u-f-1),C[p+4]=S-_*(u-f-1),C[p+5]=B-E*(u-f-1);for(m=h/(d-1),_=c/(d-1),E=l/(d-1),f=0;f<d;++f)C[p=6*(u+f)]=e+m*f,C[p+1]=t+_*f,C[p+2]=i+E*f,C[p+3]=v-m*(d-f-1),C[p+4]=S-_*(d-f-1),C[p+5]=B-E*(d-f-1);I.getAttributes().Vertex=new r.Z(r.Z.ARRAY_BUFFER,C,3);var w=new s.Z(o.Z.LINES,0,2*(u+d));return I.getPrimitives().push(w),I},createBoundingBoxGeometry:function(e){var t=new a.Z,i=new Float32Array([-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5]);t.getAttributes().Vertex=new r.Z(r.Z.ARRAY_BUFFER,i,3),e||(e=[1,0,0,1]);for(var n=new c.Z.Float32Array(32),s=0;s<8;s++)for(var g=0;g<4;g++)n[3*s+g]=e[g];t.getAttributes().Color=new r.Z(r.Z.ARRAY_BUFFER,n,4);var h=new c.Z.Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);return t.getPrimitives().push(new A.Z(o.Z.LINES,new r.Z("ELEMENT_ARRAY_BUFFER",h,1))),t}}},pSxj:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={RELATIVE_RF:0,ABSOLUTE_RF:1}},GoyH:(e,t,i)=>{"use strict";i.d(t,{Z:()=>C});var n=i("lZH+"),r=i.n(n),a=i("6qT5"),o=i("u5PS"),s={extend:function(){var e,t,i,n,r=window.Object.prototype.toString,a=window.Object.prototype.hasOwnProperty,o=function(e){return"[object Function]"===r.call(e)},A=s.isArray,g=function(e){if(!e||"[object Object]"!==r.call(e)||e.nodeType||e.setInterval)return!1;if(e.constructor&&!a.call(e,"constructor")&&!a.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||a.call(e,t)},h=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof h&&(u=h,h=arguments[1]||{},c=2),"object"==typeof h||o(h)||(h={}),l===c&&(h=this,--c);c<l;c++)if(null!==(e=arguments[c]))for(t in e)if(i=h[t],h!==(n=e[t]))if(u&&n&&(g(n)||A(n))){var d=i&&(g(i)||A(i))?i:A(n)?[]:{};h[t]=s.extend(u,d,n)}else void 0!==n&&(h[t]=n);return h},objectInherit:function(e){function t(){}t.prototype=e;for(var i=new t,n=1;n<arguments.length;n++)s.objectMix(i,arguments[n],!1);return i},objectMix:function(e,t,i){for(var n in t)i&&e[n]||(e[n]=t[n]);return e},objectType:{}};s.objectType.type=0,s.arrayDense=function(e,t,i){var n=t.length;if(e>=n)for(var r=n;r<=e;r++)t.push(i?i():null)},s.objectLibraryClass=function(e,t,i){e.className=function(){return i},e.libraryName=function(){return t};var n=t+"::"+i;return e.libraryClassName=function(){return n},e},s.setTypeID=function(e){var t=e.prototype.libraryClassName(),i=s.generateId(s.objectType,t);e.typeID=e.prototype.typeID=i,e.getTypeID=e.prototype.getTypeID=function(){return i}},s.createPrototypeObject=function(e,t,i,n){t.hasOwnProperty("getTypeID")&&(t=s.objectInherit(t,{})),e.prototype=t,t.constructor=e,i&&n&&(s.objectLibraryClass(t,i,n),s.setTypeID(e))},s.generateId=function(e,t){if(void 0!==e[t])return o.Z.error(t+" is already defined, change class name or library name"),-1;var i=e.type;return e[i]=t,e[t]=i,e.type+=1,i},s.objectNodeType={},s.objectNodeType.type=0,s.setNodeTypeID=function(e){var t=e.prototype.libraryClassName(),i=s.generateId(s.objectNodeType,t);e.nodeTypeID=e.prototype.nodeTypeID=i,e.getNodeTypeID=e.prototype.getNodeTypeID=function(){return i}},s.createPrototypeNode=function(e,t,n,r){var a=i("SHDx").Z,o=t.nodeTypeID;if(s.createPrototypeObject(e,t,n,r),n&&r){s.setNodeTypeID(e);var A=e.nodeTypeID;s.arrayDense(A,a.applyFunctionArray),a.registerApplyFunction(A,a.getApplyFunction(o))}};var A=0,g=0,h={},c={},l=0,u={};s.getStateAttributeTypeNameToTypeId=function(){return u},s.createPrototypeStateAttribute=function(e,t,i,n){s.createPrototypeObject(e,t,i,n);var r=s.getOrCreateStateAttributeTypeId(e);e.prototype.attributeTypeId=r},s.getMaxStateAttributeTypeID=function(){return l},s.getOrCreateStateAttributeTypeId=function(e){var t=e.prototype.getType();if(u[t])return u[t];var i=l++;return u[t]=i,i},s.getOrCreateStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateStateAttributeTypeMemberIndexFromName=function(e){var t=h[e];return void 0!==t||(t=A++,h[e]=t),t},s.getOrCreateTextureStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateTextureStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateTextureStateAttributeTypeMemberIndexFromName=function(e){var t=c[e];return void 0!==t||(t=g++,c[e]=t),t},s.getIdFromTypeMember=function(e){return h[e]},s.getTextureIdFromTypeMember=function(e){return c[e]},s.Int8Array=window.Int8Array,s.Uint8Array=window.Uint8Array,s.Uint8ClampedArray=window.Uint8ClampedArray,s.Int16Array=window.Int16Array,s.Uint16Array=window.Uint16Array,s.Int32Array=window.Int32Array,s.Uint32Array=window.Uint32Array,s.Float32Array=window.Float32Array,s.Float64Array=window.Float64Array;var d={},I={};s.logTime=(o.Z.console.time||function(e){d[e]=a.Z.instance().tick()}).bind(o.Z.console),s.logTimeEnd=(o.Z.console.timeEnd||function(e){if(void 0!==d[e]){var t=a.Z.instance().deltaM(d[e],a.Z.instance().tick());o.Z.log(e+": "+t+"ms"),d[e]=void 0}}).bind(o.Z.console),s.time=function(e,t){var i=t;void 0===i&&(i=o.Z.NOTICE),i>o.Z.getNotifyLevel()||(I[e]=1,s.logTime(e))},s.timeEnd=function(e){void 0!==I[e]&&s.logTimeEnd(e)},s.profile=(o.Z.console.profile||function(){}).bind(o.Z.console),s.profileEnd=(o.Z.console.profileEnd||function(){}).bind(o.Z.console),s.arrayUniq=function(e){for(var t=e.length,i={},n=[],r=0,a=0;a<t;a++){var o=e[a];1!==i[o]&&(i[o]=1,n[r++]=o)}return n},s.rejectObject=function(e,t){return t&&(e="Invalid json "+e+" "+Object.keys(t)),o.Z.warn(e),r().reject(e)},s.setStateAttributeConfig=function(e,t){e.stateAttributeConfig=t,t.attribute.forEach(s.getOrCreateStateAttributeTypeMemberIndexFromName),t.textureAttribute.forEach(s.getOrCreateTextureStateAttributeTypeMemberIndexFromName),e.validAttributeTypeMember=t.attribute,e.validTextureAttributeTypeMember=t.textureAttribute};const C=s},wLWJ:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("iUVs"),a=i("rfV8"),o=function(){r.Z.call(this)};o.checkPathIsAnimated=function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t];if(n instanceof a.Z)for(var r=n.getUpdateCallbackList(),s=0,A=r.length;s<A;++s)if(r[s]instanceof o)return!0}return!1},n.Z.createPrototypeObject(o,n.Z.objectInherit(r.Z.prototype,{computeChannels:function(){},reset:function(){}}),"osgAnimation","AnimationUpdateCallback");const s=o},igDg:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("GoyH"),r=i("W40i"),a=i("k3oU"),o=i("rfV8"),s=i("mix8"),A=function(e){void 0!==e&&this.setName(e),o.Z.call(this),this._invBindInSkeletonSpace=r._E.create(),this._boneInSkeletonSpace=r._E.create(),this._boneBoundingBox=new a.Z};n.Z.createPrototypeNode(A,n.Z.objectInherit(o.Z.prototype,{getOrCreateDebugColor:function(){return this._boneColor||(this.isSkinning()?this._boneColor=r.R3.fromValues(Math.random(),Math.random(),Math.random()):this._boneColor=r.R3.fromValues(.8,.8,.8)),this._boneColor},isSkinning:function(){return void 0!==this.userDataMap.rigIndex},getBoneBoundingBox:function(){return this._boneBoundingBox},setBoneBoundingBox:function(e){this._boneBoundingBox=e},getMatrixInSkeletonSpace:function(){return this._boneInSkeletonSpace},getInvBindMatrixInSkeletonSpace:function(){return this._invBindInSkeletonSpace},setMatrixInSkeletonSpace:function(e){r._E.copy(this._boneInSkeletonSpace,e)},setInvBindMatrixInSkeletonSpace:function(e){r._E.copy(this._invBindInSkeletonSpace,e)},getBoneParent:function(){for(var e=this.getParents(),t=0,i=e.length;t<i;t++){if(e[t].getTypeID()===A.getTypeID())return e[t]}},setDefaultUpdateCallback:function(e){this.addUpdateCallback(new s.Z(void 0!==e?e:this.getName()))}}),"osgAnimation","Bone");const g=A},"5LU5":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("WWMP"),a=i("64xh"),o=function(e,t){r.Z.call(this),this._nbTarget=e,this._enable=!t,this._targetNames={},this._hashNames="",this._hash="",this._dirtyHash=!0};o.uniforms={},n.Z.createPrototypeStateAttribute(o,n.Z.objectInherit(r.Z.prototype,{attributeType:"Morph",cloneType:function(){return new o(void 0,!0)},hasTarget:function(e){return!!this._targetNames[e]},copyTargetNames:function(e){for(var t=this._targetNames,i="",n=t.length=e.length,r=0;r<n;++r){var a=e[r];t[a]=!0,i+=a}this._hashNames=i,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=o,t=this.getNumTargets();return e.uniforms[t]||(e.uniforms[t]={uTargetWeights:a.Z.createFloat4("uTargetWeights")}),e.uniforms[t]},setNumTargets:function(e){this._nbTarget=e,this._dirtyHash=!0},getNumTargets:function(){return this._nbTarget},setTargetWeights:function(e){this._targetWeights=e},getTargetWeights:function(){return this._targetWeights},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this._hashNames+this.getNumTargets()+this.isEnabled()},apply:function(){this._enable&&this.getOrCreateUniforms().uTargetWeights.setFloat4(this._targetWeights)}}),"osgAnimation","MorphAttribute");const s=o},mixV:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n,r=i("GoyH"),a=i("eYxU"),o=i("u5PS"),s=i("W40i"),A=i("6Szz"),g=i("o4nZ"),h=i("5LU5"),c=i("WWMP"),l=i("k3oU"),u=function(){A.Z.call(this),this._shape=null,this._targets=[],this._stateSetAnimation=new g.Z,this._targetWeights=new Float32Array(u.MAX_MORPH_GPU),this._morphAttribute=void 0,this._morphTargetNames=void 0,this._maxMorphGPU=u.MAX_MORPH_GPU,this._isInitialized=!1};u.MAX_MORPH_GPU=4,r.Z.createPrototypeNode(u,r.Z.objectInherit(A.Z.prototype,{init:function(){return this._morphAttribute?(this._isInitialized=!0,!1):(this._morphAttribute=new h.Z(Math.min(this._maxMorphGPU,this.getMorphTargets().length)),this.getStateSetAnimation().setAttributeAndModes(this._morphAttribute,c.Z.ON),this._morphAttribute.setTargetWeights(this.getTargetsWeight()),this._targets[0]?(this._morphTargetNames=window.Object.keys(this._targets[0].getVertexAttributeList()),this._morphAttribute.copyTargetNames(this._morphTargetNames)):(this._morphTargetNames=[],o.Z.error("No Targets in the MorphGeometry !")),this._isInitialized=!0,!0)},getMaximumPossibleMorphGPU:function(){return this._maxMorphGPU},setMaximumPossibleMorphGPU:function(e){this._maxMorphGPU=e,this._isInitialized=!1,this._morphAttribute&&this._morphAttribute.setNumTargets(e)},getMorphTargetNames:function(){return this._morphTargetNames},getStateSetAnimation:function(){return this._stateSetAnimation},getMorphTargets:function(){return this._targets},isInitialized:function(){return this._isInitialized},getTargetsWeight:function(){return this._targetWeights},computeBoundingBox:(n=new l.Z,function(e){A.Z.prototype.computeBoundingBox.call(this,e);for(var t=0,i=this._targets.length;t<i;t++)e.expandByBoundingBox(this._targets[t].computeBoundingBox(n));return e}),mergeChildrenVertexAttributeList:function(){for(var e=0,t=this._targets.length;e<t;e++){var i=this._targets[e],n=i.getVertexAttributeList();for(var r in n){var o=n[r];o&&!o.getBufferArray&&(n[r]=new a.Z(o))}A.Z.appendVertexAttributeToList(i.getVertexAttributeList(),this.getVertexAttributeList(),e)}},_computeEffectiveSumWeights:function(){for(var e=0,t=this._targetWeights,i=0,n=t.length;i<n;++i){var r=t[i];Math.abs(r)<=u.EFFECTIVE_EPS||(e+=r)}var a=1e-5;return Math.abs(e)>a?e:e<0?-a:a},computeTransformedVertex:function(e,t){t=t||s.R3.create();var i=3*e,n=this._targetWeights,r=this.getVertexAttributeList(),a=r.Vertex.getElements(),o=1-this._computeEffectiveSumWeights();t[0]=o*a[i],t[1]=o*a[i+1],t[2]=o*a[i+2];for(var A=0,g=n.length;A<g;++A){var h=n[A];if(!(Math.abs(h)<=u.EFFECTIVE_EPS)){var c=r["Vertex_"+A].getElements();t[0]+=h*c[i],t[1]+=h*c[i+1],t[2]+=h*c[i+2]}}return t},computeTransformedVertices:function(){for(var e=this._targetWeights,t=this.getVertexAttributeList(),i=t.Vertex.getElements(),n=i.length,r=this._morphedVerts=this._morphedVerts||new Float32Array(n),a=1-this._computeEffectiveSumWeights(),o=0;o<n;++o)r[o]=a*i[o];for(var s=0,A=e.length;s<A;++s){var g=e[s];if(!(Math.abs(g)<=u.EFFECTIVE_EPS))for(var h=t["Vertex_"+s].getElements(),c=0;c<n;++c)r[c]+=g*h[c]}return r}}),"osgAnimation","MorphGeometry");const d=u},"5Zr1":(e,t,i)=>{"use strict";i.d(t,{Z:()=>Q});var n=i("GoyH"),r=i("W40i"),a=i("6Szz"),o=i("u5PS"),s=i("PNpA"),A=i("o4nZ"),g=i("mixV"),h=i("iUVs"),c=i("CJNH"),l=i("11nE"),u=function(){c.Z.call(this,c.Z.TRAVERSE_PARENTS),this._root=void 0,this._pathToRoot=void 0};n.Z.createPrototypeObject(u,n.Z.objectInherit(c.Z.prototype,{apply:function(e){if(!this._root)return e.typeID===l.Z.typeID?(this._root=e,void(this._pathToRoot=this.nodePath.slice(1))):void this.traverse(e)}}),"osgAnimation","FindNearestParentSkeleton");const d=u;var I=function(){h.Z.call(this)};n.Z.createPrototypeObject(I,n.Z.objectInherit(h.Z.prototype,{init:function(e){var t=new d;e.getParents().length>1&&o.Z.warn("A RigGeometry should not have multi parent ( "+e.getName()+" )"),e.getParents()[0].accept(t),t._root?(e.setSkeleton(t._root),e.setPathToSkeleton(t._pathToRoot)):o.Z.warn("A RigGeometry did not find a parent skeleton for RigGeometry ( "+e.getName()+" )")},update:function(e){if(e&&"RigGeometry"!==e.className())return!0;var t=e;return t.getSkeleton()||0===t.getParents().length||this.init(t),!t.getSkeleton()||(t.getNeedToComputeMatrix()&&t.computeMatrixFromRootSkeleton(),t.update(),!0)}}),"osgAnimation","UpdateRigGeometry");const C=I;var f=i("WWMP"),p=i("4yGu"),m=i("igDg"),_=function(){c.Z.call(this,c.Z.TRAVERSE_ALL_CHILDREN),this._boneMap={}};n.Z.createPrototypeObject(_,n.Z.objectInherit(c.Z.prototype,{apply:function(e){if(e.typeID===m.Z.typeID){var t=e.getName();t?this._boneMap[t]=e:o.Z.warn("found Bone without name")}this.traverse(e)},getBoneMap:function(){return this._boneMap}}),"osgAnimation","CollectBoneVisitor");const E=_;var v,S=function(){this._isInitialized=!1,this._bones=[]};S.prototype={computeBonePalette:function(e,t){var i=this._bones;for(var n in e){var r=t[n],a=e[n];void 0!==r&&(i[r]=a)}return i},init:function(e){var t=new E;e.getSkeleton().accept(t);var i=t.getBoneMap();this.computeBonePalette(i,e._boneNameID);var n=3*this._bones.length,r=this._skinningAttribute=new p.Z;return r.setMatrixPalette(new Float32Array(4*n)),e.getStateSetAnimation().setAttributeAndModes(r,f.Z.ON),this._isInitialized=!0,!0},computeMatrixPalette:(v=r._E.create(),function(e,t){for(var i=this._bones,n=this._skinningAttribute.getMatrixPalette(),a=0,o=0,s=i.length;o<s;o++){var A=i[o],g=A.getInvBindMatrixInSkeletonSpace(),h=A.getMatrixInSkeletonSpace();r._E.mul(v,h,g),r._E.mul(v,t,v),r._E.mul(v,v,e),n[a++]=v[0],n[a++]=v[4],n[a++]=v[8],n[a++]=v[12],n[a++]=v[1],n[a++]=v[5],n[a++]=v[9],n[a++]=v[13],n[a++]=v[2],n[a++]=v[6],n[a++]=v[10],n[a++]=v[14]}}),update:function(e){this._isInitialized||this.init(e),this.computeMatrixPalette(e.getMatrixFromSkeletonToGeometry(),e.getInvMatrixFromSkeletonToGeometry())}};const B=S;var w=i("wLWJ"),y=i("haRL"),M=function(){a.Z.call(this),this._shape=null,this.addUpdateCallback(new C),this._root=void 0,this._pathToRoot=void 0,this._isAnimatedPath=!1,this._boneNameID={},this._matrixFromSkeletonToGeometry=r._E.create(),this._invMatrixFromSkeletonToGeometry=r._E.create(),this._rigTransformImplementation=new B,this._geometry=void 0,this._stateSetAnimation=new A.Z,this._needToComputeMatrix=!0},D=r.R3.create(),b=r.R3.create();n.Z.createPrototypeNode(M,n.Z.objectInherit(a.Z.prototype,{getStateSetAnimation:function(){return this._stateSetAnimation},getSkeleton:function(){return this._root},setSkeleton:function(e){this._root=e},setPathToSkeleton:function(e){this._pathToRoot=e,this._isAnimatedPath=w.Z.checkPathIsAnimated(e)},setNeedToComputeMatrix:function(e){this._needToComputeMatrix=e},getNeedToComputeMatrix:function(){return this._needToComputeMatrix},separateStaticBoxInGeometry:function(e,t){var i=this.getBoundingBox();if(i.valid()&&!this._staticGeomAdded){this._staticGeomAdded=!0,i.center(D),r.R3.sub(b,i.getMax(),i.getMin());var n=s.Z.createTexturedBoxGeometry(D[0],D[1],D[2],b[0],b[1],b[2]);n.setName("BoneBox"),n.setName("staticBoxOf:"+this.getName());for(var a=this.getParents(),o=0;o<a.length;++o)a[o].addChild(n);n.setCullCallback(e),n.setNodeMask(t),i.init(),this.getBoundingSphere().init()}},computeBoundingBox:function(e){e.init();var t=this.getVertexAttributeList().Vertex,i=this.getVertexAttributeList().Weights;if(t&&i&&t.getElements()&&t.getItemSize()>2){for(var n=i.getElements(),r=t.getElements(),a=t.getItemSize(),o=e.getMin(),s=e.getMax(),A=o[0],g=o[1],h=o[2],c=s[0],l=s[1],u=s[2],d=0,I=0,C=r.length;d<C;d+=a,I+=4)if(0===n[d]&&0===n[d+1]&&0===n[d+2]&&0===n[d+3]){var f=r[d],p=r[d+1],m=r[d+2];f<A&&(A=f),f>c&&(c=f),p<g&&(g=p),p>l&&(l=p),m<h&&(h=m),m>u&&(u=m)}o[0]=A,o[1]=g,o[2]=h,s[0]=c,s[1]=l,s[2]=u}return e},computeMatrixFromRootSkeleton:function(){this._root?(r._E.identity(this._matrixFromSkeletonToGeometry),y.Z.computeLocalToWorld(this._pathToRoot,!0,this._matrixFromSkeletonToGeometry),r._E.invert(this._invMatrixFromSkeletonToGeometry,this._matrixFromSkeletonToGeometry),this._isAnimatedPath||(this._needToComputeMatrix=!1)):o.Z.warn("Warning "+this.className()+".computeMatrixFromRootSkeleton if you have this message it means you miss to call buildTransformer( root ), or your RigGeometry ("+this.getName()+") is not attached to a Skeleton subgraph")},getMatrixFromSkeletonToGeometry:function(){return this._matrixFromSkeletonToGeometry},getInvMatrixFromSkeletonToGeometry:function(){return this._invMatrixFromSkeletonToGeometry},getSourceGeometry:function(){return this._geometry},setSourceGeometry:function(e){this._geometry=e},getBoneNameID:function(){return this._boneNameID},setBoneNameID:function(e){this._boneNameID=e},mergeChildrenVertexAttributeList:function(){this._geometry instanceof g.Z&&this._geometry.mergeChildrenVertexAttributeList();var e=this._geometry.getVertexAttributeList();a.Z.appendVertexAttributeToList(e,this.getVertexAttributeList())},mergeChildrenData:function(){this.mergeChildrenVertexAttributeList();var e=this._geometry.getPrimitiveSetList();this.getPrimitiveSetList().length=0;for(var t=0,i=e.length;t<i;t++)this.getPrimitiveSetList()[t]=e[t];this.getStateSet()&&console.error("A stateset in the rig is already present : "+this.getStateSet()),this.setStateSet(this._geometry.getStateSet())},update:function(){this._rigTransformImplementation.update(this)},computeTransformedVertex:function(e,t){t=t||r.R3.create();var i=this.getVertexAttributeList(),n=i.Weights.getElements(),a=i.Bones.getElements(),o=0,s=0,A=0;if(this._geometry.computeTransformedVertex)this._geometry.computeTransformedVertex(e,t),o=t[0],s=t[1],A=t[2];else{var g=i.Vertex.getElements();o=g[3*e],s=g[3*e+1],A=g[3*e+2]}for(var h=4*e,c=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),l=0,u=0,d=0,I=0,C=0,f=0,p=0,m=0,_=0,E=0,v=0,S=0,B=0,w=!1,y=0;y<4;++y){var M=n[h+y];if(0!==M){var D=12*a[h+y];l+=c[D+0]*M,I+=c[D+1]*M,p+=c[D+2]*M,E+=c[D+3]*M,u+=c[D+4]*M,C+=c[D+5]*M,m+=c[D+6]*M,v+=c[D+7]*M,d+=c[D+8]*M,f+=c[D+9]*M,_+=c[D+10]*M,S+=c[D+11]*M,B+=M,w=!0}}w||(t[0]=o,t[1]=s,t[2]=A);var b=1/B;return t[0]=(l*o+I*s+p*A+E)*b,t[1]=(u*o+C*s+m*A+v)*b,t[2]=(d*o+f*s+_*A+S)*b,t},computeTransformedVertices:function(){for(var e=this.getVertexAttributeList(),t=this._geometry.computeTransformedVertices?this._geometry.computeTransformedVertices():e.Vertex.getElements(),i=e.Weights.getElements(),n=e.Bones.getElements(),r=this._riggedVerts||new Float32Array(t.length),a=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),o=0,s=0,A=t.length;o<A;o+=3,s+=4){var g,h=0,c=0,l=0,u=0,d=0,I=0,C=0,f=0,p=0,m=0,_=0,E=0,v=0,S=!1,B=i[s];0!==B&&(h+=a[(g=12*n[s])+0]*B,u+=a[g+1]*B,C+=a[g+2]*B,m+=a[g+3]*B,c+=a[g+4]*B,d+=a[g+5]*B,f+=a[g+6]*B,_+=a[g+7]*B,l+=a[g+8]*B,I+=a[g+9]*B,p+=a[g+10]*B,E+=a[g+11]*B,v+=B,S=!0),0!==(B=i[s+1])&&(h+=a[(g=12*n[s+1])+0]*B,u+=a[g+1]*B,C+=a[g+2]*B,m+=a[g+3]*B,c+=a[g+4]*B,d+=a[g+5]*B,f+=a[g+6]*B,_+=a[g+7]*B,l+=a[g+8]*B,I+=a[g+9]*B,p+=a[g+10]*B,E+=a[g+11]*B,v+=B,S=!0),0!==(B=i[s+2])&&(h+=a[(g=12*n[s+2])+0]*B,u+=a[g+1]*B,C+=a[g+2]*B,m+=a[g+3]*B,c+=a[g+4]*B,d+=a[g+5]*B,f+=a[g+6]*B,_+=a[g+7]*B,l+=a[g+8]*B,I+=a[g+9]*B,p+=a[g+10]*B,E+=a[g+11]*B,v+=B,S=!0),0!==(B=i[s+3])&&(h+=a[(g=12*n[s+3])+0]*B,u+=a[g+1]*B,C+=a[g+2]*B,m+=a[g+3]*B,c+=a[g+4]*B,d+=a[g+5]*B,f+=a[g+6]*B,_+=a[g+7]*B,l+=a[g+8]*B,I+=a[g+9]*B,p+=a[g+10]*B,E+=a[g+11]*B,v+=B,S=!0);var w=t[o],y=t[o+1],M=t[o+2];if(S){var D=1/v;r[o]=(h*w+u*y+C*M+m)*D,r[o+1]=(c*w+d*y+f*M+_)*D,r[o+2]=(l*w+I*y+p*M+E)*D}else r[o]=w,r[o+1]=y,r[o+2]=M}return r}}),"osgAnimation","RigGeometry");const Q=M},"11nE":(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n=i("GoyH"),r=i("rfV8"),a=i("DZjg"),o=i("CJNH"),s=i("U5Vy"),A=i("igDg"),g=function(){o.Z.call(this,o.Z.TRAVERSE_ALL_CHILDREN)};n.Z.createPrototypeObject(g,n.Z.objectInherit(o.Z.prototype,{apply:function(e){if(e.getTypeID()===A.Z.getTypeID()){var t=e.getUpdateCallback();if(t instanceof s.Z){for(var i=t._stackedTransforms,n=0,r=i.length;n<r;n++){i[n].resetToDefaultValue()}t.computeChannels()}}this.traverse(e)}}),"osgAnimation","ResetRestPoseVisitor");var h=new g,c=function(){r.Z.call(this)};n.Z.createPrototypeNode(c,n.Z.objectInherit(r.Z.prototype,{setDefaultUpdateCallback:function(){this.addUpdateCallback(new a.Z)},setRestPose:function(){this.accept(h)}}),"osgAnimation","Skeleton");const l=c},"4yGu":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("WWMP"),a=i("64xh"),o=function(e,t){r.Z.call(this),this._enable=!e,this._boneUniformSize=t,this._dirtyHash=!0,this._hash=""};o.uniforms={},o.maxBoneUniformSize=1,o.maxBoneUniformAllowed=1/0,n.Z.createPrototypeStateAttribute(o,n.Z.objectInherit(r.Z.prototype,{attributeType:"Skinning",cloneType:function(){return new o(!0)},getBoneUniformSize:function(){return void 0!==this._boneUniformSize?this._boneUniformSize:o.maxBoneUniformSize},getOrCreateUniforms:function(){var e=o,t=this.getBoneUniformSize();return e.uniforms[t]||(e.uniforms[t]={uBones:a.Z.createFloat4Array("uBones",t)}),e.uniforms[t]},setMatrixPalette:function(e){this._matrixPalette=e,void 0===this._boneUniformSize&&(o.maxBoneUniformSize=Math.max(o.maxBoneUniformSize,e.length/4),o.maxBoneUniformSize=Math.min(o.maxBoneUniformAllowed,o.maxBoneUniformSize))},getMatrixPalette:function(){return this._matrixPalette},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!0,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getBoneUniformSize()+this.isEnabled()},apply:function(){this._enable&&this.getOrCreateUniforms().uBones.getInternalArray().set(this._matrixPalette)}}),"osgAnimation","SkinningAttribute");const s=o},mix8:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n=i("GoyH"),r=i("u5PS"),a=i("U5Vy"),o=i("W40i"),s=i("CJNH"),A=function(){a.Z.call(this)};n.Z.createPrototypeObject(A,n.Z.objectInherit(a.Z.prototype,{update:function(e,t){if(t.getVisitorType()===s.Z.UPDATE_VISITOR){if(e.className&&"Bone"!==e.className())return r.Z.warn("Warning: UpdateBone set on non-Bone object."),!1;var i=e;a.Z.prototype.update.call(this,e),i.setMatrix(i.getMatrix());var n=i.getMatrix(),A=i.getBoneParent();A?o._E.mul(i.getMatrixInSkeletonSpace(),A.getMatrixInSkeletonSpace(),n):i.setMatrixInSkeletonSpace(n)}return!0}}),"osgAnimation","UpdateBone");const g=A},U5Vy:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("W40i"),a=i("wLWJ"),o=function(){a.Z.call(this),this._stackedTransforms=[],this._matrix=r._E.create(),this._dirty=!1};n.Z.createPrototypeObject(o,n.Z.objectInherit(a.Z.prototype,{getStackedTransforms:function(){return this._stackedTransforms},setMatrix:function(e){r._E.copy(this._matrix,e),this._dirty=!0},getMatrix:function(){return this._matrix},computeChannels:function(){this._dirty=!0;var e=this._matrix;r._E.identity(e);for(var t=this._stackedTransforms,i=0,n=t.length;i<n;i++){t[i].applyToMatrix(e)}},reset:function(){for(var e=this._stackedTransforms,t=0,i=e.length;t<i;t++)e[t].resetToDefaultValue();this.computeChannels()},update:function(e){return r._E.copy(e.getMatrix(),this._matrix),this._dirty&&(e.dirtyBound(),this._dirty=!1),!0}}),"osgAnimation","UpdateMatrixTransform");const s=o},DZjg:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("GoyH"),r=i("igDg"),a=i("CJNH"),o=i("u5PS"),s=i("iUVs"),A=function(){a.Z.call(this)};n.Z.createPrototypeObject(A,n.Z.objectInherit(a.Z.prototype,{apply:function(e){if(e.getTypeID()===r.Z.getTypeID()){for(var t=!1,i=e.getChildren(),n=0,a=e.getChildren().length;n<a;n++){if(i[n].getTypeID()===r.Z.getTypeID()){if(t)return void o.Z.warn("Warning: a Bone was found after a non-Bone child within a Skeleton. Children of a Bone must be ordered with all child Bones first for correct update order.")}else t=!0}this.traverse(e)}}}),"osgAnimation","ValidateSkeletonVisitor");var g=function(e,t){return(e instanceof r.Z?0:1)-(t instanceof r.Z?0:1)},h=function(){this._needValidate=!0};n.Z.createPrototypeObject(h,n.Z.objectInherit(s.Z.prototype,{needToValidate:function(){return this._needValidate},update:function(e,t){if(this._needValidate&&t.getVisitorType()===a.Z.UPDATE_VISITOR&&e.className&&"Skeleton"===e.className()){for(var i=new A,n=e.getChildren(),r=0,o=n.length;r<o;r++){n[r].accept(i)}n.sort(g),this._needValidate=!1}return!0}}),"osgAnimation","UpdateSkeleton");const c=h},LvhW:(e,t,i)=>{"use strict";i.d(t,{Z:()=>C});var n=i("lZH+"),r=i.n(n),a=i("GoyH"),o=i("CJNH"),s=i("+jyg"),A=i("6qT5"),g=function(){o.Z.call(this,o.Z.TRAVERSE_ALL_CHILDREN),this._activePagedLODList=void 0,this._frameNumber=0};a.Z.createPrototypeObject(g,a.Z.objectInherit(o.Z.prototype,{apply:function(e){e.getTypeID()===s.Z.getTypeID()&&(e.setFrameNumberOfLastTraversal(this._frameNumber),this._activePagedLODList.add(e)),this.traverse(e)},set:function(e,t){this._activePagedLODList=e,this._frameNumber=t}}),"osgDB","FindPagedLODsVisitor");var h=function(){o.Z.call(this,o.Z.TRAVERSE_ALL_CHILDREN)};a.Z.createPrototypeObject(h,a.Z.objectInherit(o.Z.prototype,{apply:function(e){e.releaseGLObjects(),this.traverse(e)}}),"osgDB","ReleaseVisitor");var c=function(){o.Z.call(this,o.Z.TRAVERSE_ALL_CHILDREN),this._childrenList=[]};a.Z.createPrototypeObject(c,a.Z.objectInherit(o.Z.prototype,{apply:function(e){e.getTypeID()===s.Z.getTypeID()&&(this._childrenList.push(e),this._markRequestsExpired(e)),this.traverse(e)},removeExpiredChildrenAndFindPagedLODs:function(e,t,i,n){if(!e.children.length)return!1;var r=n.length;e.removeExpiredChildren(t,i,n);for(var a=r;a<n.length;a++)n[a].accept(this);return r!==n.length},_markRequestsExpired:function(e){for(var t,i=e._perRangeDataList.length,n=0;n<i;n++)void 0!==(t=e.getDatabaseRequest(n))&&(t._groupExpired=!0,t._loadedModel=null)},reset:function(){this._childrenList.length=0}}),"osgDB","ExpiredPagedLODVisitor");var l=function(e,t){return t._timeStamp-e._timeStamp},u=function(e,t){var i=e._timeStamp-t._timeStamp;return 0===i&&(i=e._priority-t._priority),i},d=function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._progressCallback=void 0,this._lastCB=!0,this._activePagedLODList=new Set,this._childrenToRemoveList=new Set,this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._releaseVisitor=new h,this._expiredPagedLODVisitor=new c,this._findPagedLODsVisitor=new g,this._targetMaximumNumberOfPagedLOD=75,this._elapsedTime=0,this._beginTime=0,this._availableTime=0},I=function(){this._loadedModel=void 0,this._group=void 0,this._url=void 0,this._function=void 0,this._timeStamp=0,this._groupExpired=!1,this._priority=0};a.Z.createPrototypeObject(d,{setTargetMaximumNumberOfPageLOD:function(e){this._targetMaximumNumberOfPagedLOD=e},getTargetMaximumNumberOfPageLOD:function(){return this._targetMaximumNumberOfPagedLOD},setAcceptNewDatabaseRequests:function(e){this._acceptNewRequests=e},getAcceptNewDatabaseRequests:function(){return this._acceptNewRequests},reset:function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._lastCB=!0,this._activePagedLODList.clear(),this._childrenToRemoveList.clear(),this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._targetMaximumNumberOfPagedLOD=75},updateSceneGraph:function(e){void 0!==this._progressCallback&&this.executeProgressCallback(),this.removeExpiredSubgraphs(e,.0025),this.takeRequests(),this.addLoadedDataToSceneGraph(e,.005)},executeProgressCallback:function(){this._pendingRequests.length>0||this._pendingNodes.length>0?(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!1):this._lastCB||(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!0)},setMaxRequestsPerFrame:function(e){this._maxRequestsPerFrame=e},getMaxRequestsPerFrame:function(){return this._maxRequestsPerFrame},getRequestListSize:function(){return this._pendingRequests.length+this._downloadingRequestsNumber},setProgressCallback:function(e){this._progressCallback=e},addLoadedDataToSceneGraph:function(e,t){if(!this._pendingNodes.length||t<=0)return 0;var i=0,n=A.Z.instance().tick();this._pendingNodes.sort(l);for(var r=0;r<this._pendingNodes.length;r++){if(i>t)return 0;var a=this._pendingNodes.shift(),o=e.getFrameNumber(),s=e.getSimulationTime();if(!1===a._groupExpired){var g=a._group;g.setTimeStamp(g.children.length,s),g.setFrameNumber(g.children.length,o),g.addChildNode(a._loadedModel),this._activePagedLODList.has(g)?this.registerPagedLODs(a._loadedModel,o):this.registerPagedLODs(g,o)}else a._loadedModel=void 0,a=void 0;i=A.Z.instance().deltaS(n,A.Z.instance().tick())}return t-=i},isLoading:function(){return this._loading},registerPagedLODs:function(e,t){e&&(this._findPagedLODsVisitor.set(this._activePagedLODList,t),e.accept(this._findPagedLODsVisitor))},requestNodeFile:function(e,t,i,n,r){if(this._acceptNewRequests){var a=new I;return a._group=i,a._function=e,a._url=t,a._timeStamp=n,a._priority=r,this._pendingRequests.push(a),a}},takeRequests:function(){if(this._pendingRequests.length){var e=Math.min(this._maxRequestsPerFrame,this._pendingRequests.length);this._pendingRequests.sort(u);for(var t=0;t<e;t++)this._downloadingRequestsNumber++,this.processRequest(this._pendingRequests.shift())}},processRequest:function(e){this._loading=!0;var t=this;if(e._groupExpired)return t._downloadingRequestsNumber--,void(this._loading=!1);void 0!==e._function?this.loadNodeFromFunction(e._function,e._group).then((function(i){t._downloadingRequestsNumber--,e._loadedModel=i,t._pendingNodes.push(e),t._loading=!1})):""!==e._url&&this.loadNodeFromURL(e._url).then((function(i){t._downloadingRequestsNumber--,e._loadedModel=i,t._pendingNodes.push(e),t._loading=!1}))},loadNodeFromFunction:function(e,t){var i=e(t);return i?i&&i.then?i:r().resolve(i):r().reject()},loadNodeFromURL:function(e){return i("Hiiq").Z.readNodeURL(e)},releaseGLExpiredSubgraphs:function(e){return this._availableTime=e,!this._childrenToRemoveList.size||e<=0?0:(this._elapsedTime=0,this._beginTime=A.Z.instance().tick(),this._childrenToRemoveList.forEach(this._releaseExpiredSubgraphs,this),this._availableTime-=this._elapsedTime,this._availableTime)},_releaseExpiredSubgraphs:function(e){this._elapsedTime>this._availableTime||(this._childrenToRemoveList.delete(e),e.accept(this._releaseVisitor),e.removeChildren(),e=null,this._elapsedTime=A.Z.instance().deltaS(this._beginTime,A.Z.instance().tick()))},removeExpiredSubgraphs:function(e,t){if(0===e.getFrameNumber())return 0;var i=this._activePagedLODList.size-this._targetMaximumNumberOfPagedLOD,n=e.getSimulationTime()-.1,r=e.getFrameNumber()-1;return i>0&&(t=this.removeExpiredChildren(i,n,r,t)),t},removeExpiredChildren:function(e,t,i,n){var r=0,a=A.Z.instance().tick(),o=this,s=[],g=this._expiredPagedLODVisitor;return g.reset(),this._activePagedLODList.forEach((function(h){if(r>n)return 0;if(e<0)return n;if(i<h.getFrameNumberOfLastTraversal())return n;g.removeExpiredChildrenAndFindPagedLODs(h,t,i,s);for(var c=0;c<g._childrenList.length;c++)o._activePagedLODList.delete(g._childrenList[c]),e--;for(c=0;c<s.length;c++)o._childrenToRemoveList.add(s[c]);g._childrenList.length=0,s.length=0,r=A.Z.instance().deltaS(a,A.Z.instance().tick())})),n-=r}},"osgDB","DatabasePager");const C=d},RqNa:(e,t,i)=>{"use strict";i.d(t,{Z:()=>_});var n=i("lZH+"),r=i.n(n),a=i("GoyH"),o=i("I50a"),s=i("dPdN");const A={prefixURL:"",databasePath:"",progressXHRCallback:void 0,readNodeURL:void 0,readImageURL:void 0,readBinaryArrayURL:void 0,imageLoadingUsePromise:!0,imageOnload:void 0,imageCrossOrigin:void 0};var g,h=i("pwEu"),c=i("u5PS"),l=i("uHj6"),u=i("UqX1"),d=i("Z4fc"),I=i("Q/WO"),C=i("1PKS"),f=i("907W"),p=a.Z.rejectObject,m=function(e,t){this._json=e;var i=t;void 0===i&&(i={}),this._identifierMap=i,this._objectRegistry={},this._cacheReadObject={},this.setOptions(a.Z.objectMix({},A))};m.imageFallback||(m.imageFallback=((g=new window.Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII=",g)),m.prototype={clone:function(){var e=new m;return e._objectRegistry=this._objectRegistry,e._cacheReadObject=this._cacheReadObject,e},setOptions:function(e){this._defaultOptions=e},getOptions:function(){return this._defaultOptions},setProgressXHRCallback:function(e){this._defaultOptions.progressXHRCallback=e},setReadNodeURLCallback:function(e){this._defaultOptions.readNodeURL=e},registerObject:function(e,t){this._objectRegistry[e]=t},getJSON:function(){return this._json},setJSON:function(e){return this._json=e,this},setPrefixURL:function(e){this._defaultOptions.prefixURL=e},getPrefixURL:function(){return this._defaultOptions.prefixURL},setDatabasePath:function(e){this._defaultOptions.databasePath=e},getDatabasePath:function(){return this._defaultOptions.databasePath},computeURL:function(e){return"string"==typeof this._defaultOptions.prefixURL&&this._defaultOptions.prefixURL.length>0?this._defaultOptions.prefixURL+e:e},requestFile:function(e,t){return s.Z.requestURI(e,t)},getObjectWrapper:function(e){if(this._objectRegistry[e])return new this._objectRegistry[e];for(var t=o.Z,i=e.split("."),n=0,r=i.length;n<r;n++){var a=t[i[n]];if(void 0===a)return;t=a}return this._objectRegistry[e]=t,new t},fetchImage:function(e,t,i){var n="data:image/",a=t.substring(0,n.length)===n,o=new window.Image;return!a&&i.imageCrossOrigin&&(o.crossOrigin=i.imageCrossOrigin),e.setURL(t),e.setImage(o),o.src=t,new(r())((function(n){o.onerror=function(){c.Z.warn("warning use white texture as fallback instead of "+t),e.setImage(m.imageFallback),n(e)},o.onload=function(){i.imageOnload&&i.imageOnload.call(e),n(e)}}))},readImageURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readImageURL)return t.readImageURL.call(this,e,t);"data:image"!==e.substr(0,10)&&(e=this.computeURL(e));var i=new l.Z;return this.fetchImage(i,e,t)},readNodeURL:function(e,t){var n=t;if(void 0===n&&(n=this._defaultOptions),n.readNodeURL)return n.readNodeURL.call(this,e,n);e=this.computeURL(e);var r=this;if(!(n=a.Z.objectMix({},n)).prefixURL){var o=r.getPrefixURL(),s=e.lastIndexOf("/");-1!==s&&(o=e.substring(0,s+1)),n.prefixURL=o}var A=i("Hiiq").Z,g=function(t){return A.parseSceneGraph(t,n).then((function(t){return c.Z.log("loaded "+e),t}))};return a.Z.time("osgjs.metric:Input.readNodeURL",c.Z.INFO),r.requestFile(e).then((function(t){var i;try{i=JSON.parse(t)}catch(t){c.Z.error("cant parse url "+e+" try to gunzip")}return i?g(i):r.requestFile(e,{responseType:"arraybuffer"}).then((function(e){var t,n,r=(n=t=e,h.Z.isGunzipBuffer(t)&&(n=h.Z.gunzip(t)),function(e){for(var t,i="",n=0,r=e.length;n<r;++n)i+="%"+((t=e[n].toString(16)).length<2?"0"+t:t);return decodeURIComponent(i)}(new Uint8Array(n)));return i=JSON.parse(r),g(i)})).catch((function(t){var i="cant read file "+e+" status "+t;return c.Z.error(i),i}))})).catch((function(t){var i="cant get file "+e+" status "+t;return c.Z.error(i),i})).finally((function(){a.Z.timeEnd("osgjs.metric:Input.readNodeURL")}))},_unzipTypedArray:function(e){var t=new Uint8Array(e);if(31===t[0]&&139===t[1]){var n=i("zpE6");return n||c.Z.error("osg failed to use a gunzip.min.js to uncompress a gz file.\n You can add this vendors to enable this feature or adds the good header in your gzip file served by your server"),new n.Gunzip(t).decompress().buffer}return e},readBinaryArrayURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readBinaryArrayURL)return t.readBinaryArrayURL.call(this,e,t);if(e=this.computeURL(e),void 0!==this._identifierMap[e])return this._identifierMap[e];var i=this.requestFile(e,{responseType:"arraybuffer",progress:this._defaultOptions.progressXHRCallback}),n=this;return this._identifierMap[e]=i.then((function(e){return n._unzipTypedArray(e)})),this._identifierMap[e]},initializeBufferArray:function(e,t,i,n){if(void 0===n&&(n=this.getOptions()),n.initializeBufferArray)return n.initializeBufferArray.call(this,e,t,i);var r=e.File;return this.readBinaryArrayURL(r).then((function(n){var r,o,s,A;s=new Uint8Array([18,52]),A=new Uint16Array(s.buffer),o="1234"===A[0].toString(16);var g=0;void 0!==e.Offset&&(g=e.Offset);var h=a.Z[t].BYTES_PER_ELEMENT,l=e.Size,u=i.getItemSize(),d=l*h*u;if(o){c.Z.log("big endian detected");var I=new(0,a.Z[t])(l*u),C=new DataView(n,g,d),f=0,p=I.length;if("Uint16Array"===t)for(;f<p;f++)I[f]=C.getUint16(f*h,!0);else if("Float32Array"===t)for(;f<p;f++)I[f]=C.getFloat32(f*h,!0);r=I,C=null}else r=new a.Z[t](n,g,u*l);return i.setElements(r),i}))},readBufferArray:function(e){var t,i,n=this.getJSON(),o=n.UniqueID;if(void 0!==o&&void 0!==(t=this._identifierMap[o]))return t;if(void 0===e&&(e=this.getOptions()),e.readBufferArray)return e.readBufferArray.call(this);if(!n.Elements&&!n.Array||!n.ItemSize||!n.Type)return p("BufferArray",n);if(n.Elements)i=r().resolve(new u.Z(u.Z[n.Type],n.Elements,n.ItemSize));else if(n.Array){var s,A,g=new u.Z(u.Z[n.Type]);if(g.setItemSize(n.ItemSize),n.Array.Float32Array?(s=n.Array.Float32Array,A="Float32Array"):n.Array.Uint16Array?(s=n.Array.Uint16Array,A="Uint16Array"):n.Array.Uint8Array&&(s=n.Array.Uint8Array,A="Uint8Array"),void 0===s)return p("Typed Array "+window.Object.keys(n.Array)[0]);s.File?i=this.initializeBufferArray(s,A,g):s.Elements&&(g.setElements(new a.Z[A](s.Elements)),i=r().resolve(g))}return void 0!==o&&(this._identifierMap[o]=i),i},readUserDataContainer:function(){var e,t=this.getJSON(),i=t.UniqueID;return void 0!==i&&void 0!==(e=this._identifierMap[i])?e.Values:(this._identifierMap[i]=t,t.Values)},readPrimitiveSet:function(){var e,t,i,n,a,o,s,A=this.getJSON(),g=A.DrawElementUShort||A.DrawElementUByte||A.DrawElementUInt||A.DrawElementsUShort||A.DrawElementsUByte||A.DrawElementsUInt,h=A.DrawArray||A.DrawArrays,c=A.DrawArrayLengths;if(g){if(void 0!==(e=g.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=g.Mode?f.Z[g.Mode]:f.Z.TRIANGLES,n=new C.Z(a),this.setJSON(g.Indices),i=this.readBufferArray().then((function(e){return n.setIndices(e),n})),this.setJSON(A)}else if(h){if(void 0!==(e=h.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=h.Mode||h.mode,o=void 0!==h.First?h.First:h.first,s=void 0!==h.Count?h.Count:h.count,n=new d.Z(f.Z[a],o,s),i=r().resolve(n)}else if(c){if(void 0!==(e=c.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=c.Mode,o=c.First;var l=c.ArrayLengths;n=new I.Z(f.Z[a],o,l),i=r().resolve(n)}else i=p("PrimitiveSet",A);return void 0!==e&&(this._identifierMap[e]=i),i},readObject:function(){var e=this.getJSON(),t=window.Object.keys(e),n=t[0];if(!n)return p("can't find property for object "+t);var r,a=e[n].UniqueID;if(void 0!==a&&void 0!==(r=this._identifierMap[a]))return r;var o=this.getObjectWrapper(n);if(!o)return p("can't instanciate object "+n);var s=i("Hiiq").Z.ObjectWrapper.serializers;if(this._cacheReadObject[n])s=this._cacheReadObject[n];else{for(var A=n.split("."),g=0,h=A.length;g<h;g++){var c=A[g],l=s[c];if(!l)return p("Unknown scope "+n+"("+c+")");s=l}this._cacheReadObject[n]=s}var u=s(this.setJSON(e[n]),o);return void 0!==a&&(this._identifierMap[a]=u,o._uniqueID=a),u}};const _=m},sSQ9:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("u5PS"),r={instance:function(){return r._instance||(r._instance=r,r._instance.plugins=new window.Map),r._instance},addReaderWriter:function(e,t){void 0!==r.instance().plugins.get(e)&&n.Z.warn("the '"+e+"' plugin already exists"),r.instance().plugins.set(e,t)},getReaderWriterForExtension:function(e){return r.instance().plugins.get(e)}};const a=r},dPdN:(e,t,i)=>{"use strict";i.d(t,{Z:()=>m});var n=i("lZH+"),r=i.n(n),a=i("Hiiq"),o=i("sSQ9"),s=i("1Xhw"),A=i("u5PS"),g=function(e){return"string"==typeof e||e instanceof String},h=window.zip,c=new window.Map,l=function(e){return new(r())((function(t,i){var n=new window.Image;n.onerror=function(){i(n)},n.onload=function(){t(n)},n.src=e}))},u=function(e){var t=window.URL.createObjectURL(e),i=l(t);return i.finally((function(){window.URL.revokeObjectURL(t)})),i},d=function(e){return new(r())((function(t,i){var n=new window.FileReader;n.onerror=function(){i(n)},n.onload=function(){t(this.result)},n.readAsArrayBuffer(e)}))},I=function(e){return(0,s.Z)(e,{responseType:"arraybuffer"})},C=function(e){return(0,s.Z)(e).then((function(e){return JSON.parse(e)}))},f=function(e){var t=JSON.parse(e);return r().resolve(t)},p={createJSONFromURL:C,createArrayBufferFromURL:I,createArrayBufferFromBlob:d,createImageFromBlob:u,createImageFromURL:l,requestURI:s.Z,requestResource:function(e,t){var i=p.getExtension(e),n=p.getMimeType(i);if(t&&t.responseType?t.responseType.toLowerCase():void 0)return(0,s.Z)(e,t);if(n){if(n.match("image"))return l(e);if(n.match("binary"))return I(e);if(n.match("json"))return C(e);if(n.match("text"))return(0,s.Z)(e)}return(0,s.Z)(e)},resolveData:function(e,t){var i,n,a=p.getExtension(e),o=p.getMimeType(a);return o&&(o.match("image")?g(t)?i=l:t instanceof window.Blob&&(i=u):o.match("json")?i=g(n=t)&&(function(e){return"blob:http"===e.substr(0,9)}(n)||function(e){return"http://"===e.substr(0,7)||"https://"===e.substr(0,8)}(n))?C:f:o.match("binary")&&(g(t)?i=I:t instanceof window.Blob&&(i=d))),i?i(t):r().resolve(t)},resolveFilesMap:function(e){var t=[];for(var i in e){var n=e[i],a=p.resolveData(i,n).then(function(e,t){this[e]=t}.bind(e,i));t.push(a)}return r().all(t).then((function(){return e}))},_unzipEntry:function(e){return new(r())((function(t){var i=e.filename,n=p.getExtension(i),r=p.getMimeType(n),a=h.BlobWriter;null===r.match("text")&&null===r.match("json")||(a=h.TextWriter),e.getData(new a(r),(function(e){t({filename:i,data:e})}))}))},unzipBlob:function(e){return new(r())((function(t,i){var n={},a=[];h.createReader(new h.BlobReader(e),(function(e){e.getEntries((function(i){for(var o=0;o<i.length;o++)if(!i[o].directory){var s=p._unzipEntry(i[o]);s.then((function(e){n[e.filename]=e.data})),a.push(s)}r().all(a).then((function(){e.close(),p.resolveFilesMap(n).then((function(e){t(e)}))}))}))}),(function(){i(this)}))}))},unzip:function(e){if(!window.zip)return r().reject("missing deps to unzip, require https://github.com/gildas-lormeau/zip.js");if(g(e))return p.requestResource(e).then((function(e){var t=new window.Blob([e],{type:c.get("zip")});return p.unzipBlob(t)}));if(e instanceof window.Blob)return p.unzipBlob(e);if(e instanceof window.ArrayBuffer){var t=new window.Blob([e],{type:c.get("zip")});return p.unzipBlob(t)}return r().reject("cant unzip input")},readFileList:function(e){var t,i,n={},A=[];for(i=0;i<e.length;++i){var g=p.getExtension(e[i].name);void 0===o.Z.instance().getReaderWriterForExtension(g)&&"osgjs"!==g||(t=e[i].name);var h,c=p.getMimeType(g);h=c.match("image")?"blob":c.match("json")||c.match("text")?"string":"arraybuffer",A.push((0,s.Z)(e[i],{responseType:h}))}return r().all(A).then((function(r){for(i=0;i<r.length;++i)n[e[i].name]=r[i];return p.resolveFilesMap(n).then((function(e){return a.Z.readNodeURL(t,{filesMap:e})}))}))},getMimeType:function(e){return c.get(e)},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1)},addMimeTypeForExtension:function(e,t){void 0!==c.has(e)&&A.Z.warn("the '"+e+"' already has a mimetype: "+c.get(e)),c.set(e,t)}};c.set("bin","application/octet-binary"),c.set("b3dm","application/octet-binary"),c.set("glb","application/octet-binary"),c.set("zip","application/octet-binary"),c.set("gz","application/octet-binary"),c.set("png","image/png"),c.set("jpg","image/jpeg"),c.set("jpeg","image/jpeg"),c.set("gif","image/gif"),c.set("json","application/json"),c.set("gltf","application/json"),c.set("osgjs","application/json"),c.set("txt","text/plain"),c.set("glsl","text/plain");const m=p},Hiiq:(e,t,i)=>{"use strict";i.d(t,{Z:()=>m});var n=i("u5PS"),r=i("GoyH"),a=i("64xh"),o=i("f7MS"),s=i("6Szz"),A=i("UqX1"),g=i("907W"),h=i("Z4fc"),c=i("1PKS"),l=i("o4nZ"),u=i("IpZ9"),d=i("W40i"),I=i("rfV8"),C=i("WMIH"),f=i("sSQ9"),p={ObjectWrapper:{}};p.ObjectWrapper.serializers={},p.readImage=function(e,t){return p.registry().readImageURL(e,t)},p.readImageURL=p.readImage,p.readBinaryArrayURL=function(e,t){return p.registry().readBinaryArrayURL(e,t)},p.readNodeURL=function(e,t){var i=e.substr(e.lastIndexOf(".")+1),n=f.Z.instance().getReaderWriterForExtension(i);return void 0!==n?n.readNodeURL(e,t):p.registry().readNodeURL(e,t)},p.registry=function(){var e=i("RqNa").Z;return void 0===p.registry._input&&(p.registry._input=new e),p.registry._input},p.parseSceneGraph=function(e,t){if(!(void 0!==e.Version&&e.Version>0)){r.Z.time("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",n.Z.INFO);var i=p.parseSceneGraphDeprecated(e);return r.Z.timeEnd("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",n.Z.INFO),i}var a;for(var o in r.Z.time("osgjs.metric:ReaderParser.parseSceneGraph",n.Z.INFO),e)if("Generator"!==o&&"Version"!==o){a=o;break}if(a){var s={};s[a]=e[a];var A=p.registry().clone();A.setJSON(s);var g=r.Z.objectMix(r.Z.objectMix({},p.registry().getOptions()),t||{});A.setOptions(g);var h=A.readObject();return r.Z.timeEnd("osgjs.metric:ReaderParser.parseSceneGraph",n.Z.INFO),h}n.Z.log("can't parse scenegraph "+e,n.Z.INFO)},p.parseSceneGraphDeprecated=function(e){var t,f=function(e,t){var i=t[e];return void 0===i&&(i=t[e.toLowerCase()]),i},m=function(e,t){var i=f("Name",t);i&&void 0!==e.setName&&e.setName(i)},_=function(e,t){var i=t.MagFilter||t.mag_filter||void 0;i&&e.setMagFilter(i);var r=t.MinFilter||t.min_filter||void 0;r&&e.setMinFilter(r);var a=t.WrapT||t.wrap_t||void 0;a&&e.setWrapT(a);var o=t.WrapS||t.wrap_s||void 0;o&&e.setWrapS(o);var s=f("File",t);p.readImage(s).then((function(t){e.setImage(t)})).catch((function(){n.Z.log("Can't read image")}))},E=e.children,v=e._primitives||e.primitives||e.Primitives||void 0,S=e._attributes||e.attributes||e.Attributes||void 0;if(v||S){var B=new s.Z;m(B,e),B.stateset=e.stateset,e=B;for(var w=0,y=v.length;w<y;w++){var M=v[w].mode;if(v[w].indices){var D=v[w].indices;D=new A.Z(A.Z[D.type],D.elements,D.itemSize),M=M?g.Z[M]:"TRIANGLES",B.getPrimitiveSetList().push(new c.Z(M,D))}else{M=g.Z[M];var b=v[w].first,Q=v[w].count;B.getPrimitiveSetList().push(new h.Z(M,b,Q))}}for(var x in S){var T=S[x];B.getVertexAttributeList()[x]=new A.Z(T.type,T.elements,T.itemSize)}}var F=f("StateSet",e);if(F){var R=new l.Z;!function(e,t){m(e,t);var r=f("Textures",t)||f("TextureAttributeList",t)||void 0;if(r)for(var s=0,A=r.length;s<A;s++)if(f("File",r[s])){var g=new(0,i("5rJd").Z);_(g,r[s]),e.setTextureAttributeAndModes(s,g),e.addUniform(a.Z.createInt1(s,"Texture"+s))}else n.Z.log("no texture on unit "+s+" skip it");var h=f("BlendFunc",t);if(h){var c=new o.Z;!function(e,t){m(e,t),e.setSourceRGB(t.SourceRGB),e.setSourceAlpha(t.SourceAlpha),e.setDestinationRGB(t.DestinationRGB),e.setDestinationAlpha(t.DestinationAlpha)}(c,h),e.setAttributeAndModes(c)}var l=f("Material",t);if(l){var u=new(0,i("P3GF").Z);!function(e,t){m(e,t),e.setAmbient(f("Ambient",t)),e.setDiffuse(f("Diffuse",t)),e.setEmission(f("Emission",t)),e.setSpecular(f("Specular",t)),e.setShininess(f("Shininess",t))}(u,l),e.setAttributeAndModes(u)}}(R,F),e.stateset=R}var N=e.matrix||e.Matrix||void 0;N&&(t=new I.Z,m(t,e),r.Z.extend(t,e),d._E.copy(t.getMatrix(),N),e=t);var L=e.projection||e.Projection||void 0;if(L&&(t=new C.Z,m(t,e),r.Z.extend(t,e),d._E.copy(t.setProjectionMatrix(),L),e=t),void 0===e.typeID&&(t=new u.Z,m(t,e),r.Z.extend(t,e),e=t),E){e.children=[];for(var k=0,P=E.length;k<P;k++)e.addChild(p.parseSceneGraphDeprecated(E[k]))}return e};const m=p},"1Xhw":(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("lZH+"),r=i.n(n);const a=function(e,t){return"string"==typeof e?function(e,t){return new(r())((function(i,n){var r=new XMLHttpRequest;r.open("GET",e,!0);var a=t&&t.responseType?t.responseType.toLowerCase():void 0;a&&(r.responseType=a),t&&t.progress&&r.addEventListener("progress",t.progress,!1),r.addEventListener("error",n,!1),r.addEventListener("load",(function(){"arraybuffer"===r.responseType||"blob"===r.responseType?i(r.response):i(r.responseText)})),r.send(null)}))}(e,t):function(e,t){return new(r())((function(i){var n=t&&t.responseType?t.responseType.toLowerCase():void 0,r=new window.FileReader;r.onload=function(e){i(e.target.result)},n?"arraybuffer"===n?r.readAsArrayBuffer(e):"blob"===n?i(e):"string"===n?r.readAsText(e):r.readAsDataURL(e):r.readAsText(e)}))}(e,t)}},pwEu:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i("u5PS");const r={isGunzipBuffer:function(e){var t=new Uint8Array(e);return 31===t[0]&&139===t[1]},gunzip:function(e){var t=new Uint8Array(e),r=i("zpE6");return r||n.Z.error("osg failed to use a gunzip.min.js to uncompress a gz file.\n You can add this vendors to enable this feature or get it at https://github.com/imaya/zlib.js/blob/master/bin/gunzip.min.js"),new r.Gunzip(t).decompress().buffer}}},I50a:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={name:"OpenSceneGraph",version:"0.2.9",author:"Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)"}},X3yw:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=function(e,t){return"core_"+t},r=function(e,t){return"#define "+t},a="(GL_EXT_shader_texture_lod|GL_OES_standard_derivatives|GL_EXT_draw_buffers|GL_EXT_frag_depth;)",o=new RegExp("#\\s*extension\\s+"+a+".*","g"),s=new RegExp(a,"g"),A=[],g=function(e,t){var i="glFragData_"+t;return A[t]="layout(location = "+t+") out vec4 "+i+";",i};const h=function(e,t){return e=function(e){return(e=e.replace(o,r)).replace(s,n)}(e=(e=(e=(e=e.replace(/attribute\s+/g,"in ")).replace(/varying\s+/g,t?"in ":"out ")).replace(/(texture2D|textureCube)\s*\(/g,"texture(")).replace(/(textureCubeLodEXT)\s*\(/g,"textureLod(")),t&&(A.length=0,e=e.replace(/gl_FragData\s*\[\s*(\d+)\s*\]/g,g),A.length||A.push("out vec4 glFragColor_0;"),e=(e=e.replace(/gl_FragColor/g,"glFragColor_0")).replace(/void\s+main\s*\(/g,A.join("\n")+"\nvoid main(")),e}},Kvhv:(e,t,i)=>{"use strict";i.d(t,{Z:()=>I});var n,r,a=i("GoyH"),o=i("u5PS"),s=i("5pih"),A=i("7itD"),g=function(){this._cache={},this._ShaderCompiler=void 0};g.prototype={setShaderCompiler:function(e){this._ShaderCompiler=e,e._validAttributeTypeMemberCache||this._computeStateAttributeCache(e)},getShaderCompiler:function(){return this._ShaderCompiler},filterAttributeTypes:function(e){return!(!e.isEnabled||e.isEnabled())},getActiveAttributeList:function(e,t){for(var i="",n=e._attributeArray,r=this._ShaderCompiler._validAttributeTypeMemberCache,a=0,o=r.length;a<o;a++){var s=r[a],A=s<n.length?n[s]:void 0;if(A){var g=A._lastApplied;g&&!this.filterAttributeTypes(g)&&(i+=g.getHash(),t.push(g))}}return i},getActiveAttributeListCache:function(e){for(var t="",i=this._ShaderCompiler._validAttributeTypeMemberCache,n=0,r=i.length;n<r;n++){var a=i[n],o=a<e._attributeArray.length?e._attributeArray[a]:void 0;if(o){var s=o._lastApplied;if(!s||this.filterAttributeTypes(s))continue;t+=o._lastApplied.getHash()}}return t},getActiveTextureAttributeListCache:function(e){for(var t="",i=this._ShaderCompiler._validTextureAttributeTypeMemberCache,n=e._textureAttributeArrayList,r=0;r<n.length;r++){var a=n[r];if(a)for(var o=a.length,s=0;s<i.length;s++){var A=i[s],g=A<o?a[A]:void 0;if(g){var h=g._lastApplied;if(!h||this.filterAttributeTypes(h)||h.isTextureNull())continue;t+=h.getHash()}}}return t},getActiveTextureAttributeList:function(e,t){var i,n,r="",a=e._textureAttributeArrayList,o=this._ShaderCompiler._validTextureAttributeTypeMemberCache;for(i=0,n=a.length;i<n;i++){var s=a[i];if(s){t[i]=[];for(var A=0,g=o.length;A<g;A++){var h=o[A],c=h<s.length?s[h]:void 0;if(c){var l=c._lastApplied;!l||this.filterAttributeTypes(l)||l.isTextureNull()||(r+=l.getHash(),t[i].push(l))}}}}return r},getActiveUniforms:function(e,t,i){for(var n={},r=0,a=t.length;r<a;r++){var o=t[r];if(o.getOrCreateUniforms){var s=o.getOrCreateUniforms();if(void 0!==s)for(var A in s){var g=s[A];n[g.getName()]=g}}}for(var h=0,c=i.length;h<c;h++){var l=i[h];if(l)for(var u=0,d=l.length;u<d;u++){var I=l[u].getOrCreateUniforms(h);for(var C in I){var f=I[C];n[f.getName()]=f}}}return n},_computeStateAttributeCache:function(e){var t,i,n,r,s,A=e.stateAttributeConfig.attribute||[],g=[];for(i=0,n=A.length;i<n;i++)t=A[i],void 0!==(s=a.Z.getIdFromTypeMember(t))&&(-1!==g.indexOf(s)?o.Z.warn("Compiler "+e.name+" contains duplicate attribute entry "+t+", check the Compiler configuration"):g.push(s));for(r=new Uint8Array(g),e._validAttributeTypeMemberCache=r,g=[],i=0,n=(A=e.stateAttributeConfig.textureAttribute||[]).length;i<n;i++)t=A[i],s=a.Z.getTextureIdFromTypeMember(t),-1!==g.indexOf(s)?o.Z.warn("Compiler "+e.name+" contains duplicate texture attribute entry "+t+", check the Compiler configuration"):g.push(s);r=new Uint8Array(g),e._validTextureAttributeTypeMemberCache=r},_createWaitingProgram:function(e,t,i){var n=new s.Z(new A.Z(A.Z.VERTEX_SHADER,"attribute vec3 Vertex;void main(void) {gl_Position = vec4(10.0,10.0,10.0,1.0);}\n"),new A.Z(A.Z.FRAGMENT_SHADER,"#define SHADER_NAME WaitSafe\nprecision lowp float; void main(void) { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}\n"));return this.getActiveAttributeList(e,t),n.setActiveUniforms(this.getActiveUniforms(e,t,i)),n.generated=!0,n._asyncLinkingExt=void 0,n.apply(e),n},getOrCreateProgram:(n=[],r=[],function(e){var t=this.getActiveAttributeListCache(e)+this.getActiveTextureAttributeListCache(e),i=this._getProgram(t,e,r,n);return void 0!==i?i:this._createProgram(t,e,r,n)}),_getProgram:function(e){return this._cache[e]},_createProgram:function(e,t,i,n){i.length=0,n.length=0,this.getActiveAttributeList(t,i),this.getActiveTextureAttributeList(t,n);var r=new(0,this._ShaderCompiler)(i,n),a=r.createFragmentShader(),o=r.createVertexShader(),g=new s.Z(new A.Z(A.Z.VERTEX_SHADER,o),new A.Z(A.Z.FRAGMENT_SHADER,a));return g.hash=e,g.setActiveUniforms(this.getActiveUniforms(t,i,n)),g.generated=!0,this._cache[e]=g,g.apply(t),g},resetCache:function(){this._cache={}}};const h=g;var c=function(){return this._generators={},this.addShaderGenerator("default",new h),this};c.prototype={getShaderGenerator:function(e){if(!e)return this._generators.default;var t=this._generators[e];return t||(o.Z.error("ShaderGenerator "+e+" does not exist in ShaderGeneratorProxy"),this._generators.default)},addShaderGenerator:function(e,t){this._generators[e]=t}};const l=c;var u=i("w/Ui"),d={};d.ShaderGenerator=h,d.ShaderGeneratorProxy=l,d.shaderProcessor=u.Z;const I=d},"w/Ui":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var osg_notify__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("u5PS"),osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("BvLe"),viewer_getOptions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("MQQR"),osgShader_gl2convert__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("X3yw"),shaderProcessor={},cbFilterDuplicate=function(e,t,i){return!t||e!==i[t-1]};shaderProcessor.getSortedUnique=function(e){return e.sort().filter(cbFilterDuplicate)};var isStringInteger=function(e){return/^[\+|\-]?\d+$/.test(e)},getFinalDefinedValue=function(e,t){for(;e[t]&&t!==e[t];)t=e[t];return t},testIf=function(defines,line){if(line.startsWith("#ifdef"))return void 0!==defines[line.substr(7-line.length)];if(line.startsWith("#ifndef"))return void 0===defines[line.substr(8-line.length)];if(line.startsWith("#else"))return!0;for(var txt=line.match(/[#elif|#if]\s+(.*)/)[1],tokens=txt.split(/\b\d+\b|\W+|defined+/g),i=0;i<tokens.length;++i){var tok=tokens[i];if(tok){var value=getFinalDefinedValue(defines,defines[tok]);void 0===value||isStringInteger(value)||(value=!0),txt=txt.replace(tok,value)}}return eval("var defined = function(x) { return x !== undefined | 0; };\n"+txt)},processBranch=function(e,t,i,n){for(var r=[1],a=t;a<e.length;++a){var o=e[a].trim();if(o.startsWith("#endif"))r.length--;else if(o.startsWith("#el")){var s=r.length-1;0===r[s]?r[s]=testIf(i,o)?1:0:1===r[s]&&(r[s]=2)}else if(o.startsWith("#if"))r.push(testIf(i,o)?1:0);else{for(var A=!0,g=r.length;g--;)A=A&&1===r[g];if(A)if(o.startsWith("#"))if(o.startsWith("#extension"))n.push(o);else if(o.startsWith("#undef"))i[o.match(/#undef\s+(\w+)/)[1]]=void 0,n.push(o);else if(o.startsWith("#define")){var h=o.match(/#define\s+(\w+)\s*(.*)/);-1!==o.indexOf(h[1]+"(")?i[h[1]]={args:o.match(/\(.*?\)/)[0].match(/\w+/g),body:o.match(/\)(.*)/)[1]}:i[h[1]]=h[2]}else console.error("unknown preprocessor line: "+o);else n.push(o)}}},fixIndent=function(e){for(var t=(e=e.replace(/(\n\s*\n)+/g,"\n\n")).split("\n"),i="",n=0;n<t.length;++n){var r=t[n].trim(),a=-1!==r.indexOf("{"),o=-1!==r.indexOf("}");!a&&o&&(i=i.substr(4)),t[n]=i+r,a&&!o&&(i+="    ")}return t.join("\n")},cleanDeclarations=function(e,t){for(var i=0;i<t.length;++i)e=e.replace(t[i],""),t[i]=t[i].replace(/\s+/g," ").replace(/\s+;/,";");return e},handleVaryings=function(e){var t=e.match(/varying\s.*?;/g);if(!t)return e;e=cleanDeclarations(e,t),t=shaderProcessor.getSortedUnique(t);for(var i=0;i<t.length;++i)if(-1!==t[i].indexOf("vViewNormal;")){var n=t[0];t[0]=t[i],t[i]=n;break}return"\n"+t.join("\n")+"\n"+e},handleUniforms=function(e){var t=e.match(/uniform\s.*?;/g);return t?(e=cleanDeclarations(e,t),"\n"+(t=shaderProcessor.getSortedUnique(t)).join("\n")+"\n"+e):e},handleAttributes=function(e){var t=e.match(/attribute\s.*?;/g);if(!t)return e;e=cleanDeclarations(e,t),t=shaderProcessor.getSortedUnique(t);for(var i=0;i<t.length;++i)if(-1!==t[i].indexOf(" Vertex;")){t.unshift(t[i]),t.splice(i+1,1);break}return"\n"+t.join("\n")+"\n"+e},handlePrecision=function(e){var t=e.match(/precision\s+(high|low|medium)p\s+float\s*;/);return t?t[0]+"\n"+e.replace(t[0],""):"precision "+osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.Z.instance().getShaderMaxPrecisionFloat()+"p float;\n"+e},addExtensions=function(e){var t=e.match(/#extension\s(\w+)\s:\s(\w+)/g);if(!t)return e;t=shaderProcessor.getSortedUnique(t);for(var i=0;i<t.length;++i)e=e.replace(t[i],"");return t.join("\n")+"\n"+e},addVersion=function(e){return(osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.Z.instance().isWebGL2()?"#version 300 es\n":"#version 100\n")+e},hasVersion=function(e){return e.match(/^#\s*version/m)},cbUnroll=function(e,t,i){t=parseInt(t);for(var n="",r=0;r<t;++r)n+=i.replace(/%ID%/g,r);return n},unrollReplace=function(e){return e.replace(/%UNROLL ([0-9]+)%([\s\S]+?)%%/g,cbUnroll)},glslPreprocessShader=function(e){return window.glslesPreprocessor(e,{debugExperimental:!1,defines:[],doStats:!1,extensions:[],pruneComments:!0,logCounts:!1,minify:!1,output:0,preprocess:!0,profileTimeEach:!1,profileTimeGlobal:!1,pruneUnused:!0,pruneDefines:!0,replaceDefine:!0,optimize:!0,tabs:4,whitespace:!0})},extractArguments=function(e,t){for(var i=[""],n=0,r=t;r<e.length;++r){if("("===e[r])n++;else if(")"===e[r]){if(0===n)return[i,r+1];if(0===--n){i[i.length-1]+=e[r];continue}}","!==e[r]||0!==n?i[i.length-1]+=e[r]:i.push("")}},replaceRange=function(e,t,i,n){return e.substring(0,t)+n+e.substring(i)},resolveDefineFunction=function(e,t,i){var n=new RegExp("\\b"+t+"\\b\\s*\\(","g"),r=e.match(n);if(!r)return e;for(var a=i.args,o=i.body,s=0;s<r.length;++s){var A=r[s],g=e.indexOf(A),h=g+A.length,c=extractArguments(e,h),l=c[0],u=o.replace(/\w+/g,(function(e){var t=a.indexOf(e);return-1!==t?l[t]:e}));e=replaceRange(e,g,c[1],u)}return e},resolveDefines=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;++n){for(var r=i[n],a=t[r],o="object"==typeof a,s=!o&&new RegExp("\\b"+r+"\\b","g"),A=n+1;A<i.length;++A){var g=i[A],h=t[g];void 0!==h&&("object"==typeof h?h.body=o?resolveDefineFunction(h.body,r,a):h.body.replace(s,a):t[g]=o?resolveDefineFunction(h,r,a):h.replace(s,a))}e=o?resolveDefineFunction(e,r,a):e.replace(s,a)}return e},extensions=["EXT_shader_texture_lod","EXT_draw_buffers","EXT_frag_depth","OES_standard_derivatives"],getDefaultDefines=function(){for(var e={},t=osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.Z.instance(),i=t.getWebGLExtensions(),n=0;n<extensions.length;++n){var r=extensions[n];i[r]&&(e["GL_"+r]="GL_"+r)}return"high"===t.getShaderMaxPrecisionFloat()&&(e.GL_FRAGMENT_PRECISION_HIGH="GL_FRAGMENT_PRECISION_HIGH"),e},fastPreprocess=function(e){e=e.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"");var t=getDefaultDefines(),i=[];return processBranch(e.split("\n"),0,t,i,!0),resolveDefines(i.join("\n"),t)},preprocess=function(e){var t=e.match("#define SHADER_NAME .*");return e=(0,viewer_getOptions__WEBPACK_IMPORTED_MODULE_2__.Z)().cleanShader&&window.glslesPreprocessor?glslPreprocessShader(e):fastPreprocess(e),t?t[0]+"\n"+e:e};shaderProcessor.processIncludes=function(e,t){return e.replace(/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,(function(e,i){var n=i.split(" ")[0].replace(/"/g,"");return-1!==t.indexOf(n)?"":(t.push(n),shaderProcessor.processIncludes(shaderProcessor.getShaderTextPure(n),t))}))},shaderProcessor.processShader=function(e){if(hasVersion(e))return e;var t=shaderProcessor.processIncludes(e,[]),i=-1===t.indexOf("gl_Position");return t=t.replace(/\\\n/g,""),t=unrollReplace(t),t=preprocess(t),t=handleVaryings(t),t=handleUniforms(t),t=handleAttributes(t),t=fixIndent(t),osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.Z.instance().isWebGL2()&&(t=(0,osgShader_gl2convert__WEBPACK_IMPORTED_MODULE_3__.Z)(t,i)),t=handlePrecision(t),t=addExtensions(t),t=addVersion(t)};var shadersText={};shaderProcessor.addShaders=function(e){for(var t in e)shadersText[t]&&console.warn("Shader already added : "+t),shadersText[t]=e[t]},shaderProcessor.hasShader=function(e){return void 0!==shadersText[e]},shaderProcessor.getShaderTextPure=function(e){var t=shadersText[e];return t||osg_notify__WEBPACK_IMPORTED_MODULE_0__.Z.error("shader file/text: "+e+" not registered"),t},shaderProcessor.getShader=function(e){var t=shaderProcessor.getShaderTextPure(e);return shaderProcessor.processShader(t)};const __WEBPACK_DEFAULT_EXPORT__=shaderProcessor},"9Aw2":(e,t,i)=>{"use strict";i.d(t,{Z:()=>I});var n=i("GoyH"),r=i("CJNH"),a=i("mixV"),o=function(e){r.Z.call(this,r.Z.TRAVERSE_ALL_CHILDREN),this._selectables=e,this._nodeList=[],this._linkList=[],this._uniqueNodes=new window.Set,this._uniqueEdges=new window.Set};n.Z.createPrototypeObject(o,n.Z.objectInherit(r.Z.prototype,{getColorFromClassName:function(e){switch(e){case"ShadowedScene":return"#3D3D3D";case"Camera":return"#AB7BCF";case"RenderBin":return"#59778B";case"LightSource":return"#53967D";case"RenderStage":return"#DDCC55";case"RenderLeaf":case"Geometry":return"#FFCC55";case"RigGeometry":return"#DD8800";case"MorphGeometry":return"#AA5500";case"MatrixTransform":return"#CE697E";case"StateSet":return"#0099FF";case"StateGraph":case"Skeleton":return"#96999E";case"Bone":return"#A9DEAA";case"Node":return"#FFFFFF";default:return"#FF00AA"}},createGraph:function(e){this.reset(),e.accept(this)},reset:function(){this._nodeList.length=0,this._linkList.length=0,this._uniqueNodes.clear(),this._uniqueEdges.clear()},apply:function(e){if(!e._isNormalDebug){if(this._uniqueNodes.has(e.getInstanceID())||(this._uniqueNodes.add(e.getInstanceID()),this._nodeList.push(e)),this.nodePath.length>=2){var t=this.nodePath[this.nodePath.length-2].getInstanceID(),i=e.getInstanceID(),n=t+"+"+i;this._uniqueEdges.has(n)||(this._linkList.push({parentNode:t,childrenNode:i}),this._uniqueEdges.add(n))}this.traverse(e)}},createMatrixGrid:function(e,t){var i="";return i+="<table><tr><td>"+t[0]+"</td>",i+="<td>"+t[4]+"</td>",i+="<td>"+t[8]+"</td>",i+="<td>"+t[12]+"</td></tr>",i+="<tr><td>"+t[1]+"</td>",i+="<td>"+t[5]+"</td>",i+="<td>"+t[9]+"</td>",i+="<td>"+t[13]+"</td></tr>",i+="<tr><td>"+t[2]+"</td>",i+="<td>"+t[6]+"</td>",i+="<td>"+t[10]+"</td>",i+="<td>"+t[14]+"</td></tr>",i+="<tr><td>"+t[3]+"</td>",i+="<td>"+t[7]+"</td>",i+="<td>"+t[11]+"</td>",i+="<td>"+t[15]+"</td></tr></table>"},getLabel:function(e){var t=e.className()+" ("+e.getInstanceID()+")";return e.getName&&e.getName()&&(t+="\n"+e.getName()),t},generateNode:function(e,t){var i="";t.getMatrix&&t.getMatrix()&&(i+="<br /><br />"+this.createMatrixGrid(t,t.getMatrix())),this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:this.getLabel(t),description:i,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateStateSet:function(e,t){var i=t.getStateSet(),n=i.getInstanceID(),r=this.getLabel(i);r+="\nNbTexture : "+i.getNumTextureAttributeLists(),e.hasNode(n)||(this._selectables.set(n.toString(),i),e.addNode(n,{label:r,style:"fill: "+this.getColorFromClassName(i.className())+";stroke-width: 0px;"})),e.addEdge(null,t.getInstanceID(),n,{style:"stroke: "+this.getColorFromClassName(i.className())+";"})},generateSourceGeometry:function(e,t){var i=t.getSourceGeometry(),n=i.getInstanceID();this._selectables.set(n.toString(),i),e.addNode(n,{label:this.getLabel(i),style:"fill: "+this.getColorFromClassName(i.className())+";stroke-width: 0px;"}),e.addEdge(null,t.getInstanceID(),n,{style:"stroke: "+this.getColorFromClassName(i.className())+";"})},generateNodeAndLink:function(e){for(var t=0,i=this._nodeList.length;t<i;t++){var n=this._nodeList[t];this.generateNode(e,n),n.getStateSet()&&this.generateStateSet(e,n),n.getSourceGeometry&&n.getSourceGeometry()instanceof a.Z&&this.generateSourceGeometry(e,n)}for(var r=0,o=this._linkList.length;r<o;r++)e.addEdge(null,this._linkList[r].parentNode,this._linkList[r].childrenNode)}}),"osgUtil","DisplayGraphNode");const s=o;var A=i("hLVw"),g=function(e){this._selectables=e,this._nodeList=[],this._linkList=[],this._renderBinMap=new window.Map,this._renderBinStack=[],this._generatorID=0,this._refID=0,this._uniqueEdges=new window.Set};g.prototype={getColorFromClassName:s.prototype.getColorFromClassName,createGraph:function(e){this.reset(),this.apply(e)},reset:function(){this._renderBinMap.clear(),this._renderBinStack.length=0,this._generatorID=0,this._refID++,this._nodeList.length=0,this._linkList.length=0,this._uniqueEdges.clear()},apply:function(e){var t=e.getInstanceID();if(this._renderBinMap.has(t)||this._renderBinMap.set(t,e),this._renderBinStack.push(e),e.getPreRenderStageList)for(var i=e.getPreRenderStageList(),n=0,r=i.length;n<r;++n)this.apply(i[n].renderStage);if(this.registerNode(e),e.getPostRenderStageList)for(var a=e.getPostRenderStageList(),o=0,s=a.length;o<s;++o)this.apply(a[o].renderStage);this._renderBinStack.pop()},registerNode:function(e){var t=e.getInstanceID();if(this._nodeList.push(e),e._bins.forEach(function(e,t){this.apply(t)}.bind(this)),e._leafs.length)for(var i=0,n=e._leafs.length;i<n;i++)this.createNodeAndSetID(t,e._leafs[i]);var r=this,a={},o=function(e){r.createNodeAndSetID(this.stateGraphID,e)}.bind(a);if(e.getStateGraphList().forEach((function(e){r.createNodeAndSetID(t,e);var i=e._instanceID,n=e.getLeafs();a.stateGraphID=i,n.forEach(o)})),!(this._renderBinStack.length<2)){var s=this._renderBinStack[this._renderBinStack.length-2].getInstanceID();this.createLink(s,t)}},createLink:function(e,t){var i=e+"+"+t;this._uniqueEdges.has(i)||(this._linkList.push({parentNode:e,childrenNode:t}),this._uniqueEdges.add(i))},createNodeAndSetID:function(e,t){this._nodeList.push(t),(void 0===t._instanceID||t._instanceID<0&&t._refID!==this._refID)&&(t._instanceID=-1-this._generatorID++,t._refID=this._refID),this.createLink(e,t._instanceID)},generateRenderLeaf:function(e,t){var i=t._instanceID,n="RenderLeaf",r=t._geometry&&t._geometry.getName()?"\n"+t._geometry.getName():"Geometry",a="RenderLeaf ( "+t._instanceID+" )";a+="\n"+r+" ( "+t._geometry.getInstanceID()+" )",this._selectables.set(i.toString(),t),e.addNode(i,{label:a,description:"",style:"fill: "+this.getColorFromClassName(n)+";stroke-width: 0px;"})},generateStateGraph:function(e,t){var i=t._instanceID,n="StateGraph",r="StateGraph ( "+t._instanceID+" )";r+="\n"+t._leafs._length+" leafs",this._selectables.set(i.toString(),t),e.addNode(i,{label:r,description:"",style:"fill: "+this.getColorFromClassName(n)+";stroke-width: 0px;"})},generateRenderStage:function(e,t){var i=t.className()+" ( "+t._instanceID+" )";t.getName()&&(i+="\n"+t.getName()),i+="\nViewport ( "+t.getViewport().width()+" x "+t.getViewport().height()+" )",this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:i,description:"",style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateRenderBin:function(e,t){var i=t.className()+" ( "+t.getInstanceID()+" )";t.getName()&&(i+="\n"+t.getName());var n="";t.getSortMode()===A.Z.SORT_BACK_TO_FRONT&&(n="SortMode: BackToFront");var r="BinNumber: "+t.getBinNumber()+"\n"+n;this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:i,description:r,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateNodeAndLink:function(e){for(var t=0,i=this._nodeList.length;t<i;t++){var n=this._nodeList[t];n._geometry&&void 0!==n._depth?this.generateRenderLeaf(e,n):"StateGraph"===n.className()?this.generateStateGraph(e,n):"RenderStage"===n.className()?this.generateRenderStage(e,n):this.generateRenderBin(e,n)}for(var r=0,a=this._linkList.length;r<a;r++)e.addEdge(null,this._linkList[r].parentNode,this._linkList[r].childrenNode)}};const h=g;var c,l=i("u5PS"),u=function(e){this.options=e;var t=document.createElement("style");t.type="text/css",t.innerHTML=[".osgDebugSimpleTooltip {","display: none;","position: absolute;","margin-left: 10px;","border-radius: 4px;","padding: 10px;","background: rgba(0,0,0,.9);","color: #ffffff;","}",".osgDebugSimpleTooltip:before {","content: ",";","position: absolute;","left: -10px;","top: 8px;","border: 10px solid transparent;","border-width: 10px 10px 10px 0;","border-right-color: rgba(0,0,0,.9);","}"].join("\n"),document.getElementsByTagName("head")[0].appendChild(t),this.el=document.createElement("div"),this.el.className="osgDebugSimpleTooltip",document.body.appendChild(this.el);for(var i=document.querySelectorAll(this.options.selector),n=0;n<i.length;n++)i[n].addEventListener("mouseover",this.showTooltip.bind(this),!1),i[n].addEventListener("mouseout",this.hideTooltip.bind(this),!1)};u.prototype={showTooltip:function(e){if(c){var t=e.currentTarget;this.el.innerHTML=t.getAttribute("title"),this.el.style.display="block",this.el.style.left=c(t).position().left+c(t).get(0).getBoundingClientRect().width+"px",this.el.style.top=c(t).position().top+"px"}},hideTooltip:function(){this.el.style.display="none"}};var d=function(){!function(){try{c=i("Hjnd")}catch(e){l.Z.warn("You will not be able to use osgUtil.DisplayGraph until you add jQuery in your page")}}(),c&&(this._selectables=new window.Map,this._graphNode=new s(this._selectables),this._graphRender=new h(this._selectables),this._displayNode=!0,this._displayRenderer=!1,this._cbSelect=void 0,this._focusedElement="graph",this._idToDomElement=new window.Map,this._$svg=c("<svg width=100% height=100%></svg>"),c("body").append(this._$svg),this._css=".node {text-align: center;cursor: pointer;}.node rect {stroke: #FFF;}.edgePath path {stroke: #FFF;fill: none;}table {text-align: right;}svg {position: absolute;left: 0px;top: 0px;}.osgDebugButton {position: absolute;left: 15px;top: 15px;z-index: 5;border: 0;background: #65a9d7;background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background: -webkit-linear-gradient(top, #3e779d, #65a9d7);background: -moz-linear-gradient(top, #3e779d, #65a9d7);background: -ms-linear-gradient(top, #3e779d, #65a9d7);background: -o-linear-gradient(top, #3e779d, #65a9d7);padding: 5px 10px;-webkit-border-radius: 7px;-moz-border-radius: 7px;border-radius: 7px;-webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;-moz-box-shadow: rgba(0,0,0,1) 0 1px 0;box-shadow: rgba(0,0,0,1) 0 1px 0;text-shadow: rgba(0,0,0,.4) 0 1px 0;color: white;font-size: 15px;font-family: Helvetica, Arial, Sans-Serif;text-decoration: none;vertical-align: middle;}.osgDebugButton:hover {border-top-color: #28597a;background: #28597a;color: #ccc;}.osgDebugButton:active {border-top-color: #1b435e;background: #1b435e;}.osgDebugSimpleTooltip .osgDebugName {font-weight: bold;color: #60b1fc;margin: 0;}.osgDebugSimpleTooltip .osgDebugDescription {margin: 0;}")};d.instance=function(){return d._instance||(d._instance=new d),d._instance},d.prototype={getColorFromClassName:s.prototype.getColorFromClassName,setCallbackSelect:function(e){this._cbSelect=e},reset:function(){c&&(this._selectables.clear(),this._$svg.empty(),this._focusedElement="scene",c(".osgDebugButton").hide())},setDisplayGraphRenderer:function(e){this._displayRenderer=e},createRenderGraph:function(e){this._graphRender.createGraph(e),this.displayGraph()},createGraph:function(e){c&&(this.reset(),this._displayNode=!!e,e&&this._graphNode.createGraph(e),this._displayRenderer?i("Pxgm").Z.debugGraph=!0:this.displayGraph())},displayGraph:function(){if(c)if(window.d3&&window.dagreD3)this._createGraphApply();else{var e=this._createGraphApply.bind(this);c.getScript("//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js").done((function(){c.getScript("//cdn.jsdelivr.net/dagre-d3/0.2.9/dagre-d3.min.js").done(e)}))}},_createGraphApply:function(){var e=new window.dagreD3.Digraph;this._displayNode&&this._graphNode.generateNodeAndLink(e),this._displayRenderer&&this._graphRender.generateNodeAndLink(e),this.injectStyleElement(),c(".osgDebugButton").show();var t=this.renderer=new window.dagreD3.Renderer,i=window.d3.select(this._$svg.get(0)).append("g"),n=t.zoom();t.zoom((function(e,t){var i=n(e,t);return i.scale(.75).event(t),i}));var r=this._idToDomElement,a=t.drawNodes();t.drawNodes((function(e,t){var i=a(e,t);return i.attr("title",(function(t){return r.set(t,this),i=t,n=e.node(t).description||"",'<p class="osgDebugName">'+i+'</p><pre class="osgDebugDescription">'+n+"</pre>";var i,n})),i})),t.run(e,i),this.tooltip=new u({selector:".node"}),c(".node").click(this.onNodeSelect.bind(this)),this.focusOnGraph()},selectNode:function(e){var t=e.getInstanceID(),i=this._idToDomElement.get(t);i&&c(i).click()},onNodeSelect:function(e){var t=e.currentTarget,i=c(t.getAttribute("title"))[0].innerHTML,n=this._selectables;this.lastNode&&(this.lastNode.style.fill=this.lastColor);var r=n.get(i);r&&(this.lastNode=t.childNodes[0],this.lastColor=this.lastNode.style.fill,t.childNodes[0].style.fill="#f00",window.activeNode=r,l.Z.info("window.activeNode is set with the node below !"),l.Z.log(window.activeNode),l.Z.log("\n"),this._cbSelect&&this._cbSelect(r))},focusOnScene:function(){c(".osgDebugButton").text("Access to the graph"),this._$svg.css("zIndex","-2"),this._focusedElement="scene"},focusOnGraph:function(){c(".osgDebugButton").text("Access to the scene"),this._$svg.css("zIndex","2"),c(".osgDebugSimpleTooltip").css("zIndex","3"),this._focusedElement="graph"},injectStyleElement:function(){if(!this._cssInjected){this._cssInjected=!0,c("body").append('<button class="osgDebugButton">Access to the scene</button>'),c(".osgDebugButton").click(function(){"scene"===this._focusedElement?this.focusOnGraph():this.focusOnScene()}.bind(this));var e=document.createElement("style");e.type="text/css",e.innerHTML=this._css,document.getElementsByTagName("head")[0].appendChild(e)}}};const I=d},vXZK:(e,t,i)=>{"use strict";i.d(t,{Z:()=>A});var n,r=i("W40i"),a=i("Un/q"),o=i("E9Rp"),s=function(){this._hit=!1,this._primitiveIndex=0,this._vertices=void 0,this._geometry=void 0,this._intersectionVisitor=void 0,this._intersector=void 0,this._limitOneIntersection=!1,this._primitiveMask=o.Z.ALL_PRIMITIVES};s.Intersection=function(){this._nodePath=void 0,this._drawable=void 0,this._matrix=void 0,this._primitiveIndex=void 0,this._ratio=0,this._backface=!1,this._localIntersectionPoint=r.R3.create()},s.prototype={reset:function(){this._hit=!1,this._vertices=void 0,this._primitiveIndex=0},setPrimitiveIndex:function(e){this._primitiveIndex=e},setGeometry:function(e){this._geometry=e,this._primitiveIndex=0,this._vertices=e.getAttributes().Vertex.getElements()},setVertices:function(e){this._vertices=e},setIntersectionVisitor:function(e){this._intersectionVisitor=e},setIntersector:function(e){this._intersector=e,this._primitiveMask=e.getPrimitiveMask();var t=e.getIntersectionLimit();this._limitOneIntersection=t===o.Z.LIMIT_ONE_PER_DRAWABLE||t===o.Z.LIMIT_ONE},setLimitOneIntersection:function(e){this._limitOneIntersection=e},leave:function(){},enter:function(){},initIntersection:function(e){return e._matrix=r._E.clone(this._intersectionVisitor.getModelMatrix()),e._nodePath=this._intersectionVisitor.getNodePath().slice(),e._primitiveIndex=this._primitiveIndex,e._drawable=this._geometry,this._intersector.getIntersections().push(e),this._hit=!0,e},intersectPoint:function(){},intersectLine:function(){},intersectTriangle:function(){},operatorPoint:(n=r.R3.create(),function(e){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&o.Z.POINT_PRIMITIVES))){var t=this._vertices;r.R3.set(n,t[3*e],t[3*e+1],t[3*e+2]),this.intersectPoint(n,e),this._primitiveIndex++}}),operatorLine:function(){var e=r.R3.create(),t=r.R3.create();return function(i,n){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&o.Z.LINE_PRIMITIVES))){var a=this._vertices;r.R3.set(e,a[3*i],a[3*i+1],a[3*i+2]),r.R3.set(t,a[3*n],a[3*n+1],a[3*n+2]),this.intersectLine(e,t,i,n),this._primitiveIndex++}}}(),operatorTriangle:function(){var e=r.R3.create(),t=r.R3.create(),i=r.R3.create();return function(n,a,s){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&o.Z.TRIANGLE_PRIMITIVES))){var A=this._vertices;r.R3.set(e,A[3*n],A[3*n+1],A[3*n+2]),r.R3.set(t,A[3*a],A[3*a+1],A[3*a+2]),r.R3.set(i,A[3*s],A[3*s+1],A[3*s+2]),this.intersectTriangle(e,t,i,n,a,s),this._primitiveIndex++}}}(),apply:function(e){e.getAttributes().Vertex&&(0,a.Z)(e,this)}};const A=s},CtxI:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n,r=i("GoyH"),a=i("CJNH"),o=i("W40i"),s=i("cyFB"),A=i("bDLW"),g=i("pSxj"),h=function(){a.Z.call(this),this._intersector=void 0,this._projectionStack=new A.Z,this._modelStack=new A.Z,this._viewStack=new A.Z,this._windowStack=new A.Z,this._pooledMatrix=new s.Z(o._E.create),this.reset()};r.Z.createPrototypeObject(h,r.Z.objectInherit(a.Z.prototype,{reset:function(){this._pooledMatrix.reset(),this._viewStack.reset(),this._modelStack.reset(),this._projectionStack.reset(),this._windowStack.reset(),this._viewStack.push(o._E.IDENTITY),this._modelStack.push(o._E.IDENTITY),this._projectionStack.push(o._E.IDENTITY),this._windowStack.push(o._E.IDENTITY)},setIntersector:function(e){this._intersector=e},getIntersector:function(){return this._intersector},pushModelMatrix:function(e){this._modelStack.push(e)},getModelMatrix:function(){return this._modelStack.back()},popModelMatrix:function(){return this._modelStack.pop()},pushViewMatrix:function(e){this._viewStack.push(e)},getViewMatrix:function(){return this._viewStack.back()},popViewMatrix:function(){return this._viewStack.pop()},pushProjectionMatrix:function(e){this._projectionStack.push(e)},getProjectionMatrix:function(){return this._projectionStack.back()},popProjectionMatrix:function(){return this._projectionStack.pop()},pushWindowMatrix:function(e){this._windowStack.push(e)},pushWindowMatrixUsingViewport:function(e){this._windowStack.push(e.computeWindowMatrix(this._pooledMatrix.getOrCreateObject()))},getWindowMatrix:function(){return this._windowStack.back()},popWindowMatrix:function(){return this._windowStack.pop()},getTransformation:(n=o._E.create64(),function(){return o._E.copy(n,this.getWindowMatrix()),o._E.mul(n,n,this.getProjectionMatrix()),o._E.mul(n,n,this.getViewMatrix()),o._E.mul(n,n,this.getModelMatrix()),n}),enter:function(e){return this._intersector.enter(e)},apply:function(e){e.getViewMatrix?this.applyCamera(e):e.getMatrix?this.applyTransform(e):this.applyNode(e)},applyCamera:function(e){var t,i,n,r=e.getViewport();void 0!==r&&this.pushWindowMatrixUsingViewport(r),e.getReferenceFrame()===g.Z.RELATIVE_RF&&this.getViewMatrix()&&this.getProjectionMatrix()?(t=o._E.mul(this._pooledMatrix.getOrCreateObject(),this.getProjectionMatrix(),e.getProjectionMatrix()),i=this.getViewMatrix(),n=o._E.mul(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix(),e.getViewMatrix())):(t=e.getProjectionMatrix(),i=e.getViewMatrix(),n=o._E.identity(this._pooledMatrix.getOrCreateObject())),this.pushProjectionMatrix(t),this.pushViewMatrix(i),this.pushModelMatrix(n),this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),this.popViewMatrix(),this.popProjectionMatrix(),void 0!==r&&this.popWindowMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())},applyNode:function(e){this.enter(e)&&(e.getPrimitiveSetList?this._intersector.intersect(this,e):e.traverse&&this.traverse(e))},applyTransform:function(e){if(this.enter(e)){if(e.getReferenceFrame()===g.Z.ABSOLUTE_RF){var t=this._pooledMatrix.getOrCreateObject();this.pushViewMatrix(o._E.identity(t)),this.pushModelMatrix(e.getMatrix())}else if(this._modelStack.getLength()>0){var i=o._E.copy(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix());o._E.mul(i,i,e.getMatrix()),this.pushModelMatrix(i)}else this.pushModelMatrix(e.getMatrix());this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),e.getReferenceFrame()===g.Z.ABSOLUTE_RF&&this.popViewMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())}}}),"osgUtil","IntersectionVisitor");const c=h},"K/iW":(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("E9Rp"),r=function(){this._intersections=[],this._primitiveMask=n.Z.ALL_PRIMITIVES,this._intersectionLimit=n.Z.NO_LIMIT};r.prototype={reset:function(){this._intersections.length=0},enter:function(e){return!this.reachedLimit()&&(!e.isCullingActive()||this.intersectNode(e))},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())||this.intersectBoundingBox(e.getBoundingBox())},intersectBoundingSphere:function(){return!1},intersectBoundingBox:function(){return!1},getIntersections:function(){return this._intersections},setIntersectionLimit:function(e){this._intersectionLimit=e},getIntersectionLimit:function(){return this._intersectionLimit},setPrimitiveMask:function(e){this._primitiveMask=e},getPrimitiveMask:function(){return this._primitiveMask},reachedLimit:function(){return this._intersectionLimit===n.Z.LIMIT_ONE&&this._intersections.length>0},setCurrentTransformation:function(){},intersect:function(){}};const a=r},zACX:(e,t,i)=>{"use strict";i.d(t,{Z:()=>v});var n,r,a,o,s,A,g,h,c,l,u,d,I,C,f=i("GoyH"),p=i("W40i"),m=i("vXZK"),_=function(){m.Z.Intersection.call(this),this._localIntersectionNormal=p.R3.clone(p.R3.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},E=function(){m.Z.call(this),this._threshold=0,this._d=p.R3.create(),this._length=0,this._invLength=0,this._start=p.R3.create(),this._end=p.R3.create(),this._dInvX=p.R3.create(),this._dInvY=p.R3.create(),this._dInvZ=p.R3.create(),this._hit=!1};f.Z.createPrototypeObject(E,f.Z.objectInherit(m.Z.prototype,{set:function(e,t,i){this._start=e,this._end=t,p.R3.sub(this._d,t,e),this._length=p.R3.length(this._d),this._invLength=0!==this._length?1/this._length:0,p.R3.scale(this._d,this._d,this._invLength),0!==this._d[0]&&p.R3.scale(this._dInvX,this._d,1/this._d[0]),0!==this._d[1]&&p.R3.scale(this._dInvY,this._d,1/this._d[1]),0!==this._d[2]&&p.R3.scale(this._dInvZ,this._d,1/this._d[2]),void 0!==i&&(this._threshold=i)},enter:function(e,t,i){var n=e._min,r=n[0],a=n[1],o=n[2],s=e._max,A=s[0],g=s[1],h=s[2],c=this._dInvX,l=this._dInvY,u=this._dInvZ;if(t[0]<=i[0]){if(i[0]<r)return!1;if(t[0]>A)return!1;t[0]<r&&p.R3.scaleAndAdd(t,t,c,r-t[0]),i[0]>A&&p.R3.scaleAndAdd(i,t,c,A-t[0])}else{if(t[0]<r)return!1;if(i[0]>A)return!1;i[0]<r&&p.R3.scaleAndAdd(i,t,c,r-t[0]),t[0]>A&&p.R3.scaleAndAdd(t,t,c,A-t[0])}if(t[1]<=i[1]){if(i[1]<a)return!1;if(t[1]>g)return!1;t[1]<a&&p.R3.scaleAndAdd(t,t,l,a-t[1]),i[1]>g&&p.R3.scaleAndAdd(i,t,l,g-t[1])}else{if(t[1]<a)return!1;if(i[1]>g)return!1;i[1]<a&&p.R3.scaleAndAdd(i,t,l,a-t[1]),t[1]>g&&p.R3.scaleAndAdd(t,t,l,g-t[1])}if(t[2]<=i[2]){if(i[2]<o)return!1;if(t[2]>h)return!1;t[2]<o&&p.R3.scaleAndAdd(t,t,u,o-t[2]),i[2]>h&&p.R3.scaleAndAdd(i,t,u,h-t[2])}else{if(t[2]<o)return!1;if(i[2]>h)return!1;i[2]<o&&p.R3.scaleAndAdd(i,t,u,o-t[2]),t[2]>h&&p.R3.scaleAndAdd(t,t,u,h-t[2])}return!0},intersectPoint:(I=p.R3.create(),C=p.R3.create(),function(e,t){var i=this._start;p.R3.sub(I,e,i),p.R3.sub(C,this._end,i);var n=p.R3.dot(I,C)*this._invLength*this._invLength;if(!((n<0?p.R3.sqrLen(I):n>1?p.R3.sqrDist(e,this._end):p.R3.sqrLen(p.R3.scaleAndAdd(I,I,C,-n)))>this._threshold*this._threshold)){var r=this.initIntersection(new _);r._i1=t,r._r1=1,p.R3.scaleAndAdd(r._localIntersectionPoint,i,C,n),r._ratio=n}}),intersectLine:(h=p.R3.create(),c=p.R3.create(),l=p.R3.create(),u=p.R3.create(),d=p.R3.create(),function(e,t,i,n){var r=1e-8;p.R3.sub(h,t,e),p.R3.sub(c,this._end,this._start),p.R3.sub(l,e,this._start);var a,o,s=p.R3.dot(h,h),A=p.R3.dot(h,c),g=p.R3.dot(c,c),I=p.R3.dot(h,l),C=p.R3.dot(c,l),f=s*g-A*A,m=f,E=f;f<r?(a=0,m=1,o=C,E=g):(o=s*C-A*I,(a=A*C-g*I)<0?(a=0,o=C,E=g):a>m&&(a=m,o=C+A,E=g)),o<0?(o=0,-I<0?a=0:-I>s?a=m:(a=-I,m=s)):o>E&&(o=E,-I+A<0?a=0:-I+A>s?a=m:(a=-I+A,m=s));var v=Math.abs(a)<r?0:a/m,S=Math.abs(o)<r?0:o/E;if(p.R3.scaleAndAdd(u,e,h,v),p.R3.scaleAndAdd(d,this._start,c,S),!(p.R3.sqrDist(u,d)>this._threshold*this._threshold)){var B=this.initIntersection(new _);B._i1=i,B._i2=n,B._r1=1-S,B._r2=S,p.R3.copy(B._localIntersectionPoint,d),B._ratio=S}}),intersectTriangle:(n=p.R3.create(),r=p.R3.create(),a=p.R3.create(),o=p.R3.create(),s=p.R3.create(),A=p.R3.create(),g=1e-20,function(e,t,i,h,c,l){var u=this._d;p.R3.sub(r,i,e),p.R3.sub(a,t,e),p.R3.cross(s,u,r);var d=p.R3.dot(s,a);if(!(d>-1e-20&&d<g)){var I=1/d;p.R3.sub(o,this._start,e);var C=p.R3.dot(s,o)*I;if(!(C<0||C>1)){p.R3.cross(A,o,a);var f=p.R3.dot(A,u)*I;if(!(f<0||C+f>1)){var m=p.R3.dot(A,r)*I;if(!(m<g||m>this._length)){var E=1-C-f,v=C,S=f,B=m*this._invLength,w=e[0]*E+t[0]*v+i[0]*S,y=e[1]*E+t[1]*v+i[1]*S,M=e[2]*E+t[2]*v+i[2]*S;p.R3.cross(n,a,r),p.R3.normalize(n,n);var D=this.initIntersection(new _);D._i1=h,D._i2=c,D._i3=l,D._r1=E,D._r2=v,D._r3=S,p.R3.set(D._localIntersectionPoint,w,y,M),p.R3.copy(D._localIntersectionNormal,n),D._ratio=B,D._backface=p._E.determinant(D._matrix)*d<0}}}}}),operatorPoint:function(e){this._threshold<=0||m.Z.prototype.operatorPoint.call(this,e)},operatorLine:function(e,t){this._threshold<=0||m.Z.prototype.operatorLine.call(this,e,t)}}),"osgUtil","LineSegmentIntersectFunctor");const v=E},XDCw:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n,r,a,o=i("GoyH"),s=i("W40i"),A=i("K/iW"),g=i("zACX"),h=function(){A.Z.call(this),this._start=s.R3.create(),this._iStart=s.R3.create(),this._end=s.R3.create(),this._iEnd=s.R3.create(),this._threshold=0,this._iThreshold=0};o.Z.createPrototypeObject(h,o.Z.objectInherit(A.Z.prototype,{set:function(e,t,i){s.R3.copy(this._start,e),s.R3.copy(this._iStart,e),s.R3.copy(this._end,t),s.R3.copy(this._iEnd,t),void 0!==i&&(this._threshold=this._iThreshold=i)},setStart:function(e){s.R3.copy(this._start,e),s.R3.copy(this._iStart,e)},setEnd:function(e){s.R3.copy(this._end,e),s.R3.copy(this._iEnd,e)},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:(r=s.R3.create(),a=s.R3.create(),function(e){if(!e.valid())return!1;s.R3.sub(r,this._iStart,e.center());var t=s.R3.sqrLen(r)-e.radius2();if(t<=0)return!0;s.R3.sub(a,this._iEnd,this._iStart);var i=s.R3.sqrLen(a),n=2*s.R3.dot(r,a),o=n*n-4*i*t;if(o<0)return!1;var A=.5/i,g=(-n-(o=Math.sqrt(o)))*A,h=(-n+o)*A;return!(g<=0&&h<=0||g>1&&h>1)}),intersect:(n=new g.Z,function(e,t){n.setGeometry(t),n.setIntersectionVisitor(e),n.setIntersector(this),n.set(this._iStart,this._iEnd,this._iThreshold);var i=t.getShape();i?i.intersectLineSegment(n,i.getNodes()[0],this._iStart,this._iEnd,this._iThreshold):(t.computeTransformedVertices&&n.setVertices(t.computeTransformedVertices()),n.apply(t),n.reset())}),setCurrentTransformation:function(e){if(s._E.invert(e,e),this._threshold>0){var t=this._iStart;s._E.getScale(t,e);var i=t[0],n=t[1],r=t[2];this._iThreshold=this._threshold*(i>n?i>r?i:r:n>r?n:r)}s.R3.transformMat4(this._iStart,this._start,e),s.R3.transformMat4(this._iEnd,this._end,e)}}),"osgUtil","LineSegmentIntersector");const c=h},E9Rp:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={NO_LIMIT:0,LIMIT_ONE_PER_DRAWABLE:1,LIMIT_ONE:2,POINT_PRIMITIVES:1,LINE_PRIMITIVES:2,TRIANGLE_PRIMITIVES:4,ALL_PRIMITIVES:7}},Pxgm:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i("GoyH"),r=i("qlNd"),a=i("t5D/"),o=i("iUVs"),s=i("QtIg"),A=i("bfff"),g=i("nRYw"),h=i("W40i"),c=i("Kvhv"),l=i("9Aw2"),u=function(e){o.Z.call(this),this._state=void 0,this._camera=e,this._renderStage=void 0,this._stateGraph=void 0,this._frameStamp=void 0,this._previousCullsettings=new r.Z,this.setDefaults()};u.debugGraph=!1,n.Z.createPrototypeObject(u,n.Z.objectInherit(o.Z.prototype,{setDefaults:function(){this._state=new A.Z(new c.Z.ShaderGeneratorProxy),this._cullVisitor=new a.Z,this._cullVisitor.setRenderer(this),this._stateGraph=new g.Z,this.getCamera().setClearColor(h.vh.create()),this.setRenderStage(new s.Z);var e=i("5naU").Z,t=this.getCamera().getOrCreateStateSet();t.setAttributeAndModes(new e.Material),t.setAttributeAndModes(new e.Depth),t.setAttributeAndModes(new e.BlendFunc),t.setAttributeAndModes(new e.CullFace)},getCullVisitor:function(){return this._cullVisitor},setCullVisitor:function(e){e&&!e.getRenderer()&&e.setRenderer(this),this._cullVisitor=e},setRenderStage:function(e){this._renderStage=e},getCamera:function(){return this._camera},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},getState:function(){return this._state},setState:function(e){this._state=e},setGraphicContext:function(e){this._state.setGraphicContext(e)},getGraphicContext:function(){return this._state.getGraphicContext()},cullAndDraw:function(){this.cull(),this.draw()},cull:function(){var e=this.getCamera(),t=e.getView();this._cullVisitor.setFrameStamp(this._frameStamp),this._cullVisitor.resetStats(),g.Z.reset(),this._stateGraph.clean(),this._renderStage.reset(),this._cullVisitor.reset(),this._cullVisitor.setStateGraph(this._stateGraph),this._cullVisitor.setRenderStage(this._renderStage),this._cullVisitor.pushStateSet(e.getStateSet()),this._previousCullsettings.reset(),this._previousCullsettings.setCullSettings(this._cullVisitor),this._cullVisitor.setCullSettings(e),this._previousCullsettings.getSettingSourceOverrider()===this._cullVisitor&&this._previousCullsettings.getEnableFrustumCulling()&&this._cullVisitor.setEnableFrustumCulling(!0),this._cullVisitor.pushCameraModelViewProjectionMatrix(e,e.getViewMatrix(),e.getProjectionMatrix()),e.getBound();var n=t.getLight(),r=i("OP54").Z;if(n)switch(t.getLightingMode()){case r.LightingMode.HEADLIGHT:this._cullVisitor.addPositionedAttribute(null,n);break;case r.LightingMode.SKY_LIGHT:this._cullVisitor.addPositionedAttribute(e.getViewMatrix(),n)}var a=e.getViewport(),o=e.getScissor();this._cullVisitor.pushViewport(a),this._renderStage.setClearDepth(e.getClearDepth()),this._renderStage.setClearColor(e.getClearColor()),this._renderStage.setClearMask(e.getClearMask()),this._renderStage.setViewport(a),this._renderStage.setScissor(o),this._cullVisitor.setDatabaseRequestHandler(this._camera.getView().getDatabasePager()),this._cullVisitor.handleCullCallbacksAndTraverse(e),this._cullVisitor.popCameraModelViewProjectionMatrix(e),this._cullVisitor.setCullSettings(this._previousCullsettings),this._cullVisitor.popViewport(),this._cullVisitor.popStateSet(),this._renderStage.sort()},draw:function(){var e=this.getState();e.resetCacheFrame(),e.resetStats(),this._renderStage.setCamera(this._camera),this._renderStage.draw(e),u.debugGraph&&(l.Z.instance().createRenderGraph(this._renderStage),u.debugGraph=!1),this._renderStage.setCamera(void 0),e.applyDefault()}}),"osgViewer","Renderer");const d=u},"5ZWq":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("GoyH"),r=i("iUVs"),a=i("LvhW"),o=function(){r.Z.call(this),this._databasePager=new a.Z,this._sceneData=void 0};n.Z.createPrototypeObject(o,n.Z.objectInherit(r.Z.prototype,{getSceneData:function(){return this._sceneData},setSceneData:function(e){this._sceneData=e},setDatabasePager:function(e){this._databasePager=e},getDatabasePager:function(){return this._databasePager},updateSceneGraph:function(e){this._databasePager&&this._databasePager.updateSceneGraph(e.getFrameStamp()),this._sceneData&&this._sceneData.accept(e)}}),"osgViewer","Scene");const s=o},OP54:(e,t,i)=>{"use strict";i.d(t,{Z:()=>y});var n,r,a,o=i("UqX1"),s=i("W6eo"),A=i("p6+I"),g=i("lU+d"),h=i("2Vrk"),c=i("W40i"),l=i("5rJd"),u=i("5pih"),d=i("7itD"),I=i("rsXr"),C=i("Yy1w"),f=i("ojCs"),p=i("BvLe"),m=i("CtxI"),_=i("XDCw"),E=i("Pxgm"),v=i("5ZWq"),S=i("9Aw2"),B=i("u5PS"),w=function(){this._camera=new s.Z,this._camera.setName("OSGJS camera"),this._scene=new v.Z,this._camera.setName("OSGJS Scene"),this._frameStamp=new A.Z,this._lightingMode=void 0,this._manipulator=void 0,this._canvasWidth=0,this._canvasHeight=0,this._requestContinousUpdate=!0,this._requestRedraw=!0,this.setLightingMode(w.LightingMode.HEADLIGHT);var e=this.createRenderer(this.getCamera());e.setFrameStamp(this._frameStamp),this.getCamera().setRenderer(e),this.getCamera().setView(this)};w.LightingMode={NO_LIGHT:0,HEADLIGHT:1,SKY_LIGHT:2},w.prototype={requestRedraw:function(){this._requestRedraw=!0},requestContinuousUpdate:function(e){this._requestContinousUpdate=e},createRenderer:function(e){return new E.Z(e)},setGraphicContext:function(e){this.getCamera().getRenderer().getState().setGraphicContext(e)},getGraphicContext:function(){return this.getCamera().getRenderer().getState().getGraphicContext()},initWebGLCaps:function(e,t){p.Z.instance(e,t)},computeCanvasSize:function(e){a||(window.ResizeObserver?((a=new ResizeObserver((function(){n=e.clientWidth,r=e.clientHeight}))).observe(e),n=e.clientWidth,r=e.clientHeight):(n=e.clientWidth,r=e.clientHeight)),n<1&&(n=1),r<1&&(r=1);var t=this._devicePixelRatio,i=Math.floor(n*t),o=Math.floor(r*t),s=!1;return this._canvasWidth!==i&&(e.width=i,this._canvasWidth=i,s=!0),this._canvasHeight!==o&&(e.height=o,this._canvasHeight=o,s=!0),s},getCanvasWidth:function(){return this._canvasWidth},getCanvasHeight:function(){return this._canvasHeight},getCanvasClientWidth:function(){return Math.ceil(this._canvasWidth/this._devicePixelRatio)},getCanvasClientHeight:function(){return Math.ceil(this._canvasHeight/this._devicePixelRatio)},getCanvasPixelRatio:function(){return this._devicePixelRatio},setUpView:function(e,t){var i=window.devicePixelRatio||1,n=t.getNumber("overrideDevicePixelRatio"),r=t.getNumber("maxDevicePixelRatio")||-1;"number"==typeof n?i=n:-1!==r&&(i=Math.min(i,r)),this._devicePixelRatio=i,this.computeCanvasSize(e);var a=e.width,o=e.height,s=a/o;if(this._camera.setViewport(new C.Z(0,0,a,o)),this._camera.setScissor(new I.Z),this._camera.setGraphicContext(this.getGraphicContext()),c._E.lookAt(this._camera.getViewMatrix(),c.R3.fromValues(0,0,-10),c.R3.create(),c.R3.fromValues(0,1,0)),c._E.perspective(this._camera.getProjectionMatrix(),Math.PI/180*55,s,1,1e3),t&&t.enableFrustumCulling&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t&&t.debugGraph){var A=this.getCamera();S.Z.instance().refreshGraph=function(){var e=S.Z.instance();e.setDisplayGraphRenderer(!0),e.createGraph(A)},B.Z.log("to refresh the graphs type in the console:\nOSG.osgUtil.DisplayGraph.instance().refreshGraph()")}},computeIntersections:function(e,t,i){return void 0===i&&(i=-1),this._lsi?this._lsi.reset():this._lsi=new _.Z,this._origIntersect||(this._origIntersect=c.R3.create(),this._dstIntersect=c.R3.create()),this._lsi.set(c.R3.set(this._origIntersect,e,t,0),c.R3.set(this._dstIntersect,e,t,1)),this._iv?this._iv.reset():(this._iv=new m.Z,this._iv.setIntersector(this._lsi)),this._iv.setTraversalMask(i),this._camera.accept(this._iv),this._lsi.getIntersections()},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setSceneData:function(e){if(e!==this._scene.getSceneData()){this._scene.setSceneData(e);for(var t=this._camera.getChildren(),i=void 0,n=0,r=t.length;n<r;n++)if("osgStats"===t[n].getName()){i=t[n];break}this._camera.removeChildren(),this._camera.addChild(e),i&&this._camera.addChild(i)}},getSceneData:function(){return this._scene.getSceneData()},setDatabasePager:function(e){this._scene.setDatabasePager(e)},getDatabasePager:function(){return this._scene.getDatabasePager()},getScene:function(){return this._scene},getManipulator:function(){return this._manipulator},setManipulator:function(e){this._manipulator=e},getLight:function(){return this._light},setLight:function(e){this._light=e,this._lightingMode!==w.LightingMode.NO_LIGHT&&this._scene.getOrCreateStateSet().setAttributeAndModes(this._light)},getLightingMode:function(){return this._lightingMode},setLightingMode:function(e){this._lightingMode!==e&&(this._lightingMode=e,this._lightingMode!==w.LightingMode.NO_LIGHT?this._light||(this._light=new h.Z):this._light=void 0)},flushDeletedGLObjects:function(e){var t=this.getGraphicContext(),i=e;i=o.Z.flushDeletedGLBufferArrays(t,i),i=f.Z.flushDeletedGLVertexArrayObjects(t,i),i=l.Z.getTextureManager(t).flushDeletedTextureObjects(t,i),i=u.Z.flushDeletedGLPrograms(t,i),i=d.Z.flushDeletedGLShaders(t,i),i=g.Z.flushDeletedGLFrameBuffers(t,i),g.Z.flushDeletedGLRenderBuffers(t,i)},flushAllDeletedGLObjects:function(){var e=this.getGraphicContext();f.Z.flushAllDeletedGLVertexArrayObjects(e),o.Z.flushAllDeletedGLBufferArrays(e),l.Z.getTextureManager(e).flushAllDeletedTextureObjects(e),u.Z.flushAllDeletedGLPrograms(e),d.Z.flushAllDeletedGLShaders(e),g.Z.flushAllDeletedGLFrameBuffers(e),g.Z.flushAllDeletedGLRenderBuffers(e)}};const y=w},"Lz+S":(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n={SCENE:"scene",MANIPULATORS:"scene.manipulators",ORBIT_MANIPULATOR:"scene.manipulators.orbit",ORBIT_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.orbit.mousekeyboard",ORBIT_MANIPULATOR_RESETTOHOME:"scene.manipulators.orbit.mousekeyboard.home",ORBIT_MANIPULATOR_TOUCH:"scene.manipulators.orbit.touch",ORBIT_MANIPULATOR_WEBVR:"scene.manipulators.orbit.webvr",ORBIT_MANIPULATOR_DEVICEORIENTATION:"scene.manipulators.orbit.deviceorientation",ORBIT_MANIPULATOR_GAMEPAD:"scene.manipulators.orbit.gamepad",FPS_MANIPULATOR:"scene.manipulators.fps",FPS_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.fps.mousekeyboard",FPS_MANIPULATOR_RESETTOHOME:"scene.manipulators.fps.mousekeyboard.home",FPS_MANIPULATOR_TOUCH:"scene.manipulators.fps.touch",FPS_MANIPULATOR_WEBVR:"scene.manipulators.fps.webvr",FPS_MANIPULATOR_DEVICEORIENTATION:"scene.manipulators.fps.deviceorientation",FPS_MANIPULATOR_GAMEPAD:"scene.manipulators.fps.gamepad",CAD_MANIPULATOR:"scene.manipulators.cad",CAD_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.cad.mousekeyboard",CAD_MANIPULATOR_RESETTOHOME:"scene.manipulators.cad.mousekeyboard.home",CAD_MANIPULATOR_TOUCH:"scene.manipulators.cad.touch",NODE_GIZMO:"scene.nodegizmo",UI:"ui",STATS:"ui.stats"};const r=n},F5Ms:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n,r,a,o=(n=!0,r=function(e,t,i){for(var n=null,r=0;r<i.length;++r){try{n=e.getContext(i[r],t)}catch(e){}if(n)break}return n},{create3DContext:a=function(e,t){var i;if(t&&t.webgl2){if(n=!1,i=r(e,t,["webgl2","experimental-webgl2"]))return i;n=!0}return r(e,t,["webgl","experimental-webgl","webkit-3d","moz-webgl"])},setupWebGL:function(e,t,i){i=i||function(e){if(n){var t=document.getElementsByTagName("body")[0];if(t){var i=window.WebGLRenderingContext?'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>':'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>';e&&(i+="<br/><br/>Status: "+e),t.innerHTML=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"}(i)}}},e.addEventListener&&e.addEventListener("webglcontextcreationerror",(function(e){i(e.statusMessage)}),!1);var r=a(e,t);return r||i(""),r}});window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}),window.cancelRequestAnimFrame||(window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout),Date.now||(Date.now=function(){return(new Date).getTime()});const s=o},aa6s:(e,t,i)=>{"use strict";i.d(t,{I:()=>s,c:()=>A});var n=i("/c5M"),r=i("g6dK"),a=!0,o=0,s=function(e){a=e},A=function(e){var t,s,A,g,h,c,l,u,d;e.osg.Program.registerErrorCallback((function(I,C,f){if(a&&(!(!f||0===f.length)&&-1===f.indexOf("Internal linking error"))){t||(t=e.osg.WebGLCaps.instance(),s=t.getWebGLParameter("UNMASKED_RENDERER_WEBGL"),A=t.getWebGLParameter("UNMASKED_VENDOR_WEBGL"),g=t.getWebGLParameter("MAX_VARYING_VECTORS"),h=t.getWebGLParameter("MAX_VERTEX_ATTRIBS"),c=t.getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS"),l=t.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS"),u=i("R2Pi"),d=u&&u.apple&&u.apple.device);var p="Shader Error: ";if(p+=f,!d)if(s&&(p+="\n"+s),A&&(p+="\n"+A),30!==g&&(p+="\nVarying: "+g),I&&(16!==h&&(p+="\nAttributes:"+h),4096!==l&&(p+="\nVertUnif:"+l)),1024!==c&&(p+="\nFragUnif:"+c),t.isWebGL2())p+="\nWebGL2";else{var m,_=t.getWebGLExtensions(),E=["EXT_shader_texture_lod","OES_standard_derivatives","OES_vertex_array_object","EXT_texture_filter_anisotropic"];for(m=0;m<E.length;m++){var v=E[m];_[v]&&(p+="\n"+v.substring(v.indexOf("_")+1))}for(var S=["hasLinearFloatRTT","hasLinearHalfFloatRTT","hasHalfFloatRTT","hasFloatRTT"];m<S.length;m++){var B=S[m];t[B]()&&(p+="\n"+B.substring(3))}}I&&(p+="\nVS\n"+I),C&&(p+="\nFS\n "+C);var w="errorLogs ";c<64&&(w="ultraLowGPU");var y={tags:{shaderErrors:w}};if(n.Z.client.captureMessage(p,y),++o>1){a=!1;var M=new r.Z({title:"3D/WebGL context error",text:"An error occurred while rendering the model. It might not look as expected.",safe:!0,buttons:{continue:!0,continueLabel:"OK",cancel:!1}});M.open().then(function(){M.close()}.bind(this))}}}))}},aqzA:(e,t,i)=>{"use strict";i.d(t,{Z:()=>Vo});i("tlSa");var n=i("I50a"),r=i("5naU"),a=i("GoyH"),o=i("W40i");const s={Vec3:0,Quat:1,Float:2,FloatCubicBezier:3,Vec3CubicBezier:4,QuatSlerp:5,Matrix:6,Count:7};var A={InvalidTargetID:-1},g=function(e,t,i){return{type:e,id:A.InvalidTargetID,channels:[],value:t,defaultValue:i}};A.createQuatTarget=function(e){return g(s.Quat,o.gf.copy(o.gf.create(),e),o.gf.copy(o.gf.create(),e))},A.createVec3Target=function(e){return g(s.Vec3,o.R3.copy(o.R3.create(),e),o.R3.copy(o.R3.create(),e))},A.createFloatTarget=function(e){return g(s.Float,e,e)},A.createMatrixTarget=function(e){return g(s.Matrix,o._E.copy(o._E.create(),e),o._E.copy(o._E.create(),e))};const h=A;var c={},l=function(e,t,i,n,r,a){var o=i[0],s=i[i.length-1];return a.start=o,a.keys=t,a.end=s,a.times=i,a.type=e,a.duration=s-o,a.target=n,a.name=r,a},u={create:function(){return 0}},d={create:function(){return o.R3.create32()}},I={create:function(){return o.gf.create32()}},C=function(e,t){return{channel:t,value:e.create(),targetID:h.InvalidTargetID,weight:1,key:0,start:0,end:0}},f=function(e){return C(d,e)},p=function(e){return C(I,e)},m=function(e){return C(u,e)},_=function(e){return C(u,e)},E=function(e){return C(d,e)};c.createInstanceChannel=function(e){return c[e.type](e)},c.createInstanceVec3Channel=f,c.createInstanceQuatChannel=p,c.createInstanceQuatSlerpChannel=p,c.createInstanceFloatChannel=m,c.createInstanceFloatCubicBezierChannel=_,c.createInstanceVec3CubicBezierChannel=E,c.createVec3Channel=function(e,t,i,n,r){return l(s.Vec3,e,t,i,n,r||{})},c.createQuatChannel=function(e,t,i,n,r){return l(s.Quat,e,t,i,n,r||{})},c.createQuatSlerpChannel=function(e,t,i,n,r){return l(s.QuatSlerp,e,t,i,n,r||{})},c.createFloatChannel=function(e,t,i,n,r){return l(s.Float,e,t,i,n,r||{})},c.createFloatCubicBezierChannel=function(e,t,i,n,r){return l(s.FloatCubicBezier,e,t,i,n,r||{})},c.createVec3CubicBezierChannel=function(e,t,i,n,r){return l(s.Vec3CubicBezier,e,t,i,n,r||{})},c[s.Vec3]=f,c[s.Quat]=p,c[s.QuatSlerp]=p,c[s.Float]=m,c[s.FloatCubicBezier]=_,c[s.Vec3CubicBezier]=E,c.ChannelType=s;const v=c;var S=0,B=function(){};B.createAnimation=function(e,t){for(var i=1/0,n=-1/0,r=0;r<e.length;r++)i=Math.min(i,e[r].start),n=Math.max(n,e[r].end);var a=n-i,o=t||"animation"+S.toString();return S++,{channels:e,duration:a,name:o,start:i}},B.createInstanceAnimation=function(e){for(var t=[],i=0;i<e.channels.length;i++){var n=v.createInstanceChannel(e.channels[i]);t.push(n)}return{channels:t,duration:e.duration,start:0,name:e.name,firstKeyTime:e.start}};const w=B;var y,M,D,b,Q,x,T=i("4yGu"),F=i("wLWJ"),R=i("u5PS"),N=i("iUVs"),L=function(e,t,i){i[0]=t[e++],i[1]=t[e++],i[2]=t[e++]},k=function(e,t,i){i[0]=t[e++],i[1]=t[e++],i[2]=t[e++],i[3]=t[e++]},P=function(e,t){var i=t.channel,n=t.value,r=i.keys,a=i.times;if(e>=a[a.length-1])return t.key=0,void L(r.length-3,r,n);if(e<=a[0])return t.key=0,void L(0,r,n);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=a[o],A=a[o+1],g=3*o,h=r[g++],c=r[g++],l=r[g++],u=r[g++],d=r[g++],I=r[g++],C=(e-s)/(A-s);n[0]=h+(u-h)*C,n[1]=c+(d-c)*C,n[2]=l+(I-l)*C,t.key=o},U=(y=o.gf.create32(),M=o.gf.create32(),function(e,t){var i=t.channel,n=t.value,r=i.keys,a=i.times;if(e>=a[a.length-1])return t.key=0,void k(r.length-4,r,n);if(e<=a[0])return t.key=0,void k(0,r,n);var s=t.key;if(e>a[s])for(;a[s+1]<e;)s++;else if(e<a[s])for(;a[s]>e;)s--;var A=a[s],g=a[s+1],h=4*s;y[0]=r[h++],y[1]=r[h++],y[2]=r[h++],y[3]=r[h++],M[0]=r[h++],M[1]=r[h++],M[2]=r[h++],M[3]=r[h++];var c=(e-A)/(g-A);o.gf.nlerp(n,y,M,c),t.key=s}),O=function(){var e=o.gf.create32(),t=o.gf.create32();return function(i,n){var r=n.channel,a=n.value,s=r.keys,A=r.times;if(i>=A[A.length-1])return n.key=0,void k(s.length-4,s,a);if(i<=A[0])return n.key=0,void k(0,s,a);var g=n.key;if(i>A[g])for(;A[g+1]<i;)g++;else if(i<A[g])for(;A[g]>i;)g--;var h=A[g],c=A[g+1],l=4*g;e[0]=s[l++],e[1]=s[l++],e[2]=s[l++],e[3]=s[l++],t[0]=s[l++],t[1]=s[l++],t[2]=s[l++],t[3]=s[l++];var u=(i-h)/(c-h);o.gf.slerp(a,e,t,u),n.key=g}}(),G=function(e,t){var i=t.channel,n=t.value,r=i.keys,a=i.times;if(e>=a[a.length-1])return t.key=0,void(t.value=r[r.length-1]);if(e<=a[0])return t.key=0,void(t.value=r[0]);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=a[o],A=a[o+1],g=o,h=r[g++];n=h+(r[g++]-h)*((e-s)/(A-s)),t.key=o,t.value=n},H=function(e,t){var i=t.channel,n=t.value,r=i.keys,a=i.times;if(e>=a[a.length-1])return t.key=0,void(t.value=r[r.length-3]);if(e<=a[0])return t.key=0,void(t.value=r[0]);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=(e-a[o])/(a[o+1]-a[o]),A=1-s,g=A*A,h=g*A,c=s*s,l=3*o;n=r[l]*h+r[l+1]*(3*s*g)+r[l+2]*(3*c*A)+r[l+3]*(c*s),t.key=o,t.value=n},K=(D=o.R3.create(),b=o.R3.create(),Q=o.R3.create(),x=o.R3.create(),function(e,t){var i=t.channel,n=t.value,r=i.keys,a=i.times;if(e>=a[a.length-1])return t.key=0,void L(r.length-9,r,n);if(e<=a[0])return t.key=0,void L(0,r,n);var s=t.key;if(e>a[s])for(;a[s+1]<e;)s++;else if(e<a[s])for(;a[s]>e;)s--;var A=(e-a[s])/(a[s+1]-a[s]),g=1-A,h=g*g,c=h*g,l=A*A,u=9*s;o.R3.scale(D,o.R3.set(D,r[u++],r[u++],r[u++]),c),o.R3.scale(b,o.R3.set(b,r[u++],r[u++],r[u++]),3*A*h),o.R3.scale(Q,o.R3.set(Q,r[u++],r[u++],r[u++]),3*l*g),o.R3.scale(x,o.R3.set(x,r[u++],r[u++],r[u++]),l*A),n[0]=D[0]+b[0]+Q[0]+x[0],n[1]=D[1]+b[1]+Q[1]+x[1],n[2]=D[2]+b[2]+Q[2]+x[2],t.key=s}),Z=v.ChannelType,V={};V[Z.Vec3]=P,V[Z.Quat]=U,V[Z.QuatSlerp]=O,V[Z.Float]=G,V[Z.FloatCubicBezier]=H,V[Z.Vec3CubicBezier]=K,V.Vec3LerpInterpolator=P,V.QuatLerpInterpolator=U,V.QuatSlerpInterpolator=O,V.FloatLerpInterpolator=G,V.FloatCubicBezierInterpolator=H,V.Vec3CubicBezierInterpolator=K;const Y=V;var J=i("CJNH"),z=function(){J.Z.call(this),this._animationUpdateCallback={}};a.Z.createPrototypeObject(z,a.Z.objectInherit(J.Z.prototype,{getAnimationUpdateCallbackMap:function(){return this._animationUpdateCallback},apply:function(e){for(var t=e.getUpdateCallbackList(),i=0,n=t.length;i<n;i++){var r=t[i];r instanceof F.Z&&(this._animationUpdateCallback[r.getInstanceID()]=r)}this.traverse(e)}}),"osgAnimation","CollectAnimationUpdateCallbackVisitor");const j=z;var W=i("UqX1"),q=i("5Zr1"),X=i("mixV"),$=function(){F.Z.call(this),this._targets=[],this._targetNames=[],this._morphs=[],this._weights=new Float32Array(X.Z.MAX_MORPH_GPU),this._indexMap=new Uint32Array(X.Z.MAX_MORPH_GPU),this._gpuMorphed=[],this._maxMorphGPU=-1},ee=function(e,t){return Math.abs(t.value)-Math.abs(e.value)};a.Z.createPrototypeObject($,a.Z.objectInherit(F.Z.prototype,{_initNode:function(e){var t;e instanceof X.Z?t=e:e instanceof q.Z&&e.getSourceGeometry()instanceof X.Z&&(t=e.getSourceGeometry()),t&&t.getName()===this.getName()&&(t.isInitialized()||t.init(),this._morphs.push(t),this._maxMorphGPU=Math.min(this._maxMorphGPU,t.getMaximumPossibleMorphGPU()))},init:function(e){this._maxMorphGPU=X.Z.MAX_MORPH_GPU,this._morphs.length=0;var t=e.getChildren();if(t.length)for(var i=0,n=t.length;i<n;i++)this._initNode(t[i]);else this._initNode(e)},isInitialized:function(){var e=this._morphs,t=e.length;if(!t)return!1;for(var i=0;i<t;++i)if(!e[i].isInitialized())return!1;return!0},getNumTarget:function(){return this._targets.length},getTarget:function(e){return this._targets[e]},getTargetName:function(e){return this._targetNames[e]},addTarget:function(e,t){this._targets[t]=h.createFloatTarget(0),this._targetNames[t]=e},_remapBufferArrays:function(){for(var e=this._indexMap,t=this._morphs,i=0;i<this._maxMorphGPU;++i)for(var n="_"+i,r="_"+e[i],a=0,o=t.length;a<o;++a)for(var s=t[a],A=s.getVertexAttributeList(),g=s.getMorphTargetNames(),h=0,c=g.length;h<c;++h){var l=g[h];A[l+n].setBufferArray(A[l+r].getInitialBufferArray())}},_mergeExtraMorphTarget:function(e,t,i){var n=0,r=this._gpuMorphed,a=e[t],o=a.getElements().length,s=o/a.getItemSize(),A=a.getItemSize();a._cpuMorph=a._cpuMorph||new W.Z(W.Z.ARRAY_BUFFER,new Float32Array(o),A);var g=a._cpuMorph.getElements();for(n=0;n<o;++n)g[n]=0;for(var h=this._targets,c=0,l=h.length;c<l;++c)if(!0!==r[c]){var u=h[c].value;if(!(Math.abs(u)<=X.Z.EFFECTIVE_EPS)){u/=i;var d=e[t+"_"+c].getInitialBufferArray().getElements();for(n=0;n<s;++n){var I=n*A;g[I]+=u*d[I],g[I+1]+=u*d[I+1],g[I+2]+=u*d[I+2]}}}e[t+"_"+(this._maxMorphGPU-1)].setBufferArray(a._cpuMorph),a._cpuMorph.dirty()},_computeExtraWeightsSum:function(){for(var e=this._gpuMorphed,t=0,i=this._targets,n=0,r=i.length;n<r;++n)if(!0!==e[n]){var a=i[n].value;Math.abs(a)<=X.Z.EFFECTIVE_EPS||(t+=a)}var o=1e-5;return Math.abs(t)>o?t:t<0?-o:o},_morphBufferArrayCPU:function(){for(var e=this._weights[this._maxMorphGPU-1]=this._computeExtraWeightsSum(),t={},i=this._morphs,n=0,r=i.length;n<r;++n)for(var a=i[n],o=a.getVertexAttributeList(),s=a.getMorphTargetNames(),A=0,g=s.length;A<g;++A){var h=s[A],c=o[h];c&&!t[c.getInstanceID()]&&(t[c.getInstanceID()]=!0,this._mergeExtraMorphTarget(o,h,e))}},updateWeights:function(){if(0!==this._maxMorphGPU){var e=0,t=this._targets,i=t.length,n=this._weights;if(n[0]=n[1]=n[2]=n[3]=0,i<=this._maxMorphGPU)for(e=0;e<i;++e)n[e]=t[e].value;else{var r=this._indexMap;r[0]=r[1]=r[2]=r[3]=0;var a=this._gpuMorphed;for(a.length=i,e=0;e<i;++e)a[e]=!1;var o=t.slice(0).sort(ee);for(e=0;e<this._maxMorphGPU;++e){var s=t.indexOf(o[e]);a[s]=!0,r[e]=s,n[e]=o[e].value}var A=Math.abs(o[this._maxMorphGPU].value)>X.Z.EFFECTIVE_EPS;a[r[this._maxMorphGPU-1]]=!A,this._remapBufferArrays(),A&&this._morphBufferArrayCPU()}}},reset:function(){for(var e=this._targets,t=0,i=e.length;t<i;++t)e[t].value=e[t].defaultValue},update:function(e){this.isInitialized()||this.init(e),this.updateWeights();for(var t=this._weights,i=Math.min(this._maxMorphGPU,this._targets.length),n=this._morphs,r=0,a=n.length;r<a;++r)for(var o=n[r].getTargetsWeight(),s=0;s<i;s++)o[s]=t[s];return!0}}),"osgAnimation","UpdateMorph");const te=$;var ie=i("mix8"),ne=i("U5Vy"),re={lerp:function(e,t,i){return e+(t-e)*i},init:function(){return 0},copy:function(e,t){return t},create:function(){return 0}},ae=[];ae[v.ChannelType.Float]=1,ae[v.ChannelType.FloatCubicBezier]=1,ae[v.ChannelType.Vec3]=3,ae[v.ChannelType.Vec3CubicBezier]=3,ae[v.ChannelType.Quat]=4,ae[v.ChannelType.QuatSlerp]=4,ae[v.ChannelType.Matrix]=16;var oe=[];oe.length=v.ChannelType.Count,oe[v.ChannelType.Vec3]=o.R3,oe[v.ChannelType.Quat]=o.gf,oe[v.ChannelType.QuatSlerp]=o.gf,oe[v.ChannelType.Float]=re,oe[v.ChannelType.FloatCubicBezier]=re,oe[v.ChannelType.Vec3CubicBezier]=o.R3,oe[v.ChannelType.Matrix]=o._E;var se=function(){N.Z.call(this),this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._targets=[],this._targetsMap={},this._targetsByTypes=[],this._targetsByTypes.length=v.ChannelType.Count;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e]=[];this._activeAnimations={},this._activeAnimationList=[],this._activeChannelsByTypes=[],this._activeChannelsByTypes.length=v.ChannelType.Count;for(var i=0,n=this._activeChannelsByTypes.length;i<n;i++)this._activeChannelsByTypes[i]=[];this._animationsUpdateCallback={},this._animationsUpdateCallbackArray=[],this._animationsToRegister=[],this._pause=!1,this._dirty=!1,this._seekTime=-1};a.Z.createPrototypeObject(se,a.Z.objectInherit(N.Z.prototype,{init:function(e){this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._resetTargets(),this._activeAnimations={},this._activeAnimationList.length=0;for(var t=0,i=this._activeChannelsByTypes.length;t<i;t++)this._activeChannelsByTypes[t].length=0;this._animationsUpdateCallback={},this._animationsUpdateCallbackArray.length=0,this._pause=!1,this._seekTime=-1,this.addAnimations(e)},addAnimations:function(e){var t=this._addAnimation(e);Array.prototype.push.apply(this._animationsToRegister,t),this._dirty=!0,this._registerAnimations()},update:function(e,t){this._dirty&&(this._findAnimationUpdateCallback(e),this._registerTargetFoundInAnimationCallback(),this._registerAnimations());var i=t.getFrameStamp().getSimulationTime();return-1!==this._seekTime&&(this._pauseTime=-this._seekTime+this._startTime+i),this._seekTime=-1,this._pause?this._pauseTime=i-this._simulationTime+this._startTime:this._simulationTime=this._startTime+(i-this._pauseTime),this.updateManager(this._simulationTime*this._timeFactor),!0},updateManager:function(e){this._processStartAnimation(e);for(var t=v.ChannelType.Count,i=0;i<t;i++){var n=this._activeChannelsByTypes[i];this._updateChannelsType(e,n,Y[i])}for(var r=0;r<t;r++){var a=this._targetsByTypes[r];this._updateTargetType(a,oe[r])}for(var o=0,s=this._animationsUpdateCallbackArray.length;o<s;o++){this._animationsUpdateCallbackArray[o].computeChannels()}this._removeFinishedAnimation(e)},togglePause:function(){this._pause=!this._pause,this._pause||(this._seekTime=this._simulationTime)},getSimulationTime:function(){return this._simulationTime},setSimulationTime:function(e){this._simulationTime=e},setSeekTime:function(e){this._simulationTime=e,this._seekTime=e},stopAnimation:function(e){for(var t=this._activeAnimationList,i=0,n=t.length;i<n;++i)if(t[i].name===e)return this._removeActiveChannels(this._instanceAnimations[e]),this._activeAnimations[e]=void 0,void t.splice(i,1)},stopAllAnimation:function(){for(var e=this._activeAnimationList,t=0,i=e.length;t<i;++t){var n=e[t].name;this._removeActiveChannels(this._instanceAnimations[n]),this._activeAnimations[n]=void 0}e.length=0},setTimeFactor:function(e){var t=e/this._timeFactor;this._startTime+=(this._simulationTime-this._simulationTime*t)/t,this._timeFactor=e,this._pause&&(this._simulationTime+=(this._simulationTime-this._simulationTime*t)/t)},getTimeFactor:function(){return this._timeFactor},isPlaying:function(e){return!!this._activeAnimations[e]},playAnimationObject:function(e){var t=this._instanceAnimations[e.name];t?this.isPlaying(e.name)||(t.priority=void 0===e.priority?0:e.priority,t.weight=void 0===e.weight?1:e.weight,t.loop=void 0===e.loop||e.loop,this._startAnimations[t.name]=t):R.Z.info("no animation "+e.name+" found")},playAnimation:function(e,t,i,n){var r;return r="object"==typeof e?e:{name:e,priority:i,weight:n,loop:t},this.playAnimationObject(r)},getAnimations:function(){return this._instanceAnimations},_registerAnimations:function(){if(this._targets.length){for(var e=0,t=this._animationsToRegister.length;e<t;e++){var i=this._animationsToRegister[e];this._registerInstanceAnimation(i)}this._animationsToRegister.length=0,this._dirty=!1}},_registerInstanceAnimation:function(e){for(var t=e.channels,i=0,n=t.length;i<n;i++){var r=t[i],a=r.channel.target+"."+r.channel.name;this._targetMap[a]?r.targetID=this._targetMap[a].id:R.Z.warn("registerInstanceAnimation did not find targetName ("+a+") in the scene graph")}return!0},_findAnimationUpdateCallback:function(e){var t=new j;e.accept(t),this._animationsUpdateCallback=t.getAnimationUpdateCallbackMap()},_registerTargetFoundInAnimationCallback:function(){this._resetTargets();var e,t,i=0,n=this._targetMap,r=this._targets,a=function(e,t){if(n[e])t!==n[e]&&R.Z.warn("detected differents target instance with the same name ("+e+")");else{n[e]=t,t.id=i++,r.push(t);var a=t.type;this._targetsByTypes[a].push(t)}}.bind(this);for(var o in this._animationsUpdateCallback){var s=this._animationsUpdateCallback[o];if(s instanceof ne.Z||s instanceof ie.Z){var A=s.getStackedTransforms(),g=A.length;if(!g)continue;this._animationsUpdateCallbackArray.push(s);for(var h=0;h<g;h++){var c=A[h];e=c.getTarget(),t=c.getName(),a(s.getName()+"."+t,e,t)}}else if(s instanceof te){var l=s.getNumTarget();if(!l)continue;this._animationsUpdateCallbackArray.push(s);for(var u=0;u<l;u++)a((t=s.getTargetName(u))+"."+u,e=s.getTarget(u),t)}}},_addAnimation:function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],a=r.name;if(!this._instanceAnimations[a]){var o=w.createInstanceAnimation(r);this._instanceAnimations[a]=o,t.push(o)}}return t},_addActiveChannels:function(e,t){for(var i=t.channels,n=0,r=i.length;n<r;n++){var a=i[n],o=a.channel.type;a.t=e,a.instanceAnimation=t;var s=a.targetID;s!==h.InvalidTargetID&&(this._activeChannelsByTypes[o].push(a),this._targets[s].channels.push(a))}},_removeActiveChannels:function(e){for(var t=e.channels,i=0,n=t.length;i<n;i++){var r=t[i],a=r.channel.type,o=r.targetID;if(o!==h.InvalidTargetID){var s=this._targets[o].channels,A=s.indexOf(r);s.splice(A,1);var g=this._activeChannelsByTypes[a],c=g.indexOf(r);g.splice(c,1)}}},_updateTargetType:function(e,t){for(var i=0,n=e.length;i<n;i++){var r=e[i],a=r.channels,o=a.length;if(0===o)r.value=t.copy(r.value,r.defaultValue);else if(1===o)r.value=t.copy(r.value,a[0].value);else{r.value=t.init(r.value);for(var s=0,A=0,g=a.length;A<g;A++){var h=a[A],c=h.weight;if(0!==(s+=c)&&0!==c){var l=c/s;r.value=t.lerp(r.value,r.value,h.value,l)}}}}},_updateChannelsType:function(e,t,i){for(var n=0,r=t.length;n<r;n++){var a=t[n],o=a.instanceAnimation,s=o.loop,A=e-a.t;s&&o.duration>0&&(A<0?A=o.duration-Math.abs(A%o.duration):A%=o.duration),i(A+o.firstKeyTime,a)}},_removeFinishedAnimation:function(e){for(var t=this._activeAnimationList,i=0;i<t.length;){var n=t[i],r=n.name;e>n.end&&!1===n.loop?(this._removeActiveChannels(n),this._activeAnimations[r]=void 0,t.splice(i,1)):i++}},_addActiveAnimation:function(e,t){this._activeAnimations[t.name]=t;var i=this._instanceAnimations[t.name];i.start=e,i.end=e+i.duration,this._addActiveChannels(e,i),this._activeAnimationList.push(i)},_processStartAnimation:function(e){if(this._targets.length){var t;for(t in this._startAnimations){var i=this._startAnimations[t],n=i.name;this.isPlaying(n)||this._addActiveAnimation(e,i)}void 0!==t&&(this._startAnimations={})}},_resetTargets:function(){this._targetMap={},this._targets.length=0;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e].length=0},resetUpdateCallbacks:function(){for(var e=this._animationsUpdateCallbackArray,t=0,i=e.length;t<i;t++)e[t].reset()},resetAllStackedTransforms:function(){R.Z.warn("Uses resetUpdateCallback instead"),this.resetUpdateCallbacks()},setAnimationLerpEndStart:function(e,t){var i=e.channels;void 0===e.originalDuration&&(e.originalDuration=e.duration),e.duration=e.originalDuration+t;for(var n=e.firstKeyTime,r=e.originalDuration,a=0,o=i.length;a<o;++a){var s=i[a].channel;if(!(Math.abs(s.start-n)>.01||Math.abs(s.duration-r)>.01)){void 0===s.originalEnd&&(s.originalEnd=s.end),s.end=s.originalEnd+t;var A=ae[s.type],g=s.times.buffer.byteLength/4;if(0===t)s.keys=new Float32Array(s.keys.buffer,0,(g-1)*A),s.times=new Float32Array(s.times.buffer,0,g-1);else{s.keys=new Float32Array(s.keys.buffer,0,g*A);for(var h=(g-1)*A,c=0;c<A;++c)s.keys[h+c]=s.keys[c];s.times=new Float32Array(s.times.buffer,0,g),s.times[g-1]=s.times[g-2]+t}}}}}),"osgAnimation","BasicAnimationManager"),se.TypeToSize=ae;const Ae=se;var ge=i("igDg");const he={easeLinear:function(e){return e},easeOutQuad:function(e){var t=e-1;return 1-t*t},easeInQuad:function(e){return e*e},easeInOutQuad:function(e){var t=e-1,i=2*e;return i<1?e*i:1-t*t*2},easeOutCubic:function(e){var t=e-1;return 1+t*t*t},easeInCubic:function(e){return e*e*e},easeInOutCubic:function(e){var t=e-1,i=2*e;return i<1?e*i*i:1+t*t*t*4},easeOutQuart:function(e){var t=e-1;return 1-t*t*t*t},easeInQuart:function(e){return e*e*e*e},easeInOutQuart:function(e){var t=e-1,i=2*e;return i<1?e*i*i*i:1-t*t*t*t*8},easeOutQuintic:function(e){var t=e-1;return 1+t*t*t*t*t},easeInQuintic:function(e){return e*e*e*e*e},easeInOutQuintic:function(e){var t=e-1,i=2*e;return i<1?e*i*i*i*i:1+t*t*t*t*t*16},easeOutSextic:function(e){var t=e-1;return 1-t*t*t*t*t*t},easeInSextic:function(e){return e*e*e*e*e*e},easeInOutSextic:function(e){var t=e-1,i=2*e;return i<1?e*i*i*i*i*i:1-t*t*t*t*t*t*32},easeOutSeptic:function(e){var t=e-1;return 1+t*t*t*t*t*t*t},easeInSeptic:function(e){return e*e*e*e*e*e*e},easeInOutSeptic:function(e){var t=e-1,i=2*e;return i<1?e*i*i*i*i*i*i:1+t*t*t*t*t*t*t*64},easeOutOctic:function(e){var t=e-1;return 1-t*t*t*t*t*t*t*t},easeInOctic:function(e){return e*e*e*e*e*e*e*e},easeInOutOctic:function(e){var t=e-1,i=2*e;return i<1?e*i*i*i*i*i*i*i:1-t*t*t*t*t*t*t*t*128},easeOutBack:function(e){var t=e-1,i=1.70158;return 1+t*t*(t*(i+1)+i)},easeInBack:function(e){var t=1.70158;return e*e*(e*(t+1)-t)},easeInOutBack:function(e){var t=e-1,i=2*e,n=2.5949095;return e<.5?e*i*(i*(n+1)-n):1+2*t*t*(2*t*(n+1)+n)},easeOutCircle:function(e){var t=e-1;return Math.sqrt(1-t*t)},easeInCircle:function(e){return 1-Math.sqrt(1-e*e)},easeInOutCircle:function(e){var t=e-1,i=2*e;return i<1?.5*(1-Math.sqrt(1-i*i)):.5*(Math.sqrt(1-4*t*t)+1)},easeOutElastic:function(e){return Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1},easeInElastic:function(e){return-1*Math.pow(2,10*e)*Math.sin(2*(e-1-.075)*Math.PI/.3)},easeInOutElastic:function(e){return(e*=2)<1?1*Math.pow(2,10*e)*-.5*Math.sin(2*(e-1-.45)*Math.PI/.45):1*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-.45)*Math.PI/.45)*.5+1},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInBounce:function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)},easeInOutBounce:function(e){var t;return e<.5?(t=!0,e=1-2*e):e=2*e-1,e<1/2.75?e*=7.5625*e:e=e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5}};var ce=i("5LU5"),le=i("11nE"),ue=function(e,t){N.Z.call(this),this._target=h.createMatrixTarget(t||o._E.IDENTITY),e&&this.setName(e)};a.Z.createPrototypeObject(ue,a.Z.objectInherit(N.Z.prototype,{init:function(e){this.setMatrix(e),o._E.copy(this._target.defaultValue,e)},getTarget:function(){return this._target},getMatrix:function(){return this._target.value},setMatrix:function(e){o._E.copy(this._target.value,e)},resetToDefaultValue:function(){this.setMatrix(this._target.defaultValue)},applyToMatrix:function(e){o._E.mul(e,e,this._target.value)}}),"osgAnimation","StackedMatrix");const de=ue;var Ie,Ce=o.gf.create(),fe=function(e,t){N.Z.call(this),this._target=h.createQuatTarget(t||Ce),e&&this.setName(e)};a.Z.createPrototypeObject(fe,a.Z.objectInherit(N.Z.prototype,{init:function(e){this.setQuaternion(e),o.gf.copy(this._target.defaultValue,e)},setQuaternion:function(e){o.gf.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setQuaternion(this._target.defaultValue)},applyToMatrix:(Ie=o._E.create(),function(e){var t=Ie;o._E.fromQuat(t,this._target.value),o._E.mul(e,e,t)})}),"osgAnimation","StackedQuaternion");const pe=fe;var me=function(e,t,i){N.Z.call(this),this._axis=o.R3.fromValues(0,0,1),t&&o.R3.copy(this._axis,t),this._target=h.createFloatTarget("number"==typeof i?i:0),e&&this.setName(e)};a.Z.createPrototypeObject(me,a.Z.objectInherit(N.Z.prototype,{init:function(e,t){this.setAxis(e),this.setAngle(t),this._target.defaultValue=t},setAxis:function(e){o.R3.copy(this._axis,e)},setAngle:function(e){this._target.value=e},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setAngle(this._target.defaultValue)},applyToMatrix:function(){var e=o._E.create(),t=o.gf.create();return function(i){var n=this._axis,r=t,a=e,s=this._target.value;o.gf.setAxisAngle(r,n,s),o._E.fromQuat(a,r),o._E.mul(i,i,a)}}()}),"osgAnimation","StackedRotateAxis");const _e=me;var Ee=function(e,t){N.Z.call(this),this._target=h.createVec3Target(t||o.R3.ONE),e&&this.setName(e)};a.Z.createPrototypeObject(Ee,a.Z.objectInherit(N.Z.prototype,{init:function(e){this.setScale(e),o.R3.copy(this._target.defaultValue,e)},setScale:function(e){o.R3.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setScale(this._target.defaultValue)},applyToMatrix:function(e){var t=this._target.value;o._E.scale(e,e,t)}}),"osgAnimation","StackedScale");const ve=Ee;var Se=function(e,t){N.Z.call(this),this._target=h.createVec3Target(t||o.R3.ZERO),e&&this.setName(e)};a.Z.createPrototypeObject(Se,a.Z.objectInherit(N.Z.prototype,{init:function(e){this.setTranslate(e),o.R3.copy(this._target.defaultValue,e)},setTranslate:function(e){o.R3.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setTranslate(this._target.defaultValue)},applyToMatrix:function(e){o._E.translate(e,e,this._target.value)}}),"osgAnimation","StackedTranslate");const Be=Se;var we=i("DZjg"),ye={};a.Z.objectMix(ye,he),a.Z.objectMix(ye,Y),ye.Animation=w,ye.SkinningAttribute=T.Z,ye.AnimationUpdateCallback=F.Z,ye.BasicAnimationManager=Ae,ye.Bone=ge.Z,ye.Channel=v,ye.CollectAnimationUpdateCallbackVisitor=j,ye.MorphAttribute=ce.Z,ye.MorphGeometry=X.Z,ye.RigGeometry=q.Z,ye.Skeleton=le.Z,ye.StackedMatrix=de,ye.StackedQuaternion=pe,ye.StackedRotateAxis=_e,ye.StackedScale=ve,ye.StackedTranslate=Be,ye.UpdateBone=ie.Z,ye.UpdateMatrixTransform=ne.Z,ye.UpdateMorph=te,ye.UpdateSkeleton=we.Z;const Me=ye;var De=i("RqNa"),be=i("Hiiq"),Qe=i("LvhW"),xe=i("lZH+"),Te=i.n(xe),Fe=i("pSxj"),Re=a.Z.rejectObject,Ne={Object:function(e,t){var i=e.getJSON();if(i.Name&&t.setName(i.Name),i.UserDataContainer){var n=e.setJSON(i.UserDataContainer).readUserDataContainer();void 0!==n&&t.setUserData(n)}return t},Node:function(e,t){var i=e.getJSON();Ne.Object(e,t);var n=[];if(i.UpdateCallbacks)for(var r=t.addUpdateCallback.bind(t),a=0,o=i.UpdateCallbacks.length;a<o;a++){var s=e.setJSON(i.UpdateCallbacks[a]).readObject();n.push(s),s.then(r)}if(i.StateSet){var A=e.setJSON(i.StateSet).readObject();n.push(A),A.then(t.setStateSet.bind(t))}var g=[];if(i.Children)for(var h=0,c=i.Children.length;h<c;h++)g.push(e.setJSON(i.Children[h]).readObject());return Te().all(n).then((function(){return Te().all(g).then((function(e){for(var i=e.length,n=0;n<i;n++)t.addChild(e[n]);return t}))}))},StateSet:function(e,t){var i=e.getJSON();Ne.Object(e,t),void 0!==i.RenderingHint&&t.setRenderingHint(i.RenderingHint);var n,r,a=[];if(void 0!==i.AttributeList)for(var o=0,s=i.AttributeList.length;o<s;o++)n=i.AttributeList[o],r=void 0,(r=e.setJSON(n).readObject()).isRejected()||(a.push(r),r.then(t.setAttributeAndModes.bind(t)));var A=function(i,n){var r=e.setJSON(n).readObject();r.isRejected()||(a.push(r),r.then(t.setTextureAttributeAndModes.bind(t,i)))};if(i.TextureAttributeList)for(var g=i.TextureAttributeList,h=0,c=g.length;h<c;h++)for(var l=g[h],u=0,d=l.length;u<d;u++)A(h,l[u]);return Te().all(a).then((function(){return t}))},Material:function(e,t){var i=e.getJSON();return i.Diffuse&&i.Emission&&i.Specular&&void 0!==i.Shininess?(Ne.Object(e,t),t.setAmbient(i.Ambient),t.setDiffuse(i.Diffuse),t.setEmission(i.Emission),t.setSpecular(i.Specular),t.setShininess(i.Shininess),Te().resolve(t)):Re("Material",i)},BlendFunc:function(e,t){var i=e.getJSON();return i.SourceRGB&&i.SourceAlpha&&i.DestinationRGB&&i.DestinationAlpha?(Ne.Object(e,t),t.setSourceRGB(i.SourceRGB),t.setSourceAlpha(i.SourceAlpha),t.setDestinationRGB(i.DestinationRGB),t.setDestinationAlpha(i.DestinationAlpha),Te().resolve(t)):Re("BlendFunc",i)},CullFace:function(e,t){var i=e.getJSON();return void 0===i.Mode?Re("CullFace",i):(Ne.Object(e,t),t.setMode(i.Mode),Te().resolve(t))},BlendColor:function(e,t){var i=e.getJSON();return i.ConstantColor?(Ne.Object(e,t),t.setConstantColor(i.ConstantColor),Te().resolve(t)):Re("BlendColor",i)},Light:function(e,t){var i=e.getJSON();return i.Ambient&&i.Diffuse&&i.Direction&&i.Position&&i.Specular&&void 0!==i.LightNum&&void 0!==i.SpotCutoff&&void 0!==i.LinearAttenuation&&void 0!==i.ConstantAttenuation&&void 0!==i.QuadraticAttenuation?(Ne.Object(e,t),t.setAmbient(i.Ambient),t.setConstantAttenuation(i.ConstantAttenuation),t.setDiffuse(i.Diffuse),t.setDirection(i.Direction),t.setLightNumber(i.LightNum),t.setLinearAttenuation(i.LinearAttenuation),t.setPosition(i.Position),t.setQuadraticAttenuation(i.QuadraticAttenuation),t.setSpecular(i.Specular),t.setSpotCutoff(i.SpotCutoff),t.setSpotBlend(.01),void 0!==i.SpotExponent&&t.setSpotBlend(i.SpotExponent/128),Te().resolve(t)):Re("Light",i)},Texture:function(e,t){var i=e.getJSON();Ne.Object(e,t),i.MinFilter&&t.setMinFilter(i.MinFilter),i.MagFilter&&t.setMagFilter(i.MagFilter),i.WrapT&&t.setWrapT(i.WrapT),i.WrapS&&t.setWrapS(i.WrapS);var n=i.File;return void 0===n&&(n="no-image-provided"),e.readImageURL(n).then((function(e){return t.setImage(e),t}))},Projection:function(e,t){var i=e.getJSON();if(!i.Matrix)return Re("Projection",i);var n=Ne.Node(e,t);return t.setMatrix(i.Matrix),n},MatrixTransform:function(e,t){var i=e.getJSON();if(!i.Matrix)return Re("MatrixTransform",i);var n=Ne.Node(e,t);return t.setMatrix(i.Matrix),n},LightSource:function(e,t){var i=e.getJSON();if(!i.Light)return Re("LightSource",i);var n=Ne.Node(e,t);return Te().all([e.setJSON(i.Light).readObject(),n]).then((function(e){var n=e[0];return t.setLight(n),"ABSOLUTE_RF"===i.ReferenceFrame&&t.setReferenceFrame(Fe.Z.ABSOLUTE_RF),t}))},functionSortAttributes:function(e,t){return-1!==e.indexOf("TexCoord")&&-1!==t.indexOf("TexCoord")?parseInt(e.substr(8),10)-parseInt(t.substr(8),10):e<t?-1:e>t?1:0},Geometry:function(e,t){var i=e.getJSON();if(!i.VertexAttributeList)return Re("Geometry",i);i.PrimitiveSetList=i.PrimitiveSetList||[];var n=[];n.push(Ne.Node(e,t));var r=t.getPrimitives(),a=r.push.bind(r),o=0,s=i.PrimitiveSetList.length;for(o=0;o<s;o++){var A=e.setJSON(i.PrimitiveSetList[o]).readPrimitiveSet();n.push(A),A.then(a)}var g=function(e,t){this.getVertexAttributeList()[e]=t},h=i.VertexAttributeList,c=window.Object.keys(h);for(c.sort(Ne.functionSortAttributes),s=c.length,o=0;o<s;o++){var l=c[o],u=e.setJSON(h[l]).readBufferArray();n.push(u),u.then(g.bind(t,l))}return Te().all(n).then((function(){return t}))},PagedLOD:function(e,t){var i,n=e.getJSON();Ne.Object(e,t),"USE_BOUNDING_SPHERE_CENTER"===n.CenterMode?t.setCenterMode(0):"UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED"===n.CenterMode&&t.setCenterMode(2),t.setCenter([n.UserCenter[0],n.UserCenter[1],n.UserCenter[2]]),t.setRadius(n.UserCenter[3]),"PIXEL_SIZE_ON_SCREEN"===n.RangeMode&&t.setRangeMode(1);for(var r=n.RangeList,a=0;a<window.Object.keys(r).length;a++){var o=r[i="Range "+a];t.setRange(a,o[0],o[1])}for(r=n.RangeDataList,a=0;a<window.Object.keys(r).length;a++)i="File "+a,t.setFileName(a,r[i]);t.setDatabasePath(e.getDatabasePath());var s=[];if(n.Children)for(var A=0,g=n.Children.length;A<g;A++)s.push(e.setJSON(n.Children[A]).readObject());return Te().all(s).then((function(e){var i=e.length;for(a=0;a<i;a++)t.addChildNode(e[a]);return t}))}};const Le=Ne;var ke=i("6Szz"),Pe=a.Z.rejectObject,Ue={},Oe=function(){},Ge=be.Z.registry();Ge.registerObject("osgAnimation.Vec3LerpChannel",Oe),Ge.registerObject("osgAnimation.FloatLerpChannel",Oe),Ge.registerObject("osgAnimation.QuatSlerpChannel",Oe),Ge.registerObject("osgAnimation.QuatLerpChannel",Oe),Ge.registerObject("osgAnimation.FloatCubicBezierChannel",Oe),Ge.registerObject("osgAnimation.Vec3CubicBezierChannel",Oe),Ge.registerObject("osgAnimation.StackedMatrixElement",de),Ge.registerObject("osgAnimation.StackedScaleElement",ve),Ue.Animation=function(e){var t=e.getJSON();if(void 0===t.Name||!t.Channels||0===t.Channels.length)return Pe("Animation",t);for(var i=[],n=0,r=t.Channels.length;n<r;n++){var a=e.setJSON(t.Channels[n]).readObject();i.push(a)}return Te().all(i).then((function(e){return w.createAnimation(e,t.Name)}))},Ue.StandardVec3Channel=function(e,t,i){var n=e.getJSON();if(!(void 0!==n.TargetName&&n.KeyFrames&&n.Name&&n.KeyFrames.Time&&n.KeyFrames.Key&&3===n.KeyFrames.Key.length))return Pe("StandardVec3Channel",n);var r=e.setJSON(n.KeyFrames.Time).readBufferArray(),a=e.setJSON(n.KeyFrames.Key[0]).readBufferArray(),o=e.setJSON(n.KeyFrames.Key[1]).readBufferArray(),s=e.setJSON(n.KeyFrames.Key[2]).readBufferArray();return Te().all([r,a,o,s]).then((function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),A=r.length,g=new Float32Array(new ArrayBuffer(4*(A+1)*3),0,3*A),h=new Float32Array(new ArrayBuffer(4*(A+1)),0,A),c=0;c<A;c++){var l=3*c;h[c]=r[c],g[l++]=a[c],g[l++]=o[c],g[l]=s[c]}return i(g,h,n.TargetName,n.Name,t),t}))},Ue.StandardQuatChannel=function(e,t,i){var n=e.getJSON();if(!(void 0!==n.TargetName&&n.KeyFrames&&n.Name&&n.KeyFrames.Time&&n.KeyFrames.Key&&4===n.KeyFrames.Key.length))return Pe("StandardQuatChannel",n);var r=e.setJSON(n.KeyFrames.Time).readBufferArray(),a=e.setJSON(n.KeyFrames.Key[0]).readBufferArray(),o=e.setJSON(n.KeyFrames.Key[1]).readBufferArray(),s=e.setJSON(n.KeyFrames.Key[2]).readBufferArray(),A=e.setJSON(n.KeyFrames.Key[3]).readBufferArray();return Te().all([r,a,o,s,A]).then((function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),A=e[4].getElements(),g=r.length,h=new Float32Array(new ArrayBuffer(4*(g+1)*4),0,4*g),c=new Float32Array(new ArrayBuffer(4*(g+1)),0,g),l=0;l<g;l++){var u=4*l;c[l]=r[l],h[u++]=a[l],h[u++]=o[l],h[u++]=s[l],h[u]=A[l]}return i(h,c,n.TargetName,n.Name,t),t}))},Ue.StandardFloatChannel=function(e,t,i){var n=e.getJSON();if(!(void 0!==n.TargetName&&n.KeyFrames&&n.Name&&n.KeyFrames.Time&&n.KeyFrames.Key))return Pe("StandardFloatChannel",n);var r=e.setJSON(n.KeyFrames.Time).readBufferArray(),a=e.setJSON(n.KeyFrames.Key).readBufferArray();return Te().all([r,a]).then((function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=r.length,s=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),A=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),g=0;g<o;g++)A[g]=r[g],s[g]=a[g];return i(s,A,n.TargetName,n.Name,t),t}))},Ue.Vec3LerpChannel=function(e,t){return Ue.StandardVec3Channel(e,t,v.createVec3Channel)},Ue.QuatLerpChannel=function(e,t){return Ue.StandardQuatChannel(e,t,v.createQuatChannel)},Ue.QuatSlerpChannel=function(e,t){return Ue.StandardQuatChannel(e,t,v.createQuatChannel)},Ue.FloatLerpChannel=function(e,t){return Ue.StandardFloatChannel(e,t,v.createFloatChannel)},Ue.FloatCubicBezierChannel=function(e,t){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Position&&i.KeyFrames.ControlPointOut&&i.KeyFrames.ControlPointIn))return Pe("FloatCubicBezierChannel",i);var n,r=[],a=window.Object.keys(i.KeyFrames);for(n=0;n<a.length;n++)r.push(e.setJSON(i.KeyFrames[a[n]]).readBufferArray());return Te().all(r).then((function(e){var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),A=s.length,g=new Float32Array(new ArrayBuffer(4*(A+1)*3),0,3*A),h=new Float32Array(new ArrayBuffer(4*(A+1)),0,A);for(n=0;n<A;n++){var c=3*n;h[n]=s[n],g[c++]=o[n],g[c++]=r[n],g[c]=a[n]}return v.createFloatCubicBezierChannel(g,h,i.TargetName,i.Name,t),t}))},Ue.Vec3CubicBezierChannel=function(e,t){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Position&&i.KeyFrames.ControlPointOut&&i.KeyFrames.ControlPointIn&&3===i.KeyFrames.Position.length&&3===i.KeyFrames.ControlPointIn.length&&3===i.KeyFrames.ControlPointOut.length))return Pe("Vec3CubicBezierChannel",i);var n,r=[],a=window.Object.keys(i.KeyFrames);for(n=0;n<a.length;n++){var o=a[n],s=i.KeyFrames[o];"Time"!==o?(r.push(e.setJSON(s[0]).readBufferArray()),r.push(e.setJSON(s[1]).readBufferArray()),r.push(e.setJSON(s[2]).readBufferArray())):r.push(e.setJSON(s).readBufferArray())}return Te().all(r).then((function(e){var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),A=e[4].getElements(),g=e[5].getElements(),h=e[6].getElements(),c=e[7].getElements(),l=e[8].getElements(),u=e[9].getElements(),d=u.length,I=new Float32Array(new ArrayBuffer(4*(d+1)*9),0,9*d),C=new Float32Array(new ArrayBuffer(4*(d+1)),0,d);for(n=0;n<d;n++){var f=9*n;C[n]=u[n],I[f++]=h[n],I[f++]=c[n],I[f++]=l[n],I[f++]=r[n],I[f++]=a[n],I[f++]=o[n],I[f++]=s[n],I[f++]=A[n],I[f]=g[n]}return v.createVec3CubicBezierChannel(I,C,i.TargetName,i.Name,t),t}))},Ue.BasicAnimationManager=function(e,t){var i=e.getJSON();if(!i.Animations)return Pe("BasicAnimationManager",i);Le.Object(e,t);for(var n=[],r=0,a=i.Animations.length;r<a;r++){var o=e.setJSON(i.Animations[r]).readObject();o.isRejected()?R.Z.warn("An Animation failed on the parsing!"):n.push(o)}return Te().all(n).then((function(e){return t.init(e),t}))},Ue.UpdateMatrixTransform=function(e,t){var i=e.getJSON();if(!i.StackedTransforms)return Pe("UpdateMatrixTransform",i);Le.Object(e,t);var n,r,a=[];for(n=0,r=i.StackedTransforms.length;n<r;n++){var o=e.setJSON(i.StackedTransforms[n]).readObject();o.isRejected()?R.Z.warn("A stacked transforms failed on the parsing!"):a.push(o)}return Te().all(a).then((function(e){var i=t.getStackedTransforms();for(n=0,r=e.length;n<r;n++)i.push(e[n]);return t.computeChannels(),t}))},Ue.StackedTranslate=function(e,t){var i=e.getJSON();return i.Name&&i.Translate?(Le.Object(e,t),t.init(i.Translate),Te().resolve(t)):Pe("StackedTranslate",i)},Ue.StackedQuaternion=function(e,t){var i=e.getJSON();return i.Name&&i.Quaternion?(Le.Object(e,t),t.init(i.Quaternion),Te().resolve(t)):Pe("StackedQuaternion",i)},Ue.StackedRotateAxis=function(e,t){var i=e.getJSON();return i.Axis&&void 0!==i.Angle?(Le.Object(e,t),t.init(i.Axis,i.Angle),Te().resolve(t)):Pe("StackedRotateAxis",i)},Ue.StackedMatrix=function(e,t){var i=e.getJSON();return i.Name&&i.Matrix?(Le.Object(e,t),t.init(i.Matrix),Te().resolve(t)):Pe("StackedMatrix",i)},Ue.StackedScale=function(e,t){var i=e.getJSON();return i.Name&&i.Scale?(Le.Object(e,t),t.init(i.Scale),Te().resolve(t)):Pe("StackedScale",i)},Ue.Bone=function(e,t){var i=e.getJSON();if(!i.InvBindMatrixInSkeletonSpace)return Pe("Bone",i);var n=Le.MatrixTransform(e,t);if(t.setInvBindMatrixInSkeletonSpace(i.InvBindMatrixInSkeletonSpace),i.BoundingBox){var r=t.getBoneBoundingBox();r.setMax(i.BoundingBox.max),r.setMin(i.BoundingBox.min)}return n},Ue.UpdateBone=Ue.UpdateMatrixTransform,Ue.UpdateSkeleton=function(e,t){return Le.Object(e,t),Te().resolve(t)},Ue.Skeleton=Le.MatrixTransform,Ue.RigGeometry=function(e,t){var i=e.getJSON();if(!i.SourceGeometry)return Pe("RigGeometry",i);i.BoneMap||R.Z.warn("No boneMap found in a RigGeometry !");var n=Le.Geometry(e,t);t._boneNameID=i.BoneMap;var r,a=i.SourceGeometry["osg.Geometry"];return a?(e.setJSON(a),t.setSourceGeometry(new ke.Z),r=Le.Geometry(e,t.getSourceGeometry())):(a=i.SourceGeometry["osgAnimation.MorphGeometry"])?(e.setJSON(a),t.setSourceGeometry(new X.Z),r=Ue.MorphGeometry(e,t.getSourceGeometry())):R.Z.warn("SourceGeometry type no recognized"),void 0===t._uniqueID&&(t._uniqueID=a.UniqueID),Te().all([n,r]).then((function(){return t.mergeChildrenData(),t}))},Ue.MorphGeometry=function(e,t){var i=e.getJSON();if(!i.MorphTargets)return Pe("MorphGeometry",i);var n=i.MorphTargets,r=[];r.push(Le.Geometry(e,t));for(var a=0,o=n.length;a<o;a++)r.push(e.setJSON(n[a]).readObject());return Te().all(r).then((function(e){for(var t=e[0],i=t.getMorphTargets(),n=1,r=e.length;n<r;n++)i.push(e[n]);return t.mergeChildrenVertexAttributeList(),t}))},Ue.UpdateMorph=function(e,t){var i=e.getJSON();if(!i.TargetMap)return Pe("UpdateMorph",i);Le.Object(e,t);for(var n=window.Object.keys(i.TargetMap),r=0,a=n.length;r<a;r++){var o=n[r];t.addTarget(i.TargetMap[o],parseInt(o,10))}return Te().resolve(t)},Ue.StackedMatrixElement=Ue.StackedMatrix,Ue.StackedScaleElement=Ue.StackedScale;const He=Ue;var Ke=i("t5D/"),Ze=i("Pev1"),Ve=i("rfV8"),Ye=i("PNpA"),Je=i("5rJd"),ze=i("f7MS"),je=i("IpZ9"),We=function(e){Ze.Z.call(this),this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._matrixTransform=new Ve.Z,this.addChild(this._matrixTransform),this._text="",void 0!==e&&(this._text=e),this._font="monospace",this._color=o.vh.fromValues(0,0,0,1),this._fillStyle="rgba( 0, 0, 0, 1 )",this._context.textAlign="center",this._textX=void 0,this._context.baseLine="middle",this._textY=void 0,this._characterSize=1,this._characterSizeMode=We.OBJECT_COORDS,this._fontSize=32,this._geometry=void 0,this._autoRotateToScreen=!1,this._position=o.R3.create(),this._layout=We.LEFT_TO_RIGHT,this._alignment=We.CENTER_CENTER,this._forcePowerOfTwo=!1,this._texture=new Je.Z,this.drawText(),this._dirty=!1,this._previousModelView=o._E.create()};We.OBJECT_COORDS=0,We.SCREEN_COORDS=1,We.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT=2,We.LEFT_TO_RIGHT="ltr",We.RIGHT_TO_LEFT="rtl",We.LEFT_TOP=0,We.LEFT_CENTER=1,We.LEFT_BOTTOM=2,We.CENTER_TOP=3,We.CENTER_CENTER=4,We.CENTER_BOTTOM=5,We.RIGHT_TOP=6,We.RIGHT_CENTER=7,We.RIGHT_BOTTOM=8,a.Z.createPrototypeNode(We,a.Z.objectInherit(Ze.Z.prototype,{drawText:function(){if(void 0!==this._geometry&&(this._matrixTransform.removeChild(this._geometry),this._geometry.releaseGLObjects()),this._text){this.setTextProperties(),this._canvas.width=this._context.measureText(this._text).width,this._canvas.height=2*this._fontSize,this._forcePowerOfTwo&&(this._canvas.width=this._nextPowerOfTwo(this._canvas.width),this._canvas.height=this._nextPowerOfTwo(this._canvas.height)),this.setTextProperties(),this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.fillText(this._text,this._textX,this._textY);var e=this._canvas.width/this._canvas.height,t=this._characterSize*e;this._geometry=Ye.Z.createTexturedQuadGeometry(-t/2,-this._characterSize/2,0,t,0,0,0,this._characterSize,0),this._texture.setTextureSize(this._canvas.width,this._canvas.height),this._texture.setMinFilter("LINEAR"),this._texture.setMagFilter("LINEAR"),this._texture.setImage(this._canvas);var i=this._geometry.getOrCreateStateSet();i.setTextureAttributeAndModes(0,this._texture),i.setRenderingHint("TRANSPARENT_BIN"),i.setAttributeAndModes(new ze.Z(ze.Z.ONE,ze.Z.ONE_MINUS_SRC_ALPHA)),this._matrixTransform.addChild(this._geometry),this.dirtyBound()}},setText:function(e){this._text=e,this._dirty=!0},getText:function(){return this._text},setFont:function(e){this._font=e,this._dirty=!0},setColor:function(e){this._color=e,this._fillStyle="rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+","+e[3]+")",this._context.fillStyle=this._fillStyle,this._context.fillText(this._text,this._textX,this._textY)},getColor:function(){return this._color},setCharacterSize:function(e){this._characterSize=e,this._characterSizeMode!==We.OBJECT_COORDS&&(o._E.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this._characterSizeMode===We.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)),this._dirty=!0},getCharacterSize:function(){return this._characterSize},setCharacterSizeMode:function(e){this._characterSizeMode=e,this._characterSizeMode!==We.OBJECT_COORDS?(o._E.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this.setAutoScaleToScreen(!0),this.setMaximumScale(Number.MAX_VALUE),this._characterSizeMode===We.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)):(this._matrixTransform.setMatrix(o._E.create()),this.setAutoScaleToScreen(!1)),this._dirty=!0},getCharacterSizeMode:function(){return this._characterSizeMode},setFontResolution:function(e){this._fontSize=e,this._dirty=!0},getFontResolution:function(){return this._fontSize},setPosition:function(e){this._position=e,o._E.fromTranslation(this.getMatrix(),e)},getPosition:function(){return this._position},setTextProperties:function(){this._context.fillStyle=this._fillStyle,this._setAlignmentValues(this._alignment),this._context.font=this._fontSize+"px "+this._font,this._context.direction=this._layout},setAutoRotateToScreen:function(e){Ze.Z.prototype.setAutoRotateToScreen.call(this,e),this._dirty=!0},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setLayout:function(e){this._layout="string"==typeof e?We[e]:e,this._dirty=!0},getLayout:function(){return this._layout},setAlignment:function(e){this._alignment="string"==typeof e?We[e]:e,this._dirty=!0},getAlignment:function(){return this._alignment},accept:function(e){if(this._dirty&&(this.drawText(),this._dirty=!1),e.getVisitorType()===J.Z.CULL_VISITOR){var t=e.getViewport().width(),i=e.getViewport().height(),n=e.getCurrentProjectionMatrix(),r=e.getCurrentModelViewMatrix(),a=this._position,s=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(o._E.exactEquals(r,this._previousModelView)?t!==this._previousWidth||i!==this._previousHeight?s=!0:o._E.exactEquals(n,this._previousProjection)&&o.R3.exactEquals(a,this._previousPosition)||(s=!0):s=!0),this._firstTimeToInitEyePoint=!1,s){if(this._autoScaleToScreen){var A=e.getViewport(),g=this.computePixelSizeVector(A,n,r),h=o.vh.fromValues(this._position[0],this._position[1],this._position[2],1),c=o.vh.dot(h,g),l=1/(c=.48/c);if(this._autoScaleTransitionWidthRatio>0){var u,d,I;if(this._minimumScale>0){var C=this._minimumScale,f=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);I=C+(d=1-2*(u=1/(4*(f-C)))*f)*d/(4*u),l<-d/(2*u)?l=this._minimumScale:l<f&&(l=I+d*l+u*(l*l))}if(this._maximumScale<Number.MAX_VALUE){var p=this._maximumScale,m=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);I=p+(d=1-2*(u=1/(4*(m-p)))*m)*d/(4*u),l>-d/(2*u)?l=this._maximumScale:l>m&&(l=I+d*l+u*(l*l))}}this.setScale(l)}if(this._autoRotateToScreen){var _=o.gf.create(),E=e.getCurrentModelViewMatrix();o._E.getRotation(_,E),this.setRotation(o.gf.invert(_,_))}this._previousWidth=t,this._previousHeight=i,o.R3.copy(this._previousPosition,a),o._E.copy(this._previousProjection,n),o._E.copy(this._previousModelView,r)}}je.Z.prototype.accept.call(this,e)},_setAlignmentValues:function(e){switch(e){case We.LEFT_TOP:this._context.textAlign="left",this._textX=0,this._context.textBaseline="top",this._textY=0;break;case We.LEFT_CENTER:this._context.textAlign="left",this._textX=0,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case We.LEFT_BOTTOM:this._context.textAlign="left",this._textX=0,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case We.CENTER_TOP:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="top",this._textY=0;break;case We.CENTER_CENTER:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case We.CENTER_BOTTOM:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case We.RIGHT_TOP:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="top",this._textY=0;break;case We.RIGHT_CENTER:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case We.RIGHT_BOTTOM:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="bottom",this._textY=this._canvas.height}},setForcePowerOfTwo:function(e){this._forcePowerOfTwo=e},getForcePowerOfTwo:function(){return this._forcePowerOfTwo},_nextPowerOfTwo:function(e){var t=e;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}}),"osgText","Text"),Ke.Z.registerApplyFunction(We.nodeTypeID,Ke.Z.getApplyFunction(Ze.Z.nodeTypeID));const qe=We;var Xe={Text:function(e,t){var i=e.getJSON();if(!i.Text)return Te().reject();var n=Le.Node(e,t);if(t.setColor(i.Color),t.setText(i.Text),t.setAutoRotateToScreen(i.AutoRotateToScreen),t.setPosition(i.Position),t.setCharacterSize(i.CharacterSize),"VERTICAL"===i.Layout)return R.Z.error("Vertical Alignment not supported"),Te().reject();var r=i.Alignment;return i.Alignment.indexOf("BASE_LINE")>-1&&("LEFT_BASE_LINE"===i.Alignment?r=qe.LEFT_CENTER:"CENTER_BASE_LINE"===i.Alignment?r=qe.CENTER_CENTER:"RIGHT_BASE_LINE"===i.Alignment?r=qe.RIGHT_CENTER:"LEFT_BOTTOM_BASE_LINE"===i.Alignment?r=qe.LEFT_BOTTOM:"CENTER_BOTTOM_BASE_LINE"===i.Alignment?r=qe.CENTER_BOTTOM:"RIGHT_BOTTOM_BASE_LINE"===i.Alignment&&(r=qe.RIGHT_BOTTOM)),t.setAlignment(r),t.setLayout(i.Layout),n}};const $e=Xe;var et=i("sSQ9"),tt=i("dPdN"),it=i("1Xhw"),nt=i("pwEu"),rt={};rt.Input=De.Z,a.Z.objectMix(rt,be.Z),rt.DatabasePager=Qe.Z,rt.ObjectWrapper.serializers.osg=Le,rt.ObjectWrapper.serializers.osgAnimation=He,rt.ObjectWrapper.serializers.osgText=$e,rt.Registry=et.Z,rt.fileHelper=tt.Z,rt.requestFile=it.Z,a.Z.objectMix(rt,nt.Z);const at=rt;var ot=i("8SXq"),st=i.n(ot),At=i("bxht"),gt=function(e){e&&(this._boundStrategy=e.boundStrategy,this.setInputManager(e.inputManager)),void 0===this._boundStrategy&&(this._boundStrategy=gt.COMPUTE_HOME_USING_SPHERE),this._controllerList={},this._inverseMatrix=o._E.create(),this._camera=void 0,this._node=void 0,this._frustum={},this._computeBoundNodeMaskOverride=-1,this._tmpSphere=new At.Z};gt.prototype={setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setNode:function(e){this._node=e},setComputeBoundNodeMaskOverride:function(e){this._computeBoundNodeMaskOverride=e},getComputeBoundNodeMaskOverride:function(){return this._computeBoundNodeMaskOverride},setInputManager:function(e){this._inputManager=e},getInputManager:function(){return this._inputManager},getHomeBoundingSphere:function(e){var t=this._node;if(t){var n=void 0!==e?e:this._boundStrategy;if(n&gt.COMPUTE_HOME_USING_BBOX){var r;if(-1===this._computeBoundNodeMaskOverride)r=t.getBoundingBox();else{var a=new(0,i("t+pa").Z);a.setNodeMaskOverride(this._computeBoundNodeMaskOverride),a.reset(),a.apply(t),r=a.getBoundingBox()}if(!r.valid())return t.getBoundingSphere();if(n&gt.COMPUTE_HOME_USING_SPHERE){var o=t.getBoundingSphere();if(o.valid()&&o.volume()<r.volume())return o}return this._tmpSphere.copyBoundingBox(r),this._tmpSphere}return t.getBoundingSphere()}},getHomeBound:function(e){return R.Z.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeDistance:function(e){var t=this._frustum,i=e.radius();if(this._camera&&o._E.getFrustum(t,this._camera.getProjectionMatrix())){var n=Math.abs(t.right-t.left)/t.zNear/2,r=Math.abs(t.top-t.bottom)/t.zNear/2;i/=Math.sin(Math.atan2(r<n?r:n,1))}else i*=1.5;return i},update:function(){},getInverseMatrix:function(){return this._inverseMatrix},getControllerList:function(){return this._controllerList}},gt.COMPUTE_HOME_USING_SPHERE=1,gt.COMPUTE_HOME_USING_BBOX=2;const ht=gt;var ct=i("CtxI"),lt=i("XDCw"),ut=i("e0P+"),dt=i("itLJ"),It=i("K/iW"),Ct=i("vXZK"),ft=function(){Ct.Z.Intersection.call(this),this._intersectionPoints=[],this._distance=0,this._maxDistance=0,this._numIntersectionPoints=0},pt=function(){Ct.Z.call(this),this._src=[],this._dest=[],this._maxNumIntersectionsPoints=6};a.Z.createPrototypeObject(pt,a.Z.objectInherit(Ct.Z.prototype,{reset:function(){Ct.Z.prototype.reset.call(this),this._src=[],this._dest=[]},enter:function(e){return!!this._intersector.getPolytope().containsBoundingBox(e)&&(this._intersector.getPolytope().pushCurrentMask(),!0)},leave:function(){this._intersector.getPolytope().popCurrentMask()},addIntersection:function(){this._src=a.Z.arrayUniq(this._src);for(var e=this._src,t=o.R3.create(),i=-Number.MAX_VALUE,n=this._intersector._iReferencePlane,r=0;r<e.length;++r){o.R3.add(t,t,e[r]);var s=dt.Z.distanceToPlane(n,e[r]);s>i&&(i=s)}o.R3.scale(t,t,1/e.length);var A=this.initIntersection(new ft);A._distance=dt.Z.distanceToPlane(n,t),A._maxDistance=i,o.R3.copy(A._localIntersectionPoint,t);var g=this._maxNumIntersectionsPoints;for(A._numIntersectionPoints=e.length<g?e.length:g,r=0;r<A._numIntersectionPoints;++r)A._intersectionPoints.push(o.R3.clone(this._src[r]))},contains:function(){var e=this._intersector.getPolytope(),t=e.getPlanes(),i=e.getCurrentMask();if(!i)return!0;for(var n=1,r=0;r<t.length;++r)if(i&0===n)n<<=1;else{this._dest=[];for(var a=t[r],s=this._src[0],A=dt.Z.distanceToPlane(a,s),g=1;g<this._src.length;++g){var h=this._src[g],c=dt.Z.distanceToPlane(a,h);if(A>=0&&this._dest.push(o.R3.clone(s)),A*c<0){var l=A/(A-c),u=o.R3.add(o.R3.create(),o.R3.scale(o.R3.create(),s,1-l),o.R3.scale(o.R3.create(),h,l));this._dest.push(u)}A=c,s=h}if(A>=0&&this._dest.push(o.R3.clone(s)),this._dest.length<=1)return!1;var d=this._src.slice();this._src=this._dest.slice(),this._dest=d}return!0},containsPoint:function(e){return!!this._intersector.getPolytope().containsVertex(e)&&(this._src=[],this._src[0]=e,!0)},containsLine:function(e,t){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=e,this.contains()},containsTriangle:function(e,t,i){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=i,this._src[3]=e,this.contains()},intersectPoint:function(e){this.containsPoint(e)&&this.addIntersection()},intersectLine:function(e,t){this.containsLine(e,t)&&this.addIntersection()},intersectTriangle:function(e,t,i){this.containsTriangle(e,t,i)&&this.addIntersection()}}),"osgUtil","PolytopeIntersectFunctor");const mt=pt;var _t,Et=function(){It.Z.call(this),this._index=0,this._polytope=new ut.Z,this._iPolytope=new ut.Z,this._referencePlane=o.vh.create(),this._iReferencePlane=o.vh.create()},vt=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3];e[0]=i[0]*n+i[1]*r+i[2]*a+i[3]*o,e[1]=i[4]*n+i[5]*r+i[6]*a+i[7]*o,e[2]=i[8]*n+i[9]*r+i[10]*a+i[11]*o,e[3]=i[12]*n+i[13]*r+i[14]*a+i[15]*o};a.Z.createPrototypeObject(Et,a.Z.objectInherit(It.Z.prototype,{setPolytope:function(e){this._polytope.setPlanes(e);for(var t=[],i=0;i<e.length;++i){var n=e[i];t[i]=o.vh.copy(this._iPolytope.getPlanes()[i]||dt.Z.create(),n)}this._iPolytope.setPlanes(t),o.vh.copy(this._referencePlane,e[e.length-1]),o.vh.copy(this._iReferencePlane,this._referencePlane)},getPolytope:function(){return this._iPolytope},setPolytopeFromWindowCoordinates:function(e,t,i,n){this.setPolytope([o.vh.fromValues(1,0,0,-e),o.vh.fromValues(-1,0,0,i),o.vh.fromValues(0,1,0,-t),o.vh.fromValues(0,-1,0,n),o.vh.fromValues(0,0,1,0)])},intersectBoundingBox:function(e){return this._iPolytope.containsBoundingBox(e)},intersectBoundingSphere:function(e){return this._iPolytope.containsBoundingSphere(e)},intersect:(_t=new mt,function(e,t){_t.setGeometry(t),_t.setIntersectionVisitor(e),_t.setIntersector(this);var i=t.getShape();i?i.intersect(_t,i.getNodes()[0]):(t.computeTransformedVertices&&_t.setVertices(t.computeTransformedVertices()),_t.apply(t)),_t.reset()}),setCurrentTransformation:function(e){for(var t=this._polytope.getPlanes(),i=this._iPolytope.getPlanes(),n=0,r=t.length;n<r;n++){var a=i[n]=i[n]||o.vh.create();vt(a,t[n],e),o.vh.scale(a,a,1/o.R3.len(a))}vt(this._iReferencePlane,this._referencePlane,e),o.vh.scale(this._iReferencePlane,this._iReferencePlane,1/o.R3.len(this._iReferencePlane))}}),"osgUtil","PolytopeIntersector");const St=Et;var Bt=i("haRL"),wt=function(e){this._manipulator=e,this._enable=!0};wt.prototype={isEnabled:function(){return this._enable},setEnable:function(e){this._enable=e}};const yt=wt;var Mt=i("LElp");const Dt=0,bt=1,Qt=2;var xt=i("Lz+S"),Tt=function(e){yt.call(this,e),this._zoomFactor=1,this.init()};a.Z.createPrototypeObject(Tt,a.Z.objectInherit(yt.prototype,{init:function(){this._mode=void 0,this._inMotion=!1,this._initInputs(xt.Z.ORBIT_MANIPULATOR_MOUSEKEYBOARD,xt.Z.ORBIT_MANIPULATOR_RESETTOHOME)},_initInputs:function(e,t){var i=this._manipulator.getInputManager(),n=this.setMode.bind(this,Dt,this._manipulator.getRotateInterpolator()),r=this.setMode.bind(this,bt,this._manipulator.getPanInterpolator()),a=this.setMode.bind(this,Qt,this._manipulator.getZoomInterpolator());i.group(e).addMappings({move:"mousemove",startPan:["mousedown shift 0","mousedown 1","mousedown 2"],startZoom:["mousedown ctrl 0","mousedown ctrl 2"],startRotate:"mousedown 0 !shift !ctrl",stopMotion:["mouseup","mouseout","keyup a","keyup s","keyup d"],zoom:"wheel"},this),i.group(t).addMappings({reset:"keydown space"},this),i.group(e).addMappings({setRotationMode:"keydown a"},n),i.group(e).addMappings({setPanMode:"keydown d"},r),i.group(e).addMappings({setZoomMode:"keydown s"},a)},getMode:function(){return this._mode},setMode:function(e,t){this.getMode()!==e&&(this._mode=e,t.reset(),this._inMotion=!0)},setManipulator:function(e){this._manipulator=e},getZoomFactor:function(){return this._zoomFactor},setZoomFactor:function(e){this._zoomFactor=e},move:function(e){if(!1!==this._inMotion){var t=e.canvasX,i=-e.canvasY,n=this._manipulator;if(!1===Mt.Z.isNaN(t)&&!1===Mt.Z.isNaN(i)){var r=this.getMode();if(r===Dt)n.getRotateInterpolator().setTarget(t,i);else if(r===bt)n.getPanInterpolator().setTarget(t,i);else if(r===Qt){var a=n.getZoomInterpolator();a.isReset()&&(a.setStart(i),a.set(0));var o=i-a.getStart();a.setStart(i);var s=a.getTarget()[0];a.setTarget(s-o/20)}}}},startPan:function(e){var t=this._manipulator.getPanInterpolator();this.setMode(bt,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startRotate:function(e){var t=this._manipulator.getRotateInterpolator();this.setMode(Dt,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startZoom:function(e){var t=this._manipulator.getZoomInterpolator();this.setMode(Qt,t),t.setStart(-e.canvasY),t.set(0)},stopMotion:function(){this._inMotion=!1,this._mode=void 0},zoom:function(e){var t=e.deltaY/this._zoomFactor,i=this._manipulator,n=i.getZoomInterpolator().getTarget()[0]-t;i.getZoomInterpolator().setTarget(n)},reset:function(){this._manipulator.computeHomePosition()}}));const Ft=Tt;var Rt=function(e){Ft.call(this,e),this._timer=!1};a.Z.createPrototypeObject(Rt,a.Z.objectInherit(Ft.prototype,{_initInputs:function(){Ft.prototype._initInputs.call(this,xt.Z.CAD_MANIPULATOR_MOUSEKEYBOARD,xt.Z.CAD_MANIPULATOR_RESETTOHOME),this._manipulator.getInputManager().group(xt.Z.CAD_MANIPULATOR_MOUSEKEYBOARD).addMappings({savePosition:"mousemove"},this)},zoom:function(e){var t=-e.deltaY/this._zoomFactor,i=this._manipulator,n=i.getZoomInterpolator().getTarget()[0]-t;if(i.getZoomInterpolator().setTarget(n),!1===this._timer){this._timer=!0;var r=this;this._timerRef&&clearTimeout(this._timerRef),this._timerRef=setTimeout((function(){r._timer=!1}),200),i.computeIntersections(e.glX,e.glY)}},savePosition:function(e){this._lastX=e.glX,this._lastY=e.glY},setMode:function(e,t,i){this._inMotion||this._manipulator.computeIntersections(this._lastX,this._lastY),Ft.prototype.setMode.call(this,e,t,i)},center:function(e){var t=this._manipulator;t.getZoomInterpolator().set(0);var i=t.getZoomInterpolator().getTarget()[0]-10;t.getZoomInterpolator().setTarget(i),t.computeIntersections(e.glX,e.glY)}}));const Nt=Rt;var Lt=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(Lt,a.Z.objectInherit(yt.prototype,{init:function(){this._panFactor=[],this._panFactor[0]=1,this._panFactor[1]=-this._panFactor[0],this._rotateFactor=[],this._rotateFactor[0]=.6,this._rotateFactor[1]=-this._rotateFactor[0],this._zoomFactor=5,this._lastScale=0,this._zooming=!1,this._dragStarted=!1,this._initInputs(xt.Z.ORBIT_MANIPULATOR_TOUCH)},_initInputs:function(e){this._manipulator.getInputManager().group(e).addMappings({pinchEnd:"pinchend",pinchStart:"pinchstart",pinchInOut:["pinchin","pinchout"],startPan:["panstart 2"],startRotate:["panstart 1"],pan:["panmove 2"],rotate:["panmove 1"],endMotion:["touchend 2","touchcancel 2","touchend 1","touchcancel 1"]},this)},startPan:function(e){this._panning=!0,this.startMotion(this._manipulator.getPanInterpolator(),this._panFactor,e)},startRotate:function(e){this._rotating=!0,this.startMotion(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},pan:function(e){this._panning||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getPanInterpolator(),this._panFactor,e)},rotate:function(e){this._rotating||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},startMotion:function(e,t,i){if(!this._zooming){e.reset();var n=i.canvasX*t[0],r=i.canvasY*t[1];e.set(n,r)}},move:function(e,t,i){var n=i.canvasX*t[0],r=i.canvasY*t[1];e.setTarget(n,r)},endMotion:function(){(this._panning||this._rotating)&&(this._panning=!1,this._rotating=!1)},pinchStart:function(e){this._zooming=!0,this._lastScale=e.scale;var t=this._manipulator.getZoomInterpolator();t.reset(),t.set(this._lastScale)},pinchEnd:function(){this._zooming=!1},pinchInOut:function(e){if(this._zooming){var t=e.scale>this._lastScale?this._zoomFactor:3*this._zoomFactor,i=.5-Math.abs(e.velocity);t*=Mt.Z.smoothStep(0,.5,i);var n=(e.scale-this._lastScale)*t;this._lastScale=e.scale;var r=this._manipulator.getZoomInterpolator();r.setTarget(r.getTarget()[0]-n)}},setManipulator:function(e){this._manipulator=e}}));const kt=Lt;var Pt=function(e){kt.call(this,e),this._timer=!1};a.Z.createPrototypeObject(Pt,a.Z.objectInherit(kt.prototype,{_initInputs:function(){kt.prototype._initInputs.call(this,xt.Z.CAD_MANIPULATOR_TOUCH)},startMotion:function(e,t,i){kt.prototype.startMotion.call(this,e,t,i),this._manipulator.computeIntersections(i.glX,i.glY)}}));const Ut=Pt;var Ot=function(e,t){this._current=new Float32Array(e),this._target=new Float32Array(e),this._delta=new Float32Array(e),this._delay=void 0!==t?t:.15,this._reset=!1,this._start=0,this.reset()};Ot.prototype={setDelay:function(e){this._delay=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(e){for(var t=Math.min(1,this._delay*e*60),i=0,n=this._current.length;i<n;i++){var r=(this._target[i]-this._current[i])*t;this._delta[i]=r,this._current[i]+=r}return this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta},getStart:function(){return this._start},setStart:function(e){this._start=e}};const Gt=Ot;var Ht,Kt,Zt,Vt,Yt,Jt,zt,jt,Wt,qt,Xt,$t,ei,ti,ii,ni,ri,ai,oi,si,Ai,gi,hi,ci,li,ui=i("E9Rp"),di=function(e){ht.call(this,e),this._tmpHomePosition=o.R3.create(),this._intersectionVisitor=new ct.Z,this._lineSegmentIntersector=new lt.Z,this._polytopeIntersector=void 0,this._usePolytopeIntersector=!1,this._primitiveMask=ui.Z.ALL_PRIMITIVES,this.init()};(di.Interpolator=function(){this._current=o.K4.create(),this._target=o.K4.create(),this._delta=o.K4.create(),this._reset=!1,this.reset(),this._width=void 0,this._height=void 0}).prototype={setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(){var e,t;return e=void 0===this._width?0:(this._target[0]-this._current[0])/this._width,this._delta[0]=e,this._current[0]=this._target[0],t=void 0===this._height?0:(this._target[1]-this._current[1])/this._height,this._delta[1]=t,this._current[1]=this._target[1],this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta}},di.AvailableControllerList=["StandardMouseKeyboard","Hammer"],di.ControllerList=["StandardMouseKeyboard","Hammer"],a.Z.createPrototypeObject(di,a.Z.objectInherit(ht.prototype,{init:function(){this._distance=25,this._target=o.R3.create(),this._upz=o.R3.fromValues(0,0,1),this._right=o.R3.fromValues(1,0,0),o.R3.init(this._target);var e=o._E.fromRotation(o._E.create(),-Math.PI,this._upz),t=o._E.fromRotation(o._E.create(),Math.PI/10,this._right);this._rotation=o._E.create(),o._E.mul(this._rotation,e,t),this._time=0,this._rotate=new di.Interpolator,this._pan=new di.Interpolator,this._zoom=new Gt(1),this._panFactor=1.5,this._rotateFactor=1,this._zoomFactor=1,this._inverseMatrix=o._E.create(),this._homeEye=void 0,this._homeCenter=void 0,this._homeUp=o.R3.fromValues(0,0,1),this._orientation=o.gf.create(),this._pivotPoint=o.R3.create(),this._eye=void 0,this._zoomDir=o.R3.create();var i=this;di.ControllerList.forEach((function(e){void 0!==di[e]&&(i._controllerList[e]?i._controllerList[e].init():i._controllerList[e]=new di[e](i))}))},setViewer:function(e){this._viewer=e},reset:function(){this.init()},setEnable:function(e){this.getInputManager().setEnable(xt.Z.CAD_MANIPULATOR,e)},setNode:function(e){this._node=e},setPivotPoint:function(e){o.R3.copy(this._pivotPoint,e)},setTarget:(li=o.R3.create(),function(e){o.R3.copy(this._target,e),this.getEyePosition(li),this._distance=o.R3.distance(e,li)}),setEyePosition:function(e){o.R3.copy(this._eye,e),this._distance=o.R3.distance(this._target,e)},setHomePosition:function(e,t,i){this._homeEye=e,this._homeCenter=t,this._homeUp=i},computeHomePosition:(Ai=o.R3.create(),gi=o.R3.create(),hi=o.R3.create(),ci=o._E.create(),function(e){var t=this.getHomeBoundingSphere(e);if(t){this.setDistance(this.getHomeDistance(t)),this.setTarget(t.center()),this.setPivotPoint(t.center()),void 0===this._homeEye&&(this._homeEye=o.R3.create(),this.getEyePosition(this._homeEye)),void 0===this._homeCenter&&(this._homeCenter=o.R3.create(),o.R3.copy(this._homeCenter,t.center())),void 0===this._eye&&(this._eye=o.R3.create()),o.R3.copy(this._eye,this._homeEye),o.R3.copy(this._target,this._homeCenter),o.R3.copy(this._upz,this._homeUp),o._E.copy(ci,this._rotation);var i=this._target,n=this._eye;o.R3.sub(Ai,i,n),o.R3.normalize(Ai,Ai),o.R3.cross(gi,Ai,this._upz),o.R3.normalize(gi,gi),o.R3.cross(hi,gi,Ai),o.R3.normalize(hi,hi),ci[0]=gi[0],ci[1]=hi[0],ci[2]=-Ai[0],ci[3]=0,ci[4]=gi[1],ci[5]=hi[1],ci[6]=-Ai[1],ci[7]=0,ci[8]=gi[2],ci[9]=hi[2],ci[10]=-Ai[2],ci[11]=0,ci[12]=0,ci[13]=0,ci[14]=0,ci[15]=1,o._E.getRotation(this._orientation,ci),o.gf.invert(this._orientation,this._orientation)}}),setZoomFactor:function(e){this._zoomFactor=e},setRotateFactor:function(e){this._rotateFactor=e},setPanFactor:function(e){this._panFactor=e},setDistance:function(e){this._distance=e},setUsePolytopeIntersector:function(e){this._usePolytopeIntersector=e},getUsePolytopeIntersector:function(){return this._usePolytopeIntersector},getDistance:function(){return this._distance},zoom:function(e){this._distance=e},getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getIntersectionVisitor:function(){return this._intersectionVisitor},getLineSegmentIntersector:function(){return this._lineSegmentIntersector},getOrCreatePolytopeIntersector:function(){return void 0===this._polytopeIntersector&&(this._polytopeIntersector=new St,this._polytopeIntersector.setIntersectionLimit(ui.Z.LIMIT_ONE_PER_DRAWABLE),this._polytopeIntersector.setPrimitiveMask(ui.Z.POINT_PRIMITIVES|ui.Z.LINE_PRIMITIVES)),this._polytopeIntersector},getTarget:function(e){return o.R3.copy(e,this._target),e},getEyePosition:function(e){void 0===this._eye?this.computeEyePosition(this._target,this._distance,e):o.R3.copy(e,this._eye)},computeEyePosition:(oi=o.R3.create(),si=o._E.create(),function(e,t,i){o._E.invert(si,this._rotation),oi[1]=t,o.R3.transformMat4(i,oi,si),o.R3.add(i,e,i)}),computePan:(ni=o.R3.create(),ri=o.R3.create(),ai=o.R3.create(),function(e,t,i){var n=o.R3.length(o.R3.sub(ai,this._eye,this._pivotPoint))/this._panFactor;n<10&&(n=10),ni[0]=e*n/2,ni[1]=t*n/2,ni[2]=0,o.R3.transformMat4(ri,ni,i),o.R3.add(this._eye,this._eye,ri)}),computeZoom:(ti=o.R3.create(),ii=o.R3.create(),function(e){var t=e*this._zoomFactor;o.R3.sub(ti,this._pivotPoint,this._eye),o.R3.add(this._eye,this._eye,o.R3.scale(ii,ti,t))}),computeRotation:(Yt=o.R3.create(),Jt=o.R3.create(),zt=o.R3.create(),jt=o.R3.create(),Wt=o.gf.create(),qt=o.gf.create(),Xt=o.gf.create(),$t=o.R3.create(),ei=o.R3.create(),function(e,t){o.R3.transformQuat(Jt,this._right,this._orientation),o.R3.normalize(Yt,Jt),o.R3.sub(zt,this._eye,this._pivotPoint);var i=o.R3.dot(Yt,zt);o.R3.sub(jt,zt,o.R3.scale(ei,Yt,i));var n=o.R3.fromValues(-jt[0],-jt[1],0),r=Math.atan2(-jt[2],o.R3.length(n));t=Math.max(-Math.PI/2+.01,Math.min(Math.PI/2-.01,r+t))-r,o.gf.setAxisAngle(Wt,Jt,t*this._rotateFactor),o.gf.setAxisAngle(qt,this._upz,e*this._rotateFactor),o.gf.mul(Xt,qt,Wt),o.R3.transformQuat($t,zt,Xt),o.R3.add(this._eye,$t,this._pivotPoint),o.gf.mul(this._orientation,qt,this._orientation),o.R3.transformQuat(Jt,this._right,this._orientation),o.gf.setAxisAngle(Wt,Jt,t*this._rotateFactor),o.gf.mul(this._orientation,Wt,this._orientation)}),update:(Zt=o._E.create(),Vt=o._E.create(),function(e){var t=e.getFrameStamp().getDeltaTime(),i=this._rotate.update();this.computeRotation(10*-i[0],10*i[1]),o._E.fromQuat(Zt,this._orientation);var n=this._pan.update();this.computePan(10*-n[0],10*-n[1],Zt),i=this._zoom.update(t),this.computeZoom(-i[0]/10),o._E.fromTranslation(Vt,this._eye),o._E.mul(this._inverseMatrix,Vt,Zt),o._E.invert(this._inverseMatrix,this._inverseMatrix)}),getInverseMatrix:function(){return this._inverseMatrix},computeIntersections:(Ht=[],Kt=o.R3.create(),function(e,t){var i,n,r=this._camera.getView(),a=this._camera,s=a.getViewport().width(),A=a.getViewport().height();if(this._rotate.setWidth(s),this._rotate.setHeight(A),this._pan.setWidth(s),this._pan.setHeight(A),0!=(this._primitiveMask&ui.Z.TRIANGLE_PRIMITIVES)&&(Ht=r.computeIntersections(e,t)).length>0&&(i=Ht[0]._localIntersectionPoint,Ht[0]._nodePath.shift(),n=Bt.Z.computeLocalToWorld(Ht[0]._nodePath),o.R3.transformMat4(Kt,i,n),this.setPivotPoint(Kt)),0===Ht.length&&this._usePolytopeIntersector){var g=this.getOrCreatePolytopeIntersector();g.reset(),g.setPolytopeFromWindowCoordinates(e-5,t-5,e+5,t+5);var h=this._intersectionVisitor;h.setIntersector(g),r.getCamera().accept(h),(Ht=g.getIntersections()).sort((function(e,t){return e._distance-t._distance})),Ht.length>0&&(i=Ht[0]._localIntersectionPoint,Ht[0]._nodePath.shift(),n=Bt.Z.computeLocalToWorld(Ht[0]._nodePath),o.R3.transformMat4(Kt,i,n),this.setPivotPoint(Kt))}}),getPositionRelativeToCanvas:function(){var e=o.K4.create(),t=o.K4.create();return function(i,n){var r=this._camera._graphicContext.canvas;this.getOffsetRect(r,e);var a=r.width/r.clientWidth,o=r.height/r.clientHeight;return t[0]=(i-e[1])*a,t[1]=(r.clientHeight-(n-e[0]))*o,t}}(),getCanvasCenter:function(){var e=o.K4.create(),t=o.K4.create();return function(){var i=this._camera.getGraphicContext().canvas;this.getOffsetRect(i,e);var n=i.width/i.clientWidth,r=i.height/i.clientHeight;return t[0]=i.clientWidth/2*n,t[1]=i.clientHeight/2*r,t}}(),getOffsetRect:function(e,t){var i=e.getBoundingClientRect(),n=document.body,r=document.documentElement,a=window.pageYOffset||r.scrollTop||n.scrollTop,o=window.pageXOffset||r.scrollLeft||n.scrollLeft,s=r.clientTop||n.clientTop||0,A=r.clientLeft||n.clientLeft||0,g=i.top+a-s,h=i.left+o-A;return t[0]=Math.round(g),t[1]=Math.round(h),t}}),"osgGA","CADManipulator"),di.StandardMouseKeyboard=Nt,di.Hammer=Ut;const Ii=di;var Ci,fi,pi=Math.PI/180,mi=function(e){yt.call(this,e),this.init()};mi.computeQuaternion=(Ci=o.gf.create(),fi=o.gf.fromValues(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,i){var n=t.alpha*pi,r=t.beta*pi,a=t.gamma*pi,s=i*pi;!function(e,t,i,n,r){var a=Math.cos(t/2),o=Math.cos(i/2),s=Math.cos(n/2),A=Math.sin(t/2),g=Math.sin(i/2),h=Math.sin(n/2);"XYZ"===r?(e[0]=A*o*s+a*g*h,e[1]=a*g*s-A*o*h,e[2]=a*o*h+A*g*s,e[3]=a*o*s-A*g*h):"YXZ"===r?(e[0]=A*o*s+a*g*h,e[1]=a*g*s-A*o*h,e[2]=a*o*h-A*g*s,e[3]=a*o*s+A*g*h):"ZXY"===r?(e[0]=A*o*s-a*g*h,e[1]=a*g*s+A*o*h,e[2]=a*o*h+A*g*s,e[3]=a*o*s-A*g*h):"ZYX"===r?(e[0]=A*o*s-a*g*h,e[1]=a*g*s+A*o*h,e[2]=a*o*h-A*g*s,e[3]=a*o*s+A*g*h):"YZX"===r?(e[0]=A*o*s+a*g*h,e[1]=a*g*s+A*o*h,e[2]=a*o*h-A*g*s,e[3]=a*o*s-A*g*h):"XZY"===r&&(e[0]=A*o*s-a*g*h,e[1]=a*g*s-A*o*h,e[2]=a*o*h+A*g*s,e[3]=a*o*s+A*g*h)}(e,r,n,-a,"YXZ");var A=-s/2;Ci[1]=Math.sin(A),Ci[3]=Math.cos(A),o.gf.mul(e,e,Ci),o.gf.mul(e,e,fi);var g=e[1];return e[1]=-e[2],e[2]=g,e}),a.Z.createPrototypeObject(mi,a.Z.objectInherit(yt.prototype,{init:function(){this._quat=o.gf.create(),this._pos=o.R3.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(xt.Z.FPS_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(xt.Z.FPS_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation?this.setScreenOrientation(e):this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(mi.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}}));const _i=mi;var Ei=function(e){kt.call(this,e),this._timer=!1};a.Z.createPrototypeObject(Ei,a.Z.objectInherit(kt.prototype,{_initInputs:function(){kt.prototype._initInputs.call(this,xt.Z.FPS_MANIPULATOR_TOUCH)}}));const vi=Ei;o.gf.create(),o.R3.create();var Si=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(Si,a.Z.objectInherit(yt.prototype,{init:function(){this._pos=o.R3.create(),this._quat=o.gf.create();var e=this._manipulator.getInputManager();e.group(xt.Z.FPS_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(xt.Z.FPS_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.transform.orientation;t&&(this._quat[0]=t.x,this._quat[1]=-t.z,this._quat[2]=t.y,this._quat[3]=t.w);var i=e.pose.transform.position;i&&(this._pos[0]=i.x*e.worldFactor,this._pos[1]=-i.z*e.worldFactor,this._pos[2]=i.y*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}}));const Bi=Si;var wi=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(wi,a.Z.objectInherit(yt.prototype,{init:function(){this._delay=.15,this._stepFactor=1,this._looking=!1;var e=this._manipulator.getInputManager();e.group(xt.Z.FPS_MANIPULATOR_MOUSEKEYBOARD).addMappings({startLookAt:"mousedown",lookAt:"mousemove",stopLookAt:["mouseup","mouseout"],goForward:["keydown w","keydown z","keydown ArrowUp"],goBackward:["keydown s","keydown ArrowDown"],goLeft:["keydown a","keydown q","keydown ArrowLeft"],goRight:["keydown d","keydown ArrowRight"],stopMoving:["keyup w","keyup z","keyup ArrowUp","keyup s","keyup ArrowDown"],stopStrafing:["keyup a","keyup q","keyup ArrowLeft","keyup d","keyup ArrowRight"],changeStepFactor:"wheel"},this),e.group(xt.Z.FPS_MANIPULATOR_RESETTOHOME).addMappings({reset:"keydown space"},this)},setEnable:function(e){e||(this._buttonup=!0),yt.prototype.setEnable.call(this,e)},setManipulator:function(e){this._manipulator=e,this._manipulator.setStepFactor(this._stepFactor)},stopLookAt:function(){this._looking=!1},startLookAt:function(e){this._manipulator.getLookPositionInterpolator().set(e.canvasX,-e.canvasY),this._looking=!0},lookAt:function(e){this._looking&&(this._manipulator.getLookPositionInterpolator().setDelay(this._delay),this._manipulator.getLookPositionInterpolator().setTarget(e.canvasX,-e.canvasY))},changeStepFactor:function(e){this._stepFactor=Math.min(Math.max(.001,this._stepFactor+.01*e.deltaY),4),this._manipulator.setStepFactor(this._stepFactor)},reset:function(){this._manipulator.computeHomePosition()},goForward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(1)},goBackward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(-1)},goLeft:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(-1)},goRight:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(1)},stopMoving:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(0)},stopStrafing:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(0)}}));const yi=wi;var Mi,Di=function(e){ht.call(this,e),this.init()};Di.AvailableControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],Di.ControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],a.Z.createPrototypeObject(Di,a.Z.objectInherit(ht.prototype,{computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);if(t&&t.valid()){this._distance=this.getHomeDistance(t);var i=t.center();o.R3.scale(this._eye,this._direction,-this._distance),o.R3.add(this._eye,i,this._eye),this.setTarget(i)}},init:function(){this._direction=o.R3.fromValues(0,1,0),this._eye=o.R3.fromValues(0,25,10),this._up=o.R3.fromValues(0,0,1),this._roll=0,this._distance=1,this._forward=new Gt(1),this._side=new Gt(1),this._lookPosition=new Gt(2),this._pan=new Gt(2),this._zoom=new Gt(1),this._stepFactor=1,this._angleVertical=0,this._angleHorizontal=0,this._tmpGetTargetDir=o.R3.create(),this._vrEnable=!1,this._vrRot=o.gf.create(),this._vrPos=o.R3.create(),this._vrTrans=o.R3.create();var e=this;this._controllerList={},Di.ControllerList.forEach((function(t){void 0!==Di[t]&&(e._controllerList[t]?e._controllerList[t].init():e._controllerList[t]=new Di[t](e))}))},setDelay:function(e){this._forward.setDelay(e),this._side.setDelay(e),this._lookPosition.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},getEyePosition:function(e){return e[0]=this._eye[0],e[1]=this._eye[1],e[2]=this._eye[2],e},setEyePosition:function(e){return this._eye[0]=e[0],this._eye[1]=e[1],this._eye[2]=e[2],this},getTarget:function(e){var t=o.R3.scale(this._tmpGetTargetDir,this._direction,this._distance);return o.R3.add(e,this._eye,t),e},setRoll:function(e){this._roll=e},setEnable:function(e){this.getInputManager().setEnable(xt.Z.FPS_MANIPULATOR,e)},setTarget:function(e){var t=this._tmpGetTargetDir;o.R3.sub(t,e,this._eye),t[2]=0,o.R3.normalize(t,t),this._angleHorizontal=Math.acos(t[1]),t[0]<0&&(this._angleHorizontal=-this._angleHorizontal),o.R3.sub(t,e,this._eye),o.R3.normalize(t,t),this._angleVertical=-Math.asin(t[2]),o.R3.copy(this._direction,t)},getLookPositionInterpolator:function(){return this._lookPosition},getSideInterpolator:function(){return this._side},getForwardInterpolator:function(){return this._forward},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getRotateInterpolator:function(){return this._lookPosition},computeRotation:function(){var e=o._E.create(),t=o._E.create(),i=o.R3.fromValues(1,0,0),n=o.R3.fromValues(0,1,0),r=o.R3.fromValues(0,0,1),a=.5*Math.PI;return function(s,A){this._angleVertical+=.01*A,this._angleHorizontal-=.01*s,this._angleVertical>a?this._angleVertical=a:this._angleVertical<-a&&(this._angleVertical=-a),this._vrEnable?(o.R3.transformQuat(this._direction,n,this._vrRot),o.R3.normalize(this._direction,this._direction),o.R3.transformQuat(this._up,r,this._vrRot)):(o._E.fromRotation(e,-this._angleVertical,i),o._E.fromRotation(t,-this._angleHorizontal,r),o._E.mul(t,t,e),o.R3.transformMat4(this._direction,n,t),o.R3.normalize(this._direction,this._direction),o.R3.transformMat4(this._up,r,t))}}(),reset:function(){this.init()},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},setStepFactor:function(e){this._stepFactor=e},computePosition:(Mi=o.K4.create(),function(e){this._forward.update(e),this._side.update(e);var t=this._distance<.001?.001:this._distance,i=this._camera.getProjectionMatrix(),n=1===i[15]?1:2/i[5];Mi[0]=this._forward.getCurrent()[0],Mi[1]=this._side.getCurrent()[0];var r=o.K4.sqrLen(Mi);r>1&&o.K4.scale(Mi,Mi,1/Math.sqrt(r));var a=this._pan.update(e),s=this._zoom.update(e),A=this._stepFactor*t*n*e,g=this._stepFactor*t*n*.005;this.moveForward(Mi[0]*A-s[0]*g*20),this.strafe(Mi[1]*A-a[0]*g),this.strafeVertical(-a[1]*g),this._vrEnable&&(o.R3.add(this._eye,this._eye,this._vrTrans),o.R3.init(this._vrTrans))}),update:function(){var e=o.R3.create(),t=o._E.create(),i=o.R3.create();return function(n){var r=n.getFrameStamp().getDeltaTime(),a=this._lookPosition.update(r);this.computeRotation(.5*-a[0],.5*-a[1]),this.computePosition(r),o.R3.add(e,this._eye,this._direction),0!==this._roll?(o._E.identity(t),o._E.rotate(t,t,this._roll,this._direction),o.R3.transformMat4(i,this._up,t),o._E.lookAt(this._inverseMatrix,this._eye,e,i)):o._E.lookAt(this._inverseMatrix,this._eye,e,this._up),this._vrEnable=!1}}(),setPoseVR:function(e,t){this._vrEnable=!0,o.gf.copy(this._vrRot,e),o.R3.sub(this._vrTrans,t,this._vrPos),o.R3.copy(this._vrPos,t)},moveForward:function(){var e=o.R3.create();return function(t){o.R3.normalize(e,this._direction),o.R3.scale(e,e,t),o.R3.add(this._eye,this._eye,e)}}(),strafe:function(){var e=o.R3.create();return function(t){o.R3.cross(e,this._direction,this._up),o.R3.normalize(e,e),o.R3.scale(e,e,t),o.R3.add(this._eye,this._eye,e)}}(),strafeVertical:function(){var e=o.R3.create();return function(t){o.R3.normalize(e,this._up),o.R3.scale(e,e,t),o.R3.add(this._eye,this._eye,e)}}()}),"osgGA","FirstPersonManipulator"),Di.DeviceOrientation=_i,Di.Hammer=vi,Di.WebVR=Bi,Di.StandardMouseKeyboard=yi;const bi=Di;var Qi=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(Qi,a.Z.objectInherit(yt.prototype,{init:function(){this._quat=o.gf.create(),this._pos=o.R3.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(xt.Z.ORBIT_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(xt.Z.ORBIT_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation?this.setScreenOrientation(e):this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(_i.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}}));const xi=Qi;var Ti=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(Ti,a.Z.objectInherit(yt.prototype,{init:function(){this._delay=.15,this._zoomFactor=.5,this._rotateFactor=5,this._panFactor=10,this._rotate=this._manipulator.getRotateInterpolator(),this._zoom=this._manipulator.getZoomInterpolator(),this._pan=this._manipulator.getPanInterpolator(),this._rotate.setDelay(this._delay),this._zoom.setDelay(this._delay),this._pan.setDelay(this._delay);var e=this._manipulator.getInputManager();e.group(xt.Z.ORBIT_MANIPULATOR_GAMEPAD).addMappings({addZoom:"axis 3",addRotateX:"axis 0",addRotateY:"axis 1"},this),e.group(xt.Z.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panUp:"buttonvalue 12"},this.pan.bind(this,o.K4.fromValues(0,1))),e.group(xt.Z.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panDown:"buttonvalue 13"},this.pan.bind(this,o.K4.fromValues(0,-1))),e.group(xt.Z.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panLeft:"buttonvalue 14"},this.pan.bind(this,o.K4.fromValues(1,0))),e.group(xt.Z.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panRight:"buttonvalue 15"},this.pan.bind(this,o.K4.fromValues(-1,0)))},pan:function(e){var t=this._pan.getTarget();this._pan.setTarget(t[0]-e[0]*this._panFactor,t[1]+e[1]*this._panFactor)},addZoom:function(e){this._zoom.addTarget(-e.value*this._zoomFactor)},addRotateX:function(e){this._rotate.addTarget(-e.value*this._rotateFactor)},addRotateY:function(e){this._rotate.addTarget(0,e.value*this._rotateFactor)}}));const Fi=Ti;var Ri=o.gf.create(),Ni=o.R3.create(),Li=function(e){yt.call(this,e),this.init()};a.Z.createPrototypeObject(Li,a.Z.objectInherit(yt.prototype,{init:function(){this._pos=o.R3.create(),this._quat=o.gf.create();var e=this._manipulator.getInputManager();e.group(xt.Z.ORBIT_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(xt.Z.ORBIT_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.orientation;t&&(e.sitToStandMatrix&&(t=o._E.getRotation(Ri,e.sitToStandMatrix),o.gf.mul(t,t,e.pose.orientation)),this._quat[0]=t[0],this._quat[1]=-t[2],this._quat[2]=t[1],this._quat[3]=t[3]);var i=e.pose.position;i&&(e.sitToStandMatrix&&(i=o.R3.transformMat4(Ni,i,e.sitToStandMatrix)),this._pos[0]=i[0]*e.worldFactor,this._pos[1]=-i[2]*e.worldFactor,this._pos[2]=i[1]*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}}));const ki=Li;var Pi=function(e){ht.call(this,e),this._homePosition=o.R3.create(),this._frustum={},this.init()};Pi.AvailableControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"],Pi.ControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"];var Ui,Oi,Gi,Hi,Ki=2*Math.PI,Zi=function(e,t){return e<t+1e-5},Vi=1e-4,Yi=1/0;a.Z.createPrototypeObject(Pi,a.Z.objectInherit(ht.prototype,{init:function(){this._distance=25,this._target=o.R3.create(),this._upz=o.R3.fromValues(0,0,1),this._roll=0,o.R3.init(this._target);var e=o._E.fromRotation(o._E.create(),-Math.PI,this._upz),t=o._E.fromRotation(o._E.create(),Math.PI/10,o.R3.fromValues(1,0,0));this._rotation=o._E.create(),o._E.mul(this._rotation,e,t),this._time=0,this._vrMatrix=o._E.create(),this._rotate=new Gt(2),this._pan=new Gt(2),this._zoom=new Gt(1),this._minSpeed=1e-4,this._scaleMouseMotion=1,this._inverseMatrix=o._E.create(),this._autoPushTarget=!0,this._limitPitchUp=.5*Math.PI*.9,this._limitPitchDown=-this._limitPitchUp,this._limitYawLeft=-Math.PI,this._limitYawRight=-this._limitYawLeft,this._limitZoomIn=Vi,this._limitZoomOut=Yi,this._constrainYaw=!1,this._constrainPitch=!1,this._constrainYaw=!1,this._constrainZoom=!1,this._panFactor=.002,this._rotationFactor=.1,this._zoomFactor=.1;var i=this;Pi.ControllerList.forEach((function(e){void 0!==Pi[e]&&(i._controllerList[e]?i._controllerList[e].init():i._controllerList[e]=new Pi[e](i))}))},setZoomFactor:function(e){this._zoomFactor=.1*e},setRotationFactor:function(e){this._rotationFactor=.1*e},setPanFactor:function(e){this._panFactor=.002*e},setLimitPitchUp:function(e){this._limitPitchUp=e},setLimitPitchDown:function(e){this._limitPitchDown=e},setLimitYawLeft:function(e){this._limitYawLeft=e,this._constrainYaw=!0},setLimitYawRight:function(e){this._limitYawRight=e,this._constrainYaw=!0},setLimitZoomOut:function(e){this._limitZoomOut=e,this._constrainZoom=!0},setLimitZoomIn:function(e){this._limitZoomIn=e,this._constrainZoom=!0},setConstrainPitch:function(e){this._constrainPitch=e,this._previousPitch=void 0},isConstrainPitch:function(){return this._constrainPitch},setConstrainYaw:function(e){this._constrainYaw=e,this._previousYaw=void 0},isConstrainYaw:function(){return this._constrainYaw},setConstrainZoom:function(e){this._constrainZoom=e},isConstrainZoom:function(){return this._constrainZoom},setDelay:function(e){this._rotate.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},reset:function(){this.init()},setTarget:function(e){o.R3.copy(this._target,e);var t=o.R3.create();this.getEyePosition(t),this._distance=o.R3.distance(e,t)},setEyePosition:function(){var e=o.R3.create(),t=o.R3.create(),i=o.R3.create();return function(n){var r=this._rotation,a=this._target;o.R3.sub(e,n,a),o.R3.normalize(e,e),o.R3.cross(t,e,this._upz),o.R3.normalize(t,t),o.R3.cross(i,t,e),o.R3.normalize(i,i),r[0]=t[0],r[1]=e[0],r[2]=i[0],r[3]=0,r[4]=t[1],r[5]=e[1],r[6]=i[1],r[7]=0,r[8]=t[2],r[9]=e[2],r[10]=i[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this._distance=o.R3.distance(a,n)}}(),setEnable:function(e){this.getInputManager().setEnable(xt.Z.ORBIT_MANIPULATOR,e)},computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);t&&t.valid()&&(this.setDistance(this.getHomeDistance(t)),this.setTarget(t.center()))},getHomePosition:function(){if(void 0!==this._node){var e=this._target,t=this.getDistance();this.computeEyePosition(e,t,this._homePosition)}return this._homePosition},setMinSpeed:function(e){this._minSpeed=e},getMinSpeed:function(){return this._minSpeed},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},getSpeedFactor:function(){return Math.max(this._distance,this._minSpeed)},computePan:(Oi=o._E.create(),Gi=o.R3.create(),Hi=o.R3.create(),function(e,t){var i=this._camera.getProjectionMatrix(),n=1===i[15]?1:2/i[5],r=this.getSpeedFactor()*n;t*=r,e*=r,o._E.invert(Oi,this._rotation),Gi[0]=Oi[0],Gi[1]=Oi[1],Gi[2]=Oi[2],o.R3.normalize(Gi,Gi),Hi[0]=Oi[8],Hi[1]=Oi[9],Hi[2]=Oi[10],o.R3.normalize(Hi,Hi),o.R3.scale(Gi,Gi,-e),o.R3.scale(Hi,Hi,t),o.R3.add(this._target,this._target,Gi),o.R3.add(this._target,this._target,Hi)}),computeRotation:(Ui=o.R3.fromValues(1,0,0),function(e,t){var i=Math.atan(-this._rotation[6]/this._rotation[5]);isNaN(i)&&(i=0);var n=this._computePitch(i,t),r=e/10,a=Math.atan2(this._rotation[4],this._rotation[0]),s=this._computeYaw(a,r);o._E.fromRotation(this._rotation,-n,Ui),o._E.rotate(this._rotation,this._rotation,-s,this._upz)}),_computePitch:function(e,t){var i=e+t/10;return Math.min(Math.max(i,this._limitPitchDown),this._limitPitchUp)},_computeYaw:function(e,t){var i=e+t,n=this._limitYawLeft,r=this._limitYawRight;if(this._constrainYaw){if(r<n&&(i>Math.PI&&(e-=Ki,i-=Ki),i<-Math.PI&&(e+=Ki,i+=Ki)),0===t){(n>r?i<n&&i>r:i<n||i>r)&&(i=Math.abs(i-n)>Math.abs(i-r)?r:n)}t>0&&Zi(e,r)&&i>r?i=r:t<0&&Zi(n,e)&&i<n&&(i=n)}return i},computeZoom:function(e){this.zoom(e)},setAutoPushTarget:function(e){this._autoPushTarget=e},zoom:function(){var e=o.R3.create();return function(t){var i=this._distance+this.getSpeedFactor()*(t-1);this._autoPushTarget&&i<this._limitZoomIn&&(o.R3.sub(e,this._target,this.getEyePosition(e)),o.R3.normalize(e,e),o.R3.scale(e,e,this._limitZoomIn-i),o.R3.add(this._target,this._target,e));var n=this._constrainZoom?this._limitZoomIn:Vi,r=this._constrainZoom?this._limitZoomOut:Yi;this._distance=Math.max(n,Math.min(r,i))}}(),setRoll:function(e){this._roll=e},getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getTarget:function(e){return o.R3.copy(e,this._target)},getEyePosition:function(e){return this.computeEyePosition(this._target,this._distance,e),e},computeEyePosition:function(){var e=o.R3.create(),t=o._E.create();return function(i,n,r){o._E.invert(t,this._rotation),e[1]=n,o.R3.transformMat4(r,e,t),o.R3.add(r,i,r)}}(),update:function(){var e=o.R3.create(),t=o._E.create(),i=o.R3.create();return function(n){var r,a=n.getFrameStamp().getDeltaTime();r=this._rotate.update(a),this.computeRotation(-r[0]*this._rotationFactor*this._scaleMouseMotion,-r[1]*this._rotationFactor*this._scaleMouseMotion),r=this._pan.update(a),this.computePan(-r[0]*this._panFactor,-r[1]*this._panFactor),r=this._zoom.update(a),this.computeZoom(1+r[0]*this._zoomFactor);var s=this._target,A=this._distance;o._E.invert(this._inverseMatrix,this._rotation),o._E.mul(this._inverseMatrix,this._vrMatrix,this._inverseMatrix),o.R3.set(e,0,A,0),o.R3.transformMat4(e,e,this._inverseMatrix),0!==this._roll?(o._E.identity(t),o.R3.sub(i,e,s),o._E.rotate(t,t,this._roll,i),o.R3.transformMat4(i,this._upz,t),o._E.lookAt(this._inverseMatrix,o.R3.add(e,s,e),s,i)):o._E.lookAt(this._inverseMatrix,o.R3.add(e,s,e),s,this._upz)}}(),setPoseVR:function(e){o._E.fromQuat(this._vrMatrix,e)}}),"osgGA","OrbitManipulator"),Pi.DeviceOrientation=xi,Pi.GamePad=Fi,Pi.Hammer=kt,Pi.WebVR=ki,Pi.StandardMouseKeyboard=Ft;const Ji=Pi;var zi=function(e){this._manipulatorList=[],this._currentManipulator=void 0,this._inputManager=e};zi.prototype={getCamera:function(){return this.getCurrentManipulator().getCamera()},setCamera:function(e){for(var t=this.getManipulatorList(),i=0,n=t.length;i<n;++i)t[i].setCamera(e)},update:function(e){var t=this.getCurrentManipulator();if(void 0!==t)return t.update(e)},getInputManager:function(){return this._inputManager},setEnable:function(e){this.getCurrentManipulator().setEnable(e)},getNode:function(){return this.getCurrentManipulator()._node},setNode:function(e){for(var t=this.getManipulatorList(),i=0,n=t.length;i<n;++i)t[i].setNode(e)},getControllerList:function(){return this.getCurrentManipulator().getControllerList()},getNumManipulator:function(){return this._manipulatorList.length},addManipulator:function(e){this._manipulatorList.push(e),void 0===this._currentManipulator&&this.setManipulatorIndex(0)},getManipulatorList:function(){return this._manipulatorList},setManipulatorIndex:function(e){this._currentManipulator=e},getCurrentManipulatorIndex:function(){return this._currentManipulator},getCurrentManipulator:function(){return this._manipulatorList[this._currentManipulator]},reset:function(){this.getCurrentManipulator().reset()},computeHomePosition:function(e){var t=this.getCurrentManipulator();void 0!==t&&t.computeHomePosition(e)},getInverseMatrix:function(){var e=this.getCurrentManipulator();if(void 0!==e)return e.getInverseMatrix()},getHomeBound:function(e){return R.Z.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeBoundingSphere:function(e){return this.getCurrentManipulator().getHomeBoundingSphere(e)},getHomeDistance:function(e){return this.getCurrentManipulator().getHomeDistance(e)}};const ji=zi;var Wi={};st().NO_MOUSEEVENTS=!0,Wi.CADManipulator=Ii,Wi.getCADManipulatorStandardMouseKeyboardController=function(){return Nt},Wi.getCADManipulatorHammerController=function(){return Ut},Wi.FirstPersonManipulator=bi,Wi.getFirstPersonDeviceOrientationController=function(){return _i},Wi.getFirstPersonManipulatorHammerController=function(){return vi},Wi.getFirstPersonStandardMouseKeyboardControllerClass=function(){return yi},Wi.getFirstPersonWebVRControllerClass=function(){return Bi},Wi.Manipulator=ht,Wi.OrbitManipulator=Ji,Wi.getOrbitManipulatorDeviceOrientationController=function(){return xi},Wi.getOrbitManipulatorGamePadController=function(){return Fi},Wi.getOrbitManipulatorHammerController=function(){return kt},Wi.getOrbitManipulatorStandardMouseKeyboardController=function(){return Ft},Wi.getOrbitManipulatorWebVRController=function(){return ki},Wi.SwitchManipulator=ji,Wi.OrbitManipulator.Rotate=Dt,Wi.OrbitManipulator.Pan=bt,Wi.OrbitManipulator.Zoom=Qt,Wi.Controller=yt;const qi=Wi;var Xi=i("nbbV"),$i=i("uRnn"),en=i("64xh"),tn=i("o4nZ"),nn=i("W6eo"),rn=i("lU+d"),an=i("Yy1w"),on=i("5pih"),sn=i("7itD"),An=i("w/Ui"),gn=function(){je.Z.call(this),this._feedbackSwapped=!1,this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!1,this._lastXratio=1,this._lastYratio=1,this._xViewportRatio=1,this._yViewportRatio=1,this._xTextureRatio=1,this._yTextureRatio=1,this._finalPassUpScaleToScreen=!0,this._methodWrapUV=0,this._thresholdWrapUV=1,this._texInfos=void 0,this._screenWidth=this._screenHeight=0,this._feedbackData={},this._cameras=[],this._stateSets=[],this._textureUniforms=[],this._programs={},this._externalTextures={},this._internalPasses=[],this._textures={},this._userTextures={},this._currentPoolIndex=0,this._texturePool={},this._firstTexture="",this._offScreen=!1;var e=this.getOrCreateStateSet();e.setAttributeAndModes(new $i.Z($i.Z.DISABLE)),e.setAttributeAndModes(new Xi.Z(Xi.Z.BACK)),this.setCullCallback(this)};gn.VertexShader=["attribute vec3 Vertex;","void main(void) {","    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","}","","#define SHADER_NAME %name%",""].join("\n"),gn.FragmentShader=["uniform float uRGBMRange;","vec2 gTexCoord;","%uniforms%","",'#pragma include "utils/functions.glsl"',"","%header%","","%texturesColorSpace%","","%functionBodies%","","void main(void) {","    gTexCoord = gl_FragCoord.xy / uTextureOutputSize.xy;","    vec4 color = %firstFunc%(%firstArg%);","    %optionalFuncs%","    %colorSpaces%","    gl_FragColor = color;","}","","#define SHADER_NAME %name%",""].join("\n"),a.Z.createPrototypeObject(gn,a.Z.objectInherit(je.Z.prototype,{setOffscreen:function(e){this._offScreen=e},clear:function(){for(var e in this._textures={},this._internalPasses.length=0,this._firstTexture="",this._texturePool)this._texturePool[e].usage=-1;this._feedbackData={},this._cameras.length=0,this._stateSets.length=0,this._textureUniforms.length=0,this.removeChildren()},clearShaderCache:function(){this._programs={}},getGlobalXRatio:function(){return this._xViewportRatio*this._xTextureRatio},getGlobalYRatio:function(){return this._yViewportRatio*this._yTextureRatio},setFinalPassUpScaleToScreen:function(e){this._finalPassUpScaleToScreen=e},_enforceFromInputParameter:function(e,t){var i=t.name,n=this._textures[i],r=this._textures[i+"FeedbackTexture"],a=t[e];void 0!==a&&(void 0!==n[e]&&n[e]!==a&&console.error("Mismatch on parameter "+e+" : "+i),n[e]=a,r&&(r[e]=a))},_updatePassInfoFromInputs:function(e,t,i){var n=this._textures[t],r=i.srgb;i.srgb=void 0;for(var a=0;a<e.textures.length;a++){var o=e.textures[a];this._renameTextureAlias(o,t,i.name);var s=o.name;if(!this._externalTextures[s]){this._usages[s]=(this._usages[s]||0)+1;var A=o.srgb;this._enforceFromInputParameter("filter",o),this._enforceFromInputParameter("rgbm",o),this._enforceFromInputParameter("srgb",o);var g=this._textures[s];if(!g){var h=s.substring(0,s.indexOf("FeedbackTexture"));g=this._textures[h]}void 0!==r&&void 0!==A&&r!==A&&(g.encodeSRGB=!0),this._setInferredParameter("rgbmInferred","rgbm",n,g),this._setInferredParameter("srgbInferred","srgb",n,g)}}void 0===i.srgb&&(i.srgb=void 0===n.srgb?n.srgbInferred:n.srgb)},_setInferredParameter:function(e,t,i,n){void 0===i[e]&&(i[e]=void 0===n[t]?n[e]:n[t])},_createTextureOut:function(e,t,i){var n={srgb:e.out.srgb,rgbm:e.out.rgbm,filter:e.out.filter,type:e.out.type},r=e.out.type!==Je.Z.UNSIGNED_BYTE;return void 0===n.rgbm&&(i||r)&&(n.rgbm=!1),void 0===n.srgb&&(i?n.srgb=!0:(n.rgbm||r)&&(n.srgb=!1)),n},_processUserPasses:function(e){e=this._internalPasses.concat(e);for(var t=this._preprocessUserPasses(e),i=t.length,n=[],r={name:this._firstTexture,srgb:void 0},a={},o=0;o<i;o++){var s=t[o],A=o===i-1;if(A||!this._collapsePasses(s,t[o+1])){var g=s.out.name,h="%next"===g;h&&(a[g=s.funcs.join("_")]?g+=a[g]++:a[g]=1);var c=this._createTextureOut(s,g,A);this._textures[g]=c,this._updatePassInfoFromInputs(s,g,r),s.feedbackLoop&&(this._textures[g+"FeedbackTexture"]={srgb:c.srgb,rgbm:c.rgbm,srgbInferred:c.srgbInferred,rgbmInferred:c.rgbmInferred,filter:c.filter}),h&&(r.name=g,s.out.name=g),n.push(s)}else t.splice(o+1,1),i--,o--}return n},_hasFreeTexture:function(e,t,i){if(e===i.name&&this._texturePool[e])return e;if(!i.immuable)for(var n in this._texturePool){var r=this._texturePool[n];if(r.reusable&&(!(r.usage>0)&&r.texture.divisor===i.divisor&&r.texture.getInternalFormatType()===i.type)){if(-1===r.usage)return r.texture.getMinFilter()!==t&&(r.texture.setMinFilter(t),r.texture.setMagFilter(t)),n;if(r.texture.getMinFilter()===t)return n}}},_setOrCreateTextureKey:function(e,t,i){var n="linear"===this._textures[t].filter?Je.Z.LINEAR:Je.Z.NEAREST,r=this._hasFreeTexture(t,n,i);if(r)return this._texturePool[r].usage=e,void(this._textures[t].key=r);r=i.immuable?t:"key"+this._currentPoolIndex++,this._texturePool[r]={usage:e,texture:this._createTexture(t,i.divisor,i.type,n),immuable:i.immuable,reusable:i.reusable},-1===i.divisor&&(this._texturePool[r].width=i.width,this._texturePool[r].height=i.height),this._textures[t].key=r},_addStateSet:function(e,t){for(var i=0;i<e.funcs.length;i++){var n=e.funcs[i].name;this._stateSets[n]=t}},_addTextureToStateSet:function(e,t,i,n,r){t.addUniform(en.Z.createInt1(i,e.uniformName));var a,o=e.name;if(void 0!==this._textures[o]){var s=this._textures[o].key;a=this._texturePool[s].texture}else a=this._externalTextures[o];if(this._addTextureUniforms(e.uniformName,a,t,n,r),"TexturePrevious"===e.uniformName)return i;t.setTextureAttributeAndModes(i,a)},_getUniformName:function(e){return"u"+e[0].toUpperCase()+e.slice(1)},_addTextureUniforms:function(e,t,i,n,r){var a=this._getUniformName(e),o=en.Z.createFloat2(a+"Size"),s=en.Z.createFloat2(a+"Ratio");i.addUniform(o),i.addUniform(s),n.push(o),n.push(s),this._textureUniforms.push({size:o,ratio:s,texture:t,isFeedback:!!r})},_checkInferredParameters:function(){for(var e in this._textures){var t=this._textures[e];void 0===t.srgb&&(t.srgb=t.srgbInferred),void 0===t.rgbm&&(t.rgbm=t.rgbmInferred)}},_buildPass:function(e,t){var i=t[e],n=i.out.name;this._setOrCreateTextureKey(this._usages[n],n,i.out);var r=i.out.name+"FeedbackTexture";if(i.feedbackLoop&&this._setOrCreateTextureKey(this._usages[r],r,i.out),i.funcs.length){var a,o=new tn.Z;for(this._addStateSet(i,o),a=0;a<i.uniforms.length;a++)o.addUniform(i.uniforms[a]);var s=[],A=void 0;for(a=0;a<i.textures.length;a++){var g=i.textures[a],h=g.name===r;if(!h&&!this._externalTextures[g.name]){var c=this._textures[g.name].key;this._texturePool[c].usage--}var l=this._addTextureToStateSet(g,o,a,s,h);if(void 0!==l&&(A=l),void 0!==this._feedbackData[g.name]){var u={stateSet:o,textureUnit:a};this._feedbackData[g.name].nextPasses.push(u)}}var d=void 0;if(e!==t.length-1||this._offScreen){var I=this._textures[n].key;d=this._texturePool[I].texture}this._addTextureUniforms("TextureOutput",d,o,s),o.setAttributeAndModes(this._createProgram(i,s)),i.feedbackLoop?this._feedbackData[n]=this._createFeedbackLoopCameras(n,o,d,A):this.addChild(this._createCamera(n,o,d))}else{var C=this._textures[n].key;this._userTextures[n]=this._texturePool[C].texture}},_buildGraphFromPasses:function(e){for(var t=0;t<e.length;t++)this._buildPass(t,e)},build:function(e){this._usages={};var t=this._processUserPasses(e);this._checkInferredParameters(t),this._buildGraphFromPasses(t),this.resize(this._screenWidth,this._screenHeight)},_createFeedbackLoopCameras:function(e,t,i,n){var r=this._textures[e+"FeedbackTexture"].key,a=this._texturePool[r].texture,o=new je.Z;o.setStateSet(t);var s=this._createFeedbackLoopCamera(e,i,a,n),A=this._createFeedbackLoopCamera(e+"FeedbackTexture",a,i,n);A.setNodeMask(0),o.addChild(s),o.addChild(A),this.addChild(o);var g={};return g.camera1=s,g.camera2=A,g.texture1=i,g.texture2=a,g.nextPasses=[],g},_createFeedbackLoopCamera:function(e,t,i,n){var r=new tn.Z;r.setTextureAttributeAndModes(n,i);var a=this._createCamera(e,r,t);return a.setStateSet(r),a},_createCamera:function(e,t,i){var n=new nn.Z;n.setName(e),n.setStateSet(t),n.setClearMask(0),n.setReferenceFrame(Fe.Z.ABSOLUTE_RF),i&&(n.setRenderOrder(nn.Z.PRE_RENDER,0),n.attachTexture(rn.Z.COLOR_ATTACHMENT0,i)),n.setViewport(new an.Z);var r=Ye.Z.createTexturedFullScreenFakeQuadGeometry();return r.setName("composer layer"),n.addChild(r),this._cameras.push(n),n},swapFeedbackLoopTextures:function(e){for(var t in this._feedbackData){var i=this._feedbackData[t];i.camera1.setNodeMask(e?-1:0),i.camera2.setNodeMask(e?0:-1);for(var n=e?i.texture1:i.texture2,r=0;r<i.nextPasses.length;r++){var a=i.nextPasses[r];a.stateSet.setTextureAttributeAndModes(a.textureUnit,n)}}this._feedbackSwapped=!0},_createFuncFromUserData:function(e){var t="string"==typeof e?{name:e,file:e+".glsl"}:e;return t.toString=function(){return this.name},t},_createTextureInfoFromUserData:function(e){var t={name:"",uniformName:"",rgbm:void 0,srgb:void 0,filter:void 0};return"string"==typeof e?t.name=e:(t.name=e.name,e.uniformName&&(t.uniformName=e.uniformName),void 0!==e.rgbm&&(t.rgbm=e.rgbm),void 0!==e.srgb&&(t.srgb=e.srgb),void 0!==e.filter&&(t.filter=e.filter)),t},_preprocessUserPasses:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r={funcs:[]};if(n.func&&r.funcs.push(this._createFuncFromUserData(n.func)),r.textures=[],r.feedbackLoop=!1,void 0!==n.textures){Array.isArray(n.textures)||(n.textures=[n.textures]);for(var a=0;a<n.textures.length;a++){var o=this._createTextureInfoFromUserData(n.textures[a]);"%previous"===o.name&&(r.feedbackLoop=!0),r.textures.push(o)}}"string"==typeof n.header?r.header=[n.header]:r.header=n.header||[],void 0!==n.uniforms?Array.isArray(n.uniforms)?r.uniforms=n.uniforms:r.uniforms=[n.uniforms]:r.uniforms=[],r.out=n.out,r.out.divisor=r.out.divisor||1,r.out.type=r.out.type||Je.Z.UNSIGNED_BYTE,void 0===r.out.immuable&&(r.out.immuable=!1),void 0===r.out.reusable&&(r.out.reusable=!0),(r.feedbackLoop||-1===r.out.divisor)&&(r.out.immuable=!0,r.out.reusable=!1),r.collapsible=n.collapsible||!1,t.push(r)}return t},_canBeCollapsed:function(e,t){return e.funcs.length&&t.collapsible&&"%next"===e.out.name&&e.out.divisor===t.out.divisor&&e.out.width==e.out.width&&e.out.height==e.out.height},_collapsePasses:function(e,t){return!!this._canBeCollapsed(e,t)&&(e.funcs=e.funcs.concat(t.funcs),e.header=e.header.concat(t.header),e.textures=this._mergeWithoutDuplicates(e.textures,t.textures,(function(e,t){return e.name===t.name})),e.uniforms=this._mergeWithoutDuplicates(e.uniforms,t.uniforms,(function(e,t){return e.getName()===t.getName()})),!0)},_renameTextureAlias:function(e,t,i){"%last"===e.name?(e.name=i,e.uniformName=e.uniformName||"TextureInput"):"%previous"===e.name?(e.name=t+"FeedbackTexture",e.uniformName=e.uniformName||"TexturePrevious"):e.uniformName||(e.uniformName=e.name)},_createTexture:function(e,t,i,n){var r=new Je.Z;return r.setTextureSize(1,1),r.setInternalFormatType(i),r.setInternalFormat(Je.Z.RGBA),r.setMinFilter(n),r.setMagFilter(n),r.divisor=t,r.setName(e),r},_computeHashFromPass:function(e){for(var t="",i=0;i<e.funcs.length;i++)t+=e.funcs[i].name+"_"+e.funcs[i].file+"_";for(e.header&&(t+=e.header.join("_")),i=0;i<e.textures.length;i++)t+=!!e.textures[i].rgbm+"_"+!!e.textures[i].srgb+"_";return t+=!!e.out.encodeSRGB+"_",t+=!!this._textures[e.out.name].rgbm+"_"},_writeDeclarations:function(e,t,i,n){var r,a="uniform sampler2D TextureInput;\n";for(r=0;r<i.length;r++){a+="uniform sampler2D "+(i[r].uniformName||i[r].name)+";\n"}for(r=0;r<t.length;r++){var o=t[r];a+="uniform "+o.getType()+" "+o.getName()+";\n"}return e=e.replace("%uniforms%",a),n&&(e=e.replace("%header%",n.join("\n"))),e},setMethodWrapUV:function(e,t){void 0!==e&&(this._methodWrapUV=e),void 0!==t&&(this._thresholdWrapUV=t),this._texInfos=void 0},_getInfos:function(){if(this._texInfos)return this._texInfos;var e="texture2D(%tex, (uv) * %ratio)",t="texture2D(%tex, (floor((uv) * %size) + 0.5) * %ratio / %size, -99999.0)",i="texture2D(%tex, (uv) * %ratio)",n=this._thresholdWrapUV.toExponential();if(1===this._methodWrapUV){var r="min(uv, 1.0 - "+n+" / %size.xy)";e=e.replace(/(uv)/g,r),t=t.replace(/(uv)/g,r),i=i.replace(/(uv)/g,r)}else if(2===this._methodWrapUV){var a="step((uv).x, 1.0 - "+n+" / %size.x) *";e=(a+="step((uv).y, 1.0 - "+n+" / %size.y) * ")+e,t=a+t,i=a+i}return this._texInfos={TEXTURE_2D:{signature:"TEXTURE_2D_%tex(uv)",body:e},TEXTURE_2D_NEAREST:{signature:"TEXTURE_2D_NEAREST_%tex(uv)",body:t},TEXTURE_2D_BIAS:{signature:"TEXTURE_2D_BIAS_%tex(uv, bias)",body:i}},this._texInfos},_extractTextures:function(e){var t=this._getInfos(),i=e.match(/TEXTURE_2D(?:_BIAS|_NEAREST)?_\w+\(/g);if(!i)return{};for(var n={},r=0;r<i.length;r++){var a=i[r].match(/((TEXTURE_2D(?:_BIAS|_NEAREST)?)_(\w+))\(/),o=t[a[2]];n[a[1]]={name:a[3],signature:o.signature,body:o.body}}return n},_writeFunctionBodies:function(e,t,i,n){for(var r=[],a="",o={},s=0;s<t.length;s++){a+=An.Z.getShaderTextPure(t[s].file)+"\n"}a=An.Z.processIncludes(a,["utils/functions.glsl"]);var A=this._extractTextures(a);if(n){var g=this._getInfos().TEXTURE_2D;A.TEXTURE_2D_TextureInput={name:"TextureInput",signature:g.signature,body:g.body}}for(var h in A)if(!o[h]){o[h]=!0;for(var c=A[h],l=c.name,u=!1,d=0;d<i.length;d++){var I=i[d];if(I.uniformName===l){var C=this._textures[I.name];if(C&&C.rgbm){u=C.rgbm;break}}}var f=c.body;u&&(f="vec4(decodeRGBM("+f+", uRGBMRange), 1.0)"),f="#define "+c.signature+" ("+f+")";var p=this._getUniformName(l);f=(f=(f=f.replace(/%size/g,p+"Size")).replace(/%ratio/g,p+"Ratio")).replace(/%tex/g,l),r.push(f)}return(e=e.replace("%texturesColorSpace%",r.join("\n"))).replace("%functionBodies%",a.replace(/\\\n/g,""))},_writeMainFunction:function(e,t,i,n){var r=i?"TEXTURE_2D_TextureInput(gTexCoord)":"";e=(e=e.replace("%firstFunc%",t[0].name)).replace("%firstArg%",r);for(var a="",o=1;o<t.length;o++)a+="\tcolor = "+t[o].name+"(color);\n";(e=e.replace("%optionalFuncs%",a),!0===this._textures[n].encodeSRGB)?a="\tcolor.rgb = "+(this._textures[n].srgb?"linearTosRGB":"sRGBToLinear")+"(color.rgb);\n":a="";return this._textures[n].rgbm?a+="\tcolor = encodeRGBM(color.rgb, uRGBMRange);":a+="",e.replace("%colorSpaces%",a)},_removeDuplicatedUniforms:function(e){for(var t=e.split("\n"),i={},n=t.length,r=0;r<n;r++){var a=t[r].match(/uniform(?:\s+){1,}\w+(?:\s+){1,}(\w+)/);if(null!==a){var o=a[1];void 0!==i[o]?(t.splice(r,1),n--,r--):i[o]=!0}}return t.join("\n")},_createProgram:function(e,t){var i=this._computeHashFromPass(e);if(void 0!==this._programs[i])return this._programs[i];var n=this._writeDeclarations(gn.FragmentShader,t,e.textures,e.header);n=this._writeFunctionBodies(n,e.funcs,e.textures,e.collapsible),n=(n=this._writeMainFunction(n,e.funcs,e.collapsible,e.out.name)).replace("%name%",e.out.name),n=this._removeDuplicatedUniforms(n);var r=gn.VertexShader.replace("%name%",e.out.name),a=new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,r),new sn.Z(sn.Z.FRAGMENT_SHADER,n));return a._asyncLinkingExt=void 0,this._programs[i]=a,a},resize:function(e,t){for(var i in this.setScreenSize(e,t),this._texturePool){var n=this._texturePool[i].texture;void 0===this._texturePool[i].width?n.setTextureSize(this._getTextureSize(e,n.divisor),this._getTextureSize(t,n.divisor)):n.setTextureSize(this._texturePool[i].width,this._texturePool[i].height)}this.resizeRatio()},resizeRatio:function(e,t,i,n){void 0!==e&&(this._xViewportRatio=e),void 0!==t&&(this._yViewportRatio=t),void 0!==i&&(this._xTextureRatio=i),void 0!==n&&(this._yTextureRatio=n),this._resizeViewports(),this._resizeTextureUniforms()},_resizeViewports:function(){for(var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),i=this._cameras,n=0;n<i.length;++n){var r=i[n],a=1;if(r.isRenderToTextureCamera())a=r.getAttachments()[rn.Z.COLOR_ATTACHMENT0].texture.divisor;if(n===i.length-1&&this._finalPassUpScaleToScreen&&(e=this._xViewportRatio,t=this._yViewportRatio),-1!==a){var o=this._getTextureSize(this._screenWidth,a/e),s=this._getTextureSize(this._screenHeight,a/t);r.getViewport().setViewport(0,0,o,s)}}},_resizeTextureUniforms:function(){var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),i=this._finalPassUpScaleToScreen?this._xViewportRatio:e,n=this._finalPassUpScaleToScreen?this._yViewportRatio:t;this._syncFeedbackUniforms=!0;for(var r=this._textureUniforms,a=0;a<r.length;++a){var o=r[a],s=o.size.getInternalArray(),A=o.ratio.getInternalArray();if(!o.isFeedback||!s[0]){A[0]=e,A[1]=t;var g=o.texture;g?!g.divisor||g.divisor<0?(s[0]=g.getWidth(),s[1]=g.getHeight(),A[0]=A[1]=1):(s[0]=e*g.getWidth(),s[1]=t*g.getHeight()):(s[0]=this._screenWidth*i,s[1]=this._screenHeight*n)}}},_resizeFeedbackTextureUniforms:function(){for(var e=this._lastXratio,t=this._lastYratio,i=this._textureUniforms,n=0;n<i.length;++n){var r=i[n];if(r.isFeedback){var a=r.size.getInternalArray(),o=r.ratio.getInternalArray(),s=r.texture;o[0]=e,o[1]=t,a[0]=e*s.getWidth(),a[1]=t*s.getHeight()}}},cull:function(){return this._syncOnNextFrame&&(this._resizeFeedbackTextureUniforms(),this._syncOnNextFrame=!1),this._syncFeedbackUniforms&&this._feedbackSwapped&&(this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!0,this._lastXratio=this.getGlobalXRatio(),this._lastYratio=this.getGlobalYRatio()),this._feedbackSwapped=!1,!0},_mergeWithoutDuplicates:function(e,t,i){for(var n=0;n<t.length;n++){for(var r=t[n],a=!0,o=0;o<e.length;o++)if(i(e[o],r)){a=!1;break}a&&e.push(r)}return e},_getTextureSize:function(e,t){return Math.max(1,Math.round(e/t))},setScreenSize:function(e,t){this._screenWidth=e,this._screenHeight=t},addInternalTexture:function(e){this._internalPasses.push({out:{name:e.name,divisor:e.divisor,type:e.type,filter:e.filter,srgb:e.srgb,rgbm:e.rgbm,immuable:e.immuable,reusable:e.reusable}})},addExternalTexture:function(e,t){this._externalTextures[e]=t},setInputTexture:function(e){this._firstTexture=e},getCameras:function(){return this._cameras},getStateSetPass:function(e){return this._stateSets[e]},getInternalTexture:function(e){return this._userTextures[e]}}),"osgUtil","ComposerPostProcess");const hn=gn;var cn=function(e,t){var i,n;t?(i=t[0],n=t[1]):(i=e[14]/(e[10]-1),n=e[14]/(1+e[10]));var r=i*(e[8]-1)/e[0],a=i*(1+e[8])/e[0],o=i*(1+e[9])/e[5],s=i*(e[9]-1)/e[5],A=n*(e[8]-1)/e[0],g=n*(1+e[8])/e[0],h=n*(1+e[9])/e[5],c=n*(e[9]-1)/e[5],l=this.getAttributes().Vertex,u=l.getElements();u[0]=r,u[1]=s,u[2]=-i,u[3]=a,u[4]=s,u[5]=-i,u[6]=a,u[7]=o,u[8]=-i,u[9]=r,u[10]=o,u[11]=-i,u[12]=A,u[13]=c,u[14]=-n,u[15]=g,u[16]=c,u[17]=-n,u[18]=g,u[19]=h,u[20]=-n,u[21]=A,u[22]=h,u[23]=-n,l.dirty()};const ln={createDebugFrustumGeometry:function(){var e=Ye.Z.createBoundingBoxGeometry();return e.updateGeometry=cn,e}};var un=i("Z4fc"),dn=i("907W"),In=i("4rHk"),Cn=function(){J.Z.call(this),this._unifScale=en.Z.createFloat(1,"uScale");var e=this._normalStateSet=new tn.Z;e.addUniform(en.Z.createFloat3(o.R3.fromValues(1,0,0),"uColorDebug")),e.addUniform(this._unifScale),e.setAttributeAndModes(new $i.Z($i.Z.NEVER)),e.setShaderGeneratorName("debugNormal"),e.setRenderBinDetails(In.Z.DEBUG,"RenderBin");var t=this._tangentStateSet=new tn.Z;t.addUniform(en.Z.createFloat3(o.R3.fromValues(0,1,0),"uColorDebug")),t.addUniform(this._unifScale),t.setAttributeAndModes(new $i.Z($i.Z.NEVER)),t.setShaderGeneratorName("debugTangent"),t.setRenderBinDetails(In.Z.DEBUG,"RenderBin")};a.Z.createPrototypeObject(Cn,a.Z.objectInherit(J.Z.prototype,{setScale:function(e){this._unifScale.setFloat(e)},testCreateNormalVisitor:function(e){this._alreadyRun||(this._alreadyRun=!0,this.apply(e))},setTangentVisibility:function(e,t){this._tangentStateSet.setAttributeAndModes(new $i.Z(e?$i.Z.LESS:$i.Z.NEVER)),this.testCreateNormalVisitor(t)},setNormalVisibility:function(e,t){this._normalStateSet.setAttributeAndModes(new $i.Z(e?$i.Z.LESS:$i.Z.NEVER)),this.testCreateNormalVisitor(t)},apply:function(e){if(!(e instanceof ke.Z&&e.getCullCallback()||e._isVisitedNormalDebug)){if(e._isVisitedNormalDebug=!0,e instanceof ke.Z)return this._createDebugGeom(e,"Normal",this._normalStateSet),void this._createDebugGeom(e,"Tangent",this._tangentStateSet);this.traverse(e);for(var t=e.getUpdateCallbackList(),i=0,n=t.length;i<n;++i)t[i]instanceof te&&t[i].init(e)}},_createDoubleOffsetArray:function(e){for(var t=new Float32Array(2*e),i=0;i<e;++i)t[2*i]=1;return new W.Z(W.Z.ARRAY_BUFFER,t,1)},_createDoubledBufferArray:function(e){e.getInitialBufferArray&&(e=e.getInitialBufferArray());for(var t=e.getItemSize(),i=e.getElements(),n=i.length/t,r=new(0,i.constructor)(2*i.length),a=0;a<n;++a)for(var o=a*t,s=2*o,A=0;A<t;++A)r[s+A]=r[s+A+t]=i[o+A];return new W.Z(W.Z.ARRAY_BUFFER,r,t)},_addMorphTargets:function(e,t,i){var n=t.getMorphTargets();t.setName(e.getName());for(var r=e.getMorphTargets(),a=0,o=r.length;a<o;++a){var s=r[a],A=s.getVertexAttributeList(),g=new ke.Z;g.setName(s.getName());var h=g.getVertexAttributeList();h.Vertex=this._createDoubledBufferArray(A.Vertex),A[i]&&(h[i]=this._createDoubledBufferArray(A[i])),n.push(g)}return t.mergeChildrenVertexAttributeList(),t},_createDebugGeom:function(e,t,i){var n=e.getAttributes(),r=n[t];if(r){var a=n.Vertex;if(a){var o;e instanceof X.Z?o=e:e.getSourceGeometry&&e.getSourceGeometry()instanceof X.Z&&(o=e.getSourceGeometry());var s,A=a.getElements().length/a.getItemSize(),g=o?new X.Z:new ke.Z;if(g.getAttributes().Vertex=this._createDoubledBufferArray(a),g.getAttributes().Offset=this._createDoubleOffsetArray(A),g.getAttributes()[t]=this._createDoubledBufferArray(r),g.getPrimitives().push(new un.Z(dn.Z.LINES,0,2*A)),o&&this._addMorphTargets(o,g,t),e instanceof q.Z){var h=new q.Z;h.setSourceGeometry(g),h.getVertexAttributeList().Bones=this._createDoubledBufferArray(n.Bones),h.getVertexAttributeList().Weights=this._createDoubledBufferArray(n.Weights),h._rigTransformImplementation=e._rigTransformImplementation,h._stateSetAnimation=e._stateSetAnimation,h.mergeChildrenData(),s=h}else s=g;var c=e.getParents(),l=c.length;s._isVisitedNormalDebug=!0,s._isNormalDebug=!0,s.setStateSet(i),s.nodeMask=-49;for(var u=0;u<l;++u)c[u].addChild(s);return s}}}}),"osgUtil","DisplayNormalVisitor");const fn=Cn;var pn=i("/c5M"),mn=function(){J.Z.call(this),this._debugColor=!0,this._debugSkinning=!1,this._stCenter=new tn.Z,this._stCenter.setShaderGeneratorName("debugGeometry")};a.Z.createPrototypeObject(mn,a.Z.objectInherit(J.Z.prototype,{setGeometryDebug:function(e){this._stCenter.setAttributeAndModes(new $i.Z($i.Z.ALWAYS)),this._debugColor=!0,this._debugSkinning=!1,this.apply(e)},setSkinningDebug:function(e){this._stCenter.setAttributeAndModes(new $i.Z($i.Z.NEVER)),this._debugColor=!1,this._debugSkinning=!0,this._boneIndexErrors=[],this.apply(e),this._boneIndexErrors.length&&this._warnBonesIndex()},disableDebug:function(e){(this._debugColor||this._debugSkinning)&&(this._stCenter.setAttributeAndModes(new $i.Z($i.Z.NEVER)),this._debugColor=!1,this._debugSkinning=!1,this.apply(e))},_debugCenterGeometry:function(e,t){var i=e.getBound(),n=new Float32Array(18),r=.1*i.radius();n[0]=r,n[3]=-r,n[7]=r,n[10]=-r,n[14]=r,n[17]=-r;var a=new ke.Z;a.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,n,3);var s=new un.Z(dn.Z.LINES,0,6);a.getPrimitives().push(s);var A=new Ve.Z,g=i.center();A.getMatrix()[12]=g[0],A.getMatrix()[13]=g[1],A.getMatrix()[14]=g[2],A.addChild(a),this.nodePath[this.nodePath.length-2].addChild(A),t=o.R3.fromValues(.8*t[0],.8*t[1],.8*t[2]),a.getOrCreateStateSet().addUniform(en.Z.createFloat3(t,"uColorDebug")),A.setStateSet(this._stCenter),A._isCenterDebug=!0},_warnBonesIndex:function(){for(var e="Couldn't find bones. Indices: ",t="",i=0;i<this._boneIndexErrors.length&&i<10;i++){var n=this._boneIndexErrors[i];e+=n.index+", ",t+=n.boneNum+", "}pn.Z.client.captureMessage(e+" respectively reference bone nums: "+t)},_debugRigGeometry:function(e){var t=e.getVertexAttributeList();if(!t.BonesColor){for(var i=t.Bones.getElements(),n=t.Weights.getElements(),r=e._rigTransformImplementation._bones,a=i.length/4,o=new Float32Array(3*a),s=0;s<a;++s){for(var A=4*s,g=!1,h=A;h<A+4;h++)i[h]>r.length&&(this._boneIndexErrors.push({index:h,boneNum:i[h]}),g=!0);if(!g){var c=r[i[A]].getOrCreateDebugColor(),l=r[i[A+1]].getOrCreateDebugColor(),u=r[i[A+2]].getOrCreateDebugColor(),d=r[i[A+3]].getOrCreateDebugColor(),I=n[A],C=n[A+1],f=n[A+2],p=n[A+3],m=3*s;o[m]=I*c[0]+C*l[0]+f*u[0]+p*d[0],o[m+1]=I*c[1]+C*l[1]+f*u[1]+p*d[1],o[m+2]=I*c[2]+C*l[2]+f*u[2]+p*d[2]}}t.BonesColor=new W.Z(W.Z.ARRAY_BUFFER,o,3)}},_debugGeometry:function(e){var t=this._debugColor,i=this._debugSkinning&&e instanceof q.Z;if(t||i){void 0===e._originalStateSet&&(e._originalStateSet=e.getStateSet()||null);var n=new tn.Z;if(n.setRenderBinDetails(In.Z.DEBUG,"RenderBin"),e.setStateSet(n),i)return n.setShaderGeneratorName("debugSkinning"),void this._debugRigGeometry(e);var r=o.R3.fromValues(Math.random(),Math.random(),Math.random());n.addUniform(en.Z.createFloat3(r,"uColorDebug")),n.setShaderGeneratorName("debugGeometry"),this._debugCenterGeometry(e,r)}else void 0!==e._originalStateSet&&e.setStateSet(e._originalStateSet||void 0)},apply:function(e){e._isBoneBox||e._isSkeleton||e._isNormalDebug||e._isCenterDebug||(e instanceof ke.Z&&this._debugGeometry(e),this.traverse(e))}}),"osgUtil","GeometryColorDebugVisitor");const _n=mn;var En,vn,Sn,Bn=i("9Aw2"),wn=i("zACX"),yn=i("1PKS"),Mn=function(){if(En)return En;var e="#define SHADER_NAME GizmoLine3D",t=["attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;",e,"","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),i=["uniform vec4 uColor;",e,"","void main(void) {","  gl_FragColor = uColor;","}"].join("\n");return En=new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,t),new sn.Z(sn.Z.FRAGMENT_SHADER,i))},Dn=function(e,t){var i=e?.5*e:.5,n=t?.5*t:.5,r=new ke.Z,a=new Float32Array(12);a[0]=-i,a[1]=-n,a[3]=i,a[4]=-n,a[6]=-i,a[7]=n,a[9]=i,a[10]=n,r.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,a,3);var o=new un.Z(dn.Z.TRIANGLE_STRIP,0,4);return r.getOrCreateStateSet().setAttributeAndModes(Mn()),r.getPrimitives().push(o),r},bn={createCircleGeometry:function(e,t,i){for(var n=new ke.Z,r=new Float32Array(3*e),a=i||2*Math.PI,o=0;o<e;++o){var s=3*o,A=a*o/e;r[s]=Math.cos(A)*t,r[s+1]=Math.sin(A)*t}n.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,r,3);var g=new un.Z(dn.Z.LINE_STRIP,0,e);return n.getOrCreateStateSet().setAttributeAndModes(Mn()),n.getPrimitives().push(g),n},createCylinderGeometry:function(e,t,i,n,r,a,o){var s=void 0!==e?e:1,A=void 0!==t?t:1,g=void 0!==i?i:5,h=void 0!==n?n:32,c=void 0!==r?r:1,l=void 0===a||a,u=void 0===o||o,d=.5*g,I=(c+1)*(h+1),C=c*h*2;(l=l&&s>0)&&(I+=1,C+=h),(u=u&&A>0)&&(I+=1,C+=h);var f,p=new ke.Z,m=new Float32Array(3*I),_=new Uint16Array(3*C),E=0,v=0,S=0,B=0;for(S=0;S<=c;S++){var w=S/c,y=w*(A-s)+s;for(B=0;B<=h;B++){var M=B/h;m[v=3*E]=y*Math.sin(M*Math.PI*2),m[v+1]=y*Math.cos(M*Math.PI*2),m[v+2]=-w*g+d,E++}}for(E=0,B=0;B<h;B++)for(S=0;S<c;S++)_[v=6*E]=(h+1)*S+B,_[v+1]=_[v+3]=(h+1)*(S+1)+B,_[v+2]=_[v+5]=(h+1)*S+B+1,_[v+4]=(h+1)*(S+1)+B+1,E++;if(E*=2,l)for(m[3*(f=(u?m.length-6:m.length-3)/3)+2]=d,B=0;B<h;B++)_[v=3*E]=B,_[v+1]=B+1,_[v+2]=f,E++;if(u){m[3*(f=(m.length-3)/3)+2]=-d;var D=(h+1)*S;for(B=0;B<h;B++)_[v=3*E]=D+B+1,_[v+1]=D+B,_[v+2]=f,E++}return p.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,m,3),p.getOrCreateStateSet().setAttributeAndModes(Mn()),p.getPrimitives().push(new yn.Z(dn.Z.TRIANGLES,new W.Z(W.Z.ELEMENT_ARRAY_BUFFER,_,1))),p},createTorusGeometry:function(e,t,i,n,r){var a=void 0!==e?e:1,o=void 0!==t?t:.2,s=void 0!==i?i:6,A=void 0!==n?n:64,g=void 0!==r?r:2*Math.PI,h=(s+1)*(A+1),c=s*A*2,l=new ke.Z,u=new Float32Array(3*h),d=new Uint16Array(3*c);g=g||2*Math.PI;var I=0,C=0,f=0,p=0;for(p=0;p<=s;++p)for(f=0;f<=A;++f){var m=f/A*g,_=p/s*Math.PI*2;u[C=3*I]=(a+o*Math.cos(_))*Math.cos(m),u[C+1]=(a+o*Math.cos(_))*Math.sin(m),u[C+2]=o*Math.sin(_),I++}for(I=0,p=1;p<=s;++p)for(f=1;f<=A;++f)d[C=6*I]=(A+1)*p+f-1,d[C+1]=d[C+3]=(A+1)*(p-1)+f-1,d[C+2]=d[C+5]=(A+1)*p+f,d[C+4]=(A+1)*(p-1)+f,I++;return l.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,u,3),l.getOrCreateStateSet().setAttributeAndModes(Mn()),l.getPrimitives().push(new yn.Z(dn.Z.TRIANGLES,new W.Z(W.Z.ELEMENT_ARRAY_BUFFER,d,1))),l}};bn.createDebugLineGeometry=function(){var e=new ke.Z;e.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,new Float32Array(4),2);var t=new un.Z(dn.Z.LINES,0,2);return e.getPrimitives().push(t),e.getOrCreateStateSet().setAttributeAndModes(function(){if(vn)return vn;var e="#define SHADER_NAME GizmoLine2D",t=["attribute vec2 Vertex;",e,"","void main(void) {","  gl_Position = vec4(Vertex, 0.0, 1.0);","}"].join("\n"),i=[e,"","void main(void) {","  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);","}"].join("\n");return vn=new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,t),new sn.Z(sn.Z.FRAGMENT_SHADER,i))}()),e},bn.createPlaneGeometry=Dn,bn.createQuadCircleGeometry=function(){var e=Dn();return e.getOrCreateStateSet().setAttributeAndModes(function(){if(Sn)return Sn;var e="#define SHADER_NAME GizmoQuadCircle",t=["attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec3 vViewVertex;",e,"","void main(void) {","  vViewVertex = Vertex;","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),i=["uniform float uAngle;","uniform vec3 uBase;","varying vec3 vViewVertex;","const float PI = 3.14159265358979323846264;","const float PI2 = PI * 2.0;",e,"","void main(void) {","  if(length(vViewVertex) > 0.5)","    discard;","  vec3 vn = normalize(vViewVertex);","  float angle = atan(uBase.y * vn.x - uBase.x * vn.y, dot(uBase, vn));","  if(angle > 0.0) {","    if(uAngle >= 0.0 && angle > uAngle) discard;","    if(uAngle < -PI && angle < uAngle + PI2) discard;","    if(uAngle < 0.0 && uAngle > -PI) discard;","  }","  if(angle < 0.0) {","    if(uAngle <= 0.0 && angle < uAngle) discard;","    if(uAngle > PI && angle > uAngle - PI2) discard;","    if(uAngle > 0.0 && uAngle < PI) discard;","  }","  gl_FragColor = vec4(1.0, 1.0, 0.0, 0.5);","}"].join("\n");return Sn=new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,t),new sn.Z(sn.Z.FRAGMENT_SHADER,i))}()),e},bn.resetPrograms=function(){En=void 0,vn=void 0,Sn=void 0},bn.getOrCreateShader=Mn;const Qn=bn;var xn=function(){};xn.prototype={cull:function(){return!1}};var Tn=new ze.Z(ze.Z.SRC_ALPHA,ze.Z.ONE_MINUS_SRC_ALPHA),Fn=function(e){this._testPlane=e,this._inter=o.R3.create(),lt.Z.call(this)};a.Z.createPrototypeObject(Fn,a.Z.objectInherit(lt.Z.prototype,{setTestPlane:function(e){this._testPlane=e},getTranslateDistance:function(){return this._inter},enter:function(){var e=o.R3.create(),t=o.R3.create();return function(i){if(void 0===i._nbAxis)return!0;if(o.R3.init(e),e[i._nbAxis]=1,this._testPlane){var n=o.R3.dot(this._iStart,e),r=o.R3.dot(this._iEnd,e);if(n===r)return!1;var a=-n/(r-n);this._inter[0]=this._iStart[0]+(this._iEnd[0]-this._iStart[0])*a,this._inter[1]=this._iStart[1]+(this._iEnd[1]-this._iStart[1])*a,this._inter[2]=this._iStart[2]+(this._iEnd[2]-this._iStart[2])*a}else{o.R3.normalize(t,o.R3.sub(t,this._iEnd,this._iStart));var s=-o.R3.dot(t,e),A=o.R3.dot(this._iStart,t),g=Math.abs(1-s*s),h=-o.R3.dot(this._iStart,e);o.R3.init(this._inter),this._inter[i._nbAxis]=(s*A-h)/g}return!1}}(),intersectTriangle:function(){},intersectLine:function(){},intersectPoint:function(){}}),"osgUtil","LineCustomIntersector");var Rn=o._E.create(),Nn=function(e){Ve.Z.call(this),this._tmask=1,this._autoInsertMT=!1,this._correctPivotOnAutoInsert=!1,this._viewer=e,this._canvas=e.getGraphicContext().canvas,this._rotateNode=new Ve.Z,this._translateNode=new Ve.Z,this._planeNode=new Ve.Z,this._rotateInLocal=!0,this._translateInLocal=!0,this._showAngle=new Ve.Z,this._downCanvasCoord=o.K4.create(),this._hoverNode=null,this._keepHoverColor=o.vh.create(),this._isEditing=!1,this._editLineOrigin=o.R3.create(),this._editLineDirection=o.R3.create(),this._editOffset=o.R3.create(),this._editLocal=o._E.create(),this._editWorldTrans=o._E.create(),this._editWorldScaleRot=o._E.create(),this._editInvWorldScaleRot=o._E.create(),this._debugNode=new je.Z,this._lastDistToEye=0,this._attachedNode=null,this._pivotOffset=o.R3.create(),this.attachToNode(null),this._lsi=new Fn,this._origIntersect=o.R3.create(),this._dstIntersect=o.R3.create(),this._iv=new ct.Z,this._iv.setIntersector(this._lsi),this.init()};Nn.NO_PICK=1,Nn.PICK_ARC_X=2,Nn.PICK_ARC_Y=4,Nn.PICK_ARC_Z=8,Nn.PICK_ARROW_X=16,Nn.PICK_ARROW_Y=32,Nn.PICK_ARROW_Z=64,Nn.PICK_PLANE_X=128,Nn.PICK_PLANE_Y=256,Nn.PICK_PLANE_Z=512,Nn.NO_FULL_CIRCLE=1024,Nn.CORRECT_PIVOT=2048,Nn.PICK_GIZMO=(Nn.PICK_ARC=Nn.PICK_ARC_X|Nn.PICK_ARC_Y|Nn.PICK_ARC_Z)|(Nn.PICK_ARROW=Nn.PICK_ARROW_X|Nn.PICK_ARROW_Y|Nn.PICK_ARROW_Z)|(Nn.PICK_PLANE=Nn.PICK_PLANE_X|Nn.PICK_PLANE_Y|Nn.PICK_PLANE_Z);var Ln,kn,Pn,Un,On,Gn,Hn,Kn,Zn,Vn,Yn=function(){J.Z.call(this,J.Z.TRAVERSE_PARENTS),this._editableNode=null};a.Z.createPrototypeObject(Yn,a.Z.objectInherit(J.Z.prototype,{reset:function(){J.Z.prototype.reset.call(this),this._editableNode=null},getEditableNode:function(){return this._editableNode},apply:function(e){if(!this._editableNode){var t=e.editMask;t&&t&Nn.PICK_GIZMO?this._editableNode=e:this.traverse(e)}}})),a.Z.createPrototypeNode(Nn,a.Z.objectInherit(Ve.Z.prototype,{setRotateInLocal:function(e){this._rotateInLocal=e},setTranslateInLocal:function(e){this._translateInLocal=e},setTraversalMask:function(e){this._tmask=e},setAutoMatrixTransformInsertion:function(e){this._autoInsertMT=e},setCorrectPivotOnAutoInsert:function(e){this._correctPivotOnAutoInsert=e},isEditing:function(){return this._isEditing},getAttachedNode:function(){return this._attachedNode},init:function(){this.getOrCreateStateSet().setAttributeAndModes(new $i.Z($i.Z.DISABLE)),this.getOrCreateStateSet().setAttributeAndModes(new Xi.Z(Xi.Z.DISABLE)),this.addUpdateCallback(this),this.addChild(this.initNodeTranslate()),this.addChild(this.initNodeTranslatePlane()),this.addChild(this.initNodeRotate()),this._debugNode&&(this._debugNode.addChild(Qn.createDebugLineGeometry()),this.addChild(this._debugNode),this._debugNode.setNodeMask(0));var e=this._viewer.getInputManager();e.group(xt.Z.NODE_GIZMO).addMappings({onMouseMove:"mousemove",onMouseDown:"mousedown",onMouseUp:["mouseup","mouseout"]},this),e.setPriority(xt.Z.NODE_GIZMO,e.getHigherPriority(xt.Z.MANIPULATORS))},_insertEditNode:function(e,t){var i=new Ve.Z;return i.editMask=Nn.PICK_GIZMO,this._correctPivotOnAutoInsert&&(i.editMask|=Nn.CORRECT_PIVOT),e.addChild(i),e.removeChild(t),i.addChild(t),i._isInserted=!0,i},_findEditNodeFromNodePath:function(e){if(!e)return null;var t=e[e.length-1];if(t.editMask)return t;if(!this._autoInsertMT){for(var i=e.length-1;i>=0;--i){var n=e[i].editMask;if(n&&n&Nn.PICK_GIZMO)return e[i]}return null}var r=e[e.length-2];return r.editMask?r:this._insertEditNode(r,t)},_findEditNodeFromNode:function(e){if(!e)return null;if(e.editMask)return e;if(this._autoInsertMT){for(var t=e.getParents(),i=0;i<t.length;++i){var n=t[i].editMask;if(n&&n&Nn.PICK_GIZMO)return t[i]}return this._insertEditNode(t[0],e)}return this._getEditNodeVisitor?this._getEditNodeVisitor.reset():this._getEditNodeVisitor=new Yn,e.accept(this._getEditNodeVisitor),this._getEditNodeVisitor.getEditableNode()},attachToNodePath:function(e){var t=this._findEditNodeFromNodePath(e);this._attachEditNode(t,e&&e[e.length-1])},attachToNode:function(e){var t=this._findEditNodeFromNode(e);this._attachEditNode(t,e)},_attachEditNode:function(e,t){this._attachedNode=e,e&&t&&t!==e&&e.editMask&Nn.CORRECT_PIVOT&&o.R3.copy(this._pivotOffset,t.getBoundingSphere().center()),this.updateGizmoMask()},updateGizmoMask:function(){if(!this._attachedNode)return o.R3.init(this._pivotOffset),void this.setNodeMask(0);var e=this._attachedNode.editMask;this.setNodeMask(e&Nn.PICK_GIZMO?Nn.NO_PICK:0),this._translateNode.setNodeMask(e&Nn.PICK_ARROW?Nn.PICK_ARROW:0),this._rotateNode.setNodeMask(e&Nn.PICK_ARC?Nn.PICK_ARC:0),this._planeNode.setNodeMask(e&Nn.PICK_PLANE?Nn.PICK_PLANE:0);var t=this._translateNode.getChildren();t[0].setNodeMask(e&Nn.PICK_ARROW_X?Nn.PICK_ARROW_X:0),t[1].setNodeMask(e&Nn.PICK_ARROW_Y?Nn.PICK_ARROW_Y:0),t[2].setNodeMask(e&Nn.PICK_ARROW_Z?Nn.PICK_ARROW_Z:0);var i=this._rotateNode.getChildren();i[0].setNodeMask(e&Nn.NO_FULL_CIRCLE?0:Nn.NO_PICK),i[1].setNodeMask(e&Nn.PICK_ARC_X?Nn.PICK_ARC_X:0),i[2].setNodeMask(e&Nn.PICK_ARC_Y?Nn.PICK_ARC_Y:0),i[3].setNodeMask(e&Nn.PICK_ARC_Z?Nn.PICK_ARC_Z:0);var n=this._planeNode.getChildren();n[0].setNodeMask(e&Nn.PICK_PLANE_X?Nn.PICK_PLANE_X:0),n[1].setNodeMask(e&Nn.PICK_PLANE_Y?Nn.PICK_PLANE_Y:0),n[2].setNodeMask(e&Nn.PICK_PLANE_Z?Nn.PICK_PLANE_Z:0)},onNodeHovered:(Vn=o.vh.fromValues(1,1,0,1),function(e){if(this._hoverNode&&this._hoverNode.getStateSet().getUniform("uColor").setFloat4(this._keepHoverColor),e){for(var t=e._nodePath,i=t.length-1,n=t[i];void 0===n._nbAxis;){if(0===i)return;n=t[--i]}var r=n.getStateSet().getUniform("uColor");this._hoverNode=n,o.vh.copy(this._keepHoverColor,r.getInternalArray()),r.setFloat4(Vn)}else this._hoverNode=null}),initNodeRotate:function(){var e=Qn.createTorusGeometry(1,.01,6,64,2*Math.PI),t=Qn.createTorusGeometry(1,.01,6,64,Math.PI),i=Qn.createTorusGeometry(1,.1,6,64,Math.PI),n=new Ve.Z,r=new Ve.Z,a=new Ve.Z,s=new Ve.Z;r._nbAxis=0,a._nbAxis=1,s._nbAxis=2;var A=new je.Z;A.setCullCallback(new xn),A.addChild(i),e.setNodeMask(Nn.NO_PICK),t.setNodeMask(Nn.NO_PICK),r.setNodeMask(Nn.PICK_ARC_X),a.setNodeMask(Nn.PICK_ARC_Y),s.setNodeMask(Nn.PICK_ARC_Z),n.addChild(e),r.addChild(t),a.addChild(t),s.addChild(t),r.addChild(A),a.addChild(A),s.addChild(A),n.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(.2,.2,.2,1),"uColor")),r.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(1,0,0,1),"uColor")),a.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,1,0,1),"uColor")),s.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,0,1,1),"uColor"));var g=this._showAngle;g.getOrCreateStateSet().setAttributeAndModes(Tn),g.setNodeMask(0),g.getOrCreateStateSet().addUniform(en.Z.createFloat3(o.R3.fromValues(1,0,0),"uBase")),g.getOrCreateStateSet().addUniform(en.Z.createFloat(0,"uAngle")),g.addChild(Qn.createQuadCircleGeometry());var h=this._rotateNode;return h.setNodeMask(Nn.PICK_ARC),h.addChild(n),h.addChild(r),h.addChild(a),h.addChild(s),h.addChild(g),h},initNodeTranslate:function(){var e=1.5,t=1.3*1.1,i=new Ve.Z;o._E.fromTranslation(i.getMatrix(),o.R3.fromValues(0,0,1.65)),i.addChild(Qn.createCylinderGeometry(0,.07,.3,32,1,!0,!0));var n=new Ve.Z;o._E.fromTranslation(n.getMatrix(),o.R3.fromValues(0,0,.75)),n.addChild(Qn.createCylinderGeometry(.01,.01,e,32,1,!0,!0));var r=new je.Z;r.addChild(n),r.addChild(i);var a=Qn.createCylinderGeometry(.1,.1,t,32,1,!0,!0),s=new Ve.Z,A=new Ve.Z,g=new Ve.Z;s._nbAxis=0,A._nbAxis=1,g._nbAxis=2,o._E.fromRotation(s.getMatrix(),.5*Math.PI,o.R3.fromValues(0,1,0)),o._E.fromRotation(A.getMatrix(),.5*-Math.PI,o.R3.fromValues(1,0,0));var h=new Ve.Z;h.setCullCallback(new xn),o._E.fromTranslation(h.getMatrix(),o.R3.fromValues(0,0,1.215)),h.addChild(a),r.setNodeMask(Nn.NO_PICK),s.setNodeMask(Nn.PICK_ARROW_X),A.setNodeMask(Nn.PICK_ARROW_Y),g.setNodeMask(Nn.PICK_ARROW_Z),s.addChild(r),A.addChild(r),g.addChild(r),s.addChild(h),A.addChild(h),g.addChild(h),s.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(1,0,0,1),"uColor")),A.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,1,0,1),"uColor")),g.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,0,1,1),"uColor"));var c=this._translateNode;return c.setNodeMask(Nn.PICK_ARROW),c.addChild(s),c.addChild(A),c.addChild(g),c},initNodeTranslatePlane:function(){var e=new Ve.Z;o._E.fromTranslation(e.getMatrix(),o.R3.fromValues(.5,.5,0)),o._E.mul(e.getMatrix(),o._E.fromScaling(o._E.create(),o.R3.fromValues(.5,.5,1)),e.getMatrix()),e.addChild(Qn.createPlaneGeometry());var t=new Ve.Z,i=new Ve.Z,n=new Ve.Z;t._nbAxis=0,i._nbAxis=1,n._nbAxis=2,o._E.fromRotation(t.getMatrix(),.5*-Math.PI,o.R3.fromValues(0,1,0)),o._E.fromRotation(i.getMatrix(),.5*Math.PI,o.R3.fromValues(1,0,0)),t.setNodeMask(Nn.PICK_PLANE_X),i.setNodeMask(Nn.PICK_PLANE_Y),n.setNodeMask(Nn.PICK_PLANE_Z),t.addChild(e),i.addChild(e),n.addChild(e),t.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(1,0,0,.3),"uColor")),i.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,1,0,.3),"uColor")),n.getOrCreateStateSet().addUniform(en.Z.createFloat4(o.vh.fromValues(0,0,1,.3),"uColor"));var r=this._planeNode;return r.setNodeMask(Nn.PICK_PLANE),r.getOrCreateStateSet().setAttributeAndModes(Tn),r.addChild(t),r.addChild(i),r.addChild(n),r},updateArcRotation:(Hn=o.gf.create(),Kn=o.gf.setAxisAngle(o.gf.create(),[0,1,0],.5*-Math.PI),Zn=o.gf.setAxisAngle(o.gf.create(),[1,0,0],.5*-Math.PI),function(e){var t=this._rotateNode.getChildren();Hn[0]=-e[1],Hn[1]=e[0],Hn[2]=0,Hn[3]=1+e[2],o.gf.normalize(Hn,Hn),o._E.fromQuat(t[0].getMatrix(),Hn),o.gf.setAxisAngle(Hn,[1,0,0],Math.atan2(e[2],e[1])),o.gf.mul(Hn,Hn,Kn),o._E.fromQuat(t[1].getMatrix(),Hn),o.gf.setAxisAngle(Hn,[0,1,0],Math.atan2(-e[0],-e[2])),o.gf.mul(Hn,Hn,Zn),o._E.fromQuat(t[2].getMatrix(),Hn),o.gf.setAxisAngle(Hn,[0,0,1],Math.atan2(-e[0],e[1])),o._E.fromQuat(t[3].getMatrix(),Hn),t[1].dirtyBound(),t[2].dirtyBound(),t[3].dirtyBound()}),getTransformType:function(e){for(var t=e;t.getParents().length>0;){var i=t.referenceFrame;if(void 0!==i&&i===Fe.Z.ABSOLUTE_RF)return Fe.Z.ABSOLUTE_RF;t=t.getParents()[0]}return Fe.Z.RELATIVE_RF},getAttachedNodeWorldMatrix:function(){var e=this._attachedNode.getWorldMatrix(void 0,Rn);return o._E.translate(e,e,this._pivotOffset)},update:(Pn=o.R3.create(),Un=o.R3.create(),On=o.R3.create(),Gn=o._E.create(),function(){if(this._attachedNode){var e=this.getTransformType(this._attachedNode);this.setReferenceFrame(e),this.setCullingActive(e===Fe.Z.RELATIVE_RF);var t=this.getAttachedNodeWorldMatrix();o._E.getTranslation(Un,t);var i=3;if(e===Fe.Z.ABSOLUTE_RF)Pn[0]=Pn[1]=Pn[2]=0;else{var n=this._viewer.getCamera().getProjectionMatrix(),r=.023*this._canvas.clientWidth*n[0];this._viewer.getManipulator().getEyePosition(Pn),this._lastDistToEye=this._isEditing?this._lastDistToEye:o.R3.distance(Un,Pn),i*=this._lastDistToEye/r}var a=this.getMatrix();if(o._E.fromTranslation(a,Un),o.R3.set(On,i,i,i),o._E.mul(a,a,o._E.fromScaling(Gn,On)),o.R3.sub(Pn,Pn,Un),o.R3.normalize(Pn,Pn),this._rotateInLocal||this._translateInLocal){o._E.getScale(On,t);var s=o._E.fromScaling(Gn,On);o._E.invert(s,s);var A=o._E.mul(t,t,s);A[12]=A[13]=A[14]=0,this._translateInLocal&&(o._E.copy(this._translateNode.getMatrix(),A),o._E.copy(this._planeNode.getMatrix(),A)),this._rotateInLocal&&(o._E.copy(this._rotateNode.getMatrix(),A),o._E.invert(A,A),o.R3.transformMat4(Pn,Pn,A))}else o._E.identity(this._rotateNode.getMatrix());this.updateArcRotation(Pn),this._rotateNode.dirtyBound(),this._translateNode.dirtyBound(),this._planeNode.dirtyBound(),this._isEditing&&o._E.copy(this._showAngle.getMatrix(),this._hoverNode.getMatrix())}}),computeNearestIntersection:(kn=function(e,t){return e._ratio-t._ratio},function(e,t){var i=this._viewer,n=this._canvas,r=e.canvasX*(i._canvasWidth/n.clientWidth),a=(n.clientHeight-e.canvasY)*(i._canvasHeight/n.clientHeight),o=this._viewer.computeIntersections(r,a,t);if(0!==o.length)return o.sort(kn),o[0]}),setOnlyGizmoPicking:function(){this._viewer.getCamera().addChild(this),this._viewer.getSceneData().setNodeMask(0),this.setNodeMask(-1)},setOnlyScenePicking:function(){this._viewer.getCamera().removeChild(this),this._viewer.getSceneData().setNodeMask(-1),this.setNodeMask(Nn.NO_PICK)},pickGizmo:function(e,t){this.setOnlyGizmoPicking();var i=this.computeNearestIntersection(e,t);return this.setOnlyScenePicking(),i},getCanvasPositionFromWorldPoint:(Ln=o._E.create(),function(e,t){var i=this._viewer.getCamera(),n=t;i.getViewport()?i.getViewport().computeWindowMatrix(Ln):o._E.identity(Ln),o._E.mul(Ln,Ln,i.getProjectionMatrix()),this.getReferenceFrame()===Fe.Z.RELATIVE_RF&&o._E.mul(Ln,Ln,i.getViewMatrix()),o.R3.transformMat4(n,e,Ln);var r=this._viewer,a=this._canvas;return n[0]=n[0]/(r._canvasWidth/a.clientWidth),n[1]=a.clientHeight-n[1]/(r._canvasHeight/a.clientHeight),n}),onMouseDown:function(e){if(o.K4.set(this._downCanvasCoord,e.canvasX,e.canvasY),this._hoverNode&&this._attachedNode){this._viewer.setEnableManipulator(!1),this.saveEditMatrices();var t=this._hoverNode.getParents()[0].getNodeMask();this._isEditing=!0,t&Nn.PICK_ARC?(this._translateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startRotateEdit(e)):t&Nn.PICK_ARROW?(this._rotateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startTranslateEdit(e)):t&Nn.PICK_PLANE&&(this._rotateNode.setNodeMask(0),this._translateNode.setNodeMask(0),this.startPlaneEdit(e))}},saveEditMatrices:function(){o._E.copy(this._editLocal,this._attachedNode.getMatrix());var e=this.getAttachedNodeWorldMatrix();o._E.fromTranslation(this._editWorldTrans,o.R3.fromValues(e[12],e[13],e[14])),o._E.copy(this._editWorldScaleRot,e),this._editWorldScaleRot[12]=this._editWorldScaleRot[13]=this._editWorldScaleRot[14]=0,o._E.invert(this._editInvWorldScaleRot,this._editWorldScaleRot)},startRotateEdit:function(e){var t=this._rotateNode.getWorldMatrix(void 0,Rn),i=o.R3.create();o.R3.transformMat4(i,i,t),this.getCanvasPositionFromWorldPoint(i,i);var n=this.pickGizmo(e,this._hoverNode.getNodeMask()|Nn.PICK_ARC);if(n){var r=0===this._hoverNode._nbAxis?-1:1,a=o.R3.create();a[0]=r*n._localIntersectionPoint[1],a[1]=-r*n._localIntersectionPoint[0],a[2]=n._localIntersectionPoint[2];var s=o.R3.create();o.R3.transformMat4(s,a,this._hoverNode.getMatrix()),o.R3.transformMat4(s,s,t),this.getCanvasPositionFromWorldPoint(s,s);var A=this._editLineDirection;o.K4.sub(A,s,i),o.K4.normalize(A,A),this._showAngle.setNodeMask(Nn.NO_PICK),n._localIntersectionPoint[2]=0;var g=this._showAngle.getStateSet();g.getUniform("uAngle").setFloat(0),g.getUniform("uBase").setVec3(o.R3.normalize(n._localIntersectionPoint,n._localIntersectionPoint)),this._editLineOrigin[0]=e.canvasX,this._editLineOrigin[1]=e.canvasY}},startTranslateEdit:function(e){var t=this._editLineOrigin,i=this._editLineDirection,n=this._translateNode.getWorldMatrix(void 0,Rn);o._E.getTranslation(t,n),o.R3.init(i),i[this._hoverNode._nbAxis]=1,this._translateInLocal&&(o.R3.transformMat4(i,i,this._editWorldScaleRot),o.R3.normalize(i,i)),o.R3.add(i,t,i),this.getCanvasPositionFromWorldPoint(t,t),this.getCanvasPositionFromWorldPoint(i,i),o.K4.sub(i,i,t),o.K4.normalize(i,i);var r=this._editOffset;o.K4.set(r,e.canvasX,e.canvasY),o.K4.sub(r,r,t)},startPlaneEdit:function(e){var t=this._editLineOrigin,i=this._planeNode.getWorldMatrix(void 0,Rn);o._E.getTranslation(t,i),this.getCanvasPositionFromWorldPoint(t,t);var n=this._editOffset;o.K4.set(n,e.canvasX,e.canvasY),o.K4.sub(n,n,t)},drawLineCanvasDebug:function(e,t,i,n){this._debugNode.setNodeMask(Nn.NO_PICK);var r=this._debugNode.getChildren()[0].getAttributes().Vertex;r.getElements()[0]=e/this._canvas.clientWidth*2-1,r.getElements()[1]=(this._canvas.clientHeight-t)/this._canvas.clientHeight*2-1,r.getElements()[2]=i/this._canvas.clientWidth*2-1,r.getElements()[3]=(this._canvas.clientHeight-n)/this._canvas.clientHeight*2-1,r.dirty()},pickAndSelect:function(e){this.setNodeMask(0);var t=this.computeNearestIntersection(e,this._tmask);this.attachToNodePath(t?t._nodePath:t)},onMouseUp:function(e){this._viewer.setEnableManipulator(!0),this._debugNode&&this._debugNode.setNodeMask(0);var t=o.K4.fromValues(e.canvasX,e.canvasY);0===o.K4.distance(t,this._downCanvasCoord)&&this.pickAndSelect(e),this._showAngle.setNodeMask(0),this._isEditing=!1,this._hoverNode&&this.updateGizmoMask()},onMouseMove:function(e){if(this._attachedNode){var t;if(!1===this._isEditing)return t=this.pickGizmo(e,Nn.PICK_GIZMO),void this.onNodeHovered(t);if(this._hoverNode){var i=this._hoverNode.getParents()[0];i===this._rotateNode?this.updateRotateEdit(e):i===this._translateNode?this.updateTranslateEdit(e):i===this._planeNode&&this.updatePlaneEdit(e)}}},updateRotateEdit:function(){var e=o._E.create(),t=o.K4.create(),i=o.R3.fromValues(1,0,0),n=o.R3.fromValues(0,1,0),r=o.R3.fromValues(0,0,1),a=o.R3.create();return function(s){var A=this._editLineOrigin,g=this._editLineDirection;o.K4.set(t,s.canvasX,s.canvasY),o.K4.sub(t,t,A);var h=o.K4.dot(t,g);if(this._debugNode){var c=A[0],l=A[1];this.drawLineCanvasDebug(c,l,c+g[0]*h,l+g[1]*h)}var u=7*h/Math.min(this._canvas.clientWidth,this._canvas.clientHeight);u%=2*Math.PI;var d=this._hoverNode._nbAxis;0===d?o._E.fromRotation(e,-u,i):1===d?o._E.fromRotation(e,-u,n):2===d&&o._E.fromRotation(e,-u,r),this._showAngle.getOrCreateStateSet().getUniform("uAngle").setFloat(0===d?-u:u),this._rotateInLocal||(o._E.mul(e,this._editInvWorldScaleRot,e),o._E.mul(e,e,this._editWorldScaleRot));var I=this._attachedNode.getMatrix();o._E.translate(I,this._editLocal,this._pivotOffset),o._E.mul(I,I,e),o._E.translate(I,I,o.R3.negate(a,this._pivotOffset)),this._attachedNode.dirtyBound()}}(),updateTranslateEdit:function(){var e=o.K4.create(),t=o.R3.create();return function(i){var n=this._editLineOrigin,r=this._editLineDirection;o.K4.set(e,i.canvasX,i.canvasY),o.K4.sub(e,e,n),o.K4.sub(e,e,this._editOffset);var a=o.K4.dot(e,r);e[0]=n[0]+r[0]*a,e[1]=n[1]+r[1]*a,this._debugNode&&this.drawLineCanvasDebug(n[0],n[1],e[0],e[1]);var s=this._viewer,A=this._canvas,g=e[0]*(s._canvasWidth/A.clientWidth),h=(A.clientHeight-e[1])*(s._canvasHeight/A.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!1),this._lsi.set(o.R3.set(this._origIntersect,g,h,0),o.R3.set(this._dstIntersect,g,h,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),o._E.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){o._E.getScale(t,this._editInvWorldScaleRot);var c=this._lsi.getTranslateDistance();o.R3.mul(t,t,c)}else o.R3.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);o._E.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}(),updatePlaneEdit:function(){var e=o.K4.create(),t=o.R3.create();return function(i){o.K4.set(e,i.canvasX,i.canvasY),o.K4.sub(e,e,this._editOffset);var n=this._viewer,r=this._canvas,a=e[0]*(n._canvasWidth/r.clientWidth),s=(r.clientHeight-e[1])*(n._canvasHeight/r.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!0),this._lsi.set(o.R3.set(this._origIntersect,a,s,0),o.R3.set(this._dstIntersect,a,s,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),o._E.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){o._E.getScale(t,this._editInvWorldScaleRot);var A=this._lsi.getTranslateDistance();o.R3.mul(t,t,A)}else o.R3.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);o._E.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}()}),"osgUtil","NodeGizmo");const Jn=Nn;var zn,jn,Wn,qn=function(){Ct.Z.Intersection.call(this),this._localIntersectionNormal=o.R3.clone(o.R3.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},Xn=function(){Ct.Z.apply(this),this._center=void 0,this._radius=0};a.Z.createPrototypeObject(Xn,a.Z.objectInherit(Ct.Z.prototype,{set:function(e,t){this._center=e,this._radius=t},enter:function(e){for(var t=this._radius*this._radius,i=0,n=e.getMin(),r=e.getMax(),a=0,o=0;o<3;o++)this._center[o]<n[o]?i+=(a=this._center[o]-n[o])*a:this._center[o]>r[o]&&(i+=(a=this._center[o]-r[o])*a);return i<=t},intersectPoint:function(e,t){var i=o.R3.sqrDist(e,this._center);if(!(i>this._radius*this._radius)){var n=this.initIntersection(new qn);n._i1=t,n._r1=1,o.R3.copy(n._localIntersectionPoint,e),n._ratio=Math.sqrt(i)/this._radius}},intersectLine:function(){var e=o.R3.create(),t=o.R3.create();return function(i,n,r,a){o.R3.sub(e,this._center,i),o.R3.sub(t,n,i);var s=o.R3.dot(e,t)/o.R3.sqrLen(t),A=1;if(!((A=s<0?o.R3.sqrLen(e):s>1?o.R3.sqrDist(this._center,n):o.R3.sqrLen(o.R3.scaleAndAdd(e,e,t,-s)))>this._radius*this._radius)){var g=this.initIntersection(new qn);g._i1=r,g._i2=a,g._r1=1-s,g._r2=s,o.R3.scaleAndAdd(g._localIntersectionPoint,i,t,s),g._ratio=Math.sqrt(A)/this._radius}}}(),intersectTriangle:(zn=o.R3.create(),jn=o.R3.create(),Wn=o.R3.create(),function(e,t,i,n,r,a){if(!this._limitOneIntersection||!this._hit){o.R3.sub(zn,t,e),o.R3.sub(jn,i,e);var s=o.R3.sqrLen(zn),A=o.R3.dot(zn,jn),g=o.R3.sqrLen(jn);o.R3.sub(Wn,e,this._center);var h=o.R3.dot(Wn,zn),c=o.R3.dot(Wn,jn),l=o.R3.sqrLen(Wn),u=Math.abs(s*g-A*A);if(!(u<1e-10)){var d,I,C,f,p,m=A*c-g*h,_=A*h-s*c,E=4;if(m+_<=u)if(m<0)_<0?(E=4,h<0?(_=0,-h>=s?(m=1,d=s+2*h+l):d=h*(m=-h/s)+l):(m=0,c>=0?(_=0,d=l):-c>=g?(_=1,d=g+2*c+l):d=c*(_=-c/g)+l)):(E=3,m=0,c>=0?(_=0,d=l):-c>=g?(_=1,d=g+2*c+l):d=c*(_=-c/g)+l);else if(_<0)E=5,_=0,h>=0?(m=0,d=l):-h>=s?(m=1,d=s+2*h+l):d=h*(m=-h/s)+l;else{E=0;var v=1/u;d=(m*=v)*(s*m+A*(_*=v)+2*h)+_*(A*m+g*_+2*c)+l}else m<0?(E=2,(C=g+c)>(I=A+h)?(f=C-I)>=(p=s-2*A+g)?(m=1,_=0,d=s+2*h+l):d=(m=f/p)*(s*m+A*(_=1-m)+2*h)+_*(A*m+g*_+2*c)+l:(m=0,C<=0?(_=1,d=g+2*c+l):c>=0?(_=0,d=l):d=c*(_=-c/g)+l)):_<0?(E=6,(C=s+h)>(I=A+c)?(f=C-I)>=(p=s-2*A+g)?(_=1,m=0,d=g+2*c+l):d=(m=1-(_=f/p))*(s*m+A*_+2*h)+_*(A*m+g*_+2*c)+l:(_=0,C<=0?(m=1,d=s+2*h+l):h>=0?(m=0,d=l):d=h*(m=-h/s)+l)):(E=1,(f=g+c-A-h)<=0?(m=0,_=1,d=g+2*c+l):f>=(p=s-2*A+g)?(m=1,_=0,d=s+2*h+l):d=(m=f/p)*(s*m+A*(_=1-m)+2*h)+_*(A*m+g*_+2*c)+l);if(!(d>this._radius*this._radius)){var S=o.R3.create(),B=this.initIntersection(new qn);B._i1=n,B._i2=r,B._i3=a,B._r1=1-m-_,B._r2=m,B._r3=_;var w=B._localIntersectionPoint;o.R3.scaleAndAdd(w,o.R3.scaleAndAdd(w,e,zn,m),jn,_),o.R3.cross(B._localIntersectionNormal,zn,jn),o.R3.normalize(S,B._localIntersectionNormal),B._ratio=Math.sqrt(d)/this._radius,B._zone=E}}}})}),"osgUtil","SphereIntersectFunctor");const $n=Xn;var er=function(){It.Z.call(this),this._center=o.R3.create(),this._iCenter=o.R3.create(),this._radius=1,this._iRadius=1};a.Z.createPrototypeObject(er,a.Z.objectInherit(It.Z.prototype,{set:function(e,t){o.R3.copy(this._center,e),o.R3.copy(this._iCenter,e),this._radius=this._iRadius=t,this.reset()},setCenter:function(e){o.R3.copy(this._center,e),o.R3.copy(this._iCenter,e)},setRadius:function(e){this._radius=this._iRadius=e},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:function(e){if(!e.valid())return!1;var t=this._iRadius+e.radius();return o.R3.sqrDist(e.center(),this._iCenter)<=t*t},intersect:function(){var e=new $n;return function(t,i){e.setGeometry(i),e.setIntersectionVisitor(t),e.setIntersector(this),e.set(this._iCenter,this._iRadius);var n=i.getShape();n?n.intersect(e,n.getNodes()[0]):(i.computeTransformedVertices&&e.setVertices(i.computeTransformedVertices()),e.apply(i)),e.reset()}}(),setCurrentTransformation:function(){var e=o.R3.create();return function(t){o._E.invert(t,t),o.R3.transformMat4(this._iCenter,this._center,t),o._E.getScale(e,t);var i=e[0],n=e[1],r=e[2],a=i>n?i>r?i:r:n>r?n:r;this._iRadius=this._radius*a}}()}),"osgUtil","SphereIntersector");const tr=er;var ir=function(){J.Z.call(this),this._T=void 0,this._B=void 0,this._N=void 0,this._texCoordUnit=0};a.Z.createPrototypeObject(ir,a.Z.objectInherit(J.Z.prototype,{apply:function(e){e.getTypeID()===ke.Z.getTypeID()?this.generate(e,this._texCoordUnit):this.traverse(e)},setTexCoordUnit:function(e){this._texCoordUnit=e},computePrimitiveSet:function(e,t){if(t.getIndices){var i,n=t.getNumIndices(),r=e.getAttributes().Vertex,a=e.getAttributes().Normal,o=e.getAttributes()["TexCoord"+this._texCoordUnit];if(t.getMode()===dn.Z.TRIANGLES)for(i=0;i<n;i+=3)this.compute(t,r,a,o,i,i+1,i+2);else if(t.getMode()===dn.Z.TRIANGLE_STRIP)for(i=0;i<n-2;++i)i%2==0?this.compute(t,r,a,o,i,i+1,i+2):this.compute(t,r,a,o,i+1,i,i+2)}},generate:function(e,t){if(this._texCoordUnit=t,void 0===this._texCoordUnit&&(this._texCoordUnit=0),e.getAttributes()["TexCoord"+this._texCoordUnit]){var i=e.getAttributes().Vertex.getElements().length;this._T=new a.Z.Float32Array(i),this._B=new a.Z.Float32Array(i),this._N=new a.Z.Float32Array(i),e.getPrimitiveSetList().forEach((function(t){this.computePrimitiveSet(e,t)}),this);for(var n=i/3,r=new a.Z.Float32Array(4*n),s=o.R3.create(),A=o.R3.create(),g=o.R3.create(),h=0;h<n;h++){var c=this._T.subarray(3*h,3*h+3),l=this._N.subarray(3*h,3*h+3),u=this._B.subarray(3*h,3*h+3);o.R3.normalize(l,l);var d=o.R3.dot(l,c);o.R3.scale(A,l,d),o.R3.sub(s,c,A),o.R3.normalize(g,s),o.R3.cross(s,l,c);var I=o.R3.dot(s,u);I=I<0?-1:0,r[4*h]=g[0],r[4*h+1]=g[1],r[4*h+2]=g[2],r[4*h+3]=I}e.getAttributes().Normal.setElements(this._N),e.getAttributes().Tangent=new W.Z("ARRAY_BUFFER",r,4)}},compute:function(e,t,i,n,r,a,s){var A,g,h=e.index(r),c=e.index(a),l=e.index(s),u=t.getElements().subarray(3*h,3*h+3),d=t.getElements().subarray(3*c,3*c+3),I=t.getElements().subarray(3*l,3*l+3),C=i.getElements().subarray(3*h,3*h+3),f=i.getElements().subarray(3*c,3*c+3),p=i.getElements().subarray(3*l,3*l+3),m=n.getElements().subarray(2*h,2*h+2),_=n.getElements().subarray(2*c,2*c+2),E=n.getElements().subarray(2*l,2*l+2),v=o.R3.create(),S=o.R3.create(),B=o.R3.create(),w=o.R3.create(),y=o.R3.create(),M=o.R3.create(),D=o.R3.create(),b=o.R3.create(),Q=o.R3.create();o.R3.set(b,d[0]-u[0],_[0]-m[0],_[1]-m[1]),o.R3.set(Q,I[0]-u[0],E[0]-m[0],E[1]-m[1]),o.R3.cross(v,b,Q),0!==v[0]&&(o.R3.normalize(v,v),g=-v[1]/v[0],A=-v[2]/v[0],y[0]+=g,S[0]+=A,M[0]+=g,B[0]+=A,D[0]+=g,w[0]+=A),o.R3.set(b,d[1]-u[1],_[0]-m[0],_[1]-m[1]),o.R3.set(Q,I[1]-u[1],E[0]-m[0],E[1]-m[1]),o.R3.cross(v,b,Q),0!==v[0]&&(o.R3.normalize(v,v),g=-v[1]/v[0],A=-v[2]/v[0],y[1]+=g,S[1]+=A,M[1]+=g,B[1]+=A,D[1]+=g,w[1]+=A),o.R3.set(b,d[2]-u[2],_[0]-m[0],_[1]-m[1]),o.R3.set(Q,I[2]-u[2],E[0]-m[0],E[1]-m[1]),o.R3.cross(v,b,Q),0!==v[0]&&(o.R3.normalize(v,v),g=-v[1]/v[0],A=-v[2]/v[0],y[2]+=g,S[2]+=A,M[2]+=g,B[2]+=A,D[2]+=g,w[2]+=A);var x,T,F,R=o.R3.create(),N=o.R3.create();o.R3.cross(R,C,y),o.R3.cross(N,R,C),x=this._T.subarray(3*h,3*h+3),o.R3.add(x,N,x),o.R3.cross(R,S,C),o.R3.cross(N,C,R),T=this._B.subarray(3*h,3*h+3),o.R3.add(T,N,T),o.R3.cross(R,f,M),o.R3.cross(N,R,f),x=this._T.subarray(3*c,3*c+3),o.R3.add(x,N,x),o.R3.cross(R,B,f),o.R3.cross(N,f,R),T=this._B.subarray(3*c,3*c+3),o.R3.add(T,N,T),o.R3.cross(R,p,D),o.R3.cross(N,R,p),x=this._T.subarray(3*l,3*l+3),o.R3.add(x,N,x),o.R3.cross(R,w,p),o.R3.cross(N,p,R),T=this._B.subarray(3*l,3*l+3),o.R3.add(T,N,T),F=this._N.subarray(3*h,3*h+3),o.R3.add(F,C,F),F=this._N.subarray(3*c,3*c+3),o.R3.add(F,f,F),F=this._N.subarray(3*l,3*l+3),o.R3.add(F,p,F)}}),"osgUtil","TangentSpaceGenerator");const nr=ir;var rr=i("6RPJ"),ar={},or=function(e,t,i,n,r){this._viewer=e,this._rttScene=t,this._hmdConfig=i,this._root=n,this._canvas=r,this._width=r.width,this._height=r.height};or.prototype={update:function(){var e=this._canvas,t=e.width,i=e.height;if(t!==this._width||i!==this._height){this._root.removeChildren();var n=this._hmdConfig;n&&n.isCardboard&&(n.hResolution=t,n.vResolution=i),this._width=t,this._height=i,ar.createScene(this._viewer,this._rttScene,n,this._root)}return!0}};var sr=function(e,t){this._rootView=e,this._offsetView=t};sr.prototype={update:function(e){var t=e.getViewMatrix();return o._E.mul(t,this._offsetView,this._rootView),!0}};var Ar=function(e){var t=new Je.Z;return t.setTextureSize(e[0],e[1]),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},gr=function(e,t,i,n,r,a){var s=new nn.Z,A=t[0],g=t[1],h=i[0],c=i[1];!0===n?e?s.setViewport(new an.Z(0,0,h/2,c)):s.setViewport(new an.Z(h/2,0,h/2,c)):e?s.setViewport(new an.Z(.5*h-A,.5*(c-g),A,g)):s.setViewport(new an.Z(.5*h,.5*(c-g),A,g)),o._E.ortho(s.getProjectionMatrix(),-.5,.5,-.5,.5,-5,5),s.setRenderOrder(nn.Z.NESTED_RENDER,0),s.setReferenceFrame(rr.Z.ABSOLUTE_RF);var l,u=s.getOrCreateStateSet();return u.setTextureAttributeAndModes(0,r),u.setAttributeAndModes((l=["uniform vec2 uScale;","uniform vec2 uScaleIn;","uniform vec2 uLensCenter;","uniform vec4 uHmdWarpParam;","uniform vec4 uChromAbParam;","uniform sampler2D Texture0;","varying vec2 vTexCoord0;","void main(void) {","  vec2 uv = (vTexCoord0 * 2.0) - 1.0;","  vec2 theta = (uv - uLensCenter) * uScaleIn;","  float rSq = theta.x * theta.x + theta.y * theta.y;","  vec2 rvector = theta * (uHmdWarpParam.x + uHmdWarpParam.y * rSq + uHmdWarpParam.z * rSq * rSq + uHmdWarpParam.w * rSq * rSq * rSq);","  vec2 rBlue = rvector * (uChromAbParam.z + uChromAbParam.w * rSq);","  vec2 tcBlue = (uLensCenter + uScale * rBlue);","  tcBlue = (tcBlue + 1.0) * 0.5;","  if (any(bvec2(clamp(tcBlue, vec2(0.0, 0.0), vec2(1.0, 1.0)) - tcBlue))) {","    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","    return;","  }","  vec2 tcGreen = uLensCenter + uScale * rvector;","  tcGreen = (tcGreen + 1.0) * 0.5;","  vec2 rRed = rvector * (uChromAbParam.x + uChromAbParam.y * rSq);","  vec2 tcRed = uLensCenter + uScale * rRed;","  tcRed = (tcRed + 1.0) * 0.5;","  gl_FragColor = vec4(texture2D(Texture0, tcRed).r, texture2D(Texture0, tcGreen).g, texture2D(Texture0, tcBlue).b, 1);","}",""].join("\n"),new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new sn.Z(sn.Z.FRAGMENT_SHADER,l)))),u.addUniform(en.Z.createFloat2(a.scale,"uScale")),u.addUniform(en.Z.createFloat2(a.scaleIn,"uScaleIn")),u.addUniform(en.Z.createFloat2(e?a.lensCenterLeft:a.lensCenterRight,"uLensCenter")),u.addUniform(en.Z.createFloat4(a.hmdWarpParam,"uHmdWarpParam")),u.addUniform(en.Z.createFloat4(a.chromAbParam,"uChromAbParam")),s},hr=function(e,t){var i=new nn.Z;return i.setName("rtt camera"),i.setViewport(new an.Z(0,0,e.getWidth(),e.getHeight())),i.setProjectionMatrix(t),i.setClearColor(o.vh.fromValues(.3,.3,.3,0)),i.setRenderOrder(nn.Z.POST_RENDER,0),i.attachTexture(rn.Z.COLOR_ATTACHMENT0,e),i.attachRenderBuffer(rn.Z.DEPTH_ATTACHMENT,rn.Z.DEPTH_COMPONENT16),i.setReferenceFrame(rr.Z.ABSOLUTE_RF),i};ar.createScene=function(e,t,i,n,r){var a=ar.getDefaultConfig(i),s=o.K4.fromValues(.5*a.hResolution,a.vResolution),A=o.K4.fromValues(.5*a.hResolution,a.vResolution),g=e.getCamera().getViewport(),h=o.K4.fromValues(g.width(),g.height()),c=e.getGraphicContext().canvas;a.isCardboard&&(h[0]=c.width,h[1]=c.height);var l={},u={};!function(e,t,i,n){var r=t.hResolution/(2*t.vResolution),a=-1-4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,s=t.distortionK[0]+t.distortionK[1]*Math.pow(a,2)+t.distortionK[2]*Math.pow(a,4)+t.distortionK[3]*Math.pow(a,6),A=180/Math.PI*2*Math.atan2(t.vScreenSize*s,2*t.eyeToScreenDistance),g=o._E.perspective(o._E.create(),Math.PI/180*A,r,.3,1e4),h=4*(.25*t.hScreenSize-.5*t.interpupillaryDistance)/t.hScreenSize,c=4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,l=o._E.create(),u=o._E.create();n.projectionLeft=o._E.mul(l,o._E.fromTranslation(l,o.R3.fromValues(h,0,0)),g),n.projectionRight=o._E.mul(u,o._E.fromTranslation(u,o.R3.fromValues(-h,0,0)),g),n.viewLeft=o._E.fromTranslation(o._E.create(),o.R3.fromValues(e*t.interpupillaryDistance*.5,0,0)),n.viewRight=o._E.fromTranslation(o._E.create(),o.R3.fromValues(-e*t.interpupillaryDistance*.5,0,0)),i.lensCenterLeft=o.K4.fromValues(c,0),i.lensCenterRight=o.K4.fromValues(-c,0),i.hmdWarpParam=t.distortionK,i.chromAbParam=t.chromaAbParameter,i.scaleIn=o.K4.fromValues(1,1/r),i.scale=o.K4.fromValues(1/s,1*r/s)}(void 0!==r?r:1,a,l,u);var d=e.getCamera().getViewMatrix(),I=n||new je.Z;I.addUpdateCallback(new or(e,t,i,I,c));var C=Ar(s),f=hr(C,u.projectionLeft),p=gr(!0,A,h,a.isCardboard,C,l);f.addUpdateCallback(new sr(d,u.viewLeft));var m=Ar(s),_=hr(m,u.projectionRight),E=gr(!1,A,h,a.isCardboard,m,l);return _.addUpdateCallback(new sr(d,u.viewRight)),f.addChild(t),_.addChild(t),p.addChild(Ye.Z.createTexturedFullScreenFakeQuadGeometry()),E.addChild(Ye.Z.createTexturedFullScreenFakeQuadGeometry()),I.addChild(f),I.addChild(_),I.addChild(p),I.addChild(E),I},ar.getDefaultConfig=function(e){var t={hResolution:1920,vResolution:1080,hScreenSize:.1296,vScreenSize:.0729,interpupillaryDistance:.064,lensSeparationDistance:.0635,eyeToScreenDistance:.04,distortionK:o.vh.fromValues(1,.22,.13,.02),chromaAbParameter:o.vh.fromValues(.996,-.004,1.014,0),isCardboard:!1};return 2===e||void 0===e?t:1===e?(t.hResolution=1280,t.vResolution=800,t.hScreenSize=.14976,t.vScreenSize=.0936,t.lensSeparationDistance=.064,t.eyeToScreenDistance=.041,t.distortionK=o.vh.fromValues(1,.22,.24,0),t):(void 0!==e.hResolution&&(t.hResolution=e.hResolution),void 0!==e.vResolution&&(t.vResolution=e.vResolution),void 0!==e.hScreenSize&&(t.hScreenSize=e.hScreenSize),void 0!==e.vScreenSize&&(t.vScreenSize=e.vScreenSize),void 0!==e.interpupillaryDistance&&(t.interpupillaryDistance=e.interpupillaryDistance),void 0!==e.lensSeparationDistance&&(t.lensSeparationDistance=e.lensSeparationDistance),void 0!==e.eyeToScreenDistance&&(t.eyeToScreenDistance=e.eyeToScreenDistance),void 0!==e.distortionK&&(t.distortionK=e.distortionK),void 0!==e.chromaAbParameter&&(t.chromaAbParameter=e.chromaAbParameter),void 0!==e.isCardboard&&(t.isCardboard=e.isCardboard),t)};const cr=ar;var lr=function(e,t){this._rootView=e,this._offsetView=t};lr.prototype={update:function(e){var t=e.getViewMatrix();return o._E.mul(t,this._offsetView,this._rootView),!0}};var ur=function(e){var t=new Je.Z;return t.setTextureSize(e.width,e.height),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},dr=function(e,t,i){var n=new nn.Z;n.setViewport(i),n.setRenderOrder(nn.Z.NESTED_RENDER,0),n.setReferenceFrame(rr.Z.ABSOLUTE_RF),o._E.ortho(n.getProjectionMatrix(),0,1,0,1,-5,5);var r,a=n.getOrCreateStateSet();return a.addUniform(en.Z.createInt(0,"TextureLeft")),a.addUniform(en.Z.createInt(1,"TextureRight")),a.setTextureAttributeAndModes(0,e),a.setTextureAttributeAndModes(1,t),a.setAttributeAndModes((r=["varying vec2 vTexCoord0;","uniform sampler2D TextureLeft;","uniform sampler2D TextureRight;","void main() {","   if (vTexCoord0.x < 0.5)","       gl_FragColor = texture2D(TextureLeft, vec2(vTexCoord0.x * 2.0, vTexCoord0.y));","   else","       gl_FragColor = texture2D(TextureRight, vec2(vTexCoord0.x * 2.0 - 1.0, vTexCoord0.y));","}"].join("\n"),new on.Z(new sn.Z(sn.Z.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new sn.Z(sn.Z.FRAGMENT_SHADER,r)))),n.addChild(Ye.Z.createTexturedFullScreenFakeQuadGeometry()),n},Ir=function(e,t){var i=new nn.Z;return i.setName("rtt camera"),i.setViewport(new an.Z(0,0,e.getWidth(),e.getHeight())),i.setProjectionMatrix(t),i.setClearColor(o.vh.fromValues(.3,.3,.3,0)),i.setRenderOrder(nn.Z.POST_RENDER,0),i.attachTexture(rn.Z.COLOR_ATTACHMENT0,e),i.attachRenderBuffer(rn.Z.DEPTH_ATTACHMENT,rn.Z.DEPTH_COMPONENT16),i.setReferenceFrame(rr.Z.ABSOLUTE_RF),i},Cr={createScene:function(e,t,i,n,r){var a=n||new je.Z;return i.requestAnimationFrame((function(){var n=void 0!==r?r:1,s=i.getEyeParameters("left"),A=i.getEyeParameters("right"),g=new window.VRFrameData;i.getFrameData(g);var h=o._E.fromTranslation(o._E.create(),o.R3.fromValues(-n*s.offset[0],s.offset[1],s.offset[2])),c=o._E.fromTranslation(o._E.create(),o.R3.fromValues(-n*A.offset[0],A.offset[1],A.offset[2])),l={width:Math.max(s.renderWidth,A.renderWidth),height:Math.max(s.renderHeight,A.renderHeight)},u=ur(l),d=ur(l),I=Ir(u,g.leftProjectionMatrix),C=Ir(d,g.rightProjectionMatrix),f=e.getCamera().getViewMatrix();I.addUpdateCallback(new lr(f,h)),C.addUpdateCallback(new lr(f,c));var p=dr(u,d,e.getCamera().getViewport());I.addChild(t),C.addChild(t),a.addChild(I),a.addChild(C),a.addChild(p)})),a}};const fr=Cr;var pr={};pr.ComposerPostProcess=hn,a.Z.objectMix(pr,ln),pr.DelayInterpolator=Gt,pr.DisplayNormalVisitor=fn,pr.DisplayGeometryVisitor=_n,pr.DisplayGraph=Bn.Z,pr.IntersectFunctor=Ct.Z,pr.Intersector=It.Z,pr.IntersectionVisitor=ct.Z,pr.LineSegmentIntersector=lt.Z,pr.LineSegmentIntersectFunctor=wn.Z,pr.NodeGizmo=Jn,pr.GizmoGeometry=Qn,pr.WebVRCustom=cr,pr.PolytopeIntersector=St,pr.PolytopeIntersectFunctor=mt,pr.SphereIntersector=tr,pr.TangentSpaceGenerator=nr,pr.WebVR=fr,pr.NO_LIMIT=ui.Z.NO_LIMIT,pr.LIMIT_ONE_PER_DRAWABLE=ui.Z.LIMIT_ONE_PER_DRAWABLE,pr.LIMIT_ONE=ui.Z.LIMIT_ONE,pr.POINT_PRIMITIVES=ui.Z.POINT_PRIMITIVES,pr.LINE_PRIMITIVES=ui.Z.LINE_PRIMITIVES,pr.TRIANGLE_PRIMITIVES=ui.Z.TRIANGLE_PRIMITIVES,pr.ALL_PRIMITIVES=ui.Z.ALL_PRIMITIVES;const mr=pr;var _r=i("Pxgm"),Er=i("OP54"),vr=i("bYH/"),Sr=i("6qT5"),Br=i("cnke"),wr=i("Qp64"),yr=i("/CZr"),Mr=i("ojCs"),Dr=i("F5Ms"),br=function(){var e=function(e){window.console&&window.console.error?window.console.error(e):function(e){window.console&&window.console.log&&window.console.log(e)}(e)},t={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},i=null,n=null;function r(e){if(null==i)for(var t in i={},n={},e)"number"==typeof e[t]&&(i[e[t]]=t,n[t]=e[t])}function a(){if(null==i)throw"WebGLDebugUtils.init(ctx) not called"}function o(e){a();var t=i[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function s(e,i,r,a){var s;if(void 0!==(s=t[e])&&(void 0!==(s=s[i])&&s[r])){if("object"==typeof s[r]&&void 0!==s[r].enumBitwiseOr){for(var A=s[r].enumBitwiseOr,g=0,h=[],c=0;c<A.length;++c){var l=n[A[c]];0!=(a&l)&&(g|=l,h.push(o(l)))}return g===a?h.join(" | "):o(a)}return o(a)}return null===a?"null":void 0===a?"undefined":a.toString()}function A(e,t,i){e.__defineGetter__(i,(function(){return t[i]})),e.__defineSetter__(i,(function(e){t[i]=e}))}function g(e){var t=!!e.createTransformFeedback;t&&e.bindVertexArray(null);var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);for(var r=0;r<i;++r)e.disableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(r,0),t&&e.vertexAttribDivisor(r,0);e.deleteBuffer(n);var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(r=0;r<a;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null),t&&(e.bindTexture(e.TEXTURE_2D_ARRAY,null),e.bindTexture(e.TEXTURE_3D,null),e.bindSampler(r,null));if(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),t){e.drawBuffers([e.BACK]),e.readBuffer(e.BACK),e.bindBuffer(e.COPY_READ_BUFFER,null),e.bindBuffer(e.COPY_WRITE_BUFFER,null),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),e.bindBuffer(e.PIXEL_UNPACK_BUFFER,null);var o=e.getParameter(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(r=0;r<o;++r)e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,r,null);var s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);for(r=0;r<s;++r)e.bindBufferBase(e.UNIFORM_BUFFER,r,null);e.disable(e.RASTERIZER_DISCARD),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.pixelStorei(e.UNPACK_ROW_LENGTH,0),e.pixelStorei(e.UNPACK_SKIP_ROWS,0),e.pixelStorei(e.UNPACK_SKIP_PIXELS,0),e.pixelStorei(e.PACK_ROW_LENGTH,0),e.pixelStorei(e.PACK_SKIP_ROWS,0),e.pixelStorei(e.PACK_SKIP_PIXELS,0),e.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT,e.DONT_CARE)}for(;e.getError(););}return{init:r,mightBeEnum:function(e){return a(),void 0!==i[e]},glEnumToString:o,glFunctionArgToString:s,glFunctionArgsToString:function(e,t){for(var i="",n=t.length,r=0;r<n;++r)i+=(0==r?"":", ")+s(e,n,r,t[r]);return i},makeDebugContext:function t(i,n,a,g){g=g||i,r(i),n=n||function(t,i,n){for(var r="",a=n.length,A=0;A<a;++A)r+=(0==A?"":", ")+s(i,a,A,n[A]);e("WebGL error "+o(t)+" in "+i+"("+r+")")};var h={};function c(e,t){return function(){a&&a(t,arguments);var i=e[t].apply(e,arguments),r=g.getError();return 0!=r&&(h[r]=!0,n(r,t,arguments)),i}}var l={};for(var u in i)if("function"==typeof i[u])if("getExtension"!=u)l[u]=c(i,u);else{var d=c(i,u);l[u]=function(){var e=d.apply(i,arguments);return e?t(e,n,a,g):null}}else A(l,i,u);return l.getError=function(){for(var e in h)if(h.hasOwnProperty(e)&&h[e])return h[e]=!1,e;return i.NO_ERROR},l},makeLostContextSimulatingCanvas:function(e){var t,i,n=[],r=[],a={},o=1,s=!1,h=[],c=0,l=0,u=!1,d=0,I={};function C(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}e.getContext=function(n){return function(){var r=n.apply(e,arguments);if(r instanceof WebGLRenderingContext||window.WebGL2RenderingContext&&r instanceof WebGL2RenderingContext){if(r!=t){if(t)throw"got different context";i=window.WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,a=v(t=r)}return a}return r}}(e.getContext);var f=function(e){n.push(C(e))},p=function(e){r.push(C(e))};function m(){++l,s||c==l&&e.loseContext()}function _(e,t){var i=e[t];return function(){if(m(),!s){var t=i.apply(e,arguments);return t}}}function E(e){return{statusMessage:e,preventDefault:function(){u=!0}}}return function(e){var t=e.addEventListener;e.addEventListener=function(i,n,r){switch(i){case"webglcontextlost":f(n);break;case"webglcontextrestored":p(n);break;default:t.apply(e,arguments)}}}(e),e.loseContext=function(){if(!s){for(s=!0,c=0,++o;t.getError(););!function(){for(var e=Object.keys(I),t=0;t<e.length;++t)delete I[e[t]]}(),I[t.CONTEXT_LOST_WEBGL]=!0;var i=E("context lost"),r=n.slice();setTimeout((function(){for(var t=0;t<r.length;++t)r[t](i);d>=0&&setTimeout((function(){e.restoreContext()}),d)}),0)}},e.restoreContext=function(){s&&r.length&&setTimeout((function(){if(!u)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var e=0;e<h.length;++e){var n=h[e];n instanceof WebGLBuffer?t.deleteBuffer(n):n instanceof WebGLFramebuffer?t.deleteFramebuffer(n):n instanceof WebGLProgram?t.deleteProgram(n):n instanceof WebGLRenderbuffer?t.deleteRenderbuffer(n):n instanceof WebGLShader?t.deleteShader(n):n instanceof WebGLTexture?t.deleteTexture(n):i&&(n instanceof WebGLQuery?t.deleteQuery(n):n instanceof WebGLSampler?t.deleteSampler(n):n instanceof WebGLSync?t.deleteSync(n):n instanceof WebGLTransformFeedback?t.deleteTransformFeedback(n):n instanceof WebGLVertexArrayObject&&t.deleteVertexArray(n))}}(),g(t),s=!1,l=0,u=!1;for(var e=r.slice(),n=E("context restored"),a=0;a<e.length;++a)e[a](n)}),0)},e.loseContextInNCalls=function(e){if(s)throw"You can not ask a lost contet to be lost";c=l+e},e.getNumCalls=function(){return l},e.setRestoreTimeout=function(e){d=e},e;function v(e){for(var n in e)"function"==typeof e[n]?a[n]=_(e,n):A(a,e,n);a.getError=function(){if(m(),!s)for(;e=t.getError();)I[e]=!0;for(var e in I)if(I[e])return delete I[e],e;return a.NO_ERROR};var r=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];i&&r.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var g=0;g<r.length;++g){var c=r[g];a[c]=function(t){return function(){if(m(),s)return null;var i=t.apply(e,arguments);return i.__webglDebugContextLostId__=o,h.push(i),i}}(e[c])}var l=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];i&&l.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(g=0;g<l.length;++g){c=l[g];a[c]=function(t){return function(){return m(),s?null:t.apply(e,arguments)}}(a[c])}var u=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];i&&u.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(g=0;g<u.length;++g){c=u[g];a[c]=function(t){return function(){return m(),!s&&t.apply(e,arguments)}}(a[c])}return a.checkFramebufferStatus=function(t){return function(){return m(),s?a.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(a.checkFramebufferStatus),a.getAttribLocation=function(t){return function(){return m(),s?-1:t.apply(e,arguments)}}(a.getAttribLocation),a.getVertexAttribOffset=function(t){return function(){return m(),s?0:t.apply(e,arguments)}}(a.getVertexAttribOffset),a.isContextLost=function(){return s},i&&(a.getFragDataLocation=function(t){return function(){return m(),s?-1:t.apply(e,arguments)}}(a.getFragDataLocation),a.clientWaitSync=function(t){return function(){return m(),s?a.WAIT_FAILED:t.apply(e,arguments)}}(a.clientWaitSync),a.getUniformBlockIndex=function(t){return function(){return m(),s?a.INVALID_INDEX:t.apply(e,arguments)}}(a.getUniformBlockIndex)),a}},resetToInitialState:g}}();const Qr=br;var xr=function(){this._values=new Float32Array(xr.maxGraphValue),this._index=0,this._maxValue=0,this._x=0,this._y=0};xr.maxGraphValue=120,xr.prototype={getIndex:function(){return this._index},getValues:function(){return this._values},setDisplayPosition:function(e,t){this._x=e,this._y=t},getX:function(){return this._x},getY:function(){return this._y},addValue:function(e,t){var i=this._index;this._maxValue=e>this._maxValue?e:this._maxValue,this._maxValue*=.99,this._values[i]=e/(1.1*this._maxValue),t&&(this._values[i]+=t),this._index=(this._index+1)%xr.maxGraphValue}};const Tr=xr;var Fr=function(){this._usageHint=W.Z.DYNAMIC_DRAW;this._nbVertexes=0,this._maxNbVertexes=0,this._captionNbVertexes=0,this._valuesNbVertexes=0,this._graphsNbVertexes=0,this.resize(6560)};Fr.backgroundColor=10,Fr.redColor=7,Fr.greyColor=4,Fr.whiteColor=1,a.Z.createPrototypeObject(Fr,{getGeometry:function(){return this._geometry},generateBackground:function(e,t,i,n){var r=this._vertexes;this._nbVertexes+=4,r[0]=e,r[1]=t,r[2]=0,r[3]=Fr.backgroundColor;var a=e+i,o=t+n;r[4]=e,r[5]=o,r[6]=0,r[7]=Fr.backgroundColor,r[8]=a,r[9]=o,r[10]=0,r[11]=Fr.backgroundColor,r[12]=a,r[13]=t,r[14]=0,r[15]=Fr.backgroundColor},generateCharacter:function(e,t,i,n,r,a,o){var s=this._vertexes,A=this._nbVertexes;this._nbVertexes+=4;var g=4*A;s[g++]=e,s[g++]=t,s[g++]=r,s[g++]=-(0+o);var h=e+i,c=t+n;s[g++]=e,s[g++]=c,s[g++]=r,s[g++]=-(1+o),s[g++]=h,s[g++]=c,s[g++]=a,s[g++]=-(1+o),s[g++]=h,s[g++]=t,s[g++]=a,s[g++]=-(0+o)},generateText:function(e,t,i,n,r){var a=i.length;this._nbVertexes+4*a>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);for(var o=n._characterSizeUV,s=n._characterWidth,A=n._characterHeight,g=0;g<a;g++){var h=i.charCodeAt(g),c=n.getCharacterUV(h);this.generateCharacter(e,t,s,A,c,c+o,r),e+=s}return a*s},generateGraph:function(e,t){this._nbVertexes+2*Tr.maxGraphValue>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);var i=this._vertexes,n=this._nbVertexes,r=e.getValues(),a=r.length,o=e.getIndex(),s=e.getX(),A=e.getY();this._nbVertexes+=2*a;for(var g=0;g<a;g++){var h=4*(n+2*g),c=r[(o+g)%a],l=Fr.greyColor;c>=Fr.redColor&&(l=Fr.redColor,c-=Fr.redColor),c>1&&(c=1),(c*=t)<1&&(c=1),i[h]=s+2*g,i[h+1]=A,i[h+2]=0,i[h+3]=l,i[h+4]=s+2*g,i[h+5]=A+c,i[h+6]=0,i[h+7]=l}},resize:function(e){R.Z.log("resize buffer to "+e),this._maxNbVertexes=e;var t=new Float32Array(4*e);this._vertexes&&t.set(this._vertexes),this._vertexes=t;var i=Math.ceil(e/4);this._indexes=new Uint16Array(6*i);for(var n=0,r=0;n<i;n++)this._indexes[r++]=4*n+0,this._indexes[r++]=4*n+1,this._indexes[r++]=4*n+3,this._indexes[r++]=4*n+3,this._indexes[r++]=4*n+1,this._indexes[r++]=4*n+2;if(this._geometry)return this._geometry.getAttributes().Vertex.setElements(this._vertexes),void this._characterPrimitive.getIndices().setElements(this._indexes);this._geometry=new ke.Z,this._geometry.setName("osgStats-Stats"),this._geometry.getAttributes().Vertex=new W.Z(W.Z.ARRAY_BUFFER,this._vertexes,4,!0);var a=new W.Z(W.Z.ELEMENT_ARRAY_BUFFER,this._indexes,1);this._geometry.getAttributes().Vertex.setUsage(this._usageHint);var o=new yn.Z(dn.Z.TRIANGLES,a);this._characterPrimitive=o,this._geometry.getPrimitives().push(this._characterPrimitive);var s=new un.Z(dn.Z.LINES,0,0);this._graphPrimitive=s,this._geometry.getPrimitives().push(this._graphPrimitive)},update:function(){var e=this._captionNbVertexes+this._valuesNbVertexes;this._characterPrimitive.setCount(e/4*6),this._graphPrimitive.setCount(this._graphsNbVertexes),this._graphPrimitive.setFirst(e),this._geometry.getAttributes().Vertex.dirty()},resetCaptions:function(){this._nbVertexes=0,this._captionNbVertexes=0},resetValues:function(){this._nbVertexes=this._captionNbVertexes,this._valuesNbVertexes=0,this._graphsNbVertexes=0},captionsEnd:function(){this._captionNbVertexes=this._nbVertexes},valuesEnd:function(){this._valuesNbVertexes=this._nbVertexes-this._captionNbVertexes},graphsEnd:function(){this._graphsNbVertexes=this._nbVertexes-(this._valuesNbVertexes+this._captionNbVertexes)},getCharacterPrimitive:function(){return this._characterPrimitive},getGraphPrimitive:function(){return this._graphPrimitive},getNbVertexes:function(){return this._nbVertexes}});const Rr=Fr;var Nr=window.performance,Lr=function(e){this._caption=e.caption,this._accumValue=0,this._accumSamples=0,this._accumStart=0,this._value=0,this._averageValue=0,this._time=0,this._avgMs=0,this._over=e.over>0?e.over:0,this._below=e.below>0?e.below:0,this._graph=!!e.graph,e.average&&(this._avgMs=e.avgMs?e.avgMs:1e3),this._display=!1};a.Z.createPrototypeObject(Lr,{isDisplayable:function(){return this._display},setDisplayable:function(e){this._display=e},getOver:function(){return this._over},getBelow:function(){return this._below},getGraph:function(){return this._graph},getAverageMs:function(){return this._avgMs},getAverageValue:function(){return this._averageValue},getValue:function(){return this._value},average:function(e){if(this._avgMs){this._accumValue+=e,this._accumSamples++;var t=Nr.now();t-this._accumStart>this._avgMs&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=t,this._accumSamples=0)}},start:function(){this._display=!0,this._time=Nr.now()},end:function(){this._value=Nr.now()-this._time,this.average(this._value)},set:function(e){this._display=!0,this._value=e,this.average(e)},tick:function(){this.end(),this.start()},frame:function(){var e=Nr.now()-this._time;this.set(1e3/e),this.start()}});const kr=Lr;var Pr=function(){this._canvas=void 0,this._characterHeight=0,this._characterWidth=0,this._fontSize=16,this._fontFamily="Source Code Pro",this._characterFirstCode=" ".charCodeAt(),this._characterLastCode="z".charCodeAt(),this._characterSizeUV=0,this._backgroundColor="rgba(0,0,0,0.0)",this._createCanvas()};a.Z.createPrototypeObject(Pr,{setFontSize:function(e){this._fontSize=e},getCharacterWidth:function(){return this._characterWidth},getCharacterHeight:function(){return this._characterHeight},getCanvas:function(){return this._promise},getCharacterUV:function(e){return(e-this._characterFirstCode)*this._characterSizeUV},_fillCanvas:function(e,t){var i=t+"px",n=function(e){var t=document.getElementsByTagName("body")[0],i=document.createElement("div"),n=document.createTextNode("M");i.appendChild(n),i.setAttribute("style",e),t.appendChild(i);var r=i.offsetHeight;return t.removeChild(i),r}("font-family: "+e+"; font-size: "+i+";");R.Z.debug(e+" "+i+" ==> "+n+" pixels high."),this._characterHeight=Math.ceil(n);var r=t+"px '"+e+"'",a=document.createElement("canvas"),o=a.getContext("2d");this._canvas=a,o.font=r,o.textBaseline="middle",this._characterWidth=o.measureText(" ").width,this._characterWidth=Math.ceil(this._characterWidth);var s=this._characterLastCode-this._characterFirstCode+1;R.Z.info("Stats character size "+this._characterWidth+" x "+this._characterHeight+" texture width "+this._characterWidth*s),a.width=Math.ceil(this._characterWidth*s),a.height=this._characterHeight,this._characterSizeUV=this._characterWidth/a.width,o.font=r,o.textBaseline="middle",o.fillStyle="rgb(255,255,255)";for(var A=this._characterFirstCode,g=0;A<=this._characterLastCode;A++,g++){var h=String.fromCharCode(A),c=g*this._characterWidth,l=this._characterHeight/2;o.fillText(h,c,l)}return a},_createCanvas:function(){var e;this._promise=(e=this._fontFamily,new(Te())((function(t,i){window.WebFontConfig={google:{families:[e+":200"]},active:function(){t(e)},inactive:function(e){i("loadFont error:"+e)}};var n=document.createElement("script"),r=document.scripts[0];n.src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js",n.async=!0,n.onerror=function(){i()},r.parentNode.insertBefore(n,r)}))).then(function(e){return this._fillCanvas(e,this._fontSize)}.bind(this)).catch(function(){return this._fillCanvas("Courier New",this._fontSize)}.bind(this))}});const Ur=Pr;var Or,Gr,Hr,Kr,Zr,Vr=i("k3oU"),Yr=32768,Jr=function(e,t){this._captionsBuffer=void 0,this._valuesBuffer=void 0,this._dirtyCaptions=!0,this._dirtyValues=!0,this._viewer=e,this._labelMaxWidth=0,this._viewport=e.getCamera().getViewport(),this._node=void 0,this._text=void 0,this._offsetGroup=void 0,this._counters={},this._groups={},this._updates=[],this._displayableCounters={},this._x=0,this._y=0,this._width=0,this._height=0,this._maxCaptionTextLength=32,this._lineFactor=1.1,this._displayFilter=[],this._backgroundWidth=0,this._backgroundHeight=0,this._bufferStats=new Rr,this._historyGraph={},this._graphToDisplay=[],this._valuesMaxWidth=72,this._showGraph=!1,this._backgroundPicking=Ye.Z.createTexturedQuadGeometry(0,0,0,10,0,0,0,10,0),this._backgroundPicking.setName("osgStats-Background-picking"),this._dragStop=o.K4.create(),this._dragStart=o.K4.create(),this._startTransformation=o._E.create(),this._init(t)};a.Z.createPrototypeObject(Jr,{getCounter:function(e){return this._counters[e]||(this._counters[e]=new kr({caption:e,average:!0})),this._counters[e]},getBufferStats:function(){return this._bufferStats},addConfig:function(e){if(!e.init||e.init()){for(var t in e.values){var i=e.values[t],n=new kr(i);this._counters[t]=n}if(e.groups)for(var r=0;r<e.groups.length;r++){var a=e.groups[r],o={caption:a.caption,values:a.values,textCursorY:new Float32Array(a.values.length)},s=a.name?a.name:a.caption;this._groups[s]=o}e.update&&this._updates.push(e.update)}},reset:function(){this._bufferStats.resetCaptions(),this._bufferStats.resetValues(),this._dirtyCaptions=!0,this._dirtyValue=!0,this._bufferStats.resize(this._bufferStats._maxNbVertexes)},update:function(){for(var e=0;e<this._updates.length;e++)this._updates[e](this);this._dirtyValues=!0,(this._checkViewportChanged()||this._checkCounterDisplayableChanged())&&(this._dirtyCaptions=!0),this._dirtyCaptions&&(this._bufferStats.resetCaptions(),this._generateCaptions(),this._dirtyCaptions=!1),this._dirtyValues&&(this._bufferStats.resetValues(),this._generateValues(),this._dirtyValues=!1)},getNode:function(){return this._node},setShowFilter:function(e){this._dirtyCaptions=!0,e?this._displayFilter=e.slice():this._displayFilter.length=0},_init:function(e){var t=new nn.Z;t.setRenderOrder(nn.Z.POST_RENDER,0),t.setReferenceFrame(rr.Z.ABSOLUTE_RF),t.setClearMask(0);var i=new Ve.Z;i.setName("StatsNode"),i.addChild(this._backgroundPicking),this._nodeTransform=i,this._backgroundPicking.setNodeMask(0),t.addChild(i),t.setName("osgStats"),t.setViewport(this._viewport),this._node=t,this._text=new Ur;var n=12;if(e){var r=e.getString("statsFilter");if(r){var a=r.split(";");this.setShowFilter(a)}var o=e.getNumber("statsFontSize");void 0!==o&&(n=o),this._showGraph=e.getBoolean("statsShowGraph")}var s,A,g=new Je.Z;g.setMinFilter(Je.Z.NEAREST),g.setMagFilter(Je.Z.NEAREST),this._text.setFontSize(n*this._viewer.getCanvasPixelRatio()),this._text.getCanvas().then(function(e){this._dirtyCaptions=!0;var t=this._bufferStats.getGeometry();t.setNodeMask(-32769),i.addChild(t),g.setImage(e),t.setBound(new Vr.Z)}.bind(this)),i.getOrCreateStateSet().setAttributeAndModes((s=["attribute vec4 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec2 vTexCoord0;","","void main(void) {","  vTexCoord0 = Vertex.zw;","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xy,0.0, 1.0));","}"].join("\n"),A=["#define SHADER_NAME STATS","varying vec2 vTexCoord0;","uniform sampler2D Texture0;","void main(void) {","  vec4 color = vec4(1.0);","  vec2 uv =  vTexCoord0;","  int isText = 0;","  if ( uv.y < 0.0 ) {","     isText = 1;","     uv.y = -uv.y;","  }","  if ( uv.y >= "+(Rr.backgroundColor-1).toFixed(1)+" ) {","     color = vec4(0.0,0.0,0.0,0.5);","     uv.y -= "+Rr.backgroundColor.toFixed(1)+";","  } else if ( uv.y >= "+(Rr.redColor-1).toFixed(1)+" ) {","     color = vec4(1.0,0.0,0.0,1.0);","     uv.y -= "+Rr.redColor.toFixed(1)+";","  } else if ( uv.y == "+(Rr.greyColor-1).toFixed(1)+" ) {","     color = vec4(0.5,0.5,0.5,1.0);","     uv.y -= "+Rr.greyColor.toFixed(1)+";","  } else {","     uv.y -= "+Rr.whiteColor.toFixed(1)+";","  }","  if ( isText == 1 ) {","     color *= texture2D( Texture0, uv.xy);","  }","  gl_FragColor = color;","}"].join("\n"),new on.Z(new sn.Z("VERTEX_SHADER",s),new sn.Z("FRAGMENT_SHADER",A)))),i.getOrCreateStateSet().setAttributeAndModes(new Xi.Z(Xi.Z.DISABLE));var h=new ze.Z("SRC_ALPHA","ONE_MINUS_SRC_ALPHA");i.getOrCreateStateSet().setAttributeAndModes(h),i.getOrCreateStateSet().setAttributeAndModes(new $i.Z($i.Z.DISABLE)),i.getOrCreateStateSet().setTextureAttributeAndModes(0,g);var c=this._viewer.getGraphicContext().canvas;this._canvas=c;var l=this._viewer.getInputManager();l.group(xt.Z.STATS).addMappings({onMouseMove:["mousemove","touchmove"],onMouseDown:["mousedown","touchstart"],onMouseUp:["mouseup","mouseout","touchend","touchcancel"]},this),l.setPriority(xt.Z.STATS,l.getHigherPriority(xt.Z.SCENE))},onMouseDown:function(e){var t=this.computeNearestIntersection(e);this._onStats=!!t.length,this._onStats&&(this._viewer.getInputManager().setEnable(xt.Z.SCENE,!1),o._E.copy(this._startTransformation,this._nodeTransform.getMatrix()),o.K4.set(this._dragStart,e.canvasX,e.canvasY),this._dragStop[1]=this._dragStart[1])},onMouseMove:(Zr=o.R3.create(),function(e){if(this._onStats){o.K4.set(this._dragStop,e.canvasX,e.canvasY);var t=this._dragStop[1]-this._dragStart[1];o._E.translate(this._nodeTransform.getMatrix(),this._startTransformation,o.R3.set(Zr,0,-t,0))}}),onMouseUp:function(){this._viewer.getInputManager().setEnable(xt.Z.SCENE,!0),this._onStats=!1},computeNearestIntersection:(Or=new lt.Z,Gr=o.R3.create(),Hr=o.R3.create(),Kr=new ct.Z,Kr.setIntersector(Or),function(e){var t=e.glX,i=e.glY;Or.reset(),Or.set(o.R3.set(Gr,t,i,0),o.R3.set(Hr,t,i,1)),Kr.reset(),this._backgroundPicking.setNodeMask(Yr),Kr.setTraversalMask(Yr),this._node.accept(Kr);var n=Or.getIntersections();return this._backgroundPicking.setNodeMask(0),n}),_updateBackgroundPicking:function(e,t,i,n){var r=this._backgroundPicking.getVertexAttributeList().Vertex.getElements();r[0]=e,r[1]=t+n,r[3]=e,r[4]=t,r[6]=e+i,r[7]=t,r[9]=e+i,r[10]=t+n,this._backgroundPicking.getVertexAttributeList().Vertex.dirty(),this._backgroundPicking.dirtyBound()},_generateCaptions:function(){var e=this._text.getCharacterHeight(),t=0,i=this._viewport.height()-e;this._labelMaxWidth=0,this._bufferStats.generateBackground(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight),this._updateBackgroundPicking(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight);var n=this._displayFilter;for(var r in this._groups)if(!r||!n.length||-1!==n.indexOf(r)){var a=this._groups[r],o="--- "+a.caption+" ---",s=this._bufferStats.generateText(t,i,o,this._text,Rr.whiteColor);this._labelMaxWidth=Math.max(s,this._labelMaxWidth),t=0,i-=this._lineFactor*e;for(var A=0;A<a.values.length;A++){var g=a.values[A],h=this._counters[g];if(h&&h.isDisplayable()){a.textCursorY[A]=i;for(var c=h._caption,l=c.length/this._maxCaptionTextLength,u=0;u<l;u++){var d=u*this._maxCaptionTextLength,I=c.substr(d,this._maxCaptionTextLength);s=this._bufferStats.generateText(t,i,I,this._text,Rr.whiteColor),this._labelMaxWidth=Math.max(s,this._labelMaxWidth),i-=e,t=0}}}i-=e}this._bufferStats.captionsEnd()},_generateValues:function(){var e,t=this._text.getCharacterWidth(),i=this._labelMaxWidth+2*t,n=this._valuesMaxWidth+2*t,r=this._text.getCharacterHeight(),a=i,o=this._displayFilter,s=0;for(var A in this._groups)if(!A||!o.length||-1!==o.indexOf(A)){var g=this._groups[A];a=i;for(var h=0;h<g.values.length;h++){var c=g.values[h],l=this._counters[c];if(l&&l.isDisplayable()){var u,d=l.getAverageMs()?l.getAverageValue():l.getValue();u=Number.isInteger(d)?d.toString():d.toFixed(2),e=g.textCursorY[h];var I=Rr.whiteColor,C=l.getOver(),f=l.getBelow();0!==C?I=d>C?Rr.redColor:I:0!==f&&(I=d<f?Rr.redColor:I);var p=this._bufferStats.generateText(a,e,u,this._text,I);s=Math.max(p,s),this._showGraph&&l._graph&&(this._historyGraph[c]||(this._historyGraph[c]=new Tr),this._graphToDisplay.push(this._historyGraph[c]),this._historyGraph[c].setDisplayPosition(i+n,e),this._historyGraph[c].addValue(d,I)),a=i}}}this._bufferStats.valuesEnd(),this._valuesMaxWidth=s;for(var m=0;m<this._graphToDisplay.length;m++){var _=this._graphToDisplay[m];this._bufferStats.generateGraph(_,r-2)}var E=i+n;this._graphToDisplay.length&&(E+=2*Tr.maxGraphValue+1);var v=this._viewport.height()-e;this._backgroundWidth===E&&this._backgroundHeight===v||(this._backgroundWidth=E,this._backgroundHeight=v,this._dirtyCaptions=!0),this._graphToDisplay.length=0,this._bufferStats.graphsEnd(),this._bufferStats.update()},_checkCounterDisplayableChanged:function(){var e=!1;for(var t in this._counters){var i=this._counters[t];this._displayableCounters[t]!==i.isDisplayable()&&(this._displayableCounters[t]=i.isDisplayable(),e=!0)}return e},_checkViewportChanged:function(){var e=this._viewport.x(),t=this._viewport.y(),i=this._viewport.width(),n=this._viewport.height();if(e!==this._x||t!==this._y||i!==this._width||n!==this._height){this._x=e,this._y=t,this._width=i,this._height=n;var r=this._node;return o._E.ortho(r.getProjectionMatrix(),this._x,this._width,this._y,this._height,-5,5),!0}return!1}});const zr=Jr;const jr={values:{frame:{caption:"Total frame time",over:16,average:!0,graph:!0,max:4},stats:{caption:"stats",over:1,graph:!0},fps:{caption:"Framerate (FPS)",below:30,average:!0},raf:{caption:"Time since last rAF",average:!0,avgMs:500},update:{caption:"update",average:!0,graph:!0},cull:{caption:"cull",average:!0,graph:!0,max:16},render:{caption:"render",average:!0,graph:!0},readPixels:{caption:"readPixels",average:!0,graph:!0},glframe:{caption:"glframe",average:!0,graph:!0},textureused:{caption:"texture used"},texturereserved:{caption:"texture reserved"},texturetotal:{caption:"texture total"},pushstateset:{caption:"num pushStateSet"},applyStateSet:{caption:"num applyStateSet"},updatecallback:{caption:"num updateCallback"},cullcamera:{caption:"camera"},cullmatrixtransform:{caption:"matrixTransform"},cullprojection:{caption:"projection"},cullnode:{caption:"node"},culllightsource:{caption:"lightSource"},cullgeometry:{caption:"geometry"}},groups:[{name:"framerate",caption:"Framerate",values:["fps","raf"]},{name:"frameBudget",caption:"Frame Budget",base:"frame",values:["frame","update","cull","render","glframe","stats"]},{name:"sceneGraph",caption:"Scene Graph ",values:["pushstateset","updatecallback","applyStateSet"]},{name:"cullVisitor",caption:"Cull",values:["cullnode","cullmatrixtransform","cullcamera","culllighsource","cullprojection","cullgeometry"]},{name:"texture",caption:"Texture Memory",values:["texturereserved","textureused","texturetotal"]},{name:"readback",caption:"gpu read back",values:["readpixels"]}]};var Wr=[window.WebGLRenderingContext,window.WebGL2RenderingContext],qr=function(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}},Xr=0,$r=0,ea=0,ta=0,ia=0,na=0,ra=0,aa=0,oa=0,sa=0;const Aa={values:{glDrawCalls:{caption:"drawCalls"},glDrawElements:{caption:"drawElements"},glDrawArrays:{caption:"drawArrays"},glBindTexture:{caption:"bindTexture"},glUseProgram:{caption:"useProgram"},glFaces:{caption:"totalFaces"},glVertices:{caption:"totalVertices"},glPoints:{caption:"totalPoints"},statsFaces:{caption:"statsFaces"},statsVertices:{caption:"statsVertices"},statsLines:{caption:"statsLines"}},groups:[{name:"webgl",caption:"WebGL",values:["glDrawCalls","glDrawElements","glDrawArrays","glUseProgram","glBindTexture","glFaces","glVertices","glPoints","statsVertices","statsFaces","statsLines"]}],update:function(e){var t=e.getBufferStats(),i=t.getNbVertexes(),n=t.getCharacterPrimitive(),r=t.getGraphPrimitive();$r-=1,r.getCount()&&(Xr-=1),ra-=2,ea-=1,ia-=n.getCount()+r.getCount(),ta-=n.getCount()/3,aa=i,oa=n.getCount()/3,sa=r.getCount()/2,e.getCounter("glDrawCalls").set($r+Xr),e.getCounter("glDrawElements").set($r),e.getCounter("glDrawArrays").set(Xr),e.getCounter("glBindTexture").set(ra),e.getCounter("glUseProgram").set(ea),e.getCounter("glFaces").set(ta),e.getCounter("glVertices").set(ia),e.getCounter("glPoints").set(na),e.getCounter("statsVertices").set(aa),e.getCounter("statsFaces").set(oa),e.getCounter("statsLines").set(sa),aa=0,oa=0,sa=0,Xr=0,$r=0,ea=0,ta=0,ia=0,na=0,ra=0}.bind(void 0),init:function(){for(var e=!1,t=0;t<Wr.length;t++){var i=Wr[t];i&&(e=!0,i.prototype.drawArrays=qr(i.prototype.drawArrays,(function(){Xr++,arguments[0]===this.POINTS?na+=arguments[2]:ia+=arguments[2]})),i.prototype.drawElements=qr(i.prototype.drawElements,(function(){$r++,ta+=arguments[1]/3,ia+=arguments[1]})),i.prototype.useProgram=qr(i.prototype.useProgram,(function(){ea++})),i.prototype.bindTexture=qr(i.prototype.bindTexture,(function(){ra++})))}return e}};var ga=void 0,ha=Math.log(1024),ca=function(e){var t=Math.floor(Math.log(e)/ha);return 0===e&&(t=1),Math.round(100*e/Math.pow(1024,t))/100};const la={values:{browserMemory:{caption:"Used Memory",average:!0,avgMs:1e3},browserMemoryTotal:{caption:"Total Memory"}},groups:[{name:"browser",caption:"Browser",values:["browserMemory","browserMemoryTotal"]}],update:function(e){var t=0,i=0;ga&&(t=ca(ga.usedJSHeapSize),i=ca(ga.totalJSHeapSize)),e.getCounter("browserMemory").set(t),e.getCounter("browserMemoryTotal").set(i)},init:function(){return window.performance&&window.performance.memory&&(ga=window.performance.memory),ga&&0!==ga.totalJSHeapSize||R.Z.warn("Stats will not report memory, not supported by your browse"),!!ga}};var ua=["shift","alt","ctrl","meta"],da=function(e,t){this._enabled=!0,this._name=t,this._mask=[],this._events={},this._mappings={},this._inputManager=e,this._boundCallback=this._collectNativeEvents.bind(this),this._priority=10,this._hasSources=!1};da.prototype={addMappings:function(e,t){for(var i in e)e[this._name+":"+i]=e[i],delete e[i];this._inputManager.addMappings(e,t)},_collectNativeEvents:function(e){if(this._enabled&&!this._mask.length){var t=this._mappings[e.type];if(t)for(var i=0;i<t.length;i++){var n=t[i];if(!n._source.isEventRegistered||n._source.isEventRegistered(e,n._parsedEvent)){if(n._source.populateEvent(e,n),n._nativeEvents||(n._nativeEvents=[]),!n._nativeEvents.length){var r=this._inputManager._queues[n._priority];r||(r=[],this._inputManager._queues[n._priority]=r),r.push(n)}n._nativeEvents.push(e)}}}},_addEvent:function(e,t){var i,n=this._name+":"+t,r=!1,a=this._mappings[e.name];a?i=this._findEvent(a,n,e.raw):(a=[],this._mappings[e.name]=a,r=!0);var o=this._events[t];o||(o=[],this._events[t]=o),i||(i=new Event(n),a.push(i),o.push(i)),i._parsedEvent=e,i._priority=10;var s=this._inputManager._getSource(e.name);s&&(this._enabled&&r&&s.setEnable(e.name,this._boundCallback,!0),this._hasSources=!0,i._source=s)},_findEvent:function(e,t,i){for(var n=0;n<e.length;n++){var r=e[n];if(r.type===t&&r._parsedEvent.raw===i)return r}},_setEnable:function(e){for(var t in this._enabled=e,this._mappings){var i=this._mappings[t][0];i._source&&i._source.setEnable(t,this._boundCallback,e)}}};var Ia=function(){this._groups={},this._sources=[],this._queues=[],this._queues[10]=[],this._callbacks={},this._params={},this._maskedGroups=[],window.dumpInputGroups=this._dumpInputGroups.bind(this),window.dumpEventSequence=this._dumpEventSequence.bind(this)};Ia.prototype={registerInputSource:function(e){if(!e.setEnable||!e.supportsEvent||!e.getName)throw"Invalid input target "+JSON.stringify(e);this._sources.push(e),e.setInputManager(this)},getInputSource:function(e){for(var t=0;t<this._sources.length;t++){var i=this._sources[t];if(i.getName()===e)return i}},addMappings:function(e,t){for(var i in e){var n=e[i],r=i.split(":");if(2!==r.length)throw"Mapping should be of the form 'group:methodName': ['nativeevent1’, 'nativeevent2',...] ";var a,o,s=this._getOrCreateGroup(r[0]),A=r[1];if(t)if("object"==typeof t){if(!(a=t[A])||"function"!=typeof a)throw"Cannot find method "+A+" on "+t;a=a.bind(t)}else{if("function"!=typeof t)throw"Invalid listener "+t;a=t}if("string"==typeof n)o=this._parseNativeEvent(n),s._addEvent(o,A);else for(var g=0;g<n.length;g++){var h=n[g];o=this._parseNativeEvent(h),s._addEvent(o,A)}this._callbacks[s._name+":"+A]=a}},group:function(e){return this._getOrCreateGroup(e)},setEnable:function(e,t){var i,n=this._groups[e];for(var r in n&&n._setEnable(t),this._groups)if(n=this._groups[r],t){if((i=n._mask.indexOf(e))>=0){for(;i>=0;)n._mask.splice(i,1),i=n._mask.indexOf(e);for(i=this._maskedGroups.indexOf(e);i>=0;)this._maskedGroups.splice(i,1),i=this._maskedGroups.indexOf(e)}}else 0===(i=n._name.indexOf(e))&&"."===n._name[i+e.length]&&(n._mask.push(e),this._maskedGroups.push(e));if(!t)for(var a=0;a<this._queues.length;a++){var o=this._queues[a];if(o)for(var s=o.length-1;s>=0;s--){var A=o[s];A.type.indexOf(e)>=0&&(o.splice(s,1),A._nativeEvents.length=0)}}},setPriority:function(e,t){var i=e.split(":");if(t<0)throw"priority must be a positive number";var n,r,a=this._groups[i[0]];if(a&&i[1]){for(n=a._events[i[1]],r=0;r<n.length;r++)n[r]._priority=t;a._priority>t&&(a._priority=t)}else for(var o in this._groups)if((a=this._groups[o])._name.indexOf(e)>=0)for(var s in a._events)for(n=a._events[s],r=0;r<n.length;r++)n[r]._priority=t},getHigherPriority:function(e){var t=10;for(var i in this._groups){var n=this._groups[i];n._name.indexOf(e)>=0&&n._priority<t&&(t=n._priority)}return t>0?t-1:0},getParam:function(e){return this._params[e]},setParam:function(e,t){this._params[e]=t},cleanup:function(){for(var e in this._groups){this._groups[e]._setEnable(!1)}},_parseNativeEvent:function(e){var t,i=e.split(" "),n={};for(n.name=i[0],t=1;t<i.length;t++){var r=i[t],a=!0;0===r.indexOf("!")&&(a=!1,r=r.substring(1,r.length)),ua.indexOf(r)>=0?n[r]=a:n.action=r.toLowerCase()}if(n.action)for(t=0;t<ua.length;t++){var o=ua[t];0===n.action.indexOf(o)&&(n[o]=!0)}return 0===n.name.indexOf("key")&&!n.action&&i.length>1&&(n.action=i[i.length-1]),n.raw=e,n},_getOrCreateGroup:function(e){var t=this._groups[e];if(!t){t=new da(this,e),this._groups[e]=t;for(var i=0;i<this._maskedGroups.length;i++){var n=this._maskedGroups[i];0===e.indexOf(n)&&t._mask.push(n)}}return t},update:function(e){var t;for(t=0;t<this._sources.length;t++){var i=this._sources[t];i.poll&&i.poll(e)}for(t=0;t<this._queues.length;t++){var n=this._queues[t];if(n){for(var r=0;r<n.length;r++){var a=n[r];this._callbacks[a.type](a),a._nativeEvents.length=0}n.length=0}}},_getSource:function(e){for(var t=0;t<this._sources.length;t++){var i=this._sources[t];if(i.supportsEvent(e))return i}},_dumpInputGroups:function(e,t){for(var i in!0===e&&(t=e,e=void 0),this._groups)if(!(e&&i.indexOf(e)<0)){var n=this._groups[i],r=n._enabled&&!n._mask.length&&n._hasSources;if(!t||r){for(var a in R.Z.groupCollapsed("%c"+i+(r?" (enabled)":" (disabled)"),r?"":"color: #888888"),R.Z.log("enabled:",n._enabled),R.Z.log("masks:",n._mask),R.Z.log("input sources:",n._hasSources),R.Z.group("events"),n._events){R.Z.groupCollapsed(a);for(var o=n._events[a],s=0;s<o.length;s++){var A=o[s],g="%c"+A._parsedEvent.raw+" ("+(A._source?A._source.getName():"unknown source")+")",h=A._source?"":"color: #888888";R.Z.log(g,h)}R.Z.groupCollapsed("function"),R.Z.log(this._callbacks[n._name+":"+a]),R.Z.groupEnd(),R.Z.groupEnd()}R.Z.groupEnd(),R.Z.groupEnd()}}},_dumpEventSequence:function(e,t){var i,n=[];for(var r in!0===e&&(t=e,e=void 0),this._groups){var a=this._groups[r];if(i=a._enabled&&!a._mask.length&&a._hasSources,!t||i)for(var o in a._events){var s=a._events[o],A=n[s[0]._priority];A||(A=[],n[s[0]._priority]=A);for(var g=0;g<s.length;g++){var h=s[g];(!e||e&&h._parsedEvent.raw.indexOf(e)>=0)&&A.push({name:h.type,group:a._name,on:h._parsedEvent.raw,enabled:a._enabled&&!a._mask.length&&!!h._source,source:h._source?"("+h._source.getName()+")":"(unknown source)"})}}}for(var c=0;c<n.length;c++){var l=n[c];if(l){var u;R.Z.group("priority "+c);for(var d=0;d<l.length;d++){var I=l[d];if(0!==d&&u!==I.name&&R.Z.groupEnd(),u!==I.name){var C=this._groups[I.group];i=C._enabled&&!C._mask.length&&C._hasSources,R.Z.groupCollapsed("%c"+I.name,i?"":"color:#888888")}u=I.name,R.Z.groupCollapsed("%c"+I.on+" "+I.source,I.enabled?"":"color:#888888"),R.Z.log(this._callbacks[I.name]),R.Z.groupEnd()}R.Z.groupEnd(),R.Z.groupEnd()}}}};const Ca=Ia;var fa=function(e){this._target=e,this._supportedEvents=[]};fa.prototype={supportsEvent:function(e){for(var t=0;t<this._supportedEvents.length;t++){var i=this._supportedEvents[t];if(0===e.indexOf(i))return!0}return!1},setInputManager:function(e){this._inputManager=e}};const pa=fa;var ma=0===navigator.platform.indexOf("Mac")?-1:-3,_a=function(e,t){pa.call(this,e),this._defaultRatio=o.K4.fromValues(1,1),this._supportedEvents=["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup"],t&&!1===t.scrollwheel||this._supportedEvents.push("wheel")};a.Z.createPrototypeObject(_a,a.Z.objectInherit(pa.prototype,{getName:function(){return"Mouse"},setEnable:function(e,t,i){i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.canvasX=void 0===e.offsetX?e.layerX:e.offsetX,t.canvasY=void 0===e.offsetY?e.layerY:e.offsetY;var i=this._inputManager.getParam("pixelRatio");i||(i=this._defaultRatio),t.glX=t.canvasX*i[0],t.glY=(this._target.clientHeight-t.canvasY)*i[1],t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenX=e.screenX,t.pageX=e.pageX,t.pageY=e.pageY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.button=e.button,t.buttons=e.buttons,"wheel"===e.type&&(void 0!==e.wheelDelta?t.deltaY=e.wheelDelta/120:1===e.deltaMode?t.deltaY=e.deltaY/ma:t.deltaY=e.deltaY/(10*ma),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaZ=e.deltaZ)},isEventRegistered:function(e,t){return(!t.action||e.button===parseInt(t.action))&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&((void 0===t.meta||e.metaKey===t.meta)&&(e.preventDefault(),!0)))))}}),"osgViewer","InputSourceMouse");const Ea=_a;var va=function(e){pa.call(this,e),this._supportedEvents=["keydown","keyup","keypress"]};a.Z.createPrototypeObject(va,a.Z.objectInherit(pa.prototype,{getName:function(){return"Keyboard"},setEnable:function(e,t,i){i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.key=e.key,t.keyCode=e.keyCode,t.code=e.code,t.location=e.location,t.repeat=e.repeat,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey},isEventRegistered:function(e,t){return!t.action||(e.key?e.key.toLowerCase()===t.action&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&((void 0===t.meta||e.metaKey===t.meta)&&(e.preventDefault(),!0))))):void 0)}}),"osgViewer","InputSourceKeyboard");const Sa=va;var Ba=i("R2Pi"),wa=function(e,t){pa.call(this),this._supportedEvents=["vrsupported","vrpolyfilled","vrdisplayposechanged","vrdisplayconnected","vrdisplaynotfound","vrdisplaydisconnected"],this._callbacks={},this._events={};for(var i=0;i<this._supportedEvents.length;i++){var n=this._supportedEvents[i],r=new Event(n);this._events[n]=r}this._nbCallbacks=0,this._pollInterval=t&&void 0!==t.pollInterval?t.pollInterval:3e3};a.Z.createPrototypeObject(wa,a.Z.objectInherit(pa.prototype,{getName:function(){return"WebVR"},setEnable:function(e,t,i){var n=this._callbacks[e];n||(n=[],this._callbacks[e]=n);var r=n.indexOf(t);i?r<0&&(n.push(t),this._nbCallbacks++,this._schedulePolling()):r>=0&&(n.splice(r,1),this._nbCallbacks--,this._nbCallbacks||this._cancelPolling())},populateEvent:function(e,t){t.pose=e.pose,t.worldFactor=this._inputManager.getParam("worldFactor"),t.worldFactor||(t.worldFactor=1)},_schedulePolling:function(){this._pollInterval>0&&void 0===this._pollingTimeout&&(this._pollingTimeout=setInterval(this.pollHeadset.bind(this),this._pollInterval))},_cancelPolling:function(){void 0!==this._pollingTimeout&&clearInterval(this._pollingTimeout)},pollHeadset:function(){if(!navigator.xr||!navigator.xr.isSessionSupported){if(navigator.getVRDisplays||Ba.default.any){if(this._vrPolyfillLoaded)return Te().reject("VR not supported");var e=this._events.vrsupported;this._dispatchEvent(e,this._callbacks.vrsupported);var t=this._events.vrpolyfilled;this._dispatchEvent(t,this._callbacks.vrpolyfilled)}return Te().resolve()}var i=this._events.vrsupported;this._dispatchEvent(i,this._callbacks.vrsupported);var n=this;return navigator.xr.isSessionSupported("immersive-vr").then(function(e){if(!e){if(this._vrReady){var t=n._events.vrdisplaydisconnected;this._dispatchEvent(t,n._callbacks.vrdisplaydisconnected)}return this._vrReady=!1,this.triggerNotFoundEvent(),Te().reject("Immersive-vr session not supported")}if(!n._vrReady)return R.Z.log("Found a VR display"),n._vrReady=!0,i=n._events.vrdisplayconnected,this._dispatchEvent(i,n._callbacks.vrdisplayconnected),Te().resolve()}.bind(this)).catch(function(e){return this._vrReady=!1,this.triggerNotFoundEvent(),R.Z.warn(e),Te().reject(e)}.bind(this))},triggerNotFoundEvent:function(){if(!(this._pollInterval>0)){var e=this._events.vrdisplaynotfound;this._dispatchEvent(e,this._callbacks.vrdisplaynotfound)}},setPollInterval:function(e){this._pollInterval=e},_dispatchEvent:function(e,t){if(t)for(var i=0;i<t.length;i++){(0,t[i])(e)}},poll:function(e){if(this._vrReady&&e.frame){var t=this._callbacks.vrdisplayposechanged;if(t&&t.length){var i=e.frame.getViewerPose(e.xrReferenceSpace);if(i){var n=this._events.vrdisplayposechanged;n.pose=i,this._dispatchEvent(n,t)}}}}}),"osgViewer","InputSourceVR");const ya=wa;var Ma=function(){pa.call(this),this._target=window,this._supportedEvents=["buttondown","buttonup","buttonvalue","axis","gamepadconnected","gamepaddisconnected"],this._callbacks={},this._nbCallbacks=0,this._gamePadState=[],this._valueThreshold=.05,window.addEventListener("gamepadconnected",function(e){this._newGamePad(e.gamepad),this._onConnectionStateChange(e,"gamepadconnected")}.bind(this)),window.addEventListener("gamepaddisconnected",function(e){this._previousState[e.gamepad.index]=void 0,this._onConnectionStateChange(e,"gamepaddisconnected")}.bind(this))};a.Z.createPrototypeObject(Ma,a.Z.objectInherit(pa.prototype,{getName:function(){return"GamePad"},setEnable:function(e,t,i){var n=this._callbacks[e];n||(n=[],this._callbacks[e]=n);var r=n.indexOf(t);i?r<0&&(n.push(t),this._nbCallbacks++):r>=0&&(n.splice(r,1),this._nbCallbacks--)},_onConnectionStateChange:function(e,t){var i=this._callbacks[t];i&&i(e)},_newGamePad:function(e){var t,i={buttons:[]};for(i._buttonEvents=[],i._axisEvents=[],t=0;t<e.buttons.length;t++)i._buttonEvents[t]={buttondown:this._initEvent("buttondown",t,e.index,"button"),buttonup:this._initEvent("buttonup",t,e.index,"button"),buttonvalue:this._initEvent("buttonvalue",t,e.index,"button")};for(t=0;t<e.axes.length;t++)i._axisEvents[t]={axis:this._initEvent("axis",t,e.index,"axis")};this._gamePadState[e.index]=i},setValueThreshold:function(e){this._valueThreshold=e},_initEvent:function(e,t,i,n){var r=new Event(e);return r[n]=t,r.gamepadIndex=i,r},populateEvent:function(e,t){t.gamepadIndex=e.gamepadIndex,void 0!==e.button&&(t.button=e.button,t.value=e.value),void 0!==e.axis&&(t.axis=e.axis,t.value=e.value)},isEventRegistered:function(e,t){if(!t.action)return!0;var i=parseInt(t.action);return(void 0===e.button||e.button===i)&&(void 0===e.axis||e.axis===i)},_fireCallbacks:function(e,t){for(var i=0;i<e.length;i++)e[i](t)},poll:function(){if(this._nbCallbacks){var e=navigator.getGamepads();if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._gamePadState[t];if(n){var r=this._callbacks.buttondown,a=this._callbacks.buttonup,o=this._callbacks.buttonvalue;if(r||a||o)for(var s=0;s<i.buttons.length;s++){var A=i.buttons[s],g=n._buttonEvents[s].buttondown;g.value=A.value;var h=n._buttonEvents[s].buttonup;if(h.value=A.value,A.pressed&&!n.buttons[s]&&(r&&r.length&&this._fireCallbacks(r,g),n.buttons[s]=A.pressed),!A.pressed&&n.buttons[s]&&(a&&a.length&&this._fireCallbacks(a,h),n.buttons[s]=!1),A.pressed&&o&&o.length){var c=n._buttonEvents[s].buttonvalue;c.value=A.value,Math.abs(A.value)>=this._valueThreshold&&this._fireCallbacks(o,c)}}var l=this._callbacks.axis;if(l)for(s=0;s<i.axes.length;s++){var u=i.axes[s],d=n._axisEvents[s].axis;d.value=u,Math.abs(u)>=this._valueThreshold&&this._fireCallbacks(l,d)}}}}}}}),"osgViewer","InputSourceGamePad");const Da=Ma;var ba=function(){pa.call(this),this._target=window,this._callbacks=[],this._nbCallbacks=0,this._event=new Event("deviceorientation"),this._supportedEvents=["deviceorientation","orientationchange"],this._update=this.onDeviceOrientation.bind(this)};a.Z.createPrototypeObject(ba,a.Z.objectInherit(pa.prototype,{getName:function(){return"DeviceOrientation"},setEnable:function(e,t,i){if("orientationchange"!==e){var n=this._callbacks,r=n.indexOf(t);i?r<0&&(n.push(t),this._nbCallbacks++):r>=0&&(n.splice(r,1),this._nbCallbacks--),1===this._nbCallbacks&&window.addEventListener(e,this._update),0===this._nbCallbacks&&window.removeEventListener(e,this._update)}else i?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},onDeviceOrientation:function(e){this.populateEvent(e,this._event)},populateEvent:function(e,t){t.absolute=e.absolute,t.alpha=e.alpha,t.beta=e.beta,t.gamma=e.gamma,t.screenOrientation=window.orientation},isEventRegistered:function(e){if("deviceorientation"===e.type){if(null===e.alpha||void 0===e.alpha)return!1}else if(null===window.orientation||void 0===window.orientation)return!1;return!0},poll:function(){if(this._nbCallbacks)for(var e=0;e<this._callbacks.length;e++)this._callbacks[e](this._event)}}),"osgViewer","InputSourceDeviceOrientation");const Qa=ba;var xa=function(e){pa.call(this,e),this._defaultRatio=o.K4.fromValues(1,1),this._hammerEvents=["pan","pinch","press","rotate","swipe","doubletap","doubletap2fingers","singletap"],this._supportedEvents=["touchstart","touchend","touchcancel","touchmove"],this._hammer=new(st().Manager)(e),this._hammer.add(new(st().Pan)),this._hammer.add(new(st().Pinch)),this._hammer.get("pan").set({threshold:0,pointers:0});var t=this._hammer.get("pinch");t.set({threshold:.1,enable:!1}),t.recognizeWith(this._hammer.get("pan")),this._hammer.add(new(st().Tap)({event:"doubletap",pointers:1,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new(st().Tap)({event:"doubletap2fingers",pointers:2,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new(st().Tap)({event:"singletap",pointers:1,taps:1,time:250,interval:450,threshold:5,posThreshold:20}))};a.Z.createPrototypeObject(xa,a.Z.objectInherit(pa.prototype,{getName:function(){return"TouchScreen"},setEnable:function(e,t,i){this._isNativeEvent(e)?i?this._target.addEventListener(e,t,{passive:!0}):this._target.removeEventListener(e,t,{passive:!0}):(e.indexOf("pinch")>=0&&i&&this._hammer.get("pinch").set({enable:!0}),i?this._hammer.on(e,t):this._hammer.off(e,t))},populateEvent:function(e,t){if(this._isNativeEvent(e.type)){t.canvasX=t.canvasY=0;for(var i=e.touches.length?e.touches:e.changedTouches,n=i.length,r=0;r<n;++r)t.canvasX+=i[r].clientX/n,t.canvasY+=i[r].clientY/n;t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.pointers=e.touches}else t.canvasX=e.center.x,t.canvasY=e.center.y,t.scale=e.scale,t.rotation=e.rotation,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaTime=e.deltaTime,t.direction=e.direction,t.offsetDirection=e.offsetDirection,t.pointers=e.pointers,t.velocity=e.velocity;var a=this._target.getBoundingClientRect();t.canvasX+=-a.left,t.canvasY+=-a.top;var o=this._inputManager.getParam("pixelRatio");o||(o=this._defaultRatio),t.glX=t.canvasX*o[0],t.glY=(this._target.clientHeight-t.canvasY)*o[1]},_isNativeEvent:function(e){return this._supportedEvents.indexOf(e)>=0},isEventRegistered:function(e,t){if(e.pointerType&&"touch"!==e.pointerType)return!1;if(!t.action)return!0;if(isNaN(t.action))throw"touch action should be a number representing the number of touches";var i=e.pointers;i||(i=e.touches);var n=parseInt(t.action);if("touchend"===e.type||"touchcancel"===e.type){if(i.length>=n)return!1}else if(i.length!==n)return!1;return!0},supportsEvent:function(e){var t=pa.prototype.supportsEvent.call(this,e);if(t)return t;for(var i=0;i<this._hammerEvents.length;i++){var n=this._hammerEvents[i];if(0===e.indexOf(n))return!0}return!1},getHammer:function(){return this._hammer}}),"osgViewer","InputSourceTouchScreen");const Ta=xa;var Fa=i("hLVw"),Ra=i("QtIg"),Na=i("nRYw"),La=i("MQQR"),ka=i("+VSF"),Pa="ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof DocumentTouch,Ua=function(e,t,i){Er.Z.call(this),this._startTick=Sr.Z.instance().tick(),this._stats=void 0,this._running=!1,this._canvas=e;var n=this.initOptions(t),r=this.initWebGLContext(e,n,i);if(!r)throw"No WebGL implementation found";this._updateVisitor=new wr.Z,this.setUpView(r.canvas,n),this.initInputManager(n,e),this.initStats(n,e),this._vrSession=null,this._vrSupported=!1,this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._options=n,this._contextLost=!1,this._forceRestoreContext=!0,this.renderBinded=this.render.bind(this)};a.Z.createPrototypeObject(Ua,a.Z.objectInherit(Er.Z.prototype,{initInputManager:function(e,t){var i=new Ca;this._inputManager=i,this._initInputSource(Ea,"Mouse",t,e),this._initInputSource(Sa,"Keyboard",document,e),Pa&&this._initInputSource(Ta,"TouchScreen",t,e),this._initInputSource(ya,"WebVR",void 0,e),this._initInputSource(Qa,"DeviceOrientation",void 0,e),navigator.getGamepads&&this._initInputSource(Da,"GamePad",void 0,e),i.addMappings({"viewer.internals:vrSupported":"vrsupported"},function(){this.setVRSupported(!0)}.bind(this)),i.addMappings({"viewer.internals:hmdConnect":"vrdisplayconnected"},function(){this.setVRReady(!0)}.bind(this)),i.addMappings({"viewer.internals:hmdConnectPolyfill":"vrpolyfilled"},function(){this.setVRPolyfilled(!0)}.bind(this)),i.setParam("pixelRatio",[this._devicePixelRatio,this._devicePixelRatio])},_initInputSource:function(e,t,i,n){var r=n.InputSources?n.InputSources[t]:void 0;if(r){if(!1!==r.enable){var a=r.sourceElement||i;this._inputManager.registerInputSource(new e(a,r))}}else this._inputManager.registerInputSource(new e(i))},getInputManager:function(){return this._inputManager},initOptions:function(e){var t=new vr.Z;return e&&t.extend(e),t.extendWithOptionsURL(),!0===t.getBoolean("traceLogCall")&&(R.Z.traceLogCall=!0),!0===t.getBoolean("enableFrustumCulling")&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t.xrCompatible=!ka.d,t},initWebGLContext:function(e,t,i){t.get("SimulateWebGLLostContext")&&((e=Qr.makeLostContextSimulatingCanvas(e)).loseContextInNCalls(t.get("SimulateWebGLLostContext")),this._canvas=e);var n=Dr.Z.setupWebGL(e,t,i);return e.addEventListener("webglcontextlost",function(e){this.contextLost(),!1!==this._forceRestoreContext&&e.preventDefault()}.bind(this),!1),e.addEventListener("webglcontextrestored",function(){this.contextRestored()}.bind(this),!1),(R.Z.reportWebGLError||t.get("reportWebGLError"))&&(n=Qr.makeDebugContext(n)),this.initWebGLCaps(n),this.setGraphicContext(n),n},setContextLostCallback:function(e){this._contextLostCallback=e,this._contextLost&&(this._forceRestoreContext=e())},setContextRestoreCallback:function(e){this._contextRestoreCallback=e},contextLost:function(){R.Z.log("webgl context lost"),this._contextLostCallback&&(this._forceRestoreContext=this._contextLostCallback()),this._contextLost=!0,window.cancelAnimationFrame(this._requestID)},contextRestored:function(){!1!==this._forceRestoreContext?(this.restoreContext(),R.Z.log("webgl context restored")):R.Z.log("webgl context restore not supported - please reload the page - ")},restoreContext:function(){var e=this.getGraphicContext();sn.Z.onLostContext(e),on.Z.onLostContext(e),W.Z.onLostContext(e),Mr.Z.onLostContext(e),rn.Z.onLostContext(e),Je.Z.getTextureManager(e).onLostContext(e),yr.Z.onLostContext(e),this.getCamera().getRenderer().getState().resetCaches(),this.initWebGLCaps(e,!0),this.setGraphicContext(e),Br.Z.instance(this.getGraphicContext(),!0),this._stats&&this._stats.reset(),this._contextLost=!1,this._requestRedraw=!0,this._contextRestoreCallback&&this._contextRestoreCallback(e),this._runImplementation()},init:function(){},getUpdateVisitor:function(){return this._updateVisitor},getState:function(){return this.getCamera().getRenderer().getState()},initStats:function(e){var t=Br.Z.instance(this.getGraphicContext());e.getBoolean("stats")?(this._stats=new zr(this,e),this._stats.addConfig(jr),this._stats.addConfig(Aa),this._stats.addConfig(la),this.getCamera().addChild(this._stats.getNode()),t.setCallback(this.callbackTimerGPU.bind(this))):t.disable()},callbackTimerGPU:function(e,t){this._stats&&this._stats.getCounter(t).set(e/1e6)},getViewerStats:function(){return this._stats},renderingTraversal:function(){if(this.getState()._frameStamp=this._frameStamp,this.getScene().getSceneData()&&this.getScene().getSceneData().getBound(),this.getCamera()){var e=this._stats,t=Br.Z.instance(this.getGraphicContext()),i=this.getCamera().getRenderer();if(e&&e.getCounter("cull").start(),i.cull(),e&&e.getCounter("cull").end(),t.pollQueries(),t.start("glframe"),e&&e.getCounter("render").start(),i.draw(),e&&e.getCounter("render").end(),t.end("glframe"),e){var n=i.getCullVisitor();e.getCounter("cullcamera").set(n._numCamera),e.getCounter("cullmatrixtransform").set(n._numMatrixTransform),e.getCounter("cullprojection").set(n._numProjection),e.getCounter("cullnode").set(n._numNode),e.getCounter("culllightsource").set(n._numLightSource),e.getCounter("cullgeometry").set(n._numGeometry),e.getCounter("pushstateset").set(i.getState()._numPushStateSet),e.getCounter("applyStateSet").set(i.getState()._numApply)}}},updateTraversal:function(){var e=this._stats;e&&e.getCounter("update").start(),this._updateVisitor.resetStats(),this.getScene().updateSceneGraph(this._updateVisitor),e&&e.getCounter("updatecallback").set(this._updateVisitor._numUpdateCallback),this.getDatabasePager().releaseGLExpiredSubgraphs(.005),this.flushDeletedGLObjects(.005),e&&e.getCounter("update").end()},advance:function(e){var t=e;void 0===t&&(t=Number.MAX_VALUE);var i=this._frameStamp,n=i.getFrameNumber();i.setFrameNumber(n+1);var r=Sr.Z.instance().deltaS(this._startTick,Sr.Z.instance().tick());i.setReferenceTime(r);var a=i.getSimulationTime();i.setSimulationTime(t===Number.MAX_VALUE?r:t),i.setDeltaTime(i.getSimulationTime()-a)},beginFrame:function(){var e=this._stats;e&&(e.getCounter("frame").start(),e.getCounter("raf").tick(),e.getCounter("fps").frame())},endFrame:function(){this._stats&&(Je.Z.getTextureManager(this.getGraphicContext()).updateStats(this._stats),this._stats.getCounter("stats").start(),this._stats.update(),this._stats.getCounter("stats").end(),this._stats.getCounter("frame").end())},checkNeedToDoFrame:function(){return this._requestContinousUpdate||this._requestRedraw},frame:function(e,t){if(!this._contextLost){this.beginFrame(),this.advance();var i=this.updateViewport(),n={};this._vrSession&&(n.frame=t,n.xrReferenceSpace=this._xrReferenceSpace,this._xrFrame=t),this._inputManager.update(n),this._updateVisitor.setFrameStamp(this.getFrameStamp()),this.getManipulator()&&(this.getManipulator().update(this._updateVisitor),o._E.copy(this.getCamera().getViewMatrix(),this.getManipulator().getInverseMatrix())),(this.checkNeedToDoFrame()||i)&&(this._requestRedraw=!1,this.updateTraversal(),this.renderingTraversal()),this.endFrame()}},stop:function(){this._running=!1},isRunning:function(){return this._running},render:function(e,t){this.isRunning()&&(this._requestID=this._requestAnimationFrame(this.renderBinded),this.frame(e,t))},_runImplementation:function(){this.render()},run:function(){this.isRunning()||(this._running=!0,this._runImplementation())},setVRSupported:function(e){e&&console.log("Webxr, is supported!"),this._vrSupported=!!e},setVRReady:function(e){e&&console.log("Found the VR DISPLAY"),this._vRReady=!!e},isVRSupported:function(){return this._vrSupported},setVRPolyfilled:function(e){console.log("Webxr supported through polyfill"),this._vrPolyfilled=!!e},getVRSession:function(){return this._vrSession},getXRPose:function(e){if(this._xrFrame)return this._xrFrame.getPose(e,this._xrReferenceSpace)},needsVRPolyFill:function(){return!!this._vrPolyfilled&&!this._vrPolyfillLoaded},loadWebxrPolyFill:function(){return i.e(5332).then(function(){window.WebXRPolyfill=i("YwCn")}.bind(null,i)).catch(i.oe).then(function(){return new window.WebXRPolyfill.default,this._vrPolyfillLoaded=!0,this.getInputManager().getInputSource("WebVR").pollHeadset().then(function(){this.setVRSupported(!0),this.setVRReady(!0)}.bind(this)).catch(function(e){return this.setVRSupported(!1),this.setVRReady(!1),Te().reject(e)}.bind(this))}.bind(this))},_getVRPixelRatio:function(e){return(0,La.Z)().vrScaleRtt>0?(0,La.Z)().maxDevicePixelRatio:window.XRWebGLLayer.getNativeFramebufferScaleFactor(e)},setPresentVR:function(e){if(!this.isVRSupported())return R.Z.warn("VR not supported by the browser!"),Te().reject("VR not supported by the browser!");if(!this._vRReady)return R.Z.log("VR headset not plugged in or immersive session not supported!"),Te().reject("VR headset not plugged in or immersive session not supported!");var t,i=function(e){return this._xrReferenceSpace=e,window.cancelAnimationFrame(this._requestID),this._requestAnimationFrame=this._vrSession.requestAnimationFrame.bind(this._vrSession),this._requestID=this._requestAnimationFrame(this.renderBinded),this.getCamera().frameBufferObject=new rn.Z,this.getCamera().frameBufferObject.setFrameBufferObject(this,t.framebuffer),this._vrSession}.bind(this),n=function(e){this._vrSession=e;var n=1/this._getVRPixelRatio(e);return t=new window.XRWebGLLayer(this._vrSession,this.getGraphicContext(),{framebufferScaleFactor:n}),this._vrSession.updateRenderState({baseLayer:t}),e.requestReferenceSpace("local").then(i).catch((function(e){return e}))}.bind(this);if(e)return this._vrSession?Te().resolve(this._vrSession):navigator.xr.requestSession("immersive-vr").then(n).catch((function(e){return console.log(e),e}));if(this._vrSession){this._vrSession.cancelAnimationFrame(this._requestID),this.getCamera().frameBufferObject=new rn.Z,this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._requestID=this._requestAnimationFrame(this.renderBinded);var r=this._vrSession.end();return this._vrSession=void 0,r}},setupManipulator:function(e){void 0===e&&(e=new Ji({inputManager:this._inputManager})),void 0!==e.setNode?e.setNode(this.getSceneData()):e.view=this,e.setCamera(this.getCamera()),this.setManipulator(e)},updateViewport:function(){var e=this.getGraphicContext().canvas;if(!this.computeCanvasSize(e))return!1;var t=this.getCamera(),i=t.getViewport(),n=i.width(),r=i.height(),a=e.width/n,s=e.height/r,A=a/s;return i.setViewport(Math.round(i.x()*a),Math.round(i.y()*s),Math.round(i.width()*a),Math.round(i.height()*s)),1!==A&&o._E.mul(t.getProjectionMatrix(),t.getProjectionMatrix(),o._E.fromScaling(o._E.create(),[1/A,1,1])),!0},setManipulator:function(e){this.setEnableManipulator(!1),e.getCamera()||e.setCamera(this.getCamera()),e.setEnable(!0),Er.Z.prototype.setManipulator.call(this,e)},setEnableManipulator:function(e){this._manipulator&&this._manipulator.setEnable(e)},dispose:function(){Fa.Z.clean(),Ra.Z.clean(),Na.Z.pooledStateGraph.clean()}}),"osgViewer","Viewer");const Oa=Ua;var Ga=i("5ZWq"),Ha={};Ha.Renderer=_r.Z,Ha.View=Er.Z,Ha.Viewer=Oa,Ha.Scene=Ga.Z,Ha.InputGroups=xt.Z;const Ka=Ha;var Za=i("Kvhv"),Va=i("WWMP"),Ya=function(e,t){Va.Z.call(this),this._enable=!e,this._shadowReceiveAttribute=t,this._dirtyHash=!0,this._hash=""};a.Z.createPrototypeStateAttribute(Ya,a.Z.objectInherit(Va.Z.prototype,{attributeType:"ShadowCast",cloneType:function(){return new Ya(!0)},setReceiveAttribute:function(e){this._shadowReceiveAttribute=e},getReceiveAttribute:function(){return this._shadowReceiveAttribute},getDefines:function(){return this._shadowReceiveAttribute.getDefines()},_computeInternalHash:function(){return"ShadowCast"+this._enable+this._shadowReceiveAttribute.getPrecision()},getHash:function(){return this._shadowReceiveAttribute&&this._shadowReceiveAttribute._dirtyHash&&(this._receiveAttributeDirty=!0),this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},isEnabled:function(){return this._enable}}),"osgShadow","ShadowCastAttribute");const Ja=Ya;var za=i("2Vrk"),ja=i("Ln1o"),Wa=function(e){J.Z.call(this),this._noCastMask=e,this._nodeList=[]};a.Z.createPrototypeObject(Wa,a.Z.objectInherit(J.Z.prototype,{reset:function(){this._nodeList=[]},removeNodeFromCasting:function(e){var t=e.getNodeMask();-1===t?(t=this._noCastMask,e.setNodeMask(t),this._nodeList.push(e)):0!=(t&~this._noCastMask)&&(e.setNodeMask(t|this._noCastMask),this._nodeList.push(e))},apply:function(e){var t=e.getStateSet();if(t){var i=t.getAttribute("BlendFunc");if(void 0!==i&&i.getSource()!==ze.Z.DISABLE){var n=t.getAttribute("Depth");if(n&&(n.getFunc()===$i.Z.DISABLE||!1===n.getWriteMask()))return void this.removeNodeFromCasting(e)}}e.getTypeID()!==za.Z.typeID&&e.getTypeID()!==ja.Z.typeID?e.getTypeID()===nn.Z.typeID&&e.isRenderToTextureCamera()?this.removeNodeFromCasting(e):this.traverse(e):this.removeNodeFromCasting(e)},setNoCastMask:function(e){this._noCastMask=e},restore:function(){for(var e=0,t=this._nodeList.length;e<t;e++){var i=this._nodeList[e],n=i.getNodeMask();n===this._noCastMask?i.setNodeMask(-1):i.setNodeMask(n&~this._noCastMask)}}}),"osgShadow","ShadowCasterVisitor");const qa=Wa;var Xa,$a=i("cyFB"),eo=i("bDLW"),to=function(){J.Z.call(this,J.Z.TRAVERSE_ALL_CHILDREN),this._pooledMatrix=new $a.Z(o._E.create),this._matrixStack=new eo.Z,this._matrixStack.push(o._E.IDENTITY),this._bb=new Vr.Z,this._bs=new At.Z};a.Z.createPrototypeObject(to,a.Z.objectInherit(J.Z.prototype,{reset:function(e,t,i,n,r){this.setTraversalMask(e),this._cameraFrustum=i,this._lightFrustum=r,this.getCameraPlaneMaskForLightNear(t,i,n?6:4),this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(o._E.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},getCameraPlaneMaskForLightNear:function(e,t,i){var n,r=1,a=15;for(n=0;n<i;++n)a=a<<1|1;var o=t.getPlanes();for(n=0;n<i;++n)dt.Z.distanceToPlane(o[n],e)<0&&(a^=r),r<<=1;return this._cameraPlaneMaskedByLightNear=a,t.setResultMask(a),t.pushCurrentMask(a),a},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();o._E.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this);var i=this._bs;e.getBound().transformMat4(this._bs,t),(0===this._cameraFrustum.getCurrentMask()||this._cameraFrustum.containsBoundingSphere(i))&&(0===this._lightFrustum.getCurrentMask()||this._lightFrustum.containsBoundingSphere(i))&&(this._cameraFrustum.pushCurrentMask(),this._lightFrustum.pushCurrentMask(),this.pushMatrix(t),this.traverse(e),this._cameraFrustum.popCurrentMask(),this._lightFrustum.popCurrentMask(),this.popMatrix())},applyBoundingBox:(Xa=new Vr.Z,function(e){var t=this._matrixStack.back();o._E.exactEquals(t,o._E.IDENTITY)?this._bb.expandByBoundingBox(e):e.valid()&&(e.transformMat4(Xa,t),this._bb.expandByBoundingBox(Xa))}),apply:function(e){var t=e.getTypeID();if(e instanceof Ve.Z)this.applyTransform(e);else if(t!==ke.Z.getTypeID())t===nn.Z.getTypeID()||za.Z.getTypeID(),this.traverse(e);else{var i=this._bs;if(e.getBound().transformMat4(i,this._matrixStack.back()),0!==this._cameraFrustum.getCurrentMask()&&!this._cameraFrustum.containsBoundingSphere(i))return;if(0!==this._lightFrustum.getCurrentMask()&&!this._lightFrustum.containsBoundingSphere(i))return;this.applyBoundingBox(e.getBoundingBox())}},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()}}),"osgShadow","ComputeMultiFrustumBoundsVisitor");const io=to;var no=i("BvLe"),ro=function(e,t){Va.Z.call(this),this._lightNumber=e,this._bias=.001,this._normalBias=void 0,this._precision="UNSIGNED_BYTE",this._kernelSizePCF=void 0,this._fakePCF=!0,this._jitterOffset="none",this._enable=!t,this._isAtlasTexture=!1,this._dirtyHash=!0,this._hash=""};ro.uniforms={},a.Z.createPrototypeStateAttribute(ro,a.Z.objectInherit(Va.Z.prototype,{attributeType:"ShadowReceive",cloneType:function(){return new ro(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this.getLightNumber()},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"u"+(this.getType()+this.getLightNumber().toString())+"_"+e},getAtlas:function(){return this._isAtlasTexture},setAtlas:function(e){this._isAtlasTexture=e},setBias:function(e){this._bias=e},getBias:function(){return this._bias},setNormalBias:function(e){this._normalBias=e},getNormalBias:function(){return this._normalBias},setJitterOffset:function(e){this._jitterOffset=e},getJitterOffset:function(){return this._jitterOffset},getKernelSizePCF:function(){return this._kernelSizePCF},setKernelSizePCF:function(e){this._kernelSizePCF=e,this._dirtyHash=!0},setPrecision:function(e){this._precision=e,this._dirtyHash=!0},getPrecision:function(){return this._precision},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=ro,t=this.getTypeMember();return e.uniforms[t]||(e.uniforms[t]={bias:en.Z.createFloat(this.getUniformName("bias")),normalBias:en.Z.createFloat(this.getUniformName("normalBias"))}),e.uniforms[t]},getDefines:function(){var e=[];switch(this.getKernelSizePCF()){case"4Tap(16texFetch)":e.push("#define _PCFx4");break;case"9Tap(36texFetch)":e.push("#define _PCFx9");break;case"16Tap(64texFetch)":e.push("#define _PCFx25");break;default:e.push("#define _PCFx1")}return"UNSIGNED_BYTE"!==this.getPrecision()&&e.push("#define _FLOATTEX"),this.getAtlas()&&e.push("#define _ATLAS_SHADOW"),this.getNormalBias()&&e.push("#define _NORMAL_OFFSET"),"none"!==this.getJitterOffset()&&e.push("#define _JITTER_OFFSET"),e},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();e.normalBias.setFloat(this._normalBias),e.bias.setFloat(this._bias)}},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this.getKernelSizePCF()}}),"osgShadow","ShadowReceiveAttribute");const ao=ro;var oo=function(){N.Z.call(this),this._shadowedScene=void 0,this._dirty=!1,this._continuousUpdate=!0,this._needRedraw=!0};a.Z.createPrototypeObject(oo,a.Z.objectInherit(N.Z.prototype,{dirty:function(){this._dirty=!0},getShadowedScene:function(){return this._shadowedScene},setContinuousUpdate:function(e){this._continuousUpdate=e},isContinuousUpdate:function(){return this._continuousUpdate},needRedraw:function(){return this._needRedraw},requestRedraw:function(){this._needRedraw=!0},setShadowedScene:function(e){this._shadowedScene=e},init:function(){R.Z.log("No ShadowTechnique activated: normal rendering activated")},valid:function(){return!1},updateShadowTechnique:function(){},cullShadowCasting:function(){},cleanSceneGraph:function(){R.Z.log("No ShadowTechnique activated: normal rendering activated")}}),"osgShadow","ShadowTechnique");const so=oo;var Ao=function(){Je.Z.call(this),this._uniforms={},this._mapSize=o.vh.create(),this._renderSize=o.K4.create(),this._lightNumber=-1,this._dirtyHash=!0,this._hash=""};Ao.uniforms={},a.Z.createPrototypeStateAttribute(Ao,a.Z.objectInherit(Je.Z.prototype,{cloneType:function(){return new Ao},invalidate:function(){Je.Z.prototype.invalidate.call(this),this.dirty()},hasLightNumber:function(e){return this._lightNumber===e},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"u"+("Shadow_"+this.getType()+this._lightNumber.toString())+"_"+e},setInternalFormatType:function(e){Je.Z.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},getOrCreateUniforms:function(e){var t=Ao;if(R.Z.assert(void 0!==e),R.Z.assert(-1!==this._lightNumber),void 0!==t.uniforms[e])return t.uniforms[e];var i=t.uniforms[e]={ViewRight:en.Z.createFloat4(this.getUniformName("viewRight")),ViewUp:en.Z.createFloat4(this.getUniformName("viewUp")),ViewLook:en.Z.createFloat4(this.getUniformName("viewLook")),Projection:en.Z.createFloat3(this.getUniformName("projection")),DepthRange:en.Z.createFloat2(this.getUniformName("depthRange")),MapSize:en.Z.createFloat4(this.getUniformName("mapSize")),RenderSize:en.Z.createFloat2(this.getUniformName("renderSize"))},n="Texture"+e,r=en.Z.createInt1(e,n);return i[n]=r,t.uniforms[e]},setViewMatrix:function(e){this._viewMatrix=e},setProjection:function(e){this._projection=e},setDepthRange:function(e){this._depthRange=e},setTextureSize:function(e,t){Je.Z.prototype.setTextureSize.call(this,e,t),this.dirty(),this._mapSize[0]=e,this._mapSize[1]=t,this._mapSize[2]=1/e,this._mapSize[3]=1/t,this._renderSize[0]=1/e,this._renderSize[1]=1/t},_updateViewMatrixUniforms:function(e,t,i,n){var r,a=e;(r=t.getInternalArray())[0]=a[0],r[1]=a[4],r[2]=a[8],r[3]=a[12],(r=i.getInternalArray())[0]=a[1],r[1]=a[5],r[2]=a[9],r[3]=a[13],(r=n.getInternalArray())[0]=a[2],r[1]=a[6],r[2]=a[10],r[3]=a[14]},apply:function(e,t){if(Je.Z.prototype.apply.call(this,e,t),-1!==this._lightNumber){var i=this.getOrCreateUniforms(t);this._updateViewMatrixUniforms(this._viewMatrix,i.ViewRight,i.ViewUp,i.ViewLook),i.Projection.setFloat3(this._projection),i.DepthRange.setFloat2(this._depthRange),i.MapSize.setFloat4(this._mapSize),i.RenderSize.setFloat2(this._renderSize)}},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this._lightNumber+"_"+this._type}}),"osgShadow","ShadowTexture");const go=Ao;var ho=i("rsXr"),co=function(e){this._shadowTechnique=e};a.Z.createPrototypeObject(co,{cull:function(e,t){this._shadowTechnique.getShadowedScene().nodeTraverse(t);var i=t.getCurrentCullingSet(),n=t.getCurrentProjectionMatrix(),r=t.getComputedNear(),a=t.getComputedFar();return r===1/0&&a===-1/0?(this._shadowTechnique.markSceneAsNoShadow(),!1):(o._E.getFrustumPlanes(i.getFrustum().getPlanes(),n,t.getCurrentModelViewMatrix(),!1),i.getFrustum().setupMask(6),this._shadowTechnique.setLightFrustum(i.getFrustum(),r,a),!1)}},"osgShadow","CameraCullCallback");var lo=function(e,t){so.call(this),this._projectionMatrix=o._E.create(),this._projection=o.R3.create(),this._viewMatrix=o._E.create(),this._lightNumberArrayIndex=-1,this._lightUp=o.R3.fromValues(0,0,1),this._light=e.light,this._cameraShadow=new nn.Z,this._cameraShadow.setCullCallback(new co(this)),this._cameraShadow.setRenderOrder(nn.Z.PRE_RENDER,0),this._cameraShadow.setReferenceFrame(rr.Z.ABSOLUTE_RF),this._cameraShadow.setClearColor(o.vh.fromValues(1,1,1,1)),t?this._texture=t:(this._texture=new go,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0),this._textureSize=256;var i=en.Z.createFloat2("RenderSize");this._texelSizeUniform=en.Z.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=i.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._receivingStateset=void 0,this._casterStateSet=new tn.Z,this._casterStateSet.addUniform(en.Z.createFloat1(0,"exponent0")),this._casterStateSet.addUniform(en.Z.createFloat1(0,"exponent1")),this._casterStateSet.addUniform(en.Z.createFloat1(.005,"bias")),this._casterStateSet.addUniform(this._texelSizeUniform),this._casterStateSet.addUniform(i),this._casterStateSet.setAttributeAndModes(new $i.Z($i.Z.LESS),Va.Z.ON|Va.Z.OVERRIDE),this._casterStateSet.setAttributeAndModes(new ze.Z,Va.Z.ON|Va.Z.OVERRIDE),this._shadowReceiveAttribute=new ao(this._light.getLightNumber()),this._casterStateSet.setAttributeAndModes(this._shadowReceiveAttribute,Va.Z.ON|Va.Z.OVERRIDE),this._shadowCastShaderGeneratorName="ShadowCast";var n=en.Z.createFloat4("uShadowDepthRange");this._casterStateSet.addUniform(n),this._depthRange=n.getInternalArray(),this._depthRange[0]=.001,this._depthRange[1]=1e3,this._worldLightPos=o.vh.create(),this._worldLightPos[3]=0,this._worldLightDir=o.vh.create(),this._worldLightDir[3]=1,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,this._tmpVec=o.R3.create(),this._tmpVecBis=o.R3.create(),this._tmpVecTercio=o.R3.create(),this._tmpMatrix=o._E.create(),e&&this.setShadowSettings(e),this._infiniteFrustum=!0;var r=new Ja(!1,this._shadowReceiveAttribute);this._casterStateSet.setAttributeAndModes(r,Va.Z.ON|Va.Z.OVERRIDE),this._casterStateSet.setShaderGeneratorName(this._shadowCastShaderGeneratorName,Va.Z.OVERRIDE|Va.Z.ON),this._debug=!1};a.Z.createPrototypeObject(lo,a.Z.objectInherit(so.prototype,{getDepthRange:function(){return this._depthRange},setLightFrustum:function(e,t,i){this._lightFrustum=e,this._depthRange[0]=t,this._depthRange[1]=i,this.nearFarBounding(),this._debug&&(this._debugGeomFrustum.updateGeometry(this._projectionMatrix,this._depthRange),o._E.invert(this._debugNodeFrustum.getMatrix(),this._viewMatrix))},getCamera:function(){return this._cameraShadow},getTexture:function(){return this._texture},isDirty:function(){return this._dirty},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e},setShadowSettings:function(e){e&&(this._light=e.light,this._shadowCastShaderGeneratorName=e.getShadowCastShaderGeneratorName(),this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),this.setLight(this._light),this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType),this.setKernelSizePCF(e.kernelSizePCF),this.setBias(e.bias),this.setNormalBias(e.normalBias))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},getNormalBias:function(){return this._shadowReceiveAttribute.getNormalBias()},setNormalBias:function(e){this._shadowReceiveAttribute.setNormalBias(e)},getJitterOffset:function(){return this._shadowReceiveAttribute.getJitterOffset()},setJitterOffset:function(e){this._shadowReceiveAttribute.setJitterOffset(e)},getBias:function(){return this._shadowReceiveAttribute.getBias()},setBias:function(e){this._shadowReceiveAttribute.setBias(e),this._casterStateSet.getUniformList().bias.getUniform().setFloat(e)},getKernelSizePCF:function(){return this._shadowReceiveAttribute.getKernelSizePCF()},setKernelSizePCF:function(e){this._shadowReceiveAttribute.setKernelSizePCF(e)},setShadowedScene:function(e){so.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet(),this.dirty()},checkLightNumber:function(){var e=this._light.getLightNumber();this._shadowReceiveAttribute.getLightNumber()!==e&&this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),this._texture&&!this._texture.hasLightNumber(e)&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())},_rebindFbo:function(){this._cameraShadow.detachAll(),this._cameraShadow.attachTexture(rn.Z.COLOR_ATTACHMENT0,this._texture),this._cameraShadow.attachRenderBuffer(rn.Z.DEPTH_ATTACHMENT,rn.Z.DEPTH_COMPONENT16)},init:function(e,t,i){if(this._shadowedScene){this._needRedraw=!0,this.checkLightNumber();var n=this._light.getLightNumber();e?(this._texture=e,this._lightNumberArrayIndex=t,this._textureUnit=i,this._shadowReceiveAttribute.setAtlas(!0)):(this.initTexture(),this._rebindFbo(),this._textureUnit=this._textureUnitBase+n,this._texture.setLightNumber(n),this._texture.setName("ShadowTexture"+this._textureUnit),this._shadowReceiveAttribute.setAtlas(!1)),this._cameraShadow.setName("light_shadow_camera"+this._light.getName()),this._shadowReceiveAttribute.setLightNumber(n);var r=Va.Z.OVERRIDE|Va.Z.ON;this._receivingStateset.setAttributeAndModes(this._shadowReceiveAttribute,r),this._preventTextureBindingDuringShadowCasting(),this._casterStateSet.setTextureAttributeAndModes(this._textureUnit,Je.Z.textureNull,Va.Z.PROTECTED),this._receivingStateset.setTextureAttributeAndModes(this._textureUnit,this._texture,r),this._dirty=!1}},_preventTextureBindingDuringShadowCasting:function(){for(var e=no.Z.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS"),t=0;t<e;t++)this._casterStateSet.setTextureAttributeAndModes(t,Je.Z.textureNull,Va.Z.OVERRIDE|Va.Z.ON)},valid:function(){return!0},updateShadowTechnique:function(e,t,i){var n=this._cameraShadow,r=this._texture;if(n&&r){var a=n.getViewport();if(a||(a=new an.Z,n.setViewport(a)),t){var o=n.getScissor();o||(o=new ho.Z(t[0],t[1],t[2],t[3]),n.setScissor(o)),a.x()===t[0]&&a.y()===t[1]&&a.width()===t[2]&&a.height()===t[3]||(n.setFrameBufferObject(i),a.setViewport(t[0],t[1],t[2],t[3]),o.setScissor(t[0],t[1],t[2],t[3]))}else a.width()===r.getWidth()&&a.height()===r.getHeight()||(this._rebindFbo(),a.setViewport(0,0,r.getWidth(),r.getHeight()))}},updateShadowTechnic:function(){R.Z.log("ShadowMap.updateShadowTechnic() is deprecated, use updateShadowTechnique instead"),this.updateShadowTechnique()},setTextureFiltering:function(){var e;switch(this.getTexturePrecision()){case"HALF_FLOAT":e=Je.Z.HALF_FLOAT;break;case"FLOAT":e=Je.Z.FLOAT;break;default:e=Je.Z.UNSIGNED_BYTE}this._texture.setInternalFormatType(e),this._texture.setMinFilter(Je.Z.NEAREST),this._texture.setMagFilter(Je.Z.NEAREST),this._textureMagFilter=Je.Z.NEAREST,this._textureMinFilter=Je.Z.NEAREST},initTexture:function(){var e;this._dirty&&(this._texture||(this._texture=new go,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize,e=Je.Z.RGBA,this.setTextureFiltering(),this._texture.setInternalFormat(e),this._texture.setWrapS(Je.Z.CLAMP_TO_EDGE),this._texture.setWrapT(Je.Z.CLAMP_TO_EDGE),this._texture.dirty())},setTexturePrecision:function(e){e!==this._shadowReceiveAttribute.getPrecision()&&(this._shadowReceiveAttribute.setPrecision(e),this.dirty())},getTexturePrecision:function(){return this._shadowReceiveAttribute.getPrecision()},setTextureSize:function(e){e!==this._textureSize&&(this._textureSize=e,this.dirty())},getCasterStateSet:function(){return this._casterStateSet},setLight:function(e){e&&e!==this._light&&(this._light=e,this.dirty())},getUp:function(e){return Math.abs(o.R3.dot(this._lightUp,e))>=1&&(1===this._lightUp[0]?(this._lightUp[0]=0,this._lightUp[1]=1,this._lightUp[2]=0):(this._lightUp[0]=1,this._lightUp[1]=0,this._lightUp[2]=0)),this._lightUp},nearFarBounding:function(){var e=this._depthRange[0],t=this._depthRange[1],i=lo.EPSILON;t<e-i?(this._emptyCasterScene=!0,t=1,e=i):e<i&&(e=i),this._depthRange[0]=e,this._depthRange[1]=t},makePerspectiveFromBoundingBox:function(e,t,i,n,r,a){var s=e.center(this._tmpVec),A=e.radius(),g=lo.EPSILON,h=g,c=1;this._radius=A;var l=o.R3.distance(s,i);l<=A?(h=g,c=l+A):(h=l-A,c=l+A),this._depthRange[0]=h,this._depthRange[1]=c,this.nearFarBounding();var u=this._depthRange[0]*Math.tan(t*Math.PI/180),d=u=u>A?A:u,I=-d,C=u,f=-C,p=this.getUp(n);this._infiniteFrustum?o._E.infiniteFrustum(a,f,C,I,d,this._depthRange[0]):o._E.frustum(a,f,C,I,d,this._depthRange[0],this._depthRange[1]),this._projection[0]=this._projectionMatrix[0],this._projection[1]=this._projectionMatrix[5],this._projection[2]=0,o._E.lookAtDirection(r,i,n,p)},makeOrthoFromBoundingBox:function(e,t,i,n){var r=e.center(this._tmpVecTercio),a=e.radius(),s=a+a,A=1e-4,g=s+1e-4,h=this._tmpVec;o.R3.scaleAndAdd(h,r,t,-s);(A=a)<.001*(g+=a)&&(A=.001*g);var c,l,u=this.getUp(t);o._E.lookAtDirection(i,h,t,u),c=l=a,o._E.ortho(n,-c,c,-l,l,A,g),this._projection[0]=c,this._projection[1]=l,this._projection[2]=1,this._depthRange[0]=A,this._depthRange[1]=g},aimShadowCastingCamera:function(e,t){var i=this._light;if(i){var n=this._cameraShadow,r=this._worldLightPos,a=this._worldLightDir;o._E.copy(this._projectionMatrix,n.getProjectionMatrix()),o._E.copy(this._viewMatrix,n.getViewMatrix());for(var s,A=this._projectionMatrix,g=this._viewMatrix,h=e.getCurrentRenderBin().getPositionedAttribute(),c=h.getArray(),l=0;l<h.getLength();l++){var u=c[l],d=u[1],I=u[0];if(d===i){s=I;break}}if(void 0===s)return R.Z.warn("light isnt inside children of shadowedScene Node"),void(this._emptyCasterScene=!0);var C=this._tmpMatrix;if(o._E.invert(C,e.getCurrentModelViewMatrix()),this._light.isDirectionLight())o.vh.transformMat4(r,i.getPosition(),s),o.vh.transformMat4(r,r,C),o.R3.scale(r,r,-1),o.R3.normalize(r,r),this.makeOrthoFromBoundingBox(t,r,g,A),this._debug&&o._E.invert(this._debugNodeFrustum.getMatrix(),g);else{o._E.mul(this._tmpMatrix,C,s);var f=this._tmpMatrix;o.R3.transformMat4(r,i.getPosition(),f),f[12]=0,f[13]=0,f[14]=0,o._E.invert(f,f),o._E.transpose(f,f),o.R3.copy(a,i.getDirection()),o.vh.transformMat4(a,a,f),o.R3.normalize(a,a),this.makePerspectiveFromBoundingBox(t,i.getSpotCutoff(),r,a,g,A)}o._E.copy(n.getProjectionMatrix(),this._projectionMatrix),o._E.copy(n.getViewMatrix(),this._viewMatrix)}else this._emptyCasterScene=!0},frameShadowCastingFrustum:function(e){this._infiniteFrustum||Ke.Z.prototype.clampProjectionMatrix(this._projectionMatrix,this._depthRange[0],this._depthRange[1],e.getNearFarRatio(),this._depthRange);var t=this._cameraShadow;o._E.copy(t.getProjectionMatrix(),this._projectionMatrix),o._E.copy(t.getViewMatrix(),this._viewMatrix),this.setShadowUniformsReceive(!1)},setShadowUniformsReceive:function(e){if(e&&o.K4.set(this._depthRange,0,0),-1!==this._lightNumberArrayIndex){var t=this._light.getLightNumber();this._texture.setViewMatrix(t,this._viewMatrix),this._texture.setProjection(t,this._projection),this._texture.setDepthRange(t,this._depthRange)}else this._texture.setViewMatrix(this._viewMatrix),this._texture.setProjection(this._projection),this._texture.setDepthRange(this._depthRange)},markSceneAsNoShadow:function(){this.setShadowUniformsReceive(!0),this._needRedraw=!1},cullShadowCasting:function(e,t){if(this._debug){var i=t.getMin(),n=t.getMax();t.center(this._tmpVec);var r=this._debugNodeSceneCast.getMatrix();o._E.fromScaling(r,[n[0]-i[0],n[1]-i[1],n[2]-i[2],1]),o._E.setTranslation(r,this._tmpVec)}if(this._emptyCasterScene=!1,this.aimShadowCastingCamera(e,t),this._emptyCasterScene)this.markSceneAsNoShadow();else{var a=e.getTraversalMask();e.setTraversalMask(this._castsShadowDrawTraversalMask),e.pushStateSet(this._casterStateSet),this._cameraShadow.setEnableFrustumCulling(!0),this._cameraShadow.setComputeNearFar(!0),this._debug&&this._debugNode.accept(e),this._cameraShadow.accept(e),this.nearFarBounding(),this.frameShadowCastingFrustum(e),this._cameraShadow.setComputeNearFar(!1),e.popStateSet(),e.setTraversalMask(a),this._needRedraw=!1}},cleanReceivingStateSet:function(e){if(this._receivingStateset){if(this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),e)return;this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())}},cleanSceneGraph:function(e){this._needRedraw=!0,this.cleanReceivingStateSet(e),this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e){e&&!this._debug&&(this._debugNode||(this._debugGeomFrustum=ln.createDebugFrustumGeometry(),this._debugGeomSceneCast=Ye.Z.createBoundingBoxGeometry(),this._debugGeomSceneCast.getPrimitives()[0].mode=dn.Z.LINES,this._debugNode=new Ve.Z,this._debugNodeFrustum=new Ve.Z,this._debugNodeSceneCast=new Ve.Z,this._debugNodeFrustum.addChild(this._debugGeomFrustum),this._debugNodeSceneCast.addChild(this._debugGeomSceneCast),this._debugNode.addChild(this._debugNodeFrustum),this._debugNode.addChild(this._debugNodeSceneCast))),this._debug=e},getDebug:function(){return this._debug},getLightNumber:function(){return this._light.getLightNumber()},getLight:function(){return this._light}}),"osgShadow","ShadowMap"),lo.EPSILON=.005;const uo=lo;var Io=function(){Je.Z.call(this),this._uniforms={},this._lightNumberArray=[],this._viewMatrices=[],this._projection=[],this._depthRanges=[],this._mapSizes=[],this._renderSize=o.K4.create(),this._dirtyHash=!0,this._hash=""};Io.uniforms={},a.Z.createPrototypeStateAttribute(Io,a.Z.objectInherit(Je.Z.prototype,{cloneType:function(){return new Io},getLightNumberArray:function(){return this._lightNumberArray},hasLightNumber:function(e){return-1!==this._lightNumberArray.indexOf(e)},setLightNumberArray:function(e){this._lightNumberArray=e,this._dirtyHash=!0},getUniformName:function(e,t){return"u"+("Shadow_"+this.getType()+e.toString())+"_"+t},setInternalFormatType:function(e){Je.Z.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},createUniforms:function(e,t){t["ViewRight_"+e]=en.Z.createFloat4(this.getUniformName(e,"viewRight")),t["ViewUp_"+e]=en.Z.createFloat4(this.getUniformName(e,"viewUp")),t["ViewLook_"+e]=en.Z.createFloat4(this.getUniformName(e,"viewLook")),t["Projection_"+e]=en.Z.createFloat3(this.getUniformName(e,"projection")),t["DepthRange_"+e]=en.Z.createFloat2(this.getUniformName(e,"depthRange")),t["MapSize_"+e]=en.Z.createFloat4(this.getUniformName(e,"mapSize")),t["RenderSize_"+e]=t.RenderSize},getOrCreateUniforms:function(e){var t=Io;if(R.Z.assert(void 0!==e||0!==this._lightNumberArray.length),void 0!==t.uniforms[e])return t.uniforms[e];var i=t.uniforms[e]={},n=en.Z.createFloat2(this.getUniformName(0,"renderSize"));i.RenderSize=n;for(var r=0,a=this._lightNumberArray.length;r<a;r++)this.createUniforms(this._lightNumberArray[r],i);var o="Texture"+e,s=en.Z.createInt1(e,o);return i[o]=s,t.uniforms[e]},setViewMatrix:function(e,t){this._viewMatrices[e]=t},setProjection:function(e,t){this._projection[e]=t},setDepthRange:function(e,t){this._depthRanges[e]=t},setLightShadowMapSize:function(e,t){this._mapSizes[e]=t},apply:function(e,t){if(Je.Z.prototype.apply.call(this,e,t),0!==this._lightNumberArray.length){for(var i=this.getOrCreateUniforms(t),n=0,r=this._lightNumberArray.length;n<r;n++){var a=this._lightNumberArray[n];i["ViewRight_"+a]||this.createUniforms(a,i),go.prototype._updateViewMatrixUniforms.call(this,this._viewMatrices[a],i["ViewRight_"+a],i["ViewUp_"+a],i["ViewLook_"+a]),i["Projection_"+a].setFloat3(this._projection[a]),i["DepthRange_"+a].setFloat2(this._depthRanges[a]),i["MapSize_"+a].setFloat4(this._mapSizes[a])}i.RenderSize.setFloat2(this._renderSize)}},setTextureSize:function(e,t){this._renderSize[0]=1/e,this._renderSize[1]=1/t,Je.Z.prototype.setTextureSize.call(this,e,t),this.dirty()},_computeInternalHash:function(){for(var e=this.getTypeMember(),t=0,i=this._lightNumberArray.length;t<i;t++)e+="_"+this._lightNumberArray[t];return e+="_"+this._type},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash}}),"osgShadow","ShadowTextureAtlas");const Co=Io;var fo=function(e){this._lights=[],this._shadowMaps=[],this._viewportDimension=[],so.apply(this,arguments),this._shadowSettings=e,this._texture=new Co,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0,this._textureSize=1024,this._shadowMapSize=256,this._receivingStateset=void 0,e&&(this.setShadowSettings(e),e.atlasSize&&(this._textureSize=e.atlasSize),e.textureSize&&(this._shadowMapSize=e.textureSize)),this._texelSizeUniform=en.Z.createFloat1(1/this._textureSize,"texelSize");var t=en.Z.createFloat2("RenderSize");this._renderSize=t.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this._cameraClear=new nn.Z,this._cameraClear.setName("shadowAtlasCameraClear"),this._cameraClear.setRenderOrder(nn.Z.PRE_RENDER,0),this._cameraClear.setClearColor(o.vh.fromValues(1,1,1,1)),this._cameraClear.setFrameBufferObject(new rn.Z),this._cameraClear.setClearMask(0)};a.Z.createPrototypeObject(fo,a.Z.objectInherit(so.prototype,{getTexture:function(){return this._texture},isDirty:function(e){if(void 0!==e)return this._shadowMaps[e].isDirty();for(var t=0,i=this._shadowMaps.length;t<i;t++)if(this._shadowMaps[t].isDirty())return!0;return!1},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e;for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setTextureUnitBase(e)},setShadowSettings:function(e){if(e){this._shadowSettings=e;for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setShadowSettings(e);this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType)}},setCastsShadowDrawTraversalMask:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setCastsShadowDrawTraversalMask(e)},getCastsShadowDrawTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},setCastsShadowBoundsTraversalMask:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setCastsShadowBoundsTraversalMask(e)},getCastsShadowBoundsTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},getNormalBias:function(e){return void 0!==e?this._shadowMaps[e].getNormalBias():0!==this._shadowMaps.length?this._shadowMaps[0].getNormalBias():void 0},setNormalBias:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setNormalBias(e)},getBias:function(e){return void 0!==e?this._shadowMaps[e].getBias():0!==this._shadowMaps.length?this._shadowMaps[0].getBias():void 0},setBias:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setBias(e)},getKernelSizePCF:function(e){return void 0!==e?this._shadowMaps[e].getKernelSizePCF():1!==this._shadowMaps.length?this._shadowMaps[0].getKernelSizePCF():void 0},setKernelSizePCF:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setKernelSizePCF(e)},setShadowedScene:function(e){so.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet();for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setShadowedScene(e)},setTexturePrecision:function(e){for(var t=0,i=this._shadowMaps.length;t<i;t++)this._shadowMaps[t].setTexturePrecision(e)},getTexturePrecision:function(e){return void 0!==e?this._shadowMaps[e].getTexturePrecision():1!==this._shadowMaps.length?this._shadowMaps[0].getTexturePrecision():void 0},setTextureSize:function(e){e!==this._textureSize&&(this._shadowMapSize=e,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this.dirty())},getShadowMap:function(e){return this._shadowMaps[e]},addLight:function(e){if(!e||-1!==this._lights.indexOf(e))return R.Z.warn("no light or light already added"),-1;if(this._lights.length!==this._numShadowWidth*this._numShadowHeight){this._lights.push(e),this._shadowSettings.setLight(e);var t=new uo(this._shadowSettings,this._texture);return this._shadowMaps.push(t),this._shadowedScene&&t.setShadowedScene(this._shadowedScene),this.recomputeViewports(),t}R.Z.warn("can't allocate shadow for light "+e.getLightNumber()+" ShadowAtlas already full ")},init:function(){if(this._shadowedScene){this.initTexture();for(var e=[],t=0;t<this._lights.length;t++)e.push(this._lights[t].getLightNumber());this._texture.setLightNumberArray(e),this._textureUnit=this._textureUnitBase,this._texture.setName("ShadowTexture"+this._textureUnit);var i=en.Z.createFloat2("RenderSize");this._texelSizeUniform=en.Z.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=i.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this.recomputeViewports();for(var n=0,r=this._shadowMaps.length;n<r;n++){var a=this._shadowMaps[n];this._shadowedScene||(this._shadowedScene=a.getShadowedScene(this._shadowedScene)),this._shadowedScene&&a.setShadowedScene(this._shadowedScene),a.init(this._texture,n,this._textureUnitBase)}}},recomputeViewports:function(){for(var e=this._shadowMaps.length,t=e>2?Math.sqrt(2*Math.ceil(e/2)):e,i=t,n=this._textureSize/i,r=this._textureSize/t,a=this._textureSize/n,s=this._textureSize/r,A=0;A<e;A++){var g=this._shadowMaps[A],h=n*(A%a),c=r*Math.floor(A/s);this._viewportDimension.length<=A?this._viewportDimension.push(o.vh.fromValues(h,c,n,r)):o.vh.set(this._viewportDimension[A],h,c,n,r),this._texture.setLightShadowMapSize(this._lights[A].getLightNumber(),this._viewportDimension[A]),g.dirty()}},valid:function(){return!0},updateCameraClear:function(){var e=this._cameraClear,t=this._texture;if(e&&t){var i=e.getViewport();i||(i=new an.Z,e.setViewport(i)),i.width()===t.getWidth()&&i.height()===t.getHeight()||(e.detachAll(),e.attachTexture(rn.Z.COLOR_ATTACHMENT0,t),e.attachRenderBuffer(rn.Z.DEPTH_ATTACHMENT,rn.Z.DEPTH_COMPONENT16),e.getViewport().setViewport(0,0,t.getWidth(),t.getHeight()))}},updateShadowTechnique:function(e){this.updateCameraClear();for(var t=this._cameraClear.getFrameBufferObject(),i=0,n=this._shadowMaps.length;i<n;i++)this._shadowMaps[i].updateShadowTechnique(e,this._viewportDimension[i],t)},initTexture:function(){var e;this._dirty&&(this._texture||(this._texture=new Co,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize,e=Je.Z.RGBA,uo.prototype.setTextureFiltering.call(this),this._texture.setInternalFormat(e),this._texture.setWrapS(Je.Z.CLAMP_TO_EDGE),this._texture.setWrapT(Je.Z.CLAMP_TO_EDGE),this._texture.dirty())},cullShadowCasting:function(e,t){this._cameraClear.accept(e);for(var i=0,n=this._shadowMaps.length;i<n;i++){var r=this._shadowMaps[i];(r.isContinuousUpdate()||r.needRedraw())&&r.cullShadowCasting(e,t)}},isContinuousUpdate:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].isContinuousUpdate())return!0;return!1},needRedraw:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].needRedraw())return!0;return!1},removeShadowMap:function(e){if(this._shadowMaps.length>0){var t=this._shadowMaps.indexOf(e);if(-1!==t){this._shadowMaps[t].valid()&&this._shadowMaps[t].cleanSceneGraph(!0),this._shadowMaps.splice(t,1);var i=this._texture.getLightNumberArray();-1!==(t=i.indexOf(e.getLightNumber()))&&i.splice(t,1);var n=e.getLight();-1!==(t=this._lights.indexOf(n))&&this._lights.splice(t,1),this._viewportDimension.length>t&&this._viewportDimension.splice(t,1),this.recomputeViewports()}}},addShadowMap:function(e){if(!(this._shadowMaps.length>0&&-1!==this._shadowMaps.indexOf(e))){this._shadowMaps.push(e);var t=e.getLight();-1===this._lights.indexOf(t)&&this._lights.push(t),this._shadowedScene&&e.setShadowedScene(this._shadowedScene);var i=this._texture.getLightNumberArray();-1===i.indexOf(e.getLightNumber())&&i.push(t.getLightNumber()),this.recomputeViewports()}},cleanReceivingStateSet:function(){if(this._receivingStateset){this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember());for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].cleanReceivingStateSet()}},cleanSceneGraph:function(){this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e,t){if(t)this._shadowMaps[t].setDebug(e);else for(var i=0,n=this._shadowMaps.length;i<n;i++)this._shadowMaps[i].setDebug(e)},markSceneAsNoShadow:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].markSceneAsNoShadow()}}),"osgShadow","ShadowMapAtlas");const po=fo;var mo=function(e){this.castsShadowDrawTraversalMask=4294967295,this.castsShadowBoundsTraversalMask=4294967295,this.textureSize=1024,this.textureType="UNSIGNED_BYTE",this.textureFormat=Je.Z.RGBA,this.shadowProjection="fov",this.fov=50,this.kernelSizePCF="4Tap(4texFetch)",this.bias=.005,this.normalBias=void 0,this.shadowCastShaderGeneratorName="ShadowCast",a.Z.objectMix(this,e)};mo.kernelSizeList=["1Tap(4texFetch)","4Tap(16texFetch)","9Tap(36texFetch)","16Tap(64texFetch)"],mo.prototype={setCastsShadowDrawTraversalMask:function(e){this.castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this.castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this.castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this.castsShadowBoundsTraversalMask},setLight:function(e){this.light=e},getLight:function(){return this.light},setTextureSize:function(e){this.textureSize=e},getTextureSize:function(){return this.textureSize},setTextureType:function(e){this.textureType=e},getTextureType:function(){return this.textureType},setTextureFormat:function(e){this.textureFormat=e},getTextureFormat:function(){return this.textureFormat},setShadowCastShaderGeneratorName:function(e){this.shadowCastShaderGeneratorName=e},getShadowCastShaderGeneratorName:function(){return this.shadowCastShaderGeneratorName}};const _o=mo;var Eo=i("t+pa"),vo=function(e){je.Z.call(this),this._shadowTechniques=[],this._optimizedFrustum=!1,this._frustumReceivers=[o.vh.create(),o.vh.create(),o.vh.create(),o.vh.create(),o.vh.create(),o.vh.create()],this._tmpMat=o._E.create(),this._receivingStateset=new tn.Z,this._computeBoundsVisitor=new Eo.Z,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,e&&this.setShadowSettings(e)};a.Z.createPrototypeNode(vo,a.Z.objectInherit(je.Z.prototype,{getReceivingStateSet:function(){return this._receivingStateset},getShadowTechniques:function(){return this._shadowTechniques},addShadowTechnique:function(e){this._shadowTechniques.length>0&&-1!==this._shadowTechniques.indexOf(e)||(this._shadowTechniques.push(e),e.valid()&&(e.setShadowedScene(this),e.dirty()))},removeShadowTechnique:function(e){if(this._shadowTechniques.length>0){var t=this._shadowTechniques.indexOf(e);-1!==t&&(this._shadowTechniques[t].valid()&&this._shadowTechniques[t].cleanSceneGraph(),this._shadowTechniques.splice(t,1))}},cleanSceneGraph:function(){for(var e=0,t=this._shadowTechniques.length;e<t;e++)this._shadowTechniques[e]&&this._shadowTechniques[e].valid()&&this._shadowTechniques[e].cleanSceneGraph()},dirty:function(){for(var e=0;e<this._shadowTechniques.length;e++)this._shadowTechniques[e].dirty()},nodeTraverse:function(e){je.Z.prototype.traverse.call(this,e)},setShadowSettings:function(e){this._settings=e,this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),!1!==e.userShadowCasterVisitor&&(this._removeNodesNeverCastingVisitor=e.userShadowCasterVisitor||new qa(this._castsShadowTraversalMask))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},computeShadowedSceneBounds:function(){return this._removeNodesNeverCastingVisitor&&(this._removeNodesNeverCastingVisitor.setNoCastMask(~(this._castsShadowBoundsTraversalMask|this._castsShadowDrawTraversalMask)),this._removeNodesNeverCastingVisitor.reset(),this.accept(this._removeNodesNeverCastingVisitor)),this._computeBoundsVisitor.setTraversalMask(this._castsShadowBoundsTraversalMask),this._computeBoundsVisitor.reset(),this.accept(this._computeBoundsVisitor),!!this._computeBoundsVisitor.getBoundingBox().valid()||(this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore(),!1)},traverse:function(e){if(e.getVisitorType()===J.Z.CULL_VISITOR){var t,i,n=this._shadowTechniques.length;n&&e.pushStateSet(this._receivingStateset),this.nodeTraverse(e),n&&e.popStateSet();var r=!1;for(t=0;t<n;t++)(i=this._shadowTechniques[t])&&i.valid()&&(i.isDirty()&&(r=!0,i.init()),(i.isContinuousUpdate()||i.needRedraw())&&(r=!0));if(!r)return;if(!this.computeShadowedSceneBounds(e)){for(t=0;t<n;t++)(i=this._shadowTechniques[t]).markSceneAsNoShadow();return}var a=this._computeBoundsVisitor.getBoundingBox(),o=e.getCurrentModelMatrix();for(a.transformMat4(a,o),t=0;t<n;t++)((i=this._shadowTechniques[t]).isContinuousUpdate()||i.needRedraw())&&(i.updateShadowTechnique(e),i.cullShadowCasting(e,a));this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore()}else this.nodeTraverse(e)}}),"osgShadow","ShadowedScene"),Ke.Z.registerApplyFunction(vo.nodeTypeID,Ke.Z.getApplyFunction(je.Z.nodeTypeID));const So=vo;var Bo={};Bo.ShadowCastAttribute=Ja,Bo.ShadowReceiveAttribute=ao,Bo.ShadowCasterVisitor=qa,Bo.ShadowFrustumIntersection=io,Bo.ShadowMap=uo,Bo.ShadowMapAtlas=po,Bo.ShadowedScene=So,Bo.ShadowSettings=_o,Bo.ShadowTechnique=so,Bo.ShadowTexture=go,Bo.ShadowTextureAtlas=Co;const wo=Bo;const yo={Stats:zr,BufferStats:Rr,Graph:Tr,TextGenerator:Ur,Counter:kr,defaultStats:jr,browserStats:la,glStats:Aa};var Mo={};Mo.Text=qe;const Do=Mo;var bo={};bo.osg=Le,bo.osgAnimation=He,bo.osgText=$e;const Qo=bo;var xo=i("uHj6"),To=v.createQuatChannel,Fo=v.createVec3Channel,Ro=v.createFloatChannel,No=function(){this._filesMap=void 0,this._loadedFiles=void 0,this._bufferViewCache=void 0,this._basicAnimationManager=void 0,this._visitedNodes=void 0,this._animatedNodes=void 0,this._bones=void 0,this._skeletonToInfluenceMap=void 0,this._inputImgReader=void 0,this._localPath="",this._extensions=[],this._nodeAnimationTypes=void 0,this.init()};No.WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},No.TYPE_TABLE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},No.ATTRIBUTE_OSGJS_TABLE={POSITION:"Vertex",NORMAL:"Normal",TANGENT:"Tangent",TEXCOORD_0:"TexCoord0",TEXCOORD_1:"TexCoord1",TEXCOORD_2:"TexCoord2",TEXCOORD_3:"TexCoord3",TEXCOORD_4:"TexCoord4",TEXCOORD_5:"TexCoord5",TEXCOORD_6:"TexCoord6",TEXCOORD_7:"TexCoord7",TEXCOORD_8:"TexCoord8",TEXCOORD_9:"TexCoord9",TEXCOORD_10:"TexCoord10",TEXCOORD_11:"TexCoord11",TEXCOORD_12:"TexCoord12",TEXCOORD_13:"TexCoord13",TEXCOORD_14:"TexCoord14",TEXCOORD_15:"TexCoord15",COLOR_0:"Color",JOINTS_0:"Bones",WEIGHTS_0:"Weights"},No.TEXTURE_FORMAT={6406:Je.Z.ALPHA,6407:Je.Z.RGB,6408:Je.Z.RGBA,6409:Je.Z.LUMINANCE,6410:Je.Z.LUMINANCE_ALPHA},No.TYPE_CHANNEL_PATH={translation:{VEC3:Fo},scale:{VEC3:Fo},rotation:{VEC4:To},weights:{SCALAR:Ro}},No.TYPE_STACKED_TRANSFORMS={translation:Be,scale:ve,rotation:pe},No.PBR_SPEC_EXT="KHR_materials_pbrSpecularGlossiness",No.PBR_SPEC_MODE="PBR_specular_glossiness",No.PBR_METAL_MODE="PBR_metal_roughness",No.ALBEDO_TEXTURE_UNIT=2,No.DIFFUSE_TEXTURE_UNIT=2,No.SPECULAR_GLOSSINESS_TEXTURE_UNIT=3,No.METALLIC_ROUGHNESS_TEXTURE_UNIT=3,No.SPECULAR_TEXTURE_UNIT=4,No.NORMAL_TEXTURE_UNIT=5,No.AO_TEXTURE_UNIT=6,No.EMISSIVE_TEXTURE_UNIT=7,No.ALBEDO_UNIFORM="albedoMap",No.METALLIC_ROUGHNESS_UNIFORM="metallicRoughnessMap",No.SPECULAR_UNIFORM="specularMap",No.NORMAL_UNIFORM="normalMap",No.AO_UNIFORM="aoMap",No.EMISSIVE_UNIFORM="emissiveMap",No.prototype={init:function(){this._glTFJSON=void 0,this._nodeAnimationTypes=[],this._bufferViewCache={},this._basicAnimationManager=void 0,this._localPath="",this._visitedNodes={},this._animatedNodes={},this._bones={},this._skeletonToInfluenceMap={},this._stateSetMap={},this._filesMap={},this._inputReader=new De.Z,this._rootStateSet=new tn.Z,this._defaultBlendFunc=new ze.Z,this._transparentBlendFunc=new ze.Z("SRC_ALPHA","ONE_MINUS_SRC_ALPHA"),this._defaultCullFace=new Xi.Z,this._doubleSideCullFace=new Xi.Z(Xi.Z.DISABLE)},_preProcessNodes:function(){for(var e,t=this._gltfJSON.nodes,i=this._gltfJSON.meshes,n=0;n<t.length;n++){var r=t[n];e=r.name||"",e+="_"+n.toString(),r.osgjsNodeName=e;var a=r.children;if(a)for(var o=0;o<a.length;o++){t[a[o]].parent=n}}for(var s=0;s<i.length;s++){var A=i[s];e=A.name||"",e+="_"+s.toString(),A.osgjsNodeName=e}},loadBuffers:Te().method((function(){for(var e=[],t=this._gltfJSON.buffers,i=0;i<t.length;i++){var n=t[i];e.push(this.loadURI(n.uri,{responseType:"arraybuffer"}).then((function(e){n.data=e})))}return Te().all(e)})),loadBufferViews:function(){for(var e=this._gltfJSON.buffers,t=this._gltfJSON.bufferViews,i=0;i<t.length;i++){var n=t[i],r=e[n.buffer],a=n.byteLength||0,o=n.byteOffset||0;n.data=r.data.slice(o,o+a)}},loadAccessors:function(){for(var e=this._gltfJSON.bufferViews,t=this._gltfJSON.accessors,i=0;i<t.length;i++){var n,r=t[i],a=e[r.bufferView],o=No.TYPE_TABLE[r.type],s=No.WEBGL_COMPONENT_TYPES[r.componentType],A=s.BYTES_PER_ELEMENT*o,g=a.byteStride,h=!0===r.normalized;if(g&&g!==A)R.Z.warn("GLTF interleaved accessors not supported");else{var c=new s(a.data,r.byteOffset,r.count*o);(n=new W.Z(void 0,c,o)).setNormalize(h)}r.data=n}},_computeNodeMatrix:function(e){var t;if(e.matrix)t=o._E.clone(e.matrix);else if(e.translation||e.rotation||e.scale){var i=o._E.IDENTITY,n=o._E.IDENTITY,r=o._E.IDENTITY;e.translation&&(i=o._E.fromTranslation(o._E.create(),e.translation)),e.rotation&&(n=o._E.fromQuat(o._E.create(),e.rotation)),e.scale&&(r=o._E.fromScaling(o._E.create(),e.scale)),t=o._E.create(),o._E.multiply(t,n,r),o._E.multiply(t,i,t)}return t},loadNodes:function(){for(var e=this._gltfJSON.nodes,t=this._gltfJSON.skins,i=this._gltfJSON.meshes,n=0;n<e.length;n++){var r=e[n];if(!r.usedAsBone){if(void 0!==r.skin){var a=t[r.skin],o=a.osgjsNode;a.osgjsNodeAttached||(r.osgjsNode=o,a.osgjsNodeAttached=n);var s=i[r.mesh];s.osgjsGeometry.setBoneNameID(a.osgjsBoneMapID),o.addChild(s.osgjsGeometry)}else(r.matrix||r.translation||r.rotation||r.scale)&&(r.osgjsNode=this._createMatrixTransform(n)),void 0!==r.mesh&&(r.osgjsNode?r.osgjsNode.addChild(i[r.mesh].osgjsGeometry):r.osgjsNode=i[r.mesh].osgjsGeometry),r.osgjsNode||(r.osgjsNode=new je.Z);r.name&&r.osgjsNode.setName(r.name)}}},_linkNodes:function(e){var t=this._gltfJSON.nodes,i=e.children;if(i)for(var n=0;n<i.length;n++){var r=t[i[n]];if(!r.usedAsBone){var a=r.osgjsNode;a&&!e.osgjsNode.hasChild(a)&&(e.osgjsNode.addChild(a),this._linkNodes(r))}}},loadSkins:function(){var e=this._gltfJSON.skins;if(e)for(var t=0;t<e.length;t++)this._processSkin(t)},loadScenes:function(){var e=this._gltfJSON.nodes,t=this._gltfJSON.scenes;this._osgjsScene=[];for(var i=0;i<t.length;i++){for(var n=t[i].nodes,r=[],a=0;a<n.length;a++){var o=e[n[a]];this._linkNodes(o),r.push(o.osgjsNode)}var s=r[0];if(r.length>1){s=new je.Z;for(var A=0;A<r.length;A++)s.addChild(r[A])}this._osgjsScene.push(s)}},_assignGeometryAttributes:function(e,t,i){var n=this._gltfJSON.accessors;for(var r in t){var a=n[t[r]],o=No.ATTRIBUTE_OSGJS_TABLE[r];void 0!==i&&(o+="_"+i.toString()),e.getVertexAttributeList()[o]=a.data,a.data._target=W.Z.ARRAY_BUFFER}},_assignGeometryPrimitives:function(e,t){var i=this._gltfJSON.accessors[t.indices];i.data._target=W.Z.ELEMENT_ARRAY_BUFFER;var n=void 0!==t.mode?t.mode:dn.Z.TRIANGLES,r=new yn.Z(n,i.data);e.getPrimitiveSetList().push(r)},_getMorphTargetName:function(e,t){return e.osgjsNodeName+"_target_"+t.toString()},_computeAbsoluteMorphData:function(e,t){var i=this._gltfJSON.accessors;for(var n in t){var r=i[t[n]];if(!r.morphAbsoluteComputed){r.morphAbsoluteComputed=!0;for(var a=i[e[n]].data.getElements(),o=r.data.getElements(),s=a.length,A=0;A<s;A++)o[A]+=a[A]}}},_processMorphGeometry:function(e,t){var i=e.primitives[t],n=new X.Z,r=new te;r.setName(e.osgjsNodeName),n.setName(e.osgjsNodeName);for(var a=0;a<i.targets.length;a++){this._computeAbsoluteMorphData(i.attributes,i.targets[a]);var o=this._getMorphTargetName(e,a),s=new ke.Z;s.setName(o),r.addTarget(o,a),this._assignGeometryAttributes(s,i.targets[a]),n.getMorphTargets().push(s)}this._assignGeometryAttributes(n,i.attributes),this._assignGeometryPrimitives(n,i),n.mergeChildrenVertexAttributeList(),e.osgjsMorphGeometry=n,e.osgjsUpdateMorph=r},loadMeshes:function(){for(var e=this._gltfJSON.meshes,t=this._gltfJSON.materials,i=0;i<e.length;i++){for(var n=e[i],r=n.name,a=[],o=0;o<n.primitives.length;o++){var s=void 0,A=n.primitives[o],g=void 0;if(A.targets&&A.targets.length&&(this._processMorphGeometry(n,o),s=n.osgjsMorphGeometry,g=n.osgjsUpdateMorph),A.attributes.JOINTS_0){var h=new q.Z;s||(s=new ke.Z,this._assignGeometryAttributes(s,A.attributes),this._assignGeometryPrimitives(s,A));var c=new Vr.Z;s.computeBoundingBox(c),h.setBound(c),h.setSourceGeometry(s),h.mergeChildrenData(),s=h}s||(s=new ke.Z,this._assignGeometryAttributes(s,A.attributes),this._assignGeometryPrimitives(s,A)),r&&s.setName(r),g&&s.addUpdateCallback(g);var l=t[A.material].osgjsStateSet;s.setStateSet(l),s.setUserData(l.getUserData()),a.push(s)}if(a.length>1){for(var u=new je.Z,d=0;d<a.length;d++)u.addChild(a[d]);s=u}n.osgjsGeometry=s}},loadImages:function(){var e=this._gltfJSON.images;if(!e)return Te().resolve();for(var t=[],i=0;i<e.length;i++){var n=e[i],r=window.decodeURI(n.uri),a=this.loadURI(r).then(function(e){var t=new xo.Z;t.setImage(e),this.osgjsImage=t}.bind(n));t.push(a)}return Te().all(t)},_texture:function(e){var t=this._gltfJSON.textures,i=this._gltfJSON.images,n=t[e.index],r=i[n.source];if(n.osgjsTexture)return n.osgjsTexture;var a=new Je.Z;if(n.osgjsTexture=a,a.setFlipY(!1),a.setWrapS("REPEAT"),a.setWrapT("REPEAT"),r.osgjsImage){var o=No.TEXTURE_FORMAT[n.format];a.setImage(r.osgjsImage,o)}return a},_pbrMetallicRoughnessTextureUniforms:function(){var e=this._rootStateSet;if(!e.getUniformList()[No.ALBEDO_UNIFORM]){var t=en.Z.createInt(No.ALBEDO_TEXTURE_UNIT,No.ALBEDO_UNIFORM),i=en.Z.createInt(No.METALLIC_ROUGHNESS_TEXTURE_UNIT,No.METALLIC_ROUGHNESS_UNIFORM);e.addUniform(t),e.addUniform(i)}},_pbrMetallicRoughness:function(e,t){var i;if(t.setUserData({pbrWorklow:No.PBR_METAL_MODE}),this._pbrMetallicRoughnessTextureUniforms(),e.baseColorTexture)i=this._texture(e.baseColorTexture),t.setTextureAttributeAndModes(No.ALBEDO_TEXTURE_UNIT,i);else if(e.baseColorFactor){var n=en.Z.createFloat4(e.baseColorFactor,"uBaseColorFactor");t.addUniform(n)}if(void 0!==e.metallicFactor){var r=en.Z.createFloat1(e.metallicFactor,"uMetallicFactor");t.addUniform(r)}if(void 0!==e.roughnessFactor){var a=en.Z.createFloat1(e.roughnessFactor,"uRoughnessFactor");t.addUniform(a)}e.metallicRoughnessTexture&&(i=this._texture(e.metallicRoughnessTexture),t.setTextureAttributeAndModes(No.METALLIC_ROUGHNESS_TEXTURE_UNIT,i))},_KHR_materials_pbrSpecularGlossinessTextureUniforms:function(){if(!this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms){this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms=!0;var e=this._rootStateSet,t=en.Z.createInt(No.DIFFUSE_TEXTURE_UNIT,No.ALBEDO_UNIFORM),i=en.Z.createInt(No.SPECULAR_GLOSSINESS_TEXTURE_UNIT,No.METALLIC_ROUGHNESS_UNIFORM),n=en.Z.createInt(No.SPECULAR_TEXTURE_UNIT,No.SPECULAR_UNIFORM);e.addUniform(t),e.addUniform(i),e.addUniform(n)}},_KHR_materials_pbrSpecularGlossiness:function(e,t){var i,n;if(t.setUserData({pbrWorklow:No.PBR_SPEC_MODE}),this._KHR_materials_pbrSpecularGlossinessTextureUniforms(),e.diffuseTexture?(i=this._texture(e.diffuseTexture),t.setTextureAttributeAndModes(No.DIFFUSE_TEXTURE_UNIT,i)):e.diffuseFactor&&(n=en.Z.createFloat4(e.diffuseFactor,"uBaseColorFactor"),t.addUniform(n)),e.specularFactor&&(n=en.Z.createFloat3(e.specularFactor,"uSpecularFactor"),t.addUniform(n)),void 0!==e.glossinessFactor){var r=en.Z.createFloat(e.glossinessFactor,"uGlossinessFactor");t.addUniform(r)}e.specularGlossinessTexture&&(i=this._texture(e.specularGlossinessTexture),t.setTextureAttributeAndModes(No.SPECULAR_GLOSSINESS_TEXTURE_UNIT,i))},loadMaterials:function(){var e=this._gltfJSON.materials,t=!1,i=!1,n=this._rootStateSet;n.addUniform(en.Z.createInt(No.EMISSIVE_TEXTURE_UNIT,No.EMISSIVE_UNIFORM)),n.addUniform(en.Z.createInt(No.AO_TEXTURE_UNIT,No.AO_UNIFORM)),n.addUniform(en.Z.createInt(No.NORMAL_TEXTURE_UNIT,No.NORMAL_UNIFORM)),n.addUniform(en.Z.createFloat3(o.R3.ZERO,"uEmissiveFactor"));for(var r=0;r<e.length;r++){var a,s=e[r],A=new tn.Z;s.osgjsStateSet=A,s.pbrMetallicRoughness?this._pbrMetallicRoughness(s.pbrMetallicRoughness,A):s.extensions.KHR_materials_pbrSpecularGlossiness&&this._KHR_materials_pbrSpecularGlossiness(s.extensions.KHR_materials_pbrSpecularGlossiness,A),s.normalTexture&&(a=this._texture(s.normalTexture),A.setTextureAttributeAndModes(No.NORMAL_TEXTURE_UNIT,a)),s.occlusionTexture&&(a=this._texture(s.occlusionTexture),A.setTextureAttributeAndModes(No.AO_TEXTURE_UNIT,a)),s.emissiveTexture&&(a=this._texture(s.emissiveTexture),A.setTextureAttributeAndModes(No.EMISSIVE_TEXTURE_UNIT,a)),s.emissiveFactor&&A.addUniform(en.Z.createFloat3(s.emissiveFactor,"uEmissiveFactor")),"BLEND"===s.alphaMode&&(t=!0,A.setAttributeAndModes(this._transparentBlendFunc),A.setRenderingHint("TRANSPARENT_BIN")),s.doubleSided&&(i=!0,A.setAttributeAndModes(this._doubleSideCullFace))}t&&n.setAttributeAndModes(this._defaultBlendFunc),i&&n.setAttributeAndModes(this._defaultCullFace)},_createBone:function(e){var t=this._gltfJSON.nodes[e];t.usedAsBone=!0;var i=this._nodeAnimationTypes,n=new ge.Z,r=t.osgjsNodeName;n.setName(r);var a=this._computeNodeMatrix(t)||o._E.IDENTITY;n.setMatrix(a);var s=new ie.Z;if(s.setName(n.getName()),n.addUpdateCallback(s),i[e]){var A=s.getStackedTransforms();for(var g in i[e]){var h=new(0,No.TYPE_STACKED_TRANSFORMS[g])(g);A.push(h)}}return s.setMatrix(a),n},_createMatrixTransform:function(e){var t=this._gltfJSON.nodes[e],i=this._nodeAnimationTypes,n=new Ve.Z,r=t.osgjsNodeName;n.setName(r);var a=this._computeNodeMatrix(t)||o._E.IDENTITY;if(n.setMatrix(a),i[e]){var s=new ne.Z;s.setName(n.getName()),n.addUpdateCallback(s),s.setMatrix(a);var A=s.getStackedTransforms();for(var g in i[e]){var h=new(0,No.TYPE_STACKED_TRANSFORMS[g])(g);A.push(h)}}return n},_processSkin:function(e){var t,i=this._gltfJSON.skins,n=this._gltfJSON.nodes,r=i[e],a=r.joints;void 0!==r.inverseBindMatrices&&(t=this._gltfJSON.accessors[r.inverseBindMatrices].data.getElements().buffer);var o,s=new le.Z;r.osgjsNode=s,s.setName("skin ID "+e);for(var A,g={},h={},c=0;c<a.length;c++){if(o=a[c],A=this._createBone(o),void 0!==r.inverseBindMatrices){var l=new Float32Array(t,16*c*4,16);A.setInvBindMatrixInSkeletonSpace(l)}g[o]=A,h[A.getName()]=c}for(var u in r.osgjsBoneMapID=h,g){var d=n[u].parent;if(A=g[u],void 0===d||-1===a.indexOf(d))s.addChild(A);else g[d].addChild(A)}},loadAnimations:function(){var e=this._gltfJSON.animations;if(e){for(var t=this._gltfJSON.accessors,i=this._nodeAnimationTypes,n=this._gltfJSON.nodes,r=this._gltfJSON.meshes,a=[],o=0;o<e.length;o++){for(var s=e[o].channels,A=e[o].samplers,g=[],h=0;h<s.length;h++){var c=s[h],l=A[c.sampler],u=t[l.input].data.getElements(),d=t[l.output],I=d.data.getElements(),C=c.target,f=No.TYPE_CHANNEL_PATH[C.path][d.type],p=void 0!==C.node?C.node:C.id,m=n[p],_=C.path,E=n[p].osgjsNodeName;if("weights"===_)for(var v=r[m.mesh],S=v.primitives[0].targets.length,B=u.length,y=0;y<S;y++){for(var M=new Float32Array(B),D=0;D<B;D++)M[D]=I[D*S+y];E=this._getMorphTargetName(v,y),g.push(f(M,u,E,y))}else g.push(f(I,u,E,_));i[p]||(i[p]={}),i[p][_]=!0}var b="animation-"+o.toString();a.push(w.createAnimation(g,b))}var Q=new Ae;Q.init(a),this._animationManager=Q}},loadURI:Te().method((function(e,t){if("data:"===e.substr(0,5))return function(e){for(var t=window.atob(e),i=t.length,n=new Uint8Array(i),r=0;r<i;r++)n[r]=t.charCodeAt(r);return n.buffer}(e);var i=this._filesMap[e];return void 0!==i?i:tt.Z.requestURI(e,t)})),readNodeURL:function(e,t){var i=this;if(this.init(),t&&void 0!==t.filesMap&&Object.keys(t.filesMap).length>0){this._filesMap=t.filesMap;var n=this._filesMap[e];return this.readJSON(n,e)}var r=e.lastIndexOf("/");return this._localPath=-1===r?"":e.substr(0,r+1),tt.Z.requestURI(e).then((function(e){return i.readJSON(e)}))},readJSON:Te().method((function(e,t){return this._gltfJSON=e,Te().all([this.loadBuffers(),this.loadImages()]).then(function(){this.loadBufferViews(),this.loadAccessors(),this._preProcessNodes(),this.loadMaterials(),this.loadMeshes(),this.loadAnimations(),this.loadSkins(),this.loadNodes(),this.loadScenes();var e=new Ve.Z;return e.addChild(this._osgjsScene[0]),e.setName(t),this._animationManager&&e.addUpdateCallback(this._animationManager),e.setStateSet(this._rootStateSet),e}.bind(this))}))},et.Z.instance().addReaderWriter("gltf",new No);const Lo=No;var ko=window.JSZip,Po=function(){this._options=void 0,this._filesMap={},this._fileName=""};Po.prototype={readNodeURL:function(e,t){if(void 0===ko)return R.Z.error("You need to add JSZip as a dependency"),Te().reject(this);R.Z.log("starting to read: "+e);var i=this;if(t&&void 0!==t.filesMap&&void 0!==t.filesMap[e]){var n=t.filesMap[e];return this.readZipFile(n).then((function(){return i._fileName?be.Z.readNodeURL(i._fileName,{filesMap:i._filesMap}):Te().reject(i)}))}return tt.Z.requestURI(e,{responseType:"blob"}).then((function(e){i.readZipFile(e).then((function(){return be.Z.readNodeURL(i._fileName,{filesMap:i._filesMap})}))}))},readZipFile:function(e){tt.Z.unzip(e).then(function(e){for(var t in e){var i=tt.Z.getExtension(t);if(void 0!==et.Z.instance().getReaderWriterForExtension(i)||"osgjs"===i){this._fileName=t;break}}}.bind(this))}},et.Z.instance().addReaderWriter("zip",new Po);const Uo=Po;var Oo={};Oo.ReaderWriterGLTF=Lo,Oo.ReaderWriterZIP=Uo;const Go=Oo;var Ho=i("aa6s"),Ko=n.Z;Ko.osg=r.Z,Ko.osgAnimation=Me,Ko.osgDB=at,Ko.osgGA=qi,Ko.osgUtil=mr,Ko.osgViewer=Ka,Ko.osgShader=Za.Z,Ko.osgShadow=wo,Ko.osgStats=yo,Ko.osgText=Do,Ko.osgWrappers=Qo,Ko.osgPlugins=Go,Ko.InputGroups=Ka.InputGroups,Ko.globalify=function(){window.osg=Ko.osg,window.osgAnimation=Ko.osgAnimation,window.osgDB=Ko.osgDB,window.osgGA=Ko.osgGA,window.osgUtil=Ko.osgUtil,window.osgViewer=Ko.osgViewer,window.osgShader=Ko.osgShader,window.osgShadow=Ko.osgShadow,window.osgStats=Ko.osgStats,window.osgText=Ko.osgText,window.osgWrappers=Ko.osgWrappers,window.osgPlugins=Ko.osgPlugins,window.InputGroups=Ko.InputGroups},(0,Ho.c)(Ko);const Zo=Ko;(0,i("6y3v").Z)(),X.Z.EFFECTIVE_EPS=(0,La.Z)().morphEpsilon;const Vo=Zo},XkCy:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n=i("aqzA"),r=n.Z.osg,a=function(){r.ComputeBoundsVisitor.call(this),this._minBox=new r.BoundingBox,this._visitedBuffers={}};r.createPrototypeObject(a,r.objectInherit(r.ComputeBoundsVisitor.prototype,{getPreciseBox:function(){return this._minBox},apply:function(e){if(e instanceof r.Transform)this.applyTransform(e);else{if(e instanceof r.Geometry){var t=this._matrixStack.getLength()>0?this._matrixStack.back():r.mat4.IDENTITY,i=e.getVertexAttributeList().Vertex,n=this._visitedBuffers[i.getInstanceID()];if(n&&r.mat4.exactEquals(n.matrix,t))return;var a=e.computeTransformedVertices?e.computeTransformedVertices():i.getElements();this._visitedBuffers[i.getInstanceID()]={buffer:a,matrix:r.mat4.copy(r.mat4.create(),t)};for(var o=t[0],s=t[1],A=t[2],g=t[3],h=t[4],c=t[5],l=t[6],u=t[7],d=t[8],I=t[9],C=t[10],f=t[11],p=t[12],m=t[13],_=t[14],E=t[15],v=this._minBox.getMin(),S=this._minBox.getMax(),B=v[0],w=v[1],y=v[2],M=S[0],D=S[1],b=S[2],Q=0,x=a.length;Q<x;Q+=3){var T=a[Q],F=a[Q+1],R=a[Q+2],N=g*T+u*F+f*R+E||1,L=(o*T+h*F+d*R+p)/N,k=(s*T+c*F+I*R+m)/N,P=(A*T+l*F+C*R+_)/N;L<B&&(B=L),k<w&&(w=k),P<y&&(y=P),L>M&&(M=L),k>D&&(D=k),P>b&&(b=P)}return v[0]=B,v[1]=w,v[2]=y,S[0]=M,S[1]=D,void(S[2]=b)}this.traverse(e)}}}));const o=a;var s,A,g=i("QG/p"),h=n.Z.osg,c=0,l=new g.Z;const u={BIAS_MIN:.9,BIAS_MAX:1.1,getBoxReady:function(){return l.promise},updateMaxWorldDisplacement:function(e){e<=c||(c=e,this._updateModelBoxes())},getModelBoxWithDisplacement:function(){return s},getModelBoxWithoutDisplacement:function(){return A},_updateModelBoxes:function(){if(s&&0!==c){var e=s.getMin(),t=s.getMax(),i=h.vec3.fromValues(c,c,c);h.vec3.add(t,t,i),h.vec3.sub(e,e,i)}},computePreciseBox:function(e){var t=new o;e.accept(t),A=t.getPreciseBox(),(s=new h.BoundingBox).copy(A),this._updateModelBoxes(),l.resolve()},getMaxDistanceFromOrigin:function(){var e=h.vec3.length(A.getMin()),t=h.vec3.length(A.getMax());return Math.max(e,t)}}},"QR/4":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i("X9mO"),r=i("lqp/"),a=i("aqzA").Z.osg,o=function(e){this._model=void 0!==e?e.model:void 0,this._viewer=void 0!==e?e.viewer:void 0,this._scene=void 0!==e?e.scene:void 0,this._widgetAPI=void 0!==e?e.widgetAPI:void 0,this._features={}};o.prototype={getModel:function(){return this._model},getFeatures:function(){return this._features},getViewer:function(){return this._viewer},getScene:function(){return this._scene},getWidgetAPI:function(){return this._widgetAPI},addFeature:function(e){if(e){var t=e.getName();this._features[t]?a.error("Feature already added"+t):this._features[t]=e}return this._features},getModelByName:function(e){if(e){var t=(0,n.Z)(this._features,(function(t){var i=t.getModel();return!(!i||!i.getName)&&i.getName()===e}));return t?t.getModel():void 0}},getViewsByName:function(e){if(e){var t=[];return(0,r.Z)(this._features,(function(i){if(i){var n=i._views.filter((function(t){return!!t.getName&&t.getName()===e}));Array.prototype.push.apply(t,n)}})),t}}};const s=o},GhWR:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i("aqzA"),r=i("gvzH"),a=i("ZmEo"),o=i("XkCy"),s=i("MQQR"),A=n.Z.osg,g=function(){A.CullVisitor.call(this),this._separateVR=!1,this._isEnv=!1,this._isRootModel=!1},h=g.vrConfig={doVR:!1,framebufferWidth:0,framebufferHeight:0,leftRenderWidth:0,rightRenderWidth:0,leftRenderHeight:0,rightRenderHeight:0,rightProjection:A.mat4.create(),leftProjection:A.mat4.create(),leftOffsetView:A.mat4.create(),rightOffsetView:A.mat4.create()};g.cameraMain=void 0,g.cameraEnvironment=void 0,g.nodePostProcessOut=void 0,g.nodeRootModel=void 0,A.createPrototypeObject(g,A.objectInherit(A.CullVisitor.prototype,{popCameraModelViewProjectionMatrix:function(e){this.popModelViewMatrix(),this.popProjectionMatrix(e)},reset:function(){A.CullVisitor.prototype.reset.call(this),this._minNear=this._computedNear,this._maxFar=this._computedFar},updateNearFar:function(){this._minNear=Math.min(this._minNear,this._computedNear),this._maxFar=Math.max(this._maxFar,this._computedFar)},_handleMainCamera:function(e){var t=this.getCurrentProjectionMatrix(),i=this._computedNear,n=this._computedFar,r=this._nearFarRatio,o=this._projectionMatrixStack.getArray()[0];A.mat4.copy(o,t),this.clampProjectionMatrix(o,this._minNear,this._maxFar,1e-5),h.doVR&&(this.clampProjectionMatrix(h.leftProjection,i,n,r),this.clampProjectionMatrix(h.rightProjection,i,n,r));var s=a.Z.uNearFar.getInternalArray(),g=a.Z.uPreviousNearFar.getInternalArray();g[0]=s[0],g[1]=s[1],this.clampProjectionMatrix(t,i,n,r,s),e.clampedProjectionMatrix?A.mat4.copy(e.clampedProjectionMatrix,t):e.clampedProjectionMatrix=A.mat4.clone(t)},popProjectionMatrix:function(e){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var t=e===g.cameraMain;(t||e.getReferenceFrame()===A.Transform.RELATIVE_RF&&!e.isRenderToTextureCamera())&&this.updateNearFar(),t?this._handleMainCamera(e):this.clampProjectionMatrix(this.getCurrentProjectionMatrix(),this._computedNear,this._computedFar,this._nearFarRatio)}A.CullStack.prototype.popProjectionMatrix.call(this)},handleCullCallbacksAndTraverse:function(e){e===g.nodePostProcessOut?this._separateVR=h.doVR:e===g.cameraEnvironment?this._isEnv=!0:e===g.nodeRootModel&&(this._isRootModel=!0);var t=e.getCullCallback();t&&!t.cull(e,this)||this.traverse(e),e===g.nodePostProcessOut?this._separateVR=!1:e===g.cameraEnvironment?this._isEnv=!1:e===g.nodeRootModel&&(this._isRootModel=!1)},pushLeaf:function(e,t){var i=this._currentStateGraph._leafs;0===i.getLength()&&this._currentRenderBin.addStateGraph(this._currentStateGraph);var n=this._separateVR&&this.traversalMask!==r.Z.SHADOW,a=this.createOrReuseRenderLeaf();if(a.isVR=n,n){var o=this._isEnv,s=this.getCurrentModelViewMatrix(),g=this.getCurrentViewMatrix();a.leftProjection=h.leftProjection,a.rightProjection=h.rightProjection;var c=a.leftModelView||A.mat4.create(),l=a.rightModelView||A.mat4.create();a.leftModelView=o?A.mat4.copy(c,s):A.mat4.multiply(c,h.leftOffsetView,s),a.rightModelView=o?A.mat4.copy(l,s):A.mat4.multiply(l,h.rightOffsetView,s);var u=a.leftView||A.mat4.create(),d=a.rightView||A.mat4.create();a.leftView=o?A.mat4.copy(u,g):A.mat4.multiply(u,h.leftOffsetView,g),a.rightView=o?A.mat4.copy(d,g):A.mat4.multiply(d,h.rightOffsetView,g)}a.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),i.push(a)},updateCalculatedNearFar:function(e,t){var i=o.Z.getModelBoxWithoutDisplacement();if(i&&this._isRootModel){var n=(0,s.Z)().scaleEpsilon*i.radius()/t.getBound().radius();n*=n;var r=e[0],a=e[4],g=e[8];if(r*r+a*a+g*g<n&&(r=e[1])*r+(a=e[5])*a+(g=e[9])*g<n&&(r=e[2])*r+(a=e[6])*a+(g=e[10])*g<n)return!1}return A.CullVisitor.prototype.updateCalculatedNearFar.call(this,e,t)}}),"osgSketchfab","CullVisitor");const c=g},tEGF:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i("k46e"),r=function(e){this._views=[],e&&(this._name=e.FeatureName,this._modelName=e.ModelName,this._modelType=e.ModelType,this._viewListType=e.ViewListType.slice(0))};r.prototype={getName:function(){return this._name},getModel:function(){return this._model},addView:function(e){e&&this._views.push(e)},init:function(e){if(this._model||(this._model=e.getModelByName(this._modelName)),!this._model){var t=this._modelType;this._model=new t,this._model.init&&this._model.init(e)}var i=function(t){var i=new t({model:this._model,context:e});this.addView(i)};this._viewListType.forEach((function(e){i.call(this,e)}),this),e.addFeature(this)},prepareForScreenShot:function(){var e=this.getWidgetNode();return!(!e||!e.getNodeMask())&&(this._oldMaskEditorWidget=e.getNodeMask(),e.setNodeMask(0),!0)},resetAfterScreenShot:function(){var e=this.getWidgetNode();e&&e.setNodeMask(this._oldMaskEditorWidget)},getWidgetNode:function(){}},r.create=function(e){var t=function(){r.call(this,t)};return t.prototype=(0,n.Z)({},r.prototype),(0,n.Z)(t,e),t.getName=function(){return e.FeatureName},t};const a=r},UYGi:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i("R4My"),r=i.n(n),a=i("aqzA");const o=JSON.parse('{"$schema":"http://json-schema.org/draft-04/schema#","id":"http://sketchfab.com/schema/modeloptions","title":"Camera settings","description":"Camera position and direction","type":"object","definitions":{"vec2":{"type":"array","minItems":2,"maxItems":2,"items":{"type":"number"}},"vec3":{"type":"array","minItems":3,"maxItems":3,"items":{"type":"number"}},"intVec3":{"type":"array","minItems":3,"maxItems":3,"items":{"type":"integer"}},"vec4":{"type":"array","minItems":4,"maxItems":4,"items":{"type":"number"}},"matrix":{"type":"array","minItems":16,"maxItems":16,"items":{"type":"number"}},"quaternion":{"type":"array","minItems":4,"maxItems":4,"items":{"type":"number"}},"unitVec3":{"type":"array","minItems":3,"maxItems":3,"items":{"$ref":"#/definitions/unitNumber"}},"unitVec3Neg":{"type":"array","minItems":3,"maxItems":3,"items":{"$ref":"#/definitions/unitNumberNeg"}},"unitVec2Neg":{"type":"array","minItems":2,"maxItems":2,"items":{"$ref":"#/definitions/unitNumberNeg"}},"unitVec4":{"type":"array","minItems":4,"maxItems":4,"items":{"$ref":"#/definitions/unitNumber"}},"unitNumber":{"type":"number","minimum":0,"maximum":1},"unitNumberNeg":{"type":"number","minimum":-1,"maximum":1},"uid":{"type":"string","pattern":"^[A-Fa-f0-9]{32}$"},"uuid":{"type":"string","pattern":"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$"},"hotspotData":{"type":"object","properties":{"geometryUid":{"type":"integer"},"uid":{"$ref":"#/definitions/uid"},"indices":{"$ref":"#/definitions/intVec3"},"barycentricWeights":{"$ref":"#/definitions/vec3"},"localPosition":{"$ref":"#/definitions/vec3"}},"additionalProperties":false,"required":["uid","geometryUid","indices","barycentricWeights","localPosition"]},"soundtrack":{"type":"object","properties":{"uid":{"$ref":"#/definitions/uid"},"name":{"type":"string","default":""},"enable":{"type":"boolean","default":true},"position":{"$ref":"#/definitions/vec3","default":[0,0,0]},"distance":{"type":"number","minimum":0,"default":-1},"distanceMax":{"type":"number","minimum":0,"default":-1},"distanceModel":{"type":"string","default":"exponential"},"startTime":{"type":"number","minimum":0,"default":0},"volume":{"type":"number","minimum":0,"default":1},"ambient":{"type":"boolean","default":true},"loop":{"type":"boolean","default":false},"snap":{"type":"boolean","default":false},"sync":{"type":"boolean","default":false},"geometryUid":{"type":"integer","default":-1},"indices":{"$ref":"#/definitions/intVec3","default":[-1,-1,-1]},"barycentricWeights":{"$ref":"#/definitions/vec3","default":[0,0,0]},"localPosition":{"$ref":"#/definitions/vec3","default":[0,0,0]}},"required":["uid","name","enable","position","distance","distanceMax","distanceModel","startTime","volume","ambient","loop","snap","sync","geometryUid","indices","barycentricWeights","localPosition"],"additionalProperties":false},"light":{"type":"object","properties":{"type":{"type":"string","enum":["NONE","DIRECTION","POINT","SPOT","HEMI"],"default":"NONE"},"enable":{"type":"boolean","default":true},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"intensity":{"type":"number","minimum":0,"default":1},"ground":{"$ref":"#/definitions/unitVec3","default":[0.3,0.2,0.2]},"intensityGround":{"type":"number","minimum":0,"default":1},"matrix":{"$ref":"#/definitions/matrix"},"falloff":{"type":"number","minimum":0,"default":-1},"attachedToCamera":{"type":"boolean","default":false},"angle":{"type":"number","minimum":0,"maximum":90,"default":45},"hardness":{"$ref":"#/definitions/unitNumber","default":0.5},"castShadows":{"type":"boolean","default":true},"shadowBias":{"$ref":"#/definitions/unitNumber","default":0.005}},"required":["type","enable","color","intensity","ground","intensityGround","matrix","falloff","attachedToCamera","angle","hardness","castShadows","shadowBias"],"additionalProperties":false},"texture":{"type":"object","properties":{"internalFormat":{"type":"string","enum":["RGB","ALPHA","LUMINANCE"]},"magFilter":{"type":"string","enum":["LINEAR","NEAREST"]},"minFilter":{"type":"string","enum":["LINEAR","NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR"]},"textureTarget":{"type":"string","enum":["TEXTURE_2D"]},"uid":{"$ref":"#/definitions/uid"},"wrapS":{"type":"string","enum":["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},"wrapT":{"type":"string","enum":["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},"texCoordUnit":{"type":"integer","minimum":0}},"required":["internalFormat","magFilter","minFilter","texCoordUnit","textureTarget","uid","wrapS","wrapT"],"additionalProperties":false},"materialChannel":{"type":"object","properties":{"enable":{"type":"boolean"},"factor":{"$ref":"#/definitions/unitNumber"},"color":{"$ref":"#/definitions/unitVec3"},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"oneOf":[{"required":["color"]},{"required":["texture"]}],"required":["enable","factor"],"additionalProperties":false},"materialChannelGrayScale":{"type":"object","properties":{"enable":{"type":"boolean"},"factor":{"$ref":"#/definitions/unitNumber"},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor"],"additionalProperties":false},"cullFace":{"type":"string","enum":["DISABLE","BACK"]},"uvTransforms":{"type":"object","properties":{"scale":{"$ref":"#/definitions/vec2","default":[1,1]},"rotation":{"type":"number","minimum":-6.2831853072,"maximum":6.2831853072,"default":0},"offset":{"$ref":"#/definitions/unitVec2Neg","default":[0,0]}},"required":["scale","rotation","offset"],"additionalProperties":false}},"properties":{"version":{"type":"integer","minimum":0},"background":{"type":"object","properties":{"enable":{"type":"string","enum":["fixed","environment","color","ambient","none"],"default":"color"},"uid":{"$ref":"#/definitions/uid","default":"51af6a870cce449eb75b0345feebaebb"},"color":{"$ref":"#/definitions/unitVec3","default":[0.86667,0.86667,0.86667]}},"additionalProperties":false,"required":["enable","uid","color"]},"lighting":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"lights":{"type":"array","minItems":3,"maxItems":3,"items":{"$ref":"#/definitions/light"},"additionalItems":false}},"additionalProperties":false,"required":["lights","enable"]},"camera":{"type":"object","properties":{"position":{"$ref":"#/definitions/vec3"},"target":{"$ref":"#/definitions/vec3"},"fov":{"type":"number","minimum":0,"maximum":180,"default":45},"nearFarRatio":{"type":"number","minimum":0.0001,"maximum":0.005,"default":0.005},"useCameraConstraints":{"type":"boolean","default":false},"usePanConstraints":{"type":"boolean","default":true},"useZoomConstraints":{"type":"boolean","default":false},"usePitchConstraints":{"type":"boolean","default":false},"useYawConstraints":{"type":"boolean","default":false},"zoomIn":{"type":"number","minimum":0,"default":0},"zoomOut":{"type":"number","minimum":0,"default":-1},"left":{"type":"number","minimum":-3.141593,"maximum":3.141593,"default":-3.141593},"right":{"type":"number","minimum":-3.141593,"maximum":3.141593,"default":3.141593},"up":{"type":"number","minimum":-1.570797,"maximum":1.570797,"default":1.555089},"down":{"type":"number","minimum":-1.570797,"maximum":1.570797,"default":-1.555089}},"additionalProperties":false,"required":["position","target","fov","nearFarRatio","useCameraConstraints","usePanConstraints","useZoomConstraints","usePitchConstraints","useYawConstraints","zoomIn","zoomOut","left","right","up","down"]},"environment":{"type":"object","properties":{"enable":{"type":"boolean"},"backgroundExposure":{"type":"number","minimum":0,"maximum":2,"default":1},"exposure":{"type":"number","minimum":0,"maximum":35},"rotation":{"type":"number","minimum":0,"maximum":6.2831853072,"default":0},"uid":{"$ref":"#/definitions/uid"},"blur":{"type":"number","minimum":0,"maximum":1,"default":0.1},"shadowEnable":{"type":"boolean"},"lightIntensity":{"type":"number","minimum":0,"default":1},"shadowBias":{"type":"number","minimum":0,"default":0.005}},"additionalProperties":false,"required":["enable","backgroundExposure","exposure","rotation","uid","blur","shadowEnable","lightIntensity","shadowBias"]},"materials":{"type":"object","patternProperties":{"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$":{"type":"object","properties":{"channels":{"type":"object","properties":{"AlphaMask":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"invert":{"type":"boolean","default":false},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor","invert"],"additionalProperties":false},"Opacity":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"type":{"type":"string","enum":["alphaBlend","additive","dithering","refraction"],"default":"alphaBlend"},"invert":{"type":"boolean","default":false},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"ior":{"type":"number","minimum":1,"maximum":2,"default":1.05},"roughnessFactor":{"$ref":"#/definitions/unitNumber","default":0},"useMicrosurfaceTexture":{"type":"boolean","default":true},"useNormalOffset":{"type":"boolean","default":false},"useAlbedoTint":{"type":"boolean"},"thinLayer":{"type":"boolean","default":false},"refractionColor":{"$ref":"#/definitions/unitVec3","default":[1,1,1]}},"required":["enable","factor","type","invert","ior","roughnessFactor","useMicrosurfaceTexture","useAlbedoTint","useNormalOffset","refractionColor","thinLayer"],"additionalProperties":false},"SpecularHardness":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"type":"number","minimum":0,"maximum":10000,"default":12.5},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor"],"additionalProperties":false},"BumpMap":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":10,"default":1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor"],"additionalProperties":false},"Displacement":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"default":0},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor"],"additionalProperties":false},"SubsurfaceTranslucency":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"thicknessFactor":{"type":"number","minimum":0,"default":-1},"color":{"$ref":"#/definitions/unitVec3","default":[1,0.37,0.3]},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor","thicknessFactor","color"],"additionalProperties":false},"EmitColor":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":10,"default":0},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"type":{"type":"string","enum":["additive","multiplicative"],"default":"additive"}},"oneOf":[{"required":["color"]},{"required":["texture"]}],"required":["enable","factor","type"],"additionalProperties":false},"SubsurfaceScattering":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"default":-1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"profile":{"type":"integer","minimum":1,"maximum":3,"default":1}},"required":["enable","factor","profile"],"additionalProperties":false},"NormalMap":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"flipY":{"type":"boolean","default":true}},"required":["enable","factor","flipY"],"additionalProperties":false},"AOPBR":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"occludeSpecular":{"type":"boolean","default":false}},"required":["enable","factor","occludeSpecular"],"additionalProperties":false},"Matcap":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"$ref":"#/definitions/unitNumber","default":1},"curvature":{"type":"number","minimum":0,"default":0},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["texture","color","curvature","enable","factor"],"additionalProperties":false},"ClearCoat":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"tint":{"$ref":"#/definitions/unitVec3","default":[0.914,0.914,0.914]},"thickness":{"type":"number","minimum":0,"maximum":20,"default":5},"reflectivity":{"$ref":"#/definitions/unitNumber","default":0},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"required":["enable","factor","tint","thickness","reflectivity"],"additionalProperties":false},"ClearCoatNormalMap":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"flipY":{"type":"boolean","default":true}},"required":["enable","factor","flipY"],"additionalProperties":false},"ClearCoatRoughness":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.04,"enable":true}},"DiffuseColor":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"DiffuseIntensity":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"SpecularColor":{"$ref":"#/definitions/materialChannel","default":{"color":[0.5,0.5,0.5],"factor":0,"enable":true}},"DiffusePBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":false}},"AlbedoPBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"SpecularPBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":0.05,"enable":false}},"GlossinessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.4,"enable":false}},"RoughnessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.6,"enable":true}},"MetalnessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0,"enable":true}},"Sheen":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"colorFactor":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"additionalProperties":false,"required":["enable","factor","colorFactor"]},"SheenRoughness":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"}},"additionalProperties":false,"required":["enable","factor"]},"SpecularF0":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.5,"enable":true}},"CavityPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":1,"enable":false}},"Anisotropy":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"direction":{"$ref":"#/definitions/unitNumberNeg","default":0},"texture":{"$ref":"#/definitions/texture"},"UVTransforms":{"$ref":"#/definitions/uvTransforms"},"flipXY":{"type":"boolean","default":true}},"additionalProperties":false,"required":["enable","factor","direction","flipXY"]}},"required":["DiffuseColor","DiffuseIntensity","EmitColor","NormalMap","BumpMap","Displacement","Opacity","SpecularColor","SpecularHardness","DiffusePBR","AlbedoPBR","SpecularPBR","GlossinessPBR","RoughnessPBR","MetalnessPBR","Sheen","SheenRoughness","SpecularF0","AOPBR","CavityPBR","Matcap","SubsurfaceScattering","SubsurfaceTranslucency","ClearCoat","ClearCoatRoughness","ClearCoatNormalMap","Anisotropy","AlphaMask"],"additionalProperties":false},"cullFace":{"$ref":"#/definitions/cullFace","default":"DISABLE"},"id":{"$ref":"#/definitions/uuid","default":"0"},"name":{"type":"string","default":"noname"},"reflection":{"$ref":"#/definitions/unitNumber","default":0.3},"shadeless":{"type":"boolean","default":false},"stateSetID":{"type":"integer","default":0},"version":{"type":"integer","minimum":2}},"required":["channels","cullFace","id","name","reflection","shadeless","stateSetID","version"],"additionalProperties":false}},"properties":{"updatedAt":{"type":"integer"}},"additionalProperties":false},"orientation":{"type":"object","properties":{"matrix":{"$ref":"#/definitions/matrix","default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},"additionalProperties":false,"required":["matrix"]},"scene":{"type":"object","properties":{"sssProfiles":{"type":"array","minItems":3,"maxItems":3,"additionalItems":false,"items":[{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.48,0.41,0.28]},"falloff":{"$ref":"#/definitions/unitVec3","default":[1,0.37,0.3]}},"additionalProperties":false,"required":["strength","falloff"]},{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.38,0.61,0.68]},"falloff":{"$ref":"#/definitions/unitVec3","default":[0.5,0.67,0.6]}},"additionalProperties":false,"required":["strength","falloff"]},{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.88,0.61,0.28]},"falloff":{"$ref":"#/definitions/unitVec3","default":[0.7,0.77,0.3]}},"additionalProperties":false,"required":["strength","falloff"]}]},"postProcess":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"grain":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"animated":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":0.5,"default":0.15}},"additionalProperties":false,"required":["enable","animated","factor"]},"sharpen":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":5,"default":0.2}},"additionalProperties":false,"required":["enable","factor"]},"chromaticAberration":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":0.1,"default":0.05}},"additionalProperties":false,"required":["enable","factor"]},"vignette":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"amount":{"$ref":"#/definitions/unitNumber","default":0.475},"hardness":{"$ref":"#/definitions/unitNumber","default":0.725}},"additionalProperties":false,"required":["enable","amount","hardness"]},"bloom":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":2,"default":0.5},"threshold":{"$ref":"#/definitions/unitNumber","default":0},"radius":{"$ref":"#/definitions/unitNumber","default":0.7}},"additionalProperties":false,"required":["enable","factor","threshold","radius"]},"toneMapping":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"method":{"type":"string","enum":["default","reinhard","filmic"],"default":"default"},"exposure":{"type":"number","minimum":0,"maximum":2,"default":1},"brightness":{"type":"number","minimum":-1,"maximum":1,"default":0},"contrast":{"type":"number","minimum":-1,"maximum":1,"default":0},"saturation":{"type":"number","minimum":0,"maximum":2,"default":1}},"additionalProperties":false,"required":["enable","method","exposure","brightness","contrast","saturation"]},"colorBalance":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"low":{"$ref":"#/definitions/unitVec3Neg"},"mid":{"$ref":"#/definitions/unitVec3Neg"},"high":{"$ref":"#/definitions/unitVec3Neg"}},"additionalProperties":false,"required":["enable","low","mid","high"]},"dof":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"blurNear":{"$ref":"#/definitions/unitNumber","default":0.5},"blurFar":{"$ref":"#/definitions/unitNumber","default":0.5},"focusPoint":{"$ref":"#/definitions/vec3"}},"additionalProperties":false,"required":["enable","blurNear","blurFar","focusPoint"]},"ssr":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1}},"additionalProperties":false,"required":["enable","factor"]},"ssao":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"radius":{"type":"number","minimum":0,"default":-1},"intensity":{"type":"number","minimum":0,"maximum":1,"default":0.5},"bias":{"type":"number","minimum":0,"default":-1}},"additionalProperties":false,"required":["enable","radius","intensity","bias"]},"taa":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"transparent":{"type":"boolean","default":true}},"additionalProperties":false,"required":["enable","transparent"]}},"additionalProperties":false,"required":["enable","grain","sharpen","chromaticAberration","vignette","bloom","toneMapping","colorBalance","dof","ssr","ssao","taa"]}},"additionalProperties":false,"required":["sssProfiles","postProcess"]},"shading":{"type":"object","properties":{"renderer":{"type":"string","enum":["classic","pbr"],"default":"classic"},"type":{"type":"string","enum":["lit","shadeless","matcap"],"default":"lit"},"vertexColor":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"useAlpha":{"type":"boolean","default":true},"colorSpace":{"type":"string","enum":["linear","srgb"],"defaul":"srgb"}},"additionalProperties":false,"required":["enable","useAlpha","colorSpace"]},"pointSize":{"type":"number","minimum":0,"maximum":50,"default":0}},"additionalProperties":false,"required":["renderer","type","vertexColor","pointSize"]},"wireframe":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"color":{"type":"string","pattern":"^[A-Fa-f0-9]{8}$","default":"000000FF"}},"additionalProperties":false,"required":["enable","color"]},"animation":{"type":"object","properties":{"order":{"type":"array","items":{"type":"string"}},"speed":{"type":"number","default":1},"cycleMode":{"type":"string","enum":["one","all","none"],"default":"one"},"initializeWithRestPose":{"type":"boolean","default":false}},"additionalProperties":false,"required":["order","speed","cycleMode","initializeWithRestPose"]},"hotspot":{"type":"object","properties":{"hotspots":{"type":"array","items":{"$ref":"#/definitions/hotspotData"}},"visible":{"type":"boolean"}},"additionalProperties":false,"required":["hotspots","visible"]},"vr":{"type":"object","properties":{"worldFactor":{"type":"number","minimum":0,"default":-1},"floorHeight":{"type":"number","default":0},"displayFloor":{"type":"boolean","default":true},"initialCamera":{"type":"object","properties":{"position":{"$ref":"#/definitions/vec3","default":[0,0,0]},"rotation":{"$ref":"#/definitions/vec4","default":[0,0,0,1]}},"additionalProperties":false,"required":["position","rotation"]}},"additionalProperties":false,"required":["worldFactor","initialCamera","floorHeight","displayFloor"]},"sound":{"type":"object","properties":{"soundtracks":{"type":"array","minItems":0,"maxItems":32,"items":{"$ref":"#/definitions/soundtrack"},"additionalItems":false}},"additionalProperties":false,"required":["soundtracks"]},"ground":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"opacity":{"type":"number","default":1},"fade":{"type":"number","default":0.25},"position":{"$ref":"#/definitions/vec3"},"scale":{"type":"number","default":-1,"minimum":0},"shadowMode":{"type":"string","enum":["ShadowCatcher","BakedAO"],"default":"ShadowCatcher"},"samplingRange":{"type":"number","default":0.6},"aoTextureUid":{"$ref":"#/definitions/uid"}},"additionalProperties":false,"required":["enable","opacity","fade","position","scale","shadowMode","samplingRange"]}}}');var s=i("h4+f"),A=i.n(s),g=i("QX1t"),h=i("FqYX"),c=a.Z.osg,l=(0,g.Z)(a.Z.osg.CullFace),u=r().Model;const d=u.extend({initialize:function(){if(u.prototype.initialize.apply(this,arguments),this._featureSchema=this.getSubSchema(this.getModelOptionPath()),this._featureSchema){this._typeMap={},this._buildTypeMap(this._featureSchema,this._typeMap);var e=this.getInstance();this.initDefaults(e)}},getModelOptionPath:function(){return""},getSubSchema:function(e,t){for(void 0===t&&(t=!0),e=e?0===e.indexOf("#")?e.substring(2).replace(/\//g,"."):"properties."+e.replace(/\./g,".properties."):"properties";e.indexOf(":")>0;){var i=e.split(":"),n=this._getAttribute(o,i[0]);if(n.patternProperties){var r=i[1].indexOf(".");r<0&&(r=i[1].length);var a=i[1].substring(0,r),s=Object.keys(n.patternProperties)[a];e=e.replace(":"+a,".patternProperties."+s)}}var A=this._getAttribute(o,e);if(A&&t)if(0===e.indexOf("definition")){A.definitions=(0,h.Z)({},o.definitions);var g=e.split(".");g=g[g.length-1],delete A.definitions[g]}else A.definitions=o.definitions;return A},_getAttribute:function(e,t){for(var i=t.split(".");i.length&&(e=e[i.shift()]););return e},getInstance:function(e){return e||(e=this._featureSchema),this._instantiateFromSchema(e)},_getRequiredFields:function(e){var t=e.required?e.required.slice():void 0;return e.oneOf&&e.oneOf.length&&e.oneOf[0].required&&e.oneOf[0].required.length&&t.push(e.oneOf[0].required[0]),t},_instantiateFromSchema:function(e){if("object"===e.type){var t={},i=this._getRequiredFields(e);for(var n in e=e.properties?e.properties:e)if(!(i&&i.indexOf(n)<0)){var r=e[n];t[n]=this._instantiateAttribute(r)}return t}return this._instantiateAttribute(e)},_instantiateAttribute:function(e){var t=e.default;if(e.$ref){var i=e.$ref,n=this.getSubSchema(i,!1),r=this._instantiateFromSchema(n);return t&&("object"==typeof t?(0,h.Z)(r,t):r=t),r}if(e.type){if(t&&"array"!==e.type)return t;switch(e.type){case"object":return this._instantiateFromSchema(e);case"array":var a;if(a=e.minItems?new Array(e.minItems):[],e.items)for(var o=e.items,s=0;s<a.length;s++)Array.isArray(e.items)&&(o=e.items[Object.keys(e.items)[s]]),a[s]=this._instantiateFromSchema(o);return a;case"number":case"integer":return 0;case"boolean":return!1;case"string":return e.enum?e.enum[0]:""}}},validate:function(e,t){var i=this._validator,n=t&&t.schema||this._featureSchema;i||(i=new(A())({allErrors:!0,removeAdditional:!0}).compile(n),this._validator=i);var r,a=[];if(i(e))return a;for(var o=0;o<i.errors.length;o++){var s,g=i.errors[o],h=g.instancePath.substring(1);if(h.indexOf("]")>=0&&(h=h.replace(/]/g,"")),"type"===g.keyword){if(null==(s=this._getAttribute(e,h)))continue;if(r=s,Array.isArray(r)||r instanceof Int8Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Int16Array||r instanceof Uint16Array||r instanceof Int32Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array)continue}"pattern"===g.keyword&&(s=this._getAttribute(e,h),-1!==h.indexOf("texture.uid")&&-1!==s.indexOf("tmp_"))||"required"!==g.keyword&&a.push(this._formatErrorMessage(g,h,t))}return a},_formatErrorMessage:function(e,t,i){var n;i&&i.context&&(n=i.context);var r=n?n+": ":"";if(r+=t.length?'"'+t+'" ':"",r+=e.message,"enum"===e.keyword){r+=": ";for(var a=0;a<e.params.allowedValues.length;a++){r+=e.params.allowedValues[a]+", "}}else"additionalProperties"===e.keyword&&(r+=" ("+e.params.additionalProperty+")");return r},setJSON:function(e,t){if(!this._featureSchema)return["Json Schema not initialized"];this._adaptJSON&&this._adaptJSON(e);var i,n=t||{};if(n.schema?(i={},this._buildTypeMap(n.schema,i)):(n.schema=this._featureSchema,i=this._typeMap),n.validate){var r=this.validate(e,n);if(r.length){if(!n.warnOnError)return console.error("Failed to validate json",e,r),r.join("\n");console.warn("Failed to validate json",e),console.warn(r.join("\n"))}}var a=this._flattenObject(e,i,n);return this.set(a),[]},_buildTypeMap:function(e,t){if(e.properties){var i=e.properties;for(var n in i){var r=i[n];"object"===r.type?(t[n]={},this._buildTypeMap(r,t[n])):r.type?t[n]=r.type:r.$ref&&(t[n]=r.$ref)}}else e.$ref&&this._buildTypeMap(this.getSubSchema(e.$ref,!1),t)},initDefaults:function(e){if(e){var t=this._flattenObject(e,this._typeMap);this.set(t)}},getJSON:function(e){if(!this._featureSchema)return["Json Schema not initialized"];var t=this.getInstance();if(e&&e.ignore)for(var i=0;i<e.ignore.length;i++){delete t[e.ignore[i]]}return this._populate(t,this._typeMap,"",e),t},_flattenObject:function(e,t,i){var n={},r=i&&i.ignore?i.ignore:void 0;for(var a in t)if(Object.prototype.hasOwnProperty.call(e,a)&&!(r&&r.indexOf(a)>=0))if("object"==typeof t[a]){var o=this._flattenObject(e[a],t[a],i);for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[a+s.charAt(0).toUpperCase()+s.slice(1)]=o[s])}else void 0!==e[a]&&(n[a]=this._toModelType(e[a],t[a]));return n},_toModelType:function(e,t){return void 0===e?e:t.indexOf("vec2")>0||t.indexOf("unitVec2")>0?c.vec2.clone(e):t.indexOf("vec3")>0||t.indexOf("unitVec3")>0?c.vec3.clone(e):t.indexOf("vec4")>0||t.indexOf("unitVec4")>0?c.vec4.clone(e):t.indexOf("quaternion")>0?c.quat.clone(e):t.indexOf("matrix")>0?c.mat4.clone(e):t.indexOf("cullFace")>0?c.CullFace[e]:e},_toJsonType:function(e,t){return t.indexOf("vec2")>0||t.indexOf("unitVec2")>0||t.indexOf("vec3")>0||t.indexOf("unitVec3")>0||t.indexOf("vec4")>0||t.indexOf("unitVec4")>0||t.indexOf("quaternion")>0||t.indexOf("matrix")>0?Array.prototype.slice.call(e):t.indexOf("cullFace")>0?l[e]:e},_populate:function(e,t,i,n){for(var r in t)if(!(n&&n.ignore&&n.ignore.indexOf(r)>=0)){var a=i?i+r.charAt(0).toUpperCase()+r.slice(1):r;if("object"==typeof t[r])this._populate(e[r],t[r],a);else{var o=this.get(a);void 0!==o&&(e[r]=this._toJsonType(o,t[r]))}}}})},"4EEe":(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var n=i("aqzA"),r=i("WGQk"),a=i("MQQR"),o=i("8SXq"),s=i.n(o);const A={initGestures:function(e){var t=e.getInputSource("TouchScreen");if(t){var i=t.getHammer();i.get("pan").set({enable:!1});var n=new(s().Pinch)({enable:!0,threshold:.1}),r=new(s().Pan)({event:"panh",direction:s().DIRECTION_HORIZONTAL}),a=new(s().Pan)({event:"panv",direction:s().DIRECTION_VERTICAL});a.requireFailure(r),r.requireFailure(n),i.add(r),i.add(a),i.add(n)}}};var g=n.Z.InputGroups;g.GLOBAL_ACTIONS=g.SCENE+".globalactions",g.GLOBAL_FOCUS="focuscanvas",g.SCENE_VIEWERAPI=g.SCENE+".viewerapi",g.SCENE_VIEWERAPI_1_4=g.SCENE+".viewerapi_1_4",g.FOCUS_INSPECTOR="focus.inspector",g.SCENE_INSPECTOR=g.SCENE+".inspector",g.UI_INSPECTOR=g.UI+".inspector",g.SCENE_INSPECTOR_ZOOM=g.SCENE_INSPECTOR+".zoom",g.UI_INSPECTOR_ZOOM=g.UI_INSPECTOR+".zoom",g.ENVIRONMENT=g.SCENE+".environment",g.DEBUG="debug",g.DEBUG_TRIPICK="debug.tripick",g.DEBUG_GEOMPICK="debug.geompick",g.AUTOSPIN=g.SCENE+".autospin",g.HOTSPOT=g.SCENE+".hotspot",g.HOTSPOT_VIEWER=g.HOTSPOT+".viewer",g.HOTSPOT_EDITOR=g.HOTSPOT+".editor",g.CAMERA=g.SCENE+".camera",g.CAMERA_GIZMO=g.CAMERA+".gizmo",g.SOUND=g.SCENE+".sound",g.SOUND_GIZMO=g.SOUND+".gizmo",g.WEBVR=g.SCENE+".webvr",g.WEBVREDITOR=g.SCENE+"webvreditor",g.WEBVR_NAVIGATION=g.WEBVR+".navigation",g.WEBVR_DISPLAY=g.WEBVR+".display",g.AR="ar",g.AR_DEBUG=g.AR+".debug",g.DECALS_DEBUG="decals.debug";const h={init:function(e){this._manager=e},initGlobalClickEvents:function(e,t){var i=0,n=0,r=0;this._manager.group(g.GLOBAL_ACTIONS).addMappings({onDoubleClick:["doubletap","doubletap2fingers","dblclick"],onSingleClick:"singletap"},e),this._manager.group(g.GLOBAL_ACTIONS).addMappings({preventclick:"mousedown"},(function(e){r=0,i=e.clientX,n=e.clientY})),this._manager.group(g.GLOBAL_ACTIONS).addMappings({preventmousemove:"mousemove"},(function(e){var t=Math.abs(i-e.clientX)+Math.abs(n-e.clientY);r=Math.max(r,t)})),this._manager.group(g.GLOBAL_ACTIONS).addMappings({fallbacksingleclick:"mouseup"},(function(t){r<2&&e.onSingleClick(t)})),this._manager.group("focuscanvas").addMappings({focus:"mousedown"},(function(){t.focus({preventScroll:!0})})),this._manager.setPriority("focuscanvas",0)},initViewerAPI:function(e){this._manager.group(g.SCENE_VIEWERAPI).addMappings({onMouseMove:"mousemove",onCursorUp:["mouseup","singletap"]},e)},initViewerAPI_1_4:function(e){this._manager.group(g.SCENE_VIEWERAPI_1_4).addMappings({onMouseMove:"mousemove",onCursorUp:["mouseup","singletap"],onCursorDown:["mousedown"]},e)},initInspector:function(e){this._manager.group(g.FOCUS_INSPECTOR).addMappings({focusCheck:["mousedown","touchstart","wheel","mousemove","touchend","mouseup"],onCursorDown:["mousedown","touchstart"],onCursorUp:["touchend","touchcancel","mouseout","mouseup"]},e),this._manager.group(g.SCENE_INSPECTOR).addMappings({onMouseMove:"mousemove"},e),this._manager.group(g.SCENE_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(g.FOCUS_INSPECTOR,this._manager.getHigherPriority(g.SCENE_INSPECTOR)),this._manager.setPriority(g.FOCUS_INSPECTOR+":onCursorUp",this._manager.getHigherPriority(g.FOCUS_INSPECTOR))},initInspectorCamera2D:function(e){this._manager.group(g.UI_INSPECTOR).addMappings({onEventStart:["pinchstart","panstart","mousedown"],onEventEnd:["pinchend","panend","mouseup","mouseout"],onEventUpdate:["pinch","pan","mousemove"]},e),this._manager.group(g.UI_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(g.UI_INSPECTOR+":onEventEnd",this._manager.getHigherPriority(g.FOCUS_INSPECTOR))},setInspectorInputsEnable:function(e){this._manager.setEnable(g.SCENE_INSPECTOR,e),this._manager.setEnable(g.SCENE_INSPECTOR_ZOOM,e)},initEnvironment:function(e){this._manager.group(g.ENVIRONMENT).addMappings({startRotate:["mousedown alt","touchstart 3"],rotateLight:["mousemove alt ctrl !shift"],rotateEnv:["mousemove alt shift !ctrl"],rotateEnvAndLight:["mousemove alt !shift !ctrl","panmove 3"],endRotate:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(g.ENVIRONMENT,this._manager.getHigherPriority(g.MANIPULATORS))},initDebug3D:function(e){this._manager.group(g.DEBUG_TRIPICK).addMappings({onTrianglePick:"dblclick"},e),this._manager.group(g.DEBUG_GEOMPICK).addMappings({onPickSelect:"dblclick"},e),this._manager.setPriority(g.DEBUG,1)},initAutospin:function(e,t){this._manager.group(g.AUTOSPIN).addMappings({pause:["mousedown","touchstart"],resume:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(g.AUTOSPIN,this._manager.getHigherPriority(g.MANIPULATORS)),this._manager.setEnable(g.AUTOSPIN,t)},initHotspot:function(e){this._manager.group(g.HOTSPOT).addMappings({hoverHotspot:"mousemove"},e),(0,r.Z)()?(this._manager.group(g.HOTSPOT_EDITOR).addMappings({createHotspot:"dblclick",startDrag:["mousedown","touchstart"],dragHotspot:["mousemove","touchmove"],stopDrag:["touchend","mouseup"],cancelDrag:["touchcancel","mouseout"]},e),this._manager.setPriority(g.HOTSPOT,this._manager.getHigherPriority(g.MANIPULATORS))):this._manager.group(g.HOTSPOT_VIEWER).addMappings({selectHotspot:["mousedown","singletap"]},e)},initCamera:function(e){this._manager.group(g.CAMERA_GIZMO).addMappings({motion:"mousemove",startDrag:"mousedown",endDrag:["mouseleave","mouseup"]},e),this._manager.setPriority(g.CAMERA_GIZMO,this._manager.getHigherPriority(g.MANIPULATORS))},initSound:function(e){this._manager.group(g.SOUND_GIZMO).addMappings({onDragMove:"mousemove",onDragStart:"mousedown",onDragEnd:["mouseleave","mouseup"],onDoubleClick:"dblclick"},e),this._manager.setEnable(g.SOUND_GIZMO,!1),this._manager.setPriority(g.SOUND_GIZMO,this._manager.getHigherPriority(g.MANIPULATORS))},initWebVR:function(e){this._manager.group(g.WEBVR).addMappings({scaleUp:"keydown o",scaleDown:"keydown p"},e),this._manager.group(g.WEBVR_DISPLAY).addMappings({onPoseChange:["vrdisplayposechanged"]},e),this._manager.setEnable(g.WEBVR,!1),(0,r.Z)()&&this._manager.group(g.WEBVREDITOR).addMappings({savePosition:"mousemove"},e)},initWebVRNavigation:function(e){this._manager.group(g.WEBVR_NAVIGATION).addMappings({onPointerDown:"touchstart 1",onPointerUp:["touchend 1","mouseup 0","mouseup 1"],displayMenu:["mouseup 2"],onMouseDown:"mousedown"},e),this._manager.setEnable(g.WEBVR_NAVIGATION,!1)},initAR:function(e){(0,a.Z)().arkitDebug&&(this._manager.group(g.AR_DEBUG).addMappings({startMotion:["mousedown 1","mousedown 2"],startRotate:"mousedown 1 !ctrl",startElevate:"mousedown ctrl 1",startScale:"mousedown 2",motion:"mousemove",endMotion:["mouseup","mouseout"]},e),this._manager.setPriority(g.AR_DEBUG,this._manager.getHigherPriority(g.MANIPULATORS))),A.initGestures(this._manager),this._manager.group(g.AR).addMappings({startScale:"pinchstart",endScale:"pinchend",scale:"pinch",endRotate:"panhend",endElevate:"panvend",rotate:"panh",elevate:"panv"},e)},initDecals:function(e){this._manager.group(g.DECALS_DEBUG).addMappings({onClick:["mousedown 1"]},e),this._manager.setPriority(g.DECALS_DEBUG,this._manager.getHigherPriority(g.MANIPULATORS))}}},JbUU:(e,t,i)=>{"use strict";i.d(t,{Z:()=>v});var n,r,a,o,s,A,g,h,c=i("aqzA"),l=i("gvzH"),u=i("XkCy"),d=i("FGWR"),I=i("8WLf"),C=i("ZmEo"),f=i("qk4i"),p=i("MQQR"),m=c.Z.osg,_=c.Z.osgUtil,E=function(){m.NodeVisitor.call(this),this.setNodeMaskOverride(-1)};E.prototype=m.objectInherit(m.NodeVisitor.prototype,{apply:function(e){e.setShape&&e.setShape(null),this.traverse(e)}});const v={init:function(e,t){this._context=e,this._viewer=e.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._features=this._context.getFeatures(),this._rootModel=t,m.time("compute KdTree"),this.computeKdTree(t),m.timeEnd("compute KdTree"),this._initialized=!0},isInitialized:function(){return this._initialized},getViewport3d:function(){return this._features.postProcess.getCamera().getViewport()},getMaterialFromHit:function(e){return this._features.material.getModel().findFirstMaterial(e._nodePath)},decodeDepth:function(e){if(255===e[0])return 1;var t=e[0]+e[1]/255;return 3&e&&(t+=e[2]/65025),t/255},pickDepth:(h=new Uint8Array(4),function(e,t,i){return e.readPixels(t,i,1,1,e.RGBA,e.UNSIGNED_BYTE,h),this.decodeDepth(h)}),getWorldPositionFromDepthXY:(A=m.vec4.create(),g=m.mat4.create(),function(e,t,i,n){var r=this._viewerOSGJS.getCamera(),a=this._viewer.getFeaturesManager().getViewport3d(),o=C.Z.uNearFar.getInternalArray(),s=o[0]+(o[1]-o[0])*e;return A[0]=(t/a.width()*2-1)*s,A[1]=(i/a.height()*2-1)*s,A[2]=1,A[3]=s,m.mat4.invert(g,r.getProjectionMatrix()),m.vec4.transformMat4(A,A,g),m.mat4.invert(g,r.getViewMatrix()),m.vec3.transformMat4(n||m.vec3.create(),A,g)}),getPixelDepth:function(e,t,i){f.Z.draw();var n=this._features.quality.getModel(),r=n.get("dynamicResolutionScaling")[0],a=(0,p.Z)().stats&&this._viewerOSGJS.getViewerStats();I.Z.setCallbackDepth(function(o){I.Z.setCallbackDepth(void 0),a&&a.getCounter("readpixels").start();var s=o.getGraphicContext();if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)return i(-1);s.flush(),s.finish();var A=n.get("dynamicResolutionScaling")[0];r!==A&&(e=e*A/r,t=t*A/r);var g=this.pickDepth(s,e,t,i);a&&a.getCounter("readpixels").end(),i(g,e,t,s)}.bind(this))},_computeIntersections3D:(o=new _.IntersectionVisitor,s=new _.LineSegmentIntersector,function(e,t,i,n){n||(n=this._features.webVR.getNode()),void 0===i&&(i=l.Z.PICK_GEOMETRY_SLOW),o.reset(),s.reset();var r=this._features.shadingStyle,a=r&&r.getModel().get("hasLines"),A=r&&r.getModel().get("hasPoints"),g=.005*u.Z.getModelBoxWithoutDisplacement().radius(),h=A||a?g:0;return o.setTraversalMask(i),o.setIntersector(s),s.set(e,t,h),n.accept(o),s.getIntersections()}),computeNearestIntersection3D:function(e,t,i,n){var r=this._computeIntersections3D(e,t,i,n);return this._sortIntersections(r)},computeNearestIntersection3DHotspotFirst:function(e,t,i,n){var r=this._computeIntersections3D(e,t,i,n);if(0!==r.length){r.sort((function(e,t){return e._ratio-t._ratio}));var a=0,o=r.length,s=this._features.hotspot.getWidgetNode();for(a=0;a<o;++a)if(-1!==r[a]._nodePath.indexOf(s))return r[a];return this._getFirstVisibleHit(r)}},pickNearestSurface:function(e){return this.computeNearestIntersection2D(e.canvasX,e.canvasY,l.Z.PICK_GEOMETRY_SLOW,this._rootModel)},_computeIntersections2D:(n=m.vec3.create(),r=m.vec3.create(),a=m.mat4.create(),function(e,t,i,o){return o||(o=this._features.webVR.getNode()),d.Z.canvasCoordToGL(e,t,n),d.Z.canvasCoordToGL(e,t,r),n[2]=0,r[2]=1,this.getWorldPositionFromScreenPoint(n,n),this.getWorldPositionFromScreenPoint(r,r),o.getWorldMatrix(void 0,a),m.mat4.invert(a,a),m.vec3.transformMat4(n,n,a),m.vec3.transformMat4(r,r,a),this._computeIntersections3D(n,r,i,o)}),computeNearestIntersection2D:function(e,t,i,n){var r=this._computeIntersections2D(e,t,i,n);return this._sortIntersections(r)},_sortIntersections:function(e){if(0!==e.length)return e.sort((function(e,t){return e._ratio-t._ratio})),this._getFirstVisibleHit(e)},_getFirstVisibleHit:function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t];if(!n._backface)return n;for(var r=n._nodePath,a=r.length-1;a>=0;--a){var o=r[a].getStateSet(),s=o&&o.getAttribute("CullFace");if(void 0!==s){if(s.getMode()===m.CullFace.DISABLE)return n;break}}}},getRelativePositionFromHit:function(){var e=m.mat4.create(),t=m.mat3.create();return function(i,n,r,a){for(var o=i._nodePath,s=!1,A=0,g=o.length;A<g;++A)if(o[A]===a){o=o.slice(A),s=!0;break}return m.mat4.identity(e),!1===s&&o[0].getWorldMatrix(a,e),m.computeLocalToWorld(o,!0,e),m.vec3.transformMat4(n,i._localIntersectionPoint,e),r&&(m.mat3.normalFromMat4(t,e),m.vec3.transformMat3(r,i._localIntersectionNormal,t),m.vec3.normalize(r,r)),n}}(),getWorldPositionFromHit:function(e,t,i){return this.getRelativePositionFromHit(e,t,i,this._viewerOSGJS.getSceneData())},getScenePositionFromHit:function(e,t,i){return this.getRelativePositionFromHit(e,t,i,this._rootModel)},getWorldPositionFromScenePoint:function(e,t){var i=t||m.vec3.create(),n=this._features.orientation,r=this._features.autospin;return n&&m.vec3.transformMat4(i,e,n.getNode().getMatrix()),r&&m.vec3.transformMat4(i,i,r.getNode().getMatrix()),i},getScenePositionFromWorldPoint:function(){var e=m.mat4.create();return function(t,i){var n=i||m.vec3.create(),r=this._features.orientation,a=this._features.autospin;return m.mat4.identity(e),r&&m.mat4.multiply(e,e,r.getNode().getMatrix()),a&&m.mat4.multiply(e,e,a.getNode().getMatrix()),m.mat4.invert(e,e),m.vec3.transformMat4(n,t,e)}}(),getScreenPositionFromScenePoint:function(e,t){var i=this.getWorldPositionFromScenePoint(e,t);return this.getScreenPositionFromWorldPoint(i,i)},getScreenPositionFromWorldPoint:function(){var e=m.mat4.create();return function(t,i){if(this._viewerOSGJS){var n=this._viewerOSGJS.getCamera();m.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),m.mat4.multiply(e,e,n.getProjectionMatrix()),m.mat4.multiply(e,e,n.getViewMatrix());var r=i||m.vec3.create();return m.vec3.transformMat4(r,t,e)}}}(),getWorldPositionFromScreenPoint:function(){var e=m.mat4.create();return function(t,i){var n=this._viewerOSGJS.getCamera();m.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),m.mat4.multiply(e,e,n.getProjectionMatrix()),m.mat4.multiply(e,e,n.getViewMatrix()),m.mat4.invert(e,e);var r=i||m.vec3.create();return m.vec3.transformMat4(r,t,e)}}(),getScenePositionFromScreenPoint:function(e,t){var i=this.getWorldPositionFromScreenPoint(e,t);return this.getScenePositionFromWorldPoint(i,i)},computeKdTree:function(e){for(var t=this._context.getScene().getWireframeNodes(),i=new E,n=t.length,r=0;r<n;++r)t[r].accept(i);new m.KdTreeBuilder({_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:50}).apply(e)}}},"4JzO":(e,t,i)=>{"use strict";i.d(t,{Z:()=>Be});var n=i("lZH+"),r=i.n(n),a=i("aqzA"),o=i("k46e"),s=i("X9mO"),A=i("QG/p"),g=i("qk4i"),h=i("L0SH");var c=i("7NZM"),l=i.n(c);function(){}