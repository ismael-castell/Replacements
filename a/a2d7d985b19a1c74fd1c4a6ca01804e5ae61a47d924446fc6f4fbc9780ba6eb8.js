FF.MDSLiveFeed=function(){this.init()},FF.MDSLiveFeed.prototype={webSocket:null,idler:null,channels:[],callbacks:[],clients:0,init:function(){return this.idler=new FF.IdleTimer(600000),!1},incrementClients:function(a){this.clients+=a,this.clients=Math.max(0,this.clients)},register:function(a){'function'==typeof a&&this.callbacks.push(a)},uniqueChannels:function(){let a=[];for(let b of this.channels){let[,c]=b.split('~');a.includes(c)||a.push(c)}return a},channelId:function(a,b){return[a,b].join('~')},subscribe:function(a,b){var c=this;this.channels.push(this.channelId(a,b)),this.doSubscribe(b),'undefined'!=typeof FF.mdsSynthetic&&window.dataStore.dispatch('mds/getSyntheticInstruments').then(function(){FF.mdsSynthetic.getBasePairs(b).forEach(function(e){c.subscribe(a+'.synthetic',e)})});let d=this.uniqueChannels();0<d.length&&this.connect()},doSubscribe:function(a){this.isReady()&&this.webSocket.send({type:'subscribe',channel:a})},unsubscribe:function(a,b){var c=this;let d=this.channelId(a,b),e=this.channels.indexOf(d);-1!==e&&this.channels.splice(e,1),'undefined'!=typeof FF.mdsSynthetic&&FF.mdsSynthetic.getBasePairs(b).forEach(function(g){c.unsubscribe(a+'.synthetic',g)});let f=this.uniqueChannels();f.includes(b)||this.doUnsubscribe(b),0===f.length&&this.disconnect()},doUnsubscribe:function(a){this.isReady()&&this.webSocket.send({type:'unsubscribe',channel:a})},isReady:function(){}