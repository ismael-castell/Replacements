!function(e){var t={};function i(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=14)}([function(e,t,i){"use strict";i.d(t,"a",function(){return r});var o=i(1),r=new(function(){function e(){this._publickey="",this._ongalleryload="",this._debug=!1,this._nomobile=!1,this._notablet=!1,this._aggressivelazy=!1,this._nocache=!1,this._idattribute="",this._scandivwbgattr="",this._bgimageselector="div, button",this._ignorepicture=!1,this._imgignore=null,this._serverurl="",this._directurl=!1,this._divignore=!1,this._divignorelevels="",this._ignoreparentelement="",this._ignorehref=!1,this._optimizely=!1,this._optimizelyoff=!1,this._passivetracking=!1,this._summaryplaytimeout=500,this._redirect=!1,this._redirecttext="Video Will Begin In...",this._ctatext="See The Full Clip",this._redirectwithclick=!0,this._redirectwithclicktarget=!1,this._redirectwithvid=!1,this._redirectafter=null,this._redirectautoplay=!1,this._socialtext="",this._autoplay=!1,this._autoplayonce=!1,this._fadeinadvance=700,this._stopnoimage=!1,this._pauseonhover=!1,this._pausehoveronce=!1,this._noimage=!1,this._audio=!1,this._audioonce=!1,this._audiohover=!1,this._resizeonscroll=!1,this._proactiveload=!1,this._urlregexp="",this._disableall=!1,this._ignorecurrenturl=!1,this._audiopolicycta=!1,this._preloadoffset=300,this._disablestorage=!1,this._iemaxelements=20,this._reduceresolution=!1,this._mobilepreload=!0,this._maxpreloadedvideos=5,this._allautoplay=!1,this._followscroll=!1,this._pulltochange=!1,this._initmobilequeue=!1,this._customimgsrc="",this._smallgif=!1,this._ingnoreelementheight=!0,this._topviewportoffset=0,this._bottomviewportoffset=0,this._minscrolldistance=50,this._mobilecta=!1,this._mobilectaloopcount=1,this._previewdelay=0,this._forcesmallvideo=!1,this._taptoplay=!1,this._hidectaicon=!1,this._horizontalthreshold=80,this._analytics=!1,this._viziodevice=null,this._abtestingpercentage=0,this._noposterimage=null,this._downloadfrequency=null,this._scrollrenderdelay=0,this._verticalpreviews=!1}return Object.defineProperty(e.prototype,"horizontalthreshold",{get:function(){return parseInt(this._horizontalthreshold,10)},set:function(e){this._horizontalthreshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidectaicon",{get:function(){return this._hidectaicon},set:function(e){this._hidectaicon=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taptoplay",{get:function(){return this._taptoplay},set:function(e){this._taptoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forcesmallvideo",{get:function(){return this._forcesmallvideo},set:function(e){this._forcesmallvideo=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewdelay",{get:function(){return this._previewdelay},set:function(e){"number"!=typeof e&&(e=parseFloat(e)),this._previewdelay=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilectaloopcount",{get:function(){return parseInt(this._mobilectaloopcount,10)},set:function(e){this._mobilectaloopcount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilecta",{get:function(){return this._mobilecta},set:function(e){this._mobilecta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minscrolldistance",{get:function(){return parseInt(this._minscrolldistance,10)},set:function(e){this._minscrolldistance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomviewportoffset",{get:function(){return parseInt(this._bottomviewportoffset,10)},set:function(e){this._bottomviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topviewportoffset",{get:function(){return parseInt(this._topviewportoffset,10)},set:function(e){this._topviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ingnoreelementheight",{get:function(){return this._ingnoreelementheight},set:function(e){this._ingnoreelementheight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smallgif",{get:function(){return this._smallgif},set:function(e){this._smallgif=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customimgsrc",{get:function(){return this._customimgsrc},set:function(e){this._customimgsrc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initmobilequeue",{get:function(){return this._initmobilequeue},set:function(e){this._initmobilequeue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pulltochange",{get:function(){return this._pulltochange},set:function(e){this._pulltochange=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followscroll",{get:function(){return this._followscroll},set:function(e){this._followscroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allautoplay",{get:function(){return this._allautoplay},set:function(e){this._allautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxpreloadedvideos",{get:function(){return parseInt(this._maxpreloadedvideos,10)},set:function(e){this._maxpreloadedvideos=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilepreload",{get:function(){return this._mobilepreload},set:function(e){this._mobilepreload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reduceresolution",{get:function(){return this._reduceresolution},set:function(e){this._reduceresolution=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iemaxelements",{get:function(){return o.a.isMsie?this._iemaxelements:1/0},set:function(e){this._iemaxelements=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disablestorage",{get:function(){return this._disablestorage},set:function(e){this._disablestorage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preloadoffset",{get:function(){return this._preloadoffset},set:function(e){this._preloadoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiopolicycta",{get:function(){return this._audiopolicycta},set:function(e){this._audiopolicycta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorecurrenturl",{get:function(){return this._ignorecurrenturl},set:function(e){this._ignorecurrenturl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableall",{get:function(){return this._disableall},set:function(e){this._disableall=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"urlregexp",{get:function(){return this._urlregexp},set:function(e){this._urlregexp=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proactiveload",{get:function(){return this._proactiveload},set:function(e){this._proactiveload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeonscroll",{get:function(){return this._resizeonscroll},set:function(e){this._resizeonscroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiohover",{get:function(){return this._audiohover},set:function(e){this._audiohover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioonce",{get:function(){return this._audioonce},set:function(e){this._audioonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this._audio},set:function(e){this._audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noimage",{get:function(){return this._noimage},set:function(e){this._noimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pausehoveronce",{get:function(){return this._pausehoveronce},set:function(e){this._pausehoveronce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pauseonhover",{get:function(){return this._pauseonhover},set:function(e){this._pauseonhover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopnoimage",{get:function(){return this._stopnoimage},set:function(e){this._stopnoimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeinadvance",{get:function(){return parseInt(this._fadeinadvance,10)},set:function(e){this._fadeinadvance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplayonce",{get:function(){return this._autoplayonce},set:function(e){this._autoplayonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(e){this._autoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"socialtext",{get:function(){return this._socialtext},set:function(e){this._socialtext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectautoplay",{get:function(){return this._redirectautoplay},set:function(e){this._redirectautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectafter",{get:function(){return parseInt(this._redirectafter,10)},set:function(e){this._redirectafter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithvid",{get:function(){return this._redirectwithvid},set:function(e){this._redirectwithvid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclicktarget",{get:function(){return this._redirectwithclicktarget},set:function(e){this._redirectwithclicktarget=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclick",{get:function(){return this._redirectwithclick},set:function(e){this._redirectwithclick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctatext",{get:function(){return this._ctatext},set:function(e){this._ctatext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirecttext",{get:function(){return this._redirecttext},set:function(e){this._redirecttext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirect",{get:function(){return this._redirect},set:function(e){this._redirect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"summaryplaytimeout",{get:function(){return parseInt(this._summaryplaytimeout,10)},set:function(e){this._summaryplaytimeout=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passivetracking",{get:function(){return this._passivetracking},set:function(e){this._passivetracking=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizelyoff",{get:function(){return this._optimizelyoff},set:function(e){this._optimizelyoff=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizely",{get:function(){return this._optimizely},set:function(e){this._optimizely=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorehref",{get:function(){return this._ignorehref},set:function(e){this._ignorehref=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignoreparentelement",{get:function(){return this._ignoreparentelement},set:function(e){this._ignoreparentelement=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"divignorelevels",{get:function(){return this._divignorelevels},set:function(e){this._divignorelevels=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"divignore",{get:function(){return this._divignore},set:function(e){this._divignore=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverurl",{get:function(){return this._serverurl},set:function(e){this._serverurl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directurl",{get:function(){return this._directurl},set:function(e){this._directurl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imgignore",{get:function(){return this._imgignore},set:function(e){this._imgignore=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorepicture",{get:function(){return this._ignorepicture},set:function(e){this._ignorepicture=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgimageselector",{get:function(){return this._bgimageselector},set:function(e){this._bgimageselector=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scandivwbgattr",{get:function(){return this._scandivwbgattr},set:function(e){this._scandivwbgattr=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idattribute",{get:function(){return this._idattribute},set:function(e){this._idattribute=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nocache",{get:function(){return this._nocache},set:function(e){this._nocache=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggressivelazy",{get:function(){return this._aggressivelazy},set:function(e){this._aggressivelazy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"notablet",{get:function(){return this._notablet},set:function(e){this._notablet=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nomobile",{get:function(){return this._nomobile},set:function(e){this._nomobile=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ongalleryload",{get:function(){return this._ongalleryload},set:function(e){this._ongalleryload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"publickey",{get:function(){return this._publickey},set:function(e){this._publickey=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollListenerAdded",{get:function(){return this._scrollListenerAdded},set:function(e){this._scrollListenerAdded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"analytics",{get:function(){return this._analytics},set:function(e){this._analytics=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viziodevice",{get:function(){return this._viziodevice},set:function(e){this._viziodevice=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"abtestingpercentage",{get:function(){return parseInt(this._abtestingpercentage,10)},set:function(e){this._abtestingpercentage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noposterimage",{get:function(){return!o.a.isIe&&this._noposterimage},set:function(e){this._noposterimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadfrequency",{get:function(){return(null===this._downloadfrequency||this._downloadfrequency<0)&&(o.a.isChrome||o.a.isSafari?this._downloadfrequency=50:o.a.isMsie?this._downloadfrequency=100:this._downloadfrequency=0),this._downloadfrequency},set:function(e){"number"!=typeof e&&(e=parseInt(e,10)),this._downloadfrequency=isNaN(e)?null:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollrenderdelay",{get:function(){return this._scrollrenderdelay},set:function(e){this._scrollrenderdelay=e>=100?e:100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalpreviews",{get:function(){return this._verticalpreviews},set:function(e){this._verticalpreviews=e},enumerable:!0,configurable:!0}),e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=new(function(){function e(){this.ua=navigator.userAgent.toLowerCase(),this.isMozilla=this.dr("firefox"),this.isWebkit=this.dr("webkit"),this.isOpera=this.dr("opera"),this.isMsie=this.dr("msie|trident|edge"),this.isIe=this.dr("trident"),this.isEdge=this.dr("edge"),this.isIe10=this.dr("msie"),this.isChrome=this._checkIsChrome(),this.isAndroid=this.dr("android"),this.isIos=this.dr("iphone|ipad|ipod"),this.isIpad=this.dr("ipad"),this.isAndroidTablet=this.isAndroid&&this.dr("^mobile"),this.isTablet=this.isIpad||this.isAndroidTablet,this.isIphone=this.dr("iphone"),this.isOperaMini=this.dr("opera mini"),this.isWindowsMobile=this.dr("iemobile"),this.isKindle=this.dr("kindle|silk|kftt|kfot|kfjwa|kfjwi"),this.isMobile=this.isAndroid||this.isIos||this.isIphone||this.isOperaMini||this.isWindowsMobile||this.isKindle,this.isOldIphone=this.isIphone&&window.screen.height/window.screen.width==1.5&&window.devicePixelRatio<=2,this.isSafari=this._checkIsSafari(),this.isVizio=window.VIZIO&&window.VIZIO.isSmartCastDevice}return e.prototype.dr=function(e){return new RegExp(e).test(this.ua)},e.prototype._checkIsSafari=function(){var e;return!!this.dr("^((?!chrome).)*safari")&&(e=this.ua.search("version/"),parseInt(this.ua.substr(e+8,3),10))},e.prototype._checkIsChrome=function(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!e&&parseInt(e[2],10)},e}())},function(e,t,i){"use strict";var o=i(0),r=function(){return function(e){void 0===e&&(e="[_VLX_] "),this._prefix="[_VLX_] ",this._prefix="[VILYNX]: "+e,this.info=this.debug=this.warn=this.error=function(){},this.critical=Function.prototype.bind.call(console.error,console,"!!CRITICAL ERROR!!",this._prefix),o.a.debug&&(this.info=Function.prototype.bind.call(console.info,console,this._prefix),this.debug=Function.prototype.bind.call(console.info,console,this._prefix),this.warn=Function.prototype.bind.call(console.warn,console,this._prefix),this.error=Function.prototype.bind.call(console.error,console,this._prefix))}}();t.a=r},function(e,t,i){"use strict";var o=i(0),r=i(2),n=i(4),a=function(){return function(){}}();i.d(t,"a",function(){return s});var s=new(function(){function e(){this._logger=new r.a("[vlx_dbg]"),this._logger.info("Viewport Queue initialized"),this._windowChange=!1,this._queue=[],this._loadedQueue=[],this._playingVideo=null,this._isPlaying=-1,this._lastToken=null,this._lastTokenTop=0,this._passTokenNow=!0,this._timeOuts=[]}return e.prototype.clearQueues=function(){var e=this;this._timeOuts.forEach(function(e){clearTimeout(e)}),this._timeOuts=[],clearTimeout(this._passTokenTimer),this._passTokenTimer=null,this._logger.info("Empty both loaded and viewport queues"),this._windowChange=!0,this._loadedQueue.forEach(function(t){e.removeFromLoadedQueue(t)}),this._queue.forEach(function(t){e.removeFromViewportQueue(t.gallery),t.gallery=null}),this._queue=[],this._loadedQueue=[],this._playingVideo=null,this._isPlaying=-1,this._lastToken=null,this._lastTokenTop=0,this._passTokenNow=!0},e.prototype.addToViewportQueue=function(e,t){var i=this;if(-1===this.findElement(e,this._queue)){var o=new a,r=this.getTokenized(),n=!0;o.gallery=e,o.priority=e.config.playpriority,o.token=!1,o.hadToken=!1,this._queue.push(o),r&&e.watcher.isThresholdInViewport&&(r.gallery.watcher.isThresholdInViewport&&r.priority>=o.priority?n=!1:(this.passToken(),r.gallery.stopOrCleanVideoNode())),n&&e.config.autoplay?t?this._timeOuts.push(window.setTimeout(function(){i.playNextInQueue(!0,null,!1)},280)):this.playNextInQueue(!0,null,!1):this._logger.info("Elem "+e.logger.debugId+" is waiting to play")}},e.prototype.removeFromViewportQueue=function(e){var t=this.findElement(e,this._queue);if(-1!==t){if(-1!==t){var i=this._queue.splice(t,1)[0];i.gallery.logMessage("Removing from viewport queue..."),i.gallery.stopOrCleanVideoNode()}this.playNextInQueue(e.watcher.isAboveViewport,e.watcher.isBelowViewport,!1)}},e.prototype.addToLoadedQueue=function(e,t){var i=this,r=-1;e.scrollPosition=e.galleryData.domObject.getBoundingClientRect().top,this._timeOuts.push(window.setTimeout(function(){if(Math.abs(e.scrollPosition-e.galleryData.domObject.getBoundingClientRect().top)<=200){if(e.logMessage("adding video to the load queue!"),-1!==i._loadedQueue.indexOf(e))return void e.logMessage("Elem already in loaded queue, exit");if(i._loadedQueue.length<o.a.maxpreloadedvideos)e.logMessage("Loaded queue isn't filled!"),i._loadedQueue.push(e),e.initOrReattachGallery(!0);else{var n=e.watcher.isInViewport;i._loadedQueue.forEach(function(e,t){!e.watcher.isCanUnload&&e.videoNode||-1!==r||(r=t)}),-1===r&&n&&(i._loadedQueue.forEach(function(t,i){t.watcher.isInViewport||-1!==r||(e.logMessage("Video with preference removes another which is not in the viewport!"),r=i)}),(t||e.watcher.isFullyInViewport)&&-1===r&&i._loadedQueue.forEach(function(i,o){i.watcher.isThresholdInViewport&&!t||-1!==r||(e.logMessage("Video with preference removes another which is not in the viewport!"),e.logMessage("Video in "),i.logMessage("Video out"),r=o)})),-1!==r&&(i._loadedQueue[r].videoNode&&i._loadedQueue[r].cleanVideoNode(!1),i._loadedQueue[r]=e,e.videoNode||e.initOrReattachGallery(i._playingVideo===e))}}},100))},e.prototype.removeFromLoadedQueue=function(e){var t=-1;this._loadedQueue.forEach(function(i,o){i.logMessage("Im in the load queue"),i===e&&(e.logMessage("Remove from the load queue"),t=o,e.cleanVideoNode(!1))}),-1!==t?this._loadedQueue.splice(t,1):e.videoNode&&(this._logger.warn("Elem "+e.logger.debugId+" not found in loaded queue, not possible to remove it.\n             Removing video node!"),e.cleanVideoNode(!1))},e.prototype.passToken=function(){var e=this;this._queue.forEach(function(t){!0===t.token&&(t.token=!1,t.hadToken=!0,e._lastTokenTop=t.gallery.watcher.top,e._lastToken=t.gallery,e._logger.info("Token is free"))})},e.prototype.forceToken=function(e){if(this.elementHasToken(e))return!0;var t,i=!1;return this._queue.forEach(function(o){i||o.gallery!==e?!0===o.token&&(t=o):(i=!0,o.token=!0)}),i?(t&&(t.gallery.stopOrCleanVideoNode(),t.token=!1,t.hadToken=!0,this._lastTokenTop=t.gallery.watcher.top,this._lastToken=t.gallery,t.gallery.logMessage("Element forced to stop, and token deleted")),e.videoNode?e.videoNode.paused&&this.playVideo(e):(e.initOrReattachGallery(!0),o.a.mobilepreload&&!o.a.passivetracking&&this.addToLoadedQueue(e,!0))):(e.watcher.isFullyInViewport||e.watcher.isThresholdInViewport)&&(e.logMessage("Element in Viewport not in queue. Adding..."),this.addToViewportQueue(e)),i},e.prototype.elementHasToken=function(e){return this._queue.some(function(t){return t.gallery===e&&t.token})},e.prototype.resetHadToken=function(){this._queue.forEach(function(e){e.hadToken=!1})},e.prototype.isTokenFree=function(){var e=!0;return this._queue.forEach(function(t){!0===t.token&&(t.gallery.logMessage("Playing token is taken"),e=!1)}),e},e.prototype.getTokenized=function(){var e=null;return this._queue.forEach(function(t){!0===t.token&&(t.gallery.logMessage("Playing token is taken"),e=t)}),e},e.prototype.updatePriority=function(e,t){var i=this.findElement(e,this._queue),o=this.getTokenized();if(-1!==i){var r=this._queue[i];r.priority=t,r.gallery.watcher.isThresholdInViewport&&(!o||o.gallery===e||o.priority<t)&&this.playNextInQueue(!0,null,!1)}},e.prototype.playNextInQueue=function(e,t,i){var r,n,a,s,l=this,c=this.getAllAutoplay(this._queue),d=this.getTopPriority(c),u=this.getTokenized(),h=0;if(d.length){if(u){if(u.priority>=d[0].priority)return;u.gallery.logMessage("New element added in the queue with more priority than me. I give up"),this.passToken(),u.gallery.stopOrCleanVideoNode()}if(s=a=this.getAllFullInViewport(d),a.length||(s=d),n=d[0].gallery.watcher.top,i){this._logger.info("Playing next one due to scroll");var p=1e5,g=-1e5;e?s.forEach(function(e,t){e.gallery.watcher.top>l._lastTokenTop&&e.gallery.watcher.top<p&&!1===e.hadToken&&(p=e.gallery.watcher.top,h=t)}):t&&(this._logger.info("Scrolling to top"),s.forEach(function(e,t){e.gallery.watcher.top<l._lastTokenTop&&e.gallery.watcher.top>g&&!1===e.hadToken&&(g=e.gallery.watcher.top,h=t)}))}else e?s.forEach(function(e,t){e.gallery.watcher.top<n&&(h=t)}):t&&(this._logger.info("Scrolling to top"),s.forEach(function(e,t){e.gallery.watcher.top>n&&(h=t)}));s[h].token=!0,r=s[h],this._logger.info("Elem "+r.gallery.logger.debugId+" have the token now"),r.gallery.watcher.isFullyInViewport||r.gallery.watcher.isThresholdInViewport?(o.a.followscroll&&this.setPassTokenTimer(),o.a.mobilepreload&&!o.a.passivetracking?(r.gallery.logMessage("playing video!"),this.playVideo(r.gallery)):r.gallery.initOrReattachGallery(!0)):(this._logger.info("Element in queue but not visible any more"),o.a.mobilepreload&&!o.a.passivetracking?this.removeFromViewportQueue(r.gallery):s.splice(h,1),this.playNextInQueue(e,t,!1))}},e.prototype.getAllFullInViewport=function(e){var t=[];return e.forEach(function(e){e.gallery.watcher.isFullyInViewport&&t.push(e)}),t},e.prototype.getAllAutoplay=function(e){var t=[];return e.forEach(function(e){e.gallery.config.autoplay&&t.push(e)}),t},e.prototype.getTopPriority=function(e){var t=[],i=-1/0;return e.forEach(function(e){e.priority>i&&(t=[],i=e.priority),e.priority===i&&t.push(e)}),t},e.prototype.findElement=function(e,t){for(var i=0;i<t.length;++i)if(t[i].gallery===e)return e.logMessage("Element already in the queue. Abort"),i;return-1},e.prototype.playVideo=function(e){var t=this;e.videoNode?e.showVideoNode():(e.logMessage("no videoNode, readding"),this._timeOuts.push(window.setTimeout(function(){e.videoNode?(e.logMessage("video found 150ms later"),e.showVideoNode()):(t._playingVideo=e,t.addToLoadedQueue(e,!0))},150)))},e.prototype.playNextWithToken=function(e){this.playNextInQueue(e,!e,!0),this.resetHadToken()},e.prototype.setPassTokenTimer=function(){var e=this;this._passTokenNow=!1,clearTimeout(this._passTokenTimer),this._passTokenTimer=window.setTimeout(function(){e._passTokenNow=!0,e._logger.info("passTokenTimer free"),e.isTokenFree()&&e._queue.length>0&&e.playNextWithToken(n.a.scrollDirection)},1e3)},e.prototype.followScrollListener=function(){var e,t,i,r=this,a=pageYOffset||document.documentElement.scrollTop;this._logger.info("Follow scroll listener init"),window.addEventListener("scroll",function(){clearTimeout(e),e=window.setTimeout(function(){if(window.innerHeight+window.scrollY>=document.body.offsetHeight&&o.a.pulltochange)r._logger.info("Scrolling beyond bottom: change video"),r._queue.length>1&&r.anyVideoOnBottom()&&(r.passToken(),r._lastToken.cleanVideoNode(!0)),a=t;else if(o.a.followscroll){if(t=pageYOffset||document.documentElement.scrollTop,i=Math.abs(t-a),t>a?(r._logger.info("Scrolling to bottom with distance: "+i),n.a.scrollDirection=!0):(r._logger.info("Scrolling to top with distance: "+i),n.a.scrollDirection=!1),a=t,i<o.a.minscrolldistance)return void r._logger.info("Scroll distance to short");if(!1===r._passTokenNow)return void r._logger.info("Token was recently passed");r._queue.length>1?(r.passToken(),r._lastToken.cleanVideoNode(!0)):r._logger.info("No other elements on queue")}},200),r._timeOuts.push(e)})},e.prototype.anyVideoOnBottom=function(){var e=this,t=0,i=!1;return this._queue.forEach(function(e){!0===e.token&&(t=e.gallery.watcher.top)}),this._queue.forEach(function(o){o.gallery.watcher.top>t&&(i=!0,e._logger.info("More video/s on bottom to play"))}),i},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=new(function(){function e(){this._isRedirecting=!1,this._galleryVersion="5.11.3",this._bgImageRegex=/^url\("?.*$/}return Object.defineProperty(e.prototype,"bgImageRegex",{get:function(){return this._bgImageRegex},set:function(e){this._bgImageRegex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"galleryVersion",{get:function(){return this._galleryVersion},set:function(e){this._galleryVersion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scriptTag",{get:function(){return this._scriptTag},set:function(e){this._scriptTag=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRedirecting",{get:function(){return this._isRedirecting},set:function(e){this._isRedirecting=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryTime",{get:function(){return this._retryTime},set:function(e){this._retryTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollDirection",{get:function(){return this._scrollDirection},set:function(e){this._scrollDirection=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"savedEventsSended",{get:function(){return this._savedEventsSended},set:function(e){this._savedEventsSended=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},set:function(e){this._loaded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vilynxUID",{get:function(){return this._vilynxUID},set:function(e){this._vilynxUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tapToPlay",{get:function(){return this._tapToPlay},set:function(e){this._tapToPlay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxRetries",{get:function(){return this._maxRetries},set:function(e){this._maxRetries=e},enumerable:!0,configurable:!0}),e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var o=i(2),r=i(3),n=i(9),a=i(11),s=new(function(){function e(){this._logger=new o.a("[vlx_dbg]"),this.onPlay=[],this.onPreviewStop=[],this.onTrackSummaryPlay=[],this.onTrackVideoPlay=[],this.onTrackThumbnailShown=[],this.onPreviewEnd=[],this.onPreviewRedirect=[],this.onPreviewClick=[],this.onPreviewLoop=[],this.hooks=[],this.galleryItems=[],this.checkAudioPolicy=n.a.doTestSound.bind(n.a)}return e.prototype.reObserve=function(){this.observer=new a.a},e.prototype.addOnPlay=function(e){return this._logger.debug("Pushed new function to OnPlay"),this.onPlay.push(e),this.onPlay},e.prototype.getOnPlay=function(){return this.onPlay},e.prototype.addOnPreviewStop=function(e){return this._logger.debug("Pushed new function to OnStop"),this.onPreviewStop.push(e),this.onPreviewStop},e.prototype.getOnPreviewStop=function(){return this.onPreviewStop},e.prototype.addOnStop=function(e){return this.addOnPreviewStop(e)},e.prototype.getOnStop=function(){return this.getOnPreviewStop()},e.prototype.addOnTrackSummaryPlay=function(e){return this._logger.debug("Pushed new function to onTrackSummaryPlay"),this.onTrackSummaryPlay.push(e),this.onTrackSummaryPlay},e.prototype.getOnTrackSummaryPlay=function(){return this.onTrackSummaryPlay},e.prototype.addOnTrackVideoPlay=function(e){return this._logger.debug("Pushed new function to OnTrackVideoPlay"),this.onTrackVideoPlay.push(e),this.onTrackVideoPlay},e.prototype.getOnTrackVideoPlay=function(){return this.onTrackVideoPlay},e.prototype.addOnTrackThumbnailShown=function(e){return this._logger.debug("Pushed new function to onTrackThumbnailShown"),this.onTrackThumbnailShown.push(e),this.onTrackThumbnailShown},e.prototype.getOnTrackThumbnailShown=function(){return this.onTrackThumbnailShown},e.prototype.addOnPreviewEnd=function(e){return this._logger.debug("Pushed new function to onPreviewEnd"),this.onPreviewEnd.push(e),this.onTrackThumbnailShown},e.prototype.getOnPreviewEnd=function(){return this.onPreviewEnd},e.prototype.addOnPreviewRedirect=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewRedirect.push(e),this.onPreviewRedirect},e.prototype.getOnPreviewRedirect=function(){return this.onPreviewRedirect},e.prototype.addOnPreviewClick=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewClick.push(e),this.onPreviewClick},e.prototype.getOnPreviewClick=function(){return this.onPreviewClick},e.prototype.addOnPreviewLoop=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewLoop.push(e),this.onPreviewLoop},e.prototype.getOnPreviewLoop=function(){return this.onPreviewLoop},e.prototype.cleanQueues=function(){return this._logger.debug("Forced a play/preload queue clean."),r.a.clearQueues(),!0},e.prototype.addOnLoadGalleryItem=function(e){return this._logger.debug("Pushed new function to onLoadGalleryItem"),this.hooks.push(e),this.hooks},e.prototype.getOnLoadGalleryItem=function(){return this.hooks},e}())},function(e,t,i){"use strict";var o,r;i.d(t,"a",function(){return o}),function(e){e.base64="base64",e.json="json",e.plain="plain"}(o||(o={})),function(e){e[e.sessionStorage=0]="sessionStorage",e[e.localStorage=1]="localStorage"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return r});var o=function(){return function(e){this.message=e}}(),r=function(){return function(e){this.message=e}}()},function(e,t,i){"use strict";var o;i.d(t,"a",function(){return o}),function(e){e[e.outOfAB=0]="outOfAB",e[e.galleryActive=1]="galleryActive",e[e.galleryPassive=2]="galleryPassive"}(o||(o={}))},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var o=i(1),r=i(2),n=new(function(){function e(){this._logger=new r.a("[vlx_dbg]"),this._audioPolicyActive=o.a.isWebkit||o.a.isMozilla,this._audioSrcBase64="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV"}return e.prototype.doTestSound=function(e,t){var i=this;if(this._audioPolicyActive){var o=document.createElement("audio");o.src="data:audio/mp3;base64,"+this._audioSrcBase64,o.play().then(function(){i._audioPolicyActive=!1,t()}).catch(function(){i._logger.warn("Audio policy is still active. Avoiding some redirect functions."),e()})}else t()},e}())},function(e,t,i){"use strict";var o=function(){function e(){}return e.prototype.chance=function(e){if(e>100||e<0)throw new Error("number must be between 0 and 100");return Math.random()<.01*e},e.prototype.randomInt=function(e,t){return Math.floor(Math.random()*(t+1)+e)},e.prototype.generateRandomHex=function(e){void 0===e&&(e=4);for(var t=Math.pow(16,Math.min(e,8)-1),i=Math.pow(16,Math.min(e,8))-1,o=(Math.floor(Math.random()*(i-t+1))+t).toString(16);o.length<e;)o+=this.generateRandomHex(e-8);return o},e.prototype.generateRandomUUID=function(){var e=this.generateRandomHex;return e(8)+"-"+e()+"-"+e()+"-"+e()+"-"+e(12)},e}();t.a=new o},function(e,t,i){"use strict";var o,r,n,a=i(0),s=i(5),l=i(2),c=(i(15),function(){function e(e,t){this.xhrMaxRetry=5,this.xhrRetryTime=1e3,this.xhrTimeout=1e3,this._LOGGER=new l.a("[XHR]"),void 0!==e&&(this.xhrMaxRetry=e,this._LOGGER.debug("Maximum number of retry set to "+e)),void 0!==t&&(this.xhrTimeout=t,this._LOGGER.debug("Timeout set to "+t))}return e.prototype.get=function(e,t,i){return this._call("GET",e,t,null,i)},e.prototype.post=function(e,t,i,o){return this._call("POST",e,t,i,o)},e.prototype._call=function(t,i,o,r,n){var a=this;return new Promise(function(s,l){a._LOGGER.info("Making Xhr "+t+" to "+i);var c=new XMLHttpRequest,d=a._stringifyQueryObject(o)||"",u=0;c.open(t,i+(d?"?"+d:""),!0),n=Object.assign({Accept:"application/json, text/javascript, */*","Content-type":"application/x-www-form-urlencoded"},n),Object.keys(n).forEach(function(e){c.setRequestHeader(e,n[e])}),c.onreadystatechange=function(){4===c.readyState&&(e._isOk(c.status)?(a._LOGGER.info("Xhr "+t+" to "+i+" successful with code "+c.status),s(c.response)):e._isTimeout(c.status)?(a._LOGGER.info("Xhr "+t+" to "+i+" timed out with code "+c.status),u<a.xhrMaxRetry?(u+=1,setTimeout(function(){c.open("${method}",i+"?"+d,!0),c.send(null)},a.xhrRetryTime*u)):(a._LOGGER.warn("Xhr "+t+" to "+i+" failed with code "+c.status),l(c.status))):(a._LOGGER.warn("Xhr "+t+" to "+i+" failed with code "+c.status),l(c.status)))},c.send(a._stringifyQueryObject(r))})},e._isOk=function(e){return e>0&&e<299},e._isTimeout=function(e){return 408===e||503===e||504===e},e.prototype._stringifyQueryObject=function(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var i=null;return e&&Object.keys(e).length&&(i=Object.keys(e).map(function(i){return(t?encodeURIComponent(i):i)+"="+(t?encodeURIComponent(e[i]):e[i])}).join("&")),i},e}()),d=i(4),u=new(function(){function e(){this._logger=new l.a("[vlx_dbg]")}return e.prototype.validateQuery=function(e){try{return document.querySelector(e),!0}catch(t){this._logger.warn("Invalid selector query found! "+e)}return this._logger.warn("Invalid selector query found! "+e),!1},e.prototype.exctractIdAttribute=function(e){var t;return e.dataset&&e.dataset.vilynxId?t=e.dataset.vilynxId:e.attributes.getNamedItem("vilynx-id")?t=e.attributes.getNamedItem("vilynx-id").value:a.a.idattribute&&e.attributes.getNamedItem(a.a.idattribute)&&(t=e.attributes.getNamedItem(a.a.idattribute).value),t},e.prototype.findElementWithBg=function(e){var t,i=a.a.bgimageselector,o=!1;return(t=Array.prototype.slice.call(e.querySelectorAll(i))).push(e),t.length>0&&t.forEach(function(e){(""!==e.style.backgroundImage&&d.a.bgImageRegex.test(e.style.backgroundImage)||e.getAttribute(a.a.scandivwbgattr))&&(a.a.imgignore&&e.matches(a.a.imgignore)||(o=!0,e.classList.add("vilynx_img")))}),o},e}()),h=i(1),p=i(6),g=i(7),f=new(function(){function e(){this._isSessionStorageAvailable=!0,this._logger=new l.a("[SS]");try{var e="__storage_test__";sessionStorage.setItem(e,e),sessionStorage.removeItem(e)}catch(e){this._isSessionStorageAvailable=!1,this._logger.warn("sessionStorage is not available")}}return e.prototype.get=function(e,t){if(!this._isSessionStorageAvailable)return this._logger.warn("sessionStorage is not available"),!1;this._logger.info("Getting "+e+" from session storage");var i=sessionStorage.getItem(e);if(i)switch(t){case p.a.base64:try{i=atob(i)||!1}catch(e){i=!1}break;case p.a.json:try{i=JSON.parse(i)||!1}catch(e){i=!1}break;case p.a.plain:}return i},e.prototype.set=function(e,t,i){if(this._isSessionStorageAvailable&&!a.a.disablestorage){var o;switch(this._logger.info("Saving "+e+" to session storage"),i){case p.a.base64:try{o=btoa(t.toString())}catch(o){throw this._logger.error("Failed to convert to BASE64 (name, element, format)",e,t,i),new g.a("Can't convert from "+typeof t+" to base64")}break;case p.a.json:try{o=JSON.stringify(t)}catch(o){throw this._logger.error("Failed to convert to JSON (name, element, format)",e,t,i),new g.a("Can't convert from "+typeof t+" to base64")}break;case p.a.plain:o=t.toString()}try{sessionStorage.setItem(e,o)}catch(e){throw this._logger.error("Can't save to session storage. Maybe it's full",e),new g.b("Can't save to session storage. Maybe it's full")}return e}this._logger.warn("sessionStorage is not available")},e.prototype.remove=function(e){this._isSessionStorageAvailable?(this._logger.info("Removing "+e+" from session storage"),sessionStorage.removeItem(e)):this._logger.warn("sessionStorage is not available")},e}()),y=function(){function e(){this._logger=new l.a("[gallery_Analytics]"),this.summaryPlayTimeOut=a.a.summaryplaytimeout,a.a.optimizely&&this.initOptimizely()}return e.prototype.trackSummaryPlay=function(e){this._summaryPlays+=1,a.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","summary_play"]),s.a.getOnTrackSummaryPlay().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.trackVideoPlay=function(e,t){a.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","summary_click"]),s.a.getOnTrackVideoPlay().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.trackThumbnailShown=function(e){a.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","thumbnail_shown"]),s.a.getOnTrackThumbnailShown().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.trackSummaryEnd=function(e){s.a.getOnPreviewStop().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.saveEvent=function(e,t,i){this._saved=f.get("vilynx_gallery_mpSavedEvents",p.a.json)||{},this._saved[e+t]={eventName:t,options:i},f.set("vilynx_gallery_mpSavedEvents",this._saved,p.a.json)},e.prototype.removeEvent=function(e){this._saved=f.get("vilynx_gallery_mpSavedEvents",p.a.json)||{},void 0!==this._saved[e]&&delete this._saved[e],f.set("vilynx_gallery_mpSavedEvents",this._saved,p.a.json)},e.prototype.sendSaved=function(){f.get("vilynx_gallery_mpSavedEvents",p.a.json);d.a.savedEventsSended=!0,f.set("vilynx_gallery_mpSavedEvents",this._saved,p.a.json)},e.prototype.trackCb=function(e,t){this.removeEvent(e+t)},e.prototype.getCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()},e.prototype.initOptimizely=function(){window.optimizely=window.optimizely||[]},e.prototype._getCurrentTime=function(e){return e.videoNode&&Math.round(e.videoNode.currentTime)||0},e.prototype._getTotalTime=function(e){return e.videoNode&&void 0!==e.videoNode.currentTime&&void 0!==e.videoNode.countLoops&&void 0!==e.config.duration?Math.round(e.videoNode.currentTime+e.videoNode.countLoops*e.config.duration):0},e}(),m=function(){return function(){}}(),v=new(function(){function e(){var e=this;this.logger=new l.a("[vlx_dbg]");var t=setInterval(function(){d.a.loaded&&(e.logger.info("ScrollMonitor initialized"),window.scrollMonitor=e.factory(),clearInterval(t))},20)}return e.prototype.factory=function(){this.version=1.2;var e,t,i,o,r,n,s,l=!1,c="undefined"==typeof window,d=!c,u=function(){return c?0:window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},h=function(){return c?0:window.pageXOffset>=0?0:window.pageXOffset||document.documentElement&&document.documentElement.scrollWidth||document.body.scrollWidth},p=new m,g=[],f="visibilityChange",y="enterViewport",v="fullyEnterViewport",_="exitViewport",b="partiallyExitViewport",w="locationChange",O="stateChange",x="canPreload",E="canUnload",N="thresholdEnterViewport",I="thresholdExitViewport",P=[f,y,v,_,b,w,O,x,E,N,I],A={top:0,bottom:0},T=function(){return c?0:window.innerHeight||document.documentElement.clientHeight},D=function(){return c?0:window.innerWidth||document.documentElement.clientWidth},S=function(){return c?0:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)},L=function(){return c?0:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)};function V(){if(p.viewportTop=u(),p.viewportBottom=p.viewportTop+p.viewportHeight,p.documentHeight=S(),p.viewportLeft=h(),p.viewportRight=p.viewportLeft+p.viewportWidth,p.documentWidth=L(),p.documentHeight!==t||p.documentWidth!==i){for(r=g.length;r--;)g[r].recalculateLocation();t=p.documentHeight,i=p.documentWidth}}function j(){p.viewportHeight=T(),p.viewportWidth=D(),V(),C()}function k(){clearTimeout(n),n=window.setTimeout(j,100)}function C(){for(s=g.length;s--;)g[s].recalculateLocation(),g[s].update();for(s=g.length;s--;)g[s].triggerCallbacks()}function M(e,t,i){var r=this;this.watchItem=e,this.overFlowParent=i,this.isInDocument=!0,this.offsets=t?t===+t?{top:t,bottom:t}:{bottom:t.bottom||A.bottom,top:t.top||A.top}:A,this.callbacks={};for(var n=0,a=P.length;n<a;n++)r.callbacks[P[n]]=[];this.locked=!1;var s,l,c,d,u,h,g,m,T=!0;function D(e){if(0!==e.length)for(g=e.length;g--;)(m=e[g]).callback.call(r,o),m.isOne&&e.splice(g,1)}this.triggerCallbacks=function(){switch(this.isInViewport&&!s&&D(this.callbacks[y]),this.isFullyInViewport&&!l&&D(this.callbacks[v]),this.isCanPreload&&!u&&D(this.callbacks[x]),this.isCanUnload&&!T&&D(this.callbacks[E]),this.isThresholdInViewport&&!h&&D(this.callbacks[N]),!this.isThresholdInViewport&&h&&D(this.callbacks[I]),this.isAboveViewport!==c&&this.isBelowViewport!==d&&(D(this.callbacks[f]),l||this.isFullyInViewport||(D(this.callbacks[v]),D(this.callbacks[b])),s||this.isInViewport||(D(this.callbacks[y]),D(this.callbacks[_]))),!this.isFullyInViewport&&l&&D(this.callbacks[b]),!this.isInViewport&&s&&D(this.callbacks[_]),this.isInViewport!==s&&D(this.callbacks[f]),!0){case s!==this.isInViewport:case l!==this.isFullyInViewport:case c!==this.isAboveViewport:case d!==this.isBelowViewport:D(this.callbacks[O])}s=this.isInViewport,l=this.isFullyInViewport,c=this.isAboveViewport,d=this.isBelowViewport,u=this.isCanPreload,T=this.isCanUnload,h=this.isThresholdInViewport},this.recalculateLocation=function(){if(!this.locked&&this.watchItem){this.isInDocument=!(this.watchItem.ownerDocument===document&&!document.body.contains(this.watchItem));var e=this.top,t=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;"none"===i&&(this.watchItem.style.display="");var o=this.watchItem.getBoundingClientRect(),r=void 0;this.parentTop=0,this.parentBottom=1/0,this.parentLeft=0,this.parentRight=1/0,this.overFlowParent&&(r=this.overFlowParent.getBoundingClientRect(),this.parentTop=Math.ceil(r.top)+p.viewportTop,this.parentBottom=Math.floor(r.bottom)+p.viewportTop,this.parentLeft=Math.ceil(r.left)+p.viewportLeft,this.parentRight=Math.floor(r.right)+p.viewportLeft),this.top=Math.ceil(o.top)+p.viewportTop,this.bottom=Math.floor(o.bottom)+p.viewportTop,this.left=Math.ceil(o.left)+p.viewportLeft,this.right=Math.floor(o.right)+p.viewportLeft,"none"===i&&(this.watchItem.style.display=i)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=p.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom,this.left=this.watchItem.left,this.right=this.watchItem.right,this.overFlowParent&&(this.parentTop=this.overFlowParent.top,this.parentBottom=this.overFlowParent.bottom,this.parentLeft=this.overFlowParent.left,this.parentRight=this.overFlowParent.right));var n=1-(this.bottom-this.top);this.top-=Math.max(n,this.offsets.top),this.bottom+=Math.max(n,this.offsets.bottom),this.height=this.bottom-this.top,this.width=this.right-this.left,void 0===e&&void 0===t||this.top===e&&this.bottom===t||D(this.callbacks[w])}},this.recalculateLocation(),this.update(),s=this.isInViewport,l=this.isFullyInViewport,c=this.isAboveViewport,d=this.isBelowViewport}p.viewportTop=null,p.viewportBottom=null,p.documentHeight=null,p.viewportHeight=T(),p.viewportWidth=D(),M.prototype={on:function(e,t,i){switch(!0){case e===f&&!this.isInViewport&&this.isAboveViewport:case e===y&&this.isInViewport:case e===v&&this.isFullyInViewport:case e===_&&this.isAboveViewport&&!this.isInViewport:case e===b&&this.isAboveViewport:case e===x&&this.isCanPreload:case e===E&&this.isCanUnload:if(t.call(this,o),i)return}if(!this.callbacks[e])throw new Error("Tried to add a scroll monitor listener of type "+e+". Your options are: "+P.join(", "));this.callbacks[e].push({callback:t,isOne:i||!1})},off:function(e,t){if(!this.callbacks[e])throw new Error("Tried to remove a scroll monitor listener of type "+e+". Your options are: "+P.join(", "));for(var i=0;i<this.callbacks[e].length;i++)if(this.callbacks[e][i]===t){this.callbacks[e].splice(i,1);break}},one:function(e,t){this.on(e,t,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height,this.width=this.right-this.left},update:function(){var e=Math.max(this.parentTop,p.viewportTop),t=Math.min(this.parentBottom,p.viewportBottom),i=Math.max(this.parentLeft,p.viewportLeft),o=Math.min(this.parentRight,p.viewportRight);this.isAboveViewport=this.top<e,this.isBelowViewport=this.bottom>t,this.overLeftDistance=this.isOverLeftViewport?i-this.left:0,this.overRightDistance=this.isOverRightViewport?this.right-o:0,this.horizontalInViewport=Math.max((this.width-(this.overLeftDistance+this.overRightDistance))/this.width,0),this.isOverLeftViewport=this.left<i,this.isOverRightViewport=this.right>o,this.isValid=this.isInDocument&&this.bottom!==p.viewportTop+this.offsets.top||this.top!==p.viewportTop-this.offsets.top,this.isInViewport=this.isValid&&this.top<=t&&this.bottom>=e&&this.left<=o&&this.right>=i,this.isFullyInViewport=this.isValid&&(!this.isAboveViewport&&!this.isBelowViewport&&!this.isOverLeftViewport&&!this.isOverRightViewport||!this.isAboveViewport&&!this.isBelowViewport&&this.isOverLeftViewport&&this.isOverRightViewport||this.isAboveViewport&&this.isBelowViewport),this.isThresholdInViewport=this.isValid&&(!this.isAboveViewport&&!this.isBelowViewport||this.isAboveViewport&&this.isBelowViewport)&&100*this.horizontalInViewport>a.a.horizontalthreshold,this.isCanPreload=this.top-a.a.preloadoffset<=t&&this.bottom+a.a.preloadoffset>=e,this.isCanUnload=!this.isCanPreload},destroy:function(){var e=g.indexOf(this);g.splice(e,1);for(var t=0,i=P.length;t<i;t++)this.callbacks[P[t]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var R=function(e){return function(t,i){this.on.call(this,e,t,i)}},q=0,z=P.length;q<z;q++){var U=P[q];M.prototype[U]=R(U)}if(d)try{V()}catch(e){try{window.$(V)}catch(e){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}function F(e){o=e,V(),C()}return d&&(window.addEventListener?(window.addEventListener("scroll",function(t){l=!0,clearTimeout(e),e=window.setTimeout(function(){window.requestAnimationFrame(function(){F(t),l=!1})},a.a.scrollrenderdelay)},!0),window.addEventListener("resize",k)):(window.attachEvent("onscroll",F),window.attachEvent("onresize",k)),a.a.proactiveload&&setInterval(function(){l||F()},200)),p.beget=p.create=function(e,t,i){"string"==typeof e?e=document.querySelector(e):e&&e.length>0&&(e=e[0]);var o=new M(e,t,i);return g.push(o),o.update(),o},p.update=function(){o=null,V(),C()},p.recalculateLocations=function(){p.documentHeight=0,p.update()},p.version=this.version,p},e.prototype.reFactory=function(){this.logger.warn("ScrollMonitor create error, reFactory method called"),window.scrollMonitor=this.factory()},e}()),_=i(3),b=function(){function e(){}return Object.defineProperty(e.prototype,"webm",{get:function(){return this._webm},set:function(e){this._webm=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mp4",{get:function(){return this._mp4},set:function(e){this._mp4=e},enumerable:!0,configurable:!0}),e}(),w=function(){function e(e,t,i){this._is169=e,this._isVertical=t,this._posterUrl=i,this._sources=new b}return Object.defineProperty(e.prototype,"sources",{get:function(){return this._sources},set:function(e){this._sources=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is169",{get:function(){return this._is169},set:function(e){this._is169=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"posterUrl",{get:function(){return this._posterUrl},set:function(e){this._posterUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical=e},enumerable:!0,configurable:!0}),e}(),O=function(){function e(e,t,i){this._url=e,this._mime=t,this._resolution=i}return Object.defineProperty(e.prototype,"mime",{get:function(){return this._mime},set:function(e){this._mime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._resolution=e},enumerable:!0,configurable:!0}),e}();!function(e){e.summaryShow="summaryShow",e.summaryStart="summaryStart",e.summaryEnd="summaryEnd",e.summaryLoop="summaryLoop",e.summaryClick="summaryClick"}(o||(o={})),function(e){e.pro69high="pro69high",e.pro69="pro69",e.galleryPro69="galleryPro69",e.pro="pro",e.galleryShort="galleryShort",e.pro23high="pro23high",e.pro23="pro23",e.galleryPro23="galleryPro23"}(r||(r={})),function(e){e.OutOfTestStandard="OutOfTestStandard",e.OutOfTestPersonalized="OutOfTestPersonalized",e.ControlStandard="ControlStandard",e.ControlPersonalized="ControlPersonalized",e.VariationStandard="VariationStandard",e.VariationPersonalized="VariationPersonalized"}(n||(n={}));var x,E=function(){function e(){}return Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!0,configurable:!0}),e}(),N=new(function(){function e(){this._logger=new l.a("[vlx_dbg]")}return e.prototype.getVideoUrl=function(e,t,i,o){var n,s,l,c,d,u,p,g=e.timestamp&&e.timestamp[0]||0,f=a.a.serverurl,y=a.a.publickey,m=i>=1.5,v=i<1&&o;return p=a.a.directurl?"direct/"+y+"/"+e.externalId:e.hash,a.a.reduceresolution&&(t>640?t=639:t>360&&(t=359)),m?h.a.isMobile&&a.a.forcesmallvideo?(n="//"+f+"/asset/"+p+"/gallery.pro69.viwindow",d="//"+f+"/asset/"+p+"/gallery.pro69.viwindow0.jpg",s=r.galleryPro69):t>640?(n="//"+f+"/asset/"+p+"/pro69high.viwindow",d="//"+f+"/asset/"+p+"/pro69high.viwindow0.jpg",s=r.pro69high):t>360?(n="//"+f+"/asset/"+p+"/pro69.viwindow",d="//"+f+"/asset/"+p+"/pro69.viwindow0.jpg",s=r.pro69):(n="//"+f+"/asset/"+p+"/gallery.pro69.viwindow",d="//"+f+"/asset/"+p+"/gallery.pro69.viwindow0.jpg",s=r.galleryPro69):v?h.a.isMobile&&a.a.forcesmallvideo||t<=135?(n="//"+f+"/asset/"+p+"/gallery.pro23.viwindow",d="//"+f+"/asset/"+p+"/gallery.pro23.viwindow0.jpg",s=r.galleryPro23):t<=240?(n="//"+f+"/asset/"+p+"/pro23.viwindow",d="//"+f+"/asset/"+p+"/pro23.viwindow0.jpg",s=r.pro23):(n="//"+f+"/asset/"+p+"/pro23high.viwindow",d="//"+f+"/asset/"+p+"/pro23high.viwindow0.jpg",s=r.pro23high):h.a.isMobile&&a.a.forcesmallvideo?(n="//"+f+"/asset/"+p+"/gallery.short.viwindow",d="//"+f+"/asset/"+p+"/gallery.short.viwindow0.jpg",s=r.galleryShort):t>360?(n="//"+f+"/asset/"+p+"/pro.viwindow",d="//"+f+"/asset/"+p+"/short.viwindow0.jpg",s=r.pro):(n="//"+f+"/asset/"+p+"/gallery.short.viwindow",d="//"+f+"/asset/"+p+"/gallery.short.viwindow0.jpg",s=r.galleryShort),l=n+".mp4",c=n+".webm",a.a.directurl||(l+="?t="+g+"&owner="+y,c+="?t="+g+"&owner="+y),(u=new w(m,v,d)).sources.mp4=new O(l,"video/mp4",s),u.sources.webm=new O(c,"video/webm",s),u},e.prototype.extractBGImageFromNode=function(e){return e.style.backgroundImage.slice(4,-1).replace(/["|']/g,"")},e.prototype.createCopyImage=function(e){var t=document.createElement("img");return t.className="vilynx_wrapperImg",a.a.scandivwbgattr&&e.getAttribute(a.a.scandivwbgattr)?t.src=e.getAttribute(a.a.scandivwbgattr):""!==e.style.backgroundImage?t.src=this.extractBGImageFromNode(e):e instanceof HTMLImageElement&&e.src&&e.src.length>0&&(t.src=e.currentSrc||e.src),t},e.prototype.findActiveImage=function(e){var t=null;return[].forEach.call(e,function(e){0!==e.offsetWidth&&0!==e.offsetHeight&&(!t||t.offsetWidth<e.offsetWidth)&&(t=e)}),t},e.prototype.getTargetImgSize=function(e){var t=e.parentNode.getBoundingClientRect(),i=t.height,o=t.width,r=e.getBoundingClientRect(),n=new E;return n.width=r.width,n.height=r.height,0!==i&&0!==o&&("inline"!==window.getComputedStyle(e.parentNode).display&&i<n.height&&(n.height=i),o<n.width&&(n.width=o)),n},e.prototype.showNodes=function(e){var t=this,i=0;if(e.constructor!==Array)throw new Error("nodes must be an array of dom nodes!");return e.forEach(function(e){e&&(e.classList?(i++,e.classList.remove("vilynx_fading")):(t._logger.error(e),t._logger.error("Node is not a valid dom node, does not have classList")))}),i},e.prototype.hideNodes=function(e){var t=this,i=0;if(e.constructor!==Array)throw new Error("nodes must be an array of dom nodes!");return e.forEach(function(e){e&&(e.classList?(i++,e.classList.add("vilynx_fading")):(t._logger.error(e),t._logger.error("Node is not a valid dom node, does not have classList")))}),i},e.prototype.isNodeVilynxHidden=function(e){return e.classList.contains("vilynx_fading")},e.prototype.addLeftCssToNode=function(e,t){var i=parseFloat(window.getComputedStyle(e).left),o=t;return i&&(o+=i),e.style.left=0===o?"":o+"px",o},e.prototype.elementNeedsRelative=function(e){if("static"===window.getComputedStyle(e).position){var t=this.querySelectorInclusive(e,".vilynx_mainImg"),i=e.parentNode;if(i){var o=i.getBoundingClientRect(),r=window.getComputedStyle(i),n=e.getBoundingClientRect();if(n.top!==o.top||n.left!==o.left){var a=t.getBoundingClientRect();if(a.top!==o.top||a.left!==o.left||"relative"!==r.position||-1!==r.overflow.indexOf("scroll")||-1!==r.overflow.indexOf("auto"))return!0}}}return!1},e.prototype.getImageCandidates=function(e,t){var i=Array.prototype.slice.call(e.querySelectorAll(t)),o=[];return e.classList.contains("vilynx_img")&&i.push(e),a.a.imgignore?i.forEach(function(e){e.matches(a.a.imgignore)||o.push(e)}):o=i,o},e.prototype.querySelectorInclusive=function(e,t){return e.matches(t)?e:e.querySelector(t)},e.prototype.extractAttributeChanges=function(e,t){var i;return i={additions:[],changes:{},removals:[]},t.forEach(function(t){if("attributes"===t.type){var o=t.attributeName,r=t.oldValue,n=e.getAttribute(o),a=o.replace("data-",""),s=!1,l=!1;0===a.indexOf("vilynx-")&&(a=a.replace("vilynx-","vilynx_"),r&&"false"!==r&&(s=!0),n&&"false"!==n&&(l=!0),r!==n&&(i.changes[a.replace("vilynx_","")]={newValue:n,prevValue:r}),s!==l&&(l?i.additions.push(a):i.removals.push(a)))}}),i},e.prototype.getArrayChanges=function(e,t){return{additions:t.slice().filter(function(t){return-1===e.indexOf(t)}),removals:e.slice().filter(function(e){return-1===t.indexOf(e)})}},e}()),I=i(9),P=function(){return function(){}}(),A=new(function(){function e(){this.queue=[],this.elementsDownloaded=0,this.logger=new l.a("[vlx_dbg]")}return e.prototype.addElement=function(e){-1===this.queue.indexOf(e)&&this.queue.push(e)},e.prototype.removeElement=function(e){var t=this.queue.indexOf(e);-1!==t&&this.queue.splice(t,1)},e.prototype.markElementRemoved=function(){this.elementsDownloaded--,this.elementsDownloaded===a.a.iemaxelements-1&&(this.logger.info("Elements have been removed. There is space enough in download queue to keep downloading."),this.start())},e.prototype.start=function(){var e=this;this.downloadInterval||(this.downloadElement(),this.downloadInterval=window.setInterval(function(){e.elementsDownloaded>=a.a.iemaxelements?(clearInterval(e.downloadInterval),e.downloadInterval=null,e.logger.warn("Download queue filled. Stop downloading.")):e.downloadElement()},a.a.downloadfrequency))},e.prototype.downloadElement=function(){if(this.queue.length){var e=this.queue.shift();e.watcher.isInViewport?(e.attachVideoNode(),this.elementsDownloaded++):this.downloadElement()}else this.downloadInterval&&(clearInterval(this.downloadInterval),this.downloadInterval=null)},e}()),T=(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),D=function(e){function t(t,i){var o=e.call(this,"["+i+":"+t+"]")||this;return o._debugId=t,o}return T(t,e),Object.defineProperty(t.prototype,"debugId",{get:function(){return this._debugId},set:function(e){this._debugId=e},enumerable:!0,configurable:!0}),t}(l.a),S=function(){function e(){this._browser=h.a,this._externalfading=!1,this._browser=h.a,this._verticalpreviews=a.a.verticalpreviews,this._redirect=a.a.redirect&&!this._browser.isMobile,this._redirecttext=a.a.redirecttext,this._redirectafter=a.a.redirectafter,this._redirectautoplay=a.a.redirectautoplay,this._ctatext=a.a.ctatext,this._hidectaicon=a.a.hidectaicon,this._redirectwithclick=a.a.redirectwithclick,this._redirectwithvid=a.a.redirectwithvid,this._fadeinadvance=a.a.fadeinadvance,this._mobilecta=a.a.mobilecta,this._mobilectaloopcount=a.a.mobilectaloopcount,this._audiopolicycta=a.a.audiopolicycta,this._autoplay=this._browser.isMobile&&!a.a.taptoplay||!this._browser.isMobile&&a.a.autoplay,this._autoplayonce=a.a.autoplayonce,this._stopnoimage=a.a.stopnoimage,this._pauseonhover=a.a.pauseonhover,this._pausehoveronce=a.a.pausehoveronce,this._previewdelay=a.a.previewdelay,this._audio=a.a.audio,this._audioonce=a.a.audioonce,this._audiohover=a.a.audiohover,this._taptoplay=a.a.taptoplay,this._topviewportoffset=a.a.topviewportoffset,this._bottomviewportoffset=a.a.bottomviewportoffset,this._playpriority=0,this._noimage=a.a.noimage,this.noposterimage=a.a.noposterimage,this._externalfading=!1,this._isDisabled=!1,this._duration=0,this._isVertical=!1,this._videoRatio=0}return Object.defineProperty(e.prototype,"videoRatio",{get:function(){return this._videoRatio},set:function(e){this._videoRatio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},set:function(e){this._duration=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisabled",{get:function(){return this._isDisabled},set:function(e){this._isDisabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalfading",{get:function(){return this._externalfading},set:function(e){this._externalfading=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noimage",{get:function(){return this._noimage},set:function(e){this._noimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taptoplay",{get:function(){return this._taptoplay},set:function(e){this._taptoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiohover",{get:function(){return this._audiohover},set:function(e){this._audiohover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioonce",{get:function(){return this._audioonce},set:function(e){this._audioonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this._audio},set:function(e){this._audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pausehoveronce",{get:function(){return this._pausehoveronce},set:function(e){this._pausehoveronce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pauseonhover",{get:function(){return this._pauseonhover},set:function(e){this._pauseonhover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopnoimage",{get:function(){return this._stopnoimage},set:function(e){this._stopnoimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplayonce",{get:function(){return this._autoplayonce},set:function(e){this._autoplayonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(e){this._autoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiopolicycta",{get:function(){return this._audiopolicycta},set:function(e){this._audiopolicycta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilectaloopcount",{get:function(){return this._mobilectaloopcount},set:function(e){this._mobilectaloopcount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilecta",{get:function(){return this._mobilecta},set:function(e){this._mobilecta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeinadvance",{get:function(){return this._fadeinadvance},set:function(e){this._fadeinadvance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithvid",{get:function(){return this._redirectwithvid},set:function(e){this._redirectwithvid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclick",{get:function(){return this._redirectwithclick},set:function(e){this._redirectwithclick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidectaicon",{get:function(){return this._hidectaicon},set:function(e){this._hidectaicon=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctatext",{get:function(){return this._ctatext},set:function(e){this._ctatext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectautoplay",{get:function(){return this._redirectautoplay},set:function(e){this._redirectautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectafter",{get:function(){return this._redirectafter},set:function(e){this._redirectafter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirecttext",{get:function(){return this._redirecttext},set:function(e){this._redirecttext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirect",{get:function(){return this._redirect},set:function(e){this._redirect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStopped",{get:function(){return this._isStopped},set:function(e){this._isStopped=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topviewportoffset",{get:function(){return this._topviewportoffset},set:function(e){this._topviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomviewportoffset",{get:function(){return this._bottomviewportoffset},set:function(e){this._bottomviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playpriority",{get:function(){return this._playpriority},set:function(e){this._playpriority=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noposterimage",{get:function(){return this._noposterimage},set:function(e){this._noposterimage=null===e?!!this._browser.isChrome&&this._browser.isChrome>=75:a.a.noposterimage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewdelay",{get:function(){return this._previewdelay},set:function(e){"number"!=typeof e&&(e=parseFloat(e)),this._previewdelay=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalpreviews",{get:function(){return this._verticalpreviews},set:function(e){this._verticalpreviews=e},enumerable:!0,configurable:!0}),e}(),L=S,V=(new S,i(10)),j=function(){function e(e){var t=this;this._onVideoEnd=[],this._onVideoLoop=[],this._onVideoCancel=[],this._redirect=null,this._deleted=!1,this._hasSentPlayEvent=!1;var i=e.vilynxData.hash&&e.vilynxData.hash.substr(0,7)||"";this.config=new L,this._debugId=i+"-"+V.a.generateRandomHex(4),this.logger=new D(this._debugId,"gallery_item"),e.domObject.classList.add("vilynx"),this.galleryData=e,a.a.debug&&e.domObject.setAttribute("vlx_dbg",String(this._debugId)),a.a.ongalleryload&&s.a.getOnLoadGalleryItem().length>0&&s.a.getOnLoadGalleryItem().forEach(function(e){e(t.galleryData.domObject)});try{this.loadConfig()}catch(e){this.logger.error("Exception raised while loading the item config. Aborting item execution. Stack trace: "),this.logger.error(e)}}return e.prototype.dealloc=function(){var e=this;this._redirect&&this._redirect.dealloc(),this._redirect=void 0,this.watcher.destroy(),this.logger=void 0,this.config=void 0,this._analytics=void 0,this._debugId=void 0,this.videoNode=void 0,Object.keys(this.watcher).forEach(function(t){e.watcher[t]=void 0}),this.watcher=void 0},e.prototype.loadConfig=function(){var e=this,t=this.galleryData.domObject;return t?([].forEach.call(t.classList,function(t){var i=t.substr(7);void 0===e.config[i]?e.logger.warn("Gallery item Config register not found: "+i):(e.config[i]=!0,e.logger.debug("Gallery item Config element loaded: "+i))}),Object.keys(t.attributes).forEach(function(i){var o=t.attributes[i];if(o){var r=o.name.replace("data-","");if(0===r.indexOf("vilynx-")){var n=r.replace("vilynx-","");void 0!==e.config[n]?("boolean"==typeof e.config[n]?e.config[n]=!("false"===o.value||""===o.value):"number"==typeof e.config[n]?isNaN(parseInt(o.value,10))?e.logger.error('Attribute "'+n+'" must be a number'):e.config[n]=parseInt(o.value,10):e.config[n]=o.value,e.logger.debug("Gallery item Config element loaded: "+n+"; value: "+o.value)):e.logger.warn("Gallery item Config attribute not found: "+n+";")}}}),!0):(this.logger.warn("Element not detected"),!1)},e.prototype.generateVideoUrl=function(){var e,t,i=N.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),o=N.findActiveImage(i)||i[0];return o?(t=(e=o.clientWidth)/o.clientHeight,this.videoData=N.getVideoUrl(this.galleryData.vilynxData,e,t,this.config.verticalpreviews),this.logger.debug("Video url "+this.videoData.sources.mp4.url),!0):(this.logger.error("Cant generate video url. No valid image found"),!1)},e.prototype.getCountLoops=function(){var e=this.videoNode.countLoops;return 1e3*this.videoNode.currentTime<300&&this.videoNode.throttle&&(e=this.videoNode.countLoops+1,this.logger.info("getCountLoops function fired before 'timeupdate' event. Adding 1 to countLoops")),e},e.prototype.playAndCatch=function(){try{this.videoNode.play()}catch(e){this.watcher.destroy(),this.logger.warn("This element had a huge issue trying to do the play. Destroying watcher listeners ")}},e.prototype.isOneLoopAutoplayVideoFinished=function(){return!this.videoNode||1e3*this.videoNode.currentTime>=1e3*this.videoNode.duration-this.config.fadeinadvance},Object.defineProperty(e.prototype,"hasSentPlayEvent",{get:function(){return this._hasSentPlayEvent},set:function(e){this._hasSentPlayEvent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"analytics",{get:function(){return this._analytics},set:function(e){this._analytics=e},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e}(),k=function(){return function(){}}(),C=function(){return function(){}}(),M=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t}(C),q=function(){return function(){}}(),z=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return z(t,e),t}(q),F=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),W=function(e){function t(t){var i=e.call(this,t)||this;return i._elementWasClicked=!1,i._mousePressed=0,i}return F(t,e),t.prototype.init=function(){this.initializeParameters(),this.initializeListeners()},t.prototype.initializeParameters=function(){this._msIeUtils=new k,this._msIeUtils.avoidIeFalseError=!1,this._msIeUtils.prevMsieLeftVariation=0,this._observers=new U,this._timeouts=new R,this._analytics=new y,N.querySelectorInclusive(this.galleryData.domObject,".vilynx_img")?this._imgSelectorQuery=".vilynx_img":this._imgSelectorQuery="img:not(.vilynx_wrapperImg)",this._wrapperNode=null},t.prototype.initializeListeners=function(){a.a.optimizely&&a.a.optimizelyoff||a.a.passivetracking?(this.mouseClickListeners(),this.mouseMoveListeners()):this.monitorizeDesktop(),this.observeVilynxId()},t.prototype.monitorizeDesktop=function(){var e=this;this._externalFadeNode=null,this.config.externalfading&&(this._externalFadeNode=document.querySelector('[data-vilynx-fadingid="'+this.galleryData.extractedUrl+'"], [vilynx-fadingid="'+this.galleryData.extractedUrl+'"]'),this._externalFadeNode||this.logger.warn("No node found on document with the attr [data-]vilynx-fadingid="+this.galleryData.extractedUrl));var t=200;a.a.aggressivelazy&&(t=1e3),(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<v.version)&&v.reFactory(),this.watcher=window.scrollMonitor.create(this.galleryData.domObject,t),this.watcher.enterViewport(function(){e.config.isDisabled||(h.a.isEdge||h.a.isMsie?e._timeouts.waitToLoadTimeout=window.setTimeout(function(){e.watcher.isInViewport&&(e.logger.info("Item has been more than 350ms in viewport. Loading video!"),h.a.isEdge?e.attachVideoNode():(A.addElement(e),A.start()))},350):a.a.downloadfrequency?(A.addElement(e),A.start()):e.attachVideoNode())}),this.watcher.exitViewport(function(){e.config.isDisabled||(clearTimeout(e._timeouts.waitToLoadTimeout),e._wrapperNode&&e.videoNode?(e.logger.info("Exiting Viewport"),e.doExitViewport()):a.a.downloadfrequency&&A.removeElement(e))})},t.prototype.attachVideoNode=function(){var e=this;try{var t=this.galleryData.domObject.classList.contains("vilynx_registered");if(this.config.isDisabled)return void this.logger.warn("This element is disabled. Ignore enterViewport event");t?!t||this.videoNode&&!this.videoNode.paused||(this.logger.info("autoplayOrAttachVideoNode again"),this.autoplayOrAttachVideoNode()):(this.logger.info("Entering viewport for first time"),this.initGallery(),this._analytics.trackThumbnailShown(this)),this.config.autoplay&&(clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._timeouts.trackSummaryPlayTimeout=window.setTimeout(function(){!e.videoNode||e.videoNode.paused||e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0)},this._analytics.summaryPlayTimeOut))}catch(e){this.logger.error("Exception raised while processing the gallery attachVideoNode. Aborting item execution. Stack trace:",e)}},t.prototype.initGallery=function(){var e=this;if(this.generateVideoUrl()){if(this.galleryData.domObject.classList.add("vilynx_registered"),this._elementsToIgnore=[],a.a.divignore&&!this.config.autoplay){var t=this.galleryData.domObject;if(a.a.divignorelevels)for(var i=0;i<parseInt(a.a.divignorelevels,10);i++)t=t.parentNode;this._elementsToIgnore=t.querySelectorAll(a.a.divignore),[].forEach.call(this._elementsToIgnore,function(t){e.ignoreElementListeners(t)})}this.videoNode=this.createVideoDom(),this._wrapperNode=this.createWrapperDom(),this.setWrapperResize(),h.a.isSafari&&this.videoData.sources.mp4.url.includes("short")&&!this.config.noposterimage&&this.coverBackgroundWithPoster(),this._wrapperNode.appendChild(this.videoNode),this.setWrapperResize(),N.elementNeedsRelative(this.galleryData.domObject)&&(this.galleryData.domObject.style.position="relative"),this.config.autoplay&&this.setVideoAutoplay(),this.wrapperImageListeners(),this.mouseMoveListeners(),this.mouseClickListeners(),this.videoListeners(),!this.config.redirect||this.config.autoplay&&!this.config.redirectautoplay||(this._redirect=new G(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this._onVideoEnd.push(this._redirect.checkAudioPolicy.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect))),N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg").classList.contains("vilynx_img")?this.observeBackgroundImage():this.observeOriginalImage(),this.addConfigListener(),this.resizeVideoNode(),this.responsiveListeners()}else this.logger.error("Video url couldn't be generated. Gallery item won't be registered")},t.prototype.doExitViewport=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.autoplay&&!this.config.isDisabled?(this.videoNode.readyState>0?this.doPause():setTimeout(function(){e.logger.info("Video ready state is 0. Pause can't be done. Retrying 10ms later"),e.doPause()},10),(this.config.previewdelay||h.a.isMsie)&&(N.showNodes([t,this._externalFadeNode]),this.cleanVideoNode())):this.config.isStopped||this.cleanVideoNode()},t.prototype.cleanVideoNode=function(){this._wrapperNode&&this.videoNode&&this.videoNode.parentElement===this._wrapperNode&&(this._wrapperNode.removeChild(this.videoNode),this.videoNode=null,a.a.downloadfrequency&&A.markElementRemoved())},t.prototype.autoplayOrAttachVideoNode=function(){this.videoNode&&this.config.autoplay&&!h.a.isMsie&&!this.config.previewdelay?this.config.autoplayonce&&this.isOneLoopAutoplayVideoFinished()||this.playAndCatch():this.reAttachVideoNode()},t.prototype.reAttachVideoNode=function(){this._wrapperNode&&(this.generateVideoUrl(),this.videoNode=this.createVideoDom(),this._wrapperNode.appendChild(this.videoNode),h.a.isSafari&&this.videoData.sources.mp4.url.includes("short")&&this.coverBackgroundWithPoster(),this.resizeVideoNode(),this.videoListeners(),this.config.autoplay&&this.setVideoAutoplay())},t.prototype.coverBackgroundWithPoster=function(){this._wrapperNode&&(this._wrapperNode.style.backgroundImage="url( "+this.videoData.posterUrl+" )",this._wrapperNode.style.backgroundSize="cover",this._wrapperNode.style.backgroundPosition="center")},t.prototype.createVideoDom=function(){var e=document.createElement("video"),t=document.createElement("source");return t.src=this.videoData.sources.mp4.url,t.type=this.videoData.sources.mp4.mime,e.appendChild(t),this.config.noposterimage||(e.poster=this.videoData.posterUrl),e.resolution=this.videoData.sources.mp4.resolution,e.preload="none",e.muted=!this.config.audio,e.countLoops=0,e.throttle=!1,e},t.prototype.resizeVideoNode=function(){if(!this.config.isDisabled){try{this.videoNode.childNodes[0]}catch(e){return void this.logger.info("Cant resize video node. The video node seems to not be created")}var e=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");if(e){var t,i=e.clientWidth,o=e.clientHeight,r=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),n="";if(0!==i&&0!==o){if(e.classList.contains("vilynx_img"))""!==e.style.backgroundImage&&(n=N.extractBGImageFromNode(e));else{if(e.naturalWidth<2&&!this.config.autoplay)return;n=e.currentSrc||e.src}n&&r.src!==n&&(r.src=n),this.setWrapperResize(),h.a.isMsie&&(i/(t=this.videoData.is169&&!1===this.config.isVertical?16/9:4/3)<o&&!1===this.config.isVertical||this.videoData.isVertical?(this.videoNode.style.height=o+"px",this.videoNode.style.width=o*t+"px",this.videoNode.style.left=(i-o*t)/2+"px",this.videoNode.style.top="0"):(this.videoNode.style.height=i/t+"px",this.videoNode.style.width=i+"px",this.videoNode.style.left="0",this.videoNode.style.top=(o-i/t)/2+"px",this.config.isVertical&&this.config.videoRatio&&(this.videoNode.style.height=i/this.config.videoRatio+"px",this.videoNode.style.top=Math.round((o-i/this.config.videoRatio)/2)+"px")),this._redirect&&this._redirect.setRedirectFontSize(e))}}else this.logger.error("Cant resize video node. No valid image found")}},t.prototype.createWrapperDom=function(){var e,t;return e=document.createElement("div"),t=N.createCopyImage(this.findMainImg()),e.appendChild(t),this.galleryData.domObject.insertBefore(e,this.galleryData.domObject.childNodes[0]),e.classList.add("supra-wrapper"),this.checkOtherElementszIndex(),h.a.isSafari&&(t.style.transform="translateZ(0)"),e},t.prototype.findMainImg=function(){var e,t=N.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery);return(e=N.findActiveImage(t)||t[0])?(e.classList.add("vilynx_mainImg"),this.config.noimage&&e.classList.add("vilynx-hide"),this.imageListeners(e),e):null},t.prototype.observeBackgroundImage=function(){var e=this,t=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");new MutationObserver(function(){if(""!==t.style.backgroundImage){var i=N.extractBGImageFromNode(t),o=e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src;e.logger.info("Div with background now have url, proceed to assign src in wrapperImg"),i!==o&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())}}).observe(t,{attributes:!0,characterData:!0})},t.prototype.observeOriginalImage=function(){var e=this,t=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");t.addEventListener("load",function(){var i=t.currentSrc||t.src;i!==e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())})},t.prototype.observeVilynxId=function(){var e=this,t=this.galleryData.domObject,i=["vilynx-id","data-vilynx-id","href"];this._observers.idObserve=new MutationObserver(function(t){t.forEach(function(t){try{var i=t.target.getAttribute(t.attributeName),o=t.oldValue;if(null!==i&&i!==o){e.disableNow();var r=[e.galleryData.domObject];oe.privateScan(null,r,e,null)}}catch(t){e.logger.error("Exception raised on vilynx-id attribute observation. Aborting item  mutation. Stack trace:",t)}})}),a.a.idattribute&&i.push(a.a.idattribute),this._observers.idObserve.observe(t,{attributeFilter:i,attributeOldValue:!0,attributes:!0})},t.prototype.refreshVideoNode=function(){this.enableNow(),this.videoNode&&this.cleanVideoNode(),a.a.downloadfrequency?(A.addElement(this),A.start()):this.autoplayOrAttachVideoNode()},t.prototype.checkOtherElementszIndex=function(){var e=this,t=this.galleryData.domObject.getElementsByTagName("*");[].forEach.call(t,function(t){var i=window.getComputedStyle(t);1!==t.nodeType||"absolute"!==i.position&&"relative"!==i.position||!t.classList||t.classList.contains("vilynx_registered")||t.classList.contains("supra-wrapper")||t.classList.contains("vilynx_mainImg")||""!==i.zIndex&&"1"!==i.zIndex&&"auto"!==i.zIndex||0===t.querySelectorAll(".vilynx_mainImg").length&&(e.logger.info("Absolute positioned element found, setting zIndex: 2"),t.style.zIndex="2")})},t.prototype.mouseMoveListeners=function(){var e,t=this,i=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");(e=this.galleryData.domObject).addEventListener("mouseenter",function(){if(i=t.galleryData.domObject.querySelector(".vilynx_wrapperImg"),!t.config.isDisabled)if(t._mousedOver=!0,a.a.passivetracking)t._timeouts.passiveTrackingPlayTimeout=window.setTimeout(function(){t._mousedOver&&(t._analytics.trackSummaryPlay(t),t._hasSentPlayEvent=!0)},500);else{if(t.config.autoplay){if(t.videoNode&&t.config.audiohover&&(t.videoNode.muted=!t.config.audiohover,t.videoNode.paused&&(t.logger.error("Video stopped by audio policy. Removing audio and replaying"),t.config.audiohover=!1,t.playVideo(i))),t.videoNode&&!t.videoNode.paused&&t.config.pauseonhover){t.resizeVideoNode();try{t.videoNode.pause(),t._hasSentPlayEvent&&(t._analytics.trackSummaryEnd(t),t._hasSentPlayEvent=!1)}catch(e){t.logger.info("Pause action failed.")}t.videoNode.currentTime=0,N.showNodes([i,t._externalFadeNode]),t.config.pausehoveronce&&(t.galleryData.domObject.classList.remove("vilynx_autoplay"),t.galleryData.domObject.classList.remove("vilynx_pauseonhover"),t.config.pauseonhover=!1,t.disableAutoplay())}}else t.videoNode&&t.videoNode.paused&&t.playVideo(i);t._redirect&&t.config.redirectafter&&t.doRedirectIn(t.config.redirectafter)}}),e.addEventListener("mouseleave",function(e){clearTimeout(t._timeouts.passiveTrackingPlayTimeout);var i=!1;a.a.passivetracking&&t._hasSentPlayEvent&&(t._analytics.trackSummaryEnd(t),t._hasSentPlayEvent=!1),t.config.isDisabled||(t._mousedOver=!1,a.a.passivetracking||[].forEach.call(t._elementsToIgnore,function(t){(e.relatedTarget===t||t.contains(e.relatedTarget))&&(i=!0)}),i||h.a.isSafari&&t.galleryData.domObject.matches(":hover")||t.doMouseLeave(!1))})},t.prototype.playVideo=function(e){var t=this;e.parentElement.classList&&e.parentElement.classList.contains("vilynx-hide")&&this.setWrapperResize(),this.resizeVideoNode(),this.videoNode.muted=!this.config.audio,h.a.isSafari&&h.a.isSafari<=9?this._timeouts.fadeInterval||(this._timeouts.fadeInterval=window.setInterval(function(){!t.videoNode.paused&&t.videoNode.currentTime>.01&&(N.hideNodes([e,t._externalFadeNode]),clearInterval(t._timeouts.fadeInterval),t._timeouts.fadeInterval=null)},50)):this.config.noposterimage||N.hideNodes([e,this._externalFadeNode]),clearTimeout(this._timeouts.restartTimeout),this.logger.info("Video play");try{var i=this.videoNode.play();i&&i.then(function(){t.config.noposterimage&&t._mousedOver&&N.hideNodes([e,t._externalFadeNode])}).catch(function(i){t.logger.info("An error has been captured while playing video. "+i.name+":"+i.message),t.config.audio&&t.videoNode&&(0===i.code?(t.config.audio=!1,t.playVideo(e)):t._mousedOver&&t.playVideo(e))})}catch(e){this.logger.info("Play action failed.")}s.a.getOnPlay().forEach(function(e){e(t.galleryData.domObject)}),clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._timeouts.trackSummaryPlayTimeout=window.setTimeout(function(){!t.videoNode||t.videoNode.paused||t._hasSentPlayEvent||(t._analytics.trackSummaryPlay(t),t._hasSentPlayEvent=!0)},this._analytics.summaryPlayTimeOut)},t.prototype.doMouseLeave=function(e){var t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(clearTimeout(this._timeouts.waitForDurationTimeout),this.config.autoplay)this.config.pauseonhover&&N.hideNodes([t,this._externalFadeNode]),this.config.audiohover&&this.videoNode&&(this.videoNode.muted=this.config.audiohover),this._redirect&&this._redirect.redirecting&&this.config.redirectautoplay&&this._onVideoCancel.forEach(function(e){e()});else if(!this.config.autoplay){clearInterval(this._timeouts.fadeInterval),this._timeouts.fadeInterval=null,this.videoNode&&!e&&this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1),clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._onVideoCancel.forEach(function(e){e()});try{this.videoNode.pause()}catch(e){this.logger.info("Pause action failed.")}clearTimeout(this._timeouts.restartTimeout),this.resetFallback()}this._redirect&&this.config.redirectafter&&this._redirect.timeToRedirect&&(this._redirect.timeToRedirect=null,this.logger.info("Mouseleave fired. Avoiding redirect."))},t.prototype.resetFallback=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this._timeouts.restartTimeout=window.setTimeout(function(){e.logger.info("Transition end has not been fired. Doing video reset via timeout!"),e.doReset(),e._timeouts.restartTimeout=null},400),N.showNodes([t,this._externalFadeNode])},t.prototype.doReset=function(){this.videoNode&&this.videoNode.readyState>0&&(this.videoNode.countLoops=0,this.videoNode.throttle=!1,this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1),this.config.autoplay&&this.config.autoplayonce?this.videoNode.pause():this.videoNode.currentTime>0&&(this.videoNode.currentTime=0))},t.prototype.doPlay=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");try{var i=this.videoNode.play();i?i.then(function(){N.hideNodes([t,e._externalFadeNode])}):N.hideNodes([t,this._externalFadeNode]),this._hasSentPlayEvent||(this._analytics.trackSummaryPlay(this),this._hasSentPlayEvent=!0)}catch(e){return this.logger.info("Play action failed."),!1}return this.config.noposterimage||N.hideNodes([t,this._externalFadeNode]),this.logger.info("Autoplay video starts to play"),!0},t.prototype.doPause=function(){try{this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)}catch(e){return this.logger.info("Pause action failed."),!1}return!0},t.prototype.setVideoAutoplay=function(){var e=this;!this.videoNode||this.config.autoplayonce&&this.isOneLoopAutoplayVideoFinished()||(this.resizeVideoNode(),this.videoNode.loop=!this.config.autoplayonce,this.config.redirectautoplay&&this.videoNode.duration&&!this.config.redirectafter&&(this.config.redirectafter=1e3*this.videoNode.duration),this.videoNode.muted=!0,this.config.previewdelay?(this.videoNode.readyState<4&&this.videoNode.load(),setTimeout(function(){e.watcher.isInViewport&&e.config.autoplay&&e.doPlay()},1e3*this.config.previewdelay)):0===this.videoNode.readyState?setTimeout(function(){e.config.autoplay&&e.doPlay()},50):this.doPlay())},t.prototype.doRedirectIn=function(e){var t=this;if(this.videoNode&&this.videoNode.duration){if(!this._redirect.timeToRedirect&&!this._redirect.redirecting){var i=1e3*this.videoNode.currentTime+e,o=Math.floor(i/(1e3*(this.config.duration||this.videoNode.duration)));this._redirect.timeToRedirect=i%(1e3*(this.config.duration||this.videoNode.duration)),0===this._redirect.timeToRedirect&&++this._redirect.timeToRedirect,this._redirect.loopToRedirect=this.getCountLoops()+o,this.logger.info("Mouse over at: "+1e3*this.videoNode.currentTime+".\n                        Redirect wrapper will fire at "+this._redirect.timeToRedirect+".\n                        In the "+this._redirect.loopToRedirect+"th loop")}}else this._timeouts.waitForDurationTimeout=window.setTimeout(function(){t.doRedirectIn(e)},100)},t.prototype.responsiveListeners=function(){var e=this,t=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");window.addEventListener("resize",function(){e._deleted||e.requestPreviewResize()}),h.a.isSafari&&this._redirect&&window.addEventListener("beforeunload",function(){e._redirect.hideRedirectWrapper()}),this.imageListeners(t),this._observers.imgRemovedObserver=new MutationObserver(function(){if(!(t=N.querySelectorInclusive(e.galleryData.domObject,".vilynx_mainImg"))){e.reassignTargetImage()&&(e.setWrapperResize(),e.resizeVideoNode())}}),this._observers.imgRemovedObserver.observe(t.parentNode,{childList:!0}),this._observers.supraWrapperRemoved=new MutationObserver(function(){e.galleryData.domObject&&e.galleryData.domObject.querySelector(".supra-wrapper")||(e.logger.error("Supra-wrapper has been removed. Removing Gallery Item"),e.removeItem())}),this._observers.supraWrapperRemoved.observe(this.galleryData.domObject,{childList:!0}),a.a.resizeonscroll&&window.addEventListener("scroll",function(){e._deleted||e.requestPreviewResize()})},t.prototype.wrapperImageListeners=function(){var e=this,t=this._wrapperNode.querySelector(".vilynx_wrapperImg");(this.videoNode&&h.a.isChrome&&h.a.isChrome>=75||h.a.isEdge)&&(this.videoNode.style.visibility="hidden",t.addEventListener("load",function(){e.videoNode&&(e.videoNode.style.visibility="visible")},!1)),t.addEventListener("transitionend",function(){clearTimeout(e._timeouts.restartTimeout),t.classList.contains("vilynx_fading")||e.doReset()},!1)},t.prototype.imageListeners=function(e){var t=this;if(!this._observedImage||this._observedImage!==e){var i=new MutationObserver(function(){t.videoNode&&(t.setWrapperResize(),t.resizeVideoNode())});i.observe(e,{attributes:!0,characterData:!0}),this.logger.info("Vilynx_mainImg has changed, observing new image"),this._observers.imageObserver&&this._observers.imageObserver.disconnect(),this._observedImage&&this._observedImage.removeEventListener("transitionend",this.endTransition),e.addEventListener("transitionend",function(e){t._deleted||t.endTransition(e)}),this._observers.imageObserver=i,this._observedImage=e,e.addEventListener("load",function(){t._deleted||(t.logger.info("Image load event fired. Doing resize."),t.setWrapperResize())})}},t.prototype.endTransition=function(e){var t=e.propertyName;["all","top","right","bottom","left","margin-right","margin-left","width","height","size","weight","transform"].some(function(e){return t===e})&&(this.logger.info("transition of type "+t+" has ended. Resizing"),this.requestPreviewResize())},t.prototype.requestPreviewResize=function(){var e=this;this._timeouts.resizeTimeout&&window.cancelAnimationFrame(this._timeouts.resizeTimeout),this._timeouts.resizeTimeout=window.requestAnimationFrame(function(){e.setWrapperResize(),e.resizeVideoNode()})},t.prototype.setWrapperResize=function(){var e=this.reassignTargetImage();if(!e)return this.logger.error("No valid image found. Hiding supra-wrapper"),this.galleryData.domObject&&this.galleryData.domObject.querySelector&&this.galleryData.domObject.querySelector(".supra-wrapper")&&this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide"),void(this.videoNode&&!this.videoNode.paused&&(this.logger.warn("Supra-wrapper is hidden but video still playing. Pausing"),this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)));this.setWrapperStyles();var t=N.getTargetImgSize(e);this._wrapperNode.style.width=t.width+"px",this._wrapperNode.style.height=t.height+"px",this._redirect&&(this._redirect.setHeight(t.height),this._redirect.setRedirectFontSize(e))},t.prototype.reassignTargetImage=function(){var e,t,i,o=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),r=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(!o){if(!(o=this.findMainImg())||!r)return null;r.src=o.currentSrc||o.src}if(e=o.clientWidth,t=o.clientHeight,i=o.naturalWidth,0===e||0===t||i<2&&!this.config.autoplay){this.logger.warn("vilynx_mainImg is too small '"+e+"x"+t+"' searching a new image");var n=N.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),a=void 0;if(!(a=N.findActiveImage(n))||a.naturalWidth<2&&!this.config.autoplay)return null;o.classList.remove("vilynx_mainImg"),a.classList.add("vilynx_mainImg"),r.src=a.currentSrc||a.src,o=a,this.imageListeners(o),this.logger.warn("Found new valid image updated vilynx_mainImg & src")}return o},t.prototype.setWrapperStyles=function(){if(this.galleryData.domObject.querySelector(".supra-wrapper")&&(this.galleryData.domObject.querySelector(".supra-wrapper").classList.contains("vilynx-hide")&&(this.logger.warn("Supra-wrapper was hidden but now is shown again"),this.galleryData.domObject.querySelector(".supra-wrapper").classList.remove("vilynx-hide"),this.config.autoplay&&this.setVideoAutoplay()),!this.galleryData.domObject.classList.contains("vilynx_mainImg"))){var e=N.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),t=window.getComputedStyle(e);if(t.cssFloat&&(this._wrapperNode.style.cssFloat=t.cssFloat),t.marginLeft||t.marginRight||t.marginTop||t.marginBottom?(this._wrapperNode.style.marginLeft=t.marginLeft,this._wrapperNode.style.marginRight=t.marginRight,this._wrapperNode.style.marginTop=t.marginTop,this._wrapperNode.style.marginBottom=t.marginBottom):t.margin&&(this._wrapperNode.style.margin=t.margin.replace(",",".")),this._wrapperNode.style.maxHeight=window.getComputedStyle(e.parentElement).maxHeight,h.a.isMsie){var i=this.galleryData.domObject.getBoundingClientRect().left-this._msIeUtils.prevMsieLeftVariation,o=parseFloat((i%1).toFixed(2)),r=void 0;0!==o&&.5!==o&&(this.logger.info("Fixing wrapper node is placed in "+i+". Normalizing decimals with left."),r=o<.5?o<.25?0-o:.5-o:o>=.75?1-o:.5-o,N.addLeftCssToNode(this.galleryData.domObject,r-this._msIeUtils.prevMsieLeftVariation),this._msIeUtils.prevMsieLeftVariation=r)}}},t.prototype.mouseClickListeners=function(){var e=this,t=this.galleryData.domObject;t.addEventListener("click",function(t){e.onMouseClick(t.which)}),h.a.isSafari||h.a.isIe||(t.addEventListener("mousedown",function(t){e._mousePressed=t.which}),t.addEventListener("mouseout",function(){e._mousePressed=0,e._elementWasClicked=!1}),t.addEventListener("mouseup",function(t){2===e._mousePressed&&2===t.which&&(e.onMouseClick(t.which),e._mousePressed=0,e.logger.info("Middle button pressed. Calling onMouseClick() function."))}))},t.prototype.onMouseClick=function(e){var t=this;if(!this.config.isDisabled){if(d.a.isRedirecting||this._elementWasClicked||(clearTimeout(this._timeouts.passiveTrackingPlayTimeout),this._hasSentPlayEvent||this._analytics.trackSummaryPlay(this),this._analytics.trackVideoPlay(this,!1),this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1,this._elementWasClicked=2!==e,s.a.getOnPreviewClick().forEach(function(e){e(t.galleryData.domObject)})),this.videoNode&&this.videoNode.currentTime>.5){var i=this.getCountLoops(),o=i*this.config.duration+this.videoNode.currentTime;this.logger.info("EngagementTime: "+o+"\n            countLoops: "+i)}this._hasSentPlayEvent=!1,this.doMouseLeave(!0)}},t.prototype.videoListeners=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),i=this.videoNode.querySelector("source"),o=this.videoNode;h.a.isMsie||(o=i),o.addEventListener("error",function(t){if(e.logger.error("Loading video node has produced an error"),e.videoData.isVertical)return e.logger.info("Vertical preview does not exist. Generating non vertical preview again"),e.config.verticalpreviews=!1,e.config.isVertical=!1,e.generateVideoUrl(),i.src=e.videoData.sources.mp4.url,i.type=e.videoData.sources.mp4.mime,e.config.noposterimage||(e.videoNode.poster=e.videoData.posterUrl),void e.videoNode.load();e.logger.error("Stopping Gallery execution."),t.error&&e.logger.info("Error code: "+t.error.toString()),e._deleted||e._msIeUtils.avoidIeFalseError||e.removeItem()}),0===this.config.duration&&this.videoNode.addEventListener("loadedmetadata",function(){e.videoNode&&(a.a.summaryplaytimeout>1e3*e.videoNode.duration&&(e._analytics.summaryPlayTimeOut=500,e._timeouts.trackSummaryPlayTimeout&&(clearTimeout(e._timeouts.trackSummaryPlayTimeout),e._timeouts.trackSummaryPlayTimeout=window.setTimeout(function(){!e.videoNode||e.videoNode.paused||e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0)},e._analytics.summaryPlayTimeOut))),h.a.isMsie&&(e._msIeUtils.avoidIeFalseError=!0),e.logger.info("Video metadata ready, duration is: "+e.videoNode.duration),e.config.duration=e.videoNode.duration,e.config.autoplay&&!e.config.redirectafter&&(e.config.redirectafter=1e3*e.videoNode.duration),e.config.videoRatio=e.videoNode.videoWidth/e.videoNode.videoHeight,e.config.videoRatio<1&&(e.logger.info("Video vertical found!"),e.config.isVertical=!0,e.setWrapperResize(),e.resizeVideoNode()),e.config.autoplay?e.watcher.isInViewport&&e.playAndCatch():e._mousedOver&&e.playVideo(t))}),this.videoNode.addEventListener("timeupdate",function(){if(e.videoNode){var i=1e3*e.videoNode.currentTime;i>10&&(i<100*e.config.duration?e.videoNode.throttle&&(e.videoNode.throttle=!1,e.videoNode.countLoops+=1,e.logger.info("Loop count: "+e.videoNode.countLoops),s.a.getOnPreviewLoop().forEach(function(t){t(e.galleryData.domObject,e.getCountLoops())})):e.videoNode.throttle=!0),e.config.autoplayonce&&e.config.fadeinadvance&&N.isNodeVilynxHidden(t)&&i+e.config.fadeinadvance>=1e3*e.videoNode.duration&&(e.logger.info("autoplayonce and fadeinadvance ("+e.config.fadeinadvance+"ms) set, hiding video node."),s.a.getOnPreviewEnd().forEach(function(t){t(e.galleryData.domObject)}),e.resetFallback()),e._redirect&&e._redirect.timeToRedirect&&!e._redirect.redirecting&&(e.videoNode.countLoops===e._redirect.loopToRedirect&&i>=e._redirect.timeToRedirect||e.videoNode.countLoops>e._redirect.loopToRedirect)&&(e.logger.info("Redirect after fired at "+1e3*e.videoNode.currentTime+"ms,\n                            Showing redirect wrapper"),e._redirect.timeToRedirect=null,e._onVideoEnd.forEach(function(e){e()}))}}),this.videoNode.addEventListener("ended",function(){if(e.videoNode.muted=e.config.audioonce||!e.config.audio,!e.config.autoplay){e.videoNode.currentTime=0;try{e.videoNode.play()}catch(t){e.logger.info("Play action failed.")}e.config.redirectafter||e.galleryData.domObject.classList.contains("vilynx_no-redirect")||(e.logger.info("Video Ended, calling onEnd function stack"),e._onVideoEnd.forEach(function(e){e()}))}})},t.prototype.videoErrorHandler=function(e){this.logger.error("Loading video node has produced an error. Stopping Gallery execution on this element."),this.logger.error(e),this._deleted||this.removeItem()},t.prototype.removeItem=function(){var e=this;this.logger.info("Removing Gallery Item..."),this.disableNow(),this._deleted=!0,[].forEach.call(Object.keys(this._observers),function(t){e._observers[t].disconnect()}),[].forEach.call(Object.keys(this._timeouts),function(t){clearTimeout(e._timeouts[t])}),this.galleryData.domObject.querySelector(".supra-wrapper")&&this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide"),this.dealloc()},t.prototype.ignoreElementListeners=function(e){var t,i,o=this;e.addEventListener("mouseenter",function(){t=o.galleryData.domObject.querySelector(".vilynx_wrapperImg"),o.config.autoplay||o.config.isDisabled||o.videoNode.paused&&o.playVideo(t)}),e.addEventListener("mouseleave",function(e){if(!o.config.autoplay&&!o.config.isDisabled){i=o.galleryData.domObject;var t=!1;[].forEach.call(o._elementsToIgnore,function(i){(e.relatedTarget===i||i.contains(e.relatedTarget))&&(t=!0)}),e.relatedTarget===i||i.contains(e.relatedTarget)||t||o.videoNode.paused||o.doMouseLeave(!1)}})},t.prototype.addConfigListener=function(){var e,t,i,o=this;e=h.a.isIe?this.galleryData.domObject.getAttribute("class"):this.galleryData.domObject.classList.value,this._oldClasses=e?e.split(" "):null,t=this.galleryData.domObject,i={attributeOldValue:!0,attributes:!0,characterData:!1,childList:!1,subtree:!1},this._observers.configListener=new MutationObserver(function(e){var t=o.extractClassChanges(),i=N.extractAttributeChanges(o.galleryData.domObject,e),r={additions:t.additions.concat(i.additions),removals:t.removals.concat(i.removals)};o.manageConfigChanges(r)}),this._observers.configListener.observe(t,i)},t.prototype.extractClassChanges=function(){var e,t,i;return t=(e=h.a.isIe?this.galleryData.domObject.getAttribute("class"):this.galleryData.domObject.classList.value)?e.split(" "):"",i=N.getArrayChanges(this._oldClasses,t),this._oldClasses=t,i},t.prototype.manageConfigChanges=function(e){(e.additions.length||e.removals.length)&&(this.logger.info("Configuration changed:\n                        Additions: "+e.additions+"\n                        Removals: "+e.removals),this.config.autoplay&&-1!==e.removals.indexOf("vilynx_autoplay")?(this.logger.info("vilynx_autoplay class removed: Disable autoplay"),this.disableAutoplay()):this.config.autoplay||-1===e.additions.indexOf("vilynx_autoplay")||(this.logger.info("vilynx_autoplay class added: Enable autoplay"),this.enableAutoplay()),this.config.autoplay&&(!this.config.autoplayonce||this.config.autoplayonce&&!this.isOneLoopAutoplayVideoFinished())&&(this.config.isDisabled&&-1!==e.removals.indexOf("vilynx_stop")?(this.logger.info("vilynx_stop class removed: Replaying video"),this.unStopVideo()):this.config.isDisabled||-1===e.additions.indexOf("vilynx_stop")||(this.logger.info("vilynx_stop class added: Stops video"),this.stopVideo())),this.config.audiohover&&-1!==e.removals.indexOf("vilynx_audiohover")?(this.logger.info("vilynx_audiohover class removed"),this.config.audiohover=!1):this.config.audiohover||-1===e.additions.indexOf("vilynx_audiohover")||(this.logger.info("vilynx_audiohover class added"),this.config.audiohover=!0),a.a.disableall?this.config.isDisabled?-1===e.additions.indexOf("vilynx_enabled")&&-1===e.additions.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class added: Enable Gallery item"),this.enableNow()):-1===e.removals.indexOf("vilynx_enabled")&&-1===e.removals.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class removed: Disable Gallery item"),this.disableNow()):this.config.isDisabled?-1!==e.removals.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class removed: Enable Gallery item"),this.enableNow()):-1!==e.additions.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class added: Disable Gallery item"),this.disableNow()))},t.prototype.enableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!1,this.watcher.isInViewport&&(a.a.downloadfrequency?(A.addElement(this),A.start()):this.autoplayOrAttachVideoNode()),this.config.autoplay&&N.hideNodes([e,this._externalFadeNode])},t.prototype.disableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!0,N.showNodes([e,this._externalFadeNode]),this.watcher.isInViewport&&this.doExitViewport()},t.prototype.stopVideo=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!0,this.config.isStopped=!0,this.config.stopnoimage||N.showNodes([e,this._externalFadeNode]);try{this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)}catch(e){this.logger.info("Pause action failed.")}},t.prototype.unStopVideo=function(){}