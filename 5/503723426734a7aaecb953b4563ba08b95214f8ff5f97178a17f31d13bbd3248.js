/*! For license information please see cb.home.745b42ca.js.LICENSE.txt */
(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var executeModules=data[2];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}deferredModules.push.apply(deferredModules,executeModules||[]);return checkDeferredModules()}function checkDeferredModules(){var result;for(var i=0;i<deferredModules.length;i++){var deferredModule=deferredModules[i];var fulfilled=true;for(var j=1;j<deferredModule.length;j++){var depId=deferredModule[j];if(installedChunks[depId]!==0)fulfilled=false}if(fulfilled){deferredModules.splice(i--,1);result=__webpack_require__(__webpack_require__.s=deferredModule[0])}}return result}var installedModules={};var installedChunks={8:0};var deferredModules=[];function jsonpScriptSrc(chunkId){return __webpack_require__.p+""+({}[chunkId]||chunkId)+"."+{26:"12a9c080"}[chunkId]+".js"}function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.e=function requireEnsure(chunkId){var promises=[];var installedChunkData=installedChunks[chunkId];if(installedChunkData!==0){if(installedChunkData){promises.push(installedChunkData[2])}else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var script=document.createElement("script");var onScriptComplete;script.charset="utf-8";script.timeout=120;if(__webpack_require__.nc){script.setAttribute("nonce",__webpack_require__.nc)}script.src=jsonpScriptSrc(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null;clearTimeout(timeout);var chunk=installedChunks[chunkId];if(chunk!==0){if(chunk){var errorType=event&&(event.type==="load"?"missing":event.type);var realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")";error.name="ChunkLoadError";error.type=errorType;error.request=realSrc;chunk[1](error)}installedChunks[chunkId]=undefined}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete;document.head.appendChild(script)}}return Promise.all(promises)};__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.oe=function(err){console.error(err);throw err};var jsonpArray=window["webpackJsonp"]=window["webpackJsonp"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push(["fGRa",0]);return checkDeferredModules()})({"+Cwn":function(module,__webpack_exports__,__webpack_require__){"use strict";var lozad__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("QbK4");var lozad__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lozad__WEBPACK_IMPORTED_MODULE_0__);window.document.addEventListener("DOMContentLoaded",event=>{const lozadObserver=lozad__WEBPACK_IMPORTED_MODULE_0___default()(".lozad",{rootMargin:"10px 0px",threshold:.1});lozadObserver.observe()})},"06tH":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(factory){var registeredInModuleLoader;if(true){!(__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));registeredInModuleLoader=true}if(true){module.exports=factory();registeredInModuleLoader=true}if(!registeredInModuleLoader){var OldCookies=window.Cookies;var api=window.Cookies=factory();api.noConflict=function(){window.Cookies=OldCookies;return api}}})((function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes){result[key]=attributes[key]}}return result}function decode(s){return s.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function init(converter){function api(){}function set(key,value,attributes){if(typeof document==="undefined"){return}attributes=extend({path:"/"},api.defaults,attributes);if(typeof attributes.expires==="number"){attributes.expires=new Date(new Date*1+attributes.expires*864e5)}attributes.expires=attributes.expires?attributes.expires.toUTCString():"";try{var result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result}}catch(e){}value=converter.write?converter.write(value,key):encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);key=encodeURIComponent(String(key)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var stringifiedAttributes="";for(var attributeName in attributes){if(!attributes[attributeName]){continue}stringifiedAttributes+="; "+attributeName;if(attributes[attributeName]===true){continue}stringifiedAttributes+="="+attributes[attributeName].split(";")[0]}return document.cookie=key+"="+value+stringifiedAttributes}function get(key,json){if(typeof document==="undefined"){return}var jar={};var cookies=document.cookie?document.cookie.split("; "):[];var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split("=");var cookie=parts.slice(1).join("=");if(!json&&cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1)}try{var name=decode(parts[0]);cookie=(converter.read||converter)(cookie,name)||decode(cookie);if(json){try{cookie=JSON.parse(cookie)}catch(e){}}jar[name]=cookie;if(key===name){break}}catch(e){}}return key?jar[key]:jar}api.set=set;api.get=function(key){return get(key,false)};api.getJSON=function(key){return get(key,true)};api.remove=function(key,attributes){set(key,"",extend(attributes,{expires:-1}))};api.defaults={};api.withConverter=init;return api}return init((function(){}))}))},"0C8Z":function(module,__webpack_exports__,__webpack_require__){"use strict";var _root_shared_utils_url__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("uLeD");function Utility(){const debug=isDebug();const _logger=loggers("Utility");function urlQueryAsObject(query){query=query.substring(query.indexOf("?")+1);var re=/([^&=]+)=?([^&]*)/g;var decodeRE=/\+/g;var decode=function(str){return decodeURIComponent(str.replace(decodeRE," "))};var params={},e;while(e=re.exec(query)){var k=decode(e[1]),v=decode(e[2]);if(k.substring(k.length-2)==="[]"){k=k.substring(0,k.length-2)(params[k]||(params[k]=[])).push(v)}else{params[k]=v}}var assign=function(obj,keyPath,value){var lastKeyIndex=keyPath.length-1;for(var i=0;i<lastKeyIndex;++i){var key=keyPath[i];if(!(key in obj)){obj[key]={}}obj=obj[key]}obj[keyPath[lastKeyIndex]]=value};for(var prop in params){var structure=prop.split("[");if(structure.length>1){var levels=[];structure.forEach((function(item,i){var key=item.replace(/[?[\]\\ ]/g,"");levels.push(key)}));assign(params,levels,params[prop]);params[prop]=null}}return params}function renderScript(config){if(Array.isArray(config)){for(let i=0;i<config.length;i++){renderScript(config[i])}return}if(!config.attributes){config.attributes={}}if(config.url||config.content||config.attributes.src){_logger.info("Rendering Script",config);if(config.id&&!config.attributes.id){config.attributes.id=config.id}if(config.url&&!config.attributes.src){config.attributes.src=config.url}(function(d,s,attr,content,appendTo){const js=d.createElement(s);const fjs=d.getElementsByTagName(s)[0];const parent=typeof appendTo!=="undefined"?d.querySelector(appendTo):false;if(attr.id&&d.getElementById(attr.id)){return}js.setAttribute("type","text/javascript");for(const[key,value]of Object.entries(attr)){js.setAttribute(key,value===true?"":value)}if(content){js.innerHTML=content}if(parent){parent.append(js)}else if(parent!==null){fjs.parentNode.insertBefore(js,fjs)}})(document,"script",config.attributes,config.content,config.parent)}else{_logger.error("Script not rendered. Must have innerHtml or attributes.src value",config)}}function url(url){var parser=document.createElement("a");parser.href=url;return parser}function loggers(){let namespace=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Logger";if(isDebug()){const style="color:#ffffff; padding:3px; font-weight:600;";const baseLogger=typeof console.context==="function"?console.context(namespace):console;return Object.assign(baseLogger,{info:baseLogger.info.bind(baseLogger,"%c ".concat(namespace,": (info) "),"".concat(style," background-color: #31b0d5")),warn:baseLogger.warn.bind(baseLogger,"%c ".concat(namespace,": (warning) "),"".concat(style," background-color: #f0ad4e")),error:baseLogger.error.bind(baseLogger,"%c ".concat(namespace,": (error) "),"".concat(style," background-color: #d9534f")),success:baseLogger.log.bind(baseLogger,"%c ".concat(namespace,": (success) "),"".concat(style," background-color: #5cb85c")),log:baseLogger.log.bind(baseLogger,"%c ".concat(namespace,": (log) "),"".concat(style," background-color: #337ab7"))})}else{return{info:()=>{},warn:()=>{},error:()=>{},success:()=>{},log:()=>{}}}}function wait(waitSet,cb){_logger.log("Waiting",waitSet);if(Array.isArray(waitSet)){for(var i=0;i<waitSet.length;i++){if(typeof waitSet[i].callback==="undefined"&&typeof cb!=="undefined"){waitSet[i].callback=cb}waitHandler(waitSet[i])}}else{if(typeof waitSet.callback==="undefined"&&typeof cb!=="undefined"){waitSet.callback=cb}waitHandler(waitSet)}}function waitHandler(wait){var cfg=wait.wait||wait;var duration=cfg.duration||0;if(cfg&&when(cfg,wait)){setTimeout((function(){if(cfg.report){PopCultureAnalytics.report(cfg)}if(cfg.callback){cfg.callback.call(null,cfg)}}),duration)}else if(!when(cfg)){_logger.info("Wait failed when condition",cfg)}}function evaluate(obj){if(!obj.eval){_logger.error("Not Evaluatable. No obj.eval.",obj);return obj}var evaluation=obj.eval;return Object.assign({},obj,evaluateObject(evaluation))}function findKey(obj,value){if(!obj.findKey){var kArray=Object.keys(obj);var vArray=Object.values(obj);var vIndex=vArray.indexOf(value);return kArray[vIndex]}return obj.findKey(value)}function when(obj,args){var when=obj.when||obj;args=args||obj;return typeof when!=="string"||typeof when!=="undefined"&&eval(when)}function reportable(obj){var report=obj.report||obj;if(report.eval){report=evaluate(report)}if(!report){_logger.error("Not reportable",report)}return when(report)?PopCultureAnalytics.report(report):false}function isDebug(){const queryKey=Object(_root_shared_utils_url__WEBPACK_IMPORTED_MODULE_0__["a"])("pcm_debug");const validValues=["debug","true","1"];if(queryKey&&validValues.indexOf(queryKey)>=0){return true}return false}function convertFromHtmlEntities(text){const span=document.createElement("span");return text.replace(/&[#A-Za-z0-9]+/gi,entity=>{span.innerHTML=entity;return span.innerText})}function convertFromUnicode(text){return text.replace(/\\u[\dA-F]{4}/gi,match=>String.fromCharCode(parseInt(match.replace(/\\u/g,""),16)))}function isVisible(selector){let percent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;const el=typeof selector==="string"?document.querySelector(selector):selector;if(typeof Element.prototype.inView!=="undefined"&&percent===1){return el.inView()}const rect=el.getBoundingClientRect();const percentageHeightOffset=rect.top+(rect.height*(percent*.01)).toFixed(0);return rect.top>=0&&rect.left>=0&&percentageHeightOffset<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)}function evaluateObject(obj,parent,autoEval){if(autoEval){obj.eval=obj}if(obj.eval&&obj.eval.constructor==Array){for(var i=0;i<=obj.eval.length-1;i++){if(obj[obj.eval[i]].indexOf("")<0){var result=eval(obj[obj.eval[i]]);if(result!="NOVAL"){obj.push(result)}}}}else if(obj.eval&&obj.eval.constructor==String){obj[obj.eval]=eval(obj[obj.eval])}else if(obj.eval&&obj.eval.constructor==Object){for(var property in obj.eval){if(obj.eval[property].constructor!==Object){obj[property]=isPublic.evaluateObject(obj.eval[property],obj,true)}else if(typeof obj.eval[property]=="string"&&obj.eval[property].indexOf("")<0){var result=eval(obj.eval[property]);obj[property]=result!="NOVAL"?result:obj[property]}}}return obj}function escapeQuotes(string){return string.replace(/"/g,'\\"')}function unescapeQuotes(string){return string.replace(/\\"/g,'"')}function runCallbackQueue(queue){queue.map((function(cb){cb()}));return[]}function onAttributeChange(el,callback){var MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(MutationObserver){var options={subtree:false,attributes:true};var observer=new MutationObserver((function(mutations){mutations.forEach((function(e){callback.call(e.target,e.attributeName)}))}));observer.observe(el,options);return observer}}return{convertFromHtmlEntities:convertFromHtmlEntities,convertFromUnicode:convertFromUnicode,debug:debug,error:_logger.error,escapeQuotes:escapeQuotes,evaluate:evaluate,evaluateObject:evaluateObject,findKey:findKey,info:_logger.info,isDebug:isDebug,isVisible:isVisible,loggers:loggers,onAttributeChange:onAttributeChange,renderScript:renderScript,reportable:reportable,runCallbackQueue:runCallbackQueue,success:_logger.success,unescapeQuotes:unescapeQuotes,url:url,urlQueryAsObject:urlQueryAsObject,wait:wait,waitHandler:waitHandler,warn:_logger.warn,when:when}}__webpack_exports__["a"]=Utility()},"16S2":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return onHeadlinePage}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getPropertyName}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isComicBook}));function onHeadlinePage(){let pageType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window.$cbc.CurrentSite.PageType;return $cbc.CurrentSite.PageType==="headline"}function getPropertyName(){let withTld=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;const property=$cbc.CurrentSite.Property;return withTld?property:property.replace(/.com$/,"")}function isPopCulture(){return getPropertyName()==="popculture"}function isComicBook(){return getPropertyName()==="comicbook"}},"4H3u":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(a){var b=navigator.userAgent;a.HTMLPictureElement&&/ecko/.test(b)&&b.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var b,c=document.createElement("source"),d=function(a){var b,d,e=a.parentNode;"PICTURE"===e.nodeName.toUpperCase()?(b=c.cloneNode(),e.insertBefore(b,e.firstElementChild),setTimeout((function(){e.removeChild(b)}))):(!a._pfLastSize||a.offsetWidth>a._pfLastSize)&&(a._pfLastSize=a.offsetWidth,d=a.sizes,a.sizes+=",100vw",setTimeout((function(){a.sizes=d})))},e=function(){var a,b=document.querySelectorAll("picture > img, img[srcset][sizes]");for(a=0;a<b.length;a++)d(b[a])},f=function(){clearTimeout(b),b=setTimeout(e,99)},g=a.matchMedia&&matchMedia("(orientation: landscape)"),h=function(){f(),g&&g.addListener&&g.addListener(f)};return c.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?h():document.addEventListener("DOMContentLoaded",h),f}())}(window),function(a,b,c){"use strict";function d(a){return" "===a||"\t"===a||"\n"===a||"\f"===a||"\r"===a}function e(b,c){var d=new a.Image;return d.onerror=function(){A[b]=!1,ba()},d.onload=function(){A[b]=1===d.width,ba()},d.src=c,"pending"}function f(){M=!1,P=a.devicePixelRatio,N={},O={},s.DPR=P||1,Q.width=Math.max(a.innerWidth||0,z.clientWidth),Q.height=Math.max(a.innerHeight||0,z.clientHeight),Q.vw=Q.width/100,Q.vh=Q.height/100,r=[Q.height,Q.width,P].join("-"),Q.em=s.getEmValue(),Q.rem=Q.em}function g(a,b,c,d){var e,f,g,h;return"saveData"===B.algorithm?a>2.7?h=c+1:(f=b-c,e=Math.pow(a-.6,1.5),g=f*e,d&&(g+=.1*e),h=a+g):h=c>1?Math.sqrt(a*b):a,h>c}function h(a){var b,c=s.getSet(a),d=!1;"pending"!==c&&(d=r,c&&(b=s.setRes(c),s.applySetCandidate(b,a))),a[s.ns].evaled=d}function i(a,b){return a.res-b.res}function j(a,b,c){var d;return!c&&b&&(c=a[s.ns].sets,c=c&&c[c.length-1]),d=k(b,c),d&&(b=s.makeUrl(b),a[s.ns].curSrc=b,a[s.ns].curCan=d,d.res||aa(d,d.set.sizes)),d}function k(a,b){var c,d,e;if(a&&b)for(e=s.parseSet(b),a=s.makeUrl(a),c=0;c<e.length;c++)if(a===s.makeUrl(e[c].url)){d=e[c];break}return d}function l(a,b){var c,d,e,f,g=a.getElementsByTagName("source");for(c=0,d=g.length;d>c;c++)e=g[c],e[s.ns]=!0,f=e.getAttribute("srcset"),f&&b.push({srcset:f,media:e.getAttribute("media"),type:e.getAttribute("type"),sizes:e.getAttribute("sizes")})}function m(a,b){function c(b){var c,d=b.exec(a.substring(m));return d?(c=d[0],m+=c.length,c):void 0}function e(){var a,c,d,e,f,i,j,k,l,m=!1,o={};for(e=0;e<h.length;e++)f=h[e],i=f[f.length-1],j=f.substring(0,f.length-1),k=parseInt(j,10),l=parseFloat(j),X.test(j)&&"w"===i?((a||c)&&(m=!0),0===k?m=!0:a=k):Y.test(j)&&"x"===i?((a||c||d)&&(m=!0),0>l?m=!0:c=l):X.test(j)&&"h"===i?((d||c)&&(m=!0),0===k?m=!0:d=k):m=!0;m||(o.url=g,a&&(o.w=a),c&&(o.d=c),d&&(o.h=d),d||c||a||(o.d=1),1===o.d&&(b.has1x=!0),o.set=b,n.push(o))}function f(){for(c(T),i="",j="in descriptor";;){if(k=a.charAt(m),"in descriptor"===j){if(d(k))i&&(h.push(i),i="",j="after descriptor");else{if(","===k)return m+=1,i&&h.push(i),void e();if("("===k)i+=k,j="in parens";else{if(""===k)return i&&h.push(i),void e();i+=k}}}else if("in parens"===j){if(")"===k)i+=k,j="in descriptor";else{if(""===k)return h.push(i),void e();i+=k}}else if("after descriptor"===j)if(d(k));else{if(""===k)return void e();j="in descriptor",m-=1}m+=1}}for(var g,h,i,j,k,l=a.length,m=0,n=[];;){if(c(U),m>=l)return n;g=c(V),h=[],","===g.slice(-1)?(g=g.replace(W,""),e()):f()}}function n(a){function b(a){function b(){f&&(g.push(f),f="")}function c(){g[0]&&(h.push(g),g=[])}for(var e,f="",g=[],h=[],i=0,j=0,k=!1;;){if(e=a.charAt(j),""===e)return b(),c(),h;if(k){if("*"===e&&"/"===a[j+1]){k=!1,j+=2,b();continue}j+=1}else{if(d(e)){if(a.charAt(j-1)&&d(a.charAt(j-1))||!f){j+=1;continue}if(0===i){b(),j+=1;continue}e=" "}else if("("===e)i+=1;else if(")"===e)i-=1;else{if(","===e){b(),c(),j+=1;continue}if("/"===e&&"*"===a.charAt(j+1)){k=!0,j+=2;continue}}f+=e,j+=1}}}function c(a){return k.test(a)&&parseFloat(a)>=0?!0:l.test(a)?!0:"0"===a||"-0"===a||"+0"===a?!0:!1}var e,f,g,h,i,j,k=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,l=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(f=b(a),g=f.length,e=0;g>e;e++)if(h=f[e],i=h[h.length-1],c(i)){if(j=i,h.pop(),0===h.length)return j;if(h=h.join(" "),s.matchesMedia(h))return j}return"100vw"}b.createElement("picture");var o,p,q,r,s={},t=!1,u=function(){},v=b.createElement("img"),w=v.getAttribute,x=v.setAttribute,y=v.removeAttribute,z=b.documentElement,A={},B={algorithm:""},C="data-pfsrc",D=C+"set",E=navigator.userAgent,F=/rident/.test(E)||/ecko/.test(E)&&E.match(/rv\:(\d+)/)&&RegExp.$1>35,G="currentSrc",H=/\s+\+?\d+(e\d+)?w/,I=/(\([^)]+\))?\s*(.+)/,J=a.picturefillCFG,K="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",L="font-size:100%!important;",M=!0,N={},O={},P=a.devicePixelRatio,Q={px:1,in:96},R=b.createElement("a"),S=!1,T=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,V=/^[^ \t\n\r\u000c]+/,W=/[,]+$/,X=/^\d+$/,Y=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Z=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)},$=function(a){var b={};return function(c){return c in b||(b[c]=a(c)),b[c]}},_=function(){var a=/^([\d\.]+)(em|vw|px)$/,b=function(){for(var a=arguments,b=0,c=a[0];++b in a;)c=c.replace(a[b],a[++b]);return c},c=$((function(a){return"return "+b((a||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"}));return function(b,d){var e;if(!(b in N))if(N[b]=!1,d&&(e=b.match(a)))N[b]=e[1]*Q[e[2]];else try{N[b]=new Function("e",c(b))(Q)}catch(f){}return N[b]}}(),aa=function(a,b){return a.w?(a.cWidth=s.calcListLength(b||"100vw"),a.res=a.w/a.cWidth):a.res=a.d,a},ba=function(a){if(t){var c,d,e,f=a||{};if(f.elements&&1===f.elements.nodeType&&("IMG"===f.elements.nodeName.toUpperCase()?f.elements=[f.elements]:(f.context=f.elements,f.elements=null)),c=f.elements||s.qsa(f.context||b,f.reevaluate||f.reselect?s.sel:s.selShort),e=c.length){for(s.setupRun(f),S=!0,d=0;e>d;d++)s.fillImg(c[d],f);s.teardownRun(f)}}};o=a.console&&console.warn?function(a){console.warn(a)}:u,G in v||(G="src"),A["image/jpeg"]=!0,A["image/gif"]=!0,A["image/png"]=!0,A["image/svg+xml"]=b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),s.ns=("pf"+(new Date).getTime()).substr(0,9),s.supSrcset="srcset"in v,s.supSizes="sizes"in v,s.supPicture=!!a.HTMLPictureElement,s.supSrcset&&s.supPicture&&!s.supSizes&&!function(a){v.srcset="data:,a",a.src="data:,a",s.supSrcset=v.complete===a.complete,s.supPicture=s.supSrcset&&s.supPicture}(b.createElement("img")),s.supSrcset&&!s.supSizes?!function(){var a="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",c="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d=b.createElement("img"),e=function(){var a=d.width;2===a&&(s.supSizes=!0),q=s.supSrcset&&!s.supSizes,t=!0,setTimeout(ba)};d.onload=e,d.onerror=e,d.setAttribute("sizes","9px"),d.srcset=c+" 1w,"+a+" 9w",d.src=c}():t=!0,s.selShort="picture>img,img[srcset]",s.sel=s.selShort,s.cfg=B,s.DPR=P||1,s.u=Q,s.types=A,s.setSize=u,s.makeUrl=$((function(a){return R.href=a,R.href})),s.qsa=function(a,b){return"querySelector"in a?a.querySelectorAll(b):[]},s.matchesMedia=function(){return a.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?s.matchesMedia=function(a){return!a||matchMedia(a).matches}:s.matchesMedia=s.mMQ,s.matchesMedia.apply(this,arguments)},s.mMQ=function(a){return a?_(a):!0},s.calcLength=function(a){var b=_(a,!0)||!1;return 0>b&&(b=!1),b},s.supportsType=function(a){return a?A[a]:!0},s.parseSize=$((function(a){var b=(a||"").match(I);return{media:b&&b[1],length:b&&b[2]}})),s.parseSet=function(a){return a.cands||(a.cands=m(a.srcset,a)),a.cands},s.getEmValue=function(){var a;if(!p&&(a=b.body)){var c=b.createElement("div"),d=z.style.cssText,e=a.style.cssText;c.style.cssText=K,z.style.cssText=L,a.style.cssText=L,a.appendChild(c),p=c.offsetWidth,a.removeChild(c),p=parseFloat(p,10),z.style.cssText=d,a.style.cssText=e}return p||16},s.calcListLength=function(a){if(!(a in O)||B.uT){var b=s.calcLength(n(a));O[a]=b?b:Q.width}return O[a]},s.setRes=function(a){var b;if(a){b=s.parseSet(a);for(var c=0,d=b.length;d>c;c++)aa(b[c],a.sizes)}return b},s.setRes.res=aa,s.applySetCandidate=function(a,b){if(a.length){var c,d,e,f,h,k,l,m,n,o=b[s.ns],p=s.DPR;if(k=o.curSrc||b[G],l=o.curCan||j(b,k,a[0].set),l&&l.set===a[0].set&&(n=F&&!b.complete&&l.res-.1>p,n||(l.cached=!0,l.res>=p&&(h=l))),!h)for(a.sort(i),f=a.length,h=a[f-1],d=0;f>d;d++)if(c=a[d],c.res>=p){e=d-1,h=a[e]&&(n||k!==s.makeUrl(c.url))&&g(a[e].res,c.res,p,a[e].cached)?a[e]:c;break}h&&(m=s.makeUrl(h.url),o.curSrc=m,o.curCan=h,m!==k&&s.setSrc(b,h),s.setSize(b))}},s.setSrc=function(a,b){var c;a.src=b.url,"image/svg+xml"===b.set.type&&(c=a.style.width,a.style.width=a.offsetWidth+1+"px",a.offsetWidth+1&&(a.style.width=c))},s.getSet=function(a){var b,c,d,e=!1,f=a[s.ns].sets;for(b=0;b<f.length&&!e;b++)if(c=f[b],c.srcset&&s.matchesMedia(c.media)&&(d=s.supportsType(c.type))){"pending"===d&&(c=d),e=c;break}return e},s.parseSets=function(a,b,d){var e,f,g,h,i=b&&"PICTURE"===b.nodeName.toUpperCase(),j=a[s.ns];(j.src===c||d.src)&&(j.src=w.call(a,"src"),j.src?x.call(a,C,j.src):y.call(a,C)),(j.srcset===c||d.srcset||!s.supSrcset||a.srcset)&&(e=w.call(a,"srcset"),j.srcset=e,h=!0),j.sets=[],i&&(j.pic=!0,l(b,j.sets)),j.srcset?(f={srcset:j.srcset,sizes:w.call(a,"sizes")},j.sets.push(f),g=(q||j.src)&&H.test(j.srcset||""),g||!j.src||k(j.src,f)||f.has1x||(f.srcset+=", "+j.src,f.cands.push({url:j.src,d:1,set:f}))):j.src&&j.sets.push({srcset:j.src,sizes:null}),j.curCan=null,j.curSrc=c,j.supported=!(i||f&&!s.supSrcset||g&&!s.supSizes),h&&s.supSrcset&&!j.supported&&(e?(x.call(a,D,e),a.srcset=""):y.call(a,D)),j.supported&&!j.srcset&&(!j.src&&a.src||a.src!==s.makeUrl(j.src))&&(null===j.src?a.removeAttribute("src"):a.src=j.src),j.parsed=!0},s.fillImg=function(a,b){var c,d=b.reselect||b.reevaluate;a[s.ns]||(a[s.ns]={}),c=a[s.ns],(d||c.evaled!==r)&&((!c.parsed||b.reevaluate)&&s.parseSets(a,a.parentNode,b),c.supported?c.evaled=r:h(a))},s.setupRun=function(){(!S||M||P!==a.devicePixelRatio)&&f()},s.supPicture?(ba=u,s.fillImg=u):!function(){var c,d=a.attachEvent?/d$|^c/:/d$|^c|^i/,e=function(){var a=b.readyState||"";f=setTimeout(e,"loading"===a?200:999),b.body&&(s.fillImgs(),c=c||d.test(a),c&&clearTimeout(f))},f=setTimeout(e,b.body?9:99),g=function(a,b){var c,d,e=function(){var f=new Date-d;b>f?c=setTimeout(e,b-f):(c=null,a())};return function(){d=new Date,c||(c=setTimeout(e,b))}},h=z.clientHeight,i=function(){M=Math.max(a.innerWidth||0,z.clientWidth)!==Q.width||z.clientHeight!==h,h=z.clientHeight,M&&s.fillImgs()};Z(a,"resize",g(i,99)),Z(b,"readystatechange",e)}(),s.picturefill=ba,s.fillImgs=ba,s.teardownRun=u,ba._=s,a.picturefillCFG={pf:s,push:function(a){var b=a.shift();"function"==typeof s[b]?s[b].apply(s,a):(B[b]=a[0],S&&s.fillImgs({reselect:!0}))}};for(;J&&J.length;)a.picturefillCFG.push(J.shift());a.picturefill=ba,true&&"object"==typeof module.exports?module.exports=ba:true&&!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return ba}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),s.supPicture||(A["image/webp"]=e("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document)},"4Vge":function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var _root_modal__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("8hYQ");var newsletter=function(){var isPublic={},isPrivate={};isPublic.modal=function(config){config=config?config:{};config.clone=config.clone?config.clone:"#e2ma_signup";if($(config.clone).length>0){if(config.delay){setTimeout(isPrivate.renderModal(config),config.delay)}else{isPrivate.renderModal(config)}}else{console.error("Newsletter form not present on page")}};isPrivate.renderModal=function(config){if(!config.element){config.element={}}config.element.type="<div class='newsletter-container'></div>";var nlForm=$(config.clone).clone();nlForm.removeClass("hidden");nlForm.attr({style:"",id:"e2ma-signup-popup"});config.header=config.header?config.header:"Email Newsletter";config.element.contents='<section class="newsletter-modal"><header><h1>'+config.header+(config.subheader?"<small>"+config.subheader+"</small>":"")+'</h1></header><section class="main-modal-content">'+nlForm[0].outerHTML+"</section></section>";var modalParent=_root_modal__WEBPACK_IMPORTED_MODULE_0__["a"].render(config);isPublic.eventListeners($("#e2ma-signup-popup"),config)};isPrivate.validateEmail=function(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)};isPrivate.submit=function(e,config){console.debug("Newsletter Submission Started",e,config);var $form=$(e.target);var email=$form.find("#id_email").eq(0);email.removeClass("error");$form.find(".error-email").hide();if(isPrivate.validateEmail(email.val())){var data={email:email.val(),"what-are-you-most-interested-in":[],optInConfirmation:typeof config.verify!=="undefined"?config.verify:true,accountId:config.accountId?config.accountId:"1776482",groups:config.groups?config.groups:"1904482"};$form.find(":checkbox").each((function(){if($(this).is(":checked")){data["what-are-you-most-interested-in"].push($(this).val())}}));console.debug("Performing AJAX submission to Emma",data);$.ajax({type:"POST",cache:false,url:"https://signup-collector.e2ma.net/signup",data:JSON.stringify(data),contentType:"application/json",dataType:"text",success:function(t){}}).done((function(data){$form.find("label,input,ul").hide();$form.find(".success").show();console.debug("Emma AJAX Post done",data);if($form.parents(".newsletter-modal").length>0){$form.parents(".newsletter-modal").find("header").eq(0).hide();setTimeout((function(){$form.parents(".lightbox.active").removeClass("active")}),3e3)}})).fail((function(jqXHR,status){$form.find(".error").show();console.debug("Emma AJAX Post fail",jqXHR,status)}))}else{email.addClass("error");$form.find(".error-email").show()}};isPublic.eventListeners=function(target,config){target.find(":checkbox").each((function(){var checkbox=$(this);checkbox.parent().on("click",(function(){checkbox.click()}))}));target.on("submit",(function(e){isPrivate.submit(e,config);e.stopPropagation();e.preventDefault()}))};return isPublic}()}).call(this,__webpack_require__("3a3M"))},"4k2M":function(module,exports,__webpack_require__){"use strict";var f,g,h,k,l;if("undefined"===typeof window||"function"!==typeof MessageChannel){var p=null,q=null,t=function(){if(null!==p)try{var a=exports.unstable_now();p(!0,a);p=null}catch(b){throw setTimeout(t,0),b}},u=Date.now();exports.unstable_now=function(){return Date.now()-u};f=function(a){null!==p?setTimeout(f,0,a):(p=a,setTimeout(t,0))};g=function(a,b){q=setTimeout(a,b)};h=function(){clearTimeout(q)};k=function(){return!1};l=exports.unstable_forceFrameRate=function(){}}else{var w=window.performance,x=window.Date,y=window.setTimeout,z=window.clearTimeout;if("undefined"!==typeof console){var A=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills");"function"!==typeof A&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof w&&"function"===typeof w.now)exports.unstable_now=function(){return w.now()};else{var B=x.now();exports.unstable_now=function(){return x.now()-B}}var C=!1,D=null,E=-1,F=5,G=0;k=function(){return exports.unstable_now()>=G};l=function(){};exports.unstable_forceFrameRate=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):F=0<a?Math.floor(1e3/a):5};var H=new MessageChannel,I=H.port2;H.port1.onmessage=function(){if(null!==D){var a=exports.unstable_now();G=a+F;try{D(!0,a)?I.postMessage(null):(C=!1,D=null)}catch(b){throw I.postMessage(null),b}}else C=!1};f=function(a){D=a;C||(C=!0,I.postMessage(null))};g=function(a,b){E=y((function(){a(exports.unstable_now())}),b)};h=function(){z(E);E=-1}}function J(a,b){var c=a.length;a.push(b);a:for(;;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<K(e,b))a[d]=b,a[c]=e,c=d;else break a}}function L(a){a=a[0];return void 0===a?null:a}function M(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length;d<e;){var m=2*(d+1)-1,n=a[m],v=m+1,r=a[v];if(void 0!==n&&0>K(n,c))void 0!==r&&0>K(r,n)?(a[d]=r,a[v]=c,d=v):(a[d]=n,a[m]=c,d=m);else if(void 0!==r&&0>K(r,c))a[d]=r,a[v]=c,d=v;else break a}}return b}return null}function K(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var N=[],O=[],P=1,Q=null,R=3,S=!1,T=!1,U=!1;function V(a){for(var b=L(O);null!==b;){if(null===b.callback)M(O);else if(b.startTime<=a)M(O),b.sortIndex=b.expirationTime,J(N,b);else break;b=L(O)}}function W(a){U=!1;V(a);if(!T)if(null!==L(N))T=!0,f(X);else{var b=L(O);null!==b&&g(W,b.startTime-a)}}function X(a,b){T=!1;U&&(U=!1,h());S=!0;var c=R;try{V(b);for(Q=L(N);null!==Q&&(!(Q.expirationTime>b)||a&&!k());){var d=Q.callback;if(null!==d){Q.callback=null;R=Q.priorityLevel;var e=d(Q.expirationTime<=b);b=exports.unstable_now();"function"===typeof e?Q.callback=e:Q===L(N)&&M(N);V(b)}else M(N);Q=L(N)}if(null!==Q)var m=!0;else{var n=L(O);null!==n&&g(W,n.startTime-b);m=!1}return m}finally{Q=null,R=c,S=!1}}function Y(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var Z=l;exports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){T||S||(T=!0,f(X))};exports.unstable_getCurrentPriorityLevel=function(){return R};exports.unstable_getFirstCallbackNode=function(){return L(N)};exports.unstable_next=function(a){switch(R){case 1:case 2:case 3:var b=3;break;default:b=R}var c=R;R=b;try{return a()}finally{R=c}};exports.unstable_pauseExecution=function(){};exports.unstable_requestPaint=Z;exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=R;R=a;try{return b()}finally{R=c}};exports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();if("object"===typeof c&&null!==c){var e=c.delay;e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:Y(a)}else c=Y(a),e=d;c=e+c;a={id:P++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,J(O,a),null===L(N)&&a===L(O)&&(U?h():U=!0,g(W,e-d))):(a.sortIndex=c,J(N,a),T||S||(T=!0,f(X)));return a};exports.unstable_shouldYield=function(){var a=exports.unstable_now();V(a);var b=L(N);return b!==Q&&null!==Q&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<Q.expirationTime||k()};exports.unstable_wrapCallback=function(a){var b=R;return function(){var c=R;R=b;try{return a.apply(this,arguments)}finally{R=c}}}},"4lEA":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(a,b){true?!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return a.svg4everybody=b()}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)):undefined}(window,(function(){function a(a,b){if(b){var c=!a.getAttribute("viewBox")&&b.getAttribute("viewBox"),d=document.createDocumentFragment(),e=b.cloneNode(!0);for(c&&a.setAttribute("viewBox",c);e.childNodes.length;)d.appendChild(e.firstChild);a.appendChild(d)}}function b(b){b.onreadystatechange=function(){if(4===b.readyState){var c=document.createElement("x");c.innerHTML=b.responseText,b.s.splice(0).map((function(b){a(b[0],c.querySelector("#"+b[1].replace(/(\W)/g,"\\$1")))}))}},b.onreadystatechange()}function c(c){function d(){for(var c;c=e[0];){var j=c.parentNode;if(j&&/svg/i.test(j.nodeName)){var k=c.getAttribute("xlink:href");if(f&&(!g||g(k,j,c))){var l=k.split("#"),m=l[0],n=l[1];if(j.removeChild(c),m.length){var o=i[m]=i[m]||new XMLHttpRequest;o.s||(o.s=[],o.open("GET",m),o.send()),o.s.push([j,n]),b(o)}else a(j,document.getElementById(n))}}}h(d,17)}c=c||{};var e=document.getElementsByTagName("use"),f="shim"in c?c.shim:/\bEdge\/12\b|\bTrident\/[567]\b|\bVersion\/7.0 Safari\b/.test(navigator.userAgent)||(navigator.userAgent.match(/AppleWebKit\/(\d+)/)||[])[1]<537,g=c.validate,h=window.requestAnimationFrame||setTimeout,i={};f&&d()}return c}))},"5zeK":function(module,exports,__webpack_require__){(function(global,__dirname){(()=>{var __webpack_modules__={15:module=>{module.exports=unique;function unique(arr,sorted,strings){if(!Array.isArray(arr)){throw new Error("expected an array for the first argument")}if(sorted!=null&&typeof sorted!="boolean"){throw new Error("expected a boolean, null or undefined for the second argument")}if(strings!=null&&typeof strings!="boolean"){throw new Error("expected a boolean, null or undefined for the third argument")}if(!sorted&&strings&&arr[0]!==Object(arr[0])){return stringUnique(arr)}var result=[],duplicate,seenNaN,lastAdded;var len=arr.length;for(var i=0;i<len;i++){var elem=arr[i];if(typeof elem=="number"&&isNaN(elem)){duplicate=seenNaN;seenNaN=true}duplicate=duplicate||lastAdded&&lastAdded===elem;if(!duplicate&&!sorted){duplicate=result.indexOf(elem)>-1}if(!duplicate){result.push(elem);lastAdded=elem}else{duplicate=false}}return result}function stringUnique(arr){var lookup={};var len=arr.length;for(var i=0;i<len;i++){lookup[arr[i]]=true}return Object.keys(lookup)}},273:module=>{const createLocalStorageDriver=function(win){function getValue(key){return canUse()?JSON.parse(win.localStorage.getItem(key)):null}function setValue(key,value){if(canUse()){win.localStorage.setItem(key,JSON.stringify(value))}}function canUse(){try{return typeof win.localStorage!=="undefined"}catch(err){return false}}return{name:"localStorageDriver",getValue:getValue,setValue:setValue}};module.exports=createLocalStorageDriver},351:(module,__unused_webpack_exports,__nccwpck_require__)=>{const defaults=__nccwpck_require__(42);const{getLocalWindow:getLocalWindow}=__nccwpck_require__(426);const FETCH_OPTIONS={method:"POST"};const ERROR_RESPONSE_TTL=3600;const STORAGE_KEY="fmscw_resp";const storageDriverStub={name:"stubDriver - does nothing",getValue:()=>Promise.resolve(null),setValue:()=>Promise.resolve(false)};const FMS=function(defaultReqParams,wrapperOptions){const storageDriver=wrapperOptions.storageDriver||storageDriverStub;const apiUrl=wrapperOptions.url;const IDENTIFIER_KEYS=["userid","idfv","ifa","subscriberid","emailhash","liveramp_idl"];function getReqParams(reqParams){return defaults(reqParams,defaultReqParams)}function retrieveFromApi(reqParams){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(resolve=>{const _options=options;let timeoutReached=false;let timeoutHandler;const handleReject=err=>{const errResponse=errorResponse(reqParams,options.errorResponseTTL);cacheResponse(errResponse,reqParams);timeoutReached=true;console.error(err);if(timeoutHandler){clearTimeout(timeoutHandler)}resolve(errResponse)};if(_options.timeout&&typeof _options.timeout==="number"){const handler=createAbort();if(handler.available!==false){timeoutHandler=setTimeout(()=>{handler.abort()},_options.timeout);_options.signal=handler.signal}else{timeoutHandler=setTimeout(()=>{handleReject(new Error("FMS Lookup API request timeout exceeded."))},_options.timeout)}}const{timeout:timeout,errorResponseTTL:errorResponseTTL,url:url,...fetchOpts}=_options;getLocalWindow().fetch(_options.url||apiUrl,{...FETCH_OPTIONS,body:JSON.stringify(reqParams),...fetchOpts}).then(rawResponse=>rawResponse.json()).then(response=>{if(!timeoutReached){if(timeoutHandler){clearTimeout(timeoutHandler)}cacheResponse(response,reqParams);resolve({_fmscw:{origin:"api"},...response})}}).catch(err=>{handleReject(err)})})}async function retrieveFromStorage(){const result=await storageDriver.getValue(STORAGE_KEY);if(!result)return null;if(Date.now()>=result.expires)return null;return result}async function retrieve(reqParams){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const _reqParams=getReqParams(reqParams,options);if(typeof _reqParams.app==="undefined"||typeof _reqParams.app.coppa==="undefined"){throw new Error("fmscw.retrieve({...}) requires the passing of app.coppa to indicate if the page content is child directed.")}const result=await retrieveFromStorage();let response;if(!result){response=await retrieveFromApi(_reqParams,options)}else if(result.params&&isDifferentParams(result.params,_reqParams)){response=await retrieveFromApi(_reqParams,{...options,url:applyCacheBuster(options.url||apiUrl)})}else{response={...result.value,_fmscw:{origin:"storage"}}}return response}function cacheResponse(response,reqParams){if(response.fms_id_ttl){const CACHE_MS=response.fms_id_ttl*1e3;const expires=Date.now()+CACHE_MS;try{storageDriver.setValue(STORAGE_KEY,{expires:expires,params:reqParams,value:response})}catch(err){console.error(err)}}}function createAbort(){if(!getLocalWindow().AbortController)return{signal:undefined,abort:()=>false,available:false};return new AbortController}function errorResponse(reqParams,errorResponseTTL){const idKeys=Object.keys(reqParams.identifiers);let highestRankKey=idKeys.sort((a,b)=>IDENTIFIER_KEYS.indexOf(a)>IDENTIFIER_KEYS.indexOf(b)?-1:1)[0];let overrideValue;if(reqParams.app.coppa){overrideValue="7777777777";if(reqParams.identifiers&&reqParams.identifiers.userid){highestRankKey="userid"}else if(reqParams.identifiers&&!reqParams.identifiers.userid){reqParams[highestRankKey]=overrideValue}}const keyPrefix=reqParams.app&&reqParams.app.googledai?"imafw_fms_":"fms_";const vcidKey=reqParams.app&&reqParams.app.googledai?"imafw__fw_vcid2":"_fw_vcid2";return{_fmscw:{origin:"error"},fms_id_ttl:errorResponseTTL||ERROR_RESPONSE_TTL,fms_params:idKeys.reduce((result,key)=>{result[keyPrefix+key]=typeof overrideValue==="undefined"||key==="userid"?reqParams.identifiers[key]:overrideValue;return result},{[vcidKey]:reqParams.identifiers[highestRankKey],[keyPrefix+"vcid2type"]:highestRankKey})}}function isDifferentParams(oldParams,newParams){return hasHigherRank(newParams.identifiers,oldParams.identifiers)||isDifferent(oldParams.app,newParams.app)||isDifferent(oldParams.device,newParams.device,["lat"])}function isDifferent(obj1,obj2){let keys=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!obj1&&!obj2)return false;if(!obj1&&obj2)return true;let result=false;if(keys&&Array.isArray(keys)){for(let index=0;index<keys.length;index++){const key=keys[index];result=obj1[key]!==obj2[key];if(result)break}}else if(typeof obj2==="object"&&typeof obj1==="object"){for(const key in obj2){if(Object.hasOwnProperty.call(obj2,key)){result=obj1[key]!==obj2[key];if(result)break}}}return result}function applyCacheBuster(url){return url+(url.indexOf("?")>=0?"&":"?")+"v=".concat(Date.now())}function hasHigherRank(identityOne,identityTwo){if(!identityTwo)return true;const rankOrder=IDENTIFIER_KEYS;const rankOne=Math.max(...Object.keys(identityOne).map(v=>rankOrder.indexOf(v)));const rankTwo=Math.max(...Object.keys(identityTwo).map(v=>rankOrder.indexOf(v)));return rankOne>rankTwo}return{retrieve:retrieve,getReqParams:getReqParams,storageDriver:storageDriver,apiUrl:apiUrl,IDENTIFIER_KEYS:IDENTIFIER_KEYS}};module.exports={FMS:FMS,storageDriverStub:storageDriverStub}},42:(module,__unused_webpack_exports,__nccwpck_require__)=>{const justUnique=__nccwpck_require__(15);function defaults(){let obj=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let defaultValues=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const result={};const keys=justUnique([...Object.keys(obj),...Object.keys(defaultValues)]);for(let index=0;index<keys.length;index++){const key=keys[index];const defaultValue=defaultValues[key];const value=obj[key];if(typeof value==="object"&&typeof defaultValue==="object"){result[key]={...defaultValue,...value}}else{result[key]=value||defaultValue}}return result}module.exports=defaults},117:module=>{function getCookie(doc,key){if(!doc||!doc.cookie)return undefined;const match=doc.cookie.match(new RegExp("(^| )"+key+"=([^;]+)"));return match?match[2]:undefined}module.exports=getCookie},39:module=>{const DEFAULT_DAI=0;const DAI_SCRIPT_REF="imasdk.googleapis.com/js/sdkloader/ima3_dai.js";let daiValue=DEFAULT_DAI;function resetDai(){daiValue=DEFAULT_DAI}function getDAI(win,localWin){if(daiValue===DEFAULT_DAI){if(typeof win.google!=="undefined"&&win.google&&win.google.ima&&win.google.ima.dai){daiValue=1;return daiValue}let result=false;if(typeof win.performance!=="undefined"&&typeof win.performance.getEntriesByType!=="undefined"){result=!!win.performance.getEntriesByType("resource").find(v=>v.name.indexOf(DAI_SCRIPT_REF)>=0)}if(!result&&localWin&&typeof win.performance!=="undefined"&&typeof win.performance.getEntriesByType!=="undefined"){result=!!localWin.performance.getEntriesByType("resource").find(v=>v.name.indexOf(DAI_SCRIPT_REF)>=0)}daiValue=result?1:DEFAULT_DAI}return daiValue}module.exports={getDAI:getDAI,DEFAULT_DAI:DEFAULT_DAI,resetDai:resetDai}},248:module=>{function getDomain(hostname){return hostname.split(".").slice(-2).join(".")}module.exports=getDomain},426:module=>{let _localWin;function getLocalWindow(override){if(override){_localWin=override}else if(!_localWin&&typeof window==="undefined"){_localWin=global}else if(!_localWin){_localWin=window}return _localWin}function setLocalWindow(){let winOverrides=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_localWin=winOverrides}module.exports={setLocalWindow:setLocalWindow,getLocalWindow:getLocalWindow}},834:module=>{const DEFAULT_LAT=1;async function getNPAFlag(win){return new Promise(resolve=>{if(win.cbsoptanon&&win.cbsoptanon.cmd){win.cbsoptanon.cmd.push(cmp=>{if(cmp.constants.VERSION.major>=1&&cmp.constants.VERSION.minor>=1){cmp.ot.targetingAllowed(allowed=>{resolve(!allowed)})}else{win.cbsoptanon.onAdsReady((cmp,adOptions)=>{resolve(adOptions.npaFlag)})}})}else{resolve(DEFAULT_LAT)}})}module.exports={getNPAFlag:getNPAFlag,DEFAULT_LAT:DEFAULT_LAT}},486:module=>{let _win;function getWindow(override){if(override){_win=override}if(!_win){if(typeof window==="undefined"){_win=global}else{try{let origin=window.top.location.origin;_win=window.top}catch(err){try{let origin=window.parent.location.origin;_win=window.parent}catch(err){_win=window}}}}return _win}function setWindow(){let winOverrides=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_win=winOverrides}module.exports={getWindow:getWindow,setWindow:setWindow}},552:(module,__unused_webpack_exports,__nccwpck_require__)=>{const{FMS:FMS}=__nccwpck_require__(351);const{getWindow:getWindow}=__nccwpck_require__(486);const{getLocalWindow:getLocalWindow}=__nccwpck_require__(426);const webHandler=__nccwpck_require__(738);const fmsWebAio=webHandler(getWindow(),getLocalWindow());getLocalWindow().FMS=FMS;getWindow().fmscw=fmsWebAio;module.exports=fmsWebAio},738:(module,__unused_webpack_exports,__nccwpck_require__)=>{const defaults=__nccwpck_require__(42);const{FMS:FMS}=__nccwpck_require__(351);const createLocalStorageDriver=__nccwpck_require__(273);const getCookie=__nccwpck_require__(117);const{getNPAFlag:getNPAFlag,DEFAULT_LAT:DEFAULT_LAT}=__nccwpck_require__(834);const getDomain=__nccwpck_require__(248);const{getDAI:getDAI,DEFAULT_DAI:DEFAULT_DAI}=__nccwpck_require__(39);const pubcommonCookieKey="_pubcid";const webHandler=function(win){let localWin=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let _aioModifications={device:{lat:DEFAULT_LAT},app:{bundle:"",googledai:DEFAULT_DAI},identifiers:{}};let _npaSet=false;const npaPromise=retrieveAsyncModifications();const _fmscw=FMS({app:{webhost:getDomain(win.location.hostname),googledai:getDAI(win,localWin),bundle:""},device:{ua:win.navigator.userAgent}},{storageDriver:createLocalStorageDriver(win),url:"https://fms.viacomcbs.digital/lookup"});const _getReqParams=_fmscw.getReqParams;async function retrieveAsyncModifications(){const npaFlag=await getNPAFlag(win);_aioModifications.device.lat=npaFlag?1:0;if(!npaFlag&&getCookie(pubcommonCookieKey)){_aioModifications.identifiers.userid=getCookie(win.document,pubcommonCookieKey)}_npaSet=true}async function retrieve(reqParams,options){if(!_npaSet){await npaPromise}if(typeof reqParams==="undefined"||typeof reqParams.app==="undefined"||typeof reqParams.app.googledai==="undefined"){_aioModifications.app.googledai=getDAI(win,localWin)}return _fmscw.retrieve(defaults(reqParams,_aioModifications),options)}function getReqParams(reqParams){return _getReqParams(defaults(reqParams,_aioModifications))}_fmscw.getReqParams=getReqParams;return{..._fmscw,retrieve:retrieve}};module.exports=webHandler}};var __webpack_module_cache__={};function __nccwpck_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};var threw=true;try{__webpack_modules__[moduleId](module,module.exports,__nccwpck_require__);threw=false}finally{if(threw)delete __webpack_module_cache__[moduleId]}return module.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(552);module.exports=__webpack_exports__})()}).call(this,__webpack_require__("uKge"),"/")},"63rw":function(module,__webpack_exports__,__webpack_require__){"use strict";var js_cookie__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("06tH");var js_cookie__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_0__);var _root_Utility__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("0C8Z");var _root_shared_lib_consent__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("atHw");var _root_shared_utils_url__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("uLeD");const PopCultureAnalytics=function(){const handlers={};const results={};const reporters={};const _logger=_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].loggers("Analytics");let config={};function initialize(){let siteConfig=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_logger.success("Initializing",siteConfig);config=siteConfig;renderUTAG();initializeReporters()}async function renderUTAG(){await Object(_root_shared_lib_consent__WEBPACK_IMPORTED_MODULE_2__["a"])("performance");const env=false?undefined:"prod";let property=window.$cbc.CurrentSite.Property.toLowerCase().replace(".com","");if(property==="popculture"){property="popculturesite"}(function(a,b,c,d){a="//tags.tiqcdn.com/utag/cbsi/".concat(property,"/").concat(env,"/utag.js");b=document;c="script";d=b.createElement(c);d.src=a;d.type="text/java"+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})()}function registerHandler(name,handler){handlers[name]=handler}function registerReporter(name,reporter){reporters[name]=reporter}async function initializeReporters(){await Object(_root_shared_lib_consent__WEBPACK_IMPORTED_MODULE_2__["a"])("performance");for(const reporterName in reporters){const reporter=reporters[reporterName];if(!reporter.report){return}reporter.initialize(config)}}function report(reportSet){Object(_root_shared_lib_consent__WEBPACK_IMPORTED_MODULE_2__["a"])("performance").then(()=>{if(reportSet.constructor==Array){for(var i=0;i<reportSet.length;i++){reportHandler(reportSet[i])}}else{try{if(_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].debug){_logger.group("Reporting",reportSet.metric)}reportHandler(reportSet);_logger.success("Reported",reportSet);if(_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].debug){_logger.groupEnd()}}catch(err){_logger.error(err)}}})}function reportHandler(obj){var cfg=obj.report||obj;if(cfg&&_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].when(cfg,obj)){if(cfg.eval){cfg=Object.assign({},cfg,_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].evaluate(cfg))}for(var reporterName in reporters){if(reporters[reporterName].report===undefined){_logger.error("Reporters require report method.",reporterName,"failed constraint")}else if(typeof cfg.only!=="undefined"&&cfg.only.indexOf(reporterName)<0){_logger.info("Not reporting, report.only constraint",cfg)}else if(typeof cfg.except!=="undefined"&&cfg.except.indexOf(reporterName)>=0){_logger.info("Not reporting, report.except constraint",cfg)}else{reporters[reporterName].report(cfg)}}}else if(!_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].when(cfg)){_logger.info("Report failed when condition",cfg)}}function summary(specificReporter){if(specificReporter){if(!reporters[specificReporter]||!reporters[specificReporter].summary){error("Reporter or Reporter.summary Doesn't Exist",specificReporter);return false}reporters[specificReporter].summary()}else{for(var reporterName in reporters){if(reporters[specificReporter].summary){_logger.info("Generating Summary",reporterName);reporters[reporterName].summary()}}}}async function pageView(data){await Object(_root_shared_lib_consent__WEBPACK_IMPORTED_MODULE_2__["a"])("performance");for(const reporterName in reporters){if(typeof reporters[reporterName].pageView!=="undefined"){reporters[reporterName].pageView(data)}}}function getFTag(){const queryTag=Object(_root_shared_utils_url__WEBPACK_IMPORTED_MODULE_3__["a"])("ftag");if(queryTag){return queryTag}const cookieTag=js_cookie__WEBPACK_IMPORTED_MODULE_0___default.a.get("xfpFtag");if(cookieTag){return cookieTag}}function getTTag(){const queryTag=Object(_root_shared_utils_url__WEBPACK_IMPORTED_MODULE_3__["a"])("ttag");if(queryTag){return queryTag}const cookieTag=js_cookie__WEBPACK_IMPORTED_MODULE_0___default.a.get("xfpTtag");if(cookieTag){return cookieTag}}function getPagePath(url){var a=_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].url(url||window.location.href);var mp=_root_Utility__WEBPACK_IMPORTED_MODULE_1__["a"].url(window.location.href);var ftag=getFTag();var ttag=getTTag();var search=a.search;if(ftag&&search.indexOf("ftag")===-1){search=search+(search.indexOf("?")>=0?"&":"?")+"ftag="+ftag}if(ttag&&search.indexOf("ttag")===-1){search=search+(search.indexOf("?")>=0?"&":"?")+"ttag="+ttag}return[mp.protocol,"//",mp.host,a.pathname,search,a.hash].join("")}return{error:_logger.error,handlers:handlers,getFTag:getFTag,getTTag:getTTag,getPagePath:getPagePath,info:_logger.info,initialize:initialize,initializeReporters:initializeReporters,log:_logger.log,pageView:pageView,registerHandler:registerHandler,registerReporter:registerReporter,report:report,reportHandler:reportHandler,reporters:reporters,results:results,summary:summary,warn:_logger.warn}};__webpack_exports__["a"]=PopCultureAnalytics()},"6rbJ":function(module,exports,__webpack_require__){!function(t,e){true?module.exports=e():undefined}(this,(function(){"use strict";var t={exports:{}};!function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports}(t);var e={exports:{}};!function(t){var e=function(t){var e,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",u=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function o(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,i){return t[e]=i}}function l(t,e,i,n){var r=e&&e.prototype instanceof k?e:k,s=Object.create(r.prototype),u=new R(n||[]);return s._invoke=function(t,e,i){var n=c;return function(r,s){if(n===d)throw new Error("Generator is already running");if(n===v){if("throw"===r)throw s;return P()}for(i.method=r,i.arg=s;;){var u=i.delegate;if(u){var a=I(u,i);if(a){if(a===y)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===c)throw n=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=d;var o=h(t,e,i);if("normal"===o.type){if(n=i.done?v:f,o.arg===y)continue;return{value:o.arg,done:i.done}}"throw"===o.type&&(n=v,i.method="throw",i.arg=o.arg)}}}(t,i,u),s}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var c="suspendedStart",f="suspendedYield",d="executing",v="completed",y={};function k(){}function m(){}function p(){}var g={};o(g,s,(function(){return this}));var A=Object.getPrototypeOf,T=A&&A(A(_([])));T&&T!==i&&n.call(T,s)&&(g=T);var E=p.prototype=k.prototype=Object.create(g);function S(t){["next","throw","return"].forEach((function(e){o(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,s,u,a){var o=h(t[r],t,s);if("throw"!==o.type){var l=o.arg,c=l.value;return c&&"object"==typeof c&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,u,a)}),(function(t){i("throw",t,u,a)})):e.resolve(c).then((function(t){l.value=t,u(l)}),(function(t){return i("throw",t,u,a)}))}a(o.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function I(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,I(t,i),"throw"===i.method))return y;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=h(n,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,y;var s=r.arg;return s?s.done?(i[t.resultName]=s.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function _(t){if(t){var i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,u=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return u.next=u}}return{next:P}}function P(){return{value:e,done:!0}}return m.prototype=p,o(E,"constructor",p),o(p,"constructor",m),m.displayName=o(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,a,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},S(b.prototype),o(b.prototype,u,(function(){return this})),t.AsyncIterator=b,t.async=function(e,i,n,r,s){void 0===s&&(s=Promise);var u=new b(l(e,i,n,r),s);return t.isGeneratorFunction(i)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},S(E),o(E,a,"Generator"),o(E,s,(function(){return this})),o(E,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=_,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return a.type="throw",a.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var u=this.tryEntries[s],a=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var o=n.call(u,"catchLoc"),l=n.call(u,"finallyLoc");if(o&&l){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(o){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var u=s?s.completion:{};return u.type=t,u.arg=e,s?(this.method="next",this.next=s.finallyLoc,y):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),D(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;D(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:_(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(e);var i=e.exports,n={exports:{}},r={exports:{}},s={exports:{}};!function(t){function e(i){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(s),function(t){var e=s.exports;t.exports=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=e(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports}(r),function(t){var e=r.exports;function i(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(t,i,n){var r=e(t,i);if(r){var s=Object.getOwnPropertyDescriptor(r,i);return s.get?s.get.call(arguments.length<3?t:n):s.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(n);var u={exports:{}},a={exports:{}};!function(t){function e(i,n){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(a),function(t){var e=a.exports;t.exports=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&e(t,i)},t.exports.__esModule=!0,t.exports.default=t.exports}(u);var o={exports:{}},l={exports:{}};!function(t){function e(i){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(l);var h={exports:{}};!function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports}(h),function(t){var e=l.exports.default,i=h.exports;t.exports=function(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports}(o);var c={exports:{}};!function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}(c);var f={exports:{}};!function(t){function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}(f);var d=t.exports,v=d(i),y=d(n.exports),k=d(u.exports),m=d(o.exports),p=d(s.exports),g=d(c.exports),A=d(f.exports),T=d(l.exports);function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=(0,p.default)(t);if(e){var r=(0,p.default)(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return(0,m.default)(this,i)}}function S(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return u=t.done,t},e:function(t){a=!0,s=t},f:function(){try{u||null==i.return||i.return()}finally{if(a)throw s}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var I=Object.defineProperty,w=Object.getOwnPropertyDescriptor,D=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,C=function(t,e,i){return e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i},O=function(t,e){for(var i in e||(e={}))_.call(e,i)&&C(t,i,e[i]);if(R){var n,r=S(R(e));try{for(r.s();!(n=r.n()).done;){i=n.value;P.call(e,i)&&C(t,i,e[i])}}catch(t){r.e(t)}finally{r.f()}}return t},N=function(t){return function(e,i){return t&&t.get(e)||(i=function(t,e,i,n){if(e&&"object"===(0,T.default)(e)||"function"==typeof e){var r,s=S(D(e));try{var u=function(){var s=r.value;_.call(t,s)||!i&&"default"===s||I(t,s,{get:function(){return e[s]},enumerable:!(n=w(e,s))||n.enumerable})};for(s.s();!(r=s.n()).done;)u()}catch(t){s.e(t)}finally{s.f()}}return t}(I({},"__esModule",{value:!0}),e,1),t&&t.set(e,i),i)}}("undefined"!=typeof WeakMap?new WeakMap:0),M=function(t,e,i){return new Promise((function(n,r){var s=function(t){try{a(i.next(t))}catch(t){r(t)}},u=function(t){try{a(i.throw(t))}catch(t){r(t)}},a=function(t){return t.done?n(t.value):Promise.resolve(t.value).then(s,u)};a((i=i.apply(t,e)).next())}))},L={};!function(t,e){for(var i in e)I(t,i,{get:e[i],enumerable:!0})}(L,{GAM:function(){return ft},ID:function(){return yt},createGamPlugin:function(){return vt},createPlugin:function(){return kt},gam:function(){return dt},plugin:function(){return mt}});var x=function(){function t(e){(0,g.default)(this,t),this.req=e}return(0,A.default)(t,[{key:"adParameters",get:function(){return this.req.adTagParameters},set:function(t){this.req.adTagParameters=t}},{key:"apiKey",get:function(){return this.req.apiKey},set:function(t){this.req.apiKey=t}},{key:"authToken",get:function(){return this.req.authToken},set:function(t){this.req.authToken=t}},{key:"format",get:function(){return this.req.format||"hls"},set:function(t){this.req.format=t}},{key:"assetKey",get:function(){return this.req.assetKey},set:function(t){this.req.assetKey=t}}]),t}(),j=function(){function t(e,i,n,r){(0,g.default)(this,t),this.ad=null,this.type=e,this.data=n,this.detail=this.data,this.target=i,r&&(this.ad=r)}return(0,A.default)(t,[{key:"Type",get:function(){return t.Type}},{key:"getAd",value:function(){return this.ad}},{key:"getStreamData",value:function(){return this.data}}]),t}();j.Type={LOADED:"loaded",AD_BREAK_STARTED:"adBreakStarted",AD_BREAK_ENDED:"adBreakEnded",STARTED:"started",COMPLETE:"complete",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",AD_PERIOD_STARTED:"adPeriodStarted",AD_PERIOD_ENDED:"adPeriodEnded",CUEPOINTS_CHANGED:"cuePointsChanged",STREAM_INITIALIZED:"streamInitialized",ERROR:"error",AD_PROGRESS:"adProgress",CLICK:"click"};var B=function(){function t(e,i){(0,g.default)(this,t),this.data=e,this.podInfo=i}return(0,A.default)(t,[{key:"getAdId",value:function(){return this.data.ad_id}},{key:"getAdPodInfo",value:function(){return this.podInfo}},{key:"getAdSystem",value:function(){return this.data.advertiser||null}},{key:"getAdvertiserName",value:function(){return this.data.advertiser||null}},{key:"getApiFramework",value:function(){return null}},{key:"getCreativeAdId",value:function(){return this.data.creative_ad_id}},{key:"getCreativeId",value:function(){return this.data.creative_id}},{key:"getDealId",value:function(){return this.data.deal_id||null}},{key:"getDescription",value:function(){return this.data.description}},{key:"getDuration",value:function(){return this.data.duration}},{key:"getTitle",value:function(){return this.data.title}},{key:"getDaiWrapperData",value:function(){var t=null,e=null,i=null;if(this.data.wrappers&&this.data.wrappers[0]){var n=this.data.wrappers[0];t=n.ad_id,e=n.creative_id,i=n.creative_ad_id}return{adId:t,creativeId:e,creativeAdId:i}}},{key:"getWrapperAdIds",value:function(){return this.getWrapperPropArray("ad_id")}},{key:"getWrapperCreativeIds",value:function(){return this.getWrapperPropArray("creative_id")}},{key:"getWrapperCreativeAdIds",value:function(){return this.getWrapperPropArray("creative_ad_id")}},{key:"getWrapperAdSystems",value:function(){return this.getWrapperPropArray("system")}},{key:"getCompanionAds",value:function(){return null}},{key:"getWrapperPropArray",value:function(t){var e,i=[],n=this.data.wrappers||null;if(!n)return null;for(var r=0,s=n.length;r<s;r++)(e=n[r][t])&&""!==e&&i.push(e);return i}}]),t}(),F=function(){function t(e,i,n){(0,g.default)(this,t),this.data=e,this.podIdx=n,this.pos=i}return(0,A.default)(t,[{key:"getAdPosition",value:function(){return this.pos}},{key:"setAdPosition",value:function(t){this.pos=t}},{key:"getMaxDuration",value:function(){var t;return null==(t=this.data)?void 0:t.duration}},{key:"getPodIndex",value:function(){return this.podIdx}},{key:"setPodIndex",value:function(t){this.podIdx=t}},{key:"getTimeOffset",value:function(){return this.data.start}},{key:"getTotalAds",value:function(){return this.data.ads&&this.data.ads.length}}]),t}(),V=function(){function t(e,i,n,r){(0,g.default)(this,t),this.eventStatusMap={start:t.event.STARTED,firstquartile:t.event.FIRST_QUARTILE,midpoint:t.event.MIDPOINT,thirdquartile:t.event.THIRD_QUARTILE,complete:t.event.COMPLETE},this.adBreaks=[],this.currBreak=null,this.liveBreakInProgress=!1,this.currBreakIndex=null,this.currAd=null,this.currAdTzero=null,this.breakStatus={},this.breakPoints=[],this.pollId=null,this.lastRecordedTime=-1,this.playedAds=[],this.liveMetadata={},this.aviaSdk=r,this.emitter=new this.aviaSdk.Emitter,this.currEventStatus=this.createEventStatus(),this.currBreakIndex=null,this.vidIface=e,this.logger=n,this.setClickElement(i)}return(0,A.default)(t,[{key:"addEventListener",value:function(t,e){this.emitter.on(t,e)}},{key:"removeEventListener",value:function(t,e){this.emitter.off(t,e)}},{key:"requestStream",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.assetKey)return this.isLive=!0,void this.requestLiveStream(t,i);t.apiKey&&(t.adTagParameters["api-key"]=t.apiKey),t.authToken&&(t.adTagParameters["auth-token"]=t.authToken),this.aviaSdk.Util.request({method:"POST",errorRecovery:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:this.getUrl(t),data:t.adTagParameters,responseType:this.aviaSdk.ResponseType.JSON}).then((function(t){e.gatherStreamInfo(t),e.emitCues(),e.beginPoll(),e.emitLoaded(t)})).catch((function(t){var i="Error. Status: ".concat(t.status||"Unknown","; Message: ").concat(t.message);e.logger.log(e.aviaSdk.LogLevel.ERROR,i),e.emitError(i,e.aviaSdk.ErrorCode.DAI_NETWORK_ERROR)}))}},{key:"requestLiveStream",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.aviaSdk.request({method:"POST",errorRecovery:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:this.getUrl(t),data:t.adTagParameters}).then((function(t){if(!t.stream_manifest)throw new Error("DAI API: Stream Manifest not found in response");if(e.mediaVerificationUrl=t.media_verification_url,e.streamId=t.stream_id,e.emitLoaded(t),t.metadata_url){var i=1e3*t.polling_frequency;!function n(){clearTimeout(e.liveMetadataPollTimeout),e.aviaSdk.request({url:t.metadata_url,responseType:e.aviaSdk.ResponseType.JSON}).then((function(t){e.aviaSdk.Util.isEmpty(t.tags)||(e.liveMetadata={tags:O(O({},e.liveMetadata.tags),t.tags),ads:O(O({},e.liveMetadata.ads),t.ads),ad_breaks:O(O({},e.liveMetadata.ad_breaks),t.ad_breaks)})})).catch((function(t){e.aviaSdk.Logger.warn("DAI API StreamManager: polling error: ".concat(t))})).then((function(){e.liveMetadataPollTimeout=setTimeout(n,i)}))}()}else e.aviaSdk.Logger.warn("DAI API StreamManager: metadata_url not found in API response")})).catch((function(t){throw new Error("live api request error: "+t)}))}},{key:"setClickElement",value:function(t){var e=this;t&&(this.clickEl=t||null,this.clickThruHandler=function(){e.hClickThru()},this.clickEl.addEventListener("click",this.clickThruHandler))}},{key:"contentTimeForStreamTime",value:function(t){var e,i=this.adBreaks,n=0;void 0===t&&(t=this.streamDur);for(var r=0,s=i.length;r<s;r++){if(!(t>(e=i[r]).start))return t-n;if(!(t>=e.end))return e.start-n;if(n+=e.duration,r===s-1)return t-n}return t}},{key:"streamTimeForContentTime",value:function(t){for(var e,i=this.adBreaks,n=0,r=0,s=i.length;r<s&&(e=i[r],t>=this.contentTimeForStreamTime(i[r].start));r++)n+=e.duration;return t+n}},{key:"previousCuePointForStreamTime",value:function(t){for(var e,i=this.adBreaks,n=i.length;n--;)if(t>=(e=i[n]).start)return e.played?null:this.cuePointFromBreak(e);return null}},{key:"onTimedMetadata",value:function(t){this.isLive?this.processLiveMetadata(t):this.aviaSdk.request({url:this.mediaVerificationUrl+t.TXXX,responseType:this.aviaSdk.ResponseType.JSON})}},{key:"processMetadata",value:function(){}},{key:"reset",value:function(){clearTimeout(this.liveMetadataPollTimeout),clearInterval(this.pollId),this.clickEl&&this.clickEl.removeEventListener("click",this.clickThruHandler),this.clickEl=null,this.streamId=null,this.adBreaks=[],this.breakPoints=[],this.streamDur=NaN,this.currBreak=null,this.currBreakIndex=null,this.liveBreakInProgress=!1,this.currAd=null,this.mediaVerificationUrl=null,this.resetUponAdComplete(),this.lastRecordedTime=-1,this.pollId=null,this.liveMetadata=null}},{key:"processLiveMetadata",value:function(t){var e,i,n,r=this,s=t.TXXX||t.msg,u=this.liveMetadata,a=u&&(null==(e=Object.keys(u.tags||{}))?void 0:e.find((function(t){return s.includes(t)})));if(a){var o=u.tags[a],l=o.type,h=o.ad_break_id,c=u.ad_breaks[h].ads,f=u.ads[o.ad];if(this.hasPlayed(f.ad_id))"complete"===l&&c&&(null==f?void 0:f.position)===c&&(this.resetUponAdComplete(),this.endBreak());else if("start"===l){if(!this.liveBreakInProgress){var d=u.ad_breaks[h],v={adsTotal:d.ads,type:d.type,duration:d.duration};this.beginBreak(v)}this.beginAd(f,f.ad_id)}else if("complete"===l)(null==(i=this.currAd)?void 0:i.duration)&&this.emitProgress(null),this.currAd&&(this.markAsPlayed(f.ad_id),this.emitAdComplete()),this.resetUponAdComplete(),f.position===c&&this.endBreak();else if(this.currAd&&"progress"!==l&&this.eventStatusMap[l])this.emit(this.eventStatusMap[l],this.createStreamData({})),this.aviaSdk.request({url:this.mediaVerificationUrl+s,responseType:this.aviaSdk.ResponseType.JSON}).catch((function(){return r.logger.warn("DAI media verification error.")}));else if("progress"===l&&(null==f?void 0:f.ad_id)&&!this.hasPlayed(null==f?void 0:f.ad_id)){var y=(null==(n=this.currAd)?void 0:n.duration)?.001*(Date.now()-this.currAdTzero):0;this.emitProgress(y)}}else this.logger.warn("ID ".concat(s," not found in metadata.tags"))}},{key:"markAsPlayed",value:function(t){this.playedAds.push(t)}},{key:"hasPlayed",value:function(t){return t&&this.playedAds.indexOf(t)>=0}},{key:"beginPoll",value:function(){var t=this;clearInterval(this.pollId),this.pollId=setInterval((function(){t.checkState()}),100)}},{key:"checkState",value:function(){var t=this.vidIface.currentTime;if(!isNaN(t)&&t>0&&t>this.lastRecordedTime){if(!this.currBreak){var e=this.getBreakForStreamTime(t).break;e&&e.played?this.emitAdPeriodStarted(e):e&&(this.currBreak=e,this.beginBreak(e))}if(this.currBreak){var i=this.currBreak;t>=i.end?(this.monitorAdStatus(t,i),this.endBreak()):this.monitorAdStatus(t,i)}}!isNaN(t)&&t>=0&&(this.lastRecordedTime=t)}},{key:"monitorAdStatus",value:function(t,e){var i=e.ads,n=e.start;if(this.currAd)this.monitorCurrentAd(t);else for(var r,s=i.length;s--;)if((t>=(r=i[s].start||0)||void 0===r)&&!this.breakStatus["t_".concat(n)]["t_".concat(r)]){var u=e.type.toLowerCase();this.currBreakIndex="pre"===u?0:"mid"===u?e.index:-1,this.beginAd(i[s],r);break}}},{key:"monitorCurrentAd",value:function(t){for(var e,i=this.currAd.events,n=this.currEventStatus,r=!0,s=i.length;s--;)if(t>=(e=i[s]).time&&!n[e.type]){if(n[e.type]=!0,"complete"===e.type||t>=this.currAd.start+this.currAd.duration){r=!1,this.emitAdComplete(),this.resetUponAdComplete();break}if("start"!==e.type){r=!1,this.emit(this.eventStatusMap[e.type],this.createStreamData({}));break}}r&&this.emitProgress(t)}},{key:"resetUponAdComplete",value:function(){this.currEventStatus=this.createEventStatus(),this.currAd=null,this.currAdTzero=null}},{key:"beginBreak",value:function(e){this.currBreak=e,this.currBreak.played=!0,this.liveBreakInProgress=this.isLive,this.isLive||this.emitCues(),this.emit(t.event.AD_BREAK_STARTED,this.createStreamData({}))}},{key:"endBreak",value:function(){this.emit(t.event.AD_BREAK_ENDED,this.createStreamData({})),this.currBreak=null}},{key:"beginAd",value:function(e,i){var n,r,s;this.currAd=e,this.currBreak=this.isLive?null==(r=null==(n=this.liveMetadata)?void 0:n.ad_breaks)?void 0:r[e.ad_break_id]:this.currBreak,this.currAdTzero=Date.now(),this.isLive||(this.breakStatus["t_".concat(null==(s=this.currBreak)?void 0:s.start)]["t_".concat(i)]=!0,this.currEventStatus.start=!0);var u=new F(this.currBreak,this.currAd.seq||this.currAd.position,this.currBreakIndex||null),a=new B(this.currAd,u),o=new j(t.event.STARTED,this,this.createStreamData({}),a);this.emitter.dispatchEvt(o)}},{key:"hClickThru",value:function(){if(this.currAd){var e=this.currAd.clickthrough_url;e&&""!==e&&window.open(e),this.emit(t.event.CLICK)}}},{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=new j(t,this,e);this.emitter.dispatchEvt(i)}},{key:"emitCues",value:function(){this.isLive||this.emit(t.event.CUEPOINTS_CHANGED,this.createStreamData({cuepoints:this.assembleCuePoints()}))}},{key:"emitProgress",value:function(e,i){var n,r=this.createAdProgressData(e,i||(null==(n=this.currAd)?void 0:n.duration));this.emit(t.event.AD_PROGRESS,this.createStreamData({adProgressData:r}))}},{key:"emitLoaded",value:function(e){this.emit(t.event.LOADED,this.createStreamData({subtitles:e.subtitles,manifestFormat:this.getFormat(e.stream_manifest),url:e.stream_manifest,streamId:e.stream_id}))}},{key:"emitAdComplete",value:function(){this.isLive||this.emitProgress(null),this.emit(t.event.COMPLETE,this.createStreamData({}))}},{key:"emitError",value:function(e,i){var n=this.createStreamData({errorMessage:e,code:i});this.emit(t.event.ERROR,n)}},{key:"emitAdPeriodStarted",value:function(e){this.emitter.emit(t.event.AD_PERIOD_STARTED,this.createStreamData({streamResumeTime:e?e.start+e.duration+.1:null}))}},{key:"createAdProgressData",value:function(t){var e,i,n,r,s,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{adBreakDuration:(null==(e=this.currBreak)?void 0:e.duration)||null,adPeriodDuration:null,adPosition:(null==(i=this.currAd)?void 0:i.seq)||null,currentTime:t?this.aviaSdk.Util.clampValue(t-((null==(n=this.currAd)?void 0:n.start)||0),0,u||0):u||0,duration:u||-1,totalAds:(null==(s=null==(r=this.currBreak)?void 0:r.ads)?void 0:s.length)||null}}},{key:"createEventStatus",value:function(){return{start:!1,first:!1,mid:!1,third:!1,complete:!1}}},{key:"assembleCuePoints",value:function(){for(var t=[],e=0,i=this.adBreaks.length;e<i;e++)t.push(this.cuePointFromBreak(this.adBreaks[e]));return t}},{key:"getBreakForStreamTime",value:function(t){for(var e,i=0,n=this.adBreaks.length;i<n;i++)if(t>=(e=this.adBreaks[i]).start&&t-e.start<=1.5&&!this.currBreak)return{break:e,index:i};return{break:null,index:null}}},{key:"getUrl",value:function(t){var e=!!t.assetKey,i=e?"https://dai.google.com/linear/v1/{FORMAT}/event/{ASSET_KEY}/stream":"https://dai.google.com/ondemand/v1/{FORMAT}/content/{CONTENT_SOURCE_ID}/vid/{VIDEO_ID}/stream";return e?i.replace("{FORMAT}",t.format||"hls").replace("{ASSET_KEY}",t.assetKey):i.replace("{FORMAT}",t.format).replace("{CONTENT_SOURCE_ID}",t.contentSourceId).replace("{VIDEO_ID}",t.videoId)}},{key:"cuePointFromBreak",value:function(t){return{start:t.start,end:t.end,played:t.played}}},{key:"createStreamData",value:function(t){return{adProgressData:(null==t?void 0:t.adProgressData)||null,cuepoints:(null==t?void 0:t.cuepoints)||null,errorMessage:(null==t?void 0:t.errorMessage)||null,streamId:this.streamId||null,manifestFormat:(null==t?void 0:t.manifestFormat)||null,subtitles:(null==t?void 0:t.subtitles)||null,url:(null==t?void 0:t.url)||null,streamResumeTime:(null==t?void 0:t.streamResumeTime)||null,code:(null==t?void 0:t.code)||null}}},{key:"getFormat",value:function(t){return t.indexOf(".m3u8")>=0?this.aviaSdk.VideoFormat.HLS:t.indexOf(".mpd")>=0?this.aviaSdk.VideoFormat.DASH:this.aviaSdk.VideoFormat.UNKNOWN}},{key:"gatherBreakInfo",value:function(t){for(var e,i,n,r,s=t&&t.length||0,u=1,a=0;a<s;a++)if(n=(i=(e=t[a]).start)+(r=e.duration),this.breakPoints.push(i),this.adBreaks.push({duration:r,start:i,end:n,played:!1,type:e.type,ads:e.ads,index:a,seq:"mid"===e.type?u++:0}),!this.isLive)for(var o=this.breakStatus["t_"+i]={},l=0,h=e.ads.length;l<h;l++)o["t_"+(e.ads[l].start||0)]=!1}},{key:"gatherStreamInfo",value:function(t){this.streamDur=t.total_duration,this.mediaVerificationUrl=t.media_verification_url,this.streamId=t.stream_id,this.gatherBreakInfo(t.ad_breaks)}}]),t}(),U=V;U.event={LOADED:"loaded",STREAM_INITIALIZED:"streamInitialized",CUEPOINTS_CHANGED:"cuePointsChanged",AD_BREAK_STARTED:"adBreakStarted",AD_BREAK_ENDED:"adBreakEnded",STARTED:"started",COMPLETE:"complete",AD_PROGRESS:"adProgress",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",CLICK:"click",ERROR:"error",AD_PERIOD_STARTED:"adPeriodStarted",AD_PERIOD_ENDED:"adPeriodEnded"};var G={StreamManager:U,StreamEvent:j,VODStreamRequest:function(){function t(e){(0,g.default)(this,t),this.req=e}return(0,A.default)(t,[{key:"adTagParameters",get:function(){return this.req.adTagParameters},set:function(t){this.req.adTagParameters=t}},{key:"videoId",get:function(){return this.req.videoId},set:function(t){this.req.videoId=t}},{key:"contentSourceId",get:function(){return this.req.contentSourceId},set:function(t){this.req.contentSourceId=t}},{key:"apiKey",get:function(){return this.req.apiKey},set:function(t){this.req.apiKey=t}},{key:"authToken",get:function(){return this.req.authToken},set:function(t){this.req.authToken=t}},{key:"format",get:function(){return this.req.format||"hls"},set:function(t){this.req.format=t}},{key:"assetKey",get:function(){return this.req.assetKey},set:function(t){this.req.assetKey=t}}]),t}(),LiveStreamRequest:x},K=function(){function t(e,i){(0,g.default)(this,t),this.options=e,this.context=i}return(0,A.default)(t,[{key:"destroy",value:function(){this.options=null,this.context=null}},{key:"playClicked",value:function(){}},{key:"adService",get:function(){return this.options.adService}},{key:"player",get:function(){return this.context.player}},{key:"aviaSdk",get:function(){return this.context.avia}},{key:"csai",get:function(){return this.context.resource.ad.csai}},{key:"logger",get:function(){return this.context.logger}},{key:"log",value:function(t,e){if(this.logger.log(this.aviaSdk.LogLevel.DEBUG,"Ad Adapter (".concat(this.adService.getAdSystem(),"): ").concat(t)),e)for(var i in e)this.logger.log(this.aviaSdk.LogLevel.DEBUG,"".concat(i,": ").concat(e[i]))}}]),t}(),Q=function(){function t(e,i,n,r,s){(0,g.default)(this,t),this.breaks=[],this.streamDuration=i,this.appContext=e,r?this.createBreaksFromTimes(r):s&&this.createBreaksFromCuepoints(s,n)}return(0,A.default)(t,[{key:"destroy",value:function(){this.breaks=null,this.appContext=null}},{key:"getBreakById",value:function(t){return this.breaks.find((function(e){return e.breakId===t}))}},{key:"adBreaks",get:function(){return this.breaks}},{key:"updateBreaks",value:function(t){for(var e=[],i=t.length;i--;)t[i].played&&e.push(t[i].start);this.breaks.forEach((function(t){!t.hasPlayed&&e.indexOf(t.streamStartTime)>=0&&(t.hasPlayed=!0)}))}},{key:"getBreakForContentSeekTime",value:function(t){return this.processMid((function(e){return e.startTime<=t?e.hasPlayed?-1:e:null}))}},{key:"hasPlayed",value:function(t){var e=this.getBreakById(t);return!0===(null==e?void 0:e.hasPlayed)}},{key:"markPlayed",value:function(t){t.hasPlayed=!0}},{key:"processMid",value:function(t){var e=this,i=this.breaks.filter((function(t){return t.type===e.appContext.avia.AdBreakType.MID}));if(!i.length)return null;for(var n,r=i.length;r--;){if(-1===(n=t(i[r])))return null;if(n)return n}return null}},{key:"createBreaksFromCuepoints",value:function(t,e){var i,n,r,s,u,a,o=e(this.streamDuration),l=1;t.sort((function(t,e){return t.start-e.start}));for(var h=0,c=0,f=t.length;c<f;c++)i=t[c].start,s=(n=t[c].end)-i,u=i,i-h>=o&&(i=-1),h+=s,r=this.makeBrkId(i,i>0?l++:null),(a=this.makeBreak(e(u),r,u,this.appContext.avia.AdTechnology.SSAI)).endTime=n,a.duration=s,this.addBreak(a)}},{key:"createBreaksFromTimes",value:function(t){var e,i,n=1;t.sort((function(t,e){return t-e}));for(var r=0,s=t.length;r<s;r++)e=t[r],i=this.makeBrkId(e,e>0?n++:null),this.addBreak(this.makeBreak(e,i,null,this.appContext.avia.AdTechnology.CSAI))}},{key:"addBreak",value:function(t){this.breaks.push(t)}},{key:"makeBreak",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0,r=this.appContext.avia;return{adTechnology:n,startTime:t,hasPlayed:!1,streamStartTime:null!=i?i:null,breakId:e,type:0===t?r.AdBreakType.PRE:-1===t?r.AdBreakType.POST:r.AdBreakType.MID}}},{key:"makeBrkId",value:function(t,e){return(0===t?"pre":-1===t?"post":"mid")+(t>0?"_".concat(e):"_0")}}]),t}(),q="codec:ac-3,codec:ec-3",H="[RANDOM]",z="sz",W="640x480",Y="640x483",X="imafw__fw_h_referer",Z="imafw_host";function $(t,e){var i=e.muted,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,s=t.adParameters,u=i,a=!1,o=!1;for(var l in t.filterOutPremiumAudioCodecs&&(s["dai-excl"]=q),s)l===z&&u&&s[l]===W&&(s[l]=Y),s[l]===H&&(s[l]=tt()),l===Z&&(a=!0),l===X&&(o=!0);for(var h in n||(a||(s.imafw_host=et()),o||(s[X]=it())),r)h.indexOf("imafw_")>=0&&(s[h]=r[h]);var c={apiKey:t.apiKey,authToken:t.authToken||null,assetKey:t.assetKey||null,adTagParameters:s,videoId:t.videoId||null,contentSourceId:t.contentSourceId||null};return t.format&&"string"==typeof t.format&&(c.format=t.format),c}function J(t,e){var i;t.omidAccessModeRules={},t.omidAccessModeRules[null==(i=e.OmidAccessMode)?void 0:i.FULL]=[new RegExp(".*")]}function tt(){var t=String(Math.round(1e15+9e15*Math.random()));if(t.length<16)for(;t.length<16;)t+="0";return t.length>16&&(t=t.substr(0,17)),t}function et(){return new URL(window.location.href).host}function it(){return null==document?void 0:document.referrer}var nt=function(t){(0,k.default)(i,t);var e=E(i);function i(t,n){var r;return(0,g.default)(this,i),(r=e.call(this,t,n)).streamInfo={mediaUrl:null,streamId:null},r.adBreakSchedule=null,r.streamDuration=NaN,r.contentDuration=NaN,r.breakMetadataPending=!1,r.breaksReleased=!1,r.adBreakInProgress=!1,r.breakCount=0,r.isIgnoringEvents=!1,r.pendingStartTime=null,r.breakPending=!1,r.omEnabled=!0,r.adSegmentStarted=!1,r.eventStallTimeoutHandle=null,r.eventStallTimeout=3e3,r.adPaused=!1,r.omEnabled=t.enableOm,r.sdk=r.adService.sdk,r.streamManager=null,r.streamEventHandler=function(t){r.hStreamEvent(t)},r.adPlayPauseHandler=function(t){t.type===r.aviaSdk.PlayerEvent.AD_PAUSED?(r.adPaused=!0,clearTimeout(r.eventStallTimeoutHandle)):r.adPaused=!1},r.delegate=n.getDelegate(),r}return(0,A.default)(i,[{key:"destroy",value:function(){var t,e,n;clearTimeout(this.eventStallTimeoutHandle),null==(t=this.streamManager)||t.reset(),this.listenToStreamManager(!1),null==(e=this.player)||e.off(this.aviaSdk.PlayerEvent.AD_PAUSED,this.adPlayPauseHandler),null==(n=this.player)||n.off(this.aviaSdk.PlayerEvent.AD_PLAYING,this.adPlayPauseHandler),this.sdk=null,this.adBreakSchedule=null,this.streamManager=null,(0,y.default)((0,p.default)(i.prototype),"destroy",this).call(this)}},{key:"skipAd",value:function(){}},{key:"getResource",value:function(){return M(this,null,v.default.mark((function t(){var e,i,n,r,s,u,a,o=this;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.context.resource,n=(null==(e=i.ad)?void 0:e.ssai)||{},r=n.adParameters,s=n.authToken,u=n.format,a=n.assetKey,this.streamManager=this.adService.getStreamManager(),t.abrupt("return",new Promise((function(t,e){if(o.aviaSdk.Util.eventsToPromise([{target:o.streamManager,events:[o.sdk.StreamEvent.Type.LOADED]}],[{target:o.streamManager,events:[o.sdk.StreamEvent.Type.ERROR]}]).then((function(n){var r=n.getStreamData();if(!o.initializeWithStreamData(r))return o.log("Media url not found in DAI stream response"),void e(new Error("DAI data error: missing media url"));if(o.log("Stream metadata loaded"),i.playback.startTime){var s=o.streamManager.streamTimeForContentTime(i.playback.startTime);i.ad.showPrerollOnNonZeroStart?(i.playback.startTime=NaN,o.pendingStartTime=s):i.playback.startTime=s}i.location.mediaUrl=o.streamInfo.mediaUrl,t(i)})).catch((function(t){o.log("Stream request error",t),e(new o.context.avia.PlayerError(t.detail.code,t.detail.errorMessage))})),a)o.requestLiveStream(new o.sdk.LiveStreamRequest({assetKey:a,adTagParameters:r,authToken:s,format:u}));else{var n=$(i.ad.ssai,{muted:o.context.muted,autoplay:o.context.autoplay},!o.context.system.isDesktop&&!o.context.system.isMobile,{playername_version:o.context.buildInfo.playerName,imafw_playername_version:o.context.buildInfo.playerVersion});o.requestVODStream(new o.sdk.VODStreamRequest(n))}})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"start",value:function(){return M(this,null,v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.delegate.streamIdAvailable(this.streamInfo.streamId),this.delegate.resumeContent();case 2:case"end":return t.stop()}}),t,this)})))}},{key:"handleTimedMetadata",value:function(t){var e={TXXX:t.TXXX||t.msg};this.streamManager.onTimedMetadata(e)}},{key:"contentTimeForStreamTime",value:function(t){return this.streamManager.contentTimeForStreamTime(t)}},{key:"streamTimeForContentTime",value:function(t){return this.streamManager.streamTimeForContentTime(t)}},{key:"getPermittedSeekTime",value:function(t){if(this.adBreakSchedule){var e=this.adBreakSchedule.getBreakForContentSeekTime(t);if(e&&!e.hasPlayed)return e.hasPlayed=!0,this.breakPending=!0,e.streamStartTime}return this.streamManager.streamTimeForContentTime(t)}},{key:"setStreamTime",value:function(t){this.adService.setCurrentTime(t),this.adBreakInProgress||this.breakPending||this.checkForAdPeriod(t)}},{key:"setStreamDuration",value:function(t){this.streamDuration=t,this.contentDuration=this.streamManager.contentTimeForStreamTime(t),this.adService.setDuration(t),this.pendingCues&&this.updateBreakSchedule(this.pendingCues)}},{key:"contentComplete",value:function(){this.streamManager.reset()}},{key:"setVolume",value:function(){}},{key:"setMuteState",value:function(){}},{key:"setContentBitrate",value:function(){}},{key:"updateSize",value:function(){}},{key:"setFullscreenState",value:function(){}},{key:"signalAdPeriodEndAfterDelay",value:function(){var t=this;this.eventStallTimeoutHandle=setTimeout((function(){t.log("No ad events have occurred for ".concat(t.eventStallTimeout," sec.; ending ad segment.")),t.endAdSegment()}),this.eventStallTimeout)}},{key:"signalError",value:function(t,e,i){this.delegate.adError({code:e||this.aviaSdk.ErrorCode.AD_ADAPTER_ERROR,message:t,cause:{streamId:this.streamInfo.streamId||null},fatal:i})}},{key:"checkForAdPeriod",value:function(t){var e,i=null==(e=this.adBreakSchedule)?void 0:e.adBreaks,n=null==i?void 0:i.length;if(n)for(var r=0;r<n;r++){var s=i[r],u=s.streamStartTime-t,a=u<.3&&u>-.2,o=s.endTime-t>=3;if(s.hasPlayed&&a&&o){this.delegate.seekToStreamTime(s.endTime);break}}}},{key:"requestVODStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.omEnabled&&this.adService.omEnabled&&J(t,this.sdk),this.isLiveStream=!1,this.streamManager.requestStream(t,e)}},{key:"requestLiveStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.omEnabled&&this.adService.omEnabled&&J(t,this.sdk),this.isLiveStream=!0,this.streamManager.requestStream(t,e)}},{key:"hStreamEvent",value:function(t){if(this.sdk&&this.adService&&!this.isIgnoringEvents){var e=t.type,i=this.sdk.StreamEvent.Type;this.breakPending=!1;var n=!1;switch(clearTimeout(this.eventStallTimeoutHandle),e){case i.CUEPOINTS_CHANGED:var r=t.getStreamData().cuepoints;this.contentDuration?this.updateBreakSchedule(r):this.pendingCues=r;break;case i.AD_BREAK_STARTED:n=!0,this.breakMetadataPending=!0;break;case i.STARTED:var s=t.getAd();this.handleAdStart(s,i.STARTED);break;case i.AD_PROGRESS:if(n=!0,this.adBreakInProgress){var u=t.getStreamData().adProgressData;this.delegate.adProgress(u.currentTime,u.duration)}break;case i.FIRST_QUARTILE:n=!0,this.adBreakInProgress&&(this.trackQuartile(i.FIRST_QUARTILE),this.delegate.adFirstQuartile());break;case i.MIDPOINT:n=!0,this.adBreakInProgress&&(this.trackQuartile(i.MIDPOINT),this.delegate.adMidpoint());break;case i.THIRD_QUARTILE:n=!0,this.adBreakInProgress&&(this.trackQuartile(i.THIRD_QUARTILE),this.delegate.adThirdQuartile());break;case i.COMPLETE:this.adBreakInProgress&&this.handleAdComplete(i.COMPLETE);break;case i.AD_BREAK_ENDED:case i.AD_PERIOD_ENDED:this.adBreakInProgress&&(this.adBreakInProgress=!1,this.delegate.adBreakComplete(),this.endAdSegment(),this.pendingStartTime&&this.delegate.seekToStreamTime(this.pendingStartTime)),this.endAdSegment();break;case i.CLICK:this.delegate.adClicked();break;case i.ERROR:this.adBreakInProgress=!1,this.log("Error event SDK: ".concat(t.getStreamData().errorMessage)),this.signalError(t.getStreamData().errorMessage,this.aviaSdk.ErrorCode.DAI_DATA_ERROR,!1)}n&&!this.adSegmentStarted&&(this.adSegmentStarted=!0,this.delegate.adSegmentStarted()),this.adBreakInProgress&&!this.adPaused&&this.signalAdPeriodEndAfterDelay()}}},{key:"endAdSegment",value:function(){this.adSegmentStarted&&(this.adSegmentStarted=!1,this.delegate.adSegmentEnded())}},{key:"handleAdComplete",value:function(t){this.adService.usesDaiApi||(this.adService.trackAdEvent({context:this.adService.getAdSystem(),eventName:t,volume:this.adService.videoInterface.volume}),this.adService.untrackAd()),this.delegate.adComplete()}},{key:"trackQuartile",value:function(t){!this.adService.usesDaiApi&&this.adService.trackAdEvent({context:this.adService.getAdSystem(),eventName:t,volume:this.adService.videoInterface.volume})}},{key:"handleAdStart",value:function(t,e){var i,n,r=null==(i=this.adService)?void 0:i.assembleAdBreakInfo(t,this.aviaSdk.AdTechnology.SSAI),s=null==(n=this.adService)?void 0:n.assembleAdInfo(t,{mediaUrl:this.streamInfo.mediaUrl});!this.breakMetadataPending&&this.adBreakInProgress||(this.breakMetadataPending=!1,this.isLiveStream&&(r.adBreakPosition=++this.breakCount,r.adBreakType=this.aviaSdk.AdBreakType.MID),this.adSegmentStarted||(this.adSegmentStarted=!0,this.delegate.adSegmentStarted()),this.adBreakInProgress||this.delegate.adBreakStart(),r.adTechnology=this.aviaSdk.AdTechnology.SSAI,this.delegate.adBreakMetadata(r)),this.adBreakInProgress=!0,this.adService.usesDaiApi||(this.adService.trackAd(s),this.adService.trackAdEvent({context:this.adService.getAdSystem(),eventName:e,volume:this.adService.videoInterface.volume})),this.delegate.adStart(s)}},{key:"initializeWithStreamData",value:function(t){var e=t.url;if(!this.aviaSdk.Util.isString(e)||""===e)return!1;var i=t.streamId;return this.streamInfo.mediaUrl=e,this.streamInfo.streamId=i,this.listenToStreamManager(!0),this.player.on(this.aviaSdk.PlayerEvent.AD_PAUSED,this.adPlayPauseHandler),this.player.on(this.aviaSdk.PlayerEvent.AD_PLAYING,this.adPlayPauseHandler),!0}},{key:"listenToStreamManager",value:function(t){var e=this,i=t?"addEventListener":"removeEventListener",n=this.getEventInterests(),r=this.sdk.StreamEvent.Type;n.forEach((function(t){e.streamManager[i](r[t],e.streamEventHandler)}))}},{key:"getEventInterests",value:function(){return["CUEPOINTS_CHANGED","AD_BREAK_STARTED","AD_BREAK_ENDED","STARTED","COMPLETE","AD_PERIOD_STARTED","AD_PERIOD_ENDED","AD_PROGRESS","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","CLICK","ERROR"]}},{key:"updateBreakSchedule",value:function(t){var e,i,n,r=this,s=t&&t.length;if(s&&!this.adBreakSchedule){this.adBreakSchedule=new Q(this.context,this.streamDuration,(function(t){return r.streamManager.contentTimeForStreamTime(t)}),null,t);var u=this.context.resource,a=u.playback.startTime,o=this.adBreakSchedule.adBreaks;if(!u.ad.showPrerollOnNonZeroStart){var l=o[0];l.type===this.aviaSdk.AdBreakType.PRE&&(l.hasPlayed=!0)}for(var h=o.length;h--;){var c=o[h];if(c.startTime<a&&c.type!==this.aviaSdk.AdBreakType.POST){c.hasPlayed=!0;break}}}else s&&(null==(e=this.adBreakSchedule)||e.updateBreaks(t));!this.breaksReleased&&(null==(n=null==(i=this.adBreakSchedule)?void 0:i.adBreaks)?void 0:n.length)&&(this.delegate.adBreaksAvailable(this.adBreakSchedule.adBreaks),this.breaksReleased=!0),this.pendingCues=null}}]),i}(K),rt=function(t){(0,k.default)(i,t);var e=E(i);function i(t,n){var r;return(0,g.default)(this,i),(r=e.call(this,t,n)).isFullscreen=!1,r.inProgressAd=null,r.inProgressBreakId=null,r.isPaused=!1,r.buffering=!1,r.breakMetadataReleased=!1,r.breakStartReleased=!1,r.pendingSeekedBreakId=null,r.markedAsPlayed=[],r.adProgressData={lastRecordedTime:0,addTzero:null,pollTzero:null,timeoutHandle:null,stallThreshold:5,adId:null,duration:null,pollInterval:2e3},r.hAdsManagerAdError=function(t){var e=r.adService.parseAdError(t);r.log("AdsManager ERROR",e),r.delegate.adError({code:r.aviaSdk.ErrorCode.IMA_AD_ERROR,message:null==e?void 0:e.message,cause:e,fatal:!1})},r.hAdEvent=function(t){var e=r.sdk.AdEvent.Type,i=t.getAd(),n=t.getAdData();clearTimeout(r.adProgressData.timeoutHandle);var s=!1!==r.csai.enableStalledAdCheck;switch(t.type){case e.CONTENT_PAUSE_REQUESTED:s=!1,r.pendingSeekedBreakId=null,r.delegate.pauseContent();break;case e.CONTENT_RESUME_REQUESTED:s=!1,r.pendingSeekedBreakId=null,r.processBreakComplete();break;case e.LOADED:s=!1,r.processAdLoadOrStart(i,n,e.LOADED);break;case e.STARTED:s=!1,r.inProgressBreakId&&!r.breakStartReleased&&(r.breakStartReleased=!0,r.delegate.adBreakStart()),r.processAdLoadOrStart(i,n,e.STARTED),r.checkForCustomClickTracking(),r.beginPollForProgress(r.inProgressAd);break;case e.AD_PROGRESS:r.buffering&&(r.buffering=!1,r.delegate.adBuffering(!1)),r.processProgress();break;case e.FIRST_QUARTILE:r.processQuartile(e.FIRST_QUARTILE,"adFirstQuartile");break;case e.MIDPOINT:r.processQuartile(e.MIDPOINT,"adMidpoint");break;case e.THIRD_QUARTILE:r.processQuartile(e.THIRD_QUARTILE,"adThirdQuartile");break;case e.COMPLETE:s=!1,r.processAdComplete(e.COMPLETE);break;case e.ALL_ADS_COMPLETED:s=!1,r.processAllComplete();break;case e.AD_BUFFERING:r.buffering||(r.buffering=!0,r.delegate.adBuffering(!0));break;case e.CLICK:s=!1,r.adsManager.pause(),r.delegate.adClicked();break;case e.PAUSED:s=!1,r.isPaused=!0,r.delegate.adPaused();break;case e.RESUMED:r.buffering&&(r.buffering=!1,r.delegate.adBuffering(!1)),r.isPaused=!1,r.delegate.adResumed();break;case e.SKIPPED:s=!1,r.processSkip(e.SKIPPED);break;case e.LOG:s=!1,r.processLogEvent(n);break;case e.USER_CLOSE:s=!1,r.killAd();break;case e.VOLUME_CHANGED:case e.VOLUME_MUTED:r.processVolumeChange(t.type)}!r.isPaused&&s&&(r.adProgressData.timeoutHandle=setTimeout((function(){return r.checkAdProgress()}),r.adProgressData.pollInterval))},r.delegate=n.getDelegate(),r.presentationContainer=t.presentationContainer,r.sdk=r.adService.sdk,r.adsLoader=r.adService.adsLoader,r.adProgressData.stallThreshold=r.csai.stalledAdThreshold||r.adProgressData.stallThreshold,r.listenToAdsLoader(!0),r}return(0,A.default)(i,[{key:"destroy",value:function(){var t,e;clearTimeout(this.adProgressData.timeoutHandle),this.listenToAdsLoader(!1),this.listenToAdsManager(!1),null==(t=this.adsManager)||t.destroy(),null==(e=this.adsLoader)||e.contentComplete(),this.adBreakSchedule&&this.adBreakSchedule.destroy(),this.delegate=null,this.presentationContainer=null,this.adsManager=null,this.sdk=null,this.adsLoader=null,this.adBreakSchedule=null,this.renderingSettings=null,(0,y.default)((0,p.default)(i.prototype),"destroy",this).call(this)}},{key:"skipAd",value:function(){}},{key:"playClicked",value:function(){this.adService.initializeAdsLoader()}},{key:"start",value:function(){return M(this,null,v.default.mark((function t(){var e;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.csai.adCallUrl){t.next=4;break}return this.delegate.resumeContent(),t.abrupt("return");case 4:this.adService.initializeAdsLoader(),this.initialize(e);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"resume",value:function(){return M(this,null,v.default.mark((function t(){var e;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:clearTimeout(this.adProgressData.timeoutHandle),this.isPaused=!1,null==(e=this.adsManager)||e.resume();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"pause",value:function(){return M(this,null,v.default.mark((function t(){var e;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:clearTimeout(this.adProgressData.timeoutHandle),this.isPaused=!0,null==(e=this.adsManager)||e.pause();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"handleTimedMetadata",value:function(){}},{key:"updateSize",value:function(t){if(this.adsManager){var e=this.isFullscreen?this.sdk.ViewMode.FULLSCREEN:this.sdk.ViewMode.NORMAL;this.adsManager.resize(t.width,t.height,e)}}},{key:"contentComplete",value:function(){var t;null==(t=this.adsLoader)||t.contentComplete()}},{key:"getPermittedSeekTime",value:function(t){var e,i=null==(e=this.adBreakSchedule)?void 0:e.getBreakForContentSeekTime(t);return i&&-1===this.markedAsPlayed.indexOf(i.breakId)?(this.pendingSeekedBreakId=i.breakId,i.startTime):t}},{key:"setFullscreenState",value:function(t){this.isFullscreen=t}},{key:"setStreamTime",value:function(){}},{key:"setStreamDuration",value:function(){}},{key:"setVolume",value:function(t){var e,i=this.player.muted?0:this.aviaSdk.Util.clampValue(t,0,1);null==(e=this.adsManager)||e.setVolume(i)}},{key:"setMuteState",value:function(t){var e;null==(e=this.adsManager)||e.setVolume(t?0:this.player.volume)}},{key:"setContentBitrate",value:function(t){var e;this.renderingSettings&&(this.renderingSettings.bitrate=t,null==(e=this.adsManager)||e.updateAdsRenderingSettings(this.renderingSettings))}},{key:"startAds",value:function(){var t,e=this.getRect(),i=this.isFullscreen?this.sdk.ViewMode.FULLSCREEN:this.sdk.ViewMode.NORMAL;try{this.adsManager.init(e.width,e.height,i),this.adsManager.start()}catch(e){this.log("AdsManager init failure."),this.delegate.adError({code:this.aviaSdk.ErrorCode.IMA_INIT_FAILURE,message:null==(t=e.getMessage)?void 0:t.call(e),cause:e,fatal:!1})}}},{key:"markAsPlayed",value:function(t){var e=this;t.forEach((function(t){e.markedAsPlayed.indexOf(t)<0&&e.markedAsPlayed.push(t)}))}},{key:"cancelPendingBreak",value:function(t){this.pendingSeekedBreakId===t&&(this.pendingSeekedBreakId=null)}},{key:"isUsingContentVideoElement",value:function(){return this.adsManager&&this.adsManager.isCustomPlaybackUsed()}},{key:"isUsingCustomClickTracker",value:function(){return!(!this.adsManager||!this.adsManager.isCustomClickTrackingUsed())}},{key:"setContentComplete",value:function(){this.adsLoader&&this.adsLoader.contentComplete()}},{key:"checkForCustomClickTracking",value:function(){this.isUsingCustomClickTracker()&&this.delegate.displayAdClickElement(!0)}},{key:"beginPollForProgress",value:function(t){var e=this;if(!0===this.csai.enableStalledAdCheck){var i=this.adProgressData;clearTimeout(i.timeoutHandle),i.duration=t.adDuration,i.adId=t.adId,i.pollTzero=Date.now(),i.timeoutHandle=setTimeout((function(){return e.checkAdProgress()}),i.pollInterval)}}},{key:"checkAdProgress",value:function(){var t=this,e=this.adProgressData,i=e.duration-this.adsManager.getRemainingTime(),n=Date.now();if(clearTimeout(e.timeoutHandle),!this.isPaused)if(null==e.pollTzero&&(e.pollTzero=Date.now()),i>e.lastRecordedTime)e.lastRecordedTime=i,e.pollTzero=n,e.timeoutHandle=setTimeout((function(){return t.checkAdProgress()}),e.pollInterval);else if(.001*(n-e.pollTzero)>e.stallThreshold){var r=this.inProgressAd?Object.assign({},this.inProgressAd):null;this.log("Ad stalled; discarding break"),this.delegate.adStalled(r),this.killAd(),this.discardAdBreak(),this.processBreakComplete()}}},{key:"processAdLoadOrStart",value:function(t,e,i){var n,r=this.adService.assembleAdBreakInfo(t,this.aviaSdk.AdTechnology.CSAI),s=this.adService.assembleAdInfo(t,e),u=i===this.sdk.AdEvent.Type.STARTED,a=r.adBreakPosition,o=0===a?"pre_0":-1===a?"post_0":"mid_"+a,l=this.adBreakSchedule.getBreakById(o);if((null==(n=this.markedAsPlayed)?void 0:n.indexOf(o))>=0)return this.adBreakSchedule.markPlayed(l),void this.adsManager.discardAdBreak();u?(this.inProgressAd=s,this.adService.trackAd(s),this.adService.trackAdEvent({context:"ima",eventName:i,volume:this.adsManager.getVolume()}),r.adTechnology=this.aviaSdk.AdTechnology.CSAI,this.breakMetadataReleased||(this.breakMetadataReleased=!0,this.delegate.adBreakMetadata(r)),this.delegate.adStart(s)):this.adBreakSchedule.hasPlayed(o)||(this.adBreakSchedule.markPlayed(l),this.inProgressBreakId=o,this.delegate.adLoaded())}},{key:"processProgress",value:function(){if(this.inProgressAd){var t=this.inProgressAd.adDuration,e=this.adsManager&&this.adsManager.getRemainingTime();isNaN(t)||isNaN(e)||e<0||this.delegate.adProgress(Math.min(t,Math.max(0,t-e)),t)}}},{key:"processQuartile",value:function(t,e){var i;this.adService.trackAdEvent({context:"ima",eventName:t,volume:this.adsManager.getVolume()}),null==(i=this.delegate)||i[e]()}},{key:"processAdComplete",value:function(t){this.adService.trackAdEvent({context:"ima",eventName:t,volume:this.adsManager.getVolume()}),this.killAd()}},{key:"processSkip",value:function(t){this.adService.trackAdEvent({context:"ima",eventName:t,volume:this.adsManager.getVolume()}),this.killAd(),this.delegate.adSkipped()}},{key:"processBreakComplete",value:function(){this.inProgressAd&&this.killAd(),this.inProgressBreakId&&(this.markAsPlayed([this.inProgressBreakId]),this.delegate.adBreakComplete(),this.inProgressBreakId=null),this.breakStartReleased=!1,this.breakMetadataReleased=!1,this.delegate.resumeContent()}},{key:"processVolumeChange",value:function(t){this.adService.trackAdEvent({context:"ima",eventName:t,volume:this.adsManager.getVolume()})}},{key:"processAllComplete",value:function(){this.inProgressBreakId&&this.processBreakComplete(),this.delegate.allAdsComplete()}},{key:"processLogEvent",value:function(t){if(null==t?void 0:t.adError){this.log("LOG event; Ad data has error: msg = "+t.adError.getMessage()||false);var e=null;if(this.pendingSeekedBreakId||this.inProgressBreakId)e=this.pendingSeekedBreakId||this.inProgressBreakId;else{var i=this.player.contentTime,n=this.findClosestForwardBreak(i);n&&(this.adBreakSchedule.markPlayed(n),e=n.breakId)}e&&this.markAsPlayed([e]),this.delegate.adError({code:this.aviaSdk.ErrorCode.IMA_AD_ERROR,message:t.adError.getMessage(),cause:t.adError,fatal:!1}),this.discardAdBreak(),this.processBreakComplete()}}},{key:"findClosestForwardBreak",value:function(t){for(var e=this.adBreakSchedule.adBreaks,i=0,n=e.length;i<n;i++)if(e[i].startTime>t&&e[i].startTime-t<=3)return e[i];return null}},{key:"discardAdBreak",value:function(){var t;this.log("Discarding Ad break"),this.delegate.adBreakDiscarded(),null==(t=this.adsManager)||t.discardAdBreak()}},{key:"killAd",value:function(){this.adService.untrackAd(),this.delegate.adComplete(),this.delegate.displayAdClickElement(!1),this.inProgressAd=null;var t=this.adProgressData;clearTimeout(t.timeoutHandle),t.pollTzero=null,t.lastRecordedTime=null}},{key:"requestAds",value:function(t){var e=new this.sdk.AdsRequest,i=this.getRect(),n=this.options.autoplayState,r=!(this.context.system.isDesktop||this.context.system.isMobile),s=this.context.avia.Util.template,u=function(t,e){var i=e.muted,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return i&&(t=t.replace("".concat(z,"=").concat(W),"".concat(z,"=").concat(Y))),s(t,{get RANDOM(){return tt()},get HOST(){return et()},get REFERER(){return n?"":it()},get PLAYERINFO(){return"".concat(r.playername_version)},get SDK(){return"".concat(r.ima_sdkv)}},"\\[","\\]")}(t,n,r,{ima_sdkv:this.adsLoader.getSdkVersion(),playername_version:"".concat(this.context.buildInfo.playerName,"_").concat(this.context.buildInfo.playerVersion)},s);e.adTagUrl=u,e.linearAdSlotWidth=i.width,e.linearAdSlotHeight=i.height,e.nonLinearAdSlotWidth=i.width,e.nonLinearAdSlotHeight=i.height,e.setAdWillAutoPlay(n.autoplay),e.setAdWillPlayMuted(n.muted),this.adsLoader.requestAds(e)}},{key:"hAdsMgrLoaded",value:function(t){this.renderingSettings=this.getRenderingSettings(),this.adsManager=t.getAdsManager(this.options.playheadInterface,this.renderingSettings),this.createAdBreakSchedule(this.adsManager.getCuePoints()),this.listenToAdsManager(!0),this.startAds()}},{key:"getRenderingSettings",value:function(){var t=new this.sdk.AdsRenderingSettings,e=this.csai,i=this.adService.defaultRenderingSettings,n=e.loadVideoTimeoutMs,r=e.enableAdPreloading;return t.bitrate=i.bitrate,t.enablePreloading=this.aviaSdk.Util.isBoolean(r)?r:i.enablePreloading,t.loadVideoTimeout=isNaN(n)?i.loadVideoTimeout:n,t.restoreCustomPlaybackStateOnAdBreakComplete=i.restoreCustomPlaybackStateOnAdBreakComplete,t}},{key:"createAdBreakSchedule",value:function(t){this.aviaSdk.Util.isEmpty(t)&&(t=[0]),this.adBreakSchedule=new Q(this.context,null,(function(t){return t}),t),this.checkNonZeroStart(),this.delegate.adBreaksAvailable(this.adBreakSchedule.adBreaks)}},{key:"checkNonZeroStart",value:function(){var t=this,e=this.context.resource,i=e.playback.startTime;if(!isNaN(i)&&i>0){for(var n=this.adBreakSchedule.adBreaks,r=n.length;r--;){var s=n[r];if(s.startTime<i&&s.type===this.aviaSdk.AdBreakType.MID){s.hasPlayed=!0,this.markedAsPlayed.push(s.breakId);break}}var u=e.ad.showPrerollOnNonZeroStart;n.forEach((function(e){e.type!==t.aviaSdk.AdBreakType.PRE||u||(t.markedAsPlayed.push(e.breakId),t.adBreakSchedule.markPlayed(e))}))}}},{key:"hAdsLoaderError",value:function(t){this.log("AdsLoader ERROR",t),this.delegate.adError({code:this.aviaSdk.ErrorCode.IMA_AD_ERROR,message:t.message,cause:t,fatal:!1}),this.delegate.resumeContent()}},{key:"listenToAdsManager",value:function(t){if(this.adsManager){for(var e,i=t?"addEventListener":"removeEventListener",n=this.getEventInterests(),r=0,s=n.length;r<s;r++)e=this.sdk.AdEvent.Type[n[r]],this.adsManager[i](e,this.hAdEvent);this.adsManager[i](this.sdk.AdErrorEvent.Type.AD_ERROR,this.hAdsManagerAdError)}}},{key:"listenToAdsLoader",value:function(t){var e=this;this.adsLoader.onAdsLoaderError=t?function(t){return e.hAdsLoaderError(t)}:null,this.adsLoader.onAdsManagerLoaded=t?function(t){return e.hAdsMgrLoaded(t)}:null}},{key:"getEventInterests",value:function(){return["CONTENT_PAUSE_REQUESTED","CONTENT_RESUME_REQUESTED","LOADED","STARTED","AD_PROGRESS","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","COMPLETE","ALL_ADS_COMPLETED","AD_BUFFERING","CLICK","PAUSED","RESUMED","SKIPPED","LOG","USER_CLOSE"]}},{key:"getRect",value:function(){return this.presentationContainer.getBoundingClientRect()}},{key:"initialize",value:function(t){this.listenToAdsLoader(!0),this.requestAds(t)}}]),i}(K),st=function(){function t(){(0,g.default)(this,t),this.MOAT_PARTNER_CODE="cbsiimajsint708425247896",this.adContextToVpaidEventMap={ima:{start:"AdVideoStart",firstquartile:"AdVideoFirstQuartile",midpoint:"AdVideoMidpoint",thirdquartile:"AdVideoThirdQuartile",complete:"AdVideoComplete",pause:"AdPaused",resume:"AdPlaying",skip:"AdSkipped",volumechange:"AdVolumeChange",mute:"AdVolumeChange"},dai_sdk:{started:"AdVideoStart",firstquartile:"AdVideoFirstQuartile",midpoint:"AdVideoMidpoint",thirdquartile:"AdVideoThirdQuartile",complete:"AdVideoComplete",controlpause:"AdPaused",controlplay:"AdPlaying",controlvolumeset:"AdVolumeChange",controlmute:"AdVolumeChange",controlunmute:"AdVolumeChange"}}}return(0,A.default)(t,[{key:"destroy",value:function(){this.adContextToVpaidEventMap=null,this.trackingObj=null}},{key:"track",value:function(t){var e=t.context,i=t.adInfo,n={level1:"",level2:"",level3:i.wrapperAdId,level4:i.wrapperCreativeId,slicer1:"vaw-can",slicer2:t.partner,slicer3:t.pageType,moatVASTSystem:e,moatVASTAdID:i.wrapperAdId};""!==t.viewGuid&&(n.zMoatVGUID=t.viewGuid),""!==t.pageType&&(n.zMoatPT=t.pageType),this.initMoat(t.adVideoContainer,n,i.adDuration,this.MOAT_PARTNER_CODE,null)}},{key:"untrack",value:function(){this.trackingObj=null}},{key:"trackEvent",value:function(t){var e=this.adContextToVpaidEventMap[t.context][t.eventName.toLowerCase()];e&&this.trackingObj&&this.trackingObj.dispatchEvent({type:e,adVolume:t.volume})}},{key:"initMoat",value:function(t,e,i,n){var r,s,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=document.createElement("script"),o=[],l={adData:{ids:e,duration:i,url:u},dispatchEvent:function(t){this.sendEvent?(o&&(o.push(t),t=o,o=!1),this.sendEvent(t)):o.push(t)}},h="_moatApi"+Math.floor(1e8*Math.random());try{s=(r=t.ownerDocument).defaultView||r.parentWindow}catch(t){s=window}s[h]=l,a.type="text/javascript",t&&t.insertBefore(a,t.childNodes[0]||null),a.src="https://z.moatads.com/"+n+"/moatvideo.js#"+h,this.trackingObj=l}}]),t}(),ut=function(){function t(e){(0,g.default)(this,t),this.context=e,this.trackingData=e.resource.ad.viewabilityTracking}return(0,A.default)(t,[{key:"adContainer",get:function(){return this.context.dom.adContainer}},{key:"avia",get:function(){return this.context.avia}},{key:"adSystem",get:function(){return this.adSys},set:function(t){this.adSys=t}},{key:"omEnabled",get:function(){var t;return!(null==(t=this.context.resource.ad.ssai)?void 0:t.useApi)&&this.context.playerOptions.enableOm}},{key:"moatEnabled",get:function(){return!0===this.context.playerOptions.enableMoat}},{key:"destroy",value:function(){var t;null==(t=this.moatTracker)||t.destroy(),this.moatTracker=null,this.trackingData=null,this.context=null}},{key:"trackAd",value:function(t){if(this.moatEnabled){var e=this.trackingData;this.moatTracker.track({viewGuid:e.viewGuid,pageType:e.pageType,adInfo:t,adVideoContainer:this.adContainer,context:this.adSystem,partner:e.partner})}}},{key:"trackAdEvent",value:function(t){this.moatEnabled&&this.moatTracker.trackEvent(t)}},{key:"untrackAd",value:function(){this.moatEnabled&&this.moatTracker.untrack()}},{key:"getGamPlatformString",value:function(){return this.context.system.isDesktop?"desktop":this.context.system.isMobile?"mobile_web":"other"}},{key:"getAdSystem",value:function(){return this.adSystem}},{key:"getAdBreakTypeFromPodIndex",value:function(t){return 0===t?this.avia.AdBreakType.PRE:-1===t?this.avia.AdBreakType.POST:this.avia.AdBreakType.MID}},{key:"assembleAdBreakInfo",value:function(t,e){var i=t.getAdPodInfo(),n=i.getPodIndex();return{adTechnology:e,adBreakDuration:i.getMaxDuration(),adBreakPosition:n,adTotal:i.getTotalAds(),adBreakType:this.getAdBreakTypeFromPodIndex(n),adServerName:this.adSystem}}},{key:"assembleAdInfo",value:function(t,e){var i=t.getAdPodInfo(),n=i&&i.getAdPosition()||-1,r=this.getIdInfo(t),s="ima"===this.adSystem,u=t;return{adObject:t,adServerName:this.adSystem,adDuration:t.getDuration(),adTitle:t.getTitle(),adId:r.adId,adPosition:n,adAssetUrl:s?u.getMediaUrl():e.mediaUrl||null,isVpaid:s?this.getIsVpaid(u):null,wrapperAdId:r.wrapperAdId,creativeId:r.creativeId,wrapperCreativeId:r.wrapperCreativeId,vastMediaHeight:s?u.getVastMediaHeight():null,vastMediaWidth:s?u.getVastMediaWidth():null,vastMediaBitrate:s?u.getVastMediaBitrate():null}}},{key:"createViewabilityTracker",value:function(){this.moatEnabled&&(this.moatTracker=new st)}},{key:"getIdInfo",value:function(t){var e=this.getWrapperId(t),i=this.getCreativeId(t);return{adId:e.adId,wrapperAdId:e.wrapperAdId,creativeId:i.creativeId,wrapperCreativeId:i.wrapperCreativeId,adServerName:"ima",adDuration:t.getDuration()}}},{key:"getWrapperId",value:function(t){var e=t.getWrapperAdIds(),i=Array.isArray(e)&&e.length,n=t.getAdId()||"",r=i?e[0]:n,s=i?e[e.length-1]:n;return s||(s=null),{adId:r,wrapperAdId:s}}},{key:"getCreativeId",value:function(t){var e=t.getWrapperCreativeIds(),i=Array.isArray(e)&&e.length,n=t.getCreativeId()||null,r=i?e[0]:n,s=i?e[e.length-1]:n;return s||(s=null),{creativeId:r,wrapperCreativeId:s}}},{key:"getIsVpaid",value:function(t){return"application/javascript"===t.getContentType()}}]),t}(),at=function(t){(0,k.default)(i,t);var e=E(i);function i(t,n,r){var s;return(0,g.default)(this,i),(s=e.call(this,t)).pSdk=null,s.usesApi=!1,s.videoIface=null,s.hVideoAddOrRemove=function(t){var e;null==(e=s.streamMgr)||e.reset(),s.streamMgr=null,t.type===s.avia.PlayerEvent.VIDEO_ELEMENT_ADDED?s.usesApi?s.videoIface=s.avia.Util.createSimpleVideoInterface():s.videoIface=t.detail.video:s.videoIface=null},s.pSdk=n,s.videoIface=r,s.usesApi=!0===t.resource.ad.ssai.useApi,s.adSystem=s.usesApi?"dai_api":"dai_sdk",s.listenToVideoChanges(!0),s.initViewabilityTracking(),s}return(0,A.default)(i,[{key:"destroy",value:function(){this.listenToVideoChanges(!1),this.streamMgr&&this.streamMgr.reset(),this.streamMgr=null,this.pSdk=null,this.videoIface=null,(0,y.default)((0,p.default)(i.prototype),"destroy",this).call(this)}},{key:"initViewabilityTracking",value:function(){this.createViewabilityTracker()}},{key:"videoInterface",get:function(){return this.videoIface}},{key:"usesDaiApi",get:function(){return this.usesApi}},{key:"sdk",get:function(){return this.pSdk}},{key:"setDuration",value:function(t){this.usesApi&&(this.videoIface.duration=t)}},{key:"setCurrentTime",value:function(t){this.usesApi&&(this.videoIface.currentTime=t)}},{key:"reset",value:function(){this.streamMgr.reset(),this.usesApi&&(this.videoIface.duration=NaN,this.videoIface.currentTime=NaN)}},{key:"assembleAdInfo",value:function(t,e){if("dai_sdk"===this.adSystem)return(0,y.default)((0,p.default)(i.prototype),"assembleAdInfo",this).call(this,t,e);var n=t.getAdPodInfo(),r=n&&n.getAdPosition()||-1,s=t.getDaiWrapperData(),u=s.adId,a=s.creativeId;return{adObject:t,adServerName:this.adSystem,adDuration:t.getDuration(),adTitle:t.getTitle(),adId:u,adPosition:r,adAssetUrl:e.mediaUrl||null,isVpaid:!1,wrapperAdId:u,creativeId:a,wrapperCreativeId:a,vastMediaHeight:null,vastMediaWidth:null,vastMediaBitrate:null}}},{key:"getStreamManager",value:function(){return!this.streamMgr&&this.sdk&&this.videoIface&&(this.usesApi?this.streamMgr=new this.sdk.StreamManager(this.videoIface,this.adContainer,this.context.logger,this.avia):this.streamMgr=new this.sdk.StreamManager(this.videoIface,this.adContainer)),this.streamMgr}},{key:"listenToVideoChanges",value:function(t){var e=this.context.player,i=t?"on":"off";null==e||e[i](this.avia.PlayerEvent.VIDEO_ELEMENT_ADDED,this.hVideoAddOrRemove),null==e||e[i](this.avia.PlayerEvent.VIDEO_ELEMENT_REMOVED,this.hVideoAddOrRemove)}}]),i}(ut),ot=function(){function t(e){var i=this;(0,g.default)(this,t),this.eMap={errorHandler:null,adsMgrLoadedHandler:null},this.omEnabled=!0,this.initialized=!1,this.callbacks={error:null,mgrLoaded:null},this.opts=e,this.adService=this.opts.adService,this.sdk=this.adService.sdk,this.omEnabled=e.enableOm,this.eMap.errorHandler=function(t){return i.hError(t)},this.eMap.adsMgrLoadedHandler=function(t){return i.hAdsMgrLoaded(t)}}return(0,A.default)(t,[{key:"destroy",value:function(){this.adsLoader&&(this.adsLoader.removeEventListener(this.sdk.AdErrorEvent.Type.AD_ERROR,this.eMap.errorHandler),this.adsLoader.removeEventListener(this.sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.eMap.adsMgrLoadedHandler),this.adsLoader.destroy()),this.adsLoader=null,this.adService=null,this.sdk=null}},{key:"initialize",value:function(){var t=this.opts,e=this.sdk;if(!e||!e.AdsLoader)return!1;if(this.initialized)return!0;var i=new e.AdDisplayContainer(t.adContainer,t.video,t.adClickEl);i.initialize(),this.adsLoader=new e.AdsLoader(i);var n=this.adsLoader.getSettings();return this.populateSdkSettings(n),this.adsLoader.addEventListener(e.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.eMap.adsMgrLoadedHandler),this.adsLoader.addEventListener(e.AdErrorEvent.Type.AD_ERROR,this.eMap.errorHandler),this.initialized=!0,!0}},{key:"getSdkVersion",value:function(){var t;return null==(t=this.adsLoader)?void 0:t.getVersion()}},{key:"onAdsManagerLoaded",set:function(t){this.callbacks.mgrLoaded=t}},{key:"onAdsLoaderError",set:function(t){this.callbacks.error=t}},{key:"requestAds",value:function(t){this.omEnabled&&J(t,this.sdk),this.adsLoader&&this.adsLoader.requestAds(t)}},{key:"contentComplete",value:function(){this.adsLoader&&this.adsLoader.contentComplete()}},{key:"getSettings",value:function(){return this.adsLoader?this.adsLoader.getSettings():null}},{key:"hAdsMgrLoaded",value:function(t){this.callbacks.mgrLoaded(t)}},{key:"hError",value:function(t){var e=this.parseAdErrorEvent(t);this.callbacks.error(e)}},{key:"parseAdErrorEvent",value:function(t){return this.adService.parseAdError(t)}},{key:"populateSdkSettings",value:function(t){var e=this.opts.sdkSettings;t.setVpaidMode(e.vpaidMode),t.setDisableCustomPlaybackForIOS10Plus(e.disableCustomPlaybackForIOS10Plus),t.setPlayerType(e.playerType),t.setPlayerVersion(e.playerVersion)}}]),t}();ot.event={ADS_MANAGER_LOADED:"adsManagerLoaded",ADS_LOADER_ERROR:"adsLoaderError"};var lt=function(t){(0,k.default)(i,t);var e=E(i);function i(t,n,r){var s;return(0,g.default)(this,i),(s=e.call(this,t)).adsLoaderInitialized=!1,s.useOm=!1,s.hVideoAddOrRemove=function(t){t.type===s.avia.PlayerEvent.VIDEO_ELEMENT_ADDED&&(s.adsLoaderInitialized&&s.killAdsLoader(),s.createAdsLoader(s.useOm&&s.omEnabled,t.detail))},s.vpaidMode=n||s.sdk.ImaSdkSettings.VpaidMode.INSECURE,s.adSystem="ima",s.useOm=r,s.listenToVideoChanges(!0),s.createAdsLoader(s.useOm&&s.omEnabled),s}return(0,A.default)(i,[{key:"destroy",value:function(){this.killAdsLoader(),(0,y.default)((0,p.default)(i.prototype),"destroy",this).call(this)}},{key:"sdk",get:function(){var t;return null==(t=this.context.system.global.google)?void 0:t.ima}},{key:"getSdkVersion",value:function(){var t;return null==(t=this.pAdsLoader)?void 0:t.getSdkVersion()}},{key:"sdkSettings",get:function(){var t=this.context.buildInfo;return{vpaidMode:this.vpaidMode,disableCustomPlaybackForIOS10Plus:!1,playerType:t.playerName,playerVersion:t.playerVersion}}},{key:"defaultRenderingSettings",get:function(){return{bitrate:900,enablePreloading:!1,loadVideoTimeout:-1,playAdsAfterTime:void 0,restoreCustomPlaybackStateOnAdBreakComplete:!1}}},{key:"adsLoader",get:function(){return this.pAdsLoader}},{key:"createAdsLoader",value:function(t,e){if(!this.pAdsLoader){var i=this.context.dom,n=i.adClickEl,r=i.video,s=i.adContainer,u=e||r;this.pAdsLoader=new ot({enableOm:t,adContainer:s,adClickEl:n,video:u,sdkSettings:this.sdkSettings,adService:this})}}},{key:"initializeAdsLoader",value:function(){return!!this.adsLoaderInitialized||(this.adsLoaderInitialized=!0,this.createViewabilityTracker(),this.pAdsLoader.initialize())}},{key:"parseAdError",value:function(t){var e=t.getError(),i=t.getUserRequestContext(),n=e.getInnerError();return{type:this.getAdErrorType(e),errorCode:e.getErrorCode(),vastErrorCode:e.getVastErrorCode(),message:e.getMessage(),innerErrorMessage:this.context.avia.Util.isString(n)?n:null,sdkVersion:this.sdk.VERSION,requestContext:i||null}}},{key:"killAdsLoader",value:function(){var t,e;null==(t=this.pAdsLoader)||t.contentComplete(),null==(e=this.pAdsLoader)||e.destroy(),this.adsLoaderInitialized=!1,this.pAdsLoader=null}},{key:"getAdErrorType",value:function(t){return t.getType()===this.sdk.AdError.Type.AD_LOAD?"adLoad":"adPlay"}},{key:"listenToVideoChanges",value:function(t){var e=this.context.player,i=t?"on":"off";null==e||e[i](this.avia.PlayerEvent.VIDEO_ELEMENT_ADDED,this.hVideoAddOrRemove),null==e||e[i](this.avia.PlayerEvent.VIDEO_ELEMENT_REMOVED,this.hVideoAddOrRemove)}}]),i}(ut);function ht(t){return!!((null==t?void 0:t.assetKey)||(null==t?void 0:t.videoId)&&t.contentSourceId)}function ct(t){return!!(null==t?void 0:t.adCallUrl)}var ft="gam";function dt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:ft,factory:vt,options:t}}function vt(t,e){return M(this,null,v.default.mark((function i(){var n,r,s,u;return v.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=t.player,r=t.avia,n.registerAdapter({id:ft,role:[r.AdapterRole.AD],options:e,factory:function(t,e){return M(this,null,v.default.mark((function i(){var n,r,a,o,l,h,c,f,d,y,k,m,p,g,A,T,E,S,b,I,w,D,R,_,P,C,O,N,M,L,x,j,B,F,V;return v.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(I=t.avia,w=t.system,D=t.resource,R=t.dom,_=t.playerOptions,P=t.logger,C=D.ad,O=ct(C.csai),N=ht(C.ssai),M=!0===_.enableOm,L=!0===_.enableMoat,x=!0===e.debug?"_debug":"",j=!0===(null==(n=C.ssai)?void 0:n.useApi),!N){i.next=16;break}if((null==(o=null==(a=null==(r=w.global.google)?void 0:r.ima)?void 0:a.dai)?void 0:o.api)||j){i.next=13;break}return F=(null==(l=e.dependencies)?void 0:l.dai)||"//imasdk.googleapis.com/js/sdkloader/ima3_dai".concat(x,".js"),i.next=13,I.Util.loadScript({url:F});case 13:!j&&M&&(null==(y=null==(d=null==(f=null==(c=null==(h=w.global.google)?void 0:h.ima)?void 0:c.dai)?void 0:f.api)?void 0:d.DaiSdkSettings)||y.setFeatureFlags({enableOmidBeta:!0})),u||(u=new at(t,j?G:null==(p=null==(m=null==(k=w.global.google)?void 0:k.ima)?void 0:m.dai)?void 0:p.api,j?I.Util.createSimpleVideoInterface():R.video)),B=new nt({enableOm:M&&!j,playheadInterface:R.video,presentationContainer:R.main,autoplayState:{muted:t.muted,autoplay:t.autoplay},adService:u},t);case 16:if(!O){i.next=24;break}if(null==(A=null==(g=w.global.google)?void 0:g.ima)?void 0:A.AdsRequest){i.next=21;break}return V=(null==(T=e.dependencies)?void 0:T.ima)||"//imasdk.googleapis.com/js/sdkloader/ima3".concat(x,".js"),i.next=21,I.Util.loadScript({url:V});case 21:M&&(null==(b=null==(S=null==(E=w.global.google)?void 0:E.ima)?void 0:S.settings)||b.setFeatureFlags({enableOmidBeta:!0})),s||(s=new lt(t,e.imaVpaidMode,M)),B=new rt({playheadInterface:R.video,presentationContainer:R.main,autoplayState:{muted:t.muted,autoplay:t.autoplay},adService:s},t);case 24:return M&&P.log(I.LogLevel.INFO,"GAM Plugin: OM is enabled"),!j&&L&&P.log(I.LogLevel.INFO,"GAM Plugin: Moat SDK is enabled"),i.abrupt("return",B);case 27:case"end":return i.stop()}}),i)})))},isSupported:function(t){var e=t.resource,i=ct(e.ad.csai),n=ht(e.ad.ssai);return i||n}}),i.abrupt("return",{getId:function(){return ft},destroy:function(){null==s||s.destroy(),s=null}});case 3:case"end":return i.stop()}}),i)})))}var yt=ft,kt=vt,mt=dt;return N(L)}))},"7t31":function(module,exports,__webpack_require__){},"7xm4":function(module,exports,__webpack_require__){},"8hYQ":function(module,__webpack_exports__,__webpack_require__){"use strict";var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("3a3M");var jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);const modal=function(){const isPublic={};const isPrivate={};isPublic.render=function(config){config=config?config:{};var element;if(config.iframe){element=isPrivate.renderIframe(config.iframe)}else if(config.element){element=isPrivate.renderElement(config.element)}else if(config.string){element=isPrivate.renderString(config.string)}var target=config.target?jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.target):jquery__WEBPACK_IMPORTED_MODULE_0___default()("#oas_OOP1");var modal=isPrivate.renderContainer(config.size);modal.find(".lightbox-content").eq(0).append(element);target.append(modal);target=isPublic.eventListeners(target);return target},isPublic.eventListeners=function(target){target.find(".close-action").on("click",(function(){target.find(".lightbox").removeClass("active")}));return target},isPrivate.renderContainer=function(size){var closeAnchor=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<a></a>");var closeIcon=jquery__WEBPACK_IMPORTED_MODULE_0___default()("×");var modalContainer=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div></div>");var modalContent=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<section></section>");var sizeActual=size?size:"auto";closeAnchor.addClass("close-icon");closeAnchor.addClass("close-action");closeAnchor.attr("href","javascript:;");closeAnchor.append(closeIcon);modalContainer.addClass("lightbox active");modalContent.addClass("lightbox-content "+sizeActual);modalContainer.append(modalContent);modalContainer.append(closeAnchor);return modalContainer},isPrivate.renderIframe=function(config){var iframe=jquery__WEBPACK_IMPORTED_MODULE_0___default()("iframe");iframe.attr("src",config.source);if(config.container){var container=jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.container);iframe.wrap(container)}return iframe},isPrivate.renderElement=function(config){var element=config.type?jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.type):jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div></div>");element.append(jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.contents));if(config.container){var container=jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.container);element.wrap(container)}return element},isPrivate.renderString=function(config){var element=jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.content);if(config.container){var container=jquery__WEBPACK_IMPORTED_MODULE_0___default()(config.container);element.wrap(container)}return element};return isPublic}();__webpack_exports__["a"]=modal},FT8B:function(module,exports){[Array.prototype].forEach((function(item){if(!item.hasOwnProperty("remove")){Object.defineProperty(item,"remove",{configurable:true,enumerable:true,writable:true,value:function remove(arrItem){this.splice(this.indexOf(arrItem),1)}})}if(!item.hasOwnProperty("removeAtIndex")){Object.defineProperty(item,"removeAtIndex",{configurable:true,enumerable:true,writable:true,value:function removeAtIndex(index){this.splice(index,1)}})}}))},Fg3Y:function(module,exports,__webpack_require__){},"Fs+f":function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];if(!module.children)module.children=[];Object.defineProperty(module,"loaded",{enumerable:true,get:function(){return module.l}});Object.defineProperty(module,"id",{enumerable:true,get:function(){return module.i}});module.webpackPolyfill=1}return module}},FyT7:function(module,exports,__webpack_require__){},HVBj:function(module,__webpack_exports__,__webpack_require__){"use strict";var jquery=__webpack_require__("3a3M");var jquery_default=__webpack_require__.n(jquery);var react=__webpack_require__("r0ML");var react_default=__webpack_require__.n(react);var react_dom=__webpack_require__("+Q0i");var react_dom_default=__webpack_require__.n(react_dom);var lodash=__webpack_require__("svWY");var jquery_fancybox=__webpack_require__("o/II");var dist_jquery_fancybox=__webpack_require__("nTpV");var style=__webpack_require__("QASX");var PrimaryNavItemList_style=__webpack_require__("o8bV");jquery_default()(".PrimaryNavItemList").on("click",event=>{event.stopPropagation()});var PrimaryNavItem_style=__webpack_require__("uMZg");var SiteSearch_style=__webpack_require__("Fg3Y");jquery_default()(".SiteSearch-close").on("click",_ref=>{let{currentTarget:currentTarget}=_ref;jquery_default()(currentTarget).closest(".PrimaryNav-searchPopout").removeClass("is-open")});var js_cookie=__webpack_require__("06tH");var js_cookie_default=__webpack_require__.n(js_cookie);const $login=jquery_default()(".PrimaryNav-logIn");const $loginMenuToggle=jquery_default()(".PrimaryNav-loginMenuButton");const $loginMenu=jquery_default()(".PrimaryNav-logInMenu");const $mobileMenuContainer=jquery_default()(".PrimaryNav-menuContainer");const $mobileMenuToggle=jquery_default()(".PrimaryNav-menuIcon");const $mobileMenu=jquery_default()(".PrimaryNav-menu");const $desktopMenu=jquery_default()(".PrimaryNavItem.is-desktop");const $userMenuContainer=jquery_default()(".PrimaryNav-user");const $userMenuToggle=jquery_default()(".PrimaryNav-userMenuButton");const $userMenu=jquery_default()(".PrimaryNav-userMenu");const $searchPopout=jquery_default()(".PrimaryNav-searchPopout");const darkModeCookie=js_cookie_default.a.get("darkMode");let darkModeEnabled=typeof darkModeCookie!=="undefined"?darkModeCookie:"off";const toggleDarkMode=event=>{event.preventDefault();setDarkMode(darkModeEnabled==="on"?"off":"on")};const setDarkMode=enable=>{if(jquery_default()("html").data("isembed")===true){return}darkModeEnabled=enable;const theme=darkModeEnabled==="on"?"dark":"light";jquery_default()("html").attr("data-theme",theme);jquery_default()('meta[name="twitter:widgets:theme"]').remove();jquery_default()("head").append('<meta name="twitter:widgets:theme" content="'+theme+'">');js_cookie_default.a.set("darkMode",darkModeEnabled,{expires:90})};jquery_default()(".PrimaryNav-toggleTheme, .js-toggleDarkMode").on("click",toggleDarkMode);jquery_default()(".js-toggleDarkModeOn").on("click",()=>setDarkMode("on"));jquery_default()(".js-toggleDarkModeOff").on("click",()=>setDarkMode("off"));const closeAllNavMenus=()=>{$loginMenu.removeClass("is-open");$mobileMenu.removeClass("is-open");$userMenu.removeClass("is-open");jquery_default()(".PrimaryNavItem").removeClass("is-open");$searchPopout.removeClass("is-open")};const closeMenuOnEsc=(event,menu)=>{if(event.key==="Escape"){menu.removeClass("is-open")}};jquery_default()("html").on("click",closeAllNavMenus);$login.on("keydown",event=>closeMenuOnEsc(event,$loginMenu));$mobileMenuContainer.on("keydown",event=>closeMenuOnEsc(event,$mobileMenu));$userMenuContainer.on("keydown",event=>closeMenuOnEsc(event,$userMenu));$desktopMenu.on("keydown",event=>closeMenuOnEsc(event,$desktopMenu));$loginMenuToggle.on("click",event=>{event.stopPropagation();$searchPopout.removeClass("is-open");$mobileMenu.removeClass("is-open");$userMenu.removeClass("is-open");$loginMenu.toggleClass("is-open")});$loginMenu.on("click",event=>{event.stopPropagation()});$mobileMenuToggle.on("click",event=>{event.stopPropagation();$searchPopout.removeClass("is-open");$loginMenu.removeClass("is-open");$userMenu.removeClass("is-open");$mobileMenu.toggleClass("is-open")});$userMenuToggle.on("click",event=>{event.stopPropagation();$searchPopout.removeClass("is-open");$mobileMenu.removeClass("is-open");$loginMenu.removeClass("is-open");$userMenu.toggleClass("is-open")});jquery_default()(".PrimaryNavItem-toggle").on("click",event=>{event.stopPropagation();const thisNavItem=jquery_default()(event.currentTarget).closest(".PrimaryNavItem");const wasOpen=thisNavItem.hasClass("is-open");jquery_default()(".PrimaryNavItem").removeClass("is-open");if(!wasOpen){thisNavItem.addClass("is-open")}});jquery_default()(".PrimaryNavItem.is-desktop").on("mouseover",event=>{jquery_default()(event.currentTarget).addClass("is-open")});jquery_default()(".PrimaryNavItem.is-desktop").on("mouseout",event=>{jquery_default()(event.currentTarget).removeClass("is-open")});jquery_default()(".PrimaryNav-searchIcon").on("click",event=>{event.stopPropagation();$loginMenu.removeClass("is-open");$mobileMenu.removeClass("is-open");jquery_default()(event.currentTarget).siblings(".PrimaryNav-searchPopout").toggleClass("is-open")});jquery_default()(".PrimaryNav-search").on("click",event=>{event.stopPropagation()});jquery_default()(".js-toggleExpanded").on("click",_ref=>{let{currentTarget:currentTarget}=_ref;const $el=jquery_default()(currentTarget);const currentState=$el.attr("aria-expanded");$el.attr("aria-expanded",currentState==="true"?"false":"true")});var UserSettings=__webpack_require__("RZoG");var svg_defs=__webpack_require__("tccn");const $site={newsletterCapture:data=>{const submitData={email:data.email,"what-are-you-most-interested-in":data.channels,zip:data.zip||null,optInConfirmation:data.verify||true,accountId:data.accountId||"1776482",groups:data.groups||"1904482"};return jquery_default.a.ajax({type:"POST",cache:false,url:data.url||"https://signup-collector.e2ma.net/signup",data:JSON.stringify(submitData),contentType:"application/json",dataType:data.url?"json":"text"})}};jquery_default()(document).on("click",".movie_search",(function(){jquery_default()(this).find("b").toggleClass("icon-search icon-close");jquery_default()(this).next().toggleClass("hidden");return false})).on("click",".comic_search",(function(){jquery_default()(this).find("b").toggleClass("icon-search icon-close");jquery_default()(this).next().toggleClass("hidden");return false})).on("mouseover",".starrank_blk > .stars > a, .info_blk > .stars > a, .rating-container .icon-star, .rating-container > .stars > a",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".starrank_blk > .stars > a, .info_blk > .stars > a, .rating-container .icon-star, .rating-container > .stars > a",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("mouseover",".modulestars_blk > a",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".modulestars_blk > a",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("mouseover",".sidebarstars_blk > a",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".sidebarstars_blk > a",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("click",".openquestion_anc",(function(){jquery_default()(this).siblings(".compdesc_blk").removeClass("hidden");return false})).on("click",".closequestion_anc",(function(){jquery_default()(this).parents(".compdesc_blk").addClass("hidden");return false}));var main=$site;var PopCultureAnalytics=__webpack_require__("63rw");var consent=__webpack_require__("atHw");var svg=__webpack_require__("vwnI");var auth=__webpack_require__("K04/");var classnames=__webpack_require__("Pc05");var classnames_default=__webpack_require__.n(classnames);const SITE_NAME=window.location.host.replace("www.","");const PrimaryNavUserMenu=()=>{const[currentUser,setUser]=Object(react["useState"])(null);const[isOpen,setIsOpen]=Object(react["useState"])(false);Object(react["useEffect"])(()=>{Object(auth["a"])().then(user=>{if(user){setUser(user)}})},[]);const returnPath=window.location.origin+window.location.pathname;if(!currentUser){return react_default.a.createElement("div",null,react_default.a.createElement("li",{className:"PrimaryNav-logIn"},react_default.a.createElement("button",{className:"PrimaryNav-loginMenuButton",onClick:()=>setIsOpen(!isOpen),"aria-label":"Toggle login menu","aria-expanded":isOpen,"data-testid":"PrimaryNav-loginToggle"},react_default.a.createElement(svg["a"],{name:"user3"}),react_default.a.createElement(svg["a"],{name:"arrow-down",className:"PrimaryNav-loginCaret"})),react_default.a.createElement("section",{className:classnames_default()("PrimaryNav-logInMenu",{"is-open":isOpen})},react_default.a.createElement("header",{className:"PrimaryNav-loginWithSocial"},react_default.a.createElement("h2",null,"Sign in using your account with:"),react_default.a.createElement("a",{className:"PrimaryNav-loginFacebook",href:"","aria-label":"Login via Facebook"},react_default.a.createElement(svg["a"],{name:"facebook"})),react_default.a.createElement("h2",null,"or sign in with your ",SITE_NAME)),react_default.a.createElement("form",{className:"PrimaryNav-loginForm",method:"Post",action:"/login/"},react_default.a.createElement("input",{type:"hidden",name:"ReturnTo",value:returnPath}),react_default.a.createElement("fieldset",{className:"PrimaryNav-loginFormFields"},react_default.a.createElement("label",{className:"PrimaryNav-loginFormLabel",htmlFor:"NavEmail"},"Email"),react_default.a.createElement("input",{className:"PrimaryNav-loginFormInput",id:"NavEmail",name:"Email",type:"email","aria-label":"email","data-testid":"PrimaryNav-emailField"}),react_default.a.createElement("label",{className:"PrimaryNav-loginFormLabel",htmlFor:"NavPassword"},"Password"),react_default.a.createElement("input",{className:"PrimaryNav-loginFormInput",id:"NavPassword",name:"Password",type:"password","aria-label":"password","data-testid":"PrimaryNav-passwordField"})),react_default.a.createElement("div",{className:"PrimaryNav-loginFormControls"},react_default.a.createElement("input",{id:"NavRememberMe",name:"RememberMe",type:"checkbox",defaultChecked:true}),react_default.a.createElement("label",{className:"PrimaryNav-rememberMeLabel",htmlFor:"NavRememberMe"},"Remember me on this device"),react_default.a.createElement("button",{type:"submit",className:"PrimaryNav-loginFormSubmit btn","data-testid":"PrimaryNav-loginSubmit"},"Login"))),react_default.a.createElement("div",{className:"PrimaryNav-loginLinks"},react_default.a.createElement("p",null,react_default.a.createElement("a",{href:"/user/new/"},react_default.a.createElement("b",null,"Register"))," ","-"," ",react_default.a.createElement("a",{href:"/forgot-password/"},react_default.a.createElement("b",null,"Forgot Password")))),react_default.a.createElement("div",{className:"PrimaryNav-loginTOS"},react_default.a.createElement("p",null,"By creating an account, you verify that you are at least 13 years of age, and have read and agree to the ",SITE_NAME,react_default.a.createElement("a",{href:"/page/termsofservice/"},react_default.a.createElement("b",null,"Terms of Service"))," ","and"," ",react_default.a.createElement("a",{href:"/page/privacy/"},react_default.a.createElement("b",null,"Privacy Policy")))))))}return react_default.a.createElement("div",null,react_default.a.createElement("li",{className:"PrimaryNav-user"},react_default.a.createElement("button",{className:"PrimaryNav-userMenuButton",onClick:()=>setIsOpen(!isOpen),"aria-expanded":isOpen,"aria-label":"Toggle user menu","data-testid":"PrimaryNav-userMenuButton"},react_default.a.createElement("img",{className:"PrimaryNav-userAvatar",src:currentUser.Avatar,height:24,width:24}),react_default.a.createElement(svg["a"],{name:"arrow-down-solid",className:"PrimaryNav-userMenuArrow"}),currentUser.UnreadNotifications>0&&react_default.a.createElement("div",{className:"PrimaryNav-notificationBadge"},currentUser.UnreadNotifications>9?"9":currentUser.UnreadNotifications)),react_default.a.createElement("ul",{className:classnames_default()("PrimaryNav-userMenu",{"is-open":isOpen})},react_default.a.createElement("li",null,react_default.a.createElement("a",{className:"PrimaryNav-userMenuLink",href:"/my/options/",rel:"nofollow"},"Settings")),react_default.a.createElement("li",null,react_default.a.createElement("a",{className:"PrimaryNav-userMenuLink",href:"/my/inbox/",rel:"nofollow"},"Notifications")),react_default.a.createElement("li",null,react_default.a.createElement("a",{className:"PrimaryNav-userMenuLink",href:"/logout/",rel:"nofollow","data-testid":"PrimaryNav-logout"},"Log Out")),currentUser.RoleGroup>=30?react_default.a.createElement("li",null,react_default.a.createElement("a",{className:"PrimaryNav-userMenuLink",href:"/manage/",rel:"nofollow"},"Manage")):react_default.a.createElement("div",null,currentUser.RoleGroup>=20&&react_default.a.createElement("li",null,react_default.a.createElement("a",{className:"PrimaryNav-userMenuLink",href:"/article/manage/",rel:"nofollow"},"Manage"))))))};PrimaryNavUserMenu.handledProps=[];var components_PrimaryNavUserMenu=PrimaryNavUserMenu;const EditURL=window.$cbc.Model.Key;const EmbedURL=window.location.href+"configureembed/";const EditEntity=()=>{const[currentUser,setUser]=Object(react["useState"])(null);Object(react["useEffect"])(()=>{Object(auth["a"])().then(user=>{if(user){setUser(user)}})},[]);if(!currentUser){return null}if(currentUser.RoleGroup>=30){return react_default.a.createElement("div",{className:"edit_blk"},react_default.a.createElement("a",{href:"/entity/".concat(EditURL,"/edit")},"Edit Page")," | ",react_default.a.createElement("a",{href:EmbedURL},"Embed"))}return null};EditEntity.handledProps=[];var components_EditEntity=EditEntity;const UserMessages=()=>{var messageCookie=js_cookie_default.a.get("SUMLO");const urlNotCachable=window.location.href.includes("/login")||window.location.href.includes("/user/new")||window.location.href.includes("/my/options");if(messageCookie!=null&&messageCookie!==""){js_cookie_default.a.remove("SUMLO");if(urlNotCachable){return null}const MessageType="successMessage";var pattern=/[^a-zA-Z0-9., ]+/gm;messageCookie=messageCookie.replace(pattern,"");return react_default.a.createElement("div",{className:"".concat(MessageType),id:"".concat(MessageType)}," ","".concat(messageCookie)," ")}return null};UserMessages.handledProps=[];var components_UserMessages=UserMessages;var device=__webpack_require__("L7eK");var main_0=__webpack_exports__["a"]=Utility=>{let user=null;var $global={init:async function(content){user=await Object(auth["a"])();if(jquery_default()("body").hasClass("main-site")&&!Object(device["b"])()){$global.mainNavControl()}if(document.querySelectorAll(".sort-table").length>0){$global.SortTable()}if(jquery_default()('[data-js="editorinit"]').length>0){$id="#Body";if(jquery_default()('[data-js="editorinit"][data-id]').length>0){$id=jquery_default()('[data-js="editorinit"]').data("id")}$global.editorInit("False",$id)}const ArticleID=document.getElementById("EditEntity");if(ArticleID){react_dom_default.a.render(react_default.a.createElement(components_EditEntity,null),ArticleID)}react_dom_default.a.render(react_default.a.createElement(components_UserMessages,null),document.getElementById("UserMessages"));react_dom_default.a.render(react_default.a.createElement(components_PrimaryNavUserMenu,null),document.getElementById("PrimaryNavUserMenu"));$global.refreshSocialIcons();content.find(".tokeninput").each((function(){var tokenElement=jquery_default()(this);jquery_default()(this).tokenInput(jquery_default()(this).data("url")?jquery_default()(this).data("url"):"",{hintText:"",tokenValue:"name",noResultsText:"No results",searchingText:"Searching...",queryParam:jquery_default()(this).data("query")?jquery_default()(this).data("query"):"",tokenLimit:jquery_default()(this).data("limit")?jquery_default()(this).data("limit"):25,minChars:2,onDelete:function(item){tokenElement.attr("data-value","")},onAdd:function(item){tokenElement.attr("data-value",JSON.stringify(item))},searchDelay:1e3,resultsLimit:100,allowFreeTagging:true,prePopulate:jquery_default()(this).data("value")?JSON.parse(jquery_default()(this).attr("data-value")):null})}));content.find(".tokeninputrequired").each((function(){var tokenElement=jquery_default()(this);jquery_default()(this).tokenInput(jquery_default()(this).data("url")?jquery_default()(this).data("url"):"",{hintText:"",tokenValue:"id",noResultsText:"No results",searchingText:"Searching...",queryParam:jquery_default()(this).data("query")?jquery_default()(this).data("query"):"",tokenLimit:jquery_default()(this).data("limit")?jquery_default()(this).data("limit"):25,minChars:2,onDelete:function(item){tokenElement.attr("data-value","")},onAdd:function(item){tokenElement.attr("data-value",JSON.stringify(item))},searchDelay:1e3,resultsLimit:100,allowFreeTagging:false,prePopulate:jquery_default()(this).data("value")?JSON.parse(jquery_default()(this).attr("data-value")):null})}));content.find(".tokeninputpollasset").each((function(){var tokenElement=jquery_default()(this);jquery_default()(this).tokenInput(jquery_default()(this).data("url")?jquery_default()(this).data("url"):"",{hintText:"",tokenValue:"id",noResultsText:"No results",searchingText:"Searching...",queryParam:jquery_default()(this).data("query")?jquery_default()(this).data("query"):"",tokenLimit:jquery_default()(this).data("limit")?jquery_default()(this).data("limit"):25,minChars:3,onDelete:function(item){tokenElement.attr("data-value","")},onAdd:function(item){tokenElement.attr("data-value",JSON.stringify(item))},searchDelay:1e3,resultsLimit:1,allowFreeTagging:false,prePopulate:jquery_default()(this).data("value")?JSON.parse(jquery_default()(this).attr("data-value")):null})}));content.find('[data-click="populate-token-input"]').each((function(){jquery_default()(this).on("click",(function(){if(jquery_default()(this).data("value")){var target=jquery_default()(this).data("target")?jquery_default()(jquery_default()(this).data("target")):jquery_default()(".tokeninput:not([data-value]),.tokeninputrequire:not([data-value]),.tokeninputpollasset:not([data-value]),.tokeninput[data-value=''],.tokeninputrequired[data-value=''],.tokeninputpollasset[data-value='']").eq(0);var value=typeof jquery_default()(this).data("value")==="object"?jquery_default()(this).data("value"):JSON.parse(jquery_default()(this).data("value"));if(value instanceof Array&&target.data("limit")==1){value=value[0];if(typeof value!=="object"||!value.id||!value.name){console.error("Invalid data-value. data-value must be object or array with single object. data-value must have id and name properties.");return}}else if(value instanceof Array&&target.data("limit")!=1){var valid=true;value=value.map((function(v){valid=typeof value!=="object"&&v.id&&v.name?valid:false;return v}));if(!valid){console.error("Invalid data-value. data-value must be object or array with single object. data-value must have id and name properties.");return}}else if(typeof value===object){if(!value.id||!value.name){console.error("Invalid data-value. data-value must have id and name properties.");return}}else{console.error("Invalid data-value. data-value must be an array of objects or single object.");return}console.debug("Populating token input",target,"with value",value);target.tokenInput("add",value)}else{console.error("Clickable must have a data-value attribute for token input")}}))}));content.find(".animated").each((function(){var animatedSource=jquery_default()(this).attr("href");var frameSource=jquery_default()(this).find("img").attr("src");jquery_default()(this).mouseover((function(){jquery_default()(this).find("img").attr("src",animatedSource);jquery_default()(this).removeClass("animated")})).mouseout((function(){jquery_default()(this).addClass("animated");jquery_default()(this).find("img").attr("src",frameSource)}))}));content.find("form.navigation_safety").each((function(index){var form=jquery_default()(this);form.find("input, select, textarea").on("change",(function(){form.data("dirty",true)}));if(index==0){content.find('a:not([href^="#"], .ajax-post, .fancybox, .drawer)').on("click",(function(event){var dirty=false;jquery_default()("form.navigation_safety").each((function(){dirty=dirty||jquery_default()(this).data("dirty")}));if(dirty&&confirm("You have modified form data on this page, navigating away will lose your changes. Are you sure you want to continue?")==false){event.stopImmediatePropagation();return false}}))}}));if(jquery_default()(".captcha_lst").length>0){var spans=content.find(".spans");var radios=content.find(".captcha_lst input");var images=content.find(".captcha_icn");spans.css({display:"none"});images.css({display:"block"});images.each((function(i){jquery_default()(images[i]).on("click",(function(){images.removeClass("selected");jquery_default()(images[i]).addClass("selected");jquery_default()(radios[i]).prop("checked",true)}))}))}if(content.find(".tabs").length>0){content.find(".tabs").each((function(){var tabs=jquery_default()(this);tabs.find(".tabnav > li > a:not(.current)").on("click",(function(){tabs.find(".tabnav > li > a").removeClass("current");tabs.find(".visible").removeClass("visible");jquery_default()(this).addClass("current");jquery_default()(jquery_default()(this).attr("href")).addClass("visible");return false}))}));content.find(".tabnav > li > a.start").click()}if(jquery_default()('[data-js="product-gallery"]').length>0){$global.listingGalleryInit()}if(jquery_default()('[data-js="facebookupdate"]').length){$global.updateFacebookSocial(jquery_default()(this).find("span"),jquery_default()(location).attr("href"))}},refreshSocialIcons:function(){if(Object(device["c"])()){jquery_default()(".social-list > .sms_itm.ios").show()}else if(Object(device["a"])()){jquery_default()(".social-list > .sms_itm.android").show("inline-block")}},iterateOverEmbeds:function(u){var embed=jquery_default()(u);var url=embed.data("url");var callback=embed.data("callback");var data=embed.data();var postdata={};var params=[];jquery_default.a.each(data,(function(index,value){if(index!="js"&&index!="url"){if(index.match("^field")){postdata[index.replace("field","")]=value}if(index.match("^param")){params[index.replace("param","")]=value}}}));Utility.info("Performing embed update",{embed:embed,url:url,callback:callback,data:data,postData:postdata,params:params});jquery_default.a.ajax({url:url,data:postdata,type:"get",dataType:"json",success:function(json){if(json.success==false){Utility.error(json.message);return false}if(callback){Utility.success("Performing embed callback",json,params,callback);var args={};args=json;var fn=window[callback];if(typeof fn!=="function"){return}fn.call(window,args)}},error:function(err){Utility.error("Could not update embed",err)}})},mainNavControl:function(){var headerHeight=jquery_default()(".site-nav").height();var navHeight=jquery_default()(".site-nav > nav > ul").height();var windowTop=jquery_default()(window).scrollTop();var lastScrollTop=0;jquery_default()(window).on("scroll",(function(){windowTop=jquery_default()(window).scrollTop();if(windowTop>lastScrollTop){if(windowTop>=headerHeight){jquery_default()(".site-nav").addClass("collapsed");navHeight=jquery_default()(".site-nav > nav > ul").height()}}else if(windowTop<=headerHeight-navHeight){jquery_default()(".site-nav").removeClass("collapsed").css("margin-top","0");navHeight=jquery_default()(".site-nav > nav > ul").height()}lastScrollTop=windowTop}))},secondaryNavControl:function(){var $nav=jquery_default()(".secondary-nav");var navTop=$nav.offset().top;jquery_default()(window).on("scroll",(function(){windowTop=jquery_default()(window).scrollTop();navTop=$nav.offset().top;var headerOffset=$global.GetHeaderOffsetTop();if(navTop<=headerOffset){$nav.css("height","36px");jquery_default()("nav",$nav).addClass("sticky").css({top:headerOffset});jquery_default()("body > .topnav").addClass("hasSticky")}else{jquery_default()("nav",$nav).removeClass("sticky").css({top:""});jquery_default()("body > .topnav").removeClass("hasSticky")}}));jquery_default()("a",$nav).on("click",(function(){var totalOffset=jquery_default()("body > .topnav").height()+jquery_default()(".secondary-nav nav").height();$global.smoothScroll(totalOffset)}));if(!jquery_default()(".category-content").length){$global.determineActiveSection()}},determineActiveSection:function(){jquery_default()(".contentset").each((function(){var headerHeight=jquery_default()(".site-nav").outerHeight();var lastId;var $nav=jquery_default()(".secondary-nav");var menuItems=$nav.find("a");scrollItems=menuItems.map((function(){if(jquery_default()(this).attr("href").match("^#")!=null){var item=jquery_default()(jquery_default()(this).attr("href"));if(item.length){return item}}}));jquery_default()(window).scroll((function(){var windowTop=jquery_default()(window).scrollTop();var viewportTop=windowTop+headerHeight+jquery_default()(".secondary-nav nav").outerHeight()+1;cur=scrollItems.map((function(){if(jquery_default()(this).offset().top<viewportTop){return this}}));cur=cur[cur.length-1];id=cur&&cur.length?cur[0].id:"latest";if(lastId!=id){lastId=id;menuItems.parent().removeClass("active").end().filter('[href="#'+id+'"]').parent("li").addClass("active")}}))}))},smoothScroll:function(totalOffset){jquery_default()('a[href*="#"]:not([href="#"])').click((function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var target=jquery_default()(this.hash);target=target.length?target:jquery_default()("[name="+this.hash.slice(1)+"]");if(target.length){jquery_default()("html, body").animate({scrollTop:target.offset().top-totalOffset},150);return false}}}))},elementShowHide:function(){var moreEl='<a class="more"></a>';var lessText='<b class="icon-arrow-up"></b>';var moreText='<b class="icon-arrow-down"></b>';if(Object(device["b"])()){jquery_default()("[data-mobilelengthlimit]").each((function(){var $el=jquery_default()(this);var emSize=parseInt(jquery_default()(this).css("font-size"));var maxH=$el.data("mobilelengthlimit");if($el.height()>maxH*emSize+emSize&&jquery_default()(".more, .less",$el).length<1){$el.css({"max-height":maxH+"em",overflow:"hidden"}).append(moreEl);$el.find(".more").html(moreText)}}))}else{jquery_default()("[data-lengthlimit]").each((function(){var $el=jquery_default()(this);var emSize=parseInt(jquery_default()(this).css("font-size"));var maxH=$el.data("lengthlimit");if($el.height()>maxH*emSize+emSize&&jquery_default()(".more, .less",$el).length<1){$el.css({"max-height":maxH+"em",overflow:"hidden"}).append(moreEl);$el.find(".more").html(moreText)}}))}},ArticleType:function(){if(jquery_default()(".article-container.active").find(".photo-gallery").length>0){var pageType="photogallery"}else if(jquery_default()(".article-container.active").find(".content-gallery").length>0){var pageType="slideshow"}else if(jquery_default()(".article-container.active").find(".listing-show").length>0){var pageType="rankinglist"}else{var pageType="article"}return pageType},ContentSection:function(){if(jquery_default()(".entity-main-content").length){var primaryContainer=jquery_default()(".entity-main-content")}else if(jquery_default()(".article-container").length){var primaryContainer=jquery_default()(".article-container")}else if(jquery_default()(".content-gallery").length){var primaryContainer=jquery_default()(".content-gallery")}else if(jquery_default()(".article-content article").length){var primaryContainer=jquery_default()(".article-content > article").eq(0)}else{var primaryContainer=jquery_default()(".main_content")}var primaryContentSelectors={".esports-entity":".esports-content"};for(var identifier in primaryContentSelectors){if(primaryContainer.is(identifier)){primaryContainer=jquery_default()(primaryContentSelectors[identifier])}}return primaryContainer},NewPageView:function(url){console.debug("New Page View:",url);$global.updateGoogle(url);$global.updateComScore(url);$global.updateQuantServe(url);$global.refreshTealiumState(url,true);BidBarrel.setTargeting({vguid:window.identity.getHitId()});window.identity.newPageHit({url:url})},GetHeaderOffsetTop:getHeaderElementOffsetTop,FixedFeed:function(){function handleScrollAndResize(){const screenWidth=document.body.clientWidth;if(screenWidth<900){return}const $sidebar=jquery_default()(".sidebar [data-js=sticky]");const scrollPos=jquery_default()(window).scrollTop();const headerOffset=$global.GetHeaderOffsetTop();const viewportTop=scrollPos+headerOffset;const topTrigger=jquery_default()("article:first-of-type",$sidebar).offset().top;if(!$sidebar.hasClass("watch-and-read-sidebar")){if(viewportTop>=topTrigger){$sidebar.addClass("middle")}else{$sidebar.css("top","".concat(headerOffset,"px"))}}}window.addEventListener("scroll",Object(lodash["throttle"])(handleScrollAndResize,100,{leading:true}));window.addEventListener("resize",Object(lodash["throttle"])(handleScrollAndResize,100,{leading:true}))},SidebarSettings:{vpBottom:jquery_default()(window).scrollTop()+jquery_default()(window).height(),vpTop:jquery_default()(window).scrollTop()+getHeaderElementOffsetTop(),contentHeight:0,sidebarHeight:0,upperBoundContainer:jquery_default()(".sidebar-sticky").length>0?jquery_default()(".sidebar-sticky").offset().top:0,lowerBoundContainer:jquery_default()(".sidebar-sticky").length>0?jquery_default()(".sidebar-sticky").offset().top+jquery_default()(".sidebar-sticky").height():0,upperBoundChild:jquery_default()('.sidebar [data-js="sticky"]').length>0?jquery_default()('.sidebar [data-js="sticky"]').offset().top:0,lowerBoundChild:jquery_default()('.sidebar [data-js="sticky"]').length>0?jquery_default()('.sidebar [data-js="sticky"]').offset().top+jquery_default()('.sidebar [data-js="sticky"]').height():0,shouldAffix:false},SidebarRefresh:function(){var content=$global.ContentSection();var direction=$global.SidebarSettings.vpBottom>jquery_default()(window).scrollTop()+jquery_default()(window).height()?"up":"down";var current={vpBottom:jquery_default()(window).scrollTop()+jquery_default()(window).height(),vpTop:jquery_default()(window).scrollTop(),contentHeight:content.height(),sidebarHeight:jquery_default()('.sidebar [data-js="sticky"]').height()};if(jquery_default()(".sidebar.sidebar-sticky").length>0&&(jquery_default()('.sidebar [data-js="sticky"]').height()!=$global.SidebarSettings.sidebarHeight||content.height()!=$global.SidebarSettings.contentHeight)){if(jquery_default()(window).width()>767){content.css({height:"auto"});$global.SidebarSettings.sidebarHeight=jquery_default()('.sidebar [data-js="sticky"]').height();$global.SidebarSettings.contentHeight=content.height();if(current.contentHeight<current.sidebarHeight){content.css({minHeight:current.sidebarHeight});jquery_default()(".sidebar-sticky").css({height:current.sidebarHeight})}else if($global.SidebarSettings.sidebarHeight<=current.contentHeight+100){jquery_default()(".sidebar-sticky").height(current.contentHeight);content.css({minHeight:current.contentHeight});$global.SidebarSettings.shouldAffix=true}$global.SidebarSettings.contentHeight=content.height();$global.SidebarSettings.sidebarHeight=jquery_default()('.sidebar-sticky [data-js="sticky"]').height()}}if($global.SidebarSettings.shouldAffix){$global.SidebarSettings.vpBottom=jquery_default()(window).scrollTop()+jquery_default()(window).height();$global.SidebarSettings.vpTop=jquery_default()(window).scrollTop();$global.SidebarSettings.upperBoundContainer=jquery_default()(".sidebar-sticky").offset().top;$global.SidebarSettings.lowerBoundContainer=jquery_default()(".sidebar-sticky").offset().top+jquery_default()(".sidebar-sticky").height();$global.SidebarSettings.upperBoundChild=jquery_default()('.sidebar-sticky [data-js="sticky"]').offset().top;$global.SidebarSettings.lowerBoundChild=jquery_default()(".sidebar-sticky").offset().top+jquery_default()('.sidebar-sticky [data-js="sticky"]').height();current=$global.SidebarSettings;var scrollLoc=direction=="down"?current.vpBottom:current.vpTop;var logic={};var limboPrevState=$global.SidebarSettings.loc=="middle"||$global.SidebarSettings.loc=="external";if(direction=="down"){logic.middle=scrollLoc>=current.lowerBoundChild&&scrollLoc<=current.lowerBoundContainer;logic.limbo=limboPrevState&&scrollLoc<parseInt(current.lowerBoundChild.toFixed(0))&&scrollLoc<=current.lowerBoundContainer}else{logic.middle=scrollLoc<=current.upperBoundChild&&scrollLoc>=current.upperBoundContainer;logic.limbo=scrollLoc>current.upperBoundChild&&scrollLoc>current.upperBoundContainer}logic.bottom=scrollLoc>current.lowerBoundContainer;logic.top=scrollLoc<current.upperBoundContainer||jquery_default()(window).scrollTop()==0;for(var state in logic){if(logic[state]){if($global.SidebarSettings.loc!=state){var classes=["at",state];if(state=="middle"){classes.push(direction)}if(state=="limbo"){var multiplyBy=cbc_page_stamp=="article"?3:2;jquery_default()('.sidebar [data-js="sticky"]').css({position:"absolute",top:jquery_default()('.sidebar [data-js="sticky"]').eq(0).offset().top-jquery_default()(".sidebar").offset().top,width:jquery_default()('.sidebar [data-js="sticky"]').width()}).attr("class","")}else{jquery_default()('.sidebar [data-js="sticky"]').attr("class",classes.join("-")).attr("style","")}$global.SidebarSettings.loc=state}}}$global.SidebarSettings.vpBottom=current.vpBottom}else{Utility.warn("Not Affixing Sidebar")}},StickySidebarInit:function(){if(jquery_default()('.sidebar [data-js="sticky"]').length&&jquery_default()(window).width()>=768){var ABTest=jquery_default()("[data-var]").data("var");if(ABTest==="A"){jquery_default()(window).on("scroll resize",(function(){$global.SidebarRefresh()}));BidBarrel.queue.push((function(resolve){BidBarrel.on("rendered",(function(){$global.SidebarRefresh()}));resolve()}))}else if(ABTest==="B"){$global.FixedFeed()}}},listingGalleryInit:function(){var thumbnailGalleryContainerWidth=jquery_default()(".thumbnail-row").width();var thumbnailListWidth=jquery_default()(".thumbnail-row ul").width();var $bigEl=jquery_default()(".image_blk > a");var bigImageFullPath=jquery_default()(".image_blk > a").data("full-path");var bigImageThumbPath=jquery_default()(".image_blk > a").data("full-thumbnail-path");var $bigElem=null;if(thumbnailListWidth>thumbnailGalleryContainerWidth){jquery_default()(".thumbnail-row").css("overflow-x","scroll")}jquery_default()(".image_blk").on("DOMSubtreeModified load",(function(e){if(jquery_default()(".image_blk .markup-embed").length>0){jquery_default()(".fancybox-inline").fancybox({margin:[$global.GetHeaderOffsetTop()+15,15,15,15],fitToView:true,autoSize:true,closeClick:false,openEffect:"none",closeEffect:"none",content:jquery_default()(decodeURIComponent(jquery_default()(".image_blk > a").data("markup")))[0].outerHTML,afterShow:function(){window.instgrm.Embeds.process()}})}if(jquery_default()(".image_blk > .markup-embed.loading-overlay iframe").length>0){jquery_default()(".image_blk > .markup-embed.loading-overlay").removeClass("loading-overlay")}}));jquery_default()(".image_blk > .thumbnail-row a").off("click").on("click",(function(){if(jquery_default()(".image_blk > a").length>0){jquery_default()(".image_blk > a").remove()}if(jquery_default()(".image_blk > .markup-embed").length>0){jquery_default()(".image_blk > .markup-embed").remove()}if(jquery_default()(this).attr("data-asset-type")=="markup"){var preview=jquery_default()(decodeURIComponent(jquery_default()(this).data("preview"))).toArray();preview=preview.map((function(e){if(jquery_default()(e).is("script")){return""}return jquery_default()(e)[0].outerHTML!="undefined"?jquery_default()(e)[0].outerHTML:""}));preview=preview.join("");jquery_default()(".image_blk").prepend('<div class="markup-embed instagram-embed loading-overlay no-icon"></div>');jquery_default()(".image_blk > .markup-embed").html(preview);jquery_default()(".image_blk > .markup-embed.loading-overlay").removeClass("loading-overlay");window.instgrm.Embeds.process()}else{if(jquery_default()(".image_blk > a").length==0){if($bigElem==null){$bigElem=jquery_default()('<a class="fancybox-thumb" rel="fancybox-thumb"><img /></a>')}jquery_default()(".image_blk").prepend($bigElem)}else{var $newElem=jquery_default()('<a class="fancybox-thumb" rel="fancybox-thumb"><img /></a>');jquery_default()(".image_blk").prepend($newElem)}$bigEl=jquery_default()(".image_blk > a");var $smallEl=jquery_default()(this);var smallImgThumbPath=$smallEl.data("thumbnail-path");smallImgFullPath=$smallEl.data("full-path");$bigEl.attr("href",smallImgFullPath).data("full-path",smallImgFullPath).data("thumbnail-path",smallImgThumbPath);jquery_default()("img",$bigEl).attr("src",smallImgFullPath);$smallEl.data("thumbnail-path",bigImageThumbPath).data("full-path",bigImageFullPath);jquery_default()("img",$smallEl).attr("src",bigImageFullPath)}}))},tinyMCEBaseParams:{relative_urls:false,convert_urls:false,remove_script_host:false,menubar:"true"},SortTable:function(){var getCellValue=function(tr,index){return tr.children[index].getAttribute("data-sort")};var comparer=function(index,asc){return function(a,b){return function(v1,v2){return v1!==""&&v2!==""&&!isNaN(v1)&&!isNaN(v2)?v1-v2:v1.toString().localeCompare(v2)}(getCellValue(asc?a:b,index),getCellValue(asc?b:a,index))}};Array.from(document.querySelectorAll(".sort-table th")).forEach((function(th){th.addEventListener("click",(function(e){var tbody=th.parentNode.parentNode.nextSibling.nextSibling;var targetTh=e.target;Array.from(document.querySelectorAll(".sort-table th")).forEach((function(th){if(th!==targetTh){th.dataset.direction="desc"}}));targetTh.dataset.direction=targetTh.dataset.direction==="asc"?"desc":"asc";Array.from(tbody.querySelectorAll("tr")).sort(comparer(Array.from(th.parentNode.children).indexOf(th),this.asc=!this.asc)).forEach((function(tr){tbody.appendChild(tr)}))}))}))},TooltipInit:function(){jquery_default()(".tooltip:not(.usertools)").addClass("hidden");jquery_default()('[data-js="tooltip"]').each((function(index){var $el=jquery_default()(this);var message=jquery_default()(this).data("message");var tooltipId="tooltip_"+index;$el.attr("data-nth-tooltip",index);jquery_default()("body").append('<div class="js-tooltip hidden" id="'+tooltipId+'"><b class="icon-close tooltip_close"></b><p>'+message+"</p></div>")}));jquery_default()(".tooltip_close").on("click",(function(){jquery_default()(this).parent(".js-tooltip").addClass("hidden");return false}))},updateTwitterSocial:function(elem,url){jquery_default.a.getJSON("http://cdn.api.twitter.com/1/urls/count.json?callback=?&url="+url,(function(data){var count=$global.nFormatter(data.count);elem.text(count)}))},updateFacebookSocial:function(elem,url){jquery_default.a.getJSON("http://graph.facebook.com/?id="+url,(function(data){if(data.shares!=null){var count=$global.nFormatter(data.shares);elem.text(count)}else{elem.text(0)}}))},OnSmallNav:function(anchor){jquery_default()(".nav_lst > li > a").removeClass("opened");anchor.addClass("opened");var anchorId=jquery_default()(".opened + section").attr("id").toLowerCase();jquery_default()(".menuholder").html(anchor.parent().find("section").html()).show().attr("class","menuholder "+anchorId)},OffSmallNav:function(anchor){jquery_default()(".menuholder").hide();anchor.removeClass("opened")},loadMore:function(){var anchor=jquery_default()(".iscroll");var url=anchor.data("url");var path=anchor.data("path");jquery_default.a.ajax({url:url,dataType:"json",success:function(data){anchor.replaceWith(data);$global.updatePath(path)},complete:function(){}});return false},registerInfiniteScroll:function(passedConfig){var parent=jquery_default()('[data-js="infinite-scroll"]').last();if(!parent.data()["has-callback"]){var parent=parent;parent.data("has-callback","1");if(!passedConfig){var url=parent.data("url");url+="?Page="+parent.data("page");if(parent.data("params")){url+="&"+parent.data("params")}var config={url:url,parent:parent,target:parent.data("scroll-target"),page:parseInt(parent.data("page"))}}else{var config=passedConfig;config.page=config.page+1;config.parent=parent}if(!window.scrollingCallback){window.scrollingCallback={}}window.scrollingCallback["is-"+config.page]=function(){$global.checkInfiniteScroll(config)};jquery_default()(window).on("scroll",window.scrollingCallback["is-"+config.page])}},getContent:function(config){jquery_default.a.ajax({url:config.url,type:"get",success:function(response){if(config.prerender){var success=config.prerender(response,config);response=success||response}if(config.after){config.after.after(response)}if(config.before){config.before.before(response)}if(config.append){config.append.append(response)}if(config.postrender){config.postrender(response,config)}if(config.success){config.success(response,config)}},complete:function(response){if(config.complete){config.complete(response,config)}}})},checkInfiniteScroll:function(config){var target=config.parent.find(config.target).eq(0);if(jquery_default()(window).scrollTop()>=target.offset().top&&!target.data().triggered){target.data("triggered","1");var url=$global.updateURLParameter(config.url,"Page",config.page);$global.getContent({url:url,after:config.parent,initConfig:config,prerender:function(response,config){var res=jquery_default()("<div>"+response+"</div>");res.find("section").attr("data-js","infinite-scroll");return res.html()},success:function(response,config){$global.SidebarSettings.loc="external";$global.SidebarRefresh();jquery_default()(".main_content, .entity-main-content, .sticky-sidebar").css({height:"auto"});$global.registerInfiniteScroll(config.initConfig)}})}if(jquery_default()(window).scrollTop()>=target.siblings(":first").offset().top&&!config.parent.data("new-page")){config.parent.data("new-page","1");if(config.page>2){$global.NewPageView($global.updateURLParameter(config.url,"Page",config.page-1))}}},updateURLParameter:function(url,param,paramVal){var newAdditionalURL="";var tempArray=url.split("?");var baseURL=tempArray[0];var additionalURL=tempArray[1];var temp="";if(additionalURL){tempArray=additionalURL.split("&");for(var i=0;i<tempArray.length;i++){if(tempArray[i].split("=")[0]!=param){newAdditionalURL+=temp+tempArray[i];temp="&"}}}if(typeof om!=="undefined"){om.trackView()}var rows_txt=String(temp)+param+"="+paramVal;return baseURL+"?"+newAdditionalURL+rows_txt},newsletterEventListeners:function(config){jquery_default()(".newsletter-capture:not(.events-registered)").each((function(){jquery_default()(this).addClass("events-registered");var form=jquery_default()(this);var submitBtn=form.find(".newsletter-capture-submit").eq(0);var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;submitBtn.click((function(e){e.preventDefault();form.submit()}));form.on("submit",(function(e){e.preventDefault();var email=jquery_default()(this).find(".newsletter-capture-email").val();var url=form.attr("action");if(re.test(email)){var chans=[];jquery_default()(this).find(".channel-selection :checkbox:checked").map((function(){chans.push(jquery_default()(this).val())}));var data={email:email,zip:jquery_default()(this).find(".newsletter-capture-zipcode").val(),channels:chans,url:url||null};if(submitBtn.data("content-disabled")){submitBtn.addClass("disabled")}main.newsletterCapture(data).then((function(response){if(response.success){submitBtn.removeClass("disabled");form.addClass("capture-success");if(submitBtn.data("content-success")){submitBtn.toggleClass("success")}setTimeout((function(){submitBtn.removeClass("success");form.removeClass("capture-success")}),5e3)}else{submitBtn.removeClass("disabled");form.addClass("capture-error");if(submitBtn.data("content-error")){submitBtn.toggleClass("error")}setTimeout((function(){submitBtn.removeClass("error");form.removeClass("capture-error")}),5e3)}}));setTimeout((function(){submitBtn.removeClass("disabled");if(submitBtn.hasClass("error")||submitBtn.hasClass("success")){submitBtn.removeClass("error success")}setTimeout((function(){submitBtn.removeClass("error")}),5e3)}),2e4)}else{submitBtn.removeClass("disabled");if(submitBtn.data("content-error")){submitBtn.toggleClass("error")}setTimeout((function(){submitBtn.removeClass("error")}),5e3)}return false}))}))},nFormatter:function(num){if(num>=1e9){return(num/1e9).toFixed(0).replace(/\.0$/,"")+"G"}if(num>=1e6){return(num/1e6).toFixed(0).replace(/\.0$/,"")+"M"}if(num>=1e3){return(num/1e3).toFixed(0).replace(/\.0$/,"")+"K"}return num},GetQueryStringParameter:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)");var results=regex.exec(location.search);return results==null?"":decodeURIComponent(results[1].replace(/\+/g," "))},GetUrlMeta:function(url){var a=document.createElement("a");if(!url){url=window.location.href}a.href=url;return a},isScrolledIntoView:function(elem){var docViewTop=jquery_default()(window).scrollTop();var docViewBottom=docViewTop+jquery_default()(window).height();var elemTop=jquery_default()(elem).offset().top;var elemBottom=elemTop+jquery_default()(elem).height();return elemBottom<=docViewBottom&&elemTop>=docViewTop},updateGoogle:function($path,$title,$author){Object(consent["a"])("performance").then(()=>{var _$cbc$Model;const ftag=PopCultureAnalytics["a"].getFTag();const ttag=PopCultureAnalytics["a"].getTTag();const pageType="".concat($cbc.CurrentSite.PageType,"_").concat($cbc.CurrentSite.PageSubType);const dataLayerUpdate={path:PopCultureAnalytics["a"].getPagePath($path),title:$title!==null&&$title!==void 0?$title:"",dimension3:pageType,...ftag&&{ftag:ftag},...ttag&&{ttag:ttag},...((_$cbc$Model=$cbc.Model)===null||_$cbc$Model===void 0?void 0:_$cbc$Model.Author)&&{dimension1:$cbc.Model.Author,dimension2:$cbc.Model.Author,dimension6:$cbc.Model.AuthorKey}};PopCultureAnalytics["a"].pageView(dataLayerUpdate)})},updateComScore:function($path){Object(consent["a"])("performance").then(()=>{if(typeof COMSCORE!=="undefined"&&typeof comscoreID!=="undefined"){COMSCORE.beacon({c1:"2",c2:comscoreID,c4:$path})}})},refreshTealiumState:function(newUrl,isScroll){if(typeof om!=="undefined"){if(isScroll!=="undefined"&&isScroll===true){om.trackState({pageUrl:newUrl,pageViewGuid:identity.getHitId(),browserTitle:document.title,articleId:$cbc.Model.Key,articleTitle:$cbc.Model.Title,articleType:$cbc.Model.Type})}else{om.trackState({pageUrl:newUrl,pageViewGuid:identity.getHitId(),browserTitle:document.title})}}},updateQuantServe:function(){Object(consent["a"])("performance").then(()=>{try{if(typeof __qc!=="undefined"&&typeof __qc.async!=="undefined"){__qc.async()}}catch(e){}})},updatePath:function(path,title,author){const newUrl="".concat(window.location.origin,"/").concat(path);if(history.pushState){history.pushState("","",newUrl);$global.updateGoogle(newUrl,title,author);window.identity.newPageHit({url:newUrl,title:title});$global.refreshTealiumState(newUrl,true);window.BidBarrel.setTargeting({vguid:window.identity.getHitId()});$global.updateComScore(newUrl);$global.updateQuantServe(newUrl)}},updateUrl:function(path){const newUrl="".concat(window.location.origin,"/").concat(path);if(history.pushState){history.pushState("","",newUrl)}},scale:function(){return document.body.clientWidth/window.innerWidth},hideLoading:function(content){jquery_default()(this).unbind("keypress.fb");jquery_default()("#global-loading").remove()},showLoading:function(content){$global.hideLoading();jquery_default()(this).bind("keypress",(function(e){if(e.keyCode==27){e.preventDefault();jquery_default()(this).cancel()}}));jquery_default()('<div id="global-loading"><div></div></div>').click(jquery_default()(this).cancel).appendTo("body")},validateEmail:function(email){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(!emailReg.test(email)){return false}return true},editorInit:function(focus,body){var mediaAccess="";var autoFocus=focus=="False"?"":body;var publicParams={content_css:"/src/vendor/tinymce.css",statusbar:false,selector:body,auto_focus:autoFocus,height:150,plugins:"media link emoticons imageugc spoiler",toolbar1:"bold italic imageugc media link spoiler",element_format:"html",valid_children:"+span[a|strong|span],+a[b|span]",valid_elements:"a[href],strong,em,b[class],u,i,p[style],ol,ul,del,li,blockquote[id|class],span[style|class],img[src],iframe[style|src|width|height|allowfullscreen|frameborder|class]",formats:{underline:{inline:"u",exact:true},strikethrough:{inline:"del"}}};var params=jquery_default.a.extend({},$global.tinyMCEBaseParams,publicParams);if(body==null){body="#Body"}if(typeof $cbc==="undefined"||$cbc.User.MediaBan==true){params.mediaAccess="bold italic link spoiler";params.validElements="a[href],strong,em,b[class],u,i,p[style],ol,ul,del,li,blockquote[id|class],span[style|class]"}tinymce.baseURL="/src/vendor/tinymce";tinymce.init(params);if(jquery_default()("#Title").length>0){jquery_default()("#Title").focus();setTimeout((function(){jquery_default()("#Title").focus()}),1500)}},onVisibilityChange:function(el,callback){var old_visible;return function(){var visible=isElementInViewport(el);if(visible!=old_visible){old_visible=visible;if(typeof callback==="function"){callback()}}}},isInView:function(el){el=el[0];var rect=el.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},isCB:function(){if(window.location.host.match(/comicbook/i)!=null){return true}return false},assetServer:function(){var host=window.location.host;if(host.match(/local/i)!=null||host.match(/dev/i)!=null){return"/"}if(host.match(/comicbook/i)!=null){return"http://asset."+window.location.host.match(/comicbook/i)+".com/"}else if(host.match(/womanista/i)!=null){return"http://asset."+window.location.host.match(/womanista/i)+".com/"}else if(host.match(/wwg/i)!=null){return"http://asset."+window.location.host.match(/wwg/i)+".com/"}return""},rulerUtil:function(measurement,color){jquery_default()("body").append('<div class="ruler" style="position: absolute; z-index: 9999999; width: 100%; height: 1px; background-color: '+color+"; top: "+measurement+'px;"></div>')}};function bindClickActivators(){const clickActivators=jquery_default()("[data-click-activates]:not(.data-activates-listening)");const clickParentActivators=jquery_default()("[data-click-activates-parent]:not(.data-activates-parent-listening)");clickActivators.each((_,el)=>{const $element=jquery_default()(el);$element.addClass("data-activates-listening");$element.on("click",_ref=>{let{target:target}=_ref;const activationSelector=target.getAttribute("data-click-activates");const targetEl=jquery_default()(activationSelector);if(targetEl){targetEl.toggleClass("active")}})});clickParentActivators.each((_,el)=>{const $element=jquery_default()(el);$element.addClass("data-activates-parent-listening");$element.on("click",_ref2=>{let{target:target}=_ref2;const activationSelector=target.getAttribute("data-click-activates-parent");const targetEl=jquery_default()(activationSelector)||jquery_default()(target.parentNode);if(targetEl){targetEl.toggleClass("active")}})})}function bindRatingEvent(){document.addEventListener("entity.rate",(function(e){jquery_default()("[data-entity-rating="+e.detail.key+"]").each((function(){jquery_default()(this).attr("data-rating",e.detail.rating)}))}))}function loadEntityRatings(){let retrieveFromSource=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!Object(auth["c"])()){return}const $ratings=jquery_default()("[data-entity-rating]");var entityQueryString="";$ratings.each((_,el)=>{const $el=jquery_default()(el);const entityId=$el.data("entityRating");const localStorageKey="Rating-"+entityId;var rating=0;const localStorageValue=Object(auth["b"])(localStorageKey);if(localStorageValue!==null){rating=localStorageValue;$el.attr("data-rating",rating)}else{entityQueryString=entityQueryString+entityId+","}});if(entityQueryString!==""&&retrieveFromSource){entityQueryString=entityQueryString.substring(0,entityQueryString.length-1);jquery_default.a.post("/entity/ratinglist/?entitylist="+entityQueryString).then(_ref3=>{let{data:data}=_ref3;data.forEach((function(item,index){var ratingResponse=0;if(item.UserKey){ratingResponse=item.UserRating}Object(auth["d"])("Rating-"+item.EntityKey,ratingResponse,72e5);loadEntityRatings(false)}))})}}function handleGdprClasses(){Object(consent["a"])("performance").then(()=>{jquery_default()(".u-hideWithoutConsent").removeClass("u-hideWithoutConsent")})}function getHeaderElementOffsetTop(){var height=jquery_default()("body > .topnav").outerHeight();var offset=jquery_default()("body > .topnav").offset();var offsetTop=offset?offset.top:0;return height+(offsetTop-jquery_default()(window).scrollTop())}function addMobileShareClickListeners(){jquery_default()(".mobile-share-activator:not(.listening)").on("click",event=>{event.preventDefault();jquery_default()(event.target).addClass("listening");jquery_default()(event.target).parents(".social_blk").toggleClass("active")})}bindClickActivators();addMobileShareClickListeners();bindRatingEvent();handleGdprClasses();loadEntityRatings();if(jquery_default()('[data-js="infinite-scroll"]').length){$global.registerInfiniteScroll()}if(jquery_default()(".newsletter-capture:not(.events-registered)").length){$global.newsletterEventListeners(false)}$global.newsletterEventListeners(jquery_default()("#e2ma_signup"));svg4everybody({polyfill:true});if(!jquery_default()(document).data("loading")){$global.init(jquery_default()("body"));if(jquery_default()("body").is(".pcm-public")){$global.StickySidebarInit()}$global.TooltipInit()}jquery_default()(".modern-embed[data-url]").each((function(index){$global.iterateOverEmbeds(jquery_default()(".modern-embed[data-url]")[index])}));jquery_default()(document).on("click",".more b, .less b",(function(e){const lessText='<b class="icon-arrow-up"></b>';const moreText='<b class="icon-arrow-down"></b>';const $el=jquery_default()(e.target).parent(".more, .less");let container=null;let maxH=0;if(Object(device["b"])()&&jquery_default()(this).parents("[data-mobilelengthlimit]").length>0){container=$el.closest("[data-mobilelengthlimit]");maxH=container.data("mobilelengthlimit")}else if(!Object(device["b"])()&&jquery_default()(this).parents("[data-lengthlimit]").length>0){container=$el.closest("[data-lengthlimit]");maxH=container.data("lengthlimit")}if($el.hasClass("more")){container.css({"max-height":"9999px",overflow:"visible"});container.find(".more, .less").html(lessText).toggleClass("more less")}else{container.css({"max-height":maxH+"em",overflow:"hidden"});container.find(".more, .less").html(moreText).toggleClass("more less")}})).on("click","#ShowName",(function(){if(jquery_default()("#ShowName").prop("checked")){jquery_default()("#ShowNameReal").val(1)}else{jquery_default()("#ShowNameReal").val(0)}})).on("click",".breadcrumbs .breadcrumb-deactivator,.breadcrumbs .breadcrumb-activator",(function(e){e.preventDefault();jquery_default()(this).parents(".breadcrumbs").eq(0).toggleClass("is-active")})).on("click",'[data-js="post-data"]',(function(){var anchor=jquery_default()(this);var url=anchor.data("url");var callback=anchor.data("callback");var data=anchor.data();var postdata={};var params=[];jquery_default.a.each(data,(function(index,value){if(index!=="js"&&index!=="url"){if(index.match("^field")){postdata[index.replace("field","")]=value}if(index.match("^param")){params[index.replace("param","")]=value}}}));if(jquery_default()(this).is('[data-callback="UpdateStars"]')){const index=parseInt(jquery_default()(this).data("field-rating"))-1;if(!user){window.location.href="/login?ReturnTo=".concat(window.location.href.replaceAll("#",""),"&message.error=You%20Must%20Be%20Logged%20In%20To%20Rate");return}jquery_default()(this).parents("[data-rating]").eq(0).attr("data-rating",(index+1).toString());jquery_default()(this).parent().find('[data-callback="UpdateStars"]').each((function(i){if(i<=index){jquery_default()(this).addClass("movieyellow")}else{jquery_default()(this).removeClass("movieyellow")}}));document.dispatchEvent(new CustomEvent("entity.rate",{detail:{key:postdata.Entity,rating:postdata.Rating}}));document.dispatchEvent(new CustomEvent("entity."+postdata.Entity+".rate",{detail:{key:postdata.Entity,rating:postdata.Rating}}));localStorage.removeItem("Rating-"+postdata.Entity);Utility.info("Updating Stars",postdata)}else{Utility.info("Post Data Triggered")}jquery_default.a.ajax({url:url,data:postdata,type:"post",dataType:"json",success:function(response){if(!response.success){Utility.error(response.message);return false}if(callback){let args=[response];const fn=window[callback];args=args.concat(params);if(typeof fn!=="function"){return}fn.call(window,args)}},error:function(err){console.error(err)}});return false})).on("click",".teaser-container .close",(function(e){if(jquery_default()(e.target).parents(".next-article-tease").css("bottom")!==""){jquery_default()(e.target).parents(".next-article-tease").css("bottom","initial")}})).on("click",'[data-js="load-more"]',(function(){const anchor=jquery_default()(this);const{url:url,page:page,exclude:exclude,params:params}=anchor.data();let fullUrl="".concat(url,"?Page=").concat(page);if(params){fullUrl+="&"+params}if(exclude){fullUrl+="&Exclude="+exclude}anchor.data("page",(parseInt(page)+1).toString());anchor.data("exclude","");const successCallback=function(response,config){$global.NewPageView(config.url);$global.SidebarSettings.loc="external";$global.SidebarRefresh();jquery_default()(".main_content, .entity-main-content, .sticky-sidebar").css({height:"auto"})};const completeCallback=function(){if(anchor.eq(0).siblings().length==anchor.data("total-count")){anchor.hide()}};const config={before:jquery_default()(this),url:fullUrl,success:successCallback,complete:completeCallback};$global.getContent(config);$global.SidebarRefresh();$global.refreshTealiumState(url,false);return false})).on("click",".main-article .video-overlay, .main-article .icon-holder",(function(){const $overlay=jquery_default()(".video-overlay");const $icon=jquery_default()(".icon-holder");const $context=jquery_default()(this).parents(".video-content");const $playBtn=$context.find(".vjs-big-play-button");$context.next(".headline-box").css({top:"100%",overflow:"hidden",padding:"0"});$icon.hide();$overlay.hide();$playBtn.trigger("click")})).on("click",".socialpopup",(function(){var width=575;var height=400;var left=(jquery_default()(window).width()-width)/2;var top=(jquery_default()(window).height()-height)/2;var url=this.href;var opts="status=1,width="+width+",height="+height+",top="+top+",left="+left;window.open(url,"",opts);return false})).on("mouseleave",".newsletter-popup",(function(){jquery_default()(this).addClass("hidden")})).on("click",".tooltip",(function(){jquery_default()(this).parent().find(".tooltip-block").show();return false})).on("click",".tooltip-close",(function(){jquery_default()(this).parent(".tooltip-block").hide();return false})).on("click",".spoiler",(function(){jquery_default()(this).removeClass("on");return false})).on("click",".showfullsynopsis",(function(){jquery_default()(this).next().show();jquery_default()(this).hide();return false})).on("click",".hidefullsynopsis",(function(){jquery_default()(this).parent().hide();jquery_default()(this).parent().prev().show();return false})).on("click",".showyear, .showseasons",(function(){jquery_default()(this).next().toggleClass("active");if(jquery_default()(this).next().hasClass("active")){jquery_default()(this).find("b").removeClass("icon-plus");jquery_default()(this).find("b").addClass("icon-minus")}else{jquery_default()(this).find("b").removeClass("icon-minus");jquery_default()(this).find("b").addClass("icon-plus")}return false})).on("blur",".uniquecheck",(function(){const input=jquery_default()(this);const value=input.val();if(!value){input.parent().find("ul.error-message").remove();input.parent().append('<ul class="error-message"><li>* Required Field</li></ul>')}else{jquery_default.a.ajax({type:"get",url:"".concat(input.data("url"),'?field="').concat(input.data("field"),'&search="').concat(input.val()),dataType:"json",success:function(json){if(json.unique==false){const value=input.val();input.parent().find("ul.error-message").remove();input.parent().append('\n\t\t\t\t\t\t\t\t<ul class="error-message">\n\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t'.concat(value," already in use. You might try ").concat(value+Math.floor(Math.random()*9999),"\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t"))}else{input.parent().find("ul.error-message").remove()}}})}}));jquery_default()(".fancybox").fancybox({maxWidth:800,maxHeight:600,width:"70%",height:"70%",autoSize:false,openEffect:"none",closeEffect:"none",fitToView:true,padding:0,helpers:{overlay:{closeClick:true,locked:false}}});jquery_default()(".fancy-ajax").fancybox({type:"ajax",openEffect:"none",closeEffect:"none",autosize:false,minHeight:400,minWidth:250,maxWidth:"90%",maxHeight:"90%",margin:10,topRatio:.7,ajax:{dataFilter:function(data){return jquery_default()(data).find(".ajax-content")[0]}}});jquery_default()(".fancy-image").fancybox({type:"ajax",openEffect:"none",closeEffect:"none",minWidth:800,maxHeight:600,height:"auto",ajax:{dataFilter:function(data){return jquery_default()(data).find(".ajax-content")[0]}}});jquery_default()(".fancybox-thumb").fancybox({prevEffect:"none",nextEffect:"none",padding:0,margin:[140,0,0,0],autoCenter:true,fitToView:true,helpers:{title:{type:"outside"},thumbs:{width:"100",height:"100"}}});$global.elementShowHide();window.$global=$global}},Jrfb:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){__webpack_require__.d(__webpack_exports__,"a",(function(){return ui}));const BUILD={allRenderFn:false,cmpDidLoad:true,cmpDidUnload:false,cmpDidUpdate:true,cmpDidRender:true,cmpWillLoad:true,cmpWillUpdate:true,cmpWillRender:true,connectedCallback:true,disconnectedCallback:true,element:true,event:true,hasRenderFn:true,lifecycle:true,hostListener:true,hostListenerTargetWindow:true,hostListenerTargetDocument:true,hostListenerTargetBody:true,hostListenerTargetParent:false,hostListenerTarget:true,member:true,method:true,mode:true,observeAttribute:true,prop:true,propMutable:true,reflect:true,scoped:true,shadowDom:true,slot:true,cssAnnotations:true,state:true,style:true,svg:true,updatable:true,vdomAttribute:true,vdomXlink:true,vdomClass:true,vdomFunctional:true,vdomKey:true,vdomListener:true,vdomRef:true,vdomPropOrAttr:true,vdomRender:true,vdomStyle:true,vdomText:true,watchCallback:true,taskQueue:true,hotModuleReplacement:false,isDebug:false,isDev:false,isTesting:false,hydrateServerSide:false,hydrateClientSide:false,lifecycleDOMEvents:false,lazyLoad:false,profile:false,slotRelocation:true,appendChildSlotFix:false,cloneNodeFix:false,hydratedAttribute:false,hydratedClass:true,safari10:false,scriptDataOpts:false,scopedSlotTextContentFix:false,shadowDomShim:false,slotChildNodesFix:false,invisiblePrehydration:true,propBoolean:true,propNumber:true,propString:true,cssVarShim:false,constructableCSS:true,cmpShouldUpdate:true,devTools:false,dynamicImportShim:false,shadowDelegatesFocus:true,initializeNextTick:false,asyncLoading:false,asyncQueue:false,transformTagName:false,attachStyles:true};let scopeId;let contentRef;let hostTagName;let useNativeShadowDom=false;let checkSlotFallbackVisibility=false;let checkSlotRelocate=false;let isSvgMode=false;let renderingRef=null;let queuePending=false;const win=typeof window!=="undefined"?window:{};BUILD.cssVarShim?win.CSS:null;const doc=win.document||{head:{}};const H=win.HTMLElement||class{};const plt={$flags$:0,$resourcesUrl$:"",jmp:h=>h(),raf:h=>requestAnimationFrame(h),ael:(el,eventName,listener,opts)=>el.addEventListener(eventName,listener,opts),rel:(el,eventName,listener,opts)=>el.removeEventListener(eventName,listener,opts),ce:(eventName,opts)=>new CustomEvent(eventName,opts)};const supportsShadow=BUILD.shadowDomShim&&BUILD.shadowDom?(()=>(doc.head.attachShadow+"").indexOf("[native")>-1)():true;const supportsListenerOptions=(()=>{let supportsListenerOptions=false;try{doc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){supportsListenerOptions=true}}))}catch(e){}return supportsListenerOptions})();const promiseResolve=v=>Promise.resolve(v);const supportsConstructibleStylesheets=BUILD.constructableCSS?(()=>{try{new CSSStyleSheet;return typeof(new CSSStyleSheet).replace==="function"}catch(e){}return false})():false;const addHostEventListeners=(elm,hostRef,listeners,attachParentListeners)=>{if(listeners){listeners.map(_ref=>{let[flags,name,method]=_ref;const target=getHostListenerTarget(elm,flags);const handler=hostListenerProxy(hostRef,method);const opts=hostListenerOpts(flags);plt.ael(target,name,handler,opts);(hostRef.$rmListeners$=hostRef.$rmListeners$||[]).push(()=>plt.rel(target,name,handler,opts))})}};const hostListenerProxy=(hostRef,methodName)=>ev=>{try{if(BUILD.lazyLoad);else{hostRef.$hostElement$[methodName](ev)}}catch(e){consoleError(e)}};const getHostListenerTarget=(elm,flags)=>{if(flags&4)return doc;if(flags&8)return win;if(flags&16)return doc.body;return elm};const hostListenerOpts=flags=>supportsListenerOptions?{passive:(flags&1)!==0,capture:(flags&2)!==0}:(flags&2)!==0;const XLINK_NS="http://www.w3.org/1999/xlink";const createTime=function(fnName){let tagName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";{return()=>{}}};const rootAppliedStyles=new WeakMap;const registerStyle=(scopeId,cssText,allowCS)=>{let style=styles.get(scopeId);if(supportsConstructibleStylesheets&&allowCS){style=style||new CSSStyleSheet;style.replace(cssText)}else{style=cssText}styles.set(scopeId,style)};const addStyle=(styleContainerNode,cmpMeta,mode,hostElm)=>{let scopeId=getScopeId(cmpMeta,mode);let style=styles.get(scopeId);styleContainerNode=styleContainerNode.nodeType===11?styleContainerNode:doc;if(style){if(typeof style==="string"){styleContainerNode=styleContainerNode.head||styleContainerNode;let appliedStyles=rootAppliedStyles.get(styleContainerNode);let styleElm;if(!appliedStyles){rootAppliedStyles.set(styleContainerNode,appliedStyles=new Set)}if(!appliedStyles.has(scopeId)){{{styleElm=doc.createElement("style");styleElm.innerHTML=style}styleContainerNode.insertBefore(styleElm,styleContainerNode.querySelector("link"))}if(appliedStyles){appliedStyles.add(scopeId)}}}else if(!styleContainerNode.adoptedStyleSheets.includes(style)){styleContainerNode.adoptedStyleSheets=[...styleContainerNode.adoptedStyleSheets,style]}}return scopeId};const attachStyles=hostRef=>{const cmpMeta=hostRef.$cmpMeta$;const elm=hostRef.$hostElement$;const flags=cmpMeta.$flags$;const endAttachStyles=createTime("attachStyles",cmpMeta.$tagName$);const scopeId=addStyle(supportsShadow&&elm.shadowRoot?elm.shadowRoot:elm.getRootNode(),cmpMeta,hostRef.$modeName$);if(flags&10){elm["s-sc"]=scopeId;elm.classList.add(scopeId+"-h");if(flags&2){elm.classList.add(scopeId+"-s")}}endAttachStyles()};const getScopeId=(cmp,mode)=>"sc-"+(mode&&cmp.$flags$&32?cmp.$tagName$+"-"+mode:cmp.$tagName$);const computeMode=elm=>modeResolutionChain.map(h=>h(elm)).find(m=>!!m);const EMPTY_OBJ={};const SVG_NS="http://www.w3.org/2000/svg";const HTML_NS="http://www.w3.org/1999/xhtml";const isDef=v=>v!=null;const isComplexType=o=>{o=typeof o;return o==="object"||o==="function"};const h=function(nodeName,vnodeData){let child=null;let key=null;let slotName=null;let simple=false;let lastSimple=false;let vNodeChildren=[];const walk=c=>{for(let i=0;i<c.length;i++){child=c[i];if(Array.isArray(child)){walk(child)}else if(child!=null&&typeof child!=="boolean"){if(simple=typeof nodeName!=="function"&&!isComplexType(child)){child=String(child)}if(simple&&lastSimple){vNodeChildren[vNodeChildren.length-1].$text$+=child}else{vNodeChildren.push(simple?newVNode(null,child):child)}lastSimple=simple}}};for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key]}walk(children);if(vnodeData){if(BUILD.isDev&&nodeName==="input"){validateInputProperties(vnodeData)}if(BUILD.vdomKey&&vnodeData.key){key=vnodeData.key}if(BUILD.slotRelocation&&vnodeData.name){slotName=vnodeData.name}if(BUILD.vdomClass){const classData=vnodeData.className||vnodeData.class;if(classData){vnodeData.class=typeof classData!=="object"?classData:Object.keys(classData).filter(k=>classData[k]).join(" ")}}}if(BUILD.isDev&&vNodeChildren.some(isHost)){consoleDevError("The <Host> must be the single root component. Make sure:\n- You are NOT using hostData() and <Host> in the same component.\n- <Host> is used once, and it's the single root component of the render() function.")}if(BUILD.vdomFunctional&&typeof nodeName==="function"){return nodeName(vnodeData===null?{}:vnodeData,vNodeChildren,vdomFnUtils)}const vnode=newVNode(nodeName,null);vnode.$attrs$=vnodeData;if(vNodeChildren.length>0){vnode.$children$=vNodeChildren}if(BUILD.vdomKey){vnode.$key$=key}if(BUILD.slotRelocation){vnode.$name$=slotName}return vnode};const newVNode=(tag,text)=>{const vnode={$flags$:0,$tag$:tag,$text$:text,$elm$:null,$children$:null};if(BUILD.vdomAttribute){vnode.$attrs$=null}if(BUILD.vdomKey){vnode.$key$=null}if(BUILD.slotRelocation){vnode.$name$=null}return vnode};const Host={};const isHost=node=>node&&node.$tag$===Host;const vdomFnUtils={forEach:(children,cb)=>children.map(convertToPublic).forEach(cb),map:(children,cb)=>children.map(convertToPublic).map(cb).map(convertToPrivate)};const convertToPublic=node=>({vattrs:node.$attrs$,vchildren:node.$children$,vkey:node.$key$,vname:node.$name$,vtag:node.$tag$,vtext:node.$text$});const convertToPrivate=node=>{if(typeof node.vtag==="function"){const vnodeData=Object.assign({},node.vattrs);if(node.vkey){vnodeData.key=node.vkey}if(node.vname){vnodeData.name=node.vname}return h(node.vtag,vnodeData,...node.vchildren||[])}const vnode=newVNode(node.vtag,node.vtext);vnode.$attrs$=node.vattrs;vnode.$children$=node.vchildren;vnode.$key$=node.vkey;vnode.$name$=node.vname;return vnode};const validateInputProperties=vnodeData=>{const props=Object.keys(vnodeData);const typeIndex=props.indexOf("type");const minIndex=props.indexOf("min");const maxIndex=props.indexOf("max");const stepIndex=props.indexOf("min");const value=props.indexOf("value");if(value===-1){return}if(value<typeIndex||value<minIndex||value<maxIndex||value<stepIndex){consoleDevWarn('The "value" prop of <input> should be set after "min", "max", "type" and "step"')}};const setAccessor=(elm,memberName,oldValue,newValue,isSvg,flags)=>{if(oldValue!==newValue){let isProp=isMemberInElement(elm,memberName);let ln=memberName.toLowerCase();if(memberName==="class"){const classList=elm.classList;const oldClasses=parseClassList(oldValue);const newClasses=parseClassList(newValue);classList.remove(...oldClasses.filter(c=>c&&!newClasses.includes(c)));classList.add(...newClasses.filter(c=>c&&!oldClasses.includes(c)))}else if(memberName==="style"){{for(const prop in oldValue){if(!newValue||newValue[prop]==null){if(prop.includes("-")){elm.style.removeProperty(prop)}else{elm.style[prop]=""}}}}for(const prop in newValue){if(!oldValue||newValue[prop]!==oldValue[prop]){if(prop.includes("-")){elm.style.setProperty(prop,newValue[prop])}else{elm.style[prop]=newValue[prop]}}}}else if(memberName==="key");else if(memberName==="ref"){if(newValue){newValue(elm)}}else if(!elm.__lookupSetter__(memberName)&&memberName[0]==="o"&&memberName[1]==="n"){if(memberName[2]==="-"){memberName=memberName.slice(3)}else if(isMemberInElement(win,ln)){memberName=ln.slice(2)}else{memberName=ln[2]+memberName.slice(3)}if(oldValue){plt.rel(elm,memberName,oldValue,false)}if(newValue){plt.ael(elm,memberName,newValue,false)}}else{const isComplex=isComplexType(newValue);if((isProp||isComplex&&newValue!==null)&&!isSvg){try{if(!elm.tagName.includes("-")){let n=newValue==null?"":newValue;if(memberName==="list"){isProp=false}else if(oldValue==null||elm[memberName]!=n){elm[memberName]=n}}else{elm[memberName]=newValue}}catch(e){}}let xlink=false;{if(ln!==(ln=ln.replace(/^xlink\:?/,""))){memberName=ln;xlink=true}}if(newValue==null||newValue===false){if(newValue!==false||elm.getAttribute(memberName)===""){if(xlink){elm.removeAttributeNS(XLINK_NS,memberName)}else{elm.removeAttribute(memberName)}}}else if((!isProp||flags&4||isSvg)&&!isComplex){newValue=newValue===true?"":newValue;if(xlink){elm.setAttributeNS(XLINK_NS,memberName,newValue)}else{elm.setAttribute(memberName,newValue)}}}}};const parseClassListRegex=/\s/;const parseClassList=value=>!value?[]:value.split(parseClassListRegex);const updateElement=(oldVnode,newVnode,isSvgMode,memberName)=>{const elm=newVnode.$elm$.nodeType===11&&newVnode.$elm$.host?newVnode.$elm$.host:newVnode.$elm$;const oldVnodeAttrs=oldVnode&&oldVnode.$attrs$||EMPTY_OBJ;const newVnodeAttrs=newVnode.$attrs$||EMPTY_OBJ;{for(memberName in oldVnodeAttrs){if(!(memberName in newVnodeAttrs)){setAccessor(elm,memberName,oldVnodeAttrs[memberName],undefined,isSvgMode,newVnode.$flags$)}}}for(memberName in newVnodeAttrs){setAccessor(elm,memberName,oldVnodeAttrs[memberName],newVnodeAttrs[memberName],isSvgMode,newVnode.$flags$)}};const createElm=(oldParentVNode,newParentVNode,childIndex,parentElm)=>{let newVNode=newParentVNode.$children$[childIndex];let i=0;let elm;let childNode;let oldVNode;if(!useNativeShadowDom){checkSlotRelocate=true;if(newVNode.$tag$==="slot"){if(scopeId){parentElm.classList.add(scopeId+"-s")}newVNode.$flags$|=newVNode.$children$?2:1}}if(newVNode.$text$!==null){elm=newVNode.$elm$=doc.createTextNode(newVNode.$text$)}else if(newVNode.$flags$&1){elm=newVNode.$elm$=doc.createTextNode("")}else{if(!isSvgMode){isSvgMode=newVNode.$tag$==="svg"}elm=newVNode.$elm$=doc.createElementNS(isSvgMode?SVG_NS:HTML_NS,newVNode.$flags$&2?"slot-fb":newVNode.$tag$);if(isSvgMode&&newVNode.$tag$==="foreignObject"){isSvgMode=false}{updateElement(null,newVNode,isSvgMode)}if(isDef(scopeId)&&elm["s-si"]!==scopeId){elm.classList.add(elm["s-si"]=scopeId)}if(newVNode.$children$){for(i=0;i<newVNode.$children$.length;++i){childNode=createElm(oldParentVNode,newVNode,i,elm);if(childNode){elm.appendChild(childNode)}}}{if(newVNode.$tag$==="svg"){isSvgMode=false}else if(elm.tagName==="foreignObject"){isSvgMode=true}}}{elm["s-hn"]=hostTagName;if(newVNode.$flags$&(2|1)){elm["s-sr"]=true;elm["s-cr"]=contentRef;elm["s-sn"]=newVNode.$name$||"";oldVNode=oldParentVNode&&oldParentVNode.$children$&&oldParentVNode.$children$[childIndex];if(oldVNode&&oldVNode.$tag$===newVNode.$tag$&&oldParentVNode.$elm$){putBackInOriginalLocation(oldParentVNode.$elm$,false)}}}return elm};const putBackInOriginalLocation=(parentElm,recursive)=>{plt.$flags$|=1;const oldSlotChildNodes=parentElm.childNodes;for(let i=oldSlotChildNodes.length-1;i>=0;i--){const childNode=oldSlotChildNodes[i];if(childNode["s-hn"]!==hostTagName&&childNode["s-ol"]){parentReferenceNode(childNode).insertBefore(childNode,referenceNode(childNode));childNode["s-ol"].remove();childNode["s-ol"]=undefined;checkSlotRelocate=true}if(recursive){putBackInOriginalLocation(childNode,recursive)}}plt.$flags$&=~1};const addVnodes=(parentElm,before,parentVNode,vnodes,startIdx,endIdx)=>{let containerElm=parentElm["s-cr"]&&parentElm["s-cr"].parentNode||parentElm;let childNode;if(containerElm.shadowRoot&&containerElm.tagName===hostTagName){containerElm=containerElm.shadowRoot}for(;startIdx<=endIdx;++startIdx){if(vnodes[startIdx]){childNode=createElm(null,parentVNode,startIdx,parentElm);if(childNode){vnodes[startIdx].$elm$=childNode;containerElm.insertBefore(childNode,referenceNode(before))}}}};const removeVnodes=(vnodes,startIdx,endIdx,vnode,elm)=>{for(;startIdx<=endIdx;++startIdx){if(vnode=vnodes[startIdx]){elm=vnode.$elm$;callNodeRefs(vnode);{checkSlotFallbackVisibility=true;if(elm["s-ol"]){elm["s-ol"].remove()}else{putBackInOriginalLocation(elm,true)}}elm.remove()}}};const updateChildren=(parentElm,oldCh,newVNode,newCh)=>{let oldStartIdx=0;let newStartIdx=0;let idxInOld=0;let i=0;let oldEndIdx=oldCh.length-1;let oldStartVnode=oldCh[0];let oldEndVnode=oldCh[oldEndIdx];let newEndIdx=newCh.length-1;let newStartVnode=newCh[0];let newEndVnode=newCh[newEndIdx];let node;let elmToMove;while(oldStartIdx<=oldEndIdx&&newStartIdx<=newEndIdx){if(oldStartVnode==null){oldStartVnode=oldCh[++oldStartIdx]}else if(oldEndVnode==null){oldEndVnode=oldCh[--oldEndIdx]}else if(newStartVnode==null){newStartVnode=newCh[++newStartIdx]}else if(newEndVnode==null){newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldStartVnode,newStartVnode)){patch(oldStartVnode,newStartVnode);oldStartVnode=oldCh[++oldStartIdx];newStartVnode=newCh[++newStartIdx]}else if(isSameVnode(oldEndVnode,newEndVnode)){patch(oldEndVnode,newEndVnode);oldEndVnode=oldCh[--oldEndIdx];newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldStartVnode,newEndVnode)){if(oldStartVnode.$tag$==="slot"||newEndVnode.$tag$==="slot"){putBackInOriginalLocation(oldStartVnode.$elm$.parentNode,false)}patch(oldStartVnode,newEndVnode);parentElm.insertBefore(oldStartVnode.$elm$,oldEndVnode.$elm$.nextSibling);oldStartVnode=oldCh[++oldStartIdx];newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldEndVnode,newStartVnode)){if(oldStartVnode.$tag$==="slot"||newEndVnode.$tag$==="slot"){putBackInOriginalLocation(oldEndVnode.$elm$.parentNode,false)}patch(oldEndVnode,newStartVnode);parentElm.insertBefore(oldEndVnode.$elm$,oldStartVnode.$elm$);oldEndVnode=oldCh[--oldEndIdx];newStartVnode=newCh[++newStartIdx]}else{idxInOld=-1;{for(i=oldStartIdx;i<=oldEndIdx;++i){if(oldCh[i]&&oldCh[i].$key$!==null&&oldCh[i].$key$===newStartVnode.$key$){idxInOld=i;break}}}if(idxInOld>=0){elmToMove=oldCh[idxInOld];if(elmToMove.$tag$!==newStartVnode.$tag$){node=createElm(oldCh&&oldCh[newStartIdx],newVNode,idxInOld,parentElm)}else{patch(elmToMove,newStartVnode);oldCh[idxInOld]=undefined;node=elmToMove.$elm$}newStartVnode=newCh[++newStartIdx]}else{node=createElm(oldCh&&oldCh[newStartIdx],newVNode,newStartIdx,parentElm);newStartVnode=newCh[++newStartIdx]}if(node){{parentReferenceNode(oldStartVnode.$elm$).insertBefore(node,referenceNode(oldStartVnode.$elm$))}}}}if(oldStartIdx>oldEndIdx){addVnodes(parentElm,newCh[newEndIdx+1]==null?null:newCh[newEndIdx+1].$elm$,newVNode,newCh,newStartIdx,newEndIdx)}else if(newStartIdx>newEndIdx){removeVnodes(oldCh,oldStartIdx,oldEndIdx)}};const isSameVnode=(vnode1,vnode2)=>{if(vnode1.$tag$===vnode2.$tag$){if(vnode1.$tag$==="slot"){return vnode1.$name$===vnode2.$name$}{return vnode1.$key$===vnode2.$key$}}return false};const referenceNode=node=>node&&node["s-ol"]||node;const parentReferenceNode=node=>(node["s-ol"]?node["s-ol"]:node).parentNode;const patch=(oldVNode,newVNode)=>{const elm=newVNode.$elm$=oldVNode.$elm$;const oldChildren=oldVNode.$children$;const newChildren=newVNode.$children$;const tag=newVNode.$tag$;const text=newVNode.$text$;let defaultHolder;if(text===null){{isSvgMode=tag==="svg"?true:tag==="foreignObject"?false:isSvgMode}{if(tag==="slot");else{updateElement(oldVNode,newVNode,isSvgMode)}}if(oldChildren!==null&&newChildren!==null){updateChildren(elm,oldChildren,newVNode,newChildren)}else if(newChildren!==null){if(oldVNode.$text$!==null){elm.textContent=""}addVnodes(elm,null,newVNode,newChildren,0,newChildren.length-1)}else if(oldChildren!==null){removeVnodes(oldChildren,0,oldChildren.length-1)}if(isSvgMode&&tag==="svg"){isSvgMode=false}}else if(defaultHolder=elm["s-cr"]){defaultHolder.parentNode.textContent=text}else if(oldVNode.$text$!==text){elm.data=text}};const updateFallbackSlotVisibility=elm=>{let childNodes=elm.childNodes;let childNode;let i;let ilen;let j;let slotNameAttr;let nodeType;for(i=0,ilen=childNodes.length;i<ilen;i++){childNode=childNodes[i];if(childNode.nodeType===1){if(childNode["s-sr"]){slotNameAttr=childNode["s-sn"];childNode.hidden=false;for(j=0;j<ilen;j++){nodeType=childNodes[j].nodeType;if(childNodes[j]["s-hn"]!==childNode["s-hn"]||slotNameAttr!==""){if(nodeType===1&&slotNameAttr===childNodes[j].getAttribute("slot")){childNode.hidden=true;break}}else{if(nodeType===1||nodeType===3&&childNodes[j].textContent.trim()!==""){childNode.hidden=true;break}}}}updateFallbackSlotVisibility(childNode)}}};const relocateNodes=[];const relocateSlotContent=elm=>{let childNode;let node;let hostContentNodes;let slotNameAttr;let relocateNodeData;let j;let i=0;let childNodes=elm.childNodes;let ilen=childNodes.length;for(;i<ilen;i++){childNode=childNodes[i];if(childNode["s-sr"]&&(node=childNode["s-cr"])&&node.parentNode){hostContentNodes=node.parentNode.childNodes;slotNameAttr=childNode["s-sn"];for(j=hostContentNodes.length-1;j>=0;j--){node=hostContentNodes[j];if(!node["s-cn"]&&!node["s-nr"]&&node["s-hn"]!==childNode["s-hn"]){if(isNodeLocatedInSlot(node,slotNameAttr)){relocateNodeData=relocateNodes.find(r=>r.$nodeToRelocate$===node);checkSlotFallbackVisibility=true;node["s-sn"]=node["s-sn"]||slotNameAttr;if(relocateNodeData){relocateNodeData.$slotRefNode$=childNode}else{relocateNodes.push({$slotRefNode$:childNode,$nodeToRelocate$:node})}if(node["s-sr"]){relocateNodes.map(relocateNode=>{if(isNodeLocatedInSlot(relocateNode.$nodeToRelocate$,node["s-sn"])){relocateNodeData=relocateNodes.find(r=>r.$nodeToRelocate$===node);if(relocateNodeData&&!relocateNode.$slotRefNode$){relocateNode.$slotRefNode$=relocateNodeData.$slotRefNode$}}})}}else if(!relocateNodes.some(r=>r.$nodeToRelocate$===node)){relocateNodes.push({$nodeToRelocate$:node})}}}}if(childNode.nodeType===1){relocateSlotContent(childNode)}}};const isNodeLocatedInSlot=(nodeToRelocate,slotNameAttr)=>{if(nodeToRelocate.nodeType===1){if(nodeToRelocate.getAttribute("slot")===null&&slotNameAttr===""){return true}if(nodeToRelocate.getAttribute("slot")===slotNameAttr){return true}return false}if(nodeToRelocate["s-sn"]===slotNameAttr){return true}return slotNameAttr===""};const callNodeRefs=vNode=>{{vNode.$attrs$&&vNode.$attrs$.ref&&vNode.$attrs$.ref(null);vNode.$children$&&vNode.$children$.map(callNodeRefs)}};const renderVdom=(hostRef,renderFnResults)=>{const hostElm=hostRef.$hostElement$;const cmpMeta=hostRef.$cmpMeta$;const oldVNode=hostRef.$vnode$||newVNode(null,null);const rootVnode=isHost(renderFnResults)?renderFnResults:h(null,null,renderFnResults);hostTagName=hostElm.tagName;if(cmpMeta.$attrsToReflect$){rootVnode.$attrs$=rootVnode.$attrs$||{};cmpMeta.$attrsToReflect$.map(_ref2=>{let[propName,attribute]=_ref2;return rootVnode.$attrs$[attribute]=hostElm[propName]})}rootVnode.$tag$=null;rootVnode.$flags$|=4;hostRef.$vnode$=rootVnode;rootVnode.$elm$=oldVNode.$elm$=hostElm.shadowRoot||hostElm;{scopeId=hostElm["s-sc"]}{contentRef=hostElm["s-cr"];useNativeShadowDom=supportsShadow&&(cmpMeta.$flags$&1)!==0;checkSlotFallbackVisibility=false}patch(oldVNode,rootVnode);{plt.$flags$|=1;if(checkSlotRelocate){relocateSlotContent(rootVnode.$elm$);let relocateData;let nodeToRelocate;let orgLocationNode;let parentNodeRef;let insertBeforeNode;let refNode;let i=0;for(;i<relocateNodes.length;i++){relocateData=relocateNodes[i];nodeToRelocate=relocateData.$nodeToRelocate$;if(!nodeToRelocate["s-ol"]){orgLocationNode=doc.createTextNode("");orgLocationNode["s-nr"]=nodeToRelocate;nodeToRelocate.parentNode.insertBefore(nodeToRelocate["s-ol"]=orgLocationNode,nodeToRelocate)}}for(i=0;i<relocateNodes.length;i++){relocateData=relocateNodes[i];nodeToRelocate=relocateData.$nodeToRelocate$;if(relocateData.$slotRefNode$){parentNodeRef=relocateData.$slotRefNode$.parentNode;insertBeforeNode=relocateData.$slotRefNode$.nextSibling;orgLocationNode=nodeToRelocate["s-ol"];while(orgLocationNode=orgLocationNode.previousSibling){refNode=orgLocationNode["s-nr"];if(refNode&&refNode["s-sn"]===nodeToRelocate["s-sn"]&&parentNodeRef===refNode.parentNode){refNode=refNode.nextSibling;if(!refNode||!refNode["s-nr"]){insertBeforeNode=refNode;break}}}if(!insertBeforeNode&&parentNodeRef!==nodeToRelocate.parentNode||nodeToRelocate.nextSibling!==insertBeforeNode){if(nodeToRelocate!==insertBeforeNode){if(!nodeToRelocate["s-hn"]&&nodeToRelocate["s-ol"]){nodeToRelocate["s-hn"]=nodeToRelocate["s-ol"].parentNode.nodeName}parentNodeRef.insertBefore(nodeToRelocate,insertBeforeNode)}}}else{if(nodeToRelocate.nodeType===1){nodeToRelocate.hidden=true}}}}if(checkSlotFallbackVisibility){updateFallbackSlotVisibility(rootVnode.$elm$)}plt.$flags$&=~1;relocateNodes.length=0}};const getElement=ref=>BUILD.lazyLoad?getHostRef(ref).$hostElement$:ref;const createEvent=(ref,name,flags)=>{const elm=getElement(ref);return{emit:detail=>{if(BUILD.isDev&&!elm.isConnected){consoleDevWarn('The "'.concat(name,'" event was emitted, but the dispatcher node is no longer connected to the dom.'))}return emitEvent(elm,name,{bubbles:!!(flags&4),composed:!!(flags&2),cancelable:!!(flags&1),detail:detail})}}};const emitEvent=(elm,name,opts)=>{const ev=plt.ce(name,opts);elm.dispatchEvent(ev);return ev};const attachToAncestor=(hostRef,ancestorComponent)=>{};const scheduleUpdate=(hostRef,isInitialLoad)=>{{hostRef.$flags$|=16}attachToAncestor(hostRef,hostRef.$ancestorComponent$);const dispatch=()=>dispatchHooks(hostRef,isInitialLoad);return writeTask(dispatch)};const dispatchHooks=(hostRef,isInitialLoad)=>{const elm=hostRef.$hostElement$;const endSchedule=createTime("scheduleUpdate",hostRef.$cmpMeta$.$tagName$);const instance=elm;let promise;if(isInitialLoad){{promise=safeCall(instance,"componentWillLoad")}}else{{promise=safeCall(instance,"componentWillUpdate")}}{promise=then(promise,()=>safeCall(instance,"componentWillRender"))}endSchedule();return then(promise,()=>updateComponent(hostRef,instance,isInitialLoad))};const updateComponent=async(hostRef,instance,isInitialLoad)=>{const elm=hostRef.$hostElement$;const endUpdate=createTime("update",hostRef.$cmpMeta$.$tagName$);elm["s-rc"];if(isInitialLoad){attachStyles(hostRef)}const endRender=createTime("render",hostRef.$cmpMeta$.$tagName$);{callRender(hostRef,instance,elm)}endRender();endUpdate();{postUpdateComponent(hostRef)}};const callRender=(hostRef,instance,elm)=>{const allRenderFn=false;const lazyLoad=false;const taskQueue=true;const updatable=true;try{renderingRef=instance;instance=allRenderFn?instance.render():instance.render&&instance.render();if(updatable&&taskQueue){hostRef.$flags$&=~16}if(updatable||lazyLoad){hostRef.$flags$|=2}if(BUILD.hasRenderFn||BUILD.reflect){if(BUILD.vdomRender||BUILD.reflect){if(BUILD.hydrateServerSide);else{renderVdom(hostRef,instance)}}}}catch(e){consoleError(e,hostRef.$hostElement$)}renderingRef=null;return null};const getRenderingRef=()=>renderingRef;const postUpdateComponent=hostRef=>{const tagName=hostRef.$cmpMeta$.$tagName$;const elm=hostRef.$hostElement$;const endPostUpdate=createTime("postUpdate",tagName);const instance=elm;hostRef.$ancestorComponent$;{safeCall(instance,"componentDidRender")}if(!(hostRef.$flags$&64)){hostRef.$flags$|=64;{safeCall(instance,"componentDidLoad")}endPostUpdate()}else{{safeCall(instance,"componentDidUpdate")}endPostUpdate()}};const safeCall=(instance,method,arg)=>{if(instance&&instance[method]){try{return instance[method](arg)}catch(e){consoleError(e)}}return undefined};const then=(promise,thenFn)=>promise&&promise.then?promise.then(thenFn):thenFn();const parsePropertyValue=(propValue,propType)=>{if(propValue!=null&&!isComplexType(propValue)){if(propType&4){return propValue==="false"?false:propValue===""||!!propValue}if(propType&2){return parseFloat(propValue)}if(propType&1){return String(propValue)}return propValue}return propValue};const getValue=(ref,propName)=>getHostRef(ref).$instanceValues$.get(propName);const setValue=(ref,propName,newVal,cmpMeta)=>{const hostRef=getHostRef(ref);const elm=ref;const oldVal=hostRef.$instanceValues$.get(propName);const flags=hostRef.$flags$;const instance=elm;newVal=parsePropertyValue(newVal,cmpMeta.$members$[propName][0]);if(newVal!==oldVal){hostRef.$instanceValues$.set(propName,newVal);{if(cmpMeta.$watchers$&&flags&128){const watchMethods=cmpMeta.$watchers$[propName];if(watchMethods){watchMethods.map(watchMethodName=>{try{instance[watchMethodName](newVal,oldVal,propName)}catch(e){consoleError(e,elm)}})}}if((flags&(2|16))===2){if(instance.componentShouldUpdate){if(instance.componentShouldUpdate(newVal,oldVal,propName)===false){return}}scheduleUpdate(hostRef,false)}}}};const proxyComponent=(Cstr,cmpMeta,flags)=>{if(cmpMeta.$members$){if(Cstr.watchers){cmpMeta.$watchers$=Cstr.watchers}const members=Object.entries(cmpMeta.$members$);const prototype=Cstr.prototype;members.map(_ref3=>{let[memberName,[memberFlags]]=_ref3;if(memberFlags&31||memberFlags&32){Object.defineProperty(prototype,memberName,{get(){return getValue(this,memberName)},set(newValue){setValue(this,memberName,newValue,cmpMeta)},configurable:true,enumerable:true})}});{const attrNameToPropName=new Map;prototype.attributeChangedCallback=function(attrName,_oldValue,newValue){plt.jmp(()=>{const propName=attrNameToPropName.get(attrName);if(this.hasOwnProperty(propName)){newValue=this[propName];delete this[propName]}else if(prototype.hasOwnProperty(propName)&&typeof this[propName]==="number"&&this[propName]==newValue){return}this[propName]=newValue===null&&typeof this[propName]==="boolean"?false:newValue})};Cstr.observedAttributes=members.filter(_ref4=>{let[_,m]=_ref4;return m[0]&15}).map(_ref5=>{let[propName,m]=_ref5;const attrName=m[1]||propName;attrNameToPropName.set(attrName,propName);if(m[0]&512){cmpMeta.$attrsToReflect$.push([propName,attrName])}return attrName})}}return Cstr};const initializeComponent=async(elm,hostRef,cmpMeta,hmrVersionId,Cstr)=>{if((hostRef.$flags$&32)===0){{Cstr=elm.constructor;hostRef.$flags$|=32;customElements.whenDefined(cmpMeta.$tagName$).then(()=>hostRef.$flags$|=128)}if(Cstr.style){let style=Cstr.style;if(typeof style!=="string"){style=style[hostRef.$modeName$=computeMode(elm)]}const scopeId=getScopeId(cmpMeta,hostRef.$modeName$);if(!styles.has(scopeId)){const endRegisterStyles=createTime("registerStyles",cmpMeta.$tagName$);registerStyle(scopeId,style,!!(cmpMeta.$flags$&1));endRegisterStyles()}}}hostRef.$ancestorComponent$;const schedule=()=>scheduleUpdate(hostRef,true);{schedule()}};const fireConnectedCallback=instance=>{};const connectedCallback=elm=>{if((plt.$flags$&1)===0){const hostRef=getHostRef(elm);const cmpMeta=hostRef.$cmpMeta$;const endConnected=createTime("connectedCallback",cmpMeta.$tagName$);if(!(hostRef.$flags$&1)){hostRef.$flags$|=1;{if(cmpMeta.$flags$&(4|8)){setContentReference(elm)}}if(cmpMeta.$members$){Object.entries(cmpMeta.$members$).map(_ref6=>{let[memberName,[memberFlags]]=_ref6;if(memberFlags&31&&elm.hasOwnProperty(memberName)){const value=elm[memberName];delete elm[memberName];elm[memberName]=value}})}{initializeComponent(elm,hostRef,cmpMeta)}}else{addHostEventListeners(elm,hostRef,cmpMeta.$listeners$);fireConnectedCallback(hostRef.$lazyInstance$)}endConnected()}};const setContentReference=elm=>{const contentRefElm=elm["s-cr"]=doc.createComment("");contentRefElm["s-cn"]=true;elm.insertBefore(contentRefElm,elm.firstChild)};const disconnectedCallback=elm=>{if((plt.$flags$&1)===0){const hostRef=getHostRef(elm);{if(hostRef.$rmListeners$){hostRef.$rmListeners$.map(rmListener=>rmListener());hostRef.$rmListeners$=undefined}}}};const proxyCustomElement=(Cstr,compactMeta)=>{const cmpMeta={$flags$:compactMeta[0],$tagName$:compactMeta[1]};if(BUILD.member){cmpMeta.$members$=compactMeta[2]}if(BUILD.hostListener){cmpMeta.$listeners$=compactMeta[3]}if(BUILD.watchCallback){cmpMeta.$watchers$=Cstr.$watchers$}if(BUILD.reflect){cmpMeta.$attrsToReflect$=[]}if(BUILD.shadowDom&&!supportsShadow&&cmpMeta.$flags$&1){cmpMeta.$flags$|=8}const originalConnectedCallback=Cstr.prototype.connectedCallback;const originalDisconnectedCallback=Cstr.prototype.disconnectedCallback;Object.assign(Cstr.prototype,{__registerHost(){registerHost(this,cmpMeta)},connectedCallback(){connectedCallback(this);if(BUILD.connectedCallback&&originalConnectedCallback){originalConnectedCallback.call(this)}},disconnectedCallback(){disconnectedCallback(this);if(BUILD.disconnectedCallback&&originalDisconnectedCallback){originalDisconnectedCallback.call(this)}},__attachShadow(){if(supportsShadow){if(BUILD.shadowDelegatesFocus){this.attachShadow({mode:"open",delegatesFocus:!!(cmpMeta.$flags$&16)})}else{this.attachShadow({mode:"open"})}}else{this.shadowRoot=this}}});Cstr.is=cmpMeta.$tagName$;return proxyComponent(Cstr,cmpMeta)};const setAssetPath=path=>plt.$resourcesUrl$=path;const setPlatformOptions=opts=>Object.assign(plt,opts);const hostRefs=new WeakMap;const getHostRef=ref=>hostRefs.get(ref);const registerHost=(elm,cmpMeta)=>{const hostRef={$flags$:0,$hostElement$:elm,$cmpMeta$:cmpMeta,$instanceValues$:new Map};if(BUILD.isDev){hostRef.$renderCount$=0}if(BUILD.method&&BUILD.lazyLoad){hostRef.$onInstancePromise$=new Promise(r=>hostRef.$onInstanceResolve$=r)}if(BUILD.asyncLoading){hostRef.$onReadyPromise$=new Promise(r=>hostRef.$onReadyResolve$=r);elm["s-p"]=[];elm["s-rc"]=[]}addHostEventListeners(elm,hostRef,cmpMeta.$listeners$);return hostRefs.set(elm,hostRef)};const isMemberInElement=(elm,memberName)=>memberName in elm;const consoleError=(e,el)=>(0,console.error)(e,el);const STENCIL_DEV_MODE=BUILD.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"];const consoleDevError=function(){for(var _len2=arguments.length,m=new Array(_len2),_key2=0;_key2<_len2;_key2++){m[_key2]=arguments[_key2]}return console.error(...STENCIL_DEV_MODE,...m)};const consoleDevWarn=function(){for(var _len3=arguments.length,m=new Array(_len3),_key3=0;_key3<_len3;_key3++){m[_key3]=arguments[_key3]}return console.warn(...STENCIL_DEV_MODE,...m)};const styles=new Map;const modeResolutionChain=[];const queueDomReads=[];const queueDomWrites=[];const queueTask=(queue,write)=>cb=>{queue.push(cb);if(!queuePending){queuePending=true;if(write&&plt.$flags$&4){nextTick(flush)}else{plt.raf(flush)}}};const consume=queue=>{for(let i=0;i<queue.length;i++){try{queue[i](performance.now())}catch(e){consoleError(e)}}queue.length=0};const flush=()=>{consume(queueDomReads);{consume(queueDomWrites);if(queuePending=queueDomReads.length>0){plt.raf(flush)}}};const nextTick=cb=>promiseResolve().then(cb);const writeTask=queueTask(queueDomWrites,true);({isDev:BUILD.isDev?true:false,isBrowser:true,isServer:false,isTesting:BUILD.isTesting?true:false});var commonjsGlobal=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule(fn,basedir,module){return module={path:basedir,exports:{},require:function(path,base){return commonjsRequire()}},fn(module,module.exports),module.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}createCommonjsModule((function(module,exports){(function(global,factory){factory()})(commonjsGlobal,(function(){function applyFocusVisiblePolyfill(scope){var hadKeyboardEvent=true;var hadFocusVisibleRecently=false;var hadFocusVisibleRecentlyTimeout=null;var inputTypesAllowlist={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function isValidFocusTarget(el){if(el&&el!==document&&el.nodeName!=="HTML"&&el.nodeName!=="BODY"&&"classList"in el&&"contains"in el.classList){return true}return false}function focusTriggersKeyboardModality(el){var type=el.type;var tagName=el.tagName;if(tagName==="INPUT"&&inputTypesAllowlist[type]&&!el.readOnly){return true}if(tagName==="TEXTAREA"&&!el.readOnly){return true}if(el.isContentEditable){return true}return false}function addFocusVisibleClass(el){if(el.classList.contains("focus-visible")){return}el.classList.add("focus-visible");el.setAttribute("data-focus-visible-added","")}function removeFocusVisibleClass(el){if(!el.hasAttribute("data-focus-visible-added")){return}el.classList.remove("focus-visible");el.removeAttribute("data-focus-visible-added")}function onKeyDown(e){if(e.metaKey||e.altKey||e.ctrlKey){return}if(isValidFocusTarget(scope.activeElement)){addFocusVisibleClass(scope.activeElement)}hadKeyboardEvent=true}function onPointerDown(e){hadKeyboardEvent=false}function onFocus(e){if(!isValidFocusTarget(e.target)){return}if(hadKeyboardEvent||focusTriggersKeyboardModality(e.target)){addFocusVisibleClass(e.target)}}function onBlur(e){if(!isValidFocusTarget(e.target)){return}if(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added")){hadFocusVisibleRecently=true;window.clearTimeout(hadFocusVisibleRecentlyTimeout);hadFocusVisibleRecentlyTimeout=window.setTimeout((function(){hadFocusVisibleRecently=false}),100);removeFocusVisibleClass(e.target)}}function onVisibilityChange(e){if(document.visibilityState==="hidden"){if(hadFocusVisibleRecently){hadKeyboardEvent=true}addInitialPointerMoveListeners()}}function addInitialPointerMoveListeners(){document.addEventListener("mousemove",onInitialPointerMove);document.addEventListener("mousedown",onInitialPointerMove);document.addEventListener("mouseup",onInitialPointerMove);document.addEventListener("pointermove",onInitialPointerMove);document.addEventListener("pointerdown",onInitialPointerMove);document.addEventListener("pointerup",onInitialPointerMove);document.addEventListener("touchmove",onInitialPointerMove);document.addEventListener("touchstart",onInitialPointerMove);document.addEventListener("touchend",onInitialPointerMove)}function removeInitialPointerMoveListeners(){document.removeEventListener("mousemove",onInitialPointerMove);document.removeEventListener("mousedown",onInitialPointerMove);document.removeEventListener("mouseup",onInitialPointerMove);document.removeEventListener("pointermove",onInitialPointerMove);document.removeEventListener("pointerdown",onInitialPointerMove);document.removeEventListener("pointerup",onInitialPointerMove);document.removeEventListener("touchmove",onInitialPointerMove);document.removeEventListener("touchstart",onInitialPointerMove);document.removeEventListener("touchend",onInitialPointerMove)}function onInitialPointerMove(e){if(e.target.nodeName&&e.target.nodeName.toLowerCase()==="html"){return}hadKeyboardEvent=false;removeInitialPointerMoveListeners()}document.addEventListener("keydown",onKeyDown,true);document.addEventListener("mousedown",onPointerDown,true);document.addEventListener("pointerdown",onPointerDown,true);document.addEventListener("touchstart",onPointerDown,true);document.addEventListener("visibilitychange",onVisibilityChange,true);addInitialPointerMoveListeners();scope.addEventListener("focus",onFocus,true);scope.addEventListener("blur",onBlur,true);if(scope.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&scope.host){scope.host.setAttribute("data-js-focus-visible","")}else if(scope.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=applyFocusVisiblePolyfill;var event;try{event=new CustomEvent("focus-visible-polyfill-ready")}catch(error){event=document.createEvent("CustomEvent");event.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(event)}if(typeof document!=="undefined"){applyFocusVisiblePolyfill(document)}}))}));var Action;(function(Action){Action["PLAY"]="play";Action["PAUSE"]="pause";Action["STOP"]="stop";Action["ENTER_FULLSCREEN"]="enterfullscreen";Action["EXIT_FULLSCREEN"]="exitfullscreen";Action["MUTE"]="mute";Action["UNMUTE"]="unmute";Action["TEXT_ON"]="texton";Action["TEXT_OFF"]="textoff";Action["GO_TO_LIVE"]="gotolive";Action["NONE"]="none";Action["SEEK"]="seek";Action["SEEK_FORWARD"]="seekforward";Action["SEEK_BACK"]="seekback";Action["VOLUME"]="volume";Action["PREVIEW"]="preview";Action["SETTINGS_ON"]="settingson";Action["SETTINGS_OFF"]="settingsoff";Action["LANGUAGE_SELECT"]="languageselect";Action["QUALITY_SELECT"]="qualityselect";Action["POSTER_PLAY"]="posterplay"})(Action||(Action={}));var ActiveMode;(function(ActiveMode){ActiveMode["AUTO"]="auto";ActiveMode["MANUAL"]="manual"})(ActiveMode||(ActiveMode={}));var ControlFunction;(function(ControlFunction){ControlFunction["MUTE"]="mute";ControlFunction["PLAY"]="play";ControlFunction["FULLSCREEN"]="fullscreen";ControlFunction["TEXT"]="text";ControlFunction["PLAY_OVERLAY"]="playOverlay";ControlFunction["SETTINGS"]="settings";ControlFunction["VOLUME"]="volume"})(ControlFunction||(ControlFunction={}));var ControlMode;(function(ControlMode){ControlMode["NONE"]="none";ControlMode["AD"]="ad";ControlMode["CONTENT"]="content";ControlMode["COMPACT"]="compact"})(ControlMode||(ControlMode={}));var CssNames;(function(CssNames){CssNames["HIDDEN"]="avia-ui-hidden";CssNames["ACC_VOL_ON"]="avia-volume-on";CssNames["ACC_VOL_OFF"]="avia-volume-off";CssNames["SEGMENT_MARKER"]="avia-segment-marker";CssNames["INDICATOR_ACTIVE"]="avia-indicator-active";CssNames["ACC_VOL"]="avia-acc-vol";CssNames["ACC_VOL_METER"]="avia-acc-vol-meter";CssNames["ACC_VOL_OVERLAY"]="avia-vol-meter-overlay";CssNames["ACC_FWD"]="avia-acc-fwd";CssNames["ACC_BACK"]="avia-acc-back";CssNames["ACC_ARROW"]="avia-acc-arrow";CssNames["UNMUTE_CTA"]="avia-unmute-cta";CssNames["CONTROLS_VISIBLE"]="avia-controls-vis";CssNames["SPINNER_ACTIVE"]="avia-spinner";CssNames["SPINNER_IDLE"]="avia-spinner-idle";CssNames["SETTINGS_NUDGE_LEFT"]="avia-settings-nudge-left"})(CssNames||(CssNames={}));var LocalizationId;(function(LocalizationId){LocalizationId["PLAY"]="play";LocalizationId["PAUSE"]="pause";LocalizationId["STOP"]="stop";LocalizationId["MUTE"]="mute";LocalizationId["UNMUTE"]="unmute";LocalizationId["VOLUME"]="volume";LocalizationId["CLICK_TO_UNMUTE"]="click-to-unmute";LocalizationId["TAP_TO_UNMUTE"]="tap-to-unmute";LocalizationId["LIVE"]="live";LocalizationId["GO_LIVE"]="go-live";LocalizationId["SEEK"]="seek";LocalizationId["SEEK_BACK"]="seek-back";LocalizationId["SEEK_FORWARD"]="seek-forward";LocalizationId["CLOSED_CAPTIONS_OFF"]="closed-captions-off";LocalizationId["CLOSED_CAPTIONS_ON"]="closed-captions-on";LocalizationId["FULL_SCREEN_ENTER"]="full-screen-enter";LocalizationId["FULL_SCREEN_EXIT"]="full-screen-exit";LocalizationId["HOURS"]="hours";LocalizationId["MINUTES"]="minutes";LocalizationId["SECONDS"]="seconds";LocalizationId["VALUE_OF_TOTAL"]="value-of-total";LocalizationId["UNMUTE_CTA"]="unmute-cta";LocalizationId["SETTINGS"]="settings";LocalizationId["LANGUAGE"]="language";LocalizationId["QUALITY"]="quality";LocalizationId["BACK"]="back";LocalizationId["CAPTIONS"]="captions";LocalizationId["AUDIO"]="audio";LocalizationId["CLOSE"]="close";LocalizationId["AUTO"]="auto";LocalizationId["UNKNOWN"]="unknown"})(LocalizationId||(LocalizationId={}));function debounce(func,delay){let timeout;return function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}clearTimeout(timeout);timeout=setTimeout(()=>func(...args),delay)}}function isEmpty(val){return val==null||val===undefined||val===""}function isUndefined(value){return typeof value==="undefined"}function csvToArray(str){if(isEmpty(str)){return[]}return str.split(",").map(v=>v.trim())}function toTimeObject(){let value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(value==null||isNaN(value)){value=0}const hms=secToHms(value,3600).split(":");return{hours:parseInt(hms[0]),minutes:parseInt(hms[1]),seconds:parseInt(hms[2])}}function createLocalizedTimeString(time,localeData){const t=toTimeObject(time);const hasHours=t.hours>0;let ret="";if(hasHours){ret+="".concat(t.hours," ").concat(localeData[LocalizationId.HOURS]," ")}if(t.minutes>0||hasHours){ret+="".concat(t.minutes," ").concat(localeData[LocalizationId.MINUTES]," ")}ret+="".concat(t.seconds," ").concat(localeData[LocalizationId.SECONDS]);return ret}function getEventPos(event){if(!(event===null||event===void 0?void 0:event.pageX)&&(!event.targetTouches||event.targetTouches.length===0)){return{x:null,y:null}}return{x:event.pageX-(window.scrollX||window.pageXOffset)||event.targetTouches[0].pageX-window.scrollX,y:event.pageY-(window.scrollY||window.pageYOffset)||event.targetTouches[0].pageY-window.scrollY}}function valueOfTotal(time,duration,localeData){const value=createLocalizedTimeString(time,localeData);const total=createLocalizedTimeString(duration,localeData);return localize(localeData[LocalizationId.VALUE_OF_TOTAL],{value:value,total:total})}function toCssPercent(value){return"".concat(roundTo(value*100,2),"%")}function secToHms(seconds){let max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:61;if(seconds==null||isNaN(seconds)){return"00:00"}seconds=seconds|0;let time=zeroFill(seconds%60);seconds=seconds/60|0;time=zeroFill(seconds%60)+":"+time;seconds=seconds/60|0;if(seconds>0){time=zeroFill(seconds)+":"+time}if(max>=3600&&time.length===5){time="00:"+time}return time}function localize(message,context){return template(message,context)}function template(input,context){let open=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"{{";let close=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"}}";if(!input){return input}const regex=new RegExp("".concat(open,"((?:(?!(").concat(open,"|").concat(close,")).)+)").concat(close),"g");return input.replace(regex,(match,token)=>!isUndefined(context[token])?context[token]:match)}function zeroFill(time){return time<10?"0"+time:time.toString()}function mapToRange(value,fromMin,fromMax){let toMin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;let toMax=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;return(value-fromMin)*(toMax-toMin)/(fromMax-fromMin)+toMin}function roundTo(num,len){return Math.round(num*Math.pow(10,len))/Math.pow(10,len)}function clampValue(value,min,max){return Math.max(min,Math.min(max,value))}function blockEvent(event){event.stopPropagation();event.preventDefault()}function createElementsFromString(html){try{const template=document.createElement("template");template.innerHTML=html;return Array.from(template.content.children)}catch(error){throw new Error("Could not create element from string: ".concat(html))}}function applyCssVars(varMap){const{style:style}=document.documentElement;Object.keys(varMap).forEach(key=>style.setProperty(key,varMap[key]))}const PreviewTimeTransform={DEFAULT:playerTime=>secToHms(playerTime.contentTime),UTC_TIME:playerTime=>new Date(playerTime.liveStreamUtcTime).toTimeString().split(" ")[0]};var UiEvents;(function(UiEvents){UiEvents["ACTION"]="uiaction"})(UiEvents||(UiEvents={}));class AviaPluginBase{constructor(id){this.debug=false;this.logFmt="color: #fcf; font-style: italic;";this.id=id;this.player=null;this.services=null;this.options=null;this.handlePlayerEvent=this.handlePlayerEvent.bind(this)}getId(){return this.id}destroy(){this.listenToPlayer(false,this.getEventInterests());this.player=null;this.options=null;this.services=null;this.avia=null}handlePlayerEvent(event){}getEventInterests(){return[]}sendEvent(data){this.services.event.dispatchPluginEvent(data)}listenToPlayer(flag,events){const action=flag!==false?"on":"off";events.forEach(event=>this.player[action](event,this.handlePlayerEvent))}log(msg){this.debug&&(console===null||console===void 0?void 0:console.log("%c<Plugin: ".concat(this.id,"> ").concat(msg),this.logFmt))}async onRegister(player,options,services){this.player=player;this.services=services;this.options=options;this.avia=services.avia;this.debug=options.debug===true;await this.initialize();this.listenToPlayer(true,this.getEventInterests());this.log("Registered ".concat(this.id))}async initialize(){}}const LocalizationData={en:{[LocalizationId.PLAY]:"Play",[LocalizationId.PAUSE]:"Pause",[LocalizationId.STOP]:"Stop",[LocalizationId.MUTE]:"Mute",[LocalizationId.UNMUTE]:"Unmute",[LocalizationId.VOLUME]:"Volume",[LocalizationId.CLICK_TO_UNMUTE]:"Click to unmute",[LocalizationId.TAP_TO_UNMUTE]:"Tap to unmute",[LocalizationId.SEEK]:"Seek",[LocalizationId.SEEK_BACK]:"Seek Backward",[LocalizationId.SEEK_FORWARD]:"Seek Forward",[LocalizationId.LIVE]:"Live",[LocalizationId.GO_LIVE]:"Go Live",[LocalizationId.CLOSED_CAPTIONS_OFF]:"Closed Captions Off",[LocalizationId.CLOSED_CAPTIONS_ON]:"Closed Captions On",[LocalizationId.FULL_SCREEN_ENTER]:"Enter Fullscreen",[LocalizationId.FULL_SCREEN_EXIT]:"Exit Fullscreen",[LocalizationId.HOURS]:"Hours",[LocalizationId.MINUTES]:"Minutes",[LocalizationId.SECONDS]:"Seconds",[LocalizationId.VALUE_OF_TOTAL]:"{{value}} of {{total}}",[LocalizationId.SETTINGS]:"Settings",[LocalizationId.LANGUAGE]:"Language",[LocalizationId.QUALITY]:"Quality",[LocalizationId.BACK]:"Back",[LocalizationId.CAPTIONS]:"Captions",[LocalizationId.AUDIO]:"Audio",[LocalizationId.CLOSE]:"Close",[LocalizationId.AUTO]:"Auto",[LocalizationId.UNKNOWN]:"Unknown"},es:{[LocalizationId.PLAY]:"Reproducir",[LocalizationId.PAUSE]:"Pausa",[LocalizationId.STOP]:"Stop",[LocalizationId.MUTE]:"Silencio",[LocalizationId.UNMUTE]:"Dejar de silenciar",[LocalizationId.VOLUME]:"Volumen",[LocalizationId.CLICK_TO_UNMUTE]:"Haz clic para dejar de silenciar",[LocalizationId.TAP_TO_UNMUTE]:"Toca para dejar de silenciar",[LocalizationId.SEEK]:"Buscar",[LocalizationId.SEEK_BACK]:"Buscar hacia atrás",[LocalizationId.SEEK_FORWARD]:"Buscar adelante",[LocalizationId.LIVE]:"En Vivo",[LocalizationId.GO_LIVE]:"Ir a Vivir",[LocalizationId.CLOSED_CAPTIONS_OFF]:"Subtítulos cerrados",[LocalizationId.CLOSED_CAPTIONS_ON]:"Subtítulos cerrados en",[LocalizationId.FULL_SCREEN_ENTER]:"Ir a pantalla completa",[LocalizationId.FULL_SCREEN_EXIT]:"Salir de pantalla completa",[LocalizationId.HOURS]:"Horas",[LocalizationId.MINUTES]:"Minutos",[LocalizationId.SECONDS]:"Segundos",[LocalizationId.VALUE_OF_TOTAL]:"{{value}} de {{total}}",[LocalizationId.SETTINGS]:"Configuraciones",[LocalizationId.LANGUAGE]:"Lengua",[LocalizationId.QUALITY]:"Calidad",[LocalizationId.BACK]:"Volver",[LocalizationId.CAPTIONS]:"Subtítulos",[LocalizationId.AUDIO]:"Audio",[LocalizationId.CLOSE]:"Cerrar",[LocalizationId.AUTO]:"Auto",[LocalizationId.UNKNOWN]:"Desconocida"}};const UI="ui";function ui(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{id:UI,factory:createUiPlugin,options:options}}async function createUiPlugin(services,options){if(typeof customElements!=="object"){services.logger.warn("Polyfill warning: customElements is not defined")}if(typeof Node.prototype.getRootNode!=="function"){services.logger.warn("Polyfill warning: Node.prototype.getRootNode is not defined")}const plugin=new AviaUiPlugin;await plugin.onRegister(services.player,options,services);return plugin}class AviaUiPlugin extends AviaPluginBase{constructor(){super(UI);this.defaultSeekInc=10;this.accIndicatorDisplayTime=1500;this.playbackStarted=false;this.settingsEngaged=false;this.firstProgressReceived=false;this.defaultCompactViewBreakpoint=520;this.rootElement="avia-ui";this.previewTimeTransform=PreviewTimeTransform.DEFAULT;this.pendingActive=false;this.aviaUi=null;this.hUiAction=this.hUiAction.bind(this);this.accVolUpdater=debounce(state=>{this.setAccIndicatorState(state)},this.accIndicatorDisplayTime);this.accSeekUpdater=debounce(state=>{this.setAccIndicatorState(state)},this.accIndicatorDisplayTime)}get activeMode(){return this.aviaUi.activeMode||ActiveMode.AUTO}set activeMode(value){this.aviaUi.activeMode=value}get active(){return this.aviaUi.active}set active(value){this.setActivityState(value)}destroy(){var _a;super.destroy();(_a=this.aviaUi)===null||_a===void 0?void 0:_a.removeEventListener(UiEvents.ACTION,this.hUiAction);this.aviaUi=null}hUiAction(e){const action=e.detail.action;if(action!==Action.POSTER_PLAY){this.services.event.dispatchPluginEvent({id:this.id,type:action,detail:e.detail.value||null})}switch(action){case Action.POSTER_PLAY:case Action.PLAY:case Action.PAUSE:case Action.STOP:if(!this.playbackStarted){this.cancelPoster(action===Action.POSTER_PLAY);if(action!==Action.STOP){this.player.play().catch(()=>{})}}else{this.player[action]()}break;case Action.ENTER_FULLSCREEN:this.player.enterFullscreen();break;case Action.EXIT_FULLSCREEN:this.player.exitFullscreen();break;case Action.MUTE:this.player.muted=true;this.aviaUi.muted=true;break;case Action.UNMUTE:this.unmute();break;case Action.TEXT_ON:case Action.TEXT_OFF:const isOn=action===Action.TEXT_ON;this.player.textTrackEnabled=isOn;this.aviaUi.textTrackEnabled=isOn;break;case Action.SEEK:this.playerSeek(e.detail.value);break;case Action.SEEK_FORWARD:this.incrementalSeek(1);break;case Action.SEEK_BACK:this.incrementalSeek(-1);break;case Action.VOLUME:this.player.volume=e.detail.value;break;case Action.PREVIEW:const{time:time,percent:percent}=e.detail.value;const{contentDuration:contentDuration,streamDuration:streamDuration,liveStreamUtcDuration:liveStreamUtcDuration,liveStreamUtcStart:liveStreamUtcStart}=this.player;const streamTime=percent*streamDuration;Promise.resolve(this.previewTimeTransform({contentTime:time,streamTime:streamTime,liveStreamUtcTime:Math.round(streamTime*1e3+liveStreamUtcStart),contentDuration:contentDuration,streamDuration:streamDuration,liveStreamUtcDuration:liveStreamUtcDuration})).then(value=>{var _a,_b;this.aviaUi.preview={value:value,data:(_b=(_a=this.player)===null||_a===void 0?void 0:_a.getThumbnail(time))===null||_b===void 0?void 0:_b.data}});break;case Action.SETTINGS_ON:case Action.SETTINGS_OFF:this.setStateForSettings(action===Action.SETTINGS_ON);break;case Action.LANGUAGE_SELECT:this.selectLanguage(e.detail.value);break;case Action.QUALITY_SELECT:this.selectQuality(e.detail.value);break;case Action.GO_TO_LIVE:this.player.goLive();break}}handlePlayerEvent(event){const{PlayerEvent:PlayerEvent,StreamType:StreamType}=this.avia;const isLive=this.player.streamType===StreamType.LIVE;const isDvr=this.player.streamType===StreamType.DVR;const{type:type,detail:detail}=event;switch(type){case PlayerEvent.READY:this.setPlayState();this.setPosterState();break;case PlayerEvent.AUTOPLAY_BLOCKED:this.setPosterState(true);break;case PlayerEvent.RESOURCE_START:this.setPosterState(this.aviaUi.posterActive);this.setSegmentBreakPositions([]);break;case PlayerEvent.AD_CUEPOINTS_AVAILABLE:this.setSegmentBreakPositions(detail.cuepoints);break;case PlayerEvent.AD_SEGMENT_START:if(this.options.showAdControlsOnAdSegmentStart!==false){this.setStateForAdBreakStart()}break;case PlayerEvent.AD_START:this.setControlMode(ControlMode.AD);this.enableControls([ControlFunction.PLAY],true);this.aviaUi.playing=true;break;case PlayerEvent.AD_BREAK_START:this.setStateForAdBreakStart();break;case PlayerEvent.AD_PROGRESS:this.setAdPosition(detail.currentTime,detail.duration);break;case PlayerEvent.AD_SEGMENT_END:case PlayerEvent.AD_BREAK_COMPLETE:this.setControlMode(ControlMode.NONE);break;case PlayerEvent.CONTENT_START:case PlayerEvent.CONTENT_SEGMENT_START:this.setStateForContentStart(isLive,isDvr);break;case PlayerEvent.CONTENT_SEGMENT_END:this.firstProgressReceived=false;this.setControlMode(ControlMode.NONE);break;case PlayerEvent.CONTENT_PLAYING:this.setControlMode(ControlMode.CONTENT);this.setPlayState();break;case PlayerEvent.AD_PAUSED:case PlayerEvent.CONTENT_PAUSED:this.aviaUi.playing=false;break;case PlayerEvent.AD_PLAYING:this.aviaUi.playing=true;break;case PlayerEvent.STREAM_TYPE_CHANGE:this.setLiveState(isLive,isDvr);break;case PlayerEvent.CONTENT_PROGRESS:if(!this.firstProgressReceived){this.firstProgressReceived=true;this.setPlayState();this.setLiveState(isLive,isDvr)}if(!isLive){this.setTimeAndPosition()}if(isLive||isDvr){this.setLiveState(isLive,isDvr)}break;case PlayerEvent.FULLSCREEN_CHANGE:this.aviaUi.fullscreen=detail.fullscreen;break;case PlayerEvent.TEXT_TRACK_AVAILABLE:this.enableControls(ControlFunction.TEXT,true);this.enableSettingsButton();break;case PlayerEvent.TEXT_TRACK_ENABLED_CHANGE:this.aviaUi.textTrackEnabled=detail.textTrackEnabled;break;case PlayerEvent.LANGUAGE_CHANGE:this.setLocalizationData(detail.language||"en");break;case PlayerEvent.MUTE_CHANGE:this.aviaUi.muted=detail.muted;if(!this.player.muted){this.aviaUi.unmuteCtaVisible=false}break;case PlayerEvent.VOLUME_CHANGE:const{volume:volume}=detail;const muted=this.player.muted;if(this.aviaUi.volume===volume){break}if(!this.aviaUi.muted){this.aviaUi.muted=Math.ceil(volume)?false:true}else if(this.aviaUi.muted&&volume>0){this.unmute()}this.aviaUi.volume=volume;if(!muted){this.aviaUi.unmuteCtaVisible=false}break;case PlayerEvent.HOTKEY_ACTION:this.playbackStarted&&this.setAccIndicator(detail.action,detail);break;case PlayerEvent.ACTIVE_STATE_CHANGE:this.setActiveState(detail.activeState);break;case PlayerEvent.PRESENTATION_SIZE_CHANGE:this.respondToSizeChange();break;case PlayerEvent.AUDIO_TRACK_CHANGE:case PlayerEvent.QUALITY_CHANGE:this.setStateForSettings();break;case PlayerEvent.QUALITY_INFO_CHANGE:case PlayerEvent.AUDIO_TRACK_INFO_CHANGE:case PlayerEvent.TEXT_TRACK_CHANGE:this.enableSettingsButton();this.setStateForSettings();break;case PlayerEvent.RESOURCE_END:this.setIdleState();break;case PlayerEvent.PLAYBACK_STATE_CHANGE:this.setPlayState();break}}incrementalSeek(dir){const inc=this.options.seekIncrement||this.defaultSeekInc;const increment=dir*inc;this.playerSeek(this.player.contentTime+increment);this.player.recordMetric(this.avia.MetricType.UI,this.avia.UiMetric.SEEK_BY,increment)}playerSeek(pos){this.player.seek(pos).then(()=>{})}unmute(){this.player.muted=false;this.aviaUi.muted=false}setControlMode(mode){if(mode===ControlMode.CONTENT){const m=this.getContentControlMode();this.aviaUi.controlMode=m}else{this.aviaUi.controlMode=mode}}setActiveState(state){if(this.activeMode===ActiveMode.AUTO){this.active=state===this.avia.ActiveState.ACTIVE}}setActivityState(active){var _a,_b;if(!this.playbackStarted){this.pendingActive=true;return}this.aviaUi.active=this.activeMode===ActiveMode.MANUAL?active:((_b=(_a=this.aviaUi)===null||_a===void 0?void 0:_a.settings)===null||_b===void 0?void 0:_b.active)?true:active;if(this.options.offsetTimedTextOnControlsVisible&&this.aviaUi.controlMode===ControlMode.CONTENT){this.player.offsetTimedText(active?this.controlBarHeight+4:0)}}setAccIndicator(action,data){const newState={};const{AccessibilityAction:AccessibilityAction}=this.avia;switch(action){case AccessibilityAction.INCREASE_VOLUME:case AccessibilityAction.DECREASE_VOLUME:case AccessibilityAction.TOGGLE_MUTE:newState.volumeKey=true;this.accVolUpdater({volumeKey:false});if(!this.player.muted)this.aviaUi.unmuteCtaVisible=false;break;case AccessibilityAction.SEEK_FORWARD:case AccessibilityAction.SEEK_BACK:newState.seekForward=action===AccessibilityAction.SEEK_FORWARD;newState.seekBack=action===AccessibilityAction.SEEK_BACK;newState.seekTime=(data===null||data===void 0?void 0:data.position)||0;this.accSeekUpdater({seekForward:false,seekBack:false,seekTime:null});break}this.setAccIndicatorState(newState)}setAccIndicatorState(state){this.aviaUi.accIndicatorState=Object.assign(Object.assign({},this.aviaUi.accIndicatorState),state)}setStateForContentStart(isLive,isDvr){this.cancelPoster(false);this.setControlMode(ControlMode.CONTENT);this.setLiveState(isLive,isDvr);const enabled=[ControlFunction.MUTE,ControlFunction.PLAY];if(this.options.disableFullscreen!==true){enabled.push(ControlFunction.FULLSCREEN)}this.enableControls(enabled,true);this.aviaUi.muted=this.player.muted;this.setSeekDisabled(false);this.setStateForPlaybackStart();this.aviaUi.volume=this.player.volume;this.enableSettingsButton()}setStateForAdBreakStart(){const enabled=[ControlFunction.MUTE,ControlFunction.PLAY];if(!this.services.playerOptions.useNativeFullscreen||this.services.system.hasFullscreenApi&&this.options.disableFullscreen!==true){enabled.push(ControlFunction.FULLSCREEN)}else{this.enableControls([ControlFunction.FULLSCREEN],false)}this.cancelPoster(false);this.setControlMode(ControlMode.AD);this.enableControls(enabled,true);this.aviaUi.playing=true;this.aviaUi.muted=this.player.muted;this.setStateForPlaybackStart()}setStateForPlaybackStart(){if(this.options.useUnmuteCta&&!this.playbackStarted&&this.player.muted){this.aviaUi.unmuteCtaVisible=true}this.playbackStarted=true;this.setPlayState();if(this.pendingActive){this.pendingActive=false;this.setActiveState(this.avia.ActiveState.ACTIVE)}}setPosterState(){let active=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.services.playerOptions.autoplay===this.avia.Autoplay.NONE;var _a;this.aviaUi.posterImageUrl=((_a=this.player.resource)===null||_a===void 0?void 0:_a.location.posterImageUrl)||this.options.posterImageUrl;this.aviaUi.posterActive=active}cancelPoster(posterClicked){this.aviaUi.posterActive=false;if(posterClicked){this.services.event.dispatchPluginEvent({id:this.id,type:Action.POSTER_PLAY})}}setIdleState(){this.setControlMode(ControlMode.NONE);this.aviaUi.unmuteCtaVisible=false;const enabled=[ControlFunction.MUTE,ControlFunction.PLAY,ControlFunction.TEXT];if(this.options.disableFullscreen!==true){enabled.push(ControlFunction.FULLSCREEN)}this.enableControls(enabled,false);this.aviaUi.active=false;this.playbackStarted=false}setLiveState(isLive,isDvr){const isPlayingLive=this.player.isPlayingLive;this.aviaUi.isLiveLinear=isLive;this.aviaUi.isDvr=isDvr;this.aviaUi.live=isLive||isDvr&&isPlayingLive;this.aviaUi.pausable=this.player.pausable;if(isDvr){this.aviaUi.seekForwardDisabled=isPlayingLive}}setPlayState(){const{playbackState:playbackState}=this.player;const isPlaying=playbackState===this.avia.PlaybackState.PLAYING;const isWaiting=playbackState===this.avia.PlaybackState.WAITING;this.aviaUi.playing=isWaiting||isPlaying?true:false;this.aviaUi.playDisabled=!isPlaying&&playbackState!==this.avia.PlaybackState.PAUSED;this.aviaUi.waiting=isWaiting}respondToSizeChange(){const m=this.aviaUi.controlMode;if(m===ControlMode.CONTENT||m===ControlMode.COMPACT){this.aviaUi.controlMode=this.getContentControlMode()}}getContentControlMode(){const{width:width}=this.player.dimensions;const brk=this.options.compactViewBreakpoint||this.defaultCompactViewBreakpoint;return width>brk?ControlMode.CONTENT:ControlMode.COMPACT}enableSettingsButton(){var _a,_b,_c,_d;const p=this.player;const t=(_a=p.textTrackInfo)===null||_a===void 0?void 0:_a.track;const a=(_b=p.audioTrackInfo)===null||_b===void 0?void 0:_b.track;const q=((_d=(_c=p.qualityInfo)===null||_c===void 0?void 0:_c.qualities)===null||_d===void 0?void 0:_d.length)>1;this.aviaUi.settingsDisabled=!(t||a||q)}setStateForSettings(){let active=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.settingsEngaged;const p=this.player;if(this.services.system.browser===this.avia.Browser.FIREFOX&&active){this.aviaUi.classList.add(CssNames.SETTINGS_NUDGE_LEFT)}this.aviaUi.settings={active:active,textTrackInfo:p.textTrackInfo,audioTrackInfo:p.audioTrackInfo,qualityInfo:p.qualityInfo};this.settingsEngaged=active;this.pauseOnSettings(active)}pauseOnSettings(active){if(this.options.pauseOnSettings){const playing=this.player.playbackState===this.avia.PlaybackState.PLAYING;if(active&&playing){this.player.pause();this.playPendingAfterSettings=true}if(!active&&this.playPendingAfterSettings){this.playPendingAfterSettings=false;this.player.play()}}}enableControls(name,flag){const arr=!Array.isArray(name)?[name]:name;const uir=this.aviaUi;arr.forEach(n=>uir["".concat(n,"Disabled")]=!flag)}setSeekDisabled(flag){this.aviaUi.seekDisabled=flag;this.aviaUi.seekBackDisabled=flag;this.aviaUi.seekForwardDisabled=flag}setAdPosition(time,dur){this.aviaUi.adPlayheadPosition=time/dur}setTimeAndPosition(){if(this.aviaUi.waiting&&!this.player.video.paused){return}const ct=this.player.contentTime;const dur=this.player.contentDuration;this.aviaUi.timeDisplayValue=this.getTimeDisplayValue(ct,dur);this.aviaUi.currentTimeSeconds=ct;this.aviaUi.durationSeconds=dur;this.aviaUi.playheadPosition=ct/dur}setSegmentBreakPositions(times){const d=this.player.contentDuration;this.aviaUi.segmentBreakPositions=times.filter(t=>t>0&&t!==d).join(",")}selectLanguage(data){var _a,_b;const t=data.trackType;const id=data.trackId;if(t==="text"){const track=(_a=this.player.textTrackInfo.tracks)===null||_a===void 0?void 0:_a.find(tk=>tk.id===id);if(track)this.player.textTrack=track}else if(t==="audio"){const track=(_b=this.player.audioTrackInfo.tracks)===null||_b===void 0?void 0:_b.find(tk=>tk.id===id);if(track)this.player.audioTrack=track}}selectQuality(data){var _a,_b;const{index:index}=data;if(index===-1){this.player.autoQualitySwitching=true;return}const bitrate=(_b=(_a=this.player.qualityInfo.qualities)===null||_a===void 0?void 0:_a[index])===null||_b===void 0?void 0:_b.bitrate;if(bitrate){this.player.bitrate=bitrate}}getTimeDisplayValue(ct,dur){if(dur>86400)return"";return"".concat(secToHms(ct)," / ").concat(secToHms(dur))}setControlExclusions(){var _a;const system=(_a=this.services)===null||_a===void 0?void 0:_a.system;const{Device:Device}=this.avia;let exc=[];switch(system.device){case Device.ANDROID_PHONE:case Device.IPHONE:case Device.IPOD:case Device.KINDLE:case Device.IPAD:case Device.MOBILE:case Device.TABLET:case Device.UNKNOWN:case Device.WINDOWS_PHONE:exc=[ControlFunction.VOLUME];if(!system.hasFullscreenApi&&this.services.playerOptions.useNativeFullscreen){exc.push(ControlFunction.TEXT,ControlFunction.SETTINGS)}break;case Device.LG_SMART_TV:case Device.PLAYSTATION_4:case Device.PLAYSTATION_5:case Device.SAMSUNG_SMART_TV:case Device.VIZIO_SMART_TV:case Device.XBOX_ONE:exc=[ControlFunction.VOLUME];break}this.aviaUi.excludedControls=exc}get controlBarHeight(){if(this.controlBarHeight_==null){const bar=this.aviaUi.querySelector("avia-control-bar");this.controlBarHeight_=bar.getBoundingClientRect().height}return this.controlBarHeight_}createUi(){var _a;this.applyTheme((_a=this.options)===null||_a===void 0?void 0:_a.theme);return customElements.whenDefined(this.rootElement).then(()=>{this.setControlExclusions();this.initializeState()})}getContainer(){var _a;let container=this.options.container;if(container){container=document.querySelector(container)}return container||((_a=this.services)===null||_a===void 0?void 0:_a.dom.main)}initializeState(){var _a,_b,_c,_d;this.aviaUi.accIndicatorState={displayTime:this.accIndicatorDisplayTime,volumeKey:false,muted:false,seekForward:false,seekBack:false,seekTime:null};this.aviaUi.qualityLabel=(_a=this.options)===null||_a===void 0?void 0:_a.qualityLabel;if((_b=this.options)===null||_b===void 0?void 0:_b.activeMode){this.aviaUi.activeMode=this.options.activeMode}if((_c=this.options)===null||_c===void 0?void 0:_c.previewTimeTransform){this.previewTimeTransform=(_d=this.options)===null||_d===void 0?void 0:_d.previewTimeTransform}this.aviaUi.isTouch="ontouchstart"in document.documentElement;this.aviaUi.initialized=true}setLocalizationData(lang){const localeData=Object.values(LocalizationId).reduce((acc,id)=>{acc[id]=this.services.localization.localize(id,lang);return acc},{});this.aviaUi.localeData=localeData}getEventInterests(){return Object.values(this.avia.PlayerEvent)}async initialize(){this.services.localization.registerLocalizationData(LocalizationData);await this.createUi()}applyTheme(){let theme=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const container=this.getContainer();const{html:html,cssVars:cssVars}=theme;let aviaUi=container.querySelector(this.rootElement);let previous;if(html&&aviaUi){previous=container.removeChild(aviaUi);previous.removeEventListener(UiEvents.ACTION,this.hUiAction);aviaUi=null;this.aviaUi=null}if(!aviaUi){const elements=html?createElementsFromString(html):[document.createElement(this.rootElement)];aviaUi=elements.find(element=>element.nodeName.toLowerCase()===this.rootElement);if(!aviaUi){throw new Error("Avia UI theme HTML must contain the root element ".concat(this.rootElement))}elements.forEach(element=>container.appendChild(element));if(previous){Object.keys(Object.getPrototypeOf(previous)).forEach(key=>{const value=previous[key];if(typeof value==="function"){return}aviaUi[key]=previous[key]})}}if(!this.aviaUi){this.aviaUi=aviaUi;this.aviaUi.addEventListener(UiEvents.ACTION,this.hUiAction)}if(cssVars){applyCssVars(cssVars)}}}const ID=UI;const createPlugin=createUiPlugin;const plugin=ui;const aviaAccessibilityCss="avia-accessibility{display:block}";let AviaAccessibility$1=class extends H{constructor(){super();this.__registerHost()}render(){return h(Host,null,h("avia-volume-indicator",null),h("avia-seek-indicator",null))}static get style(){return aviaAccessibilityCss}};const aviaActiveCss="avia-active{display:block;transition:var(--avia-active-transition-in)}avia-ui:not([active]) avia-active{opacity:0;transition:var(--avia-active-transition-out)}";let AviaActive$1=class extends H{constructor(){super();this.__registerHost()}render(){return h(Host,null,h("slot",null))}static get style(){return aviaActiveCss}};const aviaAdControlBarCss='avia-ad-control-bar{position:absolute;height:56px;width:100%;left:0;bottom:0;right:0;pointer-events:none;flex-direction:row;justify-content:center;display:none;transition:var(--avia-active-transition-in)}avia-ui[control-mode="ad"] avia-ad-control-bar{display:flex}.avia-ad-control-container{pointer-events:auto;display:flex;width:calc(3 * var(--avia-control-bar-btn-width) + (2 * var(--avia-default-spacing)));height:var(--avia-control-bar-btn-height);justify-content:space-between;background-color:var(--avia-ad-control-bg-color);border-radius:var(--avia-ad-control-border-radius)}avia-ui:not([active]) avia-ad-control-bar{opacity:0;transition:var(--avia-active-transition-out)}';let AviaAdControlBar$1=class extends H{constructor(){super();this.__registerHost()}render(){return h(Host,null,h("div",{class:"avia-ad-control-container"},h("avia-mute-toggle",null),h("avia-play-toggle",null),h("avia-fullscreen-toggle",null)),h("avia-ad-progress-bar",null))}static get style(){return aviaAdControlBarCss}};var createDeferredPromise=function(){var resolve;var promise=new Promise((function(res){resolve=res}));return{promise:promise,resolve:resolve}};var openWormhole=function(Component,props,isBlocking){if(isBlocking===void 0){isBlocking=true}var isConstructor=Component.constructor.name==="Function";var Proto=isConstructor?Component.prototype:Component;var componentWillLoad=Proto.componentWillLoad;Proto.componentWillLoad=function(){var _this=this;var el=getElement(this);var onOpen=createDeferredPromise();var event=new CustomEvent("openWormhole",{bubbles:true,composed:true,detail:{consumer:this,fields:props,updater:function(prop,value){var target=prop in el?el:_this;target[prop]=value},onOpen:onOpen}});el.dispatchEvent(event);var willLoad=function(){if(componentWillLoad){return componentWillLoad.call(_this)}};return isBlocking?onOpen.promise.then((function(){return willLoad()})):willLoad()}};var multiverse=new Map;var updateConsumer=function(_a,state){var fields=_a.fields,updater=_a.updater;fields.forEach((function(field){updater(field,state[field])}))};var Universe={create:function(creator,initialState){var el=getElement(creator);var wormholes=new Map;var universe={wormholes:wormholes,state:initialState};multiverse.set(creator,universe);var connectedCallback=creator.connectedCallback;creator.connectedCallback=function(){multiverse.set(creator,universe);if(connectedCallback){connectedCallback.call(creator)}};var disconnectedCallback=creator.disconnectedCallback;creator.disconnectedCallback=function(){multiverse.delete(creator);if(disconnectedCallback){disconnectedCallback.call(creator)}};el.addEventListener("openWormhole",(function(event){event.stopPropagation();var _a=event.detail,consumer=_a.consumer,onOpen=_a.onOpen;if(wormholes.has(consumer))return;if(typeof consumer!=="symbol"){var connectedCallback_1=consumer.connectedCallback,disconnectedCallback_1=consumer.disconnectedCallback;consumer.connectedCallback=function(){wormholes.set(consumer,event.detail);if(connectedCallback_1){connectedCallback_1.call(consumer)}};consumer.disconnectedCallback=function(){wormholes.delete(consumer);if(disconnectedCallback_1){disconnectedCallback_1.call(consumer)}}}wormholes.set(consumer,event.detail);updateConsumer(event.detail,universe.state);onOpen===null||onOpen===void 0?void 0:onOpen.resolve((function(){wormholes.delete(consumer)}))}));el.addEventListener("closeWormhole",(function(event){var consumer=event.detail;wormholes.delete(consumer)}))},Provider:function(_a,children){var state=_a.state;var creator=getRenderingRef();if(multiverse.has(creator)){var universe=multiverse.get(creator);universe.state=state;universe.wormholes.forEach((function(opening){updateConsumer(opening,state)}))}return children}};const aviaAdProgressBarCss="avia-ad-progress-bar{display:block;position:absolute;background:var(--avia-ad-progress-track-color);position:absolute;height:3px;bottom:0;left:0;right:0;user-select:none}.avia-ad-prog-bar{height:3px;user-select:none;background-color:var(--avia-ad-progress-color);width:0%}";let AviaAdProgressBar$1=class extends H{constructor(){super();this.__registerHost();this.adPlayheadPosition=0;this.isLiveLinear=false}adPlayheadPositionHandler(val){if(!this.pbar||val===null||val===undefined||isNaN(val)||val<0)return;this.pbar.style.width="".concat(val*100,"%")}render(){return h("div",{class:"avia-ad-prog-bar",ref:el=>this.pbar=el})}static get watchers(){return{adPlayheadPosition:["adPlayheadPositionHandler"]}}static get style(){return aviaAdProgressBarCss}};openWormhole(AviaAdProgressBar$1,["adPlayheadPosition","isLiveLinear"]);const aviaButtonCss="avia-button{display:inline-block;background-color:transparent;height:var(--avia-control-bar-btn-height);width:var(--avia-control-bar-btn-width);color:var(--avia-control-bar-btn-text-color);border:var(--avia-control-bar-btn-border);border-width:var(--avia-control-bar-btn-border-width);border-radius:var(--avia-control-bar-btn-border-radius);outline:var(--avia-control-bar-btn-border-outline);cursor:var(--avia-control-bar-btn-border-cursor);pointer-events:all}avia-button:hover{color:var(--avia-control-bar-btn-text-color-hover)}avia-button[disabled]{cursor:var(--avia-control-bar-btn-disabled-cursor);opacity:var(--avia-control-bar-btn-disabled-opacity);pointer-events:none}avia-button[icon]{padding:0;margin:0;background-position:center;background-size:var(--avia-icon-btn-bg-size);background-repeat:no-repeat;user-select:none}avia-button[compact]{width:var(--avia-compact-button-width);height:var(--avia-compact-button-height);border-radius:var(--avia-compact-button-border-radius);background-color:var(--avia-compact-button-background-color)}";let AviaButton$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"action",7);this.toggled=false;this.compact=false;this.icon=false;this.variant=false;this.actions="";this.ids="";this.disabled=false;this.focused=false;this.TAP_THRESHOLD=300;this.isTouch="ontouchstart"in document.documentElement}onClick(event){if(this.isTouch||this.disabled){blockEvent(event);return}this.execAction()}onTouchStart(event){blockEvent(event);this.touchStartStamp=event.timeStamp}onTouchEnd(event){if(!this.disabled&&this.touchStartStamp&&event.timeStamp-this.touchStartStamp<=this.TAP_THRESHOLD){this.touchStartStamp=null;this.execAction()}}onFocus(){if(!this.element.classList.contains("focus-visible")){return}this.focused=true}onBlur(){if(!this.focused){return}this.focused=false}onKeyDown(event){switch(event.key){case"Enter":case" ":this.element.click();blockEvent(event);return}}getCsvValue(state){let index=arguments.length>1&&arguments[1]!==undefined?arguments[1]:+this.toggled;return csvToArray(state)[index]}execAction(){const action=this.getCsvValue(this.actions);if(!action){return}this.actionEvent.emit({action:action})}render(){var _a;const id=this.getCsvValue(this.ids)||this.locId;const ariaLabel=(_a=this.localeData)===null||_a===void 0?void 0:_a[id];const attributes={"aria-label":ariaLabel};if(!this.focused&&ariaLabel){attributes.title=ariaLabel}return h(Host,Object.assign({disabled:this.disabled,tabIndex:0},attributes),h("slot",null))}get element(){return this}static get style(){return aviaButtonCss}};openWormhole(AviaButton$1,["localeData"]);const aviaControlBarCss='avia-control-bar{box-sizing:border-box;position:absolute;bottom:0;left:0;width:100%;height:var(--avia-control-bar-height);padding:0 var(--avia-default-spacing);background:var(--avia-control-bar-bg);display:none;transition:var(--avia-active-transition-in)}avia-control-bar.avia-live-linear{padding-top:var(--avia-live-padding-top)}avia-ui[control-mode="content"] avia-control-bar{display:block}avia-ui:not([active]) avia-control-bar{opacity:0;transition:var(--avia-active-transition-out)}.avia-control-container{display:flex;justify-content:space-between;align-items:center;height:var(--avia-control-bar-btn-height);flex-wrap:nowrap}.avia-control-container avia-button{height:var(--avia-control-bar-btn-height)}avia-control-bar.avia-layout-c-30 .avia-control-group-left,avia-control-bar.avia-layout-c-30 .avia-control-group-right{width:35%}avia-control-bar.avia-layout-c-30 .avia-control-group-center{width:30%}avia-control-bar.avia-layout-c-40 .avia-control-group-left,avia-control-bar.avia-layout-c-40 .avia-control-group-right{width:30%}avia-control-bar.avia-layout-c-40 .avia-control-group-center{width:40%}avia-control-bar.avia-layout-c-50 .avia-control-group-left,avia-control-bar.avia-layout-c-50 .avia-control-group-right{width:25%}avia-control-bar.avia-layout-c-50 .avia-control-group-center{width:50%}avia-control-bar.avia-layout-c-60 .avia-control-group-left,avia-control-bar.avia-layout-c-60 .avia-control-group-right{width:20%}avia-control-bar.avia-layout-c-60 .avia-control-group-center{width:60%}avia-control-bar.avia-layout-c-70 .avia-control-group-left,avia-control-bar.avia-layout-c-70 .avia-control-group-right{width:15%}avia-control-bar.avia-layout-c-70 .avia-control-group-center{width:70%}avia-control-bar[avia-layout=default] .avia-control-group-left,avia-control-bar[avia-layout=default] .avia-control-group-right{display:flex;height:var(--avia-control-bar-btn-height);flex-basis:auto}avia-control-bar[avia-layout=default] .avia-control-group-left{flex-grow:1}.avia-control-group-left,.avia-control-group-right,.avia-control-group-center,.avia-control-group-left>*,.avia-control-group-right>*,.avia-control-group-center>*{display:flex;height:var(--avia-control-bar-btn-height);flex-basis:auto;align-items:center}.avia-control-group-center>*{flex-grow:1}.avia-control-group-right,.avia-control-group-right>*{justify-content:flex-end}.avia-control-group-left>*{justify-content:flex-start}.avia-control-group-center>*{justify-content:space-evenly}.avia-control-group-left>*>*{margin-right:var(--avia-half-spacing)}.avia-control-group-right>*>*{margin-left:var(--avia-half-spacing)}avia-control-bar>avia-progress-seek:empty{display:none}.avia-control-group-left>*:empty,.avia-control-group-right>*:empty,.avia-control-group-center>*:empty{display:none}';let AviaControlBar$1=class extends H{constructor(){super();this.__registerHost();this.isLiveLinear=false;this.controlMode=ControlMode.NONE}async getHeight(){return this.el.getBoundingClientRect().height}render(){return h(Host,{class:this.isLiveLinear?"avia-live-linear":""},h("slot",{name:"top"},!this.isLiveLinear?h("avia-progress-bar",null):""),h("div",{class:"avia-control-container"},h("div",{class:"avia-control-group-left"},h("slot",{name:"left"},h("avia-play-toggle",null),h("avia-mute-toggle",null),h("avia-volume-slider",null))),h("div",{class:"avia-control-group-center"},h("slot",{name:"center"})),h("div",{class:"avia-control-group-right"},h("slot",{name:"right"},h("avia-time-display",null),h("avia-live-control",null),h("avia-text-toggle",null),h("avia-settings-toggle",null),h("avia-fullscreen-toggle",null)))))}get el(){return this}static get style(){return aviaControlBarCss}};openWormhole(AviaControlBar$1,["isLiveLinear","controlMode"]);const aviaControlBarCompactCss='avia-control-bar-compact{display:none;position:absolute;top:50%;left:50%;width:var(--avia-compact-control-bar-width);height:var(--avia-compact-button-height);border-radius:var(--avia-compact-button-border-radius);margin-left:var(--avia-compact-control-bar-margin-left);margin-top:var(--avia-compact-control-bar-margin-top)}avia-control-bar-compact avia-mute-toggle,avia-control-bar-compact avia-play-toggle{margin-right:var(--avia-default-spacing)}avia-ui[control-mode="compact"][active] avia-control-bar-compact,avia-ui[control-mode="compact"][active] avia-control-bar-compact>*{display:block}';let AviaControlBarCompact$1=class extends H{constructor(){super();this.__registerHost()}render(){return h(Host,null,h("slot",null,h("avia-mute-toggle",{compact:true}),h("avia-play-toggle",{compact:true}),h("avia-fullscreen-toggle",{compact:true})))}static get style(){return aviaControlBarCompactCss}};const aviaCurrentTimeCss=":host{display:inline-block}.avia-current-time{display:inline-block;user-select:none;height:var(--avia-time-height);line-height:var(--avia-time-line-height);font-size:var(--avia-time-font-size);color:var(--avia-time-color);font-family:var(--avia-time-font-family)}.avia-control-group-right .avia-current-time{text-align:right}";let AviaCurrentTime$1=class extends H{constructor(){super();this.__registerHost();this.isLiveLinear=false;this.isDvr=false}render(){const inactive=this.isLiveLinear||this.isDvr;if(inactive){return""}const t=this.currentTimeSeconds||0;const lbl=this.localeData?createLocalizedTimeString(t,this.localeData):"";return h("div",{class:"avia-current-time","aria-label":lbl,title:lbl},secToHms(t))}static get style(){return aviaCurrentTimeCss}};openWormhole(AviaCurrentTime$1,["currentTimeSeconds","localeData","isLiveLinear","isDvr"]);const aviaDurationCss=":host{display:inline-block}.avia-duration{display:inline-block;user-select:none;height:var(--avia-time-height);line-height:var(--avia-time-line-height);font-size:var(--avia-time-font-size);color:var(--avia-time-color);font-family:var(--avia-time-font-family)}.avia-control-group-right .avia-duration{text-align:right}";let AviaDuration$1=class extends H{constructor(){super();this.__registerHost();this.isLiveLinear=false;this.isDvr=false}render(){const inactive=this.isLiveLinear||this.isDvr;if(inactive){return""}const t=this.durationSeconds||0;const lbl=this.localeData?createLocalizedTimeString(t,this.localeData):"";return h("div",{class:"avia-duration","aria-label":lbl,title:lbl},secToHms(this.durationSeconds||0))}static get style(){return aviaDurationCss}};openWormhole(AviaDuration$1,["durationSeconds","localeData","isLiveLinear","isDvr"]);const aviaFullscreenToggleCss="avia-fullscreen-toggle{display:inline-block}avia-fullscreen-toggle avia-button{background-image:var(--avia-fs-icon)}avia-fullscreen-toggle avia-button:hover{background-image:var(--avia-fs-icon-hover)}avia-fullscreen-toggle avia-button[toggled]{background-image:var(--avia-fs-exit-icon)}avia-fullscreen-toggle avia-button[toggled]:hover{background-image:var(--avia-fs-exit-icon-hover)}";let AviaFullscreenToggle$1=class extends H{constructor(){super();this.__registerHost();this.fullscreen=false;this.fullscreenDisabled=true;this.compact=false}render(){return h("avia-button",{ids:"".concat(LocalizationId.FULL_SCREEN_ENTER,", ").concat(LocalizationId.FULL_SCREEN_EXIT),actions:"".concat(Action.ENTER_FULLSCREEN,", ").concat(Action.EXIT_FULLSCREEN),disabled:this.fullscreenDisabled,toggled:this.fullscreen,compact:this.compact,icon:true})}static get style(){return aviaFullscreenToggleCss}};openWormhole(AviaFullscreenToggle$1,["fullscreen","fullscreenDisabled"]);const aviaLiveControlCss="avia-live-control{display:inline-block;margin-right:var(--avia-default-spacing)}avia-live-control avia-button{width:auto;height:auto !important;font-size:0.9em;text-align:right;overflow:hidden}avia-live-control avia-button[disabled]{opacity:1;cursor:default}avia-live-control avia-button::before,avia-live-control avia-button[disabled]::before{content:'• ';color:red;font-size:0.9em}";let AviaLiveControl$1=class extends H{constructor(){super();this.__registerHost();this.isLiveLinear=false;this.isDvr=false;this.live=false}render(){if(!(this.isLiveLinear||this.isDvr)){return}const isLive=this.live||this.isLiveLinear;const locId=isLive?LocalizationId.LIVE:LocalizationId.GO_LIVE;return h("avia-button",{actions:"".concat(Action.NONE,", ").concat(Action.GO_TO_LIVE),toggled:!this.live,disabled:isLive},h("avia-text",{"loc-id":locId}))}static get style(){return aviaLiveControlCss}};openWormhole(AviaLiveControl$1,["isLiveLinear","live","isDvr"]);const aviaMuteToggleCss="avia-mute-toggle{display:inline-block}avia-mute-toggle avia-button{background-image:var(--avia-unmuted-icon)}avia-mute-toggle avia-button:hover{background-image:var(--avia-unmuted-icon-hover)}avia-mute-toggle avia-button[toggled]{background-image:var(--avia-mute-icon)}avia-mute-toggle avia-button[toggled]:hover{background-image:var(--avia-mute-icon-hover)}";let AviaMuteToggle$1=class extends H{constructor(){super();this.__registerHost();this.muted=false;this.muteDisabled=true;this.compact=false}render(){return h("avia-button",{ids:"".concat(LocalizationId.MUTE,", ").concat(LocalizationId.UNMUTE),actions:"".concat(Action.MUTE,", ").concat(Action.UNMUTE),toggled:this.muted,disabled:this.muteDisabled,compact:this.compact,icon:true})}static get style(){return aviaMuteToggleCss}};openWormhole(AviaMuteToggle$1,["muted","muteDisabled"]);const aviaOverlayCss="avia-overlay{background:transparent;position:absolute;width:100%;height:100%;top:0;left:0;border:none;padding:0;margin:0}avia-overlay[centered]{justify-content:center;align-items:center;display:flex}";let AviaOverlay$1=class extends H{constructor(){super();this.__registerHost();this.centered=false}render(){return h(Host,{centered:this.centered},h("slot",null))}static get style(){return aviaOverlayCss}};const aviaPlayCtaCss="avia-play-cta avia-button{width:var(--avia-play-cta-width);height:var(--avia-play-cta-height);border-radius:var(--avia-play-cta-border-radius);background-image:var(--avia-play-cta-bg-image);background-color:var(--avia-play-cta-bg-color);background-repeat:no-repeat;background-position-x:calc(var(--avia-play-cta-bg-position) + 6%);background-position-y:var(--avia-play-cta-bg-position);background-size:var(--avia-play-cta-bg-size);cursor:pointer}";let AviaPlayCta$1=class extends H{constructor(){super();this.__registerHost()}render(){return h("avia-button",{disabled:false,"loc-id":LocalizationId.PLAY})}static get style(){return aviaPlayCtaCss}};const aviaPlayOverlayCss="avia-play-overlay{background-color:var(--avia-play-overlay-bg-color)}avia-play-overlay.focus-visible avia-play-cta{box-shadow:var(--avia-focus-box-shadow-inner)}";let AviaPlayOverlay$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"action",7);this.playing=false;this.controlMode=ControlMode.NONE;this.playDisabled=true;this.pausable=true;this.isTouch=false}onClick(){const action=this.playing?Action.PAUSE:Action.PLAY;this.actionEvent.emit({action:action})}render(){const paused=!this.playing;const noTouch=!paused&&this.isTouch;if(noTouch||this.playDisabled||!this.pausable||this.controlMode!==ControlMode.CONTENT){return}return h("avia-overlay",{centered:true},paused&&h("avia-play-cta",null))}static get style(){return aviaPlayOverlayCss}};openWormhole(AviaPlayOverlay$1,["playing","playDisabled","pausable","controlMode","isTouch"]);const aviaPlayToggleCss="avia-play-toggle{display:inline-block}avia-play-toggle avia-button{background-image:var(--avia-play-icon)}avia-play-toggle avia-button:hover{background-image:var(--avia-play-icon-hover)}avia-play-toggle avia-button[toggled]{background-image:var(--avia-pause-icon)}avia-play-toggle avia-button[toggled]:hover{background-image:var(--avia-pause-icon-hover)}avia-play-toggle avia-button[toggled][variant]{background-image:var(--avia-stop-icon)}avia-play-toggle avia-button[toggled][variant]:hover{background-image:var(--avia-stop-icon-hover)}";let AviaPlayToggle$1=class extends H{constructor(){super();this.__registerHost();this.playing=false;this.playDisabled=true;this.compact=false}render(){const paused=!this.playing;const ids=[LocalizationId.PLAY,this.pausable?LocalizationId.PAUSE:LocalizationId.STOP];const actions=[Action.PLAY,this.pausable?Action.PAUSE:Action.STOP];const locId=paused?this.pausable?LocalizationId.PAUSE:LocalizationId.STOP:LocalizationId.PLAY;return h("avia-button",{ids:ids.join(","),actions:actions.join(","),disabled:this.playDisabled,"loc-id":locId,toggled:this.playing,compact:this.compact,variant:!this.pausable,icon:true})}static get style(){return aviaPlayToggleCss}};openWormhole(AviaPlayToggle$1,["playing","playDisabled","pausable"]);const aviaPosterCss="avia-poster img{width:100%;height:auto}";let AviaPoster$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"action",7);this.posterActive=false}handleAction(event){this.actionEvent.emit({action:Action.POSTER_PLAY});blockEvent(event)}componentDidRender(){if(this.el&&this.el.parentElement&&!this.posterActive){this.el.parentElement.removeChild(this.el)}}render(){if(!this.posterActive){return""}return h("avia-overlay",null,!isEmpty(this.posterImageUrl)?h("img",{src:this.posterImageUrl,alt:""}):"",h("div",{class:""},h("slot",null)),h("avia-overlay",{centered:true},h("avia-play-cta",null)))}get el(){return this}static get style(){return aviaPosterCss}};openWormhole(AviaPoster$1,["posterActive","posterImageUrl"]);const aviaProgressBarCss=":root{--avia-progress-preview-height:24px;--avia-progress-preview-width:50px;--avia-progress-preview-line-height:24px;--avia-progress-preview-top:-34px;--avia-progress-preview-bg-color:rgba(44, 44, 44, 0.7);--avia-progress-preview-color:rgb(220, 220, 220);--avia-progress-preview-font-size:13px;--avia-progress-preview-border-radius:4px}.avia-progress-preview{position:absolute;line-height:var(--avia-progress-preview-line-height);background:var(--avia-progress-preview-bg-color);color:var(--avia-progress-preview-color);font-size:var(--avia-progress-preview-font-size);text-align:center;border-radius:var(--avia-progress-preview-border-radius);user-select:none;overflow:hidden}.avia-progress-text{padding:0 0.5em 0 0.5em;white-space:nowrap}";let AviaProgressBar$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"action",7);this.increment=15;this.hoverDelay=250;this.hovering=false;this.cursor=0;this.imgElement=document.createElement("img");this.dragging=false}onMouseEnter(event){clearTimeout(this.hoverTimeoutHandle);this.hoverTimeoutHandle=setTimeout(()=>{this.hovering=true;this.onMouseMove(event)},this.hoverDelay)}onMouseLeave(){clearTimeout(this.hoverTimeoutHandle);this.hovering=false}onMouseMove(event){if(!this.active){return}const offset=this.sliderElement.getBoundingClientRect();const pos=getEventPos(event).x-offset.left;const percent=clampValue(pos/offset.width,0,1);this.actionEvent.emit({action:"preview",value:{time:percent*this.durationSeconds,percent:percent}});this.cursor=clampValue(pos,0,offset.width)}get active(){return this.hovering||this.dragging}onChange(e){this.actionEvent.emit({action:"seek",value:e.detail.value})}onDragging(e){this.dragging=e.detail.value}componentDidRender(){if(!this.preview){return}const data=this.preview.data;const slider=this.sliderElement;const parentWidth=slider.offsetWidth;if(data){const img=this.imgElement;if(img.src!==data.url){img.src=data.url}const canvas=this.canvasElement;const thumbnailToViewportScale=.25;const scale=Math.min(parentWidth*thumbnailToViewportScale/data.width,1);const context=canvas.getContext("2d");const width=data.width*scale;const height=data.height*scale;canvas.width=width;canvas.height=height;context.drawImage(img,data.x,data.y,data.width,data.height,0,0,width,height)}const preview=this.previewElement;const margin=preview.offsetWidth/2;const max=parentWidth-margin;const offset=this.cursor<margin?margin-this.cursor:this.cursor>max?max-this.cursor:0;preview.style.marginLeft="".concat(offset-margin,"px");preview.style.top="-".concat(preview.offsetHeight+slider.offsetHeight/2,"px")}render(){var _a,_b;const ariaValueText=this.localeData?valueOfTotal(this.currentTimeSeconds,this.durationSeconds,this.localeData):"";const list=csvToArray(this.segmentBreakPositions).map(i=>({value:parseFloat(i)}));return h("avia-slider",{ref:e=>this.sliderElement=e,"loc-id":LocalizationId.SEEK,"aria-valuetext":ariaValueText,list:list,value:this.currentTimeSeconds,max:this.durationSeconds,increment:this.increment,onChange:e=>this.onChange(e),onDragging:e=>this.onDragging(e)},h("div",{ref:e=>this.previewElement=e,class:"avia-progress-preview",style:{visibility:this.active?"visible":"hidden",left:"".concat(this.cursor,"px")}},h("canvas",{ref:e=>this.canvasElement=e,class:"avia-progress-img",style:{display:((_a=this.preview)===null||_a===void 0?void 0:_a.data)?"block":"none"}}),h("div",{ref:e=>this.textElement=e,class:"avia-progress-text"},(_b=this.preview)===null||_b===void 0?void 0:_b.value)))}static get style(){return aviaProgressBarCss}};openWormhole(AviaProgressBar$1,["currentTimeSeconds","durationSeconds","localeData","seekDisabled","segmentBreakPositions","preview"]);const aviaSeekBackButtonCss="avia-seek-back-button{display:inline-block}avia-seek-back-button avia-button{background-image:var(--avia-seek-back-icon)}avia-seek-back-button avia-button:hover{background-image:var(--avia-seek-back-icon-hover)}";let AviaSeekBackButton$1=class extends H{constructor(){super();this.__registerHost();this.seekBackDisabled=false;this.isLiveLinear=false}render(){if(this.isLiveLinear){return""}return h("avia-button",{actions:Action.SEEK_BACK,disabled:this.seekBackDisabled,"loc-id":LocalizationId.SEEK_BACK,icon:true})}static get style(){return aviaSeekBackButtonCss}};openWormhole(AviaSeekBackButton$1,["seekBackDisabled","isLiveLinear"]);const aviaSeekForwardButtonCss="avia-seek-forward-button{display:inline-block}avia-seek-forward-button avia-button{background-image:var(--avia-seek-forward-icon)}avia-seek-forward-button avia-button:hover{background-image:var(--avia-seek-forward-icon-hover)}";let AviaSeekForwardButton$1=class extends H{constructor(){super();this.__registerHost();this.seekForwardDisabled=false;this.isLiveLinear=false}render(){if(this.isLiveLinear){return""}return h("avia-button",{actions:Action.SEEK_FORWARD,disabled:this.seekForwardDisabled,"loc-id":LocalizationId.SEEK_FORWARD,icon:true})}static get style(){return aviaSeekForwardButtonCss}};openWormhole(AviaSeekForwardButton$1,["seekForwardDisabled","isLiveLinear"]);const aviaSeekIndicatorCss="avia-seek-indicator{position:absolute;display:inline-block;box-sizing:border-box;border-radius:var(--avia-seek-indicator-border-radius);background-color:var(--avia-seek-indicator-background-color);color:var(--avia-seek-indicator-color);height:var(--avia-seek-indicator-height);font-size:var(--avia-seek-indicator-font-size);font-family:var(--avia-seek-indicator-font-family);line-height:var(--avia-seek-indicator-line-height);top:calc(50% - 24px);opacity:0;transition-property:opacity;transition-duration:300ms;transition-timing-function:ease-in}avia-seek-indicator.avia-indicator-active{opacity:1}avia-seek-indicator:empty{opacity:0}.avia-acc-fwd{right:12px;padding-left:48px;padding-right:12px;text-align:right}.avia-acc-back{left:12px;padding-right:48px;padding-left:12px}avia-seek-indicator .avia-acc-arrow{width:24px;height:18px;position:absolute;top:calc(50% - 9px);background-image:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2017.81%2024%22%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill%3A%23fff%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22Layer_2%22%20data-name%3D%22Layer%202%22%3E%3Cg%20id%3D%22Layer_2-2%22%20data-name%3D%22Layer%202%22%3E%3Cpath%20class%3D%22cls-1%22%20d%3D%22M0%2C6.55V17.79a.54.54%2C0%2C0%2C0%2C.54.54l5.15-.08a.54.54%2C0%2C0%2C1%2C.54.54v4.67a.54.54%2C0%2C0%2C0%2C.92.38l10.51-11.2a.56.56%2C0%2C0%2C0%2C0-.76L7.25.17a.54.54%2C0%2C0%2C0-.93.37V5.39a.54.54%2C0%2C0%2C1-.54.54L.54%2C6A.54.54%2C0%2C0%2C0%2C0%2C6.55Z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');background-repeat:no-repeat;background-size:24px 18px}.avia-acc-fwd .avia-acc-arrow{left:12px}.avia-acc-back .avia-acc-arrow{transform:rotate(180deg);right:12px}";let AviaSeekIndicator$1=class extends H{constructor(){super();this.__registerHost()}componentDidRender(){if(!this.debouncer&&this.accIndicatorState.displayTime>0){this.debouncer=debounce(()=>{var _a;(_a=this.el)===null||_a===void 0?void 0:_a.classList.remove(CssNames.INDICATOR_ACTIVE);this.visible=false},this.accIndicatorState.displayTime)}if(this.visible){setTimeout(()=>this.el.classList.add(CssNames.INDICATOR_ACTIVE),0);this.debouncer&&this.debouncer()}}render(){const acc=this.accIndicatorState;if(!acc.seekForward&&!acc.seekBack){this.visible=false;return""}this.visible=true;const t=this.accIndicatorState.seekTime;const d=this.durationSeconds;const hasD=d&&!isNaN(d);let str="";if(hasD){const dur=secToHms(d);if(!isNaN(t)&&t>=0){const p=secToHms(t);str=p+" / "+dur}}return h(Host,{class:acc.seekForward?CssNames.ACC_FWD:CssNames.ACC_BACK},h("span",null,str),h("div",{class:"avia-acc-arrow"}))}get el(){return this}static get style(){return aviaSeekIndicatorCss}};openWormhole(AviaSeekIndicator$1,["durationSeconds","accIndicatorState"]);var LanguageLabel;(function(LanguageLabel){LanguageLabel["AB"]="Abkhaz";LanguageLabel["AE"]="Avesta";LanguageLabel["AF"]="Afrikaans";LanguageLabel["AK"]="Akan";LanguageLabel["AM"]="አማርኛ";LanguageLabel["AN"]="Aragonés";LanguageLabel["AR"]="العربية";LanguageLabel["AV"]="Aвар мацӀ";LanguageLabel["AY"]="Aymar aru";LanguageLabel["AZ"]="azərbaycan dili";LanguageLabel["BA"]="башҡорт теле";LanguageLabel["BE"]="беларуская мова";LanguageLabel["BG"]="български език";LanguageLabel["BH"]="भोजपुरी";LanguageLabel["BI"]="Bislama";LanguageLabel["BM"]="Bamanankan";LanguageLabel["BN"]="বাংলা";LanguageLabel["BO"]="བོད་ཡིག";LanguageLabel["BR"]="Brezhoneg";LanguageLabel["BS"]="Bosanski jezik";LanguageLabel["CA"]="català";LanguageLabel["CE"]="нохчийн мотт";LanguageLabel["CH"]="Chamoru";LanguageLabel["CO"]="Corsu";LanguageLabel["CR"]="ᓀᐦᐃᔭᐍᐏᐣ";LanguageLabel["CS"]="čeština";LanguageLabel["CU"]="ѩзыкъ словѣньскъ";LanguageLabel["CV"]="чӑваш чӗлхи";LanguageLabel["CY"]="Cymraeg";LanguageLabel["DA"]="Dansk";LanguageLabel["DE"]="Deutsch";LanguageLabel["DZ"]="རྫོང་ཁ";LanguageLabel["EE"]="Eʋegbe";LanguageLabel["EL"]="ελληνικά";LanguageLabel["EN"]="English";LanguageLabel["EO"]="Esperanto";LanguageLabel["ES"]="Español";LanguageLabel["ET"]="Eesti";LanguageLabel["EU"]="Euskara";LanguageLabel["FA"]="فارسی";LanguageLabel["FF"]="Fulfulde";LanguageLabel["FI"]="Suomi";LanguageLabel["FJ"]="Vosa Vakaviti";LanguageLabel["FO"]="Føroyskt";LanguageLabel["FR"]="Français";LanguageLabel["FY"]="Frysk";LanguageLabel["GA"]="Gaeilge";LanguageLabel["GD"]="Gàidhlig";LanguageLabel["GL"]="Galego";LanguageLabel["GN"]="Avañe'ẽ";LanguageLabel["GU"]="ગુજરાતી";LanguageLabel["GV"]="Gaelg";LanguageLabel["HA"]="(Hausa) هَوُسَ";LanguageLabel["HE"]="עברית";LanguageLabel["HI"]="हिन्दी";LanguageLabel["HO"]="Hiri Motu";LanguageLabel["HR"]="hrvatski jezik";LanguageLabel["HT"]="Kreyòl ayisyen";LanguageLabel["HU"]="Magyar";LanguageLabel["HY"]="Հայերեն";LanguageLabel["HZ"]="Otjiherero";LanguageLabel["IA"]="Interlingua";LanguageLabel["ID"]="Bahasa Indonesia";LanguageLabel["IE"]="Interlingue";LanguageLabel["IG"]="Asụsụ Igbo";LanguageLabel["II"]="ꆈꌠ꒿ Nuosuhxop";LanguageLabel["IK"]="Iñupiaq";LanguageLabel["IO"]="Ido";LanguageLabel["IS"]="Íslenska";LanguageLabel["IT"]="Italiano";LanguageLabel["IU"]="ᐃᓄᒃᑎᑐᑦ";LanguageLabel["JA"]="日本人";LanguageLabel["JV"]="Basa Jawa";LanguageLabel["KA"]="ქართული";LanguageLabel["KG"]="Kikongo";LanguageLabel["KI"]="Gĩkũyũ";LanguageLabel["KJ"]="Kuanyama";LanguageLabel["KK"]="қазақ тілі";LanguageLabel["KL"]="kalaallisut";LanguageLabel["KM"]="ខ្មែរ";LanguageLabel["KN"]="ಕನ್ನಡ";LanguageLabel["KO"]="한국어";LanguageLabel["KR"]="Kanuri";LanguageLabel["KS"]="कश्मीरी,";LanguageLabel["KU"]="Kurdî‎";LanguageLabel["KV"]="коми кыв";LanguageLabel["KW"]="Kernewek";LanguageLabel["KY"]="Кыргызча";LanguageLabel["LA"]="Latine";LanguageLabel["LB"]="Lëtzebuergesch";LanguageLabel["LG"]="Luganda";LanguageLabel["LI"]="Limburgs";LanguageLabel["LN"]="Lingála";LanguageLabel["LO"]="ພາສາລາວ";LanguageLabel["LT"]="Lietuvių kalba";LanguageLabel["LU"]="Kiluba";LanguageLabel["LV"]="latviešu valoda";LanguageLabel["MG"]="fiteny malagasy";LanguageLabel["MH"]="Kajin M̧ajeļ";LanguageLabel["MI"]="te reo Māori";LanguageLabel["MK"]="македонски јазик";LanguageLabel["ML"]="മലയാളം";LanguageLabel["MN"]="Монгол хэл";LanguageLabel["MR"]="मराठी";LanguageLabel["MS"]="Bahasa Melayu‎";LanguageLabel["MT"]="Malti";LanguageLabel["MY"]="ဗမာစာ";LanguageLabel["NA"]="Dorerin Naoero";LanguageLabel["NB"]="Norsk Bokmål";LanguageLabel["NE"]="नेपाली";LanguageLabel["NG"]="Owambo";LanguageLabel["NL"]="Nederlands";LanguageLabel["NN"]="Norsk Nynorsk";LanguageLabel["NO"]="Norsk";LanguageLabel["NR"]="IsiNdebele";LanguageLabel["NV"]="Diné bizaad";LanguageLabel["NY"]="ChiCheŵa";LanguageLabel["OC"]="Occitan";LanguageLabel["OJ"]="ᐊᓂᔑᓈᐯᒧᐎᓐ";LanguageLabel["OM"]="Afaan Oromoo";LanguageLabel["OR"]="ଓଡ଼ିଆ";LanguageLabel["OS"]="ирон æвзаг";LanguageLabel["PA"]="ਪੰਜਾਬੀ";LanguageLabel["PI"]="पालि, पाळि";LanguageLabel["PL"]="Język polski";LanguageLabel["PS"]="پښتو";LanguageLabel["PT"]="Português";LanguageLabel["QU"]="Runa Simi";LanguageLabel["RM"]="Rumantsch Grischun";LanguageLabel["RN"]="Ikirundi";LanguageLabel["RO"]="Română";LanguageLabel["RU"]="русский";LanguageLabel["RW"]="Ikinyarwanda";LanguageLabel["SA"]="संस्कृतम्";LanguageLabel["SC"]="sardu";LanguageLabel["SD"]="सिन्धी‎";LanguageLabel["SE"]="Davvisámegiella";LanguageLabel["SG"]="Yângâ tî sängö";LanguageLabel["SI"]="සිංහල";LanguageLabel["SK"]="Slovenčina";LanguageLabel["SL"]="Slovenski jezik";LanguageLabel["SM"]="Gagana fa'a Samoa";LanguageLabel["SN"]="chiShona";LanguageLabel["SO"]="Soomaaliga";LanguageLabel["SQ"]="Shqip";LanguageLabel["SR"]="српски језик";LanguageLabel["SS"]="SiSwati";LanguageLabel["ST"]="Sesotho";LanguageLabel["SU"]="Basa Sunda";LanguageLabel["SV"]="Svenska";LanguageLabel["SW"]="Kiswahili";LanguageLabel["TA"]="தமிழ்";LanguageLabel["TE"]="తెలుగు";LanguageLabel["TG"]="тоҷикӣ‎";LanguageLabel["TH"]="ไทย";LanguageLabel["TI"]="ትግርኛ";LanguageLabel["TK"]="Türkmen";LanguageLabel["TL"]="Wikang Tagalog";LanguageLabel["TN"]="Setswana";LanguageLabel["TO"]="Faka Tonga";LanguageLabel["TR"]="Türkçe";LanguageLabel["TS"]="Xitsonga";LanguageLabel["TT"]="татар теле";LanguageLabel["TW"]="Twi";LanguageLabel["TY"]="Reo Tahiti";LanguageLabel["UG"]="ئۇيغۇرچە‎";LanguageLabel["UK"]="Українська";LanguageLabel["UR"]="اردو";LanguageLabel["UZ"]="Oʻzbek‎";LanguageLabel["VE"]="Tshivenḓa";LanguageLabel["VI"]="Tiếng Việt";LanguageLabel["VO"]="Volapük";LanguageLabel["WA"]="Walon";LanguageLabel["WO"]="Wollof";LanguageLabel["XH"]="IsiXhosa";LanguageLabel["YI"]="ייִדיש";LanguageLabel["YO"]="Yorùbá";LanguageLabel["ZA"]="Saɯ cueŋƅ";LanguageLabel["ZH"]="中文 (Zhōngwén)";LanguageLabel["ZU"]="IsiZulu"})(LanguageLabel||(LanguageLabel={}));const aviaSettingsCss=":root{--avia-chevron-right:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%3E%3Cpath%20id%3D%22Arrow_2_1%22%20d%3D%22M0%2C24L14.4%2C11.556%2C0%2C0%2C6.74%2C0%2C24%2C11.556%2C6.74%2C24Z%22%2F%3E%3C%2Fsvg%3E');--avia-x-symbol:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2012%2012%22%20width%3D%2212%22%20height%3D%2212%22%3E%3Cstyle%3Etspan%20%7B%20white-space%3Apre%20%7D%3C%2Fstyle%3E%3Cpath%20fill%3D%22%23FFF%22%20d%3D%22M0.07%202.19L2.26%200L5.91%203.65L9.56%200L11.75%202.19L8.1%205.84L11.75%209.49L9.56%2011.68L5.91%208.03L2.26%2011.68L0.07%209.49L3.72%205.84L0.07%202.19Z%22%20%2F%3E%3C%2Fsvg%3E');--avia-menu-text-color:var(--avia-text-color);--avia-menu-text-color-hover:var(--avia-text-color-hover)}avia-settings{display:block;position:absolute;pointer-events:none}avia-settings>*{pointer-events:auto}.avia-settings-menu{min-width:180px;height:auto;background-color:rgba(0, 0, 0, 0.65);position:absolute;bottom:64px;right:var(--avia-default-spacing);display:flex;flex-direction:column;max-height:calc(100% - 1em - var(--avia-control-bar-height));border-radius:0.25em;overflow:hidden}avia-ui.avia-settings-nudge-left .avia-settings-menu{right:calc(var(--avia-default-spacing) + 48px)}.avia-settings-menu-header{padding:0.5em 0.25em 0.5em 0.75em;color:var(--avia-accent-color);background-color:black;border-bottom:1px solid #444;display:flex;align-items:center;justify-content:center;font-weight:bold}.avia-menu-button{background-color:transparent;border:none;outline:none;cursor:pointer;width:100%;text-align:left;color:var(--avia-menu-text-color);padding:1em;font-size:1em;background-position:right center;background-repeat:no-repeat;background-size:20% 20%;margin:0}.avia-menu-button:hover{color:var(--avia-menu-text-color-hover);background-color:rgba(0, 0, 0, 0.65)}.avia-menu-button[aria-haspopup=true]{background-image:var(--avia-chevron-right)}.avia-menu-button[disabled]{cursor:default;opacity:0.75}.avia-menu-button[disabled]:hover{background-color:transparent;color:var(--avia-menu-text-color)}.avia-menu-close{width:1.75em;height:2em;background-image:var(--avia-x-symbol);background-repeat:no-repeat;padding:0px}.avia-settings-back{width:1.75em;height:1.75em;background-image:var(--avia-chevron-right);background-repeat:no-repeat;background-size:100% 100%;transform:rotate(180deg);margin-right:1em}.avia-spacer{flex-grow:1}.avia-settings-menu.avia-language-menu{min-width:180px}.avia-menu-content{display:flex;flex-direction:row;overflow:hidden}.avia-menu-content>div{width:180px;color:var(--avia-menu-text-color)}.avia-menu-content>div:first-child{border-right:1px solid #888}.avia-menu-content>div:only-child{border-right:none}.avia-list{display:flex;flex-direction:column;font-size:0.95em}.avia-list-title{padding-left:1em;color:var(--avia-accent-color);font-size:0.9em;font-weight:bold;height:2em;line-height:2em;background-color:black;border-bottom:1px solid #444}.avia-list .avia-menu-button[aria-checked=true]{font-weight:bold;cursor:default;background-position:94% center;background-repeat:no-repeat;background-size:0.9em;background-image:var(--avia-selected-icon)}.avia-list .avia-list-container{overflow:scroll}.avia-settings-menu.avia-quality-menu{max-width:180px}.avia-menu-button[data-description]:after{content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAVCAYAAABc6S4mAAACG0lEQVQ4jZ2Vz0tVQRTHP89QKJ9lm6ikzN6zJAlxJ1E8CJO27oo2IdKmRdBWwRZhkH9A4kJoI7ppIUWkibRsERpILpQCF9lPLPpBQc+vTJ0Lh+lduc8Dw8z9zJlz5sw5MzcniR1IAegDDgJrwCjwvqKZ4CBDa5VUkrTf6YbNnZc0JemHpHFJtbGtrBF0AOeAI8AxYAp44OYvAo+BT0AJeFVtBEnbI2lI/+RZtOPDxsuSmnwEd4FG4E+06xxQa2c8DSy6uSKwYufeBnwxfgGYAZaBU0kEWeWJpONux822bjWK8qHx63+PX9J6FU5+SWp3xm4av+PYSWMh8XXhiNat3IIMA5+BGqAM1ANX7BgSCfotwG/T+wrkgV3AptMJNrviCNKSOxlF0ufm7hu77NiIsVs1UWJbUsr0EvDBffe48YL1JcdeW98bO9hO5lI28tb63Y6VrS9U48Dn4Z0b563fdCyX6MUONlKMXwU63fdzNy5Y/8axpGgexUnukLRPUqOkvZKKkgYqlOtRl9AlY82OLRvrjh38lPTdavhbyl245gy1G1t07IDTzWNvR1a5EZXviq1rdeyesZHkJr+QtLZNeylpzG6oNz5R4U4UjYXo6xIH1bYGSfNmqD9a+9H42YRlNV4v6bSkQUkLkp5KanPzh5zxXr82i/HwXoX3vdsS3Bm9qLetKEI1ndjpHy2W8P84Y09GEzAGzP6nBWwBc7kMbCgO6BoAAAAASUVORK5CYII=');left:0.4em;top:0.25em;position:relative}";var MenuState;(function(MenuState){MenuState["MAIN"]="main";MenuState["LANGUAGE"]="language";MenuState["QUALITY"]="quality";MenuState["NONE"]="none"})(MenuState||(MenuState={}));let AviaSettings$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"action",7);this.settings=null;this.localeData=null;this.qualityLabel=0;this.controlMode=null;this.menuState=MenuState.NONE;this.menuButtonClass="avia-menu-button";this.menuButtonSelector=".avia-menu-button:not([disabled])";this.qualityIndex=-1}onClick(event){const el=event.target;const action=el.dataset.action;const key=el.dataset.key;const value=el.dataset.value;if(action){this.menuState=action}if(key){this.selectListItem(el)}if(key&&value){if(key==="quality"){this.qualityIndex=parseInt(value)}this.actionEvent.emit({action:key==="quality"?Action.QUALITY_SELECT:Action.LANGUAGE_SELECT,value:key==="quality"?{index:value}:{trackType:key,trackId:value}})}}onKeyDown(event){var _a,_b,_c;if(!((_a=this.settings)===null||_a===void 0?void 0:_a.active)||this.menuState===MenuState.NONE){return}const active=document.activeElement;const menu=active.closest(".avia-list");if(!menu){return}const items=Array.from(menu.querySelectorAll(this.menuButtonSelector));if(!items){return}const findSibling=function(items,start){let predicate=arguments.length>2&&arguments[2]!==undefined?arguments[2]:item=>item;const index=items.findIndex(item=>item===start)+1;const list=[...items.slice(index),...items.slice(0,index)];return list.find(item=>predicate(item))};const key=event.key;switch(key){case"Escape":this.close();break;case"ArrowUp":const prev=findSibling(items.reverse(),active);prev===null||prev===void 0?void 0:prev.focus();break;case"ArrowDown":const next=findSibling(items,active);next===null||next===void 0?void 0:next.focus();break;case"ArrowLeft":if((_b=menu.previousElementSibling)===null||_b===void 0?void 0:_b.classList.contains("avia-list")){const item=menu.previousElementSibling.querySelector(this.menuButtonSelector);item===null||item===void 0?void 0:item.focus();return}const back=document.querySelector(".avia-settings-back");if(back===null||back===void 0?void 0:back.dataset.action){this.menuState=back.dataset.action}break;case"ArrowRight":if((_c=menu.nextElementSibling)===null||_c===void 0?void 0:_c.classList.contains("avia-list")){const item=menu.nextElementSibling.querySelector(this.menuButtonSelector);item===null||item===void 0?void 0:item.focus();return}if(active.dataset.action){this.menuState=active.dataset.action}break;default:if(/^[A-Za-z0-9]$/.test(key)){const regex=new RegExp("^".concat(key),"i");const item=findSibling(items,active,item=>regex.test(item===null||item===void 0?void 0:item.textContent));item===null||item===void 0?void 0:item.focus()}}}async close(){this.actionEvent.emit({action:Action.SETTINGS_OFF});this.menuState=MenuState.NONE}componentWillRender(){var _a;if(((_a=this.settings)===null||_a===void 0?void 0:_a.active)&&this.menuState===MenuState.NONE){this.menuState=MenuState.MAIN}}disconnectedCallback(){clearTimeout(this.timeout)}render(){var _a;if(this.controlMode!==ControlMode.CONTENT&&this.menuState!==MenuState.NONE){this.close();return}if(!((_a=this.settings)===null||_a===void 0?void 0:_a.active)||this.menuState===MenuState.NONE||!this.localeData){return}switch(this.menuState){case MenuState.MAIN:return this.getMainMenu();case MenuState.LANGUAGE:return this.getLangMenu();case MenuState.QUALITY:return this.getQualityMenu()}}createDataAttributes(data){return Object.entries(data).reduce((acc,entry)=>{acc["data-".concat(entry[0])]=entry[1];return acc},{})}renderSubMenuItem(_ref7){let{label:label,data:data={},disabled:disabled=false}=_ref7;return h("button",Object.assign({class:this.menuButtonClass,type:"button",disabled:disabled,role:"menuitem","aria-haspopup":"true"},this.createDataAttributes(data)),label)}renderListItem(_ref8){let{label:label,data:data={},selected:selected=false,disabled:disabled=false}=_ref8;return h("button",Object.assign({class:this.menuButtonClass,type:"button",disabled:disabled,role:"menuitemradio","aria-checked":String(selected)},this.createDataAttributes(data)),label)}renderList(name,title,items,factory){return h("div",{class:"avia-list avia-".concat(name,"-list")},title&&h("div",{class:"avia-list-title"},title),h("div",{class:"avia-list-container"},items.map(item=>factory(item))))}renderMenu(name,title,content){clearTimeout(this.timeout);this.timeout=setTimeout(()=>{const menu=document.querySelector(".avia-".concat(name,"-menu"));const menuItem=menu===null||menu===void 0?void 0:menu.querySelector(this.menuButtonSelector);menuItem===null||menuItem===void 0?void 0:menuItem.focus()},0);return h("div",{class:"avia-settings-menu avia-".concat(name,"-menu"),role:"menu"},h("div",{class:"avia-settings-menu-header"},name!==MenuState.MAIN&&h("avia-button",{"loc-id":LocalizationId.BACK,class:"avia-settings-back",disabled:false,"data-action":MenuState.MAIN,icon:true}),h("span",null,title),h("span",{class:"avia-spacer"}),h("avia-button",{"loc-id":LocalizationId.CLOSE,class:"avia-menu-close",actions:Action.SETTINGS_OFF,disabled:false,icon:true})),h("div",{class:"avia-menu-content"},content))}getMainMenu(){var _a,_b,_c,_d;const items=[{label:this.localeData[LocalizationId.LANGUAGE],data:{action:MenuState.LANGUAGE},haspopup:true,disabled:!(((_a=this.settings.textTrackInfo)===null||_a===void 0?void 0:_a.track)||((_b=this.settings.audioTrackInfo)===null||_b===void 0?void 0:_b.track))},{label:this.localeData[LocalizationId.QUALITY],data:{action:MenuState.QUALITY},haspopup:true,disabled:!(((_d=(_c=this.settings.qualityInfo)===null||_c===void 0?void 0:_c.qualities)===null||_d===void 0?void 0:_d.length)>0)}];return this.renderMenu(MenuState.MAIN,this.localeData[LocalizationId.SETTINGS],this.renderList("settings",null,items,this.renderSubMenuItem.bind(this)))}getLangMenu(){const tInfo=this.settings.textTrackInfo;const aInfo=this.settings.audioTrackInfo;const aTrk=aInfo===null||aInfo===void 0?void 0:aInfo.track;const tTrk=tInfo===null||tInfo===void 0?void 0:tInfo.track;const aTracks=aInfo===null||aInfo===void 0?void 0:aInfo.tracks;const tTracks=tInfo===null||tInfo===void 0?void 0:tInfo.tracks;const selText=tTrk===null||tTrk===void 0?void 0:tTrk.id;const selAudio=aTrk===null||aTrk===void 0?void 0:aTrk.index;const factory=this.renderListItem.bind(this);const menus=[];if(tTracks&&tTracks.length){menus.push(this.renderList("text",this.localeData[LocalizationId.CAPTIONS],tTracks.map(track=>({selected:track.id===selText,disabled:tTracks.length===1,label:this.getLangLabel(track),data:{key:"text",value:track.id}})),factory))}if(aTracks&&aTracks.length){menus.push(this.renderList("audio",this.localeData[LocalizationId.AUDIO],aTracks.map(track=>({selected:track.index===selAudio,disabled:aTracks.length===1,label:this.getLangLabel(track),data:{key:"audio",value:track.index,description:track.type==="description"}})),factory))}return this.renderMenu(MenuState.LANGUAGE,this.localeData[LocalizationId.LANGUAGE],menus)}getQualityMenu(){const qualities=this.settings.qualityInfo.qualities;const unique=qualities.reduce((acc,qual)=>{const label=this.getQualityLabel(qual);const item=acc.find(i=>i.label===label);if(!item){acc.push({label:label,data:{key:"quality",value:qual.index,bitrate:qual.bitrate}})}else if(qual.bitrate>item.data.bitrate){item.data.value=qual.index;item.data.bitrate=qual.bitrate}return acc},[]);const disabled=unique.length===1;const items=unique.map(qual=>Object.assign(Object.assign({},qual),{selected:disabled||qual.data.index===this.qualityIndex,disabled:disabled})).sort((a,b)=>b.data.bitrate-a.data.bitrate);if(items.length>1){const autoLabel=this.getQualityLabel(this.settings.qualityInfo.quality);items.unshift({selected:this.qualityIndex===-1,disabled:false,label:"".concat(this.localeData[LocalizationId.AUTO]," (").concat(autoLabel,")"),data:{key:"quality",value:-1}})}return this.renderMenu(MenuState.QUALITY,this.localeData[LocalizationId.QUALITY],this.renderList("quality",null,items,this.renderListItem.bind(this)))}getLangLabel(track){const lang=track.language||track.lang||"";const tag=lang.split("-").shift().slice(0,2).toUpperCase();const lbl=LanguageLabel[tag];return lbl||this.localeData[LocalizationId.UNKNOWN]}getQualityLabel(quality){var _a;if((_a=quality.category)===null||_a===void 0?void 0:_a.length){return quality.category[this.qualityLabel||0]}}selectListItem(el){const sel=el.parentElement.querySelector("[aria-checked=true]");if(sel){sel.setAttribute("aria-checked",false)}el.setAttribute("aria-checked",true)}get el(){return this}static get style(){return aviaSettingsCss}};openWormhole(AviaSettings$1,["settings","localeData","qualityLabel","controlMode"]);const aviaSettingsToggleCss="avia-settings-toggle{display:inline-block;position:relative}avia-settings-toggle avia-button{background-image:var(--avia-settings-icon)}avia-settings-toggle avia-button:hover{background-image:var(--avia-settings-icon-hover)}";let AviaSettingsToggle$1=class extends H{constructor(){super();this.__registerHost();this.settingsDisabled=true;this.excludedControls=null}render(){var _a,_b;if((_a=this.excludedControls)===null||_a===void 0?void 0:_a.includes(ControlFunction.SETTINGS)){return}const toggled=((_b=this.settings)===null||_b===void 0?void 0:_b.active)===true;return h("avia-button",{actions:"".concat(Action.SETTINGS_ON,",").concat(Action.SETTINGS_OFF),disabled:this.settingsDisabled,"loc-id":LocalizationId.SETTINGS,"aria-haspopup":"true","aria-expanded":toggled?"true":"false",toggled:toggled,icon:true})}static get style(){return aviaSettingsToggleCss}};openWormhole(AviaSettingsToggle$1,["settings","settingsDisabled","excludedControls"]);const aviaSliderCss=":root{--avia-slider-height:12px;--avia-slider-color:var(--avia-accent-color);--avia-slider-handle-color:var(--avia-accent-color);--avia-slider-track-color:#444;--avia-slider-track-radius:2px;--avia-slider-value-height:4px;--avia-slider-handle-width:12px;--avia-slider-handle-height:12px;--avia-slider-handle-radius:12px}avia-slider{display:block;height:var(--avia-slider-height);cursor:pointer;position:relative}.avia-slider-track{position:absolute;width:100%;height:var(--avia-slider-value-height);top:calc( (var(--avia-slider-height) - var(--avia-slider-value-height)) * 0.5);background:var(--avia-slider-track-color);border-radius:var(--avia-slider-track-radius)}.avia-slider-value{position:absolute;height:var(--avia-slider-value-height);top:calc( (var(--avia-slider-height) - var(--avia-slider-value-height)) * 0.5);background-color:var(--avia-slider-color);border-radius:var(--avia-slider-track-radius)}.avia-slider-handle{position:absolute;top:calc((var(--avia-slider-handle-height) - var(--avia-slider-height)) / -2);width:var(--avia-slider-handle-width);height:var(--avia-slider-handle-height);margin-left:calc(var(--avia-slider-handle-width) / -2);background-color:var(--avia-slider-handle-color);border-radius:var(--avia-slider-handle-radius);cursor:pointer;border:0;padding:0;outline:none}.avia-slider-list{position:absolute;width:100%;height:var(--avia-slider-value-height);top:calc( (var(--avia-slider-height) - var(--avia-slider-value-height)) * 0.5);background:transparent}.avia-slider-list-item{background-color:var(--avia-segment-marker-color);width:var(--avia-segment-marker-width);height:var(--avia-segment-marker-height);position:absolute;top:0}avia-slider:focus,avia-slider.focus-visible{outline:none}avia-slider.focus-visible .avia-slider-handle{box-shadow:var(--avia-focus-box-shadow)}avia-slider:focus,avia-slider .focus-visible{box-shadow:none}";let AviaSlider$1=class extends H{constructor(){super();this.__registerHost();this.changeEvent=createEvent(this,"change",7);this.inputEvent=createEvent(this,"input",7);this.draggingEvent=createEvent(this,"dragging",7);this.min=0;this.max=1;this.value=1;this.list=[];this.increment=.1;this.valueInternal=this.value;this.dragging=false;this.focused=false}onValueChange(value){if(this.dragging){return}if(value<this.min){this.value=this.min;return}if(value>this.max){this.value=this.max;return}this.valueInternal=value}onMinChange(value){this.value=mapToRange(this.value,0,1,value,this.max)}onMaxChange(value){this.value=mapToRange(this.value,0,1,this.min,value)}onListChange(value){if(value){return}this.list=[]}onMouseDown(event){if(event.which>1||event.button>0){return}blockEvent(event);this.dragging=true;this.draggingEvent.emit({value:true});this.move(event)}onMouseMove(event){if(!this.dragging){return}blockEvent(event);this.move(event)}onMouseUp(event){if(this.dragging){blockEvent(event);this.dragging=false;this.draggingEvent.emit({value:false});this.move(event);this.change(this.valueInternal)}}onFocus(){if(!this.el.classList.contains("focus-visible")){return}this.focused=true}onBlur(){if(!this.focused){return}this.focused=false}onKeydown(event){const code=event.keyCode;const action=v=>{const value=this.value+=v;this.input(value);this.change(value);blockEvent(event)};switch(code){case 38:case 39:case 33:action(this.increment);break;case 37:case 40:case 34:action(-this.increment);break}}onKeyup(event){const code=event.keyCode;if([33,34,37,38,39,40].indexOf(code)!==-1){blockEvent(event)}}move(event){const offset=this.el.getBoundingClientRect();const pos=getEventPos(event);const percent=clampValue((pos.x-offset.left)/offset.width,0,1);const value=mapToRange(percent,0,1,this.min,this.max);this.input(value)}toPercent(value){return toCssPercent(mapToRange(value,this.min,this.max))}input(v){const previous=this.valueInternal;const value=clampValue(v,this.min,this.max);this.valueInternal=value;this.inputEvent.emit({value:value,previous:previous})}change(v){const previous=this.value;const value=clampValue(v,this.min,this.max);this.valueInternal=value;this.value=value;this.changeEvent.emit({value:value,previous:previous})}render(){var _a;const percent=this.toPercent(this.valueInternal);const ariaLabel=(_a=this.localeData)===null||_a===void 0?void 0:_a[this.locId];return h(Host,{className:"avia-slider",role:"slider","aria-label":ariaLabel,"aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":this.value,"aria-valuetext":this.ariaValuetext||percent,tabIndex:0},h("div",{class:"avia-slider-track"}),h("div",{class:"avia-slider-value",style:{width:percent}}),h("div",{class:"avia-slider-list"},this.list.map(item=>h("div",{class:"avia-slider-list-item",style:{left:this.toPercent(item.value)}}))),h("slot",null),h("button",{class:"avia-slider-handle",type:"button",style:{left:percent},tabIndex:-1}))}get el(){return this}static get watchers(){return{value:["onValueChange"],min:["onMinChange"],max:["onMaxChange"],list:["onListChange"]}}static get style(){return aviaSliderCss}};openWormhole(AviaSlider$1,["localeData"]);const aviaSpinnerCss="avia-spinner{display:block;width:var(--avia-spinner-diameter);height:var(--avia-spinner-diameter);overflow:visible;background-size:var(--avia-spinner-diameter);background-repeat:no-repeat;background-image:var(--avia-spinner-image);animation:avia-rotate 2s linear infinite}@keyframes avia-rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}";let AviaSpinner$1=class extends H{constructor(){super();this.__registerHost()}render(){return h(Host,null)}static get style(){return aviaSpinnerCss}};const aviaTextCss="avia-text{color:var(--avia-control-bar-btn-text-color)}";let AviaText$1=class extends H{constructor(){super();this.__registerHost()}render(){var _a;return h(Host,null,(_a=this.localeData)===null||_a===void 0?void 0:_a[this.locId])}static get style(){return aviaTextCss}};openWormhole(AviaText$1,["localeData"]);const aviaTextToggleCss="avia-text-toggle{display:inline-block}avia-text-toggle avia-button{background-image:var(--avia-text-on-icon)}avia-text-toggle avia-button:hover{background-image:var(--avia-text-on-icon-hover)}avia-text-toggle avia-button[toggled]{background-image:var(--avia-text-off-icon)}avia-text-toggle avia-button[toggled]:hover{background-image:var(--avia-text-off-icon-hover)}";let AviaTextToggle$1=class extends H{constructor(){super();this.__registerHost();this.textTrackEnabled=false;this.textDisabled=true;this.excludedControls=null}render(){var _a;if((_a=this.excludedControls)===null||_a===void 0?void 0:_a.includes(ControlFunction.TEXT)){return}return h("avia-button",{ids:"".concat(LocalizationId.CLOSED_CAPTIONS_ON,", ").concat(LocalizationId.CLOSED_CAPTIONS_OFF),actions:"".concat(Action.TEXT_ON,", ").concat(Action.TEXT_OFF),disabled:this.textDisabled,toggled:this.textTrackEnabled,icon:true})}static get style(){return aviaTextToggleCss}};openWormhole(AviaTextToggle$1,["textTrackEnabled","textDisabled","excludedControls"]);const aviaTimeDisplayCss="avia-time-display{display:inline-block;margin-right:var(--avia-default-spacing)}.avia-time-display{display:inline-block;user-select:none;height:var(--avia-time-height);line-height:var(--avia-time-line-height);font-size:var(--avia-time-font-size);color:var(--avia-time-color);font-family:var(--avia-time-font-family)}.avia-control-group-right .avia-time-display{text-align:right}";let AviaTimeDisplay$1=class extends H{constructor(){super();this.__registerHost();this.isLiveLinear=false;this.isDvr=false}render(){const inactive=this.isLiveLinear||this.isDvr;if(inactive){return""}return h("div",{class:"avia-time-display"},this.timeDisplayValue)}static get style(){return aviaTimeDisplayCss}};openWormhole(AviaTimeDisplay$1,["timeDisplayValue","currentTimeSeconds","durationSeconds","isLiveLinear","isDvr"]);const aviaUiCss=":root{--avia-accent-color:#3aacff;--avia-text-color:#dedede;--avia-text-color-hover:#ffffff;--avia-font-family:Arial, sans-serif;--avia-control-bar-bg:linear-gradient(to top, rgba(2,0,36,0.8) 0%, rgba(1,0,10,0.5029586834733894) 62%, rgba(0,0,0,0) 100%);--avia-control-bar-height:64px;--avia-default-spacing:12px;--avia-half-spacing:6px;--avia-live-padding-top:12px;--avia-compact-button-width:48px;--avia-compact-button-height:48px;--avia-compact-button-border-radius:calc(var(--avia-compact-button-width) / 2);--avia-compact-button-background-color:rgba(64, 64, 64, 0.5);--avia-compact-control-bar-width:calc( (var(--avia-compact-button-width) * 3) + (var(--avia-default-spacing) * 2));--avia-compact-control-bar-margin-left:calc(var(--avia-compact-control-bar-width) / -2);--avia-compact-control-bar-margin-top:calc(var(--avia-compact-button-height) / -2);--avia-play-overlay-bg-color:rgba(0, 0, 0, 0.35);--avia-play-cta-width:66px;--avia-play-cta-height:66px;--avia-play-cta-border-radius:calc(var(--avia-play-cta-width) / 2);--avia-play-cta-bg-image:var(--avia-play-icon);--avia-play-cta-bg-position:50%;--avia-play-cta-bg-color:rgba(64, 64, 64, 0.5);--avia-play-cta-bg-size:calc(var(--avia-play-cta-width) / 2) calc(var(--avia-play-cta-height) / 2);--avia-control-bar-btn-height:48px;--avia-control-bar-btn-width:48px;--avia-control-bar-btn-text-color:var(--avia-text-color);--avia-control-bar-btn-text-color-hover:var(--avia-text-color-hover);--avia-control-bar-btn-border:none;--avia-control-bar-btn-border-width:0;--avia-control-bar-btn-border-radius:0;--avia-control-bar-btn-border-outline:none;--avia-control-bar-btn-border-cursor:pointer;--avia-control-bar-btn-disabled-cursor:not-allowed;--avia-control-bar-btn-disabled-opacity:0.5;--avia-icon-btn-bg-width:50%;--avia-icon-btn-bg-height:37.5%;--avia-icon-btn-bg-size:var(--avia-icon-btn-bg-width) var(--avia-icon-btn-bg-height);--avia-fs-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M1%207a1%201%200%200%201-1-1V1a1%201%200%200%201%201-1h5a1%201%200%200%201%200%202H2.5a.5.5%200%200%200-.5.5V6a1%201%200%200%201-1%201zM6%2018H1a1%201%200%200%201-1-1v-5a1%201%200%200%201%202%200v3.5a.5.5%200%200%200%20.5.5H6a1%201%200%200%201%200%202zM23%2018h-5a1%201%200%200%201%200-2h3.5a.5.5%200%200%200%20.5-.5V12a1%201%200%200%201%202%200v5a1%201%200%200%201-1%201zM23%207a1%201%200%200%201-1-1V2.5a.5.5%200%200%200-.5-.5H18a1%201%200%200%201%200-2h5a1%201%200%200%201%201%201v5a1%201%200%200%201-1%201z%22%2F%3E%3C%2Fsvg%3E');--avia-fs-icon-hover:var(--avia-fs-icon);--avia-fs-exit-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M4%206H1a1%201%200%200%201%200-2h2.5a.5.5%200%200%200%20.5-.5V1a1%201%200%200%201%202%200v3a2%202%200%200%201-2%202zM23%206h-4a1%201%200%200%201-1-1V1a1%201%200%200%201%202%200v2.5a.5.5%200%200%200%20.5.5H23a1%201%200%200%201%200%202zM19%2018a1%201%200%200%201-1-1v-3a2%202%200%200%201%202-2h3a1%201%200%200%201%200%202h-2.5a.5.5%200%200%200-.5.5V17a1%201%200%200%201-1%201zM5%2018a1%201%200%200%201-1-1v-2.5a.5.5%200%200%200-.5-.5H1a1%201%200%200%201%200-2h3a2%202%200%200%201%202%202v3a1%201%200%200%201-1%201z%22%2F%3E%3C%2Fsvg%3E');--avia-fs-exit-icon-hover:var(--avia-fs-exit-icon);--avia-play-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Ctitle%3EPlay%3C%2Ftitle%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M19%2010L6.84%2017.81a1.19%201.19%200%200%201-1.84-1V1.19a1.19%201.19%200%200%201%201.83-1L19%208a1.19%201.19%200%200%201%200%202z%22%2F%3E%3C%2Fsvg%3E');--avia-play-icon-hover:var(--avia-play-icon);--avia-pause-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Ctitle%3EPause%3C%2Ftitle%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Crect%20x%3D%226%22%20width%3D%224%22%20height%3D%2218%22%20rx%3D%221%22%2F%3E%3Crect%20x%3D%2214%22%20width%3D%224%22%20height%3D%2218%22%20rx%3D%221%22%2F%3E%3C%2Fsvg%3E');--avia-pause-icon-hover:var(--avia-pause-icon);--avia-stop-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Ctitle%3EStop%3C%2Ftitle%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Crect%20x%3D%223%22%20width%3D%2218%22%20height%3D%2218%22%20rx%3D%221%22%2F%3E%3C%2Fsvg%3E');--avia-stop-icon-hover:var(--avia-stop-icon);--avia-mute-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M3.58%206H2a1%201%200%200%200-1%201v4a1%201%200%200%200%201%201h1.58a1%201%200%200%201%20.72.3l5%205a1%201%200%200%200%201.7-.74V1.44A1%201%200%200%200%209.27.73l-5%205a1%201%200%200%201-.69.27zM19.77%209.33a.5.5%200%200%201%200-.71l.94-.94a1%201%200%200%200%200-1.41%201%201%200%200%200-1.42%200l-.94.94a.5.5%200%200%201-.7%200l-.94-.94a1%201%200%200%200-1.42%200%201%201%200%200%200%200%201.41l.94.94a.5.5%200%200%201%200%20.71l-.94.94a1%201%200%200%200%200%201.41%201%201%200%200%200%201.42%200l.94-.94a.5.5%200%200%201%20.7%200l.94.94a1%201%200%200%200%201.42%200%201%201%200%200%200%200-1.41z%22%2F%3E%3C%2Fsvg%3E');--avia-mute-icon-hover:var(--avia-mute-icon);--avia-unmuted-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M3.59%206H2a1%201%200%200%200-1%201v4a1%201%200%200%200%201%201h1.59a1%201%200%200%201%20.7.29l5%205a1%201%200%200%200%201.71-.7V1.41a1%201%200%200%200-1.71-.7l-5%205a1%201%200%200%201-.7.29zM14%2018a1%201%200%200%201%200-2%207%207%200%200%200%200-14%201%201%200%200%201%200-2%209%209%200%200%201%200%2018z%22%2F%3E%3Cpath%20d%3D%22M14%2014a1%201%200%200%201%200-2%203%203%200%200%200%200-6%201%201%200%200%201%200-2%205%205%200%200%201%200%2010z%22%2F%3E%3C%2Fsvg%3E');--avia-unmuted-icon-hover:var(--avia-unmuted-icon);--avia-text-on-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cdefs%3E%3Cstyle%3E.b%7Bfill%3Anone%3Bstroke%3A%23fff%3Bstroke-linecap%3Around%3Bstroke-miterlimit%3A10%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cpath%20d%3D%22M23%200H1a1%201%200%2000-1%201v12a1%201%200%20001%201h2.5a.5.5%200%2001.5.5V17a1%201%200%2000.62.92A.84.84%200%20005%2018a1%201%200%2000.71-.29l3.56-3.56a.47.47%200%2001.35-.15H23a1%201%200%20001-1V1a1%201%200%2000-1-1zm-1%2011a1%201%200%2001-1%201H9a1%201%200%2000-.71.29L6%2014.59V13a1%201%200%2000-1-1H3a1%201%200%2001-1-1V3a1%201%200%20011-1h18a1%201%200%20011%201z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20class%3D%22b%22%20d%3D%22M4.5%206.5h5M16.5%206.5h3M12.5%206.5h1M4.5%209.5h3M18.5%209.5h1M10.5%209.5h5%22%2F%3E%3C%2Fsvg%3E');--avia-text-on-icon-hover:var(--avia-text-on-icon);--avia-text-off-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cdefs%3E%3Cstyle%3E.b%7Bfill%3Anone%3Bstroke%3A%23231f20%3Bstroke-linecap%3Around%3Bstroke-miterlimit%3A10%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cpath%20d%3D%22M23%200H1a1%201%200%2000-1%201v12a1%201%200%20001%201h2.5a.5.5%200%2001.5.5V17a1%201%200%2000.62.92A.84.84%200%20005%2018a1%201%200%2000.71-.29l3.56-3.56a.47.47%200%2001.35-.15H23a1%201%200%20001-1V1a1%201%200%2000-1-1z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20class%3D%22b%22%20d%3D%22M4.5%206.5h5M16.5%206.5h3M12.5%206.5h1M4.5%209.5h3M18.5%209.5h1M10.5%209.5h5%22%2F%3E%3C%2Fsvg%3E');--avia-text-off-icon-hover:var(--avia-text-off-icon);--avia-text-icon-disabled:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cdefs%3E%3Cstyle%3E.b%7Bfill%3Anone%3Bstroke%3A%23fff%3Bstroke-linecap%3Around%3Bstroke-miterlimit%3A10%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cpath%20d%3D%22M23%200H1a1%201%200%2000-1%201v12a1%201%200%20001%201h2.5a.5.5%200%2001.5.5V17a1%201%200%2000.62.92A.84.84%200%20005%2018a1%201%200%2000.71-.29l3.56-3.56a.47.47%200%2001.35-.15H23a1%201%200%20001-1V1a1%201%200%2000-1-1zm-1%2011a1%201%200%2001-1%201H9a1%201%200%2000-.71.29L6%2014.59V13a1%201%200%2000-1-1H3a1%201%200%2001-1-1V3a1%201%200%20011-1h18a1%201%200%20011%201z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20class%3D%22b%22%20d%3D%22M4.5%206.5h5M16.5%206.5h3M12.5%206.5h1M4.5%209.5h3M18.5%209.5h1M10.5%209.5h5%22%2F%3E%3C%2Fsvg%3E');--avia-seek-forward-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2015.52%2017.29%22%3E%3Cpath%20d%3D%22M14.69%2C1.16%2C14%2C1.8A8.76%2C8.76%2C0%2C0%2C0%2C1.81%2C3.37%2C8.59%2C8.59%2C0%2C0%2C0%2C3.39%2C15.49a8.77%2C8.77%2C0%2C0%2C0%2C11.5-.74A1%2C1%2C0%2C0%2C0%2C15%2C13.4a1%2C1%2C0%2C0%2C0-1.36-.11l-.11.11a6.81%2C6.81%2C0%2C0%2C1-9.58%2C0%2C6.69%2C6.69%2C0%2C0%2C1-.06-9.51%2C6.82%2C6.82%2C0%2C0%2C1%2C8.73-.77L11.8%2C4a.47.47%2C0%2C0%2C0%2C0%2C.67.5.5%2C0%2C0%2C0%2C.37.15H15a.49.49%2C0%2C0%2C0%2C.49-.48V1.49a.47.47%2C0%2C0%2C0-.83-.33Z%22%20style%3D%22fill%3A%23fff%22%2F%3E%3C%2Fsvg%3E');--avia-seek-forward-icon-hover:var(--avia-seek-forward-icon);--avia-seek-back-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2015.52%2017.29%22%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill%3A%23fff%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22Layer_2%22%20data-name%3D%22Layer%202%22%3E%3Cpath%20class%3D%22cls-1%22%20d%3D%22M.46%2C1A.48.48%2C0%2C0%2C0%2C0%2C1.49V4.33a.49.49%2C0%2C0%2C0%2C.48.48h2.9a.51.51%2C0%2C0%2C0%2C.37-.15.48.48%2C0%2C0%2C0%2C0-.67L2.9%2C3.17a6.82%2C6.82%2C0%2C0%2C1%2C8.73.77%2C6.69%2C6.69%2C0%2C0%2C1-.05%2C9.51A6.82%2C6.82%2C0%2C0%2C1%2C2%2C13.4a.52.52%2C0%2C0%2C0-.1-.11%2C1%2C1%2C0%2C0%2C0-1.37.11%2C1%2C1%2C0%2C0%2C0%2C.11%2C1.35%2C8.76%2C8.76%2C0%2C0%2C0%2C11.49.74A8.59%2C8.59%2C0%2C0%2C0%2C13.7%2C3.37%2C8.76%2C8.76%2C0%2C0%2C0%2C1.48%2C1.8L.82%2C1.16A.45.45%2C0%2C0%2C0%2C.46%2C1Z%22%20transform%3D%22translate(0%200)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E');--avia-seek-back-icon-hover:var(--avia-seek-back-icon);--avia-settings-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22white%22%20viewBox%3D%220%200%2024%2018%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h24v18H0z%22%2F%3E%3Cpath%20d%3D%22M20.43%2010.4l-.93-.53a1%201%200%200%201%200-1.74l.93-.53a1%201%200%200%200%20.36-1.37l-2-3.46a1%201%200%200%200-1.36-.37l-.93.54a1%201%200%200%201-1.5-.87V1a1%201%200%200%200-1-1h-4a1%201%200%200%200-1%201v1.07a1%201%200%200%201-1.5.87l-.93-.54a1%201%200%200%200-1.36.37l-2%203.46a1%201%200%200%200%20.36%201.37l.93.53a1%201%200%200%201%200%201.74l-.93.53a1%201%200%200%200-.36%201.37l2%203.46a1%201%200%200%200%201.36.37l.93-.54a1%201%200%200%201%201.5.87V17a1%201%200%200%200%201%201h4a1%201%200%200%200%201-1v-1.07a1%201%200%200%201%201.5-.87l.93.54a1%201%200%200%200%201.36-.37l2-3.46a1%201%200%200%200-.36-1.37zM12%2012a3%203%200%201%201%203-3%203%203%200%200%201-3%203z%22%2F%3E%3C%2Fsvg%3E');--avia-settings-icon-hover:var(--avia-settings-icon);--avia-selected-icon:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%3E%3Cpath%20d%3D%22M20.285%202l-11.285%2011.567-5.286-5.011-3.714%203.716%209%208.728%2015-15.285z%22%2F%3E%3C%2Fsvg%3E');--avia-time-height:48px;--avia-time-width:86px;--avia-time-line-height:48px;--avia-time-font-size:13px;--avia-time-color:var(--avia-text-color);--avia-time-font-family:var(--avia-font-family);--avia-segment-marker-color:var(--avia-text-color);--avia-segment-marker-height:4px;--avia-segment-marker-width:2px;--avia-ad-progress-color:#ffe83a;--avia-ad-progress-track-color:transparent;--avia-ad-control-bg-color:rgba(0, 0, 0, 0.7);--avia-ad-control-border-radius:4px;--avia-seek-indicator-border-radius:4px;--avia-seek-indicator-background-color:rgba(0, 0, 0, 0.5);--avia-seek-indicator-color:var(--avia-text-color);--avia-seek-indicator-height:48px;--avia-seek-indicator-font-size:20px;--avia-seek-indicator-font-family:var(--avia-font-family);--avia-seek-indicator-line-height:48px;--avia-volume-indicator-border-radius:6px;--avia-volume-indicator-background-color:rgba(0, 0, 0, 0.5);--avia-volume-indicator-width:64px;--avia-volume-indicator-height:64px;--avia-volume-indicator-right:12px;--avia-volume-indicator-bottom:72px;--avia-focus-box-shadow:0 0 2px 3px rgba(247, 228, 85, 0.85);--avia-focus-box-shadow-inner:inset 0 0 2px 3px rgba(247, 228, 85, 0.85);--avia-spinner-image:url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" stroke=\"white\" stroke-width=\"1\" width=\"40\" height=\"40\" fill=\"white\" viewBox=\"0 0 37.84 41\"><path d=\"M18,39.61V32.09a.93.93,0,0,1,.26-.66.85.85,0,0,1,.64-.27.83.83,0,0,1,.63.27.89.89,0,0,1,.26.66v7.52a.91.91,0,0,1-.89.89.85.85,0,0,1-.64-.27.87.87,0,0,1-.26-.62Zm-6.4-10.27a.89.89,0,0,1,.59-.37.82.82,0,0,1,.65.16.79.79,0,0,1,.36.59.94.94,0,0,1-.15.69L8.8,36.47a.8.8,0,0,1-.57.38,1,1,0,0,1-.67-.16.84.84,0,0,1-.36-.59,1,1,0,0,1,.16-.7ZM1.13,25.53,8,23.21a.92.92,0,0,1,.67.05.93.93,0,0,1,.4,1.23,1,1,0,0,1-.52.47L1.64,27.27A.87.87,0,0,1,1,27.22a.82.82,0,0,1-.43-.53,1,1,0,0,1,0-.72.81.81,0,0,1,.54-.44Zm.51-11.8L8.56,16a1,1,0,0,1,.52.47.93.93,0,0,1-.4,1.23.92.92,0,0,1-.67.05L1.13,15.47A.81.81,0,0,1,.59,15a1,1,0,0,1,0-.72A.82.82,0,0,1,1,13.78a.87.87,0,0,1,.67,0ZM8.8,4.53l4.27,6.06a.94.94,0,0,1,.15.69.79.79,0,0,1-.36.59.82.82,0,0,1-.65.16.89.89,0,0,1-.59-.37L7.36,5.6a1,1,0,0,1-.16-.7.84.84,0,0,1,.36-.59,1,1,0,0,1,.67-.16.8.8,0,0,1,.57.38Zm11-3.14V8.91a.89.89,0,0,1-.26.66.83.83,0,0,1-.63.27.85.85,0,0,1-.64-.27A.93.93,0,0,1,18,8.91V1.39a.87.87,0,0,1,.26-.62A.85.85,0,0,1,18.92.5a.83.83,0,0,1,.63.27.83.83,0,0,1,.26.62ZM30.48,5.6l-4.27,6.06a.87.87,0,0,1-.58.37.85.85,0,0,1-.66-.16.86.86,0,0,1-.36-.59,1,1,0,0,1,.16-.69L29,4.53a.76.76,0,0,1,.56-.38.94.94,0,0,1,.67.16.86.86,0,0,1,.37.59,1,1,0,0,1-.16.7Zm6.23,9.87-6.88,2.32a.91.91,0,0,1-.67-.05.93.93,0,0,1-.4-1.23,1,1,0,0,1,.52-.47l6.91-2.31a.87.87,0,0,1,.67,0,.83.83,0,0,1,.44.53,1,1,0,0,1-.06.72.79.79,0,0,1-.53.44Zm-.52,11.8L29.28,25a1,1,0,0,1-.52-.47.93.93,0,0,1,.4-1.23.91.91,0,0,1,.67-.05l6.88,2.32a.79.79,0,0,1,.53.44,1,1,0,0,1,.06.72.83.83,0,0,1-.44.53.87.87,0,0,1-.67.05ZM29,36.47l-4.27-6.06a1,1,0,0,1-.16-.69.86.86,0,0,1,.36-.59.85.85,0,0,1,.66-.16.87.87,0,0,1,.58.37l4.27,6.06a1,1,0,0,1,.16.7.86.86,0,0,1-.37.59.94.94,0,0,1-.67.16.76.76,0,0,1-.56-.38Z\"/></svg>');--avia-spinner-diameter:48px;--avia-active-transition-in:opacity 0.5s ease 0s;--avia-active-transition-out:opacity 0.5s ease 0s}avia-ui{color:var(--avia-text-color);font-family:var(--avia-font-family)}avia-ui>*{pointer-events:auto;-webkit-user-select:none;user-select:none}avia-ui,avia-ui avia-accessibility,avia-ui avia-settings,.avia-layer{pointer-events:none;position:absolute;top:0;left:0;bottom:0;right:0}slot-fb[hidden]{display:none}.avia-ui-hidden{display:none}img.avia-poster-img{width:100%;height:auto}.avia-container,avia-ui:focus,avia-ui button:focus{outline:none}avia-ui.focus-visible,avia-ui .focus-visible{box-shadow:var(--avia-focus-box-shadow)}avia-ui.focus-visible .avia-menu-button,avia-ui .focus-visible.avia-menu-button{box-shadow:var(--avia-focus-box-shadow-inner)}avia-ui:not([active])[fullscreen]{cursor:none}.avia-container.avia-controls-vis video::-webkit-media-text-track-container{bottom:calc(var(--avia-control-bar-height) + 4px);height:auto}";let AviaUi$1=class extends H{constructor(){super();this.__registerHost();this.actionEvent=createEvent(this,"uiaction",7);this.controlMode=ControlMode.NONE;this.fullscreen=false;this.active=null;this.activeMode=ActiveMode.AUTO;this.excludedControls=null;this.fullscreenDisabled=true;this.muted=false;this.muteDisabled=true;this.volume=1;this.playing=false;this.playDisabled=true;this.textTrackEnabled=false;this.textDisabled=true;this.timeDisplayValue="";this.isLiveLinear=false;this.isDvr=false;this.live=false;this.playheadPosition=0;this.durationSeconds=0;this.currentTimeSeconds=0;this.seekDisabled=true;this.seekBackDisabled=true;this.seekForwardDisabled=true;this.settingsDisabled=true;this.adPlayheadPosition=0;this.localeData=null;this.preview=null;this.unmuteCtaVisible=false;this.settings=null;this.posterActive=false;this.posterImageUrl="";this.qualityLabel=0;this.waiting=false;this.initialized=false;this.pausable=true;this.isTouch=false}handleAction(e){this.actionEvent.emit(e.detail)}componentWillLoad(){Universe.create(this,this)}render(){if(!this.initialized){return}return h(Host,null,h(Universe.Provider,{state:this},h("div",{class:"avia-layer"},h("slot",{name:"underlay"})),h("slot",{name:"play-overlay"},h("avia-play-overlay",null)),h("slot",{name:"waiting-overlay"},h("avia-waiting-overlay",null)),h("slot",{name:"unmute-cta"},h("avia-unmute-cta",null)),h("slot",{name:"accessibility"},h("avia-accessibility",null)),h("slot",{name:"settings"},h("avia-settings",null)),h("slot",{name:"poster"},h("avia-poster",null)),h("slot",{name:"control-bar"},h("avia-control-bar",null)),h("slot",{name:"ad-control-bar"},h("avia-ad-control-bar",null)),h("slot",{name:"compact-control-bar"},h("avia-control-bar-compact",null)),h("div",{class:"avia-layer"},h("slot",{name:"overlay"}))))}static get style(){return aviaUiCss}};const aviaUnmuteCtaCss="avia-unmute-cta{box-sizing:border-box;display:inline-block;position:absolute;top:64px;height:var(--avia-control-bar-btn-height);left:var(--avia-default-spacing);pointer-events:auto;background-color:rgba(0, 0, 0, 0.415);border-radius:4px;opacity:1}avia-unmute-cta avia-button{background-image:var(--avia-mute-icon);background-position:-31px center;background-repeat:no-repeat;background-size:60% 45%;line-height:var(--avia-control-bar-btn-height);padding-right:var(--avia-default-spacing);padding-left:50px;font-size:1.1em;text-align:left;width:auto;height:var(--avia-control-bar-btn-height);color:white;cursor:pointer;opacity:0.85}avia-unmute-cta avia-button:hover{background-image:var(--avia-mute-icon-hover)}";let AviaUnmuteCta$1=class extends H{constructor(){super();this.__registerHost();this.muteState=false;this.unmuteCtaVisible=false}render(){if(!this.unmuteCtaVisible||!this.muteState){return""}return h("avia-button",{actions:Action.UNMUTE},h("avia-text",{"loc-id":LocalizationId.CLICK_TO_UNMUTE}))}static get style(){return aviaUnmuteCtaCss}};openWormhole(AviaUnmuteCta$1,["muteState","unmuteCtaVisible"]);const aviaVolumeIndicatorCss="avia-volume-indicator{position:absolute;display:block;box-sizing:border-box;border-radius:var(--avia-volume-indicator-border-radius);background-color:var(--avia-volume-indicator-background-color);width:0;height:0;right:var(--avia-volume-indicator-right);bottom:var(--avia-volume-indicator-bottom);visibility:hidden;padding-top:48px;opacity:0;transition-property:opacity;transition-duration:300ms;transition-timing-function:ease-in;box-shadow:0px 0px 1px 1px rgba(0, 0, 0, 0.3)}avia-volume-indicator:empty{opacity:0}.avia-acc-vol{width:48px;margin:0 auto;background-color:black;height:4px;position:relative}.avia-acc-vol-meter{height:4px;background-color:#fff}.avia-vol-meter-overlay{position:absolute;top:0;left:0;height:4px;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAFElEQVQImWNAA/+Z0EUICDAwMAAANNwBBuf8FlcAAAAASUVORK5CYII=');width:100%}avia-volume-indicator.avia-indicator-active{width:var(--avia-volume-indicator-width);height:var(--avia-volume-indicator-height);opacity:1.0}avia-volume-indicator.avia-volume-on::before,avia-volume-indicator.avia-volume-off::before{content:\"\";position:absolute;top:0px;right:0px;bottom:0px;left:0px;opacity:0.85;background-repeat:no-repeat;background-position:center 12px;background-size:40% 30%}avia-volume-indicator.avia-volume-on::before{background-image:var(--avia-unmuted-icon)}avia-volume-indicator.avia-volume-on::before:hover{background-image:var(--avia-unmuted-icon-hover)}avia-volume-indicator.avia-volume-off::before{background-image:var(--avia-mute-icon)}avia-volume-indicator.avia-volume-off::before:hover{background-image:var(--avia-mute-icon-hover)}";let AviaVolumeIndicator$1=class extends H{constructor(){super();this.__registerHost()}componentDidRender(){var _a;if(!this.debouncer&&this.accIndicatorState.displayTime>0){this.debouncer=debounce(()=>{var _a;(_a=this.el)===null||_a===void 0?void 0:_a.classList.remove(CssNames.INDICATOR_ACTIVE);this.visible=false},this.accIndicatorState.displayTime)}if(this.visible){setTimeout(()=>this.el.classList.add(CssNames.INDICATOR_ACTIVE),0);(_a=this.debouncer)===null||_a===void 0?void 0:_a.call(this)}}render(){var _a;const acc=this.accIndicatorState;if(!acc.volumeKey){(_a=this.el)===null||_a===void 0?void 0:_a.classList.remove(CssNames.INDICATOR_ACTIVE);this.visible=false;return""}this.visible=true;const vol=this.volume===0?0:clampValue(this.volume,0,1);return h(Host,{class:acc.muted||this.volume===0?CssNames.ACC_VOL_OFF:CssNames.ACC_VOL_ON},h("div",{class:CssNames.ACC_VOL},h("div",{class:CssNames.ACC_VOL_METER,style:{width:toCssPercent(vol)}}),h("div",{class:CssNames.ACC_VOL_OVERLAY})))}get el(){return this}static get style(){return aviaVolumeIndicatorCss}};openWormhole(AviaVolumeIndicator$1,["volume","accIndicatorState"]);const aviaVolumeSliderCss="avia-volume-slider{display:flex;width:100px;margin-left:var(--avia-default-spacing)}avia-volume-slider avia-slider{width:100%;margin-top:-4px}";let AviaVolumeSlider$1=class extends H{constructor(){super();this.__registerHost();this.changeEvent=createEvent(this,"action",7);this.excludedControls=null}onInput(e){this.changeEvent.emit({action:Action.VOLUME,value:e.detail.value})}onDragging(e){if(e.detail.value!==true){return}this.changeEvent.emit({action:Action.UNMUTE,value:true})}render(){var _a;if((_a=this.excludedControls)===null||_a===void 0?void 0:_a.includes(ControlFunction.VOLUME)){return}return h("avia-slider",{"loc-id":LocalizationId.VOLUME,value:this.volume,onInput:e=>this.onInput(e),onDragging:e=>this.onDragging(e)})}static get style(){return aviaVolumeSliderCss}};openWormhole(AviaVolumeSlider$1,["volume","excludedControls"]);const aviaWaitingOverlayCss="avia-waiting-overlay{display:block;justify-content:center;align-items:center;display:flex}avia-waiting-overlay slot-fb:not(:empty)~avia-spinner{display:none}";let AviaWaitingOverlay$1=class extends H{constructor(){super();this.__registerHost();this.waiting=false}render(){if(!this.waiting){return}return h("avia-overlay",{centered:true},h("avia-spinner",null))}static get style(){return aviaWaitingOverlayCss}};openWormhole(AviaWaitingOverlay$1,["waiting"]);const AviaAccessibility=proxyCustomElement(AviaAccessibility$1,[0,"avia-accessibility"]);const AviaActive=proxyCustomElement(AviaActive$1,[4,"avia-active"]);const AviaAdControlBar=proxyCustomElement(AviaAdControlBar$1,[0,"avia-ad-control-bar"]);const AviaAdProgressBar=proxyCustomElement(AviaAdProgressBar$1,[0,"avia-ad-progress-bar",{adPlayheadPosition:[2,"ad-playhead-position"],isLiveLinear:[4,"is-live-linear"]}]);const AviaButton=proxyCustomElement(AviaButton$1,[4,"avia-button",{locId:[513,"loc-id"],toggled:[516],compact:[516],icon:[516],variant:[516],actions:[1],ids:[513],disabled:[4],localeData:[16],focused:[32]},[[0,"click","onClick"],[1,"touchstart","onTouchStart"],[1,"touchend","onTouchEnd"],[0,"focus","onFocus"],[0,"blur","onBlur"],[0,"keyup","onKeyDown"]]]);const AviaControlBar=proxyCustomElement(AviaControlBar$1,[4,"avia-control-bar",{isLiveLinear:[4,"is-live-linear"],controlMode:[1,"control-mode"]}]);const AviaControlBarCompact=proxyCustomElement(AviaControlBarCompact$1,[4,"avia-control-bar-compact"]);const AviaCurrentTime=proxyCustomElement(AviaCurrentTime$1,[0,"avia-current-time",{currentTimeSeconds:[2,"current-time-seconds"],localeData:[16],isLiveLinear:[4,"is-live-linear"],isDvr:[4,"is-dvr"]}]);const AviaDuration=proxyCustomElement(AviaDuration$1,[0,"avia-duration",{durationSeconds:[2,"duration-seconds"],localeData:[16],isLiveLinear:[4,"is-live-linear"],isDvr:[4,"is-dvr"]}]);const AviaFullscreenToggle=proxyCustomElement(AviaFullscreenToggle$1,[0,"avia-fullscreen-toggle",{fullscreen:[4],fullscreenDisabled:[4,"fullscreen-disabled"],compact:[516]}]);const AviaLiveControl=proxyCustomElement(AviaLiveControl$1,[0,"avia-live-control",{isLiveLinear:[4,"is-live-linear"],isDvr:[4,"is-dvr"],live:[4]}]);const AviaMuteToggle=proxyCustomElement(AviaMuteToggle$1,[0,"avia-mute-toggle",{muted:[4],muteDisabled:[4,"mute-disabled"],compact:[516]}]);const AviaOverlay=proxyCustomElement(AviaOverlay$1,[4,"avia-overlay",{centered:[516]}]);const AviaPlayCta=proxyCustomElement(AviaPlayCta$1,[0,"avia-play-cta"]);const AviaPlayOverlay=proxyCustomElement(AviaPlayOverlay$1,[0,"avia-play-overlay",{playing:[4],controlMode:[1,"control-mode"],playDisabled:[4,"play-disabled"],pausable:[4],isTouch:[4,"is-touch"]},[[2,"click","onClick"]]]);const AviaPlayToggle=proxyCustomElement(AviaPlayToggle$1,[0,"avia-play-toggle",{playing:[4],playDisabled:[4,"play-disabled"],pausable:[4],compact:[516]}]);const AviaPoster=proxyCustomElement(AviaPoster$1,[4,"avia-poster",{posterActive:[4,"poster-active"],posterImageUrl:[1,"poster-image-url"]},[[2,"click","handleAction"]]]);const AviaProgressBar=proxyCustomElement(AviaProgressBar$1,[0,"avia-progress-bar",{currentTimeSeconds:[2,"current-time-seconds"],durationSeconds:[2,"duration-seconds"],localeData:[16],segmentBreakPositions:[1,"segment-break-positions"],preview:[16],increment:[2],hovering:[32],cursor:[32]},[[1,"mouseenter","onMouseEnter"],[1,"mouseleave","onMouseLeave"],[9,"mousemove","onMouseMove"]]]);const AviaSeekBackButton=proxyCustomElement(AviaSeekBackButton$1,[0,"avia-seek-back-button",{seekBackDisabled:[4,"seek-back-disabled"],isLiveLinear:[4,"is-live-linear"]}]);const AviaSeekForwardButton=proxyCustomElement(AviaSeekForwardButton$1,[0,"avia-seek-forward-button",{seekForwardDisabled:[4,"seek-forward-disabled"],isLiveLinear:[4,"is-live-linear"]}]);const AviaSeekIndicator=proxyCustomElement(AviaSeekIndicator$1,[0,"avia-seek-indicator",{durationSeconds:[2,"duration-seconds"],accIndicatorState:[16]}]);const AviaSettings=proxyCustomElement(AviaSettings$1,[0,"avia-settings",{settings:[16],localeData:[16],qualityLabel:[2,"quality-label"],controlMode:[1,"control-mode"],menuState:[32]},[[0,"click","onClick"],[4,"keydown","onKeyDown"]]]);const AviaSettingsToggle=proxyCustomElement(AviaSettingsToggle$1,[0,"avia-settings-toggle",{settings:[16],settingsDisabled:[4,"settings-disabled"],excludedControls:[16]}]);const AviaSlider=proxyCustomElement(AviaSlider$1,[4,"avia-slider",{locId:[513,"loc-id"],min:[2],max:[2],value:[1026],list:[16],ariaValuetext:[1,"aria-valuetext"],increment:[2],localeData:[16],valueInternal:[32]},[[1,"touchstart","onMouseDown"],[0,"mousedown","onMouseDown"],[8,"touchmove","onMouseMove"],[8,"mousemove","onMouseMove"],[9,"touchend","onMouseUp"],[8,"mouseup","onMouseUp"],[0,"focus","onFocus"],[0,"blur","onBlur"],[0,"keydown","onKeydown"],[0,"keyup","onKeyup"]]]);const AviaSpinner=proxyCustomElement(AviaSpinner$1,[0,"avia-spinner"]);const AviaText=proxyCustomElement(AviaText$1,[0,"avia-text",{locId:[513,"loc-id"],localeData:[16]}]);const AviaTextToggle=proxyCustomElement(AviaTextToggle$1,[0,"avia-text-toggle",{textTrackEnabled:[4,"text-track-enabled"],textDisabled:[4,"text-disabled"],excludedControls:[16]}]);const AviaTimeDisplay=proxyCustomElement(AviaTimeDisplay$1,[0,"avia-time-display",{timeDisplayValue:[1,"time-display-value"],currentTimeSeconds:[2,"current-time-seconds"],durationSeconds:[2,"duration-seconds"],isLiveLinear:[4,"is-live-linear"],isDvr:[4,"is-dvr"]}]);const AviaUi=proxyCustomElement(AviaUi$1,[4,"avia-ui",{controlMode:[513,"control-mode"],fullscreen:[516],active:[516],activeMode:[513,"active-mode"],excludedControls:[16],fullscreenDisabled:[4,"fullscreen-disabled"],muted:[4],muteDisabled:[4,"mute-disabled"],volume:[2],playing:[4],playDisabled:[4,"play-disabled"],textTrackEnabled:[4,"text-track-enabled"],textDisabled:[4,"text-disabled"],timeDisplayValue:[1,"time-display-value"],isLiveLinear:[4,"is-live-linear"],isDvr:[4,"is-dvr"],live:[4],playheadPosition:[2,"playhead-position"],durationSeconds:[2,"duration-seconds"],currentTimeSeconds:[2,"current-time-seconds"],seekDisabled:[4,"seek-disabled"],seekBackDisabled:[4,"seek-back-disabled"],seekForwardDisabled:[4,"seek-forward-disabled"],settingsDisabled:[4,"settings-disabled"],adPlayheadPosition:[2,"ad-playhead-position"],segmentBreakPositions:[1,"segment-break-positions"],localeData:[16],preview:[16],accIndicatorState:[16],unmuteCtaVisible:[4,"unmute-cta-visible"],settings:[16],posterActive:[4,"poster-active"],posterImageUrl:[1,"poster-image-url"],qualityLabel:[2,"quality-label"],waiting:[4],initialized:[4],pausable:[4],isTouch:[4,"is-touch"]},[[0,"action","handleAction"]]]);const AviaUnmuteCta=proxyCustomElement(AviaUnmuteCta$1,[0,"avia-unmute-cta",{muteState:[4,"mute-state"],unmuteCtaVisible:[4,"unmute-cta-visible"]}]);const AviaVolumeIndicator=proxyCustomElement(AviaVolumeIndicator$1,[0,"avia-volume-indicator",{volume:[2],accIndicatorState:[16]}]);const AviaVolumeSlider=proxyCustomElement(AviaVolumeSlider$1,[0,"avia-volume-slider",{volume:[2],excludedControls:[16]}]);const AviaWaitingOverlay=proxyCustomElement(AviaWaitingOverlay$1,[0,"avia-waiting-overlay",{waiting:[4]}]);const defineCustomElements=opts=>{if(typeof customElements!=="undefined"){[AviaAccessibility,AviaActive,AviaAdControlBar,AviaAdProgressBar,AviaButton,AviaControlBar,AviaControlBarCompact,AviaCurrentTime,AviaDuration,AviaFullscreenToggle,AviaLiveControl,AviaMuteToggle,AviaOverlay,AviaPlayCta,AviaPlayOverlay,AviaPlayToggle,AviaPoster,AviaProgressBar,AviaSeekBackButton,AviaSeekForwardButton,AviaSeekIndicator,AviaSettings,AviaSettingsToggle,AviaSlider,AviaSpinner,AviaText,AviaTextToggle,AviaTimeDisplay,AviaUi,AviaUnmuteCta,AviaVolumeIndicator,AviaVolumeSlider,AviaWaitingOverlay].forEach(cmp=>{if(!customElements.get(cmp.is)){customElements.define(cmp.is,cmp,opts)}})}};defineCustomElements()}).call(this,__webpack_require__("uKge"))},"K04/":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return fetchUserLoggedIn}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isUserLoggedIn}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getLocalStorageValue}));__webpack_require__.d(__webpack_exports__,"d",(function(){return setLocalStorageValue}));var js_cookie=__webpack_require__("06tH");var js_cookie_default=__webpack_require__.n(js_cookie);var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};function __extends(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t}function __decorate(decorators,target,key,desc){var c=arguments.length,r=c<3?target:desc===null?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(metadataKey,metadataValue)}function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __generator(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}}var __createBinding=Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]};function __exportStar(m,o){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(o,p))__createBinding(o,m,p)}function __values(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-- >0)&&!(r=i.next()).done)ar.push(r.value)}catch(error){e={error:error}}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i)}finally{if(e)throw e.error}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function __spreadArray(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}function __asyncGenerator(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=generator.apply(thisArg,_arguments||[]),i,q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){if(g[n])i[n]=function(v){return new Promise((function(a,b){q.push([n,v,a,b])>1||resume(n,v)}))}}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){if(f(v),q.shift(),q.length)resume(q[0][0],q[0][1])}}function __asyncDelegator(o){var i,p;return i={},verb("next"),verb("throw",(function(e){throw e})),verb("return"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:n==="return"}:f?f(v):v}:f}}function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator],i;return m?m.call(o):(o=typeof __values==="function"?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){v=o[n](v),settle(resolve,reject,v.done,v.value)}))}}function settle(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)}}function __makeTemplateObject(cooked,raw){if(Object.defineProperty){Object.defineProperty(cooked,"raw",{value:raw})}else{cooked.raw=raw}return cooked}var __setModuleDefault=Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v};function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result}function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}}function __classPrivateFieldGet(receiver,state,kind,f){if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a getter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return kind==="m"?f:kind==="a"?f.call(receiver):f?f.value:state.get(receiver)}function __classPrivateFieldSet(receiver,state,value,kind,f){if(kind==="m")throw new TypeError("Private method is not writable");if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return kind==="a"?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value}var E_TIMEOUT=new Error("timeout while waiting for mutex to become available");var E_ALREADY_LOCKED=new Error("mutex already locked");var E_CANCELED=new Error("request for lock canceled");var Semaphore_Semaphore=function(){function Semaphore(_maxConcurrency,_cancelError){if(_cancelError===void 0){_cancelError=E_CANCELED}this._maxConcurrency=_maxConcurrency;this._cancelError=_cancelError;this._queue=[];this._waiters=[];if(_maxConcurrency<=0){throw new Error("semaphore must be initialized to a positive value")}this._value=_maxConcurrency}Semaphore.prototype.acquire=function(){var _this=this;var locked=this.isLocked();var ticketPromise=new Promise((function(resolve,reject){return _this._queue.push({resolve:resolve,reject:reject})}));if(!locked)this._dispatch();return ticketPromise};Semaphore.prototype.runExclusive=function(callback){return __awaiter(this,void 0,void 0,(function(){var _a,value,release;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.acquire()];case 1:_a=_b.sent(),value=_a[0],release=_a[1];_b.label=2;case 2:_b.trys.push([2,,4,5]);return[4,callback(value)];case 3:return[2,_b.sent()];case 4:release();return[7];case 5:return[2]}}))}))};Semaphore.prototype.waitForUnlock=function(){return __awaiter(this,void 0,void 0,(function(){var waitPromise;var _this=this;return __generator(this,(function(_a){if(!this.isLocked()){return[2,Promise.resolve()]}waitPromise=new Promise((function(resolve){return _this._waiters.push({resolve:resolve})}));return[2,waitPromise]}))}))};Semaphore.prototype.isLocked=function(){return this._value<=0};Semaphore.prototype.release=function(){if(this._maxConcurrency>1){throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead")}if(this._currentReleaser){var releaser=this._currentReleaser;this._currentReleaser=undefined;releaser()}};Semaphore.prototype.cancel=function(){var _this=this;this._queue.forEach((function(ticket){return ticket.reject(_this._cancelError)}));this._queue=[]};Semaphore.prototype._dispatch=function(){var _this=this;var nextTicket=this._queue.shift();if(!nextTicket)return;var released=false;this._currentReleaser=function(){if(released)return;released=true;_this._value++;_this._resolveWaiters();_this._dispatch()};nextTicket.resolve([this._value--,this._currentReleaser])};Semaphore.prototype._resolveWaiters=function(){this._waiters.forEach((function(waiter){return waiter.resolve()}));this._waiters=[]};return Semaphore}();var es6_Semaphore=Semaphore_Semaphore;var Mutex_Mutex=function(){function Mutex(cancelError){this._semaphore=new es6_Semaphore(1,cancelError)}Mutex.prototype.acquire=function(){return __awaiter(this,void 0,void 0,(function(){var _a,releaser;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this._semaphore.acquire()];case 1:_a=_b.sent(),releaser=_a[1];return[2,releaser]}}))}))};Mutex.prototype.runExclusive=function(callback){return this._semaphore.runExclusive((function(){return callback()}))};Mutex.prototype.isLocked=function(){return this._semaphore.isLocked()};Mutex.prototype.waitForUnlock=function(){return this._semaphore.waitForUnlock()};Mutex.prototype.release=function(){this._semaphore.release()};Mutex.prototype.cancel=function(){return this._semaphore.cancel()};return Mutex}();var es6_Mutex=Mutex_Mutex;function withTimeout(sync,timeout,timeoutError){var _this=this;if(timeoutError===void 0){timeoutError=E_TIMEOUT}return{acquire:function(){return new Promise((function(resolve,reject){return __awaiter(_this,void 0,void 0,(function(){var isTimeout,handle,ticket,release,e_1;return __generator(this,(function(_a){switch(_a.label){case 0:isTimeout=false;handle=setTimeout((function(){isTimeout=true;reject(timeoutError)}),timeout);_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,sync.acquire()];case 2:ticket=_a.sent();if(isTimeout){release=Array.isArray(ticket)?ticket[1]:ticket;release()}else{clearTimeout(handle);resolve(ticket)}return[3,4];case 3:e_1=_a.sent();if(!isTimeout){clearTimeout(handle);reject(e_1)}return[3,4];case 4:return[2]}}))}))}))},runExclusive:function(callback){return __awaiter(this,void 0,void 0,(function(){var release,ticket;return __generator(this,(function(_a){switch(_a.label){case 0:release=function(){return undefined};_a.label=1;case 1:_a.trys.push([1,,7,8]);return[4,this.acquire()];case 2:ticket=_a.sent();if(!Array.isArray(ticket))return[3,4];release=ticket[1];return[4,callback(ticket[0])];case 3:return[2,_a.sent()];case 4:release=ticket;return[4,callback()];case 5:return[2,_a.sent()];case 6:return[3,8];case 7:release();return[7];case 8:return[2]}}))}))},release:function(){sync.release()},cancel:function(){return sync.cancel()},waitForUnlock:function(){return sync.waitForUnlock()},isLocked:function(){return sync.isLocked()}}}function tryAcquire(sync,alreadyAcquiredError){if(alreadyAcquiredError===void 0){alreadyAcquiredError=E_ALREADY_LOCKED}return withTimeout(sync,0,alreadyAcquiredError)}const mutex=new es6_Mutex;async function fetchUserLoggedIn(){const release=await mutex.acquire();var userResults=null;try{userResults=await fetchUserLoggedInLock()}catch(e){release();return null}release();return userResults}async function fetchUserLoggedInLock(){if(isUserLoggedIn()){var localStorageResult=getLocalStorageValue("UserInfo");if(localStorageResult===null||window.location.href.includes("/my/")||window.location.href.includes("/user/")){console.log("Fetch User Logged In: Calling Fetch");try{const json=await fetch("/my/userinfo/");const response=await json.json();if(response&&response.User){setLocalStorageValue("UserInfo",response.User,3e5);localStorageResult=getLocalStorageValue("UserInfo")}else{console.log("Received bad response from user info");return null}}catch(err){console.log("Auth: Error thrown when calling back end");return null}}if(localStorageResult){window.$cbc.User=localStorageResult;window.$cbc.CurrentSite.CSRFToken=localStorageResult.CSRFToken;window.checkDarkMode()}return localStorageResult}else{localStorage.removeItem("UserInfo");for(var key in localStorage){if(key.indexOf("Rating")===0){localStorage.removeItem(key)}}window.$cbc.User="";window.$cbc.CurrentSite.CSRFToken="";window.checkDarkMode()}return null}function isUserLoggedIn(){const cbCookie=js_cookie_default.a.get("LI");return cbCookie}function getLocalStorageValue(key){const now=new Date;if(localStorage.getItem(key)!==null){const expiry=JSON.parse(localStorage.getItem(key)).expiry;if(now.getTime()>expiry){localStorage.removeItem(key)}else{return JSON.parse(localStorage.getItem(key)).value}}return null}function setLocalStorageValue(key,value,expirationLength){const now=new Date;const item={value:value,expiry:now.getTime()+expirationLength};localStorage.setItem(key,JSON.stringify(item))}},K2j7:function(module,__webpack_exports__,__webpack_require__){"use strict";var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("3a3M");var jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);(function($){var DEFAULT_SETTINGS={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",excludeCurrent:false,excludeCurrentParameter:"x",prePopulate:null,processPrePopulate:false,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&#215;",animateDropdown:true,placeholder:null,theme:null,zindex:999,resultsLimit:null,enableHTML:false,resultsFormatter:function(item){var string=item[this.propertyToSearch];return"<li>"+(this.enableHTML?string:_escapeHTML(string))+"</li>"},tokenFormatter:function(item){var string=item[this.propertyToSearch];return"<li><p>"+(this.enableHTML?string:_escapeHTML(string))+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",allowFreeTagging:false,allowTabOut:true,autoSelectFirstResult:false,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:false};var DEFAULT_CLASSES={tokenList:"token-input-list",token:"token-input-token",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"};var POSITION={BEFORE:0,AFTER:1,END:2};var KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var HTML_ESCAPES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};var HTML_ESCAPE_CHARS=/[&<>"'\/]/g;function coerceToString(val){return String(val===null||val===undefined?"":val)}function _escapeHTML(text){return coerceToString(text).replace(HTML_ESCAPE_CHARS,(function(match){return HTML_ESCAPES[match]}))}var methods={init:function(url_or_data_or_function,options){var settings=$.extend({},DEFAULT_SETTINGS,options||{});return this.each((function(){$(this).data("settings",settings);$(this).data("tokenInputObject",new $.TokenList(this,url_or_data_or_function,settings))}))},clear:function(){this.data("tokenInputObject").clear();return this},add:function(item){this.data("tokenInputObject").add(item);return this},remove:function(item){this.data("tokenInputObject").remove(item);return this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(disable){this.data("tokenInputObject").toggleDisabled(disable);return this},setOptions:function(options){$(this).data("settings",$.extend({},$(this).data("settings"),options||{}));return this},destroy:function(){if(this.data("tokenInputObject")){this.data("tokenInputObject").clear();var tmpInput=this;var closest=this.parent();closest.empty();tmpInput.show();closest.append(tmpInput);return tmpInput}}};$.fn.tokenInput=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{return methods.init.apply(this,arguments)}};$.TokenList=function(input,url_or_data,settings){if(typeof url_or_data==="string"||typeof url_or_data==="function"){$(input).data("settings").url=url_or_data;var url=computeURL();if($(input).data("settings").crossDomain===undefined&&typeof url==="string"){if(url.indexOf("://")===-1){$(input).data("settings").crossDomain=false}else{$(input).data("settings").crossDomain=location.href.split(/\/+/g)[1]!==url.split(/\/+/g)[1]}}}else if(typeof url_or_data==="object"){$(input).data("settings").local_data=url_or_data}if($(input).data("settings").classes){$(input).data("settings").classes=$.extend({},DEFAULT_CLASSES,$(input).data("settings").classes)}else if($(input).data("settings").theme){$(input).data("settings").classes={};$.each(DEFAULT_CLASSES,(function(key,value){$(input).data("settings").classes[key]=value+"-"+$(input).data("settings").theme}))}else{$(input).data("settings").classes=DEFAULT_CLASSES}var saved_tokens=[];var token_count=0;var cache=new $.TokenList.Cache;var timeout;var input_val;var input_box=$('<input type="text" autocomplete="off" autocapitalize="off"/>').css({outline:"none"}).attr("id",$(input).data("settings").idPrefix+input.id).focus((function(){if($(input).data("settings").disabled){return false}else if($(input).data("settings").tokenLimit===null||$(input).data("settings").tokenLimit!==token_count){show_dropdown_hint()}token_list.addClass($(input).data("settings").classes.focused)})).blur((function(){hide_dropdown();if($(input).data("settings").allowFreeTagging){add_freetagging_tokens()}$(this).val("");token_list.removeClass($(input).data("settings").classes.focused)})).bind("keyup keydown blur update",resize_input).keydown((function(event){var previous_token;var next_token;switch(event.keyCode){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:if(this.value.length===0){previous_token=input_token.prev();next_token=input_token.next();if(previous_token.length&&previous_token.get(0)===selected_token||next_token.length&&next_token.get(0)===selected_token){if(event.keyCode===KEY.LEFT||event.keyCode===KEY.UP){deselect_token($(selected_token),POSITION.BEFORE)}else{deselect_token($(selected_token),POSITION.AFTER)}}else if((event.keyCode===KEY.LEFT||event.keyCode===KEY.UP)&&previous_token.length){select_token($(previous_token.get(0)))}else if((event.keyCode===KEY.RIGHT||event.keyCode===KEY.DOWN)&&next_token.length){select_token($(next_token.get(0)))}}else{var dropdown_item=null;if(event.keyCode===KEY.DOWN||event.keyCode===KEY.RIGHT){dropdown_item=$(dropdown).find("li").first();if(selected_dropdown_item){dropdown_item=$(selected_dropdown_item).next()}}else{dropdown_item=$(dropdown).find("li").last();if(selected_dropdown_item){dropdown_item=$(selected_dropdown_item).prev()}}select_dropdown_item(dropdown_item)}break;case KEY.BACKSPACE:previous_token=input_token.prev();if(this.value.length===0){if(selected_token){delete_token($(selected_token));hidden_input.change()}else if(previous_token.length){select_token($(previous_token.get(0)))}return false}else if($(this).val().length===1){hide_dropdown()}else{setTimeout((function(){do_search()}),5)}break;case KEY.TAB:case KEY.ENTER:case KEY.NUMPAD_ENTER:case KEY.COMMA:if(selected_dropdown_item){add_token($(selected_dropdown_item).data("tokeninput"));hidden_input.change()}else{if($(input).data("settings").allowFreeTagging){if($(input).data("settings").allowTabOut&&$(this).val()===""){return true}else{add_freetagging_tokens()}}else{$(this).val("");if($(input).data("settings").allowTabOut){return true}}event.stopPropagation();event.preventDefault()}return false;case KEY.ESCAPE:hide_dropdown();return true;default:if(String.fromCharCode(event.which)){setTimeout((function(){do_search()}),5)}break}}));if(settings.placeholder){input_box.attr("placeholder",settings.placeholder)}var hidden_input=$(input).hide().val("").focus((function(){focus_with_timeout(input_box)})).blur((function(){input_box.blur();return hidden_input}));var selected_token=null;var selected_token_index=0;var selected_dropdown_item=null;var token_list=$("<ul />").addClass($(input).data("settings").classes.tokenList).click((function(event){var li=$(event.target).closest("li");if(li&&li.get(0)&&$.data(li.get(0),"tokeninput")){toggle_select_token(li)}else{if(selected_token){deselect_token($(selected_token),POSITION.END)}focus_with_timeout(input_box)}})).mouseover((function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.addClass($(input).data("settings").classes.highlightedToken)}})).mouseout((function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.removeClass($(input).data("settings").classes.highlightedToken)}})).insertBefore(hidden_input);var input_token=$("<li />").addClass($(input).data("settings").classes.inputToken).appendTo(token_list).append(input_box);var dropdown=$("<div/>").addClass($(input).data("settings").classes.dropdown).appendTo("body").hide();var input_resizer=$("<tester/>").insertAfter(input_box).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input_box.css("fontSize"),fontFamily:input_box.css("fontFamily"),fontWeight:input_box.css("fontWeight"),letterSpacing:input_box.css("letterSpacing"),whiteSpace:"nowrap"});hidden_input.val("");var li_data=$(input).data("settings").prePopulate||hidden_input.data("pre");if($(input).data("settings").processPrePopulate&&$.isFunction($(input).data("settings").onResult)){li_data=$(input).data("settings").onResult.call(hidden_input,li_data)}if(li_data&&li_data.length){$.each(li_data,(function(index,value){insert_token(value);checkTokenLimit();input_box.attr("placeholder",null)}))}if($(input).data("settings").disabled){toggleDisabled(true)}if(typeof $(input).data("settings").onReady==="function"){$(input).data("settings").onReady.call()}this.clear=function(){token_list.children("li").each((function(){if($(this).children("input").length===0){delete_token($(this))}}))};this.add=function(item){add_token(item)};this.remove=function(item){token_list.children("li").each((function(){if($(this).children("input").length===0){var currToken=$(this).data("tokeninput");var match=true;for(var prop in item){if(item[prop]!==currToken[prop]){match=false;break}}if(match){delete_token($(this))}}}))};this.getTokens=function(){return saved_tokens};this.toggleDisabled=function(disable){toggleDisabled(disable)};resize_input();function escapeHTML(text){return $(input).data("settings").enableHTML?text:_escapeHTML(text)}function toggleDisabled(disable){if(typeof disable==="boolean"){$(input).data("settings").disabled=disable}else{$(input).data("settings").disabled=!$(input).data("settings").disabled}input_box.attr("disabled",$(input).data("settings").disabled);token_list.toggleClass($(input).data("settings").classes.disabled,$(input).data("settings").disabled);if(selected_token){deselect_token($(selected_token),POSITION.END)}hidden_input.attr("disabled",$(input).data("settings").disabled)}function checkTokenLimit(){if($(input).data("settings").tokenLimit!==null&&token_count>=$(input).data("settings").tokenLimit){input_box.hide();hide_dropdown();return}}function resize_input(){if(input_val===(input_val=input_box.val())){return}var width_left=token_list.width()-input_box.offset().left-token_list.offset().left;input_resizer.html(_escapeHTML(input_val)||_escapeHTML(settings.placeholder));input_box.width(Math.min(token_list.width(),Math.max(width_left,input_resizer.width()+30)))}function add_freetagging_tokens(){var value=$.trim(input_box.val());var tokens=value.split($(input).data("settings").tokenDelimiter);$.each(tokens,(function(i,token){if(!token){return}if($.isFunction($(input).data("settings").onFreeTaggingAdd)){token=$(input).data("settings").onFreeTaggingAdd.call(hidden_input,token)}var object={};object[$(input).data("settings").tokenValue]=object[$(input).data("settings").propertyToSearch]=token;add_token(object)}))}function insert_token(item){var $this_token=$($(input).data("settings").tokenFormatter(item));var readonly=item.readonly===true?true:false;if(readonly)$this_token.addClass($(input).data("settings").classes.tokenReadOnly);$this_token.addClass($(input).data("settings").classes.token).insertBefore(input_token);if(!readonly){$("<span>"+$(input).data("settings").deleteText+"</span>").addClass($(input).data("settings").classes.tokenDelete).appendTo($this_token).click((function(){if(!$(input).data("settings").disabled){delete_token($(this).parent());hidden_input.change();return false}}))}var token_data=item;$.data($this_token.get(0),"tokeninput",item);saved_tokens=saved_tokens.slice(0,selected_token_index).concat([token_data]).concat(saved_tokens.slice(selected_token_index));selected_token_index++;update_hidden_input(saved_tokens,hidden_input);token_count+=1;if($(input).data("settings").tokenLimit!==null&&token_count>=$(input).data("settings").tokenLimit){input_box.hide();hide_dropdown()}return $this_token}function add_token(item){var callback=$(input).data("settings").onAdd;if(token_count>0&&$(input).data("settings").preventDuplicates){var found_existing_token=null;token_list.children().each((function(){var existing_token=$(this);var existing_data=$.data(existing_token.get(0),"tokeninput");if(existing_data&&existing_data[settings.tokenValue]===item[settings.tokenValue]){found_existing_token=existing_token;return false}}));if(found_existing_token){select_token(found_existing_token);input_token.insertAfter(found_existing_token);focus_with_timeout(input_box);return}}input_box.width(1);if($(input).data("settings").tokenLimit==null||token_count<$(input).data("settings").tokenLimit){insert_token(item);input_box.attr("placeholder",null);checkTokenLimit()}input_box.val("");hide_dropdown();if($.isFunction(callback)){callback.call(hidden_input,item)}}function select_token(token){if(!$(input).data("settings").disabled){token.addClass($(input).data("settings").classes.selectedToken);selected_token=token.get(0);input_box.val("");hide_dropdown()}}function deselect_token(token,position){token.removeClass($(input).data("settings").classes.selectedToken);selected_token=null;if(position===POSITION.BEFORE){input_token.insertBefore(token);selected_token_index--}else if(position===POSITION.AFTER){input_token.insertAfter(token);selected_token_index++}else{input_token.appendTo(token_list);selected_token_index=token_count}focus_with_timeout(input_box)}function toggle_select_token(token){var previous_selected_token=selected_token;if(selected_token){deselect_token($(selected_token),POSITION.END)}if(previous_selected_token===token.get(0)){deselect_token(token,POSITION.END)}else{select_token(token)}}function delete_token(token){var token_data=$.data(token.get(0),"tokeninput");var callback=$(input).data("settings").onDelete;var index=token.prevAll().length;if(index>selected_token_index)index--;token.remove();selected_token=null;focus_with_timeout(input_box);saved_tokens=saved_tokens.slice(0,index).concat(saved_tokens.slice(index+1));if(saved_tokens.length==0){input_box.attr("placeholder",settings.placeholder)}if(index<selected_token_index)selected_token_index--;update_hidden_input(saved_tokens,hidden_input);token_count-=1;if($(input).data("settings").tokenLimit!==null){input_box.show().val("");focus_with_timeout(input_box)}if($.isFunction(callback)){callback.call(hidden_input,token_data)}}function update_hidden_input(saved_tokens,hidden_input){var token_values=$.map(saved_tokens,(function(el){if(typeof $(input).data("settings").tokenValue=="function")return $(input).data("settings").tokenValue.call(this,el);return el[$(input).data("settings").tokenValue]}));hidden_input.val(token_values.join($(input).data("settings").tokenDelimiter))}function hide_dropdown(){dropdown.hide().empty();selected_dropdown_item=null}function show_dropdown(){dropdown.css({position:"absolute",top:token_list.offset().top+token_list.outerHeight(true),left:token_list.offset().left,width:token_list.width(),"z-index":$(input).data("settings").zindex}).show()}function show_dropdown_searching(){if($(input).data("settings").searchingText){dropdown.html("<p>"+escapeHTML($(input).data("settings").searchingText)+"</p>");show_dropdown()}}function show_dropdown_hint(){if($(input).data("settings").hintText){dropdown.html("<p>"+escapeHTML($(input).data("settings").hintText)+"</p>");show_dropdown()}}var regexp_special_chars=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g");function regexp_escape(term){return term.replace(regexp_special_chars,"\\$&")}function highlight_term(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+regexp_escape(term)+")(?![^<>]*>)(?![^&;]+;)","gi"),(function(match,p1){return"<b>"+escapeHTML(p1)+"</b>"}))}function find_value_and_highlight_term(template,value,term){return template.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+regexp_escape(value)+")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(value,term))}function excludeCurrent(results){if($(input).data("settings").excludeCurrent){var currentTokens=$(input).data("tokenInputObject").getTokens(),trimmedList=[];if(currentTokens.length){$.each(results,(function(index,value){var notFound=true;$.each(currentTokens,(function(cIndex,cValue){if(value[$(input).data("settings").propertyToSearch]==cValue[$(input).data("settings").propertyToSearch]){notFound=false;return false}}));if(notFound){trimmedList.push(value)}}));results=trimmedList}}return results}function populate_dropdown(query,results){results=excludeCurrent(results);if(results&&results.length){dropdown.empty();var dropdown_ul=$("<ul/>").appendTo(dropdown).mouseover((function(event){select_dropdown_item($(event.target).closest("li"))})).mousedown((function(event){add_token($(event.target).closest("li").data("tokeninput"));hidden_input.change();return false})).hide();if($(input).data("settings").resultsLimit&&results.length>$(input).data("settings").resultsLimit){results=results.slice(0,$(input).data("settings").resultsLimit)}$.each(results,(function(index,value){var this_li=$(input).data("settings").resultsFormatter(value);this_li=find_value_and_highlight_term(this_li,value[$(input).data("settings").propertyToSearch],query);this_li=$(this_li).appendTo(dropdown_ul);if(index%2){this_li.addClass($(input).data("settings").classes.dropdownItem)}else{this_li.addClass($(input).data("settings").classes.dropdownItem2)}if(index===0&&$(input).data("settings").autoSelectFirstResult){select_dropdown_item(this_li)}$.data(this_li.get(0),"tokeninput",value)}));show_dropdown();if($(input).data("settings").animateDropdown){dropdown_ul.slideDown("fast")}else{dropdown_ul.show()}}else{if($(input).data("settings").noResultsText){dropdown.html("<p>"+escapeHTML($(input).data("settings").noResultsText)+"</p>");show_dropdown()}}}function select_dropdown_item(item){if(item){if(selected_dropdown_item){deselect_dropdown_item($(selected_dropdown_item))}item.addClass($(input).data("settings").classes.selectedDropdownItem);selected_dropdown_item=item.get(0)}}function deselect_dropdown_item(item){item.removeClass($(input).data("settings").classes.selectedDropdownItem);selected_dropdown_item=null}function do_search(){var query=input_box.val();if(query&&query.length){if(selected_token){deselect_token($(selected_token),POSITION.AFTER)}if(query.length>=$(input).data("settings").minChars){show_dropdown_searching();clearTimeout(timeout);timeout=setTimeout((function(){run_search(query)}),$(input).data("settings").searchDelay)}else{hide_dropdown()}}}function run_search(query){var cache_key=query+computeURL();var cached_results=cache.get(cache_key);if(cached_results){if($.isFunction($(input).data("settings").onCachedResult)){cached_results=$(input).data("settings").onCachedResult.call(hidden_input,cached_results)}populate_dropdown(query,cached_results)}else{if($(input).data("settings").url){var url=computeURL();var ajax_params={};ajax_params.data={};if(url.indexOf("?")>-1){var parts=url.split("?");ajax_params.url=parts[0];var param_array=parts[1].split("&");$.each(param_array,(function(index,value){var kv=value.split("=");ajax_params.data[kv[0]]=kv[1]}))}else{ajax_params.url=url}ajax_params.data[$(input).data("settings").queryParam]=query;ajax_params.type=$(input).data("settings").method;ajax_params.dataType=$(input).data("settings").contentType;if($(input).data("settings").crossDomain){ajax_params.dataType="jsonp"}if($(input).data("settings").excludeCurrent){var currentTokens=$(input).data("tokenInputObject").getTokens();var tokenList=$.map(currentTokens,(function(el){if(typeof $(input).data("settings").tokenValue=="function")return $(input).data("settings").tokenValue.call(this,el);return el[$(input).data("settings").tokenValue]}));ajax_params.data[$(input).data("settings").excludeCurrentParameter]=tokenList.join($(input).data("settings").tokenDelimiter)}ajax_params.success=function(results){cache.add(cache_key,$(input).data("settings").jsonContainer?results[$(input).data("settings").jsonContainer]:results);if($.isFunction($(input).data("settings").onResult)){results=$(input).data("settings").onResult.call(hidden_input,results)}if(input_box.val()===query){populate_dropdown(query,$(input).data("settings").jsonContainer?results[$(input).data("settings").jsonContainer]:results)}};if(settings.onSend){settings.onSend(ajax_params)}$.ajax(ajax_params)}else if($(input).data("settings").local_data){var results=$.grep($(input).data("settings").local_data,(function(row){return row[$(input).data("settings").propertyToSearch].toLowerCase().indexOf(query.toLowerCase())>-1}));cache.add(cache_key,results);if($.isFunction($(input).data("settings").onResult)){results=$(input).data("settings").onResult.call(hidden_input,results)}populate_dropdown(query,results)}}}function computeURL(){var url=$(input).data("settings").url;if(typeof $(input).data("settings").url=="function"){url=$(input).data("settings").url.call($(input).data("settings"))}return url}function focus_with_timeout(obj){setTimeout((function(){obj.focus()}),50)}};$.TokenList.Cache=function(options){var settings,data={},size=0,flush;settings=$.extend({max_size:500},options);flush=function(){data={};size=0};this.add=function(query,results){if(size>settings.max_size){flush()}if(!data[query]){size+=1}data[query]=results};this.get=function(query){return data[query]}}})(jquery__WEBPACK_IMPORTED_MODULE_0___default.a)},L7eK:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return isAndroid}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isiOS}));__webpack_require__.d(__webpack_exports__,"d",(function(){return isiOS11}));__webpack_require__.d(__webpack_exports__,"e",(function(){return isiPhone}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isMobile}));function isAndroid(){return/Android/i.test(navigator.userAgent)}function isFaceBookApp(){return/FBAV/i.test(navigator.userAgent)}function isBlackBerry(){return/BlackBerry/i.test(navigator.userAgent)}function isiOS(){return isiPhone()||isiPad()||isiPod()}function isiOS11(){return/OS 11_0_1|OS 11_0_2|OS 11_0_3|OS 11_1|OS 11_1_1|OS 11_1_2|OS 11_2|OS 11_2_1/i.test(navigator.userAgent)}function isiPhone(){return/iPhone/i.test(navigator.userAgent)}function isiPad(){return/iPad/i.test(navigator.userAgent)}function isiPod(){return/iPod/i.test(navigator.userAgent)}function isOpera(){return/Opera Mini/i.test(navigator.userAgent)}function isWindows(){return/IEMobile/i.test(navigator.userAgent)}function isMobileViewportWidth(){const mobileMaxWidth=767;if(window.self===window.top){return document.body.clientWidth<=mobileMaxWidth}else if(window.$cbc.pageWidth>0){return window.$cbc.pageWidth<=mobileMaxWidth}else{return true}}function isMobile(){return isMobileViewportWidth()||isAndroid()||isFaceBookApp()||isBlackBerry()||isiPhone()||isiPod()||isOpera()||isWindows()}function getWindowWidth(){const w=window;const d=document;const e=d.documentElement;const g=d.getElementsByTagName("body")[0];const x=w.innerWidth||e.clientWidth||g.clientWidth;return x}},Ma1P:function(module,exports,__webpack_require__){},Ncyu:function(module,exports,__webpack_require__){},PB6B:function(module,exports,__webpack_require__){},Pc05:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==="string"||argType==="number"){classes.push(arg)}else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner)}}}else if(argType==="object"){if(arg.toString===Object.prototype.toString){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key)}}}else{classes.push(arg.toString())}}}return classes.join(" ")}if(true&&module.exports){classNames.default=classNames;module.exports=classNames}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})()},PhMP:function(module,exports,__webpack_require__){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map((function(n){return test2[n]}));if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach((function(letter){test3[letter]=letter}));if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},PsFE:function(module,__webpack_exports__,__webpack_require__){"use strict";const OneByAOLHandler=function(analytics,Utility){const _logger=Utility.loggers("OneByAOLHandler");const _registeredEvents={iterable:{}};let _eventsRegistered=false;let events=[];const parent=analytics;let player=null;function initialize(config){events=config.oneByAOL.events}function setPlayer(aolPlayer){_logger.success("Setting ONE by AOL video player",aolPlayer);player=aolPlayer;_registerEvents()}function _registerEvents(){if(!_eventsRegistered){_eventsRegistered=true;for(let i=0;i<events.length;i++){const ev=events[i];ev.name=ev.interface;ev.player=player;ev.fired=false;ev.reported=false;if(ev.iterable){if(ev.wait){ev.wait.report.currentIndex=0}else{ev.report.currentIndex=0}_registeredEvents.iterable[ev.interface]=[{fired:false,reported:false}]}_registeredEvents[ev.interface]=ev;_logger.info("Adding Native Event Listener for One By AOL",ev);player.addEventListener(window.vidible[ev.interface],(function(event){const eventKey=Utility.findKey(window.vidible,event.type);_logger.info("(NATIVE EVENT: ".concat(event.type,")"),event);_registeredEvents[eventKey].fired=true;const re=_registeredEvents[eventKey];const currentIndex=re.wait?re.wait.report.currentIndex:re.report.currentIndex;if(re.iterable){_registeredEvents.iterable[eventKey][currentIndex].fired=true;_registeredEvents.iterable[eventKey].push({fired:false,reported:false})}if(typeof re.when==="undefined"||typeof re.when!=="undefined"&&eval(re.when)){if(re.wait){Utility.wait(re,(function(re){if(re.iterable){_registeredEvents.iterable[eventKey][currentIndex].reported=true}_registeredEvents[eventKey].reported=true}))}else if(re.report){parent.report(re.report);if(re.iterable){_registeredEvents.iterable[eventKey][currentIndex].reported=true}_registeredEvents[eventKey].reported=true}}if(re.iterable){if(re.wait){_registeredEvents[eventKey].wait.report.currentIndex++}else{_registeredEvents[eventKey].report.currentIndex++}}}))}}}return{initialize:initialize,setPlayer:setPlayer}};__webpack_exports__["a"]=OneByAOLHandler},QASX:function(module,exports,__webpack_require__){},QbK4:function(module,exports,__webpack_require__){!function(t,e){true?module.exports=e():undefined}(this,(function(){"use strict";var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach((function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))}))}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}}))},RC2C:function(module,__webpack_exports__,__webpack_require__){"use strict";var Utility=__webpack_require__("0C8Z");var device=__webpack_require__("L7eK");var dom=__webpack_require__("fjrA");var content=__webpack_require__("16S2");var adUnits={"mobile-omni-skybox-plus-top":{code:"mobile-omni-skybox-plus-top",screen:"small",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door","unknown"]},"mobile-incontent-social":{code:"mobile-incontent-social",screen:"small",pageTypes:["news_article","article","slideshow","image_gallery"]},"mobile-banner-bottom0":{code:"mobile-banner-bottom0",screen:"small",pageTypes:["news_article","article","slideshow","image_gallery"]},"omni-skybox-plus-top":{code:"omni-skybox-plus-top",screen:"large",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door","unknown"]},"mpu-top":{code:"mpu-top",screen:"large",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door","unknown"]},"mpu-middle":{code:"mpu-middle",screen:"large",pageTypes:["home","news_door","news_article","article","slideshow","image_gallery","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door","unknown"]},"mpu-bottom":{code:"mpu-bottom",screen:"large",pageTypes:["home","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","unknown"]},"leader-bottom":{code:"leader-bottom",screen:"large",pageTypes:["listing","ranking","schedule"]},"mobile-native-plus-top":{code:"mobile-native-plus-top",screen:"small",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door"]},"native-plus-top":{code:"native-plus-top",screen:"large",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door"]},"mpu-comments":{code:"mpu-comments",screen:"large",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door"]},"mobile-mpu-comments":{code:"mobile-mpu-comments",screen:"small",pageTypes:["home","news_article","article","slideshow","image_gallery","news_door","category_news","platform_door","topic_main","category_door","listing","ranking","schedule","topic_door"]},"mobile-banner-bottom":{code:"mobile-banner-bottom",screen:"small",pageTypes:["news_article","article","slideshow","image_gallery"]},"player-position":{screen:"both",pageTypes:["home","news_article","article"]}};window.bidBarrelInitialized=window.bidBarrelInitialized||false;let renderedPlayBuzz=false;const adHandler=function(){const debug=Utility["a"].loggers("Ads");const query=Utility["a"].urlQueryAsObject(window.location.href);const viewportDesignation=Object(device["b"])()?"small":"large";const CURRENT_SITE=window.$cbc.CurrentSite;const CURRENT_MODEL=window.$cbc.Model;const AD_CONFIG=CURRENT_SITE.AdConfig;const PROPERTY_NAME=CURRENT_SITE.Property.toLowerCase();window.BidBarrel=window.BidBarrel||{};window.BidBarrel.queue=window.BidBarrel.queue||[];function getReferrer(){let referralDomain="";if(typeof document.referrer!=="undefined"&&document.referrer!==""){if(document.referrer.match(/^https?:\/\/([^\/]+\.)?facebook\.com(\/|$)/i)){referralDomain="facebook"}else{const referrer=document.referrer.match(/:\/\/([^\/:]+)(:\d+)?\//)[1];if(referrer!=="localhost"){referralDomain=referrer.match(/.*?([^.]+)[.][^.]+$/)[1]}else{referralDomain=referrer}}}return referralDomain}function renderBidBarrelScript(){const scriptName=false?undefined:"prod";const scriptUrl="https://at.cbsi.com/lib/dist/".concat(scriptName,"/bidbarrel-").concat(PROPERTY_NAME.replace(".com",""),".min.js");const methods=["auction","initialize","on","setTargeting","getVideoAds"];debug.log("Rendering BidBarrel Script: ",scriptUrl);window.BidBarrel=window.BidBarrel||{};window.BidBarrel.queue=window.BidBarrel.queue||[];methods.forEach((function(method){window.BidBarrel[method]=window.BidBarrel[method]||function(){const args=arguments;window.BidBarrel.queue.push((function(r){window.BidBarrel[method].apply(window.BidBarrel,args);r()}))}}));if(scriptUrl&&!document.getElementById("bidbarrel")){const p=document;const s=p.createElement("script");s.async=!0;s.id="bidbarrel";s.src=scriptUrl;document.head.appendChild(s)}}async function initialize(){if(window.bidBarrelInitialized===false){window.bidBarrelInitialized=true;renderBidBarrelScript();const isOnHeadlinePage=Object(content["c"])();const envMap=["stage","stage","stage","prod"];const envVal=envMap[CURRENT_SITE.Env];const pageTargeting={ptype:CURRENT_SITE.AdPageType,refdn:getReferrer(),property:CURRENT_SITE.Property.toLowerCase(),site:CURRENT_SITE.Site.toLowerCase().replace(".com","").replace(/ /g,"-"),topic:CURRENT_SITE.Topic.replace(".com","").replace(/ /g,"-"),page:isOnHeadlinePage?CURRENT_SITE.PageSubType:CURRENT_SITE.PageType,pageType:CURRENT_SITE.PageType.toLowerCase(),pageSubType:CURRENT_SITE.PageSubType.toLowerCase(),keywords:CURRENT_SITE.Tags.length>0?CURRENT_SITE.Tags.map((function(t){return t.toLowerCase()})):null,env:envVal,vguid:window.identity.getHitId(),cid:isOnHeadlinePage?CURRENT_MODEL.Key:""};if(CURRENT_MODEL.CollectionValue){pageTargeting.collection=CURRENT_MODEL.CollectionValue}debug.log("Initializing BidBarrel");window.BidBarrel.initialize({dfpPath:"/"+AD_CONFIG.googleTagID+"/"+(Object(device["b"])()?"m":"")+AD_CONFIG.prefix,pageTargeting:pageTargeting,analytics:{prebid:{enabled:false}}});window.BidBarrel.queue.push((function(resolve){if(query.gpt_open_console==="true"){googletag.cmd.push((function(){googletag.openConsole()}))}resolve()}));renderPlayBuzz();if(!isOnHeadlinePage){const model=window.$cbc.Model;const adIDs=["mobile-native-plus-top","native-plus-top","mobile-banner-bottom","mobile-mpu-comments","mpu-comments"];let units=Object.keys(adUnits).filter(key=>adIDs.indexOf(key)===-1);if(CURRENT_SITE.Property!=="popculture.com"){units=units.filter(unit=>unit!=="player-position")}if(model&&parseInt(model.DesktopAdCount)){for(let i=1;i<parseInt(model.DesktopAdCount)+1;i++){units.push(["native-plus-top",i])}}if(model&&parseInt(model.MobileAdCount)){for(let i=1;i<parseInt(model.MobileAdCount)+1;i++){units.push(["mobile-native-plus-top",i])}}units.push(["mobile-banner-bottom",0]);debug.log("Processing initial ads");processAds(units)}}else{debug.error("adHandler.initialize called twice. This is likely due to Ad Handler being included more than once on the page. Please re-evaluate bundle")}}function processAds(unitArr,newTargeting){if(newTargeting){window.BidBarrel.setTargeting(newTargeting)}const validUnits=validateUnits(unitArr);window.BidBarrel.auction(validUnits)}function processFixedArticleAds(article){const units=["mobile-omni-skybox-plus-top","omni-skybox-plus-top","mpu-top","mobile-incontent-social"];let newTargeting={};if(article&&article.useMiddle2){units.push("mpu-middle")}if(!article){const cid=article.articleKeys[article.currentIndex];const articleTags=article.articleData[cid].tags;const collectionValue=article.articleData[cid].collectionValue;newTargeting={cid:cid,keywords:articleTags&&articleTags.length>0?articleTags.map(tag=>tag.toLowerCase()):null};if(collectionValue){newTargeting.collection=collectionValue}}processAds(units,newTargeting)}function validateUnits(unitArr){const resultUnits=[];const validators=[isViewportValid,isPageTypeValid];for(let i=0;i<unitArr.length;i++){const unitDesignation=unitArr[i];let isValid=true;for(var ix=0;ix<validators.length;ix++){const validator=validators[ix];if(!validator(unitDesignation)){isValid=false;debug.info(unitDesignation,"is invalid",ix===0?"for current viewport":"for current page type");break}}if(isValid){resultUnits.push(unitDesignation)}}return resultUnits}function isViewportValid(unitDesignation){const code=Array.isArray(unitDesignation)?unitDesignation[0]:unitDesignation;return adUnits[code]&&(adUnits[code].screen===viewportDesignation||adUnits[code].screen==="both")}function isPageTypeValid(unitDesignation){const code=Array.isArray(unitDesignation)?unitDesignation[0]:unitDesignation;return adUnits[code]&&adUnits[code].pageTypes.indexOf(CURRENT_SITE.AdPageType)>=0}function renderPlayBuzz(){if(renderedPlayBuzz)return;renderedPlayBuzz=true;const isOnHeadlinePage=Object(content["c"])();window.BidBarrel.on("refresh",()=>{const elExist=document.getElementById("content-footer-extra");if(isOnHeadlinePage&&AD_CONFIG.playbuzz&&AD_CONFIG.playbuzz.embedId&&AD_CONFIG.playbuzz.siteId&&elExist){Object(dom["c"])({id:"playbuzz",parent:"#content-footer-extra",notInEU:true,content:'(function (d,s,n,id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.className = n; js.src = "https://player.ex.co/player/'+AD_CONFIG.playbuzz.embedId+"\"; fjs.parentNode.insertBefore(js, fjs); }(document,'script','exco-player','"+AD_CONFIG.playbuzz.siteId+"'));"})}})}return{initialize:initialize,processAds:processAds,processFixedArticleAds:processFixedArticleAds,renderPlayBuzz:renderPlayBuzz}};const ads=adHandler();ads.initialize();var ads_ads=__webpack_exports__["a"]=ads},RSZs:function(module,exports,__webpack_require__){},RZoG:function(module,exports,__webpack_require__){},"SGZ+":function(module,exports,__webpack_require__){},TZle:function(module,exports,__webpack_require__){},VT9Y:function(module,exports,__webpack_require__){!function(t,n){true?module.exports=n():undefined}(this,(function(){"use strict";var t={exports:{}};!function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports}(t);var n={exports:{}};!function(t){var n=function(t){var n,r=Object.prototype,e=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,n,r){return Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{c({},"")}catch(t){c=function(t,n,r){return t[n]=r}}function f(t,n,r,e){var i=n&&n.prototype instanceof p?n:p,u=Object.create(i.prototype),o=new E(e||[]);return u._invoke=function(t,n,r){var e=l;return function(i,u){if(e===v)throw new Error("Generator is already running");if(e===y){if("throw"===i)throw u;return A()}for(r.method=i,r.arg=u;;){var o=r.delegate;if(o){var a=S(o,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===l)throw e=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=v;var c=s(t,n,r);if("normal"===c.type){if(e=r.done?y:h,c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(e=y,r.method="throw",r.arg=c.arg)}}}(t,r,o),u}function s(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var l="suspendedStart",h="suspendedYield",v="executing",y="completed",d={};function p(){}function b(){}function w(){}var m={};c(m,u,(function(){return this}));var g=Object.getPrototypeOf,k=g&&g(g(I([])));k&&k!==r&&e.call(k,u)&&(m=k);var j=w.prototype=p.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(n){c(t,n,(function(t){return this._invoke(n,t)}))}))}function O(t,n){function r(i,u,o,a){var c=s(t[i],t,u);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==typeof l&&e.call(l,"__await")?n.resolve(l.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):n.resolve(l).then((function(t){f.value=t,o(f)}),(function(t){return r("throw",t,o,a)}))}a(c.arg)}var i;this._invoke=function(t,e){function u(){return new n((function(n,i){r(t,e,n,i)}))}return i=i?i.then(u,u):u()}}function S(t,r){var e=t.iterator[r.method];if(e===n){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=n,S(t,r),"throw"===r.method))return d;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=s(e,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var u=i.arg;return u?u.done?(r[t.resultName]=u.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=n),r.delegate=null,d):u:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function P(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function T(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(t){if(t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(e.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=n,r.done=!0,r};return o.next=o}}return{next:A}}function A(){return{value:n,done:!0}}return b.prototype=w,c(j,"constructor",w),c(w,"constructor",b),b.displayName=c(w,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===b||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,a,"GeneratorFunction")),t.prototype=Object.create(j),t},t.awrap=function(t){return{__await:t}},x(O.prototype),c(O.prototype,o,(function(){return this})),t.AsyncIterator=O,t.async=function(n,r,e,i,u){void 0===u&&(u=Promise);var o=new O(f(n,r,e,i),u);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(j),c(j,a,"Generator"),c(j,u,(function(){return this})),c(j,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&e.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(e,i){return a.type="throw",a.arg=t,r.next=e,i&&(r.method="next",r.arg=n),!!i}for(var u=this.tryEntries.length-1;u>=0;--u){var o=this.tryEntries[u],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=e.call(o,"catchLoc"),f=e.call(o,"finallyLoc");if(c&&f){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&e.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var u=i;break}}u&&("break"===t||"continue"===t)&&u.tryLoc<=n&&n<=u.finallyLoc&&(u=null);var o=u?u.completion:{};return o.type=t,o.arg=n,u?(this.method="next",this.next=u.finallyLoc,d):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),d},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:I(t),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=n),d}},t}(t.exports);try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}(n);var r=n.exports,e={exports:{}};!function(t){t.exports=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}(e);var i={exports:{}};!function(t){function n(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}t.exports=function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}(i);var u={exports:{}};!function(t){function n(r){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,n(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(u);var o=t.exports,a=o(r),c=o(e.exports),f=o(i.exports),s=o(u.exports);function l(t,n){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,n){if(!t)return;if("string"==typeof t)return h(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,n)}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,o=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,u=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw u}}}}function h(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var v=Object.defineProperty,y=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,p=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,m=function(t,n,r){return n in t?v(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r},g=function(t){return function(n,r){return t&&t.get(n)||(r=function(t,n,r,e){if(n&&"object"===(0,s.default)(n)||"function"==typeof n){var i,u=l(d(n));try{var o=function(){var u=i.value;b.call(t,u)||!r&&"default"===u||v(t,u,{get:function(){return n[u]},enumerable:!(e=y(n,u))||e.enumerable})};for(u.s();!(i=u.n()).done;)o()}catch(t){u.e(t)}finally{u.f()}}return t}(v({},"__esModule",{value:!0}),n,1),t&&t.set(n,r),r)}}("undefined"!=typeof WeakMap?new WeakMap:0),k=function(t,n,r){return new Promise((function(e,i){var u=function(t){try{a(r.next(t))}catch(t){i(t)}},o=function(t){try{a(r.throw(t))}catch(t){i(t)}},a=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(u,o)};a((r=r.apply(t,n)).next())}))},j={};!function(t,n){for(var r in n)v(t,r,{get:n[r],enumerable:!0})}(j,{AviaPlaylistPlugin:function(){return T},ID:function(){return E},PLAYLIST:function(){return O},PlaylistEvent:function(){return x},createPlaylistPlugin:function(){return S},createPlugin:function(){return I},playlist:function(){return P},plugin:function(){return A}});var x=function(t){return t.PLAYLIST_ADVANCED="playlistadvanced",t.PLAYLIST_CHANGED="playlistchanged",t.PLAYLIST_COMPLETE="playlistcomplete",t.PLAYLIST_OUT_OF_RANGE="playlistoutofrange",t.PLAYLIST_CLEARED="playlistcleared",t.PLAYLIST_ERROR="playlist_error",t}(x||{}),O="playlist";function S(t,n){return new T(t,n)}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:O,factory:S,options:t}}var T=function(){function t(n,r){var e=this;(0,c.default)(this,t),this._list=[],this.advancing=!1,this.completed=!1,this.onResourceEnd=function(t){e.advancing||t.detail.interrupted||e.next()},this.services=n,this.options=r,this.logger=n.logger,this.listenToPlayer(!0),this.log("".concat(O," created."))}return(0,f.default)(t,[{key:"getId",value:function(){return O}},{key:"destroy",value:function(){this.listenToPlayer(!1),this._list=null}},{key:"list",get:function(){return this._list.map((function(t){return function(t,n){for(var r in n||(n={}))b.call(n,r)&&m(t,r,n[r]);if(p){var e,i=l(p(n));try{for(i.s();!(e=i.n()).done;)r=e.value,w.call(n,r)&&m(t,r,n[r])}catch(t){i.e(t)}finally{i.f()}}return t}({},t)}))}},{key:"length",get:function(){var t;return(null==(t=this._list)?void 0:t.length)||0}},{key:"currentIndex",get:function(){return this._currentIndex},set:function(t){if(!(t<0||t>=this._list.length)){var n=Math.max(this._currentIndex,0);this.advance(t-n)}}},{key:"currentResource",get:function(){var t,n=null==(t=this._list)?void 0:t[this._currentIndex];return n?this.avia.Util.merge({},n):null}},{key:"nextResource",get:function(){var t=this.find(this._currentIndex+1);return t?this.avia.Util.merge({},t):null}},{key:"prevResource",get:function(){var t=this.find(this._currentIndex-1);return t?this.avia.Util.merge({},t):null}},{key:"next",value:function(){return k(this,null,a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.advance(1));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"prev",value:function(){return k(this,null,a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.advance(-1));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){this._list=[],this._currentIndex=-1,this.emit("playlistcleared")}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._currentIndex=isNaN(t)?-1:t-1,this.advance()}},{key:"addResources",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.avia.Util.isEmpty(t)){var e="addResources(): received 'null'; a resource or resource array must be provided.";return this.log(e,this.avia.LogLevel.ERROR),void this.emit(this.getEventData("playlist_error",{message:e}))}var i=Array.isArray(t)?t:[t];i.forEach((function(t,e){var i=n.avia.createResourceConfig(t);null!=r?n._list.splice(r+e,0,i):n._list.push(i)}))}},{key:"removeResourceAtIndex",value:function(t){return k(this,null,a.default.mark((function n(){var r=this;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){var e=r._list.splice(t,1);t===r.currentIndex?r.player.stop().then((function(){n(null==e?void 0:e[0])})):t>=0&&t<r._list.length?n(null==e?void 0:e[0]):n(null)})));case 1:case"end":return n.stop()}}),n)})))}},{key:"advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return k(this,null,a.default.mark((function n(){var r,e,i,u,o,c,f=this;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=this._currentIndex+t,!(u=this.find(i))){n.next=8;break}return this.advancing=!0,this.completed=!1,n.abrupt("return",null==(r=this.player)?void 0:r.attachResource(u).then((function(t){return f.emit(f.getEventData("playlistadvanced",{currentIndex:f.currentIndex})),f._currentIndex=i,f.advancing=!1,t})));case 8:((c=i>=(null==(e=this._list)?void 0:e.length))||i<0)&&(c&&!this.completed?(this.completed=!0,o="playlistcomplete"):o="playlistoutofrange");case 10:return o&&(this.log("Playlist status: ".concat(o)),this.emit(this.getEventData(o))),n.abrupt("return",Promise.resolve(null));case 12:case"end":return n.stop()}}),n,this)})))}},{key:"find",value:function(t){return t>=0&&t<this._list.length&&this._list[t]||null}},{key:"avia",get:function(){return this.services.avia}},{key:"player",get:function(){return this.services.player}},{key:"emit",value:function(t){this.services.event.dispatchPluginEvent(t||null)}},{key:"getEventData",value:function(t,n){return{id:O,type:t,data:n}}},{key:"listenToPlayer",value:function(t){this.player[t?"on":"off"](this.avia.PlayerEvent.RESOURCE_END,this.onResourceEnd)}},{key:"log",value:function(t,n){this.options.debug&&this.logger.log(n||this.avia.LogLevel.DEBUG,t)}}]),t}(),E=O,I=S,A=P;return g(j)}))},atHw:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return userConsentsTo}));__webpack_require__.d(__webpack_exports__,"b",(function(){return userHasNotConsented}));const CONSENTABLE_BEHAVIORS=["targeting","performance","functional","social"];const ensureOptanonIsLoaded=()=>{if(!window.cbsoptanon||!window.cbsoptanon.ot){throw new Error("Failure to load onetrust and/or cbsoptanon library")}};const userConsentsTo=(behavior,callback)=>{if(!behavior||CONSENTABLE_BEHAVIORS.indexOf(behavior)===-1){throw new Error("".concat(behavior," is not a recognized consentable behavior"))}ensureOptanonIsLoaded();return new Promise(resolve=>{const checkConsent=window.cbsoptanon.ot["".concat(behavior,"Allowed")];checkConsent(allowed=>{if(allowed){resolve(callback)}})})};const loadIframes=callback=>{ensureOptanonIsLoaded();window.cbsoptanon.onIframesReady(optanon=>{optanon.tags.load("IFRAME");callback&&callback()})};const getConsentState=()=>{ensureOptanonIsLoaded();return new Promise(resolve=>{window.cbsoptanon.ot.getState((targeting,performance,functional,social)=>{resolve({targeting:targeting,performance:performance,functional:functional,social:social})})})};const userHasNotConsented=async()=>{const state=await getConsentState();const stateBuckets=Object.keys(state);return stateBuckets.filter(bucket=>state[bucket]!==true).length>0}},br7l:function(module,exports,__webpack_require__){},btbg:function(module,__webpack_exports__,__webpack_require__){"use strict";var _root_uuid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("wHAZ");var _root_shared_lib_auth__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("K04/");var _root_shared_utils_content__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("16S2");const initIdentity=function(){let hitGuid=Object(_root_uuid__WEBPACK_IMPORTED_MODULE_0__["a"])();let sessionGuid=Object(_root_uuid__WEBPACK_IMPORTED_MODULE_0__["a"])();function initialize(){if(!window.$cbc){return}Object(_root_shared_lib_auth__WEBPACK_IMPORTED_MODULE_1__["a"])().then(user=>{refreshTealiumData()})}function newPageHit(){let data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};hitGuid=Object(_root_uuid__WEBPACK_IMPORTED_MODULE_0__["a"])();refreshTealiumData(data)}function newPageSession(){sessionGuid=Object(_root_uuid__WEBPACK_IMPORTED_MODULE_0__["a"])();newPageHit()}function getBasicSiteData(){const windowWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0,window.screen.width||0);const isComicbook=window.$cbc.CurrentSite.Property==="comicbook.com";const data={brandPlatformId:null,siteDeviceType:null,siteType:null,scRsid:null,siteCode:null};if(isComicbook){data.scRsid="cbsicomicbbooksite";data.siteCode="comicbook";if(windowWidth<900){data.brandPlatformId="comicbook_site_mweb";data.siteDeviceType="responsive web|||mobile";data.siteType="responsive web|||mobile"}else{data.brandPlatformId="comicbook_site_desktop";data.siteDeviceType="responsive web|||desktop";data.siteType="responsive web|||desktop"}}else{data.scRsid="cbsipopculturesite";data.siteCode="popculture";if(windowWidth<900){data.brandPlatformId="popculture_site_mweb";data.siteDeviceType="responsive web|||mobile";data.siteType="responsive web|||mobile"}else{data.brandPlatformId="popculture_site_desktop";data.siteDeviceType="responsive web|||desktop";data.siteType="responsive web|||desktop"}}return data}function refreshTealiumData(){let{url:url,title:title}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const newData=window.utag_data||getBasicSiteData();const successMessage=document.getElementById("successMessage");const{CurrentSite:CurrentSite,Model:Model,User:User}=window.$cbc;const isOnHeadlinePage=Object(_root_shared_utils_content__WEBPACK_IMPORTED_MODULE_2__["c"])();newData.pageViewGuid=getHitId();newData._pageURL=url||window.location.href;newData._pageTitle=title||window.document.title;newData.pageType=CurrentSite.AdPageType;if(User){newData.userId=User.Key;newData.userState="authenticated";newData.userType="registered"}else{newData.userState="not authenticated";newData.userType="anonymous"}if(isOnHeadlinePage){newData.articleId=Model.Key;newData.articleTitle=Model.Title;newData.articleType=Model.Type;newData.articleAuthorId=Model.AuthorKey;newData.articleAuthorName=Model.Author;newData.articleProducer=Model.CentralAudienceTeam;newData.articlePubDate=Model.ArticlePublishedDate;newData.siteHier="news|"+CurrentSite.DomainExtension+"|stories";newData.siteSection="news|"+CurrentSite.DomainExtension+"|||stories"}else{const entityPageName=window.location.href.replace(window.location.origin,"").replace("/category/","").replaceAll("/","");newData.siteHier="news|"+entityPageName+"|home";newData.siteSection="news|"+entityPageName+"|||home"}if(successMessage!==null&&successMessage.innerHTML==="You have successfully logged in"){newData.trackLoginSuccess="1"}if(successMessage!==null&&successMessage.innerHTML.includes("Registration Successful")){newData.trackRegistrationNew="1"}if(window.location.href.includes("/user/new")){newData.trackRegistrationOpen="1"}if(isOnHeadlinePage||CurrentSite.PageType==="entity"){let topicNames="";let topicKeys="";for(let keywordCounter=0;keywordCounter<CurrentSite.Keywords.length;keywordCounter++){const keyword=CurrentSite.Keywords[keywordCounter];if(topicNames===""){topicNames=keyword.name}else{if(topicNames.length+keyword.name.length>=255){break}topicNames=topicNames+","+keyword.name}if(topicKeys===""){topicKeys=keyword.id}else{topicKeys=topicKeys+","+keyword.id}}newData.topicName=topicNames;newData.topicId=topicKeys}window.utag_data=newData}function getHitId(){return hitGuid}function getSessionId(){return sessionGuid}initialize();return{newPageHit:newPageHit,newPageSession:newPageSession,getSessionId:getSessionId,getHitId:getHitId}};window.identity=initIdentity()},fGRa:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var main=__webpack_require__("Ncyu");var comicbook_main=__webpack_require__("PB6B");var general=__webpack_require__("7t31");var modules_general=__webpack_require__("br7l");var themes_general=__webpack_require__("FyT7");var main_uncritical=__webpack_require__("iLSl");var home=__webpack_require__("lUn0");var ArticleList=__webpack_require__("ppXi");var ArticleListSection=__webpack_require__("nZL0");var CategoryCard=__webpack_require__("jysk");var SidebarCard=__webpack_require__("y+eN");var themes=__webpack_require__("RSZs");var global=__webpack_require__("TZle");var host=__webpack_require__("od7R");var svg4everybody_min=__webpack_require__("4lEA");var main_0=__webpack_require__("HVBj");var jquery=__webpack_require__("3a3M");var jquery_default=__webpack_require__.n(jquery);var DatabaseFilter=__webpack_require__("SGZ+");jquery_default()(document).on("click",".movie_search",(function(){jquery_default()(this).find("b").toggleClass("icon-search icon-close");jquery_default()(this).next().toggleClass("hidden")})).on("click",".comic_search",(function(){jquery_default()(this).find("b").toggleClass("icon-search icon-close");jquery_default()(this).next().toggleClass("hidden")})).on("click","[data-click-set-value]",(function(){const target=jquery_default()(this);if(!target.data("value")){throw new Error("Target must have associated data-value attribute")}jquery_default()(target.data("click-set-value")).val(target.data("value"));jquery_default()(".database-search").submit()})).on("mouseover",".rating-container .icon-star, .rating-container .rating-icon",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".rating-container .icon-star, .rating-container .rating-icon",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("mouseover",".modulestars_blk > a:not(.rating-link)",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".modulestars_blk > a:not(.rating-link)",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("mouseover",".sidebarstars_blk > a:not(.rating-link)",(function(){jquery_default()(this).prevAll("a").addClass("starselected")})).on("mouseout",".sidebarstars_blk > a:not(.rating-link)",(function(){jquery_default()(this).prevAll("a").removeClass("starselected")})).on("click",".openquestion_anc",(function(){jquery_default()(this).siblings(".compdesc_blk").removeClass("hidden")})).on("click",".closequestion_anc",(function(){jquery_default()(this).parents(".compdesc_blk").addClass("hidden")}));var array_remove=__webpack_require__("FT8B");var object_findKey=__webpack_require__("u2ak");var uuid=__webpack_require__("wHAZ");var identity=__webpack_require__("btbg");var ads=__webpack_require__("RC2C");var jquery_tokeninput=__webpack_require__("K2j7");var lightbox=__webpack_require__("vViN");var newsletterModal=__webpack_require__("4Vge");var picturefill_min=__webpack_require__("4H3u");var lozad=__webpack_require__("+Cwn");var Utility=__webpack_require__("0C8Z");var init=__webpack_require__("oj+s");var AviaPlayerInitializer=__webpack_require__("s4Oi");var nav=__webpack_require__("sGDd");Object(main_0["a"])(Utility["a"]);Object(init["a"])(Utility["a"]);Object(AviaPlayerInitializer["a"])();Object(nav["a"])()},fjrA:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return calculatePageTopOffset}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getCurrentPageWidth}));__webpack_require__.d(__webpack_exports__,"c",(function(){return renderScript}));var url=__webpack_require__("uLeD");function isDebug(){const queryKey=Object(url["a"])("pcm_debug");const validValues=["debug","true","1"];if(queryKey&&validValues.indexOf(queryKey)>=0){return true}return false}function getLogger(){let namespace=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Logger";if(isDebug()){const style="color:#ffffff; padding:3px; font-weight:600;";const baseLogger=typeof console.context==="function"?console.context(namespace):console;return Object.assign(baseLogger,{info:baseLogger.info.bind(baseLogger,"%c ".concat(namespace,": (info) "),"".concat(style," background-color: #31b0d5")),warn:baseLogger.warn.bind(baseLogger,"%c ".concat(namespace,": (warning) "),"".concat(style," background-color: #f0ad4e")),error:baseLogger.error.bind(baseLogger,"%c ".concat(namespace,": (error) "),"".concat(style," background-color: #d9534f")),success:baseLogger.log.bind(baseLogger,"%c ".concat(namespace,": (success) "),"".concat(style," background-color: #5cb85c")),log:baseLogger.log.bind(baseLogger,"%c ".concat(namespace,": (log) "),"".concat(style," background-color: #337ab7"))})}else{return{info:()=>{},warn:()=>{},error:()=>{},success:()=>{},log:()=>{}}}}function calculatePageTopOffset(){let selector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"header.topnav";const header=document.querySelector(selector);if(!header)return 0;const{bottom:bottom}=header.getBoundingClientRect();return bottom}function getCurrentPageWidth(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0,window.screen.width||0)}function renderScript(config){const logger=getLogger();if(Array.isArray(config)){for(let i=0;i<config.length;i++){renderScript(config[i])}return}if(!config.attributes){config.attributes={}}if(config.url||config.content||config.attributes.src){logger.info("Rendering Script",config);if(config.id&&!config.attributes.id){config.attributes.id=config.id}if(config.url&&!config.attributes.src){config.attributes.src=config.url}(function(d,s,attr,content,appendTo){const js=d.createElement(s);const fjs=d.getElementsByTagName(s)[0];const parent=typeof appendTo!=="undefined"?d.querySelector(appendTo):false;if(attr.id&&d.getElementById(attr.id)){return}js.setAttribute("type","text/javascript");for(const[key,value]of Object.entries(attr)){js.setAttribute(key,value===true?"":value)}if(content){js.innerHTML=content}if(parent){parent.append(js)}else if(parent!==null){fjs.parentNode.insertBefore(js,fjs)}})(document,"script",config.attributes,config.content,config.parent)}else{logger.error("Script not rendered. Must have innerHtml or attributes.src value",config)}}},h8b4:function(module,exports,__webpack_require__){},hhyj:function(module,exports,__webpack_require__){},iLSl:function(module,exports,__webpack_require__){},jysk:function(module,exports,__webpack_require__){},lUn0:function(module,exports,__webpack_require__){},loKd:function(module,exports,__webpack_require__){!function(t,e){true?module.exports=e():undefined}(this,(function(){"use strict";var t={exports:{}};!function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports}(t);var e={exports:{}};!function(t){var e=function(t){var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},u=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof A?e:A,u=Object.create(r.prototype),a=new M(i||[]);return u._invoke=function(t,e,n){var i=h;return function(r,u){if(i===v)throw new Error("Generator is already running");if(i===d){if("throw"===r)throw u;return N()}for(n.method=r,n.arg=u;;){var a=n.delegate;if(a){var o=x(a,n);if(o){if(o===y)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=v;var s=c(t,e,n);if("normal"===s.type){if(i=n.done?d:f,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(i=d,n.method="throw",n.arg=s.arg)}}}(t,n,a),u}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h="suspendedStart",f="suspendedYield",v="executing",d="completed",y={};function A(){}function k(){}function p(){}var m={};s(m,u,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(E([])));b&&b!==n&&i.call(b,u)&&(m=b);var w=p.prototype=A.prototype=Object.create(m);function T(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(r,u,a,o){var s=c(t[r],t,u);if("throw"!==s.type){var l=s.arg,h=l.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,o)}),(function(t){n("throw",t,a,o)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,o)}))}o(s.arg)}var r;this._invoke=function(t,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}}function x(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=c(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,y;var u=r.arg;return u?u.done?(n[t.resultName]=u.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):u:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function E(t){if(t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:N}}function N(){return{value:e,done:!0}}return k.prototype=p,s(w,"constructor",p),s(p,"constructor",k),k.displayName=s(p,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,o,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},T(P.prototype),s(P.prototype,a,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,i,r,u){void 0===u&&(u=Promise);var a=new P(l(e,n,i,r),u);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(w),s(w,o,"Generator"),s(w,u,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=E,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var u=this.tryEntries.length-1;u>=0;--u){var a=this.tryEntries[u],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var u=r;break}}u&&("break"===t||"continue"===t)&&u.tryLoc<=e&&e<=u.finallyLoc&&(u=null);var a=u?u.completion:{};return a.type=t,a.arg=e,u?(this.method="next",this.next=u.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:E(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(e);var n=e.exports,i={exports:{}},r={exports:{}},u={exports:{}};!function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports}(u),function(t){var e=u.exports;t.exports=function(t){if(Array.isArray(t))return e(t)},t.exports.__esModule=!0,t.exports.default=t.exports}(r);var a={exports:{}};!function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports}(a);var o={exports:{}};!function(t){var e=u.exports;t.exports=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}(o);var s={exports:{}};!function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}(s),function(t){var e=r.exports,n=a.exports,i=o.exports,u=s.exports;t.exports=function(t){return e(t)||n(t)||i(t)||u()},t.exports.__esModule=!0,t.exports.default=t.exports}(i);var l={exports:{}};!function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports}(l);var c={exports:{}},h={exports:{}};!function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(h);var f={exports:{}};!function(t){function e(n,i){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(f);var v={exports:{}};!function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.__esModule=!0,t.exports.default=t.exports}(v);var d={exports:{}},y={exports:{}};!function(t){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports}(y),function(t){var e=f.exports,n=y.exports;function i(r,u,a){return n()?(t.exports=i=Reflect.construct,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(t,n,i){var r=[null];r.push.apply(r,n);var u=new(Function.bind.apply(t,r));return i&&e(u,i.prototype),u},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(null,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(d),function(t){var e=h.exports,n=f.exports,i=v.exports,r=d.exports;function u(a){var o="function"==typeof Map?new Map:void 0;return t.exports=u=function(t){if(null===t||!i(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(t))return o.get(t);o.set(t,u)}function u(){return r(t,arguments,e(this).constructor)}return u.prototype=Object.create(t.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),n(u,t)},t.exports.__esModule=!0,t.exports.default=t.exports,u(a)}t.exports=u,t.exports.__esModule=!0,t.exports.default=t.exports}(c);var A={exports:{}},k={exports:{}};!function(t){var e=h.exports;t.exports=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=e(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports}(k),function(t){var e=k.exports;function n(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=n=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=n=function(t,n,i){var r=e(t,n);if(r){var u=Object.getOwnPropertyDescriptor(r,n);return u.get?u.get.call(arguments.length<3?t:i):u.value}},t.exports.__esModule=!0,t.exports.default=t.exports),n.apply(this,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(A);var p={exports:{}};!function(t){var e=f.exports;t.exports=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&e(t,n)},t.exports.__esModule=!0,t.exports.default=t.exports}(p);var m={exports:{}},g={exports:{}};!function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(g),function(t){var e=g.exports.default,n=l.exports;t.exports=function(t,i){if(i&&("object"===e(i)||"function"==typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports}(m);var b={exports:{}},w={exports:{}};!function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports}(w);var T={exports:{}};!function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,u=[],a=!0,o=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(u.push(i.value),!e||u.length!==e);a=!0);}catch(t){o=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return u}},t.exports.__esModule=!0,t.exports.default=t.exports}(T);var P={exports:{}};!function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}(P),function(t){var e=w.exports,n=T.exports,i=o.exports,r=P.exports;t.exports=function(t,u){return e(t)||n(t,u)||i(t,u)||r()},t.exports.__esModule=!0,t.exports.default=t.exports}(b);var x={exports:{}};!function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}(x);var S={exports:{}};!function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}(S);var C={exports:{}};!function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports}(C);var M,E,N,V,I,R,O=t.exports,D=O(n),L=O(i.exports),F=O(l.exports),U=O(c.exports),B=O(A.exports),j=O(p.exports),z=O(m.exports),W=O(h.exports),H=O(b.exports),Q=O(x.exports),_=O(S.exports),q=O(g.exports),K=O(C.exports);function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,W.default)(t);if(e){var r=(0,W.default)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,z.default)(this,n)}}function X(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,u=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw u}}}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}Object.getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");var e,n=Object.getOwnPropertyDescriptor(t,"__proto__"),i=n?(0,K.default)({},"__proto__",n):{},r=X(Object.getOwnPropertyNames(t));try{for(r.s();!(e=r.n()).done;){var u=e.value;i[u]=Object.getOwnPropertyDescriptor(t,u)}}catch(t){r.e(t)}finally{r.f()}return i};var Z,Y,J=Object.create,tt=Object.defineProperty,et=Object.defineProperties,nt=Object.getOwnPropertyDescriptor,it=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertyNames,ut=Object.getOwnPropertySymbols,at=Object.getPrototypeOf,ot=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable,lt=function(t,e,n){return e in t?tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},ct=function(t,e){for(var n in e||(e={}))ot.call(e,n)&&lt(t,n,e[n]);if(ut){var i,r=X(ut(e));try{for(r.s();!(i=r.n()).done;){n=i.value;st.call(e,n)&&lt(t,n,e[n])}}catch(t){r.e(t)}finally{r.f()}}return t},ht=function(t){return tt(t,"__esModule",{value:!0})},ft=function(t,e){for(var n in e)tt(t,n,{get:e[n],enumerable:!0})},vt=function(t,e,n,i){if(e&&"object"===(0,q.default)(e)||"function"==typeof e){var r,u=X(rt(e));try{var a=function(){var u=r.value;ot.call(t,u)||!n&&"default"===u||tt(t,u,{get:function(){return e[u]},enumerable:!(i=nt(e,u))||i.enumerable})};for(u.s();!(r=u.n()).done;)a()}catch(t){u.e(t)}finally{u.f()}}return t},dt=function(t,e){return vt(ht(tt(null!=t?J(at(t)):{},"default",!e&&t&&t.__esModule?{get:function(){return t.default},enumerable:!0}:{value:t,enumerable:!0})),t)},yt=function(t){return function(e,n){return t&&t.get(e)||(n=vt(ht({}),e,1),t&&t.set(e,n),n)}}("undefined"!=typeof WeakMap?new WeakMap:0),At=function(t,e,n,i){for(var r,u=i>1?void 0:i?nt(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(u=(i?r(e,n,u):r(u))||u);return i&&u&&tt(e,n,u),u},kt=function(t,e,n){return new Promise((function(i,r){var u=function(t){try{o(n.next(t))}catch(t){r(t)}},a=function(t){try{o(n.throw(t))}catch(t){r(t)}},o=function(t){return t.done?i(t.value):Promise.resolve(t.value).then(u,a)};o((n=n.apply(t,e)).next())}))},pt=(Z={"../node_modules/screenfull/dist/screenfull.js":function(t,e){var n,i,r,u,a;n="undefined"!=typeof window&&void 0!==window.document?window.document:{},i=void 0!==e&&e.exports,r=function(){for(var t,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=e.length,u={};i<r;i++)if((t=e[i])&&t[1]in n){for(i=0;i<t.length;i++)u[e[0][i]]=t[i];return u}return!1}(),u={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(t,e){return new Promise(function(i,u){var a=function(){this.off("change",a),i()}.bind(this);this.on("change",a);var o=(t=t||n.documentElement)[r.requestFullscreen](e);o instanceof Promise&&o.then(a).catch(u)}.bind(this))},exit:function(){return new Promise(function(t,e){if(this.isFullscreen){var i=function(){this.off("change",i),t()}.bind(this);this.on("change",i);var u=n[r.exitFullscreen]();u instanceof Promise&&u.then(i).catch(e)}else t()}.bind(this))},toggle:function(t,e){return this.isFullscreen?this.exit():this.request(t,e)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,e){var i=u[t];i&&n.addEventListener(i,e,!1)},off:function(t,e){var i=u[t];i&&n.removeEventListener(i,e,!1)},raw:r},r?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(n[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return n[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(n[r.fullscreenEnabled])}}}),i?e.exports=a:window.screenfull=a):i?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}},function(){return Y||(0,Z[rt(Z)[0]])((Y={exports:{}}).exports,Y),Y.exports}),mt={};ft(mt,{AccessibilityAction:function(){return Dt},ActiveState:function(){return ze},AdBreakType:function(){return He},AdContext:function(){return Qe},AdTechnology:function(){return _e},AdapterRole:function(){return We},ApiMetric:function(){return qe},AudioTrackType:function(){return Ke},Autoplay:function(){return Ge},Browser:function(){return fe},CoreEvent:function(){return bt},Device:function(){return pe},DrmType:function(){return dn},Emitter:function(){return Nt},ErrorCategory:function(){return Xe},ErrorCode:function(){return Pe},ErrorMessage:function(){return Lt},FileExtensionToMimeType:function(){return xt},HTML5:function(){return Ye},Header:function(){return $e},HookError:function(){return fn},HookType:function(){return Ze},KeyboardScope:function(){return Je},LocalizationId:function(){return tn},LocalizedLanguage:function(){return en},LogLevel:function(){return gt},Logger:function(){return Rt},Metric:function(){return Be},MetricType:function(){return nn},MimeType:function(){return Pt},Os:function(){return me},PerformanceMode:function(){return rn},Platform:function(){return ge},PlaybackAdapterBase:function(){return Ue},PlaybackState:function(){return un},PlayerError:function(){return Ce},PlayerEvent:function(){return vn},PluginPriority:function(){return an},QualityCategory:function(){return on},QualityLabel:function(){return sn},QualityMode:function(){return xe},QueryString:function(){return ne},ResponseType:function(){return ie},StreamType:function(){return ln},TextTrackEvent:function(){return Re},TextTrackKind:function(){return St},TextTrackMode:function(){return Oe},Timer:function(){return An},UiMetric:function(){return cn},Util:function(){return Te},VideoFormat:function(){return hn},WILDCARD:function(){return De},buildInfo:function(){return je},checkPolyfills:function(){return ur},createResourceConfig:function(){return lr},createVideoPlayer:function(){return ar},getAutoplayCapabilities:function(){return hr},getSystemInfo:function(){return cr},removeVideoPlayer:function(){return sr},request:function(){return se},retrieveVideoPlayer:function(){return or},waitFor:function(){return Me},waitForEvent:function(){return Ne},waitForTime:function(){return Ve},waitUntil:function(){return Ee}});var gt=function(t){return t.OFF="off",t.ERROR="error",t.WARN="warn",t.INFO="info",t.DEBUG="debug",t}(gt||{}),bt=(0,Q.default)((function t(e,n,i){(0,_.default)(this,t),this.timeStamp=Date.now(),this.detail=i,this.target=n,this.type=e})),wt=(0,Q.default)((function t(e,n){(0,_.default)(this,t),this.value=e,this.next=n})),Tt=function(){function t(){(0,_.default)(this,t),this.head=null,this.tail=null}return(0,Q.default)(t,[{key:"empty",get:function(){return null==this.head}},{key:"forEach",value:function(t){for(var e=this.head;e;)t(e.value),e=e.next}},{key:"add",value:function(t){var e=new wt(t);null==this.head?this.head=e:null==this.tail?this.head.next=this.tail=e:this.tail.next=this.tail=e}},{key:"has",value:function(t){for(var e=this.head;e;){if(e.value===t)return!0;e=e.next}return!1}},{key:"delete",value:function(t){for(var e=null,n=this.head;n;){if(n.value===t)return e&&(e.next=n.next),n===this.head?this.head=n.next:n===this.tail&&(this.tail=e),!0;e=n,n=n.next}return!1}},{key:"clear",value:function(){for(var t,e=this.head;e;)t=e.next,e.value=e.next=null,e=t;this.head=this.tail=null}}]),t}(),Pt=function(t){return t.MP4_VIDEO="video/mp4",t.MP4_AUDIO="audio/mp4",t.HLS="application/vnd.apple.mpegurl",t.HLS_ALT="application/x-mpegURL",t.DASH="application/dash+xml",t.WEBM_VIDEO="video/webm",t.WEBM_AUDIO="audio/webm",t.TS_VIDEO="video/mp2t",t.VTT="text/vtt",t.TTML="application/ttml+xml",t}(Pt||{}),xt={VTT:"text/vtt",XML:"application/ttml+xml",M3U8:"application/vnd.apple.mpegurl",MPD:"application/dash+xml",TS:"video/mp2t",MP4:"video/mp4",MPV:"video/mp4",MPA:"audio/mp4",WEBM:"video/webm"},St=function(t){return t.CAPTIONS="captions",t.SUBTITLES="subtitles",t.DESCRIPTIONS="descriptions",t.CHAPTERS="chapters",t.METADATA="metadata",t}(St||{}),Ct=(0,Q.default)((function t(){(0,_.default)(this,t),this.muted=!1,this.volume=NaN,this.currentTime=NaN,this.duration=NaN})),Mt=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"camelToDash",value:function(e){return e.replace(t.cdr,"-").replace(t.dre,"$1-$2").toLowerCase()}},{key:"uid8",value:function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()}},{key:"uuid",value:function(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}},{key:"isEmpty",value:function(e){return null==e||Array.isArray(e)&&0===e.length||t.isObject(e)&&0===Object.keys(e).length||t.isString(e)&&""===e}},{key:"isFunction",value:function(t){return"function"==typeof t}},{key:"isString",value:function(t){return"string"==typeof t}},{key:"isUndefined",value:function(t){return void 0===t}},{key:"isNumber",value:function(t){return"number"==typeof t}},{key:"isBoolean",value:function(t){return"boolean"==typeof t}},{key:"isObject",value:function(t){return"object"===(0,q.default)(t)}},{key:"values",value:function(t){return Object.keys(t).reduce((function(e,n,i){return e[i]=t[n],e}),[])}},{key:"entries",value:function(t){return Object.keys(t).reduce((function(e,n,i){return e[i]=[n,t[n]],e}),[])}},{key:"fromEntries",value:function(t){return t.reduce((function(t,e){var n=(0,H.default)(e,2),i=n[0],r=n[1];return t[i]=r,t}),{})}},{key:"padStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";e|=0;var i=t.length;return i>e?t:((e-=i)>n.length&&(n+=n.repeat(e/n.length)),n.slice(0,e)+t)}},{key:"merge",value:function(){for(var e=function e(n,i){return null==n?i:(null==i||Object.getOwnPropertyNames(i).forEach((function(r){var u=i[r],a=n[r],o=(0,q.default)(u);"undefined"!==o&&(null==a||!t.isObject(a)||Array.isArray(u)?n[r]=u:"object"===o&&(n[r]=e(a,u)))})),n)},n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var u=i[0],a=i.slice(1);return a.reduce((function(t,n){return e(t,n)}),u)}},{key:"secToHms",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:61;if(null==e||isNaN(e))return"00:00";e|=0;var i=t.zeroFill(e%60);return e=e/60|0,i=t.zeroFill(e%60)+":"+i,(e=e/60|0)>0&&(i=t.zeroFill(e)+":"+i),n>=3600&&5===i.length&&(i="00:"+i),i}},{key:"msToHms",value:function(e){return t.formatTime(new Date(e),"HH:mm:ss:sss",{offset:0})}},{key:"zeroFill",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return t.padStart(String(e),n,"0")}},{key:"hmsToSec",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(!t)return NaN;var n=t.split(":"),i=0;if(4===n.length)i=parseInt(n.pop())/e;else if(3===n.length&&(n[2]=n[2].replace(",","."),-1!==n[2].indexOf("."))){var r=n[2].split(".");(null!=r?r.length:void 0)>1&&(n[2]=r[0],i=parseInt(r[1])/1e3)}for(var u=parseInt(n.pop());n.length>0;)u+=Math.pow(60,n.length)*parseInt(n.shift());return u+i}},{key:"formatTime",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h:mm:ss A",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{timezone:"",offset:-(new Date).getTimezoneOffset()/60};if(null!=i.offset&&0!==i.offset&&(e=new Date(e.getTime()+Math.round(60*i.offset*60*1e3))),isNaN(e.getTime()))return"";var r=e.getUTCHours(),u=e.getUTCMinutes(),a=e.getUTCSeconds(),o=e.getUTCMilliseconds(),s=r%12||12,l=r<12?"am":"pm",c={hh:t.zeroFill(s),h:s,HH:t.zeroFill(r),H:r,mm:t.zeroFill(u),m:u,sss:t.zeroFill(o,3),ss:t.zeroFill(a),s:a,a:l,A:l.toUpperCase(),z:i.timezone};for(var h in c)n=n.replace(h,c[h]);return n}},{key:"template",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"{{",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"}}";if(!e)return e;var u=new RegExp("".concat(i,"((?:(?!(").concat(i,"|").concat(r,")).)+)").concat(r),"g");return e.replace(u,(function(e,i){return t.isUndefined(null==n?void 0:n[i])?e:n[i]}))}},{key:"forEach",value:function(e,n){if(e&&e.length&&t.isFunction(n))for(var i=0,r=e.length;i<r;i++)n(e[i],i,e)}},{key:"forEachReverse",value:function(e,n){if(e&&e.length&&t.isFunction(n))for(var i=e.length-1;i>-1;i--)n(e[i],i,e)}},{key:"debounce",value:function(t,e){var n,i=function(){clearTimeout(n),n=null},r=function(){i();for(var r=arguments.length,u=new Array(r),a=0;a<r;a++)u[a]=arguments[a];n=setTimeout.apply(void 0,[t,e].concat(u))};return r.cancel=i,r.flush=t,r.pending=function(){return null!=n},r}},{key:"clampValue",value:function(t,e,n){return Math.max(e,Math.min(n,t))}},{key:"inRange",value:function(e,n,i){return t.isNumber(e)&&e>=n&&e<=i}},{key:"mapToRange",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return(t-e)*(r-i)/(n-e)+i}},{key:"base64DecodeUint8Array",value:function(t){for(var e=atob(t),n=e.length,i=new Uint8Array(new ArrayBuffer(n)),r=0;r<n;r++)i[r]=e.charCodeAt(r);return i}},{key:"base64EncodeUint8Array",value:function(t){var e=String.fromCharCode.apply(null,t);return btoa(e)}},{key:"xmlToJson",value:function(e){var n={};if(1===e.nodeType&&e.attributes.length>0)for(var i=0,r=e.attributes.length;i<r;i++){var u=e.attributes.item(i);n[u.nodeName]=u.nodeValue}else 3===e.nodeType&&(n=e.nodeValue);if("p"===e.nodeName&&(n.text="",e.childNodes.forEach((function(t){if("metadata"!==t.nodeName){var e=(new XMLSerializer).serializeToString(t);1===t.nodeType&&(n.text+="br"===t.tagName?"\n":e),3===t.nodeType&&(n.text+=e)}}))),e.hasChildNodes())for(var a=0,o=e.childNodes.length;a<o;a++){var s=e.childNodes.item(a),l=s.nodeName;if(t.isUndefined(n[l]))n[l]=t.xmlToJson(s);else{if(t.isUndefined(n[l].push)){var c=n[l];n[l]=[],n[l].push(c)}n[l].push(t.xmlToJson(s))}}return n}},{key:"getNumLines",value:function(t){return t&&(t.match(/\n/g)||[]).length+1}},{key:"roundTo",value:function(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}},{key:"makeUrl",value:function(t,e){return(t?"https:":"http:")+"//"+e}},{key:"parseLanguageTag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/,n=t.match(e)||[];return{tag:t,language:n[1]||"",extended:n[2]||"",script:n[3]||"",region:n[4]||"",toString:function(){return this.tag}}}},{key:"getFileExtension",value:function(t){return t.replace(/\?.*/,"").replace(/#.*/,"").split(".").pop()}},{key:"getMimeType",value:function(e){if(!e)return"";var n=t.getFileExtension(e).toUpperCase();return xt[n]}},{key:"clearCue",value:function(t,e){try{var n=VTTCue||TextTrackCue;t.addCue(new n(e-.1,e+.1," "))}catch(t){}}},{key:"clearAllCues",value:function(t){var e=function(e){e&&Array.from(e).forEach((function(e){try{t.removeCue(e)}catch(t){}}))};e(t.cues),e(t.activeCues)}},{key:"eventsToPromise",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;return new Promise((function(i,r){var u,a=[],o=function(){return a.forEach((function(t){return t()}))},s=function(t){return function(e){var n=e.target,i=e.events,r=n,s=r.on?"on":"addEventListener",l=r.off?"off":"removeEventListener",c=function(e,n){clearTimeout(u),o(),t(n||e)};i.forEach((function(t){r[s](t,c),a.push((function(){return r[l](t,c)}))}))}};t.forEach(s(i)),e.forEach(s(r)),n>-1&&(u=setTimeout((function(){o(),r(new Error("timeout"))}),n))}))}},{key:"bufferToString",value:function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}},{key:"arrayToString",value:function(t){var e=new Uint16Array(t.buffer);return String.fromCharCode.apply(null,e)}},{key:"stringToArray",value:function(t){for(var e=new ArrayBuffer(2*t.length),n=new Uint16Array(e),i=0,r=t.length;i<r;i++)n[i]=t.charCodeAt(i);return n}},{key:"getResourceMimeType",value:function(e){var n;return((null==(n=e.overrides)?void 0:n.mimeType)||"").split(";").shift()||t.getMimeType(e.location.mediaUrl)}},{key:"normalizeQuality",value:function(t,e){return{index:e,bitrate:t.bitrate,height:t.height,width:t.width,codec:t.codec||t.codecs}}},{key:"getIndexForBitrate",value:function(t,e,n){if(!t)return 0;var i=t.length-1;if(e>=t[i].bitrate)return i;for(;i--;){var r=t[i].bitrate;if(n){if(e>r)return i+1}else if(e>=r)return i}return 0}},{key:"findDefaultTrack",value:function(e,n){var i=new RegExp(n,"i"),r=e.find((function(t){return i.test(t.language)}));if(!r){var u=t.parseLanguageTag(n).language;u!==n&&(i=new RegExp(u,"i"),r=e.find((function(t){return i.test(t.language)})))}return r||e.find((function(t){return t.default}))||e[0]}},{key:"dedupeCues",value:function(t){var e={},n=[];return t.activeCues?(Array.from(t.activeCues).forEach((function(i){try{if(!i)return;var r=i.text,u=i.startTime,a=i.endTime;if(!r)return;var o=e[r];if(o){if(o.startTime===u&&o.endTime===a)return void t.removeCue(i)}else e[r]=i;n.push(i)}catch(t){}})),n):null}},{key:"isTextTrack",value:function(t){return"captions"===t||"subtitles"===t}},{key:"createSimpleVideoInterface",value:function(){return new Ct}}]),t}(),Et=Mt;Et.dre=/([a-z\d])([A-Z])/g,Et.cdr=/\W+/g;var Nt=function(){function t(e,n){(0,_.default)(this,t),this.target=n||this,this.opts=e||{},this.eventMap={};var i=this.opts;for(var r in i)if(Et.isFunction(i[r])&&/^on[A-Z]/.test(r)){var u=r.charAt(2).toLowerCase()+r.substring(3);this.on(u,i[r]),delete this.opts[r]}}return(0,Q.default)(t,[{key:"destroy",value:function(){var t;if(this.opts){for(t in this.opts)delete this.opts[t];this.opts=null}if(this.offAll(null),this.eventMap){for(t in this.eventMap)delete this.eventMap[t];this.eventMap=null}}},{key:"on",value:function(t,e){if(this.eventMap&&t&&Et.isFunction(e)){var n=this.eventMap[t]||(this.eventMap[t]=new Tt);n.has(e)||n.add(e)}}},{key:"once",value:function(t,e){var n=this;if(this.eventMap&&t&&Et.isFunction(e)){this.on(t,(function i(r){n.off(t,i),e(r)}))}}},{key:"off",value:function(t,e){!e&&this.offAll(t),e&&this.remove(t,e)}},{key:"offAll",value:function(t){if(this.eventMap){var e=this.eventMap;if(t)this.remove(t,null);else for(var n in e)this.remove(n,null)}}},{key:"hasListenerFor",value:function(t){return!(!this.eventMap||!this.eventMap[t]||this.eventMap[t].empty)}},{key:"emit",value:function(t,e){var n=new bt(t,this,e);this.dispatchEvt(n)}},{key:"dispatchEvt",value:function(t){this.eventMap&&this.eventMap[t.type]&&this.eventMap[t.type].forEach((function(e){return e(t)}))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.eventMap&&this.eventMap[t]&&(e?this.eventMap[t].delete(e):this.eventMap[t].clear())}}]),t}(),Vt=(M={},(0,K.default)(M,"off",0),(0,K.default)(M,"error",100),(0,K.default)(M,"warn",200),(0,K.default)(M,"info",300),(0,K.default)(M,"debug",400),M),It=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,t)).useConsole=!1,i.useConsole=Et.isObject(console),i.id=t.id||Et.uid8(),i.tzero=Date.now(),i.logLevel=Et.isEmpty(i.opts.logLevel)?"off":i.opts.logLevel,i}return(0,Q.default)(n,[{key:"logLevel",get:function(){return this.pLogLevel},set:function(t){this.pLogLevel=t}},{key:"assert",value:function(t,e){t||this.error('Assertion failed! - "'.concat(e||"",'"'))}},{key:"log",value:function(t){for(var e,i=arguments.length,r=new Array(i>1?i-1:0),u=1;u<i;u++)r[u-1]=arguments[u];for(var a=0,o=r.length;a<o;a++)this.emit(n.LOG_EVENT,this.assembleEvent(r[a],t));this.shouldLog(t)&&(r.unshift(this.getStamp()),(e=console).log.apply(e,r))}},{key:"dir",value:function(t,e,i){var r=i||"Unnamed Object";this.emit(n.LOG_EVENT,this.assembleEvent(e,t,r)),this.shouldLog(t)&&(console.log(this.getStamp()+" Object: ".concat(r)),console.dir(e))}},{key:"error",value:function(t){this.emit(n.LOG_EVENT,this.assembleEvent(t,"error")),this.shouldLog("error")&&console.error(this.getStamp()+t)}},{key:"warn",value:function(t){this.emit(n.LOG_EVENT,this.assembleEvent(t,"warn")),this.shouldLog("warn")&&console.warn(this.getStamp()+t)}},{key:"assembleEvent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{item:t,id:this.id,level:e,label:n}}},{key:"shouldLog",value:function(t){return this.useConsole&&Vt[this.pLogLevel]>=Vt[t]}},{key:"getStamp",value:function(){return"[".concat(this.id+"]  "+Et.msToHms(Date.now()-this.tzero)," > ")}}],[{key:"error",value:function(t){console&&console.error(t)}},{key:"warn",value:function(t){console&&console.warn(t)}},{key:"log",value:function(t){console&&console.log(t)}},{key:"deprecated",value:function(t){n.deprecatedCounts[t]>=n.maxDeprecatedWarnings||(n.warn(t),n.deprecatedCounts[t]=(n.deprecatedCounts[t]||0)+1)}}]),n}(Nt),Rt=It;Rt.LOG_EVENT="logevent",Rt.maxDeprecatedWarnings=1,Rt.deprecatedCounts={};var Ot={};ft(Ot,{AccessibilityAction:function(){return Dt},ActiveState:function(){return ze},AdBreakType:function(){return He},AdContext:function(){return Qe},AdTechnology:function(){return _e},AdapterRole:function(){return We},ApiMetric:function(){return qe},AudioTrackType:function(){return Ke},Autoplay:function(){return Ge},Browser:function(){return fe},CoreEvent:function(){return bt},Device:function(){return pe},DrmType:function(){return dn},Emitter:function(){return Nt},ErrorCategory:function(){return Xe},ErrorCode:function(){return Pe},ErrorMessage:function(){return Lt},FileExtensionToMimeType:function(){return xt},HTML5:function(){return Ye},Header:function(){return $e},HookError:function(){return fn},HookType:function(){return Ze},KeyboardScope:function(){return Je},LocalizationId:function(){return tn},LocalizedLanguage:function(){return en},LogLevel:function(){return gt},Logger:function(){return Rt},Metric:function(){return Be},MetricType:function(){return nn},MimeType:function(){return Pt},Os:function(){return me},PerformanceMode:function(){return rn},Platform:function(){return ge},PlaybackAdapterBase:function(){return Ue},PlaybackState:function(){return un},PlayerError:function(){return Ce},PlayerEvent:function(){return vn},PluginPriority:function(){return an},QualityCategory:function(){return on},QualityLabel:function(){return sn},QualityMode:function(){return xe},QueryString:function(){return ne},ResponseType:function(){return ie},StreamType:function(){return ln},TextTrackEvent:function(){return Re},TextTrackKind:function(){return St},TextTrackMode:function(){return Oe},Timer:function(){return An},UiMetric:function(){return cn},Util:function(){return Te},VideoFormat:function(){return hn},WILDCARD:function(){return De},buildInfo:function(){return je},request:function(){return se},waitFor:function(){return Me},waitForEvent:function(){return Ne},waitForTime:function(){return Ve},waitUntil:function(){return Ee}});var Dt=function(t){return t.ENTER_FULLSCREEN="enterFullScreen",t.INCREASE_VOLUME="increaseVolume",t.DECREASE_VOLUME="decreaseVolume",t.SEEK_BACK="seekBack",t.SEEK_FORWARD="seekForward",t.TOGGLE_PLAY="togglePlay",t.TOGGLE_TT="toggleTextTrack",t.TOGGLE_MUTE="toggleMute",t.PLAYLIST_NEXT="playListNext",t.PLAYLIST_PREV="playListPrev",t.STOP="stop",t}(Dt||{}),Lt=function(t){return t.ABR_UNAVAILABLE="Single bitrate stream detected, adaptive bitrate system is unavailable",t.ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS="You have reached the lowest available quality for this presentation.",t.ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS="You have reached the highest available quality for this presentation at this screen size",t.ABR_MIN_BITRATE_RESTRICTION_UNAVAILABLE="Min bitrate restrictions are not offered with this streaming library",t.AD_STALLED="Stalled ad detected",t.ADAPTER_UNAVAILABLE="Unable to play the requested resource - mediaUrl not recognized",t.ADAPTER_LIB_UNAVAILABLE="Unable to play the requested resource - External library is not loading",t.ADAPTER_NOT_FOUND="Unable to find an adapter for the requested resource",t.CAP_LEVEL_MAXBITRATE="Max bitrate setting will be ignored since capQualityToPlayerSize is enabled",t.CONTENT_PLAYBACK_SETTING_IGNORED="This API is only available after the CONTENT_START event has been dispatched. This setting will be ignored.",t.DAI_MISSING_ASSET_URL="Unexpected condition = valid assetUrl not found in DAI stream data",t.DAI_SDK_UNAVAILABLE="A DAI SDK is required for playback, but is not found",t.ENVIRONMENT_NOT_SUPPORTED='Unable to locate a global "window" object or suitable alternative',t.FAIRPLAY_LICENSE_ERROR="Issue with fairplay DRM and the provided license acquisition url",t.FAIRPLAY_APP_CERT_ERROR="Issue creating a fairplay keysession with the provided application certificate",t.FAIRPLAY_NO_CONTENT_ID="A valid content or asset id was not detected when creating fairplay drm session",t.FAIRPLAY_WEBKIT_ERROR="Issue with webkit and keysession creations while using fairplay drm.",t.FATAL_PLAYBACK_MEDIA_ERROR="Fatal media error, no option for recovery",t.NONFATAL_PLAYBACK_MEDIA_ERROR="Nonfatal media error",t.FATAL_PLAYBACK_NETWORK_ERROR="Fatal network error, no option for recovery",t.NONFATAL_PLAYBACK_NETWORK_ERROR="Nonfatal network error",t.IMA_SDK_MISSING="IMA SDK not found.",t.INVALID_RESOURCE="Resource configuration appears to be invalid",t.MANUAL_ABR_SWITCHING_UNAVAILABLE="Native HTML5 Video does not allow manual bitrate switching",t.PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED="StreamType.LIVE is detected. Redirecting to the stop method since a DVR window is not detected.",t.PLUGIN_LOAD_ERROR="Unable to load plugin from url",t.RESOURCE_MISSING="Resource missing",t.RESOURCE_NOT_SUPPORTED="Resource is not recognized or is currently unsupported",t.RETRY_PLAYBACK_MEDIA_ERROR="Media error detected",t.RETRY_PLAYBACK_NETWORK_ERROR="Network error detected",t.UNEXPECTED_CONDITION="An unexpected condition was encountered",t.UNSPECIFIED_ERROR="Unspecified error",t.VIDEO_PLAYBACK_UNAVAILABLE="Unable to locate a video element or suitable alternative",t.WEBKIT_KEY_ADDED_SUCCESS="Webkit key added successfully",t.WEBKIT_MEDIA_KEYS_NOT_SUPPORTED="WebKitMediaKeys are not supported for this type of media on this user agent",t}(Lt||{}),Ft=37,Ut=38,Bt=39,jt=40,zt=32,Wt=67,Ht=70,Qt=77,_t=109,qt=179,Kt=173,Gt=178,Xt=175,$t=183,Zt=174,Yt=182,Jt=176,te=177,ee=(0,Q.default)((function t(){(0,_.default)(this,t)}));ee.blankVideoUrl="https://vidtech.cbsinteractive.com/h5/blanks/uvp_blank.mp4",ee.blankDataUrl="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",ee.accessibilityKeyCmdDefs=[{action:"enterFullScreen",primaryKey:"f",keyCode:Ht},{action:"increaseVolume",primaryKey:"ArrowUp",keyCode:Ut},{action:"increaseVolume",primaryKey:null,keyCode:Xt},{action:"increaseVolume",primaryKey:null,keyCode:$t},{action:"decreaseVolume",primaryKey:"ArrowDown",keyCode:jt},{action:"decreaseVolume",primaryKey:null,keyCode:Zt},{action:"decreaseVolume",primaryKey:null,keyCode:Yt},{action:"seekBack",primaryKey:"ArrowLeft",keyCode:Ft},{action:"seekForward",primaryKey:"ArrowRight",keyCode:Bt},{action:"togglePlay",primaryKey:" ",keyCode:zt},{action:"togglePlay",primaryKey:null,keyCode:qt},{action:"toggleMute",primaryKey:"m",keyCode:Qt},{action:"toggleMute",primaryKey:"-",keyCode:_t},{action:"toggleMute",primaryKey:null,keyCode:Kt},{action:"toggleTextTrack",primaryKey:"c",keyCode:Wt},{action:"stop",primaryKey:null,keyCode:Gt},{action:"playListNext",primaryKey:null,keyCode:Jt},{action:"playListPrev",primaryKey:null,keyCode:te}],ee.messages=Lt;var ne=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"encode",value:function(t){return Et.isEmpty(t)?"":Et.entries(t).map((function(t){var e=(0,H.default)(t,2),n=e[0],i=e[1];return n+"="+encodeURIComponent(i)})).join("&")}},{key:"decode",value:function(t){var e={};return null==t||t.replace(/^[^?]*\?/,"").replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function(t,n,i,r){var u;try{u=Et.isUndefined(r)?r:decodeURIComponent(r)}catch(t){u=r}e[decodeURIComponent(n)]=u})),e}},{key:"parseValue",value:function(t){if(Et.isUndefined(t))return!0;var e=t.toLowerCase();return"true"===e||"false"===e?"true"===e:"undefined"!==t?"null"===e?null:(e=parseFloat(t),isNaN(e)?t:e):void 0}},{key:"parse",value:function(e){var n=t.decode(e);for(var i in n)n[i]=t.parseValue(n[i]);return n}},{key:"append",value:function(e,n){var i=e.includes("?")?"&":"?";return e+i+t.encode(n)}}]),t}(),ie=function(t){return t.ARRAY_BUFFER="arraybuffer",t.TEXT="text",t.JSON="json",t.DOCUMENT="document",t.DEFAULT="",t}(ie||{}),re=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"TIMEOUT",get:function(){return 5e3}}]),t}(),ue=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"create",value:function(t){return{url:t.url||"",method:t.method||"get",timeout:t.timeout||re.TIMEOUT,headers:t.headers||{},data:this.getBody(t.data,t.encodeList,t.sendJson),withCredentials:!0===t.withCredentials,responseType:t.responseType||"text",onComplete:t.onComplete||null,errorRecovery:t.errorRecovery||null}}},{key:"getBody",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return null;if("string"==typeof t)return t;if(!Object.keys(t).length)return null;var i=Array.isArray(e)&&e.length;for(var r in!i&&(e=[]),t)t[r]=this.getValue(r,t[r],e);if(n)return JSON.stringify(t);var u,a="";for(var o in t)null!=(u=t[o])&&void 0!==u&&""!==u&&(a+="".concat(o,"=").concat(u,"&"));return a=a.substr(0,a.length-1)}},{key:"getValue",value:function(t,e,n){return n.indexOf(t)>=0?encodeURIComponent(e):e}}]),t}(),ae=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;(0,_.default)(this,n),(i=e.call(this,t)).retryCount=0,i.limit=0,i.retryIntervals=null;var r=i.opts.errorRecovery;return r&&!isNaN(r.retryAttempts)&&r.retryAttempts>0&&(i.limit=r.retryAttempts),r&&r.retryIntervals&&Array.isArray(r.retryIntervals)&&(i.retryIntervals=r.retryIntervals),i}return(0,Q.default)(n,[{key:"shouldRetry",value:function(){return this.limit&&!this.atLimit}},{key:"incrementAttempts",value:function(){this.retryCount++}},{key:"retryLimit",get:function(){return this.limit}},{key:"atLimit",get:function(){return this.retryCount===this.limit}},{key:"retryInterval",get:function(){return this.retryIntervals&&this.retryIntervals[this.retryCount-1]||300*this.retryCount}}]),n}(Nt),oe=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,ue.create(t))).requestOptions=i.opts,i.opts.url&&i.createXhr(),i}return(0,Q.default)(n,[{key:"createXhr",value:function(){var t=this;this.request(this.requestOptions).then((function(e){var n=e.response,i=e.getResponseHeader("content-type"),r=n;if("text"===t.requestOptions.responseType&&i)if(i.includes("application/smil")||i.includes("application/xml")){var u=new DOMParser;r=u.parseFromString(r,"application/xml")}else(null==i?void 0:i.includes("application/json"))&&(r=JSON.parse(r));204!==e.status&&null==r?t.emitCompleteWithError("Unable to parse response."):setTimeout((function(){t.emitComplete({contentType:i,data:r})}),1)})).catch((function(e){if(t.shouldRetry())t.incrementAttempts(),setTimeout((function(){t.createXhr()}),t.retryInterval);else{var i=e.response||n.statusMessages[0];t.emitCompleteWithError(i)}}))}},{key:"request",value:function(t){return new Promise((function(e,n){t.query&&(t.url=ne.append(t.url,t.query));var i=new XMLHttpRequest;if(i.open(t.method,t.url),i.onload=function(){!1!==t.checkStatus&&i.status>399&&n(i),e(i)},i.onerror=function(t){n(i)},i.withCredentials=t.withCredentials,null!=t.responseType)try{i.responseType=t.responseType}catch(t){}if(null!=t.headers){var r=t.headers;Et.entries(r).forEach((function(t){var e=(0,H.default)(t,2),n=e[0],r=e[1];null!=n&&null!=r&&i.setRequestHeader(n,r)}))}return i.send(t.data)}))}},{key:"emitComplete",value:function(t){this.emit(n.event.COMPLETE,{response:t.data,contentType:t.contentType,error:!1})}},{key:"emitCompleteWithError",value:function(t){var e=Et.isString(t)?t:null,i=e?null:t;this.emit(n.event.COMPLETE,{status:i&&i.status,error:!0,url:this.requestOptions.url||"not available",message:e||this.getMsg((null==i?void 0:i.status)||0,(null==i?void 0:i.data)||null)})}},{key:"getMsg",value:function(t,e){var i=n.statusMessages[""+t];return i||(i=Et.isString(e)?e:"Unspecified error"),"XhrDataRequest error: "+i}}],[{key:"load",value:function(t){return new Promise((function(e,i){var r=t;r.onComplete=function(t){var n=t.detail;!n||n.error?i(n):e(n)},new n(r)}))}}]),n}(ae);function se(t){return t.query&&(t.url=ne.append(t.url,t.query)),oe.load(t).then((function(t){return t.response}))}oe.event={COMPLETE:"complete"},oe.statusMessages={0:"Request failed; blocked or timed out",500:"Server error encountered.",404:"Resource not found.",403:"Access denied."};var le=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"parseCaption",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.trim().split("\n"),r=/([0-9:.]+)\s*-->\s*([0-9:.]+)([^\n]*)/,u=/\s*([A-Za-z]+)\s*:\s*([\w\-%]+)/g;try{r.test(i[0])||(e=parseInt(i.shift()));var a=i[0].match(r).slice(1),o=a[2],s=Et.hmsToSec(a[0]),l=Et.hmsToSec(a[1]),c=i.slice(1).join("\n");return null!=o&&o.replace(u,(function(t,e,i){return n[e]=i})),ct({id:e,startTime:s,endTime:l,text:c},n)}catch(t){return null}}},{key:"parse",value:function(t){var e=this,n=(t=t.replace(/\r/g,"")).split("\n\n"),i=/^(WEBVTT|NOTE|STYLE)/;return n.reduce((function(t,n){if(!i.test(n)&&n){var r=e.parseCaption(n,t.length);r&&t.push(r)}return t}),[])}}]),t}(),ce=function(){function t(e,n){(0,_.default)(this,t),this.url=e,this.cues=n}return(0,Q.default)(t,[{key:"getCueAt",value:function(t){return this.cues.find((function(e){return e.startTime<=t&&e.endTime>=t}))}},{key:"renderCueAt",value:function(e,n){t.renderThumbnail(this.getCueAt(e),n)}}],[{key:"create",value:function(e){var n=document.createElement("a");n.href=e;var i=n.protocol+"//"+n.hostname,r=i+n.pathname.split("/").slice(0,-1).join("/")+"/";return se({url:e}).then((function(n){var u=le.parse(n);return u.forEach((function(t){var e=t.text.split("#"),n=(0,H.default)(e,2),u=n[0],a=n[1],o=u;/^(https?:)?\/\//.test(o)||(o=/^\//.test(o)?i+o:r+o);var s=a.split("="),l=s[0],c=s[1].split(","),h={backgroundImage:"url(".concat(o,")")},f={url:o};Et.forEach(l,(function(t,e){var n=c[e];switch(t){case"w":f.width=parseInt(n),h.width="".concat(n,"px");break;case"h":f.height=parseInt(n),h.height="".concat(n,"px");break;case"x":f.x=parseInt(n),h.backgroundPositionX="-".concat(n,"px");break;case"y":f.y=parseInt(n),h.backgroundPositionY="-".concat(n,"px")}})),t.style=h,t.data=f})),new t(e,u)}))}},{key:"renderThumbnail",value:function(t,e){(null==t?void 0:t.style)&&(null==e?void 0:e.style)&&Object.assign(e.style,t.style)}}]),t}(),he=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;(0,_.default)(this,n);var r=Object.assign({timeout:re.TIMEOUT},t||{});r.timeout||(r.timeout=re.TIMEOUT),(i=e.call(this,r)).timeoutHandles={},i.map={};var u=i.hasListenerFor(n.event.COMPLETE);if(i.opts.url&&u)i.loadScript(i.opts.url);else{if(!i.opts.urls||!u)throw new Error("Script load error: Missing url or listener. url: ".concat(i.opts.url||i.opts.urls,", hasListener: ").concat(u));i.loadScripts(i.opts.urls)}return i}return(0,Q.default)(n,[{key:"destroy",value:function(){if(this.timeoutHandles){for(var t in this.timeoutHandles)clearTimeout(this.timeoutHandles[t]);this.timeoutHandles=null,(0,B.default)((0,W.default)(n.prototype),"destroy",this).call(this)}}},{key:"loadScript",value:function(t,e){var i=this,r=document.createElement("script"),u="https:"===window.location.protocol?t.replace("http:","https:"):t;this.map[u]={hLoad:function(){return i.hLoadOrError(u)},hError:function(){return i.hLoadOrError(u,!0,!1)},scriptEl:r};var a=this.map[u];e&&this.on(n.event.COMPLETE,e),r.async=!0,r.addEventListener("load",a.hLoad),r.addEventListener("error",a.hError),this.timeoutHandles[u]=setTimeout((function(){return i.hLoadOrError(u,!0,!0)}),this.opts.timeout),document.head.appendChild(r),r.src=u}},{key:"loadScripts",value:function(t,e){e&&this.on(n.event.COMPLETE,e);for(var i=0,r=t.length;i<r;i++)this.loadScript(t[i])}},{key:"hLoadOrError",value:function(t,e,i){var r=this;clearTimeout(this.timeoutHandles[t]),delete this.timeoutHandles[t];var u=this.map[t];for(var a in u.scriptEl.removeEventListener("load",u.hLoad),u.scriptEl.removeEventListener("error",u.hError),u)delete u[a];delete this.map[t],e&&this.shouldRetry()?(this.incrementAttempts(),setTimeout((function(){r.loadScript(t)}),this.retryInterval)):this.emit(n.event.COMPLETE,{url:t,error:e,timedOut:!0===i})}}],[{key:"load",value:function(t){return new Promise((function(e,i){t.onComplete=function(t){var n=t.detail;return n.error||n.timedOut?i(n):e(n)},new n(t)}))}}]),n}(ae);he.event={COMPLETE:"complete"};var fe=function(t){return t.ANDROID="Android",t.CHROME="Chrome",t.CHROME_IOS="Chrome-iOS",t.FIREFOX="Firefox",t.FIREFOX_IOS="Firefox-iOS",t.EDGE="Edge",t.MSIE="MSIE",t.SAFARI="Safari",t.OPERA="Opera",t.OPERA_MOBILE="Opera-Mobile",t.SILK="Silk",t.PLAYSTATION_4_WEBMAF="PlayStation 4 (WebMAF)",t.PLAYSTATION_5="PlayStation 5 (Media Source API)",t.UNKNOWN="Unknown",t}(fe||{}),ve=function(t){return 100*Math.round(t/100)},de={br:ve,d:function(t){return Math.round(t)},bl:ve,dl:ve,mtp:ve,nor:function(t){return encodeURIComponent(t)},rtp:ve};function ye(t){return function(t,e){var n=[];if(!t)return n;return Object.keys(t).sort().forEach((function(i){var r=t[i];if(function(t){return null!=t&&""!==t&&!1!==t}(r)&&!("v"===i&&1===r||"pr"===i&&1===r)){var u=de[i];u&&(r=u(r));var a=e(r,i,t);n.push(a)}})),n}(t,(function(t,e){var n=(0,q.default)(t);return"symbol"===n?"".concat(e,"=").concat(t.description):"ot"===e||"sf"===e||"st"===e?"".concat(e,"=").concat(t):"boolean"===n?e:"number"===n?"".concat(e,"=").concat(t):"".concat(e,"=").concat(JSON.stringify(t))})).join(",")}function Ae(t,e){var n=function(t){return t?"CMCD=".concat(encodeURIComponent(ye(t))):""}(e);if(!n)return t;var i=t.includes("?")?"&":"?";return"".concat(t).concat(i).concat(n)}var ke=dt(pt(),1),pe=function(t){return t.DESKTOP="Desktop",t.ANDROID_PHONE="Android Phone",t.WINDOWS_PHONE="Windows Phone",t.IPHONE="iPhone",t.IPOD="iPod",t.IPAD="iPad",t.KINDLE="Kindle",t.TABLET="Tablet",t.MOBILE="Mobile",t.EMBEDDED="Embedded",t.LG_SMART_TV="LG Smart Tv",t.VIZIO_SMART_TV="Vizio Smart Tv",t.SAMSUNG_SMART_TV="Samsung Smart Tv",t.COMCAST_X1="Comcast X1",t.XBOX_ONE="Xbox One",t.CHROMECAST="Chromecast",t.PLAYSTATION_4="PlayStation 4",t.PLAYSTATION_5="PlayStation 5",t.SKY_Q="Sky Q",t.UNKNOWN="UNKNOWN",t}(pe||{}),me=function(t){return t.OSX="OS X",t.WINDOWS="Windows",t.WINDOWS7="Windows 7",t.WINDOWS8="Windows 8",t.WINDOWS10="Windows 10",t.WINDOWS_VISTA="Windows Vista",t.WINDOWS_PHONE="Windows Phone",t.IOS="iOS",t.ANDROID="Android",t.CHROMIUM="Chromium",t.WEBOS="Web0S",t.SMARTCAST="SmartCast",t.TIZEN="Tizen",t.ORBIS="Orbis OS",t.PROSPERO="Prospero OS",t.UNKNOWN="Unknown",t}(me||{}),ge=function(t){return t.MAC="Macintosh",t.WINDOWS="Windows",t.LINUX="Linux",t.UNKNOWN="Unknown",t}(ge||{}),be={video:{HLS:"application/vnd.apple.mpegurl",AVC:"video/mp4; codecs=avc1.4D401E,mp4a.40.2",HEVC:"video/mp4; codecs=hev1.1.2.L93.B0",WEBM_VP8:"video/webm; codecs=vp8, opus, vorbis",WEBM_VP9:"video/webm; codecs=vp9, opus, vorbis"},audio:{AVC:"audio/mp4; codecs=avc1.4D401E,mp4a.40.2",HEVC:"audio/mp4; codecs=hev1.1.2.L93.B0",WEBM_VP8:"audio/webm; codecs=vp8, opus, vorbis",WEBM_VP9:"audio/webm; codecs=vp9, opus, vorbis"}};var we=function(t){if(!t)return{global:t};var e=function(t,e,n){var i=t.test(e),r="Android"===n.os?"Android":"Safari";return i&&"Unknown"!==n.os?r:null},n=function(t){var e={majorVersion:null,minorVersion:null,versionString:t||null};if(t){var n=t.split("."),i=parseInt(n[0],10),r=parseInt(n[1],10);!isNaN(i)&&(e.majorVersion=i),!isNaN(r)&&(e.minorVersion=r)}return e},i=navigator.userAgent,r=function(t){var e=t.toLowerCase(),n={os:"Unknown",platform:"Unknown",osVersion:"",device:"UNKNOWN"};if(e.indexOf("fxios")>=0)return n.os="iOS",n.platform="Macintosh",e.indexOf("iphone")>=0?n.device="iPhone":n.device="iPad",n;if(e.indexOf("crkey")>=0)return n.platform="Linux",n.device="Chromecast",n;var i=/\s(\([^)]+\))/.exec(t);if(i&&i.length&&i.length>1)for(var r=i[1].replace(/_/gi,"."),u=[function(t,e){return function(t,e){var n=new RegExp("Linux","i"),i=navigator.userAgentData,r=navigator.platform||(null==i?void 0:i.platform),u=/Linux armv/.test(r);if(n.test(t)||t.indexOf("Android")>=0){if(e.platform="Linux",e.device="UNKNOWN",t.indexOf("Chromium")>=0){var a=/Chromium\/([\d+\.]*)\s/.exec(t);e.os="Chromium",e.osVersion=a&&a[1]||""}else if(t.indexOf("Android")>=0){var o=/ Android ([^\s]+);/.exec(t);e.os="Android",e.osVersion=o&&o[1]||"",e.device="Android Phone"}else if(t.indexOf("Web0S")>=0)e.os="Web0S",e.osVersion="n/a",e.device="LG Smart Tv";else if(t.indexOf("SmartCast")>=0)e.os="SmartCast",e.osVersion="n/a",e.device="Vizio Smart Tv";else if(t.indexOf("Tizen")>=0){var s=/Tizen ([^\s]+)(;|\))/.exec(t);e.os="Tizen",e.osVersion=s&&s[1]||"",e.device="Samsung Smart Tv"}else"undefined"!=typeof $badger||/ Xfinity/.test(t)||/ WPE/.test(t)?(e.os="Linux",e.osVersion="n/a",e.device="Comcast X1"):t.indexOf("Sky")>=0?(e.os="Linux",e.osVersion="n/a",e.device="Sky Q"):u&&(e.os="Linux",e.osVersion="n/a",e.device="Embedded");return!0}return!1}(t,e)},function(t,e){return function(t,e){if(t.indexOf("Macintosh")>=0){e.platform="Macintosh",navigator.userAgent.match(/(iPad)/)||navigator.maxTouchPoints>1?(e.device="iPad",e.os="iOS"):t.indexOf("OS X")>=0&&(e.device="Desktop",e.os="OS X");var n=/Mac OS X ([\d.]+)/.exec(t);return e.osVersion=n&&n[1]?n[1]:null,!0}if(-1!==t.indexOf("like Mac OS X")){e.platform="Macintosh",e.os="iOS",e.device="UNKNOWN";var i=/\sOS\s([^\s]*)\s/.exec(t);i&&i[1]&&(e.osVersion=i[1]);for(var r=[/\(iPhone;/,/\(iPad;/,/\(iPod;/],u=["iPhone","iPad","iPod"],a=r.length;a--;)if(r[a].test(t))return e.device=u[a],!0;return!0}return!1}(t,e)},function(t,e){return function(t,e){var n=/(Windows Phone |Windows Phone OS )([^\s]+);/.exec(t);if(n&&n[2])return e.platform="Windows",e.os="Windows Phone",e.osVersion=n[2],e.device="Windows Phone",!0;var i=/Windows NT ([^\s]+)[;\)]/.exec(t);if(e.device="Desktop",i&&i[1]){e.platform="Windows",e.os="Windows";var r=i[1];if(/Xbox; Xbox One/.test(t)&&(e.device="Xbox One"),10===parseInt(r))e.os="Windows 10",e.osVersion=r;else switch(r){case"6.0":e.os="Windows Vista";break;case"6.1":e.os="Windows 7",e.osVersion="7";break;case"6.2":e.os="Windows 8",e.osVersion="8"}return!0}return!1}(t,e)}],a=u.length;a--;){if((0,u[a])(0===a?t:r,n))break}return n}(i),u=function(t,n){var i,r=(i={},(0,K.default)(i,"Chrome",/Chrome\/(\S+)/),(0,K.default)(i,"Chrome-iOS",/CriOS\/(\S+)/),(0,K.default)(i,"Firefox-iOS",/FxiOS\/(\S+)/),(0,K.default)(i,"Edge",/ Edge?\/([^\s]+)/),(0,K.default)(i,"Firefox",/Firefox\/(\S+)/),(0,K.default)(i,"Opera",/Opera|OPR\/(\S+)/),(0,K.default)(i,"Safari",/Version\/(\S+).*Safari/),(0,K.default)(i,"MSIE",/MSIE ([^\s]+)[);] Windows/),(0,K.default)(i,"Android",/Android/),(0,K.default)(i,"Silk",/Silk\/(\S+)/),(0,K.default)(i,"PlayStation 4 (WebMAF)",/Playstation 4 (WebMAF) (\S+)/),(0,K.default)(i,"PlayStation 5 (Media Source API)",/PlayStation 5/),(0,K.default)(i,"Unknown",null),i),u=r["Chrome-iOS"].test(t),a=function(t,e,n){var i=e&&e.exec(n),r={browser:t,browserVersion:"0",browserMajorVersion:0};if(i&&i.length&&i.length>1)if(r.browserVersion=i[1]||"",r.browserVersion.indexOf(".")){var u=r.browserVersion.split(".");if(Array.isArray(u)&&u.length){var a=parseInt(u[0]);!isNaN(a)&&(r.browserMajorVersion=a)}}else{var o=parseInt(r.browserVersion);!isNaN(o)&&(r.browserMajorVersion=o)}return r};if((r.Chrome.test(t)||u)&&!r.Opera.test(t)&&!r.Edge.test(t)){var o=u?"Chrome-iOS":"Chrome";return a(o,r[o],t)}var s=function(t,e,n){var i=/Trident.[^\s]+;.*rv:([^\s]+)[);]/;return e.test(n)?{browser:"MSIE",re:e}:t.test(n)?{browser:"Edge",re:t}:i.test(n)?{browser:"MSIE",re:i}:{browser:"Unknown",re:null}}(r.Edge,r.MSIE,t);if("Unknown"!==s.browser)return a(s.browser,s.re,t);for(var l in r)switch(l){case"Firefox":case"Firefox-iOS":case"Silk":case"Android":if(r[l].test(t))return"Silk"===l&&(n.device="Kindle"),a(l,r[l],t);break;case"PlayStation 4 (WebMAF)":case"PlayStation 5 (Media Source API)":if(r["PlayStation 5 (Media Source API)"].test(t)||r["PlayStation 4 (WebMAF)"].test(t)){var c=r["PlayStation 5 (Media Source API)"].test(t),h=c?"PlayStation 5 (Media Source API)":"PlayStation 4 (WebMAF)";return n.device=c?"PlayStation 5":"PlayStation 4",n.platform=c?"PlayStation 5":"PlayStation 4",n.os=c?"Prospero OS":"Orbis OS",a(h,r[h],t)}case"Safari":if(e(r[l],t,n))return a(l,r[l],t);break;case"Opera":var f=r[l].exec(t);if(f)return a(f.indexOf("Opera Mini/")>=0||f.indexOf("Opera Mobi")>=0?"Opera-Mobile":"Opera",r[l],t)}return a("Unknown",r.Unknown,t)}(i,r),a=r.os,o=r.platform,s=r.osVersion,l=r.device,c=u.browser,h=u.browserVersion,f=null,v=null;s&&Et.isString(s)&&(f=n(s)),h&&Et.isString(h)&&(v=n(h));var d=function(){switch(l){case"LG Smart Tv":case"Vizio Smart Tv":case"Samsung Smart Tv":case"Comcast X1":case"Sky Q":return!0;default:return!1}}(),y="Desktop"===l,A=function(){switch(l){case"PlayStation 4":case"PlayStation 5":case"Xbox One":return!0;default:return!1}}(),k=!!(null==t?void 0:t.WebKitMediaSource),p=!(!(null==t?void 0:t.MediaSource)&&!k),m=function(e){var n=!1;if(!t)return!1;if(k?n=t.WebKitMediaSource.isTypeSupported(e):p&&(n=t.MediaSource.isTypeSupported(e)),!n){var i=document.createElement("video");Et.isObject(i)&&Et.isFunction(i.canPlayType)&&("probably"!==i.canPlayType(e)&&"maybe"!==i.canPlayType(e)||(n=!0))}return n},g=m(be.video.WEBM_VP8),b=m(be.video.WEBM_VP9),w=d||A;return{appNamespace:null,document:null==t?void 0:t.document,global:t,browser:c,browserVersionInfo:v,device:l,os:a,osVersionInfo:f,platform:o,isAndroid:"Android Phone"===l||"Android"===a,isChromecast:"Chromecast"===l,isDesktop:y,isEmbedded:"Embedded"===l,isIos:"iOS"===a,isMobile:!y,isTizen:"Samsung Smart Tv"===l,isTv:d,isConsole:A,isWebkit:k,isWebMaf:!!(null==t?void 0:t.WM_videoPlayer),isWebOs:"Web0S"===a,isXboxOne:"Xbox One"===l,hasFullscreenApi:ke.default.isEnabled,hasMediaSource:p,hasEncryptedMediaSource:!!t&&!!(t.MediaKeys||t.WebKitMediaKeys||t.MSMediaKeys),supportsVp8:g,supportsVp9:b,supportsWebM:g||b,supportsMediaDecodeConfigurations:!!(null==navigator?void 0:navigator.mediaCapabilities),supportsNativeHls:m(be.video.HLS),supportsRequestMediaKeySystemAccess:!!(null==t?void 0:t.MediaKeySystemAccess),supportsUnrestrictedAutoplay:w}}("object"===("undefined"==typeof window?"undefined":(0,q.default)(window))?window:null),Te=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,null,[{key:"renderThumbnail",value:function(t,e){ce.renderThumbnail(t,e)}},{key:"request",value:function(t){return se(t)}},{key:"loadScript",value:function(t,e){var n=e||{},i=n.overrides,r=n.networkTimeout;return he.load({url:we.isWebOs?Et.makeUrl(!0,t.url):t.url,timeout:(null==i?void 0:i.streamingLibLoaderTimeout)||r,errorRecovery:Et.merge({},null==e?void 0:e.networkErrorRecovery,t.errorRecovery)})}},{key:"loadSdk",value:function(t,e,i){return kt(this,null,D.default.mark((function r(){return D.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!=typeof e){r.next=10;break}if(r.prev=1,t()){r.next=5;break}return r.next=5,n.loadScript({url:e},i);case 5:r.next=9;break;case 7:r.prev=7,r.t0=r.catch(1);case 9:return r.abrupt("return",t());case 10:return r.abrupt("return",e);case 11:case"end":return r.stop()}}),r,null,[[1,7]])})))}},{key:"smpteToVtt",value:function(t,e){return kt(this,null,D.default.mark((function i(){var r,u,a,o,s,l;return D.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.request({url:t,responseType:"document"});case 2:if(r=i.sent,(u=r.querySelectorAll("tt body div p")).length){i.next=6;break}throw new Error("No cues found in ".concat(t));case 6:a="Safari"===we.browser?"middle":"center",o="Safari"===we.browser?-1:0,s=void 0!==we.global.VTTCue,l=s?we.global.VTTCue:we.global.TextTrackCue,u.forEach((function(t,i,r){if(!n.isEmpty(t.textContent)){var u=t.textContent.replace(/(.*)<span.*tts:fontStyle="italic">(.*)<\/span>(.*)/g,"$1<i>$2</i>$3").replace(/(.*)<span.*tts:fontWeight="bold">(.*)<\/span>(.*)/g,"$1<b>$2</b>$3").replace(/(.*)<span.*tts:textDecoration="under">(.*)<\/span>(.*)/g,"$1<u>$2</u>$3"),c=n.getNumLines(u);t._lineCountPrev=t._lineCountPrev||0,t._lineCountNext=t._lineCountNext||0;for(var h=i+1,f=r[h],v=t.getAttribute("begin");(null==f?void 0:f.getAttribute("begin"))===v;)f._lineCountPrev=c+t._lineCountNext,t._lineCountNext+=n.getNumLines(f.textContent),f=r[++h];var d=new l(n.hmsToSec(v),n.hmsToSec(t.getAttribute("end")),u);if(d.align=t.getAttribute("tts:textAlign"),s){var y=t.querySelector("metadata");if(y){d.snapToLines=!0;var A=parseInt(y.getAttribute("cccol")),k=parseInt(y.getAttribute("ccrow")),p=Math.round(A/35*100);d.position=p;try{d.align=p<45?"start":p>55?"end":a}catch(t){d.align="center"}d.positionAlign=p<45?"line-left":p>55?"line-right":"center",d.line=k-17+o}}try{e.addCue(d)}catch(t){}}}));case 11:case"end":return i.stop()}}),i)})))}},{key:"createSidecarTextTrack",value:function(t,e){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"English",a=null==(i=t.location)?void 0:i.textTrackUrl;if(!a)return Promise.reject("Invalid text track url");var o=a.indexOf(".vtt")>=0,s=t.cmcd;if(s.enabled&&(a=Ae(a,{ot:"c",su:!0,sid:s.sessionId,cid:s.contentId,pr:e.playbackRate,v:1})),o){var l=document.createElement("track");return l.kind="captions",l.label=u,l.srclang=r,l.id="sidecar-vtt",l.src=a,e.appendChild(l),Promise.resolve(l.track)}var c=e.addTextTrack("captions",u,r);return n.smpteToVtt(a,c).then((function(){return c}))}}]),n}(Et),Pe=function(t){return t.INVALID_RESOURCE_FORMAT="1000",t.RESOURCE_UNAVAILABLE="1100",t.GEO_LOCATION_BLOCKED="1101",t.DOMAIN_BLOCKED="1102",t.IP_BLOCKED="1103",t.SATELLITE_PROVIDER_BLOCKED="1104",t.EXPIRED="1105",t.SELECTOR_CALL_ERROR="1106",t.IMA_SDK_MISSING="1200",t.DAI_SDK_MISSING="1201",t.DASH_SDK_MISSING="1202",t.HLS_SDK_MISSING="1203",t.SHAKA_SDK_MISSING="1204",t.TWITCH_SDK_MISSING="1205",t.FW_SDK_MISSING="1206",t.HLSJS_PARSE_ERROR="2101",t.DASHJS_PARSE_ERROR="2102",t.SHAKA_PARSE_ERROR="2103",t.TWITCH_PARSE_ERROR="2104",t.WEBMAF_START_ERROR="2105",t.USER_GESTURE_REQUIRED="2300",t.HTML5_NETWORK_ERROR="3001",t.HLSJS_NETWORK_ERROR="3002",t.DASHJS_NETWORK_ERROR="3003",t.WEBMAF_NETWORK_ERROR="3004",t.SHAKA_NETWORK_ERROR="3005",t.TWITCH_NETWORK_ERROR="3006",t.MEDIA_ABORTED="3100",t.HTML5_SRC_NOT_SUPPORTED="3101",t.HLSJS_SRC_NOT_SUPPORTED="3102",t.DASHJS_SRC_NOT_SUPPORTED="3103",t.SHAKA_SRC_NOT_SUPPORTED="3105",t.TWITCH_SRC_NOT_SUPPORTED="3106",t.HTML5_MEDIA_ERROR="3200",t.HLSJS_MEDIA_ERROR="3201",t.HLSJS_MUX_ERROR="3202",t.DASHJS_MEDIA_ERROR="3203",t.SHAKA_MEDIA_ERROR="3205",t.TWITCH_MEDIA_ERROR="3206",t.FAIRPLAY_APP_CERT_ERROR="3300",t.FAIRPLAY_LIC_ERROR="3301",t.DASHJS_DRM_ERROR="3302",t.SHAKA_DRM_ERROR="3304",t.UNSPECIFIED_VIDEO_PLAYBACK_ERROR="3400",t.UNSPECIFIED_HLSJS_ERROR="3401",t.UNSPECIFIED_DASHJS_ERROR="3402",t.UNSPECIFIED_SHAKA_ERROR="3404",t.UNSPECIFIED_TWITCH_ERROR="3405",t.AD_STALLED="4000",t.IMA_INIT_FAILURE="4100",t.IMA_AD_ERROR="4101",t.DAI_DATA_ERROR="4200",t.DAI_NETWORK_ERROR="4201",t.AD_BLOCKING_DETECTED="4300",t.AD_ADAPTER_ERROR="4400",t.ADAPTER_NOT_FOUND="5000",t.UNEXPECTED_CONDITION="9999",t}(Pe||{}),xe=function(t){return t.AUTO="auto",t.MANUAL="manual",t.UNAVAILABLE="unavailable",t}(xe||{}),Se=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t)).cause=i,r}return(0,Q.default)(n)}((0,U.default)(Error)),Ce=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i,r){var u,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;return(0,_.default)(this,n),(u=e.call(this,i,r)).code=t,u.fatal=a,u.category=o,u.name="PlayerError",u}return(0,Q.default)(n)}(Se);function Me(t){return new Promise((function(e){return setTimeout(e,t)}))}function Ee(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new Promise((function(n,i){var r=setInterval((function(){t()&&(clearInterval(r),n())}),e)}))}function Ne(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN;return"number"==typeof n&&(i=n),new Promise((function(r,u){var a,o=[],s=function(){return o.forEach((function(t){return t()}))},l=function(e,n){var i=t.on?"on":"addEventListener",r=t.off?"off":"removeEventListener",u=function(t,n){clearTimeout(a),s(),e(n||t)};t[i](n,u),o.push((function(){return t[r](n,u)}))};l(r,e),"string"==typeof n&&l(u,n),i>-1&&(a=setTimeout((function(){s(),u(new Error("timeout"))}),i))}))}function Ve(t,e,n){return n||(n=t instanceof HTMLVideoElement?"currentTime":"contentTime"),Ee((function(){return t[n]>=e}))}var Ie=function(t){return t.ABORT="abort",t.CAN_PLAY="canplay",t.CAN_PLAY_THROUGH="canplaythrough",t.DURATION_CHANGE="durationchange",t.ENDED="ended",t.ERROR="error",t.LOADED_METADATA="loadedmetadata",t.LOAD_START="loadstart",t.PAUSE="pause",t.PLAY="play",t.PLAYING="playing",t.PROGRESS="progress",t.RATE_CHANGE="ratechange",t.SEEKED="seeked",t.SEEKING="seeking",t.STALLED="stalled",t.TIME_UPDATE="timeupdate",t.VOLUME_CHANGE="volumechange",t}(Ie||{}),Re=function(t){return t.CUE_CHANGE="cuechange",t.ADD_TRACK="addtrack",t.CHANGE="change",t}(Re||{}),Oe=function(t){return t.SHOWING="showing",t.HIDDEN="hidden",t.DISABLED="disabled",t}(Oe||{}),De="*",Le=function(){function t(e,n){var i,r=this;(0,_.default)(this,t),this.id3Map=[],this.daiId3=/^google_/,this.maxId3DedupeLength=t.MAX_ID3_DEDUPE_LENGTH,this.onTextTrackAdded=function(t){var e=t.track;r.isValidTrack(e)&&(e.mode="hidden",e.addEventListener("cuechange",r.onCueChange))},this.onCueChange=function(t){var e=t.target,n=e&&e.activeCues;n&&n.length&&Et.forEach(n,(function(t){return r.processId3(t)}))},this.onSeeking=function(){r.clearId3()},this.onMetadataCuepoint=n,this.video=e.video,this.id3OwnerIds=["com.cbsi.live.sg"].concat(e.resource.playback.id3OwnerIds||[]);var u=null==(i=e.playerOptions.overrides)?void 0:i.maxId3DedupeLength;null!=u&&(this.maxId3DedupeLength=u),this.addEvents(),this.logger=e.logger,this.logger.log("info","MetadataSurface created"),Et.forEach(this.video.textTracks,(function(t){return r.onTextTrackAdded({track:t})}))}return(0,Q.default)(t,[{key:"destroy",value:function(){var t=this;this.onMetadataCuepoint=null,this.id3Map=null,this.removeEvents(),Et.forEach(this.video.textTracks,(function(e){return t.cleanupTrack(e)}))}},{key:"addEvents",value:function(){this.video.textTracks.addEventListener("addtrack",this.onTextTrackAdded),this.video.addEventListener("seeking",this.onSeeking)}},{key:"removeEvents",value:function(){var t=this;this.video.textTracks.removeEventListener("addtrack",this.onTextTrackAdded),this.video.removeEventListener("seeking",this.onSeeking),Et.forEach(this.video.textTracks,(function(e){return e.removeEventListener("cuechange",t.onCueChange)}))}},{key:"clearId3",value:function(){this.id3Map=[]}},{key:"cleanupTrack",value:function(t){function e(e){try{e&&t.removeCue(e)}catch(t){}}"metadata"===t.kind&&(Et.forEachReverse(t.cues,e),Et.forEachReverse(t.activeCues,e))}},{key:"processId3",value:function(t){if(!Et.isEmpty(t.value)){var e=t.value,n=t.startTime,i=t.endTime,r=e.key,u=e.info,a=void 0===u?"":u,o=e.data,s={key:r,info:a,data:o,startTime:n,endTime:i};if("TXXX"===r&&this.daiId3.test(o)?(Et.isEmpty(a)&&(s.info=o),s.id="google_dai"):s.id=this.id3OwnerIds.find((function(t){return t===De||a.includes(t)})),s.id){var l;try{l=o instanceof ArrayBuffer?Et.bufferToString(o):o}catch(t){l=""}"PRIV"===r&&this.id3OwnerIds[0]===a&&(s.data=l),s.text=l,this.id3Map.some((function(t){return t.info===s.info&&t.startTime===s.startTime&&t.text===s.text}))||(this.id3Map.length>this.maxId3DedupeLength&&this.id3Map.pop(),this.id3Map.unshift(s),this.onMetadataCuepoint(s))}}}},{key:"isMetadataTrack",value:function(t){return"metadata"===t}},{key:"isExpired",value:function(t){return t.expired}},{key:"isValidTrack",value:function(t){return!!t&&!!this.isMetadataTrack(t.kind)&&!this.isExpired(t)}}]),t}();Le.MAX_ID3_DEDUPE_LENGTH=32;var Fe=function(){function t(e,n){var i=this;(0,_.default)(this,t),this.pTextTracks=null,this.currentTextTrack=null,this.currentTextTrackMode="disabled",this.existingTrack=[],this.onVideoTextTrackAdded=function(t){t.track.expired=!1,i.onTextTrackAdded(t)},this.onTextTrackAdded=function(t){var e=t.track,n="subtitles"===e.kind&&!e.language&&!e.label;"metadata"===e.kind||n||i.addTracks()},this.onTextTrackChange=function(t){i.processTracks()},this.onCueChange=function(t){var e=t.target;switch(e.kind){case"captions":case"subtitles":var n=Et.dedupeCues(e);i.emit("textCuepoint",{activeCues:n})}},this.config=e,this.video=e.video,this.pTextTracks=this.video.textTracks,this.currentTextTrackMode=e.textTrackSettings.mode,this.emit=n||function(){},this.processTracks=Et.debounce(this.processTracks.bind(this),100),this.addTracks=Et.debounce(this.addTracks.bind(this),25),this.addEvents(),this.logger=e.logger,this.logger.log("info","TextTrackSurface created"),this.config.resource.location.textTrackUrl&&Te.createSidecarTextTrack(this.config.resource,this.video)}return(0,Q.default)(t,[{key:"destroy",value:function(){var t=this;this.emit=null,this.removeEvents(),Et.forEach(this.pTextTracks,(function(e){return t.cleanupTrack(e)})),Et.forEach(this.video.querySelectorAll("track"),(function(e){return t.video.removeChild(e)}))}},{key:"clearCue",value:function(){Et.clearCue(this.currentTextTrack,this.video.currentTime)}},{key:"cleanupTrack",value:function(t){if(this.isTextTrack(t.kind)){Et.forEachReverse(t.cues,e),Et.forEachReverse(t.activeCues,e),t.expired=!0,t.textTrack1=!0,t.textTrack2=!0,t.isTTML=!0,t.isEmbedded=!1;try{t.mode="disabled"}catch(t){}}function e(e){try{e&&t.removeCue(e)}catch(t){}}}},{key:"textTrackMode",set:function(t){this.currentTextTrack?this.setTrackMode(t):this.logger.log("warn","No text track detected")}},{key:"textTrack",get:function(){return this.currentTextTrack},set:function(t){var e=this;this.isValidTrack(t)&&t!==this.currentTextTrack&&(this.currentTextTrack&&"disabled"!==this.currentTextTrack.mode&&(this.currentTextTrack.mode="disabled"),this.currentTextTrack=t,this.setTrackMode(this.currentTextTrackMode).then((function(){e.logger.log("info","".concat(t.language," is being set as the current text track")),e.emit("textTrackChange",t)})))}},{key:"textTracks",get:function(){var t=this;return Array.from(this.pTextTracks).filter((function(e){return t.isValidTrack(e)}))}},{key:"setTrackMode",value:function(t){var e=this;return new Promise((function(n,i){var r=t!==e.currentTextTrackMode,u=function(){e.currentTextTrack.mode=t,r&&setTimeout((function(){return e.emit("textTrackModeChange",{mode:t})}),0);var i="disabled";"hidden"===t&&(i="enabled for event driven external custom rendering"),"showing"===t&&(i="enabled for native rendering by the user agent"),e.logger.log("info","The ".concat(e.currentTextTrack.kind," track for language code ").concat(e.currentTextTrack.language," is being ").concat(i," ")),n()};e.currentTextTrackMode=t,"showing"===t&&"disabled"===e.currentTextTrack.mode?(e.currentTextTrack.mode="hidden",setTimeout(u,10)):u()}))}},{key:"addTrack",value:function(t){t.addEventListener("cuechange",this.onCueChange),this.logger.log("info","A ".concat(t.kind," text track was added")),this.emit("textTrackAdded",t)}},{key:"addTracks",value:function(){var t=this;if(Et.forEach(this.pTextTracks,(function(e){var n=t.isExpired(e)||t.isDuplicateTrack(e);e.mode=n?"disabled":"hidden",n||t.addTrack(e)})),!this.currentTextTrack){if(this.textTrack=Et.findDefaultTrack(this.textTracks,this.config.textTrackSettings.language),!this.textTrack)return;this.textTrack.mode=this.config.textTrackSettings.mode,this.emit("textTrackAvailable")}this.processTracks()}},{key:"processTracks",value:function(){var t=this,e=this.config.textTrackSettings,n=e.enabled,i=e.native,r=e.enabledMode,u=this.textTracks;if(Et.forEach(this.pTextTracks,(function(e){t.isExpired(e)&&"disabled"!==e.mode&&(e.mode="disabled")})),i){var a=u.find((function(t){return"showing"===t.mode}));if(n){if(a===this.currentTextTrack)return;a?this.textTrack=a:this.textTrackMode="disabled"}else{if(!a)return;a!==this.currentTextTrack&&(this.textTrack=a),this.textTrackMode="showing"}}else if(n){var o=u.find((function(t){return"showing"===t.mode}));o&&(o.mode=r)}else{var s=u.find((function(t){return"disabled"!==t.mode}));s&&(s.mode="disabled")}}},{key:"addEvents",value:function(){this.pTextTracks.addEventListener("addtrack",this.onTextTrackAdded),this.pTextTracks.addEventListener("change",this.onTextTrackChange),this.video.addEventListener("addtrack",this.onVideoTextTrackAdded)}},{key:"removeEvents",value:function(){var t=this;this.pTextTracks.removeEventListener("addtrack",this.onTextTrackAdded),this.pTextTracks.removeEventListener("change",this.onTextTrackChange),this.video.removeEventListener("addtrack",this.onVideoTextTrackAdded),Et.forEach(this.pTextTracks,(function(e){return e.removeEventListener("cuechange",t.onCueChange)}))}},{key:"isDuplicateTrack",value:function(t){if(this.existingTrack.includes(t))return!1;var e=this.existingTrack.some((function(e){return t.language===e.language&&t.label===e.label&&t.kind===e.kind}));return e||this.existingTrack.push(t),e}},{key:"isTextTrack",value:function(t){return"captions"===t||"subtitles"===t}},{key:"isExpired",value:function(t){return t.expired}},{key:"isValidTrack",value:function(t){return!!t&&!!this.isTextTrack(t.kind)&&!this.isExpired(t)}}]),t}(),Ue=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,_.default)(this,t),this.metadataLoaded=!1,this.suppressErrors=!1,this.multiCdnHeaderPresent=!0,this.segmentDuration=6,this.pauseTime=NaN,this.eventsEnabled=!1,this.liveStreamInfo={isPlayingLive:!1,liveEdgeOffset:NaN,dvrWindowSize:NaN,safeSeekingDuration:NaN,safeSeekingTime:NaN,relativeTime:NaN,relativeDuration:NaN,absoluteStart:NaN,absoluteTime:NaN,absoluteDuration:NaN},this.lastKnownTimes={absolute:NaN,relative:NaN,end:NaN},this.textTrackInfo={track:null,tracks:[]},this.qualityInfo={quality:null,qualities:[],mode:"auto"},this.audioTrackInfo={track:null,tracks:[]},this.minBitrate=0,this.maxBitrate=1/0,this.onVideoEvent=function(t){if(n.eventsEnabled){var e=n.delegate;if("loadedmetadata"===t.type&&(n.metadataLoaded=!0),n.metadataLoaded||"durationchange"===t.type)switch(t.type){case"timeupdate":e.timeUpdate();break;case"playing":e.playing();break;case"pause":n.metadataLoaded&&e.paused();break;case"seeking":e.seeking();break;case"seeked":e.seeked();break;case"ended":e.ended();break;case"durationchange":e.durationChange();break;case"volumechange":e.volumeChange(n.video.volume,n.video.muted);break;case"error":n.suppressErrors||n.error(n.createVideoElementError())}}},this.onTextEvent=function(t,e){if(n.eventsEnabled){var i=n.delegate;switch(t){case"textCuepoint":i.textCuepoints(e.activeCues);break;case"textTrackModeChange":i.textTrackDisplayModeChange(e.mode);break;case"textTrackAdded":n.textTrackInfo.tracks.push({id:n.textTrackInfo.tracks.length.toString(),kind:e.kind,language:e.language,label:e.label||e.language});break;case"textTrackAvailable":i.textTracksChange(n.textTrackInfo.tracks);break;case"textTrackChange":var r=n.textTrackInfo.tracks.find((function(t){return e.language===t.language&&e.kind===t.kind&&(e.label===t.label||e.language===t.label)}));n.textTrackInfo.track=r,i.textTrackChange(r)}}},this.context=e,this.options=i,this.video=e.video,this.delegate=this.context.getDelegate(),this.logger=e.logger,this.metadataSurface=this.createMetadataSurface(),r&&(this.textTrackSurface=this.createTextTrackSurface()),Te.values(Ie).forEach((function(t){return n.video.addEventListener(t,n.onVideoEvent)}))}return(0,Q.default)(t,[{key:"destroy",value:function(){var t,e,n=this;return Te.values(Ie).forEach((function(t){return n.video.removeEventListener(t,n.onVideoEvent)})),null==(t=this.metadataSurface)||t.destroy(),this.metadataSurface=null,null==(e=this.textTrackSurface)||e.destroy(),this.textTrackSurface=null,this.context=null,this.options=null,this.delegate=null,this.logger=null,this.video=null,Promise.resolve()}},{key:"getIsLiveStream",value:function(){return this.video.duration===1/0}},{key:"setAutoQualitySwitching",value:function(t){throw new Error("setAutoQualitySwitching Method not implemented.")}},{key:"setQuality",value:function(t){throw new Error("setQuality Method not implemented.")}},{key:"setMinBitrate",value:function(t){this.minBitrate=t}},{key:"setMaxBitrate",value:function(t){this.maxBitrate=t}},{key:"setTextTrack",value:function(t){this.textTrackSurface&&(this.textTrackSurface.textTrack=t)}},{key:"setTextTrackMode",value:function(t){this.textTrackSurface&&(this.textTrackSurface.textTrackMode=t)}},{key:"setAudioTrack",value:function(t){throw new Error("setAudioTrack Method not implemented.")}},{key:"getId",value:function(){throw new Error("getId Method not implemented.")}},{key:"getCurrentTime",value:function(){var t=this.getSeekable(),e=t.start,n=t.end;return Te.mapToRange(this.video.currentTime,e,n,0,this.getDuration())}},{key:"getDuration",value:function(){var t=this.getSeekable(),e=t.start;return t.end-e}},{key:"getBufferLength",value:function(){var t=this.video,e=t.buffered,n=t.currentTime;return e.length>0?e.end(e.length-1)-n:0}},{key:"getLiveStreamInfo",value:function(){var t,e=this.liveStreamInfo,n=this.getSeekable(),i=n.start,r=n.end,u=this.video.currentTime,a=r-i,o=this.getSegmentDuration(),s=this.context.resource.playback.liveEdgeSyncFragmentCount,l=(null==(t=this.context.resource.overrides)?void 0:t.safeSeekDuration)||o;e.relativeTime=Math.max(u-i,0),e.relativeDuration=a,e.absoluteDuration=Date.now(),e.dvrWindowSize=Math.floor(a),e.liveEdgeOffset=o*s+o,e.safeSeekingTime=Math.ceil(i+l),e.safeSeekingDuration=Math.floor(r-l),e.isPlayingLive=Math.ceil(u+e.liveEdgeOffset)>=e.safeSeekingDuration,r!==this.lastKnownTimes.end&&(this.lastKnownTimes.end=r,e.absoluteStart=e.absoluteDuration-1e3*a,this.lastKnownTimes.absolute=Math.round(e.absoluteStart+1e3*e.relativeTime),this.lastKnownTimes.relative=u);var c=Math.round(1e3*(u-this.lastKnownTimes.relative));return e.absoluteTime=this.lastKnownTimes.absolute+c,e}},{key:"load",value:function(){return this.enableSurfaceEvents(!0),this.suppressErrors=!0,Promise.resolve()}},{key:"play",value:function(){if(!isNaN(this.pauseTime)){if(this.pauseTime<this.liveStreamInfo.absoluteStart){var t=this.getSeekable().start+1;this.logger.log("info","Playhead outside of DVR window bounds. Moving to ".concat(t)),this.seek(t)}this.pauseTime=NaN}return Promise.resolve(this.video.play())}},{key:"pause",value:function(){var t;this.getIsLiveStream()&&!0===(null==(t=this.context.resource.overrides)?void 0:t.clearOutOfBoundsDvrBuffer)&&(this.pauseTime=this.liveStreamInfo.absoluteTime),this.video.pause()}},{key:"suspend",value:function(){}},{key:"resume",value:function(){}},{key:"seek",value:function(t){var e=this.getSeekable(),n=e.start,i=e.end,r=Te.mapToRange(t,0,i-n,n,i);return this.video.currentTime=r,Ne(this.video,"seeked")}},{key:"resize",value:function(){}},{key:"clearText",value:function(){var t;null==(t=this.textTrackSurface)||t.clearCue()}},{key:"getMetrics",value:function(){var t=this.video,e={bandwidth:NaN,framerate:NaN,droppedVideoFrames:Number.NaN,totalVideoFrames:Number.NaN};"getVideoPlaybackQuality"in t?Object.assign(e,t.getVideoPlaybackQuality()):"webkitDroppedFrameCount"in t&&"webkitDecodedFrameCount"in t&&(e.droppedVideoFrames=t.webkitDroppedFrameCount,e.totalVideoFrames=t.webkitDroppedFrameCount+t.webkitDecodedFrameCount);var n=t.webkitDecodedFrameCount||t.mozPresentedFrames;return n&&(e.framerate=n/t.currentTime),e}},{key:"createMetadataSurface",value:function(){return new Le(this.context,this.delegate.metadataCuepoint)}},{key:"createTextTrackSurface",value:function(){return new Fe(this.context,this.onTextEvent)}},{key:"enableSurfaceEvents",value:function(t){this.eventsEnabled=!0}},{key:"addEvents",value:function(t,e){var n=Te.isFunction(t.on)?"on":"addEventListener";Te.entries(e).forEach((function(e){return t[n](e[0],e[1])}))}},{key:"removeEvents",value:function(t,e){var n=Te.isFunction(t.off)?"off":"removeEventListener";Te.entries(e).forEach((function(e){var i,r;null==(r=(i=e[1]).cancel)||r.call(i),t[n](e[0],e[1])}))}},{key:"createVideoElementError",value:function(){var t=this.video.error,e=Object.keys(MediaError)[t.code-1]||ee.messages.UNSPECIFIED_ERROR,n="3400";switch(t.code){case MediaError.MEDIA_ERR_ABORTED:e=t.toString(),n="3100";break;case MediaError.MEDIA_ERR_NETWORK:n="3001";break;case MediaError.MEDIA_ERR_DECODE:n="3200";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n="3101";break;default:n="3400"}return{code:n,message:e,data:t,fatal:!0}}},{key:"getSegmentDuration",value:function(){return this.segmentDuration}},{key:"getSeekable",value:function(){var t={start:0,end:0},e=this.video.seekable,n=e.length-1;return n>=0&&(t.start=e.start(n),t.end=e.end(n)),t}},{key:"getErrorMessage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n/a";return"".concat(t," fatal: ").concat(e," retry: ").concat(n)}},{key:"createError",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Ce(t,e,n,i)}},{key:"throwError",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.error(this.createError(t,e,n,i))}},{key:"error",value:function(t){this.logger.log("error",t.message),this.delegate.error(t)}},{key:"start",value:function(t){return kt(this,null,D.default.mark((function e(){var n=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ne(this.video,"loadedmetadata").then((function(){if(t)return n.seek(t)})));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"createSidecarTextTrack",value:function(){var t,e=this.context,n=e.resource,i=e.video;(null==(t=n.location)?void 0:t.textTrackUrl)&&Te.createSidecarTextTrack(n,i)}},{key:"updateQualities",value:function(t){t.sort((function(t,e){return t.bitrate-e.bitrate}));var e=Te.getIndexForBitrate(t,this.minBitrate,!0),n=Te.getIndexForBitrate(t,this.maxBitrate,!1);this.qualityInfo.qualities=t.slice(e,n+1),this.delegate.qualitiesChange(this.qualityInfo.qualities)}}],[{key:"canPlay",value:function(t,e){var n=t.avia,i=t.resource,r=n.getSystemInfo(),u=Te.getResourceMimeType(i),a=e.includes(u);return r.hasMediaSource&&a}}]),t}(),Be=(0,Q.default)((function t(e,n,i){(0,_.default)(this,t),this.key=e,this.value=n,this.type=i,this.timeStamp=Date.now()})),je=Object.freeze({env:"__ENV__",playerVersion:"2.1.2",playerName:"@cbsinteractive/avia-js",buildTime:"2022-04-05T20:30:09.783Z"}),ze=function(t){return t.ACTIVE="active",t.INACTIVE="inactive",t.IDLE="idle",t}(ze||{}),We=function(t){return t.AD="ad",t.PLAYBACK="playback",t}(We||{}),He=function(t){return t.PRE="PRE",t.MID="MID",t.POST="POST",t}(He||{}),Qe=function(t){return t.IMA="ima",t.IMA_AD_ONLY="ima_ad_only",t.DAI_SDK="dai_sdk",t.DAI_API="dai_api",t.DAI_SSB="dai_ssb",t.NONE="",t}(Qe||{}),_e=function(t){return t.SSAI="ssai",t.CSAI="csai",t}(_e||{}),qe=function(t){return t.PLAY="play",t.PAUSE="pause",t.SEEK="seek",t.GO_LIVE="go_live",t}(qe||{}),Ke=function(t){return t.MAIN="main",t.DESCRIPTION="description",t}(Ke||{}),Ge=function(t){return t.NONE="none",t.ATTEMPT_MUTED="attemptMuted",t.ATTEMPT_UNMUTED="attemptUnmuted",t.ATTEMPT_UNMUTED_THEN_MUTED="attemptUnmutedThenMuted",t}(Ge||{}),Xe=function(t){return t.AD="Ad",t.RESOURCE="Resource",t.PLAYBACK="Playback",t.VIDEO_START="Video start",t}(Xe||{}),$e=function(t){return t.MULTI_CDN="x-cdn",t}($e||{}),Ze=function(t){return t.EVENT="event",t.AD_BREAK="adbreak",t.AD="ad",t.ATTACH_RESOURCE="attachresource",t}(Ze||{}),Ye="html5",Je=function(t){return t.NONE="none",t.DOCUMENT="document",t.PLAYER="player",t}(Je||{}),tn=function(t){return t.MEDIA_PLAYER="media-player",t.LEARN_MORE="learn-more",t}(tn||{}),en=function(t){return t.EN="English",t.ES="Español",t.FR="Français",t.PT="Português",t.DE="Deutsche",t.PL="Polski",t.JA="日本人",t.KO="한국어",t.ZH="简体中文",t.IT="Italiano",t.RU="Русский",t}(en||{}),nn=function(t){return t.API="api",t.UI="ui",t}(nn||{}),rn=function(t){return t.AUTO="auto",t.DESKTOP="desktop",t.MOBILE="mobile",t.TV="tv",t.LOW="LOW",t}(rn||{}),un=function(t){return t.IDLE="idle",t.STOPPED="stopped",t.PLAYING="playing",t.PAUSED="paused",t.WAITING="waiting",t}(un||{}),an=function(t){return t.LOW="low",t.HIGH="high",t}(an||{}),on=function(t){return t.SD="SD",t.HD="HD",t.UHD="UHD",t.UHD_4K="UHD 4K",t.UHD_8K="UHD 8K",t}(on||{}),sn=function(t){return t[t.DEFINITION=0]="DEFINITION",t[t.HEIGHT=1]="HEIGHT",t[t.BITRATE=2]="BITRATE",t[t.CUSTOM=3]="CUSTOM",t}(sn||{}),ln=function(t){return t.VOD="VOD",t.LIVE="LIVE",t.DVR="DVR",t}(ln||{}),cn=function(t){return t.SEEK_BY="seek_by",t}(cn||{}),hn=function(t){return t.HLS="hls",t.DASH="dash",t.MP4="mp4",t.UNKNOWN="unknown",t}(hn||{}),fn=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i,r){var u;return(0,_.default)(this,n),(u=e.call(this,"(".concat(t,"): ").concat(i),r)).type=t,u.name="HookError",u}return(0,Q.default)(n)}(Se),vn=function(t){return t.HOTKEY_ACTION="hotkeyaction",t.READY="ready",t.AD_CUEPOINTS_AVAILABLE="adcuepointsavailable",t.AD_BREAK_START="adbreakstart",t.AD_BREAK_METADATA="adbreakmetadata",t.AD_BREAK_COMPLETE="adbreakcomplete",t.AD_START="adstart",t.AD_COMPLETE="adcomplete",t.AD_FIRST_QUARTILE="adfirstquartile",t.AD_MIDPOINT="admidpoint",t.AD_THIRD_QUARTILE="adthirdquartile",t.AD_SEGMENT_START="adsegmentstart",t.AD_SEGMENT_END="adsegmentend",t.AD_SKIPPED="adskipped",t.AD_PROGRESS="adprogress",t.AD_PAUSED="adpaused",t.AD_PLAYING="adplaying",t.AD_STALLED="adstalled",t.AD_BREAK_DISCARDED="adbreakdiscarded",t.AD_CLICK="ad-click",t.AUDIO_TRACK_INFO_CHANGE="audiotrackinfochange",t.AUDIO_TRACK_CHANGE="audiotrackchange",t.QUALITY_CHANGE="qualitychange",t.QUALITY_INFO_CHANGE="qualityinfochange",t.CDN_CHANGE="cdnchange",t.CONTENT_START="contentstart",t.CONTENT_DURATION_AVAILABLE="contentdurationavailable",t.CONTENT_SEGMENT_START="contentsegmentstart",t.CONTENT_PLAYING="contentplaying",t.CONTENT_PROGRESS="contentprogress",t.CONTENT_PAUSED="contentpaused",t.CONTENT_SEGMENT_END="contentsegmentend",t.CONTENT_COMPLETE="contentcomplete",t.CONTENT_IS_PLAYING_LIVE="contentisplayinglive",t.STREAM_TYPE_CHANGE="streamtypechange",t.STREAM_METADATA="streammetadata",t.STREAM_ID_AVAILABLE="streamidavailable",t.DRM_KEY_SYSTEM_CREATED="drmkeysystemcreated",t.ERROR="error",t.PLAYBACK_SUSPENDED="playbacksuspended",t.PLAYBACK_RESUMED="playbackresumed",t.RESOURCE_START="resourcestart",t.RESOURCE_END="resourceend",t.RESOURCE_BUFFERING="resourcebuffering",t.SEEK_COMPLETE="seekcomplete",t.SEEK_START="seekstart",t.SEEK_REDIRECT_START="seekredirectstart",t.SEEK_REDIRECT_COMPLETE="seekredirectcomplete",t.METADATA_CUEPOINT="metadatacuepoint",t.TEXT_CUEPOINT="textcuepoint",t.TEXT_TRACK_CHANGE="texttrackchange",t.TEXT_TRACK_INFO_CHANGE="texttrackinfochange",t.TEXT_TRACK_ENABLED_CHANGE="texttrackenabledchange",t.TEXT_TRACK_AVAILABLE="texttrackavailable",t.THUMBNAIL_TRACK_AVAILABLE="thumbnailtrackavailable",t.LIVE_PRESENTATION_STOPPED="livepresentationstopped",t.PRESENTATION_SIZE_CHANGE="presentationsizechange",t.FULLSCREEN_CHANGE="fullscreenchange",t.LOG_EVENT="logevent",t.PLUGIN_EVENT="pluginevent",t.LANGUAGE_CHANGE="languagechange",t.AUTOPLAY_BLOCKED="autoplayblocked",t.VOLUME_CHANGE="volumechange",t.MUTE_CHANGE="mutechange",t.ACTIVE_STATE_CHANGE="activestatechange",t.PLAYBACK_STATE_CHANGE="playbackstatechange",t.METRIC="metric",t.VIDEO_ELEMENT_ADDED="videoelementadded",t.VIDEO_ELEMENT_REMOVED="videoelementremoved",t}(vn||{}),dn=function(t){return t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready",t.CLEAR_KEY="org.w3.clearkey",t.FAIRPLAY_1_0="com.apple.fps.1_0",t}(dn||{}),yn=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;return(0,_.default)(this,n),(t=e.call(this,{})).timer=NaN,t.pCount=0,t.pInterval=i,t}return(0,Q.default)(n,[{key:"destroy",value:function(){this.stop(),(0,B.default)((0,W.default)(n.prototype),"destroy",this).call(this)}},{key:"start",value:function(){var t=this;this.running||(this.timer=setInterval((function(){t.pCount++,t.emit(n.TIC_EVENT,{count:t.pCount})}),this.pInterval))}},{key:"stop",value:function(){clearInterval(this.timer),this.timer=NaN,this.pCount=0}},{key:"running",get:function(){return!isNaN(this.timer)}},{key:"interval",get:function(){return this.pInterval}},{key:"count",get:function(){return this.pCount}}]),n}(Nt),An=yn;An.TICK="tic",An.TIC_EVENT=yn.TICK;var kn=(0,Q.default)((function t(){(0,_.default)(this,t)})),pn=function(){function t(e){(0,_.default)(this,t),t.serviceContainerMap[e]?Rt.error(kn.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","ServiceContainer")):(this.multiCoreKey=e,this.serviceMap={})}return(0,Q.default)(t,[{key:"destroy",value:function(){for(var t in this.serviceMap)this.removeService(t);this.serviceMap=null}},{key:"registerService",value:function(t){this.serviceMap[t.name]=t,t.onRegister(this.multiCoreKey)}},{key:"retrieveService",value:function(t){return this.serviceMap[t]||null}},{key:"hasService",value:function(t){return null!=this.serviceMap[t]}},{key:"removeService",value:function(t){this.serviceMap[t]&&this.serviceMap[t].destroy(),delete this.serviceMap[t]}}],[{key:"getInstance",value:function(e){return e?(null==this.serviceContainerMap[e]&&(this.serviceContainerMap[e]=new t(e)),this.serviceContainerMap[e]):null}},{key:"removeServiceContainer",value:function(t){this.serviceContainerMap[t]&&this.serviceContainerMap[t].destroy(),delete this.serviceContainerMap[t]}}]),t}();pn.serviceContainerMap={};var mn=function(){function t(e,n){(0,_.default)(this,t),this.setNotifyMethod(e),this.setNotifyContext(n)}return(0,Q.default)(t,[{key:"destroy",value:function(){this.context=null,this.notify=null}},{key:"setNotifyMethod",value:function(t){this.notify=t}},{key:"setNotifyContext",value:function(t){this.context=t}},{key:"getNotifyMethod",value:function(){return this.notify}},{key:"getNotifyContext",value:function(){return this.context}},{key:"notifyObserver",value:function(t){this.getNotifyMethod().call(this.getNotifyContext(),t)}},{key:"compareNotifyContext",value:function(t){return t===this.context}}]),t}(),gn=function(){function t(e){(0,_.default)(this,t),null==t.viewMap[e]?(this.multiCoreKey=e,this.mediatorMap={},this.observerMap={},t.viewMap[this.multiCoreKey]=this,this.initializeView()):Rt.error(kn.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","View"))}return(0,Q.default)(t,[{key:"destroy",value:function(){for(var t in this.mediatorMap)this.removeMediator(this.mediatorMap[t].name);this.mediatorMap=null,this.observerMap=null}},{key:"registerObserver",value:function(t,e){null!=this.observerMap[t]?this.observerMap[t].push(e):this.observerMap[t]=[e]}},{key:"notifyObservers",value:function(t){var e,n;if(null!=this.observerMap[t.name]){var i,r=this.observerMap[t.name],u=[];for(e=0,n=r.length;e<n;e++)i=r[e],u.push(i);for(e=0,n=u.length;e<n;e++)(i=u[e]).notifyObserver(t)}}},{key:"removeObserver",value:function(t,e){if(this.observerMap){for(var n=this.observerMap[t],i=n.length;i--;)if(!0===n[i].compareNotifyContext(e)){n.splice(i,1);break}0===n.length&&delete this.observerMap[t]}}},{key:"registerMediator",value:function(t){var e,n,i,r=t.name;if(!this.mediatorMap[r]){t.initializeNotifier(this.multiCoreKey),this.mediatorMap[r]=t;var u=t.listNotificationInterests();if(u.length>0)for(i=new mn(t.handleNotification,t),e=0,n=u.length;e<n;e++)this.registerObserver(u[e],i);t.onRegister()}}},{key:"retrieveMediator",value:function(t){return this.mediatorMap[t]}},{key:"removeMediator",value:function(t){var e=this.mediatorMap[t];if(e){for(var n=e.listNotificationInterests(),i=n.length;i--;)this.removeObserver(n[i],e);delete this.mediatorMap[t],e.onRemove()}}},{key:"hasMediator",value:function(t){return null!=this.mediatorMap[t]}},{key:"initializeView",value:function(){}}],[{key:"getInstance",value:function(e){return e?(this.viewMap[e]||(this.viewMap[e]=new t(e)),this.viewMap[e]):null}},{key:"removeView",value:function(t){this.viewMap[t]&&this.viewMap[t].destroy(),delete this.viewMap[t]}}]),t}();gn.viewMap={};var bn=function(){function t(e){(0,_.default)(this,t),t.controllerMap[e]?Rt.error(kn.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Controller")):(this.multiCoreKey=e,t.controllerMap[this.multiCoreKey]=this,this.commandMap={},this.view=null,this.initializeController())}return(0,Q.default)(t,[{key:"destroy",value:function(){for(var t in this.commandMap)this.removeCommand(t);this.commandMap=null,this.view=null}},{key:"initializeController",value:function(){this.view=gn.getInstance(this.multiCoreKey)}},{key:"executeCommand",value:function(t){var e=this.commandMap[t.name];if(e){var n=new e;n.initializeNotifier(this.multiCoreKey),n.execute(t)}}},{key:"registerCommand",value:function(t,e){this.commandMap[t]||this.view.registerObserver(t,new mn(this.executeCommand,this)),this.commandMap[t]=e}},{key:"hasCommand",value:function(t){return!!this.commandMap[t]}},{key:"removeCommand",value:function(t){this.hasCommand(t)&&(this.view.removeObserver(t,this),this.commandMap[t]=null)}}],[{key:"getInstance",value:function(e){return e?(this.controllerMap[e]||(this.controllerMap[e]=new t(e)),this.controllerMap[e]):null}},{key:"removeController",value:function(t){this.controllerMap[t]&&this.controllerMap[t].destroy(),delete this.controllerMap[t]}}]),t}();bn.controllerMap={};var wn=function(){function t(e){(0,_.default)(this,t),this.proxyMap=null,t.modelMap[e]?Rt.error(kn.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Model")):(this.multiCoreKey=e,t.modelMap[e]=this,this.proxyMap={},this.initializeModel())}return(0,Q.default)(t,[{key:"destroy",value:function(){for(var t in this.proxyMap)this.removeProxy(t);this.proxyMap=null}},{key:"initializeModel",value:function(){}},{key:"registerProxy",value:function(t){this.proxyMap[t.name]=t,t.initializeNotifier(this.multiCoreKey),t.onRegister()}},{key:"retrieveProxy",value:function(t){return this.proxyMap[t]||null}},{key:"hasProxy",value:function(t){return null!=this.proxyMap[t]}},{key:"removeProxy",value:function(t){var e=this.proxyMap[t];e&&(e.onRemove(),this.proxyMap[t]=null)}}],[{key:"getInstance",value:function(e){return e?(null==this.modelMap[e]&&(this.modelMap[e]=new t(e)),this.modelMap[e]):null}},{key:"removeModel",value:function(t){this.modelMap[t]&&this.modelMap[t].destroy(),delete this.modelMap[t]}}]),t}();wn.modelMap={};var Tn=function(){function t(e,n,i){(0,_.default)(this,t),this.pName=e,this.pBody=n,this.pType=i}return(0,Q.default)(t,[{key:"name",get:function(){return this.pName}},{key:"body",get:function(){return this.pBody}},{key:"type",get:function(){return this.pType||null}},{key:"toString",value:function(){var t="\nBody: ".concat(null==this.pBody?"null":JSON.stringify(this.body)),e="\nType: ".concat(null==this.pType?"null":this.type);return"Notification Name: ".concat(this.name+t+e)}}]),t}(),Pn=function(){function t(e,n){(0,_.default)(this,t),this.model=null,this.view=null,this.controller=null,this.serviceContainer=null,this.initialized=!1,this.multiCoreKey=e,this.initializeFacade(),this.registerCommands(n)}return(0,Q.default)(t,[{key:"destroy",value:function(){this.model=null,this.view=null,this.controller=null,this.serviceContainer=null}},{key:"key",get:function(){return this.multiCoreKey}},{key:"appId",get:function(){return this.multiCoreKey}},{key:"logger",get:function(){return this.retrieveService("Logging").logger}},{key:"log",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.logger).log.apply(e,[t].concat(i))}},{key:"registerCommand",value:function(t,e){this.controller.registerCommand(t,e)}},{key:"removeCommand",value:function(t){this.controller.removeCommand(t)}},{key:"hasCommand",value:function(t){return this.controller.hasCommand(t)}},{key:"registerProxy",value:function(t){this.model.registerProxy(t)}},{key:"retrieveProxy",value:function(t){return this.model?this.model.retrieveProxy(t):null}},{key:"removeProxy",value:function(t){this.model&&this.model.removeProxy(t)}},{key:"hasProxy",value:function(t){return this.model.hasProxy(t)}},{key:"registerMediator",value:function(t){this.view.registerMediator(t)}},{key:"retrieveMediator",value:function(t){return this.view?this.view.retrieveMediator(t):null}},{key:"removeMediator",value:function(t){this.view&&this.view.removeMediator(t)}},{key:"hasMediator",value:function(t){return this.view.hasMediator(t)}},{key:"registerService",value:function(t){this.serviceContainer.registerService(t)}},{key:"retrieveService",value:function(t){return this.serviceContainer?this.serviceContainer.retrieveService(t):null}},{key:"removeService",value:function(t){this.model&&this.serviceContainer.removeService(t)}},{key:"hasService",value:function(t){return this.serviceContainer.hasService(t)}},{key:"registerGlobalServices",value:function(t){for(var e in t)this.registerService(t[e])}},{key:"sendNotification",value:function(t,e,n){var i;i="string"==typeof e?new Tn(t,{},e):new Tn(t,e,n),this.notifyObservers(i)}},{key:"notifyObservers",value:function(t){null!=this.view&&this.view.notifyObservers(t)}},{key:"registerCommands",value:function(t){if(t)for(var e in t)t[e]&&this.registerCommand(e,t[e])}},{key:"initializeServiceContainer",value:function(){this.serviceContainer=pn.getInstance(this.multiCoreKey)}},{key:"initializeController",value:function(){this.controller=bn.getInstance(this.multiCoreKey)}},{key:"initializeModel",value:function(){this.model=wn.getInstance(this.multiCoreKey)}},{key:"initializeView",value:function(){this.view=gn.getInstance(this.multiCoreKey)}},{key:"initializeFacade",value:function(){if(this.initialized)throw new Error("Unexpected Condition: Facade already initialized");this.initializeModel(),this.initializeController(),this.initializeView(),this.initializeServiceContainer(),this.initialized=!0}}],[{key:"removeCore",value:function(t){this.facadeMap[t]&&(wn.removeModel(t),gn.removeView(t),bn.removeController(t),pn.removeServiceContainer(t),this.facadeMap[t].destroy(),delete this.facadeMap[t])}},{key:"hasCore",value:function(e){return null!=t.facadeMap[e]}},{key:"getInstance",value:function(t){if(!t)throw new Error(kn.ERROR_NO_KEY);return this.facadeMap[t]}},{key:"createFacade",value:function(e,n){if(!e)throw new Error(kn.ERROR_NO_KEY);if(this.facadeMap[e]){var i=new Error('Not creating facade - key "'.concat(e,'" already exists!'));throw i.key=e,i}return this.facadeMap[e]=new t(e,n),this.facadeMap[e]}}]),t}(),xn=Pn;xn.facadeMap={};var Sn=function(){function t(e){(0,_.default)(this,t),this.pName=e}return(0,Q.default)(t,[{key:"name",get:function(){return this.pName}},{key:"destroy",value:function(){}},{key:"onRegister",value:function(t){this.facadeKey=t}},{key:"getLogger",value:function(){return this.getService("Logging").logger}},{key:"getService",value:function(t){return xn.getInstance(this.facadeKey).retrieveService(t)}},{key:"getModel",value:function(t){return this.getModelCollection().getModel(t)}},{key:"getModelCollection",value:function(){var t;return null==(t=xn.getInstance(this.facadeKey))?void 0:t.retrieveProxy("ModelCollectionProxy")}}]),t}(),Cn=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.call(this,"AutoplayCapabilities")).testDom=null,t.checkCompleted=!1,t.testVideoSrc=ee.blankDataUrl,t.isMobile=null,t.info={supportsUnmutedAutoplay:null,supportsMutedAutoplay:null},we.supportsUnrestrictedAutoplay&&(t.setInfo(!0,!0),t.checkCompleted=!0),t}return(0,Q.default)(n,[{key:"autoplayInfo",get:function(){return this.info}},{key:"destroy",value:function(){clearTimeout(this.timeout),(0,B.default)((0,W.default)(n.prototype),"destroy",this).call(this)}},{key:"detectCapabilities",value:function(t){var e=this;return this.detecting?this.detecting:(t&&(this.testVideoSrc=t),this.detecting=new Promise((function(t){e.checkCompleted?t(e.info):(e.createTestDom(),e.internalCallback=function(){return t(e.info)},e.checkUnmutedAutoplay())})))}},{key:"finishCheck",value:function(t,e){var n=this;this.setInfo(t,e),this.checkCompleted=!0,this.internalCallback(),this.timeout=setTimeout((function(){return n.cleanUp()}),100)}},{key:"setInfo",value:function(t,e){this.info.supportsUnmutedAutoplay=t,this.info.supportsMutedAutoplay=e}},{key:"cleanUp",value:function(){this.testDom&&this.testDom.parentNode.removeChild(this.testDom),this.testDom=null}},{key:"checkUnmutedAutoplay",value:function(){var t=this,e=this.createVideoElement(!1);if(e){e.load();var n=e.play();void 0===n?this.isMobile?this.detectMobileCapabilities():this.finishCheck(!0,!0):n.then((function(){t.finishCheck(!0,!0)})).catch((function(e){t.checkMutedAutoplay()}))}else this.finishCheck(!0,!0)}},{key:"checkMutedAutoplay",value:function(){var t=this;if(this.isEarlySafari11())this.finishCheck(!1,!1);else{var e=this.createVideoElement(!0);e.load(),e.play().then((function(){t.finishCheck(!1,!0)})).catch((function(n){if(e.error&&t.testVideoSrc!==ee.blankDataUrl)return t.testVideoSrc=ee.blankDataUrl,void t.checkUnmutedAutoplay();t.finishCheck(!1,!1)}))}}},{key:"isEarlySafari11",value:function(){var t="Safari"===we.browser&&"desktop"===we.device,e=t?we.browserVersionInfo.majorVersion:null,n=t?we.browserVersionInfo.minorVersion:null,i=11===e&&0===n,r=we.browserVersionInfo.versionString,u=r?r.split("."):null;return i&&(!u[2]||parseInt(u[2])<3)}},{key:"detectMobileCapabilities",value:function(){var t=this.isAutoplayEligibleAndroid()||this.isAutoplayEligibleIos();this.finishCheck(!1,t)}},{key:"isAutoplayEligibleAndroid",value:function(){return"Android"===we.os&&"Chrome"===we.browser&&this.isChromeAutoplayEligible()}},{key:"isAutoplayEligibleIos",value:function(){var t="iOS"===we.os&&we.browserVersionInfo.majorVersion>=10,e=t&&"Safari"===we.browser,n=t&&!e&&("Chrome-iOS"===we.browser||"Chrome"===we.browser)&&this.isChromeAutoplayEligible();return e||n}},{key:"isChromeAutoplayEligible",value:function(){return we.browserVersionInfo.majorVersion>=54}},{key:"createVideoElement",value:function(t){var e=this.document;if(!e)return null;var n=e.createElement("video");return t&&(n.muted=!0,n.setAttribute("muted","muted"),n.setAttribute("playsinline","playsinline")),n.volume=.005,n.style.width="100%",n.style.height="100%",n.src=this.testVideoSrc,this.testDom.appendChild(n),n}},{key:"createTestDom",value:function(){var t=this.document;if(!this.document)return null;var e=t.createElement("div"),n=e.style,i="-1000px";return n.position="absolute",n.top=i,n.left=i,n.width="400px",n.height="225px",t.body.appendChild(e),this.testDom=e,e}},{key:"document",get:function(){return we.document||null}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(Sn),Mn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_.default)(this,t),this.sessionId=null,this.contentId=null,this.ad={adapter:null,showPrerollOnNonZeroStart:!1,suppressAdUi:!1,viewabilityTracking:{partner:null,viewGuid:null,pageType:null},csai:null,ssai:null},this.location={mediaUrl:null,textTrackUrl:null,thumbnailTrackUrl:null,posterImageUrl:null,drm:{playready:{url:null,header:null,priority:null},widevine:{url:null,header:null,priority:null},fairplay:{appCertUrl:null,licenseUrl:null,header:null},aes:{header:null,provider:null}}},this.playback={id3OwnerIds:null,startTime:NaN,preloadContent:!1,enableAdvancedCodecs:!1,liveEdgeSyncFragmentCount:3,abr:{maxBitrate:NaN,minBitrate:NaN,startBitrate:NaN,capQualityToScreenSize:!0}},this.metadata={},this.tracking={},this.cmcd={enabled:!0,sessionId:null,contentId:null,useHeaders:!1},this.overrides={},Et.merge(this,e)}return(0,Q.default)(t,null,[{key:"validate",value:function(t){if(Et.isEmpty(t))throw new Error(ee.messages.RESOURCE_MISSING);var e=[];if(Object.keys(En).forEach((function(n){n in t||e.push(n)})),e.length)throw new Error("One or more configuration properties not found: ".concat(e.join(", ")))}}]),t}(),En=new Mn,Nn=function(){function t(){(0,_.default)(this,t),this.multiCoreKey=null}return(0,Q.default)(t,[{key:"destroy",value:function(){}},{key:"onRemove",value:function(){this.multiCoreKey=null}},{key:"facade",get:function(){return xn.getInstance(this.multiCoreKey)}},{key:"sendNotification",value:function(t,e,n){var i=this.facade;i&&i.sendNotification(t,e,n)}},{key:"initializeNotifier",value:function(t){this.multiCoreKey=t}}]),t}(),Vn=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this)).proxyName=null,r.pData=null,r.proxyName=t,r.pData=i||{},r}return(0,Q.default)(n,[{key:"name",get:function(){return this.proxyName}},{key:"data",get:function(){return this.pData}},{key:"onRegister",value:function(){}},{key:"onRemove",value:function(){this.pData=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}}]),n}(Nn),In=(E={},(0,K.default)(E,"event",{multiple:!0}),(0,K.default)(E,"adbreak",{multiple:!1}),(0,K.default)(E,"ad",{multiple:!1}),(0,K.default)(E,"attachresource",{multiple:!0}),E),Rn=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,"HookProxy",t)).hookMap={},i}return(0,Q.default)(n,[{key:"onRemove",value:function(){this.hookMap=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"registerHook",value:function(t,e){this.hookMap[t]||(this.hookMap[t]=[]),!1===In[t].multiple&&this.hookMap[t].length||this.hookMap[t].push(e)}},{key:"removeHook",value:function(t,e){this.hookMap[t]&&(this.hookMap[t]=this.hookMap[t].filter((function(t){return t!==e})))}},{key:"applyHook",value:function(t,e){return kt(this,null,D.default.mark((function n(){var i,r,u,a,o=this;return D.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=this.hookMap[t])&&0!==i.length){n.next=3;break}return n.abrupt("return",e);case 3:return r=!1,u=function(){return r=!0},a=function e(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return kt(o,null,D.default.mark((function o(){var s,l;return D.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(a>=i.length)){o.next=2;break}return o.abrupt("return",n);case 2:if("function"==typeof(s=i[a])){o.next=5;break}throw new fn(t,"Hook must be a valid function");case 5:return l={type:t,value:n,cancel:u},o.prev=6,o.next=9,s(l);case 9:o.next=14;break;case 11:throw o.prev=11,o.t0=o.catch(6),new fn(t,o.t0.toString(),o.t0);case 14:return o.abrupt("return",r?null:e(l.value,++a));case 15:case"end":return o.stop()}}),o,null,[[6,11]])})))},n.abrupt("return",a(e));case 7:case"end":return n.stop()}}),n,this)})))}}]),n}(Vn),On=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t)).pLogger=i,r}return(0,Q.default)(n,[{key:"destroy",value:function(){this.pLogger.destroy(),this.pLogger=null}},{key:"logger",get:function(){return this.pLogger}}]),n}(Sn),Dn=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,t||{})).pAppId=t.id||Et.uid8(),i.pFacade=xn.createFacade(i.pAppId,t.commandMap||null),i}return(0,Q.default)(n,[{key:"destroy",value:function(){this.mdlCollProxy=null,this.pFacade=null,(0,B.default)((0,W.default)(n.prototype),"destroy",this).call(this),xn.removeCore(this.pAppId)}},{key:"appId",get:function(){return this.pAppId}},{key:"sendNotification",value:function(t,e,n){this.pFacade.sendNotification(t,e,n)}},{key:"createLoggingService",value:function(t){var e=this,n=new Rt({logLevel:t,id:this.appId});n.on(Rt.LOG_EVENT,(function(t){e.sendEvent(t.type,t.detail)})),this.pFacade.registerService(new On("Logging",n))}},{key:"registerGlobalServices",value:function(t){var e=this.pFacade;for(var n in t)e.registerService(t[n])}},{key:"facade",get:function(){return this.pFacade}},{key:"modelCollectionProxy",get:function(){return this.mdlCollProxy||(this.mdlCollProxy=this.facade.retrieveProxy("ModelCollectionProxy")),this.mdlCollProxy}},{key:"appMediator",get:function(){return this.pFacade.retrieveMediator("AppMediator")}}]),n}(Nt);function Ln(){return function(t,e,n){Et.isObject(t.apiMethods)||(t.apiMethods={}),t.apiMethods[e]=n.value}}function Fn(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,n,i){Et.isObject(e.apiAccessors)||(e.apiAccessors={});var r={get:i.get,set:t?void 0:i.set||void 0};e.apiAccessors[n]=r}}function Un(t,e){var n=function(n){t[n]=function(){for(var t,i,r=arguments.length,u=new Array(r),a=0;a<r;a++)u[a]=arguments[a];return(null==(i=null==(t=null==e?void 0:e.apiMethods)?void 0:t[n])?void 0:i.apply(e,u))||null}};for(var i in e.apiMethods)n(i);var r=function(n){var i=e.apiAccessors[n],r={};i.get&&(r.get=function(){return e[n]}),i.set&&(r.set=function(t){e[n]=t}),Object.defineProperty(t,n,r)};for(var u in e.apiAccessors)r(u);return t}var Bn=(N={},(0,K.default)(N,"UHD 8K",4320),(0,K.default)(N,"UHD 4K",2160),(0,K.default)(N,"UHD",1440),(0,K.default)(N,"HD",720),(0,K.default)(N,"SD",0),N),jn=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"getMinAndMaxValuesForCategory",value:function(t,e){var n=1/0,i=0,r=1/0,u=0;return t.forEach((function(t){t.category.indexOf(e)>=0&&(i=Math.max(i,t.index),n=Math.min(n,t.index),u=Math.max(u,t.bitrate),r=Math.min(r,t.bitrate))})),{maxIndex:i,minIndex:n,minBitrate:r,maxBitrate:u}}},{key:"getQualityCategoryForVideoHeight",value:function(t){return t>=Bn["UHD 8K"]?"UHD 8K":t>=Bn["UHD 4K"]?"UHD 4K":t>=Bn.UHD?"UHD":t>=Bn.HD?"HD":"SD"}},{key:"classFromQualifiedName",value:function(t){if(!Et.isString(t))return t;var e,n,i=we.global,r=t.split("."),u=i,a=r.length;for("window"===r[0]&&(a=(r=r.slice(1)).length),e=0;e<a;e++){if(void 0===u[n=r[e]])return Rt.error("Util.classFromQualifiedName: '".concat(t,"' is undefined.")),null;u=u[n]}return u}}]),t}(),zn=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.call(this)}return(0,Q.default)(n,[{key:"logger",get:function(){return this.facade.logger}},{key:"log",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.logger).log.apply(e,[t].concat(i))}}]),n}(function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.call(this)}return(0,Q.default)(n,[{key:"system",get:function(){return we}},{key:"getModel",value:function(t){return this.getModelCollection().getModel(t)}},{key:"getProxy",value:function(t){return this.facade?this.facade.retrieveProxy(t):null}},{key:"getService",value:function(t){return this.facade?this.facade.retrieveService(t):null}},{key:"getModelCollection",value:function(){return this.facade?this.facade.retrieveProxy("ModelCollectionProxy"):null}}]),n}(Nn)),Wn=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.facade.retrieveMediator("PresentationMediator"),n=this.facade.retrieveProxy("ContentPlaybackStateProxy"),i=e.adapter,r=t.body.value;if(n.isAbrSwitchingAvailable)switch(t.name){case"switchBitrate":var u=Et.getIndexForBitrate(n.qualityInfo.qualities,r,!1);this.switchToIndex(u,n,i);break;case"switchQualityCategory":n.userQualityCategory=r,this.switchQualityCategory(n,r,i);break;case"autoQualitySwitching":i.setAutoQualitySwitching(r),n.qualitySwitchingMode=this.getAbrMode(r);break;case"minBitrate":i.setMinBitrate(r);break;case"maxBitrate":i.setMaxBitrate(r)}else n.qualitySwitchingMode="unavailable"}},{key:"switchToIndex",value:function(t,e,n){var i=e.minIndex,r=e.maxIndex;Et.inRange(t,i,r)?(n.setAutoQualitySwitching(!1),e.qualitySwitchingMode=this.getAbrMode(!1),n.setQuality(e.qualityInfo.qualities[t])):this.logger.log("warn",t>=r?ee.messages.ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS:ee.messages.ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS)}},{key:"switchQualityCategory",value:function(t,e,n){var i=t.qualityInfo.qualities,r=jn.getMinAndMaxValuesForCategory(i,e),u=r.minBitrate,a=r.maxBitrate,o=r.minIndex;o===r.maxIndex?this.switchToIndex(o,t,n):(n.setMinBitrate(u),n.setMaxBitrate(a))}},{key:"getAbrMode",value:function(t){return t?"auto":"manual"}}]),n}(zn),Hn=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.call(this)).subCommands=null,t.subCommands=[],t.initializeMacroCommand(),t}return(0,Q.default)(n,[{key:"addSubCommand",value:function(t){this.subCommands.push(t)}},{key:"execute",value:function(t){for(var e;this.subCommands.length>0;)(e=new(this.subCommands.shift())).initializeNotifier(this.multiCoreKey),e.execute(t)}}]),n}(Nn),Qn=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t,{activeState:"inactive",idleDelay:i.idleDelay})).mouseDown=!1,r.mouseOver=!1,r.idleEvents=["mousemove","mousedown","keypress","DOMMouseScroll","mousewheel","touchmove","touchstart","MSPointerMove","MSPointerDown","pointermove","pointerdown"],r.container=i.container,r.document=i.document,r}return(0,Q.default)(n,[{key:"onRegister",value:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.reset=this.reset.bind(this),this.idle=this.idle.bind(this),this.container.addEventListener("mouseenter",this.onMouseEnter),this.container.addEventListener("mouseleave",this.onMouseLeave),this.container.addEventListener("mousedown",this.onMouseDown),this.document.addEventListener("mouseup",this.onMouseUp),this.document.addEventListener("keydown",this.onKeyDown)}},{key:"onRemove",value:function(){this.container.removeEventListener("mouseenter",this.onMouseEnter),this.container.removeEventListener("mouseleave",this.onMouseLeave),this.container.removeEventListener("mousedown",this.onMouseDown),this.document.removeEventListener("mouseup",this.onMouseUp),this.document.removeEventListener("keydown",this.onKeyDown),this.stop(),this.container=null,this.document=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"applyListeners",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e?"add":"remove";this.idleEvents.forEach((function(e){return t.container["".concat(n,"EventListener")](e,t.reset,{passive:!0})}))}},{key:"start",value:function(){this.stop(),this.applyListeners(),this.timeout=setTimeout(this.idle,this.idleDelay)}},{key:"stop",value:function(){clearTimeout(this.timeout),this.applyListeners(!1)}},{key:"idle",value:function(){this.activeState=this.mouseOver?"idle":"inactive"}},{key:"reset",value:function(){this.activeState="active",this.start()}},{key:"onMouseEnter",value:function(){this.reset(),this.mouseOver=!0,this.activeState="active",this.start()}},{key:"onMouseLeave",value:function(){this.reset(),this.mouseOver=!1,this.activeState="inactive"}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown&&(this.mouseDown=!1,this.start())}},{key:"onKeyDown",value:function(t){var e=this,n=t.key,i=t.keyCode;"Tab"!==n&&9!==i||setTimeout((function(){var t=e.document.activeElement,n=e.container===t||e.container.contains(t);n&&e.stop(),e.activeState=n?"active":"inactive"}),0)}},{key:"activeState",get:function(){return this.data.activeState},set:function(t){this.mouseDown&&(t="active"),t!==this.data.activeState&&(this.data.activeState=t,this.sendNotification("activestatechange",{activeState:t}))}},{key:"idleDelay",get:function(){return this.data.idleDelay}}]),n}(Vn),_n={position:"absolute",width:"100%",height:"100%",padding:"0",margin:"0",overflow:"hidden"};function qn(){var t=document.createElement("video");return t.style.height="100%",t.style.width="100%",t.style.backgroundColor="#000",t.dataset.elementId=Et.uid8(),t}function Kn(){var t=Gn("adContainer",_n);return t.dataset.elementId=Et.uid8(),t}function Gn(t,e){var n=document.createElement("div");return n.setAttribute("data-role",t),Object.assign(n.style,e),n}function Xn(){var t=Gn("adClickEl",{display:"none",padding:"4px 8px",fontSize:"12px",background:"#dedede",lineHeight:"14px",color:"#000",position:"absolute",right:"2px",top:"2px",textAlign:"center"});return t.innerHTML="Learn More",t}var $n=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=t.body.playerOptions.container,n=this.system,i=this.getModel("PlayerOptions");if(!n.isWebMaf&&n.global&&n.document&&e){var r="string"==typeof e?n.document.querySelector(e):e,u=[];i.useNativeControls&&(u=["ccContainer"]);var a=function(t,e,n){var i,r,u,a=(i={},(0,K.default)(i,"main",t),(0,K.default)(i,"video",null),i),o=t,s=o.style;s.position=s.position||"relative",s.padding=s.padding||"0",s.margin=s.margin||"0",s.width=s.width||"100%",s.height=s.height||"100%",s.backgroundColor=s.backgroundColor||"#000",s.overflow=s.overflow||"hidden",o.classList.add("avia-container");var l=document.createElement("style");o.parentElement.insertAdjacentElement("beforebegin",l),l.innerText=":root{--avia-timed-text-offset: 60px;}.avia-container.avia-cc-offset video::-webkit-media-text-track-container{bottom: var(--avia-timed-text-offset);height: auto;}";var c,h=o.hasChildNodes()?o.firstChild:null;if(["adContainer","ccContainer","videoContainer"].forEach((function(t){e.includes(t)||(c="adContainer"===t?Kn():Gn(t,_n),a[t]=c,h?o.insertBefore(c,h):o.appendChild(c),h=c)})),!0===(null==(u=n.overrides)?void 0:u.reuseVideoElement)){var f=qn();a.videoContainer.appendChild(f),a.video=f}return a.adClickEl=Xn(),o.appendChild(a.adClickEl),r={},(0,K.default)(r,"main",a.main),(0,K.default)(r,"video",a.video),(0,K.default)(r,"videoContainer",a.videoContainer),(0,K.default)(r,"ccContainer",a.ccContainer),(0,K.default)(r,"adContainer",a.adContainer),(0,K.default)(r,"adClickEl",a.adClickEl),r}(r,u,i),o=this.facade.retrieveProxy("PlayerDomProxy");o.setModel(a),o.showAdContainer(!1),i.useNativeControls&&o.setVideoAttribute("controls",""),!1!==i.playsInline&&o.setVideoAttribute("playsinline",""),o.setVideoAttribute("data-player-id",this.facade.appId),this.facade.registerProxy(new Qn("ActivityProxy",{container:r,document:n.document,idleDelay:i.idleDelay})),this.log("info","Player DOM created.")}}}]),n}(zn),Zn="webkitneedkey",Yn=function(){function t(e,n,i,r){var u=this;(0,_.default)(this,t),this.appCertLoaded=!1,this.webKitNeedKeyCalled=!1,this.webkitNeedKeyHandler=function(t){return u.onWebkitNeedKey(t)},this.onError=r,this.drmInfo=n,this.video=e,this.video.addEventListener(Zn,this.webkitNeedKeyHandler),this.logger=i}return(0,Q.default)(t,[{key:"initialize",value:function(){var t=this;se({url:this.drmInfo.fairplay.appCertUrl,responseType:"arraybuffer"}).then((function(e){return t.onAppCertLoaded(e)}))}},{key:"destroy",value:function(){this.appCertData=null,this.initData=null,this.onError=null,this.drmInfo=null,this.logger=null,this.video.removeEventListener(Zn,this.webkitNeedKeyHandler),this.video=null}},{key:"onAppCertLoaded",value:function(t){this.appCertData=new Uint8Array(t),this.appCertLoaded=!0,this.webKitNeedKeyCalled&&this.initializeFairplayCDM()}},{key:"onWebkitNeedKey",value:function(t){this.initData=t.initData,this.webKitNeedKeyCalled=!0,this.appCertLoaded&&this.initializeFairplayCDM()}},{key:"onLicenseRequestReady",value:function(t,e){this.drmVendor=this.getDrmVendor(t);var n=new XMLHttpRequest;n.session=e.target,n.addEventListener("load",this.onLicenseLoaded.bind(this),!1),n.open("POST",t,!0),n.responseType="irdeto"===this.drmVendor||"unknown"===this.drmVendor?"arraybuffer":"text";var i="spc="+encodeURIComponent(Et.base64EncodeUint8Array(e.message))+"&"+n.session.contentId;(n=this.setRequestHeaders(n)).send(i)}},{key:"setRequestHeaders",value:function(t){if(t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),!Et.isEmpty(this.drmInfo.fairplay.header)){var e=this.drmInfo.fairplay.header;for(var n in e){var i=e[n];t.setRequestHeader(n,i)}}return t}},{key:"onLicenseLoaded",value:function(t){var e=t.target,n=e.session;Et.inRange(e.status,200,400)||this.throwFatalError("3301",ee.messages.FAIRPLAY_LICENSE_ERROR);var i="arraybuffer"!==e.responseType?Et.base64DecodeUint8Array(e.responseText):new Uint8Array(e.response);n.update(i)}},{key:"onWebkitKeyAdded",value:function(t){this.logger.log("info",ee.messages.WEBKIT_KEY_ADDED_SUCCESS)}},{key:"onWebkitError",value:function(t){this.throwFatalError("3301","".concat(ee.messages.FAIRPLAY_LICENSE_ERROR))}},{key:"initializeFairplayCDM",value:function(){var t=this.getLicenseServerUrl(this.initData),e=this.getId(t,this.initData),n=this.video,i=we.global,r=ee.messages;if(e){if(!n.webkitKeys){var u="com.apple.fps.1_0";if(!i.WebKitMediaKeys.isTypeSupported(u,"video/mp4"))return void this.throwFatalError("3300",r.FAIRPLAY_WEBKIT_ERROR);try{n.webkitSetMediaKeys(new i.WebKitMediaKeys(u))}catch(t){return void this.throwFatalError("3300",t.message)}}var a=this.concatInitDataIdAndCertificate(this.initData,e,this.appCertData),o=n.webkitKeys.createSession("video/mp4",a);o?(o.contentId=e,o.addEventListener("webkitkeymessage",this.onLicenseRequestReady.bind(this,t),!1),o.addEventListener("webkitkeyadded",this.onWebkitKeyAdded.bind(this),!1),o.addEventListener("webkitkeyerror",this.onWebkitError.bind(this),!1)):this.throwFatalError("3300",r.FAIRPLAY_WEBKIT_ERROR)}else this.throwFatalError("3300",r.FAIRPLAY_NO_CONTENT_ID)}},{key:"concatInitDataIdAndCertificate",value:function(t,e,n){"string"==typeof e&&(e=Et.stringToArray(e));var i=0,r=new ArrayBuffer(t.byteLength+4+e.byteLength+4+n.byteLength),u=new DataView(r);new Uint8Array(r,i,t.byteLength).set(t),i+=t.byteLength,u.setUint32(i,e.byteLength,!0),i+=4;var a=new Uint16Array(r,i,e.length);return a.set(e),i+=a.byteLength,u.setUint32(i,n.byteLength,!0),i+=4,new Uint8Array(r,i,n.byteLength).set(n),new Uint8Array(r,0,r.byteLength)}},{key:"getLicenseServerUrl",value:function(t){var e=null;Et.isEmpty(this.drmInfo.fairplay.licenseUrl)?e="https://"+String.fromCharCode.apply(null,new Uint16Array(t.buffer)).split("://")[1]:e=this.drmInfo.fairplay.licenseUrl;return e}},{key:"extractContentId",value:function(t){return Et.arrayToString(t).split("skd://")[1]}},{key:"getId",value:function(t,e){var n=ne.decode(t);return n.ContentId||n.contentId||n.assetId||this.extractContentId(e)}},{key:"getDrmVendor",value:function(t){var e="unknown";return-1!==t.indexOf("irdeto")?e="irdeto":-1!==t.indexOf("drmtoday")&&(e="drmtoday"),e}},{key:"throwFatalError",value:function(t,e){this.logger.log("error",t,e),this.onError({code:t,message:e,fatal:!0})}}]),t}(),Jn=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,_.default)(this,n),(i=e.call(this,t,r,!0)).onAddAudioEvent=function(t){i.audioTrackInfo.tracks=[],i.audioTrackInfo.track=null,Et.forEach(i.audioTracks,(function(t,e){var n=t.kind,r={index:e,id:e.toString(),type:"alternative"===n||"description"===n?"description":"main",codec:"",language:t.language,label:t.label};i.audioTrackInfo.tracks.push(r),t.enabled&&(i.audioTrackInfo.track=r)})),i.delegate.audioTracksChange(i.audioTrackInfo.tracks),i.audioTrackInfo.track&&i.delegate.audioTrackChange(i.audioTrackInfo.track)},i.onChangeAudioEvent=function(t){var e=Array.from(i.audioTracks).find((function(t){return t.enabled}));i.audioTrackInfo.track=i.audioTrackInfo.tracks.find((function(t){return t.id===e.id})),i.delegate.audioTrackChange(i.audioTrackInfo.track)},i.onFairPlayError=function(t){i.delegate.error(t)};var u=i.context.resource.location.drm;(null==u?void 0:u.fairplay)&&(i.fairplay=new Yn(i.video,u,i.logger,i.onFairPlayError),i.fairplay.initialize(),i.delegate.drmKeySystemCreated("com.apple.fps.1_0"));var a=(0,F.default)(i),o=a.audioTracks;return o&&(i.onAddAudioEvent=Et.debounce(i.onAddAudioEvent,100),i.onChangeAudioEvent=Et.debounce(i.onChangeAudioEvent,100),o.addEventListener("addtrack",i.onAddAudioEvent),o.addEventListener("change",i.onChangeAudioEvent)),i}return(0,Q.default)(n,[{key:"audioTracks",get:function(){return this.video.audioTracks}},{key:"getId",value:function(){return n.ID}},{key:"destroy",value:function(){var t=this,e=this.video,i=this.audioTracks;return(0,B.default)((0,W.default)(n.prototype),"destroy",this).call(this).then((function(){i&&(i.removeEventListener("addtrack",t.onAddAudioEvent),i.removeEventListener("change",t.onChangeAudioEvent)),t.fairplay&&(t.fairplay.destroy(),t.fairplay=null),e.removeAttribute("src"),e.load()}))}},{key:"load",value:function(){var t,e=this;this.suppressErrors=!0,(0,B.default)((0,W.default)(n.prototype),"load",this).call(this);var i=this.context.resource,r=i.location.mediaUrl,u=(null==(t=i.overrides)?void 0:t.mimeType)||Et.getMimeType(r),a=i.cmcd;return a.enabled&&(r=Ae(r,{ot:"m",sf:function(t){switch(t){case"application/vnd.apple.mpegurl":case"application/x-mpegURL":return"h";case"application/dash+xml":return"d";default:return"o"}}(u),su:!0,sid:a.sessionId,cid:a.contentId,pr:this.video.playbackRate,v:1})),this.video.src=r,Ne(this.video,"loadedmetadata").then((function(){e.video.load();var t=i.playback.startTime;if(t>0)return Ne(e.video,"canplaythrough").then((function(){return e.seek(t)}))})).then((function(){return e.suppressErrors=!1,{manifest:{mimeType:u},fragment:{mimeType:void 0}}})).catch((function(){throw e.createVideoElementError()}))}},{key:"setTextTrack",value:function(t){var e=Array.from(this.video.textTracks).find((function(e){return t.language===e.language&&t.kind===e.kind&&t.label===e.label}));this.textTrackSurface.textTrack=e}},{key:"setAudioTrack",value:function(t){Et.forEach(this.audioTracks,(function(e,n){e.enabled=t.index===n}))}},{key:"setQuality",value:function(t){this.logger.log("info",ee.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}},{key:"setAutoQualitySwitching",value:function(t){this.logger.log("info",ee.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}},{key:"setMinBitrate",value:function(t){this.logger.log("info",ee.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}},{key:"setMaxBitrate",value:function(t){this.logger.log("info",ee.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}}],[{key:"ID",get:function(){return Ye}},{key:"config",get:function(){return{id:n.ID,role:["playback"],factory:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new n(t,e)},isSupported:function(t){var e,n=Et.getResourceMimeType(t.resource);return""!==(null==(e=t.video)?void 0:e.canPlayType(n))}}}}]),n}(Ue),ti=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,"AdapterProxy",t)).adapterMap={},i.defaultAdapters=(0,K.default)({},"playback",Jn.config),i}return(0,Q.default)(n,[{key:"onRemove",value:function(){this.adapterMap=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"registerAdapter",value:function(t){var e=t.id;this.adapterMap[e]=t}},{key:"retrieveAdapter",value:function(t){return this.adapterMap[t]}},{key:"removeAdapter",value:function(t){delete this.adapterMap[t]}},{key:"getAdaptersByRole",value:function(t){var e=Et.values(this.adapterMap).filter((function(e){return e.role.includes(t)})),n=this.defaultAdapters[t];return n&&e.push(n),e}},{key:"createContext",value:function(t,e){var n=this.facade.retrieveMediator("pluginMediator").createPluginServices(),i=n.dom,r=n.system,u=this.facade.retrieveProxy("ModelCollectionProxy").getModel("PresentationState"),a=this.facade.retrieveProxy("TextTrackProxy"),o=this.facade.retrieveProxy("PerformanceProxy");return Object.assign(n,{resource:t,video:r.isWebMaf?r.webMafPlayer:i.video,container:i.main,autoplay:u.isAutoplay,muted:u.isMuteAtPlayStart,performanceSettings:o,textTrackSettings:a,getDelegate:e})}},{key:"createAdapter",value:function(t,e,n){return kt(this,null,D.default.mark((function i(){var r,u,a,o,s,l,c,h,f,v,d,y,A,k;return D.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=this.createContext(e,n),a=this.getAdaptersByRole(t),o=(null==(r=u.resource[t])?void 0:r.adapter)||{},s=o.id,l=o.options,c=void 0===l?{}:l,h=s?a.filter((function(t){return t.id===s})):a,f=X(h),i.prev=5,f.s();case 7:if((v=f.n()).done){i.next=25;break}if(d=v.value,y=Et.merge({},d.options,c),i.t0=!s,!i.t0){i.next=15;break}return i.next=14,d.isSupported(u,y);case 14:i.t0=!i.sent;case 15:if(!i.t0){i.next=17;break}return i.abrupt("continue",23);case 17:return i.next=19,d.factory(u,y);case 19:if(!(A=i.sent)){i.next=23;break}return this.facade.log("info","".concat(d.id," adapter created")),i.abrupt("return",A);case 23:i.next=7;break;case 25:i.next=30;break;case 27:i.prev=27,i.t1=i.catch(5),f.e(i.t1);case 30:return i.prev=30,f.f(),i.finish(30);case 33:throw k="Could not find adapter for role: ".concat(t),s&&(k+=", with id: ".concat(s)),new Ce("5000",k);case 36:case"end":return i.stop()}}),i,this,[[5,27,30,33]])})))}}]),n}(Vn),ei=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t,{})).pLocalizationData=[],r.pLocale={},r.pLanguage=i,r.registerLocalizationData(n.LocalizationData),r}return(0,Q.default)(n,[{key:"onRemove",value:function(){this.pLocale=null,this.pLocalizationData=null,this.pLanguageTag=null,this.pLanguage=null}},{key:"getApi",value:function(){return Un({},this)}},{key:"defaultLanguage",get:function(){return navigator&&navigator.language?navigator.language:"en"}},{key:"language",get:function(){return this.pLanguage||this.defaultLanguage}},{key:"languageTag",get:function(){return this.pLanguageTag}},{key:"changeLanguage",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultLanguage;this.pLanguage=e,this.pLanguageTag=Et.parseLanguageTag(this.language);var i=new RegExp("^".concat(this.pLanguageTag.language),"i"),r=function(e){var i=(0,H.default)(e,2),r=i[0],u=i[1];return n.load(u).then((function(t){return[r,t]})).catch((function(e){return t.facade.log("error","Could not load locale file ".concat(u),e),[r,{}]}))},u=this.pLocalizationData.map((function(t){var e=Et.entries(t).filter((function(t){return i.test(t[0])})).map((function(t){return"string"==typeof t[1]?r(t):t}));return Promise.all(e)}));return Promise.all(u).then((function(e){var n=e.map((function(t){return Et.fromEntries(t)})),i=Et.merge.apply(Et,(0,L.default)(n));return t.pLocale=i}))}},{key:"registerLocalizationData",value:function(t){Et.isEmpty(t)||this.pLocalizationData.push(t)}},{key:"localize",value:function(t,e){var n=this.lookup(t);return Et.template(n,e)}},{key:"lookup",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.language,i=function(n){return(e.pLocale[n]||{})[t]};return i(n)||i(this.pLanguageTag.language)||t}}],[{key:"load",value:function(t){return null==this.pExternalData[t]&&(this.pExternalData[t]=se({url:t,responseType:"json"})),this.pExternalData[t]}}]),n}(Vn),ni=ei;ni.pExternalData={},ni.LocalizationData={en:(V={},(0,K.default)(V,"media-player","Media Player"),(0,K.default)(V,"learn-more","Learn More"),V),es:(I={},(0,K.default)(I,"media-player","Reproductor multimedia"),(0,K.default)(I,"learn-more","Aprende más"),I)},At([Fn(!0)],ni.prototype,"defaultLanguage",1),At([Fn(!0)],ni.prototype,"language",1),At([Ln()],ni.prototype,"languageTag",1),At([Ln()],ni.prototype,"changeLanguage",1),At([Ln()],ni.prototype,"registerLocalizationData",1),At([Ln()],ni.prototype,"localize",1);var ii=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).resettables=["ContentPlaybackState"],t}return(0,Q.default)(n,[{key:"onRemove",value:function(){this.resettables=null;var t=this.facade.retrieveProxy("PlayerDomProxy");t&&t.removeDom(),(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"collection",get:function(){return this.data}},{key:"getModel",value:function(t){return this.data.getModel(t)}},{key:"reset",value:function(){for(var t=this.resettables,e=t.length;e--;)this.getModel(t[e]).reset();var n=this.getModel("PresentationState");n.isAutoplay=!0,n.isCurrentVideoAd=!1,n.started=!1,n.streamDuration=NaN,n.streamTime=NaN}}]),n}(Vn),ri=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"logger",get:function(){return this.facade.logger}},{key:"log",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.logger).log.apply(e,[t].concat(i))}}]),n}(function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this)).pViewControl=null,r.mediatorName=t,i&&(r.viewControl=i),r}return(0,Q.default)(n,[{key:"name",get:function(){return this.mediatorName}},{key:"viewControl",get:function(){return this.pViewControl},set:function(t){this.pViewControl=t}},{key:"system",get:function(){return we}},{key:"getService",value:function(t){return this.facade?this.facade.retrieveService(t):null}},{key:"getModel",value:function(t){return this.getModelCollection().getModel(t)}},{key:"getProxy",value:function(t){return this.facade?this.facade.retrieveProxy(t):null}},{key:"getModelCollection",value:function(){return this.facade?this.facade.retrieveProxy("ModelCollectionProxy"):null}},{key:"listNotificationInterests",value:function(){return[]}},{key:"onRegister",value:function(){}},{key:"onRemove",value:function(){this.pViewControl=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}}]),n}(Nn)),ui=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,t)).timer=new An(n.INTERVAL),i.timer.on(An.TIC_EVENT,(function(t){return i.onTic(t)})),i}return(0,Q.default)(n,[{key:"killTimer",value:function(){var t;null==(t=this.timer)||t.stop()}},{key:"listNotificationInterests",value:function(){return["resourcestart"]}},{key:"handleNotification",value:function(t){var e;if("resourcestart"===t.name)null==(e=this.timer)||e.start()}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this)}},{key:"onRemove",value:function(){this.timer.destroy(),this.timer=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"onTic",value:function(t){this.facade.sendNotification("timerTic",t.detail,"internal")}}]),n}(ri);ui.INTERVAL=100;var ai=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"onRegister",value:function(){var t=this.facade.retrieveProxy("ModelCollectionProxy").getModel("PlayerOptions");this.pOverrides=t.overrides,this.pMode="auto"===t.performanceMode?this.calculatePerformanceMode():t.performanceMode}},{key:"calculatePerformanceMode",value:function(){switch(!0){case we.isTv:case we.isEmbedded:return"tv";case we.isMobile:return"mobile";default:return"desktop"}}},{key:"mode",get:function(){return this.pMode}},{key:"forwardBufferLength",get:function(){switch(this.pMode){case"mobile":case"tv":return 20;case"LOW":return 10;default:return}}},{key:"backBufferLength",get:function(){switch(this.pMode){case"mobile":case"tv":return 30;case"LOW":return 12;default:return 60}}},{key:"topQualityForwardBufferLength",get:function(){switch(this.pMode){case"mobile":case"tv":return 60;case"LOW":return 10;default:return}}},{key:"bufferingSampleRate",get:function(){var t,e=null==(t=this.pOverrides)?void 0:t.bufferingSampleRate;if(e)return e;switch(this.pMode){case"tv":case"LOW":return 300;default:return ui.INTERVAL}}}]),n}(Vn),oi=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).controlVisCssClass="cvui-ctrlbar-vis",t}return(0,Q.default)(n,[{key:"setModel",value:function(t){for(var e in t)this.model[e]=t[e]}},{key:"removeDom",value:function(){for(var t=this.getMain(),e=t.childNodes,n=e.length;n--;)t.removeChild(e[n])}},{key:"setControlVisibility",value:function(t){var e=this.getMain();if(e){var n=t?"add":"remove";e.classList[n](this.controlVisCssClass)}}},{key:"getElement",value:function(t){return this.model[t]||null}},{key:"getSafeZIndex",value:function(){var t=this.getElement("adContainer");return t?Number(t.style.zIndex)+10:10}},{key:"getVideo",value:function(){return this.getElement("video")}},{key:"getTextTrackContainer",value:function(){return this.getElement("ccContainer")}},{key:"setVideoVolume",value:function(t){var e=this.getVideo();e&&this.getVideoVolume()!==t&&(e.volume=t)}},{key:"getVideoVolume",value:function(){var t=this.getVideo();return t?t.volume:null}},{key:"getMain",value:function(){return this.getElement("main")}},{key:"showAdClickElement",value:function(t){var e=this.getElement("adClickEl");if(e){var n=this.facade.retrieveProxy("LocalizationProxy").localize("learn-more");n&&(e.innerHTML=n),e.style.display=!1!==t?"block":"none"}}},{key:"getDimensions",value:function(){var t=this.getPresentationRect();return t?{width:t.width,height:t.height}:null}},{key:"showContainer",value:function(t,e){var n=this.getElement(t);n&&(n.style.display=e?"inline-block":"none")}},{key:"showAdContainer",value:function(t){this.showContainer("adContainer",t)}},{key:"getPresentationRect",value:function(){var t=this.getMain();return t&&t.getBoundingClientRect()||null}},{key:"muteVideo",value:function(t){var e=this.getVideo(),n="muted";e&&(e.muted=t,t&&e.setAttribute(n,n),!t&&e.removeAttribute(n))}},{key:"primeVideo",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee.blankDataUrl;return Promise.resolve().then((function(){var n=t.getVideo();if(n)return n.src=e,n.load(),n.play().catch((function(e){if(n.error&&n.src!==ee.blankDataUrl)return t.primeVideo(ee.blankDataUrl)}))}))}},{key:"setVideoAttribute",value:function(t,e){var n=this.getVideo();null==n||n.setAttribute(t,e)}},{key:"removeVideoAttribute",value:function(t){var e=this.getVideo();null==e||e.removeAttribute(t)}},{key:"recreateVideo",value:function(){var t=qn(),e=this.getElement("videoContainer"),n=this.getElement("video");if(n){var i=["src","data-element-id"];Array.from(n.attributes).filter((function(t){return!i.includes(t.name)})).forEach((function(e){return t.setAttribute(e.name,e.value)})),e.replaceChild(t,n),this.sendNotification("videoelementremoved",{video:n})}else e.appendChild(t);this.setModel((0,K.default)({},"video",t)),this.recreateAdElements(),this.sendNotification("videoelementadded",{video:t})}},{key:"recreateAdElements",value:function(){var t,e=Kn(),n=Xn(),i=this.getMain(),r=this.getElement("adContainer"),u=this.getElement("adClickEl");i.replaceChild(e,r),i.replaceChild(n,u),this.setModel((t={},(0,K.default)(t,"adContainer",e),(0,K.default)(t,"adClickEl",n),t))}},{key:"model",get:function(){return this.data}}]),n}(Vn),si=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,_.default)(this,n),e.call(this,t,{native:!1!==i.native,mode:"disabled",language:null!=i.language?i.language:navigator.language})}return(0,Q.default)(n,[{key:"mode",get:function(){return this.data.mode},set:function(t){this.data.mode=t}},{key:"enabled",get:function(){return"disabled"!==this.data.mode},set:function(t){this.mode=t?this.enabledMode:"disabled"}},{key:"enabledMode",get:function(){return this.data.native?"showing":"hidden"}},{key:"native",get:function(){return this.data.native}},{key:"language",get:function(){return this.data.language},set:function(t){this.data.language=t}}]),n}(Vn),li=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"checkType",value:function(t,e,n){return"string"==typeof e&&(e=[e]),!(!n||null!==t)||e.some((function(e){return(0,q.default)(t)===e}))}},{key:"notEmpty",value:function(t){return!Et.isEmpty(t)}},{key:"isArray",value:function(t){return Array.isArray(t)}},{key:"validNumber",value:function(t,e){return"number"!=typeof t?e:t}},{key:"isTypedArray",value:function(t,e){if(this.isArray(t)&&this.notEmpty(t)){for(var n=t.length;n--;)if((0,q.default)(t[n])!==e)return!1;return!0}return!1}},{key:"isType",value:function(t,e){return t instanceof e}},{key:"isPositiveNumber",value:function(t){return"number"==typeof t&&t>=0}}]),t}(),ci={manifestQualities:{type:"object",defaultValue:null},qualityInfo:{type:"object",defaultValue:null},audioTracks:{type:"object",defaultValue:null},textTracks:{type:"object",defaultValue:null},streamType:{type:"string",defaultValue:"VOD"},liveStreamInfo:{type:"object",defaultValue:null},bufferLength:{type:"number",defaultValue:0},cdn:{type:"string",defaultValue:null,validator:li.notEmpty},drmType:{type:"string",defaultValue:null,validator:li.notEmpty},contentSegment:{type:"number",defaultValue:NaN},maxBandwidth:{type:"number",defaultValue:NaN},time:{type:"number",defaultValue:0},state:{type:"string",defaultValue:"idle"},duration:{type:"number",defaultValue:NaN},bitrate:{type:"number",defaultValue:NaN},started:{type:"boolean",defaultValue:!1},averageDroppedFps:{type:"number",defaultValue:NaN},framerate:{type:"number",defaultValue:NaN}},hi={container:{type:["object","string"],defaultValue:null},plugins:{type:"object",defaultValue:null},autoplay:{type:"string",defaultValue:"none"},offsetTextOnControlsVisible:{type:"boolean",defaultValue:!1},id:{type:"string",defaultValue:null},networkErrorRecovery:{type:"object",defaultValue:null},networkTimeout:{type:"number",defaultValue:re.TIMEOUT},performanceMode:{type:"string",defaultValue:"auto"},renderTextTrackNatively:{type:"boolean",defaultValue:!0},useNativeFullscreen:{type:"boolean",defaultValue:!0},playsInline:{type:"boolean",defaultValue:!0},useNativeControls:{type:"boolean",defaultValue:!1},overrides:{type:"object",defaultValue:{}},logLevel:{type:"string",defaultValue:"off"},language:{type:"string",defaultValue:null},localization:{type:"object",defaultValue:null},idleDelay:{type:"number",defaultValue:3e3},enableOm:{type:"boolean",defaultValue:!1},enableMoat:{type:"boolean",defaultValue:!1}},fi=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"clampValue",value:function(t,e,n){return"number"!=typeof t?null:Math.max(e,Math.min(t,n))}},{key:"lowerCase",value:function(t){return"string"==typeof t?t.toLowerCase():t}},{key:"strToNum",value:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=parseFloat(t);return isNaN(e)?t:e}return t}}]),t}(),vi={content_playback_state_config:ci,player_dom_config:{main:{type:"object",defaultValue:null},video:{type:"object",defaultValue:null},videoContainer:{type:"object",defaultValue:null},ccContainer:{type:"object",defaultValue:null},adContainer:{type:"object",defaultValue:null},panelContainer:{type:"object",defaultValue:null},adClickEl:{type:"object",defaultValue:null}},player_options_config:hi,presentation_state_config:{streamTime:{type:"number",defaultValue:0,setterTransformer:function(t){return li.isPositiveNumber(t)?t:0}},streamDuration:{type:"number",defaultValue:NaN,setterTransformer:function(t){return li.isPositiveNumber(t)?t:NaN}},isAutoplay:{type:"boolean",defaultValue:!1},isCurrentVideoAd:{type:"boolean",defaultValue:!1},isFullscreen:{type:"boolean",defaultValue:!1},isMuted:{type:"boolean",defaultValue:!1},isMuteAtPlayStart:{type:"boolean",defaultValue:!1},started:{type:"boolean",defaultValue:!1},userHasUnmuted:{type:"boolean",defaultValue:!1},volume:{type:"number",defaultValue:1,setterTransformer:function(t){return fi.clampValue(t,0,1)}},usesSsai:{type:"boolean",defaultValue:!1},streamId:{type:"string",defaultValue:null},suspended:{type:"boolean",defaultValue:!1}}},di=function(){function t(){(0,_.default)(this,t)}return(0,Q.default)(t,null,[{key:"generateModel",value:function(t,e,n,i){for(var r in e)this.createProperty(r,e[r],t,n,i)}},{key:"createProperty",value:function(t,e,n,i,r){var u=e.validator,a=e.type,o=e.defaultValue,s=!1!==e.enumerable,l=this.getTransformer(e,"setter",n),c=this.getTransformer(e,"getter",n);!1===e.writable?(Object.defineProperty(n,t,{enumerable:s,value:o,writable:!1}),i[t]=o):(Object.defineProperty(n,t,{enumerable:s,set:function(e){var n=l(e);!u||u(n)?li.checkType(n,a,null==o)?i[t]=n:Rt.warn("Invalid type supplied for property ".concat(t)):Rt.warn("Invalid value '".concat(n,"' for property ").concat(t))},get:function(){return c(i[t])}}),i[t]=o),r[t]=o}},{key:"getTransformer",value:function(t,e,n){var i=t[e+"Transformer"];return i&&"function"==typeof i?i.bind(n):this.blankTransformer}},{key:"blankTransformer",value:function(t){return t}}]),t}(),yi=function(){function t(e){(0,_.default)(this,t),this.pData={},this.defaultValues={},di.generateModel(this,e,this.pData,this.defaultValues)}return(0,Q.default)(t,[{key:"data",get:function(){return Object.assign({},this.pData)}},{key:"reset",value:function(){for(var t in this.defaultValues)this.pData[t]=this.defaultValues[t]}}]),t}(),Ai=function(){function t(e){(0,_.default)(this,t),this.model=new yi(e)}return(0,Q.default)(t,[{key:"data",get:function(){return this.model.data}},{key:"reset",value:function(){this.model.reset()}},{key:"manifestQualities",get:function(){return this.model.manifestQualities},set:function(t){this.model.manifestQualities=t}},{key:"qualityInfo",get:function(){return this.model.qualityInfo},set:function(t){this.model.qualityInfo=t}},{key:"audioTracks",get:function(){return this.model.audioTracks},set:function(t){this.model.audioTracks=t}},{key:"textTracks",get:function(){return this.model.textTracks},set:function(t){this.model.textTracks=t}},{key:"streamType",get:function(){return this.model.streamType},set:function(t){this.model.streamType=t}},{key:"liveStreamInfo",get:function(){return this.model.liveStreamInfo},set:function(t){this.model.liveStreamInfo=t}},{key:"bufferLength",get:function(){return this.model.bufferLength},set:function(t){this.model.bufferLength=t}},{key:"cdn",get:function(){return this.model.cdn},set:function(t){this.model.cdn=t}},{key:"drmType",get:function(){return this.model.drmType},set:function(t){this.model.drmType=t}},{key:"contentSegment",get:function(){return this.model.contentSegment},set:function(t){this.model.contentSegment=t}},{key:"maxBandwidth",get:function(){return this.model.maxBandwidth},set:function(t){this.model.maxBandwidth=t}},{key:"time",get:function(){return this.model.time},set:function(t){this.model.time=t}},{key:"state",get:function(){return this.model.state},set:function(t){this.model.state=t}},{key:"duration",get:function(){return this.model.duration},set:function(t){this.model.duration=t}},{key:"bitrate",get:function(){return this.model.bitrate},set:function(t){this.model.bitrate=t}},{key:"started",get:function(){return this.model.started},set:function(t){this.model.started=t}},{key:"averageDroppedFps",get:function(){return this.model.averageDroppedFps},set:function(t){this.model.averageDroppedFps=t}},{key:"framerate",get:function(){return this.model.framerate},set:function(t){this.model.framerate=t}}],[{key:"modelName",get:function(){return"ContentPlaybackState"}}]),t}(),ki=function(){function t(e){(0,_.default)(this,t),this.model=new yi(e)}return(0,Q.default)(t,[{key:"data",get:function(){return this.model.data}},{key:"reset",value:function(){this.model.reset()}},{key:"main",get:function(){return this.model.main},set:function(t){this.model.main=t}},{key:"video",get:function(){return this.model.video},set:function(t){this.model.video=t}},{key:"videoContainer",get:function(){return this.model.videoContainer},set:function(t){this.model.videoContainer=t}},{key:"ccContainer",get:function(){return this.model.ccContainer},set:function(t){this.model.ccContainer=t}},{key:"adContainer",get:function(){return this.model.adContainer},set:function(t){this.model.adContainer=t}},{key:"panelContainer",get:function(){return this.model.panelContainer},set:function(t){this.model.panelContainer=t}},{key:"adClickEl",get:function(){return this.model.adClickEl},set:function(t){this.model.adClickEl=t}}],[{key:"modelName",get:function(){return"PlayerDom"}}]),t}(),pi=function(){function t(e){(0,_.default)(this,t),this.model=new yi(e)}return(0,Q.default)(t,[{key:"data",get:function(){return this.model.data}},{key:"reset",value:function(){this.model.reset()}},{key:"container",get:function(){return this.model.container},set:function(t){this.model.container=t}},{key:"plugins",get:function(){return this.model.plugins},set:function(t){this.model.plugins=t}},{key:"autoplay",get:function(){return this.model.autoplay},set:function(t){this.model.autoplay=t}},{key:"offsetTextOnControlsVisible",get:function(){return this.model.offsetTextOnControlsVisible},set:function(t){this.model.offsetTextOnControlsVisible=t}},{key:"id",get:function(){return this.model.id},set:function(t){this.model.id=t}},{key:"isEmbedded",get:function(){return this.model.isEmbedded},set:function(t){this.model.isEmbedded=t}},{key:"networkErrorRecovery",get:function(){return this.model.networkErrorRecovery},set:function(t){this.model.networkErrorRecovery=t}},{key:"networkTimeout",get:function(){return this.model.networkTimeout},set:function(t){this.model.networkTimeout=t}},{key:"performanceMode",get:function(){return this.model.performanceMode},set:function(t){this.model.performanceMode=t}},{key:"renderTextTrackNatively",get:function(){return this.model.renderTextTrackNatively},set:function(t){this.model.renderTextTrackNatively=t}},{key:"useNativeFullscreen",get:function(){return this.model.useNativeFullscreen},set:function(t){this.model.useNativeFullscreen=t}},{key:"playsInline",get:function(){return this.model.playsInline},set:function(t){this.model.playsInline=t}},{key:"useNativeControls",get:function(){return this.model.useNativeControls},set:function(t){this.model.useNativeControls=t}},{key:"overrides",get:function(){return this.model.overrides},set:function(t){this.model.overrides=t}},{key:"logLevel",get:function(){return this.model.logLevel},set:function(t){this.model.logLevel=t}},{key:"language",get:function(){return this.model.language},set:function(t){this.model.language=t}},{key:"localization",get:function(){return this.model.localization},set:function(t){this.model.localization=t}},{key:"idleDelay",get:function(){return this.model.idleDelay},set:function(t){this.model.idleDelay=t}},{key:"enableOm",get:function(){return this.model.enableOm},set:function(t){this.model.enableOm=t}},{key:"enableMoat",get:function(){return this.model.enableMoat},set:function(t){this.model.enableMoat=t}}],[{key:"modelName",get:function(){return"PlayerOptions"}}]),t}(),mi=function(){function t(e){(0,_.default)(this,t),this.model=new yi(e)}return(0,Q.default)(t,[{key:"data",get:function(){return this.model.data}},{key:"reset",value:function(){this.model.reset()}},{key:"streamTime",get:function(){return this.model.streamTime},set:function(t){this.model.streamTime=t}},{key:"streamDuration",get:function(){return this.model.streamDuration},set:function(t){this.model.streamDuration=t}},{key:"isAutoplay",get:function(){return this.model.isAutoplay},set:function(t){this.model.isAutoplay=t}},{key:"isCurrentVideoAd",get:function(){return this.model.isCurrentVideoAd},set:function(t){this.model.isCurrentVideoAd=t}},{key:"isFullscreen",get:function(){return this.model.isFullscreen},set:function(t){this.model.isFullscreen=t}},{key:"isMuted",get:function(){return this.model.isMuted},set:function(t){this.model.isMuted=t}},{key:"isMuteAtPlayStart",get:function(){return this.model.isMuteAtPlayStart},set:function(t){this.model.isMuteAtPlayStart=t}},{key:"started",get:function(){return this.model.started},set:function(t){this.model.started=t}},{key:"userHasUnmuted",get:function(){return this.model.userHasUnmuted},set:function(t){this.model.userHasUnmuted=t}},{key:"volume",get:function(){return this.model.volume},set:function(t){this.model.volume=t}},{key:"usesSsai",get:function(){return this.model.usesSsai},set:function(t){this.model.usesSsai=t}},{key:"streamId",get:function(){return this.model.streamId},set:function(t){this.model.streamId=t}},{key:"suspended",get:function(){return this.model.suspended},set:function(t){this.model.suspended=t}}],[{key:"modelName",get:function(){return"PresentationState"}}]),t}(),gi=function(){function t(){(0,_.default)(this,t),this.mdlCollection={},this.createModels()}return(0,Q.default)(t,[{key:"destroy",value:function(){for(var t in this.mdlCollection)delete this.mdlCollection[t];this.mdlCollection=null}},{key:"getModel",value:function(t){return this.mdlCollection[t]}},{key:"ContentPlaybackState",get:function(){return this.mdlCollection.ContentPlaybackState}},{key:"PlayerDom",get:function(){return this.mdlCollection.PlayerDom}},{key:"PlayerOptions",get:function(){return this.mdlCollection.PlayerOptions}},{key:"PresentationState",get:function(){return this.mdlCollection.PresentationState}},{key:"createModels",value:function(){for(var t=[Ai,ki,pi,mi],e=t.length;e--;){var n=t[e],i=n.modelName,r=vi[this.classToCfgName(i)];this.mdlCollection[i]=new n(r)}}},{key:"classToCfgName",value:function(t){return t.replace(/(?:^|\.?)([A-Z])/g,(function(t,e){return"_"+e.toLowerCase()})).replace(/^_/,"")+"_config"}}]),t}(),bi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.system,n=new gi,i=new ii("ModelCollectionProxy",n),r=t.body.playerOptions;this.facade.registerProxy(i),this.setPlayerOptions(i,r),this.facade.registerProxy(new ai("PerformanceProxy"));var u=new ni("LocalizationProxy",r.language);this.facade.registerProxy(u),this.facade.registerProxy(new si("TextTrackProxy",{native:r.renderTextTrackNatively,language:u.language})),!e.isWebMaf&&this.createDomProxy(i),this.facade.registerProxy(new ti),this.log("debug","Model prepared")}},{key:"setPlayerOptions",value:function(t,e){var n=t.getModel("PlayerOptions");for(var i in e)!Et.isUndefined(n[i])&&(n[i]=e[i])}},{key:"createDomProxy",value:function(t){var e=t.getModel("PlayerDom"),n=new oi("PlayerDomProxy",e);this.facade.registerProxy(n)}}]),n}(zn),wi=function(){function t(e){var n=this;(0,_.default)(this,t),this.event={dispatchPluginEvent:function(t){n.dispatch(t)}},this.util={queryStrFromObj:function(t,e){return ne.encode(t)}},this.playerApi=null,this.sys=null,this.bi=null,this.domProxy=null,this.playerOpts=null,this.loc=null,this.log=null,this.playerApi=e.player,this.sys=e.system,this.bi=e.buildInfo,this.domProxy=e.domProxy,this.playerOpts=e.playerOptions,this.loc=e.localization,this.dispatch=e.dispatch,this.log=e.logger}return(0,Q.default)(t,[{key:"player",get:function(){return this.playerApi}},{key:"logger",get:function(){return this.log}},{key:"system",get:function(){return this.sys}},{key:"appNamespace",get:function(){return this.sys.appNamespace}},{key:"avia",get:function(){return this.sys.appNamespace}},{key:"playerOptions",get:function(){return this.playerOpts}},{key:"buildInfo",get:function(){return this.bi}},{key:"localization",get:function(){return this.loc}},{key:"dom",get:function(){var t,e,n,i,r,u=this;return{main:null==(t=this.domProxy)?void 0:t.getMain(),get video(){return null==(t=u.domProxy)?void 0:t.getVideo();var t},videoContainer:null==(e=this.domProxy)?void 0:e.getElement("videoContainer"),ccContainer:null==(n=this.domProxy)?void 0:n.getElement("ccContainer"),adContainer:null==(i=this.domProxy)?void 0:i.getElement("adContainer"),adClickEl:null==(r=this.domProxy)?void 0:r.getElement("adClickEl")}}}]),t}(),Ti=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).plugins={},t.pendingLoads=null,t.services=null,t}return(0,Q.default)(n,[{key:"onRemove",value:function(){var t=this;Object.keys(this.plugins).forEach((function(e){try{t.killPlugin(e)}catch(n){t.logger.warn("Error destroying plugin: ".concat(e),n)}})),this.plugins=null,this.pendingLoads=null,this.services=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"removePlugin",value:function(t){this.killPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins[t]||null}},{key:"loadPlugin",value:function(t){return this.createPlugin(t)}},{key:"listNotificationInterests",value:function(){return["loadPlugins","adbreakstart","contentstart","removePlugin"]}},{key:"handleNotification",value:function(t){switch(t.name){case"loadPlugins":this.loadPlugins(t.body);break;case"removePlugin":this.removePlugin(t.body.name);break;case"adbreakstart":case"contentstart":this.loadPendingPlugins()}}},{key:"createPluginServices",value:function(){var t=this.facade.retrieveMediator("AppMediator");return new wi({player:t.getAppApi(),buildInfo:je,system:this.system,domProxy:this.facade.retrieveProxy("PlayerDomProxy"),localization:this.facade.retrieveProxy("LocalizationProxy").getApi(),playerOptions:this.playerOptions,dispatch:function(e){t.dispatchPluginEvent(e)},logger:this.logger})}},{key:"playerOptions",get:function(){return this.getModel("PlayerOptions").data}},{key:"initPluginServices",value:function(){this.services||(this.services=this.createPluginServices())}},{key:"createPlugins",value:function(t,e){var n=this;return Promise.all(t.map((function(t){return n.createPlugin(t)}))).then((function(){return null==e?void 0:e()}))}},{key:"createPlugin",value:function(t){return kt(this,null,D.default.mark((function e(){var n,i,r,u,a;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.factory,r=t.options,Et.isFunction(i)){e.next=3;break}throw new Error("Invalid plugin factory");case 3:return e.next=5,i(this.services,r);case 5:if(u=e.sent){e.next=8;break}return e.abrupt("return");case 8:if(a=null==(n=u.getId)?void 0:n.call(u)){e.next=11;break}throw new Error("Invalid plugin ID");case 11:return this.plugins[a]=u,this.log("info","Created plugin '".concat(a,"'")),e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"killPlugin",value:function(t){var e=this.plugins[t];e&&(Et.isFunction(e.destroy)&&e.destroy(),delete this.plugins[t])}},{key:"loadPendingPlugins",value:function(){this.pendingLoads&&(this.createPlugins(this.pendingLoads),this.pendingLoads=null)}},{key:"loadPlugins",value:function(t){var e=t.plugins||this.playerOptions.plugins,n=!this.getModel("PresentationState").started,i=t.callback;if(null==e?void 0:e.length){this.initPluginServices();var r=e.filter((function(t){return"low"===t.priority})),u=e.filter((function(t){return"low"!==t.priority}));n&&(this.pendingLoads=r);var a=n?u:r.concat(u);this.createPlugins(a,i)}else null==i||i()}}]),n}(ri),Pi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){this.facade.registerMediator(new Ti("pluginMediator")),this.log("debug","Plugins Prepared")}}]),n}(zn),xi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){this.facade.registerMediator(new ui("TimerMediator")),this.log("debug","Timer mediator registered")}}]),n}(zn),Si=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).defs=[],t.pScope=null,t.keyUpHandler=null,t.keyDownHandler=null,t.pDisabled=!1,t.suppressed=!1,t.scopeActive=null,t}return(0,Q.default)(n,[{key:"onRemove",value:function(){this.activateScope(!1),this.pScope=null;var t=function(t){};this.keyUpHandler=t,this.keyDownHandler=t}},{key:"disabled",get:function(){return this.suppressed||this.pDisabled}},{key:"scope",set:function(t){this.suppressed||(this.pScope&&this.scopeActive&&this.activateScope(!1),this.pScope=t,(!!this.scopeActive||null==this.scopeActive)&&this.activateScope(!0))}},{key:"registerCommandDef",value:function(t){this.suppressed||this.defs.push(t)}},{key:"disable",value:function(){this.suppressed||(this.scopeActive&&this.activateScope(!1),this.pDisabled=!0)}},{key:"enable",value:function(){this.suppressed||(!this.scopeActive&&this.activateScope(!0),this.pDisabled=!1)}},{key:"validatePrimaryKey",value:function(t,e){var n=e.key,i=Et.isString(n)&&n.toLowerCase(),r=e.keyCode;return!(!n&&!r)&&(t.primaryKey===n||t.primaryKey===i||t.keyCode===r)}},{key:"getCommand",value:function(t){for(var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.defs.length,r=null;i--;)if(e=this.defs[i],this.validatePrimaryKey(e,t)&&(!n||this.hasRequiredModifiers(e,t))){r=e;break}return r}},{key:"hasRequiredModifiers",value:function(t,e){var n=!!((t.requireCtrl?1:0)^(e.ctrlKey?1:0)),i=!!((t.requireShift?1:0)^(e.shiftKey?1:0)),r=!!((t.requireMeta?1:0)^(e.metaKey?1:0));return!n&&!i&&!r}},{key:"activateScope",value:function(t){if(this.pScope&&!this.suppressed){var e=t?"addEventListener":"removeEventListener";this.pScope[e]("keyup",this.keyUpHandler),this.pScope[e]("keydown",this.keyDownHandler),this.scopeActive=t}}},{key:"handleNotification",value:function(t){}},{key:"onRegister",value:function(){var t=this;(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this);var e=this.system;!e.document||e.isTv||e.isWebMaf?this.suppressed=!0:(this.keyDownHandler=function(e){return t.hKeyDown(e)},this.keyUpHandler=function(e){return t.hKeyUp(e)})}}]),n}(ri),Ci=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).vpi=null,t.seekMoving=!1,t.seekEnabled=!1,t.VOLUME_INCREMENT=.05,t.SEEK_FACTOR_DISCRETE=.05,t.SEEK_INCREMENT_CONTINUOUS=.001,t.tZero=0,t}return(0,Q.default)(n,[{key:"onRemove",value:function(){clearTimeout(this.timeout),this.vpi=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"isControl",value:function(t){return"BUTTON"===t.nodeName||"INPUT"===t.nodeName}},{key:"hKeyUp",value:function(t){this.disabled||this.isControl(document.activeElement)||(this.seekMoving?this.disengageSeek():this.processKeyEvent(t))}},{key:"hKeyDown",value:function(t){var e=t.key,n=t.keyCode,i="ArrowUp"===e||n===Ut,r="ArrowDown"===e||n===jt,u=" "===e||n===zt,a="ArrowLeft"===e||n===Ft,o="ArrowRight"===e||n===Bt,s=t.repeat;if(!(o||a||i||r||u)||this.isControl(document.activeElement)){if(this.shouldSeekContinuous()&&(a||o)){if(!this.seekMoving&&s)this.tZero=Date.now(),this.engageSeek();else if(this.seekMoving&&s){var l=.001*(Date.now()-this.tZero),c=l>=5?3:l>=3?2:1,h=a?-1:1;this.moveSeekBy(h*this.SEEK_INCREMENT_CONTINUOUS*c)}this.stopEvent(t)}}else t.preventDefault()}},{key:"engageSeek",value:function(){this.seekMoving=!0}},{key:"disengageSeek",value:function(){this.seekMoving=!1,this.tZero=null}},{key:"moveSeekBy",value:function(t){}},{key:"shouldSeekContinuous",value:function(){return!1}},{key:"player",get:function(){if(!this.vpi){var t=this.facade.retrieveMediator("AppMediator");this.vpi=t.getAppApi()}return this.vpi}},{key:"stopEvent",value:function(t){t.stopImmediatePropagation(),t.preventDefault()}},{key:"processKeyEvent",value:function(t){if(t.ctrlKey||t.shiftKey||t.metaKey||"Meta"===t.key||"Shift"===t.key||"Control"===t.key)return null;var e=this.getCommand(t,!1);e&&(this.doAction(e),this.stopEvent(t))}},{key:"doAction",value:function(t){var e,n,i,r=t.action;switch(r){case"increaseVolume":case"decreaseVolume":i="decreaseVolume"===r?-1:1,e=this.player.volume,n=Et.clampValue(e+this.VOLUME_INCREMENT*i,0,1),this.player.muted&&n>0&&(this.player.muted=!1),this.player.volume=n,this.notify({action:r,value:this.player.volume});break;case"seekBack":case"seekForward":if(!this.seekEnabled)return;var u=this.player.contentDuration;if(i="seekBack"===r?-1:1,e=this.player.contentTime,!u||isNaN(u)||1===i&&"DVR"===this.player.streamType&&this.player.isPlayingLive)return;n=Et.clampValue(e+this.SEEK_FACTOR_DISCRETE*i*u,0,u),this.notify({action:r,position:n,duration:u}),this.player.seek(n);break;case"enterFullScreen":this.player.enterFullscreen();break;case"togglePlay":"LIVE"!==this.player.streamType&&this.player.togglePlayPause();break;case"toggleMute":this.player.muted=!this.player.muted,this.notify({action:r,muted:this.player.muted});break;case"toggleTextTrack":this.player.textTrackEnabled=!this.player.textTrackEnabled;break;case"playListNext":case"playListPrev":i="playListPrev"===r?-1:1,this.notify({action:r});break;case"stop":"LIVE"===this.player.streamType?this.player.stop():this.player.pause()}}},{key:"notify",value:function(t){this.sendNotification("hotkeyaction",t,"internal")}},{key:"handleNotification",value:function(t){switch(t.name){case"adbreakstart":this.seekEnabled=!1,this.enable();break;case"contentcomplete":this.seekEnabled=!1,this.disable();break;case"contentstart":case"contentsegmentstart":this.enable(),this.seekEnabled="LIVE"!==this.player.streamType}}},{key:"listNotificationInterests",value:function(){var t=vn;return[t.AD_BREAK_START,t.CONTENT_START,t.CONTENT_SEGMENT_START,t.CONTENT_COMPLETE]}},{key:"onRegister",value:function(){var t=this;(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this),ee.accessibilityKeyCmdDefs.forEach((function(e){return t.registerCommandDef(e)}))}}]),n}(Si),Mi=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t)).app=i,r}return(0,Q.default)(n,[{key:"primeVideoElement",value:function(){var t,e=this.facade.retrieveProxy("PlayerDomProxy"),n=this.getModel("PlayerOptions");return e.primeVideo(null==(t=n.overrides)?void 0:t.blankVideoUrl)}},{key:"offsetTimedText",value:function(t){this.facade.retrieveMediator("PresentationMediator").offsetTimedText(t)}},{key:"setFullscreenElement",value:function(t){this.facade.retrieveMediator("FullscreenMediator").fullscreenElement=t}},{key:"getFullscreenElement",value:function(){return this.facade.retrieveMediator("FullscreenMediator").fullscreenElement}},{key:"onRemove",value:function(){this.app=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"getAppApi",value:function(){return this.app.getApi()}},{key:"getConfigAsJson",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=this.getProxy("ModelCollectionProxy"),n=e.getModel("PlayerOptions").data;return JSON.stringify({resource:this.getCurrentResource(),playerOptions:n,buildInfo:je},(function(t,e){return e instanceof HTMLElement?void 0:e}),t)}},{key:"validateSeek",value:function(t,e){if(isNaN(t))return this.log("warn","Invalid seek() time [".concat(t,"] supplied")),null;var n=this.getModel("PresentationState"),i=this.getProxy("ContentPlaybackStateProxy"),r=i&&"LIVE"===i.model.streamType;return!n||!i||n.isCurrentVideoAd||r?(this.log("warn","seek() may not be called in the current context"),null):Et.clampValue(t,0,e)}},{key:"isPlaybackSuspended",value:function(){return this.getModel("PresentationState").suspended}},{key:"getContainerRect",value:function(){var t=this.getProxy("PlayerDomProxy");return t?t.getPresentationRect():null}},{key:"getCurrentResource",value:function(){var t=this.getProxy("ResourceProxy");return(null==t?void 0:t.resource)||null}},{key:"killCurrentResource",value:function(){var t=this.facade.retrieveMediator("PresentationMediator");return this.log("info","Killing current resource"),Promise.resolve().then((function(){return null==t?void 0:t.close()})).catch((function(t){Rt.error(t)}))}},{key:"skipAd",value:function(){this.facade.retrieveMediator("PresentationMediator").skipAd()}},{key:"getPlugin",value:function(t){var e=this.facade.retrieveMediator("pluginMediator");return e?e.getPlugin(t):null}},{key:"dispatchPluginEvent",value:function(t){this.app.sendEvent("pluginevent",t)}},{key:"getMuteState",value:function(){var t=this.getModel("PresentationState");return t?t.isMuted:null}},{key:"getVolume",value:function(){var t=this.getModel("PresentationState");return t?t.volume:NaN}},{key:"getDimensions",value:function(){var t=this.getProxy("PlayerDomProxy");return t?t.getDimensions():null}},{key:"getAdBreakTimes",value:function(){var t=this.facade.retrieveMediator("PresentationMediator");return t?t.getAdBreakTimes():null}},{key:"grabFrame",value:function(){var t=this.getProxy("PlayerDomProxy"),e=null==t?void 0:t.getVideo();if(!e)return null;var n=document.createElement("canvas"),i=n.getContext("2d"),r=n.width=e.videoWidth,u=n.height=e.videoHeight;i.drawImage(e,0,0,r,u);var a=n.toDataURL(),o=document.createElement("img");return o.setAttribute("src",a),o}},{key:"listNotificationInterests",value:function(){return Et.values(vn)}},{key:"sendErrorEvent",value:function(t,e){this.app.sendEvent(t,e)}},{key:"handleNotification",value:function(t){this.app.sendEvent(t.name,t.body)}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this)}}]),n}(ri),Ei=dt(pt(),1),Ni=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t,i)).isFullscreen=!1,r.fsElement=null,r.enabled=!1,r.pIsAndroidFirefox=null,r.fsApiSupported=!0,r.fsMgr=null,r.useCustomFullscreen=!0,r.iosPropNames={ENTER_EVENT:"webkitbeginfullscreen",EXIT_EVENT:"webkitendfullscreen",ENTER_METHOD:"webkitEnterFullscreen",EXIT_METHOD:"webkitExitFullscreen",SUPPORTED:"webkitSupportsFullscreen"},r.fsMgr=Ei.default,r.changeHandler=function(t){return r.hChange(t)},r}return(0,Q.default)(n,[{key:"fullscreenElement",get:function(){return this.fsElement},set:function(t){if(t instanceof HTMLElement){var e=this.system;e.isIos||e.isAndroid||(this.fsElement=t)}}},{key:"onRemove",value:function(){!this.fsApiSupported&&this.fsElement&&(this.fsElement.removeEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.removeEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler)),this.fsMgr&&Et.isFunction(this.fsMgr.off)&&this.fsMgr.off("change",this.changeHandler),this.fsElement=null,this.fsMgr=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"enter",value:function(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!0,void this.sendFullscreenNotification()):void(this.fsApiSupported?this.fsMgr.request(this.fsElement):this.enterFsIos())}},{key:"exit",value:function(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!1,void this.sendFullscreenNotification()):void(this.fsApiSupported?this.fsMgr.exit():this.exitFsIos())}},{key:"isFullScreenPermitted",value:function(){return this.enabled}},{key:"isFullScreen",value:function(){return this.isFullscreen}},{key:"isAndroidFirefox",get:function(){if(null==this.pIsAndroidFirefox){var t=this.system;this.pIsAndroidFirefox="Android"===t.os&&"Firefox"===t.browser}return this.pIsAndroidFirefox}},{key:"handleNotification",value:function(t){var e=t.name;"videoelementadded"!==e?"streammetadata"!==e?this.enabled&&("enterFullscreenRequest"===e?this.enter():this.exit()):this.handleMetadataLoaded():this.onRegister()}},{key:"listNotificationInterests",value:function(){return["videoelementadded","streammetadata","enterFullscreenRequest","exitFullscreenRequest"]}},{key:"handleMetadataLoaded",value:function(){this.enabled=this.enabled||this.webkitIosEnabled(),this.enabled&&this.sendNotification("fullscreenAvailable",null)}},{key:"hChange",value:function(t){this.isFullscreen=this.fsApiSupported?Ei.default.isFullscreen:this.checkWebkitIosState(t),this.isAndroidFirefox&&(this.isFullscreen&&this.fsElement.setAttribute("controls",""),!this.isFullscreen&&this.fsElement.removeAttribute("controls")),this.sendFullscreenNotification()}},{key:"sendFullscreenNotification",value:function(){this.sendNotification("fullscreenChange",{isFullscreen:this.isFullscreen},"internal")}},{key:"enterFsIos",value:function(){this.fsElement[this.iosPropNames.ENTER_METHOD]()}},{key:"exitFsIos",value:function(){this.fsElement[this.iosPropNames.EXIT_METHOD]()}},{key:"webkitIosEnabled",value:function(){return this.system.isIos&&this.fsElement[this.iosPropNames.SUPPORTED]}},{key:"checkWebkitIosState",value:function(t){return t.type===this.iosPropNames.ENTER_EVENT}},{key:"onRegister",value:function(){if(this.useCustomFullscreen=!this.getModel("PlayerOptions").useNativeFullscreen,this.useCustomFullscreen)this.enabled=!0;else{var t=this.facade.retrieveProxy("PlayerDomProxy");this.fsMgr.isEnabled?this.fsElement=t.getMain():(this.fsApiSupported=!1,this.fsElement=t.getVideo()),this.fsApiSupported&&this.fsElement&&this.fsMgr.isEnabled?(this.enabled=!0,this.fsMgr.on("change",this.changeHandler)):this.fsElement&&!this.fsApiSupported&&(this.fsElement.addEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.addEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler))}}}]),n}(ri),Vi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.facade,n=t.body.app;e.registerMediator(new Mi("AppMediator",n));var i=this.system;if(i.global&&!i.isWebMaf){i.isTv||e.registerMediator(new Ni("FullscreenMediator"));var r=t.body.playerOptions;if("none"!==this.getScopeForKeys(r.overrides&&r.overrides.keyboardScope)){var u=new Ci("accessibilityKeyCommandMediator");e.registerMediator(u),u.scope=this.getPlayerContainer()}this.log("debug","View prepared")}else this.log("info","Skipping view creation")}},{key:"getScopeForKeys",value:function(t){switch(t){case"player":case"document":case"none":return t}return"player"}},{key:"getPlayerContainer",value:function(){return this.facade.retrieveProxy("PlayerDomProxy").getMain()}}]),n}(zn),Ii=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"initializeMacroCommand",value:function(){this.addSubCommand(bi),this.addSubCommand($n),this.addSubCommand(xi),this.addSubCommand(Vi),this.addSubCommand(Pi)}}]),n}(Hn),Ri=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){if(this.facade.retrieveMediator("AppMediator")){var e=t.name,n=t.body,i=n.error||n;this.setDetails(e,i),i.fatal?this.logger.error(i.message):this.logger.warn(i.message),this.sendNotification("error",{error:i})}}},{key:"setDetails",value:function(t,e){var n=null,i=null;switch(t){case"resourceerror":n="Resource";break;case"videostarterror":n="Video start";break;case"videoplaybackerror":n="Playback";break;case"aderror":n="Ad";break;case"adstalled":n="Ad",i=ee.messages.AD_STALLED}i&&(e.message=i),e.category=n}}]),n}(zn),Oi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){this.facade.removeMediator("PresentationMediator"),this.facade.removeProxy("ResourceProxy"),this.facade.removeProxy("ContentPlaybackStateProxy"),this.facade.retrieveProxy("ModelCollectionProxy").reset()}}]),n}(zn),Di=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this,n=t.name,i=t.body;if("changeLanguage"===n){var r=this.facade.retrieveProxy("LocalizationProxy"),u=i.language;r.changeLanguage(u).then((function(){var t=e.facade.retrieveProxy("PlayerDomProxy");if(t){var n=t.getMain();n.setAttribute("aria-label",r.localize("media-player")),n.setAttribute("lang",r.language)}e.sendNotification("languagechange",{language:u})}))}}}]),n}(zn),Li=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e,n,i=this,r=this.facade.retrieveMediator("PresentationMediator"),u=this.facade.retrieveProxy("ResourceProxy"),a=null==u?void 0:u.resource,o=null==(e=this.contentPlaybackStateProxy)?void 0:e.model;if(o&&a)switch(t.name){case"play":var s=!!r,l=s&&this.getModel("PresentationState").started;s&&"external"===t.type&&!l?this.invokePlayOnUserGesture(r):l&&(null==r||r.play());break;case"pause":null==r||r.pause();break;case"stop":var c=this.facade.retrieveMediator("AppMediator"),h=this.isVod();c.killCurrentResource().then((function(){h||i.sendNotification("livepresentationstopped",{resource:a})}));break;case"seek":r.seek(t.body.value);break;case"seekForward":n=o.time+t.body.value,r.seek(Math.min(n,o.duration));break;case"seekBack":n=o.time-t.body.value,r.seek(Math.max(n,0));break;case"seekToLive":!this.isVod()&&o.liveStreamInfo&&(n=o.liveStreamInfo.relativeDuration,r.seek(Math.min(n,o.duration)));break;case"switchAudioTrack":r.adapter.setAudioTrack(t.body.value);break;case"switchTextTrack":var f=t.body.value;if(f){this.facade.retrieveProxy("TextTrackProxy").language=f.language;var v=this.contentPlaybackStateProxy.getTextTrackById(f.id);r.adapter.setTextTrack(v)}break;case"switchTextMode":var d=t.body.value,y=this.facade.retrieveProxy("TextTrackProxy");y.enabled=d,(null==r?void 0:r.adapter)&&r.adapter.setTextTrackMode(y.mode);break;case"mutechange":r.mute(t.body.muted);break;case"volumechange":var A=t.body.volume;!isNaN(A)&&r.setVolume(A)}else this.log("debug","play() can not be invoked in this context.")}},{key:"contentPlaybackStateProxy",get:function(){return this.facade.retrieveProxy("ContentPlaybackStateProxy")}},{key:"isVod",value:function(){var t=this.contentPlaybackStateProxy.model.streamType;return"LIVE"!==t&&"DVR"!==t}},{key:"shouldSkipPriming",value:function(){var t=this.facade.retrieveProxy("PlayerDomProxy"),e=this.getModel("PlayerOptions").overrides,n=this.system;return!t||n.supportsUnrestrictedAutoplay||!0===(null==e?void 0:e.skipPriming)}},{key:"invokePlayOnUserGesture",value:function(t){var e=this,n=this.facade.retrieveProxy("PlayerDomProxy"),i=this.getModel("PlayerOptions").overrides,r=this.system;(t.beforePlayOnUserGesture(),this.shouldSkipPriming())?t&&t.playOnUserGesture():n.primeVideo(null==i?void 0:i.blankVideoUrl).then((function(){if("iPhone"===r.device){var e="timeupdate",i=n.getVideo();i.addEventListener(e,(function n(r){i.removeEventListener(e,n),setTimeout((function(){return t.playOnUserGesture()}),200)}))}else t.playOnUserGesture()})).catch((function(t){e.log("error","ERROR - PlaybackCommand: Priming FAILED.  ".concat(t.message)),e.facade.sendNotification("autoplayblocked",t,"internal")}))}}]),n}(zn),Fi=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).isReady=!1,t.pUserQualityCategory=null,t}return(0,Q.default)(n,[{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this);var t=this.facade.retrieveProxy("ModelCollectionProxy");this.contentPlaybackState=t.getModel(Ai.modelName),this.contentPlaybackState.qualityInfo={mode:"auto",quality:null,qualities:[]},this.contentPlaybackState.textTracks={track:null,tracks:[]},this.contentPlaybackState.audioTracks={track:null,tracks:[]},this.pTextTracks={},this.isReady=!0}},{key:"onRemove",value:function(){this.contentPlaybackState=null,this.pTextTracks=null,this.thumbnailTrack=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"processQualityProfile",value:function(t){this.tagQualities(t),this.contentPlaybackState.qualityInfo.qualities=t}},{key:"updateQualityProfile",value:function(t,e,n){var i=n.slice(t,e+1);this.processQualityProfile(i)}},{key:"addTextTrack",value:function(t){this.contentPlaybackState.textTracks.tracks.push(t),this.pTextTracks[t.id]=t}},{key:"getTextTrackById",value:function(t){return this.pTextTracks[t]}},{key:"tagQualities",value:function(t){t.forEach((function(t){t.category||(t.category=["".concat(String(jn.getQualityCategoryForVideoHeight(t.height))),"".concat(t.height,"p"),"".concat(Math.round(t.bitrate/1e3)," kbps")])}))}},{key:"getThumbnail",value:function(t){var e;return null==(e=this.thumbnailTrack)?void 0:e.getCueAt(t)}},{key:"textTrackInfo",get:function(){return this.contentPlaybackState.textTracks}},{key:"textTrack",get:function(){return this.contentPlaybackState.textTracks.track},set:function(t){this.contentPlaybackState.textTracks.track=t}},{key:"isAbrSwitchingAvailable",get:function(){return!!this.manifestQualities&&this.manifestQualities.length>1}},{key:"userQualityCategory",get:function(){return this.pUserQualityCategory},set:function(t){this.pUserQualityCategory=t}},{key:"qualitySwitchingMode",get:function(){return this.contentPlaybackState.qualityInfo.mode},set:function(t){this.contentPlaybackState.qualityInfo.mode=t}},{key:"manifestQualities",get:function(){return this.contentPlaybackState.manifestQualities},set:function(t){this.contentPlaybackState.manifestQualities=t}},{key:"maxBandwidth",set:function(t){this.contentPlaybackState.maxBandwidth=isNaN(this.contentPlaybackState.maxBandwidth)?t:Math.max(t,this.contentPlaybackState.maxBandwidth)}},{key:"model",get:function(){return this.contentPlaybackState}},{key:"minIndex",get:function(){return 0}},{key:"maxIndex",get:function(){return this.contentPlaybackState.qualityInfo.qualities?this.contentPlaybackState.qualityInfo.qualities.length-1:0}},{key:"minBitrate",get:function(){return this.contentPlaybackState.qualityInfo.qualities[this.minIndex].bitrate}},{key:"maxBitrate",get:function(){return this.contentPlaybackState.qualityInfo.qualities[this.maxIndex].bitrate}},{key:"qualityInfo",get:function(){return this.contentPlaybackState.qualityInfo}},{key:"quality",set:function(t){this.contentPlaybackState.qualityInfo.quality=t}},{key:"audioTrackInfo",get:function(){return this.contentPlaybackState.audioTracks}},{key:"audioTrack",set:function(t){this.contentPlaybackState.audioTracks.track=t}}]),n}(Vn),Ui=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"mock",value:function(t){this.pResource=t}},{key:"onRemove",value:function(){this.pResource=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this),this.pResource=this.data}},{key:"resource",get:function(){return this.pResource}},{key:"location",get:function(){return this.pResource.location}},{key:"playback",get:function(){return this.pResource.playback}},{key:"metadata",get:function(){return this.pResource.metadata}},{key:"ad",get:function(){return this.pResource.ad}},{key:"adTrackingSettings",get:function(){return this.pResource.ad.viewabilityTracking}},{key:"hasValidMediaUrl",get:function(){return!Et.isEmpty(this.location.mediaUrl)}}]),n}(Vn),Bi=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).started=!1,t.preloadContent=!0,t.minDvrDuration=1800,t.adapterTask=Promise.resolve(),t.t=!1,t.i=!1,t.previousPlaybackState={state:null,overrides:{},buffer:NaN},t.contentIsBuffering=!1,t.endFreezeTimeoutHandle=null,t.timedTextOffset=0,t.isMonitoringCueEvents=!1,t.onLoadError=function(e){var n=e.message,i=e.cause;t.sendErrorNotification(n,i)},t.qualityChange=function(e){var n;if(e){var i=(0,F.default)(t).contentPlaybackStateProxy;if(i.isAbrSwitchingAvailable)(null==(n=i.qualityInfo.quality)?void 0:n.bitrate)!==e.bitrate&&(i.quality=e,i.model.bitrate=e.bitrate,t.respondToQualityChange(e))}else t.logger.warn("Invalid quality change")},t.qualitiesChange=function(e){var n=(0,F.default)(t).contentPlaybackStateProxy;t.contentPlaybackStateProxy.processQualityProfile(e),t.contentPlaybackStateProxy.manifestQualities=e,n.isAbrSwitchingAvailable?n.model.qualityInfo&&(n.updateQualityProfile(0,e.length-1,e),t.log("info","Quality Info: ",n.model.qualityInfo),t.notify("qualityinfochange",{qualityInfo:n.model.qualityInfo})):(t.logger.log("info",ee.messages.ABR_UNAVAILABLE),n.qualitySwitchingMode="unavailable")},t.error=function(e){e.fatal&&(t.adapterTask=Promise.resolve()),t.respondToError(e)},t.audioTrackChange=function(e){t.contentPlaybackStateProxy.audioTrackInfo.track=e,t.notify("audiotrackchange",{audioTrack:e})},t.audioTracksChange=function(e){t.contentPlaybackStateProxy.audioTrackInfo.tracks=e,t.notify("audiotrackinfochange",{audioTrackInfo:t.contentPlaybackStateProxy.audioTrackInfo})},t.cdnChange=function(e){var n=(0,F.default)(t).contentPlaybackStateProxy;e!==n.model.cdn&&(n.model.cdn=e,t.notify("cdnchange",{cdn:e}))},t.drmKeySystemCreated=function(e){t.contentPlaybackStateProxy.model.drmType=e,t.notify("drmkeysystemcreated",{keysystem:e})},t.timeUpdate=function(){clearTimeout(t.endFreezeTimeoutHandle);var e=t.pAdapter.getCurrentTime(),n=t.presoModel.streamDuration;t.updateLiveStreamInfo(),!t.pAdapter.getIsLiveStream()&&!isNaN(n)&&n-e<=.15&&t.protectAgainstEndFreeze(250),t.respondToVideoTimeUpdate(e)},t.playing=function(){t.i=!1,t.updateLiveStreamInfo(),t.respondToVideoPlaying()},t.paused=function(){t.i=!0,t.respondToVideoPaused()},t.seeking=function(){t.t=!0,t.respondToVideoSeeking(),t.respondToWaiting("seeking",!0)},t.seeked=function(){t.t=!1,t.respondToVideoSeeked(),t.respondToWaiting("seeking",!1)},t.ended=function(){clearTimeout(t.endFreezeTimeoutHandle),t.respondToVideoEnd()},t.durationChange=function(){var e=t.pAdapter.getDuration();e>0&&t.respondToDurationChange(e)},t.volumeChange=function(e,n){e!==t.presoModel.volume&&t.notify("volumechange",{volume:e}),null!=n&&n!==t.presoModel.isMuted&&t.notify("mutechange",{muted:n})},t.metadataCuepoint=function(e){t.respondToId3Data(e)},t.textCuepoints=function(e){t.isMonitoringCueEvents&&e.forEach((function(e){return t.respondToTtCue(e)})),t.notify("textcuepoint",{activeCues:e})},t.textTrackDisplayModeChange=function(e){var n="disabled"!==e;t.facade.retrieveProxy("TextTrackProxy").mode=e,t.notify("texttrackenabledchange",{textTrackEnabled:n}),t.respondToTextTrackModeChange(n)},t.textTracksChange=function(e){null==e||e.forEach((function(e){t.contentPlaybackStateProxy.addTextTrack(e)})),t.respondToTextTrackInfoChange(),t.notify("texttrackavailable")},t.textTrackChange=function(e){t.contentPlaybackStateProxy.textTrack=e,t.notify("texttrackchange",{textTrack:e}),t.respondToTextTrackInfoChange()},t}return(0,Q.default)(n,[{key:"adapter",get:function(){return this.pAdapter}},{key:"timedTextContainer",get:function(){if(!this.u){var t=this.facade.retrieveProxy("PlayerDomProxy");this.u=t.getElement("ccContainer")}return this.u}},{key:"onRemove",value:function(){clearTimeout(this.endFreezeTimeoutHandle),this.pAdapter=null,this.contentPlaybackStateProxy=null,this.resourceProxy=null,this.presoModel=null,this.playerOptions=null,(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"setVolume",value:function(t){this.presoModel.volume=t}},{key:"load",value:function(){return this.loadVideo().catch((function(t){var e=t.type?t.data:t;throw new Se("videostarterror",e)}))}},{key:"play",value:function(){this.playVideo()}},{key:"pause",value:function(){this.pauseVideo()}},{key:"suspend",value:function(){this.pAdapter.suspend()}},{key:"resume",value:function(){this.pAdapter.resume()}},{key:"offsetTimedText",value:function(t){var e=t>0;if(this.timedTextOffset=t,this.playerOptions.renderTextTrackNatively&&"Firefox"===this.system.browser)this.monitorTtCues(e);else if(!1===this.playerOptions.renderTextTrackNatively&&this.timedTextContainer)this.timedTextContainer.style.bottom="".concat(t,"px");else{var n=this.facade.retrieveProxy("PlayerDomProxy").getMain();null==document||document.documentElement.style.setProperty("--avia-timed-text-offset","".concat(t,"px")),null==n||n.classList[e?"add":"remove"]("avia-cc-offset")}}},{key:"loadVideo",value:function(){var t=this;return this.pendingLoad?this.pendingLoad:(this.respondToWaiting("loading",!0),this.pendingLoad=this.pAdapter.load().then((function(e){t.respondToWaiting("loading",!1),t.pendingLoad=null;var n=t.resourceProxy.resource;t.notify("streammetadata",{streamMetadata:Et.merge({manifest:{mimeType:Et.getResourceMimeType(n)},fragment:{mimeType:""}},e)});var i=n.location.thumbnailTrackUrl;!t.contentPlaybackStateProxy.thumbnailTrack&&i&&ce.create(i).then((function(e){t.contentPlaybackStateProxy.thumbnailTrack=e,t.notify("thumbnailtrackavailable",{thumbnailTrack:e})})).catch((function(e){return t.log("warn","Could not load thumbnail track")}))})))}},{key:"playVideo",value:function(){var t=this;this.pAdapter.play().catch((function(e){t.sendNotification("autoplayblocked",e)}))}},{key:"pauseVideo",value:function(){var t;null==(t=this.pAdapter)||t.pause()}},{key:"muteVideo",value:function(t){t||this.presoModel.userHasUnmuted||(this.presoModel.userHasUnmuted=!0),this.presoModel.isMuted=t}},{key:"seekVideo",value:function(t){this.pAdapter.seek(t)}},{key:"checkVideoBuffering",value:function(t){var e=Math.max(Math.floor(this.bufferingSampleRate/ui.INTERVAL),1);if(!(isFinite(e)&&t%e)){var n=!1;if(!this.i){var i=this.previousPlaybackState.buffer+.001,r=this.video.currentTime;this.previousPlaybackState.buffer=r,n=r<i&&!this.t}this.contentIsBuffering!==n&&(this.contentIsBuffering=n,this.notify("resourcebuffering",{buffering:n}),this.respondToWaiting("buffering",n))}}},{key:"video",get:function(){return this.viewControl}},{key:"notify",value:function(t,e){this.sendNotification(t,e,"internal")}},{key:"respondToIsPlayingLiveChange",value:function(t){this.notify("contentisplayinglive",{isLive:t})}},{key:"respondToStreamTypeChange",value:function(t){if(this.streamType!==t){var e=this.contentPlaybackStateProxy.model;this.streamType=t,e.streamType=t,this.notify("streamtypechange",{streamType:t})}}},{key:"respondToWaiting",value:function(t,e){this.previousPlaybackState.overrides[t]=e;var n=!this.previousPlaybackState.state||Et.values(this.previousPlaybackState.overrides).includes(!0);this.respondToPlaybackStateChange(n?"waiting":this.previousPlaybackState.state)}},{key:"respondToPlaybackStateChange",value:function(t){var e=this.contentPlaybackStateProxy.model,n="waiting"!==t;if(e.state!==t){if("idle"!==t&&n&&(this.previousPlaybackState.state=t),this.t&&n)return;e.state=t,this.notify("playbackstatechange",{playbackState:t})}}},{key:"monitorTtCues",value:function(t){var e=Array.from(this.video.textTracks).find((function(t){return Et.isTextTrack(t.kind)&&"showing"===t.mode})),n=null==e?void 0:e.activeCues;if(this.isMonitoringCueEvents=t,n)for(var i=0,r=n.length||0;i<r;i++)this.respondToTtCue(n[i])}},{key:"respondToTtCue",value:function(t){t.line=this.isMonitoringCueEvents?.21875*this.timedTextOffset:"auto"}},{key:"handleNotification",value:function(t){switch(t.name){case"timerTic":this.respondToBufferingStatusCheck(t.body.count),this.checkSize();break;case"fullscreenChange":var e=t.body;this.presoModel.isFullscreen=e.isFullscreen,this.respondToFullscreenChange(e.isFullscreen);break;case"autoQualitySwitching":this.notify("qualityinfochange",{qualityInfo:this.contentPlaybackStateProxy.model.qualityInfo})}}},{key:"listNotificationInterests",value:function(){return["timerTic","fullscreenChange"]}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this),this.contentPlaybackStateProxy=this.facade.retrieveProxy("ContentPlaybackStateProxy"),this.resourceProxy=this.facade.retrieveProxy("ResourceProxy"),this.performanceProxy=this.facade.retrieveProxy("PerformanceProxy"),this.presoModel=this.getModel("PresentationState"),this.playerOptions=this.getModel("PlayerOptions");var t=this.resourceProxy.resource.overrides;Et.isNumber(null==t?void 0:t.minDvrDuration)&&(this.minDvrDuration=t.minDvrDuration),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&(this.muteVideo(!0),this.presoModel.isMuted=!0),this.bufferingSampleRate=this.performanceProxy.bufferingSampleRate}},{key:"prepareForPlayback",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.initializing){var e={system:this.system,playerOptions:this.playerOptions,resource:this.resourceProxy.resource,performanceSettings:this.performanceProxy,textTrackSettings:this.facade.retrieveProxy("TextTrackProxy"),video:this.viewControl,logger:this.logger};this.adapterTask=this.initializeAdapter(e,t).catch(this.onLoadError)}}},{key:"sendErrorNotification",value:function(t,e){this.logger.log("error",e),this.notify(t,e)}},{key:"createAdapter",value:function(t){return kt(this,null,D.default.mark((function e(){var n,i,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.facade.retrieveProxy("AdapterProxy"),e.next=3,n.createAdapter("playback",t.resource,(function(){return r}));case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"initializeAdapter",value:function(t,e){return kt(this,null,D.default.mark((function n(){var i;return D.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.initializing=!0,!this.closing){n.next=4;break}return n.abrupt("return");case 4:return n.prev=4,n.next=7,this.createAdapter(t);case 7:if(this.pAdapter=n.sent,!this.closing){n.next=10;break}return n.abrupt("return");case 10:n.next=17;break;case 12:throw n.prev=12,n.t0=n.catch(4),(i=Et.getResourceMimeType(t.resource))&&(n.t0.message+=". Attempting to play a stream of type ".concat(i)),new Se("resourceerror",n.t0);case 17:if(!this.preloadContent){n.next=20;break}return n.next=20,this.load();case 20:if(n.prev=20,!this.closing){n.next=23;break}return n.abrupt("return");case 23:if(this.presoModel.isAutoplay||e){n.next=25;break}return n.abrupt("return");case 25:this.play(),n.next=31;break;case 28:throw n.prev=28,n.t1=n.catch(20),new Se("videoplaybackerror",n.t1);case 31:return n.prev=31,this.initializing=!1,n.finish(31);case 34:case"end":return n.stop()}}),n,this,[[0,,31,34],[4,12],[20,28]])})))}},{key:"respondToTextTrackInfoChange",value:function(){this.notify("texttrackinfochange",{textTrackInfo:this.contentPlaybackStateProxy.textTrackInfo})}},{key:"protectAgainstEndFreeze",value:function(t){var e=this;clearTimeout(this.endFreezeTimeoutHandle),this.endFreezeTimeoutHandle=setTimeout((function(){e.respondToVideoEnd()}),t)}},{key:"calculateStreamType",value:function(){if(this.pAdapter.getIsLiveStream()){var t=this.pAdapter.getLiveStreamInfo().dvrWindowSize;return t<this.minDvrDuration||isNaN(t)?"LIVE":"DVR"}return"VOD"}},{key:"updateLiveStreamInfo",value:function(){if(this.pAdapter.getIsLiveStream()){var t=this.contentPlaybackStateProxy.model,e=this.pAdapter.getLiveStreamInfo();t.liveStreamInfo=e;var n=this.calculateStreamType();this.respondToStreamTypeChange(n);var i="LIVE"===n||e.isPlayingLive;this.isPlayingLive!==i&&(this.isPlayingLive=i,this.respondToIsPlayingLiveChange(i)),"DVR"===t.streamType&&this.respondToDurationChange(e.relativeDuration)}else this.respondToStreamTypeChange("VOD")}}]),n}(ri),ji=function(t){(0,j.default)(n,t);var e=G(n);function n(){var t;return(0,_.default)(this,n),(t=e.apply(this,arguments)).contentDurationReleased=!1,t.resumeTimeMaxProximityToAdBreak=5,t.isClickToPlay=!1,t.fullscreenRestrictedDuringAdPlay=!1,t.hasContent=!0,t.contentComplete=!1,t.timeSpent={startTime:null,lastTime:0,sessionTime:0,playbackTime:0,elapsedTime:0},t}return(0,Q.default)(n,[{key:"onRemove",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"start",value:function(){var t=this.resourceProxy.location.mediaUrl;this.hasContent=Et.isString(t)&&!Et.isEmpty(t)}},{key:"close",value:function(){var t,e=this;if(this.closing)return this.closing;var n=null==(t=this.contentPlaybackStateProxy)?void 0:t.model,i=(null==n?void 0:n.time)||0,r=(null==n?void 0:n.duration)||0,u=this.isAdPlaying(),a=this.resourceProxy.resource;return this.respondToPlaybackStateChange("stopped"),this.contentPlaybackStateProxy.isReady=!1,this.closing=this.adapterTask.then((function(){e.pause(),e.log("info","Closing Presentation"),e.closeAds()})).then((function(){return e.adapter?e.adapter.destroy():null})).then((function(){var t=e.hasContent&&!e.isContentComplete(),n=u;e.notify("resourceend",{resource:a,contentTime:i,contentDuration:r,contentInterrupted:t,adInterrupted:n,interrupted:t||n})})).catch((function(t){throw Rt.error(t),t})).then((function(){e.closing=null}))}},{key:"getPlayerVersionInfo",value:function(){return"".concat(je.playerName,"_").concat(je.playerVersion)}},{key:"startContentSegment",value:function(){}},{key:"closeAds",value:function(){}},{key:"beforePlayOnUserGesture",value:function(){}},{key:"playOnUserGesture",value:function(){this.notify("videoLoadStart"),this.prepareForPlayback(!0)}},{key:"mute",value:function(t){this.muteVideo(t)}},{key:"play",value:function(){this.contentComplete&&(this.contentComplete=!1),(0,B.default)((0,W.default)(n.prototype),"play",this).call(this)}},{key:"seek",value:function(t){this.contentComplete&&(this.contentComplete=!1),this.seekVideo(t)}},{key:"setVolume",value:function(t){this.domProxy&&this.domProxy.setVideoVolume(t),(0,B.default)((0,W.default)(n.prototype),"setVolume",this).call(this,t)}},{key:"getAdBreakTimes",value:function(){return[]}},{key:"releaseContentDuration",value:function(t){this.contentDurationReleased=!0,this.notify("contentdurationavailable",{contentDuration:t})}},{key:"updateTimeSpent",value:function(){var t=Date.now();null==this.timeSpent.startTime&&(this.timeSpent.startTime=t),null==this.timeSpent.lastTime&&(this.timeSpent.lastTime=t);var e=t-this.timeSpent.startTime;return this.timeSpent.elapsedTime=e,this.timeSpent.sessionTime=e/1e3,"paused"!==this.contentPlaybackStateProxy.model.state&&(this.timeSpent.playbackTime+=(t-this.timeSpent.lastTime)/1e3,this.timeSpent.lastTime=t),this.timeSpent}},{key:"adjustStartTimeForAdBreakProximity",value:function(t,e){for(var n=0,i=e.length;n<i;n++){var r=e[n].startTime-t;if(r>=0&&r<this.resumeTimeMaxProximityToAdBreak)return t-this.resumeTimeMaxProximityToAdBreak}return t}},{key:"domProxy",get:function(){return this.facade.retrieveProxy("PlayerDomProxy")}},{key:"muteVideo",value:function(t){(0,B.default)((0,W.default)(n.prototype),"muteVideo",this).call(this,t),this.domProxy&&this.domProxy.muteVideo(t)}},{key:"respondToPlaybackStateChange",value:function(t){(0,B.default)((0,W.default)(n.prototype),"respondToPlaybackStateChange",this).call(this,t),this.timeSpent.lastTime=null}},{key:"respondToFullscreenChange",value:function(t){this.checkSize(),this.notify("fullscreenchange",{fullscreen:t})}},{key:"respondToVideoPaused",value:function(){this.respondToPlaybackStateChange("paused")}},{key:"respondToVideoPlaying",value:function(){this.presoModel.started||(this.presoModel.started=!0),this.respondToPlaybackStateChange("playing")}},{key:"respondToVideoSeeking",value:function(){this.notify("seekstart")}},{key:"respondToVideoSeeked",value:function(){this.notify("seekcomplete")}},{key:"respondToQualityChange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.notify("qualitychange",{quality:t})}},{key:"respondToError",value:function(t){t.message||(t.message=ee.messages.UNSPECIFIED_ERROR),t.code||(t.code="3400"),this.sendErrorNotification("videoplaybackerror",t)}},{key:"respondToVideoEnd",value:function(){this.notify("resourceComplete")}},{key:"respondToBufferingStatusCheck",value:function(t){var e=this.presoModel.streamTime;!isNaN(e)&&e>0&&this.checkVideoBuffering(t)}},{key:"respondToId3Data",value:function(t){this.notify("metadatacuepoint",{cue:t})}},{key:"respondToVideoTimeUpdate",value:function(t){var e=this.contentPlaybackStateProxy.model,n=e.duration,i=e.liveStreamInfo,r=e.streamType,u=e.time;this.updateTimeSpent();var a={contentTime:u,contentDuration:n,streamTime:t,streamDuration:this.presoModel.streamDuration,sessionTime:this.timeSpent.sessionTime,playbackTime:this.timeSpent.playbackTime};if("VOD"!==r){var o=i.relativeTime,s=i.relativeDuration;a.contentTime=o,a.contentDuration=s,a.elapsedTimeMs=this.timeSpent.elapsedTime,e.time=o,e.duration=s}this.notify("contentprogress",a)}},{key:"respondToSizeChange",value:function(){this.adapter&&this.adapter.resize()}},{key:"respondToDurationChange",value:function(t){}},{key:"respondToTextTrackModeChange",value:function(t){}},{key:"checkSize",value:function(){if(this.domProxy){var t=this.domProxy.getPresentationRect();t.width===this.currentRect.width&&t.height===this.currentRect.height||(this.currentRect=t,this.respondToSizeChange(),this.notify("presentationsizechange",{width:this.currentRect.width,height:this.currentRect.height}))}}},{key:"setForClickToPlay",value:function(){var t=this;if(this.getModel("PlayerOptions").useNativeControls){var e=this.domProxy.getMain();e.addEventListener("click",(function n(){e.removeEventListener("click",n),t.notify("playOnUSerGesture")}))}}},{key:"isContentComplete",value:function(){if(this.contentComplete)return!0;var t=this.contentPlaybackStateProxy.model;return"LIVE"!==t.streamType&&"DVR"!==t.streamType&&!(isNaN(t.time)||t.time<t.duration)}},{key:"isAdPlaying",value:function(){return this.presoModel.isCurrentVideoAd}},{key:"handleNotification",value:function(t){(0,B.default)((0,W.default)(n.prototype),"handleNotification",this).call(this,t)}},{key:"listNotificationInterests",value:function(){return(0,B.default)((0,W.default)(n.prototype),"listNotificationInterests",this).call(this).concat([])}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this);var t=this.playerOptions.overrides;t.resumeTimeMaxProximityToAdBreak&&(this.resumeTimeMaxProximityToAdBreak=t.resumeTimeMaxProximityToAdBreak),this.isClickToPlay=!this.presoModel.isAutoplay;var e=this.system;this.fullscreenRestrictedDuringAdPlay=e.isIos||e.isAndroid,this.domProxy&&(this.currentRect=this.domProxy.getPresentationRect())}}]),n}(Bi),zi=function(t){(0,j.default)(n,t);var e=G(n);function n(t,i){var r;return(0,_.default)(this,n),(r=e.call(this,t,i)).pAdAdapter=null,r.adAdapterStarted=!1,r.contentSegmentStarted=!1,r.contentStartReleased=!1,r.contentCompleteReleased=!1,r.fatalContentErrorReceived=!1,r.presoComplete=!1,r.hasMidRolls=!1,r.pendingSeekTime=null,r.currentAd=null,r.currentBreak=null,r.pointerLocked=!1,r.isPreloading=!1,r.cancelPointerLock=function(){var t;document.removeEventListener("mousemove",r.cancelPointerLock),null==(t=document.exitPointerLock)||t.call(document),r.pointerLocked=!1},r.setPointerState=function(){var t,e;!r.pointerLocked||r.isFullScreenAd()?!r.pointerLocked&&r.isFullScreenAd()&&(null==(e=null==(t=r.domProxy)?void 0:t.getMain())||e.requestPointerLock(),r.pointerLocked=!0,setTimeout((function(){return null==document?void 0:document.addEventListener("mousemove",r.cancelPointerLock)}),100)):r.cancelPointerLock()},r.hMovement=function(t){r.presoModel.isFullscreen&&r.pointerLockDebouncer()},r.preloadContent=!1,r}return(0,Q.default)(n,[{key:"adAdapter",get:function(){return this.pAdAdapter},set:function(t){this.pAdAdapter=t}},{key:"adInProgress",get:function(){return this.presoModel.isCurrentVideoAd}},{key:"onRemove",value:function(){var t,e;null==(e=null==(t=this.pAdAdapter)?void 0:t.destroy)||e.call(t),this.pAdAdapter=null,this.cancelPointerLock(),(0,B.default)((0,W.default)(n.prototype),"onRemove",this).call(this)}},{key:"closeAds",value:function(){var t,e;null==(t=this.domProxy)||t.showAdContainer(!1),null==(e=this.adAdapter)||e.destroy(),this.pAdAdapter=null}},{key:"beforePlayOnUserGesture",value:function(){var t;null==(t=this.adAdapter)||t.playClicked()}},{key:"start",value:function(){var t,e,i,r=this.resourceProxy.playback.startTime,u=this.resourceProxy.ad.showPrerollOnNonZeroStart,a=!isNaN(r)&&r>0;if((0,B.default)((0,W.default)(n.prototype),"start",this).call(this),this.mute(this.presoModel.isMuted),a&&u&&(this.pendingSeekTime=r),this.isClickToPlay)this.setForClickToPlay();else{var o=this.resourceProxy.resource;(null==(e=null==(t=o.ad)?void 0:t.csai)?void 0:e.adCallUrl)&&!(null==(i=o.location)?void 0:i.mediaUrl)?this.play():(this.notify("videoLoadStart"),this.prepareForPlayback())}}},{key:"getAdBreakTimes",value:function(){var t,e=[];return null==(t=this.breakSchedule)||t.forEach((function(t){e.push(ct({start:t.startTime,streamTimeStart:t.streamStartTime,end:t.endTime,streamTimeEnd:t.streamStartTime+t.duration,played:t.hasPlayed},t))})),e}},{key:"getDelegate",value:function(){return Un({},this)}},{key:"play",value:function(){var t;if(this.presoModel.started){if(this.adInProgress)return void((null==(t=this.adAdapter)?void 0:t.resume)?this.adAdapter.resume():this.playVideo());this.playVideo()}else this.presoModel.started=!0,this.adAdapterStarted=!0,this.adAdapter.start()}},{key:"pause",value:function(){var t;this.adInProgress&&(null==(t=this.adAdapter)?void 0:t.pause)?this.adAdapter.pause():this.pauseVideo()}},{key:"mute",value:function(t){var e=this;return kt(this,null,D.default.mark((function i(){var r;return D.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:null==(r=this.adAdapter)||r.setMuteState(t),(u="mute",(0,B.default)((0,W.default)(n.prototype),u,e)).call(this,t);case 2:case"end":return i.stop()}var u}),i,this)})))}},{key:"setVolume",value:function(t){var e;null==(e=this.adAdapter)||e.setVolume(t),(0,B.default)((0,W.default)(n.prototype),"setVolume",this).call(this,t)}},{key:"seek",value:function(t){var e,i,r=t;if(this.hasMidRolls&&this.adAdapter){var u=this.adAdapter.getPermittedSeekTime(t);u!==t&&(this.pendingSeekTime=(null==(i=(e=this.adAdapter).streamTimeForContentTime)?void 0:i.call(e,t))||t,r=u,this.notify("seekredirectstart",{requestedSeekTime:t,actualSeekTime:u}))}this.contentComplete&&!this.contentSegmentStarted&&(this.contentSegmentStarted=!0),(0,B.default)((0,W.default)(n.prototype),"seek",this).call(this,r)}},{key:"skipAd",value:function(){var t;null==(t=this.adAdapter)||t.skipAd()}},{key:"pauseContent",value:function(){var t;this.pauseVideo(),null==(t=this.domProxy)||t.showAdContainer(!0)}},{key:"resumeContent",value:function(){var t,e,i=this;if(this.currentAd=null,this.currentBreak=null,null==(t=this.domProxy)||t.showAdClickElement(!1),null==(e=this.domProxy)||e.showAdContainer(!1),!this.fatalContentErrorReceived)if(this.hasContent&&!this.contentComplete){if(this.contentStartReleased)this.resumeContentPlayComplete();else{var r=this.resourceProxy.playback.startTime;if(!isNaN(r)&&r>0){var u=this.getAdBreakTimes(),a=this.adjustStartTimeForAdBreakProximity(r,u);this.resourceProxy.playback.startTime=a}this.load().then((function(){i.resumeContentPlayComplete()})).catch(this.onLoadError)}}else(0,B.default)((0,W.default)(n.prototype),"respondToVideoEnd",this).call(this)}},{key:"streamIdAvailable",value:function(t){this.notify("streamidavailable",{streamId:t})}},{key:"applyHook",value:function(t,e){return this.getProxy("HookProxy").applyHook(t,e)}},{key:"adSegmentStarted",value:function(){this.contentSegmentStarted=!1,this.presoModel.isCurrentVideoAd=!0,this.notify("adsegmentstart")}},{key:"adSegmentEnded",value:function(){this.contentSegmentStarted=!1,this.presoModel&&(this.presoModel.isCurrentVideoAd=!1),this.notify("adsegmentend")}},{key:"adBreaksAvailable",value:function(t){this.hasMidRolls=t.some((function(t){return"MID"===t.type})),this.breakSchedule=t;var e=t.map((function(t){return t.startTime}));this.notify("adcuepointsavailable",{cuepoints:e,adBreaks:t})}},{key:"seekToStreamTime",value:function(t){this.seekVideo(t)}},{key:"adBreakStart",value:function(){var t;this.endContentSegment(),this.updateSize(),null==(t=this.domProxy)||t.showAdContainer(!0),this.presoModel.isCurrentVideoAd=!0,this.notify("adbreakstart")}},{key:"adBreakMetadata",value:function(t){this.currentBreak=t,this.notify("adbreakmetadata",{adBreakInfo:t})}},{key:"adLoaded",value:function(){}},{key:"adStart",value:function(t){this.currentAd=t,this.respondToPlaybackStateChange("playing"),this.notify("adstart",{adInfo:t})}},{key:"adProgress",value:function(t,e){this.notify("adprogress",{currentTime:t,duration:e,streamTime:this.presoModel.streamTime,streamDuration:this.presoModel.streamDuration}),this.checkPreload(t,e)}},{key:"adFirstQuartile",value:function(){this.notify("adfirstquartile")}},{key:"adMidpoint",value:function(){this.notify("admidpoint")}},{key:"adThirdQuartile",value:function(){this.notify("adthirdquartile")}},{key:"adComplete",value:function(){this.currentAd=null,this.notify("adcomplete")}},{key:"adBreakComplete",value:function(){var t,e;if(this.currentBreak=null,this.currentAd=null,this.isPreloading=!1,null==(t=this.domProxy)||t.showAdContainer(!1),null==(e=this.domProxy)||e.showAdClickElement(!1),this.presoModel.isCurrentVideoAd=!1,this.notify("adbreakcomplete"),this.pendingSeekTime&&this.contentStartReleased){var n=this.pendingSeekTime;this.pendingSeekTime=null,this.contentPlaybackStateProxy.model.started&&this.notify("seekredirectcomplete"),this.seekVideo(n)}}},{key:"adClicked",value:function(){var t,e;"playing"===(null==(e=null==(t=this.contentPlaybackStateProxy)?void 0:t.model)?void 0:e.state)&&this.pause(),this.notify("ad-click")}},{key:"adError",value:function(t){this.currentAd=null,t.message||(t.message=ee.messages.UNSPECIFIED_ERROR),this.notify("aderror",t)}},{key:"adPaused",value:function(){this.respondToPlaybackStateChange("paused"),this.notify("adpaused")}},{key:"adResumed",value:function(){this.notify("resourcebuffering",{buffering:!1}),this.respondToPlaybackStateChange("playing"),this.notify("adplaying")}},{key:"adStalled",value:function(){this.notify("adstalled")}},{key:"adBreakDiscarded",value:function(){this.notify("adbreakdiscarded")}},{key:"adSkipped",value:function(){this.notify("adskipped")}},{key:"allAdsComplete",value:function(){this.hasMidRolls=!1}},{key:"adBuffering",value:function(t){}},{key:"displayAdClickElement",value:function(t){var e;null==(e=this.domProxy)||e.showAdClickElement(t)}},{key:"resumeContentPlayComplete",value:function(){this.pendingSeekTime&&this.contentStartReleased&&(this.notify("seekredirectcomplete"),this.seekVideo(this.pendingSeekTime),this.pendingSeekTime=null),this.play()}},{key:"isFullScreenAd",value:function(){return this.presoModel.isFullscreen&&this.adInProgress}},{key:"monitorActivity",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(we.isDesktop){var i=n?"addEventListener":"removeEventListener";null==(e=null==(t=this.domProxy)?void 0:t.getMain())||e[i]("mousemove",this.hMovement)}}},{key:"handleNotification",value:function(t){var e=t.name,i=t.body,r=!1;if("fullscreenchange"===e)this.adAdapter.setFullscreenState(i.fullscreen),r=!0;(0,B.default)((0,W.default)(n.prototype),"handleNotification",this).call(this,t),r&&this.monitorActivity(i.fullscreen)}},{key:"updateSize",value:function(){var t,e=null==(t=this.domProxy)?void 0:t.getPresentationRect();e&&this.adAdapter.updateSize(e)}},{key:"respondToSizeChange",value:function(){this.updateSize()}},{key:"respondToId3Data",value:function(t){t.info&&(t.msg=t.info),this.adAdapter.handleTimedMetadata(t),(0,B.default)((0,W.default)(n.prototype),"respondToId3Data",this).call(this,t)}},{key:"respondToVideoPaused",value:function(){(0,B.default)((0,W.default)(n.prototype),"respondToVideoPaused",this).call(this),this.adInProgress?this.notify("adpaused"):(this.respondToPlaybackStateChange("paused"),this.notify("contentpaused"))}},{key:"respondToPlaybackStateChange",value:function(t){this.isPreloading&&"waiting"===t||(0,B.default)((0,W.default)(n.prototype),"respondToPlaybackStateChange",this).call(this,t)}},{key:"respondToVideoPlaying",value:function(){(0,B.default)((0,W.default)(n.prototype),"respondToVideoPlaying",this).call(this),this.adAdapterStarted||(this.adAdapterStarted=!0,this.adAdapter.start()),this.contentPlaybackStateProxy.model.time>.5&&(this.adInProgress?this.notify("adplaying"):this.contentSegmentStarted&&(this.respondToPlaybackStateChange("playing"),this.notify("contentplaying")))}},{key:"respondToVideoTimeUpdate",value:function(t){var e,i,r,u,a,o=this.contentPlaybackStateProxy.model;this.presoModel.streamTime=t,null==(e=this.adAdapter)||e.setStreamTime(t),o.time=(null==(i=this.adAdapter)?void 0:i.contentTimeForStreamTime)?null==(r=this.adAdapter)?void 0:r.contentTimeForStreamTime(t):t,this.adInProgress||(t>.75&&!this.contentSegmentStarted&&(o.started=!0,null==(u=this.domProxy)||u.showAdClickElement(!1),null==(a=this.domProxy)||a.showAdContainer(!1),!this.contentStartReleased&&this.signalContentStart(),this.contentSegmentStarted=!0,this.hasMidRolls||"LIVE"===o.streamType||"DVR"===o.streamType?this.notify("contentsegmentstart"):this.notify("contentplaying")),this.contentSegmentStarted&&(0,B.default)((0,W.default)(n.prototype),"respondToVideoTimeUpdate",this).call(this,t),"LIVE"!==o.streamType&&o.time>=o.duration&&!this.contentCompleteReleased&&this.signalContentComplete())}},{key:"endContentSegment",value:function(){this.contentSegmentStarted&&(this.contentSegmentStarted=!1,this.notify("contentsegmentend"))}},{key:"respondToVideoEnd",value:function(){this.contentComplete=!0,this.contentCompleteReleased||this.signalContentComplete(),this.presoComplete=!0,(0,B.default)((0,W.default)(n.prototype),"respondToVideoEnd",this).call(this)}},{key:"respondToDurationChange",value:function(t){var e,n;if(t&&!isNaN(t)&&t>0){this.adAdapter.setStreamDuration(t),this.presoModel.streamDuration=t;var i=(null==(n=(e=this.adAdapter).contentTimeForStreamTime)?void 0:n.call(e,t))||t;this.contentPlaybackStateProxy.model.duration=i,this.contentDurationReleased||this.releaseContentDuration(t)}}},{key:"respondToError",value:function(t){this.fatalContentErrorReceived=t.fatal,(0,B.default)((0,W.default)(n.prototype),"respondToError",this).call(this,t)}},{key:"isContentComplete",value:function(){return this.presoComplete}},{key:"startContentSegment",value:function(){var t;this.contentSegmentStarted=!0,this.contentPlaybackStateProxy.model.started=!0,null==(t=this.domProxy)||t.showAdContainer(!1),this.contentStartReleased||(this.contentStartReleased=!0,this.notify("contentstart")),this.notify("contentsegmentstart")}},{key:"checkPreload",value:function(t,e){var n,i,r,u,a,o,s=!0===(null==(u=null==(r=null==(i=null==(n=this.resourceProxy)?void 0:n.resource)?void 0:i.ad)?void 0:r.csai)?void 0:u.preloadContentAtEndOfPreRoll);if(s){var l=(null==(a=this.currentAd)?void 0:a.adPosition)===(null==(o=this.currentBreak)?void 0:o.adTotal);if(s&&l&&!this.system.isIos){var c=Et.clampValue(Math.ceil(e/4),2,10);Math.round(t)>=c&&(this.isPreloading=!0,this.load().catch(this.onLoadError))}}}},{key:"signalContentStart",value:function(){this.contentStartReleased=!0,this.notify("contentstart")}},{key:"signalContentComplete",value:function(){this.contentCompleteReleased=!0,this.contentSegmentStarted&&this.notify("contentsegmentend"),this.notify("contentcomplete")}},{key:"listNotificationInterests",value:function(){return(0,B.default)((0,W.default)(n.prototype),"listNotificationInterests",this).call(this).concat(["fullscreenchange","presentationsizechange"])}},{key:"onRegister",value:function(){var t,e;(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this);var i=this.facade.retrieveProxy("ActivityProxy").idleDelay;this.pointerLockDebouncer=Et.debounce(this.setPointerState,i),null==(t=this.domProxy)||t.showAdContainer(!1),null==(e=this.domProxy)||e.showAdClickElement(!1)}}]),n}(ji);At([Ln()],zi.prototype,"pauseContent",1),At([Ln()],zi.prototype,"resumeContent",1),At([Ln()],zi.prototype,"streamIdAvailable",1),At([Ln()],zi.prototype,"applyHook",1),At([Ln()],zi.prototype,"adSegmentStarted",1),At([Ln()],zi.prototype,"adSegmentEnded",1),At([Ln()],zi.prototype,"adBreaksAvailable",1),At([Ln()],zi.prototype,"seekToStreamTime",1),At([Ln()],zi.prototype,"adBreakStart",1),At([Ln()],zi.prototype,"adBreakMetadata",1),At([Ln()],zi.prototype,"adLoaded",1),At([Ln()],zi.prototype,"adStart",1),At([Ln()],zi.prototype,"adProgress",1),At([Ln()],zi.prototype,"adFirstQuartile",1),At([Ln()],zi.prototype,"adMidpoint",1),At([Ln()],zi.prototype,"adThirdQuartile",1),At([Ln()],zi.prototype,"adComplete",1),At([Ln()],zi.prototype,"adBreakComplete",1),At([Ln()],zi.prototype,"adClicked",1),At([Ln()],zi.prototype,"adError",1),At([Ln()],zi.prototype,"adPaused",1),At([Ln()],zi.prototype,"adResumed",1),At([Ln()],zi.prototype,"adStalled",1),At([Ln()],zi.prototype,"adBreakDiscarded",1),At([Ln()],zi.prototype,"adSkipped",1),At([Ln()],zi.prototype,"allAdsComplete",1),At([Ln()],zi.prototype,"adBuffering",1),At([Ln()],zi.prototype,"displayAdClickElement",1);var Wi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"start",value:function(){this.isClickToPlay?this.setForClickToPlay():this.notify("videoLoadStart")}},{key:"respondToVideoPlaying",value:function(){var t=!1;this.contentPlaybackStateProxy.model.started=!0,this.presoModel.started||(this.presoModel.started=!0,this.started=!0,t=!0),(0,B.default)((0,W.default)(n.prototype),"respondToVideoPlaying",this).call(this),t&&this.notify("contentstart"),this.notify("contentplaying")}},{key:"respondToVideoTimeUpdate",value:function(t){if(!this.contentComplete){var e=this.contentPlaybackStateProxy.model;this.presoModel.started&&(this.presoModel.streamTime=t,e.time=t,(0,B.default)((0,W.default)(n.prototype),"respondToVideoTimeUpdate",this).call(this,t))}}},{key:"respondToVideoPaused",value:function(){(0,B.default)((0,W.default)(n.prototype),"respondToVideoPaused",this).call(this),this.notify("contentpaused")}},{key:"respondToIsPlayingLiveChange",value:function(t){(0,B.default)((0,W.default)(n.prototype),"respondToIsPlayingLiveChange",this).call(this,t)}},{key:"respondToVideoEnd",value:function(){this.contentComplete=!0,this.notify("contentcomplete"),(0,B.default)((0,W.default)(n.prototype),"respondToVideoEnd",this).call(this)}},{key:"respondToDurationChange",value:function(t){this.presoModel.streamDuration=t,this.contentPlaybackStateProxy.model.duration=t,this.contentDurationReleased||this.releaseContentDuration(t)}},{key:"onRegister",value:function(){(0,B.default)((0,W.default)(n.prototype),"onRegister",this).call(this),this.domProxy&&this.domProxy.showAdContainer(!1),!this.isClickToPlay&&this.prepareForPlayback()}}]),n}(ji),Hi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e,n=this,i=this.system,r=t.body;if(null==(e=i.global)?void 0:e.document){var u=this.getModel("PresentationState"),a=this.getModel("PlayerOptions");this.facade.registerProxy(new Fi("ContentPlaybackStateProxy")),this.checkAutoplay(a).then((function(t){n.processAutoplaySupport(t,u,a),n.createPresentation(r,u,a)}))}else this.sendNotification("videostarterror",{error:ee.messages.ENVIRONMENT_NOT_SUPPORTED,fatal:!0})}},{key:"createPresentation",value:function(t,e,n){return kt(this,null,D.default.mark((function i(){var r;return D.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getPresentationMediator(t,e,n);case 2:if(r=i.sent){i.next=5;break}return i.abrupt("return");case 5:this.facade.registerMediator(r),this.sendNotification("startPresentation");case 7:case"end":return i.stop()}}),i,this)})))}},{key:"getPresentationMediator",value:function(t,e,n){return kt(this,null,D.default.mark((function i(){var r,u,a,o,s,l,c,h,f,v,d,y,A;return D.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=this.facade.retrieveProxy("PlayerDomProxy"),s=this.getVideo(o,n),l="PresentationMediator",c=(null==(r=null==t?void 0:t.ad)?void 0:r.csai)||(null==(u=null==t?void 0:t.ad)?void 0:u.ssai),h=null,null!==s){i.next=8;break}return this.sendNotification("resourceerror",{code:"9999",message:ee.messages.VIDEO_PLAYBACK_UNAVAILABLE,fatal:!0}),i.abrupt("return",h);case 8:if((c||e.isAutoplay||n.playsInline)&&(null==o||o.setVideoAttribute("playsinline","")),!c){i.next=30;break}return i.prev=10,f=new zi(l,s),v=f.getDelegate(),d=this.facade.retrieveProxy("AdapterProxy"),i.next=16,d.createAdapter("ad",t,(function(){return v}));case 16:return y=i.sent,f.adAdapter=y,i.next=20,null==(a=y.getResource)?void 0:a.call(y);case 20:(A=i.sent)&&(t=A),h=f,i.next=28;break;case 25:i.prev=25,i.t0=i.catch(10),this.sendNotification("aderror",{code:i.t0.code||"4400",message:i.t0.message,cause:i.t0,fatal:!0});case 28:i.next=31;break;case 30:h=new Wi(l,s);case 31:return this.createResourceProxy(t),i.abrupt("return",h);case 33:case"end":return i.stop()}}),i,this,[[10,25]])})))}},{key:"createResourceProxy",value:function(t){var e=new Ui("ResourceProxy",t);this.facade.registerProxy(e)}},{key:"getVideo",value:function(t,e){var n,i=this.system;return i.isWebMaf?i.webMafPlayer:t?(!0!==(null==(n=e.overrides)?void 0:n.reuseVideoElement)&&t.recreateVideo(),t.getVideo()):null}},{key:"processAutoplaySupport",value:function(t,e,n){if(!e.isAutoplay){var i=n.autoplay,r=t.supportsMutedAutoplay,u=t.supportsUnmutedAutoplay;(("attemptMuted"===i||"attemptUnmutedThenMuted"===i)&&!r||"attemptUnmuted"===i&&!u)&&this.sendNotification("autoplayblocked",new Error("Autoplay capability conflict."),"internal"),e.isMuteAtPlayStart="attemptMuted"===i&&r||"attemptUnmutedThenMuted"===i&&!u&&r,e.isAutoplay=this.shouldAutoplay(i,t)}}},{key:"shouldAutoplay",value:function(t,e){if(Et.isEmpty(t)||"none"===t)return!1;var n=e.supportsMutedAutoplay,i=e.supportsUnmutedAutoplay,r="attemptUnmuted"===t&&i;return"attemptMuted"===t&&n||r||!r&&"attemptUnmutedThenMuted"===t&&n}},{key:"checkAutoplay",value:function(t){var e;return this.getService("AutoplayCapabilities").detectCapabilities(null==(e=t.overrides)?void 0:e.blankVideoUrl)}}]),n}(zn),Qi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this;t.body.resource?this.getProxy("HookProxy").applyHook("attachresource",new Mn(t.body.resource)).then((function(t){try{Mn.validate(t)}catch(t){e.invalidResource(t.message)}t.sessionId||(t.sessionId=Et.uuid()),t.cmcd.sessionId||(t.cmcd.sessionId=t.sessionId),t.contentId&&!t.cmcd.contentId&&(t.cmcd.contentId=t.contentId),e.facade.sendNotification("playResource",t,"internal")})).catch((function(t){e.facade.sendNotification("resourceerror",t.cause,"internal")})):this.invalidResource(ee.messages.RESOURCE_MISSING)}},{key:"invalidResource",value:function(t){this.facade.sendNotification("resourceerror",{message:"".concat(ee.messages.INVALID_RESOURCE,": ").concat(t),code:"1000",fatal:!0},"internal")}}]),n}(zn),_i=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e,n,i=this.facade;switch(t.name){case"resourceComplete":if(!1===(null==(e=this.getModel("PlayerOptions").overrides)?void 0:e.closeOnEnded))return;var r=i.retrieveMediator("PresentationMediator");return void(null==r||r.close());case"resourceend":i.retrieveMediator("TimerMediator").killTimer(),this.sendNotification("killResourcePresentation",null,"internal");break;case"resourcebuffering":var u=i.retrieveProxy("PlayerDomProxy"),a=null==u?void 0:u.getMain();null==a||a.setAttribute("aria-busy",t.body.buffering.toString());break;case"adbreakstart":var o=i.retrieveMediator("PresentationMediator");null==(n=null==o?void 0:o.adapter)||n.clearText()}}}]),n}(zn),qi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.facade.retrieveProxy("PlayerDomProxy");if(e){var n=e.getMain();n.setAttribute("role","region");var i=n.getAttribute("tabindex")||"0";n.setAttribute("tabindex",i)}}}]),n}(zn),Ki=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.getModel("PresentationState"),n=this.facade.retrieveMediator("PresentationMediator");e.suspended=!1,n.resume();var i=this.getProxy("ContentPlaybackStateProxy");this.sendNotification("playbackresumed",{contentTime:i.model.time})}}]),n}(zn),Gi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.facade.retrieveMediator("PresentationMediator"),n=this.facade.retrieveProxy("ResourceProxy");this.sendNotification("resourcestart",{resource:n.resource}),e.start()}}]),n}(zn),Xi=function(t){(0,j.default)(n,t);var e=G(n);function n(){return(0,_.default)(this,n),e.apply(this,arguments)}return(0,Q.default)(n,[{key:"execute",value:function(t){var e=this.getModel("PresentationState");this.facade.retrieveMediator("PresentationMediator").suspend(),e.suspended=!0;var n=this.getProxy("ContentPlaybackStateProxy");this.sendNotification("playbacksuspended",{contentTime:n.model.time})}}]),n}(zn),$i=(R={},(0,K.default)(R,"default",null),(0,K.default)(R,"bootApp",Ii),(0,K.default)(R,"ready",qi),(0,K.default)(R,"mutechange",Li),(0,K.default)(R,"volumechange",Li),(0,K.default)(R,"resourceend",_i),(0,K.default)(R,"resourcebuffering",_i),(0,K.default)(R,"adbreakstart",_i),(0,K.default)(R,"resourceComplete",_i),(0,K.default)(R,"playOnUSerGesture",Li),(0,K.default)(R,"play",Li),(0,K.default)(R,"pause",Li),(0,K.default)(R,"stop",Li),(0,K.default)(R,"seek",Li),(0,K.default)(R,"seekForward",Li),(0,K.default)(R,"seekBack",Li),(0,K.default)(R,"seekToLive",Li),(0,K.default)(R,"switchAudioTrack",Li),(0,K.default)(R,"switchTextTrack",Li),(0,K.default)(R,"switchTextMode",Li),(0,K.default)(R,"suspendPlayback",Xi),(0,K.default)(R,"resumePlayback",Ki),(0,K.default)(R,"switchBitrate",Wn),(0,K.default)(R,"switchQualityCategory",Wn),(0,K.default)(R,"autoQualitySwitching",Wn),(0,K.default)(R,"minBitrate",Wn),(0,K.default)(R,"maxBitrate",Wn),(0,K.default)(R,"prepResourceCollection",Qi),(0,K.default)(R,"startPresentation",Gi),(0,K.default)(R,"playResource",Hi),(0,K.default)(R,"killResourcePresentation",Oi),(0,K.default)(R,"changeLanguage",Di),(0,K.default)(R,"videostarterror",Ri),(0,K.default)(R,"videoplaybackerror",Ri),(0,K.default)(R,"resourceerror",Ri),(0,K.default)(R,"aderror",Ri),(0,K.default)(R,"adstalled",Ri),R),Zi=function(t){(0,j.default)(n,t);var e=G(n);function n(t){var i;return(0,_.default)(this,n),(i=e.call(this,Object.assign({commandMap:$i,id:t.playerOptions.id||null},t))).pIsReady=!1,i.api=Un({},(0,F.default)(i)),i.target=i.api,i.init(),i}return(0,Q.default)(n,[{key:"initialize",value:function(){var t=this,e=this.modelCollectionProxy.getModel("PlayerOptions"),n=e.plugins||[],i=this.getApi(),r={name:"changeLanguage",body:{value:e.language},type:"internal"};return i.registerPlugins(n).then((function(){return t.localization.registerLocalizationData(e.localization),t.sendAsyncNotification(r,["languagechange"])})).then((function(){return t.pIsReady=!0,t.sendNotification("ready",i),i})).catch((function(t){throw Rt.error(t),t}))}},{key:"destroy",value:function(){var t=this,e=(0,B.default)((0,W.default)(n.prototype),"destroy",this).bind(this);return this.killCurrentResource().then((function(){t.apiAccessors=null,t.apiMethods=null,e()})).catch((function(t){throw Rt.error(t),t}))}},{key:"getApi",value:function(){return this.api}},{key:"killCurrentResource",value:function(){return this.appMediator.killCurrentResource()}},{key:"hasListenerFor",value:function(t){return(0,B.default)((0,W.default)(n.prototype),"hasListenerFor",this).call(this,t)}},{key:"on",value:function(t,e){(0,B.default)((0,W.default)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,B.default)((0,W.default)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,B.default)((0,W.default)(n.prototype),"off",this).call(this,t,e)}},{key:"isReady",get:function(){return this.pIsReady}},{key:"id",get:function(){return this.appId}},{key:"dimensions",get:function(){return this.appMediator.getDimensions()}},{key:"video",get:function(){var t;return null==(t=this.dom)?void 0:t.getVideo()}},{key:"isAutoplay",get:function(){return this.presentationState.isAutoplay}},{key:"isFullscreen",get:function(){return this.presentationState.isFullscreen}},{key:"isAd",get:function(){return this.presentationState.isCurrentVideoAd}},{key:"muted",get:function(){return this.appMediator.getMuteState()},set:function(t){this.transmitExtRequest("mutechange",{muted:t})}},{key:"volume",get:function(){return this.appMediator.getVolume()},set:function(t){this.transmitExtRequest("volumechange",{volume:t})}},{key:"language",get:function(){return this.localization.language},set:function(t){this.transmitExtRequest("changeLanguage",{language:t})}},{key:"contentTime",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.time:0}},{key:"contentDuration",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.duration:NaN}},{key:"streamTime",get:function(){return this.presentationState.streamTime}},{key:"streamDuration",get:function(){return this.presentationState.streamDuration}},{key:"playbackState",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.state:"idle"}},{key:"autoQualitySwitching",get:function(){return!!this.contentPlaybackStateProxy&&"auto"===this.contentPlaybackStateProxy.qualitySwitchingMode},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("autoQualitySwitching",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"qualityInfo",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.qualityInfo:null}},{key:"bitrate",get:function(){var t=this.qualityInfo.quality||{bitrate:NaN};return null!=t.bitrate?t.bitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("switchBitrate",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"qualityCategory",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.userQualityCategory:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("switchQualityCategory",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"minBitrate",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.minBitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("minBitrate",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"maxBitrate",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.maxBitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("maxBitrate",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"audioTrackInfo",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks:null}},{key:"audioTrack",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks.track:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("switchAudioTrack",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"attachResource",value:function(t){var e=this;return this.stop().then((function(){return e.sendAsyncNotification({name:"prepResourceCollection",body:{resource:t,start:!0}},["resourcestart"])})).then((function(){return e.resource})).catch((function(t){throw t.detail.error}))}},{key:"resource",get:function(){return this.appMediator.getCurrentResource()}},{key:"textTrackEnabled",get:function(){return this.facade.retrieveProxy("TextTrackProxy").enabled},set:function(t){this.transmitExtRequest("switchTextMode",{value:t})}},{key:"textTrack",get:function(){return this.textTrackInfo?this.textTrackInfo.track:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest("switchTextTrack",{value:t}):this.log(ee.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}},{key:"textTrackInfo",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.textTrackInfo:null}},{key:"streamType",get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.streamType:null}},{key:"isPlayingLive",get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return!0===(null==t?void 0:t.isPlayingLive)}},{key:"liveStreamUtcStart",get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteStart:NaN}},{key:"liveStreamUtcTime",get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteTime:NaN}},{key:"liveStreamUtcDuration",get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteDuration:NaN}},{key:"isSuspended",get:function(){return this.appMediator.isPlaybackSuspended()}},{key:"fullscreenElement",get:function(){return this.appMediator.getFullscreenElement()},set:function(t){this.appMediator.setFullscreenElement(t)}},{key:"pausable",get:function(){var t,e=!1!==(null==(t=this.opts.playerOptions.overrides)?void 0:t.liveStreamPausable);return e||"LIVE"!==this.streamType}},{key:"enterFullscreen",value:function(){this.transmitExtRequest("enterFullscreenRequest")}},{key:"exitFullscreen",value:function(){this.transmitExtRequest("exitFullscreenRequest")}},{key:"play",value:function(){this.recordMetric("api","play"),this.appMediator.isPlaybackSuspended()&&this.transmitExtRequest("resumePlayback");return this.sendAsyncNotification({name:"play",type:"external"},["contentplaying","adplaying"])}},{key:"pause",value:function(){if(this.recordMetric("api","pause"),this.pausable){return this.sendAsyncNotification({name:"pause",type:"external"},["contentpaused","adpaused"])}return this.log(ee.messages.PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED),this.stop()}},{key:"togglePlayPause",value:function(){return"playing"===this.playbackState?this.pause():this.play()}},{key:"seek",value:function(t){var e=this.appMediator.validateSeek(t,this.contentDuration);if(null==e)return Promise.resolve();this.recordMetric("api","seek",t);var n={name:"seek",body:{value:e},type:"external"};return this.sendAsyncNotification(n,["seekcomplete"])}},{key:"getAdBreakTimes",value:function(){return this.appMediator.getAdBreakTimes()||[]}},{key:"grabFrame",value:function(){return this.appMediator.grabFrame()}},{key:"getThumbnail",value:function(t){var e;return null==(e=this.contentPlaybackStateProxy)?void 0:e.getThumbnail(t)}},{key:"getContainerRect",value:function(){return this.appMediator.getContainerRect()}},{key:"registerPlugins",value:function(t,e){var n=this;return new Promise((function(i,r){n.transmitExtRequest("loadPlugins",{plugins:t,callback:function(){"function"==typeof e&&e(),i()}})}))}},{key:"removePlugin",value:function(t){this.transmitExtRequest("removePlugin",{name:t})}},{key:"registerAdapter",value:function(t){return this.adapters.registerAdapter(t)}},{key:"retrieveAdapter",value:function(t){return this.adapters.retrieveAdapter(t)}},{key:"removeAdapter",value:function(t){return this.adapters.removeAdapter(t)}},{key:"registerHook",value:function(t,e){return this.hooks.registerHook(t,e)}},{key:"removeHook",value:function(t,e){return this.hooks.removeHook(t,e)}},{key:"getPlugin",value:function(t){return this.appMediator.getPlugin(t)}},{key:"getAdapter",value:function(t){var e=this.presentationMediator;if(!e)return null;switch(t){case"ad":return e.adAdapter||null;case"playback":return e.adapter||null;default:return null}}},{key:"stop",value:function(){var t;if(!(null==(t=this.contentPlaybackStateProxy)?void 0:t.model)||!this.presentationMediator)return Promise.resolve();return this.sendAsyncNotification({name:"stop",type:"external"},["resourceend"])}},{key:"goLive",value:function(){this.streamType&&"VOD"!==this.streamType&&(this.recordMetric("api","go_live"),this.transmitExtRequest("seekToLive"))}},{key:"skipAd",value:function(){this.appMediator.skipAd()}},{key:"focus",value:function(t){var e=this.dom.getMain();e&&e.focus(t)}},{key:"blur",value:function(){var t=this.dom.getMain();t&&t.blur()}},{key:"getConfigAsJson",value:function(t){return this.appMediator.getConfigAsJson(t)}},{key:"suspendPlayback",value:function(){var t=this;this.appMediator.isPlaybackSuspended()||this.pause().then((function(){t.transmitExtRequest("suspendPlayback")}))}},{key:"resumePlayback",value:function(){this.appMediator.isPlaybackSuspended()&&this.transmitExtRequest("resumePlayback")}},{key:"recordMetric",value:function(t,e,n){this.sendNotification("metric",{metric:new Be(e,n,t)})}},{key:"offsetTimedText",value:function(t){this.appMediator.offsetTimedText(t)}},{key:"primeVideoElement",value:function(){return this.appMediator.primeVideoElement()}},{key:"sendEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit(t,e)}},{key:"contentPlaybackStateProxy",get:function(){return this.facade.retrieveProxy("ContentPlaybackStateProxy")}},{key:"contentPlaybackStateReady",get:function(){var t;return(null==(t=this.contentPlaybackStateProxy)?void 0:t.isReady)||!1}},{key:"localization",get:function(){return this.facade.retrieveProxy("LocalizationProxy")}},{key:"dom",get:function(){return this.facade.retrieveProxy("PlayerDomProxy")}},{key:"adapters",get:function(){return this.facade.retrieveProxy("AdapterProxy")}},{key:"presentationState",get:function(){return this.modelCollectionProxy.getModel("PresentationState")}},{key:"presentationMediator",get:function(){return this.facade.retrieveMediator("PresentationMediator")}},{key:"hooks",get:function(){return this.facade.retrieveProxy("HookProxy")}},{key:"transmitExtRequest",value:function(t,e){this.sendNotification(t,e,"external")}},{key:"log",value:function(t,e){var n=e||"debug";this.facade.log(n,t)}},{key:"init",value:function(){this.facade.registerProxy(new Rn("HookProxy"));var t=this.opts.globalServices,e=this.opts.playerOptions.logLevel?this.opts.playerOptions.logLevel:"off";this.createLoggingService(e),this.facade.log("info","".concat(je.playerName,"@").concat(je.playerVersion,"  ").concat(je.buildTime)),this.registerGlobalServices(t),delete this.opts.globalServices,this.sendNotification("bootApp",{playerOptions:this.opts.playerOptions||null,app:this},"internal")}},{key:"sendAsyncNotification",value:function(t,e){var n=Et.eventsToPromise([{target:this,events:e}],[{target:this,events:["error"]}]);return this.sendNotification(t.name,t.body,t.type),n}}]),n}(Dn);At([Ln()],Zi.prototype,"hasListenerFor",1),At([Ln()],Zi.prototype,"on",1),At([Ln()],Zi.prototype,"once",1),At([Ln()],Zi.prototype,"off",1),At([Fn()],Zi.prototype,"isReady",1),At([Fn()],Zi.prototype,"id",1),At([Fn()],Zi.prototype,"dimensions",1),At([Fn()],Zi.prototype,"video",1),At([Fn()],Zi.prototype,"isAutoplay",1),At([Fn()],Zi.prototype,"isFullscreen",1),At([Fn()],Zi.prototype,"isAd",1),At([Fn()],Zi.prototype,"muted",1),At([Fn()],Zi.prototype,"volume",1),At([Fn()],Zi.prototype,"language",1),At([Fn()],Zi.prototype,"contentTime",1),At([Fn()],Zi.prototype,"contentDuration",1),At([Fn()],Zi.prototype,"streamTime",1),At([Fn()],Zi.prototype,"streamDuration",1),At([Fn()],Zi.prototype,"playbackState",1),At([Fn()],Zi.prototype,"autoQualitySwitching",1),At([Fn()],Zi.prototype,"qualityInfo",1),At([Fn()],Zi.prototype,"bitrate",1),At([Fn()],Zi.prototype,"qualityCategory",1),At([Fn()],Zi.prototype,"minBitrate",1),At([Fn()],Zi.prototype,"maxBitrate",1),At([Fn()],Zi.prototype,"audioTrackInfo",1),At([Fn()],Zi.prototype,"audioTrack",1),At([Ln()],Zi.prototype,"attachResource",1),At([Fn()],Zi.prototype,"resource",1),At([Fn()],Zi.prototype,"textTrackEnabled",1),At([Fn()],Zi.prototype,"textTrack",1),At([Fn()],Zi.prototype,"textTrackInfo",1),At([Fn()],Zi.prototype,"streamType",1),At([Fn()],Zi.prototype,"isPlayingLive",1),At([Fn()],Zi.prototype,"liveStreamUtcStart",1),At([Fn()],Zi.prototype,"liveStreamUtcTime",1),At([Fn()],Zi.prototype,"liveStreamUtcDuration",1),At([Fn()],Zi.prototype,"isSuspended",1),At([Fn()],Zi.prototype,"fullscreenElement",1),At([Fn()],Zi.prototype,"pausable",1),At([Ln()],Zi.prototype,"enterFullscreen",1),At([Ln()],Zi.prototype,"exitFullscreen",1),At([Ln()],Zi.prototype,"play",1),At([Ln()],Zi.prototype,"pause",1),At([Ln()],Zi.prototype,"togglePlayPause",1),At([Ln()],Zi.prototype,"seek",1),At([Ln()],Zi.prototype,"getAdBreakTimes",1),At([Ln()],Zi.prototype,"grabFrame",1),At([Ln()],Zi.prototype,"getThumbnail",1),At([Ln()],Zi.prototype,"getContainerRect",1),At([Ln()],Zi.prototype,"registerPlugins",1),At([Ln()],Zi.prototype,"removePlugin",1),At([Ln()],Zi.prototype,"registerAdapter",1),At([Ln()],Zi.prototype,"retrieveAdapter",1),At([Ln()],Zi.prototype,"removeAdapter",1),At([Ln()],Zi.prototype,"registerHook",1),At([Ln()],Zi.prototype,"removeHook",1),At([Ln()],Zi.prototype,"getPlugin",1),At([Ln()],Zi.prototype,"getAdapter",1),At([Ln()],Zi.prototype,"stop",1),At([Ln()],Zi.prototype,"goLive",1),At([Ln()],Zi.prototype,"skipAd",1),At([Ln()],Zi.prototype,"focus",1),At([Ln()],Zi.prototype,"blur",1),At([Ln()],Zi.prototype,"getConfigAsJson",1),At([Ln()],Zi.prototype,"suspendPlayback",1),At([Ln()],Zi.prototype,"resumePlayback",1),At([Ln()],Zi.prototype,"recordMetric",1),At([Ln()],Zi.prototype,"offsetTimedText",1),At([Ln()],Zi.prototype,"primeVideoElement",1);var Yi=!1,Ji=null,tr=null,er=[],nr={},ir={};function rr(t){var e=t.options.container,n=!1;if((we.isWebMaf||null!=e&&void 0!==e&&(e.constructor===HTMLDivElement||"object"===(0,q.default)(e)&&"function"==typeof e.getBoundingClientRect||"string"==typeof e&&null!=document.querySelector(e)))&&(n=!0),!n){var i="Invalid player configuration: Missing presentation container.";Rt.error(i),t.callback(null,{message:i})}try{var r=new Zi({globalServices:tr,playerOptions:t.options});nr[r.appId]=r,r.initialize().then((function(e){return t.callback(e,null)})).catch((function(e){return t.callback(null,e)}))}catch(e){e.key&&(e.message='A player with id "'.concat(e.key,'" a already exists')),t.callback(null,e)}}function ur(){}function ar(t){return new Promise((function(e,n){var i=function(t,i){null!=i?n(i):e(t)};if(Yi)rr({options:t,callback:i});else if(er.push({options:t,callback:i}),null==Ji){Ji=!0;var r=Cn.getInstance(),u=t.overrides,a=!1!==(null==u?void 0:u.deferAutoplayDetection);Promise.all([!a&&r.detectCapabilities(null==u?void 0:u.blankVideoUrl)]).then((function(){tr=(0,K.default)({},"AutoplayCapabilities",r),Yi=!0,Ji=!1;for(var t=er.length,e=0;e<t;e++)rr(er[e]),er[e]=null;er=[]}))}}))}function or(t){var e=nr[t];if(e)return Promise.resolve(e);var n=ir[t];if(n)return n.then((function(){return null}));var i=er.find((function(e){return e.options.id===t}));return i?new Promise((function(t,e){var n=i.callback;i.callback=function(i,r){n(i,r),r?e(r):t(i)}})):Promise.resolve(null)}function sr(t){var e=ir[t];if(e)return e;var n=nr[t];return n?(delete nr[t],ir[t]=n.destroy().then((function(){delete ir[t],Rt.log('[Avia] Player with id "'.concat(t,'" removed.'))}))):Promise.resolve()}function lr(t){return new Mn(t)}function cr(){return ct({},we)}function hr(t){return Cn.getInstance().detectCapabilities(t)}var fr,vr=(fr=ct({},Ot),et(fr,it({createVideoPlayer:ar,retrieveVideoPlayer:or,removeVideoPlayer:sr,createResourceConfig:lr,getSystemInfo:cr,getAutoplayCapabilities:hr})));return we.appNamespace=vr,yt(mt)}))},"m/vi":function(module,exports,__webpack_require__){"use strict";if(true){module.exports=__webpack_require__("4k2M")}else{}},nZL0:function(module,exports,__webpack_require__){},o8bV:function(module,exports,__webpack_require__){},od7R:function(module,exports,__webpack_require__){},"oj+s":function(module,__webpack_exports__,__webpack_require__){"use strict";var Utility_0=__webpack_require__("0C8Z");var PopCultureAnalytics=__webpack_require__("63rw");var ComscoreReporter=function(){var id=null;function initialize(config){id=config.comscore.identifier;window._comscore=window._comscore||[];window._comscore.push({c1:"2",c2:config.comscore.identifier});(function(){var s=document.createElement("script"),el=document.getElementsByTagName("script")[0];s.async=true;s.src=(document.location.protocol=="https:"?"https://sb":"http://b")+".scorecardresearch.com/beacon.js";el.parentNode.insertBefore(s,el)})()}function report(reportObj){}function pageView(data){if(typeof COMSCORE!="undefined"&&id!=null){COMSCORE.beacon({c1:"2",c2:id,c4:data.path})}}return{initialize:initialize,report:report,pageView:pageView}}();try{PopCultureAnalytics["a"].registerReporter("comscore",ComscoreReporter)}catch(err){Utility_0["a"].error(err)}var dom=__webpack_require__("fjrA");window.dataLayer=window.dataLayer||[];function gtag(){window.dataLayer.push(arguments)}const GoogleAnalyticsReporter=function(){const _logger=Utility_0["a"].loggers("Google Analytics Reporter");const _reports=[];function initialize(config){const{identifier:id}=config.ga;const gtagConfig={id:"google-analytics-gtag",url:"https://www.googletagmanager.com/gtag/js?id=".concat(id),attributes:{async:true}};Object(dom["c"])(gtagConfig);configureGTag(id)}function configureGTag(id){gtag("js",new Date);const pagePath=PopCultureAnalytics["a"].getPagePath();const dimensions={page_title:document.title,page_location:pagePath,transport_type:"beacon"};const ftag=PopCultureAnalytics["a"].getFTag();if(ftag){dimensions.ftag=ftag}if($cbc.Model!=="undefined"){if($cbc.Model.Author){dimensions.dimension1=$cbc.Model.Author;dimensions.dimension2=$cbc.Model.Author}if($cbc.Model.AuthorKey!=="undefined"){dimensions.dimension6=$cbc.Model.AuthorKey}}if($cbc.CurrentSite!=="undefined"){if($cbc.CurrentSite.PageType!=="undefined"&&$cbc.CurrentSite.PageSubType!=="undefined"){dimensions.dimension3=$cbc.CurrentSite.PageType+"_"+$cbc.CurrentSite.PageSubType}}const standaloneMediaMode="(display-mode: standalone)";if(navigator.standalone||window.matchMedia(standaloneMediaMode).matches){dimensions.dimension9="pwa"}gtag("config",id,{send_page_view:false,...dimensions});gtag("event","page_view",dimensions)}function report(reportObj){const{category:category=null,action:action=null}=reportObj;if(category==="exception"){reportException(reportObj)}else if(category&&action){const newReport={event_category:category,event_action:action,...typeof reportObj.label!=="undefined"&&{event_label:reportObj.label},...typeof reportObj.value!=="undefined"&&{event_value:reportObj.value},...typeof reportObj.nonInteraction!=="undefined"&&{non_interaction:reportObj.nonInteraction},...typeof reportObj.transport!=="undefined"&&{transport_type:reportObj.transport}};_reports.push(newReport);_logger.info("Sending event to Google Analytics",newReport);gtag("event",action,newReport)}else{_logger.warn("Category & Action required for reporting.")}}function reportException(_ref){let{category:category,description:description,fatal:fatal}=_ref;const exceptionEvent={event_category:category,event_action:"exception",event_label:description};_reports.push(exceptionEvent);_logger.info("Sending exception event to Google Analytics",exceptionEvent);gtag("event","exception",{description:description,fatal:fatal})}function pageView(_ref2){let{path:path,title:title,...custom}=_ref2;if(typeof gtag!=="undefined"){gtag("event","page_view",{page_location:path,page_title:title,...custom})}}function summary(){console.table(_reports)}return{initialize:initialize,report:report,summary:summary,pageView:pageView}};const reporter=GoogleAnalyticsReporter();try{PopCultureAnalytics["a"].registerReporter("ga",reporter)}catch(err){Utility_0["a"].error(err)}var QuantcastReporter=function(){function initialize(config){window._qevents=window._qevents||[];(function(){var elem=document.createElement("script");elem.src=(document.location.protocol==="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js";elem.async=true;elem.type="text/javascript";elem.onload=function(){__qc.async=function(){__qc.qpixelsent=[];_qevents.push({qacct:__qc.qopts.qacct});__qc.firepixels()}};var scpt=document.getElementsByTagName("script")[0];scpt.parentNode.insertBefore(elem,scpt)})();window._qevents.push({qacct:config.quantcast.identifier})}return{initialize:initialize,report:()=>{}}}();try{PopCultureAnalytics["a"].registerReporter("quantcast",QuantcastReporter)}catch(err){Utility_0["a"].error(err)}const ChartbeatReporter=function(){function getPageData(){let authors="";const sections=$cbc.CurrentSite.Name;const type=$cbc.CurrentSite.PageType+($cbc.CurrentSite.PageSubType!="unknown"?"_"+$cbc.CurrentSite.PageSubType:"");if($cbc.Model!=="undefined"){if($cbc.Model.Author){authors=$cbc.Model.Author}if($cbc.Model.AuthorKey){if(authors){authors+=","}authors+=$cbc.Model.AuthorKey}}return[authors,sections,type]}function renderScript(){const[authors,sections,type]=getPageData();const scriptConfig={id:"chartbeat",content:"\n(function() {\n        /** CONFIGURATION START **/\n        var _sf_async_config = window._sf_async_config = (window._sf_async_config || {});\n        _sf_async_config.uid = 65713;\n        _sf_async_config.domain = '".concat(document.location.host,"';\n        _sf_async_config.useCanonical = true;\n        _sf_async_config.useCanonicalDomain = true;\n        _sf_async_config.sections = '").concat(sections,"';\n        _sf_async_config.authors = '").concat(authors,"';\n        _sf_async_config.type = '").concat(type,"';\n        /** CONFIGURATION END **/\n        function loadChartbeat() {\n            var e = document.createElement('script');\n            var n = document.getElementsByTagName('script')[0];\n            e.type = 'text/javascript';\n            e.async = true;\n            e.src = '//static.chartbeat.com/js/chartbeat.js';\n            n.parentNode.insertBefore(e, n);\n        }\n        loadChartbeat();\n     })();\n            ")};Utility_0["a"].renderScript(scriptConfig)}function initialize(){renderScript()}function report(reportObj){}function pageView(_ref){let{path:path,title:title,...custom}=_ref;if(path.indexOf("#")>0){return}const[authors,sections,type]=getPageData();pSUPERFLY.virtualPage({sections:sections,authors:authors,path:path,title:title})}return{initialize:initialize,report:report,pageView:pageView}};const ChartbeatReporter_reporter=ChartbeatReporter();try{PopCultureAnalytics["a"].registerReporter("chartbeat",ChartbeatReporter_reporter)}catch(err){Utility_0["a"].error(err)}var OneByAOLHandler=__webpack_require__("PsFE");var consent=__webpack_require__("atHw");var init=__webpack_exports__["a"]=Utility=>{const config=window.popCultureAnalyticsConfig||{};const aolHandler=Object(OneByAOLHandler["a"])(PopCultureAnalytics["a"],Utility);PopCultureAnalytics["a"].registerHandler("oneByAOL",aolHandler);Object(consent["a"])("performance").then(()=>{PopCultureAnalytics["a"].initialize(config)})};const setPlayer=player=>{PopCultureAnalytics["a"].handlers.oneByAOL.setPlayer(player)};window.setPlayer=setPlayer},ppXi:function(module,exports,__webpack_require__){},s4Oi:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return initInContentVideoPlayer}));__webpack_require__.d(__webpack_exports__,"a",(function(){return initFeedPageEmbedVideoPlayer}));__webpack_require__.d(__webpack_exports__,"c",(function(){return initVideoPlayer}));var merge=__webpack_require__("2FGo");var merge_default=__webpack_require__.n(merge);var react=__webpack_require__("r0ML");var react_default=__webpack_require__.n(react);var react_dom=__webpack_require__("+Q0i");var react_dom_default=__webpack_require__.n(react_dom);var avia_min=__webpack_require__("loKd");var avia_gam_min=__webpack_require__("6rbJ");var avia_playlist_min=__webpack_require__("VT9Y");var avia_ui_esm=__webpack_require__("Jrfb");const VIDEO_PLACEHOLDER_SELECTOR=".embedVideoContainer[data-video-id]:not(.loaded)";const LEGACY_VIDEO_PLACEHOLDER_SELECTOR=".embedVideoContainer.js-videoEmbed";const VIDEO_PLAYER_MESSENGER_ID="AVIA-VIDEO-EMBED";const VIDEO_PLAYER_HOST_MESSENGER_ID="AVIA-VIDEO-HOST";const VIDEO_PLAYER_MESSAGES={ABORT:"abort",REQUEST_CONFIG:"request-config",SEND_CONFIG:"send-config",CONFIG_READY:"config-ready",PLAYER_CREATED:"player-created",PLAYER_EVENT:"player-event",PLAYER_READY:"player-ready",ERROR:"error"};const VIDEO_PLAYER_ABORT_REASONS={LOCATION_CONFIG_INVALID:{name:"LOCATION_CONFIG_INVALID",message:"Unable to extract video config from location"}};const AVIA_PLAYER_ID="161516321122021185";const getEmbedTargetOrigin=()=>"https://".concat(window.$cbc.CurrentSite.VideoDomain);const getHostTargetOrigin=()=>"https://".concat(window.$cbc.CurrentSite.ParentDomain);var content=__webpack_require__("16S2");class BidBarrelService{constructor(){this.isInitialized=false}async waitForBidBarrel(){let count=0;while(window.BidBarrel===undefined){if(count>=40)break;count++;await new Promise(resolve=>setTimeout(resolve,250))}if(window.BidBarrel){this.isInitialized=true}}async requestVideoAdCustomParams(){if(!this.isInitialized){await this.waitForBidBarrel()}return{}}getBidBarrelParams(){var _window$bbCustomParam,_window;return(_window$bbCustomParam=(_window=window)===null||_window===void 0?void 0:_window.bbCustomParams)!==null&&_window$bbCustomParam!==void 0?_window$bbCustomParam:{}}}var utils_dom=__webpack_require__("fjrA");class TealiumService_TealiumService{constructor(){let config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.config={};this.embedded=false;this.config=config;if(window.self!==window.top){this.embedded=true}}initialize(){if(this.embedded){this.initializeEmbeddedTealium()}this.renderTealiumTag()}createTealiumDataOverrides(isAvia){var _window$$cbc$Video$au,_window$$cbc,_window$$cbc$Video;const property=Object(content["a"])(true);const siteCode=property.replace(/.com$/,"");const parentPath=window.$cbc.CurrentSite.parentURL;const parentFullUrl="https://".concat(property).concat(parentPath);const pageName="".concat(siteCode,":").concat(parentPath);const pageWidth=Object(utils_dom["b"])();const isDesktop=pageWidth>=900;const siteType="responsive web|||".concat(isDesktop?"desktop":"mobile");const brandPlatformId="".concat(siteCode,"_site_").concat(isDesktop?"desktop":"mweb");return{_pageName:pageName,_pageURL:parentFullUrl,_siteCode:siteCode,_siteDomain:property,_siteEdition:"us",_siteType:siteType,brandPlatformId:brandPlatformId,isAvia:isAvia,mediaAutoPlay:(_window$$cbc$Video$au=(_window$$cbc=window.$cbc)===null||_window$$cbc===void 0?void 0:(_window$$cbc$Video=_window$$cbc.Video)===null||_window$$cbc$Video===void 0?void 0:_window$$cbc$Video.autoplay)!==null&&_window$$cbc$Video$au!==void 0?_window$$cbc$Video$au:false}}initializeEmbeddedTealium(){const overrides=this.createTealiumDataOverrides(true);if(window.utag_data===undefined){window.utag_data=this.getBasicSiteData()}window.utag_data=merge_default()(window.utag_data,this.config,overrides)}renderTealiumTag(){const propertyName=Object(content["a"])(true);const utagPropertyName=propertyName==="popculture.com"?"popculturesite":"comicbook";const env=false?undefined:"prod";const scriptConfig={url:"https://tags.tiqcdn.com/utag/cbsi/".concat(utagPropertyName,"/").concat(env,"/utag.js"),id:"tealium-script"};Object(utils_dom["c"])(scriptConfig)}getUtagData(){if(this.embedded){return window.utag_data}return{}}getBasicSiteData(){const data={brandPlatformId:null,siteDeviceType:null,siteType:null,scRsid:null,siteCode:null};if(Object(content["b"])()){data.scRsid="cbsicomicbbooksite";data.siteCode="comicbook"}else{data.scRsid="cbsipopculturesite";data.siteCode="popculture"}return data}}async function respondToRequestConfig(event,overrides){const BBService=new BidBarrelService;const bbCustomParams=await BBService.requestVideoAdCustomParams();const config=merge_default()({cbc:merge_default()(window.$cbc,{pageWidth:document.body.clientWidth}),utag:window.utag_data,bbCustomParams:bbCustomParams},overrides);sendMessageToIframe({sender:VIDEO_PLAYER_HOST_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.SEND_CONFIG,config:config},event.source)}function respondToSendConfig(event,baseConfig){const{autoplay:autoplay=false,bbCustomParams:bbCustomParams={},cbc:cbc={},utag:utag={}}=event.data.config;const{parentURL:parentURL,videoId:videoId}=baseConfig;window.$cbc=merge_default()(window.$cbc,cbc,{CurrentSite:{parentURL:parentURL},Video:{autoplay:autoplay,videoId:videoId}});const tealiumService=new TealiumService_TealiumService(utag);tealiumService.initialize();window.bbCustomParams=bbCustomParams;const response={sender:VIDEO_PLAYER_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.CONFIG_READY,id:videoId,autoplay:autoplay};sendMessageToHost(response);sendMessageToIframe(response,null,true)}function respondToPlayerAbort(_ref,recoverFn){let{reason:reason,recoverable:recoverable}=_ref;if(reason)console.error("[Avia: Abort] ".concat(reason.message));if(recoverable){try{recoverFn&&recoverFn()}catch(e){console.error("[Avia: Abort] Failed to recover after abort")}}}function createEmbedMessenger(){window.addEventListener("DOMContentLoaded",()=>{sendMessageToHost({sender:VIDEO_PLAYER_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.REQUEST_CONFIG})},{once:true})}function setupEmbedMessengerHandlers(baseConfig){const allowedOrigin=getHostTargetOrigin();const eventHandler=event=>{var _event$data;if(event.origin!==allowedOrigin)return;if(((_event$data=event.data)===null||_event$data===void 0?void 0:_event$data.sender)!==VIDEO_PLAYER_HOST_MESSENGER_ID)return;if(event.data.message===VIDEO_PLAYER_MESSAGES.SEND_CONFIG){respondToSendConfig(event,baseConfig);window.removeEventListener("message",eventHandler)}};window.addEventListener("message",eventHandler)}function setupHostMessengerHandlers(config){const allowedOrigin=getEmbedTargetOrigin();const handler=event=>{var _event$data2;if(event.origin!==allowedOrigin)return;if(((_event$data2=event.data)===null||_event$data2===void 0?void 0:_event$data2.sender)!==VIDEO_PLAYER_MESSENGER_ID)return;if(event.data.message===VIDEO_PLAYER_MESSAGES.REQUEST_CONFIG){respondToRequestConfig(event,config);window.removeEventListener("message",handler)}};window.addEventListener("message",handler)}function setupHostAbortHandler(cb,recoverFn){const allowedOrigin=getEmbedTargetOrigin();const handler=event=>{var _event$data3;if(event.origin!==allowedOrigin)return;if(((_event$data3=event.data)===null||_event$data3===void 0?void 0:_event$data3.sender)!==VIDEO_PLAYER_MESSENGER_ID)return;if(event.data.message===VIDEO_PLAYER_MESSAGES.ABORT){cb(event.data,recoverFn);window.removeEventListener("message",handler)}};window.addEventListener("message",handler)}function emitPlayerAbort(_ref){let{reason:reason,recoverable:recoverable=false}=_ref;sendMessageToHost({sender:VIDEO_PLAYER_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.ABORT,reason:reason,recoverable:recoverable})}function emitPlayerReady(id){sendMessageToHost({sender:VIDEO_PLAYER_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.PLAYER_READY,id:id})}function sendMessageToHost(event){let toSelf=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const target=getHostTargetOrigin();if(!toSelf){window.parent.postMessage(event,target)}else{window.postMessage(event,target)}}function sendMessageToIframe(event){let frame=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let toSelf=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const target=getEmbedTargetOrigin();if(!toSelf&&frame){frame.postMessage(event,target)}else{window.postMessage(event,target)}}function handleDelayedMessage(message,messengerID,cb){const allowedOrigin=messengerID===VIDEO_PLAYER_HOST_MESSENGER_ID?getHostTargetOrigin():getEmbedTargetOrigin();const handler=event=>{var _event$data4;if(event.origin!==allowedOrigin)return;if(((_event$data4=event.data)===null||_event$data4===void 0?void 0:_event$data4.sender)!==VIDEO_PLAYER_MESSENGER_ID)return;if(event.data.message===message){cb(event.data);window.removeEventListener("message",handler)}};window.addEventListener("message",handler)}async function waitForMessage(message,messengerID){return new Promise(resolve=>handleDelayedMessage(message,messengerID,resolve))}var capitalize=__webpack_require__("8RpP");var capitalize_default=__webpack_require__.n(capitalize);const logger=type=>function(name){let debug=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let logFmt=arguments.length>2&&arguments[2]!==undefined?arguments[2]:DEFAULT_LOG_FORMAT;return function(msg){for(var _len=arguments.length,rest=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key]}debug&&console.log("%c<".concat(capitalize_default()(type),": ").concat(name,"> ").concat(msg),logFmt,...rest)}};const pluginLogger=logger("Plugin");const aviaLogger=logger("Avia");const DEFAULT_LOG_FORMAT="color: #808; font-style: italic; font-weight: bold";class AviaPluginBase_AviaPluginBase{constructor(){var _this=this;this.player=void 0;this.services=void 0;this.options=void 0;this.name=void 0;this.avia=void 0;this.debug=void 0;this.logFmt=void 0;this.log=function(msg){for(var _len=arguments.length,rest=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key]}pluginLogger(_this.name,_this.debug,_this.logFmt)(msg,rest)};this.player=null;this.services=null;this.options=null;this.name=null;this.handlePlayerEvent=this.handlePlayerEvent.bind(this)}destroy(){this.listenToPlayer(false,this.getEventInterests());this.player=null;this.options=null;this.services=null;this.avia=null}handlePlayerEvent(event){}getEventInterests(){return[]}sendEvent(data){this.services.event.dispatchPluginEvent(data)}listenToPlayer(flag,events){const action=flag!==false?"on":"off";events.forEach(event=>this.player[action](event,this.handlePlayerEvent))}async onRegister(player,options,services){this.player=player;this.services=services;this.options=options;this.name=options.name;this.avia=services.avia;this.debug=options.debug===true;this.listenToPlayer(true,this.getEventInterests());this.log("Registering ".concat(this.name))}}const PLAYER_EVENT_HANDLER_PLUGIN="PlayerEventHandlerPlugin";function PlayerEventHandlerPlugin_eventHandler(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{factory:PlayerEventHandlerPlugin_PlayerEventHandlerPlugin.create,priority:avia_min["PluginPriority"].HIGH,options:{name:PLAYER_EVENT_HANDLER_PLUGIN,...options}}}class PlayerEventHandlerPlugin_PlayerEventHandlerPlugin extends AviaPluginBase_AviaPluginBase{constructor(){super(...arguments);this.getEventHandlers=()=>Object.keys(this.options.handlers)}getEventInterests(){return[avia_min["PlayerEvent"].READY,avia_min["PlayerEvent"].RESOURCE_START,avia_min["PlayerEvent"].AD_START,avia_min["PlayerEvent"].AD_COMPLETE,avia_min["PlayerEvent"].CONTENT_START,avia_min["PlayerEvent"].CONTENT_COMPLETE]}handlePlayerEvent(event){var _this$player;const messageData={sender:VIDEO_PLAYER_MESSENGER_ID,message:VIDEO_PLAYER_MESSAGES.PLAYER_EVENT,data:{type:event.type,videoInfo:((_this$player=this.player)===null||_this$player===void 0?void 0:_this$player.resource)||null}};if(event.type===avia_min["PlayerEvent"].AD_START){messageData.data.adInfo=event.detail.adInfo}const handlers=this.getEventHandlers();if(handlers.includes(event.type)){const handler=this.options.handlers[event.type];handler(event)}sendMessageToHost(messageData)}async onRegister(player,options,services){await super.onRegister(player,options,services)}static async create(services,options){const plugin=new PlayerEventHandlerPlugin_PlayerEventHandlerPlugin;await plugin.onRegister(services.player,options,services);return{getId(){return PLAYER_EVENT_HANDLER_PLUGIN}}}}var FatalErrorPlugin=__webpack_require__("Ma1P");const FATAL_ERROR_PLUGIN="FatalErrorPlugin";function fatalError(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{factory:createFatalErrorPlugin,priority:avia_min["PluginPriority"].HIGH,options:options}}function createFatalErrorPlugin(services){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const{player:player,dom:dom}=services;const{PlayerEvent:PlayerEvent}=services.avia;const container=dom.main;const{debug:debug,logFmt:logFmt}=options;const log=pluginLogger(FATAL_ERROR_PLUGIN,debug,logFmt);const handleFatalErrorEvent=e=>{const{category:category="",fatal:fatal,message:message=""}=e.detail;if(!fatal)return;log("Encountered Fatal Error:","\nCategory => ".concat(category),"\nMessage => ".concat(message));const errorDiv=document.createElement("div");const errorP=document.createElement("p");errorDiv.classList.add(FATAL_ERROR_PLUGIN);errorP.classList.add("".concat(FATAL_ERROR_PLUGIN,"__content"));errorP.textContent="Could not play the video. Please refresh the page and try again.";errorDiv.append(errorP);container.prepend(errorDiv)};log("Registering ".concat(FATAL_ERROR_PLUGIN));player.on(PlayerEvent.ERROR,handleFatalErrorEvent);return{getId(){return FATAL_ERROR_PLUGIN},destroy(){player.off(PlayerEvent.ERROR,handleFatalErrorEvent)}}}const prismServiceLogger=logger("Prism Video Service");const VIDEO_CACHE_PREFIX="video";const PLAYLIST_CACHE_PREFIX="playlist";class PrismVideoSearchService_PrismVideoSearchService{constructor(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.debug=options.debug===true;this.PRISM_PROXY_BASE_URL=location.origin;this.log=prismServiceLogger("Video Search Service",this.debug)}createCacheEntry(type,key,value){PrismVideoSearchService_PrismVideoSearchService.cache.set("".concat(type,":").concat(key),value)}getCacheEntry(type,id){PrismVideoSearchService_PrismVideoSearchService.cache.get("".concat(type,":").concat(id))}async searchPrismForVideo(id){if(!id)return null;const cachedVideo=this.getCacheEntry(VIDEO_CACHE_PREFIX,id);if(cachedVideo!==undefined){this.log("Found video in cache: ".concat(id));return cachedVideo}this.log("Fetching Video ID: ".concat(id));const videoJson=await(await fetch("".concat(this.PRISM_PROXY_BASE_URL,"/api/video/").concat(id,"/"))).json();if(videoJson.length){const video=videoJson[0];this.createCacheEntry(VIDEO_CACHE_PREFIX,id,video);return video}}async searchPrismForPlaylist(channel){if(!channel)return[];const cachedPlaylist=this.getCacheEntry(PLAYLIST_CACHE_PREFIX,channel);if(cachedPlaylist!==undefined){this.log("Found playlist in cache: ".concat(channel));return cachedPlaylist}this.log("Fetching Video Playlist: ".concat(channel));let videos=await(await fetch("".concat(this.PRISM_PROXY_BASE_URL,"/api/video/playlist/").concat(channel,"/"))).json();if(!videos.length){const property=Object(content["a"])(false);const fallback="".concat(property,"default");const cachedFallbackPlaylist=this.getCacheEntry(PLAYLIST_CACHE_PREFIX,fallback);if(cachedFallbackPlaylist!==undefined){this.log("Found fallback playlist in cache: ".concat(fallback));return cachedFallbackPlaylist}this.log("Fetching Fallback Playlist: ".concat(fallback));videos=await(await fetch("".concat(this.PRISM_PROXY_BASE_URL,"/api/video/playlist/").concat(property,"default/"))).json()}return videos}}PrismVideoSearchService_PrismVideoSearchService.cache=new Map;var inRange=__webpack_require__("b+uO");var inRange_default=__webpack_require__.n(inRange);async function sha256(message){const msgBuffer=(new TextEncoder).encode(message);const hashBuffer=await crypto.subtle.digest("SHA-256",msgBuffer);const hashArray=Array.from(new Uint8Array(hashBuffer));const hashHex=hashArray.map(b=>b.toString(16).padStart(2,"0")).join("");return hashHex}function fromBase64(val){return window.atob(val)}function toBase64(val){return window.btoa(val)}var url=__webpack_require__("uLeD");function buildResource(){let videoObject=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let isPlaylist=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!videoObject.metaData.files.length)return null;const bestFileToStream=selectBestVideoFile(videoObject.metaData.files);const mediaUrl=bestFileToStream.url;if(!mediaUrl)return null;const baseResource=Object(avia_min["createResourceConfig"])();const{duration:duration}=videoObject.metaData;const posterImageUrl=getPosterImage();const resource={location:{mediaUrl:mediaUrl,posterImageUrl:posterImageUrl},metadata:{videoId:videoObject.id,guid:videoObject.metaData.mpxRefId,title:videoObject.title,name:videoObject.title,videoData:videoObject,streamType:"vod",durationS:duration,duration:duration,mediaUrl:mediaUrl,...isPlaylist?{isPlaylist:true}:{}}};const combinedResource=merge_default()(baseResource,resource);return combinedResource}function selectBestVideoFile(files){const{clientWidth:clientWidth}=document.body;const m3u8=files.find(file=>file.format==="m3u8");if(m3u8)return m3u8;const fallbackFormats=["mpeg-4","mp4"];const mp4s=files.filter(file=>fallbackFormats.includes(file.format.toLowerCase()));if(!mp4s.length)return null;let candidate=mp4s[0];const minWidth=clientWidth-150;const maxWidth=clientWidth+150;for(const file of mp4s){if(inRange_default()(file.width,minWidth,maxWidth)){candidate=file}}return candidate}async function getAutoplay(){const apInfo=await Object(avia_min["getAutoplayCapabilities"])();if(apInfo.supportsUnmutedAutoplay){return avia_min["Autoplay"].ATTEMPT_UNMUTED_THEN_MUTED}if(apInfo.supportsMutedAutoplay){return avia_min["Autoplay"].ATTEMPT_MUTED}return avia_min["Autoplay"].NONE}function getPosterImage(){const property=Object(content["a"])(false);return"https://sports.cbsimg.net/images/video/".concat(property,"-slate.png")}function extractVideoIdFromConfig(config){const videoConfig=config.Video;if(!videoConfig)return null;try{const decodedVideoConfig=fromBase64(videoConfig);return JSON.parse(decodedVideoConfig)}catch(e){return null}}function extractVideoConfigFromLocation(){const{pathname:pathname}=window.location;const paths=pathname.split("/").filter(Boolean);const encodedData=paths.pop();try{const data=JSON.parse(atob(encodedData));return data}catch(e){return null}}function extractVideoIdFromLegacyEmbed(src){const decodedSrc=decodeURIComponent(src);const videoId=Object(url["a"])("ids",new URL(decodedSrc).searchParams);return videoId}function generateVideoURL(videoId){const baseURL="".concat(getEmbedTargetOrigin(),"/embed/video/");const parentURL=window.$cbc.CurrentSite.parentURL||window.location.pathname;const dataObj=JSON.stringify({videoId:videoId,parentURL:parentURL});const encodedData=toBase64(dataObj);return baseURL+encodedData}function getChannel(){const COMICBOOK_CHANNEL="comicbookdefault";const POPCULTURE_CHANNEL="popculturedefault";const currentSite=Object(content["a"])(false);return currentSite==="comicbook"?COMICBOOK_CHANNEL:POPCULTURE_CHANNEL}const LAZY_PLAYLIST_PLUGIN="LazyPlaylistPlugin";function lazyPlaylist(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{factory:LazyPlaylistPlugin_LazyPlaylistPlugin.create,priority:avia_min["PluginPriority"].LOW,options:{name:LAZY_PLAYLIST_PLUGIN,...options}}}class LazyPlaylistPlugin_LazyPlaylistPlugin extends AviaPluginBase_AviaPluginBase{constructor(){super(...arguments);this.mainVideoId=null;this.adConfigService=null}async getPlaylist(channel){if(channel in LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache){return LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache[channel]}LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache[channel]=[];const prismVideoSearch=new PrismVideoSearchService_PrismVideoSearchService({debug:this.debug});const playlistVideos=await prismVideoSearch.searchPrismForPlaylist(channel);await Promise.all(playlistVideos.map(async playlistVideo=>{if(this.mainVideoId!==playlistVideo.id){const resource=buildResource(playlistVideo,true);const adConfig=await this.adConfigService.getAviaAdConfig(resource);resource.ad=adConfig;LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache[channel].push(resource)}}));return LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache[channel]}async onRegister(player,options,services){await super.onRegister(player,options,services);const playlist=player.getPlugin(avia_playlist_min["PLAYLIST"]);if(playlist.length<=1){this.mainVideoId=player.resource.metadata.videoId;this.adConfigService=options.adConfigService;const playlistResources=await this.getPlaylist(options.channel);playlist.addResources(playlistResources);this.log("Playlist Resources Added")}}static async create(services,options){const plugin=new LazyPlaylistPlugin_LazyPlaylistPlugin;await plugin.onRegister(services.player,options,services);return{getId(){return LAZY_PLAYLIST_PLUGIN}}}}LazyPlaylistPlugin_LazyPlaylistPlugin.playlistCache={};var ReplayAllPlugin=__webpack_require__("hhyj");const REPLAY_ALL_PLUGIN="ReplayAllPlugin";function replayAll(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{factory:createReplayAll,priority:avia_min["PluginPriority"].LOW,options:options}}function createReplayAll(services,options){let panel;let listening=false;const{player:player,dom:dom}=services;const{PlayerEvent:PlayerEvent}=services.avia;const container=dom.main;const{debug:debug,logFmt:logFmt}=options;const log=pluginLogger(REPLAY_ALL_PLUGIN,debug,logFmt);const onContentStart=()=>{if(listening)return;const playlistPlugin=player.getPlugin(avia_playlist_min["PLAYLIST"]);if(playlistPlugin){log("Attaching onEnd listener");player.on(PlayerEvent.PLUGIN_EVENT,onEnd)}listening=true};const onEnd=e=>{var _e$detail;const playlist=player.getPlugin(avia_playlist_min["PLAYLIST"]);if(!playlist)return;if(e.type===PlayerEvent.PLUGIN_EVENT&&((_e$detail=e.detail)===null||_e$detail===void 0?void 0:_e$detail.type)!==avia_playlist_min["PlaylistEvent"].PLAYLIST_COMPLETE){return}if(!playlist.nextResource){log("Playlist complete. Creating Replay All Prompt");panel=document.createElement("div");panel.classList.add(REPLAY_ALL_PLUGIN);panel.style.zIndex=options.level||100;panel.innerHTML='<div class="'.concat(REPLAY_ALL_PLUGIN,'__circle"><button class="').concat(REPLAY_ALL_PLUGIN,'__icon"></button></div>');panel.onclick=()=>{const{list:list=[]}=playlist;log("Replaying playlist");container.removeChild(panel);playlist.clear();playlist.addResources(list);playlist.start()};container.appendChild(panel);const defaultReplay=container.querySelector(".avia-replay");if(defaultReplay){container.removeChild(defaultReplay)}}};player.on(PlayerEvent.CONTENT_START,onContentStart);return{getId(){return REPLAY_ALL_PLUGIN},destroy(){log("Destroying ".concat(REPLAY_ALL_PLUGIN));if(panel){panel.onclick=null;container.removeChild(panel)}player.off(PlayerEvent.CONTENT_START,onContentStart)}}}var __defProp=Object.defineProperty;var __getOwnPropSymbols=Object.getOwnPropertySymbols;var __hasOwnProp=Object.prototype.hasOwnProperty;var __propIsEnum=Object.prototype.propertyIsEnumerable;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value:value}):obj[key]=value;var __spreadValues=(a,b)=>{for(var prop in b||(b={}))if(__hasOwnProp.call(b,prop))__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b)){if(__propIsEnum.call(b,prop))__defNormalProp(a,prop,b[prop])}return a};var __objRest=(source,exclude)=>{var target={};for(var prop in source)if(__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0)target[prop]=source[prop];if(source!=null&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source)){if(exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop))target[prop]=source[prop]}return target};var __async=(__this,__arguments,generator)=>new Promise((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}};var rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}};var step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())});var __create=Object.create;var __defProp2=Object.defineProperty;var __defProps=Object.defineProperties;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropDescs=Object.getOwnPropertyDescriptors;var __getOwnPropNames=Object.getOwnPropertyNames;var __getOwnPropSymbols2=Object.getOwnPropertySymbols;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp2=Object.prototype.hasOwnProperty;var __propIsEnum2=Object.prototype.propertyIsEnumerable;var __defNormalProp2=(obj,key,value)=>key in obj?__defProp2(obj,key,{enumerable:true,configurable:true,writable:true,value:value}):obj[key]=value;var __spreadValues2=(a,b)=>{for(var prop in b||(b={}))if(__hasOwnProp2.call(b,prop))__defNormalProp2(a,prop,b[prop]);if(__getOwnPropSymbols2)for(var prop of __getOwnPropSymbols2(b)){if(__propIsEnum2.call(b,prop))__defNormalProp2(a,prop,b[prop])}return a};var __spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b));var __markAsModule=target=>__defProp2(target,"__esModule",{value:true});var __commonJS=(cb,mod)=>function __require(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __export=(target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:true})};var __reExport=(target,module,copyDefault,desc)=>{if(module&&typeof module==="object"||typeof module==="function"){for(let key of __getOwnPropNames(module))if(!__hasOwnProp2.call(target,key)&&(copyDefault||key!=="default"))__defProp2(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable})}return target};var __toESM=(module,isNodeMode)=>__reExport(__markAsModule(__defProp2(module!=null?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:true}:{value:module,enumerable:true})),module);var __decorateClass=(decorators,target,key,kind)=>{var result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target;for(var i=decorators.length-1,decorator;i>=0;i--)if(decorator=decorators[i])result=(kind?decorator(target,key,result):decorator(result))||result;if(kind&&result)__defProp2(target,key,result);return result};var __async2=(__this,__arguments,generator)=>new Promise((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}};var rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}};var step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())});var require_screenfull=__commonJS({"../node_modules/screenfull/dist/screenfull.js"(exports,module){(function(){"use strict";var document2=typeof window!=="undefined"&&typeof window.document!=="undefined"?window.document:{};var isCommonjs=typeof module!=="undefined"&&module.exports;var fn=function(){var val;var fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var i=0;var l=fnMap.length;var ret={};for(;i<l;i++){val=fnMap[i];if(val&&val[1]in document2){for(i=0;i<val.length;i++){ret[fnMap[0][i]]=val[i]}return ret}}return false}();var eventNameMap={change:fn.fullscreenchange,error:fn.fullscreenerror};var screenfull3={request:function(element,options){return new Promise(function(resolve,reject){var onFullScreenEntered=function(){this.off("change",onFullScreenEntered);resolve()}.bind(this);this.on("change",onFullScreenEntered);element=element||document2.documentElement;var returnPromise=element[fn.requestFullscreen](options);if(returnPromise instanceof Promise){returnPromise.then(onFullScreenEntered).catch(reject)}}.bind(this))},exit:function(){return new Promise(function(resolve,reject){if(!this.isFullscreen){resolve();return}var onFullScreenExit=function(){this.off("change",onFullScreenExit);resolve()}.bind(this);this.on("change",onFullScreenExit);var returnPromise=document2[fn.exitFullscreen]();if(returnPromise instanceof Promise){returnPromise.then(onFullScreenExit).catch(reject)}}.bind(this))},toggle:function(element,options){return this.isFullscreen?this.exit():this.request(element,options)},onchange:function(callback){this.on("change",callback)},onerror:function(callback){this.on("error",callback)},on:function(event,callback){var eventName=eventNameMap[event];if(eventName){document2.addEventListener(eventName,callback,false)}},off:function(event,callback){var eventName=eventNameMap[event];if(eventName){document2.removeEventListener(eventName,callback,false)}},raw:fn};if(!fn){if(isCommonjs){module.exports={isEnabled:false}}else{window.screenfull={isEnabled:false}}return}Object.defineProperties(screenfull3,{isFullscreen:{get:function(){return Boolean(document2[fn.fullscreenElement])}},element:{enumerable:true,get:function(){return document2[fn.fullscreenElement]}},isEnabled:{enumerable:true,get:function(){return Boolean(document2[fn.fullscreenEnabled])}}});if(isCommonjs){module.exports=screenfull3}else{window.screenfull=screenfull3}})()}});var LogLevel=(LogLevel2=>{LogLevel2["OFF"]="off";LogLevel2["ERROR"]="error";LogLevel2["WARN"]="warn";LogLevel2["INFO"]="info";LogLevel2["DEBUG"]="debug";return LogLevel2})(LogLevel||{});var CoreEvent=class{constructor(type,target,detail){this.timeStamp=Date.now();this.detail=detail;this.target=target;this.type=type}};var LinkedNode=class{constructor(value,next){this.value=value;this.next=next}};var LinkedList=class{constructor(){this.head=null;this.tail=null}get empty(){return this.head==null}forEach(func){let node=this.head;while(node){func(node.value);node=node.next}}add(value){const node=new LinkedNode(value);if(this.head==null){this.head=node}else if(this.tail==null){this.head.next=this.tail=node}else{this.tail.next=this.tail=node}}has(value){let node=this.head;while(node){if(node.value===value){return true}node=node.next}return false}delete(value){let previous=null;let node=this.head;while(node){if(node.value===value){if(previous){previous.next=node.next}if(node===this.head){this.head=node.next}else if(node===this.tail){this.tail=previous}return true}previous=node;node=node.next}return false}clear(){let node=this.head;let next;while(node){next=node.next;node.value=node.next=null;node=next}this.head=this.tail=null}};var MimeType=(MimeType2=>{MimeType2["MP4_VIDEO"]="video/mp4";MimeType2["MP4_AUDIO"]="audio/mp4";MimeType2["HLS"]="application/vnd.apple.mpegurl";MimeType2["HLS_ALT"]="application/x-mpegURL";MimeType2["DASH"]="application/dash+xml";MimeType2["WEBM_VIDEO"]="video/webm";MimeType2["WEBM_AUDIO"]="audio/webm";MimeType2["TS_VIDEO"]="video/mp2t";MimeType2["VTT"]="text/vtt";MimeType2["TTML"]="application/ttml+xml";return MimeType2})(MimeType||{});var FileExtensionToMimeType={VTT:"text/vtt",XML:"application/ttml+xml",M3U8:"application/vnd.apple.mpegurl",MPD:"application/dash+xml",TS:"video/mp2t",MP4:"video/mp4",MPV:"video/mp4",MPA:"audio/mp4",WEBM:"video/webm"};var TextTrackKind=(TextTrackKind2=>{TextTrackKind2["CAPTIONS"]="captions";TextTrackKind2["SUBTITLES"]="subtitles";TextTrackKind2["DESCRIPTIONS"]="descriptions";TextTrackKind2["CHAPTERS"]="chapters";TextTrackKind2["METADATA"]="metadata";return TextTrackKind2})(TextTrackKind||{});var VirtualVideoElement=class{constructor(){this.muted=false;this.volume=NaN;this.currentTime=NaN;this.duration=NaN}};var _Util=class{constructor(){}static camelToDash(term){const d="-";return term.replace(_Util.cdr,d).replace(_Util.dre,"$1-$2").toLowerCase()}static uid8(){const s4=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return s4()+s4()}static uuid(){const url=URL.createObjectURL(new Blob);const uuid=url.toString();URL.revokeObjectURL(url);return uuid.slice(uuid.lastIndexOf("/")+1)}static isEmpty(obj){return obj===null||obj===void 0||Array.isArray(obj)&&obj.length===0||_Util.isObject(obj)&&Object.keys(obj).length===0||_Util.isString(obj)&&obj===""}static isFunction(obj){return typeof obj==="function"}static isString(obj){return typeof obj==="string"}static isUndefined(obj){return typeof obj==="undefined"}static isNumber(obj){return typeof obj==="number"}static isBoolean(obj){return typeof obj==="boolean"}static isObject(obj){return typeof obj==="object"}static values(obj){return Object.keys(obj).reduce((a,k,i)=>{a[i]=obj[k];return a},[])}static entries(obj){return Object.keys(obj).reduce((a,k,i)=>{a[i]=[k,obj[k]];return a},[])}static fromEntries(entries){return entries.reduce((o,_ref)=>{let[k,v]=_ref;o[k]=v;return o},{})}static padStart(str,targetLength){let padString=arguments.length>2&&arguments[2]!==undefined?arguments[2]:" ";targetLength=targetLength|0;const len=str.length;if(len>targetLength){return str}targetLength=targetLength-len;if(targetLength>padString.length){padString+=padString.repeat(targetLength/padString.length)}return padString.slice(0,targetLength)+str}static merge(){const override=(base2,overrides)=>{if(base2==null){return overrides}else if(overrides==null){return base2}Object.getOwnPropertyNames(overrides).forEach(key=>{const value=overrides[key];const baseValue=base2[key];const type=typeof value;if(type==="undefined"){return}else if(baseValue==null||!_Util.isObject(baseValue)||Array.isArray(value)){base2[key]=value}else if(type==="object"){base2[key]=override(baseValue,value)}});return base2};for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const[base,...rest]=args;return rest.reduce((acc,obj)=>override(acc,obj),base)}static secToHms(seconds){let max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:61;if(seconds==null||isNaN(seconds)){return"00:00"}seconds=seconds|0;let time=_Util.zeroFill(seconds%60);seconds=seconds/60|0;time=_Util.zeroFill(seconds%60)+":"+time;seconds=seconds/60|0;if(seconds>0){time=_Util.zeroFill(seconds)+":"+time}if(max>=3600&&time.length===5){time="00:"+time}return time}static msToHms(ms){return _Util.formatTime(new Date(ms),"HH:mm:ss:sss",{offset:0})}static zeroFill(time){let len=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;return _Util.padStart(String(time),len,"0")}static hmsToSec(timeCode){let framerate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:30;if(!timeCode){return NaN}const pieces=timeCode.split(":");let ms=0;if(pieces.length===4){ms=parseInt(pieces.pop())/framerate}else if(pieces.length===3){pieces[2]=pieces[2].replace(",",".");if(pieces[2].indexOf(".")!==-1){const parts=pieces[2].split(".");if((parts!=null?parts.length:void 0)>1){pieces[2]=parts[0];ms=parseInt(parts[1])/1e3}}}let time=parseInt(pieces.pop());while(pieces.length>0){time+=Math.pow(60,pieces.length)*parseInt(pieces.shift())}return time+ms}static formatTime(date){let format=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"h:mm:ss A";let tz=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{timezone:"",offset:-((new Date).getTimezoneOffset()/60)};if(tz.offset!=null&&tz.offset!==0){date=new Date(date.getTime()+Math.round(tz.offset*60*60*1e3))}if(isNaN(date.getTime())){return""}const hours=date.getUTCHours();const minutes=date.getUTCMinutes();const seconds=date.getUTCSeconds();const milliseconds=date.getUTCMilliseconds();const twelve=hours%12||12;const a=hours<12?"am":"pm";const replace={hh:_Util.zeroFill(twelve),h:twelve,HH:_Util.zeroFill(hours),H:hours,mm:_Util.zeroFill(minutes),m:minutes,sss:_Util.zeroFill(milliseconds,3),ss:_Util.zeroFill(seconds),s:seconds,a:a,A:a.toUpperCase(),z:tz.timezone};for(const key in replace){format=format.replace(key,replace[key])}return format}static template(input,context){let open=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"{{";let close=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"}}";if(!input){return input}const regex=new RegExp("".concat(open,"((?:(?!(").concat(open,"|").concat(close,")).)+)").concat(close),"g");return input.replace(regex,(match,token)=>!_Util.isUndefined(context==null?void 0:context[token])?context[token]:match)}static forEach(list,func){if(!list||!list.length||!_Util.isFunction(func)){return}for(let i=0,len=list.length;i<len;i++){func(list[i],i,list)}}static forEachReverse(list,func){if(!list||!list.length||!_Util.isFunction(func)){return}for(let i=list.length-1;i>-1;i--){func(list[i],i,list)}}static debounce(func,delay){let timeout;const pending=()=>timeout!=null;const cancel=()=>{clearTimeout(timeout);timeout=null};const run=function(){cancel();for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}timeout=setTimeout(func,delay,...args)};run.cancel=cancel;run.flush=func;run.pending=pending;return run}static clampValue(value,min,max){return Math.max(min,Math.min(max,value))}static inRange(value,lower,upper){return _Util.isNumber(value)&&value>=lower&&value<=upper}static mapToRange(value,fromMin,fromMax){let toMin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;let toMax=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;return(value-fromMin)*(toMax-toMin)/(fromMax-fromMin)+toMin}static base64DecodeUint8Array(input){const raw=atob(input);const rawLength=raw.length;const array=new Uint8Array(new ArrayBuffer(rawLength));for(let i=0;i<rawLength;i++){array[i]=raw.charCodeAt(i)}return array}static base64EncodeUint8Array(input){const str=String.fromCharCode.apply(null,input);return btoa(str)}static xmlToJson(xml){let obj={};if(xml.nodeType===1&&xml.attributes.length>0){for(let j=0,k=xml.attributes.length;j<k;j++){const attribute=xml.attributes.item(j);obj[attribute.nodeName]=attribute.nodeValue}}else if(xml.nodeType===3){obj=xml.nodeValue}if(xml.nodeName==="p"){obj.text="";xml.childNodes.forEach(node=>{if(node.nodeName==="metadata"){return}const text=(new XMLSerializer).serializeToString(node);if(node.nodeType===1){obj.text+=node.tagName==="br"?"\n":text}if(node.nodeType===3){obj.text+=text}})}if(xml.hasChildNodes()){for(let i=0,h=xml.childNodes.length;i<h;i++){const item=xml.childNodes.item(i),nodeName=item.nodeName;if(_Util.isUndefined(obj[nodeName])){obj[nodeName]=_Util.xmlToJson(item);continue}if(_Util.isUndefined(obj[nodeName].push)){const old=obj[nodeName];obj[nodeName]=[];obj[nodeName].push(old)}obj[nodeName].push(_Util.xmlToJson(item))}}return obj}static getNumLines(text){return text&&(text.match(/\n/g)||[]).length+1}static roundTo(num,len){return Math.round(num*Math.pow(10,len))/Math.pow(10,len)}static makeUrl(ssl,location){return(ssl?"https:":"http:")+"//"+location}static parseLanguageTag(){let tag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";const regex=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;const match=tag.match(regex)||[];return{tag:tag,language:match[1]||"",extended:match[2]||"",script:match[3]||"",region:match[4]||"",toString(){return this.tag}}}static getFileExtension(uri){return uri.replace(/\?.*/,"").replace(/#.*/,"").split(".").pop()}static getMimeType(uri){if(!uri){return""}const ext=_Util.getFileExtension(uri).toUpperCase();return FileExtensionToMimeType[ext]}static clearCue(textTrack,time){try{const Cue=VTTCue||TextTrackCue;textTrack.addCue(new Cue(time-.1,time+.1," "))}catch(error){}}static clearAllCues(textTrack){const clearCues=cues=>{if(!cues){return}Array.from(cues).forEach(cue=>{try{textTrack.removeCue(cue)}catch(error){}})};clearCues(textTrack.cues);clearCues(textTrack.activeCues)}static eventsToPromise(success,failure){let timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:NaN;return new Promise((resolve,reject)=>{let timeoutId;const undo=[];const cleanUp=()=>undo.forEach(u=>u());const apply=action=>_ref2=>{let{target:target,events:events}=_ref2;const t=target;const on=t.on?"on":"addEventListener";const off=t.off?"off":"removeEventListener";const complete=(e,d)=>{clearTimeout(timeoutId);cleanUp();action(d||e)};events.forEach(event=>{t[on](event,complete);undo.push(()=>t[off](event,complete))})};success.forEach(apply(resolve));failure.forEach(apply(reject));if(timeout>-1){timeoutId=setTimeout(()=>{cleanUp();reject(new Error("timeout"))},timeout)}})}static bufferToString(buffer){return String.fromCharCode.apply(null,new Uint8Array(buffer))}static arrayToString(array){const uint16array=new Uint16Array(array.buffer);return String.fromCharCode.apply(null,uint16array)}static stringToArray(string){const buffer=new ArrayBuffer(string.length*2);const array=new Uint16Array(buffer);for(let i=0,strLen=string.length;i<strLen;i++){array[i]=string.charCodeAt(i)}return array}static getResourceMimeType(resource){var _a;const override=((_a=resource.overrides)==null?void 0:_a.mimeType)||"";return override.split(";").shift()||_Util.getMimeType(resource.location.mediaUrl)}static normalizeQuality(item,index){return{index:index,bitrate:item.bitrate,height:item.height,width:item.width,codec:item.codec||item.codecs}}static getIndexForBitrate(list,bitrate,isMinLookup){if(!list){return 0}let i=list.length-1;if(bitrate>=list[i].bitrate){return i}while(i--){const rate=list[i].bitrate;if(isMinLookup){if(bitrate>rate){return i+1}}else{if(bitrate>=rate){return i}}}return 0}static findDefaultTrack(tracks,language){let regex=new RegExp(language,"i");let track=tracks.find(t=>regex.test(t.language));if(!track){const short=_Util.parseLanguageTag(language).language;if(short!==language){regex=new RegExp(short,"i");track=tracks.find(t=>regex.test(t.language))}}return track||tracks.find(t=>t.default)||tracks[0]}static dedupeCues(track){const map={};const cues=[];if(!track.activeCues){return null}Array.from(track.activeCues).forEach(cue=>{try{if(!cue){return}const{text:text,startTime:startTime,endTime:endTime}=cue;if(!text){return}const mapped=map[text];if(!mapped){map[text]=cue}else if(mapped.startTime===startTime&&mapped.endTime===endTime){track.removeCue(cue);return}cues.push(cue)}catch(error){}});return cues}static isTextTrack(kind){return kind==="captions"||kind==="subtitles"}static createSimpleVideoInterface(){return new VirtualVideoElement}};var Util=_Util;Util.dre=/([a-z\d])([A-Z])/g;Util.cdr=/\W+/g;var Emitter=class{constructor(options,target){this.target=target||this;this.opts=options||{};this.eventMap={};const o=this.opts;for(const q in o){if(Util.isFunction(o[q])&&/^on[A-Z]/.test(q)){const e=q.charAt(2).toLowerCase()+q.substring(3);this.on(e,o[q]);delete this.opts[q]}}}destroy(){let q;if(this.opts){for(q in this.opts){delete this.opts[q]}this.opts=null}this.offAll(null);if(this.eventMap){for(q in this.eventMap){delete this.eventMap[q]}this.eventMap=null}}on(name,func){if(!this.eventMap||!name||!Util.isFunction(func)){return}const handlers=this.eventMap[name]||(this.eventMap[name]=new LinkedList);if(handlers.has(func)){return}handlers.add(func)}once(name,func){if(!this.eventMap||!name||!Util.isFunction(func)){return}const handler=event=>{this.off(name,handler);func(event)};this.on(name,handler)}off(name,func){!func&&this.offAll(name);func&&this.remove(name,func)}offAll(name){if(!this.eventMap){return}const map=this.eventMap;if(name){this.remove(name,null);return}for(const q in map){this.remove(q,null)}}hasListenerFor(name){return!!(this.eventMap&&this.eventMap[name]&&!this.eventMap[name].empty)}emit(name,detail){const e=new CoreEvent(name,this,detail);this.dispatchEvt(e)}dispatchEvt(e){if(!this.eventMap||!this.eventMap[e.type]){return}this.eventMap[e.type].forEach(h=>h(e))}remove(name){let func=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!this.eventMap||!this.eventMap[name]){return}if(!func){this.eventMap[name].clear()}else{this.eventMap[name].delete(func)}}};var Levels={["off"]:0,["error"]:100,["warn"]:200,["info"]:300,["debug"]:400};var _Logger=class extends Emitter{constructor(opts){super(opts);this.useConsole=false;this.useConsole=Util.isObject(console);this.id=opts.id||Util.uid8();this.tzero=Date.now();this.logLevel=Util.isEmpty(this.opts.logLevel)?"off":this.opts.logLevel}static error(e){console&&console.error(e)}static warn(m){console&&console.warn(m)}static log(m){console&&console.log(m)}static deprecated(msg){if(_Logger.deprecatedCounts[msg]>=_Logger.maxDeprecatedWarnings){return}_Logger.warn(msg);_Logger.deprecatedCounts[msg]=(_Logger.deprecatedCounts[msg]||0)+1}get logLevel(){return this.pLogLevel}set logLevel(level){this.pLogLevel=level}assert(expression,label){if(!expression){this.error('Assertion failed! - "'.concat(label||"",'"'))}}log(logLevel){for(var _len3=arguments.length,items=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){items[_key3-1]=arguments[_key3]}for(let i=0,n=items.length;i<n;i++){this.emit(_Logger.LOG_EVENT,this.assembleEvent(items[i],logLevel))}if(!this.shouldLog(logLevel)){return}items.unshift(this.getStamp());console.log(...items)}dir(logLevel,obj,label){const lbl=label||"Unnamed Object";this.emit(_Logger.LOG_EVENT,this.assembleEvent(obj,logLevel,lbl));if(!this.shouldLog(logLevel)){return}console.log(this.getStamp()+" Object: ".concat(lbl));console.dir(obj)}error(msg){this.emit(_Logger.LOG_EVENT,this.assembleEvent(msg,"error"));if(!this.shouldLog("error")){return}console.error(this.getStamp()+msg)}warn(msg){this.emit(_Logger.LOG_EVENT,this.assembleEvent(msg,"warn"));if(!this.shouldLog("warn")){return}console.warn(this.getStamp()+msg)}assembleEvent(item,level){let label=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return{item:item,id:this.id,level:level,label:label}}shouldLog(level){return this.useConsole&&Levels[this.pLogLevel]>=Levels[level]}getStamp(){return"[".concat(this.id+"]  "+Util.msToHms(Date.now()-this.tzero)," > ")}};var Logger=_Logger;Logger.LOG_EVENT="logevent";Logger.maxDeprecatedWarnings=1;Logger.deprecatedCounts={};var sdk_exports={};__export(sdk_exports,{AccessibilityAction:()=>AccessibilityAction,ActiveState:()=>avia_react_esm_ActiveState,AdBreakType:()=>AdBreakType,AdContext:()=>AdContext,AdTechnology:()=>AdTechnology,AdapterRole:()=>AdapterRole,ApiMetric:()=>ApiMetric,AudioTrackType:()=>AudioTrackType,Autoplay:()=>Autoplay,Browser:()=>Browser,CoreEvent:()=>CoreEvent,Device:()=>Device,DrmType:()=>DrmType,Emitter:()=>Emitter,ErrorCategory:()=>ErrorCategory,ErrorCode:()=>ErrorCode,ErrorMessage:()=>ErrorMessage,FileExtensionToMimeType:()=>FileExtensionToMimeType,HTML5:()=>HTML5,Header:()=>Header,HookError:()=>HookError,HookType:()=>HookType,KeyboardScope:()=>KeyboardScope,LocalizationId:()=>LocalizationId,LocalizedLanguage:()=>LocalizedLanguage,LogLevel:()=>LogLevel,Logger:()=>Logger,Metric:()=>Metric,MetricType:()=>MetricType,MimeType:()=>MimeType,Os:()=>Os,PerformanceMode:()=>PerformanceMode,Platform:()=>Platform,PlaybackAdapterBase:()=>PlaybackAdapterBase,PlaybackState:()=>avia_react_esm_PlaybackState,PlayerError:()=>PlayerError,PlayerEvent:()=>avia_react_esm_PlayerEvent,PluginPriority:()=>PluginPriority,QualityCategory:()=>QualityCategory,QualityLabel:()=>QualityLabel,QualityMode:()=>QualityMode,QueryString:()=>QueryString,ResponseType:()=>ResponseType,StreamType:()=>StreamType,TextTrackEvent:()=>TextTrackEvent,TextTrackKind:()=>TextTrackKind,TextTrackMode:()=>TextTrackMode,Timer:()=>Timer,UiMetric:()=>UiMetric,Util:()=>Utilities,VideoFormat:()=>VideoFormat,WILDCARD:()=>WILDCARD,buildInfo:()=>buildInfo,request:()=>request,waitFor:()=>waitFor,waitForEvent:()=>waitForEvent,waitForTime:()=>waitForTime,waitUntil:()=>waitUntil});var AccessibilityAction=(AccessibilityAction2=>{AccessibilityAction2["ENTER_FULLSCREEN"]="enterFullScreen";AccessibilityAction2["INCREASE_VOLUME"]="increaseVolume";AccessibilityAction2["DECREASE_VOLUME"]="decreaseVolume";AccessibilityAction2["SEEK_BACK"]="seekBack";AccessibilityAction2["SEEK_FORWARD"]="seekForward";AccessibilityAction2["TOGGLE_PLAY"]="togglePlay";AccessibilityAction2["TOGGLE_TT"]="toggleTextTrack";AccessibilityAction2["TOGGLE_MUTE"]="toggleMute";AccessibilityAction2["PLAYLIST_NEXT"]="playListNext";AccessibilityAction2["PLAYLIST_PREV"]="playListPrev";AccessibilityAction2["STOP"]="stop";return AccessibilityAction2})(AccessibilityAction||{});var ErrorMessage=(ErrorMessage2=>{ErrorMessage2["ABR_UNAVAILABLE"]="Single bitrate stream detected, adaptive bitrate system is unavailable";ErrorMessage2["ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS"]="You have reached the lowest available quality for this presentation.";ErrorMessage2["ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS"]="You have reached the highest available quality for this presentation at this screen size";ErrorMessage2["ABR_MIN_BITRATE_RESTRICTION_UNAVAILABLE"]="Min bitrate restrictions are not offered with this streaming library";ErrorMessage2["AD_STALLED"]="Stalled ad detected";ErrorMessage2["ADAPTER_UNAVAILABLE"]="Unable to play the requested resource - mediaUrl not recognized";ErrorMessage2["ADAPTER_LIB_UNAVAILABLE"]="Unable to play the requested resource - External library is not loading";ErrorMessage2["ADAPTER_NOT_FOUND"]="Unable to find an adapter for the requested resource";ErrorMessage2["CAP_LEVEL_MAXBITRATE"]="Max bitrate setting will be ignored since capQualityToPlayerSize is enabled";ErrorMessage2["CONTENT_PLAYBACK_SETTING_IGNORED"]="This API is only available after the CONTENT_START event has been dispatched. This setting will be ignored.";ErrorMessage2["DAI_MISSING_ASSET_URL"]="Unexpected condition = valid assetUrl not found in DAI stream data";ErrorMessage2["DAI_SDK_UNAVAILABLE"]="A DAI SDK is required for playback, but is not found";ErrorMessage2["ENVIRONMENT_NOT_SUPPORTED"]='Unable to locate a global "window" object or suitable alternative';ErrorMessage2["FAIRPLAY_LICENSE_ERROR"]="Issue with fairplay DRM and the provided license acquisition url";ErrorMessage2["FAIRPLAY_APP_CERT_ERROR"]="Issue creating a fairplay keysession with the provided application certificate";ErrorMessage2["FAIRPLAY_NO_CONTENT_ID"]="A valid content or asset id was not detected when creating fairplay drm session";ErrorMessage2["FAIRPLAY_WEBKIT_ERROR"]="Issue with webkit and keysession creations while using fairplay drm.";ErrorMessage2["FATAL_PLAYBACK_MEDIA_ERROR"]="Fatal media error, no option for recovery";ErrorMessage2["NONFATAL_PLAYBACK_MEDIA_ERROR"]="Nonfatal media error";ErrorMessage2["FATAL_PLAYBACK_NETWORK_ERROR"]="Fatal network error, no option for recovery";ErrorMessage2["NONFATAL_PLAYBACK_NETWORK_ERROR"]="Nonfatal network error";ErrorMessage2["IMA_SDK_MISSING"]="IMA SDK not found.";ErrorMessage2["INVALID_RESOURCE"]="Resource configuration appears to be invalid";ErrorMessage2["MANUAL_ABR_SWITCHING_UNAVAILABLE"]="Native HTML5 Video does not allow manual bitrate switching";ErrorMessage2["PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED"]="StreamType.LIVE is detected. Redirecting to the stop method since a DVR window is not detected.";ErrorMessage2["PLUGIN_LOAD_ERROR"]="Unable to load plugin from url";ErrorMessage2["RESOURCE_MISSING"]="Resource missing";ErrorMessage2["RESOURCE_NOT_SUPPORTED"]="Resource is not recognized or is currently unsupported";ErrorMessage2["RETRY_PLAYBACK_MEDIA_ERROR"]="Media error detected";ErrorMessage2["RETRY_PLAYBACK_NETWORK_ERROR"]="Network error detected";ErrorMessage2["UNEXPECTED_CONDITION"]="An unexpected condition was encountered";ErrorMessage2["UNSPECIFIED_ERROR"]="Unspecified error";ErrorMessage2["VIDEO_PLAYBACK_UNAVAILABLE"]="Unable to locate a video element or suitable alternative";ErrorMessage2["WEBKIT_KEY_ADDED_SUCCESS"]="Webkit key added successfully";ErrorMessage2["WEBKIT_MEDIA_KEYS_NOT_SUPPORTED"]="WebKitMediaKeys are not supported for this type of media on this user agent";return ErrorMessage2})(ErrorMessage||{});var KeyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,CONTROL:17,END:35,ENTER:13,TAB:9,SHIFT:16,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,SPACE:32,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUM_0:96,NUM_1:97,NUM_2:98,NUM_3:99,NUM_4:100,NUM_5:101,NUM_6:102,NUM_7:103,NUM_8:104,NUM_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,SEMICOLON:186,EQUAL:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,BACKSLASH:220,GRAVE_ACCENT:192,OPEN_BRACKET:219,CLOSE_BRACKET:221,SINGLE_QUOTE:222,MEDIA_TOGGLE_PLAY:179,MEDIA_TOGGLE_MUTE:173,MEDIA_STOP:178,MEDIA_INCREASE_VOLUME:175,MEDIA_INCREASE_VOLUME_ALT:183,MEDIA_DECREASE_VOLUME:174,MEDIA_DECREASE_VOLUME_ALT:182,MEDIA_PLAYLIST_NEXT:176,MEDIA_PLAYLIST_PREV:177};var AppResources=class{constructor(){}};AppResources.blankVideoUrl="https://vidtech.cbsinteractive.com/h5/blanks/uvp_blank.mp4";AppResources.blankDataUrl="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=";AppResources.accessibilityKeyCmdDefs=[{action:"enterFullScreen",primaryKey:"f",keyCode:KeyCode.F},{action:"increaseVolume",primaryKey:"ArrowUp",keyCode:KeyCode.UP_ARROW},{action:"increaseVolume",primaryKey:null,keyCode:KeyCode.MEDIA_INCREASE_VOLUME},{action:"increaseVolume",primaryKey:null,keyCode:KeyCode.MEDIA_INCREASE_VOLUME_ALT},{action:"decreaseVolume",primaryKey:"ArrowDown",keyCode:KeyCode.DOWN_ARROW},{action:"decreaseVolume",primaryKey:null,keyCode:KeyCode.MEDIA_DECREASE_VOLUME},{action:"decreaseVolume",primaryKey:null,keyCode:KeyCode.MEDIA_DECREASE_VOLUME_ALT},{action:"seekBack",primaryKey:"ArrowLeft",keyCode:KeyCode.LEFT_ARROW},{action:"seekForward",primaryKey:"ArrowRight",keyCode:KeyCode.RIGHT_ARROW},{action:"togglePlay",primaryKey:" ",keyCode:KeyCode.SPACE},{action:"togglePlay",primaryKey:null,keyCode:KeyCode.MEDIA_TOGGLE_PLAY},{action:"toggleMute",primaryKey:"m",keyCode:KeyCode.M},{action:"toggleMute",primaryKey:"-",keyCode:KeyCode.SUBTRACT},{action:"toggleMute",primaryKey:null,keyCode:KeyCode.MEDIA_TOGGLE_MUTE},{action:"toggleTextTrack",primaryKey:"c",keyCode:KeyCode.C},{action:"stop",primaryKey:null,keyCode:KeyCode.MEDIA_STOP},{action:"playListNext",primaryKey:null,keyCode:KeyCode.MEDIA_PLAYLIST_NEXT},{action:"playListPrev",primaryKey:null,keyCode:KeyCode.MEDIA_PLAYLIST_PREV}];AppResources.messages=ErrorMessage;var QueryString=class{static encode(obj){if(Util.isEmpty(obj)){return""}const str=Util.entries(obj).map(_ref3=>{let[k,v]=_ref3;return k+"="+encodeURIComponent(v)});return str.join("&")}static decode(uri){const results={};if(uri==null){return results}uri.replace(/^[^?]*\?/,"").replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),($0,$1,$2,$3)=>{let value;try{value=Util.isUndefined($3)?$3:decodeURIComponent($3)}catch(error){value=$3}results[decodeURIComponent($1)]=value});return results}static parseValue(value){if(Util.isUndefined(value)){return true}let temp=value.toLowerCase();if(temp==="true"||temp==="false"){return temp==="true"}if(value==="undefined"){return void 0}if(temp==="null"){return null}temp=parseFloat(value);if(!isNaN(temp)){return temp}return value}static parse(uri){const params=QueryString.decode(uri);for(const k in params){params[k]=QueryString.parseValue(params[k])}return params}static append(url,params){const prefix=url.includes("?")?"&":"?";return url+prefix+QueryString.encode(params)}};var ResponseType=(ResponseType2=>{ResponseType2["ARRAY_BUFFER"]="arraybuffer";ResponseType2["TEXT"]="text";ResponseType2["JSON"]="json";ResponseType2["DOCUMENT"]="document";ResponseType2["DEFAULT"]="";return ResponseType2})(ResponseType||{});var Network=class{static get TIMEOUT(){return 5e3}};var AsyncDataRequestOptions=class{constructor(){}static create(options){return{url:options.url||"",method:options.method||"get",timeout:options.timeout||Network.TIMEOUT,headers:options.headers||{},data:this.getBody(options.data,options.encodeList,options.sendJson),withCredentials:options.withCredentials===true,responseType:options.responseType||"text",onComplete:options.onComplete||null,errorRecovery:options.errorRecovery||null}}static getBody(objOrStr,enc){let asJson=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!objOrStr)return null;if(typeof objOrStr==="string")return objOrStr;if(!Object.keys(objOrStr).length)return null;const useEnc=Array.isArray(enc)&&enc.length;!useEnc&&(enc=[]);for(const q in objOrStr){objOrStr[q]=this.getValue(q,objOrStr[q],enc)}if(asJson){return JSON.stringify(objOrStr)}let str="",v;for(const q in objOrStr){v=objOrStr[q];v!=null&&v!==void 0&&v!==""&&(str+="".concat(q,"=").concat(v,"&"))}str=str.substr(0,str.length-1);return str}static getValue(name,val,enc){return enc.indexOf(name)>=0?encodeURIComponent(val):val}};var RecoveryEnabledRequest=class extends Emitter{constructor(options){super(options);this.retryCount=0;this.limit=0;this.retryIntervals=null;const er=this.opts.errorRecovery;if(er&&!isNaN(er.retryAttempts)&&er.retryAttempts>0){this.limit=er.retryAttempts}if(er&&er.retryIntervals&&Array.isArray(er.retryIntervals)){this.retryIntervals=er.retryIntervals}}shouldRetry(){return this.limit&&!this.atLimit}incrementAttempts(){this.retryCount++}get retryLimit(){return this.limit}get atLimit(){return this.retryCount===this.limit}get retryInterval(){return this.retryIntervals&&this.retryIntervals[this.retryCount-1]||this.retryCount*300}};var _AsyncDataRequest=class extends RecoveryEnabledRequest{static load(options){return new Promise((resolve,reject)=>{const requestOptions=options;requestOptions.onComplete=_ref4=>{let{detail:detail}=_ref4;if(!detail||detail.error){reject(detail)}else{resolve(detail)}};new _AsyncDataRequest(requestOptions)})}constructor(options){super(AsyncDataRequestOptions.create(options));this.requestOptions=this.opts;if(this.opts.url){this.createXhr()}}createXhr(){this.request(this.requestOptions).then(request2=>{const{response:response}=request2;const contentType=request2.getResponseHeader("content-type");let data=response;if(this.requestOptions.responseType==="text"&&contentType){if(contentType.includes("application/smil")||contentType.includes("application/xml")){const parser=new DOMParser;data=parser.parseFromString(data,"application/xml")}else if(contentType==null?void 0:contentType.includes("application/json")){data=JSON.parse(data)}}if(request2.status!==204&&data==null){this.emitCompleteWithError("Unable to parse response.")}else{setTimeout(()=>{this.emitComplete({contentType:contentType,data:data})},1)}}).catch(error=>{if(this.shouldRetry()){this.incrementAttempts();setTimeout(()=>{this.createXhr()},this.retryInterval)}else{const msg=error.response||_AsyncDataRequest.statusMessages["0"];this.emitCompleteWithError(msg)}})}request(options){return new Promise((resolve,reject)=>{if(options.query){options.url=QueryString.append(options.url,options.query)}const xhr=new XMLHttpRequest;xhr.open(options.method,options.url);xhr.onload=()=>{if(options.checkStatus!==false&&xhr.status>399){reject(xhr)}resolve(xhr)};xhr.onerror=event=>{reject(xhr)};xhr.withCredentials=options.withCredentials;if(options.responseType!=null){try{xhr.responseType=options.responseType}catch(error){}}if(options.headers!=null){const headers=options.headers;Util.entries(headers).forEach(_ref5=>{let[key,value]=_ref5;if(key!=null&&value!=null){xhr.setRequestHeader(key,value)}})}return xhr.send(options.data)})}emitComplete(res){this.emit(_AsyncDataRequest.event.COMPLETE,{response:res.data,contentType:res.contentType,error:false})}emitCompleteWithError(errResponse){const msg=Util.isString(errResponse)?errResponse:null;const res=!msg?errResponse:null;this.emit(_AsyncDataRequest.event.COMPLETE,{status:res&&res.status,error:true,url:this.requestOptions.url||"not available",message:msg||this.getMsg((res==null?void 0:res.status)||0,(res==null?void 0:res.data)||null)})}getMsg(stat,errorData){let m=_AsyncDataRequest.statusMessages[""+stat];if(!m){m=Util.isString(errorData)?errorData:"Unspecified error"}return"XhrDataRequest error: "+m}};var AsyncDataRequest=_AsyncDataRequest;AsyncDataRequest.event={COMPLETE:"complete"};AsyncDataRequest.statusMessages={0:"Request failed; blocked or timed out",500:"Server error encountered.",404:"Resource not found.",403:"Access denied."};function request(options){if(options.query){options.url=QueryString.append(options.url,options.query)}return AsyncDataRequest.load(options).then(xhr=>xhr.response)}var WebVTTParser=class{static parseCaption(caption){let id=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;let style=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const parts=caption.trim().split("\n");const timecode=/([0-9:.]+)\s*-->\s*([0-9:.]+)([^\n]*)/;const setting=/\s*([A-Za-z]+)\s*:\s*([\w\-%]+)/g;try{if(!timecode.test(parts[0])){id=parseInt(parts.shift())}const times=parts[0].match(timecode).slice(1);const settings=times[2];const startTime=Util.hmsToSec(times[0]);const endTime=Util.hmsToSec(times[1]);const text=parts.slice(1).join("\n");if(settings!=null){settings.replace(setting,(match,key,value)=>style[key]=value)}return __spreadValues2({id:id,startTime:startTime,endTime:endTime,text:text},style)}catch(error){return null}}static parse(txt){txt=txt.replace(/\r/g,"");const captions=txt.split("\n\n");const ignore=/^(WEBVTT|NOTE|STYLE)/;const cues=captions.reduce((acc,caption)=>{if(!(ignore.test(caption)||!caption)){const cue=this.parseCaption(caption,acc.length);if(cue){acc.push(cue)}}return acc},[]);return cues}};var ThumbnailTrackSurface=class{constructor(url,cues){this.url=url;this.cues=cues}getCueAt(time){return this.cues.find(cue=>cue.startTime<=time&&cue.endTime>=time)}renderCueAt(time,container){ThumbnailTrackSurface.renderThumbnail(this.getCueAt(time),container)}static create(url){const a=document.createElement("a");a.href=url;const absolute=a.protocol+"//"+a.hostname;const relative=absolute+a.pathname.split("/").slice(0,-1).join("/")+"/";return request({url:url}).then(response=>{const cues=WebVTTParser.parse(response);cues.forEach(cue=>{const[file,params]=cue.text.split("#");let src=file;if(!/^(https?:)?\/\//.test(src)){if(/^\//.test(src)){src=absolute+src}else{src=relative+src}}const kv=params.split("=");const keys=kv[0];const values=kv[1].split(",");const style={backgroundImage:"url(".concat(src,")")};const data={url:src};Util.forEach(keys,(key,i)=>{const value=values[i];switch(key){case"w":data.width=parseInt(value);style.width="".concat(value,"px");break;case"h":data.height=parseInt(value);style.height="".concat(value,"px");break;case"x":data.x=parseInt(value);style.backgroundPositionX="-".concat(value,"px");break;case"y":data.y=parseInt(value);style.backgroundPositionY="-".concat(value,"px")}});cue.style=style;cue.data=data});return new ThumbnailTrackSurface(url,cues)})}static renderThumbnail(cue,container){if((cue==null?void 0:cue.style)&&(container==null?void 0:container.style)){Object.assign(container.style,cue.style)}}};var _ScriptLoader=class extends RecoveryEnabledRequest{static load(options){return new Promise((resolve,reject)=>{options.onComplete=_ref6=>{let{detail:detail}=_ref6;return detail.error||detail.timedOut?reject(detail):resolve(detail)};new _ScriptLoader(options)})}constructor(options){const opts=Object.assign({timeout:Network.TIMEOUT},options||{});if(!opts.timeout){opts.timeout=Network.TIMEOUT}super(opts);this.timeoutHandles={};this.map={};const hasListener=this.hasListenerFor(_ScriptLoader.event.COMPLETE);if(this.opts.url&&hasListener){this.loadScript(this.opts.url)}else if(this.opts.urls&&hasListener){this.loadScripts(this.opts.urls)}else{throw new Error("Script load error: Missing url or listener. url: ".concat(this.opts.url||this.opts.urls,", hasListener: ").concat(hasListener))}}destroy(){if(!this.timeoutHandles){return}for(const q in this.timeoutHandles){clearTimeout(this.timeoutHandles[q])}this.timeoutHandles=null;super.destroy()}loadScript(scriptUrl,completeListener){const scr=document.createElement("script"),sec=window.location.protocol==="https:",url=sec?scriptUrl.replace("http:","https:"):scriptUrl;this.map[url]={hLoad:()=>this.hLoadOrError(url),hError:()=>this.hLoadOrError(url,true,false),scriptEl:scr};const mapObj=this.map[url];completeListener&&this.on(_ScriptLoader.event.COMPLETE,completeListener);scr.async=true;scr.addEventListener("load",mapObj.hLoad);scr.addEventListener("error",mapObj.hError);this.timeoutHandles[url]=setTimeout(()=>this.hLoadOrError(url,true,true),this.opts.timeout);document.head.appendChild(scr);scr.src=url}loadScripts(urls,completeListener){completeListener&&this.on(_ScriptLoader.event.COMPLETE,completeListener);for(let i=0,n=urls.length;i<n;i++){this.loadScript(urls[i])}}hLoadOrError(url,error,timedOut){clearTimeout(this.timeoutHandles[url]);delete this.timeoutHandles[url];const mapObj=this.map[url];mapObj.scriptEl.removeEventListener("load",mapObj.hLoad);mapObj.scriptEl.removeEventListener("error",mapObj.hError);for(const q in mapObj){delete mapObj[q]}delete this.map[url];if(error&&this.shouldRetry()){this.incrementAttempts();setTimeout(()=>{this.loadScript(url)},this.retryInterval)}else{this.emit(_ScriptLoader.event.COMPLETE,{url:url,error:error,timedOut:timedOut===true})}}};var ScriptLoader=_ScriptLoader;ScriptLoader.event={COMPLETE:"complete"};var Browser=(Browser2=>{Browser2["ANDROID"]="Android";Browser2["CHROME"]="Chrome";Browser2["CHROME_IOS"]="Chrome-iOS";Browser2["FIREFOX"]="Firefox";Browser2["FIREFOX_IOS"]="Firefox-iOS";Browser2["EDGE"]="Edge";Browser2["MSIE"]="MSIE";Browser2["SAFARI"]="Safari";Browser2["OPERA"]="Opera";Browser2["OPERA_MOBILE"]="Opera-Mobile";Browser2["SILK"]="Silk";Browser2["PLAYSTATION_4_WEBMAF"]="PlayStation 4 (WebMAF)";Browser2["PLAYSTATION_5"]="PlayStation 5 (Media Source API)";Browser2["UNKNOWN"]="Unknown";return Browser2})(Browser||{});var isValid=value=>value!=null&&value!==""&&value!==false;var toHundred=value=>Math.round(value/100)*100;var toRounded=value=>Math.round(value);var toUrlSafe=value=>encodeURIComponent(value);var formatters={br:toHundred,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor:toUrlSafe,rtp:toHundred};function serialize(obj){return processData(obj,(value,key)=>{const type=typeof value;if(type==="symbol"){return"".concat(key,"=").concat(value.description)}else if(key==="ot"||key==="sf"||key==="st"){return"".concat(key,"=").concat(value)}else if(type==="boolean"){return key}else if(type==="number"){return"".concat(key,"=").concat(value)}else{return"".concat(key,"=").concat(JSON.stringify(value))}}).join(",")}function processData(obj,map){const results=[];if(!obj){return results}const keys=Object.keys(obj).sort();keys.forEach(key=>{let value=obj[key];if(!isValid(value)){return}if(key==="v"&&value===1){return}if(key==="pr"&&value===1){return}const formatter=formatters[key];if(formatter){value=formatter(value)}const result=map(value,key,obj);results.push(result)});return results}function toQuery(cmcd){if(!cmcd){return""}return"CMCD=".concat(encodeURIComponent(serialize(cmcd)))}function appendCmcdToUrl(url,cmcd){const query=toQuery(cmcd);if(!query){return url}const separator=url.includes("?")?"&":"?";return"".concat(url).concat(separator).concat(query)}var CMCD_VERSION=1;var import_screenfull=__toESM(require_screenfull(),1);var Device=(Device2=>{Device2["DESKTOP"]="Desktop";Device2["ANDROID_PHONE"]="Android Phone";Device2["WINDOWS_PHONE"]="Windows Phone";Device2["IPHONE"]="iPhone";Device2["IPOD"]="iPod";Device2["IPAD"]="iPad";Device2["KINDLE"]="Kindle";Device2["TABLET"]="Tablet";Device2["MOBILE"]="Mobile";Device2["EMBEDDED"]="Embedded";Device2["LG_SMART_TV"]="LG Smart Tv";Device2["VIZIO_SMART_TV"]="Vizio Smart Tv";Device2["SAMSUNG_SMART_TV"]="Samsung Smart Tv";Device2["COMCAST_X1"]="Comcast X1";Device2["XBOX_ONE"]="Xbox One";Device2["CHROMECAST"]="Chromecast";Device2["PLAYSTATION_4"]="PlayStation 4";Device2["PLAYSTATION_5"]="PlayStation 5";Device2["SKY_Q"]="Sky Q";Device2["UNKNOWN"]="UNKNOWN";return Device2})(Device||{});var Os=(Os2=>{Os2["OSX"]="OS X";Os2["WINDOWS"]="Windows";Os2["WINDOWS7"]="Windows 7";Os2["WINDOWS8"]="Windows 8";Os2["WINDOWS10"]="Windows 10";Os2["WINDOWS_VISTA"]="Windows Vista";Os2["WINDOWS_PHONE"]="Windows Phone";Os2["IOS"]="iOS";Os2["ANDROID"]="Android";Os2["CHROMIUM"]="Chromium";Os2["WEBOS"]="Web0S";Os2["SMARTCAST"]="SmartCast";Os2["TIZEN"]="Tizen";Os2["ORBIS"]="Orbis OS";Os2["PROSPERO"]="Prospero OS";Os2["UNKNOWN"]="Unknown";return Os2})(Os||{});var Platform=(Platform2=>{Platform2["MAC"]="Macintosh";Platform2["WINDOWS"]="Windows";Platform2["LINUX"]="Linux";Platform2["UNKNOWN"]="Unknown";return Platform2})(Platform||{});var codecs="; codecs=";var MediaTypes={video:{HLS:"application/vnd.apple.mpegurl",AVC:"video/mp4"+codecs+"avc1.4D401E,mp4a.40.2",HEVC:"video/mp4"+codecs+"hev1.1.2.L93.B0",WEBM_VP8:"video/webm"+codecs+"vp8, opus, vorbis",WEBM_VP9:"video/webm"+codecs+"vp9, opus, vorbis"},audio:{AVC:"audio/mp4"+codecs+"avc1.4D401E,mp4a.40.2",HEVC:"audio/mp4"+codecs+"hev1.1.2.L93.B0",WEBM_VP8:"audio/webm"+codecs+"vp8, opus, vorbis",WEBM_VP9:"audio/webm"+codecs+"vp9, opus, vorbis"}};function inspectSystem(global){if(!global){return{global:global}}const isLinux=(str,obj)=>{const regex=new RegExp("Linux","i");const uaData=navigator.userAgentData;const platform2=navigator.platform||(uaData==null?void 0:uaData.platform);const isArm=/Linux armv/.test(platform2);if(regex.test(str)||str.indexOf("Android")>=0){obj.platform="Linux";obj.device="UNKNOWN";if(str.indexOf("Chromium")>=0){const re=/Chromium\/([\d+\.]*)\s/;const test=re.exec(str);obj.os="Chromium";obj.osVersion=test&&test[1]||""}else if(str.indexOf("Android")>=0){const re=/ Android ([^\s]+);/;const test=re.exec(str);obj.os="Android";obj.osVersion=test&&test[1]||"";obj.device="Android Phone"}else if(str.indexOf("Web0S")>=0){obj.os="Web0S";obj.osVersion="n/a";obj.device="LG Smart Tv"}else if(str.indexOf("SmartCast")>=0){obj.os="SmartCast";obj.osVersion="n/a";obj.device="Vizio Smart Tv"}else if(str.indexOf("Tizen")>=0){const re=/Tizen ([^\s]+)(;|\))/;const test=re.exec(str);obj.os="Tizen";obj.osVersion=test&&test[1]||"";obj.device="Samsung Smart Tv"}else if(typeof $badger!=="undefined"||/ Xfinity/.test(str)||/ WPE/.test(str)){obj.os="Linux";obj.osVersion="n/a";obj.device="Comcast X1"}else if(str.indexOf("Sky")>=0){obj.os="Linux";obj.osVersion="n/a";obj.device="Sky Q"}else if(isArm){obj.os="Linux";obj.osVersion="n/a";obj.device="Embedded"}return true}return false};const isMac=(str,obj)=>{if(str.indexOf("Macintosh")>=0){obj.platform="Macintosh";const iPad=navigator.userAgent.match(/(iPad)/)||navigator.maxTouchPoints>1;if(iPad){obj.device="iPad";obj.os="iOS"}else if(str.indexOf("OS X")>=0){obj.device="Desktop";obj.os="OS X"}const test=/Mac OS X ([\d.]+)/.exec(str);obj.osVersion=test&&test[1]?test[1]:null;return true}else if(str.indexOf("like Mac OS X")!==-1){obj.platform="Macintosh";obj.os="iOS";obj.device="UNKNOWN";const re=/\sOS\s([^\s]*)\s/;const version=re.exec(str);if(version&&version[1]){obj.osVersion=version[1]}const devices=[/\(iPhone;/,/\(iPad;/,/\(iPod;/];const names=["iPhone","iPad","iPod"];let i=devices.length;while(i--){if(devices[i].test(str)){obj.device=names[i];return true}}return true}return false};const isWin=(ua2,obj)=>{let re=/(Windows Phone |Windows Phone OS )([^\s]+);/,reNt=/Windows NT ([^\s]+)[;\)]/,win=re.exec(ua2);if(win&&win[2]){obj.platform="Windows";obj.os="Windows Phone";obj.osVersion=win[2];obj.device="Windows Phone";return true}else{const test=reNt.exec(ua2);obj.device="Desktop";if(test&&test[1]){obj.platform="Windows";obj.os="Windows";const osVersionNbr=test[1];if(/Xbox; Xbox One/.test(ua2)){obj.device="Xbox One"}if(parseInt(osVersionNbr)===10){obj.os="Windows 10";obj.osVersion=osVersionNbr}else{switch(osVersionNbr){case"6.0":obj.os="Windows Vista";break;case"6.1":obj.os="Windows 7";obj.osVersion="7";break;case"6.2":obj.os="Windows 8";obj.osVersion="8";break}}return true}}return false};const getMsBrowser=(reEdge,reIe,ua2)=>{const tri=/Trident.[^\s]+;.*rv:([^\s]+)[);]/;if(reIe.test(ua2)){return{browser:"MSIE",re:reIe}}else if(reEdge.test(ua2)){return{browser:"Edge",re:reEdge}}else if(tri.test(ua2)){return{browser:"MSIE",re:tri}}return{browser:"Unknown",re:null}};const getSafariBrowser=(re,ua2,platformInfo2)=>{const test=re.test(ua2),browserName=platformInfo2.os==="Android"?"Android":"Safari";if(test&&platformInfo2.os!=="Unknown"){return browserName}return null};const getBrowser=(ua2,platformInfo2)=>{const re={["Chrome"]:/Chrome\/(\S+)/,["Chrome-iOS"]:/CriOS\/(\S+)/,["Firefox-iOS"]:/FxiOS\/(\S+)/,["Edge"]:/ Edge?\/([^\s]+)/,["Firefox"]:/Firefox\/(\S+)/,["Opera"]:/Opera|OPR\/(\S+)/,["Safari"]:/Version\/(\S+).*Safari/,["MSIE"]:/MSIE ([^\s]+)[);] Windows/,["Android"]:/Android/,["Silk"]:/Silk\/(\S+)/,["PlayStation 4 (WebMAF)"]:/Playstation 4 (WebMAF) (\S+)/,["PlayStation 5 (Media Source API)"]:/PlayStation 5/,["Unknown"]:null};const isChromeIos=re["Chrome-iOS"].test(ua2);const isChrome=(re["Chrome"].test(ua2)||isChromeIos)&&!re["Opera"].test(ua2)&&!re["Edge"].test(ua2);const assembleInfo=(bName,re2,ua3)=>{const browser2=re2&&re2.exec(ua3),out={browser:bName,browserVersion:"0",browserMajorVersion:0};if(browser2&&browser2.length&&browser2.length>1){out.browserVersion=browser2[1]||"";if(out.browserVersion.indexOf(".")){const ar=out.browserVersion.split(".");if(Array.isArray(ar)&&ar.length){const mv=parseInt(ar[0]);!isNaN(mv)&&(out.browserMajorVersion=mv)}}else{const mv=parseInt(out.browserVersion);!isNaN(mv)&&(out.browserMajorVersion=mv)}}return out};if(isChrome){const name=isChromeIos?"Chrome-iOS":"Chrome";return assembleInfo(name,re[name],ua2)}const b=getMsBrowser(re["Edge"],re["MSIE"],ua2);if(b.browser!=="Unknown"){return assembleInfo(b.browser,b.re,ua2)}for(const q in re){switch(q){case"Firefox":case"Firefox-iOS":case"Silk":case"Android":if(re[q].test(ua2)){if(q==="Silk"){platformInfo2.device="Kindle"}return assembleInfo(q,re[q],ua2)}break;case"PlayStation 4 (WebMAF)":case"PlayStation 5 (Media Source API)":if(re["PlayStation 5 (Media Source API)"].test(ua2)||re["PlayStation 4 (WebMAF)"].test(ua2)){const isPS5=re["PlayStation 5 (Media Source API)"].test(ua2);const browser2=isPS5?"PlayStation 5 (Media Source API)":"PlayStation 4 (WebMAF)";platformInfo2.device=isPS5?"PlayStation 5":"PlayStation 4";platformInfo2.platform=isPS5?"PlayStation 5":"PlayStation 4";platformInfo2.os=isPS5?"Prospero OS":"Orbis OS";return assembleInfo(browser2,re[browser2],ua2)}case"Safari":let b2=getSafariBrowser(re[q],ua2,platformInfo2);if(b2){return assembleInfo(q,re[q],ua2)}break;case"Opera":let test=re[q].exec(ua2);if(test){const browser2=test.indexOf("Opera Mini/")>=0||test.indexOf("Opera Mobi")>=0?"Opera-Mobile":"Opera";return assembleInfo(browser2,re[q],ua2)}break;case"Unknown":break}}return assembleInfo("Unknown",re["Unknown"],ua2)};const getPlatform=userAgent=>{const ual=userAgent.toLowerCase(),out={os:"Unknown",platform:"Unknown",osVersion:"",device:"UNKNOWN"};if(ual.indexOf("fxios")>=0){out.os="iOS";out.platform="Macintosh";if(ual.indexOf("iphone")>=0){out.device="iPhone"}else{out.device="iPad"}return out}if(ual.indexOf("crkey")>=0){out.platform="Linux";out.device="Chromecast";return out}const re=/\s(\([^)]+\))/,test=re.exec(userAgent);if(test&&test.length&&test.length>1){const pStr=test[1].replace(/_/gi,".");const tests=[(str,obj)=>isLinux(str,obj),(str,obj)=>isMac(str,obj),(str,obj)=>isWin(str,obj)];let i=tests.length;while(i--){const ti=tests[i];if(ti(i===0?userAgent:pStr,out)){break}}}return out};const parseVerStr=str=>{const out={majorVersion:null,minorVersion:null,versionString:str||null};if(str){const spl=str.split("."),mj=parseInt(spl[0],10),mn=parseInt(spl[1],10);!isNaN(mj)&&(out.majorVersion=mj);!isNaN(mn)&&(out.minorVersion=mn)}return out};const ua=navigator.userAgent;const platformInfo=getPlatform(ua);const browserInfo=getBrowser(ua,platformInfo);const{os:os,platform:platform,osVersion:osVersion,device:device}=platformInfo;const{browser:browser,browserVersion:browserVersion}=browserInfo;let osVersionInfo=null;let browserVersionInfo=null;if(osVersion&&Util.isString(osVersion)){osVersionInfo=parseVerStr(osVersion)}if(browserVersion&&Util.isString(browserVersion)){browserVersionInfo=parseVerStr(browserVersion)}const isTv=(()=>{switch(device){case"LG Smart Tv":case"Vizio Smart Tv":case"Samsung Smart Tv":case"Comcast X1":case"Sky Q":return true;default:return false}})();const isDesktop=device==="Desktop";const isConsole=(()=>{switch(device){case"PlayStation 4":case"PlayStation 5":case"Xbox One":return true;default:return false}})();const isWebkit=!!(global==null?void 0:global.WebKitMediaSource);const hasMediaSource=!!((global==null?void 0:global.MediaSource)||isWebkit);const isTypeSupported=codec=>{let supported=false;if(!global){return false}if(isWebkit){supported=global.WebKitMediaSource.isTypeSupported(codec)}else if(hasMediaSource){supported=global.MediaSource.isTypeSupported(codec)}if(!supported){const element=document.createElement("video");if(Util.isObject(element)&&Util.isFunction(element.canPlayType)){if(element.canPlayType(codec)==="probably"||element.canPlayType(codec)==="maybe"){supported=true}}}return supported};const hasVp8=isTypeSupported(MediaTypes.video.WEBM_VP8);const hasVp9=isTypeSupported(MediaTypes.video.WEBM_VP9);const supportsUnrestrictedAutoplay=isTv||isConsole;return{appNamespace:null,document:global==null?void 0:global.document,global:global,browser:browser,browserVersionInfo:browserVersionInfo,device:device,os:os,osVersionInfo:osVersionInfo,platform:platform,isAndroid:device==="Android Phone"||os==="Android",isChromecast:device==="Chromecast",isDesktop:isDesktop,isEmbedded:device==="Embedded",isIos:os==="iOS",isMobile:!isDesktop,isTizen:device==="Samsung Smart Tv",isTv:isTv,isConsole:isConsole,isWebkit:isWebkit,isWebMaf:!!(global==null?void 0:global["WM_videoPlayer"]),isWebOs:os==="Web0S",isXboxOne:device==="Xbox One",hasFullscreenApi:import_screenfull.default.isEnabled,hasMediaSource:hasMediaSource,hasEncryptedMediaSource:!!global&&!!(global.MediaKeys||global.WebKitMediaKeys||global.MSMediaKeys),supportsVp8:hasVp8,supportsVp9:hasVp9,supportsWebM:hasVp8||hasVp9,supportsMediaDecodeConfigurations:!!(navigator==null?void 0:navigator.mediaCapabilities),supportsNativeHls:isTypeSupported(MediaTypes.video.HLS),supportsRequestMediaKeySystemAccess:!!(global==null?void 0:global.MediaKeySystemAccess),supportsUnrestrictedAutoplay:supportsUnrestrictedAutoplay}}var System=inspectSystem(typeof window==="object"?window:null);var Utilities=class extends Util{static renderThumbnail(cue,container){ThumbnailTrackSurface.renderThumbnail(cue,container)}static request(options){return request(options)}static loadScript(options,playerOptions){const{overrides:overrides,networkTimeout:networkTimeout}=playerOptions||{};return ScriptLoader.load({url:System.isWebOs?Util.makeUrl(true,options.url):options.url,timeout:(overrides==null?void 0:overrides.streamingLibLoaderTimeout)||networkTimeout,errorRecovery:Util.merge({},playerOptions==null?void 0:playerOptions.networkErrorRecovery,options.errorRecovery)})}static loadSdk(getter,sdk,playerOptions){return __async2(this,null,(function*(){if(typeof sdk==="string"){try{if(!getter()){yield Utilities.loadScript({url:sdk},playerOptions)}}catch(error){}return getter()}return sdk}))}static smpteToVtt(url,textTrack){return __async2(this,null,(function*(){const xml=yield Utilities.request({url:url,responseType:"document"});const smpteCues=xml.querySelectorAll("tt body div p");if(!smpteCues.length){throw new Error("No cues found in ".concat(url))}const align=System.browser==="Safari"?"middle":"center";const lineOffset=System.browser==="Safari"?-1:0;const isVTTCueSupported=System.global.VTTCue!==void 0;const Cue=isVTTCueSupported?System.global.VTTCue:System.global.TextTrackCue;smpteCues.forEach((item,i,cues)=>{if(Utilities.isEmpty(item.textContent)){return}const text=item.textContent.replace(/(.*)<span.*tts:fontStyle="italic">(.*)<\/span>(.*)/g,"$1<i>$2</i>$3").replace(/(.*)<span.*tts:fontWeight="bold">(.*)<\/span>(.*)/g,"$1<b>$2</b>$3").replace(/(.*)<span.*tts:textDecoration="under">(.*)<\/span>(.*)/g,"$1<u>$2</u>$3");const lc=Utilities.getNumLines(text);item._lineCountPrev=item._lineCountPrev||0;item._lineCountNext=item._lineCountNext||0;let n=i+1;let nextItem=cues[n];const begin=item.getAttribute("begin");while((nextItem==null?void 0:nextItem.getAttribute("begin"))===begin){nextItem._lineCountPrev=lc+item._lineCountNext;item._lineCountNext+=Utilities.getNumLines(nextItem.textContent);nextItem=cues[++n]}const cue=new Cue(Utilities.hmsToSec(begin),Utilities.hmsToSec(item.getAttribute("end")),text);cue.align=item.getAttribute("tts:textAlign");if(isVTTCueSupported){const metadata=item.querySelector("metadata");if(metadata){cue.snapToLines=true;const col=parseInt(metadata.getAttribute("cccol"));const row=parseInt(metadata.getAttribute("ccrow"));const position=Math.round(col/35*100);cue.position=position;try{cue.align=position<45?"start":position>55?"end":align}catch(error){cue.align="center"}cue.positionAlign=position<45?"line-left":position>55?"line-right":"center";cue.line=row-17+lineOffset}}try{textTrack.addCue(cue)}catch(error){}})}))}static createSidecarTextTrack(resource,video){let language=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"en";let label=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"English";var _a;let url=(_a=resource.location)==null?void 0:_a.textTrackUrl;if(!url){return Promise.reject("Invalid text track url")}const isVtt=url.indexOf(".vtt")>=0;const{cmcd:cmcd}=resource;if(cmcd.enabled){url=appendCmcdToUrl(url,{ot:"c",su:true,sid:cmcd.sessionId,cid:cmcd.contentId,pr:video.playbackRate,v:CMCD_VERSION})}if(isVtt){const track=document.createElement("track");track.kind="captions";track.label=label;track.srclang=language;track.id="sidecar-vtt";track.src=url;video.appendChild(track);return Promise.resolve(track.track)}else{const track=video.addTextTrack("captions",label,language);return Utilities.smpteToVtt(url,track).then(()=>track)}}};var ErrorCode=(ErrorCode2=>{ErrorCode2["INVALID_RESOURCE_FORMAT"]="1000";ErrorCode2["RESOURCE_UNAVAILABLE"]="1100";ErrorCode2["GEO_LOCATION_BLOCKED"]="1101";ErrorCode2["DOMAIN_BLOCKED"]="1102";ErrorCode2["IP_BLOCKED"]="1103";ErrorCode2["SATELLITE_PROVIDER_BLOCKED"]="1104";ErrorCode2["EXPIRED"]="1105";ErrorCode2["SELECTOR_CALL_ERROR"]="1106";ErrorCode2["IMA_SDK_MISSING"]="1200";ErrorCode2["DAI_SDK_MISSING"]="1201";ErrorCode2["DASH_SDK_MISSING"]="1202";ErrorCode2["HLS_SDK_MISSING"]="1203";ErrorCode2["SHAKA_SDK_MISSING"]="1204";ErrorCode2["TWITCH_SDK_MISSING"]="1205";ErrorCode2["FW_SDK_MISSING"]="1206";ErrorCode2["HLSJS_PARSE_ERROR"]="2101";ErrorCode2["DASHJS_PARSE_ERROR"]="2102";ErrorCode2["SHAKA_PARSE_ERROR"]="2103";ErrorCode2["TWITCH_PARSE_ERROR"]="2104";ErrorCode2["WEBMAF_START_ERROR"]="2105";ErrorCode2["USER_GESTURE_REQUIRED"]="2300";ErrorCode2["HTML5_NETWORK_ERROR"]="3001";ErrorCode2["HLSJS_NETWORK_ERROR"]="3002";ErrorCode2["DASHJS_NETWORK_ERROR"]="3003";ErrorCode2["WEBMAF_NETWORK_ERROR"]="3004";ErrorCode2["SHAKA_NETWORK_ERROR"]="3005";ErrorCode2["TWITCH_NETWORK_ERROR"]="3006";ErrorCode2["MEDIA_ABORTED"]="3100";ErrorCode2["HTML5_SRC_NOT_SUPPORTED"]="3101";ErrorCode2["HLSJS_SRC_NOT_SUPPORTED"]="3102";ErrorCode2["DASHJS_SRC_NOT_SUPPORTED"]="3103";ErrorCode2["SHAKA_SRC_NOT_SUPPORTED"]="3105";ErrorCode2["TWITCH_SRC_NOT_SUPPORTED"]="3106";ErrorCode2["HTML5_MEDIA_ERROR"]="3200";ErrorCode2["HLSJS_MEDIA_ERROR"]="3201";ErrorCode2["HLSJS_MUX_ERROR"]="3202";ErrorCode2["DASHJS_MEDIA_ERROR"]="3203";ErrorCode2["SHAKA_MEDIA_ERROR"]="3205";ErrorCode2["TWITCH_MEDIA_ERROR"]="3206";ErrorCode2["FAIRPLAY_APP_CERT_ERROR"]="3300";ErrorCode2["FAIRPLAY_LIC_ERROR"]="3301";ErrorCode2["DASHJS_DRM_ERROR"]="3302";ErrorCode2["SHAKA_DRM_ERROR"]="3304";ErrorCode2["UNSPECIFIED_VIDEO_PLAYBACK_ERROR"]="3400";ErrorCode2["UNSPECIFIED_HLSJS_ERROR"]="3401";ErrorCode2["UNSPECIFIED_DASHJS_ERROR"]="3402";ErrorCode2["UNSPECIFIED_SHAKA_ERROR"]="3404";ErrorCode2["UNSPECIFIED_TWITCH_ERROR"]="3405";ErrorCode2["AD_STALLED"]="4000";ErrorCode2["IMA_INIT_FAILURE"]="4100";ErrorCode2["IMA_AD_ERROR"]="4101";ErrorCode2["DAI_DATA_ERROR"]="4200";ErrorCode2["DAI_NETWORK_ERROR"]="4201";ErrorCode2["AD_BLOCKING_DETECTED"]="4300";ErrorCode2["AD_ADAPTER_ERROR"]="4400";ErrorCode2["ADAPTER_NOT_FOUND"]="5000";ErrorCode2["UNEXPECTED_CONDITION"]="9999";return ErrorCode2})(ErrorCode||{});var QualityMode=(QualityMode2=>{QualityMode2["AUTO"]="auto";QualityMode2["MANUAL"]="manual";QualityMode2["UNAVAILABLE"]="unavailable";return QualityMode2})(QualityMode||{});var CoreError=class extends Error{constructor(message,cause){super(message);this.cause=cause}};var PlayerError=class extends CoreError{constructor(code,message,cause){let fatal=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;let category=arguments.length>4?arguments[4]:undefined;super(message,cause);this.code=code;this.fatal=fatal;this.category=category;this.name="PlayerError"}};function waitFor(milliseconds){return new Promise(resolve=>setTimeout(resolve,milliseconds))}function waitUntil(func){let interval=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;return new Promise((resolve,reject)=>{const i=setInterval(()=>{if(func()){clearInterval(i);resolve()}},interval)})}function waitForEvent(target,success){let fail=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"error";let timeout=arguments.length>3&&arguments[3]!==undefined?arguments[3]:NaN;if(typeof fail==="number"){timeout=fail}return new Promise((resolve,reject)=>{let timeoutId;const undo=[];const cleanUp=()=>undo.forEach(u=>u());const apply=(action,event)=>{const on=target.on?"on":"addEventListener";const off=target.off?"off":"removeEventListener";const complete=(e,d)=>{clearTimeout(timeoutId);cleanUp();action(d||e)};target[on](event,complete);undo.push(()=>target[off](event,complete))};apply(resolve,success);if(typeof fail==="string"){apply(reject,fail)}if(timeout>-1){timeoutId=setTimeout(()=>{cleanUp();reject(new Error("timeout"))},timeout)}})}function waitForTime(target,time,prop){if(!prop){prop=target instanceof HTMLVideoElement?"currentTime":"contentTime"}return waitUntil(()=>target[prop]>=time)}var VideoSurfaceEvents=(VideoSurfaceEvents2=>{VideoSurfaceEvents2["ABORT"]="abort";VideoSurfaceEvents2["CAN_PLAY"]="canplay";VideoSurfaceEvents2["CAN_PLAY_THROUGH"]="canplaythrough";VideoSurfaceEvents2["DURATION_CHANGE"]="durationchange";VideoSurfaceEvents2["ENDED"]="ended";VideoSurfaceEvents2["ERROR"]="error";VideoSurfaceEvents2["LOADED_METADATA"]="loadedmetadata";VideoSurfaceEvents2["LOAD_START"]="loadstart";VideoSurfaceEvents2["PAUSE"]="pause";VideoSurfaceEvents2["PLAY"]="play";VideoSurfaceEvents2["PLAYING"]="playing";VideoSurfaceEvents2["PROGRESS"]="progress";VideoSurfaceEvents2["RATE_CHANGE"]="ratechange";VideoSurfaceEvents2["SEEKED"]="seeked";VideoSurfaceEvents2["SEEKING"]="seeking";VideoSurfaceEvents2["STALLED"]="stalled";VideoSurfaceEvents2["TIME_UPDATE"]="timeupdate";VideoSurfaceEvents2["VOLUME_CHANGE"]="volumechange";return VideoSurfaceEvents2})(VideoSurfaceEvents||{});var TextTrackEvent=(TextTrackEvent2=>{TextTrackEvent2["CUE_CHANGE"]="cuechange";TextTrackEvent2["ADD_TRACK"]="addtrack";TextTrackEvent2["CHANGE"]="change";return TextTrackEvent2})(TextTrackEvent||{});var TextTrackMode=(TextTrackMode2=>{TextTrackMode2["SHOWING"]="showing";TextTrackMode2["HIDDEN"]="hidden";TextTrackMode2["DISABLED"]="disabled";return TextTrackMode2})(TextTrackMode||{});var WILDCARD="*";var _MetadataSurface=class{constructor(config2,onMetadataCuepoint){this.id3Map=[];this.daiId3=/^google_/;this.maxId3DedupeLength=_MetadataSurface.MAX_ID3_DEDUPE_LENGTH;this.onTextTrackAdded=_ref7=>{let{track:track}=_ref7;if(!this.isValidTrack(track)){return}track.mode="hidden";track.addEventListener("cuechange",this.onCueChange)};this.onCueChange=e=>{const t=e.target;const cues=t&&t.activeCues;if(!cues||!cues.length){return}Util.forEach(cues,cue=>this.processId3(cue))};this.onSeeking=()=>{this.clearId3()};var _a;this.onMetadataCuepoint=onMetadataCuepoint;this.video=config2.video;this.id3OwnerIds=["com.cbsi.live.sg"].concat(config2.resource.playback.id3OwnerIds||[]);const maxId3DedupeLength=(_a=config2.playerOptions.overrides)==null?void 0:_a.maxId3DedupeLength;if(maxId3DedupeLength!=null){this.maxId3DedupeLength=maxId3DedupeLength}this.addEvents();this.logger=config2.logger;this.logger.log("info","MetadataSurface created");Util.forEach(this.video.textTracks,track=>this.onTextTrackAdded({track:track}))}destroy(){this.onMetadataCuepoint=null;this.id3Map=null;this.removeEvents();Util.forEach(this.video.textTracks,t=>this.cleanupTrack(t))}addEvents(){this.video.textTracks.addEventListener("addtrack",this.onTextTrackAdded);this.video.addEventListener("seeking",this.onSeeking)}removeEvents(){this.video.textTracks.removeEventListener("addtrack",this.onTextTrackAdded);this.video.removeEventListener("seeking",this.onSeeking);Util.forEach(this.video.textTracks,t=>t.removeEventListener("cuechange",this.onCueChange))}clearId3(){this.id3Map=[]}cleanupTrack(track){if(track.kind!=="metadata"){return}function cleanupCue(cue){try{if(cue){track.removeCue(cue)}}catch(error){}}Util.forEachReverse(track.cues,cleanupCue);Util.forEachReverse(track.activeCues,cleanupCue)}processId3(cue){if(Util.isEmpty(cue.value)){return}const{value:value,startTime:startTime,endTime:endTime}=cue;const{key:key,info:info="",data:data}=value;const metadata={key:key,info:info,data:data,startTime:startTime,endTime:endTime};if(key==="TXXX"&&this.daiId3.test(data)){if(Util.isEmpty(info)){metadata.info=data}metadata.id="google_dai"}else{metadata.id=this.id3OwnerIds.find(id=>id===WILDCARD||info.includes(id))}if(!metadata.id){return}let text;try{text=data instanceof ArrayBuffer?Util.bufferToString(data):data}catch(error){text=""}if(key==="PRIV"&&this.id3OwnerIds[0]===info){metadata.data=text}metadata.text=text;const duplicate=this.id3Map.some(d=>d.info===metadata.info&&d.startTime===metadata.startTime&&d.text===metadata.text);if(duplicate){return}if(this.id3Map.length>this.maxId3DedupeLength){this.id3Map.pop()}this.id3Map.unshift(metadata);this.onMetadataCuepoint(metadata)}isMetadataTrack(type){return type==="metadata"}isExpired(track){return track.expired}isValidTrack(track){if(!track){return false}if(!this.isMetadataTrack(track.kind)){return false}if(this.isExpired(track)){return false}return true}};var MetadataSurface=_MetadataSurface;MetadataSurface.MAX_ID3_DEDUPE_LENGTH=32;var TextTrackSurface=class{constructor(config2,emit){this.pTextTracks=null;this.currentTextTrack=null;this.currentTextTrackMode="disabled";this.existingTrack=[];this.onVideoTextTrackAdded=e=>{const track=e.track;track.expired=false;this.onTextTrackAdded(e)};this.onTextTrackAdded=e=>{const track=e.track;const isEmpty=track.kind==="subtitles"&&!track.language&&!track.label;const isMetadata=track.kind==="metadata";if(isMetadata||isEmpty){return}this.addTracks()};this.onTextTrackChange=e=>{this.processTracks()};this.onCueChange=e=>{const track=e.target;switch(track.kind){case"captions":case"subtitles":const activeCues=Util.dedupeCues(track);this.emit("textCuepoint",{activeCues:activeCues});break}};this.config=config2;this.video=config2.video;this.pTextTracks=this.video.textTracks;this.currentTextTrackMode=config2.textTrackSettings.mode;this.emit=emit||(()=>{});this.processTracks=Util.debounce(this.processTracks.bind(this),100);this.addTracks=Util.debounce(this.addTracks.bind(this),25);this.addEvents();this.logger=config2.logger;this.logger.log("info","TextTrackSurface created");if(this.config.resource.location.textTrackUrl){Utilities.createSidecarTextTrack(this.config.resource,this.video)}}destroy(){this.emit=null;this.removeEvents();Util.forEach(this.pTextTracks,t=>this.cleanupTrack(t));Util.forEach(this.video.querySelectorAll("track"),element=>this.video.removeChild(element))}clearCue(){Util.clearCue(this.currentTextTrack,this.video.currentTime)}cleanupTrack(track){if(!this.isTextTrack(track.kind)){return}function cleanupCue(cue){try{if(cue){track.removeCue(cue)}}catch(error){}}Util.forEachReverse(track.cues,cleanupCue);Util.forEachReverse(track.activeCues,cleanupCue);track.expired=true;track.textTrack1=true;track.textTrack2=true;track.isTTML=true;track.isEmbedded=false;try{track.mode="disabled"}catch(error){}}set textTrackMode(mode){if(this.currentTextTrack){this.setTrackMode(mode)}else{this.logger.log("warn","No text track detected")}}set textTrack(newTrack){if(!this.isValidTrack(newTrack)||newTrack===this.currentTextTrack){return}if(this.currentTextTrack&&this.currentTextTrack.mode!=="disabled"){this.currentTextTrack.mode="disabled"}this.currentTextTrack=newTrack;this.setTrackMode(this.currentTextTrackMode).then(()=>{this.logger.log("info","".concat(newTrack.language," is being set as the current text track"));this.emit("textTrackChange",newTrack)})}get textTrack(){return this.currentTextTrack}get textTracks(){return Array.from(this.pTextTracks).filter(t=>this.isValidTrack(t))}setTrackMode(mode){return new Promise((resolve,reject)=>{const modeChanged=mode!==this.currentTextTrackMode;const applyMode=()=>{this.currentTextTrack.mode=mode;if(modeChanged){setTimeout(()=>this.emit("textTrackModeChange",{mode:mode}),0)}let msg="disabled";mode==="hidden"&&(msg="enabled for event driven external custom rendering");mode==="showing"&&(msg="enabled for native rendering by the user agent");this.logger.log("info","The ".concat(this.currentTextTrack.kind," track for language code ").concat(this.currentTextTrack.language," is being ").concat(msg," "));resolve()};this.currentTextTrackMode=mode;if(mode==="showing"&&this.currentTextTrack.mode==="disabled"){this.currentTextTrack.mode="hidden";setTimeout(applyMode,10)}else{applyMode()}})}addTrack(track){track.addEventListener("cuechange",this.onCueChange);this.logger.log("info","A ".concat(track.kind," text track was added"));this.emit("textTrackAdded",track)}addTracks(){Util.forEach(this.pTextTracks,t=>{const invalid=this.isExpired(t)||this.isDuplicateTrack(t);t.mode=!invalid?"hidden":"disabled";if(invalid){return}this.addTrack(t)});if(!this.currentTextTrack){this.textTrack=Util.findDefaultTrack(this.textTracks,this.config.textTrackSettings.language);if(!this.textTrack){return}this.textTrack.mode=this.config.textTrackSettings.mode;this.emit("textTrackAvailable")}this.processTracks()}processTracks(){const{enabled:enabled,native:native,enabledMode:enabledMode}=this.config.textTrackSettings;const tracks=this.textTracks;Util.forEach(this.pTextTracks,t=>{if(this.isExpired(t)&&t.mode!=="disabled"){t.mode="disabled"}});if(!native){if(enabled){const track2=tracks.find(t=>t.mode==="showing");if(track2){track2.mode=enabledMode}}else{const track2=tracks.find(t=>t.mode!=="disabled");if(track2){track2.mode="disabled"}}return}const track=tracks.find(t=>t.mode==="showing");if(enabled){if(track===this.currentTextTrack){return}if(!track){this.textTrackMode="disabled"}else{this.textTrack=track}}else{if(!track){return}if(track!==this.currentTextTrack){this.textTrack=track}this.textTrackMode="showing"}}addEvents(){this.pTextTracks.addEventListener("addtrack",this.onTextTrackAdded);this.pTextTracks.addEventListener("change",this.onTextTrackChange);this.video.addEventListener("addtrack",this.onVideoTextTrackAdded)}removeEvents(){this.pTextTracks.removeEventListener("addtrack",this.onTextTrackAdded);this.pTextTracks.removeEventListener("change",this.onTextTrackChange);this.video.removeEventListener("addtrack",this.onVideoTextTrackAdded);Util.forEach(this.pTextTracks,t=>t.removeEventListener("cuechange",this.onCueChange))}isDuplicateTrack(t){if(this.existingTrack.includes(t)){return false}const result=this.existingTrack.some(track=>t.language===track.language&&t.label===track.label&&t.kind===track.kind);if(!result){this.existingTrack.push(t)}return result}isTextTrack(type){return type==="captions"||type==="subtitles"}isExpired(track){return track.expired}isValidTrack(track){if(!track){return false}if(!this.isTextTrack(track.kind)){return false}if(this.isExpired(track)){return false}return true}};var PlaybackAdapterBase=class{constructor(context){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let useTextSurface=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;this.metadataLoaded=false;this.suppressErrors=false;this.multiCdnHeaderPresent=true;this.segmentDuration=6;this.pauseTime=NaN;this.eventsEnabled=false;this.liveStreamInfo={isPlayingLive:false,liveEdgeOffset:NaN,dvrWindowSize:NaN,safeSeekingDuration:NaN,safeSeekingTime:NaN,relativeTime:NaN,relativeDuration:NaN,absoluteStart:NaN,absoluteTime:NaN,absoluteDuration:NaN};this.lastKnownTimes={absolute:NaN,relative:NaN,end:NaN};this.textTrackInfo={track:null,tracks:[]};this.qualityInfo={quality:null,qualities:[],mode:"auto"};this.audioTrackInfo={track:null,tracks:[]};this.minBitrate=0;this.maxBitrate=Infinity;this.onVideoEvent=event=>{if(!this.eventsEnabled){return}const{delegate:delegate}=this;if(event.type==="loadedmetadata"){this.metadataLoaded=true}if(!this.metadataLoaded&&event.type!=="durationchange"){return}switch(event.type){case"timeupdate":delegate.timeUpdate();break;case"playing":delegate.playing();break;case"pause":if(this.metadataLoaded){delegate.paused()}break;case"seeking":delegate.seeking();break;case"seeked":delegate.seeked();break;case"ended":delegate.ended();break;case"durationchange":delegate.durationChange();break;case"volumechange":delegate.volumeChange(this.video.volume,this.video.muted);break;case"error":if(!this.suppressErrors){this.error(this.createVideoElementError())}break}};this.onTextEvent=(type,data)=>{if(!this.eventsEnabled){return}const{delegate:delegate}=this;switch(type){case"textCuepoint":delegate.textCuepoints(data.activeCues);break;case"textTrackModeChange":delegate.textTrackDisplayModeChange(data.mode);break;case"textTrackAdded":this.textTrackInfo.tracks.push({id:this.textTrackInfo.tracks.length.toString(),kind:data.kind,language:data.language,label:data.label||data.language});break;case"textTrackAvailable":delegate.textTracksChange(this.textTrackInfo.tracks);break;case"textTrackChange":const track=this.textTrackInfo.tracks.find(track2=>data.language===track2.language&&data.kind===track2.kind&&(data.label===track2.label||data.language===track2.label));this.textTrackInfo.track=track;delegate.textTrackChange(track);break}};this.context=context;this.options=options;this.video=context.video;this.delegate=this.context.getDelegate();this.logger=context.logger;this.metadataSurface=this.createMetadataSurface();if(useTextSurface){this.textTrackSurface=this.createTextTrackSurface()}Utilities.values(VideoSurfaceEvents).forEach(type=>this.video.addEventListener(type,this.onVideoEvent))}static canPlay(context,mimeTypes){const{avia:avia,resource:resource}=context;const systemInfo=avia.getSystemInfo();const mimeType=Utilities.getResourceMimeType(resource);const validMimeType=mimeTypes.includes(mimeType);return systemInfo.hasMediaSource&&validMimeType}destroy(){var _a,_b;Utilities.values(VideoSurfaceEvents).forEach(type=>this.video.removeEventListener(type,this.onVideoEvent));(_a=this.metadataSurface)==null?void 0:_a.destroy();this.metadataSurface=null;(_b=this.textTrackSurface)==null?void 0:_b.destroy();this.textTrackSurface=null;this.context=null;this.options=null;this.delegate=null;this.logger=null;this.video=null;return Promise.resolve()}getIsLiveStream(){return this.video.duration===Infinity}setAutoQualitySwitching(auto){throw new Error("setAutoQualitySwitching Method not implemented.")}setQuality(quality){throw new Error("setQuality Method not implemented.")}setMinBitrate(value){this.minBitrate=value}setMaxBitrate(value){this.maxBitrate=value}setTextTrack(track){if(!this.textTrackSurface){return}this.textTrackSurface.textTrack=track}setTextTrackMode(mode){if(!this.textTrackSurface){return}this.textTrackSurface.textTrackMode=mode}setAudioTrack(track){throw new Error("setAudioTrack Method not implemented.")}getId(){throw new Error("getId Method not implemented.")}getCurrentTime(){const{start:start,end:end}=this.getSeekable();const time=Utilities.mapToRange(this.video.currentTime,start,end,0,this.getDuration());return time}getDuration(){const{start:start,end:end}=this.getSeekable();return end-start}getBufferLength(){const{buffered:buffered,currentTime:currentTime}=this.video;if(buffered.length>0){return buffered.end(buffered.length-1)-currentTime}return 0}getLiveStreamInfo(){var _a;const details=this.liveStreamInfo;const{start:start,end:end}=this.getSeekable();const time=this.video.currentTime;const duration=end-start;const segmentDuration=this.getSegmentDuration();const count=this.context.resource.playback.liveEdgeSyncFragmentCount;const safeSeekDuration=((_a=this.context.resource.overrides)==null?void 0:_a.safeSeekDuration)||segmentDuration;details.relativeTime=Math.max(time-start,0);details.relativeDuration=duration;details.absoluteDuration=Date.now();details.dvrWindowSize=Math.floor(duration);details.liveEdgeOffset=segmentDuration*count+segmentDuration;details.safeSeekingTime=Math.ceil(start+safeSeekDuration);details.safeSeekingDuration=Math.floor(end-safeSeekDuration);details.isPlayingLive=Math.ceil(time+details.liveEdgeOffset)>=details.safeSeekingDuration;if(end!==this.lastKnownTimes.end){this.lastKnownTimes.end=end;details.absoluteStart=details.absoluteDuration-duration*1e3;this.lastKnownTimes.absolute=Math.round(details.absoluteStart+details.relativeTime*1e3);this.lastKnownTimes.relative=time}const delta=Math.round((time-this.lastKnownTimes.relative)*1e3);details.absoluteTime=this.lastKnownTimes.absolute+delta;return details}load(){this.enableSurfaceEvents(true);this.suppressErrors=true;return Promise.resolve()}play(){if(!isNaN(this.pauseTime)){if(this.pauseTime<this.liveStreamInfo.absoluteStart){const edge=this.getSeekable().start+1;this.logger.log("info","Playhead outside of DVR window bounds. Moving to ".concat(edge));this.seek(edge)}this.pauseTime=NaN}return Promise.resolve(this.video.play())}pause(){var _a;if(this.getIsLiveStream()&&((_a=this.context.resource.overrides)==null?void 0:_a.clearOutOfBoundsDvrBuffer)===true){this.pauseTime=this.liveStreamInfo.absoluteTime}this.video.pause()}suspend(){}resume(){}seek(position){const{start:start,end:end}=this.getSeekable();const time=Utilities.mapToRange(position,0,end-start,start,end);this.video.currentTime=time;return waitForEvent(this.video,"seeked")}resize(){}clearText(){var _a;(_a=this.textTrackSurface)==null?void 0:_a.clearCue()}getMetrics(){const{video:video}=this;const result={bandwidth:NaN,framerate:NaN,droppedVideoFrames:Number.NaN,totalVideoFrames:Number.NaN};if("getVideoPlaybackQuality"in video){Object.assign(result,video.getVideoPlaybackQuality())}else if("webkitDroppedFrameCount"in video&&"webkitDecodedFrameCount"in video){result.droppedVideoFrames=video.webkitDroppedFrameCount;result.totalVideoFrames=video.webkitDroppedFrameCount+video.webkitDecodedFrameCount}const frames=video.webkitDecodedFrameCount||video.mozPresentedFrames;if(frames){result.framerate=frames/video.currentTime}return result}createMetadataSurface(){return new MetadataSurface(this.context,this.delegate.metadataCuepoint)}createTextTrackSurface(){return new TextTrackSurface(this.context,this.onTextEvent)}enableSurfaceEvents(enabled){this.eventsEnabled=true}addEvents(adapter,map){const action=Utilities.isFunction(adapter.on)?"on":"addEventListener";Utilities.entries(map).forEach(entry=>adapter[action](entry[0],entry[1]))}removeEvents(adapter,map){const action=Utilities.isFunction(adapter.off)?"off":"removeEventListener";Utilities.entries(map).forEach(entry=>{var _a,_b;(_b=(_a=entry[1]).cancel)==null?void 0:_b.call(_a);adapter[action](entry[0],entry[1])})}createVideoElementError(){const error=this.video.error;let message=Object.keys(MediaError)[error.code-1]||AppResources.messages.UNSPECIFIED_ERROR;let code="3400";switch(error.code){case MediaError.MEDIA_ERR_ABORTED:message=error.toString();code="3100";break;case MediaError.MEDIA_ERR_NETWORK:code="3001";break;case MediaError.MEDIA_ERR_DECODE:code="3200";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:code="3101";break;default:code="3400"}return{code:code,message:message,data:error,fatal:true}}getSegmentDuration(){return this.segmentDuration}getSeekable(){const result={start:0,end:0};const range=this.video.seekable;const index=range.length-1;if(index>=0){result.start=range.start(index);result.end=range.end(index)}return result}getErrorMessage(msg,isFatal){let retry=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"n/a";return"".concat(msg," fatal: ").concat(isFatal," retry: ").concat(retry)}createError(code,message,cause){let fatal=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;return new PlayerError(code,message,cause,fatal)}throwError(code,message,cause){let fatal=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;this.error(this.createError(code,message,cause,fatal))}error(error){this.logger.log("error",error.message);this.delegate.error(error)}start(time){return __async2(this,null,(function*(){return waitForEvent(this.video,"loadedmetadata").then(()=>{if(!time){return void 0}return this.seek(time)})}))}createSidecarTextTrack(){var _a;const{resource:resource,video:video}=this.context;if(!((_a=resource.location)==null?void 0:_a.textTrackUrl)){return}Utilities.createSidecarTextTrack(resource,video)}updateQualities(qualities){qualities.sort((a,b)=>a.bitrate-b.bitrate);const min=Utilities.getIndexForBitrate(qualities,this.minBitrate,true);const max=Utilities.getIndexForBitrate(qualities,this.maxBitrate,false);this.qualityInfo.qualities=qualities.slice(min,max+1);this.delegate.qualitiesChange(this.qualityInfo.qualities)}};var Metric=class{constructor(key,value,type){this.key=key;this.value=value;this.type=type;this.timeStamp=Date.now()}};var buildInfo=Object.freeze({env:"__ENV__",playerVersion:"2.1.2",playerName:"@cbsinteractive/avia-js",buildTime:"2022-04-05T20:30:09.783Z"});var avia_react_esm_ActiveState=(ActiveState2=>{ActiveState2["ACTIVE"]="active";ActiveState2["INACTIVE"]="inactive";ActiveState2["IDLE"]="idle";return ActiveState2})(avia_react_esm_ActiveState||{});var AdapterRole=(AdapterRole2=>{AdapterRole2["AD"]="ad";AdapterRole2["PLAYBACK"]="playback";return AdapterRole2})(AdapterRole||{});var AdBreakType=(AdBreakType2=>{AdBreakType2["PRE"]="PRE";AdBreakType2["MID"]="MID";AdBreakType2["POST"]="POST";return AdBreakType2})(AdBreakType||{});var AdContext=(AdContext2=>{AdContext2["IMA"]="ima";AdContext2["IMA_AD_ONLY"]="ima_ad_only";AdContext2["DAI_SDK"]="dai_sdk";AdContext2["DAI_API"]="dai_api";AdContext2["DAI_SSB"]="dai_ssb";AdContext2["NONE"]="";return AdContext2})(AdContext||{});var AdTechnology=(AdTechnology2=>{AdTechnology2["SSAI"]="ssai";AdTechnology2["CSAI"]="csai";return AdTechnology2})(AdTechnology||{});var ApiMetric=(ApiMetric2=>{ApiMetric2["PLAY"]="play";ApiMetric2["PAUSE"]="pause";ApiMetric2["SEEK"]="seek";ApiMetric2["GO_LIVE"]="go_live";return ApiMetric2})(ApiMetric||{});var AudioTrackType=(AudioTrackType2=>{AudioTrackType2["MAIN"]="main";AudioTrackType2["DESCRIPTION"]="description";return AudioTrackType2})(AudioTrackType||{});var Autoplay=(Autoplay2=>{Autoplay2["NONE"]="none";Autoplay2["ATTEMPT_MUTED"]="attemptMuted";Autoplay2["ATTEMPT_UNMUTED"]="attemptUnmuted";Autoplay2["ATTEMPT_UNMUTED_THEN_MUTED"]="attemptUnmutedThenMuted";return Autoplay2})(Autoplay||{});var ErrorCategory=(ErrorCategory2=>{ErrorCategory2["AD"]="Ad";ErrorCategory2["RESOURCE"]="Resource";ErrorCategory2["PLAYBACK"]="Playback";ErrorCategory2["VIDEO_START"]="Video start";return ErrorCategory2})(ErrorCategory||{});var Header=(Header2=>{Header2["MULTI_CDN"]="x-cdn";return Header2})(Header||{});var HookType=(HookType2=>{HookType2["EVENT"]="event";HookType2["AD_BREAK"]="adbreak";HookType2["AD"]="ad";HookType2["ATTACH_RESOURCE"]="attachresource";return HookType2})(HookType||{});var HTML5="html5";var KeyboardScope=(KeyboardScope2=>{KeyboardScope2["NONE"]="none";KeyboardScope2["DOCUMENT"]="document";KeyboardScope2["PLAYER"]="player";return KeyboardScope2})(KeyboardScope||{});var LocalizationId=(LocalizationId2=>{LocalizationId2["MEDIA_PLAYER"]="media-player";LocalizationId2["LEARN_MORE"]="learn-more";return LocalizationId2})(LocalizationId||{});var LocalizedLanguage=(LocalizedLanguage2=>{LocalizedLanguage2["EN"]="English";LocalizedLanguage2["ES"]="Español";LocalizedLanguage2["FR"]="Français";LocalizedLanguage2["PT"]="Português";LocalizedLanguage2["DE"]="Deutsche";LocalizedLanguage2["PL"]="Polski";LocalizedLanguage2["JA"]="日本人";LocalizedLanguage2["KO"]="한국어";LocalizedLanguage2["ZH"]="简体中文";LocalizedLanguage2["IT"]="Italiano";LocalizedLanguage2["RU"]="Русский";return LocalizedLanguage2})(LocalizedLanguage||{});var MetricType=(MetricType2=>{MetricType2["API"]="api";MetricType2["UI"]="ui";return MetricType2})(MetricType||{});var PerformanceMode=(PerformanceMode2=>{PerformanceMode2["AUTO"]="auto";PerformanceMode2["DESKTOP"]="desktop";PerformanceMode2["MOBILE"]="mobile";PerformanceMode2["TV"]="tv";PerformanceMode2["LOW"]="LOW";return PerformanceMode2})(PerformanceMode||{});var avia_react_esm_PlaybackState=(PlaybackState2=>{PlaybackState2["IDLE"]="idle";PlaybackState2["STOPPED"]="stopped";PlaybackState2["PLAYING"]="playing";PlaybackState2["PAUSED"]="paused";PlaybackState2["WAITING"]="waiting";return PlaybackState2})(avia_react_esm_PlaybackState||{});var PluginPriority=(PluginPriority2=>{PluginPriority2["LOW"]="low";PluginPriority2["HIGH"]="high";return PluginPriority2})(PluginPriority||{});var QualityCategory=(QualityCategory2=>{QualityCategory2["SD"]="SD";QualityCategory2["HD"]="HD";QualityCategory2["UHD"]="UHD";QualityCategory2["UHD_4K"]="UHD 4K";QualityCategory2["UHD_8K"]="UHD 8K";return QualityCategory2})(QualityCategory||{});var QualityLabel=(QualityLabel2=>{QualityLabel2[QualityLabel2["DEFINITION"]=0]="DEFINITION";QualityLabel2[QualityLabel2["HEIGHT"]=1]="HEIGHT";QualityLabel2[QualityLabel2["BITRATE"]=2]="BITRATE";QualityLabel2[QualityLabel2["CUSTOM"]=3]="CUSTOM";return QualityLabel2})(QualityLabel||{});var StreamType=(StreamType2=>{StreamType2["VOD"]="VOD";StreamType2["LIVE"]="LIVE";StreamType2["DVR"]="DVR";return StreamType2})(StreamType||{});var UiMetric=(UiMetric2=>{UiMetric2["SEEK_BY"]="seek_by";return UiMetric2})(UiMetric||{});var VideoFormat=(VideoFormat2=>{VideoFormat2["HLS"]="hls";VideoFormat2["DASH"]="dash";VideoFormat2["MP4"]="mp4";VideoFormat2["UNKNOWN"]="unknown";return VideoFormat2})(VideoFormat||{});var HookError=class extends CoreError{constructor(type,message,cause){super("(".concat(type,"): ").concat(message),cause);this.type=type;this.name="HookError"}};var avia_react_esm_PlayerEvent=(PlayerEvent2=>{PlayerEvent2["HOTKEY_ACTION"]="hotkeyaction";PlayerEvent2["READY"]="ready";PlayerEvent2["AD_CUEPOINTS_AVAILABLE"]="adcuepointsavailable";PlayerEvent2["AD_BREAK_START"]="adbreakstart";PlayerEvent2["AD_BREAK_METADATA"]="adbreakmetadata";PlayerEvent2["AD_BREAK_COMPLETE"]="adbreakcomplete";PlayerEvent2["AD_START"]="adstart";PlayerEvent2["AD_COMPLETE"]="adcomplete";PlayerEvent2["AD_FIRST_QUARTILE"]="adfirstquartile";PlayerEvent2["AD_MIDPOINT"]="admidpoint";PlayerEvent2["AD_THIRD_QUARTILE"]="adthirdquartile";PlayerEvent2["AD_SEGMENT_START"]="adsegmentstart";PlayerEvent2["AD_SEGMENT_END"]="adsegmentend";PlayerEvent2["AD_SKIPPED"]="adskipped";PlayerEvent2["AD_PROGRESS"]="adprogress";PlayerEvent2["AD_PAUSED"]="adpaused";PlayerEvent2["AD_PLAYING"]="adplaying";PlayerEvent2["AD_STALLED"]="adstalled";PlayerEvent2["AD_BREAK_DISCARDED"]="adbreakdiscarded";PlayerEvent2["AD_CLICK"]="ad-click";PlayerEvent2["AUDIO_TRACK_INFO_CHANGE"]="audiotrackinfochange";PlayerEvent2["AUDIO_TRACK_CHANGE"]="audiotrackchange";PlayerEvent2["QUALITY_CHANGE"]="qualitychange";PlayerEvent2["QUALITY_INFO_CHANGE"]="qualityinfochange";PlayerEvent2["CDN_CHANGE"]="cdnchange";PlayerEvent2["CONTENT_START"]="contentstart";PlayerEvent2["CONTENT_DURATION_AVAILABLE"]="contentdurationavailable";PlayerEvent2["CONTENT_SEGMENT_START"]="contentsegmentstart";PlayerEvent2["CONTENT_PLAYING"]="contentplaying";PlayerEvent2["CONTENT_PROGRESS"]="contentprogress";PlayerEvent2["CONTENT_PAUSED"]="contentpaused";PlayerEvent2["CONTENT_SEGMENT_END"]="contentsegmentend";PlayerEvent2["CONTENT_COMPLETE"]="contentcomplete";PlayerEvent2["CONTENT_IS_PLAYING_LIVE"]="contentisplayinglive";PlayerEvent2["STREAM_TYPE_CHANGE"]="streamtypechange";PlayerEvent2["STREAM_METADATA"]="streammetadata";PlayerEvent2["STREAM_ID_AVAILABLE"]="streamidavailable";PlayerEvent2["DRM_KEY_SYSTEM_CREATED"]="drmkeysystemcreated";PlayerEvent2["ERROR"]="error";PlayerEvent2["PLAYBACK_SUSPENDED"]="playbacksuspended";PlayerEvent2["PLAYBACK_RESUMED"]="playbackresumed";PlayerEvent2["RESOURCE_START"]="resourcestart";PlayerEvent2["RESOURCE_END"]="resourceend";PlayerEvent2["RESOURCE_BUFFERING"]="resourcebuffering";PlayerEvent2["SEEK_COMPLETE"]="seekcomplete";PlayerEvent2["SEEK_START"]="seekstart";PlayerEvent2["SEEK_REDIRECT_START"]="seekredirectstart";PlayerEvent2["SEEK_REDIRECT_COMPLETE"]="seekredirectcomplete";PlayerEvent2["METADATA_CUEPOINT"]="metadatacuepoint";PlayerEvent2["TEXT_CUEPOINT"]="textcuepoint";PlayerEvent2["TEXT_TRACK_CHANGE"]="texttrackchange";PlayerEvent2["TEXT_TRACK_INFO_CHANGE"]="texttrackinfochange";PlayerEvent2["TEXT_TRACK_ENABLED_CHANGE"]="texttrackenabledchange";PlayerEvent2["TEXT_TRACK_AVAILABLE"]="texttrackavailable";PlayerEvent2["THUMBNAIL_TRACK_AVAILABLE"]="thumbnailtrackavailable";PlayerEvent2["LIVE_PRESENTATION_STOPPED"]="livepresentationstopped";PlayerEvent2["PRESENTATION_SIZE_CHANGE"]="presentationsizechange";PlayerEvent2["FULLSCREEN_CHANGE"]="fullscreenchange";PlayerEvent2["LOG_EVENT"]="logevent";PlayerEvent2["PLUGIN_EVENT"]="pluginevent";PlayerEvent2["LANGUAGE_CHANGE"]="languagechange";PlayerEvent2["AUTOPLAY_BLOCKED"]="autoplayblocked";PlayerEvent2["VOLUME_CHANGE"]="volumechange";PlayerEvent2["MUTE_CHANGE"]="mutechange";PlayerEvent2["ACTIVE_STATE_CHANGE"]="activestatechange";PlayerEvent2["PLAYBACK_STATE_CHANGE"]="playbackstatechange";PlayerEvent2["METRIC"]="metric";PlayerEvent2["VIDEO_ELEMENT_ADDED"]="videoelementadded";PlayerEvent2["VIDEO_ELEMENT_REMOVED"]="videoelementremoved";return PlayerEvent2})(avia_react_esm_PlayerEvent||{});var DrmType=(DrmType2=>{DrmType2["WIDEVINE"]="com.widevine.alpha";DrmType2["PLAYREADY"]="com.microsoft.playready";DrmType2["CLEAR_KEY"]="org.w3.clearkey";DrmType2["FAIRPLAY_1_0"]="com.apple.fps.1_0";return DrmType2})(DrmType||{});var _Timer=class extends Emitter{constructor(){let pInterval=arguments.length>0&&arguments[0]!==undefined?arguments[0]:250;super({});this.timer=NaN;this.pCount=0;this.pInterval=pInterval}destroy(){this.stop();super.destroy()}start(){if(this.running){return}this.timer=setInterval(()=>{this.pCount++;this.emit(_Timer.TIC_EVENT,{count:this.pCount})},this.pInterval)}stop(){clearInterval(this.timer);this.timer=NaN;this.pCount=0}