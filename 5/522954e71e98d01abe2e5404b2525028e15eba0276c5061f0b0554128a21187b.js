!function(e){function t(t){for(var o,s,r=t[0],c=t[1],u=t[2],d=0,h=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(l&&l(t);h.length;)h.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,r=1;r<n.length;r++){var c=n[r];0!==i[c]&&(o=!1)}o&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={1:0},a=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var l=c;a.push(["Fih6",0]),n()}({Fih6:function(e,t,n){"use strict";n.r(t),n.d(t,"browserStorage",(function(){return Bh})),n.d(t,"browserSessionStorage",(function(){return Ph})),n.d(t,"initializeChatSDKiFrame",(function(){return xh}));var o=n("P2sY"),i=n.n(o),a=(n("201c"),n("q1tI")),s=n.n(a),r=n("i8i4"),c=n.n(r),u=n("sINF"),l=n("ANjH"),d=n("/MKj"),h=n("8ckN"),p=n("GQeE"),E=n.n(p),m=n("gDS+"),g=n.n(m),S=n("iCc5"),f=n.n(S),C=n("V7oC"),v=n.n(C),T=n("YEIV"),_=n.n(T),I=n("QbLZ"),N=n.n(I),A=n("EJiy"),y=n.n(A),b=n("m1cH"),R=n.n(b),O="ASAPP-ClientDevice",M="ASAPP-ClientType",k="ASAPP-ClientVersion",w="ASAPP-CompanyMarker",D="ASAPP-PartnerAppVersion",L="ASAPP-RegionCode",B="Accept Cobrowsing",P="Cobrowsing Session Continue",H="Dock chat",U="Drag event",F="Hide Chat",V="iFrame Loaded",x="Initiate Cobrowsing",G={ACTION:"JS API: Action",SEND:"JS API: Send"},q="Post Hostpage Metrics",W="Push Browser Notification",K="Redirect Link Action",j="Request Cobrowsing UserId",Q="Request Context",Y="Request Notification Permission",Z="Request Login",$="Request Proactive Message",z="Send Initial Data",X="Set Cobrowsing Timestamp",J="Set Context",ee="Set Customer",te="Set Error",ne="Set Host Settings",oe="Set Screen Size",ie="Set isLiveChat",ae="Show Chat",se="Toggle Chat Instead",re="Show SMS Form",ce="Show Proactive Message",ue=" Update Host Location",le="Request Notification Permission",de="Unmount IFrame",he={AUTH_SESSION:"auth.session",BLOCKER:"blocker",CHAT:"chat",CHATINSTEAD:"chatinstead",CHATINSTEAD_ABC:"chatinstead.abc",CHATINSTEAD_GBM:"chatinstead.gbm",CHATINSTEAD_GETCHANNELSETTINGS:"chatinstead.getchannelsettings",CHATINSTEAD_PHONE:"chatinstead.phone",CHATINSTEAD_SMS:"chatinstead.sms",CHATINSTEAD_WEB:"chatinstead.web",CHAT_CONNECT:"chat.connect",CHAT_OPEN_INTERACTION:"chat.open.interaction",CONVERSATION_END:"conversation.end",CONVERSATION_FLOW:"conversation.flow",CONVERSATION_PENDING_MESSAGE:"conversation.pending.message",CONVERSATION_PENDING_MESSAGE_RETRY:"conversation.pending.message.retry",CONVERSATION_UNREADINDICATOR:"conversation.unreadindicator",ENTER_CHAT:"enterchat",EWT:"ewt",EWT_LEAVE:"ewt.leave",EWT_LEAVE_CONFIRM:"ewt.leave.confirm",SENDTEXT_LIVE:"conversation.sendtext.live",SMS_VERIFICATION_CHECK:"sms.verificationcheck",SMS_VERIFICATION_CHECK_FORM:"sms.verificationcheck.form",SMS_VERIFICATION_START:"sms.verificationstart",SMS_VERIFICATION_START_FORM:"sms.verificationstart.form",SOCKET:"websocket",SOCKET_OVERALL:"websocket.overall",SOCKET_URL:"websocket.url",WEB_API_ACTION_OFF:"web.api.action.off",WEB_API_ACTION_ON:"web.api.action.on",WEB_API_GETSTATE:"web.api.getstate",WEB_API_HIDE:"web.api.hide",WEB_API_SEND:"web.api.send",WEB_API_SET:"web.api.set",WEB_API_SHOW:"web.api.show",WEB_API_SHOWCHATINSTEAD:"web.api.showchatinstead",WEB_API_UNLOAD:"web.api.unload",WEB_NOTIFICATION:"web.notification",WEB_NOTIFICATION_PERMISSION:"web.notification.permission",WEB_NOTIFICATION_PERMISSION_CONFIRM:"web.notification.permission.confirm"},pe={ACCEPT:"accept",CALLED:"called",CANCEL:"cancel",CHECKED:"checked",CONFIRMED:"confirmed",CONNECT_DURATION:"connect.duration",CONNECT_FAILURE:"connect.failure",CONNECT_START:"connect.start",CONNECT_SUCCESS:"connect.success",DISCONNECT:"disconnect",DISMISS:"dismiss",DISPLAY:"display",FAILURE:"failure",HIDE:"hide",INDICATOR:"indicator",OPEN:"open",OPPORTUNITY:"opportunity",READY_DURATION:"ready.duration",REJECT:"reject",REQUEST_DURATION:"request.duration",REQUEST_FAILURE:"request.failure",REQUEST_START:"request.start",REQUEST_SUCCESS:"request.success",SELECT:"select",STUCK:"stuck",SUCCESS_DURATION:"success.duration"},Ee={COUNT:"count",DEVICE_TYPE:"device_type",DISPLAYING_INDICATOR:"was_displaying_indicator",IS_LIVE:"is_live",STATUS:"status",WITH_CUSTOMER_ID:"with_customer_credentials"},me={UI_MESSAGE_ID:"ui_message_id",UNREAD_MESSAGES_COUNT:"unread_messages_count"},ge="Accept",Se="Decline",fe="End Session",Ce="Continue Session",ve="Authentication Error",Te="Browser Storage Access Error",_e="Component error",Ie="Connection Error",Ne="Expired Credentials Error",Ae="Dragging start",ye="Dragging move",be="Dragging end",Re="conversational",Oe="direct",Me="Opt-in",ke="Opt-out",we=50,De=260,Le=280,Be=450,Pe=500,He=800,Ue=300,Fe=2e3,Ve=3e3,xe=[].concat(R()([]),["sdk.asapp.com","sdk.uat.asapp.com"]).map((function(e){return"https://"+(/\.asapp\.com$/.test(e)?e:e+":3000")})),Ge="default",qe="sidebar",We="desktop",Ke=414,je=1024,Qe=768,Ye="chatInstead",Ze="omniBadge",$e="default",ze="denied",Xe="granted",Je="unsupported",et="web_iOS",tt="web_android",nt={HOSTHTML:{CLASSNAME:{DEFAULT:"asappChatSDKHostHTML",CHAT_OPEN:"asappChatSDKHostHTML_chatOpened",CHAT_FULLSCEEN:"asappChatSDKHostHTML_chatFullscreen",CHAT_SIDEBAR:"asappChatSDKHostHTML_chatSideBar",LEFT:"asappChatSDKHostHTML_chatLeft",RIGHT:"asappChatSDKHostHTML_chatRight"}},BADGE:{CLASSNAME:{CLOSED:"asappChatSDKBadge_closed",DEFAULT:"asappChatSDKBadge",HIDDEN:"asappChatSDKBadge_hidden",LEFT:"asappChatSDKBadge_left",OPENED:"asappChatSDKBadge_opened",RIGHT:"asappChatSDKBadge_right"},ID:"asapp-chat-sdk-badge",TEXT:{CLASSNAME:"asappChatSDKBadge__text"},UNREAD_INDICATOR:{CLASSNAME:"asappChatSDKBadge__unreadIndicator",VISIBLE:"asappChatSDKBadge__unreadIndicator_visible"}},CHAT_INSTEAD:{CLASSNAME:{BODY:"asappChatSDKchatInstead__body",BODY_CLOSED:"asappChatSDKchatInstead__body_closed",BODY_OPENED:"asappChatSDKchatInstead__body_opened",CONTAINER:"asappChatSDKchatInstead__container",CONTAINER_CLOSED:"asappChatSDKchatInstead__container_closed",CONTAINER_OPENED:"asappChatSDKchatInstead__container_opened",HEADER:"asappChatSDKchatInstead__header",LOADING:"asappChatSDKchatInstead__loading",TITLE:"asappChatSDKchatInstead__title",CLOSE_BUTTON:"asappChatSDKchatInstead__closeButton",OPTIONS_CONTAINER:{DEFAULT:"asappChatSDKchatInstead__optionsContainer",LOADING:"asappChatSDKchatInstead__optionsContainer_loading"},OPTION:{ICON:"asappChatSDKchatInstead__optionIcon",ITEM:"asappChatSDKchatInstead__optionItem",LABEL:"asappChatSDKchatInstead__optionLabel",TEXT:"asappChatSDKchatInstead__optionText",TEXT_CONTAINER:"asappChatSDKchatInstead__optionTextContainer",TITLE:"asappChatSDKchatInstead__optionTitle"}},ID:{BODY:"asapp-chat-sdk-chat-instead-body",TITLE:"asapp-chat-sdk-chat-instead-title"}},FRAME_EL:{CLASSNAME:{DEFAULT:"asappChatSDKFrameEl"},ID:"asapp-chat-sdk-frame-el"},MODAL_BACKGROUND:{CLASSNAME:{DEFAULT:"asappChatSDKModalBackground",OPENED:"asappChatSDKModalBackground_opened",CLOSED:"asappChatSDKModalBackground_closed"}},IFRAME:{CLASSNAME:{CLOSED:"asappChatSDKIFrame_closed",CLOSED_FINISHED:"asappChatSDKIFrame_closedFinished",DEFAULT:"asappChatSDKIFrame",IS_FULLSCREEN:"asappChatSDKIFrame_isFullscreen",IS_MOBILE:"asappChatSDKIFrame_isMobile",LEFT:"asappChatSDKIFrame_left",OPENED:"asappChatSDKIFrame_opened",RIGHT:"asappChatSDKIFrame_right",SIDEBAR:"asappChatSDKIFrame_sideBar",SMS_FORM:"asappChatSDKIFrame_smsForm"},ID:"asapp-chat-sdk-iframe"},PROACTIVE_MESSAGE:{CLASSNAME:{DEFAULT:"asappChatSDKNotification",BUTTON:{DEFAULT:"asappChatSDKNotification__button",CONTAINER:"asappChatSDKNotification__buttonContainer"},CLOSE_BUTTON:"asappChatSDKNotification__closeButton",CONTAINER:{DEFAULT:"asappChatSDKNotificationContainer",HIDDEN:"asappChatSDKNotificationContainer_hidden"},CONVERSATIONAL:"asappChatSDKNotification_conversational",DIRECT:"asappChatSDKNotification_direct",ICON:"asappChatSDKNotification__icon",LEFT:"asappChatSDKNotificationContainer_left",RIGHT:"asappChatSDKNotificationContainer_right",TEXT:"asappChatSDKNotification__text",TITLE:"asappChatSDKNotification__title"},ID:{PREFIX:"asapp-chat-sdk-notification",CONTAINER:"asapp-chat-sdk-notification-container"}},INTEGRATION:{SEND:{TYPES:{CUSTOMER:"customer",REPORTING:"reporting"},REPORTING_TYPES:{TRANSACTION:"transaction"}},ACTION:{EVENTS:{CHAT_SHOW:"chat:show",CHAT_HIDE:"chat:hide",ISSUE_NEW:"issue:new",ISSUE_END:"issue:end",AGENT_ASSIGNED:"agent:assigned",MESSAGE_RECEIVED:"message:received",FLOW_END:"flow:end",FEEDBACK_REQUESTED:"feedback:requested",FEEDBACK_RECEIVED:"feedback:received"},SENDER_TYPES:{SRS:"srs",AGENT:"agent"}}},JS:{ACTION_OFF:"off",ACTION_ON:"on",GET_STATE:"getState",HIDE:"hide",LOAD:"load",REFRESH:"refresh",SEND:"send",SET:"set",SET_CUSTOMER:"setCustomer",SHOW:"show",SHOW_CHAT_INSTEAD:"showChatInstead",UNLOAD:"unload",DEBUG:"debug"}};function ot(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return/Android|BlackBerry|IEMobile|iPad|iPhone|iPod|Opera Mini/i.test(e)}function it(){return xe.indexOf(window.ASAPP.Host)>=0?window.ASAPP.Host:"https://sdk.asapp.com"}function at(e,t){var n=void 0,o=void 0,i=void 0,a=null,s=0,r=function(){s=Date.now(),a=null,i=e.apply(n,o),a||(n=o=null)};return function(){var c=Date.now(),u=t-(c-s);return n=this,o=arguments,u<=0||u>t?(a&&(clearTimeout(a),a=null),s=c,i=e.apply(n,o),a||(n=o=null)):a||(a=setTimeout(r,u)),i}}function st(e){return e&&"object"===(void 0===e?"undefined":y()(e))&&!Array.isArray(e)}function rt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(!n.length)return e;var a=n.shift();if(st(e)&&st(a))for(var s in a)st(a[s])?(e[s]||i()(e,_()({},s,{})),rt(e[s],a[s])):a[s]&&""!==a[s]&&i()(e,_()({},s,a[s]));return rt.apply(void 0,[e].concat(n))}var ct=n("RB7F"),ut=n.n(ct),lt=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f()(this,e),this.state=t}return v()(e,[{key:"get",value:function(e){return this.state.hasOwnProperty(e)?this.state[e]:void 0}},{key:"set",value:function(e,t){return"string"==typeof e?null==t?delete this.state[e]:this.state[e]=t:An("store.js","#set",'Can only accept a key as a "string"'),this}}]),e}()),dt={LEFT:"left",RIGHT:"right"},ht={OPEN:"Open chat",CLOSE:"Minimize chat",UNREAD_INDICATOR:"Unread messages",ABC:"Open Apple Business Chat"},pt={TITLE:"Chat Window"},Et={TITLE:{MESSAGE:"MESSAGE",DISMISS:"Dismiss message"},BUTTON:{DECLINE:"No, thanks"}},mt={OMNI:"omni",BADGE:"badge",TRAY:"tray",NONE:"none"},gt={INACTIVE:"badgeInactive",ACTIVE:"badgeActive"},St={ABC:"abc",CHAT:"chat",GBM:"gbm",PHONE:"phone",SMS:"sms"},ft={CONVERSATION:"proactiveMessageConversation"},Ct="close",vt="loading",Tt="cobrowsingTimeStamp",_t="debugEnabled",It="iframeCoordinates",Nt="isActiveSession",At="isFullscreen",yt="isLiveChat",bt="isLoggingIn",Rt="isMobile",Ot="isOpen",Mt="isProactiveMessageDisplayed",kt="notificationImpression",wt="supressingFullscreenOpen",Dt="unreadMessages",Lt="APIHostname",Bt="BadgeRef",Pt="ChatInsteadRef",Ht="CompanyMarker",Ut="CustomerId",Ft="DeviceInfo",Vt="DisplaySettings",xt="HostLocation",Gt="IFrameRef",qt="InitiationType",Wt="Intent",Kt="IsChatOpen",jt="LoadIdentifiers",Qt="ModalBackground",Yt="ProactiveMessageRef",Zt="ProactiveMessageStatus",$t="OnLoadComplete",zt="ReferrerUrl",Xt="RegionCode",Jt="SDKLoadTime",en="Settings",tn="Sound",nn="Trigger",on="webSDK",an="appleBusinessChat",sn="gbm",rn="sms",cn="default",un="external",ln="proactive",dn=function(){function e(t){f()(this,e),this.storageKey="asapp-chat-sdk-storage";try{var n=new Date;(this.storage=window[t]).setItem(n,n);var o=this.storage.getItem(n)!==n.toString();this.storage.removeItem(n),o&&(this.storage=!1)}catch(e){this.storage=!1}this.storage&&!this.storage.getItem(this.storageKey)&&this.storage.setItem(this.storageKey,g()({}))}return v()(e,[{key:"get",value:function(e){if(this.storage){var t=JSON.parse(this.storage.getItem(this.storageKey))||{};return"string"==typeof e?t[e]:t}return!1}},{key:"remove",value:function(e){if(!this.storage||!e)return!1;var t=this.get();delete t[e],this.storage.setItem(this.storageKey,g()(t))}},{key:"set",value:function(e,t){if(!this.storage||!e)return!1;var n=i()({},this.get(),"object"===(void 0===e?"undefined":y()(e))?e:_()({},e,t));this.storage.setItem(this.storageKey,g()(n));var o=lt.get(Gt);o&&o.setIFrameLocalStorage(e,t)}}]),e}(),hn=new dn("sessionStorage"),pn=(new dn("localStorage"),hn&&"function"==typeof hn.get&&hn.get(_t)),En=[].indexOf(window.location.hostname)>=0;function mn(e,t,n){if(pn||En||n){var o=Array.prototype.slice.call(t||[]);o.unshift("Chat SDK:"),e.apply(console,o)}}function gn(){mn(console.log,arguments)}gn.Error=function(){mn(console.error,arguments,!0)},gn.Warn=function(){mn(console.warn,arguments,!0)};var Sn,fn,Cn,vn,Tn,_n,In,Nn,An=gn,yn={END_CONVERSATION:"customer/EndConversation",ENTER_CHAT:"customer/enterChat",GET_OFFERED_MESSAGE_UNAUTHED:"customer/proactive/GetOfferedMessageUnauthed",ASK:"customer/ask",SEND_TEXT_MESSAGE_AND_HIER_AND_TREEWALK:"srs/SendTextMessageAndHierAndTreewalk",SEND_TEXT_MESSAGE:"customer/SendTextMessage",GET_COMPONENT_VIEW:"srs/GetComponentView",HISTORY:"customer/history",SEND_PICTURE_MESSAGE:"customer/SendPictureMessage",NOTIFY_TYPING_PREVIEW:"customer/NotifyTypingPreview",REQUEST_AUTOCOMPLETE:"customer/autocomplete",ANALYTICS_EVENT:"customer/analytics",RESOLVE_LINK:"customer/ResolveLink",GET_SDK_SETTING:"customer/getsdksettings",UPDATE_CONTEXT:"customer/updateContext",UPDATE_SESSION:"customer/updateSession",PUBLISH_REPORTING_EVENT:"customer/publishReportingEvent",ACCEPT_OFFERED_MESSAGE:"customer/proactive/AcceptOfferedMessage",DISMISS_OFFERED_MESSAGE:"customer/proactive/DismissOfferedMessage",COBROWSING_ACCEPT:"customer/CobrowsingInvitationAccepted",COBROWSING_DECLINE:"customer/CobrowsingInvitationDeclined",COBROWSING_END:"customer/EndCobrowsingSession",CHECK_COBROWSING_URL:"customer/CheckCobrowsingUrl",UPDATE_COBROWSING_URL:"customer/UpdateCobrowsingURL",SUBMIT_FEEDBACK:"srs/SubmitFeedback",SMS_VERIFICATION_START:"verification/start",SMS_VERIFICATION_CHECK:"verification/check",GET_REALTIME_WAIT_DATA:"customer/getRealtimeWaitData",V2:{_ROOT:"api/v2",CUSTOMER:{_ROOT:"customer",AUTH:"customer/auth"},WEBSOCKET:{_ROOT:"websocket",REQUEST:"websocket/request"}}},bn="finish",Rn="error",On="Unauthed",Mn="Authing",kn="Authed",wn="quickReply.selected",Dn="view.dismissed",Ln="action.link.selected",Bn="invalid_auth",Pn="token_expired",Hn="session_not_found",Un="message_too_large",Fn="disconnected",Vn="popupBlockerError",xn="imageUploadFailed",Gn="noConnection",qn="messageExpired",Wn="inlineFormFailed",Kn="characterLimitExceeded",jn="blockedInCall",Qn="restartConfirm",Yn="continuePrompt",Zn="endActiveSession",$n="notificationPermissionRequest",zn="notificationPermissionSuccess",Xn="leaveQueue",Jn="chatBlocked",eo="flowFinished",to="Event",no="cobrowsing pending",oo="cobrowsing active",io="cobrowsing inactive",ao="cobrowsing error",so="cobrowsing declined by a user",ro="cobrowsing ended by an agent",co="cobrowsing ended by a user",uo="cobrowsing ended due to disabled page",lo="Session",ho="Settings",po="HostSettings",Eo="Metrics",mo="EWTSheetData",go="events",So="settings",fo="token",Co="transactionEvents",vo="batch_size",To="min_batch_period_seconds",_o="max_batch_period_seconds",Io="persisted_events",No="minimum_priority",Ao={COUNT:1,DURATION:2,GAUGE:3,SET:4},yo={RAW:1,SECONDS:2,BYTES:3},bo=(Sn={},_()(Sn,he.AUTH_SESSION,1),_()(Sn,he.BLOCKER,.3),_()(Sn,he.CHATINSTEAD,1),_()(Sn,he.CHATINSTEAD_ABC,1),_()(Sn,he.CHATINSTEAD_GBM,1),_()(Sn,he.CHATINSTEAD_GETCHANNELSETTINGS,1),_()(Sn,he.CHATINSTEAD_PHONE,1),_()(Sn,he.CHATINSTEAD_SMS,1),_()(Sn,he.CHATINSTEAD_WEB,1),_()(Sn,he.CHAT,.5),_()(Sn,he.CHAT_CONNECT,.99),_()(Sn,he.CHAT_OPEN_INTERACTION,.99),_()(Sn,he.CONVERSATION_END,.99),_()(Sn,he.CONVERSATION_FLOW,.9),_()(Sn,he.CONVERSATION_PENDING_MESSAGE,0),_()(Sn,he.CONVERSATION_PENDING_MESSAGE_RETRY,0),_()(Sn,he.CONVERSATION_UNREADINDICATOR,0),_()(Sn,he.ENTER_CHAT,.99),_()(Sn,he.EWT,.99),_()(Sn,he.EWT_LEAVE,.99),_()(Sn,he.EWT_LEAVE_CONFIRM,.99),_()(Sn,he.SENDTEXT_LIVE,0),_()(Sn,he.SMS_VERIFICATION_CHECK,1),_()(Sn,he.SMS_VERIFICATION_CHECK_FORM,1),_()(Sn,he.SMS_VERIFICATION_START,1),_()(Sn,he.SMS_VERIFICATION_START_FORM,1),_()(Sn,he.SOCKET,.5),_()(Sn,he.SOCKET_OVERALL,1),_()(Sn,he.SOCKET_URL,.99),_()(Sn,he.WEB_API_ACTION_OFF,.8),_()(Sn,he.WEB_API_ACTION_ON,.8),_()(Sn,he.WEB_API_GETSTATE,.8),_()(Sn,he.WEB_API_HIDE,.9),_()(Sn,he.WEB_API_SEND,.8),_()(Sn,he.WEB_API_SET,.8),_()(Sn,he.WEB_API_SHOWCHATINSTEAD,.8),_()(Sn,he.WEB_API_SHOW,.9),_()(Sn,he.WEB_API_UNLOAD,.9),_()(Sn,he.WEB_NOTIFICATION,1),_()(Sn,he.WEB_NOTIFICATION_PERMISSION,1),_()(Sn,he.WEB_NOTIFICATION_PERMISSION_CONFIRM,1),Sn),Ro={CONTENT_TYPE:"content_type",CONTENT_TRANSFER_ENCODING:"content_transfer_encoding",CONTENT_VERSION:"content_version",DATA:"data",EXTERNAL_ID:"external_id",EVENT_TYPE:"event_type",EVENT_DATE:"event_date",TAGS:"tags",VALUE:"value",VALUE_TYPE:"value_type",VALUE_UNITS:"value_units"},Oo={CLIENT_ID:"client_id",CLIENT_TYPE:"client_type",CLIENT_VERSION:"client_version",CLIENT_DEVICE:"client_device",COMPANY_MARKER:"company_marker",REGION_CODE:"region_code",USER_AGENT:"user_agent",USER_SESSION_ID:"user_session_id"},Mo={VERIFICATION_CODE:"confirmationCode",ERROR_TOO_MANY_RETRIES:"errorTooManyRetries",PHONE_NUMBER:"phoneNumber"},ko="EWTDisplayType",wo="EWTLowerBoundMinutes",Do="EWTUpperBoundMinutes",Lo="QueuePositionDisplayType",Bo="QueuePosition",Po="TimeToNextPollSeconds",Ho="ShouldDisplayRealtimeWaitData",Uo="InitialQueuePosition",Fo="hide",Vo="maximum",xo="minimum",Go="number",qo="range",Wo="hide",Ko="show",jo="blank",Qo="default",Yo="self",Zo=2,$o=3,zo=4,Xo={API:"api",USER_LOGIN:"userLogin",COMPONENT_VIEW:"componentView",CUSTOM_POST_HTTP:"customPostHttp",TREEWALK:"treewalk",FINISH:"finish",DEEP_LINK:"deepLink",HTTP:"http",WEB:"web",LINK:"link"},Jo=1,ei=2,ti=4,ni={TEXT_MESSAGE:1,NEW_ISSUE:2,NEW_REP:3,CONVERSATION_END:4,PICTURE_MESSAGE:5,PRIVATE_NOTE:6,TOPIC_CHANGE:7,ISSUE_ENQUEUED:8,CONVERSATION_RATED:9,CUSTOMER_TIMED_OUT:10,CRM_CUSTOMER_LINKED:11,ISSUE_SUMMARIZED:12,TEXT_ANNOTATION:13,CUSTOMER_PROMPT:14,CUSTOMER_CONVERSATION_END:15,ISSUE_ANNOTATION:16,CUSTOMER_FEEDBACK:18,IP_BLOCK:20,PHONE_NUMBER_BLOCK:21,SRS_HIER_AND_TREEWALK:22,SRS_ACTION:24,SWITCH_SRS_TO_CHAT:28,ACCOUNT_MERGE:30,SWITCH_TO_SRS:31,COBROWSING_STARTED:40,COBROWSING_ENDED:41,COBROWSING_INVITATION:42,COBROWSING_DECLINED:43},oi=1,ii=8,ai=10,si=13,ri=14,ci=21,ui="SRS",li="Live",di="InQueue",hi="Blocked",pi=function(){function e(){f()(this,e),this.nextSubId=1,this.subsBySignal={},this.signalBySubId={}}return v()(e,[{key:"on",value:function(e,t){var n=this.nextSubId;return this.nextSubId+=1,this.subsBySignal[e]||(this.subsBySignal[e]={}),this.subsBySignal[e][n]=t,this.signalBySubId[n]=e,n}},{key:"off",value:function(e,t){for(var n=this.subsBySignal[e]||{},o=E()(n),i=0;i<o.length;i++){var a=o[i];if(t===n[a]){delete this.subsBySignal[e][a],delete this.signalBySubId[a];break}}}},{key:"once",value:function(e,t){var n=this;this.on(e,(function o(){for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];n.off(e,o),t.apply(n,a)}))}},{key:"fire",value:function(e){for(var t=this.subsBySignal[e],n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];for(var a in t)t[a].apply(this,o)}}]),e}(),Ei=pi,mi=function(){function e(t,n,o){if(f()(this,e),/\//.test(n)){var i=n.split("/");n=i[0]+"//"+i[2]}this.name=o||this.constructor.name,this.target=t,this.targetOrigin=n,this._pubsub=new Ei,this._isListening=!1,this.handleMessageEvent=this.handleMessageEvent.bind(this),this.startListening()}return v()(e,[{key:"handleMessageEvent",value:function(e){if(e&&e.data&&e.data.type){var t=e.data.type,n=e.data.data||{};this.targetOrigin&&e.origin!==this.targetOrigin?An("MessageBus.js",this.name+": Ignoring message event from origin '"+e.origin+"' because it does not match targetOrigin '"+this.targetOrigin+"'.\n  Event: { type: "+t+", message:",n,"}"):this._pubsub.fire(t,n,e.origin)}}},{key:"startListening",value:function(){this._isListening||(this._isListening=!0,window.addEventListener("message",this.handleMessageEvent))}},{key:"stopListening",value:function(){this._isListening&&(this._isListening=!1,window.removeEventListener("message",this.handleMessageEvent))}},{key:"on",value:function(e,t){this._pubsub.on(e,t)}},{key:"once",value:function(e,t){this._pubsub.once(e,t)}},{key:"off",value:function(e,t){this._pubsub.off(e,t)}},{key:"post",value:function(e,t){this.target&&"function"==typeof this.target.postMessage&&this.targetOrigin?this.target.postMessage({type:e,data:t},this.targetOrigin):An("MessageBus.js",this.name+": Unable to post message with invalid target or targetOrigin: target=",this.target,", targetOrigin=",this.targetOrigin)}}]),e}(),gi=mi,Si=function(e,t,n,o){var i=/\{[0-9a-z]+:[^}]+\}/gim,a=n.match(i)||[],s=n.split(i),r=[];return s.forEach((function(n,i){r.push(fi(e,t,n,o)),i<a.length&&r.push(a[i])})),r.join("")},fi=function(e,t,n,o){var i={regex:vi,recursive:Ti}[t.Type];return i?i(e,t.Value,n,o):(An("Cannot scrub a message due to unknown type",e),n)},Ci=function(e,t){return e.Replacements.forEach((function(e){t=t.replace(new RegExp(e.Search,"gim"),e.Replace)})),"{"+e.Category+":"+t+"}"},vi=function(e,t,n,o){return n.replace(new RegExp(t,"gim"),(function(t){return o(e,t)}))},Ti=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments[2],i=arguments[3];return 0===n.length?i(t,o):Si(t,n[0],o,(function(t,o){return e(t,n.slice(1),o,i)}))},_i=n("Yz+Y"),Ii=n.n(_i),Ni=n("FYw3"),Ai=n.n(Ni),yi=n("mRg0"),bi=n.n(yi),Ri=n("CSPP"),Oi=n.n(Ri),Mi=n("17x9"),ki=n.n(Mi),wi=function(e){return{type:"SET_FIRST_UNREAD_MESSAGE_ID",firstUnreadMessageId:e}},Di=function(e){return{type:"SET_REP_IS_TYPING",showTypingIndicator:e}},Li=function(){return function(e,t){var n=t().chatMessagesView,o=n.firstUnreadMessageId,i=n.showTypingIndicator;n.unreadMessageCount&&e({type:"RESET_UNREAD_MESSAGE_COUNT"});var a=i?document.querySelector(".bubble_typingIndicator"):document.getElementById(o),s=Sc(600)?"smooth":"auto";a&&a.scrollIntoView({behavior:s})}},Bi=function(e){return{type:"SET_ACTION_SHEET_DATA",actionSheetData:e}},Pi=function(e){return function(t,n){n().chat.isBlocked||t({type:"SET_ACTION_SHEET_TYPE",actionSheetType:e})}},Hi=function(e){return{type:"SET_IS_ACTION_SHEET_LOADING",isActionSheetLoading:e}},Ui=function(e){return{type:"SET_SHOW_ACTION_SHEET_ERROR",showActionSheetError:e}},Fi=function(){return function(e){var t=document.getElementById("action-sheet");t&&t.classList.add("actionSheet_hidden"),setTimeout((function(){e({type:"RESET_ACTION_SHEET"}),e(fa(!1))}),De)}},Vi=function(e){return{type:"RECORD_COUNT",payload:e}},xi=function(e){return{type:"END_DURATION",payload:e}},Gi=function(e){return{type:"START_DURATION",payload:e}},qi=function(e){return function(t){var n=e.metricsEventLabel;if(n){var o=_()({},Ee.WITH_CUSTOMER_ID,Ic());t(Vi({label:n,type:pe.REQUEST_START,tags:o})),t(Gi({label:n,type:pe.REQUEST_DURATION}))}}},Wi=function(e){return function(t){var n=e.metricsEventLabel,o=_()({},Ee.WITH_CUSTOMER_ID,Ic());n&&(200===e.statusCode?(t(Vi({label:n,type:pe.REQUEST_SUCCESS,tags:o})),e.successDuration&&t(xi({label:n,type:pe.SUCCESS_DURATION,tags:o,data:{attempts:e.attempts}}))):t(Vi({label:n,type:pe.REQUEST_FAILURE,data:{error:e.error,code:e.statusCode},tags:o})),t(xi({label:n,type:pe.REQUEST_DURATION,tags:o})))}},Ki=function(e){return{type:"SET_SHOW_INPUT",showInput:e}},ji=function(){return function(e,t){var n=t(),o=n.chat,i=n.chatInput,a=n.eventLog.mostRecentMessageEvent,s=o.isLiveChat||a&&a.payload&&a.payload.userCanTypeResponse||!1;i.showInput!==s&&e(Ki(s))}},Qi=function(e){var t=e.UIMessageID,n=e.error,o=e.xhr;return function(e){var i=200===o.status;n===Un?(e(ds()),e(Ea(Kn))):e(Ns(t,{isPending:!1,isFailed:!i})),e(Vi({label:he.CONVERSATION_PENDING_MESSAGE,type:i?pe.CONFIRMED:pe.FAILURE}))}},Yi=ko,Zi=wo,$i=Do,zi=Uo,Xi=Bo,Ji=Lo,ea=Ho,ta=Po,na=0,oa=void 0,ia=function(){return function(e,t){var n,o=t().ewtSheet.ewtSheetData,i=(n={},_()(n,Zi,o[Zi]),_()(n,$i,o[$i]),_()(n,Xi,o[Xi]),_()(n,Yi,o[Yi]),_()(n,Yi,o[Yi]),_()(n,Ji,o[Ji]),n);e(Vi({label:he.EWT,type:pe.REQUEST_START})),e(Gi({label:he.EWT,type:pe.SUCCESS_DURATION})),Oc.getRealtimeWaitData({params:i,onComplete:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t?(na=0,e(ra(t)),e(Vi({label:he.EWT,type:pe.REQUEST_SUCCESS})),e(xi({label:he.EWT,type:pe.SUCCESS_DURATION}))):(e(sa()),e(Vi({label:he.EWT,type:pe.REQUEST_FAILURE,data:{error:n,code:o.status}})))}})}},aa=function(){return function(e){clearTimeout(oa);var t=document.getElementById("ewt-sheet");t&&t.classList.add("ewtSheet_hidden"),setTimeout((function(){e({type:"REMOVE_EWT_SHEET"})}),Pe)}},sa=function(){return function(e){na>=3?(na=0,e(aa())):(na++,e(ia()))}},ra=function(e){return function(t,n){if(e[ea]&&function(e){if(e[Bo]+1<=0)return!1;switch(e[ko]){case qo:return!(!e[wo]||!e[Do]);case Go:case Vo:return!!e[Do];case xo:return!!e[wo];case Fo:return e[Lo]===Ko;default:return!1}}(e)){var o=n().ewtSheet.ewtSheetData;o&&o[zi]||(e[zi]=e[Xi]),t({type:"SET_SHOW_EWT_SHEET",showEWTSheet:!0}),t({type:"SET_EWT_SHEET_DATA",ewtSheetData:N()({},o,e)});var i=e[ta];i&&(oa=setTimeout((function(){t(ia())}),1e3*i))}else t(aa())}},ca=function(e){return function(t,n){var o=n().chat.session;if(t(ha(!0)),o&&o.customer_primary_identifier){var i=o.customer_primary_identifier;(e&&e.toString()!==i.toString()||!e&&""!==i)&&t(Sa(null))}t({type:"RESTART_AUTH"})}},ua=function(e){return{type:"SET_AUTH_STATUS",authStatus:e}},la=function(e){return function(t,n){if(e)t(Bi({text:n().sdkSettings.BlockingMessage})),t(Pi(Jn)),t(Vi({label:he.BLOCKER,type:pe.DISPLAY}));else{var o=n(),i=o.actionSheet.actionSheetType,a=o.chat.chatBanner;i===Jn&&(t({type:"RESET_ACTION_SHEET"}),t(Vi({label:he.BLOCKER,type:pe.HIDE}))),a===jn&&t(Ea(null))}t({type:"SET_IS_BLOCKED",isBlocked:e})}},da=function(e,t,n){return function(o,i){uc.post(ie,{isLiveChat:t}),o(function(e){return{type:"SET_IS_LIVE_CHAT",isLiveChat:e}}(t)),o(function(e){return{type:"SET_CONVERSATION_STATUS",conversationStatus:e}}(e)),t?o(Ta(!1)):(o(hs({})),o(ps(null)),o(Di(!1))),e===di?n===ui&&Tc():i().ewtSheet.showEWTSheet&&o(aa()),o(ji())}},ha=function(e){return{type:"SET_SHOW_LOADING_VIEW",showLoadingView:e}},pa=function(e){return{type:"SET_SMS_FORM_SETTINGS",SMSFormSettings:e}},Ea=function(e){return{type:"SET_CHAT_BANNER",chatBanner:e}},ma=function(e){return uc.post(H,{isDocked:e}),{type:"SET_IS_DOCKED",isDocked:e}},ga=function(e){return function(t,n){n().chat.showLoadingView&&t(ha(!1)),t({type:"SET_ERROR",error:e})}},Sa=function(e){return{type:"SET_SESSION",session:e}},fa=function(e){return{type:"SET_IS_RESTARTING_CHAT",isRestartingChat:e}},Ca=function(){return function(e,t){e(fa(!0)),Oc.ask({onComplete:function(n,o){e(Li()),t().actionSheet.actionSheetType?o?(e(fa(!1)),e(Ui(!0))):e(Fi()):e(fa(!1))}})}},va=function(e){return function(t,n){if(e){e.preventDefault();var o=n(),i=o.sdkSettings,a=i.IsDocumentUploadingEnabled,s=i.IsPhotoUploadingEnabled,r=i.SupportedUploadMIMETypes,c=void 0===r?[]:r;if(o.chat.isLiveChat&&(a||s)){var u=e.hasOwnProperty("dataTransfer")?e.dataTransfer:e.target,l=u.files&&u.files.length?u.files[0]:null;if(l){var d=new RegExp(c.join("|"),"i");d&&d.test(l.type)?Oc.sendPictureMessage({file:l,onComplete:function(e,n){n&&t(Ea(xn))}}):An("[Chat.actions]","sendFile()","invalid file type")}}}}},Ta=function(e){return{type:"SET_SHOW_QUICK_REPLIES",showQuickReplies:e}},_a=function(e){return{type:"SET_QUICK_REPLIES_DISABLED",quickRepliesDisabled:e}},Ia=function(e){return{type:"SET_COBROWSING_STATE",cobrowsingState:e}},Na=function(e){return{type:"SET_COBROWSING_USER_ID",cobrowsingUserId:e}},Aa=function(e){return Array.isArray(e)?e.filter((function(e){return!e.isTransient})):[]},ya=function(e){if(!e||!e.payload||e.isFromCustomer)return null;var t=e.payload.quickReplies;return Array.isArray(t)?t:null!==t&&"object"===(void 0===t?"undefined":y()(t))&&t.default||[]},ba=function(e){var t=ya(e);return t&&t.length>0},Ra=function(e){return e.EventFlags===Jo&&e.EventType!==ni.CONVERSATION_END},Oa=function(e){return e.isChatMessage&&!e.isFromCustomer},Ma=function(e){return e.EventType===ni.COBROWSING_STARTED||e.EventType===ni.COBROWSING_ENDED},ka=function(e){if(e)return e.EventJSON&&(e.payload=JSON.parse(e.EventJSON)||{}),e.payload=e.payload||{},e.isFromCustomer=Ra(e),e.isFromRep=function(e){return e.EventFlags===ei}(e),e.isFromSRS=function(e){return e.EventFlags===ti||e.EventType===ni.CONVERSATION_END}(e),e.isEphemeral=function(e){return 0!==e.EphemeralType}(e),e.isChatMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.payload,n=e.EventType;if(!t)return!1;if([ni.TEXT_MESSAGE,ni.NEW_REP,ni.CONVERSATION_END,ni.CUSTOMER_TIMED_OUT,ni.SRS_HIER_AND_TREEWALK,ni.SRS_ACTION,ni.SWITCH_SRS_TO_CHAT,ni.SWITCH_TO_SRS].indexOf(n)<0)return!1;var o=t.text||t.Text;return!(!o&&!t.attachment)}(e),e.isPictureMessage=function(e){return e&&e.EventType===ni.PICTURE_MESSAGE}(e),e.isDisplayable=function(e){return e.isChatMessage||e.isPictureMessage||Ma(e)}(e),e.renderKey=function(e){return e?e.isPending?"event-"+e.payload.UIMessageID:["event",e.CustomerId,e.RepId,e.EventId,e.EventTime].join("-"):null}(e),e},wa=n("FyfS"),Da=n.n(wa),La=function e(t,n){var o=[];if(t&&t.content&&(t.content.root?o.push(t.content.root):t.content.items&&t.content.items.length&&(o=[].concat(R()(o),R()(t.content.items)))),n){var i=!0,a=!1,s=void 0;try{for(var r,c=Da()(o);!(i=(r=c.next()).done);i=!0){var u=e(r.value,!0);u&&u.length&&(o=[].concat(R()(o),R()(u)))}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}}return o},Ba=function(e){var t={};return e&&e.root&&(t=function(e){var t={};if(!e)return t;var n=[e].concat(R()(La(e,!0))),o=!0,i=!1,a=void 0;try{for(var s,r=Da()(n);!(o=(s=r.next()).done);o=!0){var c=s.value;c&&"name"in c&&"value"in c&&("checkboxView"===c.type?c.checked&&(t[c.name]=c.value):t[c.name]=c.value)}}catch(e){i=!0,a=e}finally{try{!o&&r.return&&r.return()}finally{if(i)throw a}}return t}(e.root)),t},Pa=function(e,t){var n=[];return[e.root].concat(R()(La(e.root,!0))).forEach((function(e){var o=e.required,i=e.name;!o||void 0!==t[i]&&""!==t[i]||n.push(i)})),{missingFields:n}},Ha=function(e){return{type:"UPDATE_FORM_DATA",formData:e}},Ua=function(e){return function(t,n){n().modalView.showModalView&&t({type:"SET_FORM_ERROR_MESSAGE",formErrorMessage:e})}},Fa=function(e){return{type:"SET_FORM_ERRORS",formErrors:e}},Va=function(e){return{type:"SET_IS_HANDLING_ACTION",isHandlingAction:e}},xa=function(e){return{type:"REMOVE_FORM_ERROR",fieldName:e}},Ga=function(e){var t=e.fieldName,n=e.value;return function(e,o){if(t){var i=o().form.formErrors;i&&i[t]&&e(xa(t)),e(Ha(_()({},t,n)))}}},qa=function(){return function(e,t){ba(t().eventLog.mostRecentMessageEvent)&&e(Ta(!0)),e({type:"HIDE_INLINE_FORM"})}},Wa={ACTION_SHEET:(fn={},_()(fn,Qn,{title:"Are you sure?",text:"It looks like you're in the middle of something. ",continueText:"Never mind, I'll continue",abandonText:"I want to ask a new question"}),_()(fn,Zn,{title:"Looks like you’re chatting somewhere else.",text:"Would you like to end that session and ask a new question here? If not, you’ll need to find the browser window you were previously chatting in.",abandonText:"End active session"}),_()(fn,$n,{icon:"bell",title:"Never miss a message",text:"Enable push notifications so you know when you receive a message. \n \nWhen your browser asks to show you notifications, select “Allow”.",continueText:"No thanks",abandonText:"Enable notifications"}),_()(fn,zn,{icon:"navCheck",title:"Notifications enabled!",text:"Make sure your volume is on.\n We’ll notify you when there’s a new message.",continueText:"Got it"}),_()(fn,Xn,{title:"Are you sure?",text:"If you leave, you'll lose your place in line.",continueText:"Never mind, I’ll keep waiting",abandonText:"Yes, leave the line"}),_()(fn,Jn,{icon:"phone",title:"Phone call in progress...",continueText:"Okay"}),fn),ANNOUNCER:{ATTACHMENT:"Has attachment",BUTTON:"Button",SUPPORT:"Support",USER:"You"},AUTOCOMPLETE:{ANNOUNCER:" autocomplete options available. Use the up and down arrows to browse"},BACK:"Back",BUBBLE:{FAILED:"Not delivered. Retry?",SECURE_MESSAGE:"Send a secure message"},CHAT_INPUT:{ADD_ATTACHMENT:"Add an image attachment",PLACEHOLDER_TEXT:"Type here",REGION_TITLE:"Chat Input",ANCHOR_TITLE:"Jump to Chat Input",SEND_BUTTON_TEXT:"send"},CHAT_MESSAGES_VIEW:{REGION_TITLE:"Chat Log",ANCHOR_TITLE:"Jump to Chat Log"},CHAT_NAV_BAR:{MENU:"Chat Menu",MENU_BUTTON:"Toggle Chat Menu",SOUND_ON:"Sound On",SOUND_OFF:"Sound Off",REGION_TITLE:"Chat Navigation",ANCHOR_TITLE:"Jump to Chat Navigation",DRAG:"Drag window",UNDOCK:"Pop out chat",DOCK:"Re-dock"},COMPONENT_VIEW:{MISSING_FIELD_ERROR:"Some required fields are missing.",REQUIRED_FIELD:"Required field"},MINIMIZE:"Minimize Chat",CONNECTED:"Connected",DISMISS:"Dismiss",END_BUTTON_TEXT:"End Chat",CHAT_BANNER:(Cn={},_()(Cn,Gn,"Please check your connection"),_()(Cn,xn,"Image upload failed."),_()(Cn,Vn,"For best results, make sure your browser allows popups."),_()(Cn,qn,"Message expired."),_()(Cn,Wn,"Sorry, we're having trouble loading that form. Please try again."),_()(Cn,Kn,"This message is too long to send"),_()(Cn,Fn,"No connection. Retry connecting?"),_()(Cn,jn,"Chat unavailable during phone call"),Cn),ERROR_VIEW:{CONNECTION_ERROR:"Unable to connect",LOG_IN_PROMPT:"Please log in to continue",EXPIRED_CREDENTIALS:"Sorry, we are having trouble connecting. Please try again later.",BROWSER_STORAGE_ACCESS:"Please enable third-party cookies on your browser",RETRY_CONNECTION_BUTTON:"Retry Connecting",LOG_IN_BUTTON:"Log in",COMPONENT:"We’ve encountered an unexpected error. Our engineers have been notified. Please try again later."},EWT_SHEET:{BUTTON_TEXT:"Leave"},MODAL_VIEW:{REGION_TITLE:"Modal",CLOSE:"Dismiss Modal"},NEW_QUESTION_BUTTON_TEXT:"New Question",NEW_QUESTION_BUTTON_REGION:"Jump to New Question button",REQUEST_FAILURE:"We’re having technical issues - we’re on it. \n Please try again in a few minutes.",TRY_AGAIN:"Try again",UNREAD_MESSAGE_TEXT:"unread message",UNREAD_MESSAGES_TEXT:"unread messages",QUICK_REPLY:{REGION_TITLE:"Suggested Questions",ANCHOR_TITLE:"Jump to Suggested Questions"},COBROWSING_BANNER:(vn={},_()(vn,no,"Co-Browse Request"),_()(vn,oo,"Active Co-Browsing Session"),_()(vn,so,"You have declined Co-Browsing invitation"),_()(vn,ro,"Agent has ended Co-Browsing session"),_()(vn,co,"You have ended Co-Browsing session"),_()(vn,uo,"Co-Browsing Session Ended - Disabled Page"),_()(vn,ao,"Co-Browsing Session Failed"),vn),LOADING_VIEW:{LABEL:"Loading"},SMS_FORM:(In={},_()(In,Mo.PHONE_NUMBER,{TITLE:(Tn={},_()(Tn,Ye,"What number should we text?"),_()(Tn,Ze,"Text with us"),Tn),DESCRIPTION:(_n={},_()(_n,Ye,""),_()(_n,Ze,"Enter your phone number and a live agent will text you on your device."),_n),INPUT_TITLE:"Phone number",PRIMARY_BUTTON_TEXT:"Text me"}),_()(In,Mo.VERIFICATION_CODE,{TITLE:"Enter your confirmation code",DESCRIPTION:"Please enter the 6-digit code texted to ",INPUT_TITLE:"Confirmation code",PRIMARY_BUTTON_TEXT:"Submit",SECONDARY_BUTTON:{DEFAULT:"Resend Code",LOADING:"Sending...",SENT:"Sent"}}),_()(In,Mo.ERROR_TOO_MANY_RETRIES,{TITLE:"Too many tries!",DESCRIPTION:"Please try again later or try a different contact method.",PRIMARY_BUTTON_TEXT:"Go Back"}),_()(In,"TITLE",{CLOSE:"Close Window",GO_BACK:"Go Back"}),_()(In,"HEADER","Text with us"),In),NOTIFICATION:{TITLE:{DEFAULT:"New Message",MULTIPLE:"new messages"}},INFOBAND:{AT:"at",COBROWSING:(Nn={STARTED:"Co-Browsing Session Started",ENDED:"Co-Browsing Session Ended"},_()(Nn,$o,"Co-Browsing Session Ended by You"),_()(Nn,Zo,"Co-Browsing Session Ended by Agent"),_()(Nn,zo,"Co-Browsing Session Ended - Unsupported Page"),Nn)},TYPING_INDICATOR:{LIVE_CHAT:"Agent is typing",SRS:"Support is responding"}},Ka=function(e){return e||""},ja=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){e.hasOwnProperty("customerId")&&t(ca(e.customerId)),t({type:"SET_PARTNER_CONFIG",partnerConfig:e})}},Qa=function(e){return{type:"UPDATE_HOST",host:e}},Ya=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_SDK_SETTINGS",sdkSettings:e}},Za=function(e){return function(t,n){n().connection.isConnected!==e&&(An("[Connection]","isConnected: ",e),t(e?za():{type:"GET_CUSTOMER_AUTH"})),t({type:"SET_IS_CONNECTED",isConnected:e})}},$a=function(e){return{type:"SET_ON_CONNECTED_CALLBACK",onConnectedCallback:e}},za=function(){return function(e,t){var n=t(),o=n.chat.error,i=n.connection.onConnectedCallback;Oc.enterChat({onComplete:function(){e(ja({intent:null})),e(xi({label:he.CHAT_OPEN_INTERACTION,type:pe.READY_DURATION}))}}),Oc.getSDKSetting({limit:2,onComplete:function(t){e(Ya(t))}}),o===Ie&&e({type:"RESET_ERROR"}),"function"==typeof i&&(i(),e($a(null)))}},Xa=function(e){return{type:"SET_SHOW_MODAL_VIEW",showModalView:e}},Ja=function(e){return{type:"SET_IS_LOADING_CONTENT",isLoadingContent:e}},es=function(e){return{type:"SET_LOADING_CONTENT_ERROR_MESSAGE",loadingContentErrorMessage:e}},ts=function(e){return{type:"SET_RETRY_ACTION",retryAction:e}},ns=function(e){return function(t,n){var o=n().modalView.modalViewContent,i=document.getElementById("modal-view");i&&(e||1===o.length?(i.classList.add("modalView_hidden"),t({type:"RESET_FORM"}),setTimeout((function(){t({type:"RESET_MODAL_VIEW_CONTENT"}),t(Xa(!1))}),De),Oc.sendAnalyticsEvent({name:Dn,attributes:o[0]&&o[0].metadata})):t({type:"REMOVE_LAST_MODAL_VIEW_CONTENT"}))}},os=new(function(){function e(){var t;f()(this,e),this.createNewPage=this.createNewPage.bind(this),this.closeNewPage=this.closeNewPage.bind(this),this.setNewPage=this.setNewPage.bind(this),this.openTargetURL=this.openTargetURL.bind(this),this.handleSavedNextAction=this.handleSavedNextAction.bind(this),this.handleAPIResponseError=this.handleAPIResponseError.bind(this),this.handleAPIResponse=this.handleAPIResponse.bind(this),this.handleMissingFieldsError=this.handleMissingFieldsError.bind(this),this.handleResponseAction=this.handleResponseAction.bind(this),this.actionProxy=this.actionProxy.bind(this),this.finishAction=this.finishAction.bind(this),this.componentViewAction=this.componentViewAction.bind(this),this.customPostHttpAction=this.customPostHttpAction.bind(this),this.apiAction=this.apiAction.bind(this),this.treewalkAction=this.treewalkAction.bind(this),this.userLoginAction=this.userLoginAction.bind(this),this.webAction=this.webAction.bind(this),this.httpAction=this.httpAction.bind(this),this.linkAction=this.linkAction.bind(this),this.newPage=null,this.actionHandlers=(t={},_()(t,Xo.FINISH,this.finishAction),_()(t,Xo.COMPONENT_VIEW,this.componentViewAction),_()(t,Xo.CUSTOM_POST_HTTP,this.customPostHttpAction),_()(t,Xo.API,this.apiAction),_()(t,Xo.TREEWALK,this.treewalkAction),_()(t,Xo.USER_LOGIN,this.userLoginAction),_()(t,Xo.WEB,this.webAction),_()(t,Xo.HTTP,this.httpAction),_()(t,Xo.LINK,this.linkAction),t)}return v()(e,[{key:"createNewPage",value:function(){(Gh.getState().sdkSettings||{}).WebLinkTarget!==Yo&&(this.newPage=window.open("","_blank"))}},{key:"closeNewPage",value:function(){this.newPage&&"function"==typeof this.newPage.close&&(this.newPage.close(),this.newPage=null)}},{key:"setNewPage",value:function(e){this.newPage&&this.newPage.location&&(this.newPage.location.href=e)}},{key:"getCustomParams",value:function(e){var t=e.requestBody,n=e.formFields,o=e.formData;return n.reduce((function(e,n){for(var i=n.name,a=n.path.split("."),s=0;s<a.length-1;s++){e=e[a[s]]||{}}return o[i]&&(e[a[a.length-1]]=o[i]),t}),t)}},{key:"openTargetURL",value:function(e){if(e){var t=Gh.getState(),n=t.partnerConfig.host;switch(t.sdkSettings.WebLinkTarget){case jo:this.setNewPage(e);break;case Yo:uc.post(K,e);break;case Qo:default:var o=n&&n.location&&n.location.origin;new RegExp("^"+o).test(e)?(this.closeNewPage(),uc.post(K,e)):this.setNewPage(e)}}}},{key:"handleSavedNextAction",value:function(){var e=Gh.getState(),t=e.partnerConfig.customerId,n=e.sdkSettings.NextAction;try{t&&n&&(An("[ActionHandler]","handleSavedNextAction:",n),this.actionProxy({action:n}),Gh.dispatch({type:"REMOVE_SDK_SETTING",setting:"NextAction"}))}catch(e){An("[ActionHandler]","Could not handleSavedNextAction:",e)}}},{key:"handleAPIResponseError",value:function(e){var t=Ka(Wa.REQUEST_FAILURE,Gh.getState().partnerConfig.regionCode),n=void 0;if(e.content){e.content.userMessage&&(t=e.content.userMessage);var o=e.content.invalidInputs;if(o)if(Array.isArray(o)){n={};for(var i=0;i<o.length;i++){var a=o[i];n[a.name]=a.userMessage||!0}}else n=o}Gh.dispatch(Ua(t)),Gh.dispatch(Fa(n))}},{key:"handleAPIResponse",value:function(e){Gh.dispatch(Va(!1));var t=!1;if(e&&e.type)switch(e.type){case bn:this.actionProxy({action:e}),t=!0;break;case Rn:this.handleAPIResponseError(e),t=!0}t||this.handleUnexpectedError()}},{key:"handleUnexpectedError",value:function(){Gh.dispatch(Ua(Ka(Wa.REQUEST_FAILURE,Gh.getState().partnerConfig.regionCode)))}},{key:"handleMissingFieldsError",value:function(e){Gh.getState().partnerConfig.regionCode;var t=Ka(Wa.COMPONENT_VIEW.REQUIRED_FIELD),n={};e.forEach((function(e){n[e]=t})),Gh.dispatch(Ua(Ka(Wa.COMPONENT_VIEW.MISSING_FIELD_ERROR))),Gh.dispatch(Fa(n)),Gh.dispatch(Va(!1))}},{key:"handleResponseAction",value:function(e){var t=e.onComplete,n=e.onResponseAction,o=e.response,i=e.success;if(n){var a=N()({content:{}},n);a.content.data=N()({},a.content.data,{response:o,success:i}),this.apiAction({action:a,onComplete:t})}}},{key:"linkAction",value:function(e){var t=this,n=e.action,o=e.quickReply,i=e.onComplete,a=n&&n.content&&n.content.link,s=n&&n.metadata;this.createNewPage(),a||An("[ActionHandler]","linkAction - link is undefined"),Oc.resolveLink({link:a,data:n&&n.content&&n.content.data||{},onComplete:function(e,n){if(n||!e||!e.link)return An("[ActionHandler]","linkAction - failed resolving link",n),void t.closeNewPage();t.openTargetURL(e.link),"function"==typeof i&&i()}}),Oc.sendAnalyticsEvent({name:Ln,attributes:N()({},s,{link:a,linkText:o&&o.title})})}},{key:"webAction",value:function(e){var t=e.action,n=e.onComplete;this.createNewPage(),this.openTargetURL(t&&t.content&&t.content.url),"function"==typeof n&&n()}},{key:"treewalkAction",value:function(e){var t=e.action,n=e.quickReply,o=e.onComplete;Oc.sendSRSMessage({text:t.content.messageText||n&&n.title,classification:t.content.classification,data:t.content.data,onComplete:o})}},{key:"userLoginAction",value:function(e){var t=e.action,n=e.onComplete,o=t&&t.content;try{Gh.dispatch(Ya({NextAction:o&&o.nextAction})),Gh.dispatch($a(this.handleSavedNextAction)),uc.post(Z,o&&o.partnerPayload),"function"==typeof n&&n()}catch(e){An("[ActionHandler]","userLoginAction:",e)}}},{key:"apiAction",value:function(e){var t=this,n=e.action,o=e.formData,i=e.onComplete;n&&n.content&&n.content.requestPath?(An("[ActionHandler]","apiAction:","formData:",o),Oc.sendAPIActionRequest({action:n,formData:o,onComplete:function(e,o){e?(t.handleAPIResponse(e),n.content.requestPath===yn.SUBMIT_FEEDBACK&&e.type===bn&&uc.post(G.ACTION,{type:nt.INTEGRATION.ACTION.EVENTS.FEEDBACK_RECEIVED})):t.handleUnexpectedError(),"function"==typeof i&&i(e,o)}})):An("[ActionHandler]","apiAction:","invalid action",n)}},{key:"httpAction",value:function(e){var t=this,n=e.action,o=e.formData,i=e.onComplete;An("[ActionHandler]","httpAction:","formData:",o);var a=n.content,s=a.url,r=a.data,c=a.onResponseAction;Oc.sendRequest({onComplete:function(e,n,o){t.handleResponseAction({onResponseAction:c,response:n?n.errorMessage:e,onComplete:i,success:200===o.status})},params:{data:N()({},r,o)},path:s})}},{key:"customPostHttpAction",value:function(e){var t=this,n=e.action,o=e.formData,i=e.onComplete;An("[ActionHandler]","customPostHttpAction:","formData:",o);var a=n.content,s=a.url,r=a.requestBody,c=a.formFields,u=a.requestHeaders,l=a.onResponseAction;Oc.sendHTTPRequest({onComplete:function(e,n,o){t.handleResponseAction({onResponseAction:l,response:n||e,onComplete:i,success:200===o.status})},params:this.getCustomParams({requestBody:r,formFields:c,formData:o}),path:s,headers:u})}},{key:"componentViewAction",value:function(e){var t=e.action,n=e.onComplete;if(t||t.content){var o=t.content,i=o.renderInline,a=o.name,s=o.data,r=o.displayStyle;i||(Gh.dispatch({type:"SET_MODAL_VIEW_DISPLAY_STYLE",modalViewDisplayStyle:r}),Gh.dispatch(Xa(!0)),Gh.dispatch(Ja(!0)),Gh.dispatch(ts(null)),Gh.dispatch(es(null))),Oc.getComponentView({name:a,data:s,onComplete:function(e){i?Gh.dispatch(function(e){return function(t,n){e&&e.root?(t(Ha(Ba(e))),t(Ta(!1)),t({type:"SET_INLINE_FORM_CONTENT",inlineFormContent:e}),t({type:"SET_SHOW_INLINE_FORM",showInlineForm:!0})):n().chat.chatBanner||t(Ea(Wn))}}(e)):Gh.dispatch(function(e,t){return function(n,o){e&&e.root?(n(Ha(Ba(e))),n(Ua(null)),n({type:"ADD_MODAL_VIEW_CONTENT",modalViewContent:e})):(n(es(Ka(Wa.REQUEST_FAILURE,o().partnerConfig.regionCode))),n(ts(t))),n(Ja(!1))}}(e,t)),"function"==typeof n&&n()}})}}},{key:"finishAction",value:function(e){var t=e.action,n=e.onComplete;Gh.dispatch(ns(!0)),Gh.dispatch(qa()),"function"==typeof n&&n();var o=t.content;if(o){o.type===bn&&o.content&&(An("[ActionHandler]","Poorly formatted FINISH Action:",t),o=o.content);var i=o.nextAction;i&&(i.type===bn&&An("[ActionHandler]","Doubly-nested FINISH Action:",t),this.actionProxy({action:i}))}}},{key:"actionProxy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.action||!e.action.type)return An("[ActionHandler]","Missing action or action.type:",e.action),void("function"==typeof e.onComplete&&e.onComplete());var t=this.actionHandlers[e.action.type];if(t){if(An("[ActionHandler]",t.name.substr(6),"action:",e.action),[Xo.API,Xo.HTTP,Xo.CUSTOM_POST_HTTP].indexOf(e.action.type)>-1){var n=Gh.getState(),o=n.form,i=o.formData,a=o.inlineFormContent,s=n.modalView.modalViewContent,r=a||s&&s[s.length-1];if(r&&i){Gh.dispatch(Va(!0)),Gh.dispatch(Ua(null)),Gh.dispatch(Fa(null));var c=Pa(r,i)||{},u=c.missingFields;return void(u&&u.length>0?this.handleMissingFieldsError(u):t(N()({},e,{formData:i,onComplete:function(){Gh.dispatch(Va(!1))}})))}}t(e)}else An("[ActionHandler]","No handler for action:",e.action)}}]),e}()),is=os.handleSavedNextAction,as=os.actionProxy,ss=function(e){return e.map(ka)},rs=function(e,t){if(!e||!t)return null;var n=e.indexOf(t);if(n<0)return null;for(var o=n+1;o<e.length;o++){var i=e[o];if(i.isDisplayable)return i}return null},cs=function(e,t){if(!e||!t)return null;var n=e.indexOf(t);if(n<0)return null;for(var o=n-1;o>=0;o--){var i=e[o];if(i.isDisplayable)return i}return null},us=function(e,t){return e&&e.EventTime&&t&&t.EventTime?Math.abs(e.EventTime-t.EventTime)/1e3/1e3:0},ls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.EventType===ni.COBROWSING_STARTED?Wa.INFOBAND.COBROWSING.STARTED:e.EventType===ni.COBROWSING_ENDED?Wa.INFOBAND.COBROWSING[e.payload&&e.payload.Reason]||Wa.INFOBAND.COBROWSING.ENDED:null},ds=function(){return function(e,t){e({type:"SET_EVENTS",events:t().eventLog.events.filter((function(e){return!e.isPending}))})}},hs=function(e){return{type:"SET_NEW_REP_EVENT",newRepEvent:e}},ps=function(e){return{type:"SET_FIRST_REP_MESSAGE",firstRepMessage:e}},Es=function(e){return{type:"SET_HAS_MORE_EVENTS",hasMoreEvents:e}},ms=void 0,gs=function(e){return function(t){clearTimeout(ms);var n=e.payload;if(n&&n.buttons){var o=n.buttons.filter((function(e){return e.action&&e.action.performImmediately}))[0];o&&as({action:o.action})}ba(e)?(t(Ta(!0)),t(_a(!1))):t(Ta(!1)),t(function(e){return{type:"SET_MOST_RECENT_MESSAGE_EVENT",event:e}}(e)),t({type:"SET_HIDE_NEW_QUESTION_BUTTON",hideNewQuestionButton:n&&n.hideNewQuestionButton||!1}),t(ji()),ms=setTimeout((function(){t((function(e,t){var n=t(),o=n.actionSheet.showActionSheet,i=n.chat.hideNewQuestionButton,a=n.chatInput.showInput,s=n.eventLog.mostRecentMessageEvent,r=n.quickReplies.showQuickReplies,c=s&&s.payload||{},u=c.buttons,l=c.metadata,d=void 0===l?{}:l,h=!yc(u);!i||o||a||r||h||e(Vi({label:he.CONVERSATION_FLOW,type:pe.STUCK,data:{flowId:d.flowId,issueId:d.issueId,flowName:d.flowName}}))}))}),3500)}},Ss=function(e){return function(t){var n=ka({EventFlags:Jo,EventJSON:g()(e),EventTime:1e3*Date.now(),EventType:ni.TEXT_MESSAGE,isPending:!0});t(Cs(n))}},fs=function(e){return function(t,n){t(Es(50===e.length)),t(function(e){return{type:"SET_EVENTS",events:e}}(e));var o=function(e){return bc(e).find((function(e){return Oa(e)}))}(e);o&&t(gs(o)),n().chat.showLoadingView&&t(ha(!1));for(var i=e.length-1;i>=0;i--){var a=e[i];if(a.isDisplayable){t(wi(a.renderKey));break}}t(Li())}},Cs=function(e){return function(t){if(e)switch(e.isDisplayable&&t(vs(e)),e.EventType){case ni.COBROWSING_INVITATION:case ni.COBROWSING_ENDED:t(function(e){return function(t){if(e.EventType===ni.COBROWSING_INVITATION)t(Ia(no));else if(e.EventType===ni.COBROWSING_ENDED){var n=void 0;switch(e.payload&&e.payload.Reason){case 2:n=ro;break;case 3:n=co;break;case 4:n=uo;break;default:n=io}t(Ia(n))}}}(e));break;case ni.NEW_REP:t(hs(e));break;case ni.ISSUE_ENQUEUED:t(ia());break;case ni.CONVERSATION_END:e.payload&&e.payload.buttons&&uc.post(G.ACTION,{type:nt.INTEGRATION.ACTION.EVENTS.FEEDBACK_REQUESTED})}}},vs=function(e){return function(t,n){var o=n(),i=o.chatMessagesView.unreadMessageCount,a=o.form.showInlineForm;Oa(e)&&t(gs(e)),a&&t(qa()),i||t(wi(e.renderKey)),!e.isPending&&e.payload.UIMessageID?t(Is(e)):t({type:"ADD_NEW_EVENT",event:e}),e.isFromCustomer?t(Li()):t(Ts(e))}},Ts=function(e){return function(t,n){var o,i=n(),a=i.chat.isLiveChat,s=i.chatMessagesView.showTypingIndicator,r=i.chatNavBar.soundEnabled,c=i.partnerConfig,u=c.deviceInfo,l=c.sound,d=c.host.notificationPermission,h=i.sdkSettings.ASAPPNotificationsPermissionUI,p=void 0===h?{}:h,E=!1;"hidden"===document.visibilityState&&p.web&&(t(Vi({label:he.WEB_NOTIFICATION,type:pe.OPPORTUNITY,tags:(o={},_()(o,Ee.DEVICE_TYPE,u&&u.deviceType),_()(o,Ee.STATUS,d),o)})),d===Xe&&(uc.post(W,{body:_c(e.payload)}),vc(),E=!0));!E&&l&&r&&a&&vc(),s&&t(Di(!1)),Sc(600)||t({type:"INCREMENT_UNREAD_MESSAGE_COUNT"})}},_s=function(e){return function(t,n){var o=n(),a=o.chat.isLiveChat,s=o.eventLog,r=s.firstRepMessage,c=s.newRepEvent,u=c&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.payload;return t&&t.NewRep&&t.NewRep.CRMRepId||null}(c),l={issueId:e.IssueId,customerId:e.CustomerId,externalSenderId:u||void 0},d=void 0;if(e.isEphemeral){var h=e.payload;if(!h||h.type!==eo)return;d=nt.INTEGRATION.ACTION.EVENTS.FLOW_END,i()(l,{data:h&&h.data})}else if(function(e){return e.EventType===ni.NEW_ISSUE}(e))d=nt.INTEGRATION.ACTION.EVENTS.ISSUE_NEW;else if(function(e){return e.EventType===ni.CONVERSATION_END||e.EventType===ni.CUSTOMER_CONVERSATION_END}(e))d=nt.INTEGRATION.ACTION.EVENTS.ISSUE_END;else if(function(e){return e.EventType===ni.NEW_REP}(e))d=nt.INTEGRATION.ACTION.EVENTS.AGENT_ASSIGNED;else{if(!Oa(e))return;var p=!r&&e.isFromRep;p&&t(ps(e)),d=nt.INTEGRATION.ACTION.EVENTS.MESSAGE_RECEIVED,i()(l,{senderType:e.isFromSRS?nt.INTEGRATION.ACTION.SENDER_TYPES.SRS:nt.INTEGRATION.ACTION.SENDER_TYPES.AGENT,isLiveChat:a,isFirstMessage:e.isFirstSRSMessage||p})}uc.post(G.ACTION,{type:d,detail:l})}},Is=function(e){return function(t,n){var o=n().eventLog.events,i=(e&&e.payload).UIMessageID;As(i,o)?t({type:"SET_EVENTS",events:o.map((function(t){return t.payload.UIMessageID===i?e:t}))}):t({type:"ADD_NEW_EVENT",event:e})}},Ns=function(e,t){return function(n,o){var a=o().eventLog.events;As(e,a)&&n({type:"SET_EVENTS",events:a.map((function(n){return n.payload.UIMessageID===e?i()({},n,t):n}))})}},As=function(e,t){for(var n=!1,o=t.length-1;o>=0;o--)if(t[o].payload.UIMessageID===e){n=!0;break}return n},ys=n("TSYQ"),bs=n.n(ys),Rs=n("vOnD"),Os=n("ufqH"),Ms=Oi()(["\n    background-color: ",";\n"],["\n    background-color: ",";\n"]),ks=Oi()(["\n    color: ",";\n"],["\n    color: ",";\n"]),ws=Rs.default.ul(Ms,(function(e){var t=e.theme.colors;return""+Object(Os.darken)(.03,t.white)})),Ds=Rs.default.li(Ms,(function(e){var t=e.theme.colors;return""+(e.isSelected?t.gray12:"transparent")})),Ls=Rs.default.span(ks,(function(e){return e.theme.colors.onBackground})),Bs=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.handleHover=n.handleHover.bind(n),n.handleSelect=n.handleSelect.bind(n),n.handleUnhover=n.handleUnhover.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.autocomplete&&e.autocomplete.classList.remove("autocomplete_hidden")}),we)}},{key:"componentDidUpdate",value:function(e){e.hideAutoComplete!==this.props.hideAutoComplete&&this.autocomplete&&this.autocomplete.classList[this.props.hideAutoComplete?"add":"remove"]("autocomplete_hidden")}},{key:"handleHover",value:function(e){var t=e.currentTarget.value;this.props.selectAutocomplete(t)}},{key:"handleUnhover",value:function(){this.props.selectAutocomplete(null)}},{key:"handleSelect",value:function(e){var t=e.currentTarget&&e.currentTarget.value;this.props.handleAutocompleteSelect(t)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"autocomplete__container"},s.a.createElement(ws,{id:"chat-input-autocomplete",className:"autocomplete autocomplete_hidden",ref:function(t){return e.autocomplete=t},role:"listbox"},s.a.createElement("div",{"aria-atomic":"true","aria-live":"polite",className:"announcer",role:"status"},!this.props.hideAutoComplete&&s.a.createElement("p",null,this.props.suggestions.length+Wa.AUTOCOMPLETE.ANNOUNCER)),this.props.suggestions.map((function(t,n){var o=e.props.selectedAutocomplete===n;return s.a.createElement(Ds,{key:"autocomplete-"+n,id:"chat-input-autocomplete-option"+n,className:"autocomplete__option",isSelected:o,role:"option","aria-selected":o,value:n,onMouseDown:e.handleSelect,onTouchStart:e.handleSelect,onMouseEnter:e.handleHover,onMouseLeave:e.handleUnhover},s.a.createElement(Ls,null,t))}))))}}]),t}(s.a.Component),Ps=Bs;Bs.propTypes={selectAutocomplete:ki.a.func,handleAutocompleteSelect:ki.a.func,selectedAutocomplete:ki.a.number,suggestions:ki.a.array,hideAutoComplete:ki.a.bool};var Hs,Us,Fs=n("Dbz9"),Vs=n.n(Fs),xs=Vs()({attachment:s.a.createElement("path",{d:"M27.165 3.395L6.36 24.25a13.726 13.726 0 0 0 5.928 23.322 13.664 13.664 0 0 0 13.397-3.935l20.856-20.856-2.774-2.774-20.835 20.856A9.76 9.76 0 0 1 5.99 36.795a9.801 9.801 0 0 1 3.154-9.729L29.928 6.17a5.897 5.897 0 1 1 8.291 8.301L17.384 35.347a1.962 1.962 0 1 1-2.764-2.774l20.836-20.856-2.774-2.774-20.826 20.876a5.928 5.928 0 1 0 8.281 8.312l20.856-20.877A9.801 9.801 0 0 0 36.925.272a9.76 9.76 0 0 0-9.72 3.164l-.04-.041z"}),goBack:s.a.createElement("path",{d:"M44.9196 20.4183H10.5118L25.544 5.30391C26.7454 4.09601 26.7454 2.1138 25.544 0.905887C24.9685 0.325928 24.1872 0 23.3724 0C22.5576 0 21.7762 0.325928 21.2007 0.905887L0.901011 21.3165C-0.300337 22.5244 -0.300337 24.4756 0.901011 25.6835L21.2007 46.0941C22.4021 47.302 24.3427 47.302 25.544 46.0941C26.7454 44.8862 26.7454 42.9349 25.544 41.727L10.5118 26.6127H44.9196C46.6138 26.6127 48 25.2189 48 23.5155C48 21.812 46.6138 20.4183 44.9196 20.4183Z"}),navCheck:s.a.createElement("path",{d:"M15.2541 35.1916L3.87492 23.686L0 27.5763L15.2541 43L48 9.89039L44.1524 6L15.2541 35.1916Z"}),close:s.a.createElement("path",{d:"M48.17 5.87l-5.7-5.7-18.3 18.3L5.87.17l-5.7 5.7 18.3 18.3-18.3 18.3 5.7 5.7 18.3-18.3 18.3 18.3 5.7-5.7-18.3-18.3z"}),downArrow:s.a.createElement("path",{d:"M43.77 10L24 29.72 4.24 10 0 14.22l19.77 19.72L24 38.17l24-23.94z"}),leftArrow:s.a.createElement("path",{d:"M38.75 40.53l-5.99 5.988L10 23.76 32.758 1l5.991 5.989L21.977 23.76z"}),loading:s.a.createElement("path",{d:"M24.02 0l.708 4.013A20.36 20.36 0 0 0 24 4C12.954 4 4 12.954 4 24s8.954 20 20 20c8.565 0 15.872-5.384 18.723-12.951l3.997.705C43.496 41.204 34.542 48 24 48 10.745 48 0 37.255 0 24S10.745 0 24 0h.02z"}),minimize:s.a.createElement("path",{d:"M3 21h42v6H3z"}),more:s.a.createElement("path",{d:"M23.538 11.077a5.531 5.531 0 0 0 5.539-5.539A5.531 5.531 0 0 0 23.538 0 5.531 5.531 0 0 0 18 5.538a5.531 5.531 0 0 0 5.538 5.539zm0 7.385A5.531 5.531 0 0 0 18 24a5.531 5.531 0 0 0 5.538 5.538A5.531 5.531 0 0 0 29.077 24a5.531 5.531 0 0 0-5.539-5.538zm0 18.461A5.531 5.531 0 0 0 18 42.462 5.531 5.531 0 0 0 23.538 48a5.531 5.531 0 0 0 5.539-5.538 5.531 5.531 0 0 0-5.539-5.539z"}),newQuestion:s.a.createElement("path",{d:"M30.445 44.8c-2.107.52-4.27.781-6.44.776C10.763 45.576 0 36.026 0 24.288 0 12.552 10.763 3 23.995 3 37.227 3 48 12.552 48 24.288c0 4.64-1.725 9.179-4.872 12.861.667 1.456 1.627 2.6 2.872 3.427.656.432.96 1.19.795 1.947a1.81 1.81 0 0 1-1.52 1.4c-2 .285-5.902.424-9.499-1.742a1.208 1.208 0 0 1 .326-2.205c.31-.078.638-.03.911.136 2.254 1.368 4.686 1.627 6.467 1.557-1.264-1.133-2.224-2.592-2.87-4.333a1.221 1.221 0 0 1 .243-1.24c3.11-3.387 4.755-7.467 4.755-11.808 0-10.408-9.693-18.875-21.603-18.875C12.096 5.413 2.4 13.88 2.4 24.288S12.093 43.165 24 43.165c1.992 0 3.973-.237 5.875-.709a1.208 1.208 0 0 1 .568 2.344h.002zm-6.429-18.965a1.541 1.541 0 0 1-1.541-1.547 1.541 1.541 0 0 1 3.077 0c0 .853-.688 1.547-1.536 1.547zm6.624 0a1.541 1.541 0 0 1-1.539-1.547c0-.853.691-1.547 1.539-1.547.85 0 1.539.694 1.539 1.547s-.688 1.547-1.539 1.547zm-13.253 0a1.541 1.541 0 0 1-1.536-1.547c0-.853.688-1.547 1.538-1.547.848 0 1.539.694 1.539 1.547s-.69 1.547-1.539 1.547h-.002z"}),send:s.a.createElement("path",{d:"M0 8.89V20l36 4-36 4v11.11a4 4 0 0 0 5.47 3.72l40.4-17.21a2 2 0 0 0 0-3.71L5.47 5.17A4 4 0 0 0 0 8.89z"}),upArrow:s.a.createElement("path",{d:"M43.77 38.17L24 18.45 4.24 38.17 0 33.94l19.77-19.72L24 10l24 23.94-4.23 4.23z"}),dockRight:s.a.createElement("g",null,s.a.createElement("mask",{id:"mask-path-1"},s.a.createElement("path",{d:"M28.8 38.6V9.8H4.8V38.6H28.8ZM28.8 5H43.2H46C47.1046 5 48 5.89543 48 7V9.8V38.6V41.4C48 42.5046 47.1046 43.4 46 43.4H43.2H28.8H4.8C2.14903 43.4 0 41.251 0 38.6V9.8C0 7.14903 2.14903 5 4.8 5H28.8Z"})),s.a.createElement("path",{d:"M28.8 38.6V9.8H4.8V38.6H28.8ZM28.8 5H43.2H46C47.1046 5 48 5.89543 48 7V9.8V38.6V41.4C48 42.5046 47.1046 43.4 46 43.4H43.2H28.8H4.8C2.14903 43.4 0 41.251 0 38.6V9.8C0 7.14903 2.14903 5 4.8 5H28.8Z"}),s.a.createElement("path",{d:"M28.8 38.6V40.6H30.8V38.6H28.8ZM28.8 9.8H30.8V7.8H28.8V9.8ZM4.8 9.8V7.8H2.8V9.8H4.8ZM4.8 38.6H2.8V40.6H4.8V38.6ZM30.8 38.6V9.8H26.8V38.6H30.8ZM28.8 7.8H4.8V11.8H28.8V7.8ZM2.8 9.8V38.6H6.8V9.8H2.8ZM4.8 40.6H28.8V36.6H4.8V40.6ZM28.8 7H43.2V3H28.8V7ZM43.2 7H46V3H43.2V7ZM46 7H50C50 4.79086 48.2091 3 46 3V7ZM46 7V9.8H50V7H46ZM46 9.8V38.6H50V9.8H46ZM46 38.6V41.4H50V38.6H46ZM46 41.4V45.4C48.2091 45.4 50 43.6091 50 41.4H46ZM46 41.4H43.2V45.4H46V41.4ZM43.2 41.4H28.8V45.4H43.2V41.4ZM4.8 45.4H28.8V41.4H4.8V45.4ZM-2 38.6C-2 42.3555 1.04447 45.4 4.8 45.4V41.4C3.2536 41.4 2 40.1464 2 38.6H-2ZM-2 9.8V38.6H2V9.8H-2ZM4.8 3C1.04446 3 -2 6.04446 -2 9.8H2C2 8.2536 3.2536 7 4.8 7V3ZM28.8 3H4.8V7H28.8V3Z",mask:"url(#mask-path-1)"})),dockLeft:s.a.createElement("g",null,s.a.createElement("mask",{id:"mask-path-1"},s.a.createElement("path",{d:"M2 5H4.8H19.2H43.2C45.851 5 48 7.14903 48 9.8V38.6C48 41.251 45.851 43.4 43.2 43.4H19.2H4.8H2C0.895431 43.4 0 42.5046 0 41.4V38.6V9.8V7C0 5.89543 0.89543 5 2 5ZM19.2 38.6H43.2V9.8H19.2V38.6Z"})),s.a.createElement("path",{d:"M2 5H4.8H19.2H43.2C45.851 5 48 7.14903 48 9.8V38.6C48 41.251 45.851 43.4 43.2 43.4H19.2H4.8H2C0.895431 43.4 0 42.5046 0 41.4V38.6V9.8V7C0 5.89543 0.89543 5 2 5ZM19.2 38.6H43.2V9.8H19.2V38.6Z"}),s.a.createElement("path",{d:"M19.2 38.6H17.2V40.6H19.2V38.6ZM43.2 38.6V40.6H45.2V38.6H43.2ZM43.2 9.8H45.2V7.8H43.2V9.8ZM19.2 9.8V7.8H17.2V9.8H19.2ZM4.8 3H2V7H4.8V3ZM19.2 3H4.8V7H19.2V3ZM43.2 3H19.2V7H43.2V3ZM50 9.8C50 6.04446 46.9555 3 43.2 3V7C44.7464 7 46 8.2536 46 9.8H50ZM50 38.6V9.8H46V38.6H50ZM43.2 45.4C46.9555 45.4 50 42.3555 50 38.6H46C46 40.1464 44.7464 41.4 43.2 41.4V45.4ZM19.2 45.4H43.2V41.4H19.2V45.4ZM4.8 45.4H19.2V41.4H4.8V45.4ZM2 45.4H4.8V41.4H2V45.4ZM-2 41.4C-2 43.6091 -0.20914 45.4 2 45.4V41.4H-2ZM-2 38.6V41.4H2V38.6H-2ZM-2 9.8V38.6H2V9.8H-2ZM-2 7V9.8H2V7H-2ZM2 3C-0.209141 3 -2 4.79086 -2 7H2H2V3ZM19.2 40.6H43.2V36.6H19.2V40.6ZM45.2 38.6V9.8H41.2V38.6H45.2ZM43.2 7.8H19.2V11.8H43.2V7.8ZM21.2 38.6V9.8H17.2V38.6H21.2Z",mask:"url(#mask-path-1)"})),bell:s.a.createElement("path",{d:"M38.4435 33.2306V20.923C38.4435 13.3661 34.5197 7.03997 27.6109 5.36613V3.69229C27.6109 1.64922 25.9981 0 24.0001 0C22.0021 0 20.3892 1.64922 20.3892 3.69229V5.36613C13.5046 7.03997 9.55671 13.3415 9.55671 20.923V33.2306L4.74225 38.1539V40.6154H43.258V38.1539L38.4435 33.2306ZM24.0001 48C26.648 48 28.8145 45.7842 28.8145 43.0769H19.1856C19.1856 45.7842 21.3521 48 24.0001 48ZM14.3712 35.6922H33.629V20.923C33.629 14.8184 29.9941 9.84611 24.0001 9.84611C18.0061 9.84611 14.3712 14.8184 14.3712 20.923V35.6922ZM13.3601 3.88921L9.91779 0.369229C4.14044 4.87383 0.337012 11.8153 0 19.6922H4.81447C5.17555 13.1692 8.44938 7.45843 13.3601 3.88921ZM48 19.6922H43.1855C42.8247 13.1692 39.5266 7.45843 34.6641 3.88921L38.0822 0.369229C43.8357 4.87383 47.6391 11.8153 48 19.6922Z"}),phone:s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M37.1513 32.2751L43.9247 33.0484C46.618 33.3684 48.6447 35.6351 48.618 38.3284V42.9417C48.618 45.9551 46.1113 48.4617 43.098 48.2751C20.3513 46.8617 2.13797 28.6751 0.72464 5.90177C0.537973 2.88843 3.04464 0.38176 6.05797 0.38176H10.6713C13.3913 0.38176 15.658 2.40843 15.978 5.10177L16.7513 11.8218C16.938 13.4484 16.378 15.0484 15.2313 16.1951L10.298 21.1284C14.138 28.7017 20.3247 34.8617 27.8713 38.7017L32.778 33.7951C33.9247 32.6484 35.5247 32.0884 37.1513 32.2751ZM26.9913 5.82177C35.4713 6.88843 42.1113 13.5284 43.178 22.0084C43.338 23.3684 44.4847 24.3551 45.818 24.3551C45.9247 24.3551 46.0313 24.3551 46.138 24.3284C47.6047 24.1417 48.6447 22.8084 48.458 21.3417C47.098 10.4351 38.538 1.8751 27.6313 0.515093C26.1647 0.355093 24.8313 1.39509 24.6713 2.86177C24.4847 4.32843 25.5247 5.66177 26.9913 5.82177ZM28.0047 11.4484C26.5913 11.0751 25.1247 11.9284 24.7513 13.3684C24.378 14.8084 25.2313 16.2484 26.6713 16.6217C29.4713 17.3417 31.658 19.5284 32.4047 22.3551C32.7247 23.5551 33.7913 24.3551 34.9913 24.3551C35.2047 24.3551 35.4447 24.3284 35.658 24.2751C37.0713 23.9017 37.9247 22.4351 37.578 21.0217C36.3247 16.3017 32.6713 12.6484 28.0047 11.4484Z"})});function Gs(e){var t=e.hidden,n=e.className,o=e.iconName,i=e.title,a=xs[o];if(void 0===a)return An("Icon.js","Icon not found",a),null;var r=["icon","icon_"+o,n].join(" ").trim(),c={"aria-hidden":!(i.length>0)&&t,className:r,fill:"#000",height:"48",role:"img",title:i.length>0?i:null,viewBox:"0 0 48 48",width:"48",xmlns:"http://www.w3.org/2000/svg"};return s.a.createElement("svg",c,a)}Gs.defaultProps={hidden:!0,title:""},Gs.propTypes={hidden:ki.a.bool,className:ki.a.string,iconName:ki.a.string.isRequired,title:ki.a.string};var qs=40,Ws=37,Ks=13,js=39,Qs=38,Ys=(Hs={},_()(Hs,qs,!0),_()(Hs,Qs,!0),Hs),Zs=(i()({},Ys,(Us={},_()(Us,Ws,!0),_()(Us,js,!0),Us)),new RegExp(/[0-9]|\.|,|-|\+/)),$s=function(e){return e.keyCode===Ks},zs=Oi()(["\n    background-color: ",";\n    border-color: transparent;\n    color: ",";\n\n    &:focus {\n        border: ",";\n    }\n\n    &::placeholder {\n        color: ",";\n    }\n"],["\n    background-color: ",";\n    border-color: transparent;\n    color: ",";\n\n    &:focus {\n        border: ",";\n    }\n\n    &::placeholder {\n        color: ",";\n    }\n"]),Xs=Oi()(["\n    .icon {\n        fill: ",";\n    }\n\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n"],["\n    .icon {\n        fill: ",";\n    }\n\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n"]),Js=Rs.default.textarea(zs,(function(e){return e.theme.colors.background}),(function(e){return e.theme.colors.onBackground}),(function(e){return"2px solid "+e.theme.colors.gray25}),(function(e){var t=e.theme.colors;return Object(Os.rgba)(t.onBackground,.65)})),er=Rs.default.button(Xs,(function(e){var t=e.theme.colors;return e.disabled?t.gray50:t.primary}),(function(e){return e.theme.colors.gray5})),tr=[nr],nr=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.state={sendButtonActive:!1,isActive:!1},n.chatInputLabel=Ka(Wa.CHAT_INPUT.PLACEHOLDER_TEXT,n.props.regionCode),n.keystrokesCount=0,n.requestList=[],n.analyticsData={},n.onTouchMove=n.onTouchMove.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.onKeyPress=n.onKeyPress.bind(n),n.onLabelKeyDown=n.onLabelKeyDown.bind(n),n.onChange=n.onChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.isEmpty=n.isEmpty.bind(n),n.clearInput=n.clearInput.bind(n),n.sendTextMessage=n.sendTextMessage.bind(n),n.sendSRSMessage=n.sendSRSMessage.bind(n),n.updateInputHeight=n.updateInputHeight.bind(n),n.fetchAutocomplete=n.fetchAutocomplete.bind(n),n.hasAutocomplete=n.hasAutocomplete.bind(n),n.handleAutocompleteSelect=n.handleAutocompleteSelect.bind(n),n.handleAnalyticsData=n.handleAnalyticsData.bind(n),n.handleFileInputClick=n.handleFileInputClick.bind(n),n.navigateAutocomplete=n.navigateAutocomplete.bind(n),n.handleFocus=n.handleFocus.bind(n),n.handleBlur=n.handleBlur.bind(n),n}return bi()(t,e),v()(t,[{key:"componentWillUnmount",value:function(){var e=document.getElementById(lr);e&&e.focus()}},{key:"componentDidUpdate",value:function(e){e.isDocked!==this.props.isDocked&&this.updateInputHeight()}},{key:"handleFocus",value:function(){var e=this;this.setState({isActive:!0}),ot()&&(this.props.setShowQuickReplies(!1),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return/Android/i.test(e)}()&&setTimeout((function(){e.props.scrollToBottom()}),Be))}},{key:"handleBlur",value:function(){this.setState({isActive:!1}),this.props.selectAutocomplete(null),this.isEmpty()&&ba(this.props.mostRecentMessageEvent)&&this.props.setShowQuickReplies(!0)}},{key:"onTouchMove",value:function(e){e.preventDefault()}},{key:"onKeyDown",value:function(e){var t;this.hasAutocomplete()&&(t=e.nativeEvent,Ys[t.keyCode])&&this.navigateAutocomplete(e.nativeEvent.keyCode===qs)}},{key:"onKeyPress",value:function(e){$s(e.nativeEvent)?(e.preventDefault(),null!==this.props.selectedAutocomplete?this.handleAutocompleteSelect(this.props.selectedAutocomplete):this.onSubmit(e)):this.props.isLiveChat||this.keystrokesCount++}},{key:"onLabelKeyDown",value:function(e){$s(e.nativeEvent)&&e.target&&e.target.click()}},{key:"onChange",value:function(){var e=this._textarea.value;this.props.isLiveChat?Oc.sendTypingPreview({text:e}):e?this.fetchAutocomplete(e):(!ot()&&ba(this.props.mostRecentMessageEvent)&&this.props.setShowQuickReplies(!0),this.props.resetAutocomplete()),this.setState({sendButtonActive:!this.isEmpty()}),this.updateInputHeight()}},{key:"onSubmit",value:function(){var e=this._textarea.value;this.isEmpty(e)?An(tr,"Unable to send empty message."):e.length>1e4?this.props.setChatBanner(Kn):this.props.isLiveChat?(this.sendTextMessage(e),this._textarea.focus()):(this.sendSRSMessage(e),this.props.setShowInput(!1))}},{key:"isEmpty",value:function(e){var t=e||this._textarea.value;return!/\S/.test(t||"")}},{key:"clearInput",value:function(){this._textarea&&(this._textarea.value=""),this.setState({sendButtonActive:!1}),this.keystrokesCount=0,this.analyticsData={},this.requestList=[],this.props.resetAutocomplete()}},{key:"sendTextMessage",value:function(e){Oc.sendTypingPreview({text:""}),Oc.sendTextMessage({text:e}),this.clearInput()}},{key:"sendSRSMessage",value:function(e){this.analyticsData.KeystrokesAfterSelection=this.keystrokesCount,this.props.setQuickRepliesDisabled(!0),Oc.sendSRSMessage({text:e,CustAutoCompleteAnalytics:this.analyticsData}),this.clearInput()}},{key:"updateInputHeight",value:function(){if(this._textarea)if(this.props.displaySettings.FrameStyle===qe&&this.props.isDocked)this._textarea.style.height="";else{var e=this._textarea.scrollHeight;e<=83&&(this._textarea.style.height="auto",this._textarea.style.height=this._textarea.scrollHeight+4+"px"),e>83&&!this.isEmpty()?(this._textarea.classList.add("scrollable"),this._textarea.style.height<83&&(this._textarea.style.height="83px")):this._textarea.classList.contains("scrollable")&&this._textarea.classList.remove("scrollable")}}},{key:"fetchAutocomplete",value:function(e){var t=this;this.requestList.push(e),Oc.requestAutocomplete({params:{text:e,number:4},onComplete:function(n){var o=t.requestList.indexOf(e);if(!(t._textarea&&!t._textarea.value||o<0))if(t.requestList=t.requestList.slice(o+1),n&&n.Suggestions){t.props.setShowQuickReplies(!1);var a=i()({},n,{Original:e});t.props.setAutocomplete(a)}else t.hasAutocomplete()&&t.props.resetAutocomplete()}})}},{key:"hasAutocomplete",value:function(){return this.props.autocomplete&&this.props.autocomplete.Suggestions&&this.props.autocomplete.Suggestions.length>0}},{key:"handleAutocompleteSelect",value:function(e){if(null!==e){var t=this.props.autocomplete.Suggestions[e];this._textarea&&t&&(this._textarea.focus(),this._textarea.value=t,this.updateInputHeight(),this.handleAnalyticsData(e,t),this.props.resetAutocomplete())}}},{key:"handleAnalyticsData",value:function(e,t){var n=this.props.autocomplete,o=n.ResponseId,i=n.Suggestions,a=n.Original;this.analyticsData={KeystrokesBeforeSelection:this.keystrokesCount,Suggestion:t,Index:e,ResponseId:o,Original:a,ReturnedCount:i.length,DisplayedCount:i.length},this.keystrokesCount=0}},{key:"handleFileInputClick",value:function(e){e&&e.target&&(e.target.value=null)}},{key:"navigateAutocomplete",value:function(e){var t=this.props.autocomplete.Suggestions.length-1,n=this.props.selectedAutocomplete,o=void 0;o=null===n||n<0||n>t?e?0:t:e?n+1:n-1,this.props.selectAutocomplete(o)}},{key:"render",value:function(){var e=this,t=this.hasAutocomplete(),n=this.props.sdkSettings,o=n.IsDocumentUploadingEnabled,i=n.IsPhotoUploadingEnabled,a=n.SupportedUploadMIMETypes,r=void 0===a?[]:a,c={className:bs()("chatInput__textarea",{chatInput__textarea_sideBar:this.props.displaySettings.FrameStyle===qe&&this.props.isDocked}),id:"chat-input",autoComplete:"off","aria-label":this.chatInputLabel,"aria-expanded":t?this.state.isActive:void 0,"aria-autocomplete":"list",onBlur:this.handleBlur,onChange:this.onChange,onFocus:this.handleFocus,onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress,onTouchMove:this.onTouchMove,placeholder:this.chatInputLabel,ref:function(t){e._textarea=t},rows:"1","aria-activedescendant":null!==this.props.selectedAutocomplete?"chat-input-autocomplete-option"+this.props.selectedAutocomplete:void 0,role:t?"combobox":void 0},u={className:bs()("chatInput__sendButton",{chatInput__sendButton_disabled:!this.state.sendButtonActive}),disabled:!this.state.sendButtonActive,onClick:this.onSubmit,title:Ka(Wa.CHAT_INPUT.SEND_BUTTON_TEXT,this.props.regionCode),type:"submit"},l={id:"chat-input-file-hidden",name:"file",onChange:this.props.sendFile,type:"file",accept:r.join(","),onClick:this.handleFileInputClick};return s.a.createElement("footer",{"aria-label":Ka(Wa.CHAT_INPUT.REGION_TITLE,this.props.regionCode),className:bs()("chatInput",{chatInput_hidden:!this.props.showInput,chatInput_active:this.state.isActive}),ref:function(t){e._container=t},tabIndex:"-1"},t&&s.a.createElement(Ps,{suggestions:this.props.autocomplete.Suggestions,selectAutocomplete:this.props.selectAutocomplete,selectedAutocomplete:this.props.selectedAutocomplete,handleAutocompleteSelect:this.handleAutocompleteSelect,hideAutoComplete:!this.state.isActive}),s.a.createElement(Js,c),s.a.createElement("div",{className:"chatInput__buttonContainer"},this.props.isLiveChat&&(o||i)&&s.a.createElement("form",{className:"chatInput__attachmentButton__form"},s.a.createElement(er,{as:"label",className:"chatInput__attachmentButton",htmlFor:"chat-input-file-hidden",title:Ka(Wa.CHAT_INPUT.ADD_ATTACHMENT,this.props.regionCode),tabIndex:"0",onKeyDown:this.onLabelKeyDown},s.a.createElement(Gs,{iconName:"attachment"})),s.a.createElement("input",l)),s.a.createElement(er,u,s.a.createElement(Gs,{iconName:"send"}))))}}]),t}(s.a.Component);nr.propTypes={autocomplete:ki.a.object,mostRecentMessageEvent:ki.a.object,displaySettings:ki.a.object,isDocked:ki.a.bool,isLiveChat:ki.a.bool,sendFile:ki.a.func.isRequired,regionCode:ki.a.string.isRequired,resetAutocomplete:ki.a.func,scrollToBottom:ki.a.func,sdkSettings:ki.a.object.isRequired,selectAutocomplete:ki.a.func,selectedAutocomplete:ki.a.number,setAutocomplete:ki.a.func,setChatBanner:ki.a.func,setQuickRepliesDisabled:ki.a.func,setShowInput:ki.a.func,setShowQuickReplies:ki.a.func,showInput:ki.a.bool};var or=Object(d.connect)((function(e){var t=e.chat,n=e.chatInput,o=e.eventLog,i=e.partnerConfig,a=e.sdkSettings;return{autocomplete:n.autocomplete,displaySettings:i.displaySettings,isDocked:t.isDocked,sdkSettings:a,selectedAutocomplete:n.selectedAutocomplete,regionCode:i.regionCode,showInput:n.showInput,isLiveChat:t.isLiveChat,mostRecentMessageEvent:o.mostRecentMessageEvent}}),(function(e){return{setAutocomplete:function(t){e(function(e){return{type:"SET_AUTOCOMPLETE",autocomplete:e}}(t))},resetAutocomplete:function(){e({type:"RESET_AUTOCOMPLETE"})},selectAutocomplete:function(t){e(function(e){return{type:"SELECT_AUTOCOMPLETE",selectedAutocomplete:e}}(t))},setChatBanner:function(t){e(Ea(t))},setQuickRepliesDisabled:function(t){e(_a(t))},scrollToBottom:function(){e(Li())},setShowQuickReplies:function(t){e(Ta(t))},setShowInput:function(t){e(Ki(t))},sendFile:function(t){e(va(t))}}}))(nr),ir=Oi()(["\n    background-color: ",";\n    border-top: ",";\n\n    + .chatInput {\n        border-top: ",";\n    }\n"],["\n    background-color: ",";\n    border-top: ",";\n\n    + .chatInput {\n        border-top: ",";\n    }\n"]),ar=Oi()(["\n    border-color: ",";\n    color: ",";\n\n    &:active,\n    &:focus {\n        -webkit-tap-highlight-color: ",";\n    }\n\n    &:focus:enabled,\n    &:hover:enabled {\n        background-color: ",";\n        border-color: ",";\n        color: ",";\n        cursor: pointer;\n    }\n\n    @media (pointer: coarse) {\n        &:hover:enabled {\n            background-color: transparent;\n            border-color: ",";\n            color: ",";\n        }\n    }\n"],["\n    border-color: ",";\n    color: ",";\n\n    &:active,\n    &:focus {\n        -webkit-tap-highlight-color: ",";\n    }\n\n    &:focus:enabled,\n    &:hover:enabled {\n        background-color: ",";\n        border-color: ",";\n        color: ",";\n        cursor: pointer;\n    }\n\n    @media (pointer: coarse) {\n        &:hover:enabled {\n            background-color: transparent;\n            border-color: ",";\n            color: ",";\n        }\n    }\n"]),sr=Rs.default.div(ir,(function(e){var t=e.theme.colors;return""+Object(Os.rgba)(t.onBackground,.05)}),(function(e){return"1px solid "+e.theme.colors.borderColor}),(function(e){var t=e.theme.colors;return""+(e.hidden&&"1px solid "+t.borderColor)})),rr=Rs.default.button(ar,(function(e){return e.theme.colors.quickReplyButtonPrimary}),(function(e){return e.theme.colors.quickReplyButtonPrimary}),(function(e){var t=e.theme.colors;return""+Object(Os.rgba)(t.quickReplyButtonPrimary,.25)}),(function(e){return e.theme.colors.quickReplyButtonPrimary}),(function(e){return e.theme.colors.quickReplyButtonPrimary}),(function(e){return e.theme.colors.quickReplyButtonOnPrimary}),(function(e){return e.theme.colors.quickReplyButtonPrimary}),(function(e){return e.theme.colors.quickReplyButtonPrimary})),cr=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.state={animating:!0},n.onClick=n.onClick.bind(n),n.renderQuickReplyButton=n.renderQuickReplyButton.bind(n),n.setAnimationTimeout=n.setAnimationTimeout.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.setAnimationTimeout()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"componentDidUpdate",value:function(e){e.mostRecentMessageEvent!==this.props.mostRecentMessageEvent&&(this.quickReplies&&(this.quickReplies.scrollTop=0),this.setState({animating:!0}),this.setAnimationTimeout())}},{key:"setAnimationTimeout",value:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.setState({animating:!1})}),He+3*Ue)}},{key:"getScrollbarMinimum",value:function(){return window.innerHeight>550?3:window.innerHeight>=415?2:1}},{key:"onClick",value:function(e){if(e&&!this.props.quickRepliesDisabled){this.props.setQuickRepliesDisabled(!0),this.props.setShowInput(!1),as({action:e.action,quickReply:e});var t=this.props.mostRecentMessageEvent&&this.props.mostRecentMessageEvent.payload&&this.props.mostRecentMessageEvent.payload.metadata,n=e.action&&e.action.content&&e.action.content.metadata;Oc.sendAnalyticsEvent({name:wn,attributes:{metadata:n,messageMetadata:t,quickReplyText:e.title}})}}},{key:"renderQuickReplyButton",value:function(e){var t=this,n=e.title,o=e.action;return n&&o?s.a.createElement(rr,{key:n,className:"quickReplies__button",disabled:this.state.animating||this.props.quickRepliesDisabled,onClick:function(){t.onClick(e)}},n):null}},{key:"render",value:function(){var e=this,t=this.props,n=t.isLiveChat,o=t.isBlocked,i=t.mostRecentMessageEvent,a=(t.regionCode,t.showQuickReplies),r=ya(i)||[],c=o||n||!a;return s.a.createElement(sr,{"aria-flowto":"chat-input","aria-haspopup":"false","aria-label":Ka(Wa.QUICK_REPLY.REGION_TITLE),className:bs()("quickReplies",{quickReplies_animating:this.state.animating,quickReplies_hidden:c,quickReplies_transparent:0===r.length,quickReplies_noScrollbar:r.length<=this.getScrollbarMinimum(),quickReplies_disabled:this.props.quickRepliesDisabled}),id:"quick-replies-container",role:"region",tabIndex:"-1",ref:function(t){return e.quickReplies=t},hidden:c},r.map(this.renderQuickReplyButton))}}]),t}(s.a.Component),ur=Object(d.connect)((function(e){var t=e.chat,n=e.eventLog,o=e.partnerConfig,i=e.quickReplies;return{showQuickReplies:i.showQuickReplies,regionCode:o.regionCode,isLiveChat:t.isLiveChat,isBlocked:t.isBlocked,quickRepliesDisabled:i.quickRepliesDisabled,mostRecentMessageEvent:n.mostRecentMessageEvent}}),(function(e){return{setQuickRepliesDisabled:function(t){e(_a(t))},setShowInput:function(t){e(Ki(t))}}}))(cr);cr.propTypes={regionCode:ki.a.string,isLiveChat:ki.a.bool,isBlocked:ki.a.bool,showQuickReplies:ki.a.bool,quickRepliesDisabled:ki.a.bool,setQuickRepliesDisabled:ki.a.func,setShowInput:ki.a.func,mostRecentMessageEvent:ki.a.object};var lr="announcer",dr=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.getAnnouncementText=n.getAnnouncementText.bind(n),n}return bi()(t,e),v()(t,[{key:"getAnnouncementText",value:function(){var e=this.props,t=e.mostRecentMessageEvent;e.regionCode;if(!t||!t.payload)return null;var n=t.payload,o=[Ka(t.isFromCustomer?Wa.ANNOUNCER.USER:Wa.ANNOUNCER.SUPPORT)];return n.text&&o.push(n.text),n.attachment&&o.push.apply(o,R()(this.getTextContent(n.attachment))),n.buttons&&o.push(n.buttons.map((function(e){return Ka(Wa.ANNOUNCER.BUTTON)+", "+e.title}))),o.length>1?o.join(". "):null}},{key:"getTextContent",value:function(e){return(La(e,!0)||[]).filter((function(e){return"label"===e.type})).map((function(e){return e.content&&e.content.text}))}},{key:"render",value:function(){return s.a.createElement("div",{"aria-atomic":"true","aria-flowto":"quick-replies-container","aria-live":"assertive",className:"announcer",id:lr,role:"alert"},s.a.createElement("p",null,this.getAnnouncementText()))}}]),t}(s.a.Component);dr.propTypes={mostRecentMessageEvent:ki.a.object,regionCode:ki.a.string};var hr=Object(d.connect)((function(e){var t=e.eventLog,n=e.partnerConfig;return{mostRecentMessageEvent:t.mostRecentMessageEvent,regionCode:n.regionCode}}))(dr),pr=n("RotF"),Er=n.n(pr),mr=Oi()(["\n    background-color: ",";\n    color: ",";\n\n    &:active,\n    &:focus {\n        box-shadow: ",";\n    }\n"],["\n    background-color: ",";\n    color: ",";\n\n    &:active,\n    &:focus {\n        box-shadow: ",";\n    }\n"]),gr=Rs.default.button(mr,(function(e){return e.theme.colors.gray85}),(function(e){return e.theme.colors.white}),(function(e){return"0 0 2px 3px "+e.theme.colors.primary})),Sr=function(e){var t=e.unreadMessageCount,n=(e.regionCode,e.onClick);if(!t)return!1;var o=t>10?"10+":t,i=Ka(1===t?Wa.UNREAD_MESSAGE_TEXT:Wa.UNREAD_MESSAGES_TEXT);return s.a.createElement(gr,{"aria-atomic":"true",className:"unreadMessageIndicator",onClick:n,role:"status"},o+" "+i)};Sr.propTypes={unreadMessageCount:ki.a.number,regionCode:ki.a.string.isRequired,onClick:ki.a.func};var fr=Sr,Cr=n("YjrL"),vr=n.n(Cr),Tr=Oi()(["\n    background-color: ",";\n    border: ",";\n"],["\n    background-color: ",";\n    border: ",";\n"]),_r=Rs.default.div(Tr,(function(e){return e.theme.colors.white}),(function(e){return"1px solid "+e.theme.colors.borderColor})),Ir=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.focusInput=n.focusInput.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.focusInput(),this.props.scrollToBottom()}},{key:"componentDidUpdate",value:function(e){e.isHandlingAction&&!this.props.isHandlingAction&&this.focusInput()}},{key:"focusInput",value:function(){var e=this.inlineForm.querySelector("input");e&&e.focus()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"inlineForm",id:"inline-form",ref:function(t){return e.inlineForm=t}},s.a.createElement(_r,{className:"inlineForm__content"},s.a.createElement(vr.a,{component:this.props.inlineFormContent.root,styles:this.props.inlineFormContent.styles,formData:this.props.formData,formErrors:this.props.formErrors,isLoading:this.props.isHandlingAction,saveFormData:this.props.saveFormData,theme:this.props.theme,actionHandler:as})))}}]),t}(s.a.Component);Ir.propTypes={formData:ki.a.object,formErrors:ki.a.object,theme:ki.a.object,inlineFormContent:ki.a.object.isRequired,isHandlingAction:ki.a.bool,saveFormData:ki.a.func,scrollToBottom:ki.a.func};var Nr=Object(d.connect)((function(e){var t=e.form,n=e.partnerConfig;return{inlineFormContent:t.inlineFormContent,formData:t.formData,formErrors:t.formErrors,isHandlingAction:t.isHandlingAction,theme:n.theme}}),(function(e){return{saveFormData:function(t){e(Ga(t))},scrollToBottom:function(){e(Li())}}}))(Ir),Ar=n("+80P"),yr=n.n(Ar),br=n("johb"),Rr=function(e){return"us"===(e=(e||"US").toLowerCase())&&(e="en-"+e),e},Or=function(e,t){if(!e)return null;t=Rr(t);var n=new Date(e),o={hour:"numeric",minute:"numeric",hour12:["en-us","us"].indexOf(t)>-1};return""+n.toLocaleTimeString(t,o)},Mr={background:"#fff",black:"#000",error:"#c30019",onBackground:"#000",onPrimary:"#fff",primary:"#0078d2",success:"#008266",warning:"#faaf00",white:"#fff"},kr="primary",wr="textPrimary",Dr="secondary";function Lr(e){var t=e.background,n=void 0===t?"transparent":t,o=e.text,i=e.border,a=void 0===i?"transparent":i,s=e.hoverBackground,r=e.disabledBackground,c=e.disabledBorder,u=e.disabledText;return"\n    background-color: "+n+";\n    border-color: "+a+";\n    color: "+o+";\n\n    svg {\n        fill: "+o+";\n    }\n\n    &:active,\n    &:focus,\n    &:hover {\n        color: "+o+";\n        background-color: "+s+";\n        border-color: "+a+";\n        box-shadow: none;\n    }\n\n    &:disabled {\n        background-color: "+(r||n)+";\n        border-color: "+(c||a)+";\n        box-shadow: none;\n        color: "+(u||o)+";\n        cursor: default; \n        pointer-events: none;\n\n        .icon {\n            fill: "+(u||o)+"\n        }\n    }\n"}var Br=Oi()(["\n    &:after {\n        background-color: ",";\n    }\n"],["\n    &:after {\n        background-color: ",";\n    }\n"]),Pr=Oi()(["\n    color: ",";\n"],["\n    color: ",";\n"]),Hr=Oi()(["\n    span {\n        background-color: ",";\n    }\n"],["\n    span {\n        background-color: ",";\n    }\n"]),Ur=Rs.default.div(Br,(function(e){var t=e.theme.colors;return e.isFromCustomer?t.customerMessageBackground:t.repMessageBackground})),Fr=Rs.default.span(Pr,(function(e){var t=e.theme.colors;return e.isFailed?t.error:t.gray85})),Vr=Rs.default.div((function(e){return function(e){var t=e.theme.colors,n=e.isFromCustomer,o=e.isPictureMessage,i=e.withButtons,a=n?t.customerMessageBackground:t.repMessageBackground;o&&(a=t.background);var s=i&&"1px solid "+t.gray5;return"\n    background-color: "+a+";\n    color: "+(n?t.customerMessageText:t.repMessageText)+";\n    border: "+s+"    \n\n"}(e)})),xr=Rs.default.div(Hr,(function(e){return e.theme.colors.repMessageText})),Gr=new yr.a;Gr.tlds(br);var qr=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.state={showSendingIndicator:!1,showTimestamp:!1},n.getLinkMatches=n.getLinkMatches.bind(n),n.handleClick=n.handleClick.bind(n),n.linkifyText=n.linkifyText.bind(n),n.renderContent=n.renderContent.bind(n),n.renderMeta=n.renderMeta.bind(n),n.renderPictureMessage=n.renderPictureMessage.bind(n),n.renderTextMessage=n.renderTextMessage.bind(n),n.toggleTimestamp=n.toggleTimestamp.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.props.event&&this.props.event.isPending&&this.setSendingIndicatorTimer()}},{key:"componentDidUpdate",value:function(e){(e.event.isPending&&!this.props.event.isPending||!e.event.isFailed&&this.props.event.isFailed)&&(this.setState({showSendingIndicator:!1}),clearTimeout(this.sendingIndicatorTimer)),!e.event.isPending&&this.props.event.isPending&&this.setSendingIndicatorTimer()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.sendingIndicatorTimer)}},{key:"handleClick",value:function(){this.props.event.isFailed&&this.props.retryCallback?this.props.retryCallback(this.props.event):this.toggleTimestamp()}},{key:"renderMeta",value:function(){var e=this.props.event.isFailed?Wa.BUBBLE.FAILED:Or(this.props.event.EventTime/1e3,this.props.regionCode);return s.a.createElement(Fr,{className:"bubble__meta touch_noSelect",isFailed:this.props.event.isFailed},e)}},{key:"setSendingIndicatorTimer",value:function(){var e=this;this.sendingIndicatorTimer=setTimeout((function(){e.setState({showSendingIndicator:!0})}),this.props.sdkSettings.ShowSendingIndicatorThresholdMS)}},{key:"toggleTimestamp",value:function(){this.setState({showTimestamp:!this.state.showTimestamp})}},{key:"getLinkMatches",value:function(){var e=new RegExp(/[1+]*[(-]{0,1}[0-9]{1,4}[)]{0,1}[\s\-.]?[0-9]{3}[\s\-.]?[0-9]{4}/,"gmi"),t=[],n=void 0;for(Gr.pretest(this.props.text)&&(t=Gr.match(this.props.text)||[]);null!==(n=e.exec(this.props.text));)t.push(N()({},n,{text:n[0],url:"tel:"+n[0],lastIndex:n.index+n[0].length}));return t.sort((function(e,t){return e.index-t.index}))}},{key:"linkifyText",value:function(){var e=this,t=this.getLinkMatches();if(t.length){var n=[],o=0;return t.forEach((function(t,i){t.index>o&&n.push(e.props.text.substring(o,t.index)),n.push(s.a.createElement("a",{href:t.url,key:"parsed-m"+t.index+"i"+i,target:"_blank"},/^https:\/\/.*\.secmsg\.asapp\.com\//.test(t.url)?Wa.BUBBLE.SECURE_MESSAGE:t.text)),o=t.lastIndex})),o<this.props.text.length&&n.push(this.props.text.substring(o)),1===n.length?n[0]:n}return this.props.text}},{key:"renderTextMessage",value:function(){return s.a.createElement("div",{className:"bubble__text",onClick:this.handleClick},this.props.event.isFromCustomer?this.props.text:this.linkifyText())}},{key:"renderPictureMessage",value:function(){return s.a.createElement("div",{className:"bubble__attachment",onClick:this.handleClick},this.props.children)}},{key:"renderTypingIndicator",value:function(){return s.a.createElement(xr,{"aria-label":this.props.isLiveChat?Wa.TYPING_INDICATOR.LIVE_CHAT:Wa.TYPING_INDICATOR.SRS,role:"status"},s.a.createElement("span",null),s.a.createElement("span",null),s.a.createElement("span",null))}},{key:"renderContent",value:function(){return this.props.isTypingIndicator?this.renderTypingIndicator():this.props.isTextMessage?this.renderTextMessage():this.renderPictureMessage()}},{key:"render",value:function(){var e=this.props,t=e.actionHandler,n=e.displayInfo,o=e.event.isFromCustomer,i=e.hasAttachment,a=e.hasMessageActionButtons,r=e.theme,c=e.isTextMessage,u=e.isTypingIndicator,l=e.messageActionButtons,d=o&&{bubble_isFailed:this.props.event.isFailed,bubble_isPending:this.state.showSendingIndicator},h=!c&&!u,p=bs()("bubble",N()({bubble_first:n.isFirst||u,bubble_fromCustomer:o,bubble_fromRep:!o||u,bubble_lastOfMany:!i&&n.isLastOfMany,bubble_pictureMessage:h,bubble_typingIndicator:u,bubble_withAttachment:i},d));return s.a.createElement(Ur,{className:p,isFromCustomer:o},s.a.createElement(Vr,{className:"bubble__content",isFromCustomer:o,isPictureMessage:h,withButtons:!i&&a},this.renderContent(),!i&&a&&s.a.createElement(Cr.MessageActionButtons,{messageActionButtons:l,actionHandler:t,theme:r})),this.state.showTimestamp||this.props.event.isFailed?this.renderMeta():null)}}]),t}(s.a.Component);qr.defaultProps={displayInfo:{},event:{},sdkSettings:{ShowSendingIndicatorThresholdMS:1e3}},qr.propTypes={actionHandler:ki.a.func,children:ki.a.node,displayInfo:ki.a.shape({isFirst:ki.a.bool,isLastOfMany:ki.a.bool,showInfoBandBefore:ki.a.bool,isLastRepMsg:ki.a.bool}).isRequired,event:ki.a.object.isRequired,hasAttachment:ki.a.bool,hasMessageActionButtons:ki.a.bool,isLiveChat:ki.a.bool,isTextMessage:ki.a.bool,isTypingIndicator:ki.a.bool,messageActionButtons:ki.a.array,regionCode:ki.a.string,retryCallback:ki.a.func,text:ki.a.oneOfType([ki.a.string,ki.a.arrayOf(ki.a.node)]),sdkSettings:ki.a.shape({ShowSendingIndicatorThresholdMS:ki.a.number}),theme:ki.a.object};var Wr=qr,Kr=function(e){var t=e.actionHandler,n=e.displayInfo,o=e.event,a=e.hideMessageActionButtons,r=e.regionCode,c=e.retryCallback,u=e.sdkSettings,l=e.isLiveChat,d=e.theme,h=o.payload;if(!h)return null;var p=h.text||h.Text,E=!!h.attachment&&!!h.attachment.content,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.payload;return n&&Array.isArray(n.buttons)&&!e.isFromCustomer?t?n.buttons:Aa(n.buttons):null}(o,n.isLastRepMsg)||[],g=!a&&m.length>0;if(!p&&!E)return null;var S={actionHandler:t,displayInfo:n,isTextMessage:!0,messageActionButtons:m,isLiveChat:l,theme:d};return s.a.createElement("div",null,p&&s.a.createElement(Wr,i()({},S,{event:o,hasAttachment:E,hasMessageActionButtons:g,regionCode:r,retryCallback:c,sdkSettings:u,text:p})),E&&s.a.createElement(Cr.ChatAttachment,i()({},S,{attachment:h.attachment,isIndependent:!p})))};Kr.defaultProps={displayInfo:{},event:{},regionCode:"US",sdkSettings:{}},Kr.propTypes={actionHandler:ki.a.func.isRequired,displayInfo:ki.a.shape({isFirst:ki.a.bool,isLastOfMany:ki.a.bool,showInfoBandBefore:ki.a.bool,isLastRepMsg:ki.a.bool}).isRequired,event:ki.a.object.isRequired,theme:ki.a.object,hideMessageActionButtons:ki.a.bool,regionCode:ki.a.string.isRequired,retryCallback:ki.a.func,sdkSettings:ki.a.object.isRequired,isLiveChat:ki.a.bool};var jr=Kr,Qr=Oi()(["\n    color: ",";\n"],["\n    color: ",";\n"]),Yr=Rs.default.time(Qr,(function(e){return e.theme.colors.gray85}));function Zr(e){var t=e.time,n=e.regionCode,o=e.string,i=t/1e3;return s.a.createElement(Yr,{className:"infoBand touch_noSelect",role:"heading","aria-level":3},function(e,t,n){if(!e)return null;t=Rr(t);var o=new Date(e),i=Or(e,t);return n?Ka(n)+" "+i:o.toLocaleDateString(t,{month:"long",day:"numeric"})+" "+Ka(Wa.INFOBAND.AT)+" "+i}(i,n,o))}Zr.propTypes={time:ki.a.number.isRequired,regionCode:ki.a.string,string:ki.a.string};function $r(e){var t=e.event,n=e.companyId,o=t.payload,i=function(e,t,n){var o=Ra(e)?e.CustomerId:e.RepId,i="https://"+t.FileBucket+".s3.amazonaws.com/company/",a=n+"/flags/"+e.EventFlags+"/id/"+o+"/",s=t.FileSecret+"-"+t.PicWidth+"x"+t.PicHeight+"."+t.MimeType.split("/")[1];return i+a+s}(t,o,n),a=260/o.PicWidth,r={width:260,height:Math.floor(a*o.PicHeight)};return s.a.createElement("div",{style:r,className:"conversation__pictureMessage"},s.a.createElement("img",{src:i,style:r,alt:"Uploaded image"}))}$r.propTypes={event:ki.a.object.isRequired,companyId:ki.a.number.isRequired};var zr=$r;var Xr=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.renderEvent=n.renderEvent.bind(n),n}return bi()(t,e),v()(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.event.renderKey!=e.event.renderKey||this.props.nextEvent.renderKey!=e.event.renderKey}},{key:"renderEvent",value:function(){var e=this.props,t=e.companyId,n=e.event,o=e.sdkSettings;return n.isChatMessage?s.a.createElement(jr,i()({},this.props,{displayInfo:this.displayInfo})):n.isPictureMessage?s.a.createElement(Wr,{event:n,isTextMessage:!1,sdkSettings:o},s.a.createElement(zr,{event:n,companyId:t})):null}},{key:"renderInfoBand",value:function(){var e=this.props,t=e.event,n=e.regionCode,o=this.displayInfo,i=o.infoBandString,a=o.showInfoBandBefore;if(i||a)return s.a.createElement(Zr,{time:t.EventTime,regionCode:n,string:i})}},{key:"render",value:function(){var e=this.props,t=e.event,n=e.events;return this.displayInfo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:180,o=cs(t,e),i=rs(t,e),a=us(e,o),s=us(e,i),r=!o||a>n,c=s>n,u=o&&o.isFromCustomer===e.isFromCustomer,l=i&&i.isFromCustomer===e.isFromCustomer,d=!u||r,h=u&&!d&&(!l||c),p=!e.isFromCustomer&&!i,E=ls(e);return{infoBandString:E,isFirst:d,isLastOfMany:h,isLastRepMsg:p,showInfoBandAfter:c,showInfoBandBefore:r}}(t,n),s.a.createElement("div",{id:t.renderKey,key:t.renderKey,className:bs()("eventView",{eventView_first:this.displayInfo.isFirst})},this.renderInfoBand(),this.renderEvent())}}]),t}(s.a.Component);Xr.defaultProps={nextEvent:{},regionCode:"US",retryCallback:null,sdkSettings:{}},Xr.propTypes={actionHandler:ki.a.func.isRequired,companyId:ki.a.number,event:ki.a.object.isRequired,events:ki.a.array.isRequired,hideMessageActionButtons:ki.a.bool,nextEvent:ki.a.object,regionCode:ki.a.string,retryCallback:ki.a.func,sdkSettings:ki.a.object,theme:ki.a.object};var Jr=Xr,ec=Oi()(["\n    .icon_loading {\n        fill: ",";\n    }\n"],["\n    .icon_loading {\n        fill: ",";\n    }\n"]),tc=Rs.default.div(ec,(function(e){return e.theme.colors.onBackground})),nc="chat-messages-view-scroll-view",oc=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.pageSize=50,n.threshold=1500,n.onFetchComplete=n.onFetchComplete.bind(n),n.onScroll=n.onScroll.bind(n),n.throttledOnScroll=at(n.onScroll,100).bind(n),n.handleUnreadMessageIndicatorClick=n.handleUnreadMessageIndicatorClick.bind(n),n.renderEvents=n.renderEvents.bind(n),n.renderInlineForm=n.renderInlineForm.bind(n),n.renderUnreadMessageIndicator=n.renderUnreadMessageIndicator.bind(n),n.renderTypingIndicator=n.renderTypingIndicator.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.scrollView&&this.scrollView.addEventListener("scroll",this.throttledOnScroll)}},{key:"componentWillUnmount",value:function(){this.scrollView&&this.scrollView.removeEventListener("scroll",this.throttledOnScroll)}},{key:"componentDidUpdate",value:function(e){Sc(600)&&(!e.showTypingIndicator&&this.props.showTypingIndicator||e.events.length+1===this.props.events.length)&&this.props.scrollToBottom(),e.unreadMessageCount!==this.props.unreadMessageCount&&this.props.recordGauge({label:he.CONVERSATION_UNREADINDICATOR,type:pe.DISPLAY,value:this.props.unreadMessageCount,tags:_()({},Ee.IS_LIVE,this.props.isLiveChat)})}},{key:"handleUnreadMessageIndicatorClick",value:function(){this.props.recordCount({label:he.CONVERSATION_UNREADINDICATOR,type:pe.SELECT,data:_()({},me.UNREAD_MESSAGES_COUNT,this.props.unreadMessageCount)}),this.props.scrollToBottom()}},{key:"onScroll",value:function(){this.props.unreadMessageCount&&Sc()&&this.props.resetUnreadMessageCount()}},{key:"renderEvents",value:function(){var e=this,t=this.props,n=t.events,o=t.regionCode,i=t.sdkSettings,a=t.isLiveChat,r=t.theme,c=n.filter((function(e){return e.isDisplayable}));return c.map((function(t,u){return s.a.createElement(Jr,N()({key:t.renderKey},{actionHandler:as,companyId:e.props.session&&e.props.session.company_id,event:t,events:n,hideMessageActionButtons:e.props.showInlineForm,nextEvent:c[u+1]||{},regionCode:o,retryCallback:t.isFailed?Oc.retrySendMessage:null,sdkSettings:i,isLiveChat:a,theme:r}))}))}},{key:"renderTypingIndicator",value:function(){if(this.props.showTypingIndicator)return s.a.createElement(Wr,{isLiveChat:this.props.isLiveChat,isTypingIndicator:!0})}},{key:"renderUnreadMessageIndicator",value:function(){if(this.props.unreadMessageCount)return s.a.createElement(fr,{unreadMessageCount:this.props.unreadMessageCount,regionCode:this.props.regionCode,onClick:this.handleUnreadMessageIndicatorClick})}},{key:"renderInlineForm",value:function(){if(this.props.showInlineForm)return s.a.createElement(Nr,null)}},{key:"onFetchComplete",value:function(){this.scrollView&&(this.scrollView.scrollTop=this.scrollView.scrollTop+this.threshold+5)}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.events.length/this.pageSize);return s.a.createElement(tc,{className:"chatMessagesView",id:"chat-messages-view"},s.a.createElement(hr,null),s.a.createElement("div",{"aria-atomic":"false","aria-label":Ka(Wa.CHAT_MESSAGES_VIEW.REGION_TITLE,this.props.regionCode),"aria-live":"off",className:"chatMessagesView__scrollView",id:nc,ref:function(t){return e.scrollView=t},role:"log",tabIndex:"-1"},s.a.createElement(Er.a,{className:"chatMessagesView__scrollView__content",id:"chat-messages-view-scroll-view-content",pageStart:t,threshold:this.threshold,loadMore:function(){e.props.fetchMoreEvents(e.onFetchComplete)},loader:s.a.createElement(Gs,{className:"chatMessagesView__loader",iconName:"loading",key:"loader"}),hasMore:this.props.hasMoreEvents,isReverse:!0,useWindow:!1,initialLoad:!1},this.renderEvents(),this.renderInlineForm(),this.renderTypingIndicator())),this.renderUnreadMessageIndicator())}}]),t}(s.a.Component);oc.propTypes={events:ki.a.array.isRequired,fetchMoreEvents:ki.a.func,isLiveChat:ki.a.bool,regionCode:ki.a.string.isRequired,showTypingIndicator:ki.a.bool,hasMoreEvents:ki.a.bool,scrollToBottom:ki.a.func,sdkSettings:ki.a.object,setShowTypingIndicator:ki.a.func,showInlineForm:ki.a.bool,unreadMessageCount:ki.a.number,resetUnreadMessageCount:ki.a.func,incrementUnreadMessageCount:ki.a.func,recordCount:ki.a.func,recordGauge:ki.a.func,session:ki.a.object,theme:ki.a.object};var ic=Object(d.connect)((function(e){var t=e.chat,n=e.chatMessagesView,o=e.eventLog,i=e.form,a=e.partnerConfig,s=e.sdkSettings;return{events:o.events,hasMoreEvents:o.hasMoreEvents,session:t.session,showTypingIndicator:n.showTypingIndicator,sdkSettings:s,showInlineForm:i.showInlineForm,regionCode:a.regionCode,isLiveChat:t.isLiveChat,unreadMessageCount:n.unreadMessageCount,theme:a.theme}}),(function(e){return{fetchMoreEvents:function(t){return e(function(e){return function(t,n){var o=n().eventLog,i=o.events;o.hasMoreEvents&&Oc.getEvents({lastEventId:i&&i.length?i[0].EventId:null,onComplete:function(n,o){!o&&n&&n.EventList?(n.EventList.length?(t({type:"ADD_MORE_EVENTS",events:ss(n.EventList)}),t(Es(50===n.EventList.length))):t(Es(!1)),e()):An("[EventLog.actions]","Fetch events failed",o)}})}}(t))},setShowTypingIndicator:function(t){return e(Di(t))},resetUnreadMessageCount:function(){e({type:"RESET_UNREAD_MESSAGE_COUNT"})},incrementUnreadMessageCount:function(){e({type:"INCREMENT_UNREAD_MESSAGE_COUNT"})},scrollToBottom:function(){e(Li())},recordCount:function(t){e(Vi(t))},recordGauge:function(t){e(function(e){return{type:"RECORD_GAUGE",payload:e}}(t))}}}))(oc);function ac(e,t,n){if(e&&t){var o=new XMLHttpRequest;return o.open(e,t,!0),o.timeout="number"==typeof n?n:7e3,o}}function sc(e){var t=e.substring(1).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"');return 0===t.length?{}:JSON.parse('{"'+t+'"}',(function(e,t){return""===e?t:decodeURIComponent(t)}))}function rc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t="?v=eb58ab4dd25b7299f06cae24ea9aba1cc28011ef";return"stylesheets/chat-sdk-iframe-partner-"+e+".css"+t}function cc(e){return null===e?"null":Array.isArray(e)?"array":void 0===e?"undefined":y()(e)}var uc=new gi(window.parent,sc(window.location.search).Origin,"HostPageMessageBus"),lc=function(e,t){var n={params:e};for(var o in e)"binaryBase64"!==o&&"data"!==o||(n[o]=e[o],delete e[o]);return t&&(n.ctxParams={CompanyId:t.company_id}),n},dc=function(e){var t=Gh.getState().partnerConfig,n=t.appId,o=t.deviceInfo.clientDeviceName,i=t.regionCode;e.setRequestHeader(O,o),e.setRequestHeader(M,"web-sdk"),e.setRequestHeader(k,"4.0.0"),e.setRequestHeader(w,n),e.setRequestHeader(D,"web-sdk-"+n),e.setRequestHeader(L,i),e.setRequestHeader("Content-Type","application/json")};function hc(e){var t,n,o,i,a=rc((t=Gh.getState().partnerConfig,n=t.appId,o=t.displaySettings,(i=o&&"string"==typeof o.Identity&&o.Identity.length>0?[n,o.Identity].join("-"):n)?i.toLowerCase():"default")),s=ac("HEAD",a);s.addEventListener("load",(function(){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=200===s.status?a:rc(),document.head.appendChild(t),"function"==typeof e&&window.setTimeout(e,150)})),s.send()}var pc=function(){var e=Gh.getState().partnerConfig.host,t=e.location,n=e.referrerUrl,o=e.sdkLoadTime;return{CurrentPageUrl:t&&t.href,ReferringPageUrl:n,TimeOnPageSecs:Math.ceil((Date.now()-o)/1e3)}},Ec=function(e){var t=Math.floor(e/60),n=e%60;return(t?t+" hr":"")+(t?" ":"")+(n?n+" min":"")};var mc=function(e,t){return e&&t?e+"."+t:null},gc=function(e,t){if(!e||!e.text)return e;var n=Gh.getState().sdkSettings.RedactionRules,o=void 0===n?[]:n,i=e.text;return o&&o.length&&o.forEach((function(e){var n,o;(3!==e.Type||t)&&(o=i,i=(n=e)&&n.Search&&n.Replacements?Si(n,n.Search,o,Ci):(An("Cannot scrub a message due to missing data",n,o),o))})),N()({},e,{text:i})},Sc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,t=document.getElementById("chat-messages-view-scroll-view-content"),n=document.getElementById(nc);return!(!t||!n)&&t.scrollHeight-(n.offsetHeight+n.scrollTop)<e},fc=void 0,Cc=function(){try{fc=new Audio(n("gh99"))}catch(e){An("Could not load notification sound.",e)}},vc=function(){fc&&fc.play()},Tc=function(){var e,t=Gh.getState(),n=t.partnerConfig,o=n.host.notificationPermission,i=n.deviceInfo,a=t.sdkSettings.ASAPPNotificationsPermissionUI;if((void 0===a?{}:a).web){var s=(i||{}).deviceType;Gh.dispatch(Vi({label:he.WEB_NOTIFICATION_PERMISSION,type:pe.CHECKED,tags:(e={},_()(e,Ee.DEVICE_TYPE,s),_()(e,Ee.STATUS,o),e)})),o===$e&&setTimeout((function(){Gh.dispatch(Pi($n)),Gh.dispatch(Vi({label:he.WEB_NOTIFICATION_PERMISSION_CONFIRM,type:pe.DISPLAY,tags:_()({},Ee.DEVICE_TYPE,s)}))}),2e3)}},_c=function(e){var t=e.Text||e.text||"";return t.length<=30?t:t.slice(0,30)+"..."},Ic=function(){var e=Gh.getState().partnerConfig.customerId;return!!e&&""!==e},Nc=function(e){return{theme:Gh.getState().partnerConfig.theme,iconName:e,component:{type:"icon"}}};function Ac(e,t,n){var o=void 0,i=void 0,a=void 0,s=void 0,r=void 0,c=function c(){var u=Date.now()-s;u<t&&u>=0?o=setTimeout(c,t-u):(o=null,n||(r=e.apply(a,i),o||(a=i=null)))};return function(){a=this,i=arguments,s=Date.now();var u=n&&!o;return o||(o=setTimeout(c,t)),u&&(r=e.apply(a,i),a=i=null),r}}function yc(e){if(null==e)return!0;if(Array.isArray(e)||"string"==typeof e)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var bc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.slice().reverse()},Rc={ask:function(e){Rc.sendRequest({onComplete:e&&e.onComplete,path:yn.ASK,params:pc()})},endChat:function(e){Rc.sendRequest({onComplete:e&&e.onComplete,path:yn.END_CONVERSATION,metricsEventLabel:he.CONVERSATION_END})},enterChat:function(e){var t=Gh.getState(),n=t.chat.initiationType,o=t.partnerConfig,i=o.intent,a=o.loadIdentifiers;Rc.sendRequest({onComplete:e&&e.onComplete,params:N()({Intent:i,LoadIdentifiers:a,InitiationType:n},pc()),path:yn.ENTER_CHAT,metricsEventLabel:he.ENTER_CHAT})},getOfferedMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Gh.getState(),n=t.partnerConfig,o=n.appId,a=n.customerId,s=n.loadIdentifiers,r=n.regionCode,c=t.connection.isConnected,u=c?yn.UPDATE_SESSION:yn.GET_OFFERED_MESSAGE_UNAUTHED,l=N()({RegionCode:r||"US",LoadIdentifiers:s},pc(),e);c||(l=i()({},l,{AuthenticationParams:{App:"chat-sdk-iframe",CompanyMarker:o,CustomerIdentifier:a,IdentifierType:o+"_CUSTOMER_ACCOUNT_ID",RegionCode:r||"US"}})),Rc.sendRequest({onComplete:function(t){Rc.onGetOfferedMessageComplete(t,e)},params:l,path:u})},getEvents:function(e){var t=e.recover,n=e.lastEventId,o=e.onComplete;Rc.sendRequest({noContextRequired:!0,onComplete:o,params:{Recover:t||!1,BeforeEventId:n,Limit:50},path:yn.HISTORY})},fetchContext:function(e,t){var n=!1,o=!1;uc.once(J,(function(t){o=!0,n||e(t)})),uc.post(Q,{needsRefresh:t}),window.setTimeout((function(){n=!0,o||(An("API.js: fetchContext timed out after",3e3,"ms"),e(null))}),3e3)},updateContext:function(e){Rc.fetchContext((function(t){t&&Rc.sendRequest({onComplete:e&&e.onComplete,noContextRequired:!0,path:yn.UPDATE_CONTEXT,params:{Context:g()(t),Auth:t.access_token}})}),!0)},getComponentView:function(e){var t=e.data,n=void 0===t?{}:t,o=e.name,i=e.onComplete;o?Rc.sendRequest({onComplete:i,params:{ComponentView:o,Data:g()(n)},path:yn.GET_COMPONENT_VIEW}):An("API.js: name is required for getComponentView")},getRealtimeWaitData:function(e){var t=e.onComplete,n=e.params;Rc.sendRequest({onComplete:t,params:n,path:yn.GET_REALTIME_WAIT_DATA})},getSDKSetting:function(e){var t=e.onComplete,n=e.limit;Rc.sendRequest({noContextRequired:!0,onComplete:function(e,o){e?t(e):o&&--n>=0&&(An("API.js: getSDKSetting request failed. Refetching...",o),Rc.getSDKSetting({onComplete:t,limit:n}))},path:yn.GET_SDK_SETTING})},publishReportingEvent:function(e){var t=e.onComplete,n=e.reportingData,o=e.reportingType;Rc.sendRequest({onComplete:t,params:{reportingData:n,reportingType:o},path:yn.PUBLISH_REPORTING_EVENT})},sendAPIActionRequest:function(e){var t=e.action,n=e.formData,o=e.onComplete;if(t&&t.content&&t.content.requestPath){var i={actionTarget:t.content.data&&t.content.data.actionTarget,Data:g()(N()({},t.content.data,n))};Rc.sendRequest({onComplete:o,params:i,path:t.content.requestPath})}else An("API.js: valid action required for sendAPIActionRequest:",t)},sendPictureMessage:function(e){var t=e.file,n=e.onComplete;if(t){var o=new FileReader;o.readAsDataURL(t),o.addEventListener("load",(function(e){var o=new Image;o.src=e.target.result,o.addEventListener("load",(function(){var e=document.createElement("canvas"),i=o.width>o.height;i&&o.width>1024?(o.height=Math.round(1024/o.width*o.height),o.width=1024):!i&&o.height>1024&&(o.width=Math.round(1024/o.height*o.width),o.height=1024);var a=e.getContext("2d");a.clearRect(0,0,e.width,e.height),e.width=o.width,e.height=o.height,a.drawImage(o,0,0,o.width,o.height);var s=e.toDataURL(),r=s&&s.split("base64,");r[1]&&Rc.sendRequest({noContextRequired:!0,params:{MimeType:t.type,binaryBase64:r[1],FileSize:Math.round(3*r[1].length/4),PicWidth:o.width,PicHeight:o.height},path:yn.SEND_PICTURE_MESSAGE,onComplete:n})}))}))}else An("API.js: sendPictureMessage, could not find file")},onGetOfferedMessageComplete:function(e,t){yc(e)||(e.timeOnPageDelaySecs?setTimeout((function(){Rc.getOfferedMessage(t)}),1e3*e.timeOnPageDelaySecs):uc.post(ce,e))},onXHRReadyStateChange:function(e){var t=e.onComplete,n=e.xhr,o=e.metricsEventLabel;if(4===n.readyState){0===n.status?Gh.dispatch(Ea(Gn)):Gh.getState().chat.chatBanner===Gn&&Gh.dispatch(Ea(null));var i=void 0;if("function"==typeof t){try{i=Rc.extractXHRResponse(n)}catch(a){return t(null,a,n)}var a;if(200===n.status)t(i,null,n);else t(null,"object"===cc(i)&&i.error||i,n)}o&&Gh.dispatch(Wi({statusCode:n.status,error:200!==n.status&&i||null,metricsEventLabel:o}))}},sendHTTPAction:function(e){e.params=lc(e.params),e.params.params[M]="web-sdk",e.params.params[k]="4.0.0",Rc.sendHTTPRequest(e)},sendHTTPRequest:function(e){var t=e.path,n=e.timeout,o=e.params,i=e.onComplete,a=e.metricsEventLabel,s=e.headers,r=Gh.getState().sdkSettings.GlobalRequestTimeoutMS,c=ac("POST",t,n||r);c.addEventListener("readystatechange",(function(e){Rc.onXHRReadyStateChange({onComplete:i,xhr:e.target,metricsEventLabel:a})})),c.setRequestHeader("Content-Type","application/json"),s&&E()(s).forEach((function(e){c.setRequestHeader(e,s[e])})),c.send(g()(o))},sendASAPPRequest:function(e){var t=e.onComplete,n=e.params,o=void 0===n?{}:n,i=e.path,a=e.timeout,s=e.metricsEventLabel,r=Gh.getState(),c=r.chat.session,u=r.partnerConfig,l=u.apiHostname,d=u.appId,h=u.deviceInfo.clientDeviceName,p=u.regionCode,E=r.sdkSettings.GlobalRequestTimeoutMS,m=lc(o,c),S=ac("POST","https://"+l+"/api/http/v1/"+i,a||E);S.addEventListener("readystatechange",(function(e){Rc.onXHRReadyStateChange({onComplete:t,xhr:e.target,metricsEventLabel:s})})),i!==yn.GET_OFFERED_MESSAGE_UNAUTHED&&c&&null!==c.session_token&&(S.withCredentials=!0,S.setRequestHeader("Authorization","Bearer "+c.session_token)),m[O]=h,m[M]="web-sdk",m[k]="4.0.0",m[w]=d,m[D]="web-sdk-"+d,m[L]=p,dc(S),S.send(g()(m))},sendRequest:function(e){var t=e.noContextRequired,n=e.onComplete,o=e.params,i=void 0===o?{}:o,a=e.path,s=e.timeout,r=e.metricsEventLabel,c=/^https?:\/\//i.test(a)?"sendHTTPAction":"sendASAPPRequest";t?Rc[c]({onComplete:n,params:i,path:a,timeout:s,metricsEventLabel:r}):Rc.fetchContext((function(e){e&&(i.Context=g()(e)),Rc[c]({onComplete:n,params:i,path:a,metricsEventLabel:r,timeout:s})}),!1),r&&Gh.dispatch(qi({metricsEventLabel:r}))},extractXHRResponse:function(e){return-1!==(e.getResponseHeader("content-type")||"").indexOf("application/json")?JSON.parse(e.response):e.response},sendSRSMessage:function(e){var t=e.classification,n=e.data,o=e.text,i=e.CustAutoCompleteAnalytics,a=e.onComplete;if(o){var s=Gh.getState().sdkSettings.ShowDeliveryFailureThresholdMS,r={Classification:t,Data:n?g()(n):void 0,text:o,UIMessageID:ut.a.create().toString(),CustAutoCompleteAnalytics:i};Gh.dispatch(Ss(r)),Rc.sendRequest({params:gc(r,!1),path:yn.SEND_TEXT_MESSAGE_AND_HIER_AND_TREEWALK,timeout:s,onComplete:function(e,t,n){"function"==typeof a&&a(e,t);var o=200===n.status;o||Gh.dispatch(function(e){return function(t){e===Un&&t(Ea(Kn)),t(_a(!1)),t(Ta(!0)),t(ds()),t(ji())}}(t)),Gh.dispatch(Vi({label:he.CONVERSATION_PENDING_MESSAGE,type:o?pe.CONFIRMED:pe.FAILURE}))}})}else An("API.js: text is required for sendSRSMessage")},sendTextMessage:function(e){var t=e.text,n=Gh.getState().sdkSettings.ShowDeliveryFailureThresholdMS,o={text:t,UIMessageID:ut.a.create().toString()};Gh.dispatch(Ss(o)),Gh.dispatch(Vi({label:he.SENDTEXT_LIVE,type:pe.REQUEST_START,data:_()({},me.UI_MESSAGE_ID,o.UIMessageID)})),Rc.sendRequest({onComplete:function(e,t,n){Gh.dispatch(Qi({UIMessageID:o.UIMessageID,error:t,xhr:n}))},params:gc(o,!1),path:yn.SEND_TEXT_MESSAGE,timeout:n})},resolveLink:function(e){var t=e.link,n=e.data,o=void 0===n?{}:n,i=e.onComplete;Rc.sendRequest({path:yn.RESOLVE_LINK,params:{link:t,Data:g()(o)},onComplete:i})},retrySendMessage:function(e){e&&e.payload&&(Gh.dispatch(Ns(e.payload.UIMessageID,{isPending:!0,isFailed:!1})),Rc.sendRequest({params:e.payload,path:yn.SEND_TEXT_MESSAGE,onComplete:function(t,n,o){Gh.dispatch(Qi({UIMessageID:e.payload.UIMessageID,error:n,xhr:o}))}}),Gh.dispatch(Vi({label:he.CONVERSATION_PENDING_MESSAGE_RETRY,type:pe.SELECT})))},sendTypingPreview:at((function(e){Rc.sendRequest({noContextRequired:!0,params:gc(e,!0),path:yn.NOTIFY_TYPING_PREVIEW})}),200),requestAutocomplete:at((function(e){var t=e.params,n=e.onComplete;Rc.sendRequest({path:yn.REQUEST_AUTOCOMPLETE,params:gc(t,!0),onComplete:n,noContextRequired:!0})}),100),sendAnalyticsEvent:function(e){var t=e.name,n=e.attributes,o=void 0===n?{}:n;Rc.sendRequest({path:yn.ANALYTICS_EVENT,params:{events:[{name:t,attributes:o,time:(new Date).toISOString()}]}})},checkCobrowsingUrl:function(e){var t=Gh.getState()||{},n=t.partnerConfig.host.location,o=t.cobrowsing.cobrowsingUserId;Rc.sendRequest({params:{URL:n&&n.href,UserID:o},path:e?yn.UPDATE_COBROWSING_URL:yn.CHECK_COBROWSING_URL})},submitSMSRequest:function(e){var t=e.phoneNumber,n=e.verificationCode,o=e.onComplete,i=e.path,a=e.metricsEventLabel,s=Gh.getState().partnerConfig,r=s.apiHostname,c=s.appId,u=s.loadIdentifiers,l={CompanyMarker:c,PhoneNumber:t,VerificationCode:n,PersistentId:u&&u.PersistentId};Rc.sendHTTPRequest({onComplete:o,params:l,path:"https://"+r+"/"+i,metricsEventLabel:a}),Gh.dispatch(qi({metricsEventLabel:a}))}},Oc=Rc,Mc=n("Lw/n"),kc=n("gtzJ"),wc="localhost:3000"===window.location.host;var Dc=function(){function e(t){f()(this,e),this.webSocket=t,this.events=[],this.isFetching=!1,this.lastEventId=null,this.lastEvent=null,this.shouldRefetch=!1,this.firstCustomerEventId=null,this.fetch=this.fetch.bind(this),this.getConversationStatus=this.getConversationStatus.bind(this),this.isNextEvent=this.isNextEvent.bind(this),this.logEvent=this.logEvent.bind(this),this.onFetchComplete=this.onFetchComplete.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),this.processNextEvent=this.processNextEvent.bind(this),this.webSocket&&this.webSocket.addEventListener("message",this.onSocketMessage)}return v()(e,[{key:"fetch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isFetching)return An("[EventLog]","fetch()","Setting shouldRefetch to true"),void(this.shouldRefetch=!0);this.shouldRefetch=!1,this.isFetching=!0,Oc.getEvents({recover:e.recover,onComplete:this.onFetchComplete})}},{key:"getConversationStatus",value:function(){return function(e){var t=e&&e.length;if(!t)return ui;for(var n=t-1;n>=0;n--){var o=e[n].EventType;if(o===ni.CONVERSATION_END||o===ni.SWITCH_TO_SRS)return ui;if(o===ni.NEW_REP)return li;if(o===ni.ISSUE_ENQUEUED)return di}return ui}(this.events)}},{key:"isNextEvent",value:function(e){return!!e&&(!this.lastEventId||e.EventIdPrevious===this.lastEventId)}},{key:"logEvent",value:function(e){var t=["[EventLog]",e.isEphemeral?"Ephemeral Event Type: "+e.EphemeralType:"Event Type: "+e.EventType,e];An.apply(null,t)}},{key:"onFetchComplete",value:function(e,t){if(t||!e)return this.isFetching=!1,void(this.shouldRefetch&&this.fetch());this.events=ss(e.EventList||[]);var n=this.events[this.events.length-1];this.firstCustomerEventId=function(e){if(!e)return null;for(var t=0;t<e.length-1;t++)if(Ra(e[t]))return e[t].EventId;return null}(this.events),this.lastEventId=n&&n.EventId||null,this.lastEvent=n||null,this.isFetching=!1;var o=e.SDKConversationState||this.getConversationStatus(),i=e.IsLiveChat||o!==ui;e.SDKConversationState===hi&&(Gh.dispatch(la(!0)),o=this.getConversationStatus(),i=!1),Gh.dispatch(fs(this.events)),Gh.dispatch(da(o,i)),o===li?Gh.dispatch(hs(function(e){if(!e)return null;for(var t=e.length-1;t>=0;t--){if(e[t].EventType===ni.NEW_REP)return e[t];if(e[t].EventType===ni.ISSUE_ENQUEUED||e[t].EventType===ni.NEW_ISSUE)break}return null}(this.events))):o===di&&Gh.dispatch(ia()),this.shouldRefetch&&this.fetch()}},{key:"onSocketMessage",value:function(e){if(e)if(this.isFetching)this.shouldRefetch=!0;else{var t,n=this.parseSocketEvent(e);if(this.firstCustomerEventId&&n.isFromSRS&&n.EventIdPrevious===this.firstCustomerEventId&&(n.isFirstSRSMessage=!0),!this.firstCustomerEventId&&n.isFromCustomer&&(this.firstCustomerEventId=n.EventId),n.EventId!==this.lastEventId)this.logEvent(n,"onSocketMessage()"),Gh.dispatch(Cs(n)),n.isEphemeral?Gh.dispatch((t=n,function(e){if(t){var n=ri,o=ci,i=si,a=ii,s=ai,r=oi;switch(t.EphemeralType){case r:e(Di(t.payload&&t.payload.IsTyping));break;case a:e(Bi(N()({},t.payload))),e(Pi(Yn));break;case s:Oc.updateContext({});break;case n:e(_s(t));break;case i:Oc.checkCobrowsingUrl(!1);break;case o:t.payload&&t.payload.ShowBlockingMessage?e(la(!0)):e(la(!1))}}})):this.isNextEvent(n)?this.processNextEvent(n):(!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};kc.m((function(n){n.setExtras(t),kc.d(e)}))}("Unorder events detected",{currentEvent:n,lastEvent:this.lastEvent}),An("[ASAPP_QA]","Unorder events detected","CurrentEvent:",n,"lastEvent:",this.lastEvent,"eventLog:",this.events),this.fetch({recover:!0}));else An("[EventLog]","duplicate message:")}}},{key:"parseSocketEvent",value:function(e){var t=e.data,n=t.indexOf("|"),o=t.substring(0,n);if(o!==to)return{};try{return ka(JSON.parse(t.substring(n+1)))||{}}catch(e){return An("[EventLog]","parseSocketEvent()","Failed to parse socket event",o,t.substring(n+1)),{}}}},{key:"processNextEvent",value:function(e){var t=this.getConversationStatus();this.events.push(e),this.lastEventId=e.EventId,this.lastEvent=e;var n=this.getConversationStatus();n!==t&&Gh.dispatch(da(n,n!==ui,t)),Gh.dispatch(_s(e))}}]),e}(),Lc=function(){function e(t,n){f()(this,e),this.apiHostname=t,this.eventLog=null,this.webSocket=null,this.webSocketToken=n,this.isOpeningConnection=!1,this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.onBeforeUnload=this.onBeforeUnload.bind(this),this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketOpen=this.onSocketOpen.bind(this),this.connect()}return v()(e,[{key:"connect",value:function(){this.isOpeningConnection=!0,this.webSocket=new WebSocket(["wss://",this.apiHostname,"/",yn.V2._ROOT,"/websocket",this.webSocketToken].join("")),this.webSocket.addEventListener("close",this.onSocketClose),this.webSocket.addEventListener("error",this.onSocketError),this.webSocket.addEventListener("open",this.onSocketOpen),Gh.dispatch(Vi({label:he.SOCKET,type:pe.CONNECT_START,tags:_()({},Ee.WITH_CUSTOMER_ID,Ic())})),Gh.dispatch(Gi({label:he.SOCKET,type:pe.CONNECT_DURATION}))}},{key:"disconnect",value:function(){this.webSocket.removeEventListener("error",this.onSocketError),this.webSocket.removeEventListener("open",this.onSocketOpen),this.eventLog&&(this.webSocket.removeEventListener("message",this.eventLog.onSocketMessage),this.eventLog=null),this.webSocket.close(),this.webSocket=null,An("Socket.js:","disconnect()","WebSocket closed")}},{key:"onBeforeUnload",value:function(){this.webSocket instanceof WebSocket&&(this.webSocket.removeEventListener("close",this.onSocketClose),this.webSocket.close())}},{key:"onSocketClose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};An("Socket.js:","onSocketClose()",e),Gh.dispatch(Za(!1)),Gh.dispatch(ha(!0)),this.isOpeningConnection||Gh.dispatch(Vi({label:he.SOCKET,type:pe.DISCONNECT,tags:_()({},Ee.WITH_CUSTOMER_ID,Ic()),data:{intentional:e.wasClean,reason:e.reason,error:e.code&&e.code.toString()}})),this.isOpeningConnection=!1}},{key:"onSocketError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};An("Socket.js:","onSocketError()",e),Gh.dispatch(ga(Ie)),this.isOpeningConnection&&(An("Socket.js:","Connection failure",e),Gh.dispatch(Vi({label:he.SOCKET,type:pe.CONNECT_FAILURE,tags:_()({},Ee.WITH_CUSTOMER_ID,Ic())})))}},{key:"onSocketOpen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};An("Socket.js:","onSocketOpen()",e),Gh.dispatch(Za(!0)),this.isOpeningConnection=!1,this.eventLog=new Dc(this.webSocket),this.eventLog.fetch(),Gh.dispatch(Vi({label:he.SOCKET,type:pe.CONNECT_SUCCESS,tags:_()({},Ee.WITH_CUSTOMER_ID,Ic())}))}}]),e}(),Bc=function(){function e(){f()(this,e),this.authRequestCalls=0,this.websocketRequestCalls=0,this.socket=null,this.getCustomerAuth=this.getCustomerAuth.bind(this),this.getWebsocketRequest=this.getWebsocketRequest.bind(this),this.handleAuthRequestRetry=this.handleAuthRequestRetry.bind(this),this.handleWebsocketRequestRetry=this.handleWebsocketRequestRetry.bind(this),this.makeRequest=this.makeRequest.bind(this),this.onCustomerAuthComplete=this.onCustomerAuthComplete.bind(this),this.onCustomerAuthFetchContext=this.onCustomerAuthFetchContext.bind(this),this.onWebsocketRequestComplete=this.onWebsocketRequestComplete.bind(this),this.resetWebsocketRequestRetry=this.resetWebsocketRequestRetry.bind(this)}return v()(e,[{key:"getCustomerAuth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.customerId=null,this.resetWebsocketRequestRetry(),this.authRequestCalls++,Gh.dispatch(ua(Mn)),Oc.fetchContext((function(n){e.onCustomerAuthFetchContext(n,t)}),t)}},{key:"getWebsocketRequest",value:function(){this.websocketRequestCalls++,this.makeRequest({onComplete:this.onWebsocketRequestComplete,path:yn.V2.WEBSOCKET.REQUEST})}},{key:"handleAuthRequestRetry",value:function(){var e=this;this.authRequestCalls>5?(Gh.dispatch(ga(ve)),Gh.dispatch(ua(On))):setTimeout((function(){e.getCustomerAuth(!1)}),3e3*this.authRequestCalls)}},{key:"handleWebsocketRequestRetry",value:function(){var e=this;this.websocketRequestCalls>5?Gh.dispatch(ga(Ie)):(1===this.websocketRequestCalls&&Gh.dispatch(Ea(Fn)),this.websocketRetryTimeout=setTimeout((function(){e.getWebsocketRequest()}),3e3*this.websocketRequestCalls))}},{key:"makeRequest",value:function(e){var t=e.onComplete,n=e.params,o=void 0===n?{}:n,i=e.path,a=Gh.getState(),s=a.chat.session,r=a.partnerConfig,c=r.apiHostname,u=r.appId,l=r.deviceInfo.clientDeviceName,d=r.regionCode,h=a.sdkSettings.GlobalRequestTimeoutMS,p=ac("POST","https://"+c+"/"+yn.V2._ROOT+"/"+i,h);if(p.addEventListener("readystatechange",(function(){4===p.readyState&&t&&t(p)})),s&&s.session_token&&(p.withCredentials=!0,p.setRequestHeader("Authorization","Bearer "+s.session_token)),p.setRequestHeader(O,l),p.setRequestHeader(M,"web-sdk"),p.setRequestHeader(k,"4.0.0"),p.setRequestHeader(w,u),p.setRequestHeader(D,"web-sdk-"+u),p.setRequestHeader(L,d),p.setRequestHeader("Content-Type","application/json"),"navigator"in window&&!window.navigator.onLine)Gh.dispatch(ga(Ie));else{p.send(g()(o));var E=void 0;i===yn.V2.CUSTOMER.AUTH?(E=he.AUTH_SESSION,An("[Auth]","Auth Request",o)):E=he.SOCKET_URL,Gh.dispatch(qi({metricsEventLabel:E}))}}},{key:"restartAuth",value:function(){this.socket?(this.socket.disconnect(),this.socket=null):Gh.getState().chat.error===ve&&(Gh.dispatch({type:"RESET_ERROR"}),this.getCustomerAuth())}},{key:"onCustomerAuthComplete",value:function(e){var t=this,n=this.authRequestCalls,o=void 0;if(200===e.status)Gh.dispatch(Sa(JSON.parse(e.response))),Gh.dispatch(ua(kn)),this.getWebsocketRequest(),this.authRequestCalls=0;else if(403===e.status){An("[Auth]","onCustomerAuthComplete()","Partner auth failed",e);try{o=JSON.parse(e.response).error}catch(t){An("[Auth]","onCustomerAuthComplete()","Unable to parse JSON",e.response)}switch(o){case Bn:Gh.dispatch(ga(ve)),Gh.dispatch(ua(On));break;case Pn:this.authRequestCalls>5?(Gh.dispatch(ga(Ne)),Gh.dispatch(ua(On))):setTimeout((function(){t.getCustomerAuth(!0)}),3e3*this.authRequestCalls);break;case Hn:Gh.dispatch({type:"REMOVE_SESSION"}),this.getCustomerAuth(!1);break;default:this.handleAuthRequestRetry()}}else this.handleAuthRequestRetry();Gh.dispatch(Wi({statusCode:e.status,error:o||null,attempts:n,metricsEventLabel:he.AUTH_SESSION,successDuration:!0}))}},{key:"onCustomerAuthFetchContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={context:{}};if(e){i()(n,{context:e}),E()(n.context).forEach((function(e){""===n.context[e]&&delete n.context[e]}));var o=Gh.getState().partnerConfig.appId+"_CUSTOMER_ACCOUNT_ID";this.customerId=e[o],this.customerId&&i()(n,{customer_identifier:this.customerId,identifier_type:o})}else if(t)return Gh.dispatch(ga(Ne));this.makeRequest({onComplete:this.onCustomerAuthComplete,params:n,path:yn.V2.CUSTOMER.AUTH})}},{key:"onWebsocketRequestComplete",value:function(e){var t=this.websocketRequestCalls;if(200===e.status)try{var n=JSON.parse(e.response).url;this.socket=new Lc(Gh.getState().partnerConfig.apiHostname,n),this.websocketRequestCalls=0,window.addEventListener("beforeunload",this.socket.onBeforeUnload)}catch(t){An("[Auth]","onWebsocketRequestComplete()","Unable to parse JSON",e.response)}else 403===e.status?(this.resetWebsocketRequestRetry(),this.getCustomerAuth()):this.handleWebsocketRequestRetry();Gh.dispatch(Wi({statusCode:e.status,metricsEventLabel:he.SOCKET_URL,successDuration:!0,attempts:t}))}},{key:"resetWebsocketRequestRetry",value:function(){clearTimeout(this.websocketRetryTimeout),this.websocketRequestCalls=0}}]),e}(),Pc="PersistentId";var Hc,Uc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.type||!Fc(e.type))return An.Error("fire:",'"event type" is required and must be valid.',"Currently defined as:",e.type);e.detail||(e.detail={issueId:void 0,customerId:void 0,externalSenderId:void 0});var t=!1;e.type!==nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW&&e.type!==nt.INTEGRATION.ACTION.EVENTS.CHAT_HIDE||(t=!0);var n=new CustomEvent(e.type,{detail:e.detail,cancelable:t}),o=Vc();o&&o.dispatchEvent(n)},Fc=function(e){return!!E()(nt.INTEGRATION.ACTION.EVENTS).some((function(t){return nt.INTEGRATION.ACTION.EVENTS[t]===e}))},Vc=function(){var e=lt.get(Gt);return e&&e.$iframe},xc=n("io0T"),Gc=n.n(xc),qc={};function Wc(){return qc}function Kc(e,t){return"string"!=typeof e?An.Error("Set:","First argument must be a string"):"string"==typeof e&&void 0===t?An("Set:","No value provided for key: "+e+". Value will not be updated"):qc.hasOwnProperty(e)?qc[e]=t:(An("Set:",'Setting unknown Context "'+e+'" as',t),qc["unknown"+e]=t)}Gc()(qc,{_access_token:{enumerable:!1,writable:!0},_Auth:{enumerable:!1,writable:!0},_CompanySubdivision:{enumerable:!1,writable:!0},_CustomerInfo:{enumerable:!1,writable:!0},_DebugSettings:{enumerable:!1,writable:!0},_ExternalSessionId:{enumerable:!1,writable:!0},_ExternalSessionType:{enumerable:!1,writable:!0},_PartnerAnalytics:{enumerable:!1,writable:!0},_Segments:{enumerable:!1,writable:!0},access_token:{enumerable:!0,writeable:!1,get:function(){return qc._access_token},set:function(e){fu("string",{key:"access_token",value:e})&&(qc._access_token=e)}},Auth:{enumerable:!0,writeable:!1,get:function(){return qc._Auth},set:function(e){fu("object",{key:"Auth",value:e})&&(qc._Auth=e)}},CompanySubdivision:{enumerable:!0,writeable:!1,get:function(){return qc._CompanySubdivision},set:function(e){fu("string",{key:"CompanySubdivision",value:e})&&(qc._CompanySubdivision=e)}},CustomerInfo:{enumerable:!0,writeable:!1,get:function(){return qc._CustomerInfo},set:function(e){fu("object",{key:"CustomerInfo",value:e})&&(qc._CustomerInfo=e)}},DebugSettings:{enumerable:!0,writeable:!1,get:function(){return qc._DebugSettings},set:function(e){fu("object",{key:"DebugSettings",value:e})&&(qc._DebugSettings=e)}},ExternalSessionId:{enumerable:!0,writeable:!1,get:function(){return qc._ExternalSessionId},set:function(e){fu("string",{key:"ExternalSessionId",value:e})&&(qc._ExternalSessionId=e)}},ExternalSessionType:{enumerable:!0,writeable:!1,get:function(){return qc._ExternalSessionType},set:function(e){fu("string",{key:"ExternalSessionType",value:e})&&(qc._ExternalSessionType=e)}},PartnerAnalytics:{enumerable:!0,writeable:!1,get:function(){return qc._PartnerAnalytics},set:function(e){fu("object",{key:"PartnerAnalytics",value:e})&&(qc._PartnerAnalytics=e)}},Segments:{enumerable:!0,writeable:!1,get:function(){return qc._Segments},set:function(e){fu("array",{key:"Segments",value:e})&&(qc._Segments=e)}}});var jc=gt,Qc=St,Yc=ft,Zc=Ct,$c=vt,zc=Vs()((Hc={},_()(Hc,jc.ACTIVE,'<g><path d="M44 0H17a4 4 0 0 0-4 4v18a4 4 0 0 0 4 4h12l12 9v-9h3a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4z"/><path d="M10 16H4a4 4 0 0 0-4 4v17a4 4 0 0 0 4 4v7l11-7h8a4 4 0 0 0 4-4v-8H14.8a4.8 4.8 0 0 1-4.8-4.8V16z"/></g>'),_()(Hc,jc.INACTIVE,'<g><path d="M43 5v16h-7v4l-4-3-1.33-1H18V5h25zm1-5H17a4 4 0 0 0-4 4v18a4 4 0 0 0 4 4h12l12 9v-9h3a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4z"></path><path d="M22 36h-8.46l-1.23.78L9 38.89V36H5V21h5v-5H4a4 4 0 0 0-4 4v17a4 4 0 0 0 4 4v7l11-7h8a4 4 0 0 0 4-4v-8h-5v7z"></path></g>'),_()(Hc,Qc.ABC,'<path fill-rule="evenodd" clip-rule="evenodd" d="M24 40.964C37.2548 40.964 48 32.4655 48 21.982C48 11.4985 37.2548 3 24 3C10.7452 3 0 11.4985 0 21.982C0 28.3862 4.0098 34.0496 10.152 37.4874C10.1659 37.4952 10.218 37.5239 10.3082 37.5736C10.3878 37.6174 10.4441 37.6928 10.4628 37.7803C10.9912 40.2529 7.53478 42.4704 5.22463 43.95C12.8814 44.4221 16.7447 41.4195 17.8501 40.435C19.7245 40.8068 21.9798 40.964 24 40.964Z"/>'),_()(Hc,Qc.CHAT,'<path fill-rule="evenodd" clip-rule="evenodd" d="M23.9999 1.52588e-05C10.752 1.52588e-05 -3.05176e-05 10.752 -3.05176e-05 24C-3.05176e-05 37.248 10.752 48 23.9999 48C37.248 48 48 37.248 48 24C48 10.752 37.248 1.52588e-05 23.9999 1.52588e-05ZM4.80014 24C4.80014 22.536 4.99214 21.096 5.30414 19.728L16.7761 31.2V33.6C16.7761 36.24 18.9361 38.4 21.5761 38.4V43.032C12.1441 41.832 4.80014 33.768 4.80014 24ZM33.576 33.6C35.736 33.6 37.512 35.016 38.136 36.96C41.256 33.552 43.2 28.992 43.2 24C43.2 15.96 38.208 9.04801 31.176 6.21601V7.20001C31.176 9.84001 29.016 12 26.376 12H21.5761V16.8C21.5761 18.12 20.4961 19.2 19.1761 19.2H14.3761V24H28.776C30.096 24 31.176 25.08 31.176 26.4V33.6H33.576Z" />'),_()(Hc,Qc.PHONE,'<path d="M9.65333 20.7733C13.4933 28.32 19.68 34.48 27.2267 38.3467L33.0933 32.48C33.8133 31.76 34.88 31.52 35.8133 31.84C38.8 32.8267 42.0267 33.36 45.3333 33.36C46.8 33.36 48 34.56 48 36.0267V45.3333C48 46.8 46.8 48 45.3333 48C20.2933 48 0 27.7067 0 2.66667C0 1.2 1.2 0 2.66667 0H12C13.4667 0 14.6667 1.2 14.6667 2.66667C14.6667 6 15.2 9.2 16.1867 12.1867C16.48 13.12 16.2667 14.16 15.52 14.9067L9.65333 20.7733Z" />'),_()(Hc,Qc.GBM,'<path fill-rule="evenodd" clip-rule="evenodd" d="M4.79998 0H43.2001C45.8399 0 47.9999 2.16 47.9999 4.80001V33.6C47.9999 36.2401 45.8399 38.4001 43.2001 38.4001H9.59999L0 48L0.0239907 4.80001C0.0239907 2.16 2.16 0 4.79998 0ZM9.59999 28.7999H38.4V24H9.59999V28.7999ZM38.4 21.6H9.59999V16.8H38.4V21.6ZM9.59999 14.4H38.4V9.59999H9.59999V14.4Z"/>'),_()(Hc,Qc.SMS,'<path d="M14.3581 0L36.2582 0.0218172C38.6673 0.0218172 40.6383 1.96363 40.6383 4.36364V43.6363C40.6383 46.0364 38.6673 48 36.2582 48H14.3581C11.9491 48 10 46.0364 10 43.6363V4.36364C10 1.96363 11.9491 0 14.3581 0ZM14.3581 39.2728H36.2582V8.72728H14.3581V39.2728Z" />'),_()(Hc,Zc,'<path d="M48.17 5.87l-5.7-5.7-18.3 18.3L5.87.17l-5.7 5.7 18.3 18.3-18.3 18.3 5.7 5.7 18.3-18.3 18.3 18.3 5.7-5.7-18.3-18.3z" />'),_()(Hc,$c,'<path d="M24.02 0l.708 4.013A20.36 20.36 0 0 0 24 4C12.954 4 4 12.954 4 24s8.954 20 20 20c8.565 0 15.872-5.384 18.723-12.951l3.997.705C43.496 41.204 34.542 48 24 48 10.745 48 0 37.255 0 24S10.745 0 24 0h.02z" />'),_()(Hc,Yc.CONVERSATION,'<g><path d="M48 5.57447C47.9946 4.62811 47.6163 3.72205 46.9471 3.05286C46.278 2.38368 45.3719 2.00536 44.4255 2L24 2C23.0537 2.00536 22.1476 2.38368 21.4784 3.05286C20.8092 3.72205 20.4309 4.62811 20.4255 5.57447V11.1915H23.4894V5.06383H44.9362V20.383H38.2979C37.9662 20.3815 37.6432 20.4891 37.3787 20.6894L31.6596 24.9787V21.9149C31.6543 21.5102 31.4912 21.1237 31.205 20.8375C30.9189 20.5514 30.5323 20.3883 30.1277 20.383H26.5532V23.4468H28.5957V28.0426C28.5957 28.327 28.675 28.6059 28.8245 28.8479C28.9741 29.0899 29.1881 29.2855 29.4426 29.4127C29.697 29.54 29.9819 29.5938 30.2652 29.5683C30.5486 29.5427 30.8192 29.4388 31.0468 29.2681L38.8085 23.4468H44.4255C45.3719 23.4414 46.278 23.0631 46.9471 22.3939C47.6163 21.7248 47.9946 20.8187 48 19.8723V5.57447Z" /><path d="M15.8297 14.2553C14.3148 14.2553 12.8339 14.7046 11.5743 15.5462C10.3147 16.3878 9.33295 17.5841 8.75322 18.9837C8.17348 20.3833 8.0218 21.9234 8.31735 23.4092C8.61289 24.895 9.3424 26.2598 10.4136 27.331C11.4848 28.4022 12.8496 29.1318 14.3354 29.4273C15.8212 29.7228 17.3613 29.5712 18.7609 28.9914C20.1605 28.4117 21.3568 27.4299 22.1984 26.1703C23.0401 24.9107 23.4893 23.4298 23.4893 21.9149C23.4893 19.8835 22.6823 17.9352 21.2459 16.4988C19.8094 15.0623 17.8612 14.2553 15.8297 14.2553ZM15.8297 26.5106C14.9208 26.5106 14.0323 26.2411 13.2765 25.7361C12.5207 25.2311 11.9317 24.5134 11.5838 23.6736C11.236 22.8339 11.145 21.9098 11.3223 21.0183C11.4996 20.1268 11.9373 19.3079 12.5801 18.6652C13.2228 18.0225 14.0417 17.5848 14.9332 17.4075C15.8246 17.2301 16.7487 17.3211 17.5885 17.669C18.4282 18.0168 19.146 18.6059 19.651 19.3616C20.156 20.1174 20.4255 21.0059 20.4255 21.9149C20.4255 22.5184 20.3066 23.116 20.0757 23.6736C19.8447 24.2312 19.5062 24.7378 19.0794 25.1646C18.6527 25.5913 18.146 25.9299 17.5885 26.1608C17.0309 26.3918 16.4333 26.5106 15.8297 26.5106V26.5106Z"/><path d="M0 45.9149H31.6596V44.383C31.6596 37.4587 25.1438 32.6383 15.8298 32.6383C6.51574 32.6383 0 37.4587 0 44.383V45.9149ZM3.41106 42.177C4.73872 38.0919 9.53872 35.7021 15.8298 35.7021C22.1209 35.7021 26.9209 38.1941 28.2485 42.177L28.4732 42.8511H3.18638L3.41106 42.177Z"/></g>'),Hc));function Xc(e){var t=e.className,n=e.iconName,o=zc[n];return void 0===o?(An("[Icon]","Icon not found",n),null):'<svg class="'+["icon","icon_"+n,t].join(" ").trim()+'"  aria-hidden="true" width="48" height="48" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">'+o+"</svg>"}var Jc=function(){function e(t){f()(this,e),this.proactiveMessage=t,this.triggerId=t&&t.triggerUuid,this.type=t&&t.type||Oe,this.dismissProactiveMessage=this.dismissProactiveMessage.bind(this),this.isValidProactiveMessage=this.isValidProactiveMessage.bind(this)}return v()(e,[{key:"createCloseButton",value:function(){var e=this,t=document.createElement("button");return t.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.CLOSE_BUTTON),t.setAttribute("title",Et.TITLE.DISMISS),t.innerHTML=Xc({iconName:Ct}),t.addEventListener("click",(function(){e.type===Oe&&lt.set(Zt,ke),e.dismissProactiveMessage()})),t}},{key:"createContainer",value:function(){var e=document.createElement("div");return e.id=nt.PROACTIVE_MESSAGE.ID.CONTAINER,e.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.CONTAINER.DEFAULT),e.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME[lt.get(Vt).Align.toUpperCase()]),e}},{key:"createProactiveMessage",value:function(){var e=void 0;return this.type===Re?(e=document.createElement("div")).classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.CONVERSATIONAL):((e=document.createElement("button")).classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.DIRECT),e.addEventListener("click",(function(){lt.set(Zt,Me),lt.set(qt,ln),Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW})}))),e.id=nt.PROACTIVE_MESSAGE.ID.PREFIX+"-"+this.triggerId,e.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.DEFAULT),e.innerHTML=Xc({className:nt.PROACTIVE_MESSAGE.CLASSNAME.ICON,iconName:ft.CONVERSATION}),e.appendChild(this.createTitle()),e.appendChild(this.createContent()),e}},{key:"createTitle",value:function(){var e=document.createElement("span");return e.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.TITLE),e.textContent=Et.TITLE.MESSAGE,e}},{key:"createActionButtons",value:function(){var e=this,t=document.createElement("div"),n=document.createElement("button"),o=document.createElement("button");return t.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.BUTTON.CONTAINER),n.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.BUTTON.DEFAULT),n.textContent=this.proactiveMessage.button.title,n.addEventListener("click",(function(){lt.set(Zt,Me),lt.set(qt,ln),Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW})})),t.appendChild(n),o.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.BUTTON.DEFAULT),o.textContent=Et.BUTTON.DECLINE,o.addEventListener("click",(function(){lt.set(Zt,ke),e.dismissProactiveMessage()})),t.appendChild(o),t}},{key:"createContent",value:function(){var e=document.createElement("div"),t=document.createElement("p"),n=void 0;return t.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.TEXT),this.type===Re?(t.textContent=this.proactiveMessage.text,n=this.createActionButtons()):t.textContent=this.proactiveMessage.text,e.appendChild(t),n&&e.appendChild(n),e}},{key:"isValidProactiveMessage",value:function(){var e=this.proactiveMessage,t=e||{},n=t.button,o=t.text,i=t.type;if("object"!==(void 0===e?"undefined":y()(e)))return!1;switch(i){case Re:return!!n&&!!o;case Oe:return!!o;default:return An("[ProactiveMessage]","Unknown message type"),!1}}},{key:"dismissProactiveMessage",value:function(){var e;hn.set((e={},_()(e,Mt,!1),_()(e,Nt,!0),e)),this.$container&&(this.$container.classList.add(nt.PROACTIVE_MESSAGE.CLASSNAME.CONTAINER.HIDDEN),setTimeout(this.removeContent.bind(this),280))}},{key:"removeContent",value:function(){for(;this.$container&&this.$container.firstChild;)this.$container.removeChild(this.$container.firstChild)}},{key:"unmount",value:function(){this.$container&&document.body.removeChild(this.$container)}},{key:"render",value:function(){this.isValidProactiveMessage()&&(this.type===Oe&&lt.set(Zt,Me),this.$container=this.createContainer(),this.$container.appendChild(this.createCloseButton()),this.$container.appendChild(this.createProactiveMessage()),document.body.appendChild(this.$container))}}]),e}();function eu(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(eu.prototype=window.Event.prototype,window.CustomEvent=eu),"function"!=typeof i.a&&Object.defineProperty(Object,"assign",{value:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},writable:!0,configurable:!0});!function(){function e(){f()(this,e),this.$badge=document.createElement("button"),this.$unreadMessages=document.createElement("span"),this.unreadMessageCount=0,this.displaySettings=lt.get(Vt)||{},this.updateUnreadMessages=this.updateUnreadMessages.bind(this),this.setBadgeOptions()}v()(e,[{key:"addEventListeners",value:function(){var e=this,t=this.$badge;t.addEventListener("click",(function(){if(lt.get(Kt))Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_HIDE});else{if(lt.set(qt,cn),e.displaySettings.BadgeType===mt.OMNI)return function(e){var t=(lt.get(en)||{}).OmniBadge,n=void 0===t?{}:t;switch(e){case an:!function(e){var t=e.businessId,n=e.groupId,o=void 0===n?"":n,i=e.intentId,a=void 0===i?"":i;if(!t)return;window.open("https://bcrw.apple.com/sms:open?service=iMessage&recipient=urn:biz:"+t+"&biz-group-id="+o+"&biz-intent-id="+a)}({businessId:n.abcBusinessId,groupId:"ASAPP_Badge_Mobile_Web"});break;case sn:!function(e){var t=e.gbmId;if(!t)return;window.open("https://businessmessages.google.com/widget/agent/"+t+"?ctx="+(n=Wc()||{},o=n.Segments,i=n.CompanySubdivision,a=(lt.get(jt)||{}).PersistentId,btoa(g()({Segments:o,CompanySubdivision:i,PersistentId:a}))));var n,o,i,a}({gbmId:n.gbmId});break;case rn:lt.get(Gt).showSMSForm({smsPhoneNumberFormat:n.smsPhoneNumberFormat,entryType:Ze});break;case on:default:Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW})}}(e.channel);Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW})}window.setTimeout((function(){t.blur()}),280)})),window.setTimeout((function(){!function(e,t){if(!Fc(e))return An.Error("on:",'"event type" is required and must be valid.',"Currently defined as:",e);var n=Vc();n&&n.addEventListener(e,t)}(nt.INTEGRATION.ACTION.EVENTS.MESSAGE_RECEIVED,(function(){e.updateUnreadMessages()}))}),10)}},{key:"showBadge",value:function(){this.displaySettings.BadgeType===mt.OMNI&&(this.channel=function(e){var t=(lt.get(en)||{}).OmniBadge,n=void 0===t?{}:t,o=(lt.get(Ft)||{}).deviceType;e&&e.length||(e=n.channels||[]);for(var i=0;i<e.length;i++){var a=e[i],s=!1;switch(a){case an:o===et&&n.abcBusinessId&&(s=!0);break;case rn:lt.get(Gt)&&n.smsPhoneNumberFormat&&(s=!0);break;case sn:n.gbmId&&o===tt&&(s=!0);break;case on:s=!0}if(s)return a}return on}()),this.$badge.classList.remove(nt.BADGE.CLASSNAME.HIDDEN)}},{key:"setBadgeOptions",value:function(){var e=this.displaySettings,t=e.BadgeColor,n=e.BadgeText,o=e.BadgeType,i=e.PrimaryColor,a=e.DarkColor;n&&o===mt.TRAY&&(this.$text=document.createElement("span"),this.$text.classList.add(nt.BADGE.TEXT.CLASSNAME),this.$text.textContent=n),this.appendStyle({BadgeColor:t,PrimaryColor:i,DarkColor:a})}},{key:"appendStyle",value:function(e){var t=e.BadgeColor,n=e.PrimaryColor,o=e.DarkColor,i=[];if("string"==typeof t){var a=nt.BADGE.CLASSNAME.DEFAULT;i.push("\n            ."+a+"{background-color:"+t+";}\n            ."+a+":focus,\n            ."+a+":hover,\n            ."+a+":active{background-color:#fff;color:"+t+";}\n            ."+a+":focus .icon,\n            ."+a+":hover .icon,\n            ."+a+":active .icon{fill:"+t+";}\n            ")}if("string"==typeof n){var s=nt.PROACTIVE_MESSAGE.CLASSNAME.ICON,r=nt.PROACTIVE_MESSAGE.CLASSNAME.BUTTON.DEFAULT;i.push("\n            ."+s+"{fill:"+n+";}\n            ."+r+"{border-color:"+n+"; color:"+n+"}\n            ."+r+":focus,\n            ."+r+":hover,\n            ."+r+":active{background-color:"+n+";color:#fff;}\n            ")}if("string"==typeof o){var c=nt.PROACTIVE_MESSAGE.CLASSNAME.TEXT,u=nt.PROACTIVE_MESSAGE.CLASSNAME.TITLE;i.push("\n            ."+c+"{color:"+o+";}\n            ."+u+"{color:"+o+";}\n            ")}if(i.length){var l=document.createElement("style");l.textContent=i.join(""),document.head.appendChild(l)}}},{key:"renderUnreadMessageIndicator",value:function(){Su(this.$unreadMessages,{"aria-hidden":!0,role:"status",class:nt.BADGE.UNREAD_INDICATOR.CLASSNAME,title:ht.UNREAD_INDICATOR}),this.$badge.appendChild(this.$unreadMessages),this.unreadMessageCount=parseInt(hn.get(Dt)||"0",10),this.unreadMessageCount>0&&this.updateUnreadMessages(!0)}},{key:"render",value:function(){var e=this.$badge,t=this.displaySettings,n=t.Align,o=t.BadgeType;e.innerHTML=Xc({iconName:gt.INACTIVE})+Xc({iconName:gt.ACTIVE}),this.$text&&e.appendChild(this.$text),Su(e,{"aria-controls":nt.IFRAME.ID,class:[lt.get(Ht),nt.BADGE.CLASSNAME.DEFAULT,nt.BADGE.CLASSNAME.HIDDEN,nt.BADGE.CLASSNAME.CLOSED,nt.BADGE.CLASSNAME[n.toUpperCase()],nt.BADGE.CLASSNAME.DEFAULT+"_"+o],"data-target":nt.BADGE.ID,id:nt.BADGE.ID,title:ht.OPEN,type:"button"}),this.renderUnreadMessageIndicator(),document.body.appendChild(e),this.addEventListeners()}},{key:"resetUnreadMessages",value:function(){this.unreadMessageCount=0,hn.set(Dt,this.unreadMessageCount),this.$unreadMessages.classList.remove(nt.BADGE.UNREAD_INDICATOR.VISIBLE),this.$unreadMessages.innerText="",this.$unreadMessages.setAttribute("aria-hidden",!0),this.$unreadMessages.setAttribute("aria-label","")}},{key:"updateOpenStatus",value:function(){var e=this.$badge;lt.get(Kt)?(e.classList.add(nt.BADGE.CLASSNAME.OPENED),e.classList.remove(nt.BADGE.CLASSNAME.CLOSED),e.classList.remove(nt.BADGE.CLASSNAME.HIDDEN),Su(e,{title:ht.CLOSE}),this.resetUnreadMessages()):(e.classList.add(nt.BADGE.CLASSNAME.CLOSED),e.classList.remove(nt.BADGE.CLASSNAME.OPENED),Su(e,{title:ht.OPEN}))}},{key:"unmount",value:function(){this.$badge&&document.body.removeChild(this.$badge)}},{key:"updateUnreadMessages",value:function(e){if(!0===e||!lt.get(Kt)){var t=this.$unreadMessages,n=void 0;"boolean"!=typeof e&&this.unreadMessageCount++,hn.set(Dt,this.unreadMessageCount),this.unreadMessageCount<=5?n=this.unreadMessageCount:this.unreadMessageCount>5&&(n="5+"),(this.unreadMessageCount<=6||!0===e)&&(t.textContent=n,t.setAttribute("aria-hidden",!1),t.setAttribute("aria-label",n+" "+ht.UNREAD_INDICATOR),t.classList.add(nt.BADGE.UNREAD_INDICATOR.VISIBLE))}}}])}();var tu=function(){function e(t){f()(this,e),this.$draggableEl=t,this.frameTop=0,this.frameLeft=0,this.getNextPos=this.getNextPos.bind(this),this.handleDragEvent=this.handleDragEvent.bind(this),this.handleDragStart=this.handleDragStart.bind(this),this.handleDragEnd=this.handleDragEnd.bind(this),this.handleFrameMouseMove=this.handleFrameMouseMove.bind(this)}return v()(e,[{key:"getNextPos",value:function(e,t){var n=this.frameLeft+e,o=this.frameTop+t;return window.innerWidth-n<this.width&&(n=window.innerWidth-this.width),window.innerHeight-o<this.height&&(o=window.innerHeight-this.height),{x:Math.max(0,n),y:Math.max(0,o)}}},{key:"handleDragEvent",value:function(e){switch(e.type){case Ae:this.handleDragStart();break;case ye:this.handleFrameMouseMove(e.offsetX,e.offsetY);break;case be:this.handleDragEnd()}}},{key:"handleDragStart",value:function(){var e=this.$draggableEl,t=e.offsetTop,n=e.offsetLeft,o=e.offsetWidth,i=e.offsetHeight;this.frameTop=t,this.frameLeft=n,this.width=o,this.height=i,document.addEventListener("mouseup",this.handleDragEnd)}},{key:"handleDragEnd",value:function(){hn.set(It,{x:this.frameLeft,y:this.frameTop}),document.removeEventListener("mouseup",this.handleDragEnd)}},{key:"handleFrameMouseMove",value:function(e,t){var n=this.getNextPos(e,t);this.frameTop=n.y,this.frameLeft=n.x,this.$draggableEl.style.top=n.y+"px",this.$draggableEl.style.left=n.x+"px"}}]),e}(),nu=nt.MODAL_BACKGROUND.CLASSNAME;var ou,iu={colors:Mr},au=function(e){var t=e.onBackground;return{gray85:Object(Os.rgba)(t,.85),gray60:Object(Os.rgba)(t,.6),gray50:Object(Os.rgba)(t,.5),gray25:Object(Os.rgba)(t,.25),gray12:Object(Os.rgba)(t,.12),gray5:Object(Os.rgba)(t,.05)}},su=function(e){var t=e.buttons,n=void 0===t?{}:t,o=e.primary,i=e.onPrimary,a=e.onBackground;return{primary:N()({background:o,text:i},n.primary),secondary:N()({text:a,border:o},n.secondary),textPrimary:N()({text:o},n.textPrimary)}},ru=function(e){var t=e||{},n=t.primary,o=t.onPrimary,i=t.onBackground;return{customerMessageBackground:n,customerMessageText:o,repMessageBackground:Object(Os.rgba)(i,.12),repMessageText:i}},cu=function(e){var t=e||{},n=t.primary,o=t.onPrimary,i=t.onBackground;return{quickReplyButtonPrimary:n,quickReplyButtonOnPrimary:o,newQuestionButtonPrimary:n,borderColor:Object(Os.rgba)(i,.12)}},uu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=e[t]||e.default,o=rt(iu,n),i=N()({},o,{colors:N()({},ru(o.colors),au(o.colors),cu(o.colors),o.colors,{buttons:su(o.colors)})});return i},lu=["","moz","MS","o","webkit"],du=(ou={},_()(ou,bt,!0),_()(ou,Ot,!0),ou);(function(){function e(){f()(this,e),this.$iframe=document.createElement("div"),this.$frameEl=document.createElement("iframe"),this.queuedMessages=[],this.browserNotificationCount=0,this.$frameEl.addEventListener("load",this.setIFrameMessageBus.bind(this)),this.handleAnimationToggle=this.handleAnimationToggle.bind(this),this.handleNotificationPermissionRequest=this.handleNotificationPermissionRequest.bind(this),this.handleIFrameLoaded=this.handleIFrameLoaded.bind(this),this.handleRequestContext=this.handleRequestContext.bind(this),this.handleRequestUserLogin=this.handleRequestUserLogin.bind(this),this.hide=this.hide.bind(this),this.setScreenSizeClassnames=at(this.setScreenSizeClassnames,99).bind(this),this.showChat=this.showChat.bind(this),this.showSMSForm=this.showSMSForm.bind(this),this.displayIFrame=this.displayIFrame.bind(this),this.requestProactiveMessage=this.requestProactiveMessage.bind(this),this.getIFrameStatus=this.getIFrameStatus.bind(this),this.setIFrameStatus=this.setIFrameStatus.bind(this),this.updateHostLocation=this.updateHostLocation.bind(this),this.requestCobrowsingUserId=this.requestCobrowsingUserId.bind(this),this.handleCobrowsingLoad=this.handleCobrowsingLoad.bind(this),this.handleDockChat=this.handleDockChat.bind(this),this.resetPosition=this.resetPosition.bind(this),this.setIFrameLocalStorage=this.setIFrameLocalStorage.bind(this),this.pushBrowserNotification=this.pushBrowserNotification.bind(this),this.removeBrowserNotification=this.removeBrowserNotification.bind(this),this.draggable=new tu(this.$iframe)}v()(e,[{key:"setIFrameMessageBus",value:function(){var e=this;this.messageBus=new gi(this.$frameEl.contentWindow,it(),"IFrameMessageBus"),this.queuedMessages.length&&(this.queuedMessages.forEach((function(t){var n=t.type,o=t.data;e.messageBus.post(n,o)})),this.queuedMessages=[]),this.addMessageBusListeners()}},{key:"addEventListeners",value:function(){var e=this,t=this.$iframe;window.addEventListener("resize",this.setScreenSizeClassnames),window.addEventListener("hashchange",this.updateHostLocation),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&e.notification&&e.removeBrowserNotification()})),t.addEventListener(nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW,this.showChat),t.addEventListener(nt.INTEGRATION.ACTION.EVENTS.CHAT_HIDE,this.hide),lu.forEach((function(n){t.addEventListener(n+"AnimationEnd",e.handleAnimationToggle,!1),t.addEventListener(n+"AnimationStart",e.handleAnimationToggle,!1),t.addEventListener(n+"TransitionEnd",e.handleAnimationToggle,!1),t.addEventListener(n+"TransitionStart",e.handleAnimationToggle,!1)}))}},{key:"addMessageBusListeners",value:function(){this.messageBus?(this.messageBus.on(F,(function(){Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_HIDE})})),this.messageBus.on(Q,this.handleRequestContext),this.messageBus.on(Z,this.handleRequestUserLogin),this.messageBus.on(K,Eu),this.messageBus.on(V,this.handleIFrameLoaded),this.messageBus.on(j,this.requestCobrowsingUserId),this.messageBus.on(ce,gu),this.messageBus.on(G.ACTION,Uc),this.messageBus.on(X,(function(e){hn.set(Tt,e.timestamp)})),this.messageBus.on(ie,(function(e){hn.set(yt,e.isLiveChat)})),this.messageBus.on(x,this.handleCobrowsingLoad),this.messageBus.on(U,this.draggable.handleDragEvent),this.messageBus.on(se,this.toggleChatInstead),this.messageBus.on(H,this.handleDockChat),this.messageBus.on(Y,this.handleNotificationPermissionRequest),this.messageBus.on(W,this.pushBrowserNotification)):An("IFrame","addMessageBusListeners()","Missing messageBus")}},{key:"postMessage",value:function(e,t){this.messageBus?this.messageBus.post(e,t):this.queuedMessages.push({type:e,data:t})}},{key:"requestProactiveMessage",value:function(){var e=hn.get(kt),t=lt.get(Yt);this.postMessage($,{UnauthedImpression:e,ActiveTriggerId:t&&t.triggerId})}},{key:"buildIFrameSRC",value:function(){var e=location.protocol+"//"+location.host+location.pathname,t=["APIHostname="+encodeURIComponent(lt.get(Lt)),"CompanyMarker="+encodeURIComponent(lt.get(Ht)),"Origin="+encodeURIComponent(e),"RegionCode="+encodeURIComponent(lt.get(Xt))].join("&");return[it(),pu(),"/chat-sdk-iframe.html","?",t].join("")}},{key:"handleAnimationToggle",value:function(e){var t=/end/i.test(e.type)&&this.$iframe.classList.contains(nt.IFRAME.CLASSNAME.CLOSED)?"add":"remove";this.$iframe.classList[t](nt.IFRAME.CLASSNAME.CLOSED_FINISHED)}},{key:"handleDockChat",value:function(e){var t=e.isDocked;if(this.resetPosition(),lt.get(Vt).FrameStyle===qe){var n=document.querySelector("html");t?(this.$iframe.classList.add(nt.IFRAME.CLASSNAME.SIDEBAR),n.classList.add(nt.HOSTHTML.CLASSNAME.CHAT_SIDEBAR)):(this.$iframe.classList.remove(nt.IFRAME.CLASSNAME.SIDEBAR),n.classList.remove(nt.HOSTHTML.CLASSNAME.CHAT_SIDEBAR))}}},{key:"resetPosition",value:function(){hn.remove(It),this.$iframe.style.right="",this.$iframe.style.top="",this.$iframe.style.left="",this.$iframe.style.bottom=""}},{key:"handleIFrameLoaded",value:function(e){hn.set(e);var t=lt.get(Bt),n=lt.get(Vt).HideBadgeOnLoad;t&&!n&&t.showBadge(),this.sendInitialData(),this.requestProactiveMessage(),function(e){var t=lt.get($t);if("function"==typeof t)try{t(e)}catch(t){An.Warn(Wa.ERRORS.ON_LOAD_COMPLETE,e?"":Wa.ERRORS.TRIGGER)}}(lt.get(nn));var o=hn.get()||{},i=o[Tt],a=o[Nt],s=o[bt],r=o[Rt],c=o[Ot],u=o[wt],l=o[It];if(void 0===a&&hn.set(Nt,!1),i&&Cu(i,"hours")<5&&this.handleCobrowsingLoad(),l&&!r&&(this.$iframe.style.top=l.y+"px",this.$iframe.style.left=l.x+"px"),c||u){if(s){if(!lt.get(Ut))return;this.setIFrameStatus("isLoggingIn",!1),hn.remove(bt),hn.remove(wt)}else if(r)return this.setIFrameStatus("openStatus",!1),void hn.set(Ot,!1);lt.set(qt,un),Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_SHOW})}}},{key:"handleRequestContext",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.ASAPP&&"function"==typeof window.ASAPP.ContextProvider?(An("IFrame","Calling ContextProvider()","refreshToken:",!!t.needsRefresh),window.ASAPP.ContextProvider((function(t){if("object"===(void 0===t?"undefined":y()(t))&&null!==t)for(var n in t)Kc(n,t[n]);e.postMessage(J,Wc())}),t.needsRefresh)):(An("IFrame","Missing ContextProvider"),this.postMessage(J,Wc()))}},{key:"handleRequestUserLogin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.ASAPP&&"function"==typeof window.ASAPP.UserLoginHandler?(this.setIFrameStatus("isLoggingIn",!0),hn.set(bt,!0),hn.get(At)&&(hn.set(wt,!0),Uc({type:nt.INTEGRATION.ACTION.EVENTS.CHAT_HIDE})),window.ASAPP.UserLoginHandler(e)):An("IFrame","Missing UserLoginHandler.")}},{key:"setScreenSizeClassnames",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(lt.get(Kt)){var n=this.$iframe,o=hu(),i=[{label:nt.IFRAME.CLASSNAME.IS_FULLSCREEN,add:o.small},{label:nt.IFRAME.CLASSNAME.IS_MOBILE,add:o.medium||o.small}];i.forEach((function(e){n.classList[e.add?"add":"remove"](e.label)})),o.small?document.querySelector("html").classList.add(nt.HOSTHTML.CLASSNAME.CHAT_FULLSCEEN):document.querySelector("html").classList.remove(nt.HOSTHTML.CLASSNAME.CHAT_FULLSCEEN),hn.set((e={},_()(e,At,o.small),_()(e,Rt,o.small||o.medium),e)),this.postMessage(oe,{currentScreenSize:o,mobileClassnames:i,shouldDock:"resize"===t.type||!hn.get(It)})}}},{key:"setIFrameLocalStorage",value:function(e,t){var n={},o=!1;"object"===(void 0===e?"undefined":y()(e))?E()(e).forEach((function(t){du[t]&&(n[t]=e[t],o=!0)})):du[e]&&(n=_()({},e,t),o=!0),o&&this.postMessage(ne,n)}},{key:"hide",value:function(){var e=this.$iframe,t=lt.get(Bt);lt.set(Kt,!1),this.setIFrameStatus("openStatus",!1),hn.set(Ot,!1),e.setAttribute("aria-expanded",!1),this.setScreenSizeClassnames(),document.body.removeEventListener("touchmove",mu),document.querySelector("html").classList.remove(nt.HOSTHTML.CLASSNAME.CHAT_OPEN),e.classList.remove(nt.IFRAME.CLASSNAME.OPENED),e.classList.add(nt.IFRAME.CLASSNAME.CLOSED),e.classList.contains(nt.IFRAME.CLASSNAME.SMS_FORM)&&setTimeout((function(){e.classList.remove(nt.IFRAME.CLASSNAME.SMS_FORM)}),280),t&&(t.updateOpenStatus(),t.$badge.focus())}},{key:"toggleChatInstead",value:function(e){var t,n=e.showChatInstead,o=lt.get(Pt);o?n?o.show():o.hide():(t=lt.get(Qt))&&(t.classList.remove(nu.OPENED),t.classList.add(nu.CLOSED),setTimeout((function(){document.body.removeChild(t),lt.set(Qt,null)}),280))}},{key:"showSMSForm",value:function(e){!function(){if(!lt.get(Qt)){var e=document.createElement("div");e.classList.add(nu.DEFAULT),e.classList.add(nu.OPENED),document.body.appendChild(e),lt.set(Qt,e)}}(),this.displayIFrame(),this.$iframe.classList.add(nt.IFRAME.CLASSNAME.SMS_FORM),this.postMessage(re,e)}},{key:"showChat",value:function(){var e=hn.get(Ot);lt.set(Kt,!0),this.setIFrameStatus("openStatus",!0),hn.set(Ot,!0),hn.set(Nt,!0),this.displayIFrame();var t=lt.get(Yt),n=lt.get(Bt);this.postMessage(ae,{proactiveMessage:t&&t.proactiveMessage||null,proactiveMessageStatus:lt.get(Zt),initiationType:lt.get(qt),isAutoOpen:e}),t&&(t.dismissProactiveMessage(),lt.set(Yt,null),lt.set(Zt,null)),n&&n.updateOpenStatus()}},{key:"displayIFrame",value:function(){var e=this,t=document.querySelector("html");this.$iframe.setAttribute("aria-expanded",!0),this.setScreenSizeClassnames(),document.body.addEventListener("touchmove",mu),t.classList.add(nt.HOSTHTML.CLASSNAME.CHAT_OPEN),lt.get(Vt).FrameStyle!==qe||hn.get(It)||(t.classList.add(nt.HOSTHTML.CLASSNAME.CHAT_SIDEBAR),this.$iframe.classList.add(nt.IFRAME.CLASSNAME.SIDEBAR)),this.$iframe.classList.remove(nt.IFRAME.CLASSNAME.CLOSED),this.$iframe.classList.remove(nt.IFRAME.CLASSNAME.CLOSED_FINISHED),window.setTimeout((function(){e.$iframe.style.height="",e.$iframe.classList.add(nt.IFRAME.CLASSNAME.OPENED)}),20)}},{key:"render",value:function(){var e=this.$iframe,t=this.$frameEl,n=lt.get(Vt),o=n.Align.toUpperCase();e.style.height=0,Su(e,{"aria-labelledby":nt.FRAME_EL.ID,class:[nt.IFRAME.CLASSNAME.DEFAULT,nt.IFRAME.CLASSNAME.CLOSED,nt.IFRAME.CLASSNAME.CLOSED_FINISHED,nt.IFRAME.CLASSNAME[o],nt.IFRAME.CLASSNAME.DEFAULT+"_"+n.BadgeType],"data-target":nt.IFRAME.ID,id:nt.IFRAME.ID}),document.querySelector("html").classList.add(nt.HOSTHTML.CLASSNAME[o]),Su(t,{class:nt.FRAME_EL.CLASSNAME.DEFAULT,id:nt.FRAME_EL.ID,title:pt.TITLE}),t.frameBorder=0,t.allowTransparency="true",t.src=this.buildIFrameSRC(),e.appendChild(t),document.body.appendChild(e),this.addEventListeners()}},{key:"sendInitialData",value:function(){var e=lt.get(en)||{},t=lt.get(Vt)||{};this.postMessage(z,{apiHostname:lt.get(Lt),appId:lt.get(Ht),customerId:lt.get(Ut),deviceInfo:lt.get(Ft),displaySettings:t,intent:lt.get(Wt),loadIdentifiers:lt.get(jt),regionCode:lt.get(Xt),sound:lt.get(tn),host:{sdkLoadTime:lt.get(Jt),referrerUrl:lt.get(zt),location:lt.get(xt),notificationPermission:_u()?Notification.permission:Je},theme:uu(e.Styles,t.Identity)})}},{key:"setIFrameStatus",value:function(e,t){try{window.sessionStorage.setItem("asappChatSDK-iframe-status",g()(i()({},this.getIFrameStatus(),_()({},e,t))))}catch(e){this.showSessionStorageError()}}},{key:"getIFrameStatus",value:function(){try{var e=window.sessionStorage.getItem("asappChatSDK-iframe-status");return e?JSON.parse(e):{}}catch(e){this.showSessionStorageError()}}},{key:"showSessionStorageError",value:function(){this.postMessage(te,Te)}},{key:"unmount",value:function(){var e=this;this.postMessage(de),this.messageBus&&this.messageBus.stopListening(),window.setTimeout((function(){e.$iframe&&document.body.removeChild(e.$iframe)}),1e3)}},{key:"updateHostLocation",value:function(){var e=JSON.parse(g()(window.location));lt.set(xt,e),this.postMessage(ue,e)}},{key:"handleNotificationPermissionRequest",value:function(){var e=this;try{Notification&&Notification.requestPermission((function(t){e.postMessage(le,t)}))}catch(e){An("handleNotificationPermissionRequest()",e)}}},{key:"pushBrowserNotification",value:function(e){var t,n=this,o=e.body;this.browserNotificationCount++;var i=Tu(this.browserNotificationCount);this.notification=new Notification(i,{body:o||"",tag:"ASAPPWebNotification",requireInteraction:!0});var a=(lt.get(Ft)||{}).deviceType,s=(t={},_()(t,Ee.DEVICE_TYPE,a),_()(t,Ee.COUNT,this.browserNotificationCount),t);this.notification.addEventListener("show",(function(){vu({label:he.WEB_NOTIFICATION,type:pe.DISPLAY,tags:s})})),this.notification.addEventListener("click",(function(){window.focus(),n.removeBrowserNotification(),vu({label:he.WEB_NOTIFICATION,type:pe.SELECT,tags:s})}))}},{key:"removeBrowserNotification",value:function(){this.notification&&(this.browserNotificationCount=0,this.notification.close())}},{key:"handleCobrowsingLoad",value:function(){var e=this;"function"!=typeof window.Upscope&&(An("IFrame","Initiate Upscope"),function(e){"function"!=typeof window.Upscope&&(window.Upscope=Au,function(e){var t=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="//"+e+"/cobrowsing/upscope.js",t.parentNode.insertBefore(n,t)}(e));window.Upscope("init",{apiKey:"PEbyfAbnaP",showUpscopeLink:!1,allowRemoteConsole:!1,allowRemoteClick:!1,allowRemoteScroll:!0,allowRemoteType:!1,domChangesDelay:50,maskedElements:["input","textarea",".hideCobrowsing"]})}(lt.get(Lt))),window.Upscope("on","sessionContinue",(function(){e.requestCobrowsingUserId(Ce)}))}},{key:"requestCobrowsingUserId",value:function(e){var t=this;An("IFrame","Requesting Cobrowsing UserId"),"function"!=typeof window.Upscope&&this.handleCobrowsingLoad(),window.Upscope("getUserId",(function(n){An("IFrame","Cobrowsing UserId: ",n),e===ge?t.postMessage(B,n):e===Ce&&t.postMessage(P,{timestamp:hn.get(Tt),userId:n})}))}}])})(),Vs()({Align:"right",AlwaysShowMinimize:!1,BadgeColor:null,BadgeText:null,BadgeType:mt.BADGE,FrameDraggable:!1,FrameStyle:Ge,HideBadgeOnLoad:!1,Identity:void 0,PrimaryColor:null,DarkColor:null});function hu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.document.documentElement.clientWidth;return{large:e>=je,medium:e>Ke&&e<je,small:e<=Ke}}function pu(e){var t=e||window.location.href,n=t.match(/^https:\/\/(.*)circle-artifacts.com|^https:\/\/s3.amazonaws.com/i);if(n&&n.length>0){var o=t.split(n[0])[1];return o.substring(0,o.lastIndexOf("/"))}return""}function Eu(e){"string"==typeof e&&window.open(e,"_self")}function mu(e){var t=e&&e.target&&e.target.parentElement&&e.target.parentElement.clientWidth;if(lt.get(Kt)&&t<=Qe)return e.preventDefault(),!1}function gu(e){if(!lt.get(Kt)){var t;if(!e)return;var n=lt.get(Yt);n&&n.unmount();var o=new Jc(e);lt.set(Yt,o),o.render();var i=hn.get(kt)||{},a=i[e.triggerUuid]||[];hn.set((t={},_()(t,Mt,!0),_()(t,kt,N()({},i,_()({},e.triggerUuid,a.concat(Date.now())))),t))}}function Su(e,t){for(var n in t)"class"===n?("string"==typeof t[n]&&(t[n]=[t[n]]),t[n].forEach((function(t){e.classList.add(t)}))):e.setAttribute(n,t[n]);return e}function fu(e,t){var n=t.key,o=t.value;return!("array"!==e||!Array.isArray(o))||((void 0===o?"undefined":y()(o))===e&&null!==o||null!=o&&An.Error('"'+n+'"','Value must be "'+e+'"'))}function Cu(e,t){if(!e)return null;t=t?t.toLowerCase():"seconds";var n=Date.now();switch(t){case"seconds":return Math.ceil((n-e)/1e3);case"minutes":return Math.ceil((n-e)/6e4);case"hours":return Math.ceil((n-e)/36e5);case"days":return Math.ceil((n-e)/864e5);default:return Math.ceil((n-e)/1e3)}}function vu(e){var t=lt.get(Gt);t&&"function"==typeof t.postMessage&&t.postMessage(q,e)}var Tu=function(e){lt.get(Xt);return e>1?e+" "+Ka(Wa.NOTIFICATION.TITLE.MULTIPLE):Ka(Wa.NOTIFICATION.TITLE.DEFAULT)},_u=function(){if(!window.Notification||!Notification.requestPermission)return!1;if("granted"==Notification.permission)return!0;try{new Notification("")}catch(e){if("TypeError"==e.name)return!1}return!0};var Iu,Nu,Au=function e(){e.c(arguments)};Au.q=[],Au.c=function(e){Au.q.push(e)};var yu=Ro,bu=Oo,Ru=vo,Ou=To,Mu=_o,ku=Io,wu=No,Du=(Iu={},_()(Iu,Ru,100),_()(Iu,Ou,5),_()(Iu,Mu,30),_()(Iu,ku,500),_()(Iu,wu,0),Iu),Lu=(Nu={},_()(Nu,go,[]),_()(Nu,Co,[]),_()(Nu,fo,null),_()(Nu,So,Du),Nu),Bu="analytics/settings",Pu="analytics/events",Hu="analytics/transaction-events",Uu="token?grant_type=client_credentials&client_id=no_id&client_secret=no_secret",Fu=function(){function e(){var t=this;f()(this,e),this.pendingEvents={},this.fetchingToken=!1,this.lastSent=null,this.eventRequestRetries=0,this.onEventsRequestSuccess=this.onEventsRequestSuccess.bind(this),this.onEventsRequestFailure=this.onEventsRequestFailure.bind(this),this.onTokenReceived=this.onTokenReceived.bind(this),this.removeEvents=this.removeEvents.bind(this),this.sendEvents=this.sendEvents.bind(this),this.setData(i()({},Lu,this.getData())),this.resetBatchTimer(Du[Mu]),window.addEventListener("beforeunload",(function(){clearTimeout(t.batchTimeout)}))}return v()(e,[{key:"addToEvents",value:function(e,t){var n=this.getData(),o=n.events,i=void 0===o?[]:o,a=n.transactionEvents,s=void 0===a?[]:a,r=n.settings,c=void 0===r?{}:r,u=t?s:i;if(u.length>c[ku])An("[Metrics]","addToEvents()","Max number of persisted events has reached");else{var l=u.concat(e),d=t?Co:go;this.setData(d,l),(Cu(this.lastSent)||0)>=c[Ou]&&l.length>=c[Ru]&&this.sendEvents()}}},{key:"getBaseUrl",value:function(){var e=Gh.getState().partnerConfig.apiHostname;if(/test.asapp.com$/.test(e))return"https://hudson-dev01-frontend.test.asapp.com";if(e){var t=e.indexOf(".");return t<0?e:"https://"+e.substr(0,t)+"-frontend"+e.substr(t)}}},{key:"endDuration",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],i=this.pendingEvents[e];if(!i)return An("[Metrics]","endDuration()","Pending event does not exist for "+e),this;var a=(Date.now()-i.startTime)/1e3;return this.recordEvent(e,t,{value:a,valueType:Ao.DURATION,valueUnit:yo.SECONDS,tags:n.tags||i.tags,data:n.data||i.data},o),this.removePendingEvent(e),this}},{key:"fetchToken",value:function(){var e=this;this.fetchingToken||(this.fetchingToken=!0,this.sendMetricsRequest({path:Uu,onSuccess:this.onTokenReceived,onFailure:function(){e.fetchingToken=!1}}))}},{key:"getData",value:function(e){var t=Ph.get(Eo,e);return yc(t)?e?Lu[e]:Lu:t}},{key:"getEventProperties",value:function(e){var t,n,o=e.name,a=e.value,s=e.valueType,r=e.valueUnit,c=e.tags,u=e.data,l=(t={},_()(t,yu.EXTERNAL_ID,ut.a.create().toString()),_()(t,yu.EVENT_DATE,{value:(new Date).toISOString()}),_()(t,yu.EVENT_TYPE,o),_()(t,yu.VALUE,a),_()(t,yu.TAGS,this.parseTags(c)),_()(t,yu.VALUE_TYPE,s),_()(t,yu.VALUE_UNITS,r),t);u&&i()(l,(n={},_()(n,yu.CONTENT_TYPE,"application/json"),_()(n,yu.CONTENT_TRANSFER_ENCODING,"text/plain"),_()(n,yu.CONTENT_VERSION,"1"),_()(n,yu.DATA,g()(u)),n));return l}},{key:"getMetadata",value:function(){var e,t=Gh.getState(),n=t.chat.session,o=t.partnerConfig.loadIdentifiers;return e={},_()(e,bu.CLIENT_ID,o&&o[Pc]),_()(e,bu.USER_SESSION_ID,n&&n.session_id),e}},{key:"onEventsRequestFailure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};401===e.status?(An("[Metrics]","Expired token. Refetching..."),this.fetchToken()):this.eventRequestRetries++}},{key:"onEventsRequestSuccess",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];this.eventRequestRetries=0,this.updateSettings(e.settings),this.removeEvents(e.events_processed,t)}},{key:"updateSettings",value:function(e){yc(e)||this.setData(So,i()({},this.getData(So),e))}},{key:"onTokenReceived",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setData(fo,t.access_token),this.sendMetricsRequest({token:t.access_token,path:Bu,onSuccess:function(t){e.updateSettings(t&&t.settings)}}),this.sendEvents(),this.fetchingToken=!1}},{key:"recordCount",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3];return this.recordEvent(e,t,N()({},n,{value:1,valueType:Ao.COUNT,valueUnit:yo.RAW}),o),this}},{key:"recordGauge",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments[4];return this.recordEvent(e,t,N()({},o,{value:n,valueType:Ao.GAUGE,valueUnit:yo.RAW}),i),this}},{key:"recordEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],i=this.getData(So);if(i&&i[wu]>t)return An("[Metrics]","recordEvent()","Invalid event to record"),null;var a={event:this.getEventProperties(N()({name:e},n)),metadata:this.getMetadata()};this.addToEvents(a,o)}},{key:"removeEvents",value:function(e,t){var n=t?Co:go,o=this.getData(n),i=o&&o.slice(0,o.length-e);this.setData(n,i)}},{key:"removePendingEvent",value:function(e){return this.pendingEvents&&delete this.pendingEvents[e],this}},{key:"sendEvents",value:function(){var e=this,t=this.getData(),n=t.events,o=void 0===n?[]:n,i=t.transactionEvents,a=void 0===i?[]:i,s=t.settings,r=void 0===s?{}:s;if(!(this.eventRequestRetries>=5)&&(this.resetBatchTimer(r[Mu]),o.length||a.length)){var c=this.getData(fo);if(!c)return An("[Metrics]","Token is required"),void this.fetchToken();if(o.length){var u=o.slice(0,r[Ru]);this.sendMetricsRequest({token:c,path:Pu,params:{events:u},onSuccess:this.onEventsRequestSuccess,onFailure:this.onEventsRequestFailure})}if(a.length){var l=a.slice(0,r[Ru]);this.sendMetricsRequest({token:c,path:Hu,params:{events:l},onSuccess:function(t){e.onEventsRequestSuccess(t,!0)},onFailure:this.onEventsRequestFailure})}this.lastSent=Date.now()}}},{key:"sendMetricsRequest",value:function(e){var t=e.token,n=e.path,o=e.onSuccess,i=e.onFailure,a=e.params;if(!this.baseUrl){var s=this.getBaseUrl();if(!s)return;this.baseUrl=s}var r=ac("POST",this.baseUrl+"/"+n);r.addEventListener("readystatechange",(function(){if(4===r.readyState)if(200===r.status)try{var e=r.response&&JSON.parse(r.response);"function"==typeof o&&o(e)}catch(e){"function"==typeof i&&i(r)}else"function"==typeof i&&i(r)})),dc(r),t&&(r.withCredentials=!0,r.setRequestHeader("Authorization","Bearer "+t)),r.send(a?g()(a):"")}},{key:"resetBatchTimer",value:function(e){clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(this.sendEvents,1e3*e)}},{key:"setData",value:function(e,t){Ph.set(Eo,e,t)}},{key:"startDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i()(this.pendingEvents,_()({},e,N()({},t,{startTime:Date.now()}))),this}},{key:"parseTags",value:function(e){if(!yc(e))return E()(e).forEach((function(t){"string"!=typeof e[t]&&(e[t]=g()(e[t]))})),e}}]),e}();var Vu,xu=_()({},po,24),Gu=function(){function e(t,n){var o=n.APIHostname,i=n.CompanyMarker,a=n.RegionCode;f()(this,e),this.environmentKey=[o,i,a].join("|");try{var s=new Date;(this.storage=window[t]).setItem(s,s);var r=this.storage.getItem(s)!==s.toString();this.storage.removeItem(s),r&&(this.storage=!1)}catch(e){An("[BrowserStorage]","No "+t+" access",e),this.storage=!1}}return v()(e,[{key:"addStorageEventListener",value:function(e,t){var n=this;window.addEventListener("storage",(function(o){if(o||(o=window.event||{}),o.key===n.getItemName(e))try{var i=JSON.parse(o.oldValue)||{},a=JSON.parse(o.newValue)||{};t(N()({},o,{oldValue:i,newValue:a}))}catch(e){An("[BrowserStorage]","Unable to parse JSON",e)}}))}},{key:"getItemName",value:function(e){return this.environmentKey+"|"+e}},{key:"get",value:function(e,t){if(this.storage){var n=JSON.parse(this.storage.getItem(this.getItemName(e)));return n?xu[e]&&Cu(n.lastUpdated,"hours")>xu[e]?(this.clear(e),null):"string"==typeof t?n[t]:(delete n.lastUpdated,n):null}return!1}},{key:"clear",value:function(e){if(!this.storage)return!1;this.storage.removeItem(this.getItemName(e))}},{key:"remove",value:function(e,t){if(!this.storage||!t)return!1;var n=this.get(e);delete n[t],this.storage.setItem(this.getItemName(e),g()(n))}},{key:"set",value:function(e,t,n){if(!this.storage||!t)return!1;var o=i()({},this.get(e),"object"===(void 0===t?"undefined":y()(t))?t:_()({},t,n),xu[e]&&_()({},"lastUpdated",Date.now()));this.storage.setItem(this.getItemName(e),g()(o))}}]),e}();var qu=(Vu={},_()(Vu,he.CHATINSTEAD,!0),_()(Vu,he.CHATINSTEAD_ABC,!0),_()(Vu,he.CHATINSTEAD_GBM,!0),_()(Vu,he.CHATINSTEAD_GETCHANNELSETTINGS,!0),_()(Vu,he.CHATINSTEAD_PHONE,!0),_()(Vu,he.CHATINSTEAD_SMS,!0),_()(Vu,he.CHATINSTEAD_WEB,!0),_()(Vu,he.SMS_VERIFICATION_CHECK,!0),_()(Vu,he.SMS_VERIFICATION_CHECK_FORM,!0),_()(Vu,he.SMS_VERIFICATION_START,!0),_()(Vu,he.SMS_VERIFICATION_START_FORM,!0),_()(Vu,he.WEB_NOTIFICATION,!0),_()(Vu,he.WEB_NOTIFICATION_PERMISSION,!0),_()(Vu,he.WEB_NOTIFICATION_PERMISSION_CONFIRM,!0),_()(Vu,he.WEB_NOTIFICATION,!0),_()(Vu,he.WEB_NOTIFICATION_PERMISSION,!0),_()(Vu,he.WEB_NOTIFICATION_PERMISSION_CONFIRM,!0),Vu);var Wu=function(e){return{type:"SET_NAV_MENU_OPEN",navMenuOpen:e}},Ku=Oi()(["\n    .icon {\n        fill: ",";\n    }\n\n    &:active,\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n"],["\n    .icon {\n        fill: ",";\n    }\n\n    &:active,\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n"]),ju=Rs.default.button(Ku,(function(e){return e.theme.colors.gray85}),(function(e){return e.theme.colors.gray5})),Qu=function(e){var t=e.classNames,n=e.iconName;e.regionCode;return s.a.createElement(ju,{className:["closeChat",t||""].join(" ").trim(),onClick:function(){uc.post(F)},title:Ka(Wa.MINIMIZE)},s.a.createElement(Gs,{iconName:n||"close"}))};Qu.propTypes={classNames:ki.a.string,iconName:ki.a.string,regionCode:ki.a.string};var Yu=Qu,Zu=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.state={dragging:!1},n.baseMouseX=0,n.baseMouseY=0,n.handleDragStart=n.handleDragStart.bind(n),n.handleDragEnd=n.handleDragEnd.bind(n),n.handleMouseMove=at(n.handleMouseMove,50).bind(n),n}return bi()(t,e),v()(t,[{key:"handleDragStart",value:function(e){if(0===e.button){if(this.props.isDocked&&(this.props.setIsDocked(!1),this.props.displaySettings.FrameStyle===qe))return;this.setState({dragging:!0}),this.baseMouseX=e.clientX,this.baseMouseY=e.clientY,uc.post(U,{type:Ae}),document.addEventListener("mouseup",this.handleDragEnd),document.addEventListener("mousemove",this.handleMouseMove)}}},{key:"handleDragEnd",value:function(){this.setState({dragging:!1}),uc.post(U,{type:be}),document.removeEventListener("mouseup",this.handleDragEnd),document.removeEventListener("mousemove",this.handleMouseMove)}},{key:"handleMouseMove",value:function(e){e.preventDefault(),uc.post(U,{type:ye,offsetX:e.clientX-this.baseMouseX,offsetY:e.clientY-this.baseMouseY})}},{key:"render",value:function(){var e=this.props.isDocked&&this.props.displaySettings.FrameStyle===qe?Wa.CHAT_NAV_BAR.UNDOCK:Wa.CHAT_NAV_BAR.DRAG;return s.a.createElement("div",{className:bs()(this.props.className,"draggable"),onMouseDown:this.handleDragStart},s.a.createElement("span",{className:"draggable__content"},this.props.children),s.a.createElement("span",{"aria-hidden":"true",className:"draggable__tooltip"},Ka(e,this.props.regionCode)))}}]),t}(s.a.Component);Zu.propTypes={regionCode:ki.a.string,className:ki.a.string,children:ki.a.object,isDocked:ki.a.bool,displaySettings:ki.a.object,setIsDocked:ki.a.func};var $u=Zu,zu=Oi()(["\n    background-color: ",";\n    color: ",";\n\n    .chatNavBar__navButton {\n        .icon {\n            fill: ",";\n        }\n\n        &:focus,\n        &:hover {\n            background-color: ",";\n        }\n    }\n\n    + .chatMessagesView {\n        border-top: ",";\n    }\n"],["\n    background-color: ",";\n    color: ",";\n\n    .chatNavBar__navButton {\n        .icon {\n            fill: ",";\n        }\n\n        &:focus,\n        &:hover {\n            background-color: ",";\n        }\n    }\n\n    + .chatMessagesView {\n        border-top: ",";\n    }\n"]),Xu=Oi()(["\n    background-color: ",";\n    border: ",";\n"],["\n    background-color: ",";\n    border: ",";\n"]),Ju=Oi()(["\n    border-top: ",";\n    color: ",";\n\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n\n    svg {\n        fill: ",";\n    }\n"],["\n    border-top: ",";\n    color: ",";\n\n    &:focus,\n    &:hover {\n        background-color: ",";\n    }\n\n    svg {\n        fill: ",";\n    }\n"]),el=Oi()(["\n    color: ",";\n"],["\n    color: ",";\n"]),tl=Rs.default.nav(zu,(function(e){return e.theme.colors.background}),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.onBackground}),(function(e){return e.theme.colors.gray5}),(function(e){return"1px solid "+e.theme.colors.borderColor})),nl=Rs.default.div(Xu,(function(e){return e.theme.colors.white}),(function(e){return"1px solid "+e.theme.colors.borderColor})),ol=Rs.default.button(Ju,(function(e){return"1px solid "+e.theme.colors.borderColor}),(function(e){return e.theme.colors.onBackground}),(function(e){return e.theme.colors.gray5}),(function(e){return e.theme.colors.primary})),il=Rs.default.span(el,(function(e){return e.theme.colors.gray85})),al=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.onDockButtonClicked=n.onDockButtonClicked.bind(n),n.renderLeftContent=n.renderLeftContent.bind(n),n.renderRightContent=n.renderRightContent.bind(n),n.renderCenterContent=n.renderCenterContent.bind(n),n.renderExpandedMenu=n.renderExpandedMenu.bind(n),n}return bi()(t,e),v()(t,[{key:"onDockButtonClicked",value:function(){this.props.setIsDocked(!0)}},{key:"renderLeftContent",value:function(){return s.a.createElement("div",{className:"chatNavBar_left"},s.a.createElement(Yu,{classNames:bs()("chatNavBar__navButton",{alwaysShowMinimize:this.props.displaySettings.AlwaysShowMinimize||this.props.displaySettings.FrameStyle===qe||this.props.displaySettings.FrameDraggable}),regionCode:this.props.regionCode,iconName:"minimize"}))}},{key:"renderCenterContent",value:function(){var e=this.props.isDraggable?$u:"div",t=this.props.isDraggable?{isDocked:this.props.isDocked,setIsDocked:this.props.setIsDocked,regionCode:this.props.regionCode,displaySettings:this.props.displaySettings}:{};return s.a.createElement(e,N()({className:"chatNavBar_center"},t),s.a.createElement("span",{className:"chatNavBar__logo","aria-hidden":"true"}))}},{key:"renderRightContent",value:function(){var e=this,t=s.a.createElement("button",{className:bs()("chatNavBar__navButton","chatNavBar__navButton_redock"),title:Wa.CHAT_NAV_BAR.DOCK,"aria-label":Wa.CHAT_NAV_BAR.DOCK,value:Wa.CHAT_NAV_BAR.DOCK,onClick:this.onDockButtonClicked},s.a.createElement(Gs,{iconName:this.props.displaySettings.Align===dt.LEFT?"dockLeft":"dockRight"})),n=s.a.createElement("div",{"aria-controls":"chat-nav-bar-nav-menu","aria-expanded":this.props.navMenuOpen,className:bs()("chatNavBar__menu",{chatNavBar__menu_opened:this.props.navMenuOpen}),onBlur:function(t){t.currentTarget.contains(t.relatedTarget)||e.props.setNavMenuOpen(!1)}},s.a.createElement("button",{className:"chatNavBar__navButton chatNavBar__navButton_menu",onClick:function(){e.props.setNavMenuOpen(!e.props.navMenuOpen)},title:Ka(Wa.CHAT_NAV_BAR.MENU_BUTTON,this.props.regionCode)},s.a.createElement(Gs,{iconName:"more"})),this.props.navMenuOpen&&this.renderExpandedMenu());return s.a.createElement("div",{className:"chatNavBar_right"},this.props.isLiveChat&&n,this.props.displaySettings.FrameDraggable&&!this.props.isDocked&&t)}},{key:"renderExpandedMenu",value:function(){var e=this,t=this.props.soundEnabled?Wa.CHAT_NAV_BAR.SOUND_OFF:Wa.CHAT_NAV_BAR.SOUND_ON,n=this.props.soundEnabled?Cr.ICON_NAMES.SOUND_OFF_FILL:Cr.ICON_NAMES.SOUND_ON_FILL,o={className:"chatNavBar__menuItem",role:"menuitem"};return s.a.createElement(nl,{"aria-expanded":this.props.navMenuOpen,className:"chatNavBar__menuList",id:"chat-nav-bar-nav-menu",role:"menu","aria-label":Ka(Wa.CHAT_NAV_BAR.MENU,this.props.regionCode)},s.a.createElement(ol,N()({id:"end-chat",onClick:this.props.endLiveChat},o),s.a.createElement(vr.a,Nc(Cr.ICON_NAMES.NAV_EXIT_FILL)),s.a.createElement(il,{className:"chatNavBar__menuItem_text"},Ka(Wa.END_BUTTON_TEXT,this.props.regionCode))),this.props.sound&&s.a.createElement(ol,N()({id:"toggle-sound",onClick:function(){return e.props.setSoundEnabled(!e.props.soundEnabled)}},o),s.a.createElement(vr.a,Nc(n)),s.a.createElement(il,{className:"chatNavBar__menuItem_text"},Ka(t,this.props.regionCode))))}},{key:"render",value:function(){return s.a.createElement(tl,{id:"chat-nav-bar",className:bs()("chatNavBar",{chatNavBar_draggable:this.props.isDraggable,chatNavBar_sideDocked:this.props.isDocked&&this.props.displaySettings.FrameStyle===qe}),role:"navigation","aria-label":Ka(Wa.CHAT_NAV_BAR.REGION_TITLE,this.props.regionCode),tabIndex:"-1"},this.renderLeftContent(),this.renderCenterContent(),this.renderRightContent())}}]),t}(s.a.Component);al.propTypes={displaySettings:ki.a.object,endLiveChat:ki.a.func.isRequired,isLiveChat:ki.a.bool.isRequired,navMenuOpen:ki.a.bool,regionCode:ki.a.string.isRequired,setNavMenuOpen:ki.a.func.isRequired,setSoundEnabled:ki.a.func,sound:ki.a.bool,soundEnabled:ki.a.bool,isDocked:ki.a.bool,isDraggable:ki.a.bool,setIsDocked:ki.a.func},al.defaultProps={displaySettings:{}};var sl,rl=Object(d.connect)((function(e){var t=e.chat,n=e.chatNavBar,o=e.partnerConfig;return{displaySettings:o.displaySettings,navMenuOpen:n.navMenuOpen,sound:o.sound,soundEnabled:n.soundEnabled,isDocked:t.isDocked,isDraggable:t.isDraggable,isLiveChat:t.isLiveChat,regionCode:o.regionCode}}),(function(e){return{endLiveChat:function(){e((function(e){e(Wu(!1)),e(ds()),e(Vi({label:he.CONVERSATION_END,type:pe.SELECT})),Oc.endChat()}))},setNavMenuOpen:function(t){e(Wu(t))},setSoundEnabled:function(t){e(function(e){return{type:"SET_SOUND_ENABLED",soundEnabled:e}}(t))},setIsDocked:function(t){e(ma(t))}}}))(al),cl=Oi()(["\n    background-color: ",";\n    color: ","};\n\n    svg {\n        fill: ",";\n    }\n"],["\n    background-color: ",";\n    color: ","};\n\n    svg {\n        fill: ",";\n    }\n"]),ul=Rs.default.div(cl,(function(e){var t=e.theme.colors;return e.bannerType===jn?t.warning:t.error}),(function(e){var t=e.theme.colors;return e.bannerType===jn?t.onBackground:t.white}),(function(e){return e.theme.colors.onBackground})),ll=[Wn,qn,xn,Kn],dl=[xn,Vn,Fn],hl=_()({},jn,Cr.ICON_NAMES.NOTIFICATION_ALERT),pl=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.onClick=n.onClick.bind(n),n.handleEphemeralBanner=n.handleEphemeralBanner.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){ll.indexOf(this.props.chatBanner)>=0&&this.handleEphemeralBanner()}},{key:"onClick",value:function(){switch(this.props.chatBanner){case xn:case Vn:this.props.setChatBanner(null);break;case Fn:this.props.isConnected||(this.props.setShowLoadingView(!0),this.props.getCustomerAuth())}}},{key:"handleEphemeralBanner",value:function(){var e=this;setTimeout((function(){e.$chatBanner&&e.$chatBanner.classList.add("chatBanner_hidden"),setTimeout((function(){e.props.setChatBanner(null)}),De)}),Ve)}},{key:"render",value:function(){var e=this,t=Wa.CHAT_BANNER[this.props.chatBanner],n=hl[this.props.chatBanner],o=dl.indexOf(this.props.chatBanner)>=0;return s.a.createElement(ul,{className:bs()("chatBanner",{chatBanner_clickable:o}),bannerType:this.props.chatBanner,onClick:o?this.onClick:null,role:"status",ref:function(t){return e.$chatBanner=t}},n&&s.a.createElement(vr.a,Nc(n)),s.a.createElement("span",{className:"chatBanner__text"},Ka(t,this.props.regionCode)))}}]),t}(s.a.Component),El=Object(d.connect)((function(e){var t=e.chat,n=e.connection;return{regionCode:e.partnerConfig.regionCode,chatBanner:t.chatBanner,isConnected:n.isConnected}}),(function(e){return{setChatBanner:function(t){e(Ea(t))},getCustomerAuth:function(){e({type:"GET_CUSTOMER_AUTH"})},setShowLoadingView:function(t){e(ha(t))}}}))(pl);pl.propTypes={chatBanner:ki.a.string.isRequired,regionCode:ki.a.string.isRequired,isConnected:ki.a.bool,setChatBanner:ki.a.func,setShowLoadingView:ki.a.func,getCustomerAuth:ki.a.func};var ml=(sl={},_()(sl,no,"pending"),_()(sl,oo,"active"),_()(sl,so,"declined"),_()(sl,ro,"ended"),_()(sl,co,"ended"),_()(sl,uo,"disabled"),_()(sl,ao,"error"),sl),gl=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.state={sessionDuration:0,isLoading:!1},n.renderButtons=n.renderButtons.bind(n),n.acceptCobrowsingInvitation=n.acceptCobrowsingInvitation.bind(n),n.handleEphemeralBanner=n.handleEphemeralBanner.bind(n),n.handleClick=n.handleClick.bind(n),n.handleError=n.handleError.bind(n),n.setSessionDurationTimer=n.setSessionDurationTimer.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){if(this.props.cobrowsingState===oo){var e=function(e,t){if(!e)return null;t=t?t.toLowerCase():"seconds";var n=Date.now();switch(t){case"seconds":return Math.ceil((n-e)/1e3);case"minutes":return Math.ceil((n-e)/6e4);case"hours":return Math.ceil((n-e)/36e5);case"days":return Math.ceil((n-e)/864e5);default:return Math.ceil((n-e)/1e3)}}(this.props.cobrowsingTimestamp,"seconds");this.setState({sessionDuration:e}),this.setSessionDurationTimer()}else uc.on(B,this.acceptCobrowsingInvitation),uc.post(x);this.handleEphemeralBanner()}},{key:"componentWillUnmount",value:function(){uc.off(B,this.acceptCobrowsingInvitation),clearInterval(this.interval)}},{key:"componentDidUpdate",value:function(e){e.cobrowsingState!==this.props.cobrowsingState&&(clearTimeout(this.ephemeralAnimation),An("CobrowsingBanner.js: state change",e.cobrowsingState," -> ",this.props.cobrowsingState),this.props.cobrowsingState===oo&&(this.setSessionDurationTimer(),uc.post(X,{timestamp:Date.now()})),e.cobrowsingState===oo&&(clearInterval(this.interval),this.setState({sessionDuration:0}),uc.post(X,{timestamp:null})),this.handleEphemeralBanner()),e.isLiveChat&&!this.props.isLiveChat&&(this.props.setCobrowsingState(io),this.props.setCobrowsingUserId(null))}},{key:"acceptCobrowsingInvitation",value:function(e){var t=this;Oc.sendRequest({onComplete:function(n,o){t.setState({isLoading:!1}),o?t.handleError(o):(t.props.setCobrowsingState(oo),t.props.setCobrowsingUserId(e))},path:yn.COBROWSING_ACCEPT,params:{UserId:e}})}},{key:"handleEphemeralBanner",value:function(){var e=this;this.props.cobrowsingState!==oo&&this.props.cobrowsingState!==no&&(this.ephemeralAnimation=setTimeout((function(){e.banner&&e.banner.classList.add("cobrowsingBanner_hidden"),setTimeout((function(){e.props.setCobrowsingState(io)}),De)}),Ve))}},{key:"handleClick",value:function(e){var t=this,n=e.currentTarget.innerHTML;n===Se?Oc.sendRequest({onComplete:function(){t.props.setCobrowsingState(so)},path:yn.COBROWSING_DECLINE}):n===fe?Oc.sendRequest({onComplete:function(){t.props.setCobrowsingUserId(null)},params:{UserId:this.props.cobrowsingUserId},path:yn.COBROWSING_END}):(this.setState({isLoading:!0}),uc.post(j,n))}},{key:"handleError",value:function(e){An("CobrowsingBanner.js: Failed to start cobrowsing session.",e),this.props.setCobrowsingState(ao)}},{key:"setSessionDurationTimer",value:function(){var e=this;this.interval=setInterval((function(){e.setState((function(e){return{sessionDuration:e.sessionDuration+1}}))}),1e3)}},{key:"renderButtons",value:function(){return this.props.cobrowsingState===no?s.a.createElement("div",{className:"cobrowsingBanner__buttonContainer"},s.a.createElement("button",{onClick:this.handleClick,className:"cobrowsingBanner__button cobrowsingBanner__button_accept"},this.state.isLoading?s.a.createElement(vr.a,Nc(Cr.ICON_NAMES.LOADING)):ge),s.a.createElement("button",{onClick:this.handleClick,className:"cobrowsingBanner__button cobrowsingBanner__button_decline"},Se)):this.props.cobrowsingState===oo?s.a.createElement("div",{className:"cobrowsingBanner__buttonContainer"},s.a.createElement("button",{onClick:this.handleClick,className:"cobrowsingBanner__button cobrowsingBanner__button_end"},this.state.isLoading?s.a.createElement(vr.a,Nc(Cr.ICON_NAMES.LOADING)):fe)):void 0}},{key:"renderSessionDuration",value:function(){var e=Math.floor(this.state.sessionDuration/60),t=this.state.sessionDuration-60*e,n=function(e){return("0"+e).slice(-2)};return" "+n(e)+":"+n(t)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:bs()("cobrowsingBanner","cobrowsingBanner_"+ml[this.props.cobrowsingState]),ref:function(t){return e.banner=t},role:"status"},s.a.createElement("div",{className:"cobrowsingBanner__text"},Ka(Wa.COBROWSING_BANNER[this.props.cobrowsingState],this.props.regionCode),this.props.cobrowsingState===oo&&this.renderSessionDuration()),this.renderButtons())}}]),t}(s.a.Component),Sl=Object(d.connect)((function(e){var t=e.chat,n=e.cobrowsing,o=e.partnerConfig;return{cobrowsingState:n.cobrowsingState,cobrowsingTimestamp:n.cobrowsingTimestamp,cobrowsingUserId:n.cobrowsingUserId,isLiveChat:t.isLiveChat,regionCode:o.regionCode}}),(function(e){return{setCobrowsingState:function(t){e(Ia(t))},setCobrowsingUserId:function(t){e(Na(t))}}}))(gl);gl.propTypes={cobrowsingState:ki.a.string,regionCode:ki.a.string,setCobrowsingState:ki.a.func,setCobrowsingUserId:ki.a.func,isLiveChat:ki.a.bool,cobrowsingTimestamp:ki.a.number,cobrowsingUserId:ki.a.string};var fl=Oi()(["\n    background-color: ",";\n    box-shadow: ",";\n"],["\n    background-color: ",";\n    box-shadow: ",";\n"]),Cl=Oi()(["\n    background-color: ",";\n"],["\n    background-color: ",";\n"]),vl=Oi()(["\n    color: ",";\n"],["\n    color: ",";\n"]),Tl=Rs.default.div(fl,(function(e){return e.theme.colors.white}),(function(e){return"0 4px 8px "+e.theme.colors.borderColor})),_l=Rs.default.div(Cl,(function(e){return e.theme.colors.gray12})),Il=Rs.default.div(Cl,(function(e){return e.theme.colors.primary})),Nl=Rs.default.div(vl,(function(e){return e.theme.colors.gray85})),Al=Rs.default.div(vl,(function(e){return e.theme.colors.onBackground})),yl=Rs.default.button((function(e){var t=e.theme.colors;return Lr({text:t.onBackground,hoverBackground:t.gray12})})),bl=function(e){function t(e){f()(this,t);var n=Ai()(this,(t.__proto__||Ii()(t)).call(this,e));return n.getQueuePosNumber=n.getQueuePosNumber.bind(n),n.getPrimaryText=n.getPrimaryText.bind(n),n.renderProgressBar=n.renderProgressBar.bind(n),n.getSecondaryText=n.getSecondaryText.bind(n),n.handleLeaveButtonClick=n.handleLeaveButtonClick.bind(n),n}return bi()(t,e),v()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.recordCount({label:he.EWT,type:pe.DISPLAY}),setTimeout((function(){e.ewtSheet&&e.ewtSheet.classList.remove("ewtSheet_hidden")}),we)}},{key:"handleLeaveButtonClick",value:function(){this.props.setActionSheetType(Xn),this.props.recordCount({label:he.EWT_LEAVE,type:pe.SELECT})}},{key:"getQueuePosNumber",value:function(){var e,t,n,o=this.props.ewtSheetData[Bo]+1;return n=(e=o)%100,1==(t=e%10)&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"}},{key:"renderProgressBar",value:function(){var e=(this.props.ewtSheetData[Bo]+1)/(this.props.ewtSheetData[Uo]+1),t=Math.round(Math.max(0,Math.min(95,95*e)));return s.a.createElement(_l,{role:"progressbar","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"95","aria-describedby":"ewt-sheet-primary-text"},s.a.createElement(Il,{className:"ewtSheet__progressBar__line",style:{width:t+"%"}}))}},{key:"getSecondaryText",value:function(e,t){return t===Wo?"Estimated wait time":e===Fo?"Your position in line":"You're "+this.getQueuePosNumber()+" in line"}},{key:"getPrimaryText",value:function(e){var t,n,o,i,a,s,r=this.props.ewtSheetData[wo],c=this.props.ewtSheetData[Do],u=void 0;switch(e){case Vo:u="Less than "+Ec(c)+" wait";break;case qo:t=r,n=c,o=Math.floor(t/60),i=t%60,a=Math.floor(n/60),s=n%60,u=(o||a?i||s?Ec(t)+"–"+Ec(n):o+"–"+a+" hr":i+"–"+s+" min")+" wait";break;case Go:u="~"+Ec(c)+" wait";break;case xo:u="Over "+Ec(r)+" wait";break;case Fo:u=this.getQueuePosNumber()}return u}},{key:"render",value:function(){var e=this,t=this.props.ewtSheetData[Lo],n=this.props.ewtSheetData[ko];return t===Wo&&n===Fo?(this.props.hideEWTSheet(),null):s.a.createElement(Tl,{ref:function(t){return e.ewtSheet=t},className:"ewtSheet ewtSheet_hidden",id:"ewt-sheet"},this.renderProgressBar(),s.a.createElement("div",{className:"ewtSheet__content"},s.a.createElement("div",{className:"ewtSheet__textContainer",role:"status","aria-atomic":!0,"aria-live":"polite"},s.a.createElement(Nl,{className:"ewtSheet__secondaryText"},this.getSecondaryText(n,t)),s.a.createElement(Al,{className:"ewtSheet__primaryText",id:"ewt-sheet-primary-text"},this.getPrimaryText(n,t))),s.a.createElement("div",{className:"ewtSheet__buttonContainer"},s.a.createElement(yl,{className:"ewtSheet__button",onClick:this.handleLeaveButtonClick,type:"textPrimary"},Ka(Wa.EWT_SHEET.BUTTON_TEXT,this.props.regionCode)))))}}]),t}(s.a.Component),Rl=Object(d.connect)((function(e){var t=e.partnerConfig;return{ewtSheetData:e.ewtSheet.ewtSheetData,regionCode:t.regionCode}}),(function(e){return{hideEWTSheet:function(){e(aa())},setActionSheetType:function(t){e(Pi(t))},recordCount:function(t){e(Vi(t))}}}))(bl);bl.defaultProps={ewtSheetData:{}},bl.propTypes={regionCode:ki.a.string,ewtSheetData:ki.a.object,setActionSheetType:ki.a.func,hideEWTSheet:ki.a.func,recordCount:ki.a.func};var Ol=Oi()(["\n    background-color: ",";\n"],["\n    background-color: ",";\n"]),Ml=Oi()(["\n    background-color: ",";\n    color: ",";\n"],["\n    background-color: ",";\n    color: ",";\n"]),kl=Rs.default.div(Ol,(function(e){return e.theme.colors.background})),wl=Rs.default.div(Ml,(function(e){return e.theme.colors.error}),(function(e){return e.theme.colors.white})),Dl=function(e){function t(e){return f()(this,t),Ai()(this,(t.__proto__||Ii()(t)).call(this,e))}return bi()(t,e),v()(t,[{key:"componentDidUpdate",value:function(){}