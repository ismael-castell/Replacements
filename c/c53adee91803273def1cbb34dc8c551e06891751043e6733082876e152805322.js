(function(){var __webpack_modules__=({"./src/Renderer.js":
/*!*************************!*\
  !*** ./src/Renderer.js ***!
  \*************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"Renderer":function(){return Renderer;},"executeRenderer":function(){return executeRenderer;},"isRendererRequired":function(){return isRendererRequired;}});var _adloader_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./adloader.js */
"./src/adloader.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var moduleCode='outstream';function Renderer(options){var _this=this;var url=options.url,config=options.config,id=options.id,callback=options.callback,loaded=options.loaded,adUnitCode=options.adUnitCode;this.url=url;this.config=config;this.handlers={};this.id=id;this.loaded=loaded;this.cmd=[];this.push=function(func){if(typeof func!=='function'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Commands given to Renderer.push must be wrapped in a function');return;}
_this.loaded?func.call():_this.cmd.push(func);};this.callback=callback||function(){_this.loaded=true;_this.process();};this.render=function(){var _this2=this;var renderArgs=arguments;var runRender=function runRender(){if(_this2._render){_this2._render.apply(_this2,renderArgs);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("No render function was provided, please use .setRender on the renderer");}};if(!isRendererPreferredFromAdUnit(adUnitCode)){this.cmd.unshift(runRender);(0,_adloader_js__WEBPACK_IMPORTED_MODULE_1__.loadExternalScript)(url,moduleCode,this.callback,this.documentContext);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("External Js not loaded by Renderer since renderer url and callback is already defined on adUnit ".concat(adUnitCode));runRender();}}.bind(this);}
Renderer.install=function(_ref){var url=_ref.url,config=_ref.config,id=_ref.id,callback=_ref.callback,loaded=_ref.loaded,adUnitCode=_ref.adUnitCode;return new Renderer({url:url,config:config,id:id,callback:callback,loaded:loaded,adUnitCode:adUnitCode});};Renderer.prototype.getConfig=function(){return this.config;};Renderer.prototype.setRender=function(fn){this._render=fn;};Renderer.prototype.setEventHandlers=function(handlers){this.handlers=handlers;};Renderer.prototype.handleVideoEvent=function(_ref2){var id=_ref2.id,eventName=_ref2.eventName;if(typeof this.handlers[eventName]==='function'){this.handlers[eventName]();}
(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logMessage)("Prebid Renderer event for id ".concat(id," type ").concat(eventName));};Renderer.prototype.process=function(){while(this.cmd.length>0){try{this.cmd.shift().call();}catch(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Error processing Renderer command: ',error);}}};function isRendererRequired(renderer){return!!(renderer&&renderer.url);}
function executeRenderer(renderer,bid,doc){var docContext=null;if(renderer.config&&renderer.config.documentResolver){docContext=renderer.config.documentResolver(bid,document,doc);}
if(!docContext){docContext=document;}
renderer.documentContext=docContext;renderer.render(bid,renderer.documentContext);}
function isRendererPreferredFromAdUnit(adUnitCode){var adUnits=pbjs.adUnits;var adUnit=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(adUnits,function(adUnit){return adUnit.code===adUnitCode;});if(!adUnit){return false;}
var adUnitRenderer=(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(adUnit,'renderer');var hasValidAdUnitRenderer=!!(adUnitRenderer&&adUnitRenderer.url&&adUnitRenderer.render);var mediaTypeRenderer=(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(adUnit,'mediaTypes.video.renderer');var hasValidMediaTypeRenderer=!!(mediaTypeRenderer&&mediaTypeRenderer.url&&mediaTypeRenderer.render);return!!(hasValidAdUnitRenderer&&!(adUnitRenderer.backupOnly===true)||hasValidMediaTypeRenderer&&!(mediaTypeRenderer.backupOnly===true));}}),"./src/adRendering.js":
/*!****************************!*\
  !*** ./src/adRendering.js ***!
  \****************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"emitAdRenderFail":function(){return emitAdRenderFail;},"emitAdRenderSucceeded":function(){return emitAdRenderSucceeded;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _events_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./events.js */
"./src/events.js");var _constants_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");var _CONSTANTS$EVENTS=_constants_json__WEBPACK_IMPORTED_MODULE_0__.EVENTS,AD_RENDER_FAILED=_CONSTANTS$EVENTS.AD_RENDER_FAILED,AD_RENDER_SUCCEEDED=_CONSTANTS$EVENTS.AD_RENDER_SUCCEEDED;function emitAdRenderFail(_ref){var reason=_ref.reason,message=_ref.message,bid=_ref.bid,id=_ref.id;var data={reason:reason,message:message};if(bid)data.bid=bid;if(id)data.adId=id;(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(message);_events_js__WEBPACK_IMPORTED_MODULE_2__.emit(AD_RENDER_FAILED,data);}
function emitAdRenderSucceeded(_ref2){var doc=_ref2.doc,bid=_ref2.bid,id=_ref2.id;var data={doc:doc};if(bid)data.bid=bid;if(id)data.adId=id;_events_js__WEBPACK_IMPORTED_MODULE_2__.emit(AD_RENDER_SUCCEEDED,data);}}),"./src/adUnits.js":
/*!************************!*\
  !*** ./src/adUnits.js ***!
  \************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"adunitCounter":function(){return adunitCounter;}});var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var adUnits={};function ensureAdUnit(adunit,bidderCode){var adUnit=adUnits[adunit]=adUnits[adunit]||{bidders:{}};if(bidderCode){return adUnit.bidders[bidderCode]=adUnit.bidders[bidderCode]||{};}
return adUnit;}
function incrementAdUnitCount(adunit,counter,bidderCode){var adUnit=ensureAdUnit(adunit,bidderCode);adUnit[counter]=(adUnit[counter]||0)+1;return adUnit[counter];}
function incrementRequestsCounter(adunit){return incrementAdUnitCount(adunit,'requestsCounter');}
function incrementBidderRequestsCounter(adunit,bidderCode){return incrementAdUnitCount(adunit,'requestsCounter',bidderCode);}
function incrementBidderWinsCounter(adunit,bidderCode){return incrementAdUnitCount(adunit,'winsCounter',bidderCode);}
function getRequestsCounter(adunit){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(adUnits,"".concat(adunit,".requestsCounter"))||0;}
function getBidderRequestsCounter(adunit,bidder){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(adUnits,"".concat(adunit,".bidders.").concat(bidder,".requestsCounter"))||0;}
function getBidderWinsCounter(adunit,bidder){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(adUnits,"".concat(adunit,".bidders.").concat(bidder,".winsCounter"))||0;}
var adunitCounter={incrementRequestsCounter:incrementRequestsCounter,incrementBidderRequestsCounter:incrementBidderRequestsCounter,incrementBidderWinsCounter:incrementBidderWinsCounter,getRequestsCounter:getRequestsCounter,getBidderRequestsCounter:getBidderRequestsCounter,getBidderWinsCounter:getBidderWinsCounter};}),"./src/adapter.js":
/*!************************!*\
  !*** ./src/adapter.js ***!
  \************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"default":function(){return Adapter;}});function Adapter(code){var bidderCode=code;function setBidderCode(code){bidderCode=code;}
function getBidderCode(){return bidderCode;}
function callBids(){}
return{callBids:callBids,setBidderCode:setBidderCode,getBidderCode:getBidderCode};}}),"./src/adapterManager.js":
/*!*******************************!*\
  !*** ./src/adapterManager.js ***!
  \*******************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{"PARTITIONS":function(){return PARTITIONS;},"_filterBidsForAdUnit":function(){return _filterBidsForAdUnit;},"_partitionBidders":function(){return _partitionBidders;},"coppaDataHandler":function(){return coppaDataHandler;},"filterBidsForAdUnit":function(){return filterBidsForAdUnit;},"gdprDataHandler":function(){return gdprDataHandler;},"getS2SBidderSet":function(){return getS2SBidderSet;},"partitionBidders":function(){return partitionBidders;},"setupAdUnitMediaTypes":function(){return setupAdUnitMediaTypes;},"uspDataHandler":function(){return uspDataHandler;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _sizeMapping_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./sizeMapping.js */
"./src/sizeMapping.js");var _native_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ./native.js */
"./src/native.js");var _adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(
/*! ./adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _ajax_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(
/*! ./ajax.js */
"./src/ajax.js");var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _hook_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _adUnits_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./adUnits.js */
"./src/adUnits.js");var _refererDetection_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ./refererDetection.js */
"./src/refererDetection.js");var _consentHandler_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./consentHandler.js */
"./src/consentHandler.js");var _events_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./events.js */
"./src/events.js");var _constants_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var PARTITIONS={CLIENT:'client',SERVER:'server'};var adapterManager={};var _bidderRegistry=adapterManager.bidderRegistry={};var _aliasRegistry=adapterManager.aliasRegistry={};var _s2sConfigs=[];_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('s2sConfig',function(config){if(config&&config.s2sConfig){_s2sConfigs=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(config.s2sConfig)?config.s2sConfig:[config.s2sConfig];}});var _analyticsRegistry={};function getBids(_ref){var bidderCode=_ref.bidderCode,auctionId=_ref.auctionId,bidderRequestId=_ref.bidderRequestId,adUnits=_ref.adUnits,src=_ref.src;return adUnits.reduce(function(result,adUnit){result.push(adUnit.bids.filter(function(bid){return bid.bidder===bidderCode;}).reduce(function(bids,bid){bid=_extends({},bid,(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getDefinedParams)(adUnit,['nativeParams','ortb2Imp','mediaType','renderer','storedAuctionResponse']));var mediaTypes=bid.mediaTypes==null?adUnit.mediaTypes:bid.mediaTypes;if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isValidMediaTypes)(mediaTypes)){bid=_extends({},bid,{mediaTypes:mediaTypes});}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("mediaTypes is not correctly configured for adunit ".concat(adUnit.code));}
bids.push(_extends({},bid,{adUnitCode:adUnit.code,transactionId:adUnit.transactionId,sizes:(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(mediaTypes,'banner.sizes')||(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(mediaTypes,'video.playerSize')||[],bidId:bid.bid_id||(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUniqueIdentifierStr)(),bidderRequestId:bidderRequestId,auctionId:auctionId,src:src,bidRequestsCount:_adUnits_js__WEBPACK_IMPORTED_MODULE_3__.adunitCounter.getRequestsCounter(adUnit.code),bidderRequestsCount:_adUnits_js__WEBPACK_IMPORTED_MODULE_3__.adunitCounter.getBidderRequestsCounter(adUnit.code,bid.bidder),bidderWinsCount:_adUnits_js__WEBPACK_IMPORTED_MODULE_3__.adunitCounter.getBidderWinsCounter(adUnit.code,bid.bidder)}));return bids;},[]));return result;},[]).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_1__.flatten,[]).filter(function(val){return val!=='';});}
var hookedGetBids=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',getBids,'getBids');function _filterBidsForAdUnit(bids,s2sConfig){var _ref2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref2$getS2SBidders=_ref2.getS2SBidders,getS2SBidders=_ref2$getS2SBidders===void 0?getS2SBidderSet:_ref2$getS2SBidders;if(s2sConfig==null){return bids;}else{var serverBidders=getS2SBidders(s2sConfig);return bids.filter(function(bid){return serverBidders.has(bid.bidder);});}}
var filterBidsForAdUnit=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',_filterBidsForAdUnit,'filterBidsForAdUnit');function getAdUnitCopyForPrebidServer(adUnits,s2sConfig){var adUnitsCopy=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(adUnits);adUnitsCopy.forEach(function(adUnit){adUnit.bids=filterBidsForAdUnit(adUnit.bids,s2sConfig).map(function(bid){bid.bid_id=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUniqueIdentifierStr)();return bid;});});adUnitsCopy=adUnitsCopy.filter(function(adUnit){return adUnit.bids.length!==0;});return adUnitsCopy;}
function getAdUnitCopyForClientAdapters(adUnits){var adUnitsClientCopy=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(adUnits);adUnitsClientCopy.forEach(function(adUnit){adUnit.bids=filterBidsForAdUnit(adUnit.bids,null);});adUnitsClientCopy=adUnitsClientCopy.filter(function(adUnit){return adUnit.bids.length!==0;});return adUnitsClientCopy;}
var gdprDataHandler=new _consentHandler_js__WEBPACK_IMPORTED_MODULE_5__.GdprConsentHandler();var uspDataHandler=new _consentHandler_js__WEBPACK_IMPORTED_MODULE_5__.UspConsentHandler();var coppaDataHandler={getCoppa:function getCoppa(){return!!_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('coppa');}};var setupAdUnitMediaTypes=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',function(adUnits,labels){return(0,_sizeMapping_js__WEBPACK_IMPORTED_MODULE_6__.processAdUnitsForLabels)(adUnits,labels);},'setupAdUnitMediaTypes');function getS2SBidderSet(s2sConfigs){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(s2sConfigs))s2sConfigs=[s2sConfigs];var serverBidders=new Set([null]);s2sConfigs.filter(function(s2s){return s2s&&s2s.enabled;}).flatMap(function(s2s){return s2s.bidders;}).forEach(function(bidder){return serverBidders.add(bidder);});return serverBidders;}
function _partitionBidders(adUnits,s2sConfigs){var _getBidderCodes$reduc;var _ref3=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref3$getS2SBidders=_ref3.getS2SBidders,getS2SBidders=_ref3$getS2SBidders===void 0?getS2SBidderSet:_ref3$getS2SBidders;var serverBidders=getS2SBidders(s2sConfigs);return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidderCodes)(adUnits).reduce(function(memo,bidder){var partition=serverBidders.has(bidder)?PARTITIONS.SERVER:PARTITIONS.CLIENT;memo[partition].push(bidder);return memo;},(_getBidderCodes$reduc={},_defineProperty(_getBidderCodes$reduc,PARTITIONS.CLIENT,[]),_defineProperty(_getBidderCodes$reduc,PARTITIONS.SERVER,[]),_getBidderCodes$reduc));}
var partitionBidders=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',_partitionBidders,'partitionBidders');adapterManager.makeBidRequests=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',function(adUnits,auctionStart,auctionId,cbTimeout,labels){_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_8__.EVENTS.BEFORE_REQUEST_BIDS,adUnits);(0,_native_js__WEBPACK_IMPORTED_MODULE_9__.decorateAdUnitsWithNativeParams)(adUnits);adUnits=setupAdUnitMediaTypes(adUnits,labels);var _partitionBidders2=partitionBidders(adUnits,_s2sConfigs),clientBidders=_partitionBidders2[PARTITIONS.CLIENT],serverBidders=_partitionBidders2[PARTITIONS.SERVER];if(_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('bidderSequence')===_config_js__WEBPACK_IMPORTED_MODULE_0__.RANDOM){clientBidders=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.shuffle)(clientBidders);}
var refererInfo=(0,_refererDetection_js__WEBPACK_IMPORTED_MODULE_10__.getRefererInfo)();var bidRequests=[];_s2sConfigs.forEach(function(s2sConfig){if(s2sConfig&&s2sConfig.enabled){var adUnitsS2SCopy=getAdUnitCopyForPrebidServer(adUnits,s2sConfig);var uniquePbsTid=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.generateUUID)();serverBidders.forEach(function(bidderCode){var bidderRequestId=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUniqueIdentifierStr)();var bidderRequest={bidderCode:bidderCode,auctionId:auctionId,bidderRequestId:bidderRequestId,uniquePbsTid:uniquePbsTid,bids:hookedGetBids({bidderCode:bidderCode,auctionId:auctionId,bidderRequestId:bidderRequestId,'adUnits':(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(adUnitsS2SCopy),src:_constants_json__WEBPACK_IMPORTED_MODULE_8__.S2S.SRC}),auctionStart:auctionStart,timeout:s2sConfig.timeout,src:_constants_json__WEBPACK_IMPORTED_MODULE_8__.S2S.SRC,refererInfo:refererInfo};if(bidderRequest.bids.length!==0){bidRequests.push(bidderRequest);}});adUnitsS2SCopy.forEach(function(adUnitCopy){var validBids=adUnitCopy.bids.filter(function(adUnitBid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.find)(bidRequests,function(request){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.find)(request.bids,function(reqBid){return reqBid.bidId===adUnitBid.bid_id;});});});adUnitCopy.bids=validBids;});bidRequests.forEach(function(request){if(request.adUnitsS2SCopy===undefined){request.adUnitsS2SCopy=adUnitsS2SCopy.filter(function(adUnitCopy){return adUnitCopy.bids.length>0;});}});}});var adUnitsClientCopy=getAdUnitCopyForClientAdapters(adUnits);clientBidders.forEach(function(bidderCode){var bidderRequestId=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUniqueIdentifierStr)();var bidderRequest={bidderCode:bidderCode,auctionId:auctionId,bidderRequestId:bidderRequestId,bids:hookedGetBids({bidderCode:bidderCode,auctionId:auctionId,bidderRequestId:bidderRequestId,'adUnits':(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(adUnitsClientCopy),labels:labels,src:'client'}),auctionStart:auctionStart,timeout:cbTimeout,refererInfo:refererInfo};var adapter=_bidderRegistry[bidderCode];if(!adapter){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Trying to make a request for bidder that does not exist: ".concat(bidderCode));}
if(adapter&&bidderRequest.bids&&bidderRequest.bids.length!==0){bidRequests.push(bidderRequest);}});if(gdprDataHandler.getConsentData()){bidRequests.forEach(function(bidRequest){bidRequest['gdprConsent']=gdprDataHandler.getConsentData();});}
if(uspDataHandler.getConsentData()){bidRequests.forEach(function(bidRequest){bidRequest['uspConsent']=uspDataHandler.getConsentData();});}
return bidRequests;},'makeBidRequests');adapterManager.callBids=function(adUnits,bidRequests,addBidResponse,doneCb,requestCallbacks,requestBidsTimeout,onTimelyResponse){if(!bidRequests.length){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('callBids executed with no bidRequests.  Were they filtered by labels or sizing?');return;}
var _bidRequests$reduce=bidRequests.reduce(function(partitions,bidRequest){partitions[Number(typeof bidRequest.src!=='undefined'&&bidRequest.src===_constants_json__WEBPACK_IMPORTED_MODULE_8__.S2S.SRC)].push(bidRequest);return partitions;},[[],[]]),_bidRequests$reduce2=_slicedToArray(_bidRequests$reduce,2),clientBidRequests=_bidRequests$reduce2[0],serverBidRequests=_bidRequests$reduce2[1];var uniqueServerBidRequests=[];serverBidRequests.forEach(function(serverBidRequest){var index=-1;for(var i=0;i<uniqueServerBidRequests.length;++i){if(serverBidRequest.uniquePbsTid===uniqueServerBidRequests[i].uniquePbsTid){index=i;break;}}
if(index<=-1){uniqueServerBidRequests.push(serverBidRequest);}});var counter=0;var sourceTid=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.generateUUID)();_s2sConfigs.forEach(function(s2sConfig){if(s2sConfig&&uniqueServerBidRequests[counter]&&getS2SBidderSet(s2sConfig).has(uniqueServerBidRequests[counter].bidderCode)){var s2sAjax=(0,_ajax_js__WEBPACK_IMPORTED_MODULE_12__.ajaxBuilder)(requestBidsTimeout,requestCallbacks?{request:requestCallbacks.request.bind(null,'s2s'),done:requestCallbacks.done}:undefined);var adaptersServerSide=s2sConfig.bidders;var s2sAdapter=_bidderRegistry[s2sConfig.adapter];var uniquePbsTid=uniqueServerBidRequests[counter].uniquePbsTid;var adUnitsS2SCopy=uniqueServerBidRequests[counter].adUnitsS2SCopy;var uniqueServerRequests=serverBidRequests.filter(function(serverBidRequest){return serverBidRequest.uniquePbsTid===uniquePbsTid;});if(s2sAdapter){var s2sBidRequest={tid:sourceTid,'ad_units':adUnitsS2SCopy,s2sConfig:s2sConfig};if(s2sBidRequest.ad_units.length){var doneCbs=uniqueServerRequests.map(function(bidRequest){bidRequest.start=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.timestamp)();return doneCb.bind(bidRequest);});var bidders=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidderCodes)(s2sBidRequest.ad_units).filter(function(bidder){return adaptersServerSide.includes(bidder);});(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("CALLING S2S HEADER BIDDERS ==== ".concat(bidders.length>0?bidders.join(', '):'No bidder specified, using "ortb2Imp" definition(s) only'));uniqueServerRequests.forEach(function(bidRequest){_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_8__.EVENTS.BID_REQUESTED,_objectSpread(_objectSpread({},bidRequest),{},{tid:sourceTid}));});s2sAdapter.callBids(s2sBidRequest,serverBidRequests,addBidResponse,function(){return doneCbs.forEach(function(done){return done();});},s2sAjax);}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('missing '+s2sConfig.adapter);}
counter++;}});clientBidRequests.forEach(function(bidRequest){bidRequest.start=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.timestamp)();var adapter=_bidderRegistry[bidRequest.bidderCode];_config_js__WEBPACK_IMPORTED_MODULE_0__.config.runWithBidder(bidRequest.bidderCode,function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("CALLING BIDDER");_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_8__.EVENTS.BID_REQUESTED,bidRequest);});var ajax=(0,_ajax_js__WEBPACK_IMPORTED_MODULE_12__.ajaxBuilder)(requestBidsTimeout,requestCallbacks?{request:requestCallbacks.request.bind(null,bidRequest.bidderCode),done:requestCallbacks.done}:undefined);var adapterDone=doneCb.bind(bidRequest);try{_config_js__WEBPACK_IMPORTED_MODULE_0__.config.runWithBidder(bidRequest.bidderCode,_utils_js__WEBPACK_IMPORTED_MODULE_1__.bind.call(adapter.callBids,adapter,bidRequest,addBidResponse,adapterDone,ajax,onTimelyResponse,_config_js__WEBPACK_IMPORTED_MODULE_0__.config.callbackWithBidder(bidRequest.bidderCode)));}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("".concat(bidRequest.bidderCode," Bid Adapter emitted an uncaught error when parsing their bidRequest"),{e:e,bidRequest:bidRequest});adapterDone();}});};function getSupportedMediaTypes(bidderCode){var supportedMediaTypes=[];if((0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.includes)(adapterManager.videoAdapters,bidderCode))supportedMediaTypes.push('video');if((0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.includes)(_native_js__WEBPACK_IMPORTED_MODULE_9__.nativeAdapters,bidderCode))supportedMediaTypes.push('native');return supportedMediaTypes;}
adapterManager.videoAdapters=[];adapterManager.registerBidAdapter=function(bidAdapter,bidderCode){var _ref4=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref4$supportedMediaT=_ref4.supportedMediaTypes,supportedMediaTypes=_ref4$supportedMediaT===void 0?[]:_ref4$supportedMediaT;if(bidAdapter&&bidderCode){if(typeof bidAdapter.callBids==='function'){_bidderRegistry[bidderCode]=bidAdapter;if((0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.includes)(supportedMediaTypes,'video')){adapterManager.videoAdapters.push(bidderCode);}
if((0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.includes)(supportedMediaTypes,'native')){_native_js__WEBPACK_IMPORTED_MODULE_9__.nativeAdapters.push(bidderCode);}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Bidder adaptor error for bidder code: '+bidderCode+'bidder must implement a callBids() function');}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('bidAdapter or bidderCode not specified');}};adapterManager.aliasBidAdapter=function(bidderCode,alias,options){var existingAlias=_bidderRegistry[alias];if(typeof existingAlias==='undefined'){var bidAdapter=_bidderRegistry[bidderCode];if(typeof bidAdapter==='undefined'){var nonS2SAlias=[];_s2sConfigs.forEach(function(s2sConfig){if(s2sConfig.bidders&&s2sConfig.bidders.length){var s2sBidders=s2sConfig&&s2sConfig.bidders;if(!(s2sConfig&&(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_11__.includes)(s2sBidders,alias))){nonS2SAlias.push(bidderCode);}else{_aliasRegistry[alias]=bidderCode;}}});nonS2SAlias.forEach(function(bidderCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('bidderCode "'+bidderCode+'" is not an existing bidder.','adapterManager.aliasBidAdapter');});}else{try{var newAdapter;var supportedMediaTypes=getSupportedMediaTypes(bidderCode);if(bidAdapter.constructor.prototype!=Object.prototype){newAdapter=new bidAdapter.constructor();newAdapter.setBidderCode(alias);}else{var spec=bidAdapter.getSpec();var gvlid=options&&options.gvlid;var skipPbsAliasing=options&&options.skipPbsAliasing;newAdapter=(0,_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_13__.newBidder)(_extends({},spec,{code:alias,gvlid:gvlid,skipPbsAliasing:skipPbsAliasing}));_aliasRegistry[alias]=bidderCode;}
adapterManager.registerBidAdapter(newAdapter,alias,{supportedMediaTypes:supportedMediaTypes});}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(bidderCode+' bidder does not currently support aliasing.','adapterManager.aliasBidAdapter');}}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)('alias name "'+alias+'" has been already specified.');}};adapterManager.registerAnalyticsAdapter=function(_ref5){var adapter=_ref5.adapter,code=_ref5.code,gvlid=_ref5.gvlid;if(adapter&&code){if(typeof adapter.enableAnalytics==='function'){adapter.code=code;_analyticsRegistry[code]={adapter:adapter,gvlid:gvlid};}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Prebid Error: Analytics adaptor error for analytics \"".concat(code,"\"\n        analytics adapter must implement an enableAnalytics() function"));}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Prebid Error: analyticsAdapter or analyticsCode not specified');}};adapterManager.enableAnalytics=function(config){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(config)){config=[config];}
(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__._each)(config,function(adapterConfig){var entry=_analyticsRegistry[adapterConfig.provider];if(entry&&entry.adapter){entry.adapter.enableAnalytics(adapterConfig);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Prebid Error: no analytics adapter found in registry for '".concat(adapterConfig.provider,"'."));}});};adapterManager.getBidAdapter=function(bidder){return _bidderRegistry[bidder];};adapterManager.getAnalyticsAdapter=function(code){return _analyticsRegistry[code];};function tryCallBidderMethod(bidder,method,param){try{var adapter=_bidderRegistry[bidder];var spec=adapter.getSpec();if(spec&&spec[method]&&typeof spec[method]==='function'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Invoking ".concat(bidder,".").concat(method));_config_js__WEBPACK_IMPORTED_MODULE_0__.config.runWithBidder(bidder,_utils_js__WEBPACK_IMPORTED_MODULE_1__.bind.call(spec[method],spec,param));}}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Error calling ".concat(method," of ").concat(bidder));}}
adapterManager.callTimedOutBidders=function(adUnits,timedOutBidders,cbTimeout){timedOutBidders=timedOutBidders.map(function(timedOutBidder){timedOutBidder.params=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUserConfiguredParams)(adUnits,timedOutBidder.adUnitCode,timedOutBidder.bidder);timedOutBidder.timeout=cbTimeout;return timedOutBidder;});timedOutBidders=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.groupBy)(timedOutBidders,'bidder');Object.keys(timedOutBidders).forEach(function(bidder){tryCallBidderMethod(bidder,'onTimeout',timedOutBidders[bidder]);});};adapterManager.callBidWonBidder=function(bidder,bid,adUnits){bid.params=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getUserConfiguredParams)(adUnits,bid.adUnitCode,bid.bidder);_adUnits_js__WEBPACK_IMPORTED_MODULE_3__.adunitCounter.incrementBidderWinsCounter(bid.adUnitCode,bid.bidder);tryCallBidderMethod(bidder,'onBidWon',bid);};adapterManager.callSetTargetingBidder=function(bidder,bid){tryCallBidderMethod(bidder,'onSetTargeting',bid);};adapterManager.callBidViewableBidder=function(bidder,bid){tryCallBidderMethod(bidder,'onBidViewable',bid);};adapterManager.callBidderError=function(bidder,error,bidderRequest){var param={error:error,bidderRequest:bidderRequest};tryCallBidderMethod(bidder,'onBidderError',param);};__webpack_exports__["default"]=(adapterManager);}),"./src/adapters/bidderFactory.js":
/*!***************************************!*\
  !*** ./src/adapters/bidderFactory.js ***!
  \***************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getIabSubCategory":function(){return getIabSubCategory;},"newBidder":function(){return newBidder;},"registerBidder":function(){return registerBidder;}});var _adapter_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../adapter.js */
"./src/adapter.js");var _adapterManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../adapterManager.js */
"./src/adapterManager.js");var _config_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../config.js */
"./src/config.js");var _bidfactory_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../bidfactory.js */
"./src/bidfactory.js");var _userSync_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ../userSync.js */
"./src/userSync.js");var _native_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(
/*! ../native.js */
"./src/native.js");var _video_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(
/*! ../video.js */
"./src/video.js");var _constants_json__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../constants.json */
"./src/constants.json");var _events_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../events.js */
"./src/events.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(
/*! ../polyfill.js */
"./src/polyfill.js");var _ajax_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(
/*! ../ajax.js */
"./src/ajax.js");var _utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ../utils.js */
"./node_modules/dlv/index.js");var _mediaTypes_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(
/*! ../mediaTypes.js */
"./src/mediaTypes.js");var _hook_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ../hook.js */
"./src/hook.js");var _storageManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../storageManager.js */
"./src/storageManager.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(
/*! ../auctionManager.js */
"./src/auctionManager.js");var _bidderSettings_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ../bidderSettings.js */
"./src/bidderSettings.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var storage=(0,_storageManager_js__WEBPACK_IMPORTED_MODULE_0__.getCoreStorageManager)('bidderFactory');var COMMON_BID_RESPONSE_KEYS=['cpm','ttl','creativeId','netRevenue','currency'];var DEFAULT_REFRESHIN_DAYS=1;function registerBidder(spec){var mediaTypes=Array.isArray(spec.supportedMediaTypes)?{supportedMediaTypes:spec.supportedMediaTypes}:undefined;function putBidder(spec){var bidder=newBidder(spec);_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].registerBidAdapter(bidder,spec.code,mediaTypes);}
putBidder(spec);if(Array.isArray(spec.aliases)){spec.aliases.forEach(function(alias){var aliasCode=alias;var gvlid;var skipPbsAliasing;if((0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isPlainObject)(alias)){aliasCode=alias.code;gvlid=alias.gvlid;skipPbsAliasing=alias.skipPbsAliasing;}
_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].aliasRegistry[aliasCode]=spec.code;putBidder(_extends({},spec,{code:aliasCode,gvlid:gvlid,skipPbsAliasing:skipPbsAliasing}));});}}
function newBidder(spec){return _extends(new _adapter_js__WEBPACK_IMPORTED_MODULE_3__["default"](spec.code),{getSpec:function getSpec(){return Object.freeze(spec);},registerSyncs:registerSyncs,callBids:function callBids(bidderRequest,addBidResponse,done,ajax,onTimelyResponse,configEnabledCallback){if(!Array.isArray(bidderRequest.bids)){return;}
var adUnitCodesHandled={};function addBidWithCode(adUnitCode,bid){adUnitCodesHandled[adUnitCode]=true;if(isValid(adUnitCode,bid)){addBidResponse(adUnitCode,bid);}}
var responses=[];function afterAllResponses(){done();_config_js__WEBPACK_IMPORTED_MODULE_4__.config.runWithBidder(spec.code,function(){_events_js__WEBPACK_IMPORTED_MODULE_5__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_6__.EVENTS.BIDDER_DONE,bidderRequest);registerSyncs(responses,bidderRequest.gdprConsent,bidderRequest.uspConsent);});}
var validBidRequests=bidderRequest.bids.filter(filterAndWarn);if(validBidRequests.length===0){afterAllResponses();return;}
var bidRequestMap={};validBidRequests.forEach(function(bid){bidRequestMap[bid.bidId]=bid;if(!bid.adUnitCode){bid.adUnitCode=bid.placementCode;}});processBidderRequests(spec,validBidRequests,bidderRequest,ajax,configEnabledCallback,{onRequest:function onRequest(requestObject){return _events_js__WEBPACK_IMPORTED_MODULE_5__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_6__.EVENTS.BEFORE_BIDDER_HTTP,bidderRequest,requestObject);},onResponse:function onResponse(resp){onTimelyResponse(spec.code);responses.push(resp);},onError:function onError(errorMessage,error){onTimelyResponse(spec.code);_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].callBidderError(spec.code,error,bidderRequest);_events_js__WEBPACK_IMPORTED_MODULE_5__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_6__.EVENTS.BIDDER_ERROR,{error:error,bidderRequest:bidderRequest});(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Server call for ".concat(spec.code," failed: ").concat(errorMessage," ").concat(error.status,". Continuing without bids."));},onBid:function onBid(bid){var bidRequest=bidRequestMap[bid.requestId];if(bidRequest){bid.adapterCode=bidRequest.bidder;if(isInvalidAlternateBidder(bid.bidderCode,bidRequest.bidder)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("".concat(bid.bidderCode," is not a registered partner or known bidder of ").concat(bidRequest.bidder,", hence continuing without bid. If you wish to support this bidder, please mark allowAlternateBidderCodes as true in bidderSettings."));return;}
bid.originalCpm=bid.cpm;bid.originalCurrency=bid.currency;bid.meta=bid.meta||_extends({},bid[bidRequest.bidder]);var prebidBid=_extends((0,_bidfactory_js__WEBPACK_IMPORTED_MODULE_7__.createBid)(_constants_json__WEBPACK_IMPORTED_MODULE_6__.STATUS.GOOD,bidRequest),bid);addBidWithCode(bidRequest.adUnitCode,prebidBid);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("Bidder ".concat(spec.code," made bid for unknown request ID: ").concat(bid.requestId,". Ignoring."));}},onCompletion:afterAllResponses});}});function isInvalidAlternateBidder(responseBidder,requestBidder){var allowAlternateBidderCodes=_bidderSettings_js__WEBPACK_IMPORTED_MODULE_8__.bidderSettings.get(requestBidder,'allowAlternateBidderCodes');var alternateBiddersList=_bidderSettings_js__WEBPACK_IMPORTED_MODULE_8__.bidderSettings.get(requestBidder,'allowedAlternateBidderCodes');if(!!responseBidder&&!!requestBidder&&requestBidder!==responseBidder){if(allowAlternateBidderCodes!==undefined&&!allowAlternateBidderCodes||(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(alternateBiddersList)&&alternateBiddersList[0]!=='*'&&!alternateBiddersList.includes(responseBidder)){return true;}}
return false;}
function registerSyncs(responses,gdprConsent,uspConsent){registerSyncInner(spec,responses,gdprConsent,uspConsent);}
function filterAndWarn(bid){if(!spec.isBidRequestValid(bid)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("Invalid bid sent to bidder ".concat(spec.code,": ").concat(JSON.stringify(bid)));return false;}
return true;}}
var processBidderRequests=(0,_hook_js__WEBPACK_IMPORTED_MODULE_9__.hook)('sync',function(spec,bids,bidderRequest,ajax,wrapCallback,_ref){var onRequest=_ref.onRequest,onResponse=_ref.onResponse,onError=_ref.onError,onBid=_ref.onBid,onCompletion=_ref.onCompletion;var requests=spec.buildRequests(bids,bidderRequest);if(!requests||requests.length===0){onCompletion();return;}
if(!Array.isArray(requests)){requests=[requests];}
var requestDone=(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.delayExecution)(onCompletion,requests.length);requests.forEach(function(request){var onSuccess=wrapCallback(function(response,responseObj){try{response=JSON.parse(response);}catch(e){}
response={body:response,headers:headerParser(responseObj)};onResponse(response);var bids;try{bids=spec.interpretResponse(response,request);}catch(err){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Bidder ".concat(spec.code," failed to interpret the server's response. Continuing without bids"),null,err);requestDone();return;}
if(bids){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(bids)){bids.forEach(onBid);}else{onBid(bids);}}
requestDone();function headerParser(xmlHttpResponse){return{get:responseObj.getResponseHeader.bind(responseObj)};}});var onFailure=wrapCallback(function(errorMessage,error){onError(errorMessage,error);requestDone();});onRequest(request);switch(request.method){case'GET':ajax("".concat(request.url).concat(formatGetParameters(request.data)),{success:onSuccess,error:onFailure},undefined,_extends({method:'GET',withCredentials:true},request.options));break;case'POST':ajax(request.url,{success:onSuccess,error:onFailure},typeof request.data==='string'?request.data:JSON.stringify(request.data),_extends({method:'POST',contentType:'text/plain',withCredentials:true},request.options));break;default:(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("Skipping invalid request from ".concat(spec.code,". Request type ").concat(request.type," must be GET or POST"));requestDone();}
function formatGetParameters(data){if(data){return"?".concat(_typeof(data)==='object'?(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseQueryStringParameters)(data):data);}
return'';}});},'processBidderRequests');var registerSyncInner=(0,_hook_js__WEBPACK_IMPORTED_MODULE_9__.hook)('async',function(spec,responses,gdprConsent,uspConsent){var aliasSyncEnabled=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('userSync.aliasSyncEnabled');if(spec.getUserSyncs&&(aliasSyncEnabled||!_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].aliasRegistry[spec.code])){var filterConfig=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('userSync.filterSettings');var syncs=spec.getUserSyncs({iframeEnabled:!!(filterConfig&&(filterConfig.iframe||filterConfig.all)),pixelEnabled:!!(filterConfig&&(filterConfig.image||filterConfig.all))},responses,gdprConsent,uspConsent);if(syncs){if(!Array.isArray(syncs)){syncs=[syncs];}
syncs.forEach(function(sync){_userSync_js__WEBPACK_IMPORTED_MODULE_10__.userSync.registerSync(sync.type,spec.code,sync.url);});}}},'registerSyncs');function preloadBidderMappingFile(fn,adUnits){if(!_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('adpod.brandCategoryExclusion')){return fn.call(this,adUnits);}
var adPodBidders=adUnits.filter(function(adUnit){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_11__["default"])(adUnit,'mediaTypes.video.context')===_mediaTypes_js__WEBPACK_IMPORTED_MODULE_12__.ADPOD;}).map(function(adUnit){return adUnit.bids.map(function(bid){return bid.bidder;});}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]).filter(_utils_js__WEBPACK_IMPORTED_MODULE_2__.uniques);adPodBidders.forEach(function(bidder){var bidderSpec=_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].getBidAdapter(bidder);if(bidderSpec.getSpec().getMappingFileInfo){var info=bidderSpec.getSpec().getMappingFileInfo();var refreshInDays=info.refreshInDays?info.refreshInDays:DEFAULT_REFRESHIN_DAYS;var key=info.localStorageKey?info.localStorageKey:bidderSpec.getSpec().code;var mappingData=storage.getDataFromLocalStorage(key);try{mappingData=mappingData?JSON.parse(mappingData):undefined;if(!mappingData||(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.timestamp)()>mappingData.lastUpdated+refreshInDays*24*60*60*1000){(0,_ajax_js__WEBPACK_IMPORTED_MODULE_13__.ajax)(info.url,{success:function success(response){try{response=JSON.parse(response);var mapping={lastUpdated:(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.timestamp)(),mapping:response.mapping};storage.setDataInLocalStorage(key,JSON.stringify(mapping));}catch(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Failed to parse ".concat(bidder," bidder translation mapping file"));}},error:function error(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Failed to load ".concat(bidder," bidder translation file"));}});}}catch(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Failed to parse ".concat(bidder," bidder translation mapping file"));}}});fn.call(this,adUnits);}
(0,_hook_js__WEBPACK_IMPORTED_MODULE_9__.getHook)('checkAdUnitSetup').before(preloadBidderMappingFile);function getIabSubCategory(bidderCode,category){var bidderSpec=_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].getBidAdapter(bidderCode);if(bidderSpec.getSpec().getMappingFileInfo){var info=bidderSpec.getSpec().getMappingFileInfo();var key=info.localStorageKey?info.localStorageKey:bidderSpec.getBidderCode();var data=storage.getDataFromLocalStorage(key);if(data){try{data=JSON.parse(data);}catch(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)("Failed to parse ".concat(bidderCode," mapping data stored in local storage"));}
return data.mapping[category]?data.mapping[category]:null;}}}
function validBidSize(adUnitCode,bid){var _ref2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref2$index=_ref2.index,index=_ref2$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_14__.auctionManager.index:_ref2$index;if((bid.width||parseInt(bid.width,10)===0)&&(bid.height||parseInt(bid.height,10)===0)){bid.width=parseInt(bid.width,10);bid.height=parseInt(bid.height,10);return true;}
var bidRequest=index.getBidRequest(bid);var mediaTypes=index.getMediaTypes(bid);var sizes=bidRequest&&bidRequest.sizes||mediaTypes&&mediaTypes.banner&&mediaTypes.banner.sizes;var parsedSizes=(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseSizesInput)(sizes);if(parsedSizes.length===1){var _parsedSizes$0$split=parsedSizes[0].split('x'),_parsedSizes$0$split2=_slicedToArray(_parsedSizes$0$split,2),width=_parsedSizes$0$split2[0],height=_parsedSizes$0$split2[1];bid.width=parseInt(width,10);bid.height=parseInt(height,10);return true;}
return false;}
function isValid(adUnitCode,bid){var _ref3=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref3$index=_ref3.index,index=_ref3$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_14__.auctionManager.index:_ref3$index;function hasValidKeys(){var bidKeys=Object.keys(bid);return COMMON_BID_RESPONSE_KEYS.every(function(key){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_15__.includes)(bidKeys,key)&&!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_15__.includes)([undefined,null],bid[key]);});}
function errorMessage(msg){return"Invalid bid from ".concat(bid.bidderCode,". Ignoring bid: ").concat(msg);}
if(!adUnitCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)('No adUnitCode was supplied to addBidResponse.');return false;}
if(!bid){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("Some adapter tried to add an undefined bid for ".concat(adUnitCode,"."));return false;}
if(!hasValidKeys()){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)(errorMessage("Bidder ".concat(bid.bidderCode," is missing required params. Check http://prebid.org/dev-docs/bidder-adapter-1.html for list of params.")));return false;}
if(bid.mediaType==='native'&&!(0,_native_js__WEBPACK_IMPORTED_MODULE_16__.nativeBidIsValid)(bid,{index:index})){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)(errorMessage('Native bid missing some required properties.'));return false;}
if(bid.mediaType==='video'&&!(0,_video_js__WEBPACK_IMPORTED_MODULE_17__.isValidVideoBid)(bid,{index:index})){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)(errorMessage("Video bid does not have required vastUrl or renderer property"));return false;}
if(bid.mediaType==='banner'&&!validBidSize(adUnitCode,bid,{index:index})){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)(errorMessage("Banner bids require a width and height"));return false;}
return true;}}),"./src/adloader.js":
/*!*************************!*\
  !*** ./src/adloader.js ***!
  \*************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"loadExternalScript":function(){return loadExternalScript;}});var _polyfill_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _requestCache=new WeakMap();var _approvedLoadExternalJSList=['adloox','criteo','outstream','adagio','browsi','brandmetrics','justtag'];function loadExternalScript(url,moduleCode,callback,doc){if(!moduleCode||!url){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('cannot load external script without url and moduleCode');return;}
if(!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.includes)(_approvedLoadExternalJSList,moduleCode)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("".concat(moduleCode," not whitelisted for loading external JavaScript"));return;}
if(!doc){doc=document;}
var storedCachedObject=getCacheObject(doc,url);if(storedCachedObject){if(callback&&typeof callback==='function'){if(storedCachedObject.loaded){callback();}else{storedCachedObject.callbacks.push(callback);}}
return storedCachedObject.tag;}
var cachedDocObj=_requestCache.get(doc)||{};var cacheObject={loaded:false,tag:null,callbacks:[]};cachedDocObj[url]=cacheObject;_requestCache.set(doc,cachedDocObj);if(callback&&typeof callback==='function'){cacheObject.callbacks.push(callback);}
(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("module ".concat(moduleCode," is loading external JavaScript"));return requestResource(url,function(){cacheObject.loaded=true;try{for(var i=0;i<cacheObject.callbacks.length;i++){cacheObject.callbacks[i]();}}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Error executing callback','adloader.js:loadExternalScript',e);}},doc);function requestResource(tagSrc,callback,doc){if(!doc){doc=document;}
var jptScript=doc.createElement('script');jptScript.type='text/javascript';jptScript.async=true;var cacheObject=getCacheObject(doc,url);if(cacheObject){cacheObject.tag=jptScript;}
if(jptScript.readyState){jptScript.onreadystatechange=function(){if(jptScript.readyState==='loaded'||jptScript.readyState==='complete'){jptScript.onreadystatechange=null;callback();}};}else{jptScript.onload=function(){callback();};}
jptScript.src=tagSrc;(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.insertElement)(jptScript,doc);return jptScript;}
function getCacheObject(doc,url){var cachedDocObj=_requestCache.get(doc);if(cachedDocObj&&cachedDocObj[url]){return cachedDocObj[url];}
return null;}};}),"./src/ajax.js":
/*!*********************!*\
  !*** ./src/ajax.js ***!
  \*********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"ajax":function(){return ajax;},"ajaxBuilder":function(){return ajaxBuilder;}});var _config_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var XHR_DONE=4;var ajax_debug=false;window.set_ajax_debug=function(cb){ajax_debug=cb;};var ajax=ajaxBuilder();function ajaxBuilder(){var timeout=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3000;var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},request=_ref.request,done=_ref.done;return function(url,callback,data){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};try{var x;var method=options.method||(data?'POST':'GET');var parser=document.createElement('a');parser.href=url;if(ajax_debug){var debug_resp=ajax_debug(url,callback,data,options);if(debug_resp){return;}}
var callbacks=_typeof(callback)==='object'&&callback!==null?callback:{success:function success(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logMessage)('xhr success');},error:function error(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('xhr error',null,e);}};if(typeof callback==='function'){callbacks.success=callback;}
x=new window.XMLHttpRequest();x.onreadystatechange=function(){if(x.readyState===XHR_DONE){if(typeof done==='function'){done(parser.origin);}
var status=x.status;if(status>=200&&status<300||status===304){callbacks.success(x.responseText,x);}else{callbacks.error(x.statusText,x);}}};if(!_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('disableAjaxTimeout')){x.ontimeout=function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('  xhr timeout after ',x.timeout,'ms');};}
if(method==='GET'&&data){var urlInfo=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.parseUrl)(url,options);_extends(urlInfo.search,data);url=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.buildUrl)(urlInfo);}
x.open(method,url,true);if(!_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('disableAjaxTimeout')){x.timeout=timeout;}
if(options.withCredentials){x.withCredentials=true;}
(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(options.customHeaders,function(value,header){x.setRequestHeader(header,value);});if(options.preflight){x.setRequestHeader('X-Requested-With','XMLHttpRequest');}
x.setRequestHeader('Content-Type',options.contentType||'text/plain');if(typeof request==='function'){request(parser.origin);}
if(method==='POST'&&data){x.send(data);}else{x.send();}}catch(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('xhr construction',error);_typeof(callback)==='object'&&callback!==null&&callback.error(error);}};}}),"./src/auction.js":
/*!************************!*\
  !*** ./src/auction.js ***!
  \************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"AUCTION_COMPLETED":function(){return AUCTION_COMPLETED;},"addBidResponse":function(){return _addBidResponse;},"addBidderRequests":function(){return addBidderRequests;},"getStandardBidderSettings":function(){return getStandardBidderSettings;},"newAuction":function(){return newAuction;}});var _utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _cpmBucketManager_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(
/*! ./cpmBucketManager.js */
"./src/cpmBucketManager.js");var _native_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(
/*! ./native.js */
"./src/native.js");var _videoCache_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ./videoCache.js */
"./src/videoCache.js");var _Renderer_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(
/*! ./Renderer.js */
"./src/Renderer.js");var _config_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _userSync_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./userSync.js */
"./src/userSync.js");var _hook_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _video_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ./video.js */
"./src/video.js");var _mediaTypes_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(
/*! ./mediaTypes.js */
"./src/mediaTypes.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var _bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(
/*! ./bidderSettings.js */
"./src/bidderSettings.js");var _events_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./events.js */
"./src/events.js");var _adapterManager_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./adapterManager.js */
"./src/adapterManager.js");var _constants_json__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var syncUsers=_userSync_js__WEBPACK_IMPORTED_MODULE_0__.userSync.syncUsers;var AUCTION_STARTED='started';var AUCTION_IN_PROGRESS='inProgress';var AUCTION_COMPLETED='completed';_events_js__WEBPACK_IMPORTED_MODULE_1__.on(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.BID_ADJUSTMENT,function(bid){adjustBids(bid);});var MAX_REQUESTS_PER_ORIGIN=4;var outstandingRequests={};var sourceInfo={};var queuedCalls=[];function newAuction(_ref){var adUnits=_ref.adUnits,adUnitCodes=_ref.adUnitCodes,callback=_ref.callback,cbTimeout=_ref.cbTimeout,labels=_ref.labels,auctionId=_ref.auctionId;var _adUnits=adUnits;var _labels=labels;var _adUnitCodes=adUnitCodes;var _bidderRequests=[];var _bidsReceived=[];var _noBids=[];var _auctionStart;var _auctionEnd;var _auctionId=auctionId||(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.generateUUID)();var _auctionStatus;var _callback=callback;var _timer;var _timeout=cbTimeout;var _winningBids=[];var _timelyBidders=new Set();function addBidRequests(bidderRequests){_bidderRequests=_bidderRequests.concat(bidderRequests);}
function addBidReceived(bidsReceived){_bidsReceived=_bidsReceived.concat(bidsReceived);}
function addNoBid(noBid){_noBids=_noBids.concat(noBid);}
function getProperties(){return{auctionId:_auctionId,timestamp:_auctionStart,auctionEnd:_auctionEnd,auctionStatus:_auctionStatus,adUnits:_adUnits,adUnitCodes:_adUnitCodes,labels:_labels,bidderRequests:_bidderRequests,noBids:_noBids,bidsReceived:_bidsReceived,winningBids:_winningBids,timeout:_timeout};}
function startAuctionTimer(){var timedOut=true;var timeoutCallback=executeCallback.bind(null,timedOut);var timer=setTimeout(timeoutCallback,_timeout);_timer=timer;}
function executeCallback(timedOut,cleartimer){if(cleartimer){clearTimeout(_timer);}
if(_auctionEnd===undefined){var timedOutBidders=[];if(timedOut){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logMessage)("Auction ".concat(_auctionId," timedOut"));timedOutBidders=getTimedOutBids(_bidderRequests,_timelyBidders);if(timedOutBidders.length){_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.BID_TIMEOUT,timedOutBidders);}}
_auctionStatus=AUCTION_COMPLETED;_auctionEnd=Date.now();_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.AUCTION_END,getProperties());bidsBackCallback(_adUnits,function(){try{if(_callback!=null){var _adUnitCodes2=_adUnitCodes;var bids=_bidsReceived.filter(_utils_js__WEBPACK_IMPORTED_MODULE_3__.bind.call(_utils_js__WEBPACK_IMPORTED_MODULE_3__.adUnitsFilter,this,_adUnitCodes2)).reduce(groupByPlacement,{});_callback.apply(pbjs,[bids,timedOut,_auctionId]);_callback=null;}}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('Error executing bidsBackHandler',null,e);}finally{if(timedOutBidders.length){_adapterManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].callTimedOutBidders(adUnits,timedOutBidders,_timeout);}
var userSyncConfig=_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('userSync')||{};if(!userSyncConfig.enableOverride){syncUsers(userSyncConfig.syncDelay);}}});}}
function auctionDone(){_config_js__WEBPACK_IMPORTED_MODULE_5__.config.resetBidder();(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logInfo)("Bids Received for Auction with id: ".concat(_auctionId),_bidsReceived);_auctionStatus=AUCTION_COMPLETED;executeCallback(false,true);}
function onTimelyResponse(bidderCode){_timelyBidders.add(bidderCode);}
function callBids(){_auctionStatus=AUCTION_STARTED;_auctionStart=Date.now();var bidRequests=_adapterManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].makeBidRequests(_adUnits,_auctionStart,_auctionId,_timeout,_labels);(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logInfo)("Bids Requested for Auction with id: ".concat(_auctionId),bidRequests);if(bidRequests.length<1){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('No valid bid requests returned for auction');auctionDone();}else{addBidderRequests.call({dispatch:addBidderRequestsCallback,context:this},bidRequests);}}
function addBidderRequestsCallback(bidRequests){var _this=this;bidRequests.forEach(function(bidRequest){addBidRequests(bidRequest);});var requests={};var call={bidRequests:bidRequests,run:function run(){startAuctionTimer();_auctionStatus=AUCTION_IN_PROGRESS;_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.AUCTION_INIT,getProperties());var callbacks=auctionCallbacks(auctionDone,_this);_adapterManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].callBids(_adUnits,bidRequests,callbacks.addBidResponse,callbacks.adapterDone,{request:function request(source,origin){increment(outstandingRequests,origin);increment(requests,source);if(!sourceInfo[source]){sourceInfo[source]={SRA:true,origin:origin};}
if(requests[source]>1){sourceInfo[source].SRA=false;}},done:function done(origin){outstandingRequests[origin]--;if(queuedCalls[0]){if(runIfOriginHasCapacity(queuedCalls[0])){queuedCalls.shift();}}}},_timeout,onTimelyResponse);}};if(!runIfOriginHasCapacity(call)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('queueing auction due to limited endpoint capacity');queuedCalls.push(call);}
function runIfOriginHasCapacity(call){var hasCapacity=true;var maxRequests=_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('maxRequestsPerOrigin')||MAX_REQUESTS_PER_ORIGIN;call.bidRequests.some(function(bidRequest){var requests=1;var source=typeof bidRequest.src!=='undefined'&&bidRequest.src===_constants_json__WEBPACK_IMPORTED_MODULE_2__.S2S.SRC?'s2s':bidRequest.bidderCode;if(sourceInfo[source]){if(sourceInfo[source].SRA===false){requests=Math.min(bidRequest.bids.length,maxRequests);}
if(outstandingRequests[sourceInfo[source].origin]+requests>maxRequests){hasCapacity=false;}}
return!hasCapacity;});if(hasCapacity){call.run();}
return hasCapacity;}
function increment(obj,prop){if(typeof obj[prop]==='undefined'){obj[prop]=1;}else{obj[prop]++;}}}
function addWinningBid(winningBid){_winningBids=_winningBids.concat(winningBid);_adapterManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].callBidWonBidder(winningBid.bidder,winningBid,adUnits);}
function setBidTargeting(bid){_adapterManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].callSetTargetingBidder(bid.bidder,bid);}
return{addBidReceived:addBidReceived,addNoBid:addNoBid,executeCallback:executeCallback,callBids:callBids,addWinningBid:addWinningBid,setBidTargeting:setBidTargeting,getWinningBids:function getWinningBids(){return _winningBids;},getAuctionStart:function getAuctionStart(){return _auctionStart;},getTimeout:function getTimeout(){return _timeout;},getAuctionId:function getAuctionId(){return _auctionId;},getAuctionStatus:function getAuctionStatus(){return _auctionStatus;},getAdUnits:function getAdUnits(){return _adUnits;},getAdUnitCodes:function getAdUnitCodes(){return _adUnitCodes;},getBidRequests:function getBidRequests(){return _bidderRequests;},getBidsReceived:function getBidsReceived(){return _bidsReceived;},getNoBids:function getNoBids(){return _noBids;}};}
var _addBidResponse=(0,_hook_js__WEBPACK_IMPORTED_MODULE_6__.hook)('sync',function(adUnitCode,bid){this.dispatch.call(null,adUnitCode,bid);},'addBidResponse');var addBidderRequests=(0,_hook_js__WEBPACK_IMPORTED_MODULE_6__.hook)('sync',function(bidderRequests){this.dispatch.call(this.context,bidderRequests);},'addBidderRequests');var bidsBackCallback=(0,_hook_js__WEBPACK_IMPORTED_MODULE_6__.hook)('async',function(adUnits,callback){if(callback){callback();}},'bidsBackCallback');function auctionCallbacks(auctionDone,auctionInstance){var _ref2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref2$index=_ref2.index,index=_ref2$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_7__.auctionManager.index:_ref2$index;var outstandingBidsAdded=0;var allAdapterCalledDone=false;var bidderRequestsDone=new Set();var bidResponseMap={};var ready={};function waitFor(requestId,result){if(ready[requestId]==null){ready[requestId]=Promise.resolve();}
ready[requestId]=ready[requestId].then(function(){return Promise.resolve(result).catch(function(){});});}
function guard(bidderRequest,fn){var timeout=bidderRequest.timeout;if(timeout==null||timeout>auctionInstance.getTimeout()){timeout=auctionInstance.getTimeout();}
var timeRemaining=auctionInstance.getAuctionStart()+timeout-Date.now();var wait=ready[bidderRequest.bidderRequestId];var orphanWait=ready[''];if((wait!=null||orphanWait!=null)&&timeRemaining>0){Promise.race([new Promise(function(resolve){return setTimeout(resolve,timeRemaining);}),Promise.resolve(orphanWait).then(function(){return wait;})]).then(fn);}else{fn();}}
function afterBidAdded(){outstandingBidsAdded--;if(allAdapterCalledDone&&outstandingBidsAdded===0){auctionDone();}}
function handleBidResponse(adUnitCode,bid){bidResponseMap[bid.requestId]=true;outstandingBidsAdded++;var auctionId=auctionInstance.getAuctionId();var bidResponse=getPreparedBidForAuction({adUnitCode:adUnitCode,bid:bid,auctionId:auctionId});if(bidResponse.mediaType==='video'){tryAddVideoBid(auctionInstance,bidResponse,afterBidAdded);}else{addBidToAuction(auctionInstance,bidResponse);afterBidAdded();}}
function _adapterDone(){var bidderRequest=this;var bidderRequests=auctionInstance.getBidRequests();var auctionOptionsConfig=_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('auctionOptions');bidderRequestsDone.add(bidderRequest);if(auctionOptionsConfig&&!(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.isEmpty)(auctionOptionsConfig)){var secondaryBidders=auctionOptionsConfig.secondaryBidders;if(secondaryBidders&&!bidderRequests.every(function(bidder){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_8__.includes)(secondaryBidders,bidder.bidderCode);})){bidderRequests=bidderRequests.filter(function(request){return!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_8__.includes)(secondaryBidders,request.bidderCode);});}}
allAdapterCalledDone=bidderRequests.every(function(bidderRequest){return bidderRequestsDone.has(bidderRequest);});bidderRequest.bids.forEach(function(bid){if(!bidResponseMap[bid.bidId]){auctionInstance.addNoBid(bid);_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.NO_BID,bid);}});if(allAdapterCalledDone&&outstandingBidsAdded===0){auctionDone();}}
return{addBidResponse:function addBidResponse(adUnit,bid){var bidderRequest=index.getBidderRequest(bid);waitFor(bidderRequest&&bidderRequest.bidderRequestId||'',_addBidResponse.call({dispatch:handleBidResponse},adUnit,bid));},adapterDone:function adapterDone(){guard(this,_adapterDone.bind(this));}};}
function doCallbacksIfTimedout(auctionInstance,bidResponse){if(bidResponse.timeToRespond>auctionInstance.getTimeout()+_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('timeoutBuffer')){auctionInstance.executeCallback(true);}}
function addBidToAuction(auctionInstance,bidResponse){setupBidTargeting(bidResponse);_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.BID_RESPONSE,bidResponse);auctionInstance.addBidReceived(bidResponse);doCallbacksIfTimedout(auctionInstance,bidResponse);}
function tryAddVideoBid(auctionInstance,bidResponse,afterBidAdded){var _ref3=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},_ref3$index=_ref3.index,index=_ref3$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_7__.auctionManager.index:_ref3$index;var addBid=true;var videoMediaType=(0,_utils_js__WEBPACK_IMPORTED_MODULE_9__["default"])(index.getMediaTypes({requestId:bidResponse.originalRequestId||bidResponse.requestId,transactionId:bidResponse.transactionId}),'video');var context=videoMediaType&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_9__["default"])(videoMediaType,'context');if(_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('cache.url')&&context!==_video_js__WEBPACK_IMPORTED_MODULE_10__.OUTSTREAM){if(!bidResponse.videoCacheKey||_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('cache.ignoreBidderCacheKey')){addBid=false;callPrebidCache(auctionInstance,bidResponse,afterBidAdded,videoMediaType);}else if(!bidResponse.vastUrl){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('videoCacheKey specified but not required vastUrl for video bid');addBid=false;}}
if(addBid){addBidToAuction(auctionInstance,bidResponse);afterBidAdded();}}
var callPrebidCache=(0,_hook_js__WEBPACK_IMPORTED_MODULE_6__.hook)('async',function(auctionInstance,bidResponse,afterBidAdded,videoMediaType){(0,_videoCache_js__WEBPACK_IMPORTED_MODULE_11__.store)([bidResponse],function(error,cacheIds){if(error){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)("Failed to save to the video cache: ".concat(error,". Video bid must be discarded."));doCallbacksIfTimedout(auctionInstance,bidResponse);}else{if(cacheIds[0].uuid===''){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)("Supplied video cache key was already in use by Prebid Cache; caching attempt was rejected. Video bid must be discarded.");doCallbacksIfTimedout(auctionInstance,bidResponse);}else{bidResponse.videoCacheKey=cacheIds[0].uuid;if(!bidResponse.vastUrl){bidResponse.vastUrl=(0,_videoCache_js__WEBPACK_IMPORTED_MODULE_11__.getCacheUrl)(bidResponse.videoCacheKey);}
addBidToAuction(auctionInstance,bidResponse);afterBidAdded();}}});},'callPrebidCache');function getPreparedBidForAuction(_ref4){var adUnitCode=_ref4.adUnitCode,bid=_ref4.bid,auctionId=_ref4.auctionId;var _ref5=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref5$index=_ref5.index,index=_ref5$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_7__.auctionManager.index:_ref5$index;var bidderRequest=index.getBidderRequest(bid);var start=bidderRequest&&bidderRequest.start||bid.requestTimestamp;var bidObject=_extends({},bid,{auctionId:auctionId,responseTimestamp:(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.timestamp)(),requestTimestamp:start,cpm:parseFloat(bid.cpm)||0,bidder:bid.bidderCode,adUnitCode:adUnitCode});bidObject.timeToRespond=bidObject.responseTimestamp-bidObject.requestTimestamp;_events_js__WEBPACK_IMPORTED_MODULE_1__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.BID_ADJUSTMENT,bidObject);var adUnitRenderer=index.getAdUnit(bidObject).renderer;var bidObjectMediaType=bidObject.mediaType;var mediaTypes=index.getMediaTypes(bidObject);var bidMediaType=mediaTypes&&mediaTypes[bidObjectMediaType];var mediaTypeRenderer=bidMediaType&&bidMediaType.renderer;var renderer=null;if(mediaTypeRenderer&&mediaTypeRenderer.url&&mediaTypeRenderer.render&&!(mediaTypeRenderer.backupOnly===true&&bid.renderer)){renderer=mediaTypeRenderer;}else if(adUnitRenderer&&adUnitRenderer.url&&adUnitRenderer.render&&!(adUnitRenderer.backupOnly===true&&bid.renderer)){renderer=adUnitRenderer;}
if(renderer){bidObject.renderer=_Renderer_js__WEBPACK_IMPORTED_MODULE_12__.Renderer.install({url:renderer.url,config:renderer.options});bidObject.renderer.setRender(renderer.render);}
var mediaTypeGranularity=getMediaTypeGranularity(bid.mediaType,mediaTypes,_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('mediaTypePriceGranularity'));var priceStringsObj=(0,_cpmBucketManager_js__WEBPACK_IMPORTED_MODULE_13__.getPriceBucketString)(bidObject.cpm,_typeof(mediaTypeGranularity)==='object'?mediaTypeGranularity:_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('customPriceBucket'),_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('currency.granularityMultiplier'));bidObject.pbLg=priceStringsObj.low;bidObject.pbMg=priceStringsObj.med;bidObject.pbHg=priceStringsObj.high;bidObject.pbAg=priceStringsObj.auto;bidObject.pbDg=priceStringsObj.dense;bidObject.pbCg=priceStringsObj.custom;return bidObject;}
function setupBidTargeting(bidObject){var keyValues;var cpmCheck=_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.get(bidObject.bidderCode,'allowZeroCpmBids')===true?bidObject.cpm>=0:bidObject.cpm>0;if(bidObject.bidderCode&&(cpmCheck||bidObject.dealId)){keyValues=getKeyValueTargetingPairs(bidObject.bidderCode,bidObject);}
bidObject.adserverTargeting=_extends(bidObject.adserverTargeting||{},keyValues);}
function getMediaTypeGranularity(mediaType,mediaTypes,mediaTypePriceGranularity){if(mediaType&&mediaTypePriceGranularity){if(mediaType===_mediaTypes_js__WEBPACK_IMPORTED_MODULE_15__.VIDEO){var context=(0,_utils_js__WEBPACK_IMPORTED_MODULE_9__["default"])(mediaTypes,"".concat(_mediaTypes_js__WEBPACK_IMPORTED_MODULE_15__.VIDEO,".context"),'instream');if(mediaTypePriceGranularity["".concat(_mediaTypes_js__WEBPACK_IMPORTED_MODULE_15__.VIDEO,"-").concat(context)]){return mediaTypePriceGranularity["".concat(_mediaTypes_js__WEBPACK_IMPORTED_MODULE_15__.VIDEO,"-").concat(context)];}}
return mediaTypePriceGranularity[mediaType];}}
var getPriceGranularity=function getPriceGranularity(bid){var _ref6=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref6$index=_ref6.index,index=_ref6$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_7__.auctionManager.index:_ref6$index;var mediaTypeGranularity=getMediaTypeGranularity(bid.mediaType,index.getMediaTypes(bid),_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('mediaTypePriceGranularity'));var granularity=typeof bid.mediaType==='string'&&mediaTypeGranularity?typeof mediaTypeGranularity==='string'?mediaTypeGranularity:'custom':_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('priceGranularity');return granularity;};var getPriceByGranularity=function getPriceByGranularity(granularity){return function(bid){var bidGranularity=granularity||getPriceGranularity(bid);if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.AUTO){return bid.pbAg;}else if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.DENSE){return bid.pbDg;}else if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.LOW){return bid.pbLg;}else if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.MEDIUM){return bid.pbMg;}else if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.HIGH){return bid.pbHg;}else if(bidGranularity===_constants_json__WEBPACK_IMPORTED_MODULE_2__.GRANULARITY_OPTIONS.CUSTOM){return bid.pbCg;}};};var getAdvertiserDomain=function getAdvertiserDomain(){return function(bid){return bid.meta&&bid.meta.advertiserDomains&&bid.meta.advertiserDomains.length>0?bid.meta.advertiserDomains[0]:'';};};function createKeyVal(key,value){return{key:key,val:typeof value==='function'?function(bidResponse,bidReq){return value(bidResponse,bidReq);}:function(bidResponse){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.getValue)(bidResponse,value);}};}
function defaultAdserverTargeting(){var TARGETING_KEYS=_constants_json__WEBPACK_IMPORTED_MODULE_2__.TARGETING_KEYS;return[createKeyVal(TARGETING_KEYS.BIDDER,'bidderCode'),createKeyVal(TARGETING_KEYS.AD_ID,'adId'),createKeyVal(TARGETING_KEYS.PRICE_BUCKET,getPriceByGranularity()),createKeyVal(TARGETING_KEYS.SIZE,'size'),createKeyVal(TARGETING_KEYS.DEAL,'dealId'),createKeyVal(TARGETING_KEYS.SOURCE,'source'),createKeyVal(TARGETING_KEYS.FORMAT,'mediaType'),createKeyVal(TARGETING_KEYS.ADOMAIN,getAdvertiserDomain())];}
function getStandardBidderSettings(mediaType,bidderCode){var TARGETING_KEYS=_constants_json__WEBPACK_IMPORTED_MODULE_2__.TARGETING_KEYS;var standardSettings=_extends({},_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.settingsFor(null));if(!standardSettings[_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING]){standardSettings[_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING]=defaultAdserverTargeting();}
if(mediaType==='video'){var adserverTargeting=standardSettings[_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING].slice();standardSettings[_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING]=adserverTargeting;[TARGETING_KEYS.UUID,TARGETING_KEYS.CACHE_ID].forEach(function(targetingKeyVal){if(typeof(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_8__.find)(adserverTargeting,function(kvPair){return kvPair.key===targetingKeyVal;})==='undefined'){adserverTargeting.push(createKeyVal(targetingKeyVal,'videoCacheKey'));}});if(_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('cache.url')&&(!bidderCode||_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.get(bidderCode,'sendStandardTargeting')!==false)){var urlInfo=(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseUrl)(_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('cache.url'));if(typeof(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_8__.find)(adserverTargeting,function(targetingKeyVal){return targetingKeyVal.key===TARGETING_KEYS.CACHE_HOST;})==='undefined'){adserverTargeting.push(createKeyVal(TARGETING_KEYS.CACHE_HOST,function(bidResponse){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_9__["default"])(bidResponse,"adserverTargeting.".concat(TARGETING_KEYS.CACHE_HOST))?bidResponse.adserverTargeting[TARGETING_KEYS.CACHE_HOST]:urlInfo.hostname;}));}}}
return standardSettings;}
function getKeyValueTargetingPairs(bidderCode,custBidObj){var _ref7=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref7$index=_ref7.index,index=_ref7$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_7__.auctionManager.index:_ref7$index;if(!custBidObj){return{};}
var bidRequest=index.getBidRequest(custBidObj);var keyValues={};var standardSettings=getStandardBidderSettings(custBidObj.mediaType,bidderCode);setKeys(keyValues,standardSettings,custBidObj,bidRequest);if(bidderCode&&_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.getOwn(bidderCode,_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING)){setKeys(keyValues,_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.ownSettingsFor(bidderCode),custBidObj,bidRequest);custBidObj.sendStandardTargeting=_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.get(bidderCode,'sendStandardTargeting');}
if(custBidObj['native']){keyValues=_extends({},keyValues,(0,_native_js__WEBPACK_IMPORTED_MODULE_16__.getNativeTargeting)(custBidObj));}
return keyValues;}
function setKeys(keyValues,bidderSettings,custBidObj,bidReq){var targeting=bidderSettings[_constants_json__WEBPACK_IMPORTED_MODULE_2__.JSON_MAPPING.ADSERVER_TARGETING];custBidObj.size=custBidObj.getSize();(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__._each)(targeting,function(kvPair){var key=kvPair.key;var value=kvPair.val;if(keyValues[key]){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('The key: '+key+' is being overwritten');}
if((0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.isFn)(value)){try{value=value(custBidObj,bidReq);}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('bidmanager','ERROR',e);}}
if((typeof bidderSettings.suppressEmptyKeys!=='undefined'&&bidderSettings.suppressEmptyKeys===true||key===_constants_json__WEBPACK_IMPORTED_MODULE_2__.TARGETING_KEYS.DEAL)&&((0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.isEmptyStr)(value)||value===null||value===undefined)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logInfo)("suppressing empty key '"+key+"' from adserver targeting");}else{keyValues[key]=value;}});return keyValues;}
function adjustBids(bid){var code=bid.bidderCode;var bidPriceAdjusted=bid.cpm;var bidCpmAdjustment=_bidderSettings_js__WEBPACK_IMPORTED_MODULE_14__.bidderSettings.get(code||null,'bidCpmAdjustment');if(bidCpmAdjustment&&typeof bidCpmAdjustment==='function'){try{bidPriceAdjusted=bidCpmAdjustment(bid.cpm,_extends({},bid));}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('Error during bid adjustment','bidmanager.js',e);}}
if(bidPriceAdjusted>=0){bid.cpm=bidPriceAdjusted;}}
function groupByPlacement(bidsByPlacement,bid){if(!bidsByPlacement[bid.adUnitCode]){bidsByPlacement[bid.adUnitCode]={bids:[]};}
bidsByPlacement[bid.adUnitCode].bids.push(bid);return bidsByPlacement;}
function getTimedOutBids(bidderRequests,timelyBidders){var timedOutBids=bidderRequests.map(function(bid){return(bid.bids||[]).filter(function(bid){return!timelyBidders.has(bid.bidder);});}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_3__.flatten,[]);return timedOutBids;}}),"./src/auctionIndex.js":
/*!*****************************!*\
  !*** ./src/auctionIndex.js ***!
  \*****************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"AuctionIndex":function(){return AuctionIndex;}});function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function AuctionIndex(getAuctions){_extends(this,{getAuction:function getAuction(_ref){var auctionId=_ref.auctionId;if(auctionId!=null){return getAuctions().find(function(auction){return auction.getAuctionId()===auctionId;});}},getAdUnit:function getAdUnit(_ref2){var transactionId=_ref2.transactionId;if(transactionId!=null){return getAuctions().flatMap(function(a){return a.getAdUnits();}).find(function(au){return au.transactionId===transactionId;});}},getMediaTypes:function getMediaTypes(_ref3){var transactionId=_ref3.transactionId,requestId=_ref3.requestId;if(requestId!=null){var req=this.getBidRequest({requestId:requestId});if(req!=null&&(transactionId==null||req.transactionId===transactionId)){return req.mediaTypes;}}else if(transactionId!=null){var au=this.getAdUnit({transactionId:transactionId});if(au!=null){return au.mediaTypes;}}},getBidderRequest:function getBidderRequest(_ref4){var requestId=_ref4.requestId,bidderRequestId=_ref4.bidderRequestId;if(requestId!=null||bidderRequestId!=null){var bers=getAuctions().flatMap(function(a){return a.getBidRequests();});if(bidderRequestId!=null){bers=bers.filter(function(ber){return ber.bidderRequestId===bidderRequestId;});}
if(requestId==null){return bers[0];}else{return bers.find(function(ber){return ber.bids&&ber.bids.find(function(br){return br.bidId===requestId;})!=null;});}}},getBidRequest:function getBidRequest(_ref5){var requestId=_ref5.requestId;if(requestId!=null){return getAuctions().flatMap(function(a){return a.getBidRequests();}).flatMap(function(ber){return ber.bids;}).find(function(br){return br&&br.bidId===requestId;});}}});}}),"./src/auctionManager.js":
/*!*******************************!*\
  !*** ./src/auctionManager.js ***!
  \*******************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"auctionManager":function(){return auctionManager;}});var _utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _auction_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./auction.js */
"./src/auction.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _auctionIndex_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./auctionIndex.js */
"./src/auctionIndex.js");var _constants_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function newAuctionManager(){var _auctions=[];var auctionManager={};auctionManager.addWinningBid=function(bid){var auction=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_0__.find)(_auctions,function(auction){return auction.getAuctionId()===bid.auctionId;});if(auction){bid.status=_constants_json__WEBPACK_IMPORTED_MODULE_1__.BID_STATUS.RENDERED;auction.addWinningBid(bid);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logWarn)("Auction not found when adding winning bid");}};auctionManager.getAllWinningBids=function(){return _auctions.map(function(auction){return auction.getWinningBids();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]);};auctionManager.getBidsRequested=function(){return _auctions.map(function(auction){return auction.getBidRequests();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]);};auctionManager.getNoBids=function(){return _auctions.map(function(auction){return auction.getNoBids();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]);};auctionManager.getBidsReceived=function(){return _auctions.map(function(auction){if(auction.getAuctionStatus()===_auction_js__WEBPACK_IMPORTED_MODULE_3__.AUCTION_COMPLETED){return auction.getBidsReceived();}}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]).filter(function(bid){return bid;});};auctionManager.getAllBidsForAdUnitCode=function(adUnitCode){return _auctions.map(function(auction){return auction.getBidsReceived();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]).filter(function(bid){return bid&&bid.adUnitCode===adUnitCode;});};auctionManager.getAdUnits=function(){return _auctions.map(function(auction){return auction.getAdUnits();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]);};auctionManager.getAdUnitCodes=function(){return _auctions.map(function(auction){return auction.getAdUnitCodes();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]).filter(_utils_js__WEBPACK_IMPORTED_MODULE_2__.uniques);};auctionManager.createAuction=function(_ref){var adUnits=_ref.adUnits,adUnitCodes=_ref.adUnitCodes,callback=_ref.callback,cbTimeout=_ref.cbTimeout,labels=_ref.labels,auctionId=_ref.auctionId;var auction=(0,_auction_js__WEBPACK_IMPORTED_MODULE_3__.newAuction)({adUnits:adUnits,adUnitCodes:adUnitCodes,callback:callback,cbTimeout:cbTimeout,labels:labels,auctionId:auctionId});_addAuction(auction);return auction;};auctionManager.findBidByAdId=function(adId){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_0__.find)(_auctions.map(function(auction){return auction.getBidsReceived();}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_2__.flatten,[]),function(bid){return bid.adId===adId;});};auctionManager.getStandardBidderAdServerTargeting=function(){return(0,_auction_js__WEBPACK_IMPORTED_MODULE_3__.getStandardBidderSettings)()[_constants_json__WEBPACK_IMPORTED_MODULE_1__.JSON_MAPPING.ADSERVER_TARGETING];};auctionManager.setStatusForBids=function(adId,status){var bid=auctionManager.findBidByAdId(adId);if(bid)bid.status=status;if(bid&&status===_constants_json__WEBPACK_IMPORTED_MODULE_1__.BID_STATUS.BID_TARGETING_SET){var auction=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_0__.find)(_auctions,function(auction){return auction.getAuctionId()===bid.auctionId;});if(auction)auction.setBidTargeting(bid);}};auctionManager.getLastAuctionId=function(){return _auctions.length&&_auctions[_auctions.length-1].getAuctionId();};auctionManager.clearAllAuctions=function(){_auctions.length=0;};function _addAuction(auction){_auctions.push(auction);}
auctionManager.index=new _auctionIndex_js__WEBPACK_IMPORTED_MODULE_4__.AuctionIndex(function(){return _auctions;});return auctionManager;}
var auctionManager=newAuctionManager();}),"./src/bidderSettings.js":
/*!*******************************!*\
  !*** ./src/bidderSettings.js ***!
  \*******************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"bidderSettings":function(){return bidderSettings;}});var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _prebidGlobal_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./prebidGlobal.js */
"./src/prebidGlobal.js");var _constants_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}
function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet);privateSet.add(obj);}
function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj)){throw new TypeError("Cannot initialize the same private elements twice on an object");}}
function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver)){throw new TypeError("attempted to get private field on non-instance");}return fn;}
var _resolveScope=new WeakSet();var ScopedSettings=function(){function ScopedSettings(getSettings,defaultScope){_classCallCheck(this,ScopedSettings);_classPrivateMethodInitSpec(this,_resolveScope);this.getSettings=getSettings;this.defaultScope=defaultScope;}
_createClass(ScopedSettings,[{key:"get",value:function get(scope,path){var value=this.getOwn(scope,path);if(typeof value==='undefined'){value=this.getOwn(null,path);}
return value;}},{key:"getOwn",value:function getOwn(scope,path){scope=_classPrivateMethodGet(this,_resolveScope,_resolveScope2).call(this,scope);return(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.getSettings(),"".concat(scope,".").concat(path));}},{key:"getScopes",value:function getScopes(){var _this=this;return Object.keys(this.getSettings()).filter(function(scope){return scope!==_this.defaultScope;});}},{key:"settingsFor",value:function settingsFor(scope){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.mergeDeep)({},this.ownSettingsFor(null),this.ownSettingsFor(scope));}},{key:"ownSettingsFor",value:function ownSettingsFor(scope){scope=_classPrivateMethodGet(this,_resolveScope,_resolveScope2).call(this,scope);return this.getSettings()[scope]||{};}}]);return ScopedSettings;}();function _resolveScope2(scope){if(scope==null){return this.defaultScope;}else{return scope;}}
var bidderSettings=new ScopedSettings(function(){return(0,_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_2__.getGlobal)().bidderSettings||{};},_constants_json__WEBPACK_IMPORTED_MODULE_3__.JSON_MAPPING.BD_SETTING_STANDARD);}),"./src/bidfactory.js":
/*!***************************!*\
  !*** ./src/bidfactory.js ***!
  \***************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{"createBid":function(){return createBid;}});var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");function Bid(statusCode){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$src=_ref.src,src=_ref$src===void 0?'client':_ref$src,_ref$bidder=_ref.bidder,bidder=_ref$bidder===void 0?'':_ref$bidder,bidId=_ref.bidId,transactionId=_ref.transactionId,auctionId=_ref.auctionId;var _bidSrc=src;var _statusCode=statusCode||0;this.bidderCode=bidder;this.width=0;this.height=0;this.statusMessage=_getStatus();this.adId=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.getUniqueIdentifierStr)();this.requestId=bidId;this.transactionId=transactionId;this.auctionId=auctionId;this.mediaType='banner';this.source=_bidSrc;function _getStatus(){switch(_statusCode){case 0:return'Pending';case 1:return'Bid available';case 2:return'Bid returned empty or error response';case 3:return'Bid timed out';}}
this.getStatusCode=function(){return _statusCode;};this.getSize=function(){return this.width+'x'+this.height;};this.getIdentifiers=function(){return{src:this.source,bidder:this.bidderCode,bidId:this.requestId,transactionId:this.transactionId,auctionId:this.auctionId};};}
function createBid(statusCode,identifiers){return new Bid(statusCode,identifiers);}}),"./src/config.js":
/*!***********************!*\
  !*** ./src/config.js ***!
  \***********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"RANDOM":function(){return RANDOM;},"config":function(){return config;}});var _cpmBucketManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./cpmBucketManager.js */
"./src/cpmBucketManager.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _constants_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");var _excluded=["fpd"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}
function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var DEFAULT_DEBUG=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.getParameterByName)(_constants_json__WEBPACK_IMPORTED_MODULE_1__.DEBUG_MODE).toUpperCase()==='TRUE';var DEFAULT_BIDDER_TIMEOUT=3000;var DEFAULT_PUBLISHER_DOMAIN=window.location.origin;var DEFAULT_ENABLE_SEND_ALL_BIDS=true;var DEFAULT_DISABLE_AJAX_TIMEOUT=false;var DEFAULT_BID_CACHE=false;var DEFAULT_DEVICE_ACCESS=true;var DEFAULT_MAX_NESTED_IFRAMES=10;var DEFAULT_TIMEOUTBUFFER=400;var RANDOM='random';var FIXED='fixed';var VALID_ORDERS={};VALID_ORDERS[RANDOM]=true;VALID_ORDERS[FIXED]=true;var DEFAULT_BIDDER_SEQUENCE=RANDOM;var GRANULARITY_OPTIONS={LOW:'low',MEDIUM:'medium',HIGH:'high',AUTO:'auto',DENSE:'dense',CUSTOM:'custom'};var ALL_TOPICS='*';function newConfig(){var listeners=[];var defaults;var config;var bidderConfig;var currBidder=null;function resetConfig(){defaults={};var newConfig={_debug:DEFAULT_DEBUG,get debug(){return this._debug;},set debug(val){this._debug=val;},_bidderTimeout:DEFAULT_BIDDER_TIMEOUT,get bidderTimeout(){return this._bidderTimeout;},set bidderTimeout(val){this._bidderTimeout=val;},_publisherDomain:DEFAULT_PUBLISHER_DOMAIN,get publisherDomain(){return this._publisherDomain;},set publisherDomain(val){this._publisherDomain=val;},_priceGranularity:GRANULARITY_OPTIONS.MEDIUM,set priceGranularity(val){if(validatePriceGranularity(val)){if(typeof val==='string'){this._priceGranularity=hasGranularity(val)?val:GRANULARITY_OPTIONS.MEDIUM;}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(val)){this._customPriceBucket=val;this._priceGranularity=GRANULARITY_OPTIONS.CUSTOM;(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logMessage)('Using custom price granularity');}}},get priceGranularity(){return this._priceGranularity;},_customPriceBucket:{},get customPriceBucket(){return this._customPriceBucket;},_mediaTypePriceGranularity:{},get mediaTypePriceGranularity(){return this._mediaTypePriceGranularity;},set mediaTypePriceGranularity(val){var _this=this;this._mediaTypePriceGranularity=Object.keys(val).reduce(function(aggregate,item){if(validatePriceGranularity(val[item])){if(typeof val==='string'){aggregate[item]=hasGranularity(val[item])?val[item]:_this._priceGranularity;}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(val)){aggregate[item]=val[item];(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logMessage)("Using custom price granularity for ".concat(item));}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Invalid price granularity for media type: ".concat(item));}
return aggregate;},{});},_sendAllBids:DEFAULT_ENABLE_SEND_ALL_BIDS,get enableSendAllBids(){return this._sendAllBids;},set enableSendAllBids(val){this._sendAllBids=val;},_useBidCache:DEFAULT_BID_CACHE,get useBidCache(){return this._useBidCache;},set useBidCache(val){this._useBidCache=val;},_deviceAccess:DEFAULT_DEVICE_ACCESS,get deviceAccess(){return this._deviceAccess;},set deviceAccess(val){this._deviceAccess=val;},_bidderSequence:DEFAULT_BIDDER_SEQUENCE,get bidderSequence(){return this._bidderSequence;},set bidderSequence(val){if(VALID_ORDERS[val]){this._bidderSequence=val;}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Invalid order: ".concat(val,". Bidder Sequence was not set."));}},_timeoutBuffer:DEFAULT_TIMEOUTBUFFER,get timeoutBuffer(){return this._timeoutBuffer;},set timeoutBuffer(val){this._timeoutBuffer=val;},_disableAjaxTimeout:DEFAULT_DISABLE_AJAX_TIMEOUT,get disableAjaxTimeout(){return this._disableAjaxTimeout;},set disableAjaxTimeout(val){this._disableAjaxTimeout=val;},_maxNestedIframes:DEFAULT_MAX_NESTED_IFRAMES,get maxNestedIframes(){return this._maxNestedIframes;},set maxNestedIframes(val){this._maxNestedIframes=val;},_auctionOptions:{},get auctionOptions(){return this._auctionOptions;},set auctionOptions(val){if(validateauctionOptions(val)){this._auctionOptions=val;}}};if(config){callSubscribers(Object.keys(config).reduce(function(memo,topic){if(config[topic]!==newConfig[topic]){memo[topic]=newConfig[topic]||{};}
return memo;},{}));}
config=newConfig;bidderConfig={};function hasGranularity(val){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(Object.keys(GRANULARITY_OPTIONS),function(option){return val===GRANULARITY_OPTIONS[option];});}
function validatePriceGranularity(val){if(!val){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Prebid Error: no value passed to `setPriceGranularity()`');return false;}
if(typeof val==='string'){if(!hasGranularity(val)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)('Prebid Warning: setPriceGranularity was called with invalid setting, using `medium` as default.');}}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(val)){if(!(0,_cpmBucketManager_js__WEBPACK_IMPORTED_MODULE_3__.isValidPriceConfig)(val)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Invalid custom price value passed to `setPriceGranularity()`');return false;}}
return true;}
function validateauctionOptions(val){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(val)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)('Auction Options must be an object');return false;}
for(var _i=0,_Object$keys=Object.keys(val);_i<_Object$keys.length;_i++){var k=_Object$keys[_i];if(k!=='secondaryBidders'&&k!=='suppressStaleRender'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Auction Options given an incorrect param: ".concat(k));return false;}
if(k==='secondaryBidders'){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(val[k])){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Auction Options ".concat(k," must be of type Array"));return false;}else if(!val[k].every(_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Auction Options ".concat(k," must be only string"));return false;}}else if(k==='suppressStaleRender'){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isBoolean)(val[k])){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Auction Options ".concat(k," must be of type boolean"));return false;}}}
return true;}}
function _getConfig(){if(currBidder&&bidderConfig&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(bidderConfig[currBidder])){var currBidderConfig=bidderConfig[currBidder];var configTopicSet=new Set(Object.keys(config).concat(Object.keys(currBidderConfig)));return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.arrayFrom)(configTopicSet).reduce(function(memo,topic){if(typeof currBidderConfig[topic]==='undefined'){memo[topic]=config[topic];}else if(typeof config[topic]==='undefined'){memo[topic]=currBidderConfig[topic];}else{if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(currBidderConfig[topic])){memo[topic]=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)({},config[topic],currBidderConfig[topic]);}else{memo[topic]=currBidderConfig[topic];}}
return memo;},{});}
return _extends({},config);}
function readConfig(){if(arguments.length<=1&&typeof(arguments.length<=0?undefined:arguments[0])!=='function'){var option=arguments.length<=0?undefined:arguments[0];var configClone=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.deepClone)(_getConfig());return option?(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(configClone,option):configClone;}
return subscribe.apply(void 0,arguments);}
function getConfig(){if(arguments.length<=1&&typeof(arguments.length<=0?undefined:arguments[0])!=='function'){var option=arguments.length<=0?undefined:arguments[0];return option?(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(_getConfig(),option):_getConfig();}
return subscribe.apply(void 0,arguments);}
function getBidderConfig(){return bidderConfig;}
function getLegacyFpd(obj){if(_typeof(obj)!=='object')return;var duplicate={};Object.keys(obj).forEach(function(type){var prop=type==='site'?'context':type;duplicate[prop]=prop==='context'||prop==='user'?Object.keys(obj[type]).filter(function(key){return key!=='data';}).reduce(function(result,key){if(key==='ext'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(result,obj[type][key]);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(result,_defineProperty({},key,obj[type][key]));}
return result;},{}):obj[type];});return duplicate;}
function getLegacyImpFpd(obj){if(_typeof(obj)!=='object')return;var duplicate={};if((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(obj,'ext.data')){Object.keys(obj.ext.data).forEach(function(key){if(key==='pbadslot'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{context:{pbAdSlot:obj.ext.data[key]}});}else if(key==='adserver'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{context:{adServer:obj.ext.data[key]}});}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{context:{data:_defineProperty({},key,obj.ext.data[key])}});}});}
return duplicate;}
function convertFpd(opt){var duplicate={};Object.keys(opt).forEach(function(type){var prop=type==='context'?'site':type;duplicate[prop]=prop==='site'||prop==='user'?Object.keys(opt[type]).reduce(function(result,key){if(key==='data'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(result,{ext:{data:opt[type][key]}});}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(result,_defineProperty({},key,opt[type][key]));}
return result;},{}):opt[type];});return duplicate;}
function convertImpFpd(opt){var duplicate={};Object.keys(opt).filter(function(prop){return prop==='context';}).forEach(function(type){Object.keys(opt[type]).forEach(function(key){if(key==='data'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{ext:{data:opt[type][key]}});}else{if(_typeof(opt[type][key])==='object'&&!Array.isArray(opt[type][key])){Object.keys(opt[type][key]).forEach(function(data){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{ext:{data:_defineProperty({},key.toLowerCase(),_defineProperty({},data.toLowerCase(),opt[type][key][data]))}});});}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(duplicate,{ext:{data:_defineProperty({},key.toLowerCase(),opt[type][key])}});}}});});return duplicate;}
function convertAdUnitFpd(arr){var convert=[];arr.forEach(function(adunit){if(adunit.fpd){adunit['ortb2Imp']?(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(adunit['ortb2Imp'],convertImpFpd(adunit.fpd)):adunit['ortb2Imp']=convertImpFpd(adunit.fpd);convert.push(function(_ref){var fpd=_ref.fpd,duplicate=_objectWithoutProperties(_ref,_excluded);return duplicate;}(adunit));}else{convert.push(adunit);}});return convert;}
function setConfig(options){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(options)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('setConfig options must be an object');return;}
var topics=Object.keys(options);var topicalConfig={};topics.forEach(function(topic){var prop=topic==='fpd'?'ortb2':topic;var option=topic==='fpd'?convertFpd(options[topic]):options[topic];if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(defaults[prop])&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(option)){option=_extends({},defaults[prop],option);}
topicalConfig[prop]=config[prop]=option;});callSubscribers(topicalConfig);}
function setDefaults(options){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(defaults)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('defaults must be an object');return;}
_extends(defaults,options);_extends(config,options);}
function subscribe(topic,listener){var callback=listener;if(typeof topic!=='string'){callback=topic;topic=ALL_TOPICS;}
if(typeof callback!=='function'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('listener must be a function');return;}
var nl={topic:topic,callback:callback};listeners.push(nl);return function unsubscribe(){listeners.splice(listeners.indexOf(nl),1);};}
function callSubscribers(options){var TOPICS=Object.keys(options);listeners.filter(function(listener){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(TOPICS,listener.topic);}).forEach(function(listener){listener.callback(_defineProperty({},listener.topic,options[listener.topic]));});listeners.filter(function(listener){return listener.topic===ALL_TOPICS;}).forEach(function(listener){return listener.callback(options);});}
function setBidderConfig(config){var mergeFlag=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;try{check(config);config.bidders.forEach(function(bidder){if(!bidderConfig[bidder]){bidderConfig[bidder]={};}
Object.keys(config.config).forEach(function(topic){var prop=topic==='fpd'?'ortb2':topic;var option=topic==='fpd'?convertFpd(config.config[topic]):config.config[topic];if((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(option)){var func=mergeFlag?_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep:Object.assign;bidderConfig[bidder][prop]=func({},bidderConfig[bidder][prop]||{},option);}else{bidderConfig[bidder][prop]=option;}});});}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(e);}
function check(obj){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(obj)){throw'setBidderConfig bidder options must be an object';}
if(!(Array.isArray(obj.bidders)&&obj.bidders.length)){throw'setBidderConfig bidder options must contain a bidders list with at least 1 bidder';}
if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(obj.config)){throw'setBidderConfig bidder options must contain a config object';}}}
function mergeConfig(obj){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(obj)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('mergeConfig input must be an object');return;}
var mergedConfig=Object.keys(obj).reduce(function(accum,key){var prevConf=_getConfig(key)[key]||{};accum[key]=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(prevConf,obj[key]);return accum;},{});setConfig(_objectSpread({},mergedConfig));return mergedConfig;}
function mergeBidderConfig(obj){return setBidderConfig(obj,true);}
function runWithBidder(bidder,fn){currBidder=bidder;try{return fn();}catch(e){console.error('prebid runWithBidder:',bidder,e);}finally{resetBidder();}}
function callbackWithBidder(bidder){return function(cb){return function(){if(typeof cb==='function'){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
return runWithBidder(bidder,_utils_js__WEBPACK_IMPORTED_MODULE_0__.bind.call.apply(_utils_js__WEBPACK_IMPORTED_MODULE_0__.bind,[cb,this].concat(args)));}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)('config.callbackWithBidder callback is not a function');}};};}
function getCurrentBidder(){return currBidder;}
function resetBidder(){currBidder=null;}
resetConfig();return{getCurrentBidder:getCurrentBidder,resetBidder:resetBidder,getConfig:getConfig,readConfig:readConfig,setConfig:setConfig,mergeConfig:mergeConfig,setDefaults:setDefaults,resetConfig:resetConfig,runWithBidder:runWithBidder,callbackWithBidder:callbackWithBidder,setBidderConfig:setBidderConfig,getBidderConfig:getBidderConfig,mergeBidderConfig:mergeBidderConfig,convertAdUnitFpd:convertAdUnitFpd,getLegacyFpd:getLegacyFpd,getLegacyImpFpd:getLegacyImpFpd};}
var config=newConfig();}),"./src/consentHandler.js":
/*!*******************************!*\
  !*** ./src/consentHandler.js ***!
  \*******************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"GdprConsentHandler":function(){return GdprConsentHandler;},"UspConsentHandler":function(){return UspConsentHandler;}});var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap);privateMap.set(obj,value);}
function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj)){throw new TypeError("Cannot initialize the same private elements twice on an object");}}
function _classPrivateFieldGet(receiver,privateMap){var descriptor=_classExtractFieldDescriptor(receiver,privateMap,"get");return _classApplyDescriptorGet(receiver,descriptor);}
function _classApplyDescriptorGet(receiver,descriptor){if(descriptor.get){return descriptor.get.call(receiver);}return descriptor.value;}
function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=_classExtractFieldDescriptor(receiver,privateMap,"set");_classApplyDescriptorSet(receiver,descriptor,value);return value;}
function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver)){throw new TypeError("attempted to "+action+" private field on non-instance");}return privateMap.get(receiver);}
function _classApplyDescriptorSet(receiver,descriptor,value){if(descriptor.set){descriptor.set.call(receiver,value);}else{if(!descriptor.writable){throw new TypeError("attempted to set read only private field");}descriptor.value=value;}}
var _enabled=new WeakMap();var _data=new WeakMap();var _promise=new WeakMap();var _resolve=new WeakMap();var _ready=new WeakMap();var ConsentHandler=function(){function ConsentHandler(){_classCallCheck(this,ConsentHandler);_classPrivateFieldInitSpec(this,_enabled,{writable:true,value:void 0});_classPrivateFieldInitSpec(this,_data,{writable:true,value:void 0});_classPrivateFieldInitSpec(this,_promise,{writable:true,value:void 0});_classPrivateFieldInitSpec(this,_resolve,{writable:true,value:void 0});_classPrivateFieldInitSpec(this,_ready,{writable:true,value:void 0});_defineProperty(this,"generatedTime",void 0);this.reset();}
_createClass(ConsentHandler,[{key:"reset",value:function reset(){var _this=this;_classPrivateFieldSet(this,_promise,new Promise(function(resolve){_classPrivateFieldSet(_this,_resolve,function(data){_classPrivateFieldSet(_this,_ready,true);_classPrivateFieldSet(_this,_data,data);resolve(data);});}));_classPrivateFieldSet(this,_enabled,false);_classPrivateFieldSet(this,_data,null);_classPrivateFieldSet(this,_ready,false);this.generatedTime=null;}},{key:"enable",value:function enable(){_classPrivateFieldSet(this,_enabled,true);}},{key:"enabled",get:function get(){return _classPrivateFieldGet(this,_enabled);}},{key:"ready",get:function get(){return _classPrivateFieldGet(this,_ready);}},{key:"promise",get:function get(){if(_classPrivateFieldGet(this,_ready)){return Promise.resolve(_classPrivateFieldGet(this,_data));}
if(!_classPrivateFieldGet(this,_enabled)){_classPrivateFieldGet(this,_resolve).call(this,null);}
return _classPrivateFieldGet(this,_promise);}},{key:"setConsentData",value:function setConsentData(data){var time=arguments.length>1&&arguments[1]!==undefined?arguments[1]:(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.timestamp)();this.generatedTime=time;_classPrivateFieldGet(this,_resolve).call(this,data);}},{key:"getConsentData",value:function getConsentData(){return _classPrivateFieldGet(this,_data);}}]);return ConsentHandler;}();var UspConsentHandler=function(_ConsentHandler){_inherits(UspConsentHandler,_ConsentHandler);var _super=_createSuper(UspConsentHandler);function UspConsentHandler(){_classCallCheck(this,UspConsentHandler);return _super.apply(this,arguments);}
_createClass(UspConsentHandler,[{key:"getConsentMeta",value:function getConsentMeta(){var consentData=this.getConsentData();if(consentData&&this.generatedTime){return{usp:consentData,generatedAt:this.generatedTime};}}}]);return UspConsentHandler;}(ConsentHandler);var GdprConsentHandler=function(_ConsentHandler2){_inherits(GdprConsentHandler,_ConsentHandler2);var _super2=_createSuper(GdprConsentHandler);function GdprConsentHandler(){_classCallCheck(this,GdprConsentHandler);return _super2.apply(this,arguments);}
_createClass(GdprConsentHandler,[{key:"getConsentMeta",value:function getConsentMeta(){var consentData=this.getConsentData();if(consentData&&consentData.vendorData&&this.generatedTime){return{gdprApplies:consentData.gdprApplies,consentStringSize:(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(consentData.vendorData.tcString)?consentData.vendorData.tcString.length:0,generatedAt:this.generatedTime,apiVersion:consentData.apiVersion};}}}]);return GdprConsentHandler;}(ConsentHandler);}),"./src/cpmBucketManager.js":
/*!*********************************!*\
  !*** ./src/cpmBucketManager.js ***!
  \*********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getPriceBucketString":function(){return getPriceBucketString;},"isValidPriceConfig":function(){return isValidPriceConfig;}});var _polyfill_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _defaultPrecision=2;var _lgPriceConfig={'buckets':[{'max':5,'increment':0.5}]};var _mgPriceConfig={'buckets':[{'max':20,'increment':0.1}]};var _hgPriceConfig={'buckets':[{'max':20,'increment':0.01}]};var _densePriceConfig={'buckets':[{'max':3,'increment':0.01},{'max':8,'increment':0.05},{'max':20,'increment':0.5}]};var _autoPriceConfig={'buckets':[{'max':5,'increment':0.05},{'max':10,'increment':0.1},{'max':20,'increment':0.5}]};function getPriceBucketString(cpm,customConfig){var granularityMultiplier=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var cpmFloat=parseFloat(cpm);if(isNaN(cpmFloat)){cpmFloat='';}
return{low:cpmFloat===''?'':getCpmStringValue(cpm,_lgPriceConfig,granularityMultiplier),med:cpmFloat===''?'':getCpmStringValue(cpm,_mgPriceConfig,granularityMultiplier),high:cpmFloat===''?'':getCpmStringValue(cpm,_hgPriceConfig,granularityMultiplier),auto:cpmFloat===''?'':getCpmStringValue(cpm,_autoPriceConfig,granularityMultiplier),dense:cpmFloat===''?'':getCpmStringValue(cpm,_densePriceConfig,granularityMultiplier),custom:cpmFloat===''?'':getCpmStringValue(cpm,customConfig,granularityMultiplier)};}
function getCpmStringValue(cpm,config,granularityMultiplier){var cpmStr='';if(!isValidPriceConfig(config)){return cpmStr;}
var cap=config.buckets.reduce(function(prev,curr){if(prev.max>curr.max){return prev;}
return curr;},{'max':0});var bucketFloor=0;var bucket=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_0__.find)(config.buckets,function(bucket){if(cpm>cap.max*granularityMultiplier){var precision=bucket.precision;if(typeof precision==='undefined'){precision=_defaultPrecision;}
cpmStr=(bucket.max*granularityMultiplier).toFixed(precision);}else if(cpm<=bucket.max*granularityMultiplier&&cpm>=bucketFloor*granularityMultiplier){bucket.min=bucketFloor;return bucket;}else{bucketFloor=bucket.max;}});if(bucket){cpmStr=getCpmTarget(cpm,bucket,granularityMultiplier);}
return cpmStr;}
function isValidPriceConfig(config){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(config)||!config.buckets||!Array.isArray(config.buckets)){return false;}
var isValid=true;config.buckets.forEach(function(bucket){if(!bucket.max||!bucket.increment){isValid=false;}});return isValid;}
function getCpmTarget(cpm,bucket,granularityMultiplier){var precision=typeof bucket.precision!=='undefined'?bucket.precision:_defaultPrecision;var increment=bucket.increment*granularityMultiplier;var bucketMin=bucket.min*granularityMultiplier;var pow=Math.pow(10,precision+2);var cpmToFloor=(cpm*pow-bucketMin*pow)/(increment*pow);var cpmTarget=Math.floor(cpmToFloor)*increment+bucketMin;cpmTarget=Number(cpmTarget.toFixed(10));return cpmTarget.toFixed(precision);}}),"./src/debugging.js":
/*!**************************!*\
  !*** ./src/debugging.js ***!
  \**************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"sessionLoader":function(){return sessionLoader;}});var _config_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _auction_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./auction.js */
"./src/auction.js");var _hook_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _prefixLog=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.prefixLog)('DEBUG:'),logWarn=_prefixLog.logWarn,logMessage=_prefixLog.logMessage;var OVERRIDE_KEY="pbjs:debugging";var addBidResponseBound;var addBidderRequestsBound;var onEnableOverrides=[function(overrides){removeHooks();addHooks(overrides);}];var onDisableOverrides=[removeHooks];function addHooks(overrides){addBidResponseBound=addBidResponseHook.bind(overrides);_auction_js__WEBPACK_IMPORTED_MODULE_1__.addBidResponse.before(addBidResponseBound,5);addBidderRequestsBound=addBidderRequestsHook.bind(overrides);_auction_js__WEBPACK_IMPORTED_MODULE_1__.addBidderRequests.before(addBidderRequestsBound,5);}
function removeHooks(){_auction_js__WEBPACK_IMPORTED_MODULE_1__.addBidResponse.getHooks({hook:addBidResponseBound}).remove();_auction_js__WEBPACK_IMPORTED_MODULE_1__.addBidderRequests.getHooks({hook:addBidderRequestsBound}).remove();}
function enableOverrides(overrides){var fromSession=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_config_js__WEBPACK_IMPORTED_MODULE_2__.config.setConfig({'debug':true});onEnableOverrides.forEach(function(fn){return fn(overrides);});logMessage("bidder overrides enabled".concat(fromSession?' from session':''));}
function disableOverrides(){onDisableOverrides.forEach(function(fn){return fn();});logMessage('bidder overrides disabled');}
function bidExcluded(overrideObj,bidderCode,adUnitCode){if(overrideObj.bidder&&overrideObj.bidder!==bidderCode){return true;}
if(overrideObj.adUnitCode&&overrideObj.adUnitCode!==adUnitCode){return true;}
return false;}
function bidderExcluded(bidders,bidderCode){return Array.isArray(bidders)&&bidders.indexOf(bidderCode)===-1;}
function applyBidOverrides(overrideObj,bidObj,bidType){return Object.keys(overrideObj).filter(function(key){return['adUnitCode','bidder'].indexOf(key)===-1;}).reduce(function(result,key){logMessage("bidder overrides changed '".concat(result.adUnitCode,"/").concat(result.bidderCode,"' ").concat(bidType,".").concat(key," from '").concat(result[key],".js' to '").concat(overrideObj[key],"'"));result[key]=overrideObj[key];result.isDebug=true;return result;},bidObj);}
function addBidResponseHook(next,adUnitCode,bid){var overrides=this;if(bidderExcluded(overrides.bidders,bid.bidderCode)){logWarn("bidder '".concat(bid.bidderCode,"' excluded from auction by bidder overrides"));return;}
if(Array.isArray(overrides.bids)){overrides.bids.forEach(function(overrideBid){if(!bidExcluded(overrideBid,bid.bidderCode,adUnitCode)){applyBidOverrides(overrideBid,bid,'bidder');}});}
next(adUnitCode,bid);}
function addBidderRequestsHook(next,bidderRequests){var overrides=this;var includedBidderRequests=bidderRequests.filter(function(bidderRequest){if(bidderExcluded(overrides.bidders,bidderRequest.bidderCode)){logWarn("bidRequest '".concat(bidderRequest.bidderCode,"' excluded from auction by bidder overrides"));return false;}
return true;});if(Array.isArray(overrides.bidRequests)){includedBidderRequests.forEach(function(bidderRequest){overrides.bidRequests.forEach(function(overrideBid){bidderRequest.bids.forEach(function(bid){if(!bidExcluded(overrideBid,bidderRequest.bidderCode,bid.adUnitCode)){applyBidOverrides(overrideBid,bid,'bidRequest');}});});});}
next(includedBidderRequests);}
var saveDebuggingConfig=(0,_hook_js__WEBPACK_IMPORTED_MODULE_3__.hook)('sync',function(debugConfig){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$sessionStorage=_ref.sessionStorage,sessionStorage=_ref$sessionStorage===void 0?window.sessionStorage:_ref$sessionStorage;if(!debugConfig.enabled){try{sessionStorage.removeItem(OVERRIDE_KEY);}catch(e){}}else{try{sessionStorage.setItem(OVERRIDE_KEY,JSON.stringify(debugConfig));}catch(e){}}});function getConfig(debugging){var _ref2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref2$sessionStorage=_ref2.sessionStorage,sessionStorage=_ref2$sessionStorage===void 0?window.sessionStorage:_ref2$sessionStorage;saveDebuggingConfig(debugging,{sessionStorage:sessionStorage});if(!debugging.enabled){disableOverrides();}else{enableOverrides(debugging);}}
_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('debugging',function(_ref3){var debugging=_ref3.debugging;return getConfig(debugging);});function sessionLoader(storage){var overrides;try{storage=storage||window.sessionStorage;overrides=JSON.parse(storage.getItem(OVERRIDE_KEY));}catch(e){}
if(overrides){enableOverrides(overrides,true);}}}),"./src/events.js":
/*!***********************!*\
  !*** ./src/events.js ***!
  \***********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"emit":function(){return emit;},"getEvents":function(){return getEvents;},"off":function(){return off;},"on":function(){return on;}});var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _constants_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var slice=Array.prototype.slice;var push=Array.prototype.push;var allEvents=_utils_js__WEBPACK_IMPORTED_MODULE_0__._map(_constants_json__WEBPACK_IMPORTED_MODULE_1__.EVENTS,function(v){return v;});var idPaths=_constants_json__WEBPACK_IMPORTED_MODULE_1__.EVENT_ID_PATHS;var eventsFired=[];var _public=function(){var _handlers={};var _public={};function _dispatch(eventString,args){_utils_js__WEBPACK_IMPORTED_MODULE_0__.logMessage('Emitting event for: '+eventString);var eventPayload=args[0]||{};var idPath=idPaths[eventString];var key=eventPayload[idPath];var event=_handlers[eventString]||{que:[]};var eventKeys=_utils_js__WEBPACK_IMPORTED_MODULE_0__._map(event,function(v,k){return k;});var callbacks=[];eventsFired.push({eventType:eventString,args:eventPayload,id:key,elapsedTime:_utils_js__WEBPACK_IMPORTED_MODULE_0__.getPerformanceNow()});if(key&&_utils_js__WEBPACK_IMPORTED_MODULE_0__.contains(eventKeys,key)){push.apply(callbacks,event[key].que);}
push.apply(callbacks,event.que);_utils_js__WEBPACK_IMPORTED_MODULE_0__._each(callbacks,function(fn){if(!fn)return;try{fn.apply(null,args);}catch(e){_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError('Error executing handler:','events.js',e);}});}
function _checkAvailableEvent(event){return _utils_js__WEBPACK_IMPORTED_MODULE_0__.contains(allEvents,event);}
_public.on=function(eventString,handler,id){if(_checkAvailableEvent(eventString)){var event=_handlers[eventString]||{que:[]};if(id){event[id]=event[id]||{que:[]};event[id].que.push(handler);}else{event.que.push(handler);}
_handlers[eventString]=event;}else{_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError('Wrong event name : '+eventString+' Valid event names :'+allEvents);}};_public.emit=function(event){var args=slice.call(arguments,1);_dispatch(event,args);};_public.off=function(eventString,handler,id){var event=_handlers[eventString];if(_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty(event)||_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty(event.que)&&_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty(event[id])){return;}
if(id&&(_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty(event[id])||_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty(event[id].que))){return;}
if(id){_utils_js__WEBPACK_IMPORTED_MODULE_0__._each(event[id].que,function(_handler){var que=event[id].que;if(_handler===handler){que.splice(que.indexOf(_handler),1);}});}else{_utils_js__WEBPACK_IMPORTED_MODULE_0__._each(event.que,function(_handler){var que=event.que;if(_handler===handler){que.splice(que.indexOf(_handler),1);}});}
_handlers[eventString]=event;};_public.get=function(){return _handlers;};_public.getEvents=function(){var arrayCopy=[];_utils_js__WEBPACK_IMPORTED_MODULE_0__._each(eventsFired,function(value){var newProp=_extends({},value);arrayCopy.push(newProp);});return arrayCopy;};return _public;}();_utils_js__WEBPACK_IMPORTED_MODULE_0__._setEventEmitter(_public.emit.bind(_public));var on=_public.on,off=_public.off,get=_public.get,getEvents=_public.getEvents,emit=_public.emit;}),"./src/hook.js":
/*!*********************!*\
  !*** ./src/hook.js ***!
  \*********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getHook":function(){return getHook;},"hook":function(){return hook;},"module":function(){return module;},"submodule":function(){return submodule;}});var fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! fun-hooks/no-eval/index.js */
"./node_modules/fun-hooks/no-eval/index.js");var fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0__);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var hook=fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0___default()({ready:(fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0___default().SYNC)|(fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0___default().ASYNC)|(fun_hooks_no_eval_index_js__WEBPACK_IMPORTED_MODULE_0___default().QUEUE)});var getHook=hook.get;function setupBeforeHookFnOnce(baseFn,hookFn){var priority=arguments.length>2&&arguments[2]!==undefined?arguments[2]:15;var result=baseFn.getHooks({hook:hookFn});if(result.length===0){baseFn.before(hookFn,priority);}}
var submoduleInstallMap={};function module(name,install){var _ref=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref$postInstallAllow=_ref.postInstallAllowed,postInstallAllowed=_ref$postInstallAllow===void 0?false:_ref$postInstallAllow;hook('async',function(submodules){submodules.forEach(function(args){return install.apply(void 0,_toConsumableArray(args));});if(postInstallAllowed)submoduleInstallMap[name]=install;},name)([]);}
function submodule(name){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
var install=submoduleInstallMap[name];if(install)return install.apply(void 0,args);getHook(name).before(function(next,modules){modules.push(args);next(modules);});}}),"./src/mediaTypes.js":
/*!***************************!*\
  !*** ./src/mediaTypes.js ***!
  \***************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"ADPOD":function(){return ADPOD;},"BANNER":function(){return BANNER;},"NATIVE":function(){return NATIVE;},"VIDEO":function(){return VIDEO;}});var NATIVE='native';var VIDEO='video';var BANNER='banner';var ADPOD='adpod';}),"./src/native.js":
/*!***********************!*\
  !*** ./src/native.js ***!
  \***********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"NATIVE_TARGETING_KEYS":function(){return NATIVE_TARGETING_KEYS;},"decorateAdUnitsWithNativeParams":function(){return decorateAdUnitsWithNativeParams;},"fireNativeTrackers":function(){return fireNativeTrackers;},"getAllAssetsMessage":function(){return getAllAssetsMessage;},"getAssetMessage":function(){return getAssetMessage;},"getNativeTargeting":function(){return getNativeTargeting;},"nativeAdapters":function(){return nativeAdapters;},"nativeBidIsValid":function(){return nativeBidIsValid;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var _constants_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var nativeAdapters=[];var NATIVE_TARGETING_KEYS=Object.keys(_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS).map(function(key){return _constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS[key];});var IMAGE={image:{required:true},title:{required:true},sponsoredBy:{required:true},clickUrl:{required:true},body:{required:false},icon:{required:false}};var SUPPORTED_TYPES={image:IMAGE};function processNativeAdUnitParams(params){if(params&&params.type&&typeIsSupported(params.type)){return SUPPORTED_TYPES[params.type];}
return params;}
function decorateAdUnitsWithNativeParams(adUnits){adUnits.forEach(function(adUnit){var nativeParams=adUnit.nativeParams||(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,'mediaTypes.native');if(nativeParams){adUnit.nativeParams=processNativeAdUnitParams(nativeParams);}});}
function typeIsSupported(type){if(!(type&&(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(Object.keys(SUPPORTED_TYPES),type))){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)("".concat(type," nativeParam is not supported"));return false;}
return true;}
var nativeAdUnit=function nativeAdUnit(adUnit){var mediaType=adUnit.mediaType==='native';var mediaTypes=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,'mediaTypes.native');return mediaType||mediaTypes;};var nativeBidder=function nativeBidder(bid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(nativeAdapters,bid.bidder);};var hasNonNativeBidder=function hasNonNativeBidder(adUnit){return adUnit.bids.filter(function(bid){return!nativeBidder(bid);}).length;};function nativeBidIsValid(bid){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$index=_ref.index,index=_ref$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_4__.auctionManager.index:_ref$index;if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'native.clickUrl')){return false;}
var requestedAssets=index.getAdUnit(bid).nativeParams;if(!requestedAssets){return true;}
var requiredAssets=Object.keys(requestedAssets).filter(function(key){return requestedAssets[key].required;});var returnedAssets=Object.keys(bid['native']).filter(function(key){return bid['native'][key];});return requiredAssets.every(function(asset){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(returnedAssets,asset);});}
function fireNativeTrackers(message,adObject){var trackers;if(message.action==='click'){trackers=adObject['native']&&adObject['native'].clickTrackers;}else{trackers=adObject['native']&&adObject['native'].impressionTrackers;if(adObject['native']&&adObject['native'].javascriptTrackers){(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.insertHtmlIntoIframe)(adObject['native'].javascriptTrackers);}}
(trackers||[]).forEach(_utils_js__WEBPACK_IMPORTED_MODULE_3__.triggerPixel);return message.action;}
function getNativeTargeting(bid){var _ref2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref2$index=_ref2.index,index=_ref2$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_4__.auctionManager.index:_ref2$index;var keyValues={};var adUnit=index.getAdUnit(bid);if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,'nativeParams.rendererUrl')){bid['native']['rendererUrl']=getAssetValue(adUnit.nativeParams['rendererUrl']);}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,'nativeParams.adTemplate')){bid['native']['adTemplate']=getAssetValue(adUnit.nativeParams['adTemplate']);}
var globalSendTargetingKeys=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,"nativeParams.sendTargetingKeys")!==false;var nativeKeys=getNativeKeys(adUnit);var flatBidNativeKeys=_objectSpread(_objectSpread({},bid.native),bid.native.ext);delete flatBidNativeKeys.ext;Object.keys(flatBidNativeKeys).forEach(function(asset){var key=nativeKeys[asset];var value=getAssetValue(bid.native[asset])||getAssetValue((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,"native.ext.".concat(asset)));if(asset==='adTemplate'||!key||!value){return;}
var sendPlaceholder=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,"nativeParams.".concat(asset,".sendId"));if(typeof sendPlaceholder!=='boolean'){sendPlaceholder=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,"nativeParams.ext.".concat(asset,".sendId"));}
if(sendPlaceholder){var placeholder="".concat(key,":").concat(bid.adId);value=placeholder;}
var assetSendTargetingKeys=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,"nativeParams.".concat(asset,".sendTargetingKeys"));if(typeof assetSendTargetingKeys!=='boolean'){assetSendTargetingKeys=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,"nativeParams.ext.".concat(asset,".sendTargetingKeys"));}
var sendTargeting=typeof assetSendTargetingKeys==='boolean'?assetSendTargetingKeys:globalSendTargetingKeys;if(sendTargeting){keyValues[key]=value;}});return keyValues;}
function getAssetMessage(data,adObject){var message={message:'assetResponse',adId:data.adId,assets:[]};if(adObject.native.hasOwnProperty('adTemplate')){message.adTemplate=getAssetValue(adObject.native['adTemplate']);}
if(adObject.native.hasOwnProperty('rendererUrl')){message.rendererUrl=getAssetValue(adObject.native['rendererUrl']);}
data.assets.forEach(function(asset){var key=(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.getKeyByValue)(_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS,asset);var value=getAssetValue(adObject.native[key]);message.assets.push({key:key,value:value});});return message;}
function getAllAssetsMessage(data,adObject){var message={message:'assetResponse',adId:data.adId,assets:[]};Object.keys(adObject.native).forEach(function(key,index){if(key==='adTemplate'&&adObject.native[key]){message.adTemplate=getAssetValue(adObject.native[key]);}else if(key==='rendererUrl'&&adObject.native[key]){message.rendererUrl=getAssetValue(adObject.native[key]);}else if(key==='ext'){Object.keys(adObject.native[key]).forEach(function(extKey){if(adObject.native[key][extKey]){var value=getAssetValue(adObject.native[key][extKey]);message.assets.push({key:extKey,value:value});}});}else if(adObject.native[key]&&_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS.hasOwnProperty(key)){var value=getAssetValue(adObject.native[key]);message.assets.push({key:key,value:value});}});return message;}
function getAssetValue(value){if(_typeof(value)==='object'&&value.url){return value.url;}
return value;}
function getNativeKeys(adUnit){var extraNativeKeys={};if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(adUnit,'nativeParams.ext')){Object.keys(adUnit.nativeParams.ext).forEach(function(extKey){extraNativeKeys[extKey]="hb_native_".concat(extKey);});}
return _objectSpread(_objectSpread({},_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS),extraNativeKeys);}}),"./src/polyfill.js":
/*!*************************!*\
  !*** ./src/polyfill.js ***!
  \*************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"arrayFrom":function(){return arrayFrom;},"find":function(){return find;},"includes":function(){return includes;}});function includes(target,elem,start){return target&&target.includes(elem,start)||false;}
function arrayFrom(){return Array.from.apply(Array,arguments);}
function find(arr,pred,thisArg){return arr&&arr.find(pred,thisArg);}
function findIndex(arr,pred,thisArg){return arr&&arr.findIndex(pred,thisArg);}}),"./src/prebidGlobal.js":
/*!*****************************!*\
  !*** ./src/prebidGlobal.js ***!
  \*****************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getGlobal":function(){return getGlobal;}});window.pbjs=window.pbjs||{};window.pbjs.cmd=window.pbjs.cmd||[];window.pbjs.que=window.pbjs.que||[];window._pbjsGlobals=window._pbjsGlobals||[];window._pbjsGlobals.push("pbjs");function getGlobal(){return window.pbjs;}}),"./src/refererDetection.js":
/*!*********************************!*\
  !*** ./src/refererDetection.js ***!
  \*********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getRefererInfo":function(){return getRefererInfo;}});var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");function detectReferer(win){function getAncestorOrigins(win){try{if(!win.location.ancestorOrigins){return;}
return win.location.ancestorOrigins;}catch(e){}}
function getCanonicalUrl(doc){var pageURL=_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('pageUrl');if(pageURL)return pageURL;try{var element=doc.querySelector("link[rel='canonical']");if(element!==null){return element.href;}}catch(e){}
return null;}
function refererInfo(){var stack=[];var ancestors=getAncestorOrigins(win);var maxNestedIframes=_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('maxNestedIframes');var currentWindow;var bestReferrer;var bestCanonicalUrl;var reachedTop=false;var level=0;var valuesFromAmp=false;var inAmpFrame=false;do{var previousWindow=currentWindow;var wasInAmpFrame=inAmpFrame;var currentLocation=void 0;var crossOrigin=false;var foundReferrer=null;inAmpFrame=false;currentWindow=currentWindow?currentWindow.parent:win;try{currentLocation=currentWindow.location.href||null;}catch(e){crossOrigin=true;}
if(crossOrigin){if(wasInAmpFrame){var context=previousWindow.context;try{foundReferrer=context.sourceUrl;bestReferrer=foundReferrer;valuesFromAmp=true;if(currentWindow===win.top){reachedTop=true;}
if(context.canonicalUrl){bestCanonicalUrl=context.canonicalUrl;}}catch(e){}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Trying to access cross domain iframe. Continuing without referrer and location');try{var referrer=previousWindow.document.referrer;if(referrer){foundReferrer=referrer;if(currentWindow===win.top){reachedTop=true;}}}catch(e){}
if(!foundReferrer&&ancestors&&ancestors[level-1]){foundReferrer=ancestors[level-1];}
if(foundReferrer&&!valuesFromAmp){bestReferrer=foundReferrer;}}}else{if(currentLocation){foundReferrer=currentLocation;bestReferrer=foundReferrer;valuesFromAmp=false;if(currentWindow===win.top){reachedTop=true;var canonicalUrl=getCanonicalUrl(currentWindow.document);if(canonicalUrl){bestCanonicalUrl=canonicalUrl;}}}
if(currentWindow.context&&currentWindow.context.sourceUrl){inAmpFrame=true;}}
stack.push(foundReferrer);level++;}while(currentWindow!==win.top&&level<maxNestedIframes);stack.reverse();return{referer:bestReferrer||null,reachedTop:reachedTop,isAmp:valuesFromAmp,numIframes:level-1,stack:stack,canonicalUrl:bestCanonicalUrl||null};}
return refererInfo;}
var getRefererInfo=detectReferer(window);}),"./src/secureCreatives.js":
/*!********************************!*\
  !*** ./src/secureCreatives.js ***!
  \********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"listenMessagesFromCreative":function(){return listenMessagesFromCreative;}});var _events_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./events.js */
"./src/events.js");var _native_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./native.js */
"./src/native.js");var _constants_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _Renderer_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ./Renderer.js */
"./src/Renderer.js");var _config_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _adRendering_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./adRendering.js */
"./src/adRendering.js");var BID_WON=_constants_json__WEBPACK_IMPORTED_MODULE_0__.EVENTS.BID_WON;var STALE_RENDER=_constants_json__WEBPACK_IMPORTED_MODULE_0__.EVENTS.STALE_RENDER;var HANDLER_MAP={'Prebid Request':handleRenderRequest,'Prebid Native':handleNativeRequest,'Prebid Event':handleEventRequest};function listenMessagesFromCreative(){window.addEventListener('message',receiveMessage,false);}
function getReplier(ev){if(ev.origin==null&&ev.ports.length===0){return function(){var msg='Cannot post message to a frame with null origin. Please update creatives to use MessageChannel, see https://github.com/prebid/Prebid.js/issues/7870';(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(msg);throw new Error(msg);};}else if(ev.ports.length>0){return function(message){ev.ports[0].postMessage(JSON.stringify(message));};}else{return function(message){ev.source.postMessage(JSON.stringify(message),ev.origin);};}}
function receiveMessage(ev){var key=ev.message?'message':'data';var data={};try{data=JSON.parse(ev[key]);}catch(e){return;}
if(data&&data.adId&&data.message){var adObject=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(_auctionManager_js__WEBPACK_IMPORTED_MODULE_3__.auctionManager.getBidsReceived(),function(bid){return bid.adId===data.adId;});if(HANDLER_MAP.hasOwnProperty(data.message)){HANDLER_MAP[data.message](getReplier(ev),data,adObject);}}}
function handleRenderRequest(reply,data,adObject){if(adObject==null){(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_4__.emitAdRenderFail)({reason:_constants_json__WEBPACK_IMPORTED_MODULE_0__.AD_RENDER_FAILED_REASON.CANNOT_FIND_AD,message:"Cannot find ad '".concat(data.adId,"' for cross-origin render request"),id:data.adId});return;}
if(adObject.status===_constants_json__WEBPACK_IMPORTED_MODULE_0__.BID_STATUS.RENDERED){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Ad id ".concat(adObject.adId," has been rendered before"));_events_js__WEBPACK_IMPORTED_MODULE_5__.emit(STALE_RENDER,adObject);if((0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig('auctionOptions'),'suppressStaleRender')){return;}}
try{_sendAdToCreative(adObject,reply);}catch(e){(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_4__.emitAdRenderFail)({reason:_constants_json__WEBPACK_IMPORTED_MODULE_0__.AD_RENDER_FAILED_REASON.EXCEPTION,message:e.message,id:data.adId,bid:adObject});return;}
_auctionManager_js__WEBPACK_IMPORTED_MODULE_3__.auctionManager.addWinningBid(adObject);_events_js__WEBPACK_IMPORTED_MODULE_5__.emit(BID_WON,adObject);}
function handleNativeRequest(reply,data,adObject){if(adObject==null){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Cannot find ad '".concat(data.adId,"' for x-origin event request"));return;}
switch(data.action){case'assetRequest':reply((0,_native_js__WEBPACK_IMPORTED_MODULE_8__.getAssetMessage)(data,adObject));break;case'allAssetRequest':reply((0,_native_js__WEBPACK_IMPORTED_MODULE_8__.getAllAssetsMessage)(data,adObject));break;case'resizeNativeHeight':adObject.height=data.height;adObject.width=data.width;resizeRemoteCreative(adObject);break;default:var trackerType=(0,_native_js__WEBPACK_IMPORTED_MODULE_8__.fireNativeTrackers)(data,adObject);if(trackerType==='click'){return;}
_auctionManager_js__WEBPACK_IMPORTED_MODULE_3__.auctionManager.addWinningBid(adObject);_events_js__WEBPACK_IMPORTED_MODULE_5__.emit(BID_WON,adObject);}}
function handleEventRequest(reply,data,adObject){if(adObject==null){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Cannot find ad '".concat(data.adId,"' for x-origin event request"));return;}
if(adObject.status!==_constants_json__WEBPACK_IMPORTED_MODULE_0__.BID_STATUS.RENDERED){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Received x-origin event request without corresponding render request for ad '".concat(data.adId,"'"));return;}
switch(data.event){case _constants_json__WEBPACK_IMPORTED_MODULE_0__.EVENTS.AD_RENDER_FAILED:(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_4__.emitAdRenderFail)({bid:adObject,id:data.adId,reason:data.info.reason,message:data.info.message});break;case _constants_json__WEBPACK_IMPORTED_MODULE_0__.EVENTS.AD_RENDER_SUCCEEDED:(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_4__.emitAdRenderSucceeded)({doc:null,bid:adObject,id:data.adId});break;default:(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Received x-origin event request for unsupported event: '".concat(data.event,"' (adId: '").concat(data.adId,"')"));}}
function _sendAdToCreative(adObject,reply){var adId=adObject.adId,ad=adObject.ad,adUrl=adObject.adUrl,width=adObject.width,height=adObject.height,renderer=adObject.renderer,cpm=adObject.cpm,originalCpm=adObject.originalCpm;if((0,_Renderer_js__WEBPACK_IMPORTED_MODULE_9__.isRendererRequired)(renderer)){(0,_Renderer_js__WEBPACK_IMPORTED_MODULE_9__.executeRenderer)(renderer,adObject);}else if(adId){resizeRemoteCreative(adObject);reply({message:'Prebid Response',ad:(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.replaceAuctionPrice)(ad,originalCpm||cpm),adUrl:(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.replaceAuctionPrice)(adUrl,originalCpm||cpm),adId:adId,width:width,height:height});}}
function resizeRemoteCreative(_ref){var adId=_ref.adId,adUnitCode=_ref.adUnitCode,width=_ref.width,height=_ref.height;['div','iframe'].forEach(function(elmType){var element=getElementByAdUnit(elmType+':not([style*="display: none"])');if(element){var elementStyle=element.style;elementStyle.width=width+'px';elementStyle.height=height+'px';}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Unable to locate matching page element for adUnitCode ".concat(adUnitCode,".  Can't resize it to ad's dimensions.  Please review setup."));}});function getElementByAdUnit(elmType){var id=getElementIdBasedOnAdServer(adId,adUnitCode);var parentDivEle=document.getElementById(id);return parentDivEle&&parentDivEle.querySelector(elmType);}
function getElementIdBasedOnAdServer(adId,adUnitCode){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isGptPubadsDefined)()){return getDfpElementId(adId);}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isApnGetTagDefined)()){return getAstElementId(adUnitCode);}else{return adUnitCode;}}
function getDfpElementId(adId){var slot=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(window.googletag.pubads().getSlots(),function(slot){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(slot.getTargetingKeys(),function(key){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(slot.getTargeting(key),adId);});});return slot?slot.getSlotElementId():null;}
function getAstElementId(adUnitCode){var astTag=window.apntag.getTag(adUnitCode);return astTag&&astTag.targetId;}}}),"./src/sizeMapping.js":
/*!****************************!*\
  !*** ./src/sizeMapping.js ***!
  \****************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"processAdUnitsForLabels":function(){return processAdUnitsForLabels;},"sizeSupported":function(){return sizeSupported;}});var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var sizeConfig=[];function setSizeConfig(config){sizeConfig=config;}
_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('sizeConfig',function(config){return setSizeConfig(config.sizeConfig);});function getLabels(bidOrAdUnit,activeLabels){if(bidOrAdUnit.labelAll){return{labelAll:true,labels:bidOrAdUnit.labelAll,activeLabels:activeLabels};}
return{labelAll:false,labels:bidOrAdUnit.labelAny,activeLabels:activeLabels};}
function sizeSupported(size){var configs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:sizeConfig;var maps=evaluateSizeConfig(configs);if(!maps.shouldFilter){return true;}
return!!maps.sizesSupported[size];}
function resolveStatus(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$labels=_ref.labels,labels=_ref$labels===void 0?[]:_ref$labels,_ref$labelAll=_ref.labelAll,labelAll=_ref$labelAll===void 0?false:_ref$labelAll,_ref$activeLabels=_ref.activeLabels,activeLabels=_ref$activeLabels===void 0?[]:_ref$activeLabels;var mediaTypes=arguments.length>1?arguments[1]:undefined;var sizes=arguments.length>2?arguments[2]:undefined;var configs=arguments.length>3&&arguments[3]!==undefined?arguments[3]:sizeConfig;var maps=evaluateSizeConfig(configs);if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(mediaTypes)){if(sizes){mediaTypes={banner:{sizes:sizes}};}else{mediaTypes={};}}else{mediaTypes=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(mediaTypes);}
var oldSizes=(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(mediaTypes,'banner.sizes');if(maps.shouldFilter&&oldSizes){mediaTypes.banner.sizes=oldSizes.filter(function(size){return maps.sizesSupported[size];});}
var allMediaTypes=Object.keys(mediaTypes);var results={active:allMediaTypes.every(function(type){return type!=='banner';})||allMediaTypes.some(function(type){return type==='banner';})&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(mediaTypes,'banner.sizes.length')>0&&(labels.length===0||!labelAll&&(labels.some(function(label){return maps.labels[label];})||labels.some(function(label){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_3__.includes)(activeLabels,label);}))||labelAll&&labels.reduce(function(result,label){return!result?result:maps.labels[label]||(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_3__.includes)(activeLabels,label);},true)),mediaTypes:mediaTypes};if(oldSizes&&oldSizes.length!==mediaTypes.banner.sizes.length){results.filterResults={before:oldSizes,after:mediaTypes.banner.sizes};}
return results;}
function evaluateSizeConfig(configs){return configs.reduce(function(results,config){if(_typeof(config)==='object'&&typeof config.mediaQuery==='string'&&config.mediaQuery.length>0){var ruleMatch=false;try{ruleMatch=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getWindowTop)().matchMedia(config.mediaQuery).matches;}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Unfriendly iFrame blocks sizeConfig from being correctly evaluated');ruleMatch=matchMedia(config.mediaQuery).matches;}
if(ruleMatch){if(Array.isArray(config.sizesSupported)){results.shouldFilter=true;}
['labels','sizesSupported'].forEach(function(type){return(config[type]||[]).forEach(function(thing){return results[type][thing]=true;});});}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('sizeConfig rule missing required property "mediaQuery"');}
return results;},{labels:{},sizesSupported:{},shouldFilter:false});}
function processAdUnitsForLabels(adUnits,activeLabels){return adUnits.reduce(function(adUnits,adUnit){var _resolveStatus=resolveStatus(getLabels(adUnit,activeLabels),adUnit.mediaTypes,adUnit.sizes),active=_resolveStatus.active,mediaTypes=_resolveStatus.mediaTypes,filterResults=_resolveStatus.filterResults;if(!active){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Size mapping disabled adUnit \"".concat(adUnit.code,"\""));}else{if(filterResults){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Size mapping filtered adUnit \"".concat(adUnit.code,"\" banner sizes from "),filterResults.before,'to ',filterResults.after);}
adUnit.mediaTypes=mediaTypes;adUnit.bids=adUnit.bids.reduce(function(bids,bid){var _resolveStatus2=resolveStatus(getLabels(bid,activeLabels),adUnit.mediaTypes),active=_resolveStatus2.active,mediaTypes=_resolveStatus2.mediaTypes,filterResults=_resolveStatus2.filterResults;if(!active){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Size mapping deactivated adUnit \"".concat(adUnit.code,"\" bidder \"").concat(bid.bidder,"\""));}else{if(filterResults){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Size mapping filtered adUnit \"".concat(adUnit.code,"\" bidder \"").concat(bid.bidder,"\" banner sizes from "),filterResults.before,'to ',filterResults.after);bid.mediaTypes=mediaTypes;}
bids.push(bid);}
return bids;},[]);adUnits.push(adUnit);}
return adUnits;},[]);}}),"./src/storageManager.js":
/*!*******************************!*\
  !*** ./src/storageManager.js ***!
  \*******************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getCoreStorageManager":function(){return getCoreStorageManager;},"getStorageManager":function(){return getStorageManager;},"storageCallbacks":function(){return storageCallbacks;},"validateStorageEnforcement":function(){return validateStorageEnforcement;}});var _hook_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _bidderSettings_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./bidderSettings.js */
"./src/bidderSettings.js");var moduleTypeWhiteList=['core','prebid-module'];var storageCallbacks=[];function newStorageManager(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},gvlid=_ref.gvlid,moduleName=_ref.moduleName,bidderCode=_ref.bidderCode,moduleType=_ref.moduleType;var _ref2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref2$bidderSettings=_ref2.bidderSettings,bidderSettings=_ref2$bidderSettings===void 0?_bidderSettings_js__WEBPACK_IMPORTED_MODULE_0__.bidderSettings:_ref2$bidderSettings;function isBidderDisallowed(){if(bidderCode==null){return false;}
var storageAllowed=bidderSettings.get(bidderCode,'storageAllowed');return storageAllowed==null?false:!storageAllowed;}
function isValid(cb){if((0,_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.includes)(moduleTypeWhiteList,moduleType)){var result={valid:true};return cb(result);}else if(isBidderDisallowed()){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logInfo)("bidderSettings denied access to device storage for bidder '".concat(bidderCode,"'"));var _result={valid:false};return cb(_result);}else{var value;var hookDetails={hasEnforcementHook:false};validateStorageEnforcement(gvlid,bidderCode||moduleName,hookDetails,function(result){if(result&&result.hasEnforcementHook){value=cb(result);}else{var _result2={hasEnforcementHook:false,valid:(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.hasDeviceAccess)()};value=cb(_result2);}});return value;}}
var setCookie=function setCookie(key,value,expires,sameSite,domain,done){var cb=function cb(result){if(result&&result.valid){var domainPortion=domain&&domain!==''?" ;domain=".concat(encodeURIComponent(domain)):'';var expiresPortion=expires&&expires!==''?" ;expires=".concat(expires):'';var isNone=sameSite!=null&&sameSite.toLowerCase()=='none';var secure=isNone?'; Secure':'';document.cookie="".concat(key,"=").concat(encodeURIComponent(value)).concat(expiresPortion,"; path=/").concat(domainPortion).concat(sameSite?"; SameSite=".concat(sameSite):'').concat(secure);}};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var getCookie=function getCookie(name,done){var cb=function cb(result){if(result&&result.valid){var m=window.document.cookie.match('(^|;)\\s*'+name+'\\s*=\\s*([^;]*)\\s*(;|$)');return m?decodeURIComponent(m[2]):null;}
return null;};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var localStorageIsEnabled=function localStorageIsEnabled(done){var cb=function cb(result){if(result&&result.valid){try{localStorage.setItem('prebid.cookieTest','1');return localStorage.getItem('prebid.cookieTest')==='1';}catch(error){}finally{try{localStorage.removeItem('prebid.cookieTest');}catch(error){}}}
return false;};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var cookiesAreEnabled=function cookiesAreEnabled(done){var cb=function cb(result){if(result&&result.valid){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.checkCookieSupport)()){return true;}
window.document.cookie='prebid.cookieTest';return window.document.cookie.indexOf('prebid.cookieTest')!==-1;}
return false;};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var setDataInLocalStorage=function setDataInLocalStorage(key,value,done){var cb=function cb(result){if(result&&result.valid&&hasLocalStorage()){window.localStorage.setItem(key,value);}};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var getDataFromLocalStorage=function getDataFromLocalStorage(key,done){var cb=function cb(result){if(result&&result.valid&&hasLocalStorage()){return window.localStorage.getItem(key);}
return null;};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var removeDataFromLocalStorage=function removeDataFromLocalStorage(key,done){var cb=function cb(result){if(result&&result.valid&&hasLocalStorage()){window.localStorage.removeItem(key);}};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var hasLocalStorage=function hasLocalStorage(done){var cb=function cb(result){if(result&&result.valid){try{return!!window.localStorage;}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.logError)('Local storage api disabled');}}
return false;};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};var findSimilarCookies=function findSimilarCookies(keyLike,done){var cb=function cb(result){if(result&&result.valid){var all=[];if((0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.hasDeviceAccess)()){var cookies=document.cookie.split(';');while(cookies.length){var cookie=cookies.pop();var separatorIndex=cookie.indexOf('=');separatorIndex=separatorIndex<0?cookie.length:separatorIndex;var cookieName=decodeURIComponent(cookie.slice(0,separatorIndex).replace(/^\s+/,''));if(cookieName.indexOf(keyLike)>=0){all.push(decodeURIComponent(cookie.slice(separatorIndex+1)));}}}
return all;}};if(done&&typeof done==='function'){storageCallbacks.push(function(){var result=isValid(cb);done(result);});}else{return isValid(cb);}};return{setCookie:setCookie,getCookie:getCookie,localStorageIsEnabled:localStorageIsEnabled,cookiesAreEnabled:cookiesAreEnabled,setDataInLocalStorage:setDataInLocalStorage,getDataFromLocalStorage:getDataFromLocalStorage,removeDataFromLocalStorage:removeDataFromLocalStorage,hasLocalStorage:hasLocalStorage,findSimilarCookies:findSimilarCookies};}
var validateStorageEnforcement=(0,_hook_js__WEBPACK_IMPORTED_MODULE_3__.hook)('async',function(gvlid,moduleName,hookDetails,callback){callback(hookDetails);},'validateStorageEnforcement');function getCoreStorageManager(moduleName){return newStorageManager({moduleName:moduleName,moduleType:'core'});}
function getStorageManager(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},gvlid=_ref3.gvlid,moduleName=_ref3.moduleName,bidderCode=_ref3.bidderCode;if(arguments.length>1||arguments.length>0&&!(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isPlainObject)(arguments[0])){throw new Error('Invalid invocation for getStorageManager');}
return newStorageManager({gvlid:gvlid,moduleName:moduleName,bidderCode:bidderCode});}
function resetData(){storageCallbacks=[];}}),"./src/targeting.js":
/*!**************************!*\
  !*** ./src/targeting.js ***!
  \**************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"filters":function(){return filters;},"targeting":function(){return targeting;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _config_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _native_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./native.js */
"./src/native.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var _sizeMapping_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./sizeMapping.js */
"./src/sizeMapping.js");var _mediaTypes_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./mediaTypes.js */
"./src/mediaTypes.js");var _hook_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _bidderSettings_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ./bidderSettings.js */
"./src/bidderSettings.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _constants_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var pbTargetingKeys=[];var MAX_DFP_KEYLENGTH=20;var TTL_BUFFER=1000;var CFG_ALLOW_TARGETING_KEYS="targetingControls.allowTargetingKeys";var CFG_ADD_TARGETING_KEYS="targetingControls.addTargetingKeys";var TARGETING_KEY_CONFIGURATION_ERROR_MSG="Only one of \"".concat(CFG_ALLOW_TARGETING_KEYS,"\" or \"").concat(CFG_ADD_TARGETING_KEYS,"\" can be set");var TARGETING_KEYS=Object.keys(_constants_json__WEBPACK_IMPORTED_MODULE_0__.TARGETING_KEYS).map(function(key){return _constants_json__WEBPACK_IMPORTED_MODULE_0__.TARGETING_KEYS[key];});var isBidNotExpired=function isBidNotExpired(bid){return bid.responseTimestamp+bid.ttl*1000-TTL_BUFFER>(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.timestamp)();};var isUnusedBid=function isUnusedBid(bid){return bid&&(bid.status&&!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)([_constants_json__WEBPACK_IMPORTED_MODULE_0__.BID_STATUS.RENDERED],bid.status)||!bid.status);};var filters={isBidNotExpired:isBidNotExpired,isUnusedBid:isUnusedBid};var getHighestCpmBidsFromBidPool=(0,_hook_js__WEBPACK_IMPORTED_MODULE_3__.hook)('sync',function(bidsReceived,highestCpmCallback){var adUnitBidLimit=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var hasModified=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(!hasModified){var bids=[];var dealPrioritization=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('sendBidsControl.dealPrioritization');var buckets=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.groupBy)(bidsReceived,'adUnitCode');Object.keys(buckets).forEach(function(bucketKey){var bucketBids=[];var bidsByBidder=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.groupBy)(buckets[bucketKey],'bidderCode');Object.keys(bidsByBidder).forEach(function(key){return bucketBids.push(bidsByBidder[key].reduce(highestCpmCallback));});if(adUnitBidLimit>0){bucketBids=dealPrioritization?bucketBids.sort(sortByDealAndPriceBucketOrCpm(true)):bucketBids.sort(function(a,b){return b.cpm-a.cpm;});bids.push.apply(bids,_toConsumableArray(bucketBids.slice(0,adUnitBidLimit)));}else{bids.push.apply(bids,_toConsumableArray(bucketBids));}});return bids;}
return bidsReceived;});function sortByDealAndPriceBucketOrCpm(){var useCpm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return function(a,b){if(a.adserverTargeting.hb_deal!==undefined&&b.adserverTargeting.hb_deal===undefined){return-1;}
if(a.adserverTargeting.hb_deal===undefined&&b.adserverTargeting.hb_deal!==undefined){return 1;}
if(useCpm){return b.cpm-a.cpm;}
return b.adserverTargeting.hb_pb-a.adserverTargeting.hb_pb;};}
function newTargeting(auctionManager){var targeting={};var latestAuctionForAdUnit={};targeting.setLatestAuctionForAdUnit=function(adUnitCode,auctionId){latestAuctionForAdUnit[adUnitCode]=auctionId;};targeting.resetPresetTargeting=function(adUnitCode,customSlotMatching){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isGptPubadsDefined)()){var adUnitCodes=getAdUnitCodes(adUnitCode);var adUnits=auctionManager.getAdUnits().filter(function(adUnit){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(adUnitCodes,adUnit.code);});var unsetKeys=pbTargetingKeys.reduce(function(reducer,key){reducer[key]=null;return reducer;},{});window.googletag.pubads().getSlots().forEach(function(slot){var customSlotMatchingFunc=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(customSlotMatching)&&customSlotMatching(slot);adUnits.forEach(function(unit){if(unit.code===slot.getAdUnitPath()||unit.code===slot.getSlotElementId()||(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(customSlotMatchingFunc)&&customSlotMatchingFunc(unit.code)){slot.updateTargetingFromMap(unsetKeys);}});});}};targeting.resetPresetTargetingAST=function(adUnitCode){var adUnitCodes=getAdUnitCodes(adUnitCode);adUnitCodes.forEach(function(unit){var astTag=window.apntag.getTag(unit);if(astTag&&astTag.keywords){var currentKeywords=Object.keys(astTag.keywords);var newKeywords={};currentKeywords.forEach(function(key){if(!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(pbTargetingKeys,key.toLowerCase())){newKeywords[key]=astTag.keywords[key];}});window.apntag.modifyTag(unit,{keywords:newKeywords});}});};function bidShouldBeAddedToTargeting(bid,adUnitCodes){return bid.adserverTargeting&&adUnitCodes&&((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(adUnitCodes)&&(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(adUnitCodes,bid.adUnitCode)||typeof adUnitCodes==='string'&&bid.adUnitCode===adUnitCodes);};function getDealBids(adUnitCodes,bidsReceived){if(_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('targetingControls.alwaysIncludeDeals')===true){var standardKeys=TARGETING_KEYS.concat(_native_js__WEBPACK_IMPORTED_MODULE_5__.NATIVE_TARGETING_KEYS);var bids=getHighestCpmBidsFromBidPool(bidsReceived,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getHighestCpm);return bids.map(function(bid){if(bid.dealId&&bidShouldBeAddedToTargeting(bid,adUnitCodes)){return _defineProperty({},bid.adUnitCode,getTargetingMap(bid,standardKeys.filter(function(key){return typeof bid.adserverTargeting[key]!=='undefined';})));}}).filter(function(bid){return bid;});}
return[];};function getAllowedTargetingKeyValues(targeting,allowedKeys){var defaultKeyring=_extends({},_constants_json__WEBPACK_IMPORTED_MODULE_0__.TARGETING_KEYS,_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS);var defaultKeys=Object.keys(defaultKeyring);var keyDispositions={};(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("allowTargetingKeys - allowed keys [ ".concat(allowedKeys.map(function(k){return defaultKeyring[k];}).join(', ')," ]"));targeting.map(function(adUnit){var adUnitCode=Object.keys(adUnit)[0];var keyring=adUnit[adUnitCode];var keys=keyring.filter(function(kvPair){var key=Object.keys(kvPair)[0];var isCustom=defaultKeys.filter(function(defaultKey){return key.indexOf(defaultKeyring[defaultKey])===0;}).length===0;var found=isCustom||(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(allowedKeys,function(allowedKey){var allowedKeyName=defaultKeyring[allowedKey];var found=key.indexOf(allowedKeyName)===0;return found;});keyDispositions[key]=!found;return found;});adUnit[adUnitCode]=keys;});var removedKeys=Object.keys(keyDispositions).filter(function(d){return keyDispositions[d];});(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("allowTargetingKeys - removed keys [ ".concat(removedKeys.join(', ')," ]"));var filteredTargeting=targeting.filter(function(adUnit){var adUnitCode=Object.keys(adUnit)[0];var keyring=adUnit[adUnitCode];return keyring.length>0;});return filteredTargeting;}
targeting.getAllTargeting=function(adUnitCode){var bidsReceived=arguments.length>1&&arguments[1]!==undefined?arguments[1]:getBidsReceived();var adUnitCodes=getAdUnitCodes(adUnitCode);var targeting=getWinningBidTargeting(adUnitCodes,bidsReceived).concat(getCustomBidTargeting(adUnitCodes,bidsReceived)).concat(_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('enableSendAllBids')?getBidLandscapeTargeting(adUnitCodes,bidsReceived):getDealBids(adUnitCodes,bidsReceived)).concat(getAdUnitTargeting(adUnitCodes));targeting.map(function(adUnitCode){Object.keys(adUnitCode).map(function(key){adUnitCode[key].map(function(targetKey){if(pbTargetingKeys.indexOf(Object.keys(targetKey)[0])===-1){pbTargetingKeys=Object.keys(targetKey).concat(pbTargetingKeys);}});});});var defaultKeys=Object.keys(_extends({},_constants_json__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_TARGETING_KEYS,_constants_json__WEBPACK_IMPORTED_MODULE_0__.NATIVE_KEYS));var allowedKeys=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig(CFG_ALLOW_TARGETING_KEYS);var addedKeys=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig(CFG_ADD_TARGETING_KEYS);if(addedKeys!=null&&allowedKeys!=null){throw new Error(TARGETING_KEY_CONFIGURATION_ERROR_MSG);}else if(addedKeys!=null){allowedKeys=defaultKeys.concat(addedKeys);}else{allowedKeys=allowedKeys||defaultKeys;}
if(Array.isArray(allowedKeys)&&allowedKeys.length>0){targeting=getAllowedTargetingKeyValues(targeting,allowedKeys);}
targeting=flattenTargeting(targeting);var auctionKeysThreshold=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('targetingControls.auctionKeyMaxChars');if(auctionKeysThreshold){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("Detected 'targetingControls.auctionKeyMaxChars' was active for this auction; set with a limit of ".concat(auctionKeysThreshold," characters.  Running checks on auction keys..."));targeting=filterTargetingKeys(targeting,auctionKeysThreshold);}
adUnitCodes.forEach(function(code){if(!targeting[code]){targeting[code]={};}});return targeting;};_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('targetingControls',function(config){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(config,CFG_ALLOW_TARGETING_KEYS)!=null&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(config,CFG_ADD_TARGETING_KEYS)!=null){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(TARGETING_KEY_CONFIGURATION_ERROR_MSG);}});function convertKeysToQueryForm(keyMap){return Object.keys(keyMap).reduce(function(queryString,key){var encodedKeyPair="".concat(key,"%3d").concat(encodeURIComponent(keyMap[key]),"%26");return queryString+=encodedKeyPair;},'');}
function filterTargetingKeys(targeting,auctionKeysThreshold){var targetingCopy=(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(targeting);var targetingMap=Object.keys(targetingCopy).map(function(adUnitCode){return{adUnitCode:adUnitCode,adserverTargeting:targetingCopy[adUnitCode]};}).sort(sortByDealAndPriceBucketOrCpm());return targetingMap.reduce(function(accMap,currMap,index,arr){var adUnitQueryString=convertKeysToQueryForm(currMap.adserverTargeting);if(index+1===arr.length){adUnitQueryString=adUnitQueryString.slice(0,-3);}
var code=currMap.adUnitCode;var querySize=adUnitQueryString.length;if(querySize<=auctionKeysThreshold){auctionKeysThreshold-=querySize;(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("AdUnit '".concat(code,"' auction keys comprised of ").concat(querySize," characters.  Deducted from running threshold; new limit is ").concat(auctionKeysThreshold),targetingCopy[code]);accMap[code]=targetingCopy[code];}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("The following keys for adUnitCode '".concat(code,"' exceeded the current limit of the 'auctionKeyMaxChars' setting.\nThe key-set size was ").concat(querySize,", the current allotted amount was ").concat(auctionKeysThreshold,".\n"),targetingCopy[code]);}
if(index+1===arr.length&&Object.keys(accMap).length===0){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('No auction targeting keys were permitted due to the setting in setConfig(targetingControls.auctionKeyMaxChars).  Please review setup and consider adjusting.');}
return accMap;},{});}
function flattenTargeting(targeting){var targetingObj=targeting.map(function(targeting){return _defineProperty({},Object.keys(targeting)[0],targeting[Object.keys(targeting)[0]].map(function(target){return _defineProperty({},Object.keys(target)[0],target[Object.keys(target)[0]].join(','));}).reduce(function(p,c){return _extends(c,p);},{}));}).reduce(function(accumulator,targeting){var key=Object.keys(targeting)[0];accumulator[key]=_extends({},accumulator[key],targeting[key]);return accumulator;},{});return targetingObj;}
targeting.setTargetingForGPT=function(targetingConfig,customSlotMatching){window.googletag.pubads().getSlots().forEach(function(slot){Object.keys(targetingConfig).filter(customSlotMatching?customSlotMatching(slot):(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isAdUnitCodeMatchingSlot)(slot)).forEach(function(targetId){Object.keys(targetingConfig[targetId]).forEach(function(key){var value=targetingConfig[targetId][key];if(typeof value==='string'&&value.indexOf(',')!==-1){value=value.split(',');}
targetingConfig[targetId][key]=value;});(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("Attempting to set targeting-map for slot: ".concat(slot.getSlotElementId()," with targeting-map:"),targetingConfig[targetId]);slot.updateTargetingFromMap(targetingConfig[targetId]);});});};function getAdUnitCodes(adUnitCode){if(typeof adUnitCode==='string'){return[adUnitCode];}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(adUnitCode)){return adUnitCode;}
return auctionManager.getAdUnitCodes()||[];}
function getBidsReceived(){var bidsReceived=auctionManager.getBidsReceived();if(!_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('useBidCache')){bidsReceived=bidsReceived.filter(function(bid){return latestAuctionForAdUnit[bid.adUnitCode]===bid.auctionId;});}else{var filterFunction=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('bidCacheFilterFunction');if(typeof filterFunction==='function'){bidsReceived=bidsReceived.filter(function(bid){return latestAuctionForAdUnit[bid.adUnitCode]===bid.auctionId||!!filterFunction(bid);});}}
bidsReceived=bidsReceived.filter(function(bid){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(bid,'video.context')!==_mediaTypes_js__WEBPACK_IMPORTED_MODULE_7__.ADPOD;}).filter(function(bid){return bid.mediaType!=='banner'||(0,_sizeMapping_js__WEBPACK_IMPORTED_MODULE_8__.sizeSupported)([bid.width,bid.height]);}).filter(filters.isUnusedBid).filter(filters.isBidNotExpired);return getHighestCpmBidsFromBidPool(bidsReceived,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getOldestHighestCpmBid);}
targeting.getWinningBids=function(adUnitCode){var bidsReceived=arguments.length>1&&arguments[1]!==undefined?arguments[1]:getBidsReceived();var adUnitCodes=getAdUnitCodes(adUnitCode);return bidsReceived.filter(function(bid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(adUnitCodes,bid.adUnitCode);}).filter(function(bid){return _bidderSettings_js__WEBPACK_IMPORTED_MODULE_9__.bidderSettings.get(bid.bidderCode,'allowZeroCpmBids')===true?bid.cpm>=0:bid.cpm>0;}).map(function(bid){return bid.adUnitCode;}).filter(_utils_js__WEBPACK_IMPORTED_MODULE_1__.uniques).map(function(adUnitCode){return bidsReceived.filter(function(bid){return bid.adUnitCode===adUnitCode?bid:null;}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_1__.getHighestCpm);});};targeting.setTargetingForAst=function(adUnitCodes){var astTargeting=targeting.getAllTargeting(adUnitCodes);try{targeting.resetPresetTargetingAST(adUnitCodes);}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('unable to reset targeting for AST'+e);}
Object.keys(astTargeting).forEach(function(targetId){return Object.keys(astTargeting[targetId]).forEach(function(key){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("Attempting to set targeting for targetId: ".concat(targetId," key: ").concat(key," value: ").concat(astTargeting[targetId][key]));if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(astTargeting[targetId][key])||(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(astTargeting[targetId][key])){var keywordsObj={};var regex=/pt[0-9]/;if(key.search(regex)<0){keywordsObj[key.toUpperCase()]=astTargeting[targetId][key];}else{keywordsObj[key]=astTargeting[targetId][key];}
window.apntag.setKeywords(targetId,keywordsObj,{overrideKeyValue:true});}});});};function getWinningBidTargeting(adUnitCodes,bidsReceived){var winners=targeting.getWinningBids(adUnitCodes,bidsReceived);var standardKeys=getStandardKeys();winners=winners.map(function(winner){return _defineProperty({},winner.adUnitCode,Object.keys(winner.adserverTargeting).filter(function(key){return typeof winner.sendStandardTargeting==='undefined'||winner.sendStandardTargeting||standardKeys.indexOf(key)===-1;}).reduce(function(acc,key){var targetingValue=[winner.adserverTargeting[key]];var targeting=_defineProperty({},key.substring(0,MAX_DFP_KEYLENGTH),targetingValue);if(key===_constants_json__WEBPACK_IMPORTED_MODULE_0__.TARGETING_KEYS.DEAL){var bidderCodeTargetingKey="".concat(key,"_").concat(winner.bidderCode).substring(0,MAX_DFP_KEYLENGTH);var bidderCodeTargeting=_defineProperty({},bidderCodeTargetingKey,targetingValue);return[].concat(_toConsumableArray(acc),[targeting,bidderCodeTargeting]);}
return[].concat(_toConsumableArray(acc),[targeting]);},[]));});return winners;}
function getStandardKeys(){return auctionManager.getStandardBidderAdServerTargeting().map(function(targeting){return targeting.key;}).concat(TARGETING_KEYS).filter(_utils_js__WEBPACK_IMPORTED_MODULE_1__.uniques);}
function mergeAdServerTargeting(acc,bid,index,arr){function concatTargetingValue(key){return function(currentBidElement){if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(currentBidElement.adserverTargeting[key])){currentBidElement.adserverTargeting[key]=[currentBidElement.adserverTargeting[key]];}
currentBidElement.adserverTargeting[key]=currentBidElement.adserverTargeting[key].concat(bid.adserverTargeting[key]).filter(_utils_js__WEBPACK_IMPORTED_MODULE_1__.uniques);delete bid.adserverTargeting[key];};}
function hasSameAdunitCodeAndKey(key){return function(currentBidElement){return currentBidElement.adUnitCode===bid.adUnitCode&&currentBidElement.adserverTargeting[key];};}
Object.keys(bid.adserverTargeting).filter(getCustomKeys()).forEach(function(key){if(acc.length){acc.filter(hasSameAdunitCodeAndKey(key)).forEach(concatTargetingValue(key));}});acc.push(bid);return acc;}
function getCustomKeys(){var standardKeys=getStandardKeys().concat(_native_js__WEBPACK_IMPORTED_MODULE_5__.NATIVE_TARGETING_KEYS);return function(key){return standardKeys.indexOf(key)===-1;};}
function truncateCustomKeys(bid){return _defineProperty({},bid.adUnitCode,Object.keys(bid.adserverTargeting).filter(getCustomKeys()).map(function(key){return _defineProperty({},key.substring(0,MAX_DFP_KEYLENGTH),[bid.adserverTargeting[key]]);}));}
function getCustomBidTargeting(adUnitCodes,bidsReceived){return bidsReceived.filter(function(bid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(adUnitCodes,bid.adUnitCode);}).map(function(bid){return _extends({},bid);}).reduce(mergeAdServerTargeting,[]).map(truncateCustomKeys).filter(function(bid){return bid;});}
function getBidLandscapeTargeting(adUnitCodes,bidsReceived){var standardKeys=TARGETING_KEYS.concat(_native_js__WEBPACK_IMPORTED_MODULE_5__.NATIVE_TARGETING_KEYS);var adUnitBidLimit=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('sendBidsControl.bidLimit');var bids=getHighestCpmBidsFromBidPool(bidsReceived,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getHighestCpm,adUnitBidLimit);var allowSendAllBidsTargetingKeys=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('targetingControls.allowSendAllBidsTargetingKeys');var allowedSendAllBidTargeting=allowSendAllBidsTargetingKeys?allowSendAllBidsTargetingKeys.map(function(key){return _constants_json__WEBPACK_IMPORTED_MODULE_0__.TARGETING_KEYS[key];}):standardKeys;return bids.map(function(bid){if(bidShouldBeAddedToTargeting(bid,adUnitCodes)){return _defineProperty({},bid.adUnitCode,getTargetingMap(bid,standardKeys.filter(function(key){return typeof bid.adserverTargeting[key]!=='undefined'&&allowedSendAllBidTargeting.indexOf(key)!==-1;})));}}).filter(function(bid){return bid;});}
function getTargetingMap(bid,keys){return keys.map(function(key){return _defineProperty({},"".concat(key,"_").concat(bid.bidderCode).substring(0,MAX_DFP_KEYLENGTH),[bid.adserverTargeting[key]]);});}
function getAdUnitTargeting(adUnitCodes){function getTargetingObj(adUnit){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(adUnit,_constants_json__WEBPACK_IMPORTED_MODULE_0__.JSON_MAPPING.ADSERVER_TARGETING);}
function getTargetingValues(adUnit){var aut=getTargetingObj(adUnit);return Object.keys(aut).map(function(key){if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(aut[key]))aut[key]=aut[key].split(',').map(function(s){return s.trim();});if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(aut[key]))aut[key]=[aut[key]];return _defineProperty({},key,aut[key]);});}
return auctionManager.getAdUnits().filter(function(adUnit){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(adUnitCodes,adUnit.code)&&getTargetingObj(adUnit);}).map(function(adUnit){return _defineProperty({},adUnit.code,getTargetingValues(adUnit));});}
targeting.isApntagDefined=function(){if(window.apntag&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(window.apntag.setKeywords)){return true;}};return targeting;}
var targeting=newTargeting(_auctionManager_js__WEBPACK_IMPORTED_MODULE_10__.auctionManager);}),"./src/userSync.js":
/*!*************************!*\
  !*** ./src/userSync.js ***!
  \*************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"userSync":function(){return userSync;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _storageManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./storageManager.js */
"./src/storageManager.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var USERSYNC_DEFAULT_CONFIG={syncEnabled:true,filterSettings:{image:{bidders:'*',filter:'include'}},syncsPerBidder:5,syncDelay:3000,auctionDelay:0};_config_js__WEBPACK_IMPORTED_MODULE_0__.config.setDefaults({'userSync':(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.deepClone)(USERSYNC_DEFAULT_CONFIG)});var storage=(0,_storageManager_js__WEBPACK_IMPORTED_MODULE_2__.getCoreStorageManager)('usersync');function newUserSync(userSyncDependencies){var publicApi={};var queue=getDefaultQueue();var hasFiredBidder=new Set();var numAdapterBids={};var permittedPixels={image:true,iframe:false};var usConfig=userSyncDependencies.config;_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('userSync',function(conf){if(conf.userSync){var fs=conf.userSync.filterSettings;if((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(fs)){if(!fs.image&&!fs.all){conf.userSync.filterSettings.image={bidders:'*',filter:'include'};}}}
usConfig=_extends(usConfig,conf.userSync);});function getDefaultQueue(){return{image:[],iframe:[]};}
function fireSyncs(){if(!usConfig.syncEnabled||!userSyncDependencies.browserSupportsCookies){return;}
try{loadIframes();fireImagePixels();}catch(e){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Error firing user syncs',e);}
queue=getDefaultQueue();}
function forEachFire(queue,fn){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.shuffle)(queue).forEach(function(sync){fn(sync);hasFiredBidder.add(sync[0]);});}
function fireImagePixels(){if(!permittedPixels.image){return;}
forEachFire(queue.image,function(sync){var _sync=_slicedToArray(sync,2),bidderName=_sync[0],trackingPixelUrl=_sync[1];(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("Invoking image pixel user sync for bidder: ".concat(bidderName));(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.triggerPixel)(trackingPixelUrl);});}
function loadIframes(){if(!permittedPixels.iframe){return;}
forEachFire(queue.iframe,function(sync){var _sync2=_slicedToArray(sync,2),bidderName=_sync2[0],iframeUrl=_sync2[1];(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("Invoking iframe user sync for bidder: ".concat(bidderName));(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.insertUserSyncIframe)(iframeUrl);removeImagePixelsForBidder(queue,bidderName);});}
function removeImagePixelsForBidder(queue,iframeSyncBidderName){queue.image=queue.image.filter(function(imageSync){var imageSyncBidderName=imageSync[0];return imageSyncBidderName!==iframeSyncBidderName;});}
function incrementAdapterBids(numAdapterBids,bidder){if(!numAdapterBids[bidder]){numAdapterBids[bidder]=1;}else{numAdapterBids[bidder]+=1;}
return numAdapterBids;}
publicApi.registerSync=function(type,bidder,url){if(hasFiredBidder.has(bidder)){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)("already fired syncs for \"".concat(bidder,"\", ignoring registerSync call"));}
if(!usConfig.syncEnabled||!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(queue[type])){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("User sync type \"".concat(type,"\" not supported"));}
if(!bidder){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Bidder is required for registering sync");}
if(usConfig.syncsPerBidder!==0&&Number(numAdapterBids[bidder])>=usConfig.syncsPerBidder){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Number of user syncs exceeded for \"".concat(bidder,"\""));}
var canBidderRegisterSync=publicApi.canBidderRegisterSync(type,bidder);if(!canBidderRegisterSync){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Bidder \"".concat(bidder,"\" not permitted to register their \"").concat(type,"\" userSync pixels."));}
queue[type].push([bidder,url]);numAdapterBids=incrementAdapterBids(numAdapterBids,bidder);};function shouldBidderBeBlocked(type,bidder){var filterConfig=usConfig.filterSettings;if(isFilterConfigValid(filterConfig,type)){permittedPixels[type]=true;var activeConfig=filterConfig.all?filterConfig.all:filterConfig[type];var biddersToFilter=activeConfig.bidders==='*'?[bidder]:activeConfig.bidders;var filterType=activeConfig.filter||'include';var checkForFiltering={'include':function include(bidders,bidder){return!(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_3__.includes)(bidders,bidder);},'exclude':function exclude(bidders,bidder){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_3__.includes)(bidders,bidder);}};return checkForFiltering[filterType](biddersToFilter,bidder);}
return!permittedPixels[type];}
function isFilterConfigValid(filterConfig,type){if(filterConfig.all&&filterConfig[type]){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Detected presence of the \"filterSettings.all\" and \"filterSettings.".concat(type,"\" in userSync config.  You cannot mix \"all\" with \"iframe/image\" configs; they are mutually exclusive."));return false;}
var activeConfig=filterConfig.all?filterConfig.all:filterConfig[type];var activeConfigName=filterConfig.all?'all':type;if(!activeConfig){return false;}
var filterField=activeConfig.filter;var biddersField=activeConfig.bidders;if(filterField&&filterField!=='include'&&filterField!=='exclude'){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("UserSync \"filterSettings.".concat(activeConfigName,".filter\" setting '").concat(filterField,"' is not a valid option; use either 'include' or 'exclude'."));return false;}
if(biddersField!=='*'&&!(Array.isArray(biddersField)&&biddersField.length>0&&biddersField.every(function(bidderInList){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(bidderInList)&&bidderInList!=='*';}))){(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Detected an invalid setup in userSync \"filterSettings.".concat(activeConfigName,".bidders\"; use either '*' (to represent all bidders) or an array of bidders."));return false;}
return true;}
publicApi.syncUsers=function(){var timeout=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(timeout){return setTimeout(fireSyncs,Number(timeout));}
fireSyncs();};publicApi.triggerUserSyncs=function(){if(usConfig.enableOverride){publicApi.syncUsers();}};publicApi.canBidderRegisterSync=function(type,bidder){if(usConfig.filterSettings){if(shouldBidderBeBlocked(type,bidder)){return false;}}
return true;};return publicApi;}
var browserSupportsCookies=!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isSafariBrowser)()&&storage.cookiesAreEnabled();var userSync=newUserSync({config:_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('userSync'),browserSupportsCookies:browserSupportsCookies});}),"./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{"_each":function(){return _each;},"_map":function(){return _map;},"_setEventEmitter":function(){return _setEventEmitter;},"adUnitsFilter":function(){return adUnitsFilter;},"bind":function(){return bind;},"buildUrl":function(){return buildUrl;},"callBurl":function(){return callBurl;},"checkCookieSupport":function(){return checkCookieSupport;},"chunk":function(){return chunk;},"cleanObj":function(){return cleanObj;},"compareOn":function(){return compareOn;},"contains":function(){return contains;},"convertCamelToUnderscore":function(){return convertCamelToUnderscore;},"convertTypes":function(){return convertTypes;},"createInvisibleIframe":function(){return createInvisibleIframe;},"createTrackPixelHtml":function(){return createTrackPixelHtml;},"createTrackPixelIframeHtml":function(){return createTrackPixelIframeHtml;},"cyrb53Hash":function(){return cyrb53Hash;},"debugTurnedOn":function(){return debugTurnedOn;},"deepAccess":function(){return dlv_index_js__WEBPACK_IMPORTED_MODULE_1__["default"];},"deepClone":function(){return deepClone;},"deepEqual":function(){return deepEqual;},"deepSetValue":function(){return dset__WEBPACK_IMPORTED_MODULE_2__["default"];},"delayExecution":function(){return delayExecution;},"fill":function(){return fill;},"flatten":function(){return flatten;},"formatQS":function(){return formatQS;},"generateUUID":function(){return generateUUID;},"getAdUnitSizes":function(){return getAdUnitSizes;},"getBidIdParameter":function(){return getBidIdParameter;},"getBidRequest":function(){return getBidRequest;},"getBidderCodes":function(){return getBidderCodes;},"getDNT":function(){return getDNT;},"getDefinedParams":function(){return getDefinedParams;},"getGptSlotInfoForAdUnitCode":function(){return getGptSlotInfoForAdUnitCode;},"getHighestCpm":function(){return getHighestCpm;},"getKeyByValue":function(){return getKeyByValue;},"getKeys":function(){return getKeys;},"getLatestHighestCpmBid":function(){return getLatestHighestCpmBid;},"getMaxValueFromArray":function(){return getMaxValueFromArray;},"getMinValueFromArray":function(){return getMinValueFromArray;},"getOldestHighestCpmBid":function(){return getOldestHighestCpmBid;},"getOrigin":function(){return getOrigin;},"getParameterByName":function(){return getParameterByName;},"getPerformanceNow":function(){return getPerformanceNow;},"getPrebidInternal":function(){return getPrebidInternal;},"getUniqueIdentifierStr":function(){return getUniqueIdentifierStr;},"getUserConfiguredParams":function(){return getUserConfiguredParams;},"getValue":function(){return getValue;},"getValueString":function(){return getValueString;},"getWindowFromDocument":function(){return getWindowFromDocument;},"getWindowLocation":function(){return getWindowLocation;},"getWindowSelf":function(){return getWindowSelf;},"getWindowTop":function(){return getWindowTop;},"groupBy":function(){return groupBy;},"hasConsoleLogger":function(){return hasConsoleLogger;},"hasDeviceAccess":function(){return hasDeviceAccess;},"hasOwn":function(){return hasOwn;},"inIframe":function(){return inIframe;},"insertElement":function(){return insertElement;},"insertHtmlIntoIframe":function(){return insertHtmlIntoIframe;},"insertUserSyncIframe":function(){return insertUserSyncIframe;},"internal":function(){return internal;},"isA":function(){return isA;},"isAdUnitCodeMatchingSlot":function(){return isAdUnitCodeMatchingSlot;},"isApnGetTagDefined":function(){return isApnGetTagDefined;},"isArray":function(){return isArray;},"isArrayOfNums":function(){return isArrayOfNums;},"isBoolean":function(){return isBoolean;},"isEmpty":function(){return isEmpty;},"isEmptyStr":function(){return isEmptyStr;},"isFn":function(){return isFn;},"isGptPubadsDefined":function(){return isGptPubadsDefined;},"isInteger":function(){return isInteger;},"isNumber":function(){return isNumber;},"isPlainObject":function(){return isPlainObject;},"isSafariBrowser":function(){return isSafariBrowser;},"isSlotMatchingAdUnitCode":function(){return isSlotMatchingAdUnitCode;},"isStr":function(){return isStr;},"isValidMediaTypes":function(){return isValidMediaTypes;},"logError":function(){return logError;},"logInfo":function(){return logInfo;},"logMessage":function(){return logMessage;},"logWarn":function(){return logWarn;},"mergeDeep":function(){return mergeDeep;},"parseGPTSingleSizeArray":function(){return parseGPTSingleSizeArray;},"parseGPTSingleSizeArrayToRtbSize":function(){return parseGPTSingleSizeArrayToRtbSize;},"parseQS":function(){return parseQS;},"parseQueryStringParameters":function(){return parseQueryStringParameters;},"parseSizesInput":function(){return parseSizesInput;},"parseUrl":function(){return parseUrl;},"pick":function(){return pick;},"prefixLog":function(){return prefixLog;},"replaceAuctionPrice":function(){return replaceAuctionPrice;},"replaceClickThrough":function(){return replaceClickThrough;},"safeJSONParse":function(){return safeJSONParse;},"shuffle":function(){return shuffle;},"timestamp":function(){return timestamp;},"transformAdServerTargetingObj":function(){return transformAdServerTargetingObj;},"transformBidderParamKeywords":function(){return transformBidderParamKeywords;},"triggerPixel":function(){return triggerPixel;},"tryAppendQueryString":function(){return tryAppendQueryString;},"uniques":function(){return uniques;},"unsupportedBidderMessage":function(){return unsupportedBidderMessage;},"waitForElementToLoad":function(){return waitForElementToLoad;}});var _config_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var just_clone__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! just-clone */
"./node_modules/just-clone/index.js");var just_clone__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(just_clone__WEBPACK_IMPORTED_MODULE_0__);var _polyfill_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _constants_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");var dlv_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! dlv/index.js */
"./node_modules/dlv/index.js");var dset__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! dset */
"./node_modules/dset/dist/dset.es.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var tArr='Array';var tStr='String';var tFn='Function';var tNumb='Number';var tObject='Object';var tBoolean='Boolean';var toString=Object.prototype.toString;var consoleExists=Boolean(window.console);var consoleLogExists=Boolean(consoleExists&&window.console.log);var consoleInfoExists=Boolean(consoleExists&&window.console.info);var consoleWarnExists=Boolean(consoleExists&&window.console.warn);var consoleErrorExists=Boolean(consoleExists&&window.console.error);var eventEmitter;function _setEventEmitter(emitFn){eventEmitter=emitFn;}
function emitEvent(){if(eventEmitter!=null){eventEmitter.apply(void 0,arguments);}}
var internal={checkCookieSupport:checkCookieSupport,createTrackPixelIframeHtml:createTrackPixelIframeHtml,getWindowSelf:getWindowSelf,getWindowTop:getWindowTop,getWindowLocation:getWindowLocation,insertUserSyncIframe:insertUserSyncIframe,insertElement:insertElement,isFn:isFn,triggerPixel:triggerPixel,logError:logError,logWarn:logWarn,logMessage:logMessage,logInfo:logInfo,parseQS:parseQS,formatQS:formatQS,deepEqual:deepEqual};var prebidInternal={};function getPrebidInternal(){return prebidInternal;}
var uniqueRef={};var bind=function(a,b){return b;}.bind(null,1,uniqueRef)()===uniqueRef?Function.prototype.bind:function(bind){var self=this;var args=Array.prototype.slice.call(arguments,1);return function(){return self.apply(bind,args.concat(Array.prototype.slice.call(arguments)));};};var getIncrementalInteger=function(){var count=0;return function(){};}();function getUniqueIdentifierStr(){return getIncrementalInteger()+Math.random().toString(16).substr(2);}
function generateUUID(placeholder){return placeholder?(placeholder^_getRandomData()>>placeholder/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,generateUUID);}
function _getRandomData(){if(window&&window.crypto&&window.crypto.getRandomValues){return crypto.getRandomValues(new Uint8Array(1))[0]%16;}else{return Math.random()*16;}}
function getBidIdParameter(key,paramsObj){if(paramsObj&&paramsObj[key]){return paramsObj[key];}
return'';}
function tryAppendQueryString(existingUrl,key,value){if(value){return existingUrl+key+'='+encodeURIComponent(value)+'&';}
return existingUrl;}
function parseQueryStringParameters(queryObj){var result='';for(var k in queryObj){if(queryObj.hasOwnProperty(k)){result+=k+'='+encodeURIComponent(queryObj[k])+'&';}}
result=result.replace(/&$/,'');return result;}
function transformAdServerTargetingObj(targeting){if(targeting&&Object.getOwnPropertyNames(targeting).length>0){return getKeys(targeting).map(function(key){return"".concat(key,"=").concat(encodeURIComponent(getValue(targeting,key)));}).join('&');}else{return'';}}
function getAdUnitSizes(adUnit){if(!adUnit){return;}
var sizes=[];if(adUnit.mediaTypes&&adUnit.mediaTypes.banner&&Array.isArray(adUnit.mediaTypes.banner.sizes)){var bannerSizes=adUnit.mediaTypes.banner.sizes;if(Array.isArray(bannerSizes[0])){sizes=bannerSizes;}else{sizes.push(bannerSizes);}}else if(Array.isArray(adUnit.sizes)){if(Array.isArray(adUnit.sizes[0])){sizes=adUnit.sizes;}else{sizes.push(adUnit.sizes);}}
return sizes;}
function parseSizesInput(sizeObj){var parsedSizes=[];if(typeof sizeObj==='string'){var sizes=sizeObj.split(',');var sizeRegex=/^(\d)+x(\d)+$/i;if(sizes){for(var curSizePos in sizes){if(hasOwn(sizes,curSizePos)&&sizes[curSizePos].match(sizeRegex)){parsedSizes.push(sizes[curSizePos]);}}}}else if(_typeof(sizeObj)==='object'){var sizeArrayLength=sizeObj.length;if(sizeArrayLength>0){if(sizeArrayLength===2&&typeof sizeObj[0]==='number'&&typeof sizeObj[1]==='number'){parsedSizes.push(parseGPTSingleSizeArray(sizeObj));}else{for(var i=0;i<sizeArrayLength;i++){parsedSizes.push(parseGPTSingleSizeArray(sizeObj[i]));}}}}
return parsedSizes;}
function parseGPTSingleSizeArray(singleSize){if(isValidGPTSingleSize(singleSize)){return singleSize[0]+'x'+singleSize[1];}}
function parseGPTSingleSizeArrayToRtbSize(singleSize){if(isValidGPTSingleSize(singleSize)){return{w:singleSize[0],h:singleSize[1]};}}
function isValidGPTSingleSize(singleSize){return isArray(singleSize)&&singleSize.length===2&&!isNaN(singleSize[0])&&!isNaN(singleSize[1]);}
function getWindowTop(){return window.top;}
function getWindowSelf(){return window.self;}
function getWindowLocation(){return window.location;}
function logMessage(){if(window.PbhAdUnit&&window.PbhAdUnit.add_debug_log){PbhAdUnit.add_debug_log(['prebid'].concat(arguments));}
if(debugTurnedOn()&&consoleLogExists){console.log.apply(console,decorateLog(arguments,'MESSAGE:'));}}
function logInfo(){if(window.PbhAdUnit&&window.PbhAdUnit.add_debug_log){PbhAdUnit.add_debug_log(['prebid'].concat(arguments));}
if(debugTurnedOn()&&consoleInfoExists){console.info.apply(console,decorateLog(arguments,'INFO:'));}}
function logWarn(){if(window.PbhAdUnit&&window.PbhAdUnit.add_debug_log){PbhAdUnit.add_debug_log(['prebid'].concat(arguments));}
if(debugTurnedOn()&&consoleWarnExists){console.warn.apply(console,decorateLog(arguments,'WARNING:'));}
emitEvent(_constants_json__WEBPACK_IMPORTED_MODULE_3__.EVENTS.AUCTION_DEBUG,{type:'WARNING',arguments:arguments});}
function logError(){if(window.PbhAdUnit&&window.PbhAdUnit.add_debug_log){PbhAdUnit.add_debug_log(['prebid'].concat(arguments));}
if(consoleErrorExists){console.error.apply(console,decorateLog(arguments,'ERROR:'));}
emitEvent(_constants_json__WEBPACK_IMPORTED_MODULE_3__.EVENTS.AUCTION_DEBUG,{type:'ERROR',arguments:arguments});}
function prefixLog(prefix){function decorate(fn){return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
fn.apply(void 0,[prefix].concat(args));};}
return{logError:decorate(logError),logWarn:decorate(logWarn),logMessage:decorate(logMessage),logInfo:decorate(logInfo)};}
function decorateLog(args,prefix){args=[].slice.call(args);var bidder=_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getCurrentBidder();prefix&&args.unshift(prefix);if(bidder){args.unshift(label('#aaa'));}
args.unshift(label('#3b88c3'));args.unshift('%cPrebid'+(bidder?"%c".concat(bidder):''));return args;function label(color){return"display: inline-block; color: #fff; background: ".concat(color,"; padding: 1px 4px; border-radius: 3px;");}}
function hasConsoleLogger(){return consoleLogExists;}
function debugTurnedOn(){return!!_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('debug');}
function createInvisibleIframe(){var f=document.createElement('iframe');f.id=getUniqueIdentifierStr();f.height=0;f.width=0;f.border='0px';f.hspace='0';f.vspace='0';f.marginWidth='0';f.marginHeight='0';f.style.border='0';f.scrolling='no';f.frameBorder='0';f.src='about:blank';f.style.display='none';return f;}
function getParameterByName(name){return parseQS(getWindowLocation().search)[name]||'';}
function isA(object,_t){return toString.call(object)==='[object '+_t+']';}
function isFn(object){return isA(object,tFn);}
function isStr(object){return isA(object,tStr);}
function isArray(object){return isA(object,tArr);}
function isNumber(object){return isA(object,tNumb);}
function isPlainObject(object){return isA(object,tObject);}
function isBoolean(object){return isA(object,tBoolean);}
function isEmpty(object){if(!object)return true;if(isArray(object)||isStr(object)){return!(object.length>0);}
for(var k in object){if(hasOwnProperty.call(object,k))return false;}
return true;}
function isEmptyStr(str){return isStr(str)&&(!str||str.length===0);}
function _each(object,fn){if(isEmpty(object))return;if(isFn(object.forEach))return object.forEach(fn,this);var k=0;var l=object.length;if(l>0){for(;k<l;k++){fn(object[k],k,object);}}else{for(k in object){if(hasOwnProperty.call(object,k))fn.call(this,object[k],k);}}}
function contains(a,obj){if(isEmpty(a)){return false;}
if(isFn(a.indexOf)){return a.indexOf(obj)!==-1;}
var i=a.length;while(i--){if(a[i]===obj){return true;}}
return false;}
function _map(object,callback){if(isEmpty(object))return[];if(isFn(object.map))return object.map(callback);var output=[];_each(object,function(value,key){output.push(callback(value,key,object));});return output;}
function hasOwn(objectToCheck,propertyToCheckFor){if(objectToCheck.hasOwnProperty){return objectToCheck.hasOwnProperty(propertyToCheckFor);}else{return typeof objectToCheck[propertyToCheckFor]!=='undefined'&&objectToCheck.constructor.prototype[propertyToCheckFor]!==objectToCheck[propertyToCheckFor];}};function insertElement(elm,doc,target,asLastChildChild){doc=doc||document;var parentEl;if(target){parentEl=doc.getElementsByTagName(target);}else{parentEl=doc.getElementsByTagName('head');}
try{parentEl=parentEl.length?parentEl:doc.getElementsByTagName('body');if(parentEl.length){parentEl=parentEl[0];var insertBeforeEl=asLastChildChild?null:parentEl.firstChild;return parentEl.insertBefore(elm,insertBeforeEl);}}catch(e){}}
function waitForElementToLoad(element,timeout){var timer=null;return new Promise(function(resolve){var onLoad=function onLoad(){element.removeEventListener('load',onLoad);element.removeEventListener('error',onLoad);if(timer!=null){window.clearTimeout(timer);}
resolve();};element.addEventListener('load',onLoad);element.addEventListener('error',onLoad);if(timeout!=null){timer=window.setTimeout(onLoad,timeout);}});}
function triggerPixel(url,done,timeout){var img=new Image();if(done&&internal.isFn(done)){waitForElementToLoad(img,timeout).then(done);}
img.src=url;}
function callBurl(_ref){var source=_ref.source,burl=_ref.burl;if(source===_constants_json__WEBPACK_IMPORTED_MODULE_3__.S2S.SRC&&burl){internal.triggerPixel(burl);}}
function insertHtmlIntoIframe(htmlCode){if(!htmlCode){return;}
var iframe=document.createElement('iframe');iframe.id=getUniqueIdentifierStr();iframe.width=0;iframe.height=0;iframe.hspace='0';iframe.vspace='0';iframe.marginWidth='0';iframe.marginHeight='0';iframe.style.display='none';iframe.style.height='0px';iframe.style.width='0px';iframe.scrolling='no';iframe.frameBorder='0';iframe.allowtransparency='true';internal.insertElement(iframe,document,'body');iframe.contentWindow.document.open();iframe.contentWindow.document.write(htmlCode);iframe.contentWindow.document.close();}
function insertUserSyncIframe(url,done,timeout){var iframeHtml=internal.createTrackPixelIframeHtml(url,false,'allow-scripts allow-same-origin');var div=document.createElement('div');div.innerHTML=iframeHtml;var iframe=div.firstChild;if(done&&internal.isFn(done)){waitForElementToLoad(iframe,timeout).then(done);}
internal.insertElement(iframe,document,'html',true);}
function createTrackPixelHtml(url){if(!url){return'';}
var escapedUrl=encodeURI(url);var img='<div style="position:absolute;left:0px;top:0px;visibility:hidden;">';img+='<img src="'+escapedUrl+'"></div>';return img;};function createTrackPixelIframeHtml(url){var encodeUri=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var sandbox=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';if(!url){return'';}
if(encodeUri){url=encodeURI(url);}
if(sandbox){sandbox="sandbox=\"".concat(sandbox,"\"");}
return"<iframe ".concat(sandbox," id=\"").concat(getUniqueIdentifierStr(),"\"\n      frameborder=\"0\"\n      allowtransparency=\"true\"\n      marginheight=\"0\" marginwidth=\"0\"\n      width=\"0\" hspace=\"0\" vspace=\"0\" height=\"0\"\n      style=\"height:0px;width:0px;display:none;\"\n      scrolling=\"no\"\n      src=\"").concat(url,"\">\n    </iframe>");}
function getValueString(param,val,defaultValue){if(val===undefined||val===null){return defaultValue;}
if(isStr(val)){return val;}
if(isNumber(val)){return val.toString();}
internal.logWarn('Unsuported type for param: '+param+' required type: String');}
function uniques(value,index,arry){return arry.indexOf(value)===index;}
function flatten(a,b){return a.concat(b);}
function getBidRequest(id,bidderRequests){if(!id){return;}
var bidRequest;bidderRequests.some(function(bidderRequest){var result=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.find)(bidderRequest.bids,function(bid){return['bidId','adId','bid_id'].some(function(type){return bid[type]===id;});});if(result){bidRequest=result;}
return result;});return bidRequest;}
function getKeys(obj){return Object.keys(obj);}
function getValue(obj,key){return obj[key];}
function getKeyByValue(obj,value){for(var prop in obj){if(obj.hasOwnProperty(prop)){if(obj[prop]===value){return prop;}}}}
function getBidderCodes(){var adUnits=arguments.length>0&&arguments[0]!==undefined?arguments[0]:pbjs.adUnits;return adUnits.map(function(unit){return unit.bids.map(function(bid){return bid.bidder;}).reduce(flatten,[]);}).reduce(flatten,[]).filter(uniques);}
function isGptPubadsDefined(){if(window.googletag&&isFn(window.googletag.pubads)&&isFn(window.googletag.pubads().getSlots)){return true;}}
function isApnGetTagDefined(){if(window.apntag&&isFn(window.apntag.getTag)){return true;}}
var getHighestCpm=getHighestCpmCallback('timeToRespond',function(previous,current){return previous>current;});var getOldestHighestCpmBid=getHighestCpmCallback('responseTimestamp',function(previous,current){return previous>current;});var getLatestHighestCpmBid=getHighestCpmCallback('responseTimestamp',function(previous,current){return previous<current;});function getHighestCpmCallback(useTieBreakerProperty,tieBreakerCallback){return function(previous,current){if(previous.cpm===current.cpm){return tieBreakerCallback(previous[useTieBreakerProperty],current[useTieBreakerProperty])?current:previous;}
return previous.cpm<current.cpm?current:previous;};}
function shuffle(array){var counter=array.length;while(counter>0){var index=Math.floor(Math.random()*counter);counter--;var temp=array[counter];array[counter]=array[index];array[index]=temp;}
return array;}
function adUnitsFilter(filter,bid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(filter,bid&&bid.adUnitCode);}
function deepClone(obj){return just_clone__WEBPACK_IMPORTED_MODULE_0___default()(obj);}
function inIframe(){try{return internal.getWindowSelf()!==internal.getWindowTop();}catch(e){return true;}}
function isSafariBrowser(){return /^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent);}
function replaceAuctionPrice(str,cpm){if(!str)return;return str.replace(/\$\{AUCTION_PRICE\}/g,cpm);}
function replaceClickThrough(str,clicktag){if(!str||!clicktag||typeof clicktag!=='string')return;return str.replace(/\${CLICKTHROUGH}/g,clicktag);}
function timestamp(){return new Date().getTime();}
function getPerformanceNow(){return window.performance&&window.performance.now&&window.performance.now()||0;}
function hasDeviceAccess(){return _config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('deviceAccess')!==false;}
function checkCookieSupport(){if(window.navigator.cookieEnabled||!!document.cookie.length){return true;}}
function delayExecution(func,numRequiredCalls){if(numRequiredCalls<1){throw new Error("numRequiredCalls must be a positive number. Got ".concat(numRequiredCalls));}
var numCalls=0;return function(){numCalls++;if(numCalls===numRequiredCalls){func.apply(this,arguments);}};}
function groupBy(xs,key){return xs.reduce(function(rv,x){(rv[x[key]]=rv[x[key]]||[]).push(x);return rv;},{});}
function getDefinedParams(object,params){return params.filter(function(param){return object[param];}).reduce(function(bid,param){return _extends(bid,_defineProperty({},param,object[param]));},{});}
function isValidMediaTypes(mediaTypes){var SUPPORTED_MEDIA_TYPES=['banner','native','video'];var SUPPORTED_STREAM_TYPES=['instream','outstream','adpod'];var types=Object.keys(mediaTypes);if(!types.every(function(type){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(SUPPORTED_MEDIA_TYPES,type);})){return false;}
if(mediaTypes.video&&mediaTypes.video.context){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(SUPPORTED_STREAM_TYPES,mediaTypes.video.context);}
return true;}
function getUserConfiguredParams(adUnits,adUnitCode,bidder){return adUnits.filter(function(adUnit){return adUnit.code===adUnitCode;}).map(function(adUnit){return adUnit.bids;}).reduce(flatten,[]).filter(function(bidderData){return bidderData.bidder===bidder;}).map(function(bidderData){return bidderData.params||{};});}
function getOrigin(){if(!window.location.origin){return window.location.protocol+'//'+window.location.hostname+(window.location.port?':'+window.location.port:'');}else{return window.location.origin;}}
function getDNT(){return navigator.doNotTrack==='1'||window.doNotTrack==='1'||navigator.msDoNotTrack==='1'||navigator.doNotTrack==='yes';}
var compareCodeAndSlot=function compareCodeAndSlot(slot,adUnitCode){return slot.getAdUnitPath()===adUnitCode||slot.getSlotElementId()===adUnitCode;};function isAdUnitCodeMatchingSlot(slot){return function(adUnitCode){return compareCodeAndSlot(slot,adUnitCode);};}
function isSlotMatchingAdUnitCode(adUnitCode){return function(slot){return compareCodeAndSlot(slot,adUnitCode);};}
function getGptSlotInfoForAdUnitCode(adUnitCode){var matchingSlot;if(isGptPubadsDefined()){matchingSlot=(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.find)(window.googletag.pubads().getSlots(),isSlotMatchingAdUnitCode(adUnitCode));}
if(matchingSlot){return{gptSlot:matchingSlot.getAdUnitPath(),divId:matchingSlot.getSlotElementId()};}
return{};};function unsupportedBidderMessage(adUnit,bidder){var mediaType=Object.keys(adUnit.mediaTypes||{'banner':'banner'}).join(', ');return"\n    ".concat(adUnit.code," is a ").concat(mediaType," ad unit\n    containing bidders that don't support ").concat(mediaType,": ").concat(bidder,".\n    This bidder won't fetch demand.\n  ");}
function isInteger(value){if(Number.isInteger){return Number.isInteger(value);}else{return typeof value==='number'&&isFinite(value)&&Math.floor(value)===value;}}
function convertCamelToUnderscore(value){return value.replace(/(?:^|\.?)([A-Z])/g,function(x,y){return'_'+y.toLowerCase();}).replace(/^_/,'');}
function cleanObj(obj){return Object.keys(obj).reduce(function(newObj,key){if(typeof obj[key]!=='undefined'){newObj[key]=obj[key];}
return newObj;},{});}
function pick(obj,properties){if(_typeof(obj)!=='object'){return{};}
return properties.reduce(function(newObj,prop,i){if(typeof prop==='function'){return newObj;}
var newProp=prop;var match=prop.match(/^(.+?)\sas\s(.+?)$/i);if(match){prop=match[1];newProp=match[2];}
var value=obj[prop];if(typeof properties[i+1]==='function'){value=properties[i+1](value,newObj);}
if(typeof value!=='undefined'){newObj[newProp]=value;}
return newObj;},{});}
function transformBidderParamKeywords(keywords){var paramName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'keywords';var arrs=[];_each(keywords,function(v,k){if(isArray(v)){var values=[];_each(v,function(val){val=getValueString(paramName+'.'+k,val);if(val||val===''){values.push(val);}});v=values;}else{v=getValueString(paramName+'.'+k,v);if(isStr(v)){v=[v];}else{return;}}
arrs.push({key:k,value:v});});return arrs;}
function tryConvertType(typeToConvert,value){if(typeToConvert==='string'){return value&&value.toString();}else if(typeToConvert==='number'){return Number(value);}else{return value;}}
function convertTypes(types,params){Object.keys(types).forEach(function(key){if(params[key]){if(isFn(types[key])){params[key]=types[key](params[key]);}else{params[key]=tryConvertType(types[key],params[key]);}
if(isNaN(params[key])){delete params.key;}}});return params;}
function isArrayOfNums(val,size){return isArray(val)&&(size?val.length===size:true)&&val.every(function(v){return isInteger(v);});}
function fill(value,length){var newArray=[];for(var i=0;i<length;i++){var valueToPush=isPlainObject(value)?deepClone(value):value;newArray.push(valueToPush);}
return newArray;}
function chunk(array,size){var newArray=[];for(var i=0;i<Math.ceil(array.length/size);i++){var start=i*size;var end=start+size;newArray.push(array.slice(start,end));}
return newArray;}
function getMinValueFromArray(array){return Math.min.apply(Math,_toConsumableArray(array));}
function getMaxValueFromArray(array){return Math.max.apply(Math,_toConsumableArray(array));}
function compareOn(property){return function compare(a,b){if(a[property]<b[property]){return 1;}
if(a[property]>b[property]){return-1;}
return 0;};}
function parseQS(query){return!query?{}:query.replace(/^\?/,'').split('&').reduce(function(acc,criteria){var _criteria$split=criteria.split('='),_criteria$split2=_slicedToArray(_criteria$split,2),k=_criteria$split2[0],v=_criteria$split2[1];if(/\[\]$/.test(k)){k=k.replace('[]','');acc[k]=acc[k]||[];acc[k].push(v);}else{acc[k]=v||'';}
return acc;},{});}
function formatQS(query){return Object.keys(query).map(function(k){return Array.isArray(query[k])?query[k].map(function(v){return"".concat(k,"[]=").concat(v);}).join('&'):"".concat(k,"=").concat(query[k]);}).join('&');}
function parseUrl(url,options){var parsed=document.createElement('a');if(options&&'noDecodeWholeURL'in options&&options.noDecodeWholeURL){parsed.href=url;}else{parsed.href=decodeURIComponent(url);}
var qsAsString=options&&'decodeSearchAsString'in options&&options.decodeSearchAsString;return{href:parsed.href,protocol:(parsed.protocol||'').replace(/:$/,''),hostname:parsed.hostname,port:+parsed.port,pathname:parsed.pathname.replace(/^(?!\/)/,'/'),search:qsAsString?parsed.search:internal.parseQS(parsed.search||''),hash:(parsed.hash||'').replace(/^#/,''),host:parsed.host||window.location.host};}
function buildUrl(obj){return(obj.protocol||'http')+'://'+(obj.host||obj.hostname+(obj.port?":".concat(obj.port):''))+(obj.pathname||'')+(obj.search?"?".concat(internal.formatQS(obj.search||'')):'')+(obj.hash?"#".concat(obj.hash):'');}
function deepEqual(obj1,obj2){var _ref2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref2$checkTypes=_ref2.checkTypes,checkTypes=_ref2$checkTypes===void 0?false:_ref2$checkTypes;if(obj1===obj2)return true;else if(_typeof(obj1)==='object'&&obj1!==null&&_typeof(obj2)==='object'&&obj2!==null&&(!checkTypes||obj1.constructor===obj2.constructor)){if(Object.keys(obj1).length!==Object.keys(obj2).length)return false;for(var prop in obj1){if(obj2.hasOwnProperty(prop)){if(!deepEqual(obj1[prop],obj2[prop],{checkTypes:checkTypes})){return false;}}else{return false;}}
return true;}else{return false;}}
function mergeDeep(target){for(var _len2=arguments.length,sources=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){sources[_key2-1]=arguments[_key2];}
if(!sources.length)return target;var source=sources.shift();if(isPlainObject(target)&&isPlainObject(source)){var _loop=function _loop(key){if(isPlainObject(source[key])){if(!target[key])_extends(target,_defineProperty({},key,{}));mergeDeep(target[key],source[key]);}else if(isArray(source[key])){if(!target[key]){_extends(target,_defineProperty({},key,_toConsumableArray(source[key])));}else if(isArray(target[key])){source[key].forEach(function(obj){var addItFlag=1;for(var i=0;i<target[key].length;i++){if(deepEqual(target[key][i],obj)){addItFlag=0;break;}}
if(addItFlag){target[key].push(obj);}});}}else{_extends(target,_defineProperty({},key,source[key]));}};for(var key in source){_loop(key);}}
return mergeDeep.apply(void 0,[target].concat(sources));}
function cyrb53Hash(str){var seed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var imul=function imul(opA,opB){if(isFn(Math.imul)){return Math.imul(opA,opB);}else{opB|=0;var result=(opA&0x003fffff)*opB;if(opA&0xffc00000)result+=(opA&0xffc00000)*opB|0;return result|0;}};var h1=0xdeadbeef^seed;var h2=0x41c6ce57^seed;for(var i=0,ch;i<str.length;i++){ch=str.charCodeAt(i);h1=imul(h1^ch,2654435761);h2=imul(h2^ch,1597334677);}
h1=imul(h1^h1>>>16,2246822507)^imul(h2^h2>>>13,3266489909);h2=imul(h2^h2>>>16,2246822507)^imul(h1^h1>>>13,3266489909);return(4294967296*(2097151&h2)+(h1>>>0)).toString();}
function getWindowFromDocument(doc){return doc?doc.defaultView:null;}
function safeJSONParse(data){try{return JSON.parse(data);}catch(e){}}}),"./src/video.js":
/*!**********************!*\
  !*** ./src/video.js ***!
  \**********************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"INSTREAM":function(){return INSTREAM;},"OUTSTREAM":function(){return OUTSTREAM;},"isValidVideoBid":function(){return isValidVideoBid;}});var _adapterManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./adapterManager.js */
"./src/adapterManager.js");var _utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _hook_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var VIDEO_MEDIA_TYPE='video';var OUTSTREAM='outstream';var INSTREAM='instream';var videoAdUnit=function videoAdUnit(adUnit){var mediaType=adUnit.mediaType===VIDEO_MEDIA_TYPE;var mediaTypes=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(adUnit,'mediaTypes.video');return mediaType||mediaTypes;};var videoBidder=function videoBidder(bid){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.includes)(_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].videoAdapters,bid.bidder);};var hasNonVideoBidder=function hasNonVideoBidder(adUnit){return adUnit.bids.filter(function(bid){return!videoBidder(bid);}).length;};function isValidVideoBid(bid){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$index=_ref.index,index=_ref$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_3__.auctionManager.index:_ref$index;var videoMediaType=(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(index.getMediaTypes(bid),'video');var context=videoMediaType&&(0,_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(videoMediaType,'context');var adUnit=index.getAdUnit(bid);return checkVideoBidSetup(bid,adUnit,videoMediaType,context);}
var checkVideoBidSetup=(0,_hook_js__WEBPACK_IMPORTED_MODULE_4__.hook)('sync',function(bid,adUnit,videoMediaType,context){if(videoMediaType&&context!==OUTSTREAM){if(!_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('cache.url')&&bid.vastXml&&!bid.vastUrl){(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__.logError)("\n        This bid contains only vastXml and will not work when a prebid cache url is not specified.\n        Try enabling prebid cache with pbjs.setConfig({ cache: {url: \"...\"} });\n      ");return false;}
return!!(bid.vastUrl||bid.vastXml);}
if(context===OUTSTREAM){return!!(bid.renderer||adUnit&&adUnit.renderer||videoMediaType.renderer);}
return true;},'checkVideoBidSetup');}),"./src/videoCache.js":
/*!***************************!*\
  !*** ./src/videoCache.js ***!
  \***************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"getCacheUrl":function(){return getCacheUrl;},"store":function(){return store;}});var _ajax_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./ajax.js */
"./src/ajax.js");var _config_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");function wrapURI(uri,impUrl){var vastImp=impUrl?"<![CDATA[".concat(impUrl,"]]>"):"";return"<VAST version=\"3.0\">\n    <Ad>\n      <Wrapper>\n        <AdSystem>prebid.org wrapper</AdSystem>\n        <VASTAdTagURI><![CDATA[".concat(uri,"]]></VASTAdTagURI>\n        <Impression>").concat(vastImp,"</Impression>\n        <Creatives></Creatives>\n      </Wrapper>\n    </Ad>\n  </VAST>");}
function toStorageRequest(bid){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$index=_ref.index,index=_ref$index===void 0?_auctionManager_js__WEBPACK_IMPORTED_MODULE_0__.auctionManager.index:_ref$index;var vastValue=bid.vastXml?bid.vastXml:wrapURI(bid.vastUrl,bid.vastImpUrl);var auction=index.getAuction(bid);var payload={type:'xml',value:vastValue,ttlseconds:Number(bid.ttl)};if(_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('cache.vasttrack')){payload.bidder=bid.bidder;payload.bidid=bid.requestId;payload.aid=bid.auctionId;}
if(auction!=null){payload.timestamp=auction.getAuctionStart();}
if(typeof bid.customCacheKey==='string'&&bid.customCacheKey!==''){payload.key=bid.customCacheKey;}
return payload;}
function shimStorageCallback(done){return{success:function success(responseBody){var ids;try{ids=JSON.parse(responseBody).responses;}catch(e){done(e,[]);return;}
if(ids){done(null,ids);}else{done(new Error("The cache server didn't respond with a responses property."),[]);}},error:function error(statusText,responseBody){done(new Error("Error storing video ad in the cache: ".concat(statusText,": ").concat(JSON.stringify(responseBody))),[]);}};}
function store(bids,done){var requestData={puts:bids.map(toStorageRequest)};(0,_ajax_js__WEBPACK_IMPORTED_MODULE_2__.ajax)(_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('cache.url'),shimStorageCallback(done),JSON.stringify(requestData),{contentType:'text/plain',withCredentials:true});}
function getCacheUrl(id){return"".concat(_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('cache.url'),"?uuid=").concat(id);}}),"./node_modules/dlv/index.js":
/*!***********************************!*\
  !*** ./node_modules/dlv/index.js ***!
  \***********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"default":function(){return dlv;}});function dlv(obj,key,def,p,undef){key=key.split?key.split('.'):key;for(p=0;p<key.length;p++){obj=obj?obj[key[p]]:undef;}
return obj===undef?def:obj;}}),"./node_modules/dset/dist/dset.es.js":
/*!*******************************************!*\
  !*** ./node_modules/dset/dist/dset.es.js ***!
  \*******************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{"default":function(){return __WEBPACK_DEFAULT_EXPORT__;}});function __WEBPACK_DEFAULT_EXPORT__(obj,keys,val){keys.split&&(keys=keys.split('.'));var i=0,l=keys.length,t=obj,x;for(;i<l;++i){x=t[keys[i]];t=t[keys[i]]=(i===l-1?val:(x!=null?x:(!!~keys[i+1].indexOf('.')||!(+keys[i+1]>-1))?{}:[]));}}}),"./node_modules/fun-hooks/no-eval/index.js":
/*!*************************************************!*\
  !*** ./node_modules/fun-hooks/no-eval/index.js ***!
  \*************************************************/
(function(module){create.SYNC=1;create.ASYNC=2;create.QUEUE=4;var packageName="fun-hooks";function hasProxy(){return!!(typeof Proxy==="function"&&Proxy.revocable);}
var defaults=Object.freeze({useProxy:true,ready:0});var hookableMap=new WeakMap();var reduce=[1].reduce(function(a,b,c){return[a,b,c];},2).toString()==="2,1,0"?Array.prototype.reduce:function(callback,initial){var o=Object(this);var len=o.length>>>0;var k=0;var value;if(initial){value=initial;}else{while(k<len&&!(k in o)){k++;}
value=o[k++];}
while(k<len){if(k in o){value=callback(value,o[k],k,o);}
k++;}
return value;};function rest(args,skip){return Array.prototype.slice.call(args,skip);}
var assign=Object.assign||function assign(target){return reduce.call(rest(arguments,1),function(target,obj){if(obj){Object.keys(obj).forEach(function(prop){target[prop]=obj[prop];});}
return target;},target);};function runAll(queue){var queued;while((queued=queue.shift())){queued();}}
function create(config){var hooks={};var postReady=[];config=assign({},defaults,config);function dispatch(arg1,arg2){if(typeof arg1==="function"){return hookFn.call(null,"sync",arg1,arg2);}else if(typeof arg1==="string"&&typeof arg2==="function"){return hookFn.apply(null,arguments);}else if(typeof arg1==="object"){return hookObj.apply(null,arguments);}}
var ready;if(config.ready){dispatch.ready=function(){ready=true;runAll(postReady);};}else{ready=true;}
function hookObj(obj,props,objName){var walk=true;if(typeof props==="undefined"){props=Object.getOwnPropertyNames(obj);walk=false;}
var objHooks={};var doNotHook=["constructor"];do{props=props.filter(function(prop){return(typeof obj[prop]==="function"&&!(doNotHook.indexOf(prop)!==-1)&&!prop.match(/^_/));});props.forEach(function(prop){var parts=prop.split(":");var name=parts[0];var type=parts[1]||"sync";if(!objHooks[name]){var fn=obj[name];objHooks[name]=obj[name]=hookFn(type,fn,objName?[objName,name]:undefined);}});obj=Object.getPrototypeOf(obj);}while(walk&&obj);return objHooks;}
function get(path){var parts=Array.isArray(path)?path:path.split(".");return reduce.call(parts,function(memo,part,i){var item=memo[part];var installed=false;if(item){return item;}else if(i===parts.length-1){if(!ready){postReady.push(function(){if(!installed){console.warn(packageName+": referenced '"+
path+"' but it was never created");}});}
return(memo[part]=newHookable(function(fn){memo[part]=fn;installed=true;}));}
return(memo[part]={});},hooks);}
function newHookable(onInstall){var before=[];var after=[];var generateTrap=function(){};var api={before:function(hook,priority){return add.call(this,before,"before",hook,priority);},after:function(hook,priority){return add.call(this,after,"after",hook,priority);},getHooks:function(match){var hooks=before.concat(after);if(typeof match==="object"){hooks=hooks.filter(function(entry){return Object.keys(match).every(function(prop){return entry[prop]===match[prop];});});}
try{assign(hooks,{remove:function(){hooks.forEach(function(entry){entry.remove();});return this;}});}catch(e){console.error("error adding `remove` to array, did you modify Array.prototype?");}
return hooks;},removeAll:function(){return this.getHooks().remove();}};var meta={install:function(type,fn,generate){this.type=type;generateTrap=generate;generate(before,after);onInstall&&onInstall(fn);}};hookableMap.set(api.after,meta);return api;function add(store,type,hook,priority){var entry={hook:hook,type:type,priority:priority||10,remove:function(){var index=store.indexOf(entry);if(index!==-1){store.splice(index,1);generateTrap(before,after);}}};store.push(entry);store.sort(function(a,b){return b.priority-a.priority;});generateTrap(before,after);return this;}}
function hookFn(type,fn,name){var meta=fn.after&&hookableMap.get(fn.after);if(meta){if(meta.type!==type){throw packageName+": recreated hookable with different type";}else{return fn;}}
var hookable=name?get(name):newHookable();var trap;var hookedFn;var handlers={get:function(target,prop){return hookable[prop]||Reflect.get.apply(Reflect,arguments);}};if(!ready){postReady.push(setTrap);}
if(config.useProxy&&hasProxy()){hookedFn=new Proxy(fn,handlers);}else{hookedFn=function(){return handlers.apply?handlers.apply(fn,this,rest(arguments)):fn.apply(this,arguments);};assign(hookedFn,hookable);}
hookableMap.get(hookedFn.after).install(type,hookedFn,generateTrap);return hookedFn;function generateTrap(before,after){var order=[];var targetIndex;if(before.length||after.length){before.forEach(addToOrder);targetIndex=order.push(undefined)-1;after.forEach(addToOrder);trap=function(target,thisArg,args){var curr=0;var result;var callback=type==="async"&&typeof args[args.length-1]==="function"&&args.pop();function bail(value){if(type==="sync"){result=value;}else if(callback){callback.apply(null,arguments);}}
function next(value){if(order[curr]){var args=rest(arguments);next.bail=bail;args.unshift(next);return order[curr++].apply(thisArg,args);}
if(type==="sync"){result=value;}else if(callback){callback.apply(null,arguments);}}
order[targetIndex]=function(){var args=rest(arguments,1);if(type==="async"&&callback){delete next.bail;args.push(next);}
var result=target.apply(thisArg,args);if(type==="sync"){next(result);}};next.apply(null,args);return result;};}else{trap=undefined;}
setTrap();function addToOrder(entry){order.push(entry.hook);}}
function setTrap(){if(ready||(type==="sync"&&!(config.ready&create.SYNC))||(type==="async"&&!(config.ready&create.ASYNC))){handlers.apply=trap;}else if(type==="sync"||!(config.ready&create.QUEUE)){handlers.apply=function(){throw packageName+": hooked function not ready";};}else{handlers.apply=function(){var args=arguments;postReady.push(function(){hookedFn.apply(args[1],args[2]);});};}}}
dispatch.get=get;return dispatch;}
module.exports=create;}),"./node_modules/just-clone/index.js":
/*!******************************************!*\
  !*** ./node_modules/just-clone/index.js ***!
  \******************************************/
(function(module){module.exports=clone;function clone(obj){var result=Array.isArray(obj)?[]:{};for(var key in obj){var value=obj[key];if(value&&typeof value=='object'){result[key]=clone(value);}else{result[key]=value;}}
return result;}}),"./src/constants.json":
/*!****************************!*\
  !*** ./src/constants.json ***!
  \****************************/
(function(module){"use strict";module.exports=JSON.parse('{"JSON_MAPPING":{"ADSERVER_TARGETING":"adserverTargeting","BD_SETTING_STANDARD":"standard"},"DEBUG_MODE":"pbjs_debug","STATUS":{"GOOD":1},"EVENTS":{"AUCTION_INIT":"auctionInit","AUCTION_END":"auctionEnd","BID_ADJUSTMENT":"bidAdjustment","BID_TIMEOUT":"bidTimeout","BID_REQUESTED":"bidRequested","BID_RESPONSE":"bidResponse","NO_BID":"noBid","BID_WON":"bidWon","BIDDER_DONE":"bidderDone","BIDDER_ERROR":"bidderError","SET_TARGETING":"setTargeting","BEFORE_REQUEST_BIDS":"beforeRequestBids","BEFORE_BIDDER_HTTP":"beforeBidderHttp","REQUEST_BIDS":"requestBids","ADD_AD_UNITS":"addAdUnits","AD_RENDER_FAILED":"adRenderFailed","AD_RENDER_SUCCEEDED":"adRenderSucceeded","TCF2_ENFORCEMENT":"tcf2Enforcement","AUCTION_DEBUG":"auctionDebug","BID_VIEWABLE":"bidViewable","STALE_RENDER":"staleRender","BILLABLE_EVENT":"billableEvent"},"AD_RENDER_FAILED_REASON":{"PREVENT_WRITING_ON_MAIN_DOCUMENT":"preventWritingOnMainDocument","NO_AD":"noAd","EXCEPTION":"exception","CANNOT_FIND_AD":"cannotFindAd","MISSING_DOC_OR_ADID":"missingDocOrAdid"},"EVENT_ID_PATHS":{"bidWon":"adUnitCode"},"GRANULARITY_OPTIONS":{"LOW":"low","MEDIUM":"medium","HIGH":"high","AUTO":"auto","DENSE":"dense","CUSTOM":"custom"},"TARGETING_KEYS":{"BIDDER":"hb_bidder","AD_ID":"hb_adid","PRICE_BUCKET":"hb_pb","SIZE":"hb_size","DEAL":"hb_deal","SOURCE":"hb_source","FORMAT":"hb_format","UUID":"hb_uuid","CACHE_ID":"hb_cache_id","CACHE_HOST":"hb_cache_host","ADOMAIN":"hb_adomain"},"DEFAULT_TARGETING_KEYS":{"BIDDER":"hb_bidder","AD_ID":"hb_adid","PRICE_BUCKET":"hb_pb","SIZE":"hb_size","DEAL":"hb_deal","FORMAT":"hb_format","UUID":"hb_uuid","CACHE_HOST":"hb_cache_host"},"NATIVE_KEYS":{"title":"hb_native_title","body":"hb_native_body","body2":"hb_native_body2","privacyLink":"hb_native_privacy","privacyIcon":"hb_native_privicon","sponsoredBy":"hb_native_brand","image":"hb_native_image","icon":"hb_native_icon","clickUrl":"hb_native_linkurl","displayUrl":"hb_native_displayurl","cta":"hb_native_cta","rating":"hb_native_rating","address":"hb_native_address","downloads":"hb_native_downloads","likes":"hb_native_likes","phone":"hb_native_phone","price":"hb_native_price","salePrice":"hb_native_saleprice","rendererUrl":"hb_renderer_url","adTemplate":"hb_adTemplate"},"S2S":{"SRC":"s2s"},"BID_STATUS":{"BID_TARGETING_SET":"targetingSet","RENDERED":"rendered"}}');})});var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports;}
var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports;}
__webpack_require__.m=__webpack_modules__;!function(){var deferred=[];__webpack_require__.O=function(result,chunkIds,fn,priority){if(chunkIds){priority=priority||0;for(var i=deferred.length;i>0&&deferred[i-1][2]>priority;i--)deferred[i]=deferred[i-1];deferred[i]=[chunkIds,fn,priority];return;}
var notFulfilled=Infinity;for(var i=0;i<deferred.length;i++){var chunkIds=deferred[i][0];var fn=deferred[i][1];var priority=deferred[i][2];var fulfilled=true;for(var j=0;j<chunkIds.length;j++){if((priority&1===0||notFulfilled>=priority)&&Object.keys(__webpack_require__.O).every(function(key){return __webpack_require__.O[key](chunkIds[j]);})){chunkIds.splice(j--,1);}else{fulfilled=false;if(priority<notFulfilled)notFulfilled=priority;}}
if(fulfilled){deferred.splice(i--,1)
var r=fn();if(r!==undefined)result=r;}}
return result;};}();!function(){__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module['default'];}:function(){return module;};__webpack_require__.d(getter,{a:getter});return getter;};}();!function(){__webpack_require__.d=function(exports,definition){for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]});}}};}();!function(){__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);}}();!function(){__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'});}
Object.defineProperty(exports,'__esModule',{value:true});};}();!function(){var installedChunks={"prebid-core":0};__webpack_require__.O.j=function(chunkId){return installedChunks[chunkId]===0;};var webpackJsonpCallback=function(parentChunkLoadingFunction,data){var chunkIds=data[0];var moreModules=data[1];var runtime=data[2];var moduleId,chunkId,i=0;if(chunkIds.some(function(id){return installedChunks[id]!==0;})){for(moduleId in moreModules){if(__webpack_require__.o(moreModules,moduleId)){__webpack_require__.m[moduleId]=moreModules[moduleId];}}
if(runtime)var result=runtime(__webpack_require__);}
if(parentChunkLoadingFunction)parentChunkLoadingFunction(data);for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(__webpack_require__.o(installedChunks,chunkId)&&installedChunks[chunkId]){installedChunks[chunkId][0]();}
installedChunks[chunkId]=0;}
return __webpack_require__.O(result);}
var chunkLoadingGlobal=self["pbjsChunk"]=self["pbjsChunk"]||[];chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null,0));chunkLoadingGlobal.push=webpackJsonpCallback.bind(null,chunkLoadingGlobal.push.bind(chunkLoadingGlobal));}();var __webpack_exports__={};!function(){"use strict";
/*!***********************!*\
  !*** ./src/prebid.js ***!
  \***********************/
var _prebidGlobal_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./prebidGlobal.js */
"./src/prebidGlobal.js");var _utils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./utils.js */
"./node_modules/dlv/index.js");var _secureCreatives_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(
/*! ./secureCreatives.js */
"./src/secureCreatives.js");var _userSync_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./userSync.js */
"./src/userSync.js");var _config_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ./config.js */
"./src/config.js");var _auctionManager_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./auctionManager.js */
"./src/auctionManager.js");var _targeting_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ./targeting.js */
"./src/targeting.js");var _hook_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var _debugging_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./debugging.js */
"./src/debugging.js");var _polyfill_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(
/*! ./polyfill.js */
"./src/polyfill.js");var _adUnits_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(
/*! ./adUnits.js */
"./src/adUnits.js");var _Renderer_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(
/*! ./Renderer.js */
"./src/Renderer.js");var _bidfactory_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(
/*! ./bidfactory.js */
"./src/bidfactory.js");var _storageManager_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(
/*! ./storageManager.js */
"./src/storageManager.js");var _adRendering_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(
/*! ./adRendering.js */
"./src/adRendering.js");var _adapterManager_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ./adapterManager.js */
"./src/adapterManager.js");var _constants_json__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./constants.json */
"./src/constants.json");var _events_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./events.js */
"./src/events.js");function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
var pbjs=(0,_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_0__.getGlobal)();var triggerUserSyncs=_userSync_js__WEBPACK_IMPORTED_MODULE_1__.userSync.triggerUserSyncs;var _CONSTANTS$EVENTS=_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS,ADD_AD_UNITS=_CONSTANTS$EVENTS.ADD_AD_UNITS,BID_WON=_CONSTANTS$EVENTS.BID_WON,REQUEST_BIDS=_CONSTANTS$EVENTS.REQUEST_BIDS,SET_TARGETING=_CONSTANTS$EVENTS.SET_TARGETING,STALE_RENDER=_CONSTANTS$EVENTS.STALE_RENDER;var _CONSTANTS$AD_RENDER_=_constants_json__WEBPACK_IMPORTED_MODULE_2__.AD_RENDER_FAILED_REASON,PREVENT_WRITING_ON_MAIN_DOCUMENT=_CONSTANTS$AD_RENDER_.PREVENT_WRITING_ON_MAIN_DOCUMENT,NO_AD=_CONSTANTS$AD_RENDER_.NO_AD,EXCEPTION=_CONSTANTS$AD_RENDER_.EXCEPTION,CANNOT_FIND_AD=_CONSTANTS$AD_RENDER_.CANNOT_FIND_AD,MISSING_DOC_OR_ADID=_CONSTANTS$AD_RENDER_.MISSING_DOC_OR_ADID;var eventValidators={bidWon:checkDefinedPlacement};(0,_debugging_js__WEBPACK_IMPORTED_MODULE_3__.sessionLoader)();pbjs.bidderSettings=pbjs.bidderSettings||{};pbjs.libLoaded=true;pbjs.version="v6.24.1";(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Prebid.js v6.24.1 loaded");pbjs.installedModules=pbjs.installedModules||[];pbjs.adUnits=pbjs.adUnits||[];pbjs.triggerUserSyncs=triggerUserSyncs;function checkDefinedPlacement(id){var adUnitCodes=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getBidsRequested().map(function(bidSet){return bidSet.bids.map(function(bid){return bid.adUnitCode;});}).reduce(_utils_js__WEBPACK_IMPORTED_MODULE_4__.flatten).filter(_utils_js__WEBPACK_IMPORTED_MODULE_4__.uniques);if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.contains)(adUnitCodes,id)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('The "'+id+'" placement is not defined.');return;}
return true;}
function setRenderSize(doc,width,height){if(doc.defaultView&&doc.defaultView.frameElement){doc.defaultView.frameElement.width=width;doc.defaultView.frameElement.height=height;}}
function validateSizes(sizes,targLength){var cleanSizes=[];if((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(sizes)&&(targLength?sizes.length===targLength:sizes.length>0)){if(sizes.every(function(sz){return(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArrayOfNums)(sz,2);})){cleanSizes=sizes;}else if((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArrayOfNums)(sizes,2)){cleanSizes.push(sizes);}}
return cleanSizes;}
function validateBannerMediaType(adUnit){var validatedAdUnit=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.deepClone)(adUnit);var banner=validatedAdUnit.mediaTypes.banner;var bannerSizes=validateSizes(banner.sizes);if(bannerSizes.length>0){banner.sizes=bannerSizes;validatedAdUnit.sizes=bannerSizes;}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Detected a mediaTypes.banner object without a proper sizes field.  Please ensure the sizes are listed like: [[300, 250], ...].  Removing invalid mediaTypes.banner object from request.');delete validatedAdUnit.mediaTypes.banner;}
return validatedAdUnit;}
function validateVideoMediaType(adUnit){var validatedAdUnit=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.deepClone)(adUnit);var video=validatedAdUnit.mediaTypes.video;if(video.playerSize){var tarPlayerSizeLen=typeof video.playerSize[0]==='number'?2:1;var videoSizes=validateSizes(video.playerSize,tarPlayerSizeLen);if(videoSizes.length>0){if(tarPlayerSizeLen===2){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)('Transforming video.playerSize from [640,480] to [[640,480]] so it\'s in the proper format.');}
video.playerSize=videoSizes;validatedAdUnit.sizes=videoSizes;}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Detected incorrect configuration of mediaTypes.video.playerSize.  Please specify only one set of dimensions in a format like: [[640, 480]]. Removing invalid mediaTypes.video.playerSize property from request.');delete validatedAdUnit.mediaTypes.video.playerSize;}}
return validatedAdUnit;}
function validateNativeMediaType(adUnit){var validatedAdUnit=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.deepClone)(adUnit);var native=validatedAdUnit.mediaTypes.native;if(native.image&&native.image.sizes&&!Array.isArray(native.image.sizes)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Please use an array of sizes for native.image.sizes field.  Removing invalid mediaTypes.native.image.sizes property from request.');delete validatedAdUnit.mediaTypes.native.image.sizes;}
if(native.image&&native.image.aspect_ratios&&!Array.isArray(native.image.aspect_ratios)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Please use an array of sizes for native.image.aspect_ratios field.  Removing invalid mediaTypes.native.image.aspect_ratios property from request.');delete validatedAdUnit.mediaTypes.native.image.aspect_ratios;}
if(native.icon&&native.icon.sizes&&!Array.isArray(native.icon.sizes)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Please use an array of sizes for native.icon.sizes field.  Removing invalid mediaTypes.native.icon.sizes property from request.');delete validatedAdUnit.mediaTypes.native.icon.sizes;}
return validatedAdUnit;}
function validateAdUnitPos(adUnit,mediaType){var pos=(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(adUnit,"mediaTypes.".concat(mediaType,".pos"));if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isNumber)(pos)||isNaN(pos)||!isFinite(pos)){var warning="Value of property 'pos' on ad unit ".concat(adUnit.code," should be of type: Number");(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logWarn)(warning);_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(_constants_json__WEBPACK_IMPORTED_MODULE_2__.EVENTS.AUCTION_DEBUG,{type:'WARNING',arguments:warning});delete adUnit.mediaTypes[mediaType].pos;}
return adUnit;}
function validateAdUnit(adUnit){var msg=function msg(_msg){return"adUnit.code '".concat(adUnit.code,"' ").concat(_msg);};var mediaTypes=adUnit.mediaTypes;var bids=adUnit.bids;if(bids!=null&&!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(bids)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)(msg("defines 'adUnit.bids' that is not an array. Removing adUnit from auction"));return null;}
if(bids==null&&adUnit.ortb2Imp==null){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)(msg("has no 'adUnit.bids' and no 'adUnit.ortb2Imp'. Removing adUnit from auction"));return null;}
if(!mediaTypes||Object.keys(mediaTypes).length===0){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)(msg("does not define a 'mediaTypes' object.  This is a required field for the auction, so this adUnit has been removed."));return null;}
if(adUnit.ortb2Imp!=null&&(bids==null||bids.length===0)){adUnit.bids=[{bidder:null}];(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)(msg("defines 'adUnit.ortb2Imp' with no 'adUnit.bids'; it will be seen only by S2S adapters"));}
return adUnit;}
var adUnitSetupChecks={validateAdUnit:validateAdUnit,validateBannerMediaType:validateBannerMediaType,validateVideoMediaType:validateVideoMediaType,validateNativeMediaType:validateNativeMediaType,validateSizes:validateSizes};var checkAdUnitSetup=(0,_hook_js__WEBPACK_IMPORTED_MODULE_8__.hook)('sync',function(adUnits){var validatedAdUnits=[];adUnits.forEach(function(adUnit){adUnit=validateAdUnit(adUnit);if(adUnit==null)return;var mediaTypes=adUnit.mediaTypes;var validatedBanner,validatedVideo,validatedNative;if(mediaTypes.banner){validatedBanner=validateBannerMediaType(adUnit);if(mediaTypes.banner.hasOwnProperty('pos'))validatedBanner=validateAdUnitPos(validatedBanner,'banner');}
if(mediaTypes.video){validatedVideo=validatedBanner?validateVideoMediaType(validatedBanner):validateVideoMediaType(adUnit);if(mediaTypes.video.hasOwnProperty('pos'))validatedVideo=validateAdUnitPos(validatedVideo,'video');}
if(mediaTypes.native){validatedNative=validatedVideo?validateNativeMediaType(validatedVideo):validatedBanner?validateNativeMediaType(validatedBanner):validateNativeMediaType(adUnit);}
var validatedAdUnit=_extends({},validatedBanner,validatedVideo,validatedNative);validatedAdUnits.push(validatedAdUnit);});return validatedAdUnits;},'checkAdUnitSetup');pbjs.getAdserverTargetingForAdUnitCodeStr=function(adunitCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getAdserverTargetingForAdUnitCodeStr",arguments);if(adunitCode){var res=pbjs.getAdserverTargetingForAdUnitCode(adunitCode);return(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.transformAdServerTargetingObj)(res);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('Need to call getAdserverTargetingForAdUnitCodeStr with adunitCode');}};pbjs.getHighestUnusedBidResponseForAdUnitCode=function(adunitCode){if(adunitCode){var bid=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getAllBidsForAdUnitCode(adunitCode).filter(_targeting_js__WEBPACK_IMPORTED_MODULE_9__.filters.isUnusedBid).filter(_targeting_js__WEBPACK_IMPORTED_MODULE_9__.filters.isBidNotExpired);return bid.length?bid.reduce(_utils_js__WEBPACK_IMPORTED_MODULE_4__.getHighestCpm):{};}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('Need to call getHighestUnusedBidResponseForAdUnitCode with adunitCode');}};pbjs.getAdserverTargetingForAdUnitCode=function(adUnitCode){return pbjs.getAdserverTargeting(adUnitCode)[adUnitCode];};pbjs.getAdserverTargeting=function(adUnitCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getAdserverTargeting",arguments);return _targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.getAllTargeting(adUnitCode);};function getConsentMetadata(){return{gdpr:_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__.gdprDataHandler.getConsentMeta(),usp:_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__.uspDataHandler.getConsentMeta(),coppa:!!_config_js__WEBPACK_IMPORTED_MODULE_11__.config.getConfig('coppa')};}
pbjs.getConsentMetadata=function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getConsentMetadata");return getConsentMetadata();};function getBids(type){var responses=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager[type]().filter(_utils_js__WEBPACK_IMPORTED_MODULE_4__.bind.call(_utils_js__WEBPACK_IMPORTED_MODULE_4__.adUnitsFilter,this,_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getAdUnitCodes()));var currentAuctionId=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getLastAuctionId();return responses.map(function(bid){return bid.adUnitCode;}).filter(_utils_js__WEBPACK_IMPORTED_MODULE_4__.uniques).map(function(adUnitCode){return responses.filter(function(bid){return bid.auctionId===currentAuctionId&&bid.adUnitCode===adUnitCode;});}).filter(function(bids){return bids&&bids[0]&&bids[0].adUnitCode;}).map(function(bids){return _defineProperty({},bids[0].adUnitCode,{bids:bids});}).reduce(function(a,b){return _extends(a,b);},{});}
pbjs.getNoBids=function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getNoBids",arguments);return getBids('getNoBids');};pbjs.getNoBidsForAdUnitCode=function(adUnitCode){var bids=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getNoBids().filter(function(bid){return bid.adUnitCode===adUnitCode;});return{bids:bids};};pbjs.getBidResponses=function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getBidResponses",arguments);return getBids('getBidsReceived');};pbjs.getBidResponsesForAdUnitCode=function(adUnitCode){var bids=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getBidsReceived().filter(function(bid){return bid.adUnitCode===adUnitCode;});return{bids:bids};};pbjs.setTargetingForGPTAsync=function(adUnit,customSlotMatching){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.setTargetingForGPTAsync",arguments);if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isGptPubadsDefined)()){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('window.googletag is not defined on the page');return;}
var targetingSet=_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.getAllTargeting(adUnit);_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.resetPresetTargeting(adUnit,customSlotMatching);_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.setTargetingForGPT(targetingSet,customSlotMatching);Object.keys(targetingSet).forEach(function(adUnitCode){Object.keys(targetingSet[adUnitCode]).forEach(function(targetingKey){if(targetingKey==='hb_adid'){_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.setStatusForBids(targetingSet[adUnitCode][targetingKey],_constants_json__WEBPACK_IMPORTED_MODULE_2__.BID_STATUS.BID_TARGETING_SET);}});});_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(SET_TARGETING,targetingSet);};pbjs.setTargetingForAst=function(adUnitCodes){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.setTargetingForAn",arguments);if(!_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.isApntagDefined()){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('window.apntag is not defined on the page');return;}
_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.setTargetingForAst(adUnitCodes);_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(SET_TARGETING,_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.getAllTargeting());};function reinjectNodeIfRemoved(node,doc,tagName){var injectionNode=doc.querySelector(tagName);if(!node.parentNode||node.parentNode!==injectionNode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.insertElement)(node,doc,tagName);}}
pbjs.renderAd=(0,_hook_js__WEBPACK_IMPORTED_MODULE_8__.hook)('async',function(doc,id,options){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.renderAd",arguments);(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('Calling renderAd with adId :'+id);if(doc&&id){try{var bid=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.findBidByAdId(id);if(bid){var shouldRender=true;if(bid&&bid.status===_constants_json__WEBPACK_IMPORTED_MODULE_2__.BID_STATUS.RENDERED){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logWarn)("Ad id ".concat(bid.adId," has been rendered before"));_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(STALE_RENDER,bid);if((0,_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(_config_js__WEBPACK_IMPORTED_MODULE_11__.config.getConfig('auctionOptions'),'suppressStaleRender')){shouldRender=false;}}
if(shouldRender){bid.ad=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.replaceAuctionPrice)(bid.ad,bid.originalCpm||bid.cpm);bid.adUrl=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.replaceAuctionPrice)(bid.adUrl,bid.originalCpm||bid.cpm);if(options&&options.clickThrough){var clickThrough=options.clickThrough;bid.ad=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.replaceClickThrough)(bid.ad,clickThrough);bid.adUrl=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.replaceClickThrough)(bid.adUrl,clickThrough);}
_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.addWinningBid(bid);_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(BID_WON,bid);var height=bid.height,width=bid.width,ad=bid.ad,mediaType=bid.mediaType,adUrl=bid.adUrl,renderer=bid.renderer;var creativeComment=document.createComment("Creative ".concat(bid.creativeId," served by ").concat(bid.bidder," Prebid.js Header Bidding"));(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.insertElement)(creativeComment,doc,'html');if((0,_Renderer_js__WEBPACK_IMPORTED_MODULE_12__.isRendererRequired)(renderer)){(0,_Renderer_js__WEBPACK_IMPORTED_MODULE_12__.executeRenderer)(renderer,bid,doc);reinjectNodeIfRemoved(creativeComment,doc,'html');(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderSucceeded)({doc:doc,bid:bid,id:id});}else if(doc===document&&!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.inIframe)()||mediaType==='video'){var message="Error trying to write ad. Ad render call ad id ".concat(id," was prevented from writing to the main document.");(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderFail)({reason:PREVENT_WRITING_ON_MAIN_DOCUMENT,message:message,bid:bid,id:id});}else if(ad){doc.write(ad);doc.close();setRenderSize(doc,width,height);reinjectNodeIfRemoved(creativeComment,doc,'html');(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.callBurl)(bid);(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderSucceeded)({doc:doc,bid:bid,id:id});}else if(adUrl){var iframe=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.createInvisibleIframe)();iframe.height=height;iframe.width=width;iframe.style.display='inline';iframe.style.overflow='hidden';iframe.src=adUrl;(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.insertElement)(iframe,doc,'body');setRenderSize(doc,width,height);reinjectNodeIfRemoved(creativeComment,doc,'html');(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.callBurl)(bid);(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderSucceeded)({doc:doc,bid:bid,id:id});}else{var _message="Error trying to write ad. No ad for bid response id: ".concat(id);(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderFail)({reason:NO_AD,message:_message,bid:bid,id:id});}}}else{var _message2="Error trying to write ad. Cannot find ad by given id : ".concat(id);(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderFail)({reason:CANNOT_FIND_AD,message:_message2,id:id});}}catch(e){var _message3="Error trying to write ad Id :".concat(id," to the page:").concat(e.message);(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderFail)({reason:EXCEPTION,message:_message3,id:id});}}else{var _message4="Error trying to write ad Id :".concat(id," to the page. Missing document or adId");(0,_adRendering_js__WEBPACK_IMPORTED_MODULE_13__.emitAdRenderFail)({reason:MISSING_DOC_OR_ADID,message:_message4,id:id});}});pbjs.removeAdUnit=function(adUnitCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.removeAdUnit",arguments);if(!adUnitCode){pbjs.adUnits=[];return;}
var adUnitCodes;if((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(adUnitCode)){adUnitCodes=adUnitCode;}else{adUnitCodes=[adUnitCode];}
adUnitCodes.forEach(function(adUnitCode){for(var i=pbjs.adUnits.length-1;i>=0;i--){if(pbjs.adUnits[i].code===adUnitCode){pbjs.adUnits.splice(i,1);}}});};pbjs.requestBids=(0,_hook_js__WEBPACK_IMPORTED_MODULE_8__.hook)('async',function(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},bidsBackHandler=_ref2.bidsBackHandler,timeout=_ref2.timeout,adUnits=_ref2.adUnits,adUnitCodes=_ref2.adUnitCodes,labels=_ref2.labels,auctionId=_ref2.auctionId;_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(REQUEST_BIDS);var cbTimeout=timeout||_config_js__WEBPACK_IMPORTED_MODULE_11__.config.getConfig('bidderTimeout');adUnits=adUnits&&_config_js__WEBPACK_IMPORTED_MODULE_11__.config.convertAdUnitFpd((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(adUnits)?adUnits:[adUnits])||pbjs.adUnits;(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.requestBids",arguments);var s2sBidders=(0,_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__.getS2SBidderSet)(_config_js__WEBPACK_IMPORTED_MODULE_11__.config.getConfig('s2sConfig')||[]);adUnits=checkAdUnitSetup(adUnits);if(adUnitCodes&&adUnitCodes.length){adUnits=adUnits.filter(function(unit){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_14__.includes)(adUnitCodes,unit.code);});}else{adUnitCodes=adUnits&&adUnits.map(function(unit){return unit.code;});}
adUnits.forEach(function(adUnit){var adUnitMediaTypes=Object.keys(adUnit.mediaTypes||{'banner':'banner'});var allBidders=adUnit.bids.map(function(bid){return bid.bidder;});var bidderRegistry=_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__["default"].bidderRegistry;var bidders=allBidders.filter(function(bidder){return!s2sBidders.has(bidder);});adUnit.transactionId=(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.generateUUID)();bidders.forEach(function(bidder){var adapter=bidderRegistry[bidder];var spec=adapter&&adapter.getSpec&&adapter.getSpec();var bidderMediaTypes=spec&&spec.supportedMediaTypes||['banner'];var bidderEligible=adUnitMediaTypes.some(function(type){return(0,_polyfill_js__WEBPACK_IMPORTED_MODULE_14__.includes)(bidderMediaTypes,type);});if(!bidderEligible){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logWarn)((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.unsupportedBidderMessage)(adUnit,bidder));adUnit.bids=adUnit.bids.filter(function(bid){return bid.bidder!==bidder;});}else{_adUnits_js__WEBPACK_IMPORTED_MODULE_15__.adunitCounter.incrementBidderRequestsCounter(adUnit.code,bidder);}});_adUnits_js__WEBPACK_IMPORTED_MODULE_15__.adunitCounter.incrementRequestsCounter(adUnit.code);});if(!adUnits||adUnits.length===0){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('No adUnits configured. No bids requested.');if(typeof bidsBackHandler==='function'){try{bidsBackHandler();}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error executing bidsBackHandler',null,e);}}
return;}
var auction=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.createAuction({adUnits:adUnits,adUnitCodes:adUnitCodes,callback:bidsBackHandler,cbTimeout:cbTimeout,labels:labels,auctionId:auctionId});var adUnitsLen=adUnits.length;if(adUnitsLen>15){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Current auction ".concat(auction.getAuctionId()," contains ").concat(adUnitsLen," adUnits."),adUnits);}
adUnitCodes.forEach(function(code){return _targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.setLatestAuctionForAdUnit(code,auction.getAuctionId());});auction.callBids();});function executeCallbacks(fn,reqBidsConfigObj){runAll(_storageManager_js__WEBPACK_IMPORTED_MODULE_16__.storageCallbacks);runAll(enableAnalyticsCallbacks);fn.call(this,reqBidsConfigObj);function runAll(queue){var queued;while(queued=queue.shift()){queued();}}}
pbjs.requestBids.before(executeCallbacks,49);pbjs.addAdUnits=function(adUnitArr){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.addAdUnits",arguments);pbjs.adUnits.push.apply(pbjs.adUnits,_config_js__WEBPACK_IMPORTED_MODULE_11__.config.convertAdUnitFpd((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(adUnitArr)?adUnitArr:[adUnitArr]));_events_js__WEBPACK_IMPORTED_MODULE_7__.emit(ADD_AD_UNITS);};pbjs.onEvent=function(event,handler,id){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.onEvent",arguments);if(!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isFn)(handler)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('The event handler provided is not a function and was not set on event "'+event+'".');return;}
if(id&&!eventValidators[event].call(null,id)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('The id provided is not valid for event "'+event+'" and no handler was set.');return;}
_events_js__WEBPACK_IMPORTED_MODULE_7__.on(event,handler,id);};pbjs.offEvent=function(event,handler,id){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.offEvent",arguments);if(id&&!eventValidators[event].call(null,id)){return;}
_events_js__WEBPACK_IMPORTED_MODULE_7__.off(event,handler,id);};pbjs.getEvents=function(){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.getEvents");return _events_js__WEBPACK_IMPORTED_MODULE_7__.getEvents();};pbjs.registerBidAdapter=function(bidderAdaptor,bidderCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.registerBidAdapter",arguments);try{_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__["default"].registerBidAdapter(bidderAdaptor(),bidderCode);}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error registering bidder adapter : '+e.message);}};pbjs.registerAnalyticsAdapter=function(options){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.registerAnalyticsAdapter",arguments);try{_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__["default"].registerAnalyticsAdapter(options);}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error registering analytics adapter : '+e.message);}};pbjs.createBid=function(statusCode){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.createBid",arguments);return(0,_bidfactory_js__WEBPACK_IMPORTED_MODULE_17__.createBid)(statusCode);};var enableAnalyticsCallbacks=[];var enableAnalyticsCb=(0,_hook_js__WEBPACK_IMPORTED_MODULE_8__.hook)('async',function(config){if(config&&!(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(config)){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.enableAnalytics for: ",config);_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__["default"].enableAnalytics(config);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)("pbjs.enableAnalytics should be called with option {}");}},'enableAnalyticsCb');pbjs.enableAnalytics=function(config){enableAnalyticsCallbacks.push(enableAnalyticsCb.bind(this,config));};pbjs.aliasBidder=function(bidderCode,alias,options){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)("Invoking pbjs.aliasBidder",arguments);if(bidderCode&&alias){_adapterManager_js__WEBPACK_IMPORTED_MODULE_10__["default"].aliasBidAdapter(bidderCode,alias,options);}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('bidderCode and alias must be passed as arguments',"pbjs.aliasBidder");}};pbjs.getAllWinningBids=function(){return _auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getAllWinningBids();};pbjs.getAllPrebidWinningBids=function(){return _auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getBidsReceived().filter(function(bid){return bid.status===_constants_json__WEBPACK_IMPORTED_MODULE_2__.BID_STATUS.BID_TARGETING_SET;});};pbjs.getHighestCpmBids=function(adUnitCode){return _targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.getWinningBids(adUnitCode);};pbjs.markWinningBidAsUsed=function(markBidRequest){var bids=[];if(markBidRequest.adUnitCode&&markBidRequest.adId){bids=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getBidsReceived().filter(function(bid){return bid.adId===markBidRequest.adId&&bid.adUnitCode===markBidRequest.adUnitCode;});}else if(markBidRequest.adUnitCode){bids=_targeting_js__WEBPACK_IMPORTED_MODULE_9__.targeting.getWinningBids(markBidRequest.adUnitCode);}else if(markBidRequest.adId){bids=_auctionManager_js__WEBPACK_IMPORTED_MODULE_5__.auctionManager.getBidsReceived().filter(function(bid){return bid.adId===markBidRequest.adId;});}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logWarn)('Improper use of markWinningBidAsUsed. It needs an adUnitCode or an adId to function.');}
if(bids.length>0){bids[0].status=_constants_json__WEBPACK_IMPORTED_MODULE_2__.BID_STATUS.RENDERED;}};pbjs.getConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.getConfig;pbjs.readConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.readConfig;pbjs.mergeConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.mergeConfig;pbjs.mergeBidderConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.mergeBidderConfig;pbjs.setConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.setConfig;pbjs.setBidderConfig=_config_js__WEBPACK_IMPORTED_MODULE_11__.config.setBidderConfig;pbjs.que.push(function(){return(0,_secureCreatives_js__WEBPACK_IMPORTED_MODULE_18__.listenMessagesFromCreative)();});pbjs.cmd.push=function(command){if(typeof command==='function'){try{command.call();}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error processing command :',e.message,e.stack);}}else{(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)("Commands written into pbjs.cmd.push must be wrapped in a function");}};pbjs.que.push=pbjs.cmd.push;function processQueue(queue){queue.forEach(function(cmd){if(typeof cmd.called==='undefined'){try{cmd.call();cmd.called=true;}catch(e){(0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error processing command :','prebid.js',e);}}});}
pbjs.processQueue=function(){_hook_js__WEBPACK_IMPORTED_MODULE_8__.hook.ready();processQueue(pbjs.que);processQueue(pbjs.cmd);};var __WEBPACK_DEFAULT_EXPORT__=(pbjs);}();__webpack_exports__=__webpack_require__.O(__webpack_exports__);})();"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["aolBidAdapter"],{"./modules/aolBidAdapter.js":
/*!**********************************!*\
  !*** ./modules/aolBidAdapter.js ***!
  \**********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _templateObject,_templateObject2,_templateObject3;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
var AOL_BIDDERS_CODES={AOL:'aol',VERIZON:'verizon',ONEMOBILE:'onemobile',ONEDISPLAY:'onedisplay'};var AOL_ENDPOINTS={DISPLAY:{GET:'display-get'},MOBILE:{GET:'mobile-get',POST:'mobile-post'}};var SYNC_TYPES={IFRAME:{TAG:'iframe',TYPE:'iframe'},IMAGE:{TAG:'img',TYPE:'image'}};var SUPPORTED_USER_ID_SOURCES=['adserver.org','criteo.com','id5-sync.com','intentiq.com','liveintent.com','quantcast.com','verizonmedia.com','liveramp.com','yahoo.com'];var pubapiTemplate=template(_templateObject||(_templateObject=_taggedTemplateLiteral(["","/pubapi/3.0/","/","/","/","/ADTECH;v=2;cmd=bid;cors=yes;alias=",";misc=",";",""])),'host','network','placement','pageid','sizeid','alias','misc','dynamicParams');var nexageBaseApiTemplate=template(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["","/bidRequest?"])),'host');var nexageGetApiTemplate=template(_templateObject3||(_templateObject3=_taggedTemplateLiteral(["dcn=","&pos=","&cmd=bid",""])),'dcn','pos','dynamicParams');var MP_SERVER_MAP={us:'adserver-us.adtech.advertising.com',eu:'adserver-eu.adtech.advertising.com',as:'adserver-as.adtech.advertising.com'};var NEXAGE_SERVER='c2shb.ssp.yahoo.com';var ONE_DISPLAY_TTL=60;var ONE_MOBILE_TTL=3600;var DEFAULT_PROTO='https';var NUMERIC_VALUES={TRUE:1,FALSE:0};function template(strings){for(var _len=arguments.length,keys=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){keys[_key-1]=arguments[_key];}
return function(){for(var _len2=arguments.length,values=new Array(_len2),_key2=0;_key2<_len2;_key2++){values[_key2]=arguments[_key2];}
var dict=values[values.length-1]||{};var result=[strings[0]];keys.forEach(function(key,i){var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(key)?values[key]:dict[key];result.push(value,strings[i+1]);});return result.join('');};}
function _isMarketplaceBidder(bidderCode){return bidderCode===AOL_BIDDERS_CODES.AOL||bidderCode===AOL_BIDDERS_CODES.VERIZON||bidderCode===AOL_BIDDERS_CODES.ONEDISPLAY;}
function _isOneMobileBidder(bidderCode){return bidderCode===AOL_BIDDERS_CODES.AOL||bidderCode===AOL_BIDDERS_CODES.VERIZON||bidderCode===AOL_BIDDERS_CODES.ONEMOBILE;}
function _isNexageRequestPost(bid){if(_isOneMobileBidder(bid.bidder)&&bid.params.id&&bid.params.imp&&bid.params.imp[0]){var imp=bid.params.imp[0];return imp.id&&imp.tagid&&imp.banner&&imp.banner.w&&imp.banner.h;}}
function _isNexageRequestGet(bid){return _isOneMobileBidder(bid.bidder)&&bid.params.dcn&&bid.params.pos;}
function isMarketplaceBid(bid){return _isMarketplaceBidder(bid.bidder)&&bid.params.placement&&bid.params.network;}
function isMobileBid(bid){return _isNexageRequestGet(bid)||_isNexageRequestPost(bid);}
function resolveEndpointCode(bid){if(_isNexageRequestGet(bid)){return AOL_ENDPOINTS.MOBILE.GET;}else if(_isNexageRequestPost(bid)){return AOL_ENDPOINTS.MOBILE.POST;}else if(isMarketplaceBid(bid)){return AOL_ENDPOINTS.DISPLAY.GET;}}
function getSupportedEids(bid){return bid.userIdAsEids.filter(function(eid){return SUPPORTED_USER_ID_SOURCES.indexOf(eid.source)!==-1;});}
var spec={code:AOL_BIDDERS_CODES.AOL,gvlid:25,aliases:[AOL_BIDDERS_CODES.ONEMOBILE,AOL_BIDDERS_CODES.ONEDISPLAY,AOL_BIDDERS_CODES.VERIZON],supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER],isBidRequestValid:function isBidRequestValid(bid){return isMarketplaceBid(bid)||isMobileBid(bid);},buildRequests:function buildRequests(bids,bidderRequest){var _this=this;var consentData={};if(bidderRequest){consentData.gdpr=bidderRequest.gdprConsent;consentData.uspConsent=bidderRequest.uspConsent;}
return bids.map(function(bid){var endpointCode=resolveEndpointCode(bid);if(endpointCode){return _this.formatBidRequest(endpointCode,bid,consentData);}});},interpretResponse:function interpretResponse(_ref,bidRequest){var body=_ref.body;if(!body){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Empty bid response',bidRequest.bidderCode,body);}else{var bid=this._parseBidResponse(body,bidRequest);if(bid){return bid;}}},getUserSyncs:function getUserSyncs(options,serverResponses){var bidResponse=!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty)(serverResponses)&&serverResponses[0].body;if(bidResponse&&bidResponse.ext&&bidResponse.ext.pixels){return this.parsePixelItems(bidResponse.ext.pixels);}
return[];},formatBidRequest:function formatBidRequest(endpointCode,bid,consentData){var bidRequest;switch(endpointCode){case AOL_ENDPOINTS.DISPLAY.GET:bidRequest={url:this.buildMarketplaceUrl(bid,consentData),method:'GET',ttl:ONE_DISPLAY_TTL};break;case AOL_ENDPOINTS.MOBILE.GET:bidRequest={url:this.buildOneMobileGetUrl(bid,consentData),method:'GET',ttl:ONE_MOBILE_TTL};break;case AOL_ENDPOINTS.MOBILE.POST:bidRequest={url:this.buildOneMobileBaseUrl(bid),method:'POST',ttl:ONE_MOBILE_TTL,data:this.buildOpenRtbRequestData(bid,consentData),options:{contentType:'application/json',customHeaders:{'x-openrtb-version':'2.2'}}};break;}
bidRequest.bidderCode=bid.bidder;bidRequest.bidId=bid.bidId;bidRequest.userSyncOn=bid.params.userSyncOn;return bidRequest;},buildMarketplaceUrl:function buildMarketplaceUrl(bid,consentData){var params=bid.params;var serverParam=params.server;var regionParam=params.region||'us';var server;if(!MP_SERVER_MAP.hasOwnProperty(regionParam)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("Unknown region '".concat(regionParam,"' for AOL bidder."));regionParam='us';}
if(serverParam){server=serverParam;}else{server=MP_SERVER_MAP[regionParam];}
params.region=regionParam;return this.applyProtocol(pubapiTemplate({host:server,network:params.network,placement:parseInt(params.placement),pageid:params.pageId||0,sizeid:params.sizeId||0,alias:params.alias||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getUniqueIdentifierStr)(),misc:new Date().getTime(),dynamicParams:this.formatMarketplaceDynamicParams(params,consentData)}));},buildOneMobileGetUrl:function buildOneMobileGetUrl(bid,consentData){var _bid$params=bid.params,dcn=_bid$params.dcn,pos=_bid$params.pos,ext=_bid$params.ext;if(_typeof(bid.userId)==='object'){ext=ext||{};var eids=getSupportedEids(bid);eids.forEach(function(eid){ext['eid'+eid.source]=eid.uids[0].id;});}
var nexageApi=this.buildOneMobileBaseUrl(bid);if(dcn&&pos){var dynamicParams=this.formatOneMobileDynamicParams(ext,consentData);nexageApi+=nexageGetApiTemplate({dcn:dcn,pos:pos,dynamicParams:dynamicParams});}
return nexageApi;},buildOneMobileBaseUrl:function buildOneMobileBaseUrl(bid){return this.applyProtocol(nexageBaseApiTemplate({host:bid.params.host||NEXAGE_SERVER}));},applyProtocol:function applyProtocol(url){if(/^https?:\/\//i.test(url)){return url;}
return url.indexOf('//')===0?"".concat(DEFAULT_PROTO,":").concat(url):"".concat(DEFAULT_PROTO,"://").concat(url);},formatMarketplaceDynamicParams:function formatMarketplaceDynamicParams(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var consentData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var queryParams={};_extends(queryParams,this.formatKeyValues(params.keyValues));_extends(queryParams,this.formatConsentData(consentData));var paramsFormatted='';(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(queryParams,function(value,key){paramsFormatted+="".concat(key,"=").concat(encodeURIComponent(value),";");});return paramsFormatted;},formatOneMobileDynamicParams:function formatOneMobileDynamicParams(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var consentData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(this.isSecureProtocol()){params.secure=NUMERIC_VALUES.TRUE;}
_extends(params,this.formatConsentData(consentData));var paramsFormatted='';(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(params,function(value,key){paramsFormatted+="&".concat(key,"=").concat(encodeURIComponent(value));});return paramsFormatted;},buildOpenRtbRequestData:function buildOpenRtbRequestData(bid){var consentData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var openRtbObject={id:bid.params.id,imp:bid.params.imp};if(this.isEUConsentRequired(consentData)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(openRtbObject,'regs.ext.gdpr',NUMERIC_VALUES.TRUE);if(consentData.gdpr.consentString){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(openRtbObject,'user.ext.consent',consentData.gdpr.consentString);}}
if(consentData.uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(openRtbObject,'regs.ext.us_privacy',consentData.uspConsent);}
if(_typeof(bid.userId)==='object'){openRtbObject.user=openRtbObject.user||{};openRtbObject.user.ext=openRtbObject.user.ext||{};var eids=getSupportedEids(bid);if(eids.length>0){openRtbObject.user.ext.eids=eids;}}
return openRtbObject;},isEUConsentRequired:function isEUConsentRequired(consentData){return!!(consentData&&consentData.gdpr&&consentData.gdpr.gdprApplies);},formatKeyValues:function formatKeyValues(keyValues){var keyValuesHash={};(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(keyValues,function(value,key){keyValuesHash["kv".concat(key)]=value;});return keyValuesHash;},formatConsentData:function formatConsentData(consentData){var params={};if(this.isEUConsentRequired(consentData)){params.gdpr=NUMERIC_VALUES.TRUE;if(consentData.gdpr.consentString){params.euconsent=consentData.gdpr.consentString;}}
if(consentData.uspConsent){params.us_privacy=consentData.uspConsent;}
return params;},parsePixelItems:function parsePixelItems(pixels){var itemsRegExp=/(img|iframe)[\s\S]*?src\s*=\s*("|')(.*?)\2/gi;var tagNameRegExp=/\w*(?=\s)/;var srcRegExp=/src=("|')(.*?)\1/;var pixelsItems=[];if(pixels){var matchedItems=pixels.match(itemsRegExp);if(matchedItems){matchedItems.forEach(function(item){var tagName=item.match(tagNameRegExp)[0];var url=item.match(srcRegExp)[2];if(tagName&&url){pixelsItems.push({type:tagName===SYNC_TYPES.IMAGE.TAG?SYNC_TYPES.IMAGE.TYPE:SYNC_TYPES.IFRAME.TYPE,url:url});}});}}
return pixelsItems;},_parseBidResponse:function _parseBidResponse(response,bidRequest){var bidData;try{bidData=response.seatbid[0].bid[0];}catch(e){return;}
var cpm;if(bidData.ext&&bidData.ext.encp){cpm=bidData.ext.encp;}else{cpm=bidData.price;if(cpm===null||isNaN(cpm)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Invalid price in bid response',AOL_BIDDERS_CODES.AOL,bidData);return;}}
return{bidderCode:bidRequest.bidderCode,requestId:bidRequest.bidId,ad:bidData.adm,cpm:cpm,width:bidData.w,height:bidData.h,creativeId:bidData.crid||0,pubapiId:response.id,currency:response.cur||'USD',dealId:bidData.dealid,netRevenue:true,meta:{advertiserDomains:bidData&&bidData.adomain?bidData.adomain:[]},ttl:bidRequest.ttl};},isOneMobileBidder:_isOneMobileBidder,isSecureProtocol:function isSecureProtocol(){return document.location.protocol==='https:';}};(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__.registerBidder)(spec);window.pbjs.installedModules.push('aolBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/aolBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["appnexusBidAdapter"],{"./modules/appnexusBidAdapter.js":
/*!***************************************!*\
  !*** ./modules/appnexusBidAdapter.js ***!
  \***************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_Renderer_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../src/Renderer.js */
"./src/Renderer.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_auctionManager_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ../src/auctionManager.js */
"./src/auctionManager.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");var _src_video_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ../src/video.js */
"./src/video.js");var _src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/storageManager.js */
"./src/storageManager.js");var _src_bidderSettings_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/bidderSettings.js */
"./src/bidderSettings.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var BIDDER_CODE='appnexus';var URL='https://ib.adnxs.com/ut/v3/prebid';var URL_SIMPLE='https://ib.adnxs-simple.com/ut/v3/prebid';var VIDEO_TARGETING=['id','minduration','maxduration','skippable','playback_method','frameworks','context','skipoffset'];var VIDEO_RTB_TARGETING=['minduration','maxduration','skip','skipafter','playbackmethod','api'];var USER_PARAMS=['age','externalUid','segments','gender','dnt','language'];var APP_DEVICE_PARAMS=['geo','device_id'];var DEBUG_PARAMS=['enabled','dongle','member_id','debug_timeout'];var VIDEO_MAPPING={playback_method:{'unknown':0,'auto_play_sound_on':1,'auto_play_sound_off':2,'click_to_play':3,'mouse_over':4,'auto_play_sound_unknown':5},context:{'unknown':0,'pre_roll':1,'mid_roll':2,'post_roll':3,'outstream':4,'in-banner':5}};var NATIVE_MAPPING={body:'description',body2:'desc2',cta:'ctatext',image:{serverName:'main_image',requiredParams:{required:true}},icon:{serverName:'icon',requiredParams:{required:true}},sponsoredBy:'sponsored_by',privacyLink:'privacy_link',salePrice:'saleprice',displayUrl:'displayurl'};var SOURCE='pbjs';var MAX_IMPS_PER_REQUEST=15;var mappingFileUrl='https://acdn.adnxs-simple.com/prebid/appnexus-mapping/mappings.json';var SCRIPT_TAG_START='<script';var VIEWABILITY_URL_START=/\/\/cdn\.adnxs\.com\/v|\/\/cdn\.adnxs\-simple\.com\/v/;var VIEWABILITY_FILE_NAME='trk.js';var GVLID=32;var storage=(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__.getStorageManager)({gvlid:GVLID,bidderCode:BIDDER_CODE});var spec={code:BIDDER_CODE,gvlid:GVLID,aliases:[{code:'appnexusAst',gvlid:32},{code:'brealtime'},{code:'emxdigital',gvlid:183},{code:'pagescience'},{code:'defymedia'},{code:'gourmetads'},{code:'matomy'},{code:'featureforward'},{code:'oftmedia'},{code:'districtm',gvlid:144},{code:'adasta'},{code:'beintoo',gvlid:618}],supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE],isBidRequestValid:function isBidRequestValid(bid){return!!(bid.params.placementId||bid.params.member&&bid.params.invCode);},buildRequests:function buildRequests(bidRequests,bidderRequest){var tags=bidRequests.map(bidToTag);var userObjBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasUserInfo);var userObj={};if(_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('coppa')===true){userObj={'coppa':true};}
if(userObjBid){Object.keys(userObjBid.params.user).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(USER_PARAMS,param);}).forEach(function(param){var uparam=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.convertCamelToUnderscore)(param);if(param==='segments'&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(userObjBid.params.user[param])){var segs=[];userObjBid.params.user[param].forEach(function(val){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isNumber)(val)){segs.push({'id':val});}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isPlainObject)(val)){segs.push(val);}});userObj[uparam]=segs;}else if(param!=='segments'){userObj[uparam]=userObjBid.params.user[param];}});}
var appDeviceObjBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasAppDeviceInfo);var appDeviceObj;if(appDeviceObjBid&&appDeviceObjBid.params&&appDeviceObjBid.params.app){appDeviceObj={};Object.keys(appDeviceObjBid.params.app).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(APP_DEVICE_PARAMS,param);}).forEach(function(param){return appDeviceObj[param]=appDeviceObjBid.params.app[param];});}
var appIdObjBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasAppId);var appIdObj;if(appIdObjBid&&appIdObjBid.params&&appDeviceObjBid.params.app&&appDeviceObjBid.params.app.id){appIdObj={appid:appIdObjBid.params.app.id};}
var debugObj={};var debugObjParams={};var debugCookieName='apn_prebid_debug';var debugCookie=storage.getCookie(debugCookieName)||null;if(debugCookie){try{debugObj=JSON.parse(debugCookie);}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('AppNexus Debug Auction Cookie Error:\n\n'+e);}}else{var debugBidRequest=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasDebug);if(debugBidRequest&&debugBidRequest.debug){debugObj=debugBidRequest.debug;}}
if(debugObj&&debugObj.enabled){Object.keys(debugObj).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(DEBUG_PARAMS,param);}).forEach(function(param){debugObjParams[param]=debugObj[param];});}
var memberIdBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasMemberId);var member=memberIdBid?parseInt(memberIdBid.params.member,10):0;var schain=bidRequests[0].schain;var omidSupport=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasOmidSupport);var payload={tags:_toConsumableArray(tags),user:userObj,sdk:{source:SOURCE,version:"6.24.1"},schain:schain};if(omidSupport){payload['iab_support']={omidpn:'Appnexus',omidpv:"6.24.1"};}
if(member>0){payload.member_id=member;}
if(appDeviceObjBid){payload.device=appDeviceObj;}
if(appIdObjBid){payload.app=appIdObj;}
var auctionKeywords=_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('appnexusAuctionKeywords');if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isPlainObject)(auctionKeywords)){var aucKeywords=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.transformBidderParamKeywords)(auctionKeywords);if(aucKeywords.length>0){aucKeywords.forEach(deleteValues);}
payload.keywords=aucKeywords;}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('adpod.brandCategoryExclusion')){payload.brand_category_uniqueness=true;}
if(debugObjParams.enabled){payload.debug=debugObjParams;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logInfo)('AppNexus Debug Auction Settings:\n\n'+JSON.stringify(debugObjParams,null,4));}
if(bidderRequest&&bidderRequest.gdprConsent){payload.gdpr_consent={consent_string:bidderRequest.gdprConsent.consentString,consent_required:bidderRequest.gdprConsent.gdprApplies};if(bidderRequest.gdprConsent.addtlConsent&&bidderRequest.gdprConsent.addtlConsent.indexOf('~')!==-1){var ac=bidderRequest.gdprConsent.addtlConsent;var acStr=ac.substring(ac.indexOf('~')+1);payload.gdpr_consent.addtl_consent=acStr.split('.').map(function(id){return parseInt(id,10);});}}
if(bidderRequest&&bidderRequest.uspConsent){payload.us_privacy=bidderRequest.uspConsent;}
if(bidderRequest&&bidderRequest.refererInfo){var refererinfo={rd_ref:encodeURIComponent(bidderRequest.refererInfo.referer),rd_top:bidderRequest.refererInfo.reachedTop,rd_ifs:bidderRequest.refererInfo.numIframes,rd_stk:bidderRequest.refererInfo.stack.map(function(url){return encodeURIComponent(url);}).join(',')};var pubPageUrl=_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('pageUrl');if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isStr)(pubPageUrl)&&pubPageUrl!==''){refererinfo.rd_can=pubPageUrl;}
payload.referrer_detection=refererinfo;}
var hasAdPodBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidRequests,hasAdPod);if(hasAdPodBid){bidRequests.filter(hasAdPod).forEach(function(adPodBid){var adPodTags=createAdPodRequest(tags,adPodBid);var nonPodTags=payload.tags.filter(function(tag){return tag.uuid!==adPodBid.bidId;});payload.tags=[].concat(_toConsumableArray(nonPodTags),_toConsumableArray(adPodTags));});}
if(bidRequests[0].userId){var eids=[];addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.flocId.id"),'chrome.com',null);addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.criteoId"),'criteo.com',null);addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.netId"),'netid.de',null);addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.idl_env"),'liveramp.com',null);addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.tdid"),'adserver.org','TDID');addUserId(eids,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequests[0],"userId.uid2.id"),'uidapi.com','UID2');if(bidRequests[0].userId.pubProvidedId){bidRequests[0].userId.pubProvidedId.forEach(function(ppId){ppId.uids.forEach(function(uid){eids.push({source:ppId.source,id:uid.id});});});}
if(eids.length){payload.eids=eids;}}
if(tags[0].publisher_id){payload.publisher_id=tags[0].publisher_id;}
var request=formatRequest(payload,bidderRequest);return request;},interpretResponse:function interpretResponse(serverResponse,_ref){var _this=this;var bidderRequest=_ref.bidderRequest;serverResponse=serverResponse.body;var bids=[];if(!serverResponse||serverResponse.error){var errorMessage="in response for ".concat(bidderRequest.bidderCode," adapter");if(serverResponse&&serverResponse.error){errorMessage+=": ".concat(serverResponse.error);}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)(errorMessage);return bids;}
if(serverResponse.tags){serverResponse.tags.forEach(function(serverBid){var rtbBid=getRtbBid(serverBid);if(rtbBid){var cpmCheck=_src_bidderSettings_js__WEBPACK_IMPORTED_MODULE_6__.bidderSettings.get(bidderRequest.bidderCode,'allowZeroCpmBids')===true?rtbBid.cpm>=0:rtbBid.cpm>0;if(cpmCheck&&(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(_this.supportedMediaTypes,rtbBid.ad_type)){var bid=newBid(serverBid,rtbBid,bidderRequest);bid.mediaType=parseMediaType(rtbBid);bids.push(bid);}}});}
if(serverResponse.debug&&serverResponse.debug.debug_info){var debugHeader='AppNexus Debug Auction for Prebid\n\n';var debugText=debugHeader+serverResponse.debug.debug_info;debugText=debugText.replace(/(<td>|<th>)/gm,'\t').replace(/(<\/td>|<\/th>)/gm,'\n').replace(/^<br>/gm,'').replace(/(<br>\n|<br>)/gm,'\n').replace(/<h1>(.*)<\/h1>/gm,'\n\n===== $1 =====\n\n').replace(/<h[2-6]>(.*)<\/h[2-6]>/gm,'\n\n*** $1 ***\n\n').replace(/(<([^>]+)>)/igm,'');(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('https://console.appnexus.com/docs/understanding-the-debug-auction');(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)(debugText);}
return bids;},getMappingFileInfo:function getMappingFileInfo(){return{url:mappingFileUrl,refreshInDays:2};},getUserSyncs:function getUserSyncs(syncOptions,responses,gdprConsent){if(syncOptions.iframeEnabled&&hasPurpose1Consent({gdprConsent:gdprConsent})){return[{type:'iframe',url:'https://acdn.adnxs.com/dmp/async_usersync.html'}];}},transformBidParams:function transformBidParams(params,isOpenRtb){var conversionFn=_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.transformBidderParamKeywords;if(isOpenRtb===true){var s2sConfig=_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('s2sConfig');var s2sEndpointUrl=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(s2sConfig,'endpoint.p1Consent');if(s2sEndpointUrl&&s2sEndpointUrl.match('/openrtb2/prebid')){conversionFn=convertKeywordsToString;}}
params=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.convertTypes)({'member':'string','invCode':'string','placementId':'number','keywords':conversionFn,'publisherId':'number'},params);if(isOpenRtb){params.use_pmt_rule=typeof params.usePaymentRule==='boolean'?params.usePaymentRule:false;if(params.usePaymentRule){delete params.usePaymentRule;}
if(isPopulatedArray(params.keywords)){params.keywords.forEach(deleteValues);}
Object.keys(params).forEach(function(paramKey){var convertedKey=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.convertCamelToUnderscore)(paramKey);if(convertedKey!==paramKey){params[convertedKey]=params[paramKey];delete params[paramKey];}});}
return params;},onBidWon:function onBidWon(bid){if(bid.native){reloadViewabilityScriptWithCorrectParameters(bid);}}};function isPopulatedArray(arr){return!!((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(arr)&&arr.length>0);}
function deleteValues(keyPairObj){if(isPopulatedArray(keyPairObj.value)&&keyPairObj.value[0]===''){delete keyPairObj.value;}}
function reloadViewabilityScriptWithCorrectParameters(bid){var viewJsPayload=getAppnexusViewabilityScriptFromJsTrackers(bid.native.javascriptTrackers);if(viewJsPayload){var prebidParams='pbjs_adid='+bid.adId+';pbjs_auc='+bid.adUnitCode;var jsTrackerSrc=getViewabilityScriptUrlFromPayload(viewJsPayload);var newJsTrackerSrc=jsTrackerSrc.replace('dom_id=%native_dom_id%',prebidParams);var frameArray=document.getElementsByTagName('iframe');var modifiedAScript=false;for(var i=0;i<frameArray.length&&!modifiedAScript;i++){var currentFrame=frameArray[i];try{var nestedDoc=currentFrame.contentDocument||currentFrame.contentWindow.document;if(nestedDoc){var scriptArray=nestedDoc.getElementsByTagName('script');for(var j=0;j<scriptArray.length&&!modifiedAScript;j++){var currentScript=scriptArray[j];if(currentScript.getAttribute('data-src')==jsTrackerSrc){currentScript.setAttribute('src',newJsTrackerSrc);currentScript.setAttribute('data-src','');if(currentScript.removeAttribute){currentScript.removeAttribute('data-src');}
modifiedAScript=true;}}}}catch(exception){if(!(exception instanceof DOMException&&exception.name==='SecurityError')){throw exception;}}}}}
function strIsAppnexusViewabilityScript(str){var regexMatchUrlStart=str.match(VIEWABILITY_URL_START);var viewUrlStartInStr=regexMatchUrlStart!=null&&regexMatchUrlStart.length>=1;var regexMatchFileName=str.match(VIEWABILITY_FILE_NAME);var fileNameInStr=regexMatchFileName!=null&&regexMatchFileName.length>=1;return str.startsWith(SCRIPT_TAG_START)&&fileNameInStr&&viewUrlStartInStr;}
function getAppnexusViewabilityScriptFromJsTrackers(jsTrackerArray){var viewJsPayload;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isStr)(jsTrackerArray)&&strIsAppnexusViewabilityScript(jsTrackerArray)){viewJsPayload=jsTrackerArray;}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(jsTrackerArray)){for(var i=0;i<jsTrackerArray.length;i++){var currentJsTracker=jsTrackerArray[i];if(strIsAppnexusViewabilityScript(currentJsTracker)){viewJsPayload=currentJsTracker;}}}
return viewJsPayload;}
function getViewabilityScriptUrlFromPayload(viewJsPayload){var indexOfFirstQuote=viewJsPayload.indexOf('src="')+5;var indexOfSecondQuote=viewJsPayload.indexOf('"',indexOfFirstQuote);var jsTrackerSrc=viewJsPayload.substring(indexOfFirstQuote,indexOfSecondQuote);return jsTrackerSrc;}
function hasPurpose1Consent(bidderRequest){var result=true;if(bidderRequest&&bidderRequest.gdprConsent){if(bidderRequest.gdprConsent.gdprApplies&&bidderRequest.gdprConsent.apiVersion===2){result=!!((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidderRequest.gdprConsent,'vendorData.purpose.consents.1')===true);}}
return result;}
function formatRequest(payload,bidderRequest){var request=[];var options={withCredentials:true};var endpointUrl=URL;if(!hasPurpose1Consent(bidderRequest)){endpointUrl=URL_SIMPLE;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.getParameterByName)('apn_test').toUpperCase()==='TRUE'||_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('apn_test')===true){options.customHeaders={'X-Is-Test':1};}
if(payload.tags.length>MAX_IMPS_PER_REQUEST){var clonedPayload=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.deepClone)(payload);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.chunk)(payload.tags,MAX_IMPS_PER_REQUEST).forEach(function(tags){clonedPayload.tags=tags;var payloadString=JSON.stringify(clonedPayload);request.push({method:'POST',url:endpointUrl,data:payloadString,bidderRequest:bidderRequest,options:options});});}else{var payloadString=JSON.stringify(payload);request={method:'POST',url:endpointUrl,data:payloadString,bidderRequest:bidderRequest,options:options};}
return request;}
function newRenderer(adUnitCode,rtbBid){var rendererOptions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var renderer=_src_Renderer_js__WEBPACK_IMPORTED_MODULE_7__.Renderer.install({id:rtbBid.renderer_id,url:rtbBid.renderer_url,config:rendererOptions,loaded:false,adUnitCode:adUnitCode});try{renderer.setRender(outstreamRender);}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logWarn)('Prebid Error calling setRender on renderer',err);}
renderer.setEventHandlers({impression:function impression(){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('AppNexus outstream video impression event');},loaded:function loaded(){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('AppNexus outstream video loaded event');},ended:function ended(){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logMessage)('AppNexus outstream renderer video event');document.querySelector("#".concat(adUnitCode)).style.display='none';}});return renderer;}
function newBid(serverBid,rtbBid,bidderRequest){var bidRequest=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.getBidRequest)(serverBid.uuid,[bidderRequest]);var bid={requestId:serverBid.uuid,cpm:rtbBid.cpm,creativeId:rtbBid.creative_id,dealId:rtbBid.deal_id,currency:'USD',netRevenue:true,ttl:300,adUnitCode:bidRequest.adUnitCode,appnexus:{buyerMemberId:rtbBid.buyer_member_id,dealPriority:rtbBid.deal_priority,dealCode:rtbBid.deal_code}};if(rtbBid.adomain){bid.meta=_extends({},bid.meta,{advertiserDomains:[]});}
if(rtbBid.advertiser_id){bid.meta=_extends({},bid.meta,{advertiserId:rtbBid.advertiser_id});}
function setupDChain(rtbBid){var dchain={ver:'1.0',complete:0,nodes:[{bsid:rtbBid.buyer_member_id.toString()}]};return dchain;}
if(rtbBid.buyer_member_id){bid.meta=_extends({},bid.meta,{dchain:setupDChain(rtbBid)});}
if(rtbBid.brand_id){bid.meta=_extends({},bid.meta,{brandId:rtbBid.brand_id});}
if(rtbBid.rtb.video){_extends(bid,{width:rtbBid.rtb.video.player_width,height:rtbBid.rtb.video.player_height,vastImpUrl:rtbBid.notify_url,ttl:3600});var videoContext=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidRequest,'mediaTypes.video.context');switch(videoContext){case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.ADPOD:var primaryCatId=(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_8__.getIabSubCategory)(bidRequest.bidder,rtbBid.brand_category_id);bid.meta=_extends({},bid.meta,{primaryCatId:primaryCatId});var dealTier=rtbBid.deal_priority;bid.video={context:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.ADPOD,durationSeconds:Math.floor(rtbBid.rtb.video.duration_ms/1000),dealTier:dealTier};bid.vastUrl=rtbBid.rtb.video.asset_url;break;case _src_video_js__WEBPACK_IMPORTED_MODULE_9__.OUTSTREAM:bid.adResponse=serverBid;bid.adResponse.ad=bid.adResponse.ads[0];bid.adResponse.ad.video=bid.adResponse.ad.rtb.video;bid.vastXml=rtbBid.rtb.video.content;if(rtbBid.renderer_url){var videoBid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(bidderRequest.bids,function(bid){return bid.bidId===serverBid.uuid;});var rendererOptions=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(videoBid,'mediaTypes.video.renderer.options');if(!rendererOptions){rendererOptions=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(videoBid,'renderer.options');}
bid.renderer=newRenderer(bid.adUnitCode,rtbBid,rendererOptions);}
break;case _src_video_js__WEBPACK_IMPORTED_MODULE_9__.INSTREAM:bid.vastUrl=rtbBid.notify_url+'&redir='+encodeURIComponent(rtbBid.rtb.video.asset_url);break;}}else if(rtbBid.rtb[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE]){var nativeAd=rtbBid.rtb[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE];var jsTrackerDisarmed=rtbBid.viewability.config.replace('src=','data-src=');var jsTrackers=nativeAd.javascript_trackers;if(jsTrackers==undefined){jsTrackers=jsTrackerDisarmed;}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isStr)(jsTrackers)){jsTrackers=[jsTrackers,jsTrackerDisarmed];}else{jsTrackers.push(jsTrackerDisarmed);}
bid[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE]={title:nativeAd.title,body:nativeAd.desc,body2:nativeAd.desc2,cta:nativeAd.ctatext,rating:nativeAd.rating,sponsoredBy:nativeAd.sponsored,privacyLink:nativeAd.privacy_link,address:nativeAd.address,downloads:nativeAd.downloads,likes:nativeAd.likes,phone:nativeAd.phone,price:nativeAd.price,salePrice:nativeAd.saleprice,clickUrl:nativeAd.link.url,displayUrl:nativeAd.displayurl,clickTrackers:nativeAd.link.click_trackers,impressionTrackers:nativeAd.impression_trackers,javascriptTrackers:jsTrackers};if(nativeAd.main_img){bid['native'].image={url:nativeAd.main_img.url,height:nativeAd.main_img.height,width:nativeAd.main_img.width};}
if(nativeAd.icon){bid['native'].icon={url:nativeAd.icon.url,height:nativeAd.icon.height,width:nativeAd.icon.width};}}else{_extends(bid,{width:rtbBid.rtb.banner.width,height:rtbBid.rtb.banner.height,ad:rtbBid.rtb.banner.content});try{if(rtbBid.rtb.trackers){for(var i=0;i<rtbBid.rtb.trackers[0].impression_urls.length;i++){var url=rtbBid.rtb.trackers[0].impression_urls[i];var tracker=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.createTrackPixelHtml)(url);bid.ad+=tracker;}}}catch(error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.logError)('Error appending tracking pixel',error);}}
return bid;}
function bidToTag(bid){var tag={};tag.sizes=transformSizes(bid.sizes);tag.primary_size=tag.sizes[0];tag.ad_types=[];tag.uuid=bid.bidId;if(bid.params.placementId){tag.id=parseInt(bid.params.placementId,10);}else{tag.code=bid.params.invCode;}
tag.allow_smaller_sizes=bid.params.allowSmallerSizes||false;tag.use_pmt_rule=bid.params.usePaymentRule||false;tag.prebid=true;tag.disable_psa=true;var bidFloor=getBidFloor(bid);if(bidFloor){tag.reserve=bidFloor;}
if(bid.params.position){tag.position={'above':1,'below':2}[bid.params.position]||0;}else{var mediaTypePos=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,"mediaTypes.banner.pos")||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,"mediaTypes.video.pos");if(mediaTypePos===0||mediaTypePos===1||mediaTypePos===3){tag.position=mediaTypePos===3?2:mediaTypePos;}}
if(bid.params.trafficSourceCode){tag.traffic_source_code=bid.params.trafficSourceCode;}
if(bid.params.privateSizes){tag.private_sizes=transformSizes(bid.params.privateSizes);}
if(bid.params.supplyType){tag.supply_type=bid.params.supplyType;}
if(bid.params.pubClick){tag.pubclick=bid.params.pubClick;}
if(bid.params.extInvCode){tag.ext_inv_code=bid.params.extInvCode;}
if(bid.params.publisherId){tag.publisher_id=parseInt(bid.params.publisherId,10);}
if(bid.params.externalImpId){tag.external_imp_id=bid.params.externalImpId;}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(bid.params.keywords)){var keywords=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.transformBidderParamKeywords)(bid.params.keywords);if(keywords.length>0){keywords.forEach(deleteValues);}
tag.keywords=keywords;}
var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,'ortb2Imp.ext.data.pbadslot');if(gpid){tag.gpid=gpid;}
if(bid.mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,"mediaTypes.".concat(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE))){tag.ad_types.push(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE);if(tag.sizes.length===0){tag.sizes=transformSizes([1,1]);}
if(bid.nativeParams){var nativeRequest=buildNativeRequest(bid.nativeParams);tag[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE]={layouts:[nativeRequest]};}}
var videoMediaType=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,"mediaTypes.".concat(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO));var context=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bid,'mediaTypes.video.context');if(videoMediaType&&context==='adpod'){tag.hb_source=7;}else{tag.hb_source=1;}
if(bid.mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO||videoMediaType){tag.ad_types.push(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO);}
if(bid.mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO||videoMediaType&&context!=='outstream'){tag.require_asset_url=true;}
if(bid.params.video){tag.video={};Object.keys(bid.params.video).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(VIDEO_TARGETING,param);}).forEach(function(param){switch(param){case'context':case'playback_method':var type=bid.params.video[param];type=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(type)?type[0]:type;tag.video[param]=VIDEO_MAPPING[param][type];break;case'frameworks':break;default:tag.video[param]=bid.params.video[param];}});if(bid.params.video.frameworks&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(bid.params.video.frameworks)){tag['video_frameworks']=bid.params.video.frameworks;}}
if(videoMediaType){tag.video=tag.video||{};Object.keys(videoMediaType).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(VIDEO_RTB_TARGETING,param);}).forEach(function(param){switch(param){case'minduration':case'maxduration':if(typeof tag.video[param]!=='number')tag.video[param]=videoMediaType[param];break;case'skip':if(typeof tag.video['skippable']!=='boolean')tag.video['skippable']=videoMediaType[param]===1;break;case'skipafter':if(typeof tag.video['skipoffset']!=='number')tag.video['skippoffset']=videoMediaType[param];break;case'playbackmethod':if(typeof tag.video['playback_method']!=='number'){var type=videoMediaType[param];type=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(type)?type[0]:type;if(type>=1&&type<=4){tag.video['playback_method']=type;}}
break;case'api':if(!tag['video_frameworks']&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(videoMediaType[param])){var apiTmp=videoMediaType[param].map(function(val){var v=val===4?5:val===5?4:val;if(v>=1&&v<=5){return v;}}).filter(function(v){return v;});tag['video_frameworks']=apiTmp;}
break;}});}
if(bid.renderer){tag.video=_extends({},tag.video,{custom_renderer_present:true});}
if(bid.params.frameworks&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(bid.params.frameworks)){tag['banner_frameworks']=bid.params.frameworks;}
var adUnit=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(_src_auctionManager_js__WEBPACK_IMPORTED_MODULE_10__.auctionManager.getAdUnits(),function(au){return bid.transactionId===au.transactionId;});if(adUnit&&adUnit.mediaTypes&&adUnit.mediaTypes.banner){tag.ad_types.push(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER);}
if(tag.ad_types.length===0){delete tag.ad_types;}
return tag;}
function transformSizes(requestSizes){var sizes=[];var sizeObj={};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(requestSizes)&&requestSizes.length===2&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(requestSizes[0])){sizeObj.width=parseInt(requestSizes[0],10);sizeObj.height=parseInt(requestSizes[1],10);sizes.push(sizeObj);}else if(_typeof(requestSizes)==='object'){for(var i=0;i<requestSizes.length;i++){var size=requestSizes[i];sizeObj={};sizeObj.width=parseInt(size[0],10);sizeObj.height=parseInt(size[1],10);sizes.push(sizeObj);}}
return sizes;}
function hasUserInfo(bid){return!!bid.params.user;}
function hasMemberId(bid){return!!parseInt(bid.params.member,10);}
function hasAppDeviceInfo(bid){if(bid.params){return!!bid.params.app;}}
function hasAppId(bid){if(bid.params&&bid.params.app){return!!bid.params.app.id;}
return!!bid.params.app;}
function hasDebug(bid){return!!bid.debug;}
function hasAdPod(bid){return bid.mediaTypes&&bid.mediaTypes.video&&bid.mediaTypes.video.context===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.ADPOD;}
function hasOmidSupport(bid){var hasOmid=false;var bidderParams=bid.params;var videoParams=bid.params.video;if(bidderParams.frameworks&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(bidderParams.frameworks)){hasOmid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(bid.params.frameworks,6);}
if(!hasOmid&&videoParams&&videoParams.frameworks&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(videoParams.frameworks)){hasOmid=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.includes)(bid.params.video.frameworks,6);}
return hasOmid;}
function createAdPodRequest(tags,adPodBid){var _adPodBid$mediaTypes$=adPodBid.mediaTypes.video,durationRangeSec=_adPodBid$mediaTypes$.durationRangeSec,requireExactDuration=_adPodBid$mediaTypes$.requireExactDuration;var numberOfPlacements=getAdPodPlacementNumber(adPodBid.mediaTypes.video);var maxDuration=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.getMaxValueFromArray)(durationRangeSec);var tagToDuplicate=tags.filter(function(tag){return tag.uuid===adPodBid.bidId;});var request=_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.fill.apply(void 0,_toConsumableArray(tagToDuplicate).concat([numberOfPlacements]));if(requireExactDuration){var divider=Math.ceil(numberOfPlacements/durationRangeSec.length);var chunked=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.chunk)(request,divider);durationRangeSec.forEach(function(duration,index){chunked[index].map(function(tag){setVideoProperty(tag,'minduration',duration);setVideoProperty(tag,'maxduration',duration);});});}else{request.map(function(tag){return setVideoProperty(tag,'maxduration',maxDuration);});}
return request;}
function getAdPodPlacementNumber(videoParams){var adPodDurationSec=videoParams.adPodDurationSec,durationRangeSec=videoParams.durationRangeSec,requireExactDuration=videoParams.requireExactDuration;var minAllowedDuration=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.getMinValueFromArray)(durationRangeSec);var numberOfPlacements=Math.floor(adPodDurationSec/minAllowedDuration);return requireExactDuration?Math.max(numberOfPlacements,durationRangeSec.length):numberOfPlacements;}
function setVideoProperty(tag,key,value){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(tag.video)){tag.video={};}
tag.video[key]=value;}
function getRtbBid(tag){return tag&&tag.ads&&tag.ads.length&&(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_2__.find)(tag.ads,function(ad){return ad.rtb;});}
function buildNativeRequest(params){var request={};Object.keys(params).forEach(function(key){var requestKey=NATIVE_MAPPING[key]&&NATIVE_MAPPING[key].serverName||NATIVE_MAPPING[key]||key;var requiredParams=NATIVE_MAPPING[key]&&NATIVE_MAPPING[key].requiredParams;request[requestKey]=_extends({},requiredParams,params[key]);var isImageAsset=!!(requestKey===NATIVE_MAPPING.image.serverName||requestKey===NATIVE_MAPPING.icon.serverName);if(isImageAsset&&request[requestKey].sizes){var sizes=request[requestKey].sizes;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArrayOfNums)(sizes)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(sizes)&&sizes.length>0&&sizes.every(function(sz){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArrayOfNums)(sz);})){request[requestKey].sizes=transformSizes(request[requestKey].sizes);}}
if(requestKey===NATIVE_MAPPING.privacyLink){request.privacy_supported=true;}});return request;}
function hidedfpContainer(elementId){try{var el=document.getElementById(elementId).querySelectorAll("div[id^='google_ads']");if(el[0]){el[0].style.setProperty('display','none');}}catch(e){}}
function hideSASIframe(elementId){try{var el=document.getElementById(elementId).querySelectorAll("script[id^='sas_script']");if(el[0].nextSibling&&el[0].nextSibling.localName==='iframe'){el[0].nextSibling.style.setProperty('display','none');}}catch(e){}}
function outstreamRender(bid,doc){hidedfpContainer(bid.adUnitCode);hideSASIframe(bid.adUnitCode);bid.renderer.push(function(){var win=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.getWindowFromDocument)(doc)||window;win.ANOutstreamVideo.renderAd({tagId:bid.adResponse.tag_id,sizes:[bid.getSize().split('x')],targetId:bid.adUnitCode,uuid:bid.adResponse.uuid,adResponse:bid.adResponse,rendererOptions:bid.renderer.getConfig()},handleOutstreamRendererEvents.bind(null,bid));});}
function handleOutstreamRendererEvents(bid,id,eventName){bid.renderer.handleVideoEvent({id:id,eventName:eventName});}
function parseMediaType(rtbBid){var adType=rtbBid.ad_type;if(adType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO){return _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO;}else if(adType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE){return _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.NATIVE;}else{return _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER;}}
function addUserId(eids,id,source,rti){if(id){if(rti){eids.push({source:source,id:id,rti_partner:rti});}else{eids.push({source:source,id:id});}}
return eids;}
function getBidFloor(bid){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isFn)(bid.getFloor)){return bid.params.reserve?bid.params.reserve:null;}
var floor=bid.getFloor({currency:'USD',mediaType:'*',size:'*'});if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isPlainObject)(floor)&&!isNaN(floor.floor)&&floor.currency==='USD'){return floor.floor;}
return null;}
function convertKeywordsToString(keywords){var result='';Object.keys(keywords).forEach(function(key){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isStr)(keywords[key])){if(keywords[key]!==''){result+="".concat(key,"=").concat(keywords[key],",");}else{result+="".concat(key,",");}}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__.isArray)(keywords[key])){if(keywords[key][0]===''){result+="".concat(key,",");}else{keywords[key].forEach(function(val){result+="".concat(key,"=").concat(val,",");});}}});result=result.substring(0,result.length-1);return result;}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_8__.registerBidder)(spec);window.pbjs.installedModules.push('appnexusBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/appnexusBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["consentManagement"],{"./modules/consentManagement.js":
/*!**************************************!*\
  !*** ./modules/consentManagement.js ***!
  \**************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/adapterManager.js */
"./src/adapterManager.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var DEFAULT_CMP='iab';var DEFAULT_CONSENT_TIMEOUT=10000;var DEFAULT_ALLOW_AUCTION_WO_CONSENT=true;var allowAuction={value:DEFAULT_ALLOW_AUCTION_WO_CONSENT,definedInConfig:false};var userCMP;var consentTimeout;var gdprScope;var staticConsentData;var cmpVersion=0;var consentData;var addedConsentHook=false;var cmpCallMap={'iab':lookupIabConsent,'static':lookupStaticConsentData};function lookupStaticConsentData(_ref){var onSuccess=_ref.onSuccess,onError=_ref.onError;processCmpData(staticConsentData,{onSuccess:onSuccess,onError:onError});}
function lookupIabConsent(_ref2){var onSuccess=_ref2.onSuccess,onError=_ref2.onError,width=_ref2.width,height=_ref2.height;function findCMP(){var f=window;var cmpFrame;var cmpFunction;while(!cmpFrame){try{if(typeof f.__tcfapi==='function'||typeof f.__cmp==='function'){if(typeof f.__tcfapi==='function'){cmpVersion=2;cmpFunction=f.__tcfapi;}else{cmpVersion=1;cmpFunction=f.__cmp;}
cmpFrame=f;break;}}catch(e){}
try{if(f.frames['__tcfapiLocator']){cmpVersion=2;cmpFrame=f;break;}}catch(e){}
try{if(f.frames['__cmpLocator']){cmpVersion=1;cmpFrame=f;break;}}catch(e){}
if(f===window.top)break;f=f.parent;}
return{cmpFrame:cmpFrame,cmpFunction:cmpFunction};}
function v2CmpResponseCallback(tcfData,success){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Received a response from CMP',tcfData);if(success){if(tcfData.gdprApplies===false||tcfData.eventStatus==='tcloaded'||tcfData.eventStatus==='useractioncomplete'){processCmpData(tcfData,{onSuccess:onSuccess,onError:onError});}}else{onError('CMP unable to register callback function.  Please check CMP setup.');}}
function handleV1CmpResponseCallbacks(){var cmpResponse={};function afterEach(){if(cmpResponse.getConsentData&&cmpResponse.getVendorConsents){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Received all requested responses from CMP',cmpResponse);processCmpData(cmpResponse,{onSuccess:onSuccess,onError:onError});}}
return{consentDataCallback:function consentDataCallback(consentResponse){cmpResponse.getConsentData=consentResponse;afterEach();},vendorConsentsCallback:function vendorConsentsCallback(consentResponse){cmpResponse.getVendorConsents=consentResponse;afterEach();}};}
var v1CallbackHandler=handleV1CmpResponseCallbacks();var cmpCallbacks={};var _findCMP=findCMP(),cmpFrame=_findCMP.cmpFrame,cmpFunction=_findCMP.cmpFunction;if(!cmpFrame){return onError('CMP not found.');}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(cmpFunction)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Detected CMP API is directly accessible, calling it now...');if(cmpVersion===1){cmpFunction('getConsentData',null,v1CallbackHandler.consentDataCallback);cmpFunction('getVendorConsents',null,v1CallbackHandler.vendorConsentsCallback);}else if(cmpVersion===2){cmpFunction('addEventListener',cmpVersion,v2CmpResponseCallback);}}else if(cmpVersion===1&&inASafeFrame()&&typeof window.$sf.ext.cmp==='function'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Detected Prebid.js is encased in a SafeFrame and CMP is registered, calling it now...');callCmpWhileInSafeFrame('getConsentData',v1CallbackHandler.consentDataCallback);callCmpWhileInSafeFrame('getVendorConsents',v1CallbackHandler.vendorConsentsCallback);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Detected CMP is outside the current iframe where Prebid.js is located, calling it now...');if(cmpVersion===1){callCmpWhileInIframe('getConsentData',cmpFrame,v1CallbackHandler.consentDataCallback);callCmpWhileInIframe('getVendorConsents',cmpFrame,v1CallbackHandler.vendorConsentsCallback);}else if(cmpVersion===2){callCmpWhileInIframe('addEventListener',cmpFrame,v2CmpResponseCallback);}}
function inASafeFrame(){return!!(window.$sf&&window.$sf.ext);}
function callCmpWhileInSafeFrame(commandName,callback){function(){}
window.$sf.ext.register(width,height,sfCallback);window.$sf.ext.cmp(commandName);}
function callCmpWhileInIframe(commandName,cmpFrame,moduleCallback){var apiName=cmpVersion===2?'__tcfapi':'__cmp';var callName="".concat(apiName,"Call");if(cmpVersion===2){window[apiName]=function(cmd,cmpVersion,callback,arg){var callId=Math.random()+'';var msg=_defineProperty({},callName,{command:cmd,version:cmpVersion,parameter:arg,callId:callId});cmpCallbacks[callId]=callback;cmpFrame.postMessage(msg,'*');};window.addEventListener('message',readPostMessageResponse,false);window[apiName](commandName,cmpVersion,moduleCallback);}else{window[apiName]=function(cmd,arg,callback){var callId=Math.random()+'';var msg=_defineProperty({},callName,{command:cmd,parameter:arg,callId:callId});cmpCallbacks[callId]=callback;cmpFrame.postMessage(msg,'*');};window.addEventListener('message',readPostMessageResponse,false);window[apiName](commandName,undefined,moduleCallback);}
function readPostMessageResponse(event){var cmpDataPkgName="".concat(apiName,"Return");var json=typeof event.data==='string'&&(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.includes)(event.data,cmpDataPkgName)?JSON.parse(event.data):event.data;if(json[cmpDataPkgName]&&json[cmpDataPkgName].callId){var payload=json[cmpDataPkgName];if(typeof cmpCallbacks[payload.callId]!=='undefined'){cmpCallbacks[payload.callId](payload.returnValue,payload.success);}}}}}
function loadConsentData(cb){var width=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var height=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var isDone=false;var timer=null;function done(consentData,shouldCancelAuction,errMsg){if(timer!=null){clearTimeout(timer);}
isDone=true;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__.gdprDataHandler.setConsentData(consentData);if(cb!=null){for(var _len=arguments.length,extraArgs=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){extraArgs[_key-3]=arguments[_key];}
cb.apply(void 0,[shouldCancelAuction,errMsg].concat(extraArgs));}}
if(!(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.includes)(Object.keys(cmpCallMap),userCMP)){done(null,false,"CMP framework (".concat(userCMP,") is not a supported framework.  Aborting consentManagement module and resuming auction."));return;}
var callbacks={onSuccess:function onSuccess(data){return done(data,false);},onError:function onError(msg){var consentData=null;var shouldCancelAuction=true;if(allowAuction.value&&cmpVersion===1){consentData=storeConsentData(undefined);shouldCancelAuction=false;}
for(var _len2=arguments.length,extraArgs=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){extraArgs[_key2-1]=arguments[_key2];}
done.apply(void 0,[consentData,shouldCancelAuction,msg].concat(extraArgs));}};cmpCallMap[userCMP](_objectSpread({width:width,height:height},callbacks));if(!isDone){if(consentTimeout===0){processCmpData(undefined,callbacks);}else{timer=setTimeout(function(){if(cmpVersion===2){done(storeConsentData(undefined),false,"No response from CMP, continuing auction...");}else{callbacks.onError('CMP workflow exceeded timeout threshold.');}},consentTimeout);}}}
function requestBidsHook(fn,reqBidsConfigObj){var load=function(){if(consentData){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('User consent information already known.  Pulling internally stored information...');return function(cb){cb(false);};}else{var adUnits=reqBidsConfigObj.adUnits||pbjs.adUnits;var width=1;var height=1;if(Array.isArray(adUnits)&&adUnits.length>0){var _sizes$,_sizes$2;var sizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getAdUnitSizes)(adUnits[0]);width=(sizes===null||sizes===void 0?void 0:(_sizes$=sizes[0])===null||_sizes$===void 0?void 0:_sizes$[0])||1;height=(sizes===null||sizes===void 0?void 0:(_sizes$2=sizes[0])===null||_sizes$2===void 0?void 0:_sizes$2[1])||1;}
return function(cb){loadConsentData(cb,width,height);};}}();load(function(shouldCancelAuction,errMsg){if(errMsg){var log=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn;if(cmpVersion===1&&!shouldCancelAuction){errMsg="".concat(errMsg," 'allowAuctionWithoutConsent' activated.");}else if(shouldCancelAuction){log=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError;errMsg="".concat(errMsg," Canceling auction as per consentManagement config.");}
for(var _len3=arguments.length,extraArgs=new Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++){extraArgs[_key3-2]=arguments[_key3];}
log.apply(void 0,[errMsg].concat(extraArgs));}
if(shouldCancelAuction){if(typeof reqBidsConfigObj.bidsBackHandler==='function'){reqBidsConfigObj.bidsBackHandler();}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Error executing bidsBackHandler');}}else{fn.call(this,reqBidsConfigObj);}});}
function processCmpData(consentObject,_ref3){var onSuccess=_ref3.onSuccess,onError=_ref3.onError;function checkV1Data(consentObject){var gdprApplies=consentObject&&consentObject.getConsentData&&consentObject.getConsentData.gdprApplies;return!!(typeof gdprApplies!=='boolean'||gdprApplies===true&&!((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(consentObject.getConsentData.consentData)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(consentObject.getVendorConsents)&&Object.keys(consentObject.getVendorConsents).length>1));}
function checkV2Data(){var gdprApplies=consentObject&&typeof consentObject.gdprApplies==='boolean'?consentObject.gdprApplies:gdprScope;var tcString=consentObject&&consentObject.tcString;return!!(typeof gdprApplies!=='boolean'||gdprApplies===true&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(tcString));}
if(userCMP==='static'){cmpVersion=consentObject.getConsentData?1:consentObject.getTCData?2:0;if(cmpVersion===2){consentObject=consentObject.getTCData;}}
var checkFn=cmpVersion===1?checkV1Data:cmpVersion===2?checkV2Data:null;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(checkFn)){if(checkFn(consentObject)){onError("CMP returned unexpected value during lookup process.",consentObject);}else{onSuccess(storeConsentData(consentObject));}}else{onError('Unable to derive CMP version to process data.  Consent object does not conform to TCF v1 or v2 specs.',consentObject);}}
function storeConsentData(cmpConsentObject){if(cmpVersion===1){consentData={consentString:cmpConsentObject?cmpConsentObject.getConsentData.consentData:undefined,vendorData:cmpConsentObject?cmpConsentObject.getVendorConsents:undefined,gdprApplies:cmpConsentObject?cmpConsentObject.getConsentData.gdprApplies:gdprScope};}else{consentData={consentString:cmpConsentObject?cmpConsentObject.tcString:undefined,vendorData:cmpConsentObject||undefined,gdprApplies:cmpConsentObject&&typeof cmpConsentObject.gdprApplies==='boolean'?cmpConsentObject.gdprApplies:gdprScope};if(cmpConsentObject&&cmpConsentObject.addtlConsent&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(cmpConsentObject.addtlConsent)){consentData.addtlConsent=cmpConsentObject.addtlConsent;};}
consentData.apiVersion=cmpVersion;return consentData;}
function resetConsentData(){consentData=undefined;userCMP=undefined;cmpVersion=0;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__.gdprDataHandler.reset();}
function setConsentConfig(config){config=config&&(config.gdpr||config.usp?config.gdpr:config);if(!config||_typeof(config)!=='object'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)('consentManagement config not defined, exiting consent manager');return;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(config.cmpApi)){userCMP=config.cmpApi;}else{userCMP=DEFAULT_CMP;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("consentManagement config did not specify cmp.  Using system default setting (".concat(DEFAULT_CMP,")."));}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(config.timeout)){consentTimeout=config.timeout;}else{consentTimeout=DEFAULT_CONSENT_TIMEOUT;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("consentManagement config did not specify timeout.  Using system default setting (".concat(DEFAULT_CONSENT_TIMEOUT,")."));}
if(typeof config.allowAuctionWithoutConsent==='boolean'){allowAuction.value=config.allowAuctionWithoutConsent;allowAuction.definedInConfig=true;}
gdprScope=config.defaultGdprScope===true;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('consentManagement module has been activated...');if(userCMP==='static'){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(config.consentData)){staticConsentData=config.consentData;consentTimeout=0;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("consentManagement config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.");}}
if(!addedConsentHook){pbjs.requestBids.before(requestBidsHook,50);}
addedConsentHook=true;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__.gdprDataHandler.enable();loadConsentData();if(allowAuction.definedInConfig&&cmpVersion===2){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("'allowAuctionWithoutConsent' ignored for TCF 2");}else if(!allowAuction.definedInConfig&&cmpVersion===1){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("'allowAuctionWithoutConsent' using system default: (".concat(DEFAULT_ALLOW_AUCTION_WO_CONSENT,")."));}}
_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('consentManagement',function(config){return setConsentConfig(config.consentManagement);});window.pbjs.installedModules.push('consentManagement');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/consentManagement.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["consentManagementUsp"],{"./modules/consentManagementUsp.js":
/*!*****************************************!*\
  !*** ./modules/consentManagementUsp.js ***!
  \*****************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/adapterManager.js */
"./src/adapterManager.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var DEFAULT_CONSENT_API='iab';var DEFAULT_CONSENT_TIMEOUT=50;var USPAPI_VERSION=1;var consentAPI;var consentTimeout;var staticConsentData;var consentData;var addedConsentHook=false;var uspCallMap={'iab':lookupUspConsent,'static':lookupStaticConsentData};function lookupStaticConsentData(_ref){var onSuccess=_ref.onSuccess,onError=_ref.onError;processUspData(staticConsentData,{onSuccess:onSuccess,onError:onError});}
function lookupUspConsent(_ref2){var onSuccess=_ref2.onSuccess,onError=_ref2.onError;function findUsp(){var f=window;var uspapiFrame;var uspapiFunction;while(!uspapiFrame){try{if(typeof f.__uspapi==='function'){uspapiFunction=f.__uspapi;uspapiFrame=f;break;}}catch(e){}
try{if(f.frames['__uspapiLocator']){uspapiFrame=f;break;}}catch(e){}
if(f===window.top)break;f=f.parent;}
return{uspapiFrame:uspapiFrame,uspapiFunction:uspapiFunction};}
function handleUspApiResponseCallbacks(){var uspResponse={};function afterEach(){if(uspResponse.usPrivacy){processUspData(uspResponse,{onSuccess:onSuccess,onError:onError});}else{onError('Unable to get USP consent string.');}}
return{consentDataCallback:function consentDataCallback(consentResponse,success){if(success&&consentResponse.uspString){uspResponse.usPrivacy=consentResponse.uspString;}
afterEach();}};}
var callbackHandler=handleUspApiResponseCallbacks();var uspapiCallbacks={};var _findUsp=findUsp(),uspapiFrame=_findUsp.uspapiFrame,uspapiFunction=_findUsp.uspapiFunction;if(!uspapiFrame){return onError('USP CMP not found.');}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(uspapiFunction)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Detected USP CMP is directly accessible, calling it now...');uspapiFunction('getUSPData',USPAPI_VERSION,callbackHandler.consentDataCallback);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('Detected USP CMP is outside the current iframe where Prebid.js is located, calling it now...');callUspApiWhileInIframe('getUSPData',uspapiFrame,callbackHandler.consentDataCallback);}
function callUspApiWhileInIframe(commandName,uspapiFrame,moduleCallback){window.__uspapi=function(){};window.addEventListener('message',readPostMessageResponse,false);window.__uspapi(commandName,USPAPI_VERSION,moduleCallback);function(){}}}
function loadConsentData(cb){var timer=null;var isDone=false;function done(consentData,errMsg){if(timer!=null){clearTimeout(timer);}
isDone=true;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__.uspDataHandler.setConsentData(consentData);if(cb!=null){for(var _len=arguments.length,extraArgs=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){extraArgs[_key-2]=arguments[_key];}
cb.apply(void 0,[errMsg].concat(extraArgs));}}
if(!uspCallMap[consentAPI]){done(null,"USP framework (".concat(consentAPI,") is not a supported framework. Aborting consentManagement module and resuming auction."));return;}
var callbacks={onSuccess:done,onError:function onError(errMsg){for(var _len2=arguments.length,extraArgs=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){extraArgs[_key2-1]=arguments[_key2];}
done.apply(void 0,[null,"".concat(errMsg," Resuming auction without consent data as per consentManagement config.")].concat(extraArgs));}};uspCallMap[consentAPI](callbacks);if(!isDone){if(consentTimeout===0){processUspData(undefined,callbacks);}else{timer=setTimeout(callbacks.onError.bind(null,'USPAPI workflow exceeded timeout threshold.'),consentTimeout);}}}
function requestBidsHook(fn,reqBidsConfigObj){var _this=this;loadConsentData(function(errMsg){if(errMsg!=null){for(var _len3=arguments.length,extraArgs=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){extraArgs[_key3-1]=arguments[_key3];}
_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn.apply(void 0,[errMsg].concat(extraArgs));}
fn.call(_this,reqBidsConfigObj);});}
function processUspData(consentObject,_ref3){var onSuccess=_ref3.onSuccess,onError=_ref3.onError;var valid=!!(consentObject&&consentObject.usPrivacy);if(!valid){onError("USPAPI returned unexpected value during lookup process.",consentObject);return;}
storeUspConsentData(consentObject);onSuccess(consentData);}
function storeUspConsentData(consentObject){if(consentObject&&consentObject.usPrivacy){consentData=consentObject.usPrivacy;}}
function resetConsentData(){consentData=undefined;consentAPI=undefined;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__.uspDataHandler.reset();}
function setConsentConfig(config){config=config&&config.usp;if(!config||_typeof(config)!=='object'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)('consentManagement.usp config not defined, exiting usp consent manager');return;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(config.cmpApi)){consentAPI=config.cmpApi;}else{consentAPI=DEFAULT_CONSENT_API;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("consentManagement.usp config did not specify cmpApi. Using system default setting (".concat(DEFAULT_CONSENT_API,")."));}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(config.timeout)){consentTimeout=config.timeout;}else{consentTimeout=DEFAULT_CONSENT_TIMEOUT;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("consentManagement.usp config did not specify timeout. Using system default setting (".concat(DEFAULT_CONSENT_TIMEOUT,")."));}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)('USPAPI consentManagement module has been activated...');if(consentAPI==='static'){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(config.consentData)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(config.consentData.getUSPData)){if(config.consentData.getUSPData.uspString)staticConsentData={usPrivacy:config.consentData.getUSPData.uspString};consentTimeout=0;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("consentManagement config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.");}}
if(!addedConsentHook){pbjs.requestBids.before(requestBidsHook,50);}
addedConsentHook=true;_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_1__.uspDataHandler.enable();loadConsentData();}
_src_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('consentManagement',function(config){return setConsentConfig(config.consentManagement);});window.pbjs.installedModules.push('consentManagementUsp');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/consentManagementUsp.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["gptPreAuction"],{"./modules/gptPreAuction.js":
/*!**********************************!*\
  !*** ./modules/gptPreAuction.js ***!
  \**********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_hook_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/hook.js */
"./src/hook.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");var _this=undefined;var MODULE_NAME='GPT Pre-Auction';var _currentConfig={};var hooksAdded=false;var appendGptSlots=function appendGptSlots(adUnits){var _currentConfig2=_currentConfig,customGptSlotMatching=_currentConfig2.customGptSlotMatching;if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isGptPubadsDefined)()){return;}
var adUnitMap=adUnits.reduce(function(acc,adUnit){acc[adUnit.code]=adUnit;return acc;},{});window.googletag.pubads().getSlots().forEach(function(slot){var matchingAdUnitCode=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_1__.find)(Object.keys(adUnitMap),customGptSlotMatching?customGptSlotMatching(slot):(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isAdUnitCodeMatchingSlot)(slot));if(matchingAdUnitCode){var adUnit=adUnitMap[matchingAdUnitCode];adUnit.ortb2Imp=adUnit.ortb2Imp||{};adUnit.ortb2Imp.ext=adUnit.ortb2Imp.ext||{};adUnit.ortb2Imp.ext.data=adUnit.ortb2Imp.ext.data||{};var context=adUnit.ortb2Imp.ext.data;context.adserver=context.adserver||{};context.adserver.name='gam';context.adserver.adslot=sanitizeSlotPath(slot.getAdUnitPath());}});};var sanitizeSlotPath=function sanitizeSlotPath(path){var gptConfig=_src_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('gptPreAuction')||{};if(gptConfig.mcmEnabled){return path.replace(/(^\/\d*),\d*\//,'$1/');}
return path;};var defaultPreAuction=function defaultPreAuction(adUnit,adServerAdSlot){var context=adUnit.ortb2Imp.ext.data;if(context.pbadslot){return context.pbadslot;}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isGptPubadsDefined)()){return;}
var gptSlots=window.googletag.pubads().getSlots().filter(function(slot){return slot.getAdUnitPath()===adServerAdSlot;});if(gptSlots.length===0){return;}
if(gptSlots.length===1){return adServerAdSlot;}
return"".concat(adServerAdSlot,"#").concat(adUnit.code);};var appendPbAdSlot=function appendPbAdSlot(adUnit){var context=adUnit.ortb2Imp.ext.data;var _currentConfig3=_currentConfig,customPbAdSlot=_currentConfig3.customPbAdSlot;if(context.pbadslot){return;}
if(customPbAdSlot){context.pbadslot=customPbAdSlot(adUnit.code,(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(context,'adserver.adslot'));return;}
try{var adUnitCodeDiv=document.getElementById(adUnit.code);if(adUnitCodeDiv.dataset.adslotid){context.pbadslot=adUnitCodeDiv.dataset.adslotid;return;}}catch(e){}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(context,'adserver.adslot')){context.pbadslot=context.adserver.adslot;return;}
context.pbadslot=adUnit.code;return true;};var makeBidRequestsHook=function makeBidRequestsHook(fn,adUnits){appendGptSlots(adUnits);var _currentConfig4=_currentConfig,useDefaultPreAuction=_currentConfig4.useDefaultPreAuction,customPreAuction=_currentConfig4.customPreAuction;adUnits.forEach(function(adUnit){adUnit.ortb2Imp=adUnit.ortb2Imp||{};adUnit.ortb2Imp.ext=adUnit.ortb2Imp.ext||{};adUnit.ortb2Imp.ext.data=adUnit.ortb2Imp.ext.data||{};var context=adUnit.ortb2Imp.ext;if(!customPreAuction&&!useDefaultPreAuction){var usedAdUnitCode=appendPbAdSlot(adUnit);if(!context.gpid&&!usedAdUnitCode){context.gpid=context.data.pbadslot;}}else{var adserverSlot=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(context,'data.adserver.adslot');var result;if(customPreAuction){result=customPreAuction(adUnit,adserverSlot);}else if(useDefaultPreAuction){result=defaultPreAuction(adUnit,adserverSlot);}
if(result){context.gpid=context.data.pbadslot=result;}}});for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key];}
return fn.call.apply(fn,[_this,adUnits].concat(args));};var handleSetGptConfig=function handleSetGptConfig(moduleConfig){_currentConfig=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.pick)(moduleConfig,['enabled',function(enabled){return enabled!==false;},'customGptSlotMatching',function(customGptSlotMatching){return typeof customGptSlotMatching==='function'&&customGptSlotMatching;},'customPbAdSlot',function(customPbAdSlot){return typeof customPbAdSlot==='function'&&customPbAdSlot;},'customPreAuction',function(customPreAuction){return typeof customPreAuction==='function'&&customPreAuction;},'useDefaultPreAuction',function(useDefaultPreAuction){return useDefaultPreAuction===true;}]);if(_currentConfig.enabled){if(!hooksAdded){(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_4__.getHook)('makeBidRequests').before(makeBidRequestsHook);hooksAdded=true;}}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)("".concat(MODULE_NAME,": Turning off module"));_currentConfig={};(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_4__.getHook)('makeBidRequests').getHooks({hook:makeBidRequestsHook}).remove();hooksAdded=false;}};_src_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('gptPreAuction',function(config){return handleSetGptConfig(config.gptPreAuction);});handleSetGptConfig({});window.pbjs.installedModules.push('gptPreAuction');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/gptPreAuction.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["ixBidAdapter"],{"./modules/ixBidAdapter.js":
/*!*********************************!*\
  !*** ./modules/ixBidAdapter.js ***!
  \*********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_constants_json__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ../src/constants.json */
"./src/constants.json");var _src_storageManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/storageManager.js */
"./src/storageManager.js");var _src_events_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ../src/events.js */
"./src/events.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_video_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/video.js */
"./src/video.js");var _src_Renderer_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ../src/Renderer.js */
"./src/Renderer.js");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e){throw _e;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e2){didErr=true;err=_e2;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var BIDDER_CODE='ix';var ALIAS_BIDDER_CODE='roundel';var GLOBAL_VENDOR_ID=10;var SECURE_BID_URL='https://htlb.casalemedia.com/cygnus';var SUPPORTED_AD_TYPES=[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO];var BANNER_ENDPOINT_VERSION=7.2;var VIDEO_ENDPOINT_VERSION=8.1;var CENT_TO_DOLLAR_FACTOR=100;var BANNER_TIME_TO_LIVE=300;var VIDEO_TIME_TO_LIVE=3600;var NET_REVENUE=true;var MAX_REQUEST_SIZE=8000;var MAX_REQUEST_LIMIT=4;var PRICE_TO_DOLLAR_FACTOR={JPY:1};var USER_SYNC_URL='https://js-sec.indexww.com/um/ixmatch.html';var RENDERER_URL='https://js-sec.indexww.com/htv/video-player.js';var FLOOR_SOURCE={PBJS:'p',IX:'x'};var ERROR_CODES={BID_SIZE_INVALID_FORMAT:1,BID_SIZE_NOT_INCLUDED:2,PROPERTY_NOT_INCLUDED:3,SITE_ID_INVALID_VALUE:4,BID_FLOOR_INVALID_FORMAT:5,IX_FPD_EXCEEDS_MAX_SIZE:6,EXCEEDS_MAX_SIZE:7,PB_FPD_EXCEEDS_MAX_SIZE:8,VIDEO_DURATION_INVALID:9};var FIRST_PARTY_DATA={SITE:['id','name','domain','cat','sectioncat','pagecat','page','ref','search','mobile','privacypolicy','publisher','content','keywords','ext'],USER:['id','buyeruid','yob','gender','keywords','customdata','geo','data','ext']};var SOURCE_RTI_MAPPING={'liveramp.com':'idl','netid.de':'NETID','neustar.biz':'fabrickId','zeotap.com':'zeotapIdPlus','uidapi.com':'UID2','adserver.org':'TDID','id5-sync.com':'','crwdcntrl.net':'','epsilon.com':'','audigent.com':'','pubcid.org':'','trustpid.com':''};var PROVIDERS=['britepoolid','lipbid','criteoId','merkleId','parrableId','connectid','tapadId','quantcastId','flocId','pubProvidedId'];var REQUIRED_VIDEO_PARAMS=['mimes','minduration','maxduration'];var VIDEO_PARAMS_ALLOW_LIST=['mimes','minduration','maxduration','protocols','protocol','startdelay','placement','linearity','skip','skipmin','skipafter','sequence','battr','maxextended','minbitrate','maxbitrate','boxingallowed','playbackmethod','playbackend','delivery','pos','companionad','api','companiontype','ext','playerSize','w','h'];var LOCAL_STORAGE_KEY='ixdiag';var hasRegisteredHandler=false;var storage=(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_1__.getStorageManager)({gvlid:GLOBAL_VENDOR_ID,bidderCode:BIDDER_CODE});var MEDIA_TYPES={Banner:1,Video:2,Audio:3,Native:4};function bidToBannerImp(bid){var imp=bidToImp(bid);imp.banner={};var impSize=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'params.size');if(impSize){imp.banner.w=impSize[0];imp.banner.h=impSize[1];if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imp,'ext.sid')){imp.ext.sid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseGPTSingleSizeArray)(impSize);}}
imp.banner.topframe=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.inIframe)()?0:1;_applyFloor(bid,imp,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER);return imp;}
function bidToVideoImp(bid){var imp=bidToImp(bid);var videoAdUnitRef=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video');var videoParamRef=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'params.video');var videoParamErrors=checkVideoParams(videoAdUnitRef,videoParamRef);if(videoParamErrors.length){return{};}
imp.video=videoParamRef?(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.deepClone)(bid.params.video):{};for(var adUnitProperty in videoAdUnitRef){if(VIDEO_PARAMS_ALLOW_LIST.indexOf(adUnitProperty)!==-1&&!imp.video.hasOwnProperty(adUnitProperty)){imp.video[adUnitProperty]=videoAdUnitRef[adUnitProperty];}}
if(imp.video.minduration>imp.video.maxduration){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)("IX Bid Adapter: video minduration [".concat(imp.video.minduration,"] cannot be greater than video maxduration [").concat(imp.video.maxduration,"]"),{bidder:BIDDER_CODE,code:ERROR_CODES.VIDEO_DURATION_INVALID});return{};}
var context=videoParamRef&&videoParamRef.context||videoAdUnitRef&&videoAdUnitRef.context;if(context&&!imp.video.hasOwnProperty('placement')){if(context===_src_video_js__WEBPACK_IMPORTED_MODULE_4__.INSTREAM){imp.video.placement=1;}else if(context===_src_video_js__WEBPACK_IMPORTED_MODULE_4__.OUTSTREAM){imp.video.placement=4;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)("IX Bid Adapter: Video context '".concat(context,"' is not supported"));}}
if(!(imp.video.w&&imp.video.h)){var impSize=getFirstSize((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imp,'video.playerSize'))||getFirstSize((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'params.size'));if(impSize){imp.video.w=impSize[0];imp.video.h=impSize[1];if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imp,'ext.sid')){imp.ext.sid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseGPTSingleSizeArray)(impSize);}}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('IX Bid Adapter: Video size is missing in [mediaTypes.video] missing');return{};}}
_applyFloor(bid,imp,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO);return imp;}
function bidToImp(bid){var imp={};imp.id=bid.bidId;imp.ext={};imp.ext.siteID=bid.params.siteId.toString();if(bid.params.hasOwnProperty('id')&&(typeof bid.params.id==='string'||typeof bid.params.id==='number')){imp.ext.sid=String(bid.params.id);}
return imp;}
function _applyFloor(bid,imp,mediaType){var adapterFloor=null;var moduleFloor=null;if(bid.params.bidFloor&&bid.params.bidFloorCur){adapterFloor={floor:bid.params.bidFloor,currency:bid.params.bidFloorCur};}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isFn)(bid.getFloor)){var _mediaType='*';var _size='*';if(mediaType&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.contains)(SUPPORTED_AD_TYPES,mediaType)){var _imp$mediaType=imp[mediaType],width=_imp$mediaType.w,height=_imp$mediaType.h;_mediaType=mediaType;_size=[width,height];}
try{moduleFloor=bid.getFloor({mediaType:_mediaType,size:_size});}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('priceFloors module call getFloor failed, error : ',err);}}
if(moduleFloor){imp.bidfloor=moduleFloor.floor;imp.bidfloorcur=moduleFloor.currency;imp.ext.fl=FLOOR_SOURCE.PBJS;}else if(adapterFloor){imp.bidfloor=adapterFloor.floor;imp.bidfloorcur=adapterFloor.currency;imp.ext.fl=FLOOR_SOURCE.IX;}}
function parseBid(rawBid,currency,bidRequest){var bid={};var isValidExpiry=!!((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'exp')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isInteger)(rawBid.exp));var dealID=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'dealid')||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'ext.dealid');if(PRICE_TO_DOLLAR_FACTOR.hasOwnProperty(currency)){bid.cpm=rawBid.price/PRICE_TO_DOLLAR_FACTOR[currency];}else{bid.cpm=rawBid.price/CENT_TO_DOLLAR_FACTOR;}
bid.requestId=rawBid.impid;if(dealID){bid.dealId=dealID;}
bid.netRevenue=NET_REVENUE;bid.currency=currency;bid.creativeId=rawBid.hasOwnProperty('crid')?rawBid.crid:'-';if(rawBid.mtype==MEDIA_TYPES.Video){bid.vastXml=rawBid.adm;}else if(rawBid.ext&&rawBid.ext.vasturl){bid.vastUrl=rawBid.ext.vasturl;}
if(rawBid.ext&&rawBid.ext.vasturl||rawBid.mtype==MEDIA_TYPES.Video){bid.width=bidRequest.video.w;bid.height=bidRequest.video.h;bid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO;bid.mediaTypes=bidRequest.mediaTypes;bid.ttl=isValidExpiry?rawBid.exp:VIDEO_TIME_TO_LIVE;}else{bid.ad=rawBid.adm;bid.width=rawBid.w;bid.height=rawBid.h;bid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER;bid.ttl=isValidExpiry?rawBid.exp:BANNER_TIME_TO_LIVE;}
bid.meta={};bid.meta.networkId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'ext.dspid');bid.meta.brandId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'ext.advbrandid');bid.meta.brandName=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(rawBid,'ext.advbrand');if(rawBid.adomain&&rawBid.adomain.length>0){bid.meta.advertiserDomains=rawBid.adomain;}
return bid;}
function isValidSize(size){return Array.isArray(size)&&size.length===2&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isInteger)(size[0])&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isInteger)(size[1]);}
function includesSize(){var sizeArray=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(isValidSize(sizeArray)){return sizeArray[0]===size[0]&&sizeArray[1]===size[1];}
for(var i=0;i<sizeArray.length;i++){if(sizeArray[i][0]===size[0]&&sizeArray[i][1]===size[1]){return true;}}
return false;}
function checkVideoParams(mediaTypeVideoRef,paramsVideoRef){var errorList=[];if(!mediaTypeVideoRef){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('IX Bid Adapter: mediaTypes.video is the preferred location for video params in ad unit');}
var _iterator=_createForOfIteratorHelper(REQUIRED_VIDEO_PARAMS),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var property=_step.value;var propInMediaType=mediaTypeVideoRef&&mediaTypeVideoRef.hasOwnProperty(property);var propInVideoRef=paramsVideoRef&&paramsVideoRef.hasOwnProperty(property);if(!propInMediaType&&!propInVideoRef){errorList.push("IX Bid Adapter: ".concat(property," is not included in either the adunit or params level"));}}}catch(err){_iterator.e(err);}finally{_iterator.f();}
var protocolMediaType=mediaTypeVideoRef&&mediaTypeVideoRef.hasOwnProperty('protocol');var protocolsMediaType=mediaTypeVideoRef&&mediaTypeVideoRef.hasOwnProperty('protocols');var protocolVideoRef=paramsVideoRef&&paramsVideoRef.hasOwnProperty('protocol');var protocolsVideoRef=paramsVideoRef&&paramsVideoRef.hasOwnProperty('protocols');if(!(protocolMediaType||protocolsMediaType||protocolVideoRef||protocolsVideoRef)){errorList.push('IX Bid Adapter: protocol/protcols is not included in either the adunit or params level');}
return errorList;}
function getFirstSize(){var sizes=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(isValidSize(sizes)){return sizes;}else if(isValidSize(sizes[0])){return sizes[0];}
return false;}
function isValidBidFloorParams(bidFloor,bidFloorCur){var curRegex=/^[A-Z]{3}$/;return Boolean(typeof bidFloor==='number'&&typeof bidFloorCur==='string'&&bidFloorCur.match(curRegex));}
function getBidRequest(id,impressions,validBidRequests){if(!id){return;}
var bidRequest=_objectSpread(_objectSpread({},(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.find)(validBidRequests,function(bid){return bid.bidId===id;})),(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.find)(impressions,function(imp){return imp.id===id;}));return bidRequest;}
function getEidInfo(allEids,flocData){var toSend=[];var seenSources={};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isArray)(allEids)){var _iterator2=_createForOfIteratorHelper(allEids),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var eid=_step2.value;if(SOURCE_RTI_MAPPING.hasOwnProperty(eid.source)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(eid,'uids.0')){seenSources[eid.source]=true;if(SOURCE_RTI_MAPPING[eid.source]!=''){eid.uids[0].ext={rtiPartner:SOURCE_RTI_MAPPING[eid.source]};}
delete eid.uids[0].atype;toSend.push(eid);}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}
var isValidFlocId=flocData&&flocData.id&&flocData.version;if(isValidFlocId){var flocEid={'source':'chrome.com','uids':[{'id':flocData.id,'ext':{'rtiPartner':'flocId','ver':flocData.version}}]};toSend.push(flocEid);seenSources['chrome.com']=true;}
return{toSend:toSend,seenSources:seenSources};}
function buildRequest(validBidRequests,bidderRequest,impressions,version){var baseUrl=SECURE_BID_URL;var eidInfo=getEidInfo((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequests,'0.userIdAsEids'),(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequests,'0.userId.flocId'));var userEids=eidInfo.toSend;var pageUrl=getPageUrl()||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'refererInfo.referer');if(window.headertag&&typeof window.headertag.getIdentityInfo==='function'){var identityInfo=window.headertag.getIdentityInfo();if(identityInfo&&_typeof(identityInfo)==='object'){for(var partnerName in identityInfo){if(identityInfo.hasOwnProperty(partnerName)){var response=identityInfo[partnerName];if(!response.responsePending&&response.data&&_typeof(response.data)==='object'&&Object.keys(response.data).length&&!eidInfo.seenSources[response.data.source]){userEids.push(response.data);}}}}}
if(bidderRequest&&bidderRequest.bidderCode===ALIAS_BIDDER_CODE&&!eidInfo.seenSources['liveramp.com']){return[];}
var r={};r.id=validBidRequests[0].bidderRequestId.toString();r.site={};r.ext={};r.ext.source='prebid';r.ext.ixdiag={};r.ext.ixdiag.msd=0;r.ext.ixdiag.msi=0;r.imp=[];r.at=1;var ixdiag=buildIXDiag(validBidRequests);for(var key in ixdiag){r.ext.ixdiag[key]=ixdiag[key];}
var cachedErrors=getCachedErrors();if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isEmpty)(cachedErrors)){r.ext.ixdiag.err=cachedErrors;}
if(validBidRequests[0].schain){r.source={ext:{schain:validBidRequests[0].schain}};}
if(userEids.length>0){r.user={};r.user.eids=userEids;}
if(document.referrer&&document.referrer!==''){r.site.ref=document.referrer;}
if(bidderRequest){if(bidderRequest.gdprConsent){var gdprConsent=bidderRequest.gdprConsent;if(gdprConsent.hasOwnProperty('gdprApplies')){r.regs={ext:{gdpr:gdprConsent.gdprApplies?1:0}};}
if(gdprConsent.hasOwnProperty('consentString')){r.user=r.user||{};r.user.ext={consent:gdprConsent.consentString||''};if(gdprConsent.hasOwnProperty('addtlConsent')&&gdprConsent.addtlConsent){r.user.ext.consented_providers_settings={consented_providers:gdprConsent.addtlConsent};}}}
if(bidderRequest.uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(r,'regs.ext.us_privacy',bidderRequest.uspConsent);}
if(pageUrl){r.site.page=pageUrl;}}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig('coppa')){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(r,'regs.coppa',1);}
var payload={};payload.s=validBidRequests[0].params.siteId;payload.v=version;payload.ac='j';payload.sd=1;if(version===VIDEO_ENDPOINT_VERSION){payload.nf=1;}
var bidderCode=bidderRequest&&bidderRequest.bidderCode||'ix';var otherIxConfig=_src_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig(bidderCode);var requests=[];var requestSequenceNumber=0;var transactionIds=Object.keys(impressions);var baseRequestSize="".concat(baseUrl).concat((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseQueryStringParameters)(_objectSpread(_objectSpread({},payload),{},{r:JSON.stringify(r)}))).length;if(baseRequestSize>MAX_REQUEST_SIZE){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: Base request size has exceeded maximum request size.',{bidder:BIDDER_CODE,code:ERROR_CODES.EXCEEDS_MAX_SIZE});return requests;}
var currentRequestSize=baseRequestSize;var fpdRequestSize=0;var isFpdAdded=false;if(otherIxConfig){if(_typeof(otherIxConfig.firstPartyData)==='object'){var firstPartyData=otherIxConfig.firstPartyData;var firstPartyString='?';for(var _key in firstPartyData){if(firstPartyData.hasOwnProperty(_key)){firstPartyString+="".concat(encodeURIComponent(_key),"=").concat(encodeURIComponent(firstPartyData[_key]),"&");}}
firstPartyString=firstPartyString.slice(0,-1);fpdRequestSize=encodeURIComponent(firstPartyString).length;if(fpdRequestSize<MAX_REQUEST_SIZE){if('page'in r.site){r.site.page+=firstPartyString;}else{r.site.page=firstPartyString;}
currentRequestSize+=fpdRequestSize;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: IX config FPD request size has exceeded maximum request size.',{bidder:BIDDER_CODE,code:ERROR_CODES.IX_FPD_EXCEEDS_MAX_SIZE});}}
if(typeof otherIxConfig.timeout==='number'){payload.t=otherIxConfig.timeout;}
if(typeof otherIxConfig.detectMissingSizes==='boolean'){r.ext.ixdiag.dms=otherIxConfig.detectMissingSizes;}else{r.ext.ixdiag.dms=true;}}
var _loop=function _loop(adUnitIndex){if(currentRequestSize>=MAX_REQUEST_SIZE||requests.length>=MAX_REQUEST_LIMIT){return"break";}
var adUnitImpressions=impressions[transactionIds[adUnitIndex]];var _adUnitImpressions$mi=adUnitImpressions.missingCount,missingCount=_adUnitImpressions$mi===void 0?0:_adUnitImpressions$mi,_adUnitImpressions$mi2=adUnitImpressions.missingImps,missingBannerImpressions=_adUnitImpressions$mi2===void 0?[]:_adUnitImpressions$mi2,_adUnitImpressions$ix=adUnitImpressions.ixImps,ixImps=_adUnitImpressions$ix===void 0?[]:_adUnitImpressions$ix;var wasAdUnitImpressionsTrimmed=false;var remainingRequestSize=MAX_REQUEST_SIZE-currentRequestSize;var sourceImpressions={ixImps:ixImps,missingBannerImpressions:missingBannerImpressions};var impressionObjects=Object.keys(sourceImpressions).map(function(key){return sourceImpressions[key];}).filter(function(item){return Array.isArray(item);}).reduce(function(acc,curr){return acc.concat.apply(acc,_toConsumableArray(curr));},[]);var currentImpressionSize=encodeURIComponent(JSON.stringify({impressionObjects:impressionObjects})).length;while(impressionObjects.length&&currentImpressionSize>remainingRequestSize){wasAdUnitImpressionsTrimmed=true;impressionObjects.pop();currentImpressionSize=encodeURIComponent(JSON.stringify({impressionObjects:impressionObjects})).length;}
var gpid=impressions[transactionIds[adUnitIndex]].gpid;var dfpAdUnitCode=impressions[transactionIds[adUnitIndex]].dfp_ad_unit_code;if(impressionObjects.length&&_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER in impressionObjects[0]){var _impressionObjects$=impressionObjects[0],id=_impressionObjects$.id,topframe=_impressionObjects$.banner.topframe;var _bannerImpression={id:id,banner:{topframe:topframe,format:impressionObjects.map(function(_ref){var _ref$banner=_ref.banner,w=_ref$banner.w,h=_ref$banner.h,ext=_ref.ext;return{w:w,h:h,ext:ext};})}};if(dfpAdUnitCode||gpid){_bannerImpression.ext={};_bannerImpression.ext.dfp_ad_unit_code=dfpAdUnitCode;_bannerImpression.ext.gpid=gpid;}
if('bidfloor'in impressionObjects[0]){_bannerImpression.bidfloor=impressionObjects[0].bidfloor;}
if('bidfloorcur'in impressionObjects[0]){_bannerImpression.bidfloorcur=impressionObjects[0].bidfloorcur;}
r.imp.push(_bannerImpression);r.ext.ixdiag.msd+=missingCount;r.ext.ixdiag.msi+=missingBannerImpressions.length;}else{var _r$imp;impressionObjects.forEach(function(imp){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(imp,'ext.gpid',gpid);});(_r$imp=r.imp).push.apply(_r$imp,_toConsumableArray(impressionObjects));}
currentRequestSize+=currentImpressionSize;var fpd=_src_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig('ortb2')||{};if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.isEmpty)(fpd)&&!isFpdAdded){r.ext.ixdiag.fpd=true;var site=_objectSpread({},fpd.site||fpd.context);Object.keys(site).forEach(function(key){if(FIRST_PARTY_DATA.SITE.indexOf(key)===-1){delete site[key];}});var user=_objectSpread({},fpd.user);Object.keys(user).forEach(function(key){if(FIRST_PARTY_DATA.USER.indexOf(key)===-1){delete user[key];}});var clonedRObject=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.deepClone)(r);clonedRObject.site=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.mergeDeep)({},clonedRObject.site,site);clonedRObject.user=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.mergeDeep)({},clonedRObject.user,user);var requestSize="".concat(baseUrl).concat((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseQueryStringParameters)(_objectSpread(_objectSpread({},payload),{},{r:JSON.stringify(clonedRObject)}))).length;if(requestSize<MAX_REQUEST_SIZE){r.site=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.mergeDeep)({},r.site,site);r.user=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.mergeDeep)({},r.user,user);isFpdAdded=true;var _fpdRequestSize=encodeURIComponent(JSON.stringify(_objectSpread(_objectSpread({},site),user))).length;currentRequestSize+=_fpdRequestSize;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: FPD request size has exceeded maximum request size.',{bidder:BIDDER_CODE,code:ERROR_CODES.PB_FPD_EXCEEDS_MAX_SIZE});}}
var isLastAdUnit=adUnitIndex===transactionIds.length-1;if(wasAdUnitImpressionsTrimmed||isLastAdUnit){var clonedPayload=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.deepClone)(payload);if(!isLastAdUnit||requestSequenceNumber){r.ext.ixdiag.sn=requestSequenceNumber;clonedPayload.sn=requestSequenceNumber;}
requestSequenceNumber++;clonedPayload.r=JSON.stringify(r);requests.push({method:'GET',url:baseUrl,data:clonedPayload,validBidRequests:validBidRequests});currentRequestSize=baseRequestSize;r.imp=[];r.ext.ixdiag.msd=0;r.ext.ixdiag.msi=0;isFpdAdded=false;}};for(var adUnitIndex=0;adUnitIndex<transactionIds.length;adUnitIndex++){var _ret=_loop(adUnitIndex);if(_ret==="break")break;}
return requests;}
function _getUserIds(bidRequest){var userIds=bidRequest.userId||{};return PROVIDERS.filter(function(provider){return userIds[provider];});}
function buildIXDiag(validBidRequests){var adUnitMap=validBidRequests.map(function(bidRequest){return bidRequest.transactionId;}).filter(function(value,index,arr){return arr.indexOf(value)===index;});var ixdiag={mfu:0,bu:0,iu:0,nu:0,ou:0,allu:0,ren:false,version:"6.24.1",userIds:_getUserIds(validBidRequests[0])};var _loop2=function _loop2(i){bid=validBidRequests.filter(function(bidRequest){return bidRequest.transactionId===adUnitMap[i];})[0];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes')){if(Object.keys(bid.mediaTypes).length>1){ixdiag.mfu++;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.native')){ixdiag.nu++;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.banner')){ixdiag.bu++;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.context')==='outstream'){ixdiag.ou++;var hasRenderer=_typeof((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'renderer')||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.renderer'))==='object';ixdiag.ren=ixdiag.ren&&hasRenderer?(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(ixdiag,'ren'):hasRenderer;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.context')==='instream'){ixdiag.iu++;}
ixdiag.allu++;}};for(var i=0;i<adUnitMap.length;i++){var bid;_loop2(i);}
return ixdiag;}
function removeFromSizes(bannerSizeList,bannerSize){if(!bannerSize)return;for(var i=0;i<bannerSizeList.length;i++){var size=bannerSizeList[i];if(bannerSize[0]===size[0]&&bannerSize[1]===size[1]){bannerSizeList.splice(i,1);break;}}}
function createVideoImps(validBidRequest,videoImps){var imp=bidToVideoImp(validBidRequest);if(Object.keys(imp).length!=0){videoImps[validBidRequest.transactionId]={};videoImps[validBidRequest.transactionId].ixImps=[];videoImps[validBidRequest.transactionId].ixImps.push(imp);videoImps[validBidRequest.transactionId].gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'ortb2Imp.ext.gpid');}}
function createBannerImps(validBidRequest,missingBannerSizes,bannerImps){var DEFAULT_IX_CONFIG={detectMissingSizes:true};var ixConfig=_objectSpread(_objectSpread({},DEFAULT_IX_CONFIG),_src_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig('ix'));var imp=bidToBannerImp(validBidRequest);var bannerSizeDefined=includesSize((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'mediaTypes.banner.sizes'),(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'params.size'));if(!bannerImps.hasOwnProperty(validBidRequest.transactionId)){bannerImps[validBidRequest.transactionId]={};}
bannerImps[validBidRequest.transactionId].gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'ortb2Imp.ext.gpid');bannerImps[validBidRequest.transactionId].dfp_ad_unit_code=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'ortb2Imp.ext.data.adserver.adslot');if(bannerSizeDefined){if(!bannerImps[validBidRequest.transactionId].hasOwnProperty('ixImps')){bannerImps[validBidRequest.transactionId].ixImps=[];}
bannerImps[validBidRequest.transactionId].ixImps.push(imp);}
if(ixConfig.hasOwnProperty('detectMissingSizes')&&ixConfig.detectMissingSizes){updateMissingSizes(validBidRequest,missingBannerSizes,imp);}}
function getPageUrl(){var pageUrl=_src_config_js__WEBPACK_IMPORTED_MODULE_7__.config.getConfig('pageUrl');try{var url=new URL(pageUrl);return url.href;}catch(_){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)("IX Bid Adapter: invalid pageUrl config property value set: ".concat(pageUrl));return undefined;}}
function detectParamsType(validBidRequest){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'params.video')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'mediaTypes.video')){return _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO;}
return _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER;}
function updateMissingSizes(validBidRequest,missingBannerSizes,imp){var transactionID=validBidRequest.transactionId;if(missingBannerSizes.hasOwnProperty(transactionID)){var currentSizeList=[];if(missingBannerSizes[transactionID].hasOwnProperty('missingSizes')){currentSizeList=missingBannerSizes[transactionID].missingSizes;}
removeFromSizes(currentSizeList,validBidRequest.params.size);missingBannerSizes[transactionID].missingSizes=currentSizeList;}else{if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'mediaTypes.banner.sizes')){var sizeList=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.deepClone)(validBidRequest.mediaTypes.banner.sizes);removeFromSizes(sizeList,validBidRequest.params.size);var newAdUnitEntry={'missingSizes':sizeList,'impression':imp};missingBannerSizes[transactionID]=newAdUnitEntry;}}}
function createMissingBannerImp(bid,imp,newSize){var newImp=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.deepClone)(imp);newImp.ext.sid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.parseGPTSingleSizeArray)(newSize);newImp.banner.w=newSize[0];newImp.banner.h=newSize[1];_applyFloor(bid,newImp,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER);return newImp;}
function storeErrorEventData(data){if(!storage.localStorageIsEnabled()){return;}
var currentStorage;try{currentStorage=JSON.parse(storage.getDataFromLocalStorage(LOCAL_STORAGE_KEY)||'{}');}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('ix can not read ixdiag from localStorage.');}
var todayDate=new Date();Object.keys(currentStorage).map(function(errorDate){var date=new Date(errorDate);if(date.setDate(date.getDate()+7)-todayDate<0){delete currentStorage[errorDate];}});if(data.type==='ERROR'&&data.arguments&&data.arguments[1]&&data.arguments[1].bidder===BIDDER_CODE){var todayString=todayDate.toISOString().slice(0,10);var errorCode=data.arguments[1].code;if(errorCode){currentStorage[todayString]=currentStorage[todayString]||{};if(!Number(currentStorage[todayString][errorCode])){currentStorage[todayString][errorCode]=0;}
currentStorage[todayString][errorCode]++;};}
storage.setDataInLocalStorage(LOCAL_STORAGE_KEY,JSON.stringify(currentStorage));}
function localStorageHandler(data){if(data.type==='ERROR'&&data.arguments&&data.arguments[1]&&data.arguments[1].bidder===BIDDER_CODE){var DEFAULT_ENFORCEMENT_SETTINGS={hasEnforcementHook:false,valid:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.hasDeviceAccess)()};(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_1__.validateStorageEnforcement)(GLOBAL_VENDOR_ID,BIDDER_CODE,DEFAULT_ENFORCEMENT_SETTINGS,function(permissions){if(permissions.valid){storeErrorEventData(data);}});}}
function getCachedErrors(){if(!storage.localStorageIsEnabled()){return;}
var errors={};var currentStorage;try{currentStorage=JSON.parse(storage.getDataFromLocalStorage(LOCAL_STORAGE_KEY)||'{}');}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('ix can not read ixdiag from localStorage.');return null;}
Object.keys(currentStorage).forEach(function(date){Object.keys(currentStorage[date]).forEach(function(code){if(typeof currentStorage[date][code]==='number'){errors[code]=errors[code]?errors[code]+currentStorage[date][code]:currentStorage[date][code];}});});return errors;}
function outstreamRenderer(bid){bid.renderer.push(function(){var config={width:bid.width,height:bid.height,timeout:3000};if(bid.vastXml){window.IXOutstreamPlayer(bid.vastXml,bid.adUnitCode,config);}else{window.IXOutstreamPlayer(bid.vastUrl,bid.adUnitCode,config);}});}
function createRenderer(id){var renderer=_src_Renderer_js__WEBPACK_IMPORTED_MODULE_8__.Renderer.install({id:id,url:RENDERER_URL,loaded:false});try{renderer.setRender(outstreamRenderer);}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('Prebid Error calling setRender on renderer',err);}
return renderer;}
var spec={code:BIDDER_CODE,gvlid:GLOBAL_VENDOR_ID,aliases:[{code:ALIAS_BIDDER_CODE,gvlid:GLOBAL_VENDOR_ID,skipPbsAliasing:false}],supportedMediaTypes:SUPPORTED_AD_TYPES,isBidRequestValid:function isBidRequestValid(bid){if(!hasRegisteredHandler){_src_events_js__WEBPACK_IMPORTED_MODULE_9__.on(_src_constants_json__WEBPACK_IMPORTED_MODULE_10__.EVENTS.AUCTION_DEBUG,localStorageHandler);_src_events_js__WEBPACK_IMPORTED_MODULE_9__.on(_src_constants_json__WEBPACK_IMPORTED_MODULE_10__.EVENTS.AD_RENDER_FAILED,localStorageHandler);hasRegisteredHandler=true;}
var paramsVideoRef=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'params.video');var paramsSize=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'params.size');var mediaTypeBannerSizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.banner.sizes');var mediaTypeVideoRef=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video');var mediaTypeVideoPlayerSize=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.playerSize');var hasBidFloor=bid.params.hasOwnProperty('bidFloor');var hasBidFloorCur=bid.params.hasOwnProperty('bidFloorCur');if(bid.hasOwnProperty('mediaType')&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.contains)(SUPPORTED_AD_TYPES,bid.mediaType)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logWarn)('IX Bid Adapter: media type is not supported.');return false;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.banner')&&!mediaTypeBannerSizes){return false;}
if(paramsSize){var ixSize=getFirstSize(paramsSize);if(!ixSize){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: size has invalid format.',{bidder:BIDDER_CODE,code:ERROR_CODES.BID_SIZE_INVALID_FORMAT});return false;}
if(!includesSize(bid.sizes,ixSize)&&!includesSize(mediaTypeVideoPlayerSize,ixSize)&&!includesSize(mediaTypeBannerSizes,ixSize)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: bid size is not included in ad unit sizes or player size.',{bidder:BIDDER_CODE,code:ERROR_CODES.BID_SIZE_NOT_INCLUDED});return false;}}
if(typeof bid.params.siteId!=='string'&&typeof bid.params.siteId!=='number'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: siteId must be string or number type.',{bidder:BIDDER_CODE,code:ERROR_CODES.SITE_ID_INVALID_VALUE});return false;}
if(typeof bid.params.siteId!=='string'&&isNaN(Number(bid.params.siteId))){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: siteId must valid value',{bidder:BIDDER_CODE,code:ERROR_CODES.SITE_ID_INVALID_VALUE});return false;}
if(hasBidFloor||hasBidFloorCur){if(!(hasBidFloor&&hasBidFloorCur&&isValidBidFloorParams(bid.params.bidFloor,bid.params.bidFloorCur))){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('IX Bid Adapter: bidFloor / bidFloorCur parameter has invalid format.',{bidder:BIDDER_CODE,code:ERROR_CODES.BID_FLOOR_INVALID_FORMAT});return false;}}
if(mediaTypeVideoRef&&paramsVideoRef){var errorList=checkVideoParams(mediaTypeVideoRef,paramsVideoRef);if(errorList.length){errorList.forEach(function(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)(err,{bidder:BIDDER_CODE,code:ERROR_CODES.PROPERTY_NOT_INCLUDED});});return false;}}
return true;},buildRequests:function buildRequests(validBidRequests,bidderRequest){var reqs=[];var bannerImps={};var videoImps={};var multiFormatAdUnits={};var missingBannerSizes={};validBidRequests.forEach(function(validBidRequest){var adUnitMediaTypes=Object.keys((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequest,'mediaTypes',{}));switch(detectParamsType(validBidRequest)){case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER:createBannerImps(validBidRequest,missingBannerSizes,bannerImps);break;case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO:createVideoImps(validBidRequest,videoImps);break;}
if((0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(adUnitMediaTypes,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER)&&(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(adUnitMediaTypes,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO)){multiFormatAdUnits[validBidRequest.transactionId]=validBidRequest;}});Object.keys(multiFormatAdUnits).forEach(function(transactionId){var validBidRequest=multiFormatAdUnits[transactionId];if(!bannerImps[transactionId]){createBannerImps(validBidRequest,missingBannerSizes,bannerImps);}
if(!videoImps[transactionId]){createVideoImps(validBidRequest,videoImps);}});for(var transactionId in missingBannerSizes){if(missingBannerSizes.hasOwnProperty(transactionId)){var missingSizes=missingBannerSizes[transactionId].missingSizes;if(!bannerImps.hasOwnProperty(transactionId)){bannerImps[transactionId]={};}
if(!bannerImps[transactionId].hasOwnProperty('missingImps')){bannerImps[transactionId].missingImps=[];bannerImps[transactionId].missingCount=0;}
var origImp=missingBannerSizes[transactionId].impression;for(var i=0;i<missingSizes.length;i++){var newImp=createMissingBannerImp(validBidRequests[0],origImp,missingSizes[i]);bannerImps[transactionId].missingImps.push(newImp);bannerImps[transactionId].missingCount++;}}}
if(Object.keys(bannerImps).length>0){reqs.push.apply(reqs,_toConsumableArray(buildRequest(validBidRequests,bidderRequest,bannerImps,BANNER_ENDPOINT_VERSION)));}
if(Object.keys(videoImps).length>0){reqs.push.apply(reqs,_toConsumableArray(buildRequest(validBidRequests,bidderRequest,videoImps,VIDEO_ENDPOINT_VERSION)));}
return reqs;},interpretResponse:function interpretResponse(serverResponse,bidderRequest){var bids=[];var bid=null;if(!serverResponse.hasOwnProperty('body')||!serverResponse.body.hasOwnProperty('seatbid')){return bids;}
var responseBody=serverResponse.body;var seatbid=responseBody.seatbid;for(var i=0;i<seatbid.length;i++){if(!seatbid[i].hasOwnProperty('bid')){continue;}
var innerBids=seatbid[i].bid;var requestBid=JSON.parse(bidderRequest.data.r);for(var j=0;j<innerBids.length;j++){var bidRequest=getBidRequest(innerBids[j].impid,requestBid.imp,bidderRequest.validBidRequests);bid=parseBid(innerBids[j],responseBody.cur,bidRequest);if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.renderer')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.context')==='outstream'){bid.renderer=createRenderer(innerBids[j].bidId);}
bids.push(bid);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(requestBid,'ext.ixdiag.err')){if(storage.localStorageIsEnabled()){try{storage.removeDataFromLocalStorage(LOCAL_STORAGE_KEY);}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.logError)('ix can not clear ixdiag from localStorage.');}}}}
return bids;},transformBidParams:function transformBidParams(params,isOpenRtb){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__.convertTypes)({'siteID':'number'},params);},getUserSyncs:function getUserSyncs(syncOptions,serverResponses){return syncOptions.iframeEnabled?[{type:'iframe',url:USER_SYNC_URL}]:[];}};(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_11__.registerBidder)(spec);window.pbjs.installedModules.push('ixBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/ixBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["justpremiumBidAdapter"],{"./modules/justpremiumBidAdapter.js":
/*!******************************************!*\
  !*** ./modules/justpremiumBidAdapter.js ***!
  \******************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var BIDDER_CODE='justpremium';var GVLID=62;var ENDPOINT_URL='https://pre.ads.justpremium.com/v/2.0/t/xhr';var JP_ADAPTER_VERSION='1.8.3';var spec={code:BIDDER_CODE,gvlid:GVLID,time:60000,isBidRequestValid:function isBidRequestValid(bid){return!!(bid&&bid.params&&bid.params.zone);},buildRequests:function buildRequests(validBidRequests,bidderRequest){var c=preparePubCond(validBidRequests);var dim=getWebsiteDim();var ggExt=getGumGumParams();var payload={zone:validBidRequests.map(function(b){return parseInt(b.params.zone);}).filter(function(value,index,self){return self.indexOf(value)===index;}),referer:bidderRequest.refererInfo.referer,sw:dim.screenWidth,sh:dim.screenHeight,ww:dim.innerWidth,wh:dim.innerHeight,c:c,id:validBidRequests[0].params.zone,sizes:{},ggExt:ggExt};validBidRequests.forEach(function(b){var zone=b.params.zone;var sizes=payload.sizes;sizes[zone]=sizes[zone]||[];sizes[zone].push.apply(sizes[zone],b.mediaTypes&&b.mediaTypes.banner&&b.mediaTypes.banner.sizes);});if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(validBidRequests[0],'userId.pubcid')){payload.pubcid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(validBidRequests[0],'userId.pubcid');}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(validBidRequests[0],'crumbs.pubcid')){payload.pubcid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__["default"])(validBidRequests[0],'crumbs.pubcid');}
payload.uids=validBidRequests[0].userId;if(bidderRequest&&bidderRequest.gdprConsent){payload.gdpr_consent={consent_string:bidderRequest.gdprConsent.consentString,consent_required:typeof bidderRequest.gdprConsent.gdprApplies==='boolean'?bidderRequest.gdprConsent.gdprApplies:true};}
if(bidderRequest&&bidderRequest.uspConsent){payload.us_privacy=bidderRequest.uspConsent;}
payload.version={prebid:"6.24.1",jp_adapter:JP_ADAPTER_VERSION};if(validBidRequests[0].schain){payload.schain=validBidRequests[0].schain;}
var payloadString=JSON.stringify(payload);return{method:'POST',url:ENDPOINT_URL+'?i='+ +new Date(),data:payloadString,bids:validBidRequests};},interpretResponse:function interpretResponse(serverResponse,bidRequests){var body=serverResponse.body;var bidResponses=[];bidRequests.bids.forEach(function(adUnit){var bid=findBid(adUnit.params,body.bid);if(bid){var size=adUnit.mediaTypes&&adUnit.mediaTypes.banner&&adUnit.mediaTypes.banner.sizes&&adUnit.mediaTypes.banner.sizes.length&&adUnit.mediaTypes.banner.sizes[0]||[];var bidResponse={requestId:adUnit.bidId,creativeId:bid.id,width:size[0]||bid.width,height:size[1]||bid.height,ad:bid.adm,cpm:bid.price,netRevenue:true,currency:bid.currency||'USD',ttl:bid.ttl||spec.time,format:bid.format,meta:{advertiserDomains:bid.adomain&&bid.adomain.length>0?bid.adomain:[]}};if(bid.ext&&bid.ext.pg){bidResponse.adserverTargeting={'hb_deal_justpremium':'jp_pg'};}
bidResponses.push(bidResponse);}});return bidResponses;},getUserSyncs:function getUserSyncs(syncOptions,serverResponses,gdprConsent,uspConsent){var url='https://pre.ads.justpremium.com/v/1.0/t/sync'+'?_c='+'a'+Math.random().toString(36).substring(7)+Date.now();var pixels=[];if(gdprConsent&&typeof gdprConsent.gdprApplies==='boolean'&&gdprConsent.gdprApplies&&gdprConsent.consentString){url=url+'&consentString='+encodeURIComponent(gdprConsent.consentString);}
if(uspConsent){url=url+'&usPrivacy='+encodeURIComponent(uspConsent);}
if(syncOptions.iframeEnabled){pixels.push({type:'iframe',url:url});}
if(syncOptions.pixelEnabled&&serverResponses.length!==0){var pxsFromResponse=serverResponses.map(function(res){var _res$body;return res===null||res===void 0?void 0:(_res$body=res.body)===null||_res$body===void 0?void 0:_res$body.pxs;}).reduce(function(acc,cur){return acc.concat(cur);},[]).filter(function(obj){return obj!==undefined;});pixels=[].concat(_toConsumableArray(pixels),_toConsumableArray(pxsFromResponse));}
return pixels;}};function findBid(params,bids){var tagId=params.zone;if(bids[tagId]){var len=bids[tagId].length;while(len--){if(passCond(params,bids[tagId][len])){return bids[tagId].splice(len,1).pop();}}}
return false;}
function passCond(params,bid){var format=bid.format;if(params.allow&&params.allow.length){return params.allow.indexOf(format)>-1;}
if(params.exclude&&params.exclude.length){return params.exclude.indexOf(format)<0;}
return true;}
function preparePubCond(bids){var cond={};var count={};bids.forEach(function(bid){var params=bid.params;var zone=params.zone;if(cond[zone]===1){return;}
var allow=params.allow||params.formats||[];var exclude=params.exclude||[];if(allow.length===0&&exclude.length===0){return cond[params.zone]=1;}
cond[zone]=cond[zone]||[[],{}];cond[zone][0]=arrayUnique(cond[zone][0].concat(allow));exclude.forEach(function(e){if(!cond[zone][1][e]){cond[zone][1][e]=1;}else{cond[zone][1][e]++;}});count[zone]=count[zone]||0;if(exclude.length){count[zone]++;}});Object.keys(count).forEach(function(zone){if(cond[zone]===1)return;var exclude=[];Object.keys(cond[zone][1]).forEach(function(format){if(cond[zone][1][format]===count[zone]){exclude.push(format);}});cond[zone][1]=exclude;});Object.keys(cond).forEach(function(zone){if(cond[zone]!==1&&cond[zone][1].length){cond[zone][0].forEach(function(r){var idx=cond[zone][1].indexOf(r);if(idx>-1){cond[zone][1].splice(idx,1);}});cond[zone][0].length=0;}
if(cond[zone]!==1&&!cond[zone][0].length&&!cond[zone][1].length){cond[zone]=1;}});return cond;}
function arrayUnique(array){var a=array.concat();for(var i=0;i<a.length;++i){for(var j=i+1;j<a.length;++j){if(a[i]===a[j]){a.splice(j--,1);}}}
return a;}
function getWebsiteDim(){var top;try{top=window.top;}catch(e){top=window;}
return{screenWidth:top.screen.width,screenHeight:top.screen.height,innerWidth:top.innerWidth,innerHeight:top.innerHeight};}
function getGumGumParams(){if(!window.top)return null;var urlParams=new URLSearchParams(window.top.location.search);var ggParams={'ggAdbuyid':urlParams.get('gg_adbuyid'),'ggDealid':urlParams.get('gg_dealid'),'ggEadbuyid':urlParams.get('gg_eadbuyid')};var checkIfEmpty=function checkIfEmpty(obj){return Object.keys(obj).length===0?null:obj;};var removeNullEntries=function removeNullEntries(obj){return Object.fromEntries(Object.entries(obj).filter(function(_ref){var _ref2=_slicedToArray(_ref,2),_=_ref2[0],v=_ref2[1];return v!=null;}));};return checkIfEmpty(removeNullEntries(ggParams));}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_1__.registerBidder)(spec);window.pbjs.installedModules.push('justpremiumBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/justpremiumBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["openxBidAdapter"],{"./modules/openxBidAdapter.js":
/*!************************************!*\
  !*** ./modules/openxBidAdapter.js ***!
  \************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var SUPPORTED_AD_TYPES=[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO];var VIDEO_TARGETING=['startdelay','mimes','minduration','maxduration','startdelay','skippable','playbackmethod','api','protocols','boxingallowed','linearity','delivery','protocol','placement','minbitrate','maxbitrate'];var BIDDER_CODE='openx';var BIDDER_CONFIG='hb_pb';var BIDDER_VERSION='3.0.3';var DEFAULT_CURRENCY='USD';var USER_ID_CODE_TO_QUERY_ARG={britepoolid:'britepoolid',criteoId:'criteoid',fabrickId:'nuestarid',haloId:'audigentid',id5id:'id5id',idl_env:'lre',IDP:'zeotapid',idxId:'idxid',intentIqId:'intentiqid',lipb:'lipbid',lotamePanoramaId:'lotameid',merkleId:'merkleid',netId:'netid',parrableId:'parrableid',pubcid:'pubcid',quantcastId:'quantcastid',tapadId:'tapadid',tdid:'ttduuid',uid2:'uid2',flocId:'floc',admixerId:'admixerid',deepintentId:'deepintentid',dmdId:'dmdid',nextrollId:'nextrollid',novatiq:'novatiqid',mwOpenLinkId:'mwopenlinkid',dapId:'dapid',amxId:'amxid',kpuid:'kpuid',publinkId:'publinkid',naveggId:'naveggid',imuid:'imuid',adtelligentId:'adtelligentid'};var spec={code:BIDDER_CODE,gvlid:69,supportedMediaTypes:SUPPORTED_AD_TYPES,isBidRequestValid:function isBidRequestValid(bidRequest){var hasDelDomainOrPlatform=bidRequest.params.delDomain||bidRequest.params.platform;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bidRequest,'mediaTypes.banner')&&hasDelDomainOrPlatform){return!!bidRequest.params.unit||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bidRequest,'mediaTypes.banner.sizes.length')>0;}
return!!(bidRequest.params.unit&&hasDelDomainOrPlatform);},buildRequests:function buildRequests(bidRequests,bidderRequest){if(bidRequests.length===0){return[];}
var requests=[];var _partitionByVideoBids=partitionByVideoBids(bidRequests),_partitionByVideoBids2=_slicedToArray(_partitionByVideoBids,2),videoBids=_partitionByVideoBids2[0],bannerBids=_partitionByVideoBids2[1];if(bannerBids.length>0){requests.push(buildOXBannerRequest(bannerBids,bidderRequest));}
if(videoBids.length>0){videoBids.forEach(function(videoBid){requests.push(buildOXVideoRequest(videoBid,bidderRequest));});}
return requests;},interpretResponse:function interpretResponse(_ref,serverRequest){var oxResponseObj=_ref.body;var mediaType=getMediaTypeFromRequest(serverRequest);return mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO?createVideoBidResponses(oxResponseObj,serverRequest.payload):createBannerBidResponses(oxResponseObj,serverRequest.payload);},getUserSyncs:function getUserSyncs(syncOptions,responses,gdprConsent,uspConsent){if(syncOptions.iframeEnabled||syncOptions.pixelEnabled){var pixelType=syncOptions.iframeEnabled?'iframe':'image';var url=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(responses,'0.body.ads.pixels')||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(responses,'0.body.pixels')||generateDefaultSyncUrl(gdprConsent,uspConsent);return[{type:pixelType,url:url}];}},transformBidParams:function transformBidParams(params,isOpenRtb){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.convertTypes)({'unit':'string','customFloor':'number'},params);}};function generateDefaultSyncUrl(gdprConsent,uspConsent){var url='https://u.openx.net/w/1.0/pd';var queryParamStrings=[];if(gdprConsent){queryParamStrings.push('gdpr='+(gdprConsent.gdprApplies?1:0));queryParamStrings.push('gdpr_consent='+encodeURIComponent(gdprConsent.consentString||''));}
if(uspConsent){queryParamStrings.push('us_privacy='+encodeURIComponent(uspConsent));}
return"".concat(url).concat(queryParamStrings.length>0?'?'+queryParamStrings.join('&'):'');}
function isVideoRequest(bidRequest){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bidRequest,'mediaTypes.video')&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bidRequest,'mediaTypes.banner')||bidRequest.mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO;}
function createBannerBidResponses(oxResponseObj,_ref2){var bids=_ref2.bids,startTime=_ref2.startTime;var adUnits=oxResponseObj.ads.ad;var bidResponses=[];for(var i=0;i<adUnits.length;i++){var adUnit=adUnits[i];var adUnitIdx=parseInt(adUnit.idx,10);var bidResponse={};bidResponse.requestId=bids[adUnitIdx].bidId;if(adUnit.pub_rev){bidResponse.cpm=Number(adUnit.pub_rev)/1000;}else{continue;}
var creative=adUnit.creative[0];if(creative){bidResponse.width=creative.width;bidResponse.height=creative.height;}
bidResponse.creativeId=creative.id;bidResponse.ad=adUnit.html;if(adUnit.deal_id){bidResponse.dealId=adUnit.deal_id;}
bidResponse.ttl=300;bidResponse.netRevenue=true;bidResponse.currency=adUnit.currency;if(adUnit.tbd){bidResponse.tbd=adUnit.tbd;}
bidResponse.ts=adUnit.ts;bidResponse.meta={};if(adUnit.brand_id){bidResponse.meta.brandId=adUnit.brand_id;}
if(adUnit.adomain&&length(adUnit.adomain)>0){bidResponse.meta.advertiserDomains=adUnit.adomain;}else{bidResponse.meta.advertiserDomains=[];}
if(adUnit.adv_id){bidResponse.meta.dspid=adUnit.adv_id;}
bidResponses.push(bidResponse);}
return bidResponses;}
function getViewportDimensions(isIfr){var width;var height;var tWin=window;var tDoc=document;var docEl=tDoc.documentElement;var body;if(isIfr){try{tWin=window.top;tDoc=window.top.document;}catch(e){return;}
docEl=tDoc.documentElement;body=tDoc.body;width=tWin.innerWidth||docEl.clientWidth||body.clientWidth;height=tWin.innerHeight||docEl.clientHeight||body.clientHeight;}else{docEl=tDoc.documentElement;width=tWin.innerWidth||docEl.clientWidth;height=tWin.innerHeight||docEl.clientHeight;}
return"".concat(width,"x").concat(height);}
function formatCustomParms(customKey,customParams){var value=customParams[customKey];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(value)){value=value.join(',');}
return(customKey.toLowerCase()+'='+value.toLowerCase()).replace('+','.').replace('/','_');}
function partitionByVideoBids(bidRequests){return bidRequests.reduce(function(acc,bid){if(isVideoRequest(bid)){acc[0].push(bid);}else{acc[1].push(bid);}
return acc;},[[],[]]);}
function getMediaTypeFromRequest(serverRequest){return /avjp$/.test(serverRequest.url)?_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER;}
function buildCommonQueryParamsFromBids(bids,bidderRequest){var isInIframe=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.inIframe)();var defaultParams;defaultParams={ju:_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('pageUrl')||bidderRequest.refererInfo.referer,ch:document.charSet||document.characterSet,res:"".concat(screen.width,"x").concat(screen.height,"x").concat(screen.colorDepth),ifr:isInIframe,tz:new Date().getTimezoneOffset(),tws:getViewportDimensions(isInIframe),be:1,bc:bids[0].params.bc||"".concat(BIDDER_CONFIG,"_").concat(BIDDER_VERSION),dddid:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(bids,function(bid){return bid.transactionId;}).join(','),nocache:new Date().getTime()};var userDataSegments=buildFpdQueryParams('ortb2.user.data');if(userDataSegments.length>0){defaultParams.sm=userDataSegments;}
var siteContentDataSegments=buildFpdQueryParams('ortb2.site.content.data');if(siteContentDataSegments.length>0){defaultParams.scsm=siteContentDataSegments;}
if(bids[0].params.platform){defaultParams.ph=bids[0].params.platform;}
if(bidderRequest.gdprConsent){var gdprConsentConfig=bidderRequest.gdprConsent;if(gdprConsentConfig.consentString!==undefined){defaultParams.gdpr_consent=gdprConsentConfig.consentString;}
if(gdprConsentConfig.gdprApplies!==undefined){defaultParams.gdpr=gdprConsentConfig.gdprApplies?1:0;}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('consentManagement.cmpApi')==='iab'){defaultParams.x_gdpr_f=1;}}
if(bidderRequest&&bidderRequest.uspConsent){defaultParams.us_privacy=bidderRequest.uspConsent;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bids[0],'crumbs.pubcid')){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(bids[0],'userId.pubcid',(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bids[0],'crumbs.pubcid'));}
defaultParams=appendUserIdsToQueryParams(defaultParams,bids[0].userId);if(bids[0].schain){defaultParams.schain=serializeSupplyChain(bids[0].schain);}
return defaultParams;}
function buildFpdQueryParams(fpdPath){var firstPartyData=_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig(fpdPath);if(!Array.isArray(firstPartyData)||!firstPartyData.length){return'';}
var fpd=firstPartyData.filter(function(data){return Array.isArray(data.segment)&&data.segment.length>0&&data.name!==undefined&&data.name.length>0;}).reduce(function(acc,data){var name=_typeof(data.ext)==='object'&&data.ext.segtax?"".concat(data.name,"/").concat(data.ext.segtax):data.name;acc[name]=(acc[name]||[]).concat(data.segment.map(function(seg){return seg.id;}));return acc;},{});return Object.keys(fpd).map(function(name,_){return name+':'+fpd[name].join('|');}).join(',');}
function appendUserIdsToQueryParams(queryParams,userIds){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._each)(userIds,function(userIdObjectOrValue,userIdProviderKey){var key=USER_ID_CODE_TO_QUERY_ARG[userIdProviderKey];if(USER_ID_CODE_TO_QUERY_ARG.hasOwnProperty(userIdProviderKey)){switch(userIdProviderKey){case'merkleId':queryParams[key]=userIdObjectOrValue.id;break;case'flocId':queryParams[key]=userIdObjectOrValue.id;break;case'uid2':queryParams[key]=userIdObjectOrValue.id;break;case'lipb':queryParams[key]=userIdObjectOrValue.lipbid;if(Array.isArray(userIdObjectOrValue.segments)&&userIdObjectOrValue.segments.length>0){var liveIntentSegments='liveintent:'+userIdObjectOrValue.segments.join('|');queryParams.sm="".concat(queryParams.sm?queryParams.sm+',':'').concat(liveIntentSegments);}
break;case'parrableId':queryParams[key]=userIdObjectOrValue.eid;break;case'id5id':queryParams[key]=userIdObjectOrValue.uid;break;case'novatiq':queryParams[key]=userIdObjectOrValue.snowflake;break;default:queryParams[key]=userIdObjectOrValue;}}});return queryParams;}
function serializeSupplyChain(supplyChain){return"".concat(supplyChain.ver,",").concat(supplyChain.complete,"!").concat(serializeSupplyChainNodes(supplyChain.nodes));}
function serializeSupplyChainNodes(supplyChainNodes){var supplyChainNodePropertyOrder=['asi','sid','hp','rid','name','domain'];return supplyChainNodes.map(function(supplyChainNode){return supplyChainNodePropertyOrder.map(function(property){return supplyChainNode[property]||'';}).join(',');}).join('!');}
function buildOXBannerRequest(bids,bidderRequest){var customParamsForAllBids=[];var hasCustomParam=false;var queryParams=buildCommonQueryParamsFromBids(bids,bidderRequest);var auids=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(bids,function(bid){return bid.params.unit;});queryParams.aus=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(bids,function(bid){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseSizesInput)(bid.mediaTypes.banner.sizes).join(',');}).join('|');queryParams.divids=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(bids,function(bid){return encodeURIComponent(bid.adUnitCode);}).join(',');queryParams.aucs=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(bids,function(bid){var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'ortb2Imp.ext.data.pbadslot');return encodeURIComponent(gpid||'');}).join(',');if(auids.some(function(auid){return auid;})){queryParams.auid=auids.join(',');}
if(bids.some(function(bid){return bid.params.doNotTrack;})){queryParams.ns=1;}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('coppa')===true||bids.some(function(bid){return bid.params.coppa;})){queryParams.tfcd=1;}
bids.forEach(function(bid){if(bid.params.customParams){var customParamsForBid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__._map)(Object.keys(bid.params.customParams),function(customKey){return formatCustomParms(customKey,bid.params.customParams);});var formattedCustomParams=window.btoa(customParamsForBid.join('&'));hasCustomParam=true;customParamsForAllBids.push(formattedCustomParams);}else{customParamsForAllBids.push('');}});if(hasCustomParam){queryParams.tps=customParamsForAllBids.join(',');}
enrichQueryWithFloors(queryParams,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER,bids);var url=queryParams.ph?"https://u.openx.net/w/1.0/arj":"https://".concat(bids[0].params.delDomain,"/w/1.0/arj");return{method:'GET',url:url,data:queryParams,payload:{'bids':bids,'startTime':new Date()}};}
function buildOXVideoRequest(bid,bidderRequest){var oxVideoParams=generateVideoParameters(bid,bidderRequest);var url=oxVideoParams.ph?"https://u.openx.net/v/1.0/avjp":"https://".concat(bid.params.delDomain,"/v/1.0/avjp");return{method:'GET',url:url,data:oxVideoParams,payload:{'bid':bid,'startTime':new Date()}};}
function generateVideoParameters(bid,bidderRequest){var videoMediaType=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,"mediaTypes.video");var queryParams=buildCommonQueryParamsFromBids([bid],bidderRequest);var oxVideoConfig=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'params.video')||{};var context=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'mediaTypes.video.context');var playerSize=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'mediaTypes.video.playerSize');var width;var height;if(bid.params.width&&bid.params.height){width=bid.params.width;height=bid.params.height;}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(bid.sizes)&&bid.sizes.length===2&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(bid.sizes[0])){width=parseInt(bid.sizes[0],10);height=parseInt(bid.sizes[1],10);}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(bid.sizes)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(bid.sizes[0])&&bid.sizes[0].length===2){width=parseInt(bid.sizes[0][0],10);height=parseInt(bid.sizes[0][1],10);}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(playerSize)&&playerSize.length===2){width=parseInt(playerSize[0],10);height=parseInt(playerSize[1],10);}
var openRtbParams={w:width,h:height};var legacyParams=bid.params.video||bid.params.openrtb||{};if(legacyParams.openrtb){legacyParams=legacyParams.openrtb;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.isArray)(legacyParams.imp)){legacyParams=legacyParams.imp[0].video;}
Object.keys(legacyParams).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(VIDEO_TARGETING,param);}).forEach(function(param){return openRtbParams[param]=legacyParams[param];});Object.keys(videoMediaType).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_5__.includes)(VIDEO_TARGETING,param);}).forEach(function(param){return openRtbParams[param]=videoMediaType[param];});var openRtbReq={imp:[{video:openRtbParams}]};queryParams['openrtb']=JSON.stringify(openRtbReq);queryParams.auid=bid.params.unit;queryParams.vwd=width||oxVideoConfig.vwd;queryParams.vht=height||oxVideoConfig.vht;if(context==='outstream'){queryParams.vos='101';}
if(oxVideoConfig.mimes){queryParams.vmimes=oxVideoConfig.mimes;}
if(bid.params.test){queryParams.vtest=1;}
var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(bid,'ortb2Imp.ext.data.pbadslot');if(gpid){queryParams.aucs=encodeURIComponent(gpid);}
enrichQueryWithFloors(queryParams,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO,[bid]);return queryParams;}
function createVideoBidResponses(response,_ref3){var bid=_ref3.bid,startTime=_ref3.startTime;var bidResponses=[];if(response!==undefined&&response.vastUrl!==''&&response.pub_rev>0){var vastQueryParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseUrl)(response.vastUrl).search||{};var bidResponse={};bidResponse.requestId=bid.bidId;if(response.deal_id){bidResponse.dealId=response.deal_id;}
bidResponse.ttl=300;bidResponse.netRevenue=true;bidResponse.currency=response.currency;bidResponse.cpm=parseInt(response.pub_rev,10)/1000;bidResponse.width=parseInt(response.width,10);bidResponse.height=parseInt(response.height,10);bidResponse.creativeId=response.adid;bidResponse.vastUrl=response.vastUrl;bidResponse.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO;response.ph=vastQueryParams.ph;response.colo=vastQueryParams.colo;response.ts=vastQueryParams.ts;bidResponses.push(bidResponse);}
return bidResponses;}
function enrichQueryWithFloors(queryParams,mediaType,bids){var customFloorsForAllBids=[];var hasCustomFloor=false;bids.forEach(function(bid){var floor=getBidFloor(bid,mediaType);if(floor){customFloorsForAllBids.push(floor);hasCustomFloor=true;}else{customFloorsForAllBids.push(0);}});if(hasCustomFloor){queryParams.aumfs=customFloorsForAllBids.join(',');}}
function getBidFloor(bidRequest,mediaType){var floorInfo={};var currency=_src_config_js__WEBPACK_IMPORTED_MODULE_3__.config.getConfig('currency.adServerCurrency')||DEFAULT_CURRENCY;if(typeof bidRequest.getFloor==='function'){floorInfo=bidRequest.getFloor({currency:currency,mediaType:mediaType,size:'*'});}
var floor=floorInfo.floor||bidRequest.params.customFloor||0;return Math.round(floor*1000);}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_6__.registerBidder)(spec);window.pbjs.installedModules.push('openxBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/openxBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["pubMaticIdSystem"],{"./modules/pubMaticIdSystem.js":
/*!*************************************!*\
  !*** ./modules/pubMaticIdSystem.js ***!
  \*************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_hook_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/hook.js */
"./src/hook.js");var MODULE_NAME='pubMaticId';var pubMaticIdSubmodule={name:MODULE_NAME,decode:function decode(value){return value;},getId:function getId(config,consentData){if(!window.PWT||typeof PWT.getUserIds!='function'){return;}
var ids=PWT.getUserIds();console.log('pubMaticID',ids);return{id:ids};}};(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_0__.submodule)('userId',pubMaticIdSubmodule);window.pbjs.installedModules.push('pubMaticIdSystem');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/pubMaticIdSystem.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["pubmaticBidAdapter"],{"./modules/pubmaticBidAdapter.js":
/*!***************************************!*\
  !*** ./modules/pubmaticBidAdapter.js ***!
  \***************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_Renderer_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/Renderer.js */
"./src/Renderer.js");var _src_bidderSettings_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/bidderSettings.js */
"./src/bidderSettings.js");function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var BIDDER_CODE='pubmatic';var LOG_WARN_PREFIX='PubMatic: ';var ENDPOINT='https://hbopenbid.pubmatic.com/translator?source=prebid-client';var USER_SYNC_URL_IFRAME='https://ads.pubmatic.com/AdServer/js/user_sync.html?kdntuid=1&p=';var USER_SYNC_URL_IMAGE='https://image8.pubmatic.com/AdServer/ImgSync?p=';var DEFAULT_CURRENCY='USD';var AUCTION_TYPE=1;var UNDEFINED=undefined;var DEFAULT_WIDTH=0;var DEFAULT_HEIGHT=0;var PREBID_NATIVE_HELP_LINK='http://prebid.org/dev-docs/show-native-ads.html';var PUBLICATION='pubmatic';var RENDERER_URL='https://pubmatic.bbvms.com/r/'.concat('$RENDERER','.js');var MSG_VIDEO_PLACEMENT_MISSING='Video.Placement param missing';var CUSTOM_PARAMS={'kadpageurl':'','gender':'','yob':'','lat':'','lon':'','wiid':'','profId':'','verId':''};var DATA_TYPES={'NUMBER':'number','STRING':'string','BOOLEAN':'boolean','ARRAY':'array','OBJECT':'object'};var VIDEO_CUSTOM_PARAMS={'mimes':DATA_TYPES.ARRAY,'minduration':DATA_TYPES.NUMBER,'maxduration':DATA_TYPES.NUMBER,'startdelay':DATA_TYPES.NUMBER,'playbackmethod':DATA_TYPES.ARRAY,'api':DATA_TYPES.ARRAY,'protocols':DATA_TYPES.ARRAY,'w':DATA_TYPES.NUMBER,'h':DATA_TYPES.NUMBER,'battr':DATA_TYPES.ARRAY,'linearity':DATA_TYPES.NUMBER,'placement':DATA_TYPES.NUMBER,'minbitrate':DATA_TYPES.NUMBER,'maxbitrate':DATA_TYPES.NUMBER,'skip':DATA_TYPES.NUMBER};var NATIVE_ASSETS={'TITLE':{ID:1,KEY:'title',TYPE:0},'IMAGE':{ID:2,KEY:'image',TYPE:0},'ICON':{ID:3,KEY:'icon',TYPE:0},'SPONSOREDBY':{ID:4,KEY:'sponsoredBy',TYPE:1},'BODY':{ID:5,KEY:'body',TYPE:2},'CLICKURL':{ID:6,KEY:'clickUrl',TYPE:0},'VIDEO':{ID:7,KEY:'video',TYPE:0},'EXT':{ID:8,KEY:'ext',TYPE:0},'DATA':{ID:9,KEY:'data',TYPE:0},'LOGO':{ID:10,KEY:'logo',TYPE:0},'SPONSORED':{ID:11,KEY:'sponsored',TYPE:1},'DESC':{ID:12,KEY:'data',TYPE:2},'RATING':{ID:13,KEY:'rating',TYPE:3},'LIKES':{ID:14,KEY:'likes',TYPE:4},'DOWNLOADS':{ID:15,KEY:'downloads',TYPE:5},'PRICE':{ID:16,KEY:'price',TYPE:6},'SALEPRICE':{ID:17,KEY:'saleprice',TYPE:7},'PHONE':{ID:18,KEY:'phone',TYPE:8},'ADDRESS':{ID:19,KEY:'address',TYPE:9},'DESC2':{ID:20,KEY:'desc2',TYPE:10},'DISPLAYURL':{ID:21,KEY:'displayurl',TYPE:11},'CTA':{ID:22,KEY:'cta',TYPE:12}};var NATIVE_ASSET_IMAGE_TYPE={'ICON':1,'LOGO':2,'IMAGE':3};var NATIVE_MINIMUM_REQUIRED_IMAGE_ASSETS=[{id:NATIVE_ASSETS.SPONSOREDBY.ID,required:true,data:{type:1}},{id:NATIVE_ASSETS.TITLE.ID,required:true},{id:NATIVE_ASSETS.IMAGE.ID,required:true}];var NET_REVENUE=true;var dealChannelValues={1:'PMP',5:'PREF',6:'PMPG'};var FLOC_FORMAT={'EID':1,'SEGMENT':2};var BB_RENDERER={bootstrapPlayer:function bootstrapPlayer(bid){var config={code:bid.adUnitCode};if(bid.vastXml)config.vastXml=bid.vastXml;else if(bid.vastUrl)config.vastUrl=bid.vastUrl;if(!bid.vastXml&&!bid.vastUrl){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("".concat(LOG_WARN_PREFIX,": No vastXml or vastUrl on bid, bailing..."));return;}
var rendererId=BB_RENDERER.getRendererId(PUBLICATION,bid.rendererCode);var ele=document.getElementById(bid.adUnitCode);var renderer;for(var rendererIndex=0;rendererIndex<window.bluebillywig.renderers.length;rendererIndex++){if(window.bluebillywig.renderers[rendererIndex]._id===rendererId){renderer=window.bluebillywig.renderers[rendererIndex];break;}}
if(renderer)renderer.bootstrap(config,ele);else(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("".concat(LOG_WARN_PREFIX,": Couldn't find a renderer with ").concat(rendererId));},newRenderer:function newRenderer(rendererCode,adUnitCode){var rendererUrl=RENDERER_URL.replace('$RENDERER',rendererCode);var renderer=_src_Renderer_js__WEBPACK_IMPORTED_MODULE_1__.Renderer.install({url:rendererUrl,loaded:false,adUnitCode:adUnitCode});try{renderer.setRender(BB_RENDERER.outstreamRender);}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("".concat(LOG_WARN_PREFIX,": Error tying to setRender on renderer"),err);}
return renderer;},outstreamRender:function outstreamRender(bid){bid.renderer.push(function(){BB_RENDERER.bootstrapPlayer(bid);});},getRendererId:function getRendererId(pub,renderer){return"".concat(pub,"-").concat(renderer);}};var MEDIATYPE=[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE];var publisherId=0;var isInvalidNativeRequest=false;var NATIVE_ASSET_ID_TO_KEY_MAP={};var NATIVE_ASSET_KEY_TO_ASSET_MAP={};(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(NATIVE_ASSETS,function(anAsset){NATIVE_ASSET_ID_TO_KEY_MAP[anAsset.ID]=anAsset.KEY;});(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(NATIVE_ASSETS,function(anAsset){NATIVE_ASSET_KEY_TO_ASSET_MAP[anAsset.KEY]=anAsset;});function _getDomainFromURL(url){var anchor=document.createElement('a');anchor.href=url;return anchor.hostname;}
function _parseSlotParam(paramName,paramValue){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(paramValue)){paramValue&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Ignoring param key: '+paramName+', expects string-value, found '+_typeof(paramValue));return UNDEFINED;}
switch(paramName){case'pmzoneid':return paramValue.split(',').slice(0,50).map(function(id){return id.trim();}).join();case'kadfloor':return parseFloat(paramValue)||UNDEFINED;case'lat':return parseFloat(paramValue)||UNDEFINED;case'lon':return parseFloat(paramValue)||UNDEFINED;case'yob':return parseInt(paramValue)||UNDEFINED;default:return paramValue;}}
function _cleanSlot(slotName){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(slotName)){return slotName.replace(/^\s+/g,'').replace(/\s+$/g,'');}
if(slotName){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(BIDDER_CODE+': adSlot must be a string. Ignoring adSlot');}
return'';}
function _parseAdSlot(bid){bid.params.adUnit='';bid.params.adUnitIndex='0';bid.params.width=0;bid.params.height=0;bid.params.adSlot=_cleanSlot(bid.params.adSlot);var slot=bid.params.adSlot;var splits=slot.split(':');slot=splits[0];if(splits.length==2){bid.params.adUnitIndex=splits[1];}
splits=slot.split('@');bid.params.adUnit=splits[0];if(splits.length>1){splits=splits[1].split('x');if(splits.length!=2){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'AdSlot Error: adSlot not in required format');return;}
bid.params.width=parseInt(splits[0],10);bid.params.height=parseInt(splits[1],10);}else if(bid.hasOwnProperty('mediaTypes')&&bid.mediaTypes.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER)&&bid.mediaTypes.banner.hasOwnProperty('sizes')){var i=0;var sizeArray=[];for(;i<bid.mediaTypes.banner.sizes.length;i++){if(bid.mediaTypes.banner.sizes[i].length===2){sizeArray.push(bid.mediaTypes.banner.sizes[i]);}}
bid.mediaTypes.banner.sizes=sizeArray;if(bid.mediaTypes.banner.sizes.length>=1){bid.params.width=bid.mediaTypes.banner.sizes[0][0];bid.params.height=bid.mediaTypes.banner.sizes[0][1];bid.mediaTypes.banner.sizes=bid.mediaTypes.banner.sizes.splice(1,bid.mediaTypes.banner.sizes.length-1);}}}
function _initConf(refererInfo){return{pageURL:refererInfo&&refererInfo.referer?refererInfo.referer:window.location.href,refURL:window.document.referrer};}
function _handleCustomParams(params,conf){if(!conf.kadpageurl){conf.kadpageurl=conf.pageURL;}
var key,value,entry;for(key in CUSTOM_PARAMS){if(CUSTOM_PARAMS.hasOwnProperty(key)){value=params[key];if(value){entry=CUSTOM_PARAMS[key];if(_typeof(entry)==='object'){value=entry.f(value,conf);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(value)){conf[key]=value;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Ignoring param : '+key+' with value : '+CUSTOM_PARAMS[key]+', expects string-value, found '+_typeof(value));}}}}
return conf;}
function _createOrtbTemplate(conf){return{id:''+new Date().getTime(),at:AUCTION_TYPE,cur:[DEFAULT_CURRENCY],imp:[],site:{page:conf.pageURL,ref:conf.refURL,publisher:{}},device:{ua:navigator.userAgent,js:1,dnt:navigator.doNotTrack=='yes'||navigator.doNotTrack=='1'||navigator.msDoNotTrack=='1'?1:0,h:screen.height,w:screen.width,language:navigator.language},user:{},ext:{}};}
function _checkParamDataType(key,value,datatype){var errMsg='Ignoring param key: '+key+', expects '+datatype+', found '+_typeof(value);var functionToExecute;switch(datatype){case DATA_TYPES.BOOLEAN:functionToExecute=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isBoolean;break;case DATA_TYPES.NUMBER:functionToExecute=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber;break;case DATA_TYPES.STRING:functionToExecute=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr;break;case DATA_TYPES.ARRAY:functionToExecute=_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray;break;}
if(functionToExecute(value)){return value;}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+errMsg);return UNDEFINED;}
function _commonNativeRequestObject(nativeAsset,params){var key=nativeAsset.KEY;return{id:nativeAsset.ID,required:params[key].required?1:0,data:{type:nativeAsset.TYPE,len:params[key].len,ext:params[key].ext}};}
function _createNativeRequest(params){var nativeRequestObject={assets:[]};for(var key in params){if(params.hasOwnProperty(key)){var assetObj={};if(!(nativeRequestObject.assets&&nativeRequestObject.assets.length>0&&nativeRequestObject.assets.hasOwnProperty(key))){switch(key){case NATIVE_ASSETS.TITLE.KEY:if(params[key].len||params[key].length){assetObj={id:NATIVE_ASSETS.TITLE.ID,required:params[key].required?1:0,title:{len:params[key].len||params[key].length,ext:params[key].ext}};}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Title Length is required for native ad: '+JSON.stringify(params));}
break;case NATIVE_ASSETS.IMAGE.KEY:if(params[key].sizes&&params[key].sizes.length>0){assetObj={id:NATIVE_ASSETS.IMAGE.ID,required:params[key].required?1:0,img:{type:NATIVE_ASSET_IMAGE_TYPE.IMAGE,w:params[key].w||params[key].width||(params[key].sizes?params[key].sizes[0]:UNDEFINED),h:params[key].h||params[key].height||(params[key].sizes?params[key].sizes[1]:UNDEFINED),wmin:params[key].wmin||params[key].minimumWidth||(params[key].minsizes?params[key].minsizes[0]:UNDEFINED),hmin:params[key].hmin||params[key].minimumHeight||(params[key].minsizes?params[key].minsizes[1]:UNDEFINED),mimes:params[key].mimes,ext:params[key].ext}};}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Image sizes is required for native ad: '+JSON.stringify(params));}
break;case NATIVE_ASSETS.ICON.KEY:if(params[key].sizes&&params[key].sizes.length>0){assetObj={id:NATIVE_ASSETS.ICON.ID,required:params[key].required?1:0,img:{type:NATIVE_ASSET_IMAGE_TYPE.ICON,w:params[key].w||params[key].width||(params[key].sizes?params[key].sizes[0]:UNDEFINED),h:params[key].h||params[key].height||(params[key].sizes?params[key].sizes[1]:UNDEFINED)}};}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Icon sizes is required for native ad: '+JSON.stringify(params));};break;case NATIVE_ASSETS.VIDEO.KEY:assetObj={id:NATIVE_ASSETS.VIDEO.ID,required:params[key].required?1:0,video:{minduration:params[key].minduration,maxduration:params[key].maxduration,protocols:params[key].protocols,mimes:params[key].mimes,ext:params[key].ext}};break;case NATIVE_ASSETS.EXT.KEY:assetObj={id:NATIVE_ASSETS.EXT.ID,required:params[key].required?1:0};break;case NATIVE_ASSETS.LOGO.KEY:assetObj={id:NATIVE_ASSETS.LOGO.ID,required:params[key].required?1:0,img:{type:NATIVE_ASSET_IMAGE_TYPE.LOGO,w:params[key].w||params[key].width||(params[key].sizes?params[key].sizes[0]:UNDEFINED),h:params[key].h||params[key].height||(params[key].sizes?params[key].sizes[1]:UNDEFINED)}};break;case NATIVE_ASSETS.SPONSOREDBY.KEY:case NATIVE_ASSETS.BODY.KEY:case NATIVE_ASSETS.RATING.KEY:case NATIVE_ASSETS.LIKES.KEY:case NATIVE_ASSETS.DOWNLOADS.KEY:case NATIVE_ASSETS.PRICE.KEY:case NATIVE_ASSETS.SALEPRICE.KEY:case NATIVE_ASSETS.PHONE.KEY:case NATIVE_ASSETS.ADDRESS.KEY:case NATIVE_ASSETS.DESC2.KEY:case NATIVE_ASSETS.DISPLAYURL.KEY:case NATIVE_ASSETS.CTA.KEY:assetObj=_commonNativeRequestObject(NATIVE_ASSET_KEY_TO_ASSET_MAP[key],params);break;}}}
if(assetObj&&assetObj.id){nativeRequestObject.assets[nativeRequestObject.assets.length]=assetObj;}};var requiredAssetCount=NATIVE_MINIMUM_REQUIRED_IMAGE_ASSETS.length;var presentrequiredAssetCount=0;NATIVE_MINIMUM_REQUIRED_IMAGE_ASSETS.forEach(function(ele){var lengthOfExistingAssets=nativeRequestObject.assets.length;for(var i=0;i<lengthOfExistingAssets;i++){if(ele.id==nativeRequestObject.assets[i].id){presentrequiredAssetCount++;break;}}});if(requiredAssetCount==presentrequiredAssetCount){isInvalidNativeRequest=false;}else{isInvalidNativeRequest=true;}
return nativeRequestObject;}
function _createBannerRequest(bid){var sizes=bid.mediaTypes.banner.sizes;var format=[];var bannerObj;if(sizes!==UNDEFINED&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(sizes)){bannerObj={};if(!bid.params.width&&!bid.params.height){if(sizes.length===0){bannerObj=UNDEFINED;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: mediaTypes.banner.size missing for adunit: '+bid.params.adUnit+'. Ignoring the banner impression in the adunit.');return bannerObj;}else{bannerObj.w=parseInt(sizes[0][0],10);bannerObj.h=parseInt(sizes[0][1],10);sizes=sizes.splice(1,sizes.length-1);}}else{bannerObj.w=bid.params.width;bannerObj.h=bid.params.height;}
if(sizes.length>0){format=[];sizes.forEach(function(size){if(size.length>1){format.push({w:size[0],h:size[1]});}});if(format.length>0){bannerObj.format=format;}}
bannerObj.pos=0;bannerObj.topframe=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.inIframe)()?0:1;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: mediaTypes.banner.size missing for adunit: '+bid.params.adUnit+'. Ignoring the banner impression in the adunit.');bannerObj=UNDEFINED;}
return bannerObj;}
function checkVideoPlacement(videoData,adUnitCode){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(videoData,'placement')){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(MSG_VIDEO_PLACEMENT_MISSING+' for '+adUnitCode);};}
function _createVideoRequest(bid){var videoData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid.mediaTypes,'video'),bid.params.video);var videoObj;if(videoData!==UNDEFINED){videoObj={};checkVideoPlacement(videoData,bid.adUnitCode);for(var key in VIDEO_CUSTOM_PARAMS){if(videoData.hasOwnProperty(key)){videoObj[key]=_checkParamDataType(key,videoData[key],VIDEO_CUSTOM_PARAMS[key]);}}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(videoData&&videoData.playerSize[0])){videoObj.w=parseInt(videoData.playerSize[0][0],10);videoObj.h=parseInt(videoData.playerSize[0][1],10);}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(videoData.playerSize[0])){videoObj.w=parseInt(videoData.playerSize[0],10);videoObj.h=parseInt(videoData.playerSize[1],10);}}else{videoObj=UNDEFINED;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Video config params missing for adunit: '+bid.params.adUnit+' with mediaType set as video. Ignoring video impression in the adunit.');}
return videoObj;}
function _addPMPDealsInImpression(impObj,bid){if(bid.params.deals){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bid.params.deals)){bid.params.deals.forEach(function(dealId){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(dealId)&&dealId.length>3){if(!impObj.pmp){impObj.pmp={private_auction:0,deals:[]};}
impObj.pmp.deals.push({id:dealId});}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: deal-id present in array bid.params.deals should be a strings with more than 3 charaters length, deal-id ignored: '+dealId);}});}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: bid.params.deals should be an array of strings.');}}}
function _addDealCustomTargetings(imp,bid){var dctr='';var dctrLen;if(bid.params.dctr){dctr=bid.params.dctr;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(dctr)&&dctr.length>0){var arr=dctr.split('|');dctr='';arr.forEach(function(val){dctr+=val.length>0?val.trim()+'|':'';});dctrLen=dctr.length;if(dctr.substring(dctrLen,dctrLen-1)==='|'){dctr=dctr.substring(0,dctrLen-1);}
imp.ext['key_val']=dctr.trim();}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Ignoring param : dctr with value : '+dctr+', expects string-value, found empty or non-string value');}}}
function _addJWPlayerSegmentData(imp,bid,isS2S){var jwSegData=bid.rtd&&bid.rtd.jwplayer&&bid.rtd.jwplayer.targeting||undefined;var jwPlayerData='';var jwMark='jw-';if(jwSegData===undefined||jwSegData===''||!jwSegData.hasOwnProperty('segments'))return;var maxLength=jwSegData.segments.length;jwPlayerData+=jwMark+'id='+jwSegData.content.id;for(var i=0;i<maxLength;i++){jwPlayerData+='|'+jwMark+jwSegData.segments[i]+'=1';}
var ext;if(isS2S){imp.dctr===undefined||imp.dctr.length==0?imp.dctr=jwPlayerData:imp.dctr+='|'+jwPlayerData;}else{ext=imp.ext;ext&&ext.key_val===undefined?ext.key_val=jwPlayerData:ext.key_val+='|'+jwPlayerData;}}
function _createImpressionObject(bid,conf){var impObj={};var bannerObj;var videoObj;var nativeObj={};var sizes=bid.hasOwnProperty('sizes')?bid.sizes:[];var mediaTypes='';var format=[];impObj={id:bid.bidId,tagid:bid.params.adUnit||undefined,bidfloor:_parseSlotParam('kadfloor',bid.params.kadfloor),secure:1,ext:{pmZoneId:_parseSlotParam('pmzoneid',bid.params.pmzoneid)},bidfloorcur:bid.params.currency?_parseSlotParam('currency',bid.params.currency):DEFAULT_CURRENCY};_addPMPDealsInImpression(impObj,bid);_addDealCustomTargetings(impObj,bid);_addJWPlayerSegmentData(impObj,bid);if(bid.hasOwnProperty('mediaTypes')){for(mediaTypes in bid.mediaTypes){switch(mediaTypes){case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER:bannerObj=_createBannerRequest(bid);if(bannerObj!==UNDEFINED){impObj.banner=bannerObj;}
break;case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE:nativeObj['request']=JSON.stringify(_createNativeRequest(bid.nativeParams));if(!isInvalidNativeRequest){impObj.native=nativeObj;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Error in Native adunit '+bid.params.adUnit+'. Ignoring the adunit. Refer to '+PREBID_NATIVE_HELP_LINK+' for more details.');}
break;case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO:videoObj=_createVideoRequest(bid);if(videoObj!==UNDEFINED){impObj.video=videoObj;}
break;}}}else{bannerObj={pos:0,w:bid.params.width,h:bid.params.height,topframe:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.inIframe)()?0:1};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(sizes)&&sizes.length>1){sizes=sizes.splice(1,sizes.length-1);sizes.forEach(function(size){format.push({w:size[0],h:size[1]});});bannerObj.format=format;}
impObj.banner=bannerObj;}
_addImpressionFPD(impObj,bid);_addFloorFromFloorModule(impObj,bid);return impObj.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER)||impObj.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE)||impObj.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO)?impObj:UNDEFINED;}
function _addImpressionFPD(imp,bid){var ortb2=_objectSpread({},(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'ortb2Imp.ext.data'));Object.keys(ortb2).forEach(function(prop){if(prop==='pbadslot'){if(typeof ortb2[prop]==='string'&&ortb2[prop])(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imp,'ext.data.pbadslot',ortb2[prop]);}else if(prop==='adserver'){['name','adslot'].forEach(function(name){var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(ortb2,"adserver.".concat(name));if(typeof value==='string'&&value){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imp,"ext.data.adserver.".concat(name.toLowerCase()),value);if(name==='adslot'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imp,"ext.dfp_ad_unit_code",value);}}});}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imp,"ext.data.".concat(prop),ortb2[prop]);}});}
function _addFloorFromFloorModule(impObj,bid){var bidFloor=-1;if(typeof bid.getFloor==='function'&&!_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('pubmatic.disableFloors')){[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE].forEach(function(mediaType){if(impObj.hasOwnProperty(mediaType)){var sizesArray=[];if(mediaType==='banner'){if(impObj[mediaType].w&&impObj[mediaType].h){sizesArray.push([impObj[mediaType].w,impObj[mediaType].h]);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(impObj[mediaType].format)){impObj[mediaType].format.forEach(function(size){return sizesArray.push([size.w,size.h]);});}}
if(sizesArray.length===0){sizesArray.push('*');}
sizesArray.forEach(function(size){var floorInfo=bid.getFloor({currency:impObj.bidfloorcur,mediaType:mediaType,size:size});(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX,'floor from floor module returned for mediatype:',mediaType,' and size:',size,' is: currency',floorInfo.currency,'floor',floorInfo.floor);if(_typeof(floorInfo)==='object'&&floorInfo.currency===impObj.bidfloorcur&&!isNaN(parseInt(floorInfo.floor))){var mediaTypeFloor=parseFloat(floorInfo.floor);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX,'floor from floor module:',mediaTypeFloor,'previous floor value',bidFloor,'Min:',Math.min(mediaTypeFloor,bidFloor));if(bidFloor===-1){bidFloor=mediaTypeFloor;}else{bidFloor=Math.min(mediaTypeFloor,bidFloor);}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX,'new floor value:',bidFloor);}});}});}
if(impObj.bidfloor){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX,'floor from floor module:',bidFloor,'impObj.bidfloor',impObj.bidfloor,'Max:',Math.max(bidFloor,impObj.bidfloor));bidFloor=Math.max(bidFloor,impObj.bidfloor);}
impObj.bidfloor=!isNaN(bidFloor)&&bidFloor>0?bidFloor:UNDEFINED;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX,'new impObj.bidfloor value:',impObj.bidfloor);}
function _getFlocId(validBidRequests,flocFormat){var flocIdObject=null;var flocId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(validBidRequests,'0.userId.flocId');if(flocId&&flocId.id){switch(flocFormat){case FLOC_FORMAT.SEGMENT:flocIdObject={id:'FLOC',name:'FLOC',ext:{ver:flocId.version},segment:[{id:flocId.id,name:'chrome.com',value:flocId.id.toString()}]};break;case FLOC_FORMAT.EID:default:flocIdObject={source:'chrome.com',uids:[{atype:1,id:flocId.id,ext:{ver:flocId.version}}]};break;}}
return flocIdObject;}
function _handleFlocId(payload,validBidRequests){var flocObject=_getFlocId(validBidRequests,FLOC_FORMAT.SEGMENT);if(flocObject){if(!payload.user){payload.user={};}
if(!payload.user.data){payload.user.data=[];}
payload.user.data.push(flocObject);}}
function _handleEids(payload,validBidRequests){var bidUserIdAsEids=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(validBidRequests,'0.userIdAsEids');var flocObject=_getFlocId(validBidRequests,FLOC_FORMAT.EID);if(flocObject){if(!bidUserIdAsEids){bidUserIdAsEids=[];}
bidUserIdAsEids.push(flocObject);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bidUserIdAsEids)&&bidUserIdAsEids.length>0){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'user.eids',bidUserIdAsEids);}}
function _checkMediaType(bid,newBid){if(bid.ext&&bid.ext['bidtype']!=undefined){newBid.mediaType=MEDIATYPE[bid.ext.bidtype];}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logInfo)(LOG_WARN_PREFIX+'bid.ext.bidtype does not exist, checking alternatively for mediaType');var adm=bid.adm;var admStr='';var videoRegex=new RegExp(/VAST\s+version/);if(adm.indexOf('span class="PubAPIAd"')>=0){newBid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER;}else if(videoRegex.test(adm)){newBid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO;}else{try{admStr=JSON.parse(adm.replace(/\\/g,''));if(admStr&&admStr.native){newBid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE;}}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Cannot parse native reponse for ad response: '+adm);}}}}
function _parseNativeResponse(bid,newBid){newBid.native={};if(bid.hasOwnProperty('adm')){var adm='';try{adm=JSON.parse(bid.adm.replace(/\\/g,''));}catch(ex){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: Cannot parse native reponse for ad response: '+newBid.adm);return;}
if(adm&&adm.native&&adm.native.assets&&adm.native.assets.length>0){newBid.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE;for(var i=0,len=adm.native.assets.length;i<len;i++){switch(adm.native.assets[i].id){case NATIVE_ASSETS.TITLE.ID:newBid.native.title=adm.native.assets[i].title&&adm.native.assets[i].title.text;break;case NATIVE_ASSETS.IMAGE.ID:newBid.native.image={url:adm.native.assets[i].img&&adm.native.assets[i].img.url,height:adm.native.assets[i].img&&adm.native.assets[i].img.h,width:adm.native.assets[i].img&&adm.native.assets[i].img.w};break;case NATIVE_ASSETS.ICON.ID:newBid.native.icon={url:adm.native.assets[i].img&&adm.native.assets[i].img.url,height:adm.native.assets[i].img&&adm.native.assets[i].img.h,width:adm.native.assets[i].img&&adm.native.assets[i].img.w};break;case NATIVE_ASSETS.SPONSOREDBY.ID:case NATIVE_ASSETS.BODY.ID:case NATIVE_ASSETS.LIKES.ID:case NATIVE_ASSETS.DOWNLOADS.ID:case NATIVE_ASSETS.PRICE:case NATIVE_ASSETS.SALEPRICE.ID:case NATIVE_ASSETS.PHONE.ID:case NATIVE_ASSETS.ADDRESS.ID:case NATIVE_ASSETS.DESC2.ID:case NATIVE_ASSETS.CTA.ID:case NATIVE_ASSETS.RATING.ID:case NATIVE_ASSETS.DISPLAYURL.ID:newBid.native[NATIVE_ASSET_ID_TO_KEY_MAP[adm.native.assets[i].id]]=adm.native.assets[i].data&&adm.native.assets[i].data.value;break;}}
newBid.native.clickUrl=adm.native.link&&adm.native.link.url;newBid.native.clickTrackers=adm.native.link&&adm.native.link.clicktrackers||[];newBid.native.impressionTrackers=adm.native.imptrackers||[];newBid.native.jstracker=adm.native.jstracker||[];if(!newBid.width){newBid.width=DEFAULT_WIDTH;}
if(!newBid.height){newBid.height=DEFAULT_HEIGHT;}}}}
function _blockedIabCategoriesValidation(payload,blockedIabCategories){blockedIabCategories=blockedIabCategories.filter(function(category){if(typeof category==='string'){return true;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'bcat: Each category should be a string, ignoring category: '+category);return false;}}).map(function(category){return category.trim();}).filter(function(category,index,arr){if(category.length>3){return arr.indexOf(category)===index;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'bcat: Each category should have a value of a length of more than 3 characters, ignoring category: '+category);}});if(blockedIabCategories.length>0){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'bcat: Selected: ',blockedIabCategories);payload.bcat=blockedIabCategories;}}
function _allowedIabCategoriesValidation(payload,allowedIabCategories){allowedIabCategories=allowedIabCategories.filter(function(category){if(typeof category==='string'){return true;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'acat: Each category should be a string, ignoring category: '+category);return false;}}).map(function(category){return category.trim();}).filter(function(category,index,arr){return arr.indexOf(category)===index;});if(allowedIabCategories.length>0){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'acat: Selected: ',allowedIabCategories);payload.ext.acat=allowedIabCategories;}}
function _assignRenderer(newBid,request){var bidParams,context,adUnitCode;if(request.bidderRequest&&request.bidderRequest.bids){for(var bidderRequestBidsIndex=0;bidderRequestBidsIndex<request.bidderRequest.bids.length;bidderRequestBidsIndex++){if(request.bidderRequest.bids[bidderRequestBidsIndex].bidId===newBid.requestId){bidParams=request.bidderRequest.bids[bidderRequestBidsIndex].params;context=request.bidderRequest.bids[bidderRequestBidsIndex].mediaTypes[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO].context;adUnitCode=request.bidderRequest.bids[bidderRequestBidsIndex].adUnitCode;}}
if(context&&context==='outstream'&&bidParams&&bidParams.outstreamAU&&adUnitCode){newBid.rendererCode=bidParams.outstreamAU;newBid.renderer=BB_RENDERER.newRenderer(newBid.rendererCode,adUnitCode);}}}
function isNonEmptyArray(test){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(test)===true){if(test.length>0){return true;}}
return false;}
var spec={code:BIDDER_CODE,gvlid:76,supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE],isBidRequestValid:function isBidRequestValid(bid){if(bid&&bid.params){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(bid.params.publisherId)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: publisherId is mandatory and cannot be numeric (wrap it in quotes in your config). Call to OpenBid will not be sent for ad unit: '+JSON.stringify(bid));return false;}
if(bid.hasOwnProperty('mediaTypes')&&bid.mediaTypes.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO)){var mediaTypesVideoMimes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid.mediaTypes,'video.mimes');var paramsVideoMimes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'params.video.mimes');if(isNonEmptyArray(mediaTypesVideoMimes)===false&&isNonEmptyArray(paramsVideoMimes)===false){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Error: For video ads, bid.mediaTypes.video.mimes OR bid.params.video.mimes should be present and must be a non-empty array. Call to OpenBid will not be sent for ad unit:'+JSON.stringify(bid));return false;}
if(!bid.mediaTypes[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO].hasOwnProperty('context')){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("".concat(LOG_WARN_PREFIX,": no context specified in bid. Rejecting bid: "),bid);return false;}
if(bid.mediaTypes[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO].context==='outstream'&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(bid.params.outstreamAU)&&!bid.hasOwnProperty('renderer')&&!bid.mediaTypes[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO].hasOwnProperty('renderer')){if(bid.mediaTypes.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER)||bid.mediaTypes.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE)){delete bid.mediaTypes[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO];(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("".concat(LOG_WARN_PREFIX,": for \"outstream\" bids either outstreamAU parameter must be provided or ad unit supplied renderer is required. Rejecting mediatype Video of bid: "),bid);return true;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("".concat(LOG_WARN_PREFIX,": for \"outstream\" bids either outstreamAU parameter must be provided or ad unit supplied renderer is required. Rejecting bid: "),bid);return false;}}}
return true;}
return false;},buildRequests:function buildRequests(validBidRequests,bidderRequest){var _commonFpd$ext,_commonFpd$ext$prebid,_commonFpd$ext$prebid2,_commonFpd$ext$prebid3;var refererInfo;if(bidderRequest&&bidderRequest.refererInfo){refererInfo=bidderRequest.refererInfo;}
var conf=_initConf(refererInfo);var payload=_createOrtbTemplate(conf);var bidCurrency='';var dctrArr=[];var bid;var blockedIabCategories=[];var allowedIabCategories=[];validBidRequests.forEach(function(originalBid){bid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.deepClone)(originalBid);bid.params.adSlot=bid.params.adSlot||'';_parseAdSlot(bid);if(bid.mediaTypes&&bid.mediaTypes.hasOwnProperty('video')||bid.params.hasOwnProperty('video')){}else{if(!(bid.hasOwnProperty('mediaTypes')&&bid.mediaTypes.hasOwnProperty(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE))&&bid.params.width===0&&bid.params.height===0){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Skipping the non-standard adslot: ',bid.params.adSlot,JSON.stringify(bid));return;}}
conf.pubId=conf.pubId||bid.params.publisherId;conf=_handleCustomParams(bid.params,conf);conf.transactionId=bid.transactionId;if(bidCurrency===''){bidCurrency=bid.params.currency||UNDEFINED;}else if(bid.params.hasOwnProperty('currency')&&bidCurrency!==bid.params.currency){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(LOG_WARN_PREFIX+'Currency specifier ignored. Only one currency permitted.');}
bid.params.currency=bidCurrency;if(bid.params.hasOwnProperty('dctr')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(bid.params.dctr)){dctrArr.push(bid.params.dctr);}
if(bid.params.hasOwnProperty('bcat')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bid.params.bcat)){blockedIabCategories=blockedIabCategories.concat(bid.params.bcat);}
if(bid.params.hasOwnProperty('acat')&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bid.params.acat)){allowedIabCategories=allowedIabCategories.concat(bid.params.acat);}
var impObj=_createImpressionObject(bid,conf);if(impObj){payload.imp.push(impObj);}});if(payload.imp.length==0){return;}
payload.site.publisher.id=conf.pubId.trim();publisherId=conf.pubId.trim();payload.ext.wrapper={};payload.ext.wrapper.profile=parseInt(conf.profId)||UNDEFINED;payload.ext.wrapper.version=parseInt(conf.verId)||UNDEFINED;payload.ext.wrapper.wiid=conf.wiid||bidderRequest.auctionId;payload.ext.wrapper.wv="prebid_prebid_6.24.1";payload.ext.wrapper.transactionId=conf.transactionId;payload.ext.wrapper.wp='pbjs';if(bidderRequest&&bidderRequest.bidderCode){payload.ext.allowAlternateBidderCodes=_src_bidderSettings_js__WEBPACK_IMPORTED_MODULE_6__.bidderSettings.get(bidderRequest.bidderCode,'allowAlternateBidderCodes');payload.ext.allowedAlternateBidderCodes=_src_bidderSettings_js__WEBPACK_IMPORTED_MODULE_6__.bidderSettings.get(bidderRequest.bidderCode,'allowedAlternateBidderCodes');}
payload.user.gender=conf.gender?conf.gender.trim():UNDEFINED;payload.user.geo={};payload.user.geo.lat=_parseSlotParam('lat',conf.lat);payload.user.geo.lon=_parseSlotParam('lon',conf.lon);payload.user.yob=_parseSlotParam('yob',conf.yob);payload.device.geo=payload.user.geo;payload.site.page=conf.kadpageurl.trim()||payload.site.page.trim();payload.site.domain=_getDomainFromURL(payload.site.page);if(_typeof(_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('content'))==='object'){payload.site.content=_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('content');}
if(_typeof(_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('device'))==='object'){payload.device=_extends(payload.device,_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('device'));}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'source.tid',conf.transactionId);if(window.location.href.indexOf('pubmaticTest=true')!==-1){payload.test=1;}
if(validBidRequests[0].schain){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'source.ext.schain',validBidRequests[0].schain);}
if(bidderRequest&&bidderRequest.gdprConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'user.ext.consent',bidderRequest.gdprConsent.consentString);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'regs.ext.gdpr',bidderRequest.gdprConsent.gdprApplies?1:0);}
if(bidderRequest&&bidderRequest.uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'regs.ext.us_privacy',bidderRequest.uspConsent);}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('coppa')===true){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_4__["default"])(payload,'regs.coppa',1);}
_handleEids(payload,validBidRequests);_handleFlocId(payload,validBidRequests);var commonFpd=_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('ortb2')||{};if(commonFpd.site){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(payload,{site:commonFpd.site});}
if(commonFpd.user){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.mergeDeep)(payload,{user:commonFpd.user});}
if(commonFpd.bcat){blockedIabCategories=blockedIabCategories.concat(commonFpd.bcat);}
if((_commonFpd$ext=commonFpd.ext)!==null&&_commonFpd$ext!==void 0&&(_commonFpd$ext$prebid=_commonFpd$ext.prebid)!==null&&_commonFpd$ext$prebid!==void 0&&(_commonFpd$ext$prebid2=_commonFpd$ext$prebid.bidderparams)!==null&&_commonFpd$ext$prebid2!==void 0&&(_commonFpd$ext$prebid3=_commonFpd$ext$prebid2[bidderRequest.bidderCode])!==null&&_commonFpd$ext$prebid3!==void 0&&_commonFpd$ext$prebid3.acat){var acatParams=commonFpd.ext.prebid.bidderparams[bidderRequest.bidderCode].acat;_allowedIabCategoriesValidation(payload,acatParams);}else if(allowedIabCategories.length){_allowedIabCategoriesValidation(payload,allowedIabCategories);}
_blockedIabCategoriesValidation(payload,blockedIabCategories);if(_typeof(_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('app'))==='object'){payload.app=_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('app');payload.app.publisher=payload.site.publisher;payload.app.ext=payload.site.ext||UNDEFINED;if(_typeof(payload.app.content)!=='object'){payload.app.content=payload.site.content||UNDEFINED;}
delete payload.site;}
return{method:'POST',url:ENDPOINT,data:JSON.stringify(payload),bidderRequest:bidderRequest};},interpretResponse:function interpretResponse(response,request){var bidResponses=[];var respCur=DEFAULT_CURRENCY;var parsedRequest=JSON.parse(request.data);var parsedReferrer=parsedRequest.site&&parsedRequest.site.ref?parsedRequest.site.ref:'';try{if(response.body&&response.body.seatbid&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(response.body.seatbid)){respCur=response.body.cur||respCur;response.body.seatbid.forEach(function(seatbidder){seatbidder.bid&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(seatbidder.bid)&&seatbidder.bid.forEach(function(bid){var newBid={requestId:bid.impid,cpm:(parseFloat(bid.price)||0).toFixed(2),width:bid.w,height:bid.h,creativeId:bid.crid||bid.id,dealId:bid.dealid,currency:respCur,netRevenue:NET_REVENUE,ttl:300,referrer:parsedReferrer,ad:bid.adm,pm_seat:seatbidder.seat||null,pm_dspid:bid.ext&&bid.ext.dspid?bid.ext.dspid:null,partnerImpId:bid.id||''};if(parsedRequest.imp&&parsedRequest.imp.length>0){parsedRequest.imp.forEach(function(req){if(bid.impid===req.id){_checkMediaType(bid,newBid);switch(newBid.mediaType){case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER:break;case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO:newBid.width=bid.hasOwnProperty('w')?bid.w:req.video.w;newBid.height=bid.hasOwnProperty('h')?bid.h:req.video.h;newBid.vastXml=bid.adm;_assignRenderer(newBid,request);break;case _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.NATIVE:_parseNativeResponse(bid,newBid);break;}}});}
if(bid.ext&&bid.ext.deal_channel){newBid['dealChannel']=dealChannelValues[bid.ext.deal_channel]||null;}
newBid.meta={};if(bid.ext&&bid.ext.dspid){newBid.meta.networkId=bid.ext.dspid;}
if(bid.ext&&bid.ext.advid){newBid.meta.buyerId=bid.ext.advid;}
if(bid.adomain&&bid.adomain.length>0){newBid.meta.advertiserDomains=bid.adomain;newBid.meta.clickUrl=bid.adomain[0];}
if(seatbidder.ext&&seatbidder.ext.buyid){newBid.adserverTargeting={'hb_buyid_pubmatic':seatbidder.ext.buyid};}
if(bid.ext&&!!bid.ext.marketplace){newBid.bidderCode=bid.ext.marketplace;}
bidResponses.push(newBid);});});}}catch(error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(error);}
return bidResponses;},getUserSyncs:function getUserSyncs(syncOptions,responses,gdprConsent,uspConsent){var syncurl=''+publisherId;if(gdprConsent){syncurl+='&gdpr='+(gdprConsent.gdprApplies?1:0);syncurl+='&gdpr_consent='+encodeURIComponent(gdprConsent.consentString||'');}
if(uspConsent){syncurl+='&us_privacy='+encodeURIComponent(uspConsent);}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_5__.config.getConfig('coppa')===true){syncurl+='&coppa=1';}
if(syncOptions.iframeEnabled){return[{type:'iframe',url:USER_SYNC_URL_IFRAME+syncurl}];}else{return[{type:'image',url:USER_SYNC_URL_IMAGE+syncurl}];}},transformBidParams:function transformBidParams(params,isOpenRtb,adUnit,bidRequests){_addJWPlayerSegmentData(params,adUnit.bids[0],true);return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.convertTypes)({'publisherId':'string','adSlot':'string'},params);}};(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_7__.registerBidder)(spec);window.pbjs.installedModules.push('pubmaticBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/pubmaticBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["rubiconBidAdapter"],{"./modules/rubiconBidAdapter.js":
/*!**************************************!*\
  !*** ./modules/rubiconBidAdapter.js ***!
  \**************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");var _src_Renderer_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../src/Renderer.js */
"./src/Renderer.js");var _src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/prebidGlobal.js */
"./src/prebidGlobal.js");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var DEFAULT_INTEGRATION='pbjs_lite';var DEFAULT_PBS_INTEGRATION='pbjs';var DEFAULT_RENDERER_URL='https://video-outstream.rubiconproject.com/apex-2.2.1.js';var rubiConf={};_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('rubicon',function(config){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.mergeDeep)(rubiConf,config.rubicon);});var GVLID=52;var sizeMap={1:'468x60',2:'728x90',5:'120x90',7:'125x125',8:'120x600',9:'160x600',10:'300x600',13:'200x200',14:'250x250',15:'300x250',16:'336x280',17:'240x400',19:'300x100',31:'980x120',32:'250x360',33:'180x500',35:'980x150',37:'468x400',38:'930x180',39:'750x100',40:'750x200',41:'750x300',42:'2x4',43:'320x50',44:'300x50',48:'300x300',53:'1024x768',54:'300x1050',55:'970x90',57:'970x250',58:'1000x90',59:'320x80',60:'320x150',61:'1000x1000',64:'580x500',65:'640x480',66:'930x600',67:'320x480',68:'1800x1000',72:'320x320',73:'320x160',78:'980x240',79:'980x300',80:'980x400',83:'480x300',85:'300x120',90:'548x150',94:'970x310',95:'970x100',96:'970x210',101:'480x320',102:'768x1024',103:'480x280',105:'250x800',108:'320x240',113:'1000x300',117:'320x100',125:'800x250',126:'200x600',144:'980x600',145:'980x150',152:'1000x250',156:'640x320',159:'320x250',179:'250x600',195:'600x300',198:'640x360',199:'640x200',213:'1030x590',214:'980x360',221:'1x1',229:'320x180',230:'2000x1400',232:'580x400',234:'6x6',251:'2x2',256:'480x820',257:'400x600',258:'500x200',259:'998x200',264:'970x1000',265:'1920x1080',274:'1800x200',278:'320x500',282:'320x400',288:'640x380',548:'500x1000',550:'980x480',552:'300x200',558:'640x640',562:'300x431',564:'320x431',566:'320x300',568:'300x150',570:'300x125',572:'250x350',574:'620x891',576:'610x877',578:'980x552',580:'505x656'};(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__._each)(sizeMap,function(item,key){return sizeMap[item]=key;});var spec={code:'rubicon',gvlid:GVLID,supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO],isBidRequestValid:function isBidRequestValid(bid){if(_typeof(bid.params)!=='object'){return false;}
for(var i=0,props=['accountId','siteId','zoneId'];i<props.length;i++){bid.params[props[i]]=parseInt(bid.params[props[i]]);if(isNaN(bid.params[props[i]])){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: wrong format of accountId or siteId or zoneId.');return false;}}
var bidFormat=bidType(bid,true);if(!bidFormat){return false;}else if(bidFormat==='video'){return hasValidVideoParams(bid);}
return true;},buildRequests:function buildRequests(bidRequests,bidderRequest){var requests=[];var videoRequests=bidRequests.filter(function(bidRequest){return bidType(bidRequest)==='video';}).map(function(bidRequest){bidRequest.startTime=new Date().getTime();var data={id:bidRequest.transactionId,test:_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('debug')?1:0,cur:['USD'],source:{tid:bidRequest.transactionId},tmax:bidderRequest.timeout,imp:[{exp:_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('s2sConfig.defaultTtl'),id:bidRequest.adUnitCode,secure:1,ext:_defineProperty({},bidRequest.bidder,bidRequest.params),video:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'mediaTypes.video')||{}}],ext:{prebid:{channel:{name:'pbjs',version:pbjs.version},cache:{vastxml:{returnCreative:rubiConf.returnVast===true}},targeting:{includewinners:true,includebidderkeys:false,pricegranularity:getPriceGranularity(_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config)},bidders:{rubicon:{integration:rubiConf.int_type||DEFAULT_PBS_INTEGRATION}}}}};if(bidRequest.bidder!=='rubicon'){data.ext.prebid.aliases=_defineProperty({},bidRequest.bidder,'rubicon');}
var modules=(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_4__.getGlobal)().installedModules;if(modules&&(!modules.length||modules.indexOf('rubiconAnalyticsAdapter')!==-1)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'ext.prebid.analytics',{'rubicon':{'client-analytics':true}});}
var bidFloor;if(typeof bidRequest.getFloor==='function'&&!rubiConf.disableFloors){var floorInfo;try{floorInfo=bidRequest.getFloor({currency:'USD',mediaType:'video',size:parseSizes(bidRequest,'video')});}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: getFloor threw an error: ',e);}
bidFloor=_typeof(floorInfo)==='object'&&floorInfo.currency==='USD'&&!isNaN(parseInt(floorInfo.floor))?parseFloat(floorInfo.floor):undefined;}else{bidFloor=parseFloat((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'params.floor'));}
if(!isNaN(bidFloor)){data.imp[0].bidfloor=bidFloor;}
if(_typeof(bidRequest.floorData)==='object'){data.ext.prebid.floors={enabled:false};}
data.imp[0].ext[bidRequest.bidder].video.size_id=determineRubiconVideoSizeId(bidRequest);appendSiteAppDevice(data,bidRequest,bidderRequest);addVideoParameters(data,bidRequest);if(bidderRequest.gdprConsent){var gdprApplies;if(typeof bidderRequest.gdprConsent.gdprApplies==='boolean'){gdprApplies=bidderRequest.gdprConsent.gdprApplies?1:0;}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'regs.ext.gdpr',gdprApplies);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'user.ext.consent',bidderRequest.gdprConsent.consentString);}
if(bidderRequest.uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'regs.ext.us_privacy',bidderRequest.uspConsent);}
var eids=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidderRequest,'bids.0.userIdAsEids');if(eids&&eids.length){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'user.ext.eids',eids);}
var configUserId=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('user.id');if(configUserId){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'user.id',configUserId);}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('coppa')===true){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'regs.coppa',1);}
if(bidRequest.schain&&hasValidSupplyChainParams(bidRequest.schain)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'source.ext.schain',bidRequest.schain);}
var multibid=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('multibid');if(multibid){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data,'ext.prebid.multibid',multibid.reduce(function(result,i){var obj={};Object.keys(i).forEach(function(key){obj[key.toLowerCase()]=i[key];});result.push(obj);return result;},[]));}
applyFPD(bidRequest,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,data);if(bidRequest.storedAuctionResponse){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data.imp[0],'ext.prebid.storedauctionresponse.id',bidRequest.storedAuctionResponse.toString());}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(data.imp[0],'ext.prebid.auctiontimestamp',bidderRequest.auctionStart);return{method:'POST',url:"https://".concat(rubiConf.videoHost||'prebid-server',".rubiconproject.com/openrtb2/auction"),data:data,bidRequest:bidRequest};});if(rubiConf.singleRequest!==true){requests=videoRequests.concat(bidRequests.filter(function(bidRequest){return bidType(bidRequest)==='banner';}).map(function(bidRequest){var bidParams=spec.createSlotParams(bidRequest,bidderRequest);return{method:'GET',url:"https://".concat(rubiConf.bannerHost||'fastlane',".rubiconproject.com/a/api/fastlane.json"),data:spec.getOrderedParams(bidParams).reduce(function(paramString,key){var propValue=bidParams[key];return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(propValue)&&propValue!==''||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isNumber)(propValue)?"".concat(paramString).concat(encodeParam(key,propValue),"&"):paramString;},'')+"slots=1&rand=".concat(Math.random()),bidRequest:bidRequest};}));}else{var nonVideoRequests=bidRequests.filter(function(bidRequest){return bidType(bidRequest)==='banner';});var groupedBidRequests=nonVideoRequests.reduce(function(groupedBids,bid){(groupedBids[bid.params['siteId']]=groupedBids[bid.params['siteId']]||[]).push(bid);return groupedBids;},{});var SRA_BID_LIMIT=10;requests=videoRequests.concat(Object.keys(groupedBidRequests).reduce(function(aggregate,bidGroupKey){partitionArray(groupedBidRequests[bidGroupKey],SRA_BID_LIMIT).forEach(function(bidsInGroup){var combinedSlotParams=spec.combineSlotUrlParams(bidsInGroup.map(function(bidRequest){return spec.createSlotParams(bidRequest,bidderRequest);}));aggregate.push({method:'GET',url:"https://".concat(rubiConf.bannerHost||'fastlane',".rubiconproject.com/a/api/fastlane.json"),data:spec.getOrderedParams(combinedSlotParams).reduce(function(paramString,key){var propValue=combinedSlotParams[key];return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(propValue)&&propValue!==''||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isNumber)(propValue)?"".concat(paramString).concat(encodeParam(key,propValue),"&"):paramString;},'')+"slots=".concat(bidsInGroup.length,"&rand=").concat(Math.random()),bidRequest:bidsInGroup});});return aggregate;},[]));}
return requests;},getOrderedParams:function getOrderedParams(params){var containsTgV=/^tg_v/;var containsTgI=/^tg_i/;var containsUId=/^eid_|^tpid_/;var orderedParams=['account_id','site_id','zone_id','size_id','alt_size_ids','p_pos','gdpr','gdpr_consent','us_privacy','rp_schain'].concat(Object.keys(params).filter(function(item){return containsUId.test(item);})).concat(['x_liverampidl','ppuid','rf','p_geo.latitude','p_geo.longitude','kw']).concat(Object.keys(params).filter(function(item){return containsTgV.test(item);})).concat(Object.keys(params).filter(function(item){return containsTgI.test(item);})).concat(['tk_flint','x_source.tid','l_pb_bid_id','x_source.pchain','p_screen_res','rp_floor','rp_secure','tk_user_key']);return orderedParams.concat(Object.keys(params).filter(function(item){return orderedParams.indexOf(item)===-1;}));},combineSlotUrlParams:function combineSlotUrlParams(aSlotUrlParams){if(aSlotUrlParams.length===1){return aSlotUrlParams[0];}
var oCombinedSlotUrlParams=aSlotUrlParams.reduce(function(oCombinedParams,oSlotUrlParams,iIndex){Object.keys(oSlotUrlParams).forEach(function(param){if(!oCombinedParams.hasOwnProperty(param)){oCombinedParams[param]=new Array(aSlotUrlParams.length);}
oCombinedParams[param].splice(iIndex,1,oSlotUrlParams[param]);});return oCombinedParams;},{});var re=new RegExp('^([^;]*)(;\\1)+$');Object.keys(oCombinedSlotUrlParams).forEach(function(param){var sValues=oCombinedSlotUrlParams[param].join(';');var match=sValues.match(re);oCombinedSlotUrlParams[param]=match?match[1]:sValues;});return oCombinedSlotUrlParams;},createSlotParams:function createSlotParams(bidRequest,bidderRequest){bidRequest.startTime=new Date().getTime();var params=bidRequest.params;var parsedSizes=parseSizes(bidRequest,'banner');var _ref=params.latLong||[],_ref2=_slicedToArray(_ref,2),latitude=_ref2[0],longitude=_ref2[1];var data={'account_id':params.accountId,'site_id':params.siteId,'zone_id':params.zoneId,'size_id':parsedSizes[0],'alt_size_ids':parsedSizes.slice(1).join(',')||undefined,'rp_floor':(params.floor=parseFloat(params.floor))>=0.01?params.floor:undefined,'rp_secure':'1','tk_flint':"".concat(rubiConf.int_type||DEFAULT_INTEGRATION,"_v6.24.1"),'x_source.tid':bidRequest.transactionId,'l_pb_bid_id':bidRequest.bidId,'x_source.pchain':params.pchain,'p_screen_res':_getScreenResolution(),'tk_user_key':params.userId,'p_geo.latitude':isNaN(parseFloat(latitude))?undefined:parseFloat(latitude).toFixed(4),'p_geo.longitude':isNaN(parseFloat(longitude))?undefined:parseFloat(longitude).toFixed(4),'tg_fl.eid':bidRequest.code,'rf':_getPageUrl(bidRequest,bidderRequest)};if(typeof bidRequest.getFloor==='function'&&!rubiConf.disableFloors){var floorInfo;try{floorInfo=bidRequest.getFloor({currency:'USD',mediaType:'banner',size:'*'});}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: getFloor threw an error: ',e);}
data['rp_hard_floor']=_typeof(floorInfo)==='object'&&floorInfo.currency==='USD'&&!isNaN(parseInt(floorInfo.floor))?floorInfo.floor:undefined;}
var posMapping={1:'atf',3:'btf'};var pos=posMapping[(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'mediaTypes.banner.pos')]||'';data['p_pos']=params.position==='atf'||params.position==='btf'?params.position:pos;var configUserId=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('user.id');if(configUserId){data['ppuid']=configUserId;}
if(bidRequest.userIdAsEids){bidRequest.userIdAsEids.forEach(function(eid){try{if(eid.source==='adserver.org'){data['tpid_tdid']=eid.uids[0].id;data['eid_adserver.org']=eid.uids[0].id;}else if(eid.source==='liveintent.com'){data['tpid_liveintent.com']=eid.uids[0].id;data['eid_liveintent.com']=eid.uids[0].id;if(eid.ext&&Array.isArray(eid.ext.segments)&&eid.ext.segments.length){data['tg_v.LIseg']=eid.ext.segments.join(',');}}else if(eid.source==='liveramp.com'){data['x_liverampidl']=eid.uids[0].id;}else if(eid.source==='id5-sync.com'){data['eid_id5-sync.com']="".concat(eid.uids[0].id,"^").concat(eid.uids[0].atype,"^").concat(eid.uids[0].ext&&eid.uids[0].ext.linkType||'');}else{data["eid_".concat(eid.source)]="".concat(eid.uids[0].id,"^").concat(eid.uids[0].atype||'');}
if(!data['ppuid']){var ppId=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_6__.find)(eid.uids,function(uid){return uid.ext&&uid.ext.stype==='ppuid';});if(ppId&&ppId.id){data['ppuid']=ppId.id;}}}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: error reading eid:',eid,e);}});}
if(bidderRequest.gdprConsent){if(typeof bidderRequest.gdprConsent.gdprApplies==='boolean'){data['gdpr']=Number(bidderRequest.gdprConsent.gdprApplies);}
data['gdpr_consent']=bidderRequest.gdprConsent.consentString;}
if(bidderRequest.uspConsent){data['us_privacy']=encodeURIComponent(bidderRequest.uspConsent);}
data['rp_maxbids']=bidderRequest.bidLimit||1;applyFPD(bidRequest,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER,data);if(_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('coppa')===true){data['coppa']=1;}
if(bidRequest.schain&&hasValidSupplyChainParams(bidRequest.schain)){data.rp_schain=spec.serializeSupplyChain(bidRequest.schain);}
return data;},serializeSupplyChain:function serializeSupplyChain(supplyChain){var supplyChainIsValid=hasValidSupplyChainParams(supplyChain);if(!supplyChainIsValid)return'';var ver=supplyChain.ver,complete=supplyChain.complete,nodes=supplyChain.nodes;return"".concat(ver,",").concat(complete,"!").concat(spec.serializeSupplyChainNodes(nodes));},serializeSupplyChainNodes:function serializeSupplyChainNodes(nodes){var nodePropOrder=['asi','sid','hp','rid','name','domain'];return nodes.map(function(node){return nodePropOrder.map(function(prop){return encodeURIComponent(node[prop]||'');}).join(',');}).join('!');},interpretResponse:function interpretResponse(responseObj,_ref3){var bidRequest=_ref3.bidRequest;responseObj=responseObj.body;if(!responseObj||_typeof(responseObj)!=='object'){return[];}
if(responseObj.seatbid){var responseErrors=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(responseObj,'ext.errors.rubicon');if(Array.isArray(responseErrors)&&responseErrors.length>0){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: Error in video response');}
var bids=[];responseObj.seatbid.forEach(function(seatbid){(seatbid.bid||[]).forEach(function(bid){var bidObject={requestId:bidRequest.bidId,currency:responseObj.cur||'USD',creativeId:bid.crid,cpm:bid.price||0,bidderCode:seatbid.seat,ttl:300,netRevenue:rubiConf.netRevenue!==false,width:bid.w||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'mediaTypes.video.w')||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'params.video.playerWidth'),height:bid.h||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'mediaTypes.video.h')||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'params.video.playerHeight')};if(bid.id){bidObject.seatBidId=bid.id;}
if(bid.dealid){bidObject.dealId=bid.dealid;}
if(bid.adomain){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidObject,'meta.advertiserDomains',Array.isArray(bid.adomain)?bid.adomain:[bid.adomain]);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'ext.bidder.rp.advid')){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidObject,'meta.advertiserId',bid.ext.bidder.rp.advid);}
var serverResponseTimeMs=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(responseObj,'ext.responsetimemillis.rubicon');if(bidRequest&&serverResponseTimeMs){bidRequest.serverResponseTimeMs=serverResponseTimeMs;}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'ext.prebid.type')===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO){bidObject.mediaType=_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(bidObject,'meta.mediaType',_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO);var extPrebidTargeting=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'ext.prebid.targeting');if(extPrebidTargeting&&_typeof(extPrebidTargeting)==='object'){bidObject.adserverTargeting=extPrebidTargeting;}
if(bid.ext.prebid.cache&&_typeof(bid.ext.prebid.cache.vastXml)==='object'&&bid.ext.prebid.cache.vastXml.cacheId&&bid.ext.prebid.cache.vastXml.url){bidObject.videoCacheKey=bid.ext.prebid.cache.vastXml.cacheId;bidObject.vastUrl=bid.ext.prebid.cache.vastXml.url;}else if(extPrebidTargeting&&extPrebidTargeting.hb_uuid&&extPrebidTargeting.hb_cache_host&&extPrebidTargeting.hb_cache_path){bidObject.videoCacheKey=extPrebidTargeting.hb_uuid;bidObject.vastUrl="https://".concat(extPrebidTargeting.hb_cache_host).concat(extPrebidTargeting.hb_cache_path,"?uuid=").concat(extPrebidTargeting.hb_uuid);}
if(bid.adm){bidObject.vastXml=bid.adm;}
if(bid.nurl){bidObject.vastUrl=bid.nurl;}
if(!bidObject.vastUrl&&bid.nurl){bidObject.vastUrl=bid.nurl;}
var videoContext=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'mediaTypes.video.context');if(videoContext.toLowerCase()==='outstream'){bidObject.renderer=outstreamRenderer(bidObject);}}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: video response received non-video media type');}
bids.push(bidObject);});});return bids;}
var ads=responseObj.ads;var lastImpId;var multibid=0;if(_typeof(bidRequest)==='object'&&!Array.isArray(bidRequest)&&bidType(bidRequest)==='video'&&_typeof(ads)==='object'){ads=ads[bidRequest.adUnitCode];}
if(!Array.isArray(ads)||ads.length<1){return[];}
return ads.reduce(function(bids,ad,i){ad.impression_id&&lastImpId===ad.impression_id?multibid++:lastImpId=ad.impression_id;if(ad.status!=='ok'){return bids;}
var associatedBidRequest=Array.isArray(bidRequest)?bidRequest[i-multibid]:bidRequest;if(associatedBidRequest&&_typeof(associatedBidRequest)==='object'){var bid={requestId:associatedBidRequest.bidId,currency:'USD',creativeId:ad.creative_id||"".concat(ad.network||'',"-").concat(ad.advertiser||''),cpm:ad.cpm||0,dealId:ad.deal,ttl:300,netRevenue:rubiConf.netRevenue!==false,rubicon:{advertiserId:ad.advertiser,networkId:ad.network},meta:{advertiserId:ad.advertiser,networkId:ad.network,mediaType:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER}};if(ad.creative_type){bid.mediaType=ad.creative_type;}
if(ad.adomain){bid.meta.advertiserDomains=Array.isArray(ad.adomain)?ad.adomain:[ad.adomain];}
if(ad.creative_type===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO){bid.width=associatedBidRequest.params.video.playerWidth;bid.height=associatedBidRequest.params.video.playerHeight;bid.vastUrl=ad.creative_depot_url;bid.impression_id=ad.impression_id;bid.videoCacheKey=ad.impression_id;}else{bid.ad=_renderCreative(ad.script,ad.impression_id);var _sizeMap$ad$size_id$s=sizeMap[ad.size_id].split('x').map(function(num){return Number(num);});var _sizeMap$ad$size_id$s2=_slicedToArray(_sizeMap$ad$size_id$s,2);bid.width=_sizeMap$ad$size_id$s2[0];bid.height=_sizeMap$ad$size_id$s2[1];}
bid.rubiconTargeting=(Array.isArray(ad.targeting)?ad.targeting:[]).reduce(function(memo,item){memo[item.key]=item.values[0];return memo;},{'rpfl_elemid':associatedBidRequest.adUnitCode});bids.push(bid);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Rubicon: bidRequest undefined at index position:".concat(i),bidRequest,responseObj);}
return bids;},[]).sort(function(adA,adB){return(adB.cpm||0.0)-(adA.cpm||0.0);});},getUserSyncs:function getUserSyncs(syncOptions,responses,gdprConsent,uspConsent){if(!hasSynced&&syncOptions.iframeEnabled){var params={};if(gdprConsent){if(typeof gdprConsent.gdprApplies==='boolean'){params['gdpr']=Number(gdprConsent.gdprApplies);}
if(typeof gdprConsent.consentString==='string'){params['gdpr_consent']=gdprConsent.consentString;}}
if(uspConsent){params['us_privacy']=encodeURIComponent(uspConsent);}
params=Object.keys(params).length?"?".concat((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.formatQS)(params)):'';hasSynced=true;return{type:'iframe',url:"https://".concat(rubiConf.syncHost||'eus',".rubiconproject.com/usync.html")+params};}},transformBidParams:function transformBidParams(params,isOpenRtb){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.convertTypes)({'accountId':'number','siteId':'number','zoneId':'number'},params);}};function _getScreenResolution(){return[window.screen.width,window.screen.height].join('x');}
function _getPageUrl(bidRequest,bidderRequest){var pageUrl=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('pageUrl');if(bidRequest.params.referrer){pageUrl=bidRequest.params.referrer;}else if(!pageUrl){pageUrl=bidderRequest.refererInfo.referer;}
return bidRequest.params.secure?pageUrl.replace(/^http:/i,'https:'):pageUrl;}
function _renderCreative(script,impId){return"<html>\n<head><script type='text/javascript'>inDapIF=true;</script></head>\n<body style='margin : 0; padding: 0;'>\n<!-- Rubicon Project Ad Tag -->\n<div data-rp-impression-id='".concat(impId,"'>\n<script type='text/javascript'>").concat(script,"</script>\n</div>\n</body>\n</html>");}
function hideGoogleAdsDiv(adUnit){var el=adUnit.querySelector("div[id^='google_ads']");if(el){el.style.setProperty('display','none');}}
function hideSmartAdServerIframe(adUnit){var el=adUnit.querySelector("script[id^='sas_script']");var nextSibling=el&&el.nextSibling;if(nextSibling&&nextSibling.localName==='iframe'){nextSibling.style.setProperty('display','none');}}
function renderBid(bid){var adUnitElement=document.getElementById(bid.adUnitCode);hideGoogleAdsDiv(adUnitElement);hideSmartAdServerIframe(adUnitElement);var config=bid.renderer.getConfig();bid.renderer.push(function(){window.MagniteApex.renderAd({width:bid.width,height:bid.height,vastUrl:bid.vastUrl,placement:{attachTo:adUnitElement,align:config.align||'center',position:config.position||'append'},closeButton:config.closeButton||false,label:config.label||undefined,collapse:config.collapse||true});});}
function outstreamRenderer(rtbBid){var renderer=_src_Renderer_js__WEBPACK_IMPORTED_MODULE_7__.Renderer.install({id:rtbBid.adId,url:rubiConf.rendererUrl||DEFAULT_RENDERER_URL,config:rubiConf.rendererConfig||{},loaded:false,adUnitCode:rtbBid.adUnitCode});try{renderer.setRender(renderBid);}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Prebid Error calling setRender on renderer',err);}
return renderer;}
function parseSizes(bid,mediaType){var params=bid.params;if(mediaType==='video'){var size=[];if(params.video&&params.video.playerWidth&&params.video.playerHeight){size=[params.video.playerWidth,params.video.playerHeight];}else if(Array.isArray((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.video.playerSize'))&&bid.mediaTypes.video.playerSize.length===1){size=bid.mediaTypes.video.playerSize[0];}else if(Array.isArray(bid.sizes)&&bid.sizes.length>0&&Array.isArray(bid.sizes[0])&&bid.sizes[0].length>1){size=bid.sizes[0];}
return size;}
var sizes=[];if(Array.isArray(params.sizes)){sizes=params.sizes;}else if(typeof(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.banner.sizes')!=='undefined'){sizes=mapSizes(bid.mediaTypes.banner.sizes);}else if(Array.isArray(bid.sizes)&&bid.sizes.length>0){sizes=mapSizes(bid.sizes);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: no sizes are setup or found');}
return masSizeOrdering(sizes);}
function appendSiteAppDevice(data,bidRequest,bidderRequest){if(!data)return;if(_typeof(_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('app'))==='object'){data.app=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('app');}else{data.site={page:_getPageUrl(bidRequest,bidderRequest)};}
if(_typeof(_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('device'))==='object'){data.device=_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('device');}
if(bidRequest.params.video.language){['site','device'].forEach(function(param){if(data[param]){if(param==='site'){data[param].content=_extends({language:bidRequest.params.video.language},data[param].content);}else{data[param]=_extends({language:bidRequest.params.video.language},data[param]);}}});}}
function addVideoParameters(data,bidRequest){if(_typeof(data.imp[0].video)==='object'&&data.imp[0].video.skip===undefined){data.imp[0].video.skip=bidRequest.params.video.skip;}
if(_typeof(data.imp[0].video)==='object'&&data.imp[0].video.skipafter===undefined){data.imp[0].video.skipafter=bidRequest.params.video.skipdelay;}
if(_typeof(data.imp[0].video)==='object'&&data.imp[0].video.pos===undefined){if(bidRequest.params.position==='atf'){data.imp[0].video.pos=1;}else if(bidRequest.params.position==='btf'){data.imp[0].video.pos=3;}}
var size=parseSizes(bidRequest,'video');data.imp[0].video.w=size[0];data.imp[0].video.h=size[1];}
function applyFPD(bidRequest,mediaType,data){var BID_FPD={user:{ext:{data:_objectSpread({},bidRequest.params.visitor)}},site:{ext:{data:_objectSpread({},bidRequest.params.inventory)}}};if(bidRequest.params.keywords)BID_FPD.site.keywords=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(bidRequest.params.keywords)?bidRequest.params.keywords.join(','):bidRequest.params.keywords;var fpd=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.mergeDeep)({},_src_config_js__WEBPACK_IMPORTED_MODULE_0__.config.getConfig('ortb2')||{},BID_FPD);var impData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest.ortb2Imp,'ext.data')||{};var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'ortb2Imp.ext.gpid');var SEGTAX={user:[4],site:[1,2,5,6]};var MAP={user:'tg_v.',site:'tg_i.',adserver:'tg_i.dfp_ad_unit_code',pbadslot:'tg_i.pbadslot',keywords:'kw'};var validate=function validate(prop,key,parentName){if(key==='data'&&Array.isArray(prop)){return prop.filter(function(name){return name.segment&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(name,'ext.segtax')&&SEGTAX[parentName]&&SEGTAX[parentName].indexOf((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(name,'ext.segtax'))!==-1;}).map(function(value){var segments=value.segment.filter(function(obj){return obj.id;}).reduce(function(result,obj){result.push(obj.id);return result;},[]);if(segments.length>0)return segments.toString();}).toString();}else if(_typeof(prop)==='object'&&!Array.isArray(prop)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: Filtered FPD key: ',key,': Expected value to be string, integer, or an array of strings/ints');}else if(typeof prop!=='undefined'){return Array.isArray(prop)?prop.filter(function(value){if(_typeof(value)!=='object'&&typeof value!=='undefined')return value.toString();(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)('Rubicon: Filtered value: ',value,'for key',key,': Expected value to be string, integer, or an array of strings/ints');}).toString():prop.toString();}};var addBannerData=function addBannerData(obj,name,key){var isParent=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var val=validate(obj,key,name);var loc=MAP[key]&&isParent?"".concat(MAP[key]):key==='data'?"".concat(MAP[name],"iab"):"".concat(MAP[name]).concat(key);data[loc]=data[loc]?data[loc].concat(',',val):val;};if(mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.BANNER){['site','user'].forEach(function(name){Object.keys(fpd[name]).forEach(function(key){if(name==='site'&&key==='content'&&fpd[name][key].data){addBannerData(fpd[name][key].data,name,'data');}else if(key!=='ext'){addBannerData(fpd[name][key],name,key);}else if(fpd[name][key].data){Object.keys(fpd[name].ext.data).forEach(function(key){addBannerData(fpd[name].ext.data[key],name,key,false);});}});});Object.keys(impData).forEach(function(key){if(key!=='adserver'){addBannerData(impData[key],'site',key);}else if(impData[key].name==='gam'){addBannerData(impData[key].adslot,name,key);}});if(gpid){data['p_gpid']=gpid;}
if(data['tg_i.pbadslot']){delete data['tg_i.dfp_ad_unit_code'];}}else{if(Object.keys(impData).length){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.mergeDeep)(data.imp[0].ext,{data:impData});}
if(gpid){data.imp[0].ext.gpid=gpid;}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.mergeDeep)(data,fpd);}}
function mapSizes(sizes){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.parseSizesInput)(sizes).reduce(function(result,size){var mappedSize=parseInt(sizeMap[size],10);if(mappedSize){result.push(mappedSize);}
return result;},[]);}
function hasVideoMediaType(bidRequest){if(_typeof((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'params.video'))!=='object'){return false;}
return typeof(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,"mediaTypes.".concat(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO))!=='undefined';}
function bidType(bid){var log=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(hasVideoMediaType(bid)){if(['outstream','instream'].indexOf((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,"mediaTypes.".concat(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,".context")))===-1){if(log){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: mediaTypes.video.context must be outstream or instream');}
return;}
if(parseSizes(bid,'video').length<2){if(log){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: could not determine the playerSize of the video');}
return;}
if(log){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)('Rubicon: making video request for adUnit',bid.adUnitCode);}
return'video';}else{if(parseSizes(bid,'banner').length===0){if(log){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: could not determine the sizes for banner request');}
return;}
if(log){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)('Rubicon: making banner request for adUnit',bid.adUnitCode);}
return'banner';}}
var resetRubiConf=function resetRubiConf(){return rubiConf={};};function masSizeOrdering(sizes){var MAS_SIZE_PRIORITY=[15,2,9];return sizes.sort(function(first,second){var firstPriority=MAS_SIZE_PRIORITY.indexOf(first);var secondPriority=MAS_SIZE_PRIORITY.indexOf(second);if(firstPriority>-1||secondPriority>-1){if(firstPriority===-1){return 1;}
if(secondPriority===-1){return-1;}
return firstPriority-secondPriority;}
return first-second;});}
function determineRubiconVideoSizeId(bid){var rubiconSizeId=parseInt((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'params.video.size_id'));if(!isNaN(rubiconSizeId)){return rubiconSizeId;}
return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,"mediaTypes.".concat(_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_2__.VIDEO,".context"))==='outstream'?203:201;}
function getPriceGranularity(config){return{ranges:{low:[{max:5.00,increment:0.50}],medium:[{max:20.00,increment:0.10}],high:[{max:20.00,increment:0.01}],auto:[{max:5.00,increment:0.05},{min:5.00,max:10.00,increment:0.10},{min:10.00,max:20.00,increment:0.50}],dense:[{max:3.00,increment:0.01},{min:3.00,max:8.00,increment:0.05},{min:8.00,max:20.00,increment:0.50}],custom:config.getConfig('customPriceBucket')&&config.getConfig('customPriceBucket').buckets}[config.getConfig('priceGranularity')]};}
function hasValidVideoParams(bid){var isValid=true;var arrayType=Object.prototype.toString.call([]);var numberType=Object.prototype.toString.call(0);var requiredParams={mimes:arrayType,protocols:arrayType,linearity:numberType,api:arrayType};Object.keys(requiredParams).forEach(function(param){if(Object.prototype.toString.call((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.video.'+param))!==requiredParams[param]){isValid=false;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: mediaTypes.video.'+param+' is required and must be of type: '+requiredParams[param]);}});return isValid;}
function hasValidSupplyChainParams(schain){var isValid=false;var requiredFields=['asi','sid','hp'];if(!schain.nodes)return isValid;isValid=schain.nodes.reduce(function(status,node){if(!status)return status;return requiredFields.every(function(field){return node.hasOwnProperty(field);});},true);if(!isValid)(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Rubicon: required schain params missing');return isValid;}
function encodeParam(key,param){if(key==='rp_schain')return"rp_schain=".concat(param);return"".concat(key,"=").concat(encodeURIComponent(param));}
function partitionArray(array,size){return array.map(function(e,i){return i%size===0?array.slice(i,i+size):null;}).filter(function(e){return e;});}
var hasSynced=false;function resetUserSync(){hasSynced=false;}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_8__.registerBidder)(spec);window.pbjs.installedModules.push('rubiconBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/rubiconBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["schain"],{"./modules/schain.js":
/*!***************************!*\
  !*** ./modules/schain.js ***!
  \***************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_config_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/adapterManager.js */
"./src/adapterManager.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var schainErrorPrefix='Invalid schain object found: ';var shouldBeAString=' should be a string';var shouldBeAnInteger=' should be an Integer';var shouldBeAnObject=' should be an object';var shouldBeAnArray=' should be an Array';var MODE={STRICT:'strict',RELAXED:'relaxed',OFF:'off'};var MODES=[];(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(MODE,function(mode){return MODES.push(mode);});function isSchainObjectValid(schainObject,returnOnError){var failPrefix='Detected something wrong within an schain config:';var failMsg='';function appendFailMsg(msg){failMsg+='\n'+msg;}
function printFailMsg(){if(returnOnError===true){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(failPrefix,schainObject,failMsg);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)(failPrefix,schainObject,failMsg);}}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(schainObject)){appendFailMsg("schain.config"+shouldBeAnObject);printFailMsg();if(returnOnError)return false;}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(schainObject.complete)||!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(schainObject.complete)){appendFailMsg("schain.config.complete"+shouldBeAnInteger);}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(schainObject.ver)){appendFailMsg("schain.config.ver"+shouldBeAString);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(schainObject,'ext')){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(schainObject.ext)){appendFailMsg("schain.config.ext"+shouldBeAnObject);}}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(schainObject.nodes)){appendFailMsg("schain.config.nodes"+shouldBeAnArray);printFailMsg();if(returnOnError)return false;}else{schainObject.nodes.forEach(function(node,index){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(node.asi)){appendFailMsg("schain.config.nodes[".concat(index,"].asi")+shouldBeAString);}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(node.sid)){appendFailMsg("schain.config.nodes[".concat(index,"].sid")+shouldBeAString);}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(node.hp)||!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(node.hp)){appendFailMsg("schain.config.nodes[".concat(index,"].hp")+shouldBeAnInteger);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(node,'rid')){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(node.rid)){appendFailMsg("schain.config.nodes[".concat(index,"].rid")+shouldBeAString);}}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(node,'name')){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(node.name)){appendFailMsg("schain.config.nodes[".concat(index,"].name")+shouldBeAString);}}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(node,'domain')){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(node.domain)){appendFailMsg("schain.config.nodes[".concat(index,"].domain")+shouldBeAString);}}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(node,'ext')){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(node.ext)){appendFailMsg("schain.config.nodes[".concat(index,"].ext")+shouldBeAnObject);}}});}
if(failMsg.length>0){printFailMsg();if(returnOnError){return false;}}
return true;}
function isValidSchainConfig(schainObject){if(schainObject===undefined){return false;}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(schainObject)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(schainErrorPrefix+'the following schain config will not be used as schain is not an object.',schainObject);return false;}
return true;}
function resolveSchainConfig(schainObject,bidder){var mode=MODE.STRICT;if(isValidSchainConfig(schainObject)){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(schainObject.validation)&&MODES.indexOf(schainObject.validation)!=-1){mode=schainObject.validation;}
if(mode===MODE.OFF){return schainObject.config;}else{if(isSchainObjectValid(schainObject.config,!!(mode===MODE.STRICT))){return schainObject.config;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(schainErrorPrefix+"due to the 'strict' validation setting, this schain config will not be passed to bidder '".concat(bidder,"'.  See above error for details."));}}}
return null;}
function makeBidRequestsHook(fn,bidderRequests){function getSchainForBidder(bidder){var bidderSchain=bidderConfigs[bidder]&&bidderConfigs[bidder].schain;return bidderSchain||globalSchainConfig;}
var globalSchainConfig=_src_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('schain');var bidderConfigs=_src_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getBidderConfig();bidderRequests.forEach(function(bidderRequest){var bidder=bidderRequest.bidderCode;var schainConfig=getSchainForBidder(bidder);bidderRequest.bids.forEach(function(bid){var result=resolveSchainConfig(schainConfig,bidder);if(result){bid.schain=result;}});});fn(bidderRequests);}
function init(){_src_adapterManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].makeBidRequests.after(makeBidRequestsHook);}
init();window.pbjs.installedModules.push('schain');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/schain.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["sharethroughBidAdapter"],{"./modules/sharethroughBidAdapter.js":
/*!*******************************************!*\
  !*** ./modules/sharethroughBidAdapter.js ***!
  \*******************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _userId_eids_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./userId/eids.js */
"./modules/userId/eids.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var VERSION='4.1.0';var BIDDER_CODE='sharethrough';var SUPPLY_ID='WYu2BXv1';var STR_ENDPOINT="https://btlr.sharethrough.com/universal/v1?supply_id=".concat(SUPPLY_ID);var sharethroughInternal={getProtocol:getProtocol};var sharethroughAdapterSpec={code:BIDDER_CODE,supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER],gvlid:80,isBidRequestValid:function isBidRequestValid(bid){return!!bid.params.pkey&&bid.bidder===BIDDER_CODE;},buildRequests:function buildRequests(bidRequests,bidderRequest){var timeout=_src_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('bidderTimeout');var firstPartyData=_src_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('ortb2')||{};var nonHttp=sharethroughInternal.getProtocol().indexOf('http')<0;var secure=nonHttp||sharethroughInternal.getProtocol().indexOf('https')>-1;var req={id:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.generateUUID)(),at:1,cur:['USD'],tmax:timeout,site:_objectSpread({domain:window.location.hostname,page:window.location.href,ref:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidderRequest,'refererInfo.referer')},firstPartyData.site),device:{ua:navigator.userAgent,language:navigator.language,js:1,dnt:navigator.doNotTrack==='1'?1:0,h:window.screen.height,w:window.screen.width},regs:{coppa:_src_config_js__WEBPACK_IMPORTED_MODULE_1__.config.getConfig('coppa')===true?1:0,ext:{}},source:{ext:{version:"6.24.1",str:VERSION,schain:bidRequests[0].schain}},bcat:bidRequests[0].params.bcat||[],badv:bidRequests[0].params.badv||[],test:0};req.user=nullish(firstPartyData.user,{});if(!req.user.ext)req.user.ext={};req.user.ext.eids=userIdAsEids(bidRequests[0]);if(bidderRequest.gdprConsent){var gdprApplies=bidderRequest.gdprConsent.gdprApplies===true;req.regs.ext.gdpr=gdprApplies?1:0;if(gdprApplies){req.user.ext.consent=bidderRequest.gdprConsent.consentString;}}
if(bidderRequest.uspConsent){req.regs.ext.us_privacy=bidderRequest.uspConsent;}
var imps=bidRequests.map(function(bidReq){var impression={};var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidReq,'ortb2Imp.ext.data.pbadslot');if(gpid){impression.ext={gpid:gpid};}
var videoRequest=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidReq,'mediaTypes.video');if(videoRequest){var w=640,h=360;if(videoRequest.playerSize&&videoRequest.playerSize[0]&&videoRequest.playerSize[1]){var _videoRequest$playerS=_slicedToArray(videoRequest.playerSize,2);w=_videoRequest$playerS[0];h=_videoRequest$playerS[1];}
impression.video={pos:nullish(videoRequest.pos,0),topframe:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.inIframe)()?0:1,skip:nullish(videoRequest.skip,0),linearity:nullish(videoRequest.linearity,1),minduration:nullish(videoRequest.minduration,5),maxduration:nullish(videoRequest.maxduration,60),playbackmethod:videoRequest.playbackmethod||[2],api:getVideoApi(videoRequest),mimes:videoRequest.mimes||['video/mp4'],protocols:getVideoProtocols(videoRequest),w:w,h:h,startdelay:nullish(videoRequest.startdelay,0),skipmin:nullish(videoRequest.skipmin,0),skipafter:nullish(videoRequest.skipafter,0),placement:videoRequest.context==='instream'?1:+(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(videoRequest,'placement',4)};if(videoRequest.delivery)impression.video.delivery=videoRequest.delivery;if(videoRequest.companiontype)impression.video.companiontype=videoRequest.companiontype;if(videoRequest.companionad)impression.video.companionad=videoRequest.companionad;}else{impression.banner={pos:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidReq,'mediaTypes.banner.pos',0),topframe:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__.inIframe)()?0:1,format:bidReq.sizes.map(function(size){return{w:+size[0],h:+size[1]};})};}
return _objectSpread({id:bidReq.bidId,tagid:String(bidReq.params.pkey),secure:secure?1:0,bidfloor:getBidRequestFloor(bidReq)},impression);}).filter(function(imp){return!!imp;});return imps.map(function(impression){return{method:'POST',url:STR_ENDPOINT,data:_objectSpread(_objectSpread({},req),{},{imp:[impression]})};});},interpretResponse:function interpretResponse(_ref,req){var body=_ref.body;if(!body||!body.seatbid||body.seatbid.length===0||!body.seatbid[0].bid||body.seatbid[0].bid.length===0){return[];}
return body.seatbid[0].bid.map(function(bid){var response={requestId:bid.impid,width:+bid.w,height:+bid.h,cpm:+bid.price,creativeId:bid.crid,dealId:bid.dealid||null,mediaType:req.data.imp[0].video?_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER,currency:body.cur||'USD',netRevenue:true,ttl:360,ad:bid.adm,nurl:bid.nurl,meta:{advertiserDomains:bid.adomain||[]}};if(response.mediaType===_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO){response.ttl=3600;response.vastXml=bid.adm;}
return response;});},getUserSyncs:function getUserSyncs(syncOptions,serverResponses,gdprConsent,uspConsent){var syncParams=uspConsent?"&us_privacy=".concat(uspConsent):'';var syncs=[];var shouldCookieSync=syncOptions.pixelEnabled&&serverResponses.length>0&&serverResponses[0].body&&serverResponses[0].body.cookieSyncUrls;if(shouldCookieSync){serverResponses[0].body.cookieSyncUrls.forEach(function(url){syncs.push({type:'image',url:url+syncParams});});}
return syncs;},onTimeout:function onTimeout(data){},onBidWon:function onBidWon(bid){},onSetTargeting:function onSetTargeting(bid){}};function getVideoApi(_ref2){var api=_ref2.api;var defaultValue=[2];if(api&&Array.isArray(api)&&api.length>0){return api;}else{return defaultValue;}}
function getVideoProtocols(_ref3){var protocols=_ref3.protocols;var defaultValue=[2,3,5,6,7,8];if(protocols&&Array.isArray(protocols)&&protocols.length>0){return protocols;}else{return defaultValue;}}
function getBidRequestFloor(bid){var floor=null;if(typeof bid.getFloor==='function'){var floorInfo=bid.getFloor({currency:'USD',mediaType:bid.mediaTypes&&bid.mediaTypes.video?'video':'banner',size:bid.sizes.map(function(size){return{w:size[0],h:size[1]};})});if(_typeof(floorInfo)==='object'&&floorInfo.currency==='USD'&&!isNaN(parseFloat(floorInfo.floor))){floor=parseFloat(floorInfo.floor);}}
return floor!==null?floor:bid.params.floor;}
function userIdAsEids(bidRequest){var eids=(0,_userId_eids_js__WEBPACK_IMPORTED_MODULE_4__.createEidsArray)((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'userId'))||[];var flocData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bidRequest,'userId.flocId');var isFlocIdValid=flocData&&flocData.id&&flocData.version;if(isFlocIdValid){eids.push({source:'chrome.com',uids:[{id:flocData.id,atype:1,ext:{ver:flocData.version}}]});}
return eids;}
function getProtocol(){return window.location.protocol;}
function nullish(input,def){return input===null||input===undefined?def:input;}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_5__.registerBidder)(sharethroughAdapterSpec);window.pbjs.installedModules.push('sharethroughBidAdapter');}),"./modules/userId/eids.js":
/*!********************************!*\
  !*** ./modules/userId/eids.js ***!
  \********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{"USER_IDS_CONFIG":function(){return USER_IDS_CONFIG;},"buildEidPermissions":function(){return buildEidPermissions;},"createEidsArray":function(){return createEidsArray;}});var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../../src/utils.js */
"./node_modules/dlv/index.js");var USER_IDS_CONFIG={'trustpid':{source:'trustpid.com',atype:1,getValue:function getValue(data){return data;}},'intentIqId':{source:'intentiq.com',atype:1},'naveggId':{source:'navegg.com',atype:1},'justId':{source:'justtag.com',atype:1},'pubcid':{source:'pubcid.org',atype:1},'tdid':{source:'adserver.org',atype:1,getUidExt:function getUidExt(){return{rtiPartner:'TDID'};}},'id5id':{getValue:function getValue(data){return data.uid;},source:'id5-sync.com',atype:1,getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'ftrackId':{source:'flashtalking.com',atype:1,getValue:function getValue(data){return data.uid;},getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'parrableId':{source:'parrable.com',atype:1,getValue:function getValue(parrableId){if(parrableId.eid){return parrableId.eid;}
if(parrableId.ccpaOptout){return'';}
return null;},getUidExt:function getUidExt(parrableId){var extendedData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.pick)(parrableId,['ibaOptout','ccpaOptout']);if(Object.keys(extendedData).length){return extendedData;}}},'idl_env':{source:'liveramp.com',atype:3},'lipb':{getValue:function getValue(data){return data.lipbid;},source:'liveintent.com',atype:3,getEidExt:function getEidExt(data){if(Array.isArray(data.segments)&&data.segments.length){return{segments:data.segments};}}},'britepoolid':{source:'britepool.com',atype:3},'dmdId':{source:'hcn.health',atype:3},lotamePanoramaId:{source:'crwdcntrl.net',atype:1},'criteoId':{source:'criteo.com',atype:1},'merkleId':{source:'merkleinc.com',atype:3,getValue:function getValue(data){return data.id;},getUidExt:function getUidExt(data){return data&&data.keyID?{keyID:data.keyID}:undefined;}},'netId':{source:'netid.de',atype:1},'IDP':{source:'zeotap.com',atype:1},'hadronId':{source:'audigent.com',atype:1},'haloId':{source:'audigent.com',atype:1},'quantcastId':{source:'quantcast.com',atype:1},'nextrollId':{source:'nextroll.com',atype:1},'idx':{source:'idx.lat',atype:1},'connectid':{source:'verizonmedia.com',atype:3},'fabrickId':{source:'neustar.biz',atype:1},'mwOpenLinkId':{source:'mediawallahscript.com',atype:1},'tapadId':{source:'tapad.com',atype:1},'novatiq':{getValue:function getValue(data){return data.snowflake;},source:'novatiq.com',atype:1},'uid2':{source:'uidapi.com',atype:3,getValue:function getValue(data){return data.id;}},'dapId':{source:'akamai.com',atype:1},'deepintentId':{source:'deepintent.com',atype:3},'admixerId':{source:'admixer.net',atype:3},'adtelligentId':{source:'adtelligent.com',atype:3},amxId:{source:'amxrtb.com',atype:1},'publinkId':{source:'epsilon.com',atype:3},'kpuid':{source:'kpuid.com',atype:3},'imuid':{source:'intimatemerger.com',atype:1},'connectId':{source:'yahoo.com',atype:3},'qid':{source:'adquery.io',atype:1},'dacId':{source:'impact-ad.jp',atype:1},'33acrossId':{source:'33across.com',atype:1,getValue:function getValue(data){return data.envelope;}}};function createEidObject(userIdData,subModuleKey){var conf=USER_IDS_CONFIG[subModuleKey];if(conf&&userIdData){var eid={};eid.source=conf['source'];var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getValue'])?conf['getValue'](userIdData):userIdData;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(value)){var uid={id:value,atype:conf['atype']};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getUidExt'])){var uidExt=conf['getUidExt'](userIdData);if(uidExt){uid.ext=uidExt;}}
eid.uids=[uid];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getEidExt'])){var eidExt=conf['getEidExt'](userIdData);if(eidExt){eid.ext=eidExt;}}
return eid;}}
return null;}
function createEidsArray(bidRequestUserId){var eids=[];for(var subModuleKey in bidRequestUserId){if(bidRequestUserId.hasOwnProperty(subModuleKey)){if(subModuleKey==='pubProvidedId'){eids=eids.concat(bidRequestUserId['pubProvidedId']);}else{var eid=createEidObject(bidRequestUserId[subModuleKey],subModuleKey);if(eid){eids.push(eid);}}}}
return eids;}
function buildEidPermissions(submodules){var eidPermissions=[];submodules.filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).forEach(function(i){Object.keys(i.idObj).forEach(function(key){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(i,'config.bidders')&&Array.isArray(i.config.bidders)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(USER_IDS_CONFIG,key+'.source')){eidPermissions.push({source:USER_IDS_CONFIG[key].source,bidders:i.config.bidders});}});});return eidPermissions;}})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/sharethroughBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["sovrnBidAdapter"],{"./modules/sovrnBidAdapter.js":
/*!************************************!*\
  !*** ./modules/sovrnBidAdapter.js ***!
  \************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _userId_eids_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./userId/eids.js */
"./modules/userId/eids.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var ORTB_VIDEO_PARAMS={'mimes':function mimes(value){return Array.isArray(value)&&value.length>0&&value.every(function(v){return typeof v==='string';});},'minduration':function minduration(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'maxduration':function maxduration(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'protocols':function protocols(value){return Array.isArray(value)&&value.every(function(v){return v>=1&&v<=10;});},'w':function w(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'h':function h(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'startdelay':function startdelay(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'placement':function placement(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value)&&value>=1&&value<=5;},'linearity':function linearity(value){return[1,2].indexOf(value)!==-1;},'skip':function skip(value){return[0,1].indexOf(value)!==-1;},'skipmin':function skipmin(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'skipafter':function skipafter(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'sequence':function sequence(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'battr':function battr(value){return Array.isArray(value)&&value.every(function(v){return v>=1&&v<=17;});},'maxextended':function maxextended(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'minbitrate':function minbitrate(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'maxbitrate':function maxbitrate(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value);},'boxingallowed':function boxingallowed(value){return[0,1].indexOf(value)!==-1;},'playbackmethod':function playbackmethod(value){return Array.isArray(value)&&value.every(function(v){return v>=1&&v<=6;});},'playbackend':function playbackend(value){return[1,2,3].indexOf(value)!==-1;},'delivery':function delivery(value){return Array.isArray(value)&&value.every(function(v){return v>=1&&v<=3;});},'pos':function pos(value){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(value)&&value>=1&&value<=7;},'api':function api(value){return Array.isArray(value)&&value.every(function(v){return v>=1&&v<=6;});}};var REQUIRED_VIDEO_PARAMS={context:function context(value){return value!==_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.ADPOD;},mimes:ORTB_VIDEO_PARAMS.mimes,minduration:ORTB_VIDEO_PARAMS.minduration,maxduration:ORTB_VIDEO_PARAMS.maxduration,protocols:ORTB_VIDEO_PARAMS.protocols};var spec={code:'sovrn',supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO],gvlid:13,isBidRequestValid:function isBidRequestValid(bid){var _bid$mediaTypes;var video=bid===null||bid===void 0?void 0:(_bid$mediaTypes=bid.mediaTypes)===null||_bid$mediaTypes===void 0?void 0:_bid$mediaTypes.video;return!!(bid.params.tagid&&!isNaN(parseFloat(bid.params.tagid))&&isFinite(bid.params.tagid)&&(!video||Object.keys(REQUIRED_VIDEO_PARAMS).every(function(key){return REQUIRED_VIDEO_PARAMS[key](video[key]);})));},buildRequests:function buildRequests(bidReqs,bidderRequest){try{var sovrnImps=[];var iv;var schain;var eids;var tpid=[];var criteoId;(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__._each)(bidReqs,function(bid){if(!eids&&bid.userId){eids=(0,_userId_eids_js__WEBPACK_IMPORTED_MODULE_2__.createEidsArray)(bid.userId);eids.forEach(function(id){if(id.uids&&id.uids[0]){if(id.source==='criteo.com'){criteoId=id.uids[0].id;}
tpid.push({source:id.source,uid:id.uids[0].id});}});}
if(bid.schain){schain=schain||bid.schain;}
iv=iv||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getBidIdParameter)('iv',bid.params);var floorInfo=bid.getFloor&&typeof bid.getFloor==='function'?bid.getFloor({currency:'USD',mediaType:bid.mediaTypes&&bid.mediaTypes.banner?'banner':'video',size:'*'}):{};floorInfo.floor=floorInfo.floor||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getBidIdParameter)('bidfloor',bid.params);var imp={adunitcode:bid.adUnitCode,id:bid.bidId,tagid:String((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getBidIdParameter)('tagid',bid.params)),bidfloor:floorInfo.floor};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.banner')){var bidSizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.banner.sizes')||bid.sizes;bidSizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bidSizes)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(bidSizes[0])?bidSizes:[bidSizes];bidSizes=bidSizes.filter(function(size){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(size);});var processedSizes=bidSizes.map(function(size){return{w:parseInt(size[0],10),h:parseInt(size[1],10)};});imp.banner={format:processedSizes,w:1,h:1};}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.video')){imp.video=_buildVideoRequestObj(bid);}
imp.ext=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getBidIdParameter)('ext',bid.ortb2Imp)||undefined;var segmentsString=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getBidIdParameter)('segments',bid.params);if(segmentsString){imp.ext=imp.ext||{};imp.ext.deals=segmentsString.split(',').map(function(deal){return deal.trim();});}
sovrnImps.push(imp);});var fpd=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.deepClone)(_src_config_js__WEBPACK_IMPORTED_MODULE_4__.config.getConfig('ortb2'));var site=fpd.site||{};site.page=bidderRequest.refererInfo.referer;site.domain=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.parseUrl)(site.page).hostname;var sovrnBidReq={id:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getUniqueIdentifierStr)(),imp:sovrnImps,site:site,user:fpd.user||{}};if(schain){sovrnBidReq.source={ext:{schain:schain}};}
if(bidderRequest.gdprConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'regs.ext.gdpr',+bidderRequest.gdprConsent.gdprApplies);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'user.ext.consent',bidderRequest.gdprConsent.consentString);}
if(bidderRequest.uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'regs.ext.us_privacy',bidderRequest.uspConsent);}
if(eids){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'user.ext.eids',eids);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'user.ext.tpid',tpid);if(criteoId){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_5__["default"])(sovrnBidReq,'user.ext.prebid_criteoid',criteoId);}}
var url="https://ap.lijit.com/rtb/bid?src=prebid_prebid_6.24.1";if(iv)url+="&iv=".concat(iv);return{method:'POST',url:url,data:JSON.stringify(sovrnBidReq),options:{contentType:'text/plain'}};}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Could not build bidrequest, error deatils:',e);}},interpretResponse:function interpretResponse(_ref){var _ref$body=_ref.body,id=_ref$body.id,seatbid=_ref$body.seatbid;if(!id||!seatbid||!Array.isArray(seatbid))return[];try{return seatbid.filter(function(seat){return seat;}).map(function(seat){return seat.bid.map(function(sovrnBid){var _sovrnBid$ext;var bid={requestId:sovrnBid.impid,cpm:parseFloat(sovrnBid.price),width:parseInt(sovrnBid.w),height:parseInt(sovrnBid.h),creativeId:sovrnBid.crid||sovrnBid.id,dealId:sovrnBid.dealid||null,currency:'USD',netRevenue:true,mediaType:sovrnBid.nurl?_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO,ttl:((_sovrnBid$ext=sovrnBid.ext)===null||_sovrnBid$ext===void 0?void 0:_sovrnBid$ext.ttl)||90,meta:{advertiserDomains:sovrnBid&&sovrnBid.adomain?sovrnBid.adomain:[]}};if(sovrnBid.nurl){bid.ad=decodeURIComponent("".concat(sovrnBid.adm,"<img src=\"").concat(sovrnBid.nurl,"\">"));}else{bid.vastXml=decodeURIComponent(sovrnBid.adm);}
return bid;});}).flat();}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('Could not interpret bidresponse, error details:',e);return e;}},getUserSyncs:function getUserSyncs(syncOptions,serverResponses,gdprConsent,uspConsent){try{var tracks=[];if(serverResponses&&serverResponses.length!==0){if(syncOptions.iframeEnabled){var iidArr=serverResponses.filter(function(resp){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(resp,'body.ext.iid');}).map(function(resp){return resp.body.ext.iid;});var params=[];if(gdprConsent&&gdprConsent.gdprApplies&&typeof gdprConsent.consentString==='string'){params.push(['gdpr_consent',gdprConsent.consentString]);}
if(uspConsent){params.push(['us_privacy',uspConsent]);}
if(iidArr[0]){params.push(['informer',iidArr[0]]);tracks.push({type:'iframe',url:'https://ap.lijit.com/beacon?'+params.map(function(p){return p.join('=');}).join('&')});}}
if(syncOptions.pixelEnabled){serverResponses.filter(function(resp){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(resp,'body.ext.sync.pixels');}).reduce(function(acc,resp){return acc.concat(resp.body.ext.sync.pixels);},[]).map(function(pixel){return pixel.url;}).forEach(function(url){return tracks.push({type:'image',url:url});});}}
return tracks;}catch(e){return[];}}};function _buildVideoRequestObj(bid){var videoObj={};var videoAdUnitParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'mediaTypes.video',{});var videoBidderParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(bid,'params.video',{});var computedParams={};if(Array.isArray(videoAdUnitParams.playerSize)){var sizes=Array.isArray(videoAdUnitParams.playerSize[0])?videoAdUnitParams.playerSize[0]:videoAdUnitParams.playerSize;computedParams.w=sizes[0];computedParams.h=sizes[1];}
var videoParams=_objectSpread(_objectSpread(_objectSpread({},computedParams),videoAdUnitParams),videoBidderParams);Object.keys(ORTB_VIDEO_PARAMS).forEach(function(paramName){if(videoParams.hasOwnProperty(paramName)){if(ORTB_VIDEO_PARAMS[paramName](videoParams[paramName])){videoObj[paramName]=videoParams[paramName];}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logWarn)("The OpenRTB video param ".concat(paramName," has been skipped due to misformating. Please refer to OpenRTB 2.5 spec."));}}});return videoObj;}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_6__.registerBidder)(spec);window.pbjs.installedModules.push('sovrnBidAdapter');}),"./modules/userId/eids.js":
/*!********************************!*\
  !*** ./modules/userId/eids.js ***!
  \********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{"USER_IDS_CONFIG":function(){return USER_IDS_CONFIG;},"buildEidPermissions":function(){return buildEidPermissions;},"createEidsArray":function(){return createEidsArray;}});var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../../src/utils.js */
"./node_modules/dlv/index.js");var USER_IDS_CONFIG={'trustpid':{source:'trustpid.com',atype:1,getValue:function getValue(data){return data;}},'intentIqId':{source:'intentiq.com',atype:1},'naveggId':{source:'navegg.com',atype:1},'justId':{source:'justtag.com',atype:1},'pubcid':{source:'pubcid.org',atype:1},'tdid':{source:'adserver.org',atype:1,getUidExt:function getUidExt(){return{rtiPartner:'TDID'};}},'id5id':{getValue:function getValue(data){return data.uid;},source:'id5-sync.com',atype:1,getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'ftrackId':{source:'flashtalking.com',atype:1,getValue:function getValue(data){return data.uid;},getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'parrableId':{source:'parrable.com',atype:1,getValue:function getValue(parrableId){if(parrableId.eid){return parrableId.eid;}
if(parrableId.ccpaOptout){return'';}
return null;},getUidExt:function getUidExt(parrableId){var extendedData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.pick)(parrableId,['ibaOptout','ccpaOptout']);if(Object.keys(extendedData).length){return extendedData;}}},'idl_env':{source:'liveramp.com',atype:3},'lipb':{getValue:function getValue(data){return data.lipbid;},source:'liveintent.com',atype:3,getEidExt:function getEidExt(data){if(Array.isArray(data.segments)&&data.segments.length){return{segments:data.segments};}}},'britepoolid':{source:'britepool.com',atype:3},'dmdId':{source:'hcn.health',atype:3},lotamePanoramaId:{source:'crwdcntrl.net',atype:1},'criteoId':{source:'criteo.com',atype:1},'merkleId':{source:'merkleinc.com',atype:3,getValue:function getValue(data){return data.id;},getUidExt:function getUidExt(data){return data&&data.keyID?{keyID:data.keyID}:undefined;}},'netId':{source:'netid.de',atype:1},'IDP':{source:'zeotap.com',atype:1},'hadronId':{source:'audigent.com',atype:1},'haloId':{source:'audigent.com',atype:1},'quantcastId':{source:'quantcast.com',atype:1},'nextrollId':{source:'nextroll.com',atype:1},'idx':{source:'idx.lat',atype:1},'connectid':{source:'verizonmedia.com',atype:3},'fabrickId':{source:'neustar.biz',atype:1},'mwOpenLinkId':{source:'mediawallahscript.com',atype:1},'tapadId':{source:'tapad.com',atype:1},'novatiq':{getValue:function getValue(data){return data.snowflake;},source:'novatiq.com',atype:1},'uid2':{source:'uidapi.com',atype:3,getValue:function getValue(data){return data.id;}},'dapId':{source:'akamai.com',atype:1},'deepintentId':{source:'deepintent.com',atype:3},'admixerId':{source:'admixer.net',atype:3},'adtelligentId':{source:'adtelligent.com',atype:3},amxId:{source:'amxrtb.com',atype:1},'publinkId':{source:'epsilon.com',atype:3},'kpuid':{source:'kpuid.com',atype:3},'imuid':{source:'intimatemerger.com',atype:1},'connectId':{source:'yahoo.com',atype:3},'qid':{source:'adquery.io',atype:1},'dacId':{source:'impact-ad.jp',atype:1},'33acrossId':{source:'33across.com',atype:1,getValue:function getValue(data){return data.envelope;}}};function createEidObject(userIdData,subModuleKey){var conf=USER_IDS_CONFIG[subModuleKey];if(conf&&userIdData){var eid={};eid.source=conf['source'];var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getValue'])?conf['getValue'](userIdData):userIdData;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(value)){var uid={id:value,atype:conf['atype']};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getUidExt'])){var uidExt=conf['getUidExt'](userIdData);if(uidExt){uid.ext=uidExt;}}
eid.uids=[uid];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getEidExt'])){var eidExt=conf['getEidExt'](userIdData);if(eidExt){eid.ext=eidExt;}}
return eid;}}
return null;}
function createEidsArray(bidRequestUserId){var eids=[];for(var subModuleKey in bidRequestUserId){if(bidRequestUserId.hasOwnProperty(subModuleKey)){if(subModuleKey==='pubProvidedId'){eids=eids.concat(bidRequestUserId['pubProvidedId']);}else{var eid=createEidObject(bidRequestUserId[subModuleKey],subModuleKey);if(eid){eids.push(eid);}}}}
return eids;}
function buildEidPermissions(submodules){var eidPermissions=[];submodules.filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).forEach(function(i){Object.keys(i.idObj).forEach(function(key){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(i,'config.bidders')&&Array.isArray(i.config.bidders)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(USER_IDS_CONFIG,key+'.source')){eidPermissions.push({source:USER_IDS_CONFIG[key].source,bidders:i.config.bidders});}});});return eidPermissions;}})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/sovrnBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["teadsBidAdapter"],{"./modules/teadsBidAdapter.js":
/*!************************************!*\
  !*** ./modules/teadsBidAdapter.js ***!
  \************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/storageManager.js */
"./src/storageManager.js");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var BIDDER_CODE='teads';var GVL_ID=132;var ENDPOINT_URL='https://a.teads.tv/hb/bid-request';var gdprStatus={GDPR_APPLIES_PUBLISHER:12,GDPR_APPLIES_GLOBAL:11,GDPR_DOESNT_APPLY:0,CMP_NOT_FOUND_OR_ERROR:22};var FP_TEADS_ID_COOKIE_NAME='_tfpvi';var storage=(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__.getStorageManager)({gvlid:GVL_ID,bidderCode:BIDDER_CODE});var spec={code:BIDDER_CODE,gvlid:GVL_ID,supportedMediaTypes:['video','banner'],isBidRequestValid:function isBidRequestValid(bid){var isValid=false;if(typeof bid.params!=='undefined'){var isValidPlacementId=_validateId((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getValue)(bid.params,'placementId'));var isValidPageId=_validateId((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getValue)(bid.params,'pageId'));isValid=isValidPlacementId&&isValidPageId;}
if(!isValid){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Teads placementId and pageId parameters are required. Bid aborted.');}
return isValid;},buildRequests:function buildRequests(validBidRequests,bidderRequest){var bids=validBidRequests.map(buildRequestObject);var payload=_objectSpread(_objectSpread(_objectSpread({referrer:getReferrerInfo(bidderRequest),pageReferrer:document.referrer,networkBandwidth:getConnectionDownLink(window.navigator),timeToFirstByte:getTimeToFirstByte(window),data:bids,deviceWidth:screen.width,hb_version:"6.24.1"},getFLoCParameters((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequests,'0.userId.flocId'))),getUnifiedId2Parameter((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(validBidRequests,'0.userId.uid2'))),getFirstPartyTeadsIdParameter());if(validBidRequests[0].schain){payload.schain=validBidRequests[0].schain;}
var gdpr=bidderRequest.gdprConsent;if(bidderRequest&&gdpr){var isCmp=typeof gdpr.gdprApplies==='boolean';var isConsentString=typeof gdpr.consentString==='string';var status=isCmp?findGdprStatus(gdpr.gdprApplies,gdpr.vendorData,gdpr.apiVersion):gdprStatus.CMP_NOT_FOUND_OR_ERROR;payload.gdpr_iab={consent:isConsentString?gdpr.consentString:'',status:status,apiVersion:gdpr.apiVersion};}
if(bidderRequest&&bidderRequest.uspConsent){payload.us_privacy=bidderRequest.uspConsent;}
var payloadString=JSON.stringify(payload);return{method:'POST',url:ENDPOINT_URL,data:payloadString};},interpretResponse:function interpretResponse(serverResponse,bidderRequest){var bidResponses=[];serverResponse=serverResponse.body;if(serverResponse.responses){serverResponse.responses.forEach(function(bid){var bidResponse={cpm:bid.cpm,width:bid.width,height:bid.height,currency:bid.currency,netRevenue:true,ttl:bid.ttl,meta:{advertiserDomains:bid&&bid.adomain?bid.adomain:[]},ad:bid.ad,requestId:bid.bidId,creativeId:bid.creativeId,placementId:bid.placementId};if(bid.dealId){bidResponse.dealId=bid.dealId;}
bidResponses.push(bidResponse);});}
return bidResponses;}};function getReferrerInfo(bidderRequest){var ref='';if(bidderRequest&&bidderRequest.refererInfo&&bidderRequest.refererInfo.referer){ref=bidderRequest.refererInfo.referer;}
return ref;}
function getConnectionDownLink(nav){return nav&&nav.connection&&nav.connection.downlink>=0?nav.connection.downlink.toString():'';}
function getTimeToFirstByte(win){var performance=win.performance||win.webkitPerformance||win.msPerformance||win.mozPerformance;var ttfbWithTimingV2=performance&&typeof performance.getEntriesByType==='function'&&Object.prototype.toString.call(performance.getEntriesByType)==='[object Function]'&&performance.getEntriesByType('navigation')[0]&&performance.getEntriesByType('navigation')[0].responseStart&&performance.getEntriesByType('navigation')[0].requestStart&&performance.getEntriesByType('navigation')[0].responseStart>0&&performance.getEntriesByType('navigation')[0].requestStart>0&&Math.round(performance.getEntriesByType('navigation')[0].responseStart-performance.getEntriesByType('navigation')[0].requestStart);if(ttfbWithTimingV2){return ttfbWithTimingV2.toString();}
var ttfbWithTimingV1=performance&&performance.timing.responseStart&&performance.timing.requestStart&&performance.timing.responseStart>0&&performance.timing.requestStart>0&&performance.timing.responseStart-performance.timing.requestStart;return ttfbWithTimingV1?ttfbWithTimingV1.toString():'';}
function findGdprStatus(gdprApplies,gdprData,apiVersion){var status=gdprStatus.GDPR_APPLIES_PUBLISHER;if(gdprApplies){if(isGlobalConsent(gdprData,apiVersion)){status=gdprStatus.GDPR_APPLIES_GLOBAL;}}else{status=gdprStatus.GDPR_DOESNT_APPLY;}
return status;}
function isGlobalConsent(gdprData,apiVersion){return gdprData&&apiVersion===1?gdprData.hasGlobalScope||gdprData.hasGlobalConsent:gdprData&&apiVersion===2?!gdprData.isServiceSpecific:false;}
function buildRequestObject(bid){var reqObj={};var placementId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getValue)(bid.params,'placementId');var pageId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getValue)(bid.params,'pageId');var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'ortb2Imp.ext.gpid');reqObj.sizes=getSizes(bid);reqObj.bidId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidIdParameter)('bidId',bid);reqObj.bidderRequestId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidIdParameter)('bidderRequestId',bid);reqObj.placementId=parseInt(placementId,10);reqObj.pageId=parseInt(pageId,10);reqObj.adUnitCode=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidIdParameter)('adUnitCode',bid);reqObj.auctionId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidIdParameter)('auctionId',bid);reqObj.transactionId=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getBidIdParameter)('transactionId',bid);if(gpid){reqObj.gpid=gpid;}
return reqObj;}
function getSizes(bid){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.parseSizesInput)(concatSizes(bid));}
function concatSizes(bid){var playerSize=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.playerSize');var videoSizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.video.sizes');var bannerSizes=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,'mediaTypes.banner.sizes');if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(bannerSizes)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(playerSize)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(videoSizes)){var mediaTypesSizes=[bannerSizes,videoSizes,playerSize];return mediaTypesSizes.reduce(function(acc,currSize){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(currSize)){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(currSize[0])){currSize.forEach(function(childSize){acc.push(childSize);});}else{acc.push(currSize);}}
return acc;},[]);}else{return bid.sizes;}}
function _validateId(id){return parseInt(id)>0;}
function getFLoCParameters(optionalFlocId){if(!optionalFlocId){return{};}
var cohortId=optionalFlocId.id?{cohortId:optionalFlocId.id}:{};var cohortVersion=optionalFlocId.version?{cohortVersion:optionalFlocId.version}:{};return _objectSpread(_objectSpread({},cohortId),cohortVersion);}
function getUnifiedId2Parameter(optionalUid2){return optionalUid2?{unifiedId2:optionalUid2.id}:{};}
function getFirstPartyTeadsIdParameter(){if(!storage.cookiesAreEnabled()){return{};}
var firstPartyTeadsId=storage.getCookie(FP_TEADS_ID_COOKIE_NAME);return firstPartyTeadsId?{firstPartyCookieTeadsId:firstPartyTeadsId}:{};}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__.registerBidder)(spec);window.pbjs.installedModules.push('teadsBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/teadsBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["tripleliftBidAdapter"],{"./modules/tripleliftBidAdapter.js":
/*!*****************************************!*\
  !*** ./modules/tripleliftBidAdapter.js ***!
  \*****************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/config.js */
"./src/config.js");function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
var GVLID=28;var BIDDER_CODE='triplelift';var STR_ENDPOINT='https://tlx.3lift.com/header/auction?';var BANNER_TIME_TO_LIVE=300;var INSTREAM_TIME_TO_LIVE=3600;var gdprApplies=true;var consentString=null;var tripleliftAdapterSpec={gvlid:GVLID,code:BIDDER_CODE,supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_0__.VIDEO],isBidRequestValid:function isBidRequestValid(bid){return typeof bid.params.inventoryCode!=='undefined';},buildRequests:function buildRequests(bidRequests,bidderRequest){var tlCall=STR_ENDPOINT;var data=_buildPostBody(bidRequests);tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'lib','prebid');tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'v',"6.24.1");if(bidderRequest&&bidderRequest.refererInfo){var referrer=bidderRequest.refererInfo.referer;tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'referrer',referrer);}
if(bidderRequest&&bidderRequest.timeout){tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'tmax',bidderRequest.timeout);}
if(bidderRequest&&bidderRequest.gdprConsent){if(typeof bidderRequest.gdprConsent.gdprApplies!=='undefined'){gdprApplies=bidderRequest.gdprConsent.gdprApplies;tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'gdpr',gdprApplies.toString());}
if(typeof bidderRequest.gdprConsent.consentString!=='undefined'){consentString=bidderRequest.gdprConsent.consentString;tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'cmp_cs',consentString);}}
if(bidderRequest&&bidderRequest.uspConsent){tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'us_privacy',bidderRequest.uspConsent);}
if(_src_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('coppa')===true){tlCall=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(tlCall,'coppa',true);}
if(tlCall.lastIndexOf('&')===tlCall.length-1){tlCall=tlCall.substring(0,tlCall.length-1);}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logMessage)('tlCall request built: '+tlCall);return{method:'POST',url:tlCall,data:data,bidderRequest:bidderRequest};},interpretResponse:function interpretResponse(serverResponse,_ref){var bidderRequest=_ref.bidderRequest;var bids=serverResponse.body.bids||[];return bids.map(function(bid){return _buildResponseObject(bidderRequest,bid);});},getUserSyncs:function getUserSyncs(syncOptions,responses,gdprConsent,usPrivacy){var syncType=_getSyncType(syncOptions);if(!syncType)return;var syncEndpoint='https://eb2.3lift.com/sync?';if(syncType==='image'){syncEndpoint=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(syncEndpoint,'px',1);syncEndpoint=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(syncEndpoint,'src','prebid');}
if(consentString!==null){syncEndpoint=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(syncEndpoint,'gdpr',gdprApplies);syncEndpoint=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(syncEndpoint,'cmp_cs',consentString);}
if(usPrivacy){syncEndpoint=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.tryAppendQueryString)(syncEndpoint,'us_privacy',usPrivacy);}
return[{type:syncType,url:syncEndpoint}];}};function _getSyncType(syncOptions){if(!syncOptions)return;if(syncOptions.iframeEnabled)return'iframe';if(syncOptions.pixelEnabled)return'image';}
function _buildPostBody(bidRequests){var data={};var schain=bidRequests[0].schain;var globalFpd=_getGlobalFpd();data.imp=bidRequests.map(function(bidRequest,index){var imp={id:index,tagid:bidRequest.params.inventoryCode,floor:_getFloor(bidRequest)};if(_isInstreamBidRequest(bidRequest)){imp.video=_getORTBVideo(bidRequest);}else if(bidRequest.mediaTypes.banner){imp.banner={format:_sizes(bidRequest.sizes)};};if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(bidRequest.ortb2Imp)){imp.fpd=_getAdUnitFpd(bidRequest.ortb2Imp);}
return imp;});var eids=[].concat(_toConsumableArray(getUnifiedIdEids([bidRequests[0]])),_toConsumableArray(getIdentityLinkEids([bidRequests[0]])),_toConsumableArray(getCriteoEids([bidRequests[0]])),_toConsumableArray(getPubCommonEids([bidRequests[0]])));if(eids.length>0){data.user={ext:{eids:eids}};}
var ext=_getExt(schain,globalFpd);if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(ext)){data.ext=ext;}
return data;}
function _isInstreamBidRequest(bidRequest){if(!bidRequest.mediaTypes.video)return false;if(!bidRequest.mediaTypes.video.context)return false;if(bidRequest.mediaTypes.video.context.toLowerCase()==='instream'){return true;}else{return false;}}
function _getORTBVideo(bidRequest){var video=_objectSpread(_objectSpread({},bidRequest.params.video),bidRequest.mediaTypes.video);if(!video.w)video.w=video.playerSize[0][0];if(!video.h)video.h=video.playerSize[0][1];if(video.context==='instream')video.placement=1;delete video.playerSize;return video;}
function _getFloor(bid){var floor=null;if(typeof bid.getFloor==='function'){try{var floorInfo=bid.getFloor({currency:'USD',mediaType:_isInstreamBidRequest(bid)?'video':'banner',size:'*'});if(_typeof(floorInfo)==='object'&&floorInfo.currency==='USD'&&!isNaN(parseFloat(floorInfo.floor))){floor=parseFloat(floorInfo.floor);}}catch(err){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)('Triplelift: getFloor threw an error: ',err);}}
return floor!==null?floor:bid.params.floor;}
function _getGlobalFpd(){var fpd={};var context={};var user={};var ortbData=_src_config_js__WEBPACK_IMPORTED_MODULE_2__.config.getConfig('ortb2')||{};var fpdContext=_extends({},ortbData.site);var fpdUser=_extends({},ortbData.user);_addEntries(context,fpdContext);_addEntries(user,fpdUser);if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(context)){fpd.context=context;}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(user)){fpd.user=user;}
return fpd;}
function _getAdUnitFpd(adUnitFpd){var fpd={};var context={};_addEntries(context,adUnitFpd.ext);if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(context)){fpd.context=context;}
return fpd;}
function _addEntries(target,source){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(source)){Object.keys(source).forEach(function(key){if(source[key]!=null){target[key]=source[key];}});}}
function _getExt(schain,fpd){var ext={};if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(schain)){ext.schain=_objectSpread({},schain);}
if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(fpd)){ext.fpd=_objectSpread({},fpd);}
return ext;}
function getUnifiedIdEids(bidRequest){return getEids(bidRequest,'tdid','adserver.org','TDID');}
function getIdentityLinkEids(bidRequest){return getEids(bidRequest,'idl_env','liveramp.com','idl');}
function getCriteoEids(bidRequest){return getEids(bidRequest,'criteoId','criteo.com','criteoId');}
function getPubCommonEids(bidRequest){return getEids(bidRequest,'pubcid','pubcid.org','pubcid');}
function getEids(bidRequest,type,source,rtiPartner){return bidRequest.map(getUserId(type)).filter(filterEids(type)).map(formatEid(source,rtiPartner));}
var filterEids=function filterEids(type){return function(userId,i,arr){var isValidUserId=!!userId&&((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(userId)?!!userId:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(userId)&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(userId)&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(userId)&&userId.id&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isStr)(userId.id)&&!!userId.id);if(!isValidUserId&&arr[0]!==undefined){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("Triplelift: invalid ".concat(type," userId format"));}
return isValidUserId;};};function getUserId(type){return function(bid){return bid&&bid.userId&&bid.userId[type];};}
function formatEid(source,rtiPartner){return function(userId){return{source:source,uids:[{id:userId.id?userId.id:userId,ext:{rtiPartner:rtiPartner}}]};};}
function _sizes(sizeArray){var sizes=sizeArray.filter(_isValidSize);return sizes.map(function(size){return{w:size[0],h:size[1]};});}
function _isValidSize(size){return size.length===2&&typeof size[0]==='number'&&typeof size[1]==='number';}
function _buildResponseObject(bidderRequest,bid){var bidResponse={};var width=bid.width||1;var height=bid.height||1;var dealId=bid.deal_id||'';var creativeId=bid.crid||'';var breq=bidderRequest.bids[bid.imp_id];if(bid.cpm!=0&&bid.ad){bidResponse={requestId:breq.bidId,cpm:bid.cpm,width:width,height:height,netRevenue:true,ad:bid.ad,creativeId:creativeId,dealId:dealId,currency:'USD',ttl:BANNER_TIME_TO_LIVE,tl_source:bid.tl_source,meta:{}};if(_isInstreamBidRequest(breq)){bidResponse.vastXml=bid.ad;bidResponse.mediaType='video';bidResponse.ttl=INSTREAM_TIME_TO_LIVE;};if(bid.advertiser_name){bidResponse.meta.advertiserName=bid.advertiser_name;}
if(bid.adomain&&bid.adomain.length){bidResponse.meta.advertiserDomains=bid.adomain;}
if(bid.tl_source&&bid.tl_source=='hdx'){bidResponse.meta.mediaType='banner';}
if(bid.tl_source&&bid.tl_source=='tlx'){bidResponse.meta.mediaType='native';}};return bidResponse;}
(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__.registerBidder)(tripleliftAdapterSpec);window.pbjs.installedModules.push('tripleliftBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/tripleliftBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["uid2IdSystem"],{"./modules/uid2IdSystem.js":
/*!*********************************!*\
  !*** ./modules/uid2IdSystem.js ***!
  \*********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_hook_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/hook.js */
"./src/hook.js");var _src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/storageManager.js */
"./src/storageManager.js");var MODULE_NAME='uid2';var GVLID=887;var LOG_PRE_FIX='UID2: ';var ADVERTISING_COOKIE='__uid2_advertising_token';function readCookie(){return storage.cookiesAreEnabled()?storage.getCookie(ADVERTISING_COOKIE):null;}
function readFromLocalStorage(){return storage.localStorageIsEnabled()?storage.getDataFromLocalStorage(ADVERTISING_COOKIE):null;}
function getStorage(){return(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__.getStorageManager)({gvlid:GVLID,moduleName:MODULE_NAME});}
var storage=getStorage();var _logInfo=createLogInfo(LOG_PRE_FIX);function createLogInfo(prefix){return function(){for(var _len=arguments.length,strings=new Array(_len),_key=0;_key<_len;_key++){strings[_key]=arguments[_key];}
_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo.apply(void 0,[prefix+' '].concat(strings));};}
function encodeId(value){var result={};if(value){var bidIds={id:value};result.uid2=bidIds;_logInfo('Decoded value '+JSON.stringify(result));return result;}
return undefined;}
var uid2IdSubmodule={name:MODULE_NAME,gvlid:GVLID,decode:function decode(value){return value?encodeId(value):undefined;},getId:function getId(config,consentData){_logInfo('Creating UID 2.0');var value=readCookie()||readFromLocalStorage();_logInfo('The advertising token: '+value);return{id:value};}};(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_2__.submodule)('userId',uid2IdSubmodule);window.pbjs.installedModules.push('uid2IdSystem');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/uid2IdSystem.js"));}]);(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["underdogmediaBidAdapter"],{"./modules/underdogmediaBidAdapter.js":
/*!********************************************!*\
  !*** ./modules/underdogmediaBidAdapter.js ***!
  \********************************************/
(function(module,__unused_webpack_exports,__webpack_require__){var bidfactory=__webpack_require__(
/*! ../src/bidfactory.js */
"./src/bidfactory.js");var utils=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var adapterManager=__webpack_require__(
/*! ../src/adapterManager.js */
"./src/adapterManager.js");var _addBidResponse;var _done;var responsesProcessed={};var UDM_ADAPTER_VERSION='1.38-6.5.0C';var PREBID_VERSION=pbjs.version;var PREBID_NAME="pbjs";var UDM_VENDOR_ID='159';var LATEST_TEST_DATE='2021-12-22';var UnderdogMediaAdapter=function UnderdogMediaAdapter(){utils.logMessage("Initializing UDM Adapter.Global Prebid Name: pbjs PBJS Version: $ {\n        pbjs.version\n    }\n    with adapter version: $ {\n        UDM_ADAPTER_VERSION\n    }\n    Updated / tested: $ {\n        LATEST_TEST_DATE\n    }");var getJsStaticUrl='https://bid.underdog.media/udm_header_lib.js';pbjs.handleUnderdogMediaCB=function(){};function _callBids(bidderRequest,addBidResponse,done){_addBidResponse=addBidResponse;_done=done;var gdpr={gdprApplies:false,consentGiven:true,consentData:'',prebidConsentData:bidderRequest.gdprConsent};if(bidderRequest&&bidderRequest.gdprConsent){if(typeof bidderRequest.gdprConsent.gdprApplies!=='undefined'){gdpr.gdprApplies=!!bidderRequest.gdprConsent.gdprApplies;}
if(bidderRequest.gdprConsent.vendorData&&bidderRequest.gdprConsent.vendorData.vendorConsents&&typeof bidderRequest.gdprConsent.vendorData.vendorConsents[UDM_VENDOR_ID]!=='undefined'){gdpr.consentGiven=!!bidderRequest.gdprConsent.vendorData.vendorConsents[UDM_VENDOR_ID];}
if(typeof bidderRequest.gdprConsent.consentString!=='undefined'){gdpr.consentData=bidderRequest.gdprConsent.consentString;}}
if(!gdpr.gdprApplies||gdpr.consentGiven){if(typeof window.udm_header_lib==='undefined'){loadScript(getJsStaticUrl,function(){bid(bidderRequest,gdpr);});}else{bid(bidderRequest,gdpr);}}else{var sid=bidderRequest.bids[0].params.siteId;loadScript("https: //udmserve.net/udm/img.fetch?tid=1;dt=9;sid=".concat(sid,";gdprApplies=").concat(gdpr.gdprApplies,";consentGiven=").concat(gdpr.consentGiven,";"),function(){utils.logWarn('UDM Request Cancelled - No GDPR Consent');_done();});}}
function loadScript(url,callback){var script=document.createElement('script');script.type='text/javascript';script.async=true;if(callback&&typeof callback==='function'){if(script.readyState){script.onreadystatechange=function(){if(script.readyState==='loaded'||script.readyState==='complete'){script.onreadystatechange=null;callback();}};}else{script.onload=function(){callback();};}}
script.src=url;utils.insertElement(script);}
function bid(bidderRequest,gdpr){responsesProcessed[bidderRequest.auctionId]=0;var bids=bidderRequest.bids;var mappedBids=[];for(var i=0;i<bids.length;i++){var bidRequest=bids[i];var callback=bidResponseCallback(bidRequest,bids.length);var bidRequestSizes=bidRequest.mediaTypes&&bidRequest.mediaTypes.banner&&bidRequest.mediaTypes.banner.sizes?bidRequest.mediaTypes.banner.sizes:bidRequest.sizes;mappedBids.push({auctionId:bidRequest.auctionId,auctionStart:bidderRequest.auctionStart,auctionTimeout:bidderRequest.timeout,bidder:bidRequest.bidder,sizes:bidRequestSizes,siteId:bidRequest.params.siteId,bidfloor:bidRequest.params.bidfloor,adunitcode:bidRequest.adUnitCode,placementCode:bidRequest.adUnitCode,divId:bidRequest.params.divId,subId:bidRequest.params.subId,callback:callback,uspConsent:bidderRequest.uspConsent});}
if(window.udm_header_lib.storePubPrebidInfo){window.udm_header_lib.storePubPrebidInfo({adapterVersion:UDM_ADAPTER_VERSION,prebidName:PREBID_NAME,prebidVersion:PREBID_VERSION});}
if(gdpr.gdprApplies){if(window.udm_header_lib.storeGDPRConsentData){window.udm_header_lib.storeGDPRConsentData(gdpr);}}
if(bidderRequest.uspConsent){if(window.udm_header_lib.storeUSPConsentData){window.udm_header_lib.storeUSPConsentData(bidderRequest.uspConsent);}}
var udmBidRequest=new window.udm_header_lib.BidRequestArray(mappedBids);udmBidRequest.send();}
function bidResponseCallback(bid,bids){return function(bidResponse){bidResponseAvailable(bid,bidResponse,bids);};}
function bidResponseAvailable(bidRequest,bidResponse,bids){if(bidResponse.bids.length>0){for(var i=0;i<bidResponse.bids.length;i++){var udmBid=bidResponse.bids[i];var _bid=bidfactory.createBid(1,bidRequest);if(udmBid.udmDebug){_bid.udmDebug=udmBid.udmDebug;}
_bid.requestId=bidRequest.bidId;_bid.cpm=udmBid.cpm;_bid.width=udmBid.width;_bid.height=udmBid.height;_bid.ttl=udmBid.ttl||60;_bid.netRevenue=false;_bid.currency='USD';_bid.bidderCode=bidRequest.bidder;_bid.auctionId=bidRequest.auctionId;_bid.adUnitCode=bidRequest.adUnitCode;_bid.trueBidder=udmBid.bidderCode;_bid.creativeId=udmBid.creativeId;if(udmBid.ad_url!==undefined){_bid.adUrl=udmBid.ad_url;}else if(udmBid.ad_html!==undefined){_bid.ad=udmBid.ad_html.replace('UDM_ADAPTER_VERSION','P_'+PREBID_VERSION+'_A_'+UDM_ADAPTER_VERSION);}else{utils.logMessage('Underdogmedia bid is lacking both ad_url and ad_html, skipping bid');continue;}
_addBidResponse(bidRequest.adUnitCode,_bid);}}else{var nobid=bidfactory.createBid(2,bidRequest);nobid.bidderCode=bidRequest.bidder;_addBidResponse(bidRequest.adUnitCode,nobid);}
responsesProcessed[bidRequest.auctionId]++;if(responsesProcessed[bidRequest.auctionId]>=bids){delete responsesProcessed[bidRequest.auctionId];_done();}}
function getSpec(){return{onBidWon:function onBidWon(bid){utils.logMessage('Underdog Media onBidWon Event',bid);},onSetTargeting:function onSetTargeting(bid){utils.logMessage('Underdog Media onSetTargeting Event',bid);}};}
return{callBids:_callBids,getSpec:getSpec};};var registerBidAdapter=adapterManager.default.registerBidAdapter;registerBidAdapter(new UnderdogMediaAdapter(),'underdogmedia');module.exports=UnderdogMediaAdapter;window.pbjs.installedModules.push('underdogmediaBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/underdogmediaBidAdapter.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["unifiedIdSystem"],{"./modules/unifiedIdSystem.js":
/*!************************************!*\
  !*** ./modules/unifiedIdSystem.js ***!
  \************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_ajax_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/ajax.js */
"./src/ajax.js");var _src_hook_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/hook.js */
"./src/hook.js");var MODULE_NAME='unifiedId';var unifiedIdSubmodule={name:MODULE_NAME,gvlid:21,decode:function decode(value){return value&&typeof value['TDID']==='string'?{'tdid':value['TDID']}:undefined;},getId:function getId(config){var configParams=config&&config.params||{};if(!configParams||typeof configParams.partner!=='string'&&typeof configParams.url!=='string'){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)('User ID - unifiedId submodule requires either partner or url to be defined');return;}
var url=configParams.url||"https://match.adsrvr.org/track/rid?ttd_pid=".concat(configParams.partner,"&fmt=json");var resp=function resp(callback){var callbacks={success:function success(response){var responseObj;if(response){try{responseObj=JSON.parse(response);}catch(error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(error);}}
callback(responseObj);},error:function error(_error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)("".concat(MODULE_NAME,": ID fetch encountered an error"),_error);callback();}};(0,_src_ajax_js__WEBPACK_IMPORTED_MODULE_1__.ajax)(url,callbacks,undefined,{method:'GET',withCredentials:true});};return{callback:resp};}};(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_2__.submodule)('userId',unifiedIdSubmodule);window.pbjs.installedModules.push('unifiedIdSystem');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/unifiedIdSystem.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["userId"],{"./modules/userId/eids.js":
/*!********************************!*\
  !*** ./modules/userId/eids.js ***!
  \********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{"USER_IDS_CONFIG":function(){return USER_IDS_CONFIG;},"buildEidPermissions":function(){return buildEidPermissions;},"createEidsArray":function(){return createEidsArray;}});var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../../src/utils.js */
"./node_modules/dlv/index.js");var USER_IDS_CONFIG={'trustpid':{source:'trustpid.com',atype:1,getValue:function getValue(data){return data;}},'intentIqId':{source:'intentiq.com',atype:1},'naveggId':{source:'navegg.com',atype:1},'justId':{source:'justtag.com',atype:1},'pubcid':{source:'pubcid.org',atype:1},'tdid':{source:'adserver.org',atype:1,getUidExt:function getUidExt(){return{rtiPartner:'TDID'};}},'id5id':{getValue:function getValue(data){return data.uid;},source:'id5-sync.com',atype:1,getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'ftrackId':{source:'flashtalking.com',atype:1,getValue:function getValue(data){return data.uid;},getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'parrableId':{source:'parrable.com',atype:1,getValue:function getValue(parrableId){if(parrableId.eid){return parrableId.eid;}
if(parrableId.ccpaOptout){return'';}
return null;},getUidExt:function getUidExt(parrableId){var extendedData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.pick)(parrableId,['ibaOptout','ccpaOptout']);if(Object.keys(extendedData).length){return extendedData;}}},'idl_env':{source:'liveramp.com',atype:3},'lipb':{getValue:function getValue(data){return data.lipbid;},source:'liveintent.com',atype:3,getEidExt:function getEidExt(data){if(Array.isArray(data.segments)&&data.segments.length){return{segments:data.segments};}}},'britepoolid':{source:'britepool.com',atype:3},'dmdId':{source:'hcn.health',atype:3},lotamePanoramaId:{source:'crwdcntrl.net',atype:1},'criteoId':{source:'criteo.com',atype:1},'merkleId':{source:'merkleinc.com',atype:3,getValue:function getValue(data){return data.id;},getUidExt:function getUidExt(data){return data&&data.keyID?{keyID:data.keyID}:undefined;}},'netId':{source:'netid.de',atype:1},'IDP':{source:'zeotap.com',atype:1},'hadronId':{source:'audigent.com',atype:1},'haloId':{source:'audigent.com',atype:1},'quantcastId':{source:'quantcast.com',atype:1},'nextrollId':{source:'nextroll.com',atype:1},'idx':{source:'idx.lat',atype:1},'connectid':{source:'verizonmedia.com',atype:3},'fabrickId':{source:'neustar.biz',atype:1},'mwOpenLinkId':{source:'mediawallahscript.com',atype:1},'tapadId':{source:'tapad.com',atype:1},'novatiq':{getValue:function getValue(data){return data.snowflake;},source:'novatiq.com',atype:1},'uid2':{source:'uidapi.com',atype:3,getValue:function getValue(data){return data.id;}},'dapId':{source:'akamai.com',atype:1},'deepintentId':{source:'deepintent.com',atype:3},'admixerId':{source:'admixer.net',atype:3},'adtelligentId':{source:'adtelligent.com',atype:3},amxId:{source:'amxrtb.com',atype:1},'publinkId':{source:'epsilon.com',atype:3},'kpuid':{source:'kpuid.com',atype:3},'imuid':{source:'intimatemerger.com',atype:1},'connectId':{source:'yahoo.com',atype:3},'qid':{source:'adquery.io',atype:1},'dacId':{source:'impact-ad.jp',atype:1},'33acrossId':{source:'33across.com',atype:1,getValue:function getValue(data){return data.envelope;}}};function createEidObject(userIdData,subModuleKey){var conf=USER_IDS_CONFIG[subModuleKey];if(conf&&userIdData){var eid={};eid.source=conf['source'];var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getValue'])?conf['getValue'](userIdData):userIdData;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(value)){var uid={id:value,atype:conf['atype']};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getUidExt'])){var uidExt=conf['getUidExt'](userIdData);if(uidExt){uid.ext=uidExt;}}
eid.uids=[uid];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getEidExt'])){var eidExt=conf['getEidExt'](userIdData);if(eidExt){eid.ext=eidExt;}}
return eid;}}
return null;}
function createEidsArray(bidRequestUserId){var eids=[];for(var subModuleKey in bidRequestUserId){if(bidRequestUserId.hasOwnProperty(subModuleKey)){if(subModuleKey==='pubProvidedId'){eids=eids.concat(bidRequestUserId['pubProvidedId']);}else{var eid=createEidObject(bidRequestUserId[subModuleKey],subModuleKey);if(eid){eids.push(eid);}}}}
return eids;}
function buildEidPermissions(submodules){var eidPermissions=[];submodules.filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).forEach(function(i){Object.keys(i.idObj).forEach(function(key){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(i,'config.bidders')&&Array.isArray(i.config.bidders)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(USER_IDS_CONFIG,key+'.source')){eidPermissions.push({source:USER_IDS_CONFIG[key].source,bidders:i.config.bidders});}});});return eidPermissions;}}),"./modules/userId/index.js":
/*!*********************************!*\
  !*** ./modules/userId/index.js ***!
  \*********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../../src/polyfill.js */
"./src/polyfill.js");var _src_config_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(
/*! ../../src/config.js */
"./src/config.js");var _src_events_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../../src/events.js */
"./src/events.js");var _src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ../../src/prebidGlobal.js */
"./src/prebidGlobal.js");var _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../../src/adapterManager.js */
"./src/adapterManager.js");var _src_constants_json__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ../../src/constants.json */
"./src/constants.json");var _src_hook_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(
/*! ../../src/hook.js */
"./src/hook.js");var _eids_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./eids.js */
"./modules/userId/eids.js");var _src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../../src/storageManager.js */
"./src/storageManager.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../../src/utils.js */
"./node_modules/dlv/index.js");var _src_adserver_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(
/*! ../../src/adserver.js */
"./src/adserver.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var MODULE_NAME='User ID';var COOKIE='cookie';var LOCAL_STORAGE='html5';var DEFAULT_SYNC_DELAY=500;var NO_AUCTION_DELAY=0;var CONSENT_DATA_COOKIE_STORAGE_CONFIG={name:'_pbjs_userid_consent_data',expires:30};var PBJS_USER_ID_OPTOUT_NAME='_pbjs_id_optout';var coreStorage=(0,_src_storageManager_js__WEBPACK_IMPORTED_MODULE_0__.getCoreStorageManager)('userid');var validStorageTypes=[];var addedUserIdHook=false;var submodules=[];var initializedSubmodules;var configRegistry=[];var submoduleRegistry=[];var timeoutID;var syncDelay;var auctionDelay;var ppidSource;var configListener;function setSubmoduleRegistry(submodules){submoduleRegistry=submodules;}
function setStoredValue(submodule,value){var storage=submodule.config.storage;var domainOverride=typeof submodule.submodule.domainOverride==='function'?submodule.submodule.domainOverride():null;try{var valueStr=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(value)?JSON.stringify(value):value;var expiresStr=new Date(Date.now()+storage.expires*(60*60*24*1000)).toUTCString();if(storage.type===COOKIE){coreStorage.setCookie(storage.name,valueStr,expiresStr,'Lax',domainOverride);if(typeof storage.refreshInSeconds==='number'){coreStorage.setCookie("".concat(storage.name,"_last"),new Date().toUTCString(),expiresStr,'Lax',domainOverride);}}else if(storage.type===LOCAL_STORAGE){coreStorage.setDataInLocalStorage("".concat(storage.name,"_exp"),expiresStr);coreStorage.setDataInLocalStorage(storage.name,encodeURIComponent(valueStr));if(typeof storage.refreshInSeconds==='number'){coreStorage.setDataInLocalStorage("".concat(storage.name,"_last"),new Date().toUTCString());}}}catch(error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(error);}}
function setPrebidServerEidPermissions(initializedSubmodules){var setEidPermissions=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.getPrebidInternal)().setEidPermissions;if(typeof setEidPermissions==='function'&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(initializedSubmodules)){setEidPermissions((0,_eids_js__WEBPACK_IMPORTED_MODULE_2__.buildEidPermissions)(initializedSubmodules));}}
function getStoredValue(storage){var key=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var storedKey=key?"".concat(storage.name,"_").concat(key):storage.name;var storedValue;try{if(storage.type===COOKIE){storedValue=coreStorage.getCookie(storedKey);}else if(storage.type===LOCAL_STORAGE){var storedValueExp=coreStorage.getDataFromLocalStorage("".concat(storage.name,"_exp"));if(storedValueExp===''){storedValue=coreStorage.getDataFromLocalStorage(storedKey);}else if(storedValueExp){if(new Date(storedValueExp).getTime()-Date.now()>0){storedValue=decodeURIComponent(coreStorage.getDataFromLocalStorage(storedKey));}}}
if(typeof storedValue==='string'&&storedValue.trim().charAt(0)==='{'){storedValue=JSON.parse(storedValue);}}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(e);}
return storedValue;}
function makeStoredConsentDataHash(consentData){var storedConsentData={consentString:'',gdprApplies:false,apiVersion:0};if(consentData){storedConsentData.consentString=consentData.consentString;storedConsentData.gdprApplies=consentData.gdprApplies;storedConsentData.apiVersion=consentData.apiVersion;}
return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.cyrb53Hash)(JSON.stringify(storedConsentData));}
function setStoredConsentData(consentData){try{var expiresStr=new Date(Date.now()+CONSENT_DATA_COOKIE_STORAGE_CONFIG.expires*(60*60*24*1000)).toUTCString();coreStorage.setCookie(CONSENT_DATA_COOKIE_STORAGE_CONFIG.name,makeStoredConsentDataHash(consentData),expiresStr,'Lax');}catch(error){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(error);}}
function getStoredConsentData(){try{return coreStorage.getCookie(CONSENT_DATA_COOKIE_STORAGE_CONFIG.name);}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)(e);}}
function storedConsentDataMatchesConsentData(storedConsentData,consentData){return typeof storedConsentData!=='undefined'&&storedConsentData!==null&&storedConsentData===makeStoredConsentDataHash(consentData);}
function hasGDPRConsent(consentData){if(consentData&&typeof consentData.gdprApplies==='boolean'&&consentData.gdprApplies){if(!consentData.consentString){return false;}
if(consentData.apiVersion===1&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(consentData,'vendorData.purposeConsents.1')===false){return false;}
if(consentData.apiVersion===2&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(consentData,'vendorData.purpose.consents.1')===false){return false;}}
return true;}
function findRootDomain(){var fullDomain=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window.location.hostname;if(!coreStorage.cookiesAreEnabled()){return fullDomain;}
var domainParts=fullDomain.split('.');if(domainParts.length==2){return fullDomain;}
var rootDomain;var continueSearching;var startIndex=-2;var TEST_COOKIE_NAME="_rdc".concat(Date.now());var TEST_COOKIE_VALUE='writeable';do{rootDomain=domainParts.slice(startIndex).join('.');var expirationDate=new Date((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.timestamp)()+10*1000).toUTCString();coreStorage.setCookie(TEST_COOKIE_NAME,TEST_COOKIE_VALUE,expirationDate,'Lax',rootDomain,undefined);var value=coreStorage.getCookie(TEST_COOKIE_NAME,undefined);if(value===TEST_COOKIE_VALUE){continueSearching=false;coreStorage.setCookie(TEST_COOKIE_NAME,'','Thu, 01 Jan 1970 00:00:01 GMT',undefined,rootDomain,undefined);}else{startIndex+=-1;continueSearching=Math.abs(startIndex)<=domainParts.length;}}while(continueSearching);return rootDomain;}
function processSubmoduleCallbacks(submodules,cb){var done=function done(){};if(cb){done=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.delayExecution)(function(){clearTimeout(timeoutID);cb();},submodules.length);}
submodules.forEach(function(submodule){function callbackCompleted(idObj){if(idObj){if(submodule.config.storage){setStoredValue(submodule,idObj);}
submodule.idObj=submodule.submodule.decode(idObj,submodule.config);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME,": ").concat(submodule.submodule.name," - request id responded with an empty value"));}
done();}
try{submodule.callback(callbackCompleted);}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Error in userID module '".concat(submodule.submodule.name,"':"),e);done();}
submodule.callback=undefined;});}
function getCombinedSubmoduleIds(submodules){if(!Array.isArray(submodules)||!submodules.length){return{};}
var combinedSubmoduleIds=submodules.filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).reduce(function(carry,i){Object.keys(i.idObj).forEach(function(key){carry[key]=i.idObj[key];});return carry;},{});return combinedSubmoduleIds;}
function getSubmoduleId(submodules,sourceName){if(!Array.isArray(submodules)||!submodules.length){return{};}
var submodule=submodules.filter(function(sub){var _USER_IDS_CONFIG$Obje;return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(sub.idObj)&&Object.keys(sub.idObj).length&&((_USER_IDS_CONFIG$Obje=_eids_js__WEBPACK_IMPORTED_MODULE_2__.USER_IDS_CONFIG[Object.keys(sub.idObj)[0]])===null||_USER_IDS_CONFIG$Obje===void 0?void 0:_USER_IDS_CONFIG$Obje.source)===sourceName;});return!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(submodule)?submodule[0].idObj:[];}
function getCombinedSubmoduleIdsForBidder(submodules,bidder){if(!Array.isArray(submodules)||!submodules.length||!bidder){return{};}
return submodules.filter(function(i){return!i.config.bidders||!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(i.config.bidders)||(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.includes)(i.config.bidders,bidder);}).filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).reduce(function(carry,i){Object.keys(i.idObj).forEach(function(key){carry[key]=i.idObj[key];});return carry;},{});}
function addIdDataToAdUnitBids(adUnits,submodules){if([adUnits].some(function(i){return!Array.isArray(i)||!i.length;})){return;}
adUnits.forEach(function(adUnit){if(adUnit.bids&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isArray)(adUnit.bids)){adUnit.bids.forEach(function(bid){var combinedSubmoduleIds=getCombinedSubmoduleIdsForBidder(submodules,bid.bidder);if(Object.keys(combinedSubmoduleIds).length){bid.userId=combinedSubmoduleIds;var eids=(0,_eids_js__WEBPACK_IMPORTED_MODULE_2__.createEidsArray)(combinedSubmoduleIds);var ow_eids=window.owpbjs?window.owpbjs.getUserIdsAsEids():[];var ow_sources=ow_eids.map(function(_ref){var source=_ref.source;return source;});bid.userIdAsEids=eids.filter(function(_ref2){var source=_ref2.source;return!ow_sources.includes(source);}).concat(ow_eids);}});}});}
function delayFor(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});}
var INIT_CANCELED={};function idSystemInitializer(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref3$delay=_ref3.delay,delay=_ref3$delay===void 0?delayFor:_ref3$delay;function breakpoint(){var SUCCESS=0,FAIL=1,RESULT=2;var status={};function finisher(slot){return function(val){if(status[slot]!=null){status[slot](val);}else{status[slot]=true;status[RESULT]=val;}};}
return{promise:new Promise(function(resolve,reject){if(status[SUCCESS]!=null){resolve(status[RESULT]);}else if(status[FAIL]!=null){reject(status[RESULT]);}else{status[SUCCESS]=resolve;status[FAIL]=reject;}}),resolve:finisher(SUCCESS),reject:finisher(FAIL)};}
var startInit=breakpoint();var startCallbacks=breakpoint();var cancel;var initialized=false;function cancelAndTry(promise){if(cancel!=null){cancel.reject(INIT_CANCELED);}
cancel=breakpoint();return Promise.race([promise,cancel.promise]);}
var initModules=initializedSubmodules;var allModules=submodules;function checkRefs(fn){return function(){if(initModules===initializedSubmodules&&allModules===submodules){return fn.apply(void 0,arguments);}};}
var done=cancelAndTry(startInit.promise.then(function(){return _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_5__.gdprDataHandler.promise;}).then(checkRefs(function(consentData){initSubmodules(initModules,allModules,consentData);})).then(function(){return startCallbacks.promise;}).then(checkRefs(function(){var modWithCb=initModules.filter(function(item){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(item.callback);});if(modWithCb.length){return new Promise(function(resolve){return processSubmoduleCallbacks(modWithCb,resolve);});}})));return function(){var _ref4=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref4$refresh=_ref4.refresh,refresh=_ref4$refresh===void 0?false:_ref4$refresh,_ref4$submoduleNames=_ref4.submoduleNames,submoduleNames=_ref4$submoduleNames===void 0?null:_ref4$submoduleNames,_ref4$ready=_ref4.ready,ready=_ref4$ready===void 0?false:_ref4$ready;if(ready&&!initialized){initialized=true;startInit.resolve();if(auctionDelay>0){startCallbacks.resolve();}else{_src_events_js__WEBPACK_IMPORTED_MODULE_6__.on(_src_constants_json__WEBPACK_IMPORTED_MODULE_7__.EVENTS.AUCTION_END,function auctionEndHandler(){_src_events_js__WEBPACK_IMPORTED_MODULE_6__.off(_src_constants_json__WEBPACK_IMPORTED_MODULE_7__.EVENTS.AUCTION_END,auctionEndHandler);delay(syncDelay).then(startCallbacks.resolve);});}}
if(refresh){done=cancelAndTry(done.catch(function(){return null;}).then(function(){return _src_adapterManager_js__WEBPACK_IMPORTED_MODULE_5__.gdprDataHandler.promise;}).then(checkRefs(function(consentData){var cbModules=initSubmodules(initModules,allModules.filter(function(sm){return submoduleNames==null||submoduleNames.includes(sm.submodule.name);}),consentData,true).filter(function(sm){return sm.callback!=null;});if(cbModules.length){return new Promise(function(resolve){return processSubmoduleCallbacks(cbModules,resolve);});}})));}
return done;};}
var initIdSystem;function getPPID(){var matchingUserId=ppidSource&&(getUserIdsAsEids()||[]).find(function(userID){return userID.source===ppidSource;});if(matchingUserId&&typeof(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_3__["default"])(matchingUserId,'uids.0.id')==='string'){var ppidValue=matchingUserId.uids[0].id.replace(/[\W_]/g,'');if(ppidValue.length>=32&&ppidValue.length<=150){return ppidValue;}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("User ID - Googletag Publisher Provided ID for ".concat(ppidSource," is not between 32 and 150 characters - ").concat(ppidValue));}}}
function requestBidsHook(fn,reqBidsConfigObj){var _this=this;var _ref5=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref5$delay=_ref5.delay,delay=_ref5$delay===void 0?delayFor:_ref5$delay;Promise.race([getUserIdsAsync(),delay(auctionDelay)]).then(function(){addIdDataToAdUnitBids(reqBidsConfigObj.adUnits||(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().adUnits,initializedSubmodules);var ppid=getPPID();if(ppid){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isGptPubadsDefined)()){window.googletag.pubads().setPublisherProvidedId(ppid);}else{window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];window.googletag.cmd.push(function(){window.googletag.pubads().setPublisherProvidedId(ppid);});}}
fn.call(_this,reqBidsConfigObj);});}
function getUserIds(){return getCombinedSubmoduleIds(initializedSubmodules);}
function getUserIdsAsEids(){return(0,_eids_js__WEBPACK_IMPORTED_MODULE_2__.createEidsArray)(getUserIds());}
function getUserIdsAsEidBySource(sourceName){return(0,_eids_js__WEBPACK_IMPORTED_MODULE_2__.createEidsArray)(getSubmoduleId(initializedSubmodules,sourceName))[0];}
function getEncryptedEidsForSource(source,encrypt,customFunction){return initIdSystem().then(function(){var eidsSignals={};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(customFunction)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - Getting encrypted signal from custom function : ").concat(customFunction.name," & source : ").concat(source," "));var customSignals=customFunction(source);eidsSignals[source]=customSignals?encryptSignals(customSignals):null;}else{var eid=getUserIdsAsEidBySource(source);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - Getting encrypted signal for eids :").concat(JSON.stringify(eid)));if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(eid)){eidsSignals[eid.source]=encrypt===true?encryptSignals(eid):eid.uids[0].id;}}
(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - Fetching encrypted eids: ").concat(eidsSignals[source]));return eidsSignals[source];});}
function encryptSignals(signals){var version=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var encryptedSig='';switch(version){case 1:encryptedSig=_typeof(signals)==='object'?window.btoa(JSON.stringify(signals)):window.btoa(signals);break;default:break;}
return"".concat(version,"||").concat(encryptedSig);}
function registerSignalSources(){if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isGptPubadsDefined)()){return;}
window.googletag.encryptedSignalProviders=window.googletag.encryptedSignalProviders||[];var encryptedSignalSources=_src_config_js__WEBPACK_IMPORTED_MODULE_9__.config.getConfig('userSync.encryptedSignalSources');if(encryptedSignalSources){var registerDelay=encryptedSignalSources.registerDelay||0;setTimeout(function(){encryptedSignalSources['sources']&&encryptedSignalSources['sources'].forEach(function(_ref6){var source=_ref6.source,encrypt=_ref6.encrypt,customFunc=_ref6.customFunc;source.forEach(function(src){window.googletag.encryptedSignalProviders.push({id:src,collectorFunction:function collectorFunction(){return getEncryptedEidsForSource(src,encrypt,customFunc);}});});});},registerDelay);}else{(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("".concat(MODULE_NAME," - ESP : encryptedSignalSources config not defined under userSync Object"));}}
function refreshUserIds(){var _ref7=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},submoduleNames=_ref7.submoduleNames;var callback=arguments.length>1?arguments[1]:undefined;return initIdSystem({refresh:true,submoduleNames:submoduleNames}).then(function(){if(callback&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isFn)(callback)){callback();}
return getUserIds();});}
function getUserIdsAsync(){return initIdSystem().then(function(){return getUserIds();},function(e){return e===INIT_CANCELED?getUserIdsAsync():Promise.reject(e);});}
var validateGdprEnforcement=(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_10__.hook)('sync',function(submodules,consentData){return{userIdModules:submodules,hasValidated:consentData&&consentData.hasValidated};},'validateGdprEnforcement');function populateSubmoduleId(submodule,consentData,storedConsentData,forceRefresh){if(submodule.config.storage){var storedId=getStoredValue(submodule.config.storage);var response;var refreshNeeded=false;if(typeof submodule.config.storage.refreshInSeconds==='number'){var storedDate=new Date(getStoredValue(submodule.config.storage,'last'));refreshNeeded=storedDate&&Date.now()-storedDate.getTime()>submodule.config.storage.refreshInSeconds*1000;}
if(!storedId||refreshNeeded||forceRefresh||!storedConsentDataMatchesConsentData(storedConsentData,consentData)){response=submodule.submodule.getId(submodule.config,consentData,storedId);}else if(typeof submodule.submodule.extendId==='function'){response=submodule.submodule.extendId(submodule.config,consentData,storedId);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(response)){if(response.id){setStoredValue(submodule,response.id);storedId=response.id;}
if(typeof response.callback==='function'){submodule.callback=response.callback;}}
if(storedId){submodule.idObj=submodule.submodule.decode(storedId,submodule.config);}}else if(submodule.config.value){submodule.idObj=submodule.config.value;}else{var _response=submodule.submodule.getId(submodule.config,consentData,undefined);if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(_response)){if(typeof _response.callback==='function'){submodule.callback=_response.callback;}
if(_response.id){submodule.idObj=submodule.submodule.decode(_response.id,submodule.config);}}}}
function initSubmodules(dest,submodules,consentData){var forceRefresh=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var _validateGdprEnforcem=validateGdprEnforcement(submodules,consentData),userIdModules=_validateGdprEnforcem.userIdModules,hasValidated=_validateGdprEnforcem.hasValidated;if(!hasValidated&&!hasGDPRConsent(consentData)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logWarn)("".concat(MODULE_NAME," - gdpr permission not valid for local storage or cookies, exit module"));return[];}
var storedConsentData=getStoredConsentData();setStoredConsentData(consentData);var initialized=userIdModules.reduce(function(carry,submodule){try{populateSubmoduleId(submodule,consentData,storedConsentData,forceRefresh);carry.push(submodule);}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logError)("Error in userID module '".concat(submodule.submodule.name,"':"),e);}
return carry;},[]);if(initialized.length){setPrebidServerEidPermissions(initialized);}
initialized.forEach(updateInitializedSubmodules.bind(null,dest));return initialized;}
function updateInitializedSubmodules(dest,submodule){var updated=false;for(var i=0;i<dest.length;i++){if(submodule.config.name.toLowerCase()===dest[i].config.name.toLowerCase()){updated=true;dest[i]=submodule;break;}}
if(!updated){dest.push(submodule);}}
function getValidSubmoduleConfigs(configRegistry,submoduleRegistry,activeStorageTypes){if(!Array.isArray(configRegistry)){return[];}
return configRegistry.reduce(function(carry,config){if(!config||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmptyStr)(config.name)){return carry;}
if(config.storage&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmptyStr)(config.storage.type)&&!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isEmptyStr)(config.storage.name)&&activeStorageTypes.indexOf(config.storage.type)!==-1){carry.push(config);}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(config.value)){carry.push(config);}else if(!config.storage&&!config.value){carry.push(config);}
return carry;},[]);}
function updateSubmodules(){var configs=getValidSubmoduleConfigs(configRegistry,submoduleRegistry,validStorageTypes);if(!configs.length){return;}
var addedSubmodules=submoduleRegistry.filter(function(i){return!(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.find)(submodules,function(j){return j.name===i.name;});});submodules.splice(0,submodules.length);addedSubmodules.map(function(i){var submoduleConfig=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.find)(configs,function(j){return j.name&&(j.name.toLowerCase()===i.name.toLowerCase()||i.aliasName&&j.name.toLowerCase()===i.aliasName.toLowerCase());});if(submoduleConfig&&i.name!==submoduleConfig.name)submoduleConfig.name=i.name;i.findRootDomain=findRootDomain;return submoduleConfig?{submodule:i,config:submoduleConfig,callback:undefined,idObj:undefined}:null;}).filter(function(submodule){return submodule!==null;}).forEach(function(sm){return submodules.push(sm);});if(!addedUserIdHook&&submodules.length){(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().requestBids.before(requestBidsHook,40);_src_adserver_js__WEBPACK_IMPORTED_MODULE_11__.getPPID.after(function(next){return next(getPPID());});(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - usersync config updated for ").concat(submodules.length," submodules: "),submodules.map(function(a){return a.submodule.name;}));addedUserIdHook=true;}}
function attachIdSystem(submodule){if(!(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.find)(submoduleRegistry,function(i){return i.name===submodule.name;})){submoduleRegistry.push(submodule);updateSubmodules();}}
function init(config){var _ref8=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref8$delay=_ref8.delay,delay=_ref8$delay===void 0?delayFor:_ref8$delay;ppidSource=undefined;submodules=[];configRegistry=[];addedUserIdHook=false;initializedSubmodules=[];initIdSystem=idSystemInitializer({delay:delay});if(configListener!=null){configListener();}
submoduleRegistry=[];validStorageTypes=[coreStorage.localStorageIsEnabled()?LOCAL_STORAGE:null,coreStorage.cookiesAreEnabled()?COOKIE:null].filter(function(i){return i!==null;});if(validStorageTypes.indexOf(COOKIE)!==-1&&coreStorage.getCookie(PBJS_USER_ID_OPTOUT_NAME)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - opt-out cookie found, exit module"));return;}
if(validStorageTypes.indexOf(LOCAL_STORAGE)!==-1&&coreStorage.getDataFromLocalStorage(PBJS_USER_ID_OPTOUT_NAME)){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.logInfo)("".concat(MODULE_NAME," - opt-out localStorage found, exit module"));return;}
configListener=config.getConfig('userSync',function(conf){var userSync=conf.userSync;ppidSource=userSync.ppid;if(userSync&&userSync.userIds){configRegistry=userSync.userIds;syncDelay=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isNumber)(userSync.syncDelay)?userSync.syncDelay:DEFAULT_SYNC_DELAY;auctionDelay=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__.isNumber)(userSync.auctionDelay)?userSync.auctionDelay:NO_AUCTION_DELAY;updateSubmodules();initIdSystem({ready:true});}});(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().getUserIds=getUserIds;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().getUserIdsAsEids=getUserIdsAsEids;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().getEncryptedEidsForSource=getEncryptedEidsForSource;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().registerSignalSources=registerSignalSources;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().refreshUserIds=refreshUserIds;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().getUserIdsAsync=getUserIdsAsync;(0,_src_prebidGlobal_js__WEBPACK_IMPORTED_MODULE_8__.getGlobal)().getUserIdsAsEidBySource=getUserIdsAsEidBySource;}
init(_src_config_js__WEBPACK_IMPORTED_MODULE_9__.config);(0,_src_hook_js__WEBPACK_IMPORTED_MODULE_10__.module)('userId',attachIdSystem);window.pbjs.installedModules.push('userId');}),"./src/adserver.js":
/*!*************************!*\
  !*** ./src/adserver.js ***!
  \*************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{"getPPID":function(){return getPPID;}});var _utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./utils.js */
"./src/utils.js");var _targeting_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./targeting.js */
"./src/targeting.js");var _hook_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./hook.js */
"./src/hook.js");var AdServer=function AdServer(attr){this.name=attr.adserver;this.code=attr.code;this.getWinningBidByCode=function(){return _targeting_js__WEBPACK_IMPORTED_MODULE_0__.targeting.getWinningBids(this.code)[0];};};function dfpAdserver(options,urlComponents){var adserver=new AdServer(options);adserver.urlComponents=urlComponents;var dfpReqParams={'env':'vp','gdfp_req':'1','impl':'s','unviewed_position_start':'1'};var dfpParamsWithVariableValue=['output','iu','sz','url','correlator','description_url','hl'];var getCustomParams=function getCustomParams(targeting){return encodeURIComponent((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.formatQS)(targeting));};adserver.appendQueryParams=function(){var bid=adserver.getWinningBidByCode();if(bid){this.urlComponents.search.description_url=encodeURIComponent(bid.vastUrl);this.urlComponents.search.cust_params=getCustomParams(bid.adserverTargeting);this.urlComponents.search.correlator=Date.now();}};adserver.verifyAdserverTag=function(){for(var key in dfpReqParams){if(!this.urlComponents.search.hasOwnProperty(key)||this.urlComponents.search[key]!==dfpReqParams[key]){return false;}}
for(var i in dfpParamsWithVariableValue){if(!this.urlComponents.search.hasOwnProperty(dfpParamsWithVariableValue[i])){return false;}}
return true;};return adserver;};var getPPID=(0,_hook_js__WEBPACK_IMPORTED_MODULE_2__.hook)('sync',function(){return undefined;});})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/userId/index.js"));}]);"use strict";(self["pbjsChunk"]=self["pbjsChunk"]||[]).push([["yieldmoBidAdapter"],{"./modules/userId/eids.js":
/*!********************************!*\
  !*** ./modules/userId/eids.js ***!
  \********************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{"USER_IDS_CONFIG":function(){return USER_IDS_CONFIG;},"buildEidPermissions":function(){return buildEidPermissions;},"createEidsArray":function(){return createEidsArray;}});var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../../src/utils.js */
"./node_modules/dlv/index.js");var USER_IDS_CONFIG={'trustpid':{source:'trustpid.com',atype:1,getValue:function getValue(data){return data;}},'intentIqId':{source:'intentiq.com',atype:1},'naveggId':{source:'navegg.com',atype:1},'justId':{source:'justtag.com',atype:1},'pubcid':{source:'pubcid.org',atype:1},'tdid':{source:'adserver.org',atype:1,getUidExt:function getUidExt(){return{rtiPartner:'TDID'};}},'id5id':{getValue:function getValue(data){return data.uid;},source:'id5-sync.com',atype:1,getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'ftrackId':{source:'flashtalking.com',atype:1,getValue:function getValue(data){return data.uid;},getUidExt:function getUidExt(data){if(data.ext){return data.ext;}}},'parrableId':{source:'parrable.com',atype:1,getValue:function getValue(parrableId){if(parrableId.eid){return parrableId.eid;}
if(parrableId.ccpaOptout){return'';}
return null;},getUidExt:function getUidExt(parrableId){var extendedData=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.pick)(parrableId,['ibaOptout','ccpaOptout']);if(Object.keys(extendedData).length){return extendedData;}}},'idl_env':{source:'liveramp.com',atype:3},'lipb':{getValue:function getValue(data){return data.lipbid;},source:'liveintent.com',atype:3,getEidExt:function getEidExt(data){if(Array.isArray(data.segments)&&data.segments.length){return{segments:data.segments};}}},'britepoolid':{source:'britepool.com',atype:3},'dmdId':{source:'hcn.health',atype:3},lotamePanoramaId:{source:'crwdcntrl.net',atype:1},'criteoId':{source:'criteo.com',atype:1},'merkleId':{source:'merkleinc.com',atype:3,getValue:function getValue(data){return data.id;},getUidExt:function getUidExt(data){return data&&data.keyID?{keyID:data.keyID}:undefined;}},'netId':{source:'netid.de',atype:1},'IDP':{source:'zeotap.com',atype:1},'hadronId':{source:'audigent.com',atype:1},'haloId':{source:'audigent.com',atype:1},'quantcastId':{source:'quantcast.com',atype:1},'nextrollId':{source:'nextroll.com',atype:1},'idx':{source:'idx.lat',atype:1},'connectid':{source:'verizonmedia.com',atype:3},'fabrickId':{source:'neustar.biz',atype:1},'mwOpenLinkId':{source:'mediawallahscript.com',atype:1},'tapadId':{source:'tapad.com',atype:1},'novatiq':{getValue:function getValue(data){return data.snowflake;},source:'novatiq.com',atype:1},'uid2':{source:'uidapi.com',atype:3,getValue:function getValue(data){return data.id;}},'dapId':{source:'akamai.com',atype:1},'deepintentId':{source:'deepintent.com',atype:3},'admixerId':{source:'admixer.net',atype:3},'adtelligentId':{source:'adtelligent.com',atype:3},amxId:{source:'amxrtb.com',atype:1},'publinkId':{source:'epsilon.com',atype:3},'kpuid':{source:'kpuid.com',atype:3},'imuid':{source:'intimatemerger.com',atype:1},'connectId':{source:'yahoo.com',atype:3},'qid':{source:'adquery.io',atype:1},'dacId':{source:'impact-ad.jp',atype:1},'33acrossId':{source:'33across.com',atype:1,getValue:function getValue(data){return data.envelope;}}};function createEidObject(userIdData,subModuleKey){var conf=USER_IDS_CONFIG[subModuleKey];if(conf&&userIdData){var eid={};eid.source=conf['source'];var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getValue'])?conf['getValue'](userIdData):userIdData;if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isStr)(value)){var uid={id:value,atype:conf['atype']};if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getUidExt'])){var uidExt=conf['getUidExt'](userIdData);if(uidExt){uid.ext=uidExt;}}
eid.uids=[uid];if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isFn)(conf['getEidExt'])){var eidExt=conf['getEidExt'](userIdData);if(eidExt){eid.ext=eidExt;}}
return eid;}}
return null;}
function createEidsArray(bidRequestUserId){var eids=[];for(var subModuleKey in bidRequestUserId){if(bidRequestUserId.hasOwnProperty(subModuleKey)){if(subModuleKey==='pubProvidedId'){eids=eids.concat(bidRequestUserId['pubProvidedId']);}else{var eid=createEidObject(bidRequestUserId[subModuleKey],subModuleKey);if(eid){eids.push(eid);}}}}
return eids;}
function buildEidPermissions(submodules){var eidPermissions=[];submodules.filter(function(i){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(i.idObj)&&Object.keys(i.idObj).length;}).forEach(function(i){Object.keys(i.idObj).forEach(function(key){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(i,'config.bidders')&&Array.isArray(i.config.bidders)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_1__["default"])(USER_IDS_CONFIG,key+'.source')){eidPermissions.push({source:USER_IDS_CONFIG[key].source,bidders:i.config.bidders});}});});return eidPermissions;}}),"./modules/yieldmoBidAdapter.js":
/*!**************************************!*\
  !*** ./modules/yieldmoBidAdapter.js ***!
  \**************************************/
(function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _src_utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../src/utils.js */
"./src/utils.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dlv/index.js");var _src_utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ../src/utils.js */
"./node_modules/dset/dist/dset.es.js");var _src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../src/mediaTypes.js */
"./src/mediaTypes.js");var _src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ../src/adapters/bidderFactory.js */
"./src/adapters/bidderFactory.js");var _src_Renderer_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ../src/Renderer.js */
"./src/Renderer.js");var _src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ../src/polyfill.js */
"./src/polyfill.js");var _userId_eids_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./userId/eids.js */
"./modules/userId/eids.js");function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}
var BIDDER_CODE='yieldmo';var CURRENCY='USD';var TIME_TO_LIVE=300;var NET_REVENUE=true;var BANNER_SERVER_ENDPOINT='https://ads.yieldmo.com/exchange/prebid';var VIDEO_SERVER_ENDPOINT='https://ads.yieldmo.com/exchange/prebidvideo';var OUTSTREAM_VIDEO_PLAYER_URL='https://prebid-outstream.yieldmo.com/bundle.js';var OPENRTB_VIDEO_BIDPARAMS=['mimes','startdelay','placement','startdelay','skipafter','protocols','api','playbackmethod','maxduration','minduration','pos','skip','skippable'];var OPENRTB_VIDEO_SITEPARAMS=['name','domain','cat','keywords'];var LOCAL_WINDOW=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getWindowTop)();var DEFAULT_PLAYBACK_METHOD=2;var DEFAULT_START_DELAY=0;var VAST_TIMEOUT=15000;var MAX_BANNER_REQUEST_URL_LENGTH=8000;var BANNER_REQUEST_PROPERTIES_TO_REDUCE=['description','title','pr','page_url'];var spec={code:BIDDER_CODE,supportedMediaTypes:[_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO],isBidRequestValid:function isBidRequestValid(bid){return!!(bid&&bid.adUnitCode&&bid.bidId&&(hasBannerMediaType(bid)||hasVideoMediaType(bid))&&validateVideoParams(bid));},buildRequests:function buildRequests(bidRequests,bidderRequest){var bannerBidRequests=bidRequests.filter(function(request){return hasBannerMediaType(request);});var videoBidRequests=bidRequests.filter(function(request){return hasVideoMediaType(request);});var serverRequests=[];var eids=getEids(bidRequests[0])||[];if(bannerBidRequests.length>0){var serverRequest={pbav:"6.24.1",p:[],page_url:bidderRequest.refererInfo.referer,bust:new Date().getTime().toString(),dnt:getDNT(),description:getPageDescription(),userConsent:JSON.stringify({gdprApplies:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'gdprConsent.gdprApplies')||'',cmp:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'gdprConsent.consentString')||''}),us_privacy:(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'uspConsent')||''};if(canAccessTopWindow()){serverRequest.pr=LOCAL_WINDOW.document&&LOCAL_WINDOW.document.referrer||'';serverRequest.scrd=LOCAL_WINDOW.devicePixelRatio||0;serverRequest.title=LOCAL_WINDOW.document.title||'';serverRequest.w=LOCAL_WINDOW.innerWidth;serverRequest.h=LOCAL_WINDOW.innerHeight;}
var mtp=window.navigator.maxTouchPoints;if(mtp){serverRequest.mtp=mtp;}
bannerBidRequests.forEach(function(request){serverRequest.p.push(addPlacement(request));var pubcid=getId(request,'pubcid');if(pubcid){serverRequest.pubcid=pubcid;}else if(request.crumbs&&request.crumbs.pubcid){serverRequest.pubcid=request.crumbs.pubcid;}
var tdid=getId(request,'tdid');if(tdid){serverRequest.tdid=tdid;}
var criteoId=getId(request,'criteoId');if(criteoId){serverRequest.cri_prebid=criteoId;}
if(request.schain){serverRequest.schain=JSON.stringify(request.schain);}
if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(request,'params.lr_env')){serverRequest.ats_envelope=request.params.lr_env;}});serverRequest.p='['+serverRequest.p.toString()+']';if(eids.length){serverRequest.eids=JSON.stringify(eids);};var url="".concat(BANNER_SERVER_ENDPOINT,"?").concat((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.parseQueryStringParameters)(serverRequest));var extraCharacters=url.length-MAX_BANNER_REQUEST_URL_LENGTH;if(extraCharacters>0){for(var i=0;i<BANNER_REQUEST_PROPERTIES_TO_REDUCE.length;i++){extraCharacters=shortcutProperty(extraCharacters,serverRequest,BANNER_REQUEST_PROPERTIES_TO_REDUCE[i]);if(extraCharacters<=0){break;}}}
serverRequests.push({method:'GET',url:BANNER_SERVER_ENDPOINT,data:serverRequest});}
if(videoBidRequests.length>0){var _serverRequest=openRtbRequest(videoBidRequests,bidderRequest);if(eids.length){_serverRequest.user={eids:eids};};serverRequests.push({method:'POST',url:VIDEO_SERVER_ENDPOINT,data:_serverRequest});}
return serverRequests;},interpretResponse:function interpretResponse(serverResponse,bidRequest){var bids=[];var data=serverResponse.body;if(data.length>0){data.forEach(function(response){if(response.cpm>0){bids.push(createNewBannerBid(response));}});}
if(data.seatbid){var seatbids=data.seatbid.reduce(function(acc,seatBid){return acc.concat(seatBid.bid);},[]);seatbids.forEach(function(bid){return bids.push(createNewVideoBid(bid,bidRequest));});}
return bids;},getUserSyncs:function getUserSyncs(){return[];}};(0,_src_adapters_bidderFactory_js__WEBPACK_IMPORTED_MODULE_3__.registerBidder)(spec);function hasBannerMediaType(bidRequest){return!!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'mediaTypes.banner');}
function hasVideoMediaType(bidRequest){return!!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'mediaTypes.video');}
function addPlacement(request){var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(request,'ortb2Imp.ext.data.pbadslot');var placementInfo={placement_id:request.adUnitCode,callback_id:request.bidId,sizes:request.mediaTypes.banner.sizes};if(request.params){if(request.params.placementId){placementInfo.ym_placement_id=request.params.placementId;}
var bidfloor=getBidFloor(request,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER);if(bidfloor){placementInfo.bidFloor=bidfloor;}}
if(gpid){placementInfo.gpid=gpid;}
return JSON.stringify(placementInfo);}
function createNewBannerBid(response){return{dealId:response.publisherDealId,requestId:response['callback_id'],cpm:response.cpm,width:response.width,height:response.height,creativeId:response.creative_id,currency:CURRENCY,netRevenue:NET_REVENUE,ttl:TIME_TO_LIVE,ad:response.ad,meta:{advertiserDomains:response.adomain||[],mediaType:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.BANNER}};}
function createNewVideoBid(response,bidRequest){var imp=(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.find)((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'data.imp')||[],function(imp){return imp.id===response.impid;});var result={dealId:response.dealid,requestId:imp.id,cpm:response.price,width:imp.video.w,height:imp.video.h,creativeId:response.crid||response.adid,currency:CURRENCY,netRevenue:NET_REVENUE,mediaType:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO,ttl:TIME_TO_LIVE,vastXml:response.adm,meta:{advertiserDomains:response.adomain||[],mediaType:_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO}};if(imp.video.placement&&imp.video.placement!==1){var renderer=_src_Renderer_js__WEBPACK_IMPORTED_MODULE_5__.Renderer.install({url:OUTSTREAM_VIDEO_PLAYER_URL,config:{width:result.width,height:result.height,vastTimeout:VAST_TIMEOUT,maxAllowedVastTagRedirects:5,allowVpaid:true,autoPlay:true,preload:true,mute:true},id:imp.tagid,loaded:false});renderer.setRender(function(){});result.renderer=renderer;}
return result;}
function getDNT(){return window.doNotTrack==='1'||window.navigator.doNotTrack==='1'||false;}
function getPageDescription(){if(document.querySelector('meta[name="description"]')){return document.querySelector('meta[name="description"]').getAttribute('content')||'';}else{return'';}}
function getId(request,idType){return _typeof((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(request,'userId'))==='object'?request.userId[idType]:undefined;}
function openRtbRequest(bidRequests,bidderRequest){var schain=bidRequests[0].schain;var openRtbRequest={id:bidRequests[0].bidderRequestId,at:1,imp:bidRequests.map(function(bidRequest){return openRtbImpression(bidRequest);}),site:openRtbSite(bidRequests[0],bidderRequest),device:openRtbDevice(bidRequests[0]),badv:bidRequests[0].params.badv||[],bcat:bidRequests[0].params.bcat||[],ext:{prebid:"6.24.1"},ats_envelope:bidRequests[0].params.lr_env};if(schain){openRtbRequest.schain=schain;}
populateOpenRtbGdpr(openRtbRequest,bidderRequest);return openRtbRequest;}
function openRtbImpression(bidRequest){var gpid=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'ortb2Imp.ext.data.pbadslot');var size=extractPlayerSize(bidRequest);var imp={id:bidRequest.bidId,tagid:bidRequest.adUnitCode,bidfloor:getBidFloor(bidRequest,_src_mediaTypes_js__WEBPACK_IMPORTED_MODULE_1__.VIDEO),ext:{placement_id:bidRequest.params.placementId},video:{w:size[0],h:size[1],linearity:1}};var mediaTypesParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'mediaTypes.video');Object.keys(mediaTypesParams).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.includes)(OPENRTB_VIDEO_BIDPARAMS,param);}).forEach(function(param){return imp.video[param]=mediaTypesParams[param];});var videoParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'params.video');Object.keys(videoParams).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.includes)(OPENRTB_VIDEO_BIDPARAMS,param);}).forEach(function(param){return imp.video[param]=videoParams[param];});if(imp.video.skippable){imp.video.skip=1;delete imp.video.skippable;}
if(imp.video.placement!==1){imp.video.startdelay=DEFAULT_START_DELAY;imp.video.playbackmethod=[DEFAULT_PLAYBACK_METHOD];}
if(gpid){imp.ext.gpid=gpid;}
return imp;}
function getBidFloor(bidRequest,mediaType){var floorInfo={};if(typeof bidRequest.getFloor==='function'){floorInfo=bidRequest.getFloor({currency:CURRENCY,mediaType:mediaType,size:'*'});}
return floorInfo.floor||bidRequest.params.bidfloor||bidRequest.params.bidFloor||0;}
function extractPlayerSize(bidRequest){var sizeArr=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'mediaTypes.video.playerSize');if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArrayOfNums)(sizeArr,2)){return sizeArr;}else if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(sizeArr)&&(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArrayOfNums)(sizeArr[0],2)){return sizeArr[0];}
return null;}
function openRtbSite(bidRequest,bidderRequest){var result={};var loc=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.parseUrl)((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'refererInfo.referer'));if(!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty)(loc)){result.page="".concat(loc.protocol,"://").concat(loc.hostname).concat(loc.pathname);}
if(self===top&&document.referrer){result.ref=document.referrer;}
var keywords=document.getElementsByTagName('meta')['keywords'];if(keywords&&keywords.content){result.keywords=keywords.content;}
var siteParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'params.site');if(siteParams){Object.keys(siteParams).filter(function(param){return(0,_src_polyfill_js__WEBPACK_IMPORTED_MODULE_4__.includes)(OPENRTB_VIDEO_SITEPARAMS,param);}).forEach(function(param){return result[param]=siteParams[param];});}
return result;}
function openRtbDevice(bidRequest){var deviceObj={ua:navigator.userAgent,language:navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage};return deviceObj;}
function populateOpenRtbGdpr(openRtbRequest,bidderRequest){var gdpr=bidderRequest.gdprConsent;if(gdpr&&'gdprApplies'in gdpr){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(openRtbRequest,'regs.ext.gdpr',gdpr.gdprApplies?1:0);(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(openRtbRequest,'user.ext.consent',gdpr.consentString);}
var uspConsent=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidderRequest,'uspConsent');if(uspConsent){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_6__["default"])(openRtbRequest,'regs.ext.us_privacy',uspConsent);}}
function validateVideoParams(bid){if(!hasVideoMediaType(bid)){return true;}
var paramRequired=function paramRequired(paramStr,value,conditionStr){var error="\"".concat(paramStr,"\" is required");if(conditionStr){error+=' when '+conditionStr;}
throw new Error(error);};var paramInvalid=function paramInvalid(paramStr,value,expectedStr){expectedStr=expectedStr?', expected: '+expectedStr:'';value=JSON.stringify(value);throw new Error("\"".concat(paramStr,"\"=").concat(value," is invalid").concat(expectedStr));};var isDefined=function isDefined(val){return typeof val!=='undefined';};var validate=function validate(fieldPath,validateCb,errorCb,errorCbParam){if(fieldPath.indexOf('video')===0){var valueFieldPath='params.'+fieldPath;var mediaFieldPath='mediaTypes.'+fieldPath;var valueParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,valueFieldPath);var mediaTypesParams=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,mediaFieldPath);var hasValidValueParams=validateCb(valueParams);var hasValidMediaTypesParams=validateCb(mediaTypesParams);if(hasValidValueParams)return valueParams;else if(hasValidMediaTypesParams)return hasValidMediaTypesParams;else{if(!hasValidValueParams)errorCb(valueFieldPath,valueParams,errorCbParam);else if(!hasValidMediaTypesParams)errorCb(mediaFieldPath,mediaTypesParams,errorCbParam);}
return valueParams||mediaTypesParams;}else{var value=(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bid,fieldPath);if(!validateCb(value)){errorCb(fieldPath,value,errorCbParam);}
return value;}};try{validate('video.context',function(val){return!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty)(val);},paramRequired);validate('params.placementId',function(val){return!(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isEmpty)(val);},paramRequired);validate('video.playerSize',function(){},paramInvalid,'array of 2 integers, ex: [640,480] or [[640,480]]');validate('video.mimes',function(val){return isDefined(val);},paramRequired);validate('video.mimes',function(){},paramInvalid,'array of strings, ex: ["video/mp4"]');var placement=validate('video.placement',function(val){return isDefined(val);},paramRequired);validate('video.placement',function(val){return val>=1&&val<=5;},paramInvalid);if(placement===1){validate('video.startdelay',function(val){return isDefined(val);},function(field,v){return paramRequired(field,v,'placement == 1');});validate('video.startdelay',function(val){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(val);},paramInvalid,'number, ex: 5');}
validate('video.protocols',function(val){return isDefined(val);},paramRequired);validate('video.protocols',function(){},paramInvalid,'array of numbers, ex: [2,3]');validate('video.api',function(val){return isDefined(val);},paramRequired);validate('video.api',function(val){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArrayOfNums)(val)&&val.every(function(v){return v>=1&&v<=6;});},paramInvalid,'array of numbers, ex: [2,3]');validate('video.playbackmethod',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArrayOfNums)(val);},paramInvalid,'array of integers, ex: [2,6]');validate('video.maxduration',function(val){return isDefined(val);},paramRequired);validate('video.maxduration',function(val){return(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isInteger)(val);},paramInvalid);validate('video.minduration',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(val);},paramInvalid);validate('video.skippable',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isBoolean)(val);},paramInvalid);validate('video.skipafter',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isNumber)(val);},paramInvalid);validate('video.pos',function(){},paramInvalid);validate('params.badv',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(val);},paramInvalid,'array of strings, ex: ["ford.com","pepsi.com"]');validate('params.bcat',function(val){return!isDefined(val)||(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(val);},paramInvalid,'array of strings, ex: ["IAB1-5","IAB1-6"]');return true;}catch(e){(0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.logError)(e.message);return false;}}
function shortcutProperty(extraCharacters,target,propertyName){if(target[propertyName].length>extraCharacters){target[propertyName]=target[propertyName].substring(0,target[propertyName].length-extraCharacters);return 0;}
var charactersLeft=extraCharacters-target[propertyName].length;target[propertyName]='';return charactersLeft;}
function getEids(bidRequest){if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_2__["default"])(bidRequest,'userId')){return(0,_userId_eids_js__WEBPACK_IMPORTED_MODULE_7__.createEidsArray)(bidRequest.userId)||[];}};function canAccessTopWindow(){try{if((0,_src_utils_js__WEBPACK_IMPORTED_MODULE_0__.getWindowTop)().location.href){return true;}}catch(error){return false;}}
window.pbjs.installedModules.push('yieldmoBidAdapter');})},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId);}
var __webpack_exports__=(__webpack_exec__("./modules/yieldmoBidAdapter.js"));}]);pbjs.processQueue();;(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports;}
var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter});}};__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'});}
Object.defineProperty(exports,'__esModule',{value:true});};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if((mode&4)&&typeof value==='object'&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,'default',{enumerable:true,value:value});if(mode&2&&typeof value!='string')for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key];}.bind(null,key));return ns;};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default'];}:function getModuleExports(){return module;};__webpack_require__.d(getter,'a',getter);return getter;};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property);};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s="./src/index.ts");})
({"./src/PbhAdUnit.ts":
/*!**************************!*\
  !*** ./src/PbhAdUnit.ts ***!
  \**************************/
/*! exports provided: default */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _gtag__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./gtag */
"./src/gtag.ts");var _zero_bid_update__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./zero_bid_update */
"./src/zero_bid_update.ts");var _ab_testing__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./ab_testing */
"./src/ab_testing.ts");var _utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./utils */
"./src/utils.ts");var _pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./pbh_refresh_ads */
"./src/pbh_refresh_ads.ts");var _global_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(
/*! ./global_utils */
"./src/global_utils.ts");var _tgt_providers_index__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(
/*! ./tgt_providers/index */
"./src/tgt_providers/index.ts");var _fbq__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(
/*! ./fbq */
"./src/fbq.ts");var _user_activity__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(
/*! ./user_activity */
"./src/user_activity.ts");var dynamic_count=0;function assign_dynamic_id(target_el){var slotname='div-gpt-ad-'+PbhAdUnit.dynamic_ts+'-'+dynamic_count;dynamic_count++;target_el.id=slotname;return slotname;}
function track_purchase(price){if(price>PbhAdUnit.user_max_bid){PbhAdUnit.user_max_bid=price;}}
function run_PAU_cmd(){var w=window;if(Array.isArray(w.PbhAdUnit_cmd)){w.PbhAdUnit_cmd.forEach(function(cb){try{cb();}
catch(err){console.error('PbhAdUnit_cmd',err);}});}
w.PbhAdUnit_cmd={push:function(cb){cb();},};}
var pbh_ad_unit_load=+new Date();var pbh_init_retries=0;function init(){var pbh_init_start=+new Date();try{if(!PbhAdUnit.tgt_providers){Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["pbh_log"])('init called without tgt_providers, retrying, times:'+pbh_init_retries);if(pbh_init_retries++<10){setTimeout(PbhAdUnit.init,500);}
return;}
Object(_user_activity__WEBPACK_IMPORTED_MODULE_8__["user_activity_watchers_init"])();_gtag__WEBPACK_IMPORTED_MODULE_0__["add_listener"]('slotRenderEnded',function(event){if(!(event&&event.slot&&event.slot.pbh_ad)){return;}
var ad=event.slot.pbh_ad;if(ad.unit_waiting){window.clearTimeout(ad.unit_waiting);}
ad.unit_waiting=false;Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('gtag.slotRenderEnded',ad.unit_ad_path,ad.unit_div_id);});Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('PbhAdUnit.init');var real_init_def_1=Object(_pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__["pbh_init_ads"])();PbhAdUnit.init_deferred=$.Deferred();real_init_def_1.always(function(){var head_to_init=(pbh_init_start-window.pbh_head_start);PbhAdUnit.default_timeout=PbhAdUnit.refresh_timeout;var head_timing=window.pbh_head_timing;if(head_timing){Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["pbh_log"])('init time: '+(+new Date()-pbh_ad_unit_load)+' preinit time: '+head_to_init+' total head time: '+head_timing+' def state: '+real_init_def_1.state());}
run_PAU_cmd();PbhAdUnit.init_deferred.resolve();Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('init finished');});}
catch(e){Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["pbh_log"])(e);}}
var PbhAdUnit=(function(){function PbhAdUnit(ad_path,ad_sizes,rtb_params,div_id,opts){var _this=this;this.unit_ad_path=ad_path;if(Array.isArray(ad_sizes[0])){this.unit_ad_sizes=ad_sizes;}
else{this.unit_ad_sizes=[ad_sizes];}
this.unit_is_displayed=false;this.unit_waiting=false;this.rtb_params=rtb_params;this.targeting=[];this.unit_slot=null;if(this.rtb_params.ybot){this.rtb_params.yieldbot={slot:this.rtb_params.ybot};}
if(typeof div_id=='string'){this.unit_div_id=div_id;}
else if(div_id){this.unit_div_id=assign_dynamic_id(div_id);}
else{Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["pbh_log"])('no div id passed to ad');debugger;return;}
clear_prices(this);var is_dynamic=!!PbhAdUnit.init_deferred;this.is_dynamic=is_dynamic;opts=opts||{refresh_enabled:true};this.floor=opts.floor;this.under_floor_cb=opts.cb;this.refresh_disabled=false;var set_refresh_disabled=function(){return _this.refresh_disabled=PbhAdUnit.refreshes_disabled||!opts.refresh_enabled;};Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["getAdUnits"])()[this.unit_div_id]=this;if(is_dynamic&&!opts.skip_initial_bid){Object(_pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__["pbh_refresh_ads"])([this]).then(set_refresh_disabled);}
else{set_refresh_disabled();}}
PbhAdUnit.prototype.set_provider_result=function(provider,res){var ad_slot=this;ad_slot[provider+'_res']=res;};PbhAdUnit.prototype.get_provider_result=function(provider){var ad_slot=this;return ad_slot[provider+'_res'];};PbhAdUnit.init_deferred=null;PbhAdUnit.tgt_providers=_tgt_providers_index__WEBPACK_IMPORTED_MODULE_6__;PbhAdUnit.default_timeout=Object(_utils__WEBPACK_IMPORTED_MODULE_3__["pbh_config_get"])('default_to')||3200;PbhAdUnit.refresh_timeout=Object(_utils__WEBPACK_IMPORTED_MODULE_3__["pbh_config_get"])('refresh_to')||2000;PbhAdUnit.dynamic_ts=Date.now();PbhAdUnit.refreshes_disabled=document.location.search.search('refresh=0')!=-1;PbhAdUnit.refresh_cbs=[];PbhAdUnit.get_zero_bid_count=_zero_bid_update__WEBPACK_IMPORTED_MODULE_1__["get_zero_bid_count"];PbhAdUnit.get_cohort_name=_ab_testing__WEBPACK_IMPORTED_MODULE_2__["get_cohort_name"];PbhAdUnit.debug=Object(_utils__WEBPACK_IMPORTED_MODULE_3__["has_query"])('pbh_debug=1');PbhAdUnit.debug_buffer=[];PbhAdUnit.try_adhesion=null;PbhAdUnit.cmd_push=_gtag__WEBPACK_IMPORTED_MODULE_0__["cmd_push"];PbhAdUnit.track_purchase=track_purchase;PbhAdUnit.user_click=_user_activity__WEBPACK_IMPORTED_MODULE_8__["user_click"];PbhAdUnit.init=init;PbhAdUnit.user_max_bid=0;return PbhAdUnit;}());__webpack_exports__["default"]=(PbhAdUnit);PbhAdUnit.prototype.remove=function(){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('PAU removing',this.unit_div_id);$('#'+this.unit_div_id).empty();var pbh_ad_units=Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["getAdUnits"])();delete pbh_ad_units[this.unit_div_id];};PbhAdUnit.prototype.set_targeting=function(key,value){var _this=this;if(key){this.targeting.push([key,value]);if(this.unit_slot){this.unit_slot.setTargeting(key,value);}
else{Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('no unit slot',this.unit_div_id,key,value);}}
else if(this.unit_slot){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('doing targeting',this.unit_div_id,this.targeting);this.targeting.forEach(function(_a){var key=_a[0],val=_a[1];_gtag__WEBPACK_IMPORTED_MODULE_0__["clear_targeting"](key);_this.unit_slot.setTargeting(key,val);});}
else{console.error('cannot set queued targeting, no unit_slot found for',this.unit_ad_path);}};PbhAdUnit.prototype.clear_targeting=function(){clear_prices(this);if(this.unit_slot){this.unit_slot.clearTargeting();}
this.targeting=[];};function clear_prices(ad){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('clear_prices',ad.unit_div_id);ad.unit_max_price=0;ad.unit_max_real_price=0;ad.unit_max_provider='';}
var PBH_HIGH_VALUE=400;var pbh_sent_high_value_event=false;PbhAdUnit.prototype.update_price=function(provider,cpm){switch(provider){case'districtm':provider='districtmAST';break;case'prebidjs:aol':provider='aolmobile';break;}
cpm=Math.round(cpm);console.log(this.unit_ad_path+' ['+this.unit_div_id+']: got price from '+provider+': '+cpm);if(cpm>this.unit_max_price){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('update_price',this.unit_div_id,provider,cpm);this.unit_max_price=cpm;this.unit_max_provider=provider;}
if(cpm>this.unit_max_real_price&&cpm!=777){this.unit_max_real_price=cpm;}
if(!pbh_sent_high_value_event&&cpm>=PBH_HIGH_VALUE){Object(_fbq__WEBPACK_IMPORTED_MODULE_7__["pbh_fbq"])('trackCustom','HighValueUser');pbh_sent_high_value_event=true;}};PbhAdUnit.prototype.get_size_string=function(){if(this.unit_ad_path.indexOf('Inline')!=-1){return'2x2';}
return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["size_array2string"])(this.unit_ad_sizes);};PbhAdUnit.prototype.display=function(){if(this.unit_is_displayed){return;}
this.unit_is_displayed=true;Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('PbhAdUnit.display()',this.unit_div_id,this.unit_slot);PbhAdUnit.init_deferred.done(function(){if(!this.unit_slot){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('no unit_slot for',this);return;}
_gtag__WEBPACK_IMPORTED_MODULE_0__["display"](this.unit_div_id);}.bind(this));};PbhAdUnit.prototype.refresh_prepare=function(){if(PbhAdUnit.refreshes_disabled||this.refresh_disabled){return false;}
var id_select='#'+this.unit_div_id;if($(id_select).length==0){return false;}
return true;};function clear_videos(selector){var videojs=Object(_global_utils__WEBPACK_IMPORTED_MODULE_5__["getVideojs"])();if(!videojs){return;}
var video_list=$(selector).find('video');if(video_list.length){videojs(video_list[0]).dispose();}}
PbhAdUnit.prototype.dfp_refresh_prepare=function(dont_clear){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('dfp_refresh_prepare',this.unit_div_id,this.unit_ad_path);if(this.unit_waiting){Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('dfp_refresh_prepare: already refreshing unit',this);console.warn('already refreshing unit '+this.unit_div_id);}
this.refresh_start=Date.now();this.unit_waiting=setTimeout(function(){if(!this.unit_waiting||!this.refresh_start){return;}
this.unit_waiting=false;console.error('timeout waiting for ad '+
this.unit_div_id+', total wait '+
(Date.now()-this.refresh_start));Object(_utils__WEBPACK_IMPORTED_MODULE_3__["debug"])('dfp_refresh_prepare: unit timeout',this);}.bind(this),PbhAdUnit.default_timeout*2);if(!dont_clear){var id_select='#'+this.unit_div_id;clear_videos(id_select);$(id_select).empty();$(id_select).removeAttr('style');}
if(!this.unit_slot){_gtag__WEBPACK_IMPORTED_MODULE_0__["add_slot"](this);this.set_targeting();}
this.set_targeting('highbid',Math.min(this.unit_max_real_price,1000));this.display();};PbhAdUnit.prototype.refresh=function(deferred){if(deferred){throw new Error('unexpected refresh with deferred');}
return Object(_pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__["pbh_refresh_ads"])([this]);};PbhAdUnit.pbh_refresh_ads=_pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__["pbh_refresh_ads"];PbhAdUnit.refresh_adhesion=_pbh_refresh_ads__WEBPACK_IMPORTED_MODULE_4__["refresh_adhesion"];PbhAdUnit.print_debug_log=_utils__WEBPACK_IMPORTED_MODULE_3__["print_debug_log"];PbhAdUnit.add_debug_log=_utils__WEBPACK_IMPORTED_MODULE_3__["debug"];}),"./src/ab_testing.ts":
/*!***************************!*\
  !*** ./src/ab_testing.ts ***!
  \***************************/
/*! exports provided: get_cohort_name */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"get_cohort_name",function(){return get_cohort_name;});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils */
"./src/utils.ts");var COHORT_KEYS=['pbh_randomized_remove','pbh_control'];function generate_cohort_idx(){if(!COHORT_KEYS){return;}
var url_search_has_key=function(key){return Object(_utils__WEBPACK_IMPORTED_MODULE_0__["has_query"])('cohort='+key);};try{var query_index=COHORT_KEYS.findIndex(url_search_has_key);if(query_index!=-1){return query_index;}}
catch(e){}
return Math.floor(Math.random()*COHORT_KEYS.length);}
var cohort_idx=generate_cohort_idx();function get_cohort_name(){return COHORT_KEYS&&COHORT_KEYS[cohort_idx];}}),"./src/adhesion_finder.ts":
/*!********************************!*\
  !*** ./src/adhesion_finder.ts ***!
  \********************************/
/*! exports provided: get_adhesion_by_advertiser_id, start_find_adhesion, get_found_adhesion */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"get_adhesion_by_advertiser_id",function(){return get_adhesion_by_advertiser_id;});__webpack_require__.d(__webpack_exports__,"start_find_adhesion",function(){return start_find_adhesion;});__webpack_require__.d(__webpack_exports__,"get_found_adhesion",function(){return get_found_adhesion;});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils */
"./src/utils.ts");var _advertiser_ids__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./advertiser_ids */
"./src/advertiser_ids.ts");var MAX_FIND_ATTEMPTS=100;function get_adhesion_by_advertiser_id(advertiser_id){switch(advertiser_id){case _advertiser_ids__WEBPACK_IMPORTED_MODULE_1__["JUSTPREMIUM_ID"]:return $('.jpx-sa-wrapper,.jpx-cf-wrapper,.jpx-as-wrapper,'+'.jpx-pu-wrapper,.jpx-pa-wrapper,.jpx-wp-wrapper,'+'.jpx-mt-wrapper,.jpx-ms-wrapper');case _advertiser_ids__WEBPACK_IMPORTED_MODULE_1__["GUMGUM_ID"]:return $('div[id^=ad_is_]');case _advertiser_ids__WEBPACK_IMPORTED_MODULE_1__["THIRTYTHREE_ACROSS_ID"]:return $('body > .ttx-lb');}
return false;}
var state={find_adhesion_handle:0,find_attempts:0,$adhesion_el:false,};function start_find_adhesion(advertiser_id){reset();find_adhesion_element(advertiser_id);}
function get_found_adhesion(){return state.$adhesion_el;}
function reset(){state.find_attempts=0;if(state.find_adhesion_handle){clearTimeout(state.find_adhesion_handle);state.find_adhesion_handle=0;}
state.$adhesion_el=false;}
function find_adhesion_element(advertiser_id){var $el=get_adhesion_by_advertiser_id(advertiser_id);if($el){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('find_adhesion_element: found',$el[0]);state.$adhesion_el=$el;state.find_adhesion_handle=0;}
else if($el!==false&&state.find_attempts<MAX_FIND_ATTEMPTS){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('find_adhesion_element: el not found, try again');state.find_adhesion_handle=setTimeout(function(){return find_adhesion_element(advertiser_id);});state.find_attempts++;}}}),"./src/advertiser_ids.ts":
/*!*******************************!*\
  !*** ./src/advertiser_ids.ts ***!
  \*******************************/
/*! exports provided: GUMGUM_ID, JUSTPREMIUM_ID, UNDERDOG_ID, THIRTYTHREE_ACROSS_ID, TRIPLELIFT_ID, APPNEXUS_VIDEO_ID, BEACHFRONT_VIDEO_ID, BREALTIME_VIDEO_ID, DISTRICTM_VIDEO_ID, OPENX_VIDEO_ID, RUBICON_VIDEO_ID */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"GUMGUM_ID",function(){return GUMGUM_ID;});__webpack_require__.d(__webpack_exports__,"JUSTPREMIUM_ID",function(){return JUSTPREMIUM_ID;});__webpack_require__.d(__webpack_exports__,"UNDERDOG_ID",function(){return UNDERDOG_ID;});__webpack_require__.d(__webpack_exports__,"THIRTYTHREE_ACROSS_ID",function(){return THIRTYTHREE_ACROSS_ID;});__webpack_require__.d(__webpack_exports__,"TRIPLELIFT_ID",function(){return TRIPLELIFT_ID;});__webpack_require__.d(__webpack_exports__,"APPNEXUS_VIDEO_ID",function(){return APPNEXUS_VIDEO_ID;});__webpack_require__.d(__webpack_exports__,"BEACHFRONT_VIDEO_ID",function(){return BEACHFRONT_VIDEO_ID;});__webpack_require__.d(__webpack_exports__,"BREALTIME_VIDEO_ID",function(){return BREALTIME_VIDEO_ID;});__webpack_require__.d(__webpack_exports__,"DISTRICTM_VIDEO_ID",function(){return DISTRICTM_VIDEO_ID;});__webpack_require__.d(__webpack_exports__,"OPENX_VIDEO_ID",function(){return OPENX_VIDEO_ID;});__webpack_require__.d(__webpack_exports__,"RUBICON_VIDEO_ID",function(){return RUBICON_VIDEO_ID;});var GUMGUM_ID=4578892946;var JUSTPREMIUM_ID=4601979565;var UNDERDOG_ID=4604916206;var THIRTYTHREE_ACROSS_ID=577564123;var TRIPLELIFT_ID=569797123;var APPNEXUS_VIDEO_ID=4573221115;var BEACHFRONT_VIDEO_ID=4572946442;var BREALTIME_VIDEO_ID=4573142629;var DISTRICTM_VIDEO_ID=4591180053;var OPENX_VIDEO_ID=4610362048;var RUBICON_VIDEO_ID=4604361026;}),"./src/confiantWrap.js":
/*!*****************************!*\
  !*** ./src/confiantWrap.js ***!
  \*****************************/
/*! exports provided: confiantWrap */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"confiantWrap",function(){return confiantWrap;});const confiantWrap=function(a,b,c,d,e){function f(a){return(m(a)||'')[s]('/','_')[s]('+','-');}function g(b,c,d){const e=w+n(b)+'&d='+c;const f='err__'+1*new Date;k[f]=d;const g='<'+q+' on'+t+'="void('+f+'())" '+r+'="'+e+'" type="text/java'+q+'" ></'+q+'>';a[v](g);}function h(){const c=f(d+'/'+x.k.hb_bidder[0]+':'+x.k.hb_size[0]);const h={wh:c,wd:l.parse(l[u](x)),wr:0};g(c,f(l[u](h)),function(){a[v](b.ad);});const i={prebid:{adId:b.adId,cpm:b.cpm}};const j={d:h,t:b.ad,cb:e,id:i};k[d]={},k[d][c]=j;}const i=b.bidder;const j=b.size;var k=a.parentWindow||a.defaultView;var l=k.JSON;var m=k.btoa;var n=k.encodeURIComponent;if(!l||!m){return!1;}const o='t';const p='i';var q='script';var r='src';var s='replace';var t='error';var u='stringify';var v='wr'+p+o+'e';var w='https://'+c+'/?wrapper='+n(d)+'&tpid=';var x={k:{hb_bidder:[i],hb_size:[j]}};return h(),a.close(),!0;};}),"./src/fbq.ts":
/*!********************!*\
  !*** ./src/fbq.ts ***!
  \********************/
/*! exports provided: pbh_fbq */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"pbh_fbq",function(){return pbh_fbq;});var global_context=window;global_context.fbq_cbs=global_context.fbq_cbs||[];var fbq_cbs=global_context.fbq_cbs;global_context.pbh_fbq=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
var fbq=global_context.fbq;fbq_cbs.push(function(){fbq.apply(fbq,args);});};var pbh_fbq=global_context.pbh_fbq;global_context.pbh_init_fbq=function(){var run_cb=function(cb){cb();};if(!Array.isArray(fbq_cbs)){console.error('pbh_init_fbq: expected fbq_cbs to be array');return;}
fbq_cbs.forEach(run_cb);global_context.fbq_cbs={push:run_cb};fbq_cbs=global_context.fbq_cbs;};}),"./src/generic_floors.ts":
/*!*******************************!*\
  !*** ./src/generic_floors.ts ***!
  \*******************************/
/*! exports provided: apply_floor */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"apply_floor",function(){return apply_floor;});var _global_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./global_utils */
"./src/global_utils.ts");var FLOOR_MARGIN=1.05;function apply_floor(pbh_ad,provider,size){var pbh_adjustments=Object(_global_utils__WEBPACK_IMPORTED_MODULE_0__["getAdjustments"])();var _a=pbh_ad.rtb_params,rtb_params=_a===void 0?{}:_a;var provider_floors=rtb_params[provider+'_floors'];var floor=(typeof provider_floors=='number'?provider_floors:typeof provider_floors=='undefined'?pbh_ad.floor:provider_floors[size])||0;var adjustment=pbh_adjustments[provider]||0;var extraAdjust=1;return Math.ceil(((floor*FLOOR_MARGIN)/(1+adjustment/100))*extraAdjust);}}),"./src/generic_render.ts":
/*!*******************************!*\
  !*** ./src/generic_render.ts ***!
  \*******************************/
/*! exports provided: generic_render, get_generic_render */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"generic_render",function(){return generic_render;});__webpack_require__.d(__webpack_exports__,"get_generic_render",function(){return get_generic_render;});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils */
"./src/utils.ts");var _adhesion_finder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./adhesion_finder */
"./src/adhesion_finder.ts");var _global_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./global_utils */
"./src/global_utils.ts");var _advertiser_ids__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./advertiser_ids */
"./src/advertiser_ids.ts");var _lib_renderers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(
/*! ./lib/renderers */
"./src/lib/renderers.ts");var SKIP_CONFIANT_NETWORKS=['brealtime','justpremium','sharethrough','yieldbot','yieldmo',];var get_log_name=function(network_name){return network_name.charAt(0).toUpperCase()+network_name.slice(1);};function generic_render(network_name,doc,div_id_or_ifrmdoc){var frame=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["get_parent_iframe"])(doc);if(!frame){return;}
var pbh_ad_units=Object(_global_utils__WEBPACK_IMPORTED_MODULE_2__["getAdUnits"])();var ad_slot=pbh_ad_units[frame.id];if(!ad_slot){return;}
var is_prebid=network_name.indexOf('prebid:')===0;if(is_prebid){network_name=network_name.split(':')[1];}
var res=ad_slot.get_provider_result(network_name);if(!res){console.error('bid not found for ',network_name);return;}
if(!Object(_utils__WEBPACK_IMPORTED_MODULE_0__["has_query"])('nostrfix')&&(network_name=='sharethrough'||network_name=='teads'||network_name=='triplelift'||(network_name=='yieldmo'&&Object(_utils__WEBPACK_IMPORTED_MODULE_0__["is_inline"])(ad_slot)))){div_id_or_ifrmdoc='div-gpt-ad-fake-'+frame.id;$(frame).append('<div id="'+div_id_or_ifrmdoc+'"></div>');$(frame).find('iframe').hide();if(network_name=='triplelift'||network_name=='yieldmo'){$(frame).find('#'+div_id_or_ifrmdoc).wrap('<div class="iframebust-workaround"></div>').wrap('<div class="iframebust-workaround"></div>');}}
if(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["is_gallery_floorboard"])(ad_slot)){$('.gallery-descriptions-wrap .tlod').remove();}
else if(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["is_adhesion"])(ad_slot)){var adh_garbage=Object(_adhesion_finder__WEBPACK_IMPORTED_MODULE_1__["get_adhesion_by_advertiser_id"])(_advertiser_ids__WEBPACK_IMPORTED_MODULE_3__["JUSTPREMIUM_ID"]);if(adh_garbage){adh_garbage.remove();}}
var height=res.height;var width=res.width;if(res.size&&!height){var size_arr=res.size.split('x');width=Number(size_arr[0]);height=Number(size_arr[1]);}
var disable_sandbox=network_name=='yieldmo';if(div_id_or_ifrmdoc=='bust'){var inline_el=doc.defaultView.frameElement.parentElement;inline_el.innerHTML=res.html;return;}
else if(typeof div_id_or_ifrmdoc=='string'&&res.video){$(frame).data('imp-macro',div_id_or_ifrmdoc);}
else if(typeof div_id_or_ifrmdoc=='string'){var ifrm=$(Object(_lib_renderers__WEBPACK_IMPORTED_MODULE_4__["pbh_sandbox_iframe"])(width,height,disable_sandbox));ifrm.appendTo('#'+div_id_or_ifrmdoc);doc=ifrm[0].contentDocument;doc.open();}
else if(div_id_or_ifrmdoc&&typeof div_id_or_ifrmdoc.write=='function'){doc=div_id_or_ifrmdoc;if(res.native){var inline_el=doc.defaultView.frameElement.parentElement;inline_el.innerHTML=res.html;return;}}
else if(doc.body){var ifrm=$(Object(_lib_renderers__WEBPACK_IMPORTED_MODULE_4__["pbh_sandbox_iframe"])(width,height,disable_sandbox));ifrm.appendTo(doc.body);doc=ifrm[0].contentDocument;doc.open();}
var log_name=get_log_name(network_name);if(is_prebid){log_name+=' Prebid';}
var skip_confiant=res.video||SKIP_CONFIANT_NETWORKS.indexOf(network_name)!=-1||(network_name=='gumgum'&&Object(_utils__WEBPACK_IMPORTED_MODULE_0__["is_adhesion"])(ad_slot));if(skip_confiant){doc.write(res.html);}
else{Object(_lib_renderers__WEBPACK_IMPORTED_MODULE_4__["confiant_write"])(doc,res.html,log_name+' Header',width,height);}
doc.close();var adhesion_bust_networks=['gumgum','justpremium','underdogmedia','33across'];if(adhesion_bust_networks.indexOf(network_name)!=-1&&Object(_utils__WEBPACK_IMPORTED_MODULE_0__["is_adhesion"])(ad_slot)){$('.mob_adhesion').hide();}}
function get_generic_render(network_name){return generic_render.bind(null,network_name);}}),"./src/global_utils.ts":
/*!*****************************!*\
  !*** ./src/global_utils.ts ***!
  \*****************************/
/*! exports provided: pbh_collect, pbh_log, cookie_tool, getGaq, getPAU, getAdUnits, getWidth, getGoogletag, closeUdmAd, getVideojsQueue, getVideojs, getPbjs, getAdjustments, getPostId, getFB, getApstag, getJquery, getConfigGetter */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"pbh_collect",function(){return pbh_collect;});__webpack_require__.d(__webpack_exports__,"pbh_log",function(){return pbh_log;});__webpack_require__.d(__webpack_exports__,"cookie_tool",function(){return cookie_tool;});__webpack_require__.d(__webpack_exports__,"getGaq",function(){return getGaq;});__webpack_require__.d(__webpack_exports__,"getPAU",function(){return getPAU;});__webpack_require__.d(__webpack_exports__,"getAdUnits",function(){return getAdUnits;});__webpack_require__.d(__webpack_exports__,"getWidth",function(){return getWidth;});__webpack_require__.d(__webpack_exports__,"getGoogletag",function(){return getGoogletag;});__webpack_require__.d(__webpack_exports__,"closeUdmAd",function(){return closeUdmAd;});__webpack_require__.d(__webpack_exports__,"getVideojsQueue",function(){return getVideojsQueue;});__webpack_require__.d(__webpack_exports__,"getVideojs",function(){return getVideojs;});__webpack_require__.d(__webpack_exports__,"getPbjs",function(){return getPbjs;});__webpack_require__.d(__webpack_exports__,"getAdjustments",function(){return getAdjustments;});__webpack_require__.d(__webpack_exports__,"getPostId",function(){return getPostId;});__webpack_require__.d(__webpack_exports__,"getFB",function(){return getFB;});__webpack_require__.d(__webpack_exports__,"getApstag",function(){return getApstag;});__webpack_require__.d(__webpack_exports__,"getJquery",function(){return getJquery;});__webpack_require__.d(__webpack_exports__,"getConfigGetter",function(){return getConfigGetter;});var global_context=window;global_context.googletag=global_context.googletag||{cmd:[]};function proxy(fn,name){if(typeof fn!='function'){console.warn('cannot call',name);return function(){};}
return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
return fn.apply(void 0,args);};}
function window_proxy(fn_name){var fn=global_context[fn_name];if(!fn){console.warn('not loaded:',fn_name);return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
return proxy(fn,fn_name).apply(void 0,args);};}
return proxy(fn,fn_name);}
var pbh_collect=window_proxy('pbh_collect');var pbh_log=window_proxy('pbh_log');var cookie_tool=proxy(global_context.$.cookie,'$.cookie');var getGaq=function(){return global_context.pbh_gaq;};var getPAU=function(){return global_context.PbhAdUnit;};var getAdUnits=function(){return global_context.pbh_ad_units;};var getWidth=function(){return global_context.width;};var getGoogletag=function(){return global_context.googletag;};var closeUdmAd=function(){return global_context.closeUdmAd&&global_context.closeUdmAd();};var getVideojsQueue=function(){return(global_context.videojs_q=global_context.videojs_q||[]);};var getVideojs=function(){return global_context.videojs;};var getPbjs=function(){return global_context.pbjs;};var getAdjustments=function(){return global_context.pbh_adjustments;};var getPostId=function(){return global_context.pbh_post_id;};var getFB=function(){return global_context.FB;};var getApstag=function(){return global_context.apstag;};var getJquery=function(){return global_context.$;};var getConfigGetter=function(){return global_context.pbh_config_get;};}),"./src/gtag.ts":
/*!*********************!*\
  !*** ./src/gtag.ts ***!
  \*********************/
/*! exports provided: is_loaded, add_listener, add_slot, clear_targeting, cmd_push, display, enable, refresh, set_targeting */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"is_loaded",function(){return is_loaded;});__webpack_require__.d(__webpack_exports__,"add_listener",function(){return add_listener;});__webpack_require__.d(__webpack_exports__,"add_slot",function(){return add_slot;});__webpack_require__.d(__webpack_exports__,"clear_targeting",function(){return clear_targeting;});__webpack_require__.d(__webpack_exports__,"cmd_push",function(){return cmd_push;});__webpack_require__.d(__webpack_exports__,"display",function(){return display;});__webpack_require__.d(__webpack_exports__,"enable",function(){return enable;});__webpack_require__.d(__webpack_exports__,"refresh",function(){return refresh;});__webpack_require__.d(__webpack_exports__,"set_targeting",function(){return set_targeting;});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./utils */
"./src/utils.ts");var _global_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./global_utils */
"./src/global_utils.ts");function dfp_error(e){console.error('googletag error:',e);}
function add_slot(ad_unit){try{var googletag=Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])();var unit_ad_path=ad_unit.unit_ad_path,unit_ad_sizes=ad_unit.unit_ad_sizes,unit_div_id=ad_unit.unit_div_id;Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.add_slot',unit_div_id,unit_ad_path);ad_unit.unit_is_displayed=!!googletag.pubadsReady;ad_unit.unit_slot=googletag.defineSlot(unit_ad_path,unit_ad_sizes,unit_div_id).addService(googletag.pubads());ad_unit.unit_slot.pbh_ad=ad_unit;return ad_unit.unit_slot;}
catch(e){dfp_error(e);}}
function cmd_push(cb){try{var cmd=Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])()&&Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().cmd;if(!cmd){console.warn('googletag not found');cb();}
else{Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().cmd.push(cb);}}
catch(e){dfp_error(e);}}
function add_listener(event,cb){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.add_listener',event,cb);try{Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads().addEventListener(event,cb);}
catch(e){dfp_error(e);}}
function enable(){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.enable()');try{Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads().setTagForChildDirectedTreatment(0);Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().enableServices();}
catch(e){dfp_error(e);}}
function clear_targeting(key){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.clear_targeting',key);try{Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads().clearTargeting(key);}
catch(e){dfp_error(e);}}
function display(div_id){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.display(',div_id,')');try{Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().display(div_id);}
catch(e){dfp_error(e);}}
function refresh(ad_list){Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.refresh(',ad_list,')');try{var slot_list=ad_list.map(function(ad){return ad.unit_slot;});Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads().refresh(slot_list);}
catch(e){dfp_error(e);}}
function set_targeting(key,value){try{Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.set_targeting(',key,'=',value,')');console.log('setting targeting: '+key+' = '+value);Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads().setTargeting(key,value);}
catch(e){dfp_error(e);}}
function is_loaded(){var ret=Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])()&&Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["getGoogletag"])().pubads;Object(_utils__WEBPACK_IMPORTED_MODULE_0__["debug"])('gtag.is_loaded',ret);return ret;}}),"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no exports provided */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _init_window__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./init_window */
"./src/init_window.ts");var _global_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./global_utils */
"./src/global_utils.ts");try{Object(_init_window__WEBPACK_IMPORTED_MODULE_0__["init_window"])();}
catch(e){Object(_global_utils__WEBPACK_IMPORTED_MODULE_1__["pbh_log"])(e);}}),"./src/init_window.ts":
/*!****************************!*\
  !*** ./src/init_window.ts ***!
  \****************************/
/*! exports provided: init_window */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"init_window",function(){return init_window;});var _PbhAdUnit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ./PbhAdUnit */
"./src/PbhAdUnit.ts");var _providers_prebid_index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ./providers/prebid/index */
"./src/providers/prebid/index.ts");var _gtag__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(
/*! ./gtag */
"./src/gtag.ts");var _post_render__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(
/*! ./post_render */
"./src/post_render.ts");var global_context=window;function init_legacy_globals(){var width=document.documentElement.clientWidth;var lboard;var lboard2;var lboard3;if(width>0&&width<728){lboard=[[300,250],[320,200]];lboard2=[[320,50],[300,250],[300,600]];lboard3=[[320,50],[300,250],[300,600]];}
else if(width>727&&width<970){lboard=[[728,90]];lboard2=[[320,50],[300,250],[728,90]];lboard3=[[320,50],[300,250],[728,90]];}
else{lboard=[[728,90],[970,90],[970,250]];lboard2=[[728,90],[970,90],[970,250]];lboard3=[728,90];}
global_context.width=width;global_context.lboard=lboard;global_context.lboard2=lboard2;global_context.lboard3=lboard3;}
function init_window(){init_legacy_globals();global_context.PbhAdUnit=_PbhAdUnit__WEBPACK_IMPORTED_MODULE_0__["default"];global_context.pbh_prebidjs_render=_providers_prebid_index__WEBPACK_IMPORTED_MODULE_1__["pbh_prebidjs_render"];global_context.pbh_adjustments=global_context.pbh_adjustments||{};global_context.pbh_ad_units={};_PbhAdUnit__WEBPACK_IMPORTED_MODULE_0__["default"].cmd_push(function(){$('#gpt-adhesion .adh_close').off().click(function(){$('#gpt-adhesion').hide();});_gtag__WEBPACK_IMPORTED_MODULE_2__["add_listener"]('slotRenderEnded',_post_render__WEBPACK_IMPORTED_MODULE_3__["default"]);});if(Array.isArray(global_context.PbhAdUnit_load)){global_context.PbhAdUnit_load.forEach(function(cb){_PbhAdUnit__WEBPACK_IMPORTED_MODULE_0__["default"].cmd_push(cb);});}
global_context.PbhAdUnit_load={push:function(cb){_PbhAdUnit__WEBPACK_IMPORTED_MODULE_0__["default"].cmd_push(cb);},};}}),"./src/lib/renderers.ts":
/*!******************************!*\
  !*** ./src/lib/renderers.ts ***!
  \******************************/
/*! exports provided: pbh_sandbox_iframe, confiant_write, get_pbh_prebid_native */
(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"pbh_sandbox_iframe",function(){return pbh_sandbox_iframe;});__webpack_require__.d(__webpack_exports__,"confiant_write",function(){return confiant_write;});__webpack_require__.d(__webpack_exports__,"get_pbh_prebid_native",function(){return get_pbh_prebid_native;});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(
/*! ../utils */
"./src/utils.ts");var _confiantWrap__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(
/*! ../confiantWrap */
"./src/confiantWrap.js");var global_context=window;function pbh_make_adhesion(width,height,make_iframe,aol_fill_id){var fill_id=aol_fill_id||'pbh_'+ +new Date();var close_style;if(width>420){close_style='display:none; height: 40px; width: 40px; top:-15px;';}
else{close_style='display:none; height: 32px; width: 32px; top:-14px;';}
var mob_adhesion=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["create_element"])('<div class="mob_adhesion" style="height: '+
height+'px">'+'<div class="adh_frame" style="width: '+
width+'px; height: '+
height+'px">'+'<div class="adh_close" style="'+
close_style+'"></div><div id="'+
fill_id+'"></div>'+'</div></div>');mob_adhesion.find('.adh_close').click(function(){return mob_adhesion.remove();});Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('body').find('.mob_adhesion').not('#gpt-adhesion').remove();Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('#gpt-adhesion').hide();Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('body').append(mob_adhesion);if(make_iframe){var ifrm=pbh_sandbox_iframe(width,height,make_iframe=='nosandbox');Object(_utils__WEBPACK_IMPORTED_MODULE_0__["append_to_element"])(ifrm,'#'+fill_id);return ifrm.contentDocument;}
return fill_id;}
global_context.pbh_make_adhesion=pbh_make_adhesion;function pbh_get_inline_p(){var paragraph=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('.post-content > p, .post-content > div, .post-content > blockquote,'+' .post-content > :header').not('.dek');if(document.location.search.indexOf('inline_speed_test')!=-1){return paragraph.first().next();}
var is_ati=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["pbh_config_get"])('shortname')=='ATI';if(is_ati){var start_p_idx=+Object(_utils__WEBPACK_IMPORTED_MODULE_0__["pbh_config_get"])('inline_initial_p_count');if(!start_p_idx||paragraph.length<start_p_idx){var dek=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('.post-content .dek');if(dek.length==0){paragraph=paragraph.first();}
else{paragraph=dek;}}
else{paragraph=paragraph.eq(start_p_idx-1);}}
else{var post_tags=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["pbh_config_get"])('post_tags');var is_gallery=post_tags&&post_tags.indexOf('galleries')!=-1;if(is_gallery){var dek=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('.post-content .dek');if(dek.length){paragraph=dek;}
else{paragraph=paragraph.first();}}
else if(paragraph.length>4){paragraph=paragraph.eq(1);}
else{paragraph=paragraph.first();}}
if(paragraph.find('img').length>0){paragraph=paragraph.next();}
return paragraph;}
global_context.pbh_get_inline_p=pbh_get_inline_p;function pbh_get_inline_div(doc){var div=doc&&doc.defaultView&&doc.defaultView.frameElement&&doc.defaultView.frameElement.parentElement&&doc.defaultView.frameElement.parentElement.parentElement;var $div=div&&Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])(div);if($div&&($div.hasClass('pbh_inline')||$div.hasClass('pbh_native')||$div.parent().hasClass('pbh_inline'))){return $div;}
var $pbh_inline_divs=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('.pbh_inline');if($pbh_inline_divs.length!=0){return $pbh_inline_divs.last();}
var paragraph=pbh_get_inline_p();var $new_div=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["create_element"])('<div class="pbh_inline"></div>');paragraph.after($new_div);return $new_div;}
global_context.pbh_get_inline_div=pbh_get_inline_div;function pbh_make_inline(doc,width,height,disable_sandbox){if(typeof doc!='object'){disable_sandbox=height;height=width;width=doc;doc=null;}
if(!width){width=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["select_elements"])('article').width();height=220;}
var ifrm=pbh_sandbox_iframe(width,height,disable_sandbox);ifrm.style.margin='0 auto';ifrm.style.display='block';pbh_get_inline_div(doc).append(ifrm);return ifrm;}
global_context.pbh_make_inline=pbh_make_inline;function pbh_sandbox_iframe(width,height,disable_sandbox){var sandbox='';if(!disable_sandbox&&window.document.location.search.indexOf('disable_sandbox')==-1){sandbox='sandbox="allow-scripts allow-same-origin '+'allow-popups-to-escape-sandbox allow-popups allow-forms"';}
var ifrm=Object(_utils__WEBPACK_IMPORTED_MODULE_0__["create_element"])('<iframe marginheight="0" marginwidth="0" frameborder="0" '+
sandbox+' width="'+
width+'" height="'+
height+'" scrolling="no" style="overflow: hidden;"/>');return ifrm[0];}
global_context.pbh_sandbox_iframe=pbh_sandbox_iframe;function pbh_sandbox_write(width,height,doc,html,bidder,_disable_sandbox){var iframe=pbh_sandbox_iframe(width,height);iframe.src='javascript:';doc.body.appendChild(iframe);iframe.contentWindow.parent=window;var confiant_disabled_bidders=['Tribal Fusion Tag'];var confiant_disabled=confiant_disabled_bidders.indexOf(bidder)!=-1;var idoc=iframe.contentWindow.document;idoc.open();if(confiant_disabled){idoc.write(html);}
else{confiant_write(idoc,html,bidder,width,height);}
idoc.close();}
global_context.pbh_sandbox_write=pbh_sandbox_write;function pbh_generate_uuid(){var ts=new Date().getTime();var uuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(){}