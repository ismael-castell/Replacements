(self.webpackChunklite=self.webpackChunklite||[]).push([[5573],{45573:(t,e,n)=>{t.exports=n(59792)},59792:function(t){t.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{default:t}}(n(24)),o=n(4),i={Tracer:r.default};o.Platform.initLibrary(i),t.exports=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(t)for(var n in t)hasOwnProperty.call(t,n)&&e(t[n],n)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),o=function(){function t(){}return t.prototype.context=function(){return this._context()},t.prototype.tracer=function(){return this._tracer()},t.prototype.setOperationName=function(t){return this._setOperationName(t),this},t.prototype.setBaggageItem=function(t,e){return this._setBaggageItem(t,e),this},t.prototype.getBaggageItem=function(t){return this._getBaggageItem(t)},t.prototype.setTag=function(t,e){return this._addTags(((n={})[t]=e,n)),this;var n},t.prototype.addTags=function(t){return this._addTags(t),this},t.prototype.log=function(t,e){return this._log(t,e),this},t.prototype.logEvent=function(t,e){return this._log({event:t,payload:e})},t.prototype.finish=function(t){this._finish(t)},t.prototype._context=function(){return r.spanContext},t.prototype._tracer=function(){return r.tracer},t.prototype._setOperationName=function(t){},t.prototype._setBaggageItem=function(t,e){},t.prototype._getBaggageItem=function(t){},t.prototype._addTags=function(t){},t.prototype._log=function(t,e){},t.prototype._finish=function(t){},t}();e.Span=o,e.default=o},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=e.LOG_INFO=0,r=e.LOG_WARN=1,o=e.LOG_ERROR=2,i=e.LOG_FATAL=3;e.LOG_LEVEL_TO_STRING={LOG_INFO:"I",LOG_WARN:"W",LOG_ERROR:"E",LOG_FATAL:"F"},e.LOG_STRING_TO_LEVEL={I:n,W:r,E:o,F:i},e.CLOCK_STATE_REFRESH_INTERVAL_MS=350,e.LIGHTSTEP_APP_URL_PREFIX="https://app.lightstep.com",e.JOIN_ID_PREFIX="join:"},function(t,e,n){"use strict";t.exports={Platform:n(18),Transport:n(20),thrift:n(19),crouton_thrift:n(16)}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toString=function(t){return""+t},e.toNumber=function(t){return Number(t)},e.toBoolean=function(t){return!!t}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0});var o=n(32);e.BinaryCarrier=o.default;var i=n(33);e.Tags=i;var s=n(7),a=n(12);e.Reference=a.default;var u=n(2);e.Span=u.default;var l=n(13);e.SpanContext=l.default;var c=n(8);e.Tracer=c.default,r(n(34)),r(n(10)),r(n(11)),s.initialize()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(13),i=n(8);e.tracer=null,e.spanContext=null,e.span=null,e.initialize=function(){e.tracer=new i.default,e.span=new r.default,e.spanContext=new o.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),o=n(7),i=n(2),s=function(){function t(){}return t.prototype.startSpan=function(t,e){if(void 0===e&&(e={}),e.childOf){var n=r.childOf(e.childOf);e.references?e.references.push(n):e.references=[n],delete e.childOf}return this._startSpan(t,e)},t.prototype.inject=function(t,e,n){return t instanceof i.default&&(t=t.context()),this._inject(t,e,n)},t.prototype.extract=function(t,e){return this._extract(t,e)},t.prototype._startSpan=function(t,e){return o.span},t.prototype._inject=function(t,e,n){},t.prototype._extract=function(t,e){return o.spanContext},t}();e.Tracer=s,e.default=s},function(t,e){"use strict";!function(){var e={},n={};void 0===n&&(n={}),n.KeyValue=function(t){if(this.Key=null,this.Value=null,t){if(void 0===t.Key)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field Key is unset!");if(this.Key=t.Key,void 0===t.Value)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field Value is unset!");this.Value=t.Value}},n.KeyValue.prototype={},n.KeyValue.prototype.read=!1,n.KeyValue.prototype.write=!1,n.NamedCounter=function(t){if(this.Name=null,this.Value=null,t){if(void 0===t.Name)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field Name is unset!");if(this.Name=t.Name,void 0===t.Value)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field Value is unset!");this.Value=t.Value}},n.NamedCounter.prototype={},n.NamedCounter.prototype.read=!1,n.NamedCounter.prototype.write=!1,n.Runtime=function(t){this.guid=null,this.start_micros=null,this.group_name=null,this.attrs=null,t&&(void 0!==t.guid&&(this.guid=t.guid),void 0!==t.start_micros&&(this.start_micros=t.start_micros),void 0!==t.group_name&&(this.group_name=t.group_name),void 0!==t.attrs&&(this.attrs=t.attrs))},n.Runtime.prototype={},n.Runtime.prototype.read=!1,n.Runtime.prototype.write=!1,n.LogRecord=function(t){this.timestamp_micros=null,this.fields=null,this.runtime_guid=null,this.span_guid=null,this.stable_name=null,this.message=null,this.level=null,this.thread_id=null,this.filename=null,this.line_number=null,this.stack_frames=null,this.payload_json=null,this.error_flag=null,t&&(void 0!==t.timestamp_micros&&(this.timestamp_micros=t.timestamp_micros),void 0!==t.fields&&(this.fields=t.fields),void 0!==t.runtime_guid&&(this.runtime_guid=t.runtime_guid),void 0!==t.span_guid&&(this.span_guid=t.span_guid),void 0!==t.stable_name&&(this.stable_name=t.stable_name),void 0!==t.message&&(this.message=t.message),void 0!==t.level&&(this.level=t.level),void 0!==t.thread_id&&(this.thread_id=t.thread_id),void 0!==t.filename&&(this.filename=t.filename),void 0!==t.line_number&&(this.line_number=t.line_number),void 0!==t.stack_frames&&(this.stack_frames=t.stack_frames),void 0!==t.payload_json&&(this.payload_json=t.payload_json),void 0!==t.error_flag&&(this.error_flag=t.error_flag))},n.LogRecord.prototype={},n.LogRecord.prototype.read=!1,n.LogRecord.prototype.write=!1,n.TraceJoinId=function(t){if(this.TraceKey=null,this.Value=null,t){if(void 0===t.TraceKey)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field TraceKey is unset!");if(this.TraceKey=t.TraceKey,void 0===t.Value)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field Value is unset!");this.Value=t.Value}},n.TraceJoinId.prototype={},n.TraceJoinId.prototype.read=!1,n.TraceJoinId.prototype.write=!1,n.SpanRecord=function(t){this.span_guid=null,this.trace_guid=null,this.runtime_guid=null,this.span_name=null,this.join_ids=null,this.oldest_micros=null,this.youngest_micros=null,this.attributes=null,this.error_flag=null,this.log_records=null,t&&(void 0!==t.span_guid&&(this.span_guid=t.span_guid),void 0!==t.trace_guid&&(this.trace_guid=t.trace_guid),void 0!==t.runtime_guid&&(this.runtime_guid=t.runtime_guid),void 0!==t.span_name&&(this.span_name=t.span_name),void 0!==t.join_ids&&(this.join_ids=t.join_ids),void 0!==t.oldest_micros&&(this.oldest_micros=t.oldest_micros),void 0!==t.youngest_micros&&(this.youngest_micros=t.youngest_micros),void 0!==t.attributes&&(this.attributes=t.attributes),void 0!==t.error_flag&&(this.error_flag=t.error_flag),void 0!==t.log_records&&(this.log_records=t.log_records))},n.SpanRecord.prototype={},n.SpanRecord.prototype.read=!1,n.SpanRecord.prototype.write=!1,n.Auth=function(t){this.access_token=null,t&&void 0!==t.access_token&&(this.access_token=t.access_token)},n.Auth.prototype={},n.Auth.prototype.read=!1,n.Auth.prototype.write=!1,n.Timing=function(t){this.receive_micros=null,this.transmit_micros=null,t&&(void 0!==t.receive_micros&&(this.receive_micros=t.receive_micros),void 0!==t.transmit_micros&&(this.transmit_micros=t.transmit_micros))},n.Timing.prototype={},n.Timing.prototype.read=!1,n.Timing.prototype.write=!1,n.SampleCount=function(t){this.oldest_micros=null,this.youngest_micros=null,this.count=null,t&&(void 0!==t.oldest_micros&&(this.oldest_micros=t.oldest_micros),void 0!==t.youngest_micros&&(this.youngest_micros=t.youngest_micros),void 0!==t.count&&(this.count=t.count))},n.SampleCount.prototype={},n.SampleCount.prototype.read=!1,n.SampleCount.prototype.write=!1,n.MetricsSample=function(t){if(this.name=null,this.int64_value=null,this.double_value=null,t){if(void 0===t.name)throw new e.TProtocolException(e.TProtocolExceptionType.UNKNOWN,"Required field name is unset!");this.name=t.name,void 0!==t.int64_value&&(this.int64_value=t.int64_value),void 0!==t.double_value&&(this.double_value=t.double_value)}},n.MetricsSample.prototype={},n.MetricsSample.prototype.read=!1,n.MetricsSample.prototype.write=!1,n.Metrics=function(t){this.counts=null,this.gauges=null,t&&(void 0!==t.counts&&(this.counts=t.counts),void 0!==t.gauges&&(this.gauges=t.gauges))},n.Metrics.prototype={},n.Metrics.prototype.read=!1,n.Metrics.prototype.write=!1,n.ReportRequest=function(t){this.runtime=null,this.span_records=null,this.log_records=null,this.timestamp_offset_micros=null,this.oldest_micros=null,this.youngest_micros=null,this.counters=null,this.internal_logs=null,this.internal_metrics=null,t&&(void 0!==t.runtime&&(this.runtime=t.runtime),void 0!==t.span_records&&(this.span_records=t.span_records),void 0!==t.log_records&&(this.log_records=t.log_records),void 0!==t.timestamp_offset_micros&&(this.timestamp_offset_micros=t.timestamp_offset_micros),void 0!==t.oldest_micros&&(this.oldest_micros=t.oldest_micros),void 0!==t.youngest_micros&&(this.youngest_micros=t.youngest_micros),void 0!==t.counters&&(this.counters=t.counters),void 0!==t.internal_logs&&(this.internal_logs=t.internal_logs),void 0!==t.internal_metrics&&(this.internal_metrics=t.internal_metrics))},n.ReportRequest.prototype={},n.ReportRequest.prototype.read=!1,n.ReportRequest.prototype.write=!1,n.Command=function(t){this.disable=null,t&&void 0!==t.disable&&(this.disable=t.disable)},n.Command.prototype={},n.Command.prototype.read=!1,n.Command.prototype.write=!1,n.ReportResponse=function(t){this.commands=null,this.timing=null,this.errors=null,t&&(void 0!==t.commands&&(this.commands=t.commands),void 0!==t.timing&&(this.timing=t.timing),void 0!==t.errors&&(this.errors=t.errors))},n.ReportResponse.prototype={},n.ReportResponse.prototype.read=!1,n.ReportResponse.prototype.write=!1,t.exports.crouton_thrift=n,t.exports.Thrift={}}()},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FORMAT_BINARY="binary",e.FORMAT_TEXT_MAP="text_map",e.FORMAT_HTTP_HEADERS="http_headers",e.REFERENCE_CHILD_OF="child_of",e.REFERENCE_FOLLOWS_FROM="follows_from"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),o=n(12),i=n(2);e.childOf=function(t){return t instanceof i.default&&(t=t.context()),new o.default(r.REFERENCE_CHILD_OF,t)},e.followsFrom=function(t){return t instanceof i.default&&(t=t.context()),new o.default(r.REFERENCE_FOLLOWS_FROM,t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=function(){function t(t,e){this._type=t,this._referencedContext=e instanceof r.default?e.context():e}return t.prototype.type=function(){return this._type},t.prototype.referencedContext=function(){return this._referencedContext},t}();e.default=o},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.SpanContext=n,e.default=n},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.options={}}return r(t,[{key:"setOptions",value:function(t){var e=this;(0,o.default)(t,(function(t,n){e.options[n]=t}))}}]),t}();t.exports=new i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),i=n(3),s=n(5),a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._runtime=e,this._record=new o.crouton_thrift.LogRecord({timestamp_micros:e._platform.nowMicros(),runtime_guid:null,span_guid:null,stable_name:null,message:null,level:null,thread_id:null,filename:null,line_number:null,stack_frames:null,payload_json:null,error_flag:null})}return r(t,[{key:"record",value:function(){return this._record}},{key:"end",value:function(){this._runtime._addLogRecord(this._record)}},{key:"timestamp",value:function(t){return this._record.timestamp_micros=s.toNumber(t),this}},{key:"message",value:function(t){return this._record.message=s.toString(t),this}},{key:"level",value:function(t){return this._record.level=i.LOG_LEVEL_TO_STRING[t]||null,t>=i.LOG_ERROR&&this.error(!0),this}},{key:"span",value:function(t){return void 0!==t&&(this._record.span_guid=s.toString(t)),this}},{key:"name",value:function(t){return this._record.stable_name=s.toString(t),this}},{key:"error",value:function(t){return this._record.error_flag=s.toBoolean(t),this}},{key:"payload",value:function(t){return void 0!==t&&(this._record.payload_json=this._encodePayload(t)),this}},{key:"_encodePayload",value:function(t){var e=null;try{e=JSON.stringify(t)}catch(t){return}return e}}]),t}();t.exports=a},function(t,e,n){"use strict";t.exports=n(9).crouton_thrift},function(t,e){"use strict";var n=function(){var t=document.getElementsByTagName("SCRIPT");return t.length>0?t[t.length-1]:null}();t.exports.parseScriptElementOptions=function(t,e){if(n){var r=n.dataset,o=r.access_token;"string"==typeof o&&o.length>0&&(t.access_token=o);var i=r.component_name;"string"==typeof i&&i.length>0&&(t.component_name=i);var s=r.collector_host;"string"==typeof s&&s.length>0&&(t.collector_host=s);var a=r.collector_port;a&&(t.collector_port=parseInt(a,10));var u=r.collector_path;"string"==typeof u&&u.length>0&&(t.collector_path=u);var l=r.collector_encryption;l&&(t.collector_encryption=l);var c=r.enable;"string"==typeof c&&("true"===c?t.enable=!0:"false"===c&&(t.enable=!1));var p=r.verbosity;"string"==typeof p&&(t.verbosity=parseInt(p,10));var _=r.init_global_tracer;"string"==typeof _&&("true"===_?e.init_global_tracer=!0:"false"===_&&(e.init_global_tracer=!1)),"string"==typeof r.xhr_instrumentation&&"true"===r.xhr_instrumentation&&(t.xhr_instrumentation=!0),"string"==typeof r.instrument_page_load&&"true"===r.instrument_page_load&&(t.instrument_page_load=!0)}},t.exports.parseURLQueryOptions=function(t){if(window){var e=function(t){var e={},n=window.location.href.indexOf("?");if(n<0)return e;var r=window.location.href.slice(n+1);r.indexOf("#")>=0&&(r=r.slice(0,r.indexOf("#")));for(var o=r.replace(/\+/,"%20").split("&"),i=0;i<o.length;i++){var s=o[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}();if(e.lightstep_verbosity)try{t.verbosity=parseInt(e.lightstep_verbosity,10)}catch(t){}e.lightstep_log_to_console&&(t.log_to_console=!0)}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(17),i=n(21),s="lightstep_session_id",a=604800,u=function(){if(window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart){var t=function(){var t=performance.timing.navigationStart;return{v:function(){return Math.floor(1e3*(t+performance.now()))}}}();if("object"==typeof t)return t.v}return function(){return 1e3*Date.now()}}(),l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"name",value:function(){return"browser"}},{key:"nowMicros",value:function(){return u()}},{key:"runtimeGUID",value:function(t){var e="lightstep_guid/"+t,n=i.cookie(e)||this._generateLongUUID();i.cookie(e,n,a,"/");var r=i.cookie(s)||this._generateLongUUID();return i.cookie(s,r,a,"/"),n}},{key:"generateUUID",value:function(){return this._generateLongUUID()}},{key:"_generateLongUUID",value:function(){return""+("00000000"+Math.abs(4294967295*Math.random()|0).toString(16)).substr(-8)+("00000000"+Math.abs(4294967295*Math.random()|0).toString(16)).substr(-8)}},{key:"onBeforeExit",value:function(){if(window){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=window).addEventListener.apply(t,["beforeunload"].concat(n))}}},{key:"plugins",value:function(t){return[n(28),n(27)]}},{key:"options",value:function(t){var e={},n={};return o.parseScriptElementOptions(e,n),o.parseURLQueryOptions(e,n),e}},{key:"tracerTags",value:function(){return{"lightstep.tracer_platform":"browser"}}},{key:"fatal",value:function(t){throw new Error(t)}},{key:"localStoreGet",value:function(t){if(!window.sessionStorage)return null;try{return JSON.parse(sessionStorage.getItem("lightstep/"+t))}catch(t){return null}}},{key:"localStoreSet",value:function(t,e){if(window.sessionStorage)try{sessionStorage.setItem("lightstep/"+t,JSON.stringify(e))}catch(t){}}}],[{key:"initLibrary",value:function(e){var n={},r={};o.parseScriptElementOptions(n,r),r.init_global_tracer&&t.initGlobalTracer(e,n)}},{key:"initGlobalTracer",value:function(t,e){"object"==typeof window&&"object"==typeof window.opentracing&&opentracing.initGlobalTracer(new t.Tracer(e))}}]),t}();t.exports=l},function(t,e,n){"use strict";t.exports=n(9).Thrift},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._host="",this._port=0,this._path="",this._encryption=""}return n(t,[{key:"ensureConnection",value:function(t){this._host=t.collector_host,this._port=t.collector_port,this._path=t.collector_path,this._encryption=t.collector_encryption}},{key:"report",value:function(t,e,n,r){try{t?this._reportAsyncScript(e,n,r):this._reportAJAX(e,n,r)}catch(t){return r(t,null)}}},{key:"_reportAJAX",value:function(t,e,n){var r=JSON.stringify(e),o=("none"===this._encryption?"http":"https")+"://"+this._host+":"+this._port+this._path+"/api/v0/reports",i=new XMLHttpRequest;i.open("POST",o),i.setRequestHeader("LightStep-Access-Token",t.access_token),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){if(4===this.readyState){var t=null,e=null;if(200!==this.status)t=new Error("status code = "+this.status);else if(this.responseText)try{e=JSON.parse(this.responseText)}catch(e){t=e}else t=new Error("unexpected empty response");return n(t,e)}},i.send(r)}},{key:"_reportAsyncScript",value:function(t,e,n){var r=JSON.stringify(t),o=JSON.stringify(e),i=("none"===this._encryption?"http":"https")+"://"+this._host+":"+this._port+this._path+"/_rpc/v1/reports/uri_encoded?auth="+encodeURIComponent(r)+"&report="+encodeURIComponent(o),s=document.createElement("script");s.async=!0,s.defer=!0,s.src=i,s.type="text/javascript";var a=document.getElementsByTagName("head")[0];return a&&a.appendChild(s),n(null,null)}}]),t}();e.default=r,t.exports=e.default},function(t,e){"use strict";t.exports={cookie:function(t,e,n,r,o,i){if(arguments.length>1){var s=t+"="+encodeURIComponent(e)+(n?"; expires="+new Date(+new Date+1e3*n).toUTCString():"")+(r?"; path="+r:"")+(o?"; domain="+o:"")+(i?"; secure":"");return document.cookie=s,s}return decodeURIComponent((("; "+document.cookie).split("; "+t+"=")[1]||"").split(";")[0])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),i=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._baggage={},this._guid=e,this._traceGUID=n}return r(t,[{key:"setBaggageItem",value:function(t,e){this._baggage[t]=e}},{key:"getBaggageItem",value:function(t){return this._baggage[t]}},{key:"forEachBaggageItem",value:function(t){(0,o.default)(this._baggage,(function(e,n){t(n,e)}))}}]),t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(5)),s=r(n(3)),a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),u=r(n(6)),l=n(4),c=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Object.getPrototypeOf(e).call(this));return console.assert("object"==typeof t,"Invalid runtime"),o._tracerImp=t,o._ctx=r,o._ended=!1,o._operationName=n,o._tags={},o._beginMicros=t._platform.nowMicros(),o._endMicros=0,o._errorFlag=!1,o._log_records=null,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"_tracer",value:function(){return this._tracerImp}},{key:"_context",value:function(){return this._ctx}},{key:"_setOperationName",value:function(t){this._operationName=""+t}},{key:"_addTags",value:function(t){var e=this;(0,a.default)(t,(function(t,n){e._tags[n]=t}))}},{key:"_log",value:function(t,e){var n=this;if("object"==typeof t){var r=e?1e3*e:n._tracerImp._platform.nowMicros(),o=[];(0,a.default)(t,(function(t,e){if(e&&t){var r=i.toString(e),s=null;if(t instanceof Object)try{s=JSON.stringify(t,null,"  ")}catch(t){s="Could not encode value. Exception: "+t}else s=i.toString(t);r.length>n._tracerImp._options.log_field_key_hard_limit&&(n._tracerImp._counters["logs.keys.over_limit"]++,r=r.substr(0,n._tracerImp._options.log_field_key_hard_limit)+"..."),s.length>n._tracerImp._options.log_field_value_hard_limit&&(n._tracerImp._counters["logs.values.over_limit"]++,s=s.substr(0,n._tracerImp._options.log_field_value_hard_limit)+"..."),o.push(new l.crouton_thrift.KeyValue({Key:r,Value:s}))}}));var s=new l.crouton_thrift.LogRecord({timestamp_micros:r,fields:o});n._log_records=n._log_records||[],n._log_records.push(s),n._tracerImp.emit("log_added",s)}else n._tracerImp._error("Span.log() expects an object as its first argument")}},{key:"_finish",value:function(t){return this.end(t)}}]),o(e,[{key:"getOperationName",value:function(){return this._operationName}},{key:"guid",value:function(){return this._ctx._guid}},{key:"traceGUID",value:function(){return this._ctx._traceGUID}},{key:"parentGUID",value:function(){return this._tags.parent_span_guid}},{key:"setParentGUID",value:function(t){return this._tags.parent_span_guid=i.toString(t),this}},{key:"beginMicros",value:function(){return this._beginMicros}},{key:"setBeginMicros",value:function(t){return this._beginMicros=t,this}},{key:"endMicros",value:function(){return this._endMicros}},{key:"setEndMicros",value:function(t){return this._endMicros=t,this}},{key:"generateTraceURL",value:function(){var t;return t=this._beginMicros>0&&this._endMicros>0?Math.floor((this._beginMicros+this._endMicros)/2):this._tracerImp._platform.nowMicros(),s.LIGHTSTEP_APP_URL_PREFIX+"/"+encodeURIComponent(this._tracerImp.options().access_token)+"/trace?span_guid="+encodeURIComponent(this.guid())+"&at_micros="+t}},{key:"getTags",value:function(){return this._tags}},{key:"end",value:function(t){this._ended||(this._ended=!0,void 0!==t&&(this._endMicros=1e3*t),0===this._endMicros&&(this._endMicros=this._tracerImp._platform.nowMicros()),this._tracerImp._addSpanRecord(this._toThrift()))}},{key:"_toThrift",value:function(){var t=[];return(0,a.default)(this._tags,(function(e,n){t.push(new l.crouton_thrift.KeyValue({Key:i.toString(n),Value:i.toString(e)}))})),new l.crouton_thrift.SpanRecord({span_guid:this.guid(),trace_guid:this.traceGUID(),runtime_guid:this._tracerImp.guid(),span_name:this._operationName,oldest_micros:this._beginMicros,youngest_micros:this._endMicros,attributes:t,error_flag:this._errorFlag,log_records:this._log_records})}}]),e}(u.Span);e.default=c,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(30)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(6)),a=r(n(22)),u=r(n(23)),l=r(n(1)),c=n(4),p=n(25),_=n(15),f=n(5),d=n(3),h=n(14),v=n(31),g=n(26),m="ot-tracer-",y="ot-baggage-",b=null,w=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Object.getPrototypeOf(e).call(this));r._delegateEventEmitterMethods(),t=t||{},b||(h.setOptions(t),b=r),r._platform=new c.Platform(r),r._runtimeGUID=t.guid||r.override_runtime_guid||null,r._plugins={},r._options={},r._optionDescs=[],r._makeOptionsTable(),r._opentracing=s,t.opentracing_module&&(r._opentracing=t.opentracing_module);var o=r._platform.nowMicros();r._startMicros=o,r._thriftAuth=null,r._thriftRuntime=null;var i={warn:function(t,e){r._warn(t,e)},error:function(t,e){r._error(t,e)}};return r._transport=(t?t.override_transport:null)||new c.Transport(i),r._reportingLoopActive=!1,r._reportYoungestMicros=o,r._reportTimer=null,r._reportErrorStreak=0,r._lastVisibleErrorMillis=0,r._skippedVisibleErrors=0,r._activeRootSpanSet={},r._activeRootSpan=null,r._useClockState=!0,r._clockState=new p({nowMicros:function(){return r._platform.nowMicros()},localStoreGet:function(){var t="clock_state/"+r._options.collector_host;return r._platform.localStoreGet(t)},localStoreSet:function(t){var e="clock_state/"+r._options.collector_host;return r._platform.localStoreSet(e,t)}}),r._spanRecords=[],r._counters={"internal.errors":0,"internal.warnings":0,"spans.dropped":0,"logs.dropped":0,"logs.keys.over_limit":0,"logs.values.over_limit":0,"reports.errors.send":0},r._internalLogs=[],r._flushIsActive=!1,r.addPlugin(n(29)),r.addPlatformPlugins(t),r.setPlatformOptions(t),t&&r.options(t),r._setupReportOnExit(),r._info("Tracer created with guid "+r._runtimeGUID),r.startPlugins(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"_delegateEventEmitterMethods",value:function(){var t=this;this._ee=new i.default,(0,l.default)(["addListener","emit","eventNames","getMaxListeners","listenerCount","listeners","on","once","prependListener","prependOnceListener","removeAllListeners","removeListener","setMaxListeners"],(function(e){t[e]=function(){t._ee[e]&&t._ee[e].apply(t._ee,arguments)}}))}},{key:"_makeOptionsTable",value:function(){this.addOption("verbosity",{type:"int",min:0,max:9,defaultValue:1}),this.addOption("access_token",{type:"string",defaultValue:""}),this.addOption("component_name",{type:"string",defaultValue:""}),this.addOption("collector_host",{type:"string",defaultValue:"collector.lightstep.com"}),this.addOption("collector_port",{type:"int",defaultValue:443}),this.addOption("collector_path",{type:"string",defaultValue:""}),this.addOption("collector_encryption",{type:"string",defaultValue:"tls"}),this.addOption("tags",{type:"any",defaultValue:{}}),this.addOption("max_reporting_interval_millis",{type:"int",defaultValue:2500}),this.addOption("disabled",{type:"bool",defaultValue:!1}),this.addOption("max_span_records",{type:"int",defaultValue:4096}),this.addOption("default_span_tags",{type:"any",defaultValue:{}}),this.addOption("report_timeout_millis",{type:"int",defaultValue:3e4}),this.addOption("gzip_json_requests",{type:"bool",defaultValue:!0}),this.addOption("disable_reporting_loop",{type:"bool",defaultValue:!1}),this.addOption("disable_report_on_exit",{type:"bool",defaultValue:!1}),this.addOption("delay_initial_report_millis",{type:"int",defaultValue:1e3}),this.addOption("error_throttle_millis",{type:"int",defaultValue:6e4}),this.addOption("certificate_verification",{type:"bool",defaultValue:!0}),this.addOption("override_transport",{type:"any",defaultValue:null}),this.addOption("silent",{type:"bool",defaultValue:!1}),this.addOption("log_field_key_hard_limit",{type:"int",defaultValue:256}),this.addOption("log_field_value_hard_limit",{type:"int",defaultValue:1024})}},{key:"_startSpan",value:function(t,e){var n=this,r=null;if((e=e||{}).references)for(var o=0;o<e.references.length;o++){var i=e.references[o],s=i.type();if(s===this._opentracing.REFERENCE_CHILD_OF||s===this._opentracing.REFERENCE_FOLLOWS_FROM){var c=i.referencedContext();if(!c){this._error("Span reference has an invalid context",c);continue}r=c;break}}var p=r?r._traceGUID:this.generateTraceGUIDForRootSpan(),_=new u.default(this,t,new a.default(this._platform.generateUUID(),p));return _.addTags(this._options.default_span_tags),(0,l.default)(e,(function(t,e){switch(e){case"references":break;case"startTime":_.setBeginMicros(1e3*t);break;case"tags":_.addTags(t);break;default:n._warn("Ignoring unknown field '"+e+"'")}})),null!==r&&_.setParentGUID(r._guid),this.emit("start_span",_),_}},{key:"_inject",value:function(t,e,n){switch(e){case this._opentracing.FORMAT_HTTP_HEADERS:case this._opentracing.FORMAT_TEXT_MAP:this._injectToTextMap(t,n);break;case this._opentracing.FORMAT_BINARY:this._error("Unsupported format: "+e);break;default:this._error("Unknown format: "+e)}}},{key:"_injectToTextMap",value:function(t,e){return e?"object"!=typeof e?void this._error("Unexpected '"+typeof e+"' FORMAT_TEXT_MAP carrier in call to inject"):(e[m+"spanid"]=t._guid,e[m+"traceid"]=t._traceGUID,t.forEachBaggageItem((function(t,n){e[""+y+t]=n})),e[m+"sampled"]="true",e):void this._error("Unexpected null FORMAT_TEXT_MAP carrier in call to inject")}},{key:"_extract",value:function(t,e){switch(t){case this._opentracing.FORMAT_HTTP_HEADERS:case this._opentracing.FORMAT_TEXT_MAP:return this._extractTextMap(t,e);case this._opentracing.FORMAT_BINARY:default:return this._error("Unsupported format: "+t),null}}},{key:"_extractTextMap",value:function(t,e){var n=this,r=new a.default(null,null),o=0;return(0,l.default)(e,(function(t,e){if((e=e.toLowerCase()).substr(0,m.length)===m)switch(e.substr(m.length)){case"traceid":o++,r._traceGUID=t;break;case"spanid":o++,r._guid=t;break;case"sampled":break;default:n._error("Unrecognized carrier key '"+e+"' with recognized prefix. Ignoring.")}})),0===o?null:o<2?(this._error("Only found a partial SpanContext: "+t+", "+e),null):((0,l.default)(e,(function(t,e){if((e=e.toLowerCase()).substr(0,y.length)===y){var n=e.substr(y.length);r.setBaggageItem(n,t)}})),r)}},{key:"flush",value:function(t){return t||(t=function(){}),this._options.disabled?(this._warn("Manual flush() called in disabled state."),t(null)):void this._flushReport(!0,!1,t)}},{key:"guid",value:function(){return this._runtimeGUID}},{key:"verbosity",value:function(){var t=this._options.verbosity;return void 0===t?1:t}},{key:"generateTraceGUIDForRootSpan",value:function(){var t=this._platform.generateUUID();return this._activeRootSpan&&(t=this._activeRootSpan.traceGUID()),t}},{key:"setPlatformOptions",value:function(t){var e=this._platform.options(this)||{};(0,l.default)(t,(function(t,n){e[n]=t})),this.options(e)}},{key:"addOption",value:function(t,e){e.name=t,this._optionDescs.push(e),this._options[e.name]=e.defaultValue}},{key:"options",value:function(t){var e=this;if(0===arguments.length)return console.assert("object"==typeof this._options,"Internal error: _options field incorrect"),this._options;if("object"!=typeof t)throw new Error("options() must be called with an object: type was "+typeof t);0===t.collector_port&&delete t.collector_port,void 0!==t.collector_encryption&&void 0===t.collector_port&&(t.collector_port="none"!==t.collector_encryption?443:80);var n={},r={};for(var o in(0,l.default)(this._optionDescs,(function(o){e._setOptionInternal(n,r,t,o)})),t)void 0===n[o]&&void 0===r[o]&&this._warn("Invalid option "+o+" with value "+t[o]);this._initReportingDataIfNeeded(n),this._reportingLoopActive||this._startReportingLoop(),this.verbosity()>=3&&function(){var t="",r=0;(0,l.default)(n,(function(e,n){t+="\t"+JSON.stringify(n)+": "+JSON.stringify(e.newValue)+"\n",r++})),r>0&&e._debug("Options modified:\n"+t)}(),this.emit("options",n,this._options,this)}},{key:"_setOptionInternal",value:function(t,e,n,r){var o=r.name,i=n[o],s=typeof i;if(void 0!==i){switch(r.type){case"any":break;case"bool":if(!0!==i&&!1!==i)return void this._error("Invalid boolean option '"+o+"' '"+i+"'");break;case"int":if("number"!==s||Math.floor(i)!==i)return void this._error("Invalid int option '"+o+"' '"+i+"'");if(void 0!==r.min&&void 0!==r.max&&!(i>=r.min&&i<=r.max))return void this._error("Option '"+o+"' out of range '"+i+"' is not between "+r.min+" and "+r.max);break;case"string":switch(s){case"string":break;case"number":i=f.toString(i);break;default:return void this._error("Invalid string option "+o+" "+i)}break;case"array":if("[object Array]"!==Object.prototype.toString.call(i))return void this._error("Invalid type for array option "+o+": found '"+s+"'");break;default:return void this._error("Unknown option type '"+r.type+"'")}var a=this._options[o];if(void 0===a)throw new Error("Attempt to set unknown option "+o);if("object"!==s&&a===i)return void(e[o]=!0);t[o]={oldValue:a,newValue:i},this._options[o]=i}}},{key:"_initReportingDataIfNeeded",value:function(t){var e=this;if(null===this._thriftAuth)this._options.access_token.length>0&&this._options.component_name.length>0&&function(){e._runtimeGUID=e._platform.runtimeGUID(e._options.component_name),e._thriftAuth=new c.crouton_thrift.Auth({access_token:e._options.access_token});var t={};(0,l.default)(e._options.tags,(function(n,r){return"string"!=typeof n?void e._error("Tracer tag value is not a string: key="+r):void(t[r]=n)})),t["lightstep.tracer_version"]=v.version;var n=e._platform.tracerTags();(0,l.default)(n,(function(e,n){t[n]=e}));var r=[];(0,l.default)(t,(function(t,e){r.push(new c.crouton_thrift.KeyValue({Key:f.toString(e),Value:f.toString(t)}))})),e._thriftRuntime=new c.crouton_thrift.Runtime({guid:e._runtimeGUID,start_micros:e._startMicros,group_name:e._options.component_name,attrs:r}),e._info("Initializing thrift reporting data",{component_name:e._options.component_name,access_token:e._thriftAuth.access_token}),e.emit("reporting_initialized")}();else{if(!this._thriftRuntime)return this._error("Inconsistent state: thrift auth initialized without runtime.");if(t.access_token)throw new Error("Cannot change access_token after it has been set.");if(t.component_name)throw new Error("Cannot change component_name after it has been set.");if(t.collector_host)throw new Error("Cannot change collector_host after the connection is established");if(t.collector_port)throw new Error("Cannot change collector_port after the connection is established");if(t.collector_path)throw new Error("Cannot change collector_path after the connection is established");if(t.collector_encryption)throw new Error("Cannot change collector_encryption after the connection is established")}}},{key:"addPlatformPlugins",value:function(t){var e=this,n=this._platform.plugins(t);(0,l.default)(n,(function(t){e.addPlugin(t)}))}},{key:"addPlugin",value:function(t){var e=t.name();this._plugins[e]||(this._plugins[e]=t,t.addOptions(this))}},{key:"startPlugins",value:function(){var t=this;(0,l.default)(this._plugins,(function(e,n){t._plugins[n].start(t)}))}},{key:"addActiveRootSpan",value:function(t){this._activeRootSpanSet[t._guid]=t,this._setActiveRootSpanToYoungest()}},{key:"removeActiveRootSpan",value:function(){}