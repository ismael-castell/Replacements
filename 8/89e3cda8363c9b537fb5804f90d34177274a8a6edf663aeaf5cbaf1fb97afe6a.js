!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports.base_tools_pushdialog=t():e.baseToolsPushdialog=t()}(window,(function(){return function(e){function t(t){for(var n,o,r=t[0],s=t[1],a=0,c=[];a<r.length;a++)o=r[a],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&c.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);c.length;)c.shift()()}var n={},o={0:0},i={0:0};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{1:1,2:1}[e]&&t.push(o[e]=new Promise((function(t,n){for(var i=e+".style.min.css",s=r.p+i,a=document.getElementsByTagName("link"),c=0;c<a.length;c++){var u=(f=a[c]).getAttribute("data-href")||f.getAttribute("href");if("stylesheet"===f.rel&&(u===i||u===s))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){var f;if((u=(f=l[c]).getAttribute("data-href"))===i||u===s)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var i=t&&t.target&&t.target.src||s,r=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=i,delete o[e],h.parentNode.removeChild(h),n(r)},h.href=s,document.getElementsByTagName("head")[0].appendChild(h)})).then((function(){o[e]=0})));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,o){n=i[e]=[t,o]}));t.push(n[2]=s);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=function(e){return r.p+"static/js/"+({}[e]||e)+".chunk.js"}(e);var u=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",u.name="ChunkLoadError",u.type=o,u.request=r,n[1](u)}i[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://mjs.sinaimg.cn/umd/base_tools_pushdialog/3.0.8/",r.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp@mfelibs/base_tools_pushdialog"]=window["webpackJsonp@mfelibs/base_tools_pushdialog"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=a;return r(r.s=5)}([function(e,t,n){e.exports=n(4)},function(e,t,n){var o,i;!function(r){if(void 0===(i="function"===typeof(o=r)?o.call(t,n,t,e):o)||(e.exports=i),!0,e.exports=r(),!!0){var s=window.Cookies,a=window.Cookies=r();a.noConflict=function(){return window.Cookies=s,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function i(){}function r(t,n,r){if("undefined"!==typeof document){"number"===typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(u){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,!0!==r[c]&&(a+="="+r[c].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!==typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var a=r[s].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(o.read||o)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(l){}if(i[u]=c,e===u)break}catch(l){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},function(e,t){var n=location.origin+location.pathname,o=function(e){return void 0!=e&&""!=e&&i(document.cookie,e,";","")},i=function(e,t,n,o){if(""==e)return"";t+=o=""==o?"=":o;var i=e.indexOf(t);if(i<0)return"";i+=t.length;var r=e.indexOf(n,i);return r<i&&(r=e.length),e.substring(i,r)};e.exports={collectData:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t="UNKNOW";return e&&(t=e.type||e.effectiveType||t),{connection:e,platform:navigator.platform,urlCutQueryString:n,href:location.href,useragent:navigator.userAgent,ustat:o("ustat")||""}},getCookie:o,handleResponse:function(e){var t=e.ids,n=e.response,o=void 0===n?{}:n,i=e.type,r=[],s={};return t.forEach((function(e){var t=o.hit&&o.hit[e];if(t){var n="gk"===i?t.rs:t;r.push(n),s[e]=n}else r.push(void 0)})),{ary:r,obj:s}},handleResult:function(e,t,n){e.length?t(null,e):t(new Error("".concat(n,"id not matched")))}}},function(e,t,n){window,e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function d(e){return(d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?u(e):t}n.r(t);var g={};g.MQTT=function(e){var t=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var i="Unknown property, "+n+". Valid properties are:";for(var n in t)t.hasOwnProperty(n)&&(i=i+" "+n);throw new Error(i)}if(typeof e[n]!==t[n])throw new Error(r(o.INVALID_TYPE,[typeof e[n],n]))}},n=function(e,t){return function(){return e.apply(t,arguments)}},o={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},i={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},r=function(e,t){var n=e.text;if(t)for(var o,i,r=0;r<t.length;r++)if(o="{"+r+"}",(i=n.indexOf(o))>0){var s=n.substring(0,i),a=n.substring(i+o.length);n=s+t[r]+a}return n},s=[0,6,77,81,73,115,100,112,3],c=[0,4,77,81,84,84,4],u=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function l(e,t){var n,o=t,i=e[t],r=i>>4,s=i&=15;t+=1;var a=0,c=1;do{if(t==e.length)return[null,o];a+=(127&(n=e[t++]))*c,c*=128}while(0!=(128&n));var l=t+a;if(l>e.length)return[null,o];var f=new u(r);switch(r){case 2:1&e[t++]&&(f.sessionPresent=!0),f.returnCode=e[t++];break;case 3:var h=s>>1&3,p=d(e,t),v=y(e,t+=2,p);t+=p,h>0&&(f.messageIdentifier=d(e,t),t+=2);var m=new g.MQTT.Message(e.subarray(t,l));1==(1&s)&&(m.retained=!0),8==(8&s)&&(m.duplicate=!0),m.qos=h,m.destinationName=v,f.payloadMessage=m;break;case 4:case 5:case 6:case 7:case 11:f.messageIdentifier=d(e,t);break;case 9:f.messageIdentifier=d(e,t),t+=2,f.returnCode=e.subarray(t,l)}return[f,l]}function f(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function h(e,t,n,o){return v(e,n,o=f(t,n,o)),o+t}function d(e,t){return 256*e[t]+e[t+1]}function p(e){for(var t=0,n=0;n<e.length;n++){var o=e.charCodeAt(n);o>2047?(55296<=o&&o<=56319&&(n++,t++),t+=3):o>127?t+=2:t++}return t}function v(e,t,n){for(var i=n,s=0;s<e.length;s++){var a=e.charCodeAt(s);if(55296<=a&&a<=56319){var c=e.charCodeAt(++s);if(isNaN(c))throw new Error(r(o.MALFORMED_UNICODE,[a,c]));a=c-56320+(a-55296<<10)+65536}a<=127?t[i++]=a:a<=2047?(t[i++]=a>>6&31|192,t[i++]=63&a|128):a<=65535?(t[i++]=a>>12&15|224,t[i++]=a>>6&63|128,t[i++]=63&a|128):(t[i++]=a>>18&7|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128,t[i++]=63&a|128)}return t}function y(e,t,n){for(var i,s="",a=t;a<t+n;){var c=e[a++];if(c<128)i=c;else{var u=e[a++]-128;if(u<0)throw new Error(r(o.MALFORMED_UTF,[c.toString(16),u.toString(16),""]));if(c<224)i=64*(c-192)+u;else{var l=e[a++]-128;if(l<0)throw new Error(r(o.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16)]));if(c<240)i=4096*(c-224)+64*u+l;else{var f=e[a++]-128;if(f<0)throw new Error(r(o.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16),f.toString(16)]));if(!(c<248))throw new Error(r(o.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16),f.toString(16)]));i=262144*(c-240)+4096*u+64*l+f}}}i>65535&&(i-=65536,s+=String.fromCharCode(55296+(i>>10)),i=56320+(1023&i)),s+=String.fromCharCode(i)}return s}u.prototype.encode=function(){var e=(15&this.type)<<4,t=0,n=new Array,o=0;switch(void 0!=this.messageIdentifier&&(t+=2),this.type){case 1:switch(this.mqttVersion){case 3:t+=s.length+3;break;case 4:t+=c.length+3}if(t+=p(this.clientId)+2,void 0!=this.willMessage){t+=p(this.willMessage.destinationName)+2;var i=this.willMessage.payloadBytes;i instanceof Uint8Array||(i=new Uint8Array(a)),t+=i.byteLength+2}void 0!=this.userName&&(t+=p(this.userName)+2),void 0!=this.password&&(t+=p(this.password)+2);break;case 8:e|=2;for(var r=0;r<this.topics.length;r++)n[r]=p(this.topics[r]),t+=n[r]+2;t+=this.requestedQos.length;break;case 10:for(e|=2,r=0;r<this.topics.length;r++)n[r]=p(this.topics[r]),t+=n[r]+2;break;case 6:e|=2;break;case 3:this.payloadMessage.duplicate&&(e|=8),e=e|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(e|=1),t+=(o=p(this.payloadMessage.destinationName))+2;var a=this.payloadMessage.payloadBytes;t+=a.byteLength,a instanceof ArrayBuffer?a=new Uint8Array(a):a instanceof Uint8Array||(a=new Uint8Array(a.buffer))}var u=function(e){var t=new Array(1),n=0;do{var o=e%128;(e>>=7)>0&&(o|=128),t[n++]=o}while(e>0&&n<4);return t}(t),l=u.length+1,d=new ArrayBuffer(t+l),g=new Uint8Array(d);if(g[0]=e,g.set(u,1),3==this.type)l=h(this.payloadMessage.destinationName,o,g,l);else if(1==this.type){switch(this.mqttVersion){case 3:g.set(s,l),l+=s.length;break;case 4:g.set(c,l),l+=c.length}var v=0;this.cleanSession&&(v=2),void 0!=this.willMessage&&(v|=4,v|=this.willMessage.qos<<3,this.willMessage.retained&&(v|=32)),void 0!=this.userName&&(v|=128),void 0!=this.password&&(v|=64),g[l++]=v,l=f(this.keepAliveInterval,g,l)}switch(void 0!=this.messageIdentifier&&(l=f(this.messageIdentifier,g,l)),this.type){case 1:l=h(this.clientId,p(this.clientId),g,l),void 0!=this.willMessage&&(l=h(this.willMessage.destinationName,p(this.willMessage.destinationName),g,l),l=f(i.byteLength,g,l),g.set(i,l),l+=i.byteLength),void 0!=this.userName&&(l=h(this.userName,p(this.userName),g,l)),void 0!=this.password&&(l=h(this.password,p(this.password),g,l));break;case 3:g.set(a,l);break;case 8:for(r=0;r<this.topics.length;r++)l=h(this.topics[r],n[r],g,l),g[l++]=this.requestedQos[r];break;case 10:for(r=0;r<this.topics.length;r++)l=h(this.topics[r],n[r],g,l)}return d};var m=function(e,t,n){this._client=e,this._window=t,this._keepAliveInterval=1e3*n,this.isReset=!1;var i=new u(12).encode(),s=function(e){return function(){return a.apply(e)}},a=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(i),this.timeout=this._window.setTimeout(s(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(o.PING_TIMEOUT.code,r(o.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(s(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},w=function(e,t,n,o,i){this._window=t,n||(n=30),this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(o,e,i),1e3*n),this.cancel=function(){this._window.clearTimeout(this.timeout)}},_=function(t,n,i,s,a){if(!("WebSocket"in e)||null===e.WebSocket)throw new Error(r(o.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in e)||null===e.localStorage)throw new Error(r(o.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in e)||null===e.ArrayBuffer)throw new Error(r(o.UNSUPPORTED,["ArrayBuffer"]));for(var c in this._trace("Paho.MQTT.Client",t,n,i,s,a),this.host=n,this.port=i,this.path=s,this.uri=t,this.clientId=a,this._localKey=n+":"+i+("/mqtt"!=s?":"+s:"")+":"+a+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,localStorage)0!=c.indexOf("Sent:"+this._localKey)&&0!=c.indexOf("Received:"+this._localKey)||this.restore(c)};_.prototype.host,_.prototype.port,_.prototype.path,_.prototype.uri,_.prototype.clientId,_.prototype.socket,_.prototype.connected=!1,_.prototype.maxMessageIdentifier=65536,_.prototype.connectOptions,_.prototype.hostIndex,_.prototype.onConnectionLost,_.prototype.onMessageDelivered,_.prototype.onMessageArrived,_.prototype.traceFunction,_.prototype._msg_queue=null,_.prototype._connectTimeout,_.prototype.sendPinger=null,_.prototype.receivePinger=null,_.prototype.receiveBuffer=null,_.prototype._traceBuffer=null,_.prototype._MAX_TRACE_ENTRIES=100,_.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(r(o.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(r(o.INVALID_STATE,["already connected"]));this.connectOptions=e,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},_.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(r(o.INVALID_STATE,["not connected"]));var n=new u(8);n.topics=[e],void 0!=t.qos?n.requestedQos=[t.qos]:n.requestedQos=[0],t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e})}),t.timeout&&(n.timeOut=new w(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:o.SUBSCRIBE_TIMEOUT.code,errorMessage:r(o.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},_.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(r(o.INVALID_STATE,["not connected"]));var n=new u(10);n.topics=[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new w(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:o.UNSUBSCRIBE_TIMEOUT.code,errorMessage:r(o.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},_.prototype.send=function(e){if(this._trace("Client.send",e),!this.connected)throw new Error(r(o.INVALID_STATE,["not connected"]));wireMessage=new u(3),wireMessage.payloadMessage=e,e.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage)},_.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw new Error(r(o.INVALID_STATE,["not connecting or connected"]));var e=new u(14);this._notify_msg_sent[e]=n(this._disconnected,this),this._schedule_message(e)},_.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},_.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@")},_.prototype.stopTrace=function(){delete this._traceBuffer},_.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=n(this._on_socket_open,this),this.socket.onmessage=n(this._on_socket_message,this),this.socket.onerror=n(this._on_socket_error,this),this.socket.onclose=n(this._on_socket_close,this),this.sendPinger=new m(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new m(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new w(this,window,this.connectOptions.timeout,this._disconnected,[o.CONNECT_TIMEOUT.code,r(o.CONNECT_TIMEOUT)])},_.prototype._schedule_message=function(e){this._msg_queue.push(e),this.connected&&this._process_queue()},_.prototype.store=function(e,t){var n={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case 3:t.pubRecReceived&&(n.pubRecReceived=!0),n.payloadMessage={};for(var i="",s=t.payloadMessage.payloadBytes,a=0;a<s.length;a++)s[a]<=15?i=i+"0"+s[a].toString(16):i+=s[a].toString(16);n.payloadMessage.payloadHex=i,n.payloadMessage.qos=t.payloadMessage.qos,n.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(n.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(n.payloadMessage.retained=!0),0==e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),n.sequence=t.sequence);break;default:throw Error(r(o.INVALID_STORED_DATA,[key,n]))}localStorage.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(n))},_.prototype.restore=function(e){var t=localStorage.getItem(e),n=JSON.parse(t),i=new u(n.type,n);switch(n.type){case 3:for(var s=n.payloadMessage.payloadHex,a=new ArrayBuffer(s.length/2),c=new Uint8Array(a),l=0;s.length>=2;){var f=parseInt(s.substring(0,2),16);s=s.substring(2,s.length),c[l++]=f}var h=new g.MQTT.Message(c);h.qos=n.payloadMessage.qos,h.destinationName=n.payloadMessage.destinationName,n.payloadMessage.duplicate&&(h.duplicate=!0),n.payloadMessage.retained&&(h.retained=!0),i.payloadMessage=h;break;default:throw Error(r(o.INVALID_STORED_DATA,[e,t]))}0==e.indexOf("Sent:"+this._localKey)?(i.payloadMessage.duplicate=!0,this._sentMessages[i.messageIdentifier]=i):0==e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[i.messageIdentifier]=i)},_.prototype._process_queue=function(){for(var e=null,t=this._msg_queue.reverse();e=t.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},_.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,3===e.type&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},_.prototype._on_socket_open=function(){var e=new u(1,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},_.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data),this.receivePinger.reset();for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},_.prototype._deframeMessages=function(e){var t=new Uint8Array(e);if(this.receiveBuffer){var n=new Uint8Array(this.receiveBuffer.length+t.length);n.set(this.receiveBuffer),n.set(t,this.receiveBuffer.length),t=n,delete this.receiveBuffer}try{for(var i=0,s=[];i<t.length;){var c=l(t,i),u=c[0];if(i=c[1],null===u)break;s.push(u)}i<t.length&&(this.receiveBuffer=t.subarray(i))}catch(a){return void this._disconnected(o.INTERNAL_ERROR.code,r(o.INTERNAL_ERROR,[a.message,a.stack.toString()]))}return s},_.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case 2:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var n=this._sentMessages[t];localStorage.removeItem("Sent:"+this._localKey+n.messageIdentifier)}for(var t in this._sentMessages={},this._receivedMessages){var s=this._receivedMessages[t];localStorage.removeItem("Received:"+this._localKey+s.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(o.CONNACK_RETURNCODE.code,r(o.CONNACK_RETURNCODE,[e.returnCode,i[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var a=new Array;for(var c in this._sentMessages)this._sentMessages.hasOwnProperty(c)&&a.push(this._sentMessages[c]);a=a.sort((function(e,t){return e.sequence-t.sequence}));for(var f=0,h=a.length;f<h;f++)if(3==(n=a[f]).type&&n.pubRecReceived){var d=new u(6,{messageIdentifier:n.messageIdentifier});this._schedule_message(d)}else this._schedule_message(n);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case 3:this._receivePublish(e);break;case 4:(n=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage));break;case 5:(n=this._sentMessages[e.messageIdentifier])&&(n.pubRecReceived=!0,d=new u(6,{messageIdentifier:e.messageIdentifier}),this.store("Sent:",n),this._schedule_message(d));break;case 6:s=this._receivedMessages[e.messageIdentifier],localStorage.removeItem("Received:"+this._localKey+e.messageIdentifier),s&&(this._receiveMessage(s),delete this._receivedMessages[e.messageIdentifier]);var p=new u(7,{messageIdentifier:e.messageIdentifier});this._schedule_message(p);break;case 7:n=this._sentMessages[e.messageIdentifier],delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage);break;case 9:(n=this._sentMessages[e.messageIdentifier])&&(n.timeOut&&n.timeOut.cancel(),128===e.returnCode[0]?n.onFailure&&n.onFailure(e.returnCode):n.onSuccess&&n.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case 11:(n=this._sentMessages[e.messageIdentifier])&&(n.timeOut&&n.timeOut.cancel(),n.callback&&n.callback(),delete this._sentMessages[e.messageIdentifier]);break;case 13:this.sendPinger.reset();break;case 14:this._disconnected(o.INVALID_MQTT_MESSAGE_TYPE.code,r(o.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(o.INVALID_MQTT_MESSAGE_TYPE.code,r(o.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(l){return void this._disconnected(o.INTERNAL_ERROR.code,r(o.INTERNAL_ERROR,[l.message,l.stack.toString()]))}},_.prototype._on_socket_error=function(e){this._disconnected(o.SOCKET_ERROR.code,r(o.SOCKET_ERROR,[e.data]))},_.prototype._on_socket_close=function(){this._disconnected(o.SOCKET_CLOSE.code,r(o.SOCKET_CLOSE))},_.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},_.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new u(4,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new u(5,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},_.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},_.prototype._disconnected=function(e,t){this._trace("Client._disconnected",e,t),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===e&&(e=o.OK.code,t=r(o.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t})):4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t}))},_.prototype._trace=function(){if(this.traceFunction){for(var e in arguments)"undefined"!==typeof arguments[e]&&(arguments[e]=JSON.stringify(arguments[e]));var t=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:t})}if(null!==this._traceBuffer){e=0;for(var n=arguments.length;e<n;e++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===e||"undefined"===typeof arguments[e]?this._traceBuffer.push(arguments[e]):this._traceBuffer.push("  "+JSON.stringify(arguments[e]))}},_.prototype._traceMask=function(e,t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=o==t?"******":e[o]);return n};var A=function(e,n,i,s){var a;if("string"!==typeof e)throw new Error(r(o.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){s=n;var c=(a=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!c)throw new Error(r(o.INVALID_ARGUMENT,[e,"host"]));e=c[4]||c[2],n=parseInt(c[7]),i=c[8]}else{if(3==arguments.length&&(s=i,i="/mqtt"),"number"!==typeof n||n<0)throw new Error(r(o.INVALID_TYPE,[typeof n,"port"]));if("string"!==typeof i)throw new Error(r(o.INVALID_TYPE,[typeof i,"path"]));var u=-1!=e.indexOf(":")&&"["!=e.slice(0,1)&&"]"!=e.slice(-1);a="ws://"+(u?"["+e+"]":e)+":"+n+i}for(var l=0,f=0;f<s.length;f++){var h=s.charCodeAt(f);55296<=h&&h<=56319&&f++,l++}if("string"!==typeof s||l>65535)throw new Error(r(o.INVALID_ARGUMENT,[s,"clientId"]));var d=new _(a,e,n,i,s);this._getHost=function(){return e},this._setHost=function(){throw new Error(r(o.UNSUPPORTED_OPERATION))},this._getPort=function(){return n},this._setPort=function(){throw new Error(r(o.UNSUPPORTED_OPERATION))},this._getPath=function(){return i},this._setPath=function(){throw new Error(r(o.UNSUPPORTED_OPERATION))},this._getURI=function(){return a},this._setURI=function(){throw new Error(r(o.UNSUPPORTED_OPERATION))},this._getClientId=function(){return d.clientId},this._setClientId=function(){throw new Error(r(o.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return d.onConnectionLost},this._setOnConnectionLost=function(e){if("function"!==typeof e)throw new Error(r(o.INVALID_TYPE,[typeof e,"onConnectionLost"]));d.onConnectionLost=e},this._getOnMessageDelivered=function(){return d.onMessageDelivered},this._setOnMessageDelivered=function(e){if("function"!==typeof e)throw new Error(r(o.INVALID_TYPE,[typeof e,"onMessageDelivered"]));d.onMessageDelivered=e},this._getOnMessageArrived=function(){return d.onMessageArrived},this._setOnMessageArrived=function(e){if("function"!==typeof e)throw new Error(r(o.INVALID_TYPE,[typeof e,"onMessageArrived"]));d.onMessageArrived=e},this._getTrace=function(){return d.traceFunction},this._setTrace=function(e){if("function"!==typeof e)throw new Error(r(o.INVALID_TYPE,[typeof e,"onTrace"]));d.traceFunction=e},this.connect=function(e){if(t(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(r(o.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0===e.password&&void 0!==e.userName)throw new Error(r(o.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof b))throw new Error(r(o.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload,"undefined"===typeof e.willMessage.destinationName)throw new Error(r(o.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if("undefined"===typeof e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(r(o.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(r(o.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var n=!1,s=0;s<e.hosts.length;s++){if("string"!==typeof e.hosts[s])throw new Error(r(o.INVALID_TYPE,[typeof e.hosts[s],"connectOptions.hosts["+s+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[s])){if(0==s)n=!0;else if(!n)throw new Error(r(o.INVALID_ARGUMENT,[e.hosts[s],"connectOptions.hosts["+s+"]"]))}else if(n)throw new Error(r(o.INVALID_ARGUMENT,[e.hosts[s],"connectOptions.hosts["+s+"]"]))}if(n)e.uris=e.hosts;else{if(!e.ports)throw new Error(r(o.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(r(o.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!=e.ports.length)throw new Error(r(o.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],s=0;s<e.hosts.length;s++){if("number"!==typeof e.ports[s]||e.ports[s]<0)throw new Error(r(o.INVALID_TYPE,[typeof e.ports[s],"connectOptions.ports["+s+"]"]));var c=e.hosts[s],u=e.ports[s],l=-1!=c.indexOf(":");a="ws://"+(l?"["+c+"]":c)+":"+u+i,e.uris.push(a)}}}d.connect(e)},this.subscribe=function(e,n){if("string"!==typeof e)throw new Error("Invalid argument:"+e);if(t(n=n||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),n.timeout&&!n.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!==typeof n.qos&&0!==n.qos&&1!==n.qos&&2!==n.qos)throw new Error(r(o.INVALID_ARGUMENT,[n.qos,"subscribeOptions.qos"]));d.subscribe(e,n)},this.unsubscribe=function(e,n){if("string"!==typeof e)throw new Error("Invalid argument:"+e);if(t(n=n||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),n.timeout&&!n.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");d.unsubscribe(e,n)},this.send=function(e,t,n,i){var s;if(0==arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof b)&&"string"!==typeof e)throw new Error("Invalid argument:"+typeof e);if("undefined"===typeof(s=e).destinationName)throw new Error(r(o.INVALID_ARGUMENT,[s.destinationName,"Message.destinationName"]));d.send(s)}else(s=new b(t)).destinationName=e,arguments.length>=3&&(s.qos=n),arguments.length>=4&&(s.retained=i),d.send(s)},this.disconnect=function(){d.disconnect()},this.getTraceLog=function(){return d.getTraceLog()},this.startTrace=function(){d.startTrace()},this.stopTrace=function(){d.stopTrace()},this.isConnected=function(){return d.connected}};A.prototype={get host(){return this._getHost()},set host(e){this._setHost(e)},get port(){return this._getPort()},set port(e){this._setPort(e)},get path(){return this._getPath()},set path(e){this._setPath(e)},get clientId(){return this._getClientId()},set clientId(e){this._setClientId(e)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(e){this._setOnConnectionLost(e)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(e){this._setOnMessageDelivered(e)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(e){this._setOnMessageArrived(e)},get trace(){return this._getTrace()},set trace(e){this._setTrace(e)}};var b=function(e){var t;if(!("string"===typeof e||e instanceof ArrayBuffer||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array))throw r(o.INVALID_ARGUMENT,[e,"newPayload"]);t=e,this._getPayloadString=function(){return"string"===typeof t?t:y(t,0,t.length)},this._getPayloadBytes=function(){if("string"===typeof t){var e=new ArrayBuffer(p(t)),n=new Uint8Array(e);return v(t,n,0),n}return t};var n=void 0;this._getDestinationName=function(){return n},this._setDestinationName=function(e){if("string"!==typeof e)throw new Error(r(o.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e};var i=0;this._getQos=function(){return i},this._setQos=function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);i=e};var s=!1;this._getRetained=function(){return s},this._setRetained=function(e){if("boolean"!==typeof e)throw new Error(r(o.INVALID_ARGUMENT,[e,"newRetained"]));s=e};var a=!1;this._getDuplicate=function(){return a},this._setDuplicate=function(e){a=e}};return b.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(e){this._setDestinationName(e)},get qos(){return this._getQos()},set qos(e){this._setQos(e)},get retained(){return this._getRetained()},set retained(e){this._setRetained(e)},get duplicate(){return this._getDuplicate()},set duplicate(e){this._setDuplicate(e)}},{Client:A,Message:b}}(window);var v,y=g,m=function(){function e(){s(this,e),this._evtMap={},this._evtBuffer={}}return c(e,[{key:"trigger",value:function(e,t){var n=this,o=this._evtMap[e];o&&o.slice().forEach((function(e){e.apply(n,[].concat(t))}))}},{key:"triggerWithBuffer",value:function(e,t){this.trigger(e,t),this._evtBuffer[e]={args:t}}},{key:"replayBuffer",value:function(e,t){var n=this._evtBuffer[e];n&&t.apply(null,[].concat(n.args))}},{key:"on",value:function(e,t){this.replayBuffer(e,t),this._evtMap[e]?this._evtMap[e].push(t):this._evtMap[e]=[t]}},{key:"off",value:function(e,t){if(this._evtMap[e]&&t){var n=this._evtMap[e].indexOf(t);if(n>-1)return this._evtMap[e].splice(n,1)[0]}t||this._evtMap[name]&&(this._evtMap[name]=[])}},{key:"offAll",value:function(){this._evtMap={}}}]),e}(),w=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(o,e);var t,n=(t=o,function(){var e,n=f(t);if(h()){var o=f(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return p(this,e)});function o(e){var t;return s(this,o),(t=n.call(this)).options=e,t._triggeredConnected=!1,t._connectFailTimes=0,t._maxTryConnTimes=20,t._maxTrySubTimes=100,t._subList=[],t._reconnectDelay=1e3,function(e){for(var t=["host","port","clientId","keepAliveInterval"],n=0;n<t.length;n++)if(!e[t[n]])throw new Error(t[n]+"needed");return!0}(e)&&(t.client=new y.MQTT.Client(e.host,Number(e.port),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="/mqtt",n=[];return Object.keys(e).forEach((function(t){n.push(t+"="+e[t])})),n.length>0?t+"?"+n.join("&"):t}(e.query),e.clientId),t.client.onConnectionLost=t._onConnectionLost.bind(u(t)),t.client.onMessageDelivered=t._onMessageDelivered.bind(u(t)),t.client.onMessageArrived=t._onMessageArrived.bind(u(t)),t._connect()),t}return c(o,[{key:"_connect",value:function(){this.client.connect({useSSL:this.options.useSSL,onSuccess:this._onSuccess.bind(this),onFailure:this._onFailure.bind(this),keepAliveInterval:parseInt(this.options.keepAliveInterval)})}},{key:"_onConnectionLost",value:function(e){var t=this;console.log("mqtt.connectionlost"),this._connectFailTimes++,this.trigger("lostConnect",e),0!==e.errorCode&&this._connectFailTimes<this._maxTryConnTimes&&setTimeout((function(){t.trigger("reconnecting"),t._connect()}),this._reconnectDelay)}},{key:"_onMessageDelivered",value:function(){console.log("mqtt.msgdelivered")}},{key:"_onMessageArrived",value:function(e){this.trigger("message",e.payloadString)}},{key:"_onSuccess",value:function(){var e=this;this._connectFailTimes=0,this._subList.forEach((function(t){e.subscribe(t,!0)})),console.log("mqtt.connected"),this.trigger("connected")}},{key:"_onFailure",value:function(){var e=this;console.log("mqtt.failure"),this._connectFailTimes++,this._connectFailTimes<this._maxTryConnTimes?setTimeout((function(){e.trigger("reconnecting"),e._connect()}),this._reconnectDelay):this._downgradeLoop()}},{key:"_downgradeLoop",value:function(){this.trigger("shouldDowngrade")}},{key:"subscribe",value:function(e,t){t||this._subList.push(e);var n=0,o=this;!function t(){n<o._maxTrySubTimes&&(n++,o._doSub(e,(function(){}),t))}()}},{key:"_doSub",value:function(e,t,n){this.client.subscribe(e.topic,{qos:1,timeout:30,onSuccess:t,onFailure:n})}}]),o}(m),_=function(e,t,n){var o=new XMLHttpRequest,i=Object.keys(t);i.length>0&&!e.indexOf("?")>0?e+="?":i.length>0&&e.indexOf("?")>0&&(e+="&"),i.forEach((function(n,o){e+=n+"="+t[n],o<t.length-1&&(e+="&")})),o.open("GET",e,!0),o.onload=function(){try{var e=JSON.parse(o.responseText);n(null,e)}catch(t){n(t)}},o.onerror=function(e){n(e)},o.send(null)},A={},b="https://pigeon.sina.cn/sched",E="https://dpigeon.sina.cn/order/polling",I=!1,T=!1,O=[],M=[],S=new m,C=function(){},k=function(e,t){"function"===typeof t&&S.on("_recive."+e,t)},N=function(e){"function"===typeof e&&S.on("_connected",e)},D=function(e){"function"===typeof e&&S.on("_reconnecting",e)},P=function(e){"function"===typeof e&&S.on("_lostConnect",e)},L=function(e){"function"===typeof e&&S.on("_shouldDowngrade",e)},x=function(){S.trigger("destory")};function R(e){v.unsubscribe({topic:e})}function j(e){e=r(r({},A),e),T?(v.subscribe({topic:e.topic}),v.on("lostconnect",(function(){T=!1}))):v.on("connected",(function(){v.subscribe({topic:e.topic}),T=!0,e.success&&e.success()})),v.on("shouldDowngrade",(function(){S.trigger("_shouldDowngrade"),e.notAllowDowngrade||function(e,t,n){var o,i=(new Date).getTime(),r=0;setInterval((function(){var n=(new Date).getTime();(n-i)/1e3<r||(i=n,_(e,{topics:o?t+":"+o:t},(function(e,t){if(e)r=10;else if(0===t.code&&t.data){var n=t.data.pollingInfo;if(n.length){var i=n[0].msgs;o=i[0]&&i[0].msgid,M=M.concat(i)}r=t.data.nextPollingInterval||10}})))}),50)}(e.polling,e.topic)}))}function U(e,t,n){t.subscribe({topic:e.topic}),e.success&&e.success(),n()}t.default={connection:function(e){return e.app=e.app||"",e.sched=e.sched||b,e.polling=e.polling||E,e.app&&(e.polling=e.polling+"?app="+e.app),A=e,new Promise((function(t,n){if(I)if(T)U(e,v,t);else var o=setInterval((function(){T&&(clearInterval(o),U(e,v,t))}),100);else I=!0,_(e.sched,{},(function(o,i){if(o&&"function"===typeof e.error)return e.error(o);if(0==i.code){var s=i.data.broker,a=s.split(":")[1],c=s.split(":")[0],u=i.data.keepAliveInterval,l=i.data.protocol,f=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+"-"+e()+"-"+Date.now()}(),h={app:e.app};e.query&&(h=r(r({},h),e.query)),v=new w({query:h,useSSL:"wss"===l,port:a,host:c,clientId:f,keepAliveInterval:u}),S.on("destory",(function(){v.client.disconnect(),I=!1,M=[],T=!1,v=null,S.offAll()})),v.on("reconnecting",(function(){S.trigger("_reconnecting")})),v.on("lostConnect",(function(e){S.trigger("_lostConnect",e)})),v.on("connected",(function(e){S.trigger("_connected",e)})),v.on("message",(function(e){M.push(e)})),C=function(){v._connent()},setInterval((function(){(function e(){var t=[];return M.length&&0===(t=function(e,t){var n,o=[];if("string"===typeof e)try{e=JSON.parse(e)}catch(r){return S.trigger("_error",r,e),o}var i=e.topic;try{n=JSON.parse(e.content)}catch(r){return S.trigger("_error",r,e.content),o}return t.forEach((function(e){o.push({action:e,data:n,topic:i})})),o}(M.shift(),O)).length?e():t})().forEach((function(t){S.trigger("_recive."+t.topic,{errCode:0,data:{data:t.data,action:t.action,topic:t.topic}},e)}))}),50),t({openMessage:j,closeMessage:R,onMessage:k,onReconnecting:D,onConnected:N,onLostConnect:P,onShouldDowngrade:L,reconn:C,destory:x})}else e.error&&e.error(i.msg),n(i.msg)}));O.push(e.action||"wap_push"),e.complete&&e.complete()}))},onMessage:k,openMessage:j,closeMessage:R,onError:function(e){"function"===typeof e&&S.on("_error",e)},onLostConnect:P,onReconnecting:D,onConnected:N,onShouldDowngrade:L,changeRequest:function(e){_=e},reconn:C}}])},function(e,t,n){var o=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(O){a=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var i=t&&t.prototype instanceof f?t:f,r=Object.create(i.prototype),s=new E(o||[]);return r._invoke=function(e,t,n){var o="suspendedStart";return function(i,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===i)throw r;return T()}for(n.method=i,n.arg=r;;){var s=n.delegate;if(s){var a=_(s,n);if(a){if(a===l)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var c=u(e,t,n);if("normal"===c.type){if(o=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o="completed",n.method="throw",n.arg=c.arg)}}}(e,n,s),r}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(O){return{type:"throw",arg:O}}}e.wrap=c;var l={};function f(){}function h(){}function d(){}var p={};a(p,i,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(I([])));v&&v!==t&&n.call(v,i)&&(p=v);var y=d.prototype=f.prototype=Object.create(p);function m(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var o;this._invoke=function(i,r){function s(){return new t((function(o,s){!function o(i,r,s,a){var c=u(e[i],e,r);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"===typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,s,a)}),(function(e){o("throw",e,s,a)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return o("throw",e,s,a)}))}a(c.arg)}(i,r,o,s)}))}return o=o?o.then(s,s):s()}}function _(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var o=u(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,l;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(e){if(e){var t=e[i];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,a(y,"constructor",d),a(d,"constructor",h),h.displayName=a(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(w.prototype),a(w.prototype,r,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var s=new w(c(t,n,o,i),r);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),a(y,s,"Generator"),a(y,i,(function(){return this})),a(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},e.values=I,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return s.type="throw",s.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var a=n.call(r,"catchLoc"),c=n.call(r,"finallyLoc");if(a&&c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;b(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=o}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o);function r(e){if(Array.isArray(e))return e}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function a(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){return r(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(c){i=!0,r=c}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}}(e,t)||a(e,t)||c()}function l(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function f(e){return function(e){if(Array.isArray(e))return s(e)}(e)||l(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t,n,o,i,r,s){try{var a=e[r](s),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(o,i)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var r=e.apply(t,n);function s(e){h(r,o,i,s,a,"next",e)}function a(e){h(r,o,i,s,a,"throw",e)}s(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var y=n(1),m=n.n(y);function w(e){return new Date(e.replace(/-/g,"/"))}var _=function(){function e(t,n,o,i,r,s,a,c){p(this,e),this.title=void 0,this.content=void 0,this.evtName=void 0,this.dataid=void 0,this.routeuri=void 0,this.golink=void 0,this.link=void 0,this.newsid=void 0,this.pushtime=void 0,this.title=t,this.content=n,this.evtName=o,this.dataid=i,this.routeuri=r,this.golink=this.link=s,this.newsid=a,this.pushtime=w(c)}return v(e,null,[{key:"getInstance",value:function(t){return new e(t.title,t.content,"_push_dialog_"+Date.now(),t.dataid,t.routeuri,t.url,t.newsid,t.pushtime)}}]),e}(),A={},b=!1;function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=n(2),M=function(){function e(){p(this,e),this.listeners=void 0,this.cache=void 0,this.listeners=[],this.cache=[]}return v(e,[{key:"on",value:function(e,t,n,o,i){t=t.join(","),n=JSON.stringify(n);var r=this.getCache(e,t,n,i);if(r)return o(r.err,r.resAry,r.resObject),!1;var s=this.listeners.findIndex((function(o){return o.type===e&&o.ids===t&&o.data===n&&o.isNative===i}));return this.listeners.push({type:e,ids:t,data:n,cb:o}),-1===s}},{key:"emit",value:function(e,t,n,o,i,r,s){t=t.join(","),n=JSON.stringify(n),this.cache.push({type:e,ids:t,data:n,err:o,resAry:i,resObject:r}),this.listeners.forEach((function(a){a.type===e&&a.ids===t&&a.data===n&&a.isNative===s&&a.cb(o,i,r)}))}},{key:"getCache",value:function(e,t,n,o){var i=this.cache.findIndex((function(i){return i.type===e&&i.ids===t&&i.data===n&&i.isNative===o}));return i>-1?this.cache[i]:null}},{key:"getEmit",value:function(e,t,n,o){var i=this;return function(r,s,a){i.emit(e,t,n,r,s,a,o)}}}]),e}();Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!==typeof e)throw new TypeError("predicate must be a function");for(var o=arguments[1],i=0;i<n;){var r=t[i];if(e.call(o,r,i,t))return i;i++}return-1},configurable:!0,writable:!0});var S=new M,C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),this.jsb=t.jsb,this.version=t.version||"v1",this.id_prefix=t.id_prefix||"",this.gkurl=t.gkurl||"https://gk.sina.cn/".concat(this.version,"/gkmatch"),this.qeurl=t.qeurl||"https://gk.sina.cn/".concat(this.version,"/qematch"),this.closeCache=t.closeCache}return v(e,[{key:"getQueueKey",value:function(){}