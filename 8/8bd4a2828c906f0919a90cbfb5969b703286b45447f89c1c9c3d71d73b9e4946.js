(function(){function e(e){var t=true;var i=false;var a=null;var n={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function s(e){if(e&&e!==document&&e.nodeName!=="HTML"&&e.nodeName!=="BODY"&&"classList"in e&&"contains"in e.classList){return true}return false}function r(e){var t=e.type;var i=e.tagName;if(i==="INPUT"&&n[t]&&!e.readOnly){return true}if(i==="TEXTAREA"&&!e.readOnly){return true}if(e.isContentEditable){return true}return false}function o(e){if(e.classList.contains("focus-visible")){return}e.classList.add("focus-visible");e.setAttribute("data-focus-visible-added","")}function l(e){if(!e.hasAttribute("data-focus-visible-added")){return}e.classList.remove("focus-visible");e.removeAttribute("data-focus-visible-added")}function c(i){if(i.metaKey||i.altKey||i.ctrlKey){return}if(s(e.activeElement)){o(e.activeElement)}t=true}function u(e){t=false}function d(e){if(!s(e.target)){return}if(t||r(e.target)){o(e.target)}}function f(e){if(!s(e.target)){return}if(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added")){i=true;window.clearTimeout(a);a=window.setTimeout((function(){i=false}),100);l(e.target)}}function h(e){if(document.visibilityState==="hidden"){if(i){t=true}p()}}function p(){document.addEventListener("mousemove",H);document.addEventListener("mousedown",H);document.addEventListener("mouseup",H);document.addEventListener("pointermove",H);document.addEventListener("pointerdown",H);document.addEventListener("pointerup",H);document.addEventListener("touchmove",H);document.addEventListener("touchstart",H);document.addEventListener("touchend",H)}function m(){document.removeEventListener("mousemove",H);document.removeEventListener("mousedown",H);document.removeEventListener("mouseup",H);document.removeEventListener("pointermove",H);document.removeEventListener("pointerdown",H);document.removeEventListener("pointerup",H);document.removeEventListener("touchmove",H);document.removeEventListener("touchstart",H);document.removeEventListener("touchend",H)}function H(e){if(e.target.nodeName&&e.target.nodeName.toLowerCase()==="html"){return}t=false;m()}document.addEventListener("keydown",c,true);document.addEventListener("mousedown",u,true);document.addEventListener("pointerdown",u,true);document.addEventListener("touchstart",u,true);document.addEventListener("visibilitychange",h,true);p();e.addEventListener("focus",d,true);e.addEventListener("blur",f,true);if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host){e.host.setAttribute("data-js-focus-visible","")}else if(e.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=e;var t;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){t=document.createEvent("CustomEvent");t.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(t)}if(typeof document!=="undefined"){e(document)}})();
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */(function(e,t,i){var a=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)};var n=function(){var a={};var n=t.createElement("div").style;var s=function(){var e=["t","webkitT","MozT","msT","OT"],t,i=0,a=e.length;for(;i<a;i++){t=e[i]+"ransform";if(t in n)return e[i].substr(0,e[i].length-1)}return false}();function r(e){if(s===false)return false;if(s==="")return e;return s+e.charAt(0).toUpperCase()+e.substr(1)}a.getTime=Date.now||function e(){return(new Date).getTime()};a.extend=function(e,t){for(var i in t){e[i]=t[i]}};a.addEvent=function(e,t,i,a){e.addEventListener(t,i,!!a)};a.removeEvent=function(e,t,i,a){e.removeEventListener(t,i,!!a)};a.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t};a.momentum=function(e,t,a,n,s,r){var o=e-t,l=i.abs(o)/a,c,u;r=r===undefined?6e-4:r;c=e+l*l/(2*r)*(o<0?-1:1);u=l/r;if(c<n){c=s?n-s/2.5*(l/8):n;o=i.abs(c-e);u=o/l}else if(c>0){c=s?s/2.5*(l/8):0;o=i.abs(e)+c;u=o/l}return{destination:i.round(c),duration:u}};var o=r("transform");a.extend(a,{hasTransform:o!==false,hasPerspective:r("perspective")in n,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:r("transition")in n});a.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion);a.extend(a.style={},{transform:o,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")});a.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)};a.addClass=function(e,t){if(a.hasClass(e,t)){return}var i=e.className.split(" ");i.push(t);e.className=i.join(" ")};a.removeClass=function(e,t){if(!a.hasClass(e,t)){return}var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")};a.offset=function(e){var t=-e.offsetLeft,i=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;i-=e.offsetTop}return{left:t,top:i}};a.preventDefaultException=function(e,t){for(var i in t){if(t[i].test(e[i])){return true}}return false};a.extend(a.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});a.extend(a.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return i.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e=e-1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){if((e/=1)<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}}},elastic:{style:"",fn:function(e){var t=.22,a=.4;if(e===0){return 0}if(e==1){return 1}return a*i.pow(2,-10*e)*i.sin((e-t/4)*(2*i.PI)/t)+1}}});a.tap=function(e,i){var a=t.createEvent("Event");a.initEvent(i,true,true);a.pageX=e.pageX;a.pageY=e.pageY;e.target.dispatchEvent(a)};a.click=function(e){var i=e.target,a;if(!/(SELECT|INPUT|TEXTAREA)/i.test(i.tagName)){a=t.createEvent("MouseEvents");a.initMouseEvent("click",true,true,e.view,1,i.screenX,i.screenY,i.clientX,i.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);a._constructed=true;i.dispatchEvent(a)}};return a}();function s(e,i){this.wrapper=typeof e=="string"?t.querySelector(e):e;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var a in i){this.options[a]=i[a]}this.translateZ=this.options.HWCompositing&&n.hasPerspective?" translateZ(0)":"";this.options.useTransition=n.hasTransition&&this.options.useTransition;this.options.useTransform=n.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?n.ease[this.options.bounceEasing]||n.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}s.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(e){if(n.eventType[e.type]!=1){if(e.button!==0){return}}if(!this.enabled||this.initiated&&n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.isBadAndroid&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.touches?e.touches[0]:e,a;this.initiated=n.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=n.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;a=this.getComputedPosition();this._translate(i.round(a.x),i.round(a.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=t.pageX;this.pointY=t.pageY;this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault){e.preventDefault()}var t=e.touches?e.touches[0]:e,a=t.pageX-this.pointX,s=t.pageY-this.pointY,r=n.getTime(),o,l,c,u;this.pointX=t.pageX;this.pointY=t.pageY;this.distX+=a;this.distY+=s;c=i.abs(this.distX);u=i.abs(this.distY);if(r-this.endTime>300&&(c<10&&u<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(c>u+this.options.directionLockThreshold){this.directionLocked="h"}else if(u>=c+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){e.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){e.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}a=0}a=this.hasHorizontalScroll?a:0;s=this.hasVerticalScroll?s:0;o=this.x+a;l=this.y+s;if(o>0||o<this.maxScrollX){o=this.options.bounce?this.x+a/3:o>0?0:this.maxScrollX}if(l>0||l<this.maxScrollY){l=this.options.bounce?this.y+s/3:l>0?0:this.maxScrollY}this.directionX=a>0?-1:a<0?1:0;this.directionY=s>0?-1:s<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(o,l);if(r-this.startTime>300){this.startTime=r;this.startX=this.x;this.startY=this.y}},_end:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.changedTouches?e.changedTouches[0]:e,a,s,r=n.getTime()-this.startTime,o=i.round(this.x),l=i.round(this.y),c=i.abs(o-this.startX),u=i.abs(l-this.startY),d=0,f="";this.isInTransition=0;this.initiated=0;this.endTime=n.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(o,l);if(!this.moved){if(this.options.tap){n.tap(e,this.options.tap)}if(this.options.click){n.click(e)}this._execEvent("scrollCancel");return}if(this._events.flick&&r<200&&c<100&&u<100){this._execEvent("flick");return}if(this.options.momentum&&r<300){a=this.hasHorizontalScroll?n.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0};s=this.hasVerticalScroll?n.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:l,duration:0};o=a.destination;l=s.destination;d=i.max(a.duration,s.duration);this.isInTransition=1}if(o!=this.x||l!=this.y){if(o>0||o<this.maxScrollX||l>0||l<this.maxScrollY){f=n.ease.quadratic}this.scrollTo(o,l,d,f);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout((function(){e.refresh()}),this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;e=e||0;if(!this.hasHorizontalScroll||this.x>0){t=0}else if(this.x<this.maxScrollX){t=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){i=0}else if(this.y<this.maxScrollY){i=this.maxScrollY}if(t==this.x&&i==this.y){return false}this.scrollTo(t,i,e,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=n.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(e,t){if(!this._events[e]){this._events[e]=[]}this._events[e].push(t)},off:function(e,t){if(!this._events[e]){return}var i=this._events[e].indexOf(t);if(i>-1){this._events[e].splice(i,1)}},_execEvent:function(e){if(!this._events[e]){return}var t=0,i=this._events[e].length;if(!i){return}for(;t<i;t++){this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,a){e=this.x+e;t=this.y+t;i=i||0;this.scrollTo(e,t,i,a)},scrollTo:function(e,t,i,a){a=a||n.ease.circular;this.isInTransition=this.options.useTransition&&i>0;if(!i||this.options.useTransition&&a.style){this._transitionTimingFunction(a.style);this._transitionTime(i);this._translate(e,t)}else{this._animate(e,t,i,a.fn)}},scrollToElement:function(e,t,a,s,r){e=e.nodeType?e:this.scroller.querySelector(e);if(!e){return}var o=n.offset(e);o.left-=this.wrapperOffset.left;o.top-=this.wrapperOffset.top;if(a===true){a=i.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)}if(s===true){s=i.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)}o.left-=a||0;o.top-=s||0;o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left;o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top;t=t===undefined||t===null||t==="auto"?i.max(i.abs(this.x-o.left),i.abs(this.y-o.top)):t;this.scrollTo(o.left,o.top,t,r)},_transitionTime:function(e){e=e||0;this.scrollerStyle[n.style.transitionDuration]=e+"ms";if(!e&&n.isBadAndroid){this.scrollerStyle[n.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(e){this.scrollerStyle[n.style.transitionTimingFunction]=e},_translate:function(e,t){if(this.options.useTransform){this.scrollerStyle[n.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ}else{e=i.round(e);t=i.round(t);this.scrollerStyle.left=e+"px";this.scrollerStyle.top=t+"px"}this.x=e;this.y=t},_initEvents:function(t){var i=t?n.removeEvent:n.addEvent,a=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this);i(e,"resize",this);if(this.options.click){i(this.wrapper,"click",this,true)}if(!this.options.disableMouse){i(this.wrapper,"mousedown",this);i(a,"mousemove",this);i(a,"mousecancel",this);i(a,"mouseup",this)}if(n.hasPointer&&!this.options.disablePointer){i(this.wrapper,n.prefixPointerEvent("pointerdown"),this);i(a,n.prefixPointerEvent("pointermove"),this);i(a,n.prefixPointerEvent("pointercancel"),this);i(a,n.prefixPointerEvent("pointerup"),this)}if(n.hasTouch&&!this.options.disableTouch){i(this.wrapper,"touchstart",this);i(a,"touchmove",this);i(a,"touchcancel",this);i(a,"touchend",this)}i(this.scroller,"transitionend",this);i(this.scroller,"webkitTransitionEnd",this);i(this.scroller,"oTransitionEnd",this);i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=e.getComputedStyle(this.scroller,null),i,a;if(this.options.useTransform){t=t[n.style.transform].split(")")[0].split(", ");i=+(t[12]||t[4]);a=+(t[13]||t[5])}else{i=+t.left.replace(/[^-\d.]/g,"");a=+t.top.replace(/[^-\d.]/g,"")}return{x:i,y:a}},_animate:function(e,t,i,s){var r=this,o=this.x,l=this.y,c=n.getTime(),u=c+i;function d(){var f=n.getTime(),h,p,m;if(f>=u){r.isAnimating=false;r._translate(e,t);if(!r.resetPosition(r.options.bounceTime)){r._execEvent("scrollEnd")}return}f=(f-c)/i;m=s(f);h=(e-o)*m+o;p=(t-l)*m+l;r._translate(h,p);if(r.isAnimating){a(d)}}this.isAnimating=true;d()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(!e._constructed){e.preventDefault();e.stopPropagation()}break}}};s.utils=n;if(typeof module!="undefined"&&module.exports){module.exports=s}else{e.IScroll=s}})(window,document,Math);var g_localTime=new Date;var g_blogimages={};function MessageBox(e,t){e.find(".wh-message-box").remove();var i=$("<div></div>");i.hide();i.addClass("wh-message-box");i.html('<div class="message">'+t+'</div><div class="close" title="Click on this box to close it"></div>');i.click((function(){$(this).fadeOut()}));e.append(i[0]);i.fadeIn()}function Rectangle(e,t,i,a){this.l=e;this.t=t;this.r=e+i;this.b=t+a}Rectangle.prototype={intersectWith:function(e){return!(this.l>=e.r||e.l>=this.r||this.t>=e.b||e.t>=this.b)},contains:function(e){return this.l<=e.l&&this.t<=e.t&&this.r>=e.r&&this.b>=e.b},containedIn:function(e){return e.contains(this)}};WH.aE(window,"load",(function(){if(!(window.JSON&&WH.LocalStorage.isSupported())){return}var e=WH.LocalStorage.get("lvBrowse");if(!e)return;e=window.JSON.parse(e);if(!e)return;var t=/^\/[-a-z]+=\d+/i;var i=t.exec(location.pathname);if(!i)return;i=i[0];var a=function(e,t){if(!t){return WH.ce("i",{className:"fa fa-"+e})}return WH.ce("a",{className:"fa fa-"+e,href:t})};for(var n=0;n<e.length;n++){var s=e[n].urls;for(var r=0;r<s.length;r++){if(s[r]==i){var o=r>0?s[r-1]:false;var l=r+1<s.length?s[r+1]:false;var c=e[n].path+e[n].hash;var u=WH.qs(".breadcrumb");if(!u){return}var d=WH.ce("div",{className:"breadcrumb-browse"});WH.ae(u,d);var f=a("arrow-circle-up",c);WH.Tooltip.simple(f,WH.TERMS.backtolist,"q2",{noWrap:true});WH.ae(d,a("arrow-circle-left",o));WH.ae(d,f);WH.ae(d,a("arrow-circle-right",l));return}}}}));WH.smoothScroll=function(e,t){switch(typeof e){case"string":case"object":case"jQuery":var i=$(e).offset();if(!i){return}e=i.top;break;case"number":break;default:return}if(WH.Layout.Responsive.isZulInMobileMode()){e-=50}else{e-=10}$("html, body").animate({scrollTop:e},t||500)};WH.getReputationPlusAchievementText=function(e,t,i,a){var n=WH.getAchievementText(e,t,i,true);var s=$("<span>").addClass("wsach-pts");s.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.reputationtip,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));s.addClass("q1");s.text(WH.numberFormat(a));var r=$("<span>");r.append(" (");r.append(s);r.append(" &ndash; ");r.append(n);r.append(") ");return r};WH.getAchievementText=function(e,t,i,a){var n=$("<span>").addClass("wsach-pts");n.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.userachcount_tip,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));var s=" ";if(!a){s+=" ("}if(e){s+="<i>"+e+"</i>"+"&middot;"}if(t){s+="<b>"+t+"</b>"+"&middot;"}if(!i){i=0}s+="<u>"+i+"</u>";if(!a){s+=")"}n.html(s);return n};WH.formatTimeElapsed=function(e){const t={abbreviated:[WH.TERMS.year_abbrev,WH.TERMS.month_abbrev,WH.TERMS.week_abbrev,WH.TERMS.day_abbrev,WH.TERMS.hour_abbrev,WH.TERMS.minute_abbrev,WH.TERMS.second_abbrev],singular:[WH.TERMS.year_lc,WH.TERMS.month_lc,WH.TERMS.week_lc,WH.TERMS.day_lc,WH.TERMS.hour_lc,WH.TERMS.minute_lc,WH.TERMS.second_lc],plural:[WH.TERMS.years_lc,WH.TERMS.months_lc,WH.TERMS.weeks_lc,WH.TERMS.days_lc,WH.TERMS.hours_lc,WH.TERMS.minutes_lc,WH.TERMS.seconds_lc]};function i(e,i,a){if(a){return e+" "+t.abbreviated[i]}else{return e+" "+(e==1?t.singular[i]:t.plural[i])}}var a=[31557600,2629800,604800,86400,3600,60,1];var n=[1,3,3,-1,5,-1,-1];e=Math.max(e,1);for(var s=3,r=a.length;s<r;++s){if(e>=a[s]){var o=s;var l=Math.floor(e/a[o]);if(n[o]!=-1){var c=n[o];e%=a[o];var u=Math.floor(e/a[c]);if(u>0){return i(l,o,1)+" "+i(u,c,1)}}return i(l,o,0)}}return"(n/a)"};WH.formatDate=function(e,t,i,a,n){var s=new Date;var r=new Date;r.setTime(s.getTime()-1e3*t);var o;var l=new Date(r.getYear(),r.getMonth(),r.getDate());var c=new Date(s.getYear(),s.getMonth(),s.getDate());var u=c.getTime()-l.getTime();u/=1e3;u/=86400;u=Math.round(u);if(t>=2592e3){o=WH.TERMS.on_lc+WH.formatDateSimple(i,a)}else if(u>1){o=WH.sprintf(WH.TERMS.daysago_format,u);if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else if(t>=43200){if(s.getDay()==r.getDay()){o=WH.TERMS.today_lc}else{o=WH.TERMS.yesterday_lc}o=WH.formatTimeSimple(r,o);if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else{o=WH.sprintf(WH.TERMS.ago2_format,WH.formatTimeElapsed(t));if(e){var d=new Date;d.setTime(i.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}if(n==1){o=o.substr(0,1).toUpperCase()+o.substr(1)}if(e){WH.ae(e,WH.ct(o))}else{return o}};WH.formatDateSimple=function(e,t){function i(e){return e<10?"0"+e:e}var a="",n=e.getDate(),s=e.getMonth()+1,r=e.getFullYear();if(r<=1970){a+=WH.TERMS.unknowndate_stc}else{a+=WH.sprintf(WH.TERMS.date3_format,i(n),i(s),r)}if(t!=null){a=WH.formatTimeSimple(e,a)}return a};WH.formatTimeSimple=function(e,t,i){function a(e){return e<10?"0"+e:e}var n=e.getHours(),s=e.getMinutes();if(t==null){t=""}t+=i?" ":WH.TERMS.at_lc;if(n==12){t+=WH.TERMS.noon_lc}else if(n==0){t+=WH.TERMS.midnight_lc}else if(n>12){t+=n-12+":"+a(s)+" "+WH.TERMS.pm}else{t+=n+":"+a(s)+" "+WH.TERMS.am}return t};WH.formatStartEndDates=function(e,t){if(!e&&!t){return""}var i=false;var a=false;if(e)i=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());if(t)a=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());var n="";if(!a){n=WH.TERMS.starts+" "+i.toLocaleDateString()}else if(!i){n=WH.TERMS.ends+" "+a.toLocaleDateString()}else{var s=function(){try{(new Date).toLocaleDateString("i")}catch(e){return e.name==="RangeError"}return false}();var r={month:"long",year:"numeric"};var o="",l="",c=0;if(s&&i.getDate()==1){o=i.toLocaleDateString(undefined,r);c++}else{o=i.toLocaleDateString()}if(s&&new Date(a.valueOf()+36*60*60*1e3).getMonth()!=a.getMonth()){l=a.toLocaleDateString(undefined,r);c++}else{l=a.toLocaleDateString()}if(o==l){n=o}else if(c==1){n=i.toLocaleDateString()+" - "+a.toLocaleDateString()}else{n=o+" - "+l}}return n};WH.createProgressBar=function(e){if(e==null)e={};if(typeof e.text=="undefined"){e.text=" "}if(e.color==null){e.color="rep0"}if(e.width==null||e.width>100){e.width=100}var t,i;if(e.hoverText){t=WH.ce("a");t.href="javascript:"}else{t=WH.ce("span")}t.className="progressbar";if(e.text||e.hoverText){i=WH.ce("div");i.className="progressbar-text";if(e.text){var a=WH.ce("del");WH.ae(a,WH.ct(e.text));WH.ae(i,a)}if(e.hoverText){var n=WH.ce("ins");WH.ae(n,WH.ct(e.hoverText));WH.ae(i,n)}WH.ae(t,i)}i=WH.ce("div");i.className="progressbar-"+e.color;i.style.width=e.width+"%";if(e.height){i.style.height=e.height}WH.ae(i,WH.ct(WH.Strings.nbsp));WH.ae(t,i);if(e.text){var i=WH.ce("div");i.className="progressbar-text progressbar-hidden";WH.ae(i,WH.ct(e.text));WH.ae(t,i)}return t};WH.createReputationBar=function(e,t){if(!t){t=0}var i=WH.getReputationProgress(t);var a=i.length>0?i[i.length-1][1]+999:0;if(!e)e=0;if(e<0){e=0}else if(e>a){e=a}var n=e,s=0,r,o=a;if(a!=0){while(s<i.length){if(e<i[s][1]){break}++s}--s;n-=i[s][1];o=s+1<i.length?i[s+1][1]-i[s][1]:999}if(t){r=g_friendship_reactions[WH.sprintf("$1-$2",t,s)]}else{r=g_reputation_standings[s]}var l={text:r,hoverText:n+" / "+o,color:"rep"+s,width:parseInt(n/o*100)};return WH.createProgressBar(l)};WH.getReputationProgress=function(e){if(window.g_friendships_thresholds&&Array.isArray(g_friendships_thresholds[e])){return g_friendships_thresholds[e]}return[[0,0],[0,36e3],[0,39e3],[0,42e3],[0,45e3],[0,51e3],[0,63e3],[0,84e3]]};WH.createAchievementBar=function(e,t,i,a){if(!e){e=0}var n={text:e+(a>0?"(+"+a+")":"")+(t>0?" / "+t:""),color:i?"rep7":"ach"+(t>0?0:1),width:t>0?parseInt(e/t*100):100};return WH.createProgressBar(n)};WH.addCompletionIcons=function(e,t,i,a){var n=0;let s;if(t===WH.Types.TRANSMOG_SET){s=typeof i==="object"?i:WH.getPageData("transmog-set-detail-completion")}for(var r in g_user.lists){if(!g_user.lists.hasOwnProperty(r)){continue}let o=g_user.lists[r];if(!o.character){continue}let l=0;if(t===WH.Types.TRANSMOG_SET){l=WH.Wow.TransmogSet.getCompletionAmount(s,o.id);if(l==null){continue}}else{let e=WH.User.Completion.getByType(t);if(!e.hasOwnProperty(o.id)){continue}l=e[o.id].includes(i)?1:0}if(a&&!l){continue}WH.ae(e,WH.createCompletionIcon(o,l));n++}if(t===WH.Types.QUEST&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var o,r=0;o=g_user.characterProfiles[r];r++){var l=WH.inArray(o.quests,i)!=-1;if(a&&!l){continue}WH.ae(e,WH.createCompletionIcon({classs:o["class"],character:o.name,realm:o.realm},l?1:0));n++}}return n};WH.createCompletionIcon=function(e,t,i){var a=WH.ce("a");if(e.url){a.href="/list="+e.id+"/"+e.url}a.className="progress-icon progress-"+(t?Math.max(1,Math.floor(t*8)):0);WH.Tooltip.simple(a,WH.getCompletionTooltip(e,t));if(i){a.rel=i}return a};WH.getCompletionTooltip=function(e,t){let i=WH.ce("div");WH.ae(i,WH.ce("span",{className:"q"},WH.ct((t>=1?WH.TERMS.complete:WH.TERMS.incomplete)+WH.TERMS.colon_punct)));WH.ae(i,WH.ce("br"));let a=WH.ce("span",{style:{whiteSpace:"nowrap"}});WH.ae(i,a);WH.ae(a,WH.ce("b",{className:"c"+e.classs},WH.ct(e.character)));let n=[WH.Strings.nbsp,e.realm];if(e.hasOwnProperty("region")){n.push(e.region)}WH.ae(a,WH.ce("span",{className:"q0"},WH.ct(n.join(" "))));if(t>0&&t<1){WH.ae(a,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",Math.round(t*100)+"%")))}return i.innerHTML};WH.getCompletionFlags=function(e,t){var i=0;var a=g_user.lists||[];let n=WH.User.Completion.getByType(e);for(var s=a.length-1;s>=0;s--){var r=a[s];if(!(r.id in n)||!r.character){continue}i=i<<1|(n[r.id].includes(t)?1:0)}if(e==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var s=g_user.characterProfiles.length-1;s>=0;s--){var o=g_user.characterProfiles[s];var l=WH.inArray(o.quests,t)!=-1;i=i<<1|(l?1:0)}}return i};WH.preventPageScroll=function(e){var t=e.originalEvent&&e.originalEvent.wheelDelta||e.originalEvent&&-e.originalEvent.detail||e.wheelDelta||-e.detail;this.scrollTop+=(t<0?1:-1)*100;e.preventDefault()};WH.pickerWheel=function(e){e.preventDefault();if(e.deltaY>0){this.scrollTop+=100}else{this.scrollTop-=100}};WH.setSelectedLink=function(e,t){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var i=WH.setSelectedLink.groups;if(i[t]){i[t].className=i[t].className.replace("selected","")}e.className+=" selected";i[t]=e};WH.addPagination=function(e,t){function i(e,i){var a;if(e==t.page){a=WH.ce("span");a.className="selected"}else{a=WH.ce("a");a.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}WH.ae(a,WH.ct(i!=null?i:e));return a}if(!t.pound){t.pound=""}if(!t.sep){t.sep="."}if(t.allOrNothing&&t.nPages<=1){return}var a=t.align&&t.align=="left";var n=WH.ce("div"),s,r=WH.ce("var");n.className="pages";if(a){n.className+=" pages-left"}if(t.nPages>1){s=WH.ce("div");s.className="pages-numbers";var o=Math.max(2,t.page-2);var l=Math.min(t.nPages-1,t.page+2);var c=[];if(t.page!=t.nPages){c.push(i(t.page+1,String.fromCharCode(187)))}c.push(i(t.nPages));if(l<t.nPages-1){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}for(var d=l;d>=o;--d){c.push(i(d))}if(o>2){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}c.push(i(1));if(t.page!=1){c.push(i(t.page-1,String.fromCharCode(171)))}if(a){c.reverse()}for(var d=0,f=c.length;d<f;++d){WH.ae(s,c[d])}s.firstChild.style.marginRight="0";s.lastChild.style.marginLeft="0"}var r=WH.ce("var");WH.ae(r,WH.ct(WH.Strings.sprintf(WH.TERMS[t.wording[t.nItems==1?0:1]],t.nItems)));if(t.nPages>1){var u=WH.ce("span");WH.ae(u,WH.ct(String.fromCharCode(8211)));WH.ae(r,u);var h=WH.ce("a");h.className="go-to-page fa fa-files-o";h.href="javascript:";h.onclick=function(){var e=prompt(WH.sprintf(WH.TERMS.gotopage_format,1,t.nPages),t.page);if(e!=null){e|=0;if(e!=t.page&&e>=1&&e<=t.nPages){document.location.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}}};h.onmouseover=function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.gotopage_tip,"q2")};h.onmousemove=WH.Tooltip.cursorUpdate;h.onmouseout=WH.Tooltip.hide;WH.ae(r,h)}if(a){WH.ae(n,r);if(s){WH.ae(n,s)}}else{if(s){WH.ae(n,s)}WH.ae(n,r)}WH.ae(e,n)};WH.disclose=function(e,t){let i=WH.toggleDisplay(e,true);t.classList.remove("disclosure-"+(i?"off":"on"));t.classList.add("disclosure-"+(i?"on":"off"));return false};WH.toggle=function(e){let t=WH.toggleDisplay(e,true);this.classList.remove("toggler-"+(t?"off":"on"));this.classList.add("toggler-"+(t?"on":"off"));return false};WH.setupChangeWarning=function(e,t,i){if(!e){return}function a(){return i}e.submit((function(){window.onbeforeunload=null}));var n=[];for(var s in t){var r=t[s];if(!r){continue}n[s]=r.val();r.keydown((function(){for(var e in t){var i=t[e];if(!i){continue}if(i.val()!=n[e]){window.onbeforeunload=a;return}window.onbeforeunload=null}}))}};$(document).ready((function(){WH.qsa("dfn[title]").forEach((function(e){let t=e.title;e.removeAttribute("title");e.classList.add("tip");WH.Tooltip.simple(e,t,"q",{byCursor:true,maxWidth:250})}));$(".text").bind("copy",(function(){$("*[unselectable]",this).each((function(e,t){var i=$(t).text();$(t).text("");setTimeout((function(){$(t).text(i)}),1)}))}))}));$(document).ready((function(){$("input").each((function(){var e=$(this).attr("maxlength");var t=$(this).attr("data-charwarning");var i=t?$("#"+t):null;if(!e||!i){return}var a=function(){i.hide()};var n=function(t){var a=e-t;var n=t/e;var s=parseInt(n>=.5?255:n*2*255).toString(16);var r=parseInt(n<.5?255:255-(n-.5)*2*255).toString(16);if(s.length==1){s="0"+s}if(r.length==1){r="0"+r}i.text(WH.sprintf(WH.TERMS.charactersremaining_format,a));i.show();i.css("color","#"+s+r+"00")};$(this).focus((function(){n($(this).val().length)})).blur((function(){a()})).keyup((function(){n($(this).val().length)}))}))}));WH.getN5=function(e){var t=Math.abs(e);if(t<1e4){return WH.numberFormat(e)}if(t<1e5){return Math.round(e/100)/10+"k"}if(t<1e6){return Math.round(e/1e3)+"k"}if(t<1e7){return Math.round(e/1e3/10)/100+"m"}if(t<1e8){return Math.round(e/1e3/100)/10+"m"}if(t<1e9){return Math.round(e/1e3/1e3)+"m"}if(t<1e10){return Math.round(e/1e3/1e3/10)/100+"b"}if(t<1e10){return Math.round(e/1e3/1e3/100)/10+"b"}return Math.round(e/1e3/1e3/1e3)+"b"};WH.debug=function(e){if(!WH.isDev()&&!WH.User.hasRole(U_GROUP_ADMIN)){WH.debug=function(){};return}WH.debug=function(){var e=["DEBUG:"];var t=null;try{var i=(new Error).stack.split("\n");if(typeof i[2]==="string"){var a=i[2].replace(/^ *at /,"");t=a.match(/(.*) \(([^()]+)\)$/);if(t){if(WH.suppressExternalDebug()&&t[2].indexOf(WH.staticUrl)===-1){return}e.push(t[1])}else{e.push(a)}}}catch(e){}e=e.concat(Array.prototype.slice.call(arguments));if(t){e.push(t[2])}console.debug.apply(console.debug,e)};WH.debug.apply(WH,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(e,t){var i=0;e=e+"";var a=1;while(e.length>0){var n=e.charAt(e.length-1);var s=t.indexOf(n);if(s===-1){return null}i+=s*a;a*=t.length;e=e.substr(0,e.length-1)}return i};WH.encodeNumber=function(e,t){var i=t.length;var a=[e];while(a[0]>i){var n=Math.floor(a[0]/i);a[0]=a[0]-n*i;a.unshift(n)}var s="";for(var r=0,o=a.length;r<o;r++){s+=t.charAt(a[r])}return s};WH.getThrownErrorMessage=function(e){if(typeof e==="string"){return e}return e&&[e.name,e.message].filter(Boolean).join(": ")||"Unknown error"};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getElementViewportOffset=function(e){if(!(e instanceof jQuery)){e=$(e)}var t=e.offset().top;var i=t+e.outerHeight();var a=$(window);var n=a.scrollTop();var s=n+a.height();if(i>s){return i-s}if(t<n){return t-n}return 0};WH.onMutate=function(e,t,i){i=i||{};if(typeof MutationObserver==="undefined"){if(i.fallbackTimer!==false){let a=i.triggerOnce?setTimeout:setInterval;a(t.bind(e),i.fallbackTimer||150)}return}var a={observer:null};var n=i.triggerOnce?function(){a.observer.disconnect();t.apply(e)}:t.bind(e);var s={characterData:true,childList:true,subtree:true};var r=["attributes","characterData","childList","subtree"];for(var o=0,l=r.length;o<l;o++){if(i.hasOwnProperty(r[o])){s[r[o]]=i[r[o]]}}var c=new MutationObserver(n);a.observer=c;c.observe(e,s)};WH.getMajorHeading=function(e,t,i,a){if(isNaN(t)||t<1||t>6){t=2}if(isNaN(i)||i<1||i>6){i=t}var n=["heading-size-"+i];return WH.constructHeading("h"+t,e,n,a)};WH.getImitationHeading=function(e,t,i){if(isNaN(t)||t<1||t>6){t=2}var a=["imitation-heading","heading-size-"+t];return WH.constructHeading("div",e,a,i)};WH.constructHeading=function(e,t,i,a){if(typeof a!="object"){a={}}if(typeof a.classes=="string"){i.push(a.classes)}var n=WH.ce(e);n.className=i.join(" ");if(typeof a.styles=="string"){n.style=a.styles}if(typeof a.id=="string"){n.id=a.id}if(typeof t=="string"){n.innerHTML=t}else if(t.nodeType===Node.ELEMENT_NODE||t.nodeType===Node.TEXT_NODE){n.appendChild(t)}else{$(n).append(t)}return n};WH.clickToCopy=function(e,t,i){i=i||{};WH.aE(e,"click",WH.clickToCopy.copy.bind(null,e,t,i));WH.preventSelectStart(e);e.classList.add("click-to-copy");if(i.modifyTooltip){e._fixTooltip=function(e){return e+"<br>"+WH.ce("span",{className:"q2",innerHTML:WH.clickToCopy.getTooltip(false,i)}).outerHTML};i.overrideOtherTooltips=false}WH.Tooltip.simple(e,WH.clickToCopy.getTooltip.bind(null,false,i),undefined,{byCursor:!i.attachToElement,stopPropagation:i.overrideOtherTooltips})};WH.clickToCopy.copy=function(e,t,i,a){a.preventDefault();a.stopPropagation();if(t===undefined){if(!e.childNodes[0]||!e.childNodes[0].textContent){let t="Could not find text to copy.";WH.error(t,e);if(i.attachToElement){WH.Tooltip.show(e,t,"q10")}else{WH.Tooltip.showAtCursor(a,t,"q10")}return}t=e.childNodes[0].textContent}else if(typeof t==="function"){t=t()}WH.copyToClipboard(t);if(i.attachToElement){WH.Tooltip.show(e,WH.clickToCopy.getTooltip(true,i))}else{WH.Tooltip.showAtCursor(a,WH.clickToCopy.getTooltip(true,i))}};WH.clickToCopy.getTooltip=function(e,t){let i="";let a=undefined;if(e){i=" "+WH.TERMS.copied;a={className:"q1 fa fa-check"}}else{i=WH.TERMS.clickToCopy}let n=WH.ce("div",a,WH.ct(i));if(t.prefix){n.style.marginTop="10px";let e=typeof t.prefix==="function"?t.prefix():t.prefix;return e+n.outerHTML}return n.outerHTML};WH.copyToClipboard=function(e,t){if(!WH.copyToClipboard.hiddenInput){WH.copyToClipboard.hiddenInput=WH.ce("textarea",{className:"hidden-element"});WH.ae(document.body,WH.copyToClipboard.hiddenInput)}WH.copyToClipboard.hiddenInput.value=e;let i=WH.copyToClipboard.hiddenInput.value==="";if(i){WH.copyToClipboard.hiddenInput.value=WH.TERMS.nothingToCopy_tip}WH.copyToClipboard.hiddenInput.focus();WH.copyToClipboard.hiddenInput.select();if(!document.execCommand("copy")){prompt(null,e)}WH.copyToClipboard.hiddenInput.blur();if(t){if(i){WH.Tooltip.showFadingTooltipAtCursor(WH.TERMS.nothingToCopy_tip,t,"q10")}else{let e=WH.ce("span",{className:"q1 fa fa-check"},WH.ct(" "+WH.TERMS.copied));WH.Tooltip.showFadingTooltipAtCursor(e.outerHTML,t)}}};WH.createRange=function(e,t){var i={};for(var a=e;a<=t;++a){i[a]=a}return i};WH.objectToArray=function(e,t){var i=[];for(var a in e){if(e.hasOwnProperty(a)){i.push({property:a,value:e[a]})}}if(t){i.sort((function(e,i){return WH.stringCompare(e[t],i[t])}))}return i};WH.sortIdArray=function(e,t,i){e.sort(i?function(e,a){return WH.stringCompare(t[e][i],t[a][i])}:function(e,i){return WH.stringCompare(t[e],t[i])})};WH.sortJsonArray=function(e,t,i,a){var n=[];for(var s in e){if(e.hasOwnProperty(s)&&t[s]&&(a==null||a(t[s]))){n.push(s)}}if(i!=null){n.sort(i)}else{WH.sortIdArray(n,t)}return n};WH.sortObjectArray=function(e,t){for(var i=0,a;a=t[i];i++){var n=1;if(a.substr(0,1)==="-"){n=-1;a=a.substr(1)}e.sort(function(e,t,i,a){if(i[e]===a[e]){return 1*t}if(typeof i[e]==="string"||typeof a[e]==="string"){return WH.stringCompare(""+i[e],""+a[e])*t}return(i[e]>a[e]?1:-1)*t}.bind(null,a,n))}};WH.isEqualSimpleObject=function(e,t){for(var i in e){if(typeof e[i]=="object"){if(typeof t[i]!="object")return false;if(!WH.isEqualSimpleObject(e[i],t[i]))return false}else{if(e[i]!==t[i])return false}}for(var a in t){if(typeof t[a]=="object"){if(typeof e[a]!="object")return false;if(!WH.isEqualSimpleObject(e[a],t[a]))return false}else{if(e[a]!==t[a])return false}}return true};WH.deUrlize=function(e){var t=e.split("-");var i="";for(var a=0;a<t.length;a++){if(i){i+=" "}i+=WH.ucfirst(t[a])}return i};WH.ensureUrlProtocol=function(e,t){if(typeof e!=="string"){WH.error("Supplied URL was not a string.",e);e=""}if(t){if(!t.match(/:$/)){t+=":"}return e.replace(/^https?:/,t).replace(/^(\/[^\/])/,t+"//"+location.host+"$1").replace(/^(\/\/)/,t+"$1")}else{return e.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(e){return e.indexOf("/")===-1?WH.Icon.getIconUrl(e,WH.Icon.TINY):e};WH.removeAccents=function(e){var t=e;var i=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var a=0;a<i[0].length;a++){t=t.replace(new RegExp(i[0][a],"g"),i[1][a])}return t};WH.isDateValid=function(e){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(e)};WH.isIpAddress=function(e){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(e)};WH.isEmailValid=function(e){if(e.length>64){return false}return e.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var e=location.hostname;if(!WH.isIpAddress(e)){var t=e.split(".");if(t.length>2){t.splice(0,t.length-2)}e=t.join(".")}WH.getCurrentDomain.CACHE=e;return e};WH.isExternalUrl=function(e){return!(!e||e.indexOf("http")!=0&&e.indexOf("//")!=0||e.indexOf("wowhead.com")!=-1||e.indexOf("wowheadnews.")!=-1||e.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var e=true;if(WH.isDev()){e=location.protocol==="https:"}var t=e?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(t in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[t]}var i="";if(e!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var a=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);a=a?a[1]:"www";var n="";if(location.port){n=location.port}if(n.substr(0,1)!==":"){n=":"+n}if(n===":80"||n===":"){n=""}i="https://"+a+".wowhead.com"+n}if(!e){i=i.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[t]=i;return i};WH.fixWowheadHttps=function(e){return e.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.goToLoginPage=function(e){window.location=WH.Url.getLoginPath(e)};WH.createOrRegex=function(e,t){e=e.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var i=e.split(" "),a="";for(var n=0,s=i.length;n<s;++n){if(n>0){a+="|"}a+=i[n]}return new RegExp((t!=null?"("+t+")?":"")+"("+a+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(e,t,i,a){if(!i){i=$.noop}var n="";if(e.match(/(#.+)$/)){n=RegExp.$1;e=e.replace(n,"")}if(typeof i.custom=="function"){e=i.custom(e,a)}if(i.returnAfterCustom){return e+n}$.each(t,(function(t,a){var n;var s;var r;var o=e.match(new RegExp("(&|\\?)?"+t+"=?([^&]+)?"));if(o!=null){n=o[0];s=o[1];r=decodeURIComponent(o[2])}if(a==null){if(!n)return;r=null}else if(a.substr(0,2)=="+="){if(r&&i.onAppendCollision){r=i.onAppendCollision(r,a.substr(2),i.menuUrl)}else if(!r&&i.onAppendEmpty){r=i.onAppendEmpty(a.substr(2),i.menuUrl)}else{if(!r)r="";r+=$.trim(a.substr(2))}}else{r=a}if(n){var l="";if(s){l+=s}if(r!=null){l+=t;if(r){l+="="+WH.urlEncodeHref(r)}}e=e.replace(n,l)}else if(r||a==null||a.substr(0,2)!="+="){e+=(/[&?]/.test(e)?"&":"?")+t;if(r){e+="="+WH.urlEncodeHref(r)}}}));e=e.replace("?&","?");e=e.replace(/&&/g,"&");e=e.replace(/\/\?/g,"/");e=e.replace(/(&|\?)+$/,"");return e+n};WH.pageWasReloaded=function(){if(window.performance){if(performance.getEntriesByType){var e=performance.getEntriesByType("navigation");for(var t=0;t<e.length;t++){if(e[t].type==="reload"){return true}}}else if(performance.navigation){return performance.navigation.type===1}}return false};WH.getPreferredTransmogRace=function(){var e=WH.LocalStorage.get("transmog_racegender");if(!e&&g_user&&g_user.settings&&g_user.settings.defaultModel){e=[g_user.settings.defaultModel.race,g_user.settings.defaultModel.gender].join(",")}if(!e||(""+e).indexOf(",")<0){e="1,2"}e=e.split(",");if(e[0]==25||e[0]==26){e[0]=24}if(!parseInt(e[0],10)){e[0]=1}if(!parseInt(e[1],10)){e[1]=2}if(!WH.Wow.Race.isPlayableRace(e[0])){e[0]=WH.Wow.Race.ID_HUMAN}return{race:parseInt(e[0]),gender:parseInt(e[1])}};WH.isBlizzardReferral=function(){var e=false;if(typeof WH.getGets().brl!=="undefined"){e="brl"}else{e=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=function(e){return e}.bind(null,e);return e};WH.prepInfobox=function(){$(".infobox").each((function(){var e=$(this);if(e.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&WH.Types.existsInDataEnv(g_pageInfo.type)&&typeof g_pageInfo.typeId=="number"){var t=$(".compact-completion-display",e);if(t.length){var i=$("span",t);if(i.length){var a=0;i.each((function(){var e=$(this);var t=e.html();try{t=JSON.parse(t)}catch(e){return}var i;for(var n=0,s;s=g_user.lists[n];n++){if(s.id==t.id){i=s;break}}if(i){e.parent().append(WH.createCompletionIcon(i,t.completed?1:0,t.rel));e.remove();a++}}));if(a){t.parent().parent().show()}}else{if(t.is(":empty")&&WH.addCompletionIcons(t.get(0),g_pageInfo.type,g_pageInfo.typeId)){t.parent().parent().show()}}}e.data("infobox-completion-info-added",true)}}))};WH.enhanceTextarea=function(e,t){if(!(e instanceof jQuery)){e=$(e)}if(e.data("wh-enhanced")||e.prop("tagName")!="TEXTAREA"){return}if(typeof t!="object"){t={}}var i=function(e){if(!e.dynamicResizeOption){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="true"){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="false"){return false}return!e.hasOwnProperty("dynamicSizing")||e.dynamicSizing}.bind(null,t);var a=e.height()||500;var n=$("<div/>",{class:"enhanced-textarea-wrapper"}).insertBefore(e).append(e);if(!t.hasOwnProperty("dynamicSizing")||t.dynamicSizing||t.dynamicResizeOption){var s=$("<div/>",{class:"enhanced-textarea-expander"}).prependTo(n);s.css("width",s.parent().width()+"px");var r=function(e,t,i,a){if(!a()){return}var n=e.val()||e.attr("placeholder")||"";if(n){n=WH.htmlEntities(n)}t.html(n.replace(/\n/g,"<br>")+"<br>");var s=t.height()+(i?14:34);e.css("height",s+"px")};e.bind("keydown keyup change",r.bind(this,e,s,t.exactLineHeights,i));r(e,s,t.exactLineHeights,i);setTimeout(r.bind(this,e,s,t.exactLineHeights,i),100);if(!t.dynamicResizeOption||t.dynamicResizeOption&&i()){n.addClass("enhanced-textarea-dynamic-sizing")}}if(t.markup){var o=$("<div/>",{class:"enhanced-textarea-markup-wrapper"}).prependTo(n);var l=$("<div/>",{class:"enhanced-textarea-markup"}).appendTo(o);var c=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);var u=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);if(t.markup==="inline"){WH.markup.Toolbar.addInline(e.get(0),c.get(0),u.get(0))}else{WH.markup.Toolbar.addStandard(e.get(0),c.get(0),u.get(0))}if(t.dynamicResizeOption){var d=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(l);var f=$("<label/>").appendTo(d);var h=$("<input/>",{type:"checkbox",checked:i()}).appendTo(f);h.change(function(e,t,i,a,n,s){var r=this.is(":checked");WH.LocalStorage.set("dynamic-textarea-resizing",JSON.stringify(r));if(r){t.addClass("enhanced-textarea-dynamic-sizing");s(i,e.exactLineHeights,a)}else{t.removeClass("enhanced-textarea-dynamic-sizing");i.css("height",n+"px")}}.bind(h,t,n,e,i,a,r));$("<span/>",{text:WH.TERMS.autoresizetextbox}).appendTo(f)}if(t.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var p="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var m="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var H=function(e){var t=e.css("backgroundColor");if(t=="rgba(0, 0, 0, 0)"||t=="transparent"){return H(e.parent())}else{return t}};var g=H(l);for(var W,v=0;(W=window.document.styleSheets[v])&&W.href;v++){}if(!W){window.document.head.appendChild(document.createElement("style"));W=window.document.styleSheets[v]}var T="."+m+" ."+p+" .enhanced-textarea-markup";W.insertRule(T+" {background:"+g+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",W.cssRules.length);W.insertRule("body.has-mobile-zul-bar"+T+" {padding-top:50px}",W.cssRules.length);o.addClass(p);var _=function(e,t,i){var a=WH.Layout.Responsive.isZulInMobileMode()?40:0;var n=this.scrollY||this.pageYOffset||0;if(n>e.offset().top-10-a&&n<t.offset().top+t.height()-100-a){$("body").addClass(i)}else{$("body").removeClass(i)}};var E=$(window);E.scroll(_.bind(window,o,n,m));_.call(window,o,n,m);var b=function(e,t){t.css("width",e.width()+"px");e.css("height",t.height()+"px")}.bind(null,o,l);b();E.on("resize",b);$((function(){setTimeout(b,2e3)}))}}e.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(e,t,i){var a=0;var n=1;var s=2;var r=3;var o=WH.createOptionsMenuWidget.chevron;if(i.noChevron){o=""}var l=WH.ce("span");l.id="options-menu-widget-"+e;l.className="options-menu-widget "+l.id;l.innerHTML=t+o;if(i.id){l.id=i.id}if(i.className){l.className+=" "+i.className}if(i.options instanceof Array){var c=[];for(var u=0,d;d=i.options[u];u++){var f=[u,d[n]];if((typeof i.selected=="number"||typeof i.selected=="string")&&i.selected==d[a]){l.innerHTML=d[n]+o;if(d[r]){switch(typeof d[r].className){case"string":$.data(l,"options-menu-widget-class",d[r].className);l.className+=" "+d[r].className;break;case"function":$.data(l,"options-menu-widget-class",d[r].className(d,true));l.className+=" "+d[r].className(d,true);break}}}if(d[s]){f.push(function(e,t,i,a){switch(typeof i[s]){case"string":window.location=i[s];break;case"function":if(typeof a.updateWidgetText=="undefined"||a.updateWidgetText){t.innerHTML=i[n]+e;var o=$.data(t,"options-menu-widget-class");if(o){t.className=t.className.replace(new RegExp(" *\\b"+o+"\\b"),"")}if(i[r]){switch(typeof i[r].className){case"string":$.data(t,"options-menu-widget-class",i[r].className);t.className+=" "+i[r].className;break;case"function":$.data(t,"options-menu-widget-class",i[r].className(i,true));t.className+=" "+i[r].className(i,true);break}}}i[s](t,i);break}}.bind(null,o,l,d,i))}else if(!d[r]||!d[r].menu){f[0]=null}f[Menu.ITEM_OPTIONS]={};if(d[r]){switch(typeof d[r].className){case"string":f[Menu.ITEM_OPTIONS].className=d[r].className;break;case"function":f[Menu.ITEM_OPTIONS].className=d[r].className.bind(null,d,false);break}switch(typeof d[r].column){case"number":case"string":f[Menu.ITEM_OPTIONS].column=d[r].column;break;case"function":f[Menu.ITEM_OPTIONS].column=d[r].column.bind(null,d);break}switch(typeof d[r].tinyIcon){case"string":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon;break;case"function":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon.bind(null,d);break}switch(typeof d[r].fontIcon){case"string":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon;break;case"function":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon.bind(null,d);break}if(typeof d[r].isChecked=="function"){f[Menu.ITEM_OPTIONS].checkedFunc=d[r].isChecked.bind(null,d)}if(typeof d[r].menu=="object"&&d[r].menu instanceof Array){Menu.setSubmenu(f,d[r].menu)}}c.push(f)}l.menu=c;if(i.menuOnClick){l.onmousedown=WH.rf;Menu.add(l,c,{showAtElement:true})}else{Menu.add(l,c)}}if(i.target){$(i.target).append(l)}else{return l}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(e){var t=$(".smooth-nav-inner > a",e);if(!t.length){setTimeout(WH.setupSmoothNavClicks.bind(null,e),9);return}let i=WH.Device.isTouch();t.each((function(){var e=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(e&&e.substr(0,1)==="#"){$(this).click(function(e,t){if(t.which===2){return}var a=e==="#top"?0:$(e).offset().top-20;if(isNaN(a)){return}if(i){a-=37}$("html, body").stop().animate({scrollTop:a},"500","swing");return false}.bind(null,e))}}))};WH.countdownClock=function(e){var t=$(e.element||"#countdown-clock-"+e.id);if(!t.length){return}var i;if(e.url){i=$("<a/>",{href:e.url,target:"_blank"})}else{i=$("<div/>")}i.addClass("countdown-clock-content").css({"background-image":"url("+e.bg+")"});var a=$("<div/>",{class:"countdown-clock-content-inner"}).appendTo(i);if(e.impressionImage){$("<img>",{src:e.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(i)}if(e.text){a.append($("<span/>",{class:"countdown-clock-text",html:e.text}))}var n=$("<span/>",{class:"countdown-clock-time"}).appendTo(a);var s=$("<table/>").appendTo(n);var r=$("<tr/>").appendTo(s);var o=$("<tr/>").appendTo(s);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:WH.TERMS.days_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.hours_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.minutes_lc}).appendTo(o);t.addClass("countdown-clock").append(i);var l={days:0,hours:0,minutes:0};var c=(new Date).getTime();var u=c;if(typeof e.time==="string"){u=new Date(e.time).getTime()}else if(typeof e.time==="object"){var d=new Date;if(!e.time.hasOwnProperty("year")){e.time.year=d.getFullYear()}if(!e.time.hasOwnProperty("month")){e.time.month=d.getMonth+1}if(!e.time.hasOwnProperty("day")){e.time.day=d.getDay()}if(!e.time.hasOwnProperty("hour")){e.time.hour=0}if(!e.time.hasOwnProperty("minute")){e.time.minute=0}if(!e.time.hasOwnProperty("second")){e.time.second=0}u=new Date(e.time.year,e.time.month-1,e.time.day,e.time.hour,e.time.minute,e.time.second).getTime()}var f=parseInt((u-c)/1e3);var h=60;var p=h*60;var m=p*24;l.days=parseInt(f/m);f=f-l.days*24*60*60;l.hours=parseInt(f/p);f=f-l.hours*60*60;l.minutes=parseInt(f/h);var H=function(e,t,i){if(t.days<=0&&t.hours<=0&&t.minutes<=0){e.html(i.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",e).html(t.days);$("tr:last-child > td:nth-child(1)",e).html(t.days===1?WH.TERMS.day_lc:WH.TERMS.days_lc);$("tr:first-child > td:nth-child(3)",e).html(t.hours);$("tr:last-child > td:nth-child(3)",e).html(t.hours===1?WH.TERMS.hour_lc:WH.TERMS.hours_lc);$("tr:first-child > td:nth-child(5)",e).html(t.minutes);$("tr:last-child > td:nth-child(5)",e).html(WH.TERMS.minute_abbrev);t.minutes--;if(t.minutes<0){if(t.hours>0||t.days>0){t.minutes=59}else{t.minutes=0}t.hours--}if(t.hours<0){if(t.days>0){t.hours=23}else{t.hours=0}t.days--}if(t.days<0){t.days=0}setTimeout(H.bind(null,e,t,i),6e4)};H(n,l,e)};WH.createTweetDiv=function(e){var t=new Date;if(!e.id||!e.text){return document.createTextNode("")}var i=WH.ce("div");const a=["BlizzardCS","BlizzardEnt","Warcraft","WarcraftDevs","Diablo"];if(e.author&&a.includes(e.author.username)){i.dataset.blizzardAuthor="true"}i.className="full-tweet";if(e.repliedTo){var n=WH.createTweetDiv(e.repliedTo);n.className+=" replied";WH.ae(i,n)}if(e.quoted){var n=WH.createTweetDiv(e.quoted);n.className+=" replied quoted";WH.ae(i,n)}var s=WH.ce("div");WH.ae(i,s);s.className="tweet";var r=WH.ce("a");WH.ae(s,r);r.className="avatar";r.style.backgroundImage="url("+e.author.avatar.replace(/^http:/,"")+")";r.href="https://twitter.com/"+e.author.username;var o=WH.ce("div");WH.ae(s,o);o.className="main";var l=WH.ce("div");WH.ae(o,l);l.className="top";var r=WH.ce("a");WH.ae(l,r);r.href="https://twitter.com/"+e.author.username;var c=WH.ce("span");WH.ae(r,c);c.className="author-name";WH.st(c,e.author.name);var c=WH.ce("span");WH.ae(r,c);c.className="author-username";WH.st(c,"@"+e.author.username);let u="https://twitter.com/"+e.author.username+"/status/"+e.id;var r=WH.ce("a");WH.ae(l,r);r.className="timestamp";r.href=u;var d=(t.getTime()-Date.parse(e.timestamp))/1e3;if(d<60){WH.st(r,""+d+"s")}else if(d<60*60){WH.st(r,""+Math.floor(d/60)+"m")}else if(d<60*60*24){WH.st(r,""+Math.floor(d/60/60)+"h")}else if(d<60*60*24*3){WH.st(r,""+Math.floor(d/60/60/24)+"d")}else{d=new Date(e.timestamp).toString().split(" ");WH.st(r,""+d[1]+" "+d[2])}var l=WH.ce("div");WH.ae(o,l);l.className="status";var f=e.text;var h,p,m,H,g;if(e.hasOwnProperty("entities")&&e.entities!==null){if(Array.isArray(e.entities.media)){let t=e.extended_entities&&e.extended_entities.media||e.entities.media;for(let i,a=0;i=t[a];a++){f=f.replace(e.text.substr(i.indices[0],i.indices[1]-i.indices[0]),"");let t=function(e,t){let i=e.extended_entities&&e.extended_entities.media&&e.extended_entities.media[t];if(!i||i.type!=="video"&&i.type!=="animated_gif"){return false}if(i.additional_media_info&&i.additional_media_info.embeddable===false){return false}if(!i.video_info||!i.video_info.aspect_ratio){return false}let a=i.type==="animated_gif";let n;let s=i.video_info.variants;s.sort((function(e,t){return(t.bitrate||0)-(e.bitrate||0)}));for(let e=0;e<s.length;e++){if(s[e].bitrate){n=s[e];break}}if(!n){if(a&&s[0]){n=s[0]}else{return false}}let r=WH.ce("video");let l=i.video_info.aspect_ratio;r.width=Math.min(window.innerWidth-102,375);r.height=Math.ceil(r.width/l[0]*l[1]);r.controls=true;r.poster=i.media_url_https||i.media_url.replace(/^http:/,"");r.src=n.url;if(a){r.loop=true}WH.ae(o,r);return true}(e,a);if(!t&&i.type==="photo"){var W="",v=0;for(var T in i.sizes){if(i.sizes[T].w>=250&&(v==0||i.sizes[T].w<v)){W=T;v=i.sizes[T].w}}if(W!=""){if(v>375){v=375}let e=WH.ce("a",{href:u+"/photo/"+(a+1)});WH.ae(o,e);var _=WH.ce("img");WH.ae(e,_);_.className="photo";_.width=v;_.height=Math.floor(i.sizes[W].h*(v/i.sizes[W].w));_.src=i.media_url_https||i.media_url.replace(/^http:/,"")+":"+W}}}}if(Array.isArray(e.entities.urls)){h=[];g=e.quoted?WH.sprintf("https://twitter.com/$1/status/$2",e.quoted.author.username,e.quoted.id):false;for(H in e.entities.urls){m=e.entities.urls[H];p=e.text.substr(m.indices[0],m.indices[1]-m.indices[0]);if(WH.inArray(h,p)>=0){continue}h.push(p);if(g&&m.expanded_url.indexOf(g)==0){f=f.replace(p,"")}else{f=f.replace(p,'<a href="'+m.url+'" class="entity-url">'+m.display_url+"</a>","g")}}}if(Array.isArray(e.entities.user_mentions)){h=[];for(H in e.entities.user_mentions){m=e.entities.user_mentions[H];p=e.text.substr(m.indices[0],m.indices[1]-m.indices[0]).toLowerCase();if(WH.inArray(h,p)>=0){continue}h.push(p);f=f.replace(p,'<a href="https://twitter.com/'+m.screen_name+'" class="entity-mention">@'+m.screen_name+"</a>","gi")}}if(Array.isArray(e.entities.hashtags)){h=[];for(H in e.entities.hashtags){m=e.entities.hashtags[H];p=e.text.substr(m.indices[0],m.indices[1]-m.indices[0]).toLowerCase();if(WH.inArray(h,p)>=0){continue}h.push(p);f=f.replace(p,'<a href="https://twitter.com/search?q=#'+m.text+'" class="entity-hashtag">#'+m.text+"</a>","gi")}}}l.innerHTML=f;var E=WH.ce("div");WH.ae(o,E);E.className="bottom";var r=WH.ce("a");WH.ae(E,r);r.className="widget reply";r.href="https://twitter.com/intent/tweet?in_reply_to="+e.id;r.target="whtwitter";WH.st(r,"Reply");r.insertBefore(WH.ce("span"),r.firstChild);var r=WH.ce("a");WH.ae(E,r);r.className="widget retweet";r.href="https://twitter.com/intent/retweet?tweet_id="+e.id;r.target="whtwitter";WH.st(r,"Retweet");r.insertBefore(WH.ce("span"),r.firstChild);var r=WH.ce("a");WH.ae(E,r);r.className="widget favorite";r.href="https://twitter.com/intent/favorite?tweet_id="+e.id;r.target="whtwitter";WH.st(r,"Favorite");r.insertBefore(WH.ce("span"),r.firstChild);return i};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(e){var t=""+location.href;var i=t.indexOf(e);if(i==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var a=t.substr(0,i+e.length);return t.substr(a.length+1)};WH.setSlashHash=function(e,t,i){var a=""+location.href;var n=a.indexOf(e);if(n==-1){alert("Bad hash update: No root found!");return}var s=a.substr(0,n+e.length);var r=a.substr(s.length+1);if(t.substr(0,1)=="#"){t=t.substr(1)}var o=t?"/"+t:"";if(i){history.pushState({},"",s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}else{history.replaceState({},"",s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}return r};WH.setHash=function(e,t){let i=""+location.hash;if(!e.startsWith("#")){e="#"+e}if(e==="#."){WH.clearHash(t||false)}else{if(t){history.pushState({},"",location.pathname+e)}else{history.replaceState({},"",location.pathname+e)}}return i};WH.clearHash=function(e){var t=""+location.hash;var i=(""+location.href).replace(/#.*/,"");if(e){if(window.history&&window.history.pushState){window.history.pushState({},"",i)}else{location.hash="#."}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",i)}else{location.replace("#.")}}return t};WH.selectText=function(e){var t=document,i=t.getElementById(e),a,n;if(t.body.createTextRange){a=document.body.createTextRange();a.moveToElementText(i);a.select()}else if(window.getSelection){n=window.getSelection();a=document.createRange();a.selectNodeContents(i);n.removeAllRanges();n.addRange(a)}};WH.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};WH.loadAssets=function(e,t){var i=function(e){var t=WH.ce("link");t.rel="stylesheet";if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}t.href=e;WH.ae(document.getElementsByTagName("head")[0],t)};var a=function(e,t,i){var a=WH.ce("script");a.type="text/javascript";if(i&&WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.src=e;if(t){WH.aE(a,"load",t)}WH.ae(document.getElementsByTagName("head")[0],a)};switch(e){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(t){t()}return}i(WH.STATIC_URL+"/css/tools/artifact-calc.css");var n=WH.STATIC_URL+"/js/ArtifactCalc.js";if(WH.isSet("g_artifact_textures")){a(n,t,true)}else{var s=WH.Url.getDataPageUrl("artifact-calc");a(s,a.bind(null,n,t,true))}break;case"azerite-finder":if(WH.Wow.AzeriteFinder){if(t){t()}return}i(WH.STATIC_URL+"/css/tools/azerite-finder.css");a(WH.STATIC_URL+"/js/WH/Wow/AzeriteFinder.js",t,true);break;case"di-paragon-skill-calc":if(WH.DI.ParagonCalc&&WH.DI.ParagonCalc.Shell){if(t){t()}break}WH.loadFont("Exocet");i(WH.STATIC_URL+"/css/tools/partials/paragon-calc.css");i(WH.STATIC_URL+"/css/tools/paragon-calc-shell.css");a(WH.Url.getDataPageUrl("paragon-calc",WH.dataEnv.DI),(()=>{a(WH.STATIC_URL+"/js/WH/DI/ParagonCalc.js",(()=>{a(WH.STATIC_URL+"/js/WH/DI/ParagonCalc/Shell.js",t,true)}),true)}));break;case"diablo-2-skill-calc":if(WH.D2.hasOwnProperty("SkillCalc")){if(t){t()}break}WH.loadFont("Exocet");i(WH.STATIC_URL+"/css/d2/skill-calc.css");a(WH.Url.getDataPageUrl("diablo2-skills",WH.dataEnv.MAIN),(function(){a(WH.STATIC_URL+"/js/WH/D2/SkillCalc.js",t,true)}));break;case"gear-planner":let c=WH.isTbcTree()?"GearPlannerTbc":"GearPlanner";if(WH.Wow[c]){if(t){t()}break}WH.loadAssets("talent-calc-classic",(function(){i(WH.staticUrl+"/css/tools/gear-planner.css");t=a.bind(null,WH.staticUrl+"/js/WH/Wow/"+c+".js",t,true);t=a.bind(null,WH.staticUrl+"/js/WH/Listview/Templates/item.js",t,true);t=a.bind(null,WH.Url.getDataPageUrl("gear-planner"),t,false);t=a.bind(null,WH.Url.getDataPageUrl("weight-presets"),t,false);if(c==="GearPlannerTbc"&&!WH.applyStatModifications.ScalingData){t=a.bind(null,WH.Url.getDataPageUrl("item-scaling"),t,false)}t()}));break;case"heart-of-azeroth-calc":if(WH.Wow.HeartOfAzerothCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/heart-of-azeroth-calc.css");var r=a.bind(null,WH.staticUrl+"/js/WH/Wow/HeartOfAzerothCalc.js",t,true);if(!WH.Wow.AzeriteEssence){a(WH.staticUrl+"/js/WH/Wow/AzeriteEssence.js",a.bind(null,WH.Url.getDataPageUrl("azerite-essence"),r,false),true)}else{r()}break;case"mythic-damage-calc":if(WH.Wow.MythicDamageCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/mythic-damage-calc.css");a(WH.staticUrl+"/js/WH/Wow/MythicDamageCalc.js",(function(){a(WH.Url.getDataPageUrl("mythic-damage-calc"),t)}),true);break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(t){t()}return}i(WH.STATIC_URL+"/css/tools/pvp-calc.css");var o=WH.STATIC_URL+"/js/talent-pvp.js";if(WH.isSet("g_talents_pvp")){a(o,t,true)}else{a(WH.Url.getDataPageUrl("talents-pvp"),a.bind(null,o,t,true))}break;case"soulbind-calc":if(WH.Wow.SoulbindCalc){if(t){t()}break}i(WH.staticUrl+"/css/tools/soulbind-calc.css");a(WH.staticUrl+"/js/WH/Wow/SoulbindCalc.js",t,true);break;case"talent-calc":if(WH.isSet("TalentCalc")){if(t){t()}return}i(WH.STATIC_URL+"/css/tools/talent-calc.css");var l=WH.STATIC_URL+"/js/WH/Wow/TalentCalc.js";if(WH.isSet("g_glyphs")){a(l,t,true)}else{a(WH.Url.getDataPageUrl("glyphs"),a.bind(null,l,t,true))}break;case"talent-calc-classic":if(WH.Wow.hasOwnProperty("TalentCalcClassic")){if(t){t()}return}i(WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-classic.css");a(WH.staticUrl+"/js/WH/Wow/TalentCalcClassic.js",(function(){a(WH.Url.getDataPageUrl("talents-classic"),t)}),true);break;default:alert('Tried to load unknown asset set "'+String(e)+'".')}};WH.isInt=function(e){return typeof e==="number"&&parseFloat(e)==parseInt(e)&&!isNaN(e)};WH.ensureObjectPath=function(e,t){var i=Array.prototype.slice.call(arguments,1);if(typeof i[0]!="string"){return e}if(typeof e[i[0]]!="object"){e[i[0]]={}}if(i[1]){e[i[0]]=WH.ensureObjectPath.apply(this,[e[i[0]]].concat(i.slice(1)))}return e};WH.preventDefault=function(e){if(e&&e.preventDefault){e.preventDefault()}};WH.preventTyping=function(e){if(e&&e.preventDefault){var t="which"in e?e.which:e.keyCode;var i=t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||t>=106&&t<=111||t>=186&&t<=192||t>=219&&t<=222;var a=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;if(i&&!a){e.preventDefault()}}};WH.leadingZeroes=function(e,t){var i=e+"";while(i.length<t)i="0"+i;return i};$(document).ready((function(){$("a.wsach").each((function(){var e=$(this).text();var t=$(this).attr("title");var i=parseInt($(this).attr("data-earned"));var a=$(this).attr("data-user");var n=$(this).parent().parent().attr("id")=="user-achievement-list";var s=$(this).attr("data-progress");var r=$(this).attr("data-quality");var o=$(this).attr("data-count");$(this).attr("title","");var l=$("<div>");l.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+r+'"></b></td></tr><tr><td><span></span></td></tr></table>');l.find("b").text(e);l.find("span").text(t);if(i){var c=null;var u=(new Date).getTime()/1e3;if(a){if(i>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime4_format:WH.TERMS.earnedwsatime4_format,a,WH.formatDateSimple(new Date((u-i)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime2_format:WH.TERMS.earnedwsatime2_format,a,WH.formatTimeElapsed(i))+"</span>")}}else if(!n){if(i>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime3_format:WH.TERMS.earnedwsatime3_format,WH.formatDateSimple(new Date((u-i)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime_format:WH.TERMS.earnedwsatime_format,WH.formatTimeElapsed(i))+"</span>")}}if(c){l.append('<span class="q0"><br />'+c+"</span>")}}else if(!n&&s){l.append('<span class="q0"><br /><small></small>'+WH.TERMS.progress_format.replace("%s",s)+"</td></tr>")}WH.Tooltip.simple(this,l.html(),undefined,{byCursor:true})}))}));WH.User=new function(){const e=this;const t="TOMRUS";this.disableDebug=function(){g_user.debug=false};this.getCommentRoleClass=function(e,i){if(e&U_GROUP_ADMIN){return"comment-role-admin"}else if(e&U_GROUP_GREEN_TEXT&&i!==t){return"comment-role-moderator"}else if(e&U_GROUP_VIP){return"comment-role-vip"}else if(e&U_GROUP_PREMIUMISH){return"comment-role-premium"}return null};this.getDebug=function(){return e.hasRole(U_GROUP_STAFF)&&(g_user.debug||WH.getGets().debug!=null)};this.getId=function(){return g_user.id};this.getPath=function(){if(!WH.User.isLoggedIn()){return null}return WH.Url.generatePath("/user="+encodeURIComponent(WH.User.getUsername()))};this.getReputation=function(){return g_user.reputation||0};this.getUsername=function(){return g_user.name||""};this.hasRole=function(e){if(!e){return true}return!!(g_user.roles&e)};this.isLoggedIn=function(){return g_user.id>0};this.isPremium=function(){return!!g_user.premium};this.isUsernameValid=function(e){return e.match(/[^a-z0-9]/i)==null&&e.length>=4&&e.length<=16};this.saveOption=function(e,t,i){let a={method:"POST",json:{key:e,value:t}};if(typeof i==="function"){a.success=i}WH.fetch("/account/save-option",a)}};var U_GROUP_TESTER=1;var U_GROUP_ADMIN=2;var U_GROUP_EDITOR=4;var U_GROUP_MOD=8;var U_GROUP_BUREAU=16;var U_GROUP_DEV=32;var U_GROUP_VIP=64;var U_GROUP_BLOGGER=128;var U_GROUP_PREMIUM=256;var U_GROUP_LOCALIZER=512;var U_GROUP_SALESAGENT=1024;var U_GROUP_SCREENSHOT=2048;var U_GROUP_VIDEO=4096;var U_GROUP_APIONLY=8192;var U_GROUP_PENDING=16384;var U_GROUP_STAFF=U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER|U_GROUP_LOCALIZER|U_GROUP_SALESAGENT;var U_GROUP_EMPLOYEE=U_GROUP_ADMIN|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_GREEN_TEXT=U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_PREMIUMISH=U_GROUP_PREMIUM|U_GROUP_EDITOR;var U_GROUP_MODERATOR=U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU;var U_GROUP_COMMENTS_MODERATOR=U_GROUP_MODERATOR|U_GROUP_LOCALIZER|U_GROUP_EDITOR;var U_GROUP_PREMIUM_PERMISSIONS=U_GROUP_PREMIUM|U_GROUP_STAFF|U_GROUP_VIP|U_GROUP_EDITOR;var g_users={};WH.LocalStorage=new function(){this.clear=function(){if(!WH.LocalStorage.isSupported()){return}localStorage.clear()};this.isSupported=function(){var e;try{e="localStorage"in window&&window["localStorage"]!==null}catch(t){e=false}if(e){try{localStorage.setItem("test","123");e=localStorage.getItem("test")=="123";localStorage.removeItem("test")}catch(t){e=false}}WH.LocalStorage.isSupported=function(e){return e}.bind(null,e);return e};this.jsonGet=function(e){if(!WH.LocalStorage.isSupported()){return undefined}try{return JSON.parse(localStorage.getItem(e))}catch(t){let i;try{i=localStorage.getItem(e)}catch(e){i="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse local storage data that should have been JSON.",e,i);return undefined}};this.jsonSet=function(e,t){if(!WH.LocalStorage.isSupported()){return}let i;try{i=JSON.stringify(t)}catch(i){WH.error("Failed to stringify local storage data.",WH.getThrownErrorMessage(i),e,t);return}localStorage.setItem(e,i)};this.set=function(e,t){if(!WH.LocalStorage.isSupported()){return}localStorage.setItem(e,t)};this.get=function(e){if(!WH.LocalStorage.isSupported()){return}return localStorage.getItem(e)};this.remove=function(e){if(!WH.LocalStorage.isSupported()){return}localStorage.removeItem(e)}};WH.SessionStorage=new function(){this.isSupported=function(){var e;try{e="sessionStorage"in window&&window["sessionStorage"]!==null}catch(t){e=false}if(e){try{sessionStorage.setItem("test","123");e=sessionStorage.getItem("test")=="123";sessionStorage.removeItem("test")}catch(t){e=false}}WH.SessionStorage.isSupported=function(e){return e}.bind(null,e);return e};this.set=function(e,t){if(!WH.SessionStorage.isSupported()){return}sessionStorage.setItem(e,t)};this.get=function(e){if(!WH.SessionStorage.isSupported()){return}return sessionStorage.getItem(e)};this.remove=function(e){if(!WH.SessionStorage.isSupported()){return}sessionStorage.removeItem(e)}};WH.Time=new function(){const e=this;this.DAYS_PER_WEEK=7;this.MS_SEC=1e3;this.MS_MIN=this.MS_SEC*60;this.MS_HOUR=this.MS_MIN*60;this.MS_DAY=this.MS_HOUR*24;this.SEC_MIN=60;this.SEC_HOUR=this.SEC_MIN*60;this.SEC_DAY=this.SEC_HOUR*24;const t=[WH.TERMS.january,WH.TERMS.february,WH.TERMS.march,WH.TERMS.april,WH.TERMS.may,WH.TERMS.june,WH.TERMS.july,WH.TERMS.august,WH.TERMS.september,WH.TERMS.october,WH.TERMS.november,WH.TERMS.december];const i={ABBR:{SECOND:WH.TERMS.second_abbrev,MINUTE:WH.TERMS.minute_abbrev,HOUR:WH.TERMS.hour_abbrev,DAY:WH.TERMS.day_abbrev,WEEK:WH.TERMS.week_abbrev,MONTH:WH.TERMS.month_abbrev,YEAR:WH.TERMS.year_abbrev},PLURAL:{SECOND:WH.TERMS.seconds_lc,MINUTE:WH.TERMS.minutes_lc,HOUR:WH.TERMS.hours_lc,DAY:WH.TERMS.days_lc,WEEK:WH.TERMS.weeks_lc,MONTH:WH.TERMS.months_lc,YEAR:WH.TERMS.years_lc},SINGULAR:{SECOND:WH.TERMS.second_lc,MINUTE:WH.TERMS.minute_lc,HOUR:WH.TERMS.hour_lc,DAY:WH.TERMS.day_lc,WEEK:WH.TERMS.week_lc,MONTH:WH.TERMS.month_lc,YEAR:WH.TERMS.year_lc},SYMBOL:{SECOND:WH.TERMS.second_short_abbrev,MINUTE:WH.TERMS.minute_short_abbrev,HOUR:WH.TERMS.hour_short_abbrev,DAY:WH.TERMS.day_short_abbrev,WEEK:WH.TERMS.week_short_abbrev,MONTH:WH.TERMS.month_short_abbrev,YEAR:WH.TERMS.year_short_abbrev}};const a=[WH.TERMS.sunday,WH.TERMS.monday,WH.TERMS.tuesday,WH.TERMS.wednesday,WH.TERMS.thursday,WH.TERMS.friday,WH.TERMS.saturday];this.formatDeltaWithSymbols=function(t){let a;if(t<e.SEC_MIN){let e=Math.floor(e);a=e+i.SYMBOL.SECOND}else if(t<e.SEC_HOUR){let e=Math.floor(t/60);a=e+i.SYMBOL.MINUTE}else if(t<e.SEC_DAY){let n=Math.floor(t/e.SEC_HOUR);let s=Math.floor((t-n*e.SEC_HOUR)/e.SEC_MIN);a=n+i.SYMBOL.HOUR;if(s>0){a+=WH.TERMS.wordspace_punct+s+i.SYMBOL.MINUTE}}else{let n=Math.floor(t/e.SEC_DAY);let s=Math.floor((t-n*e.SEC_DAY)/e.SEC_HOUR);a=n+i.SYMBOL.DAY;if(s>0){a+=WH.TERMS.wordspace_punct+s+i.SYMBOL.HOUR}}return a};this.formatFutureTimeAndDay=function(n,s){let r;let o=new Date;let l=o.getTime()/e.MS_SEC;let c=n.getTime()/e.MS_SEC;if(c-e.SEC_HOUR<l){let t=Math.floor((c-l)/e.SEC_MIN);r=t+WH.TERMS.wordspace_punct+(t===1?i.SINGULAR.MINUTE:i.PLURAL.MINUTE)}else if(c-e.SEC_HOUR*8<l){let t=Math.floor((c-l)/e.SEC_MIN);let a=Math.floor(t/60);t-=a*60;let o=a+WH.TERMS.wordspace_punct+(a===1?i.SINGULAR.HOUR:i.PLURAL.HOUR);if(t>0){o+=WH.TERMS.wordspace_punct+t+WH.TERMS.wordspace_punct+(t===1?i.SINGULAR.MINUTE:i.PLURAL.MINUTE)}r=o+WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+e.formatTimeOfDay(n,s)+WH.TERMS.closedparenthesis_punct}else{if(n.toDateString()===o.toDateString()){r=e.formatTimeOfDay(n,s)}else{let i;if(n<=new Date(o.getFullYear(),o.getMonth(),o.getDate()+6,23,59)){i=n.getDate()-1===o.getDate()?WH.TERMS.tomorrow:a[n.getDay()]}else{i=a[n.getDay()]+WH.TERMS.wordspace_punct+t[n.getMonth()]+WH.TERMS.wordspace_punct+n.getDate()}r=e.formatTimeOfDay(n,s)+WH.TERMS.wordspace_punct+i}}return r};this.formatTimeOfDay=function(e,t){let i=e.getHours();let a=WH.leadingZeroes(e.getMinutes(),2);let n;if(t===true){n=i+":"+a}else{let e=i>=12?WH.TERMS.pm:WH.TERMS.am;if(i>12){n=i-12}else if(i===0){n=12}else{n=i}n+=":"+a+WH.TERMS.wordspace_punct+e}return n};this.getMonthName=function(e){return t[e]};this.getWeekdayName=function(e){return a[e]};this.unix=function(){return Math.floor((new Date).getTime()/1e3)}};WH.Admin=new function(){this.foo="test"};function Ajax(e,t){if(!e){return}var i;try{i=new XMLHttpRequest}catch(e){return}this.request=i;WH.cO(this,t);this.method=this.method||this.params&&"POST"||"GET";i.open(this.method,e,this.async==null?true:this.async);i.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){i.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}i.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||this.request.status>=200&&this.request.status<300){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};WH.Announcement=function(e){const t=this;const i={allowMarkup:undefined,class:undefined,elements:{innerDiv:undefined},id:undefined,mobileText:undefined,parent:undefined,text:undefined};this.hide=function(){i.parentDiv.dataset.animation="hide";setTimeout((function(){i.parentDiv.classList.remove("show");delete i.parentDiv.dataset.animation}),200)};this.markRead=function(){WH.Track.interactiveEvent("Announcements","Close",""+i.name);if(!r()){let e=WH.LocalStorage.get(WH.Announcement.getLocalStorageKey())||"";e=e.split(",").filter((function(e){return!!e}));e.push(i.id);WH.LocalStorage.set(WH.Announcement.getLocalStorageKey(),e.join(","))}t.hide()};this.setClass=function(e){i.class=e;i.parentDiv.className=n()};this.setStyle=function(e){i.elements.innerDiv.setAttribute("style",e?WH.fixWowheadHttps(e):"")};this.setText=function(e,t){i.text=e;i.mobiletext=t;a(i.parent+"-markup",i.text);a(i.parent+"-markup-responsive",t||e)};this.show=function(){i.parentDiv.classList.add("show");WH.Track.nonInteractiveEvent("Announcements","Show",""+i.name)};function a(e,t){let a=WH.ge(e);if(i.allowMarkup){WH.markup.printHtml(t,a.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(a,t)}WH.Track.addClickEvents(a,{category:"Announcements",actions:{"Follow link":function(){return true}}},i.id)}function n(){let e="announcement announcement-";switch(i.mode){case 2:e+="fixed";break;case 0:e+="pagetop";break;case 1:default:e+="contenttop"}if(i.class){i.class.split(" ").forEach((function(t){e+=" announcement-styling-"+t}))}return e}function s(e){if(WH.UserAgent.isWebCrawler()){return}if(!e||!e.hasOwnProperty("id")||!["number","string","undefined"].includes(typeof e.id)||typeof e.parent!=="string"||typeof e.text!=="string"){WH.error("Announcement initialized with invalid options.",e);return}i.id=e.id;i.parent=e.parent;i.text=e.text;if(!e.admin&&r()){return}i.allowMarkup=typeof e.allowMarkup==="boolean"?e.allowMarkup:true;i.parentDiv=e.parentDiv||WH.ge(i.parent);i.parentDiv.dataset.announcementId=i.id;WH.displayNone(i.parentDiv);i.class=e.class;i.parentDiv.className=n();let a=i.elements.innerDiv=WH.ce("div",{className:"announcement-inner text"});if(e.style){t.setStyle(e.style)}let s=typeof e.id==="string";if(WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BUREAU)>0&&!s){if(!e.admin){let e=WH.ce("a",{className:"fa fa-pencil",href:"/admin/announcements/edit/"+i.id});WH.Tooltip.simpleNonTouch(e,WH.TERMS.edit,"q2");WH.ae(a,e)}}WH.ae(a,WH.ce("div",{className:"announcement-markup",id:i.parent+"-markup"}));WH.ae(a,WH.ce("div",{className:"announcement-markup-responsive",id:i.parent+"-markup-responsive"}));if(!s&&!e.admin){let i=WH.ce("a",{className:"fa fa-times announcement-close",id:"closeannouncement"});WH.aE(i,"click",e.nocookie?t.hide:t.markRead);WH.ae(a,i);WH.Tooltip.simpleNonTouch(i,WH.TERMS.close,"q2")}WH.ae(a,WH.ce("div",{style:{clear:"both"}}));WH.ae(i.parentDiv,a);t.setText(e.text,e.mobiletext);setTimeout(t.show,500)}function r(){if(!i.id){return false}let e=(WH.LocalStorage.get(WH.Announcement.getLocalStorageKey())||"").split(",");return e.includes(i.id.toString())}s(e)};WH.Announcement.forgetRead=function(){WH.LocalStorage.remove(WH.Announcement.getLocalStorageKey());let e=WH.ge("announcetext");if(e){WH.ee(e);WH.ae(e,WH.ct(WH.TERMS.purgesuccess_tip));e.className="q2"}else{alert(WH.TERMS.purgesuccess_tip)}};WH.Announcement.getLocalStorageKey=function(){let e="announcements-closed";let t=WH.User.getId();if(t){e+="-"+t}return e};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){if(e instanceof Object){var t="";if(e.constructor===Array){for(var i=0;i<e.length;t+=this.stringify(e[i])+",",i++);return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString){return'"'+e.toString().replace(/"/g,"\\$&")+'"'}for(var a in e){t+='"'+a.replace(/"/g,"\\$&")+'":'+this.stringify(e[a])+","}return"{"+t.substr(0,t.length-1)+"}"}return typeof e==="string"?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}}}AudioControls=function(){const e=WH.Strings;const t={addAllTracks:false,list:undefined};var i=-1;var a=false;var n=false;var s=false;var r={};var o=[];function l(){if(g_audiocontrols.__rewardedAchievement)return;if(!(WH.isSet("g_user")&&g_user.id))return;$.ajax({url:"/website-achievement-explored",data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function c(e,n,c){var f=WH.ce("audio");f.preload="none";f.controls="true";$(f).click((function(e){e.stopPropagation()}));WH.aE(f,"ended",l);f.style.marginTop="5px";r.audio.parentNode.replaceChild(f,r.audio);r.audio=f;WH.aE(r.audio,"ended",d.bind(e));if(c){f.preload="auto";s=true;WH.aE(r.audio,"canplaythrough",u.bind(this))}if(!a)r.table.style.visibility="visible";var h;do{i+=n;if(i>o.length-1){i=0;if(!a){WH.de(r.table);WH.de('a[href="/sound&playlist"].btn');return}}if(i<0)i=o.length-1;h=o[i]}while(r.audio.canPlayType(h.type)=="");var p=WH.ce("source");p.src=h.url;p.type=h.type;WH.ae(r.audio,p);if(t.list){t.list.childNodes.forEach((function(e){e.dataset.current=JSON.stringify(e.dataset.track===h.title)}))}if(r.hasOwnProperty("trackDisplay")){WH.st(r.trackDisplay,i+1+" / "+o.length)}if(!a){a=true;for(let e=i+1;e<=o.length-1;e++){if(r.audio.canPlayType(o[e].type)){WH.qsa("a",r.controls).forEach((function(e){delete e.dataset.disabled}));break}}}if(r.hasOwnProperty("addbutton")){delete r.addbutton.dataset.disabled;WH.st(r.addbutton,WH.TERMS.playlist)}}function u(){if(!s)return;s=false;r.audio.play()}this.init=function(i,a,s){if(!Array.isArray(i)){return}if(i.length===0){return}if(a.id===""||g_audiocontrols.hasOwnProperty(a.id)){a.id=e.guid()}g_audiocontrols[a.id]=this;if(typeof s=="undefined"){s={}}t.list=s.list;n=!!s.loop;o=i;r.div=a;r.controls=WH.ce("div",{className:"audio-controls-controls"});if(!s.listview){var l=WH.ce("table",{className:"audio-controls"});r.table=l;r.table.style.visibility="hidden";WH.ae(r.div,l);var c=WH.ce("tr");WH.ae(l,c);var u=WH.ce("td");WH.ae(c,u);r.audio=WH.ce("div");WH.ae(u,r.audio);WH.ae(u,r.controls);let e=f(WH.TERMS.previous,"step-backward",true);WH.ae(r.controls,e);WH.aE(e,"click",this.btnPrevTrack.bind(this));r.trackDisplay=WH.ce("div",{className:"audio-controls-track"});WH.ae(r.controls,r.trackDisplay);let t=f(WH.TERMS.next,"step-forward",true);WH.ae(r.controls,t);WH.aE(t,"click",this.btnNextTrack.bind(this))}else{t.addAllTracks=true;let e=WH.ce("div",{className:"audio-controls"});r.table=e;WH.ae(r.div,e);r.audio=WH.ce("div");WH.ae(e,r.audio);r.trackDisplay=s.trackDisplay;WH.ae(e,r.controls)}r.table.dataset.tracks=""+o.length;r.trackDisplay.dataset.tracks=""+o.length;if(g_audioplaylist.isEnabled()&&!s.fromPlaylist){let e=f(WH.TERMS.playlist,"plus");WH.ae(r.controls,e);WH.aE(e,"click",this.btnAddToPlaylist.bind(this,e));r.addbutton=e}if(g_audiocontrols.__windowloaded)this.btnNextTrack()};function d(){c(this,1,n||i<o.length-1)}this.btnNextTrack=function(){c(this,1,a&&r.audio.readyState>1&&!r.audio.paused)};this.btnPrevTrack=function(){c(this,-1,a&&r.audio.readyState>1&&!r.audio.paused)};this.btnAddToPlaylist=function(e){if(t.addAllTracks){for(let e=0;e<o.length;e++){g_audioplaylist.addSound(o[e])}}else{g_audioplaylist.addSound(o[i])}e.dataset.disabled="true";e.classList.remove("fa-plus");e.classList.add("fa-check");WH.st(e,WH.TERMS.added)};this.isPlaying=function(){return!r.audio.paused};this.removeSelf=function(){r.table.parentNode.removeChild(r.table);delete g_audiocontrols[r.div]};function f(e,t,i){let a=WH.ce("a",{className:"audio-controls-control page-action fa fa-"+t,href:"javascript:"},WH.ct(e));if(i){a.dataset.disabled="true"}return a}};WH.aE(window,"load",(function(){g_audiocontrols.__windowloaded=true;for(var e in g_audiocontrols)if(e.substr(0,2)!="__")g_audiocontrols[e].btnNextTrack()}));AudioPlaylist=function(){var e=false;var t=[];var i,a;var n=false;this.init=function(){if(!WH.LocalStorage.isSupported()){return}e=true;var i=WH.LocalStorage.get("AudioPlaylist");if(i){t=JSON.parse(i)}};this.savePlaylist=function(){if(!e)return false;WH.LocalStorage.set("AudioPlaylist",JSON.stringify(t))};this.isEnabled=function(){return e};this.addSound=function(i){if(!e)return false;this.init();t.push(i);this.savePlaylist();s()};this.deleteSound=function(e){if(e<0){t=[]}else{t.splice(e,1)}this.savePlaylist();if(!i.isPlaying()){i.removeSelf();this.setAudioControls(a)}if(t.length==0)WH.Tooltip.hide()};this.getList=function(){var e=[];for(var i=0;i<t.length;i++)e.push(t[i].title);return e};this.setAudioControls=function(n){if(!e)return false;a=n;i=new AudioControls;i.init(t,a,{loop:true,fromPlaylist:true})};function s(){if(n)return;if(!(WH.isSet("g_user")&&g_user.id))return;if(t.length<2)return;$.ajax({url:"/sound&playlist",data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});n=true}};g_audioplaylist=new AudioPlaylist;g_audioplaylist.init();WH.BlizzardApi=new function(){const e={us:"northamerican_abbrev",eu:"european_abbrev",cn:"chinese_abbrev",tw:"taiwanese_abbrev",kr:"korean_abbrev"};var t={us:"us.api.blizzard.com",eu:"eu.api.blizzard.com",kr:"kr.api.blizzard.com",tw:"tw.api.blizzard.com"};var i=false;var a={};var n=[];this.apiCall=function(e,i,n){e=e.toLowerCase();if(!t.hasOwnProperty(e)){WH.error("Invalid region passed to Blizzard API:",e);return}if(!a.token||a.hasOwnProperty("expires")&&a.expires<new Date){if(a.failed){var s=["error","complete"];for(var r,o=0;r=s[o];o++){if(typeof n[r]==="function"){n[r]=[n[r]]}if(Array.isArray(n[r])){while(n[r].length){n[r].shift()({status:400},"abort")}}}}else{this.getNewToken(this.apiCall.bind(this,e,i,n))}return}n.url="https://"+t[e]+i;if(0){if(!n.hasOwnProperty("headers")){n.headers={}}n.headers.Authorization="Bearer "+a.token}else{if(!n.hasOwnProperty("data")){n.data={}}n.data.access_token=a.token}$.ajax(n)};this.characterExists=function(e,t,a,n){if(!WH.LocalStorage.isSupported()||!(JSON&&"stringify"in JSON)){n(true);return}var s=t.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var r=(e+"|"+s+"|"+a).toLowerCase();if(!i){i={};try{i=JSON.parse(WH.LocalStorage.get("BattleNetCharCache"));if(i==null){i={}}}catch(e){i={}}}if(i.hasOwnProperty(r)){if(parseInt(i[r].substr(1),10)>Math.floor((Date.now()-1e3*60*60*24*4)/1e3)){n(i[r].substr(0,1)=="t");return}}var o=function(e){i[r]=(e&&e.is_valid?"t":"f")+Math.floor(Date.now()/1e3);WH.LocalStorage.set("BattleNetCharCache",JSON.stringify(i));n(e&&e.name)};WH.Wow.Realm.fetchData(function(){var i=WH.Wow.Realm.getSlugByName(e,t);if(!i){o(false)}else{this.apiCall(e,WH.Strings.sprintf("/profile/wow/character/%s/%s/status?namespace=profile-%s",encodeURIComponent(i),encodeURIComponent(a.toLocaleLowerCase()),e.toLowerCase()),{dataType:"json",method:"GET",success:o,error:o.bind(null,false)})}}.bind(this))};this.getCharacterThumbnailUrl=function(e,t){return"https://render-"+e.toLowerCase()+".worldofwarcraft.com/character/"+t};this.getNewToken=function(e){n.push(e);if(n.length>1){return}var t=$.ajax.bind($,{url:"/blizzard-api/token",dataType:"json",method:"GET",success:this.setToken,error:function(e){WH.error("Could not get Blizzard API token from Wowhead",e);this.setToken(null)}.bind(this)});if(!a.hasOwnProperty("token")&&document.readyState=="loading"&&document.addEventListener){var i=function(){document.removeEventListener("readystatechange",i,false);if(!a.hasOwnProperty("token")){t()}};document.addEventListener("readystatechange",i,false)}else{t()}};this.getNotFoundMessage=function(){let e=document.createDocumentFragment();WH.ae(e,WH.ct(WH.TERMS.characterDoesNotExist_tip));let t=WH.ce("ul");WH.ae(e,t);WH.ae(t,WH.ce("li",{},WH.ct(WH.TERMS.characterHasBeenAccessedRecently_tip)));WH.ae(t,WH.ce("li",{innerHTML:WH.Strings.sprintf(WH.TERMS.yourBlizzardSettingsSetToEnabled_format,WH.ce("a",{href:"https://account.blizzard.com/privacy"},WH.ct(WH.TERMS.gameDataAndProfilePrivacy)).outerHTML)}));let i=WH.ce("div",{innerHTML:WH.Strings.sprintf(WH.TERMS.furtherIssues_format,WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.feedback)).outerHTML)});WH.aE(i.querySelector("a"),"click",ContactTool.show.bind(ContactTool,undefined));while(i.hasChildNodes()){WH.ae(e,i.removeChild(i.firstChild))}return e};this.getRegionAbbreviation=function(t){return WH.TERMS[e[t.toLowerCase()]]};this.setToken=function(e){if(!e||!e.hasOwnProperty("token")){a={failed:true};while(n.length){n.shift()()}a={};return}a=e;a.expires=new Date(Date.now()+a.expires*1e3);while(n.length){n.shift()()}}};WH.CommentReplies=new function(){this.setupReplies=function(a,n,s){e(a,n,s,false);t(a,n,s);a.find(".comment-reply-row").each((function(){i($(this),n,s)}));a.find(".comment-reply-row").hover((function(){$(this).find("span").attr("data-hover","true")}),(function(){$(this).find("span").attr("data-hover","false")}))};function e(e,t,i,a){let n=null;let s=null;let r=null;let o=null;let l=null;let c=null;let u=WH.getPageData("guide.author")===WH.User.getUsername()?WH.Comments.MAX_LENGTH_COMMENT:WH.Comments.MAX_LENGTH_REPLY;let d=WH.Comments.MIN_LENGTH;let f=null;let h=false;let p=false;let m=false;let H=false;let g=e.find(".comment-replies > table");let W=e.find(".add-reply");let v=t.replies.length;if(a){_()}else{W.click((function(){_()}))}function T(){if(h){return}h=true;let i=$("<tr/>");if(a){i.addClass("comment-reply-row").addClass("reply-edit-row")}i.html('<td style="width: 0"></td>'+'<td class="comment-form"><form><table>'+"<form>"+"<table><tr>"+'<td style="width: 600px">'+'<textarea required="required" name="body" cols="68" rows="3"></textarea>'+"</td>"+"<td>"+'<input type="submit" value="'+(a?WH.TERMS.save:WH.TERMS.addreply)+'" />'+'<img src="'+WH.staticUrl+'/images/icons/ajax.gif" class="ajax-loader" />'+"</td>"+"</tr>"+'<tr><td colspan="2">'+'<span class="text-counter">Text counter placeholder</span>'+"</td></tr></table>"+"</form>"+"</td>");r=i.find(".comment-form textarea");n=i.find(".comment-form input[type=submit]");f=i.find(".comment-form span.text-counter");l=i.find(".comment-form form");s=i.find(".comment-form .ajax-loader");c=i.find(".comment-form");l.submit((function(){b();return false}));N();r.keyup((function(e){N()}));r.keydown((function(e){if(e.keyCode==27){E();return false}}));r.keypress((function(e){if(e.keyCode==13){b();return false}}));if(a){e.after(i);e.hide();l.find("textarea").text(t.replies[e.attr("data-idx")].body)}else{g.append(i)}o=i;WH.safeFocus(l.find("textarea"))}function _(){if(!h){T()}p=true;if(!a){W.hide();e.find(".comment-replies").show();c.show()}}function E(){p=false;if(a){if(o){o.remove()}e.show();return}W.show();c.hide();if(v==0){e.find(".comment-replies").hide()}}function b(){if(!p||H){return}if(r.val().length<d||r.val().length>u){if(!m){m=true;f.animate({opacity:"0.0"},150);f.animate({opacity:"1.0"},150,null,(function(){m=false}))}return false}y();$.ajax({type:"POST",url:WH.Url.generatePath(a?"/comment/edit-reply":"/comment/add-reply"),data:{commentId:t.id,replyId:a?e.attr("data-replyid"):0,body:r.val()},success:function(e){I(e)},dataType:"json",error:function(e){w(e.responseText)}});return true}function y(){H=true;s.show();n.prop("disabled",true);c.find(".wh-message-box").remove()}function S(){H=false;s.hide();n.prop("disabled",false)}function I(e){t.replies=e;Listview.templates.comment.updateReplies.call(i,t)}function w(e){S();MessageBox(c,e)}function N(){let e="(error)";let t="q0";let i=r.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;let a=u-i;if(i==0){e=WH.sprintf(WH.TERMS.replylength1_format,d)}else if(i<d){e=WH.sprintf(WH.TERMS.replylength2_format,d-i)}else{e=WH.sprintf(WH.term(a===1?"replylength4_format":"replylength3_format"),a);if(a<120){t="chars-left-none"}else if(a<240){t="chars-left-some"}else if(a<360){t="chars-left-many"}}f.html(e).attr("class",t)}}function t(e,t,i){var a=e.find(".show-more-replies");var n=e.find(".comment-replies");a.click((function(){s()}));function s(){a.hide();n.append($("<img>",{class:"ajax-loader",alt:"",src:WH.staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:WH.Url.generatePath("/comment/show-replies"),data:{id:t.id},success:function(e){t.replies=e;Listview.templates.comment.updateReplies.call(i,t)},dataType:"json",error:function(){r()}})}function r(){a.show();n.find(".ajax-loader").remove();MessageBox(n,"There was an error fetching the comments. Try refreshing the page.")}}function i(t,i,a){var n=t.attr("data-replyid");var s=t.find(".reply-upvote");var r=t.find(".reply-downvote");var o=t.find(".reply-report");var l=t.find(".reply-rating");var c=t.find(".reply-controls");var u=t.find(".reply-delete");var d=t.find(".reply-edit");var f=false;var h=false;d.click((function(){e(t,i,a,true)}));o.click((function(){if(f||!confirm(WH.TERMS.replyreportwarning_tip))return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"report"},success:function(){m()},error:function(e){g(e.responseText)}})}));s.click((function(){if(s.attr("data-hasvoted")=="true"||s.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"up"},success:function(){p(1)},error:function(e){g(e.responseText)}})}));r.click((function(){if(r.attr("data-hasvoted")=="true"||r.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"down"},success:function(){p(-1)},error:function(e){g(e.responseText)}})}));u.click((function(){if(h)return;if(!confirm(WH.TERMS.deletereplyconfirmation_tip))return;h=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/delete-reply"),data:{id:n},success:function(){H()},error:function(e){g(e.responseText)}})}));function p(e){var t=parseInt(l.text());t+=e;l.text(t);if(e>0)s.attr("data-hasvoted","true");else r.attr("data-hasvoted","true");s.attr("data-canvote","false");r.attr("data-canvote","false");if(e>0){o.remove()}f=false}function m(){f=false;o.remove()}function H(){t.remove();h=false}function g(e){f=false;h=false;if(!e)e="An error has occurred. Try refreshing the page.";MessageBox(c,e)}}};WH.Comments=new function(){const e=this;this.MIN_LENGTH=15;this.MAX_LENGTH_COMMENT=1e5;this.MAX_LENGTH_REPLY=600;this.EDIT_MODE_EDIT_FORUM_POST=-1;this.EDIT_MODE_EDIT_COMMENT=0;this.EDIT_MODE_ADD_COMMENT=1;this.EDIT_MODE_USER_DESCRIPTION=2;this.EDIT_MODE_ADD_FORUM_REPLY=3;this.EDIT_MODE_USER_SIGNATURE=4;this.LOW_RATING_THRESHOLD=-4;var t=1;var i=2;this.appendImportedSubject=function(e,t){if(!t){return}var i=t.replace(/^\s*Re\b|\bRe\s*$/,"").replace(/\s/,"");if(!i||!i.match(/[^:]/)){return}var a=WH.ce("span");WH.st(a,'"'+t+'"');var n=WH.ce("span",{className:"comment-imported-subject"});WH.st(n,WH.TERMS.subject_colon);WH.ae(n,a);e.append(n)};this.getColorClass=function(t,i,a,n){switch(i){case e.EDIT_MODE_EDIT_FORUM_POST:var s=null;if(!a){s=t.divPost.childNodes[1].className.match(/comment-([a-z-]+)/)}else{s=t.divBody[0].className.match(/comment-([a-z-]+)/)}if(s!=null){return" comment-"+s[1]}break;case e.EDIT_MODE_ADD_FORUM_REPLY:if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}case e.EDIT_MODE_USER_SIGNATURE:let i=WH.User.getCommentRoleClass(t.roles,t.user);if(i){return" "+i}break}if(t.roles&U_GROUP_ADMIN){return" comment-role-admin"}if(n){return" comment-guide-author"}if(t.commentv2&&t.sticky||t.roles&U_GROUP_GREEN_TEXT||t.rating>=10){return" comment-high-rating"}if(t.rating&&t.rating<-2){return" comment-low-rating"}if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}return""};this.edit=function(t,i,n){if(WH.qs(`#p${t.id} .comment-edit`)||t.container&&WH.qs(`.comment-edit`,t.container[0])){return}if(n){t.divBody.hide();t.divResponse.hide()}var s=$("<div/>");s.addClass("comment-edit");t.divEdit=s[0];if(i===e.EDIT_MODE_EDIT_FORUM_POST){if(g_users[t.user]!=null){t.roles=g_users[t.user].roles}}let r=i===e.EDIT_MODE_EDIT_FORUM_POST||i===e.EDIT_MODE_EDIT_COMMENT?undefined:"submit";let o=e.editAppend(s,t,i,n,undefined,undefined,r);var l=$("<div/>");l.addClass("comment-edit-buttons");var c=$("<button/>",{text:WH.TERMS.save});c.click(a.bind(this,true,t,i,n));l.append(c);l.append(WH.ct(" "));c=$("<button/>",{text:WH.TERMS.cancel});c.click(a.bind(this,false,t,i,n));l.append(c);s.append(l);s.insertAfter(t.divBody);WH.safeFocus(o)};this.editAppend=function(a,o,l,c,u,d,f){var h=e.getCharLimit(l);if(o.body===null){o.body=""}if(l===e.EDIT_MODE_ADD_COMMENT||l===e.EDIT_MODE_ADD_FORUM_REPLY||l===e.EDIT_MODE_USER_SIGNATURE){o.user=g_user.name;o.roles=g_user.roles;o.rating=1}else if(l===e.EDIT_MODE_USER_DESCRIPTION){o.roles=g_user.roles;o.rating=1}if(u){o.roles&=~U_GROUP_PENDING}if(l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT){var p=$("<div/>",{text:WH.TERMS.mode_colon});p.addClass("comment-edit-modes");var m=$("<a/>",{href:"javascript:",text:WH.TERMS.edit});m.click(s.bind(m[0],t,l,o));m.addClass("selected");p.append(m);p.append(WH.ct("|"));var H=$("<a/>",{href:"javascript:",text:WH.TERMS.preview});H.click(s.bind(H[0],i,l,o));p.append(H);a.append(p)}var g=$("<div/>",{css:{display:"none"}});g.addClass("text comment-body"+e.getColorClass(o,l,c));var W=$("<div/>");W.addClass("comment-edit-body");var v=$('<div style="float: left" />');v.addClass("toolbar");var T=$("<div/>");T.addClass("menu-buttons");var _=$("<textarea/>",{val:o.body,rows:10,css:{clear:"left"}});_.addClass("comment-editbox");switch(l){case e.EDIT_MODE_ADD_COMMENT:_.attr("name","commentbody");break;case e.EDIT_MODE_USER_DESCRIPTION:_.attr({name:"desc",originalValue:o.body});break;case e.EDIT_MODE_ADD_FORUM_REPLY:_.attr("name","body");break;case e.EDIT_MODE_USER_SIGNATURE:_.attr({name:"sig",originalValue:o.body,rows:3});_.css("height","auto");break}if(l!==e.EDIT_MODE_EDIT_FORUM_POST&&l!==e.EDIT_MODE_EDIT_COMMENT){var E=$("<a/>"),b=$("<div/>"),y=$("<div/>"),S=screen.availWidth<=480;var I=n.bind(e,o,l,_[0],b[0]);E.addClass("disclosure-"+(S?"off":"on"));E.text(WH.TERMS.livepreview);E.attr("href","javascript:");E.click((function(){I(1);var e=WH.toggleDisplay(b);E.toggleClass("disclosure-on",e);E.toggleClass("disclosure-off",!e)}));y.addClass("pad");g.append(WH.getMajorHeading(E,3,null,{classes:"first"}));g.append(b);g.append(y);WH.onAfterTyping(_[0],I,50);_.focus((function(){I();g.css("display",S?"none":"");if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){_.css("height","22em")}}))}else if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){_.focus((function(){_.css("height","22em")}))}var w=[{id:"b",icon:"bold",title:WH.TERMS.bold,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:WH.TERMS.italic,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:WH.TERMS.underline,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:WH.TERMS.strikethrough,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:WH.TERMS.smalltext_stc,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:WH.TERMS.link,nopending:true,onclick:function(){var e=prompt(WH.TERMS.linkurl_tip,"https://");if(e){WH.insertTag(_[0],"[url="+e+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:WH.TERMS.quotebox_stc,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:WH.TERMS.codebox_stc,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:WH.TERMS.unorderedlistbullets_stc,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"ol",icon:"list-ol",title:WH.TERMS.orderedlistnumbers_stc,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"li",icon:"circle",title:WH.TERMS.listitem_stc,pre:"[li]",post:"[/li]"}];if(!c){for(var N=0,R=w.length;N<R;++N){var M=w[N];if(l===e.EDIT_MODE_USER_SIGNATURE&&M.id=="quote"){break}if(g_user.roles&U_GROUP_PENDING&&M.nopending){continue}var A=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,_[0],e.pre,e.post,e.rep))()}.bind(null,M)});A[0].setAttribute("type","button");A.attr("title",M.title);var C=$("<i/>",{class:"fa fa-"+M.icon});A.append(C);v.append(A)}}else{for(var N=0,R=w.length;N<R;++N){var M=w[N];if(g_user.rolls&U_GROUP_PENDING&&M.nopending){continue}var k="tb-"+M.id;var A=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,_[0],e.pre,e.post,e.rep))()}.bind(null,M),class:k,title:M.title});A[0].setAttribute("type","button");A.append("<ins/>");v.append(A)}v.addClass("formatting")}let L=[];let O;for(let e in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(e)){continue}if(O=WH.markup.tags[e].entityType){let t=[O,WH.Types.getUpperSingular(O)+WH.TERMS.ellipsis_punct,WH.markup.insertEntityTag.bind(null,_[0],WH.Types.getLowerSingular(O),e)];let i=WH.Types.getRequiredTrees(O);if(i){t.push(null,{requiredTrees:i})}L.push(t)}}L.sort((function(e,t){return e[1].localeCompare(t[1])}));let D=[Menu.createItem({label:WH.TERMS.links,submenu:L})];W.append(v);W.append(T);W.append($('<div style="clear: left" />'));W.append(_);W.append($("<br/>"));Menu.addButtons(T[0],D);let x=WH.ce("section",{classList:"comment-edit-body-footer",dataset:{hasSubmitButton:JSON.stringify(!!f)}});if(f){let e={type:"submit",classList:"comment-edit-body-footer-submit-button",value:WH.TERMS.save};if(f){e.name=f}let t=WH.ce("section",{classList:"comment-edit-body-footer-submit"},WH.ce("input",e));WH.ae(x,t)}let P=WH.ce("section",{classList:"comment-edit-body-footer-limit"});WH.ae(x,P);W.append(x);if(l===e.EDIT_MODE_USER_SIGNATURE){WH.ae(P,WH.ct(WH.sprintf(WH.TERMS.uptoxcharactersorlines_format,WH.Strings.formatNumber(h),WH.Strings.formatNumber(3))))}else{WH.ae(P,WH.ct(WH.sprintf(WH.TERMS.uptoxcharacters_format,WH.Strings.formatNumber(h))))}let U=WH.Strings.formatNumber(h-o.body.length);let q=WH.sprintf(WH.TERMS.xcharactersremaining_format,U);let F=WH.ce("span",undefined,WH.ct(q));WH.ae(P,F);_.keyup(r.bind(e,_,F,h));_.keydown(r.bind(e,_,F,h));if((l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT)&&g_user.roles&U_GROUP_MODERATOR){var B=$("<div/>",{class:"pad"});var G=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var Y=$("<textarea/>",{val:o.response,rows:3,css:{height:"6em"}});W.append(B);W.append(G);W.append(Y)}a.append(W);a.append(g);return _};this.getCharLimit=function(t){if(t===e.EDIT_MODE_USER_DESCRIPTION){return 7500}if(t===e.EDIT_MODE_USER_SIGNATURE){return 250}if(g_user.roles&U_GROUP_STAFF){return 1e5}var i=WH.User.isPremium()?3:1;switch(t){case e.EDIT_MODE_EDIT_COMMENT:case e.EDIT_MODE_ADD_COMMENT:return 7500*i;case e.EDIT_MODE_EDIT_FORUM_POST:case e.EDIT_MODE_ADD_FORUM_REPLY:return 15e3*i}return 0};this.updateLastEdit=function(e){var t=e.divLastEdit;if(!t){return}if(e.lastEdit!=null){var i=e.lastEdit;t.childNodes[1].firstChild.nodeValue=i[2];t.childNodes[1].href="/user="+i[2];var a=new Date(i[0]);var n=(WH.getServerTime()-a)/1e3;if(t.childNodes[3].firstChild){WH.de(t.childNodes[3].firstChild)}WH.formatDate(t.childNodes[3],n,a);var s="";if(e.rating!=null){s+=WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(a))}if(i[1]>1){s+=WH.TERMS.dash_punct+WH.sprintf(WH.TERMS.editcount_format,i[1])}t.childNodes[4].nodeValue=s;t.style.display=""}else{t.style.display="none"}};this.validate=function(t,i){i|=0;var a=i===e.EDIT_MODE_EDIT_FORUM_POST||i===e.EDIT_MODE_ADD_FORUM_REPLY;if(a){if(WH.trim(t.value).length<1){alert(WH.TERMS.postempty_tip);return false}}else{if(WH.trim(t.value).length<1){alert(WH.TERMS.messagetooshort_tip);return false}}var n=e.getCharLimit(i);if(t.value.length>n){return confirm(WH.sprintf(a?WH.TERMS.postlength_format:WH.TERMS.commentlength_format,n,t.value.substring(n-30,n)))}return true};function a(t,i,a,n){if(t){var s=WH.gE(i.divEdit,"textarea");var r=s[0];if(!e.validate(r,a)){return}if(r.value!=i.body||s[1]&&s[1].value!=i.response){var o=0;if(i.lastEdit!=null){o=i.lastEdit[1]}++o;i.lastEdit=[WH.getServerTime(),o,g_user.name];if(!i.commentv2){e.updateLastEdit(i)}var l=e.getCharLimit(a);var c=WH.markup.rolesToClass(i.roles);var u=WH.markup.getDomFragment(r.value.length>l?r.value.substring(0,l):r.value,{allow:c,mode:WH.markup.MODE.COMMENT,roles:i.roles});var d=s[1]&&s[1].value.length>0?WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+s[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):document.createDocumentFragment();if(i.commentv2){i.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){i.response=s[1].value}Listview.templates.comment.updateCommentCell.call(this,i)}else{if(!n){$(i.divBody).empty().append(u);$(i.divResponse).empty().append(d)}else{i.divBody.empty().append(u);i.divResponse.empty().append(d)}i.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){i.response=s[1].value}}var f={postId:i.id,body:i.body};var h="body="+WH.urlEncode(i.body);if(i.response!==undefined){h+="&response="+WH.urlEncode(i.response);f.response=i.response}if(a===e.EDIT_MODE_EDIT_FORUM_POST){$.ajax({url:"/forums/edit-post",method:"post",data:f})}else{new Ajax(WH.Url.generatePath("/comment=edit&id="+i.id),{method:"POST",params:h})}}}if(i.commentv2){Listview.templates.comment.updateCommentCell.call(this,i)}else if(!n){i.divBody.style.display="";i.divResponse.style.display="";i.divLinks.firstChild.style.display=""}else{i.divBody.show();i.divResponse.show()}if(!i.commentv2){WH.de(i.divEdit);i.divEdit=null}}function n(t,i,a,n){if(n.style.display=="none"){return}var s=e.getCharLimit(i);var r=a.value.length>s?a.value.substring(0,s):a.value;if(i===e.EDIT_MODE_USER_SIGNATURE){var o;if((o=r.indexOf("\n"))!=-1&&(o=r.indexOf("\n",o+1))!=-1&&(o=r.indexOf("\n",o+1))!=-1){r=r.substring(0,o)}}var l=WH.markup.rolesToClass(t.roles);var c=WH.markup.getDomFragment(r,{allow:l,mode:WH.markup.MODE.COMMENT,roles:t.roles});if(c.hasChildNodes()){$(n).empty().append(c)}else{n.innerHTML='<span class="q6">...</span>'}}function s(a,n,s){var r=e.getCharLimit(n);var o=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),(function(e){e.className=""}));this.className="selected";var l=WH.gE(this.parentNode.parentNode,"textarea");var c=l[0];var u=c.parentNode;var d=$(".comment-body",u.parentNode)[0];if(n===e.EDIT_MODE_USER_SIGNATURE){o=WH.markup.MODE.SIGNATURE}switch(a){case t:u.style.display="";d.style.display="none";WH.safeFocus(u.firstChild);break;case i:u.style.display="none";var f=c.value.length>r?c.value.substring(0,r):c.value;if(n===e.EDIT_MODE_USER_SIGNATURE){var h;if((h=f.indexOf("\n"))!=-1&&(h=f.indexOf("\n",h+1))!=-1&&(h=f.indexOf("\n",h+1))!=-1){f=f.substring(0,h)}}var p=WH.markup.rolesToClass(s.roles);var m=WH.markup.getDomFragment(f,{allow:p,mode:o,roles:s.roles});if(l[1]&&l[1].value.length>0){m.appendChild(WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+l[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:o,roles:g_user.roles}))}$(d).empty().append(m);d.style.display="";break}}function r(e,t,i){var a=$(e).val();if(a.length>i){$(e).val(a.substring(0,i))}else{$(t).html(" "+WH.sprintf(WH.TERMS.xcharactersremaining_format,(i-a.length).toLocaleString())).removeClass("q10");if(a.length===i){$(t).addClass("q10")}}}};function co_addYourComment(){tabsContribute.focus(0);var e=WH.gE(document.forms["addcomment"],"textarea")[0];WH.safeFocus(e)}function co_validateForm(e){var t=WH.gE(e,"textarea")[0];var i=false;if(WH.isSet("tabsContribute")){for(var a=0;a<tabsContribute.tabs.length;a++){if(tabsContribute.tabs[a].id=="suggest-a-video"){i=a;break}}}if(i!==false&&t.value.length<350){var n;for(var a in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(a)){continue}if(n=vi_sitevalidation[a].exec(t.value)){break}}if(n&&!confirm(WH.TERMS.commentasvideo_tip)){tabsContribute.show(i);$('#tab-suggest-a-video input[name="videourl"]').attr("value",n[0]);return false}}return WH.Comments.validate(t)}$(document).ready((function(){WH.setupChangeWarning($("form[name=addcomment]"),[$("textarea[name=commentbody]")],WH.TERMS.messagestarted_tip)}));WH.Cookies=new function(){const e=this;this.available=function(){if(!t()){return false}return i()};this.getDomain=function(){return WH.Url.getHost("cookies").replace(/^cookies\./,"")};function t(){if(typeof window.OptanonActiveGroups!=="string"){return true}return window.OptanonActiveGroups.split(",").indexOf("C0001")!==-1}function i(){WH.setCookie("enabledTest",1,"1",undefined,undefined,location.protocol==="https:");let e=WH.getCookies("enabledTest")==="1";if(e){WH.deleteCookie("enabledTest",undefined,undefined,location.protocol==="https:")}i=function(){return e};return e}};WH.D2={};WH.DI.getPlayerLevelMax=function(){return 60};var Dialog=function(){var e=this,t,i=null,a,n={},s,r=false,o=WH.ce("form"),l={};o.onsubmit=function(){p();return false};this.show=function(l,u){if(l){a=l;t=WH.cOr({},Dialog.templates[a]);e.template=t}else return;if(t.onInit&&!r)t.onInit.bind(e,o,u)();if(u.onBeforeShow)n.onBeforeShow=u.onBeforeShow.bind(e,o);if(t.onBeforeShow)t.onBeforeShow=t.onBeforeShow.bind(e,o);if(u.onShow)n.onShow=u.onShow.bind(e,o);if(t.onShow)t.onShow=t.onShow.bind(e,o);if(u.onHide)n.onHide=u.onHide.bind(e,o);if(t.onHide)t.onHide=t.onHide.bind(e,o);if(u.onSubmit)n.onSubmit=u.onSubmit;if(t.onSubmit)i=t.onSubmit.bind(e,o);if(u.data){r=false;s={};WH.cO(s,u.data)}e.data=s;Lightbox.show("dialog-"+a,{onShow:c,onHide:h})};this.getValue=function(e){return H(e)};this.setValue=function(e,t){g(e,t)};this.getSelectedValue=function(e){return W(e)};this.getCheckedValue=function(e){return v(e)};function c(e,i){if(i||!r)d(e);if(t.onBeforeShow)t.onBeforeShow();if(n.onBeforeShow)n.onBeforeShow();Lightbox.setSize(t.width);e.className+=" dialog";f();if(t.onShow)t.onShow();if(n.onShow)n.onShow();window.setTimeout(u,5)}function u(){for(var e=0,i,a;i=t.fields[e];e++){if(WH.inArray(["text","number"],i.type)>=0){l[i.id].focus();break}}}function d(i){WH.ee(i);WH.ee(o);var a=WH.ce("div");a.className="lightbox-content text";WH.ae(i,a);WH.ae(a,o);if(t.title){WH.ae(o,WH.getImitationHeading(WH.ct(t.title),1))}var n=WH.ce("table"),c=WH.ce("tbody"),u=false;var d;var f;var h;WH.ae(n,c);WH.ae(o,n);for(var m=0,H=t.fields.length;m<H;++m){var g=t.fields[m],W;if(!u){d=WH.ce("tr");f=WH.ce("th");h=WH.ce("td")}g.__tr=d;if(s[g.id]==null)s[g.id]=g.value?g.value:"";var v;if(g.options){v=[];if(g.optorder)WH.cO(v,g.optorder);else{for(var T in g.options)v.push(T)}if(g.sort)v.sort((function(e,t){return g.sort*WH.stringCompare(g.options[e],g.options[t])}))}switch(g.type){case"caption":f.colSpan=2;f.style.textAlign="left";f.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,f,d)();else if(g.label)WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);continue;break;case"textarea":var _=W=WH.ce("textarea");_.name=g.id;if(g.disabled)_.disabled=true;_.rows=g.size[0];_.cols=g.size[1];h.colSpan=2;if(g.label){f.colSpan=2;f.style.textAlign="left";f.style.padding=0;h.style.padding=0;WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);d=WH.ce("tr")}if(g.maxLength){_.maxLength=g.maxLength}WH.ae(h,_);break;case"select":var _=W=WH.ce("select");_.name=g.id;if(g.size)_.size=g.size;if(g.disabled)_.disabled=true;if(g.multiple)_.multiple=true;if(g.onchange){_.onchange=g.onchange.bind(e,_)}for(var T=0,E=v.length;T<E;++T){var b=WH.ce("option");b.value=v[T];WH.ae(b,WH.ct(g.options[v[T]]));WH.ae(_,b)}WH.ae(h,_);break;case"dynamic":h.colSpan=2;h.style.textAlign="left";h.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,h,d)();WH.ae(d,h);WH.ae(c,d);W=h;break;case"checkbox":case"radio":var y=0;W=[];for(var T=0,E=v.length;T<E;++T){var S=WH.ce("span"),_,I,w="sdfler46"+g.id+"-"+v[T];if(T>0&&!g.noInputBr)WH.ae(h,WH.ce("br"));I=WH.ce("label");I.setAttribute("for",w);I.onmousedown=WH.rf;_=WH.ce("input");_.setAttribute("type",g.type);_.name=g.id;_.value=v[T];_.id=w;if(g.disabled)_.disabled=true;if(g.onchange){_.onchange=g.onchange.bind(e,_)}if(g.submitOnDblClick)I.ondblclick=_.ondblclick=function(e){p()};if(g.compute)g.compute.bind(e,_,s[g.id],o,h,d,I)();WH.ae(I,_);WH.ae(I,WH.ct(g.options[v[T]]));WH.ae(h,I);W.push(_)}break;default:var _=W=WH.ce("input");_.name=g.id;if(g.size)_.size=g.size;if(g.disabled)_.disabled=true;if(g.submitOnEnter){_.onkeypress=function(e){if(e.keyCode===13){p()}}}_.setAttribute("type",g.type);WH.ae(h,_);break}if(g.label){if(g.type=="textarea"){if(g.labelAlign)h.style.textAlign=g.labelAlign;h.colSpan=2}else{if(g.labelAlign)f.style.textAlign=g.labelAlign;WH.ae(f,WH.ct(g.label));WH.ae(d,f)}}if(g.placeholder){_.placeholder=g.placeholder}if(g.type!="checkbox"&&g.type!="radio"){if(g.width)_.style.width=g.width;if(g.compute&&g.type!="caption"&&g.type!="dynamic")g.compute.bind(e,_,s[g.id],o,h,d)()}if(g.caption){var S=WH.ce("small");if(g.type!="textarea")S.style.paddingLeft="2px";WH.ae(S,WH.ct(g.caption));WH.ae(h,S)}if(g.style&&typeof _!=="undefined"){for(var N in g.style){_.style[N]=g.style[N]}}WH.ae(d,h);WH.ae(c,d);u=g.mergeCell;l[g.id]=W}var R={arrow:"external-link",check:"check",question:"question",x:"times"};for(var m=t.buttons.length;m>0;--m){var M=t.buttons[m-1],A=WH.ce("a");A.onclick=p.bind(A,M[0]);A.className="dialog-option fa fa-"+(R[M[0]]||"circle fa-size-xs");A.href="javascript:";WH.ae(A,WH.ct(M[1]));WH.ae(i,A)}r=true}function f(){for(var i=0,a=t.fields.length;i<a;++i){var n=t.fields[i],r=l[n.id];switch(n.type){case"caption":break;case"select":for(let e=0,t=r.options.length;e<t;e++){r.options[e].selected=r.options[e].value==s[n.id]||s[n.id]instanceof Array&&WH.inArray(s[n.id],r.options[e].value)!==-1}break;case"checkbox":case"radio":for(let e=0,t=r.length;e<t;e++){r[e].checked=r[e].value==s[n.id]||Array.isArray(s[n.id])&&WH.inArray(s[n.id],r[e].value)!=-1}break;default:r.value=s[n.id];break}if(n.update)n.update.bind(e,null,s[n.id],o,r)()}}function h(){if(t.onHide)t.onHide();if(n.onHide)n.onHide()}function p(e){if(e=="x")return Lightbox.hide();for(var i=0,a=t.fields.length;i<a;++i){var n=t.fields[i],r;switch(n.type){case"caption":continue;case"select":r=W(n.id);break;case"checkbox":case"radio":r=v(n.id);break;case"dynamic":if(n.getValue){r=n.getValue(n,s,o);break}default:r=H(n.id);break}if(n.validate){if(!n.validate(r,s,o))return}if(r&&typeof r=="string")r=WH.trim(r);s[n.id]=r}m(e)}function m(e){var t;if(i)t=i(s,e,o);if(n.onSubmit)t=n.onSubmit(s,e,o);if(t===undefined||t)Lightbox.hide();return false}function H(e){return l[e].value}function g(e,t){l[e].value=t}function W(e){var t=[],i=l[e];for(var a=0,n=i.options.length;a<n;a++){if(i.options[a].selected)t.push(parseInt(i.options[a].value)==i.options[a].value?parseInt(i.options[a].value):i.options[a].value)}if(t.length==1)t=t[0];return t}function v(e){var t=[],i=l[e];for(var a=0,n=i.length;a<n;a++){if(i[a].checked)t.push(parseInt(i[a].value)==i[a].value?parseInt(i[a].value):i[a].value)}return t}};Dialog.prompt=function(e,t){let i=new Dialog;t=t||{};i.show("prompt",{promptOptions:{callback:e,caption:t.caption,initial:t.initial,label:t.label,placeholder:t.placeholder,size:t.size,text:t.text,title:t.title}})};Dialog.templates={prompt:{buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"topText",type:"caption"},{id:"inputField",type:"text",size:40,submitOnEnter:true}],onInit:function(e,t){this.template.title=t.promptOptions.title;this.template.fields[0].label=t.promptOptions.text||"";this.template.fields[1].label=t.promptOptions.label||"";this.template.fields[1].caption=t.promptOptions.caption||"";this.template.fields[1].placeholder=t.promptOptions.placeholder||"";let i=parseInt(t.promptOptions.size);if(i){this.template.fields[1].size=i}let a=t.promptOptions.callback;this.template.onSubmit=e=>a(e.inputField.value);t.data={};if(t.promptOptions.initial!=null){t.data.inputField=t.promptOptions.initial}delete t.promptOptions},onShow:function(e){setTimeout((()=>e.inputField.focus()),50);setTimeout(Lightbox.reveal,100)}}};Dialog.extraFields={};WH.DOM=new function(){const e=this;const t={lazyCssObserver:undefined,nodeData:new WeakMap};this.addScriptOnce=function(e,t){if(WH.qs('script[src="'+e+'"]')){return}t=t||{};t.src=e;let i=WH.ce("script",t);WH.ae(document.head,i);return i};this.getColorFilter=function(e,t,i){let a=["svg-color-filter",Math.floor(e*1e3),Math.floor(t*1e3),Math.floor(i*1e3)].join("-");if(!WH.qs("svg filter#"+a)){let n=e=>document.createElementNS("http://www.w3.org/2000/svg",e);let s=n("svg");let r=n("defs");let o=n("filter");let l=n("feColorMatrix");WH.ae(s,r);WH.ae(r,o);WH.ae(o,l);o.setAttribute("id",a);o.setAttribute("color-interpolation-filters","sRGB");l.setAttribute("type","matrix");l.setAttribute("values","0 0 0 0 "+e+" 0 0 0 0 "+t+" 0 0 0 0 "+i+" 0 0 0 1 0");WH.ae(document.body,s)}return"url(#"+a+")"};this.createImitationSelect=function(t){t=t||{};let n=WH.ce("a",{className:"imitation-select",dataset:{fieldFilled:"true"},href:"javascript:",tabIndex:0},WH.ct(t.text||""));if(t.native){n.dataset.native=1;Menu.add(n,i.bind(e,n),{showAtElement:true});WH.ae(n,WH.ce("span",{className:"imitation-select-width"}));let t=new MutationObserver(a.bind(e,n));t.observe(n,{childList:true,subtree:true,characterData:true});let s=0;Object.defineProperty(n,"selectedIndex",{get:function(){return s},set:function(e){let t=WH.qsa("option",n);s=parseInt(e);if(isNaN(s)){s=0}s=Math.max(s,0);if(t.length===0){s=0;WH.ee(n);n.style.backgroundImage="";delete n.dataset.icon;return}s=Math.min(t.length-1,s);WH.st(n,t[s].label);let i=t[s].dataset.tinyIcon;if(i){n.dataset.icon=i;n.style.backgroundImage='url("'+WH.Icon.getIconUrl(i,WH.Icon.MEDIUM)+'")'}else{n.style.backgroundImage="";delete n.dataset.icon}}});Object.defineProperty(n,"options",{get:function(){return WH.qsa("option",n)}})}else if(t.menu){Menu.add(n,t.menu,{showAtElement:true})}return n};this.dispatchEvent=function(e,t){e.dispatchEvent(new Event(t))};this.enableEvents=function(e){if(e.addEventListener){throw new Error("Object already has events enabled.")}let t=new EventTarget;["addEventListener","dispatchEvent","removeEventListener"].forEach((i=>e[i]=t[i].bind(t)))};this.getData=function(e,i){return(t.nodeData.get(e)||{})[i]};this.getInnerHeight=function(e){return parseFloat(getComputedStyle(e,null).height.replace("px",""))};this.getInnerWidth=function(e){return parseFloat(getComputedStyle(e,null).width.replace("px",""))};this.lazyLoadBackground=function(e){if(!t.lazyCssObserver){return}if(!e.style.backgroundImage){WH.warn("Element does not have a background image to lazy-load.",e);return}e.classList.add("lazy-load-background");t.lazyCssObserver.observe(e)};this.isEmpty=function(e){for(let t=0,i;i=e.childNodes[t];t++){if(i.nodeType===Node.ELEMENT_NODE||i.nodeType===Node.TEXT_NODE&&i.textContent.trim()){return false}}return true};this.isVisible=function(e){return!(e.offsetWidth===0&&e.offsetHeight===0)};this.setData=function(e,i,a){let n=t.nodeData.get(e);if(!n){n={};t.nodeData.set(e,n)}n[i]=a};this.setLoading=function(e,t){e.dataset.loading=t?"true":"false"};this.setRelativeHeight=function(e,t,i){e.style.paddingTop=i/t*100+"%"};this.setTemporaryIcon=function(e,t,i){if(i){e.classList.remove("fa-"+i)}else{e.classList.add("fa")}e.classList.add("fa-"+t);clearTimeout(e.temporaryIconTimer);e.temporaryIconTimer=setTimeout((function(){e.classList.remove("fa-"+t);if(i){e.classList.add("fa-"+i)}else{e.classList.remove("fa")}}),2500)};this.styleRangeElement=function(e){if(!e.style.setProperty){return}let t=function(){e.style.setProperty("--min",e.min);e.style.setProperty("--max",e.max);e.style.setProperty("--val",e.value)};WH.aE(e,"input",t);let i=Object.getPrototypeOf(e);["value","min","max"].forEach((function(a){let n=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(e,a,{get:function(){return n.get.apply(this,arguments)},set:function(){n.set.apply(this,arguments);t();return this[a]}})}));t()};function i(e){let t=[];let i;let a;let n=0;WH.qsa("option, optgroup",e).forEach((function(s){if(s.nodeName==="OPTGROUP"){i=s;a=[];t.push(Menu.createItem({label:s.label,submenu:a,options:{checkedFunc:function(t){return t[Menu.ITEM_SUBMENU].some((function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}))}}}));return}if(n===0&&!s.label){n++;return}if(i&&s.parentNode!==i){a=undefined;i=undefined}let r={checkedFunc:function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}};if(s.dataset.tinyIcon){r.tinyIcon=s.dataset.tinyIcon}if(s.className){r.className=s.className}(a||t).push(Menu.createItem({crumb:n,label:s.dataset.menuLabel||s.label,url:function(t){e.selectedIndex=t;e.dispatchEvent(new Event("change"))}.bind(null,n),options:r}));n++}));return t}function a(e,t){let i=false;let a=WH.qs(".imitation-select-width",e);if(!a){WH.ae(e,a=WH.ce("span",{className:"imitation-select-width"}));i=true}for(let a,n=0;a=t[n];n++){let t=a.type==="characterData"?a.target.parentNode:a.target;if(t.nodeName!=="OPTION"&&t.nodeName!=="OPTGROUP"){continue}WH.qsa("option",e).forEach((function(t,a){if(t.label){i=true}if(t.selected){e.selectedIndex=a}}));break}if(i){WH.ee(a);WH.qsa("option",e).forEach((function(e,t){if(e.label){WH.ae(a,WH.ct(e.label));WH.ae(a,WH.ce("br"))}}))}}function n(){s();WH.aE(document,"selectstart",(function(e){let t=e.target;while(t){if(t.nodeName==="LABEL"||t.dataset&&t.dataset.preventSelectStart==="true"){e.preventDefault();break}t=t.parentNode}}));WH.onLoad(r)}function s(){if(!document.body){WH.aE(document,"bodyAvailable",s);return}let e=e=>{switch(e.nodeName){case"DATALIST":case"INPUT":case"TEXTAREA":WH.aE(e,["change","click","keydown","keyup"],o);o.call(e);break;case"SELECT":WH.aE(e,["change","click","keydown","keyup"],l);l.call(e)}};WH.onMutate(document.body,(function(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){e(t);if(t.childNodes){t.querySelectorAll("datalist, input, textarea, select").forEach(e)}}}))}))}));WH.qsa("datalist, input, textarea, select").forEach(e)}function r(){if(document.body.dataset.lazyLoading){return}if(typeof IntersectionObserver==="undefined"){WH.qsa(".lazy-load-background").forEach((function(e){e.classList.remove("lazy-load-background")}));document.body.dataset.lazyLoading="disabled";return}t.lazyCssObserver=new IntersectionObserver((function(e){let i=[];e.forEach((function(e){if(!e.isIntersecting||i.includes(e.target)){return}i.push(e.target);e.target.classList.remove("lazy-load-background");t.lazyCssObserver.unobserve(e.target)}))}));WH.qsa('[style*="url("]').forEach((function(e){if(e.style.backgroundImage){e.classList.add("lazy-load-background")}}));WH.qsa(".lazy-load-background").forEach((function(e){t.lazyCssObserver.observe(e)}));document.body.dataset.lazyLoading="ready"}function o(){this.dataset.fieldFilled=(this.value||"").trim()?"true":"false"}function l(){this.dataset.fieldFilled=(this.value||"").trim()&&(this.options[this.selectedIndex].text||"").trim()?"true":"false"}n()};WH.addCss=function(e){WH.ae(document.head,WH.ce("style",{type:"text/css"},WH.ct(e)))};WH.setTextNodes=function(e,t){if(e.nodeType==3){e.nodeValue=t}else{for(var i=0;i<e.childNodes.length;++i){WH.setTextNodes(e.childNodes[i],t)}}};WH.getFirstTextContent=function(e){for(var t=0;t<e.childNodes.length;++t){if(e.childNodes[t].nodeName=="#text"){return e.childNodes[t].nodeValue}var i=WH.getFirstTextContent(e.childNodes[t]);if(i){return i}}return false};WH.getTextContent=function(e){var t="";for(var i=0;i<e.childNodes.length;++i){if(e.childNodes[i].nodeValue){t+=e.childNodes[i].nodeValue}else if(e.childNodes[i].nodeName=="BR"){t+="\n"}t+=WH.getTextContent(e.childNodes[i])}return t};WH.toggleDisplay=function(e,t){var i=$(e);var a=i.is(":visible");if(t){i.slideToggle(150)}else{i.toggle()}if(!a){WH.Tools.Bloodmallet.updateChartsSizes(e)}return!a};WH.preventScroll=function(e,t){if(e){if(typeof t==="string"){t=WH.qs(t)}WH.preventScroll.allowedScrollArea=t;WH.aE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.aE(document.body,"touchmove",WH.preventScroll.cancelScroll)}else{WH.dE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.dE(document.body,"touchmove",WH.preventScroll.cancelScroll)}};WH.preventScroll.cancelScroll=function(e){if(WH.preventScroll.allowedScrollArea&&WH.preventScroll.allowedScrollArea.contains(e.target)){return}e.preventDefault();e.stopPropagation()};WH.safeFocus=function(e){if(!WH.Device.isTouch()){$(e).focus()}};WH.safeSelect=function(e){if(!WH.Device.isTouch()){$(e).select()}};WH.setCaretPosition=function(e,t){if(!e){return}if(e.createTextRange){var i=e.createTextRange();i.move("character",t);i.select()}else if(e.selectionStart!=undefined){e.focus();e.setSelectionRange(t,t)}else{e.focus()}};WH.insertTag=function(e,t,i,a){if(i==null){i=""}var n=WH.ge(e);n.focus();if(n.selectionStart!=null){var s=n.selectionStart,r=n.selectionEnd,o=n.scrollLeft,l=n.scrollTop;var c=n.value.substring(s,r);if(typeof a==="function"){c=a(c)}n.value=n.value.substr(0,s)+t+c+i+n.value.substr(r);n.selectionStart=n.selectionEnd=r+t.length;n.scrollLeft=o;n.scrollTop=l}else if(document.selection&&document.selection.createRange){var u=document.selection.createRange();if(u.parentElement()!=n){return}var c=u.text;if(typeof a==="function"){c=a(c)}u.text=t+c+i}if(n.onkeyup)n.onkeyup()};WH.onAfterTyping=function(e,t,i){let a;WH.aE(e,"keyup",(function(){if(a){clearTimeout(a)}a=setTimeout(t,i)}))};WH.isLeftClick=function(e){return!!(e&&e.button===0)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var e={},t={},i,a;function n(t){if(this._handle){let e=t.target;let i=false;let a=0;while(e&&a<=3){if(e==this._handle){i=true;break}e=e.parentNode;a++}if(!i){return false}}i=this;e=WH.getCursorPos(t);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);if(i.onClick){i.onClick(t,i)}return false}function s(n){var s=WH.getCursorPos(n);if(i){if(Math.abs(s.x-e.x)>5||Math.abs(s.y-e.y)>5){o(n,i);i=null}}if(!a||!a._bounds)return false;var r=d(a),l=s.x-e.x,u=s.y-e.y;l=Math.max(a._bounds.x1-t.x,Math.min(a._bounds.x2-t.x-(r.x2-r.x1),l));u=Math.max(a._bounds.y1-t.y,Math.min(a._bounds.y2-t.y-(r.y2-r.y1),u));c(l,u);return false}function r(e){i=null;if(a)l(e)}function o(e,i){if(a)l(e);var n=WH.ac(i);t.x=n[0];t.y=n[1];if(i._targets.length){a=i.cloneNode(true);a._orig=i;WH.ae(document.body,a);c(-2323,-2323)}else a=i;WH.Tooltip.disabled=true;WH.Tooltip.hide();if(i.onDrag)i.onDrag(e,a,i);a._bounds=d(i._container);a.className+=" dragged"}function l(e){var t=false,i=WH.getCursorPos(e);if(a._orig&&a._orig._targets.length){u();var n={x1:a._x,x2:a._x+parseInt(a.offsetWidth),y1:a._y,y2:a._y+parseInt(a.offsetHeight)};WH.de(a);a=a._orig;for(var o=0,l=a._targets.length;o<l;++o){var c=a._targets[o],f=d(c);if(n.x2>=f.x1&&n.x1<f.x2&&n.y2>=f.y1&&n.y1<f.y2){t=true;if(a.onDrop)a.onDrop(e,a,c,i.x>=f.x1&&i.x<=f.x2&&i.y>=f.y1&&i.y<=f.y2);else WH.ae(c,a)}}}if(!t&&a.onDrop)a.onDrop(e,a,null);WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);WH.Tooltip.disabled=false;a.className=a.className.replace(/dragged/,"");a=null}function c(e,i){a.style.position="absolute";a.style.left=t.x+e+"px";a.style.top=t.y+i+"px";a._x=t.x+e;a._y=t.y+i}function u(){a.style.left="-2323px";a.style.top="-2323px"}function d(e){var t=WH.ac(e);return{x1:t[0],x2:t[0]+parseInt(e.offsetWidth),y1:t[1],y2:t[1]+parseInt(e.offsetHeight)}}this.init=function(e,t){e.onmousedown=n;if(!e._targets)e._targets=[];if(!e._container)e._container=document.body;if(t!=null){if(t.targets){for(var i=0,a=t.targets.length;i<a;++i)e._targets.push(WH.ge(t.targets[i]))}if(t.container)e._container=WH.ge(t.container);if(t.onClick)e.onClick=t.onClick;if(t.onDrop)e.onDrop=t.onDrop;if(t.onDrag)e.onDrag=t.onDrag}}};WH.DynamicFixedElement=new function(){const e={elements:{}};this.checkAll=function(){for(let i in e.elements){if(e.elements.hasOwnProperty(i)){t(i,true)}}};this.init=function(i,a,n){n=n||{};if(typeof a==="string"){a=WH.qs(a)}if(!a||a.nodeType!==Node.ELEMENT_NODE){WH.error("Could not find element to set up a dynamic fixed position.",i,a,n);return}if(a.dataset.dynamicFixedElementInitialized){WH.error("Element is already set up for a dynamic fixed position.",i,a,n);return}let s=["left","right"].includes(n.side)?n.side:"right";let r=getComputedStyle(a);e.elements[i]={checkCallback:n.checkCallback,defaultSide:parseInt(r.getPropertyValue(s))||0,defaultTop:parseInt(r.getPropertyValue("top"))||0,element:a,fixed:false,minWidth:n.minWidth,offset:false,parent:a.parentNode,side:s};WH.aE(window,"scroll",t.bind(null,i));WH.aE(window,"resize",t.bind(null,i,true));t(i);a.dataset.dynamicFixedElementInitialized="true"};function t(t,r){let o=e.elements[t];if(o.minWidth&&window.innerWidth<o.minWidth){i(t);a(t);return}let l=o.parent.getBoundingClientRect();let c=10;if(WH.Layout.Responsive.isZulInMobileMode()){c+=40}else{let e=WH.Layout.getElement("header-wrapper");if(e){c+=e.getBoundingClientRect().height}}if(l.top<c-o.defaultTop){let e=(o.parent.offsetHeight||0)-(o.element.offsetHeight||0);let u=l.top*-1+c;if(u<e){a(t);n(t,c,r)}else{i(t);e=(o.parent.offsetHeight||0)-(o.element.offsetHeight||0);s(t,Math.min(u,e),r)}}else{i(t);a(t)}if(o.checkCallback){o.checkCallback(o)}}function i(t){let i=e.elements[t];if(i.fixed){i.element.classList.remove("fixed-"+t,"scrollable-"+t);i.element.style[i.side]=null;i.element.style.top=null;i.fixed=false}}function a(t){let i=e.elements[t];if(i.offset){i.element.style.marginTop=null;i.offset=false}}function n(t,i,n){let s=e.elements[t];let r=WH.getOffset(s.parent);if(!s.fixed||n===true){a(t);let e=s.side==="left"?r.left+s.defaultSide:document.documentElement.getBoundingClientRect().width-r.left-s.parent.offsetWidth+s.defaultSide;s.element.classList.add("fixed-"+t);s.element.style[s.side]=e+"px";s.element.style.top=i+"px";if(s.element.offsetHeight+10+i>window.innerHeight){s.element.classList.add("scrollable-"+t)}s.fixed=true}}function s(t,i,a){let n=e.elements[t];if(!n.offset||a===true){n.element.style.marginTop=i-n.defaultTop+"px";n.offset=true}}};WH.Entity=new function(){const e=this;const t=WH.Icon;var i=[WH.Types.ADVENTURE_COMBATANT_ABILITY,WH.Types.AZERITE_ESSENCE,WH.Types.AZERITE_ESSENCE_POWER,WH.Types.GEAR_SET,WH.Types.RESOURCE,WH.Types.STORYLINE,WH.Types.DI_EQUIP_ITEM,WH.Types.DI_MISC_ITEM,WH.Types.DI_NPC,WH.Types.DI_OBJECT,WH.Types.DI_PARAGON_SKILL,WH.Types.DI_QUEST,WH.Types.DI_SET,WH.Types.DI_SKILL,WH.Types.DI_ZONE];this.createIcon=function(i,a,n){n=n||{};let s=n.url===undefined?e.getUrl(a,n.id||i.id,i.name):n.url;delete n.id;delete n.url;return t.createByEntity(i,a,s,n)};this.getLink=function(t,i){let a=WH.Gatherer.getName(t,i);let n=WH.ce("a",{href:WH.Entity.getUrl(t,i,a||false)},WH.ct(a||e.getUnknownName(t,i)));let s=WH.Gatherer.get(t,i);if(s){if(s.icon){n.classList.add("icontinyl");n.style.backgroundImage="url("+WH.Icon.getIconUrl(s.icon,WH.Icon.TINY)+")"}if(s.quality!=null&&s.quality!==-1){n.classList.add("q"+s.quality)}}return n};this.getPlaceholderName=function(e,t){return WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+t+WH.TERMS.closedparenthesis_punct};this.getUnknownName=function(e,t){return WH.term("unknownEntityName_format",WH.Types.getUpperSingular(e),t)};this.getUrl=function(e,t,i,a,n,r){let o=s(e,t,i,a);if(WH.Types.existsInDataEnv(e,n)){return WH.Url.generate(o,{dataEnv:n,locale:r})}let l=WH.Types.getRequiredTrees(e);if(l&&l.length){return WH.Url.generate(o,{dataEnv:WH.getRootByTree(l[0]),locale:r})}return WH.Url.generate(o,{dataEnv:n,locale:r})};this.isReference=function(e){return/^[a-z-]+=-?\d+$/.test(e)};function a(e,t,i){var a="/"+WH.Types.getDetailPageName(e)+"="+t;if(!i&&i!==false){i=WH.Gatherer.getName(e,t)}if(i){a+="/"+WH.Strings.slug(i,true)}return a}function n(e,t,i){var a="/"+WH.Types.getDetailPageName(e)+"/";if(!i&&i!==false){i=WH.Gatherer.getName(e,t)}if(i){a+=WH.Strings.slug(i,true)+"-"+t}else{a+=t}return a}function s(e,t,s,r){let o;let l;switch(e){case WH.Types.PLAYER_CLASS:l=WH.Wow.PlayerClass.getSlug(t);break;case WH.Types.RACE:l=WH.Wow.Race.getSlug(t);break}if(l){o="/"+l}else if(i.indexOf(e)!==-1){o=n(e,t,s)}else{o=a(e,t,s)}if(typeof r==="string"){if(r!==""){o+="?"+r}}else if(r&&typeof r==="object"){r=WH.Url.buildQuery(r);if(r){o+="?"+r}}return o}};var Facebook={getCurrentOpenGraphUrl:function(){return $("head meta[property='og:url']").attr("content")},createLikeButton:function(e,t){if(!t)t={};var i,a,n;if(t.simple){a=90;n=21;i="button_count"}else{a=400;n=23;i="standard"}return $("<iframe/>",{src:"//www.facebook.com/plugins/like.php?href="+WH.urlEncode(e)+"&locale=en_US&layout="+i+"&show_faces=false&action=like&font=arial&colorscheme=dark&width="+a+"&height="+n,scrolling:"no",frameborder:"0",allowtransparency:"true",css:{border:"none",overflow:"hidden",width:a+"px",height:n+"px",display:"none"}}).on("load",(function(){$(this).show()}))}};WH.Favorites=new function(){const e=this;const t={favorites:null,pageType:null,pageId:null,pageStar:null};this.pageInit=function(e,i,a){if(typeof e==="string"){e=WH.qs(e)}if(!e||typeof i!=="number"||typeof a!=="number"){return}t.pageType=i;t.pageId=a;u(e)};this.hasFavorites=function(){return t.favorites.length>0};this.getMenu=function(){o();let e=[];let i=0;let a=0;for(let n=0;n<t.favorites.length;n++){let s=t.favorites[n];if(!s.entities.length){continue}i++;let r=[];for(let e=0;e<s.entities.length;e++){let t=s.entities[e];let i=t[2]||WH.Entity.getUrl(s.id,t[0]);r.push([t[0],t[1],i]);a++}Menu.sort(r);e.push(Menu.createItem({crumb:s.id,label:WH.Types.getUpperPlural(s.id),submenu:r}))}Menu.sort(e);if(i===1&&a<=45||i===2&&i+a<=30||i>2&&i+a<=15){let t=[];for(let i=0;i<e.length;i++){let a=e[i];t.push([undefined,a[Menu.ITEM_LABEL]]);let n=Menu.getSubmenu(a);for(let e=0;e<n.length;e++){let i=n[e];let a=[i[Menu.ITEM_CRUMB],i[Menu.ITEM_LABEL],i[Menu.ITEM_URL]];if(i[Menu.ITEM_OPTIONS]){a[Menu.ITEM_OPTIONS]=i[Menu.ITEM_OPTIONS]}t.push(a)}}e=t}if(e.length&&WH.Theme.isStandardType()){e.unshift([0,WH.TERMS.favorites,null,null,{heading:true}])}return e};this.refreshMenu=function(){let t=WH.qs(".header-user-favorites");if(!t){return}let i=e.getMenu();if(!i.length){t.style.display="none";return}Menu.add(t,i,{padded:true});t.style.display=""};function i(i,n,s,o){let l=r(i,true);if(l===-1){return}let u=t.favorites[l].entities;for(let e=0;e<u.length;e++){if(!o&&u[e][0]===n){alert(WH.TERMS.entityalreadyfavorited_format.replace("%s",WH.Types.getLowerSingular(i)));return}}t.favorites[l].entities.push([n,s]);e.refreshMenu();if(!o){a("add",i,n,c.bind(null,i,n,s,true))}}function a(e,t,i,a){WH.fetch("/account/favorites",{method:"POST",json:{action:e,type:t,id:i,_csrf:g_user.sessionKey},error:function(n,s,r){a();WH.error("Error executing favorites action:",e,t,i,s,r);f(t,i)}})}function n(){let e=typeof g_pageInfo==="object"&&typeof g_pageInfo.type==="number"&&typeof g_pageInfo.typeId==="number"?WH.qs("#main-contents .heading-size-1"):null;if(!e){if(document.readyState!=="complete"){setTimeout(n,9)}return}o();t.pageType=g_pageInfo.type;t.pageId=g_pageInfo.typeId;u(e)}function s(e){for(let i=0;i<t.favorites.length;i++){if(t.favorites[i].id===e){return i}}return null}function r(e,i){let a=s(e);if(a!==null){return a}if(!i){return-1}t.favorites.push({id:e,entities:[]});t.favorites.sort((function(e,t){return WH.stringCompare(WH.Types.getUpperPlural(e.id),WH.Types.getUpperPlural(t.id))}));return s(e)}function o(){if(t.favorites===null){t.favorites=WH.getPageData("user.favorites")||[]}}function l(e,i){let a=r(e);if(a===-1){return false}let n=t.favorites[a].entities;for(let e=0;e<n.length;e++){if(n[e][0]===i){return true}}return false}function c(n,s,o,l){let c=r(n);if(c===-1){return}let u=t.favorites[c].entities;for(let r=0;r<u.length;r++){let d=u[r];if(d[0]===s){u.splice(r,1);if(!u.length){t.favorites.splice(c,1)}e.refreshMenu();if(!l){a("remove",n,s,i.bind(null,n,s,o,true))}break}}}function u(e){t.pageStar=WH.ce("span",{className:"fa fav-star"});WH.ae(e,t.pageStar);if(WH.userIsLoggedIn()&&g_user.sessionKey){t.pageStar.classList.add("fa-star"+(l(t.pageType,t.pageId)?"":"-o"));WH.aE(t.pageStar,"click",function(e,t,i){d(e,t,i);f(e,t);WH.Tooltip.hide()}.bind(null,t.pageType,t.pageId,e.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltip.simpleNonTouch(t.pageStar,(function(){let e=this.classList.contains("fa-star-o")?WH.TERMS.addtofavorites:WH.TERMS.removefromfavorites;return'<div class="no-wrap">'+e+"</div>"}),"q2")}else{t.pageStar.classList.add("fa-star-o");WH.aE(t.pageStar,"click",(function(){WH.goToLoginPage()}));WH.Tooltip.simpleNonTouch(t.pageStar,WH.TERMS.logintosavefavorites_tip+'<div class="q2" style="margin-top:10px">'+WH.TERMS.clicktologin_stc+"</div>")}}function d(e,t,a){if(l(e,t)){c(e,t,a)}else{i(e,t,a)}}function f(e,i){if(!t.pageStar){return}let a="fa-star-o";let n="fa-star";if(!l(e,i)){a="fa-star";n="fa-star-o"}t.pageStar.classList.remove(a);t.pageStar.classList.add(n)}n()};var ContactTool=new function(){const e=this;this.MODE_COMMENT=1;this.MODE_POST=2;const t=10;const i=1e5;const a=1e3;this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var n;var s={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[16,true],[18,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[19,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[20,function(e){return(e.roles&U_GROUP_MODERATOR)==0}]],2:[[30,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[37,function(e){return(e.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&g_users[e.user].avatar==2}],[31,true],[32,true],[33,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[34,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&e.op&&!e.sticky}],[35,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[36,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],3:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],5:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],6:[[45,true],[46,true],[48,true]]};var r={1:WH.TERMS.captchaerror_tip,2:WH.TERMS.shortdescription_tip,3:WH.TERMS.contactreason_tip,7:WH.TERMS.alreadyreported_tip};var o=null;this.displayError=function(e,t){alert(t)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){o=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(o&&(o.indexOf("screenshots:")==-1||o.indexOf("videos:")==-1)){WH.setHash(o)}else{WH.clearHash()}};this.onSubmit=function(e,t,i){if(e.submitting){return false}for(var a=0;a<i.elements.length;++a){i.elements[a].disabled=true}var n=["contact=1","mode="+WH.urlEncode(e.mode),"reason="+WH.urlEncode(e.reason),"desc="+WH.urlEncode(e.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(e.currenturl)];if(e.mode==0){if(e.relatedurl){n.push("relatedurl="+WH.urlEncode(e.relatedurl))}if(e.email){n.push("email="+WH.urlEncode(e.email))}}else if(e.mode==1){n.push("id="+WH.urlEncode(e.comment.id))}else if(e.mode==2){n.push("id="+WH.urlEncode(e.post.id))}else if(e.mode==3){n.push("id="+WH.urlEncode(e.screenshot.id))}else if(e.mode==5){n.push("id="+WH.urlEncode(e.video.id))}else if(e.mode==6){n.push("id="+WH.urlEncode(e.guide))}if(e.reason===1||e.reason===9){var s="";if(!WH.WAS){s="Ads class not found. User may have ad blocking enabled. No ad log available."}else{var o=WH.WAS.getDfpLog();if(o&&o.length){s+="<br><b><i>DFP LOG</i></b><br>";for(var l=0,c;c=o[l];l++){s+="<br><b>"+c._time+"</b><br>";s+="<b>Unit:</b> "+c._env+" "+c._slot+"<br>";s+="<b>Channel:</b> "+c._channelName+" ("+c._channelGroup+")<br>";if(c._error){s+='<span style="color:'+WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_FAIL)+'"><b>Error:</b> '+c._error+"</span><br>"}delete c._time;delete c._env;delete c._slot;delete c._channelName;delete c._channelGroup;delete c._error;var u=WH.objectToArray(c,"property");for(var d=0,f;f=u[d];d++){s+="<b>"+f.property+":</b> "+JSON.stringify(f.value)+"<br>"}}}}if(!s){s="No ad data. Probably blocked by user."}n.push("adinfo="+encodeURIComponent(s));let e=WH.LocalStorage.get("zafusr");if(e){n.push("zafusr="+encodeURIComponent(e))}}e.submitting=true;var h="/contactus";new Ajax(h,{method:"POST",params:n.join("&"),onSuccess:function(e,t){var i=e.responseText;if(i==0){if(g_user.name){alert(WH.sprintf(WH.TERMS.contactreceived_format,g_user.name))}else{alert(WH.TERMS.contactthanks_tip)}Lightbox.hide()}else{if(r[i]){alert(r[i])}else{alert("Error: "+i)}}},onFailure:function(e,t){alert("Failure submitting contact request: "+e.statusText)},onComplete:function(t,a){for(var n=0;n<i.elements.length;++n){i.elements[n].disabled=false}e.submitting=false}});return false};this.show=function(t){if(!t){t={}}let i={mode:0};WH.cO(i,t);i.reasons=s[i.mode];if(location.href.indexOf("#contact")!==-1){i.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{i.currenturl=location.href}let a="contactus";if(i.mode!==0){a="reportform"}if(!n){e.init()}n.show(a,{data:i,onShow:e.onShow,onHide:e.onHide,onSubmit:e.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){n=new Dialog;Dialog.templates.contactusEmailOnly={title:WH.TERMS.contactwowhead,width:550,buttons:[["x",WH.TERMS.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(e,t,i,a){$(a).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:feedback@wowhead.com">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:WH.TERMS.contactwowhead,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,required:1,options:[],compute:function(e,t,i,a){WH.ee(e);for(var n=0;n<this.data.reasons.length;++n){var s=this.data.reasons[n][0];var r=this.data.reasons[n][1];var o=false;if(typeof r=="function"){o=r(this.extra)}else{o=r}if(!o){continue}var c=WH.ce("option");c.value=s;if(t&&t==s){c.selected=true}WH.ae(c,WH.ct(l(s)));WH.ae(e,c)}e.onchange=function(){if(this.value==1||this.value==2||this.value==3){i.currenturl.parentNode.parentNode.style.display="";i.relatedurl.parentNode.parentNode.style.display=""}else if(this.value==9){i.currenturl.parentNode.parentNode.style.display="";i.relatedurl.parentNode.parentNode.style.display="none"}else{i.currenturl.parentNode.parentNode.style.display="none";i.relatedurl.parentNode.parentNode.style.display="none"}}.bind(e);a.style.width="98%"},validate:function(e,t,i){var a="";if(!e||e.length==0){a=WH.TERMS.contactreason_tip}if(a==""){return true}ContactTool.displayError(i.reason,a);WH.safeFocus(i.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:WH.TERMS.currenturl_colon,size:40},{id:"relatedurl",type:"text",label:WH.TERMS.relatedurl_colon,caption:WH.TERMS.optional,size:40,validate:function(e,t,i){var a="";var n=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;e=e.trim();if(e.length>=250){a=WH.TERMS.relatedurl_tip}else if(e.length>0&&!n.test(e)){a=WH.TERMS.entervalidurl_tip}if(a==""){return true}ContactTool.displayError(i.relatedurl,a);WH.safeFocus(i.relatedurl);return false}},{id:"email",type:"text",label:WH.TERMS.emailaddress_colon,caption:WH.TERMS.emailcontact_tip,compute:function(e,t,i,a,n){var s=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(i.email).val())?"none":"");Lightbox.reveal()};$(e).keyup(s).blur(s)},validate:function(e,t,i){var a="";e=e.trim();if(e.length>=100){a=WH.TERMS.emailaddresslength_tip}else if(e.length>0&&!WH.isEmailValid(e)){a=WH.TERMS.entervalidemail_tip}if(a==""){return true}ContactTool.displayError(i.email,a);WH.safeFocus(i.email);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:i,required:1,size:[10,30],validate:function(e,a,n){var s="";e=e.trim();if(e.length<t||e.length>i){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}},{id:"noemailwarning",type:"caption",compute:function(e,t,i,a){$(a).html('<span id="contact-emailwarn" class="q10">'+WH.TERMS.noemailwarning_tip+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(e["reason"]&&!e.reason.value){setTimeout(e.reason.focus.bind(e.reason),10)}else if(e["relatedurl"]&&!e.relatedurl.value){setTimeout(e.relatedurl.focus.bind(e.relatedurl),10)}else if(e["email"]&&!e.email.value){setTimeout(e.email.focus.bind(e.email),10)}else if(e["description"]&&!e.description.value){setTimeout(e.description.focus.bind(e.description),10)}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:WH.TERMS.report,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,options:[],compute:function(e,t,i,a){switch(this.data.mode){case 1:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportcomment_format,'<a href="/user='+this.data.comment.user+'">'+this.data.comment.user+"</a>");break;case 2:var n='<a href="/user='+this.data.post.user+'">'+this.data.post.user+"</a>";if(this.data.post.op){i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reporttopic_format,n)}else{i.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportpost_format,n)}break;case 3:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.screenshotreport_format,'<a href="/user='+this.data.screenshot.user+'">'+this.data.screenshot.user+"</a>");break;case 5:i.firstChild.innerHTML=WH.sprintf(WH.TERMS.videoreport_format,'<a href="/user='+this.data.video.user+'">'+this.data.video.user+"</a>");break;case 6:i.firstChild.innerHTML="Report guide";break}i.firstChild.setAttribute("style","");WH.ee(e);var s;if(this.data.mode==1){s=this.data.comment}else if(this.data.mode==2){s=this.data.post}else if(this.data.mode==3){s=this.data.screenshot}else if(this.data.mode==5){s=this.data.video}else if(this.data.mode==6){s=this.data.guide}WH.ae(e,WH.ce("option",{selected:!t,value:-1}));for(var r=0;r<this.data.reasons.length;++r){var o=this.data.reasons[r][0];var c=this.data.reasons[r][1];var u=false;if(typeof c=="function"){u=c(s)}else{u=c}if(!u){continue}var d=WH.ce("option");d.value=o;if(t&&t==o){d.selected=true}WH.ae(d,WH.ct(l(o)));WH.ae(e,d)}a.style.width="98%"},validate:function(e,t,i){var a="";if(!e||e==-1||e.length==0){a=WH.TERMS.contactreason_tip}if(a==""){return true}ContactTool.displayError(i.reason,a);WH.safeFocus(i.reason);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:a,required:1,size:[10,30],validate:function(e,i,n){var s="";e=e.trim();if(e.length<t||e.length>a){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}}],onInit:function(e){},onShow:function(e){let t=WH.qs('*[name="reason"]',e);let i=WH.qs('*[name="description"]',e);if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(!t.value){setTimeout(t.focus.bind(t),10)}else if(!i.value){setTimeout(i.focus.bind(i),10)}}}};function l(e){return(WH.getPageData("contactReasons")||{})[e]||WH.TERMS.unknown}WH.onLoad(this.checkPound)};WH.Gatherer=new function(){var requested={};this.addData=function(e,t,i){g_gathered_types[e]=g_gathered_types[e]||{};let a=g_gathered_types[e];for(let e in i){if(!i.hasOwnProperty(e)){continue}if(t===WH.getDataEnv()){if(!a.hasOwnProperty(e)){a[e]=i[e]}else{WH.cO(a[e],i[e])}}else{let n=getEnvKey(t);if(!a.hasOwnProperty(e)){a[e]=i[e];a[e][n]=WH.cO({},i[e])}else{if(!a[e].hasOwnProperty(n)){a[e][n]={}}WH.cO(a[e][n],i[e]);for(let t in i[e]){if(!i[e].hasOwnProperty(t)){continue}if(!a[e].hasOwnProperty(t)){a[e][t]=i[e][t]}}}}}};this.fetchItems=function(e,t){fetchData("items",e,t)};this.fetchSpells=function(e,t){fetchData("spells",e,t)};this.get=function(e,t,i,a){if(!g_gathered_types.hasOwnProperty(e)){return undefined}var n=g_gathered_types[e][t];if(n===undefined||!i||i===WH.getDataEnv()){return n}var s=getEnvKey(i);var r=a?undefined:n;return n.hasOwnProperty(s)?n[s]:r};this.getIconName=function(e,t){return g_gathered_types[e]&&g_gathered_types[e][t]&&g_gathered_types[e][t].icon||WH.Icon.UNKNOWN};this.getName=function(e,t){if(!g_gathered_types[e]||!g_gathered_types[e][t]){switch(e){case WH.Types.RACE:return WH.Wow.Race.getName(t)||null;case WH.Types.PLAYER_CLASS:return WH.Wow.PlayerClass.getName(t);case WH.Types.CURRENCY:return WH.Wow.Currency.getName(t);case WH.Types.ZONE:return WH.Wow.Area.getName(t);case WH.Types.HUNTER_PET:return WH.Wow.Pet.getName(t);case WH.Types.SKILL:return WH.Wow.Skill.getName(t)}return null}if(g_gathered_types[e][t].name){return g_gathered_types[e][t].name}return g_gathered_types[e][t]["name_"+Locale.getName()]||null};function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url="/gatherer?"+type+"="+entityArray.join(",");if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(url,callback)}function getEnvKey(e){return"_dataEnv_"+WH.dataEnvKey[e]}function prepareEntityArray(e,t,i){if(!requested[e]){requested[e]={}}if(t instanceof Array){var a=[];for(var n=0,s;s=t[n];n++){if(validateID(s)){if(requested[e][s]&&!i.forceRequest){}else{requested[e][s]=true;a.push(s)}}}return a}else if(validateID(t)){if(requested[e][t]&&!i.forceRequest){return[]}else{requested[e][t]=true;return[t]}}else{WH.error("Gatherer requires an array of IDs or single ID.");return[]}}function validateID(e){return typeof e=="number"||typeof e=="string"&&!e.match(/[^0-9]/)}};WH.GlobalStrings=WH.GlobalStrings||{};(function(){if(typeof Proxy!=="function"){return}var e=WH.GlobalStrings;WH.GlobalStrings=new Proxy(e,{get:function(e,t){return e[t]||t}})})();WH.Guide=new function(){const e=WH.getPageData("guides.statusNames");this.getStatusName=function(t){return(e||[])[t]}};function GetStars(e,t,i,a){var n=5;var s=e;if(i){e=i}e=Math.round(e*2)/2;var r=Math.round(e);var o=$("<span>").addClass("stars").addClass("max-"+n).addClass("stars-"+r);if(!g_user.id){t=false}if(t){o.addClass("ratable")}if(i){o.addClass("rated")}var l="<span>";var c=e;for(var u=1;u<=n;++u){if(c<1&&c>0){l+='<b class="stars-half">'}else if(c<=0){l+='<b class="stars-empty">'}else{l+='<b class="stars-full">'}c--;l+='<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half"></i>'}for(var u=1;u<=n;++u){l+="</b>"}l+="</span>";o.append(l);if(t){var d=0;$("b",o).each((function(){var e=++d;$("> i",this).click((function(){VoteGuide(a,s,e);return false}))}))}if(i){var f=$("<span>").addClass("clear fa fa-times-circle").click((function(){VoteGuide(a,s,0)}));o.append(f)}if(e>=0)o.mouseover((function(t){WH.Tooltip.showAtCursor(t,"Rating:&nbsp;"+e+"&nbsp;/&nbsp;"+n,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));return o}function VoteGuide(guideId,oldRating,newRating){$("#guiderating").html(GetStars(oldRating,true,newRating,guideId));$.ajax({cache:false,url:"/guide=vote",type:"POST",error:function(){$("#guiderating").html(GetStars(oldRating,true,0,guideId));alert("Voting failed. Try again later.")},success:function(json){var data=eval("("+json+")");$("#guiderating-value").text(data.rating);$("#guiderating-votes").text(WH.getN5(data.nvotes))},data:{id:guideId,rating:newRating}})}WH.Highlight=function(e,t,i,a){const n={buttonSize:undefined,class:undefined,closeButtonText:undefined,contents:undefined,elements:{target:undefined,wrapper:undefined},extraButtons:[],fixedPosition:false,position:undefined,storageKey:"highlight-"+e,useLocalStorage:true};function s(e,t,i){i=i||{};if(i.hasOwnProperty("useLocalStorage")){n.useLocalStorage=i.useLocalStorage}if(n.useLocalStorage){let e=WH.LocalStorage.get(n.storageKey);if(e){try{e=JSON.parse(e)}catch(e){}if(e===true){return}}}else{let e=WH.qs(".element-highlight#"+n.storageKey);if(e){WH.de(e)}}n.elements.target=$(e);if(!n.elements.target.length||!n.elements.target.is(":visible")){return}n.fixedPosition=WH.isElementFixedPosition(n.elements.target[0]);if(typeof i.buttonSize==="string"){n.buttonSize=i.buttonSize}if(i.extraButtons instanceof Array){n.extraButtons=i.extraButtons}if(typeof i["class"]==="string"){n["class"]=i["class"]}n.contents=t;n.closeButtonText=i.closeButtonText||WH.TERMS.gotIt_exclamation;n.position=["bottom","left","right","top"].indexOf(i.position)!==-1?i.position:"bottom";o();r()}function r(){$(window).resize((function(){var e=document.querySelectorAll(".element-highlight");for(var t=0,i=e.length;t<i;t++){WH.de(e[t])}}));r=function(){}}function o(){var e=n.fixedPosition?n.elements.target[0].getBoundingClientRect():n.elements.target.offset();var t=n.elements.target.outerHeight();var i=n.elements.target.outerWidth();n.elements.wrapper=$("<div/>",{class:"element-highlight",css:{left:e.left+"px",top:e.top+"px"},id:n.storageKey});if(n.fixedPosition){n.elements.wrapper.css("position","fixed")}$("<div/>",{class:"element-highlight-highlighter",css:{height:t+"px",width:i+"px","border-radius":n.elements.target.css("border-radius")}}).appendTo(n.elements.wrapper);var a={};switch(n.position){case"bottom":a.left=i/2+"px";a.top=t+"px";break;case"left":a.right="0px";a.top=t/2+"px";break;case"right":a.left=i+"px";a.top=t/2+"px";break;case"top":a.bottom="0px";a.left=i/2+"px";break}var s=$("<div/>",{class:"element-highlight-dialog",css:a,"data-position":n.position}).appendTo(n.elements.wrapper);var r=$("<div/>",{class:"element-highlight-dialog-content","data-buttons":n.extraButtons.length+1}).appendTo(s);if(n["class"]){n.elements.wrapper.addClass(n["class"])}if(typeof n.contents==="string"){r.text(n.contents)}else{$(n.contents).appendTo(r)}var o=$("<div/>",{class:"element-highlight-dialog-content-buttons"}).appendTo(r);if(n.extraButtons.length){for(var c=0,u=n.extraButtons.length;c<u;c++){var d=n.extraButtons[c];if(!d.url&&!d.action){continue}var f=$("<a/>",{class:"element-highlight-dialog-content-button btn btn-site",text:d.text}).appendTo(o);if(d.url){f.attr("href",d.url)}if(d.action){f.click(d.action)}if(n.buttonSize){f.addClass("btn-"+n.buttonSize)}}}var h=$("<a/>",{class:"element-highlight-dialog-content-close btn btn-site",text:n.closeButtonText,click:l}).appendTo(o);if(n.buttonSize){h.addClass("btn-"+n.buttonSize)}n.elements.wrapper.appendTo(document.body);switch(n.position){case"left":case"right":setTimeout((function(){r.css("top","-"+r.outerHeight()/2+"px")}),0);break}}function l(){n.elements.wrapper.fadeOut((function(){$(this).remove()}));if(n.useLocalStorage){WH.LocalStorage.set(n.storageKey,JSON.stringify(true))}}s(t,i,a)};WH.jQuery=new function(){this.formatJqxhrMessage=function(e){let t=[];if(e.status){t.push("status: ["+e.status+"]")}if(e.statusText){t.push("statusText: ["+e.statusText+"]")}if(e.responseJSON&&e.responseJSON.error){t.push("responseJSON.error: ["+e.responseJSON.error+"]")}else if(e.responseText){t.push("responseText: ["+e.responseText+"]")}return t.join(", ")}};WH.Layout=new function(){const e=this;const t=WH.Device;const i=WH.DOM;const a=WH.Game;const n={vkontakte:"vk",reddit:"reddit-alien",permalink:"link"};const s={activeNavItem:null,autoSearchFocus:true,breadcrumb:null,checkedMenuItems:[],disableLayoutAnimation:0,elements:{$breadcrumb:$('<div class="breadcrumb"/>'),header:undefined,headerNav:undefined,"header-search":undefined,"header-wrapper":undefined,layout:undefined,"main-contents":undefined,"page-content":undefined},forcedFullscreenMode:false,fullscreenMode:undefined,fullscreenModeDefault:false,fullscreenModeNamespace:null,initialized:false,navMenusAttached:false,pageName:null};this.addShareLinks=function(t,i){t=typeof t==="string"?t.replace(/\./g,"\\."):t;let a=$("<div>",{class:"share-links"}).prependTo(t);let n=e.getShareServices(i);for(let e=0,t=n.length;e<t;e++){let t=n[e].type==="permalink"?WH.term("copy_format",n[e].name):WH.Strings.sprintf(WH.TERMS.shareon_format,n[e].name);let i=$("<a>",{class:"fa fa-"+n[e].fontIcon,href:n[e].url,rel:"np",target:"_blank"}).appendTo(a);WH.Tooltip.simple(i[0],t,"q2");if(n[e].type==="permalink"){WH.aE(i[0],"click",(t=>{t.preventDefault();WH.copyToClipboard(n[e].url,t)}))}}};this.disableLayoutAnimation=function(){document.body.dataset.disableLayoutAnimation="true";s.disableLayoutAnimation++};this.enableLayoutAnimation=function(){if(s.disableLayoutAnimation===0||--s.disableLayoutAnimation===0){delete document.body.dataset.disableLayoutAnimation}};this.expandContent=function(){WH.WAS.remove("vertical")};this.expandSite=function(t){if(!WH.WAS||!document.body){WH.aE(document,"bodyAvailable",e.expandSite.bind(this,t));return}if(!WH.WAS.showAds()){return}t=t!==false;if(!t){e.disableLayoutAnimation();setTimeout((function(){requestAnimationFrame(e.enableLayoutAnimation)}),10)}WH.WAS.removeAll(t);document.body.dataset.showSideExpander="false";document.body.classList.add("no-ads-breadcrumb");setTimeout((function(){document.body.classList.remove("has-ads");document.body.classList.add("no-ads")}),(t?WH.WAS.ANIMATION_DURATION_MS:0)+1)};this.expandVideo=function(){WH.WAS.remove("horizontal")};this.getBreadcrumb=function(){return s.elements.$breadcrumb};this.getDataEnvSwitcherUrl=function(e){let t=WH.getDataTree(e);let i=(WH.PageMeta.disabledInTrees||[]).includes(t)?"/":WH.Url.removePathPrefixes(location.pathname+location.search);if(WH.isClassicTree()&&i!=="/"){i+=(i.match(/[?&]/)?"&":"?")+"fromClassic"}if(WH.isTbcTree()&&i!=="/"){i+=(i.match(/[?&]/)?"&":"?")+"fromBurningCrusade"}if(WH.isWrathTree()&&i!=="/"){i+=(i.match(/[?&]/)?"&":"?")+"fromWrath"}i+=location.hash;return WH.Url.generate(i,{dataEnv:e})};this.getElement=function(e){if(!s.elements.hasOwnProperty(e)){WH.error("Requested unsupported element.",e);return null}if(s.elements[e]===undefined){s.elements[e]=WH.qs("."+e);if(!s.elements[e]){if(document.readyState!=="complete"){s.elements[e]=undefined}else{s.elements[e]=null}}}return s.elements[e]};this.getFullscreenMode=function(){if(s.forcedFullscreenMode){return true}if(s.fullscreenMode===undefined){s.fullscreenMode=h()}return s.fullscreenMode};this.getHeaderHeight=function(){if(WH.Layout.Responsive.isZulInMobileMode()){return 40}let e=WH.Layout.getElement("header-wrapper");if(e){return e.getBoundingClientRect().height}return 0};this.getPageName=function(){return s.pageName||null};this.getShareTypes=function(){let e=["twitter","facebook","reddit"];if(Locale.get().id===LOCALE_RURU){e.unshift("vk")}return e};this.getShareServices=function(t){let i=[];let a=["vkontakte","twitter","facebook","reddit","permalink"];for(let s=0,r=a.length;s<r;s++){let r=a[s];if(r==="vkontakte"&&Locale.getId()!==LOCALE_RURU){continue}i.push({type:r,name:WH.TERMS[r],url:e.getShareUrl(r,t),fontIcon:n[r]||r})}return i};this.getShareUrl=function(e,t){let i=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+i;case"reddit":return"//www.reddit.com/submit?url="+i+"&r=wow";case"twitter":return"https://twitter.com/intent/tweet?text=%20"+i+"%20via%20@Wowhead";case"vk":return"https://vk.com/share.php?url="+i;case"permalink":return t}WH.error("Tried to get the URL to share to an unknown service.",e);return""};this.init=function(){W();let e=v();T();m();WH.Layout.Responsive.init(e);E();s.initialized=true};this.initPageState=(i,a,n)=>{if(Locale.exists(i)){Locale.set(i)}if(n!==false){WH.onLoad(ZUL.init.bind(null,a))}o();let s=t.isMobile()?"mobile":t.isTablet()?"tablet":"pointer";document.documentElement.classList.add(s+"-device");if(t.isTouch()){document.documentElement.classList.add("touch-device")}I();R();e.initPageState=()=>{}};this.initSidebar=function(){if(!WH.WAS.showAds()){return}if(t.isTouch()){WH.WAS.remove("vertical");WH.de(".header-expand-site-tab")}else{WH.DynamicFixedElement.init("sidebar",".sidebar")}};this.locateBreadcrumb=function(){let t=Menu.getFullPath(Menu.getMenu(),s.breadcrumb);if(!t.length){return}if(!g_pageInfo||!g_pageInfo.hasOwnProperty("typeId")){return}let i=new RegExp("\\b"+WH.Types.getDetailPageName(g_pageInfo.type)+"="+g_pageInfo.typeId+"\\b");let a=JSON.parse(JSON.stringify(s.breadcrumb));a.pop();let n=false;let r=function(e){a.push(e[Menu.ITEM_CRUMB]);let t=Menu.getSubmenu(e);if(t&&t.length){for(let e=0,i=t.length;e<i&&!n;e++){r(t[e])}}else{n|=e.length>2&&i.test(e[Menu.ITEM_URL])}if(!n){a.pop()}};r(t.pop());if(n){s.breadcrumb=a;e.updateBreadcrumb()}};this.set=function(t){if(!t){return}let i=false;if(t.hasOwnProperty("activeTab")&&s.activeNavItem!==t.activeTab){s.activeNavItem=typeof t.activeTab==="string"&&t.activeTab.match(/^\d+$/)?parseInt(t.activeTab):t.activeTab;i=true}let a=false;if(t.hasOwnProperty("breadcrumb")&&JSON.stringify(s.breadcrumb)!==JSON.stringify(t.breadcrumb)){s.breadcrumb=t.breadcrumb;a=true}if(t.hasOwnProperty("pageName")){s.pageName=t.pageName}if(t.hasOwnProperty("autoSearchFocus")){s.autoSearchFocus=t.autoSearchFocus}if(s.initialized){if(i){M()}if(a){e.updateBreadcrumb()}}};this.setForcedFullscreenMode=function(t){let i=e.getFullscreenMode();s.forcedFullscreenMode=t;if(e.getFullscreenMode()!==i){R()}else{document.body.dataset.forcedFullscreenMode=JSON.stringify(t)}};this.setFullscreenMode=function(t){let i=e.getFullscreenMode();s.fullscreenMode=t;let a=t?s.fullscreenModeDefault===false&&f()===false?"Re-enabled":"Enabled":s.fullscreenModeDefault===true&&f()===true?"Re-disabled":"Disabled";WH.LocalStorage.set(c(),JSON.stringify(!!t));WH.Track.interactiveEvent("Changed Option","Fullscreen Mode",a);if(e.getFullscreenMode()!==i){R()}};this.setFullscreenModeNamespace=function(t,i){let a=e.getFullscreenMode();s.fullscreenModeNamespace=t;s.fullscreenModeDefault=t===null||typeof i!=="boolean"?false:i;s.fullscreenMode=undefined;if(e.getFullscreenMode()!==a){R()}};this.setTitle=function(e){if(e.indexOf(WH.TERMS.wowhead)===-1){e+=WH.TERMS.hyphen_punct+WH.Game.getName(WH.Game.get())}document.title=e};this.toggleFullscreenMode=function(){e.setFullscreenMode(!h())};this.updateBreadcrumb=function(){if(!s.breadcrumb||!s.breadcrumb.length){s.elements.$breadcrumb.detach();setTimeout((function(){if(s.elements.$breadcrumb.is(":empty")){s.elements.$breadcrumb.detach()}}),0);return}s.elements.$breadcrumb.empty();if(s.checkedMenuItems.length){$.each(s.checkedMenuItems,(function(){this.checked=false;Menu.updateItem(this)}));s.checkedMenuItems=[]}let e=Menu.getFullPath(Menu.getMenu(),s.breadcrumb);if(!e.length){return}let t=e.length-1;let i=[];for(let a=0,n=e.length;a<n;a++){let n=e[a];let r=Menu.getItemOptions(n);n.checked=true;if(n[Menu.ITEM_OPTIONS]&&n[Menu.ITEM_OPTIONS].breadcrumbParent||e[a+1]&&e[a+1][Menu.ITEM_OPTIONS]&&e[a+1][Menu.ITEM_OPTIONS].breadcrumbParent){if(!n[Menu.ITEM_OPTIONS]){n[Menu.ITEM_OPTIONS]={}}n[Menu.ITEM_OPTIONS].checkedFunc=function(e){let t=$("#main-precontents .breadcrumb span a.open");return t.text()===e[Menu.ITEM_LABEL]}}s.checkedMenuItems.push(n);Menu.updateItem(n);let o=d();let l=o;let c=Menu.getItemUrl(n);if(typeof c==="string"){c=WH.ensureUrlProtocol(c);l=$("<a/>",{href:c,rel:"np"}).appendTo(o)}else{c=undefined}let u=Menu.getLabel(n,true);l.text(u);Menu.add(l,n.parentMenu);o.appendTo(s.elements.$breadcrumb);i.push({name:u,url:c,image:r.tinyIcon?WH.ensureUrlProtocol(WH.Icon.getIconUrl(r.tinyIcon,WH.Icon.MEDIUM)):undefined});if(r.onBreadcrumbDisplay){r.onBreadcrumbDisplay(s.breadcrumb)}let f=Menu.getSubmenu(n);if(a===t&&f){o.addClass("breadcrumb-arrow");let e=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(e,f);e.appendTo(s.elements.$breadcrumb)}}WH.Seo.addJsonLdBreadcrumb(i);s.elements.$breadcrumb.trigger("update");if(!s.elements.$breadcrumb.is(":empty")){s.elements.$breadcrumb.appendTo("#main-precontents");s.elements.$breadcrumb.show()}ZUL.regenerateMenu()};this.updateContentHeight=function(){let t=WH.qs(".main-contents");let a=WH.qs(".sidebar");let n=!t||!a;if(!WH.WAS.showAds()){n=true;e.updateContentHeight=function(){}}if(n){if(t&&t.style.minHeight){t.style.minHeight=""}return}let s=i.getInnerHeight(t);let r=t.offsetHeight-s;let o=i.getInnerHeight(a)-r;let l=WH.ge("main-precontents");if(l){o-=l.offsetHeight}if(s<o){t.style.minHeight=o+"px"}};this.updateDataEnvLink=function(t,i){if(t.dataset.disabled==="true"){delete t.href;return}t.href=e.getDataEnvSwitcherUrl(i)};this.updateSearchWidth=function(e){if(!WH.Theme.isStandardType()){return}let t=WH.qs(".header");let i=WH.qs(".header-right");let a=WH.qs(".header-user");let n=WH.qs(".header-search");let s=WH.qs(".header-search form");let r=WH.qs('.header-search input[type="text"]');let o=WH.qs(".header-search-button");if(t&&i&&a&&n&&s&&r&&o){let e=n.getBoundingClientRect().left-t.getBoundingClientRect().left;let l=window.getComputedStyle(i).getPropertyValue("left");s.style.position="absolute";s.style.top=o.style.top="10px";s.style.left=o.style.left=e-parseInt(l)+"px";s.style.right=i.getBoundingClientRect().right-a.getBoundingClientRect().left+"px";r.style.width="100%"}if(e!==false){WH.Layout.Responsive.check()}};function r(){let e=WH.Url.getSubdomain(WH.PageMeta.classicDataEnv,Locale.getId());let t=location.pathname+location.search;let i=t.indexOf("?")!==-1||t.indexOf("&")!==-1?"&":"?";t+=i+"classicRedirect";t+=location.hash;location.href=WH.Url.generate(t,{subdomain:e})}function o(){let e=Locale.getPreferred();if(e===undefined){return}Locale.setPreferred(e);if(e===Locale.getId()){return}if(!document.referrer){return}let t;try{t=new URL(document.referrer)}catch(e){return}if(/\.wowhead\.com$/.test("."+t.hostname)){return}let i=WH.Url.getSubdomain();let a=WH.Url.getSubdomain(undefined,e);if(i===a){return}if(location.href.indexOf(location.origin)!==0){WH.warn("Could not determine path by removing origin",location);return}let n=WH.Url.generate(location.href.substr(location.origin.length),{locale:e});if(location.href!==n){location.href=n}}function l(){return WH.LocalStorage.jsonGet("fromClassic")===true}function c(){return"fullscreenMode"+(s.fullscreenModeNamespace?"."+s.fullscreenModeNamespace:"")}function u(e){let t=Menu.getItemOptions(e);let i=WH.ce("a",{className:t.headerNavIcon?"header-nav-icon":"header-nav-text",href:e[Menu.ITEM_URL],rel:"np"});if(!e[Menu.ITEM_URL]){i.href="javascript:";i.className+=" unlinked"}if(t.className){i.className+=" "+t.className}if(t.title){i.title=t.title}let a=Menu.getSubmenu(e);let n=WH.ce("span");WH.ae(i,n);if(t.headerNavIcon){n.classList.add("header-nav-icon-image");if(t.headerNavIconClass){n.classList.add(t.headerNavIconClass)}else if(t.headerNavIcon.indexOf("/")>-1){n.style.background="url("+WH.staticUrl+t.headerNavIcon+")"}else{n.style.background="url("+WH.staticUrl+"/images/wow/icons/medium/"+t.headerNavIcon+".jpg)"}if(t.headerNavIconWithName){let t=WH.ce("span",{className:"header-nav-icon-text"});WH.st(t,e[Menu.ITEM_LABEL]);WH.ae(i,t)}}else{WH.st(n,e[Menu.ITEM_LABEL]);if(a&&WH.Theme.isClassicType()){WH.ae(i,WH.ce("span",{className:"fa fa-caret-down"}))}}if(a){Menu.add(i,a,{padded:true})}return i}function d(){s.elements.$breadcrumb.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(s.elements.$breadcrumb)}function f(){try{let e=JSON.parse(WH.LocalStorage.get(c()));return typeof e==="boolean"?e:undefined}catch(e){return undefined}}function h(){let e=f();return e===undefined?s.fullscreenModeDefault:e}function p(){let e=WH.ge("main-contents");let t=WH.qs(WH.PageMeta.classicLinkSelector);let a="bottom";if(!t||!i.isVisible(t)){t=WH.qs(".main-contents > .text > .heading-size-1");if(!t||!i.isVisible(t)){if(WH.Layout.Responsive.check()){return}t=e;a="top";if(!t||!i.isVisible(t)){return}}}let n=i.getInnerWidth(t);if(n&&n+230<(i.getInnerWidth(e)||window.innerWidth)){a="right"}let s=WH.Page.getType();let r=WH.Types.hasName(s)?WH.Types.getLowerSingular(s):WH.TERMS.page_lc;let o=WH.Url.generate(location.pathname,{subdomain:WH.Url.getSubdomain(WH.PageMeta.classicDataEnv)});let l=WH.ce("div",{className:"highlight-classic-link-content"});l.innerHTML=WH.term("dataEnvVersionLink_format",WH.getDataEnvSeoName(WH.PageMeta.classicDataEnv),r,'<a href="'+o+'">',"</a>");setTimeout((function(){let e="classic-link-type-"+(s||"other");new WH.Highlight(e,t,l,{buttonSize:"small",class:"highlight-classic-link",closeButtonText:WH.TERMS.close,extraButtons:[{text:WH.TERMS.wowheadClassic,url:o}],position:a})}),250)}function m(){e.updateBreadcrumb()}function H(){if(!WH.Theme.isStandardType()){return}requestAnimationFrame(e.updateSearchWidth);if(typeof MutationObserver!=="undefined"){let t=WH.qs(".header");if(t){let i=new MutationObserver(e.updateSearchWidth);i.observe(t,{characterData:true,childList:true,subtree:true})}}}function g(){e.initPageState(LOCALE_ENUS,null);WH.prepInfobox();WH.Responsive.test();_();N()}function W(){const t=WH.Url;$(".header-expand-site-tab").attr("href","javascript:").click(WH.Layout.expandSite);let i=WH.getPageData("listPage.notFoundPath");if(i){history.replaceState({},"",t.generatePath(i))}WH.qsa(".data-env-links a[title]").forEach((function(t){let i=WH.getDataEnvFromKey(t.dataset.env);if(WH.getDataEnv()!==i){WH.aE(t,"click",e.updateDataEnvLink.bind(t,t,i));WH.aE(t,"mouseover",e.updateDataEnvLink.bind(t,t,i));e.updateDataEnvLink(t,i)}let a=t.title;if(WH.PageMeta.page==="home"||(WH.PageMeta.page||"").indexOf("news")===0){let e=i===WH.dataEnv.MAIN?WH.TERMS.newsTypes+WH.TERMS.colon_punct+WH.TERMS.all:WH.TERMS.newsType+WH.TERMS.colon_punct+WH.TERMS[WH.getDataEnvTerm(i)];a+='<div style="margin-top:10px">'+e+"</div>"}WH.Tooltip.simple(t,'<span class="no-wrap">'+a+"</span>",t.href?"q2":"q");t.title=""}));$(".header-theme-switcher a").click((function(){if(this.classList.contains("current")){return}this.classList.remove("fa-square");this.classList.add("fa-refresh");this.classList.add("fa-spin");if(!WH.User.isLoggedIn()){window.location=t.generatePath("/account=signin?next="+encodeURIComponent(t.getInternalPath()+window.location.hash));return}WH.Theme.set(this.dataset.theme)}))}function v(){let t=e.getElement("header");if(!t){return}let i=WH.ce("div",{className:"header-nav-wrapper"});WH.ae(t,i);s.elements.headerNav=WH.ce("div",{className:"header-nav"});WH.ae(i,s.elements.headerNav);let a=Menu.getMenu();let n=[];let r=[];for(let e=0,t;t=a[e];e++){let e=Menu.getItemOptions(t);if(e.breadcrumbOnly||e.hide){continue}let i=WH.ce("a",{dataset:{id:t[Menu.ITEM_CRUMB]}});i.whMenuItem=t;WH.st(i,t[Menu.ITEM_LABEL]);if(e.collapseOrder){i.dataset.collapseOrder=e.collapseOrder;r.push(i)}if(e.rel){i.rel=e.rel}let a=$(i);Menu.linkifyItem(t,a);i.menuItem=t;a.data("menuItem",t);n.push(i);WH.ae(s.elements.headerNav,i)}M();let o=u([null,"",null,null,{className:"header-nav-ellipsis"}]);let l=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(o.firstElementChild,l);WH.ae(s.elements.headerNav,o);let c=WH.ce("div",{className:"header-nav-features"});WH.ae(i,c);let d=Menu.getFeaturedNavigationMenu();let f=[];for(let e=0,t;t=d[e];e++){let e=u(t);e.menuItem=t;f.push(e);WH.ae(c,e)}let h=u([null,"",null,null,{className:"header-nav-ellipsis"}]);let p=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(h.firstElementChild,p);WH.ae(c,h);b(f);r.sort((function(e,t){return e.menuItem[Menu.ITEM_OPTIONS].collapseOrder-t.menuItem[Menu.ITEM_OPTIONS].collapseOrder}));return{collapsibleNavLinks:r,featuredEllipsis:h,featuredLinks:f,featuredNav:c,header:t,headerWrapper:t.parentNode,nav:s.elements.headerNav,navEllipsis:o,navLinks:n,navWrapper:i}}function T(){let e=$(".header-search");if(e.length){let t=$('input[type="text"]',e).focus((function(){WH.qs(".header-search").dataset.hasFocus="true"})).blur((function(){WH.qs(".header-search").dataset.hasFocus="false"}));let i=$("body");if(i.hasClass("home")){WH.safeFocus(t)}if(WH.LocalStorage.get("showRandomWidget")==="true"){WH.LocalStorage.remove("showRandomWidget");let e=WH.qs(".header-nav dl");if(e){let t=WH.ce("a",{className:"header-search-random fa fa-random fa-no-padding",href:"/random"});WH.Tooltip.simple(t,WH.TERMS.anotherrandompage_exclamation,"q2");let i=WH.ce("dt");WH.ae(i,t);WH.ae(e,i)}}$("<a/>",{class:"header-search-button fa fa-search",href:"javascript:"}).click(y).appendTo(e);$("form",e).submit(WH.preventEmptyFormSubmission);WH.Search.Live.attach(t[0]);if(Array.prototype.indexOf&&s.autoSearchFocus){i.keydown(function(e,t){if(!t.ctrlKey&&!t.metaKey&&!t.altKey&&WH.keyPressIsAlphaNumeric(t)&&(!document.activeElement||!["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)&&!document.activeElement.isContentEditable)){if(e.offset().top>=window.scrollY){e.focus()}}}.bind(null,t))}H()}}function _(){setTimeout((()=>{e.updateContentHeight();if(!WH.qs(".sidebar")||!WH.qs(".main-contents")){return}if(MutationObserver){let t=undefined;let i=(e,i)=>{if(t!==undefined){return}t=setTimeout((function(){e();t=undefined}),i)};let a=new MutationObserver(i.bind(null,e.updateContentHeight,200));let n={childList:true,attributes:true,characterData:true,subtree:true};a.observe(WH.qs(".sidebar"),n);a.observe(WH.qs(".main-contents"),n)}else{setInterval(e.updateContentHeight,200)}}),9)}function E(){if(WH.getGets().hasOwnProperty("classicRedirect")&&!WH.isRetailTree()){if(window.history&&window.history.replaceState){window.history.replaceState({},"",location.pathname.replace(/[?&]classicRedirect$/,"")+location.search.replace(/[?&]classicRedirect$/,"")+location.hash)}setTimeout((function(){let e='.data-env-links [data-env="live"]';new WH.Highlight("highlight-retail",e,WH.term("returnToRetail_tip",WH.getDataEnvSeoName()),{extraButtons:[{text:WH.Strings.sprintf(WH.TERMS.backTo_format,WH.qs(e).textContent.trim()),url:WH.qs(e).href}],position:"bottom"})}),250)}}function b(e){let t=function(e){return Math.floor(Math.random()*e)+1};switch(document.body.dataset.logo){case"april-fools":const i=WH.Time.MS_SEC*3;const a=WH.Time.MS_SEC*30;let n=true;let s=e.slice();let r=function(){let e=t(s.length)-1;let o=s[e];o.className="header-nav-text header-nav-april-fools";o.classList.add(n?"first-fool":"entrance-"+t(3));s.splice(e,1);n=false;if(s.length){setTimeout(r,t(a))}else{setTimeout((function(){let e=WH.qs(".header-nav-april-fools.first-fool");e.classList.add("fool-behaves");e.classList.remove("first-fool")}),i)}};setTimeout(r,i);break;case"noblegarden":let o=function(e,i){if(i>3){e.classList.add("header-nav-noblegarden-"+i);e.classList.add("header-nav-noblegarden-dye-"+t(6))}else{e.className="header-nav-text header-nav-noblegarden-"+i;e.classList.add("header-nav-noblegarden-dye-"+t(6))}};if(t(20)===20){for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.classList.contains("header-nav-classes")){o(i,1)}else{o(i,4)}}break}let l=t(20)===20?6:t(3);let c=[];let u=[];while(c.length<l){let i=t(6);if(c.includes(i)){continue}let a=t(e.length)-1;if(u.includes(a)){continue}let n=e[a];if(i>3&&n.classList.contains("header-nav-classes")){continue}c.push(i);u.push(a);o(n,i)}break}}function y(){let e=$(this).siblings("form").submit().children("input");WH.safeFocus(e)}function S(){let e=WH.getGets();if(e.hasOwnProperty("classicRedirect")||e.hasOwnProperty("fromClassic")||e.hasOwnProperty("fromBurningCrusade")||e.hasOwnProperty("fromWrath")){WH.Url.replacePageQuery((function(e){delete e.classicRedirect;delete e.fromClassic;delete e.fromBurningCrusade;delete e.fromWrath}));return true}return false}function I(){document.body.dataset.env=WH.getDataEnvKey();document.body.dataset.game=a.getKey(a.get());document.body.dataset.locale=Locale.getName();document.body.dataset.sidebar=JSON.stringify(!!WH.PageMeta.hasSidebar);document.body.dataset.theme=WH.Theme.getTheme();document.body.dataset.themeType=WH.Theme.getThemeType();document.body.dataset.touch=JSON.stringify(t.isTouch());document.body.dataset.tree=WH.getDataTreeKey();document.body.dataset.width=WH.PageMeta.fullWidth?"full":"standard";if(WH.PageMeta.logo){document.body.dataset.logo=WH.PageMeta.logo}if(WH.PageMeta.page){document.body.dataset.page=WH.Strings.slug(WH.PageMeta.page)}}function w(){WH.LocalStorage.jsonSet("fromClassic",true)}function N(){if(S()){w();return}if(!WH.isRetailTree()||!WH.PageMeta.classicDataEnv||l()){return}if(!WH.PageMeta.classicRedirectSkip){r();return}p()}function R(){let t=e.getFullscreenMode();let i=JSON.stringify(t);let a=document.body.dataset.fullscreenMode&&document.body.dataset.fullscreenMode!==i;document.body.dataset.fullscreenMode=i;document.body.dataset.forcedFullscreenMode=JSON.stringify(s.forcedFullscreenMode);let n=WH.qs(".header-user-fullscreen span");if(n){WH.st(n,t?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen)}if(a){Menu.hide(true);WH.Tooltip.hide();if(t){WH.Layout.Responsive.disableNavScrollLimit()}WH.WAS.updateSkinMode()}WH.Layout.Responsive.check(true);WH.WAS.updateSkinPosition(true)}function M(){if(!s.elements.headerNav){return}let e=Menu.getMenu();for(let i=0,a=e.length;i<a;i++){let a=e[i];let n=WH.qs('a[data-id="'+a[Menu.ITEM_CRUMB]+'"]',s.elements.headerNav);if(!n){continue}let r=t.isTouch();if(a[Menu.ITEM_CRUMB]===s.activeNavItem){n.classList.add(r?"active-touch":"active")}else{n.classList.remove(r?"active-touch":"active")}if(s.navMenusAttached){continue}let o=Menu.getSubmenu(a);if(o){if(r){Menu.addTouch(n,o)}else{Menu.add(n,o,{padded:true})}}}s.navMenusAttached=true}WH.onLoad(g)};window.Lightbox=new function(){const e=this;const t=WH.DOM;const i=WH.Tooltip;this.BLEED_SIZE=50*2;this.UI_HEIGHT=52;this.UI_WIDTH=20;const a={callbacks:{onHide:undefined,onResize:undefined,onShow:undefined},elements:{frame:undefined,frames:{},inner:undefined,outer:undefined},initialized:false,lastId:undefined};this.hide=function(){if(!a.initialized||!e.isVisible()){return}l();if(a.callbacks.onHide){a.callbacks.onHide()}WH.displayNone(a.elements.outer);a.elements.inner.style.width="";Menu.hide(true);i.hide();WH.WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)};this.isVisible=function(){return!!a.elements.outer&&t.isVisible(a.elements.outer)};this.reveal=function(){a.elements.outer.dataset.frame=a.lastId;a.elements.frame=a.elements.frames[a.lastId];WH.displayDefault(a.elements.frame);WH.displayDefault(a.elements.outer);dispatchEvent(new Event("resize"))};this.setSize=function(e){a.elements.inner.style.width=e+"px"};this.show=function(t,r,o){r=r||{};a.callbacks.onHide=r.onHide;a.callbacks.onResize=r.onResize;a.callbacks.onShow=r.onShow;Menu.hide(true);i.hide();WH.WAS.hideAll();PoundChecker.pause();s();n();if(a.lastId!==t&&a.elements.frames[a.lastId]){WH.displayNone(a.elements.frames[a.lastId])}a.lastId=t;let l=!a.elements.frames[t];if(l){let e=WH.ce("div",{className:"lightbox-frame"});WH.ae(a.elements.inner,e);a.elements.frames[t]=e}a.elements.frame=a.elements.frames[t];if(a.callbacks.onShow){a.callbacks.onShow(a.elements.frame,l,o)}e.reveal();WH.preventScroll(true,".lightbox-content")};this.showPicker=function(e,t,i){e+="-picker";Lightbox.show(e,{onShow:function(a,n){Lightbox.setSize(800);let s;if(n){a.classList.add(e);WH.ae(a,WH.ce("div",{className:"lightbox-content listview",id:"lv-"+e}));let i=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(i,"click",Lightbox.hide);WH.ae(a,i);t.id=e;s=new Listview(t)}if(i){i(a,n,s)}}})};function n(){WH.aE(document,"keydown",r);WH.aE(window,"resize",o)}function s(){if(a.initialized){return}a.initialized=true;a.elements.inner=WH.ce("div",{className:"lightbox-inner"});a.elements.outer=WH.ce("div",{className:"lightbox-outer",style:{display:"none"}},a.elements.inner);WH.ae(document.body,a.elements.outer);let t=false;let i=false;let n=false;WH.aE(a.elements.inner,"mousedown",(function(){i=true;t=true}));WH.aE(a.elements.inner,"mouseup",(function(){i=false;t=true}));WH.aE(a.elements.outer,"mousedown",(function(){n=true;if(i){i=false;t=true}else{t=false}}));WH.aE(a.elements.outer,"mouseup",(function(i){if(!n){return}n=false;if(!t&&i.target===a.elements.outer){e.hide()}}))}function r(t){if(t.key==="Escape"){e.hide()}}function o(){c();if(a.callbacks.onResize){a.callbacks.onResize()}}function l(){WH.dE(document,"keydown",r);WH.dE(window,"resize",o)}function c(){if(window.innerWidth>=WH.Responsive.BREAKPOINTS.MOBILE_MODE){let t=window.innerHeight-e.BLEED_SIZE;if(a.elements.frame.scrollHeight>t){a.elements.inner.style.maxHeight=t+"px";a.elements.frame.style.maxHeight=t+"px";return}}a.elements.inner.style.maxHeight="";a.elements.frame.style.maxHeight=""}};window.g_listviews={};function Listview(e){const t=WH.User;if(!this.initialSetupComplete){WH.cO(this,e);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){let e=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){this.container=WH.ce("div",{id:e});WH.ae(WH.ge(this.parent),this.container)}else{this.container=WH.ge(e)}if(this.tabs){this.container.style.display="none"}}else{return}g_listviews[this.id]=this;if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this),onShow:function(){this.updateTileSizes();this.writeHash()}.bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}this.initialSetupComplete=true}if(!this.template){WH.error("Every listview requires a template");return}if(typeof this.template==="string"){this.loadingTemplate=true;Listview.loadTemplate(this.template,function(){this.template=Listview.templates[this.template];delete this.loadingTemplate;Listview.call(this,e)}.bind(this));return}if(t.getDebug()){this.debug=true}if(this.data==null){this.data=[]}if(!this.hasOwnProperty("hash")){if(this.template.hasOwnProperty("hash")){this.hash=this.template.hash}else{this.hash=Listview.HASH_FULL}}this.lockHash=true;if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}this.specialHashes={};if(this.data.length===1){this.filtrable=false;this.searchable=false;this.sortable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null)this.hideBands=this.template.hideBands;if(this.hideNav==null)this.hideNav=this.template.hideNav;if(this.hideHeader==null)this.hideHeader=this.template.hideHeader;if(this.hideCount==null)this.hideCount=this.template.hideCount;if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.template.sortOptions){this.sortOptions=[];WH.cOr(this.sortOptions,this.template.sortOptions)}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=Listview.getCompletionText()}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id==="topics"||this.id==="recipes"||this.template.noDebug){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.alternateVersions==null){this.alternateVersions=this.template.alternateVersions}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}if(this.validateHashPagination==null){this.validateHashPagination=true}this.resetRowVisibility();if(this.mode===Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}let e=this.startOnMonth.getFullYear();let t=this.startOnMonth.getMonth();for(let i=0;i<this.nMonthsToDisplay;++i){let a=new Date(e,t+i,32);this.nDaysPerMonth[i]=32-a.getDate();for(let a=1;a<=this.nDaysPerMonth[i];++a){this.dates.push({date:new Date(e,t+i,a)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}this.columns=[];for(let e=0,t=this.template.columns.length;e<t;++e){let t={};WH.cO(t,this.template.columns[e]);this.columns.push(t)}if(this.extraCols!=null){for(let e=0,t=this.extraCols.length;e<t;++e){let t=null;let i=this.extraCols[e];if(typeof i==="string"){if(!Listview.extraCols.hasOwnProperty(i)){WH.error("Unknown extraCol ["+i+"].");continue}i=Listview.extraCols[i]}if(!i){WH.error("Could not find the requested listview column:",this.extraCols[e]);continue}if(i.after||i.before){let e=WH.inArray(this.columns,i.after?i.after:i.before,(function(e){return e.id}));if(e!==-1){t=i.after?e+1:e}}if(t==null){t=this.columns.length}if(i.id===Listview.COLUMN_ID_DEBUG_ID){this.columns.splice(0,0,WH.cO({},i))}else{this.columns.splice(t,0,WH.cO({},i))}if(!this.sortOptions){continue}t=null;if(i.hasOwnProperty("sortOptionsPosition")){switch(i.sortOptionsPosition){case Listview.SORT_OPTIONS_FIRST:t=0;break}}else if(i.after||i.before){let e=WH.inArray(this.sortOptions,i.after?i.after:i.before,(function(e){return e.id}));if(e!==-1){t=i.after?e+1:e}}if(t==null){t=this.sortOptions.length}if(i.id===Listview.COLUMN_ID_DEBUG_ID){this.sortOptions.splice(0,0,i)}else{this.sortOptions.splice(t,0,i)}}}this.visibility=[];let i=[];let a=[];if(this.visibleCols!=null){WH.arrayWalk(this.visibleCols,(function(e){i[e]=1}))}if(this.hiddenCols!=null){WH.arrayWalk(this.hiddenCols,(function(e){a[e]=1}))}if(Array.isArray(this.sortOptions)){for(let e=0,t=this.sortOptions.length;e<t;++e){let t=this.sortOptions[e];t.__index=e;if(i[t.id]!=null||!t.hidden&&a[t.id]==null){this.visibility.push(e)}}}else{for(let e=0,t=this.columns.length;e<t;++e){let t=this.columns[e];t.__index=e;if(i[t.id]!=null||!t.hidden&&a[t.id]==null){this.visibility.push(e)}}}if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){let e=this.sort;this.sort=[];for(let t=0,i=e.length;t<i;++t){let i=parseInt(e[t]);if(isNaN(i)){let i=0;if(e[t].charAt(0)==="-"){i=1;e[t]=e[t].substring(1)}let a=WH.inArray(this.columns,e[t],(function(e){return e.id}));if(a!==-1){if(i){this.sort.push(-(a+1))}else{this.sort.push(a+1)}}}else{this.sort.push(i)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:Listview.COLUMN_ID_DEBUG_ID,name:WH.TERMS.id,width:"5%",compute:function(e,t){if(e.id){let i=WH.ce("pre",{style:{display:"inline",margin:"0"}},WH.ct(e.id));WH.clickToCopy(i);WH.ae(t,i)}},getVisibleText:function(e){return e.id||""},getValue:function(e){return e.id||0},sortFunc:function(e,t,i){if(e.id==null){return-1}else if(t.id==null){return 1}return WH.stringCompare(e.id,t.id)}});for(let e=0,t;t=this.columns[e];e++){t.__index=e}this.visibility.splice(0,0,-1);for(let e=0,t=this.visibility.length;e<t;++e){this.visibility[e]=this.visibility[e]+1}for(let e=0,t=this.sort.length;e<t;++e){if(this.sort[e]<0){this.sort[e]=this.sort[e]-1}else{this.sort[e]=this.sort[e]+1}}}this.originalSort=JSON.parse(JSON.stringify(this.sort));for(let e=0,t;t=this.columns[e];++e){t.actions=t.actions||[]}this.Filters=new Listview.Filters(this);if(!this.tabs||this.tabsCalledInitialize){this.initialize()}}Listview.COLUMN_ID_COMPLETION="completed";Listview.COLUMN_ID_DEBUG_ID="debug-id";Listview.COLUMN_ID_POPULARITY="popularity";Listview.COLUMN_TYPE_NUMBER="number";Listview.COLUMN_TYPE_RANGE="range";Listview.COLUMN_TYPE_TEXT="text";Listview.COMPLETION_TYPE_NONE=0;Listview.COMPLETION_TYPE_BATTLE_PET=1;Listview.COMPLETION_TYPE_COLLECTION=2;Listview.HASH_DISABLED=0;Listview.HASH_FULL=1;Listview.HASH_SIMPLE=2;Listview.HASH_DELIMITER=";";Listview.SORT_OPTIONS_FIRST=0;Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.prototype={addOptions:function(e,t){t=t||{};t.className="listview-note-options";let i=WH.ce("div",t);WH.ae(this.getNoteTopDiv(),i);for(let t=0,a;a=e[t];t++){let e=WH.ce("div",{className:"listview-note-options-option"});let t=WH.ce("label",undefined,WH.ct(a.label));if(a.option.nodeType===Node.ELEMENT_NODE&&/^(input|select|textarea|button|object)$/.test(a.option.tagName.toLowerCase())){if(!a.option.id){a.option.id="listview-option-"+WH.Strings.guid()}t.htmlFor=a.option.id}else{t.style.cursor="default"}WH.ae(e,t);WH.ae(e,WH.ce("div",undefined,a.option));WH.ae(i,e)}},initialize:function(){const e=this;if(this.loadingTemplate){this.tabsCalledInitialize=true;return}delete this.tabsCalledInitialize;if(this.data.length){if(this.computeDataFunc!=null){for(let e=0,t=this.data.length;e<t;++e){this.computeDataFunc(this.data[e])}}}let t;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){t=this.onBeforeCreate()}else{for(let e=0;e<this.onBeforeCreate.length;++e){this.onBeforeCreate[e].bind(this)()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";this.createMainContainer();this.createBands();if(this.customFilter!=null){this.Filters.applyDataOnly()}if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateNav();this.refreshRows(true);this.updateBrowseSession();if(!e.clip&&e.scrollerVertical&&e.bandTop&&e.bandBot){e.updateScrollEnhancements();WH.aE(window,"resize",e.updateScrollEnhancements.bind(e));WH.aE(window,"scroll",e.updateScrollEnhancements.bind(e))}if(this.onAfterCreate){this.onAfterCreate(t)}this.lockHash=false},createHeader:function(){let e=WH.ce("tr");if(this.mode===Listview.MODE_CHECKBOX){let t=WH.ce("th",{style:{width:"33px"}});WH.ae(e,t);let i=WH.ce("div");WH.ae(t,i);let a=WH.ce("a",{className:"listview-cb"},WH.ct(WH.Strings.nbsp));WH.ae(i,a)}let t=WH.Device.isTouch();for(let i=0,a=this.visibility.length;i<a;++i){let a=this.visibility[i];let n=this.sortOptions?this.sortOptions[a]:this.columns[a];let s=WH.ce("th");let r=WH.ce("span");let o=WH.ce("span");let l=WH.ce("div");let c=WH.ce("a");n.__th=s;if(n.actions&&n.actions.length){c.href="javascript:";c.onclick=c.oncontextmenu=Listview.onColumnHeaderClick.bind(this,n,a)}else if(this.sortable&&(n.sortable==null||n.sortable)){c.href="javascript:";c.onclick=this.sortBy.bind(this,a+1,false)}if(c.onclick){if(!t){c.onmouseover=Listview.onColumnHeaderHover.bind(this,c,n);c.onmouseout=WH.Tooltip.hide}}else{c.className="static"}if(n.width!=null)s.style.width=n.width;if(n.align!=null)s.style.textAlign=n.align;if(n.span!=null)s.colSpan=n.span;let u=n.headerClasses||[];if(u.length){c.classList.add(...u)}WH.ae(o,WH.ct(n.name?n.name:WH.Strings.nbsp));WH.ae(r,o);WH.ae(c,r);WH.ae(l,c);WH.ae(s,l);WH.ae(e,s)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,e)},createSortOptions:function(e){if(!Array.isArray(this.sortOptions)){return}let t=null;if(Array.isArray(this.sort)){t=this.sort[0]}let i=[];for(let e=0;e<this.sortOptions.length;e++){if(this.sortOptions[e].hidden){continue}let a=WH.ce("a",{href:"javascript:"});a.innerHTML=this.sortOptions[e].name;a.onclick=this.sortGallery.bind(this,a,e+1);if(t===e+1){a.className="active"}i.push(a)}let a=WH.ce("span",{className:"listview-sort-options-choices"});for(let e=0;e<i.length;e++){WH.ae(a,i[e])}let n=WH.ce("div",{className:"listview-sort-options"},WH.ct(WH.TERMS.sortby_colon));WH.ae(n,a);WH.aef(e,n)},getSpecialHash:function(e){let t=e+":";let i=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let e=0,a=i.length;e<a;e++){if(i[e].indexOf(t)===0){return i[e].substr(t.length)}}return undefined},getSpecialHashesString:function(){let e=[];for(let t in this.specialHashes){if(this.specialHashes.hasOwnProperty(t)){e.push(t+":"+this.specialHashes[t])}}return e.join(Listview.HASH_DELIMITER)},isColumnVisible:function(e){return this.visibility.indexOf(e.__index)!==-1},removeSpecialHash:function(e){delete this.specialHashes[e];let t=e+":";let i=location.hash.slice(1).split(Listview.HASH_DELIMITER).filter((function(e){return e.slice(0,t.length)!==t}));location.hash=i.join(Listview.HASH_DELIMITER)},setSpecialHash:function(e,t){this.specialHashes[e]=t},sortGallery:function(e,t){let i=$(e);i.siblings("a").removeClass("active");i.addClass("active");this.sortBy(t)},copyValues:function(e,t,i){WH.copyToClipboard(this.data.map((t=>{if(t.__hidden){return null}let i=e(t);if(typeof i==="string"){i=i.trim();if(i.includes(",")){i=JSON.stringify(i)}}return i==null||i===""?"-":i})).filter((e=>e!=null)).join(", "),i);t.classList.remove("fa-clipboard");t.classList.add("fa-check");setTimeout((()=>{t.classList.remove("fa-check");t.classList.add("fa-clipboard")}),1.5*WH.Time.MS_SEC)},createBands:function(){let e=WH.ce("div");let t=WH.ce("div");let i=WH.ce("div");let a=WH.ce("div");this.bandTop=e;this.bandBot=t;this.noteTop=i;this.noteBot=a;e.className="listview-band-top";t.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);i.className=a.className="listview-note";if(this.note){i.innerHTML=this.note}else if(this.createNote){this.createNote(i,a)}this.createSortOptions(i);if(this._errors){let e=WH.ce("b",{className:"q10 fa fa-exclamation-triangle fa-size-s"},WH.ct(" "+WH.TERMS.error));let t=WH.ce("span",{className:"tip"},e);WH.Tooltip.simple(t,WH.TERMS.invalidfilters_tip,"q",{maxWidth:200});if(i.innerHTML){t.style.marginLeft="10px"}WH.ae(i,t)}if(!i.firstChild&&!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(i,WH.ct(WH.Strings.nbsp))}if(!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(a,WH.ct(WH.Strings.nbsp))}WH.ae(e,this.navTop);let n=this.Filters.getOptionsToggle();if(n){WH.ae(e,n)}let s=this.getCopyButton();if(s){WH.ae(e,s)}WH.ae(e,i);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";let t="";t+='<div id="class-selector-c0" class="iconmedium active">'+'<ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+WH.TERMS.all+"</span></ins>"+'<span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span>'+'<a href="javascript:" data-classid="0"></a></div>';for(let e in g_file_classes){t+='<div id="class-selector-c'+e+'" class="iconmedium">'+'<ins><img src="'+WH.staticUrl+"/images/wow/icons/medium/class_"+g_file_classes[e]+'.jpg" /></ins>'+'<span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span>'+'<a href="javascript:" data-classid="'+e+'"></a></div>'}this.classSelectorDiv.innerHTML=t;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",(function(e){let t=parseInt($(e.target).attr("data-classid"));if(t){let i=WH.Wow.PlayerClass.getName(t);WH.Tooltip.showAtCursor(e,i,"q")}}));$("div.iconmedium",this.classSelectorDiv).bind("mouseout",(function(e){WH.Tooltip.hide()}));let i=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",(function(e){return false}));let a=function(e){if(e){WH.LocalStorage.set("dynamic_quest_class",e);this.classFilter=function(t){for(let i in t.specs){if(WH.inArray(g_chr_specs_by_class[e],t.specs[i])!==-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{WH.LocalStorage.remove("dynamic_quest_class");this.classFilter=null;this.deleteRowCaches()}this.Filters.apply();this.applySort();this.refreshRows(true)};$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",(function(e){let t=parseInt($(e.target).attr("data-classid"));switch(e.which){case 3:if(t&&$(e.target).parent().hasClass("active")){$(e.target).parent().removeClass("active");a.call(i,null);$("#class-selector-c0").addClass("active")}break;default:$(".iconmedium",i.classSelectorDiv).removeClass("active");$(e.target).parent().addClass("active");a.call(i,t);break}}));$(e).append(this.classSelectorDiv);$(e).append('<div class="pad" style="clear: left;"></div>');if(WH.LocalStorage.get("dynamic_quest_class")){classId=WH.LocalStorage.get("dynamic_quest_class");$("#class-selector-c"+classId+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(t,this.navBot);WH.ae(t,a);if(this.createCbControls||this.mode===Listview.MODE_CHECKBOX){if(this.note&&!this.showLootSpecs){i.style.paddingBottom="5px"}this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(e,this.cbBarTop);WH.ae(t,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}if(this.noteTop.firstChild&&this.cbBarTop.firstChild&&!this.showLootSpecs){this.noteTop.style.paddingBottom="6px"}if(this.noteBot.firstChild&&this.cbBarBot.firstChild){this.noteBot.style.paddingBottom="6px"}}if(this.hideBands&1){e.style.display="none"}if(this.hideBands&2){t.style.display="none"}WH.ae(this.container,this.bandTop);this.scrollerHorizontal=WH.ce("div");this.scrollerHorizontal.className="listview-scroller-horizontal";WH.ae(this.container,this.scrollerHorizontal);this.scrollerVertical=WH.ce("div");this.scrollerVertical.className="listview-scroller-vertical";if(this.clip){this.scrollerVertical.style.width=this.clip.w+"px";this.scrollerVertical.style.height=this.clip.h+"px"}if(this.containVerticalScrolling){WH.aE(this.scrollerVertical,"wheel",WH.pickerWheel)}WH.ae(this.scrollerVertical,this.mainContainer);WH.ae(this.scrollerVertical,this.noData);WH.ae(this.scrollerHorizontal,this.scrollerVertical);WH.ae(this.container,this.bandBot)},createMainContainer:function(){let e=this.mainContainer;if(this.mode===Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else if(this.mode===Listview.MODE_TILED){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-tiled"});if(this.clickable){this.mainContainer.className+=" clickable"}if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}WH.aE(window,"resize",this.updateTileSizes.bind(this))}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode===Listview.MODE_CALENDAR){this.table.className="listview-mode-calendar";let e=100/WH.Time.DAYS_PER_WEEK+"%";let t=WH.ce("colgroup");for(let i=0;i<WH.Time.DAYS_PER_WEEK;++i){let i=WH.ce("col");i.style.width=e;WH.ae(t,i)}WH.ae(this.mainContainer,t);if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}}else{this.table.className="listview-mode-default";this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}if(e){e.after(this.mainContainer);WH.de(e);this.deleteRowCaches()}},createNav:function(e){let t=WH.ce("div");t.firstLink=WH.ce("a");t.previousLink=WH.ce("a");t.nextLink=WH.ce("a");t.lastLink=WH.ce("a");t.statusText=WH.ce("span");t.firstIndex=WH.ce("b");t.lastIndex=WH.ce("b");t.totalCount=WH.ce("b");t.className="listview-nav";t.firstLink.href=t.previousLink.href=t.nextLink.href=t.lastLink.href="javascript:";WH.ae(t.firstLink,WH.ct(WH.Strings.laquo+" "+WH.TERMS.first));WH.ae(t.previousLink,WH.ct(WH.Strings.lsaquo+" "+WH.TERMS.previous));WH.ae(t.nextLink,WH.ct(WH.TERMS.next+" "+WH.Strings.rsaquo));WH.ae(t.lastLink,WH.ct(WH.TERMS.last+" "+WH.Strings.raquo));t.firstLink.onclick=this.firstPage.bind(this);t.previousLink.onclick=this.previousPage.bind(this);t.nextLink.onclick=this.nextPage.bind(this);t.lastLink.onclick=this.lastPage.bind(this);if(this.mode===Listview.MODE_CALENDAR){WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.statusText,t.firstIndex)}else{WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.lastIndex,WH.ct("a"));WH.ae(t.totalCount,WH.ct("a"));WH.ae(t.statusText,t.firstIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.hyphen_punct));WH.ae(t.statusText,t.lastIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.of_lc));WH.ae(t.statusText,t.totalCount)}WH.ae(t,t.firstLink);WH.ae(t,t.previousLink);WH.ae(t,t.statusText);WH.ae(t,t.nextLink);WH.ae(t,t.lastLink);if(e){if(this.hideNav&1){t.style.display="none"}}else{if(this.hideNav&2){t.style.display="none"}}if(this.tabClick){$("a",t).click(this.tabClick)}if(e){this.resetSortLink=WH.ce("a",{className:"listview-reset-sort fa fa-times-circle",href:"javascript:",style:{display:"none"}},WH.ct(WH.TERMS.resetSort));WH.aE(this.resetSortLink,"click",this.resetSort.bind(null,this));WH.aef(t,this.resetSortLink)}return t},createCbBar:function(e){let t=WH.ce("div");if(this.createCbControls){this.createCbControls(t,e)}if(this.createTooltipToggle){this.createTooltipToggle(t,e)}if(t.firstChild){t.className="listview-withselected"+(e?"":"2");WH.ae(t,this.createToggleAll())}return t},createToggleAll:function(){let e=WH.ce("a");e.className="listview-toggleall";let t=function(e){let t=$("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?WH.TERMS.selectall_stc:WH.TERMS.deselectall_stc;WH.Tooltip.showAtCursor(e,t,"q")};e.onclick=function(e,t,i){let a=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",a).length){Listview.cbSelect.call(e,true)}else{Listview.cbSelect.call(e,false)}t.call(this,i)}.bind(e,this,t);e.onmousedown=WH.rf;e.onmouseover=t;e.onmousemove=WH.Tooltip.cursorUpdate;e.onmouseout=WH.Tooltip.hide;return e},deleteRowCaches:function(){for(let e in this.data){this.data[e].__tr=null}},getCopyButton:function(){const e=this;if(!this.template.columns||this.template.copyableColumns===false){return null}let t=WH.ce("a",{className:"listview-option-button fa fa-clipboard"});let i=[];let a=false;this.visibility.forEach((n=>{let s=e.columns[n];if(!s||s.copyable===false||!s.name||s.id===Listview.COLUMN_ID_COMPLETION){return}let r=(s.getPlainText?e=>s.getPlainText(e):null)||(s.getVisibleText&&!(s.id==="name"&&s.value)?e=>s.getVisibleText(e):null)||(s.getValue?e=>s.getValue(e):null)||(s.value?e=>e[s.value]:null);if(!r){return}i.push(Menu.createItem({label:s.name,url:e.copyValues.bind(e,r,t)}));a=a||["id",Listview.COLUMN_ID_DEBUG_ID].includes(s.id)}));if(!a){for(let a=0;a<10;a++){if(this.data[a]&&this.data[a].id!=null){i.unshift(Menu.createItem({label:WH.TERMS.id,url:e.copyValues.bind(e,(e=>e.id),t)}));break}}}if(!i.length){return null}let n;if(i.length===1){n=WH.term("copyEach_format",Menu.getLabel(i[0]));WH.aE(t,"click",Menu.getItemUrl(i[0]))}else{n=WH.TERMS.copy_clipboard+WH.TERMS.ellipsis_punct;i.unshift(Menu.createHeading({label:WH.TERMS.copyAll}));Menu.add(t,i,{showAtElement:true})}WH.Tooltip.simple(t,n,"q2");return t},refreshRows:function(e){let t;switch(this.mode){case Listview.MODE_DIV:t=this.mainContainer;break;case Listview.MODE_TILED:t=this.mainDiv;break;default:t=this.tbody}if(!t){return}WH.ee(t);if(this.nRowsVisible===0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}let i;let a;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){i=0;for(let e=0;e<this.rowOffset;++e){i+=this.nDaysPerMonth[e]}a=i+this.nDaysPerMonth[this.rowOffset]}else if(this.nItemsPerPage>0){i=this.rowOffset;a=Math.min(i+this.nRowsVisible,i+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(let e=0,t=0;e<this.data.length&&t<this.rowOffset;++e){let a=this.data[e];if(a.__hidden||a.__deleted){i++}else{t++}}a+=i-this.rowOffset}}else{i=0;a=this.nRowsVisible}let n=a-i;if(this.mode===Listview.MODE_DIV){for(let e=0;e<n;++e){let t=i+e;let a=this.data[t];if(!a){break}if(a.__hidden||a.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}}else if(this.mode===Listview.MODE_TILED){for(let e=0;e<n;++e){let t=i+e;let a=this.data[t];if(!a){break}if(a.__hidden||a.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}this.updateTileSizes();let e=WH.qsa("img",this.mainDiv);for(let t=0,i;i=e[t];t++){WH.aE(i,"load",this.updateTileSizesAfterDelay.bind(this))}}else if(this.mode===Listview.MODE_CALENDAR){let e=WH.ce("tr");for(let t=0;t<7;++t){WH.ae(e,WH.ce("th",undefined,WH.ct(WH.Time.getWeekdayName(t))))}WH.ae(this.tbody,e);e=WH.ce("tr");let t=this.dates[i].date.getDay();for(let i=0;i<t;i++){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}let n=t;for(let t=i;t<a;++t){WH.ae(e,this.getEvent(t));if(++n===7){WH.ae(this.tbody,e);e=WH.ce("tr");n=0}}if(n!==0){for(;n<7;++n){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}WH.ae(this.tbody,e)}}else{for(let t=0;t<n;++t){let a=i+t;let s=this.data[a];if(!s){break}if(s.__hidden||s.__deleted){++n;continue}WH.ae(this.tbody,this.getRow(a,e))}}this.mainContainer.style.display="";this.noData.style.display="none";$WowheadPower.attachTouchTooltips(t)},showNoData:function(){let e=this.noData;WH.ee(e);let t=-1;if(this.onNoData){t=this.onNoData.bind(this,e)()}if(t===-1){if(this.noDataElement){WH.ae(this.noData,this.noDataElement)}else if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?WH.TERMS.nomatches_tip:WH.TERMS.nodata_tip))}}},getColumn:function(e){for(let t=0,i;i=this.columns[t];t++){if(i.id===e){return i}}return undefined},getDiv:function(e){let t=this.data[e];if(t.__div==null||this.minPatchVersion!=t.__minPatch){this.createDiv(t,e)}return t.__div},createDiv:function(e,t){let i=WH.ce("div");e.__div=i;if(this.minPatchVersion){e.__minPatch=this.minPatchVersion}if(this.onItemClick){WH.aE(i,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink&&this.clickable){WH.aE(i,"click",this.onStandardClickableRowClick.bind(this,e))}this.template.compute.bind(this,e,i,t)()},getCell:function(e,t){let i=this.data[e];if(t||i.__td==null){this.createCell(i,e)}return i.__td},createCell:function(e,t){let i=WH.ce("td");e.__td=i;this.template.compute.bind(this,e,i,t)()},getEvent:function(e){let t=this.dates[e];if(t.__td==null){this.createEvent(t,e)}return t.__td},createEvent:function(e,t){e.events=WH.arrayFilter(this.data,(function(t){if(t.__hidden||t.__deleted||t.name.match(/^\[#/)){return false}if(!WH.Wow.Event){return false}let i=WH.Wow.Event.getNextEvent(t.occurrences,e.date);if(i){let t=new Date(i.start);let a=new Date(i.end);t.setHours(0,0,0,0);a.setHours(0,0,0,0);return t<=e.date&&a>e.date}return false}));let i=WH.ce("td");e.__td=i;if(e.date.getFullYear()===WH.getServerTime().getFullYear()&&e.date.getMonth()===WH.getServerTime().getMonth()&&e.date.getDate()===WH.getServerTime().getDate()){i.className="calendar-today"}let a=WH.ce("div",{className:"calendar-date"});WH.st(a,e.date.getDate());WH.ae(i,a);a=WH.ce("div");a.className="calendar-event";WH.ae(i,a);this.template.compute.bind(this,e,a,t)();if(this.onItemClick){WH.aE(i,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(i,"click",this.onStandardClickableRowClick.bind(this,e))}},getRow:function(e,t){let i=this.data[e];if(t||i.__tr==null){this.createRow(i)}return i.__tr},setRow:function(e){if(this.data[e.pos]){this.data[e.pos]=e;this.data[e.pos].__tr=e.__tr;this.createRow(this.data[e.pos]);this.refreshRows()}},createRow:function(e){let t=WH.ce("tr",{className:"listview-row"});e.__tr=t;if(this.mode===Listview.MODE_CHECKBOX){let i=WH.ce("td");if(!e.__nochk){i.className="listview-cb";i.onclick=Listview.cbCellClick;let t=WH.ce("input",{type:"checkbox"});t.onclick=Listview.cbClick;if(e.__chk){t.checked=true}e.__cb=t;WH.ae(i,t)}WH.ae(t,i)}for(let i=0,a=this.visibility.length;i<a;++i){let a=this.visibility[i];let n=this.sortOptions?this.sortOptions[a]:this.columns[a];let s=WH.ce("td");let r;if(n.align!=null){s.style.textAlign=n.align}if(n.compute){r=n.compute.bind(this,e,s,t,a)()}else if(e[n.value]!=null){r=e[n.value]}else{r=-1}if(r!==-1&&r!=null){s.insertBefore(WH.ct(r),s.firstChild)}WH.ae(t,s)}if(this.mode===Listview.MODE_CHECKBOX&&e.__chk){t.className="checked"}if(e.frommerge){t.className+=" mergerow"}if(this.onItemClick){WH.aE(t,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(t,"click",this.onStandardClickableRowClick.bind(this,e))}},onStandardClickableRowClick:function(e,t){if(this.noRowClick){return}if(t.target&&WH.closest(t.target,"a")){return}location.href=this.getItemLink(e)},submitSearch:function(e){if(!this.onSearchSubmit||e.keyCode!==13){return}for(let e=0,t=this.data.length;e<t;++e){if(this.data[e].__hidden){continue}this.onSearchSubmit.bind(this,this.data[e])()}},validatePage:function(e){if(e===true&&!this.validateHashPagination){return}if(this.rowOffset<0){this.rowOffset=0}else if(this.mode===Listview.MODE_CALENDAR){this.rowOffset=Math.min(this.rowOffset,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(this.rowOffset+this.nItemsPerPage>this.nRowsVisible?this.nRowsVisible-1:this.rowOffset)}},getRowOffset:function(e){return this.nItemsPerPage>0&&e>0?Math.floor(e/this.nItemsPerPage)*this.nItemsPerPage:0},resetRowVisibility:function(e){for(let e=0,t=this.data.length;e<t;++e){this.data[e].__hidden=false}this.filtered=false;if(e!==true){this.rowOffset=0}this.nRowsVisible=this.data.length},changePage:function(){this.refreshRows();this.updateNav();this.writeHash();this.updateBrowseSession();let e=WH.getScroll();let t=WH.ac(this.container);if(e.y>t[1]){scrollTo(e.x,t[1])}},firstPage:function(){if(this.rowOffset>0){this.rowOffset=0;this.changePage()}return false},previousPage:function(){if(this.rowOffset>0){this.rowOffset-=this.nItemsPerPage;this.validatePage();this.changePage()}return false},nextPage:function(){let e=this.rowOffset;this.rowOffset+=this.nItemsPerPage;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},lastPage:function(){let e=this.rowOffset;this.rowOffset=99999999;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},addSort:function(e,t){let i=WH.inArray(e,Math.abs(t),(function(e){return Math.abs(e)}));if(i!==-1){t=e[i];e.splice(i,1)}e.splice(0,0,t)},sortBy:function(e,t){let i=this.sortOptions||this.columns;if(e<=0||e>i.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==e&&!t){this.sort[0]=-this.sort[0]}else{let t=-1;if(i[e-1].type===Listview.COLUMN_TYPE_TEXT){t=1}this.addSort(this.sort,t*e)}if(this.data[0]&&!this.data[0].__originalIndex){for(let e in this.data){if(this.data.hasOwnProperty(e)&&this.data[e]){this.data[e].__originalIndex=e}}}if(this.resetSortLink){this.resetSortLink.style.display=""}this.applySort();this.refreshRows();this.updateSortArrow();this.writeHash()},applySort:function(){if(!this.sort.length){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},resetSort:function(e){if(e.originalSort&&e.data[0]&&e.data[0].hasOwnProperty("__originalIndex")){e.sort=JSON.parse(JSON.stringify(e.originalSort));e.data.sort((function(e,t){return(e.__originalIndex||0)-(t.__originalIndex||0)}));e.indexCreated=false;e.applySort();e.refreshRows();e.removeSortArrow();e.writeHash(true)}else{WH.error("Could not revert to default sort.",e.id,!e.originalSort?"No original sort":!e.data[0]?"No first row":"No original indexes")}if(e.resetSortLink){e.resetSortLink.style.display="none"}},setSort:function(e,t,i){this.searchSort=false;if(this.sort.toString()!==e.toString()){this.sort=e;this.applySort();if(t){this.refreshRows()}if(i){this.writeHash()}}},readHash:function(){if(!this.hash||!location.hash.length){return}let e=location.hash.substr(1);let t=this.rowOffset;let i=false;this.Filters.reset();const a=this;e.split(/[;:]/).forEach((function(e){if(/^\d+([+-]\d+)*$/.test(e)){let t=parseInt(e);if(isNaN(t)){return}a.rowOffset=t;i=true;a.validatePage(true);if(a.hash!==Listview.HASH_SIMPLE){let t=[];let i=e.match(/([+-])[0-9]+/g);if(i){let e=(a.sortOptions||a.columns).length;for(let n=i.length-1;n>=0;n--){let s=parseInt(i[n])||0;let r=Math.abs(s);if(r<=0||r>e){break}a.addSort(t,s)}a.setSort(t,false,false)}}if(a.tabs){a.tabs.setTabPound(a.tabIndex,a.buildHash())}}else{a.Filters.readHashPart(e)}}));if(!i){this.rowOffset=t}a.Filters.apply();a.updateSortArrow()},setHashMode:function(e){this.hash=e},updateBrowseSession:function(){if(!window.JSON||!WH.LocalStorage.isSupported()){return}if(typeof Filter=="undefined"&&location.pathname!=="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}let e=5;let t=location.pathname+location.search;let i=new Date(WH.getServerTime().getTime()-1e3*60*60*24*3).getTime();let a=WH.LocalStorage.get("lvBrowse");if(a){a=window.JSON.parse(a);for(let e=0;e<a.length;e++){if(a[e].path===t||a[e].when<i){a.splice(e--,1)}}if(a.length>=e){a.splice(e-1,a.length-e-1)}}else{a=[]}let n=[];let s;let r=/^\/[-a-z]+=\d+/i;for(let e=0;e<this.data.length;e++){if(s=r.exec(this.getItemLink(this.data[e]))){n.push(s[0])}}if(n.length<3){return}a.unshift({path:t,hash:location.hash,when:WH.getServerTime().getTime(),urls:n});WH.LocalStorage.set("lvBrowse",window.JSON.stringify(a))},updateScrollEnhancements:function(){if(!this.bandTop.offsetParent){return}const e=200;let t=window.innerHeight-this.scrollerVertical.getBoundingClientRect().top-this.bandBot.offsetHeight;t=Math.max(t,e);if(t<this.scrollerVertical.scrollHeight){if(!this.container.dataset.fixedBottom){this.container.dataset.fixedBottom="true"}this.bandBot.style.width=this.bandBot.parentNode.offsetWidth+"px";this.container.style.paddingBottom=this.bandBot.offsetHeight+"px";if(this.scrollerVertical.scrollWidth>this.scrollerVertical.clientWidth){this.scrollerHorizontal.style.minHeight=this.scrollerVertical.scrollHeight+"px";this.scrollerVertical.style.maxHeight=t+"px"}else if(this.scrollerHorizontal.style.minHeight){this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}if(t===e){let e=this.bandTop.offsetParent;let i=t+this.scrollerVertical.getBoundingClientRect().top-e.getBoundingClientRect().top-parseInt(getComputedStyle(e).getPropertyValue("border-top-width"));this.bandBot.dataset.atTop="true";this.bandBot.style.top=i+"px"}else{if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}}}else{if(this.container.dataset.fixedBottom){delete this.container.dataset.fixedBottom;this.bandBot.style.width="";this.container.style.paddingBottom="";if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}},removeSortArrow:function(){if(this.lsa){this.lsa.classList.remove("listview-sort-desc","listview-sort-asc");this.lsa.classList.remove("active")}},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode===Listview.MODE_CALENDAR||this.searchSort){return}let e=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(e===-1){return}if(this.mode===Listview.MODE_TILED){if(!this.sortOptions){return}let t=$(".listview-sort-options a",this.noteTop).get(e);if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"active listview-sort-desc":"active listview-sort-asc";this.lsa=t;return}if(this.mode===Listview.MODE_CHECKBOX&&e<this.thead.firstChild.childNodes.length-1){e+=1}let t=this.thead.firstChild.childNodes[e].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"listview-sort-desc":"listview-sort-asc";this.lsa=t},updateSortIndex:function(){let e=this.data;for(let t=0,i=e.length;t<i;++t){e[t].__si=t}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updateTileSizes:function(){if(this.mode!==Listview.MODE_TILED||!this.mainDiv||!this.mainDiv.offsetParent){return}this.mainDiv.dataset.widthTesting="true";let e=0;for(let t=0,i;i=this.mainDiv.childNodes[t];t++){e=Math.max(e,i.offsetWidth)}if(e>30){this.mainDiv.style.gridTemplateColumns="repeat(auto-fit, minmax("+e+"px, 1fr))"}delete this.mainDiv.dataset.widthTesting;clearTimeout(this.updateTileSizesDelay)},updateTileSizesAfterDelay:function(){if(!this.updateTileSizesDelay){this.updateTileSizesDelay=setTimeout(this.updateTileSizes.bind(this),100)}},writeHash:function(e){if(!this.hash||this.lockHash||!this.Filters){return}function t(e){let t=[];e=Listview.HASH_DELIMITER+e;let i=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let a=0,n=i.length;a<n;a++){let n=i[a].match(/^[a-zA-Z0-9_]+:/);if(n&&!e.includes(Listview.HASH_DELIMITER+n[0])){t.push(i[a])}}return t}let i=e===true?"":this.buildHash();if(this.tabs){this.tabs.setTabPound(this.tabIndex,i)}let a=this.getSpecialHashesString();let n=[];let s=t(a);if(this.tabs){if(s.length&&s[0].indexOf(this.id+":")===0){n.push(s.shift())}else{n.push(this.id)}}n.push(a);n=n.concat(s);n.push(i);let r=n.filter(Boolean).join(Listview.HASH_DELIMITER);if(this.tabs&&r===this.id&&this.tabs.selectedTab===-1&&!location.hash){r=""}if(r){location.replace("#"+r)}else{WH.clearHash()}},updateNav:function(){let e=[this.navTop,this.navBot];let t=false;let i=false;let a=new Date;if(this.nRowsVisible>0){if(!(this.hideNav&1)){e[0].style.display=""}if(!(this.hideNav&2)){e[1].style.display=""}}else{e[0].style.display=e[1].style.display="none"}if(this.mode===Listview.MODE_CALENDAR){for(let e=0;e<this.nDaysPerMonth.length;++e){if(e===this.rowOffset){if(e>0){t=true}if(e<this.nDaysPerMonth.length-1){i=true}}}a.setTime(this.startOnMonth.valueOf());a.setMonth(a.getMonth()+this.rowOffset)}else{if(this.nItemsPerPage){if(this.rowOffset>0){t=true}if(this.rowOffset+this.nItemsPerPage<this.nRowsVisible){i=true}}}for(let n=0;n<2;++n){let s=e[n];s.firstLink.dataset.active=t?"yes":"no";s.previousLink.dataset.active=t?"yes":"no";s.nextLink.dataset.active=i?"yes":"no";s.lastLink.dataset.active=i?"yes":"no";if(this.mode===Listview.MODE_CALENDAR){s.firstIndex.firstChild.nodeValue=WH.Time.getMonthName(a.getMonth())+" "+a.getFullYear()}else{s.firstIndex.firstChild.nodeValue=this.rowOffset+1;s.lastIndex.firstChild.nodeValue=this.nItemsPerPage?Math.min(this.rowOffset+this.nItemsPerPage,this.nRowsVisible):this.nRowsVisible;s.totalCount.firstChild.nodeValue=this.nRowsVisible}}if(!t&&!i){$(e[0]).addClass("listview-nav-nocontrols");$(e[1]).addClass("listview-nav-nocontrols")}else{$(e[0]).removeClass("listview-nav-nocontrols");$(e[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){let e=this.name;let t=this.data.length;for(let e=0,i=this.data.length;e<i;++e){if(this.data[e].__hidden||this.data[e].__deleted){--t}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){t=this.forceQuantity}if((t>0||typeof this.forceQuantity=="string")&&!this.hideCount){e+=WH.sprintf(WH.TERMS._paren,t)}return e},buildHash:function(){let e=[];let t="";t+=this.rowOffset;if(this.hash===Listview.HASH_FULL&&this.sort.length&&JSON.stringify(this.originalSort)!==JSON.stringify(this.sort)){t+=("+"+this.sort.join("+")).replace(/\+-/g,"-")}if(t!=="0"){e.push(t)}e=e.concat(this.Filters.getHashParts());return e.join(Listview.HASH_DELIMITER)},getCheckedRows:function(){let e=[];for(let t=0,i=this.data.length;t<i;++t){let i=this.data[t];if(i.__cb&&i.__cb.checked||!i.__cb&&i.__chk){e.push(i)}}return e},resetCheckedRows:function(){for(let e=0,t=this.data.length;e<t;++e){let t=this.data[e];if(t.__cb){t.__cb.checked=false}else if(t.__chk){t.__chk=null}if(t.__tr){t.__tr.className=t.__tr.className.replace("checked","")}}},deleteRows:function(e){if(!e||!e.length){return}for(let t=0,i=e.length;t<i;++t){let i=e[t];if(!i.__hidden&&!i.__hidden){this.nRowsVisible-=1}i.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(e){this.data=e;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.Filters.applyDataOnly()}this.updateNav();this.refreshRows();this.updateBrowseSession()},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},createIndicator:function(e,t,i,a){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}let n=$('<span class="indicator"></span>').html(e).append(!t?"":$('<a class="indicator-x">[x]</a>').attr("href",t).click((function(){if(this.tabClick){this.tabClick()}}))).css("cursor",typeof i=="function"?"pointer":null).click((function(){if(this.tabClick){this.tabClick()}if(typeof i==="function"){i()}}));if(a){WH.Tooltip.simple(n.get(0),a,"q")}$(this.noteIndicators).append(n);$(this.noteTop).css("padding-top","7px");if(!this.showLootSpecs){$(this.noteTop).css("padding-bottom","11px")}return n[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(e,t,i,a,n,s){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}let r=4;if(isNaN(n)||n<1){n=1}if(n>r){n=r}let o=this.noteProgressBars.lastChild;let l=n;if(o&&o.childNodes){for(let e=0;e<o.childNodes.length;++e){l+=o.childNodes[e].colSpan||1}}if(!o||l>r){o=WH.ce("tr");WH.ae(this.noteProgressBars,o)}let c=WH.ce("td");if(n>1){c.colSpan=n}if(i){c.className="clickable";c.onclick=function(){i.apply(this,a)}}if(e){WH.ae(c,WH.ce("div",{className:"heading"},WH.ct(e)))}let u=WH.ce("div",{className:"bar-wrap"});let d=WH.ce("div",{className:"bar-bg"});WH.ae(u,d);if(t[2]){let e=WH.ce("div",{className:"bar yellow"});e.style.width=Math.round((t[1]+t[2]+t[5])/t[0]*1e3)/10+"%";WH.ae(u,e)}let f=WH.ce("div",{className:"bar"});f.style.width=Math.round((t[1]+t[5])/t[0]*1e3)/10+"%";if(s){f.className+=" "+s}WH.ae(u,f);if(t[5]){let e=WH.ce("div",{className:"bar gray"});e.style.width=Math.round(t[5]/t[0]*1e3)/10+"%";WH.ae(u,e)}else{t[5]=0}let h=WH.ce("span");WH.st(h,t[1]+t[5]+(t[2]||t[3]?" ("+(t[3]||t[2])+")":"")+" / "+t[0]);WH.ae(u,h);WH.ae(c,u);WH.ae(o,c);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(e,t){if(!WH.User.isPremium()){return}let i=false;for(let e=0;e<this.data.length;e++){if(t[this.data[e].id]&&t[this.data[e].id].hasOwnProperty("screenshot")){i=true;break}}if(!i){return}WH.Tooltip.hideScreenshots=true;if(WH.LocalStorage.isSupported()){WH.Tooltip.hideScreenshots=WH.LocalStorage.get("tooltipScreenshots")!=="1"}let a=function(){WH.Tooltip.hideScreenshots=!this.checked;if(WH.LocalStorage.isSupported()){if(this.checked){WH.LocalStorage.set("tooltipScreenshots","1")}else{WH.LocalStorage.remove("tooltipScreenshots")}}$("input[type=checkbox].tooltipToggle").prop("checked",!!this.checked)};let n=WH.ce("label");let s=WH.ce("input",{checked:!WH.Tooltip.hideScreenshots,className:"tooltipToggle",type:"checkbox"});WH.aE(s,"click",a.bind(s));WH.ae(n,s);WH.ae(n,WH.ct(WH.TERMS.screenshotsontooltips_stc));WH.ae(e,n)},noteTopFormIsEmpty:function(){let e=true;$("input, select",this.noteTop).each((function(){switch(this.tagName){case"INPUT":if(this.value){e=false;return false}break;case"SELECT":if($(this).val()){e=false;return false}break}}));return e}};Listview.sortRows=function(e,t){let i=Listview.sort;let a=Listview.sortOptions||Listview.columns;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let n=0,s=i.length;n<s;++n){let s;let r=a[Math.abs(i[n])-1];if(!r){r=this.template}if(r.sortFunc){s=r.sortFunc.call(this,e,t,i[n])}else if(r.getValue){s=WH.stringCompare(r.getValue(e),r.getValue(t))}else{s=WH.stringCompare(e[r.value],t[r.value])}if(s){return s*i[n]}}return 0};Listview.sortIndexedRows=function(e,t){let i=Listview.sort;let a=Listview.sortOptions||Listview.columns;let n;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let s in i){let r=a[Math.abs(i[s])-1];if(!r){r=this.template}if(r.sortFunc){n=r.sortFunc.call(this,e,t,i[0])}else if(r.getValue){n=WH.stringCompare(r.getValue(e),r.getValue(t))}else{let i=r.stat||r.value;n=WH.stringCompare(e[i],t[i])}if(n){return n*i[s]}}return e.__si-t.__si};Listview.cbSelect=function(e){for(let t=0,i=this.data.length;t<i;++t){let i=this.data[t];let a=e;if(i.__hidden){continue}if(!i.__nochk&&i.__cb){let e=i.__cb,t=e.parentNode.parentNode;if(a==null){a=!e.checked}if(e.checked!==a){e.checked=a;t.className=e.checked?t.className+" checked":t.className.replace("checked","")}}else if(a==null){a=true}i.__chk=a}};Listview.cbClick=function(e){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(e)};Listview.cbCellClick=function(e){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(e)};Listview.cbUpdate=function(e,t,i){if(e){t.checked=!t.checked}i.className=t.checked?i.className+" checked":i.className.replace("checked","")};Listview.getCompletionText=function(e){return WH.cO({all:WH.TERMS.all,identical:WH.TERMS.complete,similar:WH.TERMS.inprogress,extra:WH.TERMS.excluded,duplicate:WH.TERMS.duplicate,missing:WH.TERMS.incomplete,this:WH.TERMS.current,other:WH.TERMS.other},{[Listview.COMPLETION_TYPE_BATTLE_PET]:{identical:WH.TERMS.maxlevel,similar:WH.TERMS.lowlevel,missing:WH.TERMS.missing},[Listview.COMPLETION_TYPE_COLLECTION]:{identical:WH.TERMS.collected,missing:WH.TERMS.missing}}[e]||{})};Listview.onColumnHeaderClick=function(e,t,i){const a=this;if(this.tabClick){this.tabClick()}if(i.button===2||i.shiftKey||i.ctrlKey){WH.Tooltip.hide();requestAnimationFrame((function(){if(e.actions.length===1||i.ctrlKey){let n=e.actions[0];if(n.menu){Menu.show(n.menu,WH.closest(i.target,"th"))}else{n.action.apply(a,e,t,i)}}else{let n=[];for(let i=0,s;s=e.actions[i];i++){if(s.heading){n.push(Menu.createHeading({label:s.name}))}else{n.push(Menu.createItem({label:s.name,submenu:s.menu,url:s.menu?undefined:s.action.bind(a,e,t)}))}}Menu.show(n,WH.closest(i.target,"th"))}}))}else{this.sortBy(t+1)}return false};Listview.onColumnHeaderHover=function(e,t){if(!(this.sortable&&(t.sortable==null||t.sortable)||t.actions.length)){return}let i=WH.ce("div");if(t.tooltipElement){WH.ae(i,t.tooltipElement)}else{WH.ae(i,WH.ce("b",{className:"q1"},WH.ct(t.tooltip||t.name)))}let a=this.Filters.getColumnTooltipAdditions(t);if(a){WH.ae(i,a)}WH.ae(i,WH.ce("div",{className:"q2 no-wrap"},WH.ct(WH.TERMS.clicktosort_stc)));if(t.actions.length){let e=t.actions.length>1?WH.TERMS.rightClickForMoreActions_stc:t.actions[0].tooltipText||WH.TERMS.rightClickTo_format.replace("%s",t.actions[0].name);WH.ae(i,WH.ce("div",{className:"q2 no-wrap"},WH.ct(e)))}WH.Tooltip.show(e,i.innerHTML,"q")};(function(){let e={};Listview.loadTemplate=function(t,i){let a=()=>{if(typeof Listview.templates[t]==="function"){Listview.templates[t]=Listview.templates[t]()}};if(Listview.templates.hasOwnProperty(t)){a();if(i){i()}return}let n=t;if(n.indexOf(".")>0){n=n.substr(0,n.indexOf("."))}let s=e.hasOwnProperty(n);if(!s){e[n]=[a]}if(i){e[n].push(i)}if(!s){let i=WH.ce("script");let a=WH.staticUrl+"/js/WH/Listview/Templates/"+n+".js";if(WH.PageMeta.scriptVersionQueryString){a+="?"+WH.PageMeta.scriptVersionQueryString}i.src=a;WH.aE(i,"load",(function(){if(!Listview.templates.hasOwnProperty(t)){WH.error('Loaded listview template file "'+n+'", but template "'+t+'" still not defined!')}else{while(e[n].length){e[n].shift()()}}}));WH.aE(i,"error",(function(){}